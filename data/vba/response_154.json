[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 2, "creation_date": 1513814596, "post_id": 47916022, "comment_id": 82800139, "body": "varRes must be Variant because Application.Match can return number or error value"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1513815507, "post_id": 47916022, "comment_id": 82800378, "body": "FWIW - a <code>Variant&#47;String</code> is a <code>Variant</code>, so there is nothing wrong with your first parameter.  (And because a normal <code>String</code> can be coerced to a <code>Variant&#47;String</code>, you could even pass variables declared <code>As String</code> as the first parameter of the <code>Match</code> function.)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1513815622, "post_id": 47916022, "comment_id": 82800411, "body": "@Slai <code>varRes</code> doesn&#39;t <b>have</b> to be <code>Variant</code>, but it <b>should</b> be <code>Variant</code> so that there is no &quot;type mismatch&quot; caused by trying to coerce a error value to a <code>Double</code> if the value isn&#39;t found in the search area."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513815842, "post_id": 47916022, "comment_id": 82800471, "body": "What have you declared <code>shtTigers</code> as?  Is that a <code>Variant</code>? a <code>Range</code>?  something else?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513816085, "post_id": 47916022, "comment_id": 82800527, "body": "And, most importantly (because this looks like a data error), what is the value of <code>arrCompare(1)</code> when it crashes, and does that value exist in the range <code>Tigers!A5:A10000</code>?"}, {"owner": {"reputation": 63, "user_id": 2509872, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0d3951d8ad77217cef1295c53ecdfa7c?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/2509872/greg"}, "edited": false, "score": 0, "creation_date": 1515007003, "post_id": 47916022, "comment_id": 83142198, "body": "shtTigers has not been declared.I have: Dim sht As Worksheet if that is your question. The value of arrCompare(1) is the value of the cell it is set to, in this case a value of &quot;16058/1&quot;. Yes this value exists on the Tigers worksheet."}, {"owner": {"reputation": 63, "user_id": 2509872, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0d3951d8ad77217cef1295c53ecdfa7c?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/2509872/greg"}, "edited": false, "score": 0, "creation_date": 1515008605, "post_id": 47916022, "comment_id": 83142920, "body": "And I would expect the application.match to give me the row number where the match occured (e.g. row 5)."}, {"owner": {"reputation": 63, "user_id": 2509872, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0d3951d8ad77217cef1295c53ecdfa7c?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/2509872/greg"}, "edited": false, "score": 0, "creation_date": 1515008918, "post_id": 47916022, "comment_id": 83143078, "body": "The error given is Run-time Error &#39;13&#39; Type Mismatch."}], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 2509872, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0d3951d8ad77217cef1295c53ecdfa7c?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/2509872/greg"}, "is_accepted": true, "score": 0, "last_activity_date": 1515083032, "creation_date": 1515083032, "answer_id": 48099428, "question_id": 47916022, "link": "https://stackoverflow.com/questions/47916022/vba-vartype-in-match-function/48099428#48099428", "title": "VBA VarType in Match Function", "body": "<p>varRes must be Variant because Application.Match can return number or error value </p>\n"}], "owner": {"reputation": 63, "user_id": 2509872, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0d3951d8ad77217cef1295c53ecdfa7c?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/2509872/greg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 48099428, "answer_count": 1, "score": 0, "last_activity_date": 1515083032, "creation_date": 1513814317, "last_edit_date": 1515008670, "question_id": 47916022, "link": "https://stackoverflow.com/questions/47916022/vba-vartype-in-match-function", "title": "VBA VarType in Match Function", "body": "<p>I am attempting to use the excel vba function Application.Match</p>\n\n<p>The match function will only work with my first array arrCompare(0) and arrCompare(5). Microsoft says the variables passed to the function must be variants. This statement doesn't seem to be entirely true as arrCompare(0) &amp; arrCompare(5) are strings and  arrCompare(1) is a string. I haven't yet understood why the Match function does not work when the forumla gets to the remaining arrCompare(1,2,3,4) variables.</p>\n\n<pre><code>Dim arrCompare(5) as Variant\nDim intRow As Integer\nDim varRes As Double\n\nSet sht = ActiveSheet\nSet shtTigers = Worksheets(\"Tigers\").Range(\"A5:A10000\")\nSet shtElephants = Worksheets(\"Elephants\").Range(\"A6:A10000\")\n\nSheets(\"Elephants\").Activate\n\nFor intRow = 6 To 7\n\narrCompare(0) = Worksheets(\"Elephants\").Cells(intRow, 1).Value      'varType(arrCompare(0)) = 8\narrCompare(1) = Worksheets(\"Elephants\").Cells(intRow, 2).Value      'varType(arrCompare(1)) = 8\narrCompare(2) = Worksheets(\"Elephants\").Cells(intRow, 4).Value      'varType(arrCompare(2)) = 8\narrCompare(3) = Worksheets(\"Elephants\").Cells(intRow, 5).Value      'varType(arrCompare(3)) = 8\narrCompare(4) = Worksheets(\"Elephants\").Cells(intRow, 7).Value      'varType(arrCompare(4)) = 8\narrCompare(5) = Worksheets(\"Elephants\").Cells(intRow, 9).Value      'varType(arrCompare(5)) = 8\n\n'I intend to use this function to compare all 6 array variables but for now am stuck getting 1 at a time to work\nvarRes = Application.Match(arrCompare(0), shtTigers, 0)\n</code></pre>\n\n<p>Any input on where my script is wrong or causing an error are appreciated.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 2469622, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8087a87c72516ca034dae4f6b3c7a393?s=128&d=identicon&r=PG", "display_name": "sam", "link": "https://stackoverflow.com/users/2469622/sam"}, "edited": false, "score": 0, "creation_date": 1513816229, "post_id": 47916093, "comment_id": 82800561, "body": "Hi, Thanks for your reply  I added the <code>full sequence</code> sub and changed the names of the <code>SaveToPDF()</code> and <code>NewFolder</code> subs to match the macros being called in <code>full sequence</code>  However, now when I link the macro to the button I get the error: &quot;System Error &amp;H8007007B (-2147024773)&quot;"}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 0, "last_activity_date": 1513814935, "creation_date": 1513814935, "answer_id": 47916093, "question_id": 47915990, "link": "https://stackoverflow.com/questions/47915990/visual-basic-excel-run-2-macros-through-1-button/47916093#47916093", "title": "Visual Basic (Excel) Run 2 Macros through 1 button?", "body": "<p>You can call several macros sequentially. For example, if you link your button to the macro <code>fullSequence</code>, then you can run first the creation of the folder and then the export of the file into that folder: </p>\n\n<pre><code>Sub fullSequence()\n    createFolder '&lt;-- call macro 1\n    exportFile '&lt;-- call macro 2\nEnd Sub\n</code></pre>\n\n<p>In your specific case, you just need to modify the code of the macro <code>NewFolder</code> from this: </p>\n\n<pre><code>ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n     \"D:\\\" &amp; strFileName &amp; \".pdf\", _\n     Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _\n:=False, OpenAfterPublish:=True\n</code></pre>\n\n<p>... to this:</p>\n\n<pre><code>ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n     folderName &amp; \"\\\" &amp; strFileName &amp; \".pdf\", _\n     Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _\n:=False, OpenAfterPublish:=True\n</code></pre>\n\n<p>... in order to include <code>folderName</code> (where you already have your folder path) into the export <code>Filename</code> parameter.</p>\n"}], "owner": {"reputation": 5, "user_id": 2469622, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8087a87c72516ca034dae4f6b3c7a393?s=128&d=identicon&r=PG", "display_name": "sam", "link": "https://stackoverflow.com/users/2469622/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 160, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1513814935, "creation_date": 1513814063, "last_edit_date": 1513814604, "question_id": 47915990, "link": "https://stackoverflow.com/questions/47915990/visual-basic-excel-run-2-macros-through-1-button", "title": "Visual Basic (Excel) Run 2 Macros through 1 button?", "body": "<p>Hi I have a button to export my spreadsheet to PDF. </p>\n\n<p>I wish to have that button export the document and save it in a folder called \"Excel Calculator\". Currently I can only get a folder to be created or the document to be exported. I am not sure how to run both commands at once so the document exports and is saved in the excel calculator folder.</p>\n\n<p>Also, how can I change the file path so instead of going into D:\\ like I have specified, it finds the users \"My Documents\" folder.</p>\n\n<pre><code>Sub GetFilenameForPDF()\n Dim strFileName As String, strB1 As String, strWorksheet As String\n\n\n strB1 = Range(\"B1\").Value\n strWorksheet = ActiveSheet.Name\n strFileName = strB1 &amp; \" \" &amp; strWorksheet &amp; \" \" &amp; Format(Date, \"DD-MM-YYYY\")\n\n\nEnd Sub\n\nSub NewFolder()\n\n Dim fso As FileSystemObject\n Dim folderName As String\n\n Set fso = New FileSystemObject\n folderName = \"D:\\Excel Calculator\"\n If fso.FolderExists(folderName) = False Then\n     fso.CreateFolder folderName\n End If\n\n Dim strFileName As String, strB1 As String, strWorksheet As String\n strB1 = Range(\"B1\").Value\n strWorksheet = ActiveSheet.Name\n strFileName = folderName + \"\\\" + strB1 &amp; \" \" &amp; strWorksheet &amp; \" \" &amp; \n Format(Date, \"DD-MM-YYYY\")\n\n ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n     \"D:\\\" &amp; strFileName &amp; \".pdf\", _\n     Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _\n:=False, OpenAfterPublish:=True\n End Sub\n\n Sub SaveToPDF()\n\n Dim strFileName As String, strB1 As String, strWorksheet As String\n strB1 = Range(\"B1\").Value\n strWorksheet = ActiveSheet.Name\n strFileName = strB1 &amp; \" \" &amp; strWorksheet &amp; \" \" &amp; Format(Date, \"DD-MM-YYYY\")\n\n ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n     \"D:\\\" &amp; strFileName &amp; \".pdf\", _\n     Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _\n     :=False, OpenAfterPublish:=True\n     End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1513814296, "post_id": 47915974, "comment_id": 82800070, "body": "It might be dynamically filled with JavaScript based on some event. Does it show up in browser if you disable JavaScript? You can also check <code>EmployeeID.outerHTML</code> to confirm"}, {"owner": {"reputation": 13, "user_id": 9124510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0a379b16bd7e49d63b79f2cc6b39b0?s=128&d=identicon&r=PG&f=1", "display_name": "alvin", "link": "https://stackoverflow.com/users/9124510/alvin"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1513815703, "post_id": 47915974, "comment_id": 82800443, "body": "@Slai, I tried disabling JavaScript and a lot of information don&#39;t show up in the browser including &quot;Employee ID&quot;; running the code with .outerHTML, I get this result: &lt;div id=&quot;empID&quot;&gt;&lt;/div&gt;"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1513816092, "post_id": 47915974, "comment_id": 82800530, "body": "Is that HTML from &quot;view source&quot; or the actual rendered HTML as from (eg) your browser&#39;s Developer Tools?  Your code looks fine."}, {"owner": {"reputation": 13, "user_id": 9124510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0a379b16bd7e49d63b79f2cc6b39b0?s=128&d=identicon&r=PG&f=1", "display_name": "alvin", "link": "https://stackoverflow.com/users/9124510/alvin"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1513818207, "post_id": 47915974, "comment_id": 82801010, "body": "@TimWilliams, I copied it from DOM Explorer. As Slai pointed out, I need to wait for the JavaScript to kick in. I thought, .ReadyState=4 means IE has finished loading and processing any script."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9124510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0a379b16bd7e49d63b79f2cc6b39b0?s=128&d=identicon&r=PG&f=1", "display_name": "alvin", "link": "https://stackoverflow.com/users/9124510/alvin"}, "edited": false, "score": 0, "creation_date": 1513817673, "post_id": 47916240, "comment_id": 82800873, "body": "Got it! It worked. Thank you very much, @Slai. So, I need to wait for the JavaScript to kick in? I thought loop until .readystate=4 is enough."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 13, "user_id": 9124510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0a379b16bd7e49d63b79f2cc6b39b0?s=128&d=identicon&r=PG&f=1", "display_name": "alvin", "link": "https://stackoverflow.com/users/9124510/alvin"}, "edited": false, "score": 0, "creation_date": 1513818466, "post_id": 47916240, "comment_id": 82801073, "body": "@alvin I am guessing it waits for the document to be fully loaded and ready before populating the content, so it&#39;s probably a bit after READYSTATE_COMPLETE"}, {"owner": {"reputation": 13, "user_id": 9124510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0a379b16bd7e49d63b79f2cc6b39b0?s=128&d=identicon&r=PG&f=1", "display_name": "alvin", "link": "https://stackoverflow.com/users/9124510/alvin"}, "edited": false, "score": 0, "creation_date": 1513818487, "post_id": 47916240, "comment_id": 82801083, "body": "Okay, gotcha! I&#39;ll keep that in mind. Thank you very much, @Slai. I really appreciate your help."}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": true, "score": 0, "last_activity_date": 1513817969, "last_edit_date": 1513817969, "creation_date": 1513816278, "answer_id": 47916240, "question_id": 47915974, "link": "https://stackoverflow.com/questions/47915974/how-to-get-innertext-of-an-element-by-referencing-its-id/47916240#47916240", "title": "How to get innerText of an element by referencing its id?", "body": "<p>You can try waiting until the text is filled:</p>\n\n<pre><code>timeout = Now + #0:00:05#  ' to wait up to 5 seconds\n\nWhile EmployeeID.innerText = \"\" And Now &lt; timeout \n    DoEvents\nWend\n\nDebug.Print EmployeeID.innerText\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9124510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0a379b16bd7e49d63b79f2cc6b39b0?s=128&d=identicon&r=PG&f=1", "display_name": "alvin", "link": "https://stackoverflow.com/users/9124510/alvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1182, "favorite_count": 0, "accepted_answer_id": 47916240, "answer_count": 1, "score": 0, "last_activity_date": 1513817969, "creation_date": 1513813970, "last_edit_date": 1531164843, "question_id": 47915974, "link": "https://stackoverflow.com/questions/47915974/how-to-get-innertext-of-an-element-by-referencing-its-id", "title": "How to get innerText of an element by referencing its id?", "body": "<p>Code Masters!</p>\n\n<p>Newbie here! I was trying to create a tool for scraping texts from a website using .innerText method by referencing elements by its id, but with some ids I only get spaces and/or breaks.</p>\n\n<p>Here's the webpage's source code:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;div id=\"empName\"&gt;\r\n  &lt;h2&gt;Employee Name&lt;/h2&gt;\r\n  &lt;div class=\"clear\"&gt;&lt;/div&gt;\r\n  &lt;span style=\"font-family:Arial; font-weight:bold\"&gt;\r\n    &lt;div id=\"empID\"&gt;Employee ID&lt;/div&gt;\r\n  &lt;/span&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Here's my VBA code:</p>\n\n<pre><code>Option Explicit\n\nSub SampleCode()\n\nDim IE As New SHDocVw.InternetExplorer\nDim HTMLDoc As MSHTML.IHTMLDocument\nDim EmployeeName As MSHTML.IHTMLElement\nDim EmployeeID As MSHTML.IHTMLElement\nDim URL As String\n\nURL = \"www.example\"\n\nWith IE\n    .Visible = True\n    .FullScreen = True\n    .Navigate URL\nEnd With\n\nDo\nLoop Until IE.ReadyState = READYSTATE_COMPLETE And IE.Busy &lt;&gt; True\n\nSet HTMLDoc = IE.Document\nSet EmployeeName = HTMLDoc.getElementById(\"empName\")\nSet EmployeeID = HTMLDoc.getElementById(\"empID\")\n\nDebug.Print EmployeeName.tagName, EmployeeName.innerText, EmployeeID.tagName, EmployeeID.innerText\n\nIE.FullScreen = False\nIE.Quit\nSet IE = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Here's the result as shown from Immediate Window:</p>\n\n<pre><code>DIV           Employee Name           DIV           \n</code></pre>\n\n<p>I followed tutorials from YouTube but I couldn't get the text from \"empID\" id attribute. Any suggestion will be much appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 532, "user_id": 8994815, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/edf34942883bbc3c51d9c5ce4af5911c?s=128&d=identicon&r=PG", "display_name": "ACatInLove", "link": "https://stackoverflow.com/users/8994815/acatinlove"}, "edited": false, "score": 0, "creation_date": 1513812964, "post_id": 47915808, "comment_id": 82799747, "body": "<i>Used to compare two object reference variables.</i> <b>Syntax</b>  <code>result = object1 Is object2</code>. From Help. Use <code>=</code>."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1513813037, "post_id": 47915808, "comment_id": 82799764, "body": "<code>egg</code> is only visible inside <code>Worksheet_Activate</code> - if you want it to be visible inside <code>Worksheet_BeforeDoubleClick</code> then make it a global (declared at the top of the module)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 532, "user_id": 8994815, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/edf34942883bbc3c51d9c5ce4af5911c?s=128&d=identicon&r=PG", "display_name": "ACatInLove", "link": "https://stackoverflow.com/users/8994815/acatinlove"}, "edited": false, "score": 0, "creation_date": 1513813188, "post_id": 47915808, "comment_id": 82799797, "body": "@ACatInLove - see <a href=\"https://www.techonthenet.com/excel/formulas/case.php\" rel=\"nofollow noreferrer\">techonthenet.com/excel/formulas/case.php</a> (at the end)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1513813303, "post_id": 47915808, "comment_id": 82799824, "body": "Can they click <code>U35</code>, then any other cell, then <code>AF35</code>? Or is it back to back?"}], "answers": [{"tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 1, "last_activity_date": 1513813325, "creation_date": 1513813325, "answer_id": 47915889, "question_id": 47915808, "link": "https://stackoverflow.com/questions/47915808/hold-onto-variable-value-in-vba/47915889#47915889", "title": "Hold onto variable value in VBA", "body": "<p>You need to globally declare your variable <code>egg</code>, out of the macro <code>Private Sub Worksheet_Activate()</code>, so that it keeps its value even once you get out of the local context. </p>\n\n<pre><code>Dim egg As Integer '&lt;-- global declaration (on top of module)\nPrivate Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    'rest of your code\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1513814141, "last_edit_date": 1513814141, "creation_date": 1513813438, "answer_id": 47915902, "question_id": 47915808, "link": "https://stackoverflow.com/questions/47915808/hold-onto-variable-value-in-vba/47915902#47915902", "title": "Hold onto variable value in VBA", "body": "<p>You can declare a global variable, and set it on the Worksheet Activate, and fix the <code>Select Case</code> a little:</p>\n\n<pre><code>Dim egg As Long\nPrivate Sub Worksheet_Activate()\n    egg = 0\nEnd Sub\nPrivate Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    Debug.Print (egg)\n    Select Case egg\n        Case Is = 0\n            If Not Intersect(Target, Range(\"U35\")) Is Nothing Then\n                MsgBox (\"First action captured\")\n                egg = 1\n            End If\n        Case Is = 1\n            If Not Intersect(Target, Range(\"AF35\")) Is Nothing Then\n                MsgBox (\"Second action captured\")\n               ' Do things here when they're clicked back-to-back\n            End If\n            egg = 0\n    End Select\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 535, "user_id": 2854647, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/198e1025a309115c12c98888f46f5e88?s=128&d=identicon&r=PG&f=1", "display_name": "Maki", "link": "https://stackoverflow.com/users/2854647/maki"}, "is_accepted": false, "score": 0, "last_activity_date": 1513816772, "creation_date": 1513816772, "answer_id": 47916305, "question_id": 47915808, "link": "https://stackoverflow.com/questions/47915808/hold-onto-variable-value-in-vba/47916305#47916305", "title": "Hold onto variable value in VBA", "body": "<p><strong>Problem</strong><BR>\n\"Worksheet_BeforeDoubleClick\" is unable to recognize \"egg\" from \"Worksheet_Activate\" because they are private subs.</p>\n\n<p>There are 2 types of subs in VBA, private and public. There are some exceptions, generally speaking <strong>information inside a private sub cannot be accessed from another sub</strong>.</p>\n\n<p><strong>Solution(s)</strong><BR>\nA) define the variable as a global object<BR>\nB) define the variable inside the sub it will be used</p>\n\n<p><strong>A) define the variable as a global object</strong></p>\n\n<pre><code>Public egg as Integer\n\n\n\nPrivate Sub Worksheet_Activate()\n    egg = 0\n    'this is not necessary, you can set it inside BeforeDoubleClick\nEnd Sub\n\n\n\nPrivate Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    *your code*\nEnd Sub\n</code></pre>\n\n<p><BR>\n<BR>\n<strong>B) define the variable inside the sub it will be used</strong></p>\n\n<pre><code>Private Sub Worksheet_Activate()\nEnd Sub\n\n\nPrivate Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    Dim egg as Integer\n    egg = 0\n    *your code*\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1080, "user_id": 1656909, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/90660e1260fdbf5ca9b5d261c1a065ae?s=128&d=identicon&r=PG", "display_name": "Jonny Wright", "link": "https://stackoverflow.com/users/1656909/jonny-wright"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 699, "favorite_count": 0, "accepted_answer_id": 47915889, "answer_count": 3, "score": -1, "last_activity_date": 1513816772, "creation_date": 1513812575, "question_id": 47915808, "link": "https://stackoverflow.com/questions/47915808/hold-onto-variable-value-in-vba", "title": "Hold onto variable value in VBA", "body": "<p>For some reason, when using a <code>Select Case</code> statement in VBA, I seem to be losing my variable value once the statement completes.</p>\n\n<p>For context, I am trying to capture a double click action on two specific cells, in a specific order. The point is for a hidden function, so to run the function a user must first double click on cell <code>U35</code>, which should set the <code>egg</code> variable to <code>1</code>. Then, if the user double clicks on cell <code>AF35</code>, AND the <code>egg</code> variable is set to <code>1</code>, then the function will run. </p>\n\n<p>The problem I am having is that after double clicking cell <code>U35</code>, the <code>egg</code> variable gets set to <code>null</code>, hence the second <code>Case</code> statement is never reached.</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n    Dim egg\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    Select Case egg\n        Case Is = 0\n            If Not Intersect(Target, Range(\"U35\")) Is Nothing Then\n                MsgBox (\"First action captured\")\n                egg = 1\n            End If\n        Case Is = 1\n            If Not Intersect(Target, Range(\"AF35\")) Is Nothing Then\n                MsgBox (\"Second action captured\")\n                egg = 0\n            End If\n    End Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-access-2016"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1513813328, "post_id": 47915773, "comment_id": 82799833, "body": "You can&#39;t add a multi-field record to a single-field recordset. Instead of selecting only the ID, select all the fields you&#39;d need to add and then check rst.EOF to see if there&#39;s no existing record."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1513813838, "post_id": 47915773, "comment_id": 82799958, "body": "Would also be helpful to remove the <code>On Error Resume Next</code> and try to fix any errors, or you may end up inserting bad/missing data."}, {"owner": {"reputation": 13, "user_id": 4506163, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ohyJmALOhBE/AAAAAAAAAAI/AAAAAAAAAbc/eqyklg8OV2g/photo.jpg?sz=128", "display_name": "Jacqueline Trout", "link": "https://stackoverflow.com/users/4506163/jacqueline-trout"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1520630644, "post_id": 47915773, "comment_id": 85409984, "body": "This project got back-burner&#39;d but is on the flames again. I commented out the error suppression and cleaned a few things up, but even using .EOF and Using &quot;Select * FROM AdHocReport...&quot; I&#39;m not catching the duplicates. Any other ideas? TIA!"}], "owner": {"reputation": 13, "user_id": 4506163, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ohyJmALOhBE/AAAAAAAAAAI/AAAAAAAAAbc/eqyklg8OV2g/photo.jpg?sz=128", "display_name": "Jacqueline Trout", "link": "https://stackoverflow.com/users/4506163/jacqueline-trout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513812305, "creation_date": 1513812305, "last_edit_date": 1531164843, "question_id": 47915773, "link": "https://stackoverflow.com/questions/47915773/check-for-duplicates-of-values-excel-vba-to-access", "title": "Check for duplicates of values, Excel VBA to Access?", "body": "<p>I'm attempting to add information to an .accdb from an Excel worksheet but want first to compare one value to make certain it doesn't already exist in the table, and if so, skip it and move on to the next row. The add information portion of the code works when I don't try to verify that it doesn't already exists, but I can't get the comparison to. Any help is appreciated, thanks!</p>\n\n<pre><code>Sub UploadData()\n\nDim con As Object, cmd As Object, rst As Object\nDim Path As String\nDim WS As Worksheet\nDim L As Range\nDim LT As Long, LC As Long, R As Long\nDim D1 As Date, D2 As Date\n\nDim PRODL As Integer, TNAME As Integer, CName As Integer, VNAME As Integer, ACTNO As Integer, SOURC As Integer, BATID As Integer, BILID As Integer\nDim CONDT As Integer, BILDT As Integer, DUEDT As Integer, BEGDT As Integer, ENDDT As Integer, PRBAL As Integer, CCHRG As Integer, IMGLC As Integer\n\nDim i As Integer, Lcol As Integer, LRow As Integer\nDim Calc As Double, CL As Double, CW As Double\nDim Z As String\n\nSet con = CreateObject(\"ADODB.Connection\"): Set cmd = CreateObject(\"ADODB.Command\"): Set rst = CreateObject(\"ADODB.RecordSet\"):\nPath = Sheets(\"AuditTool\").Range(\"B2\").Value\n\nSet WS = Worksheets(\"TestBed\")\nWith WS\n    Lcol = .Cells(1, .Columns.Count).End(xlToLeft).Column\nEnd With\n\nPRODL = 0\nTNAME = 0\nCName = 0\nVNAME = 0\nACTNO = 0\nSOURC = 0\nBATID = 0\nBILID = 0\nCONDT = 0\nBILDT = 0\nDUEDT = 0\nBEGDT = 0\nENDDT = 0\nPRBAL = 0\nCCHRG = 0\nIMGLC = 0\n\n\nFor i = 1 To Lcol\n    Z = LCase(WS.Cells(1, i).Value)\n    If Z = \"productline\" Then\n        PRODL = i\n    End If\n    If Z = \"teamname\" Then\n        TNAME = i\n    End If\n    If Z = \"clientname\" Then\n        CName = i\n    End If\n    If Z = \"vendor\" Then\n        VNAME = i\n    End If\n    If Z = \"accountnumber\" Then\n        ACTNO = i\n    End If\n    If Z = \"billreceiptmethod\" Then\n        SOURC = i\n    End If\n    If Z = \"idbatch\" Then\n        BATID = i\n    End If\n    If Z = \"idbill\" Then\n        BILID = i\n    End If\n    If Z = \"consolidationcreatedon\" Then\n        CONDT = i\n    End If\n    If Z = \"billdate\" Then\n        BILDT = i\n    End If\n    If Z = \"pastduedate\" Then\n        DUEDT = i\n    End If\n    If Z = \"begindate\" Then\n        BEGDT = i\n    End If\n    If Z = \"enddate\" Then\n        ENDDT = i\n    End If\n    If Z = \"previousbalance\" Then\n        PRBAL = i\n    End If\n    If Z = \"currentcharges\" Then\n        CCHRG = i\n    End If\n    If Z = \"imagelocation\" Then\n        IMGLC = i\n    End If\nNext i    \n\nWith WS\n    Set L = .Cells(.Rows.Count, \"B\").End(xlUp)\n    LC = L.Row\nEnd With\nIf LC &lt; 2 Then\n    LC = 2\nEnd If\nLT = LC - 1 'count bill IDs\n\ncon.ConnectionString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; Path &amp; \";Persist Security Info=False;\"\ncon.ConnectionTimeout = 0: con.CommandTimeout = 0: con.Open: cmd.CommandTimeout = 0: Set cmd.ActiveConnection = con\n\nR = 2\n\nOn Error Resume Next\n\nWith WS\n    Do While .Cells(R, 2) &lt;&gt; \"\"\n\n        AdHocID = 0\n        rst.Open \"SELECT [ID] FROM AdHocReport WHERE (BillID = \" &amp; WS.Cells(R, BILID).Value &amp; \")\", con, 1, 3\n        AdHocID = rst![ID]\n\n        With rst\n            If AdHocID = 0 Then\n            .AddNew ' create a new record\n            .Fields(\"BillID\") = WS.Cells(R, BILID).Value\n            .Fields(\"ProductLine\") = WS.Cells(R, PRODL).Value\n            .Fields(\"TxName\") = WS.Cells(R, TNAME).Value\n            .Fields(\"CxName\") = WS.Cells(R, CName).Value\n            .Fields(\"VxName\") = WS.Cells(R, VNAME).Value\n            .Fields(\"AcctNo\") = WS.Cells(R, ACTNO).Value\n            .Fields(\"Source\") = WS.Cells(R, SOURC).Value\n            .Fields(\"BatchID\") = WS.Cells(R, BATID).Value\n            .Fields(\"ConsolidationDate\") = WS.Cells(R, CONDT).Value\n            .Fields(\"BillDate\") = WS.Cells(R, BILDT).Value\n            .Fields(\"DueDate\") = WS.Cells(R, DUEDT).Value\n            .Fields(\"BeginDate\") = WS.Cells(R, BEGDT).Value\n            .Fields(\"EndDate\") = WS.Cells(R, ENDDT).Value\n            .Fields(\"PreviousBalance\") = WS.Cells(R, PRBAL).Value\n            .Fields(\"CCharges\") = WS.Cells(R, CCHRG).Value\n            .Fields(\"ImgLoc\") = WS.Cells(R, IMGLC).Value\n            '    .Fields(\"SumAcctNo\") = WS.Cells(2, SUMAC).Value\n            .Update\n            R = R + 1\n            Else\n            R = R + 1\n            End If\n        End With\n    Loop\nEnd With\n\nMsgBox LT &amp; \" Bill IDs Successfully Uploaded\"\n\nrst.Close\ncon.Close\n\nWS.UsedRange.ClearContents\n\nEnd Sub\n</code></pre>\n\n<p>I'm not sure if I'm doing the check in the right order. The way it is written, it detects the first duplicate and skips the insert, but the AdHocID value never changes. Please let me know what you think.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1513813305, "post_id": 47915731, "comment_id": 82799825, "body": "The sheetnames <i>are</i> the tab names - what do you mean?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513813591, "post_id": 47915731, "comment_id": 82799899, "body": "The only time you will get caught out by the user renaming a sheet would be the spot where you say <code>populateSh = &quot;Reconciled&quot;</code>.  You can get around that by using <code>populateSh = ReconciledSheet.Name</code> (assuming the sheet which currently has a <code>Name</code> of <code>&quot;Reconciled&quot;</code> has a <code>CodeName</code> of <code>ReconciledSheet</code> - so just change that bit to whatever code name you actually gave it in the VBE properties window)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1513849825, "post_id": 47915731, "comment_id": 82811888, "body": "Note: I recommend <a href=\"https://stackoverflow.com/a/26409520/3219613\">always to use <code>Long</code> instead of <code>Integer</code></a> especially when dealing with row counts. Excel has more rows than <code>Integer</code> can handle."}], "answers": [{"tags": [], "owner": {"reputation": 121, "user_id": 9086188, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/038d12c507d0067c56dc6ea8cd28330f?s=128&d=identicon&r=PG", "display_name": "AmBo", "link": "https://stackoverflow.com/users/9086188/ambo"}, "is_accepted": false, "score": 0, "last_activity_date": 1513815032, "creation_date": 1513815032, "answer_id": 47916113, "question_id": 47915731, "link": "https://stackoverflow.com/questions/47915731/excel-vba-script-to-transfer-rows-from-one-worksheet-to-another-based-on-a-certa/47916113#47916113", "title": "Excel VBA script to transfer rows from one worksheet to another based on a certain value", "body": "<pre><code>Sub Update_Reconciled()\nApplication.ScreenUpdating = False\n\nDim T2()\nSet D1 = CreateObject(\"scripting.dictionary\")\nSet R1 = Sheet1.UsedRange 'update Sheet1 to match DAILY_SHOP_FILE code name\nT1 = R1\na = 1\n\nFor i = 2 To UBound(T1)\n    If Trim(UCase(T1(i, UBound(T1, 2)))) = \"YES\" Then\n        D1(i) = i\n        ReDim Preserve T2(1 To UBound(T1, 2), 1 To a)\n        For j = 1 To UBound(T1, 2)\n            T2(j, a) = T1(i, j)\n        Next j\n        a = a + 1\n    End If\nNext i\n\nIf a &gt; 1 Then\n    Sheet2.Range(\"A99999\").End(xlUp).Offset(1, 0).Resize(UBound(T2, 2), UBound(T2, 1)) = Application.Transpose(T2) 'update Sheet2 to match Reconciled code name\n\n    cnt = 0\n    For Each k In D1.items\n        Sheet1.Rows(k - cnt).Delete 'update Sheet1 to match DAILY_SHOP_FILE code name\n        cnt = cnt + 1\n    Next k\nEnd If\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1513817467, "creation_date": 1513817467, "answer_id": 47916392, "question_id": 47915731, "link": "https://stackoverflow.com/questions/47915731/excel-vba-script-to-transfer-rows-from-one-worksheet-to-another-based-on-a-certa/47916392#47916392", "title": "Excel VBA script to transfer rows from one worksheet to another based on a certain value", "body": "<p>Sorry for not looking at your specific setup, but here is a generic solution that should work fine for you, with just a bit of customization.  This is general enough to help others as well.</p>\n\n<pre><code>Sub NewSheetData()\n\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\nDim Rng As Range\n\nSet Rng = Range([A1], Range(\"A\" &amp; Rows.Count).End(xlUp))\n\nOn Error Resume Next\n    With Rng\n        .AutoFilter , field:=1, Criteria1:=\"network\", Operator:=xlOr, Criteria2:=\"telcom\"\n        .SpecialCells(xlCellTypeVisible).EntireRow.Copy Sheets(\"Sheet2\").Range(\"A1\")\n        .AutoFilter\n    End With\nOn Error GoTo 0\n\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9124780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d8aedec57fc5681abc47246363dd47e?s=128&d=identicon&r=PG&f=1", "display_name": "WallaceBrigsby", "link": "https://stackoverflow.com/users/9124780/wallacebrigsby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1513849753, "creation_date": 1513812055, "last_edit_date": 1513849753, "question_id": 47915731, "link": "https://stackoverflow.com/questions/47915731/excel-vba-script-to-transfer-rows-from-one-worksheet-to-another-based-on-a-certa", "title": "Excel VBA script to transfer rows from one worksheet to another based on a certain value", "body": "<p>I am a novice when it comes to Excel VBA and Macros. I have a workbook that contains two primary sheets - \"DAILY_SHOP_FILE\" and \"Reconciled\", the former serves as an order sheet and the latter serves as an archive sheet for the orders once they have been shipped. I want to write a VBA Script/Macro that transfers an entire row from the DAILY_SHOP_FILE to the Reconciled sheet when a user inputs the value \"yes\" into the final column. Both sheets will have the same headers in row 1. I found a code on here and modified it slightly to my needs: </p>\n\n<pre><code>Dim keyColumn As Integer\nDim i As Integer\nDim keyWord As Variant 'I've used variant, so you can choose your own data type for the keyword\nDim dataSh As String 'I'm using sheet names for sheet referencing\nDim populateSh As String\nDim rowNum As Integer\nDim dataRow() As Variant\n\nSub Populate()\n'set the column number, which contains the keywords, the keyword itself,\n'name of the sheet to populate and the row offset you'd like to start populating\n    populateSh = \"Reconciled\"\n    keyColumn = 15\n    keyWord = \"yes\"\n    rowNum = 1\n    'assuming you run the macro in the sheet you get the data from, get its name to return to it after copying the row\n    dataSh = ActiveSheet.Name\n'loop through all the used cells in the column\n    For i = 1 To ActiveSheet.UsedRange.Rows.Count\n        If Cells(i, keyColumn) = keyWord Then\n'starting in row 1 in the sheet you populate, you'll have to set the rowNum variable to desired offset few lines above\n        rowNum = rowNum + 1\n        Call copyRow(i, rowNum)\n    End If\n Next i\nEnd Sub\n\nSub copyRow(ByVal cRow As Integer, ByVal pRow As Integer)\n    Dim colNum As Integer\n'set the number of columns you'd like to copy\n   colNum = 15\n'redimension the array to carry the data to other sheet\n'this can be done any way you,d like, but I'm using array for flexibility\n   ReDim dataRow(1 To colNum)\n'put the data into the array, as an example I'm using columns 1-15 while skipping the keyword column.\n     dataRow(1) = Cells(cRow, 1)\n     dataRow(2) = Cells(cRow, 2)\n     dataRow(3) = Cells(cRow, 3)\n     dataRow(4) = Cells(cRow, 4)\n     dataRow(5) = Cells(cRow, 5)\n     dataRow(6) = Cells(cRow, 6)\n     dataRow(7) = Cells(cRow, 7)\n     dataRow(8) = Cells(cRow, 8)\n     dataRow(9) = Cells(cRow, 9)\n     dataRow(10) = Cells(cRow, 10)\n     dataRow(11) = Cells(cRow, 11)\n     dataRow(12) = Cells(cRow, 12)\n     dataRow(13) = Cells(cRow, 13)\n     dataRow(14) = Cells(cRow, 14)\n     dataRow(15) = Cells(cRow, 15)\n     Sheets(populateSh).Select\n        For p = 1 To UBound(dataRow)\n        Cells(pRow, p) = dataRow(p)\n        Next p\n    Sheets(dataSh).Select\nEnd Sub\n</code></pre>\n\n<p>It works well but the only problem is it doesn't actually delete the row from the DAILY_SHOP_FILE. How could I solve this? Additionally, it'd be nice to refer to the sheetnames as per the VBA rather than the actual tab names because if a user renamed one of the tabs the code wouldn't work anymore. Thank You!</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1513817695, "post_id": 47915687, "comment_id": 82800879, "body": "Not that I know of."}], "answers": [{"comments": [{"owner": {"reputation": 862, "user_id": 5338928, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84ced5d4f9d2639dc03ef3a2accd6161?s=128&d=identicon&r=PG&f=1", "display_name": "TheDoomDestroyer", "link": "https://stackoverflow.com/users/5338928/thedoomdestroyer"}, "edited": false, "score": 0, "creation_date": 1513865890, "post_id": 47917187, "comment_id": 82821614, "body": "In other words, you say I should remove the Toggle Button and use an image instead?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 862, "user_id": 5338928, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84ced5d4f9d2639dc03ef3a2accd6161?s=128&d=identicon&r=PG&f=1", "display_name": "TheDoomDestroyer", "link": "https://stackoverflow.com/users/5338928/thedoomdestroyer"}, "edited": false, "score": 0, "creation_date": 1513870370, "post_id": 47917187, "comment_id": 82824621, "body": "Only way I can see to get the effect you describe."}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1513826114, "last_edit_date": 1513826114, "creation_date": 1513824189, "answer_id": 47917187, "question_id": 47915687, "link": "https://stackoverflow.com/questions/47915687/ms-access-toggle-button-background/47917187#47917187", "title": "MS Access Toggle Button background", "body": "<p>I am sure this is related to your other question at <a href=\"https://stackoverflow.com/questions/47914489/ms-access-togglebutton-picture-change?noredirect=1#comment82798399_47914489\">MS Access ToggleButton Picture change</a>. </p>\n\n<p>Use an Image control with embedded image and this code (note declaration of public variable in header):</p>\n\n<pre><code>Option Compare Database\nOption Explicit\nPublic booMenu\n\nSub timeout(duration_ms As Double)\n    Dim Start_Time As Double\n    Start_Time = Timer\n    Do\n        DoEvents\n    Loop Until (Timer - Start_Time) &gt;= duration_ms\nEnd Sub\n\nPrivate Sub Image5_Click()\n    Dim x As Integer\n    booMenu = Not booMenu\n    Me.Menu.Visible = True\n    Do\n        DoEvents\n        Me.Menu.Width = Me.Menu.Width + IIf(booMenu, 200, -200)\n        Me.Menu.Left = Me.Menu.Left - IIf(booMenu, 200, -200)\n        Me.Image5.Left = Me.Image5.Left - IIf(booMenu, 200, -200)\n        timeout (0.01)\n        x = x + 1\n    Loop Until x = 10\n    Me.Menu.Visible = booMenu\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 862, "user_id": 5338928, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84ced5d4f9d2639dc03ef3a2accd6161?s=128&d=identicon&r=PG&f=1", "display_name": "TheDoomDestroyer", "link": "https://stackoverflow.com/users/5338928/thedoomdestroyer"}, "is_accepted": true, "score": 0, "last_activity_date": 1513981049, "creation_date": 1513981049, "answer_id": 47947963, "question_id": 47915687, "link": "https://stackoverflow.com/questions/47915687/ms-access-toggle-button-background/47947963#47947963", "title": "MS Access Toggle Button background", "body": "<p>I managed to find (kind of) a solution to this. The solution was to change the following parameters:</p>\n\n<pre><code>Use Theme = No; \nBackColor = Form Color; \nPressed Back Color = Form Color\n</code></pre>\n\n<p>Eventually, it provides an effect very similar to the one that I was trying to achieve.</p>\n"}], "owner": {"reputation": 862, "user_id": 5338928, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84ced5d4f9d2639dc03ef3a2accd6161?s=128&d=identicon&r=PG&f=1", "display_name": "TheDoomDestroyer", "link": "https://stackoverflow.com/users/5338928/thedoomdestroyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 597, "favorite_count": 0, "accepted_answer_id": 47947963, "answer_count": 2, "score": 0, "last_activity_date": 1513981049, "creation_date": 1513811712, "last_edit_date": 1513817675, "question_id": 47915687, "link": "https://stackoverflow.com/questions/47915687/ms-access-toggle-button-background", "title": "MS Access Toggle Button background", "body": "<p>Is it possible to totally remove the background color and the border of a toggle button in Access? As shown in the Imgur picture, I'd like to remove the grey-ish background and the border of the button totally so I'd keep the white icon (that list icon) only. Would that even be possible?</p>\n\n<p><img src=\"https://i.stack.imgur.com/Zx2X3.jpg\" alt=\"Image\"></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1513810772, "post_id": 47915551, "comment_id": 82799159, "body": "Sounds like you want Data Validation.  It already exists on the Data tab."}, {"owner": {"reputation": 402, "user_id": 5373329, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153280169888425/picture?type=large", "display_name": "Bharat Anand", "link": "https://stackoverflow.com/users/5373329/bharat-anand"}, "edited": false, "score": 0, "creation_date": 1513813417, "post_id": 47915551, "comment_id": 82799860, "body": "Maybe if you explain the background and provide additional info on how exactly you want this to work someone might be able to help you out e.g. how the data will be entered, yourself of someone else, when do you want the data validation to kick in, after each cell is entered or after a set of values in A2:A6 has been entered, etc. background will help us understand your needs"}, {"owner": {"reputation": 1, "user_id": 9124783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a480d8d731fca42a5f57179ddf291377?s=128&d=identicon&r=PG&f=1", "display_name": "mar02345", "link": "https://stackoverflow.com/users/9124783/mar02345"}, "edited": false, "score": 0, "creation_date": 1513842172, "post_id": 47915551, "comment_id": 82807776, "body": "The data will be entered by someone else and I want the data validation to kick in after each cell is entered i.e. if a value is inserted in A3 then the code should check if it&#39;s matching the data from sheet2 range(D2:D6)"}], "answers": [{"tags": [], "owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "is_accepted": false, "score": 0, "last_activity_date": 1513814081, "creation_date": 1513814081, "answer_id": 47915993, "question_id": 47915551, "link": "https://stackoverflow.com/questions/47915551/check-if-the-values-from-a-column-match-the-range-from-a-different-sheet/47915993#47915993", "title": "Check if the values from a column match the range from a different sheet", "body": "<p>You can create a Worksheet Change event and then you can see if the changed cells are included in the range you care about, and then process the range.</p>\n\n<p>See this article: <a href=\"https://support.microsoft.com/en-us/help/213612/how-to-run-a-macro-when-certain-cells-change-in-excel\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/help/213612/how-to-run-a-macro-when-certain-cells-change-in-excel</a></p>\n\n<p>Alternatively, you can create a UDF that takes a range, and pass in the range <code>A2:A6</code>, then each time a cell is changed, the UDF will be called and you can call your function.</p>\n\n<pre><code>Dim RefreshCount as Integer\n\nFunction DoRefresh(r As Range) As String\n    change()\n    DoRefresh = \"Refresh \" &amp; RefreshCount\nEnd Function\n</code></pre>\n\n<p>Put a formula in a cell <code>=DoRefresh(A2:A6)</code>. You can change the result to not count the refreshes if you prefer.</p>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 9120237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e8e0274274523c40151b2e8f2c6646?s=128&d=identicon&r=PG&f=1", "display_name": "alexc", "link": "https://stackoverflow.com/users/9120237/alexc"}, "is_accepted": false, "score": 0, "last_activity_date": 1513932301, "creation_date": 1513932301, "answer_id": 47938380, "question_id": 47915551, "link": "https://stackoverflow.com/questions/47915551/check-if-the-values-from-a-column-match-the-range-from-a-different-sheet/47938380#47938380", "title": "Check if the values from a column match the range from a different sheet", "body": "<p>just a quick follow up. I made the code to somehow work. The only thing I did it was to change  <strong>Sub check()</strong> to <strong>Private Sub Worksheet_Change(ByVal Target As Range)</strong>.</p>\n\n<p>The problem is that my excel sheet loads really slow when I insert data in the column where the code is suppose to do its job. It takes ages for the code to load and check the entries. Is this because I have many vba code in my Excel sheet?</p>\n\n<p>Note: If I copy only the code mentioned below in a new Excel sheet, the code works super fast, in a second.</p>\n"}], "owner": {"reputation": 1, "user_id": 9124783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a480d8d731fca42a5f57179ddf291377?s=128&d=identicon&r=PG&f=1", "display_name": "mar02345", "link": "https://stackoverflow.com/users/9124783/mar02345"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 160, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1513932301, "creation_date": 1513810678, "question_id": 47915551, "link": "https://stackoverflow.com/questions/47915551/check-if-the-values-from-a-column-match-the-range-from-a-different-sheet", "title": "Check if the values from a column match the range from a different sheet", "body": "<p>First, I am new here so I hope I will make myself clear.</p>\n\n<p>So I have 2 sheets: <strong>\"Sheet1\"</strong> and <strong>\"Sheet2\"</strong>. Sheet2 has different values in <strong>range(D2: D6</strong>). The sheet1 <strong>range(A2:A6)</strong> is empty. Every time when I insert data in sheet1 range(A2:A6) it has to check if that data matches the data from sheet2 range(D2: D6). If the data matches in a cell, then it is kept in range(A2:A6), if not it is deleted from range(A2:A6).</p>\n\n<p>Here is the code I made. Unfortunately, I cannot upload the Excel so you guys can see it better. The code works only when I press the bottom I created in the sheet:</p>\n\n<pre><code>Sub check()\n\n\nDim i As Integer, j As Integer\nDim aRec As Worksheet, bRec As Worksheet, wb As Workbook\n\n\nDim aDesc As String, bDesc As String\nDim auxSheet1 As Variant\nDim auxSheet2 As Variant\nDim count As Integer\n\n\nSet wb = Excel.ActiveWorkbook\nSet aRec = wb.Worksheets(1)\nSet bRec = wb.Worksheets(2)\n\n\nFor i = 2 To aRec.UsedRange.Rows.count\ncount = 1\nauxSheet1 = Trim(aRec.Cells(i, 1).Value)\nFor j = 2 To bRec.UsedRange.Rows.count\nauxSheet2 = Trim(bRec.Cells(j, 4).Value)\n\nIf Not auxSheet1 = auxSheet2 Then\ncount = count + 1\nEnd If\n\nIf count = bRec.UsedRange.Rows.count Then\naRec.Cells(i, 1).Value = \"\"\nEnd If\nNext j\nNext i\n\n\nEnd Sub\n</code></pre>\n\n<p>My problem is that this code works only when I am pressing the bottom i created in the Excel file. Instead I want my code to be smarter and avoid pressing the bottom. </p>\n\n<p>What I mean is that every time when an entry is entered in sheet1 range(A2:A6) the code should work automatically and delete the entries which don't match from sheet2 range(d2:d6). I want to delete the bottom and let the code to do its job automatically every time a data is inserted in range(A2:A6) - keep the data that matches, and delete the ones which don't.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010", "userform"], "answers": [{"comments": [{"owner": {"reputation": 300, "user_id": 2898103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fefb0cbb246de6fce75385608681b784?s=128&d=identicon&r=PG&f=1", "display_name": "KenSquare", "link": "https://stackoverflow.com/users/2898103/kensquare"}, "reply_to_user": {"reputation": 39, "user_id": 9038032, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a58bd94ca626b3831492926a127f2099?s=128&d=identicon&r=PG&f=1", "display_name": "shiv chhabra", "link": "https://stackoverflow.com/users/9038032/shiv-chhabra"}, "edited": false, "score": 0, "creation_date": 1513877252, "post_id": 47917131, "comment_id": 82828386, "body": "Can you show your revised code?  I lock controls like this frequently and do you have your issue.  Hmmm..."}, {"owner": {"reputation": 39, "user_id": 9038032, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a58bd94ca626b3831492926a127f2099?s=128&d=identicon&r=PG&f=1", "display_name": "shiv chhabra", "link": "https://stackoverflow.com/users/9038032/shiv-chhabra"}, "edited": false, "score": 0, "creation_date": 1513877694, "post_id": 47917131, "comment_id": 82828588, "body": "sure, here is the code i am using in load event, <code>Dim ctlCurr As Control  For Each ctlCurr In Me.Controls         If ctlCurr.Tag = &quot;Lockable&quot; Then         ctlCurr.Locked = True         End If Next      Me.ShiftDate.Enabled = True     Me.LoginBtn.Enabled = True </code>"}, {"owner": {"reputation": 300, "user_id": 2898103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fefb0cbb246de6fce75385608681b784?s=128&d=identicon&r=PG&f=1", "display_name": "KenSquare", "link": "https://stackoverflow.com/users/2898103/kensquare"}, "reply_to_user": {"reputation": 39, "user_id": 9038032, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a58bd94ca626b3831492926a127f2099?s=128&d=identicon&r=PG&f=1", "display_name": "shiv chhabra", "link": "https://stackoverflow.com/users/9038032/shiv-chhabra"}, "edited": false, "score": 0, "creation_date": 1513880214, "post_id": 47917131, "comment_id": 82829776, "body": "Did you set the Tag property to Locked for all of the controls except LoginBtn and ShiftDate?"}, {"owner": {"reputation": 39, "user_id": 9038032, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a58bd94ca626b3831492926a127f2099?s=128&d=identicon&r=PG&f=1", "display_name": "shiv chhabra", "link": "https://stackoverflow.com/users/9038032/shiv-chhabra"}, "edited": false, "score": 0, "creation_date": 1513881436, "post_id": 47917131, "comment_id": 82830340, "body": "Okay I got it, I its working now. But I am still able to click inside the txtbox, It does not let the user to type however. But i want to let user notice that the fields are disabled and they can only click one button and a txtbox, what if I just replace &quot;ctlCurr.Locked = True&quot; with &quot;ctlCurr.Enabled= True&quot; ?"}, {"owner": {"reputation": 300, "user_id": 2898103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fefb0cbb246de6fce75385608681b784?s=128&d=identicon&r=PG&f=1", "display_name": "KenSquare", "link": "https://stackoverflow.com/users/2898103/kensquare"}, "reply_to_user": {"reputation": 39, "user_id": 9038032, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a58bd94ca626b3831492926a127f2099?s=128&d=identicon&r=PG&f=1", "display_name": "shiv chhabra", "link": "https://stackoverflow.com/users/9038032/shiv-chhabra"}, "edited": false, "score": 0, "creation_date": 1513884138, "post_id": 47917131, "comment_id": 82831750, "body": "Yes, that should work except I think you want Enabled = False.  I just tried that, and the disabled controls are gray and will not allow the user to go into the field."}, {"owner": {"reputation": 300, "user_id": 2898103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fefb0cbb246de6fce75385608681b784?s=128&d=identicon&r=PG&f=1", "display_name": "KenSquare", "link": "https://stackoverflow.com/users/2898103/kensquare"}, "reply_to_user": {"reputation": 39, "user_id": 9038032, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a58bd94ca626b3831492926a127f2099?s=128&d=identicon&r=PG&f=1", "display_name": "shiv chhabra", "link": "https://stackoverflow.com/users/9038032/shiv-chhabra"}, "edited": false, "score": 0, "creation_date": 1513884534, "post_id": 47917131, "comment_id": 82831961, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/161762/discussion-between-kensquare-and-shiv-chhabra\">continue this discussion in chat</a>."}, {"owner": {"reputation": 39, "user_id": 9038032, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a58bd94ca626b3831492926a127f2099?s=128&d=identicon&r=PG&f=1", "display_name": "shiv chhabra", "link": "https://stackoverflow.com/users/9038032/shiv-chhabra"}, "edited": false, "score": 0, "creation_date": 1513884695, "post_id": 47917131, "comment_id": 82832038, "body": "Yes it has fixed the issue, they are all disabled now, thanks man. great work !!"}], "tags": [], "owner": {"reputation": 300, "user_id": 2898103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fefb0cbb246de6fce75385608681b784?s=128&d=identicon&r=PG&f=1", "display_name": "KenSquare", "link": "https://stackoverflow.com/users/2898103/kensquare"}, "is_accepted": true, "score": 1, "last_activity_date": 1513823789, "creation_date": 1513823789, "answer_id": 47917131, "question_id": 47915495, "link": "https://stackoverflow.com/questions/47915495/unable-to-disable-all-fields-of-a-ms-access-userform-on-load/47917131#47917131", "title": "Unable to disable all fields of a ms-access userform on load", "body": "<p>Try locking the control instead.  I have used the locked property below, but I use the tag property of each control to identify it as lockable.  So the controls you don't want to lock will not get anything in the tag property, and therefore will not lock.  For your application, you could flip the logic since you only want leave the two controls unlocked.  </p>\n\n<pre><code>For Each ctlCurr In Me.Controls\n        If ctlCurr.Tag = \"Lockable\" Then\n        ctlCurr.Locked = True\n        End If\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 9038032, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a58bd94ca626b3831492926a127f2099?s=128&d=identicon&r=PG&f=1", "display_name": "shiv chhabra", "link": "https://stackoverflow.com/users/9038032/shiv-chhabra"}, "edited": false, "score": 0, "creation_date": 1513876143, "post_id": 47918908, "comment_id": 82827828, "body": "thanks for clarification on this, well it did not give any error but also did not disable anything. what to do ?"}, {"owner": {"reputation": 416, "user_id": 7564178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-q75MbZldt14/AAAAAAAAAAI/AAAAAAAAYPU/6QHQkGiKJYs/photo.jpg?sz=128", "display_name": "Harshit kyal", "link": "https://stackoverflow.com/users/7564178/harshit-kyal"}, "reply_to_user": {"reputation": 39, "user_id": 9038032, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a58bd94ca626b3831492926a127f2099?s=128&d=identicon&r=PG&f=1", "display_name": "shiv chhabra", "link": "https://stackoverflow.com/users/9038032/shiv-chhabra"}, "edited": false, "score": 0, "creation_date": 1513934723, "post_id": 47918908, "comment_id": 82846876, "body": "@shivchhabra  \t I have edited the above answer. Check above code and tell me if it didn&#39;t work."}], "tags": [], "owner": {"reputation": 416, "user_id": 7564178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-q75MbZldt14/AAAAAAAAAAI/AAAAAAAAYPU/6QHQkGiKJYs/photo.jpg?sz=128", "display_name": "Harshit kyal", "link": "https://stackoverflow.com/users/7564178/harshit-kyal"}, "is_accepted": false, "score": 1, "last_activity_date": 1513881661, "last_edit_date": 1513881661, "creation_date": 1513836533, "answer_id": 47918908, "question_id": 47915495, "link": "https://stackoverflow.com/questions/47915495/unable-to-disable-all-fields-of-a-ms-access-userform-on-load/47918908#47918908", "title": "Unable to disable all fields of a ms-access userform on load", "body": "<p>You can't disable label control that's why that error is coming. You have to check the type of control.</p>\n\n<pre><code> For Each ctrl In Me.Controls\n    With ctrl\n     a = TypeName(ctrl)\n    Select Case .ControlType\n\n        Case acLabel\n\n        Case acEmptyCell\n\n        Case Else\n            ctrl.Enabled = False\n    End Select\n    End With\n\n\n Next ctrl\n</code></pre>\n\n<p>Apply disable only when it's not label.</p>\n"}], "owner": {"reputation": 39, "user_id": 9038032, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a58bd94ca626b3831492926a127f2099?s=128&d=identicon&r=PG&f=1", "display_name": "shiv chhabra", "link": "https://stackoverflow.com/users/9038032/shiv-chhabra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "accepted_answer_id": 47917131, "answer_count": 2, "score": 0, "last_activity_date": 1594638580, "creation_date": 1513810316, "last_edit_date": 1594638580, "question_id": 47915495, "link": "https://stackoverflow.com/questions/47915495/unable-to-disable-all-fields-of-a-ms-access-userform-on-load", "title": "Unable to disable all fields of a ms-access userform on load", "body": "<p>I have lots of controls on my userform and I want to disable all of them on load except for \"login button\" and \"Shift Date\" textbox, so i am using the code below:</p>\n\n<pre><code>Private Sub Form_Load()\nCall GetValues\nMe.WlcmLabel.Caption = \"Hi \" + GetUserName + \" ! \"\n\nDim ctrl As Control\n\nFor Each ctrl In Me.Controls\n    ctrl.Enabled = False\nNext\nMe.ShiftDate.Enabled = True\nMe.LoginBtn.Enabled = True\nSet ctrl = Nothing\nEnd Sub \n</code></pre>\n\n<p>but this gives me an error on load saying \"object does not support this property or method.\"</p>\n\n<p>all the controls will get enabled as soon as the user clicks on login button.</p>\n\n<p>What would be the mistake in my code ?</p>\n\n<p>Please ask if any other information required.\nThank You !</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1513814032, "creation_date": 1513814032, "answer_id": 47915983, "question_id": 47915401, "link": "https://stackoverflow.com/questions/47915401/select-folder-to-save-without-macro-when-user-cancels-dialog-box/47915983#47915983", "title": "Select folder to save without macro when user cancels dialog box", "body": "<p>I dont recommend doing this as it can really annoy the user, but basically you just put it into a <code>Do Loop</code> - something like this (untested)</p>\n\n<pre><code>With fldr\n    .Title = \"Select a Folder to save down the copy of this workbook\"\n    .AllowMultiSelect = False\n    .InitialFileName = strPath\n    Do Until .Show &lt;&gt; -1\n        If .SelectedItems(1) &lt;&gt; \"\" Then GoTo NextCode\n    Loop\nEnd With\n\nNextCode:\n    ChooseFolder = .SelectedItems(1)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 8642998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/456f8997b0327f4b89c0c1d4a8fdb07b?s=128&d=identicon&r=PG&f=1", "display_name": "S.MART", "link": "https://stackoverflow.com/users/8642998/s-mart"}, "edited": false, "score": 0, "creation_date": 1513885960, "post_id": 47915997, "comment_id": 82832680, "body": "i added the code above to my existing code, if the user selects cancel then i get the message box and the the dialog box again. which is exactly what i needed. but now once user has selected the folder the dialog box pop up again, and i don&#39;t know why."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 21, "user_id": 8642998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/456f8997b0327f4b89c0c1d4a8fdb07b?s=128&d=identicon&r=PG&f=1", "display_name": "S.MART", "link": "https://stackoverflow.com/users/8642998/s-mart"}, "edited": false, "score": 0, "creation_date": 1513921569, "post_id": 47915997, "comment_id": 82842161, "body": "@S.MART did you just copy my code without adapting the rest of yours? The code I gave you can\u2019t pop up the dialog box a second time if you select a folder, I think you\u2019re still calling the old code \u2018Set objFolder = objFSO.GetFolder(ChooseFolder)\u2019 right after executing the above."}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 0, "last_activity_date": 1513814109, "creation_date": 1513814109, "answer_id": 47915997, "question_id": 47915401, "link": "https://stackoverflow.com/questions/47915401/select-folder-to-save-without-macro-when-user-cancels-dialog-box/47915997#47915997", "title": "Select folder to save without macro when user cancels dialog box", "body": "<p>If you want to avoid the error you have on \"Cancel\" (coming from the fact that you execute <code>Set objFolder = objFSO.GetFolder(ChooseFolder)</code> on an empty string (since <code>ChooseFolder()</code> returns empty if the user cancels the action) and at the same time ask him twice - why'd you want to ask them twice? - then you should write your macro like this:</p>\n\n<pre><code>Sub SaveWithoutMacro()\n    folderPath = ChooseFolder() '&lt;-- ask them to select once\n    If folderPath = \"\" Then '&lt;-- if they clicked cancel once\n        MsgBox \"You didn't select a folder\", vbCritical, \"Are you sure?\" '&lt;-- message box to inform them\n        folderPath = ChooseFolder() '&lt;-- ask them again to select\n        If folderPath = \"\" Then Exit Sub '&lt;-- if again empty, then exit procedure\n    End If\n    'rest of your save code\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8642998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/456f8997b0327f4b89c0c1d4a8fdb07b?s=128&d=identicon&r=PG&f=1", "display_name": "S.MART", "link": "https://stackoverflow.com/users/8642998/s-mart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 47915997, "answer_count": 2, "score": -1, "last_activity_date": 1513814109, "creation_date": 1513809732, "question_id": 47915401, "link": "https://stackoverflow.com/questions/47915401/select-folder-to-save-without-macro-when-user-cancels-dialog-box", "title": "Select folder to save without macro when user cancels dialog box", "body": "<p>my code prompts user to save the current file as a macro free file, the problem is that if the user hits cancel then i get an error. i need my code to start over when the user hits cancel. so it would be best if a message box pops up and says please select location to save file and then the dialog box pops up again so the user can select where to save file, and if user hits cancel again then just exit. </p>\n\n<pre><code>Sub SaveWithoutMacro()\nDim objFolder As Object, objFSO As Object\n\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet objFolder = objFSO.GetFolder(ChooseFolder)\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\n\nActiveWorkbook.SaveAs Filename:=objFolder &amp; \"\\\" &amp; Left(ThisWorkbook.Name, Len(ThisWorkbook.Name) - 5) &amp; \".xlsx\", FileFormat:=51, password:=\"\", WriteResPassword:=\"\", _\nReadOnlyRecommended:=False, CreateBackup:=False\n\nIf objFolder &lt;&gt; False Then Exit SaveWithoutMacro = objFolder\n\n\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\n\n\n\nEnd Sub\n\nFunction ChooseFolder() As String\nDim fldr As FileDialog\nDim sItem As String\n\nSet fldr = Application.FileDialog(msoFileDialogFolderPicker)\nWith fldr\n    .Title = \"Select a Folder to save down the copy of this workbook\"\n    .AllowMultiSelect = False\n    .InitialFileName = strPath\n    If .Show &lt;&gt; -1 Then GoTo NextCode\n    sItem = .SelectedItems(1)\nEnd With\n\nNextCode:\n    ChooseFolder = sItem\n    Set fldr = Nothing\nEnd Function \n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2243, "user_id": 3389900, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/73283dbb19b8c2ffe975ef7d63fac6ab?s=128&d=identicon&r=PG&f=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/3389900/trevor"}, "edited": false, "score": 0, "creation_date": 1513807610, "post_id": 47915007, "comment_id": 82798099, "body": "I feel like you would have to loop cell by cell, writing the data from one, to the other but swapping a row counter for a column counter when you do."}, {"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1513810471, "post_id": 47915007, "comment_id": 82799062, "body": "Quick workaround... after data is in sheet use the worksheet function: <code>Range(&quot;A1:E1&quot;) = WorksheetFunction.Transpose(Range(&quot;A3:A7&quot;))</code> Note that you&#39;ll have to know your range before and after."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 9124631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4c84575fe82f1020f389684cb610dace?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/9124631/tara"}, "edited": false, "score": 0, "creation_date": 1513811011, "post_id": 47915521, "comment_id": 82799232, "body": "That worked amazingly. Thank you so much, I have been trying this for a week!"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 3, "last_activity_date": 1513810471, "creation_date": 1513810471, "answer_id": 47915521, "question_id": 47915007, "link": "https://stackoverflow.com/questions/47915007/vba-cant-transpose-data-copying-from-one-workbook-to-a-closed-book/47915521#47915521", "title": "VBA Can&#39;t transpose data (Copying from one workbook to a closed book)", "body": "<p>Couple of issues:  </p>\n\n<ul>\n<li>You need to actually transpose the data</li>\n<li>You need to correctly size the destination range based on the transposed source range</li>\n</ul>\n\n<hr>\n\n<pre><code>Sub LessonLearned()\n    Dim destWb As Workbook\n    Dim destSht As Worksheet\n    Dim Data As Variant\n\n    Set destWb = Workbooks.Open(Filename:=\"C:\\Users\\ceasat28\\Documents\\LessonsLearnedTest\\LessonsLearnedLog.xlsx\")\n    Set destSht = destWb.Worksheets(\"DiscoveredLessons\")\n\n    destSht.Unprotect Password:=\"Secret\"\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        With .Range(.Range(\"LL_Data\"), .Range(\"LL_Data\").End(xlDown))\n            Data = Application.Transpose(.Value)\n            destSht.Cells(destSht.Rows.Count, 1).End(xlUp).Offset(1).Resize(.Columns.Count, .Rows.Count).Value = Data\n        End With\n        destSht.Parent.Close True\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9124631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4c84575fe82f1020f389684cb610dace?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/9124631/tara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 47915521, "answer_count": 1, "score": 1, "last_activity_date": 1513810471, "creation_date": 1513807473, "last_edit_date": 1531164843, "question_id": 47915007, "link": "https://stackoverflow.com/questions/47915007/vba-cant-transpose-data-copying-from-one-workbook-to-a-closed-book", "title": "VBA Can&#39;t transpose data (Copying from one workbook to a closed book)", "body": "<p>I am trying to write a code that will copy data from one workbook and save it to a closed book.  The problem is that I need the data transposed from columns to rows.  I have tried paste specials but they did not work.  Below is the code I used that will at least transfer the data from the active sheet to the closed one.</p>\n\n<pre><code>Sub LessonLearned()\n\n  Dim destSht As Worksheet\n\n  Workbooks.Open Filename:=\"C:\\Users\\ceasat28\\Documents\\LessonsLearnedTest\\LessonsLearnedLog.xlsx\"\n  Set destSht = ActiveWorkbook.Worksheets(\"DiscoveredLessons\") \n\n  ActiveSheet.Unprotect Password:=\"Secret\"\n\n  With ThisWorkbook.Worksheets(\"Sheet1\") \n\n    With .Range(.Range(\"LL_Data\"), .Range(\"LL_Data\").End(xlDown)) \n\n      destSht.Cells(destSht.Rows.Count, 1).End(xlUp).Offset(1).Resize(.Rows.Count, .Columns.Count).Value = .Value \n\n    End With\n\n    destSht.Parent.Close True \n  End With\nEnd Sub\n</code></pre>\n\n<p>Can someone please help me transpose the values?</p>\n\n<p>Thanks,\nTara</p>\n"}, {"tags": ["arrays", "excel", "vba", "if-statement", "duplicates"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1513807640, "post_id": 47914960, "comment_id": 82798108, "body": "Where does the &quot;Poor colon prep&quot; come from?  That&#39;s not in your source data."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1513809042, "post_id": 47914960, "comment_id": 82798625, "body": "Care to let us know the decision making of the Summary cells from those columns?"}, {"owner": {"reputation": 1, "user_id": 9124664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f767639ac1b8bef941139ed32f3af73a?s=128&d=identicon&r=PG&f=1", "display_name": "gavin mark", "link": "https://stackoverflow.com/users/9124664/gavin-mark"}, "edited": false, "score": 0, "creation_date": 1513868090, "post_id": 47914960, "comment_id": 82823180, "body": "Hello, Patrick, I need the data in the summary columns because I am forcing a new data extract into an old data set. The old data set only had one reason. My hopes are to simply add the new columns of reasons to the old data set. Tim, the &quot;Poor colon prep&quot; is likely in column S."}], "answers": [{"tags": [], "owner": {"reputation": 317, "user_id": 9124856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ttqxL.png?s=128&g=1", "display_name": "Sercho", "link": "https://stackoverflow.com/users/9124856/sercho"}, "is_accepted": false, "score": 0, "last_activity_date": 1513828639, "creation_date": 1513828639, "answer_id": 47917737, "question_id": 47914960, "link": "https://stackoverflow.com/questions/47914960/extracting-unique-values-from-row-in-excel/47917737#47917737", "title": "Extracting unique values from row in Excel", "body": "<p>So if I understand you correctly, you are going to have a sheet of rows of data. You want to look in the columns T:Z and then generate a list of unique values (non-zero) in the columns AA:AC. I assume that you know you will never have more than 3 unique values, but I can't be sure that this wasn't just an omission.</p>\n\n<p>Either way, the below code should work:</p>\n\n<pre><code>Sub Find_Uniques()\n    Dim X As Integer, Y As Integer, Z As Integer\n    Dim Temp_Strings() As String\n    For X = 1 to 10000 'This assumes you don't have more than 10,000 rows of data\n        ReDim Temp_Strings(1 to 5) As String\n        For Y = 20 to 26\n            If Range(Cells(X,Y).Address).Value &lt;&gt; \"\" And Range(Cells(X,Y).Address).Value &lt;&gt; 0 Then\n                For Z = 1 to 5\n                    If Temp_Strings(Z) = \"\" Then\n                        Temp_Strings(Z) = Range(Cells(X,Y).Address).Value\n                        Exit For\n                    End If\n                    If Temp_Strings(Z) = Range(Cells(X,Y).Address).Value Then Exit For\n                Next Z\n            End If\n        Next Y\n        For Z = 1 to 5\n            If Temp_Strings(Z) &lt;&gt; \"\" Then Range(Cells(X,Z+26).Address)).Value = Temp_String(Z)\n        Next Z\n    Next X\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9124664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f767639ac1b8bef941139ed32f3af73a?s=128&d=identicon&r=PG&f=1", "display_name": "gavin mark", "link": "https://stackoverflow.com/users/9124664/gavin-mark"}, "is_accepted": false, "score": 0, "last_activity_date": 1513889780, "creation_date": 1513889780, "answer_id": 47932596, "question_id": 47914960, "link": "https://stackoverflow.com/questions/47914960/extracting-unique-values-from-row-in-excel/47932596#47932596", "title": "Extracting unique values from row in Excel", "body": "<p>Thank you all for your help. Instead of extracting the data from the row, I wrote a macro that changed the zeros to blanks, deleted the blank cells, and shifted them to the left. After that it was easy to cut the range and paste it into the old data set to be analyzed. </p>\n\n<pre><code>Sub clean_data()\nSheets(\"Reason data\").Range(\"H:Z\").Replace 0, \"\"\n\nCall delete_blanks\nEnd Sub\nSub delete_blanks()\n\nSheets(\"Reason data\").Range(\"H:Z\").SpecialCells(xlCellTypeBlanks).Delete (xlToLeft)\n\nCall move_data\n\nEnd Sub\nSub move_data()\n'Copies reason data and pastes it into data worksheet\n\nSheets(\"Reason data\").Range(\"A3:K3\", Sheets(\"Reason data\").Range(\"A3:F3\").End(xlDown)).Cut _\nSheets(\"Data\").Range(\"A1\").End(xlDown).Offset(1)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9124664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f767639ac1b8bef941139ed32f3af73a?s=128&d=identicon&r=PG&f=1", "display_name": "gavin mark", "link": "https://stackoverflow.com/users/9124664/gavin-mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1513889780, "creation_date": 1513807221, "last_edit_date": 1513836036, "question_id": 47914960, "link": "https://stackoverflow.com/questions/47914960/extracting-unique-values-from-row-in-excel", "title": "Extracting unique values from row in Excel", "body": "<p>I need to summarize unique values from a row into a column that's in the same row. My goal is in the second row of the attached image where <code>T:Z</code> contains the data and <code>AA:AC</code> contains the summary (I typed the values in for the demo). The first row is what is currently occurring where I tried using a nested if function for values greater than zero, but I also tried using an index match function to no avail. The issue is I either receive duplicates in <code>AA:AC</code> or not all values are included. </p>\n\n<p><a href=\"https://i.stack.imgur.com/4MgTT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4MgTT.png\" alt=\"Summary goal\"></a></p>\n\n<p>Currently using Excel 2016</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1513807488, "post_id": 47914907, "comment_id": 82798047, "body": "is there some reason you can&#39;t use Excel filtering?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1513808163, "post_id": 47914907, "comment_id": 82798331, "body": "The &quot;match&quot; parameter for Filter doesn&#39;t take an array.  &quot;I load all the column data in the CodeDef variant&quot; - you&#39;re only loading the <i>last</i> one."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513865330, "post_id": 47914907, "comment_id": 82821237, "body": "And why is Double used for a row number? And you don&#39;t include your declarations and assignments for UN_FILTERED_SHEET and ID_NUM."}], "owner": {"reputation": 218, "user_id": 8761052, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9d0d4f61ff8005bbd8654b09d3842385?s=128&d=identicon&r=PG&f=1", "display_name": "sharsart", "link": "https://stackoverflow.com/users/8761052/sharsart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 215, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513815796, "creation_date": 1513806942, "last_edit_date": 1513815796, "question_id": 47914907, "link": "https://stackoverflow.com/questions/47914907/filter-excel-column-by-array-values-using-vba", "title": "Filter excel column by array values using VBA", "body": "<p>I have an excel column that contains app code followed by a short description of the app (BF00 Account App).  The column is long and there are many apps, I want to filter this column just by app codes.  This is the method I have created but it doesn't seem to be working :/</p>\n\n<pre><code>Private Sub FilterAppCodes()\nDim unfilter As Worksheet\nDim FindOutArray() As String\nDim iRow As Double\nDim CodeDef As Variant\nDim AppCodes As Variant\nAppCodes = Array(\"A0A0\", \"B03B\"....)\nDim iTotRecsA As Double\niRow = 2\nSet unfilter = ThisWorkbook.Sheets(UN_FILTERED_SHEET)\niTotRecsA = unfilter.Range(ID_NUM &amp; Rows.Count).End(xlUp).row\n\n'Use a while loop to loop through the first sheet until Id's are blank\nWhile unfilter.Cells(iRow, 1) &lt;&gt; \"\"\n\n'Load all App codes &amp; description in CodeDef\nCodeDef = unfilter.Cells(iRow, 5)\nDebug.Print (CodeDef)\n\n    iRow = iRow + 1\nWend\nFindOutArray = filter(SourceArray:=CodeDef, _\n       Match:=AppCodes, _\n       Include:=True, _\n       Compare:=vbTextCompare)\n    If UBound(FindOutArray) = -1 Then\n        Debug.Print (\"No, Array doesn't contain this item - \" &amp; strText)\n    Else\n        Debug.Print (\"Yes, Array contains this item - \" &amp; strText)\n    End If\nEnd Sub\n</code></pre>\n\n<p>I load all the column data in the CodeDef variant and I try to compare it with the values in the array. I was wondering if this is right?  I am getting a \"Type mismatch\" error on the FindOutArray = Filter(SourceArray....part.  </p>\n\n<p>Any help would be greatly appreciated </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1513813859, "post_id": 47914868, "comment_id": 82799963, "body": "What code and which line? WshShell&#39;s AppActivate is prone to all sorts of issues for automation. What OS?"}, {"owner": {"reputation": 51, "user_id": 4151676, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000781809701/picture?type=large", "display_name": "Justin Captain Wypij", "link": "https://stackoverflow.com/users/4151676/justin-captain-wypij"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1513814029, "post_id": 47914868, "comment_id": 82800004, "body": "I literally use  AppActivate &quot;google earth&quot; i have Windows 7 and Excel is 2010.   Is there another option?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1513814328, "post_id": 47914868, "comment_id": 82800076, "body": "Nothing else in your code? If just to bring it on top, Google Earth&#39;s window title shouldn&#39;t change. Show us the code then we may pop some ideas out."}, {"owner": {"reputation": 51, "user_id": 4151676, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000781809701/picture?type=large", "display_name": "Justin Captain Wypij", "link": "https://stackoverflow.com/users/4151676/justin-captain-wypij"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1513814527, "post_id": 47914868, "comment_id": 82800123, "body": "Sub Amouse()    AppActivate &quot;google earth&quot;    Application.Run &quot;Module1.AAA&quot; End Sub"}, {"owner": {"reputation": 51, "user_id": 4151676, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000781809701/picture?type=large", "display_name": "Justin Captain Wypij", "link": "https://stackoverflow.com/users/4151676/justin-captain-wypij"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1513814558, "post_id": 47914868, "comment_id": 82800129, "body": "I just ran it and it works the first 3 times then it throws the runtime error 5"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1513814784, "post_id": 47914868, "comment_id": 82800178, "body": "The error may be originated from <code>Module1.AAA</code> which isn&#39;t shown. Edit post instead of code in comment."}, {"owner": {"reputation": 51, "user_id": 4151676, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000781809701/picture?type=large", "display_name": "Justin Captain Wypij", "link": "https://stackoverflow.com/users/4151676/justin-captain-wypij"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1513814883, "post_id": 47914868, "comment_id": 82800206, "body": "It isnt because I just added that today. The error has been happening for weeks LONG before i added the Module1.AAA   When I close Google Earth and run the macro again its fine. But obviously i shouldnt have to do that.   Is there another way to call a application that is already open?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1513815681, "post_id": 47914868, "comment_id": 82800433, "body": "AppActivate is just trying to make the app with window caption to go on top, not launching it. If a Process does not exist, it Err out 5 like you have."}, {"owner": {"reputation": 51, "user_id": 4151676, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000781809701/picture?type=large", "display_name": "Justin Captain Wypij", "link": "https://stackoverflow.com/users/4151676/justin-captain-wypij"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1513816549, "post_id": 47914868, "comment_id": 82800643, "body": "Correct. but there is no excuse when the application exists..."}, {"owner": {"reputation": 51, "user_id": 4151676, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000781809701/picture?type=large", "display_name": "Justin Captain Wypij", "link": "https://stackoverflow.com/users/4151676/justin-captain-wypij"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1513816788, "post_id": 47914868, "comment_id": 82800697, "body": "Solved. The issue was in Google Earth Pro. I installed and older version and it works fine. Thanx for the help though"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1513816803, "post_id": 47914868, "comment_id": 82800700, "body": "There is! If the Window Caption doesn&#39;t match! I had been automating backup data procedure within an app via SendKeys/etc. Painful popups as you need to get their Window Caption text."}], "owner": {"reputation": 51, "user_id": 4151676, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000781809701/picture?type=large", "display_name": "Justin Captain Wypij", "link": "https://stackoverflow.com/users/4151676/justin-captain-wypij"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513814731, "creation_date": 1513806725, "last_edit_date": 1531164843, "question_id": 47914868, "link": "https://stackoverflow.com/questions/47914868/appactivate-not-working-with-googleearth", "title": "AppActivate not working with GoogleEarth", "body": "<p>Honestly all I'm doing is calling google earth with \nAppActivate \"google earth\"</p>\n\n<p>It works for the first 1-10 uses then it says \n\"run-time error '5':\nInvalid procedure call or argument. </p>\n\n<p>Why would it work then not work later???</p>\n\n<p>Code from comment:</p>\n\n<pre><code>Sub Amouse()\n    AppActivate \"google earth\"\n    Application.Run \"Module1.AAA\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 3, "creation_date": 1513806714, "post_id": 47914854, "comment_id": 82797731, "body": "why not just save it as a .xlsx?  that removes all of the vba code from the workbook."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1513808239, "post_id": 47914854, "comment_id": 82798364, "body": "The error occurs when your code tries to remove the built in <code>Sheet</code> or <code>Workbook</code> modules.  The original code you linked includes <code>On Error Resume Next</code> specifically to avoid this error."}, {"owner": {"reputation": 85, "user_id": 6096270, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-3lKDwQXw1NE/AAAAAAAAAAI/AAAAAAAAGQc/A0DVubnBt3I/photo.jpg?sz=128", "display_name": "Seth Reuter", "link": "https://stackoverflow.com/users/6096270/seth-reuter"}, "reply_to_user": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1513896982, "post_id": 47914854, "comment_id": 82836879, "body": "@sous2817 I think your idea is the best."}], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1513808833, "post_id": 47915170, "comment_id": 82798563, "body": "Better to test for <code>&lt;&gt; vbext_ct_Document</code> as your code won&#39;t delete UserForms as it stands.  You also need to keep the second loop to remove code from the document modules."}, {"owner": {"reputation": 2140, "user_id": 539997, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ef9924ff002c119e35cf7dd70c554e22?s=128&d=identicon&r=PG", "display_name": "Michael Hoffmann", "link": "https://stackoverflow.com/users/539997/michael-hoffmann"}, "edited": false, "score": 0, "creation_date": 1549046880, "post_id": 47915170, "comment_id": 95777817, "body": "The <code>vbext_ct_*</code> variables here don&#39;t have a value in my IDE (when I <code>Debug.Print</code> them I just get a blank line). Do you know how I can fix this?"}], "tags": [], "owner": {"reputation": 56, "user_id": 7385538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U7FzU.jpg?s=128&g=1", "display_name": "Andrzej O", "link": "https://stackoverflow.com/users/7385538/andrzej-o"}, "is_accepted": false, "score": 3, "last_activity_date": 1513809796, "last_edit_date": 1513809796, "creation_date": 1513808278, "answer_id": 47915170, "question_id": 47914854, "link": "https://stackoverflow.com/questions/47914854/programmatically-deleting-all-the-code-in-my-workbook-with-a-macro/47915170#47915170", "title": "Programmatically deleting all the code in my workbook with a macro", "body": "<p>The reason for an error is not due to code being old :) :P The reason is that you're deleting all modules ...including the one with the \"DeleteAllModules\" :P ups. \nbtw just in case you need set referencest to\n<strong>Microsoft Visual Basic for Applications Extensibility 5.3</strong>\nand set security to \"un safe\"</p>\n\n<p>for details  goto \n<a href=\"https://www.google.pl/amp/s/christopherjmcclellan.wordpress.com/2014/10/10/vba-and-git/amp/\" rel=\"nofollow noreferrer\">https://www.google.pl/amp/s/christopherjmcclellan.wordpress.com/2014/10/10/vba-and-git/amp/</a></p>\n\n<p>but just for quick fix</p>\n\n<pre><code>Option Explicit\n'@Folder(\"DevTools\") \n\nConst devTools As String = \"devTools\" \n'This is the name of module with \"RemoveAllModules\" and it will be ignored\n\nPrivate Sub RemoveAllModules()\nDim comp As VBComponent\n\n For Each comp In Application.VBE.ActiveVBProject.VBComponents\n  If comp.Type = vbext_ct_ClassModule Or comp.Type = vbext_ct_StdModule Then\n        If Not comp.name = devTools Then\n            Application.VBE.ActiveVBProject.VBComponents.Remove comp\n        End If\n    End If\n Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 85, "user_id": 6096270, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-3lKDwQXw1NE/AAAAAAAAAAI/AAAAAAAAGQc/A0DVubnBt3I/photo.jpg?sz=128", "display_name": "Seth Reuter", "link": "https://stackoverflow.com/users/6096270/seth-reuter"}, "is_accepted": true, "score": 2, "last_activity_date": 1513955604, "creation_date": 1513955604, "answer_id": 47943675, "question_id": 47914854, "link": "https://stackoverflow.com/questions/47914854/programmatically-deleting-all-the-code-in-my-workbook-with-a-macro/47943675#47943675", "title": "Programmatically deleting all the code in my workbook with a macro", "body": "<p>Like sous2187 said, the best method is save the file as a nonmacro file, and let excel remove the macros itself. So I did exactly that.</p>\n\n<pre><code>Sub delhiddensheets()\n\n    For Each sh In Worksheets\n        If sh.Visible = xlSheetHidden Then\n            sh.Delete\n        End If\n    Next sh\n\nEnd Sub\n\nSub Valuepaste()\n\n    Dim tabs As Object\n    For Each tabs In Sheets\n        With tabs\n            If .Visible = True Then .Select Replace:=False\n        End With\n    Next tabs\n    Cells.Select\n    Range(\"A1\").Activate\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n    Application.CutCopyMode = False\n    Range(\"A20\").Select\n\nEnd Sub\n\nSub DeleteAllCode()\n\n    Application.Calculation = xlCalculationManual\n    Application.ScreenUpdating = False\n    Application.DisplayStatusBar = False\n    Application.EnableEvents = False\n    Application.DisplayAlerts = False\n\n    newname = Left(ActiveWorkbook.Name, (InStrRev(ActiveWorkbook.Name, \".\", -1, vbTextCompare) - 1)) &amp; \"_VALS.xlsx\"\n    ChDir ActiveWorkbook.Path\n    ActiveWorkbook.SaveAs Filename:=newname, FileFormat:=xlOpenXMLWorkbook\n    Valuepaste\n    delhiddensheets\n\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n    Application.DisplayStatusBar = True\n    Application.EnableEvents = True\n    Application.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 6096270, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-3lKDwQXw1NE/AAAAAAAAAAI/AAAAAAAAGQc/A0DVubnBt3I/photo.jpg?sz=128", "display_name": "Seth Reuter", "link": "https://stackoverflow.com/users/6096270/seth-reuter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 747, "favorite_count": 0, "accepted_answer_id": 47943675, "answer_count": 2, "score": 1, "last_activity_date": 1577199415, "creation_date": 1513806638, "last_edit_date": 1577199415, "question_id": 47914854, "link": "https://stackoverflow.com/questions/47914854/programmatically-deleting-all-the-code-in-my-workbook-with-a-macro", "title": "Programmatically deleting all the code in my workbook with a macro", "body": "<p>I need to delete all the code in my workbook with a macro. I'm using this code, which seems <a href=\"http://www.vbaexpress.com/kb/getarticle.php?kb_id=93\" rel=\"nofollow noreferrer\">pretty old</a>.</p>\n\n<pre><code>Dim x As Integer\nWith ActiveWorkbook.VBProject\n    For x = .VBComponents.Count To 1 Step -1\n        .VBComponents.Remove .VBComponents(x)\n    Next x\n    For x = .VBComponents.Count To 1 Step -1\n        .VBComponents(x).CodeModule.DeleteLines _\n        1, .VBComponents(x).CodeModule.CountOfLines\n    Next x\nEnd With\n</code></pre>\n\n<p>I'm getting an error at <code>.VBComponents.Remove .VBComponents(x)</code>, where visual basic says, \"Run-time error '5': Invalid procedure call or argument.\" According to <a href=\"https://msdn.microsoft.com/en-us/library/aa445484(v=vs.60).aspx\" rel=\"nofollow noreferrer\">this page</a>, this error means that either I'm using my procedure wrong, or this procedure doesn't exist anymore.</p>\n\n<p>How can I fix this macro and make it work with Office 2016?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2527, "user_id": 3082472, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cfa0eac13a3a42b13990e08e74446fd3?s=128&d=identicon&r=PG&f=1", "display_name": "akraf", "link": "https://stackoverflow.com/users/3082472/akraf"}, "edited": false, "score": 0, "creation_date": 1513806509, "post_id": 47914705, "comment_id": 82797648, "body": "Welcome to Stack Overflow! Your question lacks many important details and is hard for others to reproduce. This means you are unlikely to get an answer as the question is posed now. I suggest you read our guide on <a href=\"https://stackoverflow.com/help/how-to-ask\">how to ask</a> and about a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and then <a href=\"https://stackoverflow.com/posts/47914705/edit\">edit</a> your question to provide information: (i) a <i>small</i> example for others to play around with, (ii) what you mean by &quot;update&quot;, (iii) what other things exactly you tried and why it didn&#39;t work. (iv) are you sure this is related to VBA and not simple Excel formulas? If so, correct your question tag."}, {"owner": {"reputation": 64493, "user_id": 272109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32170c62eb744820e8afdd023379a95a?s=128&d=identicon&r=PG", "display_name": "David Makogon", "link": "https://stackoverflow.com/users/272109/david-makogon"}, "edited": false, "score": 0, "creation_date": 1513806634, "post_id": 47914705, "comment_id": 82797704, "body": "I removed the fact you tried other suggestions (which is irrelevant, especially since we don&#39;t know what suggestions you tried), and your signature+thanks, and you can now see that there&#39;s really not much posted regarding the question itself."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9124552, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3ftaYgNj824/AAAAAAAAAAI/AAAAAAAAACM/YCSBMMDOjWI/photo.jpg?sz=128", "display_name": "Angela", "link": "https://stackoverflow.com/users/9124552/angela"}, "edited": false, "score": 0, "creation_date": 1513806636, "post_id": 47914763, "comment_id": 82797706, "body": "OMG!!!! Thank you so much! That worked straight out of the box. Thank you so much JNevill. Merry Christmas and I hope that you have a Wonderful New Year!  -  Angela"}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 0, "last_activity_date": 1513806130, "creation_date": 1513806130, "answer_id": 47914763, "question_id": 47914705, "link": "https://stackoverflow.com/questions/47914705/i-need-for-a-cell-in-column-f-to-clear-when-the-training-date-has-been-updated/47914763#47914763", "title": "I need for a cell in column &quot;F&quot; to clear when the training date has been updated in that same row in column &quot;J&quot;", "body": "<p>In the worksheet's VBA (Click on that sheet in your VBAProject pane in VBE). Use the <code>Worksheet_Change()</code> event. That's an event, a chunk of code, that will execute whenever the worksheet changes. <code>Target</code> is a special variable here that will contain the range/cell that was changed when the code executes:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    'Did something change in column J?\n    If Not Intersect(Target, Range(\"J:J\")) Is Nothing Then\n        'Set the cell in Column F for the same row to nothing\n        Range(\"F\" &amp; Target.Row).ClearContents\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9124552, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3ftaYgNj824/AAAAAAAAAAI/AAAAAAAAACM/YCSBMMDOjWI/photo.jpg?sz=128", "display_name": "Angela", "link": "https://stackoverflow.com/users/9124552/angela"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 11, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1513806584, "creation_date": 1513805834, "last_edit_date": 1531164843, "question_id": 47914705, "link": "https://stackoverflow.com/questions/47914705/i-need-for-a-cell-in-column-f-to-clear-when-the-training-date-has-been-updated", "title": "I need for a cell in column &quot;F&quot; to clear when the training date has been updated in that same row in column &quot;J&quot;", "body": "<p>I need for a cell in column \"F\" to clear content when the training date has been updated in that same row in column \"J\".</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513805470, "post_id": 47914542, "comment_id": 82797254, "body": "use OFFSET to shift direction from a specified cell."}, {"owner": {"reputation": 61, "user_id": 8953988, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/debb991691bbf1a0e2abedb715c940ce?s=128&d=identicon&r=PG&f=1", "display_name": "Casey M", "link": "https://stackoverflow.com/users/8953988/casey-m"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513805863, "post_id": 47914542, "comment_id": 82797414, "body": "I started to work with a +1, didn&#39;t have much luck, but  maybe like you said offset cells on F column .. thinking after concatenation... sorry still very new to vba. that would be simpler than running through a loop. Thank you!"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1513805977, "post_id": 47914542, "comment_id": 82797454, "body": "<a href=\"https://stackoverflow.com/a/30841761/4539709\">stackoverflow.com/a/30841761/4539709</a>"}, {"owner": {"reputation": 61, "user_id": 8953988, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/debb991691bbf1a0e2abedb715c940ce?s=128&d=identicon&r=PG&f=1", "display_name": "Casey M", "link": "https://stackoverflow.com/users/8953988/casey-m"}, "edited": false, "score": 0, "creation_date": 1513806501, "post_id": 47914542, "comment_id": 82797645, "body": "good reference - on offset loop. Thank you!"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1513820714, "post_id": 47914542, "comment_id": 82801599, "body": "Is it always b1 + the next cell value on column F ?"}, {"owner": {"reputation": 61, "user_id": 8953988, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/debb991691bbf1a0e2abedb715c940ce?s=128&d=identicon&r=PG&f=1", "display_name": "Casey M", "link": "https://stackoverflow.com/users/8953988/casey-m"}, "edited": false, "score": 0, "creation_date": 1513887725, "post_id": 47914542, "comment_id": 82833441, "body": "yes it is it increments the F column"}], "owner": {"reputation": 61, "user_id": 8953988, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/debb991691bbf1a0e2abedb715c940ce?s=128&d=identicon&r=PG&f=1", "display_name": "Casey M", "link": "https://stackoverflow.com/users/8953988/casey-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1513809498, "creation_date": 1513804993, "last_edit_date": 1513809498, "question_id": 47914542, "link": "https://stackoverflow.com/questions/47914542/how-to-increment-1-cell-down-then-concatenate-vba", "title": "How to increment +1 cell down then concatenate vba", "body": "<p>I'm looking to increment a cell and concatenate it through vba</p>\n\n<p><em>Example</em></p>\n\n<p>In Cell A1 I have a Date example 1/3/2018 comes which will from a <code>userform</code> .</p>\n\n<p>I have it where it converts it to text format in B1 showing as 103173.\nI have another column with \"random\" (insert speech about not really random :))integers in column F</p>\n\n<p>so in column c it shows \"random\"&amp;103173 so in this case it shows 333103173</p>\n\n<p>what I want it to do is go to the next random integer down in column F concatenate the value with the B1 whatever the new date conversion is ...\nand add it to C2.</p>\n\n<p>I know I will likely need to go through some kind of loop going through column F,\nbut not sure how that would look. </p>\n\n<p>Any help would be great!</p>\n\n<p>sort of what I've started below</p>\n\n<pre><code>Sub mydate()\n\n    'Dim i As Long\n    'Dim j As Long\n\n    'i = 1\n    'j = Range(\"B2000\").Value\n    'x = Cells(i, 2)\n\nDim sdate As String\nsdate = Format(Range(\"A1\"), \"mmddyyy\")\n\nCells(1, 2) = sdate\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2016"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1513806846, "post_id": 47914489, "comment_id": 82797788, "body": "&quot;IMAGE&quot; must be full path/filename of an external image. Works for me."}, {"owner": {"reputation": 862, "user_id": 5338928, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84ced5d4f9d2639dc03ef3a2accd6161?s=128&d=identicon&r=PG&f=1", "display_name": "TheDoomDestroyer", "link": "https://stackoverflow.com/users/5338928/thedoomdestroyer"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1513807171, "post_id": 47914489, "comment_id": 82797916, "body": "I did use the full path (&quot;C:\\....&quot;), but it does show only the image when the toggle is off (the else statement)."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1513807233, "post_id": 47914489, "comment_id": 82797939, "body": "Can&#39;t reproduce issue so can&#39;t explain why. As I said, works for me. Except I did not use <code>.Value = True</code>, just <code>Me.Toggle4 Then</code>."}, {"owner": {"reputation": 862, "user_id": 5338928, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84ced5d4f9d2639dc03ef3a2accd6161?s=128&d=identicon&r=PG&f=1", "display_name": "TheDoomDestroyer", "link": "https://stackoverflow.com/users/5338928/thedoomdestroyer"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1513807772, "post_id": 47914489, "comment_id": 82798167, "body": "Interesting. It doesn&#39;t allow me to use that method. Reason: &quot;Invalid use of Null&quot;."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1513807913, "post_id": 47914489, "comment_id": 82798223, "body": "Also, I am using Access2010."}, {"owner": {"reputation": 862, "user_id": 5338928, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84ced5d4f9d2639dc03ef3a2accd6161?s=128&d=identicon&r=PG&f=1", "display_name": "TheDoomDestroyer", "link": "https://stackoverflow.com/users/5338928/thedoomdestroyer"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1513808335, "post_id": 47914489, "comment_id": 82798399, "body": "Ah, I see. That could be the reason. Or, it could be that I have put the whole code in the wrong section. Where did you place it, exactly?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1513808478, "post_id": 47914489, "comment_id": 82798446, "body": "Toggle4 Click event."}], "answers": [{"tags": [], "owner": {"reputation": 862, "user_id": 5338928, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84ced5d4f9d2639dc03ef3a2accd6161?s=128&d=identicon&r=PG&f=1", "display_name": "TheDoomDestroyer", "link": "https://stackoverflow.com/users/5338928/thedoomdestroyer"}, "is_accepted": true, "score": 0, "last_activity_date": 1513808787, "creation_date": 1513808787, "answer_id": 47915244, "question_id": 47914489, "link": "https://stackoverflow.com/questions/47914489/ms-access-togglebutton-picture-change/47915244#47915244", "title": "MS Access ToggleButton Picture change", "body": "<p>It appears that the code seemed to run properly, except that it was place in the incorrect code section. The whole if-else statement was placed in the <code>Form_Load()</code> sub rather than the <code>Toggle4_OnClick()</code>. Special thanks to June7 for the help.</p>\n"}], "owner": {"reputation": 862, "user_id": 5338928, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84ced5d4f9d2639dc03ef3a2accd6161?s=128&d=identicon&r=PG&f=1", "display_name": "TheDoomDestroyer", "link": "https://stackoverflow.com/users/5338928/thedoomdestroyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 580, "favorite_count": 0, "accepted_answer_id": 47915244, "answer_count": 1, "score": 0, "last_activity_date": 1513808787, "creation_date": 1513804676, "question_id": 47914489, "link": "https://stackoverflow.com/questions/47914489/ms-access-togglebutton-picture-change", "title": "MS Access ToggleButton Picture change", "body": "<p>I was wondering if it is possible to change the picture of a toggle button in Access VBA depending on the state of the toggle button (pressed and not pressed)?</p>\n\n<p>My previous attempt on doing it included a check if the button's value is \"true\", but it hasn't really produced a valid result.</p>\n\n<pre><code>If Me.Toggle4.Value = True Then\n    Me.Toggle4.Picture = \"IMAGE\"\nElse\n    Me.Toggle4.Picture = \"IMAGE\"\nEnd If\n</code></pre>\n\n<p>What the code above produces is the button always having the same image.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1513804341, "post_id": 47914335, "comment_id": 82796739, "body": "VBA variables cannot be dynamically constructed."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 2, "creation_date": 1513804693, "post_id": 47914335, "comment_id": 82796881, "body": "Not sure why you get the compile issue on the Call line. Type is a reserved word and should not use reserved words as names for anything."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1513805094, "post_id": 47914335, "comment_id": 82797068, "body": "For this type of thing you&#39;d typically use a Dictionary, but your example code isn&#39;t really enough to go on..."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1513805265, "post_id": 47914335, "comment_id": 82797153, "body": "The compile error is probably because you are calling a function and function must be on the right side of an expression: <code>x = functionName(&quot;invoice&quot;)</code>. Make the function a sub then the Call should compile. But still can&#39;t dynamically construct VBA variables."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1513805423, "post_id": 47914335, "comment_id": 82797224, "body": "@June7 #FunFacts: <code>Type</code> is a perfectly legal UDT member name. Otherwise yeah, using it is kind of asking for trouble. That said, VBA doesn&#39;t care if you use a function as a sub (and thus discard the returned value) - people do that all the time with the <code>MsgBox</code> function..."}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 1, "creation_date": 1513805539, "post_id": 47914335, "comment_id": 82797283, "body": "<code>Me(...)</code> brings to mind the form&#39;s controls collection which can be referenced by the control&#39;s name e.g. <code>Me.Controls(&quot;ContolName&quot;)</code>?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1513805568, "post_id": 47914335, "comment_id": 82797300, "body": "You&#39;ll have to <a href=\"https://stackoverflow.com/posts/47914335/edit\">edit</a> your question to clarify what you&#39;re trying to achieve and in what context, otherwise it&#39;s pretty much impossible to give you a definitive answer. If <code>invoiceBool</code> is a global variable, then <code>invoiceBool</code> all by itself wouldn&#39;t be a legal instruction <i>anyway</i> - what&#39;s <code>Me(type &amp; &quot;Bool&quot;)</code> trying to achieve?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513805721, "post_id": 47914335, "comment_id": 82797358, "body": "@Mat&#39;sMug, sure, can use a function but still must be in an expression, not with the Call method. So change one or the other procedure."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513805760, "post_id": 47914335, "comment_id": 82797367, "body": "<code>Call MsgBox(&quot;What about this?&quot;)</code> is perfectly legal. <code>Sub</code> or <code>Function</code> makes no difference, <code>Call</code> doesn&#39;t care at all. The main problem is that <code>Me(type &amp; &quot;Bool&quot;)</code> is not an instruction - <i>even if it were a valid way to refer to a variable</i>. When you access a variable, it&#39;s either to read it, or to assign it. Treating it as an instruction isn&#39;t going to compile."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1513805997, "post_id": 47914335, "comment_id": 82797465, "body": "Well, that is confusing! I am sure I received error messages in past when trying Call with a function. I am now re-educated."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 2, "creation_date": 1513806228, "post_id": 47914335, "comment_id": 82797554, "body": "@June7 rule of thumb, <code>Call</code> is obsolete and useless ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 6684284, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-GZQx352Gvhs/AAAAAAAAAAI/AAAAAAABOso/d_sFkyeaHkY/photo.jpg?sz=128", "display_name": "Arne Clicteur", "link": "https://stackoverflow.com/users/6684284/arne-clicteur"}, "edited": false, "score": 0, "creation_date": 1513850605, "post_id": 47920800, "comment_id": 82812402, "body": "Thanks, I&#39;ll try it out. Seems a bit tedious to first add all references to objects to this collection, is it common practice to leave the objects like in my example, and store the variables in a collection?"}, {"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "reply_to_user": {"reputation": 49, "user_id": 6684284, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-GZQx352Gvhs/AAAAAAAAAAI/AAAAAAABOso/d_sFkyeaHkY/photo.jpg?sz=128", "display_name": "Arne Clicteur", "link": "https://stackoverflow.com/users/6684284/arne-clicteur"}, "edited": false, "score": 0, "creation_date": 1513852757, "post_id": 47920800, "comment_id": 82813817, "body": "It depends on complexity, but in any case try to avoid using global variables, use classes or functions with static variables"}], "tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": true, "score": 1, "last_activity_date": 1513845987, "last_edit_date": 1513845987, "creation_date": 1513844645, "answer_id": 47920800, "question_id": 47914335, "link": "https://stackoverflow.com/questions/47914335/how-to-reference-a-global-variable-in-vba/47920800#47920800", "title": "How to reference a global variable in VBA", "body": "<p>In some cases you can try to use <code>Eval</code> function for evaluating functions, but it doesn't work with variables. </p>\n\n<p>You can use collection for storing values or references to objects, so in this case your code will look like</p>\n\n<pre><code>Public col As Collection\n\nPublic Function functionName(typeString As String)\n  'for scalar data types element should be replaced, cannot change value\n  col.Remove typeString &amp; \"Bool\"\n  col.Add False, typeString &amp; \"Bool\"\n\n  'object references can be used directly\n  col(typeString &amp; \"Btn\").Visible = False\nEnd Function\n</code></pre>\n\n<p>Before using this you should add all desired values or object references</p>\n\n<pre><code>Set col = New Collection\n\ncol.Add True, \"infoBool\"\ncol.Add Me.InfoBtn, Me.InfoBtn.Name\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 6684284, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-GZQx352Gvhs/AAAAAAAAAAI/AAAAAAABOso/d_sFkyeaHkY/photo.jpg?sz=128", "display_name": "Arne Clicteur", "link": "https://stackoverflow.com/users/6684284/arne-clicteur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 47920800, "answer_count": 1, "score": -1, "last_activity_date": 1513845987, "creation_date": 1513803949, "last_edit_date": 1513842233, "question_id": 47914335, "link": "https://stackoverflow.com/questions/47914335/how-to-reference-a-global-variable-in-vba", "title": "How to reference a global variable in VBA", "body": "<p>In Access VBA I know you can reference an object by using a string: <code>Me(\"string\")</code>. I want to reference a global variable in a function using a string, thus allowing me to use the function for different states.</p>\n\n<p>e.g. I have <code>invoiceBtn</code> and <code>infoBtn</code> buttons, I want to call the same function but using different variables. There are global variables <code>infoBool</code> and <code>invoiceBool</code></p>\n\n<pre><code>Private Sub infoBtn_Click()\n  functionName(\"info\")\nEnd Sub\n\nPrivate Sub invoiceBtn_Click()\n  functionName(\"invoice\")\nEnd Sub \n</code></pre>\n\n<p>in the function:</p>\n\n<pre><code>public infoBool As Boolean\npublic invoiceBool As Boolean\n\npublic Function functionName(typeString As String)\n  Me(typeString &amp; \"Bool\") = false\n  Me(typeString &amp; \"Btn\").visible = false\nEnd Function\n</code></pre>\n\n<p>The first Me() doesn't compile, the second Me() does, is there a way to obtain a reference to a variable using a string?</p>\n\n<p>edited: I hope it is clear enough now. This is just example code, not used in my program.</p>\n"}, {"tags": ["excel", "vba", "shell"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513804633, "post_id": 47914321, "comment_id": 82796854, "body": "Can you specify the full path to the executable in the command line so avoid the changing of directory? Possibly, getting working from the command line before translating to vba? Then always option of executing by BATCH file."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513805467, "post_id": 47914321, "comment_id": 82797252, "body": "Is your workbook on the C: drive?  Or another drive?  (E.g. if your workbook was located in <code>&quot;L:\\Temp1\\Temp2&quot;</code> then you also need to <code>ChDrive &quot;L&quot;</code> for the <code>ChDir</code> to be useful because the o/s keeps track of the &quot;current&quot; directory on each drive and the default is to use the &quot;current&quot; directory on the &quot;current&quot; drive.)"}, {"owner": {"reputation": 607, "user_id": 9073241, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ad17ee95cc6886df8e31abeb84bd50f2?s=128&d=identicon&r=PG&f=1", "display_name": "Heap of Pinto Beans", "link": "https://stackoverflow.com/users/9073241/heap-of-pinto-beans"}, "edited": false, "score": 0, "creation_date": 1513805617, "post_id": 47914321, "comment_id": 82797314, "body": "cool.  i will try and let you know.  workbook is on network drive."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1513808210, "creation_date": 1513808210, "answer_id": 47915153, "question_id": 47914321, "link": "https://stackoverflow.com/questions/47914321/vba-to-run-shell-command-but-to-run-from-different-directory/47915153#47915153", "title": "VBA to run shell command but to run from different directory", "body": "<p>The <code>ChDir</code> command only changes the \"current\" directory on the drive specified, but does not affect which drive is currently \"current\".</p>\n\n<p>So, if  </p>\n\n<ul>\n<li>your computer has a \"C\" drive on which the \"current\" directory is \"C:\\Users\\ksmith\\Documents\", and </li>\n<li>you also have an \"L\" drive on which the \"current\" directory is \"L:\\abc\\def\",\nand</li>\n<li>the directory containing your workbook is \"L:\\Temp1\\Temp2\"</li>\n</ul>\n\n<p>then executing</p>\n\n<pre><code>ChDir ActiveWorkbook.Path\n</code></pre>\n\n<p>will change the \"current\" directory of the \"L\" drive to be \"L:\\Temp1\\Temp2\", but the \"current\" drive will continue to be \"C\" and the C drive's \"current\" directory will continue to be \"C:\\Users\\ksmith\\Documents\".</p>\n\n<hr>\n\n<p>You therefore need to also change the \"current\" drive.  Providing you have a mapped drive (i.e. it won't work with a UNC specified drive) you can do this by using:</p>\n\n<pre><code>ChDrive ActiveWorkbook.Path\nChDir ActiveWorkbook.Path\n</code></pre>\n"}], "owner": {"reputation": 607, "user_id": 9073241, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ad17ee95cc6886df8e31abeb84bd50f2?s=128&d=identicon&r=PG&f=1", "display_name": "Heap of Pinto Beans", "link": "https://stackoverflow.com/users/9073241/heap-of-pinto-beans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1477, "favorite_count": 0, "accepted_answer_id": 47915153, "answer_count": 1, "score": 0, "last_activity_date": 1513808210, "creation_date": 1513803882, "last_edit_date": 1513804648, "question_id": 47914321, "link": "https://stackoverflow.com/questions/47914321/vba-to-run-shell-command-but-to-run-from-different-directory", "title": "VBA to run shell command but to run from different directory", "body": "<p>I have code as follows:</p>\n\n<pre><code>ChDir (ActiveWorkbook.Path)\nShellString = \"cmd.exe /k cpdf -split \" + Chr(34) + \".\\\" + Replace(File, \".csv\", \".pdf\") + Chr(34) + \" -o temp/x_%%%.pdf\"\nShell ShellString, vbNormalFocus\n</code></pre>\n\n<p>When I run the code, it does nothing, because it can't find cpdf.exe.  </p>\n\n<p>Cpdf.exe exists in the same path as my Active Workbook.\nThe ChDir command did not do the trick.</p>\n\n<p>When I run the code, I get </p>\n\n<blockquote>\n  <p>'cpdf' is not recognized as an internal command....</p>\n</blockquote>\n\n<p>And I am left at the following prompt:</p>\n\n<p>C:\\Users\\ksmith\\Documents</p>\n\n<p>This tells me that the command was trying to run from that folder, and that is why it failed.</p>\n\n<p>How do I run Shell from Desired folder in VBA?\nChDir doesn't seem to do the trick, as some people had suggested...</p>\n"}, {"tags": ["vba", "editor", "breakpoints", "margin-left"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1513802983, "post_id": 47914143, "comment_id": 82796150, "body": "This question should be on SuperUser, as it does not specifically deal with the code, but the editor."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513803043, "post_id": 47914143, "comment_id": 82796176, "body": "^^ I agree (although I would love to know the answer, because I didn&#39;t even know that it was possible to resize that grey margin!)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1513803114, "post_id": 47914143, "comment_id": 82796200, "body": "Ahh - found it - Tools / Options / Editor Format / Margin Indicator Bar"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1513803189, "post_id": 47914143, "comment_id": 82796233, "body": "@YowE3K might as well answer it."}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513803520, "post_id": 47914220, "comment_id": 82796381, "body": "Not sure whether that &quot;red free-hand circle&quot; is red enough - I&#39;ll probably get down-voted for it :D"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513803855, "post_id": 47914220, "comment_id": 82796534, "body": "The part I don&#39;t get is, who the heck thought it would be a good idea to make that <i>margin indicator bar</i> optional?!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1513804340, "post_id": 47914220, "comment_id": 82796738, "body": "@Mat&#39;sMug you know there was that one guy, who sat in the planning and said, &quot;I don&#39;t like it, I want the extra pixels in my code space.&quot;  we have all encountered &quot;That Guy&quot;."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1513804570, "post_id": 47914220, "comment_id": 82796826, "body": "@ScottCraner To be honest, I never use that margin indicator bar, and I always curse when I click on it by accident and thus create a breakpoint, so perhaps I am &quot;That Guy&quot;!"}, {"owner": {"reputation": 41, "user_id": 6879637, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8785ede0ed81c0249ff5e98746eb7aaa?s=128&d=identicon&r=PG&f=1", "display_name": "user6879637", "link": "https://stackoverflow.com/users/6879637/user6879637"}, "edited": false, "score": 0, "creation_date": 1513894322, "post_id": 47914220, "comment_id": 82835980, "body": "Thank you so much for answering the question. This would have been super hard if it weren&#39;t for you guys."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 5, "last_activity_date": 1513803269, "creation_date": 1513803269, "answer_id": 47914220, "question_id": 47914143, "link": "https://stackoverflow.com/questions/47914143/cant-find-the-grey-margin-in-vba-editor-where-you-apply-breakpoints/47914220#47914220", "title": "can&#39;t find the grey margin in VBA editor where you apply breakpoints", "body": "<p>Visibility of the margin can be selected / unselected by going to Tools / Options / Editor Format / Margin Indicator Bar.</p>\n\n<p><a href=\"https://i.stack.imgur.com/MShHL.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/MShHL.jpg\" alt=\"Screenshot\"></a></p>\n"}], "owner": {"reputation": 41, "user_id": 6879637, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8785ede0ed81c0249ff5e98746eb7aaa?s=128&d=identicon&r=PG&f=1", "display_name": "user6879637", "link": "https://stackoverflow.com/users/6879637/user6879637"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1513803269, "creation_date": 1513802876, "question_id": 47914143, "link": "https://stackoverflow.com/questions/47914143/cant-find-the-grey-margin-in-vba-editor-where-you-apply-breakpoints", "title": "can&#39;t find the grey margin in VBA editor where you apply breakpoints", "body": "<p>I somehow squeezed the margin where you apply breakpoints in the VBA editor. I can still apply breakpoints using shortcut keys but i can not scroll the control to a previous line without dragging it because i can't see the grey margin on left of code.</p>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1513801623, "post_id": 47913839, "comment_id": 82795460, "body": "So why not just remove &quot; (CE)&quot; from strings that contain it then always place &quot;, CE &quot; in front of occurrences of &quot;(SN:&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 9124238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/92ac4c75ad012414ad220a3fb77d8ad6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom F", "link": "https://stackoverflow.com/users/9124238/tom-f"}, "edited": false, "score": 0, "creation_date": 1513802764, "post_id": 47913929, "comment_id": 82796055, "body": "It is much simpler, however, I have thousands of entries (rows) and of course not each entry contains the target string pattern.  Thus, as I understand it, I would have to evaluate each entry first to see if it contains the string pattern and then implement the SUBSTITUTE function on only those instances.  If I use a regex based in-cell function than I wouldn&#39;t have to do the row by row evaluation.  If the target string pattern was not found, the function would return the original value.  Or maybe there is an IF function I can combine with the SUBSTITUTE function to take care of it."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 63, "user_id": 9124238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/92ac4c75ad012414ad220a3fb77d8ad6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom F", "link": "https://stackoverflow.com/users/9124238/tom-f"}, "edited": false, "score": 0, "creation_date": 1513802868, "post_id": 47913929, "comment_id": 82796091, "body": "Not necessarily. If I understand you correctly, the nature of Substitute will solve that issue as it will simply leave what is there if the pattern match does not exist so you can drag formula down rows and it should work if it finds the pattern or not."}, {"owner": {"reputation": 63, "user_id": 9124238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/92ac4c75ad012414ad220a3fb77d8ad6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom F", "link": "https://stackoverflow.com/users/9124238/tom-f"}, "edited": false, "score": 0, "creation_date": 1513803153, "post_id": 47913929, "comment_id": 82796218, "body": "I tried the SUBSTITUTE function on cells that did not contain the target pattern, but it returned the original value with the added target pattern when it wasn&#39;t desired."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 63, "user_id": 9124238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/92ac4c75ad012414ad220a3fb77d8ad6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom F", "link": "https://stackoverflow.com/users/9124238/tom-f"}, "edited": false, "score": 1, "creation_date": 1513803377, "post_id": 47913929, "comment_id": 82796312, "body": "I think I may know what is happening, but you do not give any examples of what the other pattern(s) look like. You can use an <code>IF</code> formula if need be. If you have a question about how to handle the other cases with this formula post another question."}, {"owner": {"reputation": 63, "user_id": 9124238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/92ac4c75ad012414ad220a3fb77d8ad6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom F", "link": "https://stackoverflow.com/users/9124238/tom-f"}, "edited": false, "score": 0, "creation_date": 1513804458, "post_id": 47913929, "comment_id": 82796781, "body": "My apologies if my original question did not provide adequate info.  I will rephrase and repost."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 63, "user_id": 9124238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/92ac4c75ad012414ad220a3fb77d8ad6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom F", "link": "https://stackoverflow.com/users/9124238/tom-f"}, "edited": false, "score": 0, "creation_date": 1513804545, "post_id": 47913929, "comment_id": 82796815, "body": "YOu can edit this question too. Either way, if you provide examples where will the pattern will not appear I can help."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 2, "last_activity_date": 1513801783, "creation_date": 1513801783, "answer_id": 47913929, "question_id": 47913839, "link": "https://stackoverflow.com/questions/47913839/how-to-use-excel-vba-regex-in-cell-function-to-move-parts-of-a-string/47913929#47913929", "title": "How to use Excel VBA regex in-cell function to move parts of a string", "body": "<p>No need for <code>RegEx</code> here or VBA, when <code>SUBSTITUTE</code> function will do the trick:</p>\n\n<pre><code>=SUBSTITUTE(SUBSTITUTE(A1,\" (CE) \",\"\"),\" (\",\", CE (\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/P5Uyj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/P5Uyj.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 63, "user_id": 9124238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/92ac4c75ad012414ad220a3fb77d8ad6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom F", "link": "https://stackoverflow.com/users/9124238/tom-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1513870438, "creation_date": 1513801341, "last_edit_date": 1531164843, "question_id": 47913839, "link": "https://stackoverflow.com/questions/47913839/how-to-use-excel-vba-regex-in-cell-function-to-move-parts-of-a-string", "title": "How to use Excel VBA regex in-cell function to move parts of a string", "body": "<p>Edits to my original post.</p>\n\n<p>New to using VBA in Excel as well as regex.  I think regex offers the best solution for me due to the wide variability in the strings.<br>\nI would really appreciate any help - not looking for handouts - just want to learn.</p>\n\n<p>I have thousands of text entries that look like the following in my workbook (one column):</p>\n\n<pre><code>911407 - Ariens 34\" Wide-Area Walk-Behind Mower, 10.5hp Briggs &amp; Stratton, Gear, CARB (SN: 000101 &amp; Above)\n911379 (LMSPE CE) - Ariens Razor 21\" Self-Propelled Lawn Mower, 175cc Subaru (SN: 020347 - 025999)\n08200835 (CE) - Ariens CE AX 136cc Recoil Engine\n922013 (ST4) - Ariens Snow Blower, CE 4hp Tecumseh (SN: 000101 &amp; Above)\n</code></pre>\n\n<p>I want to use an Excel VBA in-cell function (macro would also be nice, but I have to start somewhere) to:</p>\n\n<ul>\n<li>Find each occurrence of the sub-string \" (CE) \" or \"CE\" or \"CE\" contained in a multi-character parenthetic expression</li>\n<li>Remove it from its current position</li>\n<li>Edit it (to strip off the leading space, strip off the opening/closing parantheses, add a comma)</li>\n<li>Move the fresh edit to a new position in the string, at a location that is right before the \"(SN:...)\"</li>\n</ul>\n\n<p>The desired results, using the above cited entries are:</p>\n\n<pre><code>911407 - Ariens 34\" Wide-Area Walk-Behind Mower, 10.5hp Briggs &amp; Stratton, Gear, CARB (SN: 000101 &amp; Above)\n911373 (LMP) - Ariens Razor 21\" Push Lawn Mower, 175cc Subaru, CE (SN: 035000 - 054999)\n08200835  - Ariens CE AX 136cc Recoil Engine, CE\n922013 (ST4) - Ariens Snow Blower, 4hp Tecumseh, CE (SN: 000101 &amp; Above)\n</code></pre>\n\n<p>This is what I have created so far that finds the \" (CE) \" and removes it.  I only got this far by reading past posts and experimenting.</p>\n\n<pre><code>Function TomCEregex(Myrange As Range) As String\nDim regEx As New RegExp\nDim strPattern As String\nDim strInput As String\nDim strReplace As String\n\nstrPattern = \" \\(CE\\)\"\n\nIf strPattern &lt;&gt; \"\" Then\n    strInput = Myrange.Value\n    strReplace = \"\"\n\n    With regEx\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = False\n        .Pattern = strPattern\n    End With\n\n    If regEx.Test(strInput) Then\n        TomCEregex = regEx.Replace(strInput, strReplace)\n    Else\n        TomCEregex = \"Not Matched\"\n    End If\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>Obviously, I am not even close, but I hope you see that I am trying.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "excel", "internet-explorer"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1513868499, "post_id": 47913752, "comment_id": 82823486, "body": "Try updating the title with an index so you can keep track. Something like: <code>IE.Document.Title = IE.Document.Title &amp; &quot;1&quot;</code> Why does this need to happen in separate tabs? Can&#39;t you just keep making new ones and kill the old one?"}, {"owner": {"reputation": 2344, "user_id": 8461786, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/55878061e134ad81c5d169881b3c6d2e?s=128&d=identicon&r=PG&f=1", "display_name": "barciewicz", "link": "https://stackoverflow.com/users/8461786/barciewicz"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1513918828, "post_id": 47913752, "comment_id": 82841423, "body": "Thanks Ryan, but IE is always the first tab until I tell it otherwise."}], "owner": {"reputation": 2344, "user_id": 8461786, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/55878061e134ad81c5d169881b3c6d2e?s=128&d=identicon&r=PG&f=1", "display_name": "barciewicz", "link": "https://stackoverflow.com/users/8461786/barciewicz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1061, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1513843636, "creation_date": 1513800969, "last_edit_date": 1513843636, "question_id": 47913752, "link": "https://stackoverflow.com/questions/47913752/vba-ie-automation-loop-for-opening-multiple-tabs-with-identical-names-and-urls", "title": "VBA IE automation: loop for opening multiple tabs with identical names and URLs and performing same action in them", "body": "<p>Suppose I have a list of identical URLs in spreadsheet column.</p>\n\n<p>I navigate to the URL manually, then I want my macro to open every URL in separate IE tab and also click a specific button in it.</p>\n\n<p>I use custom function <code>FindIEObject</code> to grab browser window by name or URL.The problem is that obviously each tab will have the same name and URL, so I need to find another way to differentiate between them and set each one as current IE object. My first thought was to assign a dummy name or a number to each tab as it gets created. I suppose this part should go somewhere after <code>IE.Navigate Cell.Value</code> in the loop.</p>\n\n<p>Here is my code, currently opening all the tabs, but clicking the element only in the first one:</p>\n\n<pre><code>Private page_title As String\nPublic IE As InternetExplorerMedium\n\nSub intercept()\n\nFindIEObject (\"Allegro\")\n\nFor Each Cell In Columns(\"A\").Cells.SpecialCells(xlConstants)\n    IE.Navigate Cell.Value, CLng(2049) ' open URL in new tab\n    'Call MyWait\n        For Each element In IE.Document.GetElementsByTagName(\"img\")\n            If element.GetAttribute(\"src\") = \"https://assets.allegrostatic.com/opbox/allegro.pl/homepage/Main%20page%20-%20new_SG_categories%20-%20icons/c4c8134ad8ae75c9d1070e7bee8cbeea.svg\" Then\n               element.Click\n               Exit For\n            End If\n        Next element\nNext Cell\n\nEnd Sub\n\nSub MyWait()\n\nDo While IE.Busy Or IE.ReadyState &lt;&gt; READYSTATE_COMPLETE\nDoEvents\nLoop\nEnd Sub\n\nPublic Function FindIEObject(target As String) As InternetExplorerMedium\n        marker = 0\n        Set objShell = CreateObject(\"Shell.Application\")\n        IE_count = objShell.Windows.Count\n        For x = 0 To (IE_count - 1)\n            On Error Resume Next    ' sometimes more web pages are counted than are open\n            page_url = objShell.Windows(x).Document.Location\n            page_title = objShell.Windows(x).Document.Title\n            If page_title Like target &amp; \"*\" Then 'compare to find if the desired web page is already open\n                Set IE = objShell.Windows(x)\n                marker = 1\n                Exit For\n            End If\n        Next\n\n    If marker = 0 Then\n        MsgBox (\"A matching webpage was NOT found\")\n    Else\n        MsgBox (\"A matching webpage was found\")\n    End If\n\n    End Function\n</code></pre>\n\n<p>I would be grateful for any suggestions.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "edited": false, "score": 0, "creation_date": 1513800627, "post_id": 47913672, "comment_id": 82795010, "body": "What code have you tried so far?"}, {"owner": {"reputation": 708, "user_id": 438009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdd7ecb435bd56a781902c2430cc472e?s=128&d=identicon&r=PG", "display_name": "Alejandro Nagy", "link": "https://stackoverflow.com/users/438009/alejandro-nagy"}, "edited": false, "score": 0, "creation_date": 1513801017, "post_id": 47913672, "comment_id": 82795180, "body": "<a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-find-method-excel\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/excel-vba/articles/&hellip;</a> 20 seconds search on google with your question title. Please put some effort into it."}, {"owner": {"reputation": 81, "user_id": 9124181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d01486c7d6ca9362e0329de38090e1c7?s=128&d=identicon&r=PG&f=1", "display_name": "Sw1tch", "link": "https://stackoverflow.com/users/9124181/sw1tch"}, "edited": false, "score": 0, "creation_date": 1513801033, "post_id": 47913672, "comment_id": 82795192, "body": "ROW_NUMBER = 16  ROW_NUMBER = ROW_NUMBER + 1 PARTICULARS = Sheets(&quot;Invoice&quot;).Range(&quot;B&quot; &amp; ROW_NUMBER) &#39;XXX = InStr(PARTICULARS, &quot;GAS CYLINDER&quot;  For Each XXX In Range(&quot;B17: B29&quot;) If MYRNG = Empty And InStr(PARTICULARS, &quot;GAS CYLINDER&quot;) &gt; 1 Then MYRNG = XXX.Address ElseIf InStr(PARTICULARS, &quot;GAS CYLINDER&quot;) &gt; 1 Then MYRNG = MYRNG &amp; &quot;,&quot; &amp; XXX.Address End If Next XXX   Range(MYRNG).Select   Selection.Offset(0, 6).Select"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 3, "creation_date": 1513801099, "post_id": 47913672, "comment_id": 82795226, "body": "Can you add the code into the original post, and tag with the code tags (<code>{}</code>)? It&#39;s hard to read in the comments."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1513801692, "post_id": 47913672, "comment_id": 82795498, "body": "I hate to be pedantic (but computer programs <b>are</b>, so you need to get used to it) but you say &quot;I want to look for a string &quot;GAS CYLINDERS&quot; &quot; and then you show sample data that does not contain that string anywhere."}, {"owner": {"reputation": 81, "user_id": 9124181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d01486c7d6ca9362e0329de38090e1c7?s=128&d=identicon&r=PG&f=1", "display_name": "Sw1tch", "link": "https://stackoverflow.com/users/9124181/sw1tch"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1513803387, "post_id": 47913672, "comment_id": 82796314, "body": "@BruceWayne i hope the code i tried initially can be  clearly seen now."}, {"owner": {"reputation": 81, "user_id": 9124181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d01486c7d6ca9362e0329de38090e1c7?s=128&d=identicon&r=PG&f=1", "display_name": "Sw1tch", "link": "https://stackoverflow.com/users/9124181/sw1tch"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513803652, "post_id": 47913672, "comment_id": 82796453, "body": "@YowE3K text in cells &quot;b17&quot;,&quot;b19&quot;,b21&quot;(in the image) contain &quot;GAS CYLINDERS&quot; in them?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513803830, "post_id": 47913672, "comment_id": 82796525, "body": "Programs won&#39;t match &quot;GAS CYLINDERS&quot; with &quot;GAS CYLINDER&quot; - there is no &quot;S&quot; on the end of the string in your sample data - that&#39;s why I say you need to get used to them being pedantic.  (It looks like your code is searching for the correct thing, so it is only the question that isn&#39;t pedantic enough.)"}, {"owner": {"reputation": 81, "user_id": 9124181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d01486c7d6ca9362e0329de38090e1c7?s=128&d=identicon&r=PG&f=1", "display_name": "Sw1tch", "link": "https://stackoverflow.com/users/9124181/sw1tch"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513806220, "post_id": 47913672, "comment_id": 82797550, "body": "@YowE3K understood. thank you! :)"}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 9124181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d01486c7d6ca9362e0329de38090e1c7?s=128&d=identicon&r=PG&f=1", "display_name": "Sw1tch", "link": "https://stackoverflow.com/users/9124181/sw1tch"}, "edited": false, "score": 0, "creation_date": 1513803039, "post_id": 47913913, "comment_id": 82796170, "body": "i actually want excel to pop an error message if the total of the eligible cells doesnt match the value of cell &quot;n22&quot; when i click &quot;save&quot; command button on my userform.That is why i need the vba code."}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "reply_to_user": {"reputation": 81, "user_id": 9124181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d01486c7d6ca9362e0329de38090e1c7?s=128&d=identicon&r=PG&f=1", "display_name": "Sw1tch", "link": "https://stackoverflow.com/users/9124181/sw1tch"}, "edited": false, "score": 0, "creation_date": 1513803270, "post_id": 47913913, "comment_id": 82796262, "body": "Updated answer - just use the formula and test the value of M22."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 81, "user_id": 9124181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d01486c7d6ca9362e0329de38090e1c7?s=128&d=identicon&r=PG&f=1", "display_name": "Sw1tch", "link": "https://stackoverflow.com/users/9124181/sw1tch"}, "edited": false, "score": 0, "creation_date": 1513804056, "post_id": 47913913, "comment_id": 82796621, "body": "@Sw1tch Or just use an <code>If Range(&quot;N22&quot;).Value &lt;&gt; Application.SumIf(Range(&quot;B17:B21&quot;, &quot;*Gas Cylinder*&quot;, Range(&quot;H17:H21&quot;)) Then</code> in VBA."}, {"owner": {"reputation": 81, "user_id": 9124181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d01486c7d6ca9362e0329de38090e1c7?s=128&d=identicon&r=PG&f=1", "display_name": "Sw1tch", "link": "https://stackoverflow.com/users/9124181/sw1tch"}, "edited": false, "score": 0, "creation_date": 1513804728, "post_id": 47913913, "comment_id": 82796891, "body": "testing the value of m22 in vba code worked.Thank You so much for your help and time! I really appreciate it! Also sorry for the trouble. Cheers!(to everyone)"}], "tags": [], "owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "is_accepted": false, "score": 2, "last_activity_date": 1513803251, "last_edit_date": 1513803251, "creation_date": 1513801681, "answer_id": 47913913, "question_id": 47913672, "link": "https://stackoverflow.com/questions/47913672/how-to-select-cells-based-on-specific-string-in-a-range/47913913#47913913", "title": "How to select cells based on specific string in a range?", "body": "<p>Why are you using code instead of a formula?</p>\n\n<p>In cell M22:</p>\n\n<pre><code>=SUMIF(B17:B21, \"*Gas Cylinder*\", H17:H21)\n</code></pre>\n\n<p>To compare and display an error message,</p>\n\n<pre><code>=IF(SUMIF(B17:B21, \"*Gas Cylinder*\", H17:H21)&lt;&gt;N22, \"ERROR: ...\", \"\")\n</code></pre>\n\n<p>Or test for true in M22 in your VBA save code:</p>\n\n<pre><code>=SUMIF(B17:B21, \"*Gas Cylinder*\", H17:H21)&lt;&gt;N22\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 9124181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d01486c7d6ca9362e0329de38090e1c7?s=128&d=identicon&r=PG&f=1", "display_name": "Sw1tch", "link": "https://stackoverflow.com/users/9124181/sw1tch"}, "edited": false, "score": 0, "creation_date": 1513805569, "post_id": 47914433, "comment_id": 82797301, "body": "works like a charm. Also, i&#39;ll keep the &quot;select&quot; suggestion in mind. Thanks a Ton for your time! Cheers!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 81, "user_id": 9124181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d01486c7d6ca9362e0329de38090e1c7?s=128&d=identicon&r=PG&f=1", "display_name": "Sw1tch", "link": "https://stackoverflow.com/users/9124181/sw1tch"}, "edited": false, "score": 1, "creation_date": 1513810748, "post_id": 47914433, "comment_id": 82799148, "body": "@Sw1tch - When you have a moment, you should check out <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">this SO question/answer</a> on how to avoid using <code>.Select</code>/<code>.Activate</code>."}, {"owner": {"reputation": 81, "user_id": 9124181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d01486c7d6ca9362e0329de38090e1c7?s=128&d=identicon&r=PG&f=1", "display_name": "Sw1tch", "link": "https://stackoverflow.com/users/9124181/sw1tch"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1513829596, "post_id": 47914433, "comment_id": 82803540, "body": "@BruceWayne i sure will. Thank you!"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1513804421, "creation_date": 1513804421, "answer_id": 47914433, "question_id": 47913672, "link": "https://stackoverflow.com/questions/47913672/how-to-select-cells-based-on-specific-string-in-a-range/47914433#47914433", "title": "How to select cells based on specific string in a range?", "body": "<p>Firstly, there is very rarely a need to <code>Select</code> things in VBA.</p>\n\n<p>You want to calculate a number and place that into a cell, so simplify your code to just do that:</p>\n\n<pre><code>Dim XXX As Range\nDim myTotal As Long\n\nFor Each XXX In Range(\"B17: B29\")\n    If InStr(XXX.Value, \"GAS CYLINDER\") &gt; 0 Then\n        myTotal = myTotal + XXX.Offset(0, 6).Value\n    End If\nNext XXX\n\nRange(\"M22\").Value = myTotal\n</code></pre>\n\n<hr>\n\n<p>Or you could just use Excel's <code>SumIf</code> function:</p>\n\n<pre><code>Range(\"M22\").Value = Application.SumIf(Range(\"B17:B29\", \"*GAS CYLINDER*\", Range(\"H17:H29\"))\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 9124181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d01486c7d6ca9362e0329de38090e1c7?s=128&d=identicon&r=PG&f=1", "display_name": "Sw1tch", "link": "https://stackoverflow.com/users/9124181/sw1tch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1249, "favorite_count": 0, "accepted_answer_id": 47914433, "answer_count": 2, "score": -3, "last_activity_date": 1575268875, "creation_date": 1513800580, "last_edit_date": 1592644375, "question_id": 47913672, "link": "https://stackoverflow.com/questions/47913672/how-to-select-cells-based-on-specific-string-in-a-range", "title": "How to select cells based on specific string in a range?", "body": "<p>I want to look for a string &quot;GAS CYLINDERS&quot; in range &quot;B17:B29&quot; and if a cell contains the given string, go to column &quot;H&quot;(from &quot;B&quot;) of the same row of the cell which contains the string then, select it.I want it to loop till row 29 and keep on selecting the eligible cells and take the sum of the values of all selected cells and finally , paste the total in another cell (&quot;M22&quot;)</p>\n<p>Code I tried:</p>\n<pre><code>ROW_NUMBER = 16\nROW_NUMBER = ROW_NUMBER + 1\nPARTICULARS = Sheets(&quot;Invoice&quot;).Range(&quot;B&quot; &amp; ROW_NUMBER)\nXXX = InStr(PARTICULARS, &quot;GAS CYLINDER&quot;)\n\nFor Each XXX In Range(&quot;B17: B29&quot;)\n    If MYRNG = Empty And InStr(PARTICULARS, &quot;GAS CYLINDER&quot;) &gt; 1 Then\n        MYRNG = XXX.Address\n    ElseIf InStr(PARTICULARS, &quot;GAS CYLINDER&quot;) &gt; 1 Then\n        MYRNG = MYRNG &amp; &quot;,&quot; &amp; XXX.Address\n    End If\nNext XXX\n\nRange(MYRNG).Select\nSelection.Offset(0, 6).Select\n</code></pre>\n<p>Image for reference\n<img src=\"https://i.stack.imgur.com/1IMYV.png\" alt=\"Image for reference\" /></p>\n<p>PS: I'm new to VBA. The code that i tried i found on You tube and Google and I modified it a little because the code i initially found didn't get me the expected result.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 6932758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4bca369fc49e280e4e4510f2a34da53e?s=128&d=identicon&r=PG&f=1", "display_name": "jules325", "link": "https://stackoverflow.com/users/6932758/jules325"}, "edited": false, "score": 0, "creation_date": 1513804371, "post_id": 47914116, "comment_id": 82796749, "body": "Thanks, Scott. Works beautifulIy. I&#39;m trying to understand the code; What is the &quot;Me&quot; in the code?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 159, "user_id": 6932758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4bca369fc49e280e4e4510f2a34da53e?s=128&d=identicon&r=PG&f=1", "display_name": "jules325", "link": "https://stackoverflow.com/users/6932758/jules325"}, "edited": false, "score": 1, "creation_date": 1513804475, "post_id": 47914116, "comment_id": 82796790, "body": "@jules325 <code>Me</code> is the object where the code lies, in this case, the worksheet. It&#39;s not really needed, but sometimes I use it anyway out of habit of qualifying all objects to their parent."}, {"owner": {"reputation": 159, "user_id": 6932758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4bca369fc49e280e4e4510f2a34da53e?s=128&d=identicon&r=PG&f=1", "display_name": "jules325", "link": "https://stackoverflow.com/users/6932758/jules325"}, "edited": false, "score": 0, "creation_date": 1513804617, "post_id": 47914116, "comment_id": 82796849, "body": "Awesome, I really appreciate it. Thanks,"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1513802772, "creation_date": 1513802772, "answer_id": 47914116, "question_id": 47913661, "link": "https://stackoverflow.com/questions/47913661/dynamic-hide-columns-base-on-user-input/47914116#47914116", "title": "Dynamic Hide Columns Base on User Input", "body": "<p>If I understand your question properly, change your year input cell to another column before column F, otherwise, you run the risk of hiding the input cell :)</p>\n\n<p>Then place this code inside the worksheet module where the data is. Make range adjustments to the code as needed for your data.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Address = Me.Range(\"D8\").Address Then 'i moved input cell to D8\n\n        Application.ScreenUpdating = False\n\n        Range(\"F14:Z14\").EntireColumn.Hidden = False 'this range is the total for the number of years you have\n\n        Dim hideYears As Range\n        Set hideYears = Me.Range(\"F14\").Offset(0, Target.Value)\n        Set hideYears = Range(hideYears, hideYears.End(xlToRight))\n\n        hideYears.EntireColumn.Hidden = True\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 6932758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4bca369fc49e280e4e4510f2a34da53e?s=128&d=identicon&r=PG&f=1", "display_name": "jules325", "link": "https://stackoverflow.com/users/6932758/jules325"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "accepted_answer_id": 47914116, "answer_count": 1, "score": 0, "last_activity_date": 1513802772, "creation_date": 1513800544, "last_edit_date": 1531164843, "question_id": 47913661, "link": "https://stackoverflow.com/questions/47913661/dynamic-hide-columns-base-on-user-input", "title": "Dynamic Hide Columns Base on User Input", "body": "<p>I have a worksheet which lists years across a row 14 with various values that fall below the years. I want to have a user input cell where they can input the number of years they want to see, while hiding the remaining columns. I know the code for this must be simple, but I seem to be having a difficult time wrapping my head around how to actually code this. I have attempted the following:</p>\n\n<pre><code>Sub HideCol()\n\nRange(\"F14\").Select\n\nyearSelect = Range(\"J8\").Value\n\nnumrows = Selection.Rows.Count\nnumCols = Selection.Columns.Count\n\nSelection.Resize(numrows + 0, numCols + yearSelect).Select\n\nSelection.EntireColumnHidden = True\n\n\nEnd Sub\n</code></pre>\n\n<p>I really think I'm after the inverse of the resize, meaning I'm hiding the selected region versus hiding the rest of the columns. Thank you in advance,</p>\n"}, {"tags": ["vba", "excel", "charts"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1513798427, "post_id": 47913157, "comment_id": 82794045, "body": "Did you manually investigate the chart settings to see if there is something in your code that is causing unintended settings?"}, {"owner": {"reputation": 407, "user_id": 2731076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c897b26495c3b19cc1901a9e8ce05e81?s=128&d=identicon&r=PG&f=1", "display_name": "user2731076", "link": "https://stackoverflow.com/users/2731076/user2731076"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1513798669, "post_id": 47913157, "comment_id": 82794143, "body": "As far as I have been able to see, the chart settings don&#39;t change between the data being displayed and not being displayed. As I mentioned, it is as simple as opening the Select Data menu and just clicking one of the data series, I don&#39;t even edit it. I just click on a data series in that menu and the data instantly appears."}], "owner": {"reputation": 407, "user_id": 2731076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c897b26495c3b19cc1901a9e8ce05e81?s=128&d=identicon&r=PG&f=1", "display_name": "user2731076", "link": "https://stackoverflow.com/users/2731076/user2731076"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 434, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513799788, "creation_date": 1513798305, "last_edit_date": 1513799788, "question_id": 47913157, "link": "https://stackoverflow.com/questions/47913157/excel-custom-combination-chart-randomly-stops-displaying-data-series", "title": "Excel custom combination chart randomly stops displaying data series", "body": "<p>I have a peculiar problem that comes and goes somewhat randomly. I am creating a chart using VBA. I first add up to 10 data series on an XY chart  and then I add one more data series as a clustered column. The code works as it should and the graph is created and all of the data is there. </p>\n\n<p>The problem comes in when I try to update the chart to plot a different set of data. It will usually work correctly once or twice but then the data will just stop showing up on the chart but the labels and legend will still be there. The data still exists in the chart and I can get it to appear again by going to the Excel Select Data menu and selecting one of the data series or by restarting the program, but until I do one of those things its just an empty chart.</p>\n\n<p>The code I use to update the plot is included below. It simply checks a few cells to see what data to actually plot then grabs that data and adds it to the chart. I have stepped through it line-by-line but never got the problem to occur this way.</p>\n\n<pre><code>Dim wb As Workbook\nDim ws As Worksheet\nDim cht As ChartObject\nDim rn, rn2, colorRn As Range\nDim i, j, MyLength, numlines, MyEnd As Integer\nDim MyAdd, MyChar As String\n\nSet wb = ThisWorkbook\nSet ws = wb.Worksheets(\"Data\")\nSet cht = ws.ChartObjects(\"Data_Chart\")\n\nApplication.ScreenUpdating = False\n\n'Find Last row to use in plots, this is due to combo plot limitation\n    Set rn = ws.Range(\"D45:M45\")\n    Set rn2 = ws.Range(\"D43:M43\")\n    MyEnd = CInt(Right(ws.Range(\"B44\").CurrentRegion.Address, 3))\n\n'Clear Prev Plot Series\ncht.Activate\nnumlines = ActiveChart.SeriesCollection.Count\nIf ActiveChart.SeriesCollection.Count &gt; 0 Then\n    i = ActiveChart.SeriesCollection.Count\n    While i &gt; 0\n        ActiveChart.SeriesCollection(i).Delete\n    i = i - 1\n    Wend\nElse\nEnd If\n\n'Plot or not range\nSet rn = ws.Range(\"B5:G14\")\n\n'Add data series\nFor i = 1 To rn.Rows.Count\n    If rn(i, 4) = \"Yes\" Then\n        ActiveChart.SeriesCollection.NewSeries\n        numlines = ActiveChart.SeriesCollection.Count\n        With ActiveChart.SeriesCollection(numlines)\n            .Name = ws.Range(\"B\" &amp; CStr(i + 4))\n            .XValues = ws.Range(\"B45:B\" &amp; MyEnd)\n            .Values = ws.Range(rn(i, 6) &amp; \"45:\" &amp; rn(i, 6) &amp; MyEnd)\n\n        'format color\n            .MarkerForegroundColor = rn(i, 5).Cells.Interior.Color\n            .MarkerBackgroundColor = rn(i, 5).Cells.Interior.Color\n            .MarkerSize = 3\n        End With\n    Else\n    End If\nNext i\n\n'********* Try to insert columns\nActiveChart.SeriesCollection.NewSeries\nnumlines = ActiveChart.SeriesCollection.Count\nWith ActiveChart.SeriesCollection(numlines)\n    .Name = ws.Range(\"C44\")\n    .XValues = ws.Range(\"B45:B\" &amp; MyEnd)\n    .Values = ws.Range(\"A45:A\" &amp; MyEnd)\n    .ChartType = xlColumnClustered\n    'Format column color\n    .Format.Fill.ForeColor.RGB = RGB(255, 255, 0)\n    .Format.Line.ForeColor.RGB = RGB(255, 255, 0)\nEnd With\nActiveChart.ChartGroups(1).GapWidth = 0\n'Fix scale for combo plot\nActiveChart.Axes(xlCategory).TickLabelSpacing = 10\nActiveChart.Axes(xlCategory).MajorTickMark = xlOutside\nActiveChart.SetElement (msoElementPrimaryCategoryGridLinesNone)\n\nCall MyRescalePos\n\nSet rn = Nothing\nSet cht = Nothing\nSet ws = Nothing\nSet wb = Nothing\n\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>And the Rescale sub</p>\n\n<pre><code>Sub MyRescalePos()\n\nWorksheets(\"Data\").Activate\nActiveSheet.ChartObjects(\"Data_Chart\").Activate\n\n\n    ActiveChart.Axes(xlValue).MinimumScale = Worksheets(\"Data\").Range(\"Q8\")\n    ActiveChart.Axes(xlValue).MaximumScale = Worksheets(\"Data\").Range(\"Q9\")\n    ActiveChart.Axes(xlValue).MajorUnit = Worksheets(\"Data\").Range(\"Q10\")\n    ActiveChart.Axes(xlValue).CrossesAt = 0\n\nEnd Sub\n</code></pre>\n\n<p>I can't see anything wrong except that maybe Excel just doesn't like combo plots. I also haven't been able to find any other posts online relating to a similar issue where the data seems to be formatted correctly and actually exists in the chart, just isn't displayed. Any help would be appreciated.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1513800039, "post_id": 47913154, "comment_id": 82794739, "body": "What is wrong with the code, where does it error and what error is thrown?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513800785, "post_id": 47913154, "comment_id": 82795083, "body": "As a start, get rid of the two <code>With Application</code> statements within your <code>If</code> block - they aren&#39;t needed, and you don&#39;t have matching <code>End With</code> statements for them anyway so the code won&#39;t compile."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1513801733, "last_edit_date": 1513801733, "creation_date": 1513800890, "answer_id": 47913732, "question_id": 47913154, "link": "https://stackoverflow.com/questions/47913154/complex-vba-function-with-excel-if-index-match-function/47913732#47913732", "title": "complex VBA function with excel IF, index, match function", "body": "<p>One, you do not need the Else as it just repeats the first.</p>\n\n<p>Two, every <code>With</code> needs an <code>End With</code>, in this case the other <code>With Application</code> are not needed.</p>\n\n<p>Three, Index is <code>Row,Column</code> not <code>Column,Row</code></p>\n\n<pre><code>Public Function NGrid(rData As Range, rBudCode As Range, rMo As Range, budgetcode As Variant, mo As Variant)\nDim rw As Long\nDim col As Long\n\nWith Application\n    col = .Match(budgetcode + 1, rBudCode, 0)\n    rw = .Match(mo, rMo, 0)\n    NGrid = .Index(rData, rw, col)\n    If NGrid = 0 Then\n        col = .Match(budgetcode, rBudCode, 0)\n        rw = .Match(mo, rMo, 0)\n        NGrid = .Index(rData, rw, col)\n    End If\nEnd With\nEnd Function\n</code></pre>\n\n<p>Then make sure you include the title row and column in rData:</p>\n\n<pre><code>=NGrid(Grid!$A$1:$G$5,Grid!$A$1:$G$1,Grid!$A$1:$A$5,B2,A2)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/h97Lr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/h97Lr.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>This allows the use of just the range of the grid, no need to specify the first row and column differently:</p>\n\n<pre><code>Public Function NGrid(rData As Range, budgetcode As Variant, mo As Variant)\nDim rw As Long\nDim col As Long\nDim rBudCode As Range\nDim rMo As Range\nWith Application\n    Set rBudCode = rData.Rows(1)\n    Set rMo = rData.Columns(1)\n    col = .Match(budgetcode + 1, rBudCode, 0)\n    rw = .Match(mo, rMo, 0)\n    NGrid = .Index(rData, rw, col)\n    If NGrid = 0 Then\n        NGrid = .Index(rData, rw, col - 1)\n    End If\nEnd With\nEnd Function\n</code></pre>\n\n<p>So the above formula would be:</p>\n\n<pre><code>=NGrid(Grid!$A$1:$G$5,B2,A2)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/dKqtk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dKqtk.png\" alt=\"enter image description here\"></a>  </p>\n\n<hr>\n\n<p>Grid sheet: for reference</p>\n\n<p><a href=\"https://i.stack.imgur.com/H7H56.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/H7H56.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1513801259, "creation_date": 1513801259, "answer_id": 47913819, "question_id": 47913154, "link": "https://stackoverflow.com/questions/47913154/complex-vba-function-with-excel-if-index-match-function/47913819#47913819", "title": "complex VBA function with excel IF, index, match function", "body": "<p>Untested:</p>\n\n<pre><code>Public Function NGrid(rData As Range, rBudCode As Range, rMo As Range, budgetcode As Variant, mo As Variant)\n    Dim rw As Variant, col As Variant\n\n    With Application\n        col = .Match(budgetcode + 1, rBudCode, 0)\n        rw = .Match(mo, rMo, 0)\n\n        If Not IsError(rw) Then\n            If Not IsError(col) Then\n                NGrid = .Index(rData, col, rw)\n                If NGrid = 0 Then\n                    col = .Match(budgetcode, rBudCode, 0)\n                    If Not IsError(col) Then\n                        NGrid = .Index(rData, col, rw)\n                    Else\n                        NGrid = \"budget?\" 'no col match\n                    End If\n                End If\n            Else\n                NGrid = \"budget+1?\" 'no col match on +1\n            End If\n        Else\n            NGrid = \"mo?\" 'no row match\n        End If\n    End With\n\nEnd Function\n</code></pre>\n\n<p>If your source data always has the lookups in the first column and row then you really only need to pass in a single range: you can pick out the lookup ranges from that using <code>.Rows(1)</code> and <code>.Columns(1)</code></p>\n"}], "owner": {"reputation": 15, "user_id": 6491004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80e84b86c16b537e2e3fdcc859690b36?s=128&d=identicon&r=PG&f=1", "display_name": "SAM HO", "link": "https://stackoverflow.com/users/6491004/sam-ho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 696, "favorite_count": 1, "accepted_answer_id": 47913732, "answer_count": 2, "score": 0, "last_activity_date": 1600884427, "creation_date": 1513798297, "last_edit_date": 1513800496, "question_id": 47913154, "link": "https://stackoverflow.com/questions/47913154/complex-vba-function-with-excel-if-index-match-function", "title": "complex VBA function with excel IF, index, match function", "body": "<p>Please help me to create VBA function wtih excel IF, index, match function. here is my excel function :</p>\n\n<pre><code>=IF(INDEX(Grid!$B$3:$G$6,MATCH('Sal-Data'!$A2,Grid!$A$3:$A$6,0),MATCH('Sal-Data'!$B2+1,Grid!$B$2:$G$2,0))=0,$B2,$B2+1)\n</code></pre>\n\n<p>I have added VBA codes here ,which is not working, I want a result for next Level from Grid Sheet. example if current Grid in Sheet\"Sal-data\" for Emp \"b\" is 2 then new Grid would be 3, but value in \"Grid\" sheet for \"b\" Grid 3 is 0 (zero) then Grid should not be increase. In this case if \"b\" current grid is 3 then b's next grid may get 4 , but grid 4 value is 0 then \"b\"s grid should not increase as there is no value.</p>\n\n<p>Here is my VBA coding :</p>\n\n<pre><code>Public Function NGrid(rData As Range, rBudCode As Range, rMo As Range, budgetcode As Variant, mo As Variant)\nDim rw As Variant\nDim col As Variant\n    With Application\n        col = .Match(budgetcode+1, rBudCode, 0)\n        rw = .Match(mo, rMo, 0)\n        NGrid = .Index(rData, col, rw)\n\nIf NGrid= 0 Then\n With Application\ncol = .Match(budgetcode, rBudCode, 0)\n        rw = .Match(mo, rMo, 0)\n        NGrid = .Index(rData, col, rw)\nElse\nWith Application\ncol = .Match(budgetcode+1, rBudCode, 0)\n        rw = .Match(mo, rMo, 0)\n        NGrid = .Index(rData, col, rw)\nEnd if \nEnd with \nEnd Function\n</code></pre>\n\n<hr>\n\n<pre><code> Excel sheet name : Grid\n\n    1   2   3   4   5   6\na   10  11  12  13  0   0\nb   20  21  22  0   0   0\nc   30  31  32  33  34  0\nd   40  41  42  0   0   0\n\n\nExcel sheet name : Sal-Data\n\nEmp grid    New grid\na   4   = NGrid (...) required VBA function\na   2   \nb   1   \nb   2   \n</code></pre>\n\n<p>Than you in advance.</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1513797571, "post_id": 47912983, "comment_id": 82793631, "body": "What error, at what line?"}, {"owner": {"reputation": 1, "user_id": 9124179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efb538bfa634f1643768103cb29e3932?s=128&d=identicon&r=PG&f=1", "display_name": "Patrycja", "link": "https://stackoverflow.com/users/9124179/patrycja"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1513797767, "post_id": 47912983, "comment_id": 82793716, "body": "Tabel(i) = ActiveCell.Value &quot;Runtime-error   &#39;9&#39; subscript out of range&quot;"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 1, "creation_date": 1513797990, "post_id": 47912983, "comment_id": 82793828, "body": "Before using <code>Tabel</code>, you need to <code>ReDim</code> it: <code>ReDim Preserve Tabel(i)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1024, "user_id": 6040823, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/DDCAB.jpg?s=128&g=1", "display_name": "Jason Brady", "link": "https://stackoverflow.com/users/6040823/jason-brady"}, "edited": false, "score": 1, "creation_date": 1513798421, "post_id": 47913101, "comment_id": 82794042, "body": "Also, you skip your first &quot;Data:&quot; since your loop starts with <code>Set FindIt = Range(&quot;A1:A100&quot;).FindNext(after:=FindIt)</code> and you already found one <code>FindIt</code>, your array or collection will always start with the 2nd &quot;Data:&quot;"}, {"owner": {"reputation": 1, "user_id": 9124179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efb538bfa634f1643768103cb29e3932?s=128&d=identicon&r=PG&f=1", "display_name": "Patrycja", "link": "https://stackoverflow.com/users/9124179/patrycja"}, "edited": false, "score": 0, "creation_date": 1513799327, "post_id": 47913101, "comment_id": 82794434, "body": "It is a first time when I try to find all records with an exact value. I know that I start with  the second search but I didn&#39;t know how to solve it so I check 1st row at the end and it is marked as well. If I didn&#39;t use &quot;after:= &quot; it didn&#39;t work at all. Do you maybe know how to do it differently? I will be happy to learn more.:)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1024, "user_id": 6040823, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/DDCAB.jpg?s=128&g=1", "display_name": "Jason Brady", "link": "https://stackoverflow.com/users/6040823/jason-brady"}, "edited": false, "score": 0, "creation_date": 1513799409, "post_id": 47913101, "comment_id": 82794482, "body": "See @JasonBrady&#39;s answer for another valid (IMO more robust than <code>Find</code>) approach"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 3, "last_activity_date": 1513798058, "creation_date": 1513798058, "answer_id": 47913101, "question_id": 47912983, "link": "https://stackoverflow.com/questions/47912983/how-to-insert-data-in-the-array-inside-a-loop/47913101#47913101", "title": "How to insert data in the array (inside a loop)?", "body": "<p>You never sized your array.</p>\n\n<pre><code>Dim Tabel() As Variant\n</code></pre>\n\n<p>Use <code>ReDim</code> to resize a dynamically-sized array.</p>\n\n<pre><code>ReDim Preserve Tabel(0 To UBound(Tabel)+1)\n</code></pre>\n\n<p>However that's a terribly inefficient thing to do in a loop (you're copying the same elements over and over and over and over again, at every single iteration).</p>\n\n<p>Rule of thumb, if you don't know from the start how many elements you're going to need, it's probably best to use a <code>Collection</code> instead of an array.</p>\n\n<pre><code>Dim items As Collection\nSet items = New Collection\n\n'...\n\nitems.Add ActiveCell.Value\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1513799513, "post_id": 47913380, "comment_id": 82794525, "body": "If you don&#39;t need to alter the cells, it might be a good idea to dump the search range into a local variant array, and iterate <i>that</i> instead of <code>Range</code> objects, which are notoriously slow. Also if <code>cell.Value</code> contains an error (e.g. <code>#REF!</code>), expect a <i>type mismatch</i> on that <code>If</code> statement; you can avoid it by first checking whether <code>IsError(cell.Value)</code>."}], "tags": [], "owner": {"reputation": 1024, "user_id": 6040823, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/DDCAB.jpg?s=128&g=1", "display_name": "Jason Brady", "link": "https://stackoverflow.com/users/6040823/jason-brady"}, "is_accepted": false, "score": 1, "last_activity_date": 1513799266, "creation_date": 1513799266, "answer_id": 47913380, "question_id": 47912983, "link": "https://stackoverflow.com/questions/47912983/how-to-insert-data-in-the-array-inside-a-loop/47913380#47913380", "title": "How to insert data in the array (inside a loop)?", "body": "<p>You could also use a for loop instead of a find (also using Mat's Mug idea about collections)</p>\n\n<pre><code>Sub CheckData1()\n\nDim ws As Worksheet\nDim searchRng As Range\nDim cell As Range\nDim tabel As Collection 'incorrectly spelt table?\n\nSet ws = ActiveSheet\nSet tabel = New Collection\nSet searchRng = ws.Range(\"A1:A100\")\n\nFor Each cell In searchRng.Cells\n    If cell.Value = \"Data:\" Then\n        tabel.Add cell.Offset(, 1)\n        cell.Offset(, 1).Interior.ColorIndex = 6 'If you still need it highlighted\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9124179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efb538bfa634f1643768103cb29e3932?s=128&d=identicon&r=PG&f=1", "display_name": "Patrycja", "link": "https://stackoverflow.com/users/9124179/patrycja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1513799266, "creation_date": 1513797513, "question_id": 47912983, "link": "https://stackoverflow.com/questions/47912983/how-to-insert-data-in-the-array-inside-a-loop", "title": "How to insert data in the array (inside a loop)?", "body": "<p>I have a problem with inserting data to the array. In the program I search all cells with \"Data:\" value. If this value appear I jump to the cell on the right and mark it. I want to collect all marked values (all of them are dates) in the array but with my code (enclosed below) I have an error. I have tried ReDim and setting an exact number of objects in the array. I would be grateful for a help.   </p>\n\n<pre><code>Sub CheckData()\nDim FindIt As Range\nDim EndIt As Range\nDim StartAddress As String\n\nWith Range(\"A1:A100\")\n    Set EndIt = .Cells(.Cells.Count)\nEnd With\n\nSet FindIt = Range(\"A1:A100\").Find(what:=\"Data:\", after:=EndIt)\n\nIf Not FindIt Is Nothing Then\n    StartAddress = FindIt.Address\nEnd If\n\nDim Tabel() As Variant\nTabel = Array()\ni = 0\n\nDo Until FindIt Is Nothing\n    Set FindIt = Range(\"A1:A100\").FindNext(after:=FindIt)\n\n    Data = FindIt.Address\n    Range(Data).Select\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.Interior.ColorIndex = 6\n\n    'Debug.Print ActiveCell.Value\n    Tabel(i) = ActiveCell.Value\n    i = i + 1\n    'Debug.Print i\n\n    If FindIt.Address = StartAddress Then\n        Exit Do\n    End If\n\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "summary"], "comments": [{"owner": {"reputation": 1, "user_id": 9124110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d37b9869afdead50426fb852666e2b67?s=128&d=identicon&r=PG&f=1", "display_name": "CodingGrandma", "link": "https://stackoverflow.com/users/9124110/codinggrandma"}, "reply_to_user": {"reputation": 4917, "user_id": 2320961, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AdwXN.png?s=128&g=1", "display_name": "Nic3500", "link": "https://stackoverflow.com/users/2320961/nic3500"}, "edited": false, "score": 0, "creation_date": 1513799110, "post_id": 47912972, "comment_id": 82794343, "body": "Apologies: I don&#39;t know where to start. So Far all I have is the structure as follows:"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1513799110, "post_id": 47912972, "comment_id": 82794344, "body": "Any reason why a pivottable wouldn&#39;t sort this?"}, {"owner": {"reputation": 1, "user_id": 9124110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d37b9869afdead50426fb852666e2b67?s=128&d=identicon&r=PG&f=1", "display_name": "CodingGrandma", "link": "https://stackoverflow.com/users/9124110/codinggrandma"}, "edited": false, "score": 0, "creation_date": 1513800074, "post_id": 47912972, "comment_id": 82794759, "body": "It&#39;s part of a larger workbook that relies entirely on automation based on the results in one worksheet. This one sheet needs to show a summary of another sheet."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9124110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d37b9869afdead50426fb852666e2b67?s=128&d=identicon&r=PG&f=1", "display_name": "CodingGrandma", "link": "https://stackoverflow.com/users/9124110/codinggrandma"}, "edited": false, "score": 0, "creation_date": 1513802594, "post_id": 47913848, "comment_id": 82795972, "body": "Many thanks. Unfortunatley I&#39;ve been told we can&#39;t use a pivot table due to standardisation of tools it has to display in a table with data laid out in a particular way. I&#39;ve simplified the sheets to ask for help. It&#39;s a 20 sheet workbook and the summary fields from the sample above will be providing the data for 4 of 8 columns in a sheet. It needs to populate a summary sheet as on the display sheet the user will have the ability to say the top n ID&#39;s which will show the top n based on a column which will be a total of 2 of the columns above."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1, "user_id": 9124110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d37b9869afdead50426fb852666e2b67?s=128&d=identicon&r=PG&f=1", "display_name": "CodingGrandma", "link": "https://stackoverflow.com/users/9124110/codinggrandma"}, "edited": false, "score": 0, "creation_date": 1513803740, "post_id": 47913848, "comment_id": 82796485, "body": "1) You can still display a table and use getpivotdata formulas to pull back the data as per the layout you want. The pivottable being hidden. 2) This means you can also use a slicer to pick top n ID&#39;s. (Though i am guessing if you can&#39;t show a pivottable then you can&#39;t show a slicer)."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1, "user_id": 9124110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d37b9869afdead50426fb852666e2b67?s=128&d=identicon&r=PG&f=1", "display_name": "CodingGrandma", "link": "https://stackoverflow.com/users/9124110/codinggrandma"}, "edited": false, "score": 0, "creation_date": 1513803784, "post_id": 47913848, "comment_id": 82796507, "body": "I am on mission convert here!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1, "user_id": 9124110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d37b9869afdead50426fb852666e2b67?s=128&d=identicon&r=PG&f=1", "display_name": "CodingGrandma", "link": "https://stackoverflow.com/users/9124110/codinggrandma"}, "edited": false, "score": 0, "creation_date": 1513804109, "post_id": 47913848, "comment_id": 82796647, "body": "i may delete this answer so i suggest you add the info above into the question i.e. your top comment under my answer. This will help others with their solutions. Also, look into markdown table generator or some other tool that will allow you to add your sample data in, in a tidy fashion, as it cannot be read easily as currently rendered."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1513804387, "last_edit_date": 1513804387, "creation_date": 1513801403, "answer_id": 47913848, "question_id": 47912972, "link": "https://stackoverflow.com/questions/47912972/creating-a-summary-sheet-with-if-statements-in-vba-excel/47913848#47913848", "title": "Creating a Summary Sheet with If Statements in VBA Excel", "body": "<p>So you are aware of what you could do with a pivottable.</p>\n\n<p>If you set your data, as shown in question, up as a table (Ctrl + T whilst in data range) and add 4 hidden helper columns (I to L) as follows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/kICAs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kICAs.png\" alt=\"pivottable\"></a></p>\n\n<p>Note that the 4 end columns reference your original y/n columns but convert the \"Y\" to 1 using in <code>i2</code> (you would drag this formula across the other columns and the table would autofill down).</p>\n\n<pre><code>=--(C2=\"Y\")\n</code></pre>\n\n<p>You could then set the pivottable up to sum these 4 helper columns. Example layout shown above where a summary can be shown by region, date etc.</p>\n\n<p>You could also have your source data as a dynamic named range and point your pivottable at that.</p>\n\n<p>If you are not allowed to show a pivottable consider that you can use <a href=\"http://www.contextures.com/xlPivot06.html\" rel=\"nofollow noreferrer\">GetPivotData</a> formulas to return data from a hidden pivottable to a set up of your specification e.g. a standardized table layout. You can generate pivottables through VBA and target the source to a specified range. Plenty of examples on Stack Overflow.</p>\n"}], "owner": {"reputation": 1, "user_id": 9124110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d37b9869afdead50426fb852666e2b67?s=128&d=identicon&r=PG&f=1", "display_name": "CodingGrandma", "link": "https://stackoverflow.com/users/9124110/codinggrandma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 194, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1513804387, "creation_date": 1513797460, "last_edit_date": 1513800006, "question_id": 47912972, "link": "https://stackoverflow.com/questions/47912972/creating-a-summary-sheet-with-if-statements-in-vba-excel", "title": "Creating a Summary Sheet with If Statements in VBA Excel", "body": "<p>I have a worksheet with a series of columns as below:</p>\n\n<p>I need to create a summary sheet where I can sum by ID all the \"Y\" entries so the summary sheet would show a count of Y's per column so the summary sheet would contain C1, C2-C5 with Columns 2-5 being numerical instead of boolean.</p>\n\n<p>I have created a loop to review if the row should be included in the summary (The Date, Region and Job role are all variable as to if they should be included in the summary) I just now need to group and summarise the 4 Y/N columns, I'm just not sure how to do it in VBA as it's not a language familiar to me. </p>\n\n<p>Any help greatly received</p>\n\n<p>ID  Date    Y/N 1   Y/N 2   Y/N 3   Y/N 4   Region 1    Job\n1354894 25/06/2017  Y   N   Y   N   South   Sales\n1554968 25/07/2016  N   Y   N   Y   North   Admin\n4581324 19/08/2017  Y   N   Y   N   East    Admin\n4586568 18/06/2016  Y   N   N   Y   South   Admin\n4586568 08/11/2017  N   Y   Y   N   East    Sales\n4587454 23/04/2016  Y   N   Y   N   North   Sales\n4587454 09/12/2017  N   Y   N   Y   North   Sales\n4587454 23/08/2016  Y   N   Y   N   East    Sales\n4595681 25/06/2017  Y   N   N   Y   West    Sales\n5651985 25/07/2016  N   Y   Y   N   West    Sales\n5651985 19/08/2017  Y   N   Y   N   South   Admin\n5651985 18/06/2016  N   Y   N   Y   South   Admin\n5651985 08/11/2017  Y   N   Y   N   East    Admin\n7845658 23/04/2016  Y   N   N   Y   East    Sales\n7851132 09/12/2017  N   Y   Y   N   South   Sales\n7852120 23/08/2016  Y   N   Y   N   South   Sales\n9652158 02/08/2017  N   Y   N   Y   North   Sales\n9831524 02/09/2017  Y   N   Y   N   West    Admin</p>\n\n<p>Code so far (Without being able to copy and paste)</p>\n\n<pre><code>Sub StartSum()\n\nDim x as long\nDim Startdate as Date\nDim EndDate as Date\nDim Region as String\nDim Role as String\nDim tablerw as long\n\n\nStartdate = Worksheets(\"Sheets3\").Range(\"A2\")\nEndDate =  Worksheets(\"Sheets3\").Range(\"A4\")\nRole =  Worksheets(\"Sheets3\").Range(\"B2\")\nRegion =  Worksheets(\"Sheets3\").Range(\"C2\")\n\nWith Worksheets(\"Sheet1\")\n\nx = 2\ntablerw = 2\nDo While Cells(\"A\").Value &lt;&gt;\"\"\n\nIf Worksheets(\"Sheet1\").Range(\"F\" &amp; x).value = Region and     Worksheets(\"Sheet1\").Range(\"G\" &amp; x).value and Worksheets(\"Sheet1\").Range(\"B\" &amp; x).value &gt;= Startdate and Worksheets(\"Sheet1\").Range(\"B\" &amp; x).value &lt;= EndDate Then\n Worksheets(\"Sheet2\").Range(\"A\" &amp; tablerw).Value =  Worksheets(\"Sheet1\").Range(\"A\" &amp; x).Value\n Worksheets(\"Sheet2\").Range(\"B\" &amp; tablerw).Value = Worksheets(\"Sheet1\").Range(\"C\" &amp; x).Value\n Worksheets(\"Sheet2\").Range(\"C\" &amp; tablerw).Value = Worksheets(\"Sheet1\").Range(\"D\" &amp; x).Value\n Worksheets(\"Sheet2\").Range(\"D\" &amp; tablerw).Value = Worksheets(\"Sheet1\").Range(\"E\" &amp; x).Value\n Worksheets(\"Sheet2\").Range(\"E\" &amp; tablerw).Value = Worksheets(\"Sheet1\").Range(\"F\" &amp; x).Value\n Tablerw = Tablerw + 1\n x = x + 1\nEnd If\nNext\nEnd Sub \n</code></pre>\n\n<p>I haven't done any summary yet as unsure where to start</p>\n"}, {"tags": ["excel", "vba", "if-statement", "copy", "rows"], "comments": [{"owner": {"reputation": 441, "user_id": 8492815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f3471534d4aba8f3c18c2ee90416efe?s=128&d=identicon&r=PG&f=1", "display_name": "Carol", "link": "https://stackoverflow.com/users/8492815/carol"}, "edited": false, "score": 2, "creation_date": 1513797473, "post_id": 47912869, "comment_id": 82793583, "body": "At first glance, the IF statement ELSE part is the same as the IF statement THEN part? so I&#39;m going to say you don&#39;t need an IF THEN ELSE, you just need IF THEN, and you just need the test for &#39;=&#39; to include all the lines in your ELSE part under your THEN part. So you will never set the rowcounter to 4 in your loop. Also to make it more efficient look up not activating and selecting sheets."}, {"owner": {"reputation": 11, "user_id": 7763462, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155184712427718/picture?type=large", "display_name": "Russell Lee Nasrallah", "link": "https://stackoverflow.com/users/7763462/russell-lee-nasrallah"}, "reply_to_user": {"reputation": 441, "user_id": 8492815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f3471534d4aba8f3c18c2ee90416efe?s=128&d=identicon&r=PG&f=1", "display_name": "Carol", "link": "https://stackoverflow.com/users/8492815/carol"}, "edited": false, "score": 1, "creation_date": 1513799570, "post_id": 47912869, "comment_id": 82794542, "body": "Thank you for the comment!  Are you suggesting I just get rid of the second IF statement and simply use an ELSE since it will accomplish the same thing?  I am pretty new to coding, so I just want to make sure I understand you correctly."}, {"owner": {"reputation": 441, "user_id": 8492815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f3471534d4aba8f3c18c2ee90416efe?s=128&d=identicon&r=PG&f=1", "display_name": "Carol", "link": "https://stackoverflow.com/users/8492815/carol"}, "edited": false, "score": 0, "creation_date": 1513804268, "post_id": 47912869, "comment_id": 82796709, "body": "Almost. From the code you amended above after my statement, get rid of the line/word ELSE."}], "owner": {"reputation": 11, "user_id": 7763462, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155184712427718/picture?type=large", "display_name": "Russell Lee Nasrallah", "link": "https://stackoverflow.com/users/7763462/russell-lee-nasrallah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1513800751, "creation_date": 1513796990, "last_edit_date": 1513800751, "question_id": 47912869, "link": "https://stackoverflow.com/questions/47912869/excel-vba-row-by-row-copy-with-if-statement-validation", "title": "Excel VBA - Row by Row Copy with If-Statement Validation", "body": "<p>I'm relatively new to VBA and have found myself in a bit of a corner. </p>\n\n<p>The goal:\nI want to copy row values from one spreadsheet to another only if specific fields match between the two rows. If the specific fields don't match, I need to skip a row on the copied <strong>TO</strong> workbook and then re-check the copied <strong>FROM</strong> workbook, creating a gap until they match again. </p>\n\n<p>EX: Let the copied <strong>TO</strong> workbook = WB_A\nLet the copied <strong>FROM</strong> workbook = WB_B</p>\n\n<p>Both workbooks have a column with ID#, X coordinates, and Y coordinates</p>\n\n<p>WB_A has a static set of ID#'s ranging from -99 to 632 with accompanying X&amp;Y coordinates. \nWB_B has a dynamic set of ID#'s which also fall within the -99 to 632 range but may have gaps in the data (149-161 may be completely missing so that the count goes 147,148,162,163...). </p>\n\n<p>I want to copy values from WB_B to WB_A only if the ID#'s match on the given row, otherwise I want to leave a gap on WB_A until it does match with WB_B.</p>\n\n<p>My Method:</p>\n\n<pre><code>Private Sub rowCount()\n\nDim mstRows As Long\nDim wsMstr As Worksheet, wsPline As Worksheet\nDim wbCompRes As Workbook, wbPline As Workbook\nDim i       As Integer\nDim rowCounter As Integer\n\n'Find end of Master Worksheet rows\nSet wsMstr = ThisWorkbook.Worksheets(\"Master Wkst\")\nwsMstr.Activate\nmstRows = Worksheets(\"Master Wkst\").Cells(Rows.Count, 1).End(xlUp).Row\n\n'If statment to check if column a1 in Master Wkst = Column b2 in pline file\n'If true, copies rows into Master Wkst, If false, skips row\nrowCounter = 2\nApplication.ScreenUpdating = False\nFor i = 4 To mstRows\n    If wsMstr.Cells(i, 1).Value &lt;&gt; Workbooks(\"20170210_intersect_pline_transect_singlept.dbf\") _\n       .Worksheets(1).Cells(rowCounter, 2) Then\n    Else\n        Workbooks(\"20170210_intersect_pline_transect_singlept.dbf\").Activate\n        Worksheets(1).Range(Cells(rowCounter, 4), Cells(rowCounter, 5)).Copy\n        wsMstr.Activate\n        wsMstr.Cells(i, 6).Select\n        ActiveSheet.Paste\n        rowCounter = rowCounter + 1\n    End If\nNext\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Currently, I have the code so that it skips the first gap in the data, and then fills out until it gets to the second, gap. My trouble is in cycling through WB_A's non-matching rows while holding WB_B on the same row until it can be matched up with WB_A. </p>\n\n<p>Right now, I have rowCount=4 as a static field, and I know this will be what needs to change, but I am unsure how to change it to make the code function as intended. </p>\n\n<p>I've included links the Pertinent Excel files \nNote: WB_A = Computation_results2017\nWB_B = 20170210_Pline....</p>\n\n<p><a href=\"https://drive.google.com/open?id=12HlCcBuEsl7wZHP29ds9AJzifpjq1HAb\" rel=\"nofollow noreferrer\">Computation_results2017</a></p>\n\n<p><a href=\"https://drive.google.com/open?id=12JtJ3YNDubUyByI9eeXIc1upBw0hpk6Y\" rel=\"nofollow noreferrer\">20170210_Pline...</a></p>\n\n<p>Additionally, any other tricks which might make my code more succinct are welcome!</p>\n\n<p>Thanks for the help. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 9120237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e8e0274274523c40151b2e8f2c6646?s=128&d=identicon&r=PG&f=1", "display_name": "alexc", "link": "https://stackoverflow.com/users/9120237/alexc"}, "edited": false, "score": 0, "creation_date": 1513795930, "post_id": 47912471, "comment_id": 82792821, "body": "yes, this was what I was doing before. I was just using in Excel F5 = W5. The problem was that people were pasting different values in column W5, henceforth it was not picking up anymore the value from F5. That is why I tried to create a VBA code. Even though they will paste a value in cell W5, the code will rejected and it would still pick up the value from F5"}, {"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "reply_to_user": {"reputation": 9, "user_id": 9120237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e8e0274274523c40151b2e8f2c6646?s=128&d=identicon&r=PG&f=1", "display_name": "alexc", "link": "https://stackoverflow.com/users/9120237/alexc"}, "edited": false, "score": 0, "creation_date": 1513796006, "post_id": 47912471, "comment_id": 82792854, "body": "If you need people to not change things, I&#39;d recommend protecting the worksheet. You can also make it so that you only protect some of the worksheet from changes, while letting people edit the rest of the sheet if needed."}], "tags": [], "owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "is_accepted": false, "score": 0, "last_activity_date": 1513795399, "creation_date": 1513795399, "answer_id": 47912471, "question_id": 47912446, "link": "https://stackoverflow.com/questions/47912446/copy-paste-range-values-to-another-column/47912471#47912471", "title": "Copy-Paste range values to another column", "body": "<p>I'm not sure exactly what you're asking. </p>\n\n<p>If you need F5 to be the same as W5, you could just use the formula F5 = W5 in Excel - no need for VBA.</p>\n\n<p>If you need it protected, you can use worksheet protection.</p>\n\n<p>If you need to copy and paste the entire column over-</p>\n\n<pre><code>Thisworkbook.Sheets(\"SheetNameHere\").Range(\"F5:F100\").Value2 = Thisworkbook.Sheets(\"SheetNameHere\").Range(\"W5:W100\").Value2 \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43748, "user_id": 1967396, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qBbwd.png?s=128&g=1", "display_name": "Floris", "link": "https://stackoverflow.com/users/1967396/floris"}, "is_accepted": false, "score": -1, "last_activity_date": 1547051558, "last_edit_date": 1547051558, "creation_date": 1513795825, "answer_id": 47912576, "question_id": 47912446, "link": "https://stackoverflow.com/questions/47912446/copy-paste-range-values-to-another-column/47912576#47912576", "title": "Copy-Paste range values to another column", "body": "<p>Your code is checking to see whether the changed cell was in the range F5:F100 .</p>\n\n<p>When you change cell W5, the Application.Intersect function returns false, and the copy/paste operation doesn't complete.</p>\n\n<p>If you need to make sure that any change in the cells W5:W100 is overwritten immediately by the value in F5:F100, you need to check whether either the source or destination range was changed; and then I would suggest just copying the entire range (F5:F100) over.</p>\n\n<p>Alternatively you could protect the range W5:W100 so it cannot be edited from the spreadsheet. To do this, you first select all the cells the user CAN edit, then go to Format-->Cells-->Protection and UNCHECK the \"locked\" checkbox. Next, select the cells in W5:W100 , repeat the above and make sure they are \"locked\". Finally, protect the entire spreadsheet (Tools--> protection-->protect sheet) and uncheck the \"allow users to select locked cells\" box. Add a password (or don't... the locking mechanism works either way, but it will be harder for the user to override it if you have a password) and you're good to go.</p>\n\n<p>Of course if you go the above route, you don't really need the VBA any more and you could just have an \"=F5\" in cell W5, etc.</p>\n"}], "owner": {"reputation": 9, "user_id": 9120237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e8e0274274523c40151b2e8f2c6646?s=128&d=identicon&r=PG&f=1", "display_name": "alexc", "link": "https://stackoverflow.com/users/9120237/alexc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1547051558, "creation_date": 1513795221, "last_edit_date": 1546945846, "question_id": 47912446, "link": "https://stackoverflow.com/questions/47912446/copy-paste-range-values-to-another-column", "title": "Copy-Paste range values to another column", "body": "<p>I have the following code below which works in some way. The point is that when a value is inserted in column F5 i.e. 10, the value is copied and pasted in column W5, so W5 is 10.</p>\n\n<p>My problem is that if I change the value in W5 from 10 to 8, the code does not return anymore 10 even though I set in my code that W5 must take only the value from F5.</p>\n\n<p>The main point is that I want to prevent the users to change the values in column W5:W100, as those values must be only the values taken from column F5:F100.</p>\n\n<blockquote>\n<pre><code>Dim cellbc As Range\n         Application.EnableEvents = False\n            For Each cellbc In Target\n             If Application.Intersect(cellbc, Range(\"f5:f100\")).Copy Then\n                Application.Intersect(cellbc, Range(\"W5:W100\")).Paste\n             End If\n       Next cellbc\n         Application.EnableEvents = True\n</code></pre>\n</blockquote>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1513795602, "post_id": 47912381, "comment_id": 82792679, "body": "I think, you need to create an array of arrays. Say, <code>Dim arrRows(1 To 10, 1 To 2): arrRows(1,1) = &quot;C21&quot;: arrRows(1,2) = Array(22, 23)</code>. Then, you can loop through this array: <code>For x = LBound(arr,1) To UBound(arr,1): Rows(arr(x,2)).Hidden = (Cells(arr(x,1)) = &quot;Yes&quot;): Next</code>"}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1513795164, "creation_date": 1513795164, "answer_id": 47912432, "question_id": 47912381, "link": "https://stackoverflow.com/questions/47912381/vba-trigger-hidden-rows-based-on-yes-no-responses-to-questions/47912432#47912432", "title": "VBA: Trigger hidden rows based on yes/no responses to questions", "body": "<p>I think you might just want to use <code>OFFSET()</code>:</p>\n\n<pre><code>For Each cell In Worksheets(\"CAP - Assessment\").Range(\"C21:C32\")\n    If cell.Value = \"Yes\" Then\n       'code here to show additional rows\n        cell.Offset(1,0).EntireRow.Hidden = False\n        cell.Offset(2,0).EntireRow.Hidden = False\n    End If\nNext cell\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 4678354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e17f1778399e1b137f54392b11ba08?s=128&d=identicon&r=PG&f=1", "display_name": "yjgzepeda", "link": "https://stackoverflow.com/users/4678354/yjgzepeda"}, "edited": false, "score": 0, "creation_date": 1513871932, "post_id": 47912614, "comment_id": 82825534, "body": "This was perfect, clean code and very efficient. Thank you!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1513795952, "creation_date": 1513795952, "answer_id": 47912614, "question_id": 47912381, "link": "https://stackoverflow.com/questions/47912381/vba-trigger-hidden-rows-based-on-yes-no-responses-to-questions/47912614#47912614", "title": "VBA: Trigger hidden rows based on yes/no responses to questions", "body": "<p>Here's one idea: give your \"controller\" cells a name such as (eg) \"YES_10_11\".\nIn the change event check to see if the Target range has a name, then parse out the comparison value and the rows to show/hide and apply the test.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim arr, rName, i, doHide As Boolean\n    If Target.Cells.CountLarge &gt; 1 Then Exit Sub\n\n    On Error Resume Next\n    rName = Target.Name.Name  ' e.g. YES_10_11\n    On Error GoTo 0\n\n    If Len(rName) &gt; 0 Then\n        arr = Split(rName, \"_\")\n        doHide = (UCase(arr(0)) &lt;&gt; UCase(Target.Value))\n        For i = 1 To UBound(arr)\n            Me.Rows(arr(i)).Hidden = doHide\n        Next i\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>If your nesting goes deep though you might want to consider using a hidden sheet to store all of the relationships and loop over the whole thing for each change.</p>\n"}], "owner": {"reputation": 5, "user_id": 4678354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e17f1778399e1b137f54392b11ba08?s=128&d=identicon&r=PG&f=1", "display_name": "yjgzepeda", "link": "https://stackoverflow.com/users/4678354/yjgzepeda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 355, "favorite_count": 0, "accepted_answer_id": 47912614, "answer_count": 2, "score": 0, "last_activity_date": 1513795952, "creation_date": 1513794905, "last_edit_date": 1513795379, "question_id": 47912381, "link": "https://stackoverflow.com/questions/47912381/vba-trigger-hidden-rows-based-on-yes-no-responses-to-questions", "title": "VBA: Trigger hidden rows based on yes/no responses to questions", "body": "<p>I'm using excel to create a questionnaire, I need to program this questionnaire in a way that if a person answers Yes on a certain question it triggers sub-questions. These sub-questions are hidden rows and should appear only if the user answers Yes in that particular case. I have a solution but a very tedious one that requires programming every single cell</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Address = \"$C$10\" Then\n    If Target.Value &lt;&gt; \"Yes\" Then Rows(\"5\").EntireRow.Hidden = True\n    If Target.Value = \"Yes\" Then Rows(\"5\").EntireRow.Hidden = False\nEnd If\n</code></pre>\n\n<p>I was hoping to use a for loop to loop through each section and if the answer is Yes trigger rows to appear with the code below</p>\n\n<pre><code>For Each cell In Worksheets(\"Sheet\").Range(\"C21:C32\")\n    If cell.Value = \"Yes\" Then\n       'code here to show additional rows\n        Rows(\"22\").EntireRow.Hidden = False\n        Rows(\"23\").EntireRow.Hidden = False\n    End If\nNext cell\n</code></pre>\n\n<p>My problem with this is different \"Yes\" responses need to trigger different rows, For example if row 9 is a \"Yes\" trigger rows 10 and 11 and after this if 10 is yes trigger another row of sub-questions. I can easily use the Worksheet_Change method just modify it for every cel but this is very tedious. Is there any way I can do this in a for loop to make the code cleaner? I am eventually going to pass this on to another person to work on and I want to make sure I leave them the most efficient way of doing this.</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 4, "creation_date": 1513794675, "post_id": 47912255, "comment_id": 82792252, "body": "Why not use a filter?  You could try recording a macro while you apply that filter, and that will get you most of the way there."}, {"owner": {"reputation": 1767, "user_id": 4075085, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/cdd3817d549a4f941e1de54c640ffb49?s=128&d=identicon&r=PG&f=1", "display_name": "JJFord3", "link": "https://stackoverflow.com/users/4075085/jjford3"}, "edited": false, "score": 1, "creation_date": 1513795007, "post_id": 47912255, "comment_id": 82792411, "body": "Stack Overflow is here to help find coding solutions. To get responses, post attempts you have made. You need to do the heavy lifting yourself."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9124033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06996d0ba76c8e635e8a88bdf973659c?s=128&d=identicon&r=PG&f=1", "display_name": "Cameron Snell", "link": "https://stackoverflow.com/users/9124033/cameron-snell"}, "edited": false, "score": 0, "creation_date": 1513798249, "post_id": 47912385, "comment_id": 82793963, "body": "Thank you so much QHarr and pokemon_Man! Really appreciate the coding! Was hoping for a macro that was buttonless but this will do just fine :-)"}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "reply_to_user": {"reputation": 1, "user_id": 9124033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06996d0ba76c8e635e8a88bdf973659c?s=128&d=identicon&r=PG&f=1", "display_name": "Cameron Snell", "link": "https://stackoverflow.com/users/9124033/cameron-snell"}, "edited": false, "score": 0, "creation_date": 1513798493, "post_id": 47912385, "comment_id": 82794071, "body": "please select this answer if it solved your question. thank you."}], "tags": [], "owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "is_accepted": false, "score": 0, "last_activity_date": 1513794943, "creation_date": 1513794943, "answer_id": 47912385, "question_id": 47912255, "link": "https://stackoverflow.com/questions/47912255/how-to-automatically-hide-rows-in-excel/47912385#47912385", "title": "How to automatically hide rows in excel", "body": "<p>Put this on a activeX button event. If F18 to F46 is 0, it hides, if not, it shows.</p>\n\n<pre><code>Sub button_click()\n    Dim i as integer\n    For i = 18 to 46\n        If Activesheet.Range(\"F\" &amp; i) = 0 Then\n            Activesheet.Range(\"F\" &amp; i).entireRow.Hidden = True\n        else\n            Activesheet.Range(\"F\" &amp; i).entireRow.Hidden = False\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1513795389, "creation_date": 1513795389, "answer_id": 47912468, "question_id": 47912255, "link": "https://stackoverflow.com/questions/47912255/how-to-automatically-hide-rows-in-excel/47912468#47912468", "title": "How to automatically hide rows in excel", "body": "<p>An efficient way is to use <code>Union</code> to gather all the rows to hide and then hide all in one go. Also, this code checks the values are actually numeric in cells.</p>\n\n<p>You can tie this to a <a href=\"https://support.office.com/en-us/article/Assign-a-macro-to-a-Form-or-a-Control-button-d58edd7d-cb04-4964-bead-9c72c843a283\" rel=\"nofollow noreferrer\">form</a> control or <a href=\"https://www.mrexcel.com/forum/excel-questions/75065-assigning-macro-activex-command-button.html\" rel=\"nofollow noreferrer\">ActiveX</a> button as mentioned in prior answer. </p>\n\n<pre><code>Sub hideRows()\n\n\nDim wb As Workbook\nDim wsSource As Worksheet\n\nSet wb = ThisWorkbook\nSet wsSource = wb.Worksheets(\"Sheet7\")\n\nDim loopRange As Range\nDim currRow As Range\nDim hideRange As Range\n\nSet loopRange = wsSource.Range(\"F18:F46\")\nloopRange.EntireRow.Hidden = False\n\nFor Each currRow In loopRange.Rows\n\n    If IsNumeric(currRow.Value2) And currRow.Value2 = 0 Then\n\n        If Not hideRange Is Nothing Then\n            Set hideRange = Union(currRow, hideRange)\n        Else\n           Set hideRange = currRow\n        End If\n\n    End If\n\nNext currRow\n\nIf Not hideRange Is Nothing Then hideRange.EntireRow.Hidden = True\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 1, "last_activity_date": 1513803179, "last_edit_date": 1513803179, "creation_date": 1513802589, "answer_id": 47914092, "question_id": 47912255, "link": "https://stackoverflow.com/questions/47912255/how-to-automatically-hide-rows-in-excel/47914092#47914092", "title": "How to automatically hide rows in excel", "body": "<p>How about this...</p>\n\n<pre><code>Sub HideRowsLoop()\n    For Each cell In Worksheets(\"Pulse Template\").Range(\"C18:C46\")\n        If cell.Value = \"0\" Then\n            cell.EntireRow.Hidden = True\n        End If\n    Next cell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9124033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06996d0ba76c8e635e8a88bdf973659c?s=128&d=identicon&r=PG&f=1", "display_name": "Cameron Snell", "link": "https://stackoverflow.com/users/9124033/cameron-snell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4005, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1513803179, "creation_date": 1513794441, "last_edit_date": 1513794728, "question_id": 47912255, "link": "https://stackoverflow.com/questions/47912255/how-to-automatically-hide-rows-in-excel", "title": "How to automatically hide rows in excel", "body": "<p>I have an attendance tracker that I use to send out an end of shift report. Currently, my entire class's attendance show. I'd like to make a macro that hides rows with 0 time missed.</p>\n\n<p>Blank Tracker 2.0 is the name of the book\nPulse Template is the name of the worksheet I need the macro for\nF is the column in which I record time missed (drawn from another sheet)\n18-46 are the rows that need to be either hidden or unhidden.</p>\n\n<p>So if F18 is 0, I need it to be hidden. If F18 > 0, I need it visible.</p>\n\n<p>I figure this is a fairly simply macro but I have essentially no experience with macros whatsoever.</p>\n"}, {"tags": ["vba", "for-loop", "dropdown", "auto-update"], "owner": {"reputation": 440, "user_id": 4966912, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/99f1f7d24541b652f0e6909192fd5b6c?s=128&d=identicon&r=PG&f=1", "display_name": "Saud ", "link": "https://stackoverflow.com/users/4966912/saud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1513792823, "creation_date": 1513792823, "question_id": 47911867, "link": "https://stackoverflow.com/questions/47911867/autoupdate-specific-cell-not-entire-column-range-vba", "title": "Autoupdate specific cell, not entire column/range - VBA", "body": "<p><strong>Goal</strong></p>\n\n<p>I would like the <strong>Autoopdate code</strong> and <strong>Code</strong> only to take the specific changes into account and not update entire column. </p>\n\n<p><strong>Description and Problem</strong></p>\n\n<p>Column C contains 4 different values (Type1, Type2, Type3, Type4). Whenever a user chooses a type the type (in the form of an array) is outputted in column D for that specific row. A user can then manually change the type by in column D afterwards.</p>\n\n<p>If a user then chooses a value in column C, all the cells in column D will autoupdate and populate with the original values. I don't want this. Only the specific row should autoupdate the type in column D.</p>\n\n<p>Is that possible?</p>\n\n<p><strong>Autoopdate code</strong></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)        \n    If Target.Column = 3 Then\n        Call AutoDropdown\n    End If\nEnd Sub\n</code></pre>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Sub AutoDropdown()\n\nDim PersonSource As Range\nDim PersonSourceTotal As Range\nDim PersonCell As Range\nDim i As Long\nDim lastRow As Long\nDim SelectionArray(1 To 4) As String\nDim ws As Worksheet\n\narr1 = Array(\"A\", \"B\", \"C\", \"D\")\narr2 = Array(\"E\", \"F\", \"G\", \"H\")\narr3 = Array(\"I\", \"J\", \"K\", \"L\")\narr4 = Array(\"M\", \"N\", \"O\", \"P\")\n\nSelectionArray(1) = Join(arr1, \"--\")\nSelectionArray(2) = Join(arr2, \"--\")\nSelectionArray(3) = Join(arr3, \"--\")\nSelectionArray(4) = Join(arr4, \"--\")\nAllSelections = Join(SelectionArray, \",\") 'group all selections for data validation\nOn Error Resume Next\n\nFor Each ws In ThisWorkbook.Worksheets\n\n    If ws.Name = \"sheet1\" Or ws.Name = \"sheet2\" Or ws.Name = \"sheet3\" Then\n\n        Set PersonSourceTotal = ws.Range(\"D2:D200\")\n\n        With PersonSourceTotal.Offset(0, -2)\n            lastRow = .Cells(.Rows.Count, PersonSourceTotal.Columns.Count).End(xlUp).Row\n        End With\n\n        Set PersonSource = ws.Range(\"D2:D\" &amp; lastRow)\n\n        For Each PersonCell In PersonSource\n            Debug.Print (PersonCell)\n            varname = PersonCell.Offset(0, -3)\n            Debug.Print (varname)\n            ID = PersonCell.Offset(0, -2)\n                If varname &lt;&gt; \"\" And ID &lt;&gt; \"\" Then\n                    Select Case PersonCell.Offset(i, -1).Value\n                        Case \"Type1\"\n                            With PersonCell.Validation\n                            Debug.Print (PersonCell)\n                                .Delete\n                                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:=AllSelections\n                            End With\n                            PersonCell.Value = SelectionArray(1)\n                        Case \"Type2\"\n                            With PersonCell.Validation\n                                .Delete\n                                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:=AllSelections\n                            End With\n                            PersonCell.Value = SelectionArray(2)\n                        Case \"Type3\"\n                            With PersonCell.Validation\n                                .Delete\n                                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:=AllSelections\n                            End With\n                            PersonCell.Value = SelectionArray(3)\n                        Case \"Type4\"\n                        With PersonCell.Validation\n                                .Delete\n                                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:=AllSelections\n                            End With\n                            PersonCell.Value = SelectionArray(4)\n                        Case Else\n                            MsgBox \"No Type was entered on Column C\"\n                    End Select\n                'Else\n                '   MsgBox \"Remember to add VarName and ID\"\n                End If\n        Next PersonCell\n    End If\nNext ws\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1513792276, "post_id": 47911565, "comment_id": 82791088, "body": "FWIW there is nothing wrong with <code>cell</code>, <code>row</code>, <code>column</code>, etc.; VBA does not use them at all. VBA isn&#39;t the Excel object model, and the Excel object model isn&#39;t VBA. Besides there&#39;s no <code>Row</code> or <code>Column</code> or <code>Cell</code> global-scope object in the Excel object model. So the worst it can do is make <code>Range.Row</code> appear as <code>Range.row</code>, which has no impact whatsoever. <code>row</code> and <code>column</code> (and <code>cell</code>) are perfectly fine local variable names, and they&#39;re not shadowing anything. The unqualified <code>Cells</code> and <code>Range</code> calls are much more dangerous of a habit to have."}, {"owner": {"reputation": 67, "user_id": 7751739, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5d6ec14b5d93f3602100466b0b486e58?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Lenertz", "link": "https://stackoverflow.com/users/7751739/jacob-lenertz"}, "edited": false, "score": 0, "creation_date": 1513792329, "post_id": 47911565, "comment_id": 82791111, "body": "Well i am going to be using the selection to know the start column and end column as well as knowing the row. So then i can construct a Sign Page On the Pages i need to. And that selection will be used as the base point to build off."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 67, "user_id": 7751739, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5d6ec14b5d93f3602100466b0b486e58?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Lenertz", "link": "https://stackoverflow.com/users/7751739/jacob-lenertz"}, "edited": false, "score": 2, "creation_date": 1513792514, "post_id": 47911565, "comment_id": 82791204, "body": "@JacobLenertz I expect this code to throw an error if the <code>Selection</code> isn&#39;t at least 6 columns wide."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513792743, "post_id": 47911565, "comment_id": 82791335, "body": "@Mat&#39;sMug - true, but <code>Range.row</code> is a perfectly good reason not to use it. The OCD inside me is rebelling. But concerning <code>VBA</code> and <code>Excel Object Module</code> you are right, it is better to be edited."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1513792879, "post_id": 47911565, "comment_id": 82791411, "body": "@Vityata FWIW every single <code>Property Let</code> and <code>Property Set</code> procedure I write takes a <code>ByVal value As Whatever</code> parameter. I&#39;ve gotten used to see <code>Range.Value</code> as <code>Range.value</code>, and live a happy life ;-)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513793261, "post_id": 47911565, "comment_id": 82791586, "body": "@Mat&#39;sMug - with <code>.Value</code> and <code>.value</code> I can live as well. But <code>.row</code> is too much for me. And I am not the only one - <a href=\"https://stackoverflow.com/questions/27570703/why-row-changes-to-row-in-excel-vba\" title=\"why row changes to row in excel vba\">stackoverflow.com/questions/27570703/&hellip;</a>"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 2, "last_activity_date": 1513793078, "last_edit_date": 1513793078, "creation_date": 1513791539, "answer_id": 47911565, "question_id": 47911543, "link": "https://stackoverflow.com/questions/47911543/excel-selecting-a-row/47911565#47911565", "title": "Excel Selecting a Row", "body": "<p>The point is that you should refer to the first column of Basepoint and take its column. This could be achieved, if you amend your line like to this:</p>\n\n<pre><code>Range(Cells(row,BasePoint.Columns(1).Column),Cells(row,BasePoint.Columns(6).Column)).Merge\n</code></pre>\n\n<p>As an advice:</p>\n\n<ul>\n<li><p>do not use names like <code>row</code>, <code>column</code>, <code>Cells</code>, <code>Range</code> etc. as a variable, the Excel object module library inside <code>VBA</code> uses them as well. In your case, you have <code>BasePoint.row</code>. If you did not have the variable <code>row</code>, then the VBEditor would have written <code>BasePoint.Row</code> automatically.</p></li>\n<li><p>try to avoid <code>Selection</code>, although it depends on the context - <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a></p></li>\n<li><p>as @Mat's Mug mentioned in the comments, it is a good habit to show the \"parent\" of <code>Cells</code> and <code>Ranges</code>, when you are using them.\nThus in your case, something like this:</p></li>\n</ul>\n\n<hr>\n\n<pre><code>With Worksheets(1)\n       .Range(.Cells(row, BP.Columns(1).Column), .Cells(row, BP.Columns(6).Column)).Merge\nEnd With\n</code></pre>\n\n<p>Then it would always refer to the first worksheet (or whichever you need to) and not to the <code>ActiveSheet</code>, which would be referred, if the <code>Parent</code> in not mentioned. (I have written <code>BP</code> instead of <code>BasePoint</code> to make sure it goes on one line.)</p>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513792557, "post_id": 47911664, "comment_id": 82791235, "body": "This should be the accepted answer. Only missing a type check on <code>Selection</code>, and perhaps a cast to <code>Range</code> to get IntelliSense, but this won&#39;t throw any error if the selection isn&#39;t at least 6 columns wide."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1513793079, "post_id": 47911664, "comment_id": 82791510, "body": "@Mat&#39;sMug Yes, the <code>Selection</code> can span several cells, so I edited answer :)"}], "tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": false, "score": 3, "last_activity_date": 1513793066, "last_edit_date": 1513793066, "creation_date": 1513791926, "answer_id": 47911664, "question_id": 47911543, "link": "https://stackoverflow.com/questions/47911543/excel-selecting-a-row/47911664#47911664", "title": "Excel Selecting a Row", "body": "<p>This should be enough:</p>\n\n<pre><code>Selection(1).Resize(, 6).Merge\n</code></pre>\n\n<p>Explanation: <code>Selection</code> can span several cells, so <code>Selection(1)</code> takes the top left cell - thus, we always refer to one cell.</p>\n"}], "owner": {"reputation": 67, "user_id": 7751739, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5d6ec14b5d93f3602100466b0b486e58?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Lenertz", "link": "https://stackoverflow.com/users/7751739/jacob-lenertz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 47911565, "answer_count": 2, "score": 1, "last_activity_date": 1513794170, "creation_date": 1513791447, "last_edit_date": 1513794170, "question_id": 47911543, "link": "https://stackoverflow.com/questions/47911543/excel-selecting-a-row", "title": "Excel Selecting a Row", "body": "<p>I am Trying to create a macro that will take the 1st Cell of a selection and merge it with the 6th Cell. I am getting error 400.</p>\n\n<pre><code>Sub SignPage()\nDim ws As Worksheet, BasePoint As Range, row As Long, singlecell As Long, \nsingleCol As Long, sLong As Long, sShort As String\nSet BasePoint = Selection\nrow = BasePoint.row\nRange(Cells(row, BasePoint.Columns(1)), Cells(row, BasePoint.Columns(6))).Merge\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1513791182, "post_id": 47911404, "comment_id": 82790505, "body": "FWIW these indicate misplaced page breaks, giving the user a clue that printing the document as-is will likely not print as expected. Consider properly configuring the worksheet&#39;s <code>PageSetup</code> instead."}, {"owner": {"reputation": 217, "user_id": 5493940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IcJ0n.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/5493940/jackson"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513794164, "post_id": 47911404, "comment_id": 82792003, "body": "I think the <code>PageSetup</code> section of the sheet that doesn&#39;t show the lines is the reason why. Do you know what I can specify there for it have the effect of removing the dotted lines? I agree that sounds like the better solution. I&#39;ll add the snippet of code from the sheet that doesn&#39;t show them, maybe you can highlight why?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1513794268, "post_id": 47911404, "comment_id": 82792063, "body": "If a sheet was never viewed in PageBreakPreview mode, the lines won&#39;t appear. Configuring the <code>PageSetup</code> to &quot;scale to fit&quot; to 1 page wide by 1 page high will effectively move the dotted lines to where they don&#39;t matter."}, {"owner": {"reputation": 217, "user_id": 5493940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IcJ0n.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/5493940/jackson"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513794657, "post_id": 47911404, "comment_id": 82792245, "body": "Thanks. I&#39;ll look into the &quot;scale to fit&quot; property, do you see something different in the code snippet I just added that might be taking care of it instead?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513795963, "post_id": 47911404, "comment_id": 82792842, "body": "Ugh. PageBreaks API is borked."}, {"owner": {"reputation": 217, "user_id": 5493940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IcJ0n.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/5493940/jackson"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513796026, "post_id": 47911404, "comment_id": 82792868, "body": "Haha as I&#39;m learning..."}, {"owner": {"reputation": 217, "user_id": 5493940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IcJ0n.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/5493940/jackson"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513796387, "post_id": 47911404, "comment_id": 82793048, "body": "tbh those dotted lines are looking nicer and nicer"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1513796513, "post_id": 47911404, "comment_id": 82793114, "body": "Try toggling PageBreakPreview mode on <i>before</i> you configure <code>PageSetup</code> (and then toggle it back off afterwards)"}, {"owner": {"reputation": 217, "user_id": 5493940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IcJ0n.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/5493940/jackson"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513797174, "post_id": 47911404, "comment_id": 82793438, "body": "Good thought, thanks, sadly still no luck. I&#39;m going to try copying in the PageSetup from the other sheet and see what that does."}, {"owner": {"reputation": 217, "user_id": 5493940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IcJ0n.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/5493940/jackson"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513797698, "post_id": 47911404, "comment_id": 82793684, "body": "That didn&#39;t cut it either. So there&#39;s something else conflicting with it. This is the only module referencing anything to do with formatting the worksheet, so it must be in this module somewhere. I&#39;ll keep working at it and post back if I come up with the answer. Let me know if you think of anything else. Thanks for the brainstorming"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513797796, "post_id": 47911404, "comment_id": 82793736, "body": "If the sheet isn&#39;t created by a macro, then you could setup its page breaks manually, save, and never think about it ever again :)"}, {"owner": {"reputation": 217, "user_id": 5493940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IcJ0n.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/5493940/jackson"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513798030, "post_id": 47911404, "comment_id": 82793846, "body": "Yes... But alas, it is, and needs to be. Such is life. It&#39;s ok. Dotted lines don&#39;t take away from the data. Being a formatting guy, they&#39;re just bugging the heck out of me!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1513798108, "post_id": 47911404, "comment_id": 82793887, "body": "I&#39;m out of ideas :("}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 8678155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7b10fa22cf05e11616d4e4e5b6a4b81?s=128&d=identicon&r=PG", "display_name": "jknight", "link": "https://stackoverflow.com/users/8678155/jknight"}, "edited": false, "score": 1, "creation_date": 1513791797, "post_id": 47911418, "comment_id": 82790805, "body": "The sheet in question would have to be activated or selected first since Jackson is using the sheet name to navigate between sheets.  Jackson:  I tried your code in Excel 2007 and it worked for me.  I don&#39;t think the problem is in that particular line of code."}, {"owner": {"reputation": 217, "user_id": 5493940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IcJ0n.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/5493940/jackson"}, "edited": false, "score": 0, "creation_date": 1513794235, "post_id": 47911418, "comment_id": 82792040, "body": "@Vityata &quot;In the immediate window&quot; You mean on the sheet? This all has to happen via VBA code. Maybe I&#39;m misunderstanding you?"}, {"owner": {"reputation": 217, "user_id": 5493940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IcJ0n.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/5493940/jackson"}, "reply_to_user": {"reputation": 91, "user_id": 8678155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7b10fa22cf05e11616d4e4e5b6a4b81?s=128&d=identicon&r=PG", "display_name": "jknight", "link": "https://stackoverflow.com/users/8678155/jknight"}, "edited": false, "score": 0, "creation_date": 1513794313, "post_id": 47911418, "comment_id": 82792078, "body": "@jknight I think Mat&#39;s Mug up above has the right idea, fix it the right way in PageSetup"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 217, "user_id": 5493940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IcJ0n.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/5493940/jackson"}, "edited": false, "score": 1, "creation_date": 1513795228, "post_id": 47911418, "comment_id": 82792504, "body": "@Jackson - press Ctrl + G ti open the immedite window and write it there"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 217, "user_id": 5493940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IcJ0n.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/5493940/jackson"}, "edited": false, "score": 0, "creation_date": 1513795527, "post_id": 47911418, "comment_id": 82792640, "body": "Or simpy write - <code>ActiveSheet.DisplayPageBreaks = False</code> in VBA, @Jackson"}, {"owner": {"reputation": 217, "user_id": 5493940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IcJ0n.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/5493940/jackson"}, "edited": false, "score": 0, "creation_date": 1513795598, "post_id": 47911418, "comment_id": 82792677, "body": "Thanks for clarifying. Entering that code in the immediate window only removes them after it&#39;s already run. If I rerun they are back again."}, {"owner": {"reputation": 217, "user_id": 5493940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IcJ0n.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/5493940/jackson"}, "edited": false, "score": 1, "creation_date": 1513795644, "post_id": 47911418, "comment_id": 82792699, "body": "<code>ActiveSheet.DisplayPageBreaks = False</code> is what I originally tried, which is not working. Evidently it should be working if it works in the immediate window. Why wouldn&#39;t it be working when run from the code?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 217, "user_id": 5493940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IcJ0n.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/5493940/jackson"}, "edited": false, "score": 1, "creation_date": 1513795810, "post_id": 47911418, "comment_id": 82792771, "body": "@Jackson - it should be working, did you write it as a last line?"}, {"owner": {"reputation": 217, "user_id": 5493940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IcJ0n.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/5493940/jackson"}, "edited": false, "score": 0, "creation_date": 1513795895, "post_id": 47911418, "comment_id": 82792808, "body": "No, I can try it as the last line. Edited my question RE your suggestions btw"}, {"owner": {"reputation": 217, "user_id": 5493940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IcJ0n.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/5493940/jackson"}, "edited": false, "score": 0, "creation_date": 1513796156, "post_id": 47911418, "comment_id": 82792929, "body": "Did not work on the last line. See additional edit. Tried both <code>ActiveSheet</code> and specifying sheet name."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1513802624, "last_edit_date": 1513802624, "creation_date": 1513790882, "answer_id": 47911418, "question_id": 47911404, "link": "https://stackoverflow.com/questions/47911404/in-excel-vba-how-do-you-remove-grey-page-break-lines/47911418#47911418", "title": "In Excel VBA, how do you remove grey page break lines?", "body": "<p>Write the following in the immediate window and press <kbd>Enter</kbd>:</p>\n\n<pre><code>ActiveSheet.DisplayPageBreaks = Not ActiveSheet.DisplayPageBreaks\n</code></pre>\n\n<p>Or simply write Or simpy write - <code>ActiveSheet.DisplayPageBreaks = False</code> in VBA, at the end of your code.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-displaypagebreaks-property-excel\" rel=\"nofollow noreferrer\">Worksheet.DisplayPageBreaks Property (Excel)</a></p>\n"}, {"comments": [{"owner": {"reputation": 217, "user_id": 5493940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IcJ0n.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/5493940/jackson"}, "edited": false, "score": 0, "creation_date": 1513794946, "post_id": 47912341, "comment_id": 82792390, "body": "No dice, my friend :("}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 217, "user_id": 5493940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IcJ0n.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/5493940/jackson"}, "edited": false, "score": 0, "creation_date": 1513795101, "post_id": 47912341, "comment_id": 82792461, "body": "@Jackson that&#39;s rather surprising. Stupid question: is the right sheet active when the code runs? Also, note that the dotted lines will not go away - but this code should move all implict page breaks to the edges of the print area."}, {"owner": {"reputation": 217, "user_id": 5493940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IcJ0n.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/5493940/jackson"}, "edited": false, "score": 0, "creation_date": 1513795400, "post_id": 47912341, "comment_id": 82792586, "body": "The right sheet is active, see the new edit above, the landscape setting in the same section works. And the lines are still in the same place, in the middle of the spreadsheet. I&#39;m trying to avoid a dynamic print area, but I suppose that&#39;s an option."}, {"owner": {"reputation": 217, "user_id": 5493940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IcJ0n.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/5493940/jackson"}, "edited": false, "score": 0, "creation_date": 1513795434, "post_id": 47912341, "comment_id": 82792599, "body": "Side note, this sheet won&#39;t really ever be printed, so it doesn&#39;t matter if they are moved or simply invisible."}, {"owner": {"reputation": 217, "user_id": 5493940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IcJ0n.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/5493940/jackson"}, "edited": false, "score": 1, "creation_date": 1514392131, "post_id": 47912341, "comment_id": 82959024, "body": "Hey I got it! We need a <code>Zoom = False</code> line also. See the &#39;Solution&#39; section in my question. I&#39;ve accepted your answer, please add this missing piece to it! Thanks again for all the help."}, {"owner": {"reputation": 217, "user_id": 5493940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IcJ0n.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/5493940/jackson"}, "edited": false, "score": 0, "creation_date": 1514404698, "post_id": 47912341, "comment_id": 82964136, "body": "Zoom is in PageSetup also"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 4, "last_activity_date": 1514409961, "last_edit_date": 1514409961, "creation_date": 1513794762, "answer_id": 47912341, "question_id": 47911404, "link": "https://stackoverflow.com/questions/47911404/in-excel-vba-how-do-you-remove-grey-page-break-lines/47912341#47912341", "title": "In Excel VBA, how do you remove grey page break lines?", "body": "<p>Try removing any <code>Zoom</code>, and then scaling the <code>PageSetup</code> to fit a single page:</p>\n\n<pre><code>ActiveSheet.PageSetup.Zoom = False\nActiveSheet.PageSetup.FitToPagesTall = 1\nActiveSheet.PageSetup.FitToPagesWide = 1\n</code></pre>\n\n<p>That should get the dotted lines out of the way.</p>\n"}, {"comments": [{"owner": {"reputation": 217, "user_id": 5493940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IcJ0n.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/5493940/jackson"}, "edited": false, "score": 0, "creation_date": 1513859271, "post_id": 47913711, "comment_id": 82817487, "body": "Specifying one page wide/tall did not move the page break lines. When using the same <code>.PageSetup</code> as on a different spreadsheet (different SQL portion), one shows the page breaks and one does not."}, {"owner": {"reputation": 217, "user_id": 5493940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IcJ0n.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/5493940/jackson"}, "edited": false, "score": 0, "creation_date": 1513859404, "post_id": 47913711, "comment_id": 82817556, "body": "Moreover, saving and reopening doesn&#39;t solve it. This is a macro generated sheet that is regenerated by a user each time the data is needed. I understand that on a normal spreadsheet I can simply turn them off in the settings, save and reopen. Wish that were an option. As stated above, this has to come from the code, not from actions within the GUI."}], "tags": [], "owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "is_accepted": false, "score": 2, "last_activity_date": 1513800784, "creation_date": 1513800784, "answer_id": 47913711, "question_id": 47911404, "link": "https://stackoverflow.com/questions/47911404/in-excel-vba-how-do-you-remove-grey-page-break-lines/47913711#47913711", "title": "In Excel VBA, how do you remove grey page break lines?", "body": "<p>The dotted lines are simply showing where the page will break. Has nothing to do with inserted page breaks. So removing page breaks doesn't do anything. The page will still break somewhere unless you specify one page wide/tall per Mats Mug.</p>\n\n<p>If you don't want to see the dotted lines, just save, close and reopen. The lines are gone. Of course they will reappear when you preview or print. </p>\n\n<p>It's a feature, not a flaw.</p>\n"}], "owner": {"reputation": 217, "user_id": 5493940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IcJ0n.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/5493940/jackson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1325, "favorite_count": 0, "accepted_answer_id": 47912341, "answer_count": 3, "score": 2, "last_activity_date": 1514409961, "creation_date": 1513790815, "last_edit_date": 1514392073, "question_id": 47911404, "link": "https://stackoverflow.com/questions/47911404/in-excel-vba-how-do-you-remove-grey-page-break-lines", "title": "In Excel VBA, how do you remove grey page break lines?", "body": "<p><strong>Question:</strong> </p>\n\n<p>How do you remove grey dotted line page breaks (not the blue ones) from an Excel sheet using VBA code?</p>\n\n<p><strong>Background:</strong> </p>\n\n<p>We have a collection of ODBC spreadsheets generated via VBA. When running two different (though similar) spreadsheets on my local box without manually changing any options in Excel, one shows dotted grey lines on the page breaks <em>(see image below)</em> and one does not. Both are large enough to extend past one page. I have not been able to find a difference in the code that gives reason to this.</p>\n\n<p>Most of the advice on the internet points toward the options in Excel via the GUI, which is not an option. I am seeking a VBA solution.</p>\n\n<p><strong>What I've tried:</strong></p>\n\n<p>I've tried several different variations and applications of <code>DisplayPageBreaks = False</code>. Either I'm using it incorrectly, or it is not the correct setting. My most reasonable use of this property has been:</p>\n\n<p><code>ActiveWorkbook.Worksheets(str_Worksheet_Name).DisplayPageBreaks = False</code></p>\n\n<p>Note that the variable <code>str_Worksheet_Name</code> works in many other lines in the code, example: <code>ActiveWorkbook.Worksheets(str_Worksheet_Name).Cells(1, 1).Select</code> correctly selects cell <code>A1</code> on the desired worksheet.</p>\n\n<p><strong>Reference Image:</strong></p>\n\n<p>These are the lines I am trying to remove:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5JofT.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5JofT.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Thanks in advance.</p>\n\n<hr>\n\n<p><strong>Additional Info:</strong></p>\n\n<ul>\n<li>RE Mat's Mug's comment:</li>\n</ul>\n\n<p>It sounds like something in this code snippet is preventing them from showing up on this spreadsheet. Note that this snippet is from the sheet that correctly <strong>does not</strong> show the page breaks:</p>\n\n<pre><code>Public Function cmlapi_Set_To_Landscape()\n\nOn Error Resume Next\nActiveSheet.PageSetup.PrintArea = \"\"\nWith ActiveSheet.PageSetup\n    .LeftHeader = \"\"\n    .CenterHeader = \"\"\n    .RightHeader = \"\"\n    .LeftFooter = \"\"\n    .CenterFooter = \"\"\n    .RightFooter = \"\"\n    .LeftMargin = Application.InchesToPoints(0.75)\n    .RightMargin = Application.InchesToPoints(0.75)\n    .TopMargin = Application.InchesToPoints(1)\n    .BottomMargin = Application.InchesToPoints(1)\n    .HeaderMargin = Application.InchesToPoints(0.5)\n    .FooterMargin = Application.InchesToPoints(0.5)\n    .PrintHeadings = False\n    .PrintGridlines = False\n    .PrintComments = xlPrintNoComments\n    .CenterHorizontally = False\n    .CenterVertically = False\n    .Orientation = xlLandscape\n    .Draft = False\n    .PaperSize = xlPaperLetter\n    .FirstPageNumber = xlAutomatic\n    .Order = xlDownThenOver\n    .BlackAndWhite = False\n    .Zoom = 100\nEnd With\nIf glob_Header_On_Every_Page = True Then\n    With ActiveSheet.PageSetup\n        .PrintTitleRows = \"$1:$\" &amp; HEADER_OFFSET\n    End With\nEnd If\nActiveWindow.ScrollColumn = 2\nActiveWindow.ScrollColumn = 1\n\nEnd Function\n</code></pre>\n\n<ul>\n<li><p>Per answer from Mat's Mug:</p>\n\n<pre><code>With ActiveSheet.PageSetup\n    .Orientation = xlLandscape\n    .FitToPagesTall = 1\n    .FitToPagesWide = 1\nEnd With\n</code></pre></li>\n</ul>\n\n<p>No luck with this. The lines are still there. Note that the <code>.Orientation = xlLandscape</code> did work, so there shouldn't be a concern of where this is specified in the code.</p>\n\n<ul>\n<li>Per answer from Vidyata:</li>\n</ul>\n\n<p><code>ActiveSheet.DisplayPageBreaks</code> works in the immediate window (Ctrl + G) for the spreadsheet after it has been run. Rerunning puts the dotted lines back again. Oddly using this same property in the code doesn't seem to have an effect, but clearly is the correct code. Perhaps there's a specific place it needs to be? I would have thought as long as I either use <code>ActiveSheet</code> when the correct sheet is selected or specified my sheet name it shouldn't really matter.</p>\n\n<p>It was further suggested that I try it on the last line. Good idea, but didn't work out either. Tried both of these on the last line in two separate trials:</p>\n\n<p><code>ActiveWorkbook.Worksheets(str_Worksheet_Name).DisplayPageBreaks = False</code>\n<code>ActiveSheet.DisplayPageBreaks = False</code></p>\n\n<ul>\n<li>I tried using the PageSetup code above. That didn't do it either.</li>\n</ul>\n\n<hr>\n\n<p><strong>Solution:</strong> See Mat's Mug's answer. <code>FitToPagesTall = 1</code> and <code>FitToPagesWide = 1</code> worked after also setting <code>Zoom = False</code>.  I'll shamefully admit I'm rather surprised I didn't find this earlier as it is exactly stated as such on Microsoft's Dev Network site:</p>\n\n<p>Link: <a href=\"https://msdn.microsoft.com/en-us/VBA/Excel-VBA/articles/pagesetup-fittopageswide-property-excel\" rel=\"nofollow noreferrer\">MSDN Info</a></p>\n\n<p>Code:</p>\n\n<pre><code> .Zoom = False \n .FitToPagesTall = 1 \n .FitToPagesWide = 1\n</code></pre>\n\n<p>Not sure why the <code>Zoom</code> line is needed, but that was the missing piece.</p>\n\n<p>Thanks to all who helped!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9123769, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A8Ttk7IaPYc/AAAAAAAAAAI/AAAAAAAAAZM/ScH1u2X8TaY/photo.jpg?sz=128", "display_name": "Riley Taylor", "link": "https://stackoverflow.com/users/9123769/riley-taylor"}, "edited": false, "score": 1, "creation_date": 1513790894, "post_id": 47911389, "comment_id": 82790358, "body": "I just rewrote with that and it seems to be running! Thanks! Any idea why this error would only pop up some of the time?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 13, "user_id": 9123769, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A8Ttk7IaPYc/AAAAAAAAAAI/AAAAAAAAAZM/ScH1u2X8TaY/photo.jpg?sz=128", "display_name": "Riley Taylor", "link": "https://stackoverflow.com/users/9123769/riley-taylor"}, "edited": false, "score": 0, "creation_date": 1513790973, "post_id": 47911389, "comment_id": 82790405, "body": "@RileyTaylor - probably it pops up every time when you are trying to refer to an array element that does not exist."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 0, "last_activity_date": 1513790747, "creation_date": 1513790747, "answer_id": 47911389, "question_id": 47911338, "link": "https://stackoverflow.com/questions/47911338/excel-vba-2016-pastespecial-fails-but-not-all-the-time/47911389#47911389", "title": "Excel VBA 2016 - PasteSpecial fails, but not all the time", "body": "<p>Can you try to rewrite the code like this:</p>\n\n<pre><code>For i = 0 To 19\n    ActiveSheet.Pictures(MyPics(0, i+1)).Copy\n    Range(MergedAreas(i)).PasteSpecial\nNext i\n</code></pre>\n\n<p>And see whether it works every time?</p>\n\n<p>From the way you assign the <code>MyPics</code> Array here:</p>\n\n<pre><code>For j = i + 1 To UBound(MyPics, 2)\n</code></pre>\n\n<p>It seems that <code>j</code> cannot be <code>0</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 9123769, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A8Ttk7IaPYc/AAAAAAAAAAI/AAAAAAAAAZM/ScH1u2X8TaY/photo.jpg?sz=128", "display_name": "Riley Taylor", "link": "https://stackoverflow.com/users/9123769/riley-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 47911389, "answer_count": 1, "score": 1, "last_activity_date": 1513791682, "creation_date": 1513790546, "last_edit_date": 1531161705, "question_id": 47911338, "link": "https://stackoverflow.com/questions/47911338/excel-vba-2016-pastespecial-fails-but-not-all-the-time", "title": "Excel VBA 2016 - PasteSpecial fails, but not all the time", "body": "<p>I've copied and pasted macros to generate an array of random pictures from a column, but I don't understand them enough to debug them. I am getting a run-time error on the <em>Range(MergedAreas(i)).PasteSpecial</em> line, but only some of the time. </p>\n\n<p>I'm creating an Excel version of a game called Codenames: Pictures. Here's the <a href=\"https://drive.google.com/open?id=11LayCb84I9w-6FUeGwZ0DQvVzzj2_1v0\" rel=\"nofollow noreferrer\">file</a> if you want to try it out!</p>\n\n<pre><code>Sub DisplayRandomPics()\n\nDim MergedAreas As Variant\nDim MyPics() As String\nDim PicsLoc As String\nDim Temp1 As String\nDim Temp2 As String\nDim Pic As Picture\nDim Cnt As Long\nDim i As Long\nDim j As Long\n\nPicsLoc = \"A7:A284\"  'Change the location of the pictures, accordingly\n\nMergedAreas = Array(\"C2:C2\", \"C3:C3\", \"C4:C4\", \"C5:C5\", \"D2:D2\", \"D3:D3\", \"D4:D4\", \"D5:D5\", \"E2:E2\", \"E3:E3\", \"E4:E4\", \"E5:E5\", \"F2:F2\", \"F3:F3\", \"F4:F4\", \"F5:F5\", \"G2:G2\", \"G3:G3\", \"G4:G4\", \"G5:G5\")\n\nCnt = 0\nRandomize\nFor Each Pic In ActiveSheet.Pictures\n    If Union(Pic.TopLeftCell, Range(PicsLoc)).Address = Range(PicsLoc).Address Then\n        ReDim Preserve MyPics(0 To 1, 0 To Cnt)\n        MyPics(0, Cnt) = Pic.Name\n        MyPics(1, Cnt) = Rnd\n        Cnt = Cnt + 1\n    End If\nNext Pic\n\nIf Cnt &lt; 3 Then\n    MsgBox \"The range \" &amp; PicsLoc &amp; \" must contain at least 3 pictures...\", vbExclamation\n    Exit Sub\nEnd If\n\nApplication.ScreenUpdating = False\n\nCall DeleteRandomPics\n\nFor i = 0 To UBound(MyPics, 2) - 1\n    For j = i + 1 To UBound(MyPics, 2)\n        If MyPics(1, i) &gt; MyPics(1, j) Then\n            Temp1 = MyPics(0, j)\n            Temp2 = MyPics(1, j)\n            MyPics(0, j) = MyPics(0, i)\n            MyPics(1, j) = MyPics(1, i)\n            MyPics(0, i) = Temp1\n            MyPics(1, i) = Temp2\n        End If\n    Next j\nNext i\n\nFor i = 0 To 19\n    ActiveSheet.Pictures(MyPics(0, i)).Copy\n    Range(MergedAreas(i)).PasteSpecial\nNext i\n\nRange(\"A1\").Select\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n\nSub DeleteRandomPics()\n\nDim Pic As Picture\n\nFor Each Pic In ActiveSheet.Pictures\n    If Union(Pic.TopLeftCell, Range(\"A173:O173\")).Address = Range(\"A173:O173\").Address Then\n        Pic.Delete\n    End If\nNext Pic\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 591, "user_id": 6392779, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9759523b8fac6c36e2cb1213e8482fb9?s=128&d=identicon&r=PG&f=1", "display_name": "nick", "link": "https://stackoverflow.com/users/6392779/nick"}, "edited": false, "score": 0, "creation_date": 1513790542, "post_id": 47911236, "comment_id": 82790174, "body": "I don&#39;t want to change anything, I am only looking to update a value based on another column. I even have the sql code for it and of course doesn&#39;t work as expected. such a pita."}, {"owner": {"reputation": 172, "user_id": 6241837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PsE2v.jpg?s=128&g=1", "display_name": "Benjamin Racette", "link": "https://stackoverflow.com/users/6241837/benjamin-racette"}, "reply_to_user": {"reputation": 591, "user_id": 6392779, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9759523b8fac6c36e2cb1213e8482fb9?s=128&d=identicon&r=PG&f=1", "display_name": "nick", "link": "https://stackoverflow.com/users/6392779/nick"}, "edited": false, "score": 1, "creation_date": 1513790583, "post_id": 47911236, "comment_id": 82790198, "body": "Im writing this from memory, but it has to be something like the following:   Dim RS as DAO.recorset SET RS = DAO.openRecordSet(&quot;your_table_name_here&quot;) Do While !rs.EOF \tif RS.fields(&quot;col1&quot;) = true AND RS.fields(&quot;col2&quot;) = true Then \t\tRS.fields(&quot;col3&quot;) = true \tEnd if  Loop RS.update RS.close"}], "tags": [], "owner": {"reputation": 172, "user_id": 6241837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PsE2v.jpg?s=128&g=1", "display_name": "Benjamin Racette", "link": "https://stackoverflow.com/users/6241837/benjamin-racette"}, "is_accepted": false, "score": 1, "last_activity_date": 1513790210, "creation_date": 1513790210, "answer_id": 47911236, "question_id": 47911079, "link": "https://stackoverflow.com/questions/47911079/ms-access-check-column-value-and-change-another/47911236#47911236", "title": "MS access check column value and change another", "body": "<p>Here is what I would do: </p>\n\n<p>1- Create a form and add at least one command button on it. Name it cmdMyButton or cmdAnythingThatYouWant (cmd is the prefix used in examples from Microsoft for command buttons)</p>\n\n<p>2- in the design view, double click the command button so to pop the code window</p>\n\n<p>3- In the onClick() function, write the code that opens up a recordset for your table, loop through records and for each row, verify the value of those 2 columns and update if needed. (look at the documentation for DAO.recordset)</p>\n"}, {"tags": [], "owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "is_accepted": false, "score": 1, "last_activity_date": 1513792914, "creation_date": 1513792914, "answer_id": 47911888, "question_id": 47911079, "link": "https://stackoverflow.com/questions/47911079/ms-access-check-column-value-and-change-another/47911888#47911888", "title": "MS access check column value and change another", "body": "<p>Let's say you have an Access table named <code>Table1</code>, with some Access fields:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Kyiy3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Kyiy3.png\" alt=\"Table1 in Table Designer, with three Yes/No fields\"></a></p>\n\n<p>The following Access SQL statement will update the value of <code>col3</code> based on the values of <code>col1</code> and <code>col2</code>, for every row in <code>Table1</code>:</p>\n\n<pre><code>UPDATE Table1\nSET col3 = NOT col1 AND NOT col2\n</code></pre>\n\n<p>There are a number of ways to leverage this SQL statement:</p>\n\n<ul>\n<li><p>You can paste it into the Query Designer in SQL view, and execute it via the Access UI</p></li>\n<li><p>You can run it as part of an Access macro</p></li>\n<li><p>You can execute it in VBA, using ADO or DAO</p></li>\n<li><p>You can execute it in VBA, using the <code>DoCmd.RunSQL</code> method</p></li>\n<li><p>Instead of VBA, you can use another Automation-supporting programming language</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 244, "user_id": 7936123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf162f9353483edfa62c3443929f733?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/7936123/chris"}, "is_accepted": false, "score": 0, "last_activity_date": 1513796337, "creation_date": 1513796337, "answer_id": 47912711, "question_id": 47911079, "link": "https://stackoverflow.com/questions/47911079/ms-access-check-column-value-and-change-another/47912711#47912711", "title": "MS access check column value and change another", "body": "<p>I would just create this on a calculated column in your DB table. See screen shot below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/rCVXg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rCVXg.png\" alt=\"enter image description here\"></a></p>\n\n<p>Notice in the properties I set a formula to acquire the desired results based on the first 2 columns. The \"Result type\" is set to yes/no to mimic the yes/no field. Only difference is, the third column will display a -1 (True) or 0 (False). but when displaying this information on a form, you can have it display the information in a checkbox fashion. The calculated field is also ideal cause it will only update the third column when the target record is updated, not updating the whole table, very useful if the table size starts holding over 100k records. </p>\n\n<p>If you want a VBA code, then you will need a trigger. I'm assuming its a button on the form, if not, you can always change the below code to match the event you want it triggered on. The below code is also a module that can be called/used for any trigger. The code is also assuming you have a primary key. </p>\n\n<pre><code>Public Sub UpdateThirdColumn(ByVal RecordPK As String) 'RecordPK is a passed variable\n                                                       'that is the primary key identifier to find the\n                                                       'record in the table\n'Set variavble name for SQL statement, gives you one place to update instead of hunting through code\nDim strSQL                          As String\n\n'Creates the SQL string in the variable assigned\nstrSQL = \"UPDATE {YourTableNameHere} \" &amp; _\n         \"SET {YourThirdFieldNAmeHere} = True \" &amp; _\n         \"WHERE ((({YourFirstFieldNAmeHere}) = True AND ({YourSecondFieldNAmeHere}) = True AND ({YourPrimaryKeyFieldHere}) ='\" &amp; RecordPK &amp; \"'));\"\n'Executes the SQL statement, dbFailOnError will fail if problem exists in SQL statement\nCurrentDb.Execute strSQL, dbFailOnError\nEnd Sub\n\n'Use this code if you have a button to trigger event\nPrivate Sub YourButton_Click()\nCall UpdateThirdColumn(Me.YourPrimaryKeyControlName)\nEnd Sub\n\n'Use the bottom 2 codes if you want the update for each check box to be checked and update\nPrivate Sub FirstFieldName_AfterUpdate()\nCall UpdateThirdColumn(Me.YourPrimaryKeyControlName)\nEnd Sub\n\nPrivate Sub SecondFieldName_AfterUpdate()\nCall UpdateThirdColumn(Me.YourPrimaryKeyControlName)\nEnd Sub\n</code></pre>\n\n<p>Let me know if you need more assistance or explanation and I will be glad to help.</p>\n"}], "owner": {"reputation": 591, "user_id": 6392779, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9759523b8fac6c36e2cb1213e8482fb9?s=128&d=identicon&r=PG&f=1", "display_name": "nick", "link": "https://stackoverflow.com/users/6392779/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1819, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1513796337, "creation_date": 1513789556, "last_edit_date": 1513789663, "question_id": 47911079, "link": "https://stackoverflow.com/questions/47911079/ms-access-check-column-value-and-change-another", "title": "MS access check column value and change another", "body": "<p>I have an ms access database with some yes/no columns I want to check and set the value of a third. The statement should be something like the following</p>\n\n<pre><code>if !col1 &amp;&amp; !col2:\n         col3 = no\nelse:\n    col3= yes\n</code></pre>\n\n<p>I keep searching but don't really understand vba and can't find what I need .. Mostly a segment of an answer to something else that I cant make work. Currently trying to create it in the \"module\" section is that even right? Would be best if this could be done automatically as those columns are changed or maybe run once and do all rows. Please help me get on the right track, any help greatly appreciated. </p>\n"}, {"tags": ["vba", "list", "replace", "lookup"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513789927, "post_id": 47911069, "comment_id": 82789847, "body": "Presumably you want the replacement to be the name that occurs the most times?"}, {"owner": {"reputation": 1, "user_id": 9123786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71c561ae512907610226904c138f3ea7?s=128&d=identicon&r=PG&f=1", "display_name": "dcarter", "link": "https://stackoverflow.com/users/9123786/dcarter"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513790050, "post_id": 47911069, "comment_id": 82789918, "body": "Yes, if a name appears more than once, I want to replace with that name (and clear all other duplicates and unique names). So for company 1, I would want to clear all cells and have &quot;Jon&quot; appear alone. In cases where all are unique (like in company 3), I want to leave all unique names and not replace them."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1513794294, "last_edit_date": 1513794294, "creation_date": 1513790171, "answer_id": 47911225, "question_id": 47911069, "link": "https://stackoverflow.com/questions/47911069/replace-a-range-of-cells-with-one-value-if-that-value-appears-more-than-once-in/47911225#47911225", "title": "Replace a range of cells with one value if that value appears more than once in the range", "body": "<p>Here is a way using a dictionary (requires you to add a reference to microsoft scripting runtime via the tools > references , in the VBE.)</p>\n\n<pre><code>Sub test()\n\nDim wb As Workbook\nDim wsSource As Worksheet\n\nSet wb = ThisWorkbook\nSet wsSource = wb.Worksheets(\"Sheet6\")\n\nDim loopRange As Range\nDim currRow As Range\n\nSet loopRange = wsSource.Range(\"B2:F6\")\n\nFor Each currRow In loopRange.Rows\n\n    If Application.WorksheetFunction.CountA(currRow) &gt; 1 Then\n\n        If FindFrequency(currRow)(1) &gt; 1 Then\n\n            With wsSource\n                .Cells(currRow.Row, 2) = FindFrequency(currRow)(0)\n                .Range(.Cells(currRow.Row, 3), .Cells(currRow.Row, 6)).ClearContents\n            End With\n        End If\n\n    End If\n\nNext currRow\n\nEnd Sub\n\nFunction FindFrequency(currRow As Range) As Variant 'Adapted from here https://www.extendoffice.com/documents/excel/1581-excel-find-most-common-value.html#a2\n\nDim rng As Range\nDim dic As Object 'late binding\nDim xMax As Long\nDim xOutValue As String\nDim xValue As String\nDim xCount As Long\n\nSet dic = CreateObject(\"scripting.dictionary\")\n\nOn Error Resume Next\n\nxMax = 0\nxOutValue = \"\"\n\nFor Each rng In currRow.Columns\n\n    xValue = rng.Text\n\n    If xValue &lt;&gt; \"\" Then\n\n        dic(xValue) = dic(xValue) + 1\n        xCount = dic(xValue)\n\n        If xCount &gt; xMax Then\n            xMax = xCount\n            xOutValue = xValue\n        End If\n\n    End If\n\nNext rng\n\nFindFrequency = Array(xOutValue, xMax)\n\nSet dic = Nothing\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 0, "last_activity_date": 1513793239, "creation_date": 1513793239, "answer_id": 47911969, "question_id": 47911069, "link": "https://stackoverflow.com/questions/47911069/replace-a-range-of-cells-with-one-value-if-that-value-appears-more-than-once-in/47911969#47911969", "title": "Replace a range of cells with one value if that value appears more than once in the range", "body": "<p>Using the worksheet function <code>CountIf</code> we can determine which contact to use as follows:    </p>\n\n<pre><code>Option Explicit\nSub GetContactName()\nDim i As Long, j As Long, sht As Worksheet, lastrow As Long, tempvalue As String\n\nSet sht = ThisWorkbook.ActiveSheet\nlastrow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\n\nFor i = 2 To lastrow\n    For j = 2 To 6\n        If Application.WorksheetFunction.CountIf(Range(Cells(i, 2), Cells(i, 6)), Cells(i, j)) &gt; 1 Then\n            tempvalue = Cells(i, j)\n            Range(Cells(i, 2), Cells(i, 6)).ClearContents\n            Cells(i, 2) = tempvalue\n        End If\n    Next j\nNext i\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/TkEOt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TkEOt.png\" alt=\"enter image description here\"></a><a href=\"https://i.stack.imgur.com/t1mYl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/t1mYl.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 9123786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71c561ae512907610226904c138f3ea7?s=128&d=identicon&r=PG&f=1", "display_name": "dcarter", "link": "https://stackoverflow.com/users/9123786/dcarter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1513794294, "creation_date": 1513789522, "last_edit_date": 1513794137, "question_id": 47911069, "link": "https://stackoverflow.com/questions/47911069/replace-a-range-of-cells-with-one-value-if-that-value-appears-more-than-once-in", "title": "Replace a range of cells with one value if that value appears more than once in the range", "body": "<pre><code>Company Contact Contact Contact Contact Contact\nCompany 1   Jon James   Jon Jon Mark\nCompany 2   Mark    Eric    Jon Eric    \nCompany 3   Jon Mark    Eric        \nCompany 4   Jon             \nCompany 5   Mark    Eric    James   James   \n</code></pre>\n\n<p>I have a list of unique values in column A (company names). I then I have horizontal lists of contacts.</p>\n\n<p>I want to look up the range of cells ( for company 1 it would be B1:E1), and if a name appears more than once (ex. for company 1, Jon) I wanted to replace B1 with Jon and clear all other cells. If no name appears more than once, I want to leave all the values the same.           </p>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9095468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1fb323d264232792b0ba5571cce4d86?s=128&d=identicon&r=PG&f=1", "display_name": "Wombat", "link": "https://stackoverflow.com/users/9095468/wombat"}, "edited": false, "score": 0, "creation_date": 1513813121, "post_id": 47914825, "comment_id": 82799780, "body": "This gives me a compile error: &quot;Method or data member not found.&quot; with the second &quot;.Timing&quot; highlighted as the error. (Which is weird... if anything, I&#39;d expect the first instance of &quot;.Timing&quot; to produce the error)."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "reply_to_user": {"reputation": 11, "user_id": 9095468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1fb323d264232792b0ba5571cce4d86?s=128&d=identicon&r=PG&f=1", "display_name": "Wombat", "link": "https://stackoverflow.com/users/9095468/wombat"}, "edited": false, "score": 0, "creation_date": 1513867510, "post_id": 47914825, "comment_id": 82822782, "body": "Since sngDel is a constant, could you try to replace it with 0.1 in the code?"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1513874226, "post_id": 47914825, "comment_id": 82826870, "body": "Shape objects have no .Timing property, which is what the error message is trying to tell you.  I&#39;d imagine that the error occurs on the second instance of .Timing because you&#39;re asking it to read that property&#39;s value before applying it in the first instance."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1513875435, "post_id": 47914825, "comment_id": 82827469, "body": "While I don&#39;t know much about animation in PPT, could you explain this from the Microsoft support site.   &quot;You can apply multiple animation effects to a single string of text or an object, such as a picture, shape, or SmartArt graphic.&quot;"}, {"owner": {"reputation": 11, "user_id": 9095468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1fb323d264232792b0ba5571cce4d86?s=128&d=identicon&r=PG&f=1", "display_name": "Wombat", "link": "https://stackoverflow.com/users/9095468/wombat"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1513940062, "post_id": 47914825, "comment_id": 82849734, "body": "It doesn&#39;t work with 0.1 either. @Steve Rindsberg: if Shape objects don&#39;t have a .Timing property, does this mean this won&#39;t be possible at all?"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1513960540, "post_id": 47914825, "comment_id": 82858945, "body": "I don&#39;t know that it won&#39;t be possible, but not exactly in this way.  Have a look at Shyam Pillai&#39;s VBA tips, scroll down to the one that starts out with &quot;Timeline&quot; ... that may help.  <a href=\"http://www.skphub.com/vba.htm#.Wj0z0XlOnGg\" rel=\"nofollow noreferrer\">skphub.com/vba.htm#.Wj0z0XlOnGg</a>"}], "tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": false, "score": 0, "last_activity_date": 1513806528, "creation_date": 1513806528, "answer_id": 47914825, "question_id": 47910809, "link": "https://stackoverflow.com/questions/47910809/how-can-i-apply-a-powerpoint-vba-script-to-a-selection-of-shapes/47914825#47914825", "title": "How can I apply a PowerPoint VBA script to a selection of shapes?", "body": "<p>Try using the selection.shaperange, it should loop through each shape that is selected.</p>\n\n<pre><code>For Each Shp In Selection.ShapeRange\n With Shp\n            .Timing.TriggerDelayTime = .Timing.TriggerDelayTime + sngDel\n        End With\nNext\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9095468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1fb323d264232792b0ba5571cce4d86?s=128&d=identicon&r=PG&f=1", "display_name": "Wombat", "link": "https://stackoverflow.com/users/9095468/wombat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 624, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1513806528, "creation_date": 1513788518, "question_id": 47910809, "link": "https://stackoverflow.com/questions/47910809/how-can-i-apply-a-powerpoint-vba-script-to-a-selection-of-shapes", "title": "How can I apply a PowerPoint VBA script to a selection of shapes?", "body": "<p>I'd like to select a number of shapes on a slide, to then run a macro on all selected shapes. For example: I'd like to increase the shapes' animation delay time by a given value.\nNote: Some shapes may have more than one animation.</p>\n\n<p>So far, I've got the following code. It does the trick, but it does it for all shapes on the current slide.</p>\n\n<pre><code>Sub ActiveSlideShapes_DelayInc()\n    Dim osld   As Slide\n    Dim i      As Long\n    Dim a      As Integer\n    Dim oeff   As Effect\n    Const sngDel As Single = 0.1\n\n    Set osld = ActiveWindow.Selection.SlideRange(1)\n\n    For i = osld.TimeLine.MainSequence.Count To 1 Step -1\n        Set oeff = osld.TimeLine.MainSequence(i)\n        With oeff\n            .Timing.TriggerDelayTime = .Timing.TriggerDelayTime + sngDel\n        End With\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Another solution could be to select the actual TimeLine elements instead of shapes. And then do a \"For...Next\" loop only on those selected animations. This would be the more elegant solution for when certain shapes have several different animations attached to them. Is this possible to do?</p>\n"}, {"tags": ["vba", "excel", "outlook", "mailitem"], "comments": [{"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1513789523, "post_id": 47910758, "comment_id": 82789643, "body": "I cannot reproduce your error.  Does your inbox contain any items without a sender?  It&#39;s possible to store files, notes and drafts in any mailbox."}, {"owner": {"reputation": 21, "user_id": 9123668, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sTmPB2JHPrI/AAAAAAAAAAI/AAAAAAAAAKk/5TQb6umOcoM/photo.jpg?sz=128", "display_name": "Aerospacecrab", "link": "https://stackoverflow.com/users/9123668/aerospacecrab"}, "edited": false, "score": 0, "creation_date": 1513801277, "post_id": 47910758, "comment_id": 82795295, "body": "I can confirm that the mailbox only contains emails which have been received in and all have senders."}, {"owner": {"reputation": 21, "user_id": 9123668, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sTmPB2JHPrI/AAAAAAAAAAI/AAAAAAAAAKk/5TQb6umOcoM/photo.jpg?sz=128", "display_name": "Aerospacecrab", "link": "https://stackoverflow.com/users/9123668/aerospacecrab"}, "edited": false, "score": 0, "creation_date": 1513801509, "post_id": 47910758, "comment_id": 82795406, "body": "if the code works ok for you destination-data then do you think that the problem is with the Excel setup on my machine? E.g. what libraries i have enabled etc?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1513804621, "post_id": 47910758, "comment_id": 82796852, "body": "Does this happen only for a particular message? Does it happen after you process a large (100+) number items?"}, {"owner": {"reputation": 21, "user_id": 9123668, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sTmPB2JHPrI/AAAAAAAAAAI/AAAAAAAAAKk/5TQb6umOcoM/photo.jpg?sz=128", "display_name": "Aerospacecrab", "link": "https://stackoverflow.com/users/9123668/aerospacecrab"}, "edited": false, "score": 0, "creation_date": 1513818323, "post_id": 47910758, "comment_id": 82801043, "body": "No this happens for every message and they&#39;re only kb&#39;s in size with no attachments. If i remove/comment out the erroring line of code then the rest works fine at it sucessfully pulls out the subject lines and recieved dates and times."}], "owner": {"reputation": 21, "user_id": 9123668, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sTmPB2JHPrI/AAAAAAAAAAI/AAAAAAAAAKk/5TQb6umOcoM/photo.jpg?sz=128", "display_name": "Aerospacecrab", "link": "https://stackoverflow.com/users/9123668/aerospacecrab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 526, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1513860188, "creation_date": 1513788306, "last_edit_date": 1513860188, "question_id": 47910758, "link": "https://stackoverflow.com/questions/47910758/outlook-mailitem-sender-generates-error-287-in-excel", "title": "Outlook mailitem.sender generates error 287 in Excel", "body": "<p>I am trying to pull details of Outlook mail items in a shared mailbox.</p>\n\n<p>To make it easier for colleagues I created the macro in Excel.</p>\n\n<p>It is falling down at:</p>\n\n<pre><code>sender = olItem.sender\n</code></pre>\n\n<p>In Outlook VBA it pulls through the name of the sender of the email.</p>\n\n<p>In Excel it causes a </p>\n\n<blockquote>\n  <p>Runtime Error 287 Application-Defined or User-Defined error</p>\n</blockquote>\n\n<p>This happens for every message. If I remove/comment out the erroring line of code then it successfully pulls out the subject lines and received dates and times.</p>\n\n<pre><code>Sub GetEmailData()\n\nDim olApp As Outlook.Application\nDim NS As Outlook.Namespace\nDim Inbox As Outlook.MAPIFolder\nDim objOwner As Outlook.Recipient\nDim olItem As Outlook.MailItem\nDim subject As String\nDim sender As String\nDim senddate As String\nDim homebook As Workbook, homesheet As Worksheet\n\nSet homebook = Workbooks(\"Email Log.xlsm\")\nSet homesheet = homebook.Worksheets(\"Sheet1\")\n\n'Clear contents\nhomesheet.Range(\"A4:D100\").Delete\n\nSet olApp = Outlook.Application\n\nSet NS = olApp.GetNamespace(\"MAPI\")\nSet objOwner = NS.CreateRecipient(\"***email address of mailbox***\")\nSet Inbox = NS.GetSharedDefaultFolder(objOwner, olFolderInbox)\n\nn = 4\n\nFor Each olItem In Inbox.Items\n    subject = olItem.subject\n    sender = olItem.sender\n    senddate = olItem.ReceivedTime\n    homesheet.Range(\"B\" &amp; n).Value = subject\n    homesheet.Range(\"C\" &amp; n).Value = sender\n    homesheet.Range(\"A\" &amp; n).Value = senddate\n    n = n + 1\nNext\n\nhomesheet.Range(\"A1\").Value = \"Last Updated: \" &amp; Now()\nhomesheet.Range(\"A2\").Value = \"Number of Items: \" &amp; Inbox.Items.Count\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1513787226, "post_id": 47910454, "comment_id": 82788407, "body": "Wildcard matches using *?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1513787289, "post_id": 47910454, "comment_id": 82788439, "body": "Or google fuzzy lookups. There is a microsoft fuzzy lookup add-in. No idea if any good."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1513787336, "post_id": 47910454, "comment_id": 82788466, "body": "Might imply that there is white space or hidden special characters - have you used len to check lengths of expected matches?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513787728, "post_id": 47910454, "comment_id": 82788697, "body": "If you know some of the edge cases can you implement some logic that checks for these and if present,for example, does a substitute to create two words etc. A sort of normalization if you will."}, {"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "edited": false, "score": 0, "creation_date": 1513792022, "post_id": 47910454, "comment_id": 82790942, "body": "I&#39;m going to echo fuzzy matching - <a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=15011\" rel=\"nofollow noreferrer\">microsoft.com/en-us/download/details.aspx?id=15011</a>"}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1513795838, "post_id": 47910454, "comment_id": 82792788, "body": "Have you tried the MATCH() function? can work well if you combine with INDEX().."}], "owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513787642, "creation_date": 1513787184, "last_edit_date": 1513787642, "question_id": 47910454, "link": "https://stackoverflow.com/questions/47910454/looking-up-similar-text-strings-in-excel", "title": "Looking up Similar Text Strings in Excel", "body": "<p>I am trying to do a vlookup from one sheet into another. But the data is not that perfect.  I need to be able to find extact matches , and if not found try look for very close matches . I have failed to find a way around this. I am open to vba code suggestions as well. </p>\n\n<pre><code>=IF(B2=\"AD Non Chargeable\",\"Internal\",VLOOKUP(B2&amp;\"*\",Sheet2!A:B,2,0))\n</code></pre>\n\n<p>The wildcard works to a certain extent but i am having issues where some string are one word instead of 2 words etc. </p>\n\n<p>Some text has S.\u00e0 .r.l. at the of end name so its not being picked up as well. NA</p>\n"}, {"tags": ["vba", "csv", "double-quotes"], "comments": [{"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1513790234, "post_id": 47910422, "comment_id": 82790021, "body": "Slight off-topic; in VBA you can use the <a href=\"https://msdn.microsoft.com/en-us/library/aa242706%28v=vs.60%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">FileSystemObject</a>.  It&#39;s easier and more powerful than the old <code>Open x For Input AS #1</code>.  Assuming you have a line that looks a little like this <code>Split(CurrentLine, &quot;,&quot;)</code> you could replace with: <code>Split(Replace(CurrentLine, &quot;&quot;&quot;&quot;, &quot;&quot;), &quot;,&quot;)</code>.  Watch out.  Quotes can be used to override commas.  In this example there are only two columns: <code>&quot;Column one, which contains a comma&quot;, &quot;Column two&quot;</code>."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1513825239, "post_id": 47910422, "comment_id": 82802560, "body": "do not forget, you have to escape double quotes ... <code>a = &quot;&quot;&quot;&quot;</code> and <code>b = &quot;&quot;&quot;&quot;&quot;&quot;</code> ... a is <code>&quot;</code> ... b is <code>&quot;&quot;</code>"}, {"owner": {"reputation": 889, "user_id": 4403269, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-hxdYtQPJ6Jw/AAAAAAAAAAI/AAAAAAAAABQ/SWZyxZzJ8K8/photo.jpg?sz=128", "display_name": "Sharunas Bielskis", "link": "https://stackoverflow.com/users/4403269/sharunas-bielskis"}, "edited": false, "score": 0, "creation_date": 1513838495, "post_id": 47910422, "comment_id": 82806142, "body": "According destination-data comment: In data which I load are lot of commas inside quotes. I overcome this problem with Regex.Pattern = &quot;&quot;&quot;[^&quot;&quot;]*&quot;&quot;|[^,]*&quot;  , because with split function I didn&#39;t find solution. Maybe for FileSystemObject is some parameters or in VBA library similarly as in .NET is something like TextFieldParser?"}], "answers": [{"comments": [{"owner": {"reputation": 889, "user_id": 4403269, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-hxdYtQPJ6Jw/AAAAAAAAAAI/AAAAAAAAABQ/SWZyxZzJ8K8/photo.jpg?sz=128", "display_name": "Sharunas Bielskis", "link": "https://stackoverflow.com/users/4403269/sharunas-bielskis"}, "edited": false, "score": 0, "creation_date": 1513837301, "post_id": 47911188, "comment_id": 82805722, "body": "I load data not from Excel sheet but from csv file directly into arrays through   code Open dataFilePath For Input As #1 and so on\u2026 . I don&#39;t want at this code block have nothing  related with Excel workbooks sheets, because it depending on user Excel settings can corrupt important data (can lost 0 from the begging of  string - example post codes, phone numbers, can lost some symbols)."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1513790037, "creation_date": 1513790037, "answer_id": 47911188, "question_id": 47910422, "link": "https://stackoverflow.com/questions/47910422/replace-2-double-quotes-into-1-double-quote-during-data-load-from-csv-file-in-vb/47911188#47911188", "title": "Replace 2 double quotes into 1 double quote during data load from csv file in VBA", "body": "<p>This double quotes are language specific. If these are the only characters that you would like to avoid and you do not have any other \"strange\" characters, then you can loop through the characters of your cells in Excel and check whether they are non-standard (e.g. not part of the first 128 ASCII chars):</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim stringToEdit    As String\n    Dim cnt             As Long\n    Dim myCell          As Range\n    Dim newWord         As String\n\n    For Each myCell In Range(\"A1:A2\")\n        newWord = vbNullString\n        For cnt = 1 To Len(myCell)\n            Debug.Print Asc(Mid(myCell, cnt, 1))\n            If Asc(Mid(myCell, cnt, 1)) &gt;= 127 Then\n                'do nothing\n            Else\n                newWord = newWord &amp; Mid(myCell, cnt, 1)\n            End If\n        Next cnt\n        myCell = newWord\n    Next myCell\n\nEnd Sub\n</code></pre>\n\n<p>Thus, imagine that you have input like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9L5oz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9L5oz.png\" alt=\"enter image description here\"></a></p>\n\n<p>It would realize, that the quotes are a bit strange and should not be included in the original text, because they are not part of the first 128 units in the ASCII table.</p>\n\n<p>After running the code you would get an empty cell and 75823.</p>\n"}], "owner": {"reputation": 889, "user_id": 4403269, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-hxdYtQPJ6Jw/AAAAAAAAAAI/AAAAAAAAABQ/SWZyxZzJ8K8/photo.jpg?sz=128", "display_name": "Sharunas Bielskis", "link": "https://stackoverflow.com/users/4403269/sharunas-bielskis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 388, "favorite_count": 0, "accepted_answer_id": 47911188, "answer_count": 1, "score": 0, "last_activity_date": 1513790037, "creation_date": 1513787055, "question_id": 47910422, "link": "https://stackoverflow.com/questions/47910422/replace-2-double-quotes-into-1-double-quote-during-data-load-from-csv-file-in-vb", "title": "Replace 2 double quotes into 1 double quote during data load from csv file in VBA", "body": "<p>I loaded line from csv file into array (Open dataFilePath For Input As #1 and so on\u2026). Loaded in array data are in 2 double quotes. Examples: \u201c\u201d\u201d\u201d (empty string) , \u201c\u201dmyText\u201d\u201d, \u201c\u201d75823\u201d\u201d. Problem is that later in the code program can\u2019t correctly detect empty array element or other data. I found method how to replace 2 double quotes in the beginning of string and at the end of the string into 1 double quote:</p>\n\n<pre><code>For i = 0 To lastArrayIndex\n    thisString = columnsDataInThisLine(i)\n    theFirstStringSymbol = Left(thisString, 1)\n    If theFirstStringSymbol = \"\"\"\" Then\n        'Replace double double quotes in the string beginning and _\n        'the end into single double quotes\n        thisString = Mid(thisString, 2, Len(thisString) - 2) \n    End If\n    columnsDataInThisLine(i) = thisString\nNext i\n</code></pre>\n\n<p>after this code I got what I need -  Examples: \u201c\u201d (empty string) , \u201cmyText\u201d, \u201c75823\u201d, but maybe I missed something during data load from csv file (encoding or something else). Maybe it is simpler way to remove this 2 double quotes at the beginning and at the end of loaded into array strings during csv file reading? </p>\n"}, {"tags": ["html", "vba", "excel", "dom", "web-scraping"], "comments": [{"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1513789479, "post_id": 47910269, "comment_id": 82789620, "body": "Hello and welcome to SO! We&#39;re here to help with already existing code (or attempted research), typically people won&#39;t create code for you, if you need some code written for you, you may want to check out some paid services. Please refer to <a href=\"https://stackoverflow.com/help/how-to-ask\">How-To-Ask</a>"}, {"owner": {"reputation": 53, "user_id": 9106239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8421cea6cd5901729e5e8f881697bfe?s=128&d=identicon&r=PG&f=1", "display_name": "prashant", "link": "https://stackoverflow.com/users/9106239/prashant"}, "reply_to_user": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1513867926, "post_id": 47910269, "comment_id": 82823074, "body": "@ Maldred. Thanks for your suggestion. I am sorry that I didn&#39;t include my code at that point of time. Now I have included the code I have created so far. I have also gone through various posts and try to solve this problem before posting this question. However I didn&#39;t get success."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1515080023, "post_id": 47910269, "comment_id": 83172053, "body": "Do you mean that you want to synthesize a click on &quot;Dental&quot;?  You want it to be as if the user had clicked on &quot;Dental&quot;?  Or do you mean that you want to know what item the user has already clicked on?  <b>Also</b>, what problem are you having with your existing code?  What happens when you run it?"}, {"owner": {"reputation": 53, "user_id": 9106239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8421cea6cd5901729e5e8f881697bfe?s=128&d=identicon&r=PG&f=1", "display_name": "prashant", "link": "https://stackoverflow.com/users/9106239/prashant"}, "reply_to_user": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1515082857, "post_id": 47910269, "comment_id": 83173760, "body": "@cxw I want it to be as if the user had clicked on &quot;Dental&quot;. When I run this code, nothing is happening and I am not getting error on VBE."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1515088388, "post_id": 47910269, "comment_id": 83176901, "body": "Thanks!  I have edited your question to include that information.  Allow me to suggest that you make such edits yourself in the future :) ."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1515090535, "post_id": 47910269, "comment_id": 83177994, "body": "I just saw your other question from last month.  It appears the code you are using above is modified from <a href=\"https://stackoverflow.com/a/47843890/2877364\">this answer</a>.  Is that correct?  If so, please <a href=\"https://stackoverflow.com/posts/47910269/edit\">edit your question</a> to link to that source.  That will help others find related information, and will show good faith.  Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1515089220, "post_id": 48101081, "comment_id": 83177344, "body": "@prashant Here&#39;s what I have.  Would you please read <a href=\"https://stackoverflow.com/help/mcve\">the MCVE page</a> if you haven&#39;t yet?  This will help you get more out of the site.  In this case, your question would have likely been better received if you had included the HTML and VBA of a complete, local testcase.  I had to recreate a testcase by hand-copying from the screenshot you gave, which most folks won&#39;t do (and I probably won&#39;t do again, now that you know what&#39;s up ;) ).  As always, happy hacking!"}, {"owner": {"reputation": 53, "user_id": 9106239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8421cea6cd5901729e5e8f881697bfe?s=128&d=identicon&r=PG&f=1", "display_name": "prashant", "link": "https://stackoverflow.com/users/9106239/prashant"}, "edited": false, "score": 0, "creation_date": 1515160427, "post_id": 48101081, "comment_id": 83205922, "body": "Thanks for your help. I tried your code. It&#39;s not working. I have attached another screenshot of drop down list. Your code is working fine for the right side drop down list. But not working for the left one."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "reply_to_user": {"reputation": 53, "user_id": 9106239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8421cea6cd5901729e5e8f881697bfe?s=128&d=identicon&r=PG&f=1", "display_name": "prashant", "link": "https://stackoverflow.com/users/9106239/prashant"}, "edited": false, "score": 0, "creation_date": 1515160887, "post_id": 48101081, "comment_id": 83206172, "body": "@prashant Glad to hear it&#39;s working for some things!  If it&#39;s working for <code>Dental</code> but not for <code>Ad Hoc Work Search</code>, would you please upvote+accept this answer and do some research?  Then, if you are still having problems with <code>Ad Hoc Work Search</code>, you can ask another question linking to this one.  Try the general techniques I have used and others have mentioned: make a local copy of the HTML file, strip it down to basics, then use the VBA debugger to step through your code.  While stepping, use the Immediate window and the Watch window to see what value your variables have.  Good luck!"}, {"owner": {"reputation": 53, "user_id": 9106239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8421cea6cd5901729e5e8f881697bfe?s=128&d=identicon&r=PG&f=1", "display_name": "prashant", "link": "https://stackoverflow.com/users/9106239/prashant"}, "edited": false, "score": 0, "creation_date": 1515161318, "post_id": 48101081, "comment_id": 83206421, "body": "@ cxw Actually it&#39;s vice versa. It&#39;s working for Adhoc not for Dental. I will try it on immediate window and if get success, let you know. Thanks again !!"}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "reply_to_user": {"reputation": 53, "user_id": 9106239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8421cea6cd5901729e5e8f881697bfe?s=128&d=identicon&r=PG&f=1", "display_name": "prashant", "link": "https://stackoverflow.com/users/9106239/prashant"}, "edited": false, "score": 0, "creation_date": 1515161856, "post_id": 48101081, "comment_id": 83206730, "body": "@prashant Interesting!  You&#39;re welcome!  Don&#39;t forget the Watch window - it will show you the type of a variable, and then you can check that type on MSDN or in the Object Browser."}], "tags": [], "owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "is_accepted": true, "score": 0, "last_activity_date": 1515089413, "last_edit_date": 1515089413, "creation_date": 1515089069, "answer_id": 48101081, "question_id": 47910269, "link": "https://stackoverflow.com/questions/47910269/how-to-select-an-specific-item-on-a-drop-down-list-on-aspx-site/48101081#48101081", "title": "How to select an specific item on a drop down list on ASPX site", "body": "<p>This particular web page isn't using <code>&lt;select&gt;</code> and <code>&lt;option&gt;</code>.  That suggests to me that they are using some custom JavaScript to simulate a drop-down list using the illustrated <code>&lt;div&gt;</code> and <code>&lt;span&gt;</code> elements.  In addition, they are using <code>onselect</code> rather than <code>onclick</code> to trigger event handlers.</p>\n\n<p>I can't replicate your test case.  However, I did make a test case of my own, and I think it works.  In short, replace <code>post.Click</code> with <code>post.onselect</code>.  The problem with your code was that it was trying to trigger an <code>onclick</code> handler that didn't exist on the target <code>&lt;span&gt;</code>!</p>\n\n<h3>HTML</h3>\n\n<pre><code>&lt;html&gt;\n    &lt;head&gt;\n    &lt;script type=\"text/javascript\"&gt;\n    function clk() { alert('Dental clicked'); }     // *** So I could see if Click had an effect\n    function sel() { alert('Dental selected'); }    // *** Simulate the given testcase\n    &lt;/script&gt;\n    &lt;/head&gt;\n&lt;body&gt;\n    &lt;div class=\"cboGroupGrid\"&gt;\n        &lt;span class=\"cboItem\" option=\"0\"&gt;&lt;/span&gt;\n        &lt;span class=\"cboItem\" option=\"1\" onselect=\"sel();\" onclick=\"clk();\"&gt;Dental&lt;/span&gt;\n        &lt;span class=\"cboItem\" option=\"2\"&gt;Health&lt;/span&gt;\n        &lt;span class=\"cboItem\" option=\"3\"&gt;Unknown Product&lt;/span&gt;\n    &lt;/div&gt;\n&lt;/body&gt;&lt;/html&gt;\n</code></pre>\n\n<h3>VBA</h3>\n\n<p>In the code below, <code>'''</code> are things I commented out because I didn't have them and they weren't essential to the task as I understand it.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub IE_Search_and_Extract()\n\n    Dim URL As String\n    Dim IE As SHDocVw.InternetExplorer\n    Dim HTMLdoc As HTMLDocument\n    Dim response As String\n    '''response = MsgBox(\"Login \", vbYesNo + vbQuestion, \"login\")\n    '''If response = vbYes Then\n    '''    URL = \" \"\n    '''Else\n    '''End If\n    URL = \"prashant.htm\"     ' ** Local testcase\n\n    '''Set IE = Get_IE_Window(URL)  ' ** I don't have the code for this function\n    '''If IE Is Nothing Then\n        Set IE = New SHDocVw.InternetExplorer\n    '''End If\n\n    With IE\n        '''SetForegroundWindow .Hwnd    ' ** I don't have this function\n        .navigate URL\n        .Visible = True\n        While .Busy Or .readyState &lt;&gt; READYSTATE_COMPLETE\n            DoEvents\n        Wend\n\n        '.document.getElementById(\"btnLogin\").Click\n\n'        While .Busy Or .readyState &lt;&gt; READYSTATE_COMPLETE\n'            DoEvents\n'        Wend\n        'Application.Wait (Now + TimeValue(\"0:00:5\"))\n        Set HTMLdoc = .document\n    End With\n\n    Dim post As Object, elem As Object\n    For Each post In HTMLdoc.getElementsByClassName(\"cboItem\")\n        If InStr(post.innerText, \"Dental\") &gt; 0 Then     ' ** Use a block If, not inline.\n            'post.Click    ' ** This does work, and triggers clk()\n            post.onselect  ' ** This triggers sel()\n            Exit For\n        End If\n    Next post\nEnd Sub\n</code></pre>\n\n<p>Style suggestion: If you have more than one thing in a <code>Then</code> or <code>Else</code> block, always use the multiline form.  That way there's no ambiguity about whether the <code>:</code> ends the <code>Then</code> block or not.</p>\n"}], "owner": {"reputation": 53, "user_id": 9106239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8421cea6cd5901729e5e8f881697bfe?s=128&d=identicon&r=PG&f=1", "display_name": "prashant", "link": "https://stackoverflow.com/users/9106239/prashant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 48101081, "answer_count": 1, "score": -3, "last_activity_date": 1516959332, "creation_date": 1513786521, "last_edit_date": 1516959332, "question_id": 47910269, "link": "https://stackoverflow.com/questions/47910269/how-to-select-an-specific-item-on-a-drop-down-list-on-aspx-site", "title": "How to select an specific item on a drop down list on ASPX site", "body": "<p>I want it to be as if the user had clicked on \"Dental.\" However, when I run the following code, nothing happens.\nI want it to be as if the user had clicked on \"Dental.\" However, when I run the following code, nothing happens.\nI want it to be as if the user had clicked on \"Dental.\"  However, when I run the following code, nothing happens.</p>\n\n<pre><code>'Public Sub IE_Search_and_Extract()  \n    'Dim URL As String\n    'Dim IE As SHDocVw.InternetExplorer\n    'Dim HTMLdoc As HTMLDocument\n    'Dim response As String\n    'response = MsgBox(\"Login \", vbYesNo + vbQuestion, \"login\")\n    'If response = vbYes Then\n     '   URL = \" \"\n    'Else\n    'End If\n\n    'Set IE = Get_IE_Window(URL)\n    'If IE Is Nothing Then\n     '   Set IE = New SHDocVw.InternetExplorer\n    'End If\n\n   ' With IE\n    '    SetForegroundWindow .hwnd\n     '   .navigate URL\n      '  .Visible = True\n       ' While .Busy Or .readyState &lt;&gt; READYSTATE_COMPLETE\n        '    DoEvents\n        'Wend\n\n      '  '.document.getElementById(\"btnLogin\").Click\n\n'      '  While .Busy Or .readyState &lt;&gt; READYSTATE_COMPLETE\n'            DoEvents\n'        Wend\n        Application.Wait (Now + TimeValue(\"0:00:5\"))\n        Set HTMLdoc = .document\n    End With\n\n    'Dim post As Object, elem As Object\n    'For Each post In HTMLdoc.getElementsByClassName(\"cboItem\")\n     '   If InStr(post.innerText, \"Dental\") &gt; 0 Then post.Click: Exit For\n    'Next post\n\n'End Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 3, "creation_date": 1513784447, "post_id": 47909660, "comment_id": 82786667, "body": "Use late bindings. If you want anything more specific than that, you need to share your code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9089107"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1513784786, "post_id": 47909660, "comment_id": 82786893, "body": "I edited the question to include the code"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1513785231, "post_id": 47909660, "comment_id": 82787213, "body": "Please include the code that depends on the Microsoft Word Object Library reference, not just random code."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9089107"}, "edited": false, "score": 0, "creation_date": 1513786327, "post_id": 47909888, "comment_id": 82787894, "body": "Thank you so much! You are a life saver!"}], "tags": [], "owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "is_accepted": true, "score": 0, "last_activity_date": 1513785915, "last_edit_date": 1513785915, "creation_date": 1513785154, "answer_id": 47909888, "question_id": 47909660, "link": "https://stackoverflow.com/questions/47909660/ms-access-vba-reference/47909888#47909888", "title": "MS Access VBA Reference", "body": "<p>Adding references to Word during development has the advantage to be able to use strongly typed word objects and thus being able to take advantage of IntelliSense. But these references are, as you have experienced, sensible to versioning. Therefore, I suggest you remove the reference to Word once development is achieved. You will also have to replace all Word-related types by <code>Object</code>, i.e. use late binding. This makes the application more robust with respect to versioning.</p>\n\n<p>You can get an existing Word instance which is already open or open a new one with this code snippet, without any references to Word DLLs.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function GetWordApplication() As Object\n    'Gets an active Word application or opens a new Word instance.\n    'Raises Error No. 8 if word cannot be opened.\n\n    On Error Resume Next\n    'Find existing instance of Word\n    Set GetWordApplication = GetObject(, \"Word.Application\")\n    If Err.Number &lt;&gt; 0 Then 'Not found, create new instance.\n        Set GetWordApplication = CreateObject(\"Word.Application\")\n    End If\n\n    'Following code is optional. You can instead test for Nothing at the call site\n    On Error Goto 0\n    If GetWordApplication Is Nothing Then\n        Err.Raise 8, \"YourApp.GetWordApplication\", \"Word could not be opened.\"\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9089107"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 310, "favorite_count": 0, "accepted_answer_id": 47909888, "answer_count": 1, "score": 0, "last_activity_date": 1513785915, "creation_date": 1513784413, "last_edit_date": 1513784769, "question_id": 47909660, "link": "https://stackoverflow.com/questions/47909660/ms-access-vba-reference", "title": "MS Access VBA Reference", "body": "<p>I have this database and it was working perfect, but today it started hating me. I started getting a Compile error: Can't find project or library. I looked around and found that when using the front end on a different computer, under VBA and references, it was missing a reference for Microsoft Word 15.0 Object Library.</p>\n\n<p>My computer I have the Microsoft Word 16.0 Object Library checked. How can I get this to work on other computers with 15.0 and 16.0?</p>\n\n<p>Here is the code</p>\n\n<pre><code>Private Sub cmd_LocateFile_Click()\nOn Error GoTo Error_Handler\nDim sFile As String\nDim sFolder As String\nDim ID As Long\nDim sTarget As String\n\n\n\nsFile = FSBrowse(\"\", msoFileDialogFilePicker, \"All Files (*.*),*.*\")\nIf sFile &lt;&gt; \"\" Then\n    sFolder = (\"\\\\aiowima23fp1\\Ecological Sciences and Engineering\\Cultural Resources\\New - Cultural Resources Request Database\") &amp; \"\\\" &amp; sAttachmentFolderName &amp; \"\\\"\n    If FolderExist(sFolder) = False Then MkDir (sFolder)\n    ID = RequestID_FK  ' Set current record id.\nsTarget = sFolder &amp; CStr(ID) &amp; \"-\" &amp; GetFileName(sFile)\nIf CopyFile(sFile, sFolder &amp; GetFileName(sTarget)) = True Then\n        Me!FullFileName.Value = sTarget\n    Else\n    End If\nEnd If\n\nError_Handler_Exit:\nOn Error Resume Next\nExit Sub\n\nError_Handler:\nMsgBox \"The following error has occured\" &amp; vbCrLf &amp; vbCrLf &amp; _\n       \"Error Number: \" &amp; Err.Number &amp; vbCrLf &amp; _\n       \"Error Source: \" &amp; sModName &amp; \"\\cmd_LocateFile_Click\" &amp; vbCrLf &amp; _\n       \"Error Description: \" &amp; Err.Description &amp; _\n       Switch(Erl = 0, \"\", Erl &lt;&gt; 0, vbCrLf &amp; \"Line No: \" &amp; Erl) _\n       , vbOKOnly + vbCritical, \"An Error has Occured!\"\nResume Error_Handler_Exit\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "range", "mapping"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1513785060, "post_id": 47909640, "comment_id": 82787085, "body": "When it errors what are the values of all the variables?  Do the make sense?"}, {"owner": {"reputation": 11, "user_id": 6773185, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FFfhle3o0SM/AAAAAAAAAAI/AAAAAAAA5t4/skjFloqwDY0/photo.jpg?sz=128", "display_name": "\u0420\u043e\u043c\u0430\u043d \u0423\u0434\u0430\u043b\u044c\u0446\u043e\u0432", "link": "https://stackoverflow.com/users/6773185/%d0%a0%d0%be%d0%bc%d0%b0%d0%bd-%d0%a3%d0%b4%d0%b0%d0%bb%d1%8c%d1%86%d0%be%d0%b2"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1513786829, "post_id": 47909640, "comment_id": 82788166, "body": "SourceRangeFrom and SourceRangeTo are empty. And looks like at the moment when error appears, the first line of mapping table is processed."}, {"owner": {"reputation": 11, "user_id": 6773185, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FFfhle3o0SM/AAAAAAAAAAI/AAAAAAAA5t4/skjFloqwDY0/photo.jpg?sz=128", "display_name": "\u0420\u043e\u043c\u0430\u043d \u0423\u0434\u0430\u043b\u044c\u0446\u043e\u0432", "link": "https://stackoverflow.com/users/6773185/%d0%a0%d0%be%d0%bc%d0%b0%d0%bd-%d0%a3%d0%b4%d0%b0%d0%bb%d1%8c%d1%86%d0%be%d0%b2"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1513787009, "post_id": 47909640, "comment_id": 82788282, "body": "If I try step-by-step debugging (F8), everything is OK till first \u201cworkbook open\u201d row, next F8 starts non-stoppable processing until the error appears."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1513785003, "post_id": 47909753, "comment_id": 82787039, "body": "the OP wants the value from the mapping table.  It contains a range reference.  It is this reference and not the address of the cell that the OP want to pass to the variable."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1513785775, "last_edit_date": 1513785775, "creation_date": 1513784710, "answer_id": 47909753, "question_id": 47909640, "link": "https://stackoverflow.com/questions/47909640/copy-multiple-ranges-between-workbooks-using-mapping-table/47909753#47909753", "title": "Copy multiple ranges between workbooks using mapping table", "body": "<p>In case that <code>SourceRangeFrom</code> is supposed to be <code>E3</code> or anything like this, then simply write <code>debug.print SourceRangeFrom</code> before the error and see what is it. Do the same with <code>SourceRangeTo</code>. They should be some format, that is not an address. </p>\n\n<p>Another option is simply to check for a NullString as probably some of the cells are empty. Thus after assigning the values write this:</p>\n\n<pre><code>If SourceRangeTo = vbNullString Or SourceRangeTo = vbNullString Or _\n    TargetRangeFrom = vbNullString Or TargetRangeTo = vbNullString Then Stop\n</code></pre>\n\n<hr>\n\n<p>If you want the address of the <code>Cells(CurrentRow,3)</code> do the following:</p>\n\n<p>In your code, instead of this:</p>\n\n<pre><code>SourceRangeFrom = Cells(CurrentRow, 3)\nSourceRangeTo = Cells(CurrentRow, 4)\n</code></pre>\n\n<p>Assign like this:</p>\n\n<pre><code>SourceRangeFrom = Cells(CurrentRow, 3).Address\nSourceRangeTo = Cells(CurrentRow, 4).Address\n</code></pre>\n\n<p>Otherwise you are getting the <code>Value</code> and not the <code>Address</code> of the Cell. Which is quite different.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6773185, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FFfhle3o0SM/AAAAAAAAAAI/AAAAAAAA5t4/skjFloqwDY0/photo.jpg?sz=128", "display_name": "\u0420\u043e\u043c\u0430\u043d \u0423\u0434\u0430\u043b\u044c\u0446\u043e\u0432", "link": "https://stackoverflow.com/users/6773185/%d0%a0%d0%be%d0%bc%d0%b0%d0%bd-%d0%a3%d0%b4%d0%b0%d0%bb%d1%8c%d1%86%d0%be%d0%b2"}, "is_accepted": true, "score": 0, "last_activity_date": 1513843413, "creation_date": 1513843413, "answer_id": 47920477, "question_id": 47909640, "link": "https://stackoverflow.com/questions/47909640/copy-multiple-ranges-between-workbooks-using-mapping-table/47920477#47920477", "title": "Copy multiple ranges between workbooks using mapping table", "body": "<p>The problem was that I've used <code>Cells</code> in <code>If</code> conditions without specifying a workbook. As a result, values were taken from last opened workbook so variables became empty. </p>\n\n<p>Here's a correct version with workbooks and sheets specified in <code>If</code> conditions:\n</p>\n\n<pre><code>Sub Copy_Report_Data()\n\n  Dim CurrentRow As Long\n  Dim LastRow As Long\n  Dim Path As String\n  Dim MacroWorkbook As Workbook\n  Dim SourceWorkbook As Workbook, SourceFileName As String, SourceTabName As String, SourceRangeFrom As String, SourceRangeTo As String, SourceRange As Range\n  Dim TargetWorkbook As Workbook, TargetFileName As String, TargetTabName As String, TargetRangeFrom As String, TargetRangeTo As String, TargetRange As Range\n\n  Application.ScreenUpdating = False\n\n  Set MacroWorkbook = ActiveWorkbook\n\n  Path = MacroWorkbook.Path &amp; \"\\\"\n  LastRow = MacroWorkbook.Sheets(\"Mapping\").Range(\"C3\").End(xlDown).Row\n\n  For CurrentRow = 3 To LastRow\n\n    If MacroWorkbook.Sheets(\"Mapping\").Cells(CurrentRow, 2).Value &lt;&gt; \"\" Then\n      SourceTabName = MacroWorkbook.Sheets(\"Mapping\").Cells(CurrentRow, 2)\n      TargetTabName = MacroWorkbook.Sheets(\"Mapping\").Cells(CurrentRow, 7)\n    End If\n\n    SourceRangeFrom = MacroWorkbook.Sheets(\"Mapping\").Cells(CurrentRow, 3)\n    SourceRangeTo = MacroWorkbook.Sheets(\"Mapping\").Cells(CurrentRow, 4)\n\n    TargetRangeFrom = MacroWorkbook.Sheets(\"Mapping\").Cells(CurrentRow, 8)\n    TargetRangeTo = MacroWorkbook.Sheets(\"Mapping\").Cells(CurrentRow, 9)\n\n    If MacroWorkbook.Sheets(\"Mapping\").Cells(CurrentRow, 1).Value &lt;&gt; \"\" And CurrentRow &lt;&gt; 3 Then\n      TargetWorkbook.Save\n      TargetWorkbook.Close\n      SourceWorkbook.Close\n    End If\n\n    If MacroWorkbook.Sheets(\"Mapping\").Cells(CurrentRow, 1).Value &lt;&gt; \"\" Then\n      SourceFileName = MacroWorkbook.Sheets(\"Mapping\").Cells(CurrentRow, 1)\n      TargetFileName = MacroWorkbook.Sheets(\"Mapping\").Cells(CurrentRow, 6)\n      Set SourceWorkbook = Workbooks.Open(Path &amp; \"Source\\\" &amp; SourceFileName)\n      Set TargetWorkbook = Workbooks.Open(Path &amp; \"Target\\\" &amp; TargetFileName)\n    End If\n\n    'Debug.Print \"Timestamp         \"; Format(Now(), \"dd.MM.yyyy hh:mm:ss\")\n    'Debug.Print \"CurrentRow        \" &amp; CurrentRow\n    'Debug.Print \"SourceWorkbook    \" &amp; \"Source\\\" &amp; SourceFileName\n    'Debug.Print \"SourceTabName     \" &amp; SourceTabName\n    'Debug.Print \"SourceRangeFrom   \" &amp; SourceRangeFrom\n    'Debug.Print \"SourceRangeTo     \" &amp; SourceRangeTo\n    'Debug.Print \"TargetWorkbook    \" &amp; \"Target\\\" &amp; TargetFileName\n    'Debug.Print \"TargetTabName     \" &amp; TargetTabName\n    'Debug.Print \"TargetRangeFrom   \" &amp; TargetRangeFrom\n    'Debug.Print \"---------------------------------------------------------\"\n\n    SourceWorkbook.Sheets(SourceTabName).Range(SourceRangeFrom &amp; \":\" &amp; SourceRangeTo).Copy\n    TargetWorkbook.Sheets(TargetTabName).Range(TargetRangeFrom).PasteSpecial Paste:=xlPasteValues\n    TargetWorkbook.Sheets(TargetTabName).Cells.Replace What:=\"x\", Replacement:=\"\", LookAt:=xlPart\n\n  Next CurrentRow\n\n  TargetWorkbook.Save\n  TargetWorkbook.Close\n  SourceWorkbook.Close\n\n  Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6773185, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FFfhle3o0SM/AAAAAAAAAAI/AAAAAAAA5t4/skjFloqwDY0/photo.jpg?sz=128", "display_name": "\u0420\u043e\u043c\u0430\u043d \u0423\u0434\u0430\u043b\u044c\u0446\u043e\u0432", "link": "https://stackoverflow.com/users/6773185/%d0%a0%d0%be%d0%bc%d0%b0%d0%bd-%d0%a3%d0%b4%d0%b0%d0%bb%d1%8c%d1%86%d0%be%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 47920477, "answer_count": 2, "score": 1, "last_activity_date": 1513843413, "creation_date": 1513784318, "last_edit_date": 1513796719, "question_id": 47909640, "link": "https://stackoverflow.com/questions/47909640/copy-multiple-ranges-between-workbooks-using-mapping-table", "title": "Copy multiple ranges between workbooks using mapping table", "body": "<p>I have a mapping table looking like this: </p>\n\n<p><a href=\"https://i.stack.imgur.com/dm5UP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dm5UP.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://habrastorage.org/webt/wa/jw/ha/wajwhablzjlh-kgepnka-fxjmq4.png\" rel=\"nofollow noreferrer\">Range mapping</a></p>\n\n<p>What I need to do is:</p>\n\n<ol>\n<li>Copy data from range E22:E59 of File 1, Sheet 1 to range G7:G42 of File 3, Sheet 1</li>\n<li>Copy data from range E61:E69 of File 1, Sheet 1 to range G44:G52 of File 3, Sheet 1</li>\n<li>Copy data from range E71:E74 of File 1, Sheet 1 to range G53:G56 of File 3, Sheet 1</li>\n<li>Copy data from range G22:H69 of File 1, Sheet 2 to range H7:I52 of File 3, Sheet 2</li>\n<li>... etc. to the first empty line of mapping table</li>\n</ol>\n\n<p>I'm trying this:</p>\n\n<pre><code>Sub Copy_Report_Data()\n\n  Dim CurrentRow As Long\n  Dim LastRow As Long\n  Dim Path As String\n  Dim MacroWorkbook As Workbook\n  Dim SourceWorkbook As Workbook, SourceFileName As String, SourceTabName As String, SourceRangeFrom As String, SourceRangeTo As String, SourceRange As Range\n  Dim TargetWorkbook As Workbook, TargetFileName As String, TargetTabName As String, TargetRangeFrom As String, TargetRangeTo As String, TargetRange As Range\n\n  Application.ScreenUpdating = False\n\n  Path = ActiveWorkbook.Path &amp; \"\\\"\n\n  LastRow = ActiveWorkbook.Sheets(\"Mapping\").Range(\"C3\").End(xlDown).Row\n\n  For CurrentRow = 3 To LastRow\n\n    If Cells(CurrentRow, 2).Value &lt;&gt; \"\" Then\n      SourceTabName = Cells(CurrentRow, 2)\n      TargetTabName = Cells(CurrentRow, 7)\n    End If\n\n    SourceRangeFrom = Cells(CurrentRow, 3)\n    SourceRangeTo = Cells(CurrentRow, 4)\n\n    TargetRangeFrom = Cells(CurrentRow, 8)\n    TargetRangeTo = Cells(CurrentRow, 9)\n\n    If Cells(CurrentRow, 1).Value &lt;&gt; \"\" And CurrentRow &lt;&gt; 3 Then\n      TargetWorkbook.Save\n      TargetWorkbook.Close\n      SourceWorkbook.Close\n    End If\n\n    If Cells(CurrentRow, 1).Value &lt;&gt; \"\" Then\n      SourceFileName = Cells(CurrentRow, 1)\n      TargetFileName = Cells(CurrentRow, 6)\n      Set SourceWorkbook = Workbooks.Open(Path &amp; \"Source\\\" &amp; SourceFileName)\n      Set TargetWorkbook = Workbooks.Open(Path &amp; \"Target\\\" &amp; TargetFileName)\n    End If\n\n    SourceWorkbook.Sheets(SourceTabName).Range(SourceRangeFrom &amp; \":\" &amp; SourceRangeTo).Copy\n    TargetWorkbook.Sheets(TargetTabName).Range(TargetRangeFrom &amp; \":\" &amp; TargetRangeTo).PasteSpecial Paste:=xlPasteValues\n    TargetWorkbook.Sheets(TargetTabName).Range(TargetRangeFrom &amp; \":\" &amp; TargetRangeTo).Replace What:=\"x\", Replacement:=\"\", LookAt:=xlPart\n\n  Next CurrentRow\n\n  Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>But I get runtime error on this row:</p>\n\n<pre><code>SourceWorkbook.Sheets(SourceTabName).Range(SourceRangeFrom &amp; \":\" &amp; SourceRangeTo).Copy\n</code></pre>\n\n<p>Where am I wrong?</p>\n"}, {"tags": ["excel", "csv", "vba"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1513789512, "post_id": 47909398, "comment_id": 82789633, "body": "i can&#39;t notice anything, but the <code>Destination:=WS.Range(&quot;F2&quot;)</code> seems a bit strange, and I think you might need <code>On Error GoTo -1</code> before <code>Next data_fill</code> to reset the error handling"}, {"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "edited": false, "score": 0, "creation_date": 1513792171, "post_id": 47909398, "comment_id": 82791025, "body": "Is it a table? Try using table VBA commands (<a href=\"https://stackoverflow.com/questions/43541445/select-entire-column-in-table-using-excel-vba\" title=\"select entire column in table using excel vba\">stackoverflow.com/questions/43541445/&hellip;</a>) if it is"}, {"owner": {"reputation": 39, "user_id": 8970264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa93fd41d0baa21986a0e2c493f6ff6d?s=128&d=identicon&r=PG&f=1", "display_name": "Joete", "link": "https://stackoverflow.com/users/8970264/joete"}, "edited": false, "score": 0, "creation_date": 1513854701, "post_id": 47909398, "comment_id": 82814911, "body": "I still don&#39;t know what the problem was, but I made a totally new Excel file, copied the VBA code, and now it works like a charm! Looks like there was something that messedup my original file...I think... Thanks for helping."}], "owner": {"reputation": 39, "user_id": 8970264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa93fd41d0baa21986a0e2c493f6ff6d?s=128&d=identicon&r=PG&f=1", "display_name": "Joete", "link": "https://stackoverflow.com/users/8970264/joete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1928, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1513786099, "creation_date": 1513783566, "last_edit_date": 1531164843, "question_id": 47909398, "link": "https://stackoverflow.com/questions/47909398/import-csv-to-excel-with-vba", "title": "Import CSV to Excel with VBA", "body": "<p>We create CSV files with Python from Revit files. I tried te import the CSV's to Excel with a VBA code.</p>\n\n<p>The projectinfo (data_fill = 8) is working OK.\nThen I have 7 other CSV's that I import in my Excel. But what happens is that my walls (wanden_data / data_fill = 1) en floors (vloeren_data / data_fill = 2) CSV first inserts columns before column A, the other CSV's are copied OK from cell A5... </p>\n\n<p>Can somebody explain what happens? And what I can do about it? All 7 CSV's use the same code...</p>\n\n<pre><code>Sub CSV_inladen()\n    Dim StartTime As Double\n    Dim SecondsElapsed As Double\n    StartTime = Timer\n    Dim File As String\n    Dim teller As Integer\n    teller = 0\n    Dim Missers As String\n    Missers = \"\"\n\n    ' csv in array\n    Dim CSV(1 To 8) As String\n    ' csv bestanden vastleggen\n    CSV(1) = \"wanden_data\"\n    CSV(2) = \"vloeren_data\"\n    CSV(3) = \"plafonds_data\"\n    CSV(4) = \"liggers_data\"\n    CSV(5) = \"kolommen_data\"\n    CSV(6) = \"daken_data\"\n    CSV(7) = \"overige_data\"\n    CSV(8) = \"projectinfo_data\"\n\n    ' Loopje voor het tellen en controleren\n    For c = 1 To UBound(CSV)\n        File = ThisWorkbook.Path &amp; \"\\csv_bestanden\\\" &amp; CSV(c) &amp; \"*.csv\"\n        Filename = Dir(File)\n        If Filename &lt;&gt; \"\" Then\n            teller = teller + 1\n        Else\n            Missers = Missers &amp; Chr(13) &amp; \" - \" &amp; CSV(c) &amp; \".csv\"\n        End If\n    Next c\n\n    ' controle of CSV bestanden bestaan\n    If teller = 0 Then\n        MsgBox \"Geen CSV-bestanden gevonden. Zorg dat deze op de juiste manier aangemaakt worden.\", vbCritical + vbOKOnly, \"Geen data\"\n    ElseIf teller &lt; UBound(CSV) Then\n        MsgBox \"Onvoldoende CSV-bestanden gevonden. Zorg dat deze op de juiste manier aangemaakt worden. De volgende CSV bestanden ontbreken:\" &amp; Missers, vbCritical + vbOKOnly, \"Geen data\"\n    Else\n        ' werkbladen in array\n        Dim Sh(1 To 8) As String\n        ' werkbladen vastleggen\n        Sh(1) = \"wanden_meetstaat\"\n        Sh(2) = \"vloeren_meetstaat\"\n        Sh(3) = \"plafonds_meetstaat\"\n        Sh(4) = \"liggers_meetstaat\"\n        Sh(5) = \"kolommen_meetstaat\"\n        Sh(6) = \"daken_meetstaat\"\n        Sh(7) = \"overige_categorien\"\n        Sh(8) = \"meetstaat_instructie\"\n\n        For data_fill = 1 To UBound(Sh)\n            ' werkblad en csv-bestand bepalen\n            Set WS = ActiveWorkbook.Sheets(Sh(data_fill))\n            csvFile = ThisWorkbook.Path &amp; \"\\csv_bestanden\\\" &amp; CSV(data_fill) &amp; \".csv\"\n\n            ' excel vullen uit csv\n            If data_fill = 8 Then\n                With WS.QueryTables.Add(Connection:=\"TEXT;\" &amp; csvFile, Destination:=WS.Range(\"F2\"))\n                    .FieldNames = True\n                    .RowNumbers = False\n                    .FillAdjacentFormulas = False\n                    .PreserveFormatting = True\n                    .RefreshOnFileOpen = False\n                    .RefreshStyle = xlOverwriteCells\n                    .SavePassword = False\n                    .SaveData = False\n                    .AdjustColumnWidth = False\n                    .RefreshPeriod = 0\n                    .TextFilePromptOnRefresh = False\n                    .TextFilePlatform = 850\n                    .TextFileStartRow = 1\n                    .TextFileParseType = xlDelimited\n                    .TextFileTextQualifier = xlTextQualifierDoubleQuote\n                    .TextFileConsecutiveDelimiter = False\n                    .TextFileTabDelimiter = False\n                    .TextFileSemicolonDelimiter = True\n                    .TextFileCommaDelimiter = False\n                    .TextFileSpaceDelimiter = False\n                    .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)\n                    .TextFileTrailingMinusNumbers = True\n                    .Refresh BackgroundQuery:=False\n                End With\n            Else\n                With WS.QueryTables.Add(Connection:=\"TEXT;\" &amp; csvFile, Destination:=WS.Range(\"A5\"))\n                    .FieldNames = True\n                    .RowNumbers = False\n                    .FillAdjacentFormulas = False\n                    .PreserveFormatting = True\n                    .RefreshOnFileOpen = False\n                    '.RefreshStyle = xlOverwriteCells\n                    .SavePassword = False\n                    .SaveData = False\n                    .AdjustColumnWidth = False\n                    .RefreshPeriod = 0\n                    .TextFilePromptOnRefresh = False\n                    .TextFilePlatform = 850\n                    .TextFileStartRow = 1\n                    .TextFileParseType = xlDelimited\n                    .TextFileTextQualifier = xlTextQualifierDoubleQuote\n                    .TextFileConsecutiveDelimiter = False\n                    .TextFileTabDelimiter = False\n                    .TextFileSemicolonDelimiter = True\n                    .TextFileCommaDelimiter = False\n                    .TextFileSpaceDelimiter = False\n                    .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)\n                    .TextFileTrailingMinusNumbers = True\n                    .Refresh BackgroundQuery:=False\n                End With\n            End If\n            ' querytables verwijderen\n            On Error GoTo nothingtodelete\n                Sheets(Sh(data_fill)).QueryTables(1).SaveData = False\n                Sheets(Sh(data_fill)).QueryTables.Item(1).Delete\nnothingtodelete:\n        Next data_fill\n\n        ' melding met verwerkte tijd\n        SecondsElapsed = Round(Timer - StartTime, 2)\n        MsgBox \"Data toegevoegd in \" &amp; SecondsElapsed &amp; \" seconden\", vbOKOnly + vbInformation, \"Data toegevoegd\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Screenshots Excel:</p>\n\n<p>Empty Excel sheet:\n<img src=\"https://i.stack.imgur.com/8Ld7T.jpg\" alt=\"Image1\"></p>\n\n<p>Correct import:\n<img src=\"https://i.stack.imgur.com/xmkHB.jpg\" alt=\"Image2\"></p>\n\n<p>Wrong import:\n<img src=\"https://i.stack.imgur.com/wR7Co.jpg\" alt=\"Image3\"></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 2, "creation_date": 1513783328, "post_id": 47909240, "comment_id": 82785926, "body": "Change <code>&quot;&quot;</code> to <code>&quot;&quot;&quot;&quot;</code> in formula"}, {"owner": {"reputation": 99, "user_id": 8591599, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/7d0e1fcdda3ee34866d0975fcd997873?s=128&d=identicon&r=PG&f=1", "display_name": "jufg", "link": "https://stackoverflow.com/users/8591599/jufg"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1513783429, "post_id": 47909240, "comment_id": 82785991, "body": "Thanks JohnyL, I&#39;m still getting the same error, but that is definitely something that needed fixing"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1513783551, "post_id": 47909240, "comment_id": 82786074, "body": "Also, you use <code>R1C1</code> notation, but in your formula there&#39;s <code>$A$1</code>. Change it to <code>R1C1</code>."}, {"owner": {"reputation": 99, "user_id": 8591599, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/7d0e1fcdda3ee34866d0975fcd997873?s=128&d=identicon&r=PG&f=1", "display_name": "jufg", "link": "https://stackoverflow.com/users/8591599/jufg"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1513783719, "post_id": 47909240, "comment_id": 82786176, "body": "I have also selected the entire column A:A, how do I write that?"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1513783894, "post_id": 47909240, "comment_id": 82786286, "body": "You must use <code>C1</code>."}, {"owner": {"reputation": 99, "user_id": 8591599, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/7d0e1fcdda3ee34866d0975fcd997873?s=128&d=identicon&r=PG&f=1", "display_name": "jufg", "link": "https://stackoverflow.com/users/8591599/jufg"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1513784166, "post_id": 47909240, "comment_id": 82786454, "body": "Excellent thanks JohnyL that&#39;s all working now!!"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1513784244, "post_id": 47909240, "comment_id": 82786515, "body": "You&#39;re welcome! I&#39;ll put my comments into answer. :)"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513785188, "post_id": 47909318, "comment_id": 82787179, "body": "I think you meant &quot;double quotes&quot;"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1513785346, "post_id": 47909318, "comment_id": 82787296, "body": "<code>RC[-1]</code> is incorrect reference since OP has <code>$A$1</code>, i.e. absolute reference."}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 1, "last_activity_date": 1513783363, "creation_date": 1513783363, "answer_id": 47909318, "question_id": 47909240, "link": "https://stackoverflow.com/questions/47909240/autofill-formula-in-vba/47909318#47909318", "title": "Autofill formula in VBA", "body": "<p>you have to escape the speech marks in your formula because the whole thing is in speechmarks in VBA</p>\n\n<pre><code> .Range(.Cells(1, 1), Usdrws.Offset(, 1)).FormulaR1C1 = _\n\"=IF(OFFSET(OriginalData!$A$1,MATCH(TempTable!RC[-1],OriginalData!$A:$A,0)-1,2,1,1)=0,\"\"\"\",OFFSET(OriginalData!$A$1,MATCH(TempTable!RC[-1],OriginalData!$A:$A,0)-1,2,1,1))\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": true, "score": 1, "last_activity_date": 1513784374, "creation_date": 1513784374, "answer_id": 47909652, "question_id": 47909240, "link": "https://stackoverflow.com/questions/47909240/autofill-formula-in-vba/47909652#47909652", "title": "Autofill formula in VBA", "body": "<p>In formula you need to change:</p>\n\n<ol>\n<li>Change <code>\"\"</code> to <code>\"\"\"\"</code> in formula</li>\n<li>Change <code>$A$1</code> to <code>R1C1</code></li>\n<li>Change <code>A:A</code> to <code>C1</code></li>\n</ol>\n"}], "owner": {"reputation": 99, "user_id": 8591599, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/7d0e1fcdda3ee34866d0975fcd997873?s=128&d=identicon&r=PG&f=1", "display_name": "jufg", "link": "https://stackoverflow.com/users/8591599/jufg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 47909652, "answer_count": 2, "score": 0, "last_activity_date": 1513784374, "creation_date": 1513783132, "last_edit_date": 1513783844, "question_id": 47909240, "link": "https://stackoverflow.com/questions/47909240/autofill-formula-in-vba", "title": "Autofill formula in VBA", "body": "<p>I have the below formula within Excel which works well. This formula is then dragged down to the bottom of the table.</p>\n\n<p><code>=IF(OFFSET(OriginalData!$A$1,MATCH(TempTable!$A2,OriginalData!$A:$A,0)-1,2,1,1)=0,\"\",OFFSET(OriginalData!$A$1,MATCH(TempTable!$A2,OriginalData!$A:$A,0)-1,2,1,1))</code></p>\n\n<p>I now want to add this to vba and have attempted the following:</p>\n\n<pre><code>Private Sub MatchViaEmployeeName()\n\nWith Worksheets(\"TempTable\")\n\nSet Usdrws = .Cells(.Rows.Count, 1).End(xlUp)\n\n.Range(.Cells(1, 1), Usdrws.Offset(, 1)).FormulaR1C1 = \"=IF(OFFSET(OriginalData!R1C1,MATCH(TempTable!RC[-1],OriginalData!$A:$A,0)-1,2,1,1)=0,\"\"\"\",OFFSET(OriginalData!R1C1,MATCH(TempTable!RC[-1],OriginalData!$A:$A,0)-1,2,1,1))\"\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>My logic is to select the entire range using the 'Usdrws' variable and then entering the formula.</p>\n\n<p>I'm currently getting a </p>\n\n<blockquote>\n  <p>run-time error 1004</p>\n</blockquote>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513783779, "post_id": 47909237, "comment_id": 82786210, "body": "Please read <a href=\"https://meta.stackoverflow.com/q/284236/1188513\"><i>Why is \u201cCan someone help me?\u201d not an actual question?</i></a> -  Also: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513783880, "post_id": 47909237, "comment_id": 82786269, "body": "@Mat&#39;sMug - I just need some help to get started with some code.  I don&#39;t know where to start that&#39;s my issue."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1513784379, "post_id": 47909237, "comment_id": 82786617, "body": "@A.Cohen before trying to jump into VBA, get familiar with the different options within Excel first. I made months of mistakes that I learned were mistakes through short youtube videos. Check out <code>Excel Dashboards</code> on Youtube for a great springboard."}], "answers": [{"tags": [], "owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "is_accepted": true, "score": 1, "last_activity_date": 1513784239, "creation_date": 1513784239, "answer_id": 47909616, "question_id": 47909237, "link": "https://stackoverflow.com/questions/47909237/vba-graph-by-month/47909616#47909616", "title": "VBA - Graph by month", "body": "<p>First off, format your data as a table since that will make your life much easier. You will need to add headers to each column. This will make your data easier to read, and easier to maintain.</p>\n\n<p>To format it as a table highlight the range, and then press CTRL+T. Make sure to check 'My data has headers'.</p>\n\n<p>Good, now click inside the table, <code>Insert &gt; PivotTable</code>. Select the destination. For rows you want <code>Date</code>, for values you want <code>Sum of Value</code> (where value is whatever you name your values column.</p>\n\n<p>Then finally, check out this article for the whole rundown of Groupby: <a href=\"http://www.contextures.com/xlPivot07.html\" rel=\"nofollow noreferrer\">http://www.contextures.com/xlPivot07.html</a>.</p>\n\n<p>To be fair, there is an easy enough way of doing this without a PivotTable (adding a helper column for <code>Month</code> for example), but there's no need to reinvent the wheel. Additionally, if you want to add <code>Qtr.</code> eventually, you're better off familiarizing yourself with workhorses of excel.</p>\n\n<p>Lastly, once you have taken the above steps, you'll likely find the <code>Timeline</code> slicer very helpful. You can use that to visualize specific periods on your pivot or chart.</p>\n\n<p>Minor Note: This all assumes your dates are true dates. If they aren't, you'll likely run into more issues.</p>\n"}], "owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 47909616, "answer_count": 1, "score": -2, "last_activity_date": 1513784239, "creation_date": 1513783120, "question_id": 47909237, "link": "https://stackoverflow.com/questions/47909237/vba-graph-by-month", "title": "VBA - Graph by month", "body": "<p>I am having issues trying to create code to make a graph that is dependent upon months.  So I have <code>Column A</code> which is the beginning of the week date, i.e. 1/1/17.  In <code>Column B</code> I have the count from that week of issues occurred.  I would like to group together the count by month, using the <code>Month</code> function, so for January there are 37 issues, February - 23, etc.  And then make a graph accordingly where the first month is titled January.</p>\n\n<p>Eventually, I would  like to similarly do this on  a quarterly basis as well, but any help with the monthly issue first would be greatly appreciated.  Here is a screenshot of the data which is located in <code>Worksheets(\"Report\")</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/b8myD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/b8myD.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 1, "creation_date": 1513782270, "post_id": 47908904, "comment_id": 82785204, "body": "What is wrong with that line, is there an error? Also, this sounds like a job for conditional formatting."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1513782528, "post_id": 47908904, "comment_id": 82785377, "body": "What are you trying to do by removing the absolute reference?  Why not just do <code>Target.Style.Name = Good</code>?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 3, "creation_date": 1513782673, "post_id": 47908904, "comment_id": 82785480, "body": "Or <code>Sheets(&quot;Ribs&quot;).Range(Target.Address).Style = &quot;Good&quot;</code> if a different sheet to the event code."}, {"owner": {"reputation": 526, "user_id": 5970596, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3943ed8d993270d8e33543fd23a79c25?s=128&d=identicon&r=PG", "display_name": "skrat", "link": "https://stackoverflow.com/users/5970596/skrat"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1513782684, "post_id": 47908904, "comment_id": 82785488, "body": "@BruceWayne Because it raises an error <code>Wrong number of arguments or invalid propery assignment</code>"}, {"owner": {"reputation": 526, "user_id": 5970596, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3943ed8d993270d8e33543fd23a79c25?s=128&d=identicon&r=PG", "display_name": "skrat", "link": "https://stackoverflow.com/users/5970596/skrat"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1513782741, "post_id": 47908904, "comment_id": 82785531, "body": "@SJR This works!"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1513783150, "post_id": 47908904, "comment_id": 82785815, "body": "@skrat - which country are you in? E.g. what kind of Excel do you use? E.g. a French, a German, Italian? The <code>Style.Name</code> is different in many countries."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1513851097, "last_edit_date": 1513851097, "creation_date": 1513783503, "answer_id": 47909379, "question_id": 47908904, "link": "https://stackoverflow.com/questions/47908904/change-range-style-on-cell-value-change/47909379#47909379", "title": "Change Range.Style on cell value change", "body": "<p>The translation of Excel to other languages could ruin a bit the code, if the code is ran from non-English Excel and it is using <code>.Style</code> or <code>.LocalFormula</code>.</p>\n\n<p>Long story short, run this:</p>\n\n<pre><code>Public Sub TestMe()\n    Dim st As Style\n    For Each st In ThisWorkbook.Styles\n        Debug.Print st.Name\n    Next st\nEnd Sub\n</code></pre>\n\n<p>Take a look at the result in the immediate window. In a German Excel, I am receiving result like this:</p>\n\n<pre><code>Ergebnis\nErkl\u00e4render Text\nGut\nComma\nNeutral\nNotiz\nPercent\n</code></pre>\n\n<p>As you see, I do not have \"Good\" as a style. I have to use \"Gut\", if I want to refer to it.</p>\n"}], "owner": {"reputation": 526, "user_id": 5970596, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3943ed8d993270d8e33543fd23a79c25?s=128&d=identicon&r=PG", "display_name": "skrat", "link": "https://stackoverflow.com/users/5970596/skrat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513851097, "creation_date": 1513782140, "last_edit_date": 1531161705, "question_id": 47908904, "link": "https://stackoverflow.com/questions/47908904/change-range-style-on-cell-value-change", "title": "Change Range.Style on cell value change", "body": "<p>There are only two possible inputs to cell: True or False (boolean). And my goal is to change the style if the boolean is set to True.</p>\n\n<p>I tried the following code</p>\n\n<pre><code>    Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"F2:F200\")) Is Nothing Then\n        If Target Then\n            MYRange = \"\"\"\" &amp; Replace(Target.Address, \"$\", \"\") &amp; \"\"\"\"\n            Sheets(\"Ribs\").Range(MYRange).Style.Name = \"Good\"\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>But I can't get it working due to line <code>Sheets(\"Ribs\").Range(MYRange).Style.Name = \"Good\"</code></p>\n\n<p>I can't figure out what the problem is.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 1, "creation_date": 1513782076, "post_id": 47908847, "comment_id": 82785074, "body": "Have you tried filtering the data table."}, {"owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "edited": false, "score": 1, "creation_date": 1513782171, "post_id": 47908847, "comment_id": 82785137, "body": "could you show as the code you already have?"}, {"owner": {"reputation": 3, "user_id": 9123222, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HFCsHWfWN3E/AAAAAAAAAAI/AAAAAAAAAMA/CYbXkxwON-4/photo.jpg?sz=128", "display_name": "Luciano Vigano&#39;", "link": "https://stackoverflow.com/users/9123222/luciano-vigano"}, "edited": false, "score": 0, "creation_date": 1513782827, "post_id": 47908847, "comment_id": 82785591, "body": "Add code in the orginal question, already tried to adapt a code with autofilter found here in the forum but without success"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513783237, "post_id": 47908847, "comment_id": 82785864, "body": "What&#39;s failing, where, and how?"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1513783594, "post_id": 47908847, "comment_id": 82786099, "body": "just wrap your code inside the for next with  if  Cells(elabrow, 1).Value = 1 then .... and End IF"}, {"owner": {"reputation": 3, "user_id": 9123222, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HFCsHWfWN3E/AAAAAAAAAAI/AAAAAAAAAMA/CYbXkxwON-4/photo.jpg?sz=128", "display_name": "Luciano Vigano&#39;", "link": "https://stackoverflow.com/users/9123222/luciano-vigano"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1513784085, "post_id": 47908847, "comment_id": 82786407, "body": "dear @harassed-dad: yep! that will be fine but the value of cells should be 1 for the first time, then it should be 2 and so on until it will reache the max value found in the 1st column (in this particular case it&#39;s 56)"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1513784450, "post_id": 47908847, "comment_id": 82786671, "body": "1 represents column A - are you saying the value isn&#39;t in column A?"}, {"owner": {"reputation": 3, "user_id": 9123222, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HFCsHWfWN3E/AAAAAAAAAAI/AAAAAAAAAMA/CYbXkxwON-4/photo.jpg?sz=128", "display_name": "Luciano Vigano&#39;", "link": "https://stackoverflow.com/users/9123222/luciano-vigano"}, "edited": false, "score": 0, "creation_date": 1513784492, "post_id": 47908847, "comment_id": 82786708, "body": "Max value is returned by &quot;maxRuleNumber = Application.WorksheetFunction.Max(Range(&quot;a:a&quot;))&quot;"}, {"owner": {"reputation": 3, "user_id": 9123222, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HFCsHWfWN3E/AAAAAAAAAAI/AAAAAAAAAMA/CYbXkxwON-4/photo.jpg?sz=128", "display_name": "Luciano Vigano&#39;", "link": "https://stackoverflow.com/users/9123222/luciano-vigano"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1513784562, "post_id": 47908847, "comment_id": 82786750, "body": "dear @harassed-dad: sorry I meant Cells(elabrow, 1).Value = 1 should be Cells(elabrow, 1).Value = X, where X goes from 0 to the max value in the column A"}, {"owner": {"reputation": 3, "user_id": 9123222, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HFCsHWfWN3E/AAAAAAAAAAI/AAAAAAAAAMA/CYbXkxwON-4/photo.jpg?sz=128", "display_name": "Luciano Vigano&#39;", "link": "https://stackoverflow.com/users/9123222/luciano-vigano"}, "edited": false, "score": 0, "creation_date": 1513788790, "post_id": 47908847, "comment_id": 82789269, "body": "ok, changed the code and now it works fine!"}], "owner": {"reputation": 3, "user_id": 9123222, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HFCsHWfWN3E/AAAAAAAAAAI/AAAAAAAAAMA/CYbXkxwON-4/photo.jpg?sz=128", "display_name": "Luciano Vigano&#39;", "link": "https://stackoverflow.com/users/9123222/luciano-vigano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513782781, "creation_date": 1513781936, "last_edit_date": 1531164843, "question_id": 47908847, "link": "https://stackoverflow.com/questions/47908847/select-cells-with-same-value-with-variable", "title": "Select cells with same value with variable", "body": "<p>Let's assume I have in xls a range filled like this:</p>\n\n<pre><code>ROW 1 |1|s|d|f|g|\n\nROW 2 |2|d|k|o|p|\n\nROW 3 |1|a|x|y|z|\n</code></pre>\n\n<p>I already have the code (vba) to work (parse data) on each row and put it into a txt file, but I'm not able to work <strong>only</strong> with rows that have, for example, \"1\" in the first column.</p>\n\n<p>Almost tried most of the suggestion here posted without any luck...</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nlastRow = ActiveSheet.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nSetValSrcNat = \"\"\n\nSet fs = CreateObject(\"Scripting.FileSystemObject\")\nOn Error GoTo fileexists\nSet stream = fs.CreateTextFile(\"C:\\Users\\luciano.vigano\\Documents   \\prova.txt\", False, True)\n\n\nFor elabrow = 6 To lastRow\n\n\nvalInterface = Cells(elabrow, 3).Value\nvalProto = Cells(elabrow, 8).Value\nvalSrc = Cells(elabrow, 9).Value\n    If valSrc = \"host\" Then\n        valSrc = Cells(elabrow, 10)\n    Else\n        valSrc = Cells(elabrow, 9).Value &amp; \" \" &amp; Cells(elabrow, 10)\n    End If\nvalSrcNat = Cells(elabrow, 11).Value\n    If valSrcNat = \"\" Then\n        valSrcNat = SetValSrcNat\n    Else\n        valSrcNat = Cells(elabrow, 11).Value\n    End If\n\n stream.Write (\"Rule\" &amp; valRuleNumber &amp; Chr(13) &amp; Chr(10))\n stream.WriteLine valInterface\n\n\n Next elabrow\n\nstream.Close\n\nfileexists:\n    If Err.Number = 58 Then\n     MsgBox \"File already Exists\"\n    End If\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 439, "user_id": 6331185, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5c5f3a82cf0fcde0890d44e5732addac?s=128&d=identicon&r=PG&f=1", "display_name": "Shank", "link": "https://stackoverflow.com/users/6331185/shank"}, "edited": false, "score": 0, "creation_date": 1513783896, "post_id": 47909161, "comment_id": 82786290, "body": "Unfortunately, It still displays the Print Dialog Box"}], "tags": [], "owner": {"reputation": 396, "user_id": 3069490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c08592453d9da9e3d7dcaf30edbe2fa?s=128&d=identicon&r=PG", "display_name": "Edvins", "link": "https://stackoverflow.com/users/3069490/edvins"}, "is_accepted": false, "score": 1, "last_activity_date": 1513782911, "creation_date": 1513782911, "answer_id": 47909161, "question_id": 47908801, "link": "https://stackoverflow.com/questions/47908801/ie-execwb-6-2-displays-print-dialog-box-how-do-i-print-this-page/47909161#47909161", "title": "IE.ExecWB 6,2 displays print dialog box. How do I print this page?", "body": "<p>According to <a href=\"https://social.msdn.microsoft.com/Forums/en-US/d42e8dee-4407-4dab-bacc-18f90e169b89/print-an-ie-web-page?forum=exceldev\" rel=\"nofollow noreferrer\">this post</a>, the second parameter controls the behavior of the print dialog, so:</p>\n\n<pre><code>IE.ExecWB 6, 1\n</code></pre>\n\n<p>should print the document without asking for confirmation.</p>\n"}, {"tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 0, "last_activity_date": 1513792954, "creation_date": 1513792954, "answer_id": 47911895, "question_id": 47908801, "link": "https://stackoverflow.com/questions/47908801/ie-execwb-6-2-displays-print-dialog-box-how-do-i-print-this-page/47911895#47911895", "title": "IE.ExecWB 6,2 displays print dialog box. How do I print this page?", "body": "<p>The example should click the print button after calling the ExecWB command. You were mostly there. It looks as if there maybe an issue with how you are calling the APIs and what data is being returned (e.g. <code>Long</code> vs <code>LongPtr</code>). I added some conditional compilation conditions to specify the correct API call depending on the platform. I have this working on my end (running 32 bit Office).</p>\n\n<pre><code>Option Explicit\n\nPublic Const BM_CLICK = &amp;HF5\n\n#If VBA7 Then\n    Public Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n    Public Declare PtrSafe Function FindWindow Lib \"USER32\" Alias \"FindWindowA\" (ByVal lpClassName As String, ByVal lpWindowName As String) As LongPtr\n    Public Declare PtrSafe Function FindWindowEx Lib \"USER32\" Alias \"FindWindowExA\" (ByVal hWnd1 As LongPtr, ByVal hWnd2 As LongPtr, ByVal lpsz1 As String, ByVal lpsz2 As String) As LongPtr\n    Public Declare PtrSafe Function SendMessage Lib \"USER32\" Alias \"SendMessageA\" (ByVal hwnd As LongPtr, ByVal wMsg As Long, ByVal wParam As LongPtr, lParam As Any) As LongPtr\n#Else\n    Public Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n    Public Declare Function FindWindow Lib \"USER32\" Alias \"FindWindowA\" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long\n    Public Declare Function FindWindowEx Lib \"USER32\" Alias \"FindWindowExA\" (ByVal hWnd1 As Long, ByVal hWnd2 As Long, ByVal lpsz1 As String, ByVal lpsz2 As String) As Long\n    Public Declare Function SendMessage Lib \"USER32\" Alias \"SendMessageA\" (ByVal hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long\n#End If\n\nPrivate Sub IEExample()\n    Const readyState_Complete As Byte = 4\n    Const printPage As Byte = 6\n    Const dontPrompt = 1\n\n    #If VBA7 Then\n        Dim windowHWND As LongPtr\n        Dim buttonHWND As LongPtr\n    #Else\n        Dim windowHWND As Long\n        Dim buttonHWND As Long\n    #End If\n\n    With CreateObject(\"InternetExplorer.Application\")\n        .navigate \"www.google.com\"\n        While .busy Or .readystate &lt;&gt; readyState_Complete: Wend\n        .ExecWB printPage, dontPrompt\n    End With\n\n    windowHWND = getWindowPointer(\"Print\", \"#32770\")\n\n    If windowHWND &gt; 0 Then\n        'Add a small delay to allow the window to finish rendering if needed\n        Sleep 250\n        buttonHWND = FindWindowEx(windowHWND, 0, \"Button\", \"&amp;Print\")\n        If buttonHWND &gt; 0 Then\n            SendMessage buttonHWND, BM_CLICK, 0, 0\n        Else\n            Debug.Print \"didn't find button!\"\n        End If\n    End If\n\nEnd Sub\n\nPrivate Function getWindowPointer(WindowName As String, Optional ClassName As String = vbNullString) As Long\n    Dim i As Byte\n\n    #If VBA7 Then\n        Dim hwnd As LongPtr\n    #Else\n        Dim hwnd As Long\n    #End If\n\n    'Wait for the window to exist then return the pointer\n    For i = 1 To 100\n        hwnd = FindWindow(ClassName, WindowName)\n        If hwnd &gt; 0 Then\n            getWindowPointer = hwnd\n            Exit For\n        End If\n\n        DoEvents\n        Sleep 200\n    Next\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 439, "user_id": 6331185, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5c5f3a82cf0fcde0890d44e5732addac?s=128&d=identicon&r=PG&f=1", "display_name": "Shank", "link": "https://stackoverflow.com/users/6331185/shank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4071, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1513792954, "creation_date": 1513781825, "last_edit_date": 1513784805, "question_id": 47908801, "link": "https://stackoverflow.com/questions/47908801/ie-execwb-6-2-displays-print-dialog-box-how-do-i-print-this-page", "title": "IE.ExecWB 6,2 displays print dialog box. How do I print this page?", "body": "<p>I am trying to print a PDF after navigating through webpages. \nBelow is the code:</p>\n\n<pre><code>Sub login()\nDim IE      As Object\nDim HTMLDoc As Object, HTMLDoc2 As Object\nDim objCollection As Object\nDim currentURL As String\n\nConst navOpenInNewTab = &amp;H800\nSet IE = CreateObject(\"InternetExplorer.Application\")\nIE.Visible = True\nIE.Navigate \"url\"\nDo While IE.Busy Or IE.ReadyState &lt;&gt; 4: Loop\n\nSet HTMLDoc = IE.document\n'Application.Wait (Now + TimeValue(\"00:0:10\"))\n\nWith HTMLDoc\n    HTMLDoc.getElementById(\"userName\").Value = \"ABC\"    'Entering credential\n    HTMLDoc.getElementById(\"password\").Value = \"xyz\"\nEnd With\n\nApplication.Wait (Now + TimeValue(\"00:0:3\"))\nSet objCollection = IE.document.getElementById(\"submitButton\")\nobjCollection.Click\n\nDo While IE.Busy Or IE.ReadyState &lt;&gt; 4: Loop    ' opening the second webpage\n\nSet HTMLDoc2 = IE.document\nWith HTMLDoc2\n    IE.Navigate \"URL\"\n\nEnd With\nApplication.Wait (Now + TimeValue(\"00:0:10\"))\n\nDo While IE.Busy Or IE.ReadyState &lt;&gt; 4: Loop\n\nSet objCollection = IE.document.getElementById(\"menu_print\")\nobjCollection.Click\n\nDo While IE.Busy Or IE.ReadyState &lt;&gt; 4: Loop\nApplication.Wait (Now + TimeValue(\"00:0:03\"))\n\nWith CreateObject(\"Shell.Application\").Windows\n    If .Count &gt; 0 Then\n        ' Get IE\n        Set IE = .Item(1)    ' or .Item(.Count - 1) 'second tab\n        IE.Navigate \"URL\"    'third webpage\n        IE.ExecWB 6, 2\n        'Application.CommandBars.ExecuteMso (\"PrintPreviewAndPrint\")\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>How do I click on the print button on the print Dialog box or how do I print the PDF on the third webpage without clicking or handling a dialog box. Is there a direct command to print the PDF on the Webpage.</p>\n\n<p>Added the bleow code to find the Print dialog box\nCode:</p>\n\n<pre><code>timeout = Now + TimeValue(\"00:00:04\")\nDo\nhWnd = FindWindow(vbNullString, \"Print\") 'Finding the save as window\nDoEvents\nSleep 200\nLoop Until hWnd Or Now &gt; timeout\n\n  If hWnd Then\n\n    SetForegroundWindow hWnd\n\n    'Find the child DUIViewWndClassName window\n\n   'hWnd = FindWindowEx(hWnd, 0, \"DUIViewWndClassName\", vbNullString)\n    hWnd = FindWindowEx(hWnd, 0, \"Button\", \"&amp;Print\") 'Finding the Print button on the window\n    Sleep 600\n  SendMessage hWnd, BM_CLICK, 0, 0\n\nEnd If\n</code></pre>\n\n<p>The code is ableto find the Print dialog box and set it on the foreground. <strong>But, it is not able to find the Print Button. for FindwindowEx it return hWnd as Zero.</strong></p>\n\n<p>My Header File:</p>\n\n<pre><code>Option Explicit\n\nPublic Declare PtrSafe Sub Sleep Lib \"kernel32\" _\n    (ByVal dwMilliseconds As Long)\n\n\nPublic Declare PtrSafe Function FindWindow Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long\nPublic Declare PtrSafe Function FindWindowEx Lib \"user32\" _\n                                  Alias \"FindWindowExA\" (ByVal hWnd1 As LongPtr, ByVal hWnd2 As LongPtr, _\n                                  ByVal lpsz1 As String, ByVal lpsz2 As String) As LongPtr\n\nPublic Declare PtrSafe Function SendMessage Lib \"user32\" Alias \"SendMessageA\" (ByVal hWnd As LongPtr, ByVal wMsg As Long, _\n                                                           ByVal wParam As LongPtr, lParam As Any) As LongPtr\n\nPublic Declare PtrSafe Function SetForegroundWindow Lib \"user32\" _\n    (ByVal hWnd As Long) As LongPtr\n\n\nPublic Declare PtrSafe Function SendMessageByString Lib \"user32\" Alias \"SendMessageA\" _\n    (ByVal hWnd As Long, ByVal wMsg As Long, ByVal wParam As Long, ByVal lParam As String) As LongPtr\n\n\nPublic Declare PtrSafe Function PostMessage Lib \"user32\" Alias \"PostMessageA\" _\n    (ByVal hWnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As LongPtr\n\n\nPublic Declare PtrSafe Sub keybd_event Lib \"user32\" _\n    (ByVal bVk As Byte, ByVal bScan As Byte, ByVal dwFlags As Long, ByVal dwExtraInfo As Long)\n\n\n\n    Public Const BM_CLICK = &amp;HF5\n    Public Const WM_SETTEXT = &amp;HC\n    Public Const WM_GETTEXT = &amp;HD\n    Public Const WM_GETTEXTLENGTH = &amp;HE\n\n    Public Const VK_KEYDOWN = &amp;H0\n    Public Const VK_KEYUP = &amp;H2\n    Public Const VK_CONTROL = &amp;H11\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 3982, "user_id": 5695953, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b50e1603f447a4a31cded4a14edfeff9?s=128&d=identicon&r=PG&f=1", "display_name": "Md. Suman Kabir", "link": "https://stackoverflow.com/users/5695953/md-suman-kabir"}, "edited": false, "score": 1, "creation_date": 1513781312, "post_id": 47908572, "comment_id": 82784529, "body": "Please show us your current code"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 1, "creation_date": 1513781316, "post_id": 47908572, "comment_id": 82784533, "body": "Have you tried <code>ActiveWorkbook.FullName</code>?"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1513781390, "post_id": 47908572, "comment_id": 82784589, "body": "Why the downvote? The question may be short, but it is perfectly valid."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3982, "user_id": 5695953, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b50e1603f447a4a31cded4a14edfeff9?s=128&d=identicon&r=PG&f=1", "display_name": "Md. Suman Kabir", "link": "https://stackoverflow.com/users/5695953/md-suman-kabir"}, "edited": false, "score": 0, "creation_date": 1513782170, "post_id": 47908572, "comment_id": 82785135, "body": "@Md.SumanKabir OP is using <code>Application.Path</code> and getting a mapped network drive but needs a UNC path, which part is unclear?"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 1, "creation_date": 1513782852, "post_id": 47908572, "comment_id": 82785611, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/28722852/convert-shared-folder-path-to-unc-path\">Convert Shared folder path to UNC path</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1513782548, "post_id": 47908980, "comment_id": 82785394, "body": "You missed the part where <code>S:</code> actually means <code>\\\\MachineName\\ShareFolder\\ </code> and thus, your code won&#39;t solve the problem. Sure, it will remove the <code>S:</code>. But that could be done with <code>Path = Replace(Path, &quot;S:&quot;, vbNullString)</code>."}, {"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1513782791, "post_id": 47908980, "comment_id": 82785568, "body": "replace only works if you know the letter of the drive, now check it"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1513783018, "post_id": 47908980, "comment_id": 82785724, "body": "Don&#39;t forget code formatting. Still though, all you are doing is removing the drive letter, not converting it. You could of course then append the proper mapping to the path and get what you need, but that is a very roundabout approach for something so darned simple. Plus, that would break easier than a piece of fine china. As soon as <code>...\\ShareFolder\\ </code> changes to <code>..\\SharedFolder\\ </code> or ..\\Foo\\ ` or <code>..\\Bar\\ </code> your approach breaks. Dont rely on hardcoded replacement, and don&#39;t hack off the drive mapping just because you havent found the right way yet."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1513783058, "post_id": 47908980, "comment_id": 82785755, "body": "FWIW, there is code, easily found on Google, that finds the mapping of a drive letter. But that still is not likely to be the best way."}], "tags": [], "owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "is_accepted": false, "score": -1, "last_activity_date": 1513783718, "last_edit_date": 1513783718, "creation_date": 1513782363, "answer_id": 47908980, "question_id": 47908572, "link": "https://stackoverflow.com/questions/47908572/how-to-get-a-unc-path-from-application-path/47908980#47908980", "title": "How to get a UNC path from Application.Path?", "body": "<p>The code below will identify the filepath in the manner you requested. </p>\n\n<pre><code>Path = Right(CurDir(), Len(CurDir()) - InStr(CurDir(), \"\\\") + 1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 607, "user_id": 9073241, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ad17ee95cc6886df8e31abeb84bd50f2?s=128&d=identicon&r=PG&f=1", "display_name": "Heap of Pinto Beans", "link": "https://stackoverflow.com/users/9073241/heap-of-pinto-beans"}, "is_accepted": false, "score": 4, "last_activity_date": 1513783398, "creation_date": 1513783398, "answer_id": 47909331, "question_id": 47908572, "link": "https://stackoverflow.com/questions/47908572/how-to-get-a-unc-path-from-application-path/47909331#47909331", "title": "How to get a UNC path from Application.Path?", "body": "<pre><code>    Dim Drive As String\n    Drive = Left(ActiveWorkbook.Path, 2)\n\n    ActiveWorkbookPath = Replace(ActiveWorkbook.Path, Drive, GetNetworkPath(Drive))\n\n\nFunction GetNetworkPath(ByVal DriveName As String) As String\n\n    Dim objNtWork  As Object\n    Dim objDrives  As Object\n    Dim lngLoop    As Long\n\n\n    Set objNtWork = CreateObject(\"WScript.Network\")\n    Set objDrives = objNtWork.enumnetworkdrives\n\n    For lngLoop = 0 To objDrives.Count - 1 Step 2\n        If UCase(objDrives.Item(lngLoop)) = UCase(DriveName) Then\n            GetNetworkPath = objDrives.Item(lngLoop + 1)\n            Exit For\n        End If\n    Next\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4944, "user_id": 6340948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ddf99c24b0bebc05681a2119286b120?s=128&d=identicon&r=PG&f=1", "display_name": "Ister", "link": "https://stackoverflow.com/users/6340948/ister"}, "edited": false, "score": 0, "creation_date": 1528371365, "post_id": 47909413, "comment_id": 88487798, "body": "I don&#39;t know how it is in older versions but in Office 2010 <code>ThisWorkbook.FullName</code> uses the mapped drive rather than the UNC. I went through the available variables without a success in finding anything ready to use. So the question is really valid."}], "tags": [], "owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "is_accepted": false, "score": 1, "last_activity_date": 1513783617, "creation_date": 1513783617, "answer_id": 47909413, "question_id": 47908572, "link": "https://stackoverflow.com/questions/47908572/how-to-get-a-unc-path-from-application-path/47909413#47909413", "title": "How to get a UNC path from Application.Path?", "body": "<p>Before trying to convert the filepath or any junk like that, try out a couple of the other properties that the <code>Workbook</code> object offers. I personally use <code>ActiveWorkbook.FullName</code> with all of my projects (which are hosted on network drives) and I have never had an issue.</p>\n\n<p>That said, if this approach doesn't work then there are certainly ways of converting the filepath. While I prefer going through the properties of objects first (they tend to be more reliable), I am not resistant to using a function to solve the problem. That's where checking out this article: <a href=\"https://pagecommunication.co.uk/2014/07/15/vba-to-convert-a-mapped-drive-letter-to-unc-path/\" rel=\"nofollow noreferrer\">https://pagecommunication.co.uk/2014/07/15/vba-to-convert-a-mapped-drive-letter-to-unc-path/</a> and checking this answer <a href=\"https://stackoverflow.com/questions/28722852/convert-shared-folder-path-to-unc-path\">Convert Shared folder path to UNC path</a> might help. The only difference between both is that the former requires a reference to Microsoft.Scripting.Runtime, the other does not.</p>\n"}], "owner": {"reputation": 607, "user_id": 9073241, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ad17ee95cc6886df8e31abeb84bd50f2?s=128&d=identicon&r=PG&f=1", "display_name": "Heap of Pinto Beans", "link": "https://stackoverflow.com/users/9073241/heap-of-pinto-beans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8510, "favorite_count": 0, "answer_count": 3, "score": 5, "last_activity_date": 1513783718, "creation_date": 1513781172, "last_edit_date": 1513782113, "question_id": 47908572, "link": "https://stackoverflow.com/questions/47908572/how-to-get-a-unc-path-from-application-path", "title": "How to get a UNC path from Application.Path?", "body": "<p>I want to get the path of the active workbook in vba code.\n<code>ActiveWorkbook.Path</code> does this</p>\n\n<p>BUT</p>\n\n<p>I need it to retrieve something like this:</p>\n\n<pre><code>\\\\MachineName\\ShareFolder\\ETC\\ETC2\n</code></pre>\n\n<p>NOT:</p>\n\n<pre><code>S:\\ETC\\ETC2\n</code></pre>\n\n<p>Where <code>S:</code> maps to <code>\\\\MachineName\\ShareFolder\\</code>. How would I do that?</p>\n"}, {"tags": ["excel", "indexing", "hyperlink", "autofill", "vba"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1513782352, "creation_date": 1513782352, "answer_id": 47908974, "question_id": 47908468, "link": "https://stackoverflow.com/questions/47908468/macro-for-excel-vba-will-not-run-second-sub-in-same-module/47908974#47908974", "title": "Macro for excel VBA will not run second sub in same module", "body": "<p>The shortcut is probably set to a Sub, not to a Module. Thus, the second sub is probably not running by default.</p>\n\n<p>To run the first sub first and then the second sub, try the following:</p>\n\n<pre><code>Sub TestMe()\n    NewRequistionRecord\n    FillDown\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 9105088, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0cAHJ.jpg?s=128&g=1", "display_name": "mrautomation", "link": "https://stackoverflow.com/users/9105088/mrautomation"}, "edited": false, "score": 0, "creation_date": 1513805954, "post_id": 47911781, "comment_id": 82797443, "body": "thank you for the suggestion. I&#39;m still pretty new at this."}, {"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "reply_to_user": {"reputation": 11, "user_id": 9105088, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0cAHJ.jpg?s=128&g=1", "display_name": "mrautomation", "link": "https://stackoverflow.com/users/9105088/mrautomation"}, "edited": false, "score": 0, "creation_date": 1513807169, "post_id": 47911781, "comment_id": 82797915, "body": "Hey, we all start somewhere! Think of Modules like spreadsheets - you have them, they store code. Each sub within the module is a separate macro. You can create a shortcut/button to each individual macro. If you want to use multiple macros at once, you need a &quot;wrapper&quot; macro to hold them all - like Sub Wrapper() Call Macro1 Call Macro2 End sub"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1513850396, "post_id": 47911781, "comment_id": 82812264, "body": "Just to mention that the <code>Call</code> statement is deprecated and should not be used anymore. Instead just write <code>Macroname</code> (without call)."}, {"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "edited": false, "score": 0, "creation_date": 1513865805, "post_id": 47911781, "comment_id": 82821556, "body": "Call is still needed when you have multi-input functions. I&#39;m also a fan of it since it explicitly shows and reminds &quot;Hey, this is grabbing another macro, remember?&quot; Now you were mentioning it shouldn&#39;t be used - Is there a reason to avoid using it?"}], "tags": [], "owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "is_accepted": false, "score": 0, "last_activity_date": 1513792457, "creation_date": 1513792457, "answer_id": 47911781, "question_id": 47908468, "link": "https://stackoverflow.com/questions/47908468/macro-for-excel-vba-will-not-run-second-sub-in-same-module/47911781#47911781", "title": "Macro for excel VBA will not run second sub in same module", "body": "<p>You're not calling the second macro at all. So it runs through the code, and at no point does it get the message to run the second macro. You need to tell your program somehow to run the second macro - I like\n <code>call Macroname</code></p>\n"}], "owner": {"reputation": 11, "user_id": 9105088, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0cAHJ.jpg?s=128&g=1", "display_name": "mrautomation", "link": "https://stackoverflow.com/users/9105088/mrautomation"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2383, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1513850273, "creation_date": 1513780835, "last_edit_date": 1531161705, "question_id": 47908468, "link": "https://stackoverflow.com/questions/47908468/macro-for-excel-vba-will-not-run-second-sub-in-same-module", "title": "Macro for excel VBA will not run second sub in same module", "body": "<p>Below is a macro i am currently using for some invoice tabs. the first sheet in the workbook is set up for indexing using worksheet names for the hyperlinks. this module was set up to be activated by crtl+shift+n. the second sub worked the first couple of times i tried it but now it is not copying data from the previous row filled to the first empty row filled. it seems like it stops after the first sub. Any ideas?</p>\n\n<pre><code>Option Explicit\n\nSub NewRequistionRecord()\n'\n' NewRequistionRecord Macro\n' Used for creaing a new requistion record to be auto updated in master \nRequisitions worksheet\n'\n' Keyboard Shortcut: Ctrl+Shift+N\n'\n\nDim wb As Workbook: Set wb = ThisWorkbook\nDim ws As Worksheet: Set ws = wb.sheets(\"BlankReq\")\nDim wbBefore As Workbook: Set wbBefore = Application.Workbooks(\"OPP Stores \nOrders Macro.xlsm\")\nDim wsBefore As Worksheet: Set wsBefore = wbBefore.sheets(\"BlankReq\")\nDim answer\nDim NewName As String\nApplication.ScreenUpdating = False\n\n    ws.Select 'Goes to template worksheet\n\n\n    ws.Copy Before:=wsBefore ' Forces a copy to be made always before the template so it is always at the end    \nsheets(\"BlankReq (2)\").Select\nsheets(\"BlankReq (2)\").Name = \"Enter Req Number\" ' changes the name to indicate a requisition number needs to be entered\nRange(\"A1\").Select ' hyperlink goes back  Master Req index page\nSelection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True\n\nApplication.ScreenUpdating = True\n\nsheets(\"Enter Req Number\").Select\nanswer = MsgBox(\"Please rename the sheet with the Requisition number\", vbOK)\n\n    If answer = vbOK Then\n\nAnother:\n    NewName = InputBox(\"Requisition number - ?\")\n    ActiveSheet.Name = NewName\n\n    Range(\"D2\").Select\n    NewName = InputBox(\"Requisition Description- NO SPACES!! USE UNDERSCORE ?\")\n    Range(\"D2\").Value = NewName\n    wsBefore.Select\n\n    Range(\"H2\").Select\n    NewName = InputBox(\"Please enter Requested By \")\n    Range(\"H2\").Value = NewName\n    wsBefore.Select\n    answer = MsgBox(\"Please select your data to copy and paste into this sheet. Line Cost must be selected seperately from the items.\", vbOKOnly)\n\n    End If\n\nEnd Sub\n\n\nSub Filldown()\nDim strFormulas(1 To 6) As Variant\nDim wb As Workbook: Set wb = ThisWorkbook\nDim ws As Worksheet: Set ws = wb.ActiveSheet\nDim wbBefore As Workbook: Set wbBefore = Application.Workbooks(\"OPP StoresOrders Macro.xlsm\")\nDim wsBefore As Worksheet: Set wsBefore = wbBefore.sheets(\"BlankReq\")\nDim LRow As Long\nDim xRow As Variant\nApplication.ScreenUpdating = False\n\n        With ThisWorkbook.sheets(\"Requisitions\")\n        Range(\"A1\").Select\n        Columns(\"B:K\").Select\n        Selection.SpecialCells(xlCellTypeBlanks).Select\n        Selection.FormulaR1C1 = \"=R[-1]C\"\n        End With\n\n\n\n\nApplication.ScreenUpdating = True\n\nEnd Sub \n</code></pre>\n"}, {"tags": ["excel", "ms-access-2010", "vba"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1513780474, "post_id": 47908230, "comment_id": 82783910, "body": "what&#39;s your sql?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1513781218, "post_id": 47908230, "comment_id": 82784452, "body": "It&#39;s because of reason(s) that this is happening. If you give us more information, like your append query and the VBA I can almost definitely elaborate. If the append is getting data from other tables, then we may need some sample data from those tables to understand the logic."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9123154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecda6c41b9247a8b1e663411d75b6969?s=128&d=identicon&r=PG&f=1", "display_name": "itnetmgr", "link": "https://stackoverflow.com/users/9123154/itnetmgr"}, "is_accepted": false, "score": 0, "last_activity_date": 1513783278, "creation_date": 1513783278, "answer_id": 47909287, "question_id": 47908230, "link": "https://stackoverflow.com/questions/47908230/running-append-query-from-excel-vba/47909287#47909287", "title": "Running &#39;Append Query&#39; from EXCEL-VBA", "body": "<p>I've managed to resolve the problem. The issue was using 'Wildcards' in the criteria. In Access 2010 you use the star symbol \"*\", however, if you run the Access Query from EXCEL-VBA you need to change the wildcard to a percent symbol \"%\" instead.</p>\n\n<p>Example: Not Like \"Engla*\" needs to be Not Like \"Engla%\".</p>\n"}], "owner": {"reputation": 1, "user_id": 9123154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecda6c41b9247a8b1e663411d75b6969?s=128&d=identicon&r=PG&f=1", "display_name": "itnetmgr", "link": "https://stackoverflow.com/users/9123154/itnetmgr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 336, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1513783278, "creation_date": 1513780110, "last_edit_date": 1531164843, "question_id": 47908230, "link": "https://stackoverflow.com/questions/47908230/running-append-query-from-excel-vba", "title": "Running &#39;Append Query&#39; from EXCEL-VBA", "body": "<p>I have created an 'Append Query' in Access 2010, with a set of criteria and set number of records are created. However, when I run the same 'Append Query' from EXCEL-VBA I get a different number of records?</p>\n"}, {"tags": ["vba", "ms-word", "type-conversion"], "comments": [{"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 1, "creation_date": 1513781112, "post_id": 47908217, "comment_id": 82784376, "body": "So far you do not open the files before you append them to your main doc. YOu will have to do this. Then - presuming you only have one header/footer - you can read header and footer into variables like this: <code>head = doc.Sections(1).Headers(wdHeaderFooterPrimary).Range.text</code> and <code>foot = ActiveDocument.Sections(1).Footers(wdHeaderFooterPrimary).Ra&zwnj;&#8203;nge.text</code> and insert these texts before respectively after you <code>.InsertFile</code>.  Is that what you need?"}, {"owner": {"reputation": 239, "user_id": 8694771, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1a50a0a397596ba0cbae4ca65826ea0?s=128&d=identicon&r=PG&f=1", "display_name": "Harley", "link": "https://stackoverflow.com/users/8694771/harley"}, "reply_to_user": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1513781543, "post_id": 47908217, "comment_id": 82784711, "body": "Yes, i need this logic! Because in the header part i have got for example the date part what i need and of course it is different in all word documents. How is it looking in the code? Can you write an answer? And I can try it and accept it!"}], "answers": [{"comments": [{"owner": {"reputation": 239, "user_id": 8694771, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1a50a0a397596ba0cbae4ca65826ea0?s=128&d=identicon&r=PG&f=1", "display_name": "Harley", "link": "https://stackoverflow.com/users/8694771/harley"}, "edited": false, "score": 0, "creation_date": 1513842017, "post_id": 47909664, "comment_id": 82807696, "body": "There is an error in this code, it is not running :S"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "reply_to_user": {"reputation": 239, "user_id": 8694771, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1a50a0a397596ba0cbae4ca65826ea0?s=128&d=identicon&r=PG&f=1", "display_name": "Harley", "link": "https://stackoverflow.com/users/8694771/harley"}, "edited": false, "score": 0, "creation_date": 1513851141, "post_id": 47909664, "comment_id": 82812751, "body": "On line <code>Set doc = Documents.Open(strFile)</code>, right? Yeah, I forgot to add the path before the file name. Try again, see edited code line above."}], "tags": [], "owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "is_accepted": false, "score": 0, "last_activity_date": 1513851092, "last_edit_date": 1513851092, "creation_date": 1513784421, "answer_id": 47909664, "question_id": 47908217, "link": "https://stackoverflow.com/questions/47908217/how-to-convert-a-word-file-to-txt-with-different-header/47909664#47909664", "title": "How to convert a WORD file to .txt with different header?", "body": "<p>This is not fully tested but should get you going.</p>\n\n<p>I have only altered your Do loop. Replace, try out and have fun:</p>\n\n<pre><code>Dim doc As Document\nDim head As String, foot As String\n\nDo Until strFile = \"\"\n    Set doc = Documents.Open(strFolder &amp; strFile)\n    head = doc.Sections(1).Headers(wdHeaderFooterPrimary).Range.text\n    foot = doc.Sections(1).Footers(wdHeaderFooterPrimary).Range.text\n    doc.Close False\n\n    Count = Count + 1\n    Set rng = MainDoc.Range\n    With rng\n        .Collapse wdCollapseEnd\n        If Count &gt; 1 Then\n            .InsertBreak wdSectionBreakNextPage\n            .End = MainDoc.Range.End\n            .Collapse wdCollapseEnd\n        End If\n        .InsertAfter head\n        .InsertParagraphAfter\n        .InsertFile strFolder &amp; strFile\n        .InsertAfter foot\n    End With\n    strFile = Dir$()\nLoop\n</code></pre>\n"}], "owner": {"reputation": 239, "user_id": 8694771, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1a50a0a397596ba0cbae4ca65826ea0?s=128&d=identicon&r=PG&f=1", "display_name": "Harley", "link": "https://stackoverflow.com/users/8694771/harley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513851092, "creation_date": 1513780077, "last_edit_date": 1513842682, "question_id": 47908217, "link": "https://stackoverflow.com/questions/47908217/how-to-convert-a-word-file-to-txt-with-different-header", "title": "How to convert a WORD file to .txt with different header?", "body": "<p>I have got a lot of word file (~5000) with different header what i read with a macro and merge these multiple word document placed in a folder into one document. </p>\n\n<p>Here the relevant code: </p>\n\n<pre><code>Sub MergeDocs() \n    Dim rng As Range \n    Dim MainDoc As Document \n    Dim strFile As String, strFolder As String \n    Dim Count As Long \n    With Application.FileDialog(msoFileDialogFolderPicker) \n        .Title = \"Pick folder\" \n        .AllowMultiSelect = False \n        If .Show Then \n            strFolder = .SelectedItems(1) &amp; Application.PathSeparator \n        Else \n            Exit Sub \n        End If \n    End With \n    Set MainDoc = Documents.Add \n    strFile = Dir$(strFolder &amp; \"*.doc\") ' can change to .docx\n    Count = 0 \n    Do Until strFile = \"\" \n        Count = Count + 1 \n        Set rng = MainDoc.Range \n        With rng \n            .Collapse wdCollapseEnd \n            If Count &gt; 1 Then \n                .InsertBreak wdSectionBreakNextPage \n                .End = MainDoc.Range.End \n                .Collapse wdCollapseEnd \n            End If \n            .InsertFile strFolder &amp; strFile \n        End With \n        strFile = Dir$() \n    Loop \n    MsgBox (\"Files are merged\") \nlbl_Exit: \n    Exit Sub \nEnd Sub \n</code></pre>\n\n<p>It is working, but when I am trying to save file as .txt, the header+footer lose..is it any way which one I can save this header part to a .txt file too? (as I wrote, in every document has got different header.)</p>\n\n<p>EDIT:</p>\n\n<pre><code>Sub MergeDocs()\n    Dim rng As Range\n    Dim MainDoc As Document\n    Dim strFile As String, strFolder As String\n    Dim Count As Long\n    With Application.FileDialog(msoFileDialogFolderPicker)\n        .Title = \"Pick folder\"\n        .AllowMultiSelect = False\n        If .Show Then\n            strFolder = .SelectedItems(1) &amp; Application.PathSeparator\n        Else\n            Exit Sub\n        End If\n    End With\n    Set MainDoc = Documents.Add\n    strFile = Dir$(strFolder &amp; \"*.doc\") ' can change to .docx\n    Count = 0\n    Dim doc As Document\n    Dim head As String, foot As String\n\n    Do Until strFile = \"\"\n        Set doc = Documents.Open(strFile)\n        head = doc.Sections(1).Headers(wdHeaderFooterPrimary).Range.Text\n        foot = doc.Sections(1).Footers(wdHeaderFooterPrimary).Range.Text\n        doc.Close False\n\n        Count = Count + 1\n        Set rng = MainDoc.Range\n        With rng\n            .Collapse wdCollapseEnd\n            If Count &gt; 1 Then\n                .InsertBreak wdSectionBreakNextPage\n                .End = MainDoc.Range.End\n                .Collapse wdCollapseEnd\n        End If\n        .InsertAfter head\n        .InsertParagraphAfter\n        .InsertFile strFolder &amp; strFile\n        .InsertAfter foot\n    End With\n    strFile = Dir$()\nLoop\n    MsgBox (\"Files are merged\")\nlbl_Exit:\n    Exit Sub\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1513780414, "post_id": 47908164, "comment_id": 82783872, "body": "In your loop use COUNTIF to count the number of Ys and delete the row if equals zero."}], "answers": [{"comments": [{"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 13, "user_id": 8971723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98d0811b58549198b274e97a288b6101?s=128&d=identicon&r=PG&f=1", "display_name": "KyleC", "link": "https://stackoverflow.com/users/8971723/kylec"}, "edited": false, "score": 0, "creation_date": 1513781204, "post_id": 47908534, "comment_id": 82784444, "body": "@KyleC please could you mark my response as an answer? Thanks."}, {"owner": {"reputation": 13, "user_id": 8971723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98d0811b58549198b274e97a288b6101?s=128&d=identicon&r=PG&f=1", "display_name": "KyleC", "link": "https://stackoverflow.com/users/8971723/kylec"}, "edited": false, "score": 0, "creation_date": 1513782776, "post_id": 47908534, "comment_id": 82785557, "body": "sure thing I hit the check box so if it&#39;s not appeared as answered let me know, Thanks again."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 2, "last_activity_date": 1513781024, "creation_date": 1513781024, "answer_id": 47908534, "question_id": 47908164, "link": "https://stackoverflow.com/questions/47908164/deleting-rows-in-excel-that-contain-a-single-letter-in-multiple-cells-across-a-r/47908534#47908534", "title": "Deleting rows in excel that contain a single letter in multiple cells across a row", "body": "<p>This would do the job at hand, even though I'm sure it could be further optimized:</p>\n\n<pre><code>Sub foo()\n    Dim lRow As Long\n    Dim iCntr As Long\n    lRow = 112\n    For iCntr = lRow To 1 Step -1\n        For i = 5 To 27 Step 2\n        If Cells(iCntr, i).Value = \"N\" Then\n            Value = Value &amp; \" Delete\"\n        Else\n            Value = Value &amp; \" Keep\"\n        End If\n        Next i\n\n        If Not InStr(Value, \"Keep\") &gt; 0 Then\n            Rows(iCntr).Delete\n        End If\n        Value = \"\"\n    Next iCntr\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 1, "last_activity_date": 1513784046, "last_edit_date": 1513784046, "creation_date": 1513781610, "answer_id": 47908718, "question_id": 47908164, "link": "https://stackoverflow.com/questions/47908164/deleting-rows-in-excel-that-contain-a-single-letter-in-multiple-cells-across-a-r/47908718#47908718", "title": "Deleting rows in excel that contain a single letter in multiple cells across a row", "body": "<p>To do it using formula, filtering and copy/paste: </p>\n\n<p>Add this formula to each row: <code>=COUNTIF($E2:$AA2,\"Y\")</code><br>\nThis will count the cells containing a single Y on it's own.</p>\n\n<p>Add a filter across your data and filter to exclude <code>0</code> on the formula.  </p>\n\n<p>Copy and paste the filtered dataset to a new worksheet.  You could then clear the original data and re-paste over it.  Useful if you're only doing this once. </p>\n\n<p><strong>Edit:</strong>  </p>\n\n<p>To do the above procedure in VBA (but doing the delete in place rather than move to a second sheet):  </p>\n\n<pre><code>Public Sub Test()\n\n    Dim rDataRange As Range\n\n    'Define range to look at.  NB:  This is a basic set-up.\n    'Real scenario would allow user to make selection, or find the limits of the dataset with a FindLastCell function.\n    Set rDataRange = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"E1:AA112\")\n\n    'This block will remove any autofilters that already exist, and then put a formula to the right of the dataset\n    'to count the Y.\n    With rDataRange\n        .Parent.AutoFilterMode = False\n        .Offset(1, .Columns.Count).Resize(.Rows.Count - 1, 1).FormulaR1C1 = \"=COUNTIF(RC5:RC27,\"\"Y\"\")\"\n    End With\n\n    With rDataRange\n        'This block filters the dataset to only show 0 in the formula.\n        'The dataset is resized to include the formula.\n        With .Resize(, .Columns.Count + 1)\n            .AutoFilter Field:=rDataRange.Columns.Count + 1, Criteria1:=\"0\"\n            .Offset(1).Resize(.Rows.Count - 1).SpecialCells(xlVisible).EntireRow.Delete 'Resized again to exclude the header.\n        End With\n\n        'The formula and filter are removed.\n        .Offset(1, .Columns.Count).Resize(.Rows.Count - 1, 1).ClearContents\n        .Parent.AutoFilterMode = False\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8971723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98d0811b58549198b274e97a288b6101?s=128&d=identicon&r=PG&f=1", "display_name": "KyleC", "link": "https://stackoverflow.com/users/8971723/kylec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "accepted_answer_id": 47908534, "answer_count": 2, "score": 0, "last_activity_date": 1513784046, "creation_date": 1513779889, "last_edit_date": 1531161705, "question_id": 47908164, "link": "https://stackoverflow.com/questions/47908164/deleting-rows-in-excel-that-contain-a-single-letter-in-multiple-cells-across-a-r", "title": "Deleting rows in excel that contain a single letter in multiple cells across a row", "body": "<p>I was wondering if there was a solution to this just through a formula or shortcuts or if it was something I would need to use VBA for. The spreadsheet I am working with contains 112 rows, 31 columns, and 33 rows containing a \"Y\" (Y=positive for the purpose of the report this is being used for). I am trying to delete rows that do not contain a single \"Y\" all the way across the row(columns E-AA) so only the rows and names of people containing a \"Y\" somewhere in the row are left in the spread sheet. I found a snippet of VBA code from someone else that produced somewhat successful results but didn't include every row with a \"Y\" (I counted 33 rows containing a Y, the VBA code only showed 14). </p>\n\n<p><a href=\"https://i.stack.imgur.com/nfOyp.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nfOyp.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The code I was using:</p>\n\n<pre><code>Sub sbDelete_Rows_IF_Cell_Contains_String_Text_Value()\n    Dim lRow As Long\n    Dim iCntr As Long\n    lRow = 112\n    For iCntr = lRow To 1 Step -1\n        If Cells(iCntr, 5).Value = \"N\" Then\n            Rows(iCntr).Delete\n        End If\n    Next\n    End Sub\n</code></pre>\n\n<p>The above code produced these results:</p>\n\n<p><a href=\"https://i.stack.imgur.com/iFHUi.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iFHUi.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The columns of interest containing either a \"Y\" or \"N\" in their cells are columns E through AA. If I wasn't clear enough or need to go further into detail just let me know. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1513779897, "post_id": 47908094, "comment_id": 82783526, "body": "If you were to share at least an image of what the layout of your spreadsheet is, then it would be a lot easier to formulate an answer..."}], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1513781178, "creation_date": 1513781178, "answer_id": 47908578, "question_id": 47908094, "link": "https://stackoverflow.com/questions/47908094/how-can-i-create-a-list-that-counts-and-displays-instances-of-of-duplicates-acro/47908578#47908578", "title": "How can I create a list that counts and displays instances of of duplicates across multiple sheets in Excel?", "body": "<p>Assuming that the list of components is in the same column in each of the other sheets (lets say \"X\" for that column) Then copy column X in each sheet (except the first) into one column in the first sheet and then delete duplicates - the result is a unique list. </p>\n\n<pre><code>Sub Assembly()\n  Dim ws As Worksheet\n  Dim y As Integer\nDim t As Range\n  For y = 2 To Worksheets.Count\n  Set t = Worksheets(1).Range(Rows.Count, 1).End(xlUp).Offset(1, 0) 'first blankcell in column A\n   Application.Intersect(Worksheets(y).Range(\"X:X\"), Worksheets(y).UsedRange).Copy t\nNext y\nWorksheets(1).Range(\"A:A\").RemoveDuplicates Columns:=1\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9123090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e76551fa1c78b581da80e34ab064409?s=128&d=identicon&r=PG&f=1", "display_name": "TastyChevelle", "link": "https://stackoverflow.com/users/9123090/tastychevelle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1513781178, "creation_date": 1513779657, "last_edit_date": 1531161705, "question_id": 47908094, "link": "https://stackoverflow.com/questions/47908094/how-can-i-create-a-list-that-counts-and-displays-instances-of-of-duplicates-acro", "title": "How can I create a list that counts and displays instances of of duplicates across multiple sheets in Excel?", "body": "<p>my goal is ultimately to create a list of bolts in the first sheet that updates itself as I populate other sheets in the same document. The other sheets are for different assemblies for a machine. There are a bunch of different bolts that I have to measure for in cad so it would be nice to have a self populating list as I go through each assembly one by one.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9122951, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IkyHjOR8790/AAAAAAAAAAI/AAAAAAAAAmo/g724BeSVkaw/photo.jpg?sz=128", "display_name": "Keerthi Hari", "link": "https://stackoverflow.com/users/9122951/keerthi-hari"}, "edited": false, "score": 0, "creation_date": 1513783762, "post_id": 47907955, "comment_id": 82786203, "body": "I get a run-time error in line 5 with the message object required. I&#39;m new to this."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 1, "user_id": 9122951, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IkyHjOR8790/AAAAAAAAAAI/AAAAAAAAAmo/g724BeSVkaw/photo.jpg?sz=128", "display_name": "Keerthi Hari", "link": "https://stackoverflow.com/users/9122951/keerthi-hari"}, "edited": false, "score": 0, "creation_date": 1513784023, "post_id": 47907955, "comment_id": 82786360, "body": "The error you are getting is because you probably don&#39;t have a Sheet3 in your spreadsheet, so changing the names to the actual ones you have in your spreadsheet will make it so that the code works as expected."}, {"owner": {"reputation": 1, "user_id": 9122951, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IkyHjOR8790/AAAAAAAAAAI/AAAAAAAAAmo/g724BeSVkaw/photo.jpg?sz=128", "display_name": "Keerthi Hari", "link": "https://stackoverflow.com/users/9122951/keerthi-hari"}, "edited": false, "score": 0, "creation_date": 1513784418, "post_id": 47907955, "comment_id": 82786641, "body": "The data is in sheet 1 and the summary should go to sheet 3 which I created as per your code."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 1, "user_id": 9122951, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IkyHjOR8790/AAAAAAAAAAI/AAAAAAAAAmo/g724BeSVkaw/photo.jpg?sz=128", "display_name": "Keerthi Hari", "link": "https://stackoverflow.com/users/9122951/keerthi-hari"}, "edited": false, "score": 0, "creation_date": 1513784593, "post_id": 47907955, "comment_id": 82786773, "body": "I&#39;ve updated my answer, just make sure you add the space between Sheet and the number 1 if that&#39;s how your sheet is named when looking at the tabs on the bottom of your excel file. The same with Sheet3 if it is Sheet 3."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1513785110, "post_id": 47907955, "comment_id": 82787119, "body": "might be simpler if you make the worksheets as dims, ie <code>dim ws1 as worksheet: ws1 = Sheets(&quot;sheet name&quot;)</code> so that they don&#39;t have to replace it everywhere"}, {"owner": {"reputation": 1, "user_id": 9122951, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IkyHjOR8790/AAAAAAAAAAI/AAAAAAAAAmo/g724BeSVkaw/photo.jpg?sz=128", "display_name": "Keerthi Hari", "link": "https://stackoverflow.com/users/9122951/keerthi-hari"}, "edited": false, "score": 0, "creation_date": 1513785222, "post_id": 47907955, "comment_id": 82787205, "body": "Thank you so much! It helped a lot :)"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 0, "last_activity_date": 1513785946, "last_edit_date": 1513785946, "creation_date": 1513779181, "answer_id": 47907955, "question_id": 47907666, "link": "https://stackoverflow.com/questions/47907666/excel-copy-adjacent-values-of-a-selected-column-with-no-entries-in-the-cells/47907955#47907955", "title": "Excel copy adjacent values of a selected column with no entries in the cells", "body": "<p>This will do what you want, simply change the Sheet numbers to reflect the Sheets you are using (I am using Sheet1 as the sheet with the data and Sheet3 to where the summary data should be placed) these Sheet names are their coded version and not their name on the bottom tab on excel:</p>\n\n<pre><code>Sub foo()\nLastRow = Sheet1.Cells(Sheet1.Rows.Count, \"A\").End(xlUp).Row 'change Sheet1 to your sheet ie. Sheets(\"Sheet1\")\nFor i = 2 To LastRow\n    If Sheet1.Cells(i, 4).Value = \"\" Then\n        NextEmptyRow = Sheet3.Cells(Sheet3.Rows.Count, \"A\").End(xlUp).Row + 1\n        Sheet3.Cells(NextEmptyRow, 1).Value = Sheet1.Cells(i, 1).Value\n        Sheet3.Cells(NextEmptyRow, 2).Value = Sheet1.Cells(i, 2).Value\n    End If\nNext i\nEnd Sub\n</code></pre>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>If you are referring to the Sheets by their name in the bottom tab of excel then you should change the code above for this one:</p>\n\n<pre><code>Sub foo()\nDim ws1 As Worksheet: Set ws1 = Sheets(\"Sheet1\") 'change the name of your sheets here\nDim ws2 As Worksheet: Set ws2 = Sheets(\"Sheet3\")\nLastRow = ws1.Cells(ws1.Rows.Count, \"A\").End(xlUp).Row \nFor i = 2 To LastRow\n    If ws1.Cells(i, 4).Value = \"\" Then\n        NextEmptyRow = ws2.Cells(ws2.Rows.Count, \"A\").End(xlUp).Row + 1\n        ws2.Cells(NextEmptyRow, 1).Value = ws1.Cells(i, 1).Value\n        ws2.Cells(NextEmptyRow, 2).Value = ws1.Cells(i, 2).Value\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1513786379, "creation_date": 1513786379, "answer_id": 47910241, "question_id": 47907666, "link": "https://stackoverflow.com/questions/47907666/excel-copy-adjacent-values-of-a-selected-column-with-no-entries-in-the-cells/47910241#47910241", "title": "Excel copy adjacent values of a selected column with no entries in the cells", "body": "<p>Here is using filter on column D provided you set your data up with a filter.</p>\n\n<pre><code>Sub CopyData()\n\n    Dim wb As Workbook\n    Dim wsSource As Worksheet\n    Dim wsTarget As Worksheet\n\n   Set wb = ThisWorkbook\n   Set wsSource = wb.Worksheets(\"Source\") ' change as appropriate\n   Set wsTarget = wb.Worksheets(\"Target\") ' change as appropriate\n\n        With wsSource\n            .ListObjects(\"Table1\").AutoFilter.ShowAllData\n            .ListObjects(\"Table1\").Range.AutoFilter Field:=4, Criteria1:=\"=\"\n            .AutoFilter.Range.Columns(\"A:B\").Copy wsTarget.Range(\"A1\")\n       End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9122951, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IkyHjOR8790/AAAAAAAAAAI/AAAAAAAAAmo/g724BeSVkaw/photo.jpg?sz=128", "display_name": "Keerthi Hari", "link": "https://stackoverflow.com/users/9122951/keerthi-hari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 47907955, "answer_count": 2, "score": -6, "last_activity_date": 1513786379, "creation_date": 1513778244, "last_edit_date": 1513778271, "question_id": 47907666, "link": "https://stackoverflow.com/questions/47907666/excel-copy-adjacent-values-of-a-selected-column-with-no-entries-in-the-cells", "title": "Excel copy adjacent values of a selected column with no entries in the cells", "body": "<pre><code>A      B      C        D\n\n1     ...     1        2\n\n2     ...    1.2       \n\n3     ...    1.9\n\n4     ...    1.1       4\n\n5     ...     1        3\n\n6     ...     1\n\n7     ...     1        5\n\n8     ...     3\n</code></pre>\n\n<p>The function I need should search through col D and find all rows with no entries and then copy the corresponding values from col A and col B to another sheet.</p>\n\n<p>For example in this dummy code, A2,A3,A6,A8 and B2,B3,B6,B8 have to copied to a new sheet.</p>\n\n<p>I tried using vlookup and index command but it only gets the value of the first entries and dragging it down doesn't work.</p>\n"}, {"tags": ["excel", "vba", "find", "structure", "user-defined-types"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1513777411, "post_id": 47907320, "comment_id": 82781881, "body": "That should work fine, is there additional code?  If so what happens if you create a new workbook and use what you have posted (and a dim) on its own?"}], "owner": {"reputation": 61, "user_id": 9122918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c04c3e9afc96482e2d200126b91213b?s=128&d=identicon&r=PG&f=1", "display_name": "Cristina K", "link": "https://stackoverflow.com/users/9122918/cristina-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1513777034, "creation_date": 1513777034, "question_id": 47907320, "link": "https://stackoverflow.com/questions/47907320/find-a-structure-member", "title": "Find a Structure member", "body": "<p>I am trying to use the method \"Find\" to find (haha) a member of a structure type defined by me. </p>\n\n<pre><code>Public Type Repuesto\n    Codigo As Integer\n    Almacen As Integer\n    EnMano As Integer\n    EnOrden As Integer\nEnd Type\n</code></pre>\n\n<p>I have created a structure array called \"MisRepuestos\", filling all the \"Codigo\" members. After that I tried to do this:</p>\n\n<pre><code>Cells.Find(What:=MisRepuestos_1(1).Codigo).Activate\n</code></pre>\n\n<p>So, here's when excel stops working and restarts... Any ideas about why this might be happening? I have already checked that the array members are actually filled with an integer by printing them.  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1513776054, "post_id": 47906965, "comment_id": 82780989, "body": "Have you checked how long it takes?"}, {"owner": {"reputation": 58, "user_id": 8482598, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5133b545defe9913bfafc13de45673c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leighholling", "link": "https://stackoverflow.com/users/8482598/leighholling"}, "reply_to_user": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1513776159, "post_id": 47906965, "comment_id": 82781068, "body": "to run once takes around 2 minutes but times that by 18 eventually will be a very long time"}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1513776160, "post_id": 47906965, "comment_id": 82781069, "body": "<code>ws1.Cells(ws1.Rows.Count, 1).End(xlUp).Row</code> (and for ws2) these values don&#39;t change so I would store them in variables."}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1513776194, "post_id": 47906965, "comment_id": 82781093, "body": "It won&#39;t necessarily take 18 times as long."}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1513776304, "post_id": 47906965, "comment_id": 82781153, "body": "I would also store range references for things like <code>ws3.Cells(iRow, iCol)</code> rather than reevaluating it each time. This applies to a lot of your statements. Then use Offset to navigate relative to these references."}, {"owner": {"reputation": 58, "user_id": 8482598, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5133b545defe9913bfafc13de45673c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leighholling", "link": "https://stackoverflow.com/users/8482598/leighholling"}, "reply_to_user": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1513776396, "post_id": 47906965, "comment_id": 82781215, "body": "ws3 is going to be a different sheet everytime round there will be 18 different ws3"}, {"owner": {"reputation": 58, "user_id": 8482598, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5133b545defe9913bfafc13de45673c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leighholling", "link": "https://stackoverflow.com/users/8482598/leighholling"}, "reply_to_user": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1513776463, "post_id": 47906965, "comment_id": 82781258, "body": "example first time it looks for National insurance number differences, then put that on the National insurance differences sheet(ws3) then. It will look for Date of birth differences and put all them in separate sheet"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1513777439, "post_id": 47906965, "comment_id": 82781901, "body": "Code optimization belongs on <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a> it is too broad for this forum."}, {"owner": {"reputation": 58, "user_id": 8482598, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5133b545defe9913bfafc13de45673c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leighholling", "link": "https://stackoverflow.com/users/8482598/leighholling"}, "edited": false, "score": 0, "creation_date": 1513778409, "post_id": 47906965, "comment_id": 82782548, "body": "thanks added it to there."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1513781062, "post_id": 47906965, "comment_id": 82784336, "body": "Do you have a sample workbook you can share?"}], "answers": [{"comments": [{"owner": {"reputation": 58, "user_id": 8482598, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5133b545defe9913bfafc13de45673c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leighholling", "link": "https://stackoverflow.com/users/8482598/leighholling"}, "edited": false, "score": 1, "creation_date": 1513776804, "post_id": 47907168, "comment_id": 82781479, "body": "please explain better your code and how it does what im trying to do Sheet A and Sheet B are deleted and recreated everytime it is opened so will never be the same sheet number"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 58, "user_id": 8482598, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5133b545defe9913bfafc13de45673c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leighholling", "link": "https://stackoverflow.com/users/8482598/leighholling"}, "edited": false, "score": 0, "creation_date": 1513776948, "post_id": 47907168, "comment_id": 82781575, "body": "@Leighholling - it does not do what you are trying to do. It just gives an example how to save ranges to array and do the calculations there."}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1513776953, "post_id": 47907168, "comment_id": 82781578, "body": "I don&#39;t think setting to manual calculation is a bad habit, as long as we switch it back to its original state after our processing."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1513777006, "post_id": 47907168, "comment_id": 82781618, "body": "@AndyG - here we think differently. But everyone has his own opinion."}, {"owner": {"reputation": 58, "user_id": 8482598, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5133b545defe9913bfafc13de45673c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leighholling", "link": "https://stackoverflow.com/users/8482598/leighholling"}, "edited": false, "score": 0, "creation_date": 1513777078, "post_id": 47907168, "comment_id": 82781664, "body": "sl1 = ws1.Cells(ws1.Rows.Count, 1).End(xlUp).Row this has shaved about 30% of time off by putting this in a variant"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 58, "user_id": 8482598, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5133b545defe9913bfafc13de45673c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leighholling", "link": "https://stackoverflow.com/users/8482598/leighholling"}, "edited": false, "score": 0, "creation_date": 1513777333, "post_id": 47907168, "comment_id": 82781840, "body": "@Leighholling - and if you put it in a <code>Long</code> it would save about 31% :)"}, {"owner": {"reputation": 183, "user_id": 5678552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jnxw7OpW0jU/AAAAAAAAAAI/AAAAAAAAABU/0V81DiP0m7Y/photo.jpg?sz=128", "display_name": "Clyde", "link": "https://stackoverflow.com/users/5678552/clyde"}, "edited": false, "score": 1, "creation_date": 1513779610, "post_id": 47907168, "comment_id": 82783338, "body": "I tend to agree that setting calculation to manual and screen updating false to be somewhat discouraged.. if the code execution is halted without proper error handling the settings end up stuck.. and in this example they&#39;re not reset, also there are times when the user may have turned them off and here we&#39;re not capturing the beginning state either"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 4, "last_activity_date": 1513780848, "last_edit_date": 1513780848, "creation_date": 1513776573, "answer_id": 47907168, "question_id": 47906965, "link": "https://stackoverflow.com/questions/47906965/how-to-speed-up-this-vba-code/47907168#47907168", "title": "How to speed up this VBA code", "body": "<p>Try to rewrite the your code (it will be a tough job), trying to do the following:</p>\n\n<ul>\n<li>Read the corresponding cells and save them to an array (or multiple arrays for multiple ranges)</li>\n<li>Make all the calculations and conditional evaluations until you receive an array with the results</li>\n<li>Write this array to the worksheet</li>\n</ul>\n\n<hr>\n\n<pre><code>Sub TestMe()\n\n    Dim firstArr        As Variant\n    Dim secondArr       As Variant\n    Dim cnt             As Long\n\n    firstArr = Application.Transpose(Range(\"A1:A20\"))\n    secondArr = Application.Transpose(Range(\"B1:B20\"))\n\n    'Read the corresponding cells and save them to an array\n    'Here instead of reading I am generating them\n    For cnt = LBound(firstArr) To UBound(firstArr)\n        firstArr(cnt) = cnt\n        secondArr(cnt) = cnt * 3\n        Cells(cnt, 1) = firstArr(cnt)\n        Cells(cnt, 2) = secondArr(cnt)\n    Next cnt\n\n    'Make all the calculations until you receive an array with the results\n    For cnt = LBound(firstArr) To UBound(secondArr)\n        firstArr(cnt) = firstArr(cnt) + secondArr(cnt)\n    Next cnt\n\n    'Write this array to the worksheet\n    For cnt = LBound(firstArr) To UBound(secondArr)\n        Cells(cnt, 3) = firstArr(cnt)\n    Next cnt\n\nEnd Sub\n</code></pre>\n\n<p>The performance bonus would be noticeable if you manage to do it.\nAnd as a small (unwanted) advice - do not use this line, some people consider it a bad habit:</p>\n\n<pre><code>Application.Calculation = xlCalculationManual\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 58, "user_id": 8482598, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5133b545defe9913bfafc13de45673c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leighholling", "link": "https://stackoverflow.com/users/8482598/leighholling"}, "edited": false, "score": 0, "creation_date": 1513780364, "post_id": 47907990, "comment_id": 82783825, "body": "this is fab but how do I make it put the results into new sheet at the second row, its a template so will be headers"}, {"owner": {"reputation": 58, "user_id": 8482598, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5133b545defe9913bfafc13de45673c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leighholling", "link": "https://stackoverflow.com/users/8482598/leighholling"}, "edited": false, "score": 0, "creation_date": 1513780480, "post_id": 47907990, "comment_id": 82783922, "body": "done it thanks, now another question for you how can I re use this code to look for different things in different areas so lets say compare column 9 in both sheets and put it in a different sheet"}, {"owner": {"reputation": 183, "user_id": 5678552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jnxw7OpW0jU/AAAAAAAAAAI/AAAAAAAAABU/0V81DiP0m7Y/photo.jpg?sz=128", "display_name": "Clyde", "link": "https://stackoverflow.com/users/5678552/clyde"}, "reply_to_user": {"reputation": 58, "user_id": 8482598, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5133b545defe9913bfafc13de45673c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leighholling", "link": "https://stackoverflow.com/users/8482598/leighholling"}, "edited": false, "score": 0, "creation_date": 1513780494, "post_id": 47907990, "comment_id": 82783929, "body": "on Call PasteArray(...) change [A1] to [A2]"}, {"owner": {"reputation": 183, "user_id": 5678552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jnxw7OpW0jU/AAAAAAAAAAI/AAAAAAAAABU/0V81DiP0m7Y/photo.jpg?sz=128", "display_name": "Clyde", "link": "https://stackoverflow.com/users/5678552/clyde"}, "reply_to_user": {"reputation": 58, "user_id": 8482598, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5133b545defe9913bfafc13de45673c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leighholling", "link": "https://stackoverflow.com/users/8482598/leighholling"}, "edited": false, "score": 0, "creation_date": 1513780601, "post_id": 47907990, "comment_id": 82783996, "body": "you&#39;re fast! on your if statements - the column numbers should remain the same note If Trim(ws1(i, 1)) = Trim(ws2(j, 1)) and If Trim(ws1(i, 17)) &lt;&gt; Trim(ws2(j, 24))   you can set the column numbers within the arrays for ws1 / ws2 the same way you&#39;d reference the cells in your worksheets"}, {"owner": {"reputation": 183, "user_id": 5678552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jnxw7OpW0jU/AAAAAAAAAAI/AAAAAAAAABU/0V81DiP0m7Y/photo.jpg?sz=128", "display_name": "Clyde", "link": "https://stackoverflow.com/users/5678552/clyde"}, "reply_to_user": {"reputation": 58, "user_id": 8482598, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5133b545defe9913bfafc13de45673c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leighholling", "link": "https://stackoverflow.com/users/8482598/leighholling"}, "edited": false, "score": 0, "creation_date": 1513780741, "post_id": 47907990, "comment_id": 82784110, "body": "although for this setup you&#39;d need to include additional arrays for each of the additional sheets you&#39;d like to paste the comparison data into.. and after building the entire array you&#39;d paste it using the call PasteArray(datatopaste, range to paste into)"}, {"owner": {"reputation": 58, "user_id": 8482598, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5133b545defe9913bfafc13de45673c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leighholling", "link": "https://stackoverflow.com/users/8482598/leighholling"}, "edited": false, "score": 0, "creation_date": 1513780879, "post_id": 47907990, "comment_id": 82784207, "body": "I have figured it out you sir are a genius running time is a few second I have just changed the (I,17) and (I, 24) edited this line and it pastes the data into a separate sheet    Call PasteArray(transposeArray(ws3), ActiveWorkbook.Sheets(&quot;DoB Differences&quot;).[A2])"}, {"owner": {"reputation": 183, "user_id": 5678552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jnxw7OpW0jU/AAAAAAAAAAI/AAAAAAAAABU/0V81DiP0m7Y/photo.jpg?sz=128", "display_name": "Clyde", "link": "https://stackoverflow.com/users/5678552/clyde"}, "reply_to_user": {"reputation": 58, "user_id": 8482598, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5133b545defe9913bfafc13de45673c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leighholling", "link": "https://stackoverflow.com/users/8482598/leighholling"}, "edited": false, "score": 0, "creation_date": 1513781646, "post_id": 47907990, "comment_id": 82784777, "body": "Excellent! glad to help :)"}], "tags": [], "owner": {"reputation": 183, "user_id": 5678552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jnxw7OpW0jU/AAAAAAAAAAI/AAAAAAAAABU/0V81DiP0m7Y/photo.jpg?sz=128", "display_name": "Clyde", "link": "https://stackoverflow.com/users/5678552/clyde"}, "is_accepted": false, "score": 0, "last_activity_date": 1513779301, "creation_date": 1513779301, "answer_id": 47907990, "question_id": 47906965, "link": "https://stackoverflow.com/questions/47906965/how-to-speed-up-this-vba-code/47907990#47907990", "title": "How to speed up this VBA code", "body": "<p>In the spirit of what Vityata is talking about (rewrite your code to use arrays) and not completely sure what your data looks like you could use something like this:</p>\n\n<pre><code> Sub NINODifferences()\n\nDim ws1 As Variant, ws2 As Variant, ws3 As Variant\nDim i As Long, j As Long\n\nws1 = ActiveWorkbook.Sheets(\"SheetA\").UsedRange\nws2 = ActiveWorkbook.Sheets(\"SheetB\").UsedRange\nReDim ws3(4, 0)\n    For i = 1 To UBound(ws1)\n        For j = 1 To UBound(ws2)\n            If Trim(ws1(i, 1)) = Trim(ws2(j, 1)) Then\n                If Trim(ws1(i, 17)) &lt;&gt; Trim(ws2(j, 24)) Then\n                    ReDim Preserve ws3(4, count)\n                    ws3(0, count) = ws1(i, 1)\n                    ws3(1, count) = ws1(i, 2)\n                    ws3(2, count) = ws1(i, 3)\n                    ws3(3, count) = ws1(i, 17)\n                    ws3(4, count) = ws2(i, 24)\n                    count = count + 1\n                End If\n            End If\n        Next j\n   Next i\nCall PasteArray(transposeArray(ws3), ActiveWorkbook.Sheets(\"NINO Differences\").[A1])\nSet ws1 = Nothing\nSet ws2 = Nothing\n\nEnd Sub\n\nSub PasteArray(data As Variant, rng As Range)\n    rng.Resize(UBound(data, 1) + 1, UBound(data, 2) + 1) = data\nEnd Sub\n\nFunction transposeArray(data)\nIf IsEmpty(data) Then Exit Function\nReDim r(UBound(data, 2), UBound(data))\nFor i = LBound(r) To UBound(r)\n    For j = LBound(r, 2) To UBound(r, 2)\n        r(i, j) = data(j, i)\n    Next j\nNext i\ntransposeArray = r\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 58, "user_id": 8482598, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5133b545defe9913bfafc13de45673c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leighholling", "link": "https://stackoverflow.com/users/8482598/leighholling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1513780848, "creation_date": 1513775899, "last_edit_date": 1513776910, "question_id": 47906965, "link": "https://stackoverflow.com/questions/47906965/how-to-speed-up-this-vba-code", "title": "How to speed up this VBA code", "body": "<p>in this code looking at 2 worksheets that contain similar data from different systems. Column 1 contains a unique staff number so there can be a match on the person then here there is a difference in NiNo <code>ws1.cell(,17) and ws2.cell(,24)</code> between the sheets then certain values for that person are copied to a 3rd sheet.</p>\n\n<p>How ever there are to be 18 different worksheets all looking at different criteria, so this code will have to run 18 times and will take a while. any ideas how I can speed it up examples please</p>\n\n<pre><code> Sub NINODifferences()\n\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n\n    Dim ws1 As Worksheet, ws2 As Worksheet, ws3 As Worksheet, ws4 As Worksheet\n    Dim i As Long, j As Long, iCol As Long, iRow As Long\n\n\n    Set ws1 = ActiveWorkbook.Sheets(\"SheetA\")\n    Set ws2 = ActiveWorkbook.Sheets(\"SheetB\")\n    Set ws3 = ActiveWorkbook.Sheets(\"NINO Differences\")\n\n\n    iRow = 2\n    iCol = 1\n\n        For i = 1 To ws1.Cells(ws1.Rows.Count, 1).End(xlUp).Row\n            For j = 1 To ws2.Cells(ws2.Rows.Count, 1).End(xlUp).Row\n\n                If Trim(ws1.Cells(i, 1).Value2) = Trim(ws2.Cells(j, 1).Value2) Then\n\n                    If Trim(ws1.Cells(i, 17).Value2) &lt;&gt; Trim(ws2.Cells(j, 24).Value2) Then\n\n                        ws3.Cells(iRow, iCol).Value2 = ws1.Cells(i, 1).Value2\n                        iCol = iCol + 1\n                        ws3.Cells(iRow, iCol).Value2 = ws1.Cells(i, 2).Value2\n                        iCol = iCol + 1\n                        ws3.Cells(iRow, iCol).Value2 = ws1.Cells(i, 3).Value2\n                        iCol = iCol + 1\n                        ws3.Cells(iRow, iCol).Value2 = ws1.Cells(i, 17).Value2\n                        iCol = iCol + 1\n                        ws3.Cells(iRow, iCol).Value2 = ws2.Cells(j, 24).Value2\n\n                        iCol = 1\n                        iRow = iRow + 1\n\n\n                    Else\n                    End If\n\n\n                Else\n                End If\n\n            Next j\n       Next i\n\n    Set ws1 = Nothing\n    Set ws2 = Nothing\n    Set ws3 = Nothing\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9122791, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209374946165089/picture?type=large", "display_name": "Diogo Martins", "link": "https://stackoverflow.com/users/9122791/diogo-martins"}, "edited": false, "score": 0, "creation_date": 1513778354, "post_id": 47907252, "comment_id": 82782513, "body": "Thank you for answer @ErikvonAsmuth  I&#39;ve imported the excel sheet through TransferSpreadsheet function, after that I created my table and inserted the ID&#39;s into my new table with INSERT INTO. All this SQL instructions using Execute. I&#39;m not using linked tables I assume.  Now I&#39;m getting too few parameteres. Expected 1"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 23, "user_id": 9122791, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209374946165089/picture?type=large", "display_name": "Diogo Martins", "link": "https://stackoverflow.com/users/9122791/diogo-martins"}, "edited": false, "score": 0, "creation_date": 1513778491, "post_id": 47907252, "comment_id": 82782599, "body": "Do you assume you&#39;re not using linked tables, or are you not using linked tables? If you&#39;re not using linked tables, how are you interfacing with SQL server?"}, {"owner": {"reputation": 23, "user_id": 9122791, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209374946165089/picture?type=large", "display_name": "Diogo Martins", "link": "https://stackoverflow.com/users/9122791/diogo-martins"}, "edited": false, "score": 0, "creation_date": 1513778761, "post_id": 47907252, "comment_id": 82782776, "body": "I&#39;m not that much into MS-ACCESS, only started working with it for about 2 weeks. What my form does is:  I press a button to find the file to import into a table, after that table is created I do what I did above. I don&#39;t have a database connected to the form, it&#39;s only simple new tables created for this purpose."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 2, "last_activity_date": 1513777578, "last_edit_date": 1513777578, "creation_date": 1513776820, "answer_id": 47907252, "question_id": 47906743, "link": "https://stackoverflow.com/questions/47906743/can-i-run-currentdb-execute-from-ms-access-with-an-sql-server-query-in-it/47907252#47907252", "title": "Can I run CurrentDb.Execute from MS Access with an SQL Server Query in it?", "body": "<p>Your syntax looks like T-SQL, if you're going to use <code>CurrentDb.Execute</code>, you need to use Jet/ACE SQL. That means: specifying ALL tables directly after <code>UPDATE</code>, no <code>CONVERT</code>, no <code>GETDATE()</code>, and <code>&amp;</code> as the preferred concatenation operator.</p>\n\n<pre><code>CurrentDb.Execute \"UPDATE tableA a INNER JOIN tableB b ON a.IdNum = b.ID\" _\n                   &amp; \" SET a.Commentary = 'Date: ' &amp; Date() &amp; ' | FirstName LastName | ID: ' &amp; b.ID \" \n</code></pre>\n\n<p>Note that I assume you're using linked tables, since I don't see a schema specified anywhere.</p>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1513776938, "creation_date": 1513776938, "answer_id": 47907293, "question_id": 47906743, "link": "https://stackoverflow.com/questions/47906743/can-i-run-currentdb-execute-from-ms-access-with-an-sql-server-query-in-it/47907293#47907293", "title": "Can I run CurrentDb.Execute from MS Access with an SQL Server Query in it?", "body": "<p>No. You will need a connection string and a saved or created pass-through query that uses this connection. </p>\n\n<p>Then set the SQL property of this query to your SQL string and execute the query.</p>\n\n<p>Or - if you have the tables linked - do as Erik suggests.</p>\n"}, {"tags": [], "owner": {"reputation": 18393, "user_id": 1879019, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/otzDQ.jpg?s=128&g=1", "display_name": "tomRedox", "link": "https://stackoverflow.com/users/1879019/tomredox"}, "is_accepted": false, "score": 0, "last_activity_date": 1593680292, "creation_date": 1593680292, "answer_id": 62692678, "question_id": 47906743, "link": "https://stackoverflow.com/questions/47906743/can-i-run-currentdb-execute-from-ms-access-with-an-sql-server-query-in-it/62692678#62692678", "title": "Can I run CurrentDb.Execute from MS Access with an SQL Server Query in it?", "body": "<p>You could also use an <a href=\"https://docs.microsoft.com/en-us/sql/ado/guide/data/creating-and-executing-a-simple-command?view=sql-server-ver15\" rel=\"nofollow noreferrer\">ADODB command</a> to pass the query directly to the SQL server.</p>\n<p>You'd want to add some error handling, but something like this will work as a starting point:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub ExecuteStatementOnSqlServer(sql As String)\n\n  Dim cmd As ADODB.Command\n\n  Set cmd = New ADODB.Command\n\n  With cmd\n     .ActiveConnection = bf_sqlServerConnection\n     .CommandType = adCmdText\n     .CommandText = sql\n     .Execute\n  End With\n\n  Set cmd = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9122791, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209374946165089/picture?type=large", "display_name": "Diogo Martins", "link": "https://stackoverflow.com/users/9122791/diogo-martins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1160, "favorite_count": 0, "accepted_answer_id": 47907252, "answer_count": 3, "score": 2, "last_activity_date": 1593680292, "creation_date": 1513775080, "last_edit_date": 1513775225, "question_id": 47906743, "link": "https://stackoverflow.com/questions/47906743/can-i-run-currentdb-execute-from-ms-access-with-an-sql-server-query-in-it", "title": "Can I run CurrentDb.Execute from MS Access with an SQL Server Query in it?", "body": "<p>I have 2 tables, one of them as been imported from an Excel file and therefore i created the 2nd one in order to gather some info from the imported and generate in the end a new Excel Sheet to be imported in another place.</p>\n\n<p>My question here is:\nI have table a with ID's, names, account status, etc.\nThe second table has the ID's imported from table a, and now i want to generate a commentary (a value with the concatenation from the several columns in table a) like this:</p>\n\n<pre><code>DATE: 20/12/2017 | FirstName LastName | ID: 123456\n</code></pre>\n\n<p>For this i prepared by table b with the ID's already and my code in MS ACCESS VBA at the moment is:</p>\n\n<pre><code>CurrentDb.Execute \"UPDATE a \" _\n                   &amp; \" SET a.Commentary = 'Date: ' + CONVERT(nvarchar,GETDATE(),103) + ' | FirstName LastName | ID: ' + b.ID \" _\n                   &amp; \" FROM tableA a \" _\n                   &amp; \" INNER JOIN tableB b \" _\n                   &amp; \"     ON a.IdNum = b.ID\"\n</code></pre>\n\n<p>I don't know why this gives me the error of:</p>\n\n<blockquote>\n  <p>Run-time error '3075': Syntax error (missing operator) in query\n  expression</p>\n</blockquote>\n\n<p>....(the above code)</p>\n\n<p>Tried to modify the code to more VBA language, more MS-Access language but with no luck.</p>\n\n<p>Thank you,\nDiogo</p>\n"}, {"tags": ["vba", "charts", "title", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9122240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3fa6fc90efdbeadd17ab76cbc7747e6?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy", "link": "https://stackoverflow.com/users/9122240/jimmy"}, "is_accepted": false, "score": 0, "last_activity_date": 1513776959, "creation_date": 1513776959, "answer_id": 47907301, "question_id": 47906626, "link": "https://stackoverflow.com/questions/47906626/powerpoint-doesnt-remove-chart-titles/47907301#47907301", "title": "PowerPoint doesn&#39;t remove chart titles", "body": "<p>The solution to my own problem seems to first force the chart titles and then removing them like this</p>\n\n<pre><code>newChart.HasTitle = True\nnewChart.HasTitle = False\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>If newChart.HasTitle = True Then\n        newChart.HasTitle = False\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9122240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3fa6fc90efdbeadd17ab76cbc7747e6?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy", "link": "https://stackoverflow.com/users/9122240/jimmy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513776959, "creation_date": 1513774687, "last_edit_date": 1513774771, "question_id": 47906626, "link": "https://stackoverflow.com/questions/47906626/powerpoint-doesnt-remove-chart-titles", "title": "PowerPoint doesn&#39;t remove chart titles", "body": "<p>I've written this code but the code fails to remove the chart titles when it is run. If I run the code manually using the step-in function it works perfectly. \nI've tried using <code>Application.Wait</code> before the <code>newChart.HasTitle = False</code> line but it doesn't seem to work either. Any ideas?</p>\n\n<pre><code>Sub InsertPieCharts()\nDim xl As Excel.Application\nDim aTB As Table\nDim aSL As Slide\nDim sh As Shape\nDim newChart As Chart\nDim aTX As Shape\nDim chartAreasWidth As Double, chartAreasHeight As Double, firstLeft As Double, chartsHSpace As Double, chartsLeft As Double, chartsTop As Double, firstTop As Double, chartsVSpace As Double, tHeight As Double, tWidth As Double, cWidth As Double, cHeight As Double\nDim r As Integer, c As Integer\n\n'Measures\nchartAreasWidth = 25 'cm\nchartAreasHeight = 4.4 'cm\nfirstLeft = 3.13 'cm\nfirstTop = 13.01 'cm\ntHeight = 1 'cm\ntWidth = 1 'cm\ncWidth = 2.5 'cm\ncHeight = 2.2 'cm\n\n'Objects\nSet xl = CreateObject(\"Excel.Application\")\nSet aSL = ActivePresentation.Slides(16)\n\nFor Each sh In aSL.Shapes\n    If sh.HasTable Then\n        If sh.Table.Cell(1, 1).Shape.TextFrame2.TextRange = \"Datatable\" Then\n            Set aTB = sh.Table\n            Exit For\n        End If\n    End If\nNext sh\n\nchartsHSpace = xl.CentimetersToPoints(chartAreasWidth / (aTB.Columns.Count - 1))\nchartsVSpace = xl.CentimetersToPoints(chartAreasHeight / (aTB.Rows.Count - 2))\nchartsLeft = xl.CentimetersToPoints(firstLeft)\nchartsTop = xl.CentimetersToPoints(firstTop)\ntHeight = xl.CentimetersToPoints(tHeight)\ntWidth = xl.CentimetersToPoints(tWidth)\ncHeight = xl.CentimetersToPoints(cHeight)\ncWidth = xl.CentimetersToPoints(cWidth)\n\n\nFor r = 3 To aTB.Rows.Count\n    For c = 2 To aTB.Columns.Count\n        Set newChart = aSL.Shapes.AddChart2(-1, xlPie, chartsLeft - (cWidth - tWidth) / 2 + cWidth * (c - 2), chartsTop - (cHeight - tHeight) / 2 + cHeight * (r - 3), cWidth, cHeight).Chart\n        With newChart.ChartData.Workbook.Sheets(1)\n            .Cells(1, 2).Value = \"\"\n            .Cells(2, 1).Value = \"Fill\"\n            .Cells(2, 2).Value = aTB.Cell(r, c).Shape.TextFrame2.TextRange * 1\n            .Cells(3, 2).Value = 100 - aTB.Cell(r, c).Shape.TextFrame2.TextRange\n            .Cells(3, 1).Value = \"Unfill\"\n            .Rows(4).Delete\n            .Rows(4).Delete\n        End With\n\n        newChart.ChartData.Workbook.Close\n\n        If newChart.HasTitle = True Then\n            newChart.HasTitle = False\n        End If\n        If newChart.HasLegend = True Then\n            newChart.HasLegend = False\n        End If\n\n        newChart.SeriesCollection(1).Points(1).Format.Fill.ForeColor.RGB = RGB(176, 176, 176)\n        newChart.SeriesCollection(1).Points(2).Format.Fill.Visible = False\n\n\n\n\n        Set aTX = aSL.Shapes.AddTextbox(msoTextOrientationHorizontal, chartsLeft + chartsHSpace * (c - 2), chartsTop + chartsVSpace * (r - 3), tWidth, tHeight)\n        aTX.TextFrame2.TextRange = aTB.Cell(r, c).Shape.TextFrame2.TextRange\n        aTX.TextFrame2.HorizontalAnchor = msoAnchorCenter\n        aTX.TextFrame2.VerticalAnchor = msoAnchorMiddle\n        aTX.AutoShapeType = msoShapeOval\n\n        If aTB.Cell(r, c).Shape.TextFrame2.TextRange &gt; 89.5 Then\n            aTX.TextFrame2.TextRange.Font.Size = 14\n            aTX.TextFrame2.TextRange.Font.Fill.ForeColor.RGB = RGB(255, 255, 255)\n            aTX.Fill.ForeColor.RGB = RGB(47, 105, 151)\n        ElseIf aTB.Cell(r, c).Shape.TextFrame2.TextRange &gt; 79.5 Then\n            aTX.TextFrame2.TextRange.Font.Size = 14\n            aTX.TextFrame2.TextRange.Font.Fill.ForeColor.RGB = RGB(0, 0, 0)\n            aTX.Fill.ForeColor.RGB = RGB(169, 202, 228)\n        ElseIf aTB.Cell(r, c).Shape.TextFrame2.TextRange &gt; 69.5 Then\n            aTX.TextFrame2.TextRange.Font.Size = 14\n            aTX.TextFrame2.TextRange.Font.Fill.ForeColor.RGB = RGB(0, 0, 0)\n            aTX.Fill.ForeColor.RGB = RGB(255, 170, 170)\n        ElseIf aTB.Cell(r, c).Shape.TextFrame2.TextRange &gt;= 0 Then\n            aTX.TextFrame2.TextRange.Font.Size = 14\n            aTX.TextFrame2.TextRange.Font.Fill.ForeColor.RGB = RGB(255, 255, 255)\n            aTX.Fill.ForeColor.RGB = RGB(255, 0, 0)\n        End If\n\n        If aTB.Cell(r, c).Shape.TextFrame2.TextRange &gt; 99.5 Then\n            aTX.TextFrame2.TextRange.Font.Size = 12\n        Else\n            aTX.TextFrame2.TextRange.Font.Size = 14\n        End If\n\n        aTX.Width = tWidth\n        aTX.Height = tHeight\n\n    Next c\nNext r\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "combobox", "vba"], "comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1513774104, "post_id": 47906293, "comment_id": 82779661, "body": "<code>ComboBox</code> doesn&#39;t have <code>RowSource</code> property"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513774300, "post_id": 47906293, "comment_id": 82779804, "body": "What does doesn&#39;t work mean? Are you getting error messages? And is this a userform combobox?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1513774326, "post_id": 47906293, "comment_id": 82779830, "body": "I think the problem may be that your NameRng is not contiguous. Can you try with a contiguous range such as A1:A10?"}, {"owner": {"reputation": 341, "user_id": 8183516, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c68736dde5eadf868d276a2b1b65b76a?s=128&d=identicon&r=PG&f=1", "display_name": "budekatude", "link": "https://stackoverflow.com/users/8183516/budekatude"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513774426, "post_id": 47906293, "comment_id": 82779911, "body": "@QHarr : Yes, it&#39;s a Userform Combobox. I&#39;ve added the info above! Thanks."}, {"owner": {"reputation": 341, "user_id": 8183516, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c68736dde5eadf868d276a2b1b65b76a?s=128&d=identicon&r=PG&f=1", "display_name": "budekatude", "link": "https://stackoverflow.com/users/8183516/budekatude"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1513774524, "post_id": 47906293, "comment_id": 82779967, "body": "@SJR : Added the info about discontinuity, thanks!"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1513774738, "post_id": 47906293, "comment_id": 82780131, "body": "Yes I think RowSource won&#39;t work with a non-contiguous range so you could use AddItem and loop through each cell adding individually, which is slow but should work."}], "answers": [{"comments": [{"owner": {"reputation": 341, "user_id": 8183516, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c68736dde5eadf868d276a2b1b65b76a?s=128&d=identicon&r=PG&f=1", "display_name": "budekatude", "link": "https://stackoverflow.com/users/8183516/budekatude"}, "edited": false, "score": 0, "creation_date": 1513774596, "post_id": 47906491, "comment_id": 82780022, "body": "I&#39;ve tried your first solution and I get a &quot;Runtime Error 1004: Application or objectdefined error&quot;."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 1, "last_activity_date": 1513774648, "last_edit_date": 1513774648, "creation_date": 1513774223, "answer_id": 47906491, "question_id": 47906293, "link": "https://stackoverflow.com/questions/47906293/populate-userform-combobox-with-values-from-non-continous-range-through-rowsourc/47906491#47906491", "title": "Populate UserForm Combobox with values from non continous range through RowSource property", "body": "<p>You should change this:</p>\n\n<pre><code>cb_FcnName.RowSource = Worksheets(\"Features\") &amp; \"!\" &amp; NameRng.Value\n</code></pre>\n\n<p>To something like this:</p>\n\n<pre><code>cb_FcnName.List = Worksheets(\"Features\").Range(\"NameRng\").Value\n</code></pre>\n\n<p>Or this will also do:</p>\n\n<pre><code>cb_FcnName.RowSource = \"NameRng\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 341, "user_id": 8183516, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c68736dde5eadf868d276a2b1b65b76a?s=128&d=identicon&r=PG&f=1", "display_name": "budekatude", "link": "https://stackoverflow.com/users/8183516/budekatude"}, "edited": false, "score": 0, "creation_date": 1513774711, "post_id": 47906525, "comment_id": 82780113, "body": "I&#39;ve tried your solution, and it throws a &quot;Runtime Error 1004: Method Range failed for object &quot;_Global&quot;."}], "tags": [], "owner": {"reputation": 594, "user_id": 1126927, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d6701ce88607ae792d291de20eabf78b?s=128&d=identicon&r=PG", "display_name": "Brownish Monster", "link": "https://stackoverflow.com/users/1126927/brownish-monster"}, "is_accepted": false, "score": 0, "last_activity_date": 1513774354, "creation_date": 1513774354, "answer_id": 47906525, "question_id": 47906293, "link": "https://stackoverflow.com/questions/47906293/populate-userform-combobox-with-values-from-non-continous-range-through-rowsourc/47906525#47906525", "title": "Populate UserForm Combobox with values from non continous range through RowSource property", "body": "<p>Try this:</p>\n\n<pre><code>cb_FcnName.RowSource = Range(\"NameRng\").Worksheet.Name &amp; \"!\" &amp; Range(\"NameRng\").Address\n</code></pre>\n\n<p>It can be further simplified but the above assumes you have a named range, however it doesn't guess what worksheet it is in.</p>\n"}, {"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1513775060, "creation_date": 1513775060, "answer_id": 47906737, "question_id": 47906293, "link": "https://stackoverflow.com/questions/47906293/populate-userform-combobox-with-values-from-non-continous-range-through-rowsourc/47906737#47906737", "title": "Populate UserForm Combobox with values from non continous range through RowSource property", "body": "<p>This is rather cumbersome but I think it will work. It puts the values in column AQ so just change to somewhere you don't use or put on a hidden sheet. The alternative as I said above is to use AddItem.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\nDim r As Range, r1 As Range\n\nWith Worksheets(2)\n    Set r = Union(.Range(\"A1:A10\"), .Range(\"B1:B3\"))\n    For Each r1 In r.Areas\n        r1.Copy .Range(\"AQ\" &amp; Rows.Count).End(xlUp)(2)\n    Next r1\n    Me.ComboBox1.RowSource = .Name &amp; \"!\" &amp; .Range(\"AQ2\").CurrentRegion.Address\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 341, "user_id": 8183516, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c68736dde5eadf868d276a2b1b65b76a?s=128&d=identicon&r=PG&f=1", "display_name": "budekatude", "link": "https://stackoverflow.com/users/8183516/budekatude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 47906737, "answer_count": 3, "score": -1, "last_activity_date": 1513860585, "creation_date": 1513773619, "last_edit_date": 1531161705, "question_id": 47906293, "link": "https://stackoverflow.com/questions/47906293/populate-userform-combobox-with-values-from-non-continous-range-through-rowsourc", "title": "Populate UserForm Combobox with values from non continous range through RowSource property", "body": "<p>I have a range containing cells whose contents I want to use to populate a Userform ComboBox through the RowSource property. \nHowever, I don't seem to get it to work. I've tried various different approaches, but nothing seems to work!</p>\n\n<p>Here is a wild array of ways I've tried:</p>\n\n<pre><code>cb_FcnName.RowSource = Worksheets(3).Name &amp; \"!\" &amp; NameRng.Address\ncb_FcnName.RowSource = Worksheets(3).Name &amp; \"!\" &amp; NameRng.Value\ncb_FcnName.RowSource = Worksheets(3).Name &amp; \"!\" &amp; Range(NameRng)\ncb_FcnName.RowSource = Worksheets(3).Name &amp; \"!\" &amp; Range(\"NameRng\")\ncb_FcnName.RowSource = Worksheets(3).Name &amp; \"!\" &amp; Range(\"NameRng\").Address\ncb_FcnName.RowSource = \"'\" &amp; Worksheets(3).Name &amp; \"'!\" &amp; NameRng.Address\ncb_FcnName.RowSource = Worksheets(\"Features\") &amp; \"!\" &amp; NameRng.Value\ncb_FcnName.RowSource = \"'\" &amp; Worksheets(\"Features\") &amp; \"!'\" &amp; \"B2.Value\"\n</code></pre>\n\n<p>Does anybody have an idea how to geht the values from the cells into my ComboBox? Even a pointer in the right direction is much appreciated!</p>\n\n<p>Many thanks in advance!</p>\n\n<p><strong>Edit:</strong> Not sure if this is part of the problem, but the Range is not continuous!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1513771386, "post_id": 47905585, "comment_id": 82777897, "body": "why not If sum(your range) &gt; 0 ?"}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1513774585, "post_id": 47905585, "comment_id": 82780011, "body": "@HarassedDad see Gary&#39;s student&#39;s remark to answer posted by MarcinSzaleniec."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1513774896, "post_id": 47905585, "comment_id": 82780240, "body": "If there&#39;s a possibility of negative values then you need If( Sum(yourrange) &lt;&gt; 0"}], "answers": [{"comments": [{"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1513773102, "post_id": 47905655, "comment_id": 82779018, "body": "I had to move the Exit For outside of the If statement, but now it works.  Thank you"}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "reply_to_user": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 2, "creation_date": 1513773272, "post_id": 47905655, "comment_id": 82779148, "body": "@sbagnato that will exit the for loop at first cell if you keep it outside <code>IF... END IF</code> loop!"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1513774026, "post_id": 47905655, "comment_id": 82779628, "body": "It wont be much of a loop if you exit after the first cell."}, {"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1513777015, "post_id": 47905655, "comment_id": 82781622, "body": "Understood, however, it wasn&#39;t exiting with it placed inside.  Maybe I am missing something else?  I did a test with 3 cells that had non-zero values, and the &quot;some code&quot; executed 3 times."}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "reply_to_user": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1513829425, "post_id": 47905655, "comment_id": 82803508, "body": "@sbagnato that is strange as I don&#39;t get any such behaviour."}], "tags": [], "owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "is_accepted": true, "score": 3, "last_activity_date": 1513771397, "creation_date": 1513771397, "answer_id": 47905655, "question_id": 47905585, "link": "https://stackoverflow.com/questions/47905585/if-cell-value-is-0-in-any-cell-in-range-then/47905655#47905655", "title": "If cell value is &gt; 0 in any cell in range then", "body": "<p>You just need to modify the code little bit like below:</p>\n\n<pre><code>For Each cell in Range(\"B2:C8\")\n    If cell.value &gt; 0 Then\n        \"some code\"\n        exit for 'Now that we have executed the code once we don't need to run it again!\n    End If\nNext cell\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 594, "user_id": 1126927, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d6701ce88607ae792d291de20eabf78b?s=128&d=identicon&r=PG", "display_name": "Brownish Monster", "link": "https://stackoverflow.com/users/1126927/brownish-monster"}, "edited": false, "score": 0, "creation_date": 1513772041, "post_id": 47905699, "comment_id": 82778335, "body": "I believe this would be faster than looping through the cells"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1513773169, "post_id": 47905699, "comment_id": 82779058, "body": "This is good, especially if there are no negative value in the range"}, {"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1513777375, "post_id": 47905699, "comment_id": 82781865, "body": "@MarcinSzaleniec, and this will only run &quot;some code&quot; for the first instance of a non-zero value, and not for subsequent instances, correct?"}], "tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": false, "score": 4, "last_activity_date": 1513771516, "creation_date": 1513771516, "answer_id": 47905699, "question_id": 47905585, "link": "https://stackoverflow.com/questions/47905585/if-cell-value-is-0-in-any-cell-in-range-then/47905699#47905699", "title": "If cell value is &gt; 0 in any cell in range then", "body": "<p>I would make it shorter</p>\n\n<pre><code>if worksheetfunction.sum(Range(\"B2:C8\")) &gt; 0 then \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 7446394, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-38usC6u5as8/AAAAAAAAAAI/AAAAAAAAVTA/29rIf3O3FCg/photo.jpg?sz=128", "display_name": "Luiz Henrique Lima", "link": "https://stackoverflow.com/users/7446394/luiz-henrique-lima"}, "is_accepted": false, "score": 0, "last_activity_date": 1513772017, "last_edit_date": 1513772017, "creation_date": 1513771776, "answer_id": 47905773, "question_id": 47905585, "link": "https://stackoverflow.com/questions/47905585/if-cell-value-is-0-in-any-cell-in-range-then/47905773#47905773", "title": "If cell value is &gt; 0 in any cell in range then", "body": "<p>As I understood: At the first occurrence of a non-zero value, your code should \"do something\" and stop searching for another non-zero value. Right?\nIn this case, \"Exit For\" should solve your problem.</p>\n\n<pre><code>For Each cell in Range(\"B2:C8\")\n    If cell.value &gt; 0 Then\n        \"some code\"\n        Exit For\n    End If\nNext cell\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13813290, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/849f10ef928389f00ce56c768ae290d3?s=128&d=identicon&r=PG", "display_name": "Hiral", "link": "https://stackoverflow.com/users/13813290/hiral"}, "is_accepted": false, "score": 0, "last_activity_date": 1593096128, "last_edit_date": 1593096128, "creation_date": 1593095774, "answer_id": 62577873, "question_id": 47905585, "link": "https://stackoverflow.com/questions/47905585/if-cell-value-is-0-in-any-cell-in-range-then/62577873#62577873", "title": "If cell value is &gt; 0 in any cell in range then", "body": "<p>I am probably late to answer this query, but just going to leave it here for future reference. My approach is to use 2 loops, for rows and columns separately. Here is a sample answer :</p>\n<pre><code> For icol from col_start to col_end 'column loop \n        For irow from row_start to row_end 'row loop\n\n       Og_val = Activesheet.cells(irow,icol). value\n\n       If og_val &gt; 0 Then 'To check if existing cell value is more than 0\n\n        &quot;Some code&quot;\n\n       End If\n\n      Next irow\n   Next icol\n</code></pre>\n"}], "owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15941, "favorite_count": 0, "accepted_answer_id": 47905655, "answer_count": 4, "score": 0, "last_activity_date": 1593096128, "creation_date": 1513771179, "last_edit_date": 1545669049, "question_id": 47905585, "link": "https://stackoverflow.com/questions/47905585/if-cell-value-is-0-in-any-cell-in-range-then", "title": "If cell value is &gt; 0 in any cell in range then", "body": "<p>I have a table that has x rows and y columns.  Each of the cells contains a number.  Usually it is 0, sometimes it is 1 or greater.</p>\n\n<p>I have code that prompts me to confirm if there are any non-zero values, and then step into a snippet of code to work with those values.</p>\n\n<p>I want the updated code to recognize that if even one cell has a greater than 0 value, step into a specific snippet of code.  Otherwise, ignore it.</p>\n\n<p>I tried to do this with a loop, but if more than one cell has a greater than 0 value, the current code executes multiple times.</p>\n\n<p>Pseudo-code that did not work:</p>\n\n<pre><code>For Each cell in Range(\"B2:C8\")\n    If cell.value &gt; 0 Then\n        \"some code\"\n    End If\nNext cell\n</code></pre>\n\n<p>This will execute \"some code\" every time a non-zero value is found, which is an issue any time more than one non-zero value occurs.</p>\n"}, {"tags": ["vba", "excel", "error-handling"], "comments": [{"owner": {"reputation": 4899, "user_id": 4720935, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c8sPO.png?s=128&g=1", "display_name": "Mel", "link": "https://stackoverflow.com/users/4720935/mel"}, "edited": false, "score": 1, "creation_date": 1513771175, "post_id": 47905520, "comment_id": 82777772, "body": "If this question has nothing to do with python, you should remove the python code and tag and focus on the issue you&#39;re having with vba."}], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1513774868, "post_id": 47905795, "comment_id": 82780217, "body": "This code should be outside the main body of the procedure/function.  i.e. <code>Exit Function&#47;Sub</code> followed by error handling followed by <code>End Function&#47;Sub</code>.  E.g. - using the code in @Vityata answer - comment out the <code>Exit Sub</code>, add a <code>Resume Next</code> above the <code>End Sub</code> and the last error (Error 6) will appear twice and throw a <code>Resume without error</code> error."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1513775395, "post_id": 47905795, "comment_id": 82780557, "body": "Yep, those changes are fine. :)"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1513775252, "last_edit_date": 1513775252, "creation_date": 1513771862, "answer_id": 47905795, "question_id": 47905520, "link": "https://stackoverflow.com/questions/47905520/error-handling-vba-if-err-raise-skip-this-block/47905795#47905795", "title": "Error handling VBA (if Err raise skip this block)", "body": "<p>You should be able to use one main error handler and catch the different codes and actions in their and use an Err.Clear to reset the error number after appropriately handling. And then an instruction on where to return to.  </p>\n\n<pre><code>'Other code\nExit Sub\n\nErr1Handler:\n\nIf Err.Number = 3021 Then\n\n    'MsgBox (\"Sin datos del 16\")\n    Err.Clear\n    Resume NoData16\n\nElseIf Err.Number = X Then\n    MsgBox \"The workbook named \"\"\" &amp; Bk &amp; \"\"\" does not exist.\"\n    Err.Clear\n    'Resume Next  ''Example. Instruction on what to do next; where to go\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Or use same idea but with</p>\n\n<pre><code>Select Case Err.Number\n            Case 0\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 97, "user_id": 8689602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-v_JkAgTIWj0/AAAAAAAAAAI/AAAAAAAAAGA/NOX4rrxbxOg/photo.jpg?sz=128", "display_name": "Dani LA", "link": "https://stackoverflow.com/users/8689602/dani-la"}, "edited": false, "score": 0, "creation_date": 1513842165, "post_id": 47905862, "comment_id": 82807774, "body": "So a way to handle different errors in VBA is by using a single On Error, with an if statement inside to check the error and take some actions?"}, {"owner": {"reputation": 97, "user_id": 8689602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-v_JkAgTIWj0/AAAAAAAAAAI/AAAAAAAAAGA/NOX4rrxbxOg/photo.jpg?sz=128", "display_name": "Dani LA", "link": "https://stackoverflow.com/users/8689602/dani-la"}, "edited": false, "score": 0, "creation_date": 1513842590, "post_id": 47905862, "comment_id": 82807977, "body": "Is there any way to know in which line of code happened the error raised in the Else statement?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 97, "user_id": 8689602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-v_JkAgTIWj0/AAAAAAAAAAI/AAAAAAAAAGA/NOX4rrxbxOg/photo.jpg?sz=128", "display_name": "Dani LA", "link": "https://stackoverflow.com/users/8689602/dani-la"}, "edited": false, "score": 0, "creation_date": 1513847169, "post_id": 47905862, "comment_id": 82810301, "body": "@DLA - if you write only <code>Stop : Resume</code> on the Error Handler, then it will stop on the error and will resume on the exact line where the error happened. Thus, you would know."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 97, "user_id": 8689602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-v_JkAgTIWj0/AAAAAAAAAAI/AAAAAAAAAGA/NOX4rrxbxOg/photo.jpg?sz=128", "display_name": "Dani LA", "link": "https://stackoverflow.com/users/8689602/dani-la"}, "edited": false, "score": 1, "creation_date": 1513849450, "post_id": 47905862, "comment_id": 82811669, "body": "@DLA You can add line numbers and use <code>erl</code> to return the line number in an error handler. The last time I used line numbers was Sinclair Basic back in the eighties and modern languages don&#39;t use line numbers.  Most of my error handlers have <code>Resume Next</code> once the error is handled - I put a break point in the error handler, comment out <code>Next</code> and as Vityata said - it takes you back to the line that caused the error.   <a href=\"https://stackoverflow.com/questions/41001047/how-to-auto-populate-line-number-in-vba-editor/41002482#41002482\" title=\"how to auto populate line number in vba editor\">stackoverflow.com/questions/41001047/&hellip;</a>"}, {"owner": {"reputation": 97, "user_id": 8689602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-v_JkAgTIWj0/AAAAAAAAAAI/AAAAAAAAAGA/NOX4rrxbxOg/photo.jpg?sz=128", "display_name": "Dani LA", "link": "https://stackoverflow.com/users/8689602/dani-la"}, "edited": false, "score": 0, "creation_date": 1513975315, "post_id": 47905862, "comment_id": 82864164, "body": "@Vityata I almost get it. Now I can identify any other error apart from the 3021 with stop : Resume But how do you do like in my code, where I need to deal two times with the same error, but the way to handle it is different in each case (skipping different blocks of codes) . Do I need to use two different error handlers?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 97, "user_id": 8689602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-v_JkAgTIWj0/AAAAAAAAAAI/AAAAAAAAAGA/NOX4rrxbxOg/photo.jpg?sz=128", "display_name": "Dani LA", "link": "https://stackoverflow.com/users/8689602/dani-la"}, "edited": false, "score": 0, "creation_date": 1513979227, "post_id": 47905862, "comment_id": 82865376, "body": "@DLA - you need 1 errror handler, just make sure that you use select case or if to catch the correct error number and to act correspondingly \u263a Cheers \ud83c\udf7a"}, {"owner": {"reputation": 97, "user_id": 8689602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-v_JkAgTIWj0/AAAAAAAAAAI/AAAAAAAAAGA/NOX4rrxbxOg/photo.jpg?sz=128", "display_name": "Dani LA", "link": "https://stackoverflow.com/users/8689602/dani-la"}, "edited": false, "score": 0, "creation_date": 1513997725, "post_id": 47905862, "comment_id": 82868590, "body": "@Vityata but how can I check in a select case when the error comes from, for example, &quot;consulta16.MoveFirst&quot; rather than from &quot;consulta17.MoveFirst&quot; if the error number is the same?"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1513848184, "last_edit_date": 1513848184, "creation_date": 1513772092, "answer_id": 47905862, "question_id": 47905520, "link": "https://stackoverflow.com/questions/47905520/error-handling-vba-if-err-raise-skip-this-block/47905862#47905862", "title": "Error handling VBA (if Err raise skip this block)", "body": "<p>I would have done it like this:</p>\n\n<p>Option Explicit</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim a As Long\n    Dim b As Long\n\n    On Error GoTo TestMe_Error\n\n    a = 1: b = 0\n    Debug.Print a / b   'Error 11\n    Debug.Print \"Some more stuff...\"\n    Debug.Print a / b   'Error 11\n    Debug.Print \"Some other stuff...\"        \n    a = 0\n    Debug.Print a / b   'Error 6\n\n    On Error GoTo 0\n    Exit Sub\n\nTestMe_Error:\n    If Err.Number = 11 Then\n        Resume Next\n    Else\n        MsgBox Err.Number &amp; \" \" &amp; Err.Description\n    End If\nEnd Sub\n</code></pre>\n\n<p>Thus, if you look for error 11 it would ignore it and continue, and every other error would be caught (e.g. error 6 is caught).</p>\n\n<hr>\n\n<p>This is how to find the line, causing the error:</p>\n\n<pre><code>Public Sub TestMe()\n\n    On Error GoTo TestMe_Error\n\n    Debug.Print 3 / 4\n    Debug.Print 4 / 0\n    Debug.Print 6 / 1\n\n    On Error GoTo 0\n    Exit Sub\n\nTestMe_Error:\n    Stop\n    Resume\nEnd Sub\n</code></pre>\n\n<p>After the code stops on the <code>Stop</code> line, if you press twice <kbd>F8</kbd> you would go to the error line.</p>\n"}, {"tags": [], "owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "is_accepted": false, "score": 0, "last_activity_date": 1513799790, "creation_date": 1513799790, "answer_id": 47913489, "question_id": 47905520, "link": "https://stackoverflow.com/questions/47905520/error-handling-vba-if-err-raise-skip-this-block/47913489#47913489", "title": "Error handling VBA (if Err raise skip this block)", "body": "<p>I'd handle this a bit differently. My query knowledge is fairly weak, but I believe the same principles apply:</p>\n\n<pre><code>If (Test for a record) then\n'Code here\nElse\n'Error Handling here\nEnd if\n</code></pre>\n\n<p>This gets the same result, without dealing with onerror - since if you have quite a bit more code, and you forget to turn it off/change it, you could loop back into it without meaning to. I've dealt with enough spaghetti code to want to avoid onerror whenever I could use a boolean instead. </p>\n\n<p>All of this assumes, of course, that you can test for the existence of the records before running the query. </p>\n"}], "owner": {"reputation": 97, "user_id": 8689602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-v_JkAgTIWj0/AAAAAAAAAAI/AAAAAAAAAGA/NOX4rrxbxOg/photo.jpg?sz=128", "display_name": "Dani LA", "link": "https://stackoverflow.com/users/8689602/dani-la"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1618, "favorite_count": 0, "accepted_answer_id": 47905862, "answer_count": 3, "score": 2, "last_activity_date": 1513848184, "creation_date": 1513770966, "last_edit_date": 1531164843, "question_id": 47905520, "link": "https://stackoverflow.com/questions/47905520/error-handling-vba-if-err-raise-skip-this-block", "title": "Error handling VBA (if Err raise skip this block)", "body": "<p>I am a beginner python programmer but lately I am coding a bit with VBA in access and excel. </p>\n\n<p>I am working in a code that exports some data from two different query's (from access to an excel workbook). Then from excel I keep doing more processes with the data in order to do some sales analysis.</p>\n\n<p>The problem is that sometimes, one of the query's (or both) can be empty which raises an </p>\n\n<blockquote>\n  <p>error '3021'</p>\n</blockquote>\n\n<p>What I would like to do is that if an </p>\n\n<blockquote>\n  <p>error '3021'</p>\n</blockquote>\n\n<p>happens in a specific block, jump to a specific line and keep with the execution.</p>\n\n<p>In python I would put that code block - that I know can raise the </p>\n\n<blockquote>\n  <p>error '3021'</p>\n</blockquote>\n\n<p>inside a \"try\" to avoid the execution</p>\n\n<pre><code>#code here\nTry:\n    #code that may raise error\nExcept Exception as '3021':\n    pass\n#code here....\n</code></pre>\n\n<p>In VBA I was able to handle the </p>\n\n<blockquote>\n  <p>error '3021'</p>\n</blockquote>\n\n<p>but not as I would like. Once I have \"managed\" the </p>\n\n<blockquote>\n  <p>error '3021'</p>\n</blockquote>\n\n<p>If another error raises in the rest of the code, the last error handler is always active (hiding other error raises that I would like to raise for debugging. An extract of the code is this:</p>\n\n<pre><code>On Error GoTo Err1Handler\n'here starts the code that may raise the error '3021'\nconsulta16.MoveFirst\nDatos16.Range(\"A2\").CopyFromRecordset consulta16\n\nWith APIExcel.ActiveSheet.Cells\n.Select\n.EntireColumn.AutoFit\n.Range(\"A1\").Select\nEnd With\n'From here I know there wont be an error '3021'\nNoData16:\ncolumnas = consulta17.Fields.Count\nFor i = 0 To columnas - 1\n    Datos17.Cells(1, i + 1) = consulta17.Fields(i).Name\nNext i\n'Now comes the second query that may raise same \n</code></pre>\n\n<blockquote>\n  <p>error '3021'</p>\n</blockquote>\n\n<p>so I make another error exception</p>\n\n<pre><code> On Error GoTo Err2Handler\n consulta17.MoveFirst\n</code></pre>\n\n<hr>\n\n<pre><code>Datos17.Range(\"A2\").CopyFromRecordset consulta17\n    With APIExcel.ActiveSheet.Cells\n    .Select\n    .EntireColumn.AutoFit\n    .Range(\"A1\").Select\nEnd With\n'#more code.......\nErr1Handler:\nIf Err.Number = 3021 Then\n    'MsgBox (\"Sin datos del 16\")\n    Resume NoData16\nEnd If\nErr2Handler:\nIf Err.Number = 3021 Then\n        'MsgBox (\"Sin datos del 17\")\n        Resume NoData17\nEnd If\n</code></pre>\n\n<p>I read <a href=\"http://www.cpearson.com/excel/errorhandling.htm\" rel=\"nofollow noreferrer\" title=\"here\">here</a>\nThis documentation about error handling in Vba but I don't know how to handle specific errors without affecting the whole script. I guess I am trying to face vba error handling as coding in python...I would appreciate if some one can help me to understand how to isolate blocks of code inside error handlers without affecting the whole script (Try/Catch/Finally way?) </p>\n"}, {"tags": ["arrays", "excel", "vba", "recursion"], "comments": [{"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1513770497, "post_id": 47905307, "comment_id": 82777356, "body": "1) Yes subs and functions can call each other.  2) In the example it is not recursive.  The line <code>SortDays = InputArray</code> does not call <code>Sortdays</code>, it sets the return value. 3) Not sure I understand this part.  Can you elaborate?"}, {"owner": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "edited": false, "score": 0, "creation_date": 1513772093, "post_id": 47905307, "comment_id": 82778363, "body": "Where are your <code>QuickSortSub</code>, the function failed calling, and the sub succeed calling? Maybe a prefix <code>Public</code> before <code>QuickSortSub</code> can solve it."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1513774792, "post_id": 47905307, "comment_id": 82780173, "body": "Help us to help you; <b>post your current code</b>."}], "owner": {"reputation": 1, "user_id": 9122445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ad4c54ae5783370d141466fb29da7ef?s=128&d=identicon&r=PG&f=1", "display_name": "Mikeyg63", "link": "https://stackoverflow.com/users/9122445/mikeyg63"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513936753, "creation_date": 1513770268, "last_edit_date": 1513936753, "question_id": 47905307, "link": "https://stackoverflow.com/questions/47905307/excel-vba-calling-sub-from-function-recursive-function-array-function-recalcul", "title": "Excel VBA calling Sub from Function, recursive Function, Array Function recalculation", "body": "<p>I\u2019m stuck, please help.  I have a small dynamic length array (6:20 x 2 text/numeric) and I want to automatically create a sorted copy so I can plot a monatonic scatter graph.  To recalculate automatically, I was thinking Function.   I plagiarised QuickSortArray, which works for the sorting as a Sub.</p>\n\n<p>Q1: I can\u2019t manage to call QuickSortArray from a Function even though I can successfully call it from another Sub.  The working Sub call is below.  I changed Sub QuickSortArray to Function QuickSortArray invoked from the spreadsheet, but could not get it to work.  As it does work from a Sub, can I trick CallSub into running when the data changes?  That makes the next two questions moot.</p>\n\n<pre><code>Sub CallSub()\n   temparray = Range(\"weekdays\")\n   Call QuickSortArray(temparray, , , 2)\n   Dim MyRange As String\n   MyRange = \"daysout\"\n   Range(MyRange) = temparray\nEnd Sub\n</code></pre>\n\n<p>Q2: I notice that QuickSortArray is recursive (calls itself): can this work within a function?  The VBA I used is the top code here:\n<a href=\"https://stackoverflow.com/questions/4873182/sorting-a-multidimensionnal-array-in-vba#5104206\">Sorting a multidimensionnal array in VBA</a>  . At the bottom it has these recursive calls</p>\n\n<pre><code>If (lngMin &lt; j) Then Call QuickSortArray(SortArray, lngMin, j, lngColumn)\nIf (i &lt; lngMax) Then Call QuickSortArray(SortArray, i, lngMax, lngColumn)\n</code></pre>\n\n<p>Q3: The code below is the only working way I have found to pass an array and retrieve it.  Weekdays is a named range on the spreadsheet.  However, Fn SortDays does not automatically recalculate, either as a single cell function, or (as I want to) when using Array arithmetic to retrieve the whole array?  The function Test below it recalculates automatically and returns the results into an array of {=test($L$20)} in the spreadsheet ($L$20 = x).  So it is not recalculation settings.</p>\n\n<pre><code>Function SortDays() As Variant  \nDim InputArray As Variant \nInputArray = Range(\"weekdays\")  \nSortDays = InputArray  \nEnd Function  \n\nFunction Test(x As Integer) As Variant\n    Dim V() As Variant\n    Dim N As Long\n    Dim R As Long\n    Dim C As Long\n    ReDim V(1 To 3, 1 To 4)\n    For R = 1 To 3\n        For C = 1 To 4\n            N = N * x + 1\n            V(R, C) = N\n        Next C\n    Next R\n    Test = V\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 0, "creation_date": 1513770540, "post_id": 47905271, "comment_id": 82777387, "body": "You&#39;d be better using Power Query to aggregate data from your workbooks."}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 1, "creation_date": 1513770768, "post_id": 47905271, "comment_id": 82777525, "body": "You miss <code>\\</code> at the end of <code>Path</code>. I recommend to loop using <code>FileSystemObject</code>"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1513771148, "creation_date": 1513771148, "answer_id": 47905574, "question_id": 47905271, "link": "https://stackoverflow.com/questions/47905271/merge-different-workbooks-into-one/47905574#47905574", "title": "Merge Different workbooks into one", "body": "<p>Using your coding style, try something like this to get what you need:</p>\n\n<pre><code>Sub MergeDifferentWorkbooksTogether()\n\n    Dim wbk As Workbook\n    Dim wbk1 As Workbook\n    Set wbk1 = ThisWorkbook\n    Dim Filename As String\n    Dim Path As String\n\n    Path = \"C:\\Users\\SomeFile\\\"\n    Filename = Dir(Path &amp; \"*.xlsx\")\n\n    Do While Len(Filename) &gt; 0\n        Debug.Print Filename\n        Set wbk = Workbooks.Open(Path &amp; Filename)\n        wbk.Activate\n        Range(\"A2\").Select\n        Range(ActiveCell, ActiveCell.End(xlDown).End(xlToRight)).Copy\n        wbk.Activate\n        Application.DisplayAlerts = False\n        Dim i As Long\n        i = wbk1.Worksheets(1).Range(\"A:A\").End(xlUp).Row\n        Worksheets(2).Select\n        Cells(i + 1, 1).Select\n        ActiveCell.PasteSpecial xlPasteAll\n        wbk.Close True\n        Filename = Dir\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>In general, as mentioned in the comments, you need to end your path with a <code>\\</code> sign. Then make sure that your code uses the correct references - e.g. <code>Cell</code> should be written <code>Cells</code> and etc.</p>\n\n<p>As a third step somewhere in the future, try to avoid <code>Selection</code> and <code>ActiveCell</code> in VBA, it slows you down and it can lead to some errors - <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a></p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1513814743, "creation_date": 1513814743, "answer_id": 47916074, "question_id": 47905271, "link": "https://stackoverflow.com/questions/47905271/merge-different-workbooks-into-one/47916074#47916074", "title": "Merge Different workbooks into one", "body": "<p>So, 97 workbooks merged into 1, right.</p>\n\n<p>Merge a range from all workbooks in a folder (below each other)</p>\n\n<pre><code>Sub Basic_Example_1()\n    Dim MyPath As String, FilesInPath As String\n    Dim MyFiles() As String\n    Dim SourceRcount As Long, Fnum As Long\n    Dim mybook As Workbook, BaseWks As Worksheet\n    Dim sourceRange As Range, destrange As Range\n    Dim rnum As Long, CalcMode As Long\n\n    'Fill in the path\\folder where the files are\n    MyPath = \"C:\\Users\\Ron\\test\"\n\n    'Add a slash at the end if the user forget it\n    If Right(MyPath, 1) &lt;&gt; \"\\\" Then\n        MyPath = MyPath &amp; \"\\\"\n    End If\n\n    'If there are no Excel files in the folder exit the sub\n    FilesInPath = Dir(MyPath &amp; \"*.xl*\")\n    If FilesInPath = \"\" Then\n        MsgBox \"No files found\"\n        Exit Sub\n    End If\n\n    'Fill the array(myFiles)with the list of Excel files in the folder\n    Fnum = 0\n    Do While FilesInPath &lt;&gt; \"\"\n        Fnum = Fnum + 1\n        ReDim Preserve MyFiles(1 To Fnum)\n        MyFiles(Fnum) = FilesInPath\n        FilesInPath = Dir()\n    Loop\n\n    'Change ScreenUpdating, Calculation and EnableEvents\n    With Application\n        CalcMode = .Calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    'Add a new workbook with one sheet\n    Set BaseWks = Workbooks.Add(xlWBATWorksheet).Worksheets(1)\n    rnum = 1\n\n    'Loop through all files in the array(myFiles)\n    If Fnum &gt; 0 Then\n        For Fnum = LBound(MyFiles) To UBound(MyFiles)\n            Set mybook = Nothing\n            On Error Resume Next\n            Set mybook = Workbooks.Open(MyPath &amp; MyFiles(Fnum))\n            On Error GoTo 0\n\n            If Not mybook Is Nothing Then\n\n                On Error Resume Next\n\n                With mybook.Worksheets(1)\n                    Set sourceRange = .Range(\"A1:C1\")\n                End With\n\n                If Err.Number &gt; 0 Then\n                    Err.Clear\n                    Set sourceRange = Nothing\n                Else\n                    'if SourceRange use all columns then skip this file\n                    If sourceRange.Columns.Count &gt;= BaseWks.Columns.Count Then\n                        Set sourceRange = Nothing\n                    End If\n                End If\n                On Error GoTo 0\n\n                If Not sourceRange Is Nothing Then\n\n                    SourceRcount = sourceRange.Rows.Count\n\n                    If rnum + SourceRcount &gt;= BaseWks.Rows.Count Then\n                        MsgBox \"Sorry there are not enough rows in the sheet\"\n                        BaseWks.Columns.AutoFit\n                        mybook.Close savechanges:=False\n                        GoTo ExitTheSub\n                    Else\n\n                        'Copy the file name in column A\n                        With sourceRange\n                            BaseWks.cells(rnum, \"A\"). _\n                                    Resize(.Rows.Count).Value = MyFiles(Fnum)\n                        End With\n\n                        'Set the destrange\n                        Set destrange = BaseWks.Range(\"B\" &amp; rnum)\n\n                        'we copy the values from the sourceRange to the destrange\n                        With sourceRange\n                            Set destrange = destrange. _\n                                            Resize(.Rows.Count, .Columns.Count)\n                        End With\n                        destrange.Value = sourceRange.Value\n\n                        rnum = rnum + SourceRcount\n                    End If\n                End If\n                mybook.Close savechanges:=False\n            End If\n\n        Next Fnum\n        BaseWks.Columns.AutoFit\n    End If\n\nExitTheSub:\n    'Restore ScreenUpdating, Calculation and EnableEvents\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = CalcMode\n    End With\nEnd Sub\n</code></pre>\n\n<p>RDB_Last function to find the last cell or row</p>\n\n<pre><code>Function RDB_Last(choice As Integer, rng As Range)\n'Ron de Bruin, 5 May 2008\n' 1 = last row\n' 2 = last column\n' 3 = last cell\n    Dim lrw As Long\n    Dim lcol As Integer\n\n    Select Case choice\n\n    Case 1:\n        On Error Resume Next\n        RDB_Last = rng.Find(What:=\"*\", _\n                            after:=rng.cells(1), _\n                            Lookat:=xlPart, _\n                            LookIn:=xlFormulas, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Row\n        On Error GoTo 0\n\n    Case 2:\n        On Error Resume Next\n        RDB_Last = rng.Find(What:=\"*\", _\n                            after:=rng.cells(1), _\n                            Lookat:=xlPart, _\n                            LookIn:=xlFormulas, _\n                            SearchOrder:=xlByColumns, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Column\n        On Error GoTo 0\n\n    Case 3:\n        On Error Resume Next\n        lrw = rng.Find(What:=\"*\", _\n                       after:=rng.cells(1), _\n                       Lookat:=xlPart, _\n                       LookIn:=xlFormulas, _\n                       SearchOrder:=xlByRows, _\n                       SearchDirection:=xlPrevious, _\n                       MatchCase:=False).Row\n        On Error GoTo 0\n\n        On Error Resume Next\n        lcol = rng.Find(What:=\"*\", _\n                        after:=rng.cells(1), _\n                        Lookat:=xlPart, _\n                        LookIn:=xlFormulas, _\n                        SearchOrder:=xlByColumns, _\n                        SearchDirection:=xlPrevious, _\n                        MatchCase:=False).Column\n        On Error GoTo 0\n\n        On Error Resume Next\n        RDB_Last = rng.Parent.cells(lrw, lcol).Address(False, False)\n        If Err.Number &gt; 0 Then\n            RDB_Last = rng.cells(1).Address(False, False)\n            Err.Clear\n        End If\n        On Error GoTo 0\n\n    End Select\nEnd Function\n</code></pre>\n\n<p>That if from here.</p>\n\n<p><a href=\"https://www.rondebruin.nl/win/s3/win008.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/s3/win008.htm</a></p>\n\n<p>Also, consider using this Excel AddIn.</p>\n\n<p><a href=\"https://www.rondebruin.nl/win/addins/rdbmerge.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/addins/rdbmerge.htm</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/zDFiY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zDFiY.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 83, "user_id": 8505098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0fef8d3bc3416d1f92817b306ea3d1?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar", "link": "https://stackoverflow.com/users/8505098/khazar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 47905574, "answer_count": 2, "score": 0, "last_activity_date": 1513814743, "creation_date": 1513770186, "last_edit_date": 1531161705, "question_id": 47905271, "link": "https://stackoverflow.com/questions/47905271/merge-different-workbooks-into-one", "title": "Merge Different workbooks into one", "body": "<p>I got 97 different workbooks. I want to merge them together into one workbook.</p>\n\n<p>After some search I found this code and made some changes.</p>\n\n<p>When I press F5, no Error happen. But I don't see any result of code.</p>\n\n<p>Here my code:</p>\n\n<pre><code>Sub MergeDifferentWorkbooksTogether()\n\nDim wbk As Workbook\nDim wbk1 As Workbook\nSet wbk1 = ThisWorkbook\nDim Filename As String\nDim Path As String\n\nPath = \"C:\\Users\\xezer.suleymanov\\Desktop\\Combine Workbooks\"\nFilename = Dir(Path &amp; \"*.xlsx\")\n\nDo While Len(Filename) &gt; 0\n\nSet wbk = Workbooks.Open(Path &amp; Filename)\nwbk.Activate\nRange(\"A2\").Select\nRange(ActiveCell, ActiveCell.End(xlDown).End(xlToRight)).Copy\nWindows(\"Book1.xlsx\").Activate\nApplication.DisplayAlerts = False\nDim i As Double\ni = wbk1.Sheets(\"Sheet1\").cell(Rows.Count, 1).End(xlUp).Row\nSheets(\"Sheet\").Select\nCells(i + 1, 1).Select\nActiveCell.PasteSpecial xlPasteAll\nwbk.Close True\nFilename = Dir\n\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1513772535, "post_id": 47905138, "comment_id": 82778632, "body": "When you refer to &quot;a form&quot;, you mean an Access form, right ?"}, {"owner": {"reputation": 23, "user_id": 7996749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfe05054a3432917a525d84ffeb2fd45?s=128&d=identicon&r=PG&f=1", "display_name": "mtz", "link": "https://stackoverflow.com/users/7996749/mtz"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1513781154, "post_id": 47905138, "comment_id": 82784401, "body": "of course. The only I know :)"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7996749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfe05054a3432917a525d84ffeb2fd45?s=128&d=identicon&r=PG&f=1", "display_name": "mtz", "link": "https://stackoverflow.com/users/7996749/mtz"}, "edited": false, "score": 0, "creation_date": 1513770433, "post_id": 47905225, "comment_id": 82777306, "body": "I was thinkng about object version rather than object.name. Is is because when I have object I have the right one. If I have nore workbooks opened I need to to have more variables with parent obect. I think it&#39;s hardly possible to do it my way,"}], "tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 0, "last_activity_date": 1513770035, "creation_date": 1513770035, "answer_id": 47905225, "question_id": 47905138, "link": "https://stackoverflow.com/questions/47905138/ms-access-choosing-worksheet-from-excel-workbook/47905225#47905225", "title": "MS Access: Choosing Worksheet from Excel Workbook", "body": "<p>Assuming your object is wsObj, can't you just use wsObj.<code>Name</code> ?<br>\nAlso have a look at wsObj.<code>CodeName</code>, which may be interesting as well.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 7996749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfe05054a3432917a525d84ffeb2fd45?s=128&d=identicon&r=PG&f=1", "display_name": "mtz", "link": "https://stackoverflow.com/users/7996749/mtz"}, "edited": false, "score": 0, "creation_date": 1513781322, "post_id": 47905927, "comment_id": 82784536, "body": "Seariously? I didn&#39;t know that I can use properties in form. But in fact it&#39;s a class. Never reached this info before. I&#39;m gonna try it :) Thanx for a hint.  so much to learn..."}, {"owner": {"reputation": 23, "user_id": 7996749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfe05054a3432917a525d84ffeb2fd45?s=128&d=identicon&r=PG&f=1", "display_name": "mtz", "link": "https://stackoverflow.com/users/7996749/mtz"}, "edited": false, "score": 0, "creation_date": 1513926788, "post_id": 47905927, "comment_id": 82843706, "body": "Ok. I was able to try yours solution. It works but there is a BUT. When I&#39;m opening form by command <code>docmd.openform</code> I can use <code>windowmode:=acDialog</code> which cause code to stop running until opened form makes it&#39;s job. When I&#39;m using <code>dim f as Form_SheetSelection set f = New Form_SheetSelection</code> it says that I can&#39;t load or unload this object (err 361). And when I omit <code>Load</code> it runs, opens form, perform all things, and go back to the place I called it from."}, {"owner": {"reputation": 23, "user_id": 7996749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfe05054a3432917a525d84ffeb2fd45?s=128&d=identicon&r=PG&f=1", "display_name": "mtz", "link": "https://stackoverflow.com/users/7996749/mtz"}, "edited": false, "score": 0, "creation_date": 1514878241, "post_id": 47905927, "comment_id": 83086424, "body": "Hi there. I think I&#39;m missing some thing. As I do <code>dim f as Form_myForm</code> and then <code>with f set .wbk = myWorkBookObject</code> it says that my f obect isn&#39;t yet initialized. When I add <code>New</code> keyword it starts to run <code>OpenForm</code> subroutine. When I try to open it with <code>docmd</code> it just opens but I don&#39;t have form objects variable. Could you please once again type it for me from begining to the end?"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1513954399, "last_edit_date": 1513954399, "creation_date": 1513772312, "answer_id": 47905927, "question_id": 47905138, "link": "https://stackoverflow.com/questions/47905138/ms-access-choosing-worksheet-from-excel-workbook/47905927#47905927", "title": "MS Access: Choosing Worksheet from Excel Workbook", "body": "<p>IN the forms Module you can declare a property as object and then set that property once loaded. So in the form module</p>\n\n<pre><code>Option Explicit\nPrivate myObj as object\nProperty Set DesiredWorksheet(o as object)\nset myobj = o\nEnd\n</code></pre>\n\n<p>and then in your code </p>\n\n<pre><code> Load myform\n    set myform.desiredworksheet = wsObj\n    myform.show\n</code></pre>\n\n<p>Ahh, sorry I was writing Excel not Access!!!</p>\n\n<pre><code> Docmd.openform f\n f.desiredworksheet = ws.obj\n docmd.openform f, windowmode:=acdialog\n</code></pre>\n\n<p>ought to work</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 7996749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfe05054a3432917a525d84ffeb2fd45?s=128&d=identicon&r=PG&f=1", "display_name": "mtz", "link": "https://stackoverflow.com/users/7996749/mtz"}, "edited": false, "score": 0, "creation_date": 1513781546, "post_id": 47907728, "comment_id": 82784717, "body": "Thanks for anwser. With OpenArgs i&#39;m quite familiar. I was dreamin&#39; (I guess - not yet tried) about solution Harassed Dad  wrote."}], "tags": [], "owner": {"reputation": 93, "user_id": 4001550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13a9d4c42555b1f85576f34c6f489eb5?s=128&d=identicon&r=PG", "display_name": "Mastercafe", "link": "https://stackoverflow.com/users/4001550/mastercafe"}, "is_accepted": false, "score": 0, "last_activity_date": 1513778422, "creation_date": 1513778422, "answer_id": 47907728, "question_id": 47905138, "link": "https://stackoverflow.com/questions/47905138/ms-access-choosing-worksheet-from-excel-workbook/47907728#47907728", "title": "MS Access: Choosing Worksheet from Excel Workbook", "body": "<p>There are many possibilities to send some value between objects.</p>\n\n<p><strong>A</strong>) Using Global vars into ACCESS Vba module</p>\n\n<pre><code>Global yourvariable As String\n</code></pre>\n\n<p>if you need some different value can use Variant, Single, etc.</p>\n\n<p><strong>B</strong>) Using Windows Register\nTo save value:</p>\n\n<pre><code>SaveSetting \"yourprojectname\", \"Settings\", \"yourvariable\", yourvalue\n</code></pre>\n\n<p>To retrieve value:</p>\n\n<pre><code>retvalue = GetSetting(\"yourprojectname\", \"Settings\", \"yourvariable\", \"your_default_value_if_not_exist\")\n</code></pre>\n\n<p><strong>C</strong>) Using OpenArg into Open Form command procedure</p>\n\n<pre><code>DoCmd.OpenForm \"stDocName\", acNormal, \"filter_if_needed\", \"stlinkcriteria\", acFormEdit, acWindowNormal, \"arguments_forOpenArgs\"\n</code></pre>\n\n<p>On destination form </p>\n\n<pre><code>Private Sub Form_Open(cancel as integer)\nyour_args=Me.OpenArgs\n</code></pre>\n\n<p>On all three possible solutions you can send more than one value using a chain with vars and values, an example:</p>\n\n<pre><code>myvar_mutiple=\"name=John Doe|address=Rua del Percebe 34|location=Madrid|phone=34 91 1234567\"\n</code></pre>\n\n<p>On this example i used \"pipe\" (AltGr on key 1)  char to separate each var=value\nThen on destination procedure only need split each pair:</p>\n\n<pre><code>splitvar=Split(myvar_multiple,\"|\")\n</code></pre>\n\n<p>With this you obtain for each \"splitvar\" an element like \"name=John Doe\"\nDo again an split with \"=\" to obtain variable an value. For each value you can reassign the result to a local vars.\nFull code example:</p>\n\n<pre><code>if me.OpenArgs&lt;&gt;\"\" then\n   splitvar=Split(me.OpenArgs,\"|\")\n   for x=0 to ubound(splitvar)\n      tmpsplit=Split(splitvar(x),\"=\")\n      paramvars=tmpsplit(0)\n      paramvalue=tmpsplit(1)\n      select case paramvars\n         case \"name\"\n            stname=paramvalue\n         case \"address\"\n            straddress=paramvalue\n         case \"location\"\n            strlocation=paramvalue\n         case \"phone\"\n            strphone=paramvalue\n      end select\n   next\nend if\n</code></pre>\n\n<p>Some recommendations that i use for this code \"multiple vars\":\n- always use Low Case variable or change this:</p>\n\n<pre><code>paramvars=tmpsplit(0)\n</code></pre>\n\n<p>by </p>\n\n<pre><code>paramvars=lcase(tmpsplit(0))\n</code></pre>\n\n<p>-if you need to use \"=\" into value you can change by other alternative char or search the first \"=\" form left (i used this solution instead Split)</p>\n\n<pre><code>paramvars=trim(lcase(left(splitvar(x),len(splitvar(x))-(len(splitvar(x))-instr(splitvar(x),\"=\"))-1)))\n</code></pre>\n\n<ul>\n<li>remember that you can send any value and can be converted on destination code. On this sample i use only String so you can use cLng or cInt etc.</li>\n</ul>\n\n<p>Over your solution to select Sheet on excel from Access i think there are better alternatives.</p>\n"}], "owner": {"reputation": 23, "user_id": 7996749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfe05054a3432917a525d84ffeb2fd45?s=128&d=identicon&r=PG&f=1", "display_name": "mtz", "link": "https://stackoverflow.com/users/7996749/mtz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1594638568, "creation_date": 1513769762, "last_edit_date": 1594638568, "question_id": 47905138, "link": "https://stackoverflow.com/questions/47905138/ms-access-choosing-worksheet-from-excel-workbook", "title": "MS Access: Choosing Worksheet from Excel Workbook", "body": "<p>I'm writing some code in MS Access and I reached to the point where user needs to choose on which worksheet of an Excel workbook there need to be performed some operation. I don't know, what name of this worksheet is or on which position it is placed.</p>\n\n<p>I was thinking about a solution which will show user a form (as modal form) with listbox containing all sheets names'. When user click one of them form will show aside A1:J10 range (so user can choose the right one worksheet). After confirming choosen worksheet it will return as worksheet object.</p>\n\n<p>Every thing was great untill I wanted to pass a object variable to the form. In openArgs I can only pass a string. I was even thinking about a class which will open this form but it's still no luck with passing object parameter.</p>\n\n<p>I'm trying to avoid global/public variables.</p>\n\n<p>Any ideas? </p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1513785425, "post_id": 47905096, "comment_id": 82787350, "body": "This might be helpful to you <a href=\"https://wordribbon.tips.net/T002357_Breaking_Links_in_Lots_of_Documents.html\" rel=\"nofollow noreferrer\">wordribbon.tips.net/&hellip;</a>"}, {"owner": {"reputation": 649, "user_id": 8456608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jDMgZ.jpg?s=128&g=1", "display_name": "bm13563", "link": "https://stackoverflow.com/users/8456608/bm13563"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1513785981, "post_id": 47905096, "comment_id": 82787694, "body": "Thanks for the response. Unfortunately, this is not the solution I am after; I am not trying to break links to multiple documents at once. Instead, I am trying to break the links to a specific word document (which could be one of around 10 templates) from excel."}], "answers": [{"tags": [], "owner": {"reputation": 649, "user_id": 8456608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jDMgZ.jpg?s=128&g=1", "display_name": "bm13563", "link": "https://stackoverflow.com/users/8456608/bm13563"}, "is_accepted": true, "score": 0, "last_activity_date": 1514056412, "creation_date": 1514056412, "answer_id": 47955251, "question_id": 47905096, "link": "https://stackoverflow.com/questions/47905096/opening-and-then-breaking-links-to-a-word-document-from-excel/47955251#47955251", "title": "Opening and then breaking links to a Word document from Excel", "body": "<p>The above code would have been fine, but I didn't realise that the code had to be different if the text was in textboxes.</p>\n\n<p>I struggled to break the links within textboxes, and kept getting run-time error 438. However, I found a workaround:</p>\n\n<p>I wrote a sub in the word documents:</p>\n\n<pre><code>Sub Unlink\n\nSelection.Fields.Unlink\n\nEnd Sub\n</code></pre>\n\n<p>I then called this macro from my excel document:</p>\n\n<pre><code>Sub FnOpeneWordDoc()\n\n   Dim objWord\n   Dim objDoc\n\n   Set objWord = CreateObject(\"Word.Application\")\n\n   Set objDoc = objWord.Documents.Open(\"filename\")\n\n   objWord.Visible = True\n\n   For i = 1 To objDoc.Shapes.Count\n\n    objDoc.Shapes(i).Select\n\n    objDoc.Application.Run (\"unlink\")\n\n   Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 649, "user_id": 8456608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jDMgZ.jpg?s=128&g=1", "display_name": "bm13563", "link": "https://stackoverflow.com/users/8456608/bm13563"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 745, "favorite_count": 2, "accepted_answer_id": 47955251, "answer_count": 1, "score": 0, "last_activity_date": 1514056412, "creation_date": 1513769650, "last_edit_date": 1513787882, "question_id": 47905096, "link": "https://stackoverflow.com/questions/47905096/opening-and-then-breaking-links-to-a-word-document-from-excel", "title": "Opening and then breaking links to a Word document from Excel", "body": "<p>I have an excel spreadsheet that is linked to multiple Word documents (.docx), which act as templates.</p>\n\n<p>I have written a macro that opens the required word template from excel (the template chosen is dependent on the value of cell M17). The links in the word template update automatically as word opens. I am then trying to break the links of the document that I opened. This is what I have so far:</p>\n\n<pre><code>Function FnOpeneWordDoc()\n\n   Dim objWord\n\n   Dim objDoc\n\n   Dim path As String\n\n   path = Range(\"M17\")\n\n   Set objWord = CreateObject(\"Word.Application\")\n\n   Set objDoc = objWord.Documents.Open(\"*file_path*\" &amp; path &amp; \".docx\")\n\n   objWord.Visible = True\n\n   Application.Wait (Now + TimeValue(\"0:00:30\"))\n\n   objDoc.Fields.Unlink\n\nEnd Function\n</code></pre>\n\n<p>I suspect that it isn't working because the macro is trying to break the links before the document has fully loaded (and therefore the existing links haven't had a chance to update?), which is why I added the wait. Unfortunately this doesn't seem to be the solution.</p>\n"}, {"tags": ["arrays", "vba"], "comments": [{"owner": {"reputation": 878, "user_id": 1509300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MiEeo.png?s=128&g=1", "display_name": "SBF", "link": "https://stackoverflow.com/users/1509300/sbf"}, "edited": false, "score": 2, "creation_date": 1513770995, "post_id": 47905086, "comment_id": 82777655, "body": "Array() function returns a Variant containing an array."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1513771418, "post_id": 47905086, "comment_id": 82777921, "body": "Did you see <a href=\"https://stackoverflow.com/questions/19369132/declare-and-initialize-string-array-in-vba\">this question</a>?"}], "answers": [{"comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1513772021, "post_id": 47905764, "comment_id": 82778325, "body": "Excellent ! That exactly covers my case, and makes the array easier to code as a bonus. All I have to see now is if it&#39;s any faster :-)"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1513777294, "post_id": 47905764, "comment_id": 82781807, "body": "Strangely, the &#39;pure string&#39; version seems slower."}], "tags": [], "owner": {"reputation": 878, "user_id": 1509300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MiEeo.png?s=128&g=1", "display_name": "SBF", "link": "https://stackoverflow.com/users/1509300/sbf"}, "is_accepted": true, "score": 1, "last_activity_date": 1513771733, "creation_date": 1513771733, "answer_id": 47905764, "question_id": 47905086, "link": "https://stackoverflow.com/questions/47905086/properly-define-string-array-in-vba/47905764#47905764", "title": "Properly define string array in VBA", "body": "<p>Try this:</p>\n\n<pre><code>Sub test2()\n    Dim s1 As Variant\n    Dim s2() As String\n    s1 = Array(\"a\", \"b\", \"c\")\n    s2 = Split(\"a,b,c\", \",\")\n\n    Debug.Print VarType(s1) &amp; \" Array of variants\"\n    Debug.Print VarType(s2) &amp; \" Array of strings\"\nEnd Sub\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>8204 Array of variant\n8200 Array of string\n</code></pre>\n"}], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8610, "favorite_count": 0, "accepted_answer_id": 47905764, "answer_count": 1, "score": 0, "last_activity_date": 1513772311, "creation_date": 1513769626, "last_edit_date": 1513772311, "question_id": 47905086, "link": "https://stackoverflow.com/questions/47905086/properly-define-string-array-in-vba", "title": "Properly define string array in VBA", "body": "<p>I usually use variants when I need an array:</p>\n\n<pre><code>Sub test()   'runs fine\n    Dim s\n    s = Array(\"a\", \"b\", \"c\")\n    Debug.Print s(1)\nEnd Sub\n</code></pre>\n\n<p>Now I want performance for a specific case, so I thought I could save a few millisec by using a String array. How do I do that?  </p>\n\n<p>My try: </p>\n\n<pre><code>Sub test2()\n    Dim s() As String\n    s = Array(\"a\", \"b\", \"c\")     'run time error 13: type mismatch\n    Debug.Print s(1)\nEnd Sub \n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "excel", "listview"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1513769484, "post_id": 47904946, "comment_id": 82776718, "body": "Welcome!  You&#39;ll need to share a lot more information that that, including but not limited to, the subs, properties, errors, listviews and objects you mentioned, and what you have have, what you tried, what your <i>specific</i> problem is, and what you need in the end.  Please check out the <a href=\"https://stackoverflow.com/tour\">tour</a>, ask well as <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and special attention to <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": true, "score": 0, "last_activity_date": 1514973631, "creation_date": 1514973631, "answer_id": 48075074, "question_id": 47904946, "link": "https://stackoverflow.com/questions/47904946/listview-properties-are-not-available/48075074#48075074", "title": "listview properties are not available", "body": "<p>SOLVED: By declaring the type of input parameter as Object instead of Listivew (Listview4), everything works fine. It is still strange that Listview can have different properties within the same form. </p>\n"}], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "accepted_answer_id": 48075074, "answer_count": 1, "score": -6, "last_activity_date": 1514973631, "creation_date": 1513769185, "last_edit_date": 1531164843, "question_id": 47904946, "link": "https://stackoverflow.com/questions/47904946/listview-properties-are-not-available", "title": "listview properties are not available", "body": "<p>I pass a listview to a custom sub and some of the listview properties are not available within the called sub, e.g. .name, .width, and a few more.<br/> \nChecking the input listview in the called sub, all properties are visible in the watch window. Trying to change any of these missing ones errors (both from within app or immediate window). <br/>\nIn the calling sub all properties are available and can be changed. <br/>\nStrange is that object browser displays only the reduced set for Listview4.<br/>\nThe object itself is created with the built-in form designer, type is Listview4. <br/>\nApplies to Excel 2013 Prof on W7 and W10. </p>\n\n<p>SOLVED: By declaring the type of input parameter as Object instead of Listivew (Listview4), everything works fine. It is still strange that Listview can have different properties within the same form. </p>\n"}, {"tags": ["vba", "excel", "excel-2016"], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 9122359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81ff9c8bf204f9f7efeb39f206c801ff?s=128&d=identicon&r=PG&f=1", "display_name": "The Brainlet Exterminator", "link": "https://stackoverflow.com/users/9122359/the-brainlet-exterminator"}, "edited": false, "score": 0, "creation_date": 1513769527, "post_id": 47904918, "comment_id": 82776750, "body": "Thank you for the quick answer. However, I opened a clean new worksheet, pasted your first bit of code into the worksheet code section, and it&#39;s still giving me the 1004 error. Any ideas what this could mean?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 123, "user_id": 9122359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81ff9c8bf204f9f7efeb39f206c801ff?s=128&d=identicon&r=PG&f=1", "display_name": "The Brainlet Exterminator", "link": "https://stackoverflow.com/users/9122359/the-brainlet-exterminator"}, "edited": false, "score": 0, "creation_date": 1513769556, "post_id": 47904918, "comment_id": 82776768, "body": "Which first bit? @TheBrainletExterminator"}, {"owner": {"reputation": 123, "user_id": 9122359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81ff9c8bf204f9f7efeb39f206c801ff?s=128&d=identicon&r=PG&f=1", "display_name": "The Brainlet Exterminator", "link": "https://stackoverflow.com/users/9122359/the-brainlet-exterminator"}, "edited": false, "score": 0, "creation_date": 1513769780, "post_id": 47904918, "comment_id": 82776897, "body": "Under &quot;Open a new Excel file and try this code:&quot; and above &quot;Or if you really mean ...&quot;"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 123, "user_id": 9122359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81ff9c8bf204f9f7efeb39f206c801ff?s=128&d=identicon&r=PG&f=1", "display_name": "The Brainlet Exterminator", "link": "https://stackoverflow.com/users/9122359/the-brainlet-exterminator"}, "edited": false, "score": 0, "creation_date": 1513770097, "post_id": 47904918, "comment_id": 82777109, "body": "@TheBrainletExterminator - that is strange. Where do you put the code? Do you put it in a module? Are you sure that you open a New Excel workbook? Can you restart your PC and try again? (I am not joking about the resetart, it can be that you have more than 1 workbook opened and you are somehow calling the wrong code)."}, {"owner": {"reputation": 123, "user_id": 9122359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81ff9c8bf204f9f7efeb39f206c801ff?s=128&d=identicon&r=PG&f=1", "display_name": "The Brainlet Exterminator", "link": "https://stackoverflow.com/users/9122359/the-brainlet-exterminator"}, "edited": false, "score": 0, "creation_date": 1513770460, "post_id": 47904918, "comment_id": 82777329, "body": "Yep, new workbook, pasted the code behind the sheet. Just restarted my computer - same issue."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 123, "user_id": 9122359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81ff9c8bf204f9f7efeb39f206c801ff?s=128&d=identicon&r=PG&f=1", "display_name": "The Brainlet Exterminator", "link": "https://stackoverflow.com/users/9122359/the-brainlet-exterminator"}, "edited": false, "score": 0, "creation_date": 1513770534, "post_id": 47904918, "comment_id": 82777385, "body": "@TheBrainletExterminator - put it behind a module, not behind a sheet."}, {"owner": {"reputation": 123, "user_id": 9122359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81ff9c8bf204f9f7efeb39f206c801ff?s=128&d=identicon&r=PG&f=1", "display_name": "The Brainlet Exterminator", "link": "https://stackoverflow.com/users/9122359/the-brainlet-exterminator"}, "edited": false, "score": 0, "creation_date": 1513770960, "post_id": 47904918, "comment_id": 82777632, "body": "Did that, still Error 1004. This time with the message that property Visible of class &quot;Worksheet&quot; can not be set up (Excel at my job is in my native language, so I&#39;m not sure what it says literally)."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 1, "creation_date": 1513771286, "post_id": 47904918, "comment_id": 82777836, "body": "If you have only one sheet in the workbook, you cannot hide it and you might be getting error on the line <code>Worksheets(1).Visible = xlVeryHidden</code> Right?"}, {"owner": {"reputation": 123, "user_id": 9122359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81ff9c8bf204f9f7efeb39f206c801ff?s=128&d=identicon&r=PG&f=1", "display_name": "The Brainlet Exterminator", "link": "https://stackoverflow.com/users/9122359/the-brainlet-exterminator"}, "reply_to_user": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 1, "creation_date": 1513771402, "post_id": 47904918, "comment_id": 82777909, "body": "@sktneer Oh I did not notice that! You&#39;re absolutely right, now I don&#39;t get the error."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 123, "user_id": 9122359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81ff9c8bf204f9f7efeb39f206c801ff?s=128&d=identicon&r=PG&f=1", "display_name": "The Brainlet Exterminator", "link": "https://stackoverflow.com/users/9122359/the-brainlet-exterminator"}, "edited": false, "score": 0, "creation_date": 1513775752, "post_id": 47904918, "comment_id": 82780787, "body": "@TheBrainletExterminator - so I suppose you were using Excel-2016?"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1513769384, "last_edit_date": 1513769384, "creation_date": 1513769080, "answer_id": 47904918, "question_id": 47904792, "link": "https://stackoverflow.com/questions/47904792/vba-excel-how-to-get-row-and-column-number-of-named-range/47904918#47904918", "title": "VBA Excel: how to get row and column number of named range?", "body": "<p>That's a strange question you are having there. However, in general getting the column and row of a hidden worksheet should be trivial, thus I suppose you are making some small mistake somewhere.</p>\n\n<p>Open a new Excel file and try this code:</p>\n\n<pre><code>Option Explicit    \nPublic Sub TestMe()      \n\n    Dim tempEntryvalue As Range\n\n    Set tempEntryvalue = Worksheets(1).Range(\"A1:Z10\")\n    Worksheets(1).Visible = xlVeryHidden        \n    Debug.Print tempEntryvalue.Row\n    Debug.Print tempEntryvalue.Column  \n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Or if you really mean <code>NamedRange</code> (your code looks like if the range is declared as a variable), then this is probably the easiest solution:</p>\n\n<pre><code>Public Sub TestMe()    \n\n    Debug.Print [temp_entryvalue].Row\n    Debug.Print [temp_entryvalue].Column\n    Debug.Print Range(\"temp_entryvalue\").Row\n    Debug.Print Range(\"temp_entryvalue\").Column    \n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 9122359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81ff9c8bf204f9f7efeb39f206c801ff?s=128&d=identicon&r=PG&f=1", "display_name": "The Brainlet Exterminator", "link": "https://stackoverflow.com/users/9122359/the-brainlet-exterminator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12209, "favorite_count": 0, "accepted_answer_id": 47904918, "answer_count": 1, "score": 2, "last_activity_date": 1513775732, "creation_date": 1513768680, "last_edit_date": 1513775732, "question_id": 47904792, "link": "https://stackoverflow.com/questions/47904792/vba-excel-how-to-get-row-and-column-number-of-named-range", "title": "VBA Excel: how to get row and column number of named range?", "body": "<p>I have the following problem and it's driving me NUTS! I work on a large database program in Excel, and I'm trying to retrieve the row and column numbers of specific named ranges. The following code used to work (temp_entryvalue is the name of the range):</p>\n\n<pre><code>temp_datafile_row = Workbooks(datafile_filepath).Worksheets(temp_datafile_worksheet).Range(temp_entryvalue).Row\ntemp_datafile_col = Workbooks(datafile_filepath).Worksheets(temp_datafile_worksheet).Range(temp_entryvalue).Column\n</code></pre>\n\n<p>I get the ole' Error 1004. Troubleshooting a bit, the problem here seems to be that the range associated with temp_entryvalue is hidden in the excel sheet, however the name is defined and there is a row and column number assigned to. </p>\n\n<p>This however, all used to work. Until I changed one thing: instead of writing directly to the database excel worksheet, I first put everything in an array, so that only at the very end I open the database worksheet and copy all the data. Before I did this, everything used to work fine. </p>\n\n<p>So how do I fix this? How do I retrieve the row and column number of a Named Range that is hidden, but DOES have a row and column number associated to it?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 2, "creation_date": 1513767719, "post_id": 47904444, "comment_id": 82775678, "body": "So you have printed the code and taken a picture of it?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1513769898, "post_id": 47904444, "comment_id": 82776971, "body": "@ashleedawg - my comment is really not a smartass, I am trying to think about a scenario where it is easier to print code and take a photo of it, then upload the photo to a computer than simply copy+paste of the code. The only scenario I can think of is a German exam (nothing against the Germans, just their IT exams are like this)."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1513770677, "post_id": 47904444, "comment_id": 82777471, "body": "@Vityata - ah ok, I deleted my <i>smartass</i> comment (just being facetious, sorry! :) -  I don&#39;t get how printing code is at all related to the question, but to be fair, there wasn&#39;t enough information for me to understand the question in the first place."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1513770731, "post_id": 47904444, "comment_id": 82777504, "body": "@ashleedawg - see the history of the editions +  <a href=\"https://i.stack.imgur.com/WFXec.jpg\" rel=\"nofollow noreferrer\">i.stack.imgur.com/WFXec.jpg</a>"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1513771370, "post_id": 47904444, "comment_id": 82777888, "body": "@Peter -- oh my goodness, you actually <i>did</i> print &amp; photograph &amp; upload your code?  To save typing it out?  But....  <i>ah nm</i>, um, <b>Hi! Welcome to Stack Overflow!</b> I see you&#39;ve had an Answer already but either way, <b>please take a moment</b> to check out the <a href=\"https://stackoverflow.com/tour\">tour</a> as well as <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>.  (Also <a href=\"https://meta.stackoverflow.com/questions/334822/how-do-i-ask-and-answer-homework-questions\">this</a> if it&#39;s relevant), all of which will help you ask &amp; <a href=\"https://stackoverflow.com/posts/47904444/edit\">edit</a> in such a way to <i>help us to help you</i> with this &amp; <a href=\"https://stackoverflow.com/help/on-topic\">future</a> questions!"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1513771751, "post_id": 47904444, "comment_id": 82778148, "body": "@Vityata -- I&#39;m half German so I can poke fun at them. When my mother learned to send emails, she would print 2 copies of each Sent email, one for her file, and the other she would put in a stamped envelope to mail to the recipient... Maybe part of the reason they&#39;re running out of trees. \ud83c\udf32\u200e"}, {"owner": {"reputation": 1, "user_id": 9122125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bfaa7c137e940db38734b2c4b0bb883?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9122125/peter"}, "edited": false, "score": 0, "creation_date": 1513772221, "post_id": 47904444, "comment_id": 82778440, "body": "thank you all for your input:-) and the code which works as I wanted"}], "answers": [{"comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1513777490, "post_id": 47905114, "comment_id": 82781932, "body": "i think it would be a little more readable if you used a for loop inside  <code>For i = 1 To 18         formularz.Range(&quot;B&quot; &amp; i + 5) = Rng.Offset(0, i).Value  Next i</code>"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1513778059, "post_id": 47905114, "comment_id": 82782315, "body": "@Marcucciboy2 point taken,... thanks. Updated my answer to reflect your comment.. :)"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 0, "last_activity_date": 1513777907, "last_edit_date": 1513777907, "creation_date": 1513769691, "answer_id": 47905114, "question_id": 47904444, "link": "https://stackoverflow.com/questions/47904444/vba-excell-if-else-in-the-loop-doesnt-work-as-i-need-to/47905114#47905114", "title": "VBA excell - if-else in the loop doesn&#39;t work as i need to", "body": "<p>I think if you replace your code with the following, it should work as expected:</p>\n\n<pre><code>Dim licznik As Long\nDim x As Long\nDim specyfikacje As Worksheet\nDim formularz As Worksheet\n\nSet specyfikacje = Sheets(\"specifications\")\nSet formularz = Sheets(\"form\")\n\nspec_number = formularz.Range(\"b4\").Value\n\nIf spec_number = \"\" Then\n    MsgBox \"Type the specification number in the designated field: B4\"\nElse\n\n    licznik = specyfikacje.Cells(specyfikacje.Rows.Count, \"A\").End(xlUp).Row 'find the last row on Column A on Sheet specifications\n\n    With specyfikacje.Range(\"A:A\")\n        Set Rng = .Find(What:=spec_number) 'search column A of specifications for the spec_number\n            If Not Rng Is Nothing Then 'if found\n                For x = 1 To 18\n                    formularz.Range(\"b\" &amp; i + 5) = Rng.Offset(0, i).Value\n                Next x\n            Else\n                MsgBox \"The product you typed in doesn't exist\"\n            End If\n    End With\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9122125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bfaa7c137e940db38734b2c4b0bb883?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9122125/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1513777907, "creation_date": 1513767452, "last_edit_date": 1531161705, "question_id": 47904444, "link": "https://stackoverflow.com/questions/47904444/vba-excell-if-else-in-the-loop-doesnt-work-as-i-need-to", "title": "VBA excell - if-else in the loop doesn&#39;t work as i need to", "body": "<p>I\u2019m setting up a simple form containing about 15 fields which at the end are copied and saved in my database (same excel file but separate spreadsheet). Then I need to design a procedure which will enable me to amend existing records. \nI\u2019ve created one which recalls all the data from database back in to the form so they can be amended and then saved. It worked fine but I don\u2019t really know when to put the ELSE for the case when searched record doesn\u2019t exist in the table.</p>\n\n<pre><code>Public Sub amend()\nDim spec_number As Long\nDim licznik As Long\nDim x As Long\nDim specyfikacje As Worksheet\nDim formularz As Worksheet\n\nSet specyfikacje = Sheets(\"specifications\")\nSet formularz = Sheets(\"form\")\n\nspec_number = formularz.Range(\"b4\").Value\n\nIf spec_number = \"\" Then\n    MsgBox \"Type the specification number in the designated field: B4\"\nElse\n    licznik = 2\n    x = 2\n\n    Do Until (specyfikacje.Range(\"A\" &amp; licznik).Value = \"\") = True\n        licznik = licznik + 1\n    Loop\n\n    Do Until x &gt; licznik\n        If spec_number = specyfikacje.Range(\"a\" &amp; x).Value Then\n            formularz.Range(\"b6\") = specyfikacje.Range(\"b\" &amp; x).Value\n            formularz.Range(\"b7\") = specyfikacje.Range(\"c\" &amp; x).Value\n            formularz.Range(\"b8\") = specyfikacje.Range(\"d\" &amp; x).Value\n            formularz.Range(\"b9\") = specyfikacje.Range(\"e\" &amp; x).Value\n            formularz.Range(\"b10\") = specyfikacje.Range(\"f\" &amp; x).Value\n            formularz.Range(\"b11\") = specyfikacje.Range(\"g\" &amp; x).Value\n            formularz.Range(\"b12\") = specyfikacje.Range(\"h\" &amp; x).Value\n            formularz.Range(\"b13\") = specyfikacje.Range(\"i\" &amp; x).Value\n            formularz.Range(\"b14\") = specyfikacje.Range(\"j\" &amp; x).Value\n            formularz.Range(\"b15\") = specyfikacje.Range(\"k\" &amp; x).Value\n            formularz.Range(\"b16\") = specyfikacje.Range(\"l\" &amp; x).Value\n            formularz.Range(\"b17\") = specyfikacje.Range(\"m\" &amp; x).Value\n            formularz.Range(\"b18\") = specyfikacje.Range(\"n\" &amp; x).Value\n            formularz.Range(\"b19\") = specyfikacje.Range(\"o\" &amp; x).Value\n            formularz.Range(\"b20\") = specyfikacje.Range(\"p\" &amp; x).Value\n            formularz.Range(\"b21\") = specyfikacje.Range(\"q\" &amp; x).Value\n            formularz.Range(\"b22\") = specyfikacje.Range(\"r\" &amp; x).Value\n            formularz.Range(\"b23\") = specyfikacje.Range(\"s\" &amp; x).Value\n        Else\n            MsgBox \"The product you typed in doesn't exist\"\n        End If\n    x = x + 1\n    Loop\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy"], "comments": [{"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1513768191, "post_id": 47904344, "comment_id": 82775942, "body": "Please include your code!  We can&#39;t help you fix it if we can&#39;t see it."}, {"owner": {"reputation": 37, "user_id": 5994316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4e59b73a36d87f3104b846b9ad7b34e7?s=128&d=identicon&r=PG&f=1", "display_name": "Ashley Thomson", "link": "https://stackoverflow.com/users/5994316/ashley-thomson"}, "reply_to_user": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1513770452, "post_id": 47904344, "comment_id": 82777322, "body": "I don&#39;t really have any code that would be beneficial as I&#39;ve not managed to find anything that is doing what I need. I&#39;ll add the code i found that does a similar thing ,to the post"}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1513770758, "post_id": 47904344, "comment_id": 82777522, "body": "Am I right in thinking that the second tab is an aggregated view of the first (@ manager level)?"}, {"owner": {"reputation": 37, "user_id": 5994316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4e59b73a36d87f3104b846b9ad7b34e7?s=128&d=identicon&r=PG&f=1", "display_name": "Ashley Thomson", "link": "https://stackoverflow.com/users/5994316/ashley-thomson"}, "reply_to_user": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1513771046, "post_id": 47904344, "comment_id": 82777688, "body": "yep, that will show the teams of all managers, this is then used to vlookup against in another tab"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513771278, "post_id": 47904344, "comment_id": 82777831, "body": "What version of Excel as you using? This sounds like a userform/dataform kind of task or even one for Access."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513771420, "post_id": 47904344, "comment_id": 82777923, "body": "And generally avoid working with merged cells as will make finding and working with some of your ranges that little bit more difficult. (Or have a hidden row that is not merged that you reference)."}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1513771632, "post_id": 47904344, "comment_id": 82778072, "body": "Personally, I&#39;d solve this problem using Excel formulas or PowerQuery transformations.  There&#39;s nothing wrong with VBA, but you&#39;ll end up writing a lot more code this way.  Always a little tricky answering Excel Qs, as we don&#39;t have the spreadsheet and they are not easy to share.  Main issue with your code is this line <code>FindString = Sheets(&quot;Calc&quot;).Range(&quot;G7&quot;).Value</code>.  It limits you to 1 row.  Replacing this with a loop would be a great start."}], "owner": {"reputation": 37, "user_id": 5994316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4e59b73a36d87f3104b846b9ad7b34e7?s=128&d=identicon&r=PG&f=1", "display_name": "Ashley Thomson", "link": "https://stackoverflow.com/users/5994316/ashley-thomson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513770559, "creation_date": 1513767067, "last_edit_date": 1513770559, "question_id": 47904344, "link": "https://stackoverflow.com/questions/47904344/vba-copy-a-table-of-user-input-data-to-a-database-tab-based-on-the-employees-na", "title": "VBA Copy a table of user input data to a database tab, based on the employees name", "body": "<p>I have a tab in excel where managers can input their forecast of Holidays, Sickness, Training and other lost time for the next 4 months.</p>\n\n<p>To make this smoother I've made it so they select their own name and their team shows in the table and they can input the lost days for the team. </p>\n\n<p>What I'm having issues with is the code that then takes this information and copies it to another tab, and puts it in against the right employee. This data tab has every employee so it needs to search down column B for the matching name and copy the data into the corresponding columns. I've tried a few different ways but none quite do what i'm looking for</p>\n\n<p>First image is the screen the manager sees to enter their forecast of lost days</p>\n\n<p>second image is the screen that the data needs to be copied into the archive it for it to be used elsewhere</p>\n\n<p><a href=\"https://i.stack.imgur.com/c1pdL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/c1pdL.png\" alt=\"Table where Manager enters their teams data\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/LPAHT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LPAHT.png\" alt=\"Table where the data needs to be copied to\"></a>\nHopefully this coveres my query, any help would be wonderful</p>\n\n<p>Closest code I could get working below, only copies 1 value and for only 1 employee however</p>\n\n<pre><code>Sub Find_First()\nDim FindString As String\nDim Rng As Range\nFindString = Sheets(\"Calc\").Range(\"G7\").Value\nIf Trim(FindString) &lt;&gt; \"\" Then\n    With Sheets(\"DATA Build\").Range(\"A:A\")\n        Set Rng = .Find(What:=FindString, _\n                    After:=.Cells(.Cells.Count), _\n                    LookIn:=xlValues, _\n                    LookAt:=xlWhole, _\n                    SearchOrder:=xlByRows, _\n                    SearchDirection:=xlNext, _\n                    MatchCase:=False)\n    If Not Rng Is Nothing Then\n        Application.Goto Rng, True\n        Sheets(\"Calc\").Range(\"I31\").Copy Sheets(\"DATA Build\").Cells(Rng.Row, \"BD\")\n    Else\n        MsgBox \"Nothing found\"\n    End If\nEnd With\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 1, "creation_date": 1513767597, "post_id": 47904202, "comment_id": 82775593, "body": "That&#39;s a lot of checks that need to be passed before you can enter the innermost if block.  Looping might provide a way of running all these checks without writing as many lines of code.  But without a bit more context it is hard to provide an example.  The trick here is to spot a pattern, ex: we check every third row against the same row in the following sheet."}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1513783683, "post_id": 47904202, "comment_id": 82786153, "body": "You could declare your sheets AND declare the values you repeatedly work with as variables in order to clean up your code. Also your tab-use makes me dizzy."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1513789355, "post_id": 47904202, "comment_id": 82789558, "body": "You want to check that the range <code>&#39;Tab 1 - Prijslijst&#39;!CQ:ED</code> is equal to the range  <code>&#39;Tab 2 - Nieuwe prijzen&#39;!C:AP</code> on a specific row?  Is it only one row you&#39;re checking?"}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1513800437, "post_id": 47904202, "comment_id": 82794921, "body": "What a nightmare ... well, at least it isn&#39;t Fortran!"}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1513800618, "post_id": 47904202, "comment_id": 82795004, "body": "What you should do is replace the string math in the range statements with <code>.Cells()</code> calls. <code>Range(&quot;DK&quot; &amp; xlCell3.Row)</code>  =&gt; <code>Range(&quot;DK1&quot;).Cells(xlCell3.Row,1)</code>"}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1513801379, "post_id": 47904202, "comment_id": 82795346, "body": "Please show us what <code>xlCell2</code> and <code>xlCell3</code> are (Dim statement) and how they are set."}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 8806711, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cUmNq.png?s=128&g=1", "display_name": "Maurice van Dorst", "link": "https://stackoverflow.com/users/8806711/maurice-van-dorst"}, "edited": false, "score": 0, "creation_date": 1513768568, "post_id": 47904458, "comment_id": 82776161, "body": "Thanks for your answer, but this isn&#39;t quite what I am looking for. The thing is, due to the fact that Excel VBA does not allow lines to be longer than what is current the first line of IF statements in my code, I had to use that many IF statements. The goal of the code is: if all of those IF statements are true, execute this code: Sheets(2).Range(&quot;A&quot; &amp; xlCell2.Row).Interior.ColorIndex = 45. If not, execute Call ntofourty(xlCell3, xlCell2)."}], "tags": [], "owner": {"reputation": 137, "user_id": 8411407, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e8356bb0c37630319561968a3668499f?s=128&d=identicon&r=PG&f=1", "display_name": "MyName", "link": "https://stackoverflow.com/users/8411407/myname"}, "is_accepted": false, "score": 1, "last_activity_date": 1513767507, "creation_date": 1513767507, "answer_id": 47904458, "question_id": 47904202, "link": "https://stackoverflow.com/questions/47904202/vba-excessive-use-of-if-statements/47904458#47904458", "title": "VBA - Excessive use of IF statements", "body": "<p>You might want to check out <code>select case</code>. This takes input (cell DK3 nogwat) and compares it to different cases. </p>\n\n<pre><code>Sub selectcase()\n\nDim var As Range\nDim wSheet As Worksheet 'make some for the other worksheets as well\n\nSet wSheet = ActiveSheet\nSet var = wSheet.Range(\"DK3\")\n\n    Select Case var.Value 'insert variable (or range) to test DK3 in this case\n    Case wSheet.Range(\"input range\") 'check to see if it matches the value in sheet 3, cell ...\n         call ...  'output, modify this to your use\n    Case wSheet.Range(\"I18\")\n         MsgBox \"It's I18\"\n    Case wSheet.Range(\"I19\")\n         MsgBox \"It's I19\"\n    Case Else\n         MsgBox \"It's none\"\nEnd Select\n\nEnd Sub\n</code></pre>\n\n<p>Because of the complexity of your code I don't quite get what your doing, so I don't know if you can use this precisely as you want.</p>\n"}, {"comments": [{"owner": {"reputation": 93, "user_id": 8806711, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cUmNq.png?s=128&g=1", "display_name": "Maurice van Dorst", "link": "https://stackoverflow.com/users/8806711/maurice-van-dorst"}, "edited": false, "score": 0, "creation_date": 1513768276, "post_id": 47904599, "comment_id": 82776004, "body": "Good answer, yet not really what I was looking for. I was looking to replace the big pile of IF, AND and THEN statements for much cleaner code."}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "reply_to_user": {"reputation": 93, "user_id": 8806711, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cUmNq.png?s=128&g=1", "display_name": "Maurice van Dorst", "link": "https://stackoverflow.com/users/8806711/maurice-van-dorst"}, "edited": false, "score": 0, "creation_date": 1513770643, "post_id": 47904599, "comment_id": 82777451, "body": "Yeah the IFs, ANDs and THENs make this code hard to read.  I couldn&#39;t see a pattern in the checks.  I looked for one in an attempt to replace the IFs with a For/Do/While loop.  Can you provide a high-level overview?"}], "tags": [], "owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "is_accepted": false, "score": 0, "last_activity_date": 1513767958, "creation_date": 1513767958, "answer_id": 47904599, "question_id": 47904202, "link": "https://stackoverflow.com/questions/47904202/vba-excessive-use-of-if-statements/47904599#47904599", "title": "VBA - Excessive use of IF statements", "body": "<p>This change would save you 14 lines.  </p>\n\n<pre><code>Dim innerMostCodeExecuted As Boolean    ' Default value of a bool is false.\n\nIf Sheets(\"Tab 1 - Prijslijst\").Range(\"DK\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"W\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DL\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"X\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DM\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"Y\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DN\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"Z\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DO\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AA\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DP\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AB\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DQ\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AC\" &amp; xlCell2.Row).Value Then\n    If Sheets(\"Tab 1 - Prijslijst\").Range(\"DR\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AD\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DS\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AE\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DT\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AF\" &amp; xlCell2.Row).Value Then\n        If Sheets(\"Tab 1 - Prijslijst\").Range(\"DU\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AG\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DV\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AH\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DW\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AI\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DX\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AJ\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DY\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AK\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DZ\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AL\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"EA\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AM\" &amp; xlCell2.Row).Value Then\n            If Sheets(\"Tab 1 - Prijslijst\").Range(\"EB\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AN\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"EC\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AO\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"ED\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AP\" &amp; xlCell2.Row).Value Then\n                If Sheets(\"Tab 1 - Prijslijst\").Range(\"CQ\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"C\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"CR\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"D\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"CS\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"E\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"CT\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"F\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"CU\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"G\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"CV\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"H\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"CW\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"I\" &amp; xlCell2.Row).Value Then\n                    If Sheets(\"Tab 1 - Prijslijst\").Range(\"CX\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"J\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"CY\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"K\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"CZ\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"L\" &amp; xlCell2.Row).Value Then\n                        If Sheets(\"Tab 1 - Prijslijst\").Range(\"DA\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"M\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DB\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"N\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DC\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"O\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DD\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"P\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DE\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"Q\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DF\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"R\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DG\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"S\" &amp; xlCell2.Row).Value Then\n                            If Sheets(\"Tab 1 - Prijslijst\").Range(\"DH\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"T\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DI\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"U\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DJ\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"V\" &amp; xlCell2.Row).Value Then\n\n                                ' Set to true, so we know this block was executed.\n                                innerMostCodeExecuted = True\n\n                            End If\n                        End If\n                    End If\n                End If\n            End If\n        End If\n    End If\nEnd If\n\n\n' Remove repeated else blocks.\nIf innerMostCodeExecuted = False Then ntofourty xlCell3, xlCell2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 8893651, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tg0d5x-Z7FY/AAAAAAAAAAI/AAAAAAAAALs/NWttH9xK348/photo.jpg?sz=128", "display_name": "Umair Mehmood", "link": "https://stackoverflow.com/users/8893651/umair-mehmood"}, "is_accepted": false, "score": 0, "last_activity_date": 1513786250, "last_edit_date": 1513786250, "creation_date": 1513774137, "answer_id": 47906461, "question_id": 47904202, "link": "https://stackoverflow.com/questions/47904202/vba-excessive-use-of-if-statements/47906461#47906461", "title": "VBA - Excessive use of IF statements", "body": "<p>Try this code, modify it according to your need:</p>\n\n<pre><code>Dim xranges As Variant, yranges As Variant, countranges As Long\nxranges = Array(\"DK\", \"DL\", \"DM\", \"DN\", \"DO\", \"DP\", \"DQ\", \"DR\", \"DS\", \"DT\", \"DU\", \"DV\", \"DW\", \"DX\", \"DY\")\nyranges = Array(\"W\", \"X\", \"Y\", \"Z\", \"AA\", \"AB\", \"AC\", \"AD\", \"AE\", \"AF\", \"AG\", \"AH\", \"AI\", \"AJ\", \"AK\", \"AL\")\ncountranges = 0\nFor i = 0 To UBound(xranges)\n    If Sheets(\"Tab 1 - Prijslijst\").Range(xranges(i) &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(yranges(i) &amp; xlCell2.Row).Value Then\n        countranges = countranges + 1\n    End If\nnext i\n\nIf countranges = UBound(xranges) + 1 Then\n    Call ntofourty(xlCell3, xlCell2)\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1513783044, "post_id": 47906745, "comment_id": 82785740, "body": "I really like this answer (because we had the same idea :D) but I added to it in a separate answer since it didn&#39;t loop through each range Maurice wanted to check"}], "tags": [], "owner": {"reputation": 878, "user_id": 1509300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MiEeo.png?s=128&g=1", "display_name": "SBF", "link": "https://stackoverflow.com/users/1509300/sbf"}, "is_accepted": false, "score": 0, "last_activity_date": 1513783708, "last_edit_date": 1513783708, "creation_date": 1513775086, "answer_id": 47906745, "question_id": 47904202, "link": "https://stackoverflow.com/questions/47904202/vba-excessive-use-of-if-statements/47906745#47906745", "title": "VBA - Excessive use of IF statements", "body": "<p>I think you need something like this:<br>\n<code>col1</code> is the range in \"Tab 1 - Prijslijst\"<br>\n<code>col2</code> is the start of the range in \"Tab 2 - Nieuwe prijzen\"<br>\nIf you wan to change the ranges, modify the <code>Range(\"C:C\").Column</code> parts</p>\n\n<pre><code>Dim ws1 As Worksheet: Set ws1 = Worksheet(\"Tab 1 - Prijslijst\")\nDim ws2 As Worksheet: Set ws2 = Worksheet(\"Tab 2 - Nieuwe prijzen\")\n\nDim row1 As Integer: row1 = xlCell3.row\nDim col1 As Integer\nDim row2 As Integer: row2 = xlCell2.row\nDim col2 As Integer: col2 = Range(\"C:C\").Column\n\ninnerMostCodeExecuted = True\n\nFor col1 = Range(\"CQ:CQ\").Column To Range(\"EA:EA\").Column\n    If ws1.Cells(xlCell3.row, col1).Value &lt;&gt; ws2.Cells(xlCell2.row, col2).Value Then\n        innerMostCodeExecuted = False\n        Exit For\n    End If\n    col2 = col2 + 1\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "is_accepted": false, "score": 0, "last_activity_date": 1513784862, "last_edit_date": 1513784862, "creation_date": 1513782842, "answer_id": 47909139, "question_id": 47904202, "link": "https://stackoverflow.com/questions/47904202/vba-excessive-use-of-if-statements/47909139#47909139", "title": "VBA - Excessive use of IF statements", "body": "<p>Okay so my answer is meant to build on @SBF's answer. We had pretty similar ideas but their answer does not loop through each range you wanted to check, so I put the loop in a function to be called by each iteration of if's you have. Hope it helps.</p>\n\n<pre><code>Sub test()\n\n    Dim ws1 As Worksheet: Set ws1 = Worksheets(\"Tab 1 - Prijslijst\")\n    Dim ws2 As Worksheet: Set ws2 = Worksheets(\"Tab 2 - Nieuwe prijzen\")\n\n    Dim xlcell2 As Range: Set xlcell2 = ws1.Range(\"A1\")\n    Dim xlcell3 As Range: Set xlcell3 = ws2.Range(\"A1\")\n\n    Dim row1 As Long: row1 = xlcell3.Row\n    Dim row2 As Long: row2 = xlcell2.Row\n\n    'each range you want to check\n    Dim range1a As Range: Set range1a = ws1.Range(\"DK\" &amp; row1 &amp; \":\" &amp; \"DQ\" &amp; row1)\n    Dim range1b As Range: Set range1b = ws2.Range(\"W\" &amp; row2 &amp; \":\" &amp; \"AC\" &amp; row2)\n\n    Dim range2a As Range: Set range2a = ws1.Range(\"DR\" &amp; row1 &amp; \":\" &amp; \"DT\" &amp; row1)\n    Dim range2b As Range: Set range2b = ws2.Range(\"AD\" &amp; row2 &amp; \":\" &amp; \"AF\" &amp; row2)\n\n    '...and so on\n\n\n    Dim innerMostCodeExecuted As Boolean\n\n    If CheckRangeEqual(range1a, range1b, row1, row2) = True Then\n        If CheckRangeEqual(range2a, range2b, row1, row2) = True Then\n            '...and so on\n\n            innerMostCodeExecuted = True\n        End If\n    End If\n\n    If innerMostCodeExecuted = False Then ntofourty xlcell3, xlcell2\n\nEnd Sub\n\n\nFunction CheckRangeEqual(range1 As Range, range2 As Range, row1 As Long, row2 As Long) As Boolean\n\n    Dim areEqual As Boolean: areEqual = True\n\n    Dim currentCol As Long\n\n    For currentCol = 1 To range1.Columns.count - 1\n        If range1.Cells(row1, currentCol).Value &lt;&gt; range2.Cells(row2, currentCol).Value Then\n            areEqual = False\n            Exit For\n        End If\n    Next\n\n    CheckRangeEqual = areEqual\n\nEnd Function\n</code></pre>\n\n<p>Since I had to make some mock data for testing, I gave xlcell2 and xlcell3 a value here, but to adapt this to yours all you'd have to do is include the other ranges and nest them in the ifs. Since there's no discernible pattern (that I can see) between what's being checked it still has to be put in manually.</p>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1513791148, "last_edit_date": 1513791148, "creation_date": 1513790697, "answer_id": 47911372, "question_id": 47904202, "link": "https://stackoverflow.com/questions/47904202/vba-excessive-use-of-if-statements/47911372#47911372", "title": "VBA - Excessive use of IF statements", "body": "<p>You could push each row to a separate function and check the values there.<br>\nThis code will check the values in the range <code>'Tab 1 - Prijslijst'!CQ2:ED2</code> against the values in <code>'Tab 2 - Nieuwe prijzen'!D9:AQ17</code>.  </p>\n\n<p>If any of the cells in the row are different then it will put <em>Colour Cell.</em> in the immediate window, otherwise it will put <em>Call function.</em></p>\n\n<pre><code>Public Sub Test()\n\n    Dim lRow As Long\n    Dim lTarget As Long\n    Dim x As Long\n\n    Dim rSource As Range\n    Dim rTarget As Range\n\n    lTarget = 9 'First row that data appears on in \"Tab 2 - Nieuwe prijzen\"\n    x = 0 'Used in loop to move down rows in \"Tab 2 - Nieuwe prijzen\"\n\n    'lRow is the row number on \"Tab 1 - Prijslijst\"\n    For lRow = 2 To 10\n\n        'Set the ranges for the specific row.\n        Set rSource = ThisWorkbook.Worksheets(\"Tab 1 - Prijslijst\").Range(\"CQ\" &amp; lRow &amp; \":ED\" &amp; lRow)\n        Set rTarget = ThisWorkbook.Worksheets(\"Tab 2 - Nieuwe prijzen\").Range(\"D\" &amp; lTarget + x &amp; \":AQ\" &amp; lTarget + x)\n\n        'Check the cell values in the row and flow code accordingly.\n        If CellValuesAreTheDifferent(rSource, rTarget) Then\n            Debug.Print \"Colour Cell.\"\n        Else\n            Debug.Print \"Call function.\"\n        End If\n\n        x = x + 1\n\n    Next lRow\n\nEnd Sub\n\nPublic Function CellValuesAreTheDifferent(rSource As Range, rTarget As Range) As Boolean\n\n    Dim y As Long\n\n    'Check each cell value in the passed range.\n    For y = 1 To rSource.Cells.Count\n        'If the cell values are different then set to TRUE and exit the function.\n        If rSource.Cells(y) &lt;&gt; rTarget.Cells(y) Then\n            CellValuesAreTheDifferent = True\n            Exit For\n        End If\n    Next y\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "is_accepted": false, "score": 0, "last_activity_date": 1513802448, "creation_date": 1513802448, "answer_id": 47914061, "question_id": 47904202, "link": "https://stackoverflow.com/questions/47904202/vba-excessive-use-of-if-statements/47914061#47914061", "title": "VBA - Excessive use of IF statements", "body": "<p>I like to put the checks in a separate function. Say something like this:</p>\n\n<pre><code>Public Function MatchColumns(ByRef tab1_cols() As Variant, ByRef tab2_cols() As Variant, ByVal row_3 As Long, row_2 As Long) As Boolean\n    Dim tab1 As Worksheet, tab2 As Worksheet\n    Set tab1 = Sheets(\"Tab 1 - Prijslijst\")\n    Set tab2 = Sheets(\"Tab 2 - Nieuwe prijzen\")\n\n    Dim n As Long, i As Long\n    ' Count elements in array\n    n = UBound(tab1_cols) - LBound(tab1_cols) + 1   \n    For i = 1 To n\n        If tab1.Range(tab1_cols(i - 1) &amp; \":\" &amp; tab1_cols(i - 1)).Cells(row_3, 1).Value &lt;&gt; tab2.Range(tab2_cols(i - 1) &amp; \":\" &amp; tab2_cols(i - 1)).Cells(row_2, 1).Value Then\n            MatchColumns = False\n        End If\n    Next i\n    MatchColumns = True\nEnd Function\n</code></pre>\n\n<p>Then your calling code becomes almost trivial</p>\n\n<pre><code>Dim tab1_cols() As Variant, tab2_cols() As Variant\ntab1_cols = Array(\"DK\", \"DL\", \"DM\", \"DN\", \"DO\", \"DP\", \"DQ\", ...)\ntab2_cols = Array(\"W\", \"X\", \"Y\", \"Z\", \"AA\", \"AB\", \"AC\", ...)\n\nIf MatchColumns(tab1_cols, tab2_cols, xlCell3.Row, xlCell2.Row) Then\n    '----------\n    ' Code that is irrelevant to the question\n    '----------\nElse\n    Call ntofourty(xlCell3, xlCell2)\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 8806711, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cUmNq.png?s=128&g=1", "display_name": "Maurice van Dorst", "link": "https://stackoverflow.com/users/8806711/maurice-van-dorst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 7, "score": 0, "last_activity_date": 1513802448, "creation_date": 1513766628, "question_id": 47904202, "link": "https://stackoverflow.com/questions/47904202/vba-excessive-use-of-if-statements", "title": "VBA - Excessive use of IF statements", "body": "<p><strong>Please keep in mind that I am a starting VBA developer.</strong></p>\n\n<p>I've got a big pile of IF statements and I'm 100% sure that this can and must be shorter, but I do not have the knowledge of how to do so.</p>\n\n<p>If you do answer my question, could you explain the answer with it aswell?</p>\n\n<p>Here's my code:</p>\n\n<pre><code>If Sheets(\"Tab 1 - Prijslijst\").Range(\"DK\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"W\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DL\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"X\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DM\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"Y\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DN\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"Z\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DO\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AA\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DP\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AB\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DQ\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AC\" &amp; xlCell2.Row).Value Then\n    If Sheets(\"Tab 1 - Prijslijst\").Range(\"DR\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AD\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DS\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AE\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DT\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AF\" &amp; xlCell2.Row).Value Then\n        If Sheets(\"Tab 1 - Prijslijst\").Range(\"DU\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AG\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DV\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AH\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DW\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AI\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DX\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AJ\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DY\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AK\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DZ\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AL\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"EA\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AM\" &amp; xlCell2.Row).Value Then\n            If Sheets(\"Tab 1 - Prijslijst\").Range(\"EB\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AN\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"EC\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AO\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"ED\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"AP\" &amp; xlCell2.Row).Value Then\n                If Sheets(\"Tab 1 - Prijslijst\").Range(\"CQ\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"C\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"CR\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"D\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"CS\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"E\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"CT\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"F\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"CU\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"G\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"CV\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"H\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"CW\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"I\" &amp; xlCell2.Row).Value Then\n                    If Sheets(\"Tab 1 - Prijslijst\").Range(\"CX\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"J\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"CY\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"K\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"CZ\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"L\" &amp; xlCell2.Row).Value Then\n                        If Sheets(\"Tab 1 - Prijslijst\").Range(\"DA\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"M\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DB\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"N\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DC\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"O\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DD\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"P\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DE\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"Q\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DF\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"R\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DG\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"S\" &amp; xlCell2.Row).Value Then\n                            If Sheets(\"Tab 1 - Prijslijst\").Range(\"DH\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"T\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DI\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"U\" &amp; xlCell2.Row).Value And Sheets(\"Tab 1 - Prijslijst\").Range(\"DJ\" &amp; xlCell3.Row).Value = Sheets(\"Tab 2 - Nieuwe prijzen\").Range(\"V\" &amp; xlCell2.Row).Value Then\n\n                            '----------\n                            ' Code that is irrelevant to the question\n                            '----------\n\n                            Else\n                                Call ntofourty(xlCell3, xlCell2)\n                            End If\n                        Else\n                            Call ntofourty(xlCell3, xlCell2)\n                        End If\n                    Else\n                        Call ntofourty(xlCell3, xlCell2)\n                    End If\n                Else\n                    Call ntofourty(xlCell3, xlCell2)\n                End If\n            Else\n                Call ntofourty(xlCell3, xlCell2)\n            End If\n        Else\n            Call ntofourty(xlCell3, xlCell2)\n        End If\n    Else\n        Call ntofourty(xlCell3, xlCell2)\n    End If\nElse\n    Call ntofourty(xlCell3, xlCell2)\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel", "colors", "shape"], "answers": [{"comments": [{"owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "edited": false, "score": 0, "creation_date": 1513768880, "post_id": 47904326, "comment_id": 82776340, "body": "ah, this works perfectly except for something that I failed to mention. the cells in the table are colored according to conditional formatting. Is there any way to transfer the formatting color (given that it doesn&#39;t technically count as a cell color?)  (upvoted for the massive help ty)"}, {"owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "edited": false, "score": 1, "creation_date": 1513769053, "post_id": 47904326, "comment_id": 82776450, "body": "ah i found the solution . to use colorcell.DISPLAYFORMAT.interior.color.  Thank you so much for your help sir!"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "edited": false, "score": 0, "creation_date": 1513769234, "post_id": 47904326, "comment_id": 82776565, "body": "@IIJHFII You&#39;re welcome! Glad you tweaked it correctly."}, {"owner": {"reputation": 179, "user_id": 2304169, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/smjz4.jpg?s=128&g=1", "display_name": "Atilla", "link": "https://stackoverflow.com/users/2304169/atilla"}, "edited": false, "score": 1, "creation_date": 1532938044, "post_id": 47904326, "comment_id": 90144306, "body": "This was really helpful. Thank you both ."}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 5, "last_activity_date": 1513767533, "last_edit_date": 1513767533, "creation_date": 1513767003, "answer_id": 47904326, "question_id": 47904106, "link": "https://stackoverflow.com/questions/47904106/match-shape-colour-to-cell-color-vba/47904326#47904326", "title": "Match shape colour to cell color - vba", "body": "<p>To change the color of a shape, you need to change the Fill.ForeColor property. Also you  cannot use Vlookup as it will return you the cell value not the cell color.</p>\n\n<p>Please try it like this...</p>\n\n<pre><code>Dim countryShape As Shape\nDim ColorCell As Range\nFor Each countryShape In ActiveSheet.Shapes\n    Set ColorCell = Range(\"D3:D19\").Find(what:=countryShape.Name, lookat:=xlWhole)\n    If Not ColorCell Is Nothing Then\n        'get the shape color from corresponding cell in column E\n        countryShape.Fill.ForeColor.RGB = ColorCell.Offset(0, 1).Interior.Color \n    End If\nNext countryShape\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1513767372, "last_edit_date": 1513767372, "creation_date": 1513767024, "answer_id": 47904334, "question_id": 47904106, "link": "https://stackoverflow.com/questions/47904106/match-shape-colour-to-cell-color-vba/47904334#47904334", "title": "Match shape colour to cell color - vba", "body": "<p>Here you go:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim shp         As Shape\n    Dim fancyCell   As Range\n\n    Dim colorR      As Long\n    Dim colorG      As Long\n    Dim colorB      As Long\n    Dim colorFancy  As Long\n\n    Set fancyCell = Range(\"A1\")\n    colorFancy = fancyCell.Interior.Color\n\n    colorR = colorFancy And 255\n    colorG = colorFancy \\ 256 And 255\n    colorB = colorFancy \\ 256 ^ 2 And 255\n\n    For Each shp In ActiveSheet.Shapes\n        shp.Fill.ForeColor.RGB = RGB(colorR, colorG, colorB)\n    Next shp\n\nEnd Sub\n</code></pre>\n\n<p>The shape expects RGB color, thus you may give it, taking the color from the cell. The <code>RGB()</code> returns the same <code>Long</code>, which is used in the <code>Range.Interior.Color</code>, thus you may also simply use:\n      <code>shp.Fill.ForeColor.RGB = colorFancy.Interior.Color</code></p>\n\n<p>As proposed by the answer from @sktneer.</p>\n"}], "owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2632, "favorite_count": 0, "accepted_answer_id": 47904326, "answer_count": 2, "score": 2, "last_activity_date": 1513773624, "creation_date": 1513766360, "last_edit_date": 1513773624, "question_id": 47904106, "link": "https://stackoverflow.com/questions/47904106/match-shape-colour-to-cell-color-vba", "title": "Match shape colour to cell color - vba", "body": "<p>I am looking to set up a basic loop to set the color of each shape in the worksheet to match a corresponding cell in a table (conditional formatted).</p>\n\n<p>I have the following</p>\n\n<pre><code>dim countryShape as shape\n\nFor Each countryShape In ActiveSheet.Shapes\n\ncountryShape.Range.Interior.Color = Application.VLookup(countryShape.Name, ActiveSheet.Range(\"D3:H19\"), 2, 0).Interior.Color\n\nNext countryShape\n</code></pre>\n\n<p>However, I get a </p>\n\n<blockquote>\n  <p>run time error 424, 'Object required'</p>\n</blockquote>\n\n<p>I am guessing it is to do with the format of color application (i.e .interior.color for cells and .fill.forecolor for shape) however any combination I have tried so far is yet to work. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1513767634, "post_id": 47903935, "comment_id": 82775626, "body": "You have a union of ranges, whereas Address is a property of a range which is a string so just drop it."}, {"owner": {"reputation": 341, "user_id": 8183516, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c68736dde5eadf868d276a2b1b65b76a?s=128&d=identicon&r=PG&f=1", "display_name": "budekatude", "link": "https://stackoverflow.com/users/8183516/budekatude"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1513768416, "post_id": 47903935, "comment_id": 82776088, "body": "You mean just leave out the .Address ?  That&#39;s what I&#39;ve been trying in the first code snippet, but it doesn&#39;t yield the expected result!"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1513769137, "post_id": 47903935, "comment_id": 82776497, "body": "Yes. In what way is it unexpected? Your function returns a range so you can then access its address property. You could make your function return a string of addresses instead."}, {"owner": {"reputation": 341, "user_id": 8183516, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c68736dde5eadf868d276a2b1b65b76a?s=128&d=identicon&r=PG&f=1", "display_name": "budekatude", "link": "https://stackoverflow.com/users/8183516/budekatude"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1513770044, "post_id": 47903935, "comment_id": 82777072, "body": "I&#39;ve tried checking the contents of the range object by outputting it through a msgbox, but it only displays the value of the first element of the object... So maybe this is where I wrongly assumed it wasn&#39;t working properly!"}, {"owner": {"reputation": 341, "user_id": 8183516, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c68736dde5eadf868d276a2b1b65b76a?s=128&d=identicon&r=PG&f=1", "display_name": "budekatude", "link": "https://stackoverflow.com/users/8183516/budekatude"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1513770089, "post_id": 47903935, "comment_id": 82777104, "body": "However, I&#39;m still not able to assign the range to the dropdown (see edit of the initial post)..."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1513771266, "post_id": 47903935, "comment_id": 82777825, "body": "What is the name of &quot;Worksheets(3)&quot;? You might need <code>&quot;&#39;&quot; &amp; Worksheets(3).Name &amp; &quot;&#39;!&quot; &amp; NameRng.Address</code>. Have you checked that the function is returning a range which is not nothing?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1513771559, "post_id": 47903935, "comment_id": 82778023, "body": "Btw would be easier if you used the Find method as you are replicating an existing function."}, {"owner": {"reputation": 341, "user_id": 8183516, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c68736dde5eadf868d276a2b1b65b76a?s=128&d=identicon&r=PG&f=1", "display_name": "budekatude", "link": "https://stackoverflow.com/users/8183516/budekatude"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1513772125, "post_id": 47903935, "comment_id": 82778393, "body": "Thanks for all your Input @SJR. Looks like the function is actually working now. I&#39;ll start a new question concerning the assignment of the found range to the combobox RowSource which seems to be the culprit! If you want to post the suggestion of the preexisting  Find method as an answer I&#39;ll accept it as the best answer! Thanks again for all your input!"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1513772775, "post_id": 47903935, "comment_id": 82778796, "body": "Thanks for the offer, but on reflection I&#39;m not sure Find would be much better as you are comparing adjacent cells and would still need to loop through each row. Find is usually advantageous because you can avoid a loop."}], "answers": [{"tags": [], "owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "is_accepted": false, "score": 0, "last_activity_date": 1513770255, "creation_date": 1513770255, "answer_id": 47905300, "question_id": 47903935, "link": "https://stackoverflow.com/questions/47903935/how-to-append-address-of-current-cell-to-range-object/47905300#47905300", "title": "How to append address of current cell to range object", "body": "<p>One method is to capture the cell addresses.  Concatenate these and use the final value to build a new range.</p>\n\n<p>Example:</p>\n\n<pre><code>Public Function DetermineRange(WorksheetName As String, Column1 As Integer, Column2 As Integer) As Range\n    Dim rng As Range\n    Dim currRow As Integer\n    Dim targetSheet As workSheet    ' Shortcut to requested sheet.\n    Dim matchesFound As String      ' Address of matching cells.\n\n    ' This line will raise an error if the name is not valid.\n    Set targetSheet = ThisWorkbook.Sheets(WorksheetName)\n\n    'Go through rows of specified worksheet\n    For currRow = 1 To targetSheet.UsedRange.Rows(targetSheet.UsedRange.Rows.Count).Row\n\n        'Compare cells in specified columns of current row\n        If targetSheet.Cells(currRow, Column1).Value &lt;&gt; \"\" Then\n            If targetSheet.Cells(currRow, Column1).Value = targetSheet.Cells(currRow, Column2).Value Then\n\n                ' Capture address of matching cells.\n                If Len(matchesFound) &gt; 0 Then\n\n                    matchesFound = matchesFound &amp; \",\" &amp; targetSheet.Cells(currRow, Column1).Address\n                Else\n\n                    matchesFound = targetSheet.Cells(currRow, Column1).Address\n                End If\n            End If\n        End If\n    Next currRow\n\n    ' DEBUG: Throw error message if no matches found.\n    If Len(matchesFound) = 0 Then\n\n        Err.Raise vbObjectError + 101, \"DetermineRange\", \"No matching cells found.\"\n    End If\n\n    ' Return range.\n    Set DetermineRange = targetSheet.Range(matchesFound)\nEnd Function\n</code></pre>\n\n<p>The code is a little rough and ready.  I can't help but feel there are few too many lines.  But the basic approach works.</p>\n"}], "owner": {"reputation": 341, "user_id": 8183516, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c68736dde5eadf868d276a2b1b65b76a?s=128&d=identicon&r=PG&f=1", "display_name": "budekatude", "link": "https://stackoverflow.com/users/8183516/budekatude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513773696, "creation_date": 1513765883, "last_edit_date": 1513773696, "question_id": 47903935, "link": "https://stackoverflow.com/questions/47903935/how-to-append-address-of-current-cell-to-range-object", "title": "How to append address of current cell to range object", "body": "<p>I've been trying to write a function that goes through an Excel worksheet to find a range of cells fulfilling a certain condition (two cells in the same row that have to be equal).</p>\n\n<p>I've written the following code that goes through the Worksheet row by row and checks if the condition is fulfilled. \nIf a cell is found for which the condition is true I would like the address of the cell to be added to a range. \nThe output of the function should finally be this range which is subsequently used to populate a dropdown menu in a dialog with the entries fulfilling the condition.</p>\n\n<pre><code>Private Function DetermineRange(WorksheetName As String, Column1 As Integer, Column2 As Integer) As Range\n\n    Dim rng As Range\n\n    'Go through rows of specified worksheet\n    For currRow = 1 To Worksheets(WorksheetName).Cells(Rows.Count, 3).End(xlUp).Row\n\n        'Compare cells in specified columns of current row\n        If Worksheets(WorksheetName).Cells(currRow, Column1).Value = Worksheets(WorksheetName).Cells(currRow, Column2).Value _\n          And Not (Worksheets(WorksheetName).Cells(currRow, Column1).Value = \"\") Then\n\n            'If cells are equal, but not empty, append current adress of current cell to range\n            If Not rng Is Nothing Then\n                Set rng = Union(rng, Worksheets(WorksheetName).Cells(currRow, 2))\n            Else\n                Set rng = Worksheets(WorksheetName).Cells(currRow, 2)\n            End If\n        End If\n\n    Next currRow\n\n    If Not rng Is Nothing Then\n        'return found Range\n        Set DetermineRange = rng\n        MsgBox (\"Range is: \" &amp; rng)\n    Else\n        'DEBUG: Throw error message if rng is empty,\n        MsgBox (\"DEBUG DetermineRange Function:\" &amp; vbCrLf &amp; _\n        \"Error! No corresponding Cells found in Sheet\" &amp; WorksheetName)\n    End If\n\nEnd Function\n</code></pre>\n\n<p>Cycling through the rows works fine, however I don't seem to be able to add the addresses for the cells after the condition is checked to the range object. \nI have also tried the following, which results in a</p>\n\n<blockquote>\n  <p>Runtime error 424: Object required</p>\n</blockquote>\n\n<pre><code>'If cells are equal, but not empty, append current address of current cell to range\n If Not rng Is Nothing Then\n       Set rng = Union(rng, Worksheets(WorksheetName).Cells(currRow, 2).Address)\n Else\n       Set rng = Worksheets(WorksheetName).Cells(currRow, 2).Address\n End If\n</code></pre>\n\n<p>I've been looking around, but can't seem to find much information on how to add cells to range objects however...\nMaybe one of you could help! Any kind of pointer in the right direction is highly appreciated!</p>\n\n<p>Thanks in advance for any kind of help!</p>\n\n<p><strong>Edit:</strong> \nI am calling the function like this:</p>\n\n<pre><code>Set NameRng = DetermineRange(\"Features\", ProjectColumn, TCGroupColumn)\ncb_FcnName.RowSource = Worksheets(3).Name &amp; \"!\" &amp; NameRng.Address\n</code></pre>\n\n<p>But I get the following error: </p>\n\n<blockquote>\n  <p>Runtime Error 380: Not able to set property RowSource</p>\n</blockquote>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 1, "user_id": 9115168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f60d924e6badc0fc051c5c046306106?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick ", "link": "https://stackoverflow.com/users/9115168/patrick"}, "edited": false, "score": 0, "creation_date": 1513766814, "post_id": 47903590, "comment_id": 82775050, "body": "Dim nums As Boolean, For Each myRow In Range(&quot;A1:P200&quot;), nums=True. For Each myCell In myRow, If Isnumeric=False, Set nums=False. If nums=False, Rows.EntireRow.Delete.  Is my attempt so far, it doesn&#39;t like the if statements. Also I need to keep rows with a numeric cell and many blank cells, will this not delete any rows with some blank cells? (sorry about formatting)"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1513765467, "creation_date": 1513765467, "answer_id": 47903790, "question_id": 47903590, "link": "https://stackoverflow.com/questions/47903590/delete-row-if-no-cells-in-the-entire-row-are-numeric/47903790#47903790", "title": "Delete row if no cells in the entire row are numeric", "body": "<p>Here is how to start:</p>\n\n<ul>\n<li>declare a boolean value</li>\n<li>make a for each loop like this:</li>\n</ul>\n\n<hr>\n\n<pre><code>For each myRow in Range(\"A1:Z100\").Rows\n</code></pre>\n\n<hr>\n\n<ul>\n<li>set the boolean value to <code>True</code></li>\n<li>make a new loop like this:</li>\n</ul>\n\n<hr>\n\n<pre><code>For each myCell in myRow\n</code></pre>\n\n<hr>\n\n<ul>\n<li>check each cell whether it is <code>Numeric</code>. If it is not, set the boolean value to <code>False</code>.</li>\n<li>at the end of the inner loop delete the row if the boolean value is <code>True</code>.</li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 9115168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f60d924e6badc0fc051c5c046306106?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick ", "link": "https://stackoverflow.com/users/9115168/patrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513773867, "creation_date": 1513764904, "last_edit_date": 1513773867, "question_id": 47903590, "link": "https://stackoverflow.com/questions/47903590/delete-row-if-no-cells-in-the-entire-row-are-numeric", "title": "Delete row if no cells in the entire row are numeric", "body": "<p>I'm looking for a way to delete a row if it contains only text/blank cells.\nI have a worksheet with product codes (alphanumeric), descriptions (text), and quantities (numeric) in various columns (not consistent between sheets). I'm trying to find a way to delete rows with no product quantities as they don't need to be entered into the system. I'm not really sure how to approach the problem, I'm still pretty new to vba</p>\n\n<pre><code>Dim nums As Boolean\n  For Each myRow In Range(\"A1:P200\")\n    nums = True\n    For Each myCell In myRow\n      If IsNumeric = False Then\n        Set nums = False\n        If nums = False Then\n          Rows.EntireRow.Delete\n</code></pre>\n\n<p>Is my attempt so far, it doesn't like the if statements. Also I need to keep rows with a numeric cell and many blank cells, will this not delete any rows with some blank cells?</p>\n"}, {"tags": ["vba", "excel", "ex"], "answers": [{"comments": [{"owner": {"reputation": 239, "user_id": 8150532, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/89dec06313f6bbc60ebe2f35b6fd0608?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/8150532/tim"}, "edited": false, "score": 0, "creation_date": 1513775195, "post_id": 47904578, "comment_id": 82780423, "body": "Oh thank you good eye that should be the same number..! I will test your solution, thank you!"}, {"owner": {"reputation": 239, "user_id": 8150532, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/89dec06313f6bbc60ebe2f35b6fd0608?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/8150532/tim"}, "edited": false, "score": 0, "creation_date": 1513777345, "post_id": 47904578, "comment_id": 82781844, "body": "@Xiabier Thank you very much that was very easy and is working perfectly!"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 0, "last_activity_date": 1513767874, "creation_date": 1513767874, "answer_id": 47904578, "question_id": 47903539, "link": "https://stackoverflow.com/questions/47903539/i-am-looking-for-a-way-to-shorten-this-code-by-consolidating-each-case-is-inst/47904578#47904578", "title": "I am looking for a way to shorten this code by consolidating each &quot;Case is&quot; instant into one getting the case name from a variable", "body": "<p>I've noticed that the number of rows that in Recommendations that you set Hidden to false has changed for the first Case is 1:224 and the second is 1:263, but if this supposed to be the same then something like the following would do, simply replace your whole Select Case with the following:</p>\n\n<pre><code>Worksheets(\"Recommendations\").Rows(\"1:224\").Hidden = False\n    For ZeileUntersucht = 20 To 515\n        If Worksheets(NatCoList).Cells(ZeileUntersucht, 238).Value = \"yes\" Then\n            Worksheets(\"Recommendations\").Cells(ZeileEintragen, 3) = Worksheets(NatCoList).Cells(ZeileUntersucht, 1)\n            ZeileEintragen = ZeileEintragen + 1\n        End If\n    Next ZeileUntersucht\n</code></pre>\n"}], "owner": {"reputation": 239, "user_id": 8150532, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/89dec06313f6bbc60ebe2f35b6fd0608?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/8150532/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 47904578, "answer_count": 1, "score": 0, "last_activity_date": 1513767874, "creation_date": 1513764718, "last_edit_date": 1531164843, "question_id": 47903539, "link": "https://stackoverflow.com/questions/47903539/i-am-looking-for-a-way-to-shorten-this-code-by-consolidating-each-case-is-inst", "title": "I am looking for a way to shorten this code by consolidating each &quot;Case is&quot; instant into one getting the case name from a variable", "body": "<p>The purpose of the macro is to choose the correct data depending on the selected case in a dropdown menue on my \"Recommendation\" sheet.</p>\n\n<p>This is my code:</p>\n\n<pre><code>Private Sub cmbNatCoList_Change()\n\n'Define selected NatCo and variables for loop\nDim NatCoList As String\nDim ZeileUntersucht As Integer\nDim ZeileEintragen As Integer\n\n'Line which is looked at in NatCo sheet\nZeileUntersucht = 17\n'Line which is written in in Recommendation Sheet\nZeileEintragen = 15\n\n'Selected NatCo\nNatCoList = cmbNatCoList.Value\n\n'Set selected NatCo on NatCoRecommendations sheet\n'ThisWorkbook.Sheets(\"NatCoRecommendations\").cmbNatCoList.Value = NatCoList\n\n'Set position and size of combobox\ncmbNatCoList.Top = 85\ncmbNatCoList.Left = 1120\ncmbNatCoList.Width = 100\ncmbNatCoList.Height = 40\n\n'Write selected NatCo on charts\nRange(\"z1\") = NatCoList\nWorksheets(\"Stock Control Chart\").Range(\"C61\") = NatCoList\nWorksheets(\"Price Chart\").Range(\"D44\") = NatCoList\n\n'Search for recommendations for selected NatCo\n Select Case NatCoList\n\n'========================================\nCase Is = \"TDG\"\nWorksheets(\"Recommendations\").Rows(\"1:224\").Hidden = False\n    'Loop looking for recommendations in each line, writes BNCode in list if yes \nand continues with next line, if not just continues\nFor ZeileUntersucht = 20 To 515\n    If Worksheets(\"TDG\").Cells(ZeileUntersucht, 238).Value = \"yes\" Then\n        Worksheets(\"Recommendations\").Cells(ZeileEintragen, 3) = Worksheets(\"TDG\").Cells(ZeileUntersucht, 1)\n        ZeileEintragen = ZeileEintragen + 1\n\n    End If\nNext ZeileUntersucht\n\n\n\n\n'===========================================\nCase Is = \"TMNL\"\nWorksheets(\"Recommendations\").Rows(\"1:263\").Hidden = False\n    For ZeileUntersucht = 20 To 515\n        If Worksheets(\"TMNL\").Cells(ZeileUntersucht, 238).Value = \"yes\" Then\n            Worksheets(\"Recommendations\").Cells(ZeileEintragen, 3) = \nWorksheets(\"TMNL\").Cells(ZeileUntersucht, 1)\n            ZeileEintragen = ZeileEintragen + 1\n\n    End If\nNext ZeileUntersucht\n</code></pre>\n\n<p>This is parts of the code I am trying to improve. </p>\n\n<p>Those Case Is cases are about 20 in total I am just showing you two here. The code inside is exactly the same, the only thing that changes with a selected case is the worksheet it is looking at.</p>\n\n<p>Important to note: It is always only one case selected (used) for the macro.</p>\n\n<p>If you need any more information, please ask.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 1, "last_activity_date": 1513778183, "last_edit_date": 1513778183, "creation_date": 1513765153, "answer_id": 47903681, "question_id": 47902963, "link": "https://stackoverflow.com/questions/47902963/excel-macro-to-copy-content-of-multiple-xml-files-and-paste-in-excel-rows/47903681#47903681", "title": "Excel macro to copy content of multiple xml files and paste in excel rows", "body": "<p>This will look at all xml files in a given folder and then copy the contents to your column A on Sheet1:</p>\n\n<pre><code>Sub LoopThroughFiles()\nDim MyData As String\nDim LastRow As Long\nx = 1\nLastRow = Sheet1.Cells(Sheet1.Rows.Count, \"A\").End(xlUp).Row\n    Dim StrFile As String\n    StrFile = Dir(\"C:\\Users\\User3282573\\*.xml\") 'change this path to your folder path\n    Do While Len(StrFile) &gt; 0\n        Open \"C:\\Users\\User3282573\\\" &amp; StrFile For Binary As #1 'also change this path\n        MyData = Space$(LOF(1))\n        Get #1, , MyData\n        Sheet1.Cells(x, 1).Value = MyData\n        x = x + 1\n        Close #1\n        StrFile = Dir\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 557, "user_id": 3282573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdc82dd1d2e73f614ee5cfafd5fc7dc4?s=128&d=identicon&r=PG&f=1", "display_name": "user3282573", "link": "https://stackoverflow.com/users/3282573/user3282573"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 700, "favorite_count": 0, "accepted_answer_id": 47903681, "answer_count": 1, "score": 0, "last_activity_date": 1513796976, "creation_date": 1513762886, "last_edit_date": 1531164843, "question_id": 47902963, "link": "https://stackoverflow.com/questions/47902963/excel-macro-to-copy-content-of-multiple-xml-files-and-paste-in-excel-rows", "title": "Excel macro to copy content of multiple xml files and paste in excel rows", "body": "<p>I have a multiple xml files(eg 100 xml files) in a folder, my requirement is to create a macro to copy the content of the xml files and paste it in excel sheet.</p>\n\n<p>For example: 1st xml file content -> Excel cell A1\n             2nd xml file content -> Excel cell A2 and so on..</p>\n"}, {"tags": ["excel", "vba", "random"], "comments": [{"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1513764518, "post_id": 47902690, "comment_id": 82773559, "body": "Why not use conditional formatting?"}], "answers": [{"tags": [], "owner": {"reputation": 824, "user_id": 6722034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70472b94b95a084f55551520030f88fb?s=128&d=identicon&r=PG&f=1", "display_name": "Arul", "link": "https://stackoverflow.com/users/6722034/arul"}, "is_accepted": true, "score": 1, "last_activity_date": 1513764093, "creation_date": 1513764093, "answer_id": 47903342, "question_id": 47902690, "link": "https://stackoverflow.com/questions/47902690/highlight-a-random-row-in-a-range/47903342#47903342", "title": "Highlight a random row in a range", "body": "<p>Please give the below code a try. </p>\n\n<pre><code>Sub SelectRandom()\n    Dim mrg As Worksheet\n    Dim Rand As Long\n    Dim PopulationSelect As Range\n\n    Set mrg = ActiveWorkbook.Sheets(\"Merged\")\n\n    'Define your start row below (instead of 6)\n    Rand = Application.WorksheetFunction.RandBetween(6, mrg.Range(\"A\" &amp; Rows.Count).End(xlUp).Row)\n    mrg.Rows(Rand).EntireRow.Interior.Color = RGB(255, 255, 153)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 47903342, "answer_count": 1, "score": 0, "last_activity_date": 1513764093, "creation_date": 1513762160, "question_id": 47902690, "link": "https://stackoverflow.com/questions/47902690/highlight-a-random-row-in-a-range", "title": "Highlight a random row in a range", "body": "<p>I am trying to make a macro that on the press of a button highlights a random row in a selection. I have the following code (which is based on an answer generously provided by @gtwebb to @Kyle Snell): </p>\n\n<pre><code>Sub SelectRandom()\nDim mrg As Worksheet\nSet mrg = ActiveWorkbook.Sheets(\"Merged\")\n\nDim PopulationSelect As Range\nSet PopulationSelect = mrg.Range(\"A\" &amp; Rows.Count).End(xlUp)\n\n\nRandSample = Int(PopulationSelect.Rows.Count * Rnd + 1)\nPopulationSelect.Rows(RandSample).EntireRow.Interior.Color = RGB(255, 255, 153)\n\nEnd Sub\n</code></pre>\n\n<p>Now on the sheet I have a header that takes up Range(\"A1:L5\") so I'd need the code to randomly select and highlight a row from any of the rows below the header that contain data. How would I go about doing it? The code only selects and highlights the last row containing data at the moment. </p>\n"}, {"tags": ["vba", "excel", "date"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 2, "creation_date": 1513762166, "post_id": 47902584, "comment_id": 82772051, "body": "Works fine for me. Have you got any Error handling in your code which may be causing to skip over this? Something like <code>On Error Resume Next</code>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1513762394, "post_id": 47902584, "comment_id": 82772187, "body": "Works for me as well. I get the activesheet name and the time, separated by a slash."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1513762439, "post_id": 47902584, "comment_id": 82772212, "body": "Can you put a MsgBox here <code>MsgBox (Activesheet.name &amp; &quot; - &quot; &amp; Sheets(&quot;instellingen&quot;).Cells(22, 2).Value)</code>?"}, {"owner": {"reputation": 64, "user_id": 8938584, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7313bf13b2bedac07b48736a2859457d?s=128&d=identicon&r=PG&f=1", "display_name": "Tefalpan", "link": "https://stackoverflow.com/users/8938584/tefalpan"}, "edited": false, "score": 0, "creation_date": 1513767338, "post_id": 47902584, "comment_id": 82775423, "body": "the msgbox works, but when plotting it still only returns the date, I&#39;ve put the whole macro in the question above, maybe I&#39;m missing something else?"}, {"owner": {"reputation": 64, "user_id": 8938584, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7313bf13b2bedac07b48736a2859457d?s=128&d=identicon&r=PG&f=1", "display_name": "Tefalpan", "link": "https://stackoverflow.com/users/8938584/tefalpan"}, "edited": false, "score": 0, "creation_date": 1513786313, "post_id": 47902584, "comment_id": 82787883, "body": "if i put an enter in between, it does work <code>ActiveSheet.Name &amp; Chr(10) &amp; Format(Sheets(&quot;instellingen&quot;).Cells(22, 2).Value, &quot;dd-MM-yyyy&quot;)</code> Don&#39;t know what makes the difference though :)"}], "answers": [{"comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 2, "creation_date": 1513762179, "post_id": 47902673, "comment_id": 82772058, "body": "It&#39;s the <code>ActiveSheet.Name</code> that is missing not the Date"}], "tags": [], "owner": {"reputation": 418, "user_id": 5026900, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8LXOaH1OepI/AAAAAAAAAAI/AAAAAAAAKu4/v6UvY3lkaoQ/photo.jpg?sz=128", "display_name": "cbasah", "link": "https://stackoverflow.com/users/5026900/cbasah"}, "is_accepted": false, "score": 0, "last_activity_date": 1513762106, "creation_date": 1513762106, "answer_id": 47902673, "question_id": 47902584, "link": "https://stackoverflow.com/questions/47902584/excel-vba-defined-footer/47902673#47902673", "title": "Excel vba defined footer", "body": "<p>Use the Format() function to format the date in .Cell(22, 2) </p>\n\n<pre><code>.CenterFooter = ActiveSheet.Name &amp; \" - \" &amp; Format(Sheets(\"instellingen\").Cells(22, 2).Value, \"dd-MM-yyyy\")\n</code></pre>\n"}], "owner": {"reputation": 64, "user_id": 8938584, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7313bf13b2bedac07b48736a2859457d?s=128&d=identicon&r=PG&f=1", "display_name": "Tefalpan", "link": "https://stackoverflow.com/users/8938584/tefalpan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 567, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513767420, "creation_date": 1513761807, "last_edit_date": 1513767420, "question_id": 47902584, "link": "https://stackoverflow.com/questions/47902584/excel-vba-defined-footer", "title": "Excel vba defined footer", "body": "<p>The folowing code is used to auto define the header/footer while plotting an excel worksheet to pdf.\nOnly thing that doesn't seem to work is the centerfooter function, it's supposed to give \"<em>active sheet name</em> - <em>defined date in dd-mm-yyyy format (value of cell Sheets(\"instellingen\").Cells(22, 2) )</em>, this results only in returning the date in format \"mm-dd-yyyy\" in the centerfooter, ignoring and not returning the activesheet name part.</p>\n\n<pre><code>With ActiveSheet.PageSetup\n        .LeftHeader = \"\"\n        .CenterHeader = \"Company name\"\n        .RightHeader = \"\"\n        .LeftFooter = Sheets(\"instellingen\").Cells(20, 2).Value\n        .CenterFooter = Activesheet.name &amp; \" - \" &amp; Sheets(\"instellingen\").Cells(22, 2).Value\n        .RightFooter = \"Pagina &amp;P van de &amp;N\"\n</code></pre>\n\n<p>Thanks :)</p>\n\n<p><em>Edit. (full macro)</em></p>\n\n<pre><code>Sub PlotPDF()\n'\n' PlotPDF Macro\n'\n' Sneltoets: Ctrl+Shift+P\n'\n    Application.PrintCommunication = False\n    Application.Dialogs(xlDialogPrinterSetup).Show\n    With ActiveSheet.PageSetup\n        ActiveWindow.View = xlPageBreakPreview\n    ActiveSheet.PageSetup.PrintArea = \"$A:$N\"\n        .PrintTitleRows = \"\"\n        .PrintTitleColumns = \"\"\n    End With\n    Application.PrintCommunication = True\n    ActiveSheet.PageSetup.PrintArea = \"\"\n    Application.PrintCommunication = False\n    With ActiveSheet.PageSetup\n        .LeftHeader = \"\"\n        .CenterHeader = \"Company name\"\n        .RightHeader = \"\"\n        .LeftFooter = Sheets(\"instellingen\").Cells(20, 2).Value\n        .CenterFooter = ActiveSheet.Name &amp; \" - \" &amp; Format(Sheets(\"instellingen\").Cells(22, 2).Value, \"dd-MM-yyyy\")\n        .RightFooter = \"\"\n        .LeftMargin = Application.InchesToPoints(0.7)\n        .RightMargin = Application.InchesToPoints(0.7)\n        .TopMargin = Application.InchesToPoints(0.75)\n        .BottomMargin = Application.InchesToPoints(0.75)\n        .HeaderMargin = Application.InchesToPoints(0.3)\n        .FooterMargin = Application.InchesToPoints(0.3)\n        .PrintHeadings = False\n        .PrintGridlines = False\n        .PrintComments = xlPrintNoComments\n        .PrintQuality = 600\n        .CenterHorizontally = False\n        .CenterVertically = False\n        .Orientation = xlLandscape\n        .Draft = False\n        .PaperSize = xlPaperA4\n        .FirstPageNumber = xlAutomatic\n        .Order = xlDownThenOver\n        .BlackAndWhite = False\n        .Zoom = False\n        .FitToPagesWide = 1\n        .FitToPagesTall = False\n        .PrintErrors = xlPrintErrorsDisplayed\n        .OddAndEvenPagesHeaderFooter = False\n        .DifferentFirstPageHeaderFooter = False\n        .ScaleWithDocHeaderFooter = True\n        .AlignMarginsHeaderFooter = True\n        .EvenPage.LeftHeader.Text = \"\"\n        .EvenPage.CenterHeader.Text = \"\"\n        .EvenPage.RightHeader.Text = \"\"\n        .EvenPage.LeftFooter.Text = \"\"\n        .EvenPage.CenterFooter.Text = \"\"\n        .EvenPage.RightFooter.Text = \"\"\n        .FirstPage.LeftHeader.Text = \"\"\n        .FirstPage.CenterHeader.Text = \"\"\n        .FirstPage.RightHeader.Text = \"\"\n        .FirstPage.LeftFooter.Text = \"\"\n        .FirstPage.CenterFooter.Text = \"\"\n        .FirstPage.RightFooter.Text = \"\"\n    End With\n    Application.PrintCommunication = True\n    ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, _\n        IgnorePrintAreas:=False\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1513761621, "post_id": 47902259, "comment_id": 82771710, "body": "I don&#39;t think <code>Interactive property</code> is one to use here. Check <a href=\"https://msdn.microsoft.com/en-us/VBA/Excel-VBA/articles/application-interactive-property-excel\" rel=\"nofollow noreferrer\">Application.Interactive Property from MSDN</a>."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1513761728, "post_id": 47902259, "comment_id": 82771770, "body": "Can you remove <code>exapp.Interactive = False</code> and try again. The one after the <code>On Error GoTo terminate</code>?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1513762010, "post_id": 47902259, "comment_id": 82771947, "body": "Umm, I don&#39;t get it -- where&#39;s the code (in Word) that&#39;s producing the message <b><i>&quot;You are editing a cell in excel, stop doing that!&quot;</i></b> ...?  That&#39;s obviously not a message built-into Office, so it must be coming from something that you added.  Find that, and then you can <i>easily</i> find <b>how</b> it&#39;s detecting that a cell is being edit.  Locating it could be as easy as going to a module and CTRL+F, choose to search in <b>entire project</b> and search for part of that phrase."}], "answers": [{"tags": [], "owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "is_accepted": false, "score": 1, "last_activity_date": 1513763297, "creation_date": 1513763297, "answer_id": 47903074, "question_id": 47902259, "link": "https://stackoverflow.com/questions/47902259/find-out-if-excel-is-in-edit-mode-from-word-vba/47903074#47903074", "title": "Find out if excel is in edit mode from word-vba", "body": "<p>Here is a working code:</p>\n\n<pre><code>'**********************************************************************\n'********* See if we can open excel, true is Yes we can work with excel\n'**********************************************************************\nPublic Function setExcelObject(ByRef oXLApp As Object) As Boolean\n    On Error Resume Next\n\n    Set oXLApp = GetObject(, \"Excel.Application\")\n    If oXLApp Is Nothing Then\n        Set oXLApp = CreateObject(\"Excel.Application\")\n    End If\n\n    setExcelObject = Not IsInEditMode(oXLApp)\n\n    If setExcelObject = False Then Set oXLApp = Nothing\n\nEnd Function\n\n' *****************************************************************\n' **************** Check if excel is in edit mode ****************\n'*****************************************************************\nPublic Function IsInEditMode(ByRef exapp As Object) As Boolean\n            On Error GoTo terminate\n                exapp.Interactive = False\n                exapp.Interactive = True\n\n                IsInEditMode = False\n\n        Exit Function\nterminate:\n         IsInEditMode = True\n         Exit Function\n\n    End Function\n\n' *************************************************************\n' *************** Check if excel is open, true, means we should not close excel after we are done.....\n'*****************************************************************\nFunction ExcelOpen() As Boolean\n    ExcelOpen = FindWindow(\"XLMAIN\", vbNullString)\nEnd Function\n</code></pre>\n\n<p>The above code I then call from several procedure like this:</p>\n\n<pre><code>' Get excel object\nIf Not FileHandling.setExcelObject(oXLApp) Then\n    failMessage = \"You are editing a cell in excel, stop doing that!\"\n    GoTo terminate\nEnd If\n\n' check if we need to close after\ncloseExcelMy = FileHandling.ExcelOpen\n\n'See if we can open workbook\nIf Not FileHandling.GetWorkbook(wbName, oXLApp, xlApp) Then\n    failMessage = \"Failed to open workbook\"\n    GoTo terminate\nEnd If\n\noXLApp.Visible = True\n</code></pre>\n"}], "owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 834, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1513763297, "creation_date": 1513760694, "question_id": 47902259, "link": "https://stackoverflow.com/questions/47902259/find-out-if-excel-is-in-edit-mode-from-word-vba", "title": "Find out if excel is in edit mode from word-vba", "body": "<p>I am trying to find out from word if excel is in edit mode, I looked at this <a href=\"https://stackoverflow.com/questions/221984/how-to-tell-if-excel-application-is-in-cell-edit-mode\">thread</a> and tried to modify it, but it does not work if you have excel in edit mode, then run it, then exit edit mode rerun it still says it is edit mode:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0WAUK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0WAUK.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>   '*********************************************************\n'********* define if we need to close excel after sub is done\n'***********************************************************\nPublic Function setExcelObject(ByRef oXLApp As Object) As Boolean\n    On Error Resume Next\n\n    Set oXLApp = GetObject(, \"Excel.Application\")\n    If oXLApp Is Nothing Then\n        Set oXLApp = CreateObject(\"Excel.Application\")\n    End If\n\n    setExcelObject = IsInEditMode(oXLApp)\n\nEnd Function\n\n\nPublic Function IsInEditMode(ByRef exapp As Object) As Boolean\n        If exapp.Interactive = False Then\n            IsInEditMode = False\n        Else\n            On Error GoTo terminate\n                exapp.Interactive = False\n                exapp.Interactive = True\n\n                IsInEditMode = False\n\n        End If\n        Exit Function\n\nterminate:\n         IsInEditMode = True\n         Exit Function\n\n    End Function\n</code></pre>\n\n<p>Note: It also takes awful long(15s) to figure out that it is in edit mode...</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 1, "creation_date": 1513763810, "post_id": 47902079, "comment_id": 82773079, "body": "I have not tried so this is a guess.  You are changing the extension from CSV to XLSX.  But a CSV file is not a workbook.  The Windows default is for Excel to open CSV files as though they were workbooks so why not leave the extension alone."}], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1513774137, "post_id": 47906243, "comment_id": 82779686, "body": "From what I can see the only reason to add the library is so that Outlook knows what <code>xlOpenXMLWorkbook</code> means.  If you&#39;d used <code>wb.SaveAs FileName:=Replace(sPathName, &quot;.csv&quot;, &quot;.xlsx&quot;), FileFormat:=51</code> your original code would have worked.  In these cases I usually open the Immediate window in Excel,  type <code>?xlOpenXMLWorkbook</code>  and it returns the number I need to use."}], "tags": [], "owner": {"reputation": 244, "user_id": 8219745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/461a5f5a7698d5fdb33a067c662a5c50?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok", "link": "https://stackoverflow.com/users/8219745/ashok"}, "is_accepted": false, "score": 0, "last_activity_date": 1513773461, "creation_date": 1513773461, "answer_id": 47906243, "question_id": 47902079, "link": "https://stackoverflow.com/questions/47902079/save-as-method-of-workbook-class-failed-outlook-vba/47906243#47906243", "title": "save as method of workbook class failed - Outlook vba", "body": "<p>finally i got the answer : adding <code>microsoft excel library</code> in the tool and defined <code>wb as workbook</code></p>\n"}], "owner": {"reputation": 244, "user_id": 8219745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/461a5f5a7698d5fdb33a067c662a5c50?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok", "link": "https://stackoverflow.com/users/8219745/ashok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1359, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593243456, "creation_date": 1513760064, "last_edit_date": 1593243456, "question_id": 47902079, "link": "https://stackoverflow.com/questions/47902079/save-as-method-of-workbook-class-failed-outlook-vba", "title": "save as method of workbook class failed - Outlook vba", "body": "<p>i am trying to save the outlook mail attachment file (single file) with xlsx file format but below code showing error <code>Save as Mehtode of workbook class failed</code> in the line of <code>wb.saveAs</code>. need someone help.</p>\n\n<pre><code> Public Sub saveAttachtoDisk(itm As Outlook.MailItem)\n        Dim objAtt As Outlook.Attachment\n        Dim objExcel As Object\n        Dim wb As Object\n        Dim saveFolder As String, dateFormat As String, fName As String\n        saveFolder = \"D:\\Ashok\\Work\\Capital\\Collection\\\"\n\n        For Each objAtt In itm.Attachments\n        sFileName = LCase(objAtt.FileName)\n\n            sPathName = saveFolder &amp; sFileName\n            objAtt.SaveAsFile sPathName\n\n\n    Set objExcel = CreateObject(\"Excel.Application\")\n            Set wb = objExcel.Workbooks.Open(sPathName)\n\n' error on below line\n\n            wb.SaveAs FileName:=Replace(sPathName, \".csv\", \".xlsx\"), FileFormat:=xlOpenXMLWorkbook \n                wb.Close SaveChanges:=True\n\n\n            Kill sPathName\n            objExcel.Quit\n\n    Next\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "find"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4938003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24ab0b480586bcd07837308e1adc9c0b?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis S.", "link": "https://stackoverflow.com/users/4938003/dennis-s"}, "edited": false, "score": 0, "creation_date": 1513762840, "post_id": 47902774, "comment_id": 82772479, "body": "Perfect! Thanks a lot!"}], "tags": [], "owner": {"reputation": 824, "user_id": 6722034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70472b94b95a084f55551520030f88fb?s=128&d=identicon&r=PG&f=1", "display_name": "Arul", "link": "https://stackoverflow.com/users/6722034/arul"}, "is_accepted": true, "score": 0, "last_activity_date": 1513762375, "creation_date": 1513762375, "answer_id": 47902774, "question_id": 47901429, "link": "https://stackoverflow.com/questions/47901429/word-vba-select-in-the-table-from-given-word-to-the-end-of-paragraph-but-not-e/47902774#47902774", "title": "Word VBA - select in the table from given word to the end of paragraph but not entire cell", "body": "<p>You can use <code>MoveRight</code> and calculate the units to move right from <code>Length of the Cell - Your Current Position</code>.</p>\n\n<pre><code>Sub Test()\nDim count As Long\nWith Selection\n        Set obj_Tbl = .Tables(1)\n        .Tables(1).Columns(2).Select\n         For Each obj_Row In obj_Tbl.Rows\n           With obj_Row.Cells(3)\n                If InStr(1, obj_Row.Cells(3), \"Depend\") &gt; 0 Then\n                    obj_Row.Cells(3).Range.Characters(InStr(1, obj_Row.Cells(3), \"Depend\")).Select\n                    count = Len(obj_Row.Cells(3).Range) - InStr(1, obj_Row.Cells(3), \"Depend\")\n                    Selection.MoveRight Unit:=wdCharacter, count:=count - 2, Extend:=wdExtend\n                    Selection.Font.Color = RGB(192, 0, 0)\n                End If\n           End With\n       Next\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4938003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24ab0b480586bcd07837308e1adc9c0b?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis S.", "link": "https://stackoverflow.com/users/4938003/dennis-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 47902774, "answer_count": 1, "score": 0, "last_activity_date": 1513762375, "creation_date": 1513757381, "question_id": 47901429, "link": "https://stackoverflow.com/questions/47901429/word-vba-select-in-the-table-from-given-word-to-the-end-of-paragraph-but-not-e", "title": "Word VBA - select in the table from given word to the end of paragraph but not entire cell", "body": "<p>Trying to select and mark with red the specified text beginning from <em>\"Depend\"</em> to the end of the cell, <strong>but not the entire cell</strong>.\nSample of code:</p>\n\n<pre><code>With Selection\n        Set obj_Tbl = .Tables(1)\n        .Tables(1).Columns(2).Select ' Why so stupid? there is the conditional formatting\n        For Each obj_Row In obj_Tbl.Rows\n           With obj_Row.Cells(3)\n                If InStr(1, obj_Row.Cells(3), \"Depend\") &gt; 0 Then\n                    obj_Row.Cells(3).Range.Characters(InStr(1, obj_Row.Cells(3), \"Depend\")).Select\n                    Selection.EndKey Unit:=wdLine, Extend:=wdExtend\n                    Selection.MoveLeft Unit:=wdCharacter, Count:=1, Extend:=wdExtend\n                    Selection.Font.Color = RGB(192, 0, 0)\n                End If\n           End With\n       Next \nEnd With\n</code></pre>\n\n<p>This works fine when the \"Depend\" is written in one row. But if the text looks like </p>\n\n<pre><code>Depends from Something \nToo Long to Be Shown In One Line\n</code></pre>\n\n<p>I have the trouble with selection which selects only one row.</p>\n\n<pre><code>Selection.EndOf Unit:=wdParagraph 'selects the entire cell\nSelection.EndKey Unit:=wdParagraph 'is not supported\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 2170941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dd68815c69dd2910fc4008770633daf?s=128&d=identicon&r=PG", "display_name": "Beryllium", "link": "https://stackoverflow.com/users/2170941/beryllium"}, "edited": false, "score": 0, "creation_date": 1518444368, "post_id": 47905550, "comment_id": 84496520, "body": "Sorry for the late reply! But yeah this worked also.  I just did it a bit differntly :D"}], "tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": false, "score": 2, "last_activity_date": 1513771063, "creation_date": 1513771063, "answer_id": 47905550, "question_id": 47901332, "link": "https://stackoverflow.com/questions/47901332/save-word-file-in-multiple-locations-at-once/47905550#47905550", "title": "Save Word file in multiple locations at once", "body": "<p>well, I would do it in a loop:</p>\n\n<pre><code>Sub daf()\n    Dim docCopy As Document\n    Dim sPath(4) As String\n    Dim sFileName As String\n    Dim i As Long\n\n    sPath(0) = \"C:\\zzz\"\n    sPath(1) = \"c:\\ddd\"\n    sPath(2) = \"C:\\ttt\"\n    sPath(3) = \"C:\\yyy\"\n    sPath(5) = \"C:\\ooo\"\n\n    sFileName = Split(ActiveDocument.Name, \".\")(0)\n    Set docCopy = Application.Documents.Add(ActiveDocument.FullName)\n\n    For i = 0 To UBound(sPath)\n        docCopy.SaveAs2 sPath &amp; \"\\\" &amp; sFileName &amp; \".doc\", 12\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>You can add more arguments to saveAs2 if you wish, as you did in your original macro. </p>\n"}], "owner": {"reputation": 103, "user_id": 2170941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dd68815c69dd2910fc4008770633daf?s=128&d=identicon&r=PG", "display_name": "Beryllium", "link": "https://stackoverflow.com/users/2170941/beryllium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 402, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513796628, "creation_date": 1513756928, "last_edit_date": 1513796628, "question_id": 47901332, "link": "https://stackoverflow.com/questions/47901332/save-word-file-in-multiple-locations-at-once", "title": "Save Word file in multiple locations at once", "body": "<p>I am trying to save a word file in 5 different locations. My main problem is that my code only works if I specify a name in the save as part. I tried this, but with no luck:</p>\n\n<pre><code>  ChangeFileOpenDirectory _\n    \"O:\\xxxx\"\nActiveDocument.SaveAs FileName:=\n    \"O:\\xxxx\" &amp; Split(ActiveDocument.Name, \".\")(0) &amp; \".doc\", _\n    , FileFormat:=wdFormatXMLDocument, LockComments:=False, Password:=\"\", _\n    AddToRecentFiles:=True, WritePassword:=\"\", ReadOnlyRecommended:=False, _\n    EmbedTrueTypeFonts:=False, SaveNativePictureFormat:=False, SaveFormsData _\n    :=False, SaveAsAOCELetter:=False, CompatibilityMode:=15\n    ChangeFileOpenDirectory _\n    \"O:\\xxx\"\nActiveDocument.SaveAs2 FileName:= _\n    O:\\xxxx\" &amp; Split(ActiveDocument.Name, \".\")(0) &amp; \".doc\", _\n    , FileFormat:=wdFormatXMLDocument, LockComments:=False, Password:=\"\", _\n    AddToRecentFiles:=True, WritePassword:=\"\", ReadOnlyRecommended:=False, _\n    EmbedTrueTypeFonts:=False, SaveNativePictureFormat:=False, SaveFormsData _\n    :=False, SaveAsAOCELetter:=False, CompatibilityMode:=15\n    ChangeFileOpenDirectory _\n    \"O:\\xxx\"\nActiveDocument.SaveAs2 FileName:= _\n    O:\\xxxx\" &amp; Split(ActiveDocument.Name, \".\")(0) &amp; \".doc\", _\n    , FileFormat:=wdFormatXMLDocument, LockComments:=False, Password:=\"\", _\n    AddToRecentFiles:=True, WritePassword:=\"\", ReadOnlyRecommended:=False, _\n    EmbedTrueTypeFonts:=False, SaveNativePictureFormat:=False, SaveFormsData _\n    :=False, SaveAsAOCELetter:=False, CompatibilityMode:=15\n    ChangeFileOpenDirectory _\n    \"O:xxxx\"\nActiveDocument.SaveAs2 FileName:= _\n    O:\\xxxx\" &amp; Split(ActiveDocument.Name, \".\")(0) &amp; \".doc\", _\n    , FileFormat:=wdFormatXMLDocument, LockComments:=False, Password:=\"\", _\n    AddToRecentFiles:=True, WritePassword:=\"\", ReadOnlyRecommended:=False, _\n    EmbedTrueTypeFonts:=False, SaveNativePictureFormat:=False, SaveFormsData _\n    :=False, SaveAsAOCELetter:=False, CompatibilityMode:=15\n    ChangeFileOpenDirectory _\n    \"O:\\xxx\"\nActiveDocument.SaveAs2 FileName:= _\n    O:\\xxxx\" &amp; Split(ActiveDocument.Name, \".\")(0) &amp; \".doc\", _\n    , FileFormat:=wdFormatXMLDocument, LockComments:=False, Password:=\"\", _\n    AddToRecentFiles:=True, WritePassword:=\"\", ReadOnlyRecommended:=False, _\n    EmbedTrueTypeFonts:=False, SaveNativePictureFormat:=False, SaveFormsData _\n    :=False, SaveAsAOCELetter:=False, CompatibilityMode:=15\n</code></pre>\n\n<p>The file paths are all different but the filename should be the same. It basically should just take the name of the opened document. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 9102830, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10155131652447546/picture?type=large", "display_name": "DFH", "link": "https://stackoverflow.com/users/9102830/dfh"}, "edited": false, "score": 0, "creation_date": 1513761223, "post_id": 47902123, "comment_id": 82771469, "body": "Hello cbasah. Thanks for your answer. I get an idea of how it works! However, in column &quot;B&quot; it now inserts the row cell number (fx row 11) and in column &quot;C&quot; it inserts column cell number (fx column 6). What I would like is to just insert the data within the cell of the bottom right hand cell in column &quot;B&quot; of each table. Thank you in advance!"}, {"owner": {"reputation": 45, "user_id": 9102830, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10155131652447546/picture?type=large", "display_name": "DFH", "link": "https://stackoverflow.com/users/9102830/dfh"}, "edited": false, "score": 1, "creation_date": 1513761430, "post_id": 47902123, "comment_id": 82771598, "body": "I just deleted &quot;ws.Cells(lRow, &quot;C&quot;).Value = last.Column&quot; and changed &quot;ws.Cells(lRow, &quot;B&quot;).Value = last.Row&quot; to &quot;ws.Cells(lRow, &quot;B&quot;).Value = last&quot;. Thank you still!"}], "tags": [], "owner": {"reputation": 418, "user_id": 5026900, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8LXOaH1OepI/AAAAAAAAAAI/AAAAAAAAKu4/v6UvY3lkaoQ/photo.jpg?sz=128", "display_name": "cbasah", "link": "https://stackoverflow.com/users/5026900/cbasah"}, "is_accepted": true, "score": 1, "last_activity_date": 1513761638, "last_edit_date": 1513761638, "creation_date": 1513760242, "answer_id": 47902123, "question_id": 47901044, "link": "https://stackoverflow.com/questions/47901044/list-table-name-and-cell-in-last-row-and-column/47902123#47902123", "title": "List table name AND cell in last row and column", "body": "<p>I am assuming when you say last row and column means the bottom right hand corner cell of each table.</p>\n\n<p>Add the following snippet within With wsWsummary ... End With. What it does is it takes the range of cells for each table's data range and gets the last row's last column and spits out the data in that cell into the column next to the table's name.</p>\n\n<pre><code>        Dim r As Range\n        Dim last As Range\n\n        Set r = tbl.DataBodyRange\n        Set last = r.Cells(r.Rows.Count, r.Columns.Count)\n        ws.Cells(lRow, \"B\").Value = last\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 9102830, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10155131652447546/picture?type=large", "display_name": "DFH", "link": "https://stackoverflow.com/users/9102830/dfh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1135, "favorite_count": 0, "accepted_answer_id": 47902123, "answer_count": 1, "score": 0, "last_activity_date": 1513761638, "creation_date": 1513755751, "last_edit_date": 1531164843, "question_id": 47901044, "link": "https://stackoverflow.com/questions/47901044/list-table-name-and-cell-in-last-row-and-column", "title": "List table name AND cell in last row and column", "body": "<p>I am looking to list all table names in a sheet, together with the table's corresponding cell in the last row and column. The below code finds the table names in sheet \"A1.6Laster\" (Except table \"Lastkategori\") and then lists them in sheet \"A1.6.5Lastkombinationer\". </p>\n\n<p>Since I can add/delete tables i sheet \"A1.6Laster\", the list is first deleted/cleared.</p>\n\n<p>In other words; the below code work fine listing the names of the tables, but in the column next to the name list I want each table's corresponding cell in the last row and column to be listed as well. Do I need to add some code in the For Each loop?</p>\n\n<p>Any input is welcome, and please ask if you need further information!</p>\n\n<pre><code>Sub Laster()\nDim tbl As ListObject\nDim wsSummary As Worksheet\nDim ws As Worksheet\nDim lRow As Long\nDim SearchText As String\nDim GCell As Range\n\nSearchText = \"Laster\"\nSet GCell = Worksheets(\"A1.6.5Lastkombinationer\").Cells.Find(SearchText).Offset(0)\nSet wsSummary = Worksheets(\"A1.6.5Lastkombinationer\")\nSet ws = Worksheets(\"A1.6Laster\")\n\nWith Worksheets(\"A1.6.5Lastkombinationer\").ListObjects(\"Laster\").DataBodyRange\nIf .Rows.Count &gt; 1 Then\n  .Offset(1, 0).Resize(.Rows.Count - 1, .Columns.Count).Rows.Delete\nEnd If\nEnd With\nWorksheets(\"A1.6.5Lastkombinationer\").ListObjects(\"Laster\").DataBodyRange.Rows(1).ClearContents\n\nlRow = GCell.Row\n    For Each tbl In Worksheets(\"A1.6Laster\").ListObjects\n        If tbl.Name &lt;&gt; \"Lastkategori\" Then\n        lRow = lRow + 1\n        With wsSummary\n            .Cells(lRow, \"A\") = tbl.Name\n        End With\n        End If\n    Next tbl\n\nws.ListObjects(\"Lastkategori\").ListColumns(1).DataBodyRange.Copy\nwsSummary.ListObjects(\"Laster\").DataBodyRange(1, 1).End(xlDown).Offset(1).PasteSpecial Paste:=xlPasteValues\nApplication.CutCopyMode = False\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1513755915, "post_id": 47900977, "comment_id": 82768623, "body": "Please edit you post. Copy and paste the code directly from your VBE and format it as code, not as blockquote. I tried to clean it up, but I don&#39;t want to spend the time."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1513756354, "post_id": 47900977, "comment_id": 82768861, "body": "I&#39;ll second @teylyn. I did most of it, but be sure to clean up your code next time. It is easy. In VBE (where you write your code, highlight it and press <code>Tab</code> Then copy it here. It will automatically format your code as needed."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1513841194, "last_edit_date": 1513841194, "creation_date": 1513770632, "answer_id": 47905427, "question_id": 47900977, "link": "https://stackoverflow.com/questions/47900977/inserts-a-new-sheet-only-instead-of-a-pivot-table-in-a-new-sheet/47905427#47905427", "title": "Inserts a new sheet only instead of a Pivot Table in a new sheet", "body": "<p>You look like you have tried to combine or partially separate out steps here:</p>\n\n<pre><code>Set PCache = ActiveWorkbook.PivotCaches.Create _\n        (SourceType:=xlDatabase, SourceData:=PRange). _\n        CreatePivotTable(TableDestination:=PSheet.Cells(2, 2), _\n        TableName:=\"PivotTable\")\n\nSet PTable = PCache.CreatePivotTable _\n    (TableDestination:=PSheet.Cells(1, 1), TableName:=\"PivotTable\")\n</code></pre>\n\n<p>When in fact you want (as per your variables) to have two completely separate steps for the creation of the cache and then the pivottable:</p>\n\n<pre><code>Set PCache = ActiveWorkbook.PivotCaches.Create(xlDatabase, SourceData:=PRange)\n\nSet PTable = PCache.CreatePivotTable _\n        (TableDestination:=PSheet.Cells(1, 1), TableName:=\"PivotTable\")\n</code></pre>\n\n<p>And watch out for <code>On Error Resume Next</code> that isn't closed with an <code>On Error Goto O</code>, which is probably why you didn't spot this. </p>\n\n<p>Always add <code>Option Explicit</code> at the top of your module to check for variable declarations, spellings etc.</p>\n"}], "owner": {"reputation": 31, "user_id": 8836589, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/43ffe76366293adca89e7e46081455de?s=128&d=identicon&r=PG&f=1", "display_name": "Sachin", "link": "https://stackoverflow.com/users/8836589/sachin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513841194, "creation_date": 1513755436, "last_edit_date": 1513776223, "question_id": 47900977, "link": "https://stackoverflow.com/questions/47900977/inserts-a-new-sheet-only-instead-of-a-pivot-table-in-a-new-sheet", "title": "Inserts a new sheet only instead of a Pivot Table in a new sheet", "body": "<p>I would like to automatically insert the Pivot table in new sheet. When I run this, it only inserts a new sheet with the name of Pivot table, however it does not create the Pivot cache and it's not reading the data from source sheet. The sheet name is <code>Data</code> and <code>Pivot</code> should be created from this.</p>\n\n<pre><code>Sub InsertPivotTable()\n\n    Dim PSheet As Worksheet\n    Dim DSheet As Worksheet\n    Dim PCache As PivotCache\n    Dim PTable As PivotTable\n    Dim PRange As Range\n    Dim LastRow As Long\n    Dim LastCol As Long\n\n    On Error Resume Next\n    Application.DisplayAlerts = False\n    Worksheets(\"PivotTable\").Delete\n    Sheets.Add Before:=ActiveSheet\n    ActiveSheet.Name = \"PivotTable\"\n    Application.DisplayAlerts = True\n\n    Set PSheet = Worksheets(\"PivotTable\")\n    Set DSheet = Worksheets(\"Data\")\n\n    LastRow = DSheet.Cells(Rows.Count, 1).End(xlUp).Row\n    LastCol = DSheet.Cells(1, Columns.Count).End(xlToLeft).Column\n\n    Set PRange = DSheet.Cells(1, 1).Resize(LastRow, LastCol)\n\n    Set PCache = ActiveWorkbook.PivotCaches.Create _\n        (SourceType:=xlDatabase, SourceData:=PRange). _\n        CreatePivotTable(TableDestination:=PSheet.Cells(2, 2), _\n        TableName:=\"PivotTable\")\n\n    Set PTable = PCache.CreatePivotTable _\n        (TableDestination:=PSheet.Cells(1, 1), TableName:=\"PivotTable\")\n\n    With ActiveSheet.PivotTables(\"PivotTable\").PivotFields(\"Last_Touch_User_Name\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n\n    With ActiveSheet.PivotTables(\"PivotTable\").PivotFields(\"Action_Code\")\n        .Orientation = xlColumnField\n        .Position = 1\n    End With\n\n    With ActiveSheet.PivotTables(\"PivotTable\").PivotFields(\"Result_Code\")\n        .Orientation = xlColumnField\n        .Position = 2\n    End With\n\n    With ActiveSheet.PivotTables(\"PivotTable\").PivotFields(\"Medical_Manager__\")\n        .Orientation = xlDataField\n        .Position = 1\n        .Function = xlCount\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1513755154, "post_id": 47900698, "comment_id": 82768238, "body": "In <i>Visual Basic Editor (VBE)</i>, try running your your macro using <code>F8</code>. This will execute your code line by line. Now before you press <code>F8</code> again, open the <code>Locals Window</code> (you can find it under <code>View</code>). This will show you all the variables and its current value. Continuously press <code>F8</code> to find out what line of code doesn&#39;t do what you expect. This way, you will be able to find out what went wrong and why you&#39;re not getting the desired result. Once you&#39;ve found your specific issue, post it again here if you are unable to solve it."}, {"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1513755380, "post_id": 47900698, "comment_id": 82768340, "body": "I posted the issue. The macro recognized the variable range, but not when checking the cells value. It will only check two cells (of both weeks), not the entire row-range."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 2, "creation_date": 1513755620, "post_id": 47900698, "comment_id": 82768461, "body": "Yes, I understand, but I wouldn&#39;t be able to reproduce it since we do not have the data you&#39;re working on and there is no error, it just doesn&#39;t do what you want. What I&#39;m asking is for you to help us help you by trimming down your issue instead of letting us set up a test data and validate your code. And using the <code>Locals Window</code> and stepping through each line of code will improve your coding skills more than you&#39;ll ever know."}, {"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1513756261, "post_id": 47900698, "comment_id": 82768810, "body": "Ok, that&#39;s plausible. I think the main problem appears in the line <code>If previousCell &lt;&gt; myCell Then previousCell.clear</code>. The macro works perfectly till I&#39;ll add a third week. The main mistake is that it ONLY checks the cell next to it instead of the entire row-range. This will cause the macro to delete every value that was there before, no matter the value was 3 weeks in a row the same. Because of this, I can&#39;t tell when the value first got inserted - hopefully this does make sense. Every &quot;Value&quot; is a sales order block. I want to know in which week the block first appeared."}], "answers": [{"comments": [{"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1513762097, "post_id": 47902114, "comment_id": 82772000, "body": "Thank you! I tested the macro. Unfortunately the macro doesn&#39;t keep the old value. It only keeps the new added value, no matter if it&#39;s the same value."}, {"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1513762525, "post_id": 47902114, "comment_id": 82772263, "body": "Sorry, I tested it again:The only problem I can see here is, that it doesn&#39;t delete the old value, when adding a new and different value. It keeps the old with the new one. Also it should add in the column <code>LastCol-1</code> &quot;other&quot; to the row-ranges that have no values in it."}, {"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1513767199, "post_id": 47902114, "comment_id": 82775319, "body": "Also: somehow when the macro deletes to many values: <a href=\"https://i.imgur.com/YytETJR.png\" rel=\"nofollow noreferrer\">i.imgur.com/YytETJR.png</a>"}], "tags": [], "owner": {"reputation": 1269, "user_id": 6065711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bedb05fd942a5a6acd9870d295d3afd9?s=128&d=identicon&r=PG&f=1", "display_name": "Jochen", "link": "https://stackoverflow.com/users/6065711/jochen"}, "is_accepted": false, "score": 1, "last_activity_date": 1513781155, "last_edit_date": 1513781155, "creation_date": 1513760215, "answer_id": 47902114, "question_id": 47900698, "link": "https://stackoverflow.com/questions/47900698/delete-and-change-data-based-on-multiple-criteria-in-a-variable-range/47902114#47902114", "title": "Delete and change data based on multiple criteria in a variable range", "body": "<p>I would use a new collection for each row. You can add the value and iy you encounter an error (key already exists) then clear your cell. At the end you can use the last entered value to determine your 'overall'. Please take a look at the following code (I defined another range for testing, but you should be able to use the for..each with the lines before within your code):</p>\n\n<pre><code>Sub Test()\nSet myrow = Range(\"A1:H1\")\n    Dim Col As Collection, dmy\n    On Error Resume Next\n    Set Col = New Collection\n    For Each mycell In myrow.Cells\n        Err.Clear\n        Col.Add mycell.Value, mycell.Value\n        If Err Then mycell.ClearContents\n    Next mycell\n    myrow.Cells(1, myrow.Cells.Count + 1).Value = Col(Col.Count)\nEnd Sub\n</code></pre>\n\n<p>EDIT:\nIf you only want to delete a value that is identical to the last value (and not any value in that row before, as I understood) then you dont need a colletcion for this. Just use a normal variable like in the following code. I don't think the code will delete other values than that...:</p>\n\n<pre><code>Sub Test2()\nDim CurVal$\nSet myrow = Range(\"A1:H1\")\n    CurVal = \"\"\n    For Each mycell In myrow.Cells\n        If mycell.Value = CurVal Then\n            mycell.ClearContents\n        Else\n            CurVal = mycell.Value\n        End If\n    Next mycell\n    myrow.Cells(1, myrow.Cells.Count + 1).Value = iif(len(CurVal) &gt; 0,curval,\"other\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1513781155, "creation_date": 1513754331, "last_edit_date": 1513756495, "question_id": 47900698, "link": "https://stackoverflow.com/questions/47900698/delete-and-change-data-based-on-multiple-criteria-in-a-variable-range", "title": "Delete and change data based on multiple criteria in a variable range", "body": "<p>I asked a similar question before and someone helped me with another problem I had with this macro but now I got stuck again (1 week now). I wanted to make the macro variable in terms of range (row and column). </p>\n\n<p>For a better understanding: </p>\n\n<p><a href=\"https://i.stack.imgur.com/VCr4j.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VCr4j.png\" alt=\"enter image description here\"></a></p>\n\n<p>Every week I'll the latest added column and insert it between <code>Q:R</code> (only in this example, it's variable). Here is the macro I use to insert the column:</p>\n\n<pre><code>Sub insertColumn()\n\nDim lastrow         As Long\nDim LastCol         As Long\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\n'Copies the third last column and inserts it between the column [last date] and Overall'\nWith Sheets(\"getDATA\")\n    LastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n    lastrow = .Cells(.Rows.Count, \"G\").End(xlUp).Offset(7, 0).Row\n    .Columns(LastCol - 2).Copy\n    .Columns(LastCol - 1).Insert Shift:=xlToRight\nEnd With\n\nWith Sheets(\"getDATA\")\n    .Range(\"G7\").End(xlToRight).Offset(0, -2).Value = Date\n    .Range(Cells(8, LastCol).Address(), Cells(lastrow, LastCol).Address()).Offset(0, -1).Formula = \"=IFNA(INDEX($D:$D,MATCH($L8,$E:$E,0)),\"\"\"\")\"\nEnd With\n\nWith Sheets(\"getDATA\")\n    .Columns(LastCol - 2).PasteSpecial Paste:=xlPasteValues\nEnd With\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\n</code></pre>\n\n<p>After inserting a column, I'll check the DATA. If something new gets added, I'll delete everything that was in the weeks before. </p>\n\n<p>If the DATA has the same value one, two, three or more weeks, the macro should only keep the first one. If the cell is blank, the macro should add \"Other\" in the column Overall. </p>\n\n<p>The overall column should also display the value, we kept. You can see this in the example table - everything that grey should be deleted.</p>\n\n<p>Here is the Macro that checks the criteria:</p>\n\n<pre><code>Public Sub CheckDATA()\n\n    Dim myRow           As Range\n    Dim myCell          As Range\n    Dim inputRange      As Range\n    Dim previousCell    As Range\n    Dim flagValue       As Boolean\n    Dim lastCell        As Range\n    Dim lastrow         As Long\n    Dim LastCol         As Long\n\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n\n    With Sheets(\"getDATA\")\n    lastrow = .Cells(.Rows.Count, \"G\").End(xlUp).Row\n    LastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n    End With\n\n    Set inputRange = Worksheets(1).Range(Cells(8, 13).Address(), Cells(lastrow, LastCol - 2).Address())\n    For Each myRow In inputRange.Rows\n        Set previousCell = Nothing\n        flagValue = False\n        For Each myCell In myRow.Cells\n            If Len(myCell) Then flagValue = True\n            If Not previousCell Is Nothing Then\n                If previousCell &lt;&gt; myCell Then\n                    previousCell.clear\n                    Set previousCell = myCell\n                Else\n                    myCell.clear\n                End If\n            Else\n                Set previousCell = myCell\n            End If\n            Set lastCell = myCell\n        Next myCell\n\n        If Not flagValue Then\n            lastCell.Offset(0, 1) = \"Other\"\n        Else\n            lastCell.Offset(0, 1) = previousCell\n        End If\n    Next myRow\n\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>I think the main problem appears in the line If <code>previousCell &lt;&gt; myCell Then previousCell.clear.</code> The macro works perfectly till I'll add a third week. The main mistake is that it ONLY checks the cell next to it instead of the entire row-range. This will cause the macro to delete every value that was there before, no matter the value was 3 weeks in a row the same. Because of this, I can't tell when the value first got inserted - hopefully this does make sense. Every \"Value\" is a sales order block. I want to know in which week the block first appeared</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 9121348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df3839a0b938b669a7a540f4097e5b80?s=128&d=identicon&r=PG&f=1", "display_name": "Namrata", "link": "https://stackoverflow.com/users/9121348/namrata"}, "edited": false, "score": 0, "creation_date": 1513753087, "post_id": 47900384, "comment_id": 82767221, "body": "Sub OpenMyURL()    Dim eRow As Long Dim ele As Object Set objIE = CreateObject(&quot;InternetExplorer.Application&quot;) myjobtype = InputBox(&quot;Enter offer name&quot;) With objIE .Visible = True .navigate &quot;<a href=\"https://visualreports.aexp.com/#/views/AmexOffersPersistenceReport/AmexOffers?:iid=1\" rel=\"nofollow noreferrer\">visualreports.aexp.com/#/views/AmexOffersPersistenceReport/&zwnj;&#8203;&hellip;</a>&quot; &#39;getting runtime error here Do While .Busy Or _ .readyState &lt;&gt; 4 DoEvents Loop Set what = objIE.document.getElementsByName(&quot;omniboxTextBox&quot;) what.Item(0).Value = myjobtype .document.getElementById(&quot;JobsButton&quot;).Click Do While .Busy Or _ .readyState &lt;&gt; 4 DoEvents Loop Set objIE = Nothing End Sub"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1513753595, "post_id": 47900384, "comment_id": 82767454, "body": "Please use the edit link beneath your question and add the code into the question itself.  It is completely unreadable in comments."}, {"owner": {"reputation": 1, "user_id": 9121348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df3839a0b938b669a7a540f4097e5b80?s=128&d=identicon&r=PG&f=1", "display_name": "Namrata", "link": "https://stackoverflow.com/users/9121348/namrata"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513754042, "post_id": 47900384, "comment_id": 82767689, "body": "Not able to add my code while clicking the edit button"}], "owner": {"reputation": 1, "user_id": 9121348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df3839a0b938b669a7a540f4097e5b80?s=128&d=identicon&r=PG&f=1", "display_name": "Namrata", "link": "https://stackoverflow.com/users/9121348/namrata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 223, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513764120, "creation_date": 1513753056, "last_edit_date": 1531164843, "question_id": 47900384, "link": "https://stackoverflow.com/questions/47900384/vba-run-time-error-2147417848-80010108", "title": "VBA Run-time error &#39;-2147417848 (80010108)&#39;", "body": "<p>I am trying to connect to a webpage and enter a value but it's giving me the runtime error as follows:</p>\n\n<blockquote>\n  <p><code>Run-time error '-2147417848 (80010108)'.</code></p>\n</blockquote>\n\n<p>Here is my code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub OpenMyURL()\nDim eRow As Long\nDim ele As Object\nSet objIE = CreateObject(\"InternetExplorer.Application\")\nmyjobtype = InputBox(\"Enter offer name\")\nWith objIE\n    .Visible = True\n    .navigate \"visualreports.aexp.com/#/views/AmexOffersPersistenceReport/\u2026; 'getting runtime error here \"\n    Do While .Busy Or .readyState &lt;&gt; 4\n        DoEvents\n    Loop\n    Set what = objIE.document.getElementsByName(\"omniboxTextBox\")\n    what.Item(0).Value = myjobtype\n    .document.getElementById(\"JobsButton\").Click\n        Do While .Busy Or .readyState &lt;&gt; 4\n            DoEvents\n        Loop\n        Set objIE = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 936, "user_id": 5797253, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/c88e77db1b3b1d3d223f99341d0fb87f?s=128&d=identicon&r=PG&f=1", "display_name": "crimson589", "link": "https://stackoverflow.com/users/5797253/crimson589"}, "edited": false, "score": 0, "creation_date": 1513752378, "post_id": 47900203, "comment_id": 82766928, "body": "Just use the sheet number instead of the name?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1513752475, "post_id": 47900203, "comment_id": 82766974, "body": "Do you know the name of the sheet in the other 5 files? Is it the same name in those files?"}, {"owner": {"reputation": 99, "user_id": 8860294, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a5956d756c2d5eeea420933bf1cf8ae7?s=128&d=identicon&r=PG&f=1", "display_name": "shettyrish", "link": "https://stackoverflow.com/users/8860294/shettyrish"}, "reply_to_user": {"reputation": 936, "user_id": 5797253, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/c88e77db1b3b1d3d223f99341d0fb87f?s=128&d=identicon&r=PG&f=1", "display_name": "crimson589", "link": "https://stackoverflow.com/users/5797253/crimson589"}, "edited": false, "score": 0, "creation_date": 1515742464, "post_id": 47900203, "comment_id": 83424473, "body": "Hi @crimson589, the sheet numbers also vary and Tim Williams the names vary in the other 5 files as well."}, {"owner": {"reputation": 99, "user_id": 8860294, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a5956d756c2d5eeea420933bf1cf8ae7?s=128&d=identicon&r=PG&f=1", "display_name": "shettyrish", "link": "https://stackoverflow.com/users/8860294/shettyrish"}, "edited": false, "score": 0, "creation_date": 1515742603, "post_id": 47900203, "comment_id": 83424532, "body": "Hello @cbasah Thank you for the solution. I used mapping to the various files and sheets by storing all the required fields in a table and used functions to get the sheet name and other required fields from that table."}], "answers": [{"tags": [], "owner": {"reputation": 418, "user_id": 5026900, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8LXOaH1OepI/AAAAAAAAAAI/AAAAAAAAKu4/v6UvY3lkaoQ/photo.jpg?sz=128", "display_name": "cbasah", "link": "https://stackoverflow.com/users/5026900/cbasah"}, "is_accepted": false, "score": 0, "last_activity_date": 1513761117, "creation_date": 1513761117, "answer_id": 47902386, "question_id": 47900203, "link": "https://stackoverflow.com/questions/47900203/vba-looping-through-a-folder-to-get-data-from-multiple-workbooks-from-a-certain/47902386#47902386", "title": "VBA looping through a folder to get data from multiple workbooks from a certain sheet, but the sheet name varies in different workbooks", "body": "<p>Replace the lines from </p>\n\n<pre><code>Workbooks.Open (MyDir + MyFile)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>End With\n</code></pre>\n\n<p>with the following</p>\n\n<pre><code>Dim wb as Workbook\nDim ws as Worksheet\nSet wb = Workbooks.Open (MyDir + MyFile)\nFor Each ws in wb.Worksheets\n    if InStr(1, ws.Name, \"Mthly KPI\") &gt; 0 then\n        With ws\n        ' Add your code which copies data from the source worksheet to the master worksheet\n        Rws = Cells(Rows.Count, \"P\").End(xlUp).Row\n        End ws\n    End If\nNext ws\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 8860294, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a5956d756c2d5eeea420933bf1cf8ae7?s=128&d=identicon&r=PG&f=1", "display_name": "shettyrish", "link": "https://stackoverflow.com/users/8860294/shettyrish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3647, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1513761117, "creation_date": 1513752217, "last_edit_date": 1513755284, "question_id": 47900203, "link": "https://stackoverflow.com/questions/47900203/vba-looping-through-a-folder-to-get-data-from-multiple-workbooks-from-a-certain", "title": "VBA looping through a folder to get data from multiple workbooks from a certain sheet, but the sheet name varies in different workbooks", "body": "<p>I am looping through all the excel files in a folder to get data from a particular sheet in each workbook and consolidating the data into a master workbook. </p>\n\n<p>The problem is that the sheet name is 'Mthly KPI usd' in 9 of the 14 workbooks while the rest are different and I am not allowed to change the name of the worksheet. </p>\n\n<p>How can I resolve this issue? Thank you.</p>\n\n<p>This is my code :</p>\n\n<pre><code>Sub LoopThroughFolder()\n\n    Dim myCol As Long\n    Dim my_FileName As Variant\n    Dim i As Long\n    Dim lnRow As Long, lnCol As Long\n\n    Dim MyFile As String, Str As String, MyDir As String, Wb As Workbook\n    Dim Rws As Long, Rng As Range\n    Set Wb = ThisWorkbook\n    'change the address to suite\n    MyDir = \"E:\\John\\2017\\\"\n    MyFile = Dir(MyDir &amp; \"*.xl*\")    'change file extension\n    ChDir MyDir\n    Dim current As String\n    current = CurDir\n\n    Application.ScreenUpdating = 0\n    Application.DisplayAlerts = 0\n\n    Do While MyFile &lt;&gt; \"\"\n        If MyFile = \"Master.xlsm\" Then\n        Exit Sub\n        End If\n        Workbooks.Open (MyDir + MyFile)\n        With Worksheets(\"Mthly KPI usd\")\n            Rws = Cells(Rows.Count, \"P\").End(xlUp).Row\n            lnRow = 2\n            lnCol = ActiveSheet.Cells(lnRow, 1).EntireRow.Find(What:=\"Oct\", LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:=False).Column\n            MsgBox lnCol\n            Set Rng = Range(.Cells(4, lnCol), .Cells(Rws, lnCol))\n            Rng.Copy Wb.Sheets(\"Test\").Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 0)\n            ActiveWorkbook.Close True\n        End With\n        MyFile = Dir()\n    Loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9121278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5696fcc700d27291fd46a8764aaa940?s=128&d=identicon&r=PG&f=1", "display_name": "shamli", "link": "https://stackoverflow.com/users/9121278/shamli"}, "edited": false, "score": 0, "creation_date": 1513753649, "post_id": 47900303, "comment_id": 82767494, "body": "<i>You never use ws so Line never changes</i>  I didn&#39;t understand..  :(  Cant we use Dim inside the loop, so that for each time it repeats a new variable will be put in the Dim..  Sorry for my language...  I am trying to create a Pivot table from the Datas in Source in workbook.  So far I am able to insert Pivot in every worksheet using loop. Now I am trying to create a separate Workbook for Pivot only."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 23, "user_id": 9121278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5696fcc700d27291fd46a8764aaa940?s=128&d=identicon&r=PG&f=1", "display_name": "shamli", "link": "https://stackoverflow.com/users/9121278/shamli"}, "edited": false, "score": 0, "creation_date": 1513754128, "post_id": 47900303, "comment_id": 82767727, "body": "@shamli You store <code>ActiveSheet.Name</code> in <code>Line</code>. <code>ActiveSheet</code> is the active sheet in <code>Source</code>. You never change the active sheet in <code>Source</code>, so <code>Line</code> never changes either."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 23, "user_id": 9121278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5696fcc700d27291fd46a8764aaa940?s=128&d=identicon&r=PG&f=1", "display_name": "shamli", "link": "https://stackoverflow.com/users/9121278/shamli"}, "edited": false, "score": 0, "creation_date": 1513754278, "post_id": 47900303, "comment_id": 82767806, "body": "@shamli There is a worksheet collection in Excel (list of all the worksheet present in the workbook) which you have iterated using the <code>For Each</code> loop. What he meant was you iterated each <code>Worksheet</code> object but never really used or reference to it in your code within the loop and continuously used the <code>Activesheet</code> which as he already explained, never changed in the <code>Source</code> workbook. And since you used the <code>For Each</code> loop you need not use <code>Dim</code> since <code>ws</code> automatically reference to the next worksheet object in the collection."}, {"owner": {"reputation": 23, "user_id": 9121278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5696fcc700d27291fd46a8764aaa940?s=128&d=identicon&r=PG&f=1", "display_name": "shamli", "link": "https://stackoverflow.com/users/9121278/shamli"}, "edited": false, "score": 0, "creation_date": 1513754877, "post_id": 47900303, "comment_id": 82768098, "body": "Thanks @GSerg Thank you so much for helping me Appreciate it."}, {"owner": {"reputation": 23, "user_id": 9121278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5696fcc700d27291fd46a8764aaa940?s=128&d=identicon&r=PG&f=1", "display_name": "shamli", "link": "https://stackoverflow.com/users/9121278/shamli"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1513755026, "post_id": 47900303, "comment_id": 82768179, "body": "@L42, Now it is very much clear,  As I told earlier, I am new to VBA.  :)           There are much to learn,            I greatly appreciate the time you&#39;ve taken to share your knowledge with me."}], "tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": true, "score": 1, "last_activity_date": 1513752657, "creation_date": 1513752657, "answer_id": 47900303, "question_id": 47900115, "link": "https://stackoverflow.com/questions/47900115/copy-paste-worksheet-name-only/47900303#47900303", "title": "Copy paste worksheet &#39;name&#39; only", "body": "<p>You never use <code>ws</code> so <code>Line</code> never changes. Also <a href=\"https://stackoverflow.com/q/10714251/11683\">you do not need to select or activate anything</a>. Finally, you should qualify your <code>Worksheets</code> etc with the workbook they come from.</p>\n\n<pre><code>Dim Source As Workbook\nDim Pivot As Workbook\nSet Source = ActiveWorkbook\nSet Pivot = Workbooks.Add\n\nDim ws As Worksheet\nFor Each ws In Source.Worksheets\n    Pivot.Worksheets.Add.Name = ws.Name\nNext\n</code></pre>\n\n<p>That will not protect you from a situation where there is already a sheet in the new workbook with the name identical to one of your sheets name (e.g. <code>Sheet1</code>), and it will leave any sheets the new workbook has by default (controlled by the <code>Application.SheetsInNewWorkbook</code> property).</p>\n"}], "owner": {"reputation": 23, "user_id": 9121278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5696fcc700d27291fd46a8764aaa940?s=128&d=identicon&r=PG&f=1", "display_name": "shamli", "link": "https://stackoverflow.com/users/9121278/shamli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1107, "favorite_count": 0, "accepted_answer_id": 47900303, "answer_count": 1, "score": 2, "last_activity_date": 1513776326, "creation_date": 1513751850, "last_edit_date": 1531164843, "question_id": 47900115, "link": "https://stackoverflow.com/questions/47900115/copy-paste-worksheet-name-only", "title": "Copy paste worksheet &#39;name&#39; only", "body": "<p>I need to copy paste all my Worksheet name in the current workbook to a new workbook with same worksheet names. (without the datas. I only need the worksheet names.)</p>\n\n<p>I tried following VBA but it shows the error </p>\n\n<blockquote>\n  <p>\"The name is already taken.\"  (Runtime Error 1004)</p>\n</blockquote>\n\n<pre><code>'Create new work book for Pivot\nDim Source As Workbook\nDim Pivot As Workbook\nSet Source = ActiveWorkbook\nSet Pivot = Workbooks.Add\n\nDim ws As Worksheet\nFor Each ws In Worksheets\n    'Create new worksheet in new excel\n    Dim Line As String\n    Line = ActiveSheet.Name\n    Pivot.Activate\n    Sheets.Add\n    ActiveSheet.Name = Line\n    Source.Activate\nNext\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1513751120, "post_id": 47899927, "comment_id": 82766386, "body": "&quot;I have multiple counters, all as Integer&quot; - only the last one is integer.  All the others are Variant.  In VBA you need to specify the type for each one: you cannot use a comma-separated list like that.  And that chained assignment doesn&#39;t work like you think."}, {"owner": {"reputation": 91, "user_id": 5698354, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/678a144d4cd9ad35fd51b05b273f80a7?s=128&d=identicon&r=PG&f=1", "display_name": "user36510", "link": "https://stackoverflow.com/users/5698354/user36510"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1513753978, "post_id": 47899927, "comment_id": 82767653, "body": "OK, but even when I change the declaration to Dim lr As Integer, i As Integer, k As Integer etc. I get the same error"}, {"owner": {"reputation": 532, "user_id": 8994815, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/edf34942883bbc3c51d9c5ce4af5911c?s=128&d=identicon&r=PG", "display_name": "ACatInLove", "link": "https://stackoverflow.com/users/8994815/acatinlove"}, "edited": false, "score": 0, "creation_date": 1513758843, "post_id": 47899927, "comment_id": 82770136, "body": "Integers aren&#39;t really used in VBA. They refer to 16 bit integers for compatibility with 16 bit office. The 32bit(and 64bit) integer is 32 bit and called a long in VBA. Integer +/- 32K v&#39;s a long +/- 2 billion."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1513765374, "post_id": 47899927, "comment_id": 82774156, "body": "Do your cells contain errors?"}, {"owner": {"reputation": 91, "user_id": 5698354, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/678a144d4cd9ad35fd51b05b273f80a7?s=128&d=identicon&r=PG&f=1", "display_name": "user36510", "link": "https://stackoverflow.com/users/5698354/user36510"}, "edited": false, "score": 0, "creation_date": 1513769699, "post_id": 47899927, "comment_id": 82776860, "body": "After looking closely I found out that from the 2785 entries, one was invalid and messed the whole thing up. I fixed it and it is running now. How can I bypass this type of inputs ?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1513771472, "post_id": 47899927, "comment_id": 82777954, "body": "By using <code>IsError</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1513757104, "post_id": 47900012, "comment_id": 82769245, "body": "... and ultimately, only <code>a</code> is written to with the result of the logical comparison, all the other mentioned variables retain the values they had before the clause executed."}], "tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": false, "score": 4, "last_activity_date": 1513751401, "creation_date": 1513751401, "answer_id": 47900012, "question_id": 47899927, "link": "https://stackoverflow.com/questions/47899927/cant-find-runtime-error-13-cause/47900012#47900012", "title": "Can&#39;t find runtime error 13 cause", "body": "<ol>\n<li><p>All variables, except <code>s</code>, are not <code>Integer</code>s.</p></li>\n<li><p>All variables (were they <code>Integer</code>s) are automatically initialized to zero.</p></li>\n<li><p><code>a = b = c = d = e = f = g = h = j = l = m = n = o = p = q = r = 0</code> brings up <em>logical comparison</em>, i.e. it's checked whether r equals 0, then the result of this comparison is compared to <code>q</code> and so on.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 4, "last_activity_date": 1513751413, "creation_date": 1513751413, "answer_id": 47900015, "question_id": 47899927, "link": "https://stackoverflow.com/questions/47899927/cant-find-runtime-error-13-cause/47900015#47900015", "title": "Can&#39;t find runtime error 13 cause", "body": "<pre><code>Dim a, b, c, d As Integer '&lt;&lt; only d is integer...\n\na = b = c = d = 0\n\nDebug.Print \"a\", a\nDebug.Print \"b\", b\nDebug.Print \"c\", c\nDebug.Print \"d\", d\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>a             True\nb             \nc             \nd              0 \n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 5698354, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/678a144d4cd9ad35fd51b05b273f80a7?s=128&d=identicon&r=PG&f=1", "display_name": "user36510", "link": "https://stackoverflow.com/users/5698354/user36510"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1513776372, "creation_date": 1513751061, "last_edit_date": 1531164843, "question_id": 47899927, "link": "https://stackoverflow.com/questions/47899927/cant-find-runtime-error-13-cause", "title": "Can&#39;t find runtime error 13 cause", "body": "<p>I am trying to set up a simple counter with double-criteria and I am stopped by </p>\n\n<blockquote>\n  <p>runtime error 13</p>\n</blockquote>\n\n<p>As you see bellow, I have multiple counters, all as Integer and I want them to count every hit there is lockated depending on the values of the columns D and A. )In case it matters: the Text in column D is being generated via Dates-comparisson in two other columns, but is formatted as text). </p>\n\n<pre><code>Private Sub Workbook_Open()\n\nDim lr, i, k, a, b, c, d, e, f, g, h, j, l, m, n, o, p, q, r, s As Integer\n\na = b = c = d = e = f = g = h = j = l = m = n = o = p = q = r = 0\n\nWorksheets(\"overdue\").Activate\n\nlr = Range(\"D\" &amp; Rows.Count).End(xlUp).Row\n\nk = 1\n\nFor i = 1 To lr\n\nIf Cells(i, \"D\").Value = \"OVERDUE\" And Cells(i, \"A\") Like \"*\u03c6\u03af\u03bb\u03c4\u03c1\u03bf\u03c5*\" Then\na = a + 1\nElseIf Cells(i, \"D\").Value = \"OVERDUE\" And Cells(i, \"A\") Like \"*\u039b\u03b9\u03c0\u03b1\u03bd\u03c4\u03b9\u03ba\u03bf\u03cd*\" Then\nb = b + 1\n\nk = k + 1\n\nEnd If\nNext i\n</code></pre>\n\n<p>I even tried to relocate the Worksheet-name right at the cell-syntax like </p>\n\n<pre><code>If Worksheets(\"overdue\").Cells(i, \"D\").Value = \"OVERDUE\" And Worksheets(\"overdue\").Cells(i, \"A\") Like \"*\u00f6\u00df\u00eb\u00f4\u00f1\u00ef\u00f5*\" Then\n</code></pre>\n\n<p>but it does not seem to help. Does anybody have a suggestion ?\nI forgot to add, that the Debugger shows the line where the If is beggining, so the statement for the first counter.</p>\n\n<p>Also, I see, that if I change the code radically and simplify it as much as possible, like this</p>\n\n<pre><code> Sub testcounter()\n\n Dim cell As Range\n Dim a As Integer\n\n For Each cell In Worksheets(\"Sheet2\").Range(\"D1:D3500\")\n\n If cell.Value = \"1\" Then\n a = a + 1\n End If\n Next\n\n MsgBox a\n\n End Sub\n</code></pre>\n\n<p>It still gives out the </p>\n\n<blockquote>\n  <p>error 13</p>\n</blockquote>\n\n<p>on the first line of the IF-statement.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 8279226, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5af665ec67061510379d194829483710?s=128&d=identicon&r=PG&f=1", "display_name": "\ubc15\uc601\uc885", "link": "https://stackoverflow.com/users/8279226/%eb%b0%95%ec%98%81%ec%a2%85"}, "edited": false, "score": 1, "creation_date": 1513839683, "post_id": 47899006, "comment_id": 82806647, "body": "But... How Does it work?  this code just copied sheet and don&#39;t contain code that reopens xlsm file.  but xlsm file automatically reopens with this code. I really wonder how it works.."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 119, "user_id": 8279226, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5af665ec67061510379d194829483710?s=128&d=identicon&r=PG&f=1", "display_name": "\ubc15\uc601\uc885", "link": "https://stackoverflow.com/users/8279226/%eb%b0%95%ec%98%81%ec%a2%85"}, "edited": false, "score": 0, "creation_date": 1513840781, "post_id": 47899006, "comment_id": 82807156, "body": "The line <code>ThisWorkbook.Sheets.Copy</code> adds a new workbook with all the sheets from the Macro workbook and then SaveAs command saves the new workbook with .xlsx extension and closes it. So in the end, you see your macro workbook again. I think that&#39;s what you were trying to achieve. If that takes care of your original question, please take a minute to accept the answer to mark your question as Solved."}, {"owner": {"reputation": 119, "user_id": 8279226, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5af665ec67061510379d194829483710?s=128&d=identicon&r=PG&f=1", "display_name": "\ubc15\uc601\uc885", "link": "https://stackoverflow.com/users/8279226/%eb%b0%95%ec%98%81%ec%a2%85"}, "edited": false, "score": 1, "creation_date": 1513917619, "post_id": 47899006, "comment_id": 82841178, "body": "is my question marked as solved? sorry, I&#39;m new to stackoverflow, and your answer is very helpful, thank you."}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 5, "last_activity_date": 1513745600, "creation_date": 1513745600, "answer_id": 47899006, "question_id": 47898882, "link": "https://stackoverflow.com/questions/47898882/save-xlsx-files-via-excel-vba-without-opening-saved-file/47899006#47899006", "title": "Save .xlsx files via excel vba, without opening saved file", "body": "<p>Please give this a try...</p>\n\n<p>Remember to check the filename as I used the Format function to remove the invalid character from the filename.</p>\n\n<pre><code>ThisWorkbook.Sheets.Copy\nApplication.DisplayAlerts = False\nActiveWorkbook.SaveAs ThisWorkbook.Path &amp; \"\\\" &amp; Format(Date, \"mm.dd.yyyy\") &amp; \" \" &amp; \"Position Report Ver.2.xlsx\", FileFormat:=51\nActiveWorkbook.Close\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1513840624, "post_id": 47907190, "comment_id": 82807077, "body": "@Umair You are talking something strange. :)"}], "tags": [], "owner": {"reputation": 36, "user_id": 8893651, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tg0d5x-Z7FY/AAAAAAAAAAI/AAAAAAAAALs/NWttH9xK348/photo.jpg?sz=128", "display_name": "Umair Mehmood", "link": "https://stackoverflow.com/users/8893651/umair-mehmood"}, "is_accepted": false, "score": 0, "last_activity_date": 1513776638, "creation_date": 1513776638, "answer_id": 47907190, "question_id": 47898882, "link": "https://stackoverflow.com/questions/47898882/save-xlsx-files-via-excel-vba-without-opening-saved-file/47907190#47907190", "title": "Save .xlsx files via excel vba, without opening saved file", "body": "<p>@sktneer, this worked better. ThisWorkbook did not copy the sheets with data, but only opened a blank workbook. But ActiveWorkbook did the job.</p>\n\n<pre><code>ActiveWorkbook.Sheets.Copy\nApplication.DisplayAlerts = False\nActiveWorkbook.SaveAs ThisWorkbook.Path &amp; \"\\\" &amp; Format(Date, \"mm.dd.yyyy\") &amp; \" \n\" &amp; \"Position Report Ver.2.xlsx\", FileFormat:=51\nActiveWorkbook.Close\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 8279226, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5af665ec67061510379d194829483710?s=128&d=identicon&r=PG&f=1", "display_name": "\ubc15\uc601\uc885", "link": "https://stackoverflow.com/users/8279226/%eb%b0%95%ec%98%81%ec%a2%85"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7542, "favorite_count": 0, "accepted_answer_id": 47899006, "answer_count": 2, "score": 3, "last_activity_date": 1541661765, "creation_date": 1513744788, "question_id": 47898882, "link": "https://stackoverflow.com/questions/47898882/save-xlsx-files-via-excel-vba-without-opening-saved-file", "title": "Save .xlsx files via excel vba, without opening saved file", "body": "<p>I'm making excel vba code that makes outlook message and attach excel file itself(xlsx) for the message</p>\n\n<p>below line is from my code.</p>\n\n<pre><code>ThisWorkbook.SaveAs ThisWorkbook.Path &amp; \"\\\" &amp; Date &amp; \" \" &amp; \"Position Report Ver.2.xlsx\", FileFormat:=51 \n</code></pre>\n\n<p>This code saves xlsx file to specific folder.</p>\n\n<p>I want just saving copied xlsx file.</p>\n\n<p>but my code automatically opens saved file(xlsx file.) right after saving. and original file is closed.</p>\n\n<p>macro should run even after generating xlsx files because it should be attached to outlook message by vba macro.</p>\n\n<p>but, because xlsx file is opened right after saving, I can't run vba code after saving.</p>\n\n<p>How can I save from xlsm to xlsx without opening?</p>\n\n<p>I searched stackoverflow but I can't find the solution. code won't work or can't save to xlsx(just xlsm copy)... I couldn't find perfect answer...</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1513746985, "post_id": 47898824, "comment_id": 82764978, "body": "<code>Range(&quot;A11&quot;).End(xlToLeft)</code> are you sure you want to go left from ColA?  Which lines gives the error, and what is the name of the sheet with the button which calls your code?"}, {"owner": {"reputation": 25, "user_id": 9120949, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t50s2.jpg?s=128&g=1", "display_name": "Spixol", "link": "https://stackoverflow.com/users/9120949/spixol"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1513767809, "post_id": 47898824, "comment_id": 82775730, "body": "Well it was right but it worked better when I did the F8 in the compiler. the error was coming from ActiveCell.Offset(0, 1).Select but I changed it from -1 to 1 and worked better in the compiler. Analyst is the name."}, {"owner": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "edited": false, "score": 0, "creation_date": 1513789601, "post_id": 47898824, "comment_id": 82789683, "body": "Why would you make a range selection <code>Range(&quot;A11&quot;).End(xlToLeft).Select</code>, do nothing with it, then make another selection <code>ActiveCell.Offset(0, 1).Select</code>  ?, or so it appears to me."}, {"owner": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "edited": false, "score": 0, "creation_date": 1513791477, "post_id": 47898824, "comment_id": 82790657, "body": "Also, an <code>Option Explicit</code> at the very beginning would help narrow down the error."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9120949, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t50s2.jpg?s=128&g=1", "display_name": "Spixol", "link": "https://stackoverflow.com/users/9120949/spixol"}, "edited": false, "score": 0, "creation_date": 1513806031, "post_id": 47911541, "comment_id": 82797474, "body": "Thanks Tim, still getting the 400 error when trying to run the macro. Though it does work if putting in the date first. That is something I&#39;m tyring to avoid."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 25, "user_id": 9120949, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t50s2.jpg?s=128&g=1", "display_name": "Spixol", "link": "https://stackoverflow.com/users/9120949/spixol"}, "edited": false, "score": 0, "creation_date": 1513807052, "post_id": 47911541, "comment_id": 82797862, "body": "<b>Where is the error</b> ?  Which line is highlighted when it stops?"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1513791441, "creation_date": 1513791441, "answer_id": 47911541, "question_id": 47898824, "link": "https://stackoverflow.com/questions/47898824/visual-basics-400-error-in-excel-macros/47911541#47911541", "title": "Visual Basics 400 error in Excel macros", "body": "<p>This is my best guess at what you're trying to do:</p>\n\n<pre><code>Sub CalculateStats_Click()\n\n    Const RW_START As Long = 12\n    Const RW_END As Long = 93\n    Const COL_SUM_START As Long = 8 'H\n\n    Dim i As Long, sht As Worksheet, c As Range\n\n    Set sht = Worksheets(\"Analysts\")\n\n    'find the first empty header cell and populate the date\n    Set c = sht.Cells(RW_START - 1, sht.Columns.Count).End(xlToLeft).Offset(0, 1)\n    c.Value = Date\n\n    For i = RW_START To RW_END\n        sht.Cells(i, c.Column).Value = _\n            Application.Sum(sht.Cells(i, COL_SUM_START).Resize(1, 2))\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25, "user_id": 9120949, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t50s2.jpg?s=128&g=1", "display_name": "Spixol", "link": "https://stackoverflow.com/users/9120949/spixol"}, "is_accepted": false, "score": 0, "last_activity_date": 1513810218, "creation_date": 1513810218, "answer_id": 47915475, "question_id": 47898824, "link": "https://stackoverflow.com/questions/47898824/visual-basics-400-error-in-excel-macros/47915475#47915475", "title": "Visual Basics 400 error in Excel macros", "body": "<p>I have worked this out. Thanks for your help with this but it was due to the fact that the Macro was unassigned to the correct Module.</p>\n\n<p>How can I close this ticket?</p>\n"}], "owner": {"reputation": 25, "user_id": 9120949, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t50s2.jpg?s=128&g=1", "display_name": "Spixol", "link": "https://stackoverflow.com/users/9120949/spixol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 808, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1513810218, "creation_date": 1513744323, "last_edit_date": 1513776431, "question_id": 47898824, "link": "https://stackoverflow.com/questions/47898824/visual-basics-400-error-in-excel-macros", "title": "Visual Basics 400 error in Excel macros", "body": "<p>I am getting a </p>\n\n<blockquote>\n  <p>400 error</p>\n</blockquote>\n\n<p>when clicking on my macro, when I am in Visual Basic and step thru using <kbd>F8</kbd> it works fine but when ever I click on the Calculate Stats macro it gives a </p>\n\n<blockquote>\n  <p>400 error</p>\n</blockquote>\n\n<p>and won't run it unless I manually put a date in one of the rows. I want it to run without putting the date in and it automatically calculate the date. Sorry, I am new to programming and don't know what more I can say for this to make sense. Please see the code below:</p>\n\n<pre><code>Sub CalculateStats_Click()\n\n    Dim i As Integer\n    Dim x As Integer\n\n    'start row specified below as i\n    i = 12\n    'stop row specified as x\n    x = 94\n\n    Dim startloc As String\n    Dim stoploc As String\n    Dim reportcol As Integer\n\n\n    Range(\"A11\").End(xlToLeft).Select\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell = Date\n    reportcol = ActiveCell.Column\n\n    Do While i &lt; x\n        startloc = \"H\" &amp; i\n        stoploc = \"I\" &amp; i\n        Cells(i, reportcol).Value = WorksheetFunction.Sum(Worksheets(\"Analysts\").Range(Worksheets(\"Analysts\").Range(startloc), Worksheets(\"Analysts\").Range(stoploc)))\n        i = i + 1\n    Loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 0, "last_activity_date": 1513746018, "creation_date": 1513746018, "answer_id": 47899061, "question_id": 47898798, "link": "https://stackoverflow.com/questions/47898798/clear-content-of-dynamic-ranges-in-multiple-worksheets/47899061#47899061", "title": "clear content of dynamic ranges in multiple worksheets", "body": "<p>Please give this a try....</p>\n\n<pre><code>Sub test()\n\nDim ws As Worksheet\nDim lr As Long, lc As Long\n\nFor Each ws In ThisWorkbook.Sheets\n    If ws.Name &lt;&gt; \"Datainput\" Then\n        lr = ws.Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n        lc = ws.Cells.Find(\"*\", SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).Column\n        If lr &gt; 31 Then ws.Range(\"A32\", ws.Cells(lr, lc)).ClearContents\n    End If\nNext ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9120931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff99a15a6eec4f58c6ecaa1c74073d63?s=128&d=identicon&r=PG&f=1", "display_name": "jam", "link": "https://stackoverflow.com/users/9120931/jam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 47899061, "answer_count": 1, "score": 1, "last_activity_date": 1513746018, "creation_date": 1513744116, "question_id": 47898798, "link": "https://stackoverflow.com/questions/47898798/clear-content-of-dynamic-ranges-in-multiple-worksheets", "title": "clear content of dynamic ranges in multiple worksheets", "body": "<p>I would like to delete all data from the worksheets except for one called datainput.\nI have a template for my worksheets so my data starts on row 32 (A32) but each worksheet has a different number of records.</p>\n\n<p>I'm pretty new to macros and below is my miserable attempt.</p>\n\n<p>Thanks, </p>\n\n<pre><code>Sub test()\n\nDim ws As Integer\n\nws = Application.Sheets.Count\n\nFor x = 1 To ws\n      If Worksheets(x).Name &lt;&gt; \"Datainput\" \nThen Worksheets(x).Rows((32),Cells(Rows.Count,Columns.Count)).ClearContents\nEnd\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1513751836, "post_id": 47898530, "comment_id": 82766681, "body": "<code>Sheet2 A:B999</code> this looks wrong?"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1513752292, "creation_date": 1513752292, "answer_id": 47900215, "question_id": 47898530, "link": "https://stackoverflow.com/questions/47898530/how-to-use-stable-lookup-in-excel/47900215#47900215", "title": "How to use stable lookup in excel", "body": "<p>This should work (untested):</p>\n\n<pre><code>=INDEX(Sheet2!B2:B999, \n       MATCH(1,(Sheet2!A2:A999=Sheet1!F6)*\n               (Sheet2!E2:E999=Sheet1!F7),0))\n</code></pre>\n\n<p>Enter as an array function using Ctrl+Shift+Enter.</p>\n"}], "owner": {"reputation": 23, "user_id": 2828628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3014c34639ab02ebbb861dea5e722d8?s=128&d=identicon&r=PG&f=1", "display_name": "PMK", "link": "https://stackoverflow.com/users/2828628/pmk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513752292, "creation_date": 1513741882, "last_edit_date": 1531164843, "question_id": 47898530, "link": "https://stackoverflow.com/questions/47898530/how-to-use-stable-lookup-in-excel", "title": "How to use stable lookup in excel", "body": "<p>I have a excel formula that works on only two lines. When I add another line to the sheet, it no longer looks up correctly.</p>\n\n<p>My current formula is:</p>\n\n<pre><code>=LOOKUP('Data Entry'!F6,Invoice_Data!A2:B999,Invoice_Data!B2:B999) \n</code></pre>\n\n<p>I feel I need to use index or match or both but i can not get it work across multiple sheets, and columns.</p>\n\n<p>I am trying to match \"Sheet1 F6\" and \"Sheet1 F7\" with \"Sheet2 A:B999\" and \"Sheet2 E2:E999\", and return the value in \"Sheet2 B2:B999\" in Sheet3 any location.</p>\n\n<p>Any suggestion?\nThanks</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 8343981, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/992de028e83f8646fd5bf23996479c39?s=128&d=identicon&r=PG&f=1", "display_name": "remoel", "link": "https://stackoverflow.com/users/8343981/remoel"}, "edited": false, "score": 0, "creation_date": 1513741370, "post_id": 47898236, "comment_id": 82763673, "body": "I will change the` xlScreen` to <code>xlPrinter</code>? I tried and it still saving a blurred image. did on the <code>xlPicture</code> and still the same. I also tick the &quot;Don not crompress image file&quot; in the advanced settings. \u2013 remoel 9 mins ago"}, {"owner": {"reputation": 175, "user_id": 8343981, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/992de028e83f8646fd5bf23996479c39?s=128&d=identicon&r=PG&f=1", "display_name": "remoel", "link": "https://stackoverflow.com/users/8343981/remoel"}, "edited": false, "score": 0, "creation_date": 1513742397, "post_id": 47898236, "comment_id": 82763864, "body": "Guess the xlPrinter will do. Thanks Sir :)"}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": true, "score": 1, "last_activity_date": 1513739368, "creation_date": 1513739368, "answer_id": 47898236, "question_id": 47898204, "link": "https://stackoverflow.com/questions/47898204/pasting-image-to-chart-through-coding-gets-blurred/47898236#47898236", "title": "Pasting image to chart through coding gets blurred", "body": "<p>You need to copy the picture as a high-resolution metafile...</p>\n\n<p>Change the first argument to <code>CopyPicture</code> to <code>xlPrinter</code>.</p>\n"}], "owner": {"reputation": 175, "user_id": 8343981, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/992de028e83f8646fd5bf23996479c39?s=128&d=identicon&r=PG&f=1", "display_name": "remoel", "link": "https://stackoverflow.com/users/8343981/remoel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 47898236, "answer_count": 1, "score": 1, "last_activity_date": 1513776757, "creation_date": 1513739034, "last_edit_date": 1531164843, "question_id": 47898204, "link": "https://stackoverflow.com/questions/47898204/pasting-image-to-chart-through-coding-gets-blurred", "title": "Pasting image to chart through coding gets blurred", "body": "<p>I am having a problem when pasting an image on a chart.</p>\n\n<p>This is a cut sample of my code</p>\n\n<pre><code>ws.Paste\nSet MyChart = wb.Charts.Add\nMyChart.Name = \"ImageChart\"\nSet MyChart = MyChart.Location(Where:=xlLocationAsObject, Name:=ws.Name)\nMyChart.ChartArea.Width = ws.Shapes(1).Width\nMyChart.ChartArea.Height = ws.Shapes(1).Height\nMyChart.Parent.Border.LineStyle = 0 \nws.Shapes(1).CopyPicture xlScreen, xlPicture\nMyChart.ChartArea.Select\nMyChart.Paste\n</code></pre>\n\n<p>I am adjusting the height and width of the chart to be the same as the image and when it paste, it gets blurred. But when I am doing it manually, the quality of the image stays the same.</p>\n"}, {"tags": ["excel", "vba", "indexing", "match"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1513739444, "post_id": 47898075, "comment_id": 82763264, "body": "<code>rngDate = Range(&quot;Table24[date]&quot;) &#39;Date</code> puts the value in as array variable, that variable is not a range type variable, so it does not have <code>.Address</code> as a child."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513740664, "post_id": 47898075, "comment_id": 82763526, "body": "Have you declared <code>rngDate</code> (etc) <code>As Range</code> or <code>As Date</code>/<code>As String</code>.  If they are <code>Range</code> objects, you should <code>Set rngDate = ...</code>.  (If you have declared them as base data types, or allowed them to default to be <code>Variant</code>, then as Scott says you have just put the values into an array, which therefore won&#39;t have an <code>Address</code> property.)  It would really help us help you if you showed enough code that we could replicate your issue without having to guess about your declarations."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1513741434, "post_id": 47898075, "comment_id": 82763686, "body": "Index/Match is a worksheet solution, and not the best one for your problem. When you employ VBA you would look for the date using <code>Find</code> and then check the &#39;To&#39; and &#39;From&#39; columns for a match, looping until found. This wouldn&#39;t need the <code>lookup</code> range. However, if you wish to provide that range a simple <code>Find</code> would do the job."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1513750588, "last_edit_date": 1513750588, "creation_date": 1513750178, "answer_id": 47899760, "question_id": 47898075, "link": "https://stackoverflow.com/questions/47898075/excel-vba-index-match-not-pasting-a-formula-using-the-code/47899760#47899760", "title": "Excel VBA INDEX MATCH (not pasting a formula using the code)", "body": "<p>This worked for me using a table and columns of the same name:</p>\n\n<pre><code>Dim sht As Worksheet, dt, sFrom, sTo\n\nSet sht = ActiveSheet  ' e.g.\ndt = DateSerial(2017, 12, 18)\nsFrom = \"B\"\nsTo = \"C\"\n\nDebug.Print sht.Evaluate( _\n       \"INDEX(Table24[lookup],MATCH(1,\" &amp; _\n       \"(Table24[date]=\" &amp; (dt * 1) &amp; \")*\" &amp; _\n       \"(Table24[from]=\"\"\" &amp; sFrom &amp; \"\"\")*\" &amp; _\n       \"(Table24[to]=\"\"\" &amp; sTo &amp; \"\"\"),0))\")\n</code></pre>\n\n<p>Assumes your table's dates are actual dates and not strings.</p>\n"}], "owner": {"reputation": 73, "user_id": 8935024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70ed44590fba2ff81fce8d4adcb32692?s=128&d=identicon&r=PG&f=1", "display_name": "Pdfins", "link": "https://stackoverflow.com/users/8935024/pdfins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 448, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1513776797, "creation_date": 1513738022, "last_edit_date": 1513776797, "question_id": 47898075, "link": "https://stackoverflow.com/questions/47898075/excel-vba-index-match-not-pasting-a-formula-using-the-code", "title": "Excel VBA INDEX MATCH (not pasting a formula using the code)", "body": "<p>I've seen several questions asked around using <code>INDEX MATCH</code> on multiple criteria within VBA, but they all seem to revolve around pasting a formula into a cell. </p>\n\n<p>I'm looping thru a <code>ListObject</code> and trying to do a lookup on 3 criteria on a diff sheet, but I want the value pasted into the cell not the formula. I've tried using various combos of <code>Application.Index</code>, <code>Application.WorksheetFunction.Index</code>, <code>Application.Match</code>, <code>Application.WorksheetFunction.Match</code> and <code>Evaluate()</code> but I'm still getting <code>#Value!</code> (when I don't get a an Error). Some of what I've tried below (it's prob a very simple mistake I'm making).</p>\n\n<p><code>wsSrc</code> has the following ranges as part of a <code>ListObject</code> and I want to paste the result onto <code>wsDest</code>.</p>\n\n<pre><code>rngDate = Range(\"Table24[date]\") 'Date\nrngFrom = Range(\"Table24[from]\") 'String\nrngTo = Range(\"Table24[to]\") 'String\n\nrngLookup = Range(\"Table24[lookup]\") 'Double\n</code></pre>\n\n<p>Based on a combination of a Date, From and To I want to lookup a value in <code>rngLookup</code>.</p>\n\n<p>I've tried:</p>\n\n<pre><code>Application.Index(rngLookup.Address, _\nApplication.Match(strDate &amp; \"USD\" &amp; strTo, _\nrngDate.Address &amp; rngFrom.Address &amp; rngTo.Address))\n</code></pre>\n\n<p>I've also tried:</p>\n\n<pre><code>x = wsSrc.Evaluate(\"INDEX(\" &amp; rngLookup.Address &amp; _\n\",MATCH(\" &amp; strDate &amp; \"USD\" &amp; strTo &amp; \",\" &amp; _\nrngDate.Address &amp; \"&amp;\" &amp; rngFrom.Address &amp; \"&amp;\" &amp; rngTo.Address)\n</code></pre>\n\n<p>I've even tried converting the date using <code>CStr(CDate())</code> which works on in Excel, but not in the VBA.</p>\n\n<p>No joy on either, any thoughts? Again, to confirm I want just the value not the formula pasted into a cell.</p>\n"}]