[{"tags": ["ms-access", "vba", "ms-access-2016"], "comments": [{"owner": {"reputation": 1570, "user_id": 8305056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XVNQC.png?s=128&g=1", "display_name": "girlvsdata", "link": "https://stackoverflow.com/users/8305056/girlvsdata"}, "edited": false, "score": 0, "creation_date": 1532563210, "post_id": 51529019, "comment_id": 90026727, "body": "Welcome to Stack Overflow! It&#39;s not clear what you&#39;re asking, can you please include an explanation of how you came across the problem, and what you have tried to do to fix it? Screenshots might help in this case. See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>"}], "answers": [{"comments": [{"owner": {"reputation": 513, "user_id": 10136122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5a3d9c43c39b12b0a6a55f351fc95f7?s=128&d=identicon&r=PG", "display_name": "jcrizk", "link": "https://stackoverflow.com/users/10136122/jcrizk"}, "edited": false, "score": 0, "creation_date": 1532566347, "post_id": 51529452, "comment_id": 90027268, "body": "Thank you for the help! I&#39;m trying to limit the number of single-use queries and I was pulling my hair out."}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": true, "score": 1, "last_activity_date": 1532565675, "creation_date": 1532565675, "answer_id": 51529452, "question_id": 51529019, "link": "https://stackoverflow.com/questions/51529019/ms-access-force-showing-only-x-field-in-combobox/51529452#51529452", "title": "MS ACCESS: Force showing only X field in combobox", "body": "<p>the data/row source of the combobox can bet set as </p>\n\n<pre><code> SELECT yourColumn FROM tbl;\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/2VCNU.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2VCNU.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Then you dont have to bother with setting bound column or anything else.</p>\n"}], "owner": {"reputation": 513, "user_id": 10136122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5a3d9c43c39b12b0a6a55f351fc95f7?s=128&d=identicon&r=PG", "display_name": "jcrizk", "link": "https://stackoverflow.com/users/10136122/jcrizk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 51529452, "answer_count": 1, "score": -1, "last_activity_date": 1532565675, "creation_date": 1532561289, "last_edit_date": 1532565269, "question_id": 51529019, "link": "https://stackoverflow.com/questions/51529019/ms-access-force-showing-only-x-field-in-combobox", "title": "MS ACCESS: Force showing only X field in combobox", "body": "<p>So far, all I have found are answers that suggest I show all fields up until the the field I want and hiding the other fields by reducing their size to 0, but is there any way to force the combobox to only show the field I want without requiring I adjust column sizes?</p>\n\n<p><strong>CLARIFICATION:</strong></p>\n\n<ol>\n<li><p>When I set BoundColumn = 2, I get <a href=\"https://i.stack.imgur.com/JQClu.png\" rel=\"nofollow noreferrer\">this</a> result.</p></li>\n<li><p>So far, I have only been able to find solutions that require I set ColumnCount = 2 and set the ColumnWidths = 0\";x\" to hide the 1st column as seen <a href=\"https://i.stack.imgur.com/uDuQG.png\" rel=\"nofollow noreferrer\">here</a>.</p></li>\n</ol>\n\n<p>Q: Is there no way that I can simply pick <a href=\"https://i.stack.imgur.com/M3QEH.png\" rel=\"nofollow noreferrer\">this</a> column to be the source for the combobox without doing as was described in sentence 2?</p>\n\n<p>I hope that sufficiently clarifies my question.</p>\n\n<p>It seems like this should be an obvious feature and I don't understand why it's not.</p>\n\n<p>If a solution does exist that I haven't found yet, then kindly direct me to it.</p>\n\n<p>Thanks for reading.</p>\n"}, {"tags": ["arrays", "excel", "vba", "loops", "variables"], "comments": [{"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1532568008, "post_id": 51528866, "comment_id": 90027567, "body": "Please edit your question further to make it absolutely clear what your code does, without us having to read the actual code and work it out. Every sentence in your question should be self explanatory. For instance, you say *My only issue is its obviously not condensed at all. * <b>What</b> is obviously not condensed?"}, {"owner": {"reputation": 183, "user_id": 6814475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1a515363cb40e46d4a714afc9d3ca66?s=128&d=identicon&r=PG&f=1", "display_name": "pondersome", "link": "https://stackoverflow.com/users/6814475/pondersome"}, "edited": false, "score": 0, "creation_date": 1532571145, "post_id": 51528866, "comment_id": 90028214, "body": "Quick note:       Dim count1, count2, count3...count9 As Integer   doesn&#39;t declare them all as integers. It declares them all as Variant types except for count9 which is an Integer.  But to your main point, if I understand this correctly, you have column A populated with values, column C populated with search values you want found in Col A, and, if those values are found, you want the row numbers for those values listed in Col D next to the search value. Is that correct?"}, {"owner": {"reputation": 21, "user_id": 10130702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a0391be56b5e1f7f440728bd374da11?s=128&d=identicon&r=PG&f=1", "display_name": "James M. Russell", "link": "https://stackoverflow.com/users/10130702/james-m-russell"}, "edited": false, "score": 0, "creation_date": 1532572739, "post_id": 51528866, "comment_id": 90028537, "body": "I&#39;ll attempt to answer one question at a time. Bottom line is the code works and does what i need it to do. search a series (or array) of serial numbers through a mixed worksheet and returns a string of numbers (which is the rows the respective serial numbers are stored in) i later use these strings to copy the correlating rows into other sheets. I needed a way to do all the S/N&#39;s and not one at a time. So i had to copy the code 9 times, and create 9 &quot;versions&quot; of the variables. I was hoping to get some assistance with some way to condense the variables."}, {"owner": {"reputation": 21, "user_id": 10130702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a0391be56b5e1f7f440728bd374da11?s=128&d=identicon&r=PG&f=1", "display_name": "James M. Russell", "link": "https://stackoverflow.com/users/10130702/james-m-russell"}, "edited": false, "score": 0, "creation_date": 1532572988, "post_id": 51528866, "comment_id": 90028590, "body": "instead of having n1, n2, n3, ect. is there a way to make and array/loop function so my variables are all var(i), or count(i), or whatever the name is with a revolving number at the end. First pass through all the variables are count(1), findstring(1), ect... second time through all the variables are count(2), findstring (2) and so on. i tried loops and arrays but it either ended up with no results or stuck in a seemingly endless loop (which still yielded no results). I didn&#39;t get any errors when i tried this, just didn&#39;t get what i needed. Thank you in advance for you help and your patience."}], "answers": [{"tags": [], "owner": {"reputation": 183, "user_id": 6814475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1a515363cb40e46d4a714afc9d3ca66?s=128&d=identicon&r=PG&f=1", "display_name": "pondersome", "link": "https://stackoverflow.com/users/6814475/pondersome"}, "is_accepted": false, "score": 0, "last_activity_date": 1532573476, "creation_date": 1532573476, "answer_id": 51530297, "question_id": 51528866, "link": "https://stackoverflow.com/questions/51528866/array-references-in-a-vba-loop/51530297#51530297", "title": "array references in a vba loop?", "body": "<p>Col A populated with values, Col C populated with search values to be found in Col A, Col D is where the row numbers of each value in Col C can be found.</p>\n\n<p>The number of values in Col A and Col C are essentially limited only by the number of rows in your spreadsheet with no changes required to the code.</p>\n\n<p>If you have not added a Dictionary reference, click on [Tools] at the top of the screen, click on [References...], scroll way down until you find [Microsoft Scripting Runtime], click the check mark next to that, then click [OK].</p>\n\n<pre><code>Sub FindAircraftHourly()\nDim dnySource As New Scripting.Dictionary\nDim strCellValue As String\nDim i0 As Long\nWith ActiveSheet\n    For i0 = 2 To .Rows.Count 'This starts at row 2 and goes to the end of the list. I'm assuming row 1 has a heading of some sort.\n        If Not IsEmpty(.Cells(i0, 1)) Then 'If the cell in col A of that row has a value, add that value to the dictionary as the key and the row number(s) as the items(s).\n            strCellValue = .Cells(i0, 1).Value\n            dnySource(strCellValue) = dnySource(strCellValue) &amp; i0 &amp; \", \"\n        Else\n            Exit For 'Once you hit an empty cell, stop building the dictionary.\n        End If\n    Next i0\n\n    For i0 = 2 To .Rows.Count\n        If Not IsEmpty(.Cells(i0, 3)) Then 'If the cell in col C has a value then look through the dictionary to see if you have a list of row numbers to display.\n            strCellValue = .Cells(i0, 3).Value\n            If dnySource.Exists(strCellValue) Then 'If there is a list of row numbers for that value, display them in col D.\n                .Cells(i0, 4).Value = Left$(dnySource(strCellValue), Len(dnySource(strCellValue)) - 2) 'The - 2 here chops off the extra \", \" at the end\n            Else 'Otherwise, indicate that the value in col C doesn't exist in col A.\n                .Cells(i0, 4).Value = \"Value Not Found\"\n            End If\n        Else\n            Exit For\n        End If\n    Next i0\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 513, "user_id": 10136122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5a3d9c43c39b12b0a6a55f351fc95f7?s=128&d=identicon&r=PG", "display_name": "jcrizk", "link": "https://stackoverflow.com/users/10136122/jcrizk"}, "is_accepted": true, "score": 0, "last_activity_date": 1532575394, "last_edit_date": 1532575394, "creation_date": 1532574253, "answer_id": 51530394, "question_id": 51528866, "link": "https://stackoverflow.com/questions/51528866/array-references-in-a-vba-loop/51530394#51530394", "title": "array references in a vba loop?", "body": "<p>I'm not sure what your data looks like, but I would suggest a few things:</p>\n\n<pre><code>'finds the absolute last row with data in it // ignores empty cells\nk1 = data.UsedRange.Rows.Count\n\ncount1 = 0\nFor n1 = 1 To k1\n    'here's a built-in function to help you check empty cells.\n\n    'if you're going to reference ranges, then you need to define on which worksheet\n    'you're referencing the ranges from. if you work with multiple worksheets, you\n    'can't simply use Cells(x,y); you need to use worksheet.Cells(x,y).\n\n    'If you want to access a cell's value, then you use the .Value property.\n    If Not IsEmpty(data.Cells(n1, 1).Value) Then\n        count1 = count1 + 1\n        Else\n            Exit For\n    End If\nNext n1\n</code></pre>\n\n<p>I highly suggest using Collections instead of arrays because, for me, they're far easier to deal-with than arrays. They also start their indices at 1, so if you have a collection of 10 items, you count 1 through 10 instead of 0 through 9.</p>\n\n<p>Defining and setting Collections:</p>\n\n<pre><code>Dim FindArray As New Collection\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>Dim FindArray As Collection\nSet FindArray = New Collection\n</code></pre>\n\n<p>Iterating over a collection:</p>\n\n<pre><code>Dim v As Variant\nDim sample As Double\n\nFor Each v In FindArray\n    'i personally like to recast all variant types to\n    'the intended data type\n    sample = v\n\n    'do your thing here\nNext\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>For i = 0 To FindArray.Count\n    'do your other thing here\nNext\n</code></pre>\n\n<p>Here's my attempt at making your code cleaner; hope it helps!\nPS: All my castings are based on assumptions, so change them to whatever type you were intending.</p>\n\n<p>Main:</p>\n\n<pre><code>Dim wb As Workbook\nDim data As Worksheet\nDim n As Long\nDim SearchValue As Double\nDim Found As String\nDim output As New Collection\nDim FindArray As Collection\nDim count As Long\nDim k As Long\nDim i As Long\nDim j As Long\n\nSet wb = Excel.Application.ThisWorkbook\nSet data = wb.Worksheets(\"data\")\n\nk = data.UsedRange.Rows.Count\n\n'find the last row before an empty record appears\nFor n = 1 To k\n    If Not IsEmpty(data.Cells(n, 1).Value) Then\n        count = n\n    ElseIf IsEmpty(data.Cells(n ,1).Value) Then\n        Exit For\n    End If\nNext\n\n'do the thing 9 times\nFor n = 1 To 9\n    If Not IsEmpty(data.Cells(n, 3).Value) Then \n        'cast the cell value to double and assign it to searchvalue\n        SearchValue = CDbl(data.Cells(n, 3).Value)\n    'i prefer to be extremely specific, but that's just me\n    Elseif IsEmpty(data.Cells(n, 3).Value) Then\n        MsgBox \"No input found!\", vbCritical \n        GoTo the_end\n    End If\n\n    'reset findarray to an empty collection\n    Set FindArray = New Collection\n    For i = 1 To count\n        'load your collection with the sample values casted to doubles\n        FindArray.Add CDbl(data.Cells(i, 1).Value)\n    Next\n\n    j = 1\n    Found = \"\"\n    For i = 1 To FindArray.Count\n        If FindArray(i) = SearchValue Then\n            If j = 1 Then\n                Found = i\n            ElseIf j &gt; 1 Then\n                'im not sure what you're trying to accomplish with this line,\n                'so im just going to leave it as is and adjust it for my solution\n                'so it gives you the same output\n                Found = n &amp; \", \" &amp; i\n            End If\n            j = j + 1\n        End If\n    Next\n\n    If Found = \"\" Then\n        MsgBox \"Not found\", vbCritical\n    Else\n        output.Add Found\n    End If\n\n    'i like to always just set the collection to nothing before a new iteration\n    Set FindArray = Nothing\nNext\n\n'dump all results in column 4\nFor i = 1 To output.Count\n    data.Cells(i, 4).Value = output(i)\nNext\n\n'garbage collection\nSet FindArray = Nothing\nSet output = Nothing\nSet wb = Nothing\nSet data = Nothing\n\nthe_end:\n    Exit Sub\n</code></pre>\n\n<p>I'm not entirely sure if this attempt at a solution will work for you, but I hope it's helpful in any way. Good luck!</p>\n"}, {"tags": [], "owner": {"reputation": 194, "user_id": 8978777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c516087c61b368e673e81440bf15519?s=128&d=identicon&r=PG&f=1", "display_name": "Kajkrow", "link": "https://stackoverflow.com/users/8978777/kajkrow"}, "is_accepted": false, "score": 0, "last_activity_date": 1532587006, "creation_date": 1532587006, "answer_id": 51532450, "question_id": 51528866, "link": "https://stackoverflow.com/questions/51528866/array-references-in-a-vba-loop/51532450#51532450", "title": "array references in a vba loop?", "body": "<p>Here's my attempt to solve your problem.<br>\nFor questions just ask.</p>\n\n<pre><code>Option Explicit\nSub FindAircraftHourly()\n\nDim data As Worksheet\nDim searchrange As Range\nDim cell As Range\nDim findarray() As String\nDim searcharray() As Integer\nDim i As Integer\n\nSet data = ThisWorkbook.Worksheets(\"data\")      'the sheet your working on\n\nConst maxinputvals As Integer = 3   'The number of search values you want to be looking for\nReDim searcharray(1 To maxinputvals) As Integer   'VBA doesn't need to start at 0\nReDim findarray(1 To maxinputvals) As String    'VBA doesn't need to start at 0\n\ni = 0 'not needed but always nice to make sure\nDo\n    i = i + 1       'add 1 to the count-var\n    If i &gt; maxinputvals Then Exit Do    'if the count-var si bigger than max number of searchvalues quit the loop\n    If data.Cells(i, 3) &lt;&gt; \"\" Then  'check if cells is not empty\n        searcharray(i) = data.Cells(i, 3).Value     'safe the searchvalue\n    Else\n        MsgBox \"Searchvalue #\" &amp; i &amp; \" is missing.\"     'exit the sub if a searchvalue is missing\n        Exit Sub\n    End If\nLoop\n\nSet searchrange = data.Range(\"A1:A5000\")\n\nFor Each cell In searchrange        'go through the whole range\n    If cell.Value &lt;&gt; \"\" Then        'check is cell is empty\n        For i = 1 To maxinputvals   'if not, check if match with one of the searchvals\n            If cell.Value = searcharray(i) Then\n                findarray(i) = findarray(i) &amp; \", \" &amp; cell.Row     'append your findarray string\n            End If\n        Next i\n    Else\n        Exit For        'if cell is empty exit the loop\n    End If\nNext cell\n\nFor i = 1 To maxinputvals\n    findarray(i) = Mid(findarray(i), 3)     'delete the first \", \"\n    data.Cells(i, 4) = findarray(i)         'output the findstring\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10130702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a0391be56b5e1f7f440728bd374da11?s=128&d=identicon&r=PG&f=1", "display_name": "James M. Russell", "link": "https://stackoverflow.com/users/10130702/james-m-russell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 51530394, "answer_count": 3, "score": 1, "last_activity_date": 1532587006, "creation_date": 1532560091, "question_id": 51528866, "link": "https://stackoverflow.com/questions/51528866/array-references-in-a-vba-loop", "title": "array references in a vba loop?", "body": "<p>OK... second attempt at posting this. Trying to make my question make sense please be patient with me, I am new at all of this. </p>\n\n<p>The code below words PERFECTLY. It reads from the Range in column A and give me a string of all the cells where the searched numbers occur.</p>\n\n<p>My only issue is its obviously not condensed at all. I have tried loops and arrays for the references but i can't seem to get it work. i would prefer something along the lines of reference(1-10) in stead of ref1, ref2, ref3. i had them all ref(i) with a loop around the whole macro but i ended up getting no results and an endless loop. any help to make this more streamlined would be appreciated. i have the full code if that will help anyone. I only put three iterations of the code it simply continues on with more references. up to 9</p>\n\n<pre><code>Option Explicit\nSub FindAircraftHourly()\n\nDim Findarray() As Integer 'the array to put numbers in\nDim count1, count2, count3, count4, count5, count6, count7, count8, count9 As Integer 'this will count the number of records you will need for your array\nDim n1, n2, n3, n4, n5, n6, n7, n8, n9 As Integer 'this will be what gets you through your For loops\nDim Searchvalue1, Searchvalue2, Searchvalue3, Searchvalue4, Searchvalue5, Searchvalue6, Searchvalue7, Searchvalue8, Searchvalue9 As Integer 'this is the number to look for\nDim Foundstring1, Foundstring2, foundstring3, foundstring4, foundstring5, foundstring6, foundstring7, Foundstring8, Foundstring9 As String 'this will build where the numbers are found\nDim k1 As Integer\nDim data As Worksheet\n\nSet data = ThisWorkbook.Sheets(\"data\")\n\nIf Cells(1, 3) &lt;&gt; \"\" Then 'test to make sure it has something to look for\n    Searchvalue1 = Cells(1, 3) * 1 'E18 is the search value for the function this converts it to number and not text\nElse\n    MsgBox \"No input found!\", vbCritical 'if blank, give a warning and quit\n    GoTo the_end\nEnd If\n\nk1 = data.Range(\"A5000\").End(xlUp).Row\n\ncount1 = 0 'always initialize your variables\nFor n1 = 1 To k1 'count through all the rows to find the end of the list\nIf Cells(n1, 1) &lt;&gt; \"\" Then 'is the cell blank or not?\n    count1 = count1 + 1 'if not blank, then increase the count\n    Else\n        Exit For 'if it's blank, stop looking and counting\nEnd If\nNext n1\n\nReDim Findarray1(0 To count1 - 1) As Integer 'array indexes start at 0, so subtract 1 to get the right number of elements\n\nFor n1 = 0 To UBound(Findarray1) 'go from the first element to the last of the array\nFindarray1(n1) = Cells(n1 + 1, 1) 'load the array change the last number in the cells box to change where to start looking\nNext n1\n\nFor n1 = 0 To UBound(Findarray1)\nIf Findarray1(n1) = Searchvalue1 Then\n    If Foundstring1 = \"\" Then 'if this is the first time found, create the string\n        Foundstring1 = n1 + 1\n        Else\n            Foundstring1 = Foundstring1 &amp; \", \" &amp; n1 + 1 'if this is the second time the number is found, add a comma and continue to build the string.\n    End If\nEnd If\nNext n1\n\nIf Foundstring1 = \"\" Then\nMsgBox \"Not found\", vbCritical 'msgbox nothing was found\nElse\n    Cells(1, 4) = Foundstring1 'output the string to a certain cell\nEnd If\n\n'-----------------------------------------------------------------------    \nIf Cells(2, 3) &lt;&gt; \"\" Then 'test to make sure it has something to look for\n    Searchvalue2 = Cells(2, 3) * 1 'E18 is the search value for the function this converts it to number and not text\n    Else\n    MsgBox \"No input found!\", vbCritical 'if blank, give a warning and quit\n    GoTo the_end\nEnd If\n\nk1 = data.Range(\"A5000\").End(xlUp).Row\n\ncount2 = 0 'always initialize your variables\nFor n2 = 1 To k1 'count through all the rows to find the end of the list\n    If Cells(n2, 1) &lt;&gt; \"\" Then 'is the cell blank or not?\n        count2 = count2 + 1 'if not blank, then increase the count\n        Else\n        Exit For 'if it's blank, stop looking and counting\n    End If\nNext n2\n\nReDim FindArray2(0 To count2 - 1) As Integer 'array indexes start at 0, so subtract 1 to get the right number of elements\n\nFor n2 = 0 To UBound(FindArray2) 'go from the first element to the last of the array\n    FindArray2(n2) = Cells(n2 + 1, 1) 'load the array change the last number in the cells box to change where to start looking\nNext n2\n\nFor n2 = 0 To UBound(FindArray2)\n    If FindArray2(n2) = Searchvalue2 Then\n    If Foundstring2 = \"\" Then 'if this is the first time found, create the string\n        Foundstring2 = n2 + 1\n        Else\n            Foundstring2 = Foundstring2 &amp; \", \" &amp; n2 + 1 'if this is the second time the number is found, add a comma and continue to build the string.\n        End If\n    End If\nNext n2\n\nIf Foundstring2 = \"\" Then\nMsgBox \"Not found\", vbCritical 'msgbox nothing was found\nElse\n    Cells(2, 4) = Foundstring2 'output the string to a certain cell\nEnd If\n'-----------------------------------------------------------\nIf Cells(3, 3) &lt;&gt; \"\" Then 'test to make sure it has something to look for\nSearchvalue3 = Cells(3, 3) * 1 'E18 is the search value for the function this converts it to number and not text\nElse\n    MsgBox \"No input found!\", vbCritical 'if blank, give a warning and quit\n    GoTo the_end\nEnd If\n\nk1 = data.Range(\"A5000\").End(xlUp).Row\n\ncount3 = 0 'always initialize your variables\nFor n3 = 1 To k1 'count through all the rows to find the end of the list\n    If Cells(n3, 1) &lt;&gt; \"\" Then 'is the cell blank or not?\n    count3 = count3 + 1 'if not blank, then increase the count\n        Else\n            Exit For 'if it's blank, stop looking and counting\n    End If\nNext n3\n\nReDim FindArray3(0 To count3 - 1) As Integer 'array indexes start at 0, so subtract 1 to get the right number of elements\n\nFor n3 = 0 To UBound(FindArray3) 'go from the first element to the last of the array\n    FindArray3(n3) = Cells(n3 + 1, 1) 'load the array change the last number in the cells box to change where to start looking\nNext n3\n\nFor n3 = 0 To UBound(FindArray3)\n    If FindArray3(n3) = Searchvalue3 Then\n        If foundstring3 = \"\" Then 'if this is the first time found, create the string\n            foundstring3 = n3 + 1\n            Else\n                foundstring3 = foundstring3 &amp; \", \" &amp; n3 + 1 'if this is the second time the number is found, add a comma and continue to build the string.\n        End If\n    End If\nNext n3\n\nIf foundstring3 = \"\" Then\nMsgBox \"Not found\", vbCritical 'msgbox nothing was found\nElse\n    Cells(3, 4) = foundstring3 'output the string to a certain cell\nEnd If\nthe_end: 'end marker\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1532575214, "post_id": 51528826, "comment_id": 90028992, "body": "<a href=\"https://stackoverflow.com/questions/45020237/programming-multiple-findnext-in-vba/45020602#45020602\" title=\"programming multiple findnext in vba\">stackoverflow.com/questions/45020237/&hellip;</a>"}, {"owner": {"reputation": 15, "user_id": 8993464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e2e0967dd8db026203e37836bc3c6b3?s=128&d=identicon&r=PG&f=1", "display_name": "InterestedGuy", "link": "https://stackoverflow.com/users/8993464/interestedguy"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1532636791, "post_id": 51528826, "comment_id": 90061749, "body": "Hi Tim, this is going to sound really dumb but I can&#39;t seem to fully understand the code in the link you said - would it be possible to provide an overview of what is happening??"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8993464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e2e0967dd8db026203e37836bc3c6b3?s=128&d=identicon&r=PG&f=1", "display_name": "InterestedGuy", "link": "https://stackoverflow.com/users/8993464/interestedguy"}, "edited": false, "score": 0, "creation_date": 1532636834, "post_id": 51528971, "comment_id": 90061765, "body": "Thank you for this link! it is extremely helpful - i&#39;m still struggling to get my while loop correct so any further help will be appreciated"}], "tags": [], "owner": {"reputation": 1, "user_id": 10128437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38d8b9bb655cf4f95d91d2649fe91883?s=128&d=identicon&r=PG&f=1", "display_name": "tomghc", "link": "https://stackoverflow.com/users/10128437/tomghc"}, "is_accepted": false, "score": 0, "last_activity_date": 1532560984, "creation_date": 1532560984, "answer_id": 51528971, "question_id": 51528826, "link": "https://stackoverflow.com/questions/51528826/vba-excel-ctrl-find/51528971#51528971", "title": "VBA-Excel CTRL Find", "body": "<p>The short answer is that there is no built-in way to return a range with all the find results (i.e. find all) in one go. You have to find the first result (the code you already have) and then use findNext within a while loop, exiting only when the next result until it refers to the same cell as the first result. </p>\n\n<p>There is a good explanation/implementation at <a href=\"http://www.cpearson.com/excel/findall.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/findall.aspx</a></p>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1532638513, "creation_date": 1532638513, "answer_id": 51547375, "question_id": 51528826, "link": "https://stackoverflow.com/questions/51528826/vba-excel-ctrl-find/51547375#51547375", "title": "VBA-Excel CTRL Find", "body": "<p>Lightly tested:</p>\n\n<pre><code>Sub Tester()\n\n    Dim col As Collection, c, sht As Worksheet\n\n    Set sht = ActiveSheet\n\n    Set col = FindAll(sht.UsedRange, \"N/C:\")\n    Debug.Print \"Found \" &amp; col.Count &amp; \" matches\"\n\n    For Each c In col\n        c.Copy c.Offset(3, 3)\n        sht.Range(c.Offset(3, 3), c.Offset(3, 3).End(xlDown)).FillDown\n    Next c\n\n\nEnd Sub\n\n\nPublic Function FindAll(rng As Range, val As String) As Collection\n    Dim rv As New Collection, f As Range\n    Dim addr As String\n\n    Set f = rng.Find(what:=val, after:=rng.Cells(rng.Cells.Count), _\n        LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByRows, _\n        SearchDirection:=xlNext, MatchCase:=False)\n\n    If Not f Is Nothing Then addr = f.Address()\n\n    Do Until f Is Nothing\n        rv.Add f\n        Set f = rng.FindNext(after:=f)\n        If f.Address() = addr Then Exit Do\n    Loop\n\n    Set FindAll = rv\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8993464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e2e0967dd8db026203e37836bc3c6b3?s=128&d=identicon&r=PG&f=1", "display_name": "InterestedGuy", "link": "https://stackoverflow.com/users/8993464/interestedguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 476, "favorite_count": 0, "accepted_answer_id": 51547375, "answer_count": 2, "score": -1, "last_activity_date": 1532638513, "creation_date": 1532559880, "question_id": 51528826, "link": "https://stackoverflow.com/questions/51528826/vba-excel-ctrl-find", "title": "VBA-Excel CTRL Find", "body": "<p>I am currently trying to find a certain word within an excel spreadsheet, copy the cell on the right and then paste it a further 3 cells to the right and 3 cells down, before dragging this down.</p>\n\n<p>I have compiled the following which does the job.</p>\n\n<pre><code>Cells.Find(What:=\"N/C:\", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n    :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n    False, SearchFormat:=False).Activate\n    Selection.Offset(0, 1).Select\nSelection.Copy\n\nSelection.Offset(3, 3).Select\nActiveSheet.Paste\n\nRange(Selection, Selection.End(xlDown)).Select\n\nSelection.FillDown\n</code></pre>\n\n<p><strong>My question is:</strong>\nHow can I extend this code so it searches for all \"N/C:\" and does the above</p>\n\n<p>Feel free to provide updates to my initial code if it can be improved</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1532559364, "post_id": 51528754, "comment_id": 90025965, "body": "Was literally typing this exact answer."}], "tags": [], "owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "is_accepted": true, "score": 3, "last_activity_date": 1532559288, "creation_date": 1532559288, "answer_id": 51528754, "question_id": 51528641, "link": "https://stackoverflow.com/questions/51528641/how-to-do-string-comparison-in-vba-if-a-string-has-an-inequality-operator/51528754#51528754", "title": "How to do string comparison in VBA if a string has an inequality operator?", "body": "<p>Excel and VBA use <a href=\"http://www.unicode.org/charts/nameslist/index.html\" rel=\"nofollow noreferrer\">Unicode</a> (UTF-16) for string/text values. Unfortunately, the VBA editor does not. </p>\n\n<p>For characters that the VBA editor doesn't support, use <code>ChrW</code>. For <a href=\"https://www.fileformat.info/info/unicode/char/2265/index.htm\" rel=\"nofollow noreferrer\"> Unicode Character 'GREATER-THAN OR EQUAL TO' (U+2265)</a>, use <code>ChrW(&amp;H2265)</code> as in</p>\n\n<pre><code>Case \"Valid Test for \" &amp; ChrW(&amp;H2265) &amp; \" 30% ABCD?\"\n</code></pre>\n\n<p>Note: <code>Asc</code> doesn't do what you think it does-It's not ASCII and it isn't a one-to-one conversion. In almost all cases, <code>AscW</code> is what you want; it gives the UTF-16 code unit value the \"character\", plain and simple as far as VBA is concerned. (Of course, text isn't simple, so Unicode and UTF-16 are correspondingly complex in some areas.)</p>\n"}], "owner": {"reputation": 8724, "user_id": 619177, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/65d2dc7c8d335fa33854172a26fa46f5?s=128&d=identicon&r=PG", "display_name": "sigil", "link": "https://stackoverflow.com/users/619177/sigil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 51528754, "answer_count": 1, "score": 0, "last_activity_date": 1532559288, "creation_date": 1532558437, "question_id": 51528641, "link": "https://stackoverflow.com/questions/51528641/how-to-do-string-comparison-in-vba-if-a-string-has-an-inequality-operator", "title": "How to do string comparison in VBA if a string has an inequality operator?", "body": "<p>I have an Excel sheet that can have the following string in one of its cells:</p>\n\n<pre><code>Valid Test for \u2265 30% ABCD?\n</code></pre>\n\n<p>When I capture this value in a variable and output it in the Immediate window, it looks like this:</p>\n\n<pre><code>?strVal\nValid Test for = 30% ABCD?\n</code></pre>\n\n<p>I want to check whether the cell contains this value, and currently I'm using:</p>\n\n<pre><code>Select Case strVal\n    Case \"Valid Test for = 30% ABCD?\"\n        doSomething\n    '... other Case statements\n    Case Else\n        doSomethingElse\nEnd Select\n</code></pre>\n\n<p>This string match always fails, though, and I get the following results when I investigate in the Immediate window:</p>\n\n<pre><code>?strVal=\"Valid Test for = 30% ABCD?\"\nFalse\n\n?asc(mid(strVal,16,1))\n 61 \n\n?asc(\"=\")\n 61 \n</code></pre>\n\n<p>So apparently what's happening here is that the \"\u2265\" symbol is being rendered in VBA output as \"=\" both in appearance and ASCII code, but somehow it's still not equivalent to \"=\" in string comparison.  How can I get the string match that I'm looking for?</p>\n"}, {"tags": ["arrays", "string", "vba", "excel"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1532570285, "post_id": 51528592, "comment_id": 90028015, "body": "Is it really the case that the separators in the original data can vary, the way you show it?"}, {"owner": {"reputation": 19, "user_id": 10135574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/327c08de3e31a7d0dfbb62af1d5e89de?s=128&d=identicon&r=PG&f=1", "display_name": "JCarlo", "link": "https://stackoverflow.com/users/10135574/jcarlo"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1532574125, "post_id": 51528592, "comment_id": 90028793, "body": "Unfortunately yes, it is data that has been registered manually for years by different people."}, {"owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "edited": false, "score": 0, "creation_date": 1532599290, "post_id": 51528592, "comment_id": 90039807, "body": "The first thing is that the Cell addressing is the wrong way round, for row 5 column 1 it should be Cells (5,1)"}], "answers": [{"comments": [{"owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "edited": false, "score": 0, "creation_date": 1532604582, "post_id": 51537390, "comment_id": 90042983, "body": "Nice - I guess would need modifying slightly to deal with 2-digit numbers but it already answers OP&#39;s question."}, {"owner": {"reputation": 77, "user_id": 8389849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbf809b611c4d41507a3f9472003661c?s=128&d=identicon&r=PG&f=1", "display_name": "adarti", "link": "https://stackoverflow.com/users/8389849/adarti"}, "reply_to_user": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "edited": false, "score": 1, "creation_date": 1532618230, "post_id": 51537390, "comment_id": 90052177, "body": "@Tom Sharpe, of course you&#39;re right, I just modified the code by including two-digit numbers ."}, {"owner": {"reputation": 19, "user_id": 10135574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/327c08de3e31a7d0dfbb62af1d5e89de?s=128&d=identicon&r=PG&f=1", "display_name": "JCarlo", "link": "https://stackoverflow.com/users/10135574/jcarlo"}, "edited": false, "score": 0, "creation_date": 1532620392, "post_id": 51537390, "comment_id": 90053590, "body": "Thank you very much adarti, Tom and everyone who participated rating my question. Your answer has helped me to understand how to refer to all the elements inside one array and to know a little better about the handling of string and numerical values within a same cell."}, {"owner": {"reputation": 19, "user_id": 10135574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/327c08de3e31a7d0dfbb62af1d5e89de?s=128&d=identicon&r=PG&f=1", "display_name": "JCarlo", "link": "https://stackoverflow.com/users/10135574/jcarlo"}, "edited": false, "score": 0, "creation_date": 1532622221, "post_id": 51537390, "comment_id": 90054707, "body": "I already did, but I have less than 15 reputation at the moment. - @adarti"}], "tags": [], "owner": {"reputation": 77, "user_id": 8389849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbf809b611c4d41507a3f9472003661c?s=128&d=identicon&r=PG&f=1", "display_name": "adarti", "link": "https://stackoverflow.com/users/8389849/adarti"}, "is_accepted": false, "score": 2, "last_activity_date": 1532617763, "last_edit_date": 1532617763, "creation_date": 1532603290, "answer_id": 51537390, "question_id": 51528592, "link": "https://stackoverflow.com/questions/51528592/check-if-the-string-abbreviation-and-copy-the-full-string-vba/51537390#51537390", "title": "Check if the string abbreviation and copy the full string. (Vba)", "body": "<p>Tray this code. (Comments inside)</p>\n\n<pre><code>   Sub Break_String()\n        Dim sarray() As String\n        Dim stemp As String\n        Dim ant_tipo, nvo_tipo\n        Dim rcell As Range\n        Dim icounter As Integer\n        'yuo must add also value for \"I.C.P\"\n        ant_tipo = Array(\"Corp\", \"BC\", \"C.D.N.\", \"CDN\", \"I.C.P\", \"I.C.P.\", \"ICP\", \"BS\", \"Subo\", \"BAF\", \"B.A.F.\", \"IRD\", \"BHIP\", \"BH\")\n        nvo_tipo = Array(\"Bonos Corporativos\", \"Bonos Corporativos\", \"Certificados de Deposito\", \"Certificados de Deposito\", \"Instrumentos de Corto Plazo\", \"Instrumentos de Corto Plazo\", \"Instrumentos de Corto Plazo\", \"Bonos Subordinados\", \"Bonos Subordinados\", \"Bonos de Arrendamiento Financiero\", \"Bonos de Arrendamiento Financiero\", \"Instrumentos Representativos de Deuda\", \"Bonos Hipotecarios\", \"Bonos Hipotecarios\")\n\n        'loop for all data cells\n        For c = 1 To Cells(1, 1).CurrentRegion.Rows.Count\n\n            Set rcell = Cells(c, 1)\n            stemp = rcell.Value\n\n            'replace , and - and y on space\n            'prevents any missing spaces between data\n            stemp = Replace(stemp, \",\", \" \")\n            stemp = Replace(stemp, \"-\", \" \")\n            stemp = Replace(stemp, \"y\", \" \")\n            icounter = 1 'used for select first empty cell in a row\n            'split using space\n            sarray() = Split(stemp)\n\n            For i = LBound(sarray) To UBound(sarray)\n            'Delete spaces\n                stemp = Trim(sarray(i))\n            'check if name\n                For j = LBound(ant_tipo) To UBound(ant_tipo)\n                    If InStr(stemp, ant_tipo(j)) Then\n                        rcell.Offset(0, icounter).Value = nvo_tipo(j)\n                        icounter = icounter + 1\n                        Exit For\n                    End If\n                Next j\n            'assign values for P and E\n            'check if the fisrt sign is a number to eliminate company names\n            If InStr(\"123456789\", Left(stemp, 1)) Then\n                If Right(stemp, 1) = \"P\" Or Right(stemp, 1) = \"E\" Then\n                    rcell.Offset(0, icounter).Value = Mid(stemp, 1, Len(stemp) - 1)\n                    icounter = icounter + 1\n                End If\n             End If\n            Next i\n        Next c\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 10135574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/327c08de3e31a7d0dfbb62af1d5e89de?s=128&d=identicon&r=PG&f=1", "display_name": "JCarlo", "link": "https://stackoverflow.com/users/10135574/jcarlo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1532617763, "creation_date": 1532558101, "last_edit_date": 1532584943, "question_id": 51528592, "link": "https://stackoverflow.com/questions/51528592/check-if-the-string-abbreviation-and-copy-the-full-string-vba", "title": "Check if the string abbreviation and copy the full string. (Vba)", "body": "<p>I am working on building data historical exclusions of corporate debt issues in the primary market.</p>\n\n<p>I need macro </p>\n\n<ol>\n<li><p>Read each cell and check if it contains an abbreviation of many\noptions and, according to the abbreviation, copy the full value in\nthe next empty cell of the same row.</p></li>\n<li><p>Copy Previous string value to \"P\" for the corresponding\nabbreviation found in bullet 1, in the next empy cell of the same row.</p></li>\n<li><p>Copy all Previous string value to \"E\" for the corresponding \"P\" found in \nbullet 2 and abbreviation found in bullet 1, in the next empy cell of the \nsame row.</p></li>\n</ol>\n\n<p>After this repeat for all the abbreviations found in the cell.</p>\n\n\n\n<pre><code>+---+--------------------------------------------------------------------+\n|                              what I have                               | \n+---+--------------------------------------------------------------------+\n|   |                                 A                                  |\n+---+--------------------------------------------------------------------+\n| 1 | B.Corp. - 2P. 5E,6E y 9E                                           |\n| 2 | B.Corp - 2P, 2E y 5E - C.D.N. 2P 4E                                |\n| 3 | B.Corp. 1P 6E,7E,9E,10E,11E,12E,13E,14E,15E,17E,19E,20E,21E,22E,23E|\n| 4 | I.C.P. 2P 5E 6E y 7E -  B.Corp. 3P 2E y 3E                         |\n| 5 | I.C.P.  4P 1E- I.C.P 3P 3E- B.Corp. 1P 1E 3E 4E y 6E               |\n+---+--------------------------------------------------------------------+\n</code></pre>\n\n\n\n<p>For the case of row number 5</p>\n\n<pre><code>+---+-----------------------------------------------------------------------------------------------------------+\n|                            what I need                                                                        |\n+---+--------------------------+---+---+--------------------------+---+---+-----------------+---+---+---+---+---+\n|   |             B            | C | D |            E             | F | G |H                | I | J | K | L | M |\n+---+--------------------------+---+---+--------------------------+---+---+-----------------+---+---+---+---+---+\n| 5 |Instrumento de Corto Plazo| 4 | 1 |Instrumento de Corto Plazo| 3 | 3 |Bono Corporativo | 1 | 1 | 3 | 4 | 6 |\n+---+--------------------------+---+---+--------------------------+---+---+-----------------+---+---+---+---+---+\n</code></pre>\n\n\n\n<p>I have dealt with the following codes, but they do not work at all:</p>\n\n<pre><code>Sub abv_to_full()\n\nIf InStr(1, Cells(a, 5), \"Corp\", 1) Or InStr(1, Cells(a, 5), \"BC\", 1) Then\nCells(a, 5).Offset(0, 1).Value = \"Bonos Corporativos\" 'English: corporate bonds\n\nElseIf InStr(1, Cells(a, 5), \"C.D.N.\", 1) Or InStr(1, Cells(a, 5), \"CDN\", 1) Then\nCells(a, 5).Offset(0, 1).Value = \"Certificados de Depositos\" 'English: certificates of deposits / term deposits\n\nElseIf InStr(1, Cells(a, 5), \"I.C.P\", 1) Or InStr(1, Cells(a, 5), \"ICP\", 1) Then\nCells(a, 5).Offset(0, 1).Value = \"Instrumentos de Corto Plazo\" 'English: short term instruments\n\nElseIf InStr(1, Cells(a, 5), \"BS\", 1) Or InStr(1, Cells(a, 5), \"Subo\", 1) Then\nCells(a, 5).Offset(0, 1).Value = \"Bonos Subordinados\" 'English: Subordinated Bonds\n\nElseIf InStr(1, Cells(a, 5), \"BAF\", 1) Or InStr(1, Cells(a, 5), \"B.A.F.\", 1) Then\nCells(a, 5).Offset(0, 1).Value = \"Bonos de Arrendamiento Financiero\" 'English: financial lease bonds\n\nElseIf InStr(1, Cells(a, 5), \"BH\", 1) Or InStr(1, Cells(a, 5), \"BHIP\", 1) Then\nCells(a, 5).Offset(0, 1).Value = \"Bonos Hipotecarios\" 'English: mortgage securities\n\nElseIf InStr(1, Cells(a, 5), \"IRD\", 1) Then\nCells(a, 5).Offset(0, 1).Value = \"Instrumentos Representativos de Deuda\" 'English: instruments representing debt\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n\n\n<pre><code>Sub second_try()\nDim start_, startp_ As Integer\nDim ant_tipo, nvo_tipo\n\nant_tipo = Array(\"Corp\", \"BC\", \"C.D.N.\", \"CDN\", \"I.C.P.\", \"ICP\", \"BS\", \"Subo\", \"BAF\", \"B.A.F.\", \"IRD\", \"BHIP\", \"BH\")\nnvo_tipo = Array(\"Bonos Corporativos\", \"Bonos Corporativos\", \"Certificados de Deposito\", \"Certificados de Deposito\", \"Instrumentos de Corto Plazo\", \"Instrumentos de Corto Plazo\", \"Bonos Subordinados\", \"Bonos Subordinados\", \"Bonos de Arrendamiento Financiero\", \"Bonos de Arrendamiento Financiero\", \"Instrumentos Representativos de Deuda\", \"Bonos Hipotecarios\", \"Bonos Hipotecarios\")\n\ncont = 0\nStart = 1\nDo\npos = InStr(Start, Cells(a, 5), ant_tipo(i), 0)\n    If pos &gt; 0 Then\n      Start = pos + 1  'alternatively: start = pos + Len(srch)\n      Cells(a, 5).Offset(0, 2 + cont).Value = nvo_tipo(i)\n      cont = cont + 1\n    End If\n    On Error Resume Next\nLoop While pos &gt; 0\nEnd sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 4, "creation_date": 1532557653, "post_id": 51528503, "comment_id": 90025560, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/45217519/change-font-in-a-textbox-object-to-small-caps-powerpoint-2013\">Change font in a textbox object to small caps - PowerPoint 2013</a>"}], "owner": {"reputation": 11, "user_id": 10135952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dc8179bae7eccdad5fc2da530a52952?s=128&d=identicon&r=PG&f=1", "display_name": "HavzaK", "link": "https://stackoverflow.com/users/10135952/havzak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 183, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1532593998, "creation_date": 1532557504, "last_edit_date": 1532593998, "question_id": 51528503, "link": "https://stackoverflow.com/questions/51528503/vba-for-using-font-format-small-caps-in-powerpoint-ms", "title": "VBA for using Font Format &quot;Small Caps&quot; in PowerPoint, MS", "body": "<p>I'm working on a presentation (Power Point) for my job and they decided to change the format of the Presentation Agenda and now the text it appears on it uses \"Small Caps\". We use a Macro in PP for creating the Agenda, but I've been searching a couple of hours and I haven't found anything about using the font effect \"Small Caps\" in VBA. I actually am starting to learn macros but they asked me this anyways, so I'd appreciate very much you're help. The most I could do was the following:</p>\n\n<pre><code>        titleBox.Text = titles(i)\n\n        With titleBox.Font\n            .Name = \"Arial\"\n            .Bold = True\n            .Size = 12\n        End With\n        titleBox.Characters(2, 100).Font.Size = 10\n        titleBox.ParagraphFormat.Alignment = ppAlignLeft\n</code></pre>\n\n<p>titles(i) is defined elsewhere and includes the names of the titles that will appear in the presentation agenda, all in uppercase. I'm trying to emulate \"Small Caps\" manually as I've tried \"Font.SmallCaps = True\" and it doesn't work (as it does in Word). The problem with what I'm doing is that when typing:</p>\n\n<p>titleBox.Characters(2, 100).Font.Size = 10</p>\n\n<p>I decrease the font size of all the letters after the first one, but I'd like to decrease the font size of all the letters after the first word of EVERY word in a sentence. </p>\n\n<p>This is what I referred as \"manually\", but if you know another way to implement \"Small Caps\" in Power Point that would be very helpful.</p>\n\n<p>I hope I explained myself. Thanks,</p>\n\n<p>HvZ</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 1, "creation_date": 1532557235, "post_id": 51528355, "comment_id": 90025468, "body": "You can use a simple condition If Left(post, 1) &lt;&gt; &quot;&#39;&quot; Then Debug.Print post"}], "answers": [{"comments": [{"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1532556759, "post_id": 51528388, "comment_id": 90025333, "body": "You are incredible. Accept it when time is right. Btw, what is <code>&quot;</code> connected to?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1532556882, "post_id": 51528388, "comment_id": 90025370, "body": "you want to know what the code is for that? &quot; is chr$(34)"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1532556772, "last_edit_date": 1532556772, "creation_date": 1532556595, "answer_id": 51528388, "question_id": 51528355, "link": "https://stackoverflow.com/questions/51528355/skip-values-from-a-list-wrapped-within-quotation-marks/51528388#51528388", "title": "Skip values from a list wrapped within quotation marks", "body": "<p>Use a test of the ascii value. 39 is <code>'</code>.</p>\n\n<pre><code>Option Explicit\n\nSub dosth()\n    Dim elements As Variant, post As Variant\n    elements = [{\"1\",\"'2'\",\"3\",\"'4'\"}]\n    For Each post In elements\n        If AscW(post) &lt;&gt; 39 Then Debug.Print post\n    Next post\nEnd Sub\n</code></pre>\n\n<p>Similar idea</p>\n\n<pre><code>Option Explicit\nSub dosth()\n    Dim elements As Variant, post As Variant\n    elements = [{\"1\",\"'2'\",\"3\",\"'4'\"}]\n    For Each post In elements\n        If Not Left$(post, 1) = Chr$(39) Then Debug.Print post\n    Next post\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "accepted_answer_id": 51528388, "answer_count": 1, "score": 0, "last_activity_date": 1532556772, "creation_date": 1532556383, "last_edit_date": 1532556599, "question_id": 51528355, "link": "https://stackoverflow.com/questions/51528355/skip-values-from-a-list-wrapped-within-quotation-marks", "title": "Skip values from a list wrapped within quotation marks", "body": "<p>I've written a macro to get the individual value from a list. My intention is to skip those values wrapped with quotation marks. How can I do so?</p>\n\n<p>I've written so far:</p>\n\n<pre><code>Sub dosth()\n    Dim post As Variant\n\n    For Each post In [{\"1\",\"'2'\",\"3\",\"'4'\"}]\n        Debug.Print post\n    Next post\nEnd Sub\n</code></pre>\n\n<p>Result it produces:</p>\n\n<pre><code>1\n'2'\n3\n'4'\n</code></pre>\n\n<p>What I wish to have:</p>\n\n<pre><code>1\n3\n</code></pre>\n\n<p>Can't find any idea to apply any conditional logic here. How can I achieve that?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 8673378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c38e4adf0db133f5d760bcf28063642d?s=128&d=identicon&r=PG&f=1", "display_name": "rzenva", "link": "https://stackoverflow.com/users/8673378/rzenva"}, "edited": false, "score": 0, "creation_date": 1532643116, "post_id": 51529011, "comment_id": 90064125, "body": "I can&#39;t and that one question to restore user defined filters doesnt work with me. It gets stuck, too much filters I guess."}], "tags": [], "owner": {"reputation": 1, "user_id": 10128437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38d8b9bb655cf4f95d91d2649fe91883?s=128&d=identicon&r=PG&f=1", "display_name": "tomghc", "link": "https://stackoverflow.com/users/10128437/tomghc"}, "is_accepted": false, "score": 0, "last_activity_date": 1532561252, "creation_date": 1532561252, "answer_id": 51529011, "question_id": 51528296, "link": "https://stackoverflow.com/questions/51528296/vba-insert-user-defined-amount-of-copies-of-a-row-selected-by-user/51529011#51529011", "title": "VBA: Insert user defined amount of copies of a row selected by user", "body": "<p>Have you tried doing something along the lines of:</p>\n\n<ol>\n<li>Turn off screen updates</li>\n<li>remove the filter</li>\n<li>add the rows</li>\n<li>re-enable the filter</li>\n</ol>\n\n<p>There is an answered question on how you can save filter criteria and reapply them later on: <a href=\"https://stackoverflow.com/questions/9489126/in-excel-vba-how-do-i-save-restore-a-user-defined-filter\">In Excel VBA, how do I save / restore a user-defined filter?</a></p>\n"}], "owner": {"reputation": 79, "user_id": 8673378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c38e4adf0db133f5d760bcf28063642d?s=128&d=identicon&r=PG&f=1", "display_name": "rzenva", "link": "https://stackoverflow.com/users/8673378/rzenva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1532561252, "creation_date": 1532555987, "question_id": 51528296, "link": "https://stackoverflow.com/questions/51528296/vba-insert-user-defined-amount-of-copies-of-a-row-selected-by-user", "title": "VBA: Insert user defined amount of copies of a row selected by user", "body": "<p>I have been dealing with a huge problem for a couple of weeks now and I cant fix it no matter what. Whatever I do, it works for a while until something new pop.</p>\n\n<p>Objective: in a specific column of a table, allow users to type down an integer and depending on that amount insert x rows in the table (all of them being exact copies of the original row)</p>\n\n<p>I have the code below I got from another site and modified it:</p>\n\n<p>I got a <code>WorksheetChange</code> event that triggers a macro in another module.</p>\n\n<p>The code below works only in non filtered tables, but once the user filters a table and the macro runs it doesnt work. The rows are inserted and are visible on whatever filter the user has, but the copy from the original row does not. I get no error, is just that the rows are inserted empty. </p>\n\n<p>How can I insert whatever amount of rows the user specified in a filtered table (without taking out the filters) and copy/paste everything form the original row?</p>\n\n<pre><code>Sub InsertRows(ByVal splitVal As Integer, ByVal keyCells As Range, ws As Worksheet)\n\n    On Error GoTo ErrorHandler\n    PW\n    ws.Unprotect Password\n    ws.DisplayPageBreaks = False\n\n    With keyCells\n        .Offset(1).Resize(splitVal).EntireRow.Insert\n        .EntireRow.Copy .Offset(1, 0).Resize(splitVal).EntireRow\n    End With\n\nExitHandler:\n    ws.Protect Password:=Password, DrawingObjects:=True, Contents:=True, Scenarios:=False _\n    , AllowSorting:=True, AllowFiltering:=True, AllowUsingPivotTables:=True, AllowFormattingRows:=True, AllowFormattingColumns:=True, AllowFormattingCells:=True\n    Exit Sub\n\nErrorHandler:\n    WBNorm\n    MsgBox \"Error \" &amp; Err.Number &amp; \" (\" &amp; Err.Description &amp; \") in procedure Insert_Rows, line \" &amp; Erl &amp; \".\"\n    GoTo ExitHandler\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1532554647, "post_id": 51528000, "comment_id": 90024639, "body": "Just set the ranges equal to eachother (note they have to be the same size I believe), like <code>Range([destination range]).Value = Range([copy from range]).Value</code>"}, {"owner": {"reputation": 292, "user_id": 7501821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb7044faa0544b9c43911120ff60600d?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Souza", "link": "https://stackoverflow.com/users/7501821/daniel-souza"}, "edited": false, "score": 0, "creation_date": 1532554864, "post_id": 51528000, "comment_id": 90024712, "body": "You shouldn&#39;t be using     destination. Use     PasteSpecial xlPasteValues instead"}, {"owner": {"reputation": 153, "user_id": 3496218, "user_type": "registered", "accept_rate": 54, "profile_image": "https://graph.facebook.com/100002485897367/picture?type=large", "display_name": "user3496218", "link": "https://stackoverflow.com/users/3496218/user3496218"}, "edited": false, "score": 0, "creation_date": 1532554971, "post_id": 51528000, "comment_id": 90024749, "body": "so would I just replace Destination with PasteSpecial xlPasteValues?  I have never used that and am a bit confused as to where to add it in the code"}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 3496218, "user_type": "registered", "accept_rate": 54, "profile_image": "https://graph.facebook.com/100002485897367/picture?type=large", "display_name": "user3496218", "link": "https://stackoverflow.com/users/3496218/user3496218"}, "edited": false, "score": 0, "creation_date": 1532554997, "post_id": 51528070, "comment_id": 90024755, "body": "thanks.  I am not familiar with that, would I just add it to the end of the code?"}], "tags": [], "owner": {"reputation": 21, "user_id": 2373381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cb0ff93830a7149eef138f0dcbf2e83?s=128&d=identicon&r=PG", "display_name": "hugotoledo_usa", "link": "https://stackoverflow.com/users/2373381/hugotoledo-usa"}, "is_accepted": false, "score": 1, "last_activity_date": 1532554786, "creation_date": 1532554786, "answer_id": 51528070, "question_id": 51528000, "link": "https://stackoverflow.com/questions/51528000/vba-paste-as-values-how-to/51528070#51528070", "title": "VBA paste as values - how to", "body": "<p>You want to use </p>\n\n<pre><code>.PasteSpecial xlPasteValues\n</code></pre>\n\n<p>A similar question was answered in detail here: <a href=\"https://stackoverflow.com/questions/23937262/excel-vba-copy-paste-values-only-xlpastevalues\">Excel VBA Copy Paste Values only( xlPasteValues )</a></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8324245, "user_type": "registered", "profile_image": "https://graph.facebook.com/1057375434398409/picture?type=large", "display_name": "Tina Lo", "link": "https://stackoverflow.com/users/8324245/tina-lo"}, "is_accepted": false, "score": 1, "last_activity_date": 1532555191, "creation_date": 1532555191, "answer_id": 51528144, "question_id": 51528000, "link": "https://stackoverflow.com/questions/51528000/vba-paste-as-values-how-to/51528144#51528144", "title": "VBA paste as values - how to", "body": "<p>Use Range Method \"Range.PasteSpecial xlPasteValue\"</p>\n\n<p>Example:</p>\n\n<pre><code>Sheets(\"Sheet1\").Columns(\"A\").Copy\nSheets(\"Sheet2\").Columns(\"B\").PasteSpecial xlPasteValues\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1532556684, "post_id": 51528368, "comment_id": 90025319, "body": "Indeed, this is the  more efficient approach."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 4, "last_activity_date": 1532556456, "creation_date": 1532556456, "answer_id": 51528368, "question_id": 51528000, "link": "https://stackoverflow.com/questions/51528000/vba-paste-as-values-how-to/51528368#51528368", "title": "VBA paste as values - how to", "body": "<p>Transfer the values directly bypassing the clipboard.</p>\n\n<pre><code>Private Sub PasteChartDataQtyCompare()\n    'This step pastes the range of values to the chart data tab\n    with workSheets(1).Range(\"A6:J22\")\n        workSheets(\"Chart Data\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).resize(.rows.count,.columns.count) = .value\n    end with\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 3496218, "user_type": "registered", "accept_rate": 54, "profile_image": "https://graph.facebook.com/100002485897367/picture?type=large", "display_name": "user3496218", "link": "https://stackoverflow.com/users/3496218/user3496218"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8837, "favorite_count": 0, "accepted_answer_id": 51528368, "answer_count": 3, "score": 0, "last_activity_date": 1532556456, "creation_date": 1532554451, "question_id": 51528000, "link": "https://stackoverflow.com/questions/51528000/vba-paste-as-values-how-to", "title": "VBA paste as values - how to", "body": "<p>I have some VBA code that copys a range from one sheet and then pastes it to another at the first blank line.  What it is copying are vlookup formulas so when it pastes it pastes all 0's, how would I go about getting it to paste what it copies as values so the results are retained?  </p>\n\n<p>Code:</p>\n\n<pre><code>Private Sub PasteChartDataQtyCompare()\n'This step pastes the range of values to the chart data tab\n    Sheets(1).Range(\"A6:J22\").Copy _\n    Destination:=Sheets(\"Chart Data\").Cells(Sheets(\"Chart Data\").Rows.Count, 1).End(xlUp).Offset(1, 0)\nEnd Sub\n</code></pre>\n\n<p></p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 1555, "user_id": 6313007, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/74799df08583d3fffcac5c333ee7bb06?s=128&d=identicon&r=PG&f=1", "display_name": "meow", "link": "https://stackoverflow.com/users/6313007/meow"}, "edited": false, "score": 0, "creation_date": 1532556919, "post_id": 51527944, "comment_id": 90025377, "body": "You can add images using the respective formatting! So that we don&#39;t have to click on your links."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 10136344, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Kmz0wjEmNY8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oF415L3-JE06FZDkirh2IVqT77eQ/mo/photo.jpg?sz=128", "display_name": "Lance Phillips", "link": "https://stackoverflow.com/users/10136344/lance-phillips"}, "is_accepted": false, "score": 3, "last_activity_date": 1532567053, "creation_date": 1532567053, "answer_id": 51529597, "question_id": 51527944, "link": "https://stackoverflow.com/questions/51527944/excel-userform-displays-at-the-wrong-size/51529597#51529597", "title": "Excel UserForm displays at the wrong size", "body": "<p>This is a new issue that is occurring in Excel. I have seen it my applications too. In Excel General Options, set to \"optimize for compatibility\" and the issue should go away.</p>\n"}, {"comments": [{"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 2, "creation_date": 1587146488, "post_id": 52224107, "comment_id": 108404326, "body": "NOTE: If you had worked on a project and saved it, you need to open each form and resize them. They will pop back to normal after resizing."}], "tags": [], "owner": {"reputation": 450, "user_id": 2981328, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/55b5a57989320394ee6a2acaf766c01f?s=128&d=identicon&r=PG&f=1", "display_name": "hymced", "link": "https://stackoverflow.com/users/2981328/hymced"}, "is_accepted": false, "score": 7, "last_activity_date": 1536329388, "last_edit_date": 1536329388, "creation_date": 1536328809, "answer_id": 52224107, "question_id": 51527944, "link": "https://stackoverflow.com/questions/51527944/excel-userform-displays-at-the-wrong-size/52224107#52224107", "title": "Excel UserForm displays at the wrong size", "body": "<p>I think your issue might be related to mine <a href=\"https://stackoverflow.com/questions/50742182/win-10-excel-2016-unexplained-pixelstopoints-coefficient-to-position-userform\">here</a>.</p>\n\n<p>@Lance Phillips: the option you are referring to (image below found on the web) is missing on my side with Excel 2016 32-bit Windows 10 64-bit. I have no idea why. Even with an extra monitor connected.</p>\n\n<p><a href=\"https://i.stack.imgur.com/UVZtZ.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/UVZtZ.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Edit: apparently this is a new feature from Office build 9330.1000, see <a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_excel-mso_win10-mso_o365b/excel-add-in-not-working-with-recent-excel-2016/1c718797-99ac-4318-b547-441037fb64ee\" rel=\"noreferrer\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9239858, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Jy7dUfWEPwM/AAAAAAAAAAI/AAAAAAAAAF4/Qg5fDGiqoig/photo.jpg?sz=128", "display_name": "Simon Wilson", "link": "https://stackoverflow.com/users/9239858/simon-wilson"}, "is_accepted": false, "score": 1, "last_activity_date": 1587293136, "creation_date": 1587293136, "answer_id": 61303049, "question_id": 51527944, "link": "https://stackoverflow.com/questions/51527944/excel-userform-displays-at-the-wrong-size/61303049#61303049", "title": "Excel UserForm displays at the wrong size", "body": "<p>Check your magnification settings in Windows (Ease of Access). It completely threw my forms sizes. Some were large, others small. Font sizes were as your examples. When a form was created, it inherited the Windows magnification. </p>\n"}], "owner": {"reputation": 91, "user_id": 10135567, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Zmp7wOGRZV8/AAAAAAAAAAI/AAAAAAAAAFM/XHsDI2yCXiQ/photo.jpg?sz=128", "display_name": "Chris McCulloch", "link": "https://stackoverflow.com/users/10135567/chris-mcculloch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12605, "favorite_count": 2, "answer_count": 3, "score": 8, "last_activity_date": 1597435016, "creation_date": 1532554191, "last_edit_date": 1536330077, "question_id": 51527944, "link": "https://stackoverflow.com/questions/51527944/excel-userform-displays-at-the-wrong-size", "title": "Excel UserForm displays at the wrong size", "body": "<p>I'm having a very strange issue with Excel UserForms; when I display a form by clicking a command button in my worksheet, the size of the form warps significantly, making it essentially unusable. The below images illustrate this.</p>\n\n<p>Form before size warping (intended size)\n<a href=\"https://i.stack.imgur.com/8BvRl.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/8BvRl.png\" alt=\"Form before size warping (intended size)\"></a></p>\n\n<p>Form after size warping\n<a href=\"https://i.stack.imgur.com/957zY.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/957zY.png\" alt=\"Form after size warping\"></a></p>\n\n<p>I work with a multiple screen setup, and this sizing issue only occurred at first when just using my laptop without the additional displays; however, it has now started occurring even with my usual setup. Furthermore, in some cases, the warping compounds with each subsequent form initialization. I've included example images of this below.</p>\n\n<p>Form before warping (intended size)\n<a href=\"https://i.stack.imgur.com/Cc1ti.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/Cc1ti.png\" alt=\"Form before warping (intended size)\"></a></p>\n\n<p>Form after warping (first iteration)\n<a href=\"https://i.stack.imgur.com/rZjzE.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/rZjzE.png\" alt=\"Form after warping (first iteration)\"></a></p>\n\n<p>Compounded warping (second iteration)\n<a href=\"https://i.stack.imgur.com/k5h7d.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/k5h7d.png\" alt=\"Compounded warping (second iteration)\"></a></p>\n\n<p>Further compounded warping (third iteration)\n<a href=\"https://i.stack.imgur.com/cUIWY.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/cUIWY.png\" alt=\"Further compounded warping (third iteration)\"></a></p>\n\n<p>I've tried setting the height and width properties manually, both through the properties window and through the Userform_Initialize() event, but still end up with strange results. In the properties window, the values I enter for height and width are automatically changed after I enter them, usually resulting in undesirable aspect ratios, and a similar thing happens when I try to resize with VBA. I don't think the code is the issue, as I'm simply setting the .Height and .Width properties so there isn't much room for error.</p>\n\n<p>I've done relatively extensive research and haven't been able to find any information about this issue. I'm using Excel 2016; any help would be appreciated!</p>\n"}, {"tags": ["vba", "excel", "project-explorer"], "comments": [{"owner": {"reputation": 3101, "user_id": 167478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f77f8328db85911cfbfba4662bb73?s=128&d=identicon&r=PG", "display_name": "Fink", "link": "https://stackoverflow.com/users/167478/fink"}, "edited": false, "score": 1, "creation_date": 1532555520, "post_id": 51527833, "comment_id": 90024938, "body": "You&#39;re not closing the workbooks after you open them, so they remain open, and visible in the VBE editor window.  Perhaps <code>wbSource.Close</code> after your copy line?"}, {"owner": {"reputation": 85, "user_id": 9931441, "user_type": "registered", "profile_image": "https://graph.facebook.com/1822858961104142/picture?type=large", "display_name": "Analia Quirk", "link": "https://stackoverflow.com/users/9931441/analia-quirk"}, "reply_to_user": {"reputation": 3101, "user_id": 167478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f77f8328db85911cfbfba4662bb73?s=128&d=identicon&r=PG", "display_name": "Fink", "link": "https://stackoverflow.com/users/167478/fink"}, "edited": false, "score": 0, "creation_date": 1532555735, "post_id": 51527833, "comment_id": 90025010, "body": "@Fink Yep that worked! I added &quot;Workbooks(CurrentFile).Close Savechanges:=False&quot; and it is working now! Thank you!"}], "owner": {"reputation": 85, "user_id": 9931441, "user_type": "registered", "profile_image": "https://graph.facebook.com/1822858961104142/picture?type=large", "display_name": "Analia Quirk", "link": "https://stackoverflow.com/users/9931441/analia-quirk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1532553690, "creation_date": 1532553690, "question_id": 51527833, "link": "https://stackoverflow.com/questions/51527833/preventing-workbooks-from-being-stored-in-vba-project-explorer", "title": "Preventing workbooks from being stored in VBA Project Explorer", "body": "<p>The code I have loops through a folder that has 100+ files (with more files being added daily) and copies files, data, etc. Every file that I loop through ends up in the VBA Project Explorer as you can see from the picture. This is really slowing down the run time of my code. <strong>Is there any way I can prevent each workbook from being added to the Project Explorer?</strong> Also, I haven't run my code with the optimize subroutines that I call to because I added those after running my original code (and now the editor is basically frozen). I attached my code as well as the picture of my issue below!</p>\n\n<p><a href=\"https://i.stack.imgur.com/Efy8M.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Efy8M.jpg\" alt=\"Overloaded VBA Project Explorer\"></a></p>\n\n<pre><code>Sub TransferSAPCLData_Click()\n\n'Code Optimization\nCall OptimizeCode_Begin\n\n'Declaring and Setting Variables\nDim fso As Scripting.FileSystemObject\nSet fso = New Scripting.FileSystemObject\n\nDim MyDir As String\nDim fil As Scripting.file\nDim FolderSource As Scripting.Folder\nDim FolderPathDest As String, wbDest As Workbook, wsDest As Worksheet\nDim wbSource As Workbook, wsSource As Worksheet\nDim lrDest As Long, fileDest As String, lrSource As Long\nDim CurrentFile As String\nDim fileSource As String\n\nMyDir = \"C:\\Users\\quirk\\Desktop\\Cory Project\\Wave 1A Content\\SAPCL Spreadsheets\\SAPCL Raw Data Files\"\n\n'Defining destination characteristics\nFolderPathDest = \"C:\\Users\\quirk\\Desktop\\Cory Project\\Wave 1A Content\\Master SAPCL Folder\"\nfileDest = \"C:\\Users\\quirk\\Desktop\\Cory Project\\Wave 1A Content\\Master SAPCL Folder\\Function Master File.xlsm\"\n'Workbooks.Open Filename:=fileDest\nSet wbDest = ActiveWorkbook ' Workbooks(\"MASTER.xlsx\")\nSet wsDest = wbDest.Worksheets(\"Sheet1\")\n\n\n'Looping through files\nSet FolderSource = fso.GetFolder(MyDir)\nFor Each fil In FolderSource.Files\n    Debug.Print fil.Name\n    CurrentFile = fil.Name\n    If Not fso.FileExists(FolderPathDest &amp; \"\\\" &amp; fil.Name) Then\n        fso.CopyFile _\n        Source:=MyDir &amp; \"\\\" &amp; fil.Name _\n        , Destination:=FolderPathDest &amp; \"\\\" &amp; fil.Name\n            fileSource = MyDir &amp; \"\\\" &amp; fil.Name\n            Workbooks.Open Filename:=fileSource '\n            ActiveWindow.Visible = False\n            Set wbSource = Workbooks(CurrentFile)\n            Set wsSource = wbSource.Worksheets(1)\n                lrSource = wsSource.Range(\"A\" &amp; wsSource.Rows.Count).End(xlUp).Row\n                lrDest = wsDest.Range(\"A\" &amp; wsDest.Rows.Count).End(xlUp).Row + 1\n                wsSource.Range(\"A2:V\" &amp; lrSource).Copy Destination:=wsDest.Range(\"A\" &amp; lrDest)\n    End If\nNext fil\n\n'Optimize Code\nCall OptimizeCode_End\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "if-statement"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1532550341, "post_id": 51527045, "comment_id": 90022799, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/3628057/how-to-find-out-if-an-entire-row-is-blank-in-excel-thorough-vba\">how to find out if an entire row is blank in excel through vba</a>"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1532550373, "post_id": 51527045, "comment_id": 90022819, "body": "So what is in the first row that you would check? It could be blank. It could have data. It could contain certain keywords that would indicate a header row. These are things that you know, which are not shared in your post. Take what you know and check those cells. Show us your <code>If</code> statement if it&#39;s not working."}, {"owner": {"reputation": 1, "user_id": 10135301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8f537e58f1616dd4dcb59bd73bb92c?s=128&d=identicon&r=PG&f=1", "display_name": "stroych", "link": "https://stackoverflow.com/users/10135301/stroych"}, "edited": false, "score": 0, "creation_date": 1532550849, "post_id": 51527045, "comment_id": 90023024, "body": "FirstRow = wb.Worksheets(1).Cells.Find(&quot;Opportunity Name&quot;).Row + 1  The FirstRow is based on the Cell containing &quot;Opportunity Name&quot;   The cell will either be blank or contain data. If the cell is blank I want to move on the the next file."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1532552447, "post_id": 51527045, "comment_id": 90023745, "body": "problem is you add 1, Find returns 0 if not found, so would your if not be if FirstRow &lt;&gt; 1 Then do your next five statements Else Do nothing, End if, let the workbook close, go to next file?"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1532553308, "post_id": 51527045, "comment_id": 90024135, "body": "your find should be throwing an error when not found, FirstRow will remain unchanged from the default of 0, since you are in a loop you better be sure to always set it to 0"}], "answers": [{"tags": [], "owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "is_accepted": false, "score": 0, "last_activity_date": 1532553254, "last_edit_date": 1532553254, "creation_date": 1532552654, "answer_id": 51527620, "question_id": 51527045, "link": "https://stackoverflow.com/questions/51527045/vba-if-statement-to-skip-file-if-first-row-is-blank/51527620#51527620", "title": "VBA If statement to skip file if first row is blank", "body": "<p>How does this work for you?</p>\n\n<pre><code>Dim Summary As Worksheet\nDim FolderPath As String\nDim SelectedFiles() As Variant\nDim nrow As Long\nDim FileName As String\nDim nfile As Long\nDim wb As Workbook\nDim SourceRange As Range\nDim DestRange As Range\nDim LastRow As Long\nDim FirstRow As Long\n\n'Set Summary as the current excel file in which the macro will run\nSet Summary = ActiveWorkbook.Sheets(1)\n\n'Modify this folder path to point to the folder that contains copies of the commission statements\nFolderPath = \"C:\\Users\\stroychak\\Dropbox (Apttus)\\Commission Folder\\000 Commission Statements\\z - All Commissions\\Commission Summary VBA - statements\"\n\n\n'Set the current directory and drive to the desired folder path\nChDrive FolderPath\nChDir FolderPath\n\n'Open the file dialogue box to select the commission statements to be compiled; allow for multiple statements to be selected at once\nSelectedFiles = Application.GetOpenFilename(MultiSelect:=True)\n\n'nrow keeps track of where to insert new rows in the destination workbook\nnrow = 1\n\nFor nfile = LBound(SelectedFiles) To UBound(SelectedFiles)\n    FirstRow = 0 'Set this, if you forget you will have mixed results\n    FileName = SelectedFiles(nfile)\n    Set wb = Workbooks.Open(FileName)\n    LastRow = wb.Worksheets(1).Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    On Error Resume Next 'If it fails FirstRow remains 0\n    FirstRow = wb.Worksheets(1).Cells.Find(\"Opportunity Name\").Row + 1\n\n    If FirstRow &lt;&gt; 0 Then\n        'Found it\n        Set SourceRange = wb.Worksheets(1).Range(\"A\" &amp; FirstRow &amp; \":AB\" &amp; LastRow)\n        Set DestRange = Sheet1.Range(\"A\" &amp; nrow)\n        Set DestRange = DestRange.Resize(SourceRange.Rows.Count, SourceRange.Columns.Count)\n\n        DestRange.Value = SourceRange.Value\n\n        nrow = DestRange.Rows.Count + nrow\n    Else 'Do Nothing, Didn't find it\n    End If\n\n    wb.Close savechanges = False\n\nNext nfile\n\n\nActiveSheet.Columns.AutoFit\n\nMsgBox \"Compilation is complete\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10135301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8f537e58f1616dd4dcb59bd73bb92c?s=128&d=identicon&r=PG&f=1", "display_name": "stroych", "link": "https://stackoverflow.com/users/10135301/stroych"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 296, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532553254, "creation_date": 1532549925, "last_edit_date": 1532550120, "question_id": 51527045, "link": "https://stackoverflow.com/questions/51527045/vba-if-statement-to-skip-file-if-first-row-is-blank", "title": "VBA If statement to skip file if first row is blank", "body": "<p>I have a code that compiles data from many company files into one large file. Some files will have blank values for the FirstRow so it pulls in the headers and blank cells. Instead, I would like to use an If statement to skip the file if the FirstRow is blank. Here is the code currently:</p>\n\n<pre><code>    Dim Summary As Worksheet\n    Dim FolderPath As String\n    Dim SelectedFiles() As Variant\n    Dim nrow As Long\n    Dim FileName As String\n    Dim nfile As Long\n    Dim wb As Workbook\n    Dim SourceRange As Range\n    Dim DestRange As Range\n    Dim LastRow As Long\n    Dim FirstRow As Long\n\n    'Set Summary as the current excel file in which the macro will run\n    Set Summary = ActiveWorkbook.Sheets(1)\n\n    'Modify this folder path to point to the folder that contains copies of the commission statements\n    FolderPath = \"C:\\Users\\stroychak\\Dropbox (Apttus)\\Commission Folder\\000 Commission Statements\\z - All Commissions\\Commission Summary VBA - statements\"\n\n\n    'Set the current directory and drive to the desired folder path\n    ChDrive FolderPath\n    ChDir FolderPath\n\n    'Open the file dialogue box to select the commission statements to be compiled; allow for multiple statements to be selected at once\n    SelectedFiles = Application.GetOpenFilename(MultiSelect:=True)\n\n    'nrow keeps track of where to insert new rows in the destination workbook\n    nrow = 1\n\n    For nfile = LBound(SelectedFiles) To UBound(SelectedFiles)\n        FileName = SelectedFiles(nfile)\n        Set wb = Workbooks.Open(FileName)\n        LastRow = wb.Worksheets(1).Cells(Rows.Count, \"A\").End(xlUp).Row\n        FirstRow = wb.Worksheets(1).Cells.Find(\"Opportunity Name\").Row + 1\n        Set SourceRange = wb.Worksheets(1).Range(\"A\" &amp; FirstRow &amp; \":AB\" &amp; LastRow)\n        Set DestRange = Sheet1.Range(\"A\" &amp; nrow)\n        Set DestRange = DestRange.Resize(SourceRange.Rows.Count, SourceRange.Columns.Count)\n\n        DestRange.Value = SourceRange.Value\n\n        nrow = DestRange.Rows.Count + nrow\n\n        wb.Close savechanges = False\n\n    Next nfile\n\n\n    ActiveSheet.Columns.AutoFit\n\nMsgBox \"Compilation is complete\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1532550366, "post_id": 51527029, "comment_id": 90022815, "body": "Why 3/9/2018, shouldn&#39;t it be 3/10/2018?"}, {"owner": {"reputation": 69, "user_id": 8038235, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/f53bbaea2edb8336bbc34f382e2546ec?s=128&d=identicon&r=PG&f=1", "display_name": "user8038235", "link": "https://stackoverflow.com/users/8038235/user8038235"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1532556875, "post_id": 51527029, "comment_id": 90025366, "body": "No, because I want the updated date to be the oldest date, so when I do a sort it sorts to the top."}, {"owner": {"reputation": 69, "user_id": 8038235, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/f53bbaea2edb8336bbc34f382e2546ec?s=128&d=identicon&r=PG&f=1", "display_name": "user8038235", "link": "https://stackoverflow.com/users/8038235/user8038235"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1532577692, "post_id": 51527029, "comment_id": 90029438, "body": "Not sure what happened to your code, it worked great, was able to deal with the Date - 1 day another way. Couldn&#39;t figure out the relationships, wanted to do the exact same thing but instead of updating the active records Date I want to update column L, Value,  with the maximum amount in the same range defined by col K again. Everything exactly the same except the column to update, which would be L instead of H. Could you tell me what the numbers changes would be in the code?  Col D = Status    Col H = Date     Col K =  Job  Col L= Value"}], "owner": {"reputation": 69, "user_id": 8038235, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/f53bbaea2edb8336bbc34f382e2546ec?s=128&d=identicon&r=PG&f=1", "display_name": "user8038235", "link": "https://stackoverflow.com/users/8038235/user8038235"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1532554845, "creation_date": 1532549852, "last_edit_date": 1532550260, "question_id": 51527029, "link": "https://stackoverflow.com/questions/51527029/filter-and-loop-through-a-list-of-records-for-min-date", "title": "Filter and Loop Through A List Of Records For Min Date", "body": "<p>Looking for help with some VBA.</p>\n\n<p>I have a worksheet with a list of records that has a: Status cell, Date cell and Job cell.</p>\n\n<p>When I change the Status cell to \"Filled\" in the active record I want to filter the list of records to only look at records in the list that have the same entry as in the Job cell of the active record,  say the letter \"a\". If there are older dates than in the active record Date cell of the filtered list, I would want to enter the older date (Date-1) in the active Date cell.</p>\n\n<p>Example</p>\n\n<pre><code>  Status        Date            Job\n1 Sent          3/10/2018       a\n2 Sent          5/10/2018       b\n3 Filled        4/10/2018       a\n4 Rejected      5/15/2018       c\n5 Interviewed   6/14/2018       b\n6 Sent          5/15/2018       a\n</code></pre>\n\n<p>Record 3 would get Date changed to 3/9/2018 form 4/10/2018 when the Status cell is changed to \"Filled\"</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1532549231, "post_id": 51526802, "comment_id": 90022312, "body": "Get your added pivot sheet the way you want it and then add copies of it as new sheets?"}], "owner": {"reputation": 11, "user_id": 10135541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea8d3c4258686a46b3fb4ec4f13c2f5a?s=128&d=identicon&r=PG&f=1", "display_name": "aatashian", "link": "https://stackoverflow.com/users/10135541/aatashian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1532548805, "creation_date": 1532548805, "question_id": 51526802, "link": "https://stackoverflow.com/questions/51526802/multiple-pivottables-from-same-data-source", "title": "Multiple PivotTables from same data source", "body": "<p>I'm trying to make multiple PivotTables from the same data source. I would like the PivotTables to be on separate worksheets. As of right now, I have a macro to create one PivotTable and format it how I'd like, but I'm having trouble figuring out how to make multiple. The only differences between the PivotTables will be which filters are selected.</p>\n\n<p>This is the code that I have to make one PivotTable. I know I'll have to take out the Worksheets.Delete line, but when I tried to do that and add more worksheets, I got errors, so I'll just provide the code that has worked for one. If anyone has suggestions on what changes to make in order to make multiple, that would be great. Thanks!</p>\n\n<pre><code>Sub PivotTable()\n\n'Declare Variables\nDim PSheet As Worksheet\nDim DSheet As Worksheet\nDim PCache As PivotCache\nDim PTable As PivotTable\nDim PRange As Range\nDim LastRow As Long\nDim LastCol As Long\n\n'Insert a New Blank Worksheet\nOn Error Resume Next\nApplication.DisplayAlerts = False\nWorksheets(\"PivotTable\").Delete\nSheets.Add Before:=ActiveSheet\nActiveSheet.Name = \"PivotTable\"\nApplication.DisplayAlerts = True\nSet PSheet = Worksheets(\"PivotTable\")\nSet DSheet = Worksheets(\"Data\")\n\n'Define Data Range\nLastRow = DSheet.Cells(Rows.Count, 1).End(xlUp).Row\nLastCol = DSheet.Cells(1, Columns.Count).End(xlToLeft).Column\nSet PRange = DSheet.Cells(1, 1).Resize(LastRow, LastCol)\n\n'Define Pivot Cache\nSet PCache = ActiveWorkbook.PivotCaches.Create _\n(SourceType:=xlDatabase, SourceData:=PRange). _\nCreatePivotTable(TableDestination:=PSheet.Cells(2, 2), _\nTableName:=\"ExpensePivot\")\n\n'Insert Blank Pivot Table\nSet PTable = PCache.CreatePivotTable _\n(TableDestination:=PSheet.Cells(1, 1), TableName:=\"ExpensePivot\")\n\n'Insert Filter Fields\nWith ActiveSheet.PivotTables(\"ExpensePivot\").PivotFields(\"month_number\")\n.Orientation = xlPageField\n.Position = 1\nEnd With\n\n'Insert Row Fields\nWith ActiveSheet.PivotTables(\"ExpensePivot\").PivotFields(\"charge_cc\")\n.Orientation = xlRowField\n.Position = 1\nEnd With\n\nWith ActiveSheet.PivotTables(\"ExpensePivot\").PivotFields(\"summary_point_18\")\n.Orientation = xlRowField\n.Position = 2\nEnd With\n\nWith ActiveSheet.PivotTables(\"ExpensePivot\").PivotFields(\"cost_element_description\")\n.Orientation = xlRowField\n.Position = 3\nEnd With\n\nWith ActiveSheet.PivotTables(\"ExpensePivot\").PivotFields(\"cost_element\")\n.Orientation = xlRowField\n.Position = 4\nEnd With\n\nWith ActiveSheet.PivotTables(\"ExpensePivot\").PivotFields(\"description\")\n.Orientation = xlRowField\n.Position = 5\nEnd With\n\nWith ActiveSheet.PivotTables(\"ExpensePivot\").PivotFields(\"vendor_name\")\n.Orientation = xlRowField\n.Position = 6\nEnd With\n\nWith ActiveSheet.PivotTables(\"ExpensePivot\").PivotFields(\"employee_name\")\n.Orientation = xlRowField\n.Position = 7\nEnd With\n\n'Insert Column Fields\n\n'Insert Data Field\nWith ActiveSheet.PivotTables(\"ExpensePivot\").PivotFields(\"Amount\")\n.Orientation = xlDataField\n.Position = 1\n.Function = xlSum\n.NumberFormat = \"#,##0\"\n.Name = \"Amount\" 'Changed Revenue to Amount\nEnd With\n\n'Remove Subtotals\n    ActiveSheet.PivotTables(\"ExpensePivot\").PivotFields(\"cost_element\"). _\n        Subtotals = Array(False, False, False, False, False, False, False, False, False, False, _\n        False, False)\n    ActiveSheet.PivotTables(\"ExpensePivot\").PivotFields(\"description\"). _\n        Subtotals = Array(False, False, False, False, False, False, False, False, False, False, _\n        False, False)\n    ActiveSheet.PivotTables(\"ExpensePivot\").PivotFields(\"vendor_name\"). _\n        Subtotals = Array(False, False, False, False, False, False, False, False, False, False, _\n        False, False)\n\n'Highlight subtotals\n    ActiveSheet.PivotTables(\"ExpensePivot\").PivotSelect _\n        \"cost_element_description[All;Total]\", xlDataAndLabel, True\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .ThemeColor = xlThemeColorAccent4\n        .TintAndShade = 0.799981688894314\n        .PatternTintAndShade = 0\n    End With\nActiveSheet.PivotTables(\"ExpensePivot\").PivotSelect _\n        \"summary_point_18[All;Total]\", xlDataAndLabel, True\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .ThemeColor = xlThemeColorDark1\n        .TintAndShade = -0.249977111117893\n        .PatternTintAndShade = 0\n    End With\nActiveSheet.PivotTables(\"ExpensePivot\").PivotSelect \"charge_cc[All;Total]\", _\n        xlDataAndLabel, True\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 65535\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n\n'Format Total Column with Commas\n    Columns(\"I:I\").Select\n    Selection.Style = \"Comma\"\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "web-scraping", "internet-explorer-11"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1532548859, "post_id": 51526683, "comment_id": 90022147, "body": "To be solved only with IE?"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1532549169, "post_id": 51526683, "comment_id": 90022291, "body": "Always a pleasure to find you in the loop @QHarr. Yes, only with <code>IE</code> because I&#39;ve already solved using <code>selenium</code>. Thanks."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1532807509, "post_id": 51526683, "comment_id": 90115209, "body": "It will not work this way I am afraid. The <code>circle</code> is of type <code>SVGCircleElement</code> which doesn&#39;t have any <code>click-event</code>. The click is handled in function <code>_mouseClick:function(b){...</code> and processed then. The parameter <code>b</code> is of type <code>[object PointerEvent]</code>. Maybe you could better try to look at the documentation <a href=\"https://developers.arcgis.com\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1532818346, "post_id": 51526683, "comment_id": 90117347, "body": "Check out <a href=\"https://stackoverflow.com/questions/51448664/cant-fetch-titles-from-some-box-like-containers\">this solution</a> I got using python in combination with selenium where click event worked just perfect. The language is different, though!"}, {"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1532852383, "post_id": 51526683, "comment_id": 90122293, "body": "@dee - Actually, Click does exist on IE&#39;s SVGCircleElement (because it derives ultimately from Element/IHTMLElement), but it does nothing. Topto, have you tested the selenium stuff with IE11?"}, {"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1533593981, "post_id": 51526683, "comment_id": 90393980, "body": "If you want help, answer the questions people ask"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1533626312, "post_id": 51526683, "comment_id": 90402452, "body": "Dreadfully sorry @Simon Mourier for my belated response. Nope, I didn&#39;t try IE within selenium. In fact I don&#39;t know how to use IE within selenium. I&#39;m accustomed to using chrome within selenium."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1534316997, "post_id": 51526683, "comment_id": 90661090, "body": "@Topto You simply change the driver to IEDriver rather than ChromeDriver.    Dim driver As New IEDriver. No biggie."}], "answers": [{"tags": [], "owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "is_accepted": false, "score": 12, "last_activity_date": 1533201438, "last_edit_date": 1533201438, "creation_date": 1532584902, "answer_id": 51531949, "question_id": 51526683, "link": "https://stackoverflow.com/questions/51526683/cant-click-on-some-dots-to-scrape-information/51531949#51531949", "title": "Can&#39;t click on some dots to scrape information", "body": "<p>No need to click on each dots. Json file has all the details and you can extract as per your requirement.</p>\n\n<hr>\n\n<p><strong>Installation of JsonConverter</strong></p>\n\n<ol>\n<li>Download the <a href=\"https://github.com/VBA-tools/VBA-JSON/releases\" rel=\"noreferrer\">latest release</a></li>\n<li>Import JsonConverter.bas into your project (Open VBA Editor, Alt + F11; File > Import File)\nAdd Dictionary reference/class</li>\n<li>For Windows-only, include a reference to \"Microsoft Scripting Runtime\"</li>\n<li>For Windows and Mac, include VBA-Dictionary</li>\n</ol>\n\n<hr>\n\n<p><strong>References to be added</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/yyuTo.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/yyuTo.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><strong>Download the sample file</strong> <a href=\"https://drive.google.com/file/d/11ge3siSQMYQhfbmbr5BvRIUmfIiysNRR/view?usp=sharing\" rel=\"noreferrer\">here</a>.</p>\n\n<hr>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Sub HitDotOnAMap()\n\n    Const Url As String = \"https://www.arcgis.com/sharing/rest/content/items/4712740e6d6747d18cffc6a5fa5988f8/data?f=json\"\n    Dim IE As New InternetExplorer, HTML As HTMLDocument\n    Dim post As Object, I&amp;\n    Dim data As String, colObj As Object\n\n    With IE\n        .Visible = True\n        .navigate Url\n        While .Busy = True Or .readyState &lt; 4: DoEvents: Wend\n        data = .document.body.innerHTML\n        data = Replace(Replace(data, \"&lt;pre&gt;\", \"\"), \"&lt;/pre&gt;\", \"\")\n    End With\n\n    Dim JSON As Object\n    Set JSON = JsonConverter.ParseJson(data)\n    Set colObj = JSON(\"operationalLayers\")(1)(\"featureCollection\")(\"layers\")(1)(\"featureSet\")\n\n    For Each Item In colObj(\"features\")\n\n\n         For j = 1 To Item(\"attributes\").Count - 1\n                Debug.Print Item(\"attributes\").Keys()(j), Item(\"attributes\").Items()(j)\n\n         Next\n    Next\nEnd Sub\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/iuMBz.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/iuMBz.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 520, "favorite_count": 5, "answer_count": 1, "score": 15, "last_activity_date": 1533505033, "creation_date": 1532548341, "last_edit_date": 1592644375, "question_id": 51526683, "link": "https://stackoverflow.com/questions/51526683/cant-click-on-some-dots-to-scrape-information", "title": "Can&#39;t click on some dots to scrape information", "body": "<p>I've written a script in vba in combination with IE to click on some dots available on a map in a web page. When a dot is clicked, a small box containing relevant information pops up.</p>\n<p><a href=\"https://www.arcgis.com/apps/Embed/index.html?webmap=4712740e6d6747d18cffc6a5fa5988f8&amp;extent=-141.1354,10.7295,-49.7292,57.6712&amp;zoom=true&amp;scale=true&amp;search=true&amp;searchextent=true&amp;details=true&amp;legend=true&amp;active_panel=details&amp;basemap_gallery=true&amp;disable_scroll=true&amp;theme=light\" rel=\"noreferrer\">Link to that website</a></p>\n<p>I would like to parse the content of each box. The content of that box can be found using class name <code>contentPane</code>. However, the main concern here is to generate each box by clicking on those dots. When a box shows up, it looks how you can see in the below image.</p>\n<p>This is the script I've tried so far:</p>\n<pre><code>Sub HitDotOnAMap()\n    Const Url As String = &quot;https://www.arcgis.com/apps/Embed/index.html?webmap=4712740e6d6747d18cffc6a5fa5988f8&amp;extent=-141.1354,10.7295,-49.7292,57.6712&amp;zoom=true&amp;scale=true&amp;search=true&amp;searchextent=true&amp;details=true&amp;legend=true&amp;active_panel=details&amp;basemap_gallery=true&amp;disable_scroll=true&amp;theme=light&quot;\n    Dim IE As New InternetExplorer, HTML As HTMLDocument\n    Dim post As Object, I&amp;\n    \n    With IE\n        .Visible = True\n        .navigate Url\n        While .Busy = True Or .readyState &lt; 4: DoEvents: Wend\n        Set HTML = .document\n    End With\n    \n    Application.Wait Now + TimeValue(&quot;00:0:07&quot;)  ''the following line zooms in the slider\n    HTML.querySelector(&quot;#mapDiv_zoom_slider .esriSimpleSliderIncrementButton&quot;).Click\n    Application.Wait Now + TimeValue(&quot;00:0:04&quot;)\n    \n    With HTML.querySelectorAll(&quot;[id^='NWQMC_VM_directory_'] circle&quot;)\n        For I = 0 To .Length - 1\n            .item(I).Focus\n            .item(I).Click\n            Application.Wait Now + TimeValue(&quot;00:0:03&quot;)\n            Set post = HTML.querySelector(&quot;.contentPane&quot;)\n            Debug.Print post.innerText\n            HTML.querySelector(&quot;[class$='close']&quot;).Click\n        Next I\n    End With\nEnd Sub\n</code></pre>\n<blockquote>\n<p>when I execute the above script, it looks like it is running smoothly but nothing happens (I meant, no clicking) and it doesn't throw any error either. Finally it quits the browser gracefully.</p>\n</blockquote>\n<p>This is how a box with information looks like when a dot gets clicked.</p>\n<p><a href=\"https://i.stack.imgur.com/A8QgM.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/A8QgM.jpg\" alt=\"enter image description here\" /></a></p>\n<blockquote>\n<p>Although I've used hardcoded delay within my script, they can be fixed later as soon as the macro starts working.</p>\n</blockquote>\n<p><em><strong>Question: How can I click each of the dots on that map and collect the relevant information from the popped-up box? I only expect to have any solution using <code>Internet Explorer</code></strong></em></p>\n<blockquote>\n<p>The data are not the main concern here. I would like to know how IE work in such cases so that I can deal with them in future cases. Any solution other than IE is not I'm looking for.</p>\n</blockquote>\n"}, {"tags": ["database", "vba", "ms-access", "ms-access-2007"], "comments": [{"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1532551516, "post_id": 51526592, "comment_id": 90023343, "body": "Are you set on doing it this way? Because that is definitely not the way I would go about it. I would just add a &quot;being processed&quot; yes/no field and serve the records one at a time, allowing any number of users to work concurrently. That has the added advantage that it you have users working faster or claims that need less time to process you don&#39;t end up with users with nothing to do while others are still working. Unless for some business reason you do want each of your users to handle equal number of claims. Even then just add a per user counter and stop serving claims when reached."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1532552717, "post_id": 51526592, "comment_id": 90023873, "body": "You could add a &quot;lockedForEdit&#39; boolean field in your import table. Change your query to <code>SELECT TOP 20 ... from tblImport WHERE isWorked=&#39;N&#39; and  lockedForEdit = 0</code>. Update all the records in the query so <code>lockedForEdit=True</code> before presenting in form for editing"}, {"owner": {"reputation": 47, "user_id": 10010784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/615ce996da891223914d89c2b18bc6bf?s=128&d=identicon&r=PG&f=1", "display_name": "Shinilrk", "link": "https://stackoverflow.com/users/10010784/shinilrk"}, "edited": false, "score": 0, "creation_date": 1532596347, "post_id": 51526592, "comment_id": 90037938, "body": "Hi, guys. In this way users able to work but problem is this code i have pasted in form load so once the event occurs the first claim will come to their form fields and in my tblimport it will update as is assigned as &quot;YES&quot; and usworked as &quot;N&quot; , so some times some tricky users they will close that application from taskmanager and they will reopen it then he won&#39;t get that claim again. But i want to assigan that same again to them."}, {"owner": {"reputation": 47, "user_id": 10010784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/615ce996da891223914d89c2b18bc6bf?s=128&d=identicon&r=PG&f=1", "display_name": "Shinilrk", "link": "https://stackoverflow.com/users/10010784/shinilrk"}, "edited": false, "score": 0, "creation_date": 1532596527, "post_id": 51526592, "comment_id": 90038039, "body": "I&#39;m thinking to create an alogoritham for this to update in that table itself to update their name itself. Like        No.of  Claims/no. Of assined users and it should update in that table. Anyone can help me on this ?"}], "answers": [{"tags": [], "owner": {"reputation": 685, "user_id": 6187845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc90c985e2d7b81ba79c02313aeeefd?s=128&d=identicon&r=PG&f=1", "display_name": "nagarajannd", "link": "https://stackoverflow.com/users/6187845/nagarajannd"}, "is_accepted": true, "score": 2, "last_activity_date": 1532694232, "creation_date": 1532694232, "answer_id": 51557900, "question_id": 51526592, "link": "https://stackoverflow.com/questions/51526592/assigning-data-to-the-users/51557900#51557900", "title": "Assigning Data to the users", "body": "<p>Here is a code sample i have used to allocate/assign inventory to the users. This will assign inventory by priory wise to users.</p>\n\n<pre><code>strqry = \"Select [ClaimID] from ClaimsTable\"\nstrqry2 = \"Select [UserName] from UsersTable\"\n\nrs1.Open strqry2, cn1, adOpenStatic\nrs2.Open strqry, cn2, adOpenStatic\n\nrs2.MoveFirst\nDo While Not rs2.EOF\n\n    If rs1.EOF = True Then rs1.MoveFirst\n\n    claim = CStr(rs2![ClaimID])\n    User = CStr(rs1![UserName])\n\n    'Insert this data to any table and pull inventory for the users.   \n    Debug.Print claim &amp; \"-\" &amp; User\n\n    rs2.MoveNext\n    rs1.MoveNext\nLoop\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 10010784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/615ce996da891223914d89c2b18bc6bf?s=128&d=identicon&r=PG&f=1", "display_name": "Shinilrk", "link": "https://stackoverflow.com/users/10010784/shinilrk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 51557900, "answer_count": 1, "score": 1, "last_activity_date": 1532694232, "creation_date": 1532547938, "question_id": 51526592, "link": "https://stackoverflow.com/questions/51526592/assigning-data-to-the-users", "title": "Assigning Data to the users", "body": "<p>I have one ms access 2007 database with frontend. users will access the front end and they will update some data. for making this process easy we have created one more frontend to upload the data to the database and those data will automatically come to the particular users front end.<br>\nhere My problem is, eg: I will upload 100 claim numbers to the data base there are 5 users to work on this claims.<br>\nhere I'm using the recordset to get the data from database and distributing to the users like FIFO. So until completing this users are not allowed to work on other process. so out 5 users normally 1 or 2 users will go for break until the remaining users completing the work. So  want to assign those 100 Claim to this 5 users equally.   </p>\n\n<pre><code>Private sub Form_Load() \nDim strqry as string  \nDim rs as ADODB.Recordset  \nstrQry=\"select xyz,abc,ffg from tblImport where isworked='N'\"  \nset rs = currentdb.openrecordset(strqry)\n\nif not (rs.EOF and rs.BOF) then  \nme.textbox0.value=Cstr(rs!xyz)  \nme.textbox1.value=Cstr(rs!abc)  \nend if\n\nEnd sub\n</code></pre>\n\n<p>do we have any option is there to assign it equally?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1532547750, "post_id": 51526494, "comment_id": 90021643, "body": "Put the other workbook in a variable and reference it. Dim wb As Workbook Set wb = Application.Workbooks.Open(path)      Dim wbOther As Workbook Set wbOther = ThisWorkbook"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1532548148, "post_id": 51526494, "comment_id": 90021801, "body": "<code>Worksheets</code> is implicitly saying <code>Application.Worksheets</code>, which is a roundabout way of saying <code>ActiveWorkbook.Worksheets</code>: if you want to access the <code>Worksheets</code> collection of another workbook, you need to qualify the member call with a <code>Workbook</code> object instance."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1532547790, "creation_date": 1532547790, "answer_id": 51526557, "question_id": 51526494, "link": "https://stackoverflow.com/questions/51526494/vba-excel-2010-how-do-you-add-data-to-an-external-workbook/51526557#51526557", "title": "VBA Excel-2010 How do you add data to an external workbook", "body": "<p>Something like </p>\n\n<pre><code>Workbooks(\"BookName\").Worksheets(\"SheetName\").Range(\"A1\").Value = \"Hello World\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 355, "user_id": 9841207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5da3d361f6c331926b8f161bb67d9c?s=128&d=identicon&r=PG&f=1", "display_name": "User", "link": "https://stackoverflow.com/users/9841207/user"}, "edited": false, "score": 0, "creation_date": 1532548905, "post_id": 51526595, "comment_id": 90022165, "body": "I got a subscript out of range usiing Private Sub test()     Dim wb As Workbook, path As String, wbOther As Workbook     path = &quot;pathToFile&quot;     Set wb = Application.Workbooks.Open(path)     Set wbOther = ThisWorkbook     wbOther.Worksheets(&quot;Sheet1&quot;).Range(&quot;A1&quot;) = &quot;test&quot; End Sub"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 355, "user_id": 9841207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5da3d361f6c331926b8f161bb67d9c?s=128&d=identicon&r=PG&f=1", "display_name": "User", "link": "https://stackoverflow.com/users/9841207/user"}, "edited": false, "score": 0, "creation_date": 1532549025, "post_id": 51526595, "comment_id": 90022219, "body": "You need to write the full path for  pathToFile and you need a sheet called sheet1."}, {"owner": {"reputation": 355, "user_id": 9841207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5da3d361f6c331926b8f161bb67d9c?s=128&d=identicon&r=PG&f=1", "display_name": "User", "link": "https://stackoverflow.com/users/9841207/user"}, "edited": false, "score": 0, "creation_date": 1532549562, "post_id": 51526595, "comment_id": 90022448, "body": "Okay it works, but I want to give this file to say 5 people and have them enter the data. Then I want to wright that data to an excel file. Is there any way i can use a connection and avoid actually opening the workbook?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 355, "user_id": 9841207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5da3d361f6c331926b8f161bb67d9c?s=128&d=identicon&r=PG&f=1", "display_name": "User", "link": "https://stackoverflow.com/users/9841207/user"}, "edited": false, "score": 0, "creation_date": 1532550679, "post_id": 51526595, "comment_id": 90022946, "body": "you have to open the workbook in order to write to it."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1532547954, "creation_date": 1532547954, "answer_id": 51526595, "question_id": 51526494, "link": "https://stackoverflow.com/questions/51526494/vba-excel-2010-how-do-you-add-data-to-an-external-workbook/51526595#51526595", "title": "VBA Excel-2010 How do you add data to an external workbook", "body": "<p>Use variables to hold you workbooks and reference those</p>\n\n<pre><code>Dim wb As Workbook , path As String, wbOther As Workbook \npath = \"workbookpath\"\nSet wb = Application.Workbooks.Open(path) \nSet wbOther = ThisWorkbook \n\nwbOther.Worksheets(\"Sheet1\").Range(\"A1\") = wb.Worksheets(\"Sheet1\").Range(\"A1\")\n</code></pre>\n"}], "owner": {"reputation": 355, "user_id": 9841207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5da3d361f6c331926b8f161bb67d9c?s=128&d=identicon&r=PG&f=1", "display_name": "User", "link": "https://stackoverflow.com/users/9841207/user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 1, "accepted_answer_id": 51526595, "answer_count": 2, "score": 0, "last_activity_date": 1532547954, "creation_date": 1532547545, "question_id": 51526494, "link": "https://stackoverflow.com/questions/51526494/vba-excel-2010-how-do-you-add-data-to-an-external-workbook", "title": "VBA Excel-2010 How do you add data to an external workbook", "body": "<p>I am looking into how best to insert data into an external workbook. I tried using AOD but I was wondering if there was a quick and easy way to just read and wright cells.</p>\n\n<p>Something like\nWorksheets(\"SheetName\").Range(\"A1\").Value = \"Hello World\"</p>\n\n<p>But to be able to do that on the external excel workbook file.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 588, "user_id": 7049751, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6b0e27ce4e8c20a20d34e793f4e4636?s=128&d=identicon&r=PG&f=1", "display_name": "Sphinx", "link": "https://stackoverflow.com/users/7049751/sphinx"}, "is_accepted": false, "score": 0, "last_activity_date": 1532588995, "creation_date": 1532588995, "answer_id": 51532952, "question_id": 51526414, "link": "https://stackoverflow.com/questions/51526414/excel-vba-additional-search-criteria-to-existing-search-function/51532952#51532952", "title": "Excel VBA - Additional search criteria to existing search function", "body": "<p>You could make 4 diferent loops for different comboboxes values.\nSomething like </p>\n\n<pre><code>If ComboBox1.ListIndex = -1 And ComboBox2.ListIndex = -1 Then 'both combos empty \n    For Each c In Rng.Cells\n        If (c.value &gt;= startDate And c.value &lt;= endDate) Or _\n        (c.Offset(0, 2).value &gt;= startDate And c.Offset(0, 2).value &lt;= endDate)\n      ...\nElseIf ComboBox1.ListIndex &lt;&gt; -1 And ComboBox2.ListIndex = -1 Then  'combo1 not empty \n    Your loop with additional criteria based on combobox1\n\nElseIf ComboBox1.ListIndex = -1 And ComboBox2.ListIndex &lt;&gt; -1 Then  'combo2 not empty \n    Your loop with additional criteria based on combobox2\n\nElseIf ComboBox1.ListIndex &lt;&gt; -1 And ComboBox2.ListIndex &lt;&gt; -1 Then  'both combos with value \n    Your loop with additional criteria based on combobox1 and combobox2 \n</code></pre>\n\n<p>To use <code>.ListIndex</code> you'll need to set ComboBox <code>Style</code> property to <code>2 - fmStyleDropDownList</code>\nbut this will allow to choose values only from the combobox list. </p>\n"}], "owner": {"reputation": 81, "user_id": 2514430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6bc915bac319d8657b4cf467a15e638?s=128&d=identicon&r=PG", "display_name": "sparkynerd", "link": "https://stackoverflow.com/users/2514430/sparkynerd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533661985, "creation_date": 1532547198, "last_edit_date": 1533661985, "question_id": 51526414, "link": "https://stackoverflow.com/questions/51526414/excel-vba-additional-search-criteria-to-existing-search-function", "title": "Excel VBA - Additional search criteria to existing search function", "body": "<p>I have an Excel UserForm where a user enters a start and end date, and also selects data from 2 comboboxes (ComboBox1 and ComboBox2). The following code searches for rows between those dates, and the rest of the code <em>(not shown for simplicity)</em> copies the row to a new sheet. </p>\n\n<pre><code>For Each c In rng.Cells\n    If (c.value &gt;= startDate And c.value &lt;= endDate) Or _\n(c.Offset(0, 2).value &gt;= startDate And c.Offset(0, 2).value &lt;= endDate)\n</code></pre>\n\n<p>I would like to add the ComboBox1.value and ComboBox2.value to the search criteria, and if either of those ComboBoxes are left blank, to ignore that part of the search filter. Any help would be appreciated!</p>\n\n<p>Update:</p>\n\n<p>I am super confused here, and I am still very new to VBA. I still can't seem to figure this out, and would appreciate any help here. Below is my code I tried to hack together, but I don't know if I'm even on the right track.</p>\n\n<pre><code>Dim rng As Range, destRow As Long\nDim shtSrc As Worksheet, shtDest As Worksheet\nDim c As Range '-- this is used to store the single cell in the For Each loop\nDim d As Range '-- this is used to store the single cell in the For Each loop\n\nSet shtSrc = Sheets(\"Projects\") ' Sets \"Projects\" sheet as source sheet\nSet shtDest = Sheets(\"Look Ahead\") 'Sets \"Look Ahead\" sheet as destination sheet\ndestRow = 5 'Start copying to this row on destination sheet\n\n' &gt;&gt; Set range to search for dates in Look Ahead period &lt;&lt;\nSet rng = Application.Intersect(shtSrc.Range(\"J:Q\"), shtSrc.UsedRange)\n\n' &gt;&gt; Look for matching dates in columns Q and S on Projects Sheet &lt;&lt;\n\nFor Each c In rng.Cells\n    If (c.value &gt;= startDate And c.value &lt;= endDate) Or _\n(c.Offset(0, 2).value &gt;= startDate And c.Offset(0, 2).value &lt;= endDate) Then ' Does date fall between start and end dates? If Yes, then copy to destination sheet\n\nEnd If\nNext\nFor Each d In rng.Cells\n    If (d.value = ComboBox2) Or _\n(d.Offset(0, 2).value = ComboBox2) Then\nshtSrc.Range(\"C\" &amp; c.Row).Copy shtDest.Range(\"B\" &amp; destRow)\nshtSrc.Range(\"G\" &amp; c.Row).Copy shtDest.Range(\"A\" &amp; destRow)      \nshtSrc.Range(\"J\" &amp; d.Row).Copy shtDest.Range(\"E\" &amp; destRow)     \nshtSrc.Range(\"Q\" &amp; c.Row).Copy shtDest.Range(\"C\" &amp; destRow)      \nshtSrc.Range(\"S\" &amp; c.Row).Copy shtDest.Range(\"D\" &amp; destRow) \ndestRow = destRow + 1\n\n' &gt; Ends search &lt;\n    End If\n\nNext\n</code></pre>\n"}, {"tags": ["arrays", "string", "vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1532614963, "post_id": 51526149, "comment_id": 90050018, "body": "Can&#39;t you check <code>rFromRange.Rows(nrRow).Hidden</code> in the <code>For</code> for the columns and <code>Exit For</code> if true?"}, {"owner": {"reputation": 1, "user_id": 10038564, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-R97-QcXweCM/AAAAAAAAAAI/AAAAAAAABxs/MxM5XIf6g1Y/photo.jpg?sz=128", "display_name": "Sebastian Soldner", "link": "https://stackoverflow.com/users/10038564/sebastian-soldner"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1532632860, "post_id": 51526149, "comment_id": 90059957, "body": "Doesn&#39;t this just kill the loop once it encounters a hidden row? If a row is hidden in the middle of the table, I would like the script to &quot;skip&quot; that hidden row and continue onto the next rows until done. For instance. If one of the ranges is 10 rows long and 10 columns wide, and row 6 is hidden and column 8 is hidden, I want the array seek to skip row 6 and column 8 and continue grabbing rows 7-10 and columns 9-10 and add them to the table built in word."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1532633393, "post_id": 51526149, "comment_id": 90060164, "body": "You don&#39;t show us <i>all</i> the code - the code that gets <code>rFromRange</code>. But my assumption is that this is a block of cells? So if you test a row index within that block for its Hidden property it will tell you that. Did you try it? I did check before I proposed the approach..."}, {"owner": {"reputation": 1, "user_id": 10038564, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-R97-QcXweCM/AAAAAAAAAAI/AAAAAAAABxs/MxM5XIf6g1Y/photo.jpg?sz=128", "display_name": "Sebastian Soldner", "link": "https://stackoverflow.com/users/10038564/sebastian-soldner"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1533035861, "post_id": 51526149, "comment_id": 90188903, "body": "The rest of the code is in the original post I linked. I used your code at first and it did skip a row, but it still left it blank (rather than delete it). What I had to do was make the code like this, where I also have a column exit and do not add a line break if a row is false.The updated decider is: If nrrow &lt; UBound(vdata, 1) And rFromRange.Rows(nrrow).Hidden = False Then sData = sData &amp; vbCr."}], "owner": {"reputation": 1, "user_id": 10038564, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-R97-QcXweCM/AAAAAAAAAAI/AAAAAAAABxs/MxM5XIf6g1Y/photo.jpg?sz=128", "display_name": "Sebastian Soldner", "link": "https://stackoverflow.com/users/10038564/sebastian-soldner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1532546112, "creation_date": 1532546112, "question_id": 51526149, "link": "https://stackoverflow.com/questions/51526149/how-to-skip-hidden-rows-or-columns-in-a-delimited-string-table-array", "title": "How to skip hidden rows or columns in a Delimited String Table Array", "body": "<p>I am trying to modify CuberChase's code on <a href=\"https://stackoverflow.com/questions/19916536/automated-word-template-creation-with-vba\">putting delimited string tables into a word document</a>. As far as I know, his code has the rFromRange value being static (IE, hiding rows or columns is not accounted for). </p>\n\n<p>I have tried changing the range to only be .SpecialCells(xlCellTypeVisible), but this ends up cutting the table short, rather than skipping the hidden rows/columns filtered out to still create the whole rest of the table. I have tried at length to figure out a solution by inserting vbCr and vbTab breaks on error, but I'm really not sure where to turn. Does anyone know how to set this array up to be able to skip columns or rows that end up being hidden on the original worksheet? Thank you for your time, please ask any additional questions for material that I have not covered here. </p>\n\n<pre><code>Function BuildDataString(rFromRange As Range) As String\nDim sData As String, nrRow As Long, nrCol As Integer, iTotalColumns As Integer\n\n'Convert the input range to a variable and determine the number of columns\nvData = rFromRange.Value\niTotalColumns = UBound(vData, 2)\n\n\n'Loop through all the elements in the array\nFor nrRow = LBound(vData, 1) To UBound(vData, 1)\n    For nrCol = 1 To iTotalColumns\n        'Depending on what type of data is encountered either add it to the string or substitute something\n        'You'll want to modify this as needed\n        If IsError(vData(nrRow, nrCol)) Then\n            sData = sData &amp; \"Error\"\n        ElseIf vData(nrRow, nrCol) = \"\" Or vData(nrRow, nrCol) = 0 Or vData(nrRow, nrCol) = \"-\" Then\n            sData = sData &amp; VBA.Chr$(150)\n        Else\n            sData = sData &amp; vData(nrRow, nrCol - iIncrement)\n        End If\n\n        'Use tab delimiters for Word to know where the columns are\n        If nrCol &lt; iTotalColumns Then sData = sData &amp; vbTab\n    Next nrCol\n\n    'Add a carriage return for each new line\n    If nrRow &lt; UBound(vData, 1) Then sData = sData &amp; vbCr\nNext nrRow\n\n'Return the completed string\nBuildDataString = sData\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "charts"], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1532546084, "creation_date": 1532546084, "answer_id": 51526141, "question_id": 51526088, "link": "https://stackoverflow.com/questions/51526088/selecting-chart-series-collection-in-vba/51526141#51526141", "title": "Selecting chart series collection in vba", "body": "<p>As follows:</p>\n\n<pre><code>Dim letter As String\nletter = \"D\"\n\nActiveSheet.ChartObjects(\"PyramidPlanned\").Activate\nActiveChart.PlotArea.Select\nApplication.CutCopyMode = False\nActiveChart.FullSeriesCollection(1).Name = \"='HC Planned'!$\" &amp; letter &amp; \"$2\"\nActiveChart.FullSeriesCollection(1).Values = \"='HC Planned'!$\" &amp; letter &amp; \"$461:$\" &amp; letter &amp; \"$469\"\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 9730852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/800830871f7a477816e2050e74b38ad4?s=128&d=identicon&r=PG&f=1", "display_name": "lucasnuensfe", "link": "https://stackoverflow.com/users/9730852/lucasnuensfe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 806, "favorite_count": 0, "accepted_answer_id": 51526141, "answer_count": 1, "score": 0, "last_activity_date": 1532546084, "creation_date": 1532545868, "question_id": 51526088, "link": "https://stackoverflow.com/questions/51526088/selecting-chart-series-collection-in-vba", "title": "Selecting chart series collection in vba", "body": "<p>I'm trying to get a referenced data to plot on my chart. For now, I got the code:</p>\n\n<pre><code>ActiveSheet.ChartObjects(\"PyramidPlanned\").Activate\nActiveChart.PlotArea.Select\nApplication.CutCopyMode = False\nApplication.CutCopyMode = False\nActiveChart.FullSeriesCollection(1).Name = \"='HC Planned'!$D$2\"\nActiveChart.FullSeriesCollection(1).Values = \"='HC Planned'!$D$461:$D$469\"\n</code></pre>\n\n<p>I wish I could use a variable where \"D\" is written. How could I do that?</p>\n\n<p>Txs</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1292, "user_id": 1887634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57d96d668a832a01e56fae26fc8859bc?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/1887634/alan"}, "edited": false, "score": 0, "creation_date": 1532546016, "post_id": 51526031, "comment_id": 90020937, "body": "It isn&#39;t exactly clear to me what you are asking, but you might want to take a look at the <code>VLOOKUP</code> formula, and perhaps <code>IF</code>, <code>MATCH</code> and <code>INDEX</code> formulas."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1532546203, "post_id": 51526031, "comment_id": 90021010, "body": "Copy a row with Target.Row"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10135275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fyn25.jpg?s=128&g=1", "display_name": "Cedrik L", "link": "https://stackoverflow.com/users/10135275/cedrik-l"}, "is_accepted": true, "score": 0, "last_activity_date": 1533120161, "creation_date": 1533120161, "answer_id": 51631306, "question_id": 51526031, "link": "https://stackoverflow.com/questions/51526031/vba-excel-copying-row-from-one-sheet-to-other-that-has-a-specific-value-in-it/51631306#51631306", "title": "VBA Excel Copying row from one sheet to other that has a specific value in it", "body": "<p>This works...\nSo I first look for the row where I want to look for data in another sheet.\nNext I look in the other sheet if there is data that corresponds with the word I used in the other sheet.\nI made a new row and added the data from the other sheet under the specified tabel.</p>\n\n<pre><code>Sub Copydata()\n\nLastrow = Sheets(\"Extract\").Cells(Rows.Count, 1).End(xlUp).Row\nLastrownew = Sheets(\"F-\").Cells(Rows.Count, 8).End(xlUp).Row\n\n'Geen screen refresh\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\nFor r = 25 To Lastrownew\n\n        If Sheets(\"F-\").Cells(r, 3) = \"Fase\" Then\n\n                For t = 2 To Lastrow\n                If Sheets(\"Extract\").Cells(t, 17) = \"10MO\" And Sheets(\"Extract\").Cells(t, 22) = \"FAX300HR\" Then\n\n                    Rows(r + 3 + a).Select\n                    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n                    Sheets(\"F-\").Rows(r + 2 + a).Value = Sheets(\"Extract\").Rows(t).Value\n                    a = a + 1\n\n                End If\n                Next t\n\n\n            ElseIf Sheets(\"F-\").Cells(r, 4) = \"ACF\" Then\n\n                For t = 2 To Lastrow\n                If Sheets(\"Extract\").Cells(t, 17) = \"10MO\" And Sheets(\"Extract\").Cells(t, 22) = \"FA02100\" Then\n\n                    Rows(r + 3 + b).Select\n                    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n                    Sheets(\"F-\").Rows(r + 2 + b).Value = Sheets(\"Extract\").Rows(t).Value\n                    b = b + 1\n\n                End If\n                Next t\n\n            ElseIf Sheets(\"F-\").Cells(r, 4) = \"Paint\" Then\n\n                For t = 2 To Lastrow\n                If Sheets(\"Extract\").Cells(t, 17) = \"10EA\" Then\n\n                    Rows(r + 3 + c).Select\n                    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n                    Sheets(\"F-\").Rows(r + 2 + c).Value = Sheets(\"Extract\").Rows(t).Value\n                    c = c + 1\n\n                End If\n                Next t\n            ElseIf Sheets(\"F-\").Cells(r, 4) = \"Engine out\" Then\n\n                For t = 2 To Lastrow\n                If Sheets(\"Extract\").Cells(t, 17) = \"10MO\" And Sheets(\"Extract\").Cells(t, 11) = \"ER\" Then\n\n                    Rows(r + 3 + d).Select\n                    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n                    Sheets(\"F-\").Rows(r + 2 + d).Value = Sheets(\"Extract\").Rows(t).Value\n                    d = d + 1\n\n                End If\n                Next t\n            ElseIf Sheets(\"F-\").Cells(r, 4) = \"Interface\" Then\n\n                For t = 2 To Lastrow\n                If Sheets(\"Extract\").Cells(t, 17) = \"10LW\" Then\n\n                    Rows(r + 3 + e).Select\n                    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n                    Sheets(\"F-\").Rows(r + 2 + e).Value = Sheets(\"Extract\").Rows(t).Value\n                    e = e + 1\n\n                End If\n                Next t\n            ElseIf Sheets(\"F-\").Cells(r, 4) = \"Pr\u00e9-dock\" Then\n\n                For t = 2 To Lastrow\n                If Sheets(\"Extract\").Cells(t, 17) = \"10\" Then\n\n                    Rows(r + 3 + f).Select\n                    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n                    Sheets(\"F-\").Rows(r + 2 + f).Value = Sheets(\"Extract\").Rows(t).Value\n                    f = f + 1\n\n                End If\n                Next t\n            ElseIf Sheets(\"F-\").Cells(r, 4) = \"Bew out\" Then\n\n                For t = 2 To Lastrow\n                If Sheets(\"Extract\").Cells(t, 17) = \"10WI\" Then\n\n                    Rows(r + 3 + g).Select\n                    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n                    Sheets(\"F-\").Rows(r + 2 + g).Value = Sheets(\"Extract\").Rows(t).Value\n                    g = g + 1\n\n                End If\n                Next t\n            ElseIf Sheets(\"F-\").Cells(r, 4) = \"E&amp;T out\" Then\n\n                For t = 2 To Lastrow\n                If Sheets(\"Extract\").Cells(t, 17) = \"10EJ\" Then\n\n                    Rows(r + 3 + h).Select\n                    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n                    Sheets(\"F-\").Rows(r + 2 + h).Value = Sheets(\"Extract\").Rows(t).Value\n                    h = h + 1\n\n                End If\n                Next t\n            ElseIf Sheets(\"F-\").Cells(r, 4) = \"Inspectie\" Then\n\n                For t = 2 To Lastrow\n                If Sheets(\"Extract\").Cells(t, 17) = \"10\" Then\n\n                    Rows(r + 3 + i).Select\n                    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n                    Sheets(\"F-\").Rows(r + 2 + i).Value = Sheets(\"Extract\").Rows(t).Value\n                    i = i + 1\n\n                End If\n                Next t\n            ElseIf Sheets(\"F-\").Cells(r, 5) = \"TCTO\" Then\n\n                For t = 2 To Lastrow\n                If Sheets(\"Extract\").Cells(t, 17) = \"10MO\" And Sheets(\"Extract\").Cells(t, 11) = \"SH\" Then\n\n                    Rows(r + 3 + j).Select\n                    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n                    Sheets(\"F-\").Rows(r + 2 + j).Value = Sheets(\"Extract\").Rows(t).Value\n                    j = j + 1\n\n                End If\n                Next t\n            ElseIf Sheets(\"F-\").Cells(r, 5) = \"NDI\" Then\n\n                For t = 2 To Lastrow\n                If Sheets(\"Extract\").Cells(t, 17) = \"10MN\" Then\n                    Rows(r + 3 + k).Select\n                    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n                    Sheets(\"F-\").Rows(r + 2 + k).Value = Sheets(\"Extract\").Rows(t).Value\n                    k = k + 1\n\n                End If\n                Next t\n        End If\n\n\n\n\n\nNext r\n'Screen refresh\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10135275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fyn25.jpg?s=128&g=1", "display_name": "Cedrik L", "link": "https://stackoverflow.com/users/10135275/cedrik-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 51631306, "answer_count": 1, "score": 0, "last_activity_date": 1533120161, "creation_date": 1532545607, "question_id": 51526031, "link": "https://stackoverflow.com/questions/51526031/vba-excel-copying-row-from-one-sheet-to-other-that-has-a-specific-value-in-it", "title": "VBA Excel Copying row from one sheet to other that has a specific value in it", "body": "<p>I have a sheet(Extract) with over 100 rows. I can split them up using a Case.</p>\n\n<pre><code>If Target.Column = 17 Then\nWith Target\n\n Select Case .Value\n   Case Is = \"100U\"           \n   Case Is = \"10A6\"           \n   Case Is = \"10BT\"           \n   Case Is = \"10EA\"           \n   Case Is = \"10EJ\"           \n   Case Is = \"10LL\"           \n   Case Is = \"10LW\"           \n   Case Is = \"10MI\"          \n   Case Is = \"10MN\"           \n   Case Is = \"10MO\"           \n   Case Is = \"10MV\"           \n   Case Is = \"10OC\"           \n   Case Is = \"10WI\"\n  Case Else\n\n End Select\n\nEnd With\n\nEnd If\n</code></pre>\n\n<p>The problem:\nThen I want to copy that row And put it in another sheet.</p>\n\n<p>I have premade tables where this data has to go.</p>\n\n<p>My idea was...</p>\n\n<pre><code>Case Is = \"100U\" \n      ' Go to other sheet\n      'Make extra row + put in data+ update position of row of the other tables that are under that table\nCase Is = \"10A6\" \n...\n</code></pre>\n\n<p>So yeah, i searched on youtube, but is wasnt what i was looking for...\nThank you in advance</p>\n"}, {"tags": ["vba", "excel", "case"], "answers": [{"tags": [], "owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1532547401, "creation_date": 1532547401, "answer_id": 51526453, "question_id": 51525472, "link": "https://stackoverflow.com/questions/51525472/delete-columns-with-all-empty-cells-and-header/51526453#51526453", "title": "Delete columns with all empty cells and header", "body": "<p>Assuming that row 1 is your header row...</p>\n\n<pre><code>Dim X As Long, LastRow As Long, LastCol As Long\n\nLastCol = Cells(1, Columns.Count).End(xlToLeft).Column\n\nApplication.ScreenUpdating = False\n\nFor X = LastCol To 1 Step -1\n    LastRow = Cells(Rows.Count, X).End(xlUp).Row\n    If LastRow = 1 And Not IsEmpty(Cells(1, X)) Then\n        Columns(X).Delete\n    End If\n\nNext\n\nApplication.ScreenUpdating = True\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 10128780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OLzZi.jpg?s=128&g=1", "display_name": "LittleZenGirl", "link": "https://stackoverflow.com/users/10128780/littlezengirl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1067, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532594054, "creation_date": 1532543187, "last_edit_date": 1532594054, "question_id": 51525472, "link": "https://stackoverflow.com/questions/51525472/delete-columns-with-all-empty-cells-and-header", "title": "Delete columns with all empty cells and header", "body": "<p>The code below deletes columns with all empty cells in the entire column. I need to alter it to delete columns with all empty cells in the entire column, only if there is a column header. I want the columns with no header and no cell data to remain.</p>\n\n<p>Thanks for any assistance!</p>\n\n<pre><code>Dim X As Long, LastRow As Long, LastCol As Long\n  LastRow = Cells.Find(\"*\", , xlValues, , xlRows, xlPrevious).Row\n  LastCol = Cells(1, Columns.count).End(xlToLeft).Column\n  Application.ScreenUpdating = False\n  For X = LastCol To 1 Step -1\n    If Cells(1, X).Value = Join(Application.Transpose(Cells(1, X).Resize(LastRow)), \"\") Then Columns(X).Delete\n  Next\n  Application.ScreenUpdating = True\n</code></pre>\n"}, {"tags": ["excel", "vba", "filepath"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1532540928, "post_id": 51524708, "comment_id": 90018610, "body": "<code>Dir(&quot;C:\\Folders\\Q-180575*&quot;)</code> (for example) should work, assuming there&#39;s not a folder named (eg) &quot;Q-1805759...&quot;"}, {"owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "edited": false, "score": 0, "creation_date": 1532541063, "post_id": 51524708, "comment_id": 90018676, "body": "Yes, there is a way.  Start with <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-value-property-excel\" rel=\"nofollow noreferrer\">Reading values from a Cell</a>, then look into <a href=\"https://www.excel-easy.com/vba/string-manipulation.html\" rel=\"nofollow noreferrer\">String Manipulation</a>, and checkout <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/workbook-saveas-method-excel\" rel=\"nofollow noreferrer\">SaveAs method</a>.  If you run into any errors come back and post them, with the code you&#39;ve tried.  We&#39;ll all be waiting, Good Luck  :)"}, {"owner": {"reputation": 51, "user_id": 10134914, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w4yIz3Pm_Yg/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p5GIUYf7WsHroQxTFlhqHt00Ge5A/mo/photo.jpg?sz=128", "display_name": "Dave Friesen", "link": "https://stackoverflow.com/users/10134914/dave-friesen"}, "edited": false, "score": 0, "creation_date": 1532542722, "post_id": 51524708, "comment_id": 90019489, "body": "Thanks for the responses. This is my attempt so far but it is not working.   Public Sub SaveWorkbook()  Dim custName As String Dim quoteNum As String Dim myFilename As String Dim myFilePath As String  custName = Range(&quot;B12&quot;) quoteNum = Range(&quot;B19&quot;) myFilePath = &quot;P:\\MyCompany\\custName\\quoteNum*\\2-Engineering\\2.3 - Material Take Off\\&quot; myFilename = quoteNum &amp; &quot;- &quot; &amp; custName  ActiveWorkbook.SaveAs filename:=myFilePath &amp; myFilename &amp; &quot;.xlsm&quot;, FileFormat:=xlNormal  End Sub"}, {"owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "edited": false, "score": 0, "creation_date": 1532543892, "post_id": 51524708, "comment_id": 90019990, "body": "Your Path <code>myFilePath = &quot;P:\\MyCompany\\custName\\quoteNum*\\2-Engineering\\2.3 - Material Take Off\\&quot;</code> has an Asterisk in it, and it&#39;s probably not too happy with that, but I tested it with C:\\Temp\\ and it worked fine."}, {"owner": {"reputation": 51, "user_id": 10134914, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w4yIz3Pm_Yg/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p5GIUYf7WsHroQxTFlhqHt00Ge5A/mo/photo.jpg?sz=128", "display_name": "Dave Friesen", "link": "https://stackoverflow.com/users/10134914/dave-friesen"}, "edited": false, "score": 0, "creation_date": 1532544084, "post_id": 51524708, "comment_id": 90020067, "body": "Tim Williams suggested above that adding the asterisk would match the folder with partial info. Should I not use the asterisk in that line?"}, {"owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "edited": false, "score": 0, "creation_date": 1532546215, "post_id": 51524708, "comment_id": 90021015, "body": "Asterisk won&#39;t work in the path the way you have it, the Dir function understands how to use it, so you&#39;d have to incorporate it. <code>myFilePath = Dir(&quot;P:\\MyCompany\\custName\\&quot; &amp; quoteNum &amp; &quot;*&quot;, vbDirectory)</code>"}, {"owner": {"reputation": 51, "user_id": 10134914, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w4yIz3Pm_Yg/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p5GIUYf7WsHroQxTFlhqHt00Ge5A/mo/photo.jpg?sz=128", "display_name": "Dave Friesen", "link": "https://stackoverflow.com/users/10134914/dave-friesen"}, "edited": false, "score": 0, "creation_date": 1532547359, "post_id": 51524708, "comment_id": 90021488, "body": "Ok I see what you mean. What you wrote for myFilePath doesn&#39;t quite work, but I tried the following: <code>myFilePath = Dir(&quot;P:\\MyCompany\\custName\\&quot; &amp; quoteNum &amp; &quot;*&quot; &amp; &quot;\\2-Engineering\\2.3 - Material Take Off\\&quot;, vbDirectory)</code>. Is this the right way to use Dir/vbDirectory? It&#39;s still not saving."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 10134914, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w4yIz3Pm_Yg/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p5GIUYf7WsHroQxTFlhqHt00Ge5A/mo/photo.jpg?sz=128", "display_name": "Dave Friesen", "link": "https://stackoverflow.com/users/10134914/dave-friesen"}, "edited": false, "score": 0, "creation_date": 1532553174, "post_id": 51526762, "comment_id": 90024084, "body": "Ok I tried implementing this but it doesn&#39;t seem to be holding any values for f. Looking at the Locals menu and stepping through, the value for f went from &quot;empty&quot; to &quot;&quot;. Any ideas?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 51, "user_id": 10134914, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w4yIz3Pm_Yg/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p5GIUYf7WsHroQxTFlhqHt00Ge5A/mo/photo.jpg?sz=128", "display_name": "Dave Friesen", "link": "https://stackoverflow.com/users/10134914/dave-friesen"}, "edited": false, "score": 0, "creation_date": 1532554753, "post_id": 51526762, "comment_id": 90024677, "body": "If <code>f</code> has no value following the call to <code>Dir()</code> then there was no folder which matched the value you provided.  Can you update your question with the exact code you tried?"}, {"owner": {"reputation": 51, "user_id": 10134914, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w4yIz3Pm_Yg/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p5GIUYf7WsHroQxTFlhqHt00Ge5A/mo/photo.jpg?sz=128", "display_name": "Dave Friesen", "link": "https://stackoverflow.com/users/10134914/dave-friesen"}, "edited": false, "score": 0, "creation_date": 1532554960, "post_id": 51526762, "comment_id": 90024745, "body": "Sure. The folder I want to save my file in has the path <code>P:\\MyCompany\\Syncrude\\Q-188888 - 32in Spool\\2-Engineering\\2.3-Material Take Off</code>. In B12 I have &quot;Syncrude&quot;, in B19 I have &quot;Q-188888&quot;. The code i have is as follows:"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 51, "user_id": 10134914, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w4yIz3Pm_Yg/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p5GIUYf7WsHroQxTFlhqHt00Ge5A/mo/photo.jpg?sz=128", "display_name": "Dave Friesen", "link": "https://stackoverflow.com/users/10134914/dave-friesen"}, "edited": false, "score": 0, "creation_date": 1532558210, "post_id": 51526762, "comment_id": 90025685, "body": "Under your question, click the &quot;Edit&quot; link, copy and paste your code from the VB editor into the bottom of your question, select it, and then use the &quot;{}&quot; button to format it as code."}, {"owner": {"reputation": 51, "user_id": 10134914, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w4yIz3Pm_Yg/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p5GIUYf7WsHroQxTFlhqHt00Ge5A/mo/photo.jpg?sz=128", "display_name": "Dave Friesen", "link": "https://stackoverflow.com/users/10134914/dave-friesen"}, "edited": false, "score": 0, "creation_date": 1532619056, "post_id": 51526762, "comment_id": 90052718, "body": "Hi Tim Williams, thanks for all the help with this but it is still not quite right. As I step through the code the variable f is still not storing a value, meaning no folder matched the value. I&#39;m not sure how that can be as the folder path I&#39;m testing with is <i>P:\\MyCompany\\Syncrude\\TEST Q-188888</i>. Any thoughts as to why f doesn&#39;t want to store a value?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 51, "user_id": 10134914, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w4yIz3Pm_Yg/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p5GIUYf7WsHroQxTFlhqHt00Ge5A/mo/photo.jpg?sz=128", "display_name": "Dave Friesen", "link": "https://stackoverflow.com/users/10134914/dave-friesen"}, "edited": false, "score": 0, "creation_date": 1532620981, "post_id": 51526762, "comment_id": 90053959, "body": "Aren&#39;t all your folders named something like &quot;Q-333335 other text here&quot; (i.e. the names all <b>start</b> with the Q number)?  What&#39;s with &quot;TEST Q-188888&quot; ?  If the Q number can be <i>anywhere</i> in the folder name then you&#39;d need something like <code>Dir(ROOT &amp; custName &amp; &quot;\\*&quot; &amp; qNum &amp; &quot;*&quot;, vbDirectory)</code> (note the extra wildcard asterisk before the Q number)"}, {"owner": {"reputation": 51, "user_id": 10134914, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w4yIz3Pm_Yg/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p5GIUYf7WsHroQxTFlhqHt00Ge5A/mo/photo.jpg?sz=128", "display_name": "Dave Friesen", "link": "https://stackoverflow.com/users/10134914/dave-friesen"}, "edited": false, "score": 0, "creation_date": 1532632693, "post_id": 51526762, "comment_id": 90059889, "body": "Ahh sorry I didn&#39;t realize the Q-number couldn&#39;t be anywhere in the file name. That fixed it. Thanks!"}, {"owner": {"reputation": 51, "user_id": 10134914, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w4yIz3Pm_Yg/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p5GIUYf7WsHroQxTFlhqHt00Ge5A/mo/photo.jpg?sz=128", "display_name": "Dave Friesen", "link": "https://stackoverflow.com/users/10134914/dave-friesen"}, "edited": false, "score": 0, "creation_date": 1532718190, "post_id": 51526762, "comment_id": 90095050, "body": "I&#39;ve adapted the code you gave me to do a few extra things that I wanted it to do, but now I am getting a 1004 error. Any idea why this may be happening?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 51, "user_id": 10134914, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w4yIz3Pm_Yg/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p5GIUYf7WsHroQxTFlhqHt00Ge5A/mo/photo.jpg?sz=128", "display_name": "Dave Friesen", "link": "https://stackoverflow.com/users/10134914/dave-friesen"}, "edited": false, "score": 0, "creation_date": 1532720779, "post_id": 51526762, "comment_id": 90096171, "body": "@DaveFriesen - at this point you should really start a new question: otherwise this whole page starts to make no sense to someone coming along later."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1532560441, "last_edit_date": 1532560441, "creation_date": 1532548644, "answer_id": 51526762, "question_id": 51524708, "link": "https://stackoverflow.com/questions/51524708/vba-saving-a-file-determine-file-path-based-partially-on-cell-values/51526762#51526762", "title": "VBA - Saving a file - Determine file path based partially on cell values", "body": "<p>To show the basic principle:</p>\n\n<p><strong>EDIT</strong>: a few changes to your code...</p>\n\n<pre><code>Sub Tester()\n\n    Dim qNum, fldr\n    Dim custName\n\n    custName = Range(\"B12\").Value\n    qNum = Range(\"B19\").Value\n\n    fldr = GetMatchingPath(qNum, custName) '&lt;&lt; find the matching folder\n    If Len(fldr) &gt; 0 Then\n\n        Debug.Print \"Found folder for customer=\" &amp; custName &amp; _\n                    \", Qnum=\" &amp; qNum &amp; vblf &amp; fldr\n        '...use this path\n\n    Else\n        MsgBox \"No matching folder!\", vbExclamation\n    End If\n\nEnd Sub\n\n'get the path for a given q number\nFunction GetMatchingPath(qNum, custName) As String\n    Const ROOT As String = \"P:\\Weir\\\" '&lt;&lt; adjust to suit\n    Dim f\n\n    f = Dir(ROOT &amp; custName &amp; \"\\\" &amp; qNum &amp; \"*\", vbDirectory)\n    GetMatchingPath = ROOT &amp; custName &amp; \"\\\" &amp; f\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 10134914, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w4yIz3Pm_Yg/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p5GIUYf7WsHroQxTFlhqHt00Ge5A/mo/photo.jpg?sz=128", "display_name": "Dave Friesen", "link": "https://stackoverflow.com/users/10134914/dave-friesen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1532718053, "creation_date": 1532540054, "last_edit_date": 1532718053, "question_id": 51524708, "link": "https://stackoverflow.com/questions/51524708/vba-saving-a-file-determine-file-path-based-partially-on-cell-values", "title": "VBA - Saving a file - Determine file path based partially on cell values", "body": "<p>Everything works as it should until I get to the ActiveWorkbook.SaveAs line, where I get a Run-time error 1004. </p>\n\n<p>`Sub Tester()</p>\n\n<pre><code>Dim qNum, fldr As String\nDim custName As String\nDim myFileName As String\nDim completePath As String\nDim division As String\n\ncustName = Range(\"B12\").Value\nqNum = Range(\"B19\").Value\n\nIf custName = \"CNUL - Albian\" Then\n    custName = \"CNRL\"\n    division = \"Albian\"\nEnd If\nIf custName = \"CNUL - Horizon\" Then\n    custName = \"CNRL\"\n    division = \"Horizon\"\nEnd If\nIf custName = \"CNRL - Albian\" Then\n    custName = \"CNRL\"\n    division = \"Albian\"\nEnd If\nIf custName = \"CNRL - Horizon\" Then\n    custName = \"CNRL\"\n    division = \"Horizon\"\nEnd If\n\nIf custName = \"CNRL\" Then\n    fldr = GetMatchingPathCNRL(qNum, custName, division) '&lt;&lt; find the        matching folder\n    If Len(fldr) &gt; 0 Then\n        Debug.Print \"Found folder for customer=\" &amp; custName &amp; _\n                        \", Qnum=\" &amp; qNum &amp; vbLf &amp; fldr\n            '...use this path\n\n    Else\n        MsgBox \"No matching folder!\", vbExclamation\n    End If\nElse\n    fldr = GetMatchingPath(qNum, custName) '&lt;&lt; find the matching folder\n    If Len(fldr) &gt; 0 Then\n        Debug.Print \"Found folder for customer=\" &amp; custName &amp; _\n                    \", Qnum=\" &amp; qNum &amp; vbLf &amp; fldr\n        '...use this path\n\n    Else\n        MsgBox \"No matching folder!\", vbExclamation\n    End If\nEnd If\n\n\nmyFileName = custName &amp; \" \" &amp; qNum &amp; \" \" &amp; \"MTO Rev A\"\ncompletePath = fldr &amp; \"\\\" &amp; myFileName\n\nActiveWorkbook.SaveAs Filename:=completePath\nEnd Sub\n\nFunction GetMatchingPath(qNum, custName) As String\nConst ROOT As String = \"P:\\MyCompany\\\" '&lt;&lt; adjust to suit\nDim f\nf = Dir(ROOT &amp; custName &amp; \"\\*\" &amp; qNum &amp; \"*\", vbDirectory)\nGetMatchingPath = ROOT &amp; custName &amp; \"\\\" &amp; f\nEnd Function\n\n\nFunction GetMatchingPathCNRL(qNum, custName, division) As String\nConst ROOT As String = \"P:\\MyCompany\\\" '&lt;&lt; adjust to suit\nDim f\nf = Dir(ROOT &amp; custName &amp; \"\\\" &amp; division &amp; \"\\*\" &amp; qNum &amp; \"*\", vbDirectory)\nGetMatchingPathCNRL = ROOT &amp; custName &amp; \"\\\" &amp; f\nEnd Function\n</code></pre>\n\n<p>`\nIt's finding the filepath way correctly and looks as if it should complete the save in the right location, but I'm always getting a 1004 error. Any ideas?</p>\n"}, {"tags": ["vba", "visual-studio", "excel"], "comments": [{"owner": {"reputation": 352, "user_id": 3092495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T4wqV.jpg?s=128&g=1", "display_name": "Rey Juna", "link": "https://stackoverflow.com/users/3092495/rey-juna"}, "edited": false, "score": 1, "creation_date": 1532540542, "post_id": 51524668, "comment_id": 90018397, "body": "Each time this is run, it will start with <code>Counter=55</code> and the increment, <code>Counter=Counter+1</code> will not carry over to the next execution."}, {"owner": {"reputation": 352, "user_id": 3092495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T4wqV.jpg?s=128&g=1", "display_name": "Rey Juna", "link": "https://stackoverflow.com/users/3092495/rey-juna"}, "edited": false, "score": 0, "creation_date": 1532541001, "post_id": 51524668, "comment_id": 90018648, "body": "You could create a helper cell to store your counter value and increment and update that cell&#39;s value before you exit.  If you use a named range for the cell, such as <code>MyCounter</code>, then <code>Counter=Range(&quot;MyCounter&quot;).Value</code> and <code>Set Range(&quot;MyCounter&quot;).Value=Counter+1</code>"}, {"owner": {"reputation": 47, "user_id": 9021464, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XJXBpw9K9eI/AAAAAAAAAAI/AAAAAAAAClI/bvSCbosuk6o/photo.jpg?sz=128", "display_name": "James Shelton", "link": "https://stackoverflow.com/users/9021464/james-shelton"}, "reply_to_user": {"reputation": 352, "user_id": 3092495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T4wqV.jpg?s=128&g=1", "display_name": "Rey Juna", "link": "https://stackoverflow.com/users/3092495/rey-juna"}, "edited": false, "score": 0, "creation_date": 1532541295, "post_id": 51524668, "comment_id": 90018802, "body": "Would I still use Counter inside the target?"}, {"owner": {"reputation": 47, "user_id": 9021464, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XJXBpw9K9eI/AAAAAAAAAAI/AAAAAAAAClI/bvSCbosuk6o/photo.jpg?sz=128", "display_name": "James Shelton", "link": "https://stackoverflow.com/users/9021464/james-shelton"}, "reply_to_user": {"reputation": 352, "user_id": 3092495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T4wqV.jpg?s=128&g=1", "display_name": "Rey Juna", "link": "https://stackoverflow.com/users/3092495/rey-juna"}, "edited": false, "score": 0, "creation_date": 1532541485, "post_id": 51524668, "comment_id": 90018896, "body": "Do you mind making an answer so I can vote for it and see it in full please"}, {"owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "edited": false, "score": 0, "creation_date": 1532541579, "post_id": 51524668, "comment_id": 90018949, "body": "If Counter were to be declared at a global level, and initialized at 55.  Then you could increment it within this sub."}, {"owner": {"reputation": 47, "user_id": 9021464, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XJXBpw9K9eI/AAAAAAAAAAI/AAAAAAAAClI/bvSCbosuk6o/photo.jpg?sz=128", "display_name": "James Shelton", "link": "https://stackoverflow.com/users/9021464/james-shelton"}, "edited": false, "score": 0, "creation_date": 1532541668, "post_id": 51524668, "comment_id": 90018988, "body": "when i try to put     Dim Counter As Integer Counter = 55 at global i get invalid outside procedure"}, {"owner": {"reputation": 47, "user_id": 9021464, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XJXBpw9K9eI/AAAAAAAAAAI/AAAAAAAAClI/bvSCbosuk6o/photo.jpg?sz=128", "display_name": "James Shelton", "link": "https://stackoverflow.com/users/9021464/james-shelton"}, "reply_to_user": {"reputation": 352, "user_id": 3092495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T4wqV.jpg?s=128&g=1", "display_name": "Rey Juna", "link": "https://stackoverflow.com/users/3092495/rey-juna"}, "edited": false, "score": 0, "creation_date": 1532542476, "post_id": 51524668, "comment_id": 90019373, "body": "@ReyJuna range of object worksheet failed"}, {"owner": {"reputation": 352, "user_id": 3092495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T4wqV.jpg?s=128&g=1", "display_name": "Rey Juna", "link": "https://stackoverflow.com/users/3092495/rey-juna"}, "edited": false, "score": 0, "creation_date": 1532559339, "post_id": 51524668, "comment_id": 90025960, "body": "I posted it as an answer.  Also, the range object problem was my using <code>Set Range(&quot;MyCounter&quot;).Value=</code> when it should have been <code>Range(&quot;MyCounter&quot;).Value=</code>.  I corrected that in my answer."}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 47, "user_id": 9021464, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XJXBpw9K9eI/AAAAAAAAAAI/AAAAAAAAClI/bvSCbosuk6o/photo.jpg?sz=128", "display_name": "James Shelton", "link": "https://stackoverflow.com/users/9021464/james-shelton"}, "edited": false, "score": 0, "creation_date": 1532541947, "post_id": 51525022, "comment_id": 90019124, "body": "@James <code>xlUp</code> - the letter <code>l</code>, not the number <code>1</code>"}, {"owner": {"reputation": 47, "user_id": 9021464, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XJXBpw9K9eI/AAAAAAAAAAI/AAAAAAAAClI/bvSCbosuk6o/photo.jpg?sz=128", "display_name": "James Shelton", "link": "https://stackoverflow.com/users/9021464/james-shelton"}, "edited": false, "score": 0, "creation_date": 1532542019, "post_id": 51525022, "comment_id": 90019152, "body": "Okay this still did not work. nothing happens. At least in my code a55 updated."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1532542488, "post_id": 51525022, "comment_id": 90019379, "body": "Check if you have other cells filled in below A55, maybe there are some way down."}, {"owner": {"reputation": 47, "user_id": 9021464, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XJXBpw9K9eI/AAAAAAAAAAI/AAAAAAAAClI/bvSCbosuk6o/photo.jpg?sz=128", "display_name": "James Shelton", "link": "https://stackoverflow.com/users/9021464/james-shelton"}, "edited": false, "score": 0, "creation_date": 1532542629, "post_id": 51525022, "comment_id": 90019450, "body": "That worked! How can I delete all on a button click clear for example, or delete all when it is loaded."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1532545390, "post_id": 51525022, "comment_id": 90020653, "body": "<code>Range(&quot;A55:A&quot; &amp; Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row).Clear</code> , although you will have to make sure there is something in A55 or it will clear cells above it. Maybe just use <code>range(&quot;A55:A1048576&quot;).clear</code> then there would never be a problem"}, {"owner": {"reputation": 47, "user_id": 9021464, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XJXBpw9K9eI/AAAAAAAAAAI/AAAAAAAAClI/bvSCbosuk6o/photo.jpg?sz=128", "display_name": "James Shelton", "link": "https://stackoverflow.com/users/9021464/james-shelton"}, "edited": false, "score": 0, "creation_date": 1532565017, "post_id": 51525022, "comment_id": 90027048, "body": "tried to do this Range(&quot;A55:A1048576&quot;).Clear Range(&quot;B55:B1048576&quot;).Clear Range(&quot;C55:C1048576&quot;).Clear Range(&quot;D55:D1048576&quot;).Clear Range(&quot;E55:E1048576&quot;).Clear Range(&quot;F55:F1048576&quot;).Clear"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1532567543, "post_id": 51525022, "comment_id": 90027481, "body": "Just for future proofing I would change <code>range(&quot;A55:A1048576&quot;).clear</code> to <code>range(&quot;A55:A&quot; &amp; rows.count).clear</code>"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 1, "last_activity_date": 1532541303, "creation_date": 1532541303, "answer_id": 51525022, "question_id": 51524668, "link": "https://stackoverflow.com/questions/51524668/visual-basic-increment-on-cell-update/51525022#51525022", "title": "visual basic increment on cell update", "body": "<p>Just count the rows in column A</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n    Dim target As Range, LstRw As Long\n\n    Set target = Range(\"U13\")\n    LstRw = Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n\n    If LstRw &lt; 55 Then LstRw = 55\n\n    If Not Intersect(target, Range(\"U13\")) Is Nothing Then\n        Cells(LstRw, \"A\").Value = target\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 9021464, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XJXBpw9K9eI/AAAAAAAAAAI/AAAAAAAAClI/bvSCbosuk6o/photo.jpg?sz=128", "display_name": "James Shelton", "link": "https://stackoverflow.com/users/9021464/james-shelton"}, "edited": false, "score": 0, "creation_date": 1532542087, "post_id": 51525171, "comment_id": 90019176, "body": "how will I run something, new to vb"}, {"owner": {"reputation": 47, "user_id": 9021464, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XJXBpw9K9eI/AAAAAAAAAAI/AAAAAAAAClI/bvSCbosuk6o/photo.jpg?sz=128", "display_name": "James Shelton", "link": "https://stackoverflow.com/users/9021464/james-shelton"}, "edited": false, "score": 0, "creation_date": 1532542247, "post_id": 51525171, "comment_id": 90019263, "body": "I am not sure how to get this working in context of my code."}], "tags": [], "owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "is_accepted": false, "score": 1, "last_activity_date": 1532551146, "last_edit_date": 1532551146, "creation_date": 1532541944, "answer_id": 51525171, "question_id": 51524668, "link": "https://stackoverflow.com/questions/51524668/visual-basic-increment-on-cell-update/51525171#51525171", "title": "visual basic increment on cell update", "body": "<p>Not sure when you want to run init(), you'll have to pick an event.  But each time you run Worksheet_Calculate() after that it will increment.</p>\n\n<pre><code>Public Counter As Integer\n\nSub Init()\n    Counter = 55\nEnd Sub\n\nPrivate Sub Worksheet_Calculate()\n    Dim target As Range\n    Set target = Range(\"U13\")\n\n    If Not Intersect(target, Range(\"U13\")) Is Nothing Then\n    Sheet1.Cells(Counter, \"A\").Value = target\n    End If\n    Counter = Counter + 1\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 352, "user_id": 3092495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T4wqV.jpg?s=128&g=1", "display_name": "Rey Juna", "link": "https://stackoverflow.com/users/3092495/rey-juna"}, "is_accepted": false, "score": 1, "last_activity_date": 1532619905, "last_edit_date": 1532619905, "creation_date": 1532559162, "answer_id": 51528737, "question_id": 51524668, "link": "https://stackoverflow.com/questions/51524668/visual-basic-increment-on-cell-update/51528737#51528737", "title": "visual basic increment on cell update", "body": "<p>Create a helper cell to store your counter value and increment and update that cell's value before you exit. </p>\n\n<p>If you use a named range for the cell, such as <code>MyCounter</code>, then modify your code to this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim Counter As Integer\n\nCounter = Range(\"MyCounter\").Value\n\nIf Not Intersect(Target, Range(\"U13\")) Is Nothing Then\n    Cells(Counter, 1).Value = Target\n    Range(\"MyCounter\").Value = Counter + 1\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I changed the event type to <code>Worksheet_Change</code>.  <code>Worksheet_Calculate</code> doesn't allow you to pass the Target as Range.  </p>\n\n<p>The approach you were using with <code>Set target = Range(\"U13\")</code> and then <code>Intersect(target, Range(\"U13\"))</code> means that <code>target</code> always equals <code>Range(\"U13\")</code> and therefore this will always execute when anything causes a calculate event, not just a change to cell U13.  Didn't sound like that was what you wanted.</p>\n\n<p>Also, the increment counter needs to be inside the <code>IF</code> statement or it will be incremented on every event, not just the ones you are checking for.</p>\n\n<p>Here is a screen shot</p>\n\n<p><a href=\"https://i.stack.imgur.com/eVhQp.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eVhQp.jpg\" alt=\"Increment on cell update using helper cell\"></a></p>\n\n<p>Note: This shows the results after 5 updates.</p>\n\n<p>Cell Y1 is named \"MyCounter\" and you would initialize it to 55.  Then each time you change the value of cell U13, it will put that value into the row that MyCounter is pointing to and then increment MyCounter.  </p>\n\n<p>I would recommend that you put your helper cell on another sheet instead of the way that I did it in the example, but if you do then update the code to include the sheet name in the range reference, such as <code>Counter = Sheets(\"HelperSheet\").Range(\"MyCounter\").Value</code>.  Hope that helps. </p>\n"}], "owner": {"reputation": 47, "user_id": 9021464, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XJXBpw9K9eI/AAAAAAAAAAI/AAAAAAAAClI/bvSCbosuk6o/photo.jpg?sz=128", "display_name": "James Shelton", "link": "https://stackoverflow.com/users/9021464/james-shelton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "accepted_answer_id": 51525022, "answer_count": 3, "score": 0, "last_activity_date": 1532619905, "creation_date": 1532539892, "question_id": 51524668, "link": "https://stackoverflow.com/questions/51524668/visual-basic-increment-on-cell-update", "title": "visual basic increment on cell update", "body": "<p>Currently trying to take each cell update and store in a cell that is basically A55 plus one row each update. So start with A55 then next update A56 then A57 so on forever on each update. Current code is stuck at cell 55 though:</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n    Dim target As Range\n    Set target = Range(\"U13\")\n    Dim Counter As Integer\nCounter = 55\n    If Not Intersect(target, Range(\"U13\")) Is Nothing Then\n   Cells(Counter, \"A\").value = target\n    End If\n      Counter = Counter + 1\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "userform"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 3487128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58acfe3fd0cb3891282e9a229586b42c?s=128&d=identicon&r=PG&f=1", "display_name": "user3487128", "link": "https://stackoverflow.com/users/3487128/user3487128"}, "edited": false, "score": 0, "creation_date": 1532542943, "post_id": 51525279, "comment_id": 90019579, "body": "Thanks for your reply. I  made a mistake when pasting the piece of code. I actually tried to call the sub, as &quot;GroupButton11_Click&quot; with no success. I updated this in the original question. Thanks!"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 35, "user_id": 3487128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58acfe3fd0cb3891282e9a229586b42c?s=128&d=identicon&r=PG&f=1", "display_name": "user3487128", "link": "https://stackoverflow.com/users/3487128/user3487128"}, "edited": false, "score": 0, "creation_date": 1532543959, "post_id": 51525279, "comment_id": 90020017, "body": "what error do you get? error number description etc"}, {"owner": {"reputation": 35, "user_id": 3487128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58acfe3fd0cb3891282e9a229586b42c?s=128&d=identicon&r=PG&f=1", "display_name": "user3487128", "link": "https://stackoverflow.com/users/3487128/user3487128"}, "edited": false, "score": 0, "creation_date": 1532544181, "post_id": 51525279, "comment_id": 90020111, "body": "I get Run-time error &#39;438&#39;: Object doesn&#39;t support this property or method. Thanks much"}, {"owner": {"reputation": 35, "user_id": 3487128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58acfe3fd0cb3891282e9a229586b42c?s=128&d=identicon&r=PG&f=1", "display_name": "user3487128", "link": "https://stackoverflow.com/users/3487128/user3487128"}, "edited": false, "score": 0, "creation_date": 1532544513, "post_id": 51525279, "comment_id": 90020268, "body": "I defined a toy sub just for testing as follows:                                                   Sub GroupButton11_Click()  MsgBox &quot;It&#39;s called!&quot;  End Sub (for each)"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 35, "user_id": 3487128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58acfe3fd0cb3891282e9a229586b42c?s=128&d=identicon&r=PG&f=1", "display_name": "user3487128", "link": "https://stackoverflow.com/users/3487128/user3487128"}, "edited": false, "score": 0, "creation_date": 1532549673, "post_id": 51525279, "comment_id": 90022496, "body": "I edited the answer, put a lota time, but fortunately it worked, please accept the answer and upvote it if you are happy :)"}, {"owner": {"reputation": 35, "user_id": 3487128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58acfe3fd0cb3891282e9a229586b42c?s=128&d=identicon&r=PG&f=1", "display_name": "user3487128", "link": "https://stackoverflow.com/users/3487128/user3487128"}, "edited": false, "score": 0, "creation_date": 1532550775, "post_id": 51525279, "comment_id": 90022994, "body": "It worked! Thank you. Just one thing. All three buttons are calling the same sub. How would you modify this to have one each?"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 35, "user_id": 3487128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58acfe3fd0cb3891282e9a229586b42c?s=128&d=identicon&r=PG&f=1", "display_name": "user3487128", "link": "https://stackoverflow.com/users/3487128/user3487128"}, "edited": false, "score": 0, "creation_date": 1532552666, "post_id": 51525279, "comment_id": 90023848, "body": "for each action you need to write the same thing in class module, if you have 10 different buttons with 10 different actions you need to write the same code with different names 10 times. if your actions are similar you can parametrize it with arguments that you will pass to the class module macros."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 35, "user_id": 3487128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58acfe3fd0cb3891282e9a229586b42c?s=128&d=identicon&r=PG&f=1", "display_name": "user3487128", "link": "https://stackoverflow.com/users/3487128/user3487128"}, "edited": false, "score": 0, "creation_date": 1532552836, "post_id": 51525279, "comment_id": 90023927, "body": "or you can pass some parameters to the class macro and then decide what kind of actions it should perform (instead of message box), you can use <code>IF ELSEIF</code> or <code>SELECT CASE</code> functions to make it functional and clean"}], "tags": [], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "is_accepted": true, "score": 1, "last_activity_date": 1532549599, "last_edit_date": 1532549599, "creation_date": 1532542365, "answer_id": 51525279, "question_id": 51524388, "link": "https://stackoverflow.com/questions/51524388/assign-sub-to-dynamically-defined-commandbutton/51525279#51525279", "title": "Assign Sub to dynamically defined CommandButton", "body": "<p>Command button does not have <code>OnClick</code> property and that is why it is not working. The way that controls are built manually with the designer is different from how they can be built dynamically.</p>\n\n<p>This problem was really annoying, but happily I eventually solved it, however I would not go this route since it is hard to control the situation and the code is more complex. If you use the worksheet as the basis for your control buttons it is a lot easier to create and assign macros to them, you need to simply use  <code>.OnAction</code> property in that case.</p>\n\n<p>so follow these instruction CAREFULLY:</p>\n\n<p>1- create a userform where the buttons and other controls will be built dynamically. In my example its name is <code>UserForm1</code>. right click on it, choose <code>view code</code> and paste this code exactly.</p>\n\n<pre><code>Option Explicit\nDim btnArray() As New Class1\n\nSub CreateButton()\n    Dim i As Long\n    Dim cmdBtn As MSForms.CommandButton\n\n\n    i = 1\n\n    For i = 1 To 3\n        Set cmdBtn = Me.Controls.Add(\"Forms.CommandButton.1\", \"MyButton\" &amp; i)\n        With cmdBtn\n            .Name = \"GroupButton1\" &amp; i\n            .Top = 40 * (i - 1) + 10\n            .Left = 100\n            .Width = 50 'I changed it\n            .Height = 25 'I changed it\n            .Caption = \"&gt;&gt;\"\n            .Font.Size = 8\n            ReDim Preserve btnArray(1 To i)\n            Set btnArray(i).btnEvents = cmdBtn\n        End With\n    Next\n\n\nEnd Sub\n\n\nPrivate Sub UserForm_Initialize()\n    Call Me.CreateButton\nEnd Sub\n</code></pre>\n\n<p>2- Create a <code>Class Module</code> (class module and not regular module), by default its name should be <code>Class1</code>. You can change it, but I did not. Paste the following code in that module:</p>\n\n<pre><code>Public WithEvents btnEvents As MSForms.CommandButton\n\nPrivate Sub btnEvents_click()\n    MsgBox \"It worked\"\nEnd Sub\n</code></pre>\n\n<p>3- Now you can call <code>UserForm1</code> different ways. I prefer to explicitly call them from a regular module so create a regular module, its name does not matter, but by default it will be <code>Module1</code>, paste this code there and when you run it, everything should work perfectly:</p>\n\n<pre><code>Sub main()\n    UserForm1.Show\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 3487128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58acfe3fd0cb3891282e9a229586b42c?s=128&d=identicon&r=PG&f=1", "display_name": "user3487128", "link": "https://stackoverflow.com/users/3487128/user3487128"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 583, "favorite_count": 0, "accepted_answer_id": 51525279, "answer_count": 1, "score": 0, "last_activity_date": 1532594147, "creation_date": 1532538750, "last_edit_date": 1532594147, "question_id": 51524388, "link": "https://stackoverflow.com/questions/51524388/assign-sub-to-dynamically-defined-commandbutton", "title": "Assign Sub to dynamically defined CommandButton", "body": "<p>I am trying to define a userform that creates a number of listboxes depending on the user. Within the procedure I define commandbuttons supposed to allow the user to take items from one listbox to another.\nThe commandbuttons are defined as follows (within a loop - see i below):</p>\n\n<pre><code>With .Designer.Controls.Add(\"Forms.CommandButton.1\", Name:=\"GroupButton1\" &amp; i)\n    .Top = 40 * (i - 1) + 10\n    .Left = 100\n    .Width = 20\n    .Height = 10\n    .BackColor = RGB(220, 105, 0)\n    .Caption = \"&gt;&gt;\"\n    .Font.Size = 8\n    .OnClick = \"GroupButton1\" &amp; i &amp; \"_Click\"\nEnd With\n</code></pre>\n\n<p>I tried to use .OnClick and .OnAction to assign the corresponding _Click sub with no success. Any guidance would be much appreciated.</p>\n"}, {"tags": ["sql", "vba", "excel-2010", "ado"], "comments": [{"owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1532541826, "post_id": 51524306, "comment_id": 90019057, "body": "<code>Set mrs = CreateObject(&quot;ADODB.Recordset&quot;)</code>  Why do this?  Why not just <code>Set mrs = New ADODB.RecordSet</code> to instantiate it?  When you step through your code, where is it failing?  I don&#39;t think the problem is in your VBA.  You might find it has to do with forms and form controls.  That&#39;s, at least, where I&#39;ve run into errors like this."}, {"owner": {"reputation": 355, "user_id": 9841207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5da3d361f6c331926b8f161bb67d9c?s=128&d=identicon&r=PG&f=1", "display_name": "User", "link": "https://stackoverflow.com/users/9841207/user"}, "reply_to_user": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1532542129, "post_id": 51524306, "comment_id": 90019212, "body": "The error occurs at  mrs.Open SQL, dataConection"}, {"owner": {"reputation": 355, "user_id": 9841207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5da3d361f6c331926b8f161bb67d9c?s=128&d=identicon&r=PG&f=1", "display_name": "User", "link": "https://stackoverflow.com/users/9841207/user"}, "reply_to_user": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1532542169, "post_id": 51524306, "comment_id": 90019230, "body": "This works for queries like select but not for insert which I thought was weird. Also I just declared createObject because the examples I saw online used that."}, {"owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1532542366, "post_id": 51524306, "comment_id": 90019321, "body": "I can honestly say I haven\u2019t ever used VBA to read or write to an excel file using ADODB.   Not sure where I could see a good use for that.  That being said, check permissions."}, {"owner": {"reputation": 355, "user_id": 9841207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5da3d361f6c331926b8f161bb67d9c?s=128&d=identicon&r=PG&f=1", "display_name": "User", "link": "https://stackoverflow.com/users/9841207/user"}, "reply_to_user": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1532542451, "post_id": 51524306, "comment_id": 90019361, "body": "I am making a tool for my client to enter data into a external workbook. I want to use sql against the work book so I don&#39;t have to code all the sql by hand"}, {"owner": {"reputation": 355, "user_id": 9841207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5da3d361f6c331926b8f161bb67d9c?s=128&d=identicon&r=PG&f=1", "display_name": "User", "link": "https://stackoverflow.com/users/9841207/user"}, "reply_to_user": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1532543099, "post_id": 51524306, "comment_id": 90019647, "body": "@Jaberwocky Any ideas? i&#39;m pretty stuck..."}, {"owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1532544373, "post_id": 51524306, "comment_id": 90020201, "body": "I have to encourage you to check permissions at the source.  You may not be able to write externally."}, {"owner": {"reputation": 355, "user_id": 9841207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5da3d361f6c331926b8f161bb67d9c?s=128&d=identicon&r=PG&f=1", "display_name": "User", "link": "https://stackoverflow.com/users/9841207/user"}, "reply_to_user": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1532550280, "post_id": 51524306, "comment_id": 90022774, "body": "I have the same issue when I run this against an internal worksheet though?"}, {"owner": {"reputation": 355, "user_id": 9841207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5da3d361f6c331926b8f161bb67d9c?s=128&d=identicon&r=PG&f=1", "display_name": "User", "link": "https://stackoverflow.com/users/9841207/user"}, "reply_to_user": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1532550692, "post_id": 51524306, "comment_id": 90022953, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/176749/discussion-between-user-and-jaberwocky\">continue this discussion in chat</a>."}, {"owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1532550739, "post_id": 51524306, "comment_id": 90022968, "body": "I can&#39;t help you.  Like I said, this is an application I haven&#39;t ever even attempted.  Sorry."}, {"owner": {"reputation": 355, "user_id": 9841207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5da3d361f6c331926b8f161bb67d9c?s=128&d=identicon&r=PG&f=1", "display_name": "User", "link": "https://stackoverflow.com/users/9841207/user"}, "reply_to_user": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1532560382, "post_id": 51524306, "comment_id": 90026174, "body": "@Jaberwocky All good thank you for your time :)"}], "answers": [{"comments": [{"owner": {"reputation": 355, "user_id": 9841207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5da3d361f6c331926b8f161bb67d9c?s=128&d=identicon&r=PG&f=1", "display_name": "User", "link": "https://stackoverflow.com/users/9841207/user"}, "edited": false, "score": 0, "creation_date": 1532560272, "post_id": 51528391, "comment_id": 90026152, "body": "I am not home just yet but if that fixed my problem you are an angel!"}], "tags": [], "owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "is_accepted": true, "score": 0, "last_activity_date": 1532556602, "creation_date": 1532556602, "answer_id": 51528391, "question_id": 51524306, "link": "https://stackoverflow.com/questions/51524306/adob-vba-automation-error-when-inserting-data-into-table/51528391#51528391", "title": "ADOB VBA Automation error when inserting data into table", "body": "<p>There are two functions being attempted  (1)  INSERT a new row,  and  (2) Get x rows of Names.  These require two separate ADODB.Recordset.  The following does the Insert, but fails on stepping thru the Get</p>\n\n<pre><code>Sub zz()\n    Dim sSQL As String, sResult(3) As String\n    sSQL = \"INSERT INTO [DataSheet2$] (Name, a, b, c, d, e) \n            VALUES ('This is a name', 10, 20, 30, 40, 50)\"\n    'Result is the array which is populated with the returned rows\n    runQuery sSQL, sResult\nEnd Sub\n\n\n\nPublic Function runQuery(SQL As String, ByRef result() As String) As Integer\n  Dim dataConection As New ADODB.Connection\n  Dim mrs As New ADODB.Recordset\n  Dim DBPath As String\n  Dim connectionString As String\n  Dim size As Integer\n\n  Set mrs = CreateObject(\"ADODB.Recordset\")\n\n  'Set cursor to start\n  mrs.CursorLocation = adUseClient\n\n  'Set database path\n  DBPath = ThisWorkbook.FullName\n\n  'You can provide the full path of your external file as shown below\n  connectionString = \"Provider=MSDASQL.1;DSN=Excel Files;DBQ=\" &amp; DBPath &amp; \";HDR=Yes';\"\n\n  'Open connection to database\n  dataConection.Open connectionString\n\n  'Open record set (query or table, connection)\n  mrs.Open SQL, dataConection   '&gt;&gt; this is where the INSERT happens\n\n  'Record set returned update data\n  If mrs.EOF Then   ''&gt;&gt; rte 3704  Operation not allowed when object is closed\n      runQuery = 0\n      Exit Function\n  Else\n      runQuery = mrs.RecordCount\n  End If\n\n  'Populate array with result\n  ReDim result(size) As String\n  Dim i As Integer\n\n  For i = 0 To (size - 1)\n      result(i) = mrs!Name\n      mrs.MoveNext\n  Next i\n\n  'Close record set and connection\n  mrs.Close\n  dataConection.Close\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 355, "user_id": 9841207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5da3d361f6c331926b8f161bb67d9c?s=128&d=identicon&r=PG&f=1", "display_name": "User", "link": "https://stackoverflow.com/users/9841207/user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "accepted_answer_id": 51528391, "answer_count": 1, "score": 0, "last_activity_date": 1532605290, "creation_date": 1532538436, "last_edit_date": 1532605290, "question_id": 51524306, "link": "https://stackoverflow.com/questions/51524306/adob-vba-automation-error-when-inserting-data-into-table", "title": "ADOB VBA Automation error when inserting data into table", "body": "<p>I am trying to insert a row into an excel table named DataRange2$. From the same workbook. I am getting a (Run time Automation error -214721793). My code works when I query the Excel workbook such as <code>select * from DataRange2$</code>. I want to insert a row but got this error. I am using ADOB, VBA, and excel 2010.</p>\n\n<p>The SQL query being sent in is:</p>\n\n<pre><code>SQL = \"INSERT INTO [DataSheet2$] (Name, a, b, c, d, e) VALUES ('This is a name', 10, 20, 30, 40, 50)\"\n`Result` is the array which is populated with the returned rows \nrunQuery SQL, result\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>Public Function runQuery(SQL As String, ByRef result() As String) As Integer\n  Dim dataConection As New ADODB.connection\n  Dim mrs As New ADODB.Recordset\n  Dim DBPath As String\n  Dim connectionString As String\n  Dim size As Integer\n\n  Set mrs = CreateObject(\"ADODB.Recordset\")\n\n  'Set cursor to start\n  mrs.CursorLocation = adUseClient\n\n  'Set database path\n  DBPath = ThisWorkbook.FullName\n\n  'You can provide the full path of your external file as shown below\n  connectionString = \"Provider=MSDASQL.1;DSN=Excel Files;DBQ=\" &amp; DBPath &amp; \";HDR=Yes';\"\n\n  'Open connection to database\n  dataConection.Open connectionString\n\n  'Open record set (query or table, connection)\n  mrs.Open SQL, dataConection\n\n  'Record set returned update data\n  If mrs.EOF Then\n      runQuery = 0\n      Exit Function\n  Else\n      runQuery = mrs.RecordCount\n  End If\n\n  'Populate array with result\n  ReDim result(size) As String\n  Dim i As Integer\n\n  For i = 0 To (size - 1)\n      result(i) = mrs!Name\n      mrs.MoveNext\n  Next i\n\n  'Close record set and connection\n  mrs.Close\n  dataConection.Close\nEnd Function\n</code></pre>\n\n<p>The worksheet headers are as follows</p>\n\n<pre><code>Name | a | b | c | d | e | Status | Action\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1532538478, "post_id": 51524060, "comment_id": 90017359, "body": "1) Look up <code>SpecialCells(xlCellTypeBlanks)</code>, 2) <code>Workbook_Open()</code> event.  Look up those two items and you should be on your way."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4343040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X6Hnv.gif?s=128&g=1", "display_name": "eVinx", "link": "https://stackoverflow.com/users/4343040/evinx"}, "edited": false, "score": 0, "creation_date": 1532704570, "post_id": 51525143, "comment_id": 90088693, "body": "ill give it a try"}, {"owner": {"reputation": 1, "user_id": 4343040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X6Hnv.gif?s=128&g=1", "display_name": "eVinx", "link": "https://stackoverflow.com/users/4343040/evinx"}, "edited": false, "score": 0, "creation_date": 1532704617, "post_id": 51525143, "comment_id": 90088715, "body": "it just paste formula in the cell but as text not als a working formula"}, {"owner": {"reputation": 1, "user_id": 4343040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X6Hnv.gif?s=128&g=1", "display_name": "eVinx", "link": "https://stackoverflow.com/users/4343040/evinx"}, "edited": false, "score": 0, "creation_date": 1532704760, "post_id": 51525143, "comment_id": 90088780, "body": "and its not placing it in the empty cells but in the hole range N"}, {"owner": {"reputation": 1, "user_id": 4343040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X6Hnv.gif?s=128&g=1", "display_name": "eVinx", "link": "https://stackoverflow.com/users/4343040/evinx"}, "edited": false, "score": 0, "creation_date": 1532712153, "post_id": 51525143, "comment_id": 90092357, "body": "one small issue when the cell setting is text it paste this formula =IF(RC[-2]=&quot;&quot;,&quot;&quot;,RC[-1]*VLOOKUP(RC[-2],&#39;Database Freon&#39;!B2:C6,2,0)) but if the cell setting is on default it paste this code =ALS(L2=&quot;&quot;;&quot;&quot;;M2*VERT.ZOEKEN(L2;&#39;Database Freon&#39;!&#39;B2&#39;:$F:$F;2;0)) that gives a formula error #Name"}], "tags": [], "owner": {"reputation": 61, "user_id": 10129720, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-d-8z4sG5HxE/AAAAAAAAAAI/AAAAAAAAAAA/fsBrOsL-aOI/photo.jpg?sz=128", "display_name": "SALVADOR RODRIGUEZ SEGURA", "link": "https://stackoverflow.com/users/10129720/salvador-rodriguez-segura"}, "is_accepted": false, "score": 0, "last_activity_date": 1532541847, "creation_date": 1532541847, "answer_id": 51525143, "question_id": 51524060, "link": "https://stackoverflow.com/questions/51524060/excel-vba-insert-formula-for-empty-cell-with-vba/51525143#51525143", "title": "excel vba insert formula for empty cell with vba", "body": "<p>You can try:</p>\n\n<p>Private Sub Workbook_Open()</p>\n\n<pre><code>Range(\"N6\").Select\nActiveCell.FormulaR1C1 = \"=IF(RC[-2]=\"\"\"\",\"\"\"\",RC[-1]*VLOOKUP(RC[-2],'Database Freon'!B2:C20,2,0))\"\n\nRange(\"N6\").Select\n\nSelection.Copy\nDo While True\n    ActiveCell.Offset(1, 0).Select\n    If IsEmpty(ActiveCell.Offset(0, -2).Value) And IsEmpty(ActiveCell.Offset(0, -1).Value) Then\n        Exit Do\n    Else\n        ActiveSheet.Paste\n        Application.CutCopyMode = False\n        Selection.Copy\n    End If\nLoop\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 1, "user_id": 4343040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X6Hnv.gif?s=128&g=1", "display_name": "eVinx", "link": "https://stackoverflow.com/users/4343040/evinx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 751, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1532541847, "creation_date": 1532537500, "question_id": 51524060, "link": "https://stackoverflow.com/questions/51524060/excel-vba-insert-formula-for-empty-cell-with-vba", "title": "excel vba insert formula for empty cell with vba", "body": "<p>i don't know how to add this formula in vba and make it dynamic with a range</p>\n\n<pre><code>the formula is: =ALS(L9=\"\";\"\";M9*VERT.ZOEKEN(L9;'Database Freon'!B2:C20;2;0))\n\nDatabase OU Column L = text\nDatabase OU column M = number\nDatabase OU Column N = number\nDatabase Freon B Column = text\nDatabase Freon C column = number\nformula is at Column N or if better other column but value to Column N\n</code></pre>\n\n<p>the formula calculates M * C = N</p>\n\n<p>now i want this formula run every time the workbook is opened to fill all the empty cells on Database OU Column N</p>\n\n<p>thanks in advance</p>\n"}, {"tags": ["vba", "excel", "foreach"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1532540111, "post_id": 51524007, "comment_id": 90018180, "body": "Within your loop, I don&#39;t see where you open the current file, so it will not be in the <code>Workbooks</code> collection, and you won&#39;t be able to refer to any <code>Worksheet</code> or <code>Range</code> within it."}, {"owner": {"reputation": 85, "user_id": 9931441, "user_type": "registered", "profile_image": "https://graph.facebook.com/1822858961104142/picture?type=large", "display_name": "Analia Quirk", "link": "https://stackoverflow.com/users/9931441/analia-quirk"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1532540423, "post_id": 51524007, "comment_id": 90018343, "body": "@BigBen I just realized that a few minutes ago...I updated my code with that change but now even when I run my code, no errors pop up, but no data is copied and pasted into &quot;MASTER.xlsx&quot;. I just updated the code on this post...do you see where I could be going wrong?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1532541064, "post_id": 51524007, "comment_id": 90018679, "body": "<code>wsSource.Range(&quot;A2:V&quot;...</code> maybe?"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1532542587, "post_id": 51524007, "comment_id": 90019431, "body": "Use some <code>Debug.Print</code> statements prior to the copy/paste. Make sure to print out the <code>Debug.Print lsSource.Address</code> and potentially other useful values to ensure the ranges are covering the correct data."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1532543985, "post_id": 51524007, "comment_id": 90020030, "body": "you want to open the workbook right before this assignment, Activeworkbook is unpredictable but not if you use right after the open: Set wbDest = ActiveWorkbook"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1532544130, "post_id": 51524007, "comment_id": 90020089, "body": "also make this wsSource.Range(&quot;A2:V&quot; &amp; lrSource).Copy, you can&#39;t only sometimes explicitly refer to to the workbooks or worksheets, you do it on this line for one but not the other"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1532544447, "post_id": 51524007, "comment_id": 90020234, "body": "Change lrSource and lrDest to wsSource.Cells(wsSource.Rows.Count, &quot;A&quot;).End(xlUp).Row) and wsDest.Cells(wsDest.Rows.Count, &quot;A&quot;).End(xlUp).Row) if your last rows are not working out propoerly."}, {"owner": {"reputation": 85, "user_id": 9931441, "user_type": "registered", "profile_image": "https://graph.facebook.com/1822858961104142/picture?type=large", "display_name": "Analia Quirk", "link": "https://stackoverflow.com/users/9931441/analia-quirk"}, "reply_to_user": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1532552972, "post_id": 51524007, "comment_id": 90024000, "body": "@Wookies-Will-Code I ended up creating a whole different Workbook and copying and pasting my code into the new buttons I have the subroutines connected to and now the code works...not really sure what was going on."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1532553066, "post_id": 51524007, "comment_id": 90024031, "body": "Interesting. . . ."}], "owner": {"reputation": 85, "user_id": 9931441, "user_type": "registered", "profile_image": "https://graph.facebook.com/1822858961104142/picture?type=large", "display_name": "Analia Quirk", "link": "https://stackoverflow.com/users/9931441/analia-quirk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1532541343, "creation_date": 1532537326, "last_edit_date": 1532541343, "question_id": 51524007, "link": "https://stackoverflow.com/questions/51524007/copy-paste-function-within-foreach-loop-doesnt-do-anything-vba", "title": "Copy/Paste function within ForEach loop doesn&#39;t do anything VBA", "body": "<p>Previously I was having issues with the lrSource variable not referencing the correct worksheet, but I added code to fix this issue. Before I corrected the issue, the code would paste some data into \"MASTER.xlsx\" but not the correct portions due to the lrSource variable not getting the correct last row. Now, I can get the correct last row and I don't receive any errors, but no data is copied to the file destination (\"MASTER.xlsx\")...Any suggestions?</p>\n\n<pre><code>Sub btnUpdateSAPData_Click()\n'Declaring and Setting Variables\nDim fso As Scripting.FileSystemObject\nSet fso = New Scripting.FileSystemObject\n\nDim MyDir As String\nDim fil As Scripting.file\nDim FolderSource As Scripting.Folder\nDim FolderPathDest As String, wbDest As Workbook, wsDest As Worksheet\nDim wbSource As Workbook, wsSource As Worksheet\nDim lrDest As Long, fileDest As String, lrSource As Long\nDim CurrentFile As String\nDim fileSource As String\n\nMyDir = \"C:\\Users\\quirk\\Desktop\\Cory Project\\Wave 1A Content\\SAPCL Spreadsheets\\July 2018\"\n\n'Defining destination characteristics\nFolderPathDest = \"C:\\Users\\quirk\\Desktop\\Cory Project\\VBA Code\\Master FOlder\"\nfileDest = \"C:\\Users\\quirk\\Desktop\\Cory Project\\VBA Code\\Master FOlder\\MASTER.xlsx\"\n'Workbooks.Open Filename:=fileDest\nSet wbDest = ActiveWorkbook ' Workbooks(\"MASTER.xlsx\")\nSet wsDest = wbDest.Worksheets(\"Sheet1\")\n\n\n'Looping through files\nSet FolderSource = fso.GetFolder(MyDir)\nFor Each fil In FolderSource.Files\n    Debug.Print fil.Name\n    CurrentFile = fil.Name\n    If Not fso.FileExists(FolderPathDest &amp; \"\\\" &amp; fil.Name) Then\n        fso.CopyFile _\n        Source:=MyDir &amp; \"\\\" &amp; fil.Name _\n        , Destination:=FolderPathDest &amp; \"\\\" &amp; fil.Name\n            fileSource = MyDir &amp; \"\\\" &amp; fil.Name\n            Workbooks.Open Filename:=fileSource '\n            ActiveWindow.Visible = False\n            Set wbSource = Workbooks(CurrentFile)\n            Set wsSource = wbSource.Worksheets(1)\n                lrSource = wsSource.Range(\"A\" &amp; wsSource.Rows.Count).End(xlUp).Row\n                lrDest = wsDest.Range(\"A\" &amp; wsDest.Rows.Count).End(xlUp).Row + 1\n                Range(\"A2:V\" &amp; lrSource).Copy Destination:=wsDest.Range(\"A\" &amp; lrDest)\n    End If\nNext fil\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "csv", "save-as"], "answers": [{"comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1532619336, "post_id": 51528192, "comment_id": 90052898, "body": "@Mwspencer did it work? if so, please choose it as the right answer by hitting the check mark at the upper left"}], "tags": [], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "is_accepted": false, "score": 2, "last_activity_date": 1532555466, "creation_date": 1532555466, "answer_id": 51528192, "question_id": 51523891, "link": "https://stackoverflow.com/questions/51523891/vba-save-as-csv-file-is-overwritten-by-first-sheet/51528192#51528192", "title": "VBA Save As CSV File is Overwritten by First Sheet", "body": "<p>You code is too large for no benefits. I cleaned it and corrected your mistakes and also added necessary pieces to not ask the users for anything:</p>\n\n<pre><code>Sub LipperFormat()\n    Dim filePath As String\n    Dim csvFileName As String\n    Dim ws As Worksheet\n    Dim wb As Workbook\n\n    Application.DisplayAlerts = False\n\n    'define parameters\n    Set wb = ThisWorkbook\n    Set ws = wb.Worksheets(1) 'it is better to define it with the name, not with its index\n    filePath = ws.Cells(1, 2).Value\n\n\n    'Open File\n    Set wb = Workbooks.Open(Filename:=filePath, ReadOnly:=True)\n\n    'loop and save as csv\n    For Each ws In wb.Worksheets\n        csvFileName = wb.Path &amp; \"\\\" &amp; Left(wb.Name, Len(wb.Name) - 5) &amp; \"__\" &amp; ws.Name\n        ws.Copy\n        ActiveWorkbook.SaveAs Filename:=csvFileName, FileFormat:=xlCSV, CreateBackup:=True\n        ActiveWorkbook.Close\n    Next ws\n\n    'close WB\n    wb.Close\n\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 871, "user_id": 7107548, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce53e74dcdc4ff87ee007c3a565c9517?s=128&d=identicon&r=PG&f=1", "display_name": "Mwspencer", "link": "https://stackoverflow.com/users/7107548/mwspencer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532555466, "creation_date": 1532536874, "question_id": 51523891, "link": "https://stackoverflow.com/questions/51523891/vba-save-as-csv-file-is-overwritten-by-first-sheet", "title": "VBA Save As CSV File is Overwritten by First Sheet", "body": "<p>I have workbook, I loop through and save each sheet as a csv.  The problem is when the loop finishes Excel prompts me to save.  If I click \"Save\", then last worksheet is overwritten with whichever sheet the excel workbook opens on. </p>\n\n<p>If click \"Don't Save\" everything remains saved with the proper data, but I can't rely on the user to click \"Don't Save\" every time so I need to find where my code is over writing the data when saved. </p>\n\n<p>How do I keep my csv sheet from being overwritten? </p>\n\n<pre><code>Sub LipperFormat()\n\n'Create Workbook\nDim wb As Workbook\n\n'Get FilePath\nDim wbActive As Workbook\nSet wbActive = ActiveWorkbook\nDim wsActive As Worksheet\nSet wsActive = wbActive.Worksheets(1)\n\n'Get File Path\nDim filePath As String\nDim rngActive As Range\nSet rngActive = wsActive.Cells(1, 2)\nfilePath = rngActive.Value\n\n'Open File\nSet wb = Workbooks.Open(filePath)\n\n'Create Copy of file and CSV\nDim copyFilePath As String\nDim fileExtension As String: fileExtension = \"_OG.xlsx\"\n\ncopyFilePath = Left(filePath, Len(filePath) - 5) + fileExtension\n\nwb.SaveCopyAs copyFilePath\n\n'Loop through worksheets\nDim WS_Count As Integer\nDim i As Integer\n\nWS_Count = wb.Worksheets.Count\n\nFor i = 1 To WS_Count\n\n    Dim col As Integer\n    Dim ws As Worksheet\n    Set ws = wb.Sheets(i)\n\n    'Save As CSV\n    Dim sheetName As String: sheetName = ws.Name\n    Dim csvFilePath As String\n    Dim csvSheet As Worksheet\n    cvsFilePath = Left(filePath, Len(filePath) - 5) + \"__\" + sheetName\n\n    'ws.Name = sheetName\n    ws.SaveAs FileName:=cvsFilePath, FileFormat:=xlCSV, CreateBackup:=False\n\nNext i\n\n'wb.Save\nwb.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 685, "user_id": 6187845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc90c985e2d7b81ba79c02313aeeefd?s=128&d=identicon&r=PG&f=1", "display_name": "nagarajannd", "link": "https://stackoverflow.com/users/6187845/nagarajannd"}, "is_accepted": true, "score": 0, "last_activity_date": 1532537288, "creation_date": 1532537288, "answer_id": 51524000, "question_id": 51523880, "link": "https://stackoverflow.com/questions/51523880/how-to-delete-a-picture-in-powerpoint-from-vba-code-in-excel-before-pasting-new/51524000#51524000", "title": "How to delete a picture in powerpoint from VBA code in excel before pasting new object?", "body": "<p>before pasting your picture, loop through all shapes in the active slide and delete 'em.</p>\n\n<pre><code>With PptActvWin\n.View.GotoSlide Index:=3\nFor Each oSh In .View.Slide.Shapes\n    If oSh.Type = msoPicture Then\n        oSh.Delete\n    End If\nNext\n.View.PasteSpecial DataType:=ppPastePicture\npptApp.ActiveWindow.Selection.ShapeRange.Left = 2.5 * 72 * 0.393700787\npptApp.ActiveWindow.Selection.ShapeRange.Top = 2.5 * 72 * 0.393700787\npptApp.ActiveWindow.Selection.ShapeRange.ScaleHeight 0.45, msoTrue, msoScaleFromTopLeft\npptApp.ActiveWindow.ViewType = ppViewNormal\n</code></pre>\n\n<p>End With</p>\n"}], "owner": {"reputation": 3, "user_id": 10134676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc60a4e068489d6db1e0606651dfcfaa?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia Jones", "link": "https://stackoverflow.com/users/10134676/olivia-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 479, "favorite_count": 0, "accepted_answer_id": 51524000, "answer_count": 1, "score": 0, "last_activity_date": 1532537288, "creation_date": 1532536823, "question_id": 51523880, "link": "https://stackoverflow.com/questions/51523880/how-to-delete-a-picture-in-powerpoint-from-vba-code-in-excel-before-pasting-new", "title": "How to delete a picture in powerpoint from VBA code in excel before pasting new object?", "body": "<p>Very new to VBA.\nThis is code i'm using to paste into blank powerpoint slide (which has been working fine) but when i need to update for the next months data not sure how to delete old picture before new picture is pasted...\nany help appreciated.</p>\n\n<pre><code>  Sheets(\"Presentation\").Select\n  Range(\"b53:w99\").Select\n  Selection.CopyPicture Format:=xlPicture\n  With PptActvWin\n    .View.GotoSlide Index:=3\n    .View.PasteSpecial DataType:=ppPastePicture\n    pptApp.ActiveWindow.Selection.ShapeRange.Left = 2.5 * 72 * 0.393700787\n    pptApp.ActiveWindow.Selection.ShapeRange.Top = 2.5 * 72 * 0.393700787\n    pptApp.ActiveWindow.Selection.ShapeRange.ScaleHeight 0.45, msoTrue, \n  msoScaleFromTopLeft\n    pptApp.ActiveWindow.ViewType = ppViewNormal\n  End With\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-word"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1532536601, "post_id": 51523732, "comment_id": 90016404, "body": "You cannot assign an array to a parameter expecting a single value.  If you have a list of items then you need to do it in a loop or use a &quot;...where in(...)&quot; clause"}, {"owner": {"reputation": 685, "user_id": 6187845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc90c985e2d7b81ba79c02313aeeefd?s=128&d=identicon&r=PG&f=1", "display_name": "nagarajannd", "link": "https://stackoverflow.com/users/6187845/nagarajannd"}, "edited": false, "score": 0, "creation_date": 1532536786, "post_id": 51523732, "comment_id": 90016486, "body": "Is function <code>GetSelectedItems</code> returns a string?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1532536811, "post_id": 51523732, "comment_id": 90016499, "body": "^ what @Tim said. also it looks like you&#39;re using some global-scope connection... that&#39;s sloppy: a database connection should be as tightly scoped as possible, even more so than any other type of variable - imagine you open a file <i>somewhere</i> and keep the handle global and <i>something, somewhere, at some point</i>, is going to close it: it&#39;s a recipe for problems. If you don&#39;t know exactly what the next command is and when it will be issued, it&#39;s time to close that connection."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 685, "user_id": 6187845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc90c985e2d7b81ba79c02313aeeefd?s=128&d=identicon&r=PG&f=1", "display_name": "nagarajannd", "link": "https://stackoverflow.com/users/6187845/nagarajannd"}, "edited": false, "score": 0, "creation_date": 1532536875, "post_id": 51523732, "comment_id": 90016532, "body": "@nagarajannd if that were the case, OP wouldn&#39;t be having this error. <code>myarray As Variant</code>, and the pluralization of <code>GetSelectedItems</code>, suggest rather strongly that the function is returning an array of strings."}, {"owner": {"reputation": 137, "user_id": 9607977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0690dd5b0f7ef8e1c18e1759273c602?s=128&d=identicon&r=PG&f=1", "display_name": "Jb83", "link": "https://stackoverflow.com/users/9607977/jb83"}, "edited": false, "score": 0, "creation_date": 1532537227, "post_id": 51523732, "comment_id": 90016716, "body": "I&#39;ve added the Getselecteditems function code so you guys can see it. It is returning a string. It should be able to return multiple strings if multiple items are selected but in this case it is only selecting one."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1532537434, "post_id": 51523732, "comment_id": 90016818, "body": "Thanks for including the code. It is <i>not</i> returning a string. <code>Array()</code> is an empty <b>array</b>, and <code>tmpArray</code> is declared as a variant <b>array</b> as well. Neither are strings. An array that contains only one string <i>is still an array</i>."}, {"owner": {"reputation": 137, "user_id": 9607977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0690dd5b0f7ef8e1c18e1759273c602?s=128&d=identicon&r=PG&f=1", "display_name": "Jb83", "link": "https://stackoverflow.com/users/9607977/jb83"}, "edited": false, "score": 0, "creation_date": 1532537569, "post_id": 51523732, "comment_id": 90016889, "body": "Any idea how to get it to work then?"}], "answers": [{"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1532538612, "post_id": 51524190, "comment_id": 90017427, "body": "Or just <code>&quot;UPDATE [Attendance] SET [Seated] = &#39;1&#39; WHERE [Agentname] In (&#39;&quot; &amp; VBA.Join(myarray, &quot;&#39;,&#39;&quot;) &amp; &quot;&#39;)&quot;</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1532538951, "post_id": 51524190, "comment_id": 90017590, "body": "Your loop doesn&#39;t affect the content of myArray - <code>x</code> is a <i>copy</i> of each element, not a reference to it."}, {"owner": {"reputation": 685, "user_id": 6187845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc90c985e2d7b81ba79c02313aeeefd?s=128&d=identicon&r=PG&f=1", "display_name": "nagarajannd", "link": "https://stackoverflow.com/users/6187845/nagarajannd"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1532591724, "post_id": 51524190, "comment_id": 90035043, "body": "Sorry! Totally missed that. :( @Mathieu Guindon Thanks for the edit."}], "tags": [], "owner": {"reputation": 685, "user_id": 6187845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc90c985e2d7b81ba79c02313aeeefd?s=128&d=identicon&r=PG&f=1", "display_name": "nagarajannd", "link": "https://stackoverflow.com/users/6187845/nagarajannd"}, "is_accepted": false, "score": 0, "last_activity_date": 1532538786, "last_edit_date": 1532538786, "creation_date": 1532537959, "answer_id": 51524190, "question_id": 51523732, "link": "https://stackoverflow.com/questions/51523732/adodb-command-value-of-wrong-type-error/51524190#51524190", "title": "ADODB command value of wrong type error", "body": "<p>Instead appending parameters build the query string and execute them</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>With Cm\n    .ActiveConnection = Appconn\n    .CommandType = adCmdText\n    For Each x In myarray\n        x = \"'\" &amp; x &amp; \"'\"\n    Next\n    .CommandText = \"UPDATE [Attendance] SET [Seated] = '1' WHERE [Agentname] In ('\" &amp; VBA.Join(myarray, \"','\") &amp; \"')\"\n    Set AttendRecord = .Execute\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1532538482, "post_id": 51524283, "comment_id": 90017362, "body": "That will only work for single-selections because of the <code>=</code> in the <code>WHERE</code> clause ;-)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1532538532, "post_id": 51524283, "comment_id": 90017383, "body": "@MathieuGuindon - hence the loop?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1532538661, "post_id": 51524283, "comment_id": 90017453, "body": "Oh, I totally missed you were executing the command multiple times over - yeah that&#39;ll work... although the ideal solution would be both parameterized <i>and</i> set-based."}, {"owner": {"reputation": 137, "user_id": 9607977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0690dd5b0f7ef8e1c18e1759273c602?s=128&d=identicon&r=PG&f=1", "display_name": "Jb83", "link": "https://stackoverflow.com/users/9607977/jb83"}, "edited": false, "score": 0, "creation_date": 1532538703, "post_id": 51524283, "comment_id": 90017478, "body": "This worked like a charm. Thank you! You&#39;ve solved MULTIPLE issues."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1532538419, "last_edit_date": 1532538419, "creation_date": 1532538306, "answer_id": 51524283, "question_id": 51523732, "link": "https://stackoverflow.com/questions/51523732/adodb-command-value-of-wrong-type-error/51524283#51524283", "title": "ADODB command value of wrong type error", "body": "<p>Untested:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub testingcommand()\n\n    Dim Cm As ADODB.Command\n    Dim myarray As Variant\n    Dim Pm As ADODB.Parameter, v\n\n    myarray = GetSelectedItems(attendance.Agentname)\n    If Appconn.State = 0 Then\n        Call database_connect\n    End If\n\n    Set Cm = New ADODB.Command\n    With Cm\n        .ActiveConnection = Appconn\n        .CommandText = \"UPDATE [Attendance] SET [Seated] = '1' WHERE [Agentname]=?\"\n        .CommandType = adCmdText\n        Set Pm = .CreateParameter(\"AgentName\", adVarChar, adParamInput, 200, \"myarray\")\n        .Parameters.Append Pm\n\n        'loop over your array\n        for each v in myarray\n            Pm.value = v\n            .Execute\n        Next v\n\n    End With\n    Set AttendRecord = Nothing\n    PhoneHiring_Disconnect\n\nEnd Sub \n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 9607977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0690dd5b0f7ef8e1c18e1759273c602?s=128&d=identicon&r=PG&f=1", "display_name": "Jb83", "link": "https://stackoverflow.com/users/9607977/jb83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 777, "favorite_count": 0, "accepted_answer_id": 51524283, "answer_count": 2, "score": 1, "last_activity_date": 1532538786, "creation_date": 1532536229, "last_edit_date": 1532537442, "question_id": 51523732, "link": "https://stackoverflow.com/questions/51523732/adodb-command-value-of-wrong-type-error", "title": "ADODB command value of wrong type error", "body": "<p>I've been trying to crack this issue for a while and I've almost got it I think. I am using the following code to update a SQL table. This sub executes on a button click. When clicked I get \"Application uses a value of the wrong type for the current operation\" error. </p>\n\n<p>It highlights the <code>Pm.Value = myarray</code> line. In the locals window I can see that <code>myarray</code> is pulling in the correct value, which is a name selected from a listbox on a userform.</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub testingcommand()\ndatabase_connect\nDim AttendRecord As New ADODB.Recordset\nDim Cm As ADODB.Command\nDim myarray As Variant\nDim Pm As ADODB.Parameter\nmyarray = GetSelectedItems(attendance.Agentname)\nIf Appconn.State = 0 Then\nCall database_connect\nEnd If\nSet Cm = New ADODB.Command\nWith Cm\n    .ActiveConnection = Appconn\n    .CommandText = \"UPDATE [Attendance] SET [Seated] = '1' WHERE [Agentname]=?;\"\n    .CommandType = adCmdText\n    Set Pm = .CreateParameter(\"AgentName\", adVarChar, adParamInput, 200, \"myarray\")\n    Pm.value = myarray\n    .Parameters.Append Pm\n    Set AttendRecord = .Execute\nEnd With\nSet AttendRecord = Nothing\nPhoneHiring_Disconnect\nEnd Sub \n</code></pre>\n\n<p>I've edited this with the function that is returning the array. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code> Public Function GetSelectedItems(lBox As MSForms.ListBox) As Variant\n\n\n Dim tmpArray() As Variant\n Dim i As Integer\n Dim selCount As Integer\n\n    selCount = -1\n    For i = 0 To lBox.ListCount - 1\n        If lBox.Selected(i) = True Then\n            selCount = selCount + 1\n            ReDim Preserve tmpArray(selCount)\n            tmpArray(selCount) = lBox.list(i)\n\n        End If\n    Next\n    If selCount = -1 Then\n        GetSelectedItems = Array()\n    Else\n        GetSelectedItems = tmpArray\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "jpeg", "data-conversion"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1532543645, "post_id": 51523438, "comment_id": 90019880, "body": "You may need to write a <a href=\"https://en.wikipedia.org/wiki/BMP_file_format#Bitmap_file_header\" rel=\"nofollow noreferrer\">BMP file header</a> before the image data to get a valid BMP file. Once you have that, converting to JPG is trivial (e.g. IrfanView command line)."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1532546205, "post_id": 51523438, "comment_id": 90021011, "body": "Is that from an image control? Was the data in the field attached as an OLE object or inserted from a JPG image?"}, {"owner": {"reputation": 11, "user_id": 10123059, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ximQf.gif?s=128&g=1", "display_name": "Flap Zappa", "link": "https://stackoverflow.com/users/10123059/flap-zappa"}, "edited": false, "score": 0, "creation_date": 1532849537, "post_id": 51523438, "comment_id": 90121763, "body": "it was inserted from an image copied from an internet page."}, {"owner": {"reputation": 11, "user_id": 10123059, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ximQf.gif?s=128&g=1", "display_name": "Flap Zappa", "link": "https://stackoverflow.com/users/10123059/flap-zappa"}, "edited": false, "score": 0, "creation_date": 1532849581, "post_id": 51523438, "comment_id": 90121770, "body": "however I have gone down a different route now and used the Save Clipboard images to local file  function from this page      <a href=\"https://github.com/krishKM/VBA_TOOLS/blob/master/README.md#save-clipboard-images-to-local-file\" rel=\"nofollow noreferrer\">github.com/krishKM/VBA_TOOLS/blob/master/&hellip;</a> and link the image via linked image control.   thanks for the help though"}], "owner": {"reputation": 11, "user_id": 10123059, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ximQf.gif?s=128&g=1", "display_name": "Flap Zappa", "link": "https://stackoverflow.com/users/10123059/flap-zappa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 478, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1532546126, "creation_date": 1532535149, "last_edit_date": 1532546126, "question_id": 51523438, "link": "https://stackoverflow.com/questions/51523438/output-an-ole-object-to-jpg-file", "title": "Output an ole object to jpg file", "body": "<p>I have a ms access database with an ole object field where I have pasted in images collected from various places from the internet, no files created before copying them into the field</p>\n\n<p>the database has got rather large and I want to export the images to a file and link them rather than embed them</p>\n\n<p>I have got this far</p>\n\n<pre><code>    Public Function exportlink()\n    Dim strSQL As String\n    Dim mstream As ADODB.Stream\n    Dim strFullPath As String\n    Dim image As Control\n    Dim FN As String\n    Set image = Forms!frmuseful!image\n    strFullPath = \"C:\\Documents\\pics\\\"\n    FN = Forms!frmuseful!ID &amp; \"a\" &amp; \".jpg\"\n    'Create a Stream Object to contain the Binary Data from the OLE Object Field,\n    '(adTypeBinary), then Open it\n    Set mstream = New ADODB.Stream\n    mstream.Type = adTypeBinary\n    mstream.Open\n\n    'Write the contents of the OLE Object Field to the Stream\n    mstream.Write image.Value\n\n    mstream.SaveToFile strFullPath &amp; FN, adSaveCreateOverWrite\n    End Function\n</code></pre>\n\n<p>which outputs a file but when I try to open it it says not a valid JPG file. size wise it looks more like what I could expect for a bitmap file, but changing to .bmp also gives not a valid BMP file. </p>\n\n<p>I am guess that somewhere along the line I need to convert the stream to jpg format, but I am not sure how to do that</p>\n"}, {"tags": ["excel", "vba", "excel-2016"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1532535031, "post_id": 51523267, "comment_id": 90015658, "body": "First time I have seen that, I have had issues where the macro recorder will not record &quot;SaveAS&quot; on a certain computer and another computer would not record the conditional formatting as well. I have never been able to find out why or a solution."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10128437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38d8b9bb655cf4f95d91d2649fe91883?s=128&d=identicon&r=PG&f=1", "display_name": "tomghc", "link": "https://stackoverflow.com/users/10128437/tomghc"}, "is_accepted": false, "score": 0, "last_activity_date": 1532561973, "creation_date": 1532561973, "answer_id": 51529096, "question_id": 51523267, "link": "https://stackoverflow.com/questions/51523267/sort-method-missing-on-new-install-of-excel-2016/51529096#51529096", "title": "Sort Method missing on new install of Excel 2016", "body": "<p>Does the workbook have any missing references on the computer where Sort isn't showing? I've had issues where missing references had completely unrelated functions stop being recognised at runtime. Perhaps this can also affect macro recorder.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11010453, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/5a0bccaba80c8cbb0d2c34b7b740f0f7?s=128&d=identicon&r=PG", "display_name": "bithead", "link": "https://stackoverflow.com/users/11010453/bithead"}, "is_accepted": false, "score": 0, "last_activity_date": 1549245400, "creation_date": 1549245400, "answer_id": 54509335, "question_id": 51523267, "link": "https://stackoverflow.com/questions/51523267/sort-method-missing-on-new-install-of-excel-2016/54509335#54509335", "title": "Sort Method missing on new install of Excel 2016", "body": "<p>I have the same issue on a machine with a new Office 2016 installation, running macro code written in Office 2010.  I tried recording the sort routine in Excel 2016 and got the same results as those shown in the original post. </p>\n\n<p>I have since found that the code works on a different Office 2016 machine, but one where Office was upgraded from 2010 to 2016.  2016 is the only version ever installed on the broken machine. The upgraded machine has both OFFICE14 and OFFICE16 files in the \"C:\\Program Files (x86)\\Common Files\\Microsoft Shared\" structure.  The broken machine has only OFFICE16.  Copying the OFFICE14 files to the broken machine didn't help.</p>\n\n<p>While I can probably fix this by uninstalling 2016, then installing 2010 and upgrading to 2016, it sure seems there ought to be a better way.  If anyone has a better way to fix this, please let us know!  Thanks.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11031534, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/bcc3a44257cb6f05e9f82f58c1b0cf92?s=128&d=identicon&r=PG", "display_name": "bithead", "link": "https://stackoverflow.com/users/11031534/bithead"}, "is_accepted": false, "score": 0, "last_activity_date": 1549593182, "creation_date": 1549593182, "answer_id": 54585299, "question_id": 51523267, "link": "https://stackoverflow.com/questions/51523267/sort-method-missing-on-new-install-of-excel-2016/54585299#54585299", "title": "Sort Method missing on new install of Excel 2016", "body": "<p>Having 2010 previously installed is NOT the solution.  I downloaded the MS Windows 10 version 1809 installation media and installed Win10 Pro on a new virtual machine, then installed all Windows updates to bring it as close as possible to my problem PC.  Then I installed Office 2016 and the macro works fine.  Since then I have compared...</p>\n\n<ul>\n<li>Installed apps - the VM has a bunch of bloatware games that the PC\ndoes not (thanks MS!).  Other than that, nothing is on the VM that\nthe PC does not have. </li>\n<li>Installed Optional Features - if it's on the VM, its also on the PC. </li>\n<li>The features installed for Office 2016 - they are identical</li>\n<li>Via Control Panel -> Programs and Features - again, if it's on the VM, it's on the PC. </li>\n<li>Via Control Panel -> Programs and Features -> Turn Windows Features on and off - the VM did NOT have .NET Framework 3.5 enabled, so I enabled it, rebooted, and the macro still works.</li>\n</ul>\n\n<p>Oh, and for the sake of documenting it, I ran a Repair on the Office installation, which didn't help.</p>\n\n<p>So the mystery lives on.  The problem PC is a Dell machine with an OEM installed copy of Windows Home that I've upgraded to Pro.  Next steps (unless someone has a solution before I get there) include finding a spare HD and doing a system restore to factory specs to see if the problem might be with the OEM Windows installation.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11031534, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/bcc3a44257cb6f05e9f82f58c1b0cf92?s=128&d=identicon&r=PG", "display_name": "bithead", "link": "https://stackoverflow.com/users/11031534/bithead"}, "is_accepted": false, "score": 1, "last_activity_date": 1549748322, "creation_date": 1549748322, "answer_id": 54611026, "question_id": 51523267, "link": "https://stackoverflow.com/questions/51523267/sort-method-missing-on-new-install-of-excel-2016/54611026#54611026", "title": "Sort Method missing on new install of Excel 2016", "body": "<p>This is solved, although the solution remains a mystery.  After several uninstallations/installations/repairs of office 2010 and 2016, culminating in running a .NET fix from MS, Excel 2016 macro sort operations are working now.  I suspect the .NET fix (<a href=\"https://docs.microsoft.com/en-us/dotnet/framework/install/repair\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/dotnet/framework/install/repair</a>) may have been the solution all along, although I didn't receive any errors indicating a need for it until deep into the un|install and repair operations.</p>\n"}], "owner": {"reputation": 33, "user_id": 9680339, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4TQnqJpZQZ8/AAAAAAAAAAI/AAAAAAAABTg/eciB8qfTxYc/photo.jpg?sz=128", "display_name": "Jeffrey W", "link": "https://stackoverflow.com/users/9680339/jeffrey-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 534, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1575905140, "creation_date": 1532534482, "last_edit_date": 1575905140, "question_id": 51523267, "link": "https://stackoverflow.com/questions/51523267/sort-method-missing-on-new-install-of-excel-2016", "title": "Sort Method missing on new install of Excel 2016", "body": "<p>There seems to be something wrong with Excel as installed on one of the computers in our office.</p>\n\n<p>I have VBA code that sorts a specific sheet. On that machine, I get a Runtime 9 or Runtime 438 error.</p>\n\n<p>I recorded a Sort macro using the Developer Toolbar. I found that the .Sort method is missing from that machine. See the code that does not work below. Note the missing \".Sort\" and double period in between (\"RSVP Report\") and SetFirstPriority.</p>\n\n<pre><code>Sub Macro1()\n'\n' Macro1 Macro\n\nActiveSheet.(\"RSVP Report\")..SetFirstPriority.\nActiveSheet.(\"RSVP Report\")..SetFirstPriority.Add  := Range(\"A2:A23\"), Value _\n    := xlSortOnValues, Query := xlDescending,  := xlSortNormal\nActiveSheet.(\"RSVP Report\")..SetFirstPriority.Add  := Range(\"C2:C23\"), Value _\n    := xlSortOnValues, Query := xlAscending,  := xlSortNormal\nActiveSheet.(\"RSVP Report\")..SetFirstPriority.Add  := Range(\"B2:B23\"), Value _\n    := xlSortOnValues, Query := xlAscending,  := xlSortNormal\nWith ActiveSheet.(\"RSVP Report\").\n    .SetLastPriority Range(\"A1:P23\")\n    .StopIfTrue = xlYes\n    .Type = False\n    . = xlTopToBottom\n    .ScopeType = xlPinYin\n    .Delete\nEnd With\nEnd Sub\n</code></pre>\n\n<p>See code that works and was recorded on my machine. Note the presence of .Sort.</p>\n\n<pre><code>Sub Macro2()\n'\n' Macro2 Macro\n\nRange(\"A1:P23\").Select\nActiveWorkbook.Worksheets(\"RSVP Report\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"RSVP Report\").Sort.SortFields.Add Key:=Range( _\n    \"A2:A23\"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _\n    xlSortNormal\nActiveWorkbook.Worksheets(\"RSVP Report\").Sort.SortFields.Add Key:=Range( _\n    \"C2:C23\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nActiveWorkbook.Worksheets(\"RSVP Report\").Sort.SortFields.Add Key:=Range( _\n    \"B2:B23\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nWith ActiveWorkbook.Worksheets(\"RSVP Report\").Sort\n    .SetRange Range(\"A1:P23\")\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Looking at the Installation Options, everything seems to be the same between the two machines. How can I add the missing modules?</p>\n\n<p>Hopefully the responses will not be \"uninstall and reinstall.\" I'm trying to get around involving our Tech department because their solution may not be timely or helpful.</p>\n"}, {"tags": ["excel", "vba", "delete-row"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1532536898, "post_id": 51523199, "comment_id": 90016540, "body": "That little green triangle in the top left hand corner in the cells in column E, plus the left hand alignment - looks like you&#39;re dealing with text, not an actual number."}, {"owner": {"reputation": 53, "user_id": 7553805, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208916353929230/picture?type=large", "display_name": "Alexandra Thayer", "link": "https://stackoverflow.com/users/7553805/alexandra-thayer"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1532538616, "post_id": 51523199, "comment_id": 90017429, "body": "That is why I reformatted before deleting based on number. Did I do that part incorrectly and that&#39;s why it&#39;s deleting row 2 but not other rows where the percent is greater than 1?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1532538879, "post_id": 51523199, "comment_id": 90017557, "body": "oh - so row 2 is always being deleted but the rest in this sample data are not? I misunderstood &quot;the first row that has a percent&quot; - thought you mean the first row from the bottom."}, {"owner": {"reputation": 53, "user_id": 7553805, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208916353929230/picture?type=large", "display_name": "Alexandra Thayer", "link": "https://stackoverflow.com/users/7553805/alexandra-thayer"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1532539155, "post_id": 51523199, "comment_id": 90017697, "body": "yes sorry if my wording was confusing"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1532539288, "post_id": 51523199, "comment_id": 90017768, "body": "Hmm I cannot replicate your issue - can you loop for <code>For i = 7 to 2 Step - 1</code> or some other subset of the data, step through and see if you get the same result?"}, {"owner": {"reputation": 53, "user_id": 7553805, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208916353929230/picture?type=large", "display_name": "Alexandra Thayer", "link": "https://stackoverflow.com/users/7553805/alexandra-thayer"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1532540383, "post_id": 51523199, "comment_id": 90018327, "body": "I tried doing For i = 4000 to 5 Step -1 and it still deletes row 2 which doesn&#39;t make any sense to me"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1532541325, "post_id": 51523199, "comment_id": 90018817, "body": "Can you <code>Debug.Print i</code>, <code>Debug.Print .Cells(i, p).Value</code> to see what iteration of <code>i</code> it&#39;s being deleted on? scratching my head here."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1532542550, "post_id": 51523199, "comment_id": 90019416, "body": "Replace line <code>.Cells(i, p).Value = Format(.Cells(i, p).Value, &quot;Percent&quot;)</code>; With <code>.Cells(i, p).NumberFormat = &quot;General&quot;</code>         <code>.Cells(i, p).Value = .Cells(i, p).Value</code>. Then run your code it should work."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1532543794, "post_id": 51523199, "comment_id": 90019946, "body": "If you get rid of the <code>.Cells(i, p).Value = Format(.Cells(i, p).Value, &quot;Percent&quot;)</code> line, then before running the code you convert all the text to numbers manually (i.e. enter 1 in a new cell, copy it, then select column E and pastespecial &gt; multiply), does it still delete row 2?"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1532551538, "post_id": 51523199, "comment_id": 90023356, "body": "I&#39;m glad i could help"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 7553805, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208916353929230/picture?type=large", "display_name": "Alexandra Thayer", "link": "https://stackoverflow.com/users/7553805/alexandra-thayer"}, "edited": false, "score": 0, "creation_date": 1532543501, "post_id": 51525270, "comment_id": 90019814, "body": "Some how that makes the problem worse. Before it would delete rows that were less than 1% in addition to row 2. Now it replaces the values under 1% with &quot;%&quot; and only deletes row 2"}, {"owner": {"reputation": 383, "user_id": 9452116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SB6xg.jpg?s=128&g=1", "display_name": "TempleGuard527", "link": "https://stackoverflow.com/users/9452116/templeguard527"}, "reply_to_user": {"reputation": 53, "user_id": 7553805, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208916353929230/picture?type=large", "display_name": "Alexandra Thayer", "link": "https://stackoverflow.com/users/7553805/alexandra-thayer"}, "edited": false, "score": 0, "creation_date": 1532543963, "post_id": 51525270, "comment_id": 90020019, "body": "Hmmm...  I think, then, that something else is happening in code maybe you haven&#39;t supplied here.  See the screenshots I&#39;ve added to my answer."}, {"owner": {"reputation": 53, "user_id": 7553805, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208916353929230/picture?type=large", "display_name": "Alexandra Thayer", "link": "https://stackoverflow.com/users/7553805/alexandra-thayer"}, "edited": false, "score": 0, "creation_date": 1532546669, "post_id": 51525270, "comment_id": 90021211, "body": "So your thinking that this is what&#39;s causing it? the line to delete the headers (which appear multiple times)? <code>If .Cells(i, 1).Value = &quot;Part Number&quot; Then                 .Cells(i, 1).EntireRow.Delete             End If</code>"}, {"owner": {"reputation": 383, "user_id": 9452116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SB6xg.jpg?s=128&g=1", "display_name": "TempleGuard527", "link": "https://stackoverflow.com/users/9452116/templeguard527"}, "reply_to_user": {"reputation": 53, "user_id": 7553805, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208916353929230/picture?type=large", "display_name": "Alexandra Thayer", "link": "https://stackoverflow.com/users/7553805/alexandra-thayer"}, "edited": false, "score": 0, "creation_date": 1532550462, "post_id": 51525270, "comment_id": 90022858, "body": "Honestly, I don&#39;t know.  However, I think you have the right idea to start looking suspiciously at other sections of your code that delete an entire line."}, {"owner": {"reputation": 53, "user_id": 7553805, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208916353929230/picture?type=large", "display_name": "Alexandra Thayer", "link": "https://stackoverflow.com/users/7553805/alexandra-thayer"}, "edited": false, "score": 0, "creation_date": 1532551800, "post_id": 51525270, "comment_id": 90023461, "body": "thank you for your help! It&#39;s working now. It was something like that"}], "tags": [], "owner": {"reputation": 383, "user_id": 9452116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SB6xg.jpg?s=128&g=1", "display_name": "TempleGuard527", "link": "https://stackoverflow.com/users/9452116/templeguard527"}, "is_accepted": false, "score": 0, "last_activity_date": 1532544043, "last_edit_date": 1532544043, "creation_date": 1532542337, "answer_id": 51525270, "question_id": 51523199, "link": "https://stackoverflow.com/questions/51523199/deleting-row-that-it-shouldnt/51525270#51525270", "title": "Deleting Row that It Shouldn&#39;t", "body": "<p>This line was not functioning correctly <code>.Cells(i, p).Value = Format(.Cells(i, p).Value, \"Percent\")</code></p>\n\n<p>I played with it in Excel until I found something that worked.  See below.</p>\n\n<pre><code>Sub test()\n\nWith ThisWorkbook.Sheets(1)\n    hcRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n    p = 5\n        For i = hcRow To 2 Step -1 'Changed to take advantage of your detection of the last row, and stops before your title row\n        Cells(i, p) = Replace(Cells(i, p), \"%\", \"\") 'Removes the percent sign\n        Cells(i, p).NumberFormat = \"0.00%\" 'Reformats the cell (at this point, Excel still sees it formatted as text)\n        Cells(i, p) = Cells(i, p) &amp; \"%\" 'Re-addition of the percent sign to the end triggers Excel to see it as a percent\n            If .Cells(i, p).Value &lt; 0.01 Then 'Now your code works as desired\n                .Cells(i, p).EntireRow.Delete\n            End If\n        Next i\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>I can't pretend to understand why this works.  It must somehow be related to how Excel understands numbers.</p>\n\n<p>Before Screenshot:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0WOWZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0WOWZ.png\" alt=\"Before\"></a></p>\n\n<p>After Screenshot:</p>\n\n<p><a href=\"https://i.stack.imgur.com/dQS1y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dQS1y.png\" alt=\"After\"></a></p>\n"}], "owner": {"reputation": 53, "user_id": 7553805, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208916353929230/picture?type=large", "display_name": "Alexandra Thayer", "link": "https://stackoverflow.com/users/7553805/alexandra-thayer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594206556, "creation_date": 1532534214, "last_edit_date": 1594206556, "question_id": 51523199, "link": "https://stackoverflow.com/questions/51523199/deleting-row-that-it-shouldnt", "title": "Deleting Row that It Shouldn&#39;t", "body": "<p>Can someone help me understand why my code is bugging out?</p>\n\n<p>The code is below and this is some sample data. Without fail it deletes the first row that has a percent. </p>\n\n<p><a href=\"https://i.stack.imgur.com/dOWPi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dOWPi.png\" alt=\"sample data image\"></a></p>\n\n<p>Thanks in advance :)</p>\n\n<pre><code>`With ThisWorkbook.Sheets(1)\n    hcRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n    p = 5\n        For i = 4000 To 1 Step -1\n        .Cells(i, p).Value = Format(.Cells(i, p).Value, \"Percent\")\n            If .Cells(i, p).Value &lt; 0.01 Then\n                .Cells(i, p).EntireRow.Delete\n                '.Cells(i, p).Interior.ColorIndex = 3\n            End If\n        Next i\nEnd With`\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2016"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1532606917, "post_id": 51523154, "comment_id": 90044402, "body": "I once had a similar problem, but with 2010. It turned out it was caused by the <i>Google Drive-Plug-in f&#252;r Microsoft Office</i> - deinstalling it solved my issue."}], "answers": [{"comments": [{"owner": {"reputation": 8541, "user_id": 8366499, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z9t89.jpg?s=128&g=1", "display_name": "divibisan", "link": "https://stackoverflow.com/users/8366499/divibisan"}, "edited": false, "score": 0, "creation_date": 1533673735, "post_id": 51734381, "comment_id": 90430630, "body": "Feel free to accept this answer (even if you wrote it) if it, indeed, solved your problem. We encourage self-answers and attempts to rescue useful answers from the comments."}], "tags": [], "owner": {"reputation": 399, "user_id": 4774521, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/nlLAj.jpg?s=128&g=1", "display_name": "michaelf", "link": "https://stackoverflow.com/users/4774521/michaelf"}, "is_accepted": true, "score": 0, "last_activity_date": 1533673644, "last_edit_date": 1533673644, "creation_date": 1533671192, "answer_id": 51734381, "question_id": 51523154, "link": "https://stackoverflow.com/questions/51523154/excel-2016-365-vba-macros-firing-but-not-executing-working-save-button-vs-keybo/51734381#51734381", "title": "Excel 2016/365 VBA macros firing but not executing/working (Save button vs keyboard shortcut)", "body": "<p>@FunThomas solved my problem in the comments:</p>\n\n<blockquote>\n  <p>I once had a similar problem, but with 2010. It turned out it was\n  caused by the Google Drive-Plug-in for Microsoft Office - deinstalling\n  it solved my issue.</p>\n</blockquote>\n\n<p>The Google Drive plugin was the problem and deinstalling it solved my issue. Thanks!</p>\n"}], "owner": {"reputation": 399, "user_id": 4774521, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/nlLAj.jpg?s=128&g=1", "display_name": "michaelf", "link": "https://stackoverflow.com/users/4774521/michaelf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1171, "favorite_count": 0, "accepted_answer_id": 51734381, "answer_count": 1, "score": 0, "last_activity_date": 1533673644, "creation_date": 1532534069, "question_id": 51523154, "link": "https://stackoverflow.com/questions/51523154/excel-2016-365-vba-macros-firing-but-not-executing-working-save-button-vs-keybo", "title": "Excel 2016/365 VBA macros firing but not executing/working (Save button vs keyboard shortcut)", "body": "<p>I have a head scratcher. One client is using Excel 2016 (16.0.9126.2259) 32bit. Office version 1803 (they're on the semi-annual update channel) which are distributed using a Managed Computer corporate infrastructure.</p>\n\n<p>Snagit screen capture\n<a href=\"https://www.screencast.com/t/BPANvVq8\" rel=\"nofollow noreferrer\">https://www.screencast.com/t/BPANvVq8</a></p>\n\n<p>You can see the video above. When I <strong>click the Save button</strong>, the Workbook_BeforeSave event fires fine and the code runs as expected. Part of the custom save function is to hide all but one sheet (0:10 in the video and has the company logo and says \"scope\"), then save the file, then re-show all the sheets. Again this works as expected. (It also creates a backup of the file using ThisWorkbook.SaveAs, which works fine)</p>\n\n<p>However, when I <strong>click Control+s keyboard shortcut</strong> (0:23 in the video) to save the file, the Workbook_BeforeSave fires as expected and the code runs (and I can step through all the code) but nothing happens. The sheets don't hide, even though that code is executed. The file is not saved when ThisWorkbook.Save is executed. The backup file code runs but the SaveAs file is not created. </p>\n\n<p>The same code works fine on my test VM machine running v1806/64bit using either the save button or keyboard shortcut. I have not spun up a 32 bit vm yet to test that.</p>\n\n<p>All the VBA References are good and I don't think it's a coding issue as the macro runs fine when clicking the Save button. It just doesn't work when using the keyboard shortcut key (even though the event is firing). Very bizarre. Another user at the same client with the same computer build is experiencing the same thing. </p>\n\n<p>Any ideas? I've asked that they try to roll out v1806 sooner than later but not sure how fast they'll move on that. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1532534449, "post_id": 51523092, "comment_id": 90015360, "body": "What is the positioning of your tables - side-by-side or on top of each other? Is either filtered? Maybe a screenshot would help here."}, {"owner": {"reputation": 4956, "user_id": 5762332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhBOT.jpg?s=128&g=1", "display_name": "Magnetron", "link": "https://stackoverflow.com/users/5762332/magnetron"}, "edited": false, "score": 0, "creation_date": 1532534822, "post_id": 51523092, "comment_id": 90015559, "body": "I tried the first code in Excel 2013 and it worked, with onde table bellow and one by it&#39;s side. Maybe is a problem only with Office 365?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1532534883, "post_id": 51523092, "comment_id": 90015591, "body": "Without seeing your workbook, I suspect you&#39;ve already figured out the answer; <code>...problem is...the addition of a row in table1 affects table2...</code>.  You&#39;ll have to insert cells instead of rows."}, {"owner": {"reputation": 4956, "user_id": 5762332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhBOT.jpg?s=128&g=1", "display_name": "Magnetron", "link": "https://stackoverflow.com/users/5762332/magnetron"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1532535169, "post_id": 51523092, "comment_id": 90015730, "body": "@ashleedawg I tried the code and it adds cells and not rows. As I stated in my comment, it worked with two tables surrounding it."}, {"owner": {"reputation": 13, "user_id": 10134424, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/58r1o.jpg?s=128&g=1", "display_name": "MrCivilSC", "link": "https://stackoverflow.com/users/10134424/mrcivilsc"}, "edited": false, "score": 0, "creation_date": 1532541529, "post_id": 51523092, "comment_id": 90018923, "body": "Edited original post. The tables are on top of each other. Screenshot attached. Thanks for the comments!"}], "answers": [{"comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1532544099, "post_id": 51525580, "comment_id": 90020073, "body": "Wouldn&#39;t he also have to temporarily remove the <code>Totals</code> row from the upper table?"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1532545161, "post_id": 51525580, "comment_id": 90020539, "body": "Nope. Works fine for me regardless of totals row."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1532552448, "post_id": 51525580, "comment_id": 90023746, "body": "Thought I remembered something about the Totals row causing a problem when one tried to expand a table. Probably I was confusing that with something else."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1532556377, "post_id": 51525580, "comment_id": 90025220, "body": "Weird: Images aren&#39;t displaying. Why the heck not?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1532557372, "post_id": 51525580, "comment_id": 90025504, "body": "I see them here"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1532557439, "post_id": 51525580, "comment_id": 90025520, "body": "Interesting: I don&#39;t on my work PC, but I do on my personal one."}, {"owner": {"reputation": 13, "user_id": 10134424, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/58r1o.jpg?s=128&g=1", "display_name": "MrCivilSC", "link": "https://stackoverflow.com/users/10134424/mrcivilsc"}, "edited": false, "score": 0, "creation_date": 1532607853, "post_id": 51525580, "comment_id": 90045039, "body": "Thanks for the feedback! Yes, it works by moving the lower table to the side and the moving it back after inserting a row. I am still tinkering with relative displacement of the table because if I keep executing the move-table and then move-back after inserting a row eventually table 1 will bleed into table 2. I also need to dig up the code I&#39;ve seen to hide the macro actions so they&#39;re not visible as they&#39;re happening. However, my original issue is resolved-- thank you."}], "tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": true, "score": 1, "last_activity_date": 1532557945, "last_edit_date": 1532557945, "creation_date": 1532543607, "answer_id": 51525580, "question_id": 51523092, "link": "https://stackoverflow.com/questions/51523092/run-time-error-1004-for-excel-vba-tables/51525580#51525580", "title": "Run-time Error &#39;1004&#39; for Excel VBA tables", "body": "<p>That happens when the higher table has a footprint that is either narrower than the lower table, or the same size but not exactly aligned. What happens under the covers when you insert rows into a Table is that Excel not only moves the table rows at the insert point down but also tries to insert cells <em>under</em> the Table in order to move anything directly underneath the Table down by the same amount of rows so that space between the bottom of the Table and any content sitting below it is preserved.</p>\n\n<p>If you have another Table under that top Table that is either larger than the top Table or the same size but offset by some amount of columns, Excel tries to insert rows below the 'footprint' of the Top Table, but finds it can't do this, because this would move only some of the columns of the bottom table down, but not the others. </p>\n\n<p>You can see this behaviour in the following images.</p>\n\n<p>Here, I've got a Table and some non-table content below it:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9Vzex.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9Vzex.png\" alt=\"enter image description here\"></a></p>\n\n<p>Watch what happens when I insert a new row into the Table:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ddkK9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ddkK9.png\" alt=\"enter image description here\"></a></p>\n\n<p>Excel did it without complaining, but as you can see, only the cells immediately below the top table got moved downwards.</p>\n\n<p>Now, if I had a second Table under the first instead, I can't do this, because you simply can't shift <em>some</em> of the columns of a Table down a row while leaving the remainder in the old row. Indeed, here's the error message I get when I try:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Kqh4y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Kqh4y.png\" alt=\"enter image description here\"></a></p>\n\n<p>Some ways to program around this include:</p>\n\n<ul>\n<li>Switch the position of the Tables</li>\n<li>Amend your code to temporarily move the lower table somewhere else,\ndo the insert on the higher table, and then move it back again.</li>\n<li>Insert an entire row in the sheet (which also inserts new rows in the\nTables that get bisected)</li>\n</ul>\n"}], "owner": {"reputation": 13, "user_id": 10134424, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/58r1o.jpg?s=128&g=1", "display_name": "MrCivilSC", "link": "https://stackoverflow.com/users/10134424/mrcivilsc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1993, "favorite_count": 0, "accepted_answer_id": 51525580, "answer_count": 1, "score": 1, "last_activity_date": 1532557945, "creation_date": 1532533814, "last_edit_date": 1532541465, "question_id": 51523092, "link": "https://stackoverflow.com/questions/51523092/run-time-error-1004-for-excel-vba-tables", "title": "Run-time Error &#39;1004&#39; for Excel VBA tables", "body": "<p>I'm running Excel 365 and getting the following error when trying to run a macro that inserts rows into tables.</p>\n\n<blockquote>\n  <p>Run-time error '1004': This won't work because it would move cells in a table on your worksheet.</p>\n</blockquote>\n\n<p>I am trying to create a macro that would add rows to multiple tables. I'm using this to add a row before a total row:</p>\n\n<pre><code>ActiveSheet.ListObjects(\"Table1\").ListRows.Add AlwaysInsert:=True\n</code></pre>\n\n<p>I think the problem is that it returns that error because the addition of a row in table1 affects table2 and it can't insert a row there. Ultimately I want table 2 (and other tables) to have a row inserted so I've tried:</p>\n\n<pre><code>    ActiveSheet.ListObjects(\"Table1\").ListRows.Add AlwaysInsert:=True\n\n\nActiveSheet.ListObjects(\"Table2\").ListRows.Add AlwaysInsert:=True\n</code></pre>\n\n<p>But still returns the same error. I've tried reversing the order (adding to Table2 first) which executes the first command but then adding the row to table1 still returns the same error.</p>\n\n<p>How do I add rows to multiple tables simultaneously?</p>\n\n<p>The tables are stacked vertically, not side-by-side.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Fv6Mu.jpg\" rel=\"nofollow noreferrer\">speadsheet with tables screenshot</a></p>\n"}, {"tags": ["sql", "vba", "excel"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1532532402, "post_id": 51522569, "comment_id": 90014167, "body": "Have you tried <code>ROUND((a_price * (1.00 - &quot; &amp; percent &amp; &quot;)), 2)</code> instead of <code>ROUND((a_price * (1.00 - percent)), 2)</code>?"}, {"owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 1, "creation_date": 1532532410, "post_id": 51522569, "comment_id": 90014174, "body": "What is the data type of the field in the SQL table?"}, {"owner": {"reputation": 2115, "user_id": 2892459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c84b25b3f08b68115401cbd17a215ac?s=128&d=identicon&r=PG&f=1", "display_name": "Shania", "link": "https://stackoverflow.com/users/2892459/shania"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1532532563, "post_id": 51522569, "comment_id": 90014270, "body": "@Mistella yes I have, that did not work, still gave me a type mismatch"}, {"owner": {"reputation": 2115, "user_id": 2892459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c84b25b3f08b68115401cbd17a215ac?s=128&d=identicon&r=PG&f=1", "display_name": "Shania", "link": "https://stackoverflow.com/users/2892459/shania"}, "reply_to_user": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1532532640, "post_id": 51522569, "comment_id": 90014324, "body": "@Jaberwocky I have the call to extractInfo() inside the for loop, the SQL table should have doubles in there"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1532532648, "post_id": 51522569, "comment_id": 90014331, "body": "Have you tried substituting a hard-coded value to verify that the SQL works as intended?"}, {"owner": {"reputation": 2115, "user_id": 2892459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c84b25b3f08b68115401cbd17a215ac?s=128&d=identicon&r=PG&f=1", "display_name": "Shania", "link": "https://stackoverflow.com/users/2892459/shania"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1532532739, "post_id": 51522569, "comment_id": 90014383, "body": "@Mistella yup! the SQL works, for instance if I have ROUND(a_price - (a_price * .10), 2), it works just fine. It takes 10% off and puts it in the output file"}, {"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1532532830, "post_id": 51522569, "comment_id": 90014440, "body": "Is this using SQL/SSMS server? If so why not use debug to copy the content of StrQuery into SSMS and run the query here. You can then play around with the syntax until it works correctly."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1532532845, "post_id": 51522569, "comment_id": 90014451, "body": "Also consider using actual ADODB command and parameters instead of concatenating parameter values into your command string."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1532532862, "post_id": 51522569, "comment_id": 90014468, "body": "Percent is a keyword, so I definitely wouldn&#39;t suggest using it as a field-name. Also, you haven&#39;t given the <i>output field</i> a name?"}, {"owner": {"reputation": 2115, "user_id": 2892459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c84b25b3f08b68115401cbd17a215ac?s=128&d=identicon&r=PG&f=1", "display_name": "Shania", "link": "https://stackoverflow.com/users/2892459/shania"}, "edited": false, "score": 0, "creation_date": 1532533011, "post_id": 51522569, "comment_id": 90014530, "body": "I have tried both changing the name of the variable and also [percent]. The query works completely fine with a hard coded value but there is a just a data type issue which I can&#39;t figure out how to fix"}, {"owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1532533052, "post_id": 51522569, "comment_id": 90014560, "body": "This is getting to far.  Judging by the actual error, the problem is in the VBA code, not in the query.  Check the cell type and make sure that matches up with your data type."}, {"owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1532534129, "post_id": 51522569, "comment_id": 90015195, "body": "Sorry, to be clear the previous comment was based on the mismatch error, not the original error.  @Shania It would always be helpful for you to step through your code so you can tell people where it&#39;s failing as well.  The first error you mentioned sounds like an SQL error, the second one is definitely a VBA error.  All that being said, you need to set up error traps in your code."}], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1532533672, "post_id": 51523008, "comment_id": 90014926, "body": "3...2...1... waiting for a joke for Mr.Null and Mrs.Null."}, {"owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1532533720, "post_id": 51523008, "comment_id": 90014959, "body": "@Vityata What&#39;s the joke?  I like jokes :)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 2, "creation_date": 1532533832, "post_id": 51523008, "comment_id": 90015029, "body": "This one - <a href=\"https://xkcd.com/327/\" rel=\"nofollow noreferrer\">xkcd.com/327</a> . It is considered a bad practice to concatenate variables in SQL. The good practice is to pass it as a parameter, thus to avoid possible SQL injection."}, {"owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1532533923, "post_id": 51523008, "comment_id": 90015082, "body": "Hah, I like that one :)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1532534104, "post_id": 51523008, "comment_id": 90015183, "body": "For the good practice, you may refer to this article - <a href=\"https://www.vitoshacademy.com/automagic-secure-adodb/\" rel=\"nofollow noreferrer\">vitoshacademy.com/automagic-secure-adodb</a> , written by @Mathieu (also present in the comments of the Q here) - disclaimer - the site is mine."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1532536235, "post_id": 51523008, "comment_id": 90016239, "body": "Gosh I completely missed that <code>percent</code> was a local. +1 ...though, as noted above, this code is vulnerable to malicious UPC strings."}, {"owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1532536314, "post_id": 51523008, "comment_id": 90016280, "body": "@MathieuGuindon any +1s I get from you is like +1000 in my books ;)"}], "tags": [], "owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "is_accepted": false, "score": 1, "last_activity_date": 1532536250, "last_edit_date": 1532536250, "creation_date": 1532533575, "answer_id": 51523008, "question_id": 51522569, "link": "https://stackoverflow.com/questions/51522569/using-input-from-worksheet-in-a-query-in-a-macro/51523008#51523008", "title": "Using Input from Worksheet in a Query in a Macro", "body": "<p>You're using <code>percent</code> in your query string as a string.  </p>\n\n<p>If you want to use the variable value, you need to do this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>StrQuery = \"SELECT 'N' as Division, zzeupcnr.style as Style, color_code as Color, ' ' as label_code, dimension as Dimension, ROUND((a_price * (1.00 - \" &amp; percent &amp; \")), 2), ret_price \" &amp; _\n        \"FROM zzeupcnr JOIN zzxstylr \" &amp; _\n        \"ON zzeupcnr.style = zzxstylr.style \" &amp; _\n        \"WHERE upc = '\" &amp; upc &amp; \"'\"\n</code></pre>\n\n<p>Note the <code>\" &amp; percent &amp; \"</code></p>\n"}], "owner": {"reputation": 2115, "user_id": 2892459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c84b25b3f08b68115401cbd17a215ac?s=128&d=identicon&r=PG&f=1", "display_name": "Shania", "link": "https://stackoverflow.com/users/2892459/shania"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1532536250, "creation_date": 1532532154, "last_edit_date": 1532532809, "question_id": 51522569, "link": "https://stackoverflow.com/questions/51522569/using-input-from-worksheet-in-a-query-in-a-macro", "title": "Using Input from Worksheet in a Query in a Macro", "body": "<p>I am trying to take the percent column, column 3, from the \"input\" file and use that to take a discount on a price and put that price in the output file, one by one in column 7. </p>\n\n<p>I pass the SQL connection to a function, a UPC value that looks up information in a database, and then the percent value (a Double) as input.</p>\n\n<p>However, I keep getting the error \"Incorrect syntax near the keyword percent\". I have tried renaming the percent variable, and also using the Val() function (as you can see in the code).</p>\n\n<p>If I take the Val() out, I get a type mismatch error</p>\n\n<p><em>Basically</em>: I cannot figure out how to use an input for \"percent\" such as .10 in my Query.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code> For i = 1 To 381\n     wrkb.Worksheets(\"Output\").Cells(i + 1, 2).CopyFromRecordset extractInfo(cnn, wrkb.Worksheets(\"Input\").Cells(i, 2).Value, Val(wrkb.Worksheets(\"Input\").Cells(i, 3).Value))\nNext i\n\n\nFunction extractInfo(cnn As ADODB.Connection, upc As String, percent As Double) As ADODB.Recordset\n\n'Initializes variables\n\nDim rst As New ADODB.Recordset\nDim StrQuery As String\n\n'The query to run, feed the UPC value you acquired to then get all the other variables\nStrQuery = \"SELECT 'N' as Division, zzeupcnr.style as Style, color_code as Color, ' ' as label_code, dimension as Dimension, ROUND((a_price * (1.00 - percent)), 2), ret_price \" &amp; _\n        \"FROM zzeupcnr JOIN zzxstylr \" &amp; _\n        \"ON zzeupcnr.style = zzxstylr.style \" &amp; _\n        \"WHERE upc = '\" &amp; upc &amp; \"'\"\n\n'Performs the actual query\nrst.Open StrQuery, cnn\n\nSet extractInfo = rst 'Stores result\n</code></pre>\n"}, {"tags": ["vba", "excel", "named-ranges"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 1, "creation_date": 1532532184, "post_id": 51522460, "comment_id": 90014014, "body": "I think it should be &quot;ActiveCell&quot;, not &quot;Active.Cell&quot;...."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1532532389, "post_id": 51522460, "comment_id": 90014158, "body": "Write <code>Destination:= ActiveCell</code> in your code?"}], "answers": [{"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 2, "last_activity_date": 1532532467, "creation_date": 1532532467, "answer_id": 51522669, "question_id": 51522460, "link": "https://stackoverflow.com/questions/51522460/vba-excel-macro-destination-range-active-cell-instead-of-named-range/51522669#51522669", "title": "VBA Excel MACRO-Destination:=RANGE Active Cell instead of &quot;Named&quot; Range", "body": "<p>You mean you want the origin cell of the QueryTable to be where ever the active cell is?</p>\n\n<pre><code>Sub DestinationCell()\n   With ActiveSheet.QueryTables.Add(Connection:= _\n    \"TEXT;\\\\mpls.ucare.pvt\\\\PB 67311 FS.csv\" _\n    , Destination:=Application.ActiveCell)\nEnd Sub \n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 10128780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OLzZi.jpg?s=128&g=1", "display_name": "LittleZenGirl", "link": "https://stackoverflow.com/users/10128780/littlezengirl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 992, "favorite_count": 0, "accepted_answer_id": 51522669, "answer_count": 1, "score": 0, "last_activity_date": 1532532662, "creation_date": 1532531862, "last_edit_date": 1532532250, "question_id": 51522460, "link": "https://stackoverflow.com/questions/51522460/vba-excel-macro-destination-range-active-cell-instead-of-named-range", "title": "VBA Excel MACRO-Destination:=RANGE Active Cell instead of &quot;Named&quot; Range", "body": "<p>Simply needing to point (RANGE) to the active cell in active worksheet. \nDestination:=Range(\"$A$1\") needs to read \"Activecell\", somehow. I can't seem to get it to work. Thanks for any assistance!</p>\n\n<pre><code>Sub DestinationCell\n   With ActiveSheet.QueryTables.Add(Connection:= _\n    \"TEXT;\\\\mpls.ucare.pvt\\\\PB 67311 FS.csv\" _\n    , Destination:=Range(\"$A$1\"))    \nEnd sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "runtime-error"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1532531506, "post_id": 51522263, "comment_id": 90013513, "body": "<code>ColNum = ws.Cells.Find(...</code> perhaps?"}, {"owner": {"reputation": 3, "user_id": 10134127, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209567823551148/picture?type=large", "display_name": "Kiss Ferenc", "link": "https://stackoverflow.com/users/10134127/kiss-ferenc"}, "edited": false, "score": 0, "creation_date": 1532531912, "post_id": 51522263, "comment_id": 90013822, "body": "@Jeeped A million thanks. It was indeed that. I can&#39;t believe I missed this. Not sure if I should delete this question or not, as it seems like I need to up my syntax game only..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1532532349, "post_id": 51522263, "comment_id": 90014123, "body": "Your code shouldn&#39;t be assuming that <code>Range.Find</code> will return a valid <code>Range</code> reference, which is what it does when a <code>.Column</code> member call is chained to the result - when <code>.Find</code> returns <code>Nothing</code>, you get error 91. <i>In this case</i> it was because you weren&#39;t looking on the right sheet, but in <i>most cases</i>, it&#39;s just the code assuming <code>Range.Find</code> will find what it&#39;s looking for."}], "answers": [{"tags": [], "owner": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "is_accepted": true, "score": 0, "last_activity_date": 1532536123, "creation_date": 1532536123, "answer_id": 51523700, "question_id": 51522263, "link": "https://stackoverflow.com/questions/51522263/excel-vba-run-time-error-91-using-find/51523700#51523700", "title": "Excel VBA run-time error 91 using find", "body": "<p>Yes, it is in the referencing the other sheet indeed. When you have just <code>Cells</code> you are still referring to the current worksheet. It should be like this:</p>\n\n<pre><code>ColNum = ws.Cells.Find(year, ws.Range(\"B67\"), xlValues, , xlByRows, xlNext).Column\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10134127, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209567823551148/picture?type=large", "display_name": "Kiss Ferenc", "link": "https://stackoverflow.com/users/10134127/kiss-ferenc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 519, "favorite_count": 0, "accepted_answer_id": 51523700, "answer_count": 1, "score": 0, "last_activity_date": 1532536123, "creation_date": 1532531326, "question_id": 51522263, "link": "https://stackoverflow.com/questions/51522263/excel-vba-run-time-error-91-using-find", "title": "Excel VBA run-time error 91 using find", "body": "<p>I looked at a lot of questions on the site, but none seemed to be my specific problem. Everyones problem seems to be not using \"set\", but as you can see below I did that already. </p>\n\n<p>The code is storing a year from the main sheet (well technically year -1, but same thing). And the find should look for that specific year's column on another sheet. I tried many different versions, but none seems to work (e.g. not storing the worksheet in a variable but naming it in the find function). I would like to use this variable to update a chart and the column number would help me to adjust the chart's range dynamically based on the specified year. </p>\n\n<p>I know the problem is coming from referencing to another sheet, because if I simply enter the year numbers on the \"main sheet\" and searching there, it has no problem executing (referenced sheet is not protected - checked that as well)</p>\n\n<pre><code>Dim year As Integer\nDim ws As Worksheet\nSet ws = Worksheets(\"Sheet 1\")\nyear = Worksheets(\"Main sheet\").Cells(4, 18).Value - 1\nColNum = Cells.Find(year, ws.Range(\"B67\"), xlValues, , xlByRows, xlNext).Column\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1532531807, "post_id": 51522241, "comment_id": 90013737, "body": "Presuming that all your code is in the same module? declare a public variable at the top of the module (i.e. <code>Public iRowNum as Long</code>). You can set this variable to a row number and use it across your code (i.e. <code>Range(&quot;A&quot; &amp; iRowNum &amp; &quot;:AC&quot; &amp; iRowNum).Copy</code>)"}, {"owner": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1532532212, "post_id": 51522241, "comment_id": 90014032, "body": "@Zac Thank you! I will see what i can implement. All code is in the same Module."}], "answers": [{"comments": [{"owner": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "edited": false, "score": 0, "creation_date": 1532532252, "post_id": 51522479, "comment_id": 90014066, "body": "This is amazing! Im going to see if i can squeeze this into my worksheet now. Ill report back"}, {"owner": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "edited": false, "score": 0, "creation_date": 1532532396, "post_id": 51522479, "comment_id": 90014162, "body": "How would i implement the <code>i</code> value in this? <code>range(&quot;A30:AC30&quot;).Select</code>. The way im looking at this needs to be <code>range(&quot;A &amp; ThisWorkbook.i : AC &amp; ThisWorkbook.i &quot;).Address</code> however you cannot nest that inside the &quot; &quot; marks"}, {"owner": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "edited": false, "score": 0, "creation_date": 1532532865, "post_id": 51522479, "comment_id": 90014470, "body": "Thank you for the update. It seems thats cracked it. Im going to implement your suggestions and @CLRs to help tidy it up. Out of interest. The <code>i</code> value i assume sets itself to 30 whenever the workbook is opened right? Or is that stored permanently?"}, {"owner": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "edited": false, "score": 0, "creation_date": 1532533310, "post_id": 51522479, "comment_id": 90014723, "body": "Im getting the following error when trying to run the &quot;InsertNewBill&quot; button. Any advice: &quot;Method or data member not found&quot; for <code>ThisWorkbook.i + 1</code>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "edited": false, "score": 0, "creation_date": 1532536017, "post_id": 51522479, "comment_id": 90016142, "body": "Have you put the ThisWorkbook code in the ThisWorkbook  not in a standard module?"}, {"owner": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "edited": false, "score": 0, "creation_date": 1532539112, "post_id": 51522479, "comment_id": 90017677, "body": "That solved it, thank you. I feel stupid but thank you so much for this"}, {"owner": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "edited": false, "score": 0, "creation_date": 1532540348, "post_id": 51522479, "comment_id": 90018301, "body": "Is there any way of getting this value the value of i to store permanently when saving and re-opening the sheet?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "edited": false, "score": 0, "creation_date": 1532540440, "post_id": 51522479, "comment_id": 90018353, "body": "The latest i? Write it to a sheet cell on workbook close event and read it from the same cell in the workbook open event."}, {"owner": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "edited": false, "score": 0, "creation_date": 1532540761, "post_id": 51522479, "comment_id": 90018521, "body": "Done, you sir are the best! Thank you"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "edited": false, "score": 0, "creation_date": 1532540799, "post_id": 51522479, "comment_id": 90018540, "body": "No worries. Glad it helped."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1532532502, "last_edit_date": 1532532502, "creation_date": 1532531916, "answer_id": 51522479, "question_id": 51522241, "link": "https://stackoverflow.com/questions/51522241/excel-vba-increment-range-by-1-across-subs/51522479#51522479", "title": "Excel VBA Increment Range by 1 across Subs", "body": "<p>Use a public variable and concatenate that into your address. Initialize the value as, say 30, in the workbook open event.</p>\n\n<p>ThisWorkbook:</p>\n\n<pre><code>Option Explicit\nPublic i As Long\nPrivate Sub Workbook_Open()\n    i = 30\nEnd Sub\n</code></pre>\n\n<p>Standard module:</p>\n\n<pre><code>Option Explicit\nPrivate Sub button2_Click()\n    ThisWorkbook.i = ThisWorkbook.i + 1\n    Debug.Print ActiveSheet.Range(\"E\" &amp; ThisWorkbook.i &amp; \":F\" &amp; ThisWorkbook.i).Address\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "edited": false, "score": 0, "creation_date": 1532532713, "post_id": 51522585, "comment_id": 90014363, "body": "Thank you for the input CLR. is there any reason why using select and Activate is a bad option? Unfortunately, that was all recorded using macro input so may be why it was not ideal. Apologies. I will try to implement your suggestions and see how it goes :)"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "edited": false, "score": 1, "creation_date": 1532533046, "post_id": 51522585, "comment_id": 90014553, "body": "Have a read of: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "edited": false, "score": 0, "creation_date": 1532533137, "post_id": 51522585, "comment_id": 90014626, "body": "I will, thank you for all your help with this. Thank you for all your support :)"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1532533168, "post_id": 51522585, "comment_id": 90014642, "body": "Reason why you don&#39;t want to use <code>Select</code> and <code>Activate</code>.. well simply because they are pointless when it comes to VBA. Because you already have the object, you can reference the cell\\range\\sheet directly and leave VBA to sort the rest out for you (power of using objects). Also because they take time and resource for no apparent reason. One of the most pointless functionality in VBA"}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 2, "last_activity_date": 1532532218, "creation_date": 1532532218, "answer_id": 51522585, "question_id": 51522241, "link": "https://stackoverflow.com/questions/51522241/excel-vba-increment-range-by-1-across-subs/51522585#51522585", "title": "Excel VBA Increment Range by 1 across Subs", "body": "<p>You should try to stop using <code>Select</code> and <code>Activate</code> - in this case you can just <code>Copy</code> the Range:</p>\n\n<pre><code>Range(cells(30,\"A\"),cells(30,\"AC\")).Copy\n</code></pre>\n\n<p>To add i as an offset, you could use:</p>\n\n<pre><code>Range(cells(30+i,\"A\"),cells(30+i,\"AC\")).Copy\n</code></pre>\n\n<p>Or you could use: </p>\n\n<pre><code>Range(cells(30,\"A\"),cells(30,\"AC\")).Offset(i,0).Copy\n</code></pre>\n\n<p>To make i work across other Subs in the Workbook, declare it <code>Public</code>.</p>\n\n<p>Unless you're sure the value will remain low, I'd suggest declaring it as a <code>Long</code>, not an <code>Integer</code>.</p>\n\n<p>For the <code>Set CellRange = ActiveSheet.Range(\"E7:F30\")</code> setting, you could use:</p>\n\n<pre><code>Set CellRange = ActiveSheet.Range(\"E7:F\" &amp; 30 + i)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "is_accepted": false, "score": 0, "last_activity_date": 1532545604, "creation_date": 1532545604, "answer_id": 51526030, "question_id": 51522241, "link": "https://stackoverflow.com/questions/51522241/excel-vba-increment-range-by-1-across-subs/51526030#51526030", "title": "Excel VBA Increment Range by 1 across Subs", "body": "<p>For those interested. Here is the VBA that i ended up using as it fits my purpose.</p>\n\n<pre><code>Sub InsertNewBill_Click()\nDim rngCopy As range\nDim rngPaste As range\nDim clearCell As range\n\ni = Cells(30, 1) + 1\n    Cells(30, 1) = i\n\nActiveSheet.range(\"A\" &amp; i &amp; \":AD\" &amp; i).Insert\n\nSet rngPaste = range(\"A\" &amp; i &amp; \":AD\" &amp; i)\nSet rngCopy = ActiveSheet.range(\"A\" &amp; i - 1 &amp; \":AD\" &amp; i - 1)\n\nrngCopy.Copy\nrngPaste.PasteSpecial Paste:=xlPasteAll\n\nWith ActiveWorkSheet\n    Cells(i, 1).ClearContents\nEnd With\n\nCall DeleteTickBoxes_Click\n\nEnd Sub\n</code></pre>\n\n<p>*</p>\n\n<pre><code>Private Sub DeleteTickBoxes_Click()\n\n'Variables\nDim c As CheckBox\nDim CellRange As range\nDim cel As range\n\ni = Cells(30, 1)\n\nSet CellRange = ActiveSheet.range(\"F\" &amp; i &amp; \":G\" &amp; i)\n\n'Delete Checkboxes within the specified range above on the ActiveSheet Only\nFor Each c In ActiveSheet.CheckBoxes\nIf Not Intersect(c.TopLeftCell, CellRange) Is Nothing Then\nc.Delete\nEnd If\n\nNext\n\n'Insert New Checkboxes and Assign to a specified link cell using the offset\nFor Each cel In CellRange\n    Set c = ActiveSheet.CheckBoxes.Add(cel.Left, cel.Top, 30, 6) 'you can adjust left, top, height, width to your needs\n    With c\n        'Clears the textbox so it has no text\n        .Caption = \"\"\n\n        'Offset works by offsetting (Row offset, Column Offset) and accepts positive for down/right and negative for left/up,\n        'keep in not that the linked cells will automatically populate with true/false\n        .LinkedCell = cel.Offset(0, -4).Address\n\n    End With\n\nNext\nCall CentreCheckbox_Click\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1403, "favorite_count": 0, "accepted_answer_id": 51522479, "answer_count": 3, "score": 0, "last_activity_date": 1532545604, "creation_date": 1532531267, "question_id": 51522241, "link": "https://stackoverflow.com/questions/51522241/excel-vba-increment-range-by-1-across-subs", "title": "Excel VBA Increment Range by 1 across Subs", "body": "<p>Due to the last question not being very clear on my part. I am novice and will need a bit of guidence in how to implement any answers.</p>\n\n<p>I currently have the following code spread over different buttons and therefore different Subs. For the sake of clarity, I have seperated the ranges that i need to increment by 1 from the code and boldened the values i need to count up by 1 each button press. I appreciate this breaks the format, I apologise. </p>\n\n<p>The number increase will occur after clicking the \"InsertNewBill\" button:</p>\n\n<pre><code>Private Sub InsertNewBill_Click()\n    'I AM USING i TO STORE THE CELL INCREMENT, IT CURRENTLY DOES NOTHING**\n    Dim i As Integer\n</code></pre>\n\n<p><em>range(<strong>\"A30:AC30\"</strong>).Select</em></p>\n\n<p><em>range(<strong>\"AC30\"</strong>).Activate</em></p>\n\n<pre><code>    Selection.Copy\n    Selection.Insert Shift:=xlDown\nEnd Sub\n\nPrivate Sub DeleteTickBoxes_Click()\n    'Variables\n    Dim c As CheckBox\n    Dim CellRange As Range\n    Dim cel As Range\n</code></pre>\n\n<p>Set CellRange = ActiveSheet.Range(\"E7:<strong>F30</strong>\") </p>\n\n<pre><code>    'Delete Checkboxes within the specified range above on the ActiveSheet Only\n    For Each c In ActiveSheet.CheckBoxes\n        If Not Intersect(c.TopLeftCell, CellRange) Is Nothing Then\n            c.Delete\n        End If\n    Next    \n    'Insert New Checkboxes and Assign to a specified link cell using the offset\n    For Each cel In CellRange\n        'you can adjust left, top, height, width to your needs\n        Set c = ActiveSheet.CheckBoxes.Add(cel.Left, cel.Top, 30, 6)\n        With c   'Clears the textbox so it has no text\n            .Caption = \"\"\n            'Offset works by offsetting (Row offset, Column Offset) and accepts\n            'positive for down/right and negative for left/up,\n            'keep in not that the linked cells will automatically populate with true/false\n            .LinkedCell = cel.Offset(0, -4).Address\n        End With\n    Next\n    Call CentreCheckbox_Click\nEnd Sub\n</code></pre>\n\n<p>I need all boldened values to increase by one. I.e from F30 to F31  and A30:AC30 to A31:AC31.\nThis value also needs to be carried across from the InsertNewBill_Click sub to the DeleteTickBoxes_Click sub.</p>\n\n<p>I assume i will need to remove the Private sub and possibly have a public integer variable? \nIm just not sure how to implement increasing only the number by 1 after each button click.</p>\n\n<p>All your help is appreciated</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1532529529, "post_id": 51521576, "comment_id": 90012087, "body": "Loop through the cells in the range and do a <code>MyCell.Value = MyCell.Value + 1</code> ?"}, {"owner": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1532529563, "post_id": 51521576, "comment_id": 90012108, "body": "I was thinking of combining both the DeleteTickBox and InsertNewBill subs together to allow the carrying over of the integer increment. This way i could have all of this happen under one button press. I just wanted to see if i can get the integer increase sorted out"}, {"owner": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1532529606, "post_id": 51521576, "comment_id": 90012145, "body": "@tigeravatar If i was to increase the cell value by 1. How would i then reference that in  say <code>range(&quot;A30:AC30&quot;).Select</code>. I apologise, im relatively new to this"}], "answers": [{"comments": [{"owner": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "edited": false, "score": 1, "creation_date": 1532529773, "post_id": 51521686, "comment_id": 90012270, "body": "This is ingenious! Thank you. I will put this in a test. Thank you so far. Okay, right. Im a little stuck on implementing this into my current project. Can i be a huge pain and ask for some pointers. I apologise"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "edited": false, "score": 1, "creation_date": 1532529980, "post_id": 51521686, "comment_id": 90012431, "body": "@Batteredburrito - you are welcome. I hope it works :)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1532530508, "post_id": 51521686, "comment_id": 90012792, "body": "@Jeeped - yup, the union can be avoided, if <code>Set unionRange = ws.Range(&quot;A30:AC31&quot;)</code>. Still, showing how unions work makes the example more flexible, I guess."}, {"owner": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "edited": false, "score": 0, "creation_date": 1532530620, "post_id": 51521686, "comment_id": 90012858, "body": "@Vityata Because i am very new to this. Im going to make some further edits to the original post because i dont think ive been very clear with my intentions. This definitely works to an extent but i dont think it does exactly what i need currently"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "edited": false, "score": 1, "creation_date": 1532530694, "post_id": 51521686, "comment_id": 90012905, "body": "@Batteredburrito - Please do not change the op to the point that it renders existing answers invalid. Close off this question by marking an answer and ask a new question."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1532530913, "post_id": 51521686, "comment_id": 90013057, "body": "@Jeeped - thanks for following :) etBatteredburrito - it is indeed better to ask a new question."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 3, "last_activity_date": 1532530319, "last_edit_date": 1532530319, "creation_date": 1532529655, "answer_id": 51521686, "question_id": 51521576, "link": "https://stackoverflow.com/questions/51521576/increment-cell-values-in-a-range-by-1-with-vba-excel/51521686#51521686", "title": "Increment Cell Values in a Range by 1 with VBA Excel", "body": "<pre><code>Sub TestMe()\n\n    Dim unionRange As Range\n    Dim ws As Worksheet\n    Set ws = Worksheets(1)\n\n    With ws\n        'as an alternative -&gt; Set unionRange = ws.Range(\"A30:AC31\")\n        Set unionRange = Union(.Range(\"F30:F31\"), .Range(\"A30:AC30\"), .Range(\"A31:AC31\"))\n    End With\n\n    Dim myCell As Range\n    For Each myCell In unionRange\n        If myCell.Font.Bold Then\n            myCell = myCell + 1\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n\n<ul>\n<li><code>unionRange</code> is a <code>Union()</code> of the 3 ranges;</li>\n<li><code>myCell</code> is a Range and used to loop through all the cells in <code>unionRange</code>;</li>\n<li><code>myCell = myCell + 1</code> increments the value by 1.</li>\n<li><code>If myCell.Font.Bold Then</code> checks whether the cell is <strong>bold</strong>.</li>\n</ul>\n"}], "owner": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9212, "favorite_count": 0, "accepted_answer_id": 51521686, "answer_count": 1, "score": 2, "last_activity_date": 1532530874, "creation_date": 1532529312, "last_edit_date": 1532530874, "question_id": 51521576, "link": "https://stackoverflow.com/questions/51521576/increment-cell-values-in-a-range-by-1-with-vba-excel", "title": "Increment Cell Values in a Range by 1 with VBA Excel", "body": "<p>Im currently trying to implement an insert new row value and a automatic checkbox inserter.</p>\n\n<p>I currently have the following code spread over different buttons and therefore different Subs. I have boldened the key information that i will need to increment by 1 cell. This will occur after clicking the \"InsertNewBill\" button.:</p>\n\n<pre><code>Private Sub InsertNewBill_Click()\n    'I AM USING i TO STORE THE CELL INCREMENT, IT CURRENTLY DOES NOTHING**\n    Dim i As Integer\n    '**range(\"A30:AC30\").Select**\n    '**range(\"AC30\").Activate**\n    Selection.Copy\n    Selection.Insert Shift:=xlDown\nEnd Sub\n\nPrivate Sub DeleteTickBoxes_Click()\n    'Variables\n    Dim c As CheckBox\n    Dim CellRange As Range\n    Dim cel As Range\n    Set CellRange = ActiveSheet.Range(\"E7:**F30**\")    \n    'Delete Checkboxes within the specified range above on the ActiveSheet Only\n    For Each c In ActiveSheet.CheckBoxes\n        If Not Intersect(c.TopLeftCell, CellRange) Is Nothing Then\n            c.Delete\n        End If\n    Next    \n    'Insert New Checkboxes and Assign to a specified link cell using the offset\n    For Each cel In CellRange\n        'you can adjust left, top, height, width to your needs\n        Set c = ActiveSheet.CheckBoxes.Add(cel.Left, cel.Top, 30, 6)\n        With c   'Clears the textbox so it has no text\n            .Caption = \"\"\n            'Offset works by offsetting (Row offset, Column Offset) and accepts\n            'positive for down/right and negative for left/up,\n            'keep in not that the linked cells will automatically populate with true/false\n            .LinkedCell = cel.Offset(0, -4).Address\n        End With\n    Next\n    Call CentreCheckbox_Click\nEnd Sub\n</code></pre>\n\n<p>I need all boldened values to increase by one. I.e from F30 to F31  and A30:AC30 to A31:AC31.\nThis value also needs to be carried across from the InsertNewBill_Click sub to the DeleteTickBoxes_Click sub.</p>\n\n<p>I assume i will need to remove the Private sub and possibly have a public integer variable? \nIm just not sure how to implement increasing only the number by 1 after each button click.</p>\n\n<p>All your help is appreciated</p>\n"}, {"tags": ["vba", "excel", "if-statement"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 5, "creation_date": 1532528691, "post_id": 51521315, "comment_id": 90011481, "body": "An <code>#N&#47;A</code> error is not <code>#N&#47;A!</code> and if best represented by <code>NA()</code>."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1532529270, "post_id": 51521315, "comment_id": 90011895, "body": "Or <code>=NV()</code> for the people using German language pack."}, {"owner": {"reputation": 11, "user_id": 10133737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1074d35a1fcfaa20d6ed036b370ebc44?s=128&d=identicon&r=PG&f=1", "display_name": "Aleoin", "link": "https://stackoverflow.com/users/10133737/aleoin"}, "edited": false, "score": 0, "creation_date": 1532532465, "post_id": 51521315, "comment_id": 90014210, "body": "Ah, thank you Jeeped.  I never noticed a difference before.  Yes, the final IF statement is IF(FALSE, #N/A, 1)"}], "owner": {"reputation": 11, "user_id": 10133737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1074d35a1fcfaa20d6ed036b370ebc44?s=128&d=identicon&r=PG&f=1", "display_name": "Aleoin", "link": "https://stackoverflow.com/users/10133737/aleoin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1532548660, "creation_date": 1532528542, "last_edit_date": 1532548660, "question_id": 51521315, "link": "https://stackoverflow.com/questions/51521315/if-statement-error-despite-the-check-being-false-and-the-value-if-false-being", "title": "IF statement error despite the check being FALSE and the [value_if_false] being 0 or 1", "body": "<p>For my own amusement I am trying to automate a project from work to learn more about excel vba.  For the primary tab of data, I have an import function that drags in the relevant columns from another sheet for columns A through J.  After that, there are a bunch of columns already set up to manipulate the the data being imported.</p>\n\n<p>One of the calculation columns is supposed to return a basic 0/1 flag if the related company has been a client for >20 years.  However, it ended up being a very slow UDF, so I wrapped it in an If statement to check if any other flags are false first so I can skip the slow calculation if the claim is already being eliminated.  It worked fine before I went back to tweaking the import macro.  Here is the function:</p>\n\n<pre><code>=IF( Q2*O2*N2 = 0, 0, IF(CompanyYears(J2, End_of_Claim_Period, Analysis_Width) &gt;= Valid_Co_Years, 1, 0))\n</code></pre>\n\n<p>So now after the data import the only two results the column gives are 0 and #VALUE!.  However, the 'evaluate function' step through confused me more.  Turns out that for every value error, the 3 flags from columns Q/O/N are 1.  So first the evaluate looks up and multiplies those 3 flags, gets 1=0 -> FALSE.  The next thing it does is resolve what the named range End_of_Claim_Period points to.  While it successfully changes it to a cell address, the outer IF statement's value_if_true changes from 0 to #N/A at the same time.  The inner if statement continues just fine to a result of 0 or 1, and finally the statement</p>\n\n<pre><code>=IF(FALSE, #N/A, 1)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>=IF(FALSE, #N/A, 0)\n</code></pre>\n\n<p>gets evaluated to #VALUE!.</p>\n\n<p>Also, if I try to filter that column to see only the rows with a #VALUE! response, it correctly reevaluates them to the appropriate 0/1 values.  I tried having the vba code filter then unfilter the row automatically but that leaves the errors in place still.</p>\n\n<p><strong>Update:</strong> While working on something else I came across a somewhat similar question here:  </p>\n\n<p><a href=\"https://stackoverflow.com/questions/32590616/excel-is-not-updating-cells-options-formula-workbook-calculation-set-to-aut\">Excel is not updating cells, options &gt; formula &gt; workbook calculation set to automatic</a></p>\n\n<p>I added Application.CalculateFull in at the end of the macro, which technically solved my problem, albeit for a notable performance hit.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9605, "user_id": 2316112, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/be4cb1c8d7aca21a590133546e7531a4?s=128&d=identicon&r=PG", "display_name": "Philipp Sander", "link": "https://stackoverflow.com/users/2316112/philipp-sander"}, "edited": false, "score": 1, "creation_date": 1532527951, "post_id": 51521014, "comment_id": 90010933, "body": "there is CLEARLY a hardcoded value in there. do you want to change that? then do it. however, having hardcoded values for something that clearly changes is pretty bad"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 8640156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79db2e97871a62814475215158d90095?s=128&d=identicon&r=PG&f=1", "display_name": "Hazat Bangurah", "link": "https://stackoverflow.com/users/8640156/hazat-bangurah"}, "edited": false, "score": 0, "creation_date": 1532527969, "post_id": 51521078, "comment_id": 90010949, "body": "yes mars is the month, thanks I will test this out now"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1532527890, "creation_date": 1532527890, "answer_id": 51521078, "question_id": 51521014, "link": "https://stackoverflow.com/questions/51521014/adjusting-code-for-the-month/51521078#51521078", "title": "Adjusting Code for the Month", "body": "<p>Assuming mar is the month and that the value is coming from Z4 and is already abbreviated then you would hold in a variable (not called Month as that is a function) and concatenate into the string for your file etc.</p>\n\n<pre><code>Dim monthAbbr As String\nmonthAbbr = Range(\"Z4\").Value\nSIFile = Quarter &amp; \"_si_allocation_audit__\" &amp; monthAbbr &amp;  \"__6_decimal_detail_sjmc.txt\"\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 8640156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79db2e97871a62814475215158d90095?s=128&d=identicon&r=PG&f=1", "display_name": "Hazat Bangurah", "link": "https://stackoverflow.com/users/8640156/hazat-bangurah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 51521078, "answer_count": 1, "score": 0, "last_activity_date": 1532527890, "creation_date": 1532527715, "question_id": 51521014, "link": "https://stackoverflow.com/questions/51521014/adjusting-code-for-the-month", "title": "Adjusting Code for the Month", "body": "<p>Good Morning,</p>\n\n<p>I have a code that pulls quarterly reports to run the macro, however I am running into an issue with changing the defined month. In the report used for the macro it contains the month and is subject to change. how do I adjust my code to switch the month.</p>\n\n<pre><code> Dim Quarter As String\n Dim Month As String\n Dim SIFile As String\n Dim SIData As String\n Dim SiName As String\n Dim FiName As String\n Dim MyQtr As String\n 'Defining the worksheet variables and the worksheet name\n Sheets(\"Summary\").Select\n Range(\"X4\").Select\n Quarter = Range(\"X4\").Value\n MyQtr = Range(\"AA4\").Value\n\n Range(\"Z4\").Select\n Month = Range(\"Z4\").Value\n\n SIFile = Quarter &amp; \"_si_allocation_audit__mar__6_decimal_detail_sjmc.txt\"\n SiName = Quarter &amp; \"_si_allocation_audit__mar__\"\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel", "for-loop", "multidimensional-array"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1532527805, "post_id": 51520971, "comment_id": 90010838, "body": "Why not use a pivot table?"}, {"owner": {"reputation": 145, "user_id": 4601655, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-bMOUaEZ_Yh4/AAAAAAAAAAI/AAAAAAAAAFM/oa9q6gxp9Q8/photo.jpg?sz=128", "display_name": "John Shaw", "link": "https://stackoverflow.com/users/4601655/john-shaw"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1532529821, "post_id": 51520971, "comment_id": 90012307, "body": "Yes, We could have the processor pivot table 50,000 line-item records in a new spreadsheet, but the data on this Sheet is in a workbook that I must be able to extract out of the Processor&#39;s File and place in a totally separate Aging Worksheet for Reporting Purposes to Directors at the Company.  After summarizing Deposits into 3 categories by the Acct Numbers listed, I then have to Age out the summarized Deps into Accounting Buckets based on the current date.  So, the 1st line item of $17,648.69 would be MFGWholesale Cat, 0~3 Day Bucket.  It&#39;s best it we do this via VBA"}, {"owner": {"reputation": 412, "user_id": 9984864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853e1965adbcfc68089abb6a77ed8780?s=128&d=identicon&r=PG", "display_name": "Guest", "link": "https://stackoverflow.com/users/9984864/guest"}, "edited": false, "score": 0, "creation_date": 1532538184, "post_id": 51520971, "comment_id": 90017215, "body": "Sort your array on the date using a Quicksort UDF that uses recursivity."}], "answers": [{"tags": [], "owner": {"reputation": 145, "user_id": 4601655, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-bMOUaEZ_Yh4/AAAAAAAAAAI/AAAAAAAAAFM/oa9q6gxp9Q8/photo.jpg?sz=128", "display_name": "John Shaw", "link": "https://stackoverflow.com/users/4601655/john-shaw"}, "is_accepted": false, "score": 0, "last_activity_date": 1532541929, "last_edit_date": 1532541929, "creation_date": 1532539292, "answer_id": 51524519, "question_id": 51520971, "link": "https://stackoverflow.com/questions/51520971/populating-2-dimension-vba-array-excel/51524519#51524519", "title": "Populating 2 Dimension VBA Array Excel", "body": "<blockquote>\n  <p>I found the Answer by tinkering. Array( i , 2) where 2 represents the 2nd column in the Range which is what I wanted.  Thanxs for anyone considering an Answer. </p>\n</blockquote>\n\n<pre><code>For j = LBound(rCol, 2) To UBound(rCol, 2)\n    Select Case rCol(i, 2)\n        Case MFGWholesale\n            ArrayMFG(i, 2) = rCol(i, 7) + ArrayMFG(i, 7)\n        Case DealerDirect\n            ArrayDD(i, 2) = rCol(i, 7) + ArrayDD(i, 7)\n        Case Retail\n            ArrayRetail(i, 2) = rCol(i, 7) + ArrayRetail(i, 7)\n    End Select\nNext j\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 4601655, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-bMOUaEZ_Yh4/AAAAAAAAAAI/AAAAAAAAAFM/oa9q6gxp9Q8/photo.jpg?sz=128", "display_name": "John Shaw", "link": "https://stackoverflow.com/users/4601655/john-shaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532541929, "creation_date": 1532527575, "last_edit_date": 1532537187, "question_id": 51520971, "link": "https://stackoverflow.com/questions/51520971/populating-2-dimension-vba-array-excel", "title": "Populating 2 Dimension VBA Array Excel", "body": "<p><a href=\"https://i.stack.imgur.com/wOtAP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wOtAP.png\" alt=\"enter image description here\"></a></p>\n\n<p>I've been somewhat stuck on creating and populating an array that takes each lineitem deposit in a row shown above and categorizes each deposit by the Acct listed under the Description Header.  There are 7 Columns depicted below.(7 Col)  </p>\n\n<p>The spreadsheet is updated daily and there can be up to 50,000 rows in an excel spreadsheet so \"For Next\" Loops aren't really optimal because after populating the Arrays by Acct Number, the next step is to Age the deposits by Date against the \"Today's Date\".  </p>\n\n<p>I get a result in the immediate window via debug.print, but the amts per Acct Number isn't adding up correctly.  I'm reaching out for help to see if anyone has any specific thoughts as to what I'm not getting here. </p>\n\n<pre><code>Option Explicit\nOption Compare Text\nOption Base 1\n\nConst MFGWholesale = 1628258400\nConst DealerDirect= 8900504722\nConst Retail = 8901054887\n</code></pre>\n\n<hr>\n\n<pre><code>Sub AccumulativeSum()\nDim Dest As Range\nDim i As Integer, j As Integer\nDim ArrayMFG() As Variant, ArrayDD() As Variant, ArrayRetail() As Variant\n\nDim rcnt As Integer\nDim ws As Worksheet\nSet ws = Worksheets(\"Trial\")\n\n'Turns off screen updating and auto calc to reduce process time\nWith Application\n.ScreenUpdating = False\n.Calculation = xlCalculationManual\nEnd With\n\n'unfilters if it's active BEFORE running the Array Process\nIf ws.FilterMode Then\n    ws.ShowAllData\nEnd If\n\nrcnt = ws.Range(\"ColSeven\").Rows.Count '&lt;-- Initial Row Count of ColSeven Range\nrCol = ws.Range(\"ColSeven\").Value2 '&lt; -- Value2 has it's advantages for arrays\n\n'Resizing the Arrays\nReDim ArrayMFG(1 To rcnt, 1 To 7)\nReDim ArrayDD(1 To rcnt, 1 To 7)\nReDim ArrayRetail(1 To rcnt, 1 To 7)\n\n'Group by Respective Bank Accts\nFor i = LBound(rCol, 1) To UBound(rCol, 1)\n\n    If Len(rCol(i, 2)) &lt;&gt; 10 Then\n        MsgBox \"The Description for Cell: B\" &amp; i + 3 &amp; \" [Column B Row \" &amp; i + 3 &amp; \"] must include a 10 digit Acct Number\"\n        Exit Sub\n    Else\n    End If\n\n    For j = LBound(rCol, 2) To UBound(rCol, 2)\n        Select Case rCol(i, 2)\n            Case MFGWholesale\n                ArrayMFG(i, j) = rCol(i, 7) + ArrayMFG(i, 7)\n            Case DealerDirect\n                ArrayDD(i, j) = rCol(i, 7) + ArrayDD(i, 7)\n            Case Retail\n                ArrayRetail(i, j) = rCol(i, 7) + ArrayRetail(i, 7)\n        End Select\n    Next j\nNext i\n\nDest.Value = Application.WorksheetFunction.Sum(ArrayMFG) \nDebug.Print Dest.Value\nDest.Value = Application.WorksheetFunction.Sum(ArrayDD)\nDebug.Print Dest.Value\nDest.Value = Application.WorksheetFunction.Sum(ArrayRetail)\nDebug.Print Dest.Value\n\nWith Application\n.ScreenUpdating = True\n.Calculation = xlCalculationAutomatic\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "button"], "comments": [{"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 1, "creation_date": 1532527909, "post_id": 51520916, "comment_id": 90010903, "body": "A button is a control.  You will not search for them by cell for position, more traditionally you will cycle through the objects on your worksheet and look for certain names, if you are looking for a particular button.  Buttons do not have a depressed or not &quot;state&quot; in VBA, when you click one it calls an event, that event is &lt;button name&gt;_click, so rather than bother to click the button for a user, you instead call it&#39;s button_click sub/function.  Make sense?  You need to post some code that you have attempted to create a button and act upon it."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1532528177, "post_id": 51520916, "comment_id": 90011110, "body": "You don&#39;t want to be randomly executing button code. You want to be sure of what code you are executing and therefore target  buttons. Hold the buttons in variables and use those."}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1532531251, "post_id": 51520916, "comment_id": 90013307, "body": "@JarBeans: Welcome to Stack Overflow: Please <a href=\"https://stackoverflow.com/tour\">take the tour</a> and read <a href=\"https://stackoverflow.com/help/how-to-ask\">How to ask a good question</a>, then edit your question to include the code, expected behaviour, and what is wrong... then we can try to help"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1532531273, "post_id": 51520916, "comment_id": 90013323, "body": "I Downvoted/voted to close because you didn&#39;t include a <a href=\"http://idownvotedbecau.se/nomcve/\" rel=\"nofollow noreferrer\">Minimal, Complete, Verifiable Example</a> , it looks like <a href=\"http://idownvotedbecau.se/noattempt/\" rel=\"nofollow noreferrer\">no attempt was made</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10133897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7283c40a03cd93d44a49639bb164e0af?s=128&d=identicon&r=PG&f=1", "display_name": "JarBeans", "link": "https://stackoverflow.com/users/10133897/jarbeans"}, "edited": false, "score": 0, "creation_date": 1532592315, "post_id": 51521432, "comment_id": 90035361, "body": "Thank you @tigeravatar it really help me and now I have a better understanding of how it works."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 1, "last_activity_date": 1532528908, "creation_date": 1532528908, "answer_id": 51521432, "question_id": 51520916, "link": "https://stackoverflow.com/questions/51520916/vba-macro-find-button-by-location-and-click-them/51521432#51521432", "title": "VBA macro : find button by location and &#39;click&#39; them", "body": "<p>Something like this could work for you:</p>\n\n<pre><code>Sub ClickButton(ByVal arg_rCells As Range)\n\n    Dim ws As Worksheet\n    Dim oOLE As OLEObject\n    Dim shp As Shape\n    Dim hButtons As Object\n\n    Set ws = arg_rCells.Parent\n    Set hButtons = CreateObject(\"Scripting.Dictionary\")\n\n    'ActiveX buttons\n    For Each oOLE In ws.OLEObjects\n        hButtons.Add oOLE.Name, oOLE.Name\n        If Not Intersect(arg_rCells, ws.Range(oOLE.TopLeftCell, oOLE.BottomRightCell)) Is Nothing Then\n            Run \"'\" &amp; ws.Parent.Name &amp; \"'!\" &amp; ws.CodeName &amp; \".\" &amp; oOLE.Name &amp; \"_Click\"\n        End If\n    Next oOLE\n\n    'Form Control buttons\n    For Each shp In ActiveSheet.Shapes\n        If Not hButtons.exists(shp.Name) Then\n            hButtons.Add shp.Name, shp.Name\n            If Not Intersect(arg_rCells, ws.Range(shp.TopLeftCell, shp.BottomRightCell)) Is Nothing Then\n                Run shp.OnAction\n            End If\n        End If\n    Next shp\n\nEnd Sub\n</code></pre>\n\n<p>And here's an example of how to call it (this will click a button if one exists in cell C3):</p>\n\n<pre><code>Sub tgr()\n\n    ClickButton ActiveSheet.Range(\"C3\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10133897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7283c40a03cd93d44a49639bb164e0af?s=128&d=identicon&r=PG&f=1", "display_name": "JarBeans", "link": "https://stackoverflow.com/users/10133897/jarbeans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "closed_date": 1532546328, "accepted_answer_id": 51521432, "answer_count": 1, "score": -3, "last_activity_date": 1532528908, "creation_date": 1532527420, "question_id": 51520916, "link": "https://stackoverflow.com/questions/51520916/vba-macro-find-button-by-location-and-click-them", "closed_reason": "Needs more focus", "title": "VBA macro : find button by location and &#39;click&#39; them", "body": "<p>I'm trying to du a macro. From a row index and a column index detect if there is one or more button on this cell and execute the code attached to this button.</p>\n\n<p>I have not found a 'find_button_by_location' method nor a 'button.execute_as_clicked'</p>\n\n<p>I wonder if anyone can help me with some suggestion.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["excel", "vba", "ms-office", "libraries"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1532527147, "post_id": 51520686, "comment_id": 90010343, "body": "Should automatically adapt to the available reference."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1532527206, "post_id": 51520686, "comment_id": 90010395, "body": "What do you need the Microsoft Word type library for? Also, unless your code is invoking features (objects/types, methods) of the type library that exist in 2016 but not in 2013, then your 2013 users will be able to run the code just fine."}, {"owner": {"reputation": 3, "user_id": 10133810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/071d3a47a42d65319b6001b1b3b5383c?s=128&d=identicon&r=PG&f=1", "display_name": "Galinowsky", "link": "https://stackoverflow.com/users/10133810/galinowsky"}, "edited": false, "score": 0, "creation_date": 1532527576, "post_id": 51520686, "comment_id": 90010668, "body": "I am not 100% sure what for but i think it is to run macro for convert excel cells to some raport in docx, anyway when user don&#39;t have this libraries uploaded there is no chance to open the document. When i started working on this sheet i was told to upload this libraries because ithe are neccesery."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1532528096, "post_id": 51520686, "comment_id": 90011042, "body": "Will have to know why that library is needed, you can work around some references by using late binding, it takes some awareness and will force the code to be different instances.  You can also try and add the GUID reference for the user when the workbook opens, that is another story."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1532530942, "post_id": 51520686, "comment_id": 90013077, "body": "If your code requires Microsoft Word, it won&#39;t run on a machine that doesn&#39;t have Microsoft Word - late-bound or not."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1532530962, "post_id": 51520686, "comment_id": 90013090, "body": "Also I don&#39;t think &quot;upload&quot; means what you think it does ;-)"}], "owner": {"reputation": 3, "user_id": 10133810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/071d3a47a42d65319b6001b1b3b5383c?s=128&d=identicon&r=PG&f=1", "display_name": "Galinowsky", "link": "https://stackoverflow.com/users/10133810/galinowsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 242, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1532527103, "creation_date": 1532526822, "last_edit_date": 1532527103, "question_id": 51520686, "link": "https://stackoverflow.com/questions/51520686/microsoft-word-16-0-library", "title": "microsoft word 16.0 library", "body": "<p>I am working on a calculation tool on excel 2013, but to run this on my version of Excel I was forced to reference a <em>Microsoft Word 16.0</em> library.</p>\n\n<p>Now as my tool is almost finished I was wondering if there is any way to compile this workbook to the normal 2013 version of Excel? Just to when a user wants to use this, they will be able to do that without referencing any external libraries?</p>\n\n<p>I was checking what libraries a default Excel 2013 project has, but there is no Microsoft Word library at all, so my idea to uncheck the 16.0 library and check an earlier version can't work.</p>\n\n<p>Any ideas how can I do this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1532527143, "post_id": 51520679, "comment_id": 90010338, "body": "do you have textboxes on every sheet?  If not, remove the worksheet loop and only do the count on &quot;LobbyCars&quot;.  Also rename your sub so there&#39;s no ambiguity with your named range (they are currently both named NumberOfRisers which might cause problems).  Also have your counter variables look at the specific sheet instead of ActiveSheet"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1532527308, "post_id": 51520679, "comment_id": 90010471, "body": "Also, maybe it&#39;s just here on SO, but your quotes look funky. Try this <code>Worksheets(&quot;LobbyCars&quot;).Range(&quot;NumberOfRisers&quot;) = counter</code>"}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 2, "last_activity_date": 1532529957, "creation_date": 1532529957, "answer_id": 51521780, "question_id": 51520679, "link": "https://stackoverflow.com/questions/51520679/how-to-count-two-differently-sized-text-boxes-on-a-spreadsheet/51521780#51521780", "title": "How to count two differently sized Text Boxes on a spreadsheet?", "body": "<p>Here's a <code>Function</code> that will count text boxes on a worksheet based on their name and visibility.</p>\n\n<pre><code>Private Function CountTextBoxes(txtBoxName As String, ws As Worksheet) As Integer\n    Dim i As Integer\n\n    If ws.Shapes.Count &gt; 0 Then\n        For i = 1 To ws.Shapes.Count\n            With ws.Shapes(i)\n                If .Type = msoTextBox And InStr(1, .Name, txtBoxName) And .Visible Then CountTextBoxes = CountTextBoxes + 1\n            End With\n        Next i\n    End If\n\nEnd Function\n\nSub CountMyTextBoxes()\n    Debug.Print CountTextBoxes(\"Elevator\", Sheets(\"Lobby Cars\"))\n    Debug.Print CountTextBoxes(\"Riser\", Sheets(\"Lobby Cars\"))\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 9933055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d8ca67c241d9daa900a8ceb1d4fe0b?s=128&d=identicon&r=PG&f=1", "display_name": "JD1997", "link": "https://stackoverflow.com/users/9933055/jd1997"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 51521780, "answer_count": 1, "score": 0, "last_activity_date": 1532529957, "creation_date": 1532526806, "question_id": 51520679, "link": "https://stackoverflow.com/questions/51520679/how-to-count-two-differently-sized-text-boxes-on-a-spreadsheet", "title": "How to count two differently sized Text Boxes on a spreadsheet?", "body": "<p>I have a spreadsheet with many textboxes on it that are separately named and numbered. There two kinds of textbox, large ones and small ones. I've named all the large ones \"Elevator 1\" up to 12. I named the small ones \"Riser 1\" up to 20. I also have checkboxes linked to each textbox that makes the corresponding textbox disappear when it is unchecked. I'm trying to have a counter for each type of text box that counts how many textboxes are visible on the spreadsheet. The following code gives me an error saying, \"Runtime Error '1004' Application-defined or object-defined error\". I've named the cell where the counter will appear \"NumberOfRisers\" and my worksheet is named \"LobbyCars\".</p>\n\n<pre><code>    Sub NumberOfRisers()\n\n    Dim counter As Long\n\n    Dim ws As Worksheet\n\n    For Each ws In ActiveWorkbook.Worksheets\n\n    counter = ActiveSheet.Shapes.Count\n\n    Worksheets(\"LobbyCars\").Range(\u201cNumberOfRisers\u201d) = counter\n\n    Next\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "charts", "pivot-table"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1532526526, "post_id": 51520513, "comment_id": 90009859, "body": "When you create the chart give it a name and use that as a reference for the delete. Store the reference qualified with the appropriate workbook+sheet reference in a variable and delete by reference to the variable."}], "answers": [{"tags": [], "owner": {"reputation": 73, "user_id": 6284847, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8fbf45b465111fb718a4c230b3fab8ba?s=128&d=identicon&r=PG&f=1", "display_name": "Cobse", "link": "https://stackoverflow.com/users/6284847/cobse"}, "is_accepted": false, "score": 0, "last_activity_date": 1532581085, "creation_date": 1532581085, "answer_id": 51531275, "question_id": 51520513, "link": "https://stackoverflow.com/questions/51520513/charts-not-being-deleted-by-chartobject-delete/51531275#51531275", "title": "Charts not being deleted by Chartobject.Delete?", "body": "<p>You can try something like this to first get the name and delete every chartObjects in active sheet. Count should return other than 0 though.</p>\n\n<pre><code>Sub deleteChartObjects()\n\nDim chartName As String\nDim cht As ChartObject\n\nFor Each cht In ActiveSheet.ChartObjects\n    chartName = cht.Name\n    Set cht = ActiveSheet.ChartObjects(chartName)\n    cht.Delete\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 8654328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/316f2ed898455a83503e17975d30a519?s=128&d=identicon&r=PG&f=1", "display_name": "DriveThomas", "link": "https://stackoverflow.com/users/8654328/drivethomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532581085, "creation_date": 1532526342, "question_id": 51520513, "link": "https://stackoverflow.com/questions/51520513/charts-not-being-deleted-by-chartobject-delete", "title": "Charts not being deleted by Chartobject.Delete?", "body": "<p>I have a macro that creates a pivot table and then creates a chart based on the pivot. I want to delete the old pivot table and chart, before replacing them with the new data.</p>\n\n<p>I can get red of the pivot table with <code>Cells.Delete</code>.</p>\n\n<p>According to what I found online I should be able to get rid of the chart with <code>ChartObjects.Delete</code>. </p>\n\n<p>However this doesn't seem to work. Also <code>ChartObjects.Count</code> returns 0.</p>\n\n<p>I know that a simple workaround would be to delete the entire sheet and then just add a new one but I would like to avoid that.</p>\n\n<p>Any Ideas where the problem might be?</p>\n"}, {"tags": ["vba", "excel", "syntax", "comments"], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1532525824, "post_id": 51520294, "comment_id": 90009342, "body": "Beat me to it !! +1"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1532525877, "post_id": 51520294, "comment_id": 90009400, "body": "@QHarr - and I was even amazed that the <code>AddComment</code>  did not work initially."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1532526709, "post_id": 51520294, "comment_id": 90010021, "body": "@QHarr - you gotta be speedy when Vityata&#39;s online...  :-)"}, {"owner": {"reputation": 11, "user_id": 10133723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7d6114cd2e72003412b856363847ed0?s=128&d=identicon&r=PG&f=1", "display_name": "Len", "link": "https://stackoverflow.com/users/10133723/len"}, "edited": false, "score": 0, "creation_date": 1532527023, "post_id": 51520294, "comment_id": 90010244, "body": "@Vityata would this work the same if text was a double or integer rather than a string?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1532527069, "post_id": 51520294, "comment_id": 90010283, "body": "@ashleedawg :D."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 11, "user_id": 10133723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7d6114cd2e72003412b856363847ed0?s=128&d=identicon&r=PG&f=1", "display_name": "Len", "link": "https://stackoverflow.com/users/10133723/len"}, "edited": false, "score": 1, "creation_date": 1532527204, "post_id": 51520294, "comment_id": 90010391, "body": "@Len - Comments can only be string, so although it would <i>probably</i> work with a numeric variable, the &quot;right way&quot; to do it is to convert the number to a string, like <code>Range(&quot;B2&quot;).AddComment CStr(myNumericVariable)</code>."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 11, "user_id": 10133723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7d6114cd2e72003412b856363847ed0?s=128&d=identicon&r=PG&f=1", "display_name": "Len", "link": "https://stackoverflow.com/users/10133723/len"}, "edited": false, "score": 0, "creation_date": 1532527217, "post_id": 51520294, "comment_id": 90010407, "body": "@Len - declare it as a string and put an integer or double in it."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 11, "user_id": 10133723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7d6114cd2e72003412b856363847ed0?s=128&d=identicon&r=PG&f=1", "display_name": "Len", "link": "https://stackoverflow.com/users/10133723/len"}, "edited": false, "score": 0, "creation_date": 1532527224, "post_id": 51520294, "comment_id": 90010413, "body": "...or just do what Vityata says.  :)   (psst @Len be sure to check out Vitaya&#39;s website, there a link from Vityata&#39;s <a href=\"https://stackoverflow.com/users/5448626/vityata\">profile</a>... there&#39;s lots of handy Excel &amp; VBA stuff to explore!)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1532527259, "post_id": 51520294, "comment_id": 90010436, "body": "@ashleedawg - I guess QHarr is not following :D"}, {"owner": {"reputation": 11, "user_id": 10133723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7d6114cd2e72003412b856363847ed0?s=128&d=identicon&r=PG&f=1", "display_name": "Len", "link": "https://stackoverflow.com/users/10133723/len"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1532527331, "post_id": 51520294, "comment_id": 90010492, "body": "@ashleedawg awesome I got it to work, thanks for the edits as well."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 11, "user_id": 10133723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7d6114cd2e72003412b856363847ed0?s=128&d=identicon&r=PG&f=1", "display_name": "Len", "link": "https://stackoverflow.com/users/10133723/len"}, "edited": false, "score": 1, "creation_date": 1532527555, "post_id": 51520294, "comment_id": 90010649, "body": "@Len - glad you got it figured out; in the end that&#39;s all that matters...  oh and <i>Welcome to <a href=\"https://stackoverflow.com\">Stack Overflow</a>!</i>"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 4, "last_activity_date": 1532525723, "creation_date": 1532525723, "answer_id": 51520294, "question_id": 51520236, "link": "https://stackoverflow.com/questions/51520236/how-to-use-the-value-of-a-variable-to-create-a-cell-comment-in-excel/51520294#51520294", "title": "How to use the value of a variable to create a cell comment in Excel", "body": "<p>Minimal example with a variable:</p>\n\n<pre><code>Sub TesetMe()\n\n    Dim text As String\n    text = \"someText\"\n    Range(\"B2\").AddComment text\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10133723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7d6114cd2e72003412b856363847ed0?s=128&d=identicon&r=PG&f=1", "display_name": "Len", "link": "https://stackoverflow.com/users/10133723/len"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1532527066, "creation_date": 1532525590, "last_edit_date": 1532527066, "question_id": 51520236, "link": "https://stackoverflow.com/questions/51520236/how-to-use-the-value-of-a-variable-to-create-a-cell-comment-in-excel", "title": "How to use the value of a variable to create a cell comment in Excel", "body": "<p>I am struggling to find the syntax of how to add a comment using the value of a variable, or if it's even supported through VBA.</p>\n\n<p>For example, it's easy enough to know that:</p>\n\n<p><code>Range(\"YourRange\").AddComment \"Your Text\"</code></p>\n\n<p>...will add a comment to a range of cells with whatever <code>\"Your text\"</code> is. What I am trying to figure out is how to use a variable's value instead of <code>\"Your Text\"</code>. I have tried various combinations using an <code>&amp;</code>, and have yet to find any syntax online. </p>\n\n<blockquote>\n  <p><strong>Receiving Error:</strong><br>\n  <code>VBA Runtime Error 1004: Application-defined or Object-defined error</code></p>\n</blockquote>\n\n<pre><code>If sinput = 1 Then\n    Num = InputBox(\"How much did you spend?\", \"July - \" &amp; gasString)\n    Range(\"F11\").Value = Range(\"F11\").Value + Num\n    Range(\"F11\").AddComment Num\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 1705, "user_id": 9103250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3c613d7186c7314ee818673ea4c79fd?s=128&d=identicon&r=PG&f=1", "display_name": "CharonX", "link": "https://stackoverflow.com/users/9103250/charonx"}, "edited": false, "score": 3, "creation_date": 1532526079, "post_id": 51519871, "comment_id": 90009529, "body": "At Stackoverflow you will find held and assistance with programming issues, <b>but</b> we will not do your work for you. Show what you have tried so far and what is not working."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1533021418, "post_id": 51519871, "comment_id": 90180138, "body": "I&#39;m voting to close this question as off-topic because it&#39;s asking for complete code without any attempt."}], "owner": {"reputation": 1, "user_id": 10133635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08acb3968a82e2e64945e13761c6a00?s=128&d=identicon&r=PG&f=1", "display_name": "blade", "link": "https://stackoverflow.com/users/10133635/blade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593729521, "creation_date": 1532524610, "last_edit_date": 1593729521, "question_id": 51519871, "link": "https://stackoverflow.com/questions/51519871/vba-looking-for-code-to-automatically-number-page-x-of-xx-in-powerpoint-whi", "title": "VBA | Looking for code to automatically number &#39;Page x of xx&#39; in PowerPoint, while not numbering hidden slides", "body": "<p>I am looking for a code that will \n(1) auto number 'Page x of xx' in PPT\n(2) not count the hidden slides  </p>\n\n<p>If I have a 20 slide PPT, with 3 slides hidden, I would like to see 'Page 1 of 17' instead of 'Page 1 of 20'.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba", "excel-formula", "unique", "nonblank"], "answers": [{"comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1532524327, "post_id": 51519718, "comment_id": 90008246, "body": "I tested this and I don&#39;t think this gives the correct results on example row 3 and 4"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1532524492, "post_id": 51519718, "comment_id": 90008351, "body": "@tigeravatar - yup, my test used to be a bit fake... I had 3 times <code>A</code> and I was expecting 3, thus I considered it working."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1532524581, "post_id": 51519718, "comment_id": 90008402, "body": "Hmm... now it gives a #DIV/0! error if there are any blank cells in the row"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1532525113, "post_id": 51519718, "comment_id": 90008780, "body": "@tigeravatar - slowly getting there :) I knew there was something with <code>1&#47;</code>."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 4, "last_activity_date": 1532527023, "last_edit_date": 1532527023, "creation_date": 1532524167, "answer_id": 51519718, "question_id": 51519630, "link": "https://stackoverflow.com/questions/51519630/count-unique-non-blank-entries-in-a-range/51519718#51519718", "title": "Count unique non-blank entries in a range", "body": "<p>This is what I found:</p>\n\n<p><code>=SUMPRODUCT(1/COUNTIF(B1:F1,B1:F1&amp;\"\"))</code></p>\n\n<p>It works quite interestingly: </p>\n\n<p><a href=\"https://i.stack.imgur.com/cFrrY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cFrrY.png\" alt=\"product\"></a> </p>\n\n<p>It sums the results of the countifs, and it divides each one by 1.Thus, if you have the above example, it returns 4, because it sums:</p>\n\n<p><strong>1/1 + 1/3 + 1/3 + 1/1 + 1/3 + 1/3</strong></p>\n"}, {"comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 265, "user_id": 3745322, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/01df857ca4db61a7774ac3d1f2d477a8?s=128&d=identicon&r=PG", "display_name": "user51819", "link": "https://stackoverflow.com/users/3745322/user51819"}, "edited": false, "score": 3, "creation_date": 1532526126, "post_id": 51519753, "comment_id": 90009571, "body": "@user51819 The numerator <code>(B1:G1&lt;&gt;&quot;&quot;)</code> takes each cell and checks if it&#39;s blank, if it is blank it fails the check and gets counted as a 0, otherwise 1.  Then the denominator gets the total count of each element in the range.  The division then applies 1/Count for each element, such that if you have 3 of one element it becomes 1/3+1/3+1/3.  For example, on sample line 1, the breakdown is: 1/3+1/3+1/1+1/3+0/1+1/1 = 0.333+0.333+1+0.333+0+1 = 3"}, {"owner": {"reputation": 265, "user_id": 3745322, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/01df857ca4db61a7774ac3d1f2d477a8?s=128&d=identicon&r=PG", "display_name": "user51819", "link": "https://stackoverflow.com/users/3745322/user51819"}, "edited": false, "score": 0, "creation_date": 1532526328, "post_id": 51519753, "comment_id": 90009707, "body": "Really cool. Is there any risk of precision issues with this approach since it&#39;s working with fractions?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 265, "user_id": 3745322, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/01df857ca4db61a7774ac3d1f2d477a8?s=128&d=identicon&r=PG", "display_name": "user51819", "link": "https://stackoverflow.com/users/3745322/user51819"}, "edited": false, "score": 1, "creation_date": 1532526378, "post_id": 51519753, "comment_id": 90009745, "body": "@user51819 There can be, but you can wrap the formula in <code>ROUND</code> if you run into any issues with that."}, {"owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "edited": false, "score": 1, "creation_date": 1532527349, "post_id": 51519753, "comment_id": 90010510, "body": "I prefer doing these with FREQUENCIES for that reason but COUNTIF does work surprisingly well :-)"}, {"owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "edited": false, "score": 1, "creation_date": 1532527714, "post_id": 51519753, "comment_id": 90010764, "body": "FRQUENCY I mean"}, {"owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "edited": false, "score": 1, "creation_date": 1532530055, "post_id": 51519753, "comment_id": 90012475, "body": "Plz see <a href=\"https://exceljet.net/formula/count-unique-text-values-in-a-range\" rel=\"nofollow noreferrer\">exceljet.net/formula/count-unique-text-values-in-a-range</a>"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 6, "last_activity_date": 1532524257, "creation_date": 1532524257, "answer_id": 51519753, "question_id": 51519630, "link": "https://stackoverflow.com/questions/51519630/count-unique-non-blank-entries-in-a-range/51519753#51519753", "title": "Count unique non-blank entries in a range", "body": "<p>This should work for you:</p>\n\n<pre><code>=SUMPRODUCT((B1:G1&lt;&gt;\"\")/COUNTIF(B1:G1,B1:G1&amp;\"\"))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 3, "last_activity_date": 1532525579, "last_edit_date": 1532525579, "creation_date": 1532524411, "answer_id": 51519809, "question_id": 51519630, "link": "https://stackoverflow.com/questions/51519630/count-unique-non-blank-entries-in-a-range/51519809#51519809", "title": "Count unique non-blank entries in a range", "body": "<p>An UDF to use in sheet</p>\n\n<pre><code>Public Function GetUniqueCount(ByVal rng As Range) As Long\n    Dim dict As Object, currCell As Range\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n    For Each currCell In rng\n        If Not IsEmpty(currCell) Then dict(currCell.Value) = 1\n    Next currCell\n    GetUniqueCount = dict.Count\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>In sheet use:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pwFqt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pwFqt.png\" alt=\"Sheet\"></a></p>\n"}], "owner": {"reputation": 265, "user_id": 3745322, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/01df857ca4db61a7774ac3d1f2d477a8?s=128&d=identicon&r=PG", "display_name": "user51819", "link": "https://stackoverflow.com/users/3745322/user51819"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2452, "favorite_count": 0, "accepted_answer_id": 51519753, "answer_count": 3, "score": 1, "last_activity_date": 1537763019, "creation_date": 1532523876, "last_edit_date": 1537763019, "question_id": 51519630, "link": "https://stackoverflow.com/questions/51519630/count-unique-non-blank-entries-in-a-range", "title": "Count unique non-blank entries in a range", "body": "<p>I have data like this in Excel:</p>\n\n<pre><code>Person1    A    A    B    A         C    3\nPerson2                                  0\nPerson3    A    B    C    D    E    F    6\nPerson4              A    A    A         1\n</code></pre>\n\n<p>I am trying to find a formula that replicates the number in the last cell of each row, the number of unique elements associated with that person, excluding blanks. So for example Person1 has 3 since there is A, B, and C even though there are three A's. The number of columns is fixed / the same for everyone. The values A, B, C, etc, are strings (as opposed to numerics).</p>\n\n<p>Can this be done using a formula?</p>\n"}, {"tags": ["vba", "excel", "worksheet"], "comments": [{"owner": {"reputation": 84, "user_id": 7489442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4b58c475359a809cffe9ba487dd8c7c?s=128&d=identicon&r=PG&f=1", "display_name": "Srijan", "link": "https://stackoverflow.com/users/7489442/srijan"}, "edited": false, "score": 0, "creation_date": 1532523881, "post_id": 51519541, "comment_id": 90007968, "body": "in ws1.Range(&quot;A&quot; &amp; x) value of X is 1 that is why it keeps pasting over the data from worksheet 1 from the top down instead of pasting in the next available blank spot below."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 2, "creation_date": 1532523994, "post_id": 51519541, "comment_id": 90008036, "body": "You don&#39;t need to use x, just paste to the next row. <code>c.EntireRow.Copy ws1.Range(&quot;A&quot; &amp; ws1.Cells(ws1.Rows.Count, &quot;A&quot;).End(xlUp).Row + 1)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 10125008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xJqLA.png?s=128&g=1", "display_name": "Digital Xanatos", "link": "https://stackoverflow.com/users/10125008/digital-xanatos"}, "edited": false, "score": 1, "creation_date": 1532524797, "post_id": 51519629, "comment_id": 90008570, "body": "Thank you! Works perfectly!"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1532523875, "creation_date": 1532523875, "answer_id": 51519629, "question_id": 51519541, "link": "https://stackoverflow.com/questions/51519541/pasting-data-with-a-specific-word-from-worksheet-2-under-data-from-worksheet-1/51519629#51519629", "title": "Pasting data with a specific word from worksheet 2 under data from worksheet 1", "body": "<p>You need to assign the <code>x</code> as the last row of the first worksheet and then increment it:</p>\n\n<pre><code>Option Explicit\n\nSub CopyRows()\n\n    Dim ws1 As Worksheet, ws2 As Worksheet\n    Dim bottomL As Long\n    Dim x As Long\n    Dim c As Range\n\n    Set ws1 = Worksheets(1)\n    Set ws2 = Worksheets(2)\n    bottomL = ws2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    x = ws1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    x = x + 1\n\n    For Each c In ws2.Range(\"A1:A\" &amp; bottomL)\n        If c.Value = \"New\" Then\n            c.EntireRow.Copy ws1.Range(\"A\" &amp; x)\n            x = x + 1\n        End If\n    Next c\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 685, "user_id": 6187845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc90c985e2d7b81ba79c02313aeeefd?s=128&d=identicon&r=PG&f=1", "display_name": "nagarajannd", "link": "https://stackoverflow.com/users/6187845/nagarajannd"}, "is_accepted": false, "score": 3, "last_activity_date": 1532523915, "creation_date": 1532523915, "answer_id": 51519641, "question_id": 51519541, "link": "https://stackoverflow.com/questions/51519541/pasting-data-with-a-specific-word-from-worksheet-2-under-data-from-worksheet-1/51519641#51519641", "title": "Pasting data with a specific word from worksheet 2 under data from worksheet 1", "body": "<p>Because you are iterating <code>x</code> from 1 every time. To paste in the next available row - you need to calculate lastrow of sheet 1 similar to your calculation of <code>bottomL</code>.</p>\n\n<p><code>x = ws1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1</code></p>\n"}], "owner": {"reputation": 63, "user_id": 10125008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xJqLA.png?s=128&g=1", "display_name": "Digital Xanatos", "link": "https://stackoverflow.com/users/10125008/digital-xanatos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 51519629, "answer_count": 2, "score": 1, "last_activity_date": 1532526436, "creation_date": 1532523578, "last_edit_date": 1532526436, "question_id": 51519541, "link": "https://stackoverflow.com/questions/51519541/pasting-data-with-a-specific-word-from-worksheet-2-under-data-from-worksheet-1", "title": "Pasting data with a specific word from worksheet 2 under data from worksheet 1", "body": "<p>So I'm trying to have the data from worksheet 2 pasted under the data from worksheet 1 if it has the word \"New\" in column A. </p>\n\n<p>I have this code:</p>\n\n<pre><code>Sub CopyRows()\n\n    Dim ws1 As Worksheet, ws2 As Worksheet\n    Dim bottomL As Integer\n    Dim x As Integer\n    Dim c As Range\n\n    Set ws1 = Sheets(\"Sheet1\")\n    Set ws2 = Sheets(\"Sheet2\")\n    bottomL = ws2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row: x = 1\n\n    For Each c In ws2.Range(\"A1:A\" &amp; bottomL)\n        If c.Value = \"New\" Then\n            c.EntireRow.Copy ws1.Range(\"A\" &amp; x)\n            x = x + 1\n        End If\n    Next c\n\nEnd Sub\n</code></pre>\n\n<p>But it keeps pasting over the data from worksheet 1 from the top down instead of pasting in the next available blank spot below.</p>\n\n<p>Any help would be appreciated!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1532526782, "post_id": 51519492, "comment_id": 90010073, "body": "Not sure what the problem is. <code>SourcePath</code> is definitely captured in your <code>GetFolder</code> function and retained inside your loop the entire time. Looks like it works as intended"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1532526952, "post_id": 51519492, "comment_id": 90010193, "body": "Have you tried stepping through your code or using <code>Debug.Print</code> to check the value of <code>SourcePath</code>?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1532527017, "post_id": 51519492, "comment_id": 90010240, "body": "Wouldn&#39;t you need to add a backslash? I don&#39;t think the result of <code>GetFolder</code> would end in one."}, {"owner": {"reputation": 193, "user_id": 8359901, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EyQWI_rtFGk/AAAAAAAAAAI/AAAAAAAAAB4/vjteD8Ol7m4/photo.jpg?sz=128", "display_name": "Prateek Vishwas", "link": "https://stackoverflow.com/users/8359901/prateek-vishwas"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1532532904, "post_id": 51519492, "comment_id": 90014485, "body": "@BigBen Great! I&#39;ve got what I was missing. you are correct! Please post the suggestion as answer (SourcePath = GetFolder &amp; &quot;\\&quot;) so that I can mark it as answered. Thank you so much for looking into this problem."}, {"owner": {"reputation": 193, "user_id": 8359901, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EyQWI_rtFGk/AAAAAAAAAAI/AAAAAAAAAB4/vjteD8Ol7m4/photo.jpg?sz=128", "display_name": "Prateek Vishwas", "link": "https://stackoverflow.com/users/8359901/prateek-vishwas"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1532533026, "post_id": 51519492, "comment_id": 90014543, "body": "@Mistella Thank you Mistella for your suggestion too. I am new to excel vb and didn&#39;t know about debug.print. I goggled it and found it useful in my debugging."}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 2, "last_activity_date": 1532533622, "creation_date": 1532533622, "answer_id": 51523027, "question_id": 51519492, "link": "https://stackoverflow.com/questions/51519492/getting-folder-path-using-msofiledialogfolderpicker/51523027#51523027", "title": "Getting folder path using msoFileDialogFolderPicker", "body": "<p>The path your <code>GetFolder</code> Function returns will not end with a backslash <code>\\</code>. As is, the <em>pathname</em> argument you pass to <code>Dir</code> in <code>Fname = Dir(SourcePath &amp; \"*\" &amp; Range(\"A\" &amp; i).Value &amp; \"*\")</code> will be incorrect.</p>\n\n<p>So change <code>SourcePath = GetFolder(\"C:\\\")</code> to <code>SourcePath = GetFolder(\"C:\\\") &amp; \"\\\"</code>, or add a trailing backslash within your <code>GetFolder</code> function.</p>\n\n<p>As <a href=\"https://stackoverflow.com/users/9259306/mistella\">@Mistella</a> pointed out, using <code>Debug.Print</code> would easily highlight this issue.</p>\n"}], "owner": {"reputation": 193, "user_id": 8359901, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EyQWI_rtFGk/AAAAAAAAAAI/AAAAAAAAAB4/vjteD8Ol7m4/photo.jpg?sz=128", "display_name": "Prateek Vishwas", "link": "https://stackoverflow.com/users/8359901/prateek-vishwas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 628, "favorite_count": 0, "accepted_answer_id": 51523027, "answer_count": 1, "score": 0, "last_activity_date": 1532594287, "creation_date": 1532523426, "last_edit_date": 1532594287, "question_id": 51519492, "link": "https://stackoverflow.com/questions/51519492/getting-folder-path-using-msofiledialogfolderpicker", "title": "Getting folder path using msoFileDialogFolderPicker", "body": "<p>I have a code which picks file from a SourcePath then renames it and saves in DestPath. The code is working fine with hardcoded folder path for SourcePath (SourcePath = \"C:\\Invoices\\Raw invoices\"). however, it's not able to capture and retain the folderpath with msoFileDialogFolderPicker function. The code is unable to find the file in sourcepath and gives error as programmed.</p>\n\n<p>Here is the sample data.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Q7EJW.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Q7EJW.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Here is the code I am using.</p>\n\n<pre><code>Sub Rename_invoices()\n    Dim SourcePath As String, DestPath As String, Fname As String, NewFName As String\n    Dim i As Long\n    SourcePath = GetFolder(\"C:\\\")\n    DestPath = \"C:\\Dunning Temp\\\"\n    For i = 1 To Cells(Rows.Count, \"A\").End(xlUp).Row\n        If Not IsEmpty(Range(\"A\" &amp; i).Value) Then\n            NewFName = Range(\"B\" &amp; i).Value\n            'Search for the first file containing the string in column A\n            Fname = Dir(SourcePath &amp; \"*\" &amp; Range(\"A\" &amp; i).Value &amp; \"*\")\n            If Fname &lt;&gt; vbNullString Then\n                FileCopy SourcePath &amp; Fname, DestPath &amp; NewFName\n            Else\n                MsgBox Range(\"A\" &amp; i).Value &amp; \" dosen't exist in the folder\"\n            End If\n        End If\n    Next i\n    ActiveSheet.Close = False\nEnd Sub\n\nFunction GetFolder(strPath As String) As String\n    Dim fldr As FileDialog\n    Dim sItem As String\n    Set fldr = Application.FileDialog(msoFileDialogFolderPicker)\n    With fldr\n        .Title = \"Select a Folder\"\n        .AllowMultiSelect = False\n        .InitialFileName = strPath\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        sItem = .SelectedItems(1)\n    End With\nNextCode:\n    GetFolder = sItem\n    Set fldr = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 1, "creation_date": 1532533829, "post_id": 51519382, "comment_id": 90015028, "body": "Try commenting out the line <code>On Error Resume Next</code> and re-running the code. It&#39;s possible that errors are occurring but getting supressed."}, {"owner": {"reputation": 1, "user_id": 8040456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nVSE5.jpg?s=128&g=1", "display_name": "Dondi", "link": "https://stackoverflow.com/users/8040456/dondi"}, "reply_to_user": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1532587925, "post_id": 51519382, "comment_id": 90032916, "body": "Hi, commented out the line. The only error I was getting is that the template I was trying ot change was protected. Solved that. What I noticed today was that if I run the macro from the sheet without having the VBA Explorer opened, no extra workbook shows up when I check afterwards. However if I run the macro with the VBA explorer opened the closed workbooks always remain there."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8040456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nVSE5.jpg?s=128&g=1", "display_name": "Dondi", "link": "https://stackoverflow.com/users/8040456/dondi"}, "edited": false, "score": 0, "creation_date": 1532524588, "post_id": 51519736, "comment_id": 90008412, "body": "Unfortunately tried that and it&#39;s still not working :("}], "tags": [], "owner": {"reputation": 25, "user_id": 9962434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7247ac90ebde8ca654c43451241edfad?s=128&d=identicon&r=PG&f=1", "display_name": "Thej Kumar P", "link": "https://stackoverflow.com/users/9962434/thej-kumar-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1532524229, "creation_date": 1532524229, "answer_id": 51519736, "question_id": 51519382, "link": "https://stackoverflow.com/questions/51519382/vba-project-explorershowing-excel-workbooks-after-closing-them-with-macro/51519736#51519736", "title": "VBA project explorershowing excel workbooks after closing them with macro", "body": "<p>Close workbook using <code>dWb.Close SaveChanges:=True</code> instead <code>Workbooks(newName).Close SaveChanges:=True</code></p>\n"}], "owner": {"reputation": 1, "user_id": 8040456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nVSE5.jpg?s=128&g=1", "display_name": "Dondi", "link": "https://stackoverflow.com/users/8040456/dondi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532594301, "creation_date": 1532523113, "last_edit_date": 1532594301, "question_id": 51519382, "link": "https://stackoverflow.com/questions/51519382/vba-project-explorershowing-excel-workbooks-after-closing-them-with-macro", "title": "VBA project explorershowing excel workbooks after closing them with macro", "body": "<p>As the title suggests, after closing another workbook that runs a macro it keeps showing up in the VBA Explorer.</p>\n\n<p>What the macro is doing: </p>\n\n<ol>\n<li>Open a template workbook</li>\n<li>Copies data to it from the current workbook</li>\n<li>Saves it under a different name</li>\n</ol>\n\n<p>All the above is enclosed in a loop, since I need to be able to do this for a few dozen entries.</p>\n\n<p>I have tried clearing the objects from memory but apparently I'm still doing something wrong.</p>\n\n<p>Macro code:</p>\n\n<pre><code>Sub Openworkbook_Click()\n'Updateby Extendoffice 20161008\n    Dim sWb As Workbook\n    Dim dWb As Workbook\n    Dim wbName As String\n    Dim newName As String\n    Dim relPath As String\n    Dim i As Integer\n    On Error Resume Next\n\n    Set sWb = ActiveWorkbook\n\n    'While loop\n    i = 3\n    Do While sWb.Sheets(1).Range(\"B\" &amp; i) &lt;&gt; \"\"\n    'Set destination workbook\n        Set dWb = Workbooks.Open(\"D:\\1. WORK\\AUDA\\in progress\\Betonv\u00e6g_test.xlsm\")\n\n        'Geometry copy\n        sWb.Sheets(1).Range(\"B\" &amp; i).Copy\n        dWb.Sheets(1).Range(\"K13\").PasteSpecial\n        sWb.Sheets(1).Range(\"C\" &amp; i).Copy\n        dWb.Sheets(1).Range(\"K14\").PasteSpecial\n        sWb.Sheets(1).Range(\"D\" &amp; i).Copy\n        dWb.Sheets(1).Range(\"K15\").PasteSpecial\n\n        'Reinforcement copy\n        sWb.Sheets(1).Range(\"G\" &amp; i).Copy\n        dWb.Sheets(1).Range(\"J19\").PasteSpecial\n        sWb.Sheets(1).Range(\"H\" &amp; i).Copy\n        dWb.Sheets(1).Range(\"K19\").PasteSpecial\n\n        sWb.Sheets(1).Range(\"I\" &amp; i).Copy\n        dWb.Sheets(1).Range(\"J20\").PasteSpecial\n        sWb.Sheets(1).Range(\"J\" &amp; i).Copy\n        dWb.Sheets(1).Range(\"K20\").PasteSpecial\n\n        sWb.Sheets(1).Range(\"K\" &amp; i).Copy\n        dWb.Sheets(1).Range(\"J21\").PasteSpecial\n        sWb.Sheets(1).Range(\"L\" &amp; i).Copy\n        dWb.Sheets(1).Range(\"K21\").PasteSpecial\n\n        sWb.Sheets(1).Range(\"M\" &amp; i).Copy\n        dWb.Sheets(1).Range(\"J22\").PasteSpecial\n        sWb.Sheets(1).Range(\"N\" &amp; i).Copy\n        dWb.Sheets(1).Range(\"K22\").PasteSpecial\n\n        'Material properties\n        sWb.Sheets(1).Range(\"E\" &amp; i).Copy\n        dWb.Sheets(1).Range(\"E17\").PasteSpecial\n        sWb.Sheets(1).Range(\"F\" &amp; i).Copy\n        dWb.Sheets(1).Range(\"E18\").PasteSpecial\n\n        'Other\n        sWb.Sheets(1).Range(\"O\" &amp; i).Copy\n        dWb.Sheets(1).Range(\"E12\").PasteSpecial\n        sWb.Sheets(1).Range(\"P\" &amp; i).Copy\n        dWb.Sheets(1).Range(\"E13\").PasteSpecial\n        sWb.Sheets(1).Range(\"Q\" &amp; i).Copy\n        dWb.Sheets(1).Range(\"E14\").PasteSpecial\n        sWb.Sheets(1).Range(\"R\" &amp; i).Copy\n        dWb.Sheets(1).Range(\"E15\").PasteSpecial\n\n        'Copy loads\n        sWb.Sheets(1).Range(\"S\" &amp; i).Copy\n        dWb.Sheets(1).Range(\"F33\").PasteSpecial\n        sWb.Sheets(1).Range(\"T\" &amp; i).Copy\n        dWb.Sheets(1).Range(\"G33\").PasteSpecial\n\n        sWb.Sheets(1).Range(\"U\" &amp; i).Copy\n        dWb.Sheets(1).Range(\"F34\").PasteSpecial\n        sWb.Sheets(1).Range(\"V\" &amp; i).Copy\n        dWb.Sheets(1).Range(\"G34\").PasteSpecial\n\n        sWb.Sheets(1).Range(\"W\" &amp; i).Copy\n        dWb.Sheets(1).Range(\"G35\").PasteSpecial\n        sWb.Sheets(1).Range(\"X\" &amp; i).Copy\n        dWb.Sheets(1).Range(\"F35\").PasteSpecial\n\n        'Save with different name &amp; close\n        newName = \"Betonv\u00e6g_\" &amp; sWb.Sheets(1).Range(\"C\" &amp; i) &amp; \"x\" &amp; sWb.Sheets(1).Range(\"D\" &amp; i) &amp; \".xlsm\"\n        relPath = ThisWorkbook.Path &amp; \"\\\"\n\n        Application.DisplayAlerts = False\n        dWb.SaveAs Filename:=relPath &amp; newName\n        Application.DisplayAlerts = True\n        Workbooks(newName).Close SaveChanges:=True\n\n        'Clear destination object\n        Set dWb = Nothing\n\n        'Increment i to read next line\n        i = i + 1\n\n    Loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 505, "user_id": 9204831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KwPAL.png?s=128&g=1", "display_name": "Lodi", "link": "https://stackoverflow.com/users/9204831/lodi"}, "edited": false, "score": 0, "creation_date": 1532523377, "post_id": 51519347, "comment_id": 90007602, "body": "To use a &quot;contains&quot; comparision, don&#39;t use <code>score1 = A</code>, use, <code>score1 Like A*</code> (beginning with A), or even <code>score 1 Like *A*</code> (containing A)"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1532524963, "post_id": 51519347, "comment_id": 90008681, "body": "Do you need this to be in <code>vba</code>? You can do this with formulas."}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1532523993, "post_id": 51519596, "comment_id": 90008033, "body": "This assumes that values like &quot;SAP&quot; and &quot;KAL&quot; should be found on the same row, but I&#39;m not sure that is the case."}, {"owner": {"reputation": 505, "user_id": 9204831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KwPAL.png?s=128&g=1", "display_name": "Lodi", "link": "https://stackoverflow.com/users/9204831/lodi"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1532524264, "post_id": 51519596, "comment_id": 90008212, "body": "That was how I interpretated, actually. Could you explain your interpretation, please?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1532524387, "post_id": 51519596, "comment_id": 90008288, "body": "I was going off of &quot;If in those [i.e. column B and C] is anything found starting with &#39;Kal&#39;&quot;. OP should clarify..."}], "tags": [], "owner": {"reputation": 505, "user_id": 9204831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KwPAL.png?s=128&g=1", "display_name": "Lodi", "link": "https://stackoverflow.com/users/9204831/lodi"}, "is_accepted": false, "score": 0, "last_activity_date": 1532523761, "creation_date": 1532523761, "answer_id": 51519596, "question_id": 51519347, "link": "https://stackoverflow.com/questions/51519347/decision-macro-making-decision-based-on-three-columns/51519596#51519596", "title": "Decision Macro - Making decision based on three columns", "body": "<p>Check if this code helps you.\nIt basically do what you described, using the \"Sheet1\" sheet and without any headers on the table:</p>\n\n<pre><code>Sub SAPKalObr()\n\n    With Sheets(\"Sheet1\")\n        LastRow = .Cells(.Rows.Count, 1).End(xlUp).Row 'Finds the last used row at column 1\n        For r = 1 To LastRow 'Iterate between every used row at the first column\n            If .Cells(r, 1) Like \"SAP*\" Then 'Testing for starting with SAP on the first column\n                If .Cells(r, 2) Like \"Kal*\" Or .Cells(r, 3) Like \"Kal*\" Then 'SAP? Testing for Kal on the second or third column\n                    .Cells(r, 4).Value = \"Kal\" 'Returning Kal\n                Else\n                    .Cells(r, 4).Value = \"Obr\" 'No Kal? Returning Obr\n                End If\n            Else\n                .Cells(r, 4).Value = \" \" 'No SAP? Returning blank\n            End If\n        Next\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1532527332, "creation_date": 1532527332, "answer_id": 51520889, "question_id": 51519347, "link": "https://stackoverflow.com/questions/51519347/decision-macro-making-decision-based-on-three-columns/51520889#51520889", "title": "Decision Macro - Making decision based on three columns", "body": "<p>A \u201cformula\u201d approach:</p>\n\n<pre><code>Sub Main()\n    With Range(\"A1\", Cells(Rows.Count, 1).End(xlUp)).Offset(,3)\n        .FormulaR1C1= \"=IF(LEFT(RC1,3)=\"\"SAP\"\",IF(OR(LEFT(RC2,3)=\"\"Kal\"\",LEFT(RC3,3)=\"\"Kal\"\"),\"\"Kal\"\",\"\"Obr\"\"),\"\"\"\")\" \n        .Value = .Value\n   End With \nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10133540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f098199087148b48cac1c4763a4ab6d?s=128&d=identicon&r=PG&f=1", "display_name": "M.T.J.", "link": "https://stackoverflow.com/users/10133540/m-t-j"}, "is_accepted": false, "score": 0, "last_activity_date": 1532592538, "creation_date": 1532592538, "answer_id": 51533999, "question_id": 51519347, "link": "https://stackoverflow.com/questions/51519347/decision-macro-making-decision-based-on-three-columns/51533999#51533999", "title": "Decision Macro - Making decision based on three columns", "body": "<p><strong><em>[SOLVED]</strong>: mrexcel.com/forum/excel-questions/1064325-decision-macro.html</em></p>\n\n<p><strong>Thanks a lot for all your help!</strong></p>\n\n<pre><code>Sub MyTest()\n\n    Dim lr As Long\n    Dim r As Long\n\n    Application.ScreenUpdating = False\n\n'   Find last row with data in column A\n    lr = Cells(Rows.Count, \"A\").End(xlUp).Row\n\n'   Loop through all rows in column A starting with row 2\n    For r = 2 To lr\n'       Check to see if column A does not start with \"SAP\"\n        If Left(Cells(r, \"A\"), 3) &lt;&gt; \"SAP\" Then\n            Cells(r, \"D\") = \"\"\n        Else\n'           Check to see if columns B or C start with \"Kal\"\n            If (Left(Cells(r, \"B\"), 3) = \"Kal\") Or (Left(Cells(r, \"c\"), 3) = \"Kal\") Then\n                Cells(r, \"D\") = \"Kal\"\n            Else\n                Cells(r, \"D\") = \"Obr\"\n            End If\n        End If\n    Next r\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10133540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f098199087148b48cac1c4763a4ab6d?s=128&d=identicon&r=PG&f=1", "display_name": "M.T.J.", "link": "https://stackoverflow.com/users/10133540/m-t-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1532592538, "creation_date": 1532523034, "last_edit_date": 1532525836, "question_id": 51519347, "link": "https://stackoverflow.com/questions/51519347/decision-macro-making-decision-based-on-three-columns", "title": "Decision Macro - Making decision based on three columns", "body": "<p>I am trying to program a macro which should follow as this:</p>\n\n<ol>\n<li>Take a look into column A and find what starts on \"SAP\" (e.g.: SAP-23F)</li>\n<li>If it is not SAP.. -> blank cell in column D; If yes -> Check column B and C</li>\n<li>Checking column B and C -> If in those is anything found starting with \"Kal\" (e.g. Kal c.2) then write into column D \"Kal\", if not, then write \"Obr\"</li>\n</ol>\n\n<p>I started with a very easy example to train on it however even this one doesn't work. My example is looking into column 1, if there is A then it is shall look into column 2 if not, it writes into column 3 a negative answer. If in column 2 is B or C then it writes into column 3 an answer. See below:</p>\n\n<pre><code>Sub Test()\n    score1 = ActiveSheet.Range(\"S3:S6\").Value\n    If score1 = A Then\n        Call Test1\n    Else\n        result = \"C\"\n    End If\n    ActiveSheet.Range(\"U3:U6\").Value = result\nEnd Sub\n\nSub Test1()\n    score2 = ActiveSheet.Range(\"T3:T6\").Value\n    If score2 = B Then\n        result = \"X\"\n    Else\n        result = \"Y\"\n    End If\n    ActiveSheet.Range(\"U3:U6\").Value = result\nEnd Sub\n</code></pre>\n\n<p>My question is what is wrong in my example and how to adapt it to be used in the real case mentioned at the beginning.</p>\n\n<p>Thanks for all your help. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1532545910, "post_id": 51519145, "comment_id": 90020894, "body": "Added an innovative approach to solve your question. BTW as this is your first post have a look at SO and help other developpers to identify a good answer by marking it as accepted  - see <a href=\"https://stackoverflow.com/help/someone-answers\">&quot;Someone answers&quot;</a>."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1532548705, "post_id": 51519145, "comment_id": 90022063, "body": "@T.M. What do you think of <a href=\"https://stackoverflow.com/a/51526756/111794\">my approach</a>?"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1533060138, "post_id": 51519145, "comment_id": 90204466, "body": "@ZevSpitz - find it cool and straight ahead. BTW what about mine?"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1533835047, "post_id": 51519145, "comment_id": 90504087, "body": "This solved question has a slightly modified follow up question at <a href=\"https://stackoverflow.com/questions/51654042/copying-values-and-color-index-in-an-array\">Copying values AND color index in an array</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10133619, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/16b36645dc234ada26ef194deb818262?s=128&d=identicon&r=PG", "display_name": "Kamoulox", "link": "https://stackoverflow.com/users/10133619/kamoulox"}, "is_accepted": false, "score": 0, "last_activity_date": 1532594507, "last_edit_date": 1532594507, "creation_date": 1532523914, "answer_id": 51519640, "question_id": 51519145, "link": "https://stackoverflow.com/questions/51519145/multi-criteria-selection-with-vba/51519640#51519640", "title": "Multi-Criteria Selection with VBA", "body": "<p>Something like this maybe:</p>\n\n<pre><code>j = 0\nFor i = To alarms.Rows.Count\n   sheetname = \"your sheet name\"\n   If (Sheets(sheetname).Cells(i, 7) = \"condenser\" Or Sheets(sheetname).Cells(i, 7) = \"pump\") Then\n       j = j + 1\n       Sheets(sheetname).Cells(i, 1).Copy Sheets(\"aff\").Cells(j, 1) \n       Sheets(sheetname).Cells(i, 2).Copy Sheets(\"aff\").Cells(j, 2) \n   End If\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 79, "user_id": 10075275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107333275ee3414da0aef131cdd8ced0?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10075275/ibrahim"}, "edited": false, "score": 1, "creation_date": 1532593603, "post_id": 51524230, "comment_id": 90036108, "body": "First of all I want to thank you for the time you spent writing this code, I tried it and it works, now I&#39;m trying to make some changes. In column G I have a sentence for example (repair to do on the condenser) and I would like that as soon as the word &quot;condenser&quot; appears it implies it respects my criteria I tried (&quot;* condenser*&quot;, &quot;<i>cex</i>&quot;) like if filename like &quot;<i>book</i>&quot; but it doesn&#39;t work on an array, is there a method for that?"}, {"owner": {"reputation": 79, "user_id": 10075275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107333275ee3414da0aef131cdd8ced0?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10075275/ibrahim"}, "edited": false, "score": 0, "creation_date": 1532593608, "post_id": 51524230, "comment_id": 90036113, "body": "then I would like to keep the same shapes and content as the source cells, after extraction the date changed from the French model (day/months/year) to the American model (months/day/year) and I don&#39;t have the color of cell A (based on the color i have to fill the cell so i would like to have the same format as the source worksheet) Thank you for your help!"}, {"owner": {"reputation": 79, "user_id": 10075275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107333275ee3414da0aef131cdd8ced0?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10075275/ibrahim"}, "edited": false, "score": 0, "creation_date": 1532612330, "post_id": 51524230, "comment_id": 90048152, "body": "I came back with a simpler idea for the criteria, instead of looking if column G contains the name of one of the considered systems (condenser, pump,.... too many), I know that all the systems contain a particular data in column X. So I can say that if I have a value in column X it necessarily means in column G I have one of my systems meeting the criteria. Then  the copy part (A,B,X,Z) while keeping the format of the source file"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 79, "user_id": 10075275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107333275ee3414da0aef131cdd8ced0?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10075275/ibrahim"}, "edited": false, "score": 0, "creation_date": 1532631927, "post_id": 51524230, "comment_id": 90059529, "body": "@Ibrahimatto - glad having helped; added a way to search for wild cards in column G."}, {"owner": {"reputation": 79, "user_id": 10075275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107333275ee3414da0aef131cdd8ced0?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10075275/ibrahim"}, "edited": false, "score": 0, "creation_date": 1532639680, "post_id": 51524230, "comment_id": 90062889, "body": "it&#39;s me again I saw the change you did but I wanted to apply the last simpler idea ,(last comment ) not using the wild card but instead to check if there&#39;s a value in column X. if you can read my last comment before this one. Thank you again for your time and help @T.M."}, {"owner": {"reputation": 79, "user_id": 10075275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107333275ee3414da0aef131cdd8ced0?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10075275/ibrahim"}, "edited": false, "score": 0, "creation_date": 1532886104, "post_id": 51524230, "comment_id": 90131150, "body": "hello sorry to bother you during your weekend , I was just wondering if you get to read my message. Thank you @T.M."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 79, "user_id": 10075275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107333275ee3414da0aef131cdd8ced0?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10075275/ibrahim"}, "edited": false, "score": 0, "creation_date": 1532972478, "post_id": 51524230, "comment_id": 90165012, "body": "See Edit II. BTW I suggest to avoid too many changes to your original question in the future in comments. It&#39;s better to ask a new question instead showing what you tried by your own code - @Ibrahimatto"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 79, "user_id": 10075275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107333275ee3414da0aef131cdd8ced0?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10075275/ibrahim"}, "edited": false, "score": 0, "creation_date": 1532972819, "post_id": 51524230, "comment_id": 90165177, "body": "Hope this 2nd edit to be helpful for you as well as other users - see my <i>Edit II.</i> Nevertheless I suggest to avoid too many changes to your original question in the future in comments. It would be better to ask a new question instead, point out your special issues and show  what you&#39;ve tried so far by your own code - c.f. <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>  :-) @Ibrahimatto"}, {"owner": {"reputation": 79, "user_id": 10075275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107333275ee3414da0aef131cdd8ced0?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10075275/ibrahim"}, "edited": false, "score": 1, "creation_date": 1533016202, "post_id": 51524230, "comment_id": 90177674, "body": "okay I would take your point into account, I had already created a new question but I liked your method and I wanted to deepen it. thank you @T.M."}, {"owner": {"reputation": 79, "user_id": 10075275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107333275ee3414da0aef131cdd8ced0?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10075275/ibrahim"}, "edited": false, "score": 0, "creation_date": 1533024593, "post_id": 51524230, "comment_id": 90181839, "body": "I tried it&#39;s working but i have to major isues :     <b>1: the date on the debug screen is correct but after copying it on the target sheet the month and day are reversed. 2:The first column value (color) isnt copied. i&#39;ll leave a link below so you&#39;ll see the differences between them.</b> PS : i&#39;m trying to be as clear as possible, i live in france and my english is not that good. Thank you for your understanding @T.M. . <a href=\"https://drive.google.com/open?id=14Ck6nN86UO1EwpkT4HGb-GXknOLfmL6N\" rel=\"nofollow noreferrer\">link to picture</a>"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 79, "user_id": 10075275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107333275ee3414da0aef131cdd8ced0?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10075275/ibrahim"}, "edited": false, "score": 0, "creation_date": 1533042685, "post_id": 51524230, "comment_id": 90193700, "body": "ad <code>1)</code> Tested again without problem - for me dates appear identically in their (local) version. Which code do you use to display the values in the picture link? ad <code>2)</code> You <b>can&#39;t</b> copy formatting (e.g. colors) with an array containing only <i>pure values</i> - if you look at the picture link you see that the joined string first displays a <code>|</code> delimiter indicating an - empty - value as first value. <b>Work around</b> Reuse the <code>a</code> array values (=chosen item numbers) to get the source color formats and reformat the A column following the array order (+/-header row offsets) -Bonne chance @Ibrahimatto"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 79, "user_id": 10075275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107333275ee3414da0aef131cdd8ced0?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10075275/ibrahim"}, "edited": false, "score": 1, "creation_date": 1533066963, "post_id": 51524230, "comment_id": 90207657, "body": "@Ibrahimatto Be aware that your system settings, or default excel settings, may be dictating the order of a date.  Where you may desire yyyymmdd, your computer may be telling it dd/ mm/yyyy.  You can format the column after the fact for a quick fix, or specify the format during the paste.."}, {"owner": {"reputation": 79, "user_id": 10075275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107333275ee3414da0aef131cdd8ced0?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10075275/ibrahim"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1533103216, "post_id": 51524230, "comment_id": 90217001, "body": "@Cyril my computer and excel are on the dd/mm/yyyy settings which is the standard in France and on the sheet i&#39;m copying it&#39;s dd/mm/yyyy too. I dont&#39; get it why it&#39;s switches to mm/dd/yyyy  after pasting"}, {"owner": {"reputation": 79, "user_id": 10075275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107333275ee3414da0aef131cdd8ced0?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10075275/ibrahim"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1533112203, "post_id": 51524230, "comment_id": 90221695, "body": "I just noticed something else, for all the dates whose days are &lt;12 i have the switching problem but as soon as the day are &gt;12 it copies correctly surely because we can&#39;t have more than 12 months.I tried to play on application.transpose and application.evaluative but I cannot understand where the error comes from. If I apply this formula <code>(=DATE(YEAR(A3),DAY(A3),MONTH(A3))</code> to the column where the dates are after copying I have the right date but since for  days &gt; 12 are already correct it modifies them too so I can&#39;t blindly apply on all the column. @T.M. @Cyril"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 79, "user_id": 10075275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107333275ee3414da0aef131cdd8ced0?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10075275/ibrahim"}, "edited": false, "score": 1, "creation_date": 1533129565, "post_id": 51524230, "comment_id": 90232956, "body": "@Ibrahimatto I would recommend formatting the entire column at the end of your code.  Those formatted correctly will look the same, and those incorrect will be corrected.  As the date is being correctly displayed using the formula in your previous comment, this seems reasonable, as the data is there, just needs to look different.  I am not positive why VBA paste is making that change; there are lots of posts if you google with the same issue, and all seem to make the same suggestion I made... to ensure your settings are correct (excel, system, OS, etc.), otherwise format the data."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 79, "user_id": 10075275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107333275ee3414da0aef131cdd8ced0?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10075275/ibrahim"}, "edited": false, "score": 1, "creation_date": 1533129940, "post_id": 51524230, "comment_id": 90233243, "body": "@Ibrahimatto .Columns(&quot;K&quot;).NumberFormat = &quot;dd/mm/yyyy&quot; should do it, provided you fix the column to the correct number... i arbitrarily chose K."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1533132545, "post_id": 51524230, "comment_id": 90235192, "body": "Though the date in my tests didn&#39;t deviate, I found the following: apparently actual <b>dates</b> are silently converted to <i>strings</i> if you assign your data range to your array - so try using explicitly the <b><code>.Value2</code></b> property in section [1]:  <code>v = ws.Range(&quot;A2:Z&quot; &amp; n).Value2</code> . Otherwise VBA interprets this assignment by default as pure <i><code>.Value</code></i> property with this unexpected treatment of dates."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1533133327, "post_id": 51524230, "comment_id": 90235753, "body": "<b>Addendum</b> as to the known difference Value2:|Value: the <b><code>Value2</code></b> property is almost identical to the <code>Value</code> property except that the former does not use the Currency and Date data types. Depending on cell formatting (e.g. with date, currency or other formats), So these properties may return different values for the same cell. - Nevertheless I didn&#39;t expect the <b>silent conversion date</b> to string (check with <code>TypeName()</code>) with these apparently imprevisible effects (possibly depending on the current Excel version?) - thx also to @Cyril for his helpful hints."}, {"owner": {"reputation": 79, "user_id": 10075275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107333275ee3414da0aef131cdd8ced0?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10075275/ibrahim"}, "edited": false, "score": 1, "creation_date": 1533201135, "post_id": 51524230, "comment_id": 90262966, "body": "@T.M. it&#39;s working <b>value2</b>, i understand now. Thank you both for the explanation . Now i can focus on trying to retrieve the color, i mean  every color has a code can&#39;t we retrieve that color value? like in the array to retrieve <b>the color index of column F</b>"}, {"owner": {"reputation": 79, "user_id": 10075275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107333275ee3414da0aef131cdd8ced0?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10075275/ibrahim"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1533201167, "post_id": 51524230, "comment_id": 90262991, "body": "@Cyril Thank You"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 79, "user_id": 10075275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107333275ee3414da0aef131cdd8ced0?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10075275/ibrahim"}, "edited": false, "score": 0, "creation_date": 1533202620, "post_id": 51524230, "comment_id": 90263913, "body": "@Ibrahimatto - <code>a)</code> Glad you can use my series of answers in which I invested considerable time; feel free to vote it up if you find it helpful or well researched - <a href=\"https://stackoverflow.com/help/someone-answers\">Someone helps</a>. <code>b)</code> Kindly ask you to formulate a new question not only including the desired behavior, but the core problem or error and the shortest code necessary to reproduce it in the question itself if you didn&#39;t find s. at SO. Such a <i>MCVE</i> saves time and would be helpful for other readers - see <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>"}, {"owner": {"reputation": 79, "user_id": 10075275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107333275ee3414da0aef131cdd8ced0?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10075275/ibrahim"}, "edited": false, "score": 0, "creation_date": 1533213011, "post_id": 51524230, "comment_id": 90270663, "body": "@T.M. i&#39;ve voted, i&#39;ll ask another question for the color thing thank you"}], "tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": true, "score": 4, "last_activity_date": 1533203358, "last_edit_date": 1533203358, "creation_date": 1532538063, "answer_id": 51524230, "question_id": 51519145, "link": "https://stackoverflow.com/questions/51519145/multi-criteria-selection-with-vba/51524230#51524230", "title": "Multi-Criteria Selection with VBA", "body": "<p><strong>Flexible filter solution with multi-criteria</strong></p>\n\n<p>This approach allows a <strong>multi criteria search</strong> defining a search array and using the <code>Application.Index</code> function in an advanced way. This solution allows to <strong>avoid loops</strong> or <strong><code>ReDim s</code></strong>  nearly completely in only a few steps:</p>\n\n<ul>\n<li>[0] Define a criteria array, e.g. <code>criteria = Array(\"condenser\", \"pump\")</code>.</li>\n<li>[1] Assign data A:Z to a 2-dim datafield array:  <code>v = ws.Range(\"A2:Z\" &amp; n)</code>, where n is the last row number and <code>ws</code> the set source sheet object.\n<strong>Caveat:</strong> If your basic data contain any <strong>date formats</strong>, it's strictly recommended to use the <code>.Value2</code> property instead of the automatic default assignment via <code>.Value</code> - for further details see <a href=\"https://stackoverflow.com/questions/51519145/multi-criteria-selection-with-vba/51524230#comment90235192_51524230\">comment</a>.</li>\n<li>[2] Search through column <code>G</code> <em>(=7th col)</em> and build an array containing the found rows via a <em>helper function</em>: <code>a = buildAr(v, 7, criteria)</code>.</li>\n<li>[3] <strong>Filter</strong> based on this array <code>a</code> using the <code>Application.Index</code> function and reduce the returned column values to only <code>A,B,X,Z</code>.</li>\n<li>[4] Write the resulting datafield array <code>v</code> to your target sheet using one command only: e.g. <code>ws2.Range(\"A2\").Resize(UBound(v), UBound(v, 2)) = v</code>, where ws2 is the set target sheet object.</li>\n</ul>\n\n<p><strong>Main procedure <code>MultiCriteria</code></strong></p>\n\n<pre><code>Option Explicit                                 ' declaration head of code module\nDim howMany&amp;                                    ' findings used in both procedures\n\nSub MultiCriteria()\n' Purpose: copy defined columns of filtered rows\n  Dim i&amp;, j&amp;, n&amp;                                 ' row or column counters\n  Dim a, v, criteria, temp                       ' all together variant\n  Dim ws As Worksheet, ws2 As Worksheet          ' declare and set fully qualified references\n  Set ws = ThisWorkbook.Worksheets(\"Sheet1\")      ' &lt;&lt;~~ change to your SOURCE sheet name\n  Set ws2 = ThisWorkbook.Worksheets(\"Sheet2\")     ' &lt;&lt;~~ assign to your TARGET sheet name\n' [0] define criteria\n  criteria = Array(\"condenser\", \"pump\")          ' &lt;&lt;~~ user defined criteria\n' [1] Get data from A1:Z{n}\n  n = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row   ' find last row number n\n  v = ws.Range(\"A2:Z\" &amp; n)                       ' get data cols A:Z and omit header row\n' [2] build array containing found rows\n  a = buildAr(v, 7, criteria)                    ' search in column G = 7\n' [3a] Row Filter based on criteria\n  v = Application.Transpose(Application.Index(v, _\n      a, _\n      Application.Evaluate(\"row(1:\" &amp; 26 &amp; \")\"))) ' all columns\n' [3b] Column Filter A,B,X,Z\n  v = Application.Transpose(Application.Transpose(Application.Index(v, _\n      Application.Evaluate(\"row(1:\" &amp; UBound(a) - LBound(a) + 1 &amp; \")\"), _\n      Array(1, 2, 24, 26))))                  ' only cols A,B,X,Z\n' [3c] correct rows IF only one result row found or no one\n  If howMany &lt;= 1 Then v = correct(v)\n' [4] Copy results array to target sheet, e.g. starting at A2\n  ws2.Range(\"A2\").offset(0, 0).Resize(UBound(v), UBound(v, 2)) = v\nEnd Sub\n</code></pre>\n\n<p><em>Possible addition to check the filtered results array</em></p>\n\n<p>If you want to control the results array in the VB Editor's immediate window, you could add the following section <code>'[5]</code> to the above code:</p>\n\n<pre><code>' [5] [Show results in VB Editor's immediate window]\n  Debug.Print \"2-dim Array Boundaries (r,c): \" &amp; _\n              LBound(v, 1) &amp; \" To \" &amp; UBound(v, 1) &amp; \", \" &amp; _\n              LBound(v, 2) &amp; \" To \" &amp; UBound(v, 2)\n  For i = 1 To UBound(v)\n        Debug.Print i, Join(Application.Index(v, i, 0), \" | \")\n  Next i\n</code></pre>\n\n<p><strong>1st helper function <code>buildAr()</code></strong></p>\n\n<pre><code>Function buildAr(v, ByVal vColumn&amp;, criteria) As Variant\n' Purpose: Helper function to check criteria array (e.g. \"condenser\",\"pump\")\n' Note:    called by main function MultiCriteria in section [2]\nDim found&amp;, found2&amp;, i&amp;, n&amp;, ar: ReDim ar(0 To UBound(v) - 1)\nhowMany = 0      ' reset boolean value to default\n  For i = LBound(v) To UBound(v)\n    found = 0\n    On Error Resume Next    ' avoid not found error\n    found = Application.Match(v(i, vColumn), criteria, 0)\n    If found &gt; 0 Then\n       ar(n) = i\n       n = n + 1\n    End If\n  Next i\n  If n &lt; 2 Then\n     howMany = n: n = 2\n  Else\n     howMany = n\n  End If\n  ReDim Preserve ar(0 To n - 1)\n  buildAr = ar\nEnd Function\n</code></pre>\n\n<p><strong>2nd helper function <code>correct()</code></strong></p>\n\n<pre><code>Function correct(v) As Variant\n' Purpose: reduce array to one row without changing Dimension\n' Note:    called by main function MultiCriteria in section [3c]\nDim j&amp;, temp: If howMany &gt; 1 Then Exit Function\nReDim temp(1 To 1, LBound(v, 2) To UBound(v, 2))\nIf howMany = 1 Then\n   For j = 1 To UBound(v, 2): temp(1, j) = v(1, j): Next j\nElseIf howMany = 0 Then\n   temp(1, 1) = \"N/A# - No results found!\"\nEnd If\ncorrect = temp\nEnd Function\n</code></pre>\n\n<p><strong>Edit I. due to your comment</strong></p>\n\n<blockquote>\n  <p>\"In column G I have a sentence for example (repair to do on the condenser) and I would like that as soon as the word \"condenser\" appears it implies it respects my criteria I tried (\"* condenser*\", \"cex\") like if filename like \"book\" but it doesn't work on an array, is there a method for that?\"</p>\n</blockquote>\n\n<p>Simply change the logic in helper function <code>buildAr()</code> to search via <strong>wild cards</strong> by means of a second loop over the search terms (<code>citeria</code>):</p>\n\n<pre><code>Function buildAr(v, ByVal vColumn&amp;, criteria) As Variant\n' Purpose: Helper function to check criteria array (e.g. \"condenser\",\"pump\")\n' Note:    called by main function MultiCriteria in section [2]\nDim found&amp;, found2&amp;, i&amp;, j&amp;, n&amp;, ar: ReDim ar(0 To UBound(v) - 1)\nhowMany = 0      ' reset boolean value to default\n  For i = LBound(v) To UBound(v)\n    found = 0\n    On Error Resume Next    ' avoid not found error\n    '     ' ** original command commented out**\n    '          found = Application.Match(v(i, vColumn), criteria, 0)\n    For j = LBound(criteria) To UBound(criteria)\n       found = Application.Match(\"*\" &amp; criteria(j) &amp; \"*\", Split(v(i, vColumn) &amp; \" \", \" \"), 0)\n       If found &gt; 0 Then ar(n) = i: n = n + 1: Exit For\n    Next j\n  Next i\n  If n &lt; 2 Then\n     howMany = n: n = 2\n  Else\n     howMany = n\n  End If\n  ReDim Preserve ar(0 To n - 1)\n  buildAr = ar\nEnd Function\n</code></pre>\n\n<p><strong>Edit II. due to last comment - check for existing values in column X only</strong></p>\n\n<blockquote>\n  <p>\"... I saw the change you did but I wanted to apply the last simpler idea, (last comment ) <em>not using the wild Card</em> but instead to <strong>check if there's a value in column X</strong>.\"</p>\n</blockquote>\n\n<p>Simply hange the logic in the helper function to check for existing values only by measuring the length of trimmed values in column 24 (=X) and change the calling code in the main procedure to</p>\n\n<pre><code>' [2] build array containing found rows\n  a = buildAr2(v, 24)                            ' &lt;&lt; check for value in column X = 24\n</code></pre>\n\n<p><em>Note:</em> Section [0] defining criteria won't be needed in this case.</p>\n\n<p><strong>Version 2 of helper function</strong></p>\n\n<pre><code>Function buildAr2(v, ByVal vColumn&amp;, Optional criteria) As Variant\n' Purpose: Helper function to check for existing value e.g. in column 24 (=X)\n' Note:    called by main function MultiCriteria in section [2]\nDim found&amp;, found2&amp;, i&amp;, n&amp;, ar: ReDim ar(0 To UBound(v) - 1)\nhowMany = 0      ' reset boolean value to default\n  For i = LBound(v) To UBound(v)\n    If Len(Trim(v(i, vColumn))) &gt; 0 Then\n       ar(n) = i\n       n = n + 1\n    End If\n  Next i\n  If n &lt; 2 Then\n     howMany = n: n = 2\n  Else\n     howMany = n\n  End If\n  ReDim Preserve ar(0 To n - 1)\n  buildAr2 = ar\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1532589051, "post_id": 51526756, "comment_id": 90033520, "body": "Basically like your approach as it shows an alternative +1. -  Nevertheless there seem to be some issues: 1) the delimiter in <code>Join</code> function possibly should be <code>&quot;&#39;, &#39;&quot;</code> (2) <code>path</code>, <code>sheetName</code> possibly to declare as <code>Variant</code>, outputFilePath is undeclared and unassigned (3) Parameter  excelPath in helper function possibly only <code>Byval excelPath As Variant</code>. Could you test again? (4) In my language version I receive Error No -2147467259 &#39;Tabelle2$&#39; is no valid name calling <code>rs.Open sql, connectionString</code>."}, {"owner": {"reputation": 79, "user_id": 10075275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107333275ee3414da0aef131cdd8ced0?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10075275/ibrahim"}, "edited": false, "score": 0, "creation_date": 1532593798, "post_id": 51526756, "comment_id": 90036231, "body": "Thanks for your help but I have little knowledge of vba and sql as well as programming so I used the help form T.M which seemed simpler to me because I managed to understand a bit more in addition to his explanations. But I still wanted to thank you for the time and effort you put into trying to help me."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1532609807, "post_id": 51526756, "comment_id": 90046330, "body": "@T.M. I&#39;ve fixed the first three errors (it&#39;s kind of you to suggest that I tested this code once; I wrote it of the top of my head without testing at all). RE the fourth issue -- it works by me; could you put the full SQL in a comment here?"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1532632368, "post_id": 51526756, "comment_id": 90059728, "body": "Zev: <code>SELECT F1, F2, F24, F26 FROM [Tabelle1$] IN &quot;D:\\Daten\\Excel\\_VBA Bsp\\Stack\\AllTogether.xlsx&quot; &quot;Excel 12.0;&quot; WHERE F7 IN (&#39;condenser&#39;, &#39;pump&#39;) UNION ALL SELECT F1, F2, F24, F26 FROM [Tabelle1$] IN &quot;D:\\Daten\\Excel\\_VBA Bsp\\Stack\\AllTogether.xlsx&quot; &quot;Excel 12.0;&quot; WHERE F7 IN (&#39;condenser&#39;, &#39;pump&#39;) UNION ALL SELECT F1, F2, F24, F26 FROM [Tabelle2$] IN &quot;D:\\Daten\\Excel\\_VBA Bsp\\Stack\\AllTogether.xlsx&quot; &quot;Excel 12.0;&quot; WHERE F7 IN (&#39;condenser&#39;, &#39;pump&#39;) UNION ALL SELECT F1, F2, F24, F26 FROM [Tabelle3$] IN &quot;D:\\Daten\\Excel\\_VBA Bsp\\Stack\\AllTogether.xlsx&quot; &quot;Excel 12.0;&quot; WHERE F7 IN (&#39;condenser&#39;, &#39;pump&#39;)</code>"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1532632463, "post_id": 51526756, "comment_id": 90059779, "body": "@ZevSpitz, thx having a look. [2] <code>connectionString = Provider=Microsoft.ACE.OLEDB.12.0;Data Source=&quot;D:\\Daten\\Excel\\_VBA Bsp\\Stack\\MultiCriteria.xlsm&quot;;Extended Properties=&quot;Excel 12.0;HDR=No&quot; </code>"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1533050138, "post_id": 51526756, "comment_id": 90198900, "body": "@T.M. Could you write the names of the actual worksheets that are in the workbook?"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1533060018, "post_id": 51526756, "comment_id": 90204391, "body": "My worksheet names are &quot;Tabelle1&quot;,&quot;Tabelle2&quot;,&quot;Tabelle3&quot;. Running your edited version now with 2 test files I get Error No -2147217904 (translated message: <i>For at least one needed parameter wasn&#39;t indicated a value.</i>). Possibly missing suffix <code>UNION ALL SELECT F1, F2, F24, F26</code> in last query condition?"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1533066634, "post_id": 51526756, "comment_id": 90207516, "body": "@T.M. Do you have any named ranges? What happens if you try to run each individual SQL statement separately?"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1533194120, "post_id": 51526756, "comment_id": 90258804, "body": "No, didn&#39;t have any named range, but have mistyped or left blank needed row headers (works now as intended); thanks for your patience. BTW learnt from your approach +1- @ZevSpitz."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1533197214, "post_id": 51526756, "comment_id": 90260625, "body": "@T.M. Note that if you want to use your headers instead of autogenerated ones (<code>F1</code>, <code>F2</code> etc.) you can specify <code>HDR=Yes</code> in the connection string (instead of <code>HDR=No</code>."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1533197303, "post_id": 51526756, "comment_id": 90260685, "body": "@T.M. Also, I should point out that <code>Tabelle1$</code> seems to be selected from twice. Not sure why."}], "tags": [], "owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "is_accepted": false, "score": 1, "last_activity_date": 1533066480, "last_edit_date": 1533066480, "creation_date": 1532548621, "answer_id": 51526756, "question_id": 51519145, "link": "https://stackoverflow.com/questions/51519145/multi-criteria-selection-with-vba/51526756#51526756", "title": "Multi-Criteria Selection with VBA", "body": "<p>I would create an SQL statement to read from the various sheets using ADODB, and then use CopyFromRecordset to paste into the destination sheet.</p>\n\n<p>Add a reference (<strong>Tools</strong> -> <strong>References...</strong>) to <strong>Microsoft ActiveX Data Objects</strong>. (Choose the latest version; it's usually 6.1).</p>\n\n<p>The following helper function returns the sheet names as a <code>Collection</code> for a given Excel file path:</p>\n\n<pre><code>Function GetSheetNames(ByVal excelPath As String) As Collection\n    Dim connectionString As String\n    connectionString = _\n        \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n        \"Data Source=\"\"\" &amp; excelPath &amp; \"\"\";\" &amp; _\n        \"Extended Properties=\"\"Excel 12.0;HDR=No\"\"\"            \n\n    Dim conn As New ADODB.Connection\n    conn.Open connectionString\n\n    Dim schema As ADODB.Recordset\n    Set schema = conn.OpenSchema(adSchemaTables)\n\n    Dim sheetName As Variant\n    Dim ret As New Collection\n    For Each sheetname In schema.GetRows(, , \"TABLE_NAME\")\n        ret.Add sheetName\n    Next\n\n    conn.Close\n    Set GetSheetNames = ret\nEnd Function\n</code></pre>\n\n<p>Then, you can use the following:</p>\n\n<pre><code>Dim paths As Variant\npaths = Array(\"c:\\path\\to\\first.xlsx\", \"c:\\path\\to\\second.xlsx\")\n\nDim terms As String\nterms = \"'\" &amp; Join(Array(\"condenser\", \"pump\"), \"', '\") &amp; \"'\"\n\nDim path As Variant\nDim sheetName As Variant\nDim sql As String\nFor Each path In paths\n    For Each sheetName In GetSheetNames(path)\n        If Len(sql) &gt; 0 Then sql = sql &amp; \" UNION ALL \"\n        sql = sql &amp; _\n            \"SELECT F1, F2, F24, F26 \" &amp; _\n            \"FROM [\" &amp; sheetName &amp; \"] \" &amp; _\n                \"IN \"\"\" &amp; path &amp; \"\"\" \"\"Excel 12.0;\"\" \" &amp; _\n            \"WHERE F7 IN (\" &amp; terms &amp; \")\"\n    Next\nNext\n\n'We're connecting here to the current Excel file, but it doesn't really matter to which file we are connecting\nDim connectionString As String\nconnectionString = _\n    \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n    \"Data Source=\"\"\" &amp; ActiveWorkbook.FullName &amp; \"\"\";\" &amp; _\n    \"Extended Properties=\"\"Excel 12.0;HDR=No\"\"\"     \n\nDim rs As New ADODB.Recordset\nrs.Open sql, connectionString\n\nWorksheets(\"Destination\").Range(\"A1\").CopyFromRecordset rs\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 10075275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107333275ee3414da0aef131cdd8ced0?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10075275/ibrahim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 994, "favorite_count": 2, "accepted_answer_id": 51524230, "answer_count": 3, "score": 1, "last_activity_date": 1533203358, "creation_date": 1532522431, "last_edit_date": 1532594390, "question_id": 51519145, "link": "https://stackoverflow.com/questions/51519145/multi-criteria-selection-with-vba", "title": "Multi-Criteria Selection with VBA", "body": "<p>I have created a macro that allows me to open multiple files based on their names and copy sheets into one on another workbook. Now I would like to add some criteria, I determine the last row with data. I used this: </p>\n\n<pre><code>lstRow2 = alarms.Cells(alarms.Rows.Count, \"A\").End(xlUp).Row\n</code></pre>\n\n<p>And now i want to go through each row and check if column <code>G</code> of each rows contains strings like (<code>\"condenser\", \"pump\"</code>, etc) if yes copy the row but not the whole row, only a series of columns belonging to the row (for example for each row that match my criteria  copy those columns <code>A-B-X-Z</code>) and finally copy all that in another sheet.</p>\n\n<p>Thanks for your help </p>\n"}, {"tags": ["html", "excel", "vba", "dom", "iframe"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1532521544, "post_id": 51518627, "comment_id": 90006326, "body": "Please use snippet tool to add html code in. Not as image. As I can&#39;t copy from that image my answer is rather short."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1532521738, "post_id": 51518627, "comment_id": 90006463, "body": "My question would be, why are you trying to read the document to a cell? You already have access to the DOM, can you not just retrieve whatever it is that you need directly from the page?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1532521818, "post_id": 51518627, "comment_id": 90006511, "body": "@Zac Good question. Lol.  Also, they may be hitting the same origin policy. Hard to say without knowing the original URL."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1532523518, "post_id": 51518627, "comment_id": 90007700, "body": "@QHarr : good shout!"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7017901, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jZjkbsZB4wA/AAAAAAAAAAI/AAAAAAAABKc/GaLgCJIy5lo/photo.jpg?sz=128", "display_name": "Som", "link": "https://stackoverflow.com/users/7017901/som"}, "edited": false, "score": 0, "creation_date": 1532628111, "post_id": 51518832, "comment_id": 90057825, "body": "Thanks for the hint @QHarr. I have picked up this src and written a code explicitly for this src and it worked perfectly fine as per my requirement. Thank you very much for your perfect explanation. :)"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1532521971, "last_edit_date": 1532521971, "creation_date": 1532521475, "answer_id": 51518832, "question_id": 51518627, "link": "https://stackoverflow.com/questions/51518627/vba-code-unable-to-read-the-complete-html-within-the-iframe/51518832#51518832", "title": "VBA code unable to read the complete html within the iframe", "body": "<p>The document is loaded from a different src. Try using <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest\" rel=\"nofollow noreferrer\">XHR</a>/IE\n to that src link and grab the response text.</p>\n\n<p>src</p>\n\n<p><a href=\"https://i.stack.imgur.com/YDeAq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YDeAq.png\" alt=\"Image\"></a></p>\n"}], "owner": {"reputation": 13, "user_id": 7017901, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jZjkbsZB4wA/AAAAAAAAAAI/AAAAAAAABKc/GaLgCJIy5lo/photo.jpg?sz=128", "display_name": "Som", "link": "https://stackoverflow.com/users/7017901/som"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 51518832, "answer_count": 1, "score": 0, "last_activity_date": 1532521971, "creation_date": 1532520873, "question_id": 51518627, "link": "https://stackoverflow.com/questions/51518627/vba-code-unable-to-read-the-complete-html-within-the-iframe", "title": "VBA code unable to read the complete html within the iframe", "body": "<p>I am writing a VBA code in excel to open a webpage and read all the HTML content in the DOM explorer of the webpage and store it in a cell in the excel. </p>\n\n<p>I am pasting my code below; this code skips the HTML content that is within the iframe of the main HTML. (Basically it skips the secondary HTML within the main HTML). But I need to view the complete HTML from the DOM explorer. Can someone pls help me here?</p>\n\n<pre><code>Sub WebPage_SourceCode()\n    Dim IEapp As InternetExplorer\n    Dim WebUrl As String\n    Dim Doc As HTMLDocument\n    Dim Elements As IHTMLElementCollection\n\n    Set IEapp = New InternetExplorer\n    WebUrl = \"https://abcd.com/\"\n\n    With IEapp\n        .Silent = True\n        .Visible = True\n        .Navigate WebUrl\n\n        Do While .Busy = True Or .READYSTATE &lt;&gt; 4\n            DoEvents\n        Loop\n    End With\n\n        pagesource = IEapp.Document.body.innerHTML\n        Cells(1, 1) = pagesource\n\n End Sub\n</code></pre>\n\n<p>I've also tried to get the elements by each iframe and store it in different cells by using the below code, but the elements within the HTML after the iframe tag is read.</p>\n\n<pre><code>Set Doc = IEapp.Document\n        Set Elements = Doc.getElementsByTagName(\"iframe\")          \n\n        i = 1\n        For Each element In Elements\n                Cells(i, 1) = element.className\n                Cells(i, 2) = element.innerHTML\n                Cells(i, 3) = element.outerHTML\n                i = i + 1                    \n        Next\n</code></pre>\n\n<p>Below is the link to the portion of the HTML. The HTML within the iframe (highlighted in red border) is skipped by VBA. Anycode before and after the iframe is read by VBA.</p>\n\n<p><a href=\"https://i.stack.imgur.com/e3b1y.jpg\" rel=\"nofollow noreferrer\">Sample of Source HTML Code</a></p>\n"}, {"tags": ["vba", "replace", "count", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1533384157, "post_id": 51517875, "comment_id": 90332779, "body": "Has your question been answered?"}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 1, "last_activity_date": 1532520194, "creation_date": 1532520194, "answer_id": 51518404, "question_id": 51517875, "link": "https://stackoverflow.com/questions/51517875/extract-count-from-findreplace-in-word-vba/51518404#51518404", "title": "extract count from find&amp;replace in Word vba", "body": "<p>You can't - that isn't exposed to the developer, unfortunately! </p>\n\n<p>But you don't necessarily have to loop Word's Find. You can use other functionality which executes faster than the object model to count the number of instances of a string. For example loop <code>Instr</code> to count the number of instances:</p>\n\n<pre><code>Sub TestGetCountOfFoundInstances()\n    Dim rng As Word.Range\n    Dim searchTerm As String\n    Dim nrInstances As Long\n    Dim bFound As Boolean\n\n    searchTerm = Chr(13)\n    Set rng = Selection.Range\n    nrInstances = CountNrInstancesSearchTerm(rng, searchTerm)\n    Debug.Print \"The term \" &amp; searchTerm &amp; \" was found \" &amp; nrInstances &amp; _\n                \" times.\"\n    bFound = rng.Find.Execute(findText:=\"^p\", ReplaceWith:=\"^l\", Replace:=wdReplaceAll)\nEnd Sub\n\nFunction CountNrInstancesSearchTerm( _\n         rng As Word.Range, searchTerm As String) As Long\n    Dim counter As Long, loc As Long, startPos As Long\n    Dim t As String\n\n    t = rng.Text\n    startPos = 1\n    Do\n        loc = InStr(startPos, t, searchTerm)\n        If loc &gt; 0 Then\n            counter = counter + 1\n            startPos = loc + 1\n        End If\n    Loop While loc &gt; 0\n    CountNrInstancesSearchTerm = counter\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10122241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0195fd369250777c48f1a62cbe444304?s=128&d=identicon&r=PG&f=1", "display_name": "Bek_Fleitjie", "link": "https://stackoverflow.com/users/10122241/bek-fleitjie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593730992, "creation_date": 1532518430, "last_edit_date": 1593730992, "question_id": 51517875, "link": "https://stackoverflow.com/questions/51517875/extract-count-from-findreplace-in-word-vba", "title": "extract count from find&amp;replace in Word vba", "body": "<p>I have a macro which searches for a paragraph break (\"^p\") in a selection of text. I notice that, in the <a href=\"https://i.stack.imgur.com/dyOPT.png\" rel=\"nofollow noreferrer\">Advanced Find &amp; Replace Screen</a>, word tells you how many instances of the search item has been found. How do I extract this count?</p>\n\n<p>I have recorded a VBA macro which does the find in a selection, but I don't know how to extract the number of occurrences from that selection. Does anyone know how to do this (would prefer to just extract it from the find&amp;replace function as opposed to writing a for-loop)?</p>\n\n<pre><code>Selection.Find.ClearFormatting\n   With Selection.Find\n    .Text = \"^p\"\n    .Replacement.Text = \"\"\n    .Forward = True\n    .Wrap = wdFindAsk\n    .Format = False\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchWildcards = False\n    .MatchSoundsLike = False\n    .MatchAllWordForms = False\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1532518404, "post_id": 51517834, "comment_id": 90004114, "body": "Welcome to Stack Overflow: Please <a href=\"https://stackoverflow.com/tour\">take the tour</a> and read <a href=\"https://stackoverflow.com/help/how-to-ask\">How to ask a good question</a>, then edit your question to include the code, expected behaviour, and what is wrong... then we can try to help"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1532518490, "post_id": 51517834, "comment_id": 90004164, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/47554289/split-text-to-columns-in-excel\">split text to columns in excel</a>"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1532518514, "post_id": 51517834, "comment_id": 90004175, "body": "I Downvoted/voted to close because you didn&#39;t include a <a href=\"http://idownvotedbecau.se/nomcve/\" rel=\"nofollow noreferrer\">Minimal, Complete, Verifiable Example</a> , it looks like <a href=\"http://idownvotedbecau.se/noattempt/\" rel=\"nofollow noreferrer\">no attempt was made</a>, and it looks like <a href=\"http://idownvotedbecau.se/noresearch/\" rel=\"nofollow noreferrer\">no research</a> was done."}, {"owner": {"reputation": 133, "user_id": 9433566, "user_type": "registered", "profile_image": "https://graph.facebook.com/1858556497510549/picture?type=large", "display_name": "Anca Vulc", "link": "https://stackoverflow.com/users/9433566/anca-vulc"}, "reply_to_user": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1532518647, "post_id": 51517834, "comment_id": 90004253, "body": "My idea was to try it with arrays, but I didn&#39;t find any tutorials on youtube specifically for that, so I have no ideas left of how to deal with it"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 1, "creation_date": 1532518694, "post_id": 51517834, "comment_id": 90004286, "body": "<a href=\"https://www.techonthenet.com/excel/formulas/split.php\" rel=\"nofollow noreferrer\">Split</a> function was built for this problem"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1532518890, "post_id": 51517834, "comment_id": 90004418, "body": "@AncaVulc: have you looked at <a href=\"https://support.office.com/en-us/article/split-text-into-different-columns-with-the-convert-text-to-columns-wizard-30b14928-5550-41f5-97ca-7a3e9c363ed7\" rel=\"nofollow noreferrer\">MSDN: Text to Columns</a> or as Vegard says, <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/split-function\" rel=\"nofollow noreferrer\">MSDN: VBA Split Function</a>"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1532518930, "post_id": 51517834, "comment_id": 90004448, "body": "@AncaVulc: your answer is also in the <a href=\"https://stackoverflow.com/questions/15792642/how-to-split-data-in-a-column-into-two-separate-columns\">duplicate question I highlight earlier</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 0, "last_activity_date": 1532518798, "creation_date": 1532518798, "answer_id": 51517983, "question_id": 51517834, "link": "https://stackoverflow.com/questions/51517834/split-cell-content-by-using-vba-or-excel-formula/51517983#51517983", "title": "Split cell content by &quot;&#39;;&quot; using VBA or Excel formula", "body": "<p>I believe the following should work as you expect it to, simply amend the worksheet you are using, the cell you are referring to and the Column you wish your results to be placed in:</p>\n\n<pre><code>Sub foo()\nDim ws As Worksheet: Set ws = Sheets(\"Sheet1\")\n'declare and set the worksheet you are working with\nDim newvar As Variant, var As String\nvar = ws.Range(\"A1\").Value\n'get the contents of your desired cell, in this case A1\nnewvar = Split(var, \";\") 'split the cell contents by delimiter ; into an array\n\nFor i = LBound(newvar) To UBound(newvar) 'loop through array to place values into column B\n    ws.Cells(i + 1, \"B\").Value = newvar(i)\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26, "user_id": 1918718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43886f2ce218ce1bbe24acf4a909d618?s=128&d=identicon&r=PG", "display_name": "clevervikas", "link": "https://stackoverflow.com/users/1918718/clevervikas"}, "is_accepted": true, "score": 1, "last_activity_date": 1532519419, "creation_date": 1532519419, "answer_id": 51518190, "question_id": 51517834, "link": "https://stackoverflow.com/questions/51517834/split-cell-content-by-using-vba-or-excel-formula/51518190#51518190", "title": "Split cell content by &quot;&#39;;&quot; using VBA or Excel formula", "body": "<p>you can use Split function and pass delimiter (;in your case)</p>\n\n<p>for Example:</p>\n\n<pre><code>Var arrayResult = Split(\"A11;B22;C33\",\";\")\n</code></pre>\n\n<p>you can also use text to column utility in excel.</p>\n\n<p>select the text you want to separate </p>\n\n<ul>\n<li>go to DATA ></li>\n<li>select text to column></li>\n<li>select delimited option click Next></li>\n<li>select your favorite delimiter ;</li>\n<li>click next</li>\n</ul>\n\n<p>you will get the separate values.</p>\n"}], "owner": {"reputation": 133, "user_id": 9433566, "user_type": "registered", "profile_image": "https://graph.facebook.com/1858556497510549/picture?type=large", "display_name": "Anca Vulc", "link": "https://stackoverflow.com/users/9433566/anca-vulc"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "closed_date": 1532530106, "accepted_answer_id": 51518190, "answer_count": 2, "score": -2, "last_activity_date": 1532519419, "creation_date": 1532518266, "last_edit_date": 1532518780, "question_id": 51517834, "link": "https://stackoverflow.com/questions/51517834/split-cell-content-by-using-vba-or-excel-formula", "closed_reason": "Needs more focus", "title": "Split cell content by &quot;&#39;;&quot; using VBA or Excel formula", "body": "<p>I am new to VBA, so I have trouble writing code in VBA. My problem is writing a code or an Excel formula to extract (for later use) the identifiers that are written in the same cell, split by \";\".</p>\n\n<p>For example, this is what I have on a cell:\nA11;B22;C33</p>\n\n<p>I need to select A11, B22, C33, as they were written for example, on a column, as different cells, so I can later use them in other formulas.\nI don't want to split the content into different columns, I just want to be able to use A11 or B11 furthermore, without editing it in the databse</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 32, "user_id": 8438997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b8f8c9752d64b6df7ce5cf4c875d5aa?s=128&d=identicon&r=PG&f=1", "display_name": "Paul92ilm", "link": "https://stackoverflow.com/users/8438997/paul92ilm"}, "edited": false, "score": 1, "creation_date": 1532518159, "post_id": 51517662, "comment_id": 90003952, "body": "The following subject will help you : <a href=\"https://stackoverflow.com/questions/11707888/sum-function-in-vba\">stackoverflow.com/questions/11707888/sum-function-in-vba</a>"}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1532518619, "last_edit_date": 1532518619, "creation_date": 1532518259, "answer_id": 51517832, "question_id": 51517662, "link": "https://stackoverflow.com/questions/51517662/function-sum-vba/51517832#51517832", "title": "function SUM vba", "body": "<p>This formula</p>\n\n<pre><code>Range(\"A1\").Formula = \"=SUM(Feuil2!AC10, -Feuil2!AC11)\"\n</code></pre>\n\n<p>subtracts sheet Feuil2 cell AC11 from Feuil2 cell AC10.</p>\n\n<p>If you want to use the <code>AC</code> as column name <strong>variable</strong> then you must use</p>\n\n<pre><code>Sub WriteSumFormula(SumColumn As String)\n    Sheets(\"Feuil4\").Range(\"A1\").Formula = \"=SUM(Feuil2!\" &amp; SumColumn &amp; \"10, -Feuil2!\" &amp; SumColumn &amp; \"11)\"\nEnd Sub    \n</code></pre>\n\n<p>Also use descriptive variable and function names to make life easier and get better maintainable code. You cannot name 2 different subs <code>TEST</code>. Names must be unique.</p>\n\n<p>Then this Test</p>\n\n<pre><code>Sub TestWriteSumFormula()\n    Call WriteSumFormula(\"B\")\nEnd Sub\n</code></pre>\n\n<p>should write the formula <code>=SUM(Feuil2!B10, -Feuil2!B11)</code> into cell A1.</p>\n"}, {"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 0, "last_activity_date": 1532518322, "creation_date": 1532518322, "answer_id": 51517850, "question_id": 51517662, "link": "https://stackoverflow.com/questions/51517662/function-sum-vba/51517850#51517850", "title": "function SUM vba", "body": "<p>The following should work too, please bear in mind I renamed one of your Subs as they can't both be named \"TEST\":</p>\n\n<pre><code>Sub TEST(AC As String)\n    Sheets(\"Feuil4\").Range(\"A1\").Formula = \"=SUM(Feuil2!\" &amp; AC &amp; \"10, -Feuil2!\" &amp; AC &amp; \"11)\"\nEnd Sub\n\nSub TESTS() 'renamed this\n    Call TEST(\"B\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10133065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b92239d634dac518fd6117bb555c02b4?s=128&d=identicon&r=PG&f=1", "display_name": "imaneyass", "link": "https://stackoverflow.com/users/10133065/imaneyass"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 179, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1549012444, "creation_date": 1532517733, "last_edit_date": 1549012444, "question_id": 51517662, "link": "https://stackoverflow.com/questions/51517662/function-sum-vba", "title": "function SUM vba", "body": "<p>I want to use the function <code>SUM</code> of different cells from different columns, I used this syntax but it doesn't work, it returns always <code>0</code>:</p>\n\n<pre><code>Sub test(AC As String)\n    Sheets(\"Feuil4\").Activate\n    Range(\"A1\").Formula = \"=SUM(Feuil2!AC10, -Feuil2!AC11)\"\nEnd Sub\n\nSub TEST()\n    Call test(\"B\")\nEnd Sub \n</code></pre>\n\n<p>I also tried: <code>Range(\"A1\").Formula = \"=SUM(Feuil2!AC &amp; 10, -Feuil2!AC &amp; 11)\"</code> \nit doesn't work either.</p>\n"}, {"tags": ["vba", "excel", "vbscript"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1532518755, "post_id": 51517423, "comment_id": 90004326, "body": "Failed in what way? What happended? Did you get error messages/codes?"}, {"owner": {"reputation": 39, "user_id": 7210260, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10209991456878624/picture?type=large", "display_name": "Tarik Handaz", "link": "https://stackoverflow.com/users/7210260/tarik-handaz"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1532524808, "post_id": 51517423, "comment_id": 90008580, "body": "the code is 800A03Ec , methode add of OLEObjects failed"}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 8842255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6841e16e8859e8aafd48366d011cbecf?s=128&d=identicon&r=PG&f=1", "display_name": "TAOUFIK BEZZOT", "link": "https://stackoverflow.com/users/8842255/taoufik-bezzot"}, "is_accepted": true, "score": 1, "last_activity_date": 1532528423, "creation_date": 1532528423, "answer_id": 51521275, "question_id": 51517423, "link": "https://stackoverflow.com/questions/51517423/add-oleobjects-work-inside-macro-and-fail-if-executed-as-vbs-script-in-cmd/51521275#51521275", "title": "Add OLEObjects work inside macro and fail if executed as vbs script in cmd", "body": "<p>I get the same thing when I run your code. I tried a few different tweaks  and it works:\nyou simply forgot the first parameter of the add function of OLEobject and dont forget to remove the parameters names :</p>\n\n<pre><code> Set objExcel = CreateObject(\"Excel.Application\")\n    Set objWorkbook = objExcel.Workbooks.Open(\"YourPath\\Datasheet.xlsx\")\n    objExcel.Application.Visible = false\n    Set ob = objWorkbook.ActiveSheet.OLEObjects\n    Set t = ob.Add (,\"YourPath\\Placeholder.txt\",False, True,    \"C:\\Windows\\system32\\packager.dll\", 0,\"C:\\Placeholder.txt\")\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 7210260, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10209991456878624/picture?type=large", "display_name": "Tarik Handaz", "link": "https://stackoverflow.com/users/7210260/tarik-handaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 0, "accepted_answer_id": 51521275, "answer_count": 1, "score": 0, "last_activity_date": 1532528423, "creation_date": 1532516980, "last_edit_date": 1532524594, "question_id": 51517423, "link": "https://stackoverflow.com/questions/51517423/add-oleobjects-work-inside-macro-and-fail-if-executed-as-vbs-script-in-cmd", "title": "Add OLEObjects work inside macro and fail if executed as vbs script in cmd", "body": "<p>code executed inside the excel file (xlsm) work perfectly </p>\n\n<pre><code> Sub insertObject()\n    Set objExcel = CreateObject(\"Excel.Application\")\n    Set objWorkbook = objExcel.Workbooks.Open(\"YourPath\\Datasheet.xlsx\")\n    objExcel.Application.Visible = True\n    objWorkbook.ActiveSheet.OLEObjects.Add(Filename:=\"YourPath\\Placeholder.txt\", _\n            Link:=False, DisplayAsIcon:=True, IconFileName:= _\n            \"C:\\Windows\\system32\\packager.dll\", IconIndex:=0, IconLabel:= _\n            \"C:\\Placeholder.txt\").Select\n    objWorkbook.SaveAs \"yourPath\\test.xlsx\"\n    objExcel.ActiveWorkbook.Close\n    objExcel.Application.Quit\n    WScript.Quit\n    End Sub\n</code></pre>\n\n<p>this is the code i try to execute using vbs script </p>\n\n<pre><code>Set objExcel = CreateObject(\"Excel.Application\")\nSet objWorkbook = objExcel.Workbooks.Open(\"YourPath\\Datasheet.xlsx\")\nobjExcel.Application.Visible = True\nActiveSheet.OLEObjects.Add(Filename:=\"YourPath\\Placeholder.txt\", _\n        Link:=False, DisplayAsIcon:=True, IconFileName:= _\n        \"C:\\Windows\\system32\\packager.dll\", IconIndex:=0, IconLabel:= _\n        \"C:\\Placeholder.txt\").Select\nobjWorkbook.SaveAs \"YourPath\\test.xlsx\"\nobjExcel.ActiveWorkbook.Close\nobjExcel.Application.Quit\nWScript.Quit\n</code></pre>\n\n<p>i replace the paths with the real ones of course the code work perfectly inside the macro but failed  inside vbs script when i try to run it using the cmd command. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 2, "creation_date": 1532516492, "post_id": 51517255, "comment_id": 90002912, "body": "It depends on criteria. But probably you can play with the line that says <code>If Not dict.Exists(cell.Value) Then</code> adding your conditions there. Something like <code>If Not dict.Exists(cell.Value) And cell.value &gt; Parameter1 And cell.value &lt; Parameter2 Then...</code> Just an example"}], "answers": [{"comments": [{"owner": {"reputation": 743, "user_id": 528859, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c7d2e4c1cc46163298f8a8557a596ff5?s=128&d=identicon&r=PG", "display_name": "dofine", "link": "https://stackoverflow.com/users/528859/dofine"}, "edited": false, "score": 0, "creation_date": 1533693869, "post_id": 51517339, "comment_id": 90435806, "body": "Hi, I may need the params range like countifs(&quot;A:A&quot;, &quot;&gt;=3&quot;)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 743, "user_id": 528859, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c7d2e4c1cc46163298f8a8557a596ff5?s=128&d=identicon&r=PG", "display_name": "dofine", "link": "https://stackoverflow.com/users/528859/dofine"}, "edited": false, "score": 0, "creation_date": 1533715851, "post_id": 51517339, "comment_id": 90443245, "body": "@dofine - hi, this seems like a new question. Make sure to put the code in it and what you have tried so far."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1532516675, "creation_date": 1532516675, "answer_id": 51517339, "question_id": 51517255, "link": "https://stackoverflow.com/questions/51517255/create-vba-macro-to-calculate-unique-value-count-with-multitple-criteria/51517339#51517339", "title": "Create VBA macro to calculate unique value count with multitple criteria", "body": "<p>This is what I have created:</p>\n\n<p><a href=\"https://i.stack.imgur.com/sTw2n.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sTw2n.png\" alt=\"enter image description here\"></a></p>\n\n<p>The code looks like this:</p>\n\n<pre><code>Public Function CountUnique(inputRange As Range, paramRange As Range) As Long\n\n    Dim dict As New Dictionary\n    Dim cellInput As Range\n    Dim cellParam As Range\n    Dim keepLooking As Boolean\n\n    For Each cellParam In paramRange\n        keepLooking = True\n        For Each cellInput In inputRange\n            If cellParam.Value2 = cellInput.Value2 And keepLooking Then\n                If Not dict.Exists(cellInput.Value2) Then\n                    dict.Add cellInput, 0\n                    keepLooking = False\n                End If\n            End If\n        Next\n    Next\n    CountUnique = dict.Count\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 743, "user_id": 528859, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c7d2e4c1cc46163298f8a8557a596ff5?s=128&d=identicon&r=PG", "display_name": "dofine", "link": "https://stackoverflow.com/users/528859/dofine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1532516779, "creation_date": 1532516372, "last_edit_date": 1532516779, "question_id": 51517255, "link": "https://stackoverflow.com/questions/51517255/create-vba-macro-to-calculate-unique-value-count-with-multitple-criteria", "title": "Create VBA macro to calculate unique value count with multitple criteria", "body": "<p>Below is an VBA function to calculate unique values count (Credit to <a href=\"https://stackoverflow.com/a/17857333/528859\">SO: Count unique values in Excel</a>)\nis it possible to add criteria paramaters? Like in the function \"countifs\"?</p>\n\n<pre><code>   Public Function CountUnique(rng As Range) As Integer\n    Dim dict As Dictionary\n    Dim cell As Range\n    Set dict = New Dictionary\n    For Each cell In rng.Cells\n         If Not dict.Exists(cell.Value) Then\n            dict.Add cell.Value, 0\n        End If\n    Next\n    CountUnique = dict.Count\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "autofill"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1532516936, "post_id": 51516941, "comment_id": 90003180, "body": "Please tag with the overall technology. There are many environments that use macros."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1532594662, "post_id": 51516941, "comment_id": 90036851, "body": "There are several spaces in your code at wrong places and also these smart quotes <code>\u201c \u201d</code> are not excepted by VBA and must be replaced with standard quotes <code>&quot; &quot;</code>. Otherwise your code is no valid syntax and won&#39;t excecute!"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 10072068, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TcoUfTMSD94/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qvJMtDuXcgMIPC1Ng65wVE4NsDOA/mo/photo.jpg?sz=128", "display_name": "Girl", "link": "https://stackoverflow.com/users/10072068/girl"}, "edited": false, "score": 0, "creation_date": 1532520226, "post_id": 51517392, "comment_id": 90005344, "body": "Hi I am having an error in the line you have provided"}, {"owner": {"reputation": 16, "user_id": 10133012, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QJ79ImuxB9k/AAAAAAAAAAI/AAAAAAAAAEY/T-FSF5GH53U/photo.jpg?sz=128", "display_name": "Henrik K", "link": "https://stackoverflow.com/users/10133012/henrik-k"}, "reply_to_user": {"reputation": 43, "user_id": 10072068, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TcoUfTMSD94/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qvJMtDuXcgMIPC1Ng65wVE4NsDOA/mo/photo.jpg?sz=128", "display_name": "Girl", "link": "https://stackoverflow.com/users/10072068/girl"}, "edited": false, "score": 0, "creation_date": 1532607471, "post_id": 51517392, "comment_id": 90044787, "body": "@Lyn Where do you get the error, and what kind of error do you get?"}], "tags": [], "owner": {"reputation": 16, "user_id": 10133012, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QJ79ImuxB9k/AAAAAAAAAAI/AAAAAAAAAEY/T-FSF5GH53U/photo.jpg?sz=128", "display_name": "Henrik K", "link": "https://stackoverflow.com/users/10133012/henrik-k"}, "is_accepted": true, "score": 0, "last_activity_date": 1532516893, "creation_date": 1532516893, "answer_id": 51517392, "question_id": 51516941, "link": "https://stackoverflow.com/questions/51516941/macro-on-auto-fill-down/51517392#51517392", "title": "Macro on auto fill down", "body": "<p>If you don't have any empty cells in column A then this should work fine.</p>\n\n<pre><code>Dim lRow As Long\n\nlRow = Range(\"A1\").End(xlDown).Row\n\nSheets(\"CE\").Range(\"L2:T2\").AutoFill Destination:=Range(\"L2:T\" &amp; lRow)\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10072068, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TcoUfTMSD94/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qvJMtDuXcgMIPC1Ng65wVE4NsDOA/mo/photo.jpg?sz=128", "display_name": "Girl", "link": "https://stackoverflow.com/users/10072068/girl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "accepted_answer_id": 51517392, "answer_count": 1, "score": 0, "last_activity_date": 1532594538, "creation_date": 1532515381, "last_edit_date": 1532594538, "question_id": 51516941, "link": "https://stackoverflow.com/questions/51516941/macro-on-auto-fill-down", "title": "Macro on auto fill down", "body": "<p>I have this code</p>\n\n<pre><code>Sheets(\u201cCE\u201d). Select\nRange(\u201cL2:T2\u201d). Select\nSelection. Auto fill destination: =range(\u201cL2:T83\u201d)\n</code></pre>\n\n<p>I would like to have the Range changed to whatever the column A has. It should be flexible and auto adjustable. </p>\n\n<pre><code>Selection. Auto fill destination: =range(\u201cL2:T83\u201d)\n</code></pre>\n"}, {"tags": ["excel", "vba", "filesystemobject"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1532514233, "post_id": 51516381, "comment_id": 90001441, "body": "Why not do what your doing in the <code>For</code> loop in the <code>While</code> loop?  Currently <code>&quot;i&quot;</code> is a string, for the value of <code>i</code> just use <code>i</code> (i.e. without quotes)."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 9613229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3117e3559f2fa95dab7bff89b62c4ca?s=128&d=identicon&r=PG&f=1", "display_name": "DataScientist", "link": "https://stackoverflow.com/users/9613229/datascientist"}, "edited": false, "score": 0, "creation_date": 1532527333, "post_id": 51516866, "comment_id": 90010494, "body": "Hi @Vityata thanks for your help.  I used your code but i got an error in this line :     Set objFolder = Fso.GetFolder(path)                the message error is : &quot; Run time error &#39;5&#39; : Invalide procedure call or Argument &quot;"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 47, "user_id": 9613229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3117e3559f2fa95dab7bff89b62c4ca?s=128&d=identicon&r=PG&f=1", "display_name": "DataScientist", "link": "https://stackoverflow.com/users/9613229/datascientist"}, "edited": false, "score": 0, "creation_date": 1532527674, "post_id": 51516866, "comment_id": 90010739, "body": "@DataScientist - strange, it worked when I tried it, probably remove the last `\\` in the path string."}, {"owner": {"reputation": 47, "user_id": 9613229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3117e3559f2fa95dab7bff89b62c4ca?s=128&d=identicon&r=PG&f=1", "display_name": "DataScientist", "link": "https://stackoverflow.com/users/9613229/datascientist"}, "edited": false, "score": 0, "creation_date": 1532532258, "post_id": 51516866, "comment_id": 90014069, "body": "Hi @Vityata I removed &quot; \\ &quot;  from path String. there is no more bug but no result neither. so I added &quot;\\&quot; in the beginning of fileStart String and no result also . Sorry to bother u with this but I like your code and I want make it works"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 47, "user_id": 9613229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3117e3559f2fa95dab7bff89b62c4ca?s=128&d=identicon&r=PG&f=1", "display_name": "DataScientist", "link": "https://stackoverflow.com/users/9613229/datascientist"}, "edited": false, "score": 0, "creation_date": 1532532728, "post_id": 51516866, "comment_id": 90014372, "body": "@DataScientist - in your case it should be like this: <code>&quot;C:\\Desktop\\Extraction_Files\\&quot;</code> Then <code>System_Extraction_Supplier_</code>, without the <code>*</code>."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1532532814, "last_edit_date": 1532532814, "creation_date": 1532515170, "answer_id": 51516866, "question_id": 51516381, "link": "https://stackoverflow.com/questions/51516381/how-to-read-a-text-using-condition-if/51516866#51516866", "title": "how to read a text using condition if", "body": "<p>If you want to open all folders, in a specific folder, which start with \"NewFile_\", one loop only is needed:</p>\n\n<pre><code>Sub OpenFolders()\n\n    Dim path As String: path = \"\"C:\\Desktop\\Extraction_Files\\\"\"\n    Dim fileStart As String: fileStart = \"System_Extraction_Supplier_\"\n    Dim Fso As Object\n    Dim objFolder As Object\n\n    Set Fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set objFolder = Fso.GetFolder(path)\n\n    For Each objSubFolder In objFolder.subfolders\n        If InStr(1, objSubFolder.Name, fileStart) Then\n            Shell \"explorer.exe \" &amp; objSubFolder, vbNormalFocus\n            Debug.Print objSubFolder.Name\n        End If\n    Next objSubFolder\n\nEnd Sub\n</code></pre>\n\n<p>Folders in <a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged &#39;vba&#39;\" rel=\"tag\">vba</a> are opened with the <code>Shell \"explorer.exe \"</code> command. The code opens every folder in <code>\"C:\\yourFile\\\"</code>, which contains <code>NewFile_</code> in the name. This check is done with  <code>If InStr(1, objSubFolder.Name, fileStart) Then</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 9613229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3117e3559f2fa95dab7bff89b62c4ca?s=128&d=identicon&r=PG&f=1", "display_name": "DataScientist", "link": "https://stackoverflow.com/users/9613229/datascientist"}, "edited": false, "score": 0, "creation_date": 1532525297, "post_id": 51517029, "comment_id": 90008935, "body": "It doesn&#39;t work. Apparently the machine doesn&#39;t handle a parameter &quot; * &quot; as a remaining part with .open function as it do it to count them. so it generate a path with character * as a character and I got an error message saying that a file doesn&#39;t exist :("}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 47, "user_id": 9613229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3117e3559f2fa95dab7bff89b62c4ca?s=128&d=identicon&r=PG&f=1", "display_name": "DataScientist", "link": "https://stackoverflow.com/users/9613229/datascientist"}, "edited": false, "score": 0, "creation_date": 1532530937, "post_id": 51517029, "comment_id": 90013075, "body": "How odd. It works perfectly on my machine here. * is the correct wildcard to use with <code>Dir</code>. Does the MsgBox pop up with a filename before the error? If not, then the pattern you&#39;re using <code>System_Extraction_Supplier_</code> doesn&#39;t actually match any filenames in that folder."}, {"owner": {"reputation": 47, "user_id": 9613229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3117e3559f2fa95dab7bff89b62c4ca?s=128&d=identicon&r=PG&f=1", "display_name": "DataScientist", "link": "https://stackoverflow.com/users/9613229/datascientist"}, "edited": false, "score": 0, "creation_date": 1532533760, "post_id": 51517029, "comment_id": 90014986, "body": "Hi @CLR it works. I just removed a Var which has been seted as string containing the  File name with &quot; * &quot; at the end. So I&#39;ve done it again like you directly with a path and it works perfectly. thanks again CLR. All the best :)"}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 1, "last_activity_date": 1532515940, "last_edit_date": 1532515940, "creation_date": 1532515638, "answer_id": 51517029, "question_id": 51516381, "link": "https://stackoverflow.com/questions/51516381/how-to-read-a-text-using-condition-if/51517029#51517029", "title": "how to read a text using condition if", "body": "<p>Why not count as you open them. You're already identifying them so why not open each file as you go:</p>\n\n<pre><code>Sub OpenFiles()\n\n    Dim Filename As String\n    Dim CommonPath As String\n    Dim Count As Integer\n\n    CommonPath = \"C:\\Desktop\\Extraction_Files\\\"\n\n    Filename = Dir(CommonPath &amp; \"System_Extraction_Supplier_*\")\n\n    Do While Filename &lt;&gt; \"\"\n\n        MsgBox Filename\n        Workbooks.Open CommonPath &amp; Filename\n        Count = Count + 1\n        Filename = Dir()\n\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>PS. It might be worth adding <code>.xl*</code> or similar to the end of your search pattern to prevent Excel trying to open files that aren't Excel files:</p>\n\n<pre><code>Filename = Dir(CommonPath &amp; \"System_Extraction_Supplier_*.xl*\")\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 9613229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3117e3559f2fa95dab7bff89b62c4ca?s=128&d=identicon&r=PG&f=1", "display_name": "DataScientist", "link": "https://stackoverflow.com/users/9613229/datascientist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 51517029, "answer_count": 2, "score": 0, "last_activity_date": 1532532814, "creation_date": 1532513745, "last_edit_date": 1532516993, "question_id": 51516381, "link": "https://stackoverflow.com/questions/51516381/how-to-read-a-text-using-condition-if", "title": "how to read a text using condition if", "body": "<p>I have an issue and I need your help. here is the problem. I have inside a folder some excel files that I have to open automatically in order to make some operations. Those files have the same name except the number of the files like this:</p>\n\n<p>Folder name : Extraction_Files\nFiles name :     - \"System_Extraction_Supplier_1\"\n                 - \"System_Extraction_Supplier_2\"\n                 - \"System_Extraction_Supplier_3\"</p>\n\n<p>The number of files can change so i used a loop Do While to count the number of files, then the plan is to use a loop for I =1 to ( number of files) to open all of theme. </p>\n\n<p>please read my code. I know that i used a wrong way to read file name using a loop for but I share it because I don't have an other idea. </p>\n\n<p>Here is my code :</p>\n\n<pre><code>Sub OpenFiles ()\n\n    Dim MainPath as String \n    Dim CommonPath as String \n    Dim Count As Integer\n    Dim i As Integer\n\n   ' the main path is \" C:\\Desktop\\Extraction_Files\\System_Extraction_Supplier_i\"\n   'with i = 1 to Count ( file number )\n\n\n    CommonPath = \"C:\\Desktop\\Extraction_Files\\System_Extraction_Supplier_*\"\n\n   'counting automatically the file number\n\n    Filename = Dir ( CommonPath )\n\n    Do While Filename &lt;&gt; \"\" \n\n       Count = Count + 1 \n       Filename = Dir ()\n\n    Loop\n\n'the issue is below because this code generate a MsgBox showing a MainPath with the index i like this\n'\"C:\\Desktop\\Extraction_Files\\System_Extraction_Supplier_i\" \n' so vba can not find the files\n\n    For i = 1 To count \n\n      MainPath = \"C:\\Desktop\\Extraction_Files\\System_Extraction_Supplier_\" &amp; \"i\" \n      MsgBox  MainPath  &amp; \n      Workbooks.Open MainPath \n\n    Next \n\nEnd Sub \n</code></pre>\n\n<p>what is the best approach to this?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 1886, "user_id": 1698143, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5bd39afbb0ffd37a0ad4aaa51002370e?s=128&d=identicon&r=PG", "display_name": "Failed Scientist", "link": "https://stackoverflow.com/users/1698143/failed-scientist"}, "edited": false, "score": 0, "creation_date": 1532513921, "post_id": 51516362, "comment_id": 90001249, "body": "Type mismatch of which variables?"}, {"owner": {"reputation": 11, "user_id": 9161555, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CXTGBbEyoIU/AAAAAAAAAAI/AAAAAAAABE0/Oj7pmaX9L5c/photo.jpg?sz=128", "display_name": "srivardhan kandike", "link": "https://stackoverflow.com/users/9161555/srivardhan-kandike"}, "reply_to_user": {"reputation": 1886, "user_id": 1698143, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5bd39afbb0ffd37a0ad4aaa51002370e?s=128&d=identicon&r=PG", "display_name": "Failed Scientist", "link": "https://stackoverflow.com/users/1698143/failed-scientist"}, "edited": false, "score": 0, "creation_date": 1532514192, "post_id": 51516362, "comment_id": 90001422, "body": "At If condition"}], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 11, "user_id": 9161555, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CXTGBbEyoIU/AAAAAAAAAAI/AAAAAAAABE0/Oj7pmaX9L5c/photo.jpg?sz=128", "display_name": "srivardhan kandike", "link": "https://stackoverflow.com/users/9161555/srivardhan-kandike"}, "edited": false, "score": 1, "creation_date": 1532523176, "post_id": 51517156, "comment_id": 90007461, "body": "Might be worth adding something like <code>IF Target.Address = &quot;$A$1&quot;</code> otherwise it doesn&#39;t matter what cell <i>CustomChoice</i> is entered in.  @srivardhankandike Could you also tick this as the accepted answer if it works - saves people from looking to answer it a second time."}, {"owner": {"reputation": 11, "user_id": 9161555, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CXTGBbEyoIU/AAAAAAAAAAI/AAAAAAAABE0/Oj7pmaX9L5c/photo.jpg?sz=128", "display_name": "srivardhan kandike", "link": "https://stackoverflow.com/users/9161555/srivardhan-kandike"}, "edited": false, "score": 0, "creation_date": 1532527562, "post_id": 51517156, "comment_id": 90010658, "body": "yea but in a drop down when CustomChoice is selected then that operation should be perform@Darren Bartup-Cook"}, {"owner": {"reputation": 11, "user_id": 9161555, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CXTGBbEyoIU/AAAAAAAAAAI/AAAAAAAABE0/Oj7pmaX9L5c/photo.jpg?sz=128", "display_name": "srivardhan kandike", "link": "https://stackoverflow.com/users/9161555/srivardhan-kandike"}, "edited": false, "score": 0, "creation_date": 1532527670, "post_id": 51517156, "comment_id": 90010737, "body": "But now im getting new error like thats working very well but when im entering the data on the cell its doesnt showing me anything"}], "tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": false, "score": 0, "last_activity_date": 1532516006, "creation_date": 1532516006, "answer_id": 51517156, "question_id": 51516362, "link": "https://stackoverflow.com/questions/51516362/work-sheet-event-throws-an-exception-called-type-mismatch-error/51517156#51517156", "title": "Work Sheet Event throws an exception called type mismatch error", "body": "<p>This happens because this event fires again in the line <code>Range(\"P12:R13\").Clear</code>. But when this line activates, <code>Target.Address=P12:R13</code>. And the <code>.value</code> property can't be used like you are doing if the range is more than 1 cell.</p>\n\n<p>So you need to modify your code to avoind triggering again this event when Worksheet changes during execution. Try this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nApplication.EnableEvents = False 'deactivate events\n\nIf Target.Value = \"CustomChoice\" Then\n    Range(\"P12\").Value = \"Enter Dates\"\n    Range(\"P13\").Interior.Color = vbGreen\n    Range(\"R13\").Interior.Color = vbGreen\nElse\n    Range(\"P12:R13\").Clear\n    Range(\"Q10\").Select\nEnd If\n\nApplication.EnableEvents = True 'activate events\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9161555, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CXTGBbEyoIU/AAAAAAAAAAI/AAAAAAAABE0/Oj7pmaX9L5c/photo.jpg?sz=128", "display_name": "srivardhan kandike", "link": "https://stackoverflow.com/users/9161555/srivardhan-kandike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544796980, "creation_date": 1532513661, "last_edit_date": 1544796980, "question_id": 51516362, "link": "https://stackoverflow.com/questions/51516362/work-sheet-event-throws-an-exception-called-type-mismatch-error", "title": "Work Sheet Event throws an exception called type mismatch error", "body": "<p>Whenever I run this, it is showing me Type mismatch Error (in <code>If Target.Value = \"CustomChoice\"</code>)</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Value = \"CustomChoice\" Then\nRange(\"P12\").Value = \"Enter Dates\"\nRange(\"P13\").Interior.Color = vbGreen\nRange(\"R13\").Interior.Color = vbGreen\nElse\nRange(\"P12:R13\").Clear\nRange(\"Q10\").Select\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "edited": false, "score": 0, "creation_date": 1532527282, "post_id": 51520665, "comment_id": 90010450, "body": "Thank you, this does work, although only with ActiveX which i abandoned and led to my adaptation below! I appreciate your time on this. It really helped my understand whats going on :)"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 1, "last_activity_date": 1532526770, "creation_date": 1532526770, "answer_id": 51520665, "question_id": 51516059, "link": "https://stackoverflow.com/questions/51516059/excel-vba-linking-tickboxes-to-correct-cells-after-copying/51520665#51520665", "title": "Excel VBA Linking tickboxes to correct cells after copying", "body": "<p>You can loop through the checkboxes and set the linked cells, it looks like in the picture you are using activex checkboxes, as the command button as well is an activex control.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim objCkBox As Object\n    With Sheets(\"Sheet1\")\n        For Each objCkBox In .OLEObjects\n            If TypeName(objCkBox.Object) = \"CheckBox\" Then\n                With objCkBox.TopLeftCell\n                    r = .Row\n                    c = .Column\n                End With\n                objCkBox.LinkedCell = Cells(r, c - 4).Address\n            End If\n        Next objCkBox\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "edited": false, "score": 0, "creation_date": 1532527305, "post_id": 51520671, "comment_id": 90010468, "body": "Thank you for all your time on this. Its really apprecaited. I have altered the code slightly and posted my code below to get an understanding of what i have now done"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 1, "last_activity_date": 1532527188, "last_edit_date": 1532527188, "creation_date": 1532526787, "answer_id": 51520671, "question_id": 51516059, "link": "https://stackoverflow.com/questions/51516059/excel-vba-linking-tickboxes-to-correct-cells-after-copying/51520671#51520671", "title": "Excel VBA Linking tickboxes to correct cells after copying", "body": "<p>Here is a small piece of code that will loop through your checkboxes and links the cells 4 to its left:</p>\n\n<pre><code>Sub LINK()\nDim s As Shape\n\nFor Each s In Worksheets(\"Blad1\").Shapes\n    If s.Type = 8 then\n        s.ControlFormat.LinkedCell = s.TopLeftCell.Offset(0, -4).Address\n    End if\nNext s\n\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>This is basically the same answer as @Davesexcel his answer. Instead of ActiveX I assumed you used form elements.... Also a check if shape type is checkbox (type = 8).</p>\n"}, {"tags": [], "owner": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "is_accepted": false, "score": 0, "last_activity_date": 1532527167, "creation_date": 1532527167, "answer_id": 51520826, "question_id": 51516059, "link": "https://stackoverflow.com/questions/51516059/excel-vba-linking-tickboxes-to-correct-cells-after-copying/51520826#51520826", "title": "Excel VBA Linking tickboxes to correct cells after copying", "body": "<p>Managed to solved this now using an Offset address function\nThe following code deletes the tickboxes within a range and re-populates the tickboxes and links with an offset cell. Will be used to increment with every click of a different button</p>\n\n<p>Code with annotations below:</p>\n\n<pre><code>Private Sub DeleteTickBoxes_Click()\n'Variables\nDim c As CheckBox\nDim CellRange As range\nDim cel As range\nSet CellRange = ActiveSheet.range(\"E7:F30\")\n\n'Delete Checkboxes within the specified range above on the ActiveSheet Only\nFor Each c In ActiveSheet.CheckBoxes\n    If Not Intersect(c.TopLeftCell, CellRange) Is Nothing Then\n    c.Delete\nEnd If\n\nNext\n\n'Insert New Checkboxes and Assign to a specified link cell using the offset\nFor Each cel In CellRange\n    Set c = ActiveSheet.CheckBoxes.Add(cel.Left, cel.Top, 30, 6) 'you can adjust left, top, height, width to your needs\n    With c\n        'Clears the textbox so it has no text\n        .Caption = \"\"\n\n        'Offset works by offsetting (Row offset, Column Offset) and accepts positive for down/right and negative for left/up,\n        'keep in not that the linked cells will automatically populate with true/false\n        .LinkedCell = cel.Offset(0, -4).Address\n\n    End With\n\nNext\nCall CentreCheckbox_Click()\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 51520671, "answer_count": 3, "score": 0, "last_activity_date": 1532527188, "creation_date": 1532512751, "question_id": 51516059, "link": "https://stackoverflow.com/questions/51516059/excel-vba-linking-tickboxes-to-correct-cells-after-copying", "title": "Excel VBA Linking tickboxes to correct cells after copying", "body": "<p>I have two columns of Tickboxes. Columns E7:E30 and F7:F30\nI also have an insert a new line which copies the cells above and shifts everything down by one row between a range of cells</p>\n\n<p>Code for that here:</p>\n\n<pre><code>Private Sub InsertNewBill_Click()\nRange(\"A30:AC30\").Select\nRange(\"AC30\").Activate\nSelection.Copy\nSelection.Insert Shift:=xlDown\nEnd Sub\n</code></pre>\n\n<p>The issue i have is that the tickboxes in Column E is linked to its respective neighbour in cell A and F is linked to B. Please see the attached image for an idea of the layout.</p>\n\n<p><a href=\"https://i.stack.imgur.com/g8iwY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/g8iwY.png\" alt=\"Layout for the affected cells\"></a></p>\n\n<p>When using the above code. It copies everything as expected. However it binds the tick boxes together. I need to get the newly inserted tickboxes to bind to their relative A and B cells and have no idea how to do this. Would anyone have any ideas?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1532512080, "post_id": 51515515, "comment_id": 90000006, "body": "Ignoring NotePad completely for a moment.. are you trying to create a text file, or are you trying to read one?"}, {"owner": {"reputation": 3, "user_id": 10132489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8550b34fb42d1b151e7c8aa9b272949?s=128&d=identicon&r=PG&f=1", "display_name": "David J", "link": "https://stackoverflow.com/users/10132489/david-j"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1532512979, "post_id": 51515515, "comment_id": 90000656, "body": "I am trying to create txt file from shell information"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1532513959, "post_id": 51515515, "comment_id": 90001271, "body": "Can you expand on what you mean by <i>shell information</i>? Do you mean the output of a shell command, such as DIR - perhaps piped into a text file?"}, {"owner": {"reputation": 3, "user_id": 10132489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8550b34fb42d1b151e7c8aa9b272949?s=128&d=identicon&r=PG&f=1", "display_name": "David J", "link": "https://stackoverflow.com/users/10132489/david-j"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1532514534, "post_id": 51515515, "comment_id": 90001662, "body": "Sorry, yes, what I meant to say is that I want to copy the output of shell command and paste it to new text file or something like that"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1532515048, "post_id": 51515515, "comment_id": 90001990, "body": "Okay, so what shell command are you running to create the file?"}], "answers": [{"comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1532515125, "post_id": 51516720, "comment_id": 90002039, "body": "If you&#39;re invoking Notepad using Shell, you don&#39;t actually need the path at all. Shell knows where to find Notepad."}, {"owner": {"reputation": 3, "user_id": 10132489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8550b34fb42d1b151e7c8aa9b272949?s=128&d=identicon&r=PG&f=1", "display_name": "David J", "link": "https://stackoverflow.com/users/10132489/david-j"}, "edited": false, "score": 0, "creation_date": 1532517934, "post_id": 51516720, "comment_id": 90003818, "body": "On Open StrNewLocation For Output As #1 i have Path/File access error (run time error 75)"}, {"owner": {"reputation": 1534, "user_id": 5373986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5937e22068b8355cf94c4c18f747660f?s=128&d=identicon&r=PG&f=1", "display_name": "Taazar", "link": "https://stackoverflow.com/users/5373986/taazar"}, "edited": false, "score": 0, "creation_date": 1532522615, "post_id": 51516720, "comment_id": 90007053, "body": "No problem, let me know if you have any other issues."}], "tags": [], "owner": {"reputation": 1534, "user_id": 5373986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5937e22068b8355cf94c4c18f747660f?s=128&d=identicon&r=PG&f=1", "display_name": "Taazar", "link": "https://stackoverflow.com/users/5373986/taazar"}, "is_accepted": true, "score": 0, "last_activity_date": 1532514789, "creation_date": 1532514789, "answer_id": 51516720, "question_id": 51515515, "link": "https://stackoverflow.com/questions/51515515/how-to-read-all-information-from-shell-command-in-vba-and-save-it-in-txt-file/51516720#51516720", "title": "How to read all information from shell command in VBA and save it in .txt file", "body": "<p>I'm presuming you copied the nppPath over wrong as it should be</p>\n\n<pre><code>nppPath = \"C:\\Windows\\System32\\notepad.exe\"\n</code></pre>\n\n<p>but for reading from the text file you could use free file:</p>\n\n<pre><code>Dim IntFile As Integer, StrFileName As String, StrFileContent As String\n\nStrFileName = fileToOpen 'Your file location here\nIntFile = FreeFile\nOpen StrFileName For Input As #IntFile\n    StrFileContent = Input(LOF(IntFile), IntFile) 'This now contains the text\nClose #IntFile\n</code></pre>\n\n<p>This will read the text file into a single variable that you can then use however you wish.\nIf you want to write to a text file you can use the following code:</p>\n\n<pre><code>Dim StrNewLocation As String, StrFileContent As String\n\nStrNewLocation = \"\" 'Put the new files name and location here\nStrFileContent = \"Example\" 'The text to go into the new file\n\nOpen StrNewLocation For Output As #1\n    Write #1, StrFileContent\nClose #1\n</code></pre>\n\n<p>Hopefully this helps you solve your problem if not send me a message and I'll see what I can do.</p>\n"}], "owner": {"reputation": 3, "user_id": 10132489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8550b34fb42d1b151e7c8aa9b272949?s=128&d=identicon&r=PG&f=1", "display_name": "David J", "link": "https://stackoverflow.com/users/10132489/david-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 325, "favorite_count": 0, "accepted_answer_id": 51516720, "answer_count": 1, "score": 0, "last_activity_date": 1532514789, "creation_date": 1532511087, "last_edit_date": 1532513182, "question_id": 51515515, "link": "https://stackoverflow.com/questions/51515515/how-to-read-all-information-from-shell-command-in-vba-and-save-it-in-txt-file", "title": "How to read all information from shell command in VBA and save it in .txt file", "body": "<p>I try to use this code:</p>\n\n<pre><code>Shell(nppPath &amp; \" \" &amp; fileToOpen, vbNormalFocus)\n</code></pre>\n\n<p>which opens txt file <code>nppPath = \"C:\\Windows\\notepad.exe\"</code> but I cannot read from it and save it as .txt file using VBA.</p>\n\n<p>Looking forward to any suggestions.</p>\n"}, {"tags": ["excel", "vba", "logging", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 9703883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d9137cb8a913ec805e2e2d745137bb?s=128&d=identicon&r=PG&f=1", "display_name": "Maitreya", "link": "https://stackoverflow.com/users/9703883/maitreya"}, "edited": false, "score": 0, "creation_date": 1532527266, "post_id": 51517574, "comment_id": 90010441, "body": "Hi, What is the meaning of putting -4162? What is the value stand for?"}, {"owner": {"reputation": 49, "user_id": 9703883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d9137cb8a913ec805e2e2d745137bb?s=128&d=identicon&r=PG&f=1", "display_name": "Maitreya", "link": "https://stackoverflow.com/users/9703883/maitreya"}, "edited": false, "score": 0, "creation_date": 1532528080, "post_id": 51517574, "comment_id": 90011032, "body": "Hi, Now the macro is not giving any error, but seems that it is not inserting any record in the log file."}, {"owner": {"reputation": 49, "user_id": 9703883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d9137cb8a913ec805e2e2d745137bb?s=128&d=identicon&r=PG&f=1", "display_name": "Maitreya", "link": "https://stackoverflow.com/users/9703883/maitreya"}, "edited": false, "score": 0, "creation_date": 1532528515, "post_id": 51517574, "comment_id": 90011344, "body": "I have checked... that the macro is even not running at all. After sending any mail Outlook is not at all reading the codes."}, {"owner": {"reputation": 49, "user_id": 9703883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d9137cb8a913ec805e2e2d745137bb?s=128&d=identicon&r=PG&f=1", "display_name": "Maitreya", "link": "https://stackoverflow.com/users/9703883/maitreya"}, "edited": false, "score": 0, "creation_date": 1532528879, "post_id": 51517574, "comment_id": 90011612, "body": "I get it. Thanks for help. it was for macro security settings."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1532523354, "last_edit_date": 1532523354, "creation_date": 1532517466, "answer_id": 51517574, "question_id": 51515450, "link": "https://stackoverflow.com/questions/51515450/write-log-in-excel-after-mail-send-or-receive-in-outlook-using-macro/51517574#51517574", "title": "Write log in Excel after mail send or receive in outlook using Macro", "body": "<p>To access an Excel file from Outlook-VBA you first need create an Excel application:</p>\n\n<pre><code>Dim xlApp As Object\nSet xlApp = CreateObject(\"Excel.Application\")\n</code></pre>\n\n<p>if you don't want the Excel to show use </p>\n\n<pre><code>xlApp.Visible = False\n</code></pre>\n\n<p>to hide it. And then you can open an Excel file in that application:</p>\n\n<pre><code>Dim xlWb As Object\nSet xlWb = xlApp.Workbooks.Open(FileName:=\"\\\\Bmcstr01\\grp\\SRV\\Allsrv\\NEW Complaints Logger\\GI Complaints\\Spreadsheets\\Archieve\\Access_Log.xlsx\")\n</code></pre>\n\n<p>and then you can access a worksheet in that file:</p>\n\n<pre><code>Dim xlWs As Object\nSet xlWs = xlWb.Worksheets(\"Sheet1\") 'put your sheet name here\n</code></pre>\n\n<p>and then comes your code accessing this worksheet like</p>\n\n<pre><code>Const xlUp = -4162 'see explanation below\n\nDim n As Long\nWith xlWs\n    If .Range(\"A1\").Value = \"\" Then\n        n = 1\n    Else\n        n = .Cells(.Rows.Count, \"A\").End(xlUp).Row + 1\n    End If\n    .Cells(n, \"A\").Value = Environ(\"username\")\n    .Cells(n, \"B\").Value = Date\n    .Cells(n, \"C\").Value = Time\n    .Cells(n, \"D\").Value = \"Outlook\"\n    .Cells(n, \"E\").Value = \"sent mail\"\nEnd With\n\nxlWb.Close SaveChanges:=True 'close and save workbook\n</code></pre>\n\n<p>Edit//</p>\n\n<p>Note that <code>xlUp</code> does not exist in Outlook. Therefore you need to use <code>-4162</code> or define a constant for it <code>Const xlUp = -4162</code> before you can use it.</p>\n"}], "owner": {"reputation": 49, "user_id": 9703883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d9137cb8a913ec805e2e2d745137bb?s=128&d=identicon&r=PG&f=1", "display_name": "Maitreya", "link": "https://stackoverflow.com/users/9703883/maitreya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 757, "favorite_count": 0, "accepted_answer_id": 51517574, "answer_count": 1, "score": 0, "last_activity_date": 1592948167, "creation_date": 1532510885, "last_edit_date": 1592948167, "question_id": 51515450, "link": "https://stackoverflow.com/questions/51515450/write-log-in-excel-after-mail-send-or-receive-in-outlook-using-macro", "title": "Write log in Excel after mail send or receive in outlook using Macro", "body": "<p>I need your help to create a macro in Outlook 2010 which will store the From,To,Date,Subject,Flag in an excel after sending any mail form an account or receiving any mail in the inbox of that account.</p>\n\n<p>In that process i tried to create the log first in excel after sending mail with some default value by using below code. But it is giving error \"Compile Error, Sub or Function not defined\" at line: </p>\n\n<pre><code>Windows(\"Access_Log.xlsx\").Activate\n</code></pre>\n\n<p>The code goes as below:</p>\n\n<pre><code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\nWorkbooks.Open FileName:=\"\\\\Bmcstr01\\grp\\SRV\\Allsrv\\NEW Complaints Logger\\GI Complaints\\Spreadsheets\\Archieve\\Access_Log.xlsx\"\nWindows(\"Access_Log.xlsx\").Activate\n\n\n'Sheets(\"log\").Activate\nIf Range(\"A1\").Value = \"\" Then\nn = 1\nElse\nn = Cells(Rows.Count, \"A\").End(xlUp).Row + 1\nEnd If\nCells(n, \"A\").Value = Environ(\"username\")\nCells(n, \"b\").Value = Date\nCells(n, \"c\").Value = Time\nCells(n, \"d\").Value = \"Outlook\"\nCells(n, \"E\").Value = \"sent mail\"\nActiveWorkbook.Save\nActiveWorkbook.Close\nEnd Sub\n</code></pre>\n\n<p>It is written in ThisOutlookSession --> Application --> SendItem.</p>\n\n<p>Any help to this code and the original requirement will be appreciated. </p>\n\n<p>Thanks,\nMaitreya</p>\n"}, {"tags": ["arrays", "excel", "vba", "duplicates"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1532518662, "post_id": 51515158, "comment_id": 90004260, "body": "I honestly do not understand what you are trying to split with a semi-colon or forward slash nor what <code>fill = &quot;-&quot;</code> has to do with <i>&#39;join everything back together with a &quot;,&quot;&#39;</i>."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1532521719, "post_id": 51515158, "comment_id": 90006453, "body": "For the output you currently have, did you intend to have a row 12 &amp; row 13, or was that supposed to be two rows of 12?"}, {"owner": {"reputation": 35, "user_id": 9189148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb1900fcf40ec79147b7f5515bd0430?s=128&d=identicon&r=PG&f=1", "display_name": "W. Duri", "link": "https://stackoverflow.com/users/9189148/w-duri"}, "edited": false, "score": 0, "creation_date": 1532524169, "post_id": 51515158, "comment_id": 90008147, "body": "@ Mistella, My mistake (corrected it). Row 12 has only 1 element as does Row 13."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1532537986, "post_id": 51515158, "comment_id": 90017110, "body": "@W.Duri, just wanted to give you a heads-up that if there is a space between the &quot;@&quot; and the username, the individual won&#39;t get pinged."}, {"owner": {"reputation": 35, "user_id": 9189148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb1900fcf40ec79147b7f5515bd0430?s=128&d=identicon&r=PG&f=1", "display_name": "W. Duri", "link": "https://stackoverflow.com/users/9189148/w-duri"}, "edited": false, "score": 0, "creation_date": 1532539233, "post_id": 51515158, "comment_id": 90017739, "body": "@Jeeped In column &quot;N&quot; There are paths. A semicolon is being used to seperate multiple paths. And the second element of that path is being used. This is what I illustrated with the output."}, {"owner": {"reputation": 35, "user_id": 9189148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb1900fcf40ec79147b7f5515bd0430?s=128&d=identicon&r=PG&f=1", "display_name": "W. Duri", "link": "https://stackoverflow.com/users/9189148/w-duri"}, "edited": false, "score": 0, "creation_date": 1532596278, "post_id": 51515158, "comment_id": 90037895, "body": "@Jeeped I&#39;ve used fill = &quot;-&quot; as output for an empty row. I&#39;ve deleted the empty rows 1,3,6-8 to make it more readable here. I guess I&#39;ve should&#39;ve left it in."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 9189148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb1900fcf40ec79147b7f5515bd0430?s=128&d=identicon&r=PG&f=1", "display_name": "W. Duri", "link": "https://stackoverflow.com/users/9189148/w-duri"}, "edited": false, "score": 0, "creation_date": 1532547437, "post_id": 51517830, "comment_id": 90021512, "body": "Thank you. I forgot to mention this: Example of the Input from Column &quot;N&quot;, Row 2 (= Duplicate): Toyota Verso/Toyota Verso &#39;09-... (R2)/Carrosserie/Grille;Toyota Verso/Toyota Verso &#39;09-... (R2)/Overige So without the duplicate it would result in: Toyota Verso &#39;09-... (R2)"}, {"owner": {"reputation": 35, "user_id": 9189148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb1900fcf40ec79147b7f5515bd0430?s=128&d=identicon&r=PG&f=1", "display_name": "W. Duri", "link": "https://stackoverflow.com/users/9189148/w-duri"}, "edited": false, "score": 0, "creation_date": 1532547452, "post_id": 51517830, "comment_id": 90021523, "body": "Also, some Input Rows can have more than 2 elements separated by a &quot;;&quot;."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1532518246, "creation_date": 1532518246, "answer_id": 51517830, "question_id": 51515158, "link": "https://stackoverflow.com/questions/51515158/split-and-remove-duplicates-then-join-back/51517830#51517830", "title": "Split and remove duplicates, then join back", "body": "<p>Try adding a dictionary to help maintain the uniqueness.</p>\n\n<pre><code>Option Explicit\n\nSub Sample()\n    Dim i As Long, arr As Variant, tmp As Variant, str As String\n    Dim dict As Object\n\n    Set dict = CreateObject(\"scripting.dictionary\")\n\n    With Worksheets(\"sheet1\")\n        arr = .Range(.Cells(2, \"N\"), .Cells(.Rows.Count, \"N\").End(xlUp)).Value2\n\n        For i = LBound(arr, 1) To UBound(arr, 1)\n            tmp = Split(arr(i, 1), \":\", 3)\n            str = Join(Array(tmp(0), tmp(1), Space(1)), \":\")\n            If dict.exists(str) Then\n                dict.Item(str) = dict.Item(str) &amp; \", \" &amp; Trim(tmp(2))\n            Else\n                dict.Item(str) = Trim(tmp(2))\n            End If\n        Next i\n\n        ReDim arr(1 To dict.Count, 1 To 1)\n        i = LBound(arr, 1)\n\n        For Each tmp In dict.keys\n            arr(i, 1) = tmp &amp; dict.Item(tmp)\n            i = i + 1\n        Next tmp\n\n        .Cells(2, \"O\").Resize(UBound(arr, 1), UBound(arr, 2)) = arr\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/wfxEU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wfxEU.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 35, "user_id": 9189148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb1900fcf40ec79147b7f5515bd0430?s=128&d=identicon&r=PG&f=1", "display_name": "W. Duri", "link": "https://stackoverflow.com/users/9189148/w-duri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594206546, "creation_date": 1532510014, "last_edit_date": 1594206546, "question_id": 51515158, "link": "https://stackoverflow.com/questions/51515158/split-and-remove-duplicates-then-join-back", "title": "Split and remove duplicates, then join back", "body": "<p>I've got this far with splitting the values I've got from Column \"N\".\nThe only thing is, that I somehow can't get to remove duplicates and then join everything back together with a \",\". As a newbie I'm struggling with arrays and mostly get \u201crun-time error 13 \u2013 Type mismatch\u201d.</p>\n\n<p>My output looks like this:</p>\n\n<blockquote>\n<pre><code>'strModel:          Row 2: Toyota Verso '09-... (R2)\n'strModel:          Row 2: Toyota Verso '09-... (R2)\n'Model3:            ROW 3: -\n'strModel:          Row 4: Toyota Avensis '97-'02 (T22)\n'strModel:          Row 4: Toyota Auris '07-'13 (E15)\n'Model3:            ROW 5: -\n'Model3:            ROW 6: -\n'Model3:            ROW 7: -\n'Model3:            ROW 8: -\n'strModel:          Row 9: Toyota RAV4 '05-'12 (A3)\n'Model3:            ROW 10: -\n'Model3:            ROW 11: -\n'strModel:          Row 12: Toyota Auris '07-'13 (E15)\n'strModel:          Row 13: Toyota Avensis '97-'02 (T22)\n</code></pre>\n</blockquote>\n\n<p>EXAMPLE: The input from Column \"N\", Row 2 (= Duplicate):</p>\n\n<blockquote>\n  <p>Toyota Verso/Toyota Verso '09-... (R2)/Carrosserie/Grille;Toyota Verso/Toyota Verso '09-... (R2)/Overige</p>\n</blockquote>\n\n<p>This is the output I want to achieve:</p>\n\n<blockquote>\n<pre><code>'strModel:          Row 2: Toyota Verso '09-... (R2)\n'Model3:            ROW 3: -\n'strModel:          Row 4: Toyota Avensis '97-'02 (T22), Toyota Auris '07-'13 (E15)\n'Model3:            ROW 5: -\n'Model3:            ROW 6: -\n'Model3:            ROW 7: -\n'Model3:            ROW 8: -\n'strModel:          Row 9: Toyota RAV4 '05-'12 (A3)\n'Model3:            ROW 10: -\n'Model3:            ROW 11: -\n'strModel:          Row 12: Toyota Auris '07-'13 (E15)\n'strModel:          Row 13: Toyota Avensis '97-'02 (T22)\n</code></pre>\n</blockquote>\n\n<p>This is the working code I have for now:</p>\n\n<pre><code>    Option Explicit\n\n    Sub Sample()\n\n    Dim oWS As Worksheet\n    Dim fill As String\n    Dim x As Long\n    Dim i As Long\n    Dim strMODEL As String\n    Dim strMODELS() As String\n    Dim Model2 As Variant\n    Dim Model3 As Variant\n    Dim myElements() As String\n    Dim myString As String\n    Dim LastRow As Long\n\n    Set oWS = Sheets(\"Sheet1\")\n    LastRow = oWS.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    fill = \"-\"\n\n    For i = 2 To LastRow\n\n        myString = oWS.Cells(i, \"N\")                                                 ' MODEL\n        strMODELS = Split(myString, \";\")                                         ' ----- SPLIT 1 -----\n\n        If Len(myString) &gt; 1 Then\n\n            For Each Model2 In strMODELS\n                        strMODEL = Split(Model2, \"/\")(1)                        ' ----- SPLIT 2 -----  2nd Element Of Array\n                                    Debug.Print (\"strModel:          ROW \") &amp; i &amp; \": \" &amp; strMODEL\n\n          '*****************************************************\n          ' 1) Remove duplicates from strMODEL\n          ' 2) Join everything back separated by \",\"\n          '*****************************************************\n\n                        Next Model2\n             Else\n                        Model3 = fill\n                                    Debug.Print (\"Model3:             ROW \") &amp; i &amp; \": \" &amp; fill\n             End If\n    Next i\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1532509503, "post_id": 51514830, "comment_id": 89998235, "body": "Can you not just check the destination range after your query and wait until that is populated? Also, you don&#39;t need to activate the sheet or <code>.Select</code> a range. It actually serves no purpose. You&#39;ve already done early binding, just use <code>tgt</code>"}, {"owner": {"reputation": 59, "user_id": 9926138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d4edd5470187378199e8d4995004254?s=128&d=identicon&r=PG", "display_name": "mandmi", "link": "https://stackoverflow.com/users/9926138/mandmi"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1532509937, "post_id": 51514830, "comment_id": 89998516, "body": "How would I go about this? Also I tried tgt.TextToColumns and it doesn&#39;t work."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1532510232, "post_id": 51514830, "comment_id": 89998712, "body": "Presuming that your range has no value to start with (i.e. A1 has no value), you could try something like <code>Len(Trim(tgt.Range(&quot;A1&quot;).Value)) = 0 Then</code>.. now you can use the explicit wait (i.e. <code>Application.Wait Now + TimeSerial(0,0,5)</code>.. copied form @QHarr). Saying that, QHarr is probably on the right track"}, {"owner": {"reputation": 59, "user_id": 9926138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d4edd5470187378199e8d4995004254?s=128&d=identicon&r=PG", "display_name": "mandmi", "link": "https://stackoverflow.com/users/9926138/mandmi"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1532512301, "post_id": 51514830, "comment_id": 90000144, "body": "Its company internal website not accessible to public..."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 9926138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d4edd5470187378199e8d4995004254?s=128&d=identicon&r=PG", "display_name": "mandmi", "link": "https://stackoverflow.com/users/9926138/mandmi"}, "edited": false, "score": 0, "creation_date": 1532509872, "post_id": 51514972, "comment_id": 89998471, "body": "I already tried Doevents and it doesn&#39;t work. Also the explicit also doesn&#39;t work."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 59, "user_id": 9926138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d4edd5470187378199e8d4995004254?s=128&d=identicon&r=PG", "display_name": "mandmi", "link": "https://stackoverflow.com/users/9926138/mandmi"}, "edited": false, "score": 0, "creation_date": 1532509994, "post_id": 51514972, "comment_id": 89998551, "body": "What does doesn&#39;t work mean? If you put a long enough explicit wait after the query, then provided the query runs the data will be there."}, {"owner": {"reputation": 59, "user_id": 9926138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d4edd5470187378199e8d4995004254?s=128&d=identicon&r=PG", "display_name": "mandmi", "link": "https://stackoverflow.com/users/9926138/mandmi"}, "edited": false, "score": 0, "creation_date": 1532510175, "post_id": 51514972, "comment_id": 89998686, "body": "The query takes less than 5 seconds normally. I just tried Application.Wait Now + TimeSerial(0, 0, 30) and it somehow delays the query. There is External data: getting data... for 30 sec then still no text to columns."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 59, "user_id": 9926138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d4edd5470187378199e8d4995004254?s=128&d=identicon&r=PG", "display_name": "mandmi", "link": "https://stackoverflow.com/users/9926138/mandmi"}, "edited": false, "score": 0, "creation_date": 1532510269, "post_id": 51514972, "comment_id": 89998737, "body": "Is there a cell that is not populated at the start that is expected to be populated after the query is run? A cell in the same column near the top? e.g. A2?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1532510289, "post_id": 51514972, "comment_id": 89998758, "body": "@QHarr, does the <code>DoEvents</code> need to be after the query?"}, {"owner": {"reputation": 59, "user_id": 9926138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d4edd5470187378199e8d4995004254?s=128&d=identicon&r=PG", "display_name": "mandmi", "link": "https://stackoverflow.com/users/9926138/mandmi"}, "edited": false, "score": 0, "creation_date": 1532510334, "post_id": 51514972, "comment_id": 89998785, "body": "Yes. I use tgt.Cells.ClearContents at the start so A2 should be empty."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1532510469, "post_id": 51514972, "comment_id": 89998890, "body": "@Zac I am never clear on that tbh. I assumed you say it once and it carries on applying. I assumed that as Excel is single threaded it cannot send a worker off to do something else but I don&#39;t know the internals. I guess it could decide to handle in a different ordering?  Mandmi you can try moving it."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1532511381, "post_id": 51514972, "comment_id": 89999531, "body": "@pnuts Thanks for that. Any suggestions for modifying the above then? I assumed you want the query to complete then move on which is why I put the DoEvents before that."}, {"owner": {"reputation": 59, "user_id": 9926138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d4edd5470187378199e8d4995004254?s=128&d=identicon&r=PG", "display_name": "mandmi", "link": "https://stackoverflow.com/users/9926138/mandmi"}, "edited": false, "score": 0, "creation_date": 1532511685, "post_id": 51514972, "comment_id": 89999749, "body": "I tried it and in A1 there is &quot;ExternalData_59: Getting Data ...&quot; and on status bar is says running background query... It is stuck like this until I manually fill A2 and the it fills with the csv data :D"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1532510545, "last_edit_date": 1532510545, "creation_date": 1532509476, "answer_id": 51514972, "question_id": 51514830, "link": "https://stackoverflow.com/questions/51514830/wait-until-query-is-complete/51514972#51514972", "title": "Wait until query is complete?", "body": "<p>Try adding a DoEvents in to yield control to the OS</p>\n\n<pre><code>DoEvents\n\nWith tgt.QueryTables.Add(Connection:= _\n        url, _\n        Destination:=tgt.Range(\"A1\"))\n        .Refresh\nEnd With\n</code></pre>\n\n<p>And/Or:</p>\n\n<p>Use an explicit wait</p>\n\n<pre><code>With tgt.QueryTables.Add(Connection:= _\n        url, _\n        Destination:=tgt.Range(\"A1\"))\n        .Refresh\nEnd With\n\nApplication.Wait Now + TimeSerial(0,0,5) '&lt;== Adjust number of seconds\n</code></pre>\n\n<p>Or (the list goes embarassingly on), try waiting for a cell to become populated as suggested by @zac.</p>\n\n<pre><code>With tgt.QueryTables.Add(Connection:= _\n        url, _\n        Destination:=tgt.Range(\"A1\"))\n        .Refresh\nEnd With\n\nDim t As Date\nt = Timer\n\nDo\n    DoEvents\n    If Timer - t = 100 Then Exit Do '&lt;==To avoid infinite loop\nLoop While IsEmpty(tgt.Range(\"A2\"))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 588, "user_id": 7049751, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6b0e27ce4e8c20a20d34e793f4e4636?s=128&d=identicon&r=PG&f=1", "display_name": "Sphinx", "link": "https://stackoverflow.com/users/7049751/sphinx"}, "is_accepted": false, "score": 1, "last_activity_date": 1532516531, "creation_date": 1532516531, "answer_id": 51517290, "question_id": 51514830, "link": "https://stackoverflow.com/questions/51514830/wait-until-query-is-complete/51517290#51517290", "title": "Wait until query is complete?", "body": "<p>I'm sometimes using OLEDBConnections to refresh data from DB. \nIt acts same as yours when <code>backgroundquery</code> isn't set (it continues to run code without waiting for query end) </p>\n\n<p>Code is something like this \n<BR></p>\n\n<pre><code>With ActiveWorkbook.Connections(\"ConnName\").OLEDBConnection\n   .BackgroundQuery = False\n   .CommandText = \"Select something\"\n   .CommandType = xlCmdSql\n   .Connection = \"connection string\"\n   .Refresh\nEnd With\n</code></pre>\n\n<p>Try to look for <code>.backgroundquery</code> parameter for your connection</p>\n"}, {"tags": [], "owner": {"reputation": 59, "user_id": 9926138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d4edd5470187378199e8d4995004254?s=128&d=identicon&r=PG", "display_name": "mandmi", "link": "https://stackoverflow.com/users/9926138/mandmi"}, "is_accepted": false, "score": 1, "last_activity_date": 1532523176, "creation_date": 1532523176, "answer_id": 51519405, "question_id": 51514830, "link": "https://stackoverflow.com/questions/51514830/wait-until-query-is-complete/51519405#51519405", "title": "Wait until query is complete?", "body": "<pre><code>.Refresh BackgroundQuery:=False\n</code></pre>\n\n<p>Instead of </p>\n\n<pre><code>.Refresh\n</code></pre>\n\n<p>fixed this.</p>\n"}], "owner": {"reputation": 59, "user_id": 9926138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d4edd5470187378199e8d4995004254?s=128&d=identicon&r=PG", "display_name": "mandmi", "link": "https://stackoverflow.com/users/9926138/mandmi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 550, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1532523176, "creation_date": 1532509052, "question_id": 51514830, "link": "https://stackoverflow.com/questions/51514830/wait-until-query-is-complete", "title": "Wait until query is complete?", "body": "<p>I have macro that pulls data from website in CSV format and puts it in Sheet1 A1. Now I want to convert the data text to columns. If I run this pull data macro and then separately the text to columns macro it works fine. If I do it in one macro it does not work since it takes some time to pull the data and the text to column code executes before the data pulling is finished.</p>\n\n<p>How do I make the macro wait until my data pull is complete and then do text to columns?</p>\n\n<pre><code>Option Explicit\n\nSub PPR()\n\n    Dim wb As Workbook\n    Dim tgt As Worksheet\n    Dim stt As Worksheet\n    Set wb = ThisWorkbook\n    Set tgt = wb.Sheets(\"Sheet1\")\n    Set stt = wb.Sheets(\"Sheet2\")\n    tgt.Cells.ClearContents\n    Dim pID As String\n    Dim sType As String\n    Dim sDateInt As String\n    Dim sHourInt As String\n    Dim sMinuteInt As String\n    Dim eDateInt As String\n    Dim eHourInt As String\n    Dim eMinuteInt As String\n    Dim url As String\n    Dim url1 As String\n    Dim url2 As String\n    Dim url3 As String\n    Dim url4 As String\n    Dim url5 As String\n    Dim url6 As String\n    Dim url7 As String\n    Dim url8 As String\n\n'Variables\n    pID = stt.Range(\"B1\")\n    sType = stt.Range(\"B2\")\n    sDateInt = Format(Now, \"YYYY/MM/DD\")\n    sHourInt = stt.Range(\"B4\")\n    sMinuteInt = stt.Range(\"C4\")\n    eDateInt = Format(Now, \"YYYY/MM/DD\")\n    eHourInt = stt.Range(\"B5\")\n    eMinuteInt = stt.Range(\"C5\")\n\n    url1 = \"URL;https://blabla.com/reports/blabla?reportFormat=CSV&amp;blabla=bla\"\n    url2 = url1 &amp; \"&amp;blabla=\" &amp; pID\n    url3 = url2 &amp; \"&amp;maxIntradayDays=1&amp;spanType=\" &amp; sType\n    url4 = url3 &amp; \"&amp;startDateIntraday=\" &amp; sDateInt\n    url5 = url4 &amp; \"&amp;startHourIntraday=\" &amp; sHourInt\n    url6 = url5 &amp; \"&amp;startMinuteIntraday=\" &amp; sMinuteInt\n    url7 = url6 &amp; \"&amp;endDateIntraday=\" &amp; eDateInt\n    url8 = url7 &amp; \"&amp;endHourIntraday=\" &amp; eHourInt\n    url = url8 &amp; \"&amp;endMinuteIntraday=\" &amp; eMinuteInt\n\n    With tgt.QueryTables.Add(Connection:= _\n        url, _\n        Destination:=tgt.Range(\"A1\"))\n        .Refresh\n    End With\n\n    tgt.Activate\n    Columns(\"A:A\").Select\n    Selection.TextToColumns Destination:=Range(\"A1\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n    Semicolon:=False, Comma:=True, Space:=False, Other:=False, FieldInfo _\n    :=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1), _\n    Array(7, 1), Array(8, 1), Array(9, 1), Array(10, 1), Array(11, 1), Array(12, 1), Array(13, 1 _\n    ), Array(14, 1), Array(15, 1), Array(16, 1), Array(17, 1), Array(18, 1)), _\n    TrailingMinusNumbers:=True\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1532510567, "post_id": 51514788, "comment_id": 89998964, "body": "What version of Excel do you have?"}, {"owner": {"reputation": 212, "user_id": 7373309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a438ae919aeb17b00417d619f90852f?s=128&d=identicon&r=PG&f=1", "display_name": "EKSK", "link": "https://stackoverflow.com/users/7373309/eksk"}, "reply_to_user": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1532510999, "post_id": 51514788, "comment_id": 89999280, "body": "Hello I use Excel 2016"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1532529840, "post_id": 51514788, "comment_id": 90012317, "body": "By the sounds of it PowerQuery could be the way to go - I&#39;m still on an ancient version though, so don&#39;t know about such modern things.  Otherwise, please post your code and point out specifically where you&#39;re having problems."}], "answers": [{"tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 2, "last_activity_date": 1532512562, "creation_date": 1532512562, "answer_id": 51515996, "question_id": 51514788, "link": "https://stackoverflow.com/questions/51514788/vba-loop-through-various-excel-files-and-copy-a-cokumn-into-a-master-file/51515996#51515996", "title": "VBA: loop through various Excel files and copy a cokumn into a master file", "body": "<p>Excel 2016 has a new and fairly simple tool called PowerQuery built in that is perfect for this kind of thing, and much simpler than VBA. See Microsoft's site at <a href=\"https://support.office.com/en-us/article/combine-files-in-a-folder-with-combine-binaries-power-query-94b8023c-2e66-4f6b-8c78-6a00041c90e4\" rel=\"nofollow noreferrer\">https://support.office.com/en-us/article/combine-files-in-a-folder-with-combine-binaries-power-query-94b8023c-2e66-4f6b-8c78-6a00041c90e4</a> for an example, or google \"Combine files\" and \"PowerQuery\" and you'll see thousands of tutorials, videos, et cetera demonstrating how to do this in more detail. </p>\n"}], "owner": {"reputation": 212, "user_id": 7373309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a438ae919aeb17b00417d619f90852f?s=128&d=identicon&r=PG&f=1", "display_name": "EKSK", "link": "https://stackoverflow.com/users/7373309/eksk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 1, "closed_date": 1532547203, "answer_count": 1, "score": 0, "last_activity_date": 1532534712, "creation_date": 1532508939, "last_edit_date": 1532534712, "question_id": 51514788, "link": "https://stackoverflow.com/questions/51514788/vba-loop-through-various-excel-files-and-copy-a-cokumn-into-a-master-file", "closed_reason": "Needs more focus", "title": "VBA: loop through various Excel files and copy a cokumn into a master file", "body": "<p>I need VBA Code which opens all xlxs files in a folder and copies a specific column of each file and puts this data in a master sheet. All the data needs to be copied into the first column of the master sheet and new data should always added below.</p>\n\n<p>For older Excel versions without power query I tried this but it does not work :-(</p>\n\n<pre><code> Sub LoopAllExcelFilesInFolder()\n    Dim lastRow As Integer\n    Dim wb As Workbook\n    Dim myPath As String\n    Dim myFile As String\n    Dim myExtension As String\n\nDim FldrPicker As FileDialog\n\n  Application.ScreenUpdating = False\n  Application.EnableEvents = False\n  Application.Calculation = xlCalculationManual\n\n\n  Set FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\n    With FldrPicker\n      .Title = \"Select A Target Folder\"\n      .AllowMultiSelect = False\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        myPath = .SelectedItems(1) &amp; \"\\\"\n    End With\n\nNextCode:\n  myPath = myPath\n  If myPath = \"\" Then GoTo ResetSettings\n\n  myExtension = \"*.xls*\"\n\n  myFile = Dir(myPath &amp; myExtension)\n\n  Do While myFile &lt;&gt; \"\"\n\n      Set wb = Workbooks.Open(Filename:=myPath &amp; myFile)\n    lastRow = Workbooks(\"SUMMARY.xlsm\").Sheets(\"Sheet1\").Cells(Rows.Count, 9).End(xlUp).Row\n\n      DoEvents\n\n\n    wb.Worksheets(1).Range(Cells(2, 6), Cells(150, 6)).Copy_ Workbooks(\"SUMMARY.xlsm\").Worksheets(\"Sheet1\").Range(Cells(lastRow + 1, 1), Cells(lastRow + 150, 1))\n\n\n       wb.Close SaveChanges:=True\n\n         DoEvents\n\n\n      myFile = Dir\n  Loop\n\n\nResetSettings:\n    Application.EnableEvents = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 1, "creation_date": 1532509175, "post_id": 51514735, "comment_id": 89998001, "body": "you have <code>On Error Resume Next</code> so the error <b>Application-defined or object-defined error</b> when trying to evaluate <code>Rows(i, 1)</code>  is ignored... you should use <code>Cells(i,1)</code> - and you should <b>not use On error resume next...</b>"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1532509327, "post_id": 51514735, "comment_id": 89998104, "body": "also, <code>IsEmpty</code> is for variables in VBA, not cells"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1532509464, "post_id": 51514735, "comment_id": 89998208, "body": "you sould also use <code>Cells(i, 1).Value = &quot;Text...&quot;</code> to set or check a value"}, {"owner": {"reputation": 11, "user_id": 6899305, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g0G4k.png?s=128&g=1", "display_name": "Bart Bart", "link": "https://stackoverflow.com/users/6899305/bart-bart"}, "reply_to_user": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1532510726, "post_id": 51514735, "comment_id": 89999082, "body": "Yeah thanks for feedback. I was recording the macro, and it showed me Rows. Could you explain why Rows has error 1004, and Cells not? You said also that isEmpty is for variables not cells. What do you mean, and if it so, why is it working then? And the last question: how to make in comment isEmpty in blockquote? :)"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 1, "creation_date": 1532510762, "post_id": 51514735, "comment_id": 89999112, "body": "@BartBart This is better asked in a separate question <i>(try to incorporate this question into the new one)</i>"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1532511090, "post_id": 51514735, "comment_id": 89999343, "body": "@Bart-Bart: have a look at <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-rows-property-excel?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">MSDN: Range.Rows Property (Excel)</a>"}, {"owner": {"reputation": 11, "user_id": 6899305, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g0G4k.png?s=128&g=1", "display_name": "Bart Bart", "link": "https://stackoverflow.com/users/6899305/bart-bart"}, "reply_to_user": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1532512410, "post_id": 51514735, "comment_id": 90000242, "body": "@Our-Man-in-Bananas: Ok I get it, so Rows should have a form Rows(i), and I used form Rows(i,j) and the 1004 error occurs. Still would like to know what you have meant about IsEmpty (that is for variables in VBA, not cells) &lt;- I mean what is alternative then?"}], "answers": [{"comments": [{"owner": {"reputation": 106, "user_id": 10126588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f822f88cbfdd1750189c6bad722ba52?s=128&d=identicon&r=PG&f=1", "display_name": "nsane", "link": "https://stackoverflow.com/users/10126588/nsane"}, "reply_to_user": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1532519692, "post_id": 51514932, "comment_id": 90004954, "body": "You should try it yourself or search more specifically for IsEmpty function in excel. <a href=\"https://www.techonthenet.com/excel/formulas/isempty.php\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 106, "user_id": 10126588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f822f88cbfdd1750189c6bad722ba52?s=128&d=identicon&r=PG&f=1", "display_name": "nsane", "link": "https://stackoverflow.com/users/10126588/nsane"}, "reply_to_user": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1532527559, "post_id": 51514932, "comment_id": 90010652, "body": "I don&#39;t know what you mean.. I didn&#39;t edit my initially posted code."}], "tags": [], "owner": {"reputation": 106, "user_id": 10126588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f822f88cbfdd1750189c6bad722ba52?s=128&d=identicon&r=PG&f=1", "display_name": "nsane", "link": "https://stackoverflow.com/users/10126588/nsane"}, "is_accepted": true, "score": 2, "last_activity_date": 1532520049, "last_edit_date": 1532520049, "creation_date": 1532509357, "answer_id": 51514932, "question_id": 51514735, "link": "https://stackoverflow.com/questions/51514735/simple-vba-code-filling-cell-with-text-is-empty/51514932#51514932", "title": "Simple VBA Code: Filling Cell with text is empty", "body": "<p>First: If you want to check the Cells then you should use </p>\n\n<pre><code>Cells(i,1)\n</code></pre>\n\n<p>Second: iRowEmpty is just a copy of the Cell and not a direct reference so you should use</p>\n\n<pre><code>Cells(i,1).Value = \"Text...\"\n</code></pre>\n\n<p>To assign the value to the cell.</p>\n\n<p>So in the end you have something like this</p>\n\n<pre><code>i = 0\nDo Until i = 999\n    i = i + 1\n        If IsEmpty(Cells(i, 1)) = True Then\n           Cells(i, 1).Value = \"Text...\"\n        End If\nLoop\n</code></pre>\n\n<p>Hope this helps.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>To clarify:</p>\n\n<blockquote>\n  <p><strong>Syntax</strong></p>\n  \n  <p>The syntax for the ISEMPTY function in Microsoft Excel is:</p>\n  \n  <p>IsEmpty( value )</p>\n  \n  <p><strong>value</strong></p>\n  \n  <p>The value that you want to test. <strong>If value is a blank cell or\n  uninitialized variable, this function will return TRUE</strong>. Otherwise,\n  the function will return FALSE.</p>\n  \n  <p><strong>Applies To</strong>:</p>\n  \n  <p>Excel 2016, Excel 2013, Excel 2011 for Mac, Excel 2010, Excel 2007,\n  Excel 2003, Excel XP, Excel 2000</p>\n</blockquote>\n\n<p>Taken from: <a href=\"https://www.techonthenet.com/excel/formulas/isempty.php\" rel=\"nofollow noreferrer\">TechOnTheNet</a></p>\n"}], "owner": {"reputation": 11, "user_id": 6899305, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g0G4k.png?s=128&g=1", "display_name": "Bart Bart", "link": "https://stackoverflow.com/users/6899305/bart-bart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1044, "favorite_count": 0, "accepted_answer_id": 51514932, "answer_count": 1, "score": 0, "last_activity_date": 1532520049, "creation_date": 1532508786, "question_id": 51514735, "link": "https://stackoverflow.com/questions/51514735/simple-vba-code-filling-cell-with-text-is-empty", "title": "Simple VBA Code: Filling Cell with text is empty", "body": "<p>this is for learning purpose only. I have this code below. I want that program will go and check every cell from 1 to 999. If the cell is empty it will fill it up with text. Nothing happening with this code:</p>\n\n<pre><code>Sub Makro1()\n'\n' Makro1 Makro\n'\nDim iRow As Integer\nDim iRowEmpty\n\nOn Error Resume Next\n'//Your Line here which causes 1004 error\nIf Err.Number &gt; 0 Then\n  Debug.Print Err.Number &amp; \":\" &amp; Err.Description\nEnd If\n\ni = 0\niRowEmpty = Rows(i, 1)\n\nDo Until i = 999\n    i = i + 1\n    iRowEmpty = Rows(i, 1)\n        If IsEmpty(iRowEmpty) = True Then\n           iRowEmpty.Value = \"Text...\"\n\n        End If\nLoop\nMsgBox (\"The End\")\n'Note: Debug shortcut keys i use in PC: Step Into (F8), Step Over (Shift + F8), Step Out (Ctrl + Shift + F8)\n\nEnd Sub\n</code></pre>\n\n<p>The spreadsheet has 1 column of data, in most cases every second cell is empty.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 551, "user_id": 7862279, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d81f99dbb19cd58585415b7b724b75c0?s=128&d=identicon&r=PG&f=1", "display_name": "JackA", "link": "https://stackoverflow.com/users/7862279/jacka"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1532509155, "post_id": 51514712, "comment_id": 89997986, "body": "@ashleedawg I use a temp variable. In the second bloc of code it is defined as Range (in the first bloc i use Variant). They all have the same size."}, {"owner": {"reputation": 551, "user_id": 7862279, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d81f99dbb19cd58585415b7b724b75c0?s=128&d=identicon&r=PG&f=1", "display_name": "JackA", "link": "https://stackoverflow.com/users/7862279/jacka"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1532509192, "post_id": 51514712, "comment_id": 89998016, "body": "@ashleedawg sorry I&#39;m adding that"}], "answers": [{"comments": [{"owner": {"reputation": 551, "user_id": 7862279, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d81f99dbb19cd58585415b7b724b75c0?s=128&d=identicon&r=PG&f=1", "display_name": "JackA", "link": "https://stackoverflow.com/users/7862279/jacka"}, "edited": false, "score": 0, "creation_date": 1532514934, "post_id": 51515729, "comment_id": 90001914, "body": "It doesn&#39;t work for me... It just empties my cells so I&#39;m checking the rest of my code to see where is the problem"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 551, "user_id": 7862279, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d81f99dbb19cd58585415b7b724b75c0?s=128&d=identicon&r=PG&f=1", "display_name": "JackA", "link": "https://stackoverflow.com/users/7862279/jacka"}, "edited": false, "score": 0, "creation_date": 1532520542, "post_id": 51515729, "comment_id": 90005582, "body": "@JackA alright - now this is a mission for me.. :-)   Which parameters did you specify when you ran the procedure?"}, {"owner": {"reputation": 551, "user_id": 7862279, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d81f99dbb19cd58585415b7b724b75c0?s=128&d=identicon&r=PG&f=1", "display_name": "JackA", "link": "https://stackoverflow.com/users/7862279/jacka"}, "edited": false, "score": 1, "creation_date": 1532522425, "post_id": 51515729, "comment_id": 90006938, "body": "I&#39;ve found my mistake this is actually a very dumb mistake. When I test Line or Arc like this <code>If .Cells(Ligne, 5) = &quot;Line&quot; Then</code> it is not column 5 but 6.... I&#39;ve manage to find this mistake by replacing letters by numbers on my excel sheet. Thank you for your help though. Your code helped me get something cleaner than what I previously had !"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 551, "user_id": 7862279, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d81f99dbb19cd58585415b7b724b75c0?s=128&d=identicon&r=PG&f=1", "display_name": "JackA", "link": "https://stackoverflow.com/users/7862279/jacka"}, "edited": false, "score": 3, "creation_date": 1532523700, "post_id": 51515729, "comment_id": 90007824, "body": "Hooray! I&#39;m glad you figured it out.  Don&#39;t feel bad, the most annoying coding mistakes are rarely &quot;smart&quot; ones. ( I could tell you some <i>screen-smashingly dumb</i> mistakes I&#39;ve been stuck on for weeks.)  now that you mention how you figured it out, i realized a troubleshooting step i could have mentioned a lot earlier... Next time, <i>step through the code</i> with F8 to see what it&#39;s doing. Read more about that here:  <b><a href=\"http://www.cpearson.com/excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\">Debugging VBA</a></b>.  (Perhaps bookmark that link - Guru Chip&#39;s site is my #1 favourite resource for VBA-Everything)"}, {"owner": {"reputation": 551, "user_id": 7862279, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d81f99dbb19cd58585415b7b724b75c0?s=128&d=identicon&r=PG&f=1", "display_name": "JackA", "link": "https://stackoverflow.com/users/7862279/jacka"}, "edited": false, "score": 0, "creation_date": 1532524086, "post_id": 51515729, "comment_id": 90008087, "body": "Thank you for the source ! :) I&#39;ll dig into it if I ever get stuck again !"}, {"owner": {"reputation": 551, "user_id": 7862279, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d81f99dbb19cd58585415b7b724b75c0?s=128&d=identicon&r=PG&f=1", "display_name": "JackA", "link": "https://stackoverflow.com/users/7862279/jacka"}, "edited": false, "score": 0, "creation_date": 1536052532, "post_id": 51515729, "comment_id": 91275128, "body": "What didn&#39;t work when I used your function has been solved with @user2815201 &#39;s answer below ! Thanks again !"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 2, "last_activity_date": 1532512598, "last_edit_date": 1532512598, "creation_date": 1532511749, "answer_id": 51515729, "question_id": 51514712, "link": "https://stackoverflow.com/questions/51514712/swap-two-ranges-vba/51515729#51515729", "title": "Swap two ranges VBA", "body": "<p>Sub <code>SwapRanges</code> will swap the two cell ranges that you give it.</p>\n\n<p>It has no error handling (yet), mainly to ensure that the ranges are the same size and shape (rows x columns) but I will can add that after. Also functionality could theoretically be added to prompt you to select (highlight) the first range and then choose the beginning of the second range.  OR, if the range are <em>always</em> going to be the same size then the sub could be changed to only specify the starting cell and the ending cell...</p>\n\n<p>But for now:</p>\n\n<pre><code>Sub SwapRanges(rg1 As Range, rg2 As Range)\n    Const SwapRC = 1000 ' unused cells to temporaily house the data. (row 1000, col 1000)\n    Dim rgLimbo As Range\n\n    Set rgLimbo = Range(Cells(SwapRC, SwapRC), Cells(SwapRC + rg1.Rows.Count, SwapRC + rg1.Columns.Count))\n    rg1.Copy rgLimbo       'copy rg1 to \"limbo\"\n    rg2.Copy rg1           'copy rg2 to rg1\n    rgLimbo.Copy rg2       'copy \"limbo\" to rg1\n    rgLimbo.ClearContents  'clear \"limbo\"\nEnd Sub\n</code></pre>\n\n<p>...so for example I tested it on my end with these two ranges and everything including cell formatting was swapped back and forth repeatedly.</p>\n\n<pre><code>Sub Example()\n    SwapRanges Range(\"B2:D8\"), Range(\"F6:H9\")\nEnd Sub\n</code></pre>\n\n<p>It uses a \"limbo\" cell location as a temporary \"holder\", beginning at Row 1000, Column 1000. If you have existing data there you'll want to change the constant. </p>\n\n<hr>\n\n<ul>\n<li><p>Here's an example of it working for me... (I just assigned sub <code>Example</code> to the button.)  </p>\n\n<p><img src=\"https://i.stack.imgur.com/MoCaB.gif\" alt=\"img\"></p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 2815201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1caed272e4f39813f6e68259e82187d?s=128&d=identicon&r=PG&f=1", "display_name": "Vassilis", "link": "https://stackoverflow.com/users/2815201/vassilis"}, "is_accepted": false, "score": 1, "last_activity_date": 1534502183, "creation_date": 1534502183, "answer_id": 51893539, "question_id": 51514712, "link": "https://stackoverflow.com/questions/51514712/swap-two-ranges-vba/51893539#51893539", "title": "Swap two ranges VBA", "body": "<p>It worked for me after I changed this line</p>\n\n<pre><code>Set rgLimbo = Range(Cells(SwapRC, SwapRC), Cells(SwapRC + rg1.Rows.Count, SwapRC + rg1.Columns.Count))\n</code></pre>\n\n<p>to this </p>\n\n<pre><code>Set rgLimbo = Range(Cells(SwapRC, SwapRC), Cells(SwapRC + rg1.Rows.Count-1, SwapRC + rg1.Columns.Count-1))\n</code></pre>\n"}], "owner": {"reputation": 551, "user_id": 7862279, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d81f99dbb19cd58585415b7b724b75c0?s=128&d=identicon&r=PG&f=1", "display_name": "JackA", "link": "https://stackoverflow.com/users/7862279/jacka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1108, "favorite_count": 0, "accepted_answer_id": 51515729, "answer_count": 2, "score": 1, "last_activity_date": 1534502183, "creation_date": 1532508726, "last_edit_date": 1532518801, "question_id": 51514712, "link": "https://stackoverflow.com/questions/51514712/swap-two-ranges-vba", "title": "Swap two ranges VBA", "body": "<p>I'm trying to swap two ranges. I've tried the method shown in <a href=\"https://stackoverflow.com/questions/33924905/swapping-two-ranges\">another post on stack</a> but I still can't do it. I get errors such as well.. 'nothing happens' with this code :</p>\n\n<p>(these are big code samples but the swapping part is pretty small at the end. I have put a comment to indicate the location of it. Temp variable is defined at the beginning)</p>\n\n<p>Or <code>execution error '5' : Argument or procedure call incorrect</code> (it appears on the first line of my swapping process) with this code:</p>\n\n<pre><code>Dim X, Y, Xi, Yi, Ligne As Integer\nDim Temp As Range              ''Here is a change I make\nFor iLine = 3 To LastLine\n    If .Cells(iLine, 5) = \"Line\" Then\n        Y = .Cells(iLine, 8).Value\n        X = .Cells(iLine, 7).Value\n    ElseIf .Cells(iLine, 5) = \"Arc\" Then\n        X = .Cells(iLine, 15).Value\n        Y = .Cells(iLine, 16).Value\n    End If\n\n    Ligne = iLine + 1\n    Do While Ligne &lt;= LastLine\n        If .Cells(Ligne, 5) = \"Line\" Then\n            Xi = .Cells(Ligne, 9).Value\n            Yi = .Cells(Ligne, 10).Value\n        ElseIf .Cells(Ligne, 5) = \"Arc\" Then\n            Xi = .Cells(Ligne, 17).Value\n            Yi = .Cells(Ligne, 18).Value\n        End If\n   '''''Swapping is here\n        If (X = Xi) And (Y = Yi) Then \n            Range(.Cells(Ligne, 6), .Cells(Ligne, 18)).Copy Temp               ''Here is a change I make and where the error occurs\n            Range(.Cells(iLine + 1, 6), .Cells(iLine + 1, 18)).Copy Range(.Cells(Ligne, 6), .Cells(Ligne, 18))\n            Range(.Cells(iLine + 1, 6), .Cells(iLine + 1, 18)) = Temp\n            Exit Do\n        Else\n            Ligne = Ligne + 1\n        End If\n    Loop\nNext iLine\n</code></pre>\n\n<p>P.S : to explain what I'm doing : I'm trying to reorganize a sheet that I have. this sheets contains in and out coordinates but these coordinates don't currently follow each other.</p>\n\n<p>So I'm comparing in and out entries to reorganize them in a way that each out coordinates is the same in coordinates as the next entry.</p>\n\n<p>Here is the data I have :\n<a href=\"https://i.stack.imgur.com/sg3nu.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sg3nu.jpg\" alt=\"Data sample\"></a></p>\n\n<hr>\n\n<hr>\n\n<p><strong>EDIT :</strong></p>\n\n<p>I'm now stuck here. The function posted by @ashleedawg empties my cells. So I tried to implement her method but directly into my own code. But this time back to the first fail, it does nothing. I'm thinking this might be because of the other part of my code so if you see anything wrong please let me know :</p>\n\n<pre><code>Dim X, Y, Xi, Yi As Double\nDim Ligne As Integer\nDim Temp, rg1, rg2 As Range\nFor iLine = 3 To LastLine\n    If .Cells(iLine, 5) = \"Line\" Then\n        X = .Cells(iLine, 9).Value\n        Y = .Cells(iLine, 10).Value\n    ElseIf .Cells(iLine, 5) = \"Arc\" Then\n        X = .Cells(iLine, 17).Value\n        Y = .Cells(iLine, 18).Value\n    End If\n\n    Ligne = iLine + 1\n    Do While Ligne &lt;= LastLine\n        If .Cells(Ligne, 5) = \"Line\" Then\n            Xi = .Cells(Ligne, 7).Value\n            Yi = .Cells(Ligne, 8).Value\n        ElseIf .Cells(Ligne, 5) = \"Arc\" Then\n            Xi = .Cells(Ligne, 15).Value\n            Yi = .Cells(Ligne, 16).Value\n        End If\n\n        If (Xi = X) And (Yi = Y) Then\n            Set Temp = Range(.Cells(1000, 1000), .Cells(1000, 1012))\n            Set rg1 = Range(.Cells(Ligne, 6), .Cells(Ligne, 18))\n            Set rg2 = Range(.Cells(iLine + 1, 6), .Cells(iLine + 1, 18))\n            rg1.Copy Temp\n            rg2.Copy rg1\n            Temp.Copy rg2\n            'SwapRanges Range(.Cells(iLine + 1, 6), .Cells(iLine + 1, 18)), Range(.Cells(Ligne, 6), .Cells(Ligne, 18))\n            Exit Do\n        Else\n            Ligne = Ligne + 1\n        End If\n    Loop\nNext iLine\n</code></pre>\n\n<p>The last item I have in my temp range is the last line of my sheet :</p>\n\n<pre><code>Arc 50  120         50  46,834  180 5   84,206  156,469 0   120\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10131614, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8qIXRcRx8oA/AAAAAAAAAAI/AAAAAAAABzQ/lkKSjl_OH10/photo.jpg?sz=128", "display_name": "Joel Adrian Simbahan", "link": "https://stackoverflow.com/users/10131614/joel-adrian-simbahan"}, "edited": false, "score": 0, "creation_date": 1532509585, "post_id": 51514875, "comment_id": 89998285, "body": "Hi Andre! This works.  However, it creates a duplicate table.  Is there anyway I could just update the existing table&#39;s linkage (without using delete table then transferdatabase)?"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1532510844, "last_edit_date": 1532510844, "creation_date": 1532509201, "answer_id": 51514875, "question_id": 51514568, "link": "https://stackoverflow.com/questions/51514568/vba-update-linked-table-of-an-access-file-from-excel/51514875#51514875", "title": "VBA - Update Linked Table of an Access file from Excel", "body": "<p><code>DoCmd</code> belongs to the Access application object.</p>\n\n<p>So use</p>\n\n<pre><code>Db.DoCmd.TransferDatabase ' etc.\n</code></pre>\n\n<p><strong>Edit</strong></p>\n\n<p>To update the link, you need the <code>TableDef</code> object, set its <code>.Connect</code> property and run <code>.RefreshLink</code>.</p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/12606326/linked-table-ms-access-2010-change-connection-string\">Linked table ms access 2010 change connection string</a></p>\n"}], "owner": {"reputation": 25, "user_id": 10131614, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8qIXRcRx8oA/AAAAAAAAAAI/AAAAAAAABzQ/lkKSjl_OH10/photo.jpg?sz=128", "display_name": "Joel Adrian Simbahan", "link": "https://stackoverflow.com/users/10131614/joel-adrian-simbahan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 0, "accepted_answer_id": 51514875, "answer_count": 1, "score": 1, "last_activity_date": 1594631634, "creation_date": 1532508317, "last_edit_date": 1594631634, "question_id": 51514568, "link": "https://stackoverflow.com/questions/51514568/vba-update-linked-table-of-an-access-file-from-excel", "title": "VBA - Update Linked Table of an Access file from Excel", "body": "<p>I am trying to change the linked table address from an Access file \"Hey.accdb\" using VBA coding from an Excel file.</p>\n\n<p>I've coded the script below in my Excel file and it prompts the error \"Object required\" when I run it.  Can someone please help me with this problem.  I've been staring at it for too long.  Thanks.</p>\n\n<pre><code>Sub RunMacroinAccesswithPara2()\n\nSet Db = CreateObject(\"Access.Application\")\n        Db.OpenCurrentDatabase \"D:\\Database1\\Hey.accdb\"\n        Db.Visible = True\n        Db.AutomationSecurity = msoAutomationSecurityLow\n\n    DoCmd.TransferDatabase TransferType:=acLink, _\n        DatabaseType:=\"Microsoft Access\", _\n        DatabaseName:=\"V:\\Reporting\\Quarterly\\2018Q2\\JP\\Data\\04\\Database\\Valuation_Database.mdb\", _\n        ObjectType:=acTable, _\n        Source:=\"Valuation_Database_Adjusted\", _\n        Destination:=\"Valuation_Database_Adjusted\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "collections", "ms-word", "msgbox"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1532506417, "post_id": 51513323, "comment_id": 89996225, "body": "Have a iook to <a href=\"https://stackoverflow.com/questions/29015444/how-to-join-a-collection-in-vba\" title=\"how to join a collection in vba\">stackoverflow.com/questions/29015444/&hellip;</a> - the answer of Vityata shows code you could use"}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1532521628, "creation_date": 1532521628, "answer_id": 51518892, "question_id": 51513323, "link": "https://stackoverflow.com/questions/51513323/vba-collections-list-found-items-in-msgbox/51518892#51518892", "title": "VBA collections - List found items in MsgBox", "body": "<p>You could do it as follows. My addition checks whether the collection <code>wcoll</code> contains any members. If it does, the text to show in the <code>MsgBox</code> is concatenated. First the static text is assigned, then the members of the collection are looped and the values appended to the string. If there are no members, a default text is assigned.</p>\n\n<pre><code>Sub example()    \n  Dim w(3) As String, foundWords As String\n  Dim k, l As Integer\n  Dim wcoll As Collection\n  Dim r as Selection\n\nw(1) = \"word1\"\nw(2) = \"word2\"\nw(3) = \"word3\"\n\nSet wcoll = New Collection        \nSet r = Selection\nr.HomeKey Unit:=wdStory\n\n    For k = 1 To 3\n        With r.Find\n            .ClearFormatting\n            .Text = w(k)\n            For l = 1 To 10\n                .Execute wrap:=wdFindStop, Forward:=True\n                     If .found = False Then\n                       Exit For\n                     End If\n                r.Range.HighlightColorIndex = wdRed\n                r.Collapse Direction:=wdCollapseEnd\n\n                wcoll.Add (w(k))    \n            Next\n        End With\n      r.HomeKey Unit:=wdStory\n    Next\n\n    If wcoll.Count &gt; 0 Then\n        foundWords = \"Found words: \"\n        For k = 1 To wcoll.Count\n            foundWords = foundWords &amp; \" \" &amp; wcoll(k)\n        Next\n    Else\n        foundWords = \"No words were found.\"\n    End If\n    MsgBox foundWords    \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10131782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae614f970120c43f202604b0ab9f0b1?s=128&d=identicon&r=PG&f=1", "display_name": "xendrogee", "link": "https://stackoverflow.com/users/10131782/xendrogee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 729, "favorite_count": 0, "accepted_answer_id": 51518892, "answer_count": 1, "score": 1, "last_activity_date": 1532521862, "creation_date": 1532504167, "last_edit_date": 1532521862, "question_id": 51513323, "link": "https://stackoverflow.com/questions/51513323/vba-collections-list-found-items-in-msgbox", "title": "VBA collections - List found items in MsgBox", "body": "<p>I was wondering about making a word searcher in a Word document. Previously, all I managed to create is a code that makes it possible to highlight the words I added to a list:</p>\n\n<pre><code>Sub example\n\nDim w(3) as String\nDim k, l as Integer\n\nw(1)= \"word1\"\nw(2)= \"word2\"\nw(3)= \"word3\"\n\n\nSet r = Selection\nr.HomeKey Unit:=wdStory\n\n    For k = 1 To 3\n        With r.Find\n            .ClearFormatting\n            .Text = w(k)\n            For l = 1 To 10\n                .Execute Wrap:=wdFindStop, Forward:=True\n                     If .Found = False Then\n                       Exit For\n                     End If\n                r.Range.HighlightColorIndex = wdRed\n                r.Collapse Direction:=wdCollapseEnd\n            Next\n        End With\n      r.HomeKey Unit:=wdStory\n    Next\nEnd Sub\n</code></pre>\n\n<p>And it worked perfectly. But my aim was to display all the found words in MsgBox. So I've updated the code:</p>\n\n<pre><code>Sub example\n\nDim w(3) as String\nDim k, l as Integer\n\nw(1)= \"word1\"\nw(2)= \"word2\"\nw(3)= \"word3\"\n\nDim wcoll As Collection\nSet wcoll = New Collection\n\n\nSet r = Selection\nr.HomeKey Unit:=wdStory\n\n    For k = 1 To 3\n        With r.Find\n            .ClearFormatting\n            .Text = w(k)\n            For l = 1 To 10\n                .Execute Wrap:=wdFindStop, Forward:=True\n                     If .Found = False Then\n                       Exit For\n                     End If\n                r.Range.HighlightColorIndex = wdRed\n                r.Collapse Direction:=wdCollapseEnd\n\n                wcoll.Add (w(k))\n\n            Next\n        End With\n      r.HomeKey Unit:=wdStory\n    Next\n\nMsgBox(\"Found words: \" &amp; wcoll(1) &amp; \" \" &amp; wcoll(2) &amp; \" \" &amp; wcoll(3)) \n\nEnd Sub\n</code></pre>\n\n<p>The problem - that I have realized just at the end - is, when the doc contains only 2 of the words searched, but I try to display using the index value <code>3</code> as the subscript <code>wcoll(3)</code> the MsgBox won't pop up. Instead I get a subscript out of range error. How should I solve this issue, to display all the words (even if there are just the same words)? </p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1532503765, "post_id": 51513034, "comment_id": 89994656, "body": "What does the <code>Application.WorksheetFunction</code> return? Have you even tried to troubleshoot this?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1532503772, "post_id": 51513034, "comment_id": 89994661, "body": "There is no <code>WorksheetFunction</code> called <code>FormulaAarray</code>. See <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/list-of-worksheet-functions-available-to-visual-basic\" rel=\"nofollow noreferrer\">List of Worksheet Functions Available to Visual Basic</a>. Probably you want to evaluate? <code>What:=Evaluate(&quot;=MAX(IF(V17:V57&lt;=0,V17:V57),MIN(V17:V57))&quot;)</code>"}, {"owner": {"reputation": 19, "user_id": 5331747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65a2b734e6e39b9c20286cd86e61ada6?s=128&d=identicon&r=PG&f=1", "display_name": "Nui", "link": "https://stackoverflow.com/users/5331747/nui"}, "edited": false, "score": 0, "creation_date": 1532505179, "post_id": 51513034, "comment_id": 89995518, "body": "Thanks PEH. Your suggestion to use Evaluate looks to have helped."}, {"owner": {"reputation": 19, "user_id": 5331747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65a2b734e6e39b9c20286cd86e61ada6?s=128&d=identicon&r=PG&f=1", "display_name": "Nui", "link": "https://stackoverflow.com/users/5331747/nui"}, "edited": false, "score": 0, "creation_date": 1532505745, "post_id": 51513034, "comment_id": 89995818, "body": "I have edited the original question with a revised <code>Find What</code> but nothing happens because I need somehow to incorporate an instruction to <code>select</code> the cell it finds via the formula"}, {"owner": {"reputation": 19, "user_id": 5331747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65a2b734e6e39b9c20286cd86e61ada6?s=128&d=identicon&r=PG&f=1", "display_name": "Nui", "link": "https://stackoverflow.com/users/5331747/nui"}, "edited": false, "score": 0, "creation_date": 1532506636, "post_id": 51513034, "comment_id": 89996354, "body": "PEH the formula I&#39;m using is I believe is an array type and would normally need CTRL+SHIFT+ENTER if done manually in Excel. At the moment my <code>Find What:</code> is finding the greatest negative number. I added <code>Cel.Select</code> by the way to my code to <code>select</code> the cell found"}, {"owner": {"reputation": 19, "user_id": 5331747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65a2b734e6e39b9c20286cd86e61ada6?s=128&d=identicon&r=PG&f=1", "display_name": "Nui", "link": "https://stackoverflow.com/users/5331747/nui"}, "edited": false, "score": 0, "creation_date": 1532511945, "post_id": 51513034, "comment_id": 89999918, "body": "Now my <code>Find What</code> finds the last cell in the range no matter what the value. It is supposed to find the least negative. I updated original question with latest code"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 5331747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65a2b734e6e39b9c20286cd86e61ada6?s=128&d=identicon&r=PG&f=1", "display_name": "Nui", "link": "https://stackoverflow.com/users/5331747/nui"}, "edited": false, "score": 0, "creation_date": 1532504984, "post_id": 51513236, "comment_id": 89995410, "body": "Many thanks. I now have the following that doesn&#39;t produce an error but how can I modify if to <code>select</code> the least negative cell it finds? <code>Cel.Find What:=Evaluate(&quot;MAX(IF(V17:V57&lt;=0,V17:V57),MIN(V17:V57))&quot;), LookIn:=xlFormulas, LookAt:= _         xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False</code>"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 19, "user_id": 5331747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65a2b734e6e39b9c20286cd86e61ada6?s=128&d=identicon&r=PG&f=1", "display_name": "Nui", "link": "https://stackoverflow.com/users/5331747/nui"}, "edited": false, "score": 1, "creation_date": 1532505172, "post_id": 51513236, "comment_id": 89995514, "body": "You are new here, so please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>, then edit your question with new or additional info and then post a comment to alert your followers. Also, please take the <a href=\"https://stackoverflow.com/tour\">tour</a> to learn how this site works."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "reply_to_user": {"reputation": 19, "user_id": 5331747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65a2b734e6e39b9c20286cd86e61ada6?s=128&d=identicon&r=PG&f=1", "display_name": "Nui", "link": "https://stackoverflow.com/users/5331747/nui"}, "edited": false, "score": 0, "creation_date": 1532511225, "post_id": 51513236, "comment_id": 89999419, "body": "@Nui Furthermore, you should <b>never</b> be looking to <code>Select</code> in VBA. It&#39;s one of the worst programming habits you can develop as a VBA coder, as <code>Select</code> is prone to many unforeseen errors. Best avoided altogether"}, {"owner": {"reputation": 19, "user_id": 5331747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65a2b734e6e39b9c20286cd86e61ada6?s=128&d=identicon&r=PG&f=1", "display_name": "Nui", "link": "https://stackoverflow.com/users/5331747/nui"}, "edited": false, "score": 0, "creation_date": 1532512167, "post_id": 51513236, "comment_id": 90000061, "body": "Rawrplus, I removed the <code>Cel.Select</code> and replaced with <code>.Activate</code> but this line now gives me a debug error <code>Cel.Find What:=ActiveSheet.Evaluate(&quot;=LARGE(V17:V57,COUNTIF(V17:V57,&quot;&zwnj;&#8203;&quot;&gt;0&quot;&quot;)+1)&quot;).Activate</code>"}, {"owner": {"reputation": 19, "user_id": 5331747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65a2b734e6e39b9c20286cd86e61ada6?s=128&d=identicon&r=PG&f=1", "display_name": "Nui", "link": "https://stackoverflow.com/users/5331747/nui"}, "edited": false, "score": 0, "creation_date": 1532524859, "post_id": 51513236, "comment_id": 90008618, "body": "teylyn the values in my range are numbers derived from a formula\u2026so each of the cells in the given range has a simple mathematical formula in it (the same one in each of the cells in that range)"}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 0, "last_activity_date": 1532503914, "creation_date": 1532503914, "answer_id": 51513236, "question_id": 51513034, "link": "https://stackoverflow.com/questions/51513034/vba-find-what-error/51513236#51513236", "title": "VBA Find What error", "body": "<p>The result of the array worksheet function may be an array of values, which is not a valid parameter for the <code>.Find</code> command. Make sure that the parameters that you are feeding to the <code>.Find</code> method are valid. </p>\n\n<p>Without seeing your data it is difficult to give more detailed advice.</p>\n"}], "owner": {"reputation": 19, "user_id": 5331747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65a2b734e6e39b9c20286cd86e61ada6?s=128&d=identicon&r=PG&f=1", "display_name": "Nui", "link": "https://stackoverflow.com/users/5331747/nui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 51513236, "answer_count": 1, "score": 0, "last_activity_date": 1532511861, "creation_date": 1532503273, "last_edit_date": 1532511861, "question_id": 51513034, "link": "https://stackoverflow.com/questions/51513034/vba-find-what-error", "title": "VBA Find What error", "body": "<p>Following code gives <code>Find What:</code> debug. Trying to look in a range of numerical values (found from a formula in ea cell, same one in ea cell), if value of exactly 0 does not exist then find and select cell with least negative value. Then set that cell to 0 via goal seek.</p>\n\n<pre><code>Sub Test()\nDim Cel As Range\n\n    For Each Cel In ThisWorkbook.Sheets(\"Sheet1\").Range(\"V17:V57\")\n        If Cel.Value &lt;&gt; 0 Then\n    Cel.Find What:=Application.WorksheetFunction.FormulaArray(\"MAX(IF(V17:V57&lt;=0,V17:V57),MIN(V17:V57))\"), After:=Cells(57, 22), LookIn:=xlFormulas, LookAt:= _\n    xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False\n\n    Cel.GoalSeek Goal:=0, ChangingCell:=Cel.Offset(0, -4)\n        End If\n    Next Cel\nEnd Sub\n</code></pre>\n\n<p>I modified the <code>Find What</code> line and there is no more debug error but how can I modify it further to actually <code>select</code> the least negative cell it finds?</p>\n\n<pre><code>Cel.Find What:=Evaluate(\"=MAX(IF(V17:V57&lt;=0,V17:V57),MIN(V17:V57))\"), LookIn:=xlFormulas, LookAt:= _\nxlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False\n</code></pre>\n\n<p>Using <code>Cel.Select</code> after the <code>Find What:</code> worked</p>\n\n<p>Now my <code>Find What</code> is finding the last cell in the range no matter what the value. It is supposed to find the least negative. Any feedback appreciated. This is the code as it stands</p>\n\n<pre><code> For Each Cel In ThisWorkbook.Sheets(\"Sheet1\").Range(\"V17:V57\")\n    If Cel.Value &lt;&gt; 0 Then\n    Cel.Find What:=ActiveSheet.Evaluate(\"=LARGE(V17:V57,COUNTIF(V17:V57,\"\"&gt;0\"\")+1)\")\n    Cel.Select\n    End If\nNext Cel\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1532503662, "post_id": 51512852, "comment_id": 89994598, "body": "Just to check: you have the Access reference enabled? What exactly is not working? What error message etc? Are you using quotes correctly in your parameter?"}], "answers": [{"tags": [], "owner": {"reputation": 1002, "user_id": 1365754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x4ygw.png?s=128&g=1", "display_name": "Hubisan", "link": "https://stackoverflow.com/users/1365754/hubisan"}, "is_accepted": true, "score": 1, "last_activity_date": 1532503284, "creation_date": 1532503284, "answer_id": 51513042, "question_id": 51512852, "link": "https://stackoverflow.com/questions/51512852/vba-calling-a-sub-in-an-access-file-from-excel-with-parameters/51513042#51513042", "title": "VBA - Calling a SUB in an Access file from Excel with Parameters", "body": "<p>You can use the <a href=\"https://msdn.microsoft.com/en-us/vba/access-vba/articles/application-run-method-access\" rel=\"nofollow noreferrer\">Application.Run</a> method like so:</p>\n\n<pre><code>DB.Run \"HelloWorld\", \"Y\"\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10131614, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8qIXRcRx8oA/AAAAAAAAAAI/AAAAAAAABzQ/lkKSjl_OH10/photo.jpg?sz=128", "display_name": "Joel Adrian Simbahan", "link": "https://stackoverflow.com/users/10131614/joel-adrian-simbahan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 51513042, "answer_count": 1, "score": 1, "last_activity_date": 1594631654, "creation_date": 1532502633, "last_edit_date": 1594631654, "question_id": 51512852, "link": "https://stackoverflow.com/questions/51512852/vba-calling-a-sub-in-an-access-file-from-excel-with-parameters", "title": "VBA - Calling a SUB in an Access file from Excel with Parameters", "body": "<p>I am trying to call a subroutine from the Access file \"Hey.accdb\" using the Excel file \"Hoy.xlsm\".  The subroutine's name is \"HelloWorld\" with parameter \"Para01\" which is a string.  </p>\n\n<h2>Can somebody help me on how I could achieve this?</h2>\n\n<p>Here's my coding in the Excel file which does not work:</p>\n\n<pre><code>Sub RunSubinAccesswithPara()\n\n'Open Access file\nSet Db = CreateObject(\"Access.Application\")\n        Db.OpenCurrentDatabase \"D:\\Database1\\Hey.accdb\"\n        Db.Visible = True\n        Db.AutomationSecurity = msoAutomationSecurityLow\n        Db.Execute \"HelloWorld('Y')\"\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": ["vba", "server", "port", "nas"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1532501066, "post_id": 51512083, "comment_id": 89993205, "body": "Just map a drive letter (N:) to the NAS folder of your choice Net Use N: \\\\10.0.0.10\\yourfolder"}, {"owner": {"reputation": 13, "user_id": 9217268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d1d250b15f9d3aafc7d298f6089b3c?s=128&d=identicon&r=PG&f=1", "display_name": "taewon", "link": "https://stackoverflow.com/users/9217268/taewon"}, "edited": false, "score": 0, "creation_date": 1532559083, "post_id": 51512083, "comment_id": 90025903, "body": "that would work when NAS drive is in local network or VPN. But when it is not on network?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1532586552, "post_id": 51512083, "comment_id": 90032169, "body": "NAS=Network Attached Storage. Without a network it is not NAS"}, {"owner": {"reputation": 13, "user_id": 9217268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d1d250b15f9d3aafc7d298f6089b3c?s=128&d=identicon&r=PG&f=1", "display_name": "taewon", "link": "https://stackoverflow.com/users/9217268/taewon"}, "edited": false, "score": 0, "creation_date": 1532591942, "post_id": 51512083, "comment_id": 90035166, "body": "Sorry wrong expression. I meant &#39;not on windows local or localized network drive such as VPN&#39;. because users(factory workers) in sites sometimes get confused to log in to VPN. actually what I want to know is how to proceed to &#39;connect(using DDNS)-login as user-load picture to sheet or userform&#39; in my vba project without any users&#39; extra job"}], "owner": {"reputation": 13, "user_id": 9217268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d1d250b15f9d3aafc7d298f6089b3c?s=128&d=identicon&r=PG&f=1", "display_name": "taewon", "link": "https://stackoverflow.com/users/9217268/taewon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1532499667, "creation_date": 1532499667, "question_id": 51512083, "link": "https://stackoverflow.com/questions/51512083/how-can-i-access-files-in-nas-through-vba", "title": "How can I access files in NAS through VBA", "body": "<p>I'm building product inspection system using VBA \nin a manufacturing company which is SMB.</p>\n\n<p>Succeeded to access DB in NAS(it was pre-installled) to\nread and write data.</p>\n\n<p>But I can't figure out how to access files in NAS Server\nI need to read and show item pictures on userform \nfor users to check Item and Part Number</p>\n\n<p>Currently doing it using network connection\n(It considers NAS is connected as local &amp; VPN network participant\n so i just load it like \"pictures.insert(\"10.0.0.#######.jpg\")\")</p>\n\n<p>is there any other way to connect and access the picture\nnot by VPN</p>\n\n<p>prbly i should write codes to \nconnect / find forwarded port / verify as user / read file</p>\n\n<p>but dont know how. \nThank you for any advice or opinions alot!</p>\n"}, {"tags": ["excel", "vba", "rpa", "uipath"], "comments": [{"owner": {"reputation": 594, "user_id": 9868674, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mihai Adrian", "link": "https://stackoverflow.com/users/9868674/mihai-adrian"}, "edited": false, "score": 2, "creation_date": 1532502518, "post_id": 51511960, "comment_id": 89993941, "body": "Post the vbscript code. Where is your macro saved? module? worksheet?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1532502914, "post_id": 51511960, "comment_id": 89994163, "body": "Also <code>On Error Resume Next</code> as first line without a proper error handling is a very bad idea. This hides all error messages in the whole function, but the errors still occur, you just cannot see them. This makes you blind and impossible to see errors and therefore you cannot debug and fix your code. Remove that line, see if you get errors and fix them. Hiding errors is never an option."}, {"owner": {"reputation": 1, "user_id": 8288891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TAJPO.jpg?s=128&g=1", "display_name": "NT.Tharu", "link": "https://stackoverflow.com/users/8288891/nt-tharu"}, "reply_to_user": {"reputation": 594, "user_id": 9868674, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mihai Adrian", "link": "https://stackoverflow.com/users/9868674/mihai-adrian"}, "edited": false, "score": 0, "creation_date": 1532503386, "post_id": 51511960, "comment_id": 89994439, "body": "@MihaiAdrian macro is saved in a module."}, {"owner": {"reputation": 1, "user_id": 8288891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TAJPO.jpg?s=128&g=1", "display_name": "NT.Tharu", "link": "https://stackoverflow.com/users/8288891/nt-tharu"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1532503593, "post_id": 51511960, "comment_id": 89994561, "body": "@P\u1d07\u029c I am afraid, As you said I removed that line and run again. But it gives same error. Also I will keep that in mind."}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1532506500, "post_id": 51511960, "comment_id": 89996271, "body": "Why would you use <code>On Error Resume Next</code> in VBA? Surely you&#39;d use <code>On Error Goto &lt;label&gt;</code> instead. VBA&#39;s error handling is more powerful and flexible than VBScript."}, {"owner": {"reputation": 1, "user_id": 8288891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TAJPO.jpg?s=128&g=1", "display_name": "NT.Tharu", "link": "https://stackoverflow.com/users/8288891/nt-tharu"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1532506709, "post_id": 51511960, "comment_id": 89996405, "body": "@P\u1d07\u029c I execute the vbs file from uipath&#39;s invoke vba activity."}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1532506862, "post_id": 51511960, "comment_id": 89996508, "body": "@NT.Tharu that isn&#39;t VBScript (VBS), it has a <code>.vb</code> extension. You&#39;re invoking the VBA module direct from the UIPath GUI."}, {"owner": {"reputation": 1, "user_id": 8288891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TAJPO.jpg?s=128&g=1", "display_name": "NT.Tharu", "link": "https://stackoverflow.com/users/8288891/nt-tharu"}, "reply_to_user": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1532506922, "post_id": 51511960, "comment_id": 89996544, "body": "@Lankymart As i had learnt from internet it is to ignore errors. I am new to vba and vb script . Now i have learnt it is a bad idea to include it."}], "answers": [{"comments": [{"owner": {"reputation": 522, "user_id": 6906583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AUMdB.png?s=128&g=1", "display_name": "KhaledMostafaMe", "link": "https://stackoverflow.com/users/6906583/khaledmostafame"}, "edited": false, "score": 0, "creation_date": 1558298767, "post_id": 51611700, "comment_id": 99044851, "body": "It does support both XLSX and XLS and I&#39;ve tested and it&#39;s working.    <a href=\"https://activities.uipath.com/docs/invoke-vba\" rel=\"nofollow noreferrer\">activities.uipath.com/docs/invoke-vba</a>"}, {"owner": {"reputation": 1, "user_id": 8288891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TAJPO.jpg?s=128&g=1", "display_name": "NT.Tharu", "link": "https://stackoverflow.com/users/8288891/nt-tharu"}, "reply_to_user": {"reputation": 522, "user_id": 6906583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AUMdB.png?s=128&g=1", "display_name": "KhaledMostafaMe", "link": "https://stackoverflow.com/users/6906583/khaledmostafame"}, "edited": false, "score": 0, "creation_date": 1558695873, "post_id": 51611700, "comment_id": 99195014, "body": "When i changed xlsx instead of xls, It worked for me one year ago."}], "tags": [], "owner": {"reputation": 1, "user_id": 8288891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TAJPO.jpg?s=128&g=1", "display_name": "NT.Tharu", "link": "https://stackoverflow.com/users/8288891/nt-tharu"}, "is_accepted": true, "score": 0, "last_activity_date": 1533034436, "creation_date": 1533034436, "answer_id": 51611700, "question_id": 51511960, "link": "https://stackoverflow.com/questions/51511960/uipath-error-macro-may-not-be-available-in-this-workbook/51611700#51611700", "title": "Uipath error: &quot;macro may not be available in this workbook&quot;?", "body": "<p>When you include a .xlsx excel file instead of .xls file it works. It is because Uipath invoke VBA activity does not support .xls files as it is older version. </p>\n"}], "owner": {"reputation": 1, "user_id": 8288891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TAJPO.jpg?s=128&g=1", "display_name": "NT.Tharu", "link": "https://stackoverflow.com/users/8288891/nt-tharu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3018, "favorite_count": 1, "accepted_answer_id": 51611700, "answer_count": 1, "score": -2, "last_activity_date": 1558189914, "creation_date": 1532499171, "last_edit_date": 1558189914, "question_id": 51511960, "link": "https://stackoverflow.com/questions/51511960/uipath-error-macro-may-not-be-available-in-this-workbook", "title": "Uipath error: &quot;macro may not be available in this workbook&quot;?", "body": "<p>I am trying to retrieve cell addresses from an Excel sheet with UIPath invoke VBA activity.</p>\n\n<p>I am new to VBA coding. I have written a function to retrieve cell address array and I have written a sub procedure to call that function.</p>\n\n<p>I am calling the sub in UIPath activity named 'invoke VBA'. When I run this it says </p>\n\n<blockquote>\n  <p>Invoke VBA : Cannot run the macro 'Main'. The macro may not be<br>\n  available in this workbook or all macros may be disabled.</p>\n</blockquote>\n\n<p>This is the screen shot where I have enabled macros in Excel:\n<img src=\"https://i.stack.imgur.com/5205P.png\" alt=\"screen shot\"></p>\n\n<pre><code>Sub Main(Amount As Integer)\n    Call findcellFunction(Amount)\nEnd Sub\n\nFunction findcellFunction(Amount As Integer)As Collection\n    On Error Resume Next\n    Dim rngX As Range           \n    Dim WS As Worksheet\n    Dim datax As Range\n    Dim cellAddress As Variant\n    Dim index As Integer\n    Dim iTotal As Integer\n    Dim CellArray \n    iTotal = 0\n    Set CellArray = New Collection\n    'Iterate until all cell values are found\n    For index=1 To Amount\n        Set rngX = Worksheets(\"rptBOMColorPrint\").Range(\"A1:EZ50\").Find(\"Colour Name\", lookat:=xlPart)\n        If Not rngX Is Nothing Then\n            MsgBox \"Found at \" &amp; rngX.Address\n            CellArray.Add rngX.Address\n        End If\n        Cells(rngX.Row,rngX.Column).Delete\n        iTotel =iTotal + index\n    Next index\n    'shows list that has been populated with cell addresses\n    For Each cellAddress In CellArray\n        MsgBox \"list populated \" &amp; cellAddress\n        Range(cellAddress).Value = \"Colour Name\"\n    Next\n    CellArray = findcellFunction(Amount)\nEnd Function\n</code></pre>\n\n<p>This is how I call the VBA from the UIPath activity.\n<img src=\"https://i.stack.imgur.com/0I388.png\" alt=\"How I call the VBA macro from UIPath\"></p>\n"}, {"tags": ["excel", "vba", "ms-access", "export", "pivot"], "comments": [{"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 1, "creation_date": 1532508320, "post_id": 51511290, "comment_id": 89997417, "body": "could that be related to the <code>Transform</code> behaviour? If you run the <code>Transform</code> code in Access, does it <b>always</b> come out correctly?"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 1, "creation_date": 1532508857, "post_id": 51511290, "comment_id": 89997785, "body": "you may find some help <a href=\"https://stackoverflow.com/questions/20329806/fields-in-the-wrong-order-when-importing-from-csv-to-access\">here</a> and <a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/79fcd5c8-2346-4fb1-85b6-c5d3a212f47d/how-do-i-enforce-output-order-of-a-table-docmdtransferspreadsheet-does-not-write-records-to-excel?forum=accessdev\" rel=\"nofollow noreferrer\">here</a>. Also, would the <code>DoCmd.TranferSpreadsheet</code> be helpful?"}, {"owner": {"reputation": 531, "user_id": 9729023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f8e3c8e31f1c9ba929d94ec4e3886a4?s=128&d=identicon&r=PG&f=1", "display_name": "Sachiko", "link": "https://stackoverflow.com/users/9729023/sachiko"}, "reply_to_user": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 1, "creation_date": 1532607038, "post_id": 51511290, "comment_id": 90044486, "body": "@Our Man in Bananas, Many thanks for your kind advice!  I still have the same issue with DoCmd.TranferSpreadsheet, but thanks to you, I noticed other good things to use it -- before I thought I couldn&#39;t export to paticular sheet by DoCmd.TranferSpreadsheet, but it can (ref. #3 in <a href=\"http://access-excel.tips/access-vba-cocmd-transferspreadsheet/\" rel=\"nofollow noreferrer\">access-excel.tips/access-vba-cocmd-transferspreadsheet</a>). And your reference, espacially the last one really helped me a lot. I&#39;m so grateful all of your considerations."}], "owner": {"reputation": 531, "user_id": 9729023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f8e3c8e31f1c9ba929d94ec4e3886a4?s=128&d=identicon&r=PG&f=1", "display_name": "Sachiko", "link": "https://stackoverflow.com/users/9729023/sachiko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1535026830, "creation_date": 1532496063, "last_edit_date": 1535026830, "question_id": 51511290, "link": "https://stackoverflow.com/questions/51511290/title-order-is-not-expected-when-access-pivot-exported-to-excel-file", "title": "Title Order is not expected, when Access Pivot exported to Excel File.", "body": "<p>I export Access pivots to Excel files, and some of them are having not correct column order -- I'd like to have the total column is sure to be at the end of columns as follos;</p>\n\n<p>Expected:</p>\n\n<pre><code>StaffCode, Name, 2018/04, 2018/05, 2018/06, TOTAL\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>StaffCode, Name, 2018/04, TOTAL, 2018/06, 2018/05 \n&lt;-- TOTAL column is coming before/in pivot columns unexpectedly (some pivot comes as expected)\n</code></pre>\n\n<p>Usually, I convert pivot query to table and then copy recordset to new excel file.\nIf you've overcame this kind of issue, please let me know about your solutions.</p>\n\n<p>pivot query:</p>\n\n<pre><code>TRANSFORM \n    CDbl(Nz(SUM(TotalHours),0)) AS TotalHours\nSELECT\n    StaffCode,\n    StaffName,\n    SUM(TotalHours) AS TOTAL\nFROM\n    SRC_TABLE\nGROUP BY\n    StaffCode,\n    StaffName\nORDER BY\n    StaffCode\nPIVOT \n   REG_YM;\n</code></pre>\n\n<p>convert query to table:</p>\n\n<pre><code>DoCmd.TransferDatabase acExport, \"Microsoft Access\", Application.CurrentDb.Name, acTable, SrcQueryName, ConvTblName, False\n</code></pre>\n\n<p>export to excel:</p>\n\n<pre><code>Set rst = DB.OpenRecordset(TableName, dbOpenTable)\nSet Ws = objExcel.Worksheets(\"XXXX\")\n Ws.Cells(2, 1).CopyFromRecordset rst\n</code></pre>\n\n<p>Any advice would be appreciated.\nThank you.</p>\n"}, {"tags": ["excel", "vba", "conditional-formatting"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1532496217, "post_id": 51511099, "comment_id": 89991109, "body": "Creating FormatConditions always puts the newly created CFR at the end of the queue unless you reorder them or use SetFirstPriority. I don&#39;t really understand the problem."}, {"owner": {"reputation": 69, "user_id": 8038235, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/f53bbaea2edb8336bbc34f382e2546ec?s=128&d=identicon&r=PG&f=1", "display_name": "user8038235", "link": "https://stackoverflow.com/users/8038235/user8038235"}, "edited": false, "score": 0, "creation_date": 1532532440, "post_id": 51511099, "comment_id": 90014193, "body": "I am trying to get the condition $D3=&quot;CV Sent&quot; to be above the Iconset condition, no matter where I put the iconset conditon in the procedure it is always the first condition in the conditional formatting dialog. I am cycling through 20 worksheets so don&#39;t want to move it manually. Is there an option not to show a specific criteria icon in a cell?"}, {"owner": {"reputation": 69, "user_id": 8038235, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/f53bbaea2edb8336bbc34f382e2546ec?s=128&d=identicon&r=PG&f=1", "display_name": "user8038235", "link": "https://stackoverflow.com/users/8038235/user8038235"}, "edited": false, "score": 0, "creation_date": 1532533814, "post_id": 51511099, "comment_id": 90015021, "body": "I removed the SetFirstPriorit and it made no difference in the order."}], "owner": {"reputation": 69, "user_id": 8038235, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/f53bbaea2edb8336bbc34f382e2546ec?s=128&d=identicon&r=PG&f=1", "display_name": "user8038235", "link": "https://stackoverflow.com/users/8038235/user8038235"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594206614, "creation_date": 1532494802, "last_edit_date": 1594206614, "question_id": 51511099, "link": "https://stackoverflow.com/questions/51511099/place-a-iconset-conditional-formatting-rule-last-within-a-squence-of-rules-vba", "title": "Place a IconSet conditional formatting rule last within a squence of rules VBA", "body": "<p>I have a VBA procedure that places a number of conditional formatting rules on a worksheet. One of the rules is for an icon set, the icon set always ends up as the first rule, I need it to be the last rule or a least under a rule that hides one of the icons in the set so it is blank under its condition, by using the \"Stop If True\" option in the rule above it. Is this normal behavior for the icon set rule to put itself first regardless where it is in the VBA code? </p>\n\n<p>I think an alternate approach would be to make the icon blank, like the \"No Cell Icon\" option that you can do manually, in a cell if it meets its criteria, but I don't know if there is an option for the criteria property. Something similar to the .ShowIconOnly = True for the FormatConitions(1). </p>\n\n<pre><code>      With .FormatConditions(1)\n     .SetFirstPriority\n     .ReverseOrder = False\n     .ShowIconOnly = False\n     .IconSet = ActiveWorkbook.IconSets(xl5Arrows)       \n   .\n   .\n  With .IconCriteria(3)\n        .Type = xlConditionValueNumber\n        .Value = 2\n        .Operator = xlGreaterEqual\n   End With\n</code></pre>\n\n<p>The rule that I want before the Iconset rule is this.</p>\n\n<pre><code>     With Range(\"N3:N200\").FormatConditions.Add( _\n    Type:=xlExpression, _\n    Formula1:=\"=$D3=\"\"CV Sent\"\"\")\n\n    .Interior.color = RGB(198, 239, 206) 'Light green\n   ' .Interior.color = xlNone\n    .Font.color = RGB(0, 97, 0) 'A dark color\n    '.Font.color = RGB(255, 255, 255) 'White\n    .StopIfTrue = True\n   End With\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1532497025, "post_id": 51511059, "comment_id": 89991358, "body": "What values will reproduce this error?"}, {"owner": {"reputation": 1, "user_id": 10131274, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0I1jLVxh6Gg/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qHrCHhsgCAsXgjRipp7CqJtmSjYQ/mo/photo.jpg?sz=128", "display_name": "Jackson Mark", "link": "https://stackoverflow.com/users/10131274/jackson-mark"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1532497144, "post_id": 51511059, "comment_id": 89991400, "body": "All the value in Range(&quot;A1:F72798&quot;).Value = &quot;Some String&quot; and I the line error is because I want to search the words some string in the array"}], "owner": {"reputation": 1, "user_id": 10131274, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0I1jLVxh6Gg/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qHrCHhsgCAsXgjRipp7CqJtmSjYQ/mo/photo.jpg?sz=128", "display_name": "Jackson Mark", "link": "https://stackoverflow.com/users/10131274/jackson-mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1532494516, "creation_date": 1532494516, "question_id": 51511059, "link": "https://stackoverflow.com/questions/51511059/array-data-type-mismatch-if-the-data-is-huge", "title": "Array Data type mismatch if the data is huge", "body": "<p>I facing an error msg Run-time Error 13 : Type mismatch for the line</p>\n\n<blockquote>\n  <p>MyFound = .Match(MyFind, .Index(arr, 0, i), 0)</p>\n</blockquote>\n\n<p>I have tested if i change arr = Range(\"A1:F60000\") it works ok</p>\n\n<p>What Data type I have to declared?</p>\n\n<pre><code>Sub test()\n\nDim arr() As Variant\n\nDim i As Long\nDim UB1 As Long\nDim UB2 As Long\n\n'My Range is A1:F72798 (May more than 72798 depend on the data increase)\n\narr = Range(\"A1:F72798\")\nUB1 = UBound(arr)\nUB2 = UBound(arr, 2)\n\nDim MyFind As Variant\nDim MyFound As Variant\n\nMyFind = \"Some String\"\nWith Application\n    For i = 1 To UBound(arr, 2)\n        MyFound = .Match(MyFind, .Index(arr, 0, i), 0)\n        If IsNumeric(MyFound) Then Exit For\n    Next\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "slicers"], "comments": [{"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1532508006, "post_id": 51510808, "comment_id": 89997230, "body": "Welcome to Stack Overflow: Please read <a href=\"https://stackoverflow.com/help/how-to-ask\">How to ask a good question</a>, then edit your question and be sure to ask a <a href=\"http://idownvotedbecau.se/unclearquestion\" rel=\"nofollow noreferrer\">good, clear, concise question</a>, <b>include the code</b>, expected behaviour, and what is wrong... then we can try to help"}, {"owner": {"reputation": 1, "user_id": 10131185, "user_type": "registered", "profile_image": "https://graph.facebook.com/143753109841245/picture?type=large", "display_name": "Reichskommisarait Ostland", "link": "https://stackoverflow.com/users/10131185/reichskommisarait-ostland"}, "reply_to_user": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 1, "creation_date": 1532509715, "post_id": 51510808, "comment_id": 89998380, "body": "Im so sorry about english conversation. My english is not good for me. I world like to make this question understand best I can do. But its very hard for trying correct grammar. Please forgive me"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1532509870, "post_id": 51510808, "comment_id": 89998469, "body": "no worries, but please tell us <b>what is wrong</b> with the code - is there an error, where is the error?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10131185, "user_type": "registered", "profile_image": "https://graph.facebook.com/143753109841245/picture?type=large", "display_name": "Reichskommisarait Ostland", "link": "https://stackoverflow.com/users/10131185/reichskommisarait-ostland"}, "is_accepted": false, "score": 0, "last_activity_date": 1532511152, "creation_date": 1532511152, "answer_id": 51515537, "question_id": 51510808, "link": "https://stackoverflow.com/questions/51510808/set-slicer-from-data-branch-and-print-pdf/51515537#51515537", "title": "Set slicer from data branch and print PDF", "body": "<p>I'm looking for code Set branch into the VBA Slicer. Then make ordering print loop by set branch field VBA.</p>\n\n<pre><code>001 Great Northern &lt;&lt; select \n002 Great Eastern &lt;&lt; select \n003 Great Southen &lt;&lt; not select \n004 Great Midland &lt;&lt; Not select \n015 Great Mainline Transport &lt;&lt; Select \n025 Great Asia Industy &lt;&lt; not select \n030 Great Deutscher &lt;&lt; Select\n</code></pre>\n\n<p>This code from searching internet. I try hard for searching this but its look right only count slicer from first data to last data. </p>\n\n<pre><code>For Each slcCache In ActiveWorkbook.SlicerCaches\n                slcCache.ClearManualFilter\n        Next\n        With ActiveWorkbook.SlicerCaches(\"Slicer_\u0e23\u0e2b\u0e31\u0e2a_\u0e2a\u0e32\u0e02\u0e32\")\n            For Each oSlicerItem In .SlicerItems\n                If oSlicerItem.Name = \"001 : \u0e27\u0e34\u0e20\u0e32\u0e27\u0e14\u0e35\" Then\n                    oSlicerItem.Selected = True\n                Else\n                    oSlicerItem.Selected = False\n                End If\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10131185, "user_type": "registered", "profile_image": "https://graph.facebook.com/143753109841245/picture?type=large", "display_name": "Reichskommisarait Ostland", "link": "https://stackoverflow.com/users/10131185/reichskommisarait-ostland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532511152, "creation_date": 1532493005, "last_edit_date": 1532496133, "question_id": 51510808, "link": "https://stackoverflow.com/questions/51510808/set-slicer-from-data-branch-and-print-pdf", "title": "Set slicer from data branch and print PDF", "body": "<p>I have data from pivot-filter I world like to set data branch for select filter</p>\n\n<blockquote>\n  <p>something like this\n          001 Great Northern &lt;&lt; select\n          002 Great Eastern &lt;&lt; select\n          003 Great Southen &lt;&lt; not select\n          004 Great Midland &lt;&lt; Not select\n          015 Great Mainline Transport &lt;&lt; Select\n          025 Great Asia Industy &lt;&lt; not select\n          030 Great Deutscher &lt;&lt; Select</p>\n</blockquote>\n\n<p>Select with single select after print PDF unselect and select next to finish how to do this code thank you sir (sorry for bad english. I'm not good conversation english)</p>\n\n<pre><code>Sub Button99_PDF()\n        Dim wsA As Worksheet\n        Dim wbA As Workbook\n        Dim strTime As String\n        Dim strName As String\n        Dim strPath As String\n        Dim strFile As String\n        Dim strPathFile As String\n        Dim myFile As Variant\n        Dim codebranch As String\n        Dim branchname As String\n        Dim lictype As String\n        On Error GoTo errHandler\n              Dim tblRaw As ListObject, tblFiltered As ListObject\n              Dim sh_raw As Worksheet, sh_filtered As Worksheet\n              Dim critRange As Range, copyToRng As Range, resizeRng As Range\n              Dim startRow As Long, lastRow As Long\n            Application.ScreenUpdating = False\n            Application.EnableEvents = False\n            Application.Calculation = xlCalculationManual\n\n        If Sheets(\"Pivot_Filters\").Range(\"a8\").Value = \"\" Then Exit Sub\n        Set wsPF = ThisWorkbook.Sheets(\"Pivot_Filters\")\n        Set wsSD = ThisWorkbook.Sheets(\"SalesData\")\n        Set wsOP = ThisWorkbook.Sheets(\"Output\")\n        Set tblFiltered = wsOP.ListObjects(\"table2\")\n        Set ws = ThisWorkbook.Sheets(\"Output\")\n            Select Case tblFiltered.ListRows.Count\n                  Case Is &gt; 0\n                   tblFiltered.DataBodyRange.Delete\n                  tblFiltered.ListRows.Add\n               Case Else\n                  tblFiltered.ListRows.Add\n           End Select\n        For Each slcCache In ActiveWorkbook.SlicerCaches\n                slcCache.ClearManualFilter\n        Next\n        With ActiveWorkbook.SlicerCaches(\"Slicer_\u0e23\u0e2b\u0e31\u0e2a_\u0e2a\u0e32\u0e02\u0e32\")\n            For Each oSlicerItem In .SlicerItems\n                If oSlicerItem.Name = \"001 : \u0e27\u0e34\u0e20\u0e32\u0e27\u0e14\u0e35\" Then\n                    oSlicerItem.Selected = True\n                Else\n                    oSlicerItem.Selected = False\n                End If\n\n\n            With ActiveWorkbook.SlicerCaches(\"Slicer_\u0e1b\u0e23\u0e30\u0e40\u0e20\u0e17_\u0e43\u0e1a\u0e2d\u0e19\u0e38\u0e0d\u0e32\u0e15\")\n                .SlicerItems(\"\u0e15\u0e31\u0e27\u0e41\u0e17\u0e19\").Selected = True\n                .SlicerItems(\"Micro Insurance\").Selected = True\n                .SlicerItems(\"\u0e19\u0e32\u0e22\u0e2b\u0e19\u0e49\u0e32\u0e1a\u0e38\u0e04\u0e04\u0e25\").Selected = False\n                .SlicerItems(\"\u0e19\u0e32\u0e22\u0e2b\u0e19\u0e49\u0e32\u0e19\u0e34\u0e15\u0e34\u0e1a\u0e38\u0e04\u0e04\u0e25\").Selected = False\n                .SlicerItems(\"\u0e1e\u0e23\u0e1a.\").Selected = True\n                                        .SlicerItems(\"\u0e19\u0e32\u0e22\u0e2b\u0e19\u0e49\u0e32\").Selected = False\n                .SlicerItems(\"\u0e42\u0e1a\u0e23\u0e04\u0e40\u0e01\u0e2d\u0e23\u0e4c\").Selected = False\n                .SlicerItems(\"\u0e44\u0e21\u0e48\u0e21\u0e35\u0e1a\u0e31\u0e15\u0e23\").Selected = False\n                .SlicerItems(\"FALSE\").Selected = False\n            End With\n                With ActiveWorkbook.SlicerCaches(\"Slicer_\u0e0a\u0e37\u0e48\u0e2d\u0e2b\u0e25\u0e31\u0e01\u0e2a\u0e39\u0e15\u0e23\")\n                .SlicerItems(\"\u0e02\u0e2d\u0e15\u0e48\u0e2d\u0e43\u0e1a\u0e2d\u0e19\u0e38\u0e0d\u0e32\u0e15\u0e19\u0e32\u0e22\u0e2b\u0e19\u0e49\u0e32\u0e1b\u0e23\u0e30\u0e01\u0e31\u0e19\u0e27\u0e34\u0e19\u0e32\u0e28\u0e20\u0e31\u0e22\u0e04\u0e23\u0e31\u0e49\u0e07\u0e17\u0e35\u0e48 1\").Selected = True\n                .SlicerItems(\"\u0e02\u0e2d\u0e15\u0e48\u0e2d\u0e43\u0e1a\u0e2d\u0e19\u0e38\u0e0d\u0e32\u0e15\u0e19\u0e32\u0e22\u0e2b\u0e19\u0e49\u0e32\u0e1b\u0e23\u0e30\u0e01\u0e31\u0e19\u0e27\u0e34\u0e19\u0e32\u0e28\u0e20\u0e31\u0e22\u0e04\u0e23\u0e31\u0e49\u0e07\u0e17\u0e35\u0e48 2\").Selected = True\n                .SlicerItems(\"\u0e02\u0e2d\u0e15\u0e48\u0e2d\u0e43\u0e1a\u0e2d\u0e19\u0e38\u0e0d\u0e32\u0e15\u0e19\u0e32\u0e22\u0e2b\u0e19\u0e49\u0e32\u0e1b\u0e23\u0e30\u0e01\u0e31\u0e19\u0e27\u0e34\u0e19\u0e32\u0e28\u0e20\u0e31\u0e22\u0e04\u0e23\u0e31\u0e49\u0e07\u0e17\u0e35\u0e48 3\").Selected = True\n                .SlicerItems(\"\u0e02\u0e2d\u0e15\u0e48\u0e2d\u0e43\u0e1a\u0e2d\u0e19\u0e38\u0e0d\u0e32\u0e15\u0e19\u0e32\u0e22\u0e2b\u0e19\u0e49\u0e32\u0e1b\u0e23\u0e30\u0e01\u0e31\u0e19\u0e27\u0e34\u0e19\u0e32\u0e28\u0e20\u0e31\u0e22\u0e04\u0e23\u0e31\u0e49\u0e07\u0e17\u0e35\u0e48 4\").Selected = True\n                .SlicerItems(\"\u0e02\u0e2d\u0e23\u0e31\u0e1a\u0e43\u0e1a\u0e2d\u0e19\u0e38\u0e0d\u0e32\u0e15\u0e19\u0e32\u0e22\u0e2b\u0e19\u0e49\u0e32\u0e1b\u0e23\u0e30\u0e01\u0e31\u0e19\u0e27\u0e34\u0e19\u0e32\u0e28\u0e20\u0e31\u0e22\").Selected = True\n                .SlicerItems(\"\u0e02\u0e2d\u0e15\u0e48\u0e2d\u0e43\u0e1a\u0e2d\u0e19\u0e38\u0e0d\u0e32\u0e15\u0e15\u0e31\u0e27\u0e41\u0e17\u0e19\u0e1b\u0e23\u0e30\u0e01\u0e31\u0e19\u0e27\u0e34\u0e19\u0e32\u0e28\u0e20\u0e31\u0e22\u0e04\u0e23\u0e31\u0e49\u0e07\u0e17\u0e35\u0e48 1\").Selected = True\n                .SlicerItems(\"\u0e02\u0e2d\u0e15\u0e48\u0e2d\u0e43\u0e1a\u0e2d\u0e19\u0e38\u0e0d\u0e32\u0e15\u0e15\u0e31\u0e27\u0e41\u0e17\u0e19\u0e1b\u0e23\u0e30\u0e01\u0e31\u0e19\u0e27\u0e34\u0e19\u0e32\u0e28\u0e20\u0e31\u0e22\u0e04\u0e23\u0e31\u0e49\u0e07\u0e17\u0e35\u0e48 2\").Selected = True\n                .SlicerItems(\"\u0e02\u0e2d\u0e15\u0e48\u0e2d\u0e43\u0e1a\u0e2d\u0e19\u0e38\u0e0d\u0e32\u0e15\u0e15\u0e31\u0e27\u0e41\u0e17\u0e19\u0e1b\u0e23\u0e30\u0e01\u0e31\u0e19\u0e27\u0e34\u0e19\u0e32\u0e28\u0e20\u0e31\u0e22\u0e04\u0e23\u0e31\u0e49\u0e07\u0e17\u0e35\u0e48 3\").Selected = True\n                .SlicerItems(\"\u0e02\u0e2d\u0e15\u0e48\u0e2d\u0e43\u0e1a\u0e2d\u0e19\u0e38\u0e0d\u0e32\u0e15\u0e15\u0e31\u0e27\u0e41\u0e17\u0e19\u0e1b\u0e23\u0e30\u0e01\u0e31\u0e19\u0e27\u0e34\u0e19\u0e32\u0e28\u0e20\u0e31\u0e22\u0e04\u0e23\u0e31\u0e49\u0e07\u0e17\u0e35\u0e48 4\").Selected = True\n                .SlicerItems(\"\u0e02\u0e2d\u0e23\u0e31\u0e1a\u0e43\u0e1a\u0e2d\u0e19\u0e38\u0e0d\u0e32\u0e15\u0e15\u0e31\u0e27\u0e41\u0e17\u0e19\u0e1b\u0e23\u0e30\u0e01\u0e31\u0e19\u0e27\u0e34\u0e19\u0e32\u0e28\u0e20\u0e31\u0e22\").Selected = True\n                .SlicerItems(\"\u0e44\u0e21\u0e48\u0e21\u0e35\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\").Selected = False\n            End With\n        ActiveSheet.ListObjects(\"Table2\").TableStyle = \"TableStyleLight21\"\n        wsSD.Range(\"Sales_Data[#All]\").AdvancedFilter _\n          Action:=xlFilterCopy, _\n          CriteriaRange:=wsPF.Range(\"CritSlicers\"), _\n          CopyToRange:=wsOP.Range(\"ExtractSlicers\"), _\n          Unique:=False\n              'Find Filtered table Header row\n           startRow = tblFiltered.HeaderRowRange.Row\n              'Find last row on Filtered tab (deduct 1 since Advanced filter retrieves the headers)\n           lastRow = wsOP.Columns(2).Find(\"*\", , , , xlByRows, xlPrevious).Row\n              'If the last raw is greater than the Header row, resize the Filtered table and delete the retrieved Headers (which will be in the first row of the Filtered table)\n           If lastRow &gt; startRow Then\n              Set resizeRng = Range(\"table2[#All]\").Resize(tblFiltered.Range.Rows.Count + (lastRow - startRow - 1), tblFiltered.Range.Columns.Count)\n               tblFiltered.Resize resizeRng\n        '       tblFiltered.ListRows(2).Delete\n           Else\n                  'If the last row is equal to Header row it means only the Column headers have been fetched, so there is no matching row to the filter criterias\n                  'The if condition is only for let's say second line of defence\n               If tblFiltered.HeaderRowRange(11, 2) = tblFiltered.DataBodyRange(11, 2) Then\n                  tblFiltered.DataBodyRange.Delete\n              End If\n           End If\n\n\n           Application.ScreenUpdating = True\n           Application.EnableEvents = True\n           Application.Calculation = xlCalculationAutomatic\n      ActiveWorkbook.Worksheets(\"Output\").ListObjects(\"Table2\").Sort.SortFields.Clear\n            ActiveWorkbook.Worksheets(\"Output\").ListObjects(\"Table2\").Sort.SortFields.Add2 _\n                Key:=Range(\"Table2[\u0e04\u0e23\u0e31\u0e49\u0e07\u0e17\u0e35\u0e48]\"), SortOn:=xlSortOnValues, Order:= _\n                xlAscending, DataOption:=xlSortTextAsNumbers\n            ActiveWorkbook.Worksheets(\"Output\").ListObjects(\"Table2\").Sort.SortFields.Add2 _\n                Key:=Range(\"Table2[\u0e27\u0e31\u0e19\" &amp; Chr(10) &amp; \"\u0e2b\u0e21\u0e14\u0e2d\u0e32\u0e22\u0e38]\"), SortOn:=xlSortOnValues, Order:= _\n                xlAscending, DataOption:=xlSortNormal\n            With ActiveWorkbook.Worksheets(\"Output\").ListObjects(\"Table2\").Sort\n                .Header = xlYes\n                .MatchCase = False\n                .Orientation = xlTopToBottom\n                .SortMethod = xlPinYin\n                .Apply\n            End With\n        Worksheets(\"Output\").Columns(\"A:M\").AutoFit\n        Worksheets(\"Output\").Columns(\"K\").Hidden = True\n        Worksheets(\"Output\").PageSetup.PrintArea = \"PrintFocus\"\n\n        stword3 = GetSelectedSlicerItems(\"Slicer_\u0e23\u0e2b\u0e31\u0e2a_\u0e2a\u0e32\u0e02\u0e32\")\n        stword = \"\u0e23\u0e32\u0e22\u0e07\u0e32\u0e19\u0e15\u0e48\u0e2d\u0e43\u0e1a\u0e2d\u0e19\u0e38\u0e0d\u0e32\u0e15\"\n        stword4 = \"\u0e1b\u0e23\u0e30\u0e01\u0e31\u0e19\u0e27\u0e34\u0e19\u0e32\u0e28\u0e20\u0e31\u0e22\"\n        stword5 = GetSelectedSlicerItems2(\"Slicer_\u0e1b\u0e23\u0e30\u0e40\u0e20\u0e17_\u0e43\u0e1a\u0e2d\u0e19\u0e38\u0e0d\u0e32\u0e15\")\n        Range(\"A9\") = stword &amp; \" \" &amp; stword3 &amp; \" \" &amp; stword5 &amp; \" \" &amp; stword4\n        If InStr(Range(\"a9\").Value, \"\u0e19\u0e32\u0e22\u0e2b\u0e19\u0e49\u0e32\") &gt; 0 Then\n            lictype = \"\u0e19\u0e32\u0e22\u0e2b\u0e19\u0e49\u0e32\"\n        ElseIf InStr(Range(\"a9\").Value, \"\u0e15\u0e31\u0e27\u0e41\u0e17\u0e19\") &gt; 0 Then\n            lictype = \"\u0e15\u0e31\u0e27\u0e41\u0e17\u0e19\"\n        ElseIf InStr(Range(\"a9\").Value, \"\u0e43\u0e1a\u0e2d\u0e19\u0e38\u0e0d\u0e32\u0e15\u0e17\u0e31\u0e49\u0e07\u0e2b\u0e21\u0e14\") &gt; 0 Then\n            lictype = \"\u0e23\u0e48\u0e27\u0e21\u0e43\u0e1a\u0e2d\u0e19\u0e38\u0e0d\u0e32\u0e15\"\n        End If\n        codebranch = GetSelectedSlicerItems3(\"Slicer_\u0e23\u0e2b\u0e31\u0e2a_\u0e2a\u0e32\u0e02\u0e32\")\n        branchname = GetSelectedSlicerItems(\"Slicer_\u0e23\u0e2b\u0e31\u0e2a_\u0e2a\u0e32\u0e02\u0e32\")\n        Set wbA = ActiveWorkbook\n        Set wsA = ActiveSheet\n        strTime = Format(Now(), \"dd_mm_yy\")\n        'get active workbook folder, if saved\n        strPath = wbA.Path\n        If strPath = \"\" Then\n          strPath = Application.DefaultFilePath\n        End If\n        strPath = strPath &amp; \"\\\"\n        'replace spaces and periods in sheet name\n        strName = Replace(wsA.Name, \" \", \"\")\n        strName = Replace(strName, \".\", \"_\")\n        'create default name for savng file\n        strFile = lictype &amp; \"_\" &amp; codebranch &amp; \"_\" &amp; branchname &amp; \"_\" &amp; strTime &amp; \".pdf\"\n        strPathFile = strPath &amp; strFile\n        'use can enter name and\n        ' select folder for file\n        myFile = Application.GetSaveAsFilename _\n            (InitialFileName:=strPathFile, _\n                filefilter:=\"PDF Files (*.pdf), *.pdf\", _\n                Title:=\"Select Folder and FileName to save\")\n        'export to PDF if a folder was selected\n        If myFile &lt;&gt; \"False\" Then\n            wsA.ExportAsFixedFormat _\n                Type:=xlTypePDF, _\n                Filename:=myFile, _\n                Quality:=xlQualityStandard, _\n                IncludeDocProperties:=True, _\n                IgnorePrintAreas:=False, _\n                OpenAfterPublish:=False\n            'confirmation message with file info\n            MsgBox \"PDF file has been created: \" _\n              &amp; vbCrLf _\n              &amp; myFile\n        End If\n           Next oSlicerItem\n        End With\n        exitHandler:\n            Exit Sub\n        errHandler:\n            MsgBox \"Could not create PDF file\"\n            Resume exitHandler\n        End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "checkbox", "combobox", "userform"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1532493942, "post_id": 51510312, "comment_id": 89990460, "body": "Similar recent question - <a href=\"https://stackoverflow.com/questions/51390719/need-to-use-the-spinbutton-change-sub-but-i-dont-know-the-number-of-spin-butto/51431879#51431879\" title=\"need to use the spinbutton change sub but i dont know the number of spin butto\">stackoverflow.com/questions/51390719/&hellip;</a>   &quot;Control array&quot; is the term you want to search for.   BTW it&#39;s best to avoid all-caps text here - online it&#39;s often taken for SHOUTING."}, {"owner": {"reputation": 45, "user_id": 10097577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b874019a90f4f51a0e4e89ebc64a193f?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Roy", "link": "https://stackoverflow.com/users/10097577/daniel-roy"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1532494607, "post_id": 51510312, "comment_id": 89990625, "body": "I will look into it... And that is just the case that i used in the target names. Not yelling, i do apologize."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1532494898, "post_id": 51510312, "comment_id": 89990690, "body": "I meant your question title..."}, {"owner": {"reputation": 45, "user_id": 10097577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b874019a90f4f51a0e4e89ebc64a193f?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Roy", "link": "https://stackoverflow.com/users/10097577/daniel-roy"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1532495713, "post_id": 51510312, "comment_id": 89990930, "body": "oops... &quot;face palm&quot;"}, {"owner": {"reputation": 45, "user_id": 10097577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b874019a90f4f51a0e4e89ebc64a193f?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Roy", "link": "https://stackoverflow.com/users/10097577/daniel-roy"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1532497698, "post_id": 51510312, "comment_id": 89991632, "body": "So it might be a dumb way to do it but i took that string of code and went into a spread sheet and broke is apart where i needed to to combine excel auto counting and the =CONCATENATE function..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1532499025, "post_id": 51510312, "comment_id": 89992212, "body": "That works too!   BTW your code simplifies to <code>COMBO1.visible = CHECK1.Value</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "is_accepted": false, "score": 0, "last_activity_date": 1532507432, "creation_date": 1532507432, "answer_id": 51514293, "question_id": 51510312, "link": "https://stackoverflow.com/questions/51510312/userform-loop-for-hiding-and-unhiding-through-multiple-sequences/51514293#51514293", "title": "userform loop for hiding and unhiding through multiple sequences", "body": "<p>In the comments there's already a \"control array\" with WithEvents as a possible solution, below I'll show another solution without the WithEvents:</p>\n\n<p>Copy this code to Notepad and save it as CatchEvents.cls</p>\n\n<pre><code>VERSION 1.0 CLASS\nBEGIN\n  MultiUse = -1  'True\nEND\nAttribute VB_Name = \"CatchEvents\"\nAttribute VB_GlobalNameSpace = False\nAttribute VB_Creatable = False\nAttribute VB_PredeclaredId = False\nAttribute VB_Exposed = False\nPrivate Type GUID\n      Data1 As Long\n      Data2 As Integer\n      Data3 As Integer\n      Data4(0 To 7) As Byte\nEnd Type\n\n#If VBA7 And Win64 Then\n      Private Declare PtrSafe Function ConnectToConnectionPoint Lib \"shlwapi\" Alias \"#168\" (ByVal punk As stdole.IUnknown, _\n              ByRef riidEvent As GUID, ByVal fConnect As Long, ByVal punkTarget As stdole.IUnknown, ByRef pdwCookie As Long, _\n              Optional ByVal ppcpOut As LongPtr) As Long\n#Else\n     Private Declare Function ConnectToConnectionPoint Lib \"shlwapi\" Alias \"#168\" (ByVal punk As stdole.IUnknown, ByRef riidEvent As GUID, _\n              ByVal fConnect As Long, ByVal punkTarget As stdole.IUnknown, ByRef pdwCookie As Long, Optional ByVal ppcpOut As Long) As Long\n#End If\n\n'All Other Control-Events also possible\n'No need to use WithEvents\n'No need to put every Type of control in seperate collection or array, each event will fire no matter which control,\n'so in the eventcode controls can be separated from others\n'you can give your controls additional properties\n'Arguments as Cancel, KeyCode, KeyAscii , Button , x and Y still can be used\n\nPrivate EventGuide As GUID\nPrivate Ck As Long\nPrivate ctl As Object\nPrivate CustomProp As String\n\nPublic Sub MyListClick()\nAttribute MyListClick.VB_UserMemId = -610\nIf TypeName(ctl) = \"CheckBox\" Then\nctl.Parent.Controls(Replace(ctl.Name, \"CHECK\", \"COMBO\")).Visible = ctl.Value\nEnd If\nEnd Sub\n\nPublic Sub ConnectAllEvents(ByVal Connect As Boolean)\n      With EventGuide\n          .Data1 = &amp;H20400\n          .Data4(0) = &amp;HC0\n          .Data4(7) = &amp;H46\n      End With\n      ConnectToConnectionPoint Me, EventGuide, Connect, ctl, Ck, 0&amp;\nEnd Sub\n\nPublic Property Let Item(Ctrl As Object)\n      Set ctl = Ctrl\n      Call ConnectAllEvents(True)\nEnd Property\n\nPublic Sub Clear()\n      If (Ck &lt;&gt; 0) Then Call ConnectAllEvents(False)\n      Set ctl = Nothing\nEnd Sub\n</code></pre>\n\n<p>In the VBA-editor right click somewhere on your Project and choose Import file, a Class named CatchEvents will now be in your Class Modules.</p>\n\n<p>Finally paste code below behind your Userform:</p>\n\n<pre><code>Private AllControls() As New CatchEvents    \n\nPrivate Sub UserForm_Initialize()\nDim j As Long\nReDim AllControls(Controls.Count - 1)\n    For j = 0 To Controls.Count - 1\n         AllControls(j).Item = Controls(j)\n    Next\nEnd Sub\n\nPrivate Sub UserForm_Terminate()\nDim j As Long\n  For j = LBound(AllControls) To UBound(AllControls)\n          AllControls(j).Clear\n      Next j\n      Erase AllControls\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 10097577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b874019a90f4f51a0e4e89ebc64a193f?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Roy", "link": "https://stackoverflow.com/users/10097577/daniel-roy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 263, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1594206567, "creation_date": 1532488782, "last_edit_date": 1594206567, "question_id": 51510312, "link": "https://stackoverflow.com/questions/51510312/userform-loop-for-hiding-and-unhiding-through-multiple-sequences", "title": "userform loop for hiding and unhiding through multiple sequences", "body": "<p>So i have this string of code... It is in a userform and is all vba based (IE not pulling data from a spreadsheet.)</p>\n\n<p>Private Sub CHECK1_Click()</p>\n\n<pre><code>If CHECK1.value = False Then\n    COMBO1.visible = False\n        Else\n            COMBO1.visible = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>It works for perfectly for exactly one checkbox and combobox pair, I need it to work on all 61 on of them, individually... Being new to this I looked at case select possability but it looks like i would have to spell in out.</p>\n\n<p>the userform is called \"ORDER1\"</p>\n\n<p>All of the check boxes are named \"CHECK1\" THROUGH \"CHECK61\"</p>\n\n<p>They all correspond to the combobox' aptly named \"COMBO1\" THROUGH \"COMBO61\" </p>\n\n<p>(CHECK1=COMBO1 throguh the entire form.)</p>\n\n<p>How can I make this work without putting 61 'click' events into the code?\noh and I'm on excel 2010</p>\n"}, {"tags": ["c++", "excel", "vba", "excel-addins"], "owner": {"reputation": 21, "user_id": 3827427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abf85178451ec46a02607657bd11e5ef?s=128&d=identicon&r=PG&f=1", "display_name": "erichhh", "link": "https://stackoverflow.com/users/3827427/erichhh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1547188880, "creation_date": 1532488030, "last_edit_date": 1547188880, "question_id": 51510238, "link": "https://stackoverflow.com/questions/51510238/how-to-add-vba-to-excel-using-addins-in-c", "title": "How to add VBA to Excel using addins in C++?", "body": "<p>I am building an addin in C++ to add functionality to Excel.</p>\n\n<p>There is one problem. I cannot undo all the actions called by this addin.</p>\n\n<p>I did some research, and it seems Excel clears the undo stack before VBA operations.</p>\n\n<p>I found that there is a method called onundo, which allows me to call a VBA.</p>\n\n<p>However, I need to define a VBA in current workbook.</p>\n\n<p>Is there a way to add the VBA function automatically in my C++ program? Otherwise, the user needs to add the function, which is not convenient. </p>\n"}, {"tags": ["excel", "vba", "excel-formula", "spreadsheet"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1532486479, "post_id": 51509861, "comment_id": 89989074, "body": "I changed the title of your question as I don&#39;t think you require separate <i>calculation</i>. (That would imply you don&#39;t want formulas in other cells to be calculate.)  I think you want the coloured cells <i>summed</i> into separate cells.  If I&#39;m incorrect, feel free to rollback my change <a href=\"https://stackoverflow.com/posts/51509861/revisions\">here</a>."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1532486659, "post_id": 51509861, "comment_id": 89989112, "body": "How many colors are there?  Do they change?  You mentioned you didn&#39;t like the solution that involved adding a column... this raises the question, &quot;where are the results supposed to go?&quot; Perhaps examples of <b>what you have</b> and <b>what you want to have</b> would helpful.  Also, <b>how many colours</b> are there in use, and, will that <b>change</b>? (Does this need to dynamically add/remove totals?) Generally on <a href=\"https://stackoverflow.com\">Stack Overflow</a> you&#39;re expected to provide your own code in the form of an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and show where the problems is. (That said, this does sound like an interesting, albeit unusual, coding challenge!)"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1532486945, "post_id": 51509861, "comment_id": 89989164, "body": "...also, would this encompass a specific range of cells or a worksheet or the entire workbook?  Does this encompass <i>any</i> colour? (What about white or &quot;No Fill&quot; - which are 2 separate things)? How often should this update the totals - manually, or on schedule, or if something changes?"}, {"owner": {"reputation": 73, "user_id": 3938885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5048980de463d1648a35840611b9f79f?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle Hinkebein", "link": "https://stackoverflow.com/users/3938885/kyle-hinkebein"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1532487558, "post_id": 51509861, "comment_id": 89989254, "body": "Thanks @ashleedawg, the rewording of my question was perfectly fine. Also I am aware that we need to usually show at least some attempt at coding ourselves. It&#39;s been awhile since I&#39;ve asked a question on here so I can&#39;t remember if I can post a pic of what I&#39;m working on or not. That would actually be far more helpful. I don&#39;t think it&#39;s anything difficult, I&#39;m thinking it might require a vb script."}], "owner": {"reputation": 73, "user_id": 3938885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5048980de463d1648a35840611b9f79f?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle Hinkebein", "link": "https://stackoverflow.com/users/3938885/kyle-hinkebein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594210693, "creation_date": 1532484402, "last_edit_date": 1594210693, "question_id": 51509861, "link": "https://stackoverflow.com/questions/51509861/sum-cells-with-a-colored-background-separately-from-other-cells", "title": "Sum cells with a colored background, separately from other cells", "body": "<p>I just want to be able to plug in data, then have the cells that I color a specific color, Yellow for example, totaled into another cell specifically because of the background color.</p>\n\n<p>I've found a couple ways to do this but they seem to involve requiring either another column with the actual color name in every sell to use as a reference for the formula, or it requires me to use filters and another formula. One approach used vb but I couldn't figure out how to make it work.  </p>\n\n<p>I just want to be able to plug data into cells then have the ones that are colored, SUM'ed up into another cell</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"tags": [], "owner": {"reputation": 3129, "user_id": 6656050, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMh8v.jpg?s=128&g=1", "display_name": "Jeremy Kahan", "link": "https://stackoverflow.com/users/6656050/jeremy-kahan"}, "is_accepted": false, "score": 1, "last_activity_date": 1532495671, "last_edit_date": 1532495671, "creation_date": 1532495303, "answer_id": 51511167, "question_id": 51509835, "link": "https://stackoverflow.com/questions/51509835/how-to-transpose-varied-columns-in-excel/51511167#51511167", "title": "How to transpose varied columns in excel?", "body": "<p>Yes it can be done. Here is a vba-less approach. I am using two working columns, A and B (but these could be tucked away elsewhere and hidden). My entries start somewhere below your data lines, in my case on line 6, where in A6 through D6 I put column headers:</p>\n\n<pre><code>sourceline    sourcecol    country    city\n</code></pre>\n\n<p>Now in A7 I put the number 1 to say start in the first row.\nIn A8 I put the following formula which I dragged down as far as needed.\n<code>=if(1+countif(indirect(\"A7:A\"&amp;(row()-1)),A7)=(counta(indirect(\"A\"&amp;A7&amp;\":Z\"&amp;A7))),A7+1,A7)</code>. What does it do? Well, it says let us see how many times the number right above me has occurred. If it is the same as the number of cities (assumed &lt;=25) in the corresponding row, it is time to add 1 and move on to the next row. Otherwise, keep going with that same row.</p>\n\n<p>In B7 I put the following formula and dragged it on down. <code>=if(A7=A6,1+B6,2)</code> It says, If I am still in the same row as the preceding entry, move over a column, else restart at column 2 (B).</p>\n\n<p>Once I have the row and the column, for the country I needed the following in C7 and dragged down <code>=indirect(address(A7,1))</code> which says find me the value in the row mentioned here and column 1 (A).</p>\n\n<p>Similarly in D7 and dragged on down I have <code>=indirect(address(A7,B7))</code> to get the city. That produces your desired table (maybe two columns over, but you could adjust that).</p>\n\n<p>By leaving at least one blank line between the inputs and the headers of my outputs, you also end up with blanks at the bottom of the table if you drag your formula a bit beyond where it is needed.</p>\n\n<p>You could probably simplify the formulas a smidge using the OFFSET function.</p>\n"}, {"comments": [{"owner": {"reputation": 3129, "user_id": 6656050, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMh8v.jpg?s=128&g=1", "display_name": "Jeremy Kahan", "link": "https://stackoverflow.com/users/6656050/jeremy-kahan"}, "edited": false, "score": 0, "creation_date": 1532497511, "post_id": 51511312, "comment_id": 89991566, "body": "Yes, that is simpler. Would it work in Google Sheets (though I suspect there one can do a nice solution with arrayformula, transpose, textjoin, and split)?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 3129, "user_id": 6656050, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMh8v.jpg?s=128&g=1", "display_name": "Jeremy Kahan", "link": "https://stackoverflow.com/users/6656050/jeremy-kahan"}, "edited": false, "score": 0, "creation_date": 1532503816, "post_id": 51511312, "comment_id": 89994683, "body": "@JeremyKahan I&#39;m not sure about Google Sheets.  The question was about Excel - and I don&#39;t use <i>Sheets</i> and I don&#39;t know why anyone would, considering the fact that <a href=\"https://www.microsoft.com/en-ca/education/products/office/default.aspx\" rel=\"nofollow noreferrer\">students</a> and <a href=\"https://developer.microsoft.com/en-us/office/dev-program\" rel=\"nofollow noreferrer\">developers</a> can get  a full (unlimited; not trial) subscription to Office 365 for free (which covers pretty much anyone on this site!)  Also, the fact that nobody says &quot;I wonder if Excel can do that too?&quot; ... Also, I&#39;m a little biased.. :-)"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1532504198, "post_id": 51511312, "comment_id": 89994917, "body": "You&#39;re welcome. It&#39;s a neat trick that nobody knows, so pass it on to others!  There&#39;s lots of things that most people don&#39;t realize Excel can do automatically, such as removing duplicate data, organizing data any-which-way you can think of, consolidating multiple sheets, and automatically writing code for you. Just for the heck of it, here&#39;s a couple <b>favourite resources worth bookmarking: <a href=\"http://www.cpearson.com/Excel/Topic.aspx\" rel=\"nofollow noreferrer\">Chip Pearson&#39;s site</a> and <a href=\"https://www.rondebruin.nl/tips.htm\" rel=\"nofollow noreferrer\">Ron de Bruin&#39;s site</a> and <a href=\"http://www.kubiszyn.co.uk/free-stuff.html\" rel=\"nofollow noreferrer\">Free Excel Stuff</a></b>"}, {"owner": {"reputation": 3129, "user_id": 6656050, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMh8v.jpg?s=128&g=1", "display_name": "Jeremy Kahan", "link": "https://stackoverflow.com/users/6656050/jeremy-kahan"}, "edited": false, "score": 0, "creation_date": 1532530602, "post_id": 51511312, "comment_id": 90012848, "body": "@ashleedawg, I&#39;m not one of those people who gets into loyalty issues and will go on at length about Mac vs Pc, etcetera. I do find myself looking at a number of posts about excel and saying, &quot;this would be so simple if I could use a function like...&quot; (TEXTJOIN, ARRAYFORMULA, UNIQUE, QUERY). I&#39;m sure there are tradeoffs, though."}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 3, "last_activity_date": 1532496512, "last_edit_date": 1532496512, "creation_date": 1532496177, "answer_id": 51511312, "question_id": 51509835, "link": "https://stackoverflow.com/questions/51509835/how-to-transpose-varied-columns-in-excel/51511312#51511312", "title": "How to transpose varied columns in excel?", "body": "<p>If you want to get from this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/i33hl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/i33hl.png\" alt=\"img1\"></a></p>\n\n<p>...to this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/jrtFV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jrtFV.png\" alt=\"img2\"></a></p>\n\n<h2>Then what you want to do is called an <em>Unpivot</em>.</h2>\n\n<ol>\n<li>Highlight your data and hit <strong>CTRL+T</strong> to make it into a table. (Check the \"my data has headings\" if there are headings, or un-check it if it does not, like your example.)</li>\n<li>On the <strong>DATA</strong> tab click <strong>FROM TABLE/RANGE</strong>.  This will open PowerQuery.</li>\n<li>You need to select all columns EXCEPT for the first one, so click the 2nd column and then push and hold <code>CTRL</code> while you click each of the others to the right of it.  </li>\n<li>on the <strong>TRANSFORM</strong> tab click <strong>UNPIVOT COLUMNS</strong>.</li>\n<li>Click the <strong>X</strong> in the top-right of the screen, and click \"<strong>KEEP CHANGES</strong>\"</li>\n</ol>\n\n<p><em>You're Done!</em>  (...so easy that it's fun!)</p>\n\n<p><img src=\"https://imgur.com/KILoaUz.gif\" alt=\"Image\"></p>\n\n<ul>\n<li>More example and links to more detailed information at my other answer <a href=\"https://stackoverflow.com/a/47676083/8112776\"><strong>here</strong></a>.</li>\n</ul>\n"}], "owner": {"reputation": 123, "user_id": 2432608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edc20c0528e468095b0a1d65c22165bd?s=128&d=identicon&r=PG", "display_name": "Gobrisebane", "link": "https://stackoverflow.com/users/2432608/gobrisebane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 51511312, "answer_count": 2, "score": 0, "last_activity_date": 1594210688, "creation_date": 1532484241, "last_edit_date": 1594210688, "question_id": 51509835, "link": "https://stackoverflow.com/questions/51509835/how-to-transpose-varied-columns-in-excel", "title": "How to transpose varied columns in excel?", "body": "<p><a href=\"https://i.stack.imgur.com/Pw0ur.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Pw0ur.png\" alt=\"enter image description here\"></a></p>\n\n<p>I've ton of rows like above.</p>\n\n<p>Below table is ideal result.</p>\n\n<p>I had worked with v-lookup, pivot table with no luck.</p>\n\n<p>Is there any way to correctly match varied columns?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1532508762, "post_id": 51509760, "comment_id": 89997704, "body": "Because of the merging, your un-bolded cells are presumably not on the first row. So you need to bold the second row as well."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 8624113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88cff5d802db4845fb9cd84a87f5dd2f?s=128&d=identicon&r=PG&f=1", "display_name": "kerry", "link": "https://stackoverflow.com/users/8624113/kerry"}, "edited": false, "score": 0, "creation_date": 1532571926, "post_id": 51514751, "comment_id": 90028365, "body": "Thanks, <code>RowIndex</code> this demo deepens my understanding of cells"}], "tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 1, "last_activity_date": 1532508835, "creation_date": 1532508835, "answer_id": 51514751, "question_id": 51509760, "link": "https://stackoverflow.com/questions/51509760/how-to-bold-table-header-when-table-header-appears-in-a-vertically-merged-row/51514751#51514751", "title": "How to bold table header when table header appears in a vertically merged row", "body": "<p>Try:</p>\n\n<pre><code>Sub Demo()\nDim i As Long\nWith Selection.Tables(1).Range\n  For i = 1 To .Cells.Count\n    If .Cells(i).RowIndex &lt; 3 Then\n      .Cells(i).Range.Font.Bold = True\n    Else\n      Exit For\n    End If\n  Next\nEnd With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 8624113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88cff5d802db4845fb9cd84a87f5dd2f?s=128&d=identicon&r=PG&f=1", "display_name": "kerry", "link": "https://stackoverflow.com/users/8624113/kerry"}, "edited": false, "score": 0, "creation_date": 1532571782, "post_id": 51521770, "comment_id": 90028340, "body": "Thanks, <code>sel.MoveEnd wdCell, nrCols - 1</code> help me a lot."}, {"owner": {"reputation": 27, "user_id": 8624113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88cff5d802db4845fb9cd84a87f5dd2f?s=128&d=identicon&r=PG&f=1", "display_name": "kerry", "link": "https://stackoverflow.com/users/8624113/kerry"}, "edited": false, "score": 0, "creation_date": 1532572078, "post_id": 51521770, "comment_id": 90028393, "body": "My reputation is 8 now, can you vote for my question, so I can vote up for someone who helps me. :D"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1532529929, "creation_date": 1532529929, "answer_id": 51521770, "question_id": 51509760, "link": "https://stackoverflow.com/questions/51509760/how-to-bold-table-header-when-table-header-appears-in-a-vertically-merged-row/51521770#51521770", "title": "How to bold table header when table header appears in a vertically merged row", "body": "<p>The following works no matter in which column(s) the cells of the first two rows are merged vertically. It bases on how Word selects when the first cell is selected, then you hold SHIFT and extend the selection using the Right-Arrow key.</p>\n\n<p>Unlike in the user interface, when the selection is extended cell-by-cell using <code>MoveEnd</code> the vertically merged cells are picked up immediately. That's why the number of moves corresponds to one less than the number of columns.</p>\n\n<pre><code>Sub BoldTableHeaderVertMergedCells()\n    Dim tbl As Word.Table\n    Dim cel As Word.Cell\n    Dim sel As Word.Selection\n    Dim nrCols As Long, nrCol As Long\n\n    Set sel = Selection\n    nrCol = 1\n    If sel.Information(wdWithInTable) Then\n        Set tbl = sel.Tables(1)\n        nrCols = tbl.Columns.Count\n        Set cel = tbl.Cell(1, 1)\n        cel.Select\n        Set sel = Selection\n        sel.MoveEnd wdCell, nrCols - 1\n        sel.Font.Bold = True\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 8624113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88cff5d802db4845fb9cd84a87f5dd2f?s=128&d=identicon&r=PG&f=1", "display_name": "kerry", "link": "https://stackoverflow.com/users/8624113/kerry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 51521770, "answer_count": 2, "score": 1, "last_activity_date": 1532529929, "creation_date": 1532483498, "last_edit_date": 1532528257, "question_id": 51509760, "link": "https://stackoverflow.com/questions/51509760/how-to-bold-table-header-when-table-header-appears-in-a-vertically-merged-row", "title": "How to bold table header when table header appears in a vertically merged row", "body": "<p>I want bold the <strong>table header</strong>,</p>\n\n<p>I use the code </p>\n\n<p><code>Selection.Tables.Item(1).Rows(1).Range.Bold = True</code></p>\n\n<p>but in the case of a table header in a vertically the merged row it isn't working.</p>\n\n<p>Then I changed my code as below, but as shown in the picture there are still two cells that are not bold. Can anyone give me some help?</p>\n\n<pre><code>Dim i, t As table\nIf selection.Tables.count &gt; 0 Then\nSet t = selection.Tables.Item(1)\n  For i = 1 To t.Columns.count\n    t.Range.Cells(i).Range.Font.Bold = -1\n  Next i\nEnd If\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/knm1i.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/knm1i.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["html", "excel", "vba", "internet-explorer", "web-scraping"], "comments": [{"owner": {"reputation": 3129, "user_id": 6656050, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMh8v.jpg?s=128&g=1", "display_name": "Jeremy Kahan", "link": "https://stackoverflow.com/users/6656050/jeremy-kahan"}, "edited": false, "score": 1, "creation_date": 1532483233, "post_id": 51509597, "comment_id": 89988523, "body": "it looks like where you have innerText you need getAttribute(&quot;href&quot;)"}, {"owner": {"reputation": 39, "user_id": 8473778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7869733898c7cc5d14e3cd951a65b752?s=128&d=identicon&r=PG&f=1", "display_name": "MDI", "link": "https://stackoverflow.com/users/8473778/mdi"}, "reply_to_user": {"reputation": 3129, "user_id": 6656050, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMh8v.jpg?s=128&g=1", "display_name": "Jeremy Kahan", "link": "https://stackoverflow.com/users/6656050/jeremy-kahan"}, "edited": false, "score": 0, "creation_date": 1532498593, "post_id": 51509597, "comment_id": 89992018, "body": "am not getting blank cell if I did this"}, {"owner": {"reputation": 39, "user_id": 8473778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7869733898c7cc5d14e3cd951a65b752?s=128&d=identicon&r=PG&f=1", "display_name": "MDI", "link": "https://stackoverflow.com/users/8473778/mdi"}, "reply_to_user": {"reputation": 3129, "user_id": 6656050, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMh8v.jpg?s=128&g=1", "display_name": "Jeremy Kahan", "link": "https://stackoverflow.com/users/6656050/jeremy-kahan"}, "edited": false, "score": 0, "creation_date": 1532498608, "post_id": 51509597, "comment_id": 89992023, "body": "is there any other way?"}, {"owner": {"reputation": 39, "user_id": 8473778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7869733898c7cc5d14e3cd951a65b752?s=128&d=identicon&r=PG&f=1", "display_name": "MDI", "link": "https://stackoverflow.com/users/8473778/mdi"}, "reply_to_user": {"reputation": 3129, "user_id": 6656050, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMh8v.jpg?s=128&g=1", "display_name": "Jeremy Kahan", "link": "https://stackoverflow.com/users/6656050/jeremy-kahan"}, "edited": false, "score": 0, "creation_date": 1532498633, "post_id": 51509597, "comment_id": 89992036, "body": "@JeremyKahan is there any other way."}, {"owner": {"reputation": 39, "user_id": 8473778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7869733898c7cc5d14e3cd951a65b752?s=128&d=identicon&r=PG&f=1", "display_name": "MDI", "link": "https://stackoverflow.com/users/8473778/mdi"}, "reply_to_user": {"reputation": 3129, "user_id": 6656050, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMh8v.jpg?s=128&g=1", "display_name": "Jeremy Kahan", "link": "https://stackoverflow.com/users/6656050/jeremy-kahan"}, "edited": false, "score": 0, "creation_date": 1532498919, "post_id": 51509597, "comment_id": 89992165, "body": "can anyone pls explain for this below code:"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1557406631, "post_id": 51509597, "comment_id": 98760270, "body": "Was this answered?"}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1532499708, "creation_date": 1532499708, "answer_id": 51512093, "question_id": 51509597, "link": "https://stackoverflow.com/questions/51509597/get-href-link-from-html-page-and-navigate-to-that-link-using-vba/51512093#51512093", "title": "Get &quot;href=link&quot; from html page and navigate to that link using vba", "body": "<ol>\n<li><p>This <code>If element.className = \"question-hyperlink\" Then</code> is useless because it is always true because you <code>getElementsByClassName(\"question-hyperlink\")</code> so all elements are definitely of class <code>question-hyperlink</code>. The <code>If</code> statement can be removed.</p></li>\n<li><p>You have each link in the variable <code>element</code> so you don't need the <code>count</code>. Instead of <code>html.getElementsByClassName(\"question-hyperlink\")(count).innerText</code> use <code>element.innerText</code>.</p></li>\n</ol>\n\n<p>So it should look like this:</p>\n\n<pre><code>Set elements = html.getElementsByClassName(\"question-hyperlink\")\nDim erow As Long\n\nFor Each element In elements\n    erow = Worksheets(\"Exec\").Cells(Rows.count, 1).End(xlUp).Offset(1, 0).Row\n    Worksheets(\"Exec\").Cells(erow, 1) = element.innerText\n    Worksheets(\"Exec\").Cells(erow, 2) = element.GetAttribute(\"href\") 'this should give you the URL\nNext element\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 1, "creation_date": 1532503569, "post_id": 51512846, "comment_id": 89994547, "body": "To avoid <code>.getAttribute(&quot;href&quot;)</code> in for loop  use <code>.querySelectorAll(&quot;a.question-hyperlink[href]&quot;)</code>"}, {"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 1, "creation_date": 1532504485, "post_id": 51512846, "comment_id": 89995114, "body": "Not really once you change, the value can be accessed using <code>Debug.Print linkList(i)</code>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1557406605, "post_id": 51512846, "comment_id": 98760257, "body": "Did this answer your question @MDI ?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1532519412, "last_edit_date": 1532519412, "creation_date": 1532502596, "answer_id": 51512846, "question_id": 51509597, "link": "https://stackoverflow.com/questions/51509597/get-href-link-from-html-page-and-navigate-to-that-link-using-vba/51512846#51512846", "title": "Get &quot;href=link&quot; from html page and navigate to that link using vba", "body": "<h2>Method \u2460</h2>\n\n<p><strong>Use XHR to make initial request using question homepage URL; apply CSS selector to retrieve links and then pass those links to IE to navigate to</strong></p>\n\n<hr>\n\n<p><strong>CSS selectors to select elements:</strong></p>\n\n<p>You want the <code>href</code> attribute of the element.You have been given an example already. You can use getAttribute, or, as pointed out by @Santosh, combine an <code>href</code> attribute CSS selector with other CSS selectors to target the elements.</p>\n\n<p>CSS selector:</p>\n\n<pre><code>a.question-hyperlink[href]\n</code></pre>\n\n<p>Looks for elements with parent <code>a</code> tag having class of <code>question-hyperlink</code> and an <code>href</code> attribute.</p>\n\n<p>You then apply the CSS selector combination with the <code>querySelectorAll</code> method of <code>document</code> to gather a nodeList of the links.</p>\n\n<hr>\n\n<p><strong>XHR to get initial list of links:</strong></p>\n\n<p>I would issue this first as an XHR, as much faster, and gather your links into a collection/nodeList you can later loop with your IE browser.</p>\n\n<pre><code>Option Explicit\nPublic Sub GetLinks()\n    Dim sResponse As String, HTML As New HTMLDocument, linkList As Object, i As Long\n    Const BASE_URL As String = \"https://stackoverflow.com\"\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", \"https://stackoverflow.com/questions\", False\n        .send\n        sResponse = StrConv(.responseBody, vbUnicode)\n    End With\n    sResponse = Mid$(sResponse, InStr(1, sResponse, \"&lt;!DOCTYPE \"))\n\n    With HTML\n        .body.innerHTML = sResponse\n        Set linkList = .querySelectorAll(\"a.question-hyperlink[href]\")\n        For i = 0 To linkList.Length - 1\n            Debug.Print Replace$(linkList.item(i), \"about:\", BASE_URL)\n        Next i\n    End With\n    'Code using IE and linkList\nEnd Sub\n</code></pre>\n\n<p>In the above <code>linkList</code> is a nodeList holding all the matched elements from the homepage i.e. all the <code>href</code>s on the question landing page. You can loop the <code>.Length</code> of the <code>nodeList</code> and index into it to retrieve a particular <code>href</code> e.g.  linkList.item(i). As the link returned is relative, you need to replace the relative <code>about:</code> part of the path with the protocol + domain i.e.  <code>\"https://stackoverflow.com\"</code>.</p>\n\n<p>Now that you have quickly obtained that list, and can access items, you can pass any given updated <code>href</code> onto <code>IE.Navigate</code>.</p>\n\n<hr>\n\n<p><strong>Navigating to questions using IE and nodeList</strong></p>\n\n<pre><code>For i = 0 To linkList.Length - 1\n    IE.Navigate Replace$(linkList.item(i).getAttribute(\"href\"), \"about:\", BASE_URL)\nNext i\n</code></pre>\n\n<hr>\n\n<h2>Method \u2461</h2>\n\n<p><strong>Use XHR to make initial request using GET request and searched for question title; apply CSS selector to retrieve links and then pass those links to IE to navigate to.</strong></p>\n\n<hr>\n\n<pre><code>Option Explicit\nPublic Sub GetLinks()\n    Dim sResponse As String, HTML As New HTMLDocument, linkList As Object, i As Long\n    Const BASE_URL As String = \"https://stackoverflow.com\"\n    Const TARGET_QUESTION As String = \"How to make the word invisible when it's checked without js\"\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", \"https://stackoverflow.com/search?q=\" &amp; URLEncode(TARGET_QUESTION), False\n        .send\n        sResponse = StrConv(.responseBody, vbUnicode)\n    End With\n    sResponse = Mid$(sResponse, InStr(1, sResponse, \"&lt;!DOCTYPE \"))\n\n    With HTML\n        .body.innerHTML = sResponse\n        Set linkList = .querySelectorAll(\"a.question-hyperlink[href]\")\n        For i = 0 To linkList.Length - 1\n            Debug.Print Replace$(linkList.item(i).getAttribute(\"href\"), \"about:\", BASE_URL)\n        Next i\n    End With\n    If linkList Is Nothing Then Exit Sub\n    'Code using IE and linkList\nEnd Sub\n\n'https://stackoverflow.com/questions/218181/how-can-i-url-encode-a-string-in-excel-vba   @Tomalak\nPublic Function URLEncode( _\n   StringVal As String, _\n   Optional SpaceAsPlus As Boolean = False _\n) As String\n\n  Dim StringLen As Long: StringLen = Len(StringVal)\n\n  If StringLen &gt; 0 Then\n    ReDim result(StringLen) As String\n    Dim i As Long, CharCode As Integer\n    Dim Char As String, Space As String\n\n    If SpaceAsPlus Then Space = \"+\" Else Space = \"%20\"\n\n    For i = 1 To StringLen\n      Char = Mid$(StringVal, i, 1)\n      CharCode = Asc(Char)\n      Select Case CharCode\n        Case 97 To 122, 65 To 90, 48 To 57, 45, 46, 95, 126\n          result(i) = Char\n        Case 32\n          result(i) = Space\n        Case 0 To 15\n          result(i) = \"%0\" &amp; Hex(CharCode)\n        Case Else\n          result(i) = \"%\" &amp; Hex(CharCode)\n      End Select\n    Next i\n    URLEncode = Join(result, \"\")\n  End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 8473778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7869733898c7cc5d14e3cd951a65b752?s=128&d=identicon&r=PG&f=1", "display_name": "MDI", "link": "https://stackoverflow.com/users/8473778/mdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4342, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1557406533, "creation_date": 1532481624, "last_edit_date": 1557406533, "question_id": 51509597, "link": "https://stackoverflow.com/questions/51509597/get-href-link-from-html-page-and-navigate-to-that-link-using-vba", "title": "Get &quot;href=link&quot; from html page and navigate to that link using vba", "body": "<p>I am writing a code in Excel VBA to get <code>href</code> value of a class and navigate to that href link \n(i.e) here is the <code>href</code> value I want to get into my particular Excel sheet and I want to navigate to that link automatically through my VBA code.</p>\n\n<pre><code>&lt;a href=\"/questions/51509457/how-to-make-the-word-invisible-when-its-checked-without-js\" class=\"question-hyperlink\"&gt;How to make the word invisible when it's checked without js&lt;/a&gt;\n</code></pre>\n\n<p>The result I'm getting is that I'm able to get that containing tag's class value <code>How to make the word invisible when it's checked without js</code> &lt;---- this is title is what I am getting in my sheet. What I want to get is this title's holding a <code>href</code> link <code>/questions/51509457/how-to-make-the-word-invisible-when-its-checked-without-js</code> this is what I want to get and navigate through my code.</p>\n\n<p>Please help me out. Thanks in advance</p>\n\n<p>Below are the entire coding:</p>\n\n<pre><code>Sub useClassnames()\n    Dim element As IHTMLElement\n    Dim elements As IHTMLElementCollection\n    Dim ie As InternetExplorer\n    Dim html As HTMLDocument\n\n    'open Internet Explorer in memory, and go to website\n    Set ie = New InternetExplorer\n    ie.Visible = True\n    ie.navigate \"https://stackoverflow.com/questions\"\n    'Wait until IE has loaded the web page\n\n    Do While ie.readyState &lt;&gt; READYSTATE_COMPLETE\n        DoEvents\n    Loop\n\n    Set html = ie.document\n    Set elements = html.getElementsByClassName(\"question-hyperlink\")\n\n    Dim count As Long\n    Dim erow As Long\n    count = 0\n\n    For Each element In elements\n        If element.className = \"question-hyperlink\" Then\n            erow = Sheets(\"Exec\").Cells(Rows.count, 1).End(xlUp).Offset(1, 0).Row\n            Sheets(\"Exec\").Cells(erow, 1) = html.getElementsByClassName(\"question-hyperlink\")(count).innerText\n            count = count + 1\n        End If\n    Next element\n\n    Range(\"H10\").Select\nEnd Sub\n</code></pre>\n\n<p>I cant find any answer in this website asked by anyone. Please don't suggest this question as duplicate.</p>\n\n<pre><code>&lt;div class=\"row hoverSensitive\"&gt;\n        &lt;div class=\"column summary-column summary-column-icon-compact  \"&gt;\n                                &lt;img src=\"images/app/run32.png\" alt=\"\" width=\"32\" height=\"32\"&gt;\n                        &lt;/div&gt;\n        &lt;div class=\"column summary-column  \"&gt;\n            &lt;div class=\"summary-title summary-title-compact text-ppp\"&gt;\n                                        &lt;a href=\"**index.php?/runs/view/7552**\"&gt;MMDA&lt;/a&gt;\n\n            &lt;/div&gt;\n            &lt;div class=\"summary-description-compact text-secondary text-ppp\"&gt;\n                                                                            By on 7/9/2018                                                  &lt;/div&gt;\n        &lt;/div&gt;      \n        &lt;div class=\"column summary-column summary-column-bar  \"&gt;\n                            &lt;div class=\"table\"&gt;\n&lt;div class=\"column\"&gt;\n    &lt;div class=\"chart-bar \"&gt;\n                                                                                                                        &lt;div class=\"chart-bar-custom link-tooltip\" tooltip-position=\"left\" style=\"background: #4dba0f; width: 125px\" tooltip-text=\"100% Passed (11/11 tests)\"&gt;&lt;/div&gt;\n                                                                                                                                                                                                                                                                                                                                                                                                            &lt;/div&gt;\n&lt;/div&gt;\n    &lt;div class=\"column chart-bar-percent chart-bar-percent-compact\"&gt;\n    100%'\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6732604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JZUms.jpg?s=128&g=1", "display_name": "j man", "link": "https://stackoverflow.com/users/6732604/j-man"}, "edited": false, "score": 0, "creation_date": 1532482054, "post_id": 51509599, "comment_id": 89988302, "body": "First, thank you for the quick response. Secondly, I don&#39;t quite understand the code? Is Range(&quot;A1&quot;) actually cell &quot;A1&quot; or does equal cell &quot;H1044&quot;?"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 15, "user_id": 6732604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JZUms.jpg?s=128&g=1", "display_name": "j man", "link": "https://stackoverflow.com/users/6732604/j-man"}, "edited": false, "score": 0, "creation_date": 1532482463, "post_id": 51509599, "comment_id": 89988367, "body": "It is cell A1 or cell row 1, column 1 of the <code>Range(&quot;H1044:H1061&quot;)</code> which is <code>H1044</code>."}, {"owner": {"reputation": 15, "user_id": 6732604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JZUms.jpg?s=128&g=1", "display_name": "j man", "link": "https://stackoverflow.com/users/6732604/j-man"}, "edited": false, "score": 0, "creation_date": 1532482961, "post_id": 51509599, "comment_id": 89988474, "body": "Well, that may pose another problem when I try to offset that new range to retrieve my other needed values. Thank you."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 15, "user_id": 6732604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JZUms.jpg?s=128&g=1", "display_name": "j man", "link": "https://stackoverflow.com/users/6732604/j-man"}, "edited": false, "score": 0, "creation_date": 1532486904, "post_id": 51509599, "comment_id": 89989157, "body": "Why is that? what problem?"}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 0, "last_activity_date": 1532482240, "last_edit_date": 1532482240, "creation_date": 1532481685, "answer_id": 51509599, "question_id": 51509553, "link": "https://stackoverflow.com/questions/51509553/how-to-extract-the-first-range-in-a-selection/51509599#51509599", "title": "How to extract the first range in a selection", "body": "<p>You use <code>Range.Range</code> method to do that.</p>\n\n<pre><code>Debug.Print Range(\"H1044:H1061\").Range(\"A1\").Address '/* will return H1044 */\n</code></pre>\n\n<p>Above will select the first cell in the original Range.\nTo make it more clear, you can also use <code>Cells</code>.</p>\n\n<pre><code>Debug.Print Range(\"H1044:H1061\").Cells(1, 1).Address \n</code></pre>\n\n<p>That means retrieving Cell row 1 and column 1 of the <code>Range(\"H1044:H1061\")</code>.</p>\n"}], "owner": {"reputation": 15, "user_id": 6732604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JZUms.jpg?s=128&g=1", "display_name": "j man", "link": "https://stackoverflow.com/users/6732604/j-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594151966, "creation_date": 1532481254, "last_edit_date": 1594151966, "question_id": 51509553, "link": "https://stackoverflow.com/questions/51509553/how-to-extract-the-first-range-in-a-selection", "title": "How to extract the first range in a selection", "body": "<p>I am using the <code>refedit</code> control on my <code>userform</code>. Is there a way to extract the first range from my selection so I can offset it to retrieve other data from that row as well from \"Sheet1\" within workbook named <code>SDPF</code>. Example: With the <code>refedit</code>, I am selecting the <code>Range(\"H1044:H1061\")</code>. However, to extract the other pieces of data I just need the first selection, of <code>H1044</code>, so I can offset it to retrieve other data, in this case from <code>Range(\"B1044\")</code>, <code>Range(\"C1044\")</code>, <code>Range(\"E1044\")</code>,<code>Range(\"F1044\")</code>, and <code>Range(\"I1044\")</code>.</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1532481175, "post_id": 51509466, "comment_id": 89988122, "body": "What you&#39;re currently doing is <i>specific</i> enough for me. So by <i>specific</i>, what do you mean by that?"}, {"owner": {"reputation": 39, "user_id": 10130636, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TytZk.jpg?s=128&g=1", "display_name": "sunil", "link": "https://stackoverflow.com/users/10130636/sunil"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1532481701, "post_id": 51509466, "comment_id": 89988232, "body": "i have the stock volume data which updates in every 3 minutes, i want to copy that data in every 3 minutes to sheet2. and want the data to be paste from next row like (Row + 1), above code works fine but it only copies the data for 2 cells, i want a Range like (&quot;D1:H10&quot;), a complete range with multiple values"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1532481934, "post_id": 51509466, "comment_id": 89988283, "body": "What you basically need is building a dynamic range. Here&#39;s one post which will help you do that - <i><a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">finding the last row</a></i>. Once you build your range, you can then incorporate it to your code."}, {"owner": {"reputation": 39, "user_id": 10130636, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TytZk.jpg?s=128&g=1", "display_name": "sunil", "link": "https://stackoverflow.com/users/10130636/sunil"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1532528138, "post_id": 51509466, "comment_id": 90011075, "body": "Sorry but Dynamic Ranges may not work as sheet1 range is fixed, just the values are getting updated. In simple words, I just want to copy sheet1 values in interval and paste them in sheet2"}], "owner": {"reputation": 39, "user_id": 10130636, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TytZk.jpg?s=128&g=1", "display_name": "sunil", "link": "https://stackoverflow.com/users/10130636/sunil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1532481069, "creation_date": 1532480310, "last_edit_date": 1532481069, "question_id": 51509466, "link": "https://stackoverflow.com/questions/51509466/save-data-specific-range-in-3-minutes-intervals-to-a-separate-worksheet-in-exc", "title": "Save data (specific range) in 3 minutes intervals to a separate worksheet in Excel", "body": "<p>Below code copies the values from D2 and E2 on Sheet1, to D2 and E2 on Sheet2, adding a new row on Sheet2 every time a row is copied, in every 10 minutes. </p>\n\n<p>Is there any way I can use specific range instead of selecting cell D2 and E2 and save that data on sheet 2 adding a new row?</p>\n\n<pre><code>Sub CopyValues()\nDim RowNo As Long\nRowNo = Sheets(2).Cells(Rows.Count, 4).End(xlUp).Row + 1\n\n     Sheets(2).Cells(RowNo, 4) = Sheets(1).Cells(2, 4)\n     Sheets(2).Cells(RowNo, 5) = Sheets(1).Cells(2, 5)\n\nApplication.OnTime Now + TimeValue(\"00:03:00\"), \"CopyValues\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "is_accepted": true, "score": 0, "last_activity_date": 1532488970, "creation_date": 1532488970, "answer_id": 51510337, "question_id": 51509345, "link": "https://stackoverflow.com/questions/51509345/excel-vba-search-for-dates-and-copy-specific-cells-to-another-sheet/51510337#51510337", "title": "Excel VBA - Search for dates and copy specific cells to another sheet", "body": "<p>Use this code and it should work:</p>\n\n<pre><code>Dim rng As Range, destRow As Long\nDim shtSrc As Worksheet, shtDest As Worksheet\nDim c As Range '-- this is used to store the single cell in the For Each loop\n\nSet shtSrc = Sheets(\"Sheet1\") ' Sets \"Sheet1\" sheet as source sheet\nSet shtDest = Sheets(\"Sheet2\") 'Sets \"Sheet2.\" sheet as destination sheet\ndestRow = 5 'Start copying to this row on destination sheet\n\n' &gt;&gt; Set range to search for dates in Look Ahead period &lt;&lt;\nSet rng = Application.Intersect(shtSrc.Range(\"Q:Q\"), shtSrc.UsedRange)\n\n' &gt;&gt; Look for matching dates in columns C to D &lt;&lt;\nFor Each c In rng.Cells\n    If (c.Value &gt;= StartDate And c.Value &lt;= EndDate) Or _\n(c.Offset(0, 2).Value &gt;= StartDate And c.Offset(0, 2).Value &lt;= EndDate) Then ' Does date fall between start and end dates? If Yes, then copy to destination sheet\n\n        shtSrc.Range(\"C\" &amp; c.Row).Copy shtDest.Range(\"A\" &amp; destRow)\n        shtSrc.Range(\"G\" &amp; c.Row).Copy shtDest.Range(\"B\" &amp; destRow)\n        shtSrc.Range(\"J\" &amp; c.Row).Copy shtDest.Range(\"C\" &amp; destRow)\n        shtSrc.Range(\"Q\" &amp; c.Row).Copy shtDest.Range(\"D\" &amp; destRow)\n        shtSrc.Range(\"S\" &amp; c.Row).Copy shtDest.Range(\"E\" &amp; destRow)\n\n        destRow = destRow + 1\n\n' &gt; Ends search for dates &lt;\n    End If\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "is_accepted": false, "score": 0, "last_activity_date": 1532495850, "last_edit_date": 1532495850, "creation_date": 1532493571, "answer_id": 51510911, "question_id": 51509345, "link": "https://stackoverflow.com/questions/51509345/excel-vba-search-for-dates-and-copy-specific-cells-to-another-sheet/51510911#51510911", "title": "Excel VBA - Search for dates and copy specific cells to another sheet", "body": "<p>Since this is an \"Excel-as-datasource\" problem, I would use an SQL statement for this. Add a reference to <strong>Microsoft ActiveX Data Objects 6.1 Library</strong> (via <strong>Tools</strong> -> <strong>References...</strong>). There may be versions other than 6.1; choose the highest.</p>\n\n<pre><code>Dim pathToExcelFile As String\npathToExcelFile = ActiveWorkbook.Name\n\nDim cmd As New ADODB.Command\ncmd.ActiveConnection = _\n    \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n    \"Data Source=\"\"\" &amp; pathToExcelFile &amp; \"\"\";\" &amp; _\n    \"Extended Properties=\"\"Excel 12.0;HDR=No\"\"\"\n\n'This string defines which data we are retrieving from the source worksheet\n'SELECT F3, F7, F10, F17, F19 -- choose the columns C, G, J, Q and S\n'FROM [Sheet1$] -- from Sheet1\n'WHERE ... -- where F17 (Column Q) is between the start and end date;\n'    we'll fill in the values corresponding to the question marks later\n'OR ... -- or F19 (Column S) is between the start and end date\n\ncmd.CommandText = _\n    \"SELECT F3, F7, F10, F17, F19 \" &amp; _\n    \"FROM [Sheet1$] \" &amp; _\n    \"WHERE F17 BETWEEN ? AND ? \" &amp; _\n       \"OR F19 BETWEEN ? AND ?\"\n\nDim startParameter As ADODB.Parameter\nSet startParameter = cmd.CreateParameter(\"StartDate\", adDate, adParamInput, , StartDate)\n\nDim endParameter As ADODB.Parameter\nSet endParameter = cmd.CreateParameter(\"EndDate\", adDate, adParamInput, , EndDate)\n\n'We're filling in the question marks here\n'1st and 3rd -- start date\n'2nd and 4th -- end date\ncmd.Paramters.Append startParameter\ncmd.Parameters.Append endParameter\ncmd.Paramters.Append startParameter\ncmd.Parameters.Append endParameter\n\nDim rs As ADODB.Recordset\nSet rs = cmd.Execute\n\n'Paste the resulting data starting from A5\nWorksheets(\"Sheet2\").Range(\"A5\").CopyFromRecordset(rs)\n</code></pre>\n\n<hr>\n\n<h3>References</h3>\n\n<p>ActiveX Data Objects</p>\n\n<ul>\n<li><a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/command-object-ado?view=sql-server-2017\" rel=\"nofollow noreferrer\"><strong>Command</strong> object</a>, <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/activeconnection-property-ado?view=sql-server-2017\" rel=\"nofollow noreferrer\"><strong>ActiveConnection</strong> property</a>, <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/commandtext-property-ado?view=sql-server-2017\" rel=\"nofollow noreferrer\"><strong>CommandText</strong> property</a>, <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/createparameter-method-ado?view=sql-server-2017\" rel=\"nofollow noreferrer\"><strong>CreateParameter</strong> method</a></li>\n<li><a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/parameters-collection-ado?view=sql-server-2017\" rel=\"nofollow noreferrer\"><strong>Parameters</strong> collection</a>, <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/append-method-ado?view=sql-server-2017\" rel=\"nofollow noreferrer\"><strong>Append</strong> method</a></li>\n<li><a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/recordset-object-ado?view=sql-server-2017\" rel=\"nofollow noreferrer\"><strong>Recordset</strong> object</a></li>\n</ul>\n\n<p>Excel</p>\n\n<ul>\n<li><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheets-object-excel\" rel=\"nofollow noreferrer\"><strong>Worksheets</strong> collection</a></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-object-excel\" rel=\"nofollow noreferrer\"><strong>Worksheet</strong> object</a>, <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-range-property-excel\" rel=\"nofollow noreferrer\"><strong>Range</strong> property</a>, <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-cells-property-excel\" rel=\"nofollow noreferrer\"><strong>Cells</strong> property</a></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-object-excel\" rel=\"nofollow noreferrer\"><strong>Range</strong> object</a>, <a href=\"https://msdn.microsoft.com/library/cec7fded-f4e0-1b1c-5374-8a860828c9cc%28office.15%29.aspx\" rel=\"nofollow noreferrer\"><strong>CopyFromRecordset</strong> method</a>, <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-texttocolumns-method-excel\" rel=\"nofollow noreferrer\"><strong>TextToColumns</strong> method</a>, <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-value-property-excel\" rel=\"nofollow noreferrer\"><strong>Value</strong> property</a></li>\n</ul>\n"}], "owner": {"reputation": 81, "user_id": 2514430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6bc915bac319d8657b4cf467a15e638?s=128&d=identicon&r=PG", "display_name": "sparkynerd", "link": "https://stackoverflow.com/users/2514430/sparkynerd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2155, "favorite_count": 0, "accepted_answer_id": 51510337, "answer_count": 2, "score": 1, "last_activity_date": 1532495850, "creation_date": 1532479176, "last_edit_date": 1532491746, "question_id": 51509345, "link": "https://stackoverflow.com/questions/51509345/excel-vba-search-for-dates-and-copy-specific-cells-to-another-sheet", "title": "Excel VBA - Search for dates and copy specific cells to another sheet", "body": "<p>I have the following code which was written by a previous coworker, and I need help modifying this.</p>\n\n<p>A Userform is loaded, and a start/end date is inputted by the user. It searches Sheet 1 for dates within this start/end range, and then copies that entire row to Sheet2, and continues down Sheet1 searching for matching dates. </p>\n\n<p>I need to modify this to </p>\n\n<ol>\n<li>search <code>Sheet1</code>, Column <code>Q</code> and <code>S</code> for dates  </li>\n<li>copy <code>Sheet1</code> cells <code>C</code>, <code>G</code>, <code>J</code> and the dates <code>Q</code>, and <code>S</code> in this same row   </li>\n<li>paste to a row on <code>Sheet2</code> in columns <code>A</code>, <code>B</code>, <code>C</code>, <code>D</code> and <code>E</code>.</li>\n</ol>\n\n<p>It's over my knowledge level. Any help would be appreciated, as I can't seem to figure this code out. If you could explain how this works in simple terms, that would be equally awesome!</p>\n\n<pre><code>Dim rng As Range, destRow As Long\n    Dim shtSrc As Worksheet, shtDest As Worksheet\n    Dim c As Range '-- this is used to store the single cell in the For Each loop\n\n    Set shtSrc = Sheets(\"Sheet1\") ' Sets \"Sheet1\" sheet as source sheet\n    Set shtDest = Sheets(\"Sheet2\") 'Sets \"Sheet2.\" sheet as destination sheet\n    destRow = 5 'Start copying to this row on destination sheet\n\n' &gt;&gt; Set range to search for dates in Look Ahead period &lt;&lt;\n    Set rng = Application.Intersect(shtSrc.Range(\"P:P\"), shtSrc.UsedRange)\n\n' &gt;&gt; Look for matching dates in columns C to D &lt;&lt;\n    For Each c In rng.Cells\n        If (c.value &gt;= startDate And c.value &lt;= endDate) Or _\n    (c.Offset(0, 1).value &gt;= startDate And c.Offset(0, 1).value &lt;= endDate) Then ' Does date fall between start and end dates? If Yes, then copy to destination sheet\n\n            c.Offset(0, -2).Resize(1, 12).Copy _\n                          shtDest.Cells(destRow, 1) 'Copy a 12 cell wide block to the other sheet, paste into Column A on row destRow\n            destRow = destRow + 1\n\n' &gt; Ends search for dates &lt;\n        End If\n    Next\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1532478626, "post_id": 51509195, "comment_id": 89987575, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/39671309/vba-global-variables-no-longer-declared-after-deleting-worksheet\">VBA Global variables no longer declared after deleting worksheet</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1532478841, "post_id": 51509195, "comment_id": 89987633, "body": "A global variable, once populated, retains its value until explicitly cleared or the VB project is reset (such as by calling <code>End</code> or by an unhandled error).  It&#39;s not cleared as soon as your procedures are done running.  Involvement of forms won&#39;t change that."}, {"owner": {"reputation": 21, "user_id": 8196400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d7e0e8b00cfe6003a75d1e182ce0df2?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Ternullo", "link": "https://stackoverflow.com/users/8196400/matthew-ternullo"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1532479770, "post_id": 51509195, "comment_id": 89987788, "body": "@TimWilliams  I&#39;m still relatively new to VBA, and I am a little unclear as to what you are referring to when you say &quot;calling End&quot;. When you say calling &quot;End&quot; are you referring to the &quot;End Sub&quot; from the &quot;Main&quot; Subroutine, or just &quot;End&quot; with no conditions attached?"}, {"owner": {"reputation": 21, "user_id": 8196400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d7e0e8b00cfe6003a75d1e182ce0df2?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Ternullo", "link": "https://stackoverflow.com/users/8196400/matthew-ternullo"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1532480363, "post_id": 51509195, "comment_id": 89987941, "body": "@TimWilliams So in this case is the VB project reset? at the &quot;End Sub&quot; of the main subroutine?"}, {"owner": {"reputation": 21, "user_id": 8196400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d7e0e8b00cfe6003a75d1e182ce0df2?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Ternullo", "link": "https://stackoverflow.com/users/8196400/matthew-ternullo"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1532480945, "post_id": 51509195, "comment_id": 89988061, "body": "@Comintern I already read that post when I was researching the question and it didn&#39;t clarify my answer, I looked more thoroughly this time and it still didn&#39;t help. I&#39;m still relatively new to stack exchange and I am trying to post well formatted and thought out questions and I followed the tutorials on writing good questions while writing this. Can you give more of an explanation of what exactly qualifies as a duplicate question so I can avoid these mistakes in the future?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1532490821, "post_id": 51509195, "comment_id": 89989808, "body": "@MatthewTernullo - just <code>End</code> by itself.  See - <a href=\"https://stackoverflow.com/questions/7041138/what-is-the-lifetime-of-a-global-variable-in-excel-vba/7043901#7043901\" title=\"what is the lifetime of a global variable in excel vba\">stackoverflow.com/questions/7041138/&hellip;</a>"}, {"owner": {"reputation": 21, "user_id": 8196400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d7e0e8b00cfe6003a75d1e182ce0df2?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Ternullo", "link": "https://stackoverflow.com/users/8196400/matthew-ternullo"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1532530849, "post_id": 51509195, "comment_id": 90013012, "body": "@TimWilliams Thank you very much! I&#39;ll make sure to read the answer comments from now on when I&#39;m researching."}], "owner": {"reputation": 21, "user_id": 8196400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d7e0e8b00cfe6003a75d1e182ce0df2?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Ternullo", "link": "https://stackoverflow.com/users/8196400/matthew-ternullo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1532478731, "creation_date": 1532477563, "last_edit_date": 1532478731, "question_id": 51509195, "link": "https://stackoverflow.com/questions/51509195/in-excel-vba-are-public-variables-declared-in-a-module-cleared-from-memory-once", "title": "In Excel VBA are public variables declared in a module cleared from memory once a subroutine is completed, if a modeless form remains open?", "body": "<p>Right now I am trying to automate the building of a form that needs data collection from multiple sources. This is a question that will influence my design so no code is available for reference yet.</p>\n\n<p>General setup</p>\n\n<p>In a module \"Module1\"</p>\n\n<pre><code>Public infoArray As Variant\n\nSub Main()\n\n'info array initialized to some value here\n\n'insert various lines of code here\n\nformA.show (vbModeless)\n\nEnd Sub\n\nSub afterComments()\n\n'called by an action done in the modeless FormA\n\n'insert code that accesses infoArray() here\n\nEnd Sub\n</code></pre>\n\n<p>My question:\nIf a variable is declared as public in a module, so that it exists outside the bounds of a subroutine, and a modeless form is called before the main subroutine ends. Will the value for that variable, set in the main subroutine, be available for the \"afterComments\" subroutine to access? Since the main subroutine will continue to its end because the form is modeless, I do not know if the values for those public variables will be cleared once that happens, or remain in memory since a form is still technically active.</p>\n\n<p>(yes I realize I could probably find out quickly by running a test piece of code, but i don't have access to excel right now and I need to continue designing, also I apologize for the formating and any typos, this was written from my phone.)</p>\n\n<p>So far I've only been able to find info on modeless form implementation, public variable access rules and that public variables are cleared when the code stops running, I just don't know if this counts as the code finishing or not because while the main subroutine finishes execution, the modeless form is still active.  A simple yes or know would be sufficient, but any help would be greatly appreciated.</p>\n"}, {"tags": ["vba", "shell"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1532474275, "post_id": 51508802, "comment_id": 89986599, "body": "In VBA, just use <code>Environ(&quot;path&quot;)</code>.  No WScript or RScript necessary."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1532521396, "post_id": 51508802, "comment_id": 90006213, "body": "So your problem is that the system isn&#39;t automatically checking the path where <code>rscript.exe</code> is located, correct? Do you know what the correct location of that fie is?   (One you determine that, we can add it to the existing path.)"}, {"owner": {"reputation": 526, "user_id": 3501622, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/A0awn.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3501622/daniel"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1532521631, "post_id": 51508802, "comment_id": 90006392, "body": "I know it in my computer. But the code may be used in someone else&#39;s machine with a different version of R (which changes the path). So putting a fix path would not solve the problem."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1532522061, "post_id": 51508802, "comment_id": 90006695, "body": "You had not mentioned that there are other computers involved.  I&#39;m now confused: your question says you can run it from the command prompt but not from VBA. The first step is to get it running on yours, even if the path is hard-coded for now. Where is <code>rscript.exe</code> located on <b>your</b> computer? Once you get this working on <b>your</b> machine then we can worry about others..."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1532522296, "post_id": 51508802, "comment_id": 90006850, "body": "Based on the research I&#39;ve done, this file has greatly varying paths as there isn&#39;t a &quot;standard&quot; install location for the <code>R</code> package. I can help with code to programmatically locate the file, but I&#39;m not going to bother until the script runs properly on <i>your</i> machine with a <i>known</i> path."}, {"owner": {"reputation": 526, "user_id": 3501622, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/A0awn.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3501622/daniel"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1532522311, "post_id": 51508802, "comment_id": 90006863, "body": "The path to the Rscript is inside my System Enviroment Variables so once I call it in the <code>cmd</code> it work.If I run the same command in VBA it does not work. If I hard-code the path to Rscript it works."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1532523252, "post_id": 51508802, "comment_id": 90007514, "body": "Can you <b>please</b> <a href=\"https://stackoverflow.com/posts/51508802/edit\">edit</a> your question to add a screen shot of the command line statement that works, and a screen shot of the <code>Shell</code> statement that does not work.  I am 99% sure i know what&#39;s wrong but I can&#39;t verify without that information."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1532523869, "post_id": 51508802, "comment_id": 90007956, "body": "If you&#39;re running the <code>Shell</code> statement with <code>c:\\ </code> in it (like your example) shows, then <b>that is the problem</b> and I bet you&#39;re not doing that at the command prompt.  Specifying an absolute path <i>overrules</i> the system&#39;s <b>path</b> variable.  The command line and the <code>Shell</code> command need to be Identical!"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1532525796, "post_id": 51508802, "comment_id": 90009320, "body": "I added more example screen shots to the bottom of the answer below."}, {"owner": {"reputation": 654, "user_id": 10092563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a0cbf709786e4a23121420c2a6b000d?s=128&d=identicon&r=PG&f=1", "display_name": "iamanigeeit", "link": "https://stackoverflow.com/users/10092563/iamanigeeit"}, "edited": false, "score": 0, "creation_date": 1540179945, "post_id": 51508802, "comment_id": 92753521, "body": "I had the same issue reversed: i was seeing the correct dir in <code>ExpandEnvironmentStrings</code>, but not in <code>Environment(&quot;USER&quot;)</code>. Restarting Office worked for me."}, {"owner": {"reputation": 654, "user_id": 10092563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a0cbf709786e4a23121420c2a6b000d?s=128&d=identicon&r=PG&f=1", "display_name": "iamanigeeit", "link": "https://stackoverflow.com/users/10092563/iamanigeeit"}, "edited": false, "score": 0, "creation_date": 1540180092, "post_id": 51508802, "comment_id": 92753546, "body": "there&#39;s probably no difference, but you could also try adding the reference to Microsoft Script Host to get early binding"}], "answers": [{"comments": [{"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1532516348, "post_id": 51509362, "comment_id": 90002819, "body": "nicely covered!"}, {"owner": {"reputation": 526, "user_id": 3501622, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/A0awn.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3501622/daniel"}, "edited": false, "score": 0, "creation_date": 1532519129, "post_id": 51509362, "comment_id": 90004569, "body": "I&#39;m only using one programming language in my code which is VBA. The <b>path</b> is just to hide the actual path that would be something like &quot;C:/...&quot;. The command works fine in the command line. I&#39;ll edit the question to make it clearer"}, {"owner": {"reputation": 526, "user_id": 3501622, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/A0awn.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3501622/daniel"}, "edited": false, "score": 1, "creation_date": 1532545121, "post_id": 51509362, "comment_id": 90020521, "body": "As you can see in the pictures that I&#39;ve added to the question, I&#39;m running as I would run inside a normal CMD. The path is not wrong... The thing is that <b>the PATH variable used by the Shell does not contain all the values that are inside the System Environment PATH</b>. If I run the second part of the code with the debugs, the  <b>wshSystemEnv(&quot;PATH&quot;)</b> contains the path to the Rscript.exe and the <b>shell_obj.ExpandEnvironmentStrings(&quot;%PATH%&quot;)</b> does not."}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 2, "last_activity_date": 1532525769, "last_edit_date": 1532525769, "creation_date": 1532479306, "answer_id": 51509362, "question_id": 51508802, "link": "https://stackoverflow.com/questions/51508802/environment-variables-not-recognized-when-calling-run-in-wscript-shell-object/51509362#51509362", "title": "Environment Variables not recognized when calling Run in WScript.Shell object", "body": "<blockquote>\n  <h2><strong><em>EDIT</em></strong>: <strong>See bottom of post.</strong></h2>\n</blockquote>\n\n<p>Hopefully you'll find some use in my (lengthy) take on this... :-)</p>\n\n<hr>\n\n<h2>Testing for command-line readiness</h2>\n\n<p>Any command (<a href=\"https://stackoverflow.com/a/11598613/8112776\">including an <code>RScript</code></a>) that can be run <em>as-is</em> from the Windows command-line can <em>also</em> be run with either <a href=\"http://msdn.microsoft.com/vba/language-reference-vba/articles/shell-function\" rel=\"nofollow noreferrer\">the <em>VBA</em> <code>Shell</code> function</a> or the <a href=\"https://msdn.microsoft.com/library/windows/desktop/bb774107.aspx\" rel=\"nofollow noreferrer\">Windows <code>WScript.Shell</code> method</a>.</p>\n\n<p>The issue is, your <code>cmd</code> string is <strong>not</strong> command-line ready. This can be confirmed by hitting <kbd><img src=\"https://i.stack.imgur.com/T0oPO.png\" alt=\"Windows Key\"></kbd>+<kbd>R</kbd> and pasting the contents of your <code>cmd</code> string variable:  </p>\n\n<pre><code>Rscript \"**path**/test.R\"\n</code></pre>\n\n<p>I don't currently have <a href=\"https://stackoverflow.com/q/3412911/8112776\"><code>rscript.exe</code></a> installed but I suspect you will get an error if you try running your command manually in either the <em>Run</em> window or on the command line.  If it doesn't run there it obviously won't run with in a VBA <em>Shell</em>.</p>\n\n<p>As I understand it, the double asterisk is a <a href=\"https://stackoverflow.com/q/18722471/8112776\">Java notation</a> the way you are using it, and in <em>R</em> is the <a href=\"https://stats.stackexchange.com/q/190702/215637\">same as a <code>^</code> caret character</a>, which is for calculating exponents.</p>\n\n<hr>\n\n<h2>Referencing an environment variable</h2>\n\n<p>To return the <a href=\"https://en.wikipedia.org/wiki/PATH_(variable)#DOS,_OS/2,_and_Windows\" rel=\"nofollow noreferrer\">Windows <code>PATH</code> environment variable</a> in <em>VBA</em>, you would use <a href=\"https://msdn.microsoft.com/vba/language-reference-vba/articles/environ-function\" rel=\"nofollow noreferrer\">VBA's <code>Environ</code> function</a>. </p>\n\n<p>To insert the value environment variable <a href=\"https://en.wikipedia.org/wiki/Environment_variable#Syntax\" rel=\"nofollow noreferrer\">inline at the command line</a>, you would surround it with <code>%</code>percent<code>%</code> symbols, like <code>%path%</code></p>\n\n<hr>\n\n<h2>Windows' <code>PATH</code> environment variable</h2>\n\n<p><code>PATH</code> does not return a single folder. It's a <strong>list of folders</strong> that Windows should check to find an executable file that one attempts to run.</p>\n\n<blockquote>\n  <p><sup>When a command is entered in a command shell or a system call is made by a program to execute a program, the system first searches the current working directory and then searches the path, examining each directory from left to right, looking for an executable filename that matches the command name given.</sup></p>\n  \n  <p><sup>The Windows system directory (typically <code>C:\\WINDOWS\\system32</code>) is typically the first directory in the path, followed by many (but not all) of the directories for installed software packages.</sup></p>\n</blockquote>\n\n<p>An example a default value of <code>PATH</code> (<a href=\"https://superuser.com/a/787583/774713\">from a fresh install of Windows 7</a>) is:</p>\n\n<pre><code>%SystemRoot%\\system32;%SystemRoot%;%SystemRoot%\\System32\\Wbem\n</code></pre>\n\n<p>As with <code>%path%, this includes</code>%SystemRoot%` which, by default on Windows 7 is the string:</p>\n\n<pre><code>C:\\Windows\n</code></pre>\n\n<hr>\n\n<h2>Checking environment variables</h2>\n\n<p>You can verify the value of your <code>PATH</code> environment label:</p>\n\n<ul>\n<li>Hit <kbd><img src=\"https://i.stack.imgur.com/T0oPO.png\" alt=\"Windows Key\"></kbd>+<kbd>R</kbd>.</li>\n<li>Type <code>cmd</code> and hit <kbd>Enter</kbd>. (A command line window should open.)</li>\n<li>Type or paste <code>echo %path%</code> and hit <kbd>Enter</kbd>.</li>\n</ul>\n\n<p>The contents of the Window <code>PATH</code> environment variable will be displayed.</p>\n\n<p>You can also check environment variables from within Windows:</p>\n\n<ul>\n<li><kbd><img src=\"https://i.stack.imgur.com/T0oPO.png\" alt=\"Windows Key\"></kbd> and type <code>env</code> (to search)</li>\n<li>Click <code>Edit the system environment variables</code>. (There is a similar option <em>\"...for your account\"</em> which is not <em>quite</em> the same.)</li>\n<li>Click <sub><sub><a href=\"https://i.stack.imgur.com/a2o0U.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/a2o0U.png\" alt=\"&lt;kbd&gt;Environment Variables...&lt;/kbd&gt;\"></a></sub></sub><br>\n<a href=\"https://i.stack.imgur.com/SGAir.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SGAir.png\" alt=\"img\"></a></li>\n</ul>\n\n<blockquote>\n  <p><sup><strong>Note:</strong> Although <strong>you technically <em>can</em> change</strong> the <code>PATH</code> in this window, <strong>I would not recommend doing so</strong>, especially with <code>PATH</code> since it is split up into System and User folders, and Windows likes certain folders in certain areas, and some changes don't take effect until reboot but others do, and <em>blah blah blah</em>, trust me: it's easier to do from the command line.</sup></p>\n</blockquote>\n\n<hr>\n\n<h1><em>What's wrong with your code?</em></h1>\n\n<p>Therefore it based on all of this, it appears that the command you're trying to run is:</p>\n\n<pre><code>Rscript \"C:\\Windows\\system32;C:\\Windows;C:\\Windows\\System32\\Wbem/test.R\"\n</code></pre>\n\n<p>...which obviously <em>will not work</em>.</p>\n\n<hr>\n\n<h2>Get or set the current working folder/directory</h2>\n\n<p>I can only speculate as to <em>what you're trying to accomplish</em>.</p>\n\n<p>I suspect you didn't intend to return the entire <code>PATH</code> variable, but are only interested in the <strong><em>current working folder</em></strong>.  </p>\n\n<p>If so, <strong>you don't need to specify a folder at all</strong>.  <code>Shell</code> already commands execute in the \"current\" folder.</p>\n\n<p>One way you can check which <a href=\"https://en.wikipedia.org/wiki/Directory_(computing)#Folder_metaphor\" rel=\"nofollow noreferrer\">directory or folder</a> is current, is with the <a href=\"http://msdn.microsoft.com/vba/language-reference-vba/articles/curdir-function\" rel=\"nofollow noreferrer\">VBA <code>CurDir()</code> function</a>, like:</p>\n\n<pre><code>Debug.Print CurDir()\n</code></pre>\n\n<p>The value of <code>CurDir</code> can be changed with <a href=\"https://msdn.microsoft.com/vba/language-reference-vba/articles/chdir-statement\" rel=\"nofollow noreferrer\">the <code>ChDir</code> statement</a>.</p>\n\n<hr>\n\n<h2>Similar functions</h2>\n\n<p>Note that the <code>CurDur()</code> command is often confused with similar functions like:</p>\n\n<ul>\n<li><a href=\"http://msdn.microsoft.com/vba/excel-vba/articles/application-path-property-excel\" rel=\"nofollow noreferrer\"><code>Application.Path</code></a> which returns the path to the Excel application, or,  </li>\n<li><a href=\"http://msdn.microsoft.com/vba/excel-vba/articles/application-activeworkbook-property-excel\" rel=\"nofollow noreferrer\"><code>ActiveWorkbook.Path</code></a> which returns the location that the active workbook is saved (or an empty string if it's unsaved). </li>\n</ul>\n\n<hr>\n\n<h1>Possible Solution: <sub><sup><em>(How to run an <code>rScript</code> in the current path in VBA)</em></sup></sub></h1>\n\n<ul>\n<li><p>If your <em>R</em> script and the <code>rscript.exe</code> are <em>both</em> in the current working folder, run it with just one line of VBA:  </p>\n\n<pre><code>Shell \"rscript.exe test.R\", vbNormalFocus\n</code></pre></li>\n<li><p>If you require VBA to <strong>wait</strong> for execution of the Shell command to complete before resuming VBA, then you can you just this one line:  </p>\n\n<pre><code>CreateObject(\"WScript.Shell\").Run \"rscript.exe test.R\", vbNormalFocus, True\n</code></pre></li>\n</ul>\n\n<hr>\n\n<h2>More Information:</h2>\n\n<p><sup>I generally make a point of including links to any sites I used to verify my answers, so this must be my <em>most-researched answer yet</em> because I've never had a list this long... and I left some off out this time!</sup>  </p>\n\n<ul>\n<li>Stack Overflow : <a href=\"https://stackoverflow.com/a/11598613/8112776\"><strong>Running <em>R</em> scripts from <em>VBA</em></strong></a>  </li>\n<li>MSDN : <a href=\"http://msdn.microsoft.com/vba/language-reference-vba/articles/shell-function\" rel=\"nofollow noreferrer\"><strong><code>Shell</code> Function</strong> (VBA)</a>  </li>\n<li>MSDN : <a href=\"https://msdn.microsoft.com/vba/language-reference-vba/articles/environ-function\" rel=\"nofollow noreferrer\"><strong><code>Environ</code> Function</strong> (VBA)</a>  </li>\n<li><em>R</em>-Bloggers : <a href=\"https://www.r-bloggers.com/passing-arguments-to-an-r-script-from-command-lines/\" rel=\"nofollow noreferrer\"><strong>Passing arguments to an <em>R</em> script from command lines</strong></a>   </li>\n<li>Stack Overflow : <a href=\"https://stackoverflow.com/q/3412911/8112776\"><strong><code>R.exe</code>, <code>Rcmd.exe</code>, <code>Rscript.exe</code> and <code>Rterm.exe</code></strong>: what's the difference?</a>  </li>\n<li>Stack Exchange: Statistics : <a href=\"https://stats.stackexchange.com/q/190702/215637\"><strong>Double star ** in <em>R</em>?</strong></a>  </li>\n<li>Wikipedia : <a href=\"https://en.wikipedia.org/wiki/PATH_(variable)#DOS,_OS/2,_and_Windows\" rel=\"nofollow noreferrer\"><strong>PATH</strong> (variable)</a>  </li>\n<li>Stack Overflow : <a href=\"https://stackoverflow.com/a/45072976/8112776\"><strong>Default values of <code>PATH</code> variable in Windows 10</strong></a>  </li>\n<li>SuperUser : <a href=\"https://superuser.com/a/787583/774713\"><strong>Default <code>PATH</code> for Windows 7</strong></a>  </li>\n<li>MSDN : <a href=\"http://msdn.microsoft.com/vba/language-reference-vba/articles/curdir-function\" rel=\"nofollow noreferrer\"><strong><code>CurDir()</code> Function</strong> (VBA)</a>  </li>\n<li>MSDN : <a href=\"https://msdn.microsoft.com/vba/language-reference-vba/articles/chdir-statement\" rel=\"nofollow noreferrer\"><strong><code>ChDir()</code> Statement</strong> (VBA)</a>  </li>\n<li>MSDN : <a href=\"http://msdn.microsoft.com/vba/excel-vba/articles/application-path-property-excel\" rel=\"nofollow noreferrer\"><strong><code>Application.Path</code></strong> (Excel/VBA)</a>   </li>\n<li>MSDN : <a href=\"http://msdn.microsoft.com/vba/excel-vba/articles/application-activeworkbook-property-excel\" rel=\"nofollow noreferrer\"><strong><code>ActiveWorkbook.Path</code></strong> (Excel/VBA)</a>   </li>\n<li>Stack Overflow : <a href=\"https://stackoverflow.com/a/15952009/8112776\"><strong>Wait for <code>Shell</code> command to complete</strong></a>  </li>\n<li>MSDN Forums : <a href=\"http://social.msdn.microsoft.com/Forums/en-US/1c348b77-18a8-4956-8561-fd97d4585cd3/?forum=scripting\" rel=\"nofollow noreferrer\"><strong>Difference between <code>wscript.shell</code> and <code>shell.application</code></strong></a></li>\n<li>Stack Overflow : <a href=\"https://stackoverflow.com/a/38456622/8112776\"><strong>Steps to run R script through Windows command prompt</strong></a></li>\n</ul>\n\n<hr>\n\n<hr>\n\n<blockquote>\n  <h1>One More Demo of What's Wrong With Your Code:</h1>\n  \n  <blockquote>\n    <p>I have a batch file named <code>test.bat</code> located in <code>C:\\WINDOWS</code>.  My <code>PATH</code> environment variable contains <code>C:\\WINDOWS</code> (among other things).</p>\n  </blockquote>\n  \n  <p>If I go to the command prompt in root folder <code>C:\\</code> and type <code>test.bat</code>:</p>\n  \n  <p><a href=\"https://i.stack.imgur.com/zyjLW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zyjLW.png\" alt=\"img1\"></a></p>\n  \n  <p>...it runs properly (even though my file is not in that folder... since the <code>c:\\windows</code> folder is within the <code>PATH</code> variable.)</p>\n  \n  <hr>\n  \n  <p><strong><em>However</em></strong>, if I go to the command prompt  and type <code>C:\\test.bat</code>:</p>\n  \n  <p><a href=\"https://i.stack.imgur.com/KU0iy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KU0iy.png\" alt=\"img2\"></a></p>\n  \n  <p>...it does <strong>not</strong> work. It cannot find the file <strong>because I <em>specified</em> a folder where the file is <em>not</em> located</strong>.</p>\n  \n  <p>--- In VBA, if I run the command <code>Shell \"test.bat\",1</code>:</p>\n  \n  <p><a href=\"https://i.stack.imgur.com/JR3HX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JR3HX.png\" alt=\"img3\"></a></p>\n  \n  <p>...it runs properly (even though my file is not in that folder... since the <code>c:\\windows</code> folder is within the <code>PATH</code> variable.)</p>\n  \n  <hr>\n  \n  <p><strong><em>However</em></strong>, if in VBA I run the command <code>Shell \"c:\\test.bat\",1</code>:</p>\n  \n  <p><a href=\"https://i.stack.imgur.com/2But4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2But4.png\" alt=\"img4\"></a></p>\n  \n  <p>...it does <strong>not</strong> work. It cannot find the file <strong>because I</strong>specified* a folder where the file is <em>not</em> located**.</p>\n  \n  <hr>\n  \n  <blockquote>\n    <p>Both VBA and the <code>Shell</code> command are <strong>behaving the <em>same way</em></strong>, when given the <em>same information</em>.</p>\n  </blockquote>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 5790580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b14e275f1775c375bae93e1e461ecc1?s=128&d=identicon&r=PG&f=1", "display_name": "scottyc", "link": "https://stackoverflow.com/users/5790580/scottyc"}, "is_accepted": false, "score": 0, "last_activity_date": 1564410371, "creation_date": 1564410371, "answer_id": 57255877, "question_id": 51508802, "link": "https://stackoverflow.com/questions/51508802/environment-variables-not-recognized-when-calling-run-in-wscript-shell-object/57255877#57255877", "title": "Environment Variables not recognized when calling Run in WScript.Shell object", "body": "<p>If you have recently modified the system PATH variable, you must restart the Office application you are running VBA from. VBA sends WScript the path variable and only rereads it on a restart. On restart, it will reread the PATH variable from the system and send the new correct path to WScript.</p>\n\n<p>I had the same issue. I had updated the system PATH variable, but the WScript.Shell object was being passed the path variable from Excel rather than reading from the system. Excel had read the path at startup and was not aware it had changed. Once I closed Excel and reopened, WScript had the updated path variable and my script execute successfully.</p>\n"}], "owner": {"reputation": 526, "user_id": 3501622, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/A0awn.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3501622/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2057, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1564410371, "creation_date": 1532473913, "last_edit_date": 1532544713, "question_id": 51508802, "link": "https://stackoverflow.com/questions/51508802/environment-variables-not-recognized-when-calling-run-in-wscript-shell-object", "title": "Environment Variables not recognized when calling Run in WScript.Shell object", "body": "<p>If I run the command <code>Rscript \"C:/TEMP/test.R\"</code> in the command line it works and my script runs as expected. Once I try to run it in my VBA code it does not recognize the Rscript as a valid command.</p>\n\n<pre><code>Dim shell_obj As Object\nSet shell_obj = VBA.CreateObject(\"WScript.Shell\")\nDim errorCode As Integer\nerrorCode = shell_obj.Run(\"Rscript \"\"C:/TEMP/test.R\"\"\", 1, True)\n</code></pre>\n\n<p>When I looked into the PATH variable being used by the WScript.Shell I saw that it does not include the System Variables with the Rscript path inside of it.</p>\n\n<pre><code>Dim shell_obj As Object\nDim wshSystemEnv As Object\nSet shell_obj = VBA.CreateObject(\"WScript.Shell\")\n\n' This one does not include the path to the Rscript'\nDebug.Print shell_obj.ExpandEnvironmentStrings(\"%PATH%\")\nSet wshSystemEnv = shell_obj.Environment(\"SYSTEM\")\n' This one includes the path to the Rscript'\nDebug.Print wshSystemEnv(\"PATH\")\n</code></pre>\n\n<p>Can I force the the WScript.Shell object to use the System environment? Or at least use its variables?</p>\n\n<p>Cmd:\n<a href=\"https://i.stack.imgur.com/5Ba4B.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5Ba4B.png\" alt=\"enter image description here\"></a></p>\n\n<p>VBA (version 1):</p>\n\n<p><a href=\"https://i.stack.imgur.com/e5Fr6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/e5Fr6.png\" alt=\"enter image description here\"></a></p>\n\n<p>VBA (version 2):</p>\n\n<p><a href=\"https://i.stack.imgur.com/9eaGv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9eaGv.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1532476049, "post_id": 51508757, "comment_id": 89987032, "body": "Rename the second <code>Sub</code> to something else, then just call if from the end of the first one."}, {"owner": {"reputation": 13, "user_id": 9893541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0dc5ea310a481e1bb6c55d688772c8a?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Guest", "link": "https://stackoverflow.com/users/9893541/mike-guest"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1532536580, "post_id": 51508757, "comment_id": 90016391, "body": "Thanks for your response. I used the next answer and it worked but thank-you for your time."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9893541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0dc5ea310a481e1bb6c55d688772c8a?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Guest", "link": "https://stackoverflow.com/users/9893541/mike-guest"}, "edited": false, "score": 0, "creation_date": 1532536669, "post_id": 51510376, "comment_id": 90016436, "body": "I tried it and it worked just like you said!!! I have a lot to learn on this stuff and so it really helps when people like you take the time and provide that assistance. @lbo"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 13, "user_id": 9893541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0dc5ea310a481e1bb6c55d688772c8a?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Guest", "link": "https://stackoverflow.com/users/9893541/mike-guest"}, "edited": false, "score": 0, "creation_date": 1532538362, "post_id": 51510376, "comment_id": 90017317, "body": "good to hear that! please hit the checkmark (upper left to the answer) to select it as the right answer, also you can upvote it."}], "tags": [], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "is_accepted": true, "score": 0, "last_activity_date": 1532489319, "creation_date": 1532489319, "answer_id": 51510376, "question_id": 51508757, "link": "https://stackoverflow.com/questions/51508757/trying-to-combine-two-vba-programs-together/51510376#51510376", "title": "Trying to combine two VBA programs together", "body": "<p>I am not sure what exactly you want to do, but to do multiple things it is better to break it down into smaller subroutines or functions, for example, you should do this. To run both you need to call the <code>sub main</code>. Remember you cannot have duplicate sub or function names:</p>\n\n<pre><code>    Sub main()\n\n        Call FirstCode\n        Call SecondCode\n\n    End Sub\n\n\n    Sub FirstCode()\n        n = [E15]\n        Set reg = CreateObject(\"VBScript.RegExp\")\n        reg.Pattern = \"^[0-9]*\\-[0-9]*$\"\n        reg.Global = True\n        For Each cell In Range(\"A15:A30,C15:C30,E15:E30,G15:G30,I15:I30\")\n        StrVal = cell.Offset(0, 1).Value\n        If cell.Value = n And reg.test(StrVal) Then\n        Range(\u201cE15\u201d).Value = StrVal\n        MsgBox \"Found a postivive result in \" &amp; cell.Address\n        End If\n\n        Next\n    End Sub\n\n    Sub SecondCode()\n         Dim n, sht As Worksheet, cell As Range, num, tmp, rngDest As Range\n\n        Set sht = ActiveSheet\n\n        n = sht.Range(\"E15\")\n\n        For Each cell In sht.Range(\"A15:A30,C15:C30,E15:E30,G15:G30,I15:I3 0\").Cells\n\n        tmp = cell.Offset(0, 1).Value\n\n        If cell.Value = n And tmp Like \"*#-#*\" Then\n\n        'get the first number\n        num = CLng(Trim(Split(tmp, \"-\")(0)))\n        Debug.Print \"Found a positive result in \" &amp; cell.Address\n\n        'find the next empty cell in the appropriate row\n        Set rngDest = sht.Cells(num, sht.Columns.Count).End(xlToLeft).Offset(0, 1)\n         'make sure not to add before col K\n         If rngDest.Column &lt; 12 Then Set rngDest = sht.Cells(num, 12)\n\n        cell.Offset(0, 1).Copy rngDest\n        Exit For\n\n        End If\n        Next\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9893541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0dc5ea310a481e1bb6c55d688772c8a?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Guest", "link": "https://stackoverflow.com/users/9893541/mike-guest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 51510376, "answer_count": 1, "score": 0, "last_activity_date": 1532489319, "creation_date": 1532473668, "last_edit_date": 1532475989, "question_id": 51508757, "link": "https://stackoverflow.com/questions/51508757/trying-to-combine-two-vba-programs-together", "title": "Trying to combine two VBA programs together", "body": "<p>I have two programs for the same Excel spreadsheet and would like to combine them into one program but I just can't seem to get that to work. If anyone could assist it sure would be appreciated. What I have tried is to take the out the Sub do_it() at the second program and the End Sub out of the first program. I have included everything here so you can see both complete programs.</p>\n\n<pre><code>Sub do_it()\n\n\n    n = [E15]\n    Set reg = CreateObject(\"VBScript.RegExp\")\n    reg.Pattern = \"^[0-9]*\\-[0-9]*$\"\n    reg.Global = True\n    For Each cell In      Range(\"A15:A30,C15:C30,E15:E30,G15:G30,I15:I30\")\n    strVAL = cell.Offset(0, 1).Value\n    If cell.Value = n And reg.test(strVAL) Then\n    Range(\u201cE15\u201d).Value = StrVal\n    MsgBox \"Found a postivive result in \" &amp;   cell.Address\n    End If\n\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>-</p>\n\n<pre><code>Sub do_it()\n\n    Dim n, sht As Worksheet, cell As Range, num,          tmp, rngDest As Range\n\n    Set sht = ActiveSheet\n\n    n = sht.Range(\"E15\")\n\n    For Each cell In    sht.Range(\"A15:A30,C15:C30,E15:E30,G15:G30,I15:I3 0\").Cells\n\n    tmp = cell.Offset(0, 1).Value\n\n    If cell.Value = n And tmp Like \"*#-#*\" Then\n\n    'get the first number\n    num = CLng(Trim(Split(tmp, \"-\")(0)))\n    Debug.Print \"Found a positive result in \" &amp;    cell.Address\n\n'find the next empty cell in the appropriate row\n    Set rngDest = sht.Cells(num,    sht.Columns.Count).End(xlToLeft).Offset(0, 1)\n'make sure not to add before col K\n     If rngDest.Column &lt; 12 Then Set rngDest =   sht.Cells(num, 12)\n\n    cell.Offset(0, 1).Copy rngDest\n    Exit For\n\n    End If\n    Next\nEnd Sub \n</code></pre>\n"}, {"tags": ["vba", "excel", "outlook"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1532473000, "post_id": 51508464, "comment_id": 89986279, "body": "Excel and Outlook both run under the logged in user account. How are you running one as UserA and another as UserB in the same user session?"}, {"owner": {"reputation": 31, "user_id": 9145743, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NSMyA4an37k/AAAAAAAAAAI/AAAAAAAAAAo/WLsKz1MjjUM/photo.jpg?sz=128", "display_name": "Lava Viperidae", "link": "https://stackoverflow.com/users/9145743/lava-viperidae"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1532478387, "post_id": 51508464, "comment_id": 89987528, "body": "Right Click &gt; Run As"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1532478940, "post_id": 51508464, "comment_id": 89987652, "body": "You can&#39;t work across privilege levels, mixing a normal user account and an administrator account. You shouldn&#39;t need to do what you&#39;re trying to do, which makes me think you&#39;re trying to solve an XY problem."}, {"owner": {"reputation": 31, "user_id": 9145743, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NSMyA4an37k/AAAAAAAAAAI/AAAAAAAAAAo/WLsKz1MjjUM/photo.jpg?sz=128", "display_name": "Lava Viperidae", "link": "https://stackoverflow.com/users/9145743/lava-viperidae"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1532479237, "post_id": 51508464, "comment_id": 89987707, "body": "Not different privilege levels, just different users.  Thanks for the comment, but the need is as stated."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1532479333, "post_id": 51508464, "comment_id": 89987721, "body": "If you&#39;re running as a normal user, and you right click and choose <i>Run as Administrator</i>, you&#39;re running at different privilege levels. And you&#39;re still trying to solve an XY problem; there are proper ways to work with shared calendars in Office applications without doing it the way you&#39;re attempting,"}, {"owner": {"reputation": 31, "user_id": 9145743, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NSMyA4an37k/AAAAAAAAAAI/AAAAAAAAAAo/WLsKz1MjjUM/photo.jpg?sz=128", "display_name": "Lava Viperidae", "link": "https://stackoverflow.com/users/9145743/lava-viperidae"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1532479585, "post_id": 51508464, "comment_id": 89987754, "body": "Never said was running as admin... Just run as different user, both have same privileges. The odd and cumbersome integration of applications that requires this is more than needed to discuss here. I just need Excel running as user A to pull in a calendar from Outlook running as user B."}], "owner": {"reputation": 31, "user_id": 9145743, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NSMyA4an37k/AAAAAAAAAAI/AAAAAAAAAAo/WLsKz1MjjUM/photo.jpg?sz=128", "display_name": "Lava Viperidae", "link": "https://stackoverflow.com/users/9145743/lava-viperidae"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1532471723, "creation_date": 1532471723, "question_id": 51508464, "link": "https://stackoverflow.com/questions/51508464/excel-vba-to-get-outlook-calendar-when-excel-and-outlook-are-running-as-differen", "title": "Excel VBA to Get Outlook Calendar when Excel and Outlook are running as different users", "body": "<ol>\n<li>Excel running as UserA</li>\n<li>Outlook running as UserB</li>\n<li>Need VBA to access UserB calendar within Excel (which is running as UserA)</li>\n</ol>\n\n<p>I'm missing something here, as when I use the code below, it returns that Outlook is not running, even though Outlook is running, just not as the same user as Excel. Not sure how to access the session running as a different user.</p>\n\n<pre><code>Public Sub Test()\nDim oOutLook As Object\nOn Error Resume Next\nSet oOutLook = GetObject(, \"Outlook.application\")\nIf Not oOutLook Is Nothing Then\n    MsgBox \"Outlook is running\"\nElse\n    MsgBox \"Outlook is not running\"\nEnd If\nOn Error GoTo 0\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "owner": {"reputation": 11, "user_id": 10130147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/425173c29c5e2e04fb7f6b05ce04896a?s=128&d=identicon&r=PG&f=1", "display_name": "Pat", "link": "https://stackoverflow.com/users/10130147/pat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1532469845, "creation_date": 1532469845, "question_id": 51508161, "link": "https://stackoverflow.com/questions/51508161/excel-vba-populate-avery-templates", "title": "Excel VBA - Populate Avery Templates", "body": "<p>looking for some collective brainstorming here, as this will most likely require multiple procedures to accomplish what I envision as the correct approach: </p>\n\n<p>I have the sheet pictures below called \u201cData\u201d that is populated from a data input sheet named \u201cEntry\u201d.</p>\n\n<p><a href=\"https://i.stack.imgur.com/QQwJF.png\" rel=\"nofollow noreferrer\">Sheets(\"Data\")</a></p>\n\n<p>Note: The reason the Headers &amp; subsequent data \u201cName/Age/Sex\u201d span over multiple columns (and are merged) is due to the fact of a complex (ie. poor) design layout of the \u201cEntry\u201d page that I have been directed not to alter\u2026</p>\n\n<p>I have the following VBA procedure on a CommandButton that copies the User_Data range from Sheets(\u201cEntry\u201d) to Sheets(Data)</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nWorksheets(\"Entry\").Range(\"User_Data\").Copy \nDestination:=Sheets(\"Data\").Range(\"A2\")\nEnd Sub\n</code></pre>\n\n<p>The end goal here is to populate the information stored in Sheets(\u201cData\u201d) into a third sheet \u2013 Sheets(\u201cLabels\u201d).</p>\n\n<p><a href=\"https://i.stack.imgur.com/XIFex.png\" rel=\"nofollow noreferrer\">Sheets(\"Labels\")</a></p>\n\n<p>This sheet is set up to mimic the dimension of an Avery Label/Sticker Template \u2013 4 stickers per 8.5\u201dx11\u201d page.</p>\n\n<p>I have linked the first Labels data imported via referencing formulas:</p>\n\n<pre><code>C6 (Number): ='Data'!A2\nC10 (Name):  = \u2018Data'!B2\nC14 (Age):   = \u2018Data'!M2\nC18 (Sex):   = \u2018Data'!O2\n</code></pre>\n\n<p>How can I use VBA code to create multiple pages of Labels (ie. Copy/Paste/InsertBelow Ranges(\u201cA1:H41\u201d) and auto-populate the User_Data found in  Sheets(\u201cData\u201d) onto the Labels as required to match however many entries there may be stored within Sheets(\u201cData\u201d).  </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1532468999, "post_id": 51507993, "comment_id": 89985121, "body": "Do you know what line the error is occurring on?"}, {"owner": {"reputation": 21, "user_id": 6248198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86c176ec3445fbffc3429da604078892?s=128&d=identicon&r=PG&f=1", "display_name": "orjansj", "link": "https://stackoverflow.com/users/6248198/orjansj"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1532682141, "post_id": 51507993, "comment_id": 90075722, "body": "No, but i seem to be an issue with estimating the length of the table:"}, {"owner": {"reputation": 21, "user_id": 6248198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86c176ec3445fbffc3429da604078892?s=128&d=identicon&r=PG&f=1", "display_name": "orjansj", "link": "https://stackoverflow.com/users/6248198/orjansj"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1532682233, "post_id": 51507993, "comment_id": 90075772, "body": "I run this script as part of a loop in sheet2, which also might be the problem. The loop is as follows:"}, {"owner": {"reputation": 21, "user_id": 6248198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86c176ec3445fbffc3429da604078892?s=128&d=identicon&r=PG&f=1", "display_name": "orjansj", "link": "https://stackoverflow.com/users/6248198/orjansj"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1532682367, "post_id": 51507993, "comment_id": 90075850, "body": "Dim sh1 As Worksheet, sh2 As Worksheet, lr As Long, fn As Range, sr As Range, rng As Range, n As Long Set sh1 = Me &#39;Edit sheet name Set sh2 = Ark13 &#39;Edit sheet name lr = sh1.Cells(Rows.Count, 5).End(xlUp).Row"}, {"owner": {"reputation": 21, "user_id": 6248198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86c176ec3445fbffc3429da604078892?s=128&d=identicon&r=PG&f=1", "display_name": "orjansj", "link": "https://stackoverflow.com/users/6248198/orjansj"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1532682385, "post_id": 51507993, "comment_id": 90075860, "body": "For i = 2 To lr Step 1                  Set fn = sh2.Range(&quot;E:E&quot;).Find(sh1.Cells(i, 5).Value, , xlValues, xlWhole)             If Not fn Is Nothing Then                 Set sr = fn.Offset(0, 1)                     Set er = sr.End(xlDown)                     Set rng = sr                 n = rng.Rows.Count                 rng.EntireRow.Copy                 sh1.Cells(i, 1).Resize(n).EntireRow.Insert            Call fagrekke_dato2             End If    Ark1.Range(&quot;D33:F35&quot;).Copy Cells(2, 4).PasteSpecial xlPasteValues     Next"}], "owner": {"reputation": 21, "user_id": 6248198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86c176ec3445fbffc3429da604078892?s=128&d=identicon&r=PG&f=1", "display_name": "orjansj", "link": "https://stackoverflow.com/users/6248198/orjansj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1532726514, "creation_date": 1532468882, "last_edit_date": 1532726514, "question_id": 51507993, "link": "https://stackoverflow.com/questions/51507993/power-query-and-vba", "title": "Power Query and VBA", "body": "<p>I am new at this but work with a bigger project to learn <code>VBA</code>, but now I am stuck. Any help will be greatly appreciated.</p>\n\n<p>In <code>sheet1</code> I run a macro that calls another macro in <code>sheet2</code>, which again runs a module. When I create a table in <code>sheet2</code>, to use Power query in my workbook, the macros do not work anymore. I get the following message:</p>\n\n<blockquote>\n  <p>\"Run-time error '1004': Application-defined or object-defined error.\"</p>\n</blockquote>\n\n<p>By removing bits and pieces of the macros, I found that the problem seems to be the module. In this module I have written as follows (I am open for a shorter way of writing this, but I'm new at this):</p>\n\n<pre><code>Sub fagrekke_dato2()\n\n\nIf Ark1.[E8].Value = 1 Then\nCall DateFiller_endd1\nCall DateFiller_startt1\nCall DateFiller_endt1\nEnd If\n\nIf Ark1.[E8].Value = 2 Then\nCall DateFiller_endd1\nCall DateFiller_startt1\nCall DateFiller_endt1\nCall DateFiller_endd2\nCall DateFiller_startt2\nCall DateFiller_endt2\nEnd If\n\nIf Ark1.[E8].Value = 3 Then\nCall DateFiller_endd1\nCall DateFiller_startt1\nCall DateFiller_endt1\nCall DateFiller_endd2\nCall DateFiller_startt2\nCall DateFiller_endt2\nCall DateFiller_endd3\nCall DateFiller_startt3\nCall DateFiller_endt3\nEnd If\n\nRange(\"E2:E200\").Copy Destination:=Range(\"B2\") 'forbedre?\n\n\n\nEnd Sub\n\nSub DateFiller_endd1()\n\nDim k, l As Date\nl = Cells(2, 5).Value\nFor k = 2 To Rows.Count Step Ark1.[E8].Value\nCells(k, 5).Value = l\nl = l + 7\nIf Cells(k, 5).Value + 6 &gt; Ark1.Cells(3, 4).Value Then Exit Sub\nNext k\nEnd Sub\n\nSub DateFiller_endt1()\n\nDim o, p As Date\np = Cells(2, 6).Value\nFor o = 2 To Rows.Count Step Ark1.[E8].Value\nCells(o, 6).Value = p\nIf Cells(o, 5).Value + 6 &gt; Ark1.Cells(3, 4).Value Then Exit Sub\nNext o\nEnd Sub\n\nSub DateFiller_startt1()\n\nDim i, j As Date\nj = Cells(2, 4).Value\nFor i = 2 To Rows.Count Step Ark1.[E8].Value\nCells(i, 4).Value = j\nIf Cells(i, 5).Value + 6 &gt; Ark1.Cells(3, 4).Value Then Exit Sub\nNext i\nEnd Sub\n\n\nSub DateFiller_startt2()\n\nDim i, j As Date\nj = Cells(3, 4).Value\nFor i = 3 To Rows.Count Step Ark1.[E8].Value\nCells(i, 4).Value = j\nIf Cells(i, 5).Value + 6 &gt; Ark1.Cells(3, 4).Value Then Exit Sub\nNext i\nEnd Sub\n\n\nSub DateFiller_endd2()\n\nDim k, l As Date\nl = Cells(3, 5).Value\nFor k = 3 To Rows.Count Step Ark1.[E8].Value\nCells(k, 5).Value = l\nl = l + 7\nIf Cells(k, 5).Value + 6 &gt; Ark1.Cells(3, 4).Value Then Exit Sub\nNext k\nEnd Sub\n\nSub DateFiller_endt2()\n\nDim o, p As Date\np = Cells(3, 6).Value\nFor o = 3 To Rows.Count Step Ark1.[E8].Value\nCells(o, 6).Value = p\nIf Cells(o, 5).Value + 6 &gt; Ark1.Cells(3, 4).Value Then Exit Sub\nNext o\nEnd Sub\nSub DateFiller_startt3()\n\nDim i, j As Date\nj = Cells(4, 4).Value\nFor i = 4 To Rows.Count Step Ark1.[E8].Value\nCells(i, 4).Value = j\nIf Cells(i, 5).Value + 6 &gt; Ark1.Cells(3, 4).Value Then Exit Sub\nNext i\nEnd Sub\n\n\nSub DateFiller_endd3()\n\nDim k, l As Date\nl = Cells(4, 5).Value\nFor k = 4 To Rows.Count Step Ark1.[E8].Value\nCells(k, 5).Value = l\nl = l + 7\nIf Cells(k, 5).Value + 6 &gt; Ark1.Cells(3, 4).Value Then Exit Sub\nNext k\nEnd Sub\n\nSub DateFiller_endt3()\n\nDim o, p As Date\np = Cells(4, 6).Value\nFor o = 4 To Rows.Count Step Ark1.[E8].Value\nCells(o, 6).Value = p\nIf Cells(o, 5).Value + 6 &gt; Ark1.Cells(3, 4).Value Then Exit Sub\nNext o\nEnd Sub\n</code></pre>\n\n<p>The point of this module is to estimate the date and time for events that happen from one to three times a week. I do believe the problem is that the table does not manage to define its length. </p>\n\n<p>I may add that i use this module in a loop, where I check if there are any holidays or activities that conflict with the plan. If so the plan for all dates are updated:</p>\n\n<pre><code>Dim sh1 As Worksheet, sh2 As Worksheet, lr As Long, fn As Range, sr As Range, rng As Range, n As Long\nSet sh1 = Me \nSet sh2 = Ark13 \nlr = sh1.Cells(Rows.Count, 5).End(xlUp).Row\nFor i = 2 To lr Step 1\n\nSet fn = sh2.Range(\"E:E\").Find(sh1.Cells(i, 5).Value, , xlValues, xlWhole)\nIf Not fn Is Nothing Then\nSet sr = fn.Offset(0, 1)                    \nSet er = sr.End(xlDown)\nSet rng = sr\nn = rng.Rows.Count\nrng.EntireRow.Copy\nsh1.Cells(i, 1).Resize(n).EntireRow.Insert\nCall fagrekke_dato2\nEnd If\nArk1.Range(\"D27:F29\").Copy\nCells(2, 4).PasteSpecial xlPasteValues\nNext\n</code></pre>\n\n<p>Do anybody know why creating a table in sheet2 end up beeing a problem?</p>\n"}, {"tags": ["vba", "sorting", "outlook", "filtering"], "answers": [{"comments": [{"owner": {"reputation": 40, "user_id": 10090746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/454966945bb92891ef27e38776f6d0f2?s=128&d=identicon&r=PG&f=1", "display_name": "Rossle", "link": "https://stackoverflow.com/users/10090746/rossle"}, "edited": false, "score": 0, "creation_date": 1532470037, "post_id": 51508077, "comment_id": 89985418, "body": "Great, thanks for the suggestions. I&#39;m out the door now but I&#39;ll look into how I can implement these tomorrow."}, {"owner": {"reputation": 40, "user_id": 10090746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/454966945bb92891ef27e38776f6d0f2?s=128&d=identicon&r=PG&f=1", "display_name": "Rossle", "link": "https://stackoverflow.com/users/10090746/rossle"}, "edited": false, "score": 0, "creation_date": 1532642688, "post_id": 51508077, "comment_id": 90063990, "body": "Thanks for the suggestions. I tried using the  items.restric method. It works almost perfect, but the filter keeps missing certain email addresses. I can type in the exact email, and I know it&#39;s searching the correct folders, but the filter shows zero matches. Any idea why it may miss those? I edited in my new code above/."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1532469389, "creation_date": 1532469389, "answer_id": 51508077, "question_id": 51507750, "link": "https://stackoverflow.com/questions/51507750/how-to-make-outlook-email-filtering-more-efficient-vba/51508077#51508077", "title": "How to Make Outlook Email Filtering More Efficient (VBA)", "body": "<p>Never loop through all items in a folder, use <code>Items.Find/FindNext</code> or <code>Items.Res</code>trict.</p>\n\n<p>Create a restriction on <code>PR_SENT_REPRESENTING_EMAIL_ADDRESS</code> (DASL name <code>http://schemas.microsoft.com/mapi/proptag/0x0065001F</code>) - that will cover the \"SMTP\" senders - and on <code>PidTagSenderSmtpAddress</code> (DASL name <code>http://schemas.microsoft.com/mapi/proptag/0x5D01001F</code>) - that will be for the EX senders.</p>\n"}], "owner": {"reputation": 40, "user_id": 10090746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/454966945bb92891ef27e38776f6d0f2?s=128&d=identicon&r=PG&f=1", "display_name": "Rossle", "link": "https://stackoverflow.com/users/10090746/rossle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532642627, "creation_date": 1532467492, "last_edit_date": 1532642627, "question_id": 51507750, "link": "https://stackoverflow.com/questions/51507750/how-to-make-outlook-email-filtering-more-efficient-vba", "title": "How to Make Outlook Email Filtering More Efficient (VBA)", "body": "<p>Sorry for the long post, I'm still a self taught amateur: but my project is to automate some tasks during which I can filter outlook mails potentially by Sender, and subject, and send them to specific folders. (For certain reasons I can't use the built in Outlook filter). The code below works fine, but some of the boxes the macro accesses are located on a server in another country, so some of the actions take a long time. Essentially, my code loops through a list of email addresses to filter out, and potential subject lines. It goes through every single email, compares sender name and subject, then determines which folder to send it to, and moves it. </p>\n\n<p>My question is how can I make this more efficient, by either using more clever code, or reducing total number of actions? Is there a more efficient way to search through all of the emails rather than 1 by 1? Instead of moving 1 by 1, is it possible to move them all in blocks? I'd be so appreciative if someone could help. My code is below (I realize there are some unneccesary lines but I use some of this for multiple projects). Thanks so much!</p>\n\n<pre><code>Const olFolderInbox As Integer = 6\nOption Compare Text\nSub Filter()\n    Dim outlookApp As Outlook.Application, oOutlook As Object\n    Dim oInbox As Outlook.Folder, oMail As Outlook.MailItem\n    Dim i, j As Integer\n    Dim strAddress As String, strEntryId As String, getSmtpMailAddress As String\n    Dim objAddressentry As Outlook.AddressEntry, objExchangeUser As Outlook.ExchangeUser\n    Dim objReply As Outlook.MailItem, objRecipient As Outlook.Recipient\n    Dim oAccount As Outlook.Account\n    Dim oOlAp As Object, oOlns As Object, oOlInb As Object\n    Dim oOlItm As Object\n    Dim Br, Spec As Folder\n    Dim oOlAtch As Object\n    Dim eSender As String, dtRecvd As String, dtSent As String, o0Acct1 As String, o0Acct2 As String\n    Dim sSubj As String, sMsg As String\n    Dim wb As Workbook, wb2 As Workbook\n    Dim fso As FileSystemObject\n    Dim FName, NewFileName As String\n    Dim sn, Subject, F, F2, SF, SF2, SFF, SFF2, From, SJ As String\n\n    'Set objects\n'=============================\n    Set outlookApp = New Outlook.Application\n    Set oOutlook = outlookApp.GetNamespace(\"MAPI\")\n    Set oInbox = oOutlook.GetDefaultFolder(olFolderInbox)\n    '~~&gt; Get Outlook instance\n\n    Set myNS = GetNamespace(\"MAPI\")\n\n    i = 0\n\n For Each Adds In Range(\"Adds\")\n\n    i = i + 1\n\n    MB = Range(\"MBs\")(i)\n    F = Range(\"FromsF\")(i)\n    F2 = Range(\"TosF\")(i)\n    SF = Range(\"FromsSF\")(i)\n    SF2 = Range(\"TosSF\")(i)\n    SSF = Range(\"FromsSSF\")(i)\n    SSF2 = Range(\"TosSSF\")(i)\n    From = Range(\"Adds\")(i)\n    SJ = Range(\"Subs\")(i)\n\n    With myNS\n\n        For Each Folder In myNS.Folders\n\n            If Folder = MB Then\n\n                If SSF = \"\" Then\n\n                    Set Br = Folder.Folders(F).Folders(SF)\n\n                Else\n\n                    Set Br = Folder.Folders(F).Folders(SF).Folders(SSF)\n\n                End If\n\n                If SSF2 = \"\" Then\n\n                    Set ToF = Folder.Folders(F).Folders(SF2)\n\n                    Else\n\n                    Set ToF = Folder.Folders(F).Folders(SF2).Folders(SSF2)\n\n                End If\n\n                For j = Br.Items.Count To 1 Step -1   'loop goes from last to first element\n                    ' ----Find Sender's Name\n                    If Br.Items(j).SenderEmailType = \"SMTP\" Then\n\n                        sn = Br.Items(j).SenderEmailAddress\n\n                    Else\n\n                        Set objReply = Br.Items(j).Reply()\n                        Set objRecipient = objReply.Recipients.Item(1)\n\n                        strEntryId = objRecipient.EntryID\n\n                        objReply.Close OlInspectorClose.olDiscard\n\n                        strEntryId = objRecipient.EntryID\n\n                        Set objAddressentry = oOutlook.GetAddressEntryFromID(strEntryId)\n                        Set objExchangeUser = objAddressentry.GetExchangeUser()\n\n                        On Error Resume Next\n\n                        sn = objExchangeUser.PrimarySmtpAddress()\n\n                    End If\n                    '----------------If sender is equal to our address\n\n                    If sn = From Then\n\n                        If SJ &lt;&gt; \"\" Then\n                            SJ = \"*\" &amp; Range(\"Subs\")(i) &amp; \"*\"\n                            Subject = Br.Items(j).Subject\n\n                            If Subject Like SJ Then\n\n                                Br.Items(j).Move ToF\n\n                            Else\n                            End If\n\n                        Else\n\n                            Br.Items(j).Move ToF\n\n                        End If\n\n                    Else\n                    End If\n\n\n\n                Next j\n\n                Else\n                End If\n\n        Next Folder\n\n    End With\n\nNext Adds\n\nEnd Sub\n</code></pre>\n\n<p>Edit ----------------------------------</p>\n\n<p>So here is my new code.   </p>\n\n<pre><code>Const olFolderInbox As Integer = 6\nOption Compare Text\n' FLIRTER WITH DATE FILTERING\nSub FilterTry()\n    Dim outlookApp As Outlook.Application, oOutlook, TargetMail As Object\n    Dim oInbox As Outlook.Folder, oMail As Outlook.MailItem\n    Dim i, j As Integer\n    Dim objAddressentry As Outlook.AddressEntry, objExchangeUser As Outlook.ExchangeUser\n    Dim objReply As Outlook.MailItem, objRecipient As Outlook.Recipient\n    Dim oAccount As Outlook.Account\n    Dim oOlAp As Object, oOlItm, oOlAtch, oOlns As Object, oOlInb As Object\n    Dim Br, Spec As Folder\n    Dim eSender As String, dtRecvd As String, dtSent As String, o0Acct1 As String, o0Acct2 As String\n    Dim sSubj As String, sMsg As String\n    Dim wb As Workbook, wb2 As Workbook\n    Dim fso As FileSystemObject\n    Dim FName, NewFileName As String\n    Dim sn, Subject, F, F2, SF, SF2, SFF, SFF2, SJ, From, SJstrAddress As String, strEntryId, getSmtpMailAddress As String\n    Dim td, SentDate As Date\n\n\n    'Set objects\n    Set outlookApp = New Outlook.Application\n    Set oOutlook = outlookApp.GetNamespace(\"MAPI\")\n    Set oInbox = oOutlook.GetDefaultFolder(olFolderInbox)\n\n\n    '~~&gt; Get Outlook instance\n    Set oOlAp = GetObject(, \"Outlook.application\")\n    Set oOlns = oOlAp.GetNamespace(\"MAPI\")\n    Set oOlInb = oOlns.GetDefaultFolder(olFolderInbox)\n    Set Br = oOlInb.Folders(\"Brokers\")\n    Set Sp = oOlInb.Folders(\"Confirmation\")\n    Set Rc = oOlInb.Folders(\"Recap\")\n    Set oOlItm = Br.Items\n    Set myNS = GetNamespace(\"MAPI\")\n\n    i = 0\n\n    '----Set variables for folders\nFor Each Adds In Range(\"Adds\")\n\nIf Adds &lt;&gt; \"\" Then\n    i = i + 1\n\n    MB = Range(\"MBs\")(i)\n    F = Range(\"FromsF\")(i)\n    F2 = Range(\"TosF\")(i)\n    SF = Range(\"FromsSF\")(i)\n    SF2 = Range(\"TosSF\")(i)\n    SSF = Range(\"FromsSSF\")(i)\n    SSF2 = Range(\"TosSSF\")(i)\n    From = Range(\"Adds\")(i)\n    SJ = Range(\"Subs\")(i)\n    td = Range(\"Ddate\")\n\n    With myNS\n        '----- Set To and From Destination folders\n        For Each Folder In myNS.Folders\n\n            If Folder = MB Then\n\n                If SSF = \"\" Then\n\n                    Set Br = Folder.Folders(F).Folders(SF)\n\n                Else\n\n                    Set Br = Folder.Folders(F).Folders(SF).Folders(SSF)\n\n                End If\n\n                If SSF2 = \"\" Then\n\n                    Set ToF = Folder.Folders(F).Folders(SF2)\n\n                    Else\n\n                    Set ToF = Folder.Folders(F).Folders(SF2).Folders(SSF2)\n\n                End If\n\n                sFilter = \"[SenderName] = \" &amp; From\n                Set Items = Br.Items.Restrict(sFilter)\n                msg = Items.Count\n\n                For q = Items.Count To 1 Step -1       'loop goes from last to first element\n\n                    sn = Items(q).SenderEmailAddress\n                    SentDt = Items(q).SentOn\n                    SentDate = Month(SentDt) &amp; \"/\" &amp; Day(SentDt) &amp; \"/\" &amp; Year(SentDt)\n                    sn = Items(q).Subject\n                    If SentDate &gt;= td Then\n\n\n                        ' ----Find Sender's Name\n                        If Items(q).SenderEmailType = \"SMTP\" Then\n\n                            sn = Items(q).SenderEmailAddress\n\n                        Else\n\n                            sn = Items(q).PropertyAccessor.GetProperty(\"http://schemas.microsoft.com/mapi/proptag/0x5D01001F\")\n\n                            If Len(sn) = 0 Then\n\n                              Set objSender = Items(q).Sender\n\n                              If Not (objSender Is Nothing) Then\n\n                                'read PR_SMTP_ADDRESS_W\n                                sn = objSender.PropertyAccessor.GetProperty(\"http://schemas.microsoft.com/mapi/proptag/0x39FE001F\")\n\n                                If Len(sn) = 0 Then\n\n                                  'last resort\n                                  Set exUser = objSender.GetExchangeUser\n\n                                  If Not (exUser Is Nothing) Then\n\n                                    sn = exUser.PrimarySmtpAddress\n\n                                  End If\n\n                                End If\n\n                              End If\n\n                            End If\n\n                        End If\n\n                        '----------------If sender is equal to our address\n\n                                If SJ &lt;&gt; \"\" Then\n\n                                    SJ = \"*\" &amp; Range(\"Subs\")(i) &amp; \"*\"\n                                    Subject = Items(q).Subject\n\n                                    If Subject Like SJ Then\n\n                                        Items(q).Move ToF\n\n                                    Else\n                                    End If\n\n                                Else\n\n                                    Items(q).Move ToF\n\n                                End If\n\n                Else\n                End If\n\n                Next q\n\n                Else\n                End If\n\n        Next Folder\n\n    End With\nElse\nEnd If\nNext Adds\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "slicers"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 3979358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5815a0f431440c1b24a72d45cf43b9f8?s=128&d=identicon&r=PG&f=1", "display_name": "Kathy", "link": "https://stackoverflow.com/users/3979358/kathy"}, "edited": false, "score": 0, "creation_date": 1532525230, "post_id": 51507562, "comment_id": 90008879, "body": "How about after each slice of the data I want to save the file (hiding all other slicer options from the user)....such that I want a file named &quot;900110 - Danish Bemidji&quot; and the next &quot;900115 - Finnish Bemidji&quot; and so forth? Do I need to open my workbook each time?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 43, "user_id": 3979358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5815a0f431440c1b24a72d45cf43b9f8?s=128&d=identicon&r=PG&f=1", "display_name": "Kathy", "link": "https://stackoverflow.com/users/3979358/kathy"}, "edited": false, "score": 0, "creation_date": 1532525398, "post_id": 51507562, "comment_id": 90009013, "body": "Why use a slicer then? Instead just go right to the pivotcache and filter, create a new workbook, copy, paste, close the new workbook with whatever name, rinse and repeat. Slicers are a UI for us humans, but if you are just trying to programatically filter a pivotcache and capture the results then that&#39;s a lot overhead."}, {"owner": {"reputation": 61, "user_id": 10995113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a160aa3b64c53869837967574e02bca?s=128&d=identicon&r=PG&f=1", "display_name": "Tomz", "link": "https://stackoverflow.com/users/10995113/tomz"}, "edited": false, "score": 0, "creation_date": 1607683677, "post_id": 51507562, "comment_id": 115355315, "body": "@JNevill how to manage your solution to have item selected as you posted but others item should be set to false?"}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 0, "last_activity_date": 1532466569, "creation_date": 1532466569, "answer_id": 51507562, "question_id": 51507498, "link": "https://stackoverflow.com/questions/51507498/how-to-select-one-slicer-true-and-remaining-false-in-vba/51507562#51507562", "title": "How to select one slicer = true and remaining = false in VBA", "body": "<p>You can loop through all <code>SlicerItems</code> in your <code>SlicerCache</code> using a <code>For Each</code> loop:</p>\n\n<pre><code>Dim si as SlicerItem\n\nFor Each si In ActiveWorkbook.SlicerCaches(\"Slicer_Organization\").SlicerItems\n    si.Selected = (si.Name = \"900110 - Danish Bemidji\")\nNext si\n</code></pre>\n\n<p>That <code>(si.Name = \"900110 - Danish Bemidji\")</code> will return a <code>True</code> or <code>False</code> and set the <code>Selected</code> property of the <code>SlicerItem</code> you are iterating appropriately.</p>\n"}, {"tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 3, "last_activity_date": 1532491030, "creation_date": 1532491030, "answer_id": 51510574, "question_id": 51507498, "link": "https://stackoverflow.com/questions/51507498/how-to-select-one-slicer-true-and-remaining-false-in-vba/51510574#51510574", "title": "How to select one slicer = true and remaining = false in VBA", "body": "<p>Filtering SlicerItems can be tricky, because at least one item must remain visible at all times. </p>\n\n<p>This code shows how to filter a Slicer on an array called vSelection. To amend to your needs, just change the <code>vSelection = Array(\"B\", \"C\", \"E\")</code> line so that it contains the item(s) of interest.</p>\n\n<pre><code>Option Explicit\n\nSub FilterSlicer()\nDim slr As Slicer\nDim sc As SlicerCache\nDim si As SlicerItem\nDim i As Long\nDim vItem As Variant\nDim vSelection As Variant\n\nSet sc = ActiveWorkbook.SlicerCaches(\"Slicer_ID\")\n\nvSelection = Array(\"B\", \"C\", \"E\")\n\nFor Each pt In sc.PivotTables\n    pt.ManualUpdate = True 'Stops PivotTable from refreshing after each PivotItem is changed\nNext pt\n\nWith sc\n\n    'At least one item must remain visible in the Slicer at all times, so make the first\n    'item visible, and at the end of the routine, check if it actually  *should* be visible\n    .SlicerItems(1).Selected = True\n\n    'Hide any other items that aren't already hidden.\n    'Note that it is far quicker to check the status than to change it.\n    ' So only hide each item if it isn't already hidden\n    For i = 2 To .SlicerItems.Count\n        If .SlicerItems(i).Selected Then .SlicerItems(i).Selected = False\n    Next i\n\n    'Make the PivotItems of interest visible\n    On Error Resume Next 'In case one of the items isn't found\n    For Each vItem In vSelection\n        .SlicerItems(vItem).Selected = True\n    Next vItem\n    On Error GoTo 0\n\n    'Hide the first PivotItem, unless it is one of the countries of interest\n    On Error Resume Next\n    If InStr(UCase(Join(vSelection, \"|\")), UCase(.SlicerItems(1).Name)) = 0 Then .SlicerItems(1).Selected = False\n    If Err.Number &lt;&gt; 0 Then\n        .ClearAllFilters\n        MsgBox Title:=\"No Items Found\", Prompt:=\"None of the desired items was found in the Slicer, so I have cleared the filter\"\n    End If\n    On Error GoTo 0\nEnd With\n\n\nFor Each pt In sc.PivotTables\n    pt.ManualUpdate = False\nNext pt\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 3979358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5815a0f431440c1b24a72d45cf43b9f8?s=128&d=identicon&r=PG&f=1", "display_name": "Kathy", "link": "https://stackoverflow.com/users/3979358/kathy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3997, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1532491030, "creation_date": 1532466202, "question_id": 51507498, "link": "https://stackoverflow.com/questions/51507498/how-to-select-one-slicer-true-and-remaining-false-in-vba", "title": "How to select one slicer = true and remaining = false in VBA", "body": "<p>Trying to narrow down this VBA script w/o having to list out . I'm a basic Macro user. How can I get one selected = True and the rest = False without having to list all 160?</p>\n\n<pre><code>With ActiveWorkbook.SlicerCaches(\"Slicer_Organization\")\n    .SlicerItems(\"900110 - Danish Bemidji \").Selected = True\n    .SlicerItems(\"900101 - Arabic Bemidji\").Selected = False\n    .SlicerItems(\"900105 - Chinese Callaway 1st Half\").Selected = False\n    .SlicerItems(\"900106 - Chinese Callaway 2nd Half\").Selected = False\n    .SlicerItems(\"900115 - Finnish Bemidji \").Selected = False\n    .SlicerItems(\"900120 - French Bemidji 1st Half \").Selected = False\n    .SlicerItems(\"900121 - French Bemidji 2nd Half \").Selected = False\n</code></pre>\n"}]