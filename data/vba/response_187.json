[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1533772000, "post_id": 51757077, "comment_id": 90473579, "body": "I think you might want to change the title of your question so it lines up with what you want to know"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1533772161, "post_id": 51757077, "comment_id": 90473604, "body": "Also, see here <a href=\"https://stackoverflow.com/a/11999000/2727437\">stackoverflow.com/a/11999000/2727437</a>"}, {"owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1533772409, "post_id": 51757077, "comment_id": 90473661, "body": "@Marcucciboy2 I&#39;m afraid the linked stack overflow post is something I have already visited and does not help. As said, 2 computers are handling the same code differently... That being said, this may not be a question for stack overflow as it isn&#39;t code related..."}, {"owner": {"reputation": 655, "user_id": 3097981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6776097221ad67f371357aaf72cbc775?s=128&d=identicon&r=PG&f=1", "display_name": "Hila DG", "link": "https://stackoverflow.com/users/3097981/hila-dg"}, "edited": false, "score": 0, "creation_date": 1533772422, "post_id": 51757077, "comment_id": 90473663, "body": "Could it be different versions of Excel or Windows? divide by 0 is captured at the CPU level, I do know that much"}, {"owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "reply_to_user": {"reputation": 655, "user_id": 3097981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6776097221ad67f371357aaf72cbc775?s=128&d=identicon&r=PG&f=1", "display_name": "Hila DG", "link": "https://stackoverflow.com/users/3097981/hila-dg"}, "edited": false, "score": 0, "creation_date": 1533772489, "post_id": 51757077, "comment_id": 90473685, "body": "@HilaDG Hmm.. Well my laptop is Win10 and Desktop is Win7, so that&#39;s a possibility. If I had another Win10/Win7 computer I&#39;d test it"}], "answers": [{"comments": [{"owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "edited": false, "score": 1, "creation_date": 1533773611, "post_id": 51757179, "comment_id": 90473890, "body": "Ergh... You&#39;re right. For goodness sakes. Desktop: <code>Break on All Errors</code> v.s. Laptop: <code>Break on Unhandled Errors</code>. I assume some part of me thought that was a good idea at the time."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 3, "last_activity_date": 1533772941, "creation_date": 1533772941, "answer_id": 51757179, "question_id": 51757077, "link": "https://stackoverflow.com/questions/51757077/different-computers-handling-on-error-resume-next-differently/51757179#51757179", "title": "Different computers handling &quot;On Error Resume Next&quot; differently?", "body": "<p>Most likely this is due to different settings in your VB editor under</p>\n\n<p><em>Tools>>Options>>General>>Error Trapping</em></p>\n\n<p>If set to \"Break on all errors\" then that's what it does...</p>\n"}], "owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 51757179, "answer_count": 1, "score": 0, "last_activity_date": 1533772941, "creation_date": 1533771872, "last_edit_date": 1533772269, "question_id": 51757077, "link": "https://stackoverflow.com/questions/51757077/different-computers-handling-on-error-resume-next-differently", "title": "Different computers handling &quot;On Error Resume Next&quot; differently?", "body": "<p>I have the following code:</p>\n\n<pre><code>Sub test()\n    On Error GoTo Label\n    Debug.Print 1 / 0\n    Exit Sub\nLabel:\n    MsgBox \"Infinity!\"\nEnd Sub\n</code></pre>\n\n<p>If I run this code on my laptop, I get \"Infinity\", as I expected. However... When I run it on my desktop, excel throws an error message <code>Runtime error 11 ... Division by zero</code></p>\n\n<p>Has anyone ever experienced this before? It's almost like my Excel desktop client has just 'forgotton' how to handle errors...</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1533770567, "post_id": 51756912, "comment_id": 90473283, "body": "<b>Please <a href=\"https://stackoverflow.com/posts/51756912/edit\">edit</a> your question to add the code showing the loop that you&#39;re using</b>, as there are a number of ways you could be doing this, so the correct answer could vary.  The error&#39;s probably occurring if you try to paste at the same split-second that the clipboard is being populated.  Are you pausing at all between each attempt?  Are you using <code>DoEvents</code>?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1533770861, "post_id": 51756912, "comment_id": 90473344, "body": "It may also be helpful to know a little background about what you&#39;re doing. Often with something like this there&#39;s a better (less problem-prone) way to get the job done by looking at it a different way.  For example, where is this clipboard data coming from? Perhaps it would be better for the source application to proactively trigger your task a from that end (by simply calling a procedure), instead of retroactively &quot;watching&quot; for it from this end, like a custom event."}, {"owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1533771324, "post_id": 51756912, "comment_id": 90473448, "body": "@ashleedawg I really don&#39;t think the code will help to be honest. It will just confuse matters more. I am converting linked images to embedded images. So it&#39;s already using a &#39;hack&#39; that copy/paste embeds an image rather than links it. Sadly, using copy and paste like this is really the only way of doing this also, unless you want to snoop around in the decompressed Excel xml file, which I have considered."}, {"owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1533771511, "post_id": 51756912, "comment_id": 90473493, "body": "@ashleedawg on the off chance it will help, I&#39;ve added more detail to the question."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1533771974, "post_id": 51756912, "comment_id": 90473574, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1108947/excel-vba-macro-check-content-of-clipboard-before-pasting\">Excel VBA Macro: Check content (of clipboard?) before pasting</a>"}, {"owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1533772174, "post_id": 51756912, "comment_id": 90473610, "body": "@Comintern I&#39;m afraid the marked question is named incorrectly. The author was asking for something completely different."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1533772478, "post_id": 51756912, "comment_id": 90473681, "body": "Read <a href=\"https://stackoverflow.com/a/13914224/4088852\">this answer</a>. It shows how to do exactly what you&#39;re trying to do."}, {"owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1533772676, "post_id": 51756912, "comment_id": 90473713, "body": "@Comintern ... No? It doesn&#39;t? This is pasting text data to the page, for one, not image data. This doesn&#39;t look like it&#39;s &quot;waiting&quot; for data to be ready to me...? Nothing about this answer is waiting for data to be ready or even getting the data for that matter..."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1533772911, "post_id": 51756912, "comment_id": 90473753, "body": "Read the part that checks to see if a clipboard format is available. It doesn&#39;t matter what <i>kind</i> of data that answer is checking - it shows how to check the clipboard for data."}, {"owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1533773174, "post_id": 51756912, "comment_id": 90473800, "body": "@Comintern Mhmm. Right, I see what you mean. Didn&#39;t see it that way at first. Will give it a go and see if I can get that working."}], "answers": [{"comments": [{"owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "edited": false, "score": 0, "creation_date": 1533801373, "post_id": 51757332, "comment_id": 90482150, "body": "Personally I&#39;d like to avoid using a pause. If it is &#39;populate time&#39; issue then pausing for any fixed amount of time doesn&#39;t work for files larger than a certain size. Also it may be processor dependant."}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1533774647, "creation_date": 1533774647, "answer_id": 51757332, "question_id": 51756912, "link": "https://stackoverflow.com/questions/51756912/wait-for-clipboard-to-contain-data/51757332#51757332", "title": "Wait for clipboard to contain data", "body": "<p>I think you probably just need to add a pause to give the clipboard a moment to populate the clipboard before you try to access it.  </p>\n\n<p>I use a pause procedure like:  </p>\n\n<pre><code>Sub Pause(sec as Single) \n    Dim startTime as Single \n    StartTime=Timer \n    Do \n        DoEvents\n    Loop While StartTime + sec &gt; Timer \nEnd Sub\n</code></pre>\n\n<p>I'd probably start with a quarter or half second pause (ie., <code>Pause (0.25)</code>) and then loop until the clipboard's ready. </p>\n\n<p>A half second should be more than enough time, although ideally you'd be triggering your procedure from the other end after pasting, proactively instead of re actively.</p>\n"}], "owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1001, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1533774647, "creation_date": 1533770317, "last_edit_date": 1533771475, "question_id": 51756912, "link": "https://stackoverflow.com/questions/51756912/wait-for-clipboard-to-contain-data", "title": "Wait for clipboard to contain data", "body": "<p>I'm building a process to convert linked images into embedded images in Excel:</p>\n\n<pre><code>for ws in wb.sheets\n    count = ws.shapes.count\n    for 1 to count\n        'Get first shape from collection\n        set shp = ws.shapes(1)\n\n        'Store shape's position/size\n        '...\n\n        'Break link if it exists\n        shp.CopyPicture\n        ws.Paste\n        shp.delete\n        set newShp = ws.shapes(count)\n\n        'Assign newShp, shp's old position/size\n        '...\n    next shp\nnext ws\n</code></pre>\n\n<p>Sometimes the code will error on line the 2nd line of:</p>\n\n<pre><code>shp.CopyPicture\nws.Paste\n</code></pre>\n\n<p>with the error \"Unable to execute method paste...\". This occurs also when I space out the copy and paste methods with <code>DoEvents</code> like so:</p>\n\n<pre><code>shp.CopyPicture\nDoEvents\nws.Paste\nDoEvents\n</code></pre>\n\n<p>However after clicking debug, and waiting a second or two, and pressing play again everything continues working like a charm.</p>\n\n<p>I suspect Excel isn't waiting long enough for the <code>CopyPicture</code> method, to fully occupy the clipboard. Assuming this is the case, can I monitor the clipboard somehow and wait till the clipboard data is full?</p>\n"}, {"tags": ["ms-access", "vba", "duplicates"], "comments": [{"owner": {"reputation": 1909, "user_id": 1375455, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2bbc506cb576f74d9ab507b10230acaa?s=128&d=identicon&r=PG", "display_name": "FSm", "link": "https://stackoverflow.com/users/1375455/fsm"}, "edited": false, "score": 0, "creation_date": 1533769377, "post_id": 51756694, "comment_id": 90473016, "body": "I really wondering what makes a question of two  lines to be bored ? I even illustrated my needs by simple and clear example. Some people are good just in down-voting. !!"}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 1, "creation_date": 1533787116, "post_id": 51756694, "comment_id": 90476432, "body": "I am <b>not</b> the one who down voted.  I only offer some insight, so no offense is intended.  Deleting duplicate records in a relational (i.e. SQL) database is considered very basic for many experienced database programmers.  There are many website and video tutorials about how to do this, so I guess that others may perceive a lack of research.  The <a href=\"https://stackoverflow.com/help/how-to-ask\">How to ask</a> page suggests &quot;Searching and researching&quot; and the tradition is that you should share what you have tried.  There is no indication of any research or attempted solution in your question."}, {"owner": {"reputation": 1909, "user_id": 1375455, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2bbc506cb576f74d9ab507b10230acaa?s=128&d=identicon&r=PG", "display_name": "FSm", "link": "https://stackoverflow.com/users/1375455/fsm"}, "reply_to_user": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1533832209, "post_id": 51756694, "comment_id": 90502632, "body": "C Perkins, you may right in a part of the OP. However, my table contains ID field as a primary key. Therefor, the duplicated records in my case by the First Name and LastName only, that means ID not mandatory to be duplicated,  as my table would never has duplicated ID. So, The delete duplicated records  that I want  is a bit different from the traditional delete methods which consider deleting rows when the whole  row fields are duplicated. And to be honest, I haven&#39;t find a code that fill my bill  as the one  I found in the accepted answer here."}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1533844326, "post_id": 51756694, "comment_id": 90508293, "body": "I&#39;m glad that you got code which worked for you, but in most properly normalized tables the ID field is usually the primary key and also never duplicated.  Your case is not unusual.  All one must do is apply a basic pattern to only a couple fields and essentially ignore the other fields.  Much of programming is about following a pattern where particular details might be different."}, {"owner": {"reputation": 1909, "user_id": 1375455, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2bbc506cb576f74d9ab507b10230acaa?s=128&d=identicon&r=PG", "display_name": "FSm", "link": "https://stackoverflow.com/users/1375455/fsm"}, "reply_to_user": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1533847351, "post_id": 51756694, "comment_id": 90509494, "body": "C Perkins, maybe it was not unusual, but at least it was out of my programming abilities as I&#39;m not good familiar with SQL"}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 1, "creation_date": 1533853772, "post_id": 51756694, "comment_id": 90511580, "body": "Remember, the only reason I commented was to help you realize why others down voted... and now why the question was <i>put on hold as too broad</i>.  Stack Overflow has traditionally been for focused question, not meant to be tutorials nor a code-writing service for those not familiar with a particular language.  I sympathize with you as you learn SQL, but not being familiar with SQL is not sufficient to avoid being voted down. The preferred way to research fundamentals is to find tutorials.  If you were very new to SO I wouldn&#39;t say all this, but you have high enough reputation to understand this."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1535026363, "post_id": 51756694, "comment_id": 90920415, "body": "@FSm - more information on how to phrase a question is available in &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and further information about <b>how to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a></b>.  Also handy tips from the sites&#39; top user <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\"><b>here</b></a>."}], "answers": [{"comments": [{"owner": {"reputation": 1909, "user_id": 1375455, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2bbc506cb576f74d9ab507b10230acaa?s=128&d=identicon&r=PG", "display_name": "FSm", "link": "https://stackoverflow.com/users/1375455/fsm"}, "edited": false, "score": 0, "creation_date": 1533769974, "post_id": 51756809, "comment_id": 90473130, "body": "I tried it, but error in syntax appeared"}, {"owner": {"reputation": 6885, "user_id": 123422, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ft4KH.jpg?s=128&g=1", "display_name": "Paul Abbott", "link": "https://stackoverflow.com/users/123422/paul-abbott"}, "reply_to_user": {"reputation": 1909, "user_id": 1375455, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2bbc506cb576f74d9ab507b10230acaa?s=128&d=identicon&r=PG", "display_name": "FSm", "link": "https://stackoverflow.com/users/1375455/fsm"}, "edited": false, "score": 0, "creation_date": 1533770211, "post_id": 51756809, "comment_id": 90473188, "body": "...and the error said what?"}, {"owner": {"reputation": 1909, "user_id": 1375455, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2bbc506cb576f74d9ab507b10230acaa?s=128&d=identicon&r=PG", "display_name": "FSm", "link": "https://stackoverflow.com/users/1375455/fsm"}, "edited": false, "score": 0, "creation_date": 1533770325, "post_id": 51756809, "comment_id": 90473221, "body": "<code>Syntax error in query expression  ID NOT IN (   SELECT MIN(t2.ID) FROM table t2   GROUP BY t2.FirstName, t2.LastName ) </code>"}, {"owner": {"reputation": 6885, "user_id": 123422, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ft4KH.jpg?s=128&g=1", "display_name": "Paul Abbott", "link": "https://stackoverflow.com/users/123422/paul-abbott"}, "reply_to_user": {"reputation": 1909, "user_id": 1375455, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2bbc506cb576f74d9ab507b10230acaa?s=128&d=identicon&r=PG", "display_name": "FSm", "link": "https://stackoverflow.com/users/1375455/fsm"}, "edited": false, "score": 0, "creation_date": 1533770648, "post_id": 51756809, "comment_id": 90473296, "body": "Show EXACTLY what you are typing in.  I tried it in Access 2003 with a table exactly like yours and it works fine."}, {"owner": {"reputation": 1909, "user_id": 1375455, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2bbc506cb576f74d9ab507b10230acaa?s=128&d=identicon&r=PG", "display_name": "FSm", "link": "https://stackoverflow.com/users/1375455/fsm"}, "edited": false, "score": 0, "creation_date": 1533770824, "post_id": 51756809, "comment_id": 90473331, "body": "I typed <code>DELETE FROM Students WHERE ID NOT IN (   SELECT MIN(t2.ID) FROM table t2   GROUP BY t2.FirstName, t2.LastName );</code> I&#39;m using access 2016"}, {"owner": {"reputation": 6885, "user_id": 123422, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ft4KH.jpg?s=128&g=1", "display_name": "Paul Abbott", "link": "https://stackoverflow.com/users/123422/paul-abbott"}, "reply_to_user": {"reputation": 1909, "user_id": 1375455, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2bbc506cb576f74d9ab507b10230acaa?s=128&d=identicon&r=PG", "display_name": "FSm", "link": "https://stackoverflow.com/users/1375455/fsm"}, "edited": false, "score": 1, "creation_date": 1533770878, "post_id": 51756809, "comment_id": 90473350, "body": "You need <code>DELETE FROM Students WHERE ID NOT IN ( SELECT MIN(t2.ID) FROM ***Students*** t2 GROUP BY t2.FirstName, t2.LastName )</code>, you didn&#39;t replace the second table name."}, {"owner": {"reputation": 1909, "user_id": 1375455, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2bbc506cb576f74d9ab507b10230acaa?s=128&d=identicon&r=PG", "display_name": "FSm", "link": "https://stackoverflow.com/users/1375455/fsm"}, "edited": false, "score": 0, "creation_date": 1533771282, "post_id": 51756809, "comment_id": 90473433, "body": "Now, I got error said <code>query must have at least one destination field</code>"}], "tags": [], "owner": {"reputation": 6885, "user_id": 123422, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ft4KH.jpg?s=128&g=1", "display_name": "Paul Abbott", "link": "https://stackoverflow.com/users/123422/paul-abbott"}, "is_accepted": false, "score": 2, "last_activity_date": 1533769726, "last_edit_date": 1533769726, "creation_date": 1533769421, "answer_id": 51756809, "question_id": 51756694, "link": "https://stackoverflow.com/questions/51756694/remove-duplicate-records-by-first-name-and-last-name-combined/51756809#51756809", "title": "Remove duplicate records by first name and last name combined", "body": "<p>My knowledge of Access' dialect of SQL is not great, but perhaps</p>\n\n<pre><code>DELETE FROM table WHERE ID NOT IN (\n  SELECT MIN(t2.ID) FROM table t2\n  GROUP BY t2.FirstName, t2.LastName\n)\n</code></pre>\n\n<p>The inner statement selects the first ID for each first/last name combination (1, 2).  Then delete everything that is not in that list (3).</p>\n\n<p>EDIT: Changed FIRST() to MIN()</p>\n"}, {"tags": [], "owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "is_accepted": true, "score": 1, "last_activity_date": 1533788423, "creation_date": 1533788423, "answer_id": 51758799, "question_id": 51756694, "link": "https://stackoverflow.com/questions/51756694/remove-duplicate-records-by-first-name-and-last-name-combined/51758799#51758799", "title": "Remove duplicate records by first name and last name combined", "body": "<p>Assuming your table name is tblStudents, use this:</p>\n\n<pre><code>DELETE \nFROM tblStudents t1\nWHERE t1.ID NOT IN\n(\nSELECT MIN(t2.ID)\nFROM tblStudents t2\nWHERE t1.FirstName =  t2.FirstName\nAND t1.LastName =  t2.LastName\n)\n</code></pre>\n"}], "owner": {"reputation": 1909, "user_id": 1375455, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2bbc506cb576f74d9ab507b10230acaa?s=128&d=identicon&r=PG", "display_name": "FSm", "link": "https://stackoverflow.com/users/1375455/fsm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 559, "favorite_count": 0, "closed_date": 1533803074, "accepted_answer_id": 51758799, "answer_count": 2, "score": -3, "last_activity_date": 1535026238, "creation_date": 1533768629, "last_edit_date": 1535026238, "question_id": 51756694, "link": "https://stackoverflow.com/questions/51756694/remove-duplicate-records-by-first-name-and-last-name-combined", "closed_reason": "Needs more focus", "title": "Remove duplicate records by first name and last name combined", "body": "<p>Let's have a table with the following data:</p>\n\n<pre><code>ID         FirstName        LastName\n1          jj               ff\n2          jj               hh\n3          jj               ff\n</code></pre>\n\n<p>I want to delete the duplicated records only by first name and last name combined. So, the output I want should be:</p>\n\n<pre><code>ID         FirstName        LastName\n1          jj               ff\n2          jj               hh\n</code></pre>\n\n<p>How to achieve this task? </p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Just to illustrate more about my problem. My table contains ID field as a primary key. Therefor, the duplicated records in my case by the First Name and LastName only, that means ID not mandatory to be duplicated, as my table would never have duplicated ID. So, The delete duplicated records that I want is a bit different from the traditional delete methods which consider deleting rows when the whole row fields are duplicated. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1533767546, "post_id": 51756534, "comment_id": 90472587, "body": "<code>InStr(ws.Range(totalRow, &quot;A&quot;).Value...</code>  You should always scope your Range/Cells calls with a worksheet object, otherwise they will reference whatever happens to be the Activesheet."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1533780731, "post_id": 51756534, "comment_id": 90475234, "body": "Root cause: <code>Range(totalRow, &quot;A&quot;)</code> is invalid syntax.  Use <code>ws.Cells(totalRow, &quot;A&quot;)</code> or <code>ws.Range(&quot;A&quot; &amp; totalRow)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "is_accepted": false, "score": 0, "last_activity_date": 1533767857, "creation_date": 1533767857, "answer_id": 51756602, "question_id": 51756534, "link": "https://stackoverflow.com/questions/51756534/getting-runtime-error-1004-not-sure-what-im-doing-wrong/51756602#51756602", "title": "Getting runtime error 1004, not sure what I&#39;m doing wrong", "body": "<p>Several suggestions:</p>\n\n<ol>\n<li>This is the basic problem:</li>\n</ol>\n\n<blockquote>\n  <blockquote>\n    <p>Error 1004 \"Application-defined or Object-defined error\" </p>\n  </blockquote>\n</blockquote>\n\n<ol start=\"2\">\n<li>Look here for several potential issues/potential fixes:</li>\n</ol>\n\n<p><a href=\"https://stackoverflow.com/questions/17980854/vba-runtime-error-1004-application-defined-or-object-defined-error-when-select\">VBA Runtime Error 1004 &quot;Application-defined or Object-defined error&quot; when Selecting Range</a></p>\n\n<ol start=\"3\">\n<li><p>Use the VBA debugger and step through your macro a line at a time, until you find the specific object it's barfing on:</p>\n\n<ul>\n<li><a href=\"https://www.techonthenet.com/excel/macros/vba_debug2013.php\" rel=\"nofollow noreferrer\">https://www.techonthenet.com/excel/macros/vba_debug2013.php</a></li>\n</ul></li>\n</ol>\n\n<p>EDIT:</p>\n\n<ol start=\"4\">\n<li>Having said that, I think Tim Williams's suggestion is probably spot-on:</li>\n</ol>\n\n<blockquote>\n  <p>You should always scope your Range/Cells calls with a worksheet\n  object, otherwise they will reference whatever happens to be the\n  Activesheet.</p>\n</blockquote>\n\n<p>But PLEASE: </p>\n\n<p>If at all possible, make the effort to learn troubleshooting tools available to you (like the debugger).</p>\n\n<p>One other \"useful tips\" link I'd urge you to look at:</p>\n\n<p><a href=\"http://www.jlathamsite.com/Teach/VBA/WritingBulletProofCode.pdf\" rel=\"nofollow noreferrer\">http://www.jlathamsite.com/Teach/VBA/WritingBulletProofCode.pdf</a></p>\n"}], "owner": {"reputation": 13, "user_id": 10108215, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0jc2OO9ovlo/AAAAAAAAAAI/AAAAAAAACSo/DS4t45CqxLE/photo.jpg?sz=128", "display_name": "Alex Baird", "link": "https://stackoverflow.com/users/10108215/alex-baird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1533767857, "creation_date": 1533767387, "question_id": 51756534, "link": "https://stackoverflow.com/questions/51756534/getting-runtime-error-1004-not-sure-what-im-doing-wrong", "title": "Getting runtime error 1004, not sure what I&#39;m doing wrong", "body": "<p>So I'm a bit new to excel VBA, and I'm creating a macro to run on financial worksheets. I want to shift the values in the totals to the right place, as they are a column to the left of the actual data (these weren't created by a formula, they were generated by a different program and are fixed text). The shifting I managed to do just fine. The problem here is finding where the totals column is, as it varies between worksheets.</p>\n\n<p>This is what I have so far.</p>\n\n<pre><code> For totalRow = 7 To 2000\n    With ws\n        If ws.Visible = True Then\n            If InStr(Range(totalRow, \"A\").Value, \"Totals:\") &gt; 0 Then\n                Exit For\n            End If\n        End If\n    End With\nNext totalRow\n</code></pre>\n\n<p>Yet for some reason, it's giving me an error when I try to run it. I know it's probably something simple I'm overlooking, because I cannot for the life of me figure out the problem. I've tried using a Do-Until loop, same issue. Is it a problem with the variables I'm using?</p>\n"}, {"tags": ["user-interface", "ms-access", "vba", "ms-access-2007"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1533804721, "post_id": 51756510, "comment_id": 90484133, "body": "What do you mean by &#39;skipped a line&#39;? Exactly what indicates a line is &#39;skipped&#39;? If this is an auto-number field, gaps should not be a concern. Autonumber ID should not have meaning to users, it&#39;s just a mechanism to link records. Don&#39;t even display the autonumber."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1533805671, "post_id": 51756510, "comment_id": 90484730, "body": "Okay, read question again. It is not autonumber gap that is issue - it is that you want the records to have same order as listed in the shipping invoice. I expect this will need another field for input of order sequence identifier. And if an item must be inserted this means editing all the following records if they were originally entered without a sequence gap. Is there an item number on the shipping invoice?"}, {"owner": {"reputation": 642, "user_id": 10007038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d95bfa18667ecc4c309e6d0d63e4814?s=128&d=identicon&r=PG", "display_name": "Edward", "link": "https://stackoverflow.com/users/10007038/edward"}, "edited": false, "score": 0, "creation_date": 1533830849, "post_id": 51756510, "comment_id": 90501911, "body": "Yes, but the item number on the invoice doesn&#39;t appear on the report. Instead, the item description is used (which is apparently unique enough). Mhm I know that I will need an additional field to determine the record sequence. My hope was to allow users to push a button once and I could manipulate everything on the back-end. That would be preferable to having them enter a sequence order for the entire report, since they are likely to make an error."}, {"owner": {"reputation": 642, "user_id": 10007038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d95bfa18667ecc4c309e6d0d63e4814?s=128&d=identicon&r=PG", "display_name": "Edward", "link": "https://stackoverflow.com/users/10007038/edward"}, "edited": false, "score": 0, "creation_date": 1533831412, "post_id": 51756510, "comment_id": 90502208, "body": "Attempting Gustav&#39;s code fix in the mean time."}], "owner": {"reputation": 642, "user_id": 10007038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d95bfa18667ecc4c309e6d0d63e4814?s=128&d=identicon&r=PG", "display_name": "Edward", "link": "https://stackoverflow.com/users/10007038/edward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "closed_date": 1533840306, "answer_count": 0, "score": 1, "last_activity_date": 1533798766, "creation_date": 1533767154, "last_edit_date": 1533798766, "question_id": 51756510, "link": "https://stackoverflow.com/questions/51756510/access-continuous-form-manipulate-record-order", "closed_reason": "Duplicate", "title": "Access Continuous Form manipulate record order", "body": "<p>I am trying to implement a <code>GUI</code> through an <code>Access 2007</code> <code>Form</code> for users to enter data through. </p>\n\n<p>I am using a <code>continuous</code> style form in <code>Access</code> because the users are entering data line-by-line as they appear on a shipping invoice. </p>\n\n<p>Through repeated discussions with multiple end-users and managers, it has become apparent that users will need the ability to <code>insert</code> a new record into these itemized lists if they realize that they have mistakenly skipped a line. </p>\n\n<p>This means that I need to have some mechanism to manipulate the record order on-the-fly in a continuous form in <code>Access</code>. So far, I have been unable to find answers on how to do this. </p>\n\n<p>Does anyone have any suggestions? </p>\n\n<p><strong>Important Details:</strong> </p>\n\n<ul>\n<li><p>The lists are composed of <code>child</code> records and are each assigned a\n<code>detail_id</code>. </p></li>\n<li><p>The <code>parent</code> record contains a <code>master_id</code> which is associated to the\n<code>child</code> records. </p></li>\n<li><p>The current <code>order by</code> is <code>detail_id ASC</code>.</p></li>\n</ul>\n\n<p>It would be best to not have users type the row_order they wish the final information to be entered in. I would like <code>Access</code> to either key off a separate sequence field or use an additional field in the <code>order by</code> to accomplish this.</p>\n"}, {"tags": ["vba", "excel", "loops", "charts"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1533771323, "post_id": 51756399, "comment_id": 90473447, "body": "Record a macro. Then adjust where needed"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1533830299, "post_id": 51756399, "comment_id": 90501593, "body": "please take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. You&#39;re halfway there, but the code you have presently doesn&#39;t show any effort towards creating a chart, so it reads like you expect someone to provide a full solution for you. Please try to solve the problem on your own and revise your question so that it states a <i>specific</i>, answerable problem or error you need help to resolve."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1533837282, "post_id": 51756399, "comment_id": 90505147, "body": "So, should we create chart for you?"}, {"owner": {"reputation": 11, "user_id": 10200156, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2MTOur5P2uc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o_g90Tb0md33fjrcnM1MAx-tZ3Sg/mo/photo.jpg?sz=128", "display_name": "Thapelo Seatlhodi", "link": "https://stackoverflow.com/users/10200156/thapelo-seatlhodi"}, "edited": false, "score": 0, "creation_date": 1533842905, "post_id": 51756399, "comment_id": 90507608, "body": "Sorry, forgot to include my chart macro."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1533843808, "post_id": 51756399, "comment_id": 90508063, "body": "You want to plot it on the same chart?"}, {"owner": {"reputation": 11, "user_id": 10200156, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2MTOur5P2uc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o_g90Tb0md33fjrcnM1MAx-tZ3Sg/mo/photo.jpg?sz=128", "display_name": "Thapelo Seatlhodi", "link": "https://stackoverflow.com/users/10200156/thapelo-seatlhodi"}, "edited": false, "score": 0, "creation_date": 1533880477, "post_id": 51756399, "comment_id": 90517330, "body": "Yes, same on the same worksheet if I do follow your question, where the Createachart macro is able to read off the macro that populate values on the columns C to E. At the moment, the Createachart macro can only able to read off and plot the values if I do put the values manually, which is the opposite of what i want. I hope I am making sense."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1533911144, "post_id": 51756399, "comment_id": 90534496, "body": "Could you visualize what you wanna get? I barely understand how the chart should look like..."}, {"owner": {"reputation": 11, "user_id": 10200156, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2MTOur5P2uc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o_g90Tb0md33fjrcnM1MAx-tZ3Sg/mo/photo.jpg?sz=128", "display_name": "Thapelo Seatlhodi", "link": "https://stackoverflow.com/users/10200156/thapelo-seatlhodi"}, "edited": false, "score": 0, "creation_date": 1533940045, "post_id": 51756399, "comment_id": 90547034, "body": "I want a bar chart graph where a student 6  goes with a bar = 45 %, student7  goes with a bar = 33 and so on."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10200156, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2MTOur5P2uc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o_g90Tb0md33fjrcnM1MAx-tZ3Sg/mo/photo.jpg?sz=128", "display_name": "Thapelo Seatlhodi", "link": "https://stackoverflow.com/users/10200156/thapelo-seatlhodi"}, "edited": false, "score": 0, "creation_date": 1534727095, "post_id": 51807412, "comment_id": 90795619, "body": "Thanks, really appreciate your help JohnyL. You helped me to look at the problem differently i.e. using one column range instead of using three column range than I had previously thought. I will continue to learn to learn VBA on my own so that tomorrow I can also contribute in helping others."}], "tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": false, "score": 0, "last_activity_date": 1534065205, "last_edit_date": 1592644375, "creation_date": 1534065205, "answer_id": 51807412, "question_id": 51756399, "link": "https://stackoverflow.com/questions/51756399/how-to-create-a-chart-on-the-same-worksheet-using-a-for-loop-statement/51807412#51807412", "title": "How to create a chart on the same worksheet using a for loop statement?", "body": "<p>I guess this code is what you need (providing your example table starts in A1 cell):</p>\n<pre><code>Sub CreateChart()\n    \n    Dim sh As Shape\n    Dim ch As Chart\n    Dim ser As Series\n    Dim lColor&amp;, i%, x, arr\n    \n    '// Remove all charts\n    For Each sh In ActiveSheet.Shapes\n        If sh.Type = msoChart Then sh.Delete\n    Next\n    \n    '// Add chart to sheet\n    With Range(&quot;A10:N30&quot;)\n        Set ch = .Parent.Shapes.AddChart(xlColumn, .Left, .Top, .Width, .Height).Chart\n    End With\n    \n    With ch\n    \n        '// If user's selection is within chart data range,\n        '// then Excel will create chart based on data in this range.\n        '// We don't need it, so clear the chart out.\n        .ChartArea.ClearContents\n        \n        '// Add series\n        Set ser = ch.SeriesCollection.NewSeries()\n        ser.Values = Range(&quot;B2:B8&quot;).Value\n        ser.XValues = Range(&quot;A2:A8&quot;).Value\n        \n        '// Get values\n        arr = ser.Values\n        \n        '// Format points based on values\n        For i = 1 To UBound(arr)\n            x = arr(i)\n            Select Case True\n                Case x &gt;= 90: lColor = vbGreen\n                Case x &gt;= 50 And x &lt; 90: lColor = vbYellow\n                Case x &lt; 50: lColor = vbRed\n            End Select\n            ser.Points(i).Format.Fill.ForeColor.RGB = lColor\n        Next\n    End With\n\nEnd Sub\n</code></pre>\n<p>You can download workbook with code <a href=\"https://1drv.ms/x/s!AvqfUD6Rp0UCjmAFnhVJ7vCMIuQf\" rel=\"nofollow noreferrer\">here</a>.</p>\n<h3>Result:</h3>\n<p><img src=\"https://npfola.am.files.1drv.com/y4m0t7B6p8GcdIl2lLsCs3i8ytIeL-M2vQE4u3tXoOx75Wyklh6zAjllwIbc5OVxUxESLkiev52aIhab1CtN9ZEBNvP1xe0ZfL4S2CX65yZh1BXKK0NYcTFWh1Svyz1FwotYFySwe3-NPMAu3_egexSzGiH7eY2Jqy4GHjcDD8gHM0SEVlcQVy6OhRh1Pp7ezVOh1svt1dHzjxdXUVCtrV5Nw?width=892&amp;height=421&amp;cropmode=none\" alt=\"IMG1\" /></p>\n"}], "owner": {"reputation": 11, "user_id": 10200156, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2MTOur5P2uc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o_g90Tb0md33fjrcnM1MAx-tZ3Sg/mo/photo.jpg?sz=128", "display_name": "Thapelo Seatlhodi", "link": "https://stackoverflow.com/users/10200156/thapelo-seatlhodi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534092240, "creation_date": 1533766518, "last_edit_date": 1534092240, "question_id": 51756399, "link": "https://stackoverflow.com/questions/51756399/how-to-create-a-chart-on-the-same-worksheet-using-a-for-loop-statement", "title": "How to create a chart on the same worksheet using a for loop statement?", "body": "<pre><code>Name       Progress  \nStudent1    93    \nStudent2    80\nStudent3    51\nStudent4    91\nStudent5    65\nStudent6    45          \nstudent7    33\n</code></pre>\n\n<p>I am still new to VBA programming. Above is my data set example and below is my code which is able to populate columns C to E to the right without giving any error. Below is my chart code which gives me a bad chart when I run it. Please advise on how to go about plotting these populated values on columns C to E on a bar chart on the same worksheet, where a green bar shows progress >= 90, amber bar shows 50 &lt;= Progress And Progress &lt; 90 and red bar shows progress &lt;50. </p>\n\n<pre><code>Sub ClassCategories()\n\n    Dim startRow As Long, lastRow As Long, n As Integer\n    startRow = 2\n    n = 8\n    Dim i As Long, Progress As Long\n    Dim sClass1 As String\n    Dim sClass2 As String\n    Dim sClass3 As String\n\n    For i = startRow To n\n        Progress = ThisWorkbook.Worksheets(\"sheet1\").Range(\"B\" &amp; i).Value\n        ' Check progress and classify accordingly\n        If Progress &gt;= 90 Then\n            sClass3 = Progress\n        Else\n            sClass3 = \" \"\n        End If\n\n        If 50 &lt;= Progress And Progress &lt; 90 Then\n            sClass2 = Progress\n        Else\n            sClass2 = \" \"\n        End If\n\n        If Progress &lt; 50 Then\n            sClass1 = Progress\n        Else\n            sClass1 = \" \"\n        End If\n\n        ' Write out the class to column C to E\n        Worksheets(\"sheet1\").Range(\"C\" &amp; i).Value = sClass1\n        Worksheets(\"sheet1\").Range(\"D\" &amp; i).Value = sClass2\n        Worksheets(\"sheet1\").Range(\"E\" &amp; i).Value = sClass3\n    Next\nEnd Sub\n</code></pre>\n\n<p>Private Sub Createachart()</p>\n\n<pre><code>    Dim oChObj As ChartObject, rngSourceData As Range, ws As Worksheet\n\n    Set ws = Sheets(\"Sheet1\")\n\n    Set rngSourceData = ws.Range(\"C3:E8\")\n\n    Set oChObj = ws.ChartObjects.Add(Left:=ws.Columns(\"A\").Left,     \n    Width:=290, Top:=ws.Rows(8).Top, Height:=190)\n\n\n\n        With oChObj.Chart\n\n             .ChartType = xlColumnClustered\n\n             .SetSourceData Source:=rngSourceData, PlotBy:=xlColumns\n\n             .Axes(xlCategory).CategoryNames = ws.Range(\"A2:A8\")\n\n             .HasTitle = True\n        End With\n\n\n   End Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "report", "ms-access-2016", "subform"], "comments": [{"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1533805963, "post_id": 51756255, "comment_id": 90484907, "body": "This sounds like a design problem rather than a code fault. It sounds like you need a printed flag - could be a date field. Default value is null. After you print your report you update the DatePrinted to the current date and time. Your report only prints those records with a null DatePrinted."}], "answers": [{"tags": [], "owner": {"reputation": 2944, "user_id": 10095272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Shi9.jpg?s=128&g=1", "display_name": "Strawberryshrub", "link": "https://stackoverflow.com/users/10095272/strawberryshrub"}, "is_accepted": false, "score": 0, "last_activity_date": 1533877735, "creation_date": 1533877735, "answer_id": 51779327, "question_id": 51756255, "link": "https://stackoverflow.com/questions/51756255/ms-access-2016-set-reports-recordsource-to-get-data-from-a-subform/51779327#51779327", "title": "MS Access 2016: Set Report&#39;s RecordSource to get data from a Subform", "body": "<p>you can either send the recordsource to the report itself in the OpenArgs by the open report event, after the click event in the subform</p>\n\n<pre><code>Private Sub btnSubform_Click()\n\nDim strSQL as String\nstrSQL = \"SELECT * FROM SubformQuery WHERE ID = \" &amp; CurrentSubfromRecordID\nDocmd.OpenReport, acViewReport, , , , strSQL\n\nEnd Sub\n</code></pre>\n\n<p>and then in the Report.</p>\n\n<pre><code>Private Sub Report_Open(Cancel As Integer)\nMe.recordsource = Me.OpenArgs\nEnd Sub\n</code></pre>\n\n<p>Or you can make a paramter Query and set this Query criteria as record source for the report. So the parameter in the query is pointing to the current selected row in the subform. Like this:</p>\n\n<pre><code>--- At the Criteria in the Query designer:\n--- RecordSource for the Report:\nForms![FormMain]![YourSubform]![ID]\n</code></pre>\n\n<p>Now every time the reports obens he gets the ID from the current selected record of your subform.</p>\n"}], "owner": {"reputation": 11, "user_id": 10102437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54fc6f7c6622210f4a30fa64ff320bb7?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCloud", "link": "https://stackoverflow.com/users/10102437/crazycloud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 703, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594631001, "creation_date": 1533765696, "last_edit_date": 1594631001, "question_id": 51756255, "link": "https://stackoverflow.com/questions/51756255/ms-access-2016-set-reports-recordsource-to-get-data-from-a-subform", "title": "MS Access 2016: Set Report&#39;s RecordSource to get data from a Subform", "body": "<p>Is there some sort of work-around that could make this possible? Or could anyone offer just some general advice on my situation below? I tried to set the record source through VBA but had no luck. </p>\n\n<p>My situation:</p>\n\n<p>I have a main form with a subform contained within, and I want the subform to be purely for data entry (Data Entry = Yes). Upon clicking a button, the user is sent from the main form to a report (print preview only). I want the source for this report to be the subform the users are entering data into, but I don't have this option from the report's property sheet itself (no forms), and I also was unable to set it through VBA. Here's my code, it's one line so I highly doubt it's the problem. </p>\n\n<pre><code>Private Sub Report_Load()\n\n    Reports![P18003 SDR Report].RecordSource = \"P18003 SDR Subform\"\n\nEnd Sub\n</code></pre>\n\n<p>Previously, to work-around this I had a parameter query that waited for the user to enter data into an unbound textbox from the main form, and an after update trigger on that textbox would load any data relevant to that parameter (my employer and I miscommunicated the requirements). </p>\n\n<p>It turns out though that I don't need to load any older data, and I run into problems with my current parameter query in the event that the user does input a parameter which loads old data - that old data is transferred to the report in addition to the new data they've just entered. This is the main problem with the method I am currently using, and it trashes almost all functionality with this form and report. The events that a user would need to enter a parameter which queries older data are few and far between, but it's not a functional product unless I can get the subform to be connected to the report directly. There's likely something obvious I'm missing here (or at least, I hope there is). </p>\n\n<p>Thanks in advance for taking the time to read this and for any help you may offer.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1533765115, "post_id": 51756002, "comment_id": 90471847, "body": "What errors do you run into?. The first took the cokour of your borders, so that most likely is white/transparent."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1533775459, "post_id": 51756002, "comment_id": 90474234, "body": "<i>Welcome to <a href=\"https://stackoverflow.com\">Stack Overflow</a>!*</i> Check out the <a href=\"https://stackoverflow.com/tour\">tour</a> (you&#39;ll earn a badge!) and also <a href=\"https://stackoverflow.com/help/on-topic\">help center</a> for more information about what&#39;s on topic here.  Here&#39;s important info about <b>how to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a></b> and some other asking-tips to  get you started and help get your question some attention: see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; as well as tips <a href=\"//codeblog.jonskeet.uk/writing-the-perfect-question/\" rel=\"nofollow noreferrer\"><b>here</b></a> and <a href=\"//meta.stackoverflow.com/q/347937/\"><b>here</b></a> Plus, here&#39;s the <a href=\"//stackoverflow.com/editing-help\"><b>Formatting FAQ</b></a>."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1533796341, "last_edit_date": 1533796341, "creation_date": 1533796001, "answer_id": 51760157, "question_id": 51756002, "link": "https://stackoverflow.com/questions/51756002/excel-vba-color-data-labels-value-from-cells-according-to-the-font-of-the/51760157#51760157", "title": "Excel VBA - color data labels (&quot;value from cells&quot;) according to the font of the source", "body": "<p>If you're just missing the colors then you can format each label using something like:</p>\n\n<pre><code>Sub Tester()\n\n    Dim s As Series, dl As DataLabels, d As DataLabel\n    Dim i As Long, rngLabels\n\n    Set s = ActiveSheet.ChartObjects(1).Chart.SeriesCollection(1)\n\n    Set dl = s.DataLabels\n\n    'Option 1: set label color based on label value\n    For i = 1 To dl.Count\n        With dl(i)\n            .Font.Color = IIf(Val(.Text) &lt; 0, vbRed, vbGreen)\n        End With\n    Next i\n\n\n    'Option 2: set label color based on label source cell\n    '  Note use of DisplayFormat to pick up custom\n    '   formatting colors\n    Set rngLabels = Range(\"C7:C13\")'&lt;&lt; source range for data labels\n    For i = 1 To dl.Count\n        dl(i).Font.Color = rngLabels(i).DisplayFormat.Font.Color\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10198382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22685df8997b23a201203cf9c0db6c99?s=128&d=identicon&r=PG&f=1", "display_name": "Tommaso ", "link": "https://stackoverflow.com/users/10198382/tommaso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2917, "favorite_count": 0, "accepted_answer_id": 51760157, "answer_count": 1, "score": 1, "last_activity_date": 1533796341, "creation_date": 1533764294, "question_id": 51756002, "link": "https://stackoverflow.com/questions/51756002/excel-vba-color-data-labels-value-from-cells-according-to-the-font-of-the", "title": "Excel VBA - color data labels (&quot;value from cells&quot;) according to the font of the source", "body": "<p>I have to run many bar charts in excel 2016, each one showing the company performance over the seasons, for a certain country. On top of each bar I'd like to see the %Change in this format [Color10]0%\"\u25b2\";[Red] -0%\"\u25bc\". Reason why I added the data labels, and I used the function \"value from cells\" to show the %Change instead of the amount sold. Now everything is in place, and my percentages are nicely placed on top of the bars, but no way I can color them automatically (positive green and negative red). I tried formatting the labels directly from the format window placed under \"numbers\", but I discovered it doesn't work at all when the label content is derived using \"value from cells\". </p>\n\n<p>So I started looking into VBA, but since I'm pretty ignorant about programming, I didn't succeed. I'm looking for a code that changes the data labels of my chart so that they maintain the font of the source (in the source my %Change values are already in the desired format ([Color10]0%\"\u25b2\";[Red] -0%\"\u25bc\"). Googling I found different solutions but none worked. I'll post the ones I that look better to me.</p>\n\n<pre><code>Sub legend_color()\nDim SRS As Series\nWith ActiveChart\nFor Each SRS In .SeriesCollection\nSRS.ApplyDataLabels AutoText:=True, LegendKey:= _False, \nShowSeriesName:=False, \nShowCategoryName:=False, \nShowValue:=True, _ ShowPercentage:=False, \nShowBubbleSize:=False\nSRS.DataLabels.Font.ColorIndex = SRS.Border.ColorIndex\nNext SRS\nEnd With\nEnd Sub\n</code></pre>\n\n<p>This one was the only one that actually run, and colored my labels all white. With the following I run into errors. </p>\n\n<pre><code>    Sub color_labels()\n        Dim chartIterator As Integer, \n        pointIterator As Integer, _seriesArray() As Variant\n\n        For chartIterator = 1 To ActiveSheet.ChartObjects.Count\n              seriesArray=ActiveWorkbook.Sheets(\"Sheet1\").ChartObjects(chartIterator). _Chart.SeriesCollection(1).Values For pointIterator = 1 To UBound(seriesArray)\nIf seriesArray(pointIterator) &gt;= 0 Then\nActiveWorkbook.Sheets(\"Sheet1\").ChartObjects(chartIterator). _\nChart.SeriesCollection(1).Points(pointIterator).Interior.Color = _RGB(146, 208, 80)\nElse\nActiveWorkbook.Sheets(\"Sheet1\").ChartObjects(chartIterator). _Chart.SeriesCollection(1).Points(pointIterator).Interior.Color = _RGB(255, 0, 0)\nEnd If\nNext pointIterator\nNext chartIterator\nEnd Sub\n\n\nSub ArrowColour()\nDim ncars As Integer\nncars = Range(\"A1\").Value\nWith ActiveSheet.Shapes.Range(Array(\"Down Arrow 1\")).Fill\nIf ncars &gt; 0 Then\n\n.ForeColor.RGB = RGB(0, 176, 80)\n\nElse\n\n.ForeColor.RGB = RGB(255, 0, 0)\n\nEnd If\n\nEnd With\nEnd Sub\n\n\nOption Explicit\nSub ApplyCustomLabels()\nDim rLabels As Range\nDim rCell As Range\nDim oSeries As Series\nDim Cnt As Integer\nSet rLabels = Range(\"C2:C\" &amp; Cells(Rows.Count, \"C\").End(xlUp).Row)\nSet oSeries = ActiveSheet.ChartObjects(1).Chart.SeriesCollection(1)  \noSeries.HasDataLabels = True\nCnt = 1\nFor Each rCell In rLabels\nWith oSeries.Points(Cnt).DataLabel.Text = rCell.Value.Font.Color =rCell.Font.Color\nEnd With\nCnt = Cnt + 1\nNext rCell\nEnd Sub\n</code></pre>\n\n<p>Thank you very much in advance for all of your help,\nTommaso</p>\n"}, {"tags": ["vba", "ms-project"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 2, "creation_date": 1533763517, "post_id": 51755675, "comment_id": 90471295, "body": "What have you tried? What problems have you encountered? Please show us your code and what research you&#39;ve done so far."}, {"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 0, "creation_date": 1533769648, "post_id": 51755675, "comment_id": 90473071, "body": "Why don\u2019t you want to do that? Looping through tasks is extremely quick."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1533770001, "post_id": 51755675, "comment_id": 90473140, "body": "I know nothing about MS Project, but from the documentation it looks as simple as calling <a href=\"https://msdn.microsoft.com/en-us/VBA/Project-VBA/articles/task-successortasks-property-project\" rel=\"nofollow noreferrer\"><code>.SuccessorTasks</code></a>."}, {"owner": {"reputation": 312, "user_id": 8443777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2ebf81808b554568bde324e353ffe72?s=128&d=identicon&r=PG", "display_name": "joshhemphill", "link": "https://stackoverflow.com/users/8443777/joshhemphill"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1533778020, "post_id": 51755675, "comment_id": 90474695, "body": "@Comintern Calling <code>.SuccessorTasks</code> would just move me from 1 to 1.1 instead of 2. Or if there are specified predecessors and successors(Like there are in the projects I work with), it would jump me all over the place."}, {"owner": {"reputation": 312, "user_id": 8443777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2ebf81808b554568bde324e353ffe72?s=128&d=identicon&r=PG", "display_name": "joshhemphill", "link": "https://stackoverflow.com/users/8443777/joshhemphill"}, "reply_to_user": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 0, "creation_date": 1533778128, "post_id": 51755675, "comment_id": 90474718, "body": "@RachelHettinger I was just hoping there would be some built in function or property or something that would cut down the amount of code I need."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1533778141, "post_id": 51755675, "comment_id": 90474721, "body": "It&#39;s confirmed then. I know nothing about MS Project. :-D  Carry on."}], "answers": [{"comments": [{"owner": {"reputation": 312, "user_id": 8443777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2ebf81808b554568bde324e353ffe72?s=128&d=identicon&r=PG", "display_name": "joshhemphill", "link": "https://stackoverflow.com/users/8443777/joshhemphill"}, "edited": false, "score": 0, "creation_date": 1533823811, "post_id": 51768029, "comment_id": 90497080, "body": "Some of my projects have multiple sub-projects and all the milestones are stored at outline level 1. But thank you, this get&#39;s me a lot closer."}], "tags": [], "owner": {"reputation": 311, "user_id": 6845666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7121d86d37fa1c7568d6d2ce07d30b8?s=128&d=identicon&r=PG&f=1", "display_name": "Jerred S.", "link": "https://stackoverflow.com/users/6845666/jerred-s"}, "is_accepted": false, "score": 1, "last_activity_date": 1533820433, "creation_date": 1533820433, "answer_id": 51768029, "question_id": 51755675, "link": "https://stackoverflow.com/questions/51755675/simple-way-to-find-max-level-1-wbs-and-put-all-level-2-wbs-into-array/51768029#51768029", "title": "Simple way to find max level 1 WBS and put all Level 2 WBS into array?", "body": "<p>I'm not sure what you mean by \"I need the max WBS level 1\". Wouldn't this just be the first task in your project?.. i.e. <code>ActiveProject.Tasks.Item(1)</code></p>\n\n<p>As for level 2 tasks in an array: Take a look at the <code>.outlineLevel</code> property of the task. This property tells you if the task is WBS level 1, 2, 3, etc. </p>\n\n<p>See <a href=\"https://msdn.microsoft.com/en-us/vba/project-vba/articles/task-outlinelevel-property-project\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/project-vba/articles/task-outlinelevel-property-project</a> for further details</p>\n\n<p>As for \"dim my array with the correct rows/columns\": while you could use an array and either first figure out its size, or keep resizing it as you find more elements; another approach I'd suggest is use a data structure that you can add elements to. My top choice for this is the <code>Collection</code> data type. It is built-in and easy to use, but there are others available too that may be more appropriate for your situation. </p>\n\n<p>I think this snippet should do what your asking for:</p>\n\n<pre><code>Function getLevel2Tasks() As Collection\n    Dim t As Task\n    Dim level2Tasks As Collection\n    Set level2Tasks = New Collection\n    For Each t In ActiveProject.Tasks\n       If t.outlineLevel = 2 Then\n            level2Tasks.Add Item:=t\n        End If\n    Next\n    Set getLevel2Tasks = level2Tasks\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 9972600, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6P43_PxJYBk/AAAAAAAAAAI/AAAAAAAAwaU/BEexIRwNoWA/photo.jpg?sz=128", "display_name": "Cyril GUICHARD", "link": "https://stackoverflow.com/users/9972600/cyril-guichard"}, "is_accepted": false, "score": 1, "last_activity_date": 1533820725, "creation_date": 1533820725, "answer_id": 51768130, "question_id": 51755675, "link": "https://stackoverflow.com/questions/51755675/simple-way-to-find-max-level-1-wbs-and-put-all-level-2-wbs-into-array/51768130#51768130", "title": "Simple way to find max level 1 WBS and put all Level 2 WBS into array?", "body": "<p>Consider use <code>t.OutlineLevel</code> to sort them</p>\n"}, {"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 2, "last_activity_date": 1533913989, "last_edit_date": 1533913989, "creation_date": 1533822037, "answer_id": 51768626, "question_id": 51755675, "link": "https://stackoverflow.com/questions/51755675/simple-way-to-find-max-level-1-wbs-and-put-all-level-2-wbs-into-array/51768626#51768626", "title": "Simple way to find max level 1 WBS and put all Level 2 WBS into array?", "body": "<p>Unfortunately, you will have to loop to figure things out. MS Project doesn't allow you to pull in a set of fields (like all the WBSs) into an array without looping through everything. For this problem, you'll need to determine two different bits of information: what level WBS you're working with and how many levels of sub-tasks are underneath that given WBS.</p>\n\n<p>At the main program level, you'll need to run through ALL the tasks and determine the WBS level of each task. Once you get the level you want, then you can determine the number of sub-tasks.</p>\n\n<pre><code>Private Sub test()\n    With ThisProject\n        Dim i As Long\n        For i = 1 To .Tasks.count\n            Dim subWBSCount As Long\n            If .Tasks.Item(i).OutlineLevel = 2 Then\n                subWBSCount = GetSubWBSCount(.Tasks.Item(i).wbs, i)\n                Debug.Print \"At level 2 (\" &amp; .Tasks.Item(i).wbs &amp; _\n                            \") there are \" &amp; subWBSCount &amp; \" sub tasks\"\n                '-----------------------------------------------\n                '    you can properly dimension your array here,\n                '    then fill it with the sub-task information\n                '    as needed\n                '-----------------------------------------------\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p>When you need to count the sub-tasks under the level 2 WBS, it's easiest to break into a separate function to keep the logic straight. What it does it to start with the given task and work down, comparing each subsequent task's WBS \"prefix\" -- meaning if you're looking for sub-tasks under WBS 1.1, then when you see WBS 1.1.1 and 1.1.2, you need to really compare the \"1.1\" parts of each of them. Count until you run out of sub-tasks.</p>\n\n<pre><code>Private Function GetSubWBSCount(ByVal topWBS As String, ByVal wbsIndex As Long) As Long\n    '--- loop to find the given WBS, then determine how many\n    '    sub tasks lie under that WBS\n    With ThisProject\n        Dim j As Long\n        Dim count As Long\n        For j = (wbsIndex + 1) To .Tasks.count\n            Dim lastDotPos As Long\n            lastDotPos = InStrRev(.Tasks.Item(j).wbs, _\n                                  \".\", , vbTextCompare)\n            Dim wbsPrefix As String\n            wbsPrefix = Left$(.Tasks.Item(j).wbs, _\n                              lastDotPos - 1)\n            If wbsPrefix = topWBS Then\n                count = count + 1\n                '--- check for the edge case where this is\n                '    the very last task, and so our count is\n                '    finished\n                If j = .Tasks.count Then\n                    GetSubWBSCount = count\n                    Exit Function\n                End If\n            Else\n                '--- once we run out of sub-wbs tasks that\n                '    match, we're done\n                GetSubWBSCount = count\n                Exit Function\n            End If\n        Next j\n    End With\nEnd Function\n</code></pre>\n\n<p>Here's the whole test module:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub test()\n    With ThisProject\n        Dim i As Long\n        For i = 1 To .Tasks.count\n            Dim subWBSCount As Long\n            If .Tasks.Item(i).OutlineLevel = 2 Then\n                subWBSCount = GetSubWBSCount(.Tasks.Item(i).wbs, i)\n                Debug.Print \"At level 2 (\" &amp; .Tasks.Item(i).wbs &amp; _\n                            \") there are \" &amp; subWBSCount &amp; \" sub tasks\"\n                '-----------------------------------------------\n                '    you can properly dimension your array here,\n                '    then fill it with the sub-task information\n                '    as needed\n                '-----------------------------------------------\n            End If\n        Next i\n    End With\nEnd Sub\n\nPrivate Function GetSubWBSCount(ByVal topWBS As String, ByVal wbsIndex As Long) As Long\n    '--- loop to find the given WBS, then determine how many\n    '    sub tasks lie under that WBS\n    With ThisProject\n        Dim j As Long\n        Dim count As Long\n        For j = (wbsIndex + 1) To .Tasks.count\n            Dim lastDotPos As Long\n            lastDotPos = InStrRev(.Tasks.Item(j).wbs, _\n                                  \".\", , vbTextCompare)\n            Dim wbsPrefix As String\n            wbsPrefix = Left$(.Tasks.Item(j).wbs, _\n                              lastDotPos - 1)\n            If wbsPrefix = topWBS Then\n                count = count + 1\n                '--- check for the edge case where this is\n                '    the very last task, and so our count is\n                '    finished\n                If j = .Tasks.count Then\n                    GetSubWBSCount = count\n                    Exit Function\n                End If\n            Else\n                '--- once we run out of sub-wbs tasks that\n                '    match, we're done\n                GetSubWBSCount = count\n                Exit Function\n            End If\n        Next j\n    End With\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1533930528, "creation_date": 1533930528, "answer_id": 51793241, "question_id": 51755675, "link": "https://stackoverflow.com/questions/51755675/simple-way-to-find-max-level-1-wbs-and-put-all-level-2-wbs-into-array/51793241#51793241", "title": "Simple way to find max level 1 WBS and put all Level 2 WBS into array?", "body": "<p>This code finds the task with the highest WBS (e.g. maximum of first part of WBS code), and counts its subtasks based on the outline structure of the schedule.</p>\n\n<pre><code>Sub GetMaxWBSTaskInfo()\n\n    Dim MaxWBS As Integer\n    Dim tsk As Task\n    Dim MaxWbsTask As Task\n    Dim NumSubtasks As Integer\n\n    ' expand all subprojects so loop goes through all subproject tasks\n    Application.SelectAll\n    Application.OutlineShowAllTasks\n    Application.SelectBeginning\n\n    For Each tsk In ActiveProject.Tasks\n        If Split(tsk.WBS, \".\")(0) &gt; MaxWBS Then\n            MaxWBS = Split(tsk.WBS, \".\")(0)\n            Set MaxWbsTask = tsk\n        End If\n    Next\n\n    NumSubtasks = ChildCount(MaxWbsTask)\n    Debug.Print \"Max WBS level=\" &amp; MaxWBS, \"Task: \" &amp; MaxWbsTask.Name, \"# subtasks=\" &amp; NumSubtasks\n\nEnd Sub\n\nFunction ChildCount(tsk As Task) As Integer\n    Dim s As Task\n    Dim NumTasks As Integer\n    For Each s In tsk.OutlineChildren\n        NumTasks = NumTasks + 1 + ChildCount(s)\n    Next s\n    ChildCount = NumTasks\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 312, "user_id": 8443777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2ebf81808b554568bde324e353ffe72?s=128&d=identicon&r=PG", "display_name": "joshhemphill", "link": "https://stackoverflow.com/users/8443777/joshhemphill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 581, "favorite_count": 1, "accepted_answer_id": 51768626, "answer_count": 4, "score": 2, "last_activity_date": 1533930528, "creation_date": 1533762506, "last_edit_date": 1533764209, "question_id": 51755675, "link": "https://stackoverflow.com/questions/51755675/simple-way-to-find-max-level-1-wbs-and-put-all-level-2-wbs-into-array", "title": "Simple way to find max level 1 WBS and put all Level 2 WBS into array?", "body": "<p>I can't seem to find anything about how I might do this from the documentation. My question basically has it all. I need the max WBS level 1 value as an integer, and then to loop through all its level2 subtasks/summaries and put a couple of their values into an array. </p>\n\n<p>It would also be handy if I could get number of subtasks that belong to that summary before iterating so I could dim my array with the correct rows/columns and not have to transpose it after-the-fact.</p>\n\n<p>Any help or guidance would be appreciated, MS Project documentation is awful and the internet doesn't have much else on a lot of this.</p>\n\n<p>I Don't want to have to do this:</p>\n\n<pre><code>Dim TopVal As Integer\nFor Each t in ActiveProject.Tasks\n   Dim tVal As Integer\n   tVal = t.WBS.Split(\".\"c)(0)\n   If  tVal &gt; TopVal Then TopVal = tVal\nNext t\n</code></pre>\n"}, {"tags": ["excel", "vba", "duplicates"], "comments": [{"owner": {"reputation": 1684, "user_id": 4669135, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d9d4ff76c8827f4adfc6218ba952aefc?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Devillers", "link": "https://stackoverflow.com/users/4669135/gabriel-devillers"}, "edited": false, "score": 1, "creation_date": 1533762388, "post_id": 51755597, "comment_id": 90470921, "body": "Please rework the code sample to reduce it to only what is needed."}, {"owner": {"reputation": 1, "user_id": 10187880, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6daFHDIeGcg/AAAAAAAAAAI/AAAAAAAAAwc/kaZftwUjF-I/photo.jpg?sz=128", "display_name": "Steve Coryell", "link": "https://stackoverflow.com/users/10187880/steve-coryell"}, "reply_to_user": {"reputation": 1684, "user_id": 4669135, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d9d4ff76c8827f4adfc6218ba952aefc?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Devillers", "link": "https://stackoverflow.com/users/4669135/gabriel-devillers"}, "edited": false, "score": 0, "creation_date": 1533904345, "post_id": 51755597, "comment_id": 90530273, "body": "To be honest, this is the reduced code that I thought was relevant to try understanding what I was trying to do, haha.  This code currently works if someone searches with only &quot;or&quot; options. So if someone searches for &quot;Apples OR Pears OR Oranges&quot; than this code creates a new workbook, searches the data and copies over any rows that contain &quot;apples,&quot; then searches the data and copies over any rows that contain &quot;Pears&quot;, then &quot;oranges.&quot;  In the end, in code you don&#39;t see here, I delete all the duplicates... therefore outputting one copy of each row that contains either apples, pears, or oranges."}, {"owner": {"reputation": 1, "user_id": 10187880, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6daFHDIeGcg/AAAAAAAAAAI/AAAAAAAAAwc/kaZftwUjF-I/photo.jpg?sz=128", "display_name": "Steve Coryell", "link": "https://stackoverflow.com/users/10187880/steve-coryell"}, "reply_to_user": {"reputation": 1684, "user_id": 4669135, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d9d4ff76c8827f4adfc6218ba952aefc?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Devillers", "link": "https://stackoverflow.com/users/4669135/gabriel-devillers"}, "edited": false, "score": 0, "creation_date": 1533904452, "post_id": 51755597, "comment_id": 90530348, "body": "However, if someone wants to search for &quot;Apples AND Pears OR Oranges&quot; then I need nested within the For loop shown, code that will output all rows containing apples, then output all rows containing pears, then only keep the rows that were duplicated (therefore containing both apples and pears), then output all rows containing oranges."}, {"owner": {"reputation": 4644, "user_id": 1431720, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f5a1388d4d3b2bf03b11bb5658c68c29?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/1431720/robert"}, "edited": false, "score": 0, "creation_date": 1533940290, "post_id": 51755597, "comment_id": 90547085, "body": "Please <a href=\"https://stackoverflow.com/posts/51755597/edit\">edit</a> your question instead of adding comments. Not all comments may be shown initially. By putting all relevant information in one place you make it easier to help you. Consider trimming your code down to a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> --- cell formatting is just noise here."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10187880, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6daFHDIeGcg/AAAAAAAAAAI/AAAAAAAAAwc/kaZftwUjF-I/photo.jpg?sz=128", "display_name": "Steve Coryell", "link": "https://stackoverflow.com/users/10187880/steve-coryell"}, "edited": false, "score": 0, "creation_date": 1533904116, "post_id": 51757187, "comment_id": 90530120, "body": "Thanks! I will try this later."}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1533775320, "last_edit_date": 1533775320, "creation_date": 1533773013, "answer_id": 51757187, "question_id": 51755597, "link": "https://stackoverflow.com/questions/51755597/excel-vba-erase-all-rows-that-arent-duplicated/51757187#51757187", "title": "Excel VBA: Erase all rows that AREN&#39;T duplicated", "body": "<p>Here is a generic example of how to isolate cells that are duplicated in a range. You can use the <code>Range.Resize</code> method to extend the copy range when setting the <code>Duplicates</code> variable.</p>\n\n<p>In photo, <code>Column A</code> is the original data &amp; <code>Column B</code> is the macro output.</p>\n\n<p><a href=\"https://i.stack.imgur.com/m3OiW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/m3OiW.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Option Explicit\n\nSub Dups()\n\nDim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"Sheet1\")\nDim SearchRange As Range: Set SearchRange = ws.Range(\"A1:A6\")\nDim CurrentCell As Range, Duplicates As Range\n\nFor Each CurrentCell In SearchRange\n    If WorksheetFunction.CountIf(SearchRange, CurrentCell) &gt; 1 Then\n        If Not Duplicates Is Nothing Then\n            Set Duplicates = Union(Duplicates, CurrentCell)\n        Else\n            Set Duplicates = CurrentCell\n        End If\n    End If\nNext CurrentCell\n\nDuplicates.Copy ws.Range(\"B1\")\nws.Range(\"B:B\").RemoveDuplicates 1, xlNo\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10187880, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6daFHDIeGcg/AAAAAAAAAAI/AAAAAAAAAwc/kaZftwUjF-I/photo.jpg?sz=128", "display_name": "Steve Coryell", "link": "https://stackoverflow.com/users/10187880/steve-coryell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1533775320, "creation_date": 1533762076, "last_edit_date": 1533763972, "question_id": 51755597, "link": "https://stackoverflow.com/questions/51755597/excel-vba-erase-all-rows-that-arent-duplicated", "title": "Excel VBA: Erase all rows that AREN&#39;T duplicated", "body": "<p>vba novice here.  I wrote a program that creates a new Excel file and copies over several rows of data based on search terms entered by a user.  If the user is searching for more than one string of text, he/she can select \"or\" or \"and\" between each string. So, if a user enters \"Apples OR Pears\" the program will output any data that has apples or has pears.  If the user enters \"Apples AND pears\" the program will output any data that contains both apples and pears.  </p>\n\n<p>I've figured out how to remove duplicate rows, but I want to figure out how to do the OPPOSITE.  I'd like to remove any rows that DON'T have duplicates.  I'd like to keep one copy of the rows that are duplicated one or more times.  For instance, if I had a one-column row reading:</p>\n\n<pre><code>Apples\nOranges\nPears\nApples\nCherries\nPears\n</code></pre>\n\n<p>I'd want the macro to delete rows such that the new list just reads:</p>\n\n<pre><code>Apples\nPears\n</code></pre>\n\n<p>I'd prefer to run the macro in a way that doesn't require copying over to multiple sheets.  This is because the code I'm trying to figure out will be used within a For loop, which may get complicated running multiple times.</p>\n\n<p>Here's my code as it sits now. I've commented where I'd like to insert this section of code:</p>\n\n<pre><code>    Dim srchLen, myString As Integer\n    Dim nxtRw As Long\n    Dim firstAddress As String\n    Dim c As Range\n    Dim rng As Range\n    Dim SearchRange As Range\n    Dim wbSearchTool As Workbook\n    Dim wbSearchResults As Workbook\n\n    'Create and format a new workbook for search results\n    Set wbSearchTool = ThisWorkbook\n    Set wbSearchResults = Workbooks.Add(xlWBATWorksheet)\n    wbSearchResults.Sheets(\"Sheet1\").Range(\"B:C\").NumberFormat = \"mm/dd/yyyy\"\n    wbSearchResults.Sheets(\"Sheet1\").Range(\"B:R\").WrapText = True\n    wbSearchResults.Sheets(\"Sheet1\").Range(\"B:R\").HorizontalAlignment = xlLeft\n    wbSearchResults.Sheets(\"Sheet1\").Range(\"A1:R1\").Font.Bold = True\n    With wbSearchResults.Sheets(\"Sheet1\")\n        .Columns(\"A:F\").ColumnWidth = 10\n        .Columns(\"G\").ColumnWidth = 16.5\n        .Columns(\"H:I\").ColumnWidth = 35\n        .Columns(\"J:R\").ColumnWidth = 15\n    End With\n\n    'Copy Column Headings from Data\n     wbSearchResults.Sheets(\"Sheet1\").Rows(1) = wbSearchTool.Sheets(\"Data\").Rows(1).Value\n\n    'Determine length of Search Criteria Column from Search Sheet\n        wbSearchTool.Activate\n        srchLen = Sheets(\"Search\").Range(\"C2\").End(xlDown).Row\n\n    'Loop through list in Search, Column C. As each value is\n    'found in Data, Column F, copy it to the next row in Search Results\n\n        If srchLen = 3 Then\n        Else\n        For myString = 4 To srchLen\n            Set SearchRange = Sheets(\"Data\").Range(Sheets(\"Search\").Range(\"F\" &amp; myString).Value)\n            With SearchRange\n                Set c = .Find(Sheets(\"Search\").Range(\"C\" &amp; myString), lookat:=xlPart)\n                  If Not c Is Nothing Then\n                   firstAddress = c.Address\n                    Do\n                      nxtRw = wbSearchResults.Sheets(\"Sheet1\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n                      wbSearchResults.Sheets(\"Sheet1\").Range(\"A\" &amp; nxtRw &amp; \":R\" &amp; nxtRw) = wbSearchTool.Sheets(\"Data\").Range(\"A\" &amp; c.Row &amp; \":R\" &amp; c.Row).Value\n                      Set c = .FindNext(c)\n                    Loop While Not c Is Nothing And c.Address &lt;&gt; firstAddress\n                  End If\n            End With\n\n            'THIS IS WHERE I WANT CODE TO ONLY KEEP DUPLICATES!!!\n\n        Next\n        End If\n</code></pre>\n"}, {"tags": ["excel", "vba", "solidworks"], "comments": [{"owner": {"reputation": 134, "user_id": 3286402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e02bb2c3902a05ceaefb099523f564?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan.s", "link": "https://stackoverflow.com/users/3286402/ivan-s"}, "edited": false, "score": 0, "creation_date": 1568273702, "post_id": 51755422, "comment_id": 102223953, "body": "see this <a href=\"https://stackoverflow.com/questions/57541047/how-to-open-solidworks-run-macro-and-close-solidworks-from-vb-net-script\">questions</a>"}, {"owner": {"reputation": 134, "user_id": 3286402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e02bb2c3902a05ceaefb099523f564?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan.s", "link": "https://stackoverflow.com/users/3286402/ivan-s"}, "edited": false, "score": 0, "creation_date": 1568274311, "post_id": 51755422, "comment_id": 102224273, "body": "and <a href=\"https://forum.solidworks.com/message/663391#comment-663391\" rel=\"nofollow noreferrer\">this</a>"}], "answers": [{"tags": [], "owner": {"reputation": 345, "user_id": 12414707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rp2Qh.png?s=128&g=1", "display_name": "Sinue", "link": "https://stackoverflow.com/users/12414707/sinue"}, "is_accepted": false, "score": 0, "last_activity_date": 1574423665, "last_edit_date": 1574423665, "creation_date": 1574423146, "answer_id": 58993635, "question_id": 51755422, "link": "https://stackoverflow.com/questions/51755422/edrawings-api-via-excel/58993635#58993635", "title": "eDrawings API via Excel", "body": "<blockquote>\n  <p>Also, do I need a user form for this or did I misunderstand?</p>\n</blockquote>\n\n<p>Yes the eDrawings API is an OLE programming interface to eDrawings and is implemented as a Microsoft ActiveX control. </p>\n\n<p>So you have to place the ActiveX control on your form and access the api through this control:</p>\n\n<pre><code>Me.EModelViewControl1.OpenDoc path_to_edrawings_file, False, False, False, \"\"\n</code></pre>\n\n<p>It is not possible to start a new instance or connect to a running instance as you may know from the SOLIDWORKS API.</p>\n"}], "owner": {"reputation": 35, "user_id": 8564888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da7bdf2701f4a6b60fda4406c11f77f1?s=128&d=identicon&r=PG&f=1", "display_name": "FFS88", "link": "https://stackoverflow.com/users/8564888/ffs88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 617, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1593589925, "creation_date": 1533761314, "last_edit_date": 1593589925, "question_id": 51755422, "link": "https://stackoverflow.com/questions/51755422/edrawings-api-via-excel", "title": "eDrawings API via Excel", "body": "<p>I am attempting to use the edrawings VBA api via excel. I have downloaded the edrawings SDK and it seems as though the api only runs through a user form. I have made a few vba macros for solidworks via excel but unlike solidworks there is very limited documentation. I simply want to make a connection to the API, after which I should be able to take it from there.</p>\n\n<p>For right now I would simply like to open up a solidworks drawing in edrawings via excel. So something like the following:</p>\n\n<pre><code>Sub OpenDrawing()\n\nDim xlBook As Workbook\nDim xlsheet As Worksheet\nDim eDraw As New EModelViewControl\nDim FilePath As String\n\nSet xlBook = ActiveWorkbook\nSet xlsheet = xlBook.Sheets(1)\n\nFilePath = Range(\"B1\").Value\n\neDraw.OpenDoc FilePath, False, False, True, \"\"\n\nEnd Sub\n</code></pre>\n\n<p>As an example, Range B1 is the following \"C:\\ _EngVault\\000S\\090\\090-40400-01.SLDDRW\". I have activated the EModelView2018 Type Library and running edrawings 2018. Again, once I can figure out how to connect to the program I should be good but I am unable to make it that far. </p>\n\n<p>Also, do I need a user form for this or did I misunderstand? </p>\n\n<p>Thank you in advance,</p>\n\n<p>FFS88</p>\n"}, {"tags": ["excel", "vba", "sap-gui"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1533760794, "post_id": 51755214, "comment_id": 90470262, "body": "I believe there is a Do Until progress bar complete you&#39;re supposed to add, where you wait 1 second, then it rechecks the progress bar.  Here is the closest thing I can currently find: <a href=\"https://www.ozgrid.com/forum/forum/help-forums/excel-general/123713-wait-until-file-loads\" rel=\"nofollow noreferrer\">ozgrid.com/forum/forum/help-forums/excel-general/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": false, "score": 0, "last_activity_date": 1533764619, "creation_date": 1533764619, "answer_id": 51756050, "question_id": 51755214, "link": "https://stackoverflow.com/questions/51755214/sap-gui-export-automatically-opens-excel/51756050#51756050", "title": "SAP GUI export automatically opens excel", "body": "<p>I had the same issue time ago when my macro had to wait for a .txt to be created and then continue so I found this:</p>\n\n<pre><code>Dim Directory As String, File As String\nDirectory = ActiveWorkbook.Path &amp; \"\\\" 'path for the file\nFile = Directory &amp; \"datos.txt\" 'name of the file along with the path\n\n\n  FindIt = Dir(File)\n  While Len(FindIt) = 0\n  FindIt = Dir(File)\n  Wend\n</code></pre>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 1, "user_id": 10199884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91554cba363e51039ff35c83c66799c2?s=128&d=identicon&r=PG&f=1", "display_name": "Will H", "link": "https://stackoverflow.com/users/10199884/will-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2879, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1610304240, "creation_date": 1533760386, "last_edit_date": 1610304240, "question_id": 51755214, "link": "https://stackoverflow.com/questions/51755214/sap-gui-export-automatically-opens-excel", "title": "SAP GUI export automatically opens excel", "body": "<p>I am trying to write a macro that retrieves data from an ALV grid in SAP GUI. Everything is working fine up until the data exports. When exporting data from ALV grid to an .xlsx file, the file will automatically open after it exports.</p>\n<p>I need my script to wait for the export to open, and then copy the data from the newly opened export file to the .xlsm file that the script is coming from.</p>\n<p>If I try to activate the export.XLSX file immediately following the command to export the file in SAP GUI, I get a &quot;subscript out of range&quot; error. I thought maybe I could loop the activate command until it stops erroring (while the export.xlsx file is opening) but that causes excel to crash. What should I do?</p>\n<pre><code>Function funcLSAT(strEnv)\n\nDim wkbExport As Workbook\nDim strError As String\n\nIf Not IsObject(SapGuiApp) Then\n    Set SapGuiApp = CreateObject(&quot;Sapgui.ScriptingCtrl.1&quot;)\nEnd If\nIf Not IsObject(Connection) Then\n    Set Connection = SapGuiApp.OpenConnection(strEnv, True)\nEnd If\n    \nSet session = Connection.Children(0)\nsession.findById(&quot;wnd[0]/tbar[0]/okcd&quot;).Text = &quot;[TCODE]&quot;\nsession.findById(&quot;wnd[0]&quot;).sendVKey 0\nsession.findById(&quot;wnd[0]/tbar[1]/btn[8]&quot;).press\nsession.findById(&quot;wnd[0]/tbar[1]/btn[8]&quot;).press\nsession.findById(&quot;wnd[0]/usr/cntlG_CC_MCOUNTY/shellcont/shell&quot;).pressToolbarContextButton &quot;&amp;MB_EXPORT&quot;\nsession.findById(&quot;wnd[0]/usr/cntlG_CC_MCOUNTY/shellcont/shell&quot;).selectContextMenuItem &quot;&amp;XXL&quot;\nsession.findById(&quot;wnd[1]/usr/ctxtDY_PATH&quot;).Text = &quot;[filepath]&quot;\nsession.findById(&quot;wnd[1]/usr/ctxtDY_FILENAME&quot;).Text = &quot;export.xlsx&quot;\nsession.findById(&quot;wnd[1]/tbar[0]/btn[11]&quot;).press\nSet session = Nothing\nSet Connection = Nothing\nSet SapGuiApp = Nothing\n\nDo\nOn Error Resume Next\nWindows(&quot;export.XLSX&quot;).Activate\nLoop Until (Err.Number = 0)\nOn Error GoTo 0\n\nRange(&quot;A2:AS2&quot;).Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Copy\n\nEnd Function\n</code></pre>\n"}, {"tags": ["regex", "vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1533759153, "post_id": 51754778, "comment_id": 90469407, "body": "Is there always a date right before your first 9 character string? Does the second string always come two strings after your first string? More examples, please."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1533759879, "post_id": 51754778, "comment_id": 90469778, "body": "Are the symbols <b>always</b> 9 characters and are the <b>only</b> 9-character symbol in the text? What are the rules that define how a symbol can be identified in a text string?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1533760370, "post_id": 51754778, "comment_id": 90470045, "body": "So special characters can be included in the 9 count? e.g. * or ( or % ? Is there a defined set of &quot;special&quot; characters? You say words at one point and symbols at another."}, {"owner": {"reputation": 3, "user_id": 10199714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4140cc654b9cf77606726d6db82303db?s=128&d=identicon&r=PG&f=1", "display_name": "samadam", "link": "https://stackoverflow.com/users/10199714/samadam"}, "edited": false, "score": 0, "creation_date": 1533764015, "post_id": 51754778, "comment_id": 90471460, "body": "Sorry, to clarify: the 9 character string can be anywhere, there is no rule what is before or after them, they can be next to each other, or just at the beginning and end of this wall of text, no rules here, the text is random, taken out of some system, can contain dates, etc anything... The symbols are always 9 characters long and they are not the only 9 character symbols in the text. I call them symbols but they should only consist of numbers and letters. Can be only numbers, but never only letters. Hope that helps."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10199714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4140cc654b9cf77606726d6db82303db?s=128&d=identicon&r=PG&f=1", "display_name": "samadam", "link": "https://stackoverflow.com/users/10199714/samadam"}, "edited": false, "score": 0, "creation_date": 1533764617, "post_id": 51755219, "comment_id": 90471671, "body": "Thanks but that did not work.  Tried running it with the below example in A1: 10/01/2016     1,060X     8.999%!!!     1.33     0.666   928888XE0  Got nothing. There are multiple spaces between the words and numbers"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "reply_to_user": {"reputation": 3, "user_id": 10199714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4140cc654b9cf77606726d6db82303db?s=128&d=identicon&r=PG&f=1", "display_name": "samadam", "link": "https://stackoverflow.com/users/10199714/samadam"}, "edited": false, "score": 0, "creation_date": 1533765620, "post_id": 51755219, "comment_id": 90472009, "body": "What is the expected output? You have to put more examples with the desired output. The code will be the same with just changing the pattern of the regex"}, {"owner": {"reputation": 3, "user_id": 10199714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4140cc654b9cf77606726d6db82303db?s=128&d=identicon&r=PG&f=1", "display_name": "samadam", "link": "https://stackoverflow.com/users/10199714/samadam"}, "edited": false, "score": 0, "creation_date": 1533843245, "post_id": 51755219, "comment_id": 90507806, "body": "Yes! That looks very good, thank you! Still got two minor issues: When there is more than one result for example in A1, they each go seperately to B1, then C1, then D1 instead of B1 &gt; B2 &gt; B3. And then I&#39;d like to have no blanks in B column when there&#39;s no hit, just the next result from another row if possible? Thanks again!"}, {"owner": {"reputation": 3, "user_id": 10199714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4140cc654b9cf77606726d6db82303db?s=128&d=identicon&r=PG&f=1", "display_name": "samadam", "link": "https://stackoverflow.com/users/10199714/samadam"}, "edited": false, "score": 0, "creation_date": 1533931220, "post_id": 51755219, "comment_id": 90544246, "body": "Test2 has just one correct output in B1 and that&#39;s all, it stops there  so it&#39;s not working."}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "reply_to_user": {"reputation": 3, "user_id": 10199714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4140cc654b9cf77606726d6db82303db?s=128&d=identicon&r=PG&f=1", "display_name": "samadam", "link": "https://stackoverflow.com/users/10199714/samadam"}, "edited": false, "score": 0, "creation_date": 1533961476, "post_id": 51755219, "comment_id": 90550030, "body": "I tested on your examples and I could extract all the correct results .. Working for me. Please put some snapshots of the input and output after executing the code"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "reply_to_user": {"reputation": 3, "user_id": 10199714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4140cc654b9cf77606726d6db82303db?s=128&d=identicon&r=PG&f=1", "display_name": "samadam", "link": "https://stackoverflow.com/users/10199714/samadam"}, "edited": false, "score": 0, "creation_date": 1533961562, "post_id": 51755219, "comment_id": 90550038, "body": "You have to put all your input in A1 if you will deal with Test2"}, {"owner": {"reputation": 3, "user_id": 10199714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4140cc654b9cf77606726d6db82303db?s=128&d=identicon&r=PG&f=1", "display_name": "samadam", "link": "https://stackoverflow.com/users/10199714/samadam"}, "edited": false, "score": 0, "creation_date": 1534016404, "post_id": 51755219, "comment_id": 90562449, "body": "You are correct, thank you. Is there a possibility of combining Test1 and Test2? Input in multiple A cells, output only in B cells, one under the other?"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "reply_to_user": {"reputation": 3, "user_id": 10199714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4140cc654b9cf77606726d6db82303db?s=128&d=identicon&r=PG&f=1", "display_name": "samadam", "link": "https://stackoverflow.com/users/10199714/samadam"}, "edited": false, "score": 0, "creation_date": 1534027011, "post_id": 51755219, "comment_id": 90564485, "body": "I have updated the code to suit your needs .. I didn&#39;t get a point for all these changes :)"}, {"owner": {"reputation": 3, "user_id": 10199714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4140cc654b9cf77606726d6db82303db?s=128&d=identicon&r=PG&f=1", "display_name": "samadam", "link": "https://stackoverflow.com/users/10199714/samadam"}, "edited": false, "score": 0, "creation_date": 1534188300, "post_id": 51755219, "comment_id": 90612922, "body": "Works like a charm, thank you! I do not have enough reputation to have my votes publicly displayed but it should be recorded, thank you once again! :)"}], "tags": [], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "is_accepted": true, "score": 0, "last_activity_date": 1534026970, "last_edit_date": 1534026970, "creation_date": 1533760392, "answer_id": 51755219, "question_id": 51754778, "link": "https://stackoverflow.com/questions/51754778/extracting-specific-words-from-a-single-cell-containing-text-string/51755219#51755219", "title": "Extracting specific words from a single cell containing text string", "body": "<p>Try this code</p>\n\n<pre><code>Sub Test()\nDim r           As Range\nDim i           As Long\nDim m           As Long\n\nWith CreateObject(\"VBScript.RegExp\")\n    .Global = True\n    .Pattern = \"\\b[a-zA-Z\\d]{9}\\b\"\n\n    For Each r In Range(\"A1\", Range(\"A\" &amp; Rows.Count).End(xlUp))\n        If .Test(r.Value) Then\n            For i = 0 To .Execute(r.Value).Count - 1\n                If CBool(.Execute(r.Value)(i) Like \"*[0-9]*\") Then\n                    m = IIf(Cells(1, 2).Value = \"\", 1, Cells(Rows.Count, 2).End(xlUp).Row + 1)\n                    Cells(m, 2).Value = .Execute(r.Value)(i)\n                End If\n            Next i\n        End If\n    Next r\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": false, "score": 0, "last_activity_date": 1533766638, "creation_date": 1533766638, "answer_id": 51756422, "question_id": 51754778, "link": "https://stackoverflow.com/questions/51754778/extracting-specific-words-from-a-single-cell-containing-text-string/51756422#51756422", "title": "Extracting specific words from a single cell containing text string", "body": "<p>This bit of code is almost it... just need to check the strings... but excel crashes on the Str line of code</p>\n\n<pre><code>Sub Test()\n    Dim Outputs, i As Integer, LastRow As Long, Prueba, Prueba2\n    Outputs = Split(Range(\"A1\"), \" \")\n    For i = 0 To UBound(Outputs)\n        If Len(Outputs(i)) = 9 Then\n            Prueba = 0\n            Prueba2 = 0\n            On Error Resume Next\n            Prueba = Val(Outputs(i))\n            Prueba2 = Str(Outputs(i))\n            On Error GoTo 0\n            If Prueba &lt;&gt; 0 And Prueba2 &lt;&gt; 0 Then\n                LastRow = Range(\"B10000\").End(xlUp).Row + 1\n                Cells(LastRow, 2) = Outputs(i)\n            End If\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>If someone could help to set the string check.. that would do the thing I guess.</p>\n"}], "owner": {"reputation": 3, "user_id": 10199714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4140cc654b9cf77606726d6db82303db?s=128&d=identicon&r=PG&f=1", "display_name": "samadam", "link": "https://stackoverflow.com/users/10199714/samadam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "accepted_answer_id": 51755219, "answer_count": 2, "score": -1, "last_activity_date": 1534026970, "creation_date": 1533758661, "last_edit_date": 1533843805, "question_id": 51754778, "link": "https://stackoverflow.com/questions/51754778/extracting-specific-words-from-a-single-cell-containing-text-string", "title": "Extracting specific words from a single cell containing text string", "body": "<p>Basically I have a very long text containing multiple spaces, special characters, etc. in one cell in an excel file and I need to extract only specific words from it, each one to a seperate cell in another column.</p>\n\n<p>What I'm looing for:\nsymbols that are always 9 characters in lenght, and always contain at least one number (up to 9).</p>\n\n<p>So for an example in A1 I have:</p>\n\n<pre><code> euhe: djj33 dkdakofja.   kaowdk ---------- jffjbrjjjj j jrjj 08/01/2222 999ABC123   \n fjfjfj 321XXX888 .... ........ 123456789AA\n</code></pre>\n\n<p>And in the end I want to have:</p>\n\n<pre><code>999ABC123 in B1\n</code></pre>\n\n<p>and</p>\n\n<pre><code>321XXX888 in B2.\n</code></pre>\n\n<p>Right now I'm doing this by using Text to columns feature and then just looking for specific words manually but sometimes the volume is so big it takes too much time and would be cool to automate this.</p>\n\n<p>Can anyone help with this? Thank you!</p>\n\n<p>EDIT:\nMore examples:</p>\n\n<pre><code>INPUT: '10/01/2016 1,060X 8.999%!!! 1.33 0.666 928888XE0'\nOUTPUT: '928888XE0'\n\nINPUT: 'ABCDEBATX ..... ,,00,001% 20///^^ addcA7 7777a 123456789 djaoij8888888 0.000001 12@'\nOUTPUT: '123456789'\n\nINPUT: 'FAR687465 B22222222 __ djj^66 20/20/20/20 1:'\nOUTPUT: 'FAR687465' in B1 'B22222222' in B2\n\nINPUT: 'fil476 .00 20/.. BUT AAAAAAAAA k98776 000.0001'\nOUTPUT: 'blank'\n</code></pre>\n\n<p>To clarify: the 9 character string can be anywhere, there is no rule what is before or after them, they can be next to each other, or just at the beginning and end of this wall of text, no rules here, the text is random, taken out of some system, can contain dates, etc anything... The symbols are always 9 characters long and they are not the only 9 character symbols in the text. I call them symbols but they should only consist of numbers and letters. Can be only numbers, but never only letters. A1 cell can contain multiple spaces/tabs between words/symbols.</p>\n\n<p>Also if possible to do this not only for A1, but the whole column A until it finds the first blank cell.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1533757985, "post_id": 51754444, "comment_id": 90468846, "body": "Eh... Have you tried <code>total = Text1.Value + Text2.Value + Text3.Value</code>? That seems the most obvious way to me."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1533758826, "post_id": 51754444, "comment_id": 90469249, "body": "Here&#39;s a tutorial from Microsoft you could check out: <a href=\"https://support.office.com/article/introduction-to-expressions-5cad6e24-65a3-4a95-82cc-92b4b1bd4b8b\" rel=\"nofollow noreferrer\"><b>&quot;Introduction to expressions&quot;</b></a>."}, {"owner": {"reputation": 19, "user_id": 10101740, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156614529818530/picture?type=large", "display_name": "Mecredes BZ", "link": "https://stackoverflow.com/users/10101740/mecredes-bz"}, "edited": false, "score": 0, "creation_date": 1533759948, "post_id": 51754444, "comment_id": 90469815, "body": "eh yes I have, it did not work."}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1533758442, "creation_date": 1533758442, "answer_id": 51754732, "question_id": 51754444, "link": "https://stackoverflow.com/questions/51754444/adding-up-values-in-text-boxes-of-ms-access-form/51754732#51754732", "title": "Adding up values in text boxes of MS Access form", "body": "<p>specify the <em>ControlSource</em> of the Total textbox like this:</p>\n\n<pre><code>=[Text1]+[Text2]+[Text3]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1533790558, "post_id": 51755206, "comment_id": 90477295, "body": "the safest way +1"}], "tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 2, "last_activity_date": 1533760343, "creation_date": 1533760343, "answer_id": 51755206, "question_id": 51754444, "link": "https://stackoverflow.com/questions/51754444/adding-up-values-in-text-boxes-of-ms-access-form/51755206#51755206", "title": "Adding up values in text boxes of MS Access form", "body": "<pre><code>total = Nz([Text1],0) + Nz([Text2],0) + Nz([Text3],0)\n</code></pre>\n\n<p>You have to check for each individual textbox to not be null. If they are not locked to only allow numbers you also need validation for non-numerical input.</p>\n"}], "owner": {"reputation": 19, "user_id": 10101740, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156614529818530/picture?type=large", "display_name": "Mecredes BZ", "link": "https://stackoverflow.com/users/10101740/mecredes-bz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 717, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1533760343, "creation_date": 1533757223, "last_edit_date": 1533757936, "question_id": 51754444, "link": "https://stackoverflow.com/questions/51754444/adding-up-values-in-text-boxes-of-ms-access-form", "title": "Adding up values in text boxes of MS Access form", "body": "<p>I have a form in access that has several text boxes <code>(text1, text2, text3)</code> with different numbers.</p>\n\n<p>I want to be able sum all the values of the text boxes and display the total on a \"total\" text box.</p>\n\n<p>I have tried </p>\n\n<pre><code>total = Text1.Value + Text2.Value = Text3.Value\n</code></pre>\n\n<p>it did not work.</p>\n\n<p>I have also tried</p>\n\n<pre><code>total = Nz(Sum([Text1,Text2,Text3]), 0)\n</code></pre>\n\n<p>and it also does not work.</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1533758181, "post_id": 51754424, "comment_id": 90468942, "body": "<i>y &lt;= &quot;015&quot;</i>? What is it?"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1533758287, "post_id": 51754424, "comment_id": 90468993, "body": "Moreover, in a loop you&#39;re always assigning values to the <i>same</i> range. Is it OK?"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1533758290, "post_id": 51754424, "comment_id": 90468994, "body": "each text box ends with a number 001 through 1xx and i forgot to remove the &quot; &quot; around that value."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1533758454, "post_id": 51754424, "comment_id": 90469066, "body": "what im hoping to accomplish is the value of the textboxs&#39; name that start with &quot;co&quot; and end in 1 through 15 will transfer the value to that first range of cells.  Forgive me if im not explaining it very well im still very new to VBA."}], "answers": [{"comments": [{"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1533759817, "post_id": 51754749, "comment_id": 90469747, "body": "that worked perfectly.  Would you mind explaining what the [0-1][0-5] means?"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1533760415, "post_id": 51754749, "comment_id": 90470067, "body": "Thank you very much @JohnyL.  This was a great help and will be  very useful for the rest of this project i am working on."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1533796682, "post_id": 51754749, "comment_id": 90479631, "body": "@ZackE You&#39;re welcome! :) You could use regular expressions, of course, but Like can handle this case with a breeze."}], "tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": true, "score": 0, "last_activity_date": 1533760010, "last_edit_date": 1533760010, "creation_date": 1533758537, "answer_id": 51754749, "question_id": 51754424, "link": "https://stackoverflow.com/questions/51754424/vba-loop-through-textboxes-then-place-values-in-a-range-of-cells/51754749#51754749", "title": "vba loop through textboxes then place values in a range of cells", "body": "<p>You should check the name of text box this way:</p>\n\n<pre><code>If c.Name Like \"co*0[0-1][0-5]\" Then...\n</code></pre>\n\n<h3>Explanation:</h3>\n\n<ul>\n<li><strong>co</strong> - matches 'co' literally</li>\n<li><strong>*</strong> - matches any number of any characters</li>\n<li><strong>0</strong> - matches zero</li>\n<li><strong>[0-1]</strong> - matches digit in a range from 0 to 1</li>\n<li><strong>[0-5]</strong> - matches digit in a range from 0 to 5</li>\n</ul>\n"}], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 928, "favorite_count": 0, "accepted_answer_id": 51754749, "answer_count": 1, "score": 0, "last_activity_date": 1533760010, "creation_date": 1533757100, "last_edit_date": 1533757959, "question_id": 51754424, "link": "https://stackoverflow.com/questions/51754424/vba-loop-through-textboxes-then-place-values-in-a-range-of-cells", "title": "vba loop through textboxes then place values in a range of cells", "body": "<p>I have another newbie scenario regarding loops and TextBox in UserForms.</p>\n\n<p>Here is what i am trying to accomplish when the \"Save\" CommandButton is clicked.</p>\n\n<ol>\n<li>A loop runs through each text box that name starts with \"co\" and ends in a number 1-15.</li>\n<li>If there is a value in that text box the code adds that value to the first cell in a specified range then moves onto the next textbox and cell.</li>\n</ol>\n\n<p>Below is an image of the worksheet with cell ranges and also the userform.</p>\n\n<p>WS and UserForm\n<img src=\"https://i.stack.imgur.com/ECmqW.gif\" alt=\"\"></p>\n\n<p>Am i on the right track with the code I have started? or is there a more efficient way to do this without a loop?  Thank you in advance for your assistance with this.</p>\n\n<pre><code>Private Sub SandCont_Click()\n    Dim wb As Workbook\n    Dim wsJHA As Worksheet\n    Dim wsRange1b As Range\n    Dim wsRange1c As Range\n    Dim wsRange2 As Range\n    Dim wsRange3 As Range\n    Dim wsRange4 As Range\n    Dim wsRange5 As Range\n    Dim wsRange6 As Range\n    Dim wsRange7 As Range\n    Dim wsRange8 As Range\n    Dim wsRange9 As Range\n    Dim wsRange10 As Range\n    Dim c As Control\n    Dim i As Integer    'used to loop through cells in ranges listed below???\n    Dim x As String     'will be first two characters of textbox name\n    Dim y As String     'will be last character of textbox name\n    Dim z As Integer    'used to loop through textboxes on userform???\n\n    Set wb = Application.ThisWorkbook\n    Set wsJHA = wb.Sheets(\"JHA Keying\")\n    Set wsRange1b = wsJHA.Range(\"B4:B11\")\n    Set wsRange1c = wsJHA.Range(\"C4:C11\")\n\n\n    For Each c In Me.Controls\n        If TypeName(c) = \"TextBox\" Then\n            x = Left(c.Name, 2)\n            y = Right(c.Name, 3)\n            If x = \"co\" And y &lt;= \"015\" Then\n                wsRange1b.Value = c.Value\n            End If\n        End If\n    Next c\n\n'    Application.ThisWorkbook.Save\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "list", "ms-access", "filter"], "answers": [{"tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": true, "score": 1, "last_activity_date": 1533755179, "last_edit_date": 1533755179, "creation_date": 1533754820, "answer_id": 51753899, "question_id": 51753882, "link": "https://stackoverflow.com/questions/51753882/multi-select-with-listbox-microsoft-access/51753899#51753899", "title": "Multi select with listbox Microsoft Access", "body": "<pre><code>strSearch = strSearch &amp; \",'\" &amp; Me!LstMatricule.ItemData(varltem) &amp; \"'\"\n</code></pre>\n\n<p>It is difficult to see but basically I added single quotes around each varItem. You want the result to look like this:</p>\n\n<pre><code>strSearch = \"'52185A', '515674B'\"\n</code></pre>\n\n<p>Personally I would do this:</p>\n\n<pre><code>strSearch = strSearch &amp; IIf(Len(strSearch) = 0, \"\", \",\") &amp; \"'\" &amp; Me!LstMatricule.ItemData(varltem) &amp; \"'\"\n</code></pre>\n\n<p>It is slightly more expensive computationally if you have more than 2-3 IDs to add but cleaner than removing the starting comma at the beginning later on.</p>\n"}], "owner": {"reputation": 7, "user_id": 9048936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b69ee66f6b0871d7aea873e75b6e788?s=128&d=identicon&r=PG&f=1", "display_name": "Misen", "link": "https://stackoverflow.com/users/9048936/misen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 51753899, "answer_count": 1, "score": 0, "last_activity_date": 1533757921, "creation_date": 1533754724, "last_edit_date": 1533757921, "question_id": 51753882, "link": "https://stackoverflow.com/questions/51753882/multi-select-with-listbox-microsoft-access", "title": "Multi select with listbox Microsoft Access", "body": "<p>I'm trying to filter a splitform with a listbox but I keep getting the error '3075'.</p>\n\n<p>I used the debug tool and I got: </p>\n\n<p>strSearch = \"52185A, 515674B\"</p>\n\n<p>Task = \"select * from tOrder where ([OrderID] in (52185A,515674B))\"</p>\n\n<p>I'm pretty sure I'm missing some quotations, however I couldn't seem to figure out where. They're all short text format.</p>\n\n<pre><code>Option Compare Database\n\nPrivate Sub cmdSearch_Click() \nDim varltem As Variant \nDim strSearch  As String \nDim Task As String\n\nFor Each varltem In Me!LstMatricule.ItemsSelected \n   strSearch = strSearch &amp; \",\" &amp; Me!LstMatricule.ItemData(varltem) \nNext varltem\nIf Len(strSearch) = 0 Then \n   Task = \"select * from tOrder\" \nElse \n   strSearch = Right(strSearch, Len(strSearch) - 1) \n   Task = \"select * from tOrder where ((OrderID] in (\" &amp; strSearch &amp; \"))\" \nEnd If \nDoCmd.ApplyFilter Task \n\nEnd Sub \n</code></pre>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1533754576, "post_id": 51753659, "comment_id": 90467407, "body": "What version of Excel is this, and does a new <code>UserForm</code> on a new workbook behave the same way?"}, {"owner": {"reputation": 407, "user_id": 2731076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c897b26495c3b19cc1901a9e8ce05e81?s=128&d=identicon&r=PG&f=1", "display_name": "user2731076", "link": "https://stackoverflow.com/users/2731076/user2731076"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1533754839, "post_id": 51753659, "comment_id": 90467517, "body": "It is 32bit Excel 2016 as part of Office 365. I just tried it on a brand new workbook with nothing but a blank userform and it does the exact same thing. I have built other userforms with this version of excel but never ran into this."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1533755059, "post_id": 51753659, "comment_id": 90467619, "body": "Is it an insider build? Which <i>specific</i> build version number? This should probably be addressed with the &quot;send feedback / send a frown&quot; feature - Microsoft Excel product team <i>does</i> monitor these closely!"}, {"owner": {"reputation": 407, "user_id": 2731076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c897b26495c3b19cc1901a9e8ce05e81?s=128&d=identicon&r=PG&f=1", "display_name": "user2731076", "link": "https://stackoverflow.com/users/2731076/user2731076"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1533757212, "post_id": 51753659, "comment_id": 90468495, "body": "Thanks for the suggestion, I just sent some feedback. The specific build version is 1807, build 10325.20082"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1533757655, "post_id": 51753659, "comment_id": 90468711, "body": "If you can, try to see if you can get an insider build - IIRC the July (or was it June?) build was 1808, so it might have been fixed already. That said, I don&#39;t think this question is a particular good fit for SO, given it&#39;s not quite a <i>programming</i> question. Cheers!"}], "owner": {"reputation": 407, "user_id": 2731076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c897b26495c3b19cc1901a9e8ce05e81?s=128&d=identicon&r=PG&f=1", "display_name": "user2731076", "link": "https://stackoverflow.com/users/2731076/user2731076"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1589825368, "creation_date": 1533753875, "last_edit_date": 1533757270, "question_id": 51753659, "link": "https://stackoverflow.com/questions/51753659/userform-automatically-resizes-80-of-requested-width-height-and-changes-aspect", "title": "Userform automatically resizes 80% of requested width/height and changes aspect ratio", "body": "<p>I am creating a userform with some simple buttons and dropdowns. When I am in the VBA editor messing with the userforms height and width properties, the number I enter will automatically change to roughly 80% of the entered value once I press enter. For example, if I type 500 into the Width field and hit enter, the Width will instead change to 399.6 and the height will change to ~80% of whatever it was set to as well. It happens the other way around too (setting height instead of width). It doesn't seem to affect anything when I change the size in the code and I can change the size by dragging the corner just fine too. But sometimes this will affect how everything shows up when running and actually using the userform.</p>\n\n<p>Other weird things are happening when actually using the userform as well. The biggest being that a listbox seems to overstep the boundaries it is given. There is a dead white space to the right and below this listbox that makes it look like maybe the listbox is shrinking by 80% too but the dead white space was the original size (even though the size I set is what appears and the white space is beyond that).</p>\n\n<p>Any ideas on what might be wrong? I'm to the point where I might just trash the current file and copy/paste everything into a new file.</p>\n\n<p>EDIT: I accidentally put combobox in the second paragraph when it is actually a listbox</p>\n"}, {"tags": ["ms-access", "vba", "dao"], "answers": [{"comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 3, "creation_date": 1533762969, "post_id": 51753629, "comment_id": 90471123, "body": "The <code>.Updateable</code> property is influenced by a huge number of things, such as the content of the query, the presence of a primary key, and if the table is linked. However, dbOpenSnapshot is never updateable according to <a href=\"https://msdn.microsoft.com/en-us/library/office/ff197799.aspx\" rel=\"nofollow noreferrer\">MSDN</a>: <i>Snapshot-type Recordset\u2014 a static copy of a set of records that you can use to find data or generate reports. A snapshot-type Recordset object can contain fields from one or more tables in a database but can&#39;t be updated. This type corresponds to an ODBC static cursor.</i>"}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 5, "last_activity_date": 1533753735, "creation_date": 1533753735, "answer_id": 51753629, "question_id": 51753449, "link": "https://stackoverflow.com/questions/51753449/when-opening-a-recordset-in-access-vba-if-the-type-is-dbopensnapshot-does-it-m/51753629#51753629", "title": "When opening a RecordSet in Access VBA, if the type is dbOpenSnapshot, does it make the option dbReadOnly redundant?", "body": "<p>Check the recordset's <code>Updatable</code> property.  This one prints <em>False</em>.</p>\n\n<pre><code>sqltext = \"SELECT * FROM TABLE_01\"\nSet db = CurrentDb\nSet rs = db.OpenRecordset(sqltext, dbOpenSnapshot)\nDebug.Print rs.Updatable\n</code></pre>\n\n<p>So, yes, <code>dbOpenSnapshot</code> as the recordset <em>Type</em> option gives you a read-only recordset.</p>\n"}], "owner": {"reputation": 2524, "user_id": 2705042, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/ShRFK.jpg?s=128&g=1", "display_name": "spinjector", "link": "https://stackoverflow.com/users/2705042/spinjector"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2767, "favorite_count": 0, "accepted_answer_id": 51753629, "answer_count": 1, "score": 4, "last_activity_date": 1614522794, "creation_date": 1533753048, "last_edit_date": 1614522794, "question_id": 51753449, "link": "https://stackoverflow.com/questions/51753449/when-opening-a-recordset-in-access-vba-if-the-type-is-dbopensnapshot-does-it-m", "title": "When opening a RecordSet in Access VBA, if the type is dbOpenSnapshot, does it make the option dbReadOnly redundant?", "body": "<p>In Access VBA, when opening a recordset as a snapshot, does it make the read-only option redundant? At first this seemed to be true, since a snapshot is essentially read-only already, but there always seems to be caveats.</p>\n<p>Example:</p>\n<pre><code>Dim acc      as Access.Application\nDim db       as DAO.Database\nDim rs       as DAO.Recordset\nDim sqltext  as String\n\nsqltext = &quot;SELECT * FROM SOMESOURCE&quot;\n\nSet rs = db.OpenRecordset(sqltext, dbOpenSnapshot, dbReadOnly)\n\n'Because the type is dbOpenSnapshot, does dbReadOnly become redundant?\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1533751893, "post_id": 51753064, "comment_id": 90466069, "body": "try: <code>format(j,&quot;000&quot;)</code> - i didn&#39;t study your code to hard, so you may need to wrap format around another variable or another spot, but the <code>format</code> function is an answer"}, {"owner": {"reputation": 17, "user_id": 8951894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/178326798744d72ebfa1af4ccf2c9d99?s=128&d=identicon&r=PG&f=1", "display_name": "urvashi", "link": "https://stackoverflow.com/users/8951894/urvashi"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1533755371, "post_id": 51753064, "comment_id": 90467740, "body": "@ScottHoltzman : you are the champ :) thankyou so much"}], "owner": {"reputation": 17, "user_id": 8951894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/178326798744d72ebfa1af4ccf2c9d99?s=128&d=identicon&r=PG&f=1", "display_name": "urvashi", "link": "https://stackoverflow.com/users/8951894/urvashi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533751589, "creation_date": 1533751589, "question_id": 51753064, "link": "https://stackoverflow.com/questions/51753064/merging-the-values-into-one-column", "title": "Merging the values into one column", "body": "<p>I have a macro which merges the data from column A and B into column C.</p>\n\n<p>Example :\nIf A1= 1 and B1 =5 , A2 = 10, A3= 7 and B3=8.</p>\n\n<p>So,our C column will have C1=1,C2=2,C3=3,C4=4,C5=5, then it will skip 6 , then C6=7,C7=8,then it will skip 9 and then C8=10.</p>\n\n<p>My current output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/zKf4f.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zKf4f.png\" alt=\"enter image description here\"></a></p>\n\n<p>We can see here that column A and B is the input, and we want output in column C</p>\n\n<p>My problem?\nIn my C column, I am getting correct data but B099 is written as B99,A012 is A12 and so on. How can we avoid this? I want full numbers like B099 and A012 in C column.</p>\n\n<p>My code :</p>\n\n<pre><code> Option Explicit\nPrivate Sub CommandButton1_Click()\nDim rowNo, lastRow, Val1, Val2, Val3, first, last, i, j As Variant\nrowNo = 1\nlastRow = ThisWorkbook.Sheets(\"Sheet2\").Range(\"A\" &amp; \n ThisWorkbook.Sheets(\"Sheet2\").Rows.Count).End(xlUp).Row\nFor i = 1 To lastRow\n    first = ThisWorkbook.Sheets(\"Sheet2\").Range(\"A\" &amp; i).Value\n    last = ThisWorkbook.Sheets(\"Sheet2\").Range(\"B\" &amp; i).Value\n    Val1 = Mid(first, 2, 4)\n    Val2 = Mid(last, 2, 4)\n    Val3 = Left(first, 1)\n    If IsEmpty(Range(\"B\" &amp; i)) = True Then\n        ThisWorkbook.Sheets(\"Sheet2\").Range(\"C\" &amp; rowNo).Value = first\n        rowNo = rowNo + 1\n    Else\n        For j = Val1 To Val2\n            ThisWorkbook.Sheets(\"Sheet2\").Range(\"C\" &amp; rowNo).Value = Val3 &amp; j\n            rowNo = rowNo + 1\n\n            Next j\n        End If\n        Next i\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "copy-paste", "paste"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1533754152, "post_id": 51753051, "comment_id": 90467239, "body": "&quot;Crashes&quot; and &quot;doesn&#39;t work&quot; are poor problem descriptions that don&#39;t really help make a good, clear question. Feel free to <a href=\"https://stackoverflow.com/posts/51753051/edit\">edit</a> your post to include the specific error you&#39;re getting, and what specific statement is causing it."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 7594277, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fa052c1884d88c2db4558b8bec0e8038?s=128&d=identicon&r=PG&f=1", "display_name": "Val S", "link": "https://stackoverflow.com/users/7594277/val-s"}, "edited": false, "score": 0, "creation_date": 1533754188, "post_id": 51753504, "comment_id": 90467254, "body": "I was looping to find the unhidden row. I&#39;m initially doing a filter based on some criteria and then I want to take the row that is filtered (hence the unhidden row) and copy-paste it in the wb workbook."}, {"owner": {"reputation": 99, "user_id": 7594277, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fa052c1884d88c2db4558b8bec0e8038?s=128&d=identicon&r=PG&f=1", "display_name": "Val S", "link": "https://stackoverflow.com/users/7594277/val-s"}, "edited": false, "score": 0, "creation_date": 1533755473, "post_id": 51753504, "comment_id": 90467785, "body": "I get a Run Time error 92 For loop not initialized? I still very new to VBA, would you have any idea what this error is about?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 99, "user_id": 7594277, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fa052c1884d88c2db4558b8bec0e8038?s=128&d=identicon&r=PG&f=1", "display_name": "Val S", "link": "https://stackoverflow.com/users/7594277/val-s"}, "edited": false, "score": 0, "creation_date": 1533756126, "post_id": 51753504, "comment_id": 90468042, "body": "@ValS - Hmm - what line throws the error? You may need to add <code>Dim i as Long</code> if you have <code>Option Explicit</code> on (which you should).  I tried on my comp and I can begin the loop.  Check that the worksheet names and workbook references are correct."}, {"owner": {"reputation": 99, "user_id": 7594277, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fa052c1884d88c2db4558b8bec0e8038?s=128&d=identicon&r=PG&f=1", "display_name": "Val S", "link": "https://stackoverflow.com/users/7594277/val-s"}, "edited": false, "score": 0, "creation_date": 1533756319, "post_id": 51753504, "comment_id": 90468119, "body": "this is actually part of a userform button command. Should I add Option Explicit at the beginning of the Userform?"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 2, "last_activity_date": 1533753263, "creation_date": 1533753263, "answer_id": 51753504, "question_id": 51753051, "link": "https://stackoverflow.com/questions/51753051/copy-paste-crashes-vba/51753504#51753504", "title": "Copy-Paste crashes VBA", "body": "<p><a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">Avoid using <code>.Select</code>/<code>.Activate</code></a>.  Also, using <code>GoTo</code> is generally frowned upon.</p>\n\n<p>Also, you most likely don't want to actually loop through every single row in Excel.  This can cause it to hang up/error out.</p>\n\n<p>This code should work, I think I kept it as you were intending:</p>\n\n<pre><code>Private Sub Update_To_Search_Click()\n'add the user id and date in the lock and date columns\nDim r       As Range\nDim wb      As Workbook\nSet wb = Workbooks(\"GOOD\")\nSet r = wb.Worksheets(\"Sheet1\").Range(\"A1\")       ' CHANGE THIS WORKSHEET to the correct name, and update the starting cell!!!!!!!\nFor i = 1 To wb.Worksheets(\"Sheet1\").Cells(rows.count,1).End(xlUp).Row ' Change this to the column with the most data\n    Set r = r.Offset(1, 0)\n    If r.EntireRow.Hidden = False Then\n        If r.Offset(0, 67).Value = \"\" Then\n            r.Offset(0, 67).Value = UCase(Environ(\"UserName\"))\n            r.Offset(0, 67).Offset(0, 1).Value = Now\n            r.Offset(0, 67).EntireRow.Copy wb.Sheets(\"GoodDBData\").Range(\"A2\").Paste\n        Else\n            r.EntireRow.Copy\n            wb.Sheets(\"GoodDBData\").Range(\"A2\").Paste\n        End If\n    End If\nNext\nApplication.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 7594277, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fa052c1884d88c2db4558b8bec0e8038?s=128&d=identicon&r=PG&f=1", "display_name": "Val S", "link": "https://stackoverflow.com/users/7594277/val-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 419, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1533756988, "creation_date": 1533751556, "last_edit_date": 1533756988, "question_id": 51753051, "link": "https://stackoverflow.com/questions/51753051/copy-paste-crashes-vba", "title": "Copy-Paste crashes VBA", "body": "<p>I have the following code:</p>\n\n<pre><code>Private Sub Update_To_Search_Click()\n'add the user id and date in the lock and date columns\nDim r As Range\nDim wb As Workbook\n Set wb = Workbooks(\"GOOD\")\n Set r = ActiveCell\n For i = 1 To Rows.count\n     Set r = r.Offset(1, 0)\n     If r.EntireRow.Hidden = False Then\n         r.Select\n         GoTo Continue\n     End If\n Next\n\nContinue:\nActiveCell.Offset(0, 67).Select\nIf ActiveCell.Value = \"\" Then\n    ActiveCell.Value = UCase(Environ(\"UserName\"))\n    ActiveCell.Offset(0, 1).Value = Now\n    ActiveCell.EntireRow.Select\n    Selection.Copy\n    wb.Activate\n    Sheets(\"GoodDBData\").Select\n    Range(\"A2\").Select\n    ActiveSheet.Paste\n\nElse\n    ActiveCell.EntireRow.Select\n    Selection.Copy\n    wb.Activate\n    Sheets(\"GoodDBData\").Select\n    Range(\"A2\").Select\n    ActiveSheet.Paste\nEnd If\nEnd sub\n</code></pre>\n\n<p>When run, it keeps spinning [not responding]. I have been using the Paste coding many times and it never happened before.</p>\n\n<p>Any idea why?\nThank you</p>\n"}, {"tags": ["arrays", "vba", "vb.net"], "comments": [{"owner": {"reputation": 10761, "user_id": 2592875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4abcf57451cf62e63e8e191421c6709e?s=128&d=identicon&r=PG", "display_name": "TnTinMn", "link": "https://stackoverflow.com/users/2592875/tntinmn"}, "edited": false, "score": 1, "creation_date": 1533752280, "post_id": 51752931, "comment_id": 90466277, "body": "What type is <code>BOM</code>?  Is it defined in a referenced type library?  If so, open the &quot;Object Explorer&quot; (View Menu-&gt;Object Explorer) and look up the method <code>GetRows</code> to see what type it expects.  Also remove the &quot;(&quot; and &quot;)&quot; from around <code>rows</code> in the method call in VBA."}, {"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1533753324, "post_id": 51752931, "comment_id": 90466844, "body": "The error message is telling you the problem... an array is expected.  I notice the <code>GetColumns</code> call is passing an array, would this not also be the case for <code>GetRows</code>?"}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1533753760, "post_id": 51752931, "comment_id": 90467053, "body": "Try removing the parentheses around <code>rows</code>."}, {"owner": {"reputation": 51, "user_id": 5220795, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/q0AD3.png?s=128&g=1", "display_name": "CodeWriter", "link": "https://stackoverflow.com/users/5220795/codewriter"}, "edited": false, "score": 0, "creation_date": 1533754157, "post_id": 51752931, "comment_id": 90467244, "body": "In the Object Explorer for GetRows the it states the following. GetRows(ppoRows() As Variant)     Member of EdmLib.EdmBomView     method GetRows  I have tried removing the parens around rows and no luck. I tried also dim Rows as variant. No luck."}, {"owner": {"reputation": 51, "user_id": 5220795, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/q0AD3.png?s=128&g=1", "display_name": "CodeWriter", "link": "https://stackoverflow.com/users/5220795/codewriter"}, "edited": false, "score": 0, "creation_date": 1533754421, "post_id": 51752931, "comment_id": 90467346, "body": "I have changed the code to the following:  Dim rows() As Variant Dim row As IEdmBomCell BOM.GetRows rows  Seems happy at the moment but I have another snag. Is Object in VB.NET analogous to a Variant in VBA?"}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1533755290, "post_id": 51752931, "comment_id": 90467709, "body": "In VBA, and Object data type holds a pointer to the object (32 bit address, i think). So it can hold any object. A Variant can hold anything, including and object. The Variant data type was created, in part, because Excel cells can hold numbers, text, dates, and errors, and they needed something to handle any of those."}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1533755428, "post_id": 51752931, "comment_id": 90467773, "body": "An array isn&#39;t an Object in that you can&#39;t store a pointer. Well, you probably can, but it&#39;s not how it&#39;s normally done. A Variant can hold an array, but it won&#39;t be recognized as an array until you store one in it. So if you pass a Variant into a function that expects an array, it will fail."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1533755495, "post_id": 51752931, "comment_id": 90467796, "body": "@DickKusleika it&#39;s <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/data-type-summary\" rel=\"nofollow noreferrer\">4 bytes</a>, i.e. 32 bits indeed."}, {"owner": {"reputation": 51, "user_id": 5220795, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/q0AD3.png?s=128&g=1", "display_name": "CodeWriter", "link": "https://stackoverflow.com/users/5220795/codewriter"}, "edited": false, "score": 0, "creation_date": 1533755530, "post_id": 51752931, "comment_id": 90467810, "body": "Ah ha, subtle but important point. Good insight."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1533759029, "post_id": 51752931, "comment_id": 90469354, "body": "So, what is your question? We need to see the line with error - not the calling of procedure."}], "answers": [{"tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": false, "score": 0, "last_activity_date": 1533756256, "creation_date": 1533756256, "answer_id": 51754229, "question_id": 51752931, "link": "https://stackoverflow.com/questions/51752931/vba-failing-with-array-or-user-defined-type-expected/51754229#51754229", "title": "VBA failing with array or user defined type expected", "body": "<p>If you have a method signature (or function signature or whatever) that requires an array, then you have to <code>Dim</code> the variable you pass in as an array.</p>\n\n<pre><code>Public Sub test()\n\n    Dim x As Variant\n\n    Debug.Assert Not IsArray(x)\n\n    x = Array(1, 2)\n\n    Debug.Assert IsArray(x)\n\n    GetStuff x 'this fails\n\n    Stop\n\nEnd Sub\n\n\nPublic Function GetStuff(a() As Variant) As Double\n\n    GetStuff = 1\n\nEnd Function\n</code></pre>\n\n<p>Even though a Variant can hold an array, it doesn't pass the <code>IsArray</code> test just by declaring it. If I assign an array to it, it passes <code>IsArray</code>, but I still can't use it as an argument to function that requires an array. <code>x</code> is a Variant array and <code>a()</code> is an array of Variants. So the above code still won't compile.</p>\n\n<p>It sounds from your comments that you got it sorted, but I thought I'd throw a little more information out there for posterity.</p>\n"}], "owner": {"reputation": 51, "user_id": 5220795, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/q0AD3.png?s=128&g=1", "display_name": "CodeWriter", "link": "https://stackoverflow.com/users/5220795/codewriter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533756256, "creation_date": 1533751065, "question_id": 51752931, "link": "https://stackoverflow.com/questions/51752931/vba-failing-with-array-or-user-defined-type-expected", "title": "VBA failing with array or user defined type expected", "body": "<p>I have some code I am moving from VB.NET to VBA which has worked in the .NET world quite well. I have successfully moved almost all of the code into the VBA world with one exception thus far. Here is much of the code in question and all the variable declarations`</p>\n\n<pre><code>Dim vault As IEdmVault14\nDim eFile As IEdmFile9\nDim eFolder As IEdmFolder7\nDim pos As IEdmPos5\nDim Pathlist As EdmStrLst5\nDim parentFolder As IEdmFolder5\nDim vaultName As String\nDim filePath As String\nDim AssyName As String\nDim LoggedIn As Boolean\n\nSet EdmVault5 = New EdmVault5\n\nSet vault = New EdmVault5Dim fso As New FileSystemObject\n    Dim sw As TextStream\n    Set sw = fso.CreateTextFile(\"c:\\temp\\\" &amp; AssyName &amp; \".txt\")\n\n    '-----------------------------GET COLUMN HEADERS\n    Dim columns() As EdmBomColumn\n\n    BOM.GetColumns columns\n\n    Dim header As String\n\n    header = \"LEVEL\" &amp; vbTab\n\n    Dim column As EdmBomColumn\n\n    For i = 0 To UBound(columns)\n        header = header &amp; columns(i).mbsCaption &amp; vbTab\n    Next\n    sw.writeline (header)\n\n\n    '-----------------------------Bom.READ EACH BOM ROW\n\n    Dim rows As Object\n    Dim row As IEdmBomCell\n    BOM.GetRows (rows)\n\n\n    For i = 0 To UBound(rows)\n        If IsNothing(row) Then Exit For\n        Dim rowString As String\n        Set rowString = row.GetTreeLevel.ToString &amp; vbTab\n        Dim varVal As String\n        varVal = \"\"\n\n        For i = 0 To UBound(columns)\n            row.GetVar(column.mlVariableID, column.meType, varVal, Nothing, Nothing, Nothing)\n            If IsNothing(varVal) Then varVal = \"\"\n            rowString = rowString &amp; varVal &amp; vbTab\n        Next\n        '-----------------------------WRITE THE ROW TO THE FILE\n       sw.writeline (rowString)\n    Next\n    sw.Close\n</code></pre>\n\n<p>` </p>\n\n<p>The array error occurs at BOM.GetRows (rows). I am stuck on what the issue could be. This error code does not occur in VB.NET but .NET does warn that Variable 'rows' is passed by reference before it has been assigned a value. A null reference exception could result at runtime. I am not clear on how that translates into VBA if at all. </p>\n\n<p>If anyone could shed some light on this it would be helpful I'm sure.</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 3019, "user_id": 668550, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/iJV3F.jpg?s=128&g=1", "display_name": "haemse", "link": "https://stackoverflow.com/users/668550/haemse"}, "edited": false, "score": 0, "creation_date": 1533816846, "post_id": 51754274, "comment_id": 90491992, "body": "I don&#39;t really get all the start /end bookmark ... when my email opens (by another programm) its format txt with a preset text ... there will basically never be a signature preset.  When I run your code there is an error on &#39;start bookmark cause the objSel.Range seems to be empty ... or not set.  What i did manage to make run is:"}, {"owner": {"reputation": 3019, "user_id": 668550, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/iJV3F.jpg?s=128&g=1", "display_name": "haemse", "link": "https://stackoverflow.com/users/668550/haemse"}, "edited": false, "score": 0, "creation_date": 1533817557, "post_id": 51754274, "comment_id": 90492532, "body": "Set objBkm = objDoc.Bookmarks.Add(&quot;_MailAutoSig&quot;)     objBkm.Range.insertFile &quot;pathToFile&quot;, , False, False, False     objBkm.Range.InsertParagraphBefore  this worked - including that the user could change the sign via gui, however this added the signature to the beginning of the email"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 3019, "user_id": 668550, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/iJV3F.jpg?s=128&g=1", "display_name": "haemse", "link": "https://stackoverflow.com/users/668550/haemse"}, "edited": false, "score": 1, "creation_date": 1533824539, "post_id": 51754274, "comment_id": 90497590, "body": "Then insert it at the end. Or add your text to the message body after inserting the signature."}, {"owner": {"reputation": 3019, "user_id": 668550, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/iJV3F.jpg?s=128&g=1", "display_name": "haemse", "link": "https://stackoverflow.com/users/668550/haemse"}, "edited": false, "score": 0, "creation_date": 1533857691, "post_id": 51754274, "comment_id": 90512431, "body": "i see, good idea ... how do you suggest adding the signature to the end of the text?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 3019, "user_id": 668550, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/iJV3F.jpg?s=128&g=1", "display_name": "haemse", "link": "https://stackoverflow.com/users/668550/haemse"}, "edited": false, "score": 0, "creation_date": 1533876834, "post_id": 51754274, "comment_id": 90516139, "body": "The script adds the signature at the bottom of the message body. Do you add your text <b>before</b> inserting the signature?"}, {"owner": {"reputation": 3019, "user_id": 668550, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/iJV3F.jpg?s=128&g=1", "display_name": "haemse", "link": "https://stackoverflow.com/users/668550/haemse"}, "edited": false, "score": 0, "creation_date": 1533920265, "post_id": 51754274, "comment_id": 90539427, "body": "yes text is already there ... a 3rd party software opens the new outlook email with a preset text. however i manged to make it work now"}, {"owner": {"reputation": 3019, "user_id": 668550, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/iJV3F.jpg?s=128&g=1", "display_name": "haemse", "link": "https://stackoverflow.com/users/668550/haemse"}, "edited": false, "score": 0, "creation_date": 1533920302, "post_id": 51754274, "comment_id": 90539443, "body": "seems you script relies on a text passage beeing preselected? Set objSel = objDoc.Application.Selection ??"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 3019, "user_id": 668550, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/iJV3F.jpg?s=128&g=1", "display_name": "haemse", "link": "https://stackoverflow.com/users/668550/haemse"}, "edited": false, "score": 1, "creation_date": 1533920605, "post_id": 51754274, "comment_id": 90539600, "body": "No, that was for the current cursor position."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1533761627, "last_edit_date": 1533761627, "creation_date": 1533756389, "answer_id": 51754274, "question_id": 51752921, "link": "https://stackoverflow.com/questions/51752921/outlook-vba-set-signature-to-new-email-so-the-signature-can-be-changed-via/51754274#51754274", "title": "Outlook - VBA set signature to new Email ... so the signature can be changed via menu", "body": "<p>Outlook looks for the \"_MailAutoSig\" bookmark. This needs to be done with Word Object Model, not by setting the HTMLBody property. Something along the lines:</p>\n\n<pre><code>wdStory = 6\nwdMove = 0\n\nSet objBkm = Nothing\nSet objDoc = Inspector.WordEditor\n\nSet objSel = objDoc.Application.Selection\n\n'remember the cursor position\nset cursorRange = objDoc.Range\ncursorRange.Start = objSel.Start\ncursorRange.End = objSel.End\n\nIf objDoc.Bookmarks.Exists(\"_MailAutoSig\") Then\n   'replace old signature\n   Debug.Print \"old signature found\"\n   set objBkm = objDoc.Bookmarks(\"_MailAutoSig\")\n   objBkm.Select\n   objDoc.Windows(1).Selection.Delete\nElseIf objDoc.Bookmarks.Exists(\"_MailOriginal\") Then\n  ' is there the original email? (_MailOriginal)\n  set objBkm = objDoc.Bookmarks(\"_MailOriginal\")\n  objSel.Start = objBkm.Start-2 'give room for the line break before. It includes the line\n  objSel.End = objBkm.Start-2\nElse\n  'insert at the end of the email\n  objSel.EndOf wdStory, wdMove\nEnd If\n\n'start bookmark\nset bkmStart = objDoc.Bookmarks.Add(\"_tempStart\", objSel.Range)\n\n'end bookmark\nset bkmEnd = objDoc.Bookmarks.Add(\"_tempEnd\", objSel.Range)\nbkmEnd.End = bkmEnd.End + 1\nbkmEnd.Start = bkmEnd.Start + 1\nobjSel.Text = \" \"\n\nset objBkm = objDoc.Bookmarks.Add(\"_MailAutoSig\", bkmStart.Range)\n\nobjBkm.Range.insertFile \"c:\\Users\\&lt;user&gt;\\AppData\\Roaming\\Microsoft\\Signatures\\test.htm\", , false, false, false\nobjBkm.Range.InsertParagraphBefore\nobjBkm.End = bkmEnd.Start - 1 'since we added 1 above for bkmEnd\n\nobjSel.Start = cursorRange.Start\nobjSel.End = cursorRange.End\n\nbkmStart.Delete\nbkmEnd.Delete\n</code></pre>\n"}], "owner": {"reputation": 3019, "user_id": 668550, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/iJV3F.jpg?s=128&g=1", "display_name": "haemse", "link": "https://stackoverflow.com/users/668550/haemse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 355, "favorite_count": 0, "accepted_answer_id": 51754274, "answer_count": 1, "score": 0, "last_activity_date": 1592945093, "creation_date": 1533751036, "last_edit_date": 1592945093, "question_id": 51752921, "link": "https://stackoverflow.com/questions/51752921/outlook-vba-set-signature-to-new-email-so-the-signature-can-be-changed-via", "title": "Outlook - VBA set signature to new Email ... so the signature can be changed via menu", "body": "<p>I wrote a script where I add a signature from an htm file in the appData ... signature folder to a newly opened email.</p>\n\n<p>My question is - how do i modify this VBA script to add that signature in a way so Outlook knows its a signature and the signature might be changed by a user via gui.</p>\n\n<p>I assume it may have something to do with setting a \"_MailAutoSig\" bookmark, is that right?</p>\n\n<p>Script looks like this and works so far:</p>\n\n<pre><code>    Dim WithEvents m_objMail As Outlook.MailItem\n\n    Dim LODGIT_SUBJECT_IDENTIFIERS() As String\n\n    Private Sub Application_ItemLoad(ByVal Item As Object)\n        'MsgBox \"Application_ItemLoad\"\n        Select Case Item.Class\n            Case olMail\n                Set m_objMail = Item\n        End Select\n    End Sub\n\n    Private Sub m_objMail_Open(Cancel As Boolean)\n\n        'string array containing lodgit email subject identifiers (beginning string!!! of email subject)\n        LODGIT_SUBJECT_IDENTIFIERS = Split(\"Angebot von B\u00f6dele Alpenhotel,Angebot von,best\u00e4tigt Ihre Reservierung,Rechnung Nr.,Stornogutschrift f\u00fcr die Rechnung,Ausstehende Zahlung\", \",\")\n\n        Dim Application As Object\n        Dim oOutApp As Object, oOutMail As Object\n        Dim strbody As String, FixedHtmlBody As String\n        Dim Ret\n\n        Set Application = CreateObject(\"Outlook.Application\")\n\n        'Change only Mysig.htm to the name of your signature\n        ' C:\\Users\\nicole\\AppData\\Roaming\\Microsoft\\Signatures\n        Ret = Environ(\"appdata\") &amp; _\n                    \"\\Microsoft\\Signatures\\AH Andrea kurz.htm\"\n\n        If Ret = False Then Exit Sub\n\n        '~~&gt; Use the function to fix image paths in the htm file\n        FixedHtmlBody = FixHtmlBody(Ret)\n\n        'CHECK FOR LODGIT IDENTIFIER\n        If myInStr(m_objMail.Subject, LODGIT_SUBJECT_IDENTIFIERS()) Then\n            Debug.Print \"E-Mail as from Lodgit identified\"\n            Dim str As String\n            Dim a As Object\n            str = Replace(m_objMail.Body, vbCrLf, \"&lt;br&gt;\")\n            str = Replace(str, vbNewLine, \"&lt;br&gt;\")\n\n\n            m_objMail.HTMLBody = \"&lt;html&gt;&lt;body&gt;&lt;span style='font-size:11.0pt;font-family:\"\"Times New Roman\"\" '&gt;\" &amp; str &amp; \"&lt;/span&gt;\" &amp; FixedHtmlBody &amp; \"&lt;/body&gt;&lt;/html&gt;\"\n\n        End If\n\n    End Sub\n\n    '~~&gt; Function to fix image paths in Signature .htm Files\n    Function FixHtmlBody(r As Variant) As String\n        Dim FullPath As String, filename As String\n        Dim FilenameWithoutExtn As String\n        Dim foldername As String\n        Dim MyData As String\n\n        '~~&gt; Read the html file as text file in a string variable\n        Open r For Binary As #1\n        MyData = Space$(LOF(1))\n        Get #1, , MyData\n        Close #1\n\n        '~~&gt; Get File Name from path\n        filename = GetFilenameFromPath(r)\n        '~~&gt; Get File Name without extension\n        FilenameWithoutExtn = Left(filename, (InStrRev(filename, \".\", -1, vbTextCompare) - 1))\n        '~~&gt; Get the foldername where the images are stored\n        foldername = FilenameWithoutExtn &amp; \"-Dateien\"\n\n        '~~&gt; Full Path of Folder\n        FullPath = Left(r, InStrRev(r, \"\\\")) &amp; foldername\n\n        '~~&gt; To cater for spaces in signature file name\n        'FullPath = Replace(FullPath, \" \", \"%20\")\n\n        '~~&gt; Replace incomplete path with full Path\n        FixHtmlBody = Replace(MyData, \"AH%20Andrea%20kurz-Dateien\", FullPath)\n        'FixHtmlBody = Replace(MyData, foldername, FullPath)\n    End Function\n\n    '~~&gt; Gets File Name from path\n    Public Function GetFilenameFromPath(ByVal strPath As String) As String\n        If Right$(strPath, 1) &lt;&gt; \"\\\" And Len(strPath) &gt; 0 Then _\n        GetFilenameFromPath = GetFilenameFromPath(Left$(strPath, Len(strPath) - 1)) + Right$(strPath, 1)\n    End Function\n\n    'check if str contains on of the elements of a str array\n    Public Function myInStr(myString As String, a() As String) As Boolean\n        For Each elem In a\n            If InStr(1, myString, elem, vbTextCompare) &lt;&gt; 0 Then\n                myInStr = True\n                Exit Function\n            End If\n        Next\n\n        myInStr = False\n    End Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1533751161, "post_id": 51752732, "comment_id": 90465666, "body": "Are you sure <code>Index(0)</code> is valid?  Try starting from <code>Index(1)</code> ?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1533751675, "post_id": 51752732, "comment_id": 90465944, "body": "check the properties and/or contents of the objects being added to the collection.  (use the Watch window)"}, {"owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1533753639, "post_id": 51752732, "comment_id": 90466992, "body": "@RonRosenfeld each item inside the collection is set to variant/long see edit with photo"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1533754515, "post_id": 51752732, "comment_id": 90467385, "body": "In your question you write about using <code>Me.Index(0)</code> In your code you have written <code>.Item(0)</code>  If <code>Index</code> is just a typo, I&#39;d suggest uploading a workbook that demonstrates the problem (with sensitive information removed) to some public site, and edit your question to include the link.  I suspect this will be easier to troubleshoot that way."}, {"owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1533756137, "post_id": 51752732, "comment_id": 90468044, "body": "@RonRosenfeld yes just a typo, I mean me.item(0) or me.item(1) etc"}], "answers": [{"tags": [], "owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "is_accepted": true, "score": 0, "last_activity_date": 1533824994, "creation_date": 1533824994, "answer_id": 51769648, "question_id": 51752732, "link": "https://stackoverflow.com/questions/51752732/cannot-get-value-out-of-custom-class-using-index-function/51769648#51769648", "title": "Cannot get value out of custom class using index function", "body": "<p>The set in example #1 was throwing me off -_-</p>\n\n<pre><code>Public Property Get Item(Index As Variant) As Long\nAttribute Item.VB_UserMemId = 0\n    Set Item = CollectionOfGeneratedValues.Item(Index)\n    Debug.Print Item\nEnd Property\n\nPublic Property Get Item(Index As Variant) As Long\nAttribute Item.VB_UserMemId = 0\n     Item = CollectionOfGeneratedValues.Item(Index)\n    Debug.Print Item\nEnd Property\n</code></pre>\n"}], "owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 51769648, "answer_count": 1, "score": 1, "last_activity_date": 1594154949, "creation_date": 1533750414, "last_edit_date": 1594154949, "question_id": 51752732, "link": "https://stackoverflow.com/questions/51752732/cannot-get-value-out-of-custom-class-using-index-function", "title": "Cannot get value out of custom class using index function", "body": "<p>EDIT FIXED: changed add to add a long rather than a variant and no longer am trying to SET when calling get item just getting the long and returning it to the calling function.</p>\n\n<pre><code>VERSION 1.0 CLASS\nBEGIN\n  MultiUse = -1  'True\nEND\nAttribute VB_Name = \"CollectionOfGeneratedValues\"\nAttribute VB_GlobalNameSpace = False\nAttribute VB_Creatable = False\nAttribute VB_PredeclaredId = False\nAttribute VB_Exposed = False\nOption Explicit\nPrivate CollectionOfGeneratedValues As Collection\n\nPrivate Sub Class_Initialize()\n    Set CollectionOfGeneratedValues = New Collection\nEnd Sub\n\nPrivate Sub Class_Terminate()\n    Set CollectionOfGeneratedValues = Nothing\nEnd Sub\n\nPrivate Property Get NewEnum() As IUnknown\n    Set NewEnum = CollectionOfGeneratedValues.[_NewEnum]\nEnd Property\n\nFriend Property Get Count() As Long\n    Count = CollectionOfGeneratedValues.Count\nEnd Property\n\nFriend Sub Add(num As Long)\n    CollectionOfGeneratedValues.Add num\nEnd Sub\n\nPublic Property Get Item(Index As Variant) As Long\nAttribute Item.VB_UserMemId = 0\n     Item = CollectionOfGeneratedValues.Item(Index)\n    Debug.Print Item\nEnd Property\n\nPublic Sub Clear()\n    Set CollectionOfGeneratedValues = New Collection\nEnd Sub\n\nPublic Sub shuffleCollection()\n\nEnd Sub\n\nPublic Sub generateValues(ByRef userInput As Range)\nDim userSetValue                    As Long\nDim sumTarget                       As Long\nDim sumLeft                         As Long\nDim numbersToGenerate               As Long\n\n    userSetValue = userInput.value\n    sumTarget = getSumTarget(userInput)\n    sumLeft = setInitialSumLeft(sumTarget, userSetValue)\n    numbersToGenerate = getNumbersToGenerate(userInput)\n    Call getValues(numbersToGenerate, sumLeft)\nEnd Sub\n\nPrivate Function getSumTarget(ByRef userInput As Range) As Long\n    getSumTarget = Range(\"F\" &amp; userInput.Row)\nEnd Function\n\nPrivate Function setInitialSumLeft(ByVal sumTarget As Long, ByVal userSetValue As Long) As Long\n    setInitialSumLeft = sumTarget - userSetValue\nEnd Function\n\nPrivate Function getNumbersToGenerate(ByRef userInput As Range) As Long\nDim rangeToFill                     As Range\n\n    Set rangeToFill = Range(\"A\" &amp; userInput.Row &amp; \":E\" &amp; userInput.Row)\n    getNumbersToGenerate = rangeToFill.Columns.Count - 1\nEnd Function\n\nPrivate Sub getValues(ByVal numbersToGenerate As Long, ByVal sumLeft As Long)\nDim counter                         As Long\nDim value                           As Long\n\n    For counter = 1 To numbersToGenerate - 1\n        value = Application.WorksheetFunction.RandBetween(0, sumLeft / 2)\n        Me.Add value\n        sumLeft = sumLeft - value\n    Next counter\n    Me.Add sumLeft\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "edited": false, "score": 0, "creation_date": 1533750860, "post_id": 51752824, "comment_id": 90465491, "body": "Here they talk about writing to xlsx <a href=\"https://stackoverflow.com/questions/151005/create-excel-xls-and-xlsx-file-from-c-sharp\" title=\"create excel xls and xlsx file from c sharp\">stackoverflow.com/questions/151005/&hellip;</a>"}, {"owner": {"reputation": 154, "user_id": 10116116, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--s2Di8yOU90/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7osNJiMq-mIQKfBiXKipsocgio4DA/mo/photo.jpg?sz=128", "display_name": "Sam", "link": "https://stackoverflow.com/users/10116116/sam"}, "edited": false, "score": 0, "creation_date": 1533751030, "post_id": 51752824, "comment_id": 90465599, "body": "Thanks for the input. I think I&#39;ll put a BeforeClose function on the workbook, saving it as a .txt and then importing the .txt file into vba with <code>Split</code> (where each new line is a different element of the array). Shouldn&#39;t it be faster?"}, {"owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "reply_to_user": {"reputation": 154, "user_id": 10116116, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--s2Di8yOU90/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7osNJiMq-mIQKfBiXKipsocgio4DA/mo/photo.jpg?sz=128", "display_name": "Sam", "link": "https://stackoverflow.com/users/10116116/sam"}, "edited": false, "score": 0, "creation_date": 1533751163, "post_id": 51752824, "comment_id": 90465669, "body": "Sure, it&#39;s much faster to read/write text files than Excel files. Might consider CSV too."}, {"owner": {"reputation": 154, "user_id": 10116116, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--s2Di8yOU90/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7osNJiMq-mIQKfBiXKipsocgio4DA/mo/photo.jpg?sz=128", "display_name": "Sam", "link": "https://stackoverflow.com/users/10116116/sam"}, "edited": false, "score": 0, "creation_date": 1533752139, "post_id": 51752824, "comment_id": 90466195, "body": "Would <code>CSV</code>s be simply faster than <code>xlsx</code>s with the code above or can they be also be <code>Open For Input</code> as <code>.txt</code>s are?"}, {"owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "reply_to_user": {"reputation": 154, "user_id": 10116116, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--s2Di8yOU90/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7osNJiMq-mIQKfBiXKipsocgio4DA/mo/photo.jpg?sz=128", "display_name": "Sam", "link": "https://stackoverflow.com/users/10116116/sam"}, "edited": false, "score": 0, "creation_date": 1533752853, "post_id": 51752824, "comment_id": 90466575, "body": "CSV is only faster if using <code>Open for Input</code>; no speed increase if you open it as a spreadsheet. I only suggested it as another option if you prefer comma over tab."}, {"owner": {"reputation": 154, "user_id": 10116116, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--s2Di8yOU90/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7osNJiMq-mIQKfBiXKipsocgio4DA/mo/photo.jpg?sz=128", "display_name": "Sam", "link": "https://stackoverflow.com/users/10116116/sam"}, "edited": false, "score": 0, "creation_date": 1533757316, "post_id": 51752824, "comment_id": 90468554, "body": "There&#39;s a problem with CSVs. When I import the the column of the csv, the first element of my array has this symbol preceding it: <code>&#239;&#187;&#191;</code>. Solutions online have suggested to set <code>fileEncoding=&quot;UTF-8-BOM&quot;</code>. Any idea how?"}], "tags": [], "owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "is_accepted": true, "score": 0, "last_activity_date": 1533753691, "last_edit_date": 1533753691, "creation_date": 1533750686, "answer_id": 51752824, "question_id": 51752561, "link": "https://stackoverflow.com/questions/51752561/import-column-from-excel-file-with-path-into-array/51752824#51752824", "title": "Import column from excel file with path into array", "body": "<p>What you're already using is the best way in my opinion. But if you're looking for other options: The xlsx file is actually a zip file. You could open it as a zip file and extract the contents. This can be done without starting Excel. So it should be faster. </p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/dd922181(v=office.12).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/dd922181(v=office.12).aspx</a></p>\n\n<p>You can save the spreadsheet as a text file or you can save it as a CSV file. The data will look slightly different between those two options so use whatever works for you. </p>\n\n<p>If your data will never have tabs in it, then tab delimited(.txt) is the way to go. Open the file, split by rows and then split by columns. Done.</p>\n"}], "owner": {"reputation": 154, "user_id": 10116116, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--s2Di8yOU90/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7osNJiMq-mIQKfBiXKipsocgio4DA/mo/photo.jpg?sz=128", "display_name": "Sam", "link": "https://stackoverflow.com/users/10116116/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 709, "favorite_count": 0, "accepted_answer_id": 51752824, "answer_count": 1, "score": 2, "last_activity_date": 1533753691, "creation_date": 1533749741, "last_edit_date": 1533750068, "question_id": 51752561, "link": "https://stackoverflow.com/questions/51752561/import-column-from-excel-file-with-path-into-array", "title": "Import column from excel file with path into array", "body": "<p><strong>Is there a faster way to import a column from a specific excel file as an array with VBA?</strong></p>\n\n<p>The code that I'm currently using has to open the excel file. Is there a way to do this <em>in the background</em>? Is there a way to read values row by row from the first column?</p>\n\n<p>Thanks</p>\n\n<p>My code below:</p>\n\n<pre><code>Sub LoadExcelArray()\n\nDim Vendor As Variant\nDim wb As Workbook\nDim sFile As String\nsFile = \"D:\\Desktop\\test.xlsx\"\n\nApplication.ScreenUpdating = False\n\nSet wb = Application.Workbooks.Open(sFile)\n\nVendor = wb.Sheets(1).Range(\"A1:A95\").Value2\n\nwb.Close False\n\nApplication.ScreenUpdating = True\n\nMsgBox Vendor(30, 1)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 8, "creation_date": 1533749745, "post_id": 51752543, "comment_id": 90464953, "body": "Since your code resides within the code module for your sheet, you can use the keyword Me to refer to that worksheet -- <code>Set rng = Me.Range(&quot;A1&quot;)</code>.  While not necessary, it does give you access to the IntelliSense."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 0, "creation_date": 1533750879, "post_id": 51752543, "comment_id": 90465502, "body": "@Domenic - Aha!  That seems like the answer, please feel free to create an answer and I can mark it.  (I also assume you <i>can not</i> use <code>Me</code> in a workbook module? Or if you can, <code>Me</code> then refers to essentially <code>ThisWorkbook</code>?).  WIthout <code>Me</code>, is my assumption correct in that there&#39;s an implicit reference to the worksheet with just <code>Range()</code>? Or could that still theoretically refer to another sheet if active?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1533751590, "post_id": 51752543, "comment_id": 90465905, "body": "@BruceWayne - In the <code>Workbook</code> module <code>Range()</code> will refer to whatever sheet is active, so you will need to be explicit if you need to be. If you are using any of the <code>Worksheet</code> events in the <code>Workbook</code> module, then you can use the <code>sh</code> variable that is passed from the event parameters."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1533752403, "post_id": 51752543, "comment_id": 90466345, "body": "<code>Me</code> refers to the <i>current object</i>, so if you&#39;re in the code-behind for <code>ThisWorkbook</code>, it refers to <code>ThisWorkbook</code> ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1533752792, "post_id": 51753167, "comment_id": 90466549, "body": "Whooooo!!! That&#39;s an awesome answer, thank so very much for your help and time taken to write it!"}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 2, "creation_date": 1533768154, "post_id": 51753167, "comment_id": 90472734, "body": "This is one big reason why I dislike implicit references - they don&#39;t help in <a href=\"https://www.joelonsoftware.com/2005/05/11/making-wrong-code-look-wrong/\" rel=\"nofollow noreferrer\">making wrong code look wrong</a>. Consistently qualifying with <code>Me</code> for all member accesses will scream wrong when transposing that code into a standard module or in an incompatible class/document class and paves the way for easy refactoring."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1534140885, "post_id": 51753167, "comment_id": 90586486, "body": "(Oh, PS I use RubberDuck all the time, it&#39;s great! Thanks so much for your most excellent work on it!! :D)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1534142040, "post_id": 51753167, "comment_id": 90586934, "body": "@BruceWayne oh, I just write the bugs - blame <a href=\"https://stackoverflow.com/users/643342/this\">this</a>, <a href=\"https://stackoverflow.com/users/5536802/m-doerner\">M.Doerner</a>, <a href=\"https://stackoverflow.com/users/4088852/comintern\">Comintern</a>, <a href=\"https://stackoverflow.com/users/1803692/vogel612\">Vogel612</a>, <a href=\"https://stackoverflow.com/users/5757159/thunderframe\">ThunderFrame</a> and everyone else involved for the bits that <i>do</i> work ;-) (thanks!)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 20, "last_activity_date": 1568340343, "last_edit_date": 1568340343, "creation_date": 1533752009, "answer_id": 51753167, "question_id": 51752543, "link": "https://stackoverflow.com/questions/51752543/thisworksheet-equivalent/51753167#51753167", "title": "&quot;ThisWorksheet&quot; equivalent?", "body": "<p>A worksheet module is a <em>document module</em>, which is class just like any other, except it inherits (yes, <em>inherits</em>, as in <em>class inheritance</em>!) members from the <code>Worksheet</code> interface, and being a <em>document module</em> the only way to create an instance of it is through the host application's object model (i.e. <code>ThisWorkbook.Worksheets.Add</code> is essentially a <em>factory method</em>).</p>\n\n<p>Being a class module, the worksheet object for that module is an <em>instance</em> of, say, the <code>Sheet1</code> class, which contains whatever members you put into it, <em>plus</em> every member inherited from the <code>Worksheet</code> interface... <strong>including</strong> a <code>Range</code> property.</p>\n\n<p>So the reason why an unqualified <code>Range</code> call in a worksheet module refers to <em>that</em> sheet, is simply because of the VBA language's scoping rules - given this code:</p>\n\n<pre><code>foo = Range(\"B12\").Value2\n</code></pre>\n\n<ol>\n<li><p>If there's a local variable in that scope named <code>Range</code>, then that's what <code>Range</code> refers to.</p></li>\n<li><p><strong>If there's a member in that module named <code>Range</code>, then that's what <code>Range</code> refers to.</strong></p></li>\n<li><p>If there's a global variable in the current project named <code>Range</code>, then that's what <code>Range</code> refers to.</p></li>\n<li><p>If there's a globally-scoped identifier in a referenced project or type library named <code>Range</code>, then that's what <code>Range</code> refers to.</p></li>\n</ol>\n\n<p><img src=\"https://i.stack.imgur.com/Qvc7Z.png\" alt=\"Members of &#39;Sheet1&#39; include a &#39;Range&#39; property, which is a member of the &#39;Worksheet&#39; class\"></p>\n\n<p>You can disambiguate the <code>Range</code> call by qualifying it with the <code>Me</code> keyword, which returns a reference to the current object, in this case through the <code>Sheet1</code> interface (still assuming you're in the code-behind of <code>Sheet1</code>):</p>\n\n<pre><code>foo = Me.Range(\"B12\").Value2\n</code></pre>\n\n<p>That code will work against <code>Sheet1</code> if you're in the code-behind of <code>Sheet1</code>, and against <code>Sheet2</code> if you're in the code-behind of <code>Sheet2</code>, ...and will fail to compile in a standard module.</p>\n\n<p>But the nature and implications of <code>Me</code> deserve more attention.</p>\n\n<hr>\n\n<h3>About 'Me'</h3>\n\n<p><code>Me</code> is a <em>reserved name</em> (you can't have a variable by that name) that refers to something that can only exist at run-time in a procedure's scope: the <em>current object</em>. Under the hood, when you make a member call to <code>DoSomething</code> against a <code>Class1</code> object, the call goes essentially like this:</p>\n\n<pre><code>Set obj = New Class1\nClass1.DoSomething obj\n</code></pre>\n\n<p>This means <code>DoSomething</code> looks like this in VBA:</p>\n\n<pre><code>Public Sub DoSomething()\nEnd Sub\n</code></pre>\n\n<p>But VBA sees it like this:</p>\n\n<pre><code>Public Sub DoSomething(ByVal Me As Class1)\nEnd Sub\n</code></pre>\n\n<p>That makes <code>Me</code> an implicit locally-scoped <code>ByVal</code> parameter of type <code>Class1</code>, and inside the <code>DoSomething</code> scope it holds a reference to whatever object <em>the caller</em> is currently using.</p>\n\n<p>That's basically the crux of my <a href=\"https://rubberduckvba.wordpress.com/2018/09/05/understanding-me-no-flowers-no-bees/\" rel=\"noreferrer\">Understanding 'Me' (no flowers, no bees)</a> article =)</p>\n\n<p><sub>(<a href=\"https://docs.microsoft.com/en-us/openspecs/microsoft_general_purpose_programming_languages/ms-vbal/78bcb344-4966-4401-bb55-72729790ebee?redirectedfrom=MSDN\" rel=\"noreferrer\">relevant language spec</a>)</sub></p>\n\n<hr>\n\n<p>When you're in a <em>standard module</em>, an unqualified <code>Range</code> call obeys the exact same scoping rules:</p>\n\n<ol>\n<li><p>If there's a local variable in that scope named <code>Range</code>, then that's what <code>Range</code> refers to.</p></li>\n<li><p>If there's a member in that module named <code>Range</code>, then that's what <code>Range</code> refers to.</p></li>\n<li><p>If there's a global variable in the current project named <code>Range</code>, then that's what <code>Range</code> refers to.</p></li>\n<li><p><strong>If there's a globally-scoped identifier in a referenced project or type library named <code>Range</code>, then that's what <code>Range</code> refers to.</strong></p></li>\n</ol>\n\n<p>(assuming no <em>shadowing</em> of the <code>Range</code> identifier is occurring in that module/project)</p>\n\n<p>The globally-scoped identifier in this case can be found in the hidden <code>Global</code> module:</p>\n\n<p><img src=\"https://i.stack.imgur.com/AY1S4.png\" alt=\"members of &#39;_Global&#39; include a &#39;Range&#39; property\"></p>\n"}], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16353, "favorite_count": 4, "accepted_answer_id": 51753167, "answer_count": 1, "score": 12, "last_activity_date": 1608061461, "creation_date": 1533749663, "question_id": 51752543, "link": "https://stackoverflow.com/questions/51752543/thisworksheet-equivalent", "title": "&quot;ThisWorksheet&quot; equivalent?", "body": "<p>In Excel, I have some macros that are part of a <em>Worksheet</em> module.  </p>\n\n<p>In the code, I want to make sure that the ranges referred to are part of that worksheet.</p>\n\n<p>For example, in my <code>Main Sheet</code> worksheet module, say I have:</p>\n\n<pre><code>Sub test()\nDim rng as Range\nSet rng = Range(\"A1\")\nEnd Sub\n</code></pre>\n\n<p>Of course, I want to explicitly give the worksheet the range is on. Typically, I'd do </p>\n\n<pre><code>Set rng = Worksheets(\"Main Sheet\").Range(\"A1\")\n</code></pre>\n\n<p>But I'm curious, since I have my code in a worksheet module, how can I refer to that worksheet? I was thinking something like <code>ThisWorksheet</code> but that's not a method in VBA (but <code>ThisWorkbook</code> is, which is why I thought to try it).</p>\n\n<p>My only other thoughts are that since my macro is inside a worksheet module, the \"unassigned\" range variable implicitly refers to the <code>Main Sheet</code> and <strong>can not</strong> refer to any other worksheet's cells.</p>\n\n<p>Do I understand that correctly, or is there some way to refer to the worksheet the code running is stored in?</p>\n"}, {"tags": ["string", "vba", "excel", "excel-formula", "offset"], "comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1533759809, "post_id": 51752535, "comment_id": 90469739, "body": "Lots of assumptions. For instance, what if Selection is several cells? Then your code will fail."}, {"owner": {"reputation": 17, "user_id": 10187005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b905dd8bb392849806b566aad3ffac4?s=128&d=identicon&r=PG&f=1", "display_name": "alcopo63q", "link": "https://stackoverflow.com/users/10187005/alcopo63q"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1533811573, "post_id": 51752535, "comment_id": 90488460, "body": "The code at the top selects just a single cell by selecting the cell at the end of the column (i.e. the last cell with data in it which is exactly what I want). After this point, there is a problem"}], "answers": [{"tags": [], "owner": {"reputation": 17, "user_id": 10187005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b905dd8bb392849806b566aad3ffac4?s=128&d=identicon&r=PG&f=1", "display_name": "alcopo63q", "link": "https://stackoverflow.com/users/10187005/alcopo63q"}, "is_accepted": true, "score": 0, "last_activity_date": 1533826670, "creation_date": 1533826670, "answer_id": 51770270, "question_id": 51752535, "link": "https://stackoverflow.com/questions/51752535/from-range-to-string-within-formula/51770270#51770270", "title": "From Range to String within .Formula", "body": "<p>In addition to having it try to put the formula down one row instead of one column (which wasn't a big deal), I was trying to offset from a cell String rather than from the range which that string represents. All I had to do was put <code>SubAddress</code> inside <code>Range</code> </p>\n\n<pre><code>Sheets(TextBox1.Value).Select\n\nDim LastClass As Variant\nRange(\"E2\").Select\nSelection.End(xlDown).Select\nLastClass = Cells(Selection.Row, Selection.Column).Address(0, 0)\n\n' Finds \"subtotal\"\nSet Subtotal = Sheets(TextBox1.Value).Range(\"D:D\")\nSet Subtotal2 = Subtotal.Find(\"Subtotal\")\nSubAddress = Cells(Subtotal2.Row, Subtotal2.Column).Address(0, 0)\nRR = Range(Subtotal2.Address).Row - 2\nDim RRs As String\nRRs = CStr(RR)\nRange(SubAddress).Offset(0, 1).Formula = \"=SUMIF(F2:F\" &amp; RRs &amp; \",\"\"Yes\"\",E2:\" &amp; LastClass &amp; \")\"\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 10187005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b905dd8bb392849806b566aad3ffac4?s=128&d=identicon&r=PG&f=1", "display_name": "alcopo63q", "link": "https://stackoverflow.com/users/10187005/alcopo63q"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 51770270, "answer_count": 1, "score": 0, "last_activity_date": 1533826670, "creation_date": 1533749641, "last_edit_date": 1533752058, "question_id": 51752535, "link": "https://stackoverflow.com/questions/51752535/from-range-to-string-within-formula", "title": "From Range to String within .Formula", "body": "<p>I might be going at this a little wonky, but I am selecting cell \"E2\" and going all the way down to the last cell.</p>\n\n<p>I also find the location of a cell containing the word \"Subtotal\" and return the address. I want the cell next to that one to contain a formula which adds up all the cells from \"E2\" down to the first empty cell only if the corresponding cell in the \"F\" column has the word \"Yes\" typed out in the cell.</p>\n\n<p>It works all the way up to the actual formula, but I am not sure if I have missed a syntax error or some sort.</p>\n\n<hr>\n\n<pre><code>Sheets(TextBox1.Value).Select\n\nDim LastClass As Variant\nRange(\"E2\").Select\nSelection.End(xlDown).Select\nLastClass = Cells(Selection.Row, \nSelection.Column).Address(0, 0)\n\n' Finds \"subtotal\"\nSet Subtotal = Sheets(TextBox1.Value).Range(\"D:D\")\nSet Subtotal2 = Subtotal.Find(\"Subtotal\")\nSubAddress = Cells(Subtotal2.Row, Subtotal2.Column).Address(0, 0)\nRR = Range(Subtotal2.Address).Row - 2\nDim RRs As String\nRRs = CStr(RR)\nSubAddress.Offset(1, 0).Formula = \"=SUMIF(F2:F\" &amp; RRs &amp; \",\"\"Yes\"\",E2:\" &amp; LastClass &amp; \")\"\n</code></pre>\n"}, {"tags": ["vba", "excel", "for-loop"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1533747202, "post_id": 51751832, "comment_id": 90463589, "body": "<code>For each cell in rng1</code>.  <code>rng1</code> is a single cell.  Is that what you intended?"}, {"owner": {"reputation": 14442, "user_id": 7475225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/niMZR.jpg?s=128&g=1", "display_name": "Mike - SMT", "link": "https://stackoverflow.com/users/7475225/mike-smt"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1533747273, "post_id": 51751832, "comment_id": 90463634, "body": "@BruceWayne Yes. I was having problems using Cells so I tried it with range and it worked fine. I guess its overkill I can change it to cells. Still I do not think that is affecting the issue with 2 for loops."}], "answers": [{"comments": [{"owner": {"reputation": 14442, "user_id": 7475225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/niMZR.jpg?s=128&g=1", "display_name": "Mike - SMT", "link": "https://stackoverflow.com/users/7475225/mike-smt"}, "edited": false, "score": 1, "creation_date": 1533747336, "post_id": 51751891, "comment_id": 90463664, "body": "Wow. Simply moving <code>rng2</code> to just above the 2nd loop fixed the problem. Thanks. I would have never thought of this. I assumed it was only concerned with the actual lettering of the column and didn&#39;t realize the range broke after the insertion of columns. Can&#39;t accept the answer for another 9 min but I will once the time elapses."}, {"owner": {"reputation": 14442, "user_id": 7475225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/niMZR.jpg?s=128&g=1", "display_name": "Mike - SMT", "link": "https://stackoverflow.com/users/7475225/mike-smt"}, "edited": false, "score": 1, "creation_date": 1533747488, "post_id": 51751891, "comment_id": 90463756, "body": "In reply to your edit I have been using <code>Debug.Print()</code>. I am new to VBA so I was not aware of breakpoints. Thanks I will look into them as well."}], "tags": [], "owner": {"reputation": 116, "user_id": 10139201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YBlOS.jpg?s=128&g=1", "display_name": "ComradeMicha", "link": "https://stackoverflow.com/users/10139201/comrademicha"}, "is_accepted": false, "score": 3, "last_activity_date": 1533747434, "last_edit_date": 1533747434, "creation_date": 1533747242, "answer_id": 51751891, "question_id": 51751832, "link": "https://stackoverflow.com/questions/51751832/2nd-for-loop-doesnt-work-until-the-2nd-time-i-run-my-sub/51751891#51751891", "title": "2nd For loop doesn&#39;t work until the 2nd time I run my Sub", "body": "<p>Well, you're setting rng2 to \"G\" before inserting new columns in \"G\", hence your rng2 is then actually column \"I\".\nOn second pass it gets re-set to \"G\".</p>\n\n<p>Edit: Try using break points and F8 to find out what your code is doing, it helps ;)</p>\n"}], "owner": {"reputation": 14442, "user_id": 7475225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/niMZR.jpg?s=128&g=1", "display_name": "Mike - SMT", "link": "https://stackoverflow.com/users/7475225/mike-smt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533750805, "creation_date": 1533747037, "last_edit_date": 1533750805, "question_id": 51751832, "link": "https://stackoverflow.com/questions/51751832/2nd-for-loop-doesnt-work-until-the-2nd-time-i-run-my-sub", "title": "2nd For loop doesn&#39;t work until the 2nd time I run my Sub", "body": "<p>I have some VBA code that first checks if a column exist and if it is needed to insert some columns. Then it takes values from one cell and splits them into the new columns.</p>\n\n<p>My problem is when I run the MACRO it only does the inserting of the columns and then I have to run the macro a second time to get the values inserted. I cannot find a similar post about this problem but I am guessing its has been asked before so if you have a link that would be great also.</p>\n\n<p>Is there a reason why my 2nd for loop is not running after the first one finesses?</p>\n\n<p>Is there a way to tell my code to continue after one For loop ends?</p>\n\n<pre><code>Dim starting_string As String\nDim primary_code As String\nDim primary_group As String\nDim rng1 As Range\nDim rng2 As Range\nDim space_ndex As Integer\nDim working_string As String\n\nSub controller()\n    Set rng1 = Range(\"G1:G1\")\n    Set rng2 = Range(\"G2:G1429\")\n\n    For Each cell In rng1\n        If cell.Value &lt;&gt; \"Code\" Then\n            Range(\"G:H\").EntireColumn.Insert\n            Cells(1, \"G\").NumberFormat = \"@\"\n            Cells(1, \"H\").NumberFormat = \"@\"\n            Cells(1, \"G\").Value = \"Code\"\n            Cells(1, \"H\").Value = \"Primary Group\"\n        End If\n    Next cell\n\n    For Each cellg In rng2\n        working_string = cellg.Offset(0, -1).Value\n        If Trim(working_string) &lt;&gt; \"\" Then\n            space_ndex = InStr(cellg.Offset(, -1).Value, \" \")\n            cellg.Offset(0, 0).NumberFormat = \"@\"\n            cellg.Offset(0, 1).NumberFormat = \"@\"\n            cellg.Offset(0, 0).Value = Left(working_string, space_ndex)\n            cellg.Offset(0, 1).Value = Mid(working_string, space_ndex, 100)\n        End If\n    Next cellg\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy-paste", "worksheet-function"], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 10198927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f33c1c4ba9aa2f7e46f391e68e568fb7?s=128&d=identicon&r=PG&f=1", "display_name": "alwaysdanish", "link": "https://stackoverflow.com/users/10198927/alwaysdanish"}, "edited": false, "score": 1, "creation_date": 1533749446, "post_id": 51752049, "comment_id": 90464777, "body": "@ComradeMicha thanks a lot, it&#39;s working fine. I really appreciate your help."}], "tags": [], "owner": {"reputation": 116, "user_id": 10139201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YBlOS.jpg?s=128&g=1", "display_name": "ComradeMicha", "link": "https://stackoverflow.com/users/10139201/comrademicha"}, "is_accepted": false, "score": -1, "last_activity_date": 1533748937, "last_edit_date": 1533748937, "creation_date": 1533747822, "answer_id": 51752049, "question_id": 51751796, "link": "https://stackoverflow.com/questions/51751796/selecting-multiple-worksheet-with-prefix/51752049#51752049", "title": "selecting multiple worksheet with prefix", "body": "<p>The Sheet object has a property \"name\", and there are plenty of ways to check for substrings in a string. So simply iterate through all sheets and check if the title begins with your substring, then set a range object to whatever columns you want to copy and copy/paste.</p>\n\n<p>Edit: After OP's edit, here's the missing code:</p>\n\n<pre><code>If (sheet.Name Like \"2018*\") Then\n</code></pre>\n\n<p>Change that to:</p>\n\n<pre><code>If (Left(sheet.Name,4)=\"2018\") or (Left(sheet.name,4)=\"2017\") Then\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 59, "user_id": 10198927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f33c1c4ba9aa2f7e46f391e68e568fb7?s=128&d=identicon&r=PG&f=1", "display_name": "alwaysdanish", "link": "https://stackoverflow.com/users/10198927/alwaysdanish"}, "edited": false, "score": 0, "creation_date": 1533750065, "post_id": 51752502, "comment_id": 90465113, "body": "please note, I added a &quot;+1&quot; to the row count"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 0, "last_activity_date": 1533750030, "last_edit_date": 1533750030, "creation_date": 1533749483, "answer_id": 51752502, "question_id": 51751796, "link": "https://stackoverflow.com/questions/51751796/selecting-multiple-worksheet-with-prefix/51752502#51752502", "title": "selecting multiple worksheet with prefix", "body": "<p>You can loop through the sheets as well, without selecting the sheet.</p>\n\n<pre><code>Sub Macroif()\n    Dim sh As Worksheet\n\n    For Each sh In Worksheets\n        If sh.Name &lt;&gt; \"Summary\" Then\n            If sh.Name Like \"2017*\" Or sh.Name Like \"2018*\" Then\n                With sh\n                    .Range(\"A13:L40\").Copy\n                    With Worksheets(\"Summary\")\n                        .Range(\"A\" &amp; .Cells(.Rows.Count, \"A\").End(xlUp).Row + 1).PasteSpecial (xlPasteValues)\n                    End With\n                End With\n            End If\n\n        End If\n    Next sh\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 10198927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f33c1c4ba9aa2f7e46f391e68e568fb7?s=128&d=identicon&r=PG&f=1", "display_name": "alwaysdanish", "link": "https://stackoverflow.com/users/10198927/alwaysdanish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "accepted_answer_id": 51752502, "answer_count": 2, "score": -1, "last_activity_date": 1594152908, "creation_date": 1533746892, "last_edit_date": 1594152908, "question_id": 51751796, "link": "https://stackoverflow.com/questions/51751796/selecting-multiple-worksheet-with-prefix", "title": "selecting multiple worksheet with prefix", "body": "<p>I am working on a worksheet with multiple tabs although I need to copy data from worksheets that start with only \"2018 and 2017\".</p>\n\n<p>From these sheets I wanted to copy range -example (A13:L40) and paste them all together in another tab \"summary\".</p>\n\n<p>Any help or suggestion is highly appreciated</p>\n\n<p>Below is the macro I have created so far, still not sure how can i add 2017 as well.</p>\n\n<pre><code>Sub Macroif()\n    Dim sheet As Worksheet\n\n    Sheets(\"Summary\").Activate\n\n    For Each sheet In Worksheets\n        If (sheet.Name Like \"2018*\") Then\n            sheet.Select\n            sheet.Range(\"A13:L40\").Copy\n            Worksheets(\"Summary\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial (xlPasteValues)\n\n        End If\n    Next sheet\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1533747065, "post_id": 51751757, "comment_id": 90463505, "body": "Why not just unhide? There&#39;s logic, I assume, in why you&#39;re stopping the macro at a certain part?  Why not use that logic to reset the ribbon?"}, {"owner": {"reputation": 31351, "user_id": 1447509, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/AYREu.jpg?s=128&g=1", "display_name": "cssyphus", "link": "https://stackoverflow.com/users/1447509/cssyphus"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1533752291, "post_id": 51751757, "comment_id": 90466281, "body": "No, I am not stopping the script via VBA, but by pressing the <code>stop</code> button on the toolbar. At any given time I have up to a dozen breakpoints set in this 1800+ line macro, and when I kill the macro I was hoping there might be a VBA/VBE event that I can tap into to run a clean-up script."}], "owner": {"reputation": 31351, "user_id": 1447509, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/AYREu.jpg?s=128&g=1", "display_name": "cssyphus", "link": "https://stackoverflow.com/users/1447509/cssyphus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533752346, "creation_date": 1533746715, "last_edit_date": 1533752346, "question_id": 51751757, "link": "https://stackoverflow.com/questions/51751757/excel-vba-how-can-i-automatically-run-a-function-upon-manually-aborting-a-script", "title": "Excel VBA How can I automatically run a function upon manually aborting a script", "body": "<p>I minimize the Excel ribbon at the start of my script. </p>\n\n<pre><code>If Application.CommandBars(\"Ribbon\").Height &gt;= 120 Then CommandBars.ExecuteMso \"MinimizeRibbon\"\n</code></pre>\n\n<p>When I pause on a breakpoint and then Stop the macro, this leaves the ribbon hidden.</p>\n\n<p>Is there a way to automatically run another script/sub/function upon pressing the Stop button on the toolbar?</p>\n\n<p>To clarify:</p>\n\n<p>I am not stopping the script via VBA, but by pressing the stop button on the toolbar. At any given time I have up to a dozen breakpoints set in this 1800+ line macro, and when I kill the macro I was hoping there might be a VBA/VBE event that I can tap into to run a clean-up script.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1533747537, "post_id": 51751627, "comment_id": 90463784, "body": "<code>ThisWorkbook</code> refers to the workbook with the code you&#39;re running. <code>ActiveWorkbook</code> is the active workbook.  Since you do have a <code>wsCheck</code> worksheet variable, why not try that: <code>wsChec.Range(&quot;A1:EBT40&quot;).Value = ParametricsWB.Worksheets(&quot;ParametricAnalysis&quot;).Range(&quot;A1:EBT&zwnj;&#8203;40&quot;).Value</code>?"}, {"owner": {"reputation": 1381, "user_id": 5072010, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8f044c7b7dee6227de800f0ade7a82c3?s=128&d=identicon&r=PG&f=1", "display_name": "Runeaway3", "link": "https://stackoverflow.com/users/5072010/runeaway3"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1533751014, "post_id": 51751627, "comment_id": 90465588, "body": "@BruceWayne, thanks for taking some time away from saving Gotham... I tried this and still get the same error. I think the issue is with the <code>= ParametricsWB.Worksheets(&quot;ParametricAnalysis&quot;).Range(&quot;A1:EBT&zwnj;&#8203;40&quot;).Value</code>, because if I just set <code>wsCheck.Range(&quot;A1:EBT40&quot;).Value=4</code>, or some other arbitrary value, there is no error."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1533751256, "post_id": 51751627, "comment_id": 90465732, "body": "Try just <code>Debug.print ParametricsWB.Worksheets(&quot;ParametricAnalysis&quot;).Range(&quot;A1&quot;).V&zwnj;&#8203;alue</code>, does the console show a value? Or does that also throw an error.  Triple check that the worksheet name is accurate and there&#39;s no spaces, and you&#39;ve properly set the <code>ParametricsWB</code> variable."}], "owner": {"reputation": 1381, "user_id": 5072010, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8f044c7b7dee6227de800f0ade7a82c3?s=128&d=identicon&r=PG&f=1", "display_name": "Runeaway3", "link": "https://stackoverflow.com/users/5072010/runeaway3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533746168, "creation_date": 1533746168, "question_id": 51751627, "link": "https://stackoverflow.com/questions/51751627/how-to-copy-information-from-one-workbook-to-another-via-vba", "title": "How to copy information from one workbook to another via VBA?", "body": "<p>I am trying to copy all of the information in one excel file to another via VBA. I know that there are a lot of questions like this on stack (I even based my attempt at the macro on an answer to <a href=\"https://stackoverflow.com/questions/7401967/copy-data-from-another-workbook-through-vba\">this question</a>), but I keep getting an error. This is my code:</p>\n\n<pre><code>Sub CreateUSGCRefStepDownFile()\n    Dim ParametricsWB As Workbook, ThisWB As Workbook\n    Dim vFile As Variant\n\n    'set up source files\n    Set ParametricsWB = ActiveWorkbook\n\n    vFile = Application.GetOpenFilename(\"Excel-files (*.xls*), *.xls*\", _\n        1, \"Select One File to Open\", , False)\n\n    If vFile = False Then Exit Sub\n\n    Workbooks.Open vFile\n\n\n    'set up destination (this one) workbook\n    Set ThisWB = ThisWorkbook\n\n\n    'Create new sheets and copy and paste values into it\n\n    'check if the sheet we want to create already exists\n    Dim wsCheck As Worksheet\n    Dim wsCheckExists As Boolean\n\n    Set wsCheck = ThisWB.Sheets(\"Parametrics\")\n    On Error GoTo 0\n    wsCheckExists = Not wsCheck Is Nothing\n\n\n    If wsCheckExists = False Then\n        Dim ws As Worksheet\n        With ThisWB\n            Set ws = .Sheets.Add(after:=.Sheets(.Sheets.Count))\n            ws.Name = \"Parametrics\"\n        End With\n    End If\n\n    ThisWB.Worksheets(\"Parametrics\").Range(\"A1:EBT40\").Value = ParametricsWB.Worksheets(\"ParametricAnalysis\").Range(\"A1:EBT40\").Value\n\n\nEnd Sub\n</code></pre>\n\n<p>The code runs smoothly until the last line before the end of the sub. I keep getting the error: \"Run-time error'-2147221080 (800401a8)': automation error\". I have tried looking up the explanation of this error, but I am having trouble understanding it. I think it may have something to do with<br>\n<code>Set ThisWB = ThisWorkbook</code>... I have tried changing this to<br>\n<code>Set ThisWB = ActiveWorkbook</code> but this leads to error \"Subscript out of range\" when I get to <code>Set wsCheck = ThisWB.Sheets(\"Parametrics\")</code>. Not really sure where I am going wrong or why it is going wrong.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1533745721, "post_id": 51751496, "comment_id": 90462784, "body": "You have to add the comparison <code>&lt;&gt; Me.textbox..</code> to each part of the <code>IF&#47;OR</code>"}, {"owner": {"reputation": 116, "user_id": 10139201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YBlOS.jpg?s=128&g=1", "display_name": "ComradeMicha", "link": "https://stackoverflow.com/users/10139201/comrademicha"}, "edited": false, "score": 0, "creation_date": 1533748580, "post_id": 51751496, "comment_id": 90464290, "body": "That is the answer. Please don&#39;t write answers in comments. It&#39;s misleading to people like me looking for unanswered questions.  Also, I&#39;d add brackets around each individual comparison, just to make it more readable."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 116, "user_id": 10139201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YBlOS.jpg?s=128&g=1", "display_name": "ComradeMicha", "link": "https://stackoverflow.com/users/10139201/comrademicha"}, "edited": false, "score": 1, "creation_date": 1533749726, "post_id": 51751496, "comment_id": 90464943, "body": "@ComradeMicha - it is indeed the answer - meant to be more a helpful hint since a full-blown answer (forthcoming) would address other issues with the code, including variable declaration (only raw5 is <code>Range</code>, all others are <code>Variant</code>."}, {"owner": {"reputation": 93, "user_id": 7631256, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/890fd24830afe3b9dac9e03b4bfcb529?s=128&d=identicon&r=PG&f=1", "display_name": "Sid.  T.", "link": "https://stackoverflow.com/users/7631256/sid-t"}, "edited": false, "score": 0, "creation_date": 1533750906, "post_id": 51751496, "comment_id": 90465512, "body": "Sorry, minor mistakes I didn&#39;t add to my code but I edited the original post to add the comparison code (2 comparisons only just to check code) and it still doesn&#39;t perform."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1533750953, "post_id": 51751496, "comment_id": 90465545, "body": "You also want <code>And</code> instead of <code>Or</code>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1533760519, "post_id": 51751496, "comment_id": 90470132, "body": "What &quot;doesn&#39;t work&quot; - error message?"}, {"owner": {"reputation": 93, "user_id": 7631256, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/890fd24830afe3b9dac9e03b4bfcb529?s=128&d=identicon&r=PG&f=1", "display_name": "Sid.  T.", "link": "https://stackoverflow.com/users/7631256/sid-t"}, "edited": false, "score": 0, "creation_date": 1533763258, "post_id": 51751496, "comment_id": 90471209, "body": "BigBen, no &quot;And&quot; doesn&#39;t work because the value in the textbox is not required to contain all 5 of the cell values."}, {"owner": {"reputation": 93, "user_id": 7631256, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/890fd24830afe3b9dac9e03b4bfcb529?s=128&d=identicon&r=PG&f=1", "display_name": "Sid.  T.", "link": "https://stackoverflow.com/users/7631256/sid-t"}, "edited": false, "score": 0, "creation_date": 1533763344, "post_id": 51751496, "comment_id": 90471233, "body": "There is no error message, except my MsgBox keeps appearing even after inputting the correct value from one of the 5 cells."}], "answers": [{"tags": [], "owner": {"reputation": 93, "user_id": 7631256, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/890fd24830afe3b9dac9e03b4bfcb529?s=128&d=identicon&r=PG&f=1", "display_name": "Sid.  T.", "link": "https://stackoverflow.com/users/7631256/sid-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1533820093, "creation_date": 1533820093, "answer_id": 51767930, "question_id": 51751496, "link": "https://stackoverflow.com/questions/51751496/msgbox-if-value-in-userform-does-not-equal-to-ranges-on-sheet/51767930#51767930", "title": "MsgBox if value in userform does not equal to ranges on sheet", "body": "<p>BigBen was right with using \"And\" instead of \"Or\". The code works as this:</p>\n\n<pre><code>Private Sub cmdEnterData_Click()\n\nDim raw1 As Range, raw2 As Range, raw3 As Range, raw4 As Range, raw5 As Range\n\nSet raw1 = Range(\"A1\")\nSet raw2 = Range(\"A2\")\nSet raw3 = Range(\"A3\")\nSet raw4 = Range(\"A4\")\nSet raw5 = Range(\"A5\")\n\n\nIf Trim(raw1.Value) &lt;&gt; Me.textbox_RawItem.Value And Trim(raw2.Value) &lt;&gt; \nMe.textbox_RawItem.Value And Trim(raw3.Value) &lt;&gt; Me.textbox_RawItem.Value And \nTrim(raw4.Value) &lt;&gt; Me.textbox_RawItem.Value And Trim(raw5.Value) &lt;&gt; \nMe.textbox_RawItem.Value Then\nMsgBox \"This item does not match the item list\"\n With Me.textbox_RawItem\n  .SetFocus\n  .SelStart = 0\n  .SelLength = Len(.Text)\n End With\nExit Sub\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 7631256, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/890fd24830afe3b9dac9e03b4bfcb529?s=128&d=identicon&r=PG&f=1", "display_name": "Sid.  T.", "link": "https://stackoverflow.com/users/7631256/sid-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 339, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594031091, "creation_date": 1533745621, "last_edit_date": 1594031091, "question_id": 51751496, "link": "https://stackoverflow.com/questions/51751496/msgbox-if-value-in-userform-does-not-equal-to-ranges-on-sheet", "title": "MsgBox if value in userform does not equal to ranges on sheet", "body": "<p>I am trying to get a message box to appear if an entered value in my userform does not match any of the 5 cell values on my excel sheet. So far I got one to work for a single cell value but when I add &quot;Or&quot; for the other values it doesn't work.</p>\n<pre><code>Private Sub cmdEnterData_Click()\n\nDim raw1 As Range, raw2 As Range, raw3 As Range, raw4 As Range, raw5 As Range\n\nSet raw1 = Range(&quot;A1&quot;)\nSet raw2 = Range(&quot;A2&quot;)\nSet raw3 = Range(&quot;A3&quot;)\nSet raw4 = Range(&quot;A4&quot;)\nSet raw5 = Range(&quot;A5&quot;)\n\n' this one works for referencing a single cell value\n\nIf Trim(raw1.Value) &lt;&gt; Me.textbox_RawItem.Value Then\nMsgBox &quot;This item does not match the item list&quot;\n With Me.textbox_RawItem\n  .SetFocus\n  .SelStart = 0\n  .SelLength = Len(.Text)\n End With\n Exit Sub\nEnd If\n\n' this one does NOT work \n\nIf Trim(raw1.Value) &lt;&gt; Me.textbox_RawItem.Vaule Or Trim(raw2.Value)&lt;&gt; \nMe.textbox_RawItem.Value Then\nMsgBox &quot;This item does not match the item list&quot;\n With Me.textbox_RawItem\n  .SetFocus\n  .SelStart = 0\n  .SelLength = Len(.Text)\n End With\n Exit Sub\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1533762312, "post_id": 51751465, "comment_id": 90470900, "body": "It sounds like you still have a problem with your <code>GET</code> url and the API of the website. I think you&#39;ll need some help that is specific to that website and possibly to your account type."}, {"owner": {"reputation": 11, "user_id": 10198751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4ff1a2ddd12036202916e16d638cd97?s=128&d=identicon&r=PG&f=1", "display_name": "pipo dyer", "link": "https://stackoverflow.com/users/10198751/pipo-dyer"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1533937280, "post_id": 51751465, "comment_id": 90546308, "body": "Hi Peter, thanks for your reply. So, when I login into the source website and check the source code I see all the code. Do you have a code I can use to read the source code of a HTTPS website that requires a login?"}], "owner": {"reputation": 11, "user_id": 10198751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4ff1a2ddd12036202916e16d638cd97?s=128&d=identicon&r=PG&f=1", "display_name": "pipo dyer", "link": "https://stackoverflow.com/users/10198751/pipo-dyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1533745497, "creation_date": 1533745497, "question_id": 51751465, "link": "https://stackoverflow.com/questions/51751465/getting-protected-html-fields-when-using-excel-vba-and-createobjecthtmlfile", "title": "Getting protected HTML fields when using Excel VBA and CreateObject(&quot;htmlfile&quot;)", "body": "<p>When using the following VBA code to get HTML from a https website I get obfuscated HTML content as \"****\" instead of name even though I am passing username and pass as parameters using method: xml_obj.Open \"GET\", my_url, False, username, pass:</p>\n\n<pre><code>        Set xml_obj = CreateObject(\"MSXML2.XMLHTTP\")\n        Set html_doc = CreateObject(\"htmlfile\")\n        xml_obj.Open \"GET\", my_url, False, \"Username\", \"Pass\"\n        xml_obj.send\n        pageSource = xml_obj.responseText \n</code></pre>\n\n<p>Here is some string result I get:</p>\n\n<p>full_name&quot;:&quot;***** *****&quot;,&quot;address&quot;:&quot;***** *****&quot;,&quot;city&quot;:&quot;******&quot;,&quot;state&quot;:&quot;*****&quot;,&quot;zip&quot;:&quot;*****&quot;,&quot;relatives&quot;:[&quot;***** *****&quot;,&quot;***** *****&quot;,&quot;***** *****&quot;,&quot;***** *****&quot;,&quot;*****</p>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["html", "excel", "vba", "getelementsbyclassname"], "comments": [{"owner": {"reputation": 56607, "user_id": 695364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUNjJ.jpg?s=128&g=1", "display_name": "Scott Marcus", "link": "https://stackoverflow.com/users/695364/scott-marcus"}, "edited": false, "score": 0, "creation_date": 1533746025, "post_id": 51751388, "comment_id": 90462952, "body": "(FYI) In general, you should avoid <code>.getElementsByTagName()</code>, <code>.getElementsByClassName()</code>, and <code>getElementsByName()</code> because they all have a high performance impact as they return &quot;live&quot; node lists. Instead, use the more modern <code>.querySelector()</code> and <code>.querySelectorAll()</code>, which return static node lists."}, {"owner": {"reputation": 56607, "user_id": 695364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUNjJ.jpg?s=128&g=1", "display_name": "Scott Marcus", "link": "https://stackoverflow.com/users/695364/scott-marcus"}, "edited": false, "score": 0, "creation_date": 1533746155, "post_id": 51751388, "comment_id": 90463014, "body": "Have you stepped through the code in the debugger to determine exactly what line the error occurs on?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1533747226, "post_id": 51751388, "comment_id": 90463607, "body": "Is there an URL you can share?"}, {"owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "reply_to_user": {"reputation": 56607, "user_id": 695364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUNjJ.jpg?s=128&g=1", "display_name": "Scott Marcus", "link": "https://stackoverflow.com/users/695364/scott-marcus"}, "edited": false, "score": 0, "creation_date": 1533814038, "post_id": 51751388, "comment_id": 90490044, "body": "@ScottMarcus I&#39;m going to read more about these methods and see if I can find a way around this"}], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "edited": false, "score": 0, "creation_date": 1533813967, "post_id": 51751970, "comment_id": 90489999, "body": "Thanks for answering! I&#39;ve tried this and now there&#39;s no error but i&#39;m getting a null value.. so aNodeList length is zero. Unfortunately the URL requires login to access so I can&#39;t share it.."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "edited": false, "score": 0, "creation_date": 1533817049, "post_id": 51751970, "comment_id": 90492166, "body": "Is this inside any kind of form/frame/iframe tags by the way?"}, {"owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "edited": false, "score": 0, "creation_date": 1534496490, "post_id": 51751970, "comment_id": 90734619, "body": "Hey QHarr! I was few days withouth access to my computer. I took this from where we left it and could find a solution!  I got the the element called &quot;Add items&quot; and once that&#39;s clicks and the options 1,2,3,4,5 are displayed, with your piece of code I could easily get the number i needed."}, {"owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "edited": false, "score": 1, "creation_date": 1534496624, "post_id": 51751970, "comment_id": 90734687, "body": "Thanks a lot for your help! I need to learn more about HTML :)"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1533747545, "creation_date": 1533747545, "answer_id": 51751970, "question_id": 51751388, "link": "https://stackoverflow.com/questions/51751388/vba-getelementsbyclassname-gets-error-5002/51751970#51751970", "title": "VBA GetElementsByClassName gets error 5002", "body": "<p>Have you tried to apply a CSS attribute selector? </p>\n\n<pre><code>ieApp.document.querySelectorAll(\"[dojoinsertionindex]\")  \n</code></pre>\n\n<p>The attribute selector <code>[dojoinsertionindex]</code> will return all elements with attribute <code>[dojoinsertionindex]</code>.</p>\n\n<p>This returns a <code>nodeList</code> you can index into.</p>\n\n<p>Or loop the length of:</p>\n\n<pre><code>Dim aNodeList As Object, i As Long\nSet aNodeList = ie.document.querySelectorAll(\"[dojoinsertionindex]\")  \nFor i = 0 To aNodeList.Length-1\n    Debug.Print aNodeList.item(i).innerText '&lt; === as check\nNext i\n</code></pre>\n\n<p>Click a partic index (starts at 0 for 1)</p>\n\n<pre><code>aNodeList.item(0).Click\n</code></pre>\n\n<hr>\n\n<p><strong>CSS selector on your HTML sample:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/hAfN6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hAfN6.png\" alt=\"query\"></a></p>\n"}], "owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 51751970, "answer_count": 1, "score": 0, "last_activity_date": 1613570900, "creation_date": 1533745227, "last_edit_date": 1613570900, "question_id": 51751388, "link": "https://stackoverflow.com/questions/51751388/vba-getelementsbyclassname-gets-error-5002", "title": "VBA GetElementsByClassName gets error 5002", "body": "<p>First time I'm asking a question so here we go..</p>\n<p>I have some experience in VBA but now I've been requested to do some web scraping for what I' ve been reading and doing some research in HTML as well.. the thing is I have a problem I can't solve.</p>\n<p>There is really no difficulties in what I need to do.. just get some elements like buttons to be clicked or input forms to be auto completed but this one is the one I can't access to:</p>\n<pre><code>&lt;div class=&quot;dojoPopupMenu2&quot; style=&quot;left: 31px; top: 293px; z-index: 1001;&quot; dojoattachpoint=&quot;containerNode&quot;&gt;\n &lt;ul dojoattachpoint=&quot;containerNode&quot;&gt;\n  &lt;li class=&quot;dojoMenuItem2 &quot; dojoattachevent=&quot;onMouseOver: onHover; onMouseOut: onUnhover; onclick: _onclick; onKey:onKey;&quot; dojoinsertionindex=&quot;0&quot;&gt;&lt;span tabindex=&quot;-1&quot; class=&quot;dojoMenuItem2Label&quot;&gt;1&lt;/span&gt;&lt;/li&gt;\n &lt;li class=&quot;dojoMenuItem2 &quot; dojoattachevent=&quot;onMouseOver: onHover; onMouseOut: onUnhover; onclick: _onclick; onKey:onKey;&quot; dojoinsertionindex=&quot;1&quot;&gt;&lt;span tabindex=&quot;-1&quot; class=&quot;dojoMenuItem2Label&quot;&gt;2&lt;/span&gt;&lt;/li&gt;\n &lt;li class=&quot;dojoMenuItem2 &quot; dojoattachevent=&quot;onMouseOver: onHover; onMouseOut: onUnhover; onclick: _onclick; onKey:onKey;&quot; dojoinsertionindex=&quot;2&quot;&gt;&lt;span tabindex=&quot;-1&quot; class=&quot;dojoMenuItem2Label&quot;&gt;3&lt;/span&gt;&lt;/li&gt;\n &lt;li class=&quot;dojoMenuItem2&quot; dojoattachevent=&quot;onMouseOver: onHover; onMouseOut: onUnhover; onclick: _onclick; onKey:onKey;&quot; dojoinsertionindex=&quot;3&quot;&gt;&lt;span tabindex=&quot;-1&quot; class=&quot;dojoMenuItem2Label&quot;&gt;4&lt;/span&gt;&lt;/li&gt;\n &lt;li class=&quot;dojoMenuItem2&quot; dojoattachevent=&quot;onMouseOver: onHover; onMouseOut: onUnhover; onclick: _onclick; onKey:onKey;&quot; dojoinsertionindex=`enter code here`&quot;4&quot;&gt;&lt;span tabindex=&quot;-1&quot; class=&quot;dojoMenuItem2Label&quot;&gt;5&lt;/span&gt;\n &lt;/li&gt;\n&lt;/ul&gt;\n&lt;/div&gt;\n</code></pre>\n<p>There is a previous button called &quot;Add Items&quot; that when it's clicked you get a dropdown list with numbers 1 to 5 (code above) and That's what I need to select.. these numbers depending on some simple conditionals</p>\n<p>I have tried these options but none seem to work</p>\n<pre><code>Dim ieApp As Object\nDim ieDoc As Object\nDim ieEl As HTMLDivElement\nDim ieEls As HTMLObjectElement\nDim direccion As String\nSet ieApp = CreateObject(&quot;InternetExplorer.Application&quot;)\n\nWith ieApp\nFor Each element In .document.getElementsByTagName(&quot;div&quot;) 'Tried with the tag &quot;li&quot; as well\n    if element.classname = &quot;dojoMenuItem2&quot; Then\n        'set a variable with the number 1 to 5 from the list (depending on other condition)\n    end if\nNext\nEnd With\n\n\n'also tried this\nDim additems as HTMLDivElement\nSet additems = ieDoc.GetElementsByClassName(&quot;dojoMenuItem2&quot;)(0)\n'this gets Automate error\n\n'also tried this\nDim additems as HTMLDivElement\nSet additems = ieDoc.GetElementsByClassName(&quot;dojoPopupMenu2&quot;)(0)\n'this gets Automate error\n</code></pre>\n<p>Nothing seems to work so I don't know what I'm not seeing.</p>\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba", "unzip"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1533745942, "post_id": 51751379, "comment_id": 90462902, "body": "Not to be rude, but it would be much appreciated if you could edit your text to be a more concise question <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}, {"owner": {"reputation": 331, "user_id": 2712828, "user_type": "registered", "profile_image": "https://graph.facebook.com/1793448698/picture?type=large", "display_name": "Oren Bell", "link": "https://stackoverflow.com/users/2712828/oren-bell"}, "edited": false, "score": 0, "creation_date": 1591405000, "post_id": 51751379, "comment_id": 110052669, "body": "Bump. Any solution?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10198732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98cd2f1a213359ed0eb4eca6947e7a4f?s=128&d=identicon&r=PG", "display_name": "JMP883", "link": "https://stackoverflow.com/users/10198732/jmp883"}, "edited": false, "score": 0, "creation_date": 1533749118, "post_id": 51751807, "comment_id": 90464586, "body": "I modified those lines and got rid of the syntax error, but now the MkDir line gives me a path not found.     &#39;Extract the files into output folder             Set oApp = CreateObject(&quot;Shell.Application&quot;)             For i = LBound(Fname) To UBound(Fname)                              OFolder = OPath &amp; Fname(i)             MkDir OFolder                          &#39;WORKS BUT DOESN&quot;T SEPARATE INTO FOLDERS, just dumps into input folder.                          oApp.Namespace(OFolder).CopyHere oApp.Namespace(Fname(i)).items"}], "tags": [], "owner": {"reputation": 1078, "user_id": 3124273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d5afe2c849c7123fd07f6ad1349bd2?s=128&d=identicon&r=PG&f=1", "display_name": "cronos2546", "link": "https://stackoverflow.com/users/3124273/cronos2546"}, "is_accepted": false, "score": 0, "last_activity_date": 1533746940, "creation_date": 1533746940, "answer_id": 51751807, "question_id": 51751379, "link": "https://stackoverflow.com/questions/51751379/unzip-multiple-folders-to-multiple-folders/51751807#51751807", "title": "Unzip multiple folders to multiple folders", "body": "<p>I think that this is what you're looking for. You basically make the directory each time you loop through the file names. </p>\n\n<pre><code>Else\n\n    'For Each SFolder In AFolder.Subfolders\n\n    'Set output folder path for unzip files\n    'Output_Folder = OPath\n\n    'Extract the files into output folder\n    Set oApp = CreateObject(\"Shell.Application\")\n\n    For i = LBound(Fname) To UBound(Fname)\n        'V Might need to update to \"correct\" name\n        Output_Folder = Mkdir OPath &amp; \"\\\" &amp; Fname(i)\n        'WORKS BUT DOESN\"T SEPARATE INTO FOLDERS, just dumps into input folder.\n        oApp.Namespace(Output_Folder).CopyHere oApp.Namespace(Fname(i)).items\n\n    Next i\n\n    MsgBox \"You find the files here: \" &amp; Output_Folder\n\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 67, "user_id": 7115723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f2c261e34d18e095d3c608d02c71f8b?s=128&d=identicon&r=PG&f=1", "display_name": "iplayball27", "link": "https://stackoverflow.com/users/7115723/iplayball27"}, "is_accepted": false, "score": 2, "last_activity_date": 1612822863, "last_edit_date": 1612822863, "creation_date": 1591809322, "answer_id": 62309348, "question_id": 51751379, "link": "https://stackoverflow.com/questions/51751379/unzip-multiple-folders-to-multiple-folders/62309348#62309348", "title": "Unzip multiple folders to multiple folders", "body": "<p>There is a problem with cronos2546's answer in the <code>Output_Folder = Mkdir OPath &amp; &quot;\\&quot; &amp; Fname(i)</code> line. This is invalid syntax.</p>\n<p>What you need to do first is make <code>Mkdir OPath &amp; &quot;\\&quot; i</code> its own line. Then you'll want to do the assignment <code>Output_Folder = OPath &amp; &quot;\\&quot; &amp; i</code>You can't make a directory in the same line that you try to assign a directory (string). Additionally, Fname(i) is a complete path which will give you problems. I recommend changing <code>Fname(i)</code> to just <code>i</code> like I have in the beginning of this paragraph. This will simply number your folders.</p>\n<p>Finally, @JMP883 you are getting a path error because the zip file output already has a folder with the same name in your output path. Make sure to delete or move all the contents in your output path before you try to run the macro each time.</p>\n"}], "owner": {"reputation": 1, "user_id": 10198732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98cd2f1a213359ed0eb4eca6947e7a4f?s=128&d=identicon&r=PG", "display_name": "JMP883", "link": "https://stackoverflow.com/users/10198732/jmp883"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1063, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1612822863, "creation_date": 1533745192, "last_edit_date": 1609520226, "question_id": 51751379, "link": "https://stackoverflow.com/questions/51751379/unzip-multiple-folders-to-multiple-folders", "title": "Unzip multiple folders to multiple folders", "body": "<p>My project involves downloading huge numbers of folders from a website, all of which are zipped, and then processing the data.</p>\n<p>The macros I found for unzipping folders require specific paths to and from, while I need something that will unzip all of the folders within a specified folder - while keeping them organized by folder name.  They can unzip to the same folder, they could even overwrite the zip file (in this case it wouldn't matter), but they must stay organized by folder name - otherwise the processing portion won't work.</p>\n<p>I have two problems:<br />\none - I have to select all the folders (to get paths), rather than just unzipping all the folders.<br />\nI tried modifying to run through each subfolder but it doesn't &quot;see&quot; zipped folders without a path, same issue with Dir().<br />\ntwo - it dumps all the unzipped files into a single destination, making it useless for processing.</p>\n<p>A macro that does the same as right click, &quot;extract all&quot;, but loops through all folders within a folder, would be perfect.</p>\n<pre><code>Sub Button11_Click()\n\n    Dim IPath, OPath As String, FFile, FFSo, FFolder As Object\n    Dim oApp As Object\n    Dim Fname As Variant\n    Dim Output_Folder As Variant\n    Dim strDate As String\n    Dim i As Long\n    \n    IPath = &quot;E:\\R2\\Input\\Zipped\\&quot;\n    OPath = &quot;E:\\R2\\Input\\&quot;\n       \n    'Select multiple zip files to unzip\n    MsgBox &quot;Go to E:\\R2\\Input\\Zipped\\ - For Zipped folders&quot;\n    Fname = Application.GetOpenFilename(filefilter:=&quot;Zip Files (*.zip), *.zip&quot;, _\n                                        MultiSelect:=True)\n    \n    If IsArray(Fname) = False Then\n        'Do nothing\n    Else\n          \n        'For Each SFolder In AFolder.Subfolders\n          \n        'Set output folder path for unzip files\n        Output_Folder = OPath\n             \n        'Extract the files into output folder\n        Set oApp = CreateObject(&quot;Shell.Application&quot;)\n\n        For i = LBound(Fname) To UBound(Fname)\n        \n            'WORKS BUT DOESN&quot;T SEPARATE INTO FOLDERS, just dumps into input folder.\n            oApp.Namespace(Output_Folder).CopyHere oApp.Namespace(Fname(i)).items\n    \n        Next i\n    \n        MsgBox &quot;You find the files here: &quot; &amp; Output_Folder\n        \n    End If\n    \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "conditional-formatting"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1533745267, "post_id": 51751330, "comment_id": 90462552, "body": "Hi Ahmed, please consider instead upload a picture of example data as many people (including myself) are unwilling to follow download links <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1533745342, "post_id": 51751330, "comment_id": 90462591, "body": "SO is not a code-writing service. Maybe someone will be kind enough to help but without seeing any initial effort on your part, chances are slimmer..."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 2, "creation_date": 1533745382, "post_id": 51751330, "comment_id": 90462612, "body": "Hi! welcome to Stack Overflow. This is not a code writing service, but if you <a href=\"https://stackoverflow.com/posts/51751330/edit\">edit</a> your question, adding what you have tried so far, we can help you achieve your goal. You may also want to read <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask</a>"}, {"owner": {"reputation": 53, "user_id": 5830942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c93e1c13f96240b3320b338de186c419?s=128&d=identicon&r=PG", "display_name": "user72343", "link": "https://stackoverflow.com/users/5830942/user72343"}, "edited": false, "score": 1, "creation_date": 1533745821, "post_id": 51751330, "comment_id": 90462833, "body": "Hello guys, I&#39;ve attached a picture for the excel sheet."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1533755008, "post_id": 51751330, "comment_id": 90467597, "body": "@user72343 - As <b>all</b> your displayed date differences are &lt;= 60 days, you would have to highlight all cells if one follows your OP or do you start new date sets at the beginning of each year? Please edit how you define full months, too."}, {"owner": {"reputation": 53, "user_id": 5830942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c93e1c13f96240b3320b338de186c419?s=128&d=identicon&r=PG", "display_name": "user72343", "link": "https://stackoverflow.com/users/5830942/user72343"}, "edited": false, "score": 0, "creation_date": 1533783991, "post_id": 51751330, "comment_id": 90475808, "body": "Hello T.M,, the difference between result in 10th line 13/11/2014 and the next one is more than 60 days, then the first ten results are not longest series, so we will highlight starting from the 11th result. We will go through each client and test the same logic. It is not also necessary to have full month of result, that is 1 or 2 result per month is fine. Date range can continue from previous year to new year, but to keep not more than 60 days gap."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1533927040, "post_id": 51751330, "comment_id": 90542376, "body": "Will post a solution using a datafield array after this weekend. BTW Your first image link (with all date differences below 61 days) shows <i>other</i> data than your second. - @user72343"}, {"owner": {"reputation": 53, "user_id": 5830942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c93e1c13f96240b3320b338de186c419?s=128&d=identicon&r=PG", "display_name": "user72343", "link": "https://stackoverflow.com/users/5830942/user72343"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1533955660, "post_id": 51751330, "comment_id": 90549382, "body": "@T.M. Thank you. Awaiting the solution :)"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1534187648, "post_id": 51751330, "comment_id": 90612630, "body": "Posted proposed solution together with hopefully helpful explanations regarding <b>Arrays</b> and the use of <b>conditional formatting</b>, where in <i>international</i> cases a <i>local formula</i> is needed instead of the default English formula code."}, {"owner": {"reputation": 53, "user_id": 5830942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c93e1c13f96240b3320b338de186c419?s=128&d=identicon&r=PG", "display_name": "user72343", "link": "https://stackoverflow.com/users/5830942/user72343"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1534197721, "post_id": 51751330, "comment_id": 90616502, "body": "@T.M. Hello T.M. and thank you for sharing this answer. I tried to copy the codes in the VBA editor and run the macro Sheet1.GetLongestDuration, but I get error &quot;Subscript out of range&quot;! Am I missing anything?"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1534231363, "post_id": 51751330, "comment_id": 90625088, "body": "1. Did you Change the source worksheet to your actual sheet name. 2. Insert a new code module in the VBE (VBA Editor) and write the code there. - @user72343"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 5830942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c93e1c13f96240b3320b338de186c419?s=128&d=identicon&r=PG", "display_name": "user72343", "link": "https://stackoverflow.com/users/5830942/user72343"}, "edited": false, "score": 0, "creation_date": 1534201431, "post_id": 51829017, "comment_id": 90617431, "body": "Hello T.M. and thank you for sharing this answer. I tried to copy the codes in the VBA editor and run the macro Sheet1.GetLongestDuration, but I get error &quot;Subscript out of range&quot;! Am I missing anything?"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 53, "user_id": 5830942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c93e1c13f96240b3320b338de186c419?s=128&d=identicon&r=PG", "display_name": "user72343", "link": "https://stackoverflow.com/users/5830942/user72343"}, "edited": false, "score": 0, "creation_date": 1534237591, "post_id": 51829017, "comment_id": 90628557, "body": "In Addition to my above comment: a) at which code line precisely does code stop? Move your mouse over any Loop variable - which value do you see? - Please tell me the <b>code line</b> causing the error no 9! (b) You could also debug your code by inserting a Stop` statement at any point and check a suspected variable directly in the immediate window (Crtl+G) of your VBA Editor (VBE) by typing ist name plus Enter key to get the last value, press F8 to continue or end the test by clicking at the blue square button on top of VBE or F5 (cf <a href=\"http://www.cpearson.com/excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/DebuggingVBA.aspx</a>) - @user72343"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 53, "user_id": 5830942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c93e1c13f96240b3320b338de186c419?s=128&d=identicon&r=PG", "display_name": "user72343", "link": "https://stackoverflow.com/users/5830942/user72343"}, "edited": false, "score": 0, "creation_date": 1534238263, "post_id": 51829017, "comment_id": 90628986, "body": "A common cause of error 9 is a wrong sheet name - so you could check if you assigned an existing worksheet name to the DATASHEET constant."}, {"owner": {"reputation": 53, "user_id": 5830942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c93e1c13f96240b3320b338de186c419?s=128&d=identicon&r=PG", "display_name": "user72343", "link": "https://stackoverflow.com/users/5830942/user72343"}, "edited": false, "score": 0, "creation_date": 1534254988, "post_id": 51829017, "comment_id": 90639423, "body": "Hello T.M. I added the code to a module, and I get error 9 from line ==&gt;      v(overview(iOv, Ov.StartItem), data.Duration) = 0&amp;  so I added On error resume next and the code worked and generated a new sheet Overview, but no rows highlighted yellow in my data sheet. The other thing is, for example client 2, is counting from line 174 to line 188, while it should start from line 111 to line 198. I tried to attach screenshots but I cannot find a way to add in the comment. Here is the link to the new file saved as xlsb to decreas size <a href=\"https://1drv.ms/x/s!AvGP2RZ7Ro4lggMymPMsv2WtBA24\" rel=\"nofollow noreferrer\">1drv.ms/x/s!AvGP2RZ7Ro4lggMymPMsv2WtBA24</a> Thank you."}, {"owner": {"reputation": 53, "user_id": 5830942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c93e1c13f96240b3320b338de186c419?s=128&d=identicon&r=PG", "display_name": "user72343", "link": "https://stackoverflow.com/users/5830942/user72343"}, "edited": false, "score": 0, "creation_date": 1534255148, "post_id": 51829017, "comment_id": 90639527, "body": "in the shared file, the continuous range is the bold range where the difference between each 2 dates is less than 64 as suggested by you."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 53, "user_id": 5830942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c93e1c13f96240b3320b338de186c419?s=128&d=identicon&r=PG", "display_name": "user72343", "link": "https://stackoverflow.com/users/5830942/user72343"}, "edited": false, "score": 0, "creation_date": 1534268291, "post_id": 51829017, "comment_id": 90647296, "body": "It&#39;s not recommended to skip over ANY occurring error via <code>On error resume next</code>. Do the following instead: 1) try to insert a new code line <code>If overview(iOv, Ov.StartItem) = 0 Then Exit For</code> before the found line causing issues and I&#39;d like to hear if you get results in overview. 2) I didn&#39;t assume that you have several entries the same day, so it will be necessary to change days and Duration declarations as well as related resets to zero from Long <code>0&amp;</code> to Double <code>0#</code> - I will try to edit the code the next days, but tell me first what happened after the code insertion in (1) - @user72343"}, {"owner": {"reputation": 53, "user_id": 5830942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c93e1c13f96240b3320b338de186c419?s=128&d=identicon&r=PG", "display_name": "user72343", "link": "https://stackoverflow.com/users/5830942/user72343"}, "edited": false, "score": 0, "creation_date": 1534286280, "post_id": 51829017, "comment_id": 90654493, "body": "Error 13 (type mismatch) occurred at   &#39; b) write cumulated duration into column D   ws.Range(&quot;D2&quot;).Resize(UBound(v), 1) = Application.Index(v, 0, data.Duration) after insertion the code"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 53, "user_id": 5830942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c93e1c13f96240b3320b338de186c419?s=128&d=identicon&r=PG", "display_name": "user72343", "link": "https://stackoverflow.com/users/5830942/user72343"}, "edited": false, "score": 0, "creation_date": 1534418642, "post_id": 51829017, "comment_id": 90703050, "body": "Please try the edited code with changed variable types (<code>Long</code> to <code>Double</code>) which I tested based on some date values without problems (don&#39;t want to download entire file); if there occur issues, check at which date item code stops (are all entries formatted as date - e.g. check in the immediate window via <code>? TypeName(...)</code>)  and tell me an item example and some related counters (e.g. i, ii) - @user72343"}, {"owner": {"reputation": 53, "user_id": 5830942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c93e1c13f96240b3320b338de186c419?s=128&d=identicon&r=PG", "display_name": "user72343", "link": "https://stackoverflow.com/users/5830942/user72343"}, "edited": false, "score": 0, "creation_date": 1534426445, "post_id": 51829017, "comment_id": 90707993, "body": "Hi T.M. same error 13 still occur at   ws.Range(&quot;D2&quot;).Resize(UBound(v), 1) = Application.Index(v, 0, data.Duration) . I think the code stops at item ii=6379 which is the last item where the underneath cell is empty and has no date. I might be wrong, I not very expert in coding."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 53, "user_id": 5830942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c93e1c13f96240b3320b338de186c419?s=128&d=identicon&r=PG", "display_name": "user72343", "link": "https://stackoverflow.com/users/5830942/user72343"}, "edited": false, "score": 0, "creation_date": 1534537957, "post_id": 51829017, "comment_id": 90756135, "body": "Hi @user72343, thank you for narrowing the error range, so I could try another attempt editing section [II.] in the main procedure."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 1, "creation_date": 1534539428, "post_id": 51829017, "comment_id": 90756658, "body": "One-liner to check sheet existence: <code>SheetExists = Not IsError(Application.Evaluate(ws &amp; &quot;!A1&quot;))</code>. `"}, {"owner": {"reputation": 53, "user_id": 5830942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c93e1c13f96240b3320b338de186c419?s=128&d=identicon&r=PG", "display_name": "user72343", "link": "https://stackoverflow.com/users/5830942/user72343"}, "edited": false, "score": 0, "creation_date": 1534786067, "post_id": 51829017, "comment_id": 90821581, "body": "@T.M. hello dear. I copied the data in a new file and also copied the code. I&#39;m still getting the error msg and I can not test the code to see the results. This a new link for the new file <a href=\"https://1drv.ms/x/s!AvGP2RZ7Ro4lggZQhduRoD560fiz\" rel=\"nofollow noreferrer\">1drv.ms/x/s!AvGP2RZ7Ro4lggZQhduRoD560fiz</a> Could you please check where the error is. Thank you"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 53, "user_id": 5830942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c93e1c13f96240b3320b338de186c419?s=128&d=identicon&r=PG", "display_name": "user72343", "link": "https://stackoverflow.com/users/5830942/user72343"}, "edited": false, "score": 0, "creation_date": 1534939391, "post_id": 51829017, "comment_id": 90882668, "body": "@user72343 - new edit checks for non-numeric items in section II; checks the code in column B - but it&#39;s up to you to provide for corrected entries before executing code again."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 53, "user_id": 5830942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c93e1c13f96240b3320b338de186c419?s=128&d=identicon&r=PG", "display_name": "user72343", "link": "https://stackoverflow.com/users/5830942/user72343"}, "edited": false, "score": 0, "creation_date": 1535393651, "post_id": 51829017, "comment_id": 91040611, "body": "@user72343 - your row number exceeds 200 000, so I found the main cause in a known limitation to the <code>Index</code> function - I try to modify my answer the next days."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 53, "user_id": 5830942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c93e1c13f96240b3320b338de186c419?s=128&d=identicon&r=PG", "display_name": "user72343", "link": "https://stackoverflow.com/users/5830942/user72343"}, "edited": false, "score": 0, "creation_date": 1535476849, "post_id": 51829017, "comment_id": 91076972, "body": "@user72343 - please try the promised edit (main issue was the 65k limitation of <code>Index</code> function), would be glad to hear you succeeded so that you can mark this question as solved."}, {"owner": {"reputation": 53, "user_id": 5830942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c93e1c13f96240b3320b338de186c419?s=128&d=identicon&r=PG", "display_name": "user72343", "link": "https://stackoverflow.com/users/5830942/user72343"}, "edited": false, "score": 0, "creation_date": 1535480301, "post_id": 51829017, "comment_id": 91078556, "body": "@T.M.- I split the sheet into parts less than 65K row and it worked without error, but there was no rows highlighted yellow, any idea?"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 53, "user_id": 5830942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c93e1c13f96240b3320b338de186c419?s=128&d=identicon&r=PG", "display_name": "user72343", "link": "https://stackoverflow.com/users/5830942/user72343"}, "edited": false, "score": 0, "creation_date": 1535480716, "post_id": 51829017, "comment_id": 91078734, "body": "@user72343 - I edited a completely new and hopefully working code including a work around and some minor changes *) - please copy the entire code in the answer from sections I. to V. into your code module and try again. If you get data written to column D, rows with values there should be highlighted now."}, {"owner": {"reputation": 53, "user_id": 5830942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c93e1c13f96240b3320b338de186c419?s=128&d=identicon&r=PG", "display_name": "user72343", "link": "https://stackoverflow.com/users/5830942/user72343"}, "edited": false, "score": 1, "creation_date": 1535484199, "post_id": 51829017, "comment_id": 91080351, "body": "@T.M. Hello, worked as a charm, this is awesome! We really appreciate your help. Thank you very much :)"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 53, "user_id": 5830942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c93e1c13f96240b3320b338de186c419?s=128&d=identicon&r=PG", "display_name": "user72343", "link": "https://stackoverflow.com/users/5830942/user72343"}, "edited": false, "score": 0, "creation_date": 1535485767, "post_id": 51829017, "comment_id": 91081041, "body": "@user72343 - you are welcome, really appreciated your feed back to this apparently simple question actually exhibiting some challenges (VBA <code>Index</code> function limitations, number vs date types, hidden enumeration members, conditional formatting with local formats etc.) - enjoy it :-)"}], "tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1535464431, "last_edit_date": 1535464431, "creation_date": 1534187199, "answer_id": 51829017, "question_id": 51751330, "link": "https://stackoverflow.com/questions/51751330/highlight-series-of-dates-that-met-conditions/51829017#51829017", "title": "Highlight series of dates that met conditions", "body": "<p><strong>Solution via datafield array</strong></p>\n\n<blockquote>\n  <p>\"I want a VBA code to go through the dates of every client and test if the difference between every date is not more than 2 months and to find the longest consecutive set of dates and highlight it with color, yellow for example\"</p>\n</blockquote>\n\n<p>Loops through a range are always <em>time consuming</em>, so I demonstrate an approach via a <strong>datafield array</strong> instead simplifying the <strong>2-months condition</strong> to <em>day differences &lt;= 64 days</em> as I didn't want to overcomplicate this example. </p>\n\n<p>As <em>\"the dates are sorted ascending for each client\"</em>, it's easy to check the next <strong>Client id</strong>, calculate day differences, add them in a current duration variable and compare it  with remembered variables in order to find the longest set of dates within the same id, then changing to the next id. </p>\n\n<p>Finally results are written to an <strong>overview array</strong> to collect the item numbers to be <em>highlighted</em>. This can be done via <strong>conditional formatting</strong> </p>\n\n<p>Furthermore I integrate an <code>Enum</code> declaration in the declaration head of your code module just to show the use of meaningful variables instead of pure numbers (replacing here array 'column'  numbers).</p>\n\n<p><strong>0. Declaration head of your code module</strong></p>\n\n<p>It's strictly recommanded to use <code>Option Explicit</code> to make the type declaration of variables obligatory thus avoiding apparently unexplainable type mismatches or other issues.</p>\n\n<p>The already mentioned <code>Enum</code> declaration has another feature if you are using the automatic enumeration starting from a defined first element, e.g. [_Zero]: you can easily restructure the internal order without changing every code line containing only pure numbers. </p>\n\n<p><em>Hint: All <code>Enum</code> elements are displayed using IntelliSense with exception of elements in <code>[]</code> brackets and element names starting with an underline character <code>_</code>.</em></p>\n\n<p><strong>Minor change 08/28 &lt;-- Edit #100 --></strong> The current edit does without enumerating <code>data.Results</code> without influencing the wanted output, as all <code>data</code> members are renumbered automatically with an additional increment of +1 (calculated after <code>[_Zero]=0</code>). </p>\n\n<pre><code>Option Explicit                                         ' force declaration of variables\n\n' assign meaningful number variables for your array columns\nEnum data                                               ' automatically enumerates column numbers 1 to 5 (-&gt; array v)\n    [_Zero] = 0\n      Id\n      Date\n      days\n      Duration\nEnd Enum\nEnum Ov                                                ' automatically enumerates column numbers 1 to 6 (-&gt; array overview)\n    [_Zero] = 0\n    Id\n    StartDate\n    EndDate\n    duration\n    StartItem\n    enditem\nEnd Enum\n</code></pre>\n\n<p><strong>1. Main procedure <code>GetLongestDuration()</code></strong></p>\n\n<p><strong>Edit 1:</strong> I changed the <code>Type</code> of all calculated day variables from <code>Long</code> to <code>Double</code> (i.e. maxDAYS#, currDuration#, memDuration#) to prevent type mismatches, especially when calculating broken days. </p>\n\n<p><strong>Edit 2:</strong> See changes in section II to avoid <em>empty date</em> calculation (e.g. in last row as mentioned in comment)  (&lt;-- Edit 13# -->) and eventual error 13 writing back durations in section III b). </p>\n\n<p><strong>Edit 3:</strong> See additional check for <em>non-numeric</em> items in section II (&lt;-- Edit 14# and 15# -->)</p>\n\n<p><strong>Edit 4:</strong> The original approach didn't assume that data rows exceeded the number of <strong>65,536</strong> being the absolute <strong>Limitation</strong> to use the \u25ba<strong><code>Index</code> function</strong> (trying to isolate an array column here). </p>\n\n<p>This hopefully final edit avoids an <code>Error 13 Type mismatch</code> using an extra array <code>d</code> with all relevant duration data (cumulated day differences within the defined 2 month range) and corrects some other minor issues. Corrections are made in section II &lt;-- Edit #101 --> and section III &lt;-- Edit #102 to #122 --></p>\n\n<pre><code>Sub GetLongestDuration()\n' Purpose:    Highlight longest set of dates &lt;= 64 days\n' Condition:  Client IDs and Dates are sorted in ascending order.\n' Edit 8/16:  Enumerated type changes of maxDAYS#, currDuration#, memDuration# changed to DOUBLE (#)\n' Edit 8/17:  Edit in section II &lt;-- Edit #13         --&gt;\n' Edit 8/22:  Edit in section II &lt;-- Edit #14 and #15 --&gt;\n' Edit 8/28:  Edit in section II &lt;-- Edit #101 --&gt;, section III &lt;-- Edit #102 to #122 --&gt;\n  Const maxDAYS# = 64#                                ' &lt;&lt; &lt;--#1 Double--&gt; change maximal difference to next date\n  Const DATASHEET$ = \"LABs and Diagnostics\"           ' &lt;&lt; replace with your data sheet name\n  Const OVSHEET$ = \"Overview\"                         ' &lt;&lt; replace with your Overview sheet name\n  Const OVTITLES$ = \"ID,Start Date,End Date,Duration,Start Item, End Item\"\n' declare variables\n  Dim ws As Worksheet, ws2 As Worksheet               ' declare object variables as worksheet\n  Set ws = ThisWorkbook.Worksheets(DATASHEET)         ' set data sheet object to memory\n\n  Dim v As Variant, overview As Variant               ' variant datafield array and results array\n  Dim Id            As String                         ' current state\n  Dim StartItem     As Long\n  Dim StartDate     As Double, EndDate      As Double '\n  Dim days          As Double, currDuration As Double '   &lt;-- #2 Double --&gt;\n\n  Dim memStartDate#, memEndDate#                      ' remember highest findings\n  Dim memDuration#                                    '   &lt;-- #3 Double --&gt;\n  Dim memStartItem&amp;, memLastItem&amp;                     ' remember highest findings\n  Dim i As Long, ii As Long, n As Long, iOv As Long   ' counters\n\n' 0. get last row number n and assign values to a 2-dim array v\n  ws.Columns(\"D:D\") = \"\"                              ' clear column D (duration)\n\n  n = ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row + 2 ' find last row number n plus 2 more rows\n  v = ws.Range(\"A2:E\" &amp; n).Value2                     ' create 2-dim datafield array omitting headers\n  ReDim overview(1 To n, 1 To 6)                      ' create a helper array with results\n\n' =======================\n' loop through data array\n' =======================\n' remember first ID (for later comparation with changing array item id)\n  Id = v(1, data.Id) &amp; \"\"\n  For i = LBound(v) To UBound(v)                      ' loop through items 1 to items count UBound(v) in data array v\n\n    ' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    ' I. check new ID in first 'column' of each array item\n    ' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n      If v(i, data.Id) &amp; \"\" &amp; \"\" &lt;&gt; Id Then           ' check current id against remembered id\n        ' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n        '... complete analytics of preceding id in overview\n        ' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n         If i &gt; 1 Then\n            ii = ii + 1\n            overview(ii, Ov.Id) = Id\n            overview(ii, Ov.StartDate) = memStartDate\n            overview(ii, Ov.EndDate) = memEndDate\n            overview(ii, Ov.Duration) = memDuration\n            overview(ii, Ov.StartItem) = memStartItem\n            overview(ii, Ov.enditem) = memLastItem\n         Else\n            overview(ii, Ov.StartItem) = 1\n         End If\n        '... and switch to new current id\n         Id = v(i, data.Id) &amp; \"\"\n         currDuration = 0#: memDuration = 0#             ' &lt;-- #4 Double --&gt; reset to zero\n         memStartItem = 0&amp;: memLastItem = 0&amp;\n      End If\n\n    ' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    ' II. calculate days and check coherent periods\n    ' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n      If i &lt; UBound(v) Then                              ' stop calculation one item before last item row\n         If Len(Trim(v(i + 1, data.Date))) = 0 Then      ' avoid type mismatch if empty\n            days = 0#\n         ElseIf Not IsNumeric(v(i, data.Date)) Then      ' &lt;-- #14 not numeric --&gt;\n            days = 0#\n            MsgBox \"Item no \" &amp; i &amp; \" \" &amp; v(i, data.Date) &amp; \" is not numeric!\"\n         Else\n            If IsNumeric(v(i + 1, data.Date)) Then       ' &lt;-- #15 not numeric --&gt;\n               days = v(i + 1, data.Date) - v(i, data.Date) ' get days difference to next date\n\n               v(i, data.days) = days                    ' &lt;-- #101 remind days difference --&gt;\n\n            End If\n         End If\n      Else                                               ' there's nothing more to add\n         days = 0#                                       ' &lt;-- #5 Double --&gt;\n      End If\n    ' avoid negative day counts in last row\n      If days &lt; 0 Then days = 0#                         ' &lt;-- #6 Double --&gt;\n    ' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    ' a) days till next date within two months (i.e. &lt;=64)\n    ' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n      If days &lt;= maxDAYS And days &gt; 0 Then\n         v(i, data.days) = days                          '    assign days to column 5\n         currDuration = currDuration + days              '    add days in current set to cumulated duration\n         If i &gt; 1 Then\n            If v(i - 1, data.days) = 0 Then\n                StartItem = i                            '    StartItem number in current data set\n                StartDate = v(i, data.Date)              '    StartDate current data set\n            End If\n         End If\n    ' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    ' b) days till next date exceed two months\n    ' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n      Else\n         v(i, data.days) = 0#                            ' &lt;-- #7 Double --&gt;   therefore no count\n\n         ' if longer duration then remember this set within current id\n         If currDuration &gt; memDuration Then\n            memDuration = currDuration\n            memStartDate = StartDate\n            memEndDate = v(i, data.Date)\n            memStartItem = StartItem\n            memLastItem = i\n         End If\n\n         ' start new set\n         currDuration = 0#                                     ' &lt;-- #8 Double --&gt; reset to zero\n      End If\n  Next i\n  v(UBound(v), data.days) = 0#                                 ' &lt;-- #9 Double --&gt; days in last row\n' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n' III. calculate durations for longest coherent periods and write it to new column D\n' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n' a) loop through all overview items\n\nDim d: ReDim d(1 To UBound(v), 1 To 1)                            ' &lt;-- #102 create separate duration array --&gt;\n\nIf overview(1, Ov.enditem) &gt; 0 Then overview(1, Ov.StartItem) = 1 ' &lt;-- #103 set startitem of 1st to 1 if relevant date range --&gt;\nFor iOv = 1 To ii\n      currDuration = 0#                                           ' &lt;--  #10 Double --&gt; reset to 0 (Double!)\n      '''      If overview(iOv, Ov.StartItem) = 0 Then Exit For   ' &lt;-- #104 DELETE last Edit #0/Aug 14th 18) --&gt;\n      memStartItem = overview(iOv, Ov.StartItem)                  ' &lt;-- #105 remember start item              --&gt;\n      If memStartItem = 0 Then                                    ' &lt;-- #106/107/108 clear not relevant dates --&gt;\n          overview(iOv, Ov.StartDate) = \"\"                        '\n          overview(iOv, Ov.EndDate) = \"\"                          '\n      Else                                                        ' &lt;-- #109 relevant dates                   --&gt;\n        ''' v(overview(iOv, Ov.StartItem), data.Duration) = 0#    ' &lt;-- #110 DELETE last Edit #11 Double      --&gt;\n          d(memStartItem, 1) = currDuration                       ' &lt;-- #111 write current duration to array  --&gt;\n\n          For i = memStartItem To overview(iOv, Ov.enditem) - 1   ' &lt;-- #112 first item no to last item no    --&gt;\n              currDuration = currDuration + CDbl(v(i, data.days)) ' &lt;--  #12 CDbl --&gt; add days to cumulated sum currDuration\n              v(i + 1, data.Duration) = currDuration              ' &lt;-- #113 (unchanged) --&gt; assign duration to source array v in column 4\n              d(i + 1, 1) = currDuration                          ' &lt;-- #114\n          Next i                                                  ' &lt;-- #115 (unchanged)                      --&gt;\n      End If                                                      ' &lt;-- #116 closing IF to #106               --&gt;\n\n  Next iOv                                                        ' &lt;-- #117 (unchanged)                      --&gt;\n\n  ' b) write cumulated duration into column D\n\n  '  **********************************************************\n  '  avoid ERROR 13 type mismatch, ii 6379 **ISSUE 2018/08/22**\n  '  **********************************************************\n  '  Caveat: Index function (trying to isolate single array column) has limitation to 65,536 rows only!\n   '''  ws.Range(\"D2\").Resize(UBound(v), 1) = Application.Index(v, 0, data.Duration) &lt;-- #118 uncomment/DELETE --&gt;\n\n   ws.Range(\"D2\").Resize(UBound(d), 1) = d                        ' &lt;-- #119 write relevant durations to column D --&gt;\n\n    ws.Range(\"D1\") = \"Duration\"                                   ' &lt;-- #120 add title                           --&gt;\n    ws.Range(\"D:D\").NumberFormat = \"# ??/24\"                      ' &lt;-- #121 fraction format shows days + hours  --&gt;\n\n' IV. set Conditional Format in order to highlight found items (condition: existing value in column D)\n'    (calls helper function SetConditionalFormat with arguments range and condition)\n  SetConditionalFormat ws.Range(\"A:D\"), \"=LEN(TRIM($D1 &amp; \"\"\"\"))&gt;0\" ' &lt;--#122 (unchanged)                         --&gt;\n\n' V.  optional display of results in sheet 'Overview', see below\n\nEnd Sub\n</code></pre>\n\n<p><em>Optional Display of results</em></p>\n\n<p>If you want to display the found item data in a separate sheet \"Overview\", you could add this to the code above:</p>\n\n<pre><code>' V. optional display of separate Overview sheet with results\n' a) add Overview sheet if it doesn't exist yet\n  If Not SheetExists(OVSHEET) Then\n     With ThisWorkbook.Worksheets.Add\n          .Name = OVSHEET                                       ' baptize it e.g. \"Overview\"\n          .Columns(\"B:C\").NumberFormat = \"dd/mm/yyyy;@\"         ' &lt;&lt; change columns B:C do wanted local format\n     End With\n  End If\n  Set ws2 = ThisWorkbook.Worksheets(OVSHEET)                     ' set overview sheet object to memory\n' b) write titles and results to Overview sheet\n  ws2.Range(\"A:F\") = \"\"                                          ' clear columns\n  ws2.Range(\"A1:F1\") = Split(OVTITLES, \",\")                      ' write titles to overview!A1:F1\n\n  If ii &lt; 1 Then\n    ws2.Range(\"A2\") = \"No duration sets identified!\"\n  Else\n    ws2.Range(\"A2\").Resize(ii, UBound(overview, 2)) = overview     ' write array overview back to Overview sheet\n  End If\n</code></pre>\n\n<p><strong>2. Helper procedure <code>SetConditionalFormat()</code></strong>    </p>\n\n<p>This procedure is called in section [IV.] of the main procedure and highlights the found date sets for all cells in column D containing data. One possible condition is to ask if the trimmed string length equals zero. <strong>International use:</strong> It has to be considered that <strong>conditional format (CF)</strong> requires \u25ba<strong>local formulae</strong> - therefore a helper function <code>getLocalFormula()</code> is integrated.*</p>\n\n<pre><code> Sub SetConditionalFormat( _\n                   ByRef rng As Range, _\n                   ByVal sFormula As String, _\n                   Optional ByVal myColor As Long = 65535, _\n                   Optional bDelFormerFormats As Boolean = True)\n ' Author:  T.M.\n ' Purpose: set conditional format to given range using sFormula\n ' Note:    former formats are deleted by default unless last argument isn't set to False\n ' Hint:    Formula1 always needs the LOCAL formula, so the string argument sFormula\n '          has to be translated via helper function getLocalFormula() using a work around\n     With rng\n        ' a) delete existing conditional formats in A:D\n             If bDelFormerFormats Then .FormatConditions.Delete\n        ' b) add new condition with needed LOCAL formula\n             .FormatConditions.Add _\n                    Type:=xlExpression, _\n                    Formula1:=getLocalFormula(sFormula)  ' &lt;&lt; get local formula via helper function\n             .FormatConditions(.FormatConditions.Count).SetFirstPriority\n        With .FormatConditions(1).Interior\n             .PatternColorIndex = xlAutomatic\n             .color = myColor                         ' yellow by default parameter\n             .TintAndShade = 0\n        End With\n     .FormatConditions(1).StopIfTrue = False\n     End With\n End Sub\n</code></pre>\n\n<p><strong>3 a) Helper function <code>getLocalFormula()</code></strong></p>\n\n<p>This function is called by the above helper procedure, as <strong>conditional formatting</strong> always needs the <strong>local formula</strong> thus considering <em>internationalization</em>:</p>\n\n<pre><code> Function getLocalFormula(ByVal sFormula As String) As String\n ' Author:  T.M.\n ' Purpose: work around to translate English formula to local formula\n ' Caveat:  assumes there is no value in last cell (e.g. $XFD$1048576 in more recent versions)\n     With ActiveSheet.Range(\"A1\").Offset(ActiveSheet.Rows.Count - 1, ActiveSheet.Columns.Count - 1)\n       ' assign formula to temporary cell in order to get local formula string\n         .Formula = sFormula\n       ' get local formula\n         getLocalFormula = .FormulaLocal\n         .Value = \"\"                              ' delete temporary formula\n     End With\n End Function\n</code></pre>\n\n<p><strong>3 b) Helper function <code>SheetExists()</code></strong></p>\n\n<p>Called by optional section [V.] of the main procedure:</p>\n\n<pre><code> Function SheetExists(SheetName As String, Optional wb As Workbook) As Boolean\n ' Author:  Tim Williams\n ' Purpose: check if worksheet exists (returns True or False)\n ' cf Site: https://stackoverflow.com/questions/6688131/test-or-check-if-sheet-exists\n Dim ws As Worksheet\n If wb Is Nothing Then Set wb = ThisWorkbook\n On Error Resume Next\n Set ws = wb.Worksheets(SheetName)\n On Error GoTo 0\n SheetExists = Not ws Is Nothing\n End Function\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 5830942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c93e1c13f96240b3320b338de186c419?s=128&d=identicon&r=PG", "display_name": "user72343", "link": "https://stackoverflow.com/users/5830942/user72343"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 453, "favorite_count": 1, "accepted_answer_id": 51829017, "answer_count": 1, "score": -1, "last_activity_date": 1594072397, "creation_date": 1533745047, "last_edit_date": 1594072397, "question_id": 51751330, "link": "https://stackoverflow.com/questions/51751330/highlight-series-of-dates-that-met-conditions", "title": "Highlight series of dates that met conditions", "body": "<p>I have a data in excel sheet that contains client id, date of a result and the result of some lab tests. The dates are sorted ascending for each client. I want a VBA code to go through the dates of every client and test if the <em>difference between every date</em> is <strong>not more than 2 months</strong> and to find the <em>longest consecutive set of Dates</em> and <em>Highlight</em> it with color, yellow for example. This set of date is not necessarily to be the oldest or the newest, but should be the longest duration of non interrupted date by more than 2 months. </p>\n\n<p>Also, it would be great if the duration is calculated for that long set next to the result column, so we can sort the data accordingly. </p>\n\n<p>Here is a <a href=\"https://1drv.ms/x/s!AvGP2RZ7Ro4lgX3E0SHoWsqPHNbn\" rel=\"nofollow noreferrer\">link</a> to my file.\n and below is a screenshot for the requirement.\n<a href=\"https://i.stack.imgur.com/8ridB.jpg\" rel=\"nofollow noreferrer\">image for the excel sheet</a></p>\n\n<p><strong>Example data extracted from linked file</strong></p>\n\n<pre><code>        +----+----------+------------------------+---------+\n        | #  |    A     |         B              |    C    |\n        +----+----------+------------------------+---------+\n        | 1  | ClientId | Results Date &amp; Time    | Results |\n        +----+----------+------------------------+---------+\n        |... |    ...   |         ...            |    ...  |\n        +----+----------+------------------------+---------+\n        |105 |    1     | 12/06/2018 12:42:00 PM | 1.9     |\n        +----+----------+------------------------+---------+\n        |106 |    1     | 6/25/2018  1:55:00 PM  | 1.8     |\n        +----+----------+------------------------+---------+\n        |107 |    2     | 3/29/2016  9:11:00 AM  | 1       |\n        +----+----------+------------------------+---------+\n        |108 |    2     | 6/8/2016  12:50:00 PM  | 2       |\n        +----+----------+------------------------+---------+\n        |...\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-office", "excel-2016"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1533744212, "post_id": 51751026, "comment_id": 90461971, "body": "What error do you get?"}, {"owner": {"reputation": 2152, "user_id": 8440358, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/32c0eb86b93f263e5a61b9e258c07c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Hasitha Jayawardana", "link": "https://stackoverflow.com/users/8440358/hasitha-jayawardana"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1533744305, "post_id": 51751026, "comment_id": 90462023, "body": "@BruceWayne It opens Media Player Classic and gives an error. What I want is to  play audio in excel without opening any player."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1533744510, "post_id": 51751026, "comment_id": 90462138, "body": "Check <a href=\"http://spreadsheetpage.com/index.php/tip/playing_sound_from_excel/\" rel=\"nofollow noreferrer\">this page</a>, does that help?  Or the late, great <a href=\"http://www.cpearson.com/excel/PlaySound.aspx\" rel=\"nofollow noreferrer\">Chip Pearson&#39;s page</a>?"}, {"owner": {"reputation": 2152, "user_id": 8440358, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/32c0eb86b93f263e5a61b9e258c07c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Hasitha Jayawardana", "link": "https://stackoverflow.com/users/8440358/hasitha-jayawardana"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1533745120, "post_id": 51751026, "comment_id": 90462471, "body": "@BruceWayne I embedded all mp3s to excel sheet. So I can give cell name as the audio path. So can you give me the solution here   WAVFile = &quot;dogbark.wav&quot; WAVFile = ThisWorkbook.Path &amp; &quot;\\&quot; &amp; WAVFile Call PlaySound(WAVFile, 0&amp;, SND_ASYNC Or SND_FILENAME)"}], "owner": {"reputation": 2152, "user_id": 8440358, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/32c0eb86b93f263e5a61b9e258c07c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Hasitha Jayawardana", "link": "https://stackoverflow.com/users/8440358/hasitha-jayawardana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2060, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1594154964, "creation_date": 1533743903, "last_edit_date": 1594154964, "question_id": 51751026, "link": "https://stackoverflow.com/questions/51751026/how-to-play-an-audio-file-mp3-in-a-cell-when-a-button-click-in-microsoft-exce", "title": "How to play an audio file (.Mp3) in a cell when a button click in Microsoft Excel", "body": "<p>I need a help in <strong>Microsoft Excel</strong>. How to play an audio file (.Mp3) that are embedded in a cell when a button click. Want it to <strong>play in excel without opening any media player</strong> like Media Player Classic or Windows Media Player etc. </p>\n\n<p><strong>Note:</strong> There are several Audio Files and I added Buttons next to each Audio file. So It can play one Audio file using one button.</p>\n\n<p>What I tried is, I created a <strong>Macro Button</strong> and I added this code,</p>\n\n<pre><code>Sub Start_Audio()\n\ny = Range(\"F5\").Value         \nx = ActiveCell.Value          \n\nShell (\"C:\\Program Files\\MPC-HC.1.6.6.6957.x64\\mpc-hc64.exe /startpos \" + x + \" \" + y)\nEnd Sub\n</code></pre>\n\n<p>But that code gives me an error.\nPlease anyone can help me? Thanks in advance.</p>\n"}, {"tags": ["vba", "excel", "function"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1533743860, "post_id": 51750935, "comment_id": 90461775, "body": "Try changing <code>ActiveCell</code> to <code>cell</code>"}, {"owner": {"reputation": 25, "user_id": 10043951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fb4b2b4f764d1bedd2a4d286a39787a?s=128&d=identicon&r=PG&f=1", "display_name": "Juan Pablo Alfonso Santos", "link": "https://stackoverflow.com/users/10043951/juan-pablo-alfonso-santos"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1533747021, "post_id": 51750935, "comment_id": 90463472, "body": "yep, that did it, didn&#180;t even realize that, Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 40, "user_id": 10165736, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bRim3GUnX_w/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ppywRDXmj6Z5qL4bcjB34IxVp2nQ/mo/photo.jpg?sz=128", "display_name": "Kau&#234; Delmonte", "link": "https://stackoverflow.com/users/10165736/kau%c3%aa-delmonte"}, "is_accepted": false, "score": 0, "last_activity_date": 1533747193, "creation_date": 1533747193, "answer_id": 51751871, "question_id": 51750935, "link": "https://stackoverflow.com/questions/51750935/how-to-look-for-a-value-in-another-worksheet-based-on-2-criteria-vba/51751871#51751871", "title": "How to look for a value in another worksheet based on 2 criteria? VBA", "body": "<p>Try to use Range.find to find some value in a range. </p>\n\n<p>The problem in your code is that your using <strong>Activecell</strong> instead of your declared range \"<strong>cell</strong>\".</p>\n\n<pre><code>Function PrecioUni(lic As String, part As Integer) As Double\n\n    Dim cell As Range\n\n    Set partidas = Worksheets(\"An\u00e1lisis AP\").Range(\"C13:C5000\")\n\n    Select Case lic\n\n    Case \"Licitante 1\"\n\n        Set cell = partidas.Find(part, lookAt:=xwhole)\n\n        If Not cell Is Nothing Then PrecioUni = cell.Offset(, 10).Value\n\n    Case \"Licitante 2\"\n\n        '[...]\n\n    End Select\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1078, "user_id": 3124273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d5afe2c849c7123fd07f6ad1349bd2?s=128&d=identicon&r=PG&f=1", "display_name": "cronos2546", "link": "https://stackoverflow.com/users/3124273/cronos2546"}, "is_accepted": false, "score": 0, "last_activity_date": 1533747201, "creation_date": 1533747201, "answer_id": 51751876, "question_id": 51750935, "link": "https://stackoverflow.com/questions/51750935/how-to-look-for-a-value-in-another-worksheet-based-on-2-criteria-vba/51751876#51751876", "title": "How to look for a value in another worksheet based on 2 criteria? VBA", "body": "<p>Need to use your iterating variable and possibly convert the values. </p>\n\n<p><code>If part = CInt(Cell.Value) Then</code></p>\n\n<p><code>PrecioUni = Cdbl(Cell.Offset(0, 10).Value)</code></p>\n"}], "owner": {"reputation": 25, "user_id": 10043951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fb4b2b4f764d1bedd2a4d286a39787a?s=128&d=identicon&r=PG&f=1", "display_name": "Juan Pablo Alfonso Santos", "link": "https://stackoverflow.com/users/10043951/juan-pablo-alfonso-santos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1533747201, "creation_date": 1533743675, "question_id": 51750935, "link": "https://stackoverflow.com/questions/51750935/how-to-look-for-a-value-in-another-worksheet-based-on-2-criteria-vba", "title": "How to look for a value in another worksheet based on 2 criteria? VBA", "body": "<p>I am trying to develop a function where the result will be a value (which is found in another worksheet) when meeting 2 criteria.</p>\n\n<p>I have as follows:</p>\n\n<pre><code>Function PrecioUni(lic As String, part As Integer) As Double\n\nDim cell As Range\n\nSet partidas = Worksheets(\"An\u00e1lisis AP\").Range(\"C13:C5000\")\n\nSelect Case lic\n\n    Case \"Licitante 1\"\n\n        For Each cell In partidas\n            If part = ActiveCell.Value Then\n                PrecioUni = ActiveCell.Offset(0, 10).Value\n\n            End If\n\n        Next cell\n\n\nEnd Select\nEnd Function\n</code></pre>\n\n<p>There are 20 different lic= \"Licitante 1, Licitante 2, ...\" which is why I only put the first Case, and will write the rest when it works (as i would only have to change a few details).</p>\n\n<p>The goal is to select 2 criteria (lic as String, part as Integer), after it has met criteria \"Licitante 1\",  look in the range partidas until it finds the same value as part, and finally return the value of the cell 10 columns to its right. </p>\n\n<p>I believe the  issue lies in the If, but I am not sure, I would appreciate any help given, Thanks!</p>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1533743791, "post_id": 51750917, "comment_id": 90461742, "body": "Please show more of the HTML and the URL if possible and explain exactly what data you are expecting to see retrieved. Use actual HTML as is rather than any shorthanding and please use the snippet tool to add the HTML as code  not an image"}, {"owner": {"reputation": 115, "user_id": 8061014, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b02c807003fcda1654d5fbc862d8a21e?s=128&d=identicon&r=PG&f=1", "display_name": "user90823745", "link": "https://stackoverflow.com/users/8061014/user90823745"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1533744120, "post_id": 51750917, "comment_id": 90461922, "body": "@QHarr Added the link and the entire block of html code I&#39;m interested in"}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 8061014, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b02c807003fcda1654d5fbc862d8a21e?s=128&d=identicon&r=PG&f=1", "display_name": "user90823745", "link": "https://stackoverflow.com/users/8061014/user90823745"}, "edited": false, "score": 0, "creation_date": 1533746260, "post_id": 51751240, "comment_id": 90463067, "body": "And there&#39;s no way to search for the &lt;nobr&gt; tag that has &quot;Target&quot; within using queryselection or otherwise?"}, {"owner": {"reputation": 115, "user_id": 8061014, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b02c807003fcda1654d5fbc862d8a21e?s=128&d=identicon&r=PG&f=1", "display_name": "user90823745", "link": "https://stackoverflow.com/users/8061014/user90823745"}, "edited": false, "score": 0, "creation_date": 1533748707, "post_id": 51751240, "comment_id": 90464368, "body": "Would you mind explaining how to get to the CSS Query like you did in your post?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 115, "user_id": 8061014, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b02c807003fcda1654d5fbc862d8a21e?s=128&d=identicon&r=PG&f=1", "display_name": "user90823745", "link": "https://stackoverflow.com/users/8061014/user90823745"}, "edited": false, "score": 0, "creation_date": 1533752404, "post_id": 51751240, "comment_id": 90466346, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/177672/discussion-between-qharr-and-user90823745\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1534832263, "last_edit_date": 1534832263, "creation_date": 1533744667, "answer_id": 51751240, "question_id": 51750917, "link": "https://stackoverflow.com/questions/51750917/vba-extracting-only-select-info-between-div-tags/51751240#51751240", "title": "VBA extracting only select info between &lt;div&gt; tags", "body": "<p><strong>CSS selector:</strong></p>\n\n<p>You can use a CSS selector combination to target the element of interest.</p>\n\n<p>The data is in a <code>div</code>, that is inside an element with class <code>td51</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/NeX7x.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NeX7x.png\" alt=\"class\"></a></p>\n\n<p>You can write a CSS selector combination to target this pattern of:</p>\n\n<pre><code>.td51 div\n</code></pre>\n\n<p>This says elements with <code>div</code> tag whose parent is <code>td51</code> class. Where <code>\".\"</code> is a class selector.</p>\n\n<p>The element space element pattern is known as a <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors\" rel=\"nofollow noreferrer\">descendant combinator</a>.</p>\n\n<hr>\n\n<p><strong>CSS query results:</strong></p>\n\n<p>This pattern matches multiple elements and you want the item as index 6.</p>\n\n<p><a href=\"https://i.stack.imgur.com/dlWfIm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dlWfIm.png\" alt=\"query\"></a></p>\n\n<p>As multiple items are retrieved you use the <code>querySelectorAll</code> to apply the CSS combinator and retrieve a <code>nodeList</code> you index into to get the item of interest.</p>\n\n<p>As you only want part of the information retrieved you can use <code>split</code> to \"slice\" out the required info. Note that <code>Kit</code> is not <code>Kit</code> alone but is <code>Kit (CD117)</code>.</p>\n\n<hr>\n\n<h2>XMLHTTPRequest XHR:</h2>\n\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim sResponse As String, i As Long, html As New HTMLDocument, arr() As String, ele As Object\n\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", \"https://www.kegg.jp/dbget-bin/www_bget?dr:D01441\", False\n        .send\n        sResponse = StrConv(.responseBody, vbUnicode)\n    End With\n    With html\n        .body.innerHTML = sResponse\n        On Error Resume Next\n        Set ele = .querySelectorAll(\".td51 div\")(6)\n        On Error GoTo 0\n        If ele Is Nothing Then Exit Sub\n        arr = Split(ele.innerText, Chr$(10))\n    End With\n    For i = LBound(arr) To UBound(arr)\n        Debug.Print Split(arr(i), \"[\")(0)\n    Next i\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>References (VBE > Tools > References):</strong></p>\n\n<ol>\n<li>Microsoft HTML Object Library</li>\n</ol>\n\n<hr>\n\n<h2>Internet Explorer:</h2>\n\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim ie As New InternetExplorer, html As HTMLDocument, arr() As String, ele As Object, i As Long\n\n    With ie\n        .Visible = True\n        .navigate \"https://www.kegg.jp/dbget-bin/www_bget?dr:D01441\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        Set html = .document\n        On Error Resume Next\n        Set ele = html.querySelectorAll(\".td51 div\")(6)\n        On Error GoTo 0\n\n        If ele Is Nothing Then Exit Sub  \n        arr = Split(ele.innerText, Chr$(10))\n\n        For i = LBound(arr) To UBound(arr)\n            Debug.Print Split(arr(i), \"[\")(0)\n        Next i\n        '.Quit '&lt;== Remember to quit application\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>References:</strong></p>\n\n<ol>\n<li>Microsoft Internet Controls</li>\n<li>Microsoft HTML Object Library</li>\n</ol>\n\n<hr>\n\n<h2>EDIT:</h2>\n\n<p>This has become rather long but following our debugging to merge with your other code:</p>\n\n<pre><code>Option Explicit\nPublic Sub ht()\n    Dim ie As Object, ele As Object, i As Long\n    Dim sourceSheet As Worksheet, lastRow As Long, rawString() As String, rowIndex As Long\n    Dim arrayOfValues() As Variant, html As HTMLDocument, arr() As String\n    Const URL As String = \"https://www.genome.jp/kegg/drug/\"\n    Set sourceSheet = Worksheets(\"Sheet1\")\n    lastRow = sourceSheet.Range(\"A30000\").End(xlUp).Row\n    arrayOfValues = sourceSheet.Range(\"A1:A\" &amp; lastRow)\n\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n    With ie\n        .Visible = True\n\n        For rowIndex = 1 To lastRow\n            .navigate URL\n            Do While .readyState &lt;&gt; 4 Or .Busy: DoEvents: Loop\n\n            rawString = VBA.Strings.Split(VBA.Strings.LCase$(arrayOfValues(rowIndex, 1)), \": \", -1, vbBinaryCompare)\n\n            'MsgBox rawString(1)\n            .document.querySelector(\"input[name=q]\").Value = rawString(1)\n            .document.querySelector(\"input[value=Go]\").Click\n\n            Do While .readyState &lt;&gt; 4 Or .Busy: DoEvents: Loop\n\n            Dim ele2 As Object\n            On Error Resume Next\n            Set ele2 = .document.querySelector(\"a[href^='/dbget-bin/www_bget?dr:']\")\n            On Error GoTo 0\n            If ele2 Is Nothing Then GoTo NextLink\n            ele2.Click\n\n            Do While .readyState &lt;&gt; 4 Or .Busy: DoEvents: Loop\n\n            Set html = .document\n            On Error Resume Next\n            Set ele = html.querySelectorAll(\".td51 div\")(6)\n            On Error GoTo 0\n\n            If Not ele Is Nothing Then\n                arr = Split(ele.innerText, Chr$(10))\n                For i = LBound(arr) To UBound(arr)\n                    Debug.Print Split(arr(i), \"[\")(0)\n                Next i\n            End If\nNextLink:\n        Next rowIndex\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 8061014, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b02c807003fcda1654d5fbc862d8a21e?s=128&d=identicon&r=PG&f=1", "display_name": "user90823745", "link": "https://stackoverflow.com/users/8061014/user90823745"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1001, "favorite_count": 0, "accepted_answer_id": 51751240, "answer_count": 1, "score": 1, "last_activity_date": 1534832263, "creation_date": 1533743619, "last_edit_date": 1533817724, "question_id": 51750917, "link": "https://stackoverflow.com/questions/51750917/vba-extracting-only-select-info-between-div-tags", "title": "VBA extracting only select info between &lt;div&gt; tags", "body": "<p>I'm trying to check if the html tag:</p>\n\n<pre><code>&lt;nobr&gt;Target&lt;/nobr&gt;\n</code></pre>\n\n<p>exists on the page, and if it does, search for the text between the html tag:</p>\n\n<pre><code>&lt;div style='width: 555px; -ms-overflow-x: auto; -ms-overflow-y: hidden;&gt; ... &lt;/div&gt;\n</code></pre>\n\n<p>The text between the div tags look messy like: </p>\n\n<pre><code>ABC [HSA: \n&lt;a href=\"...\"&gt;...&lt;/a&gt;\n] [KO:\n&lt;a href=\"...\"&gt;...&lt;/a&gt;\n]\n&lt;br /&gt;\nGHI-JK [JKI:\n...    \n</code></pre>\n\n<p>And I want to get and print to my spreadsheet however many items there are, but I only want the item name (in the above example, there're 2 items - ABC and GHI-JK).</p>\n\n<p>Of course my code below doesn't work., I don't think I'm using queryselector correctly and I'm also not sure how to only grab the item names, instead of the entirety between the  tags</p>\n\n<pre><code>If IE.document.querySelector(\"nobr\").innerHTML = \"Target\" Then\n    If IE.document.querySelector(\"div[style^='width: 555px; -ms-overflow-x: auto; -ms-overflow-y: hidden;']\") &lt;&gt; 0 Then\n         Cells(1, 15).Value = IE.document.querySelector(\"div[style^='width: 555px; -ms-overflow-x: auto; -ms-overflow-y: hidden;']\").innerText\n    End If\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 35, "user_id": 9903496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d131a8c4a45bd3f22e6c2da6e0ec39bb?s=128&d=identicon&r=PG&f=1", "display_name": "DYilm", "link": "https://stackoverflow.com/users/9903496/dyilm"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1533744218, "post_id": 51750880, "comment_id": 90461974, "body": "@HansUp now I am getting a new error on the line &quot;rs.AddNew&quot; and it says current recordset does not support updating. This may be a limitation of the provider, or of the selected locktype."}, {"owner": {"reputation": 35, "user_id": 9903496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d131a8c4a45bd3f22e6c2da6e0ec39bb?s=128&d=identicon&r=PG&f=1", "display_name": "DYilm", "link": "https://stackoverflow.com/users/9903496/dyilm"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1533745072, "post_id": 51750880, "comment_id": 90462441, "body": "@HansUp none of those worked unfortunately, still error &quot;current recordset does not support updating. This may be a limitation of the provider, or of the selected locktype&quot;"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1533745645, "post_id": 51750880, "comment_id": 90462748, "body": "<code>rs.Open &quot;Table1&quot;, cn, adOpenKeyset, adLockPessimistic</code>"}, {"owner": {"reputation": 35, "user_id": 9903496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d131a8c4a45bd3f22e6c2da6e0ec39bb?s=128&d=identicon&r=PG&f=1", "display_name": "DYilm", "link": "https://stackoverflow.com/users/9903496/dyilm"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1533746445, "post_id": 51750880, "comment_id": 90463158, "body": "@HansUp that seems to have fixed it, but now it is giving me an error &quot;Invalid SQL statement expected &quot;Delete&quot;, &quot;Insert&quot;, &quot;Procedure&quot;,  &quot;Select&quot;, or &quot;Update&quot; &quot; on the same line, I think I am missing another argument"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1533746861, "post_id": 51750880, "comment_id": 90463388, "body": "See Ibo&#39;s answer.  Sorry I don&#39;t use ADO; this is easier with DAO."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 9903496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d131a8c4a45bd3f22e6c2da6e0ec39bb?s=128&d=identicon&r=PG&f=1", "display_name": "DYilm", "link": "https://stackoverflow.com/users/9903496/dyilm"}, "edited": false, "score": 0, "creation_date": 1533747014, "post_id": 51751758, "comment_id": 90463468, "body": "Synthax error FROM clause in the line rs.Open qry, cn, adOpenKeyset,adLockOptimistic, adCmdTable"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 35, "user_id": 9903496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d131a8c4a45bd3f22e6c2da6e0ec39bb?s=128&d=identicon&r=PG&f=1", "display_name": "DYilm", "link": "https://stackoverflow.com/users/9903496/dyilm"}, "edited": false, "score": 1, "creation_date": 1533747090, "post_id": 51751758, "comment_id": 90463524, "body": "try without adCmdTable"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 35, "user_id": 9903496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d131a8c4a45bd3f22e6c2da6e0ec39bb?s=128&d=identicon&r=PG&f=1", "display_name": "DYilm", "link": "https://stackoverflow.com/users/9903496/dyilm"}, "edited": false, "score": 0, "creation_date": 1533747315, "post_id": 51751758, "comment_id": 90463647, "body": "Do you have Table1 in your ACCESS database? try to close everything because if you are in design mode etc your connection/queries will fail"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 2, "creation_date": 1533747405, "post_id": 51751758, "comment_id": 90463706, "body": "If you use <code>adCmdTable</code>, you need to only pass the table name, not an SQL query, that&#39;s what&#39;s causing this error"}, {"owner": {"reputation": 35, "user_id": 9903496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d131a8c4a45bd3f22e6c2da6e0ec39bb?s=128&d=identicon&r=PG&f=1", "display_name": "DYilm", "link": "https://stackoverflow.com/users/9903496/dyilm"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1533748437, "post_id": 51751758, "comment_id": 90464215, "body": "@ErikvonAsmuth yes that was the problem, thank you for your comment!"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 1, "creation_date": 1533748590, "post_id": 51751758, "comment_id": 90464294, "body": "also use an explicit referencing for the range, for example use <code>rs(&quot;field1&quot;).value=WS.range(&quot;A1&quot;)</code> where <code>WS</code> is a worksheet object (<code>set WS=Thisworkbook.Worksheets(&quot;Sheet1&quot;)</code>)"}], "tags": [], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "is_accepted": true, "score": 2, "last_activity_date": 1533748840, "last_edit_date": 1533748840, "creation_date": 1533746721, "answer_id": 51751758, "question_id": 51750880, "link": "https://stackoverflow.com/questions/51750880/append-data-to-access-table-with-ado-using-excel-vba/51751758#51751758", "title": "Append data to Access Table with ADO using Excel VBA", "body": "<p>You need to specify your recordset to be update-able:</p>\n\n<pre><code>rs.Open qry, cn, adOpenKeyset, adLockOptimistic\n</code></pre>\n\n<p>since your query is simply getting all of the records you can use <code>adCmdTable</code> option, but you have to pass the name of the table only:</p>\n\n<pre><code>rs.Open \"Table1\", cn, adOpenKeyset, adLockOptimistic, adCmdTable\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 9903496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d131a8c4a45bd3f22e6c2da6e0ec39bb?s=128&d=identicon&r=PG&f=1", "display_name": "DYilm", "link": "https://stackoverflow.com/users/9903496/dyilm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3244, "favorite_count": 0, "accepted_answer_id": 51751758, "answer_count": 1, "score": 1, "last_activity_date": 1605090342, "creation_date": 1533743529, "last_edit_date": 1605090342, "question_id": 51750880, "link": "https://stackoverflow.com/questions/51750880/append-data-to-access-table-with-ado-using-excel-vba", "title": "Append data to Access Table with ADO using Excel VBA", "body": "<p>I am trying to append Excel data to an Access table using Excel VBA.</p>\n<p>I have data in a worksheet in Excel (active worksheet). I would like to append the contents of the row A4-BL4 to a Table in Access called Table1.</p>\n<p>I am trying to do this with ADO and a recordset.</p>\n<p>My code gives me an error</p>\n<blockquote>\n<p>Arguments of the wrong type, are out of acceptable range, or are in conflict with one another</p>\n</blockquote>\n<p>on the line:</p>\n<pre><code> rs.Open qry, cn, adOpenKeyset\n</code></pre>\n<p>I am new to working with Access.</p>\n<p><em>It is crucial this be triggered from Excel not Access</em></p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub EXPORT()\n\n    Application.ScreenUpdating = False\n\n    Dim cn As ADODB.Connection\n    Dim rs As New ADODB.Recordset\n\n    Set cn = New ADODB.Connection\n\n    strcon = &quot;Provider=Microsoft.ACE.OLEDB.12.0;&quot; &amp; _\n    &quot;Data Source=C:\\Users\\yilmadu001\\Desktop\\Database.accdb;&quot;\n \n    cn.Open (strcon)\n\n    qry = &quot;SELECT * FROM Table1&quot;\n    rs.Open qry, cn, adOpenKeyset\n\n    rs.AddNew\n    rs.Fields(&quot;Date&quot;) = Range(&quot;A4&quot;).Value\n    rs.Fields(&quot;Order Number&quot;) = Range(&quot;B4&quot;).Value\n    rs.Fields(&quot;Product Code&quot;) = Range(&quot;C4&quot;).Value\n    rs.Fields(&quot;E-Number&quot;) = Range(&quot;D4&quot;).Value\n    rs.Fields(&quot;size&quot;) = Range(&quot;E4&quot;).Value\n    rs.Fields(&quot;type&quot;) = Range(&quot;F4&quot;).Value\n    rs.Fields(&quot;type2&quot;) = Range(&quot;G4&quot;).Value\n\n    rs.Fields(&quot;Voltage&quot;) = Range(&quot;H4&quot;).Value\n    rs.Fields(&quot;Compound&quot;) = Range(&quot;I4&quot;).Value\n    rs.Fields(&quot;Number&quot;) = Range(&quot;J4&quot;).Value\n    rs.Fields(&quot;Tag Number&quot;) = Range(&quot;K4&quot;).Value\n    rs.Fields(&quot;Quantity&quot;) = Range(&quot;L4&quot;).Value\n    rs.Fields(&quot;zero&quot;) = Range(&quot;M4&quot;).Value\n    rs.Fields(&quot;net&quot;) = Range(&quot;N4&quot;).Value\n\n    rs.Fields(&quot;Actual net&quot;) = Range(&quot;O4&quot;).Value\n    rs.Fields(&quot;min&quot;) = Range(&quot;P4&quot;).Value\n    rs.Fields(&quot;Actual min&quot;) = Range(&quot;Q4&quot;).Value\n    rs.Fields(&quot;max1&quot;) = Range(&quot;R4&quot;).Value\n    rs.Fields(&quot;max2&quot;) = Range(&quot;S4&quot;).Value\n    rs.Fields(&quot;Top&quot;) = Range(&quot;T4&quot;).Value\n    rs.Fields(&quot;2&quot;) = Range(&quot;U4&quot;).Value\n\n    rs.Fields(&quot;side&quot;) = Range(&quot;V4&quot;).Value\n    rs.Fields(&quot;5&quot;) = Range(&quot;W4&quot;).Value\n    rs.Fields(&quot;Bottom&quot;) = Range(&quot;X4&quot;).Value\n    rs.Fields(&quot;8&quot;) = Range(&quot;Y4&quot;).Value\n    rs.Fields(&quot;side2&quot;) = Range(&quot;Z4&quot;).Value\n    rs.Fields(&quot;10&quot;) = Range(&quot;AA4&quot;).Value\n    rs.Fields(&quot;set1&quot;) = Range(&quot;AB4&quot;).Value\n\n    rs.Fields(&quot;set2&quot;) = Range(&quot;AC4&quot;).Value\n    rs.Fields(&quot;set3&quot;) = Range(&quot;AD4&quot;).Value\n    rs.Fields(&quot;Usage1&quot;) = Range(&quot;AE4&quot;).Value\n    rs.Fields(&quot;Usage2&quot;) = Range(&quot;AF4&quot;).Value\n    rs.Fields(&quot;Main (%)&quot;) = Range(&quot;AG4&quot;).Value\n    rs.Fields(&quot;A (%)&quot;) = Range(&quot;AH4&quot;).Value\n    rs.Fields(&quot;ratio (%)&quot;) = Range(&quot;AI4&quot;).Value\n\n    rs.Fields(&quot;set3&quot;) = Range(&quot;AJ4&quot;).Value\n    rs.Fields(&quot;set4&quot;) = Range(&quot;AK4&quot;).Value\n    rs.Fields(&quot;Core &quot;) = Range(&quot;AL4&quot;).Value\n    rs.Fields(&quot;Tip1&quot;) = Range(&quot;AM4&quot;).Value\n    rs.Fields(&quot;Tip2&quot;) = Range(&quot;AN4&quot;).Value\n    rs.Fields(&quot;Tip3&quot;) = Range(&quot;AO4&quot;).Value\n    rs.Fields(&quot;set5&quot;) = Range(&quot;AP4&quot;).Value\n\n    rs.Fields(&quot;speed&quot;) = Range(&quot;AQ4&quot;).Value\n    rs.Fields(&quot;speed2&quot;) = Range(&quot;AR4&quot;).Value\n    rs.Fields(&quot;speed3&quot;) = Range(&quot;AS4&quot;).Value\n    rs.Fields(&quot;speed4&quot;) = Range(&quot;AT4&quot;).Value\n    rs.Fields(&quot;speed5&quot;) = Range(&quot;AU4&quot;).Value\n    rs.Fields(&quot;speed6&quot;) = Range(&quot;AV4&quot;).Value\n    rs.Fields(&quot;speed7&quot;) = Range(&quot;AW4&quot;).Value\n\n    rs.Fields(&quot;setting&quot;) = Range(&quot;AX4&quot;).Value\n    rs.Fields(&quot;Selected&quot;) = Range(&quot;AY4&quot;).Value\n    rs.Fields(&quot;S/U1&quot;) = Range(&quot;AZ4&quot;).Value\n    rs.Fields(&quot;S/U2&quot;) = Range(&quot;BA4&quot;).Value\n    rs.Fields(&quot;S/U3&quot;) = Range(&quot;BB4&quot;).Value\n\n    rs.Fields(&quot;ON/OFF&quot;) = Range(&quot;BC4&quot;).Value\n    rs.Fields(&quot;YES/NO&quot;) = Range(&quot;BD4&quot;).Value\n    rs.Fields(&quot;NOTES&quot;) = Range(&quot;BE4&quot;).Value\n    rs.Fields(&quot;Size1&quot;) = Range(&quot;BF4&quot;).Value\n    rs.Fields(&quot;Size2&quot;) = Range(&quot;BG4&quot;).Value\n    rs.Fields(&quot;Size3&quot;) = Range(&quot;BH4&quot;).Value\n    rs.Fields(&quot;Temp1&quot;) = Range(&quot;BI4&quot;).Value\n\n    rs.Fields(&quot;Temp2&quot;) = Range(&quot;BJ4&quot;).Value\n    rs.Fields(&quot;Temp3&quot;) = Range(&quot;BK4&quot;).Value\n    rs.Fields(&quot;Temp4&quot;) = Range(&quot;BL4&quot;).Value\n\n    rs.Update\n\n    rs.Close\n    db.Close\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "class"], "comments": [{"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1533743339, "post_id": 51750639, "comment_id": 90461471, "body": "@c-george: you might want to take a look at <a href=\"https://stackoverflow.com/questions/19373081/how-to-use-the-implements-in-excel-vba/26604768\">How to use Implements in VBA</a>"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1533743462, "post_id": 51750639, "comment_id": 90461545, "body": "@c-george: and here is the other one: <a href=\"https://stackoverflow.com/questions/19881863/how-to-use-comparison-methods-between-class-object-modules-in-vba-in-a-similar-m\">How to use comparison methods between class object modules in VBA in a similar manner as VB.NET?</a>"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1533744009, "post_id": 51750639, "comment_id": 90461855, "body": "@c-george: and this might also be worthwhile reading: <a href=\"https://excelmacromastery.com/vba-class-modules/\" rel=\"nofollow noreferrer\">VBA Class Modules \u2013 The Ultimate Guide</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1533746811, "post_id": 51750639, "comment_id": 90463358, "body": "You are conflating <i>class</i> and <i>object</i>. An object is an <i>instance</i> of a class. A class is a <i>blueprint</i> for an object; its only purpose is to define the <i>shape</i>, i.e. the <i>interface</i> of the object. An object can only ever exists at run-time."}], "answers": [{"tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": false, "score": 0, "last_activity_date": 1533750822, "creation_date": 1533750822, "answer_id": 51752865, "question_id": 51750639, "link": "https://stackoverflow.com/questions/51750639/vba-is-it-possible-to-create-define-a-class-as-a-specific-instead-of-another-e/51752865#51752865", "title": "VBA: Is it possible to create/define a class as a specific instead of another, existing class?", "body": "<p>What you need is static class.</p>\n\n<p>For it to work, you need to make just one change. Say, you have this class called <code>SpecialWorkbook</code>:</p>\n\n<pre><code>Option Explicit\n\nPrivate m_workbook_path As String\n\nPrivate Sub Class_Initialize()\n    m_workbook_path = \"C:\\Temp\\static_class\\mybook.xlsx\"\nEnd Sub\n\nPublic Property Get Path() As String\n    Path = m_workbook_path\nEnd Property\n</code></pre>\n\n<ol>\n<li><p>You need to remove this class with exporting (Remove SpecialWorkbook -> Yes -> Select location).</p></li>\n<li><p>Open SpecialWorkbook.cls in any text editor and change <code>Attribute VB_PredeclaredId = False</code> to <code>Attribute VB_PredeclaredId = True</code>.</p></li>\n<li><p>Save changes and import this class module back.</p></li>\n</ol>\n\n<p>Now you can use it this way:</p>\n\n<pre><code>Sub F()\n    MsgBox SpecialWorkbook.Path\nEnd Sub\n</code></pre>\n\n<p>Add other properties and methods you need.</p>\n"}], "owner": {"reputation": 39, "user_id": 8838800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10ce576946cfe165422df91265e9c0ea?s=128&d=identicon&r=PG&f=1", "display_name": "C.George", "link": "https://stackoverflow.com/users/8838800/c-george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1533750822, "creation_date": 1533742751, "last_edit_date": 1533748010, "question_id": 51750639, "link": "https://stackoverflow.com/questions/51750639/vba-is-it-possible-to-create-define-a-class-as-a-specific-instead-of-another-e", "title": "VBA: Is it possible to create/define a class as a specific instead of another, existing class?", "body": "<p>I am wondering if, in VBA, it's possible to define and create a class object that is a specific instance of another, existing class object.  For example, I would like to create a class called SpecialWorkbook which has properties specific to a unique workbook (class) in my directory. These properties would include Path, Name, FullName (Path &amp; Name), Password, etc. </p>\n\n<p>I know it would be possible to access all of the properties of the Application.Workbook class -- </p>\n\n<pre><code>With Application.Workbooks(SpecialWorkbook.Name)\n</code></pre>\n\n<p>-- but that route may seem unintuitive to a user since the SpecialWorkbook class does not have the properties and methods of a standard Workbook class.</p>\n\n<p>Would it be possible to do something like:</p>\n\n<pre><code>'In Class Module \"SpecialWorkbook\"\n\nPrivate Sub Class_Initialize()\n\n    Dim SpecialWorkbook as Workbook\n\n    Set SpecialWorkbook = Application.Workbook(\"SpecialFileName.xlsx\")\n\nEnd Sub\n</code></pre>\n\n<p>And then use it like:</p>\n\n<pre><code>'In Standard Module\n\nSpecialWorkbook.sheets.count\n</code></pre>\n\n<p>The above \"for instance\" obviously doesn't work but that's the general idea I would like to implement if possible.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 2, "creation_date": 1533742935, "post_id": 51750529, "comment_id": 90461234, "body": "What exactly is your question?"}, {"owner": {"reputation": 11, "user_id": 10197537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfffe5acfe8ebce3c8bc9d8c8fbe1e09?s=128&d=identicon&r=PG&f=1", "display_name": "Dawn", "link": "https://stackoverflow.com/users/10197537/dawn"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1533743310, "post_id": 51750529, "comment_id": 90461462, "body": "Sorry, this is an example i found online. I want to search for a key phrase on a website i.e &quot;contractor name&quot; and then have the details underneath that phrase copied into my excel spreadsheet."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1533743416, "post_id": 51750529, "comment_id": 90461520, "body": "Since you&#39;re &#39;working on it&#39; I&#39;d much rather see the changes that you&#39;ve made to it instead and help you work through it :)"}, {"owner": {"reputation": 11, "user_id": 10197537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfffe5acfe8ebce3c8bc9d8c8fbe1e09?s=128&d=identicon&r=PG&f=1", "display_name": "Dawn", "link": "https://stackoverflow.com/users/10197537/dawn"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1533745601, "post_id": 51750529, "comment_id": 90462717, "body": "Added my latest update, struggling with a command to write to excel and find text underneath a key phrase."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1533745752, "post_id": 51750529, "comment_id": 90462799, "body": "to find text under the cell, try <code>MsgBox Cell.Offset(1,0).Value2</code>"}, {"owner": {"reputation": 11, "user_id": 10197537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfffe5acfe8ebce3c8bc9d8c8fbe1e09?s=128&d=identicon&r=PG&f=1", "display_name": "Dawn", "link": "https://stackoverflow.com/users/10197537/dawn"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1533755417, "post_id": 51750529, "comment_id": 90467765, "body": "Thanks for the help, I&#39;ve change the code around a little. Getting issues with <code>For Each Cell In html</code>"}, {"owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 1, "creation_date": 1533755808, "post_id": 51750529, "comment_id": 90467923, "body": "&quot;htlm&quot; is an HTLM document representing the contents of your webpage, not an Excel range. It doesn&#39;t make any sense to loop through each cell in it, since it doesn&#39;t have any cells."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1533757479, "post_id": 51750529, "comment_id": 90468626, "body": "@JoshEller actually i&#39;m not so sure, this site makes it look like you might be able to do it <a href=\"https://www.automateexcel.com/vba/automate-internet-explorer-ie-using/\" rel=\"nofollow noreferrer\">automateexcel.com/vba/automate-internet-explorer-ie-using</a>"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1533757503, "post_id": 51750529, "comment_id": 90468641, "body": "Dawn, what do you mean by you&#39;re &quot;getting issues with&quot; it? what&#39;s happening?"}, {"owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1533757991, "post_id": 51750529, "comment_id": 90468849, "body": "@Marcucciboy2 What are you pointing to on that site? Yes of course you can automate reading from a webpage, but HTML documents don&#39;t have any Excel cells."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1533758311, "post_id": 51750529, "comment_id": 90469003, "body": "@JoshEller under &quot;Open URL and Enter Data in Form Using VBA&quot; : <code>For Each itm In IE.document.all</code> and Dawn&#39;s <code>html</code> item is an <code>ie.document</code>"}, {"owner": {"reputation": 11, "user_id": 10197537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfffe5acfe8ebce3c8bc9d8c8fbe1e09?s=128&d=identicon&r=PG&f=1", "display_name": "Dawn", "link": "https://stackoverflow.com/users/10197537/dawn"}, "edited": false, "score": 0, "creation_date": 1533794575, "post_id": 51750529, "comment_id": 90478677, "body": "I&#39;ve added  my update but getting a compile error: For Each control variable must be a variable or object. This is on Ln 50 and highlights keyword. Thanks"}, {"owner": {"reputation": 11, "user_id": 10197537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfffe5acfe8ebce3c8bc9d8c8fbe1e09?s=128&d=identicon&r=PG&f=1", "display_name": "Dawn", "link": "https://stackoverflow.com/users/10197537/dawn"}, "reply_to_user": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1533796665, "post_id": 51750529, "comment_id": 90479622, "body": "@JoshEller I&#39;m trying to let the user type &#39;Name and address of the contractor&#39; and have vba search the website. Then get the information that is a few lines under that text and get it into Excel"}], "owner": {"reputation": 11, "user_id": 10197537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfffe5acfe8ebce3c8bc9d8c8fbe1e09?s=128&d=identicon&r=PG&f=1", "display_name": "Dawn", "link": "https://stackoverflow.com/users/10197537/dawn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533793807, "creation_date": 1533742381, "last_edit_date": 1533793807, "question_id": 51750529, "link": "https://stackoverflow.com/questions/51750529/looking-at-creating-a-vba-that-the-user-can-search-for-data-and-be-placed-into-a", "title": "Looking at creating a VBA that the user can search for data and be placed into a excel spreadsheet", "body": "<p>Looking at the following code and trying to alter it. I want to search for a key phrase on a website i.e \"contractor name\" and then have the details underneath that phrase copied into my excel spreadsheet.</p>\n\n<p>Code example below, let me know if there's anymore information I can give. I've added my latest changes</p>\n\n<pre><code>Enum READYSTATE\nREADYSTATE_UNINITIALIZED = 0\nREADYSTATE_LOADING = 1\nREADYSTATE_LOADED = 2\nREADYSTATE_INTERACTIVE = 3\nREADYSTATE_COMPLETE = 4\nEnd Enum\n\nSub TedEuropaEuData()\n\n'to refer to the running copy of Internet Explorer\nDim IE As InternetExplorer\n\n'to refer to the HTML document returned\nDim html As HTMLDocument\n\n'to refer to the searching\nDim Range, Keyword$, N%, SearchAgain As VbMsgBoxResult\n\n'open Internet Explorer in memory, and go to website\nSet IE = New InternetExplorer\nIE.Visible = False\nIE.navigate \"https://ted.europa.eu/udl?uri=TED:NOTICE:265491-2018:TEXT:EN:HTML&amp;src=0\"\n\n'Wait until IE is done loading page\nDo While IE.READYSTATE &lt;&gt; READYSTATE_COMPLETE\n    Application.StatusBar = \"Trying to go to TED ...\"\n    DoEvents\nLoop\n\n'show text of HTML document returned\nSet html = IE.document\n\nMsgBox html.DocumentElement.innerHTML\n\n'close down IE and reset status bar\nSet IE = Nothing\nApplication.StatusBar = \"\"\n\n'clear old data out and put titles in\nCells.Clear\n\n'put heading across the top of row 3\nRange(\"A3\").Value = \"Company ID\"\n\nMsgBox \"When finished - click X on the web window to close it \"\nStartSearch:\nN = 0\nKeyword = InputBox(\"Type 'Name and address of the contractor'\", \"Keyword Is ?\")\nIf Keyword = Empty Then GoTo StartSearch\nFor Each Keyword In html\n    If html Like \"*\" &amp; Keyword &amp; \"*\" Then\n        MsgBox Cell.Offset(1, 0).Value2\n\nEnd If\nNext Cell\nIf N = 0 Then MsgBox \"Sorry, no \" &amp; Keyword &amp; \"'s found\", , \"not Found\"\nSearchAgain = MsgBox(\"Another search?\", vbYesNo, \"More?\")\nIf SearchAgain = vbYes Then GoTo StartSearch\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "while-loop"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1533743239, "post_id": 51750510, "comment_id": 90461411, "body": "Looks like it should work. We need some sample data to examine the problem more closely. But you can debug this for yourself... add some statements such as <code>Debug.Print Worksheets(&quot;AMZN&quot;).Range(&quot;q&quot; &amp; row2) &amp; &quot;, length = &quot; &amp; Len(Worksheets(&quot;AMZN&quot;).Range(&quot;q&quot; &amp; row2))</code> and see what you get."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1533744384, "post_id": 51750510, "comment_id": 90462069, "body": "See how <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">proper indentation</a> makes your code structure much easier to follow."}], "owner": {"reputation": 3, "user_id": 10155933, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nVsZFnFVOno/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qjsaZFBLyqnr5dhcKlWZ6AAUqeHA/mo/photo.jpg?sz=128", "display_name": "Cptacorn", "link": "https://stackoverflow.com/users/10155933/cptacorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533760341, "creation_date": 1533742320, "last_edit_date": 1533760341, "question_id": 51750510, "link": "https://stackoverflow.com/questions/51750510/vba-how-do-implement-if-len-in-do-while-function", "title": "VBA How do Implement IF LEN in Do While function?", "body": "<p>I am trying to carry over product IDs from a three other worksheets (AMZN,TGT,WM) into one continuous column (MASTER V2). But one of the sheets has \"dirty\" data with sentences/phrases where an ID should be. </p>\n\n<p>The second do while is where my problem is. I'd like to have the function paste in MASTER V2 if the value is 6 digits long, otherwise skip that row in the AMZN sheet.</p>\n\n<p>Right now it seems to just be pasting over all data, regardless of it's length.</p>\n\n<pre><code>Sub RefMaster()\n\n    Dim lastrow\n    Dim row\n    Dim TGTrow\n    Dim AMZNrow\n    Dim WMrow\n    Dim row2\n\n    TGTrow = Application.CountA(Worksheets(\"TGT\").Range(\"a:A\"))\n    AMZNrow = Application.CountA(Worksheets(\"AMZN\").Range(\"a:a\")) - 2\n    WMrow = Application.CountA(Worksheets(\"WM\").Range(\"a:a\"))\n    row = 2\n    row2 = 2\n\n\n\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n    Application.EnableEvents = False\n\n    Do While row &lt;= TGTrow\n    'TGTStyle\n        Worksheets(\"Master V2\").Range(\"a\" &amp; row) = Worksheets(\"TGT\").Range(\"d\" &amp; row2) &amp; Worksheets(\"TGT\").Range(\"e\" &amp; row2)    'Style\n        row = row + 1\n        row2 = row2 + 1\n    Loop\n\n    row2 = 3\n\n    Do While row &gt; TGTrow And row &lt;= (AMZNrow + TGTrow)\n    'AMZNStyle\n        If Len(Worksheets(\"AMZN\").Range(\"q\" &amp; row2)) = 6 Then\n            Worksheets(\"Master V2\").Range(\"a\" &amp; row) = Worksheets(\"AMZN\").Range(\"q\" &amp; row2)\n            row = row + 1\n            row2 = row2 + 1\n        Else: row2 = row2 + 1\n            AMZNrow = AMZNrow - 1\n        End If\n    Loop\n\n    lastrow = TGTrow + AMZNrow + WMrow\n\n    Do While row &gt; (AMZNrow + TGTrow) And row &lt;= lastrow\n    'WMStyle\n        row = row + 1\n        row2 = row2 + 1\n    Loop\n\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.EnableEvents = True\n\n    ActiveWorkbook.RefreshAll\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1533744829, "post_id": 51750281, "comment_id": 90462306, "body": "Hint: the value of <code>y</code> is carried between iterations, regardless of the outcome of the first <code>If</code> block."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1533744649, "post_id": 51751156, "comment_id": 90462209, "body": "Not only <code>Me</code> refers to the userform instance, it refers to <i>the currently running instance</i>, whereas using the form&#39;s name refers to <i>the default instance</i>, which is the running instance only if you brought up that form <i>using</i> the default instance - IOW running an <i>instance</i> of the form e.g. <code>With New MyForm : .Show : End With</code>, breaks."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1533745891, "post_id": 51751156, "comment_id": 90462870, "body": "Thank you so much both of you for the useful information and help.  The edit you made to the code worked like a charm and did exactly what i needed it to do."}], "tags": [], "owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "is_accepted": true, "score": 1, "last_activity_date": 1533744769, "last_edit_date": 1533744769, "creation_date": 1533744333, "answer_id": 51751156, "question_id": 51750281, "link": "https://stackoverflow.com/questions/51750281/vba-loop-through-textbox-controls-in-userform/51751156#51751156", "title": "VBA Loop through textbox controls in userform", "body": "<p>Try placing the If statement testing for \"ch\" within the If statement testing for \"TextBox\".  Also, you should specify the Name property for the control when checking for its name, otherwise it defaults to its Value property.  Also, as an aside, I would suggest replacing JHKey with the keyword Me, which refers to the userform itself regardless of its name.</p>\n\n<pre><code>Private Sub UserForm_Activate()\n    Dim wb As Workbook\n    Dim wsRR As Worksheet\n    Dim bColor As Range\n    Dim c As Control\n    Dim y As String\n\n    Set wb = Application.ThisWorkbook\n    Set wsRR = wb.Sheets(\"RiskRating\")\n    Set bColor = wsRR.Range(\"C3\")\n\n    For Each c In Me.Controls\n        If TypeName(c) = \"TextBox\" Then\n            y = Left(c.Name, 2)\n            If y = \"ch\" Then\n                c.BackColor = bColor.Interior.Color\n            End If\n        End If\n    Next c\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4460, "favorite_count": 0, "accepted_answer_id": 51751156, "answer_count": 1, "score": 0, "last_activity_date": 1533744769, "creation_date": 1533741600, "last_edit_date": 1533742056, "question_id": 51750281, "link": "https://stackoverflow.com/questions/51750281/vba-loop-through-textbox-controls-in-userform", "title": "VBA Loop through textbox controls in userform", "body": "<p>I have looked through numerous posts on looping through UserForm Controls but cant seem to adjust the code i have found for my needs and need some help.</p>\n\n<p>Scenario I am trying to figure out:</p>\n\n<ol>\n<li><p>I have 44 text boxes on a userform whose names all start with \"ch\"  example \"chTextBox1\"</p></li>\n<li><p>When the userform activates I need to loop through all of the text boxes that start with \"ch\" and change the background color of those textboxes to a color based on the interior color of a cell</p></li>\n</ol>\n\n<p>Below is the code that I have been messing around with and I either end up in an infinite loop or I get </p>\n\n<blockquote>\n  <p>Error 424 </p>\n</blockquote>\n\n<pre><code>Private Sub UserForm_Activate()\n    Dim wb As Workbook\n    Dim wsRR As Worksheet\n    Dim bColor As Range\n    Dim c As Control\n    Dim y As String\n\n    Set wb = Application.ThisWorkbook\n    Set wsRR = wb.Sheets(\"RiskRating\")\n    Set bColor = wsRR.Range(\"C3\")   \n\n    For Each c In JHKey.Controls\n        If TypeName(c) = \"TextBox\" Then\n            y = Left(c, 2)\n        End If\n        If y = \"ch\" Then\n            c.BackColor = bColor.Interior.Color\n        End If\n    Next c\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1533741520, "post_id": 51750189, "comment_id": 90460250, "body": "Use Evaluate: <code>i = Evaluate(&quot;LOOKUP(2,1&#47;((A:A=2018)*(B:B=31)),INDEX(A:AAA,0,MAT&zwnj;&#8203;CH(&quot;&quot;Employee2&quot;&quot;,1:1&zwnj;&#8203;,0)))&quot;)</code>"}, {"owner": {"reputation": 11, "user_id": 10177397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f613ad184119a6ee86e22f9de2a6ae76?s=128&d=identicon&r=PG&f=1", "display_name": "S. Shaw", "link": "https://stackoverflow.com/users/10177397/s-shaw"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1533742375, "post_id": 51750189, "comment_id": 90460872, "body": "Thanks, tigeravatar. Your suggestion of EVALUATE function works well for the formula conversion. It has helped me a lot!!"}, {"owner": {"reputation": 11, "user_id": 10177397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f613ad184119a6ee86e22f9de2a6ae76?s=128&d=identicon&r=PG&f=1", "display_name": "S. Shaw", "link": "https://stackoverflow.com/users/10177397/s-shaw"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1533742788, "post_id": 51750189, "comment_id": 90461130, "body": "Can I use a string variable (say &quot;strEmp&quot; in place of &quot;&quot;Employee2&quot;&quot; in this formula?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1533743499, "post_id": 51750189, "comment_id": 90461568, "body": "Yes, if your variable is <code>strEmp</code> then the line becomes: <code>i = Evaluate(&quot;LOOKUP(2,1&#47;((A:A=2018)*(B:B=31)),INDEX(A:AAA,0,MAT&zwnj;&#8203;CH(&quot; &amp; strEmp &amp; &quot;,1:1,0)))&quot;)</code>"}, {"owner": {"reputation": 11, "user_id": 10177397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f613ad184119a6ee86e22f9de2a6ae76?s=128&d=identicon&r=PG&f=1", "display_name": "S. Shaw", "link": "https://stackoverflow.com/users/10177397/s-shaw"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1533752671, "post_id": 51750189, "comment_id": 90466484, "body": "Thanks for your answer. However I got a Type mismatch error. But I found this to work for me: i = Evaluate(&quot;LOOKUP(2,1/((A:A=2018)*(B:B=31)),INDEX(A:AAA,0,MAT&zwnj;&#8203;CH(&quot;&quot;&quot; &amp; strEmp &amp; &quot;&quot;&quot;,1:1,0)))&quot;)"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1533752748, "post_id": 51750189, "comment_id": 90466528, "body": "Ah, good call, still need to surround the variable with quotes so the formula treats it as a string properly."}], "owner": {"reputation": 11, "user_id": 10177397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f613ad184119a6ee86e22f9de2a6ae76?s=128&d=identicon&r=PG&f=1", "display_name": "S. Shaw", "link": "https://stackoverflow.com/users/10177397/s-shaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533742904, "creation_date": 1533741313, "last_edit_date": 1533742904, "question_id": 51750189, "link": "https://stackoverflow.com/questions/51750189/converting-excel-formula-to-vba-reverse-lookup-multiple-criteria-and-index-ma", "title": "Converting Excel formula to VBA - Reverse LOOKUP, Multiple criteria and INDEX-MATCH", "body": "<p>Please refer to earlier posted question at\n<a href=\"https://stackoverflow.com/questions/51677711/unable-to-use-substituteaddressmatch-combination-as-a-range-in-a-lookup-fun\">Unable to use SUBSTITUTE(ADDRESS(MATCH))) combination as a range in a LOOKUP function in Excel</a></p>\n\n<p>I was recommended this Excel formula to identify a value using reverse look-up by Scott Craner and it works:</p>\n\n<p><code>=LOOKUP(2,1/((A:A=2018)*(B:B=31)),INDEX(A:AAA,0,MATCH(\"Employee2\",1:1,0)))</code></p>\n\n<p>In this case, the answer is numeric 15.</p>\n\n<p>I wanted to convert the same to a VBA code statement using:</p>\n\n<pre><code>Dim i as Integer\n\ni = Application.WorksheetFunction.Lookup(2, 1 / ((Range(\"A:A\") = 2018) * (Range(\"B:B\") = 31)), \nApplication.WorksheetFunction.Index(Range(\"A:AAA\"), 0, \nApplication.WorksheetFunction.Match(\"Employee2\", Range(\"1:1\"), 0)))\n</code></pre>\n\n<p>It gives \"Run-time error '13': Type mismatch\".</p>\n\n<p>Can someone please help me to figure out what I'm not doing right - in terms of converting the Excel formula to VBA?</p>\n\n<p>Thanks for your help in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1533741602, "post_id": 51750097, "comment_id": 90460315, "body": "<code>Worksheet_Change</code> is fired too late - how do you recover the previous value if the new one is invalid?"}, {"owner": {"reputation": 57, "user_id": 9942649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca2a720d916d405b1532727ff5d27dfb?s=128&d=identicon&r=PG&f=1", "display_name": "cexcelc", "link": "https://stackoverflow.com/users/9942649/cexcelc"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1533741774, "post_id": 51750097, "comment_id": 90460451, "body": "@MathieuGuindon the list is stored in another tab, could that be used?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1533742040, "post_id": 51750097, "comment_id": 90460637, "body": "hmm, just noticed the <code>Application.Undo</code> invoke, ignore my previous comment. You need to get an array that contains each element of the validation list - however to do that you need to know whether you&#39;re looking at a hard-coded, comma-separated list of values, or whether the validation list is defined by a named range, or a range address. Note: the undo stack will be cleared if any macro changes any cell anywhere."}, {"owner": {"reputation": 57, "user_id": 9942649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca2a720d916d405b1532727ff5d27dfb?s=128&d=identicon&r=PG&f=1", "display_name": "cexcelc", "link": "https://stackoverflow.com/users/9942649/cexcelc"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1533742148, "post_id": 51750097, "comment_id": 90460704, "body": "@MathieuGuindon the data validation field i am focusing on now is just an entire column in a separate tab. Not hardcoded values or a name ranged list. What do you mean by the undo stack will be cleared if any macro changes any cell?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1533742282, "post_id": 51750097, "comment_id": 90460809, "body": "Then you can get the range address from the validation list, and compare the <code>Target</code> /pasted value with the values in that range."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1533742572, "post_id": 51750097, "comment_id": 90461001, "body": "What I&#39;m not sure of, is whether that handler works <i>as intended</i> at all, given <code>Target</code> isn&#39;t even used or intersected with anything: the handler runs whenever a cell value changes anywhere on the sheet, and then does its thing regardless of where the modified cell actually is: this normally results in unexpected behavior when a cell is modified outside the range that&#39;s assumed by the code."}, {"owner": {"reputation": 593, "user_id": 4650381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZrWhe.jpg?s=128&g=1", "display_name": "elliot svensson", "link": "https://stackoverflow.com/users/4650381/elliot-svensson"}, "edited": false, "score": 0, "creation_date": 1533742745, "post_id": 51750097, "comment_id": 90461104, "body": "@cexcelc, &quot;clearing the undo stack&quot; is the thing that happens when the program can&#39;t undo anymore now that the undo stack is cleared.  This is bad if you were hoping to undo."}, {"owner": {"reputation": 57, "user_id": 9942649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca2a720d916d405b1532727ff5d27dfb?s=128&d=identicon&r=PG&f=1", "display_name": "cexcelc", "link": "https://stackoverflow.com/users/9942649/cexcelc"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1533743030, "post_id": 51750097, "comment_id": 90461282, "body": "@MathieuGuindon I will try to compare the pasted value with the data validation list and see if that works. I am not that great at VBA, will post back here if I run into issues. Thanks for the help!"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 9942649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca2a720d916d405b1532727ff5d27dfb?s=128&d=identicon&r=PG&f=1", "display_name": "cexcelc", "link": "https://stackoverflow.com/users/9942649/cexcelc"}, "edited": false, "score": 0, "creation_date": 1533744830, "post_id": 51750965, "comment_id": 90462307, "body": "I don&#39;t think i&#39;ve used target.Validation for anything? Target is a range but it&#39;s not set to anything. There are multiple columns that have data validation lists in this spreadsheet, but I only care about one of the columns. How does this function know which list to refer to?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 57, "user_id": 9942649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca2a720d916d405b1532727ff5d27dfb?s=128&d=identicon&r=PG&f=1", "display_name": "cexcelc", "link": "https://stackoverflow.com/users/9942649/cexcelc"}, "edited": false, "score": 0, "creation_date": 1533744896, "post_id": 51750965, "comment_id": 90462343, "body": "@cexcelc the function takes a <code>Range</code> parameter: you give it a cell that has data validation in it, and it returns an array that contains all the possible values; there&#39;s not enough information in your question for me to know what specific cell to feed it - I don&#39;t know what <code>Range(&quot;DataValidationRange&quot;)</code> refers to. As <a href=\"https://stackoverflow.com/questions/51750097/pasting-in-data-validation-if-the-value-exists-inside-the-data-validation-list/51750965?noredirect=1#comment90461001_51750097\">I said earlier</a>, something looks off."}, {"owner": {"reputation": 57, "user_id": 9942649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca2a720d916d405b1532727ff5d27dfb?s=128&d=identicon&r=PG&f=1", "display_name": "cexcelc", "link": "https://stackoverflow.com/users/9942649/cexcelc"}, "edited": false, "score": 0, "creation_date": 1533745161, "post_id": 51750965, "comment_id": 90462491, "body": "Ok, if they can paste just 1 cell, or a range of cells (goes down to cell 3000), should I create a loop to check if each value pasted exists in the array?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 57, "user_id": 9942649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca2a720d916d405b1532727ff5d27dfb?s=128&d=identicon&r=PG&f=1", "display_name": "cexcelc", "link": "https://stackoverflow.com/users/9942649/cexcelc"}, "edited": false, "score": 0, "creation_date": 1533745369, "post_id": 51750965, "comment_id": 90462602, "body": "Your handler is completely ignoring the handler&#39;s <code>Target</code> argument, which is what tells you what cell(s) was/were modified. But yes, you&#39;ll want to iterate all the cells in the handler&#39;s <code>Target</code>. There&#39;s a disconnect though: if the user pasted cells and thus removed the validation, you can&#39;t use the handler&#39;s <code>Target</code> to know what the validation rule is supposed to be. This function&#39;s <code>target</code> needs to be a cell that reliably contains your validation rule."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 57, "user_id": 9942649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca2a720d916d405b1532727ff5d27dfb?s=128&d=identicon&r=PG&f=1", "display_name": "cexcelc", "link": "https://stackoverflow.com/users/9942649/cexcelc"}, "edited": false, "score": 0, "creation_date": 1533745467, "post_id": 51750965, "comment_id": 90462645, "body": "You can use <code>Application.WorksheetFunction.Index</code> with the returned array to know if a cell in the handler&#39;s <code>Target</code> contains a value that exists in the data validation list. Or you can iterate the returned array. Or you can... see, there&#39;s multiple ways to skin a cat - use what works best for your case."}, {"owner": {"reputation": 57, "user_id": 9942649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca2a720d916d405b1532727ff5d27dfb?s=128&d=identicon&r=PG&f=1", "display_name": "cexcelc", "link": "https://stackoverflow.com/users/9942649/cexcelc"}, "edited": false, "score": 0, "creation_date": 1533745664, "post_id": 51750965, "comment_id": 90462762, "body": "I see, for more context (based on your edited comment): Range(&quot;DataValidationRange&quot;) is cells P22:P3000 (a named range). If you try and paste in that range (where data validation exists), you get the error. The data validation inside each cell between P22:P3000 refers to a separate tab that has &#39;lookups&#39;, specifically column E:E. So ideally, when something is pasted anywhere in P22:P3000, it should check to see if the value pasted exists in column E:E on the other sheet, and if it does allow the paste, if not then the HasValidation function should kick in"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 57, "user_id": 9942649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca2a720d916d405b1532727ff5d27dfb?s=128&d=identicon&r=PG&f=1", "display_name": "cexcelc", "link": "https://stackoverflow.com/users/9942649/cexcelc"}, "edited": false, "score": 0, "creation_date": 1533746042, "post_id": 51750965, "comment_id": 90462964, "body": "@cexcelc except your approach will only work once; after I pasted a bunch of values, these cells no longer have data validation, and after pasting would-be-illegal values on top of those, the handler happily bails out because there&#39;s no validation anymore."}, {"owner": {"reputation": 57, "user_id": 9942649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca2a720d916d405b1532727ff5d27dfb?s=128&d=identicon&r=PG&f=1", "display_name": "cexcelc", "link": "https://stackoverflow.com/users/9942649/cexcelc"}, "edited": false, "score": 0, "creation_date": 1533746176, "post_id": 51750965, "comment_id": 90463025, "body": "I see, so if something is pasted, even if acceptable, the data validation will be removed therefore allowing a second paste of anything. This would probably be pretty rare, but could happen. Is it possible to add the data validation back to the cells post-paste?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 57, "user_id": 9942649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca2a720d916d405b1532727ff5d27dfb?s=128&d=identicon&r=PG&f=1", "display_name": "cexcelc", "link": "https://stackoverflow.com/users/9942649/cexcelc"}, "edited": false, "score": 1, "creation_date": 1533746238, "post_id": 51750965, "comment_id": 90463061, "body": "Worse: if something is pasted from a cell that contains some other data validation list, it&#39;s pasted <i>along with its own validation list</i>, and now you&#39;re looking at pasted data that has data validation, but not the rules you mean to enforce. RE re-add the <i>correct</i> validation: yes, it&#39;s possible - but for that you need to have the rule <i>somewhere</i>, perhaps in some hidden cell: <i>and that&#39;s the cell the function in this answer means to be working with.</i>"}, {"owner": {"reputation": 57, "user_id": 9942649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca2a720d916d405b1532727ff5d27dfb?s=128&d=identicon&r=PG&f=1", "display_name": "cexcelc", "link": "https://stackoverflow.com/users/9942649/cexcelc"}, "edited": false, "score": 0, "creation_date": 1533746480, "post_id": 51750965, "comment_id": 90463173, "body": "It is very easy to add the correct validation rule somewhere else. Is that what target is supposed to be set to? Or is target my pasted range?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 57, "user_id": 9942649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca2a720d916d405b1532727ff5d27dfb?s=128&d=identicon&r=PG&f=1", "display_name": "cexcelc", "link": "https://stackoverflow.com/users/9942649/cexcelc"}, "edited": false, "score": 0, "creation_date": 1533746614, "post_id": 51750965, "comment_id": 90463240, "body": "The function&#39;s <code>target</code> parameter means to be a cell that contains the data validation rule you mean to apply, yes."}, {"owner": {"reputation": 57, "user_id": 9942649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca2a720d916d405b1532727ff5d27dfb?s=128&d=identicon&r=PG&f=1", "display_name": "cexcelc", "link": "https://stackoverflow.com/users/9942649/cexcelc"}, "edited": false, "score": 0, "creation_date": 1533761885, "post_id": 51750965, "comment_id": 90470759, "body": "Is the Worksheet_Change target supposed to be set to the range that I am pasting to. I have yet to get this to work, not sure what to put into the Worksheet_Change sub"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1596878148, "post_id": 51750965, "comment_id": 111956246, "body": "++ Naicee. Refered this post to <a href=\"https://stackoverflow.com/questions/63313207/importing-data-overwriting-drop-down-list-data\">HERE</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1596891109, "post_id": 51750965, "comment_id": 111959443, "body": "@Sid thanks! I think the hard-coded comma might need to be replaced with the <i>list separator</i> character with <code>Application.International</code>, and that should work whether your system uses <code>,</code> or <code>;</code> for a separator."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 3, "last_activity_date": 1533743765, "creation_date": 1533743765, "answer_id": 51750965, "question_id": 51750097, "link": "https://stackoverflow.com/questions/51750097/pasting-in-data-validation-if-the-value-exists-inside-the-data-validation-list/51750965#51750965", "title": "Pasting in Data Validation IF the value exists inside the data validation list", "body": "<p>If the <code>Validation</code> isn't <code>Nothing</code> and its type is <code>xlValidateList</code> (underlying value <code>3</code>), then you can use <code>Validation.Formula1</code> to get the \"list\".</p>\n\n<p>That's the easy part.</p>\n\n<p>If <code>Formula1</code> doesn't start with an <code>=</code> sign, you're looking at a plain comma-separated list of values.</p>\n\n<p>This function gets you a 1-dimensional array with all the valid values of the specified <code>target</code>, regardless of how the data validation list is defined:</p>\n\n<pre><code>Public Function GetValidationValues(ByVal target As Range) As Variant\n    Dim dataValidation As Validation\n    Set dataValidation = target.Validation\n\n    If dataValidation Is Nothing Then Exit Function\n    If dataValidation.Type &lt;&gt; xlValidateList Then Exit Function\n\n    Dim values As Variant\n    If Left$(dataValidation.Formula1, 1) &lt;&gt; \"=\" Then\n        'plain comma-separated list of values\n        values = Split(dataValidation.Formula1, \",\")\n    Else\n        'validation list is a range address, or a named range\n        Dim rngValues As Range\n        Set rngValues = Application.Evaluate(dataValidation.Formula1)\n        If rngValues.Columns.Count &gt; 1 Then\n            values = Application.Transpose(Application.Transpose(rngValues))\n        Else\n            values = Application.Transpose(rngValues)\n        End If\n    End If\n    GetValidationValues = values\nEnd Function\n</code></pre>\n\n<p>All that's left to do is to determine whether your pasted value is in that array.</p>\n"}], "owner": {"reputation": 57, "user_id": 9942649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca2a720d916d405b1532727ff5d27dfb?s=128&d=identicon&r=PG&f=1", "display_name": "cexcelc", "link": "https://stackoverflow.com/users/9942649/cexcelc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 413, "favorite_count": 1, "accepted_answer_id": 51750965, "answer_count": 1, "score": 1, "last_activity_date": 1533743765, "creation_date": 1533741045, "last_edit_date": 1533742068, "question_id": 51750097, "link": "https://stackoverflow.com/questions/51750097/pasting-in-data-validation-if-the-value-exists-inside-the-data-validation-list", "title": "Pasting in Data Validation IF the value exists inside the data validation list", "body": "<p>A similar question has been asked multiple times, but I have a slightly different ask. I have used some code from superuser that restricts users from pasting values into data validation ranges:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    'Does the validation range still have validation?\n    If HasValidation(Range(\"DataValidationRange\")) Then\n        Exit Sub\n    Else\n        Application.Undo\n        MsgBox \"Error: You cannot paste data into these cells.\" &amp; _\n        \"Please use the drop-down to enter data instead.\", vbCritical\n    End If\nEnd Sub\n\nPrivate Function HasValidation(r) As Boolean\n    'Returns True if every cell in Range r uses Data Validation\n    On Error Resume Next\n    x = r.Validation.Type\n    If Err.Number = 0 Then HasValidation = True Else HasValidation = False\nEnd Function\n</code></pre>\n\n<p>This is great and it works, but I am wondering if it can be taken one step further. The reason users may want to paste into these fields is because they are moving data from one spreadsheet to the other. I have the validation there to ensure the spelling is correct (important for other uses). Is it possible for a user to paste something into the data validation field and it doesn't deny it, based on the code above, IF the value matches something inside the data validation list? Seems ambitious, not sure if it is possible. </p>\n\n<p>Edit: The list is stored in another tab, not hardcoded into the data validation menu</p>\n"}, {"tags": ["vba", "copy"], "answers": [{"comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1533742732, "post_id": 51750566, "comment_id": 90461093, "body": "ya beat me to it!"}, {"owner": {"reputation": 29, "user_id": 10077247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/496b94d25237c102f87b1ec8ce77b934?s=128&d=identicon&r=PG&f=1", "display_name": "Cunneryn", "link": "https://stackoverflow.com/users/10077247/cunneryn"}, "edited": false, "score": 0, "creation_date": 1533749084, "post_id": 51750566, "comment_id": 90464570, "body": "Thanks, that was very useful. and worked perfectly. However, I just realized that (i should have though about it before) some of the cells in the destination column already had value. Therefore, it copied a blank cell. I will then either insert a column or put the consolidated column at the end. Or is there a way to prevent the copy if the cell is not empty?"}, {"owner": {"reputation": 29, "user_id": 10077247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/496b94d25237c102f87b1ec8ce77b934?s=128&d=identicon&r=PG&f=1", "display_name": "Cunneryn", "link": "https://stackoverflow.com/users/10077247/cunneryn"}, "edited": false, "score": 0, "creation_date": 1533750586, "post_id": 51750566, "comment_id": 90465347, "body": "I might have been too quick to say it works. While technically what I asked for definitely works, it seems like it only take the first column in the range In this <i>Set rngTemp1 = .Range(&quot;W2:W&quot; &amp; Lastrow &amp; &quot;, AB2:AB&quot; &amp; Lastrow)</i> , only the column W will be copied, not the following ones"}, {"owner": {"reputation": 28, "user_id": 5822441, "user_type": "registered", "profile_image": "https://graph.facebook.com/10103357907663063/picture?type=large", "display_name": "Ryan", "link": "https://stackoverflow.com/users/5822441/ryan"}, "edited": false, "score": 1, "creation_date": 1533751993, "post_id": 51750566, "comment_id": 90466123, "body": "I&#39;m guessing you want the range to be: <code>.Range(&quot;W2:AB&quot; &amp; Lastrow)</code> (I also updated my answer to ignore blanks)"}], "tags": [], "owner": {"reputation": 28, "user_id": 5822441, "user_type": "registered", "profile_image": "https://graph.facebook.com/10103357907663063/picture?type=large", "display_name": "Ryan", "link": "https://stackoverflow.com/users/5822441/ryan"}, "is_accepted": true, "score": 0, "last_activity_date": 1533752076, "last_edit_date": 1533752076, "creation_date": 1533742489, "answer_id": 51750566, "question_id": 51749825, "link": "https://stackoverflow.com/questions/51749825/copying-a-cell-from-a-selected-range-of-columns-to-a-specific-column-while-keepi/51750566#51750566", "title": "Copying a cell from a selected range of columns to a specific column while keeping the same row", "body": "<p>If I'm reading this right, you're trying to consolidate data across columns into one column? If so, adjust this as needed:</p>\n\n<pre><code>Dim rowStart    as long\nDim cell        as variant\nDim rngTemp1    as excel.range\n\nrowStart = 2\nWith ActiveSheet\n    For Each cell In rngTemp1\n        If Len(cell.Value) &gt; 0 Then\n            .Cells(rowStart, 6).Value = cell.Value\n            rowStart = rowStart + 1\n        End if\n    Next cell\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 10077247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/496b94d25237c102f87b1ec8ce77b934?s=128&d=identicon&r=PG&f=1", "display_name": "Cunneryn", "link": "https://stackoverflow.com/users/10077247/cunneryn"}, "edited": false, "score": 1, "creation_date": 1533749306, "post_id": 51750619, "comment_id": 90464701, "body": "THanks for the reply, very similar to the post before and it worked like charm"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 29, "user_id": 10077247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/496b94d25237c102f87b1ec8ce77b934?s=128&d=identicon&r=PG&f=1", "display_name": "Cunneryn", "link": "https://stackoverflow.com/users/10077247/cunneryn"}, "edited": false, "score": 0, "creation_date": 1533749389, "post_id": 51750619, "comment_id": 90464744, "body": "@Cunneryn Definitely a &#39;great minds think alike&#39; situation ;)"}], "tags": [], "owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "is_accepted": false, "score": 0, "last_activity_date": 1533742701, "creation_date": 1533742701, "answer_id": 51750619, "question_id": 51749825, "link": "https://stackoverflow.com/questions/51749825/copying-a-cell-from-a-selected-range-of-columns-to-a-specific-column-while-keepi/51750619#51750619", "title": "Copying a cell from a selected range of columns to a specific column while keeping the same row", "body": "<p>Here's how I would do it. Just adding in another variable to count the previous row that a value was added into.</p>\n\n<pre><code>With Workbooks(\"ExploringTheRelation.xlsx\").Sheets(\"ExploringTheRelation\")\n\n    'finds the bottom row of data\n    Dim lastRow As Long\n    lastRow = .Cells(Rows.count, 1).End(xlUp).row\n\n    Dim rngTemp1 As Range\n    Set rngTemp1 = .Range(\"W2:W\" &amp; lastRow &amp; \", AB2:AB\" &amp; lastRow)\n\n    Dim rngTemp2 As Range\n    Set rngTemp2 = .Range(\"X2:X\" &amp; lastRow &amp; \", AC2:AC\" &amp; lastRow)\n\n    'keeps track of the last row that a value was put into\n    Dim currRow As Long\n    currRow = 1\n\n    'loops through a range and puts each value into column \"R\" one after another\n    Dim cel As Range\n    For Each cel In rngTemp1\n        .Cells(currRow, \"R\").Value2 = cel.Value2\n        currRow = currRow + 1\n    Next cell\n\n    For Each cel In rngTemp2\n        .Cells(currRow, \"R\").Value2 = cel.Value2\n        currRow = currRow + 1\n    Next cell\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 10077247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/496b94d25237c102f87b1ec8ce77b934?s=128&d=identicon&r=PG&f=1", "display_name": "Cunneryn", "link": "https://stackoverflow.com/users/10077247/cunneryn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 51750566, "answer_count": 2, "score": 0, "last_activity_date": 1533752076, "creation_date": 1533740254, "question_id": 51749825, "link": "https://stackoverflow.com/questions/51749825/copying-a-cell-from-a-selected-range-of-columns-to-a-specific-column-while-keepi", "title": "Copying a cell from a selected range of columns to a specific column while keeping the same row", "body": "<p>I've been trying to organise my data that all of the similar data (found in several column) can be copied to a single column. Here is simplified version of the script I wrote so far (the range includes more column, but I reduced it for visual reasons here). I'm not sure how to tell that I want that i want to copy in this the row where the selected cell is. I hope I'm being clear enough.</p>\n\n<pre><code>Dim value As String\nDim rngTemp1 As Range\nDim rngTemp2 As Range\nDim rngTemp3 As Range\nDim rngTemp4 As Range\nDim rngTemp5 As Range\n\nWith Workbooks(\"ExploringTheRelation.xlsx\").Sheets(\"ExploringTheRelation\")\nLastrow = .Cells(Rows.Count, 1).End(xlUp).Row\nSet rngTemp1 = .Range(\"W2:W\" &amp; Lastrow &amp; \", AB2:AB\" &amp; Lastrow)\nSet rngTemp2 = .Range(\"X2:X\" &amp; Lastrow &amp; \", AC2:AC\" &amp; Lastrow)\n\n\nFor Each cell In rngTemp1\ncell.Copy\ncell(18, **Row**).Paste\nNext cell\n\nFor Each cell In rngTemp2\ncell.Copy\ncell(18, **Row**).Paste\nNext cell\n\nEnd With\n</code></pre>\n\n<p>Thank you for your help</p>\n"}, {"tags": ["arrays", "excel", "vba", "excel-formula", "array-formulas"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1533739949, "post_id": 51749690, "comment_id": 90459197, "body": "You must declare the size of the array before trying to insert values into it."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 10187005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b905dd8bb392849806b566aad3ffac4?s=128&d=identicon&r=PG&f=1", "display_name": "alcopo63q", "link": "https://stackoverflow.com/users/10187005/alcopo63q"}, "edited": false, "score": 0, "creation_date": 1533741428, "post_id": 51749820, "comment_id": 90460186, "body": "Absolutely stunning! Would you know why I would return a run-time error 1004 right as it gets to to the second to last line? The Worksheet is spelled correctly and I don&#39;t see anything that would conflict with the formula trying to be placed there."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 17, "user_id": 10187005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b905dd8bb392849806b566aad3ffac4?s=128&d=identicon&r=PG&f=1", "display_name": "alcopo63q", "link": "https://stackoverflow.com/users/10187005/alcopo63q"}, "edited": false, "score": 0, "creation_date": 1533741563, "post_id": 51749820, "comment_id": 90460287, "body": "Look at <code>Formula</code> in the immediate window and make sure it looks correct.  If you have worksheets with spaces in the name we will need to make a little change."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 17, "user_id": 10187005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b905dd8bb392849806b566aad3ffac4?s=128&d=identicon&r=PG&f=1", "display_name": "alcopo63q", "link": "https://stackoverflow.com/users/10187005/alcopo63q"}, "edited": false, "score": 0, "creation_date": 1533741616, "post_id": 51749820, "comment_id": 90460326, "body": "@alcopo63q I changed it deal with worksheet names that have spaces."}, {"owner": {"reputation": 17, "user_id": 10187005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b905dd8bb392849806b566aad3ffac4?s=128&d=identicon&r=PG&f=1", "display_name": "alcopo63q", "link": "https://stackoverflow.com/users/10187005/alcopo63q"}, "edited": false, "score": 0, "creation_date": 1533741787, "post_id": 51749820, "comment_id": 90460462, "body": "I broke the code before it ended and the formula does seem to be correct up to a point. It gets cut off in the middle of a few sheets, but I don&#39;t know if that happens when you watch a variable in the &quot;Watches&quot; window (I am very new to VBA) and if it does have some sort of maximum size then that would be the problem."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 17, "user_id": 10187005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b905dd8bb392849806b566aad3ffac4?s=128&d=identicon&r=PG&f=1", "display_name": "alcopo63q", "link": "https://stackoverflow.com/users/10187005/alcopo63q"}, "edited": false, "score": 0, "creation_date": 1533742031, "post_id": 51749820, "comment_id": 90460631, "body": "@alcopo63q please mark as correct by clicking the check mark by the answer."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1533741580, "last_edit_date": 1533741580, "creation_date": 1533740244, "answer_id": 51749820, "question_id": 51749690, "link": "https://stackoverflow.com/questions/51749690/using-an-array-of-ranges-to-create-a-formula-to-add-cells-from-each-sheet/51749820#51749820", "title": "Using an array of ranges to create a formula to add cells from each sheet", "body": "<p>you do not need the arrays as you are passing the values to the string inside the loop:</p>\n\n<pre><code>Application.ScreenUpdating = False     \nDim EmpFinal As Variant\nDim total_1 As Range\nDim total_2 As Range\nDim totalAddress As string\nDim iSheets as Long\n\niSheets = Sheets.count\n\nFormula = \"=SUM(\"\nDim i as Long\nFor i = 5 To iSheets - 1\n\n    Set total_1 = worksheets(i).Range(\"D:D\")\n    Set total_2 = total_1.Find(\"Total\")\n    If Not total_2 is Nothing then\n        totalAddress = worksheets(i).Cells(total_2.Row, total_2.Column + 1).Address(0, 0)\n        Formula = Formula &amp; \"'\" &amp; workSheets(i).Name &amp; \"'!\" &amp; totalAddress &amp; \",\"\n    End If\nNext i\nFormula = Left(Formula, Len(Formula) - 1) &amp; \")\"\nWorksheets(\"Final Budget\").Range(\"I1\").Formula = Formula\n\nApplication.ScreenUpdating = True\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 10187005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b905dd8bb392849806b566aad3ffac4?s=128&d=identicon&r=PG&f=1", "display_name": "alcopo63q", "link": "https://stackoverflow.com/users/10187005/alcopo63q"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 51749820, "answer_count": 1, "score": 0, "last_activity_date": 1594154988, "creation_date": 1533739848, "last_edit_date": 1594154988, "question_id": 51749690, "link": "https://stackoverflow.com/questions/51749690/using-an-array-of-ranges-to-create-a-formula-to-add-cells-from-each-sheet", "title": "Using an array of ranges to create a formula to add cells from each sheet", "body": "<p>I am trying to set an array to a set of ranges. I want to run through each of my sheets, starting at the 5th from the left and select the cell to the right of wherever it finds the text \"Total\" in column. then the last part is just taking this as it winds through the sheets and creates a string which when placed in the sheet \"Final Budget\", it acts like a formula and sums up all the values in that cell. </p>\n\n<p>I am receiving the Run-time error '9' of subscript out of range. I have used the index property of Worksheets before so I believe I am doing that correctly, but am not sure why it cannot recognize the subscript.</p>\n\n<hr>\n\n<pre><code>Application.ScreenUpdating = False     \nDim EmpFinal() As Variant\nDim total_1() As Variant\nDim total_2() As Variant\nDim totalAddress() As Variant\niSheets = Sheets.count\nFor i = 5 To iSheets - 1\n\n    Set total_1(i) = Worksheets(i).Range(\"D:D\")\n    Set total_2(i) = total_1(i).Find(\"Total\")\n    totalAddress(i) = Cells(total_2(i).Row, total_2(i).Column + 1).Address(0, 0)\n    Formula = \"=SUM(\"\n    Formula = Formula &amp; Sheets(i).Name &amp; \"!\" &amp; totalAddress(i) &amp; \",\"\n\nNext i\nFormula = Left(Formula, Len(Formula) - 1) &amp; \")\"\nWorksheets(\"Final Budget\").Range(\"I1\").Formula = Formula\n\nApplication.ScreenUpdating = True\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 3, "creation_date": 1533738851, "post_id": 51749278, "comment_id": 90458429, "body": "To create an Excel formula that will do this, suggest you use the <code>FIND</code> function.  In VBA you could use <code>Like</code> or <code>InStr</code>"}], "answers": [{"tags": [], "owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "is_accepted": false, "score": 0, "last_activity_date": 1533739964, "last_edit_date": 1533739964, "creation_date": 1533739214, "answer_id": 51749460, "question_id": 51749278, "link": "https://stackoverflow.com/questions/51749278/excel-vba-if-then-statement-identifying-cells-with-a-dash/51749460#51749460", "title": "Excel VBA - if/then statement - Identifying cells with a dash", "body": "<p>You could do it with a simple VBA script like this:</p>\n\n<pre><code>Sub Test()\nDim sh1 As Worksheet\nSet sh1 = Sheets(\"Sheet1\")\n\n        Application.ScreenUpdating = False\n\n                For x = 1 To sh1.Cells(rows.Count, \"A\").End(xlUp).Row\n\n                    If InStr(1, sh1.Range(\"A\" &amp; x).Value, UCase(\"-\"), 1) &gt; 0 Then sh1.Range(\"B\" &amp; x).Value= \"Red\"\n                    If InStr(1, sh1.Range(\"A\" &amp; x).Value, UCase(\"-\"), 1) &lt; 0 Then sh1.Range(\"B\" &amp; x).Value = \"Blue\"\n\n                Next x\n\n        Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1533739719, "creation_date": 1533739719, "answer_id": 51749641, "question_id": 51749278, "link": "https://stackoverflow.com/questions/51749278/excel-vba-if-then-statement-identifying-cells-with-a-dash/51749641#51749641", "title": "Excel VBA - if/then statement - Identifying cells with a dash", "body": "<p>Or a one-liner:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=IF(ISERROR(FIND(\"\"-\"\",RC[-1])),\"\"Red\"\",\"\"Blue\"\")\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40, "user_id": 10165736, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bRim3GUnX_w/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ppywRDXmj6Z5qL4bcjB34IxVp2nQ/mo/photo.jpg?sz=128", "display_name": "Kau&#234; Delmonte", "link": "https://stackoverflow.com/users/10165736/kau%c3%aa-delmonte"}, "is_accepted": false, "score": 0, "last_activity_date": 1533740596, "creation_date": 1533740596, "answer_id": 51749949, "question_id": 51749278, "link": "https://stackoverflow.com/questions/51749278/excel-vba-if-then-statement-identifying-cells-with-a-dash/51749949#51749949", "title": "Excel VBA - if/then statement - Identifying cells with a dash", "body": "<p>I don't believe that put a formula in every \"B\" column cells it's a good pratice, Excel can take a long time to calculate.</p>\n\n<p>Try this:</p>\n\n<pre><code>Sub Example()\n\n    mySheet.Cells(1, \"B\").Value = IIf(Not InStr(1, mySheet.Cells(1, \"A\"), Chr(45), vbTextCompare) = 0, \"Blue\", \"Red\")\n\nEnd Sub\n</code></pre>\n\n<p>You can loop through every cell you want to put that condition using this code.</p>\n\n<p>Functions:</p>\n\n<p><strong>IIf</strong> is equals to Excel Worksheet Function \"IF\".</p>\n\n<p><strong>InStr</strong> search a string in another string, you can pass a unique char as criterea. I used chr(<strong>45</strong>) because it returns a char according to the passed code, 45 references to <strong>Dash</strong> code.</p>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1533741000, "creation_date": 1533741000, "answer_id": 51750073, "question_id": 51749278, "link": "https://stackoverflow.com/questions/51749278/excel-vba-if-then-statement-identifying-cells-with-a-dash/51750073#51750073", "title": "Excel VBA - if/then statement - Identifying cells with a dash", "body": "<p>You can also use</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=IF(ISNUMBER(FIND(\"\"-\"\",RC[-1])),\"\"Blue\"\",\"\"Red\"\")\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 0, "last_activity_date": 1533741318, "creation_date": 1533741318, "answer_id": 51750192, "question_id": 51749278, "link": "https://stackoverflow.com/questions/51749278/excel-vba-if-then-statement-identifying-cells-with-a-dash/51750192#51750192", "title": "Excel VBA - if/then statement - Identifying cells with a dash", "body": "<p>The error, corrected (but not pointed out) in several of the other answers lies in changing your formula from </p>\n\n<p><code>\" - \"</code></p>\n\n<p>to</p>\n\n<p><code>\"\" - \"\"</code> </p>\n\n<p>i.e. going from single double-quotes around your <code>-</code> to double double-quotes. The single quote is ending your string - you can even see that the <code>-</code> shows up in black text in your question instead of red text, therefore, it's not part of the string being inserted into <code>ActiveCell.FormulaR1C1</code>.</p>\n"}], "owner": {"reputation": 9, "user_id": 9231470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c8df6160ecd5b832ea35763b89c56d?s=128&d=identicon&r=PG&f=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/9231470/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 601, "favorite_count": 0, "accepted_answer_id": 51750073, "answer_count": 5, "score": 0, "last_activity_date": 1533741318, "creation_date": 1533738712, "last_edit_date": 1533740610, "question_id": 51749278, "link": "https://stackoverflow.com/questions/51749278/excel-vba-if-then-statement-identifying-cells-with-a-dash", "title": "Excel VBA - if/then statement - Identifying cells with a dash", "body": "<p>I am trying to write a VBA line where if cell A1 contains a dash anywhere in the cell, then B1 will say \"Blue\". If there is no dash, then B1 would say \"Red\".</p>\n\n<p>I have the following code written, but it's not working and I'm not sure if I'm doing the \"like\" part correctly:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = _\n    \"=IF(RC[-1]=\" - \",\"\"Blue\"\",\"\"Red\"\")\"\n</code></pre>\n\n<p>Thank you for any help you can provide! I've done so much searching, but have been unable to find any examples that didn't include specific numbers or text.</p>\n"}, {"tags": ["excel", "vba", "for-loop", "foreach", "range"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1533738196, "post_id": 51749026, "comment_id": 90457915, "body": "You should really <a href=\"https://stackoverflow.com/questions/10714251/\">avoid using <code>.Select</code>/<code>.Activate</code></a> - but, try this (less parenthesis, and removing those single quote marks:  <code>Set aggrange = Range(Activecell.Offset(0,11),Activecell.Offset(0,13))</code>?  Edit: <b>Note</b> You need to set what worksheet that range is on too.  You have a bunch of worksheets, so be sure to qualify that range, ie <code>Set aggrante = batchwb.Worksheets(&quot;Culture Day&quot;).Range(ActiveCell.Offset(0,11), ...)</code>"}, {"owner": {"reputation": 23, "user_id": 10141426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab121bf6d7435caee3d1a68fa2f195bf?s=128&d=identicon&r=PG&f=1", "display_name": "A.P", "link": "https://stackoverflow.com/users/10141426/a-p"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1533738747, "post_id": 51749026, "comment_id": 90458356, "body": "Qualifying the range did the trick, thank you! Now the next line just below it gives the &quot;subscript out of range error&quot;...any suggestions with that? Edit: The next line should copy the range from above and paste it into another range in another worksheet, if that was not clear!"}], "owner": {"reputation": 23, "user_id": 10141426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab121bf6d7435caee3d1a68fa2f195bf?s=128&d=identicon&r=PG&f=1", "display_name": "A.P", "link": "https://stackoverflow.com/users/10141426/a-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 713, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573106985, "creation_date": 1533737995, "question_id": 51749026, "link": "https://stackoverflow.com/questions/51749026/selecting-a-range-of-cells-based-on-active-cell", "title": "Selecting a range of Cells based on Active Cell", "body": "<p>I am trying to select a range of cells offset from my active cell and I am not having much luck. The range of cells that I am trying to select is between and including the 11th cell and the 13th cell in the same row as the active cell. I receive the error below:</p>\n\n<pre><code>Run-time error '1004':\nApplication-defined or object-defined error.\n</code></pre>\n\n<p>I am still a little new to VBA. If you see any other glaring problems in my code, please feel free to correct me! The error occurs at the lines with the asterixes.</p>\n\n<pre><code>Sub TransferCells()\nDim aggrange As Range\nDim AnalyticalCell As Range\nDim BatchCell As Range\nDim analyticalwb As Excel.Workbook\nDim batchwb As Excel.Workbook\nDim SEHPLC As Worksheet\nDim CultureDay As Worksheet\nSet batchwb = Workbooks.Open(\"\\\\cntusmafpsjnj.com\\HomeH$\\Tala Big Data\\20180420_Fed Batch All Data_0.xlsx\")\nSet CultureDay = batchwb.Worksheets(\"Culture Day\")\nSet analyticalwb = Workbooks.Open(\"\\\\cntusmafps.com\\HomeH$\\Tala Big Data\\Castle Analytical Results (4).xlsm\")\nSet SEHPLC = analyticalwb.Worksheets(\"SE-HPLC\")\nMsgBox ActiveSheet.Name\n\nFor Each AnalyticalCell In analyticalwb.Worksheets(\"SE-HPLC\").Range(\"A2:A87\")\n    For Each BatchCell In batchwb.Worksheets(\"Culture Day\").Range(\"A2:A125271\")\n        If AnalyticalCell.Value = BatchCell.Value Then\n        MsgBox ActiveCell.Address\n            **'Set aggrange = Range((ActiveCell.Offset(0, 11)), (ActiveCell.Offset(0, 13)))'\n            ActiveCell.Offset(0, 11).Resize(0, 13).Select**\n            aggrange.Copy Destination:=Application.Workbooks(\"20180420_Fed Batch All Data_0.xlsx\").Worksheets(\"Sheet3\").Range(BatchCell.Offset(0, 3), BatchCell.Offset(0, 5))\n        End If\n    Next BatchCell\nNext AnalyticalCell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1533737765, "post_id": 51748643, "comment_id": 90457603, "body": "I believe you want the <code>.innerText</code> property of <code>ele</code> (not <code>.Href</code>),  which should be equal to <code>D01441</code> in your example."}, {"owner": {"reputation": 115, "user_id": 8061014, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b02c807003fcda1654d5fbc862d8a21e?s=128&d=identicon&r=PG&f=1", "display_name": "user90823745", "link": "https://stackoverflow.com/users/8061014/user90823745"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1533738166, "post_id": 51748643, "comment_id": 90457889, "body": "@dwirony I&#39;m not sure how to incorporate .innerText, because don&#39;t I still need to find the right tag by looking at .href?"}, {"owner": {"reputation": 115, "user_id": 8061014, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b02c807003fcda1654d5fbc862d8a21e?s=128&d=identicon&r=PG&f=1", "display_name": "user90823745", "link": "https://stackoverflow.com/users/8061014/user90823745"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1533738744, "post_id": 51748643, "comment_id": 90458355, "body": "If i use .innerText then wouldn&#39;t I need to hardcode &quot;D01441&quot;? I need it to be whatever is the correct link on the page"}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 8061014, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b02c807003fcda1654d5fbc862d8a21e?s=128&d=identicon&r=PG&f=1", "display_name": "user90823745", "link": "https://stackoverflow.com/users/8061014/user90823745"}, "edited": false, "score": 0, "creation_date": 1533739588, "post_id": 51749427, "comment_id": 90458958, "body": "Oh i&#39;d never seen that before - thank you it works!! I realized some search queries don&#39;t have any results, in that case, is there a way to say If IE.document.querySelector(&quot;...&quot;) not on page?"}, {"owner": {"reputation": 115, "user_id": 8061014, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b02c807003fcda1654d5fbc862d8a21e?s=128&d=identicon&r=PG&f=1", "display_name": "user90823745", "link": "https://stackoverflow.com/users/8061014/user90823745"}, "edited": false, "score": 1, "creation_date": 1533739940, "post_id": 51749427, "comment_id": 90459193, "body": "Nvm you can just check if it = 0"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 1, "creation_date": 1533743461, "post_id": 51749427, "comment_id": 90461543, "body": "Another awesome approach."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 3, "last_activity_date": 1533739973, "last_edit_date": 1533739973, "creation_date": 1533739160, "answer_id": 51749427, "question_id": 51748643, "link": "https://stackoverflow.com/questions/51748643/vba-to-click-a-dynamic-href/51749427#51749427", "title": "VBA to click a dynamic href", "body": "<p><strong>CSS selectors:</strong></p>\n\n<p>Try using a CSS selector combination applied via <code>querySelector</code> method of <code>document</code> to target the common start part of the <code>href</code>. </p>\n\n<hr>\n\n<p><strong>Applying the selector combination:</strong></p>\n\n<pre><code>IE.document.querySelector(\"a[href^='/dbget-bin/www_bget?dr:']\").Click\n</code></pre>\n\n<hr>\n\n<p><strong>Understanding the selector combination:</strong></p>\n\n<p>This uses a CSS selector combination to target the element with:</p>\n\n<pre><code>a[href^='/dbget-bin/www_bget?dr:']\n</code></pre>\n\n<p>This says element with <code>a</code> tag having attribute <code>href</code> whose value starts with\n<code>'/dbget-bin/www_bget?dr:'</code> . The <code>^</code> means starts with.</p>\n\n<hr>\n\n<p><strong>Query in action:</strong></p>\n\n<p>Here is the selector in action on your HTML sample:</p>\n\n<p><a href=\"https://i.stack.imgur.com/GSANd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GSANd.png\" alt=\"sample\"></a></p>\n\n<hr>\n\n<p><strong>Side note:</strong></p>\n\n<p>If you have multiple elements with <code>a</code> tags and an <code>href</code> that starts with <code>/dbget-bin/www_bget?dr:</code>, it will match the first one, in most instances. If that is the case seeing more HTML would help. I think there are a few problems with that HTML sample because in theory a more selective CSS query might be <code>.data1 a[href^='/dbget-bin/www_bget?dr:']</code>, so as to include the parent element class of <code>data1</code>, <code>\".\"</code> being a class selector.</p>\n"}, {"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 2, "last_activity_date": 1533739455, "creation_date": 1533739455, "answer_id": 51749544, "question_id": 51748643, "link": "https://stackoverflow.com/questions/51748643/vba-to-click-a-dynamic-href/51749544#51749544", "title": "VBA to click a dynamic href", "body": "<p><em>@QHarr answer is the elegant and best solution, but...</em></p>\n\n<p>To address your issue of getting the part number from the href, you can use the <code>InStr</code> like this</p>\n\n<pre><code>For Each ele In IE.document.getElementsByTagName(\"a\")\n    Dim partNumber As String\n    Dim colonPosition As Long\n    colonPosition = InStr(1, ele.Href, \":\", vbTextCompare)\n    If colonPosition &gt; 0 Then\n        partNumber = Right$(ele.Href, Len(ele.Href) - colonPosition)\n        Debug.Print partNumber\n    End If\nNext ele\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 8061014, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b02c807003fcda1654d5fbc862d8a21e?s=128&d=identicon&r=PG&f=1", "display_name": "user90823745", "link": "https://stackoverflow.com/users/8061014/user90823745"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1368, "favorite_count": 0, "accepted_answer_id": 51749427, "answer_count": 2, "score": 0, "last_activity_date": 1533740517, "creation_date": 1533736917, "last_edit_date": 1533740517, "question_id": 51748643, "link": "https://stackoverflow.com/questions/51748643/vba-to-click-a-dynamic-href", "title": "VBA to click a dynamic href", "body": "<p>I'm trying to click a link on a website with the tag:</p>\n\n<pre><code>&lt;a href=\"/dbget-bin/www_bget?dr:D01441:&gt;D01441&lt;/a&gt;\n</code></pre>\n\n<p>However, I'm doing this after searching for a unique item (I have an array of >9000 unique items), and the \"D01441\" part is different for each item, and I don't know in advance what it will be for each. The following code is in a loop that goes through each item and searches for it one at a time. After searching, I would like to click on a link that appears (the code above) and do more things on that next web page. </p>\n\n<pre><code>Dim IE As Object\nDim ele As Object\nSet IE = CreateObject(\"InternetExplorer.Application\")\n\n...\n\nFor Each ele In IE.document.getElementsByTagName(\"a\")\n    If ele.Href = \"/dbget-bin/www_bget?dr:D01441\" Then\n        ele.Click\n        Exit For\n    End If\nNext\n</code></pre>\n\n<p>The above code doesn't work and I'm not sure why. But once I get it to work, I don't know how to modify the \"D01441\" part so that I can click on any searched item's link. Here's more html around the link I want:</p>\n\n<pre><code>&lt;tbody&gt;\n  &lt;tr&gt; ... &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td class = \"data1\"&gt;\n      &lt;a href = \"/dbget-bin/www_bget?dr:D01441:&gt;D01441&lt;/a&gt;\n    &lt;/td&gt;\n    &lt;td class = \"data1\"&gt;..&lt;/td&gt;\n    &lt;td class = \"data1\"&gt;..&lt;/td&gt;\n\n...\n</code></pre>\n\n<hr>\n\n<p>EDIT: To try to deal with the changing \"D01441\", I tried using InStr but it doesn't work either:</p>\n\n<pre><code>    For Each ele In IE.document.getElementsByTagName(\"a\")\n        If InStr(ele.Href, \"/dbget-bin/www_bget?dr:\") = 1 Then\n            MsgBox \"There\"\n            ele.Click\n            Exit For\n        End If\n    Next\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1533736655, "post_id": 51748446, "comment_id": 90456847, "body": "So with in the block of 6 the numbers are unique no duplication of the 1 to 50?"}, {"owner": {"reputation": 1, "user_id": 10197983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faa2952748911501ed5ce7fe6d7ce843?s=128&d=identicon&r=PG&f=1", "display_name": "Liutauras ", "link": "https://stackoverflow.com/users/10197983/liutauras"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1533879846, "post_id": 51748446, "comment_id": 90517108, "body": "Yes, every number within a block of 6 numbers is unique."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1533738230, "creation_date": 1533738230, "answer_id": 51749119, "question_id": 51748446, "link": "https://stackoverflow.com/questions/51748446/how-to-use-countifs-with-2-criteria-and-a-lot-of-same-size-ranges/51749119#51749119", "title": "How to use Countifs with 2 Criteria and a lot of same size Ranges?", "body": "<p>I can shorten your main formula but you will still need to add each section:</p>\n\n<pre><code>=(SUMPRODUCT(COUNTIF(C2:C7;E2:E3))=2) + (SUMPRODUCT(COUNTIF(C8:C13;E2:E3))=2) + ...\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10197983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faa2952748911501ed5ce7fe6d7ce843?s=128&d=identicon&r=PG&f=1", "display_name": "Liutauras ", "link": "https://stackoverflow.com/users/10197983/liutauras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594154993, "creation_date": 1533736282, "last_edit_date": 1594154993, "question_id": 51748446, "link": "https://stackoverflow.com/questions/51748446/how-to-use-countifs-with-2-criteria-and-a-lot-of-same-size-ranges", "title": "How to use Countifs with 2 Criteria and a lot of same size Ranges?", "body": "<p>I have been trying for quite some time now to write <code>COUNTIF</code> formulas which would return a count of <code>True</code> values by <strong>2 Criteria</strong> <strong>in a lot of same size Ranges</strong>. </p>\n\n<p>I have a list of numbers where every block of 6 numbers represents a week. All of the numbers in every block are different ranging from 1 to 50. I need a formula that returns a count of how many times any 2 given numbers were together in one block. </p>\n\n<p>So far I have only worked out a primitive formula. As You can see I only manage to make it work by adding +6 to coordinates of range. </p>\n\n<pre><code>=IF(AND(IF(COUNTIF(C2:C7;E2);1;0);IF(COUNTIF(C2:C7;E3);1;0));1;0)+IF(AND(IF(COUNTIF(C8:C13;E2);1;0);IF(COUNTIF(C8:C13;E3);1;0));1;0)+IF(AND(IF(COUNTIF(C14:C19;E2);1;0);IF(COUNTIF(C14:C19;E3);1;0));1;0)\n</code></pre>\n\n<p>Is there any way to sum separate IF's in one formula without manually adding <code>IF+IF(+6)+IF(+6)</code> ... etc. if a number of weeks is known (around 700)? </p>\n\n<p>Is there a more simple method than my solution to count cells by 2 Criteriain a lot of same size Ranges?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1533736634, "post_id": 51748362, "comment_id": 90456827, "body": "There&#39;s no need to check Y in the loop, it only needs to be checked once. have you stepped through the code to see what&#39;s happening? Sometimes a cell might look empty but there could be something in it."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1534236480, "post_id": 51748362, "comment_id": 90627855, "body": "@wildesbare - allow me one remark as you asked already six unaccepted questions: it&#39;s good use at <i>Stack Overflow</i> to identify a good or helpful answer by marking it as accepted, so possibly you could review them  - see <a href=\"https://stackoverflow.com/help/someone-answers\">&quot;Someone answers&quot;</a>; you find further hints at <a href=\"https://stackoverflow.com/tour\">stackoverflow.com/tour</a> :-)"}, {"owner": {"reputation": 7, "user_id": 9866168, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "wildesbare", "link": "https://stackoverflow.com/users/9866168/wildesbare"}, "edited": false, "score": 1, "creation_date": 1534255854, "post_id": 51748362, "comment_id": 90640018, "body": "Thank you for the tip of accepting answers. I didnt know i could do that."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 9866168, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "wildesbare", "link": "https://stackoverflow.com/users/9866168/wildesbare"}, "edited": false, "score": 0, "creation_date": 1533737232, "post_id": 51748541, "comment_id": 90457255, "body": "Im sorry im still quite new to VBA.... do mind explaining what the vbNullString and how the &quot;B&quot; and &quot;C&quot; work in the cells function"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 7, "user_id": 9866168, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "wildesbare", "link": "https://stackoverflow.com/users/9866168/wildesbare"}, "edited": false, "score": 0, "creation_date": 1533737577, "post_id": 51748541, "comment_id": 90457483, "body": "<code>vbNullString</code> is the same as <code>&quot;&quot;</code> (some people say <code>vbNullString</code> takes less memory and is faster: see <a href=\"https://stackoverflow.com/questions/32435320/is-there-any-difference-between-vbnullstring-and\">Is there any difference between vbNullString and \u201c\u201d?</a>). The <code>&quot;B&quot;</code> and <code>&quot;C&quot;</code> are just the column names: <code>cells()</code> is used like <code>Cells(row, column)</code>."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1533736547, "creation_date": 1533736547, "answer_id": 51748541, "question_id": 51748362, "link": "https://stackoverflow.com/questions/51748362/loop-with-multiple-ranges/51748541#51748541", "title": "Loop with multiple Ranges", "body": "<p>If you meant to check by each row like (B2 and C2) then (B3 and C3), then you could do it like this.</p>\n\n<pre><code>Sub Fill_Rows()\n    Dim iRow As Long\n    For iRow = 2 To 5000\n        If Cells(iRow, \"B\").Value = vbNullString And Cells(iRow, \"C\").Value &lt;&gt; vbNullString Then\n            Cells(iRow, \"B\").Value = \"Correct\"\n        End If\n    Next iRow\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1533744051, "creation_date": 1533744051, "answer_id": 51751078, "question_id": 51748362, "link": "https://stackoverflow.com/questions/51748362/loop-with-multiple-ranges/51751078#51751078", "title": "Loop with multiple Ranges", "body": "<p><strong>Alternative</strong></p>\n\n<p>Added two solutions: </p>\n\n<ul>\n<li>[1] an example code as close as possible to yours and </li>\n<li>[2] an alternative using a datafield array to demonstrate a <strong>faster way</strong> for bigger data sets.</li>\n</ul>\n\n<p><strong>[1] Example Code close to yours</strong></p>\n\n<p>There is no need to use a second variable <code>Y</code>, all the more as apparently you left it undeclared, which always can cause issues (type mismatches, no range object etc.).\nSo always use <code>Option Explicit</code> in the declaration head of your code module to force yourself to declare all variable types you are using.</p>\n\n<p>Now you can simply use an offset of 1 column to the existing cell to check the neighbouring cell, too.</p>\n\n<pre><code>Option Explicit   ' declaration head of your code module (obliges to declare variables)\n\nSub Fill_RowsViaRangeLoop()\nDim X As Range, ws As Worksheet\nSet ws = ThisWorkbook.Worksheets(\"MySheet\")  ' &lt;&lt; replace with your sheet name\nFor Each X In ws.Range(\"B2:B5000\")\n    If X = \"\" And X.Offset(0, 1) &lt;&gt; \"\" Then  ' column offset 1 checks next cell in C\n         X = \"Correct\"\n    End If\nNext X\nEnd Sub\n</code></pre>\n\n<p><strong>[2] Example Code using a datafield array</strong></p>\n\n<p>Looping through a bigger range isn't very fast, you can speed up your procedure by \nassigning your range values to a variant datafield array <code>v</code>, loop through the received array items correcting found items in column 1 and write it back to sheet. </p>\n\n<pre><code>Option Explicit   ' declaration head of your code module (obliges to declare variables)\n\nSub Fill_RowsViaArray()\n   Dim v As Variant, i As Long, ws As Worksheet\n   Set ws = ThisWorkbook.Worksheets(\"MySheet\")  ' &lt;&lt; replace with your sheet name\n ' Assign values to a 2-dim array\n   v = ws.Range(\"B2:C5000\")             ' or better: v = ws.Range(\"B2:C5000\").Value2\n ' Check criteria looping over all rows (=first array dimension)\n   For i = 1 To UBound(v)               ' data field arrays are one-based, i.e. they start with 1\n       If v(i, 1) = vbNullString And v(i, 2) &lt;&gt; vbNullString Then v(i, 1) = \"Correct\"\n   Next i\n ' Write edited array back to original range (adapt the range size to the array boundaries in both dimensions)\n   ws.Range(\"B2\").Resize(UBound(v, 1), UBound(v, 2)) = v\n End Sub\n</code></pre>\n\n<p><strong>Further Notes</strong></p>\n\n<ul>\n<li>It's good use to fully qualify your sheet or range references (see e.g. object variable <code>ws</code>)</li>\n<li>Each array item is identified by a row and a column index. </li>\n<li>As such a datafield array is one based (start indices are 1), the first item in row 1 and column 1 will be referred by <code>v(1,1)</code>, in col 2 by <code>v(1,2)</code>.</li>\n<li>In order to count the number of row items you check the <strong>upper boundary</strong> of its first dimension) via <code>UBound(v,1)</code> or even shorter via <code>Ubound(v)</code></li>\n<li>In order to count the number of columns you check the <em>upper boundary</em> of its second dimension) via <code>UBound(v,2)</code> (here the argument 2 is necessary!)</li>\n<li>A comparation using <code>vbNullString</code> can be preferred in coding to <code>\"\"</code> as it takes less memory (c.f. @PEH 's answer) . </li>\n</ul>\n"}], "owner": {"reputation": 7, "user_id": 9866168, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "wildesbare", "link": "https://stackoverflow.com/users/9866168/wildesbare"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "accepted_answer_id": 51751078, "answer_count": 2, "score": 0, "last_activity_date": 1537636988, "creation_date": 1533736027, "last_edit_date": 1537636988, "question_id": 51748362, "link": "https://stackoverflow.com/questions/51748362/loop-with-multiple-ranges", "title": "Loop with multiple Ranges", "body": "<p>Im trying to write a code which determines whether certain cells are empty or not and then returns a set string.</p>\n\n<p>To go in detail; I was hoping for the code to look into cell B2, determine if it is empty, then go to C2 and determine if it is non-empty. If both were correct in cell B2 it would then input \"Correct\" and move on in the range. However, my code doesnt seem to work because it just inputs \"Correct\" in every cell in the loop range. </p>\n\n<p>I have posted my code below; any help would be much appreciated. </p>\n\n<pre><code>Sub Fill_Rows()\n\n\nDim X As Range\nLet Y = Range(\"C2\")\n\nFor Each X In Range(\"B2:B5000\")\n    If X = \"\" And Y &lt;&gt; \"\" Then\n        X = \"Correct\"\n    End If\n    Y = Y + 1\nNext X\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "for-loop", "if-statement"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1533736070, "post_id": 51748227, "comment_id": 90456449, "body": "Are you sure nothing in the code is misspelled or contains an &quot;odd&quot; character? Have you tried copy/pasting a line that works, then subsituting the value? (Side note: Any particular reason you&#39;re not using Select Case instead of all these ElseIf?)"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 2, "creation_date": 1533736242, "post_id": 51748227, "comment_id": 90456562, "body": "What is the idea of the statement <code>wfr = wfr + CStr(i + 5)</code>? What datatype and initial value (before you enter the loop) has <code>wfr</code>?"}, {"owner": {"reputation": 21, "user_id": 10093930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee1504195196ab67e6752f9420aedf8?s=128&d=identicon&r=PG&f=1", "display_name": "mmarkadavis", "link": "https://stackoverflow.com/users/10093930/mmarkadavis"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1533736756, "post_id": 51748227, "comment_id": 90456919, "body": "@FunThomas:   wfr is a single letter string that contains a column value, so wfr + CStr(i+5) is a specific cell (eg. F5)"}, {"owner": {"reputation": 21, "user_id": 10093930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee1504195196ab67e6752f9420aedf8?s=128&d=identicon&r=PG&f=1", "display_name": "mmarkadavis", "link": "https://stackoverflow.com/users/10093930/mmarkadavis"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1533736762, "post_id": 51748227, "comment_id": 90456922, "body": "@Cindy Meister:   I&#39;m not using Select Case because I taught myself VBA and I don&#39;t know about many functions, including Select Case"}, {"owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 1, "creation_date": 1533737159, "post_id": 51748227, "comment_id": 90457201, "body": "Have you tried to cast it as an integer, which will force the value to be 7 if it&#39;s within rounding range?  <code>If CInt(Sheets(&quot;ET Pivot&quot;).Range(wfr).Value) = 7</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "is_accepted": false, "score": 0, "last_activity_date": 1533741631, "last_edit_date": 1533741631, "creation_date": 1533736759, "answer_id": 51748604, "question_id": 51748227, "link": "https://stackoverflow.com/questions/51748227/if-statement-not-meeting-condition-for-specific-condition-value-vba/51748604#51748604", "title": "If Statement not meeting Condition for Specific Condition Value [VBA]", "body": "<p>Alright, so there are a few things to unpack here. Here are the things I changed: </p>\n\n<ol>\n<li>Reduced the reliance on <code>.Select</code> by explicitly stating what sheets you want to access for each range.</li>\n<li><p>Combined your <code>if</code> statements - this makes the code easier to read and edit</p>\n\n<p>a. For the first group of <code>if</code>s this meant that we could get rid of your <code>LoopExit</code> because it no longer served a purpose</p>\n\n<p>b. For the second set of <code>if</code>s it let us take out a big chunk of repetitive code</p></li>\n<li><p>Changed the way that you access values from concatenating strings to using <code>.Cells(row,col)</code></p>\n\n<p>a. This change let me get rid of <code>wfr</code> and replace it with just <code>\"A\"</code></p></li>\n<li><p>Adjusted the value of <code>i</code> in your loop since you were always saying <code>i + 5</code></p></li>\n<li>Changed the <code>paste</code> method to <code>Range().copy destination:=Range()</code></li>\n</ol>\n\n<p>Hope this helps!</p>\n\n<pre><code>Dim i As Long\nDim ic As Long\nDim current As Double\n\nFor i = 5 To 334\n\n    current = Sheets(\"ET Pivot\").Cells(i, \"A\").Value2\n\n    If current &lt;&gt; 1 And current &lt;&gt; 7 And current &lt;&gt; 9 And current &lt;&gt; 99999.99 Then\n\n        If current = Sheets(\"ET Pivot\").Cells(i, \"AB\").Value2 Or current = Sheets(\"ET Pivot\").Cells(i, \"AC\").Value2 Then\n\n            Sheets(\"ET Pivot\").Rows(i &amp; \":\" &amp; i).copy _\n                Destination:=Sheets(\"ET Outliers\").Cells(ic, \"A\")\n\n            ic = ic + 1\n\n        End If\n\n    End If\n\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 10093930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee1504195196ab67e6752f9420aedf8?s=128&d=identicon&r=PG&f=1", "display_name": "mmarkadavis", "link": "https://stackoverflow.com/users/10093930/mmarkadavis"}, "is_accepted": false, "score": 0, "last_activity_date": 1533741172, "creation_date": 1533741172, "answer_id": 51750141, "question_id": 51748227, "link": "https://stackoverflow.com/questions/51748227/if-statement-not-meeting-condition-for-specific-condition-value-vba/51750141#51750141", "title": "If Statement not meeting Condition for Specific Condition Value [VBA]", "body": "<p>So I solved it thanks to @Jaberwocky .</p>\n\n<p>Rather than converting it to an integer as he recommended, I rounded it to 3 decimal places and checked whether it was equal to 7. The reason for this difference is converting to an integer will inadvertently filter out max/min values from 6.51 to 7.5, which may be elsewhere in the data set.</p>\n\n<p>It seems that the \"7\" numbers I am trying to filter out aren't actually the integer 7, even though the deviation isn't shown when 30 decimal places are displayed.</p>\n\n<p>Thanks to everybody for the input.</p>\n"}], "owner": {"reputation": 21, "user_id": 10093930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee1504195196ab67e6752f9420aedf8?s=128&d=identicon&r=PG&f=1", "display_name": "mmarkadavis", "link": "https://stackoverflow.com/users/10093930/mmarkadavis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1533741631, "creation_date": 1533735657, "last_edit_date": 1533735932, "question_id": 51748227, "link": "https://stackoverflow.com/questions/51748227/if-statement-not-meeting-condition-for-specific-condition-value-vba", "title": "If Statement not meeting Condition for Specific Condition Value [VBA]", "body": "<p>My code has a loop that is finding whether the value of a given column in a pivot table is the min/max of that row. A caveat is certain rows have a characteristic entry repeated, so I have a set of If ElseIf conditions to skip the copying process for these entries. The code is as follows:</p>\n\n<pre><code>    For i = 0 To 339\n    wfr = wfr + CStr(i + 5)\n    Sheets(\"ET Pivot\").Select\n    If Sheets(\"ET Pivot\").Range(wfr).Value = 7 Then\n        GoTo LoopExit\n    ElseIf Sheets(\"ET Pivot\").Range(wfr).Value = 9 Then\n        GoTo LoopExit\n    ElseIf Sheets(\"ET Pivot\").Range(wfr).Value = 99999.99 Then\n        GoTo LoopExit\n    ElseIf Sheets(\"ET Pivot\").Range(wfr).Value = 1 Then\n        GoTo LoopExit\n    End If\n    If Sheets(\"ET Pivot\").Range(wfr).Value = Sheets(\"ET Pivot\").Range(\"AB\" + CStr(i + 5)).Value Then\n       Sheets(\"ET Pivot\").Select\n       Sheets(\"ET Pivot\").Rows(i + 5 &amp; \":\" &amp; i + 5).Select\n       Selection.Copy\n       Sheets(\"ET Outliers\").Select\n       Sheets(\"ET Outliers\").Range(\"A\" + CStr(ic)).Select\n       ActiveSheet.Paste\n       Application.CutCopyMode = False\n       ic = ic + 1\n   ElseIf Sheets(\"ET Pivot\").Range(wfr).Value = Sheets(\"ET Pivot\").Range(\"AC\" + CStr(i + 5)).Value Then\n       Sheets(\"ET Pivot\").Select\n       Sheets(\"ET Pivot\").Rows(i + 5 &amp; \":\" &amp; i + 5).Select\n       Selection.Copy\n       Sheets(\"ET Outliers\").Select\n       Sheets(\"ET Outliers\").Range(\"A\" + CStr(ic)).Select\n       ActiveSheet.Paste\n       ic = ic + 1\n   End If\nLoopExit:\n   wfr = wfrc\nNext i\n</code></pre>\n\n<p>The first four If statements are the skip conditions. The conditions 9, 99999.99, and 1 work as planned. For some reason, the 7 condition does not trigger the If statement. I have made sure the cell value is actually 7 and not rounded, I have changed the order of the conditions, and I have added a dummy condition first, all to no avail. I'm not sure why this specific case is not working.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 1, "creation_date": 1533734014, "post_id": 51747584, "comment_id": 90455044, "body": "That looks ok, the error is because the search fails. Are you sure <code>ws</code> is the same sheet as the screenshot? Make sure there are no extra spaces on the end on the string in A80"}, {"owner": {"reputation": 199, "user_id": 4768632, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d8ff1ac6939943953257985ab239575a?s=128&d=identicon&r=PG&f=1", "display_name": "Nick123", "link": "https://stackoverflow.com/users/4768632/nick123"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1533734421, "post_id": 51747584, "comment_id": 90455319, "body": "Added the entire code. Shouldn&#39;t be whitespace issue because I tried using the match function on the sheet itself."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1533734713, "post_id": 51747584, "comment_id": 90455508, "body": "This is a bit wrong - <code>Set ws = ExtractRawDivFromAastocks(StockCode)</code> The code is asking from a function to do too many things. E.g., add a worksheet, return it, take data from a query table, and refresh it. At the end it returns a worksheet. It is a good idea to refactor it."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1533734838, "post_id": 51747584, "comment_id": 90455602, "body": "Just wondering - can you call the function like this <code>CleanAastocksDiv StockCode, ws</code> instead of <code>Call CleanAastocksDiv(StockCode, ws)</code>?"}, {"owner": {"reputation": 199, "user_id": 4768632, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d8ff1ac6939943953257985ab239575a?s=128&d=identicon&r=PG&f=1", "display_name": "Nick123", "link": "https://stackoverflow.com/users/4768632/nick123"}, "edited": false, "score": 0, "creation_date": 1533738340, "post_id": 51747584, "comment_id": 90458030, "body": "The query was not complete when the code searches for the cell!"}, {"owner": {"reputation": 199, "user_id": 4768632, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d8ff1ac6939943953257985ab239575a?s=128&d=identicon&r=PG&f=1", "display_name": "Nick123", "link": "https://stackoverflow.com/users/4768632/nick123"}, "edited": false, "score": 0, "creation_date": 1533738959, "post_id": 51747584, "comment_id": 90458506, "body": "After I set qt.backgroundquery = False, it worked!"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1533734391, "creation_date": 1533734391, "answer_id": 51747794, "question_id": 51747584, "link": "https://stackoverflow.com/questions/51747584/vba-match-function-mismatch-despite-having-the-search-value-in-source/51747794#51747794", "title": "VBA match function mismatch despite having the search value in source", "body": "<pre><code>Public Sub TestMe()\n\n    Dim ws As Worksheet: Set ws = Worksheets(1)\n    Dim StartRow As Variant\n\n    StartRow = Application.Match(\"Announce Date\", ws.Range(\"A:A\"), 0)\n\n    If IsError(StartRow) Then Exit Sub\n    If StartRow &lt; 2 Then Exit Sub\n\n    ws.Range(\"A1:A\" &amp; StartRow - 1).EntireRow.Delete\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<ul>\n<li>Declare <code>StartRow</code> as a <code>Variant</code>, because if <code>Announce Date</code> does not exist, it would return an error;</li>\n<li>It can be checked with the <code>IsError(StartRow)</code> and exit if it is not the case;</li>\n<li><code>If StartRow &lt; 2 Exit Sub</code> is needed to avoid a possible error if StartRow is 1;</li>\n</ul>\n"}], "owner": {"reputation": 199, "user_id": 4768632, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d8ff1ac6939943953257985ab239575a?s=128&d=identicon&r=PG&f=1", "display_name": "Nick123", "link": "https://stackoverflow.com/users/4768632/nick123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533734396, "creation_date": 1533733668, "last_edit_date": 1533734396, "question_id": 51747584, "link": "https://stackoverflow.com/questions/51747584/vba-match-function-mismatch-despite-having-the-search-value-in-source", "title": "VBA match function mismatch despite having the search value in source", "body": "<pre><code>Option Explicit\n\nSub ExtractDivFromAastocks()\n\n    Dim StockCode As String, Anchor As String\n    Dim ws As Worksheet\n\n    StockCode = \"02800\"\n    Anchor = \"Announce Date\"\n    Set ws = ExtractRawDivFromAastocks(StockCode)\n    Call CleanAastocksDiv(StockCode, ws)\n\nEnd Sub\n\nPrivate Function ExtractRawDivFromAastocks(StockCode As String)\n\n    Dim WsFound As Boolean\n    Dim i As Integer\n    WsFound = False\n\n    For i = 1 To Sheets.Count():\n        If Worksheets(i).Name = StockCode Then\n            WsFound = True\n        End If\n        If WsFound = True Then\n            Exit For\n        End If\n    Next i\n    If WsFound = True Then\n        Application.DisplayAlerts = False\n        Worksheets(StockCode).Delete\n        Application.DisplayAlerts = True\n    End If\n\n    Dim ws As Worksheet\n    Dim qt As QueryTable\n\n    Dim Website As String, Aastock As String\n\n    Aastock = \"http://www.aastocks.com/en/stocks/analysis/dividend.aspx?symbol=\"\n\n    Website = Aastock &amp; StockCode\n\n    Set ws = Sheets.Add(After:=Worksheets(Worksheets.Count()))\n    ws.Name = StockCode\n\n    Set qt = ws.QueryTables.Add( _\n                Connection:=\"URL;\" &amp; Website, _\n                Destination:=ws.Range(\"A1\"))\n\n    With qt\n        .RefreshOnFileOpen = True\n        .Refresh\n\n    End With\n\n    Set ExtractRawDivFromAastocks = ws\n\nEnd Function\n\nPrivate Sub CleanAastocksDiv(StockCode As String, ws As Worksheet)\n\n    Dim StartRow As Integer\n\n    StartRow = Application.Match(\"Announce Date\", ws.Range(\"A:A\"), 0)\n\n    ws.Range(\"A1:\" &amp; _\n                ws.Cells(StartRow - 1, ws.Columns.Count()).Address).EntireRow.Delete\n\nEnd Sub\n</code></pre>\n\n<p>The worksheet indeed has the string value in it, and I have no idea why the match fails. I have tried using the Match function on the sheet itself, it works. Could this be some kind of reference issues? The cell in the sheet doesn't seem to have weird whitespaces. It would be really great if anyone can help me with this: </p>\n\n<p><a href=\"https://i.stack.imgur.com/gm7cw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gm7cw.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "double-quotes"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 4783014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1748b066fd054af5611be68155c42a81?s=128&d=identicon&r=PG&f=1", "display_name": "istackoverflow", "link": "https://stackoverflow.com/users/4783014/istackoverflow"}, "edited": false, "score": 0, "creation_date": 1533734534, "post_id": 51747398, "comment_id": 90455395, "body": "Dear P\u1d07\u029c, I do thank you for your answer. I&#39;ve replaced Formula with FormulaLocal, and now it works. You&#39;ve saved my day! Ps: I think I&#39;ve tried using the english version of the formula, but I got errors. I&#39;m gonna try again. Thank you again, really"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 37, "user_id": 4783014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1748b066fd054af5611be68155c42a81?s=128&d=identicon&r=PG&f=1", "display_name": "istackoverflow", "link": "https://stackoverflow.com/users/4783014/istackoverflow"}, "edited": false, "score": 0, "creation_date": 1533734776, "post_id": 51747398, "comment_id": 90455550, "body": "The english should work. Did you notice to replace the <code>;</code> in the formula by <code>,</code> for the english version?"}, {"owner": {"reputation": 37, "user_id": 4783014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1748b066fd054af5611be68155c42a81?s=128&d=identicon&r=PG&f=1", "display_name": "istackoverflow", "link": "https://stackoverflow.com/users/4783014/istackoverflow"}, "edited": false, "score": 0, "creation_date": 1533744288, "post_id": 51747398, "comment_id": 90462013, "body": "I read wrong, and I thought you were referring to the comma in Cells (). Perhaps you are referring to the semicolon in the formula. Tomorrow I try and I think it will work. Thanks again P\u1d07\u029c; really."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 3, "last_activity_date": 1533733742, "last_edit_date": 1533733742, "creation_date": 1533733116, "answer_id": 51747398, "question_id": 51747334, "link": "https://stackoverflow.com/questions/51747334/vba-excel-macro-formula-compile-error-double-quotes/51747398#51747398", "title": "VBA Excel Macro Formula Compile Error - Double Quotes", "body": "<p><code>.Formula</code> uses the english version of the formulas. If you want to use the localized formula (eg italian) you must use <code>.FormulaLocal</code>.</p>\n\n<p>So either localized:</p>\n\n<pre><code>Cells(5, 2).FormulaLocal = \"=CONTA.SE(Report!E2:E\" &amp; rowCount &amp; \";\" &amp; Chr(34) &amp; \"&lt;20\" &amp; Chr(34) &amp; \")\"\n</code></pre>\n\n<p>or english</p>\n\n<pre><code>Cells(5, 2).Formula = \"=COUNTIF(Report!E2:E\" &amp; rowCount &amp; \",\" &amp; Chr(34) &amp; \"&lt;20\" &amp; Chr(34) &amp; \")\"\n</code></pre>\n\n<p>Note that the localized (italian) form only works when used in an italian Excel, but the english version would work on any Excel. So using the english version in VBA is recommended. Using the english formula in VBA will automatically convert it into the correct localization form in the cell (the user will not notice any difference).</p>\n\n<p>Also note that the english separator is <code>,</code> while the italian (and most european) separator is <code>;</code>.</p>\n"}], "owner": {"reputation": 37, "user_id": 4783014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1748b066fd054af5611be68155c42a81?s=128&d=identicon&r=PG&f=1", "display_name": "istackoverflow", "link": "https://stackoverflow.com/users/4783014/istackoverflow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 51747398, "answer_count": 1, "score": 1, "last_activity_date": 1533733742, "creation_date": 1533732949, "last_edit_date": 1533733342, "question_id": 51747334, "link": "https://stackoverflow.com/questions/51747334/vba-excel-macro-formula-compile-error-double-quotes", "title": "VBA Excel Macro Formula Compile Error - Double Quotes", "body": "<p>I'm working on an Excel VBA Macro. </p>\n\n<p>I must write a formula inside a cell. </p>\n\n<p>The formula I'm referring to is <code>CONTA.SE()</code>. It behaves  in the same way as <code>COUNTIF()</code> does. I guess that it is the <code>COUNTIF()</code> version for Excel in italian. </p>\n\n<p>To be more precise the formula I want to implement is:</p>\n\n<pre><code>=CONTA.SE(Report!E:E;\"&lt;20\")\n</code></pre>\n\n<p>so that it works on cells values from <strong>E2</strong> to the last non-empty cell.</p>\n\n<p>I guess I'm having trouble because of the double quotes. </p>\n\n<p>I've tried many solutions as, for example:  </p>\n\n<pre><code>Cells(5, 2).Formula = \"=CONTA.SE(Report!E2:E\" &amp; rowCount &amp; \";\" &amp; Chr(34) &amp; \"&lt;20\" &amp; Chr(34) &amp; \")\"\n</code></pre>\n\n<p>or:  </p>\n\n<pre><code>Cells(5, 2).Formula = \"=CONTA.SE(Report!E2:E\" &amp; rowCount &amp; \";\" &amp; \"\"\"&lt;20\"\"\" &amp; \")\"\n</code></pre>\n\n<p>The error message I got is:  </p>\n\n<blockquote>\n  <p>run-time Error 1004:<br>\n    Error defined by the Object or the Application.</p>\n</blockquote>\n\n<p>Can anyone, please, tell my how write it correctly?</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2524, "user_id": 2705042, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/ShRFK.jpg?s=128&g=1", "display_name": "spinjector", "link": "https://stackoverflow.com/users/2705042/spinjector"}, "edited": false, "score": 0, "creation_date": 1533734264, "post_id": 51746874, "comment_id": 90455225, "body": "Hmm, perfect. I&#39;ve used vbObjectError in Excel functions, but I didn&#39;t stop to think it might work in this case when returning an error back to an Access report or query. Thanks."}, {"owner": {"reputation": 2524, "user_id": 2705042, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/ShRFK.jpg?s=128&g=1", "display_name": "spinjector", "link": "https://stackoverflow.com/users/2705042/spinjector"}, "edited": false, "score": 0, "creation_date": 1533743249, "post_id": 51746874, "comment_id": 90461419, "body": "I have a further thought/question. By returning <code>vbObjectError + nnn</code> this results in a single numeric value. I know it&#39;s not possible to create a New ErrObject, but is there any way to return error text with a UD error value? Or is there a way to define it globally, such a a public Enum or Const, or even a CLS..? I could hack something together, but I&#39;m wondering if there&#39;s a &quot;industry standard&quot; way of doing it."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 2524, "user_id": 2705042, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/ShRFK.jpg?s=128&g=1", "display_name": "spinjector", "link": "https://stackoverflow.com/users/2705042/spinjector"}, "edited": false, "score": 0, "creation_date": 1533745789, "post_id": 51746874, "comment_id": 90462814, "body": "@spinjector I would guess that is implementation specific. What <code>CVError</code> does is basically just wrap an error number up into a <code>Variant</code>. If you need the full error information, you can actually pass the <code>Err</code> object itself."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 5, "last_activity_date": 1533731558, "creation_date": 1533731558, "answer_id": 51746874, "question_id": 51746583, "link": "https://stackoverflow.com/questions/51746583/what-error-number-could-i-use-with-cverr-to-indicate-no-value-would-be-returne/51746874#51746874", "title": "What error number could I use with CVErr() to indicate no value would be returned from an Access VBA function?", "body": "<p>If the error that you are going to raise (or in this case pass) does not fall into the category of any of the predefined error messages, you should define your <em>own error number</em> and raise that. The constant <code>vbObjectError</code> exists for this purpose - add it to your internal number and pass that:</p>\n\n<pre><code>Public Const SOMETHING_BAD_ERROR As Long = vbObjectError + 666\n\nFunction MyLookup(param1) As Variant\n     '..............\n     '...do stuff...\n     '..............\n     If SomethingBad = True Then\n         MyLookup = VBA.CVErr(SOMETHING_BAD_ERROR)\n         Exit Function\n     End If\nEnd Function\n</code></pre>\n\n<p>Passing or raising an error number that does not convey exactly what really went wrong is a disservice to the caller.</p>\n"}], "owner": {"reputation": 2524, "user_id": 2705042, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/ShRFK.jpg?s=128&g=1", "display_name": "spinjector", "link": "https://stackoverflow.com/users/2705042/spinjector"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "accepted_answer_id": 51746874, "answer_count": 1, "score": 4, "last_activity_date": 1594631021, "creation_date": 1533730776, "last_edit_date": 1594631021, "question_id": 51746583, "link": "https://stackoverflow.com/questions/51746583/what-error-number-could-i-use-with-cverr-to-indicate-no-value-would-be-returne", "title": "What error number could I use with CVErr() to indicate no value would be returned from an Access VBA function?", "body": "<p>What error number could I use with CVErr() to indicate no value would be returned from an Access VBA function? I'm pulling blanks. CVErr(5) could work, but I'm hoping for something less generic. 744 (\"Search text not found\") is close (-ish), but still no cigar.</p>\n\n<p>I'm creating a special lookup function for use in an Access Report. If the function would return no value, I'd like it to return an ERROR# value instead. <a href=\"http://www.cpearson.com/excel/ReturningErrors.aspx\" rel=\"nofollow noreferrer\">Chip Pearson's discussion of this</a> is perfect, however it's geared toward Excel, and must be altered slightly for Access.</p>\n\n<p>I've searched the <a href=\"http://www.fmsinc.com/microsoftaccess/errors/ErrorNumber_Description2007.html\" rel=\"nofollow noreferrer\">Error List at FMS</a> with a variety of keywords such as \"zero\", \"not found\", \"too few\", etc. There are thousands of errors in the list, so any help whittling it down without having to actually read the whole list would be appreciated. </p>\n\n<p>Example:</p>\n\n<pre><code>   Function MyLookup(param1) as Variant\n        '..............\n        '...do stuff...\n        '..............\n        If SomethingBad = True Then\n            MyLookup = VBA.CVErr(N) 'What here for N?\n            Exit Function\n        Endif\n   End Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1533730761, "post_id": 51746534, "comment_id": 90452787, "body": "Have you added the references to Microsoft Internet Controls and Microsoft HTML Object Library?"}, {"owner": {"reputation": 11, "user_id": 10197537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfffe5acfe8ebce3c8bc9d8c8fbe1e09?s=128&d=identicon&r=PG&f=1", "display_name": "Dawn", "link": "https://stackoverflow.com/users/10197537/dawn"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1533731062, "post_id": 51746534, "comment_id": 90453005, "body": "Ah, forgot to add them. I now get the error variable not defined for Compaines on <code>For Each Company In Compaines</code>"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1533731109, "post_id": 51746534, "comment_id": 90453042, "body": "On what line you have got the error? Click Debug and tell us the line .."}, {"owner": {"reputation": 11, "user_id": 10197537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfffe5acfe8ebce3c8bc9d8c8fbe1e09?s=128&d=identicon&r=PG&f=1", "display_name": "Dawn", "link": "https://stackoverflow.com/users/10197537/dawn"}, "edited": false, "score": 0, "creation_date": 1533731398, "post_id": 51746534, "comment_id": 90453230, "body": "The error is on Ln 62, Col 34"}, {"owner": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "edited": false, "score": 1, "creation_date": 1533731408, "post_id": 51746534, "comment_id": 90453240, "body": "Spell check that line, you&#39;ve spelled the variable incorrectly.  &quot;For Each Company In Companies&quot;   How did that not get caught with Option Explicit?"}, {"owner": {"reputation": 11, "user_id": 10197537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfffe5acfe8ebce3c8bc9d8c8fbe1e09?s=128&d=identicon&r=PG&f=1", "display_name": "Dawn", "link": "https://stackoverflow.com/users/10197537/dawn"}, "edited": false, "score": 0, "creation_date": 1533731662, "post_id": 51746534, "comment_id": 90453409, "body": "Not sure, thanks. That&#39;s why i added it for mistakes like that. I now have an error on Ln 85 Col 15. Compile error: End If without block If"}, {"owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "edited": false, "score": 1, "creation_date": 1533734126, "post_id": 51746534, "comment_id": 90455111, "body": "There are many very basic problems with the code.  At first glance: The error you got &quot;variable not defined&quot; that was the error from option explicit.  You have two for statements, but one next.  You have an if statement, outside of the loop where you are closing it.  Your internal loop checking the fields is not really doing anything aside from counting the number of fields. You have on sub and two &quot;end subs&quot;"}, {"owner": {"reputation": 16336, "user_id": 6356278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9cb6527e3af8a89177b809385400437b?s=128&d=identicon&r=PG&f=1", "display_name": "Wimpel", "link": "https://stackoverflow.com/users/6356278/wimpel"}, "edited": false, "score": 0, "creation_date": 1533737570, "post_id": 51746534, "comment_id": 90457478, "body": "<code>For Each Company In Companies</code> does not have a <code>next Company</code>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1533743424, "post_id": 51746534, "comment_id": 90461526, "body": "What is the exact information you are after? There is only one &quot;company&quot; on that page (Contracting authority). The class you then attempt to use  for parsing covers each section of the  Contract award notice which is text - you are trying to convert this to Long."}, {"owner": {"reputation": 11, "user_id": 10197537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfffe5acfe8ebce3c8bc9d8c8fbe1e09?s=128&d=identicon&r=PG&f=1", "display_name": "Dawn", "link": "https://stackoverflow.com/users/10197537/dawn"}, "edited": false, "score": 0, "creation_date": 1533746834, "post_id": 51746534, "comment_id": 90463370, "body": "Hi, im looking to get the company name and whether its an SME and get it into a excel spreadsheet. Im not sure how to go about this though. Im fairly new to this"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1533758482, "post_id": 51746534, "comment_id": 90469081, "body": "Name not so hard but how can you tell from what is on the page whether S or M ? There is no SME labelled field."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10197537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfffe5acfe8ebce3c8bc9d8c8fbe1e09?s=128&d=identicon&r=PG&f=1", "display_name": "Dawn", "link": "https://stackoverflow.com/users/10197537/dawn"}, "edited": false, "score": 0, "creation_date": 1533733945, "post_id": 51747389, "comment_id": 90455000, "body": "Thanks for the feedback, i moved End If to Ln 88 just under Next. Now when i run it, i get Compile error: For without Next on Ln 96."}], "tags": [], "owner": {"reputation": 66, "user_id": 9735552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91d38106980585c38ecbeb7eea3e4253?s=128&d=identicon&r=PG&f=1", "display_name": "Exelus", "link": "https://stackoverflow.com/users/9735552/exelus"}, "is_accepted": false, "score": -1, "last_activity_date": 1533733101, "creation_date": 1533733101, "answer_id": 51747389, "question_id": 51746534, "link": "https://stackoverflow.com/questions/51746534/vba-extracting-data-getting-compile-error-for-without-next/51747389#51747389", "title": "VBA extracting data: Getting Compile error For without Next", "body": "<p>Error in Ln 85 Col 15 is cuz you cant end if in For... just move it outside For... and it error should be fixed</p>\n"}], "owner": {"reputation": 11, "user_id": 10197537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfffe5acfe8ebce3c8bc9d8c8fbe1e09?s=128&d=identicon&r=PG&f=1", "display_name": "Dawn", "link": "https://stackoverflow.com/users/10197537/dawn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1533737847, "creation_date": 1533730601, "last_edit_date": 1533735411, "question_id": 51746534, "link": "https://stackoverflow.com/questions/51746534/vba-extracting-data-getting-compile-error-for-without-next", "title": "VBA extracting data: Getting Compile error For without Next", "body": "<p>I've have been following a tutorial online (<a href=\"https://www.wiseowl.co.uk/blog/s393/scrape-website-html.htm\" rel=\"nofollow noreferrer\">https://www.wiseowl.co.uk/blog/s393/scrape-website-html.htm</a>). I'm getting a few problems and not sure how to fix them. Basically I'm trying to collect data from a website.</p>\n\n<p>Any tips and idea how to fix the problem? </p>\n\n<p>Thanks in Advance. I entered the code below:</p>\n\n<pre><code>Enum READYSTATE\nREADYSTATE_UNINITIALIZED = 0\nREADYSTATE_LOADING = 1\nREADYSTATE_LOADED = 2\nREADYSTATE_INTERACTIVE = 3\nREADYSTATE_COMPLETE = 4\nEnd Enum\nOption Explicit\n\nSub ImportStackOverflowData()\n\n\n'to refer to the running copy of Internet Explorer\nDim ie As InternetExplorer\n\n'to refer to the HTML document returned\nDim html As HTMLDocument\n\n'open Internet Explorer in memory, and go to website\nSet ie = New InternetExplorer\nie.Visible = False\nie.navigate \"https://ted.europa.eu/udl?uri=TED:NOTICE:310761-2018:TEXT:EN:HTML&amp;src=0\"\n\n'Wait until IE is done loading page\nDo While ie.READYSTATE &lt;&gt; READYSTATE_COMPLETE\n    Application.StatusBar = \"Trying to go to StackOverflow ...\"\n    DoEvents\nLoop\n\n'show text of HTML document returned\nSet html = ie.document\n\nMsgBox html.DocumentElement.innerHTML\n\n'close down IE and reset status bar\nSet ie = Nothing\nApplication.StatusBar = \"\"\n\n'clear old data out and put titles in\nCells.Clear\n\n'put heading across the top of row 3\nRange(\"A3\").Value = \"Company ID\"\n\nDim CompanyList As IHTMLElement\nDim Companies As IHTMLElementCollection\nDim Company As IHTMLElement\nDim RowNumber As Long\nDim CompanyId As String\nDim CompanyFields As IHTMLElementCollection\nDim CompanyField As IHTMLElement\n\nDim votes As String\nDim views As String\n\nDim CompanmyFieldLinks As IHTMLElementCollection\n\nSet CompanyList = html.getElementById(\"fullDocument\")\nSet Companies = CompanyList.Children\nRowNumber = 4\n\nFor Each Company In Companies\n\n  'if this is the tag containing the company details, process it\n  If Company.className = \"txtmark\" Then\n      'first get and store the company id in first column\n      CompanyId = Replace(Company.ID, \"timark\", \"\")\n      Cells(RowNumber, 1).Value = CLng(CompanyId)\n\n     'get a list of all of the parts of this company,\n     'and loop over them\n     Set CompanyFields = Company.all\n\n     For Each CompanyField In CompanyFields  \n        'go on to next row of worksheet\n        RowNumber = RowNumber + 1\n     Next    \n  End If\n\n  Set html = Nothing\n\n  Application.StatusBar = \"\"\n  MsgBox \"Done!\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula", "range"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1533730275, "post_id": 51746318, "comment_id": 90452403, "body": "<i>&quot;last line fails to create the formula&quot;</i> what does &quot;fails&quot; mean? any error message? your string would produce something like <code>=B9*&#39;Master Trainings&#39;!C25,0)</code> so you have a <code>,0)</code> in the end that doesn&#39;t make any sense. You cannot close a bracket in a formula that wasn&#39;t opened before. \u2022 Try to go through your code step-by-step (with F8) and check the values of your variables (see <a href=\"https://www.excel-easy.com/vba/examples/debugging.html\" rel=\"nofollow noreferrer\">Excel Easy - Debugging</a>)."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1533730604, "post_id": 51746318, "comment_id": 90452650, "body": "Not sure about your formula, if you wanted to add the variable c25 to it then....... <code>=&quot;=B9*&#39;Master Trainings&#39;!&quot; &amp; c25</code>"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1533731761, "post_id": 51746318, "comment_id": 90453478, "body": "I don&#39;t know if it makes a difference, I also dimmed c25 as a string, when I tried out the code."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 10187005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b905dd8bb392849806b566aad3ffac4?s=128&d=identicon&r=PG&f=1", "display_name": "alcopo63q", "link": "https://stackoverflow.com/users/10187005/alcopo63q"}, "edited": false, "score": 1, "creation_date": 1533733057, "post_id": 51747184, "comment_id": 90454384, "body": "Yeah, this was a bit of code I copied form something similar that was using a different formula that was useless in this case. All that I needed to do was remove that bit of stuff at the end per your recommendation. Thank you."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 2, "last_activity_date": 1533732497, "creation_date": 1533732497, "answer_id": 51747184, "question_id": 51746318, "link": "https://stackoverflow.com/questions/51746318/range-formula-in-vba-not-accepting-input-range/51747184#51747184", "title": "Range.Formula in VBA not accepting input range", "body": "<p>As mentioned in the comments by @PEH, this part of the formula is a bit useless - <code>\",0)\"</code>. There is only one <code>)</code> and the <code>,0</code> is not required.</p>\n\n<p>This is some minimal code, that works, if you have <code>Master Trainings</code> worksheet:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim c25 As String\n    c25 = \"D10\"\n    Range(\"B2\").Formula = \"=B9*'Master Trainings'!\" &amp; c25\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 10187005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b905dd8bb392849806b566aad3ffac4?s=128&d=identicon&r=PG&f=1", "display_name": "alcopo63q", "link": "https://stackoverflow.com/users/10187005/alcopo63q"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 51747184, "answer_count": 1, "score": 1, "last_activity_date": 1594154997, "creation_date": 1533730002, "last_edit_date": 1594154997, "question_id": 51746318, "link": "https://stackoverflow.com/questions/51746318/range-formula-in-vba-not-accepting-input-range", "title": "Range.Formula in VBA not accepting input range", "body": "<p>So I have this code which finds a specific string on a sheet called <code>Master Trainings</code> and finds the address of the cell to the right of it. That is all fine. Right before this, I have a piece of code which creates a line and puts that same text in a cell, say D4. <code>w</code> here is the r1c1 address of the row above (i.e. <code>3</code> in this case). I have <code>NewCourseCell</code> which returns the address of the cell I want perfectly, but I am not sure why the last line fails to create the formula I want inside that cell.</p>\n\n<pre><code>Dim findRng25 As Range\nDim foundRng25 As Range\nSet findRng25 = Sheets(\"Master Trainings\").Range(\"A:A\")\nSet foundRng25 = findRng25.Find(Cells(w + 1, 4).Value)\n\nDim C25 As Variant\nC25 = Cells(foundRng25.Row, foundRng25.Column + 1).Address(0, 0)\n\nNewCourseCell = Cells(w + 1, 5).Address\nRange(NewCourseCell).Formula = \"=B9*'Master Trainings'!\" &amp; C25 &amp; \",0)\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1533731107, "post_id": 51746279, "comment_id": 90453041, "body": "<a href=\"https://stackoverflow.com/questions/1370286/how-to-get-the-range-of-the-visible-rows-after-applying-an-advanced-filter-in-ex\">This</a> is what you are looking for. Simple search ;)"}], "answers": [{"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1533732342, "post_id": 51746810, "comment_id": 90453887, "body": "It&#39;s perfectly possible"}, {"owner": {"reputation": 119, "user_id": 10197469, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fYj9Q1BxP28/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qkb-G3Qs7BSxOSDIt-sX6pNHkLVQ/mo/photo.jpg?sz=128", "display_name": "LouLav", "link": "https://stackoverflow.com/users/10197469/loulav"}, "edited": false, "score": 0, "creation_date": 1533906573, "post_id": 51746810, "comment_id": 90531706, "body": "Ty for you answer but i found the solution tx to @tigeravatar"}], "tags": [], "owner": {"reputation": 70, "user_id": 9673809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27251286b5205c862011abafbb06a837?s=128&d=identicon&r=PG&f=1", "display_name": "J&#233;r&#233;my Gamba", "link": "https://stackoverflow.com/users/9673809/j%c3%a9r%c3%a9my-gamba"}, "is_accepted": false, "score": 0, "last_activity_date": 1533731392, "creation_date": 1533731392, "answer_id": 51746810, "question_id": 51746279, "link": "https://stackoverflow.com/questions/51746279/how-to-get-all-visible-rows-in-one-range/51746810#51746810", "title": "How to get all visible rows in one range", "body": "<p>From <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-object-excel\" rel=\"nofollow noreferrer\">MSDN</a> about Range Object : \"Represents a cell, a row, a column, a selection of cells containing one or more <strong>contiguous</strong> blocks of cells, or a 3-D range.\"</p>\n\n<p>That's why you only get the first range. Have a look at <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/refer-to-multiple-ranges\" rel=\"nofollow noreferrer\">this page</a> to refer to multiple ranges.</p>\n"}, {"comments": [{"owner": {"reputation": 119, "user_id": 10197469, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fYj9Q1BxP28/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qkb-G3Qs7BSxOSDIt-sX6pNHkLVQ/mo/photo.jpg?sz=128", "display_name": "LouLav", "link": "https://stackoverflow.com/users/10197469/loulav"}, "edited": false, "score": 0, "creation_date": 1533906531, "post_id": 51748645, "comment_id": 90531675, "body": "Hi mate, thanks for your answer, i&#39;ve tried both methods but only the first one is working even if i still dont really get how it works (as i&#39;m new in VBA)."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 1, "last_activity_date": 1533736920, "creation_date": 1533736920, "answer_id": 51748645, "question_id": 51746279, "link": "https://stackoverflow.com/questions/51746279/how-to-get-all-visible-rows-in-one-range/51748645#51748645", "title": "How to get all visible rows in one range", "body": "<p>It sounds like you're trying to populate an array variable named <code>datas</code>, which is successful if your range is continuous, but only gets the first section when discontinuous.  And what you're looking for is to populate the array with all of the data from the discontinuous range.</p>\n\n<p>That is possible, and there are two approaches.  The first is to copy the discontinuous range and paste it into a temp worksheet.  The pasted range will be continuous and then you can load it into the array normally as shown in your original code.  The second is to populate the array directly, but you'll have to loop through each visible cell to do this.</p>\n\n<p>Method 1 (use temp worksheet):</p>\n\n<pre><code>Sub tgrTempWS()\n\n    Dim dataSheet As Worksheet\n    Dim tempSheet As Worksheet\n    Dim rData As Range\n    Dim datas As Variant\n\n    Set dataSheet = ActiveWorkbook.Sheets(\"Sheet1\")\n    On Error Resume Next\n    Set rData = dataSheet.Range(\"A2:L\" &amp; dataSheet.[A65000].End(xlUp).Row).SpecialCells(xlCellTypeVisible)\n    On Error GoTo 0\n    If rData Is Nothing Then Exit Sub   'No data\n\n    Set tempSheet = dataSheet.Parent.Sheets.Add\n    rData.Copy tempSheet.Range(\"A1\")\n    datas = tempSheet.Range(\"A1\").CurrentRegion.Value\n    Application.DisplayAlerts = False\n    tempSheet.Delete\n    Application.DisplayAlerts = True\n\n    'do stuff with your datas array variable here\n\nEnd Sub\n</code></pre>\n\n<p>Method 2 (loop through visible cells):</p>\n\n<pre><code>Sub tgrLoop()\n\n    Dim dataSheet As Worksheet\n    Dim rData As Range\n    Dim rCell As Range\n    Dim datas As Variant\n    Dim lRow As Long, lCol As Long\n    Dim i As Long, j As Long\n\n    Set dataSheet = ActiveWorkbook.Sheets(\"Sheet1\")\n    On Error Resume Next\n    Set rData = dataSheet.Range(\"A2:L\" &amp; dataSheet.[A65000].End(xlUp).Row).SpecialCells(xlCellTypeVisible)\n    On Error GoTo 0\n    If rData Is Nothing Then Exit Sub   'No data\n\n    ReDim datas(1 To Intersect(rData, rData.Areas(1).Resize(, 1).EntireColumn).Cells.Count, 1 To rData.Columns.Count)\n    For Each rCell In rData.Cells\n        If lRow = 0 Then\n            lRow = rCell.Row\n            i = 1\n        ElseIf rCell.Row &gt; lRow Then\n            i = i + 1\n            lRow = rCell.Row\n        End If\n        If lCol = 0 Or rCell.Column &lt; lCol Then\n            lCol = rCell.Column\n            j = 1\n        ElseIf rCell.Column &gt; lCol Then\n            j = j + 1\n            lCol = rCell.Column\n        End If\n        datas(i, j) = rCell.Value\n    Next rCell\n\n    'do stuff with your datas array variable here\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 10197469, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fYj9Q1BxP28/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qkb-G3Qs7BSxOSDIt-sX6pNHkLVQ/mo/photo.jpg?sz=128", "display_name": "LouLav", "link": "https://stackoverflow.com/users/10197469/loulav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 51748645, "answer_count": 2, "score": 0, "last_activity_date": 1533736920, "creation_date": 1533729865, "last_edit_date": 1533730825, "question_id": 51746279, "link": "https://stackoverflow.com/questions/51746279/how-to-get-all-visible-rows-in-one-range", "title": "How to get all visible rows in one range", "body": "<p>I'm trying to get all my filtered data in one range variable but it doesn't work.</p>\n\n<p>When the visible datas are continuous (rows 25 to 200), i've no problem but when the visible datas are discontinuous (rows 25 to 27, then 43 to 47, then 60 to 92) it only get the first range (rows 25 to 27)</p>\n\n<p>Here is my code :</p>\n\n<pre><code>datas = dataSheet.Range(\"A2:L\" &amp; dataSheet. \n[A65000].End(xlUp).Row).SpecialCells(xlCellTypeVisible).Value\n</code></pre>\n\n<p>Do you have any tip ?</p>\n\n<p>Thank you for your answer.</p>\n\n<p>Louis</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1913, "user_id": 2470603, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6590b90317023caf0ae68e9709c5fcc6?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/2470603/michael"}, "edited": false, "score": 0, "creation_date": 1533729535, "post_id": 51746067, "comment_id": 90451950, "body": "Thanks but that pass through is just for reference, I&#39;m actually calling &#39;DeliverySearch&#39; and just using the definitions from the pass through query to talk to SQL"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 1913, "user_id": 2470603, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6590b90317023caf0ae68e9709c5fcc6?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/2470603/michael"}, "edited": false, "score": 0, "creation_date": 1533729754, "post_id": 51746067, "comment_id": 90452080, "body": "Well, that&#39;s the point of pass-through queries. See edit. @Michael"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1533729729, "last_edit_date": 1533729729, "creation_date": 1533729211, "answer_id": 51746067, "question_id": 51745923, "link": "https://stackoverflow.com/questions/51745923/access-passthrough-with-parameter-append-into-local-table/51746067#51746067", "title": "Access Passthrough with Parameter Append into Local table", "body": "<p>The parameter is already written into the pass-through query, so you can simply use it as source for an INSERT query.</p>\n\n<pre><code>INSERT INTO tmpDelPack\nSELECT * FROM qMasterPass\n</code></pre>\n\n<p>and you can run it like this:</p>\n\n<pre><code>Set Db = CurrentDb\nDb.QueryDefs(\"qMasterPass\").SQL = \"exec DeliverySearch \" &amp; txtSearch\nDb.Execute \"INSERT INTO tmpDelPack SELECT * FROM qMasterPass\"\n</code></pre>\n"}], "owner": {"reputation": 1913, "user_id": 2470603, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6590b90317023caf0ae68e9709c5fcc6?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/2470603/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 51746067, "answer_count": 1, "score": 0, "last_activity_date": 1533729729, "creation_date": 1533728757, "question_id": 51745923, "link": "https://stackoverflow.com/questions/51745923/access-passthrough-with-parameter-append-into-local-table", "title": "Access Passthrough with Parameter Append into Local table", "body": "<p>I created a passthrough query (qMasterPass), that allows me to then easily call any other SQL Stored Procedure using the below - the example also updates a listbox and this works:</p>\n\n<pre><code>With CurrentDb.QueryDefs(\"qMasterPass\")\n     .SQL = \"exec DeliverySearch \" &amp; txtSearch\n     Set Me.lstSearchResults.Recordset = .OpenRecordset\nEnd With\n</code></pre>\n\n<p>How would I modify the above to append to a local Access table (tmpDelPack).  The GeneralSearch SP contains two fields, DeliveryNum and Package</p>\n"}, {"tags": ["vba", "copy"], "answers": [{"tags": [], "owner": {"reputation": 40, "user_id": 10165736, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bRim3GUnX_w/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ppywRDXmj6Z5qL4bcjB34IxVp2nQ/mo/photo.jpg?sz=128", "display_name": "Kau&#234; Delmonte", "link": "https://stackoverflow.com/users/10165736/kau%c3%aa-delmonte"}, "is_accepted": true, "score": 1, "last_activity_date": 1533730157, "creation_date": 1533730157, "answer_id": 51746373, "question_id": 51745602, "link": "https://stackoverflow.com/questions/51745602/copy-data-from-one-sheet-to-another-based-on-cell-value/51746373#51746373", "title": "Copy data from one sheet to another based on cell value", "body": "<p>I created two sheets with same names.</p>\n\n<p>I put in sheet \"LEL2230K\" address C6:C9 some data: \"DATA1\", \"DATA2\", \"DATA3\", \"DATA4\"</p>\n\n<p>When I run your macro, everything works fine. But I make some changes in your code, try it:</p>\n\n<pre><code>Sub COPY1()\n\n    Dim LEL2230K, MASTER As Worksheet\n\n    Set LEL2230K = ThisWorkbook.Sheets(\"LEL2230K\")\n    Set MASTER = ThisWorkbook.Sheets(\"MASTER\")\n\n    LEL2230K.Range(LEL2230K.Cells(6, \"C\"), LEL2230K.Cells(LEL2230K.Cells(LEL2230K.Rows.Count, \"C\").End(xlUp).Row, \"C\")).Copy\n\n    MASTER.Cells(7, \"A\").PasteSpecial\n\nEnd Sub\n</code></pre>\n\n<p>I highly recommend you to name sheet objects in it properties and use it name as reference.</p>\n"}], "owner": {"reputation": 9, "user_id": 9173651, "user_type": "registered", "profile_image": "https://graph.facebook.com/1585483368199029/picture?type=large", "display_name": "Ahmad Al-Abyouki", "link": "https://stackoverflow.com/users/9173651/ahmad-al-abyouki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 51746373, "answer_count": 1, "score": 0, "last_activity_date": 1533730157, "creation_date": 1533727759, "question_id": 51745602, "link": "https://stackoverflow.com/questions/51745602/copy-data-from-one-sheet-to-another-based-on-cell-value", "title": "Copy data from one sheet to another based on cell value", "body": "<p>I am trying to copy data from one sheet to another in the same workbook based on a cell value: below is my code, however it gives me an application 1004 error when compiling and i do not have a clue. please he;lp</p>\n\n<pre><code>Sub COPY1()\n     Dim lROW As Integer\n     Dim rngFrom, rngTo As Range\n     Sheets(\"LEL2230K\").Activate\nlROW = Sheets(\"LEL2230K\").Cells(Rows.Count, \"C\").End(xlUp).Row\nSet rngFrom = Sheets(\"LEL2230K\").Range(Cells(6, \"C\"), Cells(lROW, \"C\"))\n Sheets(\"MASTER\").Activate\nSet rngTo = Sheets(\"Master\").Range(Cells(7, \"A\"), Cells(lROW, \"A\"))\nrngFrom.Copy rngTo\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "vba", "excel", "web-scraping"], "comments": [{"owner": {"reputation": 768, "user_id": 9409149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jHGGN.png?s=128&g=1", "display_name": "DKyleo", "link": "https://stackoverflow.com/users/9409149/dkyleo"}, "edited": false, "score": 1, "creation_date": 1533728120, "post_id": 51745531, "comment_id": 90451011, "body": "Your spelling of visible is incorrect - and you are including an &#39;i&#39; that does not appear to be defined in the Sheet1.Cells line."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1533728176, "post_id": 51745531, "comment_id": 90451040, "body": "I recommend to use <code>Option Explicit</code> to avoid typos (<code>.Visable</code> vs <code>.Visible</code>)"}, {"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 1, "creation_date": 1533728800, "post_id": 51745531, "comment_id": 90451466, "body": "Where are you New-ing CreatingObject?  Or do you really want to be using <code>CreateObject</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1534501867, "post_id": 51745799, "comment_id": 90737573, "body": "Did this make a difference?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 2, "last_activity_date": 1533729344, "last_edit_date": 1533729344, "creation_date": 1533728394, "answer_id": 51745799, "question_id": 51745531, "link": "https://stackoverflow.com/questions/51745531/using-vba-to-extract-data-from-website-but-getting-run-time-error-91/51745799#51745799", "title": "Using VBA to extract data from website, but getting run time error &#39;91&#39;", "body": "<p>In the absence of HTML/URL to go with:</p>\n\n<p>1) You are spelling of <code>Visible</code> is incorrect </p>\n\n<p>2) The following:</p>\n\n<pre><code>Set elements = .document.getElementByClass(\"timark\")\n</code></pre>\n\n<p>Is missing an <code>s</code> as it returns a collection and should be <code>ClassName</code>:</p>\n\n<pre><code>Set elements = .document.getElementsByClassName(\"timark\")\n</code></pre>\n\n<p>3) You may need a pause or loop to ensure <code>elements</code> is available on the page. </p>\n\n<p>4) This</p>\n\n<pre><code>Sheet1.Cells(i, 8) = element.innerText\n</code></pre>\n\n<p>You don't yet have <code>element</code> declared and assigned (you also don't have <code>elements</code> declared) . You may use in a <code>For Loop</code>.</p>\n\n<p>e.g.</p>\n\n<pre><code> Dim element As Object, elements As Object\n Set elements = .document.getElementsByClassName(\"timark\")\n For each element in elements\n</code></pre>\n\n<p>5) <code>Creating</code> should be <code>Create</code> (also as noted) and you need to declare <code>objIE</code></p>\n\n<pre><code>Dim objIE As Object\nSet objIE = CreateObject(\"InternetExplorer.Application\")\n</code></pre>\n\n<p>6) <code>i</code> is not declared anywhere and must be greater than 1 when it is as there is no cell with row 0 in the sheet. Also, <code>i</code> would indicate a Loop of which there is no sign and when in a loop should be incremented to avoid overwriting the same cell.</p>\n\n<p>7)  <code>Dim WebNavigate As Object</code> is unassigned and not needed at present in the code.</p>\n\n<p>8) To avoid many of the above use <code>Option Explicit</code> at the top of your code (As already mentioned).</p>\n"}], "owner": {"reputation": 1, "user_id": 10196739, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4Em2uCyNgNI/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qw-kt-5TTMJs8kZuy60TB3dDwmvQ/mo/photo.jpg?sz=128", "display_name": "Leashy", "link": "https://stackoverflow.com/users/10196739/leashy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533740552, "creation_date": 1533727565, "last_edit_date": 1533740552, "question_id": 51745531, "link": "https://stackoverflow.com/questions/51745531/using-vba-to-extract-data-from-website-but-getting-run-time-error-91", "title": "Using VBA to extract data from website, but getting run time error &#39;91&#39;", "body": "<p>Quite new to VBA, having a problem with this error code.</p>\n\n<blockquote>\n  <p>run time error '91' object variable or With block variable not set</p>\n</blockquote>\n\n<p>I'm trying to extract data from a website and past to a excel document. My Excel doc is <code>Book2</code> and my module is called <code>Module1</code>. I'll paste the code below.</p>\n\n<pre><code>Sub WebNavigate()    \n    Dim CreatingObject As Object\n    Dim WebNavigate As Object\n\n    Set objIE = CreatingObject(\"InternetExplorer.Application\")\n    WebSite = \"website link\"\n    With objIE\n        .Visable = True\n        .navigate WebSite\n        Do While .Busy Or .readyState &lt;&gt; 4\n            DoEvents\n        Loop\n\n        Set elements = .document.getElementByClass(\"timark\")\n        Sheet1.Cells(i, 8) = element.innerText\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1533726034, "creation_date": 1533726034, "answer_id": 51745027, "question_id": 51744377, "link": "https://stackoverflow.com/questions/51744377/how-to-populate-a-specific-cell-range-with-db2-variables/51745027#51745027", "title": "How to populate a specific cell range with DB2 variables", "body": "<p>First step: Change your SQL statement so that it returns all columns you want.</p>\n\n<pre><code>strSQL = \"SELECT CONTRACT_NUM\" _ \n       &amp; \"      , Party_Type_Code\" _\n       &amp; \"      , Surname\" _\n       &amp; \"      , First_Name\" _ \n       (...)\n       &amp; \" FROM \" &amp; Region &amp; \".\" &amp; Table _\n       &amp; \" WHERE CONTRACT_NUM=\" &amp; CONTRACTNO &amp; \" fetch first row only;\"\n</code></pre>\n\n<p>Second step: Write data to your sheet. There are several ways to do so:  </p>\n\n<p>The easiest way to get data from a Recordset into a sheet is using the Range-Command <code>CopyFromRecordset</code>. This will write all data into the Excel sheet, so you could try:</p>\n\n<pre><code>Sheets(\"Sheet1\").Range(\"I\" &amp; row_num).CopyFromRecordset(rs)\n</code></pre>\n\n<p>If you want to write the data indiviually, the easiest way is to use the Recordset-Command <code>GetRows</code> that writes the data into a (zero-based) 2-dimensional array. Just be aware that the first index is the column, the second the row.</p>\n\n<p>The following code would basically do the same as the statement above, just to get you the idea:</p>\n\n<pre><code>Dim data As Variant\ndata = rs.GetRows\nDim r As Range\nSet r = Sheets(\"Sheet1\").Range(\"I\" &amp; row_num)\nDim colIndex As Long, rowIndex As Long\n\nFor colIndex = 0 To UBound(res, 1)\n    For rowIndex = 0 To UBound(res, 2)\n        r.Offset(rowIndex, colIndex) = res(colIndex, rowIndex)\n    Next rowIndex\nNext colIndex\n</code></pre>\n\n<p><strong>Note</strong>: Both examples assumes that your SQL-Code works, the RecordSet is created and contains data. For a robust solution, you have to add error handling for example for the case the SQL statement didn't return any data.</p>\n"}], "owner": {"reputation": 27, "user_id": 10104155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9213ebf5b3457cfd23a83145f9c50100?s=128&d=identicon&r=PG&f=1", "display_name": "Vivek8086", "link": "https://stackoverflow.com/users/10104155/vivek8086"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533726034, "creation_date": 1533724031, "question_id": 51744377, "link": "https://stackoverflow.com/questions/51744377/how-to-populate-a-specific-cell-range-with-db2-variables", "title": "How to populate a specific cell range with DB2 variables", "body": "<p>I need to populate cell values from DB2. </p>\n\n<p>Below is my column structure in Excel.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>Contract Number\t\t\t\r\n\r\nParty Type Code\t\t\t\r\nSurname\t\t\t\r\nFirst Name\t\t\t\r\nDate Of Birth\t\t\t\r\nAddress Line-1\t\t\t\r\nCity\t\t\t\r\nProvince Code\t\t\t\r\nPostal Code\t\t\t\r\nCountry Code\t\t\t\r\nCountry Text\t\t\t\r\n\t\r\nParty Type Code\t\t\t\r\nSurname\t\t\t\r\nFirst Name\t\t\t\r\nDate Of Birth\t\t\t\r\nAddress Line-1\t\t\t\r\nCity\t\t\t\r\nProvince Code\t\t\t\r\nPostal Code\t\t\t\r\nCountry Code\t\t\t\r\nCountry Text\t\t\t</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I have a working connection from Excel to DB2.</p>\n\n<p>My requirement is to pass contract number field from Excel to DB2 and fetch the corresponding details.</p>\n\n<p>There could be multiple rows having the same contract number, as in this case.</p>\n\n<p>As of now, I am populating individual fields and then assigning them to the cell values.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>strSQL = \"SELECT CONTRACT_NUM FROM \" &amp; Region &amp; \".\" &amp; Table &amp; \" WHERE CONTRACT_NUM=\" &amp; CONTRACTNO &amp; \" fetch first row only;\"\r\n\r\nSet rs = conn.Execute(strSQL)\r\nSheets(\"Sheet1\").Range(\"I\" &amp; row_num).Value = rs.Fields(0).Value</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Is there a simpler way to populate all the fields simultaneously ?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "ms-word", "line-breaks", "linefeed"], "answers": [{"tags": [], "owner": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "is_accepted": true, "score": 1, "last_activity_date": 1533728739, "creation_date": 1533728739, "answer_id": 51745913, "question_id": 51743982, "link": "https://stackoverflow.com/questions/51743982/vba-word-cannot-insert-linefeed/51745913#51745913", "title": "VBA Word cannot insert Linefeed", "body": "<p>Word uses the vertical tab (character code 11) for line breaks. So you'll want something like this:</p>\n\n<pre><code>sSomeString = Replace(sSomeString, \"-\", Chr(11) &amp; Chr(30))\n</code></pre>\n\n<p>I don't know if Microsoft makes this readily available. However, you can always insert a line break in Word (Shift+Enter), then use VBA to examine the character code.</p>\n"}], "owner": {"reputation": 221, "user_id": 2871190, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b3508572f0b2187fcabb3dc8e51d3e8d?s=128&d=identicon&r=PG&f=1", "display_name": "user2871190", "link": "https://stackoverflow.com/users/2871190/user2871190"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 51745913, "answer_count": 1, "score": 0, "last_activity_date": 1533734557, "creation_date": 1533722809, "last_edit_date": 1533734557, "question_id": 51743982, "link": "https://stackoverflow.com/questions/51743982/vba-word-cannot-insert-linefeed", "title": "VBA Word cannot insert Linefeed", "body": "<p>I have a string with a number, looking like this:</p>\n\n<p>\"12345678-123\" </p>\n\n<p>I want to add a linefeed (the thing you get by pressing [SHIFT] + [ENTER]) before the dash \"-\".</p>\n\n<p>It keeps adding a carriage return. This is my code:</p>\n\n<pre><code>sSomeString = Replace(sSomeString, \"-\", vbLf &amp; Chr(30)) 'Chr(11) does not work ether - Chr(30) is the char for the dash, that does not break\n\nActiveDocument.Tables(iTableIndex).Cell(.Rows.Count, 4).Range.Text = sSomeString\n</code></pre>\n\n<p>I googled and so far it says everywhere to use ether vbLf or Chr(11). Any ideas?</p>\n\n<p>// Problem solved:</p>\n\n<p>My code didn't run correctly cause I was not using the Char(30), so Word created a Linebreak with the character \"-\"</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1533723142, "post_id": 51743706, "comment_id": 90447963, "body": "You probably need to change <code>ThisWorkbook</code> to <code>ActiveWorkbook</code>. <code>ThisWorkbook</code> is the workbook this code is running at (so probably your add-in). <code>ActiveWorkbook</code> is the workbook that has the focus and is on top at the moment the code is running."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1533727370, "post_id": 51743706, "comment_id": 90450503, "body": "What are you trying to achieve? Is it to copy a sheet from your template to a new workbook? not sure what the end goal is here"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1533734144, "post_id": 51743706, "comment_id": 90455125, "body": "Does specifying whether you want to copy your worksheet <code>Before</code> or <code>After</code> <code>ThisWorkbook.Sheets(Sheets.Count)</code> fix the problem?"}], "owner": {"reputation": 75, "user_id": 10189458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cbfb99e9cc10c16f4b2f21300b01a34?s=128&d=identicon&r=PG&f=1", "display_name": "Lim", "link": "https://stackoverflow.com/users/10189458/lim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1594155004, "creation_date": 1533721996, "last_edit_date": 1594155004, "question_id": 51743706, "link": "https://stackoverflow.com/questions/51743706/run-time-error-1004-copy-of-object-worksheet-failed", "title": "Run time error &quot;1004&quot; copy of object worksheet failed", "body": "<p>I'm stuck with this problem:<br>\nI tried to save a memo template with macro in. But when I open the new Excel, the memo template follows but not the code. Therefore I save the memo template as Excel addins. However when I assign the macro to the button, there is the error message:</p>\n\n<blockquote>\n  <p>Run time error \"1004\" copy of object worksheet failed</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/pr0wk.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pr0wk.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub Test()\n    Dim ws1 As Worksheet\n    Set ws1 = ThisWorkbook.Worksheets(\"Sample1\")\n    ws1.Copy ThisWorkbook.Sheets(Sheets.Count)\n\n    Dim Sheetname As String\n    With ActiveSheet\n        Sheetname = InputBox(\"Enter name of this Worksheet\")\n        .Name = Sheetname\n    End With \nEnd Sub\n</code></pre>\n\n<p>The line with error msg is <code>ws1.Copy ThisWorkbook.Sheets(Sheets.Count)</code></p>\n\n<p>The excel file name is <code>book1.xlsm</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/pzHXP.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pzHXP.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "function", "vlookup"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1533728230, "post_id": 51743298, "comment_id": 90451081, "body": "The range you want to do <code>VLookUp</code> on, is it in the same workbook or a different workbook? from your example, it looks like your range is in <code>test.xls</code> workbook, which may or may not be the same workbook?"}, {"owner": {"reputation": 77, "user_id": 8966999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b57dc4045be0594909cb357a98756d0?s=128&d=identicon&r=PG&f=1", "display_name": "L.Writer", "link": "https://stackoverflow.com/users/8966999/l-writer"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1533733859, "post_id": 51743298, "comment_id": 90454937, "body": "Oh sorry, it&#39;s a different workbook with the name &quot;test.xls&quot; and the other workbook is called &quot;missing.xls&quot; in which I would like to run the code."}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 8966999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b57dc4045be0594909cb357a98756d0?s=128&d=identicon&r=PG&f=1", "display_name": "L.Writer", "link": "https://stackoverflow.com/users/8966999/l-writer"}, "edited": false, "score": 0, "creation_date": 1533727765, "post_id": 51743649, "comment_id": 90450782, "body": "Almost as the solution from zipa... But with your examples I got just &quot;syntax error&quot;, when I try to call the function. Any ideas? Thanks."}, {"owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "reply_to_user": {"reputation": 77, "user_id": 8966999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b57dc4045be0594909cb357a98756d0?s=128&d=identicon&r=PG&f=1", "display_name": "L.Writer", "link": "https://stackoverflow.com/users/8966999/l-writer"}, "edited": false, "score": 0, "creation_date": 1533730218, "post_id": 51743649, "comment_id": 90452361, "body": "@L.Writer which method? I just remove <code>.select</code> from my answer.  Please try again."}, {"owner": {"reputation": 77, "user_id": 8966999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b57dc4045be0594909cb357a98756d0?s=128&d=identicon&r=PG&f=1", "display_name": "L.Writer", "link": "https://stackoverflow.com/users/8966999/l-writer"}, "edited": false, "score": 0, "creation_date": 1533789367, "post_id": 51743649, "comment_id": 90476984, "body": "I have tried again, but I still receive the syntax error if I try to call the function inside a cell.. :/"}, {"owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "reply_to_user": {"reputation": 77, "user_id": 8966999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b57dc4045be0594909cb357a98756d0?s=128&d=identicon&r=PG&f=1", "display_name": "L.Writer", "link": "https://stackoverflow.com/users/8966999/l-writer"}, "edited": false, "score": 0, "creation_date": 1533790162, "post_id": 51743649, "comment_id": 90477176, "body": "@L.Writer Which method and which line?"}, {"owner": {"reputation": 77, "user_id": 8966999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b57dc4045be0594909cb357a98756d0?s=128&d=identicon&r=PG&f=1", "display_name": "L.Writer", "link": "https://stackoverflow.com/users/8966999/l-writer"}, "edited": false, "score": 0, "creation_date": 1533790283, "post_id": 51743649, "comment_id": 90477212, "body": "Both methods, by debugging I don&#39;t get any error messages. Just if I try to call the function in a cell I&#39;m receiving the syntax error. Trying to call the methods like this: <code>=method1()</code>"}, {"owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "reply_to_user": {"reputation": 77, "user_id": 8966999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b57dc4045be0594909cb357a98756d0?s=128&d=identicon&r=PG&f=1", "display_name": "L.Writer", "link": "https://stackoverflow.com/users/8966999/l-writer"}, "edited": false, "score": 0, "creation_date": 1533790595, "post_id": 51743649, "comment_id": 90477309, "body": "Both methods are <code>Sub</code>, not <code>Function</code>.  You cannot call <code>Sub</code> by writing <code>sub_name</code> in a cell."}, {"owner": {"reputation": 77, "user_id": 8966999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b57dc4045be0594909cb357a98756d0?s=128&d=identicon&r=PG&f=1", "display_name": "L.Writer", "link": "https://stackoverflow.com/users/8966999/l-writer"}, "edited": false, "score": 0, "creation_date": 1533792061, "post_id": 51743649, "comment_id": 90477798, "body": "Oh ok, got it. Then how I&#39;m able to execute / trigger the event? Sorry, don&#39;t understand. (btw. just chaning &quot;sub&quot; to &quot;function&quot; is not working, I have tried, because a function which I can call if required would just be the best for me)"}], "tags": [], "owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "is_accepted": false, "score": 2, "last_activity_date": 1533730266, "last_edit_date": 1533730266, "creation_date": 1533721867, "answer_id": 51743649, "question_id": 51743298, "link": "https://stackoverflow.com/questions/51743298/excel-vlookup-left-cell-into-vba-from-another-workbook/51743649#51743649", "title": "Excel VlookUp left cell into VBA from another workbook", "body": "<p>There are two methods.</p>\n\n<h1>method 1: using <code>.formula</code></h1>\n\n<pre><code>sub method1()\n    dim x1 as range\n\n    set x1 = ActiveCell.Offset(0, -1)\n    x1.formula = \"=VLOOKUP(A6,'[test.xls]Sheet1'!$A:$B,2,0)\"\nend sub\n</code></pre>\n\n<h1>method 2: using <code>.value</code></h1>\n\n<pre><code>sub method2()\n    dim x1 as range\n\n    set x1 = activecell.offset(0, -1)\n    x1.value = application.vlookup(range(\"A6\").value, workbooks(\"test.xls\").worksheets(\"Sheet1\").range(\"A:B\"),2,0)\nend sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 77, "user_id": 8966999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b57dc4045be0594909cb357a98756d0?s=128&d=identicon&r=PG&f=1", "display_name": "L.Writer", "link": "https://stackoverflow.com/users/8966999/l-writer"}, "edited": false, "score": 0, "creation_date": 1533727605, "post_id": 51744279, "comment_id": 90450686, "body": "Thanks in advance for the code, it seems that I can&#39;t figure out how to call the function (MyLookup). I have created a module (seems to be needed) and pasted the code inside this module, but when I enter inside (e.g.) &quot;B7&quot; <code>=MyLookup()</code> I got just <b>&quot;#VALUE!&quot;</b> - sorry, I&#39;m very newbie with VBA :3"}, {"owner": {"reputation": 24193, "user_id": 5811078, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NlknE.png?s=128&g=1", "display_name": "zipa", "link": "https://stackoverflow.com/users/5811078/zipa"}, "reply_to_user": {"reputation": 77, "user_id": 8966999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b57dc4045be0594909cb357a98756d0?s=128&d=identicon&r=PG&f=1", "display_name": "L.Writer", "link": "https://stackoverflow.com/users/8966999/l-writer"}, "edited": false, "score": 0, "creation_date": 1533728429, "post_id": 51744279, "comment_id": 90451209, "body": "You are looking in <code>B7</code> in which sheet? This performs lookup from <code>Sheet1!A:B</code> so your <code>B7</code> is within that same range if you are trying in <code>Sheet1</code>."}, {"owner": {"reputation": 77, "user_id": 8966999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b57dc4045be0594909cb357a98756d0?s=128&d=identicon&r=PG&f=1", "display_name": "L.Writer", "link": "https://stackoverflow.com/users/8966999/l-writer"}, "edited": false, "score": 0, "creation_date": 1533735520, "post_id": 51744279, "comment_id": 90456086, "body": "I would like to call the function in B7 and then the value from A7 should be searched in <b>another</b> workbook called &quot;test.xls&quot;."}, {"owner": {"reputation": 77, "user_id": 8966999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b57dc4045be0594909cb357a98756d0?s=128&d=identicon&r=PG&f=1", "display_name": "L.Writer", "link": "https://stackoverflow.com/users/8966999/l-writer"}, "edited": false, "score": 0, "creation_date": 1533789290, "post_id": 51744279, "comment_id": 90476971, "body": "Thanks for the update, but unfortunately it&#39;s still not working for me (same behaviour). By debugging the code I&#39;m receiving following message: <b>&quot;runtime error &quot;424&quot;: Object required&quot;</b> - do you may have an idea how to solve?"}], "tags": [], "owner": {"reputation": 24193, "user_id": 5811078, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NlknE.png?s=128&g=1", "display_name": "zipa", "link": "https://stackoverflow.com/users/5811078/zipa"}, "is_accepted": false, "score": 1, "last_activity_date": 1533742143, "last_edit_date": 1533742143, "creation_date": 1533723697, "answer_id": 51744279, "question_id": 51743298, "link": "https://stackoverflow.com/questions/51743298/excel-vlookup-left-cell-into-vba-from-another-workbook/51744279#51744279", "title": "Excel VlookUp left cell into VBA from another workbook", "body": "<p>This one should do it:</p>\n\n<pre><code>Function MyLookup()\n\n    Dim source As Workbook\n\n    Dim current As Range\n\n    Set current = Application.Caller\n    Set source = Workbooks(\"test.xls\")\n\n    MyLookup = Application.WorksheetFunction.VLookup(current.Offset(0, -1).Value, source.Sheets(1).Range(\"A:B\"), 2, False)\n\nEnd Function\n</code></pre>\n\n<p>So <code>Application.Caller</code> gets the cell where the function is located and from there you can perform <code>VLOOKUP()</code> with <code>Offset</code> from that cell.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>For this lookup to work <code>test.xls</code> needs to be open.</p>\n"}], "owner": {"reputation": 77, "user_id": 8966999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b57dc4045be0594909cb357a98756d0?s=128&d=identicon&r=PG&f=1", "display_name": "L.Writer", "link": "https://stackoverflow.com/users/8966999/l-writer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1533742143, "creation_date": 1533720920, "last_edit_date": 1533734024, "question_id": 51743298, "link": "https://stackoverflow.com/questions/51743298/excel-vlookup-left-cell-into-vba-from-another-workbook", "title": "Excel VlookUp left cell into VBA from another workbook", "body": "<p><em>Hi everybody,</em> my VLookUp function is working so far, now I would like to convert it into a VBA function.</p>\n\n<p>My VLookUp:</p>\n\n<pre><code>=VLOOKUP(A6;'[test.xls]Sheet1'!$A:$B;2;0) 'example for Cell A6, which can vary\n</code></pre>\n\n<p>Now I would like to get this into a VBA function which can be called.\nSo if the function is called \"A6\" sould be \"overwriten\" by the left cell of where the function has been called.</p>\n\n<p>I have tried following code:</p>\n\n<pre><code>Sub lookup()\n        Dim x1 As String\n        x1 = ActiveCell.Offset(0, -1).Select\n        VLOOKUP(x1,'[test.xls]Sheet1'!$A:$B;2;0)\nEnd Sub\n</code></pre>\n\n<p>What is necessary that it's working as expected?</p>\n\n<p>I'm grateful for any tips.</p>\n\n<hr>\n\n<h2>Update:</h2>\n\n<p>Sorry, mabye it wasn't clear. \"test.xls\" is <strong>another</strong> workbook. The code should  run inside the file called (e.g.) \"missing.xls\".</p>\n"}, {"tags": ["vba", "excel-2010"], "answers": [{"tags": [], "owner": {"reputation": 62, "user_id": 6863844, "user_type": "registered", "profile_image": "https://graph.facebook.com/989745891147306/picture?type=large", "display_name": "Shyam Pandey", "link": "https://stackoverflow.com/users/6863844/shyam-pandey"}, "is_accepted": true, "score": 1, "last_activity_date": 1533730421, "last_edit_date": 1533730421, "creation_date": 1533724726, "answer_id": 51744600, "question_id": 51743083, "link": "https://stackoverflow.com/questions/51743083/vba-code-to-check-one-column-data-with-multiple-columns-data/51744600#51744600", "title": "VBA Code to Check one Column Data with Multiple Columns Data?", "body": "<p>use below code. i have tested on your query </p>\n\n<p>Please test it if any problem, feel free to contact.</p>\n\n<pre><code>Function allvlookup(rng As Range, rng1 As Range)\n\n    Dim rng_r As Range\n    Dim str As String\n\n\n    For Each rng_r In rng1\n        If rng = rng_r Then\n            result = rng_r.Value\n        End If\n    Next rng_r\n\n    allvlookup = result\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9161555, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CXTGBbEyoIU/AAAAAAAAAAI/AAAAAAAABE0/Oj7pmaX9L5c/photo.jpg?sz=128", "display_name": "srivardhan kandike", "link": "https://stackoverflow.com/users/9161555/srivardhan-kandike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 785, "favorite_count": 0, "accepted_answer_id": 51744600, "answer_count": 1, "score": 1, "last_activity_date": 1533730421, "creation_date": 1533720305, "last_edit_date": 1533724292, "question_id": 51743083, "link": "https://stackoverflow.com/questions/51743083/vba-code-to-check-one-column-data-with-multiple-columns-data", "title": "VBA Code to Check one Column Data with Multiple Columns Data?", "body": "<p>I have id numbers on column A starts from A3 To A25. want to check each of the column A value with the F G H I columns values. In F G H I columns where data starts from 29th-row How do check with A column value with multiple columns values at a time?</p>\n\n<p>lastrow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row</p>\n\n<p>lastrow1 = Range(\"F\" &amp; Rows.Count).End(xlUp).Row   </p>\n\n<pre><code>For i = 3 To lastrow\n\n    For j = 30 To lastrow1\n\n        If Range(\"F\" &amp; j).Value = Range(\"A\" &amp; i).Value Or Range(\"G\" &amp; j).Value = Range(\"A\" &amp; i).Value Or Range(\"H\" &amp; j).Value = Range(\"A\" &amp; i).Value Or Range(\"I\" &amp; j).Value = Range(\"A\" &amp; i).Value Then\n        End if\n\n    Next j\n\nNext i\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1533722957, "post_id": 51742998, "comment_id": 90447862, "body": "Typo in the sheet name? <i>Cosolidate</i> vs <i>Consolidate</i>"}], "answers": [{"tags": [], "owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "is_accepted": true, "score": 0, "last_activity_date": 1533740799, "creation_date": 1533740799, "answer_id": 51750010, "question_id": 51742998, "link": "https://stackoverflow.com/questions/51742998/vba-vlookup-error-1004/51750010#51750010", "title": "VBA Vlookup error 1004", "body": "<p>To allow a non-breaking error, replace...</p>\n\n<pre><code>If IsError(Application.WorksheetFunction.VLookup( . . .\n</code></pre>\n\n<p>with</p>\n\n<pre><code>If IsError(Application.VLookup( . . .\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 9595846, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3FsmxJvPBuM/AAAAAAAAAAI/AAAAAAAAABU/TkdSYCh1Les/photo.jpg?sz=128", "display_name": "Liang Wu", "link": "https://stackoverflow.com/users/9595846/liang-wu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 51750010, "answer_count": 1, "score": 0, "last_activity_date": 1533740799, "creation_date": 1533720054, "last_edit_date": 1533720124, "question_id": 51742998, "link": "https://stackoverflow.com/questions/51742998/vba-vlookup-error-1004", "title": "VBA Vlookup error 1004", "body": "<p>I am trying to use vlookup in VBA. However, it ran into 1004 error. \nCould anyone help me on this? Thank you! </p>\n\n<pre><code>Sub lookup()\n\nDim i3 As Long\n\nFor i3 = 2 To 30\n\nIf IsError(Application.WorksheetFunction.VLookup(Sheets(\"Consolidate\").Cells(i3, 2), Sheets(\"Group\").Range(\"E2:E30\"), 1, False)) Then\n\nSheets(\"Cosolidate\").Cells(i3, 3).Value = \"New\"\n\nEnd If\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1533734362, "post_id": 51742806, "comment_id": 90455277, "body": "What&#39;s the setting of the option &quot;Print in background&quot;? (File/Options/Advanced, section &quot;Print&quot;) If that&#39;s activated try de-activating it and see if the behavior is different."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1533734507, "post_id": 51742806, "comment_id": 90455377, "body": "Note that the code would benefit from a number of optimizations. But before suggestions could be made it would be helpful to know why and what is being printed out in each loop (instead of waiting until the code has finished processing the table)."}, {"owner": {"reputation": 89, "user_id": 6362653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2797c883be869241a7681c0084f0feae?s=128&d=identicon&r=PG&f=1", "display_name": "SmIqbal", "link": "https://stackoverflow.com/users/6362653/smiqbal"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1533751572, "post_id": 51742806, "comment_id": 90465895, "body": "Hi Cindy, Thanks again. I just checked and noticed that the &quot;Print in background&quot; option was checked. With regards to your second question, the only reason I am using printout command before letting the loop to read all the rows of source table is because the values are being printed in header area. Otherwise, I would have stored all the values in an array and printed them on each new page in the body section of the document, and in our case the body or main part of each annexure is not at our disposal to print our required annexure info, instead these are pre-printed supporting documents."}, {"owner": {"reputation": 89, "user_id": 6362653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2797c883be869241a7681c0084f0feae?s=128&d=identicon&r=PG&f=1", "display_name": "SmIqbal", "link": "https://stackoverflow.com/users/6362653/smiqbal"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1533751863, "post_id": 51742806, "comment_id": 90466047, "body": "The target document is just a placeholder where we are placing info for printing about each annexure in header area at runtime and sending printout command to printer. Assume you have put a stack of all the annexures on printer so that through this small program you could print 3 lines of basic info on top right side where you have some space to add this info."}, {"owner": {"reputation": 89, "user_id": 6362653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2797c883be869241a7681c0084f0feae?s=128&d=identicon&r=PG&f=1", "display_name": "SmIqbal", "link": "https://stackoverflow.com/users/6362653/smiqbal"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1533752325, "post_id": 51742806, "comment_id": 90466304, "body": "Just to let you know, I have been getting this job done using mail merge but that method takes around 10-15 mins in setting up my Excel based source data each time. And I have to work between 2 different apps, Word and Excel. If I manage to fix my printing problem as I have briefed about earlier, I would be able to save 10-15 mins and the job could be completed in one click only."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 1, "creation_date": 1533769688, "post_id": 51742806, "comment_id": 90473076, "body": "&#171;I have been getting this job done using mail merge but that method takes around 10-15 mins in setting up my Excel based source data each time&#187;. You should only ever need to do a mailmerge setup once, then save the mailmerge main document. From then on, it&#39;s just a matter of opening the mailmerge main document and executing the merge, which requires just a couple of mouse clicks, even if the data file is an entirely new one with the same name."}, {"owner": {"reputation": 89, "user_id": 6362653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2797c883be869241a7681c0084f0feae?s=128&d=identicon&r=PG&f=1", "display_name": "SmIqbal", "link": "https://stackoverflow.com/users/6362653/smiqbal"}, "edited": false, "score": 0, "creation_date": 1533796602, "post_id": 51742806, "comment_id": 90479585, "body": "This is not a usual setup of fixed source data that you print time and again. In this case we have to put source data in Excel file every time because it changes every time. Actually, I am more interested in finding a solution to the printing issue I am having at the moment."}, {"owner": {"reputation": 89, "user_id": 6362653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2797c883be869241a7681c0084f0feae?s=128&d=identicon&r=PG&f=1", "display_name": "SmIqbal", "link": "https://stackoverflow.com/users/6362653/smiqbal"}, "edited": false, "score": 0, "creation_date": 1533797252, "post_id": 51742806, "comment_id": 90479956, "body": "Cindy, Something good has happened. Turning &quot;Print in background&quot; to off has solved my printing problem and now it is printing all the rows in exact order without missing any of the rows data from the table in source document. You did mention that the code can still be optimized though, so I would like to hear from you on this soon. By the way, please ignore that &quot;counter = counter + 1&quot; which I added at one point just to check something. Other than that, each and every line was intended to get the desired output. Thank you very much for your tip."}, {"owner": {"reputation": 89, "user_id": 6362653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2797c883be869241a7681c0084f0feae?s=128&d=identicon&r=PG&f=1", "display_name": "SmIqbal", "link": "https://stackoverflow.com/users/6362653/smiqbal"}, "edited": false, "score": 0, "creation_date": 1533835768, "post_id": 51742806, "comment_id": 90504451, "body": "I would also like to thank Macropod for taking his time and adding a useful tip."}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 6362653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2797c883be869241a7681c0084f0feae?s=128&d=identicon&r=PG&f=1", "display_name": "SmIqbal", "link": "https://stackoverflow.com/users/6362653/smiqbal"}, "edited": false, "score": 0, "creation_date": 1533834565, "post_id": 51771863, "comment_id": 90503848, "body": "Thank you so much Cindy. I am gonna give it a try and I am sure the changes you have made will make it more efficient code for my purposes. You have also shared some worthwhile techniques which I am sure if taken into consideration right at the beginning of writing such procedures, will help a great deal."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 1, "last_activity_date": 1533831734, "creation_date": 1533831734, "answer_id": 51771863, "question_id": 51742806, "link": "https://stackoverflow.com/questions/51742806/activedocument-printout-issue/51771863#51771863", "title": "ActiveDocument.Printout issue", "body": "<p>When printing out documents in relatively quick succession, things can get \"mixed up\" if background printing is turned on. This is an option in Word:</p>\n\n<pre><code>File/Options/Advanced, section \"Print\"\n</code></pre>\n\n<p>In the object model, to turn it off programmatically you can use the following. If the user likes having it turned on, save the current setting, turn it off, then restore the setting at the end of the code:</p>\n\n<pre><code>Options.PrintBackground = False\n</code></pre>\n\n<p>Since speed of execution is a concern, your code can be optimized. The following suggestions can also help to make it more self-documenting. Note that I'm not testing, just writing from the top of my head, so I may make a typo or two...</p>\n\n<ol>\n<li><p>Put <code>Option Explicit</code> at the top of your code modules. This will save you from frustrating error messages if you mistype a variable name.</p></li>\n<li><p>Use declared objects throughout. Referring back to <code>ActiveDocument</code> each time is less efficient (VBA has to figure out which it is, every time. Also, the active document <em>could</em> change during code execution, which would mess things up.) Ditto for repeatedly requesting <code>Tables(3)</code>.</p></li>\n<li><p>If your concern when looping a collection is to ensure a certain member is present (a particular document, in your case) you can use <code>Exit For</code> to break off the loop before all members have been queried. </p></li>\n<li><p>It's not necessary to activate a document in order to work with it in code. Once you have <code>Document</code> objects, that's all you need.</p></li>\n<li><p>It's also not necessary to fiddle with the Views in order to work with a header or footer. I've deleted those lines.</p></li>\n</ol>\n\n<p>I hope I've kept \"everything straight\"!</p>\n\n<pre><code>  Option Explicit\n\n  Sub PrintMyHeaders()\n    Dim r As Range\n    Dim sourceDoc, jobNumber, AnnexureRaw, Annexure, ReportHeader As String\n    Dim numPages As Integer\n    Dim sourceTable as Word.Table, doc as Word.Document\n    Dim tDoc as Word.Document\n\n    Application.ScreenUpdating = False\n\n    jobNumber = InputBox(\"Enter job number\")\n\n    Set sourceDoc = ActiveDocument\n    Set sourceTable = sourceDoc.Tables(3)\n    sourceTable.Range.ListFormat.RemoveNumbers\n    Set r = sourceTable.Range\n\n    For Each doc In Documents\n        If doc.Name = \"Template.doc\" Then \n          Found = True\n          Exit For\n        End If\n    Next doc\n\n    If Found &lt;&gt; True Then\n        Set tDoc = Documents.Open(FileName:=\"C:\\Users\\smi\\Documents\\Template.doc\")\n    Else\n        Set tDoc = Documents(\"Template.doc\")\n    End If\n\n    For i = 6 To r.Rows.Count\n\n        AnnexureRaw = Replace(r.Rows(i).Cells(2).Range.Text, \"\", \"\")\n        Annexure = Replace(AnnexureRaw, Chr(13), \"\")\n\n        numPages = Val(r.Rows(i).Cells(3).Range.Text)\n\n            For xPages = 1 To numPages\n                 counter = counter + 1\n                 ReportHeader = \"PAGE \" &amp; xPages &amp; \" OF \" &amp; numPages &amp; vbCrLf _\n                 &amp; \"OUR REF: TKU-\" &amp; jobNumber &amp; \"/2018\" &amp; vbCrLf _\n                 &amp; \"ANNEXURE : \" &amp; Chr(34) &amp; Annexure &amp; Chr(34)\n\n                 Dim rngHeader as Word.Range\n                 Set rngHeader = tDoc.Sections(1).Headers(wdHeaderFooterPrimary).Range\n                rngHeader.Font.Name = \"Arial\"\n                rngHeader.Font.Size = 8\n                rngHeader.Font.Bold = True\n                rngHeader.Text = ReportHeader\n                rngHeader.ParagraphFormat.LineSpacingRule = wdLineSpaceExactly\n                rngHeader.ParagraphFormat.LineSpacing = 6\n                rngHeader.ParagraphFormat.Alignment = wdAlignParagraphRight\n\n                tDoc.PrintOut\n                'Debug.Print ReportHeader &amp; vbCrLf\n            Next xPages\n    Next\n\n    tDoc.Close SaveChanges:=wdDoNotSaveChanges\n\n    Application.ScreenUpdating = True\n\n  End Sub\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 6362653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2797c883be869241a7681c0084f0feae?s=128&d=identicon&r=PG&f=1", "display_name": "SmIqbal", "link": "https://stackoverflow.com/users/6362653/smiqbal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 668, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533831734, "creation_date": 1533719487, "last_edit_date": 1533748981, "question_id": 51742806, "link": "https://stackoverflow.com/questions/51742806/activedocument-printout-issue", "title": "ActiveDocument.Printout issue", "body": "<p>I have two word documents, source and target. My target document is pulling values from a table inside source document and putting those concatenated values stored inside a variable named <strong>ReportHeader</strong> into it's page header. I have used two For-Next loops, the outer loops takes care of designated rows inside source document and this loop begins at 6th row till count of total rows inside that table.</p>\n\n<p>My inner loop named \"For xPages = 1 To numPages\" takes care of number of parges required for each Annexure that it finds inside the table and loops through found number of pages for a particular Annexure reference.</p>\n\n<p>Below is reference screenshot of my table. Please ignore the fact the few preceding lines of my tableare not being shown here. My business begins with 6th row that shows Annexure A.</p>\n\n<p><a href=\"https://i.stack.imgur.com/4v3iz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4v3iz.png\" alt=\"enter image description here\"></a></p>\n\n<p>Everything works fine as long as I test values in Debug.print or Msgbox but when I sent these values for printing using <strong>ActiveDocument.PrintOut</strong>, I notice an abnormal printing behaviour. First few rows starting at row 6 of table are ignored and later not all the pages are sent to printing.</p>\n\n<p>Any feedback from you guys would be much appreciated.</p>\n\n<p>Thanks\nSyed</p>\n\n<pre><code>        Sub PrintMyHeaders()\n        Dim r As Range\n        Dim sourceDoc, jobNumber, AnnexureRaw, Annexure, ReportHeader As String\n        Dim numPages As Integer\n        Application.ScreenUpdating = False\n\n        jobNumber = InputBox(\"Enter job number\")\n\n        sourceDoc = ActiveDocument.Name\n\n        ActiveDocument.Tables(3).Range.ListFormat.RemoveNumbers\n        Set r = ActiveDocument.Tables(3).Range\n\n        For Each doc In Documents\n            If doc.Name = \"Template.doc\" Then Found = True\n\n            Next doc\n\n            If Found &lt;&gt; True Then\n                Documents.Open FileName:=\"C:\\Users\\smi\\Documents\\Template.doc\"\n            Else\n                Documents(\"Template.doc\").Activate\n            End If\n\n        Documents(sourceDoc).Activate\n\n        For i = 6 To r.Rows.Count\n\n            AnnexureRaw = Replace(r.Rows(i).Cells(2).Range.Text, \"\", \"\")\n            Annexure = Replace(AnnexureRaw, Chr(13), \"\")\n\n            numPages = Val(r.Rows(i).Cells(3).Range.Text)\n\n\n                For xPages = 1 To numPages\n                     counter = counter + 1\n                     ReportHeader = \"PAGE \" &amp; xPages &amp; \" OF \" &amp; numPages &amp; vbCrLf _\n                     &amp; \"OUR REF: TKU-\" &amp; jobNumber &amp; \"/2018\" &amp; vbCrLf _\n                     &amp; \"ANNEXURE : \" &amp; Chr(34) &amp; Annexure &amp; Chr(34)\n\n\n                     Documents(\"Template.doc\").Activate\n\n\n                     If ActiveWindow.View.SplitSpecial &lt;&gt; wdPaneNone Then\n                         ActiveWindow.Panes(2).Close\n                     End If\n\n                If ActiveWindow.ActivePane.View.Type = wdNormalView Or ActiveWindow. _\n                    ActivePane.View.Type = wdOutlineView Then\n                    ActiveWindow.ActivePane.View.Type = wdPrintView\n                End If\n\n                    ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader\n\n                    Selection.Font.Name = \"Arial\"\n                    Selection.Font.Size = 8\n                    Selection.Font.Bold = True\n                    Selection.Text = ReportHeader\n                    Selection.ParagraphFormat.LineSpacingRule = wdLineSpaceExactly\n                    Selection.ParagraphFormat.LineSpacing = 6\n                    Selection.ParagraphFormat.Alignment = wdAlignParagraphRight\n\n\n                    ActiveDocument.PrintOut\n                    'Debug.Print ReportHeader &amp; vbCrLf\n\n                    Documents(sourceDoc).Activate\n\n                Next xPages\n\n        Next\n\n        Documents(\"template.doc\").Activate\n        ActiveDocument.Close SaveChanges:=wdDoNotSaveChanges\n        Documents(sourceDoc).Activate\n\n        Application.ScreenUpdating = True\n\n        End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "password-protection", "worksheet"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 9156829, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-V4tRzglGhJw/AAAAAAAAAAI/AAAAAAAAABY/qVVmXNVTkIg/photo.jpg?sz=128", "display_name": "I Forte Si Daja", "link": "https://stackoverflow.com/users/9156829/i-forte-si-daja"}, "edited": false, "score": 0, "creation_date": 1533798524, "post_id": 51743598, "comment_id": 90480586, "body": "Yup... That was what I was looking for. Thank you verey much."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1533721725, "creation_date": 1533721725, "answer_id": 51743598, "question_id": 51742796, "link": "https://stackoverflow.com/questions/51742796/vba-code-to-use-the-password-from-another-sub-in-excel/51743598#51743598", "title": "VBA Code To Use The Password From Another Sub in Excel", "body": "<p>You would need to declare the variable as <code>Public</code>.</p>\n\n<pre><code>Public pwd1 As String\n\nSub ProtectAllSheets()\n    'NO dim for pwd1 here\n    pwd1 = InputBox(\"Enter your password\", \"\")\n    'your code here\nEnd Sub\n</code></pre>\n\n<p>So it is available in all your procedures and functions.</p>\n\n<hr>\n\n<p><strong>But I recommend to use <code>.Protect UserInterFaceOnly:=True</code></strong><br>\n which protects the worksheet from user editing but lets VBA edit it without restrictions.</p>\n\n<p>Therefore you just need to protect your sheets in the <code>Workbook_Open()</code> event like this:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Sheets(\"Sheet1\").Protect Password:=\"Secret\", UserInterFaceOnly:=True\n    Sheets(\"Sheet2\").Protect Password:=\"Secret\", UserInterFaceOnly:=True\n    'Repeat with the name and password of additional sheets to be manipulated by VBA.\nEnd Sub \n</code></pre>\n\n<p>This way you don't need to protect/unprotect for every VBA action.</p>\n\n<p>For a full how-to and more information see: <a href=\"http://www.criticaltosuccess.com/speedup-excel-vba-macros-protect-userinterfaceonly/\" rel=\"nofollow noreferrer\">Speedup Excel VBA Macros with Protect UserInterFaceOnly</a>.</p>\n"}], "owner": {"reputation": 35, "user_id": 9156829, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-V4tRzglGhJw/AAAAAAAAAAI/AAAAAAAAABY/qVVmXNVTkIg/photo.jpg?sz=128", "display_name": "I Forte Si Daja", "link": "https://stackoverflow.com/users/9156829/i-forte-si-daja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 51743598, "answer_count": 1, "score": 3, "last_activity_date": 1533721725, "creation_date": 1533719454, "last_edit_date": 1533720107, "question_id": 51742796, "link": "https://stackoverflow.com/questions/51742796/vba-code-to-use-the-password-from-another-sub-in-excel", "title": "VBA Code To Use The Password From Another Sub in Excel", "body": "<p>I have two codes, one that protects all sheets which uses the password from an input box, and the second one that deletes <code>#REF!</code> errors. On the second code I need to unprotect the sheet first in order to delete a row. Now, I am trying to figure out how can I use the pasword from the first code to unprotect the sheet so that the second code can delete the <code>#REF!</code> error rows? </p>\n\n<p>Not sure if is even possible, but maybe someone has had the same problem before.</p>\n\n<p>Any help is appreciated.</p>\n\n<pre><code>Sub ProtectAllSheets()\n    Dim pwd1 As String, pwd2 As String\n    pwd1 = InputBox(\"Enter your password\", \"\")\n    If pwd1 = \"\" Then Exit Sub\n    pwd2 = InputBox(\"Enter the password again\", \"\")\n\n    If pwd2 = \"\" Then Exit Sub\n\n     'Checks if both the passwords are identical\n    If InStr(1, pwd2, pwd1, 0) = 0 Or _\n       InStr(1, pwd1, pwd2, 0) = 0 Then\n        MsgBox \"Please type the same password. \", vbInformation, \"\"\n        Exit Sub\n    End If\n\n    For Each ws In ActiveWorkbook.Sheets\n        If ws.ProtectContents = False = True Then\n            ws.Protect Contents:=True, Scenarios:= _\n                True, AllowFormattingCells:=True, AllowDeletingRows:=True, Password:=pwd1\n        End If\n\n    Next ws\n\n    MsgBox \"Sheets are protected.\"\nEnd Sub\n\n\n\nSub DeleteRows() ' Cells which contain an Error Formula\n    ActiveSheet.Unprotect pwd1\n\n    Dim c As Long\n    For c = 400 To 2 Step -1\n        If IsError(Cells(c, 3)) Then\n            Rows(c).EntireRow.Delete\n        End If\n    Next c\n    ws.Protect Contents:=True, Scenarios:= _\n        True, AllowFormattingCells:=True, AllowDeletingRows:=True, Password:=pwd1\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "asynchronous", "notifications"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1533719673, "post_id": 51742594, "comment_id": 90445700, "body": "You may be interested in <a href=\"https://stackoverflow.com/questions/39224308/non-blocking-toast-like-notifications-for-microsoft-access-vba\" title=\"non blocking toast like notifications for microsoft access vba\">stackoverflow.com/questions/39224308/&hellip;</a>"}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1533719763, "post_id": 51742594, "comment_id": 90445748, "body": "Just to make you aware: The verb that corresponds to the noun <i>notification</i> is <i>to notify</i>. (The word you chose will likely be understood just as well, it just sounds a little funny.)"}, {"owner": {"reputation": 1, "user_id": 7948150, "user_type": "registered", "profile_image": "https://graph.facebook.com/790189647806095/picture?type=large", "display_name": "Tobias Sessler", "link": "https://stackoverflow.com/users/7948150/tobias-sessler"}, "reply_to_user": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1533719875, "post_id": 51742594, "comment_id": 90445826, "body": "@inarion ohh ^^ thanks for that. Yeah i&#39;m sorry if there are some errors. I&#39;m from germany"}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1533720203, "post_id": 51742594, "comment_id": 90446065, "body": "No need to feel sorry. We all make mistakes. And improvements mostly come from practicing. So keep doing that. :)"}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1533720969, "post_id": 51742594, "comment_id": 90446588, "body": "And regarding your actual question: I highly recommend checking out the link @Andre posted above. Trying to achieve it in native VBA would involve a lot of messy <code>Application.Run</code> calls, I guess."}, {"owner": {"reputation": 1, "user_id": 7948150, "user_type": "registered", "profile_image": "https://graph.facebook.com/790189647806095/picture?type=large", "display_name": "Tobias Sessler", "link": "https://stackoverflow.com/users/7948150/tobias-sessler"}, "edited": false, "score": 0, "creation_date": 1533722866, "post_id": 51742594, "comment_id": 90447810, "body": "I did, but it did&#39;t really help. So I&#39;ve tried a few things and have finally done it ^ ^ I&#39;ll comment the solution right back to the question"}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1533730963, "post_id": 51742594, "comment_id": 90452919, "body": "I realized after having a look at the repository that linked question points to that there is no source code available... As such I can&#39;t really recommend it anymore."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7948150, "user_type": "registered", "profile_image": "https://graph.facebook.com/790189647806095/picture?type=large", "display_name": "Tobias Sessler", "link": "https://stackoverflow.com/users/7948150/tobias-sessler"}, "is_accepted": false, "score": 0, "last_activity_date": 1533723172, "creation_date": 1533723172, "answer_id": 51744095, "question_id": 51742594, "link": "https://stackoverflow.com/questions/51742594/asynchronous-notification-in-vba/51744095#51744095", "title": "asynchronous notification in VBA", "body": "<p>Well, I've tried it a bit and finally got it done. Meanwhile, my subroutine looks like this:</p>\n\n<pre><code>    Private Sub notificate(msg As String, Optional title As String)\n        ofEvent = False\n\n        lbl_notification.Caption = msg\n        If Not IsEmpty(title) Then\n            frm_notification.Caption = title\n        Else\n            frm_notification.Caption = \"\"\n        End If\n\n        frm_notification.Visible = True\n        frm_notification.Transparency = 0.5\n\n        For i = 1 To 1000000\n            DoEvents\n            If ofEvent Then\n                GoTo GoOn\n            End If\n        Next i\n\n    GoOn:\n\n        frm_notification.Visible = False\n\n        frm_notification.Caption = \"\"\n        lbl_notification.Caption = \"\"\n    End Sub\n</code></pre>\n\n<p>And as you can already imagine, the following is in my frame in the click function</p>\n\n<pre><code>    ofEvent = True\n</code></pre>\n\n<p>And ofEvent is a global boolean Variable</p>\n"}], "owner": {"reputation": 1, "user_id": 7948150, "user_type": "registered", "profile_image": "https://graph.facebook.com/790189647806095/picture?type=large", "display_name": "Tobias Sessler", "link": "https://stackoverflow.com/users/7948150/tobias-sessler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1617809065, "creation_date": 1533718806, "last_edit_date": 1617809065, "question_id": 51742594, "link": "https://stackoverflow.com/questions/51742594/asynchronous-notification-in-vba", "title": "asynchronous notification in VBA", "body": "<p>I'm currently trying to write a script that requires a notification bar in the form. The script itself is responsible for creating invoices, which works so well. However, I want to display errors and information in a label. The label is already in a frame and I have the following code as well:</p>\n<pre><code>    Private Function notificate(msg As String, Optional title As String)\n        lbl_notification.Caption = msg\n\n        If Not IsEmpty(title) Then\n            frm_notification.Caption = title\n        Else\n            frm_notification.Caption = &quot;&quot;\n        End If\n\n        frm_notification.Visible = True\n\n        Application.Wait (Now + TimeValue(&quot;0:00:10&quot;))\n\n        frm_notification.Visible = False\n\n        frm_notification.Caption = &quot;&quot;\n        lbl_notification.Caption = &quot;&quot;\n        notificate = True\n    End Function\n</code></pre>\n<p>(I am not sure if it should be a subroutine or a function.)</p>\n<p>How do I get this function to work so that I can use my form at the same time, if that is possible?</p>\n"}, {"tags": ["excel", "vba", "validation"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1533718281, "post_id": 51742277, "comment_id": 90444802, "body": "Which error do you get, on which line?  Also, &quot;not working&quot; is very vague, please provide more details about what you have, what you need to have in the end, what you&#39;ve tried and what&#39;s happening."}, {"owner": {"reputation": 79, "user_id": 9250452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/899a38d8576c158d90a80750a2cdb848?s=128&d=identicon&r=PG&f=1", "display_name": "tomek198823", "link": "https://stackoverflow.com/users/9250452/tomek198823"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1533718358, "post_id": 51742277, "comment_id": 90444860, "body": "in the third line - one with the validation.add"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 2, "creation_date": 1533718493, "post_id": 51742277, "comment_id": 90444959, "body": "Thanks - please <a href=\"https://stackoverflow.com/posts/51742277/edit\">edit</a> your question to clarify that, as well as my other questions about your question.  Also, see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; as well as <b>how to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a></b>. More tips <a href=\"https://codeblog.jonskeet.uk/writing-the-perfect-question/\" rel=\"nofollow noreferrer\"><b>here</b></a> from the site&#39;s top user."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1533719911, "post_id": 51742277, "comment_id": 90445855, "body": "<i>kolumna_litera - stands for function returning collumn letter (String)</i>.  Also, you have <code>ISBLANK($&quot; &amp; _         kolumna_litera(kol_Data_oceny_formalnej) _         &amp; &quot;3)</code> , so you concatenate <code>kolumna_litera</code> with a 3 always. <code>IsBlank</code> needs a reference to a range, not just a number. When <code>kolumna_litera</code> is empty, <code>IsBlank</code> try to checks a range <code>3</code> and that maybe could be causing your error with the function. Maybe you should consider checking first if <code>kolumna_litera</code> is empty before trying to add the data validation?"}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1533725088, "post_id": 51742277, "comment_id": 90449082, "body": "Shouldin&#39;t it be .IgnoreBlank = False ?"}, {"owner": {"reputation": 79, "user_id": 9250452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/899a38d8576c158d90a80750a2cdb848?s=128&d=identicon&r=PG&f=1", "display_name": "tomek198823", "link": "https://stackoverflow.com/users/9250452/tomek198823"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1533797415, "post_id": 51742277, "comment_id": 90480045, "body": "@Foxfire And Burns And Burns by checking the validation first You mean add some extra formula? Can You give me a hint how to make this?"}, {"owner": {"reputation": 79, "user_id": 9250452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/899a38d8576c158d90a80750a2cdb848?s=128&d=identicon&r=PG&f=1", "display_name": "tomek198823", "link": "https://stackoverflow.com/users/9250452/tomek198823"}, "edited": false, "score": 0, "creation_date": 1533798072, "post_id": 51742277, "comment_id": 90480372, "body": "one more thing, I just tried to add data validation to cell, I&#39;ve typed something like this: <code>=JE\u017bELI(CZY.PUSTA($AE3);FA\u0141SZ;status_status_RK)</code> in english it wil be <code>=IF(ISBLANK($AE3),FALSE,status_status_RK)</code>  I get the message: List must be a delimited list, or a reference to a single row or column. List is a named range in one column"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1533805348, "post_id": 51742277, "comment_id": 90484514, "body": "Something like <code>If kolumna_litera &lt;&gt; &quot;&quot; Then.... &#39;all the validation part</code>. It&#39;s just an idea, but you should test it. Also, think about a solution when <code>kolumna_litera = &quot;&quot;</code> and apply it to your code."}], "answers": [{"tags": [], "owner": {"reputation": 79, "user_id": 9250452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/899a38d8576c158d90a80750a2cdb848?s=128&d=identicon&r=PG&f=1", "display_name": "tomek198823", "link": "https://stackoverflow.com/users/9250452/tomek198823"}, "is_accepted": false, "score": 0, "last_activity_date": 1533818688, "creation_date": 1533818688, "answer_id": 51767428, "question_id": 51742277, "link": "https://stackoverflow.com/questions/51742277/excel-data-validation-isblank-not-working/51767428#51767428", "title": "EXCEL Data Validation ISBLANK not working", "body": "<p>I think I Found the solution. The problem was with the <code>FALSE</code> statement in the formula. When cell <code>kolumna_litera(kol_Data_oceny_formalnej) &amp; \"3</code>was empty Excel could not find the list with data - and could not use the <code>FALSE</code> statement. So I added a named range containing one empty cell and replaced this with the name of this range (called PUSTA). The code looks like that now:</p>\n\n<pre><code>    With zakres.Validation\n    .Delete\n    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:=\"=IF(ISBLANK($\" &amp; kolumna_litera(kol_Data_wp\u0142ywu_RK) &amp; \"3),PUSTA,status_status_RK)\"\n    .IgnoreBlank = False\n    .InCellDropdown = True\n    .InputTitle = \"\"\n    .ErrorTitle = \"Nieprawid\u0142owy status!\"\n    .InputMessage = \"\"\n    .ErrorMessage = \"Wybierz poprawny status z listy rozwijanej! Lista ze statusami pojawi si\u0119 je\u015bli wpisana zosta\u0142a data z wp\u0142ywem RK.\"\n    .ShowInput = True\n    .ShowError = True\n    End With\n</code></pre>\n\n<p>So far It works, hope that this was the problem.</p>\n"}], "owner": {"reputation": 79, "user_id": 9250452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/899a38d8576c158d90a80750a2cdb848?s=128&d=identicon&r=PG&f=1", "display_name": "tomek198823", "link": "https://stackoverflow.com/users/9250452/tomek198823"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1559244271, "creation_date": 1533717755, "last_edit_date": 1559244271, "question_id": 51742277, "link": "https://stackoverflow.com/questions/51742277/excel-data-validation-isblank-not-working", "title": "EXCEL Data Validation ISBLANK not working", "body": "<p>I have a problem with data validation in EXCEL. I try to add this validation to the range of cells:</p>\n\n<pre><code>   With zakres.Validation\n    .Delete\n    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n        xlBetween, Formula1:=\"=IF(ISBLANK($\" &amp; _\n        kolumna_litera(kol_Data_oceny_formalnej) _\n        &amp; \"3),FALSE,status_status_RK)\"\n    .IgnoreBlank = True\n    .InCellDropdown = True\n    .InputTitle = \"\"\n    .ErrorTitle = \"Nieprawid\u0142owy status!\"\n    .InputMessage = \"\"\n    .ErrorMessage = \"Wybierz poprawny status z listy rozwijanej!\"\n    .ShowInput = True\n    .ShowError = True\nEnd With\n</code></pre>\n\n<p>kolumna_litera - stands for function returning column letter (String); kol_Data_oceny_formalnej - stands for number of column (Long); status_status_RK - stands for named range with list of values;</p>\n\n<p>The problem is when cell kolumna_litera&amp;3 is empty. Then error 1004 occurs - in the line Validation.Add. When this cell is filled, there is no error. I have no idea why this happens. Can anybody explain this to me?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 9794278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75307b631d52469db6e239ca5b12f9f?s=128&d=identicon&r=PG&f=1", "display_name": "nie", "link": "https://stackoverflow.com/users/9794278/nie"}, "edited": false, "score": 0, "creation_date": 1533718201, "post_id": 51742315, "comment_id": 90444750, "body": "could you please help me to know, which .dll is help me to print the file?"}, {"owner": {"reputation": 685, "user_id": 6187845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc90c985e2d7b81ba79c02313aeeefd?s=128&d=identicon&r=PG&f=1", "display_name": "nagarajannd", "link": "https://stackoverflow.com/users/6187845/nagarajannd"}, "reply_to_user": {"reputation": 7, "user_id": 9794278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75307b631d52469db6e239ca5b12f9f?s=128&d=identicon&r=PG&f=1", "display_name": "nie", "link": "https://stackoverflow.com/users/9794278/nie"}, "edited": false, "score": 0, "creation_date": 1533723389, "post_id": 51742315, "comment_id": 90448103, "body": "where did you receive the error. what was the input?"}], "tags": [], "owner": {"reputation": 685, "user_id": 6187845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc90c985e2d7b81ba79c02313aeeefd?s=128&d=identicon&r=PG&f=1", "display_name": "nagarajannd", "link": "https://stackoverflow.com/users/6187845/nagarajannd"}, "is_accepted": false, "score": 0, "last_activity_date": 1533717926, "creation_date": 1533717926, "answer_id": 51742315, "question_id": 51742128, "link": "https://stackoverflow.com/questions/51742128/how-to-print-pdf-file-with-excel-macro/51742315#51742315", "title": "How to print pdf file with excel macro", "body": "<p>Try below code to move file and call it in your code after printing.</p>\n\n<pre><code>i = FindWindow(\"XLMAIN\", Application.Caption)\nShellExecute i, \"print\", lstFile, vbNullString, vbNullString, 10\nMoveFile lstFile\nlstFile = VBA.Dir\n</code></pre>\n\n<p>replace <code>Destination Folder\\</code> with actual path where you need to move the files.</p>\n\n<pre><code>Private Function MoveFile(strSource As String)\n    Dim fso As Object\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    fso.MoveFile source:=strSource, Destination:=\"Destination Folder\\\" &amp; Right(strSource, Len(strSource) - InStrRev(strSource, \"\\\"))\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 9794278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75307b631d52469db6e239ca5b12f9f?s=128&d=identicon&r=PG&f=1", "display_name": "nie", "link": "https://stackoverflow.com/users/9794278/nie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1984, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1533718030, "creation_date": 1533717177, "last_edit_date": 1533718030, "question_id": 51742128, "link": "https://stackoverflow.com/questions/51742128/how-to-print-pdf-file-with-excel-macro", "title": "How to print pdf file with excel macro", "body": "<p>Hi all i need to print pdf files from one folder after printing the file i need move that file into another folder. My system is x86 bit so someone please help me on this issue</p>\n\n<pre><code>Option Explicit\n\nPrivate Declare Function FindWindow Lib \"user32\" Alias \"FindWindowA\" _\n    (ByVal lpClassName As String, ByVal lpWindowName As String) As Long\n\nPrivate Declare Function ShellExecute Lib \"shell32.dll\" Alias \"ShellExecuteA\" _\n    (ByVal hwnd As Long, ByVal lpOperation As String, ByVal lpFile As String _\n    , ByVal lpParameters As String, ByVal lpDirectory As String, ByVal nShowCmd As Long) As Long\n\nSub Auto_print()\n\nDim lstFile As String\nDim lstDir As String\nDim i As Long\n\nlstDir = \"C:\" &amp; VBA.Environ(\"homepath\") &amp; \"\\Desktop\\auto\\\"\nlstFile = VBA.Dir(lstDir &amp; \"*.pdf\")\n\nDo While VBA.Len(lstFile) &gt; 0\n    i = FindWindow(\"XLMAIN\", Application.Caption)\n   ShellExecute i, \"print\", lstFile, vbNullString, vbNullString, 10\n    lstFile = VBA.Dir\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "recordset"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1533751098, "post_id": 51742091, "comment_id": 90465633, "body": "Why are users selecting queries? Should be presented with a list of reports and/or select filter criteria on a &#39;search&#39; form and VBA builds filter criteria. Review <a href=\"http://allenbrowne.com/ser-62.html\" rel=\"nofollow noreferrer\">allenbrowne.com/ser-62.html</a>"}, {"owner": {"reputation": 1, "user_id": 9303319, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153933349580493/picture?type=large", "display_name": "Don Oldenburg", "link": "https://stackoverflow.com/users/9303319/don-oldenburg"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1533849964, "post_id": 51742091, "comment_id": 90510476, "body": "No, I have a form where the admin (me) can build a sql statement in a long text field.     LIke San Diego customers, I can write the sql on the fly for a specific list need...   by customer...    by sales volumne, but missed connection last visit to city, etc...    I can save all my sql statements for mailing lists/text blasts/email blasts by each query --  which can change depending on needs for the mailing.   Just easier to build them on a form than having to edit sql all the time in the back end."}], "answers": [{"tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 0, "last_activity_date": 1533756390, "creation_date": 1533756390, "answer_id": 51754275, "question_id": 51742091, "link": "https://stackoverflow.com/questions/51742091/implementing-access-form-with-dynamic-recordset/51754275#51754275", "title": "Implementing access form with dynamic recordset", "body": "<p>All you need to count the number of results is:</p>\n\n<pre><code>SELECT COUNT(*) FROM ( [My Query SQL] )\n</code></pre>\n\n<p>The other part depends on how consistent your queries are. If they all have the same fields, like <code>[CustomerName]</code> use something like:</p>\n\n<pre><code>SELECT [CustomerName] FROM ( [My Query SQL] ) ORDER BY [CustomerName]\n</code></pre>\n\n<p>As for how to display the results it depends on the why you need them They can be added to simple MsgBox (you will need some VBA to convert the above query results to string) or to popup form or a sub-form.</p>\n\n<p>To get the results into VBA:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/1115058/how-do-i-get-the-data-from-an-sql-query-in-microsoft-access-vba\">How do I get the data from an SQL query in microsoft Access VBA?</a></p>\n"}], "owner": {"reputation": 1, "user_id": 9303319, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153933349580493/picture?type=large", "display_name": "Don Oldenburg", "link": "https://stackoverflow.com/users/9303319/don-oldenburg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 186, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533756390, "creation_date": 1533717053, "last_edit_date": 1533719047, "question_id": 51742091, "link": "https://stackoverflow.com/questions/51742091/implementing-access-form-with-dynamic-recordset", "title": "Implementing access form with dynamic recordset", "body": "<p>I have just implemented a messaging center in our contact management application (access).  This includes text and email template management, and dynamic email/txt groups by sql queries maintain in a table.   This all works great, and I can select a message template, and a SQLquery stored in a table and it sends either text or email messages to my contacts.  PERFECT.</p>\n\n<p>NOW, on the form where I manage my SQL queries to be selected from a combo box when sending the message...    I've been asked to do one or both enhancements.   One, after the sql statement is entered in the form...  the ability to count the number of records that query will return.   And two the ability to pull up a list of the customers in the query.</p>\n\n<p>I believe I open a new form from a button and pass the ID of the record of the query to a new form.   Do a simple dlookup and retrieve the sql statement from the table.   Then I am assuming I can point my record set to the fieldvariable holding the value of the sql statment?</p>\n\n<p>My confusion is I am unsure of the vba necessary to accomplish this, or which even this needs to be placed in.  Further...  will the fields defined in the sql query show up in \"add existing fields\" to a form?   Or how does it know what fields I am able to place on my form?</p>\n"}, {"tags": ["excel", "vba", "date", "email", "text"], "comments": [{"owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "edited": false, "score": 0, "creation_date": 1533717515, "post_id": 51741846, "comment_id": 90444298, "body": "thank you. just corrected. And i got already a negative vote. No idea why"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1533718092, "post_id": 51741846, "comment_id": 90444672, "body": "This site is very picky about formatting and clarity when posting questions. Stack Overflow gets a new question posted about every 13 seconds and not every one can be answered; people like to see that effort was made both into trying to solve the problem yourself, and into making the question as clear as possible. (see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; as well as <b>how to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a></b> plus <a href=\"//codeblog.jonskeet.uk/writing-the-perfect-question/\" rel=\"nofollow noreferrer\">these tips</a> from the site&#39;s top user.)   That said, it would be nice if people could leave a comment when they down-vote - I know that&#39;s frustrating but it happens."}, {"owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1533718655, "post_id": 51741846, "comment_id": 90445046, "body": "I  have really put effort into the question. And i dont knnow how it could be formulated any better? A pre-check of the questions before they go live would be a nice feature"}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "edited": false, "score": 0, "creation_date": 1533718276, "post_id": 51742218, "comment_id": 90444798, "body": "cheers, the right code is:                                                                                 strText = &quot;&lt;span style=&#39;font-size:10.0pt;font-family:&quot;&quot;Arial&quot;&quot;,&quot;&quot;sans-serif&quot;&quot;&zwnj;&#8203;;&quot; &amp; _     &quot;color:black&#39;&gt;Hello,&lt;br&gt;&lt;br&gt;please find attached the Report for &quot; &amp; Format(datDatum, &quot;YYYYMMDD&quot;) &amp; &quot;.&lt;br&gt;&lt;br&gt;&quot;"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 1, "last_activity_date": 1533717546, "creation_date": 1533717546, "answer_id": 51742218, "question_id": 51741846, "link": "https://stackoverflow.com/questions/51741846/incooperation-of-a-changing-date-into-an-e-mail-text-via-vba/51742218#51742218", "title": "Incooperation of a changing date into an e-mail text via VBA", "body": "<p>Assuming <code>datDate</code> is correctly holding the date in question, you could use:</p>\n\n<pre><code>strText = \"&lt;span style='font-size:10.0pt;font-family:\"\"Arial\"\",\"\"sans-serif\"\";\" &amp; _\n    \"color:black'&gt;Hello,&lt;br&gt;&lt;br&gt;please find attached the Report \" &amp; _\n    \"via ***\" &amp; Format(datDate, \"MMMM yyyy\") &amp; \"***.&lt;br&gt;&lt;br&gt;\"\n</code></pre>\n\n<p>Also, I know you didn't ask for grammar advice but I figured I'd point out that <a href=\"https://dictionary.cambridge.org/dictionary/english/via\" rel=\"nofollow noreferrer\"><em>\"via\"</em></a> is not the correct word in this case. (<em>\"Via\"</em> would be used to name a location that an item travelled through on the way to it's destination.)    </p>\n\n<p><em><code>for</code></em> is the word I would use.  :)</p>\n"}], "owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 51742218, "answer_count": 1, "score": 0, "last_activity_date": 1533717546, "creation_date": 1533716343, "last_edit_date": 1533717440, "question_id": 51741846, "link": "https://stackoverflow.com/questions/51741846/incooperation-of-a-changing-date-into-an-e-mail-text-via-vba", "title": "Incooperation of a changing date into an e-mail text via VBA", "body": "<p>I have got text attached to an email.  My aim is to incorporate the date, which states in a worksheet in the range <code>E2</code> into the text (e.g. as illustrated below <code>Juni 2018</code>).</p>\n\n<pre><code>datDate=WorksheetFunction.Max(Sheets(\"Description\").Range(\"E2\"))\n\nstrText=\"&lt;span style='font-size:10.0pt;font-family:\"\"Arial\"\",\"\"sans-serif\"\";\" &amp; _\n    \"color:black'&gt;Hello,&lt;br&gt;&lt;br&gt;please find attached the Report \" &amp; _\n    \"for ***Juni 2018***.&lt;br&gt;&lt;br&gt;\"\n</code></pre>\n"}, {"tags": ["excel", "vba", "validation", "if-statement", "drop-down-menu"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 9800458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bcbbcc57f417e771775d773cb0887c0?s=128&d=identicon&r=PG&f=1", "display_name": "mrpls ", "link": "https://stackoverflow.com/users/9800458/mrpls"}, "edited": false, "score": 0, "creation_date": 1533719727, "post_id": 51742448, "comment_id": 90445729, "body": "Hi Shazu, thank you for replying me, but unfortunately it is not what I need. &quot;3200&quot; was an example to say &quot;I need to insert a number there&quot;. Moreover, I don&#39;t need a formula on cells under column B, but something like Data Validation &gt; Custom &gt; Formula."}, {"owner": {"reputation": 577, "user_id": 4334973, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e2e1e1d15d538ea7559d5c14385bce1d?s=128&d=identicon&r=PG&f=1", "display_name": "Shazu", "link": "https://stackoverflow.com/users/4334973/shazu"}, "reply_to_user": {"reputation": 9, "user_id": 9800458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bcbbcc57f417e771775d773cb0887c0?s=128&d=identicon&r=PG&f=1", "display_name": "mrpls ", "link": "https://stackoverflow.com/users/9800458/mrpls"}, "edited": false, "score": 0, "creation_date": 1533720861, "post_id": 51742448, "comment_id": 90446509, "body": "Ok, thanks for the clarification. I have updated my answer accordingly. You only need to come up with a maximum possible number in B column for the case when you have a &quot;No&quot; in the A column. I have currently defined 99999 as the maximum possible number. You can obviously change it to suit your needs."}, {"owner": {"reputation": 9, "user_id": 9800458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bcbbcc57f417e771775d773cb0887c0?s=128&d=identicon&r=PG&f=1", "display_name": "mrpls ", "link": "https://stackoverflow.com/users/9800458/mrpls"}, "edited": false, "score": 0, "creation_date": 1533721398, "post_id": 51742448, "comment_id": 90446853, "body": "Great, thanks a lot. It works and I got the logic. Do you think there would be any chance to also display &quot;0&quot; when is &quot;Yes&quot;?"}, {"owner": {"reputation": 577, "user_id": 4334973, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e2e1e1d15d538ea7559d5c14385bce1d?s=128&d=identicon&r=PG&f=1", "display_name": "Shazu", "link": "https://stackoverflow.com/users/4334973/shazu"}, "reply_to_user": {"reputation": 9, "user_id": 9800458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bcbbcc57f417e771775d773cb0887c0?s=128&d=identicon&r=PG&f=1", "display_name": "mrpls ", "link": "https://stackoverflow.com/users/9800458/mrpls"}, "edited": false, "score": 0, "creation_date": 1533721738, "post_id": 51742448, "comment_id": 90447057, "body": "Do you mean automatically display 0 for all cases where the corresponding cell in column A has &quot;Yes&quot; in it?"}, {"owner": {"reputation": 9, "user_id": 9800458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bcbbcc57f417e771775d773cb0887c0?s=128&d=identicon&r=PG&f=1", "display_name": "mrpls ", "link": "https://stackoverflow.com/users/9800458/mrpls"}, "edited": false, "score": 0, "creation_date": 1533726047, "post_id": 51742448, "comment_id": 90449666, "body": "Yes, exactly. It would be really perfect in that case."}, {"owner": {"reputation": 577, "user_id": 4334973, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e2e1e1d15d538ea7559d5c14385bce1d?s=128&d=identicon&r=PG&f=1", "display_name": "Shazu", "link": "https://stackoverflow.com/users/4334973/shazu"}, "reply_to_user": {"reputation": 9, "user_id": 9800458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bcbbcc57f417e771775d773cb0887c0?s=128&d=identicon&r=PG&f=1", "display_name": "mrpls ", "link": "https://stackoverflow.com/users/9800458/mrpls"}, "edited": false, "score": 0, "creation_date": 1533727153, "post_id": 51742448, "comment_id": 90450351, "body": "Ok. The answer depends on how your spreadsheet is going to be filled up. If values in column A will remain unchanged, you could enter the formula =if(A2=&quot;Yes&quot;, 0, &quot;&quot;) in B1 and drag it down. Afterwards, you could enter the formula in the answer above in data validation and then manually enter the numbers you want in B next to the &quot;No&quot; values in A. If, however, the values in A are dynamic, I can only think of a vba solution."}, {"owner": {"reputation": 9, "user_id": 9800458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bcbbcc57f417e771775d773cb0887c0?s=128&d=identicon&r=PG&f=1", "display_name": "mrpls ", "link": "https://stackoverflow.com/users/9800458/mrpls"}, "edited": false, "score": 0, "creation_date": 1533728354, "post_id": 51742448, "comment_id": 90451158, "body": "Yes, I thought the same and you confirmed it. Being dynamic the only solution would be on VBA. It was not a big deal by the way, the formula on data validation that you provided me works perfectly as well. Thank you once more!"}], "tags": [], "owner": {"reputation": 577, "user_id": 4334973, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e2e1e1d15d538ea7559d5c14385bce1d?s=128&d=identicon&r=PG&f=1", "display_name": "Shazu", "link": "https://stackoverflow.com/users/4334973/shazu"}, "is_accepted": true, "score": 0, "last_activity_date": 1533720878, "last_edit_date": 1533720878, "creation_date": 1533718303, "answer_id": 51742448, "question_id": 51741703, "link": "https://stackoverflow.com/questions/51741703/excel-data-validation-how-to-validate-a-cell-using-if-function-after-a-yes-no/51742448#51742448", "title": "Excel Data Validation - How to validate a cell using IF function after a Yes/No droplist menu?", "body": "<pre><code>=IF($A2=\"Yes\",0,AND($B2&gt;0,$B2&lt;99999))\n</code></pre>\n\n<p>Put the formula above in data validation and it should work. Make sure that the whole column B is selected while defining the formula</p>\n"}], "owner": {"reputation": 9, "user_id": 9800458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bcbbcc57f417e771775d773cb0887c0?s=128&d=identicon&r=PG&f=1", "display_name": "mrpls ", "link": "https://stackoverflow.com/users/9800458/mrpls"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 369, "favorite_count": 0, "accepted_answer_id": 51742448, "answer_count": 1, "score": 0, "last_activity_date": 1533720878, "creation_date": 1533715930, "last_edit_date": 1533719873, "question_id": 51741703, "link": "https://stackoverflow.com/questions/51741703/excel-data-validation-how-to-validate-a-cell-using-if-function-after-a-yes-no", "title": "Excel Data Validation - How to validate a cell using IF function after a Yes/No droplist menu?", "body": "<p>The issue is quite simple, and I have seen that it is maybe possible to do it using VBA, but I am quite confident it is also possible to do using just data validation. </p>\n\n<p>I have a Yes/No dropdown list in Column A, and I would like to display \"0\" if \"yes\", or be able to insert the number (e.g. 3200) if \"no\", in Column B.</p>\n\n<pre><code>A       B\nyes     0\nNo      3200 (or any other number)\nyes     0\n</code></pre>\n\n<p>I tried customizing data validation using IF function:</p>\n\n<pre><code>=IF($A1=\"Yes\", \"0\", \"\")\n</code></pre>\n\n<p>but in that way I cannot insert a number on the cell.</p>\n\n<p>Any comments will be appreciated.</p>\n"}, {"tags": ["ms-access", "vba", "slicers"], "comments": [{"owner": {"reputation": 1381, "user_id": 6908282, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sV0sfeGuIwQ/AAAAAAAAAAI/AAAAAAAAPvk/7xDwhLEI5BU/photo.jpg?sz=128", "display_name": "Gangula", "link": "https://stackoverflow.com/users/6908282/gangula"}, "edited": false, "score": 0, "creation_date": 1588778948, "post_id": 51741446, "comment_id": 109031723, "body": "I have a similar requirement; did you find any solution?"}], "answers": [{"comments": [{"owner": {"reputation": 1381, "user_id": 6908282, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sV0sfeGuIwQ/AAAAAAAAAAI/AAAAAAAAPvk/7xDwhLEI5BU/photo.jpg?sz=128", "display_name": "Gangula", "link": "https://stackoverflow.com/users/6908282/gangula"}, "edited": false, "score": 0, "creation_date": 1588779022, "post_id": 51742403, "comment_id": 109031768, "body": "I have a similar requirement; can you please elaborate this or provide a web resource if you have any."}], "tags": [], "owner": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "is_accepted": false, "score": 0, "last_activity_date": 1533718189, "creation_date": 1533718189, "answer_id": 51742403, "question_id": 51741446, "link": "https://stackoverflow.com/questions/51741446/ms-access-2013-getting-listboxes-to-act-like-excel-slicers/51742403#51742403", "title": "MS Access 2013 - Getting listboxes to act like excel slicers", "body": "<p>Your course of action is as follows:<br>\n1. Create a function that updates the data source of ListBox according to the other LB selections<br>\n2. In the event AfterUpdate of each LB put the above function <br>\nThat's it!</p>\n"}], "owner": {"reputation": 9, "user_id": 10196147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71763a0e332ffb6853a5f765e0273a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Chaz", "link": "https://stackoverflow.com/users/10196147/chaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 263, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533718189, "creation_date": 1533715094, "question_id": 51741446, "link": "https://stackoverflow.com/questions/51741446/ms-access-2013-getting-listboxes-to-act-like-excel-slicers", "title": "MS Access 2013 - Getting listboxes to act like excel slicers", "body": "<p>I have form with a datasheet view of a table in a subform.</p>\n\n<p>I have four different listboxes to filter specific column criteria in the subform.</p>\n\n<p>If I make a selection in Listbox A, the subform auto updates to display that relevant information. Is there a way to force Listbox B-D to auto-update their selection options after the subform update to only show new available filter options? I'm attempting to get this page to work as closely as an excel slicer as possible.</p>\n\n<p>I haven't found an option to reverse the link master/child fields. Any suggestions would be great!</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1533714889, "post_id": 51741314, "comment_id": 90442731, "body": "<a href=\"http://stackoverflow.com/questions/418960/managing-and-debugging-sql-queries-in-ms-access/1099570#1099570\">How to debug dynamic SQL in VBA</a>"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1533717417, "post_id": 51741314, "comment_id": 90444240, "body": "Your image link won&#39;t open for me. Post error message as text in the question. For a start, the SQL needs a space in front of <code>set</code> and <code>where</code>. No need for Call nor the parens for <code>db.execute</code>. Why are you referencing Tag property? Why are you referencing the form recordset? Edit question with more info."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1533719456, "post_id": 51741314, "comment_id": 90445590, "body": "Are you sure you want to use <code>Me.txtID.Tag</code>? That seems very unusual to me, I&#39;d think you want <code>Me.txtID.Value</code>"}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1533721613, "post_id": 51741314, "comment_id": 90446989, "body": "Your SQL string doesn&#39;t have spaces at the end, between the continuation lines, so will read something like <code>Update dbo_gatewayset deleated_at...</code>. Secondly if you really mean to use the tag value it is stored as a string, so may not do what you are expecting when comparing it to your ID field."}, {"owner": {"reputation": 3, "user_id": 6891436, "user_type": "registered", "profile_image": "https://graph.facebook.com/1416828321668583/picture?type=large", "display_name": "Ted", "link": "https://stackoverflow.com/users/6891436/ted"}, "reply_to_user": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1533722289, "post_id": 51741314, "comment_id": 90447452, "body": "Hi. Thank you for your thoughts guys. It&#39;s my first week using VBA so I&#39;m still a newbie debugging the errors. :) I already updated my code and still getting an error message Syntax error (missing operator) in query expression &#39;id=&#39;. Please help. :( @Minty"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1533722637, "post_id": 51741314, "comment_id": 90447682, "body": "<a href=\"http://www.cpearson.com/excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\">How to debug VBA code</a>"}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1533722463, "creation_date": 1533722463, "answer_id": 51743863, "question_id": 51741314, "link": "https://stackoverflow.com/questions/51741314/run-time-error-3075-syntax-error-missing-operator-in-query-expression-id/51743863#51743863", "title": "Run-Time error &#39;3075&#39; Syntax error (missing operator) in query expression &#39;id=&#39;", "body": "<p>Your textbox is empty, thus:</p>\n\n<pre><code>\" where id=\" &amp; Me.txtID.Value, dbSeeChanges)\n</code></pre>\n\n<p>becomes:</p>\n\n<pre><code>\" where id=\"\n</code></pre>\n\n<p>So, double-check your code and prevent it from running if txtID is Null.</p>\n"}], "owner": {"reputation": 3, "user_id": 6891436, "user_type": "registered", "profile_image": "https://graph.facebook.com/1416828321668583/picture?type=large", "display_name": "Ted", "link": "https://stackoverflow.com/users/6891436/ted"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 530, "favorite_count": 0, "accepted_answer_id": 51743863, "answer_count": 1, "score": -1, "last_activity_date": 1533722463, "creation_date": 1533714695, "last_edit_date": 1533721814, "question_id": 51741314, "link": "https://stackoverflow.com/questions/51741314/run-time-error-3075-syntax-error-missing-operator-in-query-expression-id", "title": "Run-Time error &#39;3075&#39; Syntax error (missing operator) in query expression &#39;id=&#39;", "body": "<p>I was trying to create script that will do soft deletion. Apparently, there was a run-time error I encountered after running the script. Please help. </p>\n\n<pre><code>Private Sub cmdDelete_Click()\nDim db As DAO.Database\n    'delete record\n    'check existing selected record\n    'If Not (Me.frmGatewaySub.Form.Recordset.EOF And Me.frmGatewaySub.Form.Recordset.BOF) Then\n        'confirm deletion\n\n        If MsgBox(\"Are you sure you want to soft delete this?\", vbYesNo) = vbYes Then\n            'soft delete now\n            Set db = CurrentDb\n\n            Call db.Execute( _\n                \"Update dbo_gateway\" &amp; _\n                \" set deleted_at= now()\" &amp; _\n                \" where id=\" &amp; Me.txtID.Value, dbSeeChanges)\n\n            'clear text box\n            cmdClear_Click\n            Me.frmGatewaySub.Form.Requery\n\n        End If\n\n    'End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "xlsx"], "comments": [{"owner": {"reputation": 982, "user_id": 4035306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XirX6.jpg?s=128&g=1", "display_name": "Lutscha", "link": "https://stackoverflow.com/users/4035306/lutscha"}, "edited": false, "score": 1, "creation_date": 1533714743, "post_id": 51741228, "comment_id": 90442652, "body": "You can via VBA open both worbooks, select all the data you need (therefor you need to know where everything is stored) and transfer your data to the second one. Workbook1.Sheets(&quot;Sheet1&quot;).Range(&quot;A1&quot;) = Workbook2.Sheets(&quot;Sheet1&quot;).Range(&quot;A1&quot;). Something like this, but ofc a little more structured etc. After transfering data you can let the code close both of these workbooks"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1533716895, "post_id": 51741228, "comment_id": 90443891, "body": "@plutoX: Welcome to Stack Overflow: Please <a href=\"https://stackoverflow.com/tour\">take the tour</a> and read <a href=\"https://stackoverflow.com/help/how-to-ask\">How to ask a good question</a>, then edit your question to include the code, expected behaviour, and what is wrong... then we can try to help"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1533716920, "post_id": 51741228, "comment_id": 90443907, "body": "@plutox: please show us <a href=\"https://mattgemmell.com/what-have-you-tried/\" rel=\"nofollow noreferrer\">what you have tried</a>"}, {"owner": {"reputation": 107, "user_id": 7379411, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FlnWP.jpg?s=128&g=1", "display_name": "PlutoX", "link": "https://stackoverflow.com/users/7379411/plutox"}, "edited": false, "score": 1, "creation_date": 1533717252, "post_id": 51741228, "comment_id": 90444129, "body": "Thanks for the feedback! As I&#39;m a complete excel noob - would the code look something like this? I&#39;ve updated my original post with the code snipped. Thanks so much guys.."}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1533723848, "post_id": 51741228, "comment_id": 90448371, "body": "@PlutoX: thank you - I have removed my downvote, and retracted my close vote. If the answer provided by Alex solved your problem, please Accept it by clicking the green check/tick mark. If you need further help, put a comment to Alex under his answer."}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 7379411, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FlnWP.jpg?s=128&g=1", "display_name": "PlutoX", "link": "https://stackoverflow.com/users/7379411/plutox"}, "edited": false, "score": 0, "creation_date": 1533725119, "post_id": 51742330, "comment_id": 90449097, "body": "Thanks so much! I&#39;ve updated my code snipped according to your feedback, and added it to a button in wb3 -  but I get an error message stating: &quot;invalid outside of a procedure&quot;. Have I missed something?"}, {"owner": {"reputation": 107, "user_id": 7379411, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FlnWP.jpg?s=128&g=1", "display_name": "PlutoX", "link": "https://stackoverflow.com/users/7379411/plutox"}, "edited": false, "score": 0, "creation_date": 1533725694, "post_id": 51742330, "comment_id": 90449462, "body": "...the &quot;Sub CommandButton1_Click()&quot; part of the code is highlighted in yellow as well - so I guess that this part of the code is somehow tied to the error message."}, {"owner": {"reputation": 107, "user_id": 7379411, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FlnWP.jpg?s=128&g=1", "display_name": "PlutoX", "link": "https://stackoverflow.com/users/7379411/plutox"}, "edited": false, "score": 0, "creation_date": 1533726427, "post_id": 51742330, "comment_id": 90449915, "body": "I&#39;ve tried it again - it worked!! thanks so much for the help guys!"}], "tags": [], "owner": {"reputation": 1209, "user_id": 3927703, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1058356120/picture?type=large", "display_name": "Alex de Jong", "link": "https://stackoverflow.com/users/3927703/alex-de-jong"}, "is_accepted": true, "score": 1, "last_activity_date": 1533718183, "last_edit_date": 1533718183, "creation_date": 1533717956, "answer_id": 51742330, "question_id": 51741228, "link": "https://stackoverflow.com/questions/51741228/tranfser-data-between-two-closed-workbooks-without-creating-a-new-one/51742330#51742330", "title": "Tranfser data between two closed workbooks without creating a new one", "body": "<p>Almost there! You need to change three things:</p>\n\n<ol>\n<li><p>If you want to open a workbook, you need to state the full path</p>\n\n<pre><code>Set wb1 = Application.workbooks.open(\"C:\\Users\\PlutoX\\MyExcelfile1.xlsx\")\n</code></pre></li>\n<li><p>If stuff needs to be transferred to wb2, the order is wb2 = wb1 so</p>\n\n<pre><code>wb2.sheets(\"Sheet1\").Range(\"A1\").value = wb1.sheets(\"Sheet1\").Range(\"A1\").value\n</code></pre></li>\n<li><p>If you close the workbooks, make sure you save at least the one with changes</p>\n\n<pre><code>wb2.Close True\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 107, "user_id": 7379411, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FlnWP.jpg?s=128&g=1", "display_name": "PlutoX", "link": "https://stackoverflow.com/users/7379411/plutox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 51742330, "answer_count": 1, "score": -1, "last_activity_date": 1533726132, "creation_date": 1533714406, "last_edit_date": 1533726132, "question_id": 51741228, "link": "https://stackoverflow.com/questions/51741228/tranfser-data-between-two-closed-workbooks-without-creating-a-new-one", "title": "Tranfser data between two closed workbooks without creating a new one", "body": "<p>how do I tranfser data between two closed workbooks <strong>without creating a new one</strong>? I have the following scenario:  </p>\n\n<ul>\n<li>2 excel workbooks(wb1 and wb2) with different structures</li>\n<li>I need certain data from wb1 to be transfered to wb2</li>\n<li>I can't modify wb1 &amp; wb2 with macros</li>\n</ul>\n\n<p><strong>My question:</strong> Is it possible to activate a macro from a seperate excel workbook - lets name it wb3? So, triggering the macro in wb3 would transfer all the relevant data from wb1 to wb2....how would a macro like this look like?</p>\n\n<p>Thanks!</p>\n\n<pre><code>Sub CommandButton1_Click()\nDim wb1 As Workbook\nDim wb2 As Workbook\n\nSet wb1 = Application.workbooks.open(\"C:\\Users\\PlutoX\\MyExcelfile1.xlsx\")\nSet wb2 = Application.workbooks.open(\"C:\\Users\\PlutoX\\MyExcelfile1.xlsx\")\n\n\nwb2.Sheets(\"Sheet1\").Range(\"A1\") = wb1.Sheets(\"Sheet1\").Range(\"A1\")\n\n\n\nwb1.Close False\nwb2.Close True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1533713783, "post_id": 51740711, "comment_id": 90442065, "body": "Please see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and take the <a href=\"https://stackoverflow.com/tour\">tour</a>. This is not an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 1540, "user_id": 4705583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iBboA.jpg?s=128&g=1", "display_name": "Rich Michaels", "link": "https://stackoverflow.com/users/4705583/rich-michaels"}, "edited": false, "score": 0, "creation_date": 1533747218, "post_id": 51740711, "comment_id": 90463601, "body": "I&#39;m assuming you want to save the open file as PDF so I have included an Answer below that will do that and still allow the user to decide where to save it. If that is not a correct assumption, I will delete the answer and then please be more specific about your question. For example, provide a screenshot of what dialog you are trying to control."}], "answers": [{"comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1533734183, "post_id": 51745299, "comment_id": 90455158, "body": "How does your proposal default the dialog to the PDF file format?"}, {"owner": {"reputation": 208, "user_id": 10062262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41486435301afe7d1ac37b98a2fb4871?s=128&d=identicon&r=PG&f=1", "display_name": "Yuki", "link": "https://stackoverflow.com/users/10062262/yuki"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1533778094, "post_id": 51745299, "comment_id": 90474710, "body": "When the dialog box pops out,please choose &quot;OK&quot; then it will be automatically saved as the default type of &quot;*.pdf&quot;."}, {"owner": {"reputation": 1, "user_id": 10195881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a03fd9e50e8874d51c07d36e037ccd34?s=128&d=identicon&r=PG&f=1", "display_name": "Arun Bavojula", "link": "https://stackoverflow.com/users/10195881/arun-bavojula"}, "edited": false, "score": 0, "creation_date": 1534503243, "post_id": 51745299, "comment_id": 90738291, "body": "Hello Yuki, Thanks for your answer. I&#39;m getting an error for this (Sub or Function not defiened). Please help me out on this."}, {"owner": {"reputation": 208, "user_id": 10062262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41486435301afe7d1ac37b98a2fb4871?s=128&d=identicon&r=PG&f=1", "display_name": "Yuki", "link": "https://stackoverflow.com/users/10062262/yuki"}, "edited": false, "score": 0, "creation_date": 1534815826, "post_id": 51745299, "comment_id": 90830827, "body": "There, it is stated that one must create the new macro by selecting Developer -&gt; Macros, typing a new macro name, and clicking &quot;Create&quot;. Creating the macro in this way, you were able to run it."}], "tags": [], "owner": {"reputation": 208, "user_id": 10062262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41486435301afe7d1ac37b98a2fb4871?s=128&d=identicon&r=PG&f=1", "display_name": "Yuki", "link": "https://stackoverflow.com/users/10062262/yuki"}, "is_accepted": false, "score": -1, "last_activity_date": 1533726874, "creation_date": 1533726874, "answer_id": 51745299, "question_id": 51740711, "link": "https://stackoverflow.com/questions/51740711/vba-code-for-opened-word-document-with-print-pop-up-message/51745299#51745299", "title": "VBA code for opened word document with print pop up message", "body": "<p>Based on my tests, please try the code as below:</p>\n\n<p>VBA code:</p>\n\n<pre><code>Sub popUpTo_PDF_Option()\n  Dim dlg As Dialog\n  Set dlg = Dialogs(wdDialogFilePrint)\n  dlg.Show\nEnd Sub\n</code></pre>\n\n<p>Hope it helps you.</p>\n\n<p>Thanks,</p>\n\n<p>Yuki</p>\n"}, {"tags": [], "owner": {"reputation": 1540, "user_id": 4705583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iBboA.jpg?s=128&g=1", "display_name": "Rich Michaels", "link": "https://stackoverflow.com/users/4705583/rich-michaels"}, "is_accepted": false, "score": 0, "last_activity_date": 1533747031, "creation_date": 1533747031, "answer_id": 51751829, "question_id": 51740711, "link": "https://stackoverflow.com/questions/51740711/vba-code-for-opened-word-document-with-print-pop-up-message/51751829#51751829", "title": "VBA code for opened word document with print pop up message", "body": "<p>Try this:</p>\n\n<pre><code>    With Application.Dialogs(wdDialogFileSaveAs)\n    .Format = word.WdSaveFormat.wdFormatPDF\n    .Show\n    End With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10195881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a03fd9e50e8874d51c07d36e037ccd34?s=128&d=identicon&r=PG&f=1", "display_name": "Arun Bavojula", "link": "https://stackoverflow.com/users/10195881/arun-bavojula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 266, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1534502684, "creation_date": 1533712710, "last_edit_date": 1534502684, "question_id": 51740711, "link": "https://stackoverflow.com/questions/51740711/vba-code-for-opened-word-document-with-print-pop-up-message", "title": "VBA code for opened word document with print pop up message", "body": "<p>I'm new to VBA coding. I'm working on a project. In that I need to print an already opened word document with print page pop up to default PDF option. Can someone help me out on this?</p>\n"}, {"tags": ["excel", "vba", "out-of-memory"], "comments": [{"owner": {"reputation": 849, "user_id": 9151274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49f96542b2315af0983a1e2aae197d2b?s=128&d=identicon&r=PG", "display_name": "Anu", "link": "https://stackoverflow.com/users/9151274/anu"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1533714309, "post_id": 51740482, "comment_id": 90442389, "body": "@JvdV Tried  <code>Set Application.ThisWorkbook = Nothing</code>. But then encountered error. So gave  <code>Set plannerWorkbook = Nothing</code>. But still have the same issue"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1533733637, "post_id": 51740482, "comment_id": 90454783, "body": "Please include an entire &quot;Sub&quot; that demonstrates the problem. Not your entire code, if it&#39;s long - just enough of it that the problem is reproducible. It&#39;s impossible for us to tell from the information you provide what might be wrong."}, {"owner": {"reputation": 849, "user_id": 9151274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49f96542b2315af0983a1e2aae197d2b?s=128&d=identicon&r=PG", "display_name": "Anu", "link": "https://stackoverflow.com/users/9151274/anu"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1533903427, "post_id": 51740482, "comment_id": 90529655, "body": "@CindyMeister I am sorry that I can&#39;t give the entire codes here. It is calling many functions and subs after opened planbook. I am just hoping if someone encountered similar issue whereby workbook appear in project window after it is closed. But unluckily there is none yet"}, {"owner": {"reputation": 849, "user_id": 9151274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49f96542b2315af0983a1e2aae197d2b?s=128&d=identicon&r=PG", "display_name": "Anu", "link": "https://stackoverflow.com/users/9151274/anu"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1533903489, "post_id": 51740482, "comment_id": 90529695, "body": "@GMalc Then what does <code>planbook.Close False</code> do if it is not closing the workbook? From what I know, that is the command to close a workbook without saving."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1533903767, "post_id": 51740482, "comment_id": 90529872, "body": "I specifically asked you NOT to include the entire code - only enough to reproduce the problem. Without more context it&#39;s not possible to <i>guess</i> what might be wrong."}, {"owner": {"reputation": 849, "user_id": 9151274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49f96542b2315af0983a1e2aae197d2b?s=128&d=identicon&r=PG", "display_name": "Anu", "link": "https://stackoverflow.com/users/9151274/anu"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1533904168, "post_id": 51740482, "comment_id": 90530155, "body": "@CindyMeister I don&#39;t know which part of the code is causing the problem so that it can reproduce the issue. Like I mentioned earlier there is a lot of data extraction from workbook &#39;planbook&#39;. I already tried to isolate those codes so that it can reproduce. So far I couldn&#39;t reproduce when I extracts parts from it. Will post the codes for sure, if I am successful in extracting problematic part"}, {"owner": {"reputation": 849, "user_id": 9151274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49f96542b2315af0983a1e2aae197d2b?s=128&d=identicon&r=PG", "display_name": "Anu", "link": "https://stackoverflow.com/users/9151274/anu"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1533979673, "post_id": 51740482, "comment_id": 90553485, "body": "I noticed something related to my problem. The file I am opening and closing is a shared file. Once I removed the sharing option of that workbook, it is closing properly without remaining in the project window. So the problem is related to closing a shared file promptly. Any idea anyone?"}, {"owner": {"reputation": 849, "user_id": 9151274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49f96542b2315af0983a1e2aae197d2b?s=128&d=identicon&r=PG", "display_name": "Anu", "link": "https://stackoverflow.com/users/9151274/anu"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1534576612, "post_id": 51740482, "comment_id": 90762953, "body": "I still couldn&#39;t figure out what is wrong. Now noticed that after sometime, the files showing in project window, automatically disappearing one by one if I keep it open for a while"}, {"owner": {"reputation": 25448, "user_id": 563532, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2773fec98b1630ec087b575482dc08a?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/563532/rob"}, "edited": false, "score": 1, "creation_date": 1537448651, "post_id": 51740482, "comment_id": 91794599, "body": "Your question has been undeleted, @Anu"}], "answers": [{"tags": [], "owner": {"reputation": 849, "user_id": 9151274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49f96542b2315af0983a1e2aae197d2b?s=128&d=identicon&r=PG", "display_name": "Anu", "link": "https://stackoverflow.com/users/9151274/anu"}, "is_accepted": true, "score": 0, "last_activity_date": 1537490120, "creation_date": 1537490120, "answer_id": 52435048, "question_id": 51740482, "link": "https://stackoverflow.com/questions/51740482/why-do-files-remain-in-project-window-even-after-files-closed/52435048#52435048", "title": "Why do files remain in project window even after files closed?", "body": "<p>After many checks, it is found out that issue is not due to any codes. It is purely because of I am opening and closing a shared workbook. This type of issues are common when use shared workbooks. So it is best to avoid usage of shared workbooks. </p>\n\n<p>During these process some items I did to clear memory issue are</p>\n\n<ol>\n<li><p>Clear out variables and objects immediately after their usage. </p>\n\n<p><code>Eg: Set wb = nothing</code></p></li>\n<li><p>Open workbooks as read only whenever possible.  </p>\n\n<p><code>Eg: Set wb = Workbooks.Open(blanketPo, ReadOnly:=True)</code></p></li>\n<li>Try to use <code>ByRef</code> instead of <code>ByVal</code> whenever possible while passing data. But please take care of the implication also when use these two</li>\n<li>After copied large set of data and finished the usage with such data, clear away that from memory by using <code>Application.CutCopyMode = False</code></li>\n<li><p>Use the following code to empty clip board such as object and stuffs which were copied and keeping in clipboard while running macro. I got this code from another forum</p>\n\n<p><code>Dim DataObj As New MSForms.DataObject 'empty the clipboard\n DataObj.SetText \"\"\n DataObj.PutInClipboard</code></p></li>\n</ol>\n\n<p>Anyway the moment I choose not to use shared workbook, most of the memory and hang up issues disappeared. So its mostly all about the buggy shared workbook. </p>\n"}], "owner": {"reputation": 849, "user_id": 9151274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49f96542b2315af0983a1e2aae197d2b?s=128&d=identicon&r=PG", "display_name": "Anu", "link": "https://stackoverflow.com/users/9151274/anu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1181, "favorite_count": 0, "accepted_answer_id": 52435048, "answer_count": 1, "score": -1, "last_activity_date": 1592355561, "creation_date": 1533711958, "last_edit_date": 1592355561, "question_id": 51740482, "link": "https://stackoverflow.com/questions/51740482/why-do-files-remain-in-project-window-even-after-files-closed", "title": "Why do files remain in project window even after files closed?", "body": "<p><strong>Scenario</strong></p>\n\n<p>I have a userform, and when a button is pressed, it opens an Excel file as read-only, gets some values, and closes that file. Following are the codes I am using to open and close the file.</p>\n\n<p>To open: <code>Set planbook = Workbooks.Open(planFilePath, ReadOnly:=True)</code></p>\n\n<p>To close: <code>planbook.Close False</code></p>\n\n<p><strong>Problem</strong></p>\n\n<p>After closing the file, I see that file in the project window, for each time I press the button.</p>\n\n<p><a href=\"https://i.stack.imgur.com/yxq1k.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yxq1k.jpg\" alt=\"Modules show after closed Planner file.xlsx\"></a></p>\n\n<p>It is using a lot of memory. Due to this, Excel hangs intermittently. </p>\n\n<p>Why are files opened earlier but currently closed still appearing in the project window?</p>\n\n<p>Note, when the button is pressed three times (means open and close a workbook three times), and thus there are three files listed in the picture.</p>\n\n<p><strong>Edit 1</strong><br>\nIt's not the module that remains, the whole file is visible in the VBA window, although the workbook is closed.</p>\n\n<p><strong>Edit 2</strong><br>\nNoticed, if I keep the macro open for some time, the files showing in the project window, disappear one by one. </p>\n\n<p><strong>Edit 3</strong><br>\nI found, the issue is due to opening and closing a shared workbook. See the answer for more explanation.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2322, "user_id": 851272, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3314debd6f46b2807d84d1336a054da4?s=128&d=identicon&r=PG", "display_name": "David Colwell", "link": "https://stackoverflow.com/users/851272/david-colwell"}, "edited": false, "score": 0, "creation_date": 1533711429, "post_id": 51740289, "comment_id": 90440679, "body": "Hi Diana, welcome to Stackoverflow.  Since tables do not show well, can you take a screenshot of the example table you are talking about?"}, {"owner": {"reputation": 1209, "user_id": 3927703, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1058356120/picture?type=large", "display_name": "Alex de Jong", "link": "https://stackoverflow.com/users/3927703/alex-de-jong"}, "edited": false, "score": 0, "creation_date": 1533718778, "post_id": 51740289, "comment_id": 90445116, "body": "If you are not familiar with VBA, I would suggest creating an additional column with a formula stating 1 for duplicates. You can use the COUNTIFS formula to check if a row exists wherein all values are the same. Afterwards, you can set a filter and show only the rows with value 1 and delete them all at once."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1533735290, "post_id": 51740289, "comment_id": 90455920, "body": "Please see <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask</a>, take the <a href=\"https://stackoverflow.com/tour\">SO Tour</a>, and <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>. That said see my answer."}], "answers": [{"comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "reply_to_user": {"reputation": 1, "user_id": 10195793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7351644f0571d946650b7ee417f3237b?s=128&d=identicon&r=PG&f=1", "display_name": "Diana", "link": "https://stackoverflow.com/users/10195793/diana"}, "edited": false, "score": 0, "creation_date": 1533783718, "post_id": 51748033, "comment_id": 90475758, "body": "You need to be clear when you ask a question. Your statement <code>&quot;I am trying to compare column A if they are duplicates and delete the whole row&quot;</code> you failed to explain comparing the additional columns you wrote in your comment above. Please edit your question with a complete narrative and example of what your are trying to accomplish, to include code you have tried to accomplish your task."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "reply_to_user": {"reputation": 1, "user_id": 10195793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7351644f0571d946650b7ee417f3237b?s=128&d=identicon&r=PG&f=1", "display_name": "Diana", "link": "https://stackoverflow.com/users/10195793/diana"}, "edited": false, "score": 0, "creation_date": 1533786435, "post_id": 51748033, "comment_id": 90476272, "body": "Diana, sorry your question in this post is unclear and confusing, using the comments section to clarify your question is improper, you need to edit your post. Please read the SO help files i suggested in my initial comment."}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1533735089, "creation_date": 1533735089, "answer_id": 51748033, "question_id": 51740289, "link": "https://stackoverflow.com/questions/51740289/delete-rows-based-on/51748033#51748033", "title": "delete rows based on", "body": "<p>Here is a simple solution that will remove duplicate rows based on Column A</p>\n\n<pre><code>Sub test()\nSheet1.Cells.RemoveDuplicates Columns:=1, Header:=xlYes\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10195793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7351644f0571d946650b7ee417f3237b?s=128&d=identicon&r=PG&f=1", "display_name": "Diana", "link": "https://stackoverflow.com/users/10195793/diana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1594031111, "creation_date": 1533711283, "last_edit_date": 1594031111, "question_id": 51740289, "link": "https://stackoverflow.com/questions/51740289/delete-rows-based-on", "title": "delete rows based on", "body": "<p>I am a little bit stacked. I am trying to compare column A if they are duplicates and delete all rows, leaving just the last revision, last Version row for every document.\nI have Column A - Document Name, Column B - Revision (A,B,C..), Column C - Version (1,2,3..). As an example: (A2= Rev A Version 2) Document &quot;x&quot; I have in row 1 as A1, Row 2 as A2, Row 3 as C2, Row 4 as D1, Row 5 as D2. I need something to delete all rows 1-4 and leave just row 5 which is the last revision and last version (Rev D Version 2). For Document &quot;Y' need to remain just the row with Rev D, Version 2, and so on.</p>\n<pre><code>Document Name   Revision    Version  Title\nx               A           1        BAY CONTROLLER BLOCK LOGIC DIAGRAM\nx               A           2        BAY CONTROLLER BLOCK LOGIC DIAGRAM\nx               C           2        BAY CONTROLLER BLOCK LOGIC DIAGRAM\nx               D           1        BAY CONTROLLER BLOCK LOGIC DIAGRAM\nx               D           2        BAY CONTROLLER BLOCK LOGIC DIAGRAM\ny               C           1        BAY CONTROLLER BLOCK LOGIC DIAGRAM\ny               C           2        BAY CONTROLLER BLOCK LOGIC DIAGRAM\ny               C           3        BAY CONTROLLER BLOCK LOGIC DIAGRAM\ny               D           1        BAY CONTROLLER BLOCK LOGIC DIAGRAM\ny               D           2        BAY CONTROLLER BLOCK LOGIC DIAGRAM*\n</code></pre>\n"}, {"tags": ["vba", "oracle", "excel", "cyrillic"], "comments": [{"owner": {"reputation": 3318, "user_id": 1715255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/052089e1ebdb07dabb8745fdc82b844f?s=128&d=identicon&r=PG&f=1", "display_name": "hotfix", "link": "https://stackoverflow.com/users/1715255/hotfix"}, "edited": false, "score": 0, "creation_date": 1533711545, "post_id": 51740281, "comment_id": 90440747, "body": "maybe this article could help you: <a href=\"https://www.di-mgt.com.au/howto-convert-vba-unicode-to-utf8.html\" rel=\"nofollow noreferrer\">di-mgt.com.au/howto-convert-vba-unicode-to-utf8.html</a>"}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1533712438, "post_id": 51740281, "comment_id": 90441233, "body": "What is your <code>NLS_LANG</code> value?"}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "reply_to_user": {"reputation": 3318, "user_id": 1715255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/052089e1ebdb07dabb8745fdc82b844f?s=128&d=identicon&r=PG&f=1", "display_name": "hotfix", "link": "https://stackoverflow.com/users/1715255/hotfix"}, "edited": false, "score": 0, "creation_date": 1533712506, "post_id": 51740281, "comment_id": 90441278, "body": "@hotfix, this does not help because you get <code>?</code> already from database, so there is nothing you could convert."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 9902366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9f8240df1ed25744371889349d80bc4?s=128&d=identicon&r=PG&f=1", "display_name": "realsnad", "link": "https://stackoverflow.com/users/9902366/realsnad"}, "edited": false, "score": 0, "creation_date": 1533717458, "post_id": 51740837, "comment_id": 90444261, "body": "Thanks a lot! I added Env var NLS_LANG=RUSSIAN_RUSSIA.CL8MSWIN1251, and it&#39;s working fine now."}], "tags": [], "owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "is_accepted": true, "score": 2, "last_activity_date": 1533713142, "creation_date": 1533713142, "answer_id": 51740837, "question_id": 51740281, "link": "https://stackoverflow.com/questions/51740281/cyrillic-letter-displaying-as-question-marks-in-vba-from-oracle/51740837#51740837", "title": "Cyrillic letter displaying as question marks in VBA from Oracle", "body": "<p>Set your <code>NLS_LANG</code> value to a character set which supports Cyrillic characters, e.g. <code>CL8MSWIN1251</code> or <code>AL32UTF8</code>.</p>\n\n<p>You can do this by Environment variable, for example</p>\n\n<pre><code>SET NLS_LANG=AMERICAN_RUSSIA.CL8MSWIN1251\n</code></pre>\n\n<p>or in your Registry at <code>HKLM\\SOFTWARE\\Wow6432Node\\ORACLE\\KEY_%ORACLE_HOME_NAME%\\NLS_LANG</code> (for 32 bit), resp. <code>HKLM\\SOFTWARE\\ORACLE\\KEY_%ORACLE_HOME_NAME%\\NLS_LANG</code> for 64-bit.</p>\n\n<p>See also <a href=\"https://stackoverflow.com/questions/33783902/odbcconnection-returning-chinese-characters-as/33790600#33790600\">OdbcConnection returning Chinese Characters as &quot;?&quot;</a> for more details.</p>\n"}], "owner": {"reputation": 35, "user_id": 9902366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9f8240df1ed25744371889349d80bc4?s=128&d=identicon&r=PG&f=1", "display_name": "realsnad", "link": "https://stackoverflow.com/users/9902366/realsnad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 821, "favorite_count": 0, "accepted_answer_id": 51740837, "answer_count": 1, "score": 1, "last_activity_date": 1533713142, "creation_date": 1533711254, "question_id": 51740281, "link": "https://stackoverflow.com/questions/51740281/cyrillic-letter-displaying-as-question-marks-in-vba-from-oracle", "title": "Cyrillic letter displaying as question marks in VBA from Oracle", "body": "<p>We've got a problem displaying Cyrillic letters from Clob field (Oracle) on Excel spreadsheet using ADODB.RecordSet (MS ActiveX Data Objects 2.8 Library).</p>\n\n<p>As an example, I created a table with one Clob field. I inserted just one row with Cyrillic letters and am trying to show the value on Excel spreadsheet. However, the text shows as ???? both in Msgbox and in the cell. This happens only while getting values from Clob fields. It works fine if we query them from varchar. I've tried on 11.2.0.2.0 and 12.2.0.1.0. The behavior is the same. What could we do in order to fix this?</p>\n\n<p>NLS_CHARACTERSET in db is AL32UTF8.</p>\n\n<p>The VBA code is as follows:</p>\n\n<pre><code>Private Sub UnloadReportBtn_Click()\n    Dim RecordSet As ADODB.RecordSet\n\n    Set RecordSet = getTestClob\n\n    While RecordSet.EOF = False\n        MsgBox RecordSet.Fields(\"TEST1\")\n\n        Cells(7, 7) = RecordSet.Fields(\"TEST1\")\n\n        RecordSet.MoveNext\n    Wend\nEnd Sub\n\nPublic Function getTestClob()\n    Dim Query As String\n\n    Query = \"SELECT TEST1 FROM TEST_CLOB\"\n\n    Set getTestClob = getRecordSet(Query)\nEnd Function\n\nPublic Function getRecordSet(Query As String) As ADODB.RecordSet\n    Dim SQLCommand As ADODB.Command\n\n    Dim RecordSet As ADODB.RecordSet\n\n    Set SQLCommand = New ADODB.Command\n    Set SQLCommand.ActiveConnection = Connection\n\n    SQLCommand.CommandText = Query\n    SQLCommand.CommandType = adCmdText\n    SQLCommand.CommandTimeout = 0\n\n    Set getRecordSet = SQLCommand.execute\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "vb6"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1533710936, "post_id": 51740133, "comment_id": 90440402, "body": "Excel dates are not intended to go that far back, however you could just use integers (or even text) to create your own logic numbering system based on the specific period that you need.  More info <a href=\"http://www.exceluser.com/formulas/earlydates.htm\" rel=\"nofollow noreferrer\"><b>here</b></a>."}, {"owner": {"reputation": 1086, "user_id": 2260283, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/45f4d3e9c7a9b22897848bd05fbca26a?s=128&d=identicon&r=PG", "display_name": "Nostromo", "link": "https://stackoverflow.com/users/2260283/nostromo"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1533711182, "post_id": 51740133, "comment_id": 90440535, "body": "Thank you, I&#39;m not using Excel, I use Access. I get this date in a code module and I need to show it on a form when there&#39;s a date."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1533711360, "post_id": 51740133, "comment_id": 90440641, "body": "I meant to say Access but it&#39;s the exact same idea; the basis of any solution will apply to any Office application.. Any resources you find for handling Excel date/times will apply to MS Access as well. (and there&#39;s a lot more out there for Excel.)"}, {"owner": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "edited": false, "score": 2, "creation_date": 1533736836, "post_id": 51740133, "comment_id": 90456966, "body": "Since VB6 was tagged for this question as well, typically date controls (activeX files) usually have property settings for minimum date value as well as the format in which the date is presented.  While a controls default minimum date value might be 12/30/1899 by default, for example, I would think it could be set to 01/01/0000 but it depends on the control.  I don&#39;t know if this helps or not."}, {"owner": {"reputation": 513, "user_id": 10059074, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/d5f487d1ae5cbf54ac9f5641f10c5fb4?s=128&d=identicon&r=PG", "display_name": "CatCat", "link": "https://stackoverflow.com/users/10059074/catcat"}, "edited": false, "score": 0, "creation_date": 1534238557, "post_id": 51740133, "comment_id": 90629161, "body": "The Y2K problem solution in Windows is it uses nn30. Before nn30 it rounds down and nn31+ it rounds up."}], "answers": [{"tags": [], "owner": {"reputation": 38, "user_id": 5621735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/202a288095eae2b238d59fa2fe4f4e71?s=128&d=identicon&r=PG&f=1", "display_name": "Ota Milink", "link": "https://stackoverflow.com/users/5621735/ota-milink"}, "is_accepted": false, "score": 0, "last_activity_date": 1534507891, "creation_date": 1534507891, "answer_id": 51895182, "question_id": 51740133, "link": "https://stackoverflow.com/questions/51740133/ancient-dates-2-digits-year-in-vba-vb6/51895182#51895182", "title": "Ancient dates (2 digits year) in VBA/VB6", "body": "<p>Yes it seems that 1.1.100 is some kind of limit in VBA.</p>\n\n<p>Internally the date is stored as double value so you can force older dates by calculating it in double variable and then copying it to date variable like this:</p>\n\n<pre><code>Public Declare Sub CopyMemory Lib \"kernel32\" Alias \"RtlMoveMemory\" _\n  (lpDest As Any, lpSource As Any, ByVal cBytes&amp;)\n\nPublic Function MyDateSerial(year As Long, month As Long, day As Long) As Date\n  Dim d As Double\n\n  If year &gt;= 100 Then\n    MyDateSerial = DateSerial(year, month, day)\n  Else\n    d = DateSerial(year + 100, month, day) - (DateSerial(200, 1, 1) - DateSerial(100, 1, 1))\n    Call CopyMemory(MyDateSerial, d, 8)\n  End If\nEnd Function\n</code></pre>\n\n<p>But be careful because almost every operation with such value fails.\nIt would be probably better to use directly double variables for storing such data.\nOr use custom structure like</p>\n\n<pre><code>Public Type MyDate\n  year As Long\n  month As Long\n  day As Long\nEnd Type\n</code></pre>\n"}], "owner": {"reputation": 1086, "user_id": 2260283, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/45f4d3e9c7a9b22897848bd05fbca26a?s=128&d=identicon&r=PG", "display_name": "Nostromo", "link": "https://stackoverflow.com/users/2260283/nostromo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 308, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1534507891, "creation_date": 1533710665, "question_id": 51740133, "link": "https://stackoverflow.com/questions/51740133/ancient-dates-2-digits-year-in-vba-vb6", "title": "Ancient dates (2 digits year) in VBA/VB6", "body": "<p>How can one create a <code>Date</code> variable in VBA that holds a date from a year before the year 100?</p>\n\n<p>We have an VBA project that gets some of the values from a .NET project, for instance some dates. All of the values are strings and I have to convert them to the appropriate data type in VBA.\nIt happens that there is no date, so I get the .NET null date as a string like <code>0001-01-01T00:00:00</code>. With a current date I can just remove the \"T\" in the middle, put a space instead and give that string to the <code>CDate</code> function to get the <code>Date</code>. When I do that with the .NET null date I get 1/1/2001 as a result, because <code>CDate</code> assumes that the year 1 must be a shortened year and adds 2000 to it (it adds 2000 from year 1 to 29, and it adds 1900 from year 30 to 99).</p>\n\n<p>So I thought I parse the string myself and use the <code>DateSerial</code> function to create the appropriate date, but this function does the same stuff.</p>\n\n<p>I could do a string comparison and when I get the .NET null date I could convert it to the VBA null date, but that would only work when I really get the .NET null date. As soon as I get a date slightly higher than that (for instance <code>0001-01-02T00:00:00</code>), I'd had the same problem again.</p>\n\n<p>I know that the null date in VBA is 12/30/1899, I know that I can create dates before that null date with the <code>CDate</code> function, but it seems to me, that I can't go below year 100, or can I?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1533710689, "post_id": 51739852, "comment_id": 90440287, "body": "What is <code>items</code> at loop condition?"}, {"owner": {"reputation": 5173, "user_id": 1981088, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Iicg.png?s=128&g=1", "display_name": "help-info.de", "link": "https://stackoverflow.com/users/1981088/help-info-de"}, "edited": false, "score": 0, "creation_date": 1533710929, "post_id": 51739852, "comment_id": 90440395, "body": "Is there a separator between <code>REQ03723850RITM0548461</code>?"}, {"owner": {"reputation": 5173, "user_id": 1981088, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Iicg.png?s=128&g=1", "display_name": "help-info.de", "link": "https://stackoverflow.com/users/1981088/help-info-de"}, "edited": false, "score": 0, "creation_date": 1533711085, "post_id": 51739852, "comment_id": 90440471, "body": "Please go through the <a href=\"https://stackoverflow.com/tour\">tour</a>, the <a href=\"https://stackoverflow.com/help\">help Center</a> and the <a href=\"https://stackoverflow.com/help/how-to-ask\">how to ask a good question</a> sections to see how this site works and to help you improve your current and future questions, which can help you get better answers."}, {"owner": {"reputation": 162, "user_id": 8789482, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10207644192263165/picture?type=large", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/8789482/jonathan"}, "reply_to_user": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1533711449, "post_id": 51739852, "comment_id": 90440694, "body": "@AntiDrondert - loop at item_description which is column D. Edited the code now with that typo error."}, {"owner": {"reputation": 162, "user_id": 8789482, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10207644192263165/picture?type=large", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/8789482/jonathan"}, "reply_to_user": {"reputation": 5173, "user_id": 1981088, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Iicg.png?s=128&g=1", "display_name": "help-info.de", "link": "https://stackoverflow.com/users/1981088/help-info-de"}, "edited": false, "score": 0, "creation_date": 1533711505, "post_id": 51739852, "comment_id": 90440725, "body": "@help-info.de - Yes there is a &quot;space&quot; in between."}], "answers": [{"comments": [{"owner": {"reputation": 162, "user_id": 8789482, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10207644192263165/picture?type=large", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/8789482/jonathan"}, "edited": false, "score": 0, "creation_date": 1533720708, "post_id": 51742346, "comment_id": 90446420, "body": "Genius!Works extremely well"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 2, "last_activity_date": 1533724830, "last_edit_date": 1533724830, "creation_date": 1533717983, "answer_id": 51742346, "question_id": 51739852, "link": "https://stackoverflow.com/questions/51739852/vba-search-a-string-in-row-then-copy-paste-it-to-a-different-column/51742346#51742346", "title": "VBA - search a string in row then copy &amp; paste it to a different column", "body": "<p>Well, here is a way to do it:</p>\n\n<pre><code>Sub Test()\n\nDim X As Long, LR As Long, POS1 As Long, POS2 As Long\n\nWith ActiveWorkbook.Sheets(1)\n    LR = .range(\"D\" &amp; Rows.Count).End(xlUp).Row\n    For X = 2 To LR\n        If InStr(1, .Cells(X, 4), \"REQ0\") &gt; 0 Then\n            POS1 = InStr(1, .Cells(X, 4), \"REQ0\") 'Get startposition\n            POS2 = InStr(POS1, .Cells(X, 4), \" \") 'Get positon of space\n            If POS2 &gt; 0 Then 'In case there is a space\n                .Cells(X, 5) = Mid(.Cells(X, 4), POS1, POS2 - POS1)\n            Else 'In case the found value is at end of string\n                .Cells(X, 5) = Right(.Cells(X, 4), Len(.Cells(X, 4)) - (POS1 - 1))\n            End If\n        End If\n        If InStr(1, .Cells(X, 4), \"RITM\") &gt; 0 Then 'Repeat same process for \"RITM\"\n            POS1 = InStr(1, .Cells(X, 4), \"RITM\")\n            POS2 = InStr(POS1, .Cells(X, 4), \" \")\n            If POS2 &gt; 0 Then\n                .Cells(X, 6) = Mid(.Cells(X, 4), POS1, POS2 - POS1)\n            Else\n                .Cells(X, 6) = Right(.Cells(X, 4), Len(.Cells(X, 4)) - (POS1 - 1))\n            End If\n        End If\n    Next X\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Using Copy/Paste would slow down your procedure significantly.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>A better way might be to just use formulas</p>\n\n<p>Type this formula in E2:</p>\n\n<pre><code>=IF(ISNUMBER(SEARCH(\"*REQ0*\",D2)),MID(D2,FIND(\"REQ0\",D2),11),\"\")\n</code></pre>\n\n<p>And put this formula in F2:</p>\n\n<pre><code>=IF(ISNUMBER(SEARCH(\"*RITM*\",D2)),MID(D2,FIND(\"RITM\",D2),11),\"\")\n</code></pre>\n\n<p>Drag both down...    </p>\n"}], "owner": {"reputation": 162, "user_id": 8789482, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10207644192263165/picture?type=large", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/8789482/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 51742346, "answer_count": 1, "score": 0, "last_activity_date": 1561035330, "creation_date": 1533709453, "last_edit_date": 1561035330, "question_id": 51739852, "link": "https://stackoverflow.com/questions/51739852/vba-search-a-string-in-row-then-copy-paste-it-to-a-different-column", "title": "VBA - search a string in row then copy &amp; paste it to a different column", "body": "<p>_As a newby at VBA, I am trying to search for specific strings in a row from column D then copy it and paste that string in a different column.\nI have about 10,000 entries so manually doing it is not efficient.\nStrings I'm looking for are \"REQ0\"s and \"RITM0\"s.</p>\n\n<p>This is my current code:</p>\n\n<pre><code>Option Compare Text\nPublic Sub Search_For()\nDim cursht\n\ncursht = ActiveSheet.Name\nrow_number = 1\n\nDo\n\nrow_number = row_number + 1\nitem_description = Sheets(cursht).Range(\"D\" &amp; row_number)\nitems_copied = Sheets(cursht).Range(\"F\" &amp; row_number)\n\nIf InStr(item_description, \"REQ0\") Then\n    Worksheets(\"cursht\").Row(item_description).Copy\n    items_copied.Paste\nIf InStr(item_description, \"RITM\") Then\n    Worksheets(\"cursht\").Row(item_description).Copy\n    items_copied.Paste\nEnd If\n\nLoop Until items_description = \"\"\n\nEnd Sub\n</code></pre>\n\n<p>Expected results:\n<a href=\"https://i.stack.imgur.com/gcEor.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gcEor.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "api"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 7165746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38d2d684a64e4964c74c236f33dde60e?s=128&d=identicon&r=PG&f=1", "display_name": "mikepop", "link": "https://stackoverflow.com/users/7165746/mikepop"}, "edited": false, "score": 0, "creation_date": 1538113332, "post_id": 51746774, "comment_id": 92037066, "body": "Thank you so much for this! I am going to check it now."}], "tags": [], "owner": {"reputation": 74, "user_id": 7871648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/727b0b2f33699a71d5b8cf04a6d04e0d?s=128&d=identicon&r=PG&f=1", "display_name": "MsAmeen", "link": "https://stackoverflow.com/users/7871648/msameen"}, "is_accepted": true, "score": 0, "last_activity_date": 1533734555, "last_edit_date": 1533734555, "creation_date": 1533731296, "answer_id": 51746774, "question_id": 51739625, "link": "https://stackoverflow.com/questions/51739625/excel-vba-data-source-changing-url/51746774#51746774", "title": "Excel VBA Data Source changing URL", "body": "<p>If you're using Excel 2016 then you can access your query from VBA, check <a href=\"https://gallery.technet.microsoft.com/office/VBA-to-automate-Power-956a52d1\" rel=\"nofollow noreferrer\">This</a> and <a href=\"http://excelunplugged.com/2018/01/23/modifying-power-query-m-code-with-vba/\" rel=\"nofollow noreferrer\">This</a> URLs</p>\n\n<p>The following is my way to do that:-</p>\n\n<p>1- Get the \"Formula\" of the Target query (by Query name; in my example = \"Testing01\"), Use</p>\n\n<pre><code>myStr = ThisWorkbook.Queries.Item(\"Testing01\").Formula\n</code></pre>\n\n<p>2- Change \"myStr\" (to point to your new URL), you can use \"Replace\" function for example.</p>\n\n<p>3- Write back the Modified String to the Query: </p>\n\n<pre><code>ThisWorkbook.Queries.Item(\"Testing01\").Formula = myStr\n</code></pre>\n\n<p>4- Refresh your Connections</p>\n\n<pre><code>For Each conn In ThisWorkbook.Connections\n  conn.Refresh\nNext\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7165746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38d2d684a64e4964c74c236f33dde60e?s=128&d=identicon&r=PG&f=1", "display_name": "mikepop", "link": "https://stackoverflow.com/users/7165746/mikepop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 734, "favorite_count": 0, "accepted_answer_id": 51746774, "answer_count": 1, "score": 0, "last_activity_date": 1594152979, "creation_date": 1533708442, "last_edit_date": 1594152979, "question_id": 51739625, "link": "https://stackoverflow.com/questions/51739625/excel-vba-data-source-changing-url", "title": "Excel VBA Data Source changing URL", "body": "<p>I'm using Excel Connection Query to get data, however, I need to change the URL in the as can be seen in the attached image.</p>\n\n<p><a href=\"https://i.stack.imgur.com/bkQpB.jpg\" rel=\"nofollow noreferrer\">Click here for image</a></p>\n\n<p>how do I access this field in VBA to change just the tracking data? Ive tried to record a macro but i can only seem to refresh it ie;\nActiveWorkbook.Connections( _\n                       \"Query - tracker\").Refresh</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1533706701, "post_id": 51739133, "comment_id": 90438626, "body": "Executable VBA code outside a procedure scope is illegal. Wrap everything under <code>Option Explicit</code> with a <code>Sub</code> statement, e.g. <code>Public Sub DoSomething()</code>"}, {"owner": {"reputation": 1, "user_id": 10195445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61fab47ab0693e7d32d1dcd3e1c6971b?s=128&d=identicon&r=PG&f=1", "display_name": "shreyash", "link": "https://stackoverflow.com/users/10195445/shreyash"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1533708202, "post_id": 51739133, "comment_id": 90439192, "body": "Actually when i put the same code in excel and try to run as macro it works but when i put it outside any excel and try to run via cmd line it gives end of statement error I have tried various stuff to solve but not getting it solved. Thank you  for help but still it is not working"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1533708276, "post_id": 51739133, "comment_id": 90439224, "body": "VBA and vbscript are not the same thing, so maybe that&#39;s the basis of your problem?"}, {"owner": {"reputation": 1, "user_id": 10195445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61fab47ab0693e7d32d1dcd3e1c6971b?s=128&d=identicon&r=PG&f=1", "display_name": "shreyash", "link": "https://stackoverflow.com/users/10195445/shreyash"}, "edited": false, "score": 0, "creation_date": 1533709520, "post_id": 51739133, "comment_id": 90439740, "body": "Okay thanks i will change my code"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1533709522, "post_id": 51739133, "comment_id": 90439742, "body": "VBScript doesn&#39;t have an <code>As</code> keyword, for one. It would help if you knew what language you&#39;re using, and if your question mentioned what statement is errorring. I&#39;m suspecting VBScript and the first <code>As</code> clause in the code."}], "answers": [{"tags": [], "owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "is_accepted": false, "score": 0, "last_activity_date": 1533725264, "creation_date": 1533725264, "answer_id": 51744773, "question_id": 51739133, "link": "https://stackoverflow.com/questions/51739133/expected-end-of-statement-vba-program/51744773#51744773", "title": "expected end of statement vba program", "body": "<p>Untested, but you cannot use VBA code without segmenting it into subprocedures. You should start a statement with <code>Sub (your subname)</code> and close it with <code>End Sub</code> . See below.  </p>\n\n<pre><code>Option Explicit\nSub MyCode\n\nDim FSO\nDim sFile As String\nDim sSFolder As String\nDim sDFolder\nDim anObject As Object\nsFile = \"Filename.xlsm\"\nsSFolder = \"C:\\workspace\"\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\nsDFolder = FSO.GetAbsolutePathName(\"C:\\\") \nIf Not FSO.FileExists(sSFolder &amp; sFile) Then\n    MsgBox \"Specified File Not Found\", vbInformation, \"Not Found\"\nElse\n    FSO.CopyFile (sSFolder &amp; sFile), sDFolder, True\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 10123319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ArPkz.jpg?s=128&g=1", "display_name": "Shoeless", "link": "https://stackoverflow.com/users/10123319/shoeless"}, "is_accepted": false, "score": 0, "last_activity_date": 1533749571, "creation_date": 1533749571, "answer_id": 51752519, "question_id": 51739133, "link": "https://stackoverflow.com/questions/51739133/expected-end-of-statement-vba-program/51752519#51752519", "title": "expected end of statement vba program", "body": "<p>One change I would make to your code (I would have made this a comment but I don't have enough points to do so, so apologies):</p>\n\n<p>sFile = \"Filename.xlsm\"</p>\n\n<p>sSFolder = \"C:\\workspace\\\"</p>\n\n<p>You are going to be looking otherwise for a file called  C:\\workspaceFilename.xlsm</p>\n"}], "owner": {"reputation": 1, "user_id": 10195445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61fab47ab0693e7d32d1dcd3e1c6971b?s=128&d=identicon&r=PG&f=1", "display_name": "shreyash", "link": "https://stackoverflow.com/users/10195445/shreyash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1533749571, "creation_date": 1533705886, "last_edit_date": 1533715461, "question_id": 51739133, "link": "https://stackoverflow.com/questions/51739133/expected-end-of-statement-vba-program", "title": "expected end of statement vba program", "body": "<p>I am trying to copy an excel file from a different folder to the folder in which this script is saved/present. I am getting an \"Expected End of Statement\" error in my code below, can someone please help.</p>\n\n<pre><code>Option Explicit\n\nDim FSO\nDim sFile As String\nDim sSFolder As String\nDim sDFolder\nDim anObject As Object\nsFile = \"Filename.xlsm\"\nsSFolder = \"C:\\workspace\"\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\nsDFolder = FSO.GetAbsolutePathName(\"C:\\\") \nIf Not FSO.FileExists(sSFolder &amp; sFile) Then\n    MsgBox \"Specified File Not Found\", vbInformation, \"Not Found\"\nElse\n    FSO.CopyFile (sSFolder &amp; sFile), sDFolder, True\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1533744877, "post_id": 51738915, "comment_id": 90462333, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/24372849/type-mismatch-in-mailitem-loop\">Type Mismatch in mailitem loop</a>"}], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1533709546, "creation_date": 1533709546, "answer_id": 51739881, "question_id": 51738915, "link": "https://stackoverflow.com/questions/51738915/runtime-error-13-type-mismatch/51739881#51739881", "title": "Runtime error &#39;13&#39; type mismatch", "body": "<p>Your code does not make much sense - you are creating a new message (oMail), but you never do anything with it. You just use the variable declaration to loop over <em>all</em> items in the Inbox. Since it is declared as <code>MailItem</code>, it blows up when it encounters an item of a type other than MailItem (such as <code>ReportItem</code> or <code>MeetingItem</code>).</p>\n\n<p>Use <code>NewMailEx</code> event instead - it passes the new message's entry id as the parameter. Use it to call <code>Namespace.GetItemFromID</code>.</p>\n"}], "owner": {"reputation": 9, "user_id": 9321374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c24705db784787ef621c631b4403fb30?s=128&d=identicon&r=PG&f=1", "display_name": "sachindra", "link": "https://stackoverflow.com/users/9321374/sachindra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 181, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1592945154, "creation_date": 1533704420, "last_edit_date": 1592945154, "question_id": 51738915, "link": "https://stackoverflow.com/questions/51738915/runtime-error-13-type-mismatch", "title": "Runtime error &#39;13&#39; type mismatch", "body": "<p>I created a macro to download attachments form the outlook whenever we receive a new mail, but I am getting error as \"Run time Error '13' Type mismatch \" and below is the code am using.</p>\n\n<p>Can anyone please help me in resolving this.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Application_NewMail()\n\nDim onamespace As Outlook.NameSpace\nSet onamespace = Outlook.GetNamespace(\"MAPI\")\n\nDim myfol As Outlook.Folder\nSet myfol = onamespace.GetDefaultFolder(olFolderInbox)\n\nDim omail As Outlook.MailItem\nSet omail = Outlook.CreateItem(olMailItem)\n\nDim Atmt As Outlook.Attachment\n\nFor Each omail In myfol.Items\n\n If omail.SenderEmailAddress = \"sacchu693@gmail.com\" Then\n\n  For Each Atmt In omail.Attachments\n\n           Atmt.SaveAsFile \"Z:\\True_ID\\46 RSA\\\" &amp; Atmt.FileName\n\n        Next\n        Else\n        End If\n\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "image", "runtime-error", "activex"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1533704965, "post_id": 51738845, "comment_id": 90438096, "body": "The answer is in the question: &quot;Is there something simple I can add to my code so that <b>if</b> you cancel out it doesn&#39;t cause an error?&quot; - you can&#39;t just blindly pass <code>Application.GetOpenFilename</code> to <code>LoadPicture</code>, you need to make that <i>conditional</i> to the dialog not being cancelled."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4101530, "user_type": "registered", "profile_image": "https://graph.facebook.com/552234776/picture?type=large", "display_name": "Peter Peazy Littlefield", "link": "https://stackoverflow.com/users/4101530/peter-peazy-littlefield"}, "edited": false, "score": 0, "creation_date": 1533771734, "post_id": 51739059, "comment_id": 90473535, "body": "Thanks for the quick answer, Mathieu. Now I&#39;m getting RunTime Error 424?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 31, "user_id": 4101530, "user_type": "registered", "profile_image": "https://graph.facebook.com/552234776/picture?type=large", "display_name": "Peter Peazy Littlefield", "link": "https://stackoverflow.com/users/4101530/peter-peazy-littlefield"}, "edited": false, "score": 0, "creation_date": 1533775425, "post_id": 51739059, "comment_id": 90474230, "body": "@Peter sorry, not sure how that happened - forgot the <code>Set</code> keyword there."}, {"owner": {"reputation": 31, "user_id": 4101530, "user_type": "registered", "profile_image": "https://graph.facebook.com/552234776/picture?type=large", "display_name": "Peter Peazy Littlefield", "link": "https://stackoverflow.com/users/4101530/peter-peazy-littlefield"}, "edited": false, "score": 0, "creation_date": 1533790137, "post_id": 51739059, "comment_id": 90477171, "body": "Sorry to keep bugging you but I&#39;m still getting the same 424 RunTime error even with the set added."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 31, "user_id": 4101530, "user_type": "registered", "profile_image": "https://graph.facebook.com/552234776/picture?type=large", "display_name": "Peter Peazy Littlefield", "link": "https://stackoverflow.com/users/4101530/peter-peazy-littlefield"}, "edited": false, "score": 0, "creation_date": 1533817954, "post_id": 51739059, "comment_id": 90492831, "body": "My bad, OLE picture isn&#39;t an object apparently. A variant should work (remove the Set keywords). Also note that you can only load .gif,.jpg, or .bmp image formats."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1533817877, "last_edit_date": 1533817877, "creation_date": 1533705468, "answer_id": 51739059, "question_id": 51738845, "link": "https://stackoverflow.com/questions/51738845/activex-image-box-using-double-click-to-load-image-returns-runtime-error-53-if-n/51739059#51739059", "title": "ActiveX Image Box using double click to load image returns RunTime Error 53 if no picture is selected", "body": "<p>Make a little function that returns <code>Empty</code> if no picture is selected:</p>\n\n<pre><code>Private Function GetUserSelectedPicture() As Variant\n    Dim path As Variant\n    path = Application.GetOpenFilename 'returns a Boolean if cancelled\n    If VarType(path) &lt;&gt; vbBoolean Then\n        GetUserSelectedPicture = LoadPicture(path)\n    End If\nEnd Function\n</code></pre>\n\n<p>Then update your handlers to invoke it:</p>\n\n<pre><code>Image1.Picture = GetUserSelectedPicture\n</code></pre>\n\n<p>Note that it will fail to load certain image formats, such as .png.</p>\n"}], "owner": {"reputation": 31, "user_id": 4101530, "user_type": "registered", "profile_image": "https://graph.facebook.com/552234776/picture?type=large", "display_name": "Peter Peazy Littlefield", "link": "https://stackoverflow.com/users/4101530/peter-peazy-littlefield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533817877, "creation_date": 1533703950, "question_id": 51738845, "link": "https://stackoverflow.com/questions/51738845/activex-image-box-using-double-click-to-load-image-returns-runtime-error-53-if-n", "title": "ActiveX Image Box using double click to load image returns RunTime Error 53 if no picture is selected", "body": "<p>I have a spreadsheet with 4 ActiveX Image boxes with some code that opens a file window if you double click on the box to load a picture into it but if you double click on the box but then choose not to add a photo and hit cancel it returns RunTime Error: 53. Is there something simple I can add to my code so that if you cancel out it doesn't cause an error? Code below.</p>\n\n<pre><code> Private Sub Image1_DblClick(ByVal Cancel As MSForms.ReturnBoolean)\n     Image1.Picture = LoadPicture(Application.GetOpenFilename)\n End Sub\n\n Private Sub Image2_DblClick(ByVal Cancel As MSForms.ReturnBoolean)\n     Image2.Picture = LoadPicture(Application.GetOpenFilename)\n End Sub\n\n Private Sub Image3_DblClick(ByVal Cancel As MSForms.ReturnBoolean)\n     Image3.Picture = LoadPicture(Application.GetOpenFilename)\n End Sub\n\n Private Sub Image4_DblClick(ByVal Cancel As MSForms.ReturnBoolean)\n     Image4.Picture = LoadPicture(Application.GetOpenFilename)\n End Sub\n</code></pre>\n\n<p>Any help would be much appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 194, "user_id": 8978777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c516087c61b368e673e81440bf15519?s=128&d=identicon&r=PG&f=1", "display_name": "Kajkrow", "link": "https://stackoverflow.com/users/8978777/kajkrow"}, "edited": false, "score": 1, "creation_date": 1533709327, "post_id": 51738572, "comment_id": 90439648, "body": "Welcome to SO. Sadly we are a supporting community and not a &quot;we do your work&quot;-community. What have you tried so far? Where did you get stuck? Do you have any code you can share with us?"}, {"owner": {"reputation": 1, "user_id": 10195289, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157219795453521/picture?type=large", "display_name": "Nicholas Pegios", "link": "https://stackoverflow.com/users/10195289/nicholas-pegios"}, "reply_to_user": {"reputation": 194, "user_id": 8978777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c516087c61b368e673e81440bf15519?s=128&d=identicon&r=PG&f=1", "display_name": "Kajkrow", "link": "https://stackoverflow.com/users/8978777/kajkrow"}, "edited": false, "score": 0, "creation_date": 1533710602, "post_id": 51738572, "comment_id": 90440244, "body": "Yes i understand, just wanted to get some pointers, didnt expect someone to do it for me. here is what i have done so far.....Private Sub Worksheet_Change(ByVal Target As Range)  If IsNumeric(Range(&quot;B4:F4&quot;)) = True Then  Range(&quot;B5&quot;).Locked = False  End If     End Sub"}, {"owner": {"reputation": 194, "user_id": 8978777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c516087c61b368e673e81440bf15519?s=128&d=identicon&r=PG&f=1", "display_name": "Kajkrow", "link": "https://stackoverflow.com/users/8978777/kajkrow"}, "edited": false, "score": 1, "creation_date": 1533713883, "post_id": 51738572, "comment_id": 90442116, "body": "Please edit your question to post your code. If you have problems with formatting I will edit your question and make it look properly."}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1533717060, "post_id": 51738572, "comment_id": 90443993, "body": "I Downvoted/voted to close because you didn&#39;t include a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> , it looks like <a href=\"http://idownvotedbecau.se/noattempt/\" rel=\"nofollow noreferrer\">no attempt was made</a>, and it looks like <a href=\"http://idownvotedbecau.se/noresearch/\" rel=\"nofollow noreferrer\">no research</a> was done."}, {"owner": {"reputation": 194, "user_id": 8978777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c516087c61b368e673e81440bf15519?s=128&d=identicon&r=PG&f=1", "display_name": "Kajkrow", "link": "https://stackoverflow.com/users/8978777/kajkrow"}, "edited": false, "score": 0, "creation_date": 1533717448, "post_id": 51738572, "comment_id": 90444254, "body": "You are totally right, but sometimes ppl just need a push in the right direction. I wanted to give him a chance to improve as in my opinion a bad is not good, but the opportunity to make it better with some help. I assume that you edited the question."}], "answers": [{"tags": [], "owner": {"reputation": 194, "user_id": 8978777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c516087c61b368e673e81440bf15519?s=128&d=identicon&r=PG&f=1", "display_name": "Kajkrow", "link": "https://stackoverflow.com/users/8978777/kajkrow"}, "is_accepted": false, "score": 0, "last_activity_date": 1533717527, "creation_date": 1533717527, "answer_id": 51742208, "question_id": 51738572, "link": "https://stackoverflow.com/questions/51738572/vba-check-for-text-or-number/51742208#51742208", "title": "VBA - check for text or number", "body": "<p>So... I made an attempt to help you.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal target As Range)\nConst inputrange As String = \"B4:F4\"\nConst lockrange As String = \"B5:F5\"\nConst lockedworksheet As String = \"Tabelle2\"\n\nSet insect = Application.Intersect(target, Range(lockrange))\nIf Not (insect Is Nothing) Then Exit Sub\nWorksheets(lockedworksheet).Unprotect\nRange(inputrange).Locked = False\nRange(lockrange).Locked = True\nFor Each cell In Range(inputrange)\n    If IsNumeric(cell.Value) And cell.Value &lt;&gt; 0 Then _\n        Cells(cell.Row + 1, cell.Column).Locked = False Else _\n            Cells(cell.Row + 1, cell.Column).Value = \"\"\nNext cell\nWorksheets(lockedworksheet).Protect\nEnd Sub\n</code></pre>\n\n<p>If you need an explanation, just ask.</p>\n"}], "owner": {"reputation": 1, "user_id": 10195289, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157219795453521/picture?type=large", "display_name": "Nicholas Pegios", "link": "https://stackoverflow.com/users/10195289/nicholas-pegios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1533717527, "creation_date": 1533702152, "last_edit_date": 1533717135, "question_id": 51738572, "link": "https://stackoverflow.com/questions/51738572/vba-check-for-text-or-number", "title": "VBA - check for text or number", "body": "<p>I am creating a spreadsheet that a user will fill in specific cells with data/text.</p>\n\n<p>the whole sheet will be locked to prevent one from changing things.</p>\n\n<p>i want as the first cell B4 to always be unlocked and has data entered in, this then unlocks cell B5 for data entry. this will continue on for many more cells.</p>\n\n<p>here is what i have done so far.....</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range) \n\n    If IsNumeric(Range(\"B4:F4\")) = True Then \n        Range(\"B5\").Locked = False \n    End If \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1533699909, "post_id": 51738225, "comment_id": 90436913, "body": "You need to qualify <code>Cells</code> and <code>Rows</code> with the worksheet they are referring to otherwise you&#39;re implicitly using the <code>ActiveSheet</code>."}], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 2972137, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/55203fabd31b1c946c7c983d741e30df?s=128&d=identicon&r=PG&f=1", "display_name": "Nian", "link": "https://stackoverflow.com/users/2972137/nian"}, "edited": false, "score": 0, "creation_date": 1533699041, "post_id": 51738238, "comment_id": 90436743, "body": "&quot;Set copyrange = ws2.Application.Range(Cells(i, 2), Cells(i, 6)).Copy&quot; Set has been used in this line"}, {"owner": {"reputation": 183, "user_id": 2972137, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/55203fabd31b1c946c7c983d741e30df?s=128&d=identicon&r=PG&f=1", "display_name": "Nian", "link": "https://stackoverflow.com/users/2972137/nian"}, "edited": false, "score": 0, "creation_date": 1533699351, "post_id": 51738238, "comment_id": 90436804, "body": "May i know what brackets are you talking about? Can you show me?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9617878"}, "is_accepted": false, "score": 0, "last_activity_date": 1533698972, "creation_date": 1533698972, "answer_id": 51738238, "question_id": 51738225, "link": "https://stackoverflow.com/questions/51738225/excel-vba-run-time-error-424-object-required/51738238#51738238", "title": "Excel VBA run-time Error &#39;424&#39; Object Required", "body": "<p>Try adding the word <code>set</code> on the line where it throws error. \nExample: <code>set x = 'something</code></p>\n"}, {"comments": [{"owner": {"reputation": 183, "user_id": 2972137, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/55203fabd31b1c946c7c983d741e30df?s=128&d=identicon&r=PG&f=1", "display_name": "Nian", "link": "https://stackoverflow.com/users/2972137/nian"}, "edited": false, "score": 0, "creation_date": 1533700548, "post_id": 51738340, "comment_id": 90437056, "body": "Thank you so much man, it worked. Now i learnt something, i will make that changes to my code, thanks for the advice once again."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1533701351, "post_id": 51738340, "comment_id": 90437213, "body": "Mathieu, can you clarify a little more? Is it bad because using <code>Application.Range</code> bypasses the Workbook Object and Worksheet Object, thus the Range will be selected on which ever worksheet is currently active?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 2, "creation_date": 1533702415, "post_id": 51738340, "comment_id": 90437443, "body": "@GMalc <code>Application.Range</code> is implicitly <code>Application.ActiveSheet.Range</code>. <code>Range</code> as a member call, is always a member of a <code>Worksheet</code> object. Good code makes that <code>Worksheet</code> explicit ;-)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 3, "last_activity_date": 1533699952, "creation_date": 1533699952, "answer_id": 51738340, "question_id": 51738225, "link": "https://stackoverflow.com/questions/51738225/excel-vba-run-time-error-424-object-required/51738340#51738340", "title": "Excel VBA run-time Error &#39;424&#39; Object Required", "body": "<pre><code>Set copyrange = ws2.Application.Range(Cells(i, 2), Cells(i, 6)).Copy\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-copy-method-excel?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\"><code>Range.Copy</code></a> does not return a <code>Range</code> object reference that you can assign to a <code>Range</code> object variable. It's a member method that takes the contents of a range, and copies it into the clipboard.</p>\n\n<p>Your <code>copyrange</code> isn't the result of the <code>.Copy</code> operation, it's the result of a <code>ws2.Application.Range(...)</code> call... which is malformed.</p>\n\n<p>This <em>might</em> fix it<sup>1</sup>:</p>\n\n<pre><code>Set copyrange = ws2.Application.Range(Cells(i, 2), Cells(i, 6))\ncopyrange.Copy\n</code></pre>\n\n<p>....and this is what you probably <em>meant</em> to be doing:</p>\n\n<pre><code>Set copyrange = ws2.Range(ws2.Cells(i, 2), ws2.Cells(i, 6))\ncopyrange.Copy\n</code></pre>\n\n<hr>\n\n<p><sup>1</sup> it's bad code, because you have an explicit <code>Worksheet</code> reference (<code>ws2</code>), and from there you go to <code>Application</code> to grab whatever worksheet is currently active, and work off that - so you <em>think</em> you're working off <code>ws2</code> when in reality you're working off whatever <code>ActiveSheet</code> currently happens to be. Same with the unqualified <code>Cells</code> calls, which implicitly refer to <code>Application.ActiveSheet.Cells</code>.</p>\n"}], "owner": {"reputation": 183, "user_id": 2972137, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/55203fabd31b1c946c7c983d741e30df?s=128&d=identicon&r=PG&f=1", "display_name": "Nian", "link": "https://stackoverflow.com/users/2972137/nian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1000, "favorite_count": 0, "accepted_answer_id": 51738340, "answer_count": 2, "score": 0, "last_activity_date": 1533699952, "creation_date": 1533698862, "question_id": 51738225, "link": "https://stackoverflow.com/questions/51738225/excel-vba-run-time-error-424-object-required", "title": "Excel VBA run-time Error &#39;424&#39; Object Required", "body": "<p>I've encountered a problem run-time Error '424' object required.\nThis is the solution i've acquired from my previous post, after spending some time to troubleshoot, i still can't solve it. Thanks to @rawrplus for the solution and I am still learning Excel vba.</p>\n\n<p><strong><em>Link:</em></strong> <a href=\"https://stackoverflow.com/questions/51650643/excel-vba-cutting-rows-from-workbook1-and-paste-it-in-workbook2/51653150?noredirect=1#comment90365313_51653150\">Excel VBA Cutting rows from workbook1 and paste it in workbook2</a></p>\n\n<pre><code>Option Explicit\nPrivate Sub table_to_table()\n'Declaration\nDim wb1 As Workbook\nDim wb2 As Workbook\nDim ws1 As Worksheet\nDim ws2 As Worksheet\nSet wb1 = Workbooks.Open(\"C:\\Documents and Settings\\lye.yan.nian\\My  Documents\\testingmacro2.xlsx\")\nSet wb2 = Workbooks.Open(\"C:\\Documents and Settings\\lye.yan.nian\\My Documents\\testingmacro3.xlsx\")\nSet ws1 = wb1.Sheets(\"Test2\")\nSet ws2 = wb2.Sheets(\"Test1\")\n\nDim res_lr As Long\nDim lr2 As Long\nlr2 = ws2.Cells(Rows.Count, 2).End(xlUp).Row\n\n\nMsgBox lr2   /* Testing is done as i can get this value */\n\nDim r As Range, ary\nSet r = ws1.Application.Range(Cells(1, 2), Cells(1, 6)) /* Tested working as i can get this value too*/\nary = Application.Transpose(Application.Transpose(r.Value))\nMsgBox Join(ary, \" \")\n\n\nDim copyrange As Range\nDim i As Long /* This is declared */\nFor i = 2 To lr2\n\nMsgBox i /* i did some testing on this and removed the below code */\nSet copyrange = ws2.Application.Range(Cells(i, 2), Cells(i, 6)).Copy /* This is the part where i got the error i can't figure out why*/ \n\nres_lr = ws2.Cells(Rows.Count, 8).End(xlUp).Row\nws2.Range(Cells(res_lr, 8), Cells(res_lr, 12)).PasteSpecial xlPasteValues\n\nSet copyrange = ws1.Application.Range(Cells(i, 2), Cells(i, 6)).Copy\n\nws2.Range(Cells(res_lr + 1, 8), Cells(res_lr + 1, 12)).PasteSpecial xlPasteValues\n\nNext i\n\nwb1.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "msgbox"], "answers": [{"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 0, "last_activity_date": 1533700128, "creation_date": 1533700128, "answer_id": 51738357, "question_id": 51738115, "link": "https://stackoverflow.com/questions/51738115/vba-msgbox-pop-up-according-to-cell-value/51738357#51738357", "title": "VBA MsgBox pop-up according to cell value", "body": "<p>Just include all the tests in the event sequentially.</p>\n\n<p>This code will also handle more than one cell changing at once (ie <code>Target</code> containing more than one cell), which your original code won't</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim A As Range\n\n    Set A = Me.Range(\"D5\")\n    If Not Intersect(Target, A) Is Nothing Then\n        If A = \"Yes\" Then\n            MsgBox \"Message for D5\"\n        End If\n    End If\n\n    Set A = Me.Range(\"B5\")\n    If Not Intersect(Target, A) Is Nothing Then\n        If A = \"No\" Then\n            MsgBox \"Message for B5\"\n        End If\n    End If\n\n    Set A = Me.Range(\"B13\")\n    If Not Intersect(Target, A) Is Nothing Then\n        If A = \"Submit form\" Then\n            MsgBox \"Message for B13\"\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10195029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75e82245e50676de82f70b96c0067353?s=128&d=identicon&r=PG&f=1", "display_name": "IttookJohnLee", "link": "https://stackoverflow.com/users/10195029/ittookjohnlee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 51738357, "answer_count": 1, "score": 0, "last_activity_date": 1533700128, "creation_date": 1533697843, "last_edit_date": 1533699713, "question_id": 51738115, "link": "https://stackoverflow.com/questions/51738115/vba-msgbox-pop-up-according-to-cell-value", "title": "VBA MsgBox pop-up according to cell value", "body": "<p>I'm trying to set up a spreadsheet to return a message box whenever a cell value is entered, I have the code below which works fine for just 1 cell.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim A As Range\n    Set A = Range(\"D5\")\n    If Intersect(Target, A) Is Nothing Then Exit Sub\n    If Target.Value = \"Yes\" Then\n        MsgBox \"Message\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>I need to have a <code>MsgBox</code> pop up whenever either of these 3 are met: <code>D5=\"Yes\"</code>, <code>B5=\"No\"</code> and <code>B13=\"Submit form\"</code>, however I can't make it pop up for more than 1 cell at a given time either writing in one module or 3 separate ones. Each one of the Boxes for each one of those cells should return a different message, i.e., D5=\"Yes\" MsgBox \"Please fill out...\" or B5=\"No\" MsgBox \"Submit Form\"</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1533701556, "post_id": 51737746, "comment_id": 90437247, "body": "Can you provide a data sample that reproduces the problem?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1533704854, "post_id": 51737746, "comment_id": 90438058, "body": "Does your sheet name now have spaces?  If yes it needs to be in single quotes."}, {"owner": {"reputation": 1, "user_id": 10194879, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-i90Orrnt_14/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pjDKyuzw5xRbJMEkOCHroX8_KhlQ/mo/photo.jpg?sz=128", "display_name": "nil nil", "link": "https://stackoverflow.com/users/10194879/nil-nil"}, "edited": false, "score": 0, "creation_date": 1533711199, "post_id": 51737746, "comment_id": 90440544, "body": "Thanks Tim, I removed spaces in one sheet, It seems to work now"}], "owner": {"reputation": 1, "user_id": 10194879, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-i90Orrnt_14/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pjDKyuzw5xRbJMEkOCHroX8_KhlQ/mo/photo.jpg?sz=128", "display_name": "nil nil", "link": "https://stackoverflow.com/users/10194879/nil-nil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533695818, "creation_date": 1533694765, "last_edit_date": 1533695818, "question_id": 51737746, "link": "https://stackoverflow.com/questions/51737746/chart-vba-suddenly-getting-error-1004", "title": "Chart vba suddenly getting error 1004?", "body": "<p>I wrote a piece of VBA code that was working before, but it gets error 1004 on name/xvalue/value recently. I am using excel 2010.</p>\n\n<pre><code>Sub LineChartTemp()\n\n    Dim i As Integer, j As Integer, k As Integer\n'    i = series, j = start row, k = end row\n\n    ActiveSheet.Shapes.AddChart.Select\n    ActiveChart.ChartType = xlLine\n\n    Dim chart As chart\n    Set chart = ActiveChart\n\n    For i = 1 To 156\n        j = (i - 1) * 13 + 1 + 1\n        k = j + 12\n\n'        two 1, one for name row, one for the minus 1, 13 is number of data points of each series\n\n        chart.SeriesCollection.NewSeries\n        chart.SeriesCollection(i).Name = \"=\" &amp; ActiveSheet.Name &amp; \"!$A$\" &amp; j &amp; \":$C$\" &amp; j\n        chart.SeriesCollection(i).XValues = \"=\" &amp; ActiveSheet.Name &amp; \"!$D$\" &amp; j &amp; \":$D$\" &amp; k\n        chart.SeriesCollection(i).Values = \"=\" &amp; ActiveSheet.Name &amp; \"!$E$\" &amp; j &amp; \":$E$\" &amp; k\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["string", "vba", "excel", "data-cleaning"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1533694247, "post_id": 51737636, "comment_id": 90435873, "body": "You could go <code>Data</code> &gt; <code>Text To Columns</code> and split it into separate columns using <code>@</code> as a <b>delimiter</b>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1533695416, "post_id": 51737636, "comment_id": 90436084, "body": "Please read <a href=\"https://meta.stackoverflow.com/q/284236/1188513\"><i>Why is \u201cCan someone help me?\u201d not an actual question?</i></a>."}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1533717190, "post_id": 51737636, "comment_id": 90444088, "body": "@simon: Welcome to Stack Overflow: Please <a href=\"https://stackoverflow.com/tour\">take the tour</a> and read <a href=\"https://stackoverflow.com/help/how-to-ask\">How to ask a good question</a>, then edit your question to include the code, expected behaviour, and what is wrong... then we can try to help"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1533717208, "post_id": 51737636, "comment_id": 90444097, "body": "I Downvoted/voted to close because you didn&#39;t include a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> , it looks like <a href=\"http://idownvotedbecau.se/noattempt/\" rel=\"nofollow noreferrer\">no attempt was made</a>, and it looks like <a href=\"http://idownvotedbecau.se/noresearch/\" rel=\"nofollow noreferrer\">no research</a> was done."}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1533717249, "post_id": 51737636, "comment_id": 90444126, "body": "@simon: please show us <a href=\"https://mattgemmell.com/what-have-you-tried/\" rel=\"nofollow noreferrer\">what you have tried</a>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4423179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbed07ac11fed140be7800795ef3fc65?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/4423179/simon"}, "edited": false, "score": 0, "creation_date": 1533739459, "post_id": 51738016, "comment_id": 90458865, "body": "Thank you, this works partially. This splits every string with a space before the first @ delimiter. So &quot;text text @string@.&quot; splits &quot;string&quot; correctly but for &quot;text text@string@.&quot; nothing is split."}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "reply_to_user": {"reputation": 21, "user_id": 4423179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbed07ac11fed140be7800795ef3fc65?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/4423179/simon"}, "edited": false, "score": 0, "creation_date": 1533741258, "post_id": 51738016, "comment_id": 90460065, "body": "I depended on your first example .. Try tweaking that to suit your needs"}], "tags": [], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "is_accepted": false, "score": 0, "last_activity_date": 1533697085, "creation_date": 1533697085, "answer_id": 51738016, "question_id": 51737636, "link": "https://stackoverflow.com/questions/51737636/vba-excel-extract-multiple-strings-between-symbols-in-cell/51738016#51738016", "title": "VBA/excel extract multiple strings between symbols in cell", "body": "<p>Try this code</p>\n\n<pre><code>Sub Test()\nDim a, x, i As Long, ii As Long\n\na = Range(\"A1:A\" &amp; Cells(Rows.Count, 1).End(xlUp).Row).Value\n\nFor i = LBound(a) To UBound(a)\n    x = Split(a(i, 1), \" @\")\n    For ii = 1 To UBound(x)\n        Cells(i, ii + 1).Value = Mid(x(ii), 1, InStr(x(ii), \"@\") - 1)\n    Next ii\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4423179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbed07ac11fed140be7800795ef3fc65?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/4423179/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 802, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1533738390, "creation_date": 1533693731, "last_edit_date": 1533738390, "question_id": 51737636, "link": "https://stackoverflow.com/questions/51737636/vba-excel-extract-multiple-strings-between-symbols-in-cell", "title": "VBA/excel extract multiple strings between symbols in cell", "body": "<p>I have a spreadsheet with multiple cells with a bunch of text in them. Within the text are a few words/sentences between @ symbols. There are multiple of these strings in each cell. </p>\n\n<p>So for example:</p>\n\n<p>Lorem ipsum dolor sit amet, <strong>@consectetur adipiscing elit@</strong>. Curabitur sapien nibh, faucibus ut odio ut, vehicula elementum nunc. <strong>@Fusce consequat risus vel dui tincidunt@</strong> condimentum.</p>\n\n<p>I need a solution to extract the @...@ strings, let's say into the adjacent column.</p>\n\n<p>Edit to respond to comments: No solution could be attempt fully yet before making this post as I didn't know how to start - the main challenge seems to be around multiple @...@ strings in the text.</p>\n\n<p>Other solutions I researched did not seem to work with multiple delimiters:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/7293461/excel-vba-extract-text-between-2-characters\">excel vba- extract text between 2 characters</a></p>\n\n<p>Any solutions are appreciated.</p>\n\n<p>Thanks </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1533690210, "post_id": 51737269, "comment_id": 90435138, "body": "Are there worksheet errors (e.g. #N/a, #DIV/0!, etc) in those columns? (F5, Special, Errors)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1533692035, "post_id": 51737269, "comment_id": 90435453, "body": "Maybe try <code>Sheets(&quot;SH1&quot;).Range(&quot;A1:E4&quot;)</code> without the <code>.Value</code>  Seems like this might be more easily implemented as a Vlookup though?  You also need to dimension <code>FinArray()</code>  before you can populate it."}, {"owner": {"reputation": 25, "user_id": 10189455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e1a6e298d6572cfd58463f32e57d79?s=128&d=identicon&r=PG&f=1", "display_name": "Gabba48", "link": "https://stackoverflow.com/users/10189455/gabba48"}, "edited": false, "score": 0, "creation_date": 1533747830, "post_id": 51737269, "comment_id": 90463937, "body": "Thanks for looking! I don&#39;t have any errors on the sheet. The code didn&#39;t get far enough to modify any cell values.   I think FinArray is Dimensioned the same as DepArray? See Dim line.  I prefer to use Index(Match()) generally, on my spreadsheets. And even if it could be done easier with Vlookup in this case, I&#39;d like to learn how to properly execute Index(Match()) in VBA.  Thanks Again"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1533748094, "post_id": 51737269, "comment_id": 90464059, "body": "<i>I think I&#39;m getting the Match() right because now the error shows on line MsgBox y(i)</i> that&#39;s because <code>y</code> is not an array. The <code>Match</code> function returns a variant, but only a single value. <code>MsgBox y</code> <i>should</i> work, unless the <code>Match</code> returned an error value. You could examine this with a breakpoint on that line and looking at <code>y</code> in the Locals window of the VBE."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10189455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e1a6e298d6572cfd58463f32e57d79?s=128&d=identicon&r=PG&f=1", "display_name": "Gabba48", "link": "https://stackoverflow.com/users/10189455/gabba48"}, "edited": false, "score": 1, "creation_date": 1533751083, "post_id": 51752244, "comment_id": 90465626, "body": "Thanks, David. I think we&#39;re close! I actually chose to use CDbl because the Index() function looks for type Double for argument 2.   I&#39;m getting the correct value in the box when FinArray(i) shows: <code>FinArray(i) = Application.WorksheetFunction.Index(Sheets(&quot;Sheet1&quot;).Range(&quot;&zwnj;&#8203;A1:E4&quot;).Value, y, 5) MsgBox FinArray(i)</code>  But then, no matter what I change the values to or how I set the cell formatting I get 12:00:00 AM in the cell when it outputs:  <code>StartDate = Application.WorksheetFunction.Max(FinArray) Target.Offset(0, 1).Value = StartDate</code>  StartDate is dimensioned as a Date"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 25, "user_id": 10189455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e1a6e298d6572cfd58463f32e57d79?s=128&d=identicon&r=PG&f=1", "display_name": "Gabba48", "link": "https://stackoverflow.com/users/10189455/gabba48"}, "edited": false, "score": 0, "creation_date": 1533751887, "post_id": 51752244, "comment_id": 90466063, "body": "@Gabba48 put a breakpoint on that line, then use the Locals window to examine the actual value of <code>StartDate</code>? What does it show?"}, {"owner": {"reputation": 25, "user_id": 10189455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e1a6e298d6572cfd58463f32e57d79?s=128&d=identicon&r=PG&f=1", "display_name": "Gabba48", "link": "https://stackoverflow.com/users/10189455/gabba48"}, "edited": false, "score": 0, "creation_date": 1533751894, "post_id": 51752244, "comment_id": 90466070, "body": "Okay wait. I think I can get this. Max(FinArray) is taking the max position, not the max value. So it&#39;s taking the last spot in the array which is initialized to 0 or something."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 25, "user_id": 10189455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e1a6e298d6572cfd58463f32e57d79?s=128&d=identicon&r=PG&f=1", "display_name": "Gabba48", "link": "https://stackoverflow.com/users/10189455/gabba48"}, "edited": false, "score": 0, "creation_date": 1533751953, "post_id": 51752244, "comment_id": 90466096, "body": "It looks like you don&#39;t dimension <code>FinArray</code> properly, let me look again..."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 25, "user_id": 10189455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e1a6e298d6572cfd58463f32e57d79?s=128&d=identicon&r=PG&f=1", "display_name": "Gabba48", "link": "https://stackoverflow.com/users/10189455/gabba48"}, "edited": false, "score": 0, "creation_date": 1533752025, "post_id": 51752244, "comment_id": 90466140, "body": "Yes, taht&#39;s it. <code>FinArray</code> is declared as Variant, it&#39;s never assigned any value(s). it&#39;s not an array, it&#39;s an empty variant so its value will be <code>0</code>."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 25, "user_id": 10189455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e1a6e298d6572cfd58463f32e57d79?s=128&d=identicon&r=PG&f=1", "display_name": "Gabba48", "link": "https://stackoverflow.com/users/10189455/gabba48"}, "edited": false, "score": 0, "creation_date": 1533752108, "post_id": 51752244, "comment_id": 90466179, "body": "You&#39;ll need to <code>ReDim FinArray(UBound(DepArray))</code> and then make sure you uncomment the line that&#39;s assigning to <code>FinArray(i)</code>."}, {"owner": {"reputation": 25, "user_id": 10189455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e1a6e298d6572cfd58463f32e57d79?s=128&d=identicon&r=PG&f=1", "display_name": "Gabba48", "link": "https://stackoverflow.com/users/10189455/gabba48"}, "edited": false, "score": 0, "creation_date": 1533752341, "post_id": 51752244, "comment_id": 90466307, "body": "Yeah I&#39;d already done some of that. I did <code>Dim FinArray(9) As Variant</code> and removed the commenting. The dynamic nature of assigning it to DepArray is great!  One last question: do I need to reset all variable to nothing? Or are they not stored once it exits? As the columns get updated I don&#39;t want to leave leftovers."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 25, "user_id": 10189455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e1a6e298d6572cfd58463f32e57d79?s=128&d=identicon&r=PG&f=1", "display_name": "Gabba48", "link": "https://stackoverflow.com/users/10189455/gabba48"}, "edited": false, "score": 0, "creation_date": 1533752405, "post_id": 51752244, "comment_id": 90466347, "body": "VBA is &quot;garbage collected&quot; which means that your object variables are trashed once the procedure exits (excepting any <code>Static</code> variables, which you don&#39;t have any of)."}, {"owner": {"reputation": 25, "user_id": 10189455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e1a6e298d6572cfd58463f32e57d79?s=128&d=identicon&r=PG&f=1", "display_name": "Gabba48", "link": "https://stackoverflow.com/users/10189455/gabba48"}, "edited": false, "score": 0, "creation_date": 1533752498, "post_id": 51752244, "comment_id": 90466399, "body": "I&#39;ve learned more in the last 30 min than in 6 hours of googling and trial and error. Thanks a million"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 25, "user_id": 10189455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e1a6e298d6572cfd58463f32e57d79?s=128&d=identicon&r=PG&f=1", "display_name": "Gabba48", "link": "https://stackoverflow.com/users/10189455/gabba48"}, "edited": false, "score": 0, "creation_date": 1533752610, "post_id": 51752244, "comment_id": 90466455, "body": "@Gabba48 here&#39;s one more for ya, a good overview of debugging techniques for VBA: <a href=\"http://www.cpearson.com/excel/debuggingvba.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/debuggingvba.aspx</a>"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1533752196, "last_edit_date": 1533752196, "creation_date": 1533748583, "answer_id": 51752244, "question_id": 51737269, "link": "https://stackoverflow.com/questions/51737269/indexmatch-in-vba-excel-with-formulas-in-cells/51752244#51752244", "title": "Index(Match()) in VBA Excel with Formulas in Cells", "body": "<p>This line creates <code>DepArray</code> as an array of string:</p>\n\n<pre><code>DepArray = Split(Target, \",\")\n</code></pre>\n\n<p>Because <code>Split</code> returns a string array.</p>\n\n<p>Later, when you do:</p>\n\n<pre><code>y = Application.Match(DepArray(i), Sheets(\"Sheet1\").Range(\"A1:A4\").Value, 0)\n</code></pre>\n\n<p>The <code>Match</code> function returns the 1004 error because there is no value of <code>\"1\"</code> in that range, instead there's a value of <code>1</code>!</p>\n\n<p>You could probably resolve by casting to long/integer:</p>\n\n<pre><code>Dim valueToMatch as Long\nvalueToMatch = CLng(DepArray(i))\ny = Application.Match(valueToMatch, Sheets(\"Sheet1\").Range(\"A1:A4\").Value, 0)\n</code></pre>\n\n<p>It's also usually a good idea to trap errors, like:</p>\n\n<pre><code>If IsError(y) Then\n    MsgBox \"Unable to find \" &amp; CStr(valueToMatch)\n    ' Exit sub, or go to next iteration, etc.\nEnd If\n</code></pre>\n\n<p>You also need to <code>ReDim</code> the <code>FinArray</code>, after this line:</p>\n\n<pre><code>x = UBound(DepArray)\nReDim FinArray(x)\n</code></pre>\n\n<p>And uncomment the line that assigns values into this array, otherwise it remains an <code>Empty</code> variant, and <code>Max(Empty)</code> will return <code>0</code> every time :D</p>\n\n<p>Also, you need to do <code>Application.EnableEvents = False</code> at the beginning of your procedure and then <code>Application.EnableEvents = True</code> at the end of the procedure, in order to avoid possible infinite loop, since  <code>Target.Offset(0, 1).Value = StartDate</code> will trigger the <code>Change</code> event :)</p>\n"}], "owner": {"reputation": 25, "user_id": 10189455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e1a6e298d6572cfd58463f32e57d79?s=128&d=identicon&r=PG&f=1", "display_name": "Gabba48", "link": "https://stackoverflow.com/users/10189455/gabba48"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 529, "favorite_count": 0, "accepted_answer_id": 51752244, "answer_count": 1, "score": 2, "last_activity_date": 1533752196, "creation_date": 1533690004, "last_edit_date": 1533748226, "question_id": 51737269, "link": "https://stackoverflow.com/questions/51737269/indexmatch-in-vba-excel-with-formulas-in-cells", "title": "Index(Match()) in VBA Excel with Formulas in Cells", "body": "<p>First time here. Pretty new to coding in general. Just doing this for fun/trying to learn. Appreciate the help in advance.</p>\n\n<p>I'm trying to have my code look at a CSV cell and pull out the values into an array. Then, using that array, Index(Match()) to get dates in the last column into a new array. Then I will look at the latest date and write that into the cell next to CSV cell.</p>\n\n<p><a href=\"https://i.stack.imgur.com/pFHYM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pFHYM.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>Dim DepArray As Variant, FinArray As Variant, x As Integer, i As Integer, y As Variant, StartDate As Date\n    DepArray = Split(Target, \",\")\n    x = UBound(DepArray)\n    'INDEX(MATCH()) to write to new array of finish dates for prior tasks\n    For i = 0 To x\n        y = Application.WorksheetFunction.Index(Sheets(\"SH1\").Range(\"A1:E4\").Value, Application.Match(DepArray(i), Sheets(\"SH1\").Range(\"A1:A4\").Value, 0), 5)\n        FinArray(i) = y\n    Next i\n    StartDate = Application.WorksheetFunction.Max(FinArray)\n    Target.Offset(0, 1).Value = StartDate\n</code></pre>\n\n<p>I am getting a type mismatch error on the y=Index(Match()) line. I've tried every variable type, I think, declaring y alternatively as an integer and a date. Any thoughts?</p>\n\n<p>FYI I'm using the .Value callouts because in both column A and E, the item numbers and dates are being brought in by functions in the cells.</p>\n\n<p>Also, if you have tips for cleaning up the code or see other things wrong I haven't gotten to yet, I'd love to learn better practices.</p>\n\n<p>Thanks!</p>\n\n<p>Updated code to help with checking. I think I'm getting the Match() right because now the error shows on line MsgBox y(i). I've also tried it as MsgBox y</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Not Intersect(Target, Range(\"B1:B4\")) Is Nothing Then\n    Dim DepArray As Variant, FinArray As Variant, x As Integer, i As Integer, y As Variant, StartDate As Date\n    DepArray = Split(Target, \",\")\n    MsgBox DepArray(0)\n    x = UBound(DepArray)\n    MsgBox x\n    MsgBox DepArray(x)\n    'INDEX(MATCH()) to write to new array of finish dates for prior tasks\n    For i = 0 To x\n        MsgBox DepArray(i)\n        y = Application.Match(DepArray(i), Sheets(\"Sheet1\").Range(\"A1:A4\").Value, 0)\n        MsgBox y(i)\n        'FinArray(i) = Application.WorksheetFunction.Index(Sheets(\"Sheet1\").Range(\"A1:E4\").Value, Application.Match(DepArray(i), Sheets(\"Sheet1\").Range(\"A1:A4\").Value, 0), 5)\n\n    Next i\n    StartDate = Application.WorksheetFunction.Max(FinArray)\n    Target.Offset(0, 1).Value = StartDate\nEnd If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 154, "user_id": 10116116, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--s2Di8yOU90/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7osNJiMq-mIQKfBiXKipsocgio4DA/mo/photo.jpg?sz=128", "display_name": "Sam", "link": "https://stackoverflow.com/users/10116116/sam"}, "edited": false, "score": 0, "creation_date": 1533691330, "post_id": 51737177, "comment_id": 90435316, "body": "I&#39;ll be honest. If there&#39;s a solution that doesn&#39;t require Regular Expressions, being unfamiliar with it, I&#39;ll take it. Thanks"}, {"owner": {"reputation": 154, "user_id": 10116116, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--s2Di8yOU90/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7osNJiMq-mIQKfBiXKipsocgio4DA/mo/photo.jpg?sz=128", "display_name": "Sam", "link": "https://stackoverflow.com/users/10116116/sam"}, "edited": false, "score": 0, "creation_date": 1533693351, "post_id": 51737177, "comment_id": 90435701, "body": "Seems like I was a little too optimistic... The function without regular expressions does not work for dates that are: <code>DayMonth</code>. It outputs for example: &#39;1 0Jun&#39;"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 154, "user_id": 10116116, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--s2Di8yOU90/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7osNJiMq-mIQKfBiXKipsocgio4DA/mo/photo.jpg?sz=128", "display_name": "Sam", "link": "https://stackoverflow.com/users/10116116/sam"}, "edited": false, "score": 0, "creation_date": 1533694899, "post_id": 51737177, "comment_id": 90435973, "body": "@Sam Thought I had handled that. Non-regex code edited and should work without a hitch"}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1533694896, "last_edit_date": 1533694896, "creation_date": 1533689101, "answer_id": 51737177, "question_id": 51736917, "link": "https://stackoverflow.com/questions/51736917/insert-space-between-text-and-number-for-cells-within-column/51737177#51737177", "title": "Insert space between text and number for cells within column", "body": "<p>You can avoid that by inserting your space differently.  Here is a <code>Function</code> written with early-binding, but you can change that to late-binding.</p>\n\n<p>Match the junction between a letter and a number, then construct a string, inserting a space appropriately.</p>\n\n<pre><code>Option Explicit\nFunction InsertSpace(S As String) As String\n    Const sPat As String = \"[a-z]\\d|\\d[a-z]\"\n    Dim RE As RegExp, MC As MatchCollection\n\nSet RE = New RegExp\nWith RE\n    .Global = False\n    .Pattern = sPat\n    .IgnoreCase = True\n    If .Test(S) = True Then\n        Set MC = .Execute(S)\n        With MC(0)\n            InsertSpace = Left(S, .FirstIndex + 1) &amp; \" \" &amp; Mid(S, .FirstIndex + 2)\n        End With\n    End If\nEnd With\n\nEnd Function\n</code></pre>\n\n<p>You can also accomplish this without using Regular Expressions:</p>\n\n<p><strong>EDIT</strong> Pattern change for <code>Like</code> operator</p>\n\n<pre><code>Option Explicit\nOption Compare Text\n\nFunction InsertSpace2(S As String) As String\n    Dim I As Long\n\nFor I = 1 To Len(S)\n    If Mid(S, I, 2) Like \"#[a-z]\" Or Mid(S, I, 2) Like \"[a-z]#\" Then\n        InsertSpace2 = Left(S, I) &amp; \" \" &amp; Mid(S, I + 1)\n        Exit Function\n    End If\nNext I\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1533690109, "post_id": 51737188, "comment_id": 90435129, "body": "Good algorithm.  But why <code>Application.Trim</code>?  Why not just use the VBA function <code>Trim</code>?"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1533693175, "post_id": 51737188, "comment_id": 90435662, "body": "Thanks a lot. Application Trim will remove any extra spaces between strings while just Trim removes extra spaces at the right and left of the strings"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1533695019, "post_id": 51737188, "comment_id": 90436002, "body": "I understand that.  But the original string should not have any unwanted spaces other than at the beginning and the end."}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1533695312, "post_id": 51737188, "comment_id": 90436059, "body": "Thanks a lot Mr. Ron for pointing that out. It is just in case"}], "tags": [], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "is_accepted": true, "score": 1, "last_activity_date": 1533689188, "creation_date": 1533689188, "answer_id": 51737188, "question_id": 51736917, "link": "https://stackoverflow.com/questions/51736917/insert-space-between-text-and-number-for-cells-within-column/51737188#51737188", "title": "Insert space between text and number for cells within column", "body": "<p>Try this code</p>\n\n<pre><code>Sub Test()\nDim a, i As Long\n\nWith Range(\"A2\", Range(\"A\" &amp; Rows.Count).End(xlUp))\n    a = .Value\n    With CreateObject(\"VBScript.RegExp\")\n        .Global = True\n        .Pattern = \"(\\d+)\"\n        For i = 1 To UBound(a, 1)\n            a(i, 1) = Application.Trim(.Replace(a(i, 1), \" $1 \"))\n        Next i\n    End With\n    .Columns(2).Value = a\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 154, "user_id": 10116116, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--s2Di8yOU90/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7osNJiMq-mIQKfBiXKipsocgio4DA/mo/photo.jpg?sz=128", "display_name": "Sam", "link": "https://stackoverflow.com/users/10116116/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 836, "favorite_count": 0, "accepted_answer_id": 51737188, "answer_count": 2, "score": 0, "last_activity_date": 1533694896, "creation_date": 1533686176, "last_edit_date": 1533688093, "question_id": 51736917, "link": "https://stackoverflow.com/questions/51736917/insert-space-between-text-and-number-for-cells-within-column", "title": "Insert space between text and number for cells within column", "body": "<p>I've already written a code that inserts a space between text and numbers, separating 'unspaced' days and months from dates, and it works as it's supposed to. </p>\n\n<p>The only problem is that I'm using an <code>If then</code> structure to determine which Regular Expressions <code>pattern</code> I should use. </p>\n\n<p>If the first character of the date is a number, then knowing that it is in the '<code>DayMonth</code>' sequence, I use this pattern: <code>\"(.*\\d)(?! )(\\D.*)\"</code>. Otherwise, assuming that it isn't in the <code>'DayMonth'</code> sequence but rather in the '<code>MonthDay</code>' sequence, I use the other pattern: <code>\"(.*\\D)(?! )(\\d.*)\"</code>.</p>\n\n<p><strong>Is there any way to use two patterns at once for the Regular Expressions object to scan through so that I can get rid of the <code>If Then</code> structure?</strong></p>\n\n<p>My code below:</p>\n\n<pre><code>Sub SpaceMonthDayIf()\n\nDim col As Range\nDim i As Long\n\nSet col = Application.InputBox(\"Select Date Column\", \"Obtain Object Range\", Type:=8)\n\nWith CreateObject(\"VBScript.RegExp\")\n\n    For i = 1 To Cells(Rows.Count, col.Column).End(xlUp).Row\n\n        If IsNumeric(Left(Cells(i, col.Column).Value, 1)) Then\n        .Pattern = \"(.*\\d)(?! )(\\D.*)\"\n        Cells(i, col.Column) = .Replace(Cells(i, col.Column), \"$1 $2\")\n\n        Else\n        .Pattern = \"(.*\\D)(?! )(\\d.*)\"\n        Cells(i, col.Column) = .Replace(Cells(i, col.Column), \"$1 $2\")\n\n            End If\n\n                Next\n\n                    End With\n\nEnd Sub\n</code></pre>\n\n<p>For clarity, here's what happens when I run my code:</p>\n\n<p><a href=\"https://i.stack.imgur.com/qEo7l.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qEo7l.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/h50Ht.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/h50Ht.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": false, "score": 1, "last_activity_date": 1533714513, "creation_date": 1533714513, "answer_id": 51741258, "question_id": 51736555, "link": "https://stackoverflow.com/questions/51736555/append-string-to-cells-depending-on-values-in-other-cells/51741258#51741258", "title": "Append string to cells depending on values in other cells", "body": "<p>Your sub does exactly what you have programmed. It finds the last occurence of <code>arr(i)</code> and sets the value in column P for the last row only. You'd rather loop this way to go through the ranges with the same date: </p>\n\n<pre><code>Dim last_month_row as long, first_month_row as long, k as long\n\nFor i = LBound(arr) To UBound(arr)\n    last_month_row = ws.Range(\"I2:I\" &amp; lastrow).Find(What:=arr(i), searchdirection:=xlPrevious).Offset(, 7).row\n    first_month_row = ws.Range(\"I2:I\" &amp; lastrow).Find(What:=arr(i), searchdirection:=xlNext).Offset(, 7).row\n\n    For k = first_month_row to last_month_row \n     If last_month &lt; (ACV / 2) Then\n        ws.cells(k, \"P\").Value = ws.cells(k, \"N\").Value &amp; \"T1\"\n        ...\n</code></pre>\n\n<p>Additionally, I suggest using <code>Long</code> instead of <code>Integer</code>. VBA works with longs, you do not save anything with integers, but you risk an overflow going above 65K.</p>\n"}, {"tags": [], "owner": {"reputation": 74, "user_id": 7871648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/727b0b2f33699a71d5b8cf04a6d04e0d?s=128&d=identicon&r=PG&f=1", "display_name": "MsAmeen", "link": "https://stackoverflow.com/users/7871648/msameen"}, "is_accepted": false, "score": 1, "last_activity_date": 1533716307, "creation_date": 1533716307, "answer_id": 51741831, "question_id": 51736555, "link": "https://stackoverflow.com/questions/51736555/append-string-to-cells-depending-on-values-in-other-cells/51741831#51741831", "title": "Append string to cells depending on values in other cells", "body": "<p>I think you need to add another Array/Collection that contains \"ONLY\" the \"Unique\" values for column \"I\", then use this Unique values to iterate/search inside your selection as the following pseudo code:</p>\n\n<pre><code>For Each Unq in UniqueDate\n     For i = LBound(arr) To UBound(arr)\n           // Here, use \"Unq\" instead of \"arr(i)\" to search/find your target value\n     next i\nnext Unq \n</code></pre>\n\n<p>For me, the easiest way to create a unique 'list' is by using \"Collection\" :</p>\n\n<pre><code>Dim UniqDate As New Collection\n\nws.Range(\"I2:I\" &amp; lastrow).Select\nIf Not Selection Is Nothing Then\n  For Each cell In Selection\n    UniqDate.Add cell, cell // Collection will ignore the value of \"cell\" if already exist (duplicated values filtering)\n    // the rest of your code is the same \n    If (cell &lt;&gt; \"\") And (InStr(tmp, cell) = 0) Then\n      tmp = tmp &amp; cell &amp; \"|\"\n    End If\n  Next cell\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 339, "user_id": 4709889, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/9271519b66b415611910b055302699a4?s=128&d=identicon&r=PG&f=1", "display_name": "FrenchConnections", "link": "https://stackoverflow.com/users/4709889/frenchconnections"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1533752064, "creation_date": 1533682861, "last_edit_date": 1533752064, "question_id": 51736555, "link": "https://stackoverflow.com/questions/51736555/append-string-to-cells-depending-on-values-in-other-cells", "title": "Append string to cells depending on values in other cells", "body": "<p>I am working on a project to scans a list of dates in one column and values in another, and then appends a value to a string in a third column. What I am having trouble with is appending that same value to every cell above the specified date. The data looks like this: </p>\n\n<p><a href=\"https://i.stack.imgur.com/lDD4f.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lDD4f.png\" alt=\"The data is here currently\"></a>\nWhat I need to have happen is for the values of T1, T2 etc. to be appended to the code for every cell above the last_month_row which does not already have a value appended. It should look like this: </p>\n\n<p><a href=\"https://i.stack.imgur.com/CzxgC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CzxgC.png\" alt=\"It Should look like this\"></a></p>\n\n<p>My code thus far is this:</p>\n\n<pre><code>Sub Test_Logic()\nDim lastrow As Long, lastcolumn As Long, lastrow_reps As Long\nDim tmp As String, arr() As String, msg As String\nDim cell As Range\nDim i As Integer, j As Integer\nDim last_month As Long\nDim last_month_row As String, first_month_row As String\nDim ws As Worksheet, ws2 As Worksheet\nDim wb As Workbook\nDim reps As Variant, quota As Variant, repslist As Variant, ACV As Variant\n\nSet wb = ActiveWorkbook\nSet ws2 = wb.Sheets(\"Rep_Commission\")\nlastrow_reps = ws2.Cells(Rows.Count, 1).End(xlUp).Row\nSet repslist = ws2.Range(\"A3:A\" &amp; (lastrow_reps))\nSet ACV = ws2.Range(\"B3:B\" &amp; (lastrow_reps))\n\nWith wb\nFor Each reps In repslist\nSet ws = Worksheets(reps.Text)\nSet ACV = ws2.Range(\"A1:A99\").Find(reps, LookIn:=xlValues).Offset(, 1)\n\nlastrow = ws.Cells(Rows.Count, 1).End(xlUp).Row\n\n    For Each cell In ws.Range(\"I2:I\" &amp; lastrow)\n        If (cell &lt;&gt; \"\") And (InStr(tmp, cell) = 0) Then\n            tmp = tmp &amp; cell &amp; \"|\"\n        End If\n    Next cell\n\nIf Len(tmp) &gt; 0 Then tmp = Left(tmp, Len(tmp) - 1)\n    arr = Split(tmp, \"|\")\n        For i = LBound(arr) To UBound(arr)\n            msg = msg &amp; arr(i) &amp; vbNewLine\n        Next i\n\nFor i = LBound(arr) To UBound(arr)\n    'the error occurs here\n    last_month = ws.Range(\"I2:I\" &amp; lastrow).Find(What:=arr(i), searchdirection:=xlPrevious).Offset(, 6).Value\n    last_month_row = ws.Range(\"I2:I\" &amp; lastrow).Find(What:=arr(i), searchdirection:=xlPrevious).Offset(, 7).Row\n    first_month_row = ws.Range(\"I2:I\" &amp; lastrow).Find(What:=arr(i), searchdirection:=xlNext).Offset(, 7).Address\n        If last_month &lt; (ACV / 2) Then\n            ws.Range(\"I2:I\" &amp; lastrow).Find(What:=arr(i), searchdirection:=xlPrevious).Offset(, 7).Value = ws.Range(\"I2:I\" &amp; lastrow).Find(What:=arr(i), searchdirection:=xlPrevious).Offset(, 5).Value &amp; \"T1\"\n                For j = 2 To last_month_row - 1\n                    If ws.Range(\"I\" &amp; j).Value = arr(i) Then\n                        ws.Range(\"P\" &amp; j).Value = ws.Range(\"P\" &amp; j).Value &amp; \"T1\"\n                    End If\n                Next j\n        ElseIf last_month &gt; (ACV / 2) And last_month &lt; ACV Then\n            ws.Range(\"I2:I\" &amp; lastrow).Find(What:=arr(i), searchdirection:=xlPrevious).Offset(, 7).Value = ws.Range(\"I2:I\" &amp; lastrow).Find(What:=arr(i), searchdirection:=xlPrevious).Offset(, 5).Value &amp; \"T2\"\n                For j = 2 To last_month_row - 1\n                    If ws.Range(\"I\" &amp; j).Value = arr(i) Then\n                        ws.Range(\"P\" &amp; j).Value = ws.Range(\"P\" &amp; j).Value &amp; \"T2\"\n                    End If\n                Next j\n        ElseIf last_month &gt; ACV And last_month &lt; (ACV * 1.5) Then\n            ws.Range(\"I2:I\" &amp; lastrow).Find(What:=arr(i), searchdirection:=xlPrevious).Offset(, 7).Value = ws.Range(\"I2:I\" &amp; lastrow).Find(What:=arr(i), searchdirection:=xlPrevious).Offset(, 5).Value &amp; \"T3\"\n                For j = 2 To last_month_row - 1\n                    If ws.Range(\"I\" &amp; j).Value = arr(i) Then\n                        ws.Range(\"P\" &amp; j).Value = ws.Range(\"P\" &amp; j).Value &amp; \"T3\"\n                    End If\n                Next j\n        ElseIf last_month &gt; (ACV * 1.5) Then\n            ws.Range(\"I2:I\" &amp; lastrow).Find(What:=arr(i), searchdirection:=xlPrevious).Offset(, 7).Value = ws.Range(\"I2:I\" &amp; lastrow).Find(What:=arr(i), searchdirection:=xlPrevious).Offset(, 5).Value &amp; \"T4\"\n                For j = 2 To last_month_row - 1\n                    If ws.Range(\"I\" &amp; j).Value = arr(i) Then\n                        ws.Range(\"P\" &amp; j).Value = ws.Range(\"P\" &amp; j).Value &amp; \"T4\"\n                    End If\n                Next j\n        Else 'Do nothing yet, or maybe some error handling??\n        End If\nNext i\nNext reps\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>What I can't figure out is how to add the \"T\" values to the correct cells - I tried looping through a range created by first_month_row and last_month_row but ended up just appending multiples of the T values. Any advice would be appreciated.</p>\n\n<p>EDIT: So I was successfully able to populate the cells, but when I try to loop through my worksheets I get an \"Object Variable or With block Variable Not Set\" Error. It occurs at this line:</p>\n\n<pre><code>last_month = ws.Range(\"I2:I\" &amp; lastrow).Find(What:=arr(i), searchdirection:=xlPrevious).Offset(, 6).Value\n</code></pre>\n\n<p>But last_month is a single value, not an object so I don't see why this is occurring.</p>\n"}, {"tags": ["excel", "vba", "pdf", "embed"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 8554021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746f08633e3301636d77c3efe3a1b465?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/8554021/matt"}, "edited": false, "score": 0, "creation_date": 1533700040, "post_id": 51736545, "comment_id": 90436935, "body": "Thank you.  With a little bit of adjustment, I was able to make this work.  I do hope to make my workbook work on both Windows &amp; Mac, so any idea how I would make it work on Mac?  I assume the Declare Function at the top would not work on Mac?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 51, "user_id": 8554021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746f08633e3301636d77c3efe3a1b465?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/8554021/matt"}, "edited": false, "score": 0, "creation_date": 1533703338, "post_id": 51736545, "comment_id": 90437687, "body": "Sorry I have no idea how you&#39;d do the equivalent on a Mac."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1533684224, "last_edit_date": 1533684224, "creation_date": 1533682807, "answer_id": 51736545, "question_id": 51736193, "link": "https://stackoverflow.com/questions/51736193/embedding-pdf-into-excel-three-questions/51736545#51736545", "title": "Embedding PDF into Excel - three questions", "body": "<p>Based on <a href=\"https://stackoverflow.com/questions/32235897/how-to-embed-documents-using-vba\">https://stackoverflow.com/questions/32235897/how-to-embed-documents-using-vba</a></p>\n\n<pre><code>Declare Function FindExecutable Lib \"shell32.dll\" _\n     Alias \"FindExecutableA\" (ByVal lpFile As String, _\n                              ByVal lpDirectory As String, _\n                              ByVal lpResult As String) As Long\n\n\nSub tester()\n    AddFile ActiveSheet.Range(\"H10\"), \"C:\\Users\\jblow\\Desktop\\Training.pdf\"\n    AddFile ActiveSheet.Range(\"H20\"), \"C:\\Users\\jblow\\Desktop\\Info.xlsm\"\nEnd Sub\n\nSub AddFile(c As Range, sFile As String)\n\n    Dim exe As String, o\n\n    exe = FindApp(sFile)\n\n    Set o = c.Worksheet.OLEObjects.Add(Link:=False, DisplayAsIcon:=True, _\n            IconFileName:=exe, IconIndex:=0, _\n            IconLabel:=\"Testing\", Top:=c.Top, Left:=c.Left, _\n            Filename:=sFile)\n\n    o.ShapeRange.Width = c.Width '&lt;&lt; fit to cell\n\nEnd Sub\n\nFunction FindApp(sFile As String) As String\n   Const MAX_FILENAME_LEN = 260\n   Dim i As Integer, s2            As String\n\n   'Check if the file exists\n   If Dir(sFile) = \"\" Or sFile = \"\" Then\n      MsgBox \"File not found!\", vbCritical\n      Exit Function\n   End If\n   'Create a buffer\n   s2 = String(MAX_FILENAME_LEN, 32)\n   'Retrieve the name and handle of the executable, associated with this file\n   i = FindExecutable(sFile, vbNullString, s2)\n   If i &gt; 32 Then\n      FindApp = Left$(s2, InStr(s2, Chr$(0)) - 1)\n   Else\n      MsgBox \"No association found !\"\n   End If\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 8554021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746f08633e3301636d77c3efe3a1b465?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/8554021/matt"}, "edited": false, "score": 0, "creation_date": 1533700071, "post_id": 51736579, "comment_id": 90436945, "body": "Thank you. These suggestions definitely helped me!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1533684046, "last_edit_date": 1533684046, "creation_date": 1533683086, "answer_id": 51736579, "question_id": 51736193, "link": "https://stackoverflow.com/questions/51736193/embedding-pdf-into-excel-three-questions/51736579#51736579", "title": "Embedding PDF into Excel - three questions", "body": "<ol>\n<li><p>From <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/oleobjects-add-method-excel\" rel=\"nofollow noreferrer\">OLEObjects.Add Method (Excel)</a>, To use the Left argument, <em>'The initial coordinates of the new object, in points, relative to the upper-left corner of cell A1 on a worksheet, or to the upper-left corner of a chart.'</em> So if you want the icon in the middle of AN5, you would have to sum the column widths from A:AM and row heights from 1:4 then add about half the column width of column AN. You might try discarding Select and using Range(\"AN5\").OLEObjects.Add ... that should make OLEObjects consider AN5 as a relative A1.</p></li>\n<li><p>Don't Activate the object on insertion.</p></li>\n<li><p>The GUID should be common to anyone who has your version of Adobe installed.</p></li>\n</ol>\n"}], "owner": {"reputation": 51, "user_id": 8554021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746f08633e3301636d77c3efe3a1b465?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/8554021/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2258, "favorite_count": 0, "accepted_answer_id": 51736545, "answer_count": 2, "score": 0, "last_activity_date": 1533684224, "creation_date": 1533680259, "question_id": 51736193, "link": "https://stackoverflow.com/questions/51736193/embedding-pdf-into-excel-three-questions", "title": "Embedding PDF into Excel - three questions", "body": "<p>I have written a macro to allow for embedding a PDF file into an Excel sheet. I want the icon for the file to show up in a certain cell. So far, so good, but I do have some questions.</p>\n\n<p>But first, my code that does the embedding of the file:</p>\n\n<pre><code>Range(\"AN5\").Select\n\nActiveSheet.OLEObjects.Add(ClassType:=\"AcroExch.Document.DC\", Link:=False, _\n    DisplayAsIcon:=True, _\n    IconIndex:=0, IconLabel:=NameForPDFIcon, _\n    IconFileName:=\"C:\\WINDOWS\\Installer\\{AC76BA86-7AD7-1033-7B44-AC0F074E4100}\\PDFFile_8.ico\").Activate\n</code></pre>\n\n<p>My questions:</p>\n\n<ol>\n<li><p>I would like the icon to be in the center of Cell AN5, but instead it is justified to the top and left. If I add in Top and Left numbers into the OLEObjects.Add line, it will move the icon into cell A1. I can't figure out how to use Top &amp; Left relative to the cell I have selected.</p></li>\n<li><p>Whenever the file is embedded, the PDF opens in Adobe Reader. Is there a way to have it NOT open?</p></li>\n<li><p>The IconFileName part has the very long string of letters and numbers. (I got this from recording a macro of me inserting a PDF into a sheet.) It looks like a registry address. If I use this file on another computer, will the icon show up there? I assume this long string of characters would be different on another computer? Anyone know how I can make it so this works no matter what computer it's running on? I plan to send this file to several other people when it's done. </p></li>\n</ol>\n"}, {"tags": ["excel", "vba", "multidimensional-array"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1533677017, "post_id": 51735615, "comment_id": 90431991, "body": "Are you trying to use <code>1,2</code> as one-and-one-fifth or a one and a two?"}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 1, "creation_date": 1533677076, "post_id": 51735615, "comment_id": 90432023, "body": "I assume you&#39;re using the European convention of sing a comma as a radix (decimal) place marker. VBA uses <code>.</code> (dot) instead of a comma."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 3, "creation_date": 1533677136, "post_id": 51735615, "comment_id": 90432043, "body": "^^ as Dai says but that won&#39;t work with an integer in any event."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1533678757, "post_id": 51735615, "comment_id": 90432591, "body": "Can you please <a href=\"https://stackoverflow.com/posts/51735615/edit\">edit</a> your post to clarify what you&#39;re trying to do? As the above comments and the below answer indicate, it&#39;s quite hard to infer from what you&#39;ve posted."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10194110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2a36b7df47496a9ec70f79c546115fb?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn Gillis", "link": "https://stackoverflow.com/users/10194110/glenn-gillis"}, "edited": false, "score": 0, "creation_date": 1533746623, "post_id": 51735647, "comment_id": 90463246, "body": "Is there not a way to assign &quot;1&quot; to the first dimension and &quot;2&quot; to the second dimension of the first array item, which is what I&#39;m trying to do? In other words, arrPeople(1,2)? If I use the alternative you&#39;ve indicated I might as well use a single dimensional array. Thanks!"}], "tags": [], "owner": {"reputation": 593, "user_id": 4650381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZrWhe.jpg?s=128&g=1", "display_name": "elliot svensson", "link": "https://stackoverflow.com/users/4650381/elliot-svensson"}, "is_accepted": false, "score": 2, "last_activity_date": 1533747129, "last_edit_date": 1533747129, "creation_date": 1533677106, "answer_id": 51735647, "question_id": 51735615, "link": "https://stackoverflow.com/questions/51735615/why-does-this-simple-assignment-to-a-multidimensional-vba-array-raise-a-syntax-e/51735647#51735647", "title": "Why does this simple assignment to a multidimensional vba array raise a syntax error", "body": "<p>The two values \"1,2\" cannot be assigned to a single location in the array, such as <code>(0,0)</code>.  I suggest assigning 1 and 2 to their appropriate locations individually, as with:</p>\n\n<pre><code>arrPeople(0,0) = 1\narrPeople(1,0) = 2\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 10194110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2a36b7df47496a9ec70f79c546115fb?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn Gillis", "link": "https://stackoverflow.com/users/10194110/glenn-gillis"}, "edited": false, "score": 0, "creation_date": 1533767404, "post_id": 51751820, "comment_id": 90472550, "body": "Thank you, cxw and elliotsvensson. Perhaps my understanding of the purpose of a 2 dimensional array is incorrect. I will try to implement the array within a variant variable that you recommend, @cxw"}], "tags": [], "owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "is_accepted": true, "score": 0, "last_activity_date": 1533747014, "creation_date": 1533747014, "answer_id": 51751820, "question_id": 51735615, "link": "https://stackoverflow.com/questions/51735615/why-does-this-simple-assignment-to-a-multidimensional-vba-array-raise-a-syntax-e/51751820#51751820", "title": "Why does this simple assignment to a multidimensional vba array raise a syntax error", "body": "<p>@elliotsvensson is correct: there is not a way to do what you want <em>with a 2-D array as a data structure</em>.  You may want a different data structure.  For example, a 1-D array of <code>Variant</code> can store another 1-D array in each slot, similar to the way C stores arrays:</p>\n\n<pre><code>Option Explicit\nOption Base 0\n\nSub example()\n    Dim arrPeople(4) As Variant\n    arrPeople(0) = Array(1, 2)      ' Assign a whole row at once\n    Debug.Print arrPeople(0)(0)     ' prints 1.  Note (0)(0) indexing rather than (0,0).\nEnd Sub\n</code></pre>\n\n<p>As another example, for storing an email address and an article ID, you could use a <code>Collection</code> to map from one of those to the other.  You could use two <code>Collection</code>s for a bidirectional map.  Or, as you pointed out in your comment to elliot's answer, you could use two 1-D arrays.</p>\n"}], "owner": {"reputation": 13, "user_id": 10194110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2a36b7df47496a9ec70f79c546115fb?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn Gillis", "link": "https://stackoverflow.com/users/10194110/glenn-gillis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 51751820, "answer_count": 2, "score": -2, "last_activity_date": 1533747129, "creation_date": 1533676908, "last_edit_date": 1533746497, "question_id": 51735615, "link": "https://stackoverflow.com/questions/51735615/why-does-this-simple-assignment-to-a-multidimensional-vba-array-raise-a-syntax-e", "title": "Why does this simple assignment to a multidimensional vba array raise a syntax error", "body": "<p>I'm attempting to assign two integers, \"1\" and \"2\" to a two-dimensional array of integers in VBA for Excel:</p>\n\n<pre><code>Dim arrPeople(4, 4) As Integer\narrPeople(0,0) = 1,2\n</code></pre>\n\n<p>The line where I am attempting to save the integer 1 to the first dimension of the array and the integer 2 to the second dimension of the first array item -- <code>arrPeople(0,0) = 1,2</code> -- raises a syntax error and I've not found an example that tells me why?</p>\n\n<p>(I am not trying to insert \"1,2\", nor \"1.2\" using the European convention for a decimal point, nor any fractional number. Eventually, I would like to store an email address in one dimension of the array, and an article ID number from a webpage URL in the other dimension, but thought simplifying the problem to just storing integers would be helpful.)</p>\n"}, {"tags": ["vba", "excel", "long-integer"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1533675545, "post_id": 51735301, "comment_id": 90431399, "body": "Run a loop through an array and do all the &#39;sanitizing&#39; at the same time."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 10194034, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6zIgfpF_8ls/AAAAAAAAAAI/AAAAAAAAANU/S0vvYq9I3bw/photo.jpg?sz=128", "display_name": "Trevor Sutherland", "link": "https://stackoverflow.com/users/10194034/trevor-sutherland"}, "edited": false, "score": 0, "creation_date": 1533758022, "post_id": 51735417, "comment_id": 90468864, "body": "Is there a trick to declaring an array?  I&#39;m getting an error when I use the code you supplied.  Do I need to declare the array as a string then reDim it once I get the length?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 43, "user_id": 10194034, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6zIgfpF_8ls/AAAAAAAAAAI/AAAAAAAAANU/S0vvYq9I3bw/photo.jpg?sz=128", "display_name": "Trevor Sutherland", "link": "https://stackoverflow.com/users/10194034/trevor-sutherland"}, "edited": false, "score": 0, "creation_date": 1533765788, "post_id": 51735417, "comment_id": 90472065, "body": "my bad, it should have been declared as a variant type."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 5, "last_activity_date": 1533765750, "last_edit_date": 1533765750, "creation_date": 1533675912, "answer_id": 51735417, "question_id": 51735301, "link": "https://stackoverflow.com/questions/51735301/adding-an-apostrophe-to-entire-column-in-excel-vba/51735417#51735417", "title": "Adding an apostrophe to entire column in Excel-VBA", "body": "<p>Run a loop through an array and do all the 'sanitizing' at the same time.</p>\n\n<pre><code>dim arr as variant, i as long\n\nwith worksheets(1)\n\n    arr = .range(.cells(2, \"A\"), .cells(.rows.count, \"A\").end(xlup)).value2\n\n    for i=lbound(arr, 1) to ubound(arr, 1)\n\n        arr(i, 1) = chr(39) &amp; replace(arr(i, 1), chr(45), vbnullstring)\n\n    next i\n\n    'optional text format for cells\n    '.cells(2, \"A\").resize(ubound(arr, 1), ubound(arr, 2)).numberformat = \"@\"\n    .cells(2, \"A\").resize(ubound(arr, 1), ubound(arr, 2)) = arr\n\nend with\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10194034, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6zIgfpF_8ls/AAAAAAAAAAI/AAAAAAAAANU/S0vvYq9I3bw/photo.jpg?sz=128", "display_name": "Trevor Sutherland", "link": "https://stackoverflow.com/users/10194034/trevor-sutherland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 486, "favorite_count": 1, "accepted_answer_id": 51735417, "answer_count": 1, "score": 1, "last_activity_date": 1533765750, "creation_date": 1533675383, "question_id": 51735301, "link": "https://stackoverflow.com/questions/51735301/adding-an-apostrophe-to-entire-column-in-excel-vba", "title": "Adding an apostrophe to entire column in Excel-VBA", "body": "<p>I've been asked to write a macro for a ~9,000 line worksheet that has numbers that are longer than Excel typically allows.  To get around this, I have to append a single quote/apostrophe to each cell prior to removing hyphens or otherwise sanitizing the data or else Excel abbreviates the numbers even when classified as Text.</p>\n\n<p>Is there a way to do this other than with a FOR loop and iterating through every cell?</p>\n"}]