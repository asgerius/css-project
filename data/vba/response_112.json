[{"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1488414453, "post_id": 42544438, "comment_id": 72225092, "body": "This is both shorter and faster than what OP was trying to do, though they still need to be made aware of the dangers of using undeclared variables, so I&#39;ll keep my more verbose answer, although this is clearly superior."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1488524962, "post_id": 42544438, "comment_id": 72278655, "body": "@ArenGallagher, did you get through it?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1489012168, "post_id": 42544438, "comment_id": 72490369, "body": "@ArenGallagher, any chance to get feedback from you?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 2, "last_activity_date": 1488412776, "creation_date": 1488412776, "answer_id": 42544438, "question_id": 42544310, "link": "https://stackoverflow.com/questions/42544310/excel-vba-continually-returning-0/42544438#42544438", "title": "Excel VBA continually returning 0", "body": "<p>You could use the <code>Average()</code> function:</p>\n\n<pre><code>Function forex(audData As Range, euData As Range)\n    With WorksheetFunction\n        forex = .Average(audData) * .Average(euData)\n    End With  \nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1488419553, "post_id": 42544459, "comment_id": 72226440, "body": "I think the OP has even more problems by using a loop than you have noticed - i.e. if some cells within <code>audData</code> or <code>euData</code> are empty then the <code>Count</code> will be less than the number of cells, and the loop will only iterate over the first <code>a</code> or <code>e</code> cells (even though that will potentially include empty cells) and will ignore some of the final cells in the range.  (It probably should be <code>audData.Count</code> instead of <code>Application.Count(audData)</code>, with an appropriate <code>If Not IsEmpty(..) Then</code> in the loop.)  But +1 for pointing out the merits of <code>Option Explicit</code>!"}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 2, "last_activity_date": 1488413253, "last_edit_date": 1488413253, "creation_date": 1488412901, "answer_id": 42544459, "question_id": 42544310, "link": "https://stackoverflow.com/questions/42544310/excel-vba-continually-returning-0/42544459#42544459", "title": "Excel VBA continually returning 0", "body": "<p>You seem to be a victim of undeclared variables. You have two loops,</p>\n\n<pre><code>For i = 1 To aud \n</code></pre>\n\n<p>and (later on)</p>\n\n<pre><code>For i = 1 To eu\n</code></pre>\n\n<p>where neither <code>aud</code> nor <code>eu</code> are declared. Thus, they default to variants with an implicit value of <code>0</code>, hence neither of these loops ever execute and all your variables stay at <code>0</code>.</p>\n\n<p>You really should get in the habit of using <code>Option Explicit</code> at the top of all of your modules. This can be done automatically by enabling the option <code>Require Variable Declarations</code> in the VBA editor options. In the long run, it will save you hours of debugging time.</p>\n\n<p>I can't test your code, but if you declare your variables and replace <code>aud</code> and <code>eu</code> by what I think you meant you would get:</p>\n\n<pre><code>Function forex(audData As Range, euData As Range) As Double\n   Dim a As Long, e As Long, aSum As Double, eSum As Double, aMean As Double, eMean As Double, i As Long\n    a = Application.Count(audData)\n    e = Application.Count(euData)\n    'Counts how many values are in the data\n\n    For i = 1 To a ' This sums the 1st forex rate and finds the mean\n        aSum = aSum + audData(i)\n    Next i\n\n    aMean = aSum / a\n\n    For i = 1 To e ' This sums the 2nd forex rate and finds the mean\n        eSum = eSum + euData(i)\n    Next i\n\n    eMean = eSum / e\n\n    forex = (aMean * eMean)\n\nEnd Function\n</code></pre>\n\n<p>I skipped the lines like <code>aSum = 0</code> since properly declared VBA variables have reasonable default values.</p>\n"}], "owner": {"reputation": 1, "user_id": 7644292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3143e8832e6c5a10747e5f9d110ad361?s=128&d=identicon&r=PG&f=1", "display_name": "Aren Gallagher", "link": "https://stackoverflow.com/users/7644292/aren-gallagher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1488424763, "creation_date": 1488411980, "last_edit_date": 1488424763, "question_id": 42544310, "link": "https://stackoverflow.com/questions/42544310/excel-vba-continually-returning-0", "title": "Excel VBA continually returning 0", "body": "<p>I'm trying to calculate a cross currency rate by simply summing the forex rates for A/B and B/C and multiplying the means to find the A/C rate and I keep getting 0 in return. This is the code:</p>\n\n<pre><code>Function forex(audData As Range, euData As Range)\n\n    a = Application.Count(audData)\n    e = Application.Count(euData)\n    'Counts how many values are in the data\n\n    aSum = 0\n    eSum = 0\n    aMean = 0\n    eMean = 0\n\n    For i = 1 To aud ' This sums the 1st forex rate and finds the mean\n        aSum = aSum + audData(i)\n    Next i\n\n    aMean = aSum / a\n\n    For i = 1 To eu ' This sums the 2nd forex rate and finds the mean\n        eSum = eSum + euData(i)\n    Next i\n\n    eMean = eSum / e\n\n    forex = (aMean * eMean)\n\nEnd Function\n</code></pre>\n"}, {"tags": ["ms-access", "foreach", "vba", "do-while"], "answers": [{"tags": [], "owner": {"reputation": 234, "user_id": 1344208, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d432dab1aae4dfb5de110eb79e24a5df?s=128&d=identicon&r=PG", "display_name": "Terri", "link": "https://stackoverflow.com/users/1344208/terri"}, "is_accepted": false, "score": 0, "last_activity_date": 1490106912, "creation_date": 1490106912, "answer_id": 42930128, "question_id": 42544170, "link": "https://stackoverflow.com/questions/42544170/set-up-a-filtered-query-using-an-array-and-return-a-series-of-calculations-in-ac/42930128#42930128", "title": "Set up a filtered query using an array and return a series of calculations in Access VBA", "body": "<p>The solution I found was to set variables for the values from the array and use them to dynamically update a table. From that, I created a query to sum the values and used that as the basis for the report. The key was <code>GetRows()</code></p>\n\n<p>Get the unique items and read the the rows of data into the first array </p>\n\n<pre><code>    Dim rNum As Integer\n\nrNum = myItems.RecordCount\n\n    Dim varItem As Variant\n    Dim intRi As Integer  'rows of unique items\n    Dim intCi As Integer  'columns of unique items\n    Dim intNCi As Integer\n    Dim intRCi As Integer\n\nvarItem = myItems.GetRows(rNum)\n    intNRi = UBound(varItem, 2) + 1\n    intNCi = UBound(varItem, 1) + 1\n\nFor intRi = 0 To intNRi - 1\n    For intCi = 0 To intNCi - 1\n    vItem = varItem(intCi, intRi)\n</code></pre>\n\n<p>Use <code>vItem</code> to dynamically create a new recordset to set up the weekly buckets</p>\n\n<pre><code>    strSelect = \"Select * FROM qInventoryTotals2 WHERE qInventoryTotals2.ItemNumber = [this_one]\"\nSet qdf = db.CreateQueryDef(vbNullString, strSelect)\n    qdf.Parameters(\"this_one\").Value = vItem\nSet inv = qdf.OpenRecordset\n</code></pre>\n\n<p>Count the records, create a second array</p>\n\n<pre><code>    Dim invNum As Integer\n\ninvNum = inv.RecordCount\n\n    Dim varRec As Variant\n    Dim intR As Integer\n    Dim intC As Integer\n    Dim intNC As Integer\n    Dim intRC As Integer\n\n    Dim cItem As String\n    Dim cRequired As Date\n    Dim cPO As Double\n    Dim cBC As Double\n    Dim cOnHand As Double\n\nvarRec = inv.GetRows(invNum)\n    intNR = UBound(varRec, 2) + 1\n    intNC = UBound(varRec, 1) + 1\n\nFor intR = 0 To intNR - 1\n    For intC = 0 To intNC - 1\n\n        cItem = varRec(0, intR)\n        cRequired = varRec(1, intR)\n        cOnHand = varRec(2, intR)\n        cPO = varRec(3, intR)\n        cBC = varRec(4, intR)\n        cSO = varRec(5, intR)\n        cPD = varRec(6, intR)\n        cIN = varRec(7, intR)\n        cJT = varRec(8, intR)\n        cWO = varRec(9, intR)\n\n\n'------------- finish getting inventory columns --------------------\n    Next intC\n</code></pre>\n\n<p>And then set up the buckets for each week </p>\n\n<pre><code>    If cRequired &lt; Week1 Then\n\n        recOut.AddNew\n        recOut.Fields(\"ItemNumber\") = cItem\n        recOut.Fields(\"tB\") = cOnHand\n        recOut.Fields(\"tPO\") = cPO\n        recOut.Fields(\"tBC\") = cBC\n        recOut.Fields(\"tSO\") = cSO\n        recOut.Fields(\"tPD\") = cPD\n        recOut.Fields(\"tIN\") = cIN\n        recOut.Fields(\"tJT\") = cJT\n        recOut.Fields(\"tWO\") = cWO\n        recOut.Fields(\"tE\") = cOnHand + cPO + cBC + cSO + cPD + cIN + cJT + cWO\n        recOut.Fields(\"RequiredDate\") = cRequired\n        recOut.Fields(\"GroupDate\") = Week1\n        recOut.Update\n\n'        tE0 = cOnHand + cPO + cBC + cSO + cPD + cIN + cJT + cWO\n\nDim tryme As Double\n        tryme = DLookup(\"teMe\", \"qBuckets\", \"GroupDate = Week1\")\n        tE0 = tryme\n\n   End If\n</code></pre>\n"}], "owner": {"reputation": 234, "user_id": 1344208, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d432dab1aae4dfb5de110eb79e24a5df?s=128&d=identicon&r=PG", "display_name": "Terri", "link": "https://stackoverflow.com/users/1344208/terri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490106912, "creation_date": 1488411195, "last_edit_date": 1488740084, "question_id": 42544170, "link": "https://stackoverflow.com/questions/42544170/set-up-a-filtered-query-using-an-array-and-return-a-series-of-calculations-in-ac", "title": "Set up a filtered query using an array and return a series of calculations in Access VBA", "body": "<p>The task: Create a report for Part Numbers that shows several types (On Hand, On Order, etc) in date buckets with each type totaled for the specific range. </p>\n\n<pre><code>For example: \nItem 1 =&gt; (could be over 2000)\n                2/5/2017    2/19/2017    2/28/2017 (30 weeks)\nOn Hand           20           42           33\nOn Order           0            5            4\n</code></pre>\n\n<p>Each item is shown on it's own page with related metadata about the item. Each date bucket is based on a user-entered start date with a calculation running against the data set to determine what goes in which bucket and what the totals are. </p>\n\n<p>I have this report fully working for one item. User types one item, selects a date, and the report is created using the following: </p>\n\n<pre><code>Inventory Meta general information and description of the item\nInventory Detail gets all the detailed information \nInventory Totals gets totals for each Types \nGetInventory() VBA sets up the buckets and populates the totals\n</code></pre>\n\n<p>Using a query to get the date buckets would perhaps be easier to get the data into the report. Creating a query with 210 calculated columns (7 types, 30 weeks) wasn't a reasonable approach.  </p>\n\n<p>Naturally, selecting one item at a time is not what's wanted.</p>\n\n<p>I have a select box that gets whatever Part Numbers are selected and creates a query on the fly for the Inventory Meta (main report). I have similar code working that runs with the Inventory Totals (sub report) to create a query on the fly for that. </p>\n\n<p>But, as with the Inventory Totals query, each date is a unique value and is it's own row. What I need to be able to do is run the code to build the buckets for each item selected. </p>\n\n<p>I'm stuck. </p>\n\n<p>I have created an array of item numbers (whatever was selected). I can see what's in the array. </p>\n\n<p>What I can't seem to figure out is how to feed each to the code that runs the date comparisons and calculations so that I get a full set of data for each Part Number. </p>\n\n<p>With one number it was easy.... \"this one\" </p>\n\n<pre><code>vItem = [Forms]![fOptions]![ItemNumber]\nSet db = CurrentDb\n    strSelect = \"Select * FROM qInventoryTotals WHERE qInventoryTotals.ItemNumber = [this_one]\"\nSet qdf = db.CreateQueryDef(vbNullString, strSelect)\n    qdf.Parameters(\"this_one\").Value = vItem\nSet inv = qdf.OpenRecordset\n</code></pre>\n\n<p>The closest I've come is getting the report to show the same set of data for all part numbers. I suspect there is some small but critical thing, like where a particular loop starts or a variable I've missed or something. </p>\n\n<p>The result of the following is a message box that repeats the same total for each of the part numbers. </p>\n\n<pre><code>    Private Sub CreateOne_Click()\n\nOn Error GoTo Err_cmdOpenQuery_Click\n\n'----------- Selection box check for dates -------------\nIf IsNull(Forms!fFish1!Week1) Then\n        MsgBox \"A Sunday date must be selected\", , \"Please select a date\"\n    ElseIf Weekday(Forms!fFish1!Week1) = 1 Then\n        'MsgBox \"That is Sunday\"\n       Forms!fFish1!Week1 = Forms!fFish1!Week1\n    Else\n        MsgBox \"Starting Week needs to be a Sunday date\" _\n               , , \"Sorry, that's not Sunday\"\n        ' clears the 'not Sunday' selection\n        Forms!fFish1!Week1 = \"\"\n    Exit Sub\n End If\n'-------------------------------------------------\n' Declarations =====================================\n\n    Dim db As DAO.Database\n    Dim iMeta As DAO.QueryDef\n\n    Dim i As Integer\n    Dim strSQL As String\n    Dim strWhere As String\n    Dim strIN As String\n    Dim flgSelectAll As Boolean\n    Dim varItem As Variant\n\n    Dim strSlect As String\n    Dim vItem As Variant\n\n\n' Setup  -------------------------------------\n    Set db = CurrentDb()\n    strSQL = \"SELECT * FROM qInventoryTotals2\"\n\n'----------------------------------------------------------------------\n' Get whatever is selected and loop through the selections\n' This defines which numbers are in the list\n'----------------------------------------------------------------------\n    For i = 0 To Forms!fFish1.box4.ListCount - 1\n        If Forms!fFish1.box4.Selected(i) Then\n            If Forms!fFish1.box4.Column(0, i) = \"All\" Then\n                flgSelectAll = True\n            End If\n            strIN = strIN &amp; \"'\" &amp; Forms!fFish1.box4.Column(0, i) &amp; \"',\"\n        End If\n    Next i\n\n    'Create the WHERE string, and strip off the last comma of the IN string\n    strWhere = \" WHERE [ItemNumber] in \" &amp; _\n               \"(\" &amp; Left(strIN, Len(strIN) - 1) &amp; \")\"\n\n    'If \"All\" was selected in the listbox, don't add the WHERE condition\n    If Not flgSelectAll Then\n       strSQL = strSQL &amp; strWhere\n    End If\n'-------------------------------------------------------\n\n' Create a query that has all the selected item numbers\n    db.QueryDefs.Delete \"qInventoryTotals3\"\n    Set iMeta = db.CreateQueryDef(\"qInventoryTotals3\", strSQL)\n\n    Set inv = iMeta.OpenRecordset\n\n'==========================================================================\n' Create an array to pull out each of the Item numbers one at a time\nDim Count As Integer, r As Integer\nCount = 0\n\nFor i = 0 To Forms!fFish1.box4.ListCount - 1\n        If Forms!fFish1.box4.Selected(i) Then\n            vItem = Forms!fFish1.box4.Column(0, i)\n            'vItemFilter = Forms!fFish1.box4.Column(0, i)\n            'MsgBox (vItem), , \"one by one\"\n            Count = Count + 1\n       End If\n    Next i\n\n''MsgBox (Count), , \"count how many items are in the set\"\n' Get the count for how many items are in the currently selected list\n' Displays one item at a time -\n\n' Set up the array ------------------------------\n'------------------------------------------------\nReDim vItem(Count)\n    r = 0\n\n    For i = 0 To Forms!fFish1.box4.ListCount - 1\n      If Forms!fFish1.box4.Selected(i) Then\n            vItem(r) = Forms!fFish1.box4.Column(0, i)\n            r = r + 1\n       End If\n    Next i\n\n\n    'Check the values stored in array\n    ''For i = 0 To Count - 1\n       ''MsgBox vItem(i), , \"show all values from the array\"\n    ''Next\n' have all values from the array. Each in it's own message box\n'===============================================================================\n\n' Set up the item numbers ---------------------------\n\nDim part As Variant\npart = vItem\n\n  With vItem\n       For i = LBound(vItem) To UBound(vItem) - 1\n       MsgBox (\"There are\" &amp; \" \" &amp; (vItem(i)) &amp; \" \" &amp; \"fishies\"), , \"Whatcha' got now?\"\n\n' cycles through each number\n\n' Past Due ============================================\nDim tPOPast As Double\nDim tBCPast As Double\nDim tBPast As Double\nDim tEPast As Double\n\n    If inv!ItemNumber = part(i) And inv.Fields(\"RequiredDate\") &lt; Forms!fFish1!Week1 Then\n    'displays the first part number with it's value, then the remaining numbers with no value\n\n'    If inv.Fields(\"RequiredDate\") &lt; Forms!fFish1!Week1 Then\n    'displays each of the part numbers with the same value\n\n\n        tBPast = inv.Fields(\"TotalOnHand\")\n        tPOPast = tPOPast + inv.Fields(\"SumOfSupply\")\n        tBCPast = tBCPast + inv.Fields(\"SumOfDemand\")\n\n' Calculate ending inventory for the week ===================\n        tEPast = tBPast + tPOPast + tBCPast \n\n' Show something for testing ==============================\n\n        MsgBox (tBPast &amp; \" \" &amp; part(i)), , \"show Me the money\" ' displays same total for each part number\n\n    End If \n'end this condition, next condition follows\n'----------------- do it again -------------------------------\n    Next\n\n' Finished with the weekly buckets =====================================\n\n    End With\n'=========================================================================\n\n'-------------------- error management for the selection box ------------------\nExit_cmdOpenQuery_Click:\n    Exit Sub\n\nErr_cmdOpenQuery_Click:\n\n    If Err.Number = 5 Then\n        MsgBox \"Pick one, or more, item numbers from the list\" _\n               , , \"Gotta pick something!\"\n        Resume Exit_cmdOpenQuery_Click\n\n    Else\n        'Write out the error and exit the sub\n        MsgBox Err.Description\n        Resume Exit_cmdOpenQuery_Click\n    End If\n'---------------------------------------------------------------------------\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 718, "user_id": 7623920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53616884833316e7363ab6d90c3a56c?s=128&d=identicon&r=PG&f=1", "display_name": "O. Gungor", "link": "https://stackoverflow.com/users/7623920/o-gungor"}, "edited": false, "score": 0, "creation_date": 1488423944, "post_id": 42543772, "comment_id": 72227711, "body": "is 90 + a separate column, or is it an actual value in the same column? what is the exact error you are getting? you also say spreadsheet, so you want to use Docmd.TransferSpreadsheet unless that was just a typo where you wrote TransferText. Also make sure that the [HasFieldNames] argument is set accordingly"}, {"owner": {"reputation": 37, "user_id": 7600610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8419b08baa16de2ce76a52aeffa04d8b?s=128&d=identicon&r=PG&f=1", "display_name": "A. Kru", "link": "https://stackoverflow.com/users/7600610/a-kru"}, "reply_to_user": {"reputation": 718, "user_id": 7623920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53616884833316e7363ab6d90c3a56c?s=128&d=identicon&r=PG&f=1", "display_name": "O. Gungor", "link": "https://stackoverflow.com/users/7623920/o-gungor"}, "edited": false, "score": 0, "creation_date": 1488823549, "post_id": 42543772, "comment_id": 72392864, "body": "Its in the same coloumn with number 1-89. It creates two tables, one with the data with the 90+ cell blank, as well as a another table shower each row with an import error"}, {"owner": {"reputation": 718, "user_id": 7623920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53616884833316e7363ab6d90c3a56c?s=128&d=identicon&r=PG&f=1", "display_name": "O. Gungor", "link": "https://stackoverflow.com/users/7623920/o-gungor"}, "edited": false, "score": 1, "creation_date": 1488824913, "post_id": 42543772, "comment_id": 72393639, "body": "90+ should in itself not cause a problem, it should be treated as an integer. you are not providing adequate information: include a snapshot of the spreadsheet with columns/values included as well as the structure of your destination table in access. also, docm.transfertext will not import excel, you need docmd.transferspreadsheet"}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 11820228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d71c3fcb38f2720fff218aee7c94e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Kiran", "link": "https://stackoverflow.com/users/11820228/kiran"}, "is_accepted": false, "score": 1, "last_activity_date": 1581870800, "creation_date": 1581870800, "answer_id": 60250662, "question_id": 42543772, "link": "https://stackoverflow.com/questions/42543772/vba-access-transfertext-import-errors/60250662#60250662", "title": "VBA Access Transfertext Import Errors", "body": "<p>If you import data into a table that doesn't already exist, Access will create one for you. It automatically determines the data type of each column based on the first few rows that are imported. If your source data contains a mixture of data types in one column, then you may experience this error.</p>\n\n<p>There are 2 solutions:</p>\n\n<ol>\n<li>Build the import table to be of the correct data type for your data (i.e. specify that the age column is Short Text). Then import to the pre-defined import table.</li>\n<li>Ensure that the CSV or Excel file stores each age as a string i.e. <code>\"20\"</code> instead of <code>20</code> (in Excel, format the cell as Text, so it is left aligned or start cell contents with an apostrophe <code>'20</code> or use formulaic notation <code>=\"20\"</code>).</li>\n</ol>\n\n<p>You could do either of those things, but it would be better to do both of them if possible.</p>\n"}], "owner": {"reputation": 37, "user_id": 7600610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8419b08baa16de2ce76a52aeffa04d8b?s=128&d=identicon&r=PG&f=1", "display_name": "A. Kru", "link": "https://stackoverflow.com/users/7600610/a-kru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593954464, "creation_date": 1488409260, "last_edit_date": 1593954464, "question_id": 42543772, "link": "https://stackoverflow.com/questions/42543772/vba-access-transfertext-import-errors", "title": "VBA Access Transfertext Import Errors", "body": "<p>I would like to import a spreadsheet to an access database, on column has ages 1-89 plus another that's says 90+ which in turn create a Import Error. Using the DoCmd.TransferText, is it possible to import everything as it is including 90+ in the column of all other numbers? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1488410332, "post_id": 42543035, "comment_id": 72223724, "body": "<i>actually gives me all kinds of extra text!</i> - what is the extra text you get?"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1488466114, "post_id": 42543035, "comment_id": 72251327, "body": "Actually, I&#39;m looking at this a lot closer and I&#39;m not even getting the relevant data.  I get all kinds of superfluous data, but I&#39;m not getting what I really want.  I thought this was a TD element, but it doesn&#39;t pull in the relevant data.  I guess this is not a TR element either, because I tried that, and I still do not get the relevant data.  I even tried this: For Each itm In IE.document.all I thought that would dump all tags and IDs and classes into my worksheet, but again, it skips the data that I really want.  How can I dump the entire contents of a web page into my sheet?"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1488467543, "post_id": 42543035, "comment_id": 72252406, "body": "There is something very weird going on here.  It&#39;s almost like the data is sitting on different levels.  Even if I record a macro and pull in the data from the table, the relevant data doesn&#39;t come into the sheet.  Even if I record a macro and import EVERYTHING on the entire page, again, the relevant data doesn&#39;t come into the sheet.  I&#39;ve never seen this before.  This is a SharePoint site, so maybe that has something to do with it.  Not sure."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1488486092, "post_id": 42543035, "comment_id": 72264299, "body": "when I have had issues with this in the past I have looped through every cell (html cell) in every row of every table and done debug.print on each cell to understand what was happening. It was a pain-in-the-ass and took time, but I eventually solved my problem."}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1488487439, "post_id": 42543035, "comment_id": 72265090, "body": "Scott, I just updated my original post with a second script.  I still can&#39;t tell where the data is coming from.  Can you post the sample script that you used to grab all the elements from the page?  Thanks."}], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 183, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1488487384, "creation_date": 1488406039, "last_edit_date": 1531164843, "question_id": 42543035, "link": "https://stackoverflow.com/questions/42543035/im-trying-to-import-innertext-from-a-td-class-getting-lots-of-extra-text", "title": "I&#39;m trying to import innertext from a td-class. Getting lots of extra text", "body": "<p>I'm trying to get the innertext of 'wfm-bodyText'.  So, I want to loop through items on a webpage and import, in this case, 'H. Validate Gamer Correct'</p>\n\n<p><a href=\"https://i.stack.imgur.com/babxo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/babxo.png\" alt=\"enter image description here\"></a></p>\n\n<p>I thought the script below would work, but it actually gives me all kinds of extra text!!</p>\n\n<pre><code>Public Sub CopyFromURL()\nDim IE As InternetExplorer, doc As HTMLDocument\nDim thisClass As IHTMLElement2, thisLink As IHTMLElement\nDim rng As Range, cell As Range\nConst READYSTATE_COMPLETE As Integer = 4\nDim TR_col As Object, TR As Object\nDim TD_col As Object, TD As Object\nDim row As Long, col As Long\nrow = 1\n'Set rng = Range(\"A1:A5\")\n'For Each cell In rng\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    IE.Navigate URL\n\n    Do While (IE.Busy Or IE.ReadyState &lt;&gt; READYSTATE_COMPLETE)\n        DoEvents\n    Loop\n\n    Set TR_col = IE.Document.getElementsByTagName(\"TR\")\n\n    For Each TR In TR_col\n        Set TD_col = TR.getElementsByTagName(\"TD\")\n\n        row = ActiveSheet.Cells(ActiveSheet.Rows.Count, \"A\").End(xlUp).row\n            col = 1\n\n            For Each TD In TD_col\n                Cells(row, col) = TD.innerText\n                col = col + 1\n            Next\n        row = row + 1\n    Next\n\n'Next cell\nIE.Quit\nEnd Sub\n</code></pre>\n\n<p>The URL is behind a firewall.  I can't share it.</p>\n\n<p>Again, below is the structure of the page.  I want to copy the 'E. Verify phone number if applicable' into my sheet.</p>\n\n<p><a href=\"https://i.stack.imgur.com/AFjz7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AFjz7.png\" alt=\"enter image description here\"></a></p>\n\n<p>I tried the script below in an attempt to get every element from the page.  </p>\n\n<pre><code>Sub DumpData()\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\nIE.Visible = True\n\nURL = \"http://www.SharePoint.aspx\"\n\n'Wait for site to fully load\nIE.Navigate2 URL\nDo While IE.Busy = True\n   DoEvents\nLoop\n\nRowCount = 1\n\nWith Sheets(\"Sheet1\")\n   .Cells.ClearContents\n   RowCount = 1\n   For Each itm In IE.document.all\n\n      .Range(\"A\" &amp; RowCount) = itm.tagname\n      .Range(\"B\" &amp; RowCount) = itm.ID\n      .Range(\"C\" &amp; RowCount) = itm.classname\n      .Range(\"D\" &amp; RowCount) = Left(itm.innertext, 1024)\n\n      RowCount = RowCount + 1\n   Next itm\nEnd With\nEnd Sub\n</code></pre>\n\n<p>I still can't tell where the relevant data is coming from.</p>\n"}, {"tags": ["excel", "vba", "if-statement", "for-loop"], "answers": [{"tags": [], "owner": {"reputation": 831, "user_id": 7542390, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dkBke.jpg?s=128&g=1", "display_name": "BenShelton", "link": "https://stackoverflow.com/users/7542390/benshelton"}, "is_accepted": true, "score": 2, "last_activity_date": 1488405082, "creation_date": 1488405082, "answer_id": 42542778, "question_id": 42542673, "link": "https://stackoverflow.com/questions/42542673/vba-if-statement-and-for-loop-moving-to-the-cell-below/42542778#42542778", "title": "VBA If Statement and For Loop moving to the cell below", "body": "<p>You need to redefine the ranges you are checking each time the row increases. The way you do that is below:</p>\n\n<pre><code>Sub startYear()\n\nDim Year As Range, GapYear As Range, Col3 As Range\n\nlastRow = ActiveWorkbook.ActiveSheet.UsedRange.Rows.Count\n\nFor Row = 1 To lastRow\n  Set Year = Range(\"A\" &amp; Row)\n  Set GapYear = Range(\"B\" &amp; Row)\n  Set Col3 = Range(\"C\" &amp; Row)\n  If Year = \"Year 13\" And GapYear = \"Yes\" Then Col3 = \"2018\"\n  If Year = \"Year 13\" And GapYear = \"No\" Then Col3 = \"2017\"\n  If Year = \"Year 12\" And GapYear = \"Yes\" Then Col3 = \"2019\"\n  If Year = \"Year 12\" And GapYear = \"No\" Then Col3 = \"2018\"\n\nNext Row\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1488405098, "creation_date": 1488405098, "answer_id": 42542785, "question_id": 42542673, "link": "https://stackoverflow.com/questions/42542673/vba-if-statement-and-for-loop-moving-to-the-cell-below/42542785#42542785", "title": "VBA If Statement and For Loop moving to the cell below", "body": "<p>Just doing a loop does not change the variables that you have hard coded.</p>\n\n<pre><code>Sub startYear()\n\nDim rw As Long\n\nWith ActiveWorkbook.ActiveSheet\n    LastRow = .UsedRange.Rows.Count\n    For rw = 2 To LastRow\n         If .Cells(rw, 1) = \"Year 13\" And .Cells(rw, 2) = \"Yes\" Then .Cells(rw, 3) = \"2018\"\n         If .Cells(rw, 1) = \"Year 13\" And .Cells(rw, 2) = \"No\" Then .Cells(rw, 3) = \"2017\"\n         If .Cells(rw, 1) = \"Year 12\" And .Cells(rw, 2) = \"Yes\" Then .Cells(rw, 3) = \"2019\"\n         If .Cells(rw, 1) = \"Year 12\" And .Cells(rw, 2) = \"No\" Then .Cells(rw, 3) = \"2018\"\n    Next Row\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 3246338, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a99a0ab2e41d7e8cf67ea7d417f41dbb?s=128&d=identicon&r=PG&f=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/3246338/pete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1317, "favorite_count": 0, "accepted_answer_id": 42542778, "answer_count": 2, "score": 0, "last_activity_date": 1488405098, "creation_date": 1488404648, "question_id": 42542673, "link": "https://stackoverflow.com/questions/42542673/vba-if-statement-and-for-loop-moving-to-the-cell-below", "title": "VBA If Statement and For Loop moving to the cell below", "body": "<p>I have 3 columns in my xlSheet</p>\n\n<pre><code>Year      GapYear   Col3\nYear 13   Yes       2018\nYear 12   No    \nYear 13   Yes   \nYear 12   No    \n</code></pre>\n\n<p>I want vba to work out the start year in col3 based on my if statement logic:</p>\n\n<pre><code>Sub startYear()\n\n\nDim Year As Range\nSet Year = Range(\"A2\")\n\nDim GapYear As Range\nSet GapYear = Range(\"B2\")\n\nDim Col3 As Range\nSet Col3 = Range(\"C2\")\n\n\n\nlastRow = ActiveWorkbook.ActiveSheet.UsedRange.Rows.Count\nFor Row = 1 To lastRow\n\n\n     If Year = \"Year 13\" And GapYear = \"Yes\" Then Col3 = \"2018\"\n     If Year = \"Year 13\" And GapYear = \"No\" Then Col3 = \"2017\"\n     If Year = \"Year 12\" And GapYear = \"Yes\" Then Col3 = \"2019\"\n     If Year = \"Year 12\" And GapYear = \"No\" Then Col3 = \"2018\"\n\n\nNext Row\n\nEnd Sub\n</code></pre>\n\n<p>The code only works out cell C2 and doesn't move down to work out the other rows. I have tried changing the ranges to the whole column e.g. Range(\"C:C\") but I get a type mismatch error. I have also tried adding activecell.offset(1,0)  in the for loop which moves the activecell down but cell C3 remains blank.</p>\n\n<p>I have hundreds of entries in columns A (Year) and B (GapYear), how can I get the code to work through each row and give the correct answer in col3?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1370, "user_id": 1877752, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/yKkk4.png?s=128&g=1", "display_name": "Greg the Incredulous", "link": "https://stackoverflow.com/users/1877752/greg-the-incredulous"}, "edited": false, "score": 0, "creation_date": 1488408542, "post_id": 42541880, "comment_id": 72223008, "body": "What have you tried? This should be a fairly simple task that you would be able to find the answer to in a search engine. You could try recording a macro, then doing the copy, stopping the macro and inspecting the recorded macro as a starting point."}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1488444394, "post_id": 42541880, "comment_id": 72236314, "body": "Record a macro while you copy/paste your columns then press Alt+F8 and click on the edit option.  This will open the VBA IDE where you can review the code to gain an idea of how VBA works.  Chances are the recorded macro will contain lots of <code>Activate</code> and <code>Select</code> commands which, over time, you will learn to eliminate.  Google is a handy tool for beginners too.  Obtain a good beginner&#39;s VBA tutorial or book."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1488402042, "creation_date": 1488402042, "answer_id": 42541968, "question_id": 42541880, "link": "https://stackoverflow.com/questions/42541880/macro-to-copy-column-i-f-g-from-one-worksheet-into-column-a-b-and-c/42541968#42541968", "title": "Macro to copy column I, F, G from one worksheet into column A, B and C", "body": "<pre><code>Sub cpy()\n\n    Worksheets(\"Sheet1\").Range(\"I:I\").Copy Worksheets(\"Sheet2\").Range(\"A:A\")\n    Worksheets(\"Sheet1\").Range(\"F:F\").Copy Worksheets(\"Sheet2\").Range(\"B:B\") \n    Worksheets(\"Sheet1\").Range(\"G:G\").Copy Worksheets(\"Sheet2\").Range(\"C:C\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7643759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b263c2ba97079366d95fc6e65196bf19?s=128&d=identicon&r=PG&f=1", "display_name": "alii", "link": "https://stackoverflow.com/users/7643759/alii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1523359892, "creation_date": 1488401756, "last_edit_date": 1531164843, "question_id": 42541880, "link": "https://stackoverflow.com/questions/42541880/macro-to-copy-column-i-f-g-from-one-worksheet-into-column-a-b-and-c", "title": "Macro to copy column I, F, G from one worksheet into column A, B and C", "body": "<p>Really new to VBA, wondering how to write a macro to copy column I, F, G from one worksheet into column A, B and C? </p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "is_accepted": false, "score": 0, "last_activity_date": 1488451120, "creation_date": 1488451120, "answer_id": 42553065, "question_id": 42541721, "link": "https://stackoverflow.com/questions/42541721/word-userform-vba-hyperlink-from-bookmark/42553065#42553065", "title": "Word UserForm VBA: Hyperlink from Bookmark", "body": "<pre><code>Hyperlinks.Add(ActiveDocument.Bookmarks.Add \"benchmark\", benchmarkURL)\n</code></pre>\n\n<p>There are at least two things wrong with this line, possibly more depending on what it is you want the hyperlink to link to.</p>\n\n<ol>\n<li>You have omitted the parent object for the Hyperlink which should be ActiveDocument.</li>\n<li>There should not be any brackets as the return value of\nHyperlinks.Add is not being assigned to anything.</li>\n</ol>\n\n<p>You can find further info here: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837214(v=office.15).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff837214(v=office.15).aspx</a></p>\n"}, {"tags": [], "owner": {"reputation": 573, "user_id": 455748, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/b82ce6d54924a8bfdc89fd606f6eb157?s=128&d=identicon&r=PG", "display_name": "James Hayek", "link": "https://stackoverflow.com/users/455748/james-hayek"}, "is_accepted": false, "score": 0, "last_activity_date": 1488463956, "creation_date": 1488463956, "answer_id": 42557729, "question_id": 42541721, "link": "https://stackoverflow.com/questions/42541721/word-userform-vba-hyperlink-from-bookmark/42557729#42557729", "title": "Word UserForm VBA: Hyperlink from Bookmark", "body": "<p>I found a better solution. For those that need, it is posted below:</p>\n\n<pre><code>'URL of Benchmark Data\nDim benchmarkURL As Range\nSet benchmarkURL = ActiveDocument.Bookmarks(\"benchmark\").Range\nbenchmarkURL.Text = Me.benchmarkURLTextBox.Value\nActiveDocument.Hyperlinks.Add Anchor:=benchmarkURL, Address:= _\nbenchmarkURL.Text, SubAddress:=\"\", ScreenTip:=\"\", TextToDisplay:= _\n\"Benchmark Data\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 661, "user_id": 197089, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/49b9ab65bf50ff06ccbd0f4934f74a12?s=128&d=identicon&r=PG", "display_name": "Chasester", "link": "https://stackoverflow.com/users/197089/chasester"}, "is_accepted": false, "score": 0, "last_activity_date": 1588794205, "creation_date": 1588794205, "answer_id": 61643997, "question_id": 42541721, "link": "https://stackoverflow.com/questions/42541721/word-userform-vba-hyperlink-from-bookmark/61643997#61643997", "title": "Word UserForm VBA: Hyperlink from Bookmark", "body": "<p>Just to provide some further description to Jame's answer.</p>\n\n<pre><code>'URL of Benchmark Data\nDim benchmarkURL As Range\nSet benchmarkURL = ActiveDocument.Bookmarks(\"benchmark\").Range\nbenchmarkURL.Text = Me.benchmarkURLTextBox.Value\nActiveDocument.Hyperlinks.Add Anchor:=benchmarkURL, Address:=benchmarkURL.Text, SubAddress:=\"\", ScreenTip:=\"\", TextToDisplay:=\"Benchmark Data\"\n</code></pre>\n\n<p>means put this information in.</p>\n\n<pre><code>'URL of Benchmark Data\nActiveDocument.Hyperlinks.Add Anchor:=&lt;&lt;Where link will display&gt;&gt;, Address:= &lt;&lt;Where the link will go to&gt;&gt;, SubAddress:=\"\", ScreenTip:=\"\", TextToDisplay:=\"&lt;&lt;what the link     text should say\"\n</code></pre>\n\n<p>This is my working version.  In my instance I take text like this AC-2 in a table cell and make a bookmark with AC2.  One table with AC-2 clicks to another table with AC-2 that is bookmarked.  </p>\n\n<pre><code>'/////////////\nSet benchmarkURL = oDoc.Bookmarks(strText2).Range\nWith oDoc.Tables(r).Cell(i, 1)\n  .Range.Hyperlinks.Add Anchor:=oDoc.Tables(r).Cell(i, 1).Range, Address:=\"\", SubAddress:=strText2, ScreenTip:=\"\", TextToDisplay:=strText\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 573, "user_id": 455748, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/b82ce6d54924a8bfdc89fd606f6eb157?s=128&d=identicon&r=PG", "display_name": "James Hayek", "link": "https://stackoverflow.com/users/455748/james-hayek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 961, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1593756135, "creation_date": 1488401179, "last_edit_date": 1593756135, "question_id": 42541721, "link": "https://stackoverflow.com/questions/42541721/word-userform-vba-hyperlink-from-bookmark", "title": "Word UserForm VBA: Hyperlink from Bookmark", "body": "<p>I am able to populate a bookmarked location on a Word Document from user input via a UserForm.</p>\n\n<p>What I would like to do is convert the text entered into a Hyperlink.</p>\n\n<p>The following snippit of code was used to insert the text into the appropriate location:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim benchmarkURL As Range\n    Set benchmarkURL = ActiveDocument.Bookmarks(\"benchmark\").Range\n    benchmarkURL.Text = Me.benchmarkURLTextBox.Value\n    ActiveDocument.Bookmarks.Add \"benchmark\", benchmarkURL\n\n    Me.Repaint\n\n    'Update the fields to populate the references of the bookmarks\n    UpdateAllFields\n\n    UserForm1.Hide\n\nEnd Sub\n</code></pre>\n\n<p>I tried the following which did not work:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim benchmarkURL As Range\n    Set benchmarkURL = ActiveDocument.Bookmarks(\"benchmark\").Range\n    benchmarkURL.Text = Me.benchmarkURLTextBox.Value\n    Hyperlinks.Add(ActiveDocument.Bookmarks.Add \"benchmark\", benchmarkURL)\n\n    Me.Repaint\n\n    'Update the fields to populate the references of the bookmarks\n    UpdateAllFields\n\n    UserForm1.Hide\n\nEnd Sub\n</code></pre>\n\n<p>Any advice will be much appreciated</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7643557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8649f653b286877f75bd0b4e51fe0dea?s=128&d=identicon&r=PG&f=1", "display_name": "Trial Run", "link": "https://stackoverflow.com/users/7643557/trial-run"}, "edited": false, "score": 0, "creation_date": 1488409548, "post_id": 42543372, "comment_id": 72223427, "body": "M.Doerner... thanks so much!  I am getting a syntax error, missing operator!?"}, {"owner": {"reputation": 652, "user_id": 5536802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9b9b8552d6dce5be435a0ce83015bb?s=128&d=identicon&r=PG&f=1", "display_name": "M.Doerner", "link": "https://stackoverflow.com/users/5536802/m-doerner"}, "reply_to_user": {"reputation": 13, "user_id": 7643557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8649f653b286877f75bd0b4e51fe0dea?s=128&d=identicon&r=PG&f=1", "display_name": "Trial Run", "link": "https://stackoverflow.com/users/7643557/trial-run"}, "edited": false, "score": 0, "creation_date": 1488413462, "post_id": 42543372, "comment_id": 72224775, "body": "@TrialRun Sorry, I forgot to close the parentheses of the <code>SUM</code>. Edited it."}, {"owner": {"reputation": 13, "user_id": 7643557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8649f653b286877f75bd0b4e51fe0dea?s=128&d=identicon&r=PG&f=1", "display_name": "Trial Run", "link": "https://stackoverflow.com/users/7643557/trial-run"}, "edited": false, "score": 0, "creation_date": 1488414843, "post_id": 42543372, "comment_id": 72225207, "body": "Wow, man that is perfect!  I sincerely appreciate the assistance and your solution was much easier than some of the other stuff I was trying!  Thanks again, sir!"}], "tags": [], "owner": {"reputation": 652, "user_id": 5536802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9b9b8552d6dce5be435a0ce83015bb?s=128&d=identicon&r=PG&f=1", "display_name": "M.Doerner", "link": "https://stackoverflow.com/users/5536802/m-doerner"}, "is_accepted": true, "score": 0, "last_activity_date": 1488413407, "last_edit_date": 1488413407, "creation_date": 1488407488, "answer_id": 42543372, "question_id": 42541560, "link": "https://stackoverflow.com/questions/42541560/access-sql-i-need-a-query-to-count-fields-based-on-several-criteria/42543372#42543372", "title": "Access SQL - I need a query to count fields based on several criteria", "body": "<p>There is a simple trick you can use here: summing over indicator functions.</p>\n\n<p>The indicator function for self reviews would be <code>Switch(Supervisor = Reviewer,1,True,0)</code>.</p>\n\n<p>That leads to the following query:</p>\n\n<pre><code>SELECT \n  T.Reviewer, \n  COUNT(*) AS TotalReviews, \n  SUM(Switch(T.Supervisor = T.Reviewer,1,True,0)) AS Self_Reviews,\n  SUM(Switch(T.Supervisor &lt;&gt; T.Reviewer,1,True,0)) AS Cross_Reviews \nFROM TableName T\nGROUP BY T.Reviewer\n</code></pre>\n\n<p>In other environments than Access, the indicator function would typically be the fllowing:</p>\n\n<pre><code>CASE WHEN Supervisor = Reviewer THEN 1 ELSE 0 END\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7643557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8649f653b286877f75bd0b4e51fe0dea?s=128&d=identicon&r=PG&f=1", "display_name": "Trial Run", "link": "https://stackoverflow.com/users/7643557/trial-run"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "accepted_answer_id": 42543372, "answer_count": 1, "score": 0, "last_activity_date": 1488413407, "creation_date": 1488400579, "last_edit_date": 1488402907, "question_id": 42541560, "link": "https://stackoverflow.com/questions/42541560/access-sql-i-need-a-query-to-count-fields-based-on-several-criteria", "title": "Access SQL - I need a query to count fields based on several criteria", "body": "<p>I have used stackoverflow for years and usually I have been able to find what I need through searching but I apologize, I couldn't find an example like this.  I am extremely new to this stuff but love doing it at work to assist with various projects.  </p>\n\n<p>I work in the insurance claims industry, we have insurance claims as electronic files.  The supervisors do reviews of these files, simply called a file review. I have an Access db which I use to track all the file reviews at work. </p>\n\n<p>Sometimes as Claims Supervisors we are doing a file review on our OWN associates, meaning the associate reports to me.  Other times I am doing a file review on an associate who reports to a DIFFERENT supervisor.</p>\n\n<p>My master table looks like this (with lots of other columns) and each record indicates a file review:</p>\n\n<pre><code>ClaimNumber | Supervisor | Reviewer\n----------- | -----------| ------------\n1---------- | ---Bob-----| Bob \n2---------- | ---Bob-----| Amy \n3---------- | ---John----| Amy \n4---------- | ---John----| Dean\n5---------- | ---John----| John \n6---------- | ---Dean----| Dean \n7---------- | ---Dean----| Dean \n8---------- | ---Dean----| Bob \n9---------- | ---Kyle----| Bob\n10--------- | ---Bob-----| Shawn \n</code></pre>\n\n<p>Depending on if a join is used, please note that sometimes a supervisor name is not listed a single time in the reviewer column.  Likewise, sometimes a reviewer name is not listed a single time in the supervisor column.  </p>\n\n<p>So, I need a single query that returns</p>\n\n<pre><code>Reviewer  ------  TotalReviews ----  Self_Reviews ---- Cross_Reviews\n</code></pre>\n\n<p>The reviewer is all the unique reviewers</p>\n\n<p>TotalReviews is a count of how many times that reviewer's name is listed in reviewer column</p>\n\n<p>Self reviews is a count of how many times that reviewer's name is listed in the reviewer column where their name is equal to the supervisor name for that particular record</p>\n\n<p>Cross reviews is a count of how many times that reviewer's name is listed in the reviewer column where their name is NOT equal to the supervisor name for that particular record</p>\n\n<p>Bob has 3 reviews total, 1 self,  2 cross</p>\n\n<p>Amy has 2 reviews total, 0 self, 2 cross</p>\n\n<p>Dean has 3 reviews total, 2 self, 1 cross</p>\n\n<p>John has 1 review, 1 self, 0 cross</p>\n\n<p>Shawn has 1 review, 0 self, 1 cross</p>\n\n<p>I know this seems complex to me but I am hoping someone can assist to make it much easier.  I am just using Access so any oracle or other SQL syntax may not work.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1488400374, "post_id": 42541454, "comment_id": 72218697, "body": "Compare to which column on Sheet2?"}, {"owner": {"reputation": 3, "user_id": 7606893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b432b397e4d1fd9bfa98088eac103cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Astronut11", "link": "https://stackoverflow.com/users/7606893/astronut11"}, "edited": false, "score": 0, "creation_date": 1488400490, "post_id": 42541454, "comment_id": 72218761, "body": "Hi Scott, not comparing to a column on sheet 2. I just want it to print the value of the name in column A to anywhere on sheet 2. So far I have something like the code shown in my question but I need to either incorporate a loop or figure out the lookup functions..."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7606893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b432b397e4d1fd9bfa98088eac103cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Astronut11", "link": "https://stackoverflow.com/users/7606893/astronut11"}, "edited": false, "score": 0, "creation_date": 1488402019, "post_id": 42541746, "comment_id": 72219667, "body": "Hi John, this is a great starting point! Thank you. I think I am following the logic. We select all of row G, then find the last row. Starting at G1 it searches down and if the value is a number greater than 0 it prints the address, value and row. How do I navigate to the column that contains the name using this row in order to copy?"}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1488401259, "creation_date": 1488401259, "answer_id": 42541746, "question_id": 42541454, "link": "https://stackoverflow.com/questions/42541454/find-non-zero-value-in-column-g-on-sheet-1-return-value-of-column-c-in-that-row/42541746#42541746", "title": "Find non zero value in column G on sheet 1, return value of Column C in that row to sheet 2 (VBA)", "body": "<p>Here is the logic you'll need.  Will you be able to build the macro with this logic?  It will help you understand how to maneuver rows that are greater than zero.  Then you copy the column on that row y9ou need and paste it to the other sheet.  </p>\n\n<pre><code>Sub macro1()\nDim myRng As Range, lastRow As Long\n\n\nlastRow = ActiveSheet.Range(\"G65536\").End(xlUp).Row\n\nSet myRng = Sheet1.Range(\"G1:G\" &amp; lastRow)\n\nFor Each Rng In myRng\n    If IsNumeric(Rng.Value) And Rng.Value &gt; 0 Then\n        Debug.Print \"Cell \" &amp; Rng.Address &amp; \" has the number \" &amp; Rng.Value &amp; \" in row \" &amp; Rng.Row\n    End If\nNext Rng\n\n\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 7606893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b432b397e4d1fd9bfa98088eac103cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Astronut11", "link": "https://stackoverflow.com/users/7606893/astronut11"}, "edited": false, "score": 0, "creation_date": 1488402286, "post_id": 42541875, "comment_id": 72219818, "body": "This is great start! Thank you. How can I make this iterate so it finds all values greater than zero and prints the associated name?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 3, "user_id": 7606893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b432b397e4d1fd9bfa98088eac103cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Astronut11", "link": "https://stackoverflow.com/users/7606893/astronut11"}, "edited": false, "score": 0, "creation_date": 1488402430, "post_id": 42541875, "comment_id": 72219895, "body": "@Astronut11 Remove the <code>Exit For</code>, and change <code>5</code> to be a variable, and increment that variable each time you write something (or don&#39;t increment the variable if you just want to keep writing to the same cell - that&#39;s a bit pointless though)"}, {"owner": {"reputation": 3, "user_id": 7606893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b432b397e4d1fd9bfa98088eac103cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Astronut11", "link": "https://stackoverflow.com/users/7606893/astronut11"}, "edited": false, "score": 0, "creation_date": 1488402742, "post_id": 42541875, "comment_id": 72220039, "body": "Yes! This is perfect. Thank you so much."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1488402576, "last_edit_date": 1488402576, "creation_date": 1488401731, "answer_id": 42541875, "question_id": 42541454, "link": "https://stackoverflow.com/questions/42541454/find-non-zero-value-in-column-g-on-sheet-1-return-value-of-column-c-in-that-row/42541875#42541875", "title": "Find non zero value in column G on sheet 1, return value of Column C in that row to sheet 2 (VBA)", "body": "<p>The following code will find the first row which has a number greater than 0 in column G (starting at row 6), and write the value in column C of that row to cell X5 of Sheet2.</p>\n\n<pre><code>With Worksheets(\"Sheet1\")\n    For Each c In .Range(\"G6\", .Cells(.Rows.Count, \"G\").End(xlUp)).Cells\n        If c.Value &gt; 0 Then\n            Worksheets(\"Sheet2\").Cells(5, \"X\").Value = c.Offset(0, -4).Value\n\n            Exit For ' Moved this inside the `If`, otherwise it will exit as soon as\n                     ' the first cell in the range is processed, irrespective of whether\n                     ' it was greater than 0 or not\n        End If\n    Next c\nEnd With\n</code></pre>\n\n<hr>\n\n<p>Iterative version:</p>\n\n<pre><code>Dim s2Row as Long\ns2Row = 5\nWith Worksheets(\"Sheet1\")\n    For Each c In .Range(\"G6\", .Cells(.Rows.Count, \"G\").End(xlUp)).Cells\n        If c.Value &gt; 0 Then\n            Worksheets(\"Sheet2\").Cells(s2Row, \"X\").Value = c.Offset(0, -4).Value\n            s2Row = s2Row + 1\n        End If\n    Next c\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1488461808, "creation_date": 1488461808, "answer_id": 42556983, "question_id": 42541454, "link": "https://stackoverflow.com/questions/42541454/find-non-zero-value-in-column-g-on-sheet-1-return-value-of-column-c-in-that-row/42556983#42556983", "title": "Find non zero value in column G on sheet 1, return value of Column C in that row to sheet 2 (VBA)", "body": "<p>Yes, except \"G\" is a column, not a row.  Replace the debug.print line with WorkSheets(\"sheet name to copy from here\").Rows(rng.row).Copy Destination:=WorkSheets(\"sheet name to copy to here\").Range(\"A\" &amp; rowCounterVariable).  Of course, change the sheet names to your actual sheet names.</p>\n\n<p>Here I set the first row at 2 on the page to copy to.  If you need to set it to the first available row then you need to research how to find the last used row on that page.  Put these exact terms into Google \"VBA EXCEL HOW TO FIND LAST USED ROW\".  I have an example of finding the last used row for the activesheet inside the code.  We could give you fish today, and teach you how to fish.  But you need to catch your own.  We're not here to write code for you.    </p>\n\n<pre><code>Sub macro2()\nDim myRng As Range, lastRow As Long, rowCounterVariable as long\n\nrowCounterVariable = 2\nlastRow = ActiveSheet.Range(\"G65536\").End(xlUp).Row\n\nSet myRng = Sheet1.Range(\"G1:G\" &amp; lastRow)\n\nFor Each Rng In myRng\n    If IsNumeric(Rng.Value) And Rng.Value &gt; 0 Then\n       WorkSheets(\"sheet name to copy from here\").Rows(rng.row).Copy Destination:=WorkSheets(\"sheet name to copy to here\").Range(\"A\" &amp; rowCounterVariable)\n         rowCounterVariable = rowCounterVariable + 1\n    End If\nNext Rng\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7606893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b432b397e4d1fd9bfa98088eac103cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Astronut11", "link": "https://stackoverflow.com/users/7606893/astronut11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1719, "favorite_count": 0, "accepted_answer_id": 42541875, "answer_count": 3, "score": 0, "last_activity_date": 1488461808, "creation_date": 1488400180, "last_edit_date": 1488401513, "question_id": 42541454, "link": "https://stackoverflow.com/questions/42541454/find-non-zero-value-in-column-g-on-sheet-1-return-value-of-column-c-in-that-row", "title": "Find non zero value in column G on sheet 1, return value of Column C in that row to sheet 2 (VBA)", "body": "<p>My first sheet is set up like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9ZJtm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9ZJtm.png\" alt=\"enter image description here\"></a></p>\n\n<ol>\n<li><p>I want to find the non zero values in column G. Then I want to read the corresponding name in column C. I, then, want to return the value of the name to a cell on Sheet 2.</p></li>\n<li><p>At this point, it doesn't matter what cell it returns to in sheet 2.  It sounds like a VLOOKUP or INDEXMATCH but my VBA isn't good enough to figure out the formatting of it. This is some code that I tried and I can get it to return the name. But I don't know how to do it for all non zeros or how to have it print to sheet 2. Need a loop or need to figure out look ups!</p></li>\n</ol>\n\n<p>code:</p>\n\n<pre><code>For Each c In Range(\"G6\").Cells\n\n  If c.Value &gt; 0 Then\n\n    PlayerName = Range(Cells(Selection.Row, 3).Address).Value\n\nEnd If\n\nExit For\n\nNext c\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 173, "user_id": 7308462, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/39456abd68e4734be9caa4b3204a8315?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7308462/john-tipton"}, "reply_to_user": {"reputation": 10761, "user_id": 2592875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4abcf57451cf62e63e8e191421c6709e?s=128&d=identicon&r=PG", "display_name": "TnTinMn", "link": "https://stackoverflow.com/users/2592875/tntinmn"}, "edited": false, "score": 0, "creation_date": 1488399329, "post_id": 42541110, "comment_id": 72218112, "body": "nope it&#39;s not! Maybe that was causing issue @TnTinMn"}, {"owner": {"reputation": 173, "user_id": 7308462, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/39456abd68e4734be9caa4b3204a8315?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7308462/john-tipton"}, "reply_to_user": {"reputation": 10761, "user_id": 2592875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4abcf57451cf62e63e8e191421c6709e?s=128&d=identicon&r=PG", "display_name": "TnTinMn", "link": "https://stackoverflow.com/users/2592875/tntinmn"}, "edited": false, "score": 0, "creation_date": 1488399401, "post_id": 42541110, "comment_id": 72218147, "body": "@TnTinMn Ha! It does work! Please post a question, i&#39;ll accept it. Thank you!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1488399557, "post_id": 42541110, "comment_id": 72218235, "body": "@YowE3K OP is new to vba, and does not understand that the <code>_</code> indicates that the next line is part of the first."}, {"owner": {"reputation": 173, "user_id": 7308462, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/39456abd68e4734be9caa4b3204a8315?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7308462/john-tipton"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1488399578, "post_id": 42541110, "comment_id": 72218253, "body": "@YowE3K My goal is delete the first row on Sheet1.  Since I used &#39;Replace_&#39; I thought I also had to use &#39;Delete_&#39;."}, {"owner": {"reputation": 173, "user_id": 7308462, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/39456abd68e4734be9caa4b3204a8315?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7308462/john-tipton"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1488399673, "post_id": 42541110, "comment_id": 72218309, "body": "@ScottCraner thank you for the comment! Learning every day!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1488400956, "post_id": 42541110, "comment_id": 72219012, "body": "The line continuation token is [WS]+[UNDERSCORE]; in <code>Delete_</code> the underscore is considered part of the <code>Delete</code> method name (and <code>Delete_</code> doesn&#39;t exist as a member of <code>Range</code>, hence error 438); also a line continuation would be illegal there anyway. Avoid line continuations whenever possible."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1488400997, "post_id": 42541110, "comment_id": 72219039, "body": "You actually used <code>...Replace _</code> (with a space to separate the underscore from the preceding token).  Without the space, <code>Replace_</code> would have given compilation errors on the <code>What...</code> line (as it isn&#39;t valid syntax).  If you had been consistent and used <code>...Delete _</code> (with a space) you would have also gotten syntax errors and it would have highlighted the line starting at the <code>W</code> on the <code>Delete</code> line and ending at the <code>B</code> of that line."}, {"owner": {"reputation": 173, "user_id": 7308462, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/39456abd68e4734be9caa4b3204a8315?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7308462/john-tipton"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1488401572, "post_id": 42541110, "comment_id": 72219385, "body": "@Mat&#39;sMug Thank you so much! I couldn&#39;t be more grateful!"}, {"owner": {"reputation": 173, "user_id": 7308462, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/39456abd68e4734be9caa4b3204a8315?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7308462/john-tipton"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1488401602, "post_id": 42541110, "comment_id": 72219403, "body": "@YowE3K Very wise answer. Underscore was the key. Thank you so so much as always!!"}], "answers": [{"tags": [], "owner": {"reputation": 10761, "user_id": 2592875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4abcf57451cf62e63e8e191421c6709e?s=128&d=identicon&r=PG", "display_name": "TnTinMn", "link": "https://stackoverflow.com/users/2592875/tntinmn"}, "is_accepted": true, "score": 1, "last_activity_date": 1488399655, "creation_date": 1488399655, "answer_id": 42541295, "question_id": 42541110, "link": "https://stackoverflow.com/questions/42541110/excel-vba-underscore-delete/42541295#42541295", "title": "Excel vba Underscore .Delete_", "body": "<p>You have an extra character in the Delete method name.<br>\n<code>Worksheets(\"Sheet1\").Range(\"1:1\").Delete_</code><br>\nRemove the underscore.</p>\n\n<p>Learn to use the \"F1\" key to bring up the built in help system.  It is there for a reason.</p>\n"}], "owner": {"reputation": 173, "user_id": 7308462, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/39456abd68e4734be9caa4b3204a8315?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7308462/john-tipton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 42541295, "answer_count": 1, "score": 0, "last_activity_date": 1488401657, "creation_date": 1488399066, "last_edit_date": 1488401657, "question_id": 42541110, "link": "https://stackoverflow.com/questions/42541110/excel-vba-underscore-delete", "title": "Excel vba Underscore .Delete_", "body": "<p>I can't seem to find the right answer that fits to my code. </p>\n\n<p>I'm trying to delete the first row on <code>Sheet1</code>\nI'm sure my code below would work</p>\n\n<p>But throws me a Run time error '438'. Object doesn't support this property or method.  </p>\n\n<pre><code>Worksheets(\"Sheet1\").Range(\"1:1\").Delete_\n</code></pre>\n\n<p>The following is my code:</p>\n\n<pre><code>Option Explicit\nSub C2P()\n        Worksheets(\"Sheet1\").Range(\"C:C,F:F\").Replace _\n            What:=\",\", replacement:=\".\", LookAt:=xlPart\n        Worksheets(\"Sheet1\").Range(\"1:1\").Delete_\nEnd Sub\n</code></pre>\n\n<p>Any feedback would be appreciated. Thank you!</p>\n"}, {"tags": ["arrays", "excel", "vba", "integer", "repeat"], "comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1488402969, "post_id": 42540978, "comment_id": 72220169, "body": "there are numerous ways you can solve this. You can use a dictionary to keep the record of existing numbers in the array (key) and count of them (item). Then you can convert the dictionary to an array using a simple loop if the count was 3 or higher."}], "answers": [{"tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": true, "score": 2, "last_activity_date": 1488403878, "creation_date": 1488403878, "answer_id": 42542430, "question_id": 42540978, "link": "https://stackoverflow.com/questions/42540978/find-repeating-numbers-in-array-vba/42542430#42542430", "title": "Find repeating numbers in array vba", "body": "<p>Consider the below example:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub Test()\n\n    Dim i\n    Dim numbers(0 To 49)\n    Dim repeating()\n    Dim q\n\n    ' Fill array with random numers\n    Randomize\n    For i = 0 To 49\n        numbers(i) = Int(20 * Rnd)\n    Next\n\n    ' Filter repeating elements\n    With CreateObject(\"Scripting.Dictionary\")\n        ' Count each number qty\n        For i = 0 To 49\n            .Item(numbers(i)) = .Item(numbers(i)) + 1\n        Next\n        ' Remove non-repeating\n        For Each q In .Keys()\n            If .Item(q) = 1 Then .Remove q\n        Next\n        ' Retrieve array\n        repeating = .Keys()\n    End With\n\n    Debug.Print Join(numbers)\n    Debug.Print Join(repeating)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 7643480, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210936309557920/picture?type=large", "display_name": "Brian Neumann", "link": "https://stackoverflow.com/users/7643480/brian-neumann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1138, "favorite_count": 0, "accepted_answer_id": 42542430, "answer_count": 1, "score": 2, "last_activity_date": 1488403878, "creation_date": 1488398616, "question_id": 42540978, "link": "https://stackoverflow.com/questions/42540978/find-repeating-numbers-in-array-vba", "title": "Find repeating numbers in array vba", "body": "<p>I am trying to create an array of size 50 in vba of random numbers between 0 and 20 then extracting the numbers that repeat in that array into another array.</p>\n\n<pre><code>Sub Problem10()\nDim numbers() As Double, odd() As Double, even() As Double, five() As Double, repeating() As Double, x As Integer, i As Integer, sOdd As Integer, sEven As Integer, sFive As Integer, sNumbers As Integer, sRepeating As Integer, y As Integer, listed As Boolean\nsRepeating = 0\nsNumbers = 50\nFor i = 1 To sNumbers\n    ReDim Preserve numbers(i)\n    numbers(i) = Int(20 * rnd) \n    'find repeating numbers\n    For x = 1 To i\n        If numbers(x) = numbers(i) And i &lt;&gt; x Then\n            'check if there are any repeated numbers already\n            If sRepeating &gt; 0 And listed = False Then\n                For y = 1 To sRepeating\n                   'check if the number is already listed as a repeated number\n                    If numbers(i) = repeating(y) Then\n                        listed = True\n                    Else\n                        sRepeating = sRepeating + 1\n                        ReDim Preserve repeating(sRepeating)\n                            repeating(sRepeating) = numbers(i)\n                            Cells(sRepeating + 1, 4).Value = repeating(sRepeating)\n                            listed = True\n                    End If\n                Next y\n            End If\n        End If\n    Next x\n    Cells(i + 1, 5).Value = numbers(i)\nNext i\nEnd Sub\n</code></pre>\n\n<p>I am able to create the array with random numbers (numbers()) and then extract new arrays with even, odd numbers and multiples of 5. However, I dont know how to extract only repeating numbers.\nRight now, this only finds the first repeating number and nothing else.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 7565043, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8fb99751eb9b167319cff6dc6d2c7e5a?s=128&d=identicon&r=PG&f=1", "display_name": "gksdmsgP", "link": "https://stackoverflow.com/users/7565043/gksdmsgp"}, "edited": false, "score": 0, "creation_date": 1488468608, "post_id": 42541135, "comment_id": 72253209, "body": "Thank you - the code is finally running and it copied over all the cells in column A of activewkst to wkst but following the last cell copied over, there is a cell that says #NA; also 1000 cells down in wkst it copied over the exact same cells and also the information from column b. Do you know why this is happening?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 17, "user_id": 7565043, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8fb99751eb9b167319cff6dc6d2c7e5a?s=128&d=identicon&r=PG&f=1", "display_name": "gksdmsgP", "link": "https://stackoverflow.com/users/7565043/gksdmsgp"}, "edited": false, "score": 0, "creation_date": 1488468785, "post_id": 42541135, "comment_id": 72253326, "body": "No it should not do that.  Try clearing the sheet and try the code again.  I did adjust the code above to deal with the <code>N&#47;A</code>  Then check your data in the original sheet to ensure it does not duplicate."}, {"owner": {"reputation": 17, "user_id": 7565043, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8fb99751eb9b167319cff6dc6d2c7e5a?s=128&d=identicon&r=PG&f=1", "display_name": "gksdmsgP", "link": "https://stackoverflow.com/users/7565043/gksdmsgp"}, "edited": false, "score": 0, "creation_date": 1488471382, "post_id": 42541135, "comment_id": 72255157, "body": "You&#39;re right - I just had to clear the sheet again. Silly me! Im just curious as to how changing the +7 to +6 cleared the #NA? Also, If I wanted to copy over cells from another worksheet starting from where targetRng left off, how would I go about this?"}, {"owner": {"reputation": 17, "user_id": 7565043, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8fb99751eb9b167319cff6dc6d2c7e5a?s=128&d=identicon&r=PG&f=1", "display_name": "gksdmsgP", "link": "https://stackoverflow.com/users/7565043/gksdmsgp"}, "edited": false, "score": 0, "creation_date": 1488471430, "post_id": 42541135, "comment_id": 72255197, "body": "Set origRng = InactiveWkst.Range(&quot;A23&quot;, InactiveWkst.Cells(InactiveWkst.Rows.Count, 1).End(xlUp)) Set targetRng = Wkst.Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Offset(1) targetRng.Value = origRng.Value was what I was thinking"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 17, "user_id": 7565043, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8fb99751eb9b167319cff6dc6d2c7e5a?s=128&d=identicon&r=PG&f=1", "display_name": "gksdmsgP", "link": "https://stackoverflow.com/users/7565043/gksdmsgp"}, "edited": false, "score": 0, "creation_date": 1488471467, "post_id": 42541135, "comment_id": 72255223, "body": "The target range was one cell too big, so by changing the size it got rid of the N/A.  The second question is a new question an should get a new post, but do some research on how to find the last cell with data."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1488468676, "last_edit_date": 1488468676, "creation_date": 1488399139, "answer_id": 42541135, "question_id": 42540787, "link": "https://stackoverflow.com/questions/42540787/1004-error-for-using-usedrange/42541135#42541135", "title": "1004 error for using usedrange", "body": "<p>This line:</p>\n\n<pre><code>Set targetRng = Wkst.Range(\"A7\" &amp; Wkst.Rows.Count)\n</code></pre>\n\n<p>is not correct.  You are not getting A7:A1048576 but a concatenating of the two.  So it is looking for A71048576 which does not exist</p>\n\n<p>Then you should use similar sized ranges when setting values.</p>\n\n<pre><code>Sub ActiveInactiveVendors()\nDim ActiveWkb As Workbook, Wkb As Workbook, InactiveWkb As Workbook\nDim ActiveWkst As Worksheet, Wkst As Worksheet, InactiveWkst As Worksheet\nDim aCell As Range\nDim targetRng As Range, origRng As Range\n\n\nSet ActiveWkb = Workbooks.Open(\"C:\\Users\\clara\\Desktop\\active vendors.xlsx\")\nSet Wkb = ThisWorkbook\nSet Wkst = Wkb.Sheets(\"Vendors\")\nSet ActiveWkst = ActiveWkb.Worksheets(\"aqlc7da48e7\")\n\n'set column A starting from A7\nSet origRng = ActiveWkst.Range(\"A32\", ActiveWkst.Cells(ActiveWkst.Rows.Count, 1).End(xlUp))\nSet targetRng = Wkst.Range(\"A7\", Wkst.Cells(origRng.Rows.Count + 6, 1))\n'get the values starting from a32 to the last row used and set it in wkst\ntargetRng.Value = origRng.Value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 7565043, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8fb99751eb9b167319cff6dc6d2c7e5a?s=128&d=identicon&r=PG&f=1", "display_name": "gksdmsgP", "link": "https://stackoverflow.com/users/7565043/gksdmsgp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 527, "favorite_count": 0, "accepted_answer_id": 42541135, "answer_count": 1, "score": -2, "last_activity_date": 1488468676, "creation_date": 1488398000, "question_id": 42540787, "link": "https://stackoverflow.com/questions/42540787/1004-error-for-using-usedrange", "title": "1004 error for using usedrange", "body": "<p>I am trying to copy over values from one workbook to another using the usedrange function (there are some blanks in certain rows and it is fine to copy over the blank as well), but I am getting the 1004 error:</p>\n\n<pre><code>Sub ActiveInactiveVendors()\nDim ActiveWkb As Workbook, Wkb As Workbook, InactiveWkb As Workbook\nDim ActiveWkst As Worksheet, Wkst As Worksheet, InactiveWkst As Worksheet\nDim aCell As Range\nDim targetRng As Range\n\n\nSet ActiveWkb = Workbooks.Open(\"C:\\Users\\clara\\Desktop\\active vendors.xlsx\")\nSet Wkb = ThisWorkbook\nSet Wkst = Wkb.Sheets(\"Vendors\")\nSet ActiveWkst = ActiveWkb.Worksheets(\"aqlc7da48e7\")\n\n'set column A starting from A7\nSet targetRng = Wkst.Range(\"A7\" &amp; Wkst.Rows.Count)\n'get the values starting from a32 to the last row used and set it in wkst\ntargetRng.Value = ActiveWkst.Range(\"A32\"  &amp; ActiveWkst.UsedRange.Rows.Count).Value\nEnd Sub\n</code></pre>\n\n<p>I appreciate any feedback! Thank you </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1488396989, "post_id": 42540438, "comment_id": 72216739, "body": "Do what the error says: <code>Set Name = .Range(&quot;L2&quot;)</code>"}, {"owner": {"reputation": 71, "user_id": 7510470, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5ac08b24fe79abdeb438be8a99420c69?s=128&d=identicon&r=PG&f=1", "display_name": "BetaOp9", "link": "https://stackoverflow.com/users/7510470/betaop9"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1488397128, "post_id": 42540438, "comment_id": 72216824, "body": "I feel like an idiot. I thought I tried that. Apparently not. Thanks."}, {"owner": {"reputation": 71, "user_id": 7510470, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5ac08b24fe79abdeb438be8a99420c69?s=128&d=identicon&r=PG&f=1", "display_name": "BetaOp9", "link": "https://stackoverflow.com/users/7510470/betaop9"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1488397368, "post_id": 42540438, "comment_id": 72216959, "body": "If you want to submit that as an answer I&#39;ll make it for you. :-)"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1488397906, "post_id": 42540602, "comment_id": 72217252, "body": "<code>Name</code> is actually a <i>type</i>, in the Excel object model. I don&#39;t think VBA would have any problem telling local variable <code>Name</code> from the <code>Excel.Name</code> type, given the context in which VBA expects a type name to be specified (e.g. an &quot;AsTypeClause&quot;)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1488398233, "post_id": 42540602, "comment_id": 72217461, "body": "@Mat&#39;sMug I am a hack compared to you, so I will defer to your knowledge.  But, I personally would still avoid it, just because my ocd would require it."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1488399540, "post_id": 42540602, "comment_id": 72218224, "body": "Pffft.. You&#39;re too humble! I&#39;m just good at <i>making it look like</i> I know my stuff haha - I actually look up to you, and several other VBA regulars! I&#39;m no MVP! ;-)"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 4, "last_activity_date": 1488397415, "creation_date": 1488397415, "answer_id": 42540602, "question_id": 42540438, "link": "https://stackoverflow.com/questions/42540438/excel-vba-inputbox-not-writing-data-to-cell/42540602#42540602", "title": "Excel VBA - Inputbox not writing data to cell", "body": "<p><code>Name</code> is a range object and all object need to be set:</p>\n\n<pre><code>Set Name = .Range(\"L2\")\n</code></pre>\n\n<p>One note, I would be careful using words that are used in vba.  <code>Name</code> is used in many places.  I would use a variable that does not replace an existing command, like <code>Nme</code></p>\n"}], "owner": {"reputation": 71, "user_id": 7510470, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5ac08b24fe79abdeb438be8a99420c69?s=128&d=identicon&r=PG&f=1", "display_name": "BetaOp9", "link": "https://stackoverflow.com/users/7510470/betaop9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 42540602, "answer_count": 1, "score": 0, "last_activity_date": 1488426206, "creation_date": 1488396842, "last_edit_date": 1488426206, "question_id": 42540438, "link": "https://stackoverflow.com/questions/42540438/excel-vba-inputbox-not-writing-data-to-cell", "title": "Excel VBA - Inputbox not writing data to cell", "body": "<p>I'm having this run at Workbook_Open on a read-only template file that will be reused for new clients. I'm getting an error with the <code>Name = .Range(\"L2\")</code> line that says \"Run-time error '91': Object variable or With block variable not set\" which I'm not entirely sure why it is coming up that way. I'm confident I'm simply overlooking something really simple but any help would be greatly appreciated and if there is a more efficient way of writing this code let me know. I'm eager to learn.</p>\n\n<pre><code>Private Sub Workbook_Open()\nDim tB As Workbook\nDim ws As Worksheet\nDim DailyWS As Worksheet\nDim Client As String\nDim Name As Range\n\nSet tB = ThisWorkbook\nWith tB\n    Set DailyWS = .Sheets(\"Daily Tracker\")\nEnd With 'tB\nWith DailyWS\n    Name = .Range(\"L2\")\nEnd With 'DailyWS\n\n\nIf Len(Name.Value) = 0 Then\n    Client = InputBox(\"Enter your name :\", \"Client's Name Please.\")\n    If Len(Client) = 0 Then 'Checking if Length of name is 0 characters\n        MsgBox \"Please enter a valid name!\", vbCritical\n        Goto Tryagain\n    End If\n    Name.Value = Client\n    If Client = vbNullString Then\n    MsgBox (\"DO NOT CONTINUE!\" &amp; _\n    \"\" &amp; vbCrLf &amp; _\n    \"DO NOT SAVE THIS FILE! \" &amp; vbCrLf &amp; _\n    \"\" &amp; vbCrLf &amp; _\n    \"AT PROMPT PLEASE ENTER A NAME!\" &amp; vbCrLf &amp; _\n    \"\"), vbOKOnly + vbCritical, \"!! Name Required !!\"\n    Goto Tryagain\n    End If\nElse\nMsgBox \"Not Empty (Test)\"\nEnd\nEnd If\nend sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 1, "creation_date": 1488396676, "post_id": 42540093, "comment_id": 72216548, "body": "One option would write the code in Access, then call it from excel. See here: <a href=\"http://stackoverflow.com/questions/9472652/calling-access-sub-from-excel\" title=\"calling access sub from excel\">stackoverflow.com/questions/9472652/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 27, "user_id": 7109846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a01e1bb2b9f9592175575c9e19b4cc7d?s=128&d=identicon&r=PG&f=1", "display_name": "Jayant Kumar jain", "link": "https://stackoverflow.com/users/7109846/jayant-kumar-jain"}, "is_accepted": false, "score": 0, "last_activity_date": 1488526087, "creation_date": 1488526087, "answer_id": 42573064, "question_id": 42540093, "link": "https://stackoverflow.com/questions/42540093/refresh-sharepoint-linked-table-in-access-db-through-excel-vba/42573064#42573064", "title": "Refresh sharepoint linked table in access db through excel vba", "body": "<p>I think ADODB does not support CurrentDb method but DAO does.</p>\n"}], "owner": {"reputation": 875, "user_id": 3612914, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/26500b9a2376eaf42a510a6c137ffe43?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/3612914/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 360, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488526087, "creation_date": 1488395620, "question_id": 42540093, "link": "https://stackoverflow.com/questions/42540093/refresh-sharepoint-linked-table-in-access-db-through-excel-vba", "title": "Refresh sharepoint linked table in access db through excel vba", "body": "<p>I'm trying to refresh sharepoint linked table in access db using excel vba.\nI'v created the connection for access db in excel vba </p>\n\n<pre><code> On Error GoTo ExceptionHandle\n Dim cn As ADODB.Connection, rs As ADODB.Recordset\n\n' connect to the Access database\nSet cn = New ADODB.Connection\ncn.Open \"Provider=Microsoft.ACE.OLEDB.12.0; \" &amp; _\n\"Data Source=C:\\sample.accdb;\"      \n' open a recordset\nSet rs = New ADODB.Recordset\n</code></pre>\n\n<p>but how do i use the method CurrentDb.TableDefs(\"TableName\").RefreshLink . how do i specify the currentdb using with <code>cn</code>.</p>\n"}, {"tags": ["regex", "excel", "vba", "batch-processing"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1488396886, "post_id": 42539709, "comment_id": 72216673, "body": "<code>Len(y)</code> should possibly be <code>Instr(Found.Txt, y) - Instr(Found.Txt, x) + 1</code> (or, if you don&#39;t want the <code>[</code> and <code>]</code> themselves to be coloured red, use <code>Start:=InStr(Found.Text, x) + 1, Length:=Instr(Found.Txt, y) - Instr(Found.Txt, x) - 1</code>)"}, {"owner": {"reputation": 51, "user_id": 6035935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-7pUfAi3aKh4/AAAAAAAAAAI/AAAAAAAAADo/1J3J_O_ofYU/photo.jpg?sz=128", "display_name": "Ilia Shifrin", "link": "https://stackoverflow.com/users/6035935/ilia-shifrin"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1488397478, "post_id": 42539709, "comment_id": 72217014, "body": "@YowE3K it does not work that way at all if I set With to:  <code>With Found.Characters(Start:=InStr(Found.Text, x), Length:=InStr(Found.Txt, y) - InStr(Found.Txt, x) + 1)</code>   per your instructions. Any ideas?"}, {"owner": {"reputation": 729, "user_id": 5248324, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/OfvTl.jpg?s=128&g=1", "display_name": "ToMakPo", "link": "https://stackoverflow.com/users/5248324/tomakpo"}, "edited": false, "score": 0, "creation_date": 1488397595, "post_id": 42539709, "comment_id": 72217073, "body": "on this row: <code>With Found.Characters(Start:=InStr(Found.Text, x), Length:=Len(y))</code> the <code>Length:=</code> value is 1. you need it to be the distance between the number of chars being turned red."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1488397654, "post_id": 42539709, "comment_id": 72217100, "body": "Yeah - I have an idea - enroll me in typing lessons.  (<code>Txt</code> should have been <code>Text</code>.  I found it while testing it before creating an answer.)"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 6035935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-7pUfAi3aKh4/AAAAAAAAAAI/AAAAAAAAADo/1J3J_O_ofYU/photo.jpg?sz=128", "display_name": "Ilia Shifrin", "link": "https://stackoverflow.com/users/6035935/ilia-shifrin"}, "edited": false, "score": 0, "creation_date": 1488398005, "post_id": 42540657, "comment_id": 72217313, "body": "This worked like a charm, thank you!   Would it be possible to include <code>&lt;&gt;</code> as well for HTML/XML tags and <code>{}</code> for variables, e.g. regex &#39;or&#39; into the <code>x = &quot;[|&lt;|{&quot; y = &quot;]|&gt;|}&quot;</code> strings? Not sure how to add them here not to create several modules..."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 51, "user_id": 6035935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-7pUfAi3aKh4/AAAAAAAAAAI/AAAAAAAAADo/1J3J_O_ofYU/photo.jpg?sz=128", "display_name": "Ilia Shifrin", "link": "https://stackoverflow.com/users/6035935/ilia-shifrin"}, "edited": false, "score": 0, "creation_date": 1488398338, "post_id": 42540657, "comment_id": 72217520, "body": "@Ilia - your last comment got cut off because of (I assume) the <code>&lt;</code>, but I have taken a guess at what you were going to ask and have edited the answer accordingly."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 51, "user_id": 6035935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-7pUfAi3aKh4/AAAAAAAAAAI/AAAAAAAAADo/1J3J_O_ofYU/photo.jpg?sz=128", "display_name": "Ilia Shifrin", "link": "https://stackoverflow.com/users/6035935/ilia-shifrin"}, "edited": false, "score": 0, "creation_date": 1488398630, "post_id": 42540657, "comment_id": 72217693, "body": "@Ilia - Using regexs would allow you to process all the bracket types at once, but it would then be difficult to <code>Find</code> them all at once.  You would probably have to process all Cells, rather than just the ones that the <code>Find</code> locates, and I think it will be more efficient to use <code>Find</code> several times rather than going down that route."}, {"owner": {"reputation": 51, "user_id": 6035935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-7pUfAi3aKh4/AAAAAAAAAAI/AAAAAAAAADo/1J3J_O_ofYU/photo.jpg?sz=128", "display_name": "Ilia Shifrin", "link": "https://stackoverflow.com/users/6035935/ilia-shifrin"}, "edited": false, "score": 0, "creation_date": 1488403991, "post_id": 42540657, "comment_id": 72220740, "body": "Agreed. Added 4 sumbodules to your solution to account for all brackets variations and variable expressions. Thank you!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 51, "user_id": 6035935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-7pUfAi3aKh4/AAAAAAAAAAI/AAAAAAAAADo/1J3J_O_ofYU/photo.jpg?sz=128", "display_name": "Ilia Shifrin", "link": "https://stackoverflow.com/users/6035935/ilia-shifrin"}, "edited": false, "score": 0, "creation_date": 1488405902, "post_id": 42540657, "comment_id": 72221778, "body": "@ilia - is it the <code>&lt;&#47; ...&gt;</code> that isn&#39;t being processed correctly, or simply all cases where there are multiple occurrences of a bracket within a cell, e.g. <code>&quot;gdashgd [hadkjdh] adakhsdlk [asdkajh] asgdjahg&quot;</code>.  The current code will only highlight the first one it finds."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 51, "user_id": 6035935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-7pUfAi3aKh4/AAAAAAAAAAI/AAAAAAAAADo/1J3J_O_ofYU/photo.jpg?sz=128", "display_name": "Ilia Shifrin", "link": "https://stackoverflow.com/users/6035935/ilia-shifrin"}, "edited": false, "score": 0, "creation_date": 1488406604, "post_id": 42540657, "comment_id": 72222102, "body": "@Ilia Updated answer to loop through all bracket pairs in each cell."}, {"owner": {"reputation": 51, "user_id": 6035935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-7pUfAi3aKh4/AAAAAAAAAAI/AAAAAAAAADo/1J3J_O_ofYU/photo.jpg?sz=128", "display_name": "Ilia Shifrin", "link": "https://stackoverflow.com/users/6035935/ilia-shifrin"}, "edited": false, "score": 0, "creation_date": 1488408876, "post_id": 42540657, "comment_id": 72223147, "body": "Yup, the first solution was only taking care of the first iteration of the pairs of brackets. Thank you for coming up with the iterative version as well. Much appreciated!"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1488406611, "last_edit_date": 1488406611, "creation_date": 1488397596, "answer_id": 42540657, "question_id": 42539709, "link": "https://stackoverflow.com/questions/42539709/coloring-partial-text-within-cells-in-excel/42540657#42540657", "title": "Coloring partial text within cells in Excel", "body": "<p><code>Len(y)</code> (when <code>y</code> contains a single character) will always return a value of 1.</p>\n\n<p>The correct length you are after is the number of characters between where <code>x</code> exists in the string and where <code>y</code> exists in the string, so you need to use something like:</p>\n\n<pre><code>With Found.Characters(Start:=InStr(Found.Text, x), _\n                      Length:=Instr(Found.Text, y) - Instr(Found.Text, x) + 1)\n</code></pre>\n\n<p>or, if you wanted to not colour the brackets themselves, you could add 1 to the start position and subtract 2 from the length, thus giving:</p>\n\n<pre><code>With Found.Characters(Start:=InStr(Found.Text, x) + 1, _\n                      Length:=Instr(Found.Text, y) - Instr(Found.Text, x) - 1)\n</code></pre>\n\n<hr>\n\n<p>To cater for both <code>[...]</code> and <code>&lt;...&gt;</code> my preference would be to modify the subroutine to allow the type of bracket being searched for to be passed as a parameter, and then call the subroutine twice.</p>\n\n<pre><code>Sub Test\n    Format_Characters_In_Found_Cell \"[\", \"]\"\n    Format_Characters_In_Found_Cell \"&lt;\", \"&gt;\"\nEnd Sub\n\nSub Format_Characters_In_Found_Cell(x As String, y As String)\nDim Found As Range, FoundFirst As Range\n\nOn Error Resume Next\nSet Found = Cells.Find(what:=x, LookIn:=xlValues, LookAt:=xlPart)\nIf Not Found Is Nothing Then\n    Set FoundFirst = Found\n    Do\n      'Format \"x\"\n        With Found.Characters(Start:=InStr(Found.Text, x), _\n                              Length:=Instr(Found.Text, y) - Instr(Found.Text, x) + 1)\n            .Font.ColorIndex = 3\n            .Font.Bold = False\n        End With\n        Set Found = Cells.FindNext(Found)\n    Loop Until FoundFirst.Address = Found.Address\nElse\n    MsgBox x &amp; \" could not be found.\", , \" \"\nEnd If \nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Iterative, and allowing for multiple instances of brackets within a single cell:</p>\n\n<pre><code>Sub Format_Characters_In_Found_Cell(x As String, y As String)\nDim Found As Range, FoundFirst As Range\nDim posStart As Long\nDim posEnd As Long\n\nOn Error Resume Next\nSet Found = Cells.Find(what:=x, LookIn:=xlValues, LookAt:=xlPart)\nIf Not Found Is Nothing Then\n    Set FoundFirst = Found\n    Do\n      'Format \"x\"\n        posStart = InStr(Found.Text, x)\n        Do While posStart &gt; 0\n            posEnd = InStr(posStart + 1, Found.Text, y)\n            If posEnd = 0 Then\n                Exit Do ' no matching end bracket\n            End If\n            With Found.Characters(Start:=posStart, Length:=posEnd - posStart + 1)\n                .Font.ColorIndex = 3\n                .Font.Bold = False\n            End With\n            posStart = InStr(posEnd + 1, Found.Text, x)\n        Loop\n        Set Found = Cells.FindNext(Found)\n    Loop Until FoundFirst.Address = Found.Address\nElse\n    MsgBox x &amp; \" could not be found.\", , \" \"\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 729, "user_id": 5248324, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/OfvTl.jpg?s=128&g=1", "display_name": "ToMakPo", "link": "https://stackoverflow.com/users/5248324/tomakpo"}, "is_accepted": false, "score": 0, "last_activity_date": 1488397930, "creation_date": 1488397930, "answer_id": 42540764, "question_id": 42539709, "link": "https://stackoverflow.com/questions/42539709/coloring-partial-text-within-cells-in-excel/42540764#42540764", "title": "Coloring partial text within cells in Excel", "body": "<pre><code>Sub Format_Characters_In_Found_Cell()\nDim Found As Range, x As String, FoundFirst As Range\n\nx = \"[\"\ny = \"]\"\n\nOn Error Resume Next\nSet Found = Cells.Find(what:=x, LookIn:=xlValues, LookAt:=xlPart)\nIf Not Found Is Nothing Then\n    Set FoundFirst = Found\n    Do\n      'Format \"x\"\n        l = InStr(Found.Text, y) - InStr(Found.Text, x) + 1\n        With Found.Characters(Start:=InStr(Found.Text, x), Length:=l)\n            .Font.ColorIndex = 3\n            .Font.Bold = False\n        End With\n        Set Found = Cells.FindNext(Found)\n    Loop Until FoundFirst.Address = Found.Address\nElse\n    MsgBox x &amp; \" could not be found.\", , \" \"\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 6035935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-7pUfAi3aKh4/AAAAAAAAAAI/AAAAAAAAADo/1J3J_O_ofYU/photo.jpg?sz=128", "display_name": "Ilia Shifrin", "link": "https://stackoverflow.com/users/6035935/ilia-shifrin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 310, "favorite_count": 0, "accepted_answer_id": 42540657, "answer_count": 2, "score": 0, "last_activity_date": 1488406611, "creation_date": 1488394343, "last_edit_date": 1488394653, "question_id": 42539709, "link": "https://stackoverflow.com/questions/42539709/coloring-partial-text-within-cells-in-excel", "title": "Coloring partial text within cells in Excel", "body": "<p>I need to have everything that is in [square brackets] and all HTML/XML tags in these <code>&lt;brackets&gt;</code> colored in generic red on a selected sheet across all cells. The rest of the text in the cells needs to stay black. </p>\n\n<p>I have tried modifying the attached code but was only able to get the brackets turned to red whereas the rest of the text was left in black. I guess I need to add the regex ranges <code>\\[.*?\\]</code> and <code>\\&lt;.*?\\&gt;</code> but not sure how. Please help!</p>\n\n<pre><code>Sub Format_Characters_In_Found_Cell()\nDim Found As Range, x As String, FoundFirst As Range\n\nx = \"[\"\ny = \"]\"\n\nOn Error Resume Next\nSet Found = Cells.Find(what:=x, LookIn:=xlValues, LookAt:=xlPart)\nIf Not Found Is Nothing Then\n    Set FoundFirst = Found\n    Do\n      'Format \"x\"\n        With Found.Characters(Start:=InStr(Found.Text, x), Length:=Len(y))\n            .Font.ColorIndex = 3\n            .Font.Bold = False\n        End With\n        Set Found = Cells.FindNext(Found)\n    Loop Until FoundFirst.Address = Found.Address\nElse\n    MsgBox x &amp; \" could not be found.\", , \" \"\nEnd If \nEnd Sub\n</code></pre>\n"}, {"tags": ["r", "vba", "optimization", "time-series", "solver"], "comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1488395998, "post_id": 42539691, "comment_id": 72216113, "body": "it is difficult to understand what you want exactly. Do you want something like this? or something similar but with TTM column to be groupized into ranges and not exact percentages? <a href=\"https://www.screencast.com/t/x5slCDwybKj8\" rel=\"nofollow noreferrer\">See the Image</a>"}, {"owner": {"reputation": 13, "user_id": 6893616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/272787d68e2578f64d3f613001c8d6c0?s=128&d=identicon&r=PG&f=1", "display_name": "dailyalexa", "link": "https://stackoverflow.com/users/6893616/dailyalexa"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1488442158, "post_id": 42539691, "comment_id": 72234970, "body": "Sorry that I was not precise enough, I edited post and added some graphs to show what I want to do"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1488474834, "post_id": 42539691, "comment_id": 72257592, "body": "What I understood is that you want to have a parameter like a range and then calculate the average so that you can illustrate on the charts. I am not sure there is a method in statistics for this, but if you keep it simple you can write this easily with VBA. So assume range=3 meaning that you will take the average of every 3 record. The result would be like the image attached. Is this what you want? <a href=\"http://www.filedropper.com/capture_49\" rel=\"nofollow noreferrer\">filedropper.com/capture_49</a>"}, {"owner": {"reputation": 13, "user_id": 6893616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/272787d68e2578f64d3f613001c8d6c0?s=128&d=identicon&r=PG&f=1", "display_name": "dailyalexa", "link": "https://stackoverflow.com/users/6893616/dailyalexa"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1488479697, "post_id": 42539691, "comment_id": 72260520, "body": "Thank you for your kind help but it is not exactly what I expect. I think that the case is more complex than you&#39;ve presented. Please look on first image I attached - I see empirical realization (green line) and want to use this values in credit risk modelling, but I want to make these realizations simpler (or smoother), convert my empirical PPR vector to PPR vector with averages and make it more general and easier to applicable in model."}, {"owner": {"reputation": 13, "user_id": 6893616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/272787d68e2578f64d3f613001c8d6c0?s=128&d=identicon&r=PG&f=1", "display_name": "dailyalexa", "link": "https://stackoverflow.com/users/6893616/dailyalexa"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1488479703, "post_id": 42539691, "comment_id": 72260527, "body": "So, in the first picture I can see that, ok - from TTM = 61 to TTM = 14 my PPRs have similar values so I can approximate them with these average from TTM 61 - 14. But, from TTM &gt;= 13 I see that my PPR are higher (in other words - represent different pattern to previous values). So TTM = 14 is my threshold but I determined it manually and want to determine it statistically (or quasi-statistically). To sum up - if want to find thresholds when my empirical realization change pattern."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1488484032, "post_id": 42539691, "comment_id": 72263133, "body": "So it is important to keep the order of TTM? and can you tell me what do TTM and PPR stand for?"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1488484069, "post_id": 42539691, "comment_id": 72263159, "body": "Can you send me all of your data from 1 to 60 so that I can have a better sample data?"}, {"owner": {"reputation": 13, "user_id": 6893616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/272787d68e2578f64d3f613001c8d6c0?s=128&d=identicon&r=PG&f=1", "display_name": "dailyalexa", "link": "https://stackoverflow.com/users/6893616/dailyalexa"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1488530682, "post_id": 42539691, "comment_id": 72281543, "body": "Yes, it is important to keep the order of TTM, TTM stands for Time to exposure&#39;s Maturity (in months) and PPR stands for partial prepayments (% of principal amount of loans that clients prepaid). I uploaded file with example data to my post above."}, {"owner": {"reputation": 13, "user_id": 6893616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/272787d68e2578f64d3f613001c8d6c0?s=128&d=identicon&r=PG&f=1", "display_name": "dailyalexa", "link": "https://stackoverflow.com/users/6893616/dailyalexa"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1488530891, "post_id": 42539691, "comment_id": 72281660, "body": "<a href=\"https://www.dropbox.com/s/04mfjrnygxctlgj/Data%20example%20Stack.xlsx?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/04mfjrnygxctlgj/Data%20example%20Stack.xlsx?dl&zwnj;&#8203;=0</a>"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1488566948, "post_id": 42539691, "comment_id": 72304812, "body": "This is a tough problem since it seems there is not a very standard statistic method to do such an analysis. I talked to a friend who is doing credit risk analysis and he mentioned the best way is to calculate the Mean and STDev and try to play with it so that you can fit it. This is not a VBA question right now and it is more how to define that criterion to find out when it should reset the calculation and treat the rest of data as a new set. I think the best move right now is to define a function that gets a TTM and breaks the calculations at that point"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1488567004, "post_id": 42539691, "comment_id": 72304830, "body": "I will try to work on it, it is too much work though. You need to contact statisticians to see what criterion or function is defined in statistics that can determine that point of break for you, after that, it can be easily integrated into the code"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6893616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/272787d68e2578f64d3f613001c8d6c0?s=128&d=identicon&r=PG&f=1", "display_name": "dailyalexa", "link": "https://stackoverflow.com/users/6893616/dailyalexa"}, "edited": false, "score": 0, "creation_date": 1488786020, "post_id": 42587744, "comment_id": 72368459, "body": "Thanks so much ! Seems to be exactly what I want :)"}], "tags": [], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "is_accepted": true, "score": 0, "last_activity_date": 1488572337, "creation_date": 1488572337, "answer_id": 42587744, "question_id": 42539691, "link": "https://stackoverflow.com/questions/42539691/determination-of-threshold-values-to-group-variable-in-ranges/42587744#42587744", "title": "Determination of threshold values to group variable in ranges", "body": "<p>I think this is what you want. The next step would be including a method that can recognize the break points. I am sure you need to define two new parameters, one as the sensitivity and one as the minimum number of points in a sample to be accepted to be categorized as a section (between two break points including start and end point)</p>\n\n<p>Please hit the checkmark next to this answer if you are happy with it.</p>\n\n<p>You can download the Excel file from here:</p>\n\n<p><a href=\"http://www.filedropper.com/statisticspatternchange\" rel=\"nofollow noreferrer\">http://www.filedropper.com/statisticspatternchange</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/60Tja.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/60Tja.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 13, "user_id": 6893616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/272787d68e2578f64d3f613001c8d6c0?s=128&d=identicon&r=PG&f=1", "display_name": "dailyalexa", "link": "https://stackoverflow.com/users/6893616/dailyalexa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "accepted_answer_id": 42587744, "answer_count": 1, "score": 1, "last_activity_date": 1489440140, "creation_date": 1488394287, "last_edit_date": 1489440140, "question_id": 42539691, "link": "https://stackoverflow.com/questions/42539691/determination-of-threshold-values-to-group-variable-in-ranges", "title": "Determination of threshold values to group variable in ranges", "body": "<p>I have, let's say, 60 empirical realizations of PPR. My goal is to create PPR vector with average values of empirical PPR. This average values depend on what upper and lower limit of TTM i take - so I can take TTM from 60 to 1 and calculate average and in PPR vector put this one average number from row 1 to 60 or I can calculate average value of PPR from TTT >= 60 and TTM &lt;= 30 and TTM > 30 and TTM &lt;= 1 and these two calculated numbers put in my vector accordingly to TTM values. Finaly I want to obtain something like this on chart (x-axis is TTM, green line is my empirical PPR and black line is average based on significant changes during TTM). I want to write an algorithm which will help me find the best TTM thresholds to fit the best black line to green line.</p>\n\n<p><img src=\"https://i.stack.imgur.com/OrBzg.png\" alt=\"enter image description here\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/SP04U.png\" alt=\"enter image description here\"></p>\n\n<pre><code>TTM PPR\n60 0,20%\n59 0,16%\n58 0,33%\n57 0,58%\n56 0,41%\n...\n10 1,15%\n9 0,96%\n8 0,88%\n7 0,32%\n6 0,16%\n</code></pre>\n\n<p>Can you please help me if you know any statistical method which might be applicable in this case or base idea for an algorithm which I could implement in VBA/R ?</p>\n\n<p>I have used Solver and GRG Nonlinear** to deal with it but I believe that there is something more proper to be utilized.</p>\n\n<p>** with Solver I had the problem that it found optimal solution - ok, but I re-run Solver and it found me new solution (with a little bit different values of TTM) and value of target function was lower that on first time (so, was the first solution really optimal ?)</p>\n"}, {"tags": ["vba", "excel", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 4493496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-GkQQzvIXyWA/AAAAAAAAAAI/AAAAAAAAACU/hazo3g_MLfU/photo.jpg?sz=128", "display_name": "wh3resmycar2", "link": "https://stackoverflow.com/users/4493496/wh3resmycar2"}, "edited": false, "score": 0, "creation_date": 1488399674, "post_id": 42540618, "comment_id": 72218310, "body": "it looks neat and it works. thanks man. what if i need another filter? let&#39;s say a string in the Subject line of an email for example it will look for &quot;Record 1&quot;? do i create another myTasks restriction or can i add .Restrict(&quot;Subject&quot; Contains &quot;Record 1&quot;) to the current myTasks?"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "reply_to_user": {"reputation": 181, "user_id": 4493496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-GkQQzvIXyWA/AAAAAAAAAAI/AAAAAAAAACU/hazo3g_MLfU/photo.jpg?sz=128", "display_name": "wh3resmycar2", "link": "https://stackoverflow.com/users/4493496/wh3resmycar2"}, "edited": false, "score": 0, "creation_date": 1488400843, "post_id": 42540618, "comment_id": 72218948, "body": "The link states &quot;Logical operators that are allowed are AND, OR, and NOT&quot;. You can as well restrict twice.  I do not know of a way to get &quot;Contains&quot; in a Restrict."}, {"owner": {"reputation": 181, "user_id": 4493496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-GkQQzvIXyWA/AAAAAAAAAAI/AAAAAAAAACU/hazo3g_MLfU/photo.jpg?sz=128", "display_name": "wh3resmycar2", "link": "https://stackoverflow.com/users/4493496/wh3resmycar2"}, "edited": false, "score": 0, "creation_date": 1488480363, "post_id": 42540618, "comment_id": 72260918, "body": "twice restrict means 2 loops? can you give an example please?"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "reply_to_user": {"reputation": 181, "user_id": 4493496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-GkQQzvIXyWA/AAAAAAAAAAI/AAAAAAAAACU/hazo3g_MLfU/photo.jpg?sz=128", "display_name": "wh3resmycar2", "link": "https://stackoverflow.com/users/4493496/wh3resmycar2"}, "edited": false, "score": 0, "creation_date": 1488483313, "post_id": 42540618, "comment_id": 72262676, "body": "For the second filter Set myTasks =myTasks.Restrict"}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": true, "score": 1, "last_activity_date": 1488397462, "creation_date": 1488397462, "answer_id": 42540618, "question_id": 42539438, "link": "https://stackoverflow.com/questions/42539438/excel-vba-outlook-search-multiple-criteria-id-and-date/42540618#42540618", "title": "Excel VBA Outlook search Multiple Criteria (ID and Date)", "body": "<p>You can Restrict the number of items in the loop. <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869597.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff869597.aspx</a></p>\n\n<pre><code>Sub test()\n\nDim outlookapp As Object\nDim olNs As Outlook.Namespace\n\nDim myFldr As Outlook.Folder\nDim objMail As Object\nDim myTasks As Outlook.Items\n\nDim daysAgo As Long\n\nDim projIDsearch As String\nDim myRecipient As Outlook.Recipient\n\nSet outlookapp = CreateObject(\"Outlook.Application\")\nSet olNs = outlookapp.GetNamespace(\"MAPI\")\nSet myRecipient = olNs.CreateRecipient(\"SharedMailboxName\")\n\nmyRecipient.Resolve\n\nSet myFldr = olNs.GetSharedDefaultFolder(myRecipient, olFolderInbox)\n\nprojIDsearch = ActiveCell.Cells(1, 4)\n\n' Restrict search to daysAgo\ndaysAgo = 3\n\nSet myTasks = myFldr.Items.Restrict(\"[ReceivedTime]&gt;'\" &amp; Format(Date - daysAgo, \"DDDDD HH:NN\") &amp; \"'\")\n\nFor Each objMail In myTasks\n\n    If (InStr(1, objMail.Subject, projIDsearch, vbTextCompare) &gt; 0) Then\n        objMail.Display\n    End If\n\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 4493496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-GkQQzvIXyWA/AAAAAAAAAAI/AAAAAAAAACU/hazo3g_MLfU/photo.jpg?sz=128", "display_name": "wh3resmycar2", "link": "https://stackoverflow.com/users/4493496/wh3resmycar2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 889, "favorite_count": 0, "accepted_answer_id": 42540618, "answer_count": 1, "score": 0, "last_activity_date": 1488397462, "creation_date": 1488393479, "last_edit_date": 1495540920, "question_id": 42539438, "link": "https://stackoverflow.com/questions/42539438/excel-vba-outlook-search-multiple-criteria-id-and-date", "title": "Excel VBA Outlook search Multiple Criteria (ID and Date)", "body": "<p>Ok this is my 2nd thread for this VBA search conundrum that i am having. Thanks to the guy who helped me on my first issue. This code was derived from <a href=\"https://stackoverflow.com/questions/20082550/excel-vba-for-searching-in-mails-of-outlook\">enter link description here</a></p>\n\n<p>Ok so i made adjustment to make it search a SharedMailbox which does work but the issue is that the mailbox is receiving hundreds of emails a day which makes searching time a bit longer for my liking (we have emails from early last year even). I would like to impose a 2nd search criteria, this time a date limit, like only search emails that are 2 to 3 days old. here is what i got:</p>\n\n<pre><code>Dim outlookapp\nDim olNs As Outlook.Namespace\nDim Fldr As Outlook.MAPIFolder\nDim olMail As Variant\nDim myTasks\nDim projIDsearch As String\nDim myRecipient As Outlook.Recipient\nDim days2ago As Date\n\n\n\nSet outlookapp = CreateObject(\"Outlook.Application\")\nSet olNs = outlookapp.GetNamespace(\"MAPI\")\nSet myRecipient = olNs.CreateRecipient(\"SharedMailboxName\")\nmyRecipient.Resolve\n\n'Set Fldr = olNs.GetDefaultFolder(olFolderInbox).Folders(\"x\")\nSet Fldr = olNs.GetSharedDefaultFolder(myRecipient, olFolderInbox)\n\n\n\n\nSet myTasks = Fldr.Items\nprojIDsearch = ActiveCell.Cells(1, 4)\n\n\ndays2ago = DateTime.Now - 3\n\n\n\nFor Each olMail In myTasks\n\n'If olMail.ReceivedTime &gt; days2ago Then\n\n\nIf (InStr(1, olMail.Subject, projIDsearch, vbTextCompare) &gt; 0) Then\nolMail.Display\n'Exit For\nEnd If\n\n\nNext\n</code></pre>\n\n<p>I've looked around and found .ReceivedTime property. Which sounds like the thing that i need but i'm having a struggle on how to incorporate it into the code. Actually i'm not even how a Variant(olMail) is able to accept the .display method and .subject property.</p>\n\n<p>These are the codes that i've added but they don't seem to work:</p>\n\n<pre><code>days2ago = DateTime.Now - 3\n</code></pre>\n\n<p>and</p>\n\n<pre><code>If olMail.ReceivedTime &gt; days2ago Then\n</code></pre>\n\n<p>Thanks in advanced.</p>\n"}, {"tags": ["excel", "while-loop", "vba"], "comments": [{"owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "edited": false, "score": 0, "creation_date": 1488393894, "post_id": 42539408, "comment_id": 72214820, "body": "We need more information. With the inputs as stated in your question what then is placed into <code>Cells(1, 4)</code> in each loop iteration?"}, {"owner": {"reputation": 1, "user_id": 2864626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8975ef799534850ab18e1055fdc1f908?s=128&d=identicon&r=PG&f=1", "display_name": "Triryche", "link": "https://stackoverflow.com/users/2864626/triryche"}, "reply_to_user": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "edited": false, "score": 0, "creation_date": 1488397426, "post_id": 42539408, "comment_id": 72216979, "body": "1, 1.05, 1.10.....then ends at 3.05"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 2, "creation_date": 1488397870, "post_id": 42539408, "comment_id": 72217230, "body": "floating point precision limitations can cause this type of error.  <a href=\"http://stackoverflow.com/a/7330887/445425\">See here</a>"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1488400046, "post_id": 42539408, "comment_id": 72218519, "body": "consider hitting your WHILE conditions with ROUND()."}, {"owner": {"reputation": 1, "user_id": 2864626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8975ef799534850ab18e1055fdc1f908?s=128&d=identicon&r=PG&f=1", "display_name": "Triryche", "link": "https://stackoverflow.com/users/2864626/triryche"}, "edited": false, "score": 0, "creation_date": 1488400953, "post_id": 42539408, "comment_id": 72219008, "body": "Thanks, that seems to fix the issue, although it seems a bit crazy that such small numbers trips up Excel."}], "owner": {"reputation": 1, "user_id": 2864626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8975ef799534850ab18e1055fdc1f908?s=128&d=identicon&r=PG&f=1", "display_name": "Triryche", "link": "https://stackoverflow.com/users/2864626/triryche"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1488397370, "creation_date": 1488393368, "last_edit_date": 1531164843, "question_id": 42539408, "link": "https://stackoverflow.com/questions/42539408/vba-inconsistent-condition-evaluation", "title": "VBA - Inconsistent Condition Evaluation", "body": "<p>Inconsistent Condition Evaluation\nSometimes the <code>While</code>loop executes one extra time when the condition should evaluate <code>False</code>.\nExample, if I enter 1 as a start, 3 as end and 0.05 as step.</p>\n\n<pre><code>    Private Sub CommandButton21_Click()\nDim StrPrompt As String\nDim StepValue As Double\nDim StartValue As Double\nDim EndValue As Double\nDim CurrentValue As Double\n\nStrPrompt = \"Enter a Positive start number.\"\nredo:\nStartValue = Application.InputBox(StrPrompt, \"Start\", , , , , , Type:=1)\nIf Not (StartValue &gt;= 0) Then\n    StrPrompt = \"Please enter a postive number.\"\n    GoTo redo\nEnd If\n\nMsgBox \"User entered \" &amp; StartValue, , \"Start Value\"\nCells(1, 4) = StartValue &amp; \" Start\"\n\n\nStrPrompt = \"Enter a Positive end number.\"\nredo1:\nEndValue = Application.InputBox(StrPrompt, \"End\", , , , , , Type:=1)\nIf EndValue &lt;= StartValue Then\n    StrPrompt = \"Please enter a number larger than start number.\"\n    GoTo redo1\nEnd If\n\nMsgBox \"User entered \" &amp; EndValue, , \"End Value\"\nCells(1, 4) = EndValue &amp; \" End\"\n\nStrPrompt = \"Enter a Positive step value.\"\nredo2:\nStepValue = Application.InputBox(StrPrompt, \"Step\", , , , , , Type:=1)\nIf Not (StepValue &gt; 0) Then\n    StrPrompt = \"Please enter a number &gt; 0.\"\n    GoTo redo2\nEnd If\n\n\nMsgBox \"User entered \" &amp; StepValue, , \"Step Value\"\nCells(1, 4) = StartValue &amp; \" Step\"\n\nCurrentValue = StartValue\nCells(1, 4) = CurrentValue\n\n   While CurrentValue &lt; EndValue\n\n   ' MsgBox \"Current Value before increment \" &amp; CurrentValue, , \"Before\"\n    CurrentValue = CurrentValue + StepValue\n    'MsgBox \"Current Value after increment \" &amp; CurrentValue, , \"After\"\n    Cells(1, 4) = CurrentValue\n   Wend\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1488395005, "post_id": 42539393, "comment_id": 72215479, "body": "Looks like you need to look into how <code>Dir</code> works. See <a href=\"http://stackoverflow.com/documentation/vba/topics\">VBA topics</a> on Documentation.SO. Also your loop body should use <code>strFile</code> for the old name, and you need logic that removes/replaces the extension in the new name."}], "answers": [{"comments": [{"owner": {"reputation": 431, "user_id": 5969893, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/c6c5d6a1321f7055e2fff7a3f6736d9b?s=128&d=identicon&r=PG&f=1", "display_name": "AlmostThere", "link": "https://stackoverflow.com/users/5969893/almostthere"}, "edited": false, "score": 0, "creation_date": 1488397579, "post_id": 42539977, "comment_id": 72217066, "body": "Thanks for the quick reply!  I tried using this but unfortunately, when it runs, I&#39;m not sure it is doing anything. It runs and I receive no errors, but the files do not change from WRI to TXT."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 431, "user_id": 5969893, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/c6c5d6a1321f7055e2fff7a3f6736d9b?s=128&d=identicon&r=PG&f=1", "display_name": "AlmostThere", "link": "https://stackoverflow.com/users/5969893/almostthere"}, "edited": false, "score": 0, "creation_date": 1488399352, "post_id": 42539977, "comment_id": 72218125, "body": "@Comintern run with F8 to see the variables especially see if strFile is loaded with the names in the folder or not. I tested on my computer with different extensions and it works for sure. Double check your folder address and also whether you have any file which is wri. Check strFile when the line is executing (yellow), hover on it to show its value. It should pick the name of wri files"}], "tags": [], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "is_accepted": false, "score": 2, "last_activity_date": 1488395205, "creation_date": 1488395205, "answer_id": 42539977, "question_id": 42539393, "link": "https://stackoverflow.com/questions/42539393/loop-through-folder-changing-file-extensions-vba/42539977#42539977", "title": "Loop through folder changing file extensions VBA", "body": "<pre><code>Sub ConvertToTXT()\n\n    Const strPath As String = \"C:\\Users\\John\\Desktop\\Folder1\"\n    Dim strFile As String\n\n    Application.DisplayAlerts = False\n    Application.ScreenUpdating = False\n\n    strFile = Dir(strPath &amp; \"\\\" &amp; \"*.wri\")\n\n    Do While strFile &lt;&gt; \"\"\n        Name strPath &amp; \"\\\" &amp; strFile As strPath &amp; \"\\\" &amp; Replace(strFile, \".wri\", \".txt\")\n        strFile = Dir\n    Loop\n\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 2, "last_activity_date": 1488395744, "creation_date": 1488395744, "answer_id": 42540128, "question_id": 42539393, "link": "https://stackoverflow.com/questions/42539393/loop-through-folder-changing-file-extensions-vba/42540128#42540128", "title": "Loop through folder changing file extensions VBA", "body": "<p>I'd personally use the <code>Scripting.FileSystemObject</code> for this - it's much less prone to errors than manually building filepath strings.  You'll need to add a reference to Microsoft Scripting Runtime:</p>\n\n<pre><code>Private Sub ConvertToTXT(filePath As String)\n    With New Scripting.FileSystemObject\n        Dim directory As Folder\n        Set directory = .GetFolder(filePath)\n        Dim target As File\n        For Each target In directory.Files\n            If LCase$(.GetExtensionName(target.Name)) = \"wri\" Then\n                Dim newName As String\n                newName = .BuildPath(filePath, .GetBaseName(target.Name)) &amp; \".txt\"\n                .MoveFile target.Path, newName\n            End If\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<p>Call it by passing it the directory you want to perform the renaming in:</p>\n\n<pre><code>ConvertToTXT \"C:\\Users\\John\\Desktop\\Folder1\"\n</code></pre>\n\n<p>Note that is doesn't care if there's a trailing <code>\\</code> or not - this also works:</p>\n\n<pre><code>ConvertToTXT \"C:\\Users\\John\\Desktop\\Folder1\\\"\n</code></pre>\n"}], "owner": {"reputation": 431, "user_id": 5969893, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/c6c5d6a1321f7055e2fff7a3f6736d9b?s=128&d=identicon&r=PG&f=1", "display_name": "AlmostThere", "link": "https://stackoverflow.com/users/5969893/almostthere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3151, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1561009871, "creation_date": 1488393317, "question_id": 42539393, "link": "https://stackoverflow.com/questions/42539393/loop-through-folder-changing-file-extensions-vba", "title": "Loop through folder changing file extensions VBA", "body": "<p>On a monthly basis I have to aggregate daily files.  The issue is I need the files to be in \"TXT\", but they are sent to me as \"WRI\".</p>\n\n<p>I am able to do one file at a time if it is hardcoded with the following.</p>\n\n<pre><code>Name \"C:\\Users\\John\\Desktop\\Folder1\\SQLEXEC.WRI\" As \"C:\\Users\\John\\Desktop\\Folder1\\SQLEXEC.TXT\"\n</code></pre>\n\n<p>However, I want to be able to loop through the folder. But I am not sure how to change the code to allow it to loop.</p>\n\n<pre><code>Sub ConvertToTXT()\n\nApplication.DisplayAlerts = False \nApplication.ScreenUpdating = False\n\nDim strPath As String \nDim strFile As String\n\nstrPath = \"C:\\Users\\John\\Desktop\\Folder1\\\" strFile = Dir(strPath &amp; \"*.wri\")\n\nDo While strFile &lt;&gt; \"\"\n\nName \"C:\\Users\\John\\Desktop\\Folder1\\SQLEXEC.WRI\" As \"C:\\Users\\John\\Desktop\\Folder1\\SQLEXEC.TXT\"\n\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 3, "creation_date": 1488392822, "post_id": 42539141, "comment_id": 72214218, "body": "Why not just use the VBA <code>Right</code>, <code>Mid</code>, <code>Trim</code>, and <code>Left</code> functions to do this before you import the values to the cells to begin with?"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1488394754, "post_id": 42539141, "comment_id": 72215335, "body": "seems like you can just remove anything before the last space <code>Range(&quot;D:D&quot;).Replace &quot;* &quot;, &quot;&quot;</code>"}, {"owner": {"reputation": 77, "user_id": 7618866, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-fG3CeLLShW0/AAAAAAAAAAI/AAAAAAAACaU/zFOt28wVaQA/photo.jpg?sz=128", "display_name": "JasonDL", "link": "https://stackoverflow.com/users/7618866/jasondl"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1488398074, "post_id": 42539141, "comment_id": 72217356, "body": "@Comintern I had looked at doing that but unfortunately there is a bunch of user errors that we need to reconcile so importing first allows us to catch them otherwise we have to go email by email. If you know a better way I am certainly open to it!"}, {"owner": {"reputation": 77, "user_id": 7618866, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-fG3CeLLShW0/AAAAAAAAAAI/AAAAAAAACaU/zFOt28wVaQA/photo.jpg?sz=128", "display_name": "JasonDL", "link": "https://stackoverflow.com/users/7618866/jasondl"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1488398181, "post_id": 42539141, "comment_id": 72217424, "body": "@Slai I am not familiar with the .replace so I had not thought of it. Thanks!"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1488399964, "post_id": 42539141, "comment_id": 72218480, "body": "@JasonLeach it is just the Find and Replace (Ctrl+H). Did it work for what you needed or you used something else?"}, {"owner": {"reputation": 77, "user_id": 7618866, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-fG3CeLLShW0/AAAAAAAAAAI/AAAAAAAACaU/zFOt28wVaQA/photo.jpg?sz=128", "display_name": "JasonDL", "link": "https://stackoverflow.com/users/7618866/jasondl"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1488555327, "post_id": 42539141, "comment_id": 72298150, "body": "@Slai I used something else (From below) but I will play with this as I am learning VBA still and want to learn as much as I can. Thanks!"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1488555792, "post_id": 42539141, "comment_id": 72298444, "body": "@JasonLeach you can&#39;t accept more than one answer, but you can up vote them later when you get 15 reputation <a href=\"http://stackoverflow.com/help/privileges\">stackoverflow.com/help/privileges</a>"}, {"owner": {"reputation": 77, "user_id": 7618866, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-fG3CeLLShW0/AAAAAAAAAAI/AAAAAAAACaU/zFOt28wVaQA/photo.jpg?sz=128", "display_name": "JasonDL", "link": "https://stackoverflow.com/users/7618866/jasondl"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1489083082, "post_id": 42539141, "comment_id": 72527049, "body": "@Slai thank you for the insight, still learning how it works."}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 7618866, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-fG3CeLLShW0/AAAAAAAAAAI/AAAAAAAACaU/zFOt28wVaQA/photo.jpg?sz=128", "display_name": "JasonDL", "link": "https://stackoverflow.com/users/7618866/jasondl"}, "edited": false, "score": 0, "creation_date": 1488399260, "post_id": 42539446, "comment_id": 72218068, "body": "I will try this out, I got the code above working but as I am learning VBA I would like to see how other methods work as well! Thanks for posting!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 77, "user_id": 7618866, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-fG3CeLLShW0/AAAAAAAAAAI/AAAAAAAACaU/zFOt28wVaQA/photo.jpg?sz=128", "display_name": "JasonDL", "link": "https://stackoverflow.com/users/7618866/jasondl"}, "edited": false, "score": 0, "creation_date": 1488399342, "post_id": 42539446, "comment_id": 72218122, "body": "@JasonLeach test this out, I bet its quicker than one that loops."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1488393508, "creation_date": 1488393508, "answer_id": 42539446, "question_id": 42539141, "link": "https://stackoverflow.com/questions/42539141/applying-vba-right-to-an-entire-column-infinite-loop-issue/42539446#42539446", "title": "Applying VBA RIGHT to an entire column - Infinite Loop Issue", "body": "<p>Try this, it uses Evaluate and no loops or added columns.</p>\n\n<pre><code>Sub ShortenPositionNumbers()    \n    Application.ScreenUpdating = False\n\n    Dim selCol As Range\n    Dim LastRow As Long    \n\n    With ActiveSheet\n        LastRow = .Cells(Rows.Count, \"A\").End(xlUp).Row\n        Set selCol = .Range(.Cells(1, 3), .Cells(LastRow, 3))\n        selCol.Value = .Evaluate(\"INDEX(IF(LEN(\" &amp; selCol.Address(0, 0) &amp; \")&gt;8,RIGHT(\" &amp; selCol.Address(0, 0) &amp; \",6),RIGHT(\" &amp; selCol.Address(0, 0) &amp; \",4)),)\")\n    End With\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1488394714, "post_id": 42539653, "comment_id": 72215320, "body": "There&#39;s no need to use <code>rLen</code>, simply use <code>If Len(rVal) &gt; 8 Then</code>, or even <code>If Len(oRng.Value) &gt; 8 Then</code> and eliminate setting another value that&#39;s only going to be used once. All-in-all, though, this is the approach I&#39;d take."}, {"owner": {"reputation": 1018, "user_id": 6706734, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89cf86a3fd50974771d8041b8f13e5b0?s=128&d=identicon&r=PG&f=1", "display_name": "J_Lard", "link": "https://stackoverflow.com/users/6706734/j-lard"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1488395501, "post_id": 42539653, "comment_id": 72215813, "body": "@FreeMan I agree that it&#39;s unnecessary but I was just trying to make the code as transparent as possible. Anyway, I&#39;ve updated the code to remove the <code>rLen</code> variable."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1488399038, "post_id": 42539653, "comment_id": 72217928, "body": "Very valid point. My comment was directed to OP so he knew he could shorten it up some if desired. Especially if speed is a concern in the long run."}, {"owner": {"reputation": 77, "user_id": 7618866, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-fG3CeLLShW0/AAAAAAAAAAI/AAAAAAAACaU/zFOt28wVaQA/photo.jpg?sz=128", "display_name": "JasonDL", "link": "https://stackoverflow.com/users/7618866/jasondl"}, "edited": false, "score": 0, "creation_date": 1488399191, "post_id": 42539653, "comment_id": 72218027, "body": "@J_Lard thanks so much this is much faster and more efficient. I was struggling to do exactly this. Question: how come I set rVal = oRng.Value and then have to use oRng.Value = Right (rVal, 6) instead of rVal =Right (rVal, 6)?  Just wondering why that wont work? (Newer to VBA so I apologize if a dumb question)"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 77, "user_id": 7618866, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-fG3CeLLShW0/AAAAAAAAAAI/AAAAAAAACaU/zFOt28wVaQA/photo.jpg?sz=128", "display_name": "JasonDL", "link": "https://stackoverflow.com/users/7618866/jasondl"}, "edited": false, "score": 0, "creation_date": 1488399688, "post_id": 42539653, "comment_id": 72218321, "body": "@JasonLeach as I mentioned in my first comment, there&#39;s no reason to <i>not</i> use <code>oRng.Value = Right(oRng.Value, 6)</code> (or 4). J_Lard was showing the explicit way by declaring variables to hold the intermediate values. Eliminating those intermediate assignments will speed your code up ever so slightly more."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 77, "user_id": 7618866, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-fG3CeLLShW0/AAAAAAAAAAI/AAAAAAAACaU/zFOt28wVaQA/photo.jpg?sz=128", "display_name": "JasonDL", "link": "https://stackoverflow.com/users/7618866/jasondl"}, "edited": false, "score": 0, "creation_date": 1488399775, "post_id": 42539653, "comment_id": 72218368, "body": "also, @JasonLeach, <i>once you get your code working</i>, pop over to <a href=\"https://codereview.stackexchange.com\">Code Review</a> and post it there for even more help in getting it to run faster. Might not matter with 200 or 2,000 rows, but hit 200,000 and you&#39;ll be screaming for mercy! :)"}, {"owner": {"reputation": 1018, "user_id": 6706734, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89cf86a3fd50974771d8041b8f13e5b0?s=128&d=identicon&r=PG&f=1", "display_name": "J_Lard", "link": "https://stackoverflow.com/users/6706734/j-lard"}, "reply_to_user": {"reputation": 77, "user_id": 7618866, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-fG3CeLLShW0/AAAAAAAAAAI/AAAAAAAACaU/zFOt28wVaQA/photo.jpg?sz=128", "display_name": "JasonDL", "link": "https://stackoverflow.com/users/7618866/jasondl"}, "edited": false, "score": 0, "creation_date": 1488400000, "post_id": 42539653, "comment_id": 72218493, "body": "@JasonLeach You really don&#39;t &quot;need&quot; the <code>rVal</code> variable, but I would consider it good practice. The reason is <code>rVal</code> can only be accessed in the VBA code and <code>oRng.Value</code> is a direct reference to the cell in your spreadsheet."}, {"owner": {"reputation": 1018, "user_id": 6706734, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89cf86a3fd50974771d8041b8f13e5b0?s=128&d=identicon&r=PG&f=1", "display_name": "J_Lard", "link": "https://stackoverflow.com/users/6706734/j-lard"}, "reply_to_user": {"reputation": 77, "user_id": 7618866, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-fG3CeLLShW0/AAAAAAAAAAI/AAAAAAAACaU/zFOt28wVaQA/photo.jpg?sz=128", "display_name": "JasonDL", "link": "https://stackoverflow.com/users/7618866/jasondl"}, "edited": false, "score": 0, "creation_date": 1488400178, "post_id": 42539653, "comment_id": 72218591, "body": "@JasonLeach I would also expect Scott&#39;s answer to be faster, but I posted this answer as a suggestion to make the code you wrote to run more efficiently. Anyway, it&#39;s always good to know multiple ways to handle a problem."}], "tags": [], "owner": {"reputation": 1018, "user_id": 6706734, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89cf86a3fd50974771d8041b8f13e5b0?s=128&d=identicon&r=PG&f=1", "display_name": "J_Lard", "link": "https://stackoverflow.com/users/6706734/j-lard"}, "is_accepted": true, "score": 1, "last_activity_date": 1488395284, "last_edit_date": 1488395284, "creation_date": 1488394202, "answer_id": 42539653, "question_id": 42539141, "link": "https://stackoverflow.com/questions/42539141/applying-vba-right-to-an-entire-column-infinite-loop-issue/42539653#42539653", "title": "Applying VBA RIGHT to an entire column - Infinite Loop Issue", "body": "<p>There are a few things you can do here to speed up your code. I'm only going to reference the second code block as you can apply similar logic to the first.</p>\n\n<p>The first issue is that you create a <code>LastRow</code> variable but never reference it again. It looks like you meant to use this in the <code>selCol</code> range. You should change that line to <code>Set selCol = Range(\"C1:C\" &amp; lastRow)</code>. This way, when you loop through the rows you only loop through the used rows.</p>\n\n<p>Next, in the <code>For-Each loop</code> you <code>Select</code> every cell you loop through. There really isn't any reason to do this and takes substantially longer. You then create the variable <code>rVal</code> but never use it again. A better way to set up the loop is as follows.</p>\n\n<pre><code>For Each oRng in selCol\n    rVal = oRng.Value\n    If Len(rVal) &gt; 8 Then\n        oRng.Value = Right(rVal, 6)\n    Else\n        oRng.Value = Right(rVal, 4)\n    End If\nNext\n</code></pre>\n\n<p>This is much cleaner and no longer requires creating columns or copying and pasting.</p>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1488525000, "post_id": 42544263, "comment_id": 72278671, "body": "@JasonLeach, did you get through it?"}, {"owner": {"reputation": 77, "user_id": 7618866, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-fG3CeLLShW0/AAAAAAAAAAI/AAAAAAAACaU/zFOt28wVaQA/photo.jpg?sz=128", "display_name": "JasonDL", "link": "https://stackoverflow.com/users/7618866/jasondl"}, "edited": false, "score": 0, "creation_date": 1488555422, "post_id": 42544263, "comment_id": 72298213, "body": "I used code from the comment above but I will try this as well. I am still trying to understand arrays (it is hard for me to see in my mind how they work). Thanks!"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 77, "user_id": 7618866, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-fG3CeLLShW0/AAAAAAAAAAI/AAAAAAAACaU/zFOt28wVaQA/photo.jpg?sz=128", "display_name": "JasonDL", "link": "https://stackoverflow.com/users/7618866/jasondl"}, "edited": false, "score": 0, "creation_date": 1488556910, "post_id": 42544263, "comment_id": 72299190, "body": "being code speed an issue for you, you could test this and @ScottCraner &#39;s one and find out the fastest"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 77, "user_id": 7618866, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-fG3CeLLShW0/AAAAAAAAAAI/AAAAAAAACaU/zFOt28wVaQA/photo.jpg?sz=128", "display_name": "JasonDL", "link": "https://stackoverflow.com/users/7618866/jasondl"}, "edited": false, "score": 0, "creation_date": 1488557038, "post_id": 42544263, "comment_id": 72299267, "body": "as for arrays, from the content point of view they&#39;re sort of a sheet cells portion, with rows and columns, but much much faster."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1488411729, "creation_date": 1488411729, "answer_id": 42544263, "question_id": 42539141, "link": "https://stackoverflow.com/questions/42539141/applying-vba-right-to-an-entire-column-infinite-loop-issue/42544263#42544263", "title": "Applying VBA RIGHT to an entire column - Infinite Loop Issue", "body": "<p>Or work with arrays</p>\n\n<pre><code>Sub ShortenPositionNumbers()    \n    Dim data As Variant\n    Dim i As Long\n\n    With Range(\"C3:C\" &amp; Cells(Rows.Count, \"A\").End(xlUp).Row)\n        data = Application.Transpose(.Value)\n        For i = LBound(data) to UBound(data)\n            If Len(data(i)) &gt; 8 Then\n                data(i) = RIGHT(data(i),6)\n            Else\n                data(i) = RIGHT(data(i),4)\n            End If\n        Next\n        .Value = Application.Transpose(data)\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 7618866, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-fG3CeLLShW0/AAAAAAAAAAI/AAAAAAAACaU/zFOt28wVaQA/photo.jpg?sz=128", "display_name": "JasonDL", "link": "https://stackoverflow.com/users/7618866/jasondl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1400, "favorite_count": 1, "accepted_answer_id": 42539653, "answer_count": 3, "score": 0, "last_activity_date": 1488411729, "creation_date": 1488392436, "question_id": 42539141, "link": "https://stackoverflow.com/questions/42539141/applying-vba-right-to-an-entire-column-infinite-loop-issue", "title": "Applying VBA RIGHT to an entire column - Infinite Loop Issue", "body": "<p>I have data that I am working to Parse Out that I have imported from approval emails sent in Outlook. At this point I am just importing the CreationTime and the SubjectLine.</p>\n\n<p>For the subject line I am able to use the Split function to separate out most of the data. I then am left with Job Codes in Column B and Position numbers in Column C which includes the text: \"Job Codes: XXXX\" and the four digit job code number and \"PN XXXX\" and either a four digit or 6 digit position number. I am trying to use the Right functionality to loop through the entire column and reformat the column just to show only the four digit job code number for Column B and either just the 4 digit or 6 digit position number (the actual numbers) for Column C </p>\n\n<p><strong>For Job Code Column B:</strong>\nCurrently my code works for Shortening the Job Codes but it involves adding a column, putting the RIGHT formula in that column for the shortened Job Code, then copying and pasting the formula as values back into the column and then deleting the original column.</p>\n\n<p><strong>The problem</strong>- Works but perhaps not the most efficient with a larger data set (currently 200 rows but will have 2000 or more)</p>\n\n<p><em>Code:</em></p>\n\n<pre><code>Sub ShortenJobCodes()\n\nApplication.ScreenUpdating = False\n\n    Const R4Col = \"=RIGHT(RC3,4)\"\n\n    Dim oRng As Range\n    Dim LastRow As Long\n\n    Range(\"B1\").EntireColumn.Insert\n\n    LastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    Set oRng = Range(\"B:B\")\n    Range(oRng, Cells(LastRow, \"B\")).FormulaR1C1 = R4Col\n    Set oRng = Nothing\n\n    Columns(\"B\").Select\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues\n\n    Range(\"C1\").EntireColumn.Delete\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p><strong>For Position Numbers Column C:</strong>\nCurrently I have mirrored the above code but added in an if statement using LEN to count if the characters are less than 8, if so then insert one RIGHT function if not insert the other RIGHT function. This also involves adding an additional column putting the RIGHT formula in that column for the shortened Position Number(Eliminating all but just the number), then copying and pasting the formula as values back into the column and then deleting the original column.</p>\n\n<p><strong>Problem</strong> - This works but seems to take forever to process and in fact looks like it is in an infinite loop. When I Esc out of it, it does add the column and then input the proper RIGHT formula (leaving just the numeric values) but the sub never seems to end, nor does it copy and paste the formulas as values or delete the original column. As noted above I realize this is likely a more efficient way to do this but I have tried a bunch of options without any luck.</p>\n\n<p>I am realizing part of the loop might be due to the range itself being an entire column but I cannot find a way to stop that with the last row (even though I have a count in there).</p>\n\n<p><em>Code:</em></p>\n\n<pre><code>Sub ShortenPositionNumbers()\n\nApplication.ScreenUpdating = False\n\n    Const R4Col = \"=RIGHT(RC4,4)\"\n    Const R6Col = \"=RIGHT(RC4,6)\"\n\n    Dim oRng As Range\n    Dim rVal As String\n    Dim y As Integer\n    Dim selCol As Range\n    Dim LastRow As Long\n\n    Range(\"C1\").EntireColumn.Insert\n\n    LastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    Set selCol = Range(\"D:D\")\n\n    For Each oRng In selCol\n        oRng.Select\n        rVal = oRng.Value\n        If Len(oRng.Value) &gt; 8 Then\n            oRng.Offset(0, -1).FormulaR1C1 = R6Col\n        Else\n            oRng.Offset(0, -1).FormulaR1C1 = R4Col\n        End If\n    Next\n\n    Set oRng = Nothing\n\n    Columns(\"C\").Select\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues\n\n    Range(\"D1\").EntireColumn.Delete\n\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p><strong><em>Major Question:</em></strong> Is there a way to use RIGHT/TRIM/LEN/LEFT functions to do this within a cell without having to add columns/delete columns and insert functions?</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1488393061, "post_id": 42539116, "comment_id": 72214362, "body": "I am using the same thing, you have two choices, either enter Select One: as one of the options of your drop down lists (I don&#39;t like this) or have a vba code to write (overrides) &quot;Select One:&quot; in the cells. If the user chooses one, then you are fine, if the user deletes it will be gone and to make Select One: appear again, you need to have a worksheet Change event to write that back. The easiest way is to write a validation macro to check the validity of the entries and also to make sure that required fields have been selected and not left blank."}], "answers": [{"tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": false, "score": 0, "last_activity_date": 1488474975, "creation_date": 1488474975, "answer_id": 42561815, "question_id": 42539116, "link": "https://stackoverflow.com/questions/42539116/how-to-show-default-values-with-drop-down-list/42561815#42561815", "title": "How to show default values with drop down list?", "body": "<p>As stated, you need to use a worksheet change event to override the value in the cell:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Dim Cell As Range\n    For Each Cell In UsedRange.SpecialCells(xlCellTypeAllValidation)\n        If Cell.Value = \"\" Then Cell.Value = \"Please Select:\"\n    Next Cell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7436225, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mBbNzwZL39Y/AAAAAAAAAAI/AAAAAAAAUVU/8UIchapLKEo/photo.jpg?sz=128", "display_name": "Luke Havelard", "link": "https://stackoverflow.com/users/7436225/luke-havelard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2374, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488474975, "creation_date": 1488392329, "question_id": 42539116, "link": "https://stackoverflow.com/questions/42539116/how-to-show-default-values-with-drop-down-list", "title": "How to show default values with drop down list?", "body": "<p>Is it possible to show default values in a cell where it also has INDIRECT drop down list?</p>\n\n<p>Illustration is in following link:\n<a href=\"https://imgur.com/a/h0pZV\" rel=\"nofollow noreferrer\">http://imgur.com/a/h0pZV</a></p>\n\n<p>As you can see in the picture, the drop down shows country using Data Validation List from a list of country.</p>\n\n<p>Is it possible this cell(A11) always display default values as \"Please select\" in that cell when there is no values from the drop down list?</p>\n\n<p>But when the selection eg. USA, is removed(DEL), It will display \"Please select\" again instead of blanks.</p>\n\n<p>Using formula is preferable than vba. Any inputs are appreciated.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1488391387, "post_id": 42538787, "comment_id": 72213339, "body": "Specifically set the format of the date by <code>FORMAT(FirstOrderDate,&quot;dd&#47;mm&#47;yyyy)</code>"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1488392706, "post_id": 42538787, "comment_id": 72214150, "body": "@BenjiKnightsJohnson there is nothing wrong with the code, you just need to control the format of your dates. First make sure that on your Excel file, the dates are really dates and not texts. To text, just write a formula in a cell and add 1 to one of the dates and you should get a date as the result, if it was a text you would get an error."}, {"owner": {"reputation": 43, "user_id": 7636047, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0YlZX.jpg?s=128&g=1", "display_name": "Benji Knights Johnson", "link": "https://stackoverflow.com/users/7636047/benji-knights-johnson"}, "edited": false, "score": 0, "creation_date": 1488533639, "post_id": 42538787, "comment_id": 72283403, "body": "Where do I put the FORMAT? I have tried creating a new variable that is defined with that format:      FirstOrderDDDate = Format(FirstOrderDDate, &quot;dd/mm/yyyy&quot;)  And have tried having it inside the SQL code like:          acApp.DoCmd.RunSQL &quot;DELETE * FROM [OrdersDetailed] WHERE [OrderDate] &gt;= #&quot; &amp; Format(FirstOrderDDate, &quot;dd/mm/yyyy&quot;) &amp; &quot;#&quot;  But both of those are still deleting data from 3rd Jan onwards..."}, {"owner": {"reputation": 43, "user_id": 7636047, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0YlZX.jpg?s=128&g=1", "display_name": "Benji Knights Johnson", "link": "https://stackoverflow.com/users/7636047/benji-knights-johnson"}, "edited": false, "score": 0, "creation_date": 1492941758, "post_id": 42538787, "comment_id": 74189284, "body": "I have eventually found out how to do this. You were nearly right Peter, not sure if it was a typo, but I needed to format the Excel variable as mm/dd/yyyy (not the mm and dd the other way round to Peter. So specifically what I did was:  LastOrderDate = Format(Range(&quot;D2&quot;), &quot;mm/dd/yyyy  hh:mm:ss&quot;)  within the Excel VBA."}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 11820228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d71c3fcb38f2720fff218aee7c94e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Kiran", "link": "https://stackoverflow.com/users/11820228/kiran"}, "is_accepted": false, "score": 0, "last_activity_date": 1581871384, "creation_date": 1581871384, "answer_id": 60250758, "question_id": 42538787, "link": "https://stackoverflow.com/questions/42538787/access-reading-excel-vba-date-in-us-format/60250758#60250758", "title": "Access reading Excel VBA date in US format", "body": "<p>Use <code>DateSerial()</code> in the query. Always use <code>DateSerial()</code>. It will never let you down. You want the SQL to look like this:</p>\n\n<pre><code>DELETE * FROM [OrdersDetailed] WHERE [OrderDate] &gt;= DateSerial(2020, 01, 02)\n</code></pre>\n\n<p>So your VBA should be:</p>\n\n<pre><code>\"DELETE * FROM [OrdersDetailed] WHERE [OrderDate] &gt;= DateSerial(\" &amp; Year(FirstOrderDDate) &amp; \", \" &amp; Month(FirstOrderDDate) &amp; \", \" &amp; Day(FirstOrderDDate) &amp; \")\"\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7636047, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0YlZX.jpg?s=128&g=1", "display_name": "Benji Knights Johnson", "link": "https://stackoverflow.com/users/7636047/benji-knights-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 585, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593954458, "creation_date": 1488391150, "last_edit_date": 1593954458, "question_id": 42538787, "link": "https://stackoverflow.com/questions/42538787/access-reading-excel-vba-date-in-us-format", "title": "Access reading Excel VBA date in US format", "body": "<p>I am trying to run a query from within Excel VBA with variables from the Excel, but Access is turning my dates into US format:</p>\n\n<pre><code>Sub upload()\nLast = ActiveSheet.UsedRange.Rows.Count\nDim LastOrderDate As Date\nDim LastOrderDateYear As Integer\nDim LastOrderDateMonth As Integer\nDim LastOrderDateDay As Integer\n\nFirstOrderDate = Range(\"D\" &amp; Last)\n\nFirstOrderDDate = DateSerial(Year(FirstOrderDate), Month(FirstOrderDate), Day(FirstOrderDate))\n\n'Import Data to Benji's Ecommerce Database\nssheet = Application.ActiveWorkbook.FullName\nSet acApp = CreateObject(\"Access.Application\")\n    acApp.OpenCurrentDatabase (\"X:\\ECommerce Database.accdb\")\n    acApp.Visible = True\n    acApp.UserControl = True\n    acApp.DoCmd.RunSQL \"DELETE * FROM [OrdersDetailed] WHERE [OrderDate] &gt;= #\" &amp; FirstOrderDDate &amp; \"#\"\n    acApp.CloseCurrentDatabase\n    acApp.Quit\nSet acApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>So for instance, with the variable 01/03/2017, it uses 03/01/2017 and deletes everything past 3rd Jan 2017, instead of the desired 1st Mar 2017.</p>\n\n<p>I have checked my date display settings on my computer, and as far as I can see my region is UK and date format is UKs, I have never seen US style dates ever on my comp!</p>\n\n<p>What is going on here, and how can I solve it?</p>\n\n<p>Thanks,</p>\n\n<p>Benji</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1488391301, "post_id": 42538751, "comment_id": 72213289, "body": "<code>=averageif(C:C, &quot;A&quot;, D:D)</code> should do the trick for Team A. Just get a distinct list of teams, change &quot;A&quot; to whatever cell holds the team letter you are averaging, and then copy down your formula to get all the teams covered."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1488391340, "post_id": 42538751, "comment_id": 72213308, "body": "Pivot Table will do it."}, {"owner": {"reputation": 138, "user_id": 5149262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3d53f206002493f2d9587a117d14fda?s=128&d=identicon&r=PG", "display_name": "Diego Ribba", "link": "https://stackoverflow.com/users/5149262/diego-ribba"}, "edited": false, "score": 0, "creation_date": 1488391740, "post_id": 42538751, "comment_id": 72213563, "body": "please post your code so far, in order to focus on what&#39;s not working, instead of creating an entire solution for you."}, {"owner": {"reputation": 371, "user_id": 6736247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/02978b1fa42fb47db1cbb90c71664e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Eleshar", "link": "https://stackoverflow.com/users/6736247/eleshar"}, "edited": false, "score": 0, "creation_date": 1488398381, "post_id": 42538751, "comment_id": 72217542, "body": "I&#39;d go with what JNevill and ScottCraner commented. Don&#39;t use macro for something you can do by a reasonably simple formula or a Pivot."}], "answers": [{"tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1488395823, "creation_date": 1488395823, "answer_id": 42540157, "question_id": 42538751, "link": "https://stackoverflow.com/questions/42538751/vba-macro-to-group-and-report-averages-by-team/42540157#42540157", "title": "VBA Macro to group and report averages by team", "body": "<pre><code>Sub macro1()\nDim lastRow As Long, lastRow2 As Long, myArray() As Variant, longNum As Long\nDim total As Long, rowNumb As Long, tallyCount As Long\n\n'**************************************************************************\n'   This macro uses arrays because it is quicker than ranges\n'   However it does paste an array to an out of the way place at columns(zw to zz)\n'   I did this to incorporate a speedy removeduplicates so we would have\n'   a single list of names\n\n'   Then it siphons through the arrays to get totals for each member and\n'   their averages.\n'\n'   It assumes your data is in columns a through d and puts\n'   Memebr Name in Column E\n'   Member total in column F\n'   Member Average in column G\n\nlastRow = Range(\"A65536\").End(xlUp).Row\nmyArray = Range(\"A1:D\" &amp; lastRow)\nRange(\"ZW1:ZZ\" &amp; lastRow) = myArray\nColumns(Range(\"ZX\" &amp; 1).Column).Select\nRange(\"ZX1:ZX\" &amp; lastRow).RemoveDuplicates Columns:=Array(1), Header:=xlYes\nlastRow2 = Range(\"ZX65536\").End(xlUp).Row\nnameArray = Range(\"ZX2:ZX\" &amp; lastRow2)\nRange(\"ZW1:ZZ\" &amp; lastRow).ClearContents\nRange(\"A1\").Select\nrowNumb = 2\nFor i = LBound(nameArray) To UBound(nameArray)\n    Debug.Print nameArray(i, 1)\nNext i\n\nFor i = LBound(nameArray) To UBound(nameArray)\n    total = 0\n    For j = LBound(myArray) To UBound(myArray)\n        If myArray(j, 2) = nameArray(i, 1) Then\n            tallyCount = tallyCount + 1\n            total = total + myArray(j, 4)\n        End If\n    Next j\n        If total &lt;&gt; 0 Then\n            Range(\"E\" &amp; rowNumb) = nameArray(i, 1)\n            Range(\"F\" &amp; rowNumb) = total\n            Range(\"G\" &amp; rowNumb) = total / tallyCount\n            rowNumb = rowNumb + 1\n            tallyCount = 0\n        End If\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7530355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66a4b3b86bcb6a3c625ddbd2c2b6a0d3?s=128&d=identicon&r=PG&f=1", "display_name": "J hussong", "link": "https://stackoverflow.com/users/7530355/j-hussong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 263, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488395823, "creation_date": 1488391038, "last_edit_date": 1531164843, "question_id": 42538751, "link": "https://stackoverflow.com/questions/42538751/vba-macro-to-group-and-report-averages-by-team", "title": "VBA Macro to group and report averages by team", "body": "<p>I have a weekly report I need to run where I get a list of users associated with different teams and the completion time for each of their given tasks. I need to report back each teams average cycle time for task completion.</p>\n\n<pre><code>task    Name    Team    Cycle time\n7701    john    A            5\n7825    tom     A            2\n6945    terri   C            7\n7036    jane    B            6\n6946    tim     B            9\n6899    john    A            4\n7135    jim     C            6\n7805    jim     C            2\n9405    terri   C            8\n6209    jason   B            2\n7508    derek   A            4\n8305    derek   A            5\n8426    jane    B            6\n3256    juan    C            7\n</code></pre>\n\n<p>The number of tasks, people, and teams will be dynamic</p>\n\n<p>My thought is to somehow unstack the data by teams then get average cycle times from there, but I'm not sure how to achieves that. Does anyone know a VBA command for unstacking the data?</p>\n\n<p>Thank you for any ideas you all may have.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 97, "user_id": 6932857, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e3a87011afa8b7d1de66e107f6e3c4c3?s=128&d=identicon&r=PG&f=1", "display_name": "Ace16150s", "link": "https://stackoverflow.com/users/6932857/ace16150s"}, "is_accepted": false, "score": 1, "last_activity_date": 1488392522, "creation_date": 1488392522, "answer_id": 42539163, "question_id": 42538631, "link": "https://stackoverflow.com/questions/42538631/ms-excel-vba-get-file-names-within-subfolders-of-a-declared-folder/42539163#42539163", "title": "MS Excel VBA - Get file names within subfolders of a declared folder", "body": "<p>Found the answer at the following site:</p>\n\n<p><a href=\"https://www.extendoffice.com/documents/excel/2994-excel-list-all-files-in-folder-and-subfolders.html\" rel=\"nofollow noreferrer\">https://www.extendoffice.com/documents/excel/2994-excel-list-all-files-in-folder-and-subfolders.html</a></p>\n\n<p>Hope it may lend some help..very user friendly!</p>\n"}, {"tags": [], "owner": {"reputation": 187, "user_id": 1727919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2e334da005840264c291d97a8b27d7?s=128&d=identicon&r=PG", "display_name": "Paras Parmar", "link": "https://stackoverflow.com/users/1727919/paras-parmar"}, "is_accepted": false, "score": 1, "last_activity_date": 1488455693, "last_edit_date": 1592644375, "creation_date": 1488455693, "answer_id": 42554828, "question_id": 42538631, "link": "https://stackoverflow.com/questions/42538631/ms-excel-vba-get-file-names-within-subfolders-of-a-declared-folder/42554828#42554828", "title": "MS Excel VBA - Get file names within subfolders of a declared folder", "body": "<p>I was working on this code before you posted the link and had second thoughts posting my work. So I checked out the link you posted.  I believe that the code I wanted to post is succinct &amp; addresses the point far better. Hence here you go</p>\n<blockquote>\n<p>Step 1. The Reference</p>\n</blockquote>\n<p><a href=\"https://i.stack.imgur.com/XeMQe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XeMQe.png\" alt=\"References needed for this code\" /></a></p>\n<blockquote>\n<p>Step2. The Code.</p>\n</blockquote>\n<pre><code>Sub FindFiles()\nDim fso As FileSystemObject\nDim Folder As Folder\nDim Files As Files\nDim path, s As String\n\n'' Input Path : Please change as needed\npath = Sheets(&quot;Sheet1&quot;).Cells(1, 2).Value\n\nSet fso = New FileSystemObject\nSet Basefolder = fso.GetFolder(path)\nSet SubFolders = Basefolder.SubFolders\nDim i As Integer\ni = 1\nFor Each Folder In SubFolders\n    Set Files = Folder.Files\n    For Each File In Files\n       With Sheets(&quot;Sheet1&quot;)\n       .Cells(i, 1).Value = Folder\n       .Cells(i, 2).Value = File\n       i = i + 1\n    Next File\nNext Folder\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 6932857, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e3a87011afa8b7d1de66e107f6e3c4c3?s=128&d=identicon&r=PG&f=1", "display_name": "Ace16150s", "link": "https://stackoverflow.com/users/6932857/ace16150s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4439, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1488455693, "creation_date": 1488390647, "last_edit_date": 1488391686, "question_id": 42538631, "link": "https://stackoverflow.com/questions/42538631/ms-excel-vba-get-file-names-within-subfolders-of-a-declared-folder", "title": "MS Excel VBA - Get file names within subfolders of a declared folder", "body": "<p>I am trying to loop through all subfolders within a folder, compiling all the names of the files. I'm having a bit of trouble though as I have adapted this code from a macro that only loops through one folder and compiles file names. Thank you greatly for your time!</p>\n\n<pre><code>Sub FindFiles()\n\nCells(1, 1).Select\n\nDim F As String\nDim G As String\n\nF = Dir(\"C:\\Users\\z003nttv\\Desktop\\Folder\\\" &amp; \"*\")\nDo While Len(F) &gt; 0\n\nDo While Len(G) &gt; 0\nG = Dir(F &amp; \"*.*\")\nActiveCell.Formula = G\nActiveCell.Offset(1, 0).Select\nG = Dir()\nLoop\nF = Dir()\nLoop\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 7308462, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/39456abd68e4734be9caa4b3204a8315?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7308462/john-tipton"}, "edited": false, "score": 0, "creation_date": 1488390566, "post_id": 42538585, "comment_id": 72212865, "body": "Thank you so much for the quick answer. SO doesn&#39;t allow me to approve it for now. Will do after 11 mins. Thanks again!"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1488390595, "last_edit_date": 1488390595, "creation_date": 1488390461, "answer_id": 42538585, "question_id": 42538532, "link": "https://stackoverflow.com/questions/42538532/excel-vba-columns-replace-for-two-columns/42538585#42538585", "title": "Excel-vba Columns().replace for two columns", "body": "<p>do two seperate calls, remember the <code>_</code> indicates a line continuation so both lines need to be duplicated:</p>\n\n<pre><code>Option Explicit\nSub ReplaceDoTwComma()   \n        Worksheets(\"Sheet1\").Columns(\"D\").replace _\n            What:=\",\", replacement:=\".\", LookAt:=xlPart    \n        Worksheets(\"Sheet1\").Columns(\"G\").replace _\n            What:=\",\", replacement:=\".\", LookAt:=xlPart \nEnd Sub\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>Option Explicit\nSub ReplaceDoTwComma()   \n        Worksheets(\"Sheet1\").Range(\"D:D,G:G\").replace _\n            What:=\",\", replacement:=\".\", LookAt:=xlPart    \n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 7308462, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/39456abd68e4734be9caa4b3204a8315?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7308462/john-tipton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 897, "favorite_count": 0, "accepted_answer_id": 42538585, "answer_count": 1, "score": 0, "last_activity_date": 1488390595, "creation_date": 1488390316, "last_edit_date": 1495541828, "question_id": 42538532, "link": "https://stackoverflow.com/questions/42538532/excel-vba-columns-replace-for-two-columns", "title": "Excel-vba Columns().replace for two columns", "body": "<p>The code below changes comma to period for Column D.\nI want it happen for both D &amp; G. </p>\n\n<pre><code>Option Explicit\n    Sub ReplaceDoTwComma()   \n            Worksheets(\"Sheet1\").Columns(\"D\").replace _\n                What:=\",\", replacement:=\".\", LookAt:=xlPart    \n    End Sub\n</code></pre>\n\n<p>I have tried  </p>\n\n<pre><code>Worksheets(\"Sheet1\").Columns(\"D\").replace _\nWorksheets(\"Sheet1\").Columns(\"G\").replace _\n</code></pre>\n\n<p>or <code>Columns(\"D\", \"G\")</code> or <code>Columns (\"D\" &amp; \"G\")</code>  But no luck. </p>\n\n<p>My good reference is <a href=\"https://stackoverflow.com/questions/26998383/excel-vba-code-for-replacing-all-by-in-a-column\">Excel VBA code for replacing all &quot;.&quot; by &quot;,&quot; in a column</a></p>\n\n<p>Any guidance would be highly appreciated. \nThank you!</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1488390219, "post_id": 42538415, "comment_id": 72212658, "body": "By far the easiest way to insert text into a document is to use bookmarks."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1488390350, "post_id": 42538415, "comment_id": 72212749, "body": "&quot;...but if I assign the code to a button it errors&quot;  What error do you get, at what line?"}, {"owner": {"reputation": 11, "user_id": 7636718, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5993b69b92948eccfd2014f4c838b8f8?s=128&d=identicon&r=PG&f=1", "display_name": "GreatSc0tt", "link": "https://stackoverflow.com/users/7636718/greatsc0tt"}, "edited": false, "score": 0, "creation_date": 1488391220, "post_id": 42538415, "comment_id": 72213254, "body": "so i figured out the button problem. It was the line &#39;objWord.Activate&#39; that was causing the issue.   I am still having problems with the text fields tho"}, {"owner": {"reputation": 11, "user_id": 7636718, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5993b69b92948eccfd2014f4c838b8f8?s=128&d=identicon&r=PG&f=1", "display_name": "GreatSc0tt", "link": "https://stackoverflow.com/users/7636718/greatsc0tt"}, "edited": false, "score": 0, "creation_date": 1488393704, "post_id": 42538415, "comment_id": 72214720, "body": "@Cominterm do you have any resources on bookmarks."}], "answers": [{"tags": [], "owner": {"reputation": 170, "user_id": 3650990, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aqZki.jpg?s=128&g=1", "display_name": "LKW", "link": "https://stackoverflow.com/users/3650990/lkw"}, "is_accepted": false, "score": 1, "last_activity_date": 1488421923, "creation_date": 1488421923, "answer_id": 42545777, "question_id": 42538415, "link": "https://stackoverflow.com/questions/42538415/import-excel-data-into-word/42545777#42545777", "title": "Import Excel Data into Word", "body": "<p>you can access the textboxes by:</p>\n\n<p>objWord.ActiveDocument.Shapes(1).TextFrame.TextRange.Text = strValue1<br>\nobjWord.ActiveDocument.Shapes(2).TextFrame.TextRange.Text = strValue2</p>\n\n<p>hope this helps!</p>\n"}], "owner": {"reputation": 11, "user_id": 7636718, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5993b69b92948eccfd2014f4c838b8f8?s=128&d=identicon&r=PG&f=1", "display_name": "GreatSc0tt", "link": "https://stackoverflow.com/users/7636718/greatsc0tt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488421923, "creation_date": 1488389948, "last_edit_date": 1488401648, "question_id": 42538415, "link": "https://stackoverflow.com/questions/42538415/import-excel-data-into-word", "title": "Import Excel Data into Word", "body": "<p>I have some code that i wrote to export data from cells and it imports it into a word documents.</p>\n\n<p>My two issues that i am having trouble with are as followed</p>\n\n<ol>\n<li><p>Right now it just imports the cell data into the start of the document. What i need it to do is import the data into predefined textboxes</p></li>\n<li><p>Right now i can run the code in the VBA editor and step into the code and run through it with no issues but if I assign the code to a button it errors. The problem is the box appear and there is no text in it</p></li>\n</ol>\n\n<p>here is my current code</p>\n\n<pre><code>Sub Invoice()\nDim objWord As Object\nDim objDoc As Object\nSet objWord = CreateObject(\"Word.Application\")\nobjWord.Visible = True\nobjWord.Documents.Open \"C:\\Users\\account\\Desktop\\Invoice.docx\"\n\nDim strValue1 As String\nDim strValue2 As String\nDim strValue3 As String\n\nobjWord.Activate\n\nstrValue1 = Cells(Selection.Row, 2)\nstrValue2 = Cells(Selection.Row, 3)\nstrValue3 = Cells(Selection.Row, 4)\nobjWord.Selection.TypeText Text:=strValue1\nobjWord.Selection.TypeText Text:=strValue2\nobjWord.Selection.TypeText Text:=strValue3\nEnd Sub\n</code></pre>\n\n<p>any help would be great appreciated </p>\n\n<p>Cheers!\nGreatSc0tt</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 142786, "user_id": 42346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZikEw.jpg?s=128&g=1", "display_name": "mechanical_meat", "link": "https://stackoverflow.com/users/42346/mechanical-meat"}, "is_accepted": false, "score": 0, "last_activity_date": 1488390267, "last_edit_date": 1488390267, "creation_date": 1488389740, "answer_id": 42538353, "question_id": 42538210, "link": "https://stackoverflow.com/questions/42538210/copy-active-cell-to-another-sheet/42538353#42538353", "title": "Copy Active Cell to another sheet", "body": "<p>You can create a subroutine to do just that:</p>\n\n<pre><code>Sub copy_cell(CopyFrom As Range, CopyTo As Range)\n    CopyTo.Value = CopyFrom.Value\nEnd Sub\n</code></pre>\n\n<p>And call it like so:</p>\n\n<pre><code>Sub testing()\n    Dim CopyFrom As Range\n    Dim CopyTo As Range\n    Set CopyFrom = ActiveWorkbook.ActiveSheet.Range(\"A1\")\n    Set CopyTo = ActiveWorkbook.ActiveSheet.Range(\"A9\")\n    Call copy_cell(CopyFrom, CopyTo)\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1488390501, "creation_date": 1488390501, "answer_id": 42538596, "question_id": 42538210, "link": "https://stackoverflow.com/questions/42538210/copy-active-cell-to-another-sheet/42538596#42538596", "title": "Copy Active Cell to another sheet", "body": "<p>If you have to use <code>Selection</code> (even though it's recommended to stay away from it), then use the code below:</p>\n\n<pre><code>Sub CopyPaste_toA9()\n\nSelection.Copy\nSheets(\"Sheet1\").Range(\"A9\").PasteSpecial xlPasteValues\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4924, "favorite_count": 0, "accepted_answer_id": 42538596, "answer_count": 2, "score": 0, "last_activity_date": 1488390501, "creation_date": 1488389248, "last_edit_date": 1531161705, "question_id": 42538210, "link": "https://stackoverflow.com/questions/42538210/copy-active-cell-to-another-sheet", "title": "Copy Active Cell to another sheet", "body": "<p>I am trying to copy a selected cell values only to another sheet. The Selected cell varies but will always be placed in Sheet1 (\"A9\")</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "csv", "scientific-notation"], "comments": [{"owner": {"reputation": 68, "user_id": 5675174, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ChAJVG5kzVI/AAAAAAAAAAI/AAAAAAAAAEA/ok6wbVYEI60/photo.jpg?sz=128", "display_name": "Hemant Pathak", "link": "https://stackoverflow.com/users/5675174/hemant-pathak"}, "edited": false, "score": 0, "creation_date": 1488389399, "post_id": 42538203, "comment_id": 72212140, "body": "have you tried to change cell format to text, that way excel should not try to convert numeric valued"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1488389872, "post_id": 42538203, "comment_id": 72212429, "body": "I&#39;m not sure I understand the question.  The code you posted is using a text driver.  Where does the spreadsheet come into play?"}, {"owner": {"reputation": 164, "user_id": 6100889, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d668560e423af459bd8d8e701ac1cb72?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6100889/tim"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1488473869, "post_id": 42538203, "comment_id": 72256904, "body": "@Comintern please try and understand the question .Now the problem is when I use the above routine in vba to import my csv file the long number is imported in scientific notation.I would like to know a way to avoid or take care of this when I am doing my import through vba code which is above so far have read here [<a href=\"http://stackoverflow.com/questions/22647042/how-to-save-excel-columns-with-long-numbers-into-csv]\" title=\"how to save excel columns with long numbers into csv%5d\">stackoverflow.com/questions/22647042/&hellip;</a> and of no help"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1488474319, "post_id": 42538203, "comment_id": 72257245, "body": "Import into <i>what</i>? The code you posted only creates a recordset using the ADO text driver and assigns them to some random identifiers. Where exactly is it showing up in scientific notation?  In one of the variables\\controls\\whatever <code>InvoiceNum</code> or <code>LicenceNumber</code> is? On a worksheet somewhere?"}, {"owner": {"reputation": 164, "user_id": 6100889, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d668560e423af459bd8d8e701ac1cb72?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6100889/tim"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1488474777, "post_id": 42538203, "comment_id": 72257547, "body": "@Comintern &quot;CardNumber&quot; this number is about 22 to 31 digits long I have a query that takes those variables and populate the database which is MYSQL DB that bit is fine just the manipulation of cardnumber is what i struggle with"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1488475614, "post_id": 42538203, "comment_id": 72258076, "body": "^^That&#39;s the code people would need to see to answer this question."}, {"owner": {"reputation": 164, "user_id": 6100889, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d668560e423af459bd8d8e701ac1cb72?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6100889/tim"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1488534307, "post_id": 42538203, "comment_id": 72283916, "body": "@Comintern added the SQL as per your request see if you can help please"}], "owner": {"reputation": 164, "user_id": 6100889, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d668560e423af459bd8d8e701ac1cb72?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6100889/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 651, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1488534225, "creation_date": 1488389217, "last_edit_date": 1488534225, "question_id": 42538203, "link": "https://stackoverflow.com/questions/42538203/how-to-import-long-number-from-csv-to-a-database-without-converting-to-scientifi", "title": "How to import long number from csv to a database without converting to scientific notation in VBA", "body": "<p>I have a  CSV file that I would like to import all data on it .So far I can read all the data in the file to my database but the long number I have there is converted to scientific notation  making my data redundant. When I open my CSV file in notepad ++ the data looks good in its original format but when I open the same file in excel the data is in scientific notation.The problem is I am using VBA excel to read my CSV file so the data I get is the same as when I open my file in excel.I would like to be able to use VBA excel for import but get the original number not scientific notation one is there a way to manipulate that so when I do my import I get the long number in its original format.\nso far here is the code for my import</p>\n\n<pre><code>con.Provider = \"Microsoft.Ace.OLEDB.12.0\"\ncon.ConnectionString = \"Data Source=\" &amp; currentDataFilePath &amp; \";\" &amp; \"Extended Properties=\"\"text;HDR=Yes;FMT=Delimited;\"\"\"\n'MsgBox currentDataFilePath\n\ncon.Open\n\nrs.Open \"SELECT * FROM [\" &amp; currentDataFileName &amp; \"] \", con\nrs.MoveFirst\n'nextRow = Worksheets(\"Sheet3\").UsedRange.Rows.Count + 1\n'Worksheets(\"Sheet3\").Cells(nextRow, 1).CopyFromRecordset rs\n\n'MsgBox rs.RecordCount\nWith rs\nDo Until .EOF\n\n'check the field is not null before process\n\n If Not IsNull(rs(\"Invoice Number\")) Then\n InvoiceNum = rs(\"Invoice Number\")\n End If\n    If Not IsNull(rs(\"Payer Name\")) Then\n PayerName = rs(\"Payer Name\")\n End If\n    If Not IsNull(rs(\"Card Number\")) Then\n CardNumber = \"\"\"\" &amp; rs(\"Card Number\") &amp; \"\"\"\"\n End If\n    If Not IsNull(rs(\"Licence Number\")) Then\n LicenceNumber = rs(\"Licence Number\")\n End If\n    If Not IsNull(rs(\"Driver Name\")) Then\n DriverName = rs(\"Driver Name\")\n End If\n    If Not IsNull(rs(\"Transaction Date\")) Then\n TransactionDate = rs(\"Transaction Date\")\n End If\n\nsqlstring=\"INSERT INTO tabledata set InvoiceNum='\"&amp; InvoiceNum &amp;\"',PayerName='\" &amp; PayerName &amp;\"',CardNumber='\" &amp; CardNumber &amp;\"',TransactionDate='\" &amp; TransactionDate &amp;\"'\"\ncall insertQuery(sqlstring)\n.movenext\nLoop\n End With\n</code></pre>\n"}, {"tags": ["vba", "excel", "vbscript"], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 1, "last_activity_date": 1488389408, "creation_date": 1488389408, "answer_id": 42538262, "question_id": 42537940, "link": "https://stackoverflow.com/questions/42537940/vbscript-to-add-code-to-excel-workbook/42538262#42538262", "title": "VBScript to add code to Excel workbook", "body": "<p>First, you shouldn't use <code>xlmodule</code> as a variable name.  It's already defined as an Excel constant. I'd call it something like <code>component</code> instead.  The <code>VBComponents</code> collection has an indexer that accepts either the ordinal index of the component <em>or</em> the component name.  In your case it would be easiest to just use the name:</p>\n\n<pre><code>Set component = ThisWorkbook.VBProject.VBComponents(\"DieseArbeitsmappe\")\ncode = _\n    \"Sub WorkBook_Open()\" &amp; vbCr &amp; _\n    \"   Application.Run \"\"'CommonMacro.xlsm'!Workbook_Open\"\"\" &amp; vbCr &amp; _\n    \"End Sub\"\ncomponent.CodeModule.AddFromString code\n</code></pre>\n\n<p>Note that it's usually not best practice to call an event handler directly like that.  If you need to reuse the functionality, you should pull it out of the handler and then have <code>Workbook_Open</code> call the extracted <code>Sub</code>.</p>\n"}], "owner": {"reputation": 460, "user_id": 1453887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/o92Vq.jpg?s=128&g=1", "display_name": "CodeChimpy", "link": "https://stackoverflow.com/users/1453887/codechimpy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 949, "favorite_count": 0, "accepted_answer_id": 42538262, "answer_count": 1, "score": 0, "last_activity_date": 1488389408, "creation_date": 1488388398, "last_edit_date": 1488388829, "question_id": 42537940, "link": "https://stackoverflow.com/questions/42537940/vbscript-to-add-code-to-excel-workbook", "title": "VBScript to add code to Excel workbook", "body": "<p>I have the task to add a <code>WorkBook_Open()</code> method to numerous Excel Workbooks. I managed to write a script which adds a module (marked red) with the needed code lines but I need it in the <code>DieseArbeitsmappe</code>(marked green) to autostart when the workbook is opened.</p>\n\n<p><a href=\"https://i.stack.imgur.com/vDqeS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vDqeS.png\" alt=\"Project setup\"></a></p>\n\n<pre><code>Set xlmodule = objworkbook.VBProject.VBComponents.Add(1)\nstrCode = _\n    \"Sub WorkBook_Open()\" &amp; vbCr &amp; _\n    \"   Application.Run (\"\"'CommonMacro.xlsm'!Workbook_Open\"\")\" &amp; vbCr &amp; _\n    \"End Sub\"\nxlmodule.CodeModule.AddFromString strCode\n</code></pre>\n\n<p>This is the code I have right now. I'm pretty sure that the mistake is at line 1 when setting the xlmodule but I can't figure how to reference to <code>DieseArbeitsmappe</code>. Thanks in advance for your help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1488388188, "post_id": 42537816, "comment_id": 72211429, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/16882143/find-out-the-last-used-column-in-a-given-row-excel-vba\">Find out the last used column in a given row - Excel VBA</a>. This question does not have the answered accepted, but the answer is correct. There&#39;s also probably many more answers on SO about this if you search a bit."}], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1488550712, "post_id": 42539693, "comment_id": 72294824, "body": "@Mark have you tried my code in the answer above ? any feedback ?"}, {"owner": {"reputation": 1, "user_id": 7605761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5a7f9edd1d624528a0c934338874bc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/7605761/mark"}, "edited": false, "score": 0, "creation_date": 1488894695, "post_id": 42539693, "comment_id": 72426115, "body": "Shai, just looked at this. it works as expected but my problem is that each time the workbook is used a new date is added to row 1 on the Data sheet and this is where the new data needs to be pasted as it is the above code will only paste to ColB I need someway for the code to identify the correct location to paste."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 1, "user_id": 7605761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5a7f9edd1d624528a0c934338874bc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/7605761/mark"}, "edited": false, "score": 0, "creation_date": 1488894817, "post_id": 42539693, "comment_id": 72426209, "body": "@Mark this was not in your post above"}, {"owner": {"reputation": 1, "user_id": 7605761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5a7f9edd1d624528a0c934338874bc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/7605761/mark"}, "edited": false, "score": 0, "creation_date": 1488900936, "post_id": 42539693, "comment_id": 72430518, "body": "I thought that&#39;s what I asked in the last part of my question, &quot;my issue is each time the code is used the col will change how can I add this to the module so that it looks for the last cell used in row 1 and pastes the values below.&quot;"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1488394288, "creation_date": 1488394288, "answer_id": 42539693, "question_id": 42537816, "link": "https://stackoverflow.com/questions/42537816/identify-the-last-used-cell-and-paste-below/42539693#42539693", "title": "identify the last used cell and paste below", "body": "<p>You can replace your second <code>For j = 2 To lastrow2</code> with the <code>Match</code> function.</p>\n\n<p>Also, there is no need to <code>Activate</code> the sheets back and fourth all the time, just use fully qualified <code>Range</code>s instead.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub TransferData()\n\nDim i As Long, j As Long, lastrow1 As Long, lastrow2 As Long\nDim myname As String\nDim MatchRng    As Range\n\nApplication.ScreenUpdating = False\nj = 2\nWith Sheets(\"Input Sheet\")\n    lastrow1 = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row\n\n    ' the 2 lines bellow should be outisde the loop\n    lastrow2 = Sheets(\"Data\").Range(\"A\" &amp; Sheets(\"Data\").Rows.Count).End(xlUp).Row\n    Set MatchRng = Sheets(\"Data\").Range(\"A2:A\" &amp; lastrow2)\n    For i = 2 To lastrow1\n        myname = .Range(\"B\" &amp; i).Value\n\n        If Not IsError(Application.Match(myname, MatchRng, 0)) Then '&lt;-- if successful Match\n            Sheets(\"Data\").Range(\"B\" &amp; j).Value = .Range(\"C\" &amp; i).Value\n            j = j + 1\n        End If\n        Application.CutCopyMode = False\n    Next i\nEnd With\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7605761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5a7f9edd1d624528a0c934338874bc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/7605761/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1041, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488394288, "creation_date": 1488388038, "last_edit_date": 1531164843, "question_id": 42537816, "link": "https://stackoverflow.com/questions/42537816/identify-the-last-used-cell-and-paste-below", "title": "identify the last used cell and paste below", "body": "<p>I'm a total novice with VBA. I have the following code which does a matching exercise and then pastes the relevant values into col. B. my issue is each time the code is used the col will change how can I add this to the module so that it looks for the last cell used in row 1 and pastes the values below.</p>\n\n<pre><code>Sub TransferData()\n\nDim i As Long, j As Long, lastrow1 As Long, lastrow2 As Long\nDim myname As String\n\nApplication.ScreenUpdating = False\n\nlastrow1 = Sheets(\"Input Sheet\").Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nFor i = 2 To lastrow1\n    myname = Sheets(\"Input Sheet\").Cells(i, \"B\").Value\n    Sheets(\"Data\").Activate\n    lastrow2 = Sheets(\"Data\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    For j = 2 To lastrow2\n        If Sheets(\"Data\").Cells(j, \"A\").Value = myname Then\n            Sheets(\"Input Sheet\").Activate\n            Sheets(\"Input Sheet\").Cells(i, \"c\").Copy\n            Sheets(\"Data\").Activate\n            Sheets(\"Data\").Cells(j, \"B\").Select\n            ActiveSheet.PasteSpecial\n        End If\n    Next j\n    Application.CutCopyMode = False\nNext i\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>any assistance with this would be appreciated.</p>\n"}, {"tags": ["excel", "vba", "runtime-error"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1488387917, "post_id": 42537766, "comment_id": 72211241, "body": "Are all of the worksheets names in all 3 workbooks identical?"}], "answers": [{"comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1488388255, "post_id": 42537847, "comment_id": 72211464, "body": "Maybe with moving that <code>shtName = wkb2.Worksheets(i).Name</code> to after the <code>For i = ...</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1488388294, "post_id": 42537847, "comment_id": 72211489, "body": "@A.S.H possibly... it&#39;s not clear what <code>shtName</code> is supposed to be anyway ;-)"}, {"owner": {"reputation": 1, "user_id": 7642674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bc721d0a8eb8401c0df83dda53cfe52?s=128&d=identicon&r=PG&f=1", "display_name": "leetontea", "link": "https://stackoverflow.com/users/7642674/leetontea"}, "edited": false, "score": 0, "creation_date": 1488389634, "post_id": 42537847, "comment_id": 72212277, "body": "Thank you! That fixed that error but it gave me an Error 9 on the first line,  wkb2.Sheets(shtName).Range(&quot;D2&quot;).Value = wkb1.Sheets(shtName).Range(&quot;D2&quot;)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1, "user_id": 7642674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bc721d0a8eb8401c0df83dda53cfe52?s=128&d=identicon&r=PG&f=1", "display_name": "leetontea", "link": "https://stackoverflow.com/users/7642674/leetontea"}, "edited": false, "score": 0, "creation_date": 1488390249, "post_id": 42537847, "comment_id": 72212681, "body": "@leetontea you need to read your code out loud. Does it do what it&#39;s <i>supposed</i> to be doing? Either <code>wkb1</code> or <code>wkb2</code> does not have a worksheet named <code>shtName</code> - you need to decide what you&#39;re trying to do here."}, {"owner": {"reputation": 1, "user_id": 7642674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bc721d0a8eb8401c0df83dda53cfe52?s=128&d=identicon&r=PG&f=1", "display_name": "leetontea", "link": "https://stackoverflow.com/users/7642674/leetontea"}, "edited": false, "score": 0, "creation_date": 1488390591, "post_id": 42537847, "comment_id": 72212875, "body": "There are 450 sheets, but I needed a quick way to take the value from the cell of one workbook to the other based on the name of the workbook. That line of code is supposed to take the D2 cell of wbk1 and paste it onto D2 cell of wbk2. I know the correct input is Sheets(&quot;string&quot;), but I thought if I set a variable to take on the name of each sheet, Sheets(shtName) would have worked."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1488390719, "post_id": 42537847, "comment_id": 72212942, "body": "Yes indeed, except you&#39;re working with 3 workbook objects here. One of them doesn&#39;t have the sheet name you&#39;re giving it. Your code is assuming that both <code>wkb1</code> and <code>wkb3</code> have all the sheets <code>wkb2</code> has. Apparently that isn&#39;t the case."}, {"owner": {"reputation": 1, "user_id": 7642674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bc721d0a8eb8401c0df83dda53cfe52?s=128&d=identicon&r=PG&f=1", "display_name": "leetontea", "link": "https://stackoverflow.com/users/7642674/leetontea"}, "edited": false, "score": 0, "creation_date": 1488390816, "post_id": 42537847, "comment_id": 72213008, "body": "So in order for this macro to work, I need identical amount of worksheets?"}, {"owner": {"reputation": 1, "user_id": 7642674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bc721d0a8eb8401c0df83dda53cfe52?s=128&d=identicon&r=PG&f=1", "display_name": "leetontea", "link": "https://stackoverflow.com/users/7642674/leetontea"}, "edited": false, "score": 0, "creation_date": 1488390971, "post_id": 42537847, "comment_id": 72213102, "body": "What if I were to set another variable p as an integer, then use an if statement to see if the first worksheets have the same name. If it does, then it&#39;ll use execute that line. If it doesn&#39;t, then the p value will increase by 1.  I have prefaced that I have 0 experience on VBA. Never took a class. I started looking into it due to my job over the last day or two. I know what I want it to do, but I&#39;m unsure of how to code it, so please bear with me!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1488391041, "post_id": 42537847, "comment_id": 72213149, "body": "Yes, verifying whether the sheet exists before you use it sounds like a good idea"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1488394324, "post_id": 42537847, "comment_id": 72215083, "body": "<code>You probably want to move it inside the loop though.</code> is the money. As is verifying the sheets exist in <code>wkb1</code> &amp; <code>wkb3</code> before trying to reference them."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 3, "last_activity_date": 1488388348, "last_edit_date": 1488388348, "creation_date": 1488388127, "answer_id": 42537847, "question_id": 42537766, "link": "https://stackoverflow.com/questions/42537766/runtime-error-9-on-loop/42537847#42537847", "title": "Runtime Error 9 on Loop", "body": "<blockquote>\n<pre><code>Dim i As Integer\n\nSet wkb1 = Workbooks.Open(\"C:\\Users\\lliao\\Documents\\Trad Reconciliation.xlsx\")\nSet wkb2 = Workbooks.Open(\"C:\\Users\\lliao\\Documents\\TradReconciliation.xlsx\")\nSet wkb3 = Workbooks.Open(\"C:\\Users\\lliao\\Documents\\Measure Trad Recon LS.xlsx\")\n\nshtName = wkb2.Worksheets(i).Name\n</code></pre>\n</blockquote>\n\n<p>Variable <code>i</code> is declared, but used before it's assigned - its value is therefore an implicit <code>0</code>.</p>\n\n<p>With VBA collections being 1-based, that makes <code>wkb2.Worksheets(i)</code> be out of bounds.</p>\n\n<pre><code>Dim i As Integer\ni = 1\n\n'...\n\nshtName = wkb2.Worksheets(i).Name\n</code></pre>\n\n<p>Will fix it.</p>\n\n<p>You probably want to move it inside the loop though.</p>\n"}, {"comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1488394089, "post_id": 42538633, "comment_id": 72214910, "body": "This is very potentially it. ASSUMING that the sheet names all match and are in the same order. If that&#39;s not the case, this will work fantastically well, but won&#39;t produce the desired output. It will also fail if <code>wkb1</code> and/or <code>wkb3</code> have a different number of sheets than <code>wkb2</code>. This is a great foundation to wrap some error checking around."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1488390652, "creation_date": 1488390652, "answer_id": 42538633, "question_id": 42537766, "link": "https://stackoverflow.com/questions/42537766/runtime-error-9-on-loop/42538633#42538633", "title": "Runtime Error 9 on Loop", "body": "<p>may be you're after this:</p>\n\n<pre><code>For i = 2 To wkb2.Worksheets.Count\n    wkb2.Sheets(i).Range(\"D3:F3\").Value = wkb1.Sheets(i).Range(\"D2:F2\")\n    wkb2.Sheets(i).Range(\"D4:F4\").Value = wkb3.Sheets(i).Range(\"D2:F2\")\nNext i\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7642674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bc721d0a8eb8401c0df83dda53cfe52?s=128&d=identicon&r=PG&f=1", "display_name": "leetontea", "link": "https://stackoverflow.com/users/7642674/leetontea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1488390652, "creation_date": 1488387841, "last_edit_date": 1488388155, "question_id": 42537766, "link": "https://stackoverflow.com/questions/42537766/runtime-error-9-on-loop", "title": "Runtime Error 9 on Loop", "body": "<p>I have three workbooks; all with information on the same policies, but come from different documents. I'm trying to copy the value of the same cell from each worksheet that has the same worksheet name in workbooks 1 &amp; workbook 3. This is the code that I have:</p>\n\n<pre><code>Sub foo()\n\n    Dim wbk1 As Workbook\n    Dim wbk2 As Workbook\n    Dim wkb3 As Workbook\n    Dim shtName As String\n    Dim i As Integer\n\n    Set wkb1 = Workbooks.Open(\"C:\\Users\\lliao\\Documents\\Trad Reconciliation.xlsx\")\n    Set wkb2 = Workbooks.Open(\"C:\\Users\\lliao\\Documents\\TradReconciliation.xlsx\")\n    Set wkb3 = Workbooks.Open(\"C:\\Users\\lliao\\Documents\\Measure Trad Recon LS.xlsx\")\n\n    shtName = wkb2.Worksheets(i).Name\n\n    For i = 2 To wkb2.Worksheets.Count\n        wkb2.Sheets(shtName).Range(\"D3\").Value = wkb1.Sheets(shtName).Range(\"D2\")\n        wkb2.Sheets(shtName).Range(\"E3\").Value = wkb1.Sheets(shtName).Range(\"E2\")\n        wkb2.Sheets(shtName).Range(\"F3\").Value = wkb1.Sheets(shtName).Range(\"F2\")\n        wkb2.Sheets(shtName).Range(\"D4\").Value = wkb3.Sheets(shtName).Range(\"D2\")\n        wkb2.Sheets(shtName).Range(\"E4\").Value = wkb3.Sheets(shtName).Range(\"E2\")\n        wkb2.Sheets(shtName).Range(\"F4\").Value = wkb3.Sheets(shtName).Range(\"F2\")\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>I don't understand how I'm using the subscript wrong. This is my first time coding VBA (first time in 5+ years), so I'm unfamiliar with coding errors.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "excel", "formulas"], "comments": [{"owner": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "edited": false, "score": 0, "creation_date": 1488388705, "post_id": 42537702, "comment_id": 72211730, "body": "For starters, try turning on the macro recorder, and going through the process manually.  Then you can view the macro in the editor and see how Excel executed each of your steps.  Post the code, and we can look it over to see what you need to do to make it more generally useful."}, {"owner": {"reputation": 11, "user_id": 7642458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34681daa981c7f159e717892329ad79c?s=128&d=identicon&r=PG&f=1", "display_name": "Mystified User", "link": "https://stackoverflow.com/users/7642458/mystified-user"}, "reply_to_user": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "edited": false, "score": 0, "creation_date": 1488467528, "post_id": 42537702, "comment_id": 72252392, "body": "Here is the code:"}], "owner": {"reputation": 11, "user_id": 7642458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34681daa981c7f159e717892329ad79c?s=128&d=identicon&r=PG&f=1", "display_name": "Mystified User", "link": "https://stackoverflow.com/users/7642458/mystified-user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1489077602, "creation_date": 1488387672, "last_edit_date": 1531164843, "question_id": 42537702, "link": "https://stackoverflow.com/questions/42537702/insert-text-after-specific-text-and-keep-formatting-and-forumulas-for-previous-r", "title": "Insert text after specific text and keep formatting and forumulas for previous row", "body": "<p>I am brand new to code and have spent hours searching and reading to try and find what I am looking for.  I have found this post (<a href=\"https://stackoverflow.com/questions/28825961/excel-vba-insert-row-above-specific-text-and-copy-formats-and-formula\">Excel VBA - Insert row above specific text and copy formats and formula</a>)\n that should answer my question but because of my lack of knowledge I am unable to make it completely work for me.  I can make the second code work to insert a row based on text but I am unable to determine how to copy the formulas from cells J, O, Z, and AE into the new row.</p>\n\n<p>Can this be done with one code?</p>\n\n<p>Here is the macro:</p>\n\n<p><code>Sub InsterRowCopyFormatForumula()</code> </p>\n\n<p><code>'</code>\n    <code>InsertRowCopyFormatFormula Macro</code>\n<code>'</code></p>\n\n<p><code>Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove</code></p>\n\n<p><code>Range(\"A6:B6\").Select</code></p>\n\n<p><code>Range(\"J5\").Select</code></p>\n\n<p><code>Selection.AutoFill Destination:=Range(\"J5:J6\"), Type:=xlFillDefault</code></p>\n\n<p><code>Range(\"J5:J6\").Select</code></p>\n\n<p><code>Range(\"O5\").Select</code></p>\n\n<p><code>Selection.AutoFill Destination:=Range(\"O5:O6\"), Type:=xlFillDefault</code></p>\n\n<p><code>Range(\"O5:O6\").Select</code></p>\n\n<p><code>Range(\"Z5\").Select</code></p>\n\n<p><code>Selection.AutoFill Destination:=Range(\"Z5:Z6\"), Type:=xlFillDefault</code></p>\n\n<p><code>Range(\"Z5:Z6\").Select</code></p>\n\n<p><code>Range(\"AE5\").Select</code></p>\n\n<p><code>Selection.AutoFill Destination:=Range(\"AE5:AE6\"), Type:=xlFillDefault</code></p>\n\n<p><code>Range(\"AE5:AE6\").Select</code></p>\n\n<p><code>End Sub</code></p>\n"}, {"tags": ["vba", "loops", "distinct-values"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1488387189, "post_id": 42537394, "comment_id": 72210754, "body": "You&#39;ll need to pass <code>rA</code> and <code>rB</code> as <code>Range</code> parameters to <code>FindDistinctSubstrings()</code> and then loop over that."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1488387698, "post_id": 42537394, "comment_id": 72211084, "body": "BTW, that algorithm is horribly, horribly inefficient. I&#39;ll post a much faster one on <a href=\"http://codereview.stackexchange.com/questions/tagged/vba\">Code Review</a> if I have time (it could probably use some feedback anyway)."}, {"owner": {"reputation": 11, "user_id": 4809903, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fzWQ3vjkMMw/AAAAAAAAAAI/AAAAAAAABJA/0nj4cxcE9HI/photo.jpg?sz=128", "display_name": "Sebastian Buurman", "link": "https://stackoverflow.com/users/4809903/sebastian-buurman"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1488387772, "post_id": 42537394, "comment_id": 72211148, "body": "Sorry about that and that would be fantastic if you have time - it did take quite a while to run for two short strings.."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1488430103, "post_id": 42537394, "comment_id": 72229634, "body": "Posted on <a href=\"http://codereview.stackexchange.com/questions/156670/find-all-differences-between-2-strings\">Code Review</a>."}, {"owner": {"reputation": 11, "user_id": 4809903, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fzWQ3vjkMMw/AAAAAAAAAAI/AAAAAAAABJA/0nj4cxcE9HI/photo.jpg?sz=128", "display_name": "Sebastian Buurman", "link": "https://stackoverflow.com/users/4809903/sebastian-buurman"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1488528336, "post_id": 42537394, "comment_id": 72280378, "body": "Wow thank you so much!"}], "owner": {"reputation": 11, "user_id": 4809903, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fzWQ3vjkMMw/AAAAAAAAAAI/AAAAAAAABJA/0nj4cxcE9HI/photo.jpg?sz=128", "display_name": "Sebastian Buurman", "link": "https://stackoverflow.com/users/4809903/sebastian-buurman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1488386824, "creation_date": 1488386824, "question_id": 42537394, "link": "https://stackoverflow.com/questions/42537394/add-loop-in-finddistinctsubstring-vba-module", "title": "Add Loop in FindDistinctSubString VBA Module", "body": "<p>I have found a VBA script which is capable of making a distinction between two strings. For example A1 = aaabbb and B1 = aaabbbccc - it will highlight the ccc section in B1.</p>\n\n<p>Since the report I am running this through has many rows I would like to loop it through a[i] and b[i]. I have tried adding standard loops though unfortunately it has consistently errored out.</p>\n\n<p>Does anyone have experience adding loops to such a script?</p>\n\n<p>Here is the script:</p>\n\n<pre><code>Public Sub FindDistinctSubstrings()\n\n    Dim a$, b$, i&amp;, k&amp;, rA As Range, rB As Range\n    Set rA = [a1]: a = rA\n    Set rB = [b1]: b = rB\n    k = Len(a): If Len(b) &gt; k Then k = Len(b)\n    Do\n        i = i + 1\n        If Mid$(a, i, 1) &lt;&gt; Mid$(b, i, 1) Then\n            Align i, a, b, rA, rB\n        End If\n        DoEvents\n    Loop Until i &gt; k\n    k = Len(a): If Len(b) &gt; k Then k = Len(b)\n    For i = 1 To k\n        If Mid$(a, i, 1) = \".\" Then rB.Characters(i, 1).Font.Color = vbRed\n        If Mid$(b, i, 1) = \".\" Then rA.Characters(i, 1).Font.Color = vbRed\n    Next\n    Do\n        k = InStr(rA, \".\"): If k Then rA.Characters(k, 1).Delete\n    Loop Until k = 0\n    Do\n        k = InStr(rB, \".\"): If k Then rB.Characters(k, 1).Delete\n    Loop Until k = 0\n\nEnd Sub\nPrivate Sub Align(k&amp;, a$, b$, rA As Range, rB As Range)\n    Dim i&amp;, iMax&amp;, nI&amp;, nMaxI&amp;, j&amp;, jMax&amp;, nJ&amp;, nMaxJ&amp;\n    Const LOOK_AHEAD_BUFFER = 30\n    For i = 0 To LOOK_AHEAD_BUFFER\n        nI = CountMatches(Space$(i) &amp; Mid$(a, k, LOOK_AHEAD_BUFFER), Mid$(b, k, LOOK_AHEAD_BUFFER))\n        If nI &gt; nMaxI Then\n            nMaxI = nI: iMax = i\n        End If\n    Next\n    For j = 0 To LOOK_AHEAD_BUFFER\n        nJ = CountMatches(Mid$(a, k, LOOK_AHEAD_BUFFER), Space$(j) &amp; Mid$(b, k, LOOK_AHEAD_BUFFER))\n        If nJ &gt; nMaxJ Then\n            nMaxJ = nJ: jMax = j\n        End If\n    Next\n    If nMaxI &gt; nMaxJ Then\n        a = Left$(a, k - 1) &amp; String$(iMax, \".\") &amp; Mid$(a, k)\n        rA = a: k = k + iMax\n    Else\n        b = Left$(b, k - 1) &amp; String$(jMax, \".\") &amp; Mid$(b, k)\n        rB = b: k = k + jMax\n    End If\nEnd Sub\nPrivate Function CountMatches(a$, b$) As Long\n    Dim i&amp;, k&amp;, c&amp;\n    k = Len(a): If Len(b) &lt; k Then k = Len(b)\n    For i = 1 To k\n        If Mid$(a, i, 1) = Mid$(b, i, 1) Then c = c + 1\n    Next\n    CountMatches = c\nEnd Function\n</code></pre>\n\n<p>Many thanks,\nSebastian</p>\n"}, {"tags": ["vba", "outlook"], "owner": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1066, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1592945563, "creation_date": 1488386375, "last_edit_date": 1592945563, "question_id": 42537237, "link": "https://stackoverflow.com/questions/42537237/how-to-get-appointment-object-in-outlook-vba-when-displaying-multiple-calendars", "title": "How to get appointment object in Outlook VBA when displaying multiple calendars", "body": "<p>I wanted to write an Outlook macro to display the date and time of creation and last modification of an appointment. Working with some code I found elsewhere, I cobbled this together.</p>\n\n<p>My Outlook 2013 calendar panel is configured to show two calendars: My personal calendar (using my Exchange account) and a shared group calendar (also an Exchange calendar). At first, I was happy with the result using appointments in one calendar, but I got an error when I selected an appointment from the other calendar and ran the macro. </p>\n\n<p>The error was -2147221233: Method 'LastModificationTime' of object '_AppointmentItem' failed. Whichever is the <em>second calendar</em> raises the error.</p>\n\n<pre><code>Public Sub lsApptCreated()\n\n    Dim CalFolder As MAPIFolder\n    Dim FocalItem As AppointmentItem\n\n    ' Use the selected calendar folder\n    Set CalFolder = Application.ActiveExplorer.CurrentFolder\n\n    If CalFolder.DefaultItemType &lt;&gt; olAppointmentItem Then\n        Set CalFolder = Nothing\n        MsgBox \"This macro only works when the current folder is a calendar.\", vbOKOnly, _\n            \"Check Creation Date\"\n        Exit Sub\n    End If\n\n    If Application.ActiveExplorer.Selection.Count &lt;&gt; 1 Then\n        Set CalFolder = Nothing\n        If Application.ActiveExplorer.Selection.Count = 0 Then\n            MsgBox \"This macro requires an appointment be selected.\", vbOKOnly, _\n            \"Convert Recurring Appointments\"\n        Else\n            MsgBox \"This macro requires a single appointment be selected.\", vbOKOnly, _\n            \"Check Creation Date\"\n        End If\n        Exit Sub\n    End If\n\n    Set FocalItem = Application.ActiveExplorer.Selection.Item(1)\n\n    On Error GoTo errhdl\n\n    MsgBox FocalItem.Subject &amp; vbCrLf &amp; vbCrLf _\n            &amp; \"Date/time created:    \" &amp; FocalItem.CreationTime &amp; vbCrLf _\n            &amp; \"Date/time modified: \" &amp; FocalItem.LastModificationTime, _\n            vbOKOnly, \"Check Creation Date\"\n\n    Set FocalItem = Nothing\n    Set CalFolder = Nothing\n\n    Exit Sub\n\nerrhdl:\n    MsgBox \"Error \" &amp; Err.Number &amp; \": \" &amp; Err.Description, _\n            vbCritical + vbOKOnly, \"Check Creation Date\"\n\n    Resume Next\n\nEnd Sub\n</code></pre>\n\n<p>Because I know very little about manipulating Outlook navigation panes, I thought about the more basic issue: Is there another way to get a handle on the appointment that might preserve all the properties? So I looked at some more code examples and decided to grab it by the EntryID. This worked:</p>\n\n<pre><code>Public Sub lsApptCreated()\n\n    Dim Namespace As Namespace\n    Dim CalFolder As MAPIFolder\n    Dim FocalItem As AppointmentItem\n    Dim ApptItem As AppointmentItem\n\n    ' Use the selected calendar folder\n    Set CalFolder = Application.ActiveExplorer.CurrentFolder\n\n    If CalFolder.DefaultItemType &lt;&gt; olAppointmentItem Then\n        Set CalFolder = Nothing\n        MsgBox \"This macro only works when the current folder is a calendar.\", vbOKOnly, _\n            \"Check Creation Date\"\n        Exit Sub\n    End If\n\n    If Application.ActiveExplorer.Selection.Count &lt;&gt; 1 Then\n        Set CalFolder = Nothing\n        If Application.ActiveExplorer.Selection.Count = 0 Then\n            MsgBox \"This macro requires an appointment be selected.\", vbOKOnly, _\n            \"Convert Recurring Appointments\"\n        Else\n            MsgBox \"This macro requires a single appointment be selected.\", vbOKOnly, _\n            \"Check Creation Date\"\n        End If\n        Exit Sub\n    End If\n\n    'For some reason, when viewing multiple calendars, after you switch\n    ' calendars it is not possible to access the LastModificationTime\n    ' property using the item returned from the ActiveExplorer.Selection\n    ' item. I discovered that instantiating the appointment using\n    ' the EntryID gets around the problem.\n    Set FocalItem = Application.ActiveExplorer.Selection.Item(1)\n    Set Namespace = Application.GetNamespace(\"MAPI\")\n    Set ApptItem = Namespace.GetItemFromID(FocalItem.EntryID)\n\n    On Error GoTo errhdl\n\n    MsgBox ApptItem.Subject &amp; vbCrLf &amp; vbCrLf _\n            &amp; \"Date/time created:    \" &amp; ApptItem.CreationTime &amp; vbCrLf _\n            &amp; \"Date/time modified: \" &amp; ApptItem.LastModificationTime, _\n            vbOKOnly, \"Check Creation Date\"\n\n    Set ApptItem = Nothing\n    Set Namespace = Nothing\n    Set FocalItem = Nothing\n    Set CalFolder = Nothing\n\n    Exit Sub\n\nerrhdl:\n    MsgBox \"Error \" &amp; Err.Number &amp; \": \" &amp; Err.Description, _\n            vbCritical + vbOKOnly, \"Check Creation Date\"\n\n    Resume Next\n\nEnd Sub\n</code></pre>\n\n<p>So my question is twofold:</p>\n\n<ol>\n<li>Why does the LastModificationTime property not exist when my object\nis grabbed from the Selection?</li>\n<li>Is there a more elegant way to accomplish what I want?</li>\n</ol>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "worksheet", "type-mismatch", "vba"], "answers": [{"tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": false, "score": 2, "last_activity_date": 1488386132, "creation_date": 1488386132, "answer_id": 42537154, "question_id": 42537047, "link": "https://stackoverflow.com/questions/42537047/type-mismatch-using-worksheet-to-clear-cells/42537154#42537154", "title": "Type mismatch using worksheet to clear cells", "body": "<p>You have already created a worksheet object called <code>mySheet</code>, you just need to make direct reference to it:</p>\n\n<pre><code>mySheet.Cells.Clear\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1488386136, "creation_date": 1488386136, "answer_id": 42537158, "question_id": 42537047, "link": "https://stackoverflow.com/questions/42537047/type-mismatch-using-worksheet-to-clear-cells/42537158#42537158", "title": "Type mismatch using worksheet to clear cells", "body": "<p><code>mySheet</code> is a worksheet object no need to wrap it in <code>Worksheets()</code>:</p>\n\n<pre><code>Dim mySheet As Worksheet\nSet mySheet = Worksheets(\"BOSS List\")\nmySheet.Cells.Clear\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 6595929, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10157119453725065/picture?type=large", "display_name": "Patrick", "link": "https://stackoverflow.com/users/6595929/patrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 42537158, "answer_count": 2, "score": 0, "last_activity_date": 1488386136, "creation_date": 1488385869, "last_edit_date": 1531164843, "question_id": 42537047, "link": "https://stackoverflow.com/questions/42537047/type-mismatch-using-worksheet-to-clear-cells", "title": "Type mismatch using worksheet to clear cells", "body": "<p>Can anyone tell me why the following VBA code gives me a Type mismatch in Excel?</p>\n\n<pre><code>Dim mySheet As Worksheet\nSet mySheet = Worksheets(\"BOSS List\")\nWorksheets(mySheet).Cells.Clear\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops", "text"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1488386024, "post_id": 42537010, "comment_id": 72209915, "body": "What is the runtime error?"}, {"owner": {"reputation": 181, "user_id": 6190232, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3b78ce8a9dfd39feff7fc8ec20f02fa6?s=128&d=identicon&r=PG&f=1", "display_name": "MBrann", "link": "https://stackoverflow.com/users/6190232/mbrann"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1488386166, "post_id": 42537010, "comment_id": 72210015, "body": "@A.S.H I only get the runtime error when I go into &quot;Immediate&quot; and ?Sheet1.Cells(lastRow, 1) = Data the runtime is 1004 Application-Defined or object-defined error"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1488386344, "post_id": 42537010, "comment_id": 72210137, "body": "just type <code>?Data</code> in the immediate window, what do you get? (place first a breakpoint on that line and check the value of <code>Data</code> in the immediate window)."}, {"owner": {"reputation": 181, "user_id": 6190232, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3b78ce8a9dfd39feff7fc8ec20f02fa6?s=128&d=identicon&r=PG&f=1", "display_name": "MBrann", "link": "https://stackoverflow.com/users/6190232/mbrann"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1488386498, "post_id": 42537010, "comment_id": 72210243, "body": "Trying the ?Data I just get a blank line. No respone"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1488386970, "post_id": 42537010, "comment_id": 72210610, "body": "Are you sure you had tested this macro <i>on the same file</i> ?"}, {"owner": {"reputation": 181, "user_id": 6190232, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3b78ce8a9dfd39feff7fc8ec20f02fa6?s=128&d=identicon&r=PG&f=1", "display_name": "MBrann", "link": "https://stackoverflow.com/users/6190232/mbrann"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1488387002, "post_id": 42537010, "comment_id": 72210625, "body": "@A.S.H I have just retried there and it does pull through the first line of the data I am looking to pull through"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1488387013, "post_id": 42537010, "comment_id": 72210634, "body": "Do me a favor for instance and type <code>Option Explicit</code> and declare your <code>Dim Data as String</code>."}, {"owner": {"reputation": 181, "user_id": 6190232, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3b78ce8a9dfd39feff7fc8ec20f02fa6?s=128&d=identicon&r=PG&f=1", "display_name": "MBrann", "link": "https://stackoverflow.com/users/6190232/mbrann"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1488387031, "post_id": 42537010, "comment_id": 72210650, "body": "@A.S.H yes positive I have been working on the tests on the same 5 files all day"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1488387085, "post_id": 42537010, "comment_id": 72210692, "body": "Also check that you dont have any sort of <code>Data Validation</code> in your worksheet. Try with a fresh new worksheet."}, {"owner": {"reputation": 181, "user_id": 6190232, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3b78ce8a9dfd39feff7fc8ec20f02fa6?s=128&d=identicon&r=PG&f=1", "display_name": "MBrann", "link": "https://stackoverflow.com/users/6190232/mbrann"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1488387121, "post_id": 42537010, "comment_id": 72210707, "body": "@A.S.H Thanks for the advice there. &#39;Option Explcit&#39; and &#39;Dim Data As String&#39; done... still no change"}, {"owner": {"reputation": 181, "user_id": 6190232, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3b78ce8a9dfd39feff7fc8ec20f02fa6?s=128&d=identicon&r=PG&f=1", "display_name": "MBrann", "link": "https://stackoverflow.com/users/6190232/mbrann"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1488387242, "post_id": 42537010, "comment_id": 72210783, "body": "@A.S.H thank you very much. Imported the Macro to a new worksheet and it has gone through fine. So you think Data Validation appears to be the issue?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1488387307, "post_id": 42537010, "comment_id": 72210824, "body": "Most likely data validation. Probably also some merged cells, these are source of trouble also."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1488387348, "post_id": 42537010, "comment_id": 72210848, "body": "what&#39;s the value of <code>lastRow</code> when it errors out?"}, {"owner": {"reputation": 181, "user_id": 6190232, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3b78ce8a9dfd39feff7fc8ec20f02fa6?s=128&d=identicon&r=PG&f=1", "display_name": "MBrann", "link": "https://stackoverflow.com/users/6190232/mbrann"}, "edited": false, "score": 0, "creation_date": 1488387374, "post_id": 42537010, "comment_id": 72210863, "body": "Ah great. Thank you for your help much appreciated"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1488387403, "post_id": 42537010, "comment_id": 72210878, "body": "ignore my comment, I saw you already made it"}, {"owner": {"reputation": 181, "user_id": 6190232, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3b78ce8a9dfd39feff7fc8ec20f02fa6?s=128&d=identicon&r=PG&f=1", "display_name": "MBrann", "link": "https://stackoverflow.com/users/6190232/mbrann"}, "edited": false, "score": 0, "creation_date": 1488387422, "post_id": 42537010, "comment_id": 72210895, "body": "Lastrow value when it errored out earlier was the last row of the sheet 1048576"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1488387511, "post_id": 42537010, "comment_id": 72210943, "body": "ouch!! you shouldn&#39;t use as many rows in a worksheet!"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1488387579, "post_id": 42537010, "comment_id": 72211000, "body": "As I see you&#39;re only using the first column of the worksheet. Think of spreading your data across many columns."}, {"owner": {"reputation": 181, "user_id": 6190232, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3b78ce8a9dfd39feff7fc8ec20f02fa6?s=128&d=identicon&r=PG&f=1", "display_name": "MBrann", "link": "https://stackoverflow.com/users/6190232/mbrann"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1488387705, "post_id": 42537010, "comment_id": 72211091, "body": "@A.S.H unfortunately our new system is picking up txt files which is why its in 1 column. The system then changes it to a table"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1488387802, "post_id": 42537010, "comment_id": 72211167, "body": "Then keep in mind that you will be limited in the number of rows. <code>1048576</code> is the maximum number of rows that Excel can accept <i>in a single worksheet</i>."}], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 0, "last_activity_date": 1488388467, "creation_date": 1488388467, "answer_id": 42537970, "question_id": 42537010, "link": "https://stackoverflow.com/questions/42537010/loop-error-going-through-directory/42537970#42537970", "title": "Loop error going through directory", "body": "<p>As pointed out in the comments, you're running out of rows.  One solution would be to test to see if you've just hit the last row, and then continue on a new worksheet (obviously untested, but should give you the gist):</p>\n\n<pre><code>Sub Loopthroughtxtdir()\n    Dim Filename As String\n    Dim Path As String\n\n    Path = \"C:\\MK\\MasterData\\\"\n    Filename = Dir$(Path &amp; \"*.txt\")\n\n    Dim currentSheet As Worksheet\n    Set currentSheet = ThisWorkbook.Worksheets(\"Sheet1\")\n    With currentSheet\n        Dim lastRow As Long\n        lastRow = .Cells(.Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n    End With\n\n    Do While Len(Filename) &gt; 0\n        Dim handle As Integer\n        handle = FreeFile\n        Open Path &amp; Filename For Input As #handle\n        Do Until EOF(handle)\n            Line Input #handle, Data\n            currentSheet.Cells(lastRow, 1) = Data\n            lastRow = lastRow + 1\n            If lastRow &gt; currentSheet.Rows.Count Then\n                Set currentSheet = ThisWorkbook.Worksheets.Add\n                lastRow = 1\n            End If\n        Loop\n        Close #handle\n        Filename = Dir$\n    Loop\n\n    MsgBox (\"Import Complete\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 6190232, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3b78ce8a9dfd39feff7fc8ec20f02fa6?s=128&d=identicon&r=PG&f=1", "display_name": "MBrann", "link": "https://stackoverflow.com/users/6190232/mbrann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488388467, "creation_date": 1488385776, "last_edit_date": 1531164843, "question_id": 42537010, "link": "https://stackoverflow.com/questions/42537010/loop-error-going-through-directory", "title": "Loop error going through directory", "body": "<p>I am hoping someone can help... I have the below code which worked an absolute treat all day. Until 16:10 and now suddently decides to pick up a runtime error. on line <code>Sheet1.Cells(lastRow, 1) = Data</code></p>\n\n<pre><code>Sub Loopthroughtxtdir()\n    Dim Filename As String\n    Dim Path As String\n\n    Path = \"C:\\MK\\MasterData\\\"\n    Filename = Dir(Path &amp; \"*.txt\")\n\n    With ThisWorkbook.Sheets(\"Sheet1\")\n        Dim lastRow As Long\n        lastRow = Sheet1.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n        Do While Len(Filename) &gt; 0\n            Dim handle As Integer\n            handle = FreeFile\n            Open Path &amp; Filename For Input As #handle\n            Do Until EOF(handle)\n                Line Input #handle, Data\n                Sheet1.Cells(lastRow, 1) = Data\n                lastRow = lastRow + 1\n            Loop\n            Close #handle\n            Filename = Dir\n        Loop\n    End With\n\n    MsgBox (\"Import Complete\")\n\nEnd Sub\n</code></pre>\n\n<p>Can anyone please assist. I am very confused why this was working. Nothing has changed and now has stopped after several tests.</p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7642316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aba888475a0b93ac991574c9cf305ae?s=128&d=identicon&r=PG&f=1", "display_name": "M Eqbal", "link": "https://stackoverflow.com/users/7642316/m-eqbal"}, "edited": false, "score": 0, "creation_date": 1488432632, "post_id": 42537513, "comment_id": 72230500, "body": "Thanks buddy, its worked on previous version of IE but not current IE version."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1529220816, "post_id": 42537513, "comment_id": 88789292, "body": "Very nice approach  + 1"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1488388066, "last_edit_date": 1488388066, "creation_date": 1488387133, "answer_id": 42537513, "question_id": 42536816, "link": "https://stackoverflow.com/questions/42536816/getting-web-table-data-into-excel/42537513#42537513", "title": "Getting Web table data into excel", "body": "<p>Try like this, it may work for you, depending on your Internet Explorer.</p>\n\n<pre><code>Option Explicit\n\nSub GetData()\n\n    Dim IE      As Object\n    Dim Links   As Object\n    Dim evt     As Object\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    IE.navigate (\"https://uk.investing.com/indices/us-spx-500-historical-data\")\n    IE.Visible = True\n    Do\n        DoEvents        \n    Loop Until IE.readyState = 4\n\n    Set Links = IE.document.GetElementById(\"data_interval\")\n    Set evt = IE.document.createevent(\"htmlevents\")\n    evt.initevent \"change\", True, False\n\n    Links.Focus\n    Links.SelectedIndex = 2\n    Links.FireEvent (\"onChange\")\n\n    Links.dispatchevent evt\n\nEnd Sub\n</code></pre>\n\n<p>Tribute to <a href=\"http://www.xtremevbtalk.com/excel/325370-vba-ie9-fireevent-method.html\" rel=\"nofollow noreferrer\">these guys</a> for firing the event correctly.</p>\n"}], "owner": {"reputation": 11, "user_id": 7642316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aba888475a0b93ac991574c9cf305ae?s=128&d=identicon&r=PG&f=1", "display_name": "M Eqbal", "link": "https://stackoverflow.com/users/7642316/m-eqbal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552071248, "creation_date": 1488385194, "last_edit_date": 1488387585, "question_id": 42536816, "link": "https://stackoverflow.com/questions/42536816/getting-web-table-data-into-excel", "title": "Getting Web table data into excel", "body": "<p>I wanted to get monthly data from \"<a href=\"https://investing.com/indices/us-spx-500-historical-data\" rel=\"nofollow noreferrer\">https://investing.com/indices/us-spx-500-historical-data</a>\" into excel through vba.</p>\n\n<p>Here is the source code of Time Frame dropdown menu:-</p>\n\n<pre><code>&lt;select id=\"data_interval\" class=\"newInput selectBox float_lang_base_1\"&gt;\n        &lt;option value=\"Daily\" selected=\"\"&gt;Daily&lt;/option&gt;\n        &lt;option value=\"Weekly\"&gt;Weekly&lt;/option&gt;\n        &lt;option value=\"Monthly\"&gt;Monthly&lt;/option&gt;\n    &lt;/select&gt;enter code here\n</code></pre>\n\n<p>Here is the Table source Code:</p>\n\n<pre><code>&lt;table class=\"genTbl closedTbl historicalTbl\" id=\"curr_table\" tablesorter=\"\"&gt;enter code here\n</code></pre>\n\n<p>Here is the VBA code I am using,</p>\n\n<pre><code>Sub GetData()\nDim IE As Object\nDim Links\nSet IE = CreateObject(\"InternetExplorer.Application\")\nIE.navigate (\"https://uk.investing.com/indices/us-spx-500-historical-data\")\nIE.Visible = True\nDo\n    DoEvents\nLoop Until IE.readyState = 4\nSet Links = IE.document.getElementById(\"data_interval\")\nLinks.selectedIndex = 2\nEnd Sub\n</code></pre>\n\n<p>2 is the Monthly Index number, It can select the Monthly from dropdown menu but the table not update itself from weekly to Monthly, I am also wanting to get this data into excel</p>\n"}, {"tags": ["vba", "excel", "excel-formula", "runtime-error"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1488385295, "post_id": 42536691, "comment_id": 72209363, "body": "You need to escape the quotes in your formula: <code>... Approval.Address &amp; &quot;,&quot;&quot;&quot;&quot;, &quot; &amp; PeakShare.Address ...</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1488385535, "post_id": 42536691, "comment_id": 72209548, "body": "Your code needs better indentation... badly. Please allow me introduce you to my <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a>, it can fix this for you."}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1488387304, "post_id": 42536691, "comment_id": 72210819, "body": "@Mat&#39;sMug I&#39;ve installed Rubberduck, but i do not see it in my com add ins or vba edtior menu, help?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1488388221, "post_id": 42536691, "comment_id": 72211450, "body": "@pokemon_Man feel free to ask a new question tagged <a href=\"https://stackoverflow.com/questions/tagged/rubberduck\">rubberduck</a>, or <a href=\"https://github.com/rubberduck-vba/Rubberduck/issues/new\" rel=\"nofollow noreferrer\">open up a new issue</a> on the project&#39;s repository."}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1488388816, "post_id": 42536691, "comment_id": 72211804, "body": "@Mat&#39;sMug done, please assist <a href=\"http://stackoverflow.com/questions/42538026/can-not-see-the-add-in-after-installing-rubberduck\" title=\"can not see the add in after installing rubberduck\">stackoverflow.com/questions/42538026/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1488385370, "post_id": 42536878, "comment_id": 72209413, "body": "And why would it?"}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": true, "score": 1, "last_activity_date": 1488385430, "last_edit_date": 1488385430, "creation_date": 1488385351, "answer_id": 42536878, "question_id": 42536691, "link": "https://stackoverflow.com/questions/42536691/run-time-error-1004-have-researched-and-tried-several-recommended-solutions-t/42536878#42536878", "title": "Run Time Error &#39;1004&#39;, have researched and tried several recommended solutions to no avail", "body": "<p>This should work:</p>\n\n<pre><code>formulaTest = \"=IF(\" &amp; Numbering.Address(False, False) &amp; \"&lt;\" &amp; Approval.Address &amp; \",\"\"\"\",\" &amp; PeakShare.Address &amp; \"*\" &amp; RampUp.Address &amp; \")\"\n</code></pre>\n\n<p>As @Comintern pointed out, you need to use <code>\"\"\"\"</code> to include double empty speech marks in your formula. I also removed the spaces either side of the <code>*</code></p>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 1, "creation_date": 1488386534, "post_id": 42536929, "comment_id": 72210268, "body": "SamMcdonald; but @CallumDA &#39;s answer was the same as mine and faster: you should accept his!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1488385556, "creation_date": 1488385556, "answer_id": 42536929, "question_id": 42536691, "link": "https://stackoverflow.com/questions/42536691/run-time-error-1004-have-researched-and-tried-several-recommended-solutions-t/42536929#42536929", "title": "Run Time Error &#39;1004&#39;, have researched and tried several recommended solutions to no avail", "body": "<p>change </p>\n\n<pre><code>IF(\" &amp; Numbering.Address(False, False) &amp; \"&lt;\" &amp; Approval.Address &amp; \",\"\", \" &amp; PeakShare.Address &amp; \" * \" &amp; RampUp.Address &amp; \")\"\n</code></pre>\n\n<p>to</p>\n\n<pre><code>IF(\" &amp; Numbering.Address(False, False) &amp; \"&lt;\" &amp; Approval.Address &amp; \",\"\"\"\", \" &amp; PeakShare.Address &amp; \" * \" &amp; RampUp.Address &amp; \")\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1488387264, "creation_date": 1488387264, "answer_id": 42537555, "question_id": 42536691, "link": "https://stackoverflow.com/questions/42536691/run-time-error-1004-have-researched-and-tried-several-recommended-solutions-t/42537555#42537555", "title": "Run Time Error &#39;1004&#39;, have researched and tried several recommended solutions to no avail", "body": "<p>Instead of counting how many <code>\"</code> you have, you can use <code>Chr(34)</code> inside <code>\"</code> to have a <code>Formula</code> check for <code>\"</code>.</p>\n\n<p>In your case, use:</p>\n\n<pre><code>\"=IF(\" &amp; Numbering.Address(False, False) &amp; \"&lt;\" &amp; Approval.Address &amp; \",\" &amp; Chr(34) &amp; \", \" &amp; PeakShare.Address &amp; \" * \" &amp; RampUp.Address &amp; \")\"\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4971625, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10153378436138656/picture?type=large", "display_name": "Sam Mcdonald", "link": "https://stackoverflow.com/users/4971625/sam-mcdonald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 42536878, "answer_count": 3, "score": 0, "last_activity_date": 1488387264, "creation_date": 1488384795, "last_edit_date": 1531164843, "question_id": 42536691, "link": "https://stackoverflow.com/questions/42536691/run-time-error-1004-have-researched-and-tried-several-recommended-solutions-t", "title": "Run Time Error &#39;1004&#39;, have researched and tried several recommended solutions to no avail", "body": "<p>I am trying to fill a range with a formula and continue to get a runtime error '1004'. The error occurs at the line I have starred <strong>Sheets(\"Forecast\").Range(\"H125\").Formula = formulaTest</strong>. The code in my Sub is as follows:</p>\n\n<pre><code>Sub FirmShareFill()\n\nDim RampUp As Range\nDim RampBas As Range\nDim RampDn As Range\nDim Numbering As Range\nDim Approval As Range\nDim PeakShare As Range\n\n\n\nDim tcount As Byte\nDim bcount As Byte\nDim ubdcount As Byte\nDim yearRange2 As Byte\n\nyear = Worksheets(\"Inputs\").Range(\"B6\").Value\ncntry = Worksheets(\"Inputs\").Range(\"B5\").Value\nbnd = Worksheets(\"Inputs\").Range(\"B3\").Value\ntyp = Worksheets(\"Inputs\").Range(\"B2\").Value\ncat = Worksheets(\"Inputs\").Range(\"B4\").Value\n\ntcount = bnd * cat + bnd\nubdcount = tcount * 2 + 1\nyearCount = year * 4 - 1\n\n        For ubd = 1 To 3\n        For t = 1 To typ\n        For b = 1 To bnd\n        For c = 1 To cat\n        For i = 1 To cntry\n\n        Set RampUp = Columns(7).Find(What:=\"Ramp_Up\" &amp; i, MatchCase:=True).Offset(0, 1)\n        Set RampBas = Columns(7).Find(What:=\"Ramp_Bas\" &amp; i, MatchCase:=True).Offset(0, 1)\n        Set RampDn = Columns(7).Find(What:=\"Ramp_Dn\" &amp; i, MatchCase:=True).Offset(0, 1)\n\n        Set Numbering = Sheets(\"Inputs\").Range(\"B13\")\n        Set Approval = Columns(6).Find(What:=\"Approval\", MatchCase:=True).Offset(i, 2 + ubd)\n\n\n        bcount = c + (cat + 1) * (b - 1)\n\n        If t = 1 And b = 1 And ubd = 1 Then\n            Set PeakShare = Columns(5).Find(What:=\"Peak Share\", MatchCase:=True).Offset(4 + i, c)\n        ElseIf t = 1 And b &gt; 1 And ubd = 1 Then\n            Set PeakShare = Columns(5).Find(What:=\"Peak Share\" &amp; c, MatchCase:=True).Offset(4 + i, bcount)\n        ElseIf t &gt; 1 And b = 1 And ubd = 1 Then\n            Set PeakShare = Columns(5).Find(What:=\"Peak Share\" &amp; c, MatchCase:=True).Offset(4 + i, c + tcount)\n        ElseIf t &gt; 1 And b &gt; 1 And ubd = 1 Then\n            Set PeakShare = Columns(5).Find(What:=\"Peak Share\" &amp; c, MatchCase:=True).Offset(4 + i, tcount + bcount)\n\n        ElseIf t = 1 And b = 1 And ubd = 2 Then\n            Set PeakShare = Columns(5).Find(What:=\"Peak Share\", MatchCase:=True).Offset(4 + i, c + ubdcount)\n        ElseIf t = 1 And b &gt; 1 And ubd = 1 Then\n            Set PeakShare = Columns(5).Find(What:=\"Peak Share\" &amp; c, MatchCase:=True).Offset(4 + i, bcount + ubdcount)\n        ElseIf t &gt; 1 And b = 1 And ubd = 1 Then\n            Set PeakShare = Columns(5).Find(What:=\"Peak Share\" &amp; c, MatchCase:=True).Offset(4 + i, c + tcount + ubdcount)\n        ElseIf t &gt; 1 And b &gt; 1 And ubd = 1 Then\n            Set PeakShare = Columns(5).Find(What:=\"Peak Share\" &amp; c, MatchCase:=True).Offset(4 + i, tcount + bcount + ubdcount)\n\n        ElseIf t = 1 And b = 1 And ubd = 3 Then\n            Set PeakShare = Columns(5).Find(What:=\"Peak Share\", MatchCase:=True).Offset(4 + i, c + 2 * ubdcount)\n        ElseIf t = 1 And b &gt; 1 And ubd = 3 Then\n            Set PeakShare = Columns(5).Find(What:=\"Peak Share\" &amp; c, MatchCase:=True).Offset(4 + i, bcount + 2 * ubdcount)\n        ElseIf t &gt; 1 And b = 1 And ubd = 3 Then\n            Set PeakShare = Columns(5).Find(What:=\"Peak Share\" &amp; c, MatchCase:=True).Offset(4 + i, c + tcount + 2 * ubdcount)\n        ElseIf t &gt; 1 And b &gt; 1 And ubd = 3 Then\n            Set PeakShare = Columns(5).Find(What:=\"Peak Share\" &amp; c, MatchCase:=True).Offset(4 + i, tcount + bcount + 2 * ubdcount)\n        End If\n\n        Dim formulaTest As String\n\n        formulaTest = \"=IF(\" &amp; Numbering.Address(False, False) &amp; \"&lt;\" &amp; Approval.Address &amp; \",\"\", \" &amp; PeakShare.Address &amp; \" * \" &amp; RampUp.Address &amp; \")\"\n\n        If ubd = 1 Then\n        **Sheets(\"Forecast\").Range(\"H125\").Formula = formulaTest**\n        ActiveCell.Offset(1, 0).Select\n\n        ElseIf ubd = 2 Then\n        Range(ActiveCell, ActiveCell.Offset(0, yearRange2)).Formula = \"=IF(\" &amp; Numbering.Address(False, False) &amp; \" &lt; \" &amp; Approval.Offset(1, 0).Address &amp; \",\"\", \" &amp; PeakShare.Address &amp; \" * \" &amp; RampBas.Address &amp; \"\"\n\n        ElseIf ubd = 3 Then\n        Range(ActiveCell, ActiveCell.Offset(0, yearRange2)).Formula = \"=IF(\" &amp; Numbering.Address(False, False) &amp; \" &lt; \" &amp; Approval.Offset(1, 0).Address &amp; \",\"\", \" &amp; PeakShare.Address &amp; \" * \" &amp; RampDn.Address &amp; \"\"\n\n        End If\n\n\n        Next i\n\n        ActiveCell.Offset(1, 0).Select\n\n        Next c\n        Next b\n        Next t\n        Next ubd\n\n\n\nEnd Sub\n</code></pre>\n\n<p>I believe the error may have something to do with how I declared the range \"numbering\" range, but as of yet I have been unable to figure it out. I have used this code on the same sheet many times, the only difference being that I have set a range, numbering, on a different sheet. </p>\n"}, {"tags": ["vba", "excel", "sorting", "runtime-error", "excel-2007"], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 7610519, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/da01ad51f95b2270fa51a6c109659fa5?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/7610519/francis"}, "edited": false, "score": 0, "creation_date": 1488385486, "post_id": 42536487, "comment_id": 72209509, "body": "Thank you Sanjay !"}], "tags": [], "owner": {"reputation": 6594, "user_id": 93910, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bcd3c9d1bdca6ce813053f420ebced02?s=128&d=identicon&r=PG&f=1", "display_name": "Sanjay Manohar", "link": "https://stackoverflow.com/users/93910/sanjay-manohar"}, "is_accepted": false, "score": 0, "last_activity_date": 1488384234, "creation_date": 1488384234, "answer_id": 42536487, "question_id": 42536408, "link": "https://stackoverflow.com/questions/42536408/sort-a-sheet-by-the-value-of-a-column-since-the-second-line/42536487#42536487", "title": "Sort a sheet by the value of a column since the second line", "body": "<p>do you want <code>key1:=Range(\"H:H\")?</code>\nI assume column H is your key, rather than a single cell H2.</p>\n"}, {"comments": [{"owner": {"reputation": 119, "user_id": 7610519, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/da01ad51f95b2270fa51a6c109659fa5?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/7610519/francis"}, "edited": false, "score": 0, "creation_date": 1488385417, "post_id": 42536792, "comment_id": 72209450, "body": "Thank you A.S.H. I found the answer too."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1488385093, "creation_date": 1488385093, "answer_id": 42536792, "question_id": 42536408, "link": "https://stackoverflow.com/questions/42536408/sort-a-sheet-by-the-value-of-a-column-since-the-second-line/42536792#42536792", "title": "Sort a sheet by the value of a column since the second line", "body": "<p>Change <code>Column</code> to <code>Columns</code> (typo in posting your code I think)</p>\n\n<p>Then you'll have a runtime error whenever <code>Worksheets(\"Data\")</code> is not the currently active worksheet. Your best bet is to avoid this type of errors altogether and <em>always</em> work with <em>qualified ranges</em></p>\n\n<pre><code>With Workbooks(\"Task2.xlsm\").Worksheets(\"Data\")\n    .Column(\"A:CA\").Sort key1:=.Range(\"H2\"), order1:=xlDescending, Header:=xlYes\nEnd with\n                              ^^^^\n</code></pre>\n\n<p>Notice the <code>.</code> (dot) in front of <code>Range(\"H2\")</code> whcih makes it refer <em>explicitly</em> to the sheet specified in the <code>with</code> clause. Without that, you're using an <em>unqualified range</em> whcih refers to the currently active sheet.</p>\n"}, {"tags": [], "owner": {"reputation": 119, "user_id": 7610519, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/da01ad51f95b2270fa51a6c109659fa5?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/7610519/francis"}, "is_accepted": true, "score": 0, "last_activity_date": 1488385332, "creation_date": 1488385332, "answer_id": 42536866, "question_id": 42536408, "link": "https://stackoverflow.com/questions/42536408/sort-a-sheet-by-the-value-of-a-column-since-the-second-line/42536866#42536866", "title": "Sort a sheet by the value of a column since the second line", "body": "<p>I recorded a macro and I found the answer(it can be simplified) :</p>\n\n<pre><code>    Workbooks(\"Task2.xlsm\").Worksheets(\"Data\").AutoFilter.Sort.SortFields.Clear\n    Workbooks(\"Task2.xlsm\").Worksheets(\"Data\").AutoFilter.Sort.SortFields.Add Key:=Range(\"H1\"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortTextAsNumbers\n    With Workbooks(\"Task2.xlsm\").Worksheets(\"Data\").AutoFilter.Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 7610519, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/da01ad51f95b2270fa51a6c109659fa5?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/7610519/francis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "accepted_answer_id": 42536866, "answer_count": 3, "score": 0, "last_activity_date": 1488385332, "creation_date": 1488384019, "question_id": 42536408, "link": "https://stackoverflow.com/questions/42536408/sort-a-sheet-by-the-value-of-a-column-since-the-second-line", "title": "Sort a sheet by the value of a column since the second line", "body": "<p>I want to sort the sheet according to the value(Date) of a column(new-old) from the second row till the end.<br>\nI wrote the code, but there's always an error : 1004, sort reference is not valid. Does someone happen to know the solution?<br>\nThank you.<br>\n<code>Workbooks(\"Task2.xlsm\").Worksheets(\"Data\").Column(\"A:CA\").Sort key1:=Range(\"H2\"), order1:=xlDescending, Header:=xlYes</code></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1488384010, "post_id": 42536321, "comment_id": 72208472, "body": "if you <i>&quot;need to retain all the rows that contain columns with the letters CCI in them.&quot;</i> then change <code>Criteria1:=&quot;CCI*&quot;</code> to <code>Criteria1:=&quot;&lt;&gt;CCI*&quot;</code>"}, {"owner": {"reputation": 35, "user_id": 7642297, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154701024323141/picture?type=large", "display_name": "Sean Kirkpatrick", "link": "https://stackoverflow.com/users/7642297/sean-kirkpatrick"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1488384337, "post_id": 42536321, "comment_id": 72208696, "body": "CCI is not in the same column throughout."}, {"owner": {"reputation": 35, "user_id": 7642297, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154701024323141/picture?type=large", "display_name": "Sean Kirkpatrick", "link": "https://stackoverflow.com/users/7642297/sean-kirkpatrick"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1488384485, "post_id": 42536321, "comment_id": 72208794, "body": "Changing &quot;CCI*&quot; to &quot;&lt;&gt;CCI*&quot; deletes every row except row 3."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1488384725, "post_id": 42536321, "comment_id": 72208958, "body": "I didin&#39;t get that &quot;CCI&quot; could be found in different columns. see my answer for a possible solution"}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1488386331, "post_id": 42536410, "comment_id": 72210130, "body": "@SeanKirkpatrick in comments you wrote <i>&quot;CCI is not in the same column throughout&quot;</i>: if this holds true then this code wouldn&#39;t work since it only filters 1st column"}, {"owner": {"reputation": 138, "user_id": 5149262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3d53f206002493f2d9587a117d14fda?s=128&d=identicon&r=PG", "display_name": "Diego Ribba", "link": "https://stackoverflow.com/users/5149262/diego-ribba"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1488387084, "post_id": 42536410, "comment_id": 72210690, "body": "@user3598756 that&#39;s not the situation, since the autofilter is applied to <code>rng</code> variable (A3:E7000). the code says that the criteria should be looked in the first column (field 1) of that range."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 1, "creation_date": 1488387189, "post_id": 42536410, "comment_id": 72210753, "body": "that&#39;s precisely what I wrote, your code is filtering <code>rng</code> first column only. While SeanKirkpatrick  wrote <i>&quot;CCI is not in the same column throughout&quot;</i>. He must have been wrong but to shy to admit it"}, {"owner": {"reputation": 138, "user_id": 5149262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3d53f206002493f2d9587a117d14fda?s=128&d=identicon&r=PG", "display_name": "Diego Ribba", "link": "https://stackoverflow.com/users/5149262/diego-ribba"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1488391431, "post_id": 42536410, "comment_id": 72213366, "body": "@user3598756 possible, but it&#39;s just a little mistake that gladly you pointed out."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 1, "creation_date": 1488392292, "post_id": 42536410, "comment_id": 72213896, "body": "then my first comment under the question did it, already. but Sean didn&#39;t even tried it and wrote <i>&quot;CCI is not in the same column throughout&quot;</i>. You see, the actual <i>mistake</i> is considering other people help as due and their efforts in it as worthless. too bad you can only see that once it&#39;s done"}, {"owner": {"reputation": 35, "user_id": 7642297, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154701024323141/picture?type=large", "display_name": "Sean Kirkpatrick", "link": "https://stackoverflow.com/users/7642297/sean-kirkpatrick"}, "edited": false, "score": 1, "creation_date": 1488477306, "post_id": 42536410, "comment_id": 72259112, "body": "I am not sure why the negative comments.  CCI is not in the same column.  Both your code worked and I appreciate it.  I am new to dealing with coding like this and am trying to learn.  All I now is that the code from both of you worked."}], "tags": [], "owner": {"reputation": 138, "user_id": 5149262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3d53f206002493f2d9587a117d14fda?s=128&d=identicon&r=PG", "display_name": "Diego Ribba", "link": "https://stackoverflow.com/users/5149262/diego-ribba"}, "is_accepted": false, "score": 0, "last_activity_date": 1488384029, "creation_date": 1488384029, "answer_id": 42536410, "question_id": 42536321, "link": "https://stackoverflow.com/questions/42536321/searching-entire-excel-worksheet-and-deleteing-all-rows-without-a-cell-containin/42536410#42536410", "title": "Searching Entire Excel Worksheet and Deleteing all rows without a cell containing a phrase", "body": "<p>it doesnt work because your making the opposite autofilter. it should be:</p>\n\n<pre><code>Sub KeepOnlyAtSymbolRows()\n    Dim ws As Worksheet\n    Dim rng As Range\n    Dim lastRow As Long\n\n    Set ws = ActiveWorkbook.Sheets(\"Sheet1\")\n\n\n    Set rng = ws.Range(\"A3:E70000\")\n\n    ' filter and delete all but header row\n    With rng\n        .AutoFilter Field:=1, Criteria1:=\"&lt;&gt;*CCI**\"\n        .Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n    End With\n\n    ' turn off the filters\n    ws.AutoFilterMode = False\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1488385229, "post_id": 42536647, "comment_id": 72209328, "body": "@SeanKirkpatrick, here you see two different codes for the same solution: the first keeping as close as possibile to your original one, while the second showing some refactoring to make it more robust (especially with the <code>If Application.WorksheetFunction.Subtotal(...</code> part, that makes sure you delete something if only that something exists). If it solves your question you may want to mark it as accepted by clicking on the check mark beside the answer to toggle it from greyed out to filled in. Thank you"}, {"owner": {"reputation": 35, "user_id": 7642297, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154701024323141/picture?type=large", "display_name": "Sean Kirkpatrick", "link": "https://stackoverflow.com/users/7642297/sean-kirkpatrick"}, "edited": false, "score": 0, "creation_date": 1488385709, "post_id": 42536647, "comment_id": 72209680, "body": "User3698756-  I am getting an AutoFilter method of Range class failed error."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 35, "user_id": 7642297, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154701024323141/picture?type=large", "display_name": "Sean Kirkpatrick", "link": "https://stackoverflow.com/users/7642297/sean-kirkpatrick"}, "edited": false, "score": 0, "creation_date": 1488386102, "post_id": 42536647, "comment_id": 72209969, "body": "check the last code: I originally wrote &quot;Sheet11&quot; instead of &quot;Sheet1&quot;. Be sure to use the name of the sheet you actually need"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 35, "user_id": 7642297, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154701024323141/picture?type=large", "display_name": "Sean Kirkpatrick", "link": "https://stackoverflow.com/users/7642297/sean-kirkpatrick"}, "edited": false, "score": 0, "creation_date": 1488386181, "post_id": 42536647, "comment_id": 72210026, "body": "@SeanKirkpatrick, if Diego&#39;s code worked then you have &quot;CCI&quot; occurrences in first column only"}, {"owner": {"reputation": 35, "user_id": 7642297, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154701024323141/picture?type=large", "display_name": "Sean Kirkpatrick", "link": "https://stackoverflow.com/users/7642297/sean-kirkpatrick"}, "edited": false, "score": 0, "creation_date": 1488389289, "post_id": 42536647, "comment_id": 72212072, "body": "There are no occurrences in the first column at all.  I did change your code to sheet 1 prior to running it.  when I step through the code, it is hitting on the autofilter line."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 35, "user_id": 7642297, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154701024323141/picture?type=large", "display_name": "Sean Kirkpatrick", "link": "https://stackoverflow.com/users/7642297/sean-kirkpatrick"}, "edited": false, "score": 0, "creation_date": 1488390253, "post_id": 42536647, "comment_id": 72212684, "body": "I mean that with such a code as <code>.AutoFilter Field:=col.Column, Criteria1:=&quot;&lt;&gt;CCI*&quot;</code> you&#39;re caring about first column only, which is not  what you wrote with <i>&quot;CCI is not in the same column throughout&quot;</i>. As for the <i>&quot;AutoFilter method of Range class failed error&quot;</i> I did test both my codes without errors. Which is the value of <code>col.Column</code> when you hit it?"}, {"owner": {"reputation": 35, "user_id": 7642297, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154701024323141/picture?type=large", "display_name": "Sean Kirkpatrick", "link": "https://stackoverflow.com/users/7642297/sean-kirkpatrick"}, "edited": false, "score": 0, "creation_date": 1488456051, "post_id": 42536647, "comment_id": 72244232, "body": "your code works as well, but for some reason I have to scroll to the bottom of the workbook to get it to work.  Not sure why."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 35, "user_id": 7642297, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154701024323141/picture?type=large", "display_name": "Sean Kirkpatrick", "link": "https://stackoverflow.com/users/7642297/sean-kirkpatrick"}, "edited": false, "score": 0, "creation_date": 1488456419, "post_id": 42536647, "comment_id": 72244469, "body": "Glad to know that. What do you mean for <i>&quot;scroll to the bottom of the workbook&quot;</i>? And what code are you using: the 1st or the 2nd?"}, {"owner": {"reputation": 35, "user_id": 7642297, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154701024323141/picture?type=large", "display_name": "Sean Kirkpatrick", "link": "https://stackoverflow.com/users/7642297/sean-kirkpatrick"}, "edited": false, "score": 0, "creation_date": 1488477466, "post_id": 42536647, "comment_id": 72259197, "body": "For some reason I can&#39;t get it to work when I am at the top of the worksheet say cell A1 selected.  Not sure why because it shouldn&#39;t matter."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1488385021, "last_edit_date": 1488385021, "creation_date": 1488384657, "answer_id": 42536647, "question_id": 42536321, "link": "https://stackoverflow.com/questions/42536321/searching-entire-excel-worksheet-and-deleteing-all-rows-without-a-cell-containin/42536647#42536647", "title": "Searching Entire Excel Worksheet and Deleteing all rows without a cell containing a phrase", "body": "<p>loop through all columns to exclude cells with \"CCI\" </p>\n\n<p>to stick to your original code, you could adopt:</p>\n\n<pre><code>Sub KeepOnlyAtSymbolRows()\n    Dim ws As Worksheet\n    Dim rng As Range\n    Dim lastRow As Long\n\n    Set ws = ActiveWorkbook.Sheets(\"Sheet1\")\n\n\n    Set rng = ws.Range(\"A3:E70000\")\n    Dim col As Range\n\n    ' filter and delete all but header row\n    With rng\n        For Each col In .Columns\n            .AutoFilter Field:=col.Column, Criteria1:=\"&lt;&gt;CCI*\"\n        Next\n        .Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n    End With\n\n    ' turn off the filters\n    ws.AutoFilterMode = False\nEnd Sub\n</code></pre>\n\n<p>While a refactoring could be:</p>\n\n<pre><code>Option Explicit\n\nSub KeepOnlyAtSymbolRows()\n    Dim col As Range\n\n    With ActiveWorkbook.Sheets(\"Sheet1\")\n        With .Range(\"E3\", .cells(.Rows.Count, \"A\").End(xlUp)) '&lt;--| row 3 must be \"header\" one\n            For Each col In .Columns\n                .AutoFilter Field:=col.Column, Criteria1:=\"&lt;&gt;CCI*\"\n            Next\n             If Application.WorksheetFunction.Subtotal(103, .Resize(, 1)) &gt; 1 Then .Resize(.Rows.Count - 1).Offset(1).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n        End With\n        .AutoFilterMode = False ' turn off the filters\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 7642297, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154701024323141/picture?type=large", "display_name": "Sean Kirkpatrick", "link": "https://stackoverflow.com/users/7642297/sean-kirkpatrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 42536647, "answer_count": 2, "score": 0, "last_activity_date": 1488385021, "creation_date": 1488383772, "last_edit_date": 1488383825, "question_id": 42536321, "link": "https://stackoverflow.com/questions/42536321/searching-entire-excel-worksheet-and-deleteing-all-rows-without-a-cell-containin", "title": "Searching Entire Excel Worksheet and Deleteing all rows without a cell containing a phrase", "body": "<p>I have merged several hundred XML files together, but I have a couple columns that have the a \"CCI-\" followed by some numbers in them.  I need to retain all the rows that contain columns with the letters CCI in them.  I tried this code, but it isn't working.  can someone give me a hand, please?  Thanks</p>\n\n<pre><code>Sub KeepOnlyAtSymbolRows()\n    Dim ws As Worksheet\n    Dim rng As Range\n    Dim lastRow As Long\n\n    Set ws = ActiveWorkbook.Sheets(\"Sheet1\")\n\n\n    Set rng = ws.Range(\"A3:E70000\")\n\n    ' filter and delete all but header row\n    With rng\n        .AutoFilter Field:=1, Criteria1:=\"CCI*\"\n        .Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n    End With\n\n    ' turn off the filters\n    ws.AutoFilterMode = False\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql-server", "ms-access", "vba"], "comments": [{"owner": {"reputation": 4595, "user_id": 314507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35fa938f2b64b7620be0181281f2ae1?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/314507/jeremy"}, "edited": false, "score": 0, "creation_date": 1488383240, "post_id": 42536083, "comment_id": 72207876, "body": "frm![Material ID]? frm(&quot;Material ID&quot;) ?"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1488383293, "post_id": 42536083, "comment_id": 72207919, "body": "Also frm.Material_ID. I believe access replaces spaces with an underscore."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1488385035, "post_id": 42536083, "comment_id": 72209203, "body": "Protip: don&#39;t use spaces or special characters in field names."}, {"owner": {"reputation": 131, "user_id": 4710262, "user_type": "registered", "accept_rate": 5, "profile_image": "https://www.gravatar.com/avatar/b6f459204c5faf842ef211de8384e496?s=128&d=identicon&r=PG&f=1", "display_name": "toofaced", "link": "https://stackoverflow.com/users/4710262/toofaced"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1488385242, "post_id": 42536083, "comment_id": 72209334, "body": "@Mat&#39;sMug: Ya, but for this case, someone else used it like a decade ago."}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1488385911, "post_id": 42536083, "comment_id": 72209846, "body": "If the code is being run from the form then in the VBA editor type in Me. and you will get the forms available control names via intellisense.  ProTip 2: Don&#39;t accept the default control names - so on this form change it to txtMaterialID them you know exactly what you are referring to."}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 4710262, "user_type": "registered", "accept_rate": 5, "profile_image": "https://www.gravatar.com/avatar/b6f459204c5faf842ef211de8384e496?s=128&d=identicon&r=PG&f=1", "display_name": "toofaced", "link": "https://stackoverflow.com/users/4710262/toofaced"}, "edited": false, "score": 0, "creation_date": 1488383588, "post_id": 42536172, "comment_id": 72208129, "body": "I had already tried that one too, it doesn&#39;t return anything for materialid."}, {"owner": {"reputation": 632, "user_id": 6165495, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-Arf292SOBCA/AAAAAAAAAAI/AAAAAAAAADc/q0xiAMkOREE/photo.jpg?sz=128", "display_name": "Arockia Nirmal", "link": "https://stackoverflow.com/users/6165495/arockia-nirmal"}, "reply_to_user": {"reputation": 131, "user_id": 4710262, "user_type": "registered", "accept_rate": 5, "profile_image": "https://www.gravatar.com/avatar/b6f459204c5faf842ef211de8384e496?s=128&d=identicon&r=PG&f=1", "display_name": "toofaced", "link": "https://stackoverflow.com/users/4710262/toofaced"}, "edited": false, "score": 1, "creation_date": 1488383650, "post_id": 42536172, "comment_id": 72208172, "body": "above you have mentioned you tried only with &#39;[frm!Material ID]&#39;.... which is different"}, {"owner": {"reputation": 632, "user_id": 6165495, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-Arf292SOBCA/AAAAAAAAAAI/AAAAAAAAADc/q0xiAMkOREE/photo.jpg?sz=128", "display_name": "Arockia Nirmal", "link": "https://stackoverflow.com/users/6165495/arockia-nirmal"}, "reply_to_user": {"reputation": 131, "user_id": 4710262, "user_type": "registered", "accept_rate": 5, "profile_image": "https://www.gravatar.com/avatar/b6f459204c5faf842ef211de8384e496?s=128&d=identicon&r=PG&f=1", "display_name": "toofaced", "link": "https://stackoverflow.com/users/4710262/toofaced"}, "edited": false, "score": 2, "creation_date": 1488383696, "post_id": 42536172, "comment_id": 72208207, "body": "leave the form name outside the square bracket"}, {"owner": {"reputation": 131, "user_id": 4710262, "user_type": "registered", "accept_rate": 5, "profile_image": "https://www.gravatar.com/avatar/b6f459204c5faf842ef211de8384e496?s=128&d=identicon&r=PG&f=1", "display_name": "toofaced", "link": "https://stackoverflow.com/users/4710262/toofaced"}, "edited": false, "score": 0, "creation_date": 1488383789, "post_id": 42536172, "comment_id": 72208283, "body": "I had tried this one too. It still returns nothing."}, {"owner": {"reputation": 632, "user_id": 6165495, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-Arf292SOBCA/AAAAAAAAAAI/AAAAAAAAADc/q0xiAMkOREE/photo.jpg?sz=128", "display_name": "Arockia Nirmal", "link": "https://stackoverflow.com/users/6165495/arockia-nirmal"}, "reply_to_user": {"reputation": 131, "user_id": 4710262, "user_type": "registered", "accept_rate": 5, "profile_image": "https://www.gravatar.com/avatar/b6f459204c5faf842ef211de8384e496?s=128&d=identicon&r=PG&f=1", "display_name": "toofaced", "link": "https://stackoverflow.com/users/4710262/toofaced"}, "edited": false, "score": 1, "creation_date": 1488383927, "post_id": 42536172, "comment_id": 72208408, "body": "Then I guess there might be problem with the actual data/code... try it with some other value of field to confirm whether the code works for other cases..."}, {"owner": {"reputation": 131, "user_id": 4710262, "user_type": "registered", "accept_rate": 5, "profile_image": "https://www.gravatar.com/avatar/b6f459204c5faf842ef211de8384e496?s=128&d=identicon&r=PG&f=1", "display_name": "toofaced", "link": "https://stackoverflow.com/users/4710262/toofaced"}, "edited": false, "score": 0, "creation_date": 1488387079, "post_id": 42536172, "comment_id": 72210689, "body": "When I kept <code>MaterialNumber</code> , it showed me &#39;NULL&#39; while hovering on <code>MaterialNumber</code> during debug but it gave me nothing in my pass-through parameters i.e. <code>usp_MovePending &#39;administrator&#39;,&#39;&#39;</code>"}], "tags": [], "owner": {"reputation": 632, "user_id": 6165495, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-Arf292SOBCA/AAAAAAAAAAI/AAAAAAAAADc/q0xiAMkOREE/photo.jpg?sz=128", "display_name": "Arockia Nirmal", "link": "https://stackoverflow.com/users/6165495/arockia-nirmal"}, "is_accepted": false, "score": 1, "last_activity_date": 1488383313, "creation_date": 1488383313, "answer_id": 42536172, "question_id": 42536083, "link": "https://stackoverflow.com/questions/42536083/how-to-pass-a-parameter-with-space-in-its-name-to-store-procedure-in-vba-access/42536172#42536172", "title": "How to pass a parameter with space in its name to store procedure in vba access?", "body": "<p>Try with the <strong>square bracket</strong> as delimiter ...</p>\n\n<pre><code>frm![Material ID]  \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 0, "last_activity_date": 1488385333, "last_edit_date": 1488385333, "creation_date": 1488384865, "answer_id": 42536718, "question_id": 42536083, "link": "https://stackoverflow.com/questions/42536083/how-to-pass-a-parameter-with-space-in-its-name-to-store-procedure-in-vba-access/42536718#42536718", "title": "How to pass a parameter with space in its name to store procedure in vba access?", "body": "<p>I'm not very familiar with the Access object model, but in VBA/VB6 the <em>bang notation</em> <code>foo!bar</code> is shorthand for the explicit notation:</p>\n\n<pre><code>foo(\"bar\").Value\n</code></pre>\n\n<p>In other words, <code>frm!Foobar</code> is shorthand for this:</p>\n\n<pre><code>frm(\"Foobar\").Value\n</code></pre>\n\n<p>So you would do:</p>\n\n<pre><code>frm(\"Material ID\").Value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "is_accepted": false, "score": 0, "last_activity_date": 1488386006, "creation_date": 1488386006, "answer_id": 42537102, "question_id": 42536083, "link": "https://stackoverflow.com/questions/42536083/how-to-pass-a-parameter-with-space-in-its-name-to-store-procedure-in-vba-access/42537102#42537102", "title": "How to pass a parameter with space in its name to store procedure in vba access?", "body": "<p>It's almost certainly added a underscore to it - try using the Me.Material_ID or Me.[Material ID] to refer to the actual forms control name. Value is the default property </p>\n"}], "owner": {"reputation": 131, "user_id": 4710262, "user_type": "registered", "accept_rate": 5, "profile_image": "https://www.gravatar.com/avatar/b6f459204c5faf842ef211de8384e496?s=128&d=identicon&r=PG&f=1", "display_name": "toofaced", "link": "https://stackoverflow.com/users/4710262/toofaced"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1083, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1594640324, "creation_date": 1488383041, "last_edit_date": 1594640324, "question_id": 42536083, "link": "https://stackoverflow.com/questions/42536083/how-to-pass-a-parameter-with-space-in-its-name-to-store-procedure-in-vba-access", "title": "How to pass a parameter with space in its name to store procedure in vba access?", "body": "<p>I am using vba access and SQL server. I have a form in which there is a field named <code>Material ID</code> with a space. Now, I am trying to pass this in the Store Procedure but I am not sure how do I actually pass it. Code I have been working on is:\n</p>\n\n<pre><code>If frm.Tag Then\n    strFilter = \"usp_MovePending '\" &amp; UserStr &amp; \"'\"\n    strFilter = strFilter &amp; \",\" &amp; frm!MaterialID  \n\n    DB.QueryDefs(\"qryMovePending\").Connect = SQLConnectString\n    DB.QueryDefs(\"qryMovePending\").ReturnsRecords = False\n    DB.QueryDefs(\"qryMovePending\").sql = strFilter\n    DB.QueryDefs(\"qryMovePending\").Execute dbFailOnError\nEnd If\n</code></pre>\n\n<p>In above code, I used <code>frm!MaterialID</code> without space which obviously gave me an error saying <code>Microsoft access can't find the field 'MaterialID' referred to in your expression</code>. And when I keep <code>[frm!Material ID]</code> with space, it doesn't return anything. I also tried keeping single quote around it but it returned single quote with no value. Please help.</p>\n"}, {"tags": ["vba", "excel", "email"], "answers": [{"comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1488443335, "post_id": 42536646, "comment_id": 72235686, "body": "You should use <code>Option Explicit</code> to be forced to declare all variables and avoid quite a lot of issue. Further more, here as <code>mailApp</code> and other Outlook related variables aren&#39;t declared, you may try to use Late Binding (<code>Dim ... As Object</code> and no reference to Outlook lib) and there <code>olMailItem</code> won&#39;t be recognized, so you could use <code>0</code> instead which is the value of that constant. ;)"}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1488463178, "post_id": 42536646, "comment_id": 72249176, "body": "@R3uK thanks for the feedback! I have updated my code accordingly."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1488463308, "post_id": 42536646, "comment_id": 72249264, "body": "You are welcome! ;) I&#39;m becoming paranoid about it because I sudendly had a new error with declaration of my variable from a external reference in a quite long project! I would have lost hours without <code>Option Explicit</code> to change my code!^^"}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1488463701, "post_id": 42536646, "comment_id": 72249551, "body": "Yeah, I really got to start using <code>Option Explicit</code> to improve my coding. Bad habits die hard..."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1488467074, "post_id": 42536646, "comment_id": 72252050, "body": "Just go into the tools/options of VBE and check the uncheck option (don&#39;t remember the name exactly) you&#39;ll have it in every new module! ;) (personally I also uncheck the auto check of syntax, it avoid message when you want to change line before finishing it, and still change the color of the line to red, it&#39;s less painful to work like this! ;)"}], "tags": [], "owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "is_accepted": false, "score": 1, "last_activity_date": 1488463060, "last_edit_date": 1488463060, "creation_date": 1488384657, "answer_id": 42536646, "question_id": 42535981, "link": "https://stackoverflow.com/questions/42535981/to-send-the-details-in-multiple-sheets-in-a-single-mail-using-a-macro-in-excel/42536646#42536646", "title": "To send the details in multiple sheets in a single mail using a macro in Excel", "body": "<p>You could use a function written by Ron de Bruin that allows you to convert ranges into HTML:</p>\n\n<pre><code>Sub SendRange()\nDim mailApp As Object, mail As Object  \nDim rng As Range, rng1 As Range   \n\nSet mailApp = CreateObject(\"Outlook.Application\")\nSet mail = mailApp.createitem(0)\n\nSet rng = Sheets(\"Sheet1\").Range(\"A2:V28\").SpecialCells(xlCellTypeVisible)\nSet rng1 = Sheets(\"Sheet2\").Range(\"B3:F23\").SpecialCells(xlCellTypeVisible)\n\nWith mail\n    .To = \"pkumar11@amgen.com\"\n    .Subject = \"My subject\"\n    .HTMLBody = RangetoHTML(rng) &amp; \"&lt;br&gt;\" &amp; RangetoHTML(rng1)\n    .display\nEnd With\n\nEnd Sub\n\nFunction RangetoHTML(rng As Range)\n' Changed by Ron de Bruin 28-Oct-2006\n' Working in Office 2000-2016\n    Dim fso As Object\n    Dim ts As Object\n    Dim TempFile As String\n    Dim TempWB As Workbook\n\n    TempFile = Environ$(\"temp\") &amp; \"\\\" &amp; Format(Now, \"dd-mm-yy h-mm-ss\") &amp; \".htm\"\n\n    'Copy the range and create a new workbook to past the data in\n    rng.Copy\n    Set TempWB = Workbooks.Add(1)\n    With TempWB.Sheets(1)\n        .Cells(1).PasteSpecial Paste:=8\n        .Cells(1).PasteSpecial xlPasteValues, , False, False\n        .Cells(1).PasteSpecial xlPasteFormats, , False, False\n        .Cells(1).Select\n        Application.CutCopyMode = False\n        On Error Resume Next\n        .DrawingObjects.Visible = True\n        .DrawingObjects.Delete\n        On Error GoTo 0\n    End With\n\n    'Publish the sheet to a htm file\n    With TempWB.PublishObjects.Add( _\n         SourceType:=xlSourceRange, _\n         Filename:=TempFile, _\n         Sheet:=TempWB.Sheets(1).Name, _\n         Source:=TempWB.Sheets(1).UsedRange.Address, _\n         HtmlType:=xlHtmlStatic)\n        .Publish (True)\n    End With\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7599772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5ba492ea9be5720034d98c369b9caf9?s=128&d=identicon&r=PG&f=1", "display_name": "Pradeep", "link": "https://stackoverflow.com/users/7599772/pradeep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1350, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1488463060, "creation_date": 1488382840, "last_edit_date": 1488383579, "question_id": 42535981, "link": "https://stackoverflow.com/questions/42535981/to-send-the-details-in-multiple-sheets-in-a-single-mail-using-a-macro-in-excel", "title": "To send the details in multiple sheets in a single mail using a macro in Excel", "body": "<p>Whenever I run a macro, I need to send certain Range of cells in different sheets to a Particular mail ID.</p>\n\n<pre><code>Sub Send_Range()\n\n    Sheet1.Range(\"A2:V28\").Select  \n\n   ActiveWorkbook.EnvelopeVisible = True\n\n\n   With ActiveSheet.MailEnvelope\n     ' .Introduction = \"This is a sample worksheet.\"\n      .Item.To = \"pkumar11@amgen.com\"\n      .Item.Subject = \"My subject\"\n      .Item.Send\n   End With\nEnd Sub\n</code></pre>\n\n<p>Using this code I am able to send all Values of Range (A2:V28) from Sheet 1 in a mail. But I also want to send Values of Range (B3:F28) from Sheet 2 along with the values in sheet 1 in a single mail. Please help me.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 1, "creation_date": 1488383031, "post_id": 42535874, "comment_id": 72207716, "body": "<a href=\"http://www.contextures.com/xlautofilter03.html\" rel=\"nofollow noreferrer\"><b><code>This</code></b></a> link will help you get going."}, {"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "reply_to_user": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1488383491, "post_id": 42535874, "comment_id": 72208065, "body": "@ManishChristian Thanks for the link. The biggest problem for me is not knowing how to add the address inside the range functions. I saw a couple of other stack questions about converting column number to column address and even then I don&#39;t know whether I could use the range function with the Variables rather than the direct address"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1488383528, "post_id": 42535874, "comment_id": 72208086, "body": "Refer to the range like this: <code>Range(Cells(1, colm), Cells(Rowz, colm)).AutoFilter Field:=1, Criteria1:=&quot;Mouse&quot;</code>"}, {"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1488383685, "post_id": 42535874, "comment_id": 72208202, "body": "@Rory Thanks mate ! Got it. Kindly update the answer and I will accept it"}], "answers": [{"comments": [{"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "edited": false, "score": 0, "creation_date": 1488384453, "post_id": 42536356, "comment_id": 72208766, "body": "You can also use <code>With Sheets(&quot;Some sheet&quot;) ... End With</code> to cut down the length a bit"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "edited": false, "score": 0, "creation_date": 1488384534, "post_id": 42536356, "comment_id": 72208832, "body": "Yep, or use a variable like <code>ws</code>. I didn&#39;t want to distract from the main point though. ;)"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1488383862, "creation_date": 1488383862, "answer_id": 42536356, "question_id": 42535874, "link": "https://stackoverflow.com/questions/42535874/excel-vba-using-long-variables-inside-range-function-while-filtering/42536356#42536356", "title": "Excel VBA - Using Long Variables inside Range function while filtering", "body": "<p>To use a column number, the simplest method is to use two <code>Cells</code> calls inside the <code>Range</code> call:</p>\n\n<pre><code>Range(Cells(1, colm), Cells(Rowz, colm)).AutoFilter Field:=1, Criteria1:=\"Mouse\"\n</code></pre>\n\n<p>Note also that if you need to specify a worksheet for the range, you should qualify the Range and both Cells calls with that worksheet:</p>\n\n<pre><code>Sheets(\"Some sheet\").Range(Sheets(\"Some sheet\").Cells(1, colm), Sheets(\"Some sheet\").Cells(Rowz, colm)).AutoFilter Field:=1, Criteria1:=\"Mouse\"\n</code></pre>\n"}], "owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1228, "favorite_count": 0, "accepted_answer_id": 42536356, "answer_count": 1, "score": 0, "last_activity_date": 1488383862, "creation_date": 1488382551, "question_id": 42535874, "link": "https://stackoverflow.com/questions/42535874/excel-vba-using-long-variables-inside-range-function-while-filtering", "title": "Excel VBA - Using Long Variables inside Range function while filtering", "body": "<p>I am working on something, where I need to filter based on a criteria and it changes dynamically. I was able to find the number of rows and the column name of that particular column which I need to filter. Here goes my code,</p>\n\n<pre><code>Sub trial()\n\nDim colm As Long, Rowz As Long, Coladd As String\nDim nwb As Workbook, wb As Workbook\nDim nwk As Worksheet, wk As Worksheet, wk1 As Worksheet\n\ncolm = WorksheetFunction.Match(\"HeaderString\", Sheets(\"Sheet1\").Rows(1), 0)\nColumns(colm).Select\nRowz = ActiveSheet.Cells(Rows.Count, colm).End(xlUp).Row\nSelection.AutoFilter\nActiveSheet.Range(\"$colm.Address$1:$colm.Address$Rowz\").AutoFilter Field:=1, Criteria1:=\"Mouse\"\n</code></pre>\n\n<p>Now how do I get the range to filter by knowing the number of rows in that column and knowing that column number. My Criteria is a String - \"Mouse\". I am getting error at the last line of my code. </p>\n\n<p>Kindly give me your suggestions. Thanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1488382280, "post_id": 42535737, "comment_id": 72207139, "body": "<code>&quot;=SUM(R[&quot; &amp; RowCount &amp; &quot;]C:R[-1]C)&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1488383220, "creation_date": 1488383220, "answer_id": 42536145, "question_id": 42535737, "link": "https://stackoverflow.com/questions/42535737/count-rows-in-loop-for-sum-of-column/42536145#42536145", "title": "Count rows in loop for Sum of Column", "body": "<p>First compute the RowCount. Maybe this is what you want:</p>\n\n<pre><code>RowCount = iRow - 1\n</code></pre>\n\n<p>Which means you want to sum starting from the second row. You may need to tweak it.</p>\n\n<p>Then </p>\n\n<pre><code>\"=SUM(R[-\" &amp; RowCount &amp; \"]C:R[-1]C)\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7642165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbcb5c7e785b324bf53219dcd8e9678d?s=128&d=identicon&r=PG&f=1", "display_name": "Pumbaa88", "link": "https://stackoverflow.com/users/7642165/pumbaa88"}, "is_accepted": false, "score": 0, "last_activity_date": 1488388916, "creation_date": 1488388916, "answer_id": 42538119, "question_id": 42535737, "link": "https://stackoverflow.com/questions/42535737/count-rows-in-loop-for-sum-of-column/42538119#42538119", "title": "Count rows in loop for Sum of Column", "body": "<p>I answered my own question, need quotes and &amp; around RowCount</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=SUM(R[-\" &amp; RowCount &amp; \"]C:R[-1]C)\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7642165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbcb5c7e785b324bf53219dcd8e9678d?s=128&d=identicon&r=PG&f=1", "display_name": "Pumbaa88", "link": "https://stackoverflow.com/users/7642165/pumbaa88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1488388916, "creation_date": 1488382191, "question_id": 42535737, "link": "https://stackoverflow.com/questions/42535737/count-rows-in-loop-for-sum-of-column", "title": "Count rows in loop for Sum of Column", "body": "<p>I need to search Excel for a change in text in Col G and then sum the values in the 3 Col before. So far this works except the sum is static to x rows. I need it to be dynamic on the \"RowCount\" any help would be great. I am a couple days into it.</p>\n\n<pre><code>Dim iRow As Integer, Tags As Integer\nDim oRng As Range\nDim RowCount As Integer\n\n\nSet oRng = Range(\"G2\")\n\niRow = oRng.Row\nTags = oRng.Column\n\nDo\n' \nIf Cells(iRow + 1, Tags) &lt;&gt; Cells(iRow, Tags) Then\nCells(iRow + 1, Tags).EntireRow.Insert Shift:=xlDown\nCells(iRow + 1, Tags).Interior.Color = 65535\nCells(iRow + 1, Tags - 1).Interior.Color = 65535\nCells(iRow + 1, Tags - 2).Interior.Color = 65535\nCells(iRow + 1, Tags - 3).Interior.Color = 65535\nCells(iRow + 1, Tags - 4).Interior.Color = 65535\nCells(iRow + 1, Tags - 5).Interior.Color = 65535\nCells(iRow + 1, Tags - 6).Interior.Color = 65535\nCells(iRow + 1, Tags).Value = Trim(Cells(iRow, Tags - 6) &amp; \" \" &amp; (Cells(iRow,     Tags)) &amp; \" Totals\")\nCells(iRow + 1, Tags - 6).Value = Array(\"Totals\")\nCells(iRow + 1, Tags - 1).Select\nActiveCell.FormulaR1C1 = \"=SUM(R[-40]C:R[-1]C)\"  &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; the -40 I want to  be the Integer of \u201cRowCount\u201d\nCells(iRow + 1, Tags - 2).Select\nActiveCell.FormulaR1C1 = \"=SUM(R[-40]C:R[-1]C)\"  &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; the -40 I want to be the Integer of \u201cRowCount\u201d\nCells(iRow + 1, Tags - 3).Select\nActiveCell.FormulaR1C1 = \"=SUM(R[-40]C:R[-1]C)\"  &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; the -40 I want to be the Integer of \u201cRowCount\u201d\niRow = iRow + 2\nRowCount = 0\nElse\niRow = iRow + 1\nRowCount = RowCount + 1\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 2, "creation_date": 1488381882, "post_id": 42535379, "comment_id": 72206827, "body": "Try adding <code>appExcel.EnableEvents = False</code> before your actions in Excel and <code>appExcel.EnableEvents = True</code> when you are done"}, {"owner": {"reputation": 77, "user_id": 7618866, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-fG3CeLLShW0/AAAAAAAAAAI/AAAAAAAACaU/zFOt28wVaQA/photo.jpg?sz=128", "display_name": "JasonDL", "link": "https://stackoverflow.com/users/7618866/jasondl"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1488391047, "post_id": 42535379, "comment_id": 72213152, "body": "Worked perfectly! Just out of curiosity why does it consider the importing an event? Is that something in my code or something within VBA?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1488469316, "post_id": 42535379, "comment_id": 72253714, "body": "What you are calling <i>import</i> is in facts writing data into the Excel sheet, so you probably triggered <code>Worksheet_Change</code> event and the are a lot of other events that could be triggered. I made an answer to formalise all this, please take a minute to take the <a href=\"https://stackoverflow.com/tour\">tour</a> (click it) and to accept my answer! ;)"}, {"owner": {"reputation": 77, "user_id": 7618866, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-fG3CeLLShW0/AAAAAAAAAAI/AAAAAAAACaU/zFOt28wVaQA/photo.jpg?sz=128", "display_name": "JasonDL", "link": "https://stackoverflow.com/users/7618866/jasondl"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1489083050, "post_id": 42535379, "comment_id": 72527034, "body": "Great thank you for the response"}], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 0, "last_activity_date": 1488469089, "creation_date": 1488469089, "answer_id": 42559662, "question_id": 42535379, "link": "https://stackoverflow.com/questions/42535379/export-outlook-email-data-to-macro-enabled-excel-workbook/42559662#42559662", "title": "Export Outlook email data to macro enabled Excel workbook", "body": "<p>You need to wrap your actions in Excel with :</p>\n\n<ul>\n<li><code>appExcel.EnableEvents = False</code> (before your actions in Excel) and </li>\n<li><code>appExcel.EnableEvents = True</code> when you are done in Excel</li>\n</ul>\n\n<p>Pseudo code :</p>\n\n<pre><code>''Start of your sub\n\nSet appExcel = CreateObject(\"Excel.Application\")\nappExcel.EnableEvents = False\n\n''Your actions in Excel\n\nappExcel.EnableEvents = True\n\n''End of your sub\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 7618866, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-fG3CeLLShW0/AAAAAAAAAAI/AAAAAAAACaU/zFOt28wVaQA/photo.jpg?sz=128", "display_name": "JasonDL", "link": "https://stackoverflow.com/users/7618866/jasondl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 1, "accepted_answer_id": 42559662, "answer_count": 1, "score": 1, "last_activity_date": 1610329202, "creation_date": 1488381216, "last_edit_date": 1610329202, "question_id": 42535379, "link": "https://stackoverflow.com/questions/42535379/export-outlook-email-data-to-macro-enabled-excel-workbook", "title": "Export Outlook email data to macro enabled Excel workbook", "body": "<p>I have code in Outlook to export data, from emails in a selected folder, to an Excel Workbook.</p>\n<p>In that workbook I have VBA code to parse the data (the subject line for now, eventually the body).</p>\n<p>When I export from Outlook to a &quot;.xlsx&quot; file everything looks great.<br />\nWhen I export to my &quot;.xlsm&quot; file it adds columns with information that does not align with the correct imported information.</p>\n<p>Ex: Column A &amp; B are correct, A is the CreationTime, B is the full SubjectLine</p>\n<p>Column C, D, E, etc. will be random parsed bits of subject lines.</p>\n<p>Are the macros in the Excel workbook running when the export to Excel is happening?</p>\n<p>If so, how can I prevent that?</p>\n<p>My Outlook code:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub ExportToExcel()\n    On Error GoTo ErrHandler\n    Dim appExcel As Excel.Application\n    Dim wkb As Excel.Workbook\n    Dim wks As Excel.Worksheet\n    Dim rng As Excel.Range\n    Dim strSheet As String\n    Dim strPath As String\n    Dim intRowCounter As Integer\n    Dim intColumnCounter As Integer\n    Dim msg As Outlook.MailItem\n    Dim nms As Outlook.NameSpace\n    Dim fld As Outlook.MAPIFolder\n    Dim itm As Object\n\n    'Opens the Workbook and Sheet to paste in\n    strSheet = &quot;Tester.xlsx&quot;\n    strPath = &quot;G:\\Jason\\&quot;\n    strSheet = strPath &amp; strSheet\n\n    Debug.Print strSheet\n    'Select export folder\n    Set nms = Application.GetNamespace(&quot;MAPI&quot;)\n    Set fld = nms.PickFolder\n\n    'Handle potential errors with Select Folder dialog box.\n     \n    If fld Is Nothing Then\n        MsgBox &quot;There are no mail messages to export&quot;, vbOKOnly, &quot;Error&quot;\n        Exit Sub\n\n    ElseIf fld.DefaultItemType &lt;&gt; olMailItem Then\n        MsgBox &quot;There are no mail messages to export&quot;, vbOKOnly, &quot;Error&quot;\n        Exit Sub\n\n    ElseIf fld.Items.Count = 0 Then\n        MsgBox &quot;There are no mail messages to export&quot;, vbOKOnly, &quot;Error&quot;\n        Exit Sub\n    End If\n\n    'Open and activate Excel workbook.\n\n    Set appExcel = CreateObject(&quot;Excel.Application&quot;)\n    appExcel.Workbooks.Open (strSheet)\n    Set wkb = appExcel.ActiveWorkbook\n    Set wks = wkb.Sheets(1)\n    wks.Activate\n    appExcel.Application.Visible = True\n\n    'Copy field items in mail folder.\n\n    For Each itm In fld.Items\n        intColumnCounter = 1\n\n        Set msg = itm\n        intRowCounter = intRowCounter + 1\n\n        Set rng = wks.Cells(intRowCounter, intColumnCounter)\n        rng.Value = msg.CreationTime\n\n        intColumnCounter = intColumnCounter + 1\n\n        Set rng = wks.Cells(intRowCounter, intColumnCounter)\n        rng.Value = msg.Subject\n\n    Next itm\n\n    Set appExcel = Nothing\n    Set wkb = Nothing\n    Set wks = Nothing\n    Set rng = Nothing\n    Set msg = Nothing\n    Set nms = Nothing\n    Set fld = Nothing\n    Set itm = Nothing\n    Exit Sub\n\nErrHandler:  \n    If Err.Number &lt;&gt; 0 Then\n        MsgBox strSheet &amp; &quot; doesn't exist&quot;, vbOKOnly, &quot;Error&quot;\n    End If\n\n    Set appExcel = Nothing\n    Set wkb = Nothing\n    Set wks = Nothing\n    Set rng = Nothing\n    Set msg = Nothing\n    Set nms = Nothing\n    Set fld = Nothing\n    Set itm = Nothing\nEnd Sub\n</code></pre>\n<p>Parsing code in Excel:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub SplitSubjectLine()\n\n    Dim text As String\n    Dim i As Integer\n    Dim y As Integer\n    Dim LastRow As Long\n    Dim name As Variant\n\n    ReDim name(3)\n\n    LastRow = Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row\n\n    For y = 1 To LastRow\n        Cells(y, 2).Select\n        text = ActiveCell.Value\n        name = Split(text, &quot;,&quot;)\n    \n        For i = 0 To UBound(name)\n            Cells(y, i + 2).Value = name(i)\n        Next i\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1488381212, "post_id": 42535320, "comment_id": 72206268, "body": "Try <code>pos &gt; 0</code> instead of <code>pos &gt; 1</code>"}], "answers": [{"comments": [{"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1488382167, "post_id": 42535522, "comment_id": 72207048, "body": "That&#39;s it!  Thanks so much!!"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 2, "last_activity_date": 1488381571, "creation_date": 1488381571, "answer_id": 42535522, "question_id": 42535320, "link": "https://stackoverflow.com/questions/42535320/how-to-loop-through-cells-and-loop-through-an-array-then-hide-rows-based-on-mat/42535522#42535522", "title": "How to loop through cells and loop through an array, then hide rows based on matches?", "body": "<p>This should work:</p>\n\n<pre><code>Option Explicit\n\nSub Hide_Rows()\n\n    Dim cell            As Range\n    Dim Mainfram(13)    As String\n    Dim lRow            As Long\n    Dim i               As Long\n    Dim pos             As Long\n\n    Mainfram(0) = \"Day 2\"\n    Mainfram(1) = \"Day 3\"\n    Mainfram(2) = \"Day 4\"\n    Mainfram(3) = \"Day 5\"\n    Mainfram(4) = \"Day 6\"\n    Mainfram(5) = \"Day 7\"\n    Mainfram(6) = \"Day 8\"\n    Mainfram(7) = \"Day 9\"\n    Mainfram(8) = \"Day 10\"\n    Mainfram(9) = \"Day 11\"\n    Mainfram(10) = \"Day 12\"\n    Mainfram(11) = \"Day 13\"\n    Mainfram(12) = \"Day 14\"\n    Mainfram(13) = \"Day 15\"\n\n    'you are with C\n    lRow = Cells(Rows.Count, 3).End(xlUp).Row\n\n    For i = LBound(Mainfram) To UBound(Mainfram)\n        For Each cell In Range(\"C1:C\" &amp; lRow)\n            pos = InStr(1, cell.Value, Mainfram(i))\n            Debug.Print pos\n\n            If pos &gt;= 1 Then\n                cell.EntireRow.Hidden = True\n            End If\n\n        Next\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>A few mistakes in your code:</p>\n\n<ul>\n<li><code>If pos &gt;= 1 Then</code> is what you need. </li>\n<li>If you go to i = 15 and you only\nhave declared up to Mainfram(13) you get a nasty error for going\noutside of array's boundaries.  </li>\n<li>Furthermore, <code>LBound</code> and <code>Ubound</code> is\na good way to loop around an array.  </li>\n<li>Last but not least, you need to find probably the last value in C, not in A.</li>\n</ul>\n\n<p>Cheers!</p>\n"}], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 42535522, "answer_count": 1, "score": 1, "last_activity_date": 1521478091, "creation_date": 1488381050, "last_edit_date": 1521478091, "question_id": 42535320, "link": "https://stackoverflow.com/questions/42535320/how-to-loop-through-cells-and-loop-through-an-array-then-hide-rows-based-on-mat", "title": "How to loop through cells and loop through an array, then hide rows based on matches?", "body": "<p>I am trying to look at all used cells in ColumnC.  If a specific cell in ColumnC contains a string, like 'Row 2' to 'Row 15', then hide the row.  Here is the code that I cam up with, but it doesn't do what I expected it to do.</p>\n\n<pre><code>Sub Hide_Rows()\nDim cell As Range\nDim Mainfram(13) As String\n\n    Mainfram(0) = \"Day 2\"\n    Mainfram(1) = \"Day 3\"\n    Mainfram(2) = \"Day 4\"\n    Mainfram(3) = \"Day 5\"\n    Mainfram(4) = \"Day 6\"\n    Mainfram(5) = \"Day 7\"\n    Mainfram(6) = \"Day 8\"\n    Mainfram(7) = \"Day 9\"\n    Mainfram(8) = \"Day 10\"\n    Mainfram(9) = \"Day 11\"\n    Mainfram(10) = \"Day 12\"\n    Mainfram(11) = \"Day 13\"\n    Mainfram(12) = \"Day 14\"\n    Mainfram(13) = \"Day 15\"\n\n    lrow = Cells(Rows.Count, 1).End(xlUp).Row\n\n    For i = 2 To 15\n    For Each cell In Range(\"C1:C\" &amp; lrow)\n        pos = InStr(1, cell.Value, Mainfram(i))\n        If pos &gt; 1 Then\n            cell.EntireRow.Hidden = True\n        End If\n    Next\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1488380548, "post_id": 42535048, "comment_id": 72205742, "body": "Fuzzy lookup addin might help. Unfortunately if there&#39;s no rhyme or reason to the &quot;subtle changes&quot; then it&#39;s difficult to strip them out"}, {"owner": {"reputation": 1, "user_id": 7641971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995ef92c436b791e7b8bb32285d35035?s=128&d=identicon&r=PG&f=1", "display_name": "Winston Childs", "link": "https://stackoverflow.com/users/7641971/winston-childs"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1488471580, "post_id": 42535048, "comment_id": 72255301, "body": "I agree, I can strip out the bad data, but I am looking to reduce the number of typing errors by pasting values only."}], "owner": {"reputation": 1, "user_id": 7641971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995ef92c436b791e7b8bb32285d35035?s=128&d=identicon&r=PG&f=1", "display_name": "Winston Childs", "link": "https://stackoverflow.com/users/7641971/winston-childs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 9, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1488380365, "creation_date": 1488380365, "last_edit_date": 1531164843, "question_id": 42535048, "link": "https://stackoverflow.com/questions/42535048/excel-column-that-only-allows-pasted-values-so-that-users-can-not-retype-key", "title": "Excel- column that only allows pasted values so that users can not retype &quot;Key&quot; that is used across 3 or more spreadsheets", "body": "<p>1st time using this forum.  I appreciate any advice I receive.  My issue is that my company has 3 spread sheets used across 3 cities that have slightly different data.  i need to perform vlookups, but the users type the address field themselves and make subtle changes similar to 83ave vs 83 ave. or 83av.  I am hoping there is a way to format a column so that the data can only be pasted in.  That way all the sheets can talk to each other as the address information will come from one source.  Thank you in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1488380485, "post_id": 42534831, "comment_id": 72205700, "body": "You need to provide some sample data."}, {"owner": {"reputation": 11, "user_id": 7641426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32b61e002604858cdd485f0ff4a1a9ba?s=128&d=identicon&r=PG&f=1", "display_name": "Tif", "link": "https://stackoverflow.com/users/7641426/tif"}, "reply_to_user": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1488381291, "post_id": 42534831, "comment_id": 72206343, "body": "<a href=\"http://www.cjoint.com/c/GCbpoFz64P2\" rel=\"nofollow noreferrer\">cjoint.com/c/GCbpoFz64P2</a>"}, {"owner": {"reputation": 11, "user_id": 7641426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32b61e002604858cdd485f0ff4a1a9ba?s=128&d=identicon&r=PG&f=1", "display_name": "Tif", "link": "https://stackoverflow.com/users/7641426/tif"}, "reply_to_user": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1488381307, "post_id": 42534831, "comment_id": 72206361, "body": "I hope it will be enough. Thanks for your reply!"}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1488381533, "post_id": 42534831, "comment_id": 72206554, "body": "Update your question with sample data."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1488385155, "post_id": 42534831, "comment_id": 72209267, "body": "Dates are finicky.  When comparing or looking for dates you have to make sure they are the exact same type of variable.  for instance, DateValue(stringVariable) is telling Excel to create a date variable from what ever is in the stringVariable.  If stringVariable = &quot;03/31/2017&quot; then you have no problems.  But if stringVariable = &quot;Mrs. Beasley&quot; then it will return a blank.  Which I suspect is the reason your previous cell is being &quot;ERASED&quot;.  It&#39;s not being erased though, it&#39;s being replaced with a blank.  Go here to learn about date variables. <a href=\"http://www.cpearson.com/excel/datetime.htm\" rel=\"nofollow noreferrer\">cpearson.com/excel/datetime.htm</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7641426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32b61e002604858cdd485f0ff4a1a9ba?s=128&d=identicon&r=PG&f=1", "display_name": "Tif", "link": "https://stackoverflow.com/users/7641426/tif"}, "edited": false, "score": 0, "creation_date": 1488803307, "post_id": 42550397, "comment_id": 72379099, "body": "Hello Alex P, I just saw your reply. Thank you very much, it&#39;s exactly what I need !"}, {"owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "reply_to_user": {"reputation": 11, "user_id": 7641426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32b61e002604858cdd485f0ff4a1a9ba?s=128&d=identicon&r=PG&f=1", "display_name": "Tif", "link": "https://stackoverflow.com/users/7641426/tif"}, "edited": false, "score": 0, "creation_date": 1488805487, "post_id": 42550397, "comment_id": 72380445, "body": "Great! As I said in my answer, you will need to tweak the code to fit your specific set-up."}, {"owner": {"reputation": 11, "user_id": 7641426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32b61e002604858cdd485f0ff4a1a9ba?s=128&d=identicon&r=PG&f=1", "display_name": "Tif", "link": "https://stackoverflow.com/users/7641426/tif"}, "edited": false, "score": 0, "creation_date": 1489142431, "post_id": 42550397, "comment_id": 72552786, "body": "Alex P thanks again for your help. I managed to tweak the code so it fits my needs. But now, I realised that I also need to use the dates earlier to today. Meaning, if I only have dates in 2016, I want the closest to today. So it&#39;s basically the same thing but with dates earlier than today. I&#39;m stuck though... Could you help me with this too please..?"}, {"owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "reply_to_user": {"reputation": 11, "user_id": 7641426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32b61e002604858cdd485f0ff4a1a9ba?s=128&d=identicon&r=PG&f=1", "display_name": "Tif", "link": "https://stackoverflow.com/users/7641426/tif"}, "edited": false, "score": 0, "creation_date": 1489143137, "post_id": 42550397, "comment_id": 72553175, "body": "I think you can just remove the <b>if cl &gt; today...</b> statement"}], "tags": [], "owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1488443669, "creation_date": 1488443669, "answer_id": 42550397, "question_id": 42534831, "link": "https://stackoverflow.com/questions/42534831/how-to-compare-several-dates-in-one-column-with-several-loops/42550397#42550397", "title": "How to compare several dates in one column with several loops?", "body": "<p>This might help get you started.</p>\n\n<pre><code>Sub test()\n    Dim person As String\n\n    person = Worksheets(\"Resources\").Range(\"A2\")\n    Debug.Print GetClosestDate(person)\nEnd Sub\n\nFunction GetClosestDate(person As String)\n    Dim cl As Range, today As Date, closestDate As Date\n\n    today = VBA.Now\n\n    For Each cl In Worksheets(\"Demand\").Range(\"G1:G8\")\n        If cl.Offset(0, 7) = person Then           // this picks up name column N\n\n            If cl &gt;= today Then\n                If closestDate = \"00:00:00\" Then   //Default value for uninitialised date object\n                    closestDate = cl.Value\n                Else\n                    If CInt(cl - today) &lt; CInt(closestDate - today) Then\n                        closestDate = cl.Value\n                    End If\n                End If\n            End If\n        End If\n    Next cl\n\n    GetClosestDate = closestDate\n\nEnd Function\n</code></pre>\n\n<ul>\n<li>I use a function <code>GetClosestDate</code> to find the closest date for a person</li>\n<li>It assumes any date earlier than today can be ignored</li>\n<li>It loops over dates and compares whether it is closer to today than the stored date</li>\n</ul>\n\n<p>You will need to modify the code to handle looping over names in <code>Resources</code> etc. but I think - at least in principle - this code is what you need.</p>\n"}], "owner": {"reputation": 11, "user_id": 7641426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32b61e002604858cdd485f0ff4a1a9ba?s=128&d=identicon&r=PG&f=1", "display_name": "Tif", "link": "https://stackoverflow.com/users/7641426/tif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1488443669, "creation_date": 1488379808, "last_edit_date": 1531164843, "question_id": 42534831, "link": "https://stackoverflow.com/questions/42534831/how-to-compare-several-dates-in-one-column-with-several-loops", "title": "How to compare several dates in one column with several loops?", "body": "<p>I am so desperate that I hope you can help me. </p>\n\n<p>I have this problem : For each name I have in the \"Resources\" sheet, I need to see a \"Start Date\". The \"Start Date\" comes from the \"Demand\" sheet. It's the closest date to today's date from the column G.</p>\n\n<p>Meaning : For Mr. X, I have 10 different dates. Today's 01/03/2017. So all the dates before this one are out of scope. It remains 5 dates (from March to December 2017). I want to see the closest date to today meaning 31/03/2017.</p>\n\n<p>But, for each name, I don't obviously have the same amount of dates (from 1 to 10 dates per name, more or less). That's why I created loops so I can go through my whole list of dates.</p>\n\n<p>My problem is that if I try to set up a variable for this specific date I want to see, my loops will just erase the value previously saved. I don't know how to do... To begin with my cell is blank so even if I put today's date to compare and code out of the loop it still won't work...</p>\n\n<p>Sample : <a href=\"http://www.cjoint.com/c/GCbpoFz64P2\" rel=\"nofollow noreferrer\">http://www.cjoint.com/c/GCbpoFz64P2</a></p>\n\n<pre><code>Sub ICStart()\n\n    Sheets(\"Resources\").Select\n    Nb_tot1 = 5\n    While Cells(Nb_tot1, 1).Value &lt;&gt; \"\"\n        Nb_tot1 = Nb_tot1 + 1\n    Wend\n    Nb_tot1 = Nb_tot1 - 5\n    MsgBox \"Total Lines is : \" &amp; Nb_tot1 &amp; \".\"\n\n    Sheets(\"Demande\").Select\n\n    Nb_tot2 = 3\n    While Cells(Nb_tot2, 14).Value &lt;&gt; \"\"\n        Nb_tot2 = Nb_tot2 + 1\n    Wend\n    Nb_tot2 = Nb_tot2 - 3\n    MsgBox \"Total Lines is : \" &amp; Nb_tot2 &amp; \".\"\n\n    For i = 5 To Nb_tot1 + 5 - 1\n        Sheets(\"Resources\").Select\n        Name = Cells(i, 1)\n        Sheets(\"Demande\").Select\n        End_date_temp = Worksheets(\"Demande\").Cells(3, 7)\n        For j = 3 To Nb_tot2\n            Sheets(\"Demande\").Select\n            Worksheets(\"Resources\").Cells(i, 8) = End_date_temp\n            Commit = Cells(j, 12)\n            An = Year(Cells(j, 7))\n            End_date = Cells(j, 7)\n            If Cells(j, 14) = Name And Commit = \"Y\" And An &lt;&gt; \"2100\" And An &gt;= Year(Now) And End_date &gt;= Date Then\n                End_date_temp = End_date\n            End If\n        Next\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>The main issue is that I can't find how to write that line :</p>\n\n<pre><code>End_date_temp = Worksheets(\"Demande - Projets\").Cells(3, 7)\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 2, "creation_date": 1488380020, "post_id": 42534508, "comment_id": 72205346, "body": "<a href=\"http://www.ozgrid.com/VBA/excel-add-in-create.htm\" rel=\"nofollow noreferrer\">create an add-in</a>"}], "answers": [{"comments": [{"owner": {"reputation": 33321, "user_id": 1915046, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/df457b95f1a2c534b83527af54b0475b?s=128&d=identicon&r=PG", "display_name": "Jaylen", "link": "https://stackoverflow.com/users/1915046/jaylen"}, "edited": false, "score": 0, "creation_date": 1488379395, "post_id": 42534606, "comment_id": 72204843, "body": "so put the code in a a text file and then change the extension? Where would I store this file at?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 33321, "user_id": 1915046, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/df457b95f1a2c534b83527af54b0475b?s=128&d=identicon&r=PG", "display_name": "Jaylen", "link": "https://stackoverflow.com/users/1915046/jaylen"}, "edited": false, "score": 0, "creation_date": 1488379533, "post_id": 42534606, "comment_id": 72204956, "body": "@Jaylen no, you save your macro-enabled workbook as an <i>Excel Add-In</i> file, and have Excel load that add-in at startup. If you do it right then Excel deals with the &quot;where do I save that&quot; part."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 33321, "user_id": 1915046, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/df457b95f1a2c534b83527af54b0475b?s=128&d=identicon&r=PG", "display_name": "Jaylen", "link": "https://stackoverflow.com/users/1915046/jaylen"}, "edited": false, "score": 1, "creation_date": 1488379597, "post_id": 42534606, "comment_id": 72205001, "body": "@Jaylen here is another source.  Scroll down a bit and it will give you step by step instructions with pictures. <a href=\"https://support.office.com/en-us/article/Create-Custom-Functions-in-Excel-2007-2f06c10b-3622-40d6-a1b2-b6748ae8231f\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}], "tags": [], "owner": {"reputation": 4316, "user_id": 6005451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b5d2854ebcf1678d4fab4f7bedd6b9f?s=128&d=identicon&r=PG&f=1", "display_name": "EoinS", "link": "https://stackoverflow.com/users/6005451/eoins"}, "is_accepted": false, "score": 2, "last_activity_date": 1488383383, "last_edit_date": 1488383383, "creation_date": 1488379262, "answer_id": 42534606, "question_id": 42534508, "link": "https://stackoverflow.com/questions/42534508/how-to-permanently-store-custom-function-in-excel/42534606#42534606", "title": "How to permanently store custom function in Excel?", "body": "<p>After you write your function in an Excel file, save the file as an .xlam file.  This is an Excel addin file.</p>\n\n<p>Then you need to go to options and addins and load your file. </p>\n\n<p>Now going forward this 'file' will always be open.</p>\n\n<p>You can hit alt-f11 to access it anytime.</p>\n\n<p><a href=\"http://www.ozgrid.com/VBA/excel-add-in-create.htm\" rel=\"nofollow noreferrer\">link with details</a> from the famous ozgrid</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5498776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48588733e82ad9fc9eb77558d23c9219?s=128&d=identicon&r=PG&f=1", "display_name": "Vova", "link": "https://stackoverflow.com/users/5498776/vova"}, "is_accepted": false, "score": 0, "last_activity_date": 1522844357, "creation_date": 1522844357, "answer_id": 49650865, "question_id": 42534508, "link": "https://stackoverflow.com/questions/42534508/how-to-permanently-store-custom-function-in-excel/49650865#49650865", "title": "How to permanently store custom function in Excel?", "body": "<p>I have used this trick to use custom function (mfdate) in workbook added from VBA:</p>\n\n<pre><code>Workbooks.Add\nsheetArr = Range(\"AM2:AM10\").Value\nFor i = 1 To UBound(sheetArr, 1)\n    For j = 1 To UBound(sheetArr, 2)\n        If Len(CStr(sheetArr(i, j))) Then sheetArr(i, j) = MfDate(CStr(sheetArr(i, j)))\n    Next j\nNext i\nRange(\"AM2:AM10\").Value = sheetArr\n</code></pre>\n"}], "owner": {"reputation": 33321, "user_id": 1915046, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/df457b95f1a2c534b83527af54b0475b?s=128&d=identicon&r=PG", "display_name": "Jaylen", "link": "https://stackoverflow.com/users/1915046/jaylen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3586, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1522844357, "creation_date": 1488379020, "question_id": 42534508, "link": "https://stackoverflow.com/questions/42534508/how-to-permanently-store-custom-function-in-excel", "title": "How to permanently store custom function in Excel?", "body": "<p>I have a custom VBA function in Excel called <code>Combine</code>. It simply combine multiple cells in a comma separated sting. </p>\n\n<p>I am able to add the new function by doing the following</p>\n\n<ol>\n<li>I clicked ALT + F11</li>\n<li>Then I clicked on \"Insert\" then \"Module\"</li>\n<li>I inserted the following VBA code into it</li>\n</ol>\n\n<p>.</p>\n\n<pre><code>Function Combine(WorkRng As Range, Optional Sign As String = \",\") As String\nDim Rng As Range\nDim OutStr As String\nFor Each Rng In WorkRng\n    If Rng.Text &lt;&gt; Sign Then\n        OutStr = OutStr &amp; \"'\" &amp; Rng.Text &amp; \"'\" &amp; Sign\n    End If\nNext\nCombine = Left(OutStr, Len(OutStr) - 1)\nEnd Function\n</code></pre>\n\n<p>Then I can easily execute this function like so <code>Combine(A1:A25)</code> to combine all cells A1 to A25 by wrapping them with a single quota and separating the values by a comma.</p>\n\n<p>Then problem is that when I close down excel and open up a new worksheet the function goes away and I can't reuse it.</p>\n\n<p>How can I permanently save this function so I am able to reuse it when new sheet is created?</p>\n"}, {"tags": ["vba", "excel", "border"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7435713, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/233b1182ebcce6b975c7d24bd1f02cbb?s=128&d=identicon&r=PG&f=1", "display_name": "mfo_28", "link": "https://stackoverflow.com/users/7435713/mfo-28"}, "edited": false, "score": 0, "creation_date": 1488383957, "post_id": 42534222, "comment_id": 72208430, "body": "Thank you for the idea. It is not the solution but the idea is correct. It works fine. Thank you"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 0, "last_activity_date": 1488378220, "creation_date": 1488378220, "answer_id": 42534222, "question_id": 42533988, "link": "https://stackoverflow.com/questions/42533988/how-to-move-the-border-when-sorting-in-excel-vba/42534222#42534222", "title": "How to move the border when sorting in excel vba?", "body": "<p>Here is something like an idea. It is not the whole solution, but you can start from it and build your own, by removing the magic numbers etc...</p>\n\n<pre><code>Option Explicit\n\nPublic Sub SortingBorders()\n\n    Dim rngMyRng    As Range\n    Dim rngCell     As Range\n\n    Set rngMyRng = Range(\"A1:A20\")\n    Call RemoveAllBorders(rngMyRng)\n\n    For Each rngCell In rngMyRng\n        If rngCell &lt;&gt; rngCell.Offset(1, 0) Then\n            Range(rngCell.Offset(1, 0), rngCell.Offset(1, 5)).Borders(xlEdgeTop).LineStyle = xlContinuous\n        End If\n    Next rngCell\n\nEnd Sub\n\nPublic Sub RemoveAllBorders(rngMyRng As Range)\n\n    With rngMyRng\n        .Borders(xlDiagonalDown).LineStyle = xlNone\n        .Borders(xlDiagonalUp).LineStyle = xlNone\n        .Borders(xlEdgeLeft).LineStyle = xlNone\n        .Borders(xlEdgeTop).LineStyle = xlNone\n        .Borders(xlEdgeBottom).LineStyle = xlNone\n        .Borders(xlEdgeRight).LineStyle = xlNone\n        .Borders(xlInsideVertical).LineStyle = xlNone\n        .Borders(xlInsideHorizontal).LineStyle = xlNone\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>This is what you get:\n<a href=\"https://i.stack.imgur.com/abPSn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/abPSn.png\" alt=\"enter image description here\"></a></p>\n\n<p>The solution goes around column 1 and puts a border only when the condition <code>rngCell &lt;&gt; rngCell.Offset(1, 0)</code> is true.</p>\n"}], "owner": {"reputation": 23, "user_id": 7435713, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/233b1182ebcce6b975c7d24bd1f02cbb?s=128&d=identicon&r=PG&f=1", "display_name": "mfo_28", "link": "https://stackoverflow.com/users/7435713/mfo-28"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "closed_date": 1488713637, "accepted_answer_id": 42534222, "answer_count": 1, "score": -1, "last_activity_date": 1488385444, "creation_date": 1488377530, "last_edit_date": 1488385444, "question_id": 42533988, "link": "https://stackoverflow.com/questions/42533988/how-to-move-the-border-when-sorting-in-excel-vba", "closed_reason": "Needs more focus", "title": "How to move the border when sorting in excel vba?", "body": "<p>I am going to sort the data base on the first column, however the border line did not move base on the sorted data. </p>\n\n<p>Is it possible to move it using vba code?</p>\n\n<p><a href=\"https://i.stack.imgur.com/9OfIP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9OfIP.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 0, "creation_date": 1488377464, "post_id": 42533880, "comment_id": 72203491, "body": "Thanks @R3uK. I am not sure its the typo that I had in the code because I looked in the code it wasn&#39;t a typo but when I added this Option Explicit, it just started working. Is there any reason behind this Option Explicit? Thanks again buddy !!"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 1, "creation_date": 1488377975, "post_id": 42533880, "comment_id": 72203867, "body": "@VBA_Begineer : <code>Option Explicit</code> is just a best practice (you can set VBE to use it by default, check in the options) to avoid that kind of error, it&#39;ll force you to declare all the variable there is in your code, and so it&#39;ll warn you when you have a typo! ;) Please accept the answer as this solved your issue."}, {"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 0, "creation_date": 1488378512, "post_id": 42533880, "comment_id": 72204236, "body": "@R3_uK Thanks mate. I was made to wait for 10 minutes by Stack Overflow to accept your answer. Sorry for that. Thanks again !!"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 0, "creation_date": 1488378825, "post_id": 42533880, "comment_id": 72204436, "body": "@VBA_Begineer : Ahaha NP, I forgot about that limitation! ;)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1488377202, "creation_date": 1488377202, "answer_id": 42533880, "question_id": 42533848, "link": "https://stackoverflow.com/questions/42533848/excel-vba-selecting-columns-dynamically-using-column-headers/42533880#42533880", "title": "Excel VBA - Selecting Columns dynamically using Column headers", "body": "<p>You have a typo in there! You have <code>co1m</code> and <code>colm</code>.</p>\n\n<p>Using <code>Option Explicit</code> would have throw a compile error saying that <code>co1m</code> wasn't declared! ;)</p>\n\n<pre><code>Option Explicit\n\nSub trial()\n\nDim colm As Long\nDim nwb As Workbook, wb As Workbook\nDim nwk As Worksheet, wk As Worksheet, wk1 As Worksheet\n\ncolm = WorksheetFunction.Match(\"Header\", Sheets(\"Sheet1\").Rows(1), 0)\n\nColumns(colm).Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 735, "favorite_count": 0, "accepted_answer_id": 42533880, "answer_count": 1, "score": 1, "last_activity_date": 1488377202, "creation_date": 1488377135, "question_id": 42533848, "link": "https://stackoverflow.com/questions/42533848/excel-vba-selecting-columns-dynamically-using-column-headers", "title": "Excel VBA - Selecting Columns dynamically using Column headers", "body": "<p>I am trying to select a column dynamically based on the Column headers in VBA. This is the code that I am using ,</p>\n\n<pre><code>Sub trial()\n\nDim colm As Long\nDim nwb As Workbook, wb As Workbook\nDim nwk As Worksheet, wk As Worksheet, wk1 As Worksheet\n\nco1m = WorksheetFunction.Match(\"Header\", Sheets(\"Sheet1\").Rows(1), 0)\n\nColumns(colm).Select\n\nEnd Sub\n</code></pre>\n\n<p>when I try to debug it, it shows the value of 5 in colm and at the same time on the next line columns(colm).select, it shows 0 in the place of colm. Kindly help me with where I am going wrong in this. Thanks in advance</p>\n"}, {"tags": [".net", "vba", "sha256"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1488380006, "post_id": 42533731, "comment_id": 72205335, "body": "Shot in the dark, but did you try adding the mscorlib from <code>C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319</code>?"}, {"owner": {"reputation": 83, "user_id": 7384229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/ecf4fb396da45d5c4d7fd4f7343d100c?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Brown", "link": "https://stackoverflow.com/users/7384229/adrian-brown"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1490172647, "post_id": 42533731, "comment_id": 72989040, "body": "That didn&#39;t work I&#39;m afraid. It may be because its in a corporate environment so I am a little locked down as to what access I have. I have managed to sort the issue by circumventing the mscorlib all together."}], "answers": [{"tags": [], "owner": {"reputation": 83, "user_id": 7384229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/ecf4fb396da45d5c4d7fd4f7343d100c?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Brown", "link": "https://stackoverflow.com/users/7384229/adrian-brown"}, "is_accepted": false, "score": 0, "last_activity_date": 1490173277, "creation_date": 1490173277, "answer_id": 42946881, "question_id": 42533731, "link": "https://stackoverflow.com/questions/42533731/system-security-cryptography-sha256managed-in-net-4-5-windows-10/42946881#42946881", "title": "system.security.cryptography.SHA256Managed in .NET 4.5 (Windows 10)", "body": "<p>I have been unable to get mscorlib to work. But I found a module which circumvents it all together. It may be of use to others who have limited/no access to the full .NET framework. </p>\n\n<p><a href=\"http://khoiriyyah.blogspot.com/2012/06/vb6-hash-class-md5-sha-1-sha-256-sha.html\" rel=\"nofollow noreferrer\">http://khoiriyyah.blogspot.com/2012/06/vb6-hash-class-md5-sha-1-sha-256-sha.html</a></p>\n"}], "owner": {"reputation": 83, "user_id": 7384229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/ecf4fb396da45d5c4d7fd4f7343d100c?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Brown", "link": "https://stackoverflow.com/users/7384229/adrian-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1524, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1490173277, "creation_date": 1488376828, "last_edit_date": 1488377058, "question_id": 42533731, "link": "https://stackoverflow.com/questions/42533731/system-security-cryptography-sha256managed-in-net-4-5-windows-10", "title": "system.security.cryptography.SHA256Managed in .NET 4.5 (Windows 10)", "body": "<p>I am using the following VBA function to get the SHA256 value for a file;</p>\n\n<pre><code>Public Function FileToSHA256(sfilename As String) As String\n    Dim enc\n    Dim bytes\n    Dim outstr As String\n    Dim pos As Integer\n    Set enc = CreateObject(\"System.Security.Cryptography.SHA256Managed\")\n    'Convert the string to a byte array and hash it\n    bytes = GetFileBytes(sfilename)\n    bytes = enc.ComputeHash_2((bytes))\n    'Convert the byte array to a hex string\n    For pos = 1 To LenB(bytes)\n        outstr = outstr &amp; LCase(Right(\"0\" &amp; Hex(AscB(MidB(bytes, pos, 1))), 2))\n    Next\n    FileToSHA256 = outstr 'Returns a 40 byte/character hex string\n    Set enc = Nothing\nEnd Function\n\nPrivate Function GetFileBytes(ByVal path As String) As Byte()\n    Dim lngFileNum As Long\n    Dim bytRtnVal() As Byte\n    lngFileNum = FreeFile\n    If LenB(Dir(path)) Then ''// Does file exist?\n        Open path For Binary Access Read As lngFileNum\n        ReDim bytRtnVal(LOF(lngFileNum) - 1&amp;) As Byte\n        Get lngFileNum, , bytRtnVal\n        Close lngFileNum\n    Else\n        Err.Raise 53\n    End If\n    GetFileBytes = bytRtnVal\n    Erase bytRtnVal\nEnd Function\n</code></pre>\n\n<p>This works perfectly under a Windows 7 environment on Word 2013. I do not know the .NET version this runs on (presuming 3.5).</p>\n\n<p>It has now been launched onto a Windows 10 Environment (still Word 2013). I have been told by our IT dept that this is on .NET 4.5, but according to VBA its running from .NET frameworks 4.0.30319.</p>\n\n<p>It now throws error  - </p>\n\n<blockquote>\n  <p>Run-Time Error '-2146232576 (80131700)' Automation Error</p>\n</blockquote>\n\n<p>on this line;</p>\n\n<pre><code>Set enc = CreateObject(\"System.Security.Cryptography.SHA256Managed\")\n</code></pre>\n\n<p>I have MSCORLIB.DLL referenced in the project.</p>\n\n<p>I can't figure out if I need to add additional references or change the code.</p>\n\n<p>If a code change is necessary, it would need to cover the earlier version of .NET also, something with a case check to cover different versions, but I am not sure how to do this.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 138, "user_id": 5149262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3d53f206002493f2d9587a117d14fda?s=128&d=identicon&r=PG", "display_name": "Diego Ribba", "link": "https://stackoverflow.com/users/5149262/diego-ribba"}, "is_accepted": false, "score": 2, "last_activity_date": 1488376175, "creation_date": 1488376175, "answer_id": 42533506, "question_id": 42533405, "link": "https://stackoverflow.com/questions/42533405/excel-vba-if-value-not-found-in-range-go-to/42533506#42533506", "title": "Excel VBA: If value not found in range, go to", "body": "<p>you should add a marker before <code>Next I</code></p>\n\n<pre><code>MARKER:\nNext I\n</code></pre>\n\n<p>So after <code>If rngFound Is Nothing Then</code> you add <code>GoTo MARKER</code></p>\n"}, {"comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1488376688, "post_id": 42533511, "comment_id": 72202944, "body": "Hi Vityata, I agree that in general the use of <code>Goto</code> statements is not a good programming practice, but not in this specific case. Other languages usually have statement to break or continue the loops (i.e. <code>continue</code> in the C family). VBA not having this option is sometimes  tedious and using this workaround might make the code more readabale. Just my humble opinion :)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1488376836, "post_id": 42533511, "comment_id": 72203054, "body": "@A.S.H, I use <code>GoTo</code> more often than I would ever agree. And yes, VBA needs a way to break loops."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 5, "last_activity_date": 1488376178, "last_edit_date": 1492087236, "creation_date": 1488376178, "answer_id": 42533511, "question_id": 42533405, "link": "https://stackoverflow.com/questions/42533405/excel-vba-if-value-not-found-in-range-go-to/42533511#42533511", "title": "Excel VBA: If value not found in range, go to", "body": "<p>You can do it like this:</p>\n\n<pre><code>For I = 1 To WS_Count\n    If rngFound Is Nothing Then goto NextIPlace\n    your code\nNextIPlace:\nNext I\n</code></pre>\n\n<p>But you should reconsider writing like this, it is not a good VBA practice to use <code>GoTo</code>. The whole code should be changed. <a href=\"https://www.google.com/search?q=goto%20bad%20practice&amp;oq=goto%20bad%20&amp;aqs=chrome.0.0j69i57j0l4.1791j0j4&amp;sourceid=chrome&amp;ie=UTF-8\" rel=\"nofollow noreferrer\">Check more here</a>. Once your code works, feel free to submit it at <a href=\"https://codereview.stackexchange.com/\">https://codereview.stackexchange.com/</a>, they would give you good ideas.</p>\n"}, {"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 3, "last_activity_date": 1488376948, "last_edit_date": 1488376948, "creation_date": 1488376195, "answer_id": 42533519, "question_id": 42533405, "link": "https://stackoverflow.com/questions/42533405/excel-vba-if-value-not-found-in-range-go-to/42533519#42533519", "title": "Excel VBA: If value not found in range, go to", "body": "<p>Place some label before <code>Next I</code>:</p>\n\n<pre><code>NextI:\n    Next I\n</code></pre>\n\n<p>Then you can do this:</p>\n\n<pre><code>If rngFound Is Nothing Then\n    Goto NextI\nElse\n    ....\n</code></pre>\n\n<p>Alternatively you can simplify it without needing the else statement</p>\n\n<pre><code>If rngFound Is Nothing Then Goto NextI\n.... ' Proceed without the need for `Else` and `End If`\n</code></pre>\n\n<p>EDIT.. Some more</p>\n\n<p>While it is generally considered bad programming practice to use <code>Goto</code> statements, it is not the case in this specific situation. It is just used as a workaround for the lack of the <code>continue</code> statement that exists in the C and derived languages.</p>\n"}, {"comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1488376447, "post_id": 42533555, "comment_id": 72202781, "body": "I was about to talk about spaghetti programs with GoTo! I was about to do the same suggestion but I&#39;d add a boolean to avoid <code>doing more stuff</code> regarding the structure of the OP! ;)"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 3, "last_activity_date": 1488376285, "creation_date": 1488376285, "answer_id": 42533555, "question_id": 42533405, "link": "https://stackoverflow.com/questions/42533405/excel-vba-if-value-not-found-in-range-go-to/42533555#42533555", "title": "Excel VBA: If value not found in range, go to", "body": "<p>There is no need to use <code>GoTo</code> here. The simple way to accomplish this is with the following: </p>\n\n<pre><code>For I = 1 To WS_Count\n\n    ' do stuff \n\n    If Not rngFound is Nothing\n\n       'execute desired action\n\n    End If\n\n    ' do more stuff\n\nNext i\n</code></pre>\n\n<p>You can also place the <code>do more stuff</code> inside the first if block if needed. The code in your post was kind of messy and I didn't take time to dissect fully.</p>\n"}], "owner": {"reputation": 489, "user_id": 3816407, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/906ca9641c9f8a6bb1d9746904c6f7a2?s=128&d=identicon&r=PG&f=1", "display_name": "SMORF", "link": "https://stackoverflow.com/users/3816407/smorf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10377, "favorite_count": 1, "accepted_answer_id": 42533519, "answer_count": 4, "score": 3, "last_activity_date": 1488376948, "creation_date": 1488375877, "question_id": 42533405, "link": "https://stackoverflow.com/questions/42533405/excel-vba-if-value-not-found-in-range-go-to", "title": "Excel VBA: If value not found in range, go to", "body": "<p>I am using the following code to loop through sheets 1-31 filtering each sheet by the value in a cell(\"E1\") in sheets(\"RunFilter_2\") and then copy the filtered range and copy to the next empty row in sheets(\"RunFilter_2\").</p>\n\n<p>The code errors when it doesn't find the value of sheets(\"RunFilter_2\").Range(\"E1\") in column 18 of the active sheet.</p>\n\n<p>So I added a range check, that checks if sheets(\"RunFilter_2\").Range(\"E1\").Value is found in column Range(\"R:R\").</p>\n\n<p>But, how do I move to the Next I If rngFound Is Nothing?</p>\n\n<pre><code>Sub RunFilter2()\n\nRows(\"5:5\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Delete Shift:=xlUp\nRange(\"A1\").Select\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n\n    Set wb = ActiveWorkbook\n    Set ws = wb.sheets(\"01\")\n\n         Dim WS_Count As Integer\n         Dim I As Integer\n\n         WS_Count = ActiveWorkbook.Worksheets.Count - 3\n\n         For I = 1 To WS_Count\n\nDim LastRow As Long\nLastRow = ActiveSheet.UsedRange.Rows.Count\n\nsheets(I).Select\n\nColumns(\"A:U\").Select\n\nDim rng As Range\nDim rngFound As Range\n\nSet rng = Range(\"R:R\")\n\nSet rngFound = rng.Find(sheets(\"RunFilter_2\").Range(\"E1\").Value)\n\nIf rngFound Is Nothing Then\n\n'----------------------------------\n' How do I code ... GO TO Next I\n'----------------------------------\n\nElse:\n\nSelection.AutoFilter\n\nActiveSheet.Range(\"$A$1:$U\" &amp; LastRow).AutoFilter Field:=18, Criteria1:=sheets(\"RunFilter_2\").Range(\"E1\").Value\n\n    Range(\"A1\").Offset(1, 0).Select\n    Rows(ActiveCell.Row).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n\nsheets(\"RunFilter_2\").Select\n\nIf Range(\"A4\").Value = \"\" Then\n\nRange(\"A4\").Select\n\nElse\n\nCells(Rows.Count, 1).End(xlUp).Offset(1, 0).Select\n\nEnd If\n\nActiveSheet.Paste\nws.Select\nApplication.CutCopyMode = False\nSelection.AutoFilter\nRange(\"A1\").Select\nsheets(\"RunFilter_2\").Select\n\n         Next I\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2007"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1488378007, "post_id": 42533139, "comment_id": 72203899, "body": "data macros or replication maybe?"}, {"owner": {"reputation": 3, "user_id": 6844075, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153755328201610/picture?type=large", "display_name": "Patrick Meiler", "link": "https://stackoverflow.com/users/6844075/patrick-meiler"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1488380977, "post_id": 42533139, "comment_id": 72206073, "body": "@Nathan_Sav unfortunately replication doesn&#39;t work with Access 2007 anymore :-("}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1488382034, "post_id": 42533139, "comment_id": 72206956, "body": "Will the &#39;master&#39; get changed by someone? If not, and assuming you include code to alert if a user changes their system clock to an earlier time (and allow for time zones) you could try this: (1) Get the latest timestamp from the Master; (2) Get all records from the &#39;Other&#39; database where timestamp is greater."}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1488382038, "post_id": 42533139, "comment_id": 72206960, "body": "Assuming you have a matching ID Primary key field, you could join them in a query and then update the master if the slave is later ? Not sure you need a loop for this."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1488382285, "post_id": 42533139, "comment_id": 72207146, "body": "If you save as 2003 BE, 2003 Replica, 2007 FE Linked to replica."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6844075, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153755328201610/picture?type=large", "display_name": "Patrick Meiler", "link": "https://stackoverflow.com/users/6844075/patrick-meiler"}, "edited": false, "score": 0, "creation_date": 1488961405, "post_id": 42627302, "comment_id": 72457603, "body": "Thanks a lot! Meanwhile I had a different solution but this seems a lot faster! Thanks a lot!!!!"}], "tags": [], "owner": {"reputation": 362, "user_id": 6591527, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rhIHjmWgstQ/AAAAAAAAAAI/AAAAAAAAAQw/ZyFmiscBeRQ/photo.jpg?sz=128", "display_name": "Will Jobs", "link": "https://stackoverflow.com/users/6591527/will-jobs"}, "is_accepted": true, "score": 0, "last_activity_date": 1488808078, "last_edit_date": 1495542724, "creation_date": 1488808078, "answer_id": 42627302, "question_id": 42533139, "link": "https://stackoverflow.com/questions/42533139/ms-access-2007-synchronizing-two-databases-and-keeping-the-record-with-the-lat/42627302#42627302", "title": "MS Access 2007 - Synchronizing two databases and keeping the record with the latest timestamp", "body": "<h2>Assumption</h2>\n\n<p>I will assume ID is the unique identifier in all databases, and that there are no IDs in the slave databases that are <em>not</em> in the master database. Otherwise you have a problem because slave1 may assign ID 7 to \"Fred\" but slave2 may assign ID 7 to \"Thomas\". </p>\n\n<h2>UnionQuery</h2>\n\n<pre><code>SELECT ID, Name, Birthday, Timestamp, 1 AS SlaveNum FROM Candidates_Slave1\nUNION ALL\nSELECT ID, Name, Birthday, Timestamp, 2 AS SlaveNum FROM Candidates_Slave2\nUNION ALL\nSELECT ID, Name, Birthday, Timestamp, 3 AS SlaveNum FROM Candidates_Slave3\nUNION ALL\n...\n</code></pre>\n\n<p>Then I would write a group by query off of that union query to get each ID and its maximum timestamp.</p>\n\n<h2>GroupQuery</h2>\n\n<pre><code>SELECT ID, max(Timestamp) AS MaxTime FROM UnionQuery\n</code></pre>\n\n<p>Then join that to the UnionQuery, and take the minimum (or maximum) SlaveNum (in case multiple slaves have the same maximum timestamp).</p>\n\n<h2>JoinQuery</h2>\n\n<pre><code>SELECT GroupQuery.ID, GroupQuery.MaxTime AS Timestamp, min(UnionQuery.SlaveNum) AS SlaveNum\nFROM GroupQuery INNER JOIN UnionQuery ON\n    GroupQuery.ID = UnionQuery.ID AND\n    GroupQuery.MaxTime = UnionQuery.Timestamp;\n</code></pre>\n\n<p>Now you can get the latest (slave) data by inner joining to UnionQuery again, and you can join to the master Candidates table and compare timestamps. Add a WHERE clause that checks for any timestamps in the master table that are less than our join query: </p>\n\n<h2>FullInfoQuery</h2>\n\n<pre><code>SELECT Candidates_Master.ID, \n    Candidates_Master.Name AS Name_Master,\n    Candidates_Master.Birthday AS Birthday_Master, \n    Candidates_Master.Timestamp AS Timestamp_Master, \n    UnionQuery.Name AS Name_Slave, \n    UnionQuery.Birthday AS Birthday_Slave,\n    UnionQuery.Timestamp AS Timestamp_Slave\nFROM (JoinQuery INNER JOIN UnionQuery \n    ON JoinQuery.ID = UnionQuery.ID AND JoinQuery.SlaveNum = UnionQuery.SlaveNum)\nINNER JOIN Candidates_Master ON JoinQuery.ID = Candidates_Master.ID\nWHERE Candidates_Master.Timestamp &lt; UnionQuery.Timestamp;\n</code></pre>\n\n<p>Finally, writing an update query can sometimes be a nuisance because strictly speaking there should not be a JOIN clause in UPDATE queries, but Access lets you sometimes. <a href=\"https://stackoverflow.com/a/24269023/6591527\">This post</a> details when you get the \"this recordset is not updateable\" error in Access. The ANSI way to do the update would be something like this:</p>\n\n<h2>UpdateQuery</h2>\n\n<pre><code>UPDATE Candidates_Master\nSET (Name, Birthday, Timestamp) = (SELECT Name_Slave, Birthday_Slave, Timestamp_Slave FROM FullInfoQuery WHERE Candidates_Master.ID = FullInfoQuery.ID)\nWHERE EXISTS (SELECT 1 FROM FullInfoQuery WHERE FullInfoQuery.ID = Candidates_Master.ID);\n</code></pre>\n\n<p>Unfortunately, Access doesn't quite support that syntax, so you'd need to run something like this:</p>\n\n<h2>UpdateQuery_v2</h2>\n\n<pre><code>UPDATE Candidates_Master\nSET Name = (SELECT Name_Slave FROM FullInfoQuery WHERE Candidates_Master.ID = FullInfoQuery.ID),\nBirthday = (SELECT Birthday_Slave FROM FullInfoQuery WHERE Candidates_Master.ID = FullInfoQuery.ID),\nTimestamp = (SELECT Timestamp_Slave FROM FullInfoQuery WHERE Candidates_Master.ID = FullInfoQuery.ID)\nWHERE EXISTS (SELECT 1 FROM FullInfoQuery WHERE FullInfoQuery.ID = Candidates_Master.ID);\n</code></pre>\n\n<p>But because that has so many correlated subqueries, it could be very slow/inefficient. Try it and see. A common alternative (for me, anyway), is to write a make table query to paste the results of FullInfoQuery into its own table, and then write an UPDATE query based on that table, for which the syntax is very easy:</p>\n\n<h2>UpdateQuery_v3</h2>\n\n<pre><code>UPDATE Candidates_Master INNER JOIN tblFullInfoQuery ON Candidates_Master.ID = tblFullInfoQuery.ID\nSET Candidates_Master.Name = tblFullInfoQuery.Name_Slave,\n    Candidates_Master.Birthday = tblFullInfoQuery.Birthday_Slave,\n    Candidates_Master.Timestamp = tblFullInfoQuery.Timestamp_Slave\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6844075, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153755328201610/picture?type=large", "display_name": "Patrick Meiler", "link": "https://stackoverflow.com/users/6844075/patrick-meiler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 42627302, "answer_count": 1, "score": 0, "last_activity_date": 1488808078, "creation_date": 1488375099, "question_id": 42533139, "link": "https://stackoverflow.com/questions/42533139/ms-access-2007-synchronizing-two-databases-and-keeping-the-record-with-the-lat", "title": "MS Access 2007 - Synchronizing two databases and keeping the record with the latest timestamp", "body": "<p>using Access 2007, I have a master database and several slave databases. Let's say I have  a simple table: candidates. </p>\n\n<p><strong>In the Master DB</strong></p>\n\n<pre><code>Id ;   Name    ;   Birthday   ;   Timestamp\n01 ; Henri     ; 01-01-1911   ; 01-01-2017 \n</code></pre>\n\n<p><strong>In the Slave DB</strong></p>\n\n<pre><code>Id ;   Name    ;   Birthday   ;   Timestamp\n01 ; Henry     ; 01-01-1911   ; 01-02-2017 \n</code></pre>\n\n<p>What I need is, that the latest manipulated record replaces the former record in the master DB. In this example the record from the slave db would replace the record from the master db.</p>\n\n<p>In my current solution I loop through the recordsets and compare the timestamps. It works, but I would like to know if there is a much more efficient and faster solution? Maybe with SQL?</p>\n\n<p>Best regards</p>\n"}, {"tags": ["vba", "excel", "runtime-error", "excel-2007"], "answers": [{"tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": true, "score": 2, "last_activity_date": 1488375670, "last_edit_date": 1488375670, "creation_date": 1488375362, "answer_id": 42533223, "question_id": 42533101, "link": "https://stackoverflow.com/questions/42533101/error-paste-method-of-worksheet-class-failed/42533223#42533223", "title": "Error : Paste method of worksheet class failed", "body": "<p>You haven't specified a <code>Worksheet</code>. Perhaps you wanted something like this:</p>\n\n<pre><code>Workbooks(\"Task2.xlsm\").Worksheets(\"Data\").Cells(1, 1).PasteSpecial xlPasteValues\n</code></pre>\n\n<p><hr/>\n... <em>also</em> using this (below) is asking for trouble:</p>\n\n<pre><code>oWsBDR.Worksheets(\"downloadFile\").Cells.Copy\n</code></pre>\n\n<p>A quick fix would be:</p>\n\n<pre><code>oWsBDR.Worksheets(\"downloadFile\").UsedRange.Copy\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 7610519, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/da01ad51f95b2270fa51a6c109659fa5?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/7610519/francis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 606, "favorite_count": 0, "accepted_answer_id": 42533223, "answer_count": 1, "score": 3, "last_activity_date": 1488375670, "creation_date": 1488374973, "last_edit_date": 1488375215, "question_id": 42533101, "link": "https://stackoverflow.com/questions/42533101/error-paste-method-of-worksheet-class-failed", "title": "Error : Paste method of worksheet class failed", "body": "<p>I was given to a function to retrieve data by downloading a text file from a site. </p>\n\n<p>In the gop sub, the file will be open when I call the function, but when I tried to copy the data to my sheet \"Data\", an error occurs : </p>\n\n<blockquote>\n  <p>Paste method of worksheet class failed.</p>\n</blockquote>\n\n<p>Sometimes it's another error.</p>\n\n<p>Does anyone happen to know the solution? </p>\n\n<pre><code>Sub gop()\nDim oWsBDR As Excel.Workbook\n\n'On Error Resume Next\n\nSet oWsBDR = WbBDR()\nIf oWsBDR Is Nothing Then\n    MsgBox \"Le fichier n'a pas \u00e9t\u00e9 extrait.\"\nElse\n    'Set Workbooks(\"Task2\").Worksheets(\"Data\") = oWsBDR.Sheets(\"downloadFile\")\n    oWsBDR.Worksheets(\"downloadFile\").Cells.Copy\n    'Windows(\"Task2.xlsm\").Cells(1, 1).Paste 'This doesn't work either\n    Windows(\"Task2.xlsm\").Cells(1, 1).PasteSpecial xlPasteValues 'Error\n    Application.CutCopyMode = False\n    With Worksheets(\"Data\").Cells\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlCenter\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n        .ColumnWidth = 30\n    End With\n    Set oWsBDR = Nothing\nEnd If\n\nApplication.DisplayAlerts = False\nWindows(\"downloadFile.ln\").Close\n\nEnd Sub\n\nPublic Function WbBDR() As Excel.Workbook\nDim bOk As Boolean\nDim m_oME As Excel.Workbook\nDim m_oBDR As Excel.Workbook\n\nIf m_oBDR Is Nothing Then\n    bOk = False\n    Err.Clear\n    On Error Resume Next\n    Do Until bOk\n        Workbooks.OpenText Filename:=\"https://.../starw/downloadFile.ln?fileName=bdr_ast_gop\", _\n            Origin:=xlMSDOS, _\n            StartRow:=1, _\n            DataType:=xlDelimited, _\n            TextQualifier:=xlDoubleQuote, _\n            ConsecutiveDelimiter:=False, _\n            Tab:=False, _\n            Semicolon:=True, _\n            Comma:=False, _\n            Space:=False, _\n            Other:=False, _\n            FieldInfo:=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1), _\n                 Array(7, 1), Array(8, 1), Array(9, 1), Array(10, 1), Array(11, 1), Array(12, 1), _\n                 Array(13, 1), Array(14, 1), Array(15, 1), Array(16, 1), Array(17, 1), Array(18, 1), _\n                 Array(19, 1), Array(20, 1), Array(21, 1), Array(22, 1), Array(23, 1), Array(24, 1), _\n                 Array(25, 1), Array(26, 1), Array(27, 1), Array(28, 1), Array(29, 1), Array(30, 1), _\n                 Array(31, 1), Array(32, 1), Array(33, 1), Array(34, 1), Array(35, 1), Array(36, 1), _\n                 Array(37, 1), Array(38, 1), Array(39, 1), Array(40, 1), Array(41, 1), Array(42, 1), _\n                 Array(43, 1), Array(44, 1), Array(45, 1), Array(46, 1), Array(47, 1), Array(48, 1), _\n                 Array(49, 1), Array(50, 1), Array(51, 1), Array(52, 1), Array(53, 1), Array(54, 1), _\n                 Array(55, 1), Array(56, 1), Array(57, 1), Array(58, 1), Array(59, 1), Array(60, 1), _\n                 Array(61, 1), Array(62, 1), Array(63, 1), Array(64, 1), Array(65, 1)), _\n                 TrailingMinusNumbers:=True\n        If Err.Number = 0 Then bOk = True\n        Err.Clear\n    Loop\n    On Error GoTo 0\n    Set m_oBDR = Application.Workbooks(\"downloadFile.ln\")\nEnd If\nSet WbBDR = m_oBDR\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "recursion"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1488374758, "post_id": 42532958, "comment_id": 72201644, "body": "look at the FileSystemObject."}], "answers": [{"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1488377596, "last_edit_date": 1495535383, "creation_date": 1488377596, "answer_id": 42534010, "question_id": 42532958, "link": "https://stackoverflow.com/questions/42532958/how-to-recursively-move-through-excel-files-in-a-given-folder-and-update-all-wor/42534010#42534010", "title": "How to recursively move through Excel files in a given folder and update all workbook connection instances in a file", "body": "<p>You cannot use <code>dir</code> in a recursiv way. Use <code>fileSystemObject</code> instead. There is a good VB6 example on <a href=\"https://stackoverflow.com/a/729844/7599798\">stackOverflow</a>, should work also with VBA (add the <code>Microsoft scripting Runtime</code> as Reference)</p>\n"}], "owner": {"reputation": 1, "user_id": 7641380, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210018753839263/picture?type=large", "display_name": "David Bezgov\u0161ek", "link": "https://stackoverflow.com/users/7641380/david-bezgov%c5%a1ek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488377596, "creation_date": 1488374563, "question_id": 42532958, "link": "https://stackoverflow.com/questions/42532958/how-to-recursively-move-through-excel-files-in-a-given-folder-and-update-all-wor", "title": "How to recursively move through Excel files in a given folder and update all workbook connection instances in a file", "body": "<p>So I have this code for now that loops through files in a directory and corrects the OLEDB connection string and text.</p>\n\n<pre><code>Sub LoopThroughFiles()\n\nFolderName = \"C:\\Files\\\"\nIf Right(FolderName, 1) &lt;&gt; Application.PathSeparator Then FolderName = FolderName &amp; Application.PathSeparator\nFname = Dir(FolderName &amp; \"*.xls\")\n\n'loop through the files\nDo While Len(Fname)\n\n    With Workbooks.Open(FolderName &amp; Fname)\n\n            With ActiveWorkbook.Connections(\"MYCONNECTION\").OLEDBConnection\n                .CommandText = Array(\"NEWNAME\")\n                .CommandType = xlCmdCube\n                .Connection = Array( _\n                \"OLEDB;Provider=MSOLAP.5;Integrated Security=SSPI;Persist Security Info=True;Initial Catalog=MyCube;Data Source=server.domain.net\\OLAP;MDX Compatibility=1;Safety Options=2;MDX Missing Member Mode=Error;Update Isolation Level=2\" _\n                )\n                .RefreshOnFileOpen = True\n                .SavePassword = False\n                .SourceConnectionFile = \"\"\n                .MaxDrillthroughRecords = 1000\n                .ServerCredentialsMethod = xlCredentialsMethodIntegrated\n                .AlwaysUseConnectionFile = False\n                .RetrieveInOfficeUILang = True\n            End With\n            With ActiveWorkbook.Connections(\"MYCONNECTION\")\n                .Name = \"MYCONNECTION\"\n                .Description = \"\"\n            End With\n                ActiveWorkbook.Close SaveChanges:=True\n    End With\n\n    ' go to the next file in the folder\n    Fname = Dir\n\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>I would like to upgrade this so that it would recursively scan through the given directory and correct all .xls files that are found even in subdirectories.</p>\n\n<p>And additionaly I would like that it checks workbook connections, because many files will have many instances od the connection (eg. MYCONNECTION, MYCONNECTION1, MYCONNECTION2, MYCONNECTION3,...) and it would need to correct the same OLEDB string and text name to all instances of thw workbook connection.</p>\n\n<p>Any help would be greatly appreciated. :)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1141, "user_id": 945721, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6849e039022068a5d77d28215c49f2bb?s=128&d=identicon&r=PG", "display_name": "majjam", "link": "https://stackoverflow.com/users/945721/majjam"}, "edited": false, "score": 4, "creation_date": 1488374471, "post_id": 42532857, "comment_id": 72201404, "body": "I believe this will be set in your Region and Language Control panel (in Win7 its Control Panels =&gt; Region and Language =&gt; Decimal symbol) Changing that should solve your problem."}, {"owner": {"reputation": 208, "user_id": 7430332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/4MdKa.jpg?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/7430332/jonathan"}, "reply_to_user": {"reputation": 1141, "user_id": 945721, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6849e039022068a5d77d28215c49f2bb?s=128&d=identicon&r=PG", "display_name": "majjam", "link": "https://stackoverflow.com/users/945721/majjam"}, "edited": false, "score": 0, "creation_date": 1488374736, "post_id": 42532857, "comment_id": 72201629, "body": "@bamie9l : Thank you for the answer but I would like to do this only for the Macro, also if somebody use the macro from a different region set-up I would like that still the point is displayed."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1488377921, "post_id": 42532857, "comment_id": 72203824, "body": "If you want actions such as <code>MsgBox</code>, or <code>Debug.print</code> to display in a format different from your windows regional settings, you will need to format those values explicitly."}, {"owner": {"reputation": 208, "user_id": 7430332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/4MdKa.jpg?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/7430332/jonathan"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1488378702, "post_id": 42532857, "comment_id": 72204361, "body": "@RonRosenfeld, thank you for the answer, could you also tell me about the function <code>.WriteLine</code> to print text to a file? Otherwise If you are sure about it and write it bellow I can validate it as an answer."}], "answers": [{"comments": [{"owner": {"reputation": 208, "user_id": 7430332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/4MdKa.jpg?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/7430332/jonathan"}, "edited": false, "score": 0, "creation_date": 1488375258, "post_id": 42533035, "comment_id": 72201968, "body": "Thank you for the answer but I would like to do this only for the Macro, also if somebody use the macro from a different set-up I would like that still the point is displayed. Is it possible to change the decimal settings just for this macro?"}, {"owner": {"reputation": 208, "user_id": 7430332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/4MdKa.jpg?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/7430332/jonathan"}, "edited": false, "score": 1, "creation_date": 1488376983, "post_id": 42533035, "comment_id": 72203175, "body": "Also your answer does not help because the coma comes from the settings in Region and Language of the Control panel as mentioned by @bamie9l in the comments."}], "tags": [], "owner": {"reputation": 1376, "user_id": 7300068, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/39c4b2315d364579d8618fb493847188?s=128&d=identicon&r=PG&f=1", "display_name": "Crayons", "link": "https://stackoverflow.com/users/7300068/crayons"}, "is_accepted": false, "score": -1, "last_activity_date": 1488375043, "last_edit_date": 1488375043, "creation_date": 1488374809, "answer_id": 42533035, "question_id": 42532857, "link": "https://stackoverflow.com/questions/42532857/vba-display-decimals-with-point-and-not-coma/42533035#42533035", "title": "Vba: display decimals with point and not coma", "body": "<p>Most likely your Excel settings are causing a conflict.</p>\n\n<pre><code>1.    On the File tab, click the Options button\n2.    Click the Advanced tab\n3.    Clear/Uncheck the \"Use system separators\" option.\n</code></pre>\n\n<p>Then try your code.</p>\n"}, {"comments": [{"owner": {"reputation": 208, "user_id": 7430332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/4MdKa.jpg?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/7430332/jonathan"}, "edited": false, "score": 0, "creation_date": 1488452640, "post_id": 42536054, "comment_id": 72241950, "body": "Thank you @RonRosenfeld! It is a very good answer and I will definitely come back to give a up-vote as soon as I get enough reputation.  However After a lot of research, I could come up with a solution, still not beautiful, but that actually answer my question, I will validate this one as an answer."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 4, "last_activity_date": 1488383525, "last_edit_date": 1488383525, "creation_date": 1488382990, "answer_id": 42536054, "question_id": 42532857, "link": "https://stackoverflow.com/questions/42532857/vba-display-decimals-with-point-and-not-coma/42536054#42536054", "title": "Vba: display decimals with point and not coma", "body": "<p>This is easier said than done. In the VBA editor, the decimal separator is the dot.  However, the MsgBox function (and the Format function) will use the windows regional settings, and not the Excel settings, to format its results.</p>\n\n<p>In order to have the MsgBox display a number using format settings of your choice, you need to create a string that has the value formatted as you want.</p>\n\n<p>Here is one way of doing that:</p>\n\n<hr>\n\n<pre><code>Option Explicit\nSub dural()\n Dim S As String\n Dim D As Double\n Const myDecSep As String = \".\"\n\nD = 1234.56\n\nS = Format(D, \"0.00\") 'will format using the system separator\n\nS = Replace(S, Application.DecimalSeparator, myDecSep)\n\nMsgBox S\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Note that if you want to use both decimal and thousands separators, and if you are interchanging, for example, the comma and the dot, you need to do this twice so as not to replace all your commas with dots, or vice-versa</p>\n\n<hr>\n\n<pre><code>Option Explicit\nSub dural()\n Dim S As String\n Dim D As Double\n Const myDecSep As String = \".\"\n Const myThousSep As String = \",\"\n\nD = 1234.56\n\nS = Format(D, \"#,##0.00\")\n\nS = Replace(S, Application.DecimalSeparator, Chr(1))\nS = Replace(S, Application.ThousandsSeparator, Chr(2))\nS = Replace(S, Chr(1), myDecSep)\nS = Replace(S, Chr(2), myThousSep)\n\nMsgBox S\n\nEnd Sub\n</code></pre>\n\n<hr>\n"}, {"tags": [], "owner": {"reputation": 208, "user_id": 7430332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/4MdKa.jpg?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/7430332/jonathan"}, "is_accepted": true, "score": 1, "last_activity_date": 1488452072, "creation_date": 1488452072, "answer_id": 42553439, "question_id": 42532857, "link": "https://stackoverflow.com/questions/42532857/vba-display-decimals-with-point-and-not-coma/42553439#42553439", "title": "Vba: display decimals with point and not coma", "body": "<p>As a first step, the three functions bellows from Kernel32 Dynamic-link library have to be declared:</p>\n\n<pre><code>Private Declare Function GetUserDefaultLCID% Lib \"kernel32\" ()\nPrivate Declare Function GetLocaleInfoA Lib \"kernel32\" (ByVal Locale As Long, ByVal LCType As Long, ByVal lpLCData As String, ByVal cchData As Long) As Long\nPrivate Declare Function SetLocaleInfoA Lib \"kernel32\" ( ByVal Locale As Long, ByVal LCType As Long, ByVal lpLCData As String) As Boolean\n</code></pre>\n\n<ul>\n<li>The first will get the user default id</li>\n<li>The second will help to get the value of the locals (and therefore restore)</li>\n<li>The third will help to set the value of the locals</li>\n</ul>\n\n<p>The local type value for the decimals is 14 (some likes to write &amp;HE - hexadecimal E -)</p>\n\n<p>Then the program has to look like this:</p>\n\n<pre><code>' record the settings in the variable LocalSettingsDecimal\nDim LocalSettingsDecimal As String\nDim Buffer As String\nBuffer = String(256, 0)\nDim le As Integer\nle = GetLocaleInfoA(GetUserDefaultLCID(), 14, Buffer, Len(Buffer))\nLocalSettingsDecimal = Left(Buffer, le - 1)\n\n' force decimal settings to '.'\nCall SetLocaleInfoA(GetUserDefaultLCID(), 14, \".\")\n\n' body\nDim MyNumber As Single\nMyNumber = 0.03\nMsgBox (MyNumber)\n\n' set back the decimal settings\nCall SetLocaleInfoA(GetUserDefaultLCID(), 14, LocalSettingsDecimal)\n</code></pre>\n\n<p>Let's note that, unfortunately, In case the program body fail, the settings are not restored... but this still answer the issue</p>\n"}, {"tags": [], "owner": {"reputation": 1648, "user_id": 2902367, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5d8c0958de69efb073bb318fe1f9b1a6?s=128&d=identicon&r=PG", "display_name": "Ben Philipp", "link": "https://stackoverflow.com/users/2902367/ben-philipp"}, "is_accepted": false, "score": 0, "last_activity_date": 1611505454, "creation_date": 1611505454, "answer_id": 65873042, "question_id": 42532857, "link": "https://stackoverflow.com/questions/42532857/vba-display-decimals-with-point-and-not-coma/65873042#65873042", "title": "Vba: display decimals with point and not coma", "body": "<p>I noticed this today, too.<br />\nSpecifically, with the <code>FormatNumber</code> function.\nBecause I don't want to take @Jonathan's (very interesting) approach and change my f[lipp]ing system settings just to have power over how numbers are displayed (Seriously, Office, what is wrong with you??), I wrote a wrapper function to make <code>FormatNumber</code> use the <strong>app settings</strong>, instead of the <em>system settings</em>, after detecting whether it's necessary:</p>\n<pre><code>Public Function FormatNumberFixed(Expression As Variant, Optional NumDigitsAfterDecimal As Integer = -1, _\nOptional IncludeLeadingDigit As Integer = -2, Optional UseParensForNegativeNumbers As Integer = -2, _\nOptional GroupDigits As Integer = -2)\n    FormatNumberFixed = FormatNumber(Expression, NumDigitsAfterDecimal, IncludeLeadingDigit, UseParensForNegativeNumbers, GroupDigits)\n    Dim s As String\n    s = FormatNumber(0.5, 1)\n    If Mid(s, 2, 1) = Application.ThousandsSeparator Then ' WTF, thousands separator used as decimal separator\n        FormatNumberFixed = Replace(FormatNumberFixed, Application.ThousandsSeparator, &quot;%TMP%&quot;)\n        FormatNumberFixed = Replace(FormatNumberFixed, Application.DecimalSeparator, Application.ThousandsSeparator)\n        FormatNumberFixed = Replace(FormatNumberFixed, &quot;%TMP%&quot;, Application.DecimalSeparator)\n    End If\nEnd Function\n</code></pre>\n<p>This can be used to format numbers &quot;as expected&quot;, according to the settings in Excel.</p>\n"}], "owner": {"reputation": 208, "user_id": 7430332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/4MdKa.jpg?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/7430332/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9602, "favorite_count": 1, "accepted_answer_id": 42553439, "answer_count": 4, "score": 2, "last_activity_date": 1611505454, "creation_date": 1488374291, "last_edit_date": 1488374840, "question_id": 42532857, "link": "https://stackoverflow.com/questions/42532857/vba-display-decimals-with-point-and-not-coma", "title": "Vba: display decimals with point and not coma", "body": "<p>I would like to have all numbers in a macro displayed with point and not coma</p>\n\n<p>For Instance This display \"0,03\" but I would like \"0.03\":</p>\n\n<pre><code>Dim MyNumber As Single\nMyNumber = 0.03\nMsgBox (MyNumber)\n</code></pre>\n\n<p>I have tried a set of codes that does <strong><em>not</em></strong> work:</p>\n\n<ul>\n<li><p>this still displays the Coma:</p>\n\n<pre><code>Application.DecimalSeparator = \".\"\n</code></pre></li>\n<li><p>this still displays the Coma and does not apply to the whole macro</p>\n\n<pre><code>MyNumber = Format(MyNumber, \"##0.00\")\n</code></pre></li>\n<li><p>this displays dot instead of coma but does not apply to the whole macro</p>\n\n<pre><code>MsgBox (Replace(MyNumber, \",\", \".\"))\n</code></pre></li>\n</ul>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1488415998, "post_id": 42532212, "comment_id": 72225545, "body": "Why are all of your column As blank?  Not even a field name in row 1?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7641352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c85b44a4331e236c814fb6b80685ba66?s=128&d=identicon&r=PG&f=1", "display_name": "exceleratevba", "link": "https://stackoverflow.com/users/7641352/exceleratevba"}, "edited": false, "score": 0, "creation_date": 1488405491, "post_id": 42538399, "comment_id": 72221603, "body": "Wow, thank you. Would I copy/paste this code to the first sheet or create a new module for it?"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 1, "user_id": 7641352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c85b44a4331e236c814fb6b80685ba66?s=128&d=identicon&r=PG&f=1", "display_name": "exceleratevba", "link": "https://stackoverflow.com/users/7641352/exceleratevba"}, "edited": false, "score": 0, "creation_date": 1488460471, "post_id": 42538399, "comment_id": 72247178, "body": "There is a lot of if&#39;s in that answer.  Mostly in the &quot;set ws&quot; section.  To the right of each set I put the strings that should be sent to that page."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 1, "user_id": 7641352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c85b44a4331e236c814fb6b80685ba66?s=128&d=identicon&r=PG&f=1", "display_name": "exceleratevba", "link": "https://stackoverflow.com/users/7641352/exceleratevba"}, "edited": false, "score": 0, "creation_date": 1488460887, "post_id": 42538399, "comment_id": 72247441, "body": "see the dited answer"}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1488460874, "last_edit_date": 1488460874, "creation_date": 1488389897, "answer_id": 42538399, "question_id": 42532212, "link": "https://stackoverflow.com/questions/42532212/vba-macro-to-move-rows-to-various-other-sheets-automatically/42538399#42538399", "title": "VBA/macro to move rows to various other sheets automatically", "body": "<p>There is a lot of if's in that answer.  Mostly in the \"set ws\" section.  To the right of each \"set\" command I put the strings that should be sent to those pages.  Are all of those correct?  And if so, when you import your data is it imported to  Worksheets(\"Feb - Monitor\")?  And that is the main page you are searching for strings in column G?  If all of that is correct then this should work for you.  Make a copy of your workbook and try it in the copy first.  Create a plain module in the VBA editor and paste this into it.  It will copy rows based on strings found in column G and paste them into the appropriate pages.  If you want to remove those rows from  Worksheets(\"Feb - Monitor\") after they have been copied to other pages then uncomment (remove the ') from nextRow = 2 on down.</p>\n\n<pre><code>Sub Macro1()\n'Feb - Monitor - Anything keyed in as RT, T, RE, RJ\n'is moved to the first sheet Pending -\n'Anything keyed in as DA or I moves to this sheet Accepted -\n'Anything keyed in as AC moves to this sheet. Released -\n'Anything keyed in as RL moves to this sheet.\n\nDim ws1 As Worksheet\nDim ws2 As Worksheet\nDim ws3 As Worksheet\nDim ws4 As Worksheet\nDim lastRow As Long\nDim nextRow As Long\nDim myArray() As Variant\n\n\nSet ws1 = Worksheets(\"Feb - Monitor\") '  RT, T, RE, RJ\nSet ws2 = Worksheets(\"Pending\") '   DA, I\nSet ws3 = Worksheets(\"Accepted\") '  AC\nSet ws4 = Worksheets(\"Released\") '  RL\n\nlastRow = ws1.Range(\"G65536\").End(xlUp).Row\n\nmyArray = ws1.Range(\"G2:G\" &amp; lastRow)\n\n\n For i = LBound(myArray) To UBound(myArray)\n    If InStr(1, myArray(i, 1), \"T\") &gt; 0 And InStr(1, myArray(i, 1), \"RT\") = 0 Or _\n        InStr(1, myArray(i, 1), \"RT\") &gt; 0 Or InStr(1, myArray(i, 1), \"RE\") &gt; 0 Or _\n        InStr(1, myArray(i, 1), \"RJ\") &gt; 0 Then\n        ' These need to stay on Worksheets(\"Feb - Monitor\") so we do nothing\n        ' The reason I added this loop is in case I misunderstood your need\n        ' This loop is not necessary if we are'nt moving them\n    End If\n    If InStr(1, myArray(i, 1), \"DA\") &gt; 0 Or InStr(1, myArray(i, 1), \"I\") &gt; 0 Then ' send to \"Pending\"\n        nextRow = ws2.Range(\"G65536\").End(xlUp).Row + 1\n\n        ws1.Rows(i + 1).Copy Destination:=ws2.Range(\"A\" &amp; nextRow)\n    End If\n    If InStr(1, myArray(i, 1), \"AC\") &gt; 0 Then ' send to \"Accepted\"\n        nextRow = ws3.Range(\"G65536\").End(xlUp).Row + 1\n        ws1.Rows(i + 1).Copy Destination:=ws3.Range(\"A\" &amp; nextRow)\n    End If\n    If InStr(1, myArray(i, 1), \"RL\") &gt; 0 Then ' send to \"Released\"\n        nextRow = ws4.Range(\"G65536\").End(xlUp).Row + 1\n        ws1.Rows(i + 1).Copy Destination:=ws4.Range(\"A\" &amp; nextRow)\n    End If\n\nNext i\n\n\n'*********************************************\n'   The following code deletes all rows on worksheets(\"Feb - Monotor)\n'   that are not RT, T, RE, RJ\n'   You can uncomment it if you want to do that\n\n'nextRow = 2\n'For i = LBound(myArray) To UBound(myArray)\n'    nextRow = nextRow + 1\n'    If InStr(1, myArray(i, 1), \"DA\") &gt; 0 Or InStr(1, myArray(i, 1), \"I\") &gt; 0 _\n'        Or InStr(1, myArray(i, 1), \"AC\") Or InStr(1, myArray(i, 1), \"RL\") &gt; 0 Then\n'        nextRow = nextRow - 1\n'        Debug.Print i, myArray(i, 1), nextRow\n'        ws1.Rows(nextRow).Delete Shift:=xlUp\n'    End If\n'Next i\n\nSet ws1 = Nothing\nSet ws2 = Nothing\nSet ws3 = Nothing\nSet ws4 = Nothing\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7641352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c85b44a4331e236c814fb6b80685ba66?s=128&d=identicon&r=PG&f=1", "display_name": "exceleratevba", "link": "https://stackoverflow.com/users/7641352/exceleratevba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 195, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1488460874, "creation_date": 1488372561, "last_edit_date": 1488372605, "question_id": 42532212, "link": "https://stackoverflow.com/questions/42532212/vba-macro-to-move-rows-to-various-other-sheets-automatically", "title": "VBA/macro to move rows to various other sheets automatically", "body": "<p>Getting familiar with VBA/Macro\u2019s but still new and struggling. I\u2019ve been able to piece together stuff by looking up examples on youtube videos and playing around with other codes posted online but I\u2019m stuck and need major help </p>\n\n<p>I\u2019ve got four sheets on my workbook. All of them have the same layout, the first column is my header and has a filter. All the columns after L are hidden/deleted.</p>\n\n<p>I copy/paste information into the first sheet (Feb \u2013 Monitor), from an application, \"an example is on the text to column sheet). I have a macro to move everything to the correct columns which is run on the first sheet.</p>\n\n<p>I\u2019d like a macro for the first sheet so that when it\u2019s run, it\u2019ll do the following;</p>\n\n<p>Look at information in column G and move them to the appropriate sheets in the next empty row. </p>\n\n<p>Pending \u2013 Move anything that is \u201cDA\u201d or \u201cI\u201d to this sheet\nAccepted - Move anything that is \u201cAC\u201d to this sheet\nReleased \u2013 Move anything that is \u201cRL\u201d to this sheet.</p>\n\n<p>One thing to point out, there are blank spaces that appear in some of the cells in column G next to the characters ie \u201cT \u201c (two blank spaces after T) or \u201cRT \u201c (one blank space after RT)</p>\n\n<p>For the other sheets, I\u2019d like to know how to modify the code I have in \u201cModule1\u201d to automatically move rows for just the Pending, Accepted, and Released sheets to other sheets once you key in the specific status. I\u2019ve played around with the code and can get it to work but it overwrites the first row instead of moving it an empty row.</p>\n\n<p>Feb - Monitor - Anything keyed in as RT, T, RE, RJ is moved to the first sheet\nPending - Anything keyed in as DA or I moves to this sheet\nAccepted - Anything keyed in as AC moves to this sheet.\nReleased - Anything keyed in as RL moves to this sheet. </p>\n\n<p>Link to the spreadsheet on google drive. \n<a href=\"https://drive.google.com/open?id=0B6fek87_mXuEMnVCRUtobVVqQU0\" rel=\"nofollow noreferrer\">https://drive.google.com/open?id=0B6fek87_mXuEMnVCRUtobVVqQU0</a></p>\n\n<p>Much appreciated </p>\n"}, {"tags": ["vba", "excel", "templates"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1488372482, "post_id": 42531917, "comment_id": 72199990, "body": "Please dont use <a href=\"https://stackoverflow.com/questions/tagged/macros\">macros</a> tag for VBA! Thx @Peh for the edit! ;)"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 7430783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14b68fdb945cc88001fc207ffb442c9b?s=128&d=identicon&r=PG&f=1", "display_name": "kira123", "link": "https://stackoverflow.com/users/7430783/kira123"}, "edited": false, "score": 0, "creation_date": 1488373703, "post_id": 42532479, "comment_id": 72200874, "body": "Yes I want F14 as the base cell to paste into. However there is different template for the different criteria. so in the case if cell A4 in the sheet says Red &amp; Green, then it should copy past from the templatebook red &amp; green sheet. In the code you wrote it doesn&#39;t specific which template sheet to use, and I&#39;m not sure how to"}, {"owner": {"reputation": 1008, "user_id": 6894767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cac8b20e633ad4ea6819333bf38d120?s=128&d=identicon&r=PG", "display_name": "Werrf", "link": "https://stackoverflow.com/users/6894767/werrf"}, "edited": false, "score": 0, "creation_date": 1488374153, "post_id": 42532479, "comment_id": 72201175, "body": "Blech, sorry - I was trying to code and chat at the same time! I&#39;ve corrected that to include the reference to the TemplateBook.  The key part is using the same type of object on both sides of the <code>=</code>. If you&#39;re assigning values to a specific cell or range of cells, you need to give it a cell reference, string, integer, or similar."}], "tags": [], "owner": {"reputation": 1008, "user_id": 6894767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cac8b20e633ad4ea6819333bf38d120?s=128&d=identicon&r=PG", "display_name": "Werrf", "link": "https://stackoverflow.com/users/6894767/werrf"}, "is_accepted": false, "score": 0, "last_activity_date": 1488374025, "last_edit_date": 1488374025, "creation_date": 1488373243, "answer_id": 42532479, "question_id": 42531917, "link": "https://stackoverflow.com/questions/42531917/copying-templated-from-different-workbook-into-specific-cell-on-multiple-sheets/42532479#42532479", "title": "Copying templated from different workbook into specific cell on multiple sheets, based on criteria", "body": "<pre><code>     ws.Range(\"F14\").Value = TemplateBook.Sheets(\"Red &amp; Green\")  '&lt;--- is causing the error\n</code></pre>\n\n<p>In this line you're using two different types of objects. You're trying to say that the value of cell <code>F14</code> is the entire worksheet <code>Red &amp; Green</code> - not just the cells of <code>Red &amp; Green</code>, but the worksheet object. This is why you're getting the error.</p>\n\n<p>I'm a little unclear about exactly what you're trying to do, though - is the idea to take all the contents of the template sheet and paste them into the target worksheet starting at a base cell (F14)? If so, you can do something like this:</p>\n\n<pre><code>ws.range(\"F14\").value = TemplateBook.sheets(\"Red &amp; Green\").Range(\"A1\").value\n</code></pre>\n\n<p>...or similar, specifying the size of the source range, rather than trying to use \"all cells\".</p>\n"}, {"comments": [{"owner": {"reputation": 75, "user_id": 7430783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14b68fdb945cc88001fc207ffb442c9b?s=128&d=identicon&r=PG&f=1", "display_name": "kira123", "link": "https://stackoverflow.com/users/7430783/kira123"}, "edited": false, "score": 0, "creation_date": 1488374202, "post_id": 42532535, "comment_id": 72201210, "body": "I tried this but nothing happened, the template file opened but there was no error or no copy pasting either. I modified it to specify the range to copy:   ws.Range(&quot;F14&quot;) = TemplateBook.Sheets(&quot;Red &amp; Green&quot;).Range(&quot;E1:H623&quot;)    So I don&#39;t know if this why it didn&#39;t copy paste anything"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1488373378, "creation_date": 1488373378, "answer_id": 42532535, "question_id": 42531917, "link": "https://stackoverflow.com/questions/42531917/copying-templated-from-different-workbook-into-specific-cell-on-multiple-sheets/42532535#42532535", "title": "Copying templated from different workbook into specific cell on multiple sheets, based on criteria", "body": "<p>Just guessing. Can you try like this?</p>\n\n<pre><code>Option Explicit\n\nSub PASTE()\n\n    Dim wb1             As Workbook\n    Dim Sht             As Worksheet\n    Dim Rng             As Range\n    Dim Rng2            As Range\n    Dim cell            As Range\n    Dim ws              As Worksheet\n    Dim TemplateBook    As Workbook\n\n    Dim rng3            As Range\n\n    Set wb1 = ThisWorkbook\n    Set Sht = wb1.Worksheets(\"Summary\")\n    Set Rng = Sht.Range(\"A6:A\" &amp; Sht.Cells(Sht.Rows.Count, \"A\").End(xlUp).Row)\n\n    Set TemplateBook = Workbooks.Open(Filename:=\"C:\\Users\\VBA-NOOB\\Desktop\\EVERY Colour.xlsx\")\n    DoEvents\n\n    For Each cell In Rng\n        Set ws = wb1.Sheets(cell.Text)\n        Select Case ws.Range(\"A4\").Value\n        Case \"Red &amp; Green T\"\n\n            ws.Range(\"F14\") = TemplateBook.Sheets(\"Red &amp; Green\").Range(\"F14\")  '&lt;--- is causing the error\n\n        End Select\n    Next cell\n\nEnd Sub\n</code></pre>\n\n<p>What I have changed is here:</p>\n\n<pre><code>ws.Range(\"F14\") = TemplateBook.Sheets(\"Red &amp; Green\").Range(\"F14\")  \n</code></pre>\n\n<p>In your case you were assigning a Sheet to a range. That is not possible.</p>\n"}, {"tags": [], "owner": {"reputation": 46, "user_id": 7640944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d523050c873b1434d14611a1c95d96b2?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Ukken", "link": "https://stackoverflow.com/users/7640944/jacob-ukken"}, "is_accepted": true, "score": 1, "last_activity_date": 1488374531, "last_edit_date": 1488374531, "creation_date": 1488373570, "answer_id": 42532595, "question_id": 42531917, "link": "https://stackoverflow.com/questions/42531917/copying-templated-from-different-workbook-into-specific-cell-on-multiple-sheets/42532595#42532595", "title": "Copying templated from different workbook into specific cell on multiple sheets, based on criteria", "body": "<p>Specify the the range you want to copy from the template as shown below:</p>\n\n<pre><code>   Select Case ws.Range(\"A4\").Value\n            Case \"Red &amp; Green T\"\n            TemplateBook.Sheets(\"Red &amp; Green\").Range(\"F14:Z100\").Copy\n            ws.Activate\n            Range(\"F14\").Select\n            ActiveSheet.PASTE\n   End Select\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 7430783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14b68fdb945cc88001fc207ffb442c9b?s=128&d=identicon&r=PG&f=1", "display_name": "kira123", "link": "https://stackoverflow.com/users/7430783/kira123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 42532595, "answer_count": 3, "score": 1, "last_activity_date": 1488374531, "creation_date": 1488371747, "last_edit_date": 1488372302, "question_id": 42531917, "link": "https://stackoverflow.com/questions/42531917/copying-templated-from-different-workbook-into-specific-cell-on-multiple-sheets", "title": "Copying templated from different workbook into specific cell on multiple sheets, based on criteria", "body": "<p>I am struggling with writing a code to copy paste a template from a separate workbook into a specific cell. The template copied varies depending on the text criteria, which is located in cell A4 on each sheet that the template is supposed to be copied to.</p>\n\n<ol>\n<li>go through each sheet on Summary Workbook. </li>\n<li>On each sheet, in cell A4 there is a specific text that refers to a template</li>\n<li>Open the template workbook that has multiple template sheets. Copy the template that corresponds to the text in cell A4 of summary workbook sheets</li>\n<li>go back to the sheet on the summary workbook and paste the template to cell F14 Onwards. (So here do I have to specify the entire cell range of where it needs to be pasted, or would it be fine to just refer to the cell where it should clicked on before pasting)</li>\n<li>repeat for all the sheets in the Summary workbook</li>\n</ol>\n\n<p>Below is the attempt I made, and I am getting the error \"Application defined or objected defined error\" I have highlighted the line that triggers the error in the code below. I assume it is because I am not calling the template book sheet correctly. Also I don't if I have to specify the exact range of cells being copied and pasted, because normally if you copy an entire sheet, then you can only paste it as entire sheets as well and not to from a specific cell point.</p>\n\n<p>Thank you for any help!</p>\n\n<pre><code>  Sub PASTE()\n\nDim wb1 As Workbook\nDim Sht As Worksheet\nDim Rng, Rng2 As Range\nDim cell As Range\nDim ws As Worksheet\n\nSet wb1 = ThisWorkbook\nSet Sht = wb1.Worksheets(\"Summary\")\nSet Rng = Sht.Range(\"A6:A\" &amp; Sht.Cells(Sht.Rows.Count, \"A\").End(xlUp).Row)\n\nDim TemplateBook As Workbook\nSet TemplateBook = Workbooks.Open(Filename:=\"C:\\Users\\VBA-NOOB\\Desktop\\EVERY Colour.xlsx\")\nDoEvents\n\nFor Each cell In Rng\n   Set ws = wb1.Sheets(cell.Text)\n   Select Case ws.Range(\"A4\").Value   \n            Case \"Red &amp; Green T\"\n            ws.Range(\"F14\").Value = TemplateBook.Sheets(\"Red &amp; Green\")  '&lt;--- is causing the error\n\n   End Select\n   Next cell\n\n\n\n   End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1488371773, "post_id": 42531822, "comment_id": 72199460, "body": "try this instead <code>Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Select</code>. And your code only works if someone clicks in column AB"}, {"owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1488371836, "post_id": 42531822, "comment_id": 72199507, "body": "@Peh thanks i have already tried this but it takes the user to row 2. I need it to take the user to the last used row from row 5 down"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1488371945, "post_id": 42531822, "comment_id": 72199583, "body": "This can only happen because the last used row in column A is row 2. Or I don&#39;t understand. Do you mean go to last used row but at least go to row 5?"}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 3, "last_activity_date": 1488372276, "creation_date": 1488372276, "answer_id": 42532099, "question_id": 42531822, "link": "https://stackoverflow.com/questions/42531822/go-to-last-used-row-from-row-x-onwards-ignore-blanks/42532099#42532099", "title": "Go to last used row from row x onwards, ignore blanks?", "body": "<p>This would jump to the last used row but at least to row 5</p>\n\n<pre><code>    If Range(\"A\" &amp; Rows.Count).End(xlUp).Row &lt; 5 Then\n        Range(\"A5\").Select\n    Else\n        Range(\"A\" &amp; Rows.Count).End(xlUp).Select\n    End If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "is_accepted": false, "score": 2, "last_activity_date": 1488373243, "creation_date": 1488373243, "answer_id": 42532481, "question_id": 42531822, "link": "https://stackoverflow.com/questions/42531822/go-to-last-used-row-from-row-x-onwards-ignore-blanks/42532481#42532481", "title": "Go to last used row from row x onwards, ignore blanks?", "body": "<p>The last row in a sheet is at the bottom right corner of its <code>UsedRange</code> so:</p>\n\n<pre><code>[a1].SpecialCells(xlLastCell).Row\n</code></pre>\n\n<p>will find the last row.</p>\n"}], "owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 42532099, "answer_count": 2, "score": 1, "last_activity_date": 1488373243, "creation_date": 1488371515, "last_edit_date": 1488371844, "question_id": 42531822, "link": "https://stackoverflow.com/questions/42531822/go-to-last-used-row-from-row-x-onwards-ignore-blanks", "title": "Go to last used row from row x onwards, ignore blanks?", "body": "<p>When a user clicks a cell, I want to take the user to the last used row in the spreadsheet from row 5 onwards.</p>\n\n<p>For some reason this doesn't work and produces a method range of object worksheet failed error.</p>\n\n<p>Code:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.Column = Range(\"AB2\").Column Then\n        Range(\"A4\" &amp; Rows.Count).End(xlUp).Select\n    End If\nEnd Sub\n</code></pre>\n\n<p>Please can someone show me where I am going wrong?</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1488371487, "post_id": 42531746, "comment_id": 72199232, "body": "Your last parenthesis is too early! <code>varBlankCount = Application.WorksheetFunction.CountIf(Range(&quot;A:A&quot;), &quot;*&quot; &amp; Chr(160) &amp; &quot;*&quot;)</code>"}, {"owner": {"reputation": 155, "user_id": 7505330, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4d4e2dc261270635a8b583674b51ba1f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7505330/mike"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1488372183, "post_id": 42531746, "comment_id": 72199770, "body": "@R3uK: Thanks. That was just a typo here, not the issue in the code. Corrected it now. :)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1488372257, "post_id": 42531746, "comment_id": 72199824, "body": "Ok, So do you have any results or want is happening? Because the line looks fine, except that you don&#39;t specify the sheet you want to count on!"}, {"owner": {"reputation": 155, "user_id": 7505330, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4d4e2dc261270635a8b583674b51ba1f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7505330/mike"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1488372302, "post_id": 42531746, "comment_id": 72199864, "body": "@R3uK: Wow, actually that was the issue. Thanks so much and sorry for this beginner mistake. :)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1488372584, "post_id": 42531746, "comment_id": 72200074, "body": "Glad I could help! ;) I&#39;ve added an answer so that you can close the subject! ;)"}], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 2, "last_activity_date": 1488372539, "creation_date": 1488372539, "answer_id": 42532200, "question_id": 42531746, "link": "https://stackoverflow.com/questions/42531746/count-cells-containing-chr160-character-in-vba/42532200#42532200", "title": "Count cells containing Chr(160) character in VBA", "body": "<p>Always specify the sheet you want to work with :</p>\n\n<pre><code>varBlankCount = Application.WorksheetFunction.CountIf(Sheets(\"Sheet1\").Range(\"A:A\"), \"*\" &amp; Chr(160) &amp; \"*\")\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 7505330, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4d4e2dc261270635a8b583674b51ba1f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7505330/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 372, "favorite_count": 0, "accepted_answer_id": 42532200, "answer_count": 1, "score": 1, "last_activity_date": 1497786713, "creation_date": 1488371304, "last_edit_date": 1497786713, "question_id": 42531746, "link": "https://stackoverflow.com/questions/42531746/count-cells-containing-chr160-character-in-vba", "title": "Count cells containing Chr(160) character in VBA", "body": "<p>I use the following code to remove all Chr(160) characters, i.e. the non-breaking spaces which occur occasionally after pasting manually (depending on the source of copying).  </p>\n\n<p>This works fine so far:</p>\n\n<pre><code>Worksheets(2).Range(\"A:A\").Replace Chr(160), \"\", xlPart\n</code></pre>\n\n<p>How can I count the number of cells containing this character before removing it? I tried the following code for this but unfortunately that's not working:</p>\n\n<pre><code>varBlankCount = Application.WorksheetFunction.CountIf(Range(\"A:A\"), \"*\" &amp; Chr(160) &amp; \"*\")\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 187, "user_id": 1727919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2e334da005840264c291d97a8b27d7?s=128&d=identicon&r=PG", "display_name": "Paras Parmar", "link": "https://stackoverflow.com/users/1727919/paras-parmar"}, "is_accepted": false, "score": 0, "last_activity_date": 1488379706, "creation_date": 1488379706, "answer_id": 42534783, "question_id": 42530930, "link": "https://stackoverflow.com/questions/42530930/how-to-copy-specific-columns-in-specific-order-from-one-sheet-to-another/42534783#42534783", "title": "How to copy specific columns in specific order from one sheet to another?", "body": "<p>The solution to your problem is of the form <strong>f(x) = y</strong> where <strong>x</strong> is the column no. of the source sheet and <strong>y</strong> is the column number of that very same column on the destination sheet. \nf(x) is a simple mapping between a Source column and transformed into a destination column no.</p>\n\n<p>As you still need to define the problem better by including sample data, I'll simply brief you on The 3 steps to resolve your problem. \nI hope you know your VBA well enough to encode the steps into the specific VBA code you need to solve this permanently.</p>\n\n<ol>\n<li>Create a sheet as a \"ControlPanel\" that maps the columns you need.\n<a href=\"https://i.stack.imgur.com/hxsfK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hxsfK.png\" alt=\"enter image description here\"></a></li>\n<li>Assuming your sheets are named appropriately as per the code below.</li>\n<li><p>Kindly do apply your VBA skills and discretion to customize the code below as per your needs.</p>\n\n<pre><code>Public Sub Add_Msng_And_Check_Prev_EmpData()\n''  Objective : Check missing employees from the incoming data placed in the Destination_Sheet sheet which is the client's format.\n''  The _Source_Sheet sheet is our destination where processed data sits,\n''  columns from Destination_Sheet are mapped to specific columns of the _Source_Sheet sheet.\n''  Copy the missing emp codes to these mapped columns.\n\n'' Support :  myfullnamewithoutspaces@gmail.com\n'' Status : Production 14-Dec-2016 10.32 PM\n'' Version : 1.0\n'' To Do : 10 is the column number on Source_Sheet where the emp code resides\n'' Convert this magic number to a generic solution\n\nDim Src_Sheet, Destination_Sheet As Worksheet\nDim Dest_Sheet_Column_Mapping, Src_Sheet_Column_Location As Range\n\nSet Src_Sheet = Sheets(\"Source_Sheet\")\nSet Destination_Sheet = Sheets(\"Destination_Sheet\")\n\nSet Dest_Sheet_Column_Mapping = Sheets(\"ControlPanel\").Range(\"A2:A60\")\nSet Src_Sheet_Column_Location = Sheets(\"ControlPanel\").Range(\"D2:D60\")\n\nDim myMap()  As Integer\nDim myRow As Variant\nReDim myMap(Dest_Sheet_Column_Mapping.Count + 1)\n\n'' Map the source_columns to the destination_columns\nFor Each myRow In Src_Sheet_Column_Location\n'' Index corresponds to Source_Sheet column\n'' Value at Index to Destination_Sheet\n'' for eg: Destination_Sheet.column = myMap(Src_Sheet.column)\n    myMap(myRow) = Dest_Sheet_Column_Mapping.Cells(myRow, 1).Value\nNext myRow\n\nDim Primary_Key_Not_Null As Collection\nSet Primary_Key_Not_Null = New Collection\nDim Master, Src_Sheet_Range, Src_Range As Range\nDim MissingEmployeeCode, LookupValue, tempVar, LookupResult  As Variant\nDim LastRow, i, Src_Range_Rows_Count, Src_Sheet_Range_Rows_Count As Integer\n\n'' This is the source of all new entries we need to search for.\nSet Src_Sheet_Range = Destination_Sheet.Range(Destination_Sheet.Cells(1, myMap(10)), Destination_Sheet.Cells(Destination_Sheet.Cells(1048576, myMap(10)).End(xlUp).Row, myMap(10)))\nSrc_Sheet_Range_Rows_Count = Src_Sheet_Range.Rows.Count\n\n'' This is the database of all previous existing entries we need to search against.\nSet Src_Range = Src_Sheet.Range(Src_Sheet.Cells(1, 10), Src_Sheet.Cells(Src_Sheet.Cells(1048576, 10).End(xlUp).Row, 10))\nSrc_Range_Rows_Count = Src_Range.Rows.Count\n\n    For i = 3 To Src_Sheet_Range_Rows_Count\n    '' Skip the blank rows and header at rows 0 to 2\n        On Error Resume Next\n        LookupValue = Destination_Sheet.Cells(i, myMap(10)).Value\n            LookupResult = Application.Match(LookupValue, Src_Range, 0)\n                If (IsError(LookupResult)) Then\n                '' To Do : Check for Duplicates within the previously added values\n                '' LookupValue becomes your missing empcode and i is the row number it's located at\n                '' The row number i becomes critical when you want to copy the same record that you have just found missing.\n                    Primary_Key_Not_Null.Add i '' LookupValue\n                    '' LookupValue is the actual missing empcode, however we need the row number for the copy operation later\n                End If\n    Next i\n\nLastRow = Src_Sheet.Cells(1048576, 10).End(xlUp).Offset(1, 0).Row\nDim FirstRow, LastColumn, j, Src_Range_Columns_Count As Integer\nFirstRow = LastRow\n\n''--Phase 3--------------------------------------------------------------------------------------------------\n'' Objective : Get and paste data for each missing empcode\nWith Src_Range\n    LastColumn = .Cells(1, 1).End(xlToRight).Column\n    LastRow = Primary_Key_Not_Null.Count + FirstRow\n    Set Src_Range = .Range(.Cells(1, 1), .Cells(LastRow, LastColumn))\n    Src_Range_Columns_Count = Src_Range.Columns.Count\n        For i = FirstRow To LastRow ''FirstRow + 3 '' Commented for Debugging\n            For j = 1 To Src_Range_Columns_Count '' 59\n            ''  The simple logic is Row Numbers and Column numbers obtained from all the above operations\n            ''  define the cells in the Src_Sheet sheet that we need this data pasted ito.\n            ''  For details please see the code below.\n            Src_Sheet.Cells(i, j).Value = Destination_Sheet.Cells(Primary_Key_Not_Null(i - FirstRow + 1), myMap(j)).Value\n            Next j\n        Next i\nEnd With\n\n''--Phase 4--------------------------------------------------------------------------------------------------\n''  Objective : For the previous range in Source_Sheet, check each cell in each column against the mapped columns in the Destination_Sheet.\n''  When you find a discrepancy: style it Bad, for the matches: style it Good,\n''  for the not found : Style it neutral.\nLastRow = FirstRow\nFirstRow = 2\nSet Src_Range = Src_Sheet.Range(Src_Sheet.Cells(2, 1), Src_Sheet.Cells(LastRow, LastColumn))\nSrc_Range.Style = \"Normal\"\n\nDim FoundRow, FoundColumn As Integer\nFoundRow = 0\nFoundColumn = 10\nDim LookupRange, LookupDatabase As Range\nSet LookupRange = Src_Sheet.Range(Src_Sheet.Cells(1, 10), Src_Sheet.Cells(LastRow, 10))\nSet LookupDatabase = Destination_Sheet.Range(Destination_Sheet.Cells(1, myMap(10)), Destination_Sheet.Cells(Src_Sheet_Range_Rows_Count, myMap(10)))\n\nDim FoundRows As Collection\nSet FoundRows = New Collection\n\n'' Locate the row of each employee code on Emp Master, push it into a collection and let the emp code be it's key\nDim LookupRange_Row_Count As Integer\nLookupRange_Row_Count = LookupRange.Rows.Count\nFor i = 2 To LookupRange_Row_Count\nOn Error Resume Next\n    FoundRow = Application.Match(LookupRange.Cells(i, 1).Value, LookupDatabase, 0)\n    If (Not IsError(FoundRow)) Then\n    '' myRow contains EmpCode which is the key, FoundRow = Where I Found it, becomes the value.\n     FoundRows.Add FoundRow, CStr(LookupRange.Cells(i, 1).Value)\n    End If\nNext i\n\nDim Src_Sheet_Value, EmpMstrValue, myEmpCodeString As String\n\nFor i = FirstRow To LastRow '' 2 to 1029\n    For j = 1 To Src_Range_Columns_Count '' 59\n    ''  Handle 4 cases.\n    ''  1.  Src_Sheet Cell Value Found and matches = Good\n    ''  2.  Src_Sheet Cell Value Found and does not match = Bad\n    ''  3.  Src_Sheet Cell Value Not Found or not in Scope and hence does not match = Neutral\n    ''  4.  Src_Sheet Cell Value is a duplicate of a value which is already checked earlier. = ??\n    Src_Sheet_Value = Src_Sheet.Cells(i, j).Value\n        myEmpCodeString = CStr(LookupRange.Cells(i, 1).Value)\n        myRow = CInt(FoundRows(myEmpCodeString))\n    EmpMstrValue = Destination_Sheet.Cells(myRow, myMap(j)).Value\n\n    ''  Implements 1.  Src_Sheet Cell Value Found and matches = Good\n\n    If Src_Sheet_Value = EmpMstrValue Then\n        Src_Sheet.Cells(i, j).Style = \"Good\"\n    Else\n        Src_Sheet.Cells(i, j).Style = \"Bad\"\n    End If\n\n    Next j\nNext i\nEnd Sub\n</code></pre></li>\n</ol>\n\n<p>I found myself in the same situation as yourself sometime back. Although the code is conceptually simple, it requires you to thoroughly define your problem in the Source, Destination, Transformation pattern.\nDo Feel free to mail me at myfullnamewithoutspaces@gmail.com. I'll assist any way I can. </p>\n"}], "owner": {"reputation": 1, "user_id": 7640967, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kcV_qYN1el4/AAAAAAAAAAI/AAAAAAAAAEs/RXQR1x4UGJA/photo.jpg?sz=128", "display_name": "M\u0101rcis D\u0101li\u0146\u0161", "link": "https://stackoverflow.com/users/7640967/m%c4%81rcis-d%c4%81li%c5%86%c5%a1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 637, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574266975, "creation_date": 1488368897, "last_edit_date": 1574266975, "question_id": 42530930, "link": "https://stackoverflow.com/questions/42530930/how-to-copy-specific-columns-in-specific-order-from-one-sheet-to-another", "title": "How to copy specific columns in specific order from one sheet to another?", "body": "<p>I need to copy date and time, code and names from a big data sheet, which contains multiple columns. Row counts may differ.</p>\n\n<p>The sequence of actions should be: </p>\n\n<ol>\n<li><p>Copy the consecutive Range from <strong>A3</strong>  which is the first active cell through to the data at column AZ - This is a manual selection.</p></li>\n<li><p>Using the VBA linked Command button start the process of copying data in next sheet:<br>\nfor example </p></li>\n</ol>\n\n<blockquote>\n<pre><code>sheet1.column B  = sheet2.column A\nsheet2.column B= \"\" \n'empty and data copy is not needed, please just generate the empty row\nsheet1.column Y = sheet2.column C\n</code></pre>\n</blockquote>\n\n<ol start=\"3\">\n<li>After the copying process is over, clear all data from sheet1</li>\n</ol>\n\n<p>My core problem is the data count for above rows differs every time. I can't find a correct sequence of commands to get these columns in the order I need from sheet1. To add to that, the formatting breaks and the time values are 'stringified', so it can't be reused.</p>\n\n<p>The generated data needs to be exported to another workbook and the copying process is critically important as I do it repeatedly. Locating and copying each column manually every time.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1488369387, "post_id": 42530656, "comment_id": 72197838, "body": "Why is line 17 (contains <code>Feb 20</code> deleted in your second group?"}, {"owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1488369943, "post_id": 42530656, "comment_id": 72198212, "body": "the dates change, but never mind. mr R3uK helped me out. but thank you anyway"}], "answers": [{"comments": [{"owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "edited": false, "score": 0, "creation_date": 1488369885, "post_id": 42531130, "comment_id": 72198183, "body": "Amazing, pure genius"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "edited": false, "score": 0, "creation_date": 1488370046, "post_id": 42531130, "comment_id": 72198267, "body": "@aj_bk : Glad I could help! ;) Just a thing for you, notice the <code>.</code> in <code>.Cells(</code> and <code>.Range(</code> it&#39;s thanks to the <code>With wS</code> and it is the easiest way to properly reference the sheet you are working in! ;)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 2, "last_activity_date": 1488369486, "creation_date": 1488369486, "answer_id": 42531130, "question_id": 42530656, "link": "https://stackoverflow.com/questions/42530656/deleting-entire-duplicate-rows-with-conditions-and/42531130#42531130", "title": "Deleting entire duplicate rows with conditions and", "body": "<p>Change <code>Sheet1</code> to the name of your sheet in <code>Set wS = ThisWorkbook.Sheets(\"Sheet1\")</code> :</p>\n\n<pre><code>Sub del_doops()\nDim RowNdx As Long\nDim RowNdx2 As Long\nDim wS As Worksheet\n\nSet wS = ThisWorkbook.Sheets(\"Sheet1\")\nWith wS\n    For RowNdx = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row To 2 Step -1\n        For RowNdx2 = RowNdx - 1 To 1 Step -1   'Begin at one above RowNdx\n            If .Cells(RowNdx, \"B\").Value = .Cells(RowNdx2, \"B\").Value And _\n                    .Cells(RowNdx, \"C\").Value = .Cells(RowNdx2, \"C\").Value And _\n                    .Cells(RowNdx, \"E\").Value = .Cells(RowNdx2, \"E\").Value And _\n                    .Cells(RowNdx, \"F\").Value &lt;&gt; .Cells(RowNdx2, \"F\").Value Then\n                If .Cells(RowNdx, \"D\").Value &lt;&gt; vbNullString Then\n                    .Rows(RowNdx).Delete\n                Else\n                    If .Cells(RowNdx2, \"D\").Value = vbNullString Then .Rows(RowNdx2).Delete\n                End If\n            End If\n        Next RowNdx2\n    Next RowNdx\nEnd With 'wS\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 46, "user_id": 7640944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d523050c873b1434d14611a1c95d96b2?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Ukken", "link": "https://stackoverflow.com/users/7640944/jacob-ukken"}, "is_accepted": false, "score": 2, "last_activity_date": 1488371903, "creation_date": 1488371903, "answer_id": 42531978, "question_id": 42530656, "link": "https://stackoverflow.com/questions/42530656/deleting-entire-duplicate-rows-with-conditions-and/42531978#42531978", "title": "Deleting entire duplicate rows with conditions and", "body": "<pre><code>Sub del_doops()\nDim RowNdx As Long\nDim RowNdx2 As Long\nFor RowNdx = Range(\"A1:f1\").End(xlDown).Row To 2 Step -1\n    For RowNdx2 = RowNdx - 1 To 1 Step -1   'Begin at one above RowNdx\n        If Cells(RowNdx, \"B\").Value = Cells(RowNdx2, \"B\").Value And _\n        Cells(RowNdx, \"C\").Value = Cells(RowNdx2, \"C\").Value And _\n        Cells(RowNdx, \"E\").Value = Cells(RowNdx2, \"E\").Value And _\n        Cells(RowNdx, \"F\").Value = Cells(RowNdx2, \"F\").Value Then\n            If Cells(RowNdx, \"D\").Value = vbNullString And _\n            Cells(RowNdx2, \"D\").Value &lt;&gt; vbNullString Then\n                Rows(RowNdx2).Delete\n            Else\n                Rows(RowNdx).Delete\n            End If\n        End If\n    Next RowNdx2\nNext RowNdx\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 42531130, "answer_count": 2, "score": 5, "last_activity_date": 1488371903, "creation_date": 1488368115, "last_edit_date": 1488369682, "question_id": 42530656, "link": "https://stackoverflow.com/questions/42530656/deleting-entire-duplicate-rows-with-conditions-and", "title": "Deleting entire duplicate rows with conditions and", "body": "<p>I have data with duplicates (column \"c\") and I want to delete the row that has numbers in column \"D\". but only for the duplicates with odd dates, as seen in the picture\n<a href=\"https://i.stack.imgur.com/1EChR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1EChR.png\" alt=\"enter image description here\"></a></p>\n\n<p>this is the code im using, but i dont know how to delete the row with data in \"D\" <strong>and</strong> is a duplicate</p>\n\n<pre><code> Sub del_doops()\n    Dim RowNdx As Long\n    Dim RowNdx2 As Long\n\n    For RowNdx = Range(\"A1:f1\").End(xlDown).Row To 2 Step -1\n        For RowNdx2 = RowNdx - 1 To 1 Step -1   'Begin at one above RowNdx\n\n            If Cells(RowNdx, \"b\").Value = Cells(RowNdx2, \"b\").Value And _\n                Cells(RowNdx, \"C\").Value = Cells(RowNdx2, \"C\").Value And _\n                Cells(RowNdx, \"E\").Value = Cells(RowNdx2, \"E\").Value And _\n                Cells(RowNdx, \"F\").Value &lt;&gt; Cells(RowNdx2, \"F\").Value Then\n                Rows(RowNdx2).Delete 'this is where i need help\n            End If\n\n        Next RowNdx2\n    Next RowNdx\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1488367516, "post_id": 42530324, "comment_id": 72196558, "body": "the code you posted works just fine. What do you have &quot;extra&quot; in your code ?"}, {"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1488367788, "post_id": 42530324, "comment_id": 72196748, "body": "The codes works fine for me too."}, {"owner": {"reputation": 55, "user_id": 7229848, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bf0740775ef2058d5fcaf755e4797f9?s=128&d=identicon&r=PG&f=1", "display_name": "FrasercT", "link": "https://stackoverflow.com/users/7229848/fraserct"}, "edited": false, "score": 0, "creation_date": 1488368510, "post_id": 42530324, "comment_id": 72197254, "body": "Hi, the code worked with the range &quot;A1:Q10&quot; but not with &quot;A1:Q1500&quot;."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1488368613, "post_id": 42530324, "comment_id": 72197327, "body": "Can you try saving to <code>xlsx</code> and try again :)?"}, {"owner": {"reputation": 55, "user_id": 7229848, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bf0740775ef2058d5fcaf755e4797f9?s=128&d=identicon&r=PG&f=1", "display_name": "FrasercT", "link": "https://stackoverflow.com/users/7229848/fraserct"}, "edited": false, "score": 0, "creation_date": 1488373511, "post_id": 42530324, "comment_id": 72200737, "body": "saving as xlsx worked, thanks!!"}], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 1727919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2e334da005840264c291d97a8b27d7?s=128&d=identicon&r=PG", "display_name": "Paras Parmar", "link": "https://stackoverflow.com/users/1727919/paras-parmar"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1488369234, "post_id": 42530843, "comment_id": 72197743, "body": "Yes, Vityata. Thank you. FrasercT may need to decide if he&#39;d like to abandon the programmatic approach in preference to the manual one."}], "tags": [], "owner": {"reputation": 187, "user_id": 1727919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2e334da005840264c291d97a8b27d7?s=128&d=identicon&r=PG", "display_name": "Paras Parmar", "link": "https://stackoverflow.com/users/1727919/paras-parmar"}, "is_accepted": false, "score": 1, "last_activity_date": 1488368985, "last_edit_date": 1488368985, "creation_date": 1488368668, "answer_id": 42530843, "question_id": 42530324, "link": "https://stackoverflow.com/questions/42530324/copying-a-range-into-a-new-spreadsheet/42530843#42530843", "title": "Copying a range into a new spreadsheet", "body": "<p>Just saw your question and ran the code. It worked fine.\nYou must be intrigued by what caused the error in the first place. Some <a href=\"https://support.microsoft.com/en-in/help/210684/copying-worksheet-programmatically-causes-run-time-error-1004-in-excel\" rel=\"nofollow noreferrer\">research</a> helped with this. </p>\n\n<p>The very simple answer to it is that a problem like this may occur when you give the workbook a defined name and then copy the worksheet several times without first saving and/or closing the workbook.</p>\n\n<p>for eg:-</p>\n\n<pre><code>For i = 1 To 10\n   wsI.Range(\"A1:Q1500\").Copy\n   wsO.Range(\"A1\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, _\n   SkipBlanks:=False, Transpose:=False\nNext i\n</code></pre>\n\n<p>Microsoft recommends, you save and close the workbook periodically while the copy process is occurring, as in the following sample code:</p>\n\n<pre><code>For i = 1 To 10\n    wsI.Worksheets(i).Copy After:=wsO.Worksheets(i)        \n    'Save, close, and reopen after every 100 iterations:\n    If i Mod 100 = 0 Then\n        wsO.Close SaveChanges:=True\n        Set wsO = Nothing\n        '' please change the path to your workbook below.\n        Set wsO = Application.Workbooks.Open(\"c:\\wsO.xls\")\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 7229848, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bf0740775ef2058d5fcaf755e4797f9?s=128&d=identicon&r=PG&f=1", "display_name": "FrasercT", "link": "https://stackoverflow.com/users/7229848/fraserct"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1488368985, "creation_date": 1488367156, "last_edit_date": 1495541357, "question_id": 42530324, "link": "https://stackoverflow.com/questions/42530324/copying-a-range-into-a-new-spreadsheet", "title": "Copying a range into a new spreadsheet", "body": "<p>I have found a solution for the basic part of this in this thread\n<a href=\"https://stackoverflow.com/questions/12340688/copying-range-and-pasting-into-new-workbook\">Copying range and pasting into new workbook</a></p>\n\n<p>However when I try to give it my range of</p>\n\n<pre><code>wsI.Range(\"A1:Q1500\").Copy\n</code></pre>\n\n<blockquote>\n  <p>I am returned \"Run-time error 1004\".</p>\n</blockquote>\n\n<p>Do I need to use some other method of copying the range?</p>\n\n<p>For ease of use here is the full slightly edited code from the post I linked</p>\n\n<pre><code>Option Explicit\n\nSub Sample()\nDim wbI As Workbook, wbO As Workbook\nDim wsI As Worksheet, wsO As Worksheet\n\n'~~&gt; Source/Input Workbook\nSet wbI = ThisWorkbook\n'~~&gt; Set the relevant sheet from where you want to copy\nSet wsI = wbI.Sheets(\"SICAV\")\n\n'~~&gt; Destination/Output Workbook\nSet wbO = Workbooks.Add\n\nWith wbO\n    '~~&gt; Set the relevant sheet to where you want to paste\n    Set wsO = wbO.Sheets(\"Sheet1\")\n\n    '~~&gt;. Save the file\n    .SaveAs Filename:=\"Pictay.xls\", FileFormat:=56\n\n    '~~&gt; Copy the range\n    wsI.Range(\"A1:Q10\").Copy\n\n    '~~&gt; Paste it in say Cell A1. Change as applicable\n    wsO.Range(\"A1\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "output"], "answers": [{"tags": [], "owner": {"reputation": 73, "user_id": 7640152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adabb5cd029a32945173778cb36e81b9?s=128&d=identicon&r=PG&f=1", "display_name": "user7640152", "link": "https://stackoverflow.com/users/7640152/user7640152"}, "is_accepted": false, "score": 1, "last_activity_date": 1488367112, "creation_date": 1488367112, "answer_id": 42530313, "question_id": 42530181, "link": "https://stackoverflow.com/questions/42530181/change-output-in-a-vba-from-activesheet-to-a-new-document-file/42530313#42530313", "title": "Change output in a VBA from Activesheet to a new document (file)", "body": "<p>Just create a new workbook :</p>\n\n<pre><code>Dim wB As Excel.Workbook\n\nSet RST = New ADODB.Recordset\nRST.Open Sql, mCON, adOpenForwardOnly, adLockReadOnly, adCmdText\nSet wB = Workbooks.Add\nlRow = 6\n\nDo Until RST.EOF = True\n    Application.StatusBar = \"Getting data to row: \" &amp; lRow\n\n    For n = 0 To (RST.Fields.Count - 1)\n        If Not IsNull(RST(n)) Then wB.Sheets(1).Cells(lRow, n + 1) = RST(n)\n    Next n\n    RST.MoveNext\n    lRow = lRow + 1\nLoop\n\nwB.Sheets(1).Range(\"B5\").Select\n\nApplication.ScreenUpdating = True\nExit Sub\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 1365781, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0bcd452769f30d7c2aec6f9d14ce2e81?s=128&d=identicon&r=PG", "display_name": "Frank", "link": "https://stackoverflow.com/users/1365781/frank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1488367112, "creation_date": 1488366711, "question_id": 42530181, "link": "https://stackoverflow.com/questions/42530181/change-output-in-a-vba-from-activesheet-to-a-new-document-file", "title": "Change output in a VBA from Activesheet to a new document (file)", "body": "<p>I have excel-file (VBA) where i want the output in a separate file but i struggle to make it append.\nThe output should be everything below row6 in the worksheet.</p>\n\n<pre><code>Set RST = New ADODB.Recordset\nRST.Open SQL, mCON, adOpenForwardOnly, adLockReadOnly, adCmdText\n\nDo Until RST.EOF = True\n    Application.StatusBar = \"Getting data to row: \" &amp; lRow\n\n    For n = 0 To (RST.Fields.Count - 1)\n        If Not IsNull(RST(n)) Then ActiveSheet.Cells(lRow, n + 1) = RST(n)\n\n    Next\n\n    RST.MoveNext\n    lRow = lRow + 1\nLoop\n\nActiveSheet.Range(\"B5\").Select\n\nApplication.ScreenUpdating = True\n\nExit Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 19146, "user_id": 2796058, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2Wlek.jpg?s=128&g=1", "display_name": "Mark Wragg", "link": "https://stackoverflow.com/users/2796058/mark-wragg"}, "edited": false, "score": 0, "creation_date": 1488366534, "post_id": 42530023, "comment_id": 72195906, "body": "Your question is unclear regarding what value you want to calculate."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7234562, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1017514078364050/picture?type=large", "display_name": "Anu", "link": "https://stackoverflow.com/users/7234562/anu"}, "edited": false, "score": 0, "creation_date": 1488376603, "post_id": 42530094, "comment_id": 72202885, "body": "in cell iam getting #VALUE!"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 11, "user_id": 7234562, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1017514078364050/picture?type=large", "display_name": "Anu", "link": "https://stackoverflow.com/users/7234562/anu"}, "edited": false, "score": 0, "creation_date": 1488376803, "post_id": 42530094, "comment_id": 72203031, "body": "@AnushaVinod, I updated the formula to make it easier for you to use"}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": false, "score": 0, "last_activity_date": 1488376760, "last_edit_date": 1488376760, "creation_date": 1488366476, "answer_id": 42530094, "question_id": 42530023, "link": "https://stackoverflow.com/questions/42530023/max-number-from-excel-column-of-type-general/42530094#42530094", "title": "MAX number from excel column of type general", "body": "<p>You only need to make a small change, namely placing <code>--</code> before the range and use <code>SUMPRODUCT</code> to deal with the array:</p>\n\n<pre><code>=SUMPRODUCT(MAX(--B3:B99999))+1\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7234562, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1017514078364050/picture?type=large", "display_name": "Anu", "link": "https://stackoverflow.com/users/7234562/anu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1488376760, "creation_date": 1488366271, "last_edit_date": 1531161705, "question_id": 42530023, "link": "https://stackoverflow.com/questions/42530023/max-number-from-excel-column-of-type-general", "title": "MAX number from excel column of type general", "body": "<p>My setup looks like <a href=\"https://i.stack.imgur.com/C2jNS.png\" rel=\"nofollow noreferrer\">this</a></p>\n\n<pre><code>=MAX(B3:B99999)+1\n</code></pre>\n\n<p>This works if the cell values are type general. However, if <code>B3:B99999</code> are strings how can you calculate the value?</p>\n"}, {"tags": ["vba", "excel", "web-scraping"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1488374450, "post_id": 42530012, "comment_id": 72201384, "body": "<code>if nof = 20 then exit sub</code> Would it work like this?"}, {"owner": {"reputation": 29, "user_id": 7320622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03818250c688138185a951631b171f58?s=128&d=identicon&r=PG&f=1", "display_name": "eros", "link": "https://stackoverflow.com/users/7320622/eros"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1488423616, "post_id": 42530012, "comment_id": 72227601, "body": "error debug in those line: If Nof = 20 Then Exit Sub"}], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 7320622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03818250c688138185a951631b171f58?s=128&d=identicon&r=PG&f=1", "display_name": "eros", "link": "https://stackoverflow.com/users/7320622/eros"}, "is_accepted": false, "score": 0, "last_activity_date": 1488424343, "creation_date": 1488424343, "answer_id": 42546148, "question_id": 42530012, "link": "https://stackoverflow.com/questions/42530012/vba-html-table-scraping-specific-raw-from-complex-table/42546148#42546148", "title": "VBA HTML Table Scraping - specific raw from complex table", "body": "<p>if i try loop, example in first block bellow, the result extract is stack in Sheet4.Range(\"C\" &amp; i) until the last row, and 19 rows in excel sheet is remain empty.</p>\n\n<pre><code>Dim j As Integer, k As Integer\nFor j = 0 To 19\n    For k = 2 To 97 Step 5\n\nNof = \"ERRORHERE\"\nOn Error Resume Next\nNof = Trim(doc.getElementsByClassName(\"main-row table-row\")(j).getElementsByTagName(\"td\")(3).getElementsByTagName(\"a\")(1).innerText)\nOn Error GoTo 0\nIf Nof = \"ERRORHERE\" Then\nSheet4.Range(\"C\" &amp; i).Value = \"Wrong Elements\"\nElse\nSheet4.Range(\"C\" &amp; i).Value = Nof\nEnd If\nApplication.Wait (Now + TimeValue(\"00:00:1\"))\n\nNof = \"ERRORHERE\"\nOn Error Resume Next\nNof = Trim(doc.getElementsByClassName(\"main-row table-row\")(j).getElementsByTagName(\"td\")(3).getElementsByTagName(\"a\")(2).innerText)\nOn Error GoTo 0\nIf Nof = \"ERRORHERE\" Then\nSheet4.Range(\"E\" &amp; i).Value = \"Wrong Elements\"\nElse\nSheet4.Range(\"E\" &amp; i).Value = Nof\nEnd If\nApplication.Wait (Now + TimeValue(\"00:00:1\"))\n\ndoc.getElementsByClassName(\"app-name\")(k).Click '&lt;&lt;----click the target game in current row\n\n    Next k\nNext j\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 7320622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03818250c688138185a951631b171f58?s=128&d=identicon&r=PG&f=1", "display_name": "eros", "link": "https://stackoverflow.com/users/7320622/eros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 321, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488424343, "creation_date": 1488366227, "last_edit_date": 1488372484, "question_id": 42530012, "link": "https://stackoverflow.com/questions/42530012/vba-html-table-scraping-specific-raw-from-complex-table", "title": "VBA HTML Table Scraping - specific raw from complex table", "body": "<p>I've created the following Module to scrape a top 20 grossing game from specific column (grossing column) in table html below (need login):\n<a href=\"https://www.appannie.com/apps/google-play/top-chart/united-states/game/?device=&amp;date=2017-03-01&amp;feed=All&amp;rank_sorting_type=rank&amp;page_number=0&amp;page_size=100\" rel=\"nofollow noreferrer\">https://www.appannie.com/apps/google-play/top-chart/united-states/game/?device=&amp;date=2017-03-01&amp;feed=All&amp;rank_sorting_type=rank&amp;page_number=0&amp;page_size=100</a></p>\n\n<p>The specific value is nested within the following code:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Y5aoN.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Y5aoN.jpg\" alt=\"table html\"></a></p>\n\n<p>The below VBA code is my attempt at scraping. \nDoes anyone know to looping my code till count of raw table is 20, Need advice from you guys.</p>\n\n<pre><code>Sub TopChartGoogle()\n\nDim IE As New InternetExplorer\nDim tickername As String\nDim doc As HTMLDocument\nDim Nof As String\n\nDim i As Integer\n\nFor i = 8 To 27\ntickername = Sheet4.Range(\"A\" &amp; i).Value\n\n\nIE.Visible = True\nIE.navigate \"https://www.appannie.com/apps/google-play/top-chart/united-states/game/\" &amp; tickername\n\nDo\n    DoEvents\n    Loop Until IE.readyState = READYSTATE_COMPLETE\nApplication.Wait (Now + TimeValue(\"00:00:5\"))\nSet doc = IE.document\n\n\nNof = \"ERRORHERE\"\nOn Error Resume Next\nNof = Trim(doc.getElementsByClassName(\"main-row table-row\")(0).getElementsByTagName(\"td\")(3).getElementsByTagName(\"a\")(1).innerText)\nOn Error GoTo 0\nIf Nof = \"ERRORHERE\" Then\nSheet4.Range(\"C\" &amp; i).Value = \"Wrong Elements\"\nElse\nSheet4.Range(\"C\" &amp; i).Value = Nof\nEnd If\nApplication.Wait (Now + TimeValue(\"00:00:1\"))\n\nNof = \"ERRORHERE\"\nOn Error Resume Next\nNof = Trim(doc.getElementsByClassName(\"main-row table-row\")(0).getElementsByTagName(\"td\")(3).getElementsByTagName(\"a\")(2).innerText)\nOn Error GoTo 0\nIf Nof = \"ERRORHERE\" Then\nSheet4.Range(\"E\" &amp; i).Value = \"Wrong Elements\"\nElse\nSheet4.Range(\"E\" &amp; i).Value = Nof\nEnd If\nApplication.Wait (Now + TimeValue(\"00:00:1\"))\n\n\ndoc.getElementsByClassName(\"app-name\")(2).Click '&lt;&lt;----click the game name\n\n'-----------------------------Genre Game-------------------------------\nApplication.Wait (Now + TimeValue(\"00:00:5\"))\nNof = \"ERRORHERE\"\nOn Error Resume Next\nNof = Trim(doc.getElementsByClassName(\"app-box-content\")(5).getElementsByTagName(\"p\")(2).innerText)\nOn Error GoTo 0\nIf Nof = \"ERRORHERE\" Then\nSheet4.Range(\"D\" &amp; i).Value = \"Wrong Elements\"\nElse\nSheet4.Range(\"D\" &amp; i).Value = Nof\nEnd If\nApplication.Wait (Now + TimeValue(\"00:00:2\"))\n'------------------------Average Star-------------------------------------\nNof = \"ERRORHERE\"\nOn Error Resume Next\nNof = Trim(doc.getElementsByClassName(\"rating-brief\")(0).getElementsByTagName(\"strong\")(1).innerText)\nOn Error GoTo 0\nIf Nof = \"ERRORHERE\" Then\nSheet4.Range(\"F\" &amp; i).Value = \"Wrong Elements\"\nElse\nSheet4.Range(\"F\" &amp; i).Value = Nof\nEnd If\nApplication.Wait (Now + TimeValue(\"00:00:2\"))\n'------------------------Star 5------------------------------------------\nNof = \"ERRORHERE\"\nOn Error Resume Next\nNof = Trim(doc.getElementsByClassName(\"table-wrapper\")(0).getElementsByTagName(\"tr\")(0).getElementsByTagName(\"td\")(2).innerText)\nOn Error GoTo 0\nIf Nof = \"ERRORHERE\" Then\nSheet4.Range(\"G\" &amp; i).Value = \"Wrong Elements\"\nElse\nSheet4.Range(\"G\" &amp; i).Value = Nof\nEnd If\nApplication.Wait (Now + TimeValue(\"00:00:2\"))\n'-----------------------------Star 4------------------------------------------\nNof = \"ERRORHERE\"\nOn Error Resume Next\nNof = Trim(doc.getElementsByClassName(\"table-wrapper\")(0).getElementsByTagName(\"tr\")(1).getElementsByTagName(\"td\")(2).innerText)\nOn Error GoTo 0\nIf Nof = \"ERRORHERE\" Then\nSheet4.Range(\"H\" &amp; i).Value = \"Wrong Elements\"\nElse\nSheet4.Range(\"H\" &amp; i).Value = Nof\nEnd If\nApplication.Wait (Now + TimeValue(\"00:00:2\"))\n'--------------------------Star 3-------------------------------------------\nNof = \"ERRORHERE\"\nOn Error Resume Next\nNof = Trim(doc.getElementsByClassName(\"table-wrapper\")(0).getElementsByTagName(\"tr\")(2).getElementsByTagName(\"td\")(2).innerText)\nOn Error GoTo 0\nIf Nof = \"ERRORHERE\" Then\nSheet4.Range(\"I\" &amp; i).Value = \"Wrong Elements\"\nElse\nSheet4.Range(\"I\" &amp; i).Value = Nof\nEnd If\nApplication.Wait (Now + TimeValue(\"00:00:2\"))\n'----------------------------Star 2-------------------------------------------\nNof = \"ERRORHERE\"\nOn Error Resume Next\nNof = Trim(doc.getElementsByClassName(\"table-wrapper\")(0).getElementsByTagName(\"tr\")(3).getElementsByTagName(\"td\")(2).innerText)\nOn Error GoTo 0\nIf Nof = \"ERRORHERE\" Then\nSheet4.Range(\"J\" &amp; i).Value = \"Wrong Elements\"\nElse\nSheet4.Range(\"J\" &amp; i).Value = Nof\nEnd If\nApplication.Wait (Now + TimeValue(\"00:00:2\"))\n'----------------------------Star 1-------------------------------------------\nNof = \"ERRORHERE\"\nOn Error Resume Next\nNof = Trim(doc.getElementsByClassName(\"table-wrapper\")(0).getElementsByTagName(\"tr\")(4).getElementsByTagName(\"td\")(2).innerText)\nOn Error GoTo 0\nIf Nof = \"ERRORHERE\" Then\nSheet4.Range(\"K\" &amp; i).Value = \"Wrong Elements\"\nElse\nSheet4.Range(\"K\" &amp; i).Value = Nof\nEnd If\nApplication.Wait (Now + TimeValue(\"00:00:2\"))\n\nIE.Quit\n\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "internet-explorer", "error-handling"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 5445378, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/99b5a47de33d12de37d134069d74abd6?s=128&d=identicon&r=PG&f=1", "display_name": "Aron Valencio", "link": "https://stackoverflow.com/users/5445378/aron-valencio"}, "edited": false, "score": 0, "creation_date": 1488377089, "post_id": 42531092, "comment_id": 72203240, "body": "This is brillaint! Thanks a lot for sharing your knowledge, Robin (:"}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 1, "last_activity_date": 1488369358, "creation_date": 1488369358, "answer_id": 42531092, "question_id": 42529997, "link": "https://stackoverflow.com/questions/42529997/on-error-not-working-with-ie-automation/42531092#42531092", "title": "On Error not working with IE automation", "body": "<p>If no elements are returned by using <code>getElementsByClassName</code> then you can test the <code>length</code> property and it will be 0. This is preferable to trying to skip the error generated if you try and access the 0th element because you assumed you would get a positive result.</p>\n\n<p>So you can try this:</p>\n\n<pre><code>Set doc = IE.document\n\nDim objElements As Object\nSet objElements = doc.getElementsByClassName(\"items-in-stock align-left\")\n\nIf objElements.length &gt; 0 Then\n    ' some elements are returned - get the text from the first one\n    onl = CStr(objElements(0).innerText)\nElse\n    ' nothing returned - lets handle it gracefully with no error\n    MsgBox \"No elements with that class!\"\n    '... prepare to exit \nEnd If\n\n' do stuff with onl\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 5445378, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/99b5a47de33d12de37d134069d74abd6?s=128&d=identicon&r=PG&f=1", "display_name": "Aron Valencio", "link": "https://stackoverflow.com/users/5445378/aron-valencio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 42531092, "answer_count": 1, "score": 1, "last_activity_date": 1488369476, "creation_date": 1488366170, "last_edit_date": 1488369476, "question_id": 42529997, "link": "https://stackoverflow.com/questions/42529997/on-error-not-working-with-ie-automation", "title": "On Error not working with IE automation", "body": "<p>My code is getting information from a website, but at some cases the HTML code with the information just isn't there, so I'm using <code>On Error</code> to handle it.</p>\n\n<p>As you'll see in the code I'm runing through a list and getting information for each row (about 700 of them). At first the error was occuring at the 10th row, then I added <code>On Error GoTo 0</code>. After that it started to be thrown at row 13.</p>\n\n<p>My configuration is already set to <em>Break on Unhandeled Errors</em>.</p>\n\n<p>The run-time error number is:</p>\n\n<blockquote>\n  <p>91: Object variable or With block variable not set. </p>\n</blockquote>\n\n<p>It is happening at the line between \"** **\"</p>\n\n<pre><code>Sub GetData_DK()\n\n    Dim IE As New InternetExplorer\n    Dim URL As String\n    Dim doc As HTMLDocument 'variable for document or data which need to be extracted out of webpage\n    Dim onl As String\n    Dim sto As String\n    Dim pri As String\n    FinalRow = tme.Cells(Rows.Count, \"G\").End(xlUp).Row\n\n    Dim hyper As Workbook\n    Set hyper = Workbooks.Open(\"path\")\n    FinalRowH = hyper.Sheets(\"tme\").Cells(Rows.Count, \"A\").End(xlUp).Row\n    ThisWorkbook.Activate\n\n    For a = 5 To FinalRow\n\n        onl = \"\"\n        sto = \"\"\n        pri = \"\"\n\n        For b = 5 To FinalRowH\n            If (ThisWorkbook.Sheets(\"tme\").Cells(a, 7).Value = hyper.Sheets(\"tme\").Cells(b, 1).Value) Then\n                URL = hyper.Sheets(\"tme\").Cells(b, 3).Value\n                Exit For\n            End If\n        Next b\n\n        IE.navigate URL\n        IE.Visible = True\n\n        Do\n            If IE.readyState = READYSTATE_COMPLETE Then\n                If IE.document.readyState = \"complete\" Then Exit Do\n            End If\n            Application.Wait DateAdd(\"s\", 1, Now)\n        Loop\n        'Application.Wait (Now() + TimeValue(\"00:00:006\")) ' For internal page refresh or loading\n\n\n        Set doc = IE.document\n\n        On Error Resume Next\n        'gets HTLM class containing the value\n        **onl = CStr(doc.getElementsByClassName(\"items-in-stock align-left\")(0).innerText)**\n        On Error GoTo 0\n        If (onl = Chr(160) Or onl = \" \" Or onl = \"   \" Or onl = \"\" Or onl = vbNullString Or Left(onl, 9) = \"Forventet\") Then\n            Cells(a, 8).Value = 0\n        Else\n            Cells(a, 8).Value = 1\n        End If\n\n        On Error GoTo price\n        'repeats the process for stores\n        sto = CStr(doc.getElementsByClassName(\"open-cas-tab\")(0).innerText)\n        sto = Left(sto, InStr(sto, \" \") - 1)\n        Cells(a, 9).Value = sto\n\nprice:\n        On Error GoTo 0\n\n        On Error Resume Next\n        'repeats the process for price\n        pri = CInt(CStr(doc.getElementsByClassName(\"product-price-container\")(0).innerText))\n        Cells(a, 10).Value = pri\n        On Error GoTo 0\n    Next a\nEnd Sub\n</code></pre>\n\n<p>Please let me know what I'm doing wrong (:</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 404, "user_id": 4916993, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh3.googleusercontent.com/-RKGsQJH3P1U/AAAAAAAAAAI/AAAAAAAAAEg/TBqBqMyLQeY/photo.jpg?sz=128", "display_name": "Miller86", "link": "https://stackoverflow.com/users/4916993/miller86"}, "edited": false, "score": 0, "creation_date": 1488365462, "post_id": 42529690, "comment_id": 72195175, "body": "ok, so just to confirm the theory - this looks to see if &quot;sPathspec&quot; ends with \\ and if not it adds a \\?"}, {"owner": {"reputation": 73, "user_id": 7640152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adabb5cd029a32945173778cb36e81b9?s=128&d=identicon&r=PG&f=1", "display_name": "user7640152", "link": "https://stackoverflow.com/users/7640152/user7640152"}, "reply_to_user": {"reputation": 404, "user_id": 4916993, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh3.googleusercontent.com/-RKGsQJH3P1U/AAAAAAAAAAI/AAAAAAAAAEg/TBqBqMyLQeY/photo.jpg?sz=128", "display_name": "Miller86", "link": "https://stackoverflow.com/users/4916993/miller86"}, "edited": false, "score": 0, "creation_date": 1488365553, "post_id": 42529690, "comment_id": 72195248, "body": "@Miller86 : Yup, that&#39;s it! ;)"}, {"owner": {"reputation": 404, "user_id": 4916993, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh3.googleusercontent.com/-RKGsQJH3P1U/AAAAAAAAAAI/AAAAAAAAAEg/TBqBqMyLQeY/photo.jpg?sz=128", "display_name": "Miller86", "link": "https://stackoverflow.com/users/4916993/miller86"}, "edited": false, "score": 0, "creation_date": 1488365768, "post_id": 42529690, "comment_id": 72195390, "body": "Legendary. That works! You sir/madam, are a gentleman and a scholar, and I take my hat off to you."}, {"owner": {"reputation": 688, "user_id": 5726827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f9bea4b67d779a3ecc212123b1d0256?s=128&d=identicon&r=PG&f=1", "display_name": "David Glickman", "link": "https://stackoverflow.com/users/5726827/david-glickman"}, "edited": false, "score": 1, "creation_date": 1488366154, "post_id": 42529690, "comment_id": 72195661, "body": "If an answer works for you, please mark it as accepted by clicking the check mark next to it. Also, can madam be a gentleman? ;)"}, {"owner": {"reputation": 73, "user_id": 7640152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adabb5cd029a32945173778cb36e81b9?s=128&d=identicon&r=PG&f=1", "display_name": "user7640152", "link": "https://stackoverflow.com/users/7640152/user7640152"}, "reply_to_user": {"reputation": 404, "user_id": 4916993, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh3.googleusercontent.com/-RKGsQJH3P1U/AAAAAAAAAAI/AAAAAAAAAEg/TBqBqMyLQeY/photo.jpg?sz=128", "display_name": "Miller86", "link": "https://stackoverflow.com/users/4916993/miller86"}, "edited": false, "score": 0, "creation_date": 1488366332, "post_id": 42529690, "comment_id": 72195782, "body": "@Miller86 : If it indeed solved your issue, please accept the answer! ;)"}, {"owner": {"reputation": 688, "user_id": 5726827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f9bea4b67d779a3ecc212123b1d0256?s=128&d=identicon&r=PG&f=1", "display_name": "David Glickman", "link": "https://stackoverflow.com/users/5726827/david-glickman"}, "edited": false, "score": 0, "creation_date": 1488366401, "post_id": 42529690, "comment_id": 72195821, "body": "@user7640152 doesn&#39;t a comment always poke the previous commenter?"}, {"owner": {"reputation": 404, "user_id": 4916993, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh3.googleusercontent.com/-RKGsQJH3P1U/AAAAAAAAAAI/AAAAAAAAAEg/TBqBqMyLQeY/photo.jpg?sz=128", "display_name": "Miller86", "link": "https://stackoverflow.com/users/4916993/miller86"}, "edited": false, "score": 0, "creation_date": 1488366584, "post_id": 42529690, "comment_id": 72195933, "body": "I was waiting for the tickmark to become available. Its available now so its accepted. Thanks again :)"}, {"owner": {"reputation": 73, "user_id": 7640152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adabb5cd029a32945173778cb36e81b9?s=128&d=identicon&r=PG&f=1", "display_name": "user7640152", "link": "https://stackoverflow.com/users/7640152/user7640152"}, "reply_to_user": {"reputation": 688, "user_id": 5726827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f9bea4b67d779a3ecc212123b1d0256?s=128&d=identicon&r=PG&f=1", "display_name": "David Glickman", "link": "https://stackoverflow.com/users/5726827/david-glickman"}, "edited": false, "score": 0, "creation_date": 1488366755, "post_id": 42529690, "comment_id": 72196052, "body": "@DavidGlickman : Not sure, post author will always be. But as for previous commenter, it&#39;s not clearly said : <a href=\"http://stackoverflow.com/editing-help#comment-formatting\">stackoverflow.com/editing-help#comment-formatting</a>"}], "tags": [], "owner": {"reputation": 73, "user_id": 7640152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adabb5cd029a32945173778cb36e81b9?s=128&d=identicon&r=PG&f=1", "display_name": "user7640152", "link": "https://stackoverflow.com/users/7640152/user7640152"}, "is_accepted": true, "score": 1, "last_activity_date": 1488365532, "last_edit_date": 1488365532, "creation_date": 1488365361, "answer_id": 42529690, "question_id": 42529607, "link": "https://stackoverflow.com/questions/42529607/password-protection-macro-wont-work/42529690#42529690", "title": "Password Protection macro won&#39;t work", "body": "<p>You were just missing the last <code>\\</code> in your path, I've added a line to force the inputed path finish with it.</p>\n\n<p>Also, no need to try to close the initial workbook after the <code>SaveAs</code> because it'd have changed.</p>\n\n<pre><code>Sub ProtectAll()\nDim wBk As Workbook\nDim sFileSpec As String\nDim sPathSpec As String\nDim sFoundFile As String\nDim sPassword As String\n\nsPathSpec = InputBox(\"Path to use\", \"Path\")\nIf Right(sPathSpec, 1) &lt;&gt; \"\\\" Then sPathSpec = sPathSpec &amp; \"\\\"\nsPassword = InputBox(\"Enter Password Below\", \"Password\")\nsFileSpec = \"*.xlsx\"\n\nsFoundFile = Dir(sPathSpec &amp; sFileSpec)\nDo While sFoundFile &lt;&gt; vbNullString\n    Set wBk = Workbooks.Open(sPathSpec &amp; sFoundFile)\n    With wBk\n        Application.DisplayAlerts = False\n        .SaveAs filename:=.FullName, Password:=sPassword\n        Application.DisplayAlerts = True\n        .Close\n    End With\n    Set wBk = Nothing\n    sFoundFile = Dir\nLoop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 404, "user_id": 4916993, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh3.googleusercontent.com/-RKGsQJH3P1U/AAAAAAAAAAI/AAAAAAAAAEg/TBqBqMyLQeY/photo.jpg?sz=128", "display_name": "Miller86", "link": "https://stackoverflow.com/users/4916993/miller86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 1, "accepted_answer_id": 42529690, "answer_count": 1, "score": 1, "last_activity_date": 1488365532, "creation_date": 1488365116, "last_edit_date": 1488365137, "question_id": 42529607, "link": "https://stackoverflow.com/questions/42529607/password-protection-macro-wont-work", "title": "Password Protection macro won&#39;t work", "body": "<p>I'm trying to create a macro that will password protect a bunch of excel files at once. I've managed to work out (read \"Frankenstein-from-various-sources-and-old-code\") the following that should request a file path and a password to use, then cycle through each file in the folder and password protect them. Unfortunately, it requests the path and password but it then immediately ends without password protecting the files. My vba is basically all rust at this point, so I'm unfortunately struggling to work out why it isn't working.</p>\n\n<p>And yes, I know this isn't best practice. Unfortunately I have several hundred documents to password protect, and no time to do this with.</p>\n\n<p>Does anyone have any ideas?</p>\n\n<p>CODE:</p>\n\n<pre><code>Sub ProtectAll()\nDim wBk As Workbook\nDim sFileSpec As String\nDim sPathSpec As String\nDim sFoundFile As String\nDim sPassword As String\n\nsPathSpec = InputBox(\"Path to use\", \"Path\")\nsPassword = InputBox(\"Enter Password Below\", \"Password\")\nsFileSpec = \"*.xlsx\"\n\nsFoundFile = Dir(sPathSpec &amp; sFileSpec)\nDo While sFoundFile &lt;&gt; \"\"\n    Set wBk = Workbooks.Open(sPathSpec &amp; sFoundFile)\n    With wBk\n        Application.DisplayAlerts = False\n        wBk.SaveAs Filename:=.FullName, _\n          Password:=sPassword\n        Application.DisplayAlerts = True\n    End With\n    Set wBk = Nothing\n    Workbooks(sFoundFile).Close False\n    sFoundFile = Dir\nLoop\nEnd Sub\n</code></pre>\n\n<p>I'm using path</p>\n\n<pre><code>C:\\Users\\ [MYNAME] \\Desktop\\Password Test\n</code></pre>\n\n<p>and password </p>\n\n<pre><code>TEST\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4534, "user_id": 885922, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2971dd5c919991b08f12849961bd4f0a?s=128&d=identicon&r=PG", "display_name": "xlm", "link": "https://stackoverflow.com/users/885922/xlm"}, "edited": false, "score": 0, "creation_date": 1488364555, "post_id": 42528793, "comment_id": 72194543, "body": "What did you try? Edit your Q (don&#39;t add it as a comment) and add your code."}, {"owner": {"reputation": 688, "user_id": 5726827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f9bea4b67d779a3ecc212123b1d0256?s=128&d=identicon&r=PG&f=1", "display_name": "David Glickman", "link": "https://stackoverflow.com/users/5726827/david-glickman"}, "edited": false, "score": 0, "creation_date": 1488366227, "post_id": 42528793, "comment_id": 72195712, "body": "Please provide an example of what you have, what you want and what you&#39;ve tried."}], "owner": {"reputation": 1, "user_id": 7640258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbfa47aec60ef9434bcd4c9676f9310b?s=128&d=identicon&r=PG&f=1", "display_name": "passer", "link": "https://stackoverflow.com/users/7640258/passer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1488362963, "creation_date": 1488362963, "question_id": 42528793, "link": "https://stackoverflow.com/questions/42528793/vba-to-move-multiple-rows-of-data-per-unique-id-into-set-number-of-columns", "title": "vba to move multiple rows of data per unique id into set number of columns", "body": "<p>I'm hoping someone can help with this query please. I have multiple rows of data per employee and I need to move the data onto one row per employee.</p>\n\n<p>Data looks like this: There may be up to 4 rows of data per employee but not always: </p>\n\n<p>person id, person name, location, start date, end date, amount 1, amount 2, total</p>\n\n<p>I need to get each row of data onto one row, can anyone suggest best way to do this please?</p>\n"}, {"tags": ["vba", "internet-explorer", "createobject"], "answers": [{"tags": [], "owner": {"reputation": 330, "user_id": 3759031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2f11df84e9d8de2c7e2cd3cca37f5c7?s=128&d=identicon&r=PG&f=1", "display_name": "Vijayan Kani", "link": "https://stackoverflow.com/users/3759031/vijayan-kani"}, "is_accepted": false, "score": 0, "last_activity_date": 1488374231, "creation_date": 1488374231, "answer_id": 42532834, "question_id": 42528655, "link": "https://stackoverflow.com/questions/42528655/vba-for-connecting-already-opned-ie-window/42532834#42532834", "title": "VBA for Connecting already opned IE window", "body": "<p>Two things -</p>\n\n<ol>\n<li>Declare 'ie' in your code.</li>\n<li><p>IE_Count</p>\n\n<p><code>IE_count = objShell.Windows.Count</code> should be <code>IE_count =\nobjShell.Windows().Count</code>. Please refer -\n<a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb773969(v=vs.85).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/windows/desktop/bb773969(v=vs.85).aspx</a></p></li>\n</ol>\n\n<p>Hope correcting these will get your code working</p>\n"}], "owner": {"reputation": 1, "user_id": 5369755, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c58b9eed96e308bc49b9d16e98aa7f9f?s=128&d=identicon&r=PG&f=1", "display_name": "Kavitha", "link": "https://stackoverflow.com/users/5369755/kavitha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 437, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488523875, "creation_date": 1488362547, "last_edit_date": 1488523875, "question_id": 42528655, "link": "https://stackoverflow.com/questions/42528655/vba-for-connecting-already-opned-ie-window", "title": "VBA for Connecting already opned IE window", "body": "<p>I'm trying to connect to already opened IE window, but I have some problem at 2nd line </p>\n\n<blockquote>\n  <p><code>Run time error 429 ActiveX Component can't create object</code></p>\n</blockquote>\n\n<p>I have added references also still not able to access the IE window. Below is the code.</p>\n\n<pre><code>Sub A()\n  Set objShell = CreateObject(\"Shell.Application\")\n  IE_count = objShell.Windows.Count\n  For x = 0 To (IE_count - 1)\n     my_url = objShell.Windows(x).Document.Location\n    my_title = objShell.Windows(x).Document.Title\n\n    if my_title Like \"Put your webpage title here\" &amp; \"*\" Then \n        Set ie = objShell.Windows(x)\n        Exit For\n    Else\n    End If\n  Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 2, "creation_date": 1488363004, "post_id": 42528479, "comment_id": 72193380, "body": "Why are you using ado when ms access works best with dao? Why are you not following the directions in your previous question?"}, {"owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "edited": false, "score": 0, "creation_date": 1488380211, "post_id": 42528479, "comment_id": 72205489, "body": "Why work hard for what you get for free?"}], "answers": [{"tags": [], "owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "is_accepted": false, "score": 8, "last_activity_date": 1488380163, "last_edit_date": 1488380163, "creation_date": 1488379819, "answer_id": 42534832, "question_id": 42528479, "link": "https://stackoverflow.com/questions/42528479/access-copy-result-of-query-into-table-with-vba/42534832#42534832", "title": "ACCESS: copy result of query into table with VBA", "body": "<p>One line of code:</p>\n\n<pre><code>CurrentDB.Execute \"Select myquery.* Into target_table From myquery\"\n</code></pre>\n\n<p>Will create a table named <code>target_table</code> containing the result set of <code>myquery</code>.</p>\n\n<pre><code>CurrentDB.Execute \"Insert Into target_table Select myquery.* From myquery\"\n</code></pre>\n\n<p>Will insert the result set of <code>myquery</code> to an already existing table named <code>target_table</code>, with the same structure.</p>\n"}], "owner": {"reputation": 31, "user_id": 7573475, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/b6e51d91b128f242504ae78ed27b9b24?s=128&d=identicon&r=PG&f=1", "display_name": "MES", "link": "https://stackoverflow.com/users/7573475/mes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7789, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1488380163, "creation_date": 1488361978, "last_edit_date": 1488369010, "question_id": 42528479, "link": "https://stackoverflow.com/questions/42528479/access-copy-result-of-query-into-table-with-vba", "title": "ACCESS: copy result of query into table with VBA", "body": "<p>i want to copy the result of my queries into a table.</p>\n\n<p>i tried this:</p>\n\n<pre><code>Function queryintotable()\n\nDim rs As New ADODB.Recordset\n\nDoCmd.SetWarnings False\n\nrs.CursorLocation = adUseClient    \nrs.Open \"target_table\", CurrentProject.Connection\nrs.Sort = \"Retail_ID ASC\"\n\nDo Until rs.EOF = True\n    DoCmd.CopyObject , \"myquery\", acQuery, \"target_table\"    \n    rs.MoveNext\nLoop\n\nrs.Close\n\nDoCmd.SetWarnings True\nMsgBox (\"Finish! \" &amp; Time)\n\nEnd Function\n</code></pre>\n\n<p><strong>but i think i forgot something. could u help me please thanks!</strong></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 2, "creation_date": 1488363010, "post_id": 42528412, "comment_id": 72193383, "body": "Don&#39;t you need to replace <code>.MinimumScale = ActiveSheet.Range(&quot;A2&quot;).Value</code> with <code>.MinimumScale = ws.Range(&quot;A2&quot;).Value</code> ?"}, {"owner": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1488363658, "post_id": 42528412, "comment_id": 72193849, "body": "hi @ShaiRado, actually you are correct. I will replace it with correct sheet name. but as for now, i want the maximum scale is working"}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1488366613, "last_edit_date": 1488366613, "creation_date": 1488366292, "answer_id": 42530034, "question_id": 42528412, "link": "https://stackoverflow.com/questions/42528412/excel-vba-error-in-updating-maximum-scale-for-xy-scatter-chart/42530034#42530034", "title": "Excel VBA - Error in Updating Maximum Scale for XY Scatter Chart", "body": "<p>The problem is that <code>LastRow</code> is the number of the last row. I assume you wanted the value of the last cell. </p>\n\n<pre><code>.MaximumScale = ws.Cells(LastRow, 1).Value\n</code></pre>\n"}], "owner": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "accepted_answer_id": 42530034, "answer_count": 1, "score": 2, "last_activity_date": 1488366613, "creation_date": 1488361783, "question_id": 42528412, "link": "https://stackoverflow.com/questions/42528412/excel-vba-error-in-updating-maximum-scale-for-xy-scatter-chart", "title": "Excel VBA - Error in Updating Maximum Scale for XY Scatter Chart", "body": "<p>I have a code where it need to change the scale of chart when user click a button. However the code is not working for the maximum scale which is the last used row. Below is the code:</p>\n\n<pre><code>Option Explicit\n\nSub ScaleAxes()\n\nDim LastRow, LastRow2 As Long\nDim ws As Worksheet\n\nSet ws = ActiveChart.Parent.Parent\n\nWith ActiveChart.Axes(xlCategory, xlPrimary)\n    LastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n    .MaximumScale = LastRow\n    .MinimumScale = ActiveSheet.Range(\"A2\").Value\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>In the picture below is the generated graph from my data which is Power vs Frequency. The Frequency range is 1.12 GHz to 1.45 GHz. </p>\n\n<p><a href=\"https://i.stack.imgur.com/Ikqp1.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ikqp1.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>After i apply the code above, the chart changed as below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yy9zX.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yy9zX.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see in the picture, the minimum scale which is 1.12 GHz is working but not for the maximum scale. Are there anything wrong with the code?</p>\n\n<p>Thank you very much.</p>\n"}, {"tags": ["vba", "shell"], "comments": [{"owner": {"reputation": 297, "user_id": 4011981, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d66cbdf51366af4233cf2a9c29e3d849?s=128&d=identicon&r=PG&f=1", "display_name": "santosh gore", "link": "https://stackoverflow.com/users/4011981/santosh-gore"}, "edited": false, "score": 0, "creation_date": 1488360791, "post_id": 42528026, "comment_id": 72191795, "body": "can you post your code?"}, {"owner": {"reputation": 9863, "user_id": 1820501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/237d6688e4e1834e2cad38629fea4988?s=128&d=identicon&r=PG", "display_name": "Florent Bayle", "link": "https://stackoverflow.com/users/1820501/florent-bayle"}, "edited": false, "score": 0, "creation_date": 1488360959, "post_id": 42528026, "comment_id": 72191910, "body": "Why is this question tagged java ?"}, {"owner": {"reputation": 10985, "user_id": 2664350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/267fd556e7bd18db2e3923939cd3dd6b?s=128&d=identicon&r=PG", "display_name": "piet.t", "link": "https://stackoverflow.com/users/2664350/piet-t"}, "edited": false, "score": 1, "creation_date": 1488361698, "post_id": 42528026, "comment_id": 72192437, "body": "Have you run your numbers? To read 68000 files of 24MB each in 30 minutes you need a transfer-rate of about 906MB/s. That means you have to use a fast SSD to just do your I/O in the time you are suggesting."}], "answers": [{"tags": [], "owner": {"reputation": 143, "user_id": 739715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce9b3618aebfc6f4b9a15d3ef986a521?s=128&d=identicon&r=PG", "display_name": "Migwel", "link": "https://stackoverflow.com/users/739715/migwel"}, "is_accepted": false, "score": 0, "last_activity_date": 1488361192, "creation_date": 1488361192, "answer_id": 42528216, "question_id": 42528026, "link": "https://stackoverflow.com/questions/42528026/find-the-count-of-repetitions-of-a-specific-word-in-68000-files-each-file-of-24/42528216#42528216", "title": "Find the count of repetitions of a specific word in 68000 files, each file of 24 mb approximately", "body": "<p>I would suggest to follow the <a href=\"https://en.wikipedia.org/wiki/Boyer%E2%80%93Moore_string_search_algorithm\" rel=\"nofollow noreferrer\">Boyer-Moore algorithm</a>. This is used by <code>grep</code> so I'm quite convinced this should be efficient enough for you.</p>\n"}, {"tags": [], "owner": {"reputation": 625, "user_id": 2880342, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/917a1ca96bd067832d2b7e4d8967d336?s=128&d=identicon&r=PG&f=1", "display_name": "GoodJuJu", "link": "https://stackoverflow.com/users/2880342/goodjuju"}, "is_accepted": false, "score": -1, "last_activity_date": 1488364032, "creation_date": 1488364032, "answer_id": 42529217, "question_id": 42528026, "link": "https://stackoverflow.com/questions/42528026/find-the-count-of-repetitions-of-a-specific-word-in-68000-files-each-file-of-24/42529217#42529217", "title": "Find the count of repetitions of a specific word in 68000 files, each file of 24 mb approximately", "body": "<p>You asked for a faster way, OR a faster TOOL to do this.</p>\n\n<p>I would suggest using MythicSoft FileLocator Pro, or Lite.  The lite version is free for commercial use.</p>\n\n<p><a href=\"https://www.mythicsoft.com/filelocatorlite\" rel=\"nofollow noreferrer\">https://www.mythicsoft.com/filelocatorlite</a></p>\n\n<p>This will give you a count of repetitions of a specific word in all those files, plus much more.</p>\n\n<p>I am in no way affiliated with MythicSoft..</p>\n"}], "owner": {"reputation": 7, "user_id": 7337452, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-I3wALTTVf4c/AAAAAAAAAAI/AAAAAAAAH4Y/771HnCqIFBM/photo.jpg?sz=128", "display_name": "Raghuram", "link": "https://stackoverflow.com/users/7337452/raghuram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1488385502, "creation_date": 1488360719, "last_edit_date": 1488385502, "question_id": 42528026, "link": "https://stackoverflow.com/questions/42528026/find-the-count-of-repetitions-of-a-specific-word-in-68000-files-each-file-of-24", "title": "Find the count of repetitions of a specific word in 68000 files, each file of 24 mb approximately", "body": "<p>In a folder I have 68000 files, i have to find the count of repetitions of a specific word in all those files. One file can have any number repetitions of the same word. Each file is approximately 24 mb. I am trying to code this in VB script. It is taking very long time (>30 mins) to find to read each file line by line.\nCould you suggest a faster way or a tool to do this.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1488364421, "post_id": 42527710, "comment_id": 72194437, "body": "You&#39;ll need to provide more information Manu. Is the Windows username list in an excel sheet? Can you access the &#39;global list of the company&#39; from within Excel? How are you doing this? Is it a query or vba?"}, {"owner": {"reputation": 167, "user_id": 6648980, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh4.googleusercontent.com/-coRItLVaGHE/AAAAAAAAAAI/AAAAAAAAE_k/7jnzDP_cUWw/photo.jpg?sz=128", "display_name": "Manu Mohan", "link": "https://stackoverflow.com/users/6648980/manu-mohan"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1488365088, "post_id": 42527710, "comment_id": 72194919, "body": "I wanted to compare the user name with the windows network user names. For example if I&#39;m trying to give a particular user access to a cell/range, we will get a windows permission dialogue box in which I can check add new user from network user list. I want the check name feature in the dialogue box"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1488370233, "post_id": 42527710, "comment_id": 72198380, "body": "I may be misinterpreting your requirement but it sounds to me as though you want a userform that presents all of the Windows usernames/details and you want to be able to select one which then gets added to a list?"}, {"owner": {"reputation": 167, "user_id": 6648980, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh4.googleusercontent.com/-coRItLVaGHE/AAAAAAAAAAI/AAAAAAAAE_k/7jnzDP_cUWw/photo.jpg?sz=128", "display_name": "Manu Mohan", "link": "https://stackoverflow.com/users/6648980/manu-mohan"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1488378462, "post_id": 42527710, "comment_id": 72204202, "body": "If some one adds a user name in a list (in excel cell) i just wanted to validate whether it is a valid network user or not"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1488378779, "post_id": 42527710, "comment_id": 72204405, "body": "Understood. Check out the following which could be modified to instead of returning the name, be used to check if the login exists. <a href=\"http://stackoverflow.com/questions/7805856/vba-retrieve-the-name-of-the-user-associated-with-logged-username\" title=\"vba retrieve the name of the user associated with logged username\">stackoverflow.com/questions/7805856/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 167, "user_id": 6648980, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh4.googleusercontent.com/-coRItLVaGHE/AAAAAAAAAAI/AAAAAAAAE_k/7jnzDP_cUWw/photo.jpg?sz=128", "display_name": "Manu Mohan", "link": "https://stackoverflow.com/users/6648980/manu-mohan"}, "is_accepted": true, "score": 1, "last_activity_date": 1489666446, "creation_date": 1489666446, "answer_id": 42833800, "question_id": 42527710, "link": "https://stackoverflow.com/questions/42527710/validating-user-name-with-global-user-list-in-vba/42833800#42833800", "title": "Validating user name with global user list in VBA", "body": "<p>I have got a simple function for the same </p>\n\n<pre><code>Function GetUserFullName(userName) As String\n    Set WSHnet = CreateObject(\"WScript.Network\")\n    UserDomain = WSHnet.UserDomain\n    On Error GoTo Err_open_esy\n    Set objUser = GetObject(\"WinNT://\" &amp; UserDomain &amp; \"/\" &amp; userName &amp; \",user\")\nExit_open_esy:\n    GetUserFullName = objUser.FullName\nExit Function\n\nErr_open_esy:\n    GetUserFullName = \"Error\"\nEnd Function\n</code></pre>\n\n<p>can use as</p>\n\n<pre><code>GetUserFullName(\"abc\")\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 6648980, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh4.googleusercontent.com/-coRItLVaGHE/AAAAAAAAAAI/AAAAAAAAE_k/7jnzDP_cUWw/photo.jpg?sz=128", "display_name": "Manu Mohan", "link": "https://stackoverflow.com/users/6648980/manu-mohan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 437, "favorite_count": 0, "accepted_answer_id": 42833800, "answer_count": 1, "score": -1, "last_activity_date": 1489666446, "creation_date": 1488359872, "last_edit_date": 1531164843, "question_id": 42527710, "link": "https://stackoverflow.com/questions/42527710/validating-user-name-with-global-user-list-in-vba", "title": "Validating user name with global user list in VBA", "body": "<p>I'm trying to create a an excel to track production in my organization. I have a user list with user names (windows). I wanted to validate the user name with the global list of the company whenever some adds a new user name to the list.</p>\n"}, {"tags": ["excel", "cognos-8", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7636635, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Jhha3k1BrMc/AAAAAAAAAAI/AAAAAAAAAQ4/s4k4iiuhz1Y/photo.jpg?sz=128", "display_name": "Raniya", "link": "https://stackoverflow.com/users/7636635/raniya"}, "edited": false, "score": 0, "creation_date": 1488446689, "post_id": 42532990, "comment_id": 72237886, "body": "Many thanks for your response . Actually I build mycube.mdc  locally but the publish is in server . I want the diffrents steps to take to publish the cube locally .Hence , acces to cube through macro excel."}], "tags": [], "owner": {"reputation": 1, "user_id": 7641436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cbecc3dd90c4566c7b38ab4fcbab8fd?s=128&d=identicon&r=PG&f=1", "display_name": "pargetter99", "link": "https://stackoverflow.com/users/7641436/pargetter99"}, "is_accepted": false, "score": 0, "last_activity_date": 1488374673, "creation_date": 1488374673, "answer_id": 42532990, "question_id": 42527503, "link": "https://stackoverflow.com/questions/42527503/macro-excel-cognos-8/42532990#42532990", "title": "Macro Excel Cognos 8", "body": "<p>NOTE-Cognos 8 is unsupported- highly suggest you upgrade to 10 as soon as feasible. \nTo clarify- you want to build this cube locally? On your desktop? Depending on size and structure it can take up all your local resources. \nI suggest this-\n1. Build the cube on the server and copy it to your destination.\nd:\\Cognos\\PowerCubes\\Build, then to publish them- copy them to another directory d:\\Cognos\\PowerCubes\\Live</p>\n\n<p>use the windows copy command i.e. copy d:\\Cognos\\PowerCubes\\Build\\yourcube.mdc d:\\Cognos\\PowerCubes\\Live /Y /B </p>\n\n<ol start=\"2\">\n<li>Local- build the cube using task scheduler on your local machine.</li>\n</ol>\n\n<p>HTH</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7636635, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Jhha3k1BrMc/AAAAAAAAAAI/AAAAAAAAAQ4/s4k4iiuhz1Y/photo.jpg?sz=128", "display_name": "Raniya", "link": "https://stackoverflow.com/users/7636635/raniya"}, "is_accepted": false, "score": 0, "last_activity_date": 1488468735, "creation_date": 1488468735, "answer_id": 42559540, "question_id": 42527503, "link": "https://stackoverflow.com/questions/42527503/macro-excel-cognos-8/42559540#42559540", "title": "Macro Excel Cognos 8", "body": "<p>Actually I build mycube.mdc locally but the publish is in server . I want the diffrents steps to take to publish the cube locally .Hence , access to cube through macro excel.</p>\n"}], "owner": {"reputation": 1, "user_id": 7636635, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Jhha3k1BrMc/AAAAAAAAAAI/AAAAAAAAAQ4/s4k4iiuhz1Y/photo.jpg?sz=128", "display_name": "Raniya", "link": "https://stackoverflow.com/users/7636635/raniya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1488468735, "creation_date": 1488359291, "last_edit_date": 1531164843, "question_id": 42527503, "link": "https://stackoverflow.com/questions/42527503/macro-excel-cognos-8", "title": "Macro Excel Cognos 8", "body": "<p>The Macro Excel pointe in Cognos 8 Cube. The cube is published in the server of the company.\nI want to make these process local . Please check and advice </p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"tags": [], "owner": {"reputation": 73, "user_id": 7640152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adabb5cd029a32945173778cb36e81b9?s=128&d=identicon&r=PG&f=1", "display_name": "user7640152", "link": "https://stackoverflow.com/users/7640152/user7640152"}, "is_accepted": false, "score": 1, "last_activity_date": 1488359570, "creation_date": 1488359570, "answer_id": 42527600, "question_id": 42527391, "link": "https://stackoverflow.com/questions/42527391/if-cell-equals-a-product-and-date-input-formula-in-intersect-cell-vba/42527600#42527600", "title": "If cell equals a product and date, input formula in intersect cell VBA", "body": "<p>Try this :</p>\n\n<pre><code>Sub Fill_Formula()\nDim StartRow As Long\nStartRow = 2\n\nFor i = StartRow To 50 'Start and End Rows\n    For j = 2 To 10 'Start and End Columns\n        Cells(i, j).Formula = _\n            \"IFERROR(IF(VLOOKUP($B$1&amp;$C\" &amp; 39 + (i - StartRow) &amp; \"&amp;Japan!$E\" &amp; 39 + (i - StartRow) &amp; \",TDM!$A:$AA,23,0)=Japan!U$\" &amp; 33 + (i - StartRow) &amp; \",SUMIF(Allocation!$A:$A,Japan!$A\" &amp; 39 + (i - StartRow) &amp; \",Allocation!$S:$S),\"\")*$G\" &amp; 39 + (i - StartRow) &amp; \",\"\")\"\n    Next j\nNext i\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7640137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bfd3f85b4027d3a7587968359ae93ee?s=128&d=identicon&r=PG&f=1", "display_name": "archh", "link": "https://stackoverflow.com/users/7640137/archh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1488359762, "creation_date": 1488358957, "last_edit_date": 1488359762, "question_id": 42527391, "link": "https://stackoverflow.com/questions/42527391/if-cell-equals-a-product-and-date-input-formula-in-intersect-cell-vba", "title": "If cell equals a product and date, input formula in intersect cell VBA", "body": "<pre><code>                    B   C   D\n                   1/1 1/2 1/3\n\n     2 Product 1    ?\n     3 Product 2\n</code></pre>\n\n<p>I'm trying to use VBA to automate inserting formula based on product name and date criteria. Tried multiple ways including index match, intersect but can't seem to get it to work!</p>\n\n<p>Currently my formula is manually placed based on dates of another worksheet. Formula for reference</p>\n\n<pre><code>=IFERROR(IF(VLOOKUP($B$1&amp;$C39&amp;Japan!$E39,TDM!$A:$AA,23,0)=Japan!U$33,SUMIF(Allocation!$A:$A,Japan!$A39,Allocation!$S:$S),\"\")*$G39,\"\")\n</code></pre>\n\n<p>Is there a way to automate this using VBA? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 2, "creation_date": 1488359084, "post_id": 42527356, "comment_id": 72190588, "body": "You can use Chr(34)"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 2, "last_activity_date": 1488360085, "creation_date": 1488360085, "answer_id": 42527794, "question_id": 42527356, "link": "https://stackoverflow.com/questions/42527356/search-for-double-quotes-with-instr/42527794#42527794", "title": "Search for double quotes with InStr", "body": "<p>Try using <code>Chr(34)</code> </p>\n\n<pre><code>If InStr(myString, Chr(34)) &gt; 0 Then\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1609852883, "post_id": 65570181, "comment_id": 115946464, "body": "Side note: Why <code>While</code> .. <code>Wend</code>? A simple replace suffices (could be done in a loop through <code>Chr</code> values assigned to an array as well)."}, {"owner": {"reputation": 1407, "user_id": 5835002, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mnMDz.jpg?s=128&g=1", "display_name": "SendETHToThisAddress", "link": "https://stackoverflow.com/users/5835002/sendethtothisaddress"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1609866238, "post_id": 65570181, "comment_id": 115953266, "body": "Good point T.M. I will update"}], "tags": [], "owner": {"reputation": 1407, "user_id": 5835002, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mnMDz.jpg?s=128&g=1", "display_name": "SendETHToThisAddress", "link": "https://stackoverflow.com/users/5835002/sendethtothisaddress"}, "is_accepted": false, "score": 1, "last_activity_date": 1609866346, "last_edit_date": 1609866346, "creation_date": 1609796279, "answer_id": 65570181, "question_id": 42527356, "link": "https://stackoverflow.com/questions/42527356/search-for-double-quotes-with-instr/65570181#65570181", "title": "Search for double quotes with InStr", "body": "<p>MS Office has up 4 different kinds of double quotes, including simple text quotes and fancy &quot;smart&quot; quotes, so if you want your VBA code to work consistently you will likely need to check for all of these possible characters that can represent double quotes:</p>\n<pre><code>If InStr(inputText, Chr(34)) &gt; 0 Or InStr(inputText, Chr(147)) &gt; 0 Or InStr(inputText, Chr(148)) &gt; 0 Or InStr(inputText, Chr(132)) &gt; 0 Then\n    MsgBox &quot;Found double quotes&quot;\nElse\n    MsgBox &quot;Did NOT find any double quotes.&quot;\nEnd If\n</code></pre>\n<p>Here is an example with a function I used to replace any special/fancy quotes with regular plain text quotes:</p>\n<pre><code>Dim d1 As String\nDim d2 As String\nDim d3 As String\nDim d4 As String\n\nSub FixFormatting()\n    Dim inputText As String\n    Dim outputText As String\n    \n    inputText = Range(&quot;A2&quot;).Text\n    d1 = Chr(34)\n    d2 = Chr(147)\n    d3 = Chr(148)\n    d4 = Chr(132)\n    \n    If InStr(inputText, d2) &gt; 0 Or InStr(inputText, d3) &gt; 0 Or InStr(inputText, d4) &gt; 0 Then\n        inputText = ReplaceFancyQuotes(inputText)\n    End If\n    outputText = inputText\n    \n    Range(&quot;C2&quot;).Value = outputText\nEnd Sub\n\nFunction ReplaceFancyQuotes(s As String) As String\n    s = Replace(s, d2, d1)\n    s = Replace(s, d3, d1)\n    s = Replace(s, d4, d1)\n    ReplaceFancyQuotes = s\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1276, "favorite_count": 0, "accepted_answer_id": 42527794, "answer_count": 2, "score": 2, "last_activity_date": 1609866346, "creation_date": 1488358893, "last_edit_date": 1531164843, "question_id": 42527356, "link": "https://stackoverflow.com/questions/42527356/search-for-double-quotes-with-instr", "title": "Search for double quotes with InStr", "body": "<p>I want to look into a string and check if it contains <code>\"</code>.</p>\n\n<p>I tried <code>If InStr(myString, \"\"\") &gt; 0 Then</code> but VBA reads it as a missing <code>\"</code> somewhere and returns me a </p>\n\n<blockquote>\n  <p>Compile error. Expected list separator </p>\n</blockquote>\n\n<p>How should I search for that character?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1488357239, "post_id": 42526727, "comment_id": 72189385, "body": "What have you tried so far ? Upload your code attempt"}, {"owner": {"reputation": 157, "user_id": 7495707, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/5f55f2ae1b2d466f1b9ad3d211a074d6?s=128&d=identicon&r=PG&f=1", "display_name": "D. Todor", "link": "https://stackoverflow.com/users/7495707/d-todor"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1488357625, "post_id": 42526727, "comment_id": 72189646, "body": "I wasn&#39;t able to put together any code so far which automatically inputs date values. I was only able to make a work-around with a input box for the user to input the starting and end date manually and then the code simply copies this value to as many cells as possible.  I am not even sure if it is possible with VBA to do what I am asking for without any work-arounds. :/"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1488358223, "post_id": 42526727, "comment_id": 72190012, "body": "Sure it is possible. See my answer below. Just generate the fist and last date and copy them down as you did before."}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 7495707, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/5f55f2ae1b2d466f1b9ad3d211a074d6?s=128&d=identicon&r=PG&f=1", "display_name": "D. Todor", "link": "https://stackoverflow.com/users/7495707/d-todor"}, "edited": false, "score": 0, "creation_date": 1488359758, "post_id": 42526924, "comment_id": 72191022, "body": "This works like a charm! Just one follow-up question: is it possible to change it so it gives me the values of the past month? So instead of giving me current month&#39;s first and last day can it give me these values for last month? Would subtracting 1 from dtmDate do that?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 157, "user_id": 7495707, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/5f55f2ae1b2d466f1b9ad3d211a074d6?s=128&d=identicon&r=PG&f=1", "display_name": "D. Todor", "link": "https://stackoverflow.com/users/7495707/d-todor"}, "edited": false, "score": 0, "creation_date": 1488360376, "post_id": 42526924, "comment_id": 72191473, "body": "I added an example to get the last day from the month before"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1488360349, "last_edit_date": 1488360349, "creation_date": 1488357586, "answer_id": 42526924, "question_id": 42526727, "link": "https://stackoverflow.com/questions/42526727/filling-out-two-columns-in-excel-with-first-and-last-day-of-the-month-respective/42526924#42526924", "title": "Filling out two columns in Excel with first and last day of the month respectively", "body": "<p>Here are 2 functions to find the first and last day of a month. To fill out the columns should be easy then.</p>\n\n<pre><code>Function dhFirstDayInMonth(Optional dtmDate As Date = 0) As Date\n    ' Return the first day in the specified month.\n    If dtmDate = 0 Then\n        ' Did the caller pass in a date? If not, use\n        ' the current date.\n        dtmDate = Date\n    End If\n    dhFirstDayInMonth = DateSerial(Year(dtmDate), _\n     Month(dtmDate), 1)\nEnd Function\n\n\nFunction dhLastDayInMonth(Optional dtmDate As Date = 0) As Date\n    ' Return the last day in the specified month.\n    If dtmDate = 0 Then\n        ' Did the caller pass in a date? If not, use\n        ' the current date.\n        dtmDate = Date\n    End If\n    dhLastDayInMonth = DateSerial(Year(dtmDate), _\n     Month(dtmDate) + 1, 0)\nEnd Function\n</code></pre>\n\n<p>Source: <a href=\"https://msdn.microsoft.com/en-us/library/aa227522(v=vs.60).aspx\" rel=\"nofollow noreferrer\">Finding the Beginning or End of a Month</a></p>\n\n<p>To get the first/last month dates from other month than the current you can make use of the <a href=\"https://msdn.microsoft.com/en-us/library/hcxe65wz(v=vs.90).aspx\" rel=\"nofollow noreferrer\"><code>DateAdd()</code>-function</a> for the input date:</p>\n\n<pre><code>lastDayOfLastMonth = dhLastDayInMonth(DateAdd(\"m\", -1, Date))\nfirstDayOfLastMonth = dhFirstDayInMonth(DateAdd(\"m\", -1, Date))\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 7495707, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/5f55f2ae1b2d466f1b9ad3d211a074d6?s=128&d=identicon&r=PG&f=1", "display_name": "D. Todor", "link": "https://stackoverflow.com/users/7495707/d-todor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 42526924, "answer_count": 1, "score": -1, "last_activity_date": 1488360917, "creation_date": 1488356974, "last_edit_date": 1488360917, "question_id": 42526727, "link": "https://stackoverflow.com/questions/42526727/filling-out-two-columns-in-excel-with-first-and-last-day-of-the-month-respective", "title": "Filling out two columns in Excel with first and last day of the month respectively", "body": "<p>I would like code which will fill out columns A and B with the first and last day of the current month. It should look somewhat like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/zvBnJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zvBnJ.png\" alt=\"\"></a></p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 815, "user_id": 5227689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89abdeef079014affae1f012239e2f9b?s=128&d=identicon&r=PG&f=1", "display_name": "Old Nick", "link": "https://stackoverflow.com/users/5227689/old-nick"}, "is_accepted": false, "score": 0, "last_activity_date": 1488377497, "creation_date": 1488377497, "answer_id": 42533981, "question_id": 42526683, "link": "https://stackoverflow.com/questions/42526683/excel-to-automate-email-in-outlook-using-specific-fields-in-the-excel-sheet/42533981#42533981", "title": "Excel to automate email in Outlook using specific fields in the excel sheet", "body": "<p>Not sure exactly what parts of this you would like to optimise but after looking at your example, here are a couple of things which I would look at changing;</p>\n\n<p>The only things which are changing within the loop are the recipients and the subject line, the body is always the same (obviously I don't know what is stored in those cells) but maybe you could just construct the recipients string within the loop which should work fine if you separate the email addresses with semi-colons and send one email instead of multiple emails?</p>\n\n<p>The other thing which I would mention is that you are stopping when you encounter a blank line which means that the loop may not pick up all recipients if someone deleted that line by mistake. There are many much more robust ways of locating the end of the data you could use.</p>\n\n<p>Hope that helps.</p>\n"}, {"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 0, "last_activity_date": 1494922769, "last_edit_date": 1494922769, "creation_date": 1488417385, "answer_id": 42545157, "question_id": 42526683, "link": "https://stackoverflow.com/questions/42526683/excel-to-automate-email-in-outlook-using-specific-fields-in-the-excel-sheet/42545157#42545157", "title": "Excel to automate email in Outlook using specific fields in the excel sheet", "body": "<p><em>You do not need to create <strong><code>Outlook Object twice</code></strong> . <strong><code>Set outlookApp = CreateObject(\"Outlook.Application\")</code></strong> and change  <strong><code>Dim RowCount As Integer</code></strong> to <strong><code>Dim RowCount As Long</code></em></strong></p>\n\n<p><em><a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">Also avoid</a> <code>.Activate</code></em> </p>\n\n<pre><code>Option Explicit\nSub EmailToAll()\n    Dim outlookApp As Outlook.Application\n    Dim outlookMail As Outlook.MailItem\n    Dim RowCount As Long\n\n    Set outlookApp = CreateObject(\"Outlook.Application\")\n\n    RowCount = 2\n\n    With Worksheets(\"Final_List\")\n        Do While IsEmpty(Cells(RowCount, 1).Value) = False\n\n            Set outlookMail = outlookApp.CreateItem(olMailItem)\n            With outlookMail\n                    .To = Cells(RowCount, 7).Value\n                    .CC = Cells(RowCount, 9).Value\n                    .BCC = Empty\n                    .Subject = \"[Update]\" &amp; \" \" &amp; Cells(RowCount, 1).Value &amp; \"-\" &amp; Cells(RowCount, 8).Value\n                    .BodyFormat = 2\n                    .HTMLBody = \"Hello \"\n                    .Send\n            End With\n            RowCount = RowCount + 1\n        Loop\n    End With\n\n    Set outlookMail = Nothing\n    Set outlookApp = Nothing\n\n    MsgBox \"All mails sent!\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7639869, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155008105109519/picture?type=large", "display_name": "Mohit Roshan Srivastava", "link": "https://stackoverflow.com/users/7639869/mohit-roshan-srivastava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "accepted_answer_id": 42545157, "answer_count": 2, "score": -1, "last_activity_date": 1593413348, "creation_date": 1488356829, "last_edit_date": 1593413348, "question_id": 42526683, "link": "https://stackoverflow.com/questions/42526683/excel-to-automate-email-in-outlook-using-specific-fields-in-the-excel-sheet", "title": "Excel to automate email in Outlook using specific fields in the excel sheet", "body": "<p>I'm working towards improving my efficiency at my workplace. For this there is a task of sending an e-mail to a list of people.</p>\n\n<p>For this I have created the following code. Would like to know if this can be improved? This code takes the information from sheet \"Final_list\" in a workbook and headers are in row 1.</p>\n\n<pre><code>Sub EmailToAll()\n\n    Dim outlookApp As Outlook.Application\n    Dim outlookMail As Outlook.MailItem\n\n    Set outlookApp = CreateObject(\"Outlook.Application\")\n    Set outlookMail = outlookApp.CreateItem(olMailItem)\n\n\n\n    Dim sh As Worksheet\n    Dim RowCount As Integer\n\n    Worksheets(\"Final_List\").Activate\n\n    RowCount = 2\n\n    Set sh = ActiveSheet\n\n    Do While IsEmpty(sh.Cells(RowCount, 1).Value) = False\n\n        Set outlookApp = CreateObject(\"Outlook.Application\")\n        Set outlookMail = outlookApp.CreateItem(olMailItem)\n        With outlookMail\n                'MsgBox sh.Cells(RowCount, 7).Value\n                .To = sh.Cells(RowCount, 7).Value\n                .CC = sh.Cells(RowCount, 9).Value\n                .BCC = Empty\n                .Subject = \"[Update]\" &amp; \" \" &amp; sh.Cells(RowCount, 1).Value &amp; \"-\" &amp; sh.Cells(RowCount, 8).Value\n                .BodyFormat = 2\n                .HTMLBody = \"Hello \"\n                '.Display\n                '.Save\n                '.Close\n                .Send\n                'MsgBox \"Mail saved for\" &amp; sh.Cells(RowCount, 7).Value &amp; \"!\"\n                RowCount = RowCount + 1\n        End With\n\n    Loop\n\n    Set outlookMail = Nothing\n    Set outlookApp = Nothing\n    MsgBox \"All mails sent!\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7573475, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/b6e51d91b128f242504ae78ed27b9b24?s=128&d=identicon&r=PG&f=1", "display_name": "MES", "link": "https://stackoverflow.com/users/7573475/mes"}, "edited": false, "score": 0, "creation_date": 1488357307, "post_id": 42526728, "comment_id": 72189431, "body": "till ..acQuery i understand the code.    first qryinfo is the Name of my query and the second??"}, {"owner": {"reputation": 632, "user_id": 6165495, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-Arf292SOBCA/AAAAAAAAAAI/AAAAAAAAADc/q0xiAMkOREE/photo.jpg?sz=128", "display_name": "Arockia Nirmal", "link": "https://stackoverflow.com/users/6165495/arockia-nirmal"}, "reply_to_user": {"reputation": 31, "user_id": 7573475, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/b6e51d91b128f242504ae78ed27b9b24?s=128&d=identicon&r=PG&f=1", "display_name": "MES", "link": "https://stackoverflow.com/users/7573475/mes"}, "edited": false, "score": 0, "creation_date": 1488357426, "post_id": 42526728, "comment_id": 72189521, "body": "the remaining things are just your query names in the source and target databases accordingly..."}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1488357775, "post_id": 42526728, "comment_id": 72189732, "body": "Both the databases do not have to be open, only the one running the code, and even at that you might get away with script, but I have not tested."}, {"owner": {"reputation": 31, "user_id": 7573475, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/b6e51d91b128f242504ae78ed27b9b24?s=128&d=identicon&r=PG&f=1", "display_name": "MES", "link": "https://stackoverflow.com/users/7573475/mes"}, "edited": false, "score": 0, "creation_date": 1488357879, "post_id": 42526728, "comment_id": 72189795, "body": "the Export runs but, if i want to open the table in the target database. i get error, because the FROM TABLE dont exist in the target database"}, {"owner": {"reputation": 31, "user_id": 7573475, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/b6e51d91b128f242504ae78ed27b9b24?s=128&d=identicon&r=PG&f=1", "display_name": "MES", "link": "https://stackoverflow.com/users/7573475/mes"}, "edited": false, "score": 0, "creation_date": 1488357910, "post_id": 42526728, "comment_id": 72189810, "body": "i only want to save the results in the target database"}, {"owner": {"reputation": 632, "user_id": 6165495, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-Arf292SOBCA/AAAAAAAAAAI/AAAAAAAAADc/q0xiAMkOREE/photo.jpg?sz=128", "display_name": "Arockia Nirmal", "link": "https://stackoverflow.com/users/6165495/arockia-nirmal"}, "edited": false, "score": 0, "creation_date": 1488358288, "post_id": 42526728, "comment_id": 72190058, "body": "could you please post your solution?"}, {"owner": {"reputation": 31, "user_id": 7573475, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/b6e51d91b128f242504ae78ed27b9b24?s=128&d=identicon&r=PG&f=1", "display_name": "MES", "link": "https://stackoverflow.com/users/7573475/mes"}, "edited": false, "score": 0, "creation_date": 1488359089, "post_id": 42526728, "comment_id": 72190591, "body": "i had a Syntax mistake, your code was right! Do you know how to copy the result of a query into a table with vba, IN THE SAME database? only copy"}, {"owner": {"reputation": 632, "user_id": 6165495, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-Arf292SOBCA/AAAAAAAAAAI/AAAAAAAAADc/q0xiAMkOREE/photo.jpg?sz=128", "display_name": "Arockia Nirmal", "link": "https://stackoverflow.com/users/6165495/arockia-nirmal"}, "edited": false, "score": 0, "creation_date": 1488359265, "post_id": 42526728, "comment_id": 72190719, "body": "I hope the below is what you are looking for...  <a href=\"https://support.office.com/en-us/article/Add-records-to-a-table-by-using-an-append-query-98a5bd66-2190-4243-9638-8ef649cf3596\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 31, "user_id": 7573475, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/b6e51d91b128f242504ae78ed27b9b24?s=128&d=identicon&r=PG&f=1", "display_name": "MES", "link": "https://stackoverflow.com/users/7573475/mes"}, "edited": false, "score": 0, "creation_date": 1488359826, "post_id": 42526728, "comment_id": 72191084, "body": "thank u for link, but i want solve this with vba, because i have a lot of queries (about 100),  its better with code as Manual i think"}], "tags": [], "owner": {"reputation": 632, "user_id": 6165495, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-Arf292SOBCA/AAAAAAAAAAI/AAAAAAAAADc/q0xiAMkOREE/photo.jpg?sz=128", "display_name": "Arockia Nirmal", "link": "https://stackoverflow.com/users/6165495/arockia-nirmal"}, "is_accepted": false, "score": 0, "last_activity_date": 1488356975, "creation_date": 1488356975, "answer_id": 42526728, "question_id": 42526561, "link": "https://stackoverflow.com/questions/42526561/vba-sql-access-copy-query-result-to-a-table-in-other-access-database/42526728#42526728", "title": "VBA/SQL ACCESS: Copy query result to a table in other access database", "body": "<p>The below should be your code to copy a query from one access database to another...</p>\n\n<pre><code>DoCmd.TransferDatabase acExport, \"Microsoft Access\", \"C:\\DestTemp\\Dest.mdb\", acQuery, \"qryInfo\", \"qryInfo\".\n</code></pre>\n\n<p>\"C:\\DestTemp\\Dest.mdb\" -> your target database</p>\n\n<p>qryInfo -> Query name in the source and then the target database accordingly...</p>\n\n<p>NOTE: Both the database must be opened during this task....</p>\n"}], "owner": {"reputation": 31, "user_id": 7573475, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/b6e51d91b128f242504ae78ed27b9b24?s=128&d=identicon&r=PG&f=1", "display_name": "MES", "link": "https://stackoverflow.com/users/7573475/mes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1091, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488386382, "creation_date": 1488356428, "last_edit_date": 1488386382, "question_id": 42526561, "link": "https://stackoverflow.com/questions/42526561/vba-sql-access-copy-query-result-to-a-table-in-other-access-database", "title": "VBA/SQL ACCESS: Copy query result to a table in other access database", "body": "<p>i want to copy my query results to a other Access database with\nVBA-code in a module or directly with the SQL-query.</p>\n\n<p>maybe my code should look like this?:</p>\n\n<pre><code>Sub export()\n  DoCmd.CopyObject , \"myquery\", acQuery, \"C:/...mytable//\"   \n  MsgBox (\"Export finish!\" &amp; Date &amp; \" , \" &amp; Time)\n  DoCmd.SetWarnings True\nEnd Sub\n</code></pre>\n\n<p>Thanks for each tip!</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7500527"}, "edited": false, "score": 0, "creation_date": 1488372864, "post_id": 42527297, "comment_id": 72200259, "body": "Have not tried this solution as the above one worked fine for me. Thanks though for your contribution @CallumDA :)"}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": false, "score": 2, "last_activity_date": 1488358709, "creation_date": 1488358709, "answer_id": 42527297, "question_id": 42526272, "link": "https://stackoverflow.com/questions/42526272/lookup-name-in-two-sheets-to-make-sum/42527297#42527297", "title": "Lookup &quot;name&quot; in two sheets to make sum", "body": "<p>I presume when you say <em>minus the number</em> you are referring to the number in <strong>Usage Report OLD</strong> </p>\n\n<pre><code>=IF(ISERROR(Match(\"Kim Pearson\",'User Monthly Report'!$A$1:$A$10,0)),0,IFERROR(-Match(\"Kim Pearson\",'User Usage Report OLD'!$E$1:$E$10,0),0)\n</code></pre>\n\n<p>This returns the negative value from <strong>User Usage Report OLD</strong> provided the user is in both of the other sheets. Add this formula to the end of your sum formula and replace the hardcoded names with cell references e.g.</p>\n\n<pre><code>=SUM(F2:H2)+IF(ISERROR(Match(E2,'User Monthly Report'!$A$1:$A$10,0)),0,IFERROR(-Match(E2,'User Usage Report OLD'!$E$1:$E$10,0),0)\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7500527"}, "edited": false, "score": 0, "creation_date": 1488360690, "post_id": 42527365, "comment_id": 72191732, "body": "User7640152 you are a legend! Thanks soooo much!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7500527"}, "edited": false, "score": 0, "creation_date": 1488360776, "post_id": 42527365, "comment_id": 72191781, "body": "What do I change to calculate the next column. (Column N)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7500527"}, "edited": false, "score": 0, "creation_date": 1488361499, "post_id": 42527365, "comment_id": 72192319, "body": "=IFNA(VLOOKUP(A2,&#39;User Usage Report OLD&#39;!E:N,10,FALSE)-VLOOKUP(A2,&#39;User Usage Report&#39;!E:N,10,FALSE),0)   Is this correct?"}], "tags": [], "owner": {"reputation": 73, "user_id": 7640152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adabb5cd029a32945173778cb36e81b9?s=128&d=identicon&r=PG&f=1", "display_name": "user7640152", "link": "https://stackoverflow.com/users/7640152/user7640152"}, "is_accepted": true, "score": 1, "last_activity_date": 1488358916, "creation_date": 1488358916, "answer_id": 42527365, "question_id": 42526272, "link": "https://stackoverflow.com/questions/42526272/lookup-name-in-two-sheets-to-make-sum/42527365#42527365", "title": "Lookup &quot;name&quot; in two sheets to make sum", "body": "<p>Place this formula in sheet 1, on row 2 :</p>\n\n<pre><code>=IFNA(VLOOKUP(A2,'User Usage Report OLD'!E:I,5,FALSE)-VLOOKUP(A2,'User Usage Report'!E:I,5,FALSE),0)\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7500527"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 42527365, "answer_count": 2, "score": 0, "last_activity_date": 1488358916, "creation_date": 1488355492, "last_edit_date": 1488357185, "question_id": 42526272, "link": "https://stackoverflow.com/questions/42526272/lookup-name-in-two-sheets-to-make-sum", "title": "Lookup &quot;name&quot; in two sheets to make sum", "body": "<p>I have a printer report with 3 Sheets.</p>\n\n<p>Sheet 1 (User Monthly Report) are where my results are \"pasted\".\n<a href=\"https://i.stack.imgur.com/XO1bS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XO1bS.png\" alt=\"User Monthly Report\"></a></p>\n\n<p>Sheet 2 (User Usage Report) holds the current printer count.\n<a href=\"https://i.stack.imgur.com/2Bliu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2Bliu.png\" alt=\"User Usage Report\"></a></p>\n\n<p>Sheet 3 (User Usage Report OLD) holds the previous months printer count.\n(Looks exactly like Sheet 2 (User Usage Report))</p>\n\n<p>In <strong>User Monthly Report; Column A</strong> there are names. (eg. <code>Kim Pearson</code>)</p>\n\n<p>I want to look up the name in <strong>User Monthly Report; Column A</strong> (<code>Kim Pearson</code>) in <strong>User Usage Report</strong> and <strong>User Usage Report OLD</strong>, and IF the name <code>Kim Pearson</code> appears in both of these sheets, then, it must <strong><em>minus</em></strong> the number in <strong>User Usage Report; Column I</strong> from the number in <strong>User Usage Report OLD; Column I</strong>.</p>\n\n<blockquote>\n  <p>NOTE: <code>Kim Pearson</code> is  in row 3 on <strong>User Usage Report</strong>, and in row 2 on <strong>User Usage Report OLD</strong>. And It will be the same with all other users (They will never be in the same row)</p>\n</blockquote>\n"}, {"tags": ["excel", "vba", "insert-update"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1488356202, "post_id": 42526242, "comment_id": 72188748, "body": "Your code is <b>Uncompilable</b>, you have 2 x <code>For x = 1 To cNum</code> and only 1 <code>Next</code>"}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1488357258, "post_id": 42526242, "comment_id": 72189398, "body": "Just to clarify, You have a userform with 7 textboxes that you want to put into Sheet1 column C, then you want to clear those textboxes without unloading the userform?"}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1488525046, "post_id": 42526799, "comment_id": 72278695, "body": "@Janice, did you get through it?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1489012230, "post_id": 42526799, "comment_id": 72490400, "body": "@Janice, any chance to get feedback from you?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1488357166, "creation_date": 1488357166, "answer_id": 42526799, "question_id": 42526242, "link": "https://stackoverflow.com/questions/42526242/how-to-update-data-using-vba-excel/42526799#42526799", "title": "How to update data using vba excel", "body": "<p>may be you're after this</p>\n\n<pre><code>Private Sub CommandButton_update_Click()    \n    Dim cNum As Integer\n    Dim x As Integer\n    Dim nextrow As Long '&lt;--| have nextrow store a row index, i.e. a Long value\n\n    cNum = 7\n    nextrow = Sheet1.cells(Sheet1.Rows.Count, 3).End(xlUp).Offset(1, 0).Row '&lt;--| store row index of column \"C\" first empty cell after last not empty one\n    For x = 1 To cNum\n        Me.Controls(\"TextBox\" &amp; x).Value = nextrow '&lt;--| set \"current \"TextBox value to nextrow\n        nextrow = nextrow + 1 '&lt;--| update nextrow\n    Next\n\n    MsgBox \"Sent\"\n\n    'Clear Control\n    cNum = 7\n    For x = 1 To cNum\n        Me.Controls(\"TextBox\" &amp; x).Value = \"\" '&lt;--| clear \"current\" TextBox \n    Next    \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7638769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5558df0e2c13ff8c1635019a9fe4eae2?s=128&d=identicon&r=PG&f=1", "display_name": "Janice", "link": "https://stackoverflow.com/users/7638769/janice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1448, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488357166, "creation_date": 1488355368, "question_id": 42526242, "link": "https://stackoverflow.com/questions/42526242/how-to-update-data-using-vba-excel", "title": "How to update data using vba excel", "body": "<p>Can someone please help me to correct my code as I can't make my update button in userform works. Below are my code:</p>\n\n<pre><code>Private Sub CommandButton_update_Click()\nDim cNum As Integer\nDim x As Integer\nDim nextrow As Range\n\ncNum = 7\nSet nextrow = Sheet1.Cells(Rows.Count, 3).End(xlUp).Offset(1, 0)\nFor x = 1 To cNum\nnextrow = Me.Controls(\"TextBox\" &amp; x).Value\nSet nextrow = nextrow.Offset(0, 1)\nNext\nMsgBox \"Sent\"\n'Clear Control\ncNum = 7\nFor x = 1 To cNum\nFor x = 1 To cNum\nnextrow = Me.Controls(\"TextBox\" &amp; x).Value = \"\"\nSet nextrow = nextrow.Offset(0, 1)\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 3648293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41308d454b9ce0ec8bb24bcad34b89a9?s=128&d=identicon&r=PG&f=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/3648293/allan"}, "edited": false, "score": 0, "creation_date": 1488361692, "post_id": 42526650, "comment_id": 72192433, "body": "thanks Peh, where do I add this to the parent code? As I said I am a novice :)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 15, "user_id": 3648293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41308d454b9ce0ec8bb24bcad34b89a9?s=128&d=identicon&r=PG&f=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/3648293/allan"}, "edited": false, "score": 0, "creation_date": 1488363089, "post_id": 42526650, "comment_id": 72193442, "body": "Sorry, but StackOverflow is not a free code writing service nor a site to teach you coding VBA (for this purpose there are other websites). I can only show up possibilities or techniques. If you need a full working code then this is the wrong place. My answer above is just a show case &#39;how it could be done&#39; not a ready to use solution."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1488356718, "creation_date": 1488356718, "answer_id": 42526650, "question_id": 42526080, "link": "https://stackoverflow.com/questions/42526080/convert-rtf-to-docx-with-vba/42526650#42526650", "title": "Convert RTF to DOCX with VBA", "body": "<p>I see 2 different ways to do this.</p>\n\n<ol>\n<li><p>Hard remove/delete the text with find/replace. Here I see no possibility to bring that text back in any way. Gone is gone.</p></li>\n<li><p>Hide the text from printing with formatting it as hidden text.</p></li>\n</ol>\n\n<p><strong>Hard Remove</strong></p>\n\n<pre><code>Selection.Find.ClearFormatting\nSelection.Find.Replacement.ClearFormatting\nWith Selection.Find\n    .Text = \"\\[*\\]\"\n    .Replacement.Text = \"\"\n    .Forward = True\n    .Wrap = wdFindContinue\n    .Format = False\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchAllWordForms = False\n    .MatchSoundsLike = False\n    .MatchWildcards = True\nEnd With\nSelection.Find.Execute Replace:=wdReplaceAll\n</code></pre>\n\n<p><strong>Hide from printing</strong>  </p>\n\n<pre><code>Selection.Find.ClearFormatting\nSelection.Find.Replacement.ClearFormatting\nSelection.Find.Replacement.Font.Hidden = True\nWith Selection.Find\n    .Text = \"\\[*\\]\"\n    .Replacement.Text = \"\"\n    .Forward = True\n    .Wrap = wdFindContinue\n    .Format = True\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchAllWordForms = False\n    .MatchSoundsLike = False\n    .MatchWildcards = True\nEnd With\nSelection.Find.Execute Replace:=wdReplaceAll\n\n'if this line is not used the text might be visible on the screen but not on print.\nActiveWindow.ActivePane.View.ShowAll = False\n</code></pre>\n\n<p><strong>Unhiding the text from printing</strong><br>\nThis should un hide the text when converting back to <code>.rtf</code></p>\n\n<pre><code>Selection.Find.ClearFormatting\nSelection.Find.Replacement.ClearFormatting\nSelection.Find.Font.Hidden = True\nSelection.Find.Replacement.Font.Hidden = False\nWith Selection.Find\n    .Text = \"\\[*\\]\"\n    .Replacement.Text = \"\"\n    .Forward = True\n    .Wrap = wdFindContinue\n    .Format = True\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchAllWordForms = False\n    .MatchSoundsLike = False\n    .MatchWildcards = True\nEnd With\nSelection.Find.Execute Replace:=wdReplaceAll\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 3648293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41308d454b9ce0ec8bb24bcad34b89a9?s=128&d=identicon&r=PG&f=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/3648293/allan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1097, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593904710, "creation_date": 1488354822, "last_edit_date": 1593904710, "question_id": 42526080, "link": "https://stackoverflow.com/questions/42526080/convert-rtf-to-docx-with-vba", "title": "Convert RTF to DOCX with VBA", "body": "<p>I am a novice at this but I convert <code>.RTF</code> files in a whole folder to <code>.DOCX</code> files using this code below.</p>\n\n<pre><code>Sub BatchConvertToDocx()\n    Application.ScreenUpdating = False\n    Dim strFolder As String, strFile As String, wdDoc As Document\n    strFolder = GetFolder\n    If strFolder = \"\" Then Exit Sub\n    strFile = Dir(strFolder &amp; \"\\*.rtf\", vbNormal)\n    While strFile &lt;&gt; \"\"\n      Set wdDoc = Documents.Open(FileName:=strFolder &amp; \"\\\" &amp; strFile, AddToRecentFiles:=False, Visible:=False)\n      With wdDoc\n        .SaveAs2 FileName:=Left(.FullName, InStrRev(.FullName, \".\")) &amp; \"docx\", FileFormat:=wdFormatXMLDocument, AddToRecentFiles:=False\n        .Close wdDoNotSaveChanges\n      End With\n      strFile = Dir()\n    Wend\n    Set wdDoc = Nothing\n    App\n\n    lication.ScreenUpdating = True\nEnd Sub\n\nFunction GetFolder() As String\n    Dim oFolder As Object\n    GetFolder = \"\"\n    Set oFolder = CreateObject(\"Shell.Application\").BrowseForFolder(0, \"Choose a folder\", 0)\n    If (Not oFolder Is Nothing) Then GetFolder = oFolder.Items.Item.Path\n    Set oFolder = Nothing\nEnd Function\n</code></pre>\n\n<p>Could somebody please tell me how to hide text that is between square braces in the output <code>.docx</code> file?</p>\n\n<p>For example</p>\n\n<pre><code>Hi [This is the text that should be hidden] there.\n</code></pre>\n\n<p>Also, while converting the <code>.docx</code> file back to <code>.rtf</code> file, the text should reappear in the output <code>.rtf</code> file.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 1, "creation_date": 1488351725, "post_id": 42524926, "comment_id": 72186422, "body": "Are the Date/Time and &quot;Action for&quot; in a single cell with a line break or in two cells?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1488353821, "post_id": 42524926, "comment_id": 72187485, "body": "@MarkFitzgerald It&#39;s even worse. Obviously <b>everything</b> is in one cell as you can see from the screenshot.  Even there is more than one &quot;date/time&quot; and &quot;Action for&quot; in one cell. Everything is in cell <code>A1</code> and blocks are only separated by a free line within that cell. First thing should be to separate the blocks into own cells and then separate the dates from the actions. This should be only possible with VBA, I don&#39;t see any possibility for formulas."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1488354346, "post_id": 42524926, "comment_id": 72187761, "body": "I think the better question should be, where does the data come from? What is the source format. I think the first fault here is having everything in A1 and it would be much easier if there was a possibility to do some pre-processing before it is imported into Excel."}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1488356500, "post_id": 42524926, "comment_id": 72188917, "body": "@Peh, I agree that getting the source data changed to a usable format is preferable.  Failing that, the OP is going to have to use the VBA Split function to stuff all the elements into a variant array then do some processing on that."}, {"owner": {"reputation": 11, "user_id": 5548803, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c21c4ef8956ac6f5ae37bfcabd18e60b?s=128&d=identicon&r=PG&f=1", "display_name": "Ducatiduke", "link": "https://stackoverflow.com/users/5548803/ducatiduke"}, "edited": false, "score": 0, "creation_date": 1488385166, "post_id": 42524926, "comment_id": 72209275, "body": "Mark - It is not idea to say the least.  Peh - It is coming from a tool that i have no control over.  We are trying to modify the way the data comes out and will eventually... Until then, this is all i have to work with."}], "answers": [{"comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "reply_to_user": {"reputation": 11, "user_id": 5548803, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c21c4ef8956ac6f5ae37bfcabd18e60b?s=128&d=identicon&r=PG&f=1", "display_name": "Ducatiduke", "link": "https://stackoverflow.com/users/5548803/ducatiduke"}, "edited": false, "score": 0, "creation_date": 1488386380, "post_id": 42528097, "comment_id": 72210166, "body": "Well, it does depend on what you want exactly, one solution could be to replace with nothing all the characters that you don&#39;t want before you parse the data. The text you show in A1 came out fine for me, but removing the &quot;-&quot;  before parsing would reduce 1 column in the result."}], "tags": [], "owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "is_accepted": false, "score": 1, "last_activity_date": 1488360883, "creation_date": 1488360883, "answer_id": 42528097, "question_id": 42524926, "link": "https://stackoverflow.com/questions/42524926/parse-data-from-cell-in-excel/42528097#42528097", "title": "Parse data from cell in Excel", "body": "<p>I typed your first example in to a cell and used the \"text to column\" function and it splits it out if you set the delimiters where you want them. However, if your text then changes you will need to re-do the delimiters.</p>\n"}], "owner": {"reputation": 11, "user_id": 5548803, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c21c4ef8956ac6f5ae37bfcabd18e60b?s=128&d=identicon&r=PG&f=1", "display_name": "Ducatiduke", "link": "https://stackoverflow.com/users/5548803/ducatiduke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 732, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1488360883, "creation_date": 1488350572, "last_edit_date": 1531161705, "question_id": 42524926, "link": "https://stackoverflow.com/questions/42524926/parse-data-from-cell-in-excel", "title": "Parse data from cell in Excel", "body": "<p>I have looked online and SO but have not found anything similar to help. I have data in a cell and want to parse or extract the data like shown in this image </p>\n\n<p><a href=\"https://i.stack.imgur.com/cQfIV.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cQfIV.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I am thinking VBA is the way to go vs formula.  I am ok with formulas and a newby with VBA.  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1488353692, "post_id": 42523896, "comment_id": 72187422, "body": "So the delimiter is [Space] or multiple [Space]s?"}], "answers": [{"tags": [], "owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "is_accepted": false, "score": 1, "last_activity_date": 1488349424, "creation_date": 1488349424, "answer_id": 42524644, "question_id": 42523896, "link": "https://stackoverflow.com/questions/42523896/how-to-read-from-a-text-txt-file-and-place-data-into-an-excel-2016-document-u/42524644#42524644", "title": "How to read from a text (.txt) file and place data into an excel 2016 document using VBA Macros editor?", "body": "<p>Use following sub.</p>\n\n<pre><code>Sub txtImport()\n    With ActiveSheet.QueryTables.Add(Connection:= _\n        \"TEXT;C:\\Users\\HARUN\\Documents\\Test.txt\", Destination:=Range(\"$A$1\"))\n        .Name = \"Test\"\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 437\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = True\n        .TextFileTabDelimiter = False\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = False\n        .TextFileSpaceDelimiter = True\n        .TextFileColumnDataTypes = Array(1, 1, 1)\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n    End With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1488351141, "creation_date": 1488351141, "answer_id": 42525084, "question_id": 42523896, "link": "https://stackoverflow.com/questions/42523896/how-to-read-from-a-text-txt-file-and-place-data-into-an-excel-2016-document-u/42525084#42525084", "title": "How to read from a text (.txt) file and place data into an excel 2016 document using VBA Macros editor?", "body": "<p>Let's suppose you have csv file (like you have shown, just difference is in delimiters), then the code should be:</p>\n\n<pre><code>Sub ReadData()\nDim line, array() As String\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\nSet rfile = FSO.OpenTextFile(*your full path to the file*, 1) 'connection for reading\n\nDim i As Integer\ni = 1\nDo Until rfile.AtEndOfStream\n    line = rfile.ReadLine\n    array = Split(line, \",\") 'I assumed that delimiter is comma\n    For j = 0 To UBound(array)\n        Cells(i, j + 1).Value = array(j)\n    Next j \n    i = i + 1\nLoop\n\nrfile.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": false, "score": 1, "last_activity_date": 1488358276, "creation_date": 1488358276, "answer_id": 42527144, "question_id": 42523896, "link": "https://stackoverflow.com/questions/42523896/how-to-read-from-a-text-txt-file-and-place-data-into-an-excel-2016-document-u/42527144#42527144", "title": "How to read from a text (.txt) file and place data into an excel 2016 document using VBA Macros editor?", "body": "<p>This code will do that without looping and regardless of number of spaces between the columns.</p>\n\n<pre><code>Sub Test()\n\n Dim Fn As String, WS As Worksheet, st As String\n\n Fn = \"D:\\tttt\\test.txt\" ' the file path and name\n Set WS = Sheets(\"Sheet1\")\n\n 'Read text file to st string\n With CreateObject(\"Scripting.FileSystemObject\")\n    If Not .FileExists(Fn) Then\n        MsgBox Fn &amp; \"  : is missing.\"\n        Exit Sub\n    Else\n        If FileLen(Fn) = 0 Then\n            MsgBox Fn &amp; \"  : is empty\"\n            Exit Sub\n        Else\n            With .OpenTextFile(Fn, 1)\n             st = .ReadAll\n             .Close\n            End With\n        End If\n    End If\n End With\n\n 'Replace every one or more space in st string with vbTab\n With CreateObject(\"VBScript.RegExp\")\n  .Pattern = \"[ ]+\"\n  .Global = True\n  .Execute st\n  st = .Replace(st, vbTab)\n End With\n\n 'Put st string in Clipboard\n With CreateObject(\"New:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n    .SetText st\n    .PutInClipboard\n End With\n\n 'Paste Clipboard to range\n WS.Range(\"A1\").PasteSpecial\n\nEnd Sub \n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 7569747, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/1294896667259245/picture?type=large", "display_name": "Marco Soto", "link": "https://stackoverflow.com/users/7569747/marco-soto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 885, "favorite_count": 1, "answer_count": 3, "score": 2, "last_activity_date": 1488362208, "creation_date": 1488346158, "last_edit_date": 1488362208, "question_id": 42523896, "link": "https://stackoverflow.com/questions/42523896/how-to-read-from-a-text-txt-file-and-place-data-into-an-excel-2016-document-u", "title": "How to read from a text (.txt) file and place data into an excel 2016 document using VBA Macros editor?", "body": "<p>I need to read the following text document (see first picture):<a href=\"https://i.stack.imgur.com/TL97d.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TL97d.gif\" alt=\"Text document image\"></a></p>\n\n<p>and place data into an excel document in the pictured manner (see second image):\n<a href=\"https://i.stack.imgur.com/MKjt5.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MKjt5.gif\" alt=\"Excel document image\"></a></p>\n\n<p>I want to do this with an Excel VBA macros but I do not have the slightest idea on how to do so. I am very new to excel VBA and I do not have the slightest idea on where to begin.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 7382942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98b8138228506b71e114266c39b7c01?s=128&d=identicon&r=PG&f=1", "display_name": "RPM", "link": "https://stackoverflow.com/users/7382942/rpm"}, "edited": false, "score": 0, "creation_date": 1488357420, "post_id": 42526335, "comment_id": 72189513, "body": "yes im sorry its text... example Januari, Februari etc."}, {"owner": {"reputation": 15, "user_id": 7382942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98b8138228506b71e114266c39b7c01?s=128&d=identicon&r=PG&f=1", "display_name": "RPM", "link": "https://stackoverflow.com/users/7382942/rpm"}, "edited": false, "score": 0, "creation_date": 1488358911, "post_id": 42526335, "comment_id": 72190467, "body": "field [Works] its on the same field..so the code cant filter the data on the same field??"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 15, "user_id": 7382942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98b8138228506b71e114266c39b7c01?s=128&d=identicon&r=PG&f=1", "display_name": "RPM", "link": "https://stackoverflow.com/users/7382942/rpm"}, "edited": false, "score": 0, "creation_date": 1488359760, "post_id": 42526335, "comment_id": 72191025, "body": "Yes, but the two combos must return the same value - a bit odd - if any records should be returned. Again, study your secret output from Debug.Print."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": -1, "last_activity_date": 1488357812, "last_edit_date": 1488357812, "creation_date": 1488355728, "answer_id": 42526335, "question_id": 42523512, "link": "https://stackoverflow.com/questions/42523512/open-report-use-three-combobox-filter/42526335#42526335", "title": "Open Report Use Three Combobox Filter", "body": "<p>Month is a number, so try:</p>\n\n<pre><code>strWhereCondition = \"[month] = \" &amp; Me.cbmonth.Value _\n                &amp; \" and [Works] = '\" &amp; Me.cbwork.Value _\n                &amp; \"' and [Works] = '\" &amp; Me.cbwork2.Value &amp; \"'\"\n</code></pre>\n\n<p>Edit: Month is text.</p>\n\n<p>However, [Work] is supposed to match two potentially different values:</p>\n\n<pre><code>&amp; \"' and [Works] = '\" &amp; Me.cbwork.Value _\n&amp; \"' and [Works] = '\" &amp; Me.cbwork2.Value &amp; \"'\"\n</code></pre>\n\n<p>Should most likely be:</p>\n\n<pre><code>&amp; \"' and [Works] = '\" &amp; Me.cbwork.Value _\n&amp; \"' and [SomeOtherField] = '\" &amp; Me.cbwork2.Value &amp; \"'\"\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7382942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98b8138228506b71e114266c39b7c01?s=128&d=identicon&r=PG&f=1", "display_name": "RPM", "link": "https://stackoverflow.com/users/7382942/rpm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594640328, "creation_date": 1488344223, "last_edit_date": 1594640328, "question_id": 42523512, "link": "https://stackoverflow.com/questions/42523512/open-report-use-three-combobox-filter", "title": "Open Report Use Three Combobox Filter", "body": "<p>I have 3 combobox to filter data, then i want to open in command button to print preview..\nProblems I have if i used 2 combobox it works but when i used three combobox the report is blank...there's any problems with the code?? here's the code i used :</p>\n\n<pre><code>Dim strWhereCondition As String\nstrWhereCondition = \"[month] = '\" &amp; Me.cbmonth.Value _\n                    &amp; \"' and [Works] = '\" &amp; Me.cbwork.Value _\n                    &amp; \"' and [Works] = '\" &amp; Me.cbwork2.Value &amp; \"'\"\n\nDebug.Print strWhereCondition\nDoCmd.OpenReport \"Month List\", View:=acViewPreview, _\nWhereCondition:=strWhereCondition\n</code></pre>\n\n<p>and the requery for my form</p>\n\n<pre><code>SELECT *\nFROM MyTable \nWHERE (month = Forms!nameForm!cbmonth\nOR Forms!MeForm!cbwork IS NULL)\nAnd (works = Forms!nameForm!cbwork\nOR Forms!nameForm!cbwork IS NULL)\nAND (works = Forms!nameForm!cbwork2\nOR Forms!nameForm!cbwork2 IS NULL);\n</code></pre>\n\n<p>can anyone help?</p>\n"}, {"tags": ["vba", "excel", "runtime-error", "autosave"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1488345696, "post_id": 42523109, "comment_id": 72183885, "body": "Can you show your vba auto save code?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1488348136, "post_id": 42523109, "comment_id": 72184825, "body": "May be you should start adding text file log writing first thing in each Sub/Function to create tracks about where it went wrong. Painful but that&#39;s I locate whereabouts an error that causes Excel to crash itself. Then add more log or put breakpoints in that crashing Sub/Function."}, {"owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "edited": false, "score": 0, "creation_date": 1488350429, "post_id": 42523109, "comment_id": 72185788, "body": "0m3r, I don&#39;t have any auto save code on my file, I am talking about Excel&#39;s own Auto Recover system. That one works pretty well with all of other files (when anything happens) but doesn&#39;t work for this one. PatricK, thank you for your explanation but honestly I don&#39;t know how to create those tracks to follow where it goes wrong. And the thing is I have many modules and forms that not sure where to locate those breakpoints. And I need to wait for next excel crash (which cause AutoRecover) to track this thing and we don&#39;t know when it&#39;ll happen again."}, {"owner": {"reputation": 865, "user_id": 6588969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec413f82a9798b72db70b0585a7bec99?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Kuchlbauer", "link": "https://stackoverflow.com/users/6588969/julian-kuchlbauer"}, "edited": false, "score": 0, "creation_date": 1488352923, "post_id": 42523109, "comment_id": 72187020, "body": "Please show your BeforeSave or AfterSave functions, perhaps Excels autosave feature has a problem with one of them."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1488353892, "post_id": 42523109, "comment_id": 72187526, "body": "If you are getting that error when you <b>open</b> the file, do you have any Workbook_Open events?"}, {"owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1488501050, "post_id": 42523109, "comment_id": 72271022, "body": "@YowE3K That&#39;s correct, I also have Workbook_Open events. One of them is for Opening a Splash User Form on first opening, the other is to protect two sheets, if it&#39;s unprotected. There may be any thing because of them?"}, {"owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "reply_to_user": {"reputation": 865, "user_id": 6588969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec413f82a9798b72db70b0585a7bec99?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Kuchlbauer", "link": "https://stackoverflow.com/users/6588969/julian-kuchlbauer"}, "edited": false, "score": 0, "creation_date": 1488501066, "post_id": 42523109, "comment_id": 72271033, "body": "@JulianKuchlbauer how and where can I show BeforeSave or AfterSave functions?"}, {"owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1488501108, "post_id": 42523109, "comment_id": 72271047, "body": "@PatricK , thank you for your explanation but honestly I don&#39;t know how to create those tracks to follow where it goes wrong. And the thing is I have many modules and forms that not sure where to locate those breakpoints. And I need to wait for next excel crash (which cause AutoRecover) to track this thing and we don&#39;t know when it&#39;ll happen again."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1488507707, "post_id": 42523109, "comment_id": 72272985, "body": "If the error is happening when you <b>open</b> the files again, and you have <code>Workbook_Open</code> events, please edit the question and paste the code from those events into it so we can see whether anything there could be causing a subscript error.  (It&#39;s possibly something trying to be accessed prior to the load completely finishing - I have heard that is often an issue with Workbook_Open, and the opening from an autorecovered version may be slowing things down and exacerbating the problem.)"}, {"owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1488515877, "post_id": 42523109, "comment_id": 72275107, "body": "@YowE3K I&#39;ve just edited the question. As Workbook_Open event runs a user form and some macros related to that form, I also wrote the other codes as well."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1488522868, "post_id": 42523109, "comment_id": 72277644, "body": "I&#39;m not an expert with Forms, but it seems strange to me that you are trying to hide the title bar while still initializing the form, which I assume is occurring as a precursor to it being displayed.  I would have thought that <code>FindWindowA(vbNullString, frm.Caption)</code> wouldn&#39;t be able to find the window until it was actually created."}, {"owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493709069, "post_id": 42523109, "comment_id": 74507204, "body": "@YowE3K After 2 months hi again! I was still facing the same issue and today I remembered your suggestion and tried to delete every single parts of this splash screen process belong to Workbook_Open event. Finally I&#39;ve come up with the reason: <code>Windows(ThisWorkbook.Name).Visible = True</code> I don&#39;t know how it became False but, when I try to open auto-recover file, I realize that file is opening normally, my form is opening normally, but when form disappears, the error comes through. The reason is excel somehow can&#39;t turn  <code>Windows(ThisWorkbook.Name).Visible</code> to True. What do you think?"}, {"owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493710137, "post_id": 42523109, "comment_id": 74507785, "body": "@YowE3K, I think it&#39;s better for you to write your suggestion (The problem would be on Workbook_Open event) as an answer, I&#39;ll accept it.   Then as it&#39;s better to ask a new question for this Windows<code>(ThisWorkbook.Name).Visible = True</code> question, please refer to the new link [<a href=\"http://stackoverflow.com/questions/43732367/windowsthisworkbook-name-visible-true-causes-error-on-excels-auto-recovered]\" title=\"windowsthisworkbook name visible true causes error on excels auto recovered%5d\">stackoverflow.com/questions/43732367/&hellip;</a>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493712199, "post_id": 42523109, "comment_id": 74508976, "body": "@Mertinc - I would rather not post my guess as an &quot;answer&quot; as it really is a guess, and not having my &quot;answer&quot; there should make it (slightly) more likely that someone might notice the question and provide a real answer.  P.S. Isn&#39;t your <code>Windows(ThisWorkbook.Name).Visible</code> being set to <code>False</code> by your <code>ActiveWindow.Visible = False</code> statement? (Again, I stress that I&#39;m no expert in these type of matters, so I could easily be wrong.)"}, {"owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "edited": false, "score": 0, "creation_date": 1493775364, "post_id": 42523109, "comment_id": 74542076, "body": "Finally the issue is solved. You can check the answer, thanks for your effort on trying to help me."}], "answers": [{"tags": [], "owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "is_accepted": true, "score": 0, "last_activity_date": 1493775178, "creation_date": 1493775178, "answer_id": 43749682, "question_id": 42523109, "link": "https://stackoverflow.com/questions/42523109/autosaved-file-error-on-macro-enabled-excel-file/43749682#43749682", "title": "Autosaved file error on Macro Enabled Excel file", "body": "<p>After discussing with many people from many blogs, finally I came up with two solution. (First one is like error handling and the second one exactly solves the issue.) Special thanks to YowE3k,jkpieterse and Ryan Wells.</p>\n\n<p>First of everything, I would like to mention the reason, why it was happening:</p>\n\n<blockquote>\n  <p>The code fails because when Excel recovers a file, it adds some text\n  to the caption of the window, so that \"FileName.xlsx\" becomes\n  something like \"FileName.xlsx [Version last saved by user]\" (jkpieterse).</p>\n</blockquote>\n\n<p>Solutions:</p>\n\n<p>1) Basic Error Handling (Ryan Wells)</p>\n\n<p>If we know which line is causing error, we can comment out that line to protect our workbook. So if you comment out (or simply delete) the  :</p>\n\n<pre><code>ActiveWindow.Visible = False\n\nWindows(ThisWorkbook.Name).Visible = True\n</code></pre>\n\n<p>lines, that will stop the problem. </p>\n\n<p>2) Original Solution (jkpieterse)</p>\n\n<p>use a below routine in your <code>ThisWorkbook</code> object sheet.</p>\n\n<pre><code>Sub ShowaWindow(sFileName As String)\n    Dim oWb as Workbook\n    For Each oWb In Workbooks\n        If lCase(owb.Name) = lCase(sFileName) Then\n            oWb.Windows(1).Visible = True\n            Exit For\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>Then, in the <code>Workbook_Open</code> event, </p>\n\n<p>Instead of <code>Windows(ThisWorkbook.Name).Visible = True</code></p>\n\n<p>Use<code>ShowaWindow(ThisWorkbook.Name)</code> </p>\n\n<p>Then it will work like a charm! </p>\n"}], "owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 863, "favorite_count": 0, "accepted_answer_id": 43749682, "answer_count": 1, "score": 0, "last_activity_date": 1493775178, "creation_date": 1488341947, "last_edit_date": 1592644375, "question_id": 42523109, "link": "https://stackoverflow.com/questions/42523109/autosaved-file-error-on-macro-enabled-excel-file", "title": "Autosaved file error on Macro Enabled Excel file", "body": "<p>I am using Macro Enabled file (binary sheet) which has many modules/forms and sometimes when something go wrong with my laptop and excel shuts down suddenly, my autosave files doesn't work.</p>\n<p>I get that error on each autosaved file:</p>\n<blockquote>\n<p>Run-time error '9'</p>\n<p>Subscript out of range</p>\n</blockquote>\n<p>My autosave frequency is 5 minutes to save my back but that interestingly doesn't work for this file.</p>\n<p>I am even not able to follow where the error is because the only thing is opening on that autosaved file is White blank page. (That's why other Run-time error 9 questions on SO were not answer of my question) What kind of thing would be the reason and what is the possible solution?</p>\n<p><strong>UPDATE: Workbook_Open Events that I have in that Workbook</strong></p>\n<pre><code>Private Sub Workbook_Open()\n    Application.ScreenUpdating = False\n    ActiveWindow.Visible = False\n    SplashUserForm.Show\n    Windows(ThisWorkbook.Name).Visible = True\n    Application.ScreenUpdating = True\n    \n\n   With Sheet5\n        .Unprotect Password:=&quot;&quot;\n        .Protect DrawingObjects:=False, Contents:=True, Scenarios:= _\n        False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _\n        AllowFormattingRows:=True, AllowInsertingColumns:=True, AllowInsertingRows _\n        :=True, AllowInsertingHyperlinks:=True, AllowDeletingColumns:=True, _\n        AllowDeletingRows:=True, AllowSorting:=True, AllowFiltering:=True, _\n        AllowUsingPivotTables:=True, UserInterfaceOnly:=True\n        .EnableOutlining = True\n    End With\n    With Sheet16\n        .Unprotect Password:=&quot;&quot;\n        .Protect DrawingObjects:=False, Contents:=True, Scenarios:= _\n        False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _\n        AllowFormattingRows:=True, AllowInsertingColumns:=True, AllowInsertingRows _\n        :=True, AllowInsertingHyperlinks:=True, AllowDeletingColumns:=True, _\n        AllowDeletingRows:=True, AllowSorting:=True, AllowFiltering:=True, _\n        AllowUsingPivotTables:=True, UserInterfaceOnly:=True\n        .EnableOutlining = True\n    End With\n \n    \nEnd Sub\n</code></pre>\n<p>And here what my SplashUserForm has:</p>\n<pre><code>Private Sub UserForm_Activate()\n    Application.Wait (Now + TimeValue(&quot;00:00:01&quot;))\n    SplashUserForm.Label1.Caption = &quot;Loading Data...&quot;\n    SplashUserForm.Repaint\n    Application.Wait (Now + TimeValue(&quot;00:00:01&quot;))\n    SplashUserForm.Label1.Caption = &quot;Creating Forms...&quot;\n    SplashUserForm.Repaint\n    Application.Wait (Now + TimeValue(&quot;00:00:01&quot;))\n    SplashUserForm.Label1.Caption = &quot;Opening...&quot;\n    SplashUserForm.Repaint\n    Application.Wait (Now + TimeValue(&quot;00:00:01&quot;))\n    Unload SplashUserForm\nEnd Sub\n\n\nPrivate Sub UserForm_Initialize()\n\nHideTitleBar Me\nWith Me\n.StartUpPosition = 0\n.Left = Application.Left + (0.5 * Application.Width) - (0.5 * .Width)\n.Top = Application.Top + (0.5 * Application.Height) - (0.5 * .Height)\nEnd With\n\nEnd Sub\n\nOption Explicit\nOption Private Module\n\nPublic Const GWL_STYLE = -16\nPublic Const WS_CAPTION = &amp;HC00000\nPublic Declare Function GetWindowLong _\n                       Lib &quot;user32&quot; Alias &quot;GetWindowLongA&quot; ( _\n                       ByVal hWnd As Long, _\n                       ByVal nIndex As Long) As Long\nPublic Declare Function SetWindowLong _\n                       Lib &quot;user32&quot; Alias &quot;SetWindowLongA&quot; ( _\n                       ByVal hWnd As Long, _\n                       ByVal nIndex As Long, _\n                       ByVal dwNewLong As Long) As Long\nPublic Declare Function DrawMenuBar _\n                       Lib &quot;user32&quot; ( _\n                       ByVal hWnd As Long) As Long\nPublic Declare Function FindWindowA _\n                       Lib &quot;user32&quot; (ByVal lpClassName As String, _\n                       ByVal lpWindowName As String) As Long\n\nSub HideTitleBar(frm As Object)\n    Dim lngWindow As Long\n    Dim lFrmHdl As Long\n    lFrmHdl = FindWindowA(vbNullString, frm.Caption)\n    lngWindow = GetWindowLong(lFrmHdl, GWL_STYLE)\n    lngWindow = lngWindow And (Not WS_CAPTION)\n    Call SetWindowLong(lFrmHdl, GWL_STYLE, lngWindow)\n    Call DrawMenuBar(lFrmHdl)\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1488345743, "post_id": 42523063, "comment_id": 72183901, "body": "Which line throws the error ? You are missing a worksheet reference by the looks of it - <code>.Cells</code> is not a property of the <code>Axes</code> class."}, {"owner": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1488345897, "post_id": 42523063, "comment_id": 72183961, "body": "LastRow = .Cells(.Row.Count..... line is the one throwing the error message"}], "answers": [{"comments": [{"owner": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "edited": false, "score": 0, "creation_date": 1488349963, "post_id": 42523904, "comment_id": 72185593, "body": "The code is working but only for the minimum scale which is the first value but not the last value (max scale). In the link below, you can see the initial graph:  [link]<a href=\"http://imgur.com/a/dCz92\" rel=\"nofollow noreferrer\">imgur.com/a/dCz92</a>  Thus i need to make the graph full scale. Thats where the code comes in. The code above manage to set the minimum scale but not max scale as the pic below:  [link]<a href=\"http://imgur.com/a/NIJqG\" rel=\"nofollow noreferrer\">imgur.com/a/NIJqG</a>"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "edited": false, "score": 0, "creation_date": 1488350251, "post_id": 42523904, "comment_id": 72185710, "body": "Its not possible to understand how your code works re setting the axes with no source data etc. Your question was about fixing a totally different error..."}, {"owner": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "edited": false, "score": 0, "creation_date": 1488350523, "post_id": 42523904, "comment_id": 72185825, "body": "Hi Robin. Here is the link for the data file. <a href=\"https://wetransfer.com/downloads/c7fbe8ffd72778942d35c907fc78749d20170301064051/22f747924a806349a475b0ad83373f2420170301064051/e64cab\" rel=\"nofollow noreferrer\">wetransfer.com/downloads/&hellip;</a>"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "edited": false, "score": 0, "creation_date": 1488351716, "post_id": 42523904, "comment_id": 72186417, "body": "Hi Jeeva - normally you ask a question about something and if someone answers then great - you had your question answered. If you have a second question then you should start another post. It considered polite to just restrict yourself to one-thread-one-issue. best of luck."}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": false, "score": 0, "last_activity_date": 1488346180, "creation_date": 1488346180, "answer_id": 42523904, "question_id": 42523063, "link": "https://stackoverflow.com/questions/42523063/excel-vba-error-in-updating-chart-scale/42523904#42523904", "title": "Excel VBA - Error in Updating Chart Scale", "body": "<p><code>.Cells</code> is not a property of the <code>Axes</code> class and within your <code>With</code> statement it reads that you want to access that property of <code>Axes</code> when, it is likely you are trying to get <code>Cells</code> property of the worksheet that the chart is on. To get a reference to the worksheet you can use:</p>\n\n<pre><code>Dim ws As Worksheet\n\nSet ws = ActiveChart.Parent.Parent\n</code></pre>\n\n<p>And then use the <code>ws</code> reference when you get the <code>LastRow</code> value:</p>\n\n<pre><code>Option Explicit\n\nSub ScaleAxes()\n\n    Dim LastRow, LastRow2 As Long\n    Dim ws As Worksheet\n\n    Set ws = ActiveChart.Parent.Parent\n\n    With ActiveChart.Axes(xlCategory, xlPrimary)\n        LastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n        .MaximumScale = LastRow\n        .MinimumScale = ActiveSheet.Range(\"A2\").Value\n    End With\n    With ActiveChart.Axes(xlValue, xlPrimary)\n        LastRow2 = ws.Cells(ws.Rows.Count, \"B\").End(xlUp).Row\n        .MaximumScale = LastRow2\n        .MinimumScale = ActiveSheet.Range(\"B2\").Value\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 264, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1488346180, "creation_date": 1488341628, "question_id": 42523063, "link": "https://stackoverflow.com/questions/42523063/excel-vba-error-in-updating-chart-scale", "title": "Excel VBA - Error in Updating Chart Scale", "body": "<p>i found a way to update chart for the maximum and minimum scale. I tweaked the code to find the value for the maximum scale which is the last row. Below is the code:</p>\n\n<pre><code>Sub ScaleAxes()\n\nDim LastRow, LastRow2 As Long\n\n  With ActiveChart.Axes(xlCategory, xlPrimary)\n    LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    .MaximumScale = LastRow\n    .MinimumScale = ActiveSheet.Range(\"A2\").Value\n  End With\n  With ActiveChart.Axes(xlValue, xlPrimary)\n    LastRow2 = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n    .MaximumScale = LastRow2\n    .MinimumScale = ActiveSheet.Range(\"B2\").Value\n  End With\nEnd Sub\n</code></pre>\n\n<p>However i getting \"Object doesn't support this property or method\" error. Im not sure which part my code is wrong. Hope you guys can help me.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1488341391, "post_id": 42522954, "comment_id": 72182596, "body": "should be <code>= firstBlank - 2</code> .  Also, you should dim as Long rather than Double"}, {"owner": {"reputation": 43, "user_id": 1777263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577d933d71bffa51f80ddd394e4cd83b?s=128&d=identicon&r=PG", "display_name": "DG85", "link": "https://stackoverflow.com/users/1777263/dg85"}, "edited": false, "score": 1, "creation_date": 1488341394, "post_id": 42522954, "comment_id": 72182598, "body": "C2 is a cell that contains my column label (Customer). I want the code to look downwards and find the first empty cell in that column (thus pointing to that as the next cell) for me to place my values in there."}, {"owner": {"reputation": 43, "user_id": 1777263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577d933d71bffa51f80ddd394e4cd83b?s=128&d=identicon&r=PG", "display_name": "DG85", "link": "https://stackoverflow.com/users/1777263/dg85"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1488341471, "post_id": 42522954, "comment_id": 72182619, "body": "@chrisneilsen i&#39;ve tried doing that. It returns the same error."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1488341719, "post_id": 42522954, "comment_id": 72182678, "body": "Why do you subtract a string literal (<code>&quot;2&quot;</code>) from <code>firstBlank</code>? What&#39;s the value of <code>firstBlank</code> when it blows up?"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1488341779, "post_id": 42522954, "comment_id": 72182695, "body": "@user1777263 your code runs without error for me.  (as to the <code>&quot;2&quot;</code> vs <code>2</code> : why would you want to subtract a string? - actually vba does an implicit type conversion anyway)"}, {"owner": {"reputation": 43, "user_id": 1777263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577d933d71bffa51f80ddd394e4cd83b?s=128&d=identicon&r=PG", "display_name": "DG85", "link": "https://stackoverflow.com/users/1777263/dg85"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1488341902, "post_id": 42522954, "comment_id": 72182725, "body": "@Mat&#39;sMug Apologies, because my first 2 rows are for labeling purposes, firstBlank returns as 3 (if it&#39;s for the first entry) because the lastrowIndex will be 2.   I have tried both using 2 or &quot;2&quot; but either case gives me the same error."}, {"owner": {"reputation": 43, "user_id": 1777263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577d933d71bffa51f80ddd394e4cd83b?s=128&d=identicon&r=PG", "display_name": "DG85", "link": "https://stackoverflow.com/users/1777263/dg85"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1488342007, "post_id": 42522954, "comment_id": 72182760, "body": "@chrisneilsen That&#39;s weird. My code is placed under the Workbook &gt; Module sub-branch. Is that where it&#39;s placed in your case?"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1488343134, "post_id": 42522954, "comment_id": 72183067, "body": "is the result of <code>MsgBox &quot;A&quot; &amp; firstBlank</code> a <code>A1.0</code> before the error?"}, {"owner": {"reputation": 43, "user_id": 1777263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577d933d71bffa51f80ddd394e4cd83b?s=128&d=identicon&r=PG", "display_name": "DG85", "link": "https://stackoverflow.com/users/1777263/dg85"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1488346191, "post_id": 42522954, "comment_id": 72184051, "body": "@Slai The result of    MsgBox &quot;A&quot; &amp; firstBlank  returns a A1048577. I placed the code right before the error line. Weird!  lastrowIndex is 1048566 firstBlank is 1048577"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1488352270, "post_id": 42522954, "comment_id": 72186714, "body": "There is no row 1048577 - you have run off the bottom of the worksheet.  It&#39;s usually much safer to use something like <code>lastrowIndex = Data.Cells(Rows.Count,&quot;C&quot;).End(xlUp).Row</code> when trying to get the last occupied cell in a column."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 1777263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577d933d71bffa51f80ddd394e4cd83b?s=128&d=identicon&r=PG", "display_name": "DG85", "link": "https://stackoverflow.com/users/1777263/dg85"}, "edited": false, "score": 0, "creation_date": 1488356276, "post_id": 42525430, "comment_id": 72188794, "body": "Thanks a lot! The code worked like magic! Not really sure why my original code went off the charts and showed such a weird row number. Many thanks once again!"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 43, "user_id": 1777263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577d933d71bffa51f80ddd394e4cd83b?s=128&d=identicon&r=PG", "display_name": "DG85", "link": "https://stackoverflow.com/users/1777263/dg85"}, "edited": false, "score": 1, "creation_date": 1488356652, "post_id": 42525430, "comment_id": 72188999, "body": "you are welcome. your code <i>went off the chart</i> as a consequence of having empty cells beneath C2 only, so that <code>.End(xlDown).Row&#39; hits the bottom cell in the column returning its row index and </code>lastrowIndex + 1` exceeds it. <code>Data.Range(&quot;C2&quot;).End(xlDown)</code> behaviour is the same as if you select C2 and then pres CTRL+ArrowDown `"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1488353118, "last_edit_date": 1488353118, "creation_date": 1488352450, "answer_id": 42525430, "question_id": 42522954, "link": "https://stackoverflow.com/questions/42522954/excel-macro-method-range-of-object-worksheet-failed/42525430#42525430", "title": "Excel Macro - Method &#39;Range&#39; of object &#39;_Worksheet&#39; failed", "body": "<p>add a check to see if you hit the last row in the column should column C have only empty cells beneath row 2</p>\n\n<pre><code>lastrowIndex = Data.Range(\"C2\").End(xlDown).Row\nIf lastrowIndex = Data.Rows.Count Then lastrowIndex = 2 '&lt;--| if you hit the last row in the column then set lastrowIndex to \"header\" row index\nfirstBlank = lastrowIndex + 1\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 1777263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577d933d71bffa51f80ddd394e4cd83b?s=128&d=identicon&r=PG", "display_name": "DG85", "link": "https://stackoverflow.com/users/1777263/dg85"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 0, "accepted_answer_id": 42525430, "answer_count": 1, "score": -1, "last_activity_date": 1488353118, "creation_date": 1488340942, "last_edit_date": 1488341729, "question_id": 42522954, "link": "https://stackoverflow.com/questions/42522954/excel-macro-method-range-of-object-worksheet-failed", "title": "Excel Macro - Method &#39;Range&#39; of object &#39;_Worksheet&#39; failed", "body": "<p>I currently am attempting to create a simple data entry database system in a single workbook. There are 2 sheets, one named 'newEntry' and the other named 'Data'. </p>\n\n<p>I have a command button, to which a macro is assigned. The code in Module1 under Modules is as follows:</p>\n\n<pre><code>Application.ScreenUpdating = False\n\nDim newEntry As Worksheet\nDim Data As Worksheet\n\nDim lastrowIndex As Double\nDim firstBlank As Double\n\nSet newEntry = Worksheets(\"newEntry\")\nSet Data = Worksheets(\"Data\")\n\nlastrowIndex = Data.Range(\"C2\").End(xlDown).Row\n\nfirstBlank = lastrowIndex + 1\n\nnewEntry.Range(\"C2:C8\").Copy\n\nData.Range(\"A\" &amp; firstBlank).Value = firstBlank - \"2\"\nData.Range(\"B\" &amp; firstBlank).PasteSpecial Transpose:=True, SkipBlanks:=False\n\nnewEntry.Range(\"C2:C8\").Clear\n\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>Upon testing out the codes, I keep getting the error above. I have looked at various other solutions and tried tweaking my code but none works. Please help to advise what is the problem here. The command  button is in [newEntry] and so are the cells with values to be copied.</p>\n\n<blockquote>\n  <p>EDIT: The error pointer points to the following line   Data.Range(\"A\"\n  &amp; firstBlank).Value = firstBlank - \"2\"</p>\n</blockquote>\n\n<p>Please advise what may be the problem!</p>\n"}, {"tags": ["vba", "excel", "combobox"], "answers": [{"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1488339294, "creation_date": 1488339294, "answer_id": 42522696, "question_id": 42522255, "link": "https://stackoverflow.com/questions/42522255/vba-excel-userform-error-1004/42522696#42522696", "title": "VBA Excel Userform error 1004", "body": "<p><code>ComboBox.Value</code> gives the selected index, but you can get the selected item with <a href=\"http://www.get-digital-help.com/2011/12/21/working-with-combo-boxes-form-control-using-vba/\" rel=\"nofollow noreferrer\"><code>.List(.ListIndex)</code></a></p>\n\n<pre><code>Private Sub ComboBox_code_AfterUpdate()\n    Dim c As Range\n    Set c = Sheet1.Range(\"Code\").Resize(, 1).Find(Me.ComboBox_code.List(Me.ComboBox_code.ListIndex), , , xlWhole)\n\n    If c Is Nothing Then\n        MsgBox \"Incorrect Code\"\n        Me.ComboBox_code.ListIndex = -1\n    Else\n        Me.TextBox_outlet.Text = c(, 2)\n        Me.TextBox_invoice.Text = c(, 3)\n        Me.TextBox_sales.Text = c(, 4)\n        Me.TextBox_comm.Text = c(, 5)\n        Me.TextBox_gst.Text = c(, 6)\n        Me.TextBox_netsales.Text = c(, 7)\n    End If\nEnd Sub \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1488525080, "post_id": 42525761, "comment_id": 72278716, "body": "@Janice, did you get through it?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1489012278, "post_id": 42525761, "comment_id": 72490423, "body": "@Janice, any chance to get feedback from you?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1488357416, "last_edit_date": 1488357416, "creation_date": 1488353659, "answer_id": 42525761, "question_id": 42522255, "link": "https://stackoverflow.com/questions/42522255/vba-excel-userform-error-1004/42525761#42525761", "title": "VBA Excel Userform error 1004", "body": "<p>you should also test for any actual combobox value selection made by the user</p>\n\n<p>a <code>Select Case</code> block could be appropriate:</p>\n\n<pre><code>Private Sub ComboBox_code_AfterUpdate()\n    Dim codeRow As Long\n    Dim codeRng As Range\n\n    Set codeRng = Sheet1.Range(\"Code\")\n    With Me\n        Select Case True\n\n            'check if user selected a value\n            Case .ComboBox_code.ListIndex = -1\n                MsgBox \"No Code selected!\", vbCritical\n                .ComboBox_code.Value = \"\"\n\n            'check if value exist\n            Case WorksheetFunction.CountIf(codeRng.Resize(, 1), .ComboBox_code.Value) = 0\n                MsgBox \"Incorrect Code\", vbCritical\n                .ComboBox_code.Value = \"\"\n\n            Case Else\n                codeRow = WorksheetFunction.Match(.ComboBox_code.Value, Sheet1.Range(\"Code\"), 0) 'lookup value based on first combobox\n                .TextBox_outlet = codeRng.cells(codeRow, 2)\n                .TextBox_invoice = codeRng.cells(codeRow, 3)\n                .TextBox_sales = codeRng.cells(codeRow, 4)\n                .TextBox_comm = codeRng.cells(codeRow, 5)\n                .TextBox_gst = codeRng.cells(codeRow, 6)\n                .TextBox_netsales = codeRng.cells(codeRow, 7)\n        End Select\n    End With\nEnd Sub\n</code></pre>\n\n<p>Finally, you may also want to use the <code>ComboBox_code_Change()</code> event handler instead of <code>ComboBox_code_AfterUpdate()</code>: the former would fire at every combobox change (i.e. selection) while the latter would fire only once the combobox is no longer the active control i.e. you must wait for the user to leave the control</p>\n"}], "owner": {"reputation": 1, "user_id": 7638769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5558df0e2c13ff8c1635019a9fe4eae2?s=128&d=identicon&r=PG&f=1", "display_name": "Janice", "link": "https://stackoverflow.com/users/7638769/janice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 202, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1488357416, "creation_date": 1488336197, "last_edit_date": 1488336856, "question_id": 42522255, "link": "https://stackoverflow.com/questions/42522255/vba-excel-userform-error-1004", "title": "VBA Excel Userform error 1004", "body": "<p>I am creating a userform to update company data. The first control in my form is a combo box (which is code) and the rest are text box. Now I need to use vlookup to lookup my first control and the rest of the text box will be automatically updated with the code that I key in in my combo box. But the system shows error 1004. Can someone help me with this? Below is my combo box code:</p>\n\n<pre><code>Private Sub ComboBox_code_AfterUpdate()\n    'check if value exist\n    If WorksheetFunction.CountIf(Sheet1.Range(\"A:A\"), Me.ComboBox_code.Value) = 0 Then\n        MsgBox \"Incorrect Code\"\n        Me.ComboBox_code.Value = \"\"\n        Exit Sub\n\n    End If\n'lookup value based on first combobox\n    With Me\n        .TextBox_outlet = Application.WorksheetFunction.VLookup((Me.ComboBox_code), Sheet1.Range(\"Code\"), 2, 0)\n        .TextBox_invoice = Application.WorksheetFunction.VLookup((Me.ComboBox_code), Sheet1.Range(\"Code\"), 3, 0)\n        .TextBox_sales = Application.WorksheetFunction.VLookup((Me.ComboBox_code), Sheet1.Range(\"Code\"), 4, 0)\n        .TextBox_comm = Application.WorksheetFunction.VLookup((Me.ComboBox_code), Sheet1.Range(\"Code\"), 5, 0)\n        .TextBox_gst = Application.WorksheetFunction.VLookup((Me.ComboBox_code), Sheet1.Range(\"Code\"), 6, 0)\n        .TextBox_netsales = Application.WorksheetFunction.VLookup((Me.ComboBox_code), Sheet1.Range(\"Code\"), 7, 0)\n    End With\nEnd Sub \n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1488354806, "post_id": 42522049, "comment_id": 72188013, "body": "Or you have a linefeed more...  If rCell.Text &lt;&gt; &quot;&quot; rCell.Columns.EntireColumn.Hidden = True"}, {"owner": {"reputation": 142786, "user_id": 42346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZikEw.jpg?s=128&g=1", "display_name": "mechanical_meat", "link": "https://stackoverflow.com/users/42346/mechanical-meat"}, "edited": false, "score": 0, "creation_date": 1488425136, "post_id": 42522049, "comment_id": 72228030, "body": "Cheers, mate! Happy coding to you :-)"}], "tags": [], "owner": {"reputation": 142786, "user_id": 42346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZikEw.jpg?s=128&g=1", "display_name": "mechanical_meat", "link": "https://stackoverflow.com/users/42346/mechanical-meat"}, "is_accepted": false, "score": 1, "last_activity_date": 1488334820, "creation_date": 1488334820, "answer_id": 42522049, "question_id": 42522033, "link": "https://stackoverflow.com/questions/42522033/macro-error-next-without-for/42522049#42522049", "title": "Macro Error - Next without For", "body": "<p>You're missing an <code>end if</code>:</p>\n\n<pre><code>Sub hidecolumns1()\n\nDim rRange As Range\nDim rCell As Range\n\nSet rRange = Worksheets(\"Income Statement - Rollover\").Range(\"B54:KZ54\").Cells\n'Set rRange = Selection.Cells\n\n    For Each rCell In rRange\n        If rCell.Text &lt;&gt; \"\" Then\n            rCell.Columns.EntireColumn.Hidden = True\n        End If '&lt;---\n    Next rCell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7638709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fdd7861d24bab42c3e9713be3d9c1b4?s=128&d=identicon&r=PG&f=1", "display_name": "Ding Li", "link": "https://stackoverflow.com/users/7638709/ding-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488334820, "creation_date": 1488334707, "last_edit_date": 1488334780, "question_id": 42522033, "link": "https://stackoverflow.com/questions/42522033/macro-error-next-without-for", "title": "Macro Error - Next without For", "body": "<p>I have the following code to hide the columns with zero value in it for the defined range. Not sure why I always get the \"Next without For\" error. Can anyone help? Thanks.</p>\n\n<pre><code>Sub hidecolumns1()\n\nDim rRange As Range\nDim rCell As Range\n\nSet rRange = Worksheets(\"Income Statement - Rollover\").Range(\"B54:KZ54\").Cells\n'Set rRange = Selection.Cells\n\n    For Each rCell In rRange\n        If rCell.Text &lt;&gt; \"\" Then\n        rCell.Columns.EntireColumn.Hidden = True\n    Next rCell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "sql-server-2008-r2"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1488337842, "post_id": 42521857, "comment_id": 72181616, "body": "I tried and tried but cannot reproduce your issue though I use MSSQL 2012. Exact SQL (different tables) and same VBA objects and properties. Recordcount returns positive number fine. What is the <i>Driver</i> in connection string (the only other variable to test)? Regardless of record count does query return anything?"}, {"owner": {"reputation": 21, "user_id": 7638417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ab9fb0d2eafb6ec7b208136db5e1da0?s=128&d=identicon&r=PG&f=1", "display_name": "user7638417", "link": "https://stackoverflow.com/users/7638417/user7638417"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1488338640, "post_id": 42521857, "comment_id": 72181826, "body": "I do not have a driver setting in the connection string... My obfuscated connection string is...  &quot;Provider=SQLOLEDB.1;Data Source=server.address;uid=user;pwd=password;Initial Catalog=myDB&quot;.   The query does not return anything regardless of record count."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1488339198, "post_id": 42521857, "comment_id": 72181968, "body": "Wow! Even using <i>Provider</i> I cannot recreate your issue. Maybe you should try Driver:  <code>DRIVER={SQL Server};server=server;database=myDB;UID=user;PWD=password;</code> Try using the derived table (alternative to CTE): <code>SELECT main.* FROM (SELECT ...) AS main WHERE main.i = 1</code>."}], "answers": [{"comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1488397399, "post_id": 42534980, "comment_id": 72216968, "body": "This must be the MSSQL version (i.e., 2008 R2) and/or its interaction with <code>OLEDB Provider</code> though it is baffling why as CTEs were introduced in SQL Server 2005! If you have access to later version (2012/2014/2016), try the CTE on your end."}], "tags": [], "owner": {"reputation": 21, "user_id": 7638417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ab9fb0d2eafb6ec7b208136db5e1da0?s=128&d=identicon&r=PG&f=1", "display_name": "user7638417", "link": "https://stackoverflow.com/users/7638417/user7638417"}, "is_accepted": true, "score": 1, "last_activity_date": 1488430332, "last_edit_date": 1488430332, "creation_date": 1488380160, "answer_id": 42534980, "question_id": 42521857, "link": "https://stackoverflow.com/questions/42521857/excel-vba-adodb-sql-query-using-cte-returning-no-records/42534980#42534980", "title": "Excel VBA ADODB sql query using CTE returning no records", "body": "<p><b>Parfait</b> provided a solution for me in the comments to my original question.  Changing my connection string provider to a driver did not work.  It caused a <code>Run-time error '-2147467259 (80004005)'</code></p>\n\n<p>Instead of a CTE, I utilized a derived table in my query.</p>\n\n<p>The SQL query that returns a recordcount for me in VBA is:</p>\n\n<pre><code>SELECT main.*\nFROM (SELECT *, ROW_NUMBER() OVER (PARTITION BY [partNumber] \nORDER BY [date] DESC) AS i FROM [myDB].[dbo].[PartOrders] \nWHERE [partDescription] like '%motor%') \nAS main WHERE main.i = 1\n</code></pre>\n\n<p>Thank You!</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5013153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/920f39a3eddbbcec02d373b590cca534?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Kelleher", "link": "https://stackoverflow.com/users/5013153/richard-kelleher"}, "is_accepted": false, "score": 0, "last_activity_date": 1597427867, "creation_date": 1597427867, "answer_id": 63417853, "question_id": 42521857, "link": "https://stackoverflow.com/questions/42521857/excel-vba-adodb-sql-query-using-cte-returning-no-records/63417853#63417853", "title": "Excel VBA ADODB sql query using CTE returning no records", "body": "<p>I had the same issue except I was using Driver as recommended by user7638417.  When the recordset returned, the recordcount was -1, but, when I inserted the rows into the spreadsheet, they were all there (24).  Used simplified query in example, actual query was more complex which lead me to the CTE method.</p>\n<pre><code>    Dim sql As String\n    Dim dbConn As New ADODB.Connection\n    Dim dbRS As New ADODB.Recordset\n    Dim rows As Integer\n\n    sql = &quot;WITH S1 AS ( SELECT Lot, CollectDt, Mark, Slot, Thick1, Thick2 From Table1 )&quot;\n    sql = sql + &quot; WHERE Lot = 'lotnumber' &quot;\n    sql = sql + &quot; SELECT * FROM S1 WHERE Thick2 &lt;&gt; &quot;UNKNOWN&quot; ORDER BY Slot &quot;\n\n    dbConn.ConnectionString = &quot;Driver={SQL Server};server=myserver;database=production;uid=guest;pwd=guest&quot;\n    dbConn.Open\n    dbConn.CommandTimeout = 600\n    dbRS.Open sql, dbConn, adOpenStatic, adLockReadOnly\n        \n    Dim totRow As Integer\n    totRow = dbRS.RecordCount + 2\n\n   ' If (dbRS.RecordCount &gt; 0) Then\n        Sheet1.Cells(2, 1).CopyFromRecordset dbRS\n   ' End If\n</code></pre>\n<p>I had to comment out the check for data in order to get the data from the record set. The  value in totRow came back as 1 instead of 26, the expected value which causes other things to fail later in the code.\nSQL Server Version: 13.0.4001.0\nExcel Version: 2016</p>\n"}], "owner": {"reputation": 21, "user_id": 7638417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ab9fb0d2eafb6ec7b208136db5e1da0?s=128&d=identicon&r=PG&f=1", "display_name": "user7638417", "link": "https://stackoverflow.com/users/7638417/user7638417"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 704, "favorite_count": 0, "accepted_answer_id": 42534980, "answer_count": 2, "score": 1, "last_activity_date": 1597427867, "creation_date": 1488333372, "question_id": 42521857, "link": "https://stackoverflow.com/questions/42521857/excel-vba-adodb-sql-query-using-cte-returning-no-records", "title": "Excel VBA ADODB sql query using CTE returning no records", "body": "<p>This is my first question on Stack Overflow.  I have learned a lot from from this site but I have not been able to find the answer for a problem I am having.</p>\n\n<p>I have a SQL query that works in SQL Server 2008 R2 management studio but it does not work when I query it using vba in EXCEL 2013.  The query contains a common table expression and it is not returning any records to my recordset.</p>\n\n<p>The SQL query is:</p>\n\n<pre><code>WITH cte AS \n( SELECT *, ROW_NUMBER() OVER (PARTITION BY [partNumber] \nORDER BY [date] DESC) AS i FROM [myDB].[dbo].[PartOrders] \nWHERE [partDescription] like '%motor%' )\n\nSELECT * FROM cte WHERE i = 1\n</code></pre>\n\n<p>I have a reference for Microsoft ActiveX Data Objects 6.1 Library</p>\n\n<p>The VBA code I am using is:</p>\n\n<pre><code>Dim conn as ADODB.Connection\nDim sql as String\nDim rst as ADODB.Recordset\n\nSet conn = New ADODB.Connection\nconn.ConnectionString = myConnectionString\nconn.Open\n\nsql = \";WITH cte AS ( SELECT *, ROW_NUMBER() OVER (PARTITION BY \" &amp; _\n      \"[partNumber] ORDER BY [date] DESC) AS i \" &amp; _\n      \"FROM [myDB].[dbo].[PartOrders]\" &amp; _\n      \"WHERE [partDescription] like '%motor%' ) \" &amp; _\n      \"SELECT * FROM cte WHERE i = 1 \"\n\nSet rst = New ADODB.Recordset\nrst.Open sql, conn, adOpenStatic, adLockReadOnly, adCmdText\n\ndebug.print rst.recordcount\n\nconn.Close\nSet rst = Nothing\nSet conn = Nothing\n</code></pre>\n\n<p>My code prints a \"-1\" in the Immediate window</p>\n\n<p>I have added the preceding \";\" to my query based on a recommendation of another questions response.  It does not make a difference.</p>\n\n<p>I have verified the following query string returns a recordset:</p>\n\n<pre><code>sql = \"SELECT *, ROW_NUMBER() OVER (PARTITION BY \" &amp; _\n      \"[partNumber] ORDER BY [date] DESC) AS i \" &amp; _\n      \"FROM [myDB].[dbo].[partNumbers]\" &amp; _\n      \"WHERE [partDescription] like '%motor%'\"\n</code></pre>\n\n<p>I am using a CTE due to needing to collect entire records of a table but only of distinct part descriptions.  I do not want to see that a motor was ordered 20 times.  I would like to see that the motor was was ordered at least once along with the other fields associated with it.  I am searching a table with 730,000 records where there are records for 10,000 motors but only 500 distinct types.</p>\n\n<p>I am open to using a different query if it will net the same results but I am really curious as to why my current query is not yielding any records.  I hope it is not due to an ADODB and VBA incompability. </p>\n\n<p>Thank you for all of the help I have received from others questions and I appreciate any help you can provide me.</p>\n"}, {"tags": ["vba", "excel", "ms-access"], "comments": [{"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1488345396, "post_id": 42521746, "comment_id": 72183771, "body": "Welcome to StackOverflow! (1) When you say <i>data table</i>, do you mean a plain and simple <i>table</i> or <i>base table</i>, as opposed to a <i>linked table</i>? Or is it <i>linked to excel</i>?   (2) I understand that the query <b>creates</b> the linked table; is this accurate? It might help if you include the query in your question (go to SQL View, and include the text there.)   (3) How do the <i>user-defined parameters</i> affect the linked table?"}, {"owner": {"reputation": 11, "user_id": 7638587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90235a6ba11368016f6da495983f0fbf?s=128&d=identicon&r=PG&f=1", "display_name": "ABGPRB", "link": "https://stackoverflow.com/users/7638587/abgprb"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1488374929, "post_id": 42521746, "comment_id": 72201776, "body": "@ZevSpitz The Data Table is just a plain table in Access, containing the filtered data based on parameters entered by a user in an access form."}, {"owner": {"reputation": 11, "user_id": 7638587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90235a6ba11368016f6da495983f0fbf?s=128&d=identicon&r=PG&f=1", "display_name": "ABGPRB", "link": "https://stackoverflow.com/users/7638587/abgprb"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1488375454, "post_id": 42521746, "comment_id": 72202112, "body": "@ZevSpitz (1) The Data Table is just a plain table in Access, containing the filtered data based on parameters entered by a user in an access form. This Data table is linked to Excel via a shared connection. I have no issues with the Access side as that is working. My objective is to allow the end user to run an Access Macro from Excel. The Access Macro, does a re-query and provides updated data to the shared connection table in Excel. The issue is I can&#39;t get this work because the Shared connection makes Access think it is being used, and therefore the macro wont run until I remove the connec"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1488385183, "post_id": 42521746, "comment_id": 72209287, "body": "I&#39;m sorry, but I still don&#39;t understand -- Where does the data reside? Does it reside only in an Excel spreadsheet? Only in an Access base table (i.e. not a linked table)? Or is there an Access base table which holds a copy of some of the records in the spreadsheet, to which the user initiates a fill, and at that point the user also specifies which records should be inserted into the Access table?"}, {"owner": {"reputation": 11, "user_id": 7638587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90235a6ba11368016f6da495983f0fbf?s=128&d=identicon&r=PG&f=1", "display_name": "ABGPRB", "link": "https://stackoverflow.com/users/7638587/abgprb"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1488391741, "post_id": 42521746, "comment_id": 72213566, "body": "@ZevSpitz Sorry for confusion. I have in Access a primary data table, containing all customer quotes and information. I created an Access query to filter the data based on an Access Form, that users can enter parameters in. The end result is a table containing the filtered data in Access (Query1). In excel I have set up a shared connection between excel and Access which creates a table in excel with the data from the filtered access table (Query1). This table in excel is used to do more analysis."}, {"owner": {"reputation": 11, "user_id": 7638587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90235a6ba11368016f6da495983f0fbf?s=128&d=identicon&r=PG&f=1", "display_name": "ABGPRB", "link": "https://stackoverflow.com/users/7638587/abgprb"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1488392059, "post_id": 42521746, "comment_id": 72213748, "body": "@ZevSpitz the issue is that the user has to open Access, run the query, close Access, open the excel file and refresh the data. I would like to have a button in Excel, that runs the Access query and refreshes the linked table in excel to show the new data. I found some code which runs the access query, however it will only work when the shared connection is removed, but then the data in excel is not updated when refreshed. I get the error message &quot;Could not delete from the specified tables.&quot;"}, {"owner": {"reputation": 11, "user_id": 7638587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90235a6ba11368016f6da495983f0fbf?s=128&d=identicon&r=PG&f=1", "display_name": "ABGPRB", "link": "https://stackoverflow.com/users/7638587/abgprb"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1488392174, "post_id": 42521746, "comment_id": 72213819, "body": "Is it possible to break the shared connection, run the Access Query, reestablish the connection and refresh the excel linked table using VBA."}], "owner": {"reputation": 11, "user_id": 7638587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90235a6ba11368016f6da495983f0fbf?s=128&d=identicon&r=PG&f=1", "display_name": "ABGPRB", "link": "https://stackoverflow.com/users/7638587/abgprb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 449, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1489139482, "creation_date": 1488332463, "last_edit_date": 1489139482, "question_id": 42521746, "link": "https://stackoverflow.com/questions/42521746/excel-vba-to-run-access-macro-linked-table-issue", "title": "Excel VBA to run Access Macro---Linked Table issue", "body": "<p>I have an Access query that creates a data table based on user defined parameters.\nThe data table is linked to excel, with a shared connection to Access.</p>\n\n<p>I found some VBA code to run an Access macro from Excel, that basically reruns the query and updates the Access data table.</p>\n\n<p>The issue i am having, is that I can't run the Excel VBA code with the Shared Connection, as it shows an error saying it is unable to delete the data in access, and therefore cannot complete the query.</p>\n\n<p>The Excel VBA only works when the shared connection (linked Table) is removed.</p>\n\n<p>How can I run an Access Macro from Excel using VBA, so that the access table is updated, and then the linked shared connection table in excel is refreshed and new data is shown?</p>\n\n<p>Thanks! </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 7555213, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f389f053a619bf5ca158b2e4363be74e?s=128&d=identicon&r=PG&f=1", "display_name": "DWReyes", "link": "https://stackoverflow.com/users/7555213/dwreyes"}, "edited": false, "score": 0, "creation_date": 1488332207, "post_id": 42521652, "comment_id": 72180241, "body": "Thank you for your quick reply.  It helps to know that there&#39;s such a property. So thanks for that. However, a user can now select multiple merged cells without being redirected. Any way I could prevent that? Thanks!"}, {"owner": {"reputation": 1315, "user_id": 1250422, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/92d73842659c8dda791788d0fbaac4c5?s=128&d=identicon&r=PG", "display_name": "Archimaredes", "link": "https://stackoverflow.com/users/1250422/archimaredes"}, "reply_to_user": {"reputation": 73, "user_id": 7555213, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f389f053a619bf5ca158b2e4363be74e?s=128&d=identicon&r=PG&f=1", "display_name": "DWReyes", "link": "https://stackoverflow.com/users/7555213/dwreyes"}, "edited": false, "score": 0, "creation_date": 1488333177, "post_id": 42521652, "comment_id": 72180497, "body": "Testing on Excel 2016, MergeCells returns Null if multiple merged cells are selected; True if a single merged cell is selected; False if any number of unmerged cells are selected. Test this in whatever version you&#39;re using. If it still applies, that provides the mechanism you need."}, {"owner": {"reputation": 73, "user_id": 7555213, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f389f053a619bf5ca158b2e4363be74e?s=128&d=identicon&r=PG&f=1", "display_name": "DWReyes", "link": "https://stackoverflow.com/users/7555213/dwreyes"}, "edited": false, "score": 0, "creation_date": 1488340681, "post_id": 42521652, "comment_id": 72182383, "body": "I tested it already, the user could now select multiple merged cells (I&#39;m using Excel 2013). I&#39;m now researching into something along the lines of &quot;number of merged cells&quot; &lt;&gt; 1, Redirect. But still researching. Any more help would be appreciated. Once again, thank you very much!"}, {"owner": {"reputation": 73, "user_id": 7555213, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f389f053a619bf5ca158b2e4363be74e?s=128&d=identicon&r=PG&f=1", "display_name": "DWReyes", "link": "https://stackoverflow.com/users/7555213/dwreyes"}, "edited": false, "score": 0, "creation_date": 1488349731, "post_id": 42521652, "comment_id": 72185486, "body": "Thanks for your help. However, it has been solved fully more quickly by the other answer. This was a great help though."}], "tags": [], "owner": {"reputation": 1315, "user_id": 1250422, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/92d73842659c8dda791788d0fbaac4c5?s=128&d=identicon&r=PG", "display_name": "Archimaredes", "link": "https://stackoverflow.com/users/1250422/archimaredes"}, "is_accepted": false, "score": 1, "last_activity_date": 1488331728, "creation_date": 1488331728, "answer_id": 42521652, "question_id": 42521509, "link": "https://stackoverflow.com/questions/42521509/merged-cells-messing-up-vba-code-regarding-cell-selection/42521652#42521652", "title": "Merged Cells Messing Up VBA Code Regarding Cell Selection", "body": "<p>Range (and Selection) objects have the MergeCells property, which is a boolean indicating whether the range contains any merged cells. <a href=\"https://msdn.microsoft.com/en-us/library/office/ff197310.aspx\" rel=\"nofollow noreferrer\">See the docs.</a></p>\n\n<p>This means you could check whether <code>Selection.MergeCells</code> is <code>True</code> before continuing to redirect the selection.</p>\n"}, {"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 1, "last_activity_date": 1488340930, "creation_date": 1488340930, "answer_id": 42522952, "question_id": 42521509, "link": "https://stackoverflow.com/questions/42521509/merged-cells-messing-up-vba-code-regarding-cell-selection/42522952#42522952", "title": "Merged Cells Messing Up VBA Code Regarding Cell Selection", "body": "<p><code>Range.MergeCells</code> will return <code>TRUE</code>, <code>FALSE</code> or <code>Null</code> depending on the range</p>\n\n<ul>\n<li><code>TRUE</code> if Range is a single Merged range and nothing else</li>\n<li><code>FALSE</code> if Range consists of non-merged cells only</li>\n<li><code>Null</code> anything else, ie a Merged range plus one or more other cells (merged or otherwise)</li>\n</ul>\n\n<p>To utilise this consider</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Not Target.MergeCells Or IsNull(Target.MergeCells) Then\n        If Target.Cells.Count &gt; 1 Then\n            MsgBox \"Multiple Selection Disabled, refer to B1\"\n            Me.Cells(1, \"B\").Select\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 7555213, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f389f053a619bf5ca158b2e4363be74e?s=128&d=identicon&r=PG&f=1", "display_name": "DWReyes", "link": "https://stackoverflow.com/users/7555213/dwreyes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 872, "favorite_count": 0, "accepted_answer_id": 42522952, "answer_count": 2, "score": 1, "last_activity_date": 1488341316, "creation_date": 1488330647, "last_edit_date": 1531161705, "question_id": 42521509, "link": "https://stackoverflow.com/questions/42521509/merged-cells-messing-up-vba-code-regarding-cell-selection", "title": "Merged Cells Messing Up VBA Code Regarding Cell Selection", "body": "<p>I have the basic problem (which had already been answered a hundred times) on how to allow the user to only select a single cell at a time (prevent multiple cells being active). If the user tried, it would redirect the active selection to a specific cell (B1). Based on a quick google search, intelligent copy and pasting, and some slight edits, this is what I end up with:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n     '&gt;&gt; Prevent user from multiple selections\n\n    If Selection.Cells.Count &gt; 1 Then\n        MsgBox \"Multiple Selection Disabled, refer to B1\"\n        ActiveSheet.Range(\"B1\").Select\n        Exit Sub\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>A simple code. However, the problem I run into is that whenever I select a merged cell, the code triggers since the selection is, according to excel, more than one cell. How do I go around this? Thanks.</p>\n\n<p>I've inherited this file from another person, so there was already a lot of merged cells. And my worksheet is highly automatized and VBA rich. Asking me to remove all merged cells is (practically) not an option.</p>\n"}, {"tags": ["excel", "vba", "dynamic", "conditional-formatting", "color-key"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1488330499, "post_id": 42521109, "comment_id": 72179836, "body": "Not sure a nested loop is appropriate here - don&#39;t you only want to color the cell on the same row as mCell ?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7638367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d23a9f451d409b2737d7d1fdbade869?s=128&d=identicon&r=PG&f=1", "display_name": "JuliaXu", "link": "https://stackoverflow.com/users/7638367/juliaxu"}, "edited": false, "score": 0, "creation_date": 1488379414, "post_id": 42521586, "comment_id": 72204860, "body": "The rule is if the text in the target cell matches text in a color key cell, then the target cell should take on the interior color of the color key cell.   Yes! I think a dictionary will work quite well based on your description; however, I am getting a run-time error 457 &quot;the key is already associated with an element of this collection&quot;. Thoughts on why this may be?"}, {"owner": {"reputation": 13, "user_id": 7638367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d23a9f451d409b2737d7d1fdbade869?s=128&d=identicon&r=PG&f=1", "display_name": "JuliaXu", "link": "https://stackoverflow.com/users/7638367/juliaxu"}, "edited": false, "score": 0, "creation_date": 1488383305, "post_id": 42521586, "comment_id": 72207926, "body": "Update- I did not read through your notes clearly earlier. Because my key text is in the same column, I removed the &quot;offset&quot; from &quot;color_dict.add rr.offset(0,1).text,rr.interior.color&quot; and added &quot;offset&quot; to &quot;rr.interior.color=color_dict(rr.text)&quot; so the color would be applied to another column, and it worked beautifully. Thank you so much!!"}, {"owner": {"reputation": 3, "user_id": 6552778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aced75679ef04b5f43f8b7f714c53015?s=128&d=identicon&r=PG&f=1", "display_name": "LaplaceKis", "link": "https://stackoverflow.com/users/6552778/laplacekis"}, "reply_to_user": {"reputation": 13, "user_id": 7638367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d23a9f451d409b2737d7d1fdbade869?s=128&d=identicon&r=PG&f=1", "display_name": "JuliaXu", "link": "https://stackoverflow.com/users/7638367/juliaxu"}, "edited": false, "score": 0, "creation_date": 1488422026, "post_id": 42521586, "comment_id": 72227153, "body": "When using a VBA dictionary if you try to add an item with key that is already associated with an item in the dictionary, VBA will error. But with careful error catching, this is common pattern to filter only unique items (it is much quicker and more flexible than other methods). Basically, you want to <code>resume next</code> <code>on error</code>."}], "tags": [], "owner": {"reputation": 3, "user_id": 6552778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aced75679ef04b5f43f8b7f714c53015?s=128&d=identicon&r=PG&f=1", "display_name": "LaplaceKis", "link": "https://stackoverflow.com/users/6552778/laplacekis"}, "is_accepted": false, "score": 0, "last_activity_date": 1488422145, "last_edit_date": 1488422145, "creation_date": 1488331203, "answer_id": 42521586, "question_id": 42521109, "link": "https://stackoverflow.com/questions/42521109/excel-vba-conditional-formatting-using-dynamic-color-key/42521586#42521586", "title": "Excel vba conditional formatting using dynamic color key", "body": "<p>Not quite understanding the rule to decide what color the target cell should be from your description.</p>\n\n<p>But in any case, you probably want to create a <code>dictionary</code> to store colors against a <code>text</code> key. And then use this dictionary to loop over your target range and set the color of the cell by reading the text in that target cell (??)</p>\n\n<p>in the below, I assume the text to create the dictionary key is in the column next to range <code>color_key</code>. If the text you wish to read in to create the dictionary key is actually in the same column then remove the <code>offset</code> (or set it to 0 column offsets).</p>\n\n<p>I assume that <code>color_key</code> and <code>target_Range</code> are named ranges in your excel sheets (somewhere).</p>\n\n<pre><code>Sub getcol()\n\nDim rr As Range\nSet color_dict = CreateObject(\"Scripting.Dictionary\")\n\n For Each rr In Range(\"color_key\")\n    color_dict.Add rr.Offset(0, 1).Text, rr.Interior.Color\n Next\n\n For Each rr In Range(\"target_Range\")\n    rr.Interior.Color = color_dict(rr.Text)\n Next\n\nEnd Sub\n</code></pre>\n\n<p>The code <code>CELL.Interior.Color</code> returns an integer code that represents the cell fill color, as you mentioned you need the exact same color.</p>\n\n<p>A dictionary <code>dict</code> works by reading in (key, value) pairs using the syntax <code>dict.Add key, value</code>. And returns value when it is passed the corresponding key: <code>dict(key)=value</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 7638367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d23a9f451d409b2737d7d1fdbade869?s=128&d=identicon&r=PG&f=1", "display_name": "JuliaXu", "link": "https://stackoverflow.com/users/7638367/juliaxu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1394, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1488422145, "creation_date": 1488327685, "last_edit_date": 1488383486, "question_id": 42521109, "link": "https://stackoverflow.com/questions/42521109/excel-vba-conditional-formatting-using-dynamic-color-key", "title": "Excel vba conditional formatting using dynamic color key", "body": "<p>I'm trying to create an Excel macro that applies conditional formatting to a target column using the condition of cells in another column and the format of cells in yet another column (essentially a color key). </p>\n\n<p>The color key is a single column chart with colored cells containing text in each row (e.g. blue cell with \"blue\" as the text). </p>\n\n<p>The goal is to be able to change the fill colors or text in the color key and have the target cells automatically change to the new colors or condition without having to hardcode the new RGB through Excel's conditional formatting rules manager. </p>\n\n<p>This would save a lot of time as there are a lot of colors, and they must be the exact RGB match.</p>\n\n<p>Here's what I have so far:</p>\n\n<pre><code>Sub ColorCode()\n\n'Applies conditional formatting to Input Chart using the Color Key\n\nApplication.ScreenUpdating = False\n\nDim ColorKey As Range\n\nSet ColorKey = Worksheets(2).Range(\"C6:C19\")\n\nDim kCell As Object\nDim lCell As Object\nDim mCell As Object\n\nWith Worksheets(2)\n    For Each mCell In Worksheets(2).Range(\"Input[Duration1]\")\n        If mCell.Value &lt;&gt; \"0\" Then\n            For Each lCell In Worksheets(2).Range(\"Input[Color1]\")\n                If lCell.Value &lt;&gt; \"\" Then\n                    For Each kCell In ColorKey.Cells\n                        If lCell.Value = kCell.Value Then\n                            mCell.Interior.Color = kCell.Interior.Color\n                            mCell.Font.Color = kCell.Font.Color\n                        End If\n                    Next\n                End If\n            Next\n        End If\n    Next\nEnd With\n</code></pre>\n\n<p>This loops through each of the cells in the columns and actually colors them in. The issue is all of the cells are colored to the condition of the last cell, so all of the colors are the same rather than each cell being formatted for its own condition. </p>\n\n<p>Before adding <code>\"application.screenupdating=false\"</code>, I can see the colors flickering while it's looping, but they just won't stick. When I try to add <strong><code>\"ByVal Target as Range\"</code></strong> to my code, my macro disappears, and to be honest, even though I've looked this up I don't really understand what this means.</p>\n\n<p>I'm new to VBA, and am pretty sure I'm missing something simple. I'd really appreciate any help with this!</p>\n\n<p><strong>I'm marking this as answered - Here is the updated code!</strong></p>\n\n<pre><code>Sub getcol()\n\nDim rr As Range\nDim tg  As Range\n\n    Set color_dict = CreateObject(\"Scripting.Dictionary\"\n\n        For Each rr In Range(\"colorkey\")\n            color_dict.Add rr.Text, rr.Interior.Color\n        Next\n\n\n        For Each rr In Range(\"input[color1]\")\n            rr.Offset(0, -2).Interior.Color = color_dict(rr.Text)\n\n        Next\n\n        End Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1488329867, "post_id": 42521024, "comment_id": 72179676, "body": "you can try <code>Set ran1 = doc.StoryRanges(wdPrimaryFooterStory)</code>"}, {"owner": {"reputation": 3, "user_id": 7474394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5c46bafa9fc6bb1a270971e1e2e06a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jodi", "link": "https://stackoverflow.com/users/7474394/jodi"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1488387665, "post_id": 42521024, "comment_id": 72211070, "body": "@Slai when I use that, it tells me the requested member of the collection doesn&#39;t exist"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7474394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5c46bafa9fc6bb1a270971e1e2e06a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jodi", "link": "https://stackoverflow.com/users/7474394/jodi"}, "edited": false, "score": 0, "creation_date": 1488387777, "post_id": 42521856, "comment_id": 72211152, "body": "my version of VBA won&#39;t let me refer to the footer with the <code>wdHeaderFooterPrimary</code> string, I have to use <code>Sections(1).Footers(1)</code>, otherwise I receive an error telling me the member of the collection doesn&#39;t exist"}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "reply_to_user": {"reputation": 3, "user_id": 7474394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5c46bafa9fc6bb1a270971e1e2e06a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jodi", "link": "https://stackoverflow.com/users/7474394/jodi"}, "edited": false, "score": 0, "creation_date": 1488388297, "post_id": 42521856, "comment_id": 72211491, "body": "Curious what version of VBA you&#39;re using. In Tools|References is the reference to <code>Microsoft Word ##.# Object Library</code> selected? That&#39;s where <code>wdHeaderFooterPrimary</code> is defined. Did <code>Section(1)</code> help?"}, {"owner": {"reputation": 3, "user_id": 7474394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5c46bafa9fc6bb1a270971e1e2e06a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jodi", "link": "https://stackoverflow.com/users/7474394/jodi"}, "edited": false, "score": 0, "creation_date": 1488484960, "post_id": 42521856, "comment_id": 72263606, "body": "Oh my goodness, I had done so much simple document editing with only the Excel object library enabled without issue that I hadn&#39;t considered enabling the Word library. For curiosity&#39;s sake, I&#39;ve been using VBA with Office 2010. Thank you so much for the reminder!"}], "tags": [], "owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "is_accepted": true, "score": 0, "last_activity_date": 1488333370, "creation_date": 1488333370, "answer_id": 42521856, "question_id": 42521024, "link": "https://stackoverflow.com/questions/42521024/value-out-of-range-entering-field-in-word-footer-vba/42521856#42521856", "title": "value out of range entering field in Word footer VBA", "body": "<p>The error you saw may have occurred because you need to supply a section number.  Try this:</p>\n\n<pre><code>Set ran1 = doc.Sections(1).Footers(wdHeaderFooterPrimary).Range\nran1.Text = \"This is an uncontrolled document when printed or saved. \" &amp; _\n                \"See online database for most recent version.\"\nran1.InsertAfter (vbCrLf &amp; \"Save Date: \")\nran1.Collapse Direction:=wdCollapseEnd\nran1.fields.Add Range:=ran1, Type:=wdFieldEmpty, Text:=\"SAVEDATE \\@ \"\"yyyy/MM/dd\"\"\", PreserveFormatting:=True\nSet ran1 = doc.Sections(1).Footers(wdHeaderFooterPrimary).Range\nran1.InsertAfter (vbTab &amp; \"Print Date: \")\nran1.Collapse Direction:=wdCollapseEnd\nran1.fields.Add Range:=ran1, Type:=wdFieldEmpty, Text:=\"PRINTDATE \\@ \"\"yyyy/MM/dd\"\"\", PreserveFormatting:=True\n</code></pre>\n\n<p>Depending on your document structure you may need to fiddle with # in Section(#) and with <code>wdHeaderFooterPrimary</code> versus <code>wdHeaderFooterPrimary</code>.</p>\n\n<p>Hope that helps</p>\n"}], "owner": {"reputation": 3, "user_id": 7474394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5c46bafa9fc6bb1a270971e1e2e06a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jodi", "link": "https://stackoverflow.com/users/7474394/jodi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 416, "favorite_count": 0, "accepted_answer_id": 42521856, "answer_count": 1, "score": 0, "last_activity_date": 1488333370, "creation_date": 1488327170, "last_edit_date": 1495539967, "question_id": 42521024, "link": "https://stackoverflow.com/questions/42521024/value-out-of-range-entering-field-in-word-footer-vba", "title": "value out of range entering field in Word footer VBA", "body": "<p>I <a href=\"https://stackoverflow.com/questions/41877723/value-out-of-range-error-4608-for-entering-fields-in-footer-using-vba\">previously asked a question</a> which went unanswered. I'd like to revive that here, perhaps a bit simpler, and hopefully I can have that question answered. </p>\n\n<p>I need to change the formatting in the footer of over 500 documents and would like to not do it by hand. \nI recorded a macro in an empty document, modified it to clean it up and to not use the selection property: it worked excellently. Once I copy/pasted that block of code into my existing code and I tried it on a document that needs to be changed, I could no longer insert the fields at all and I received a \"4608 Value Out of Range\" error. If I dimension my <code>ran1</code> variable as a <code>Range</code>, i get a type mismatch at the definition of the range.\nI'd like some help to get the fields actually inserted in the footer.</p>\n\n<p>Below is the code that I am currently working with:</p>\n\n<pre><code>Sub EnterFieldInFooter()\n\nDim wor As Object\nDim fso As Object\nDim fol As Object\nDim fil As Object\nDim doc As Object\n\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet fol = fso.GetFolder(\"M:\\test\")\n\nDim ran1 As Object\n\ni = 3\n\nSet wor = CreateObject(\"word.application\")\n\nFor Each fil In fol.Files\n\n    If Right(fil.Name, 4) = \".doc\" Or Right(fil.Name, 5) = \".docx\" And Left(fil.Name, 2) &lt;&gt; \"~$\" Then\n        ' open the document\n        Set doc = wor.documents.Open(Filename:=fil.Path)\n\n        Set ran1= doc.sections.first.footers(1).Range 'footer range\n\n        ' Set qualifying statement\n        ran1.Text = \"This is an uncontrolled document when printed or saved. \" &amp; _\n                    \"See online database for most recent version.\"\n        ' Enter the last saved date\n        ran1.InsertAfter (vbCrLf &amp; \"Save Date: \")\n        ran1.Collapse Direction:=wdCollapseEnd\n        Set ran1 = doc.sections.first.footers(1).Range\n        ran1.Fields.Add Range:=ran1, Type:=wdFieldEmpty, Text:=\"SAVEDATE \\@ \"\"yyyy/MM/dd\"\"\", PreserveFormatting:=True\n        ' Enter the last printed date\n        Set ran1 = doc.sections.first.footers(1).Range\n        ran1.InsertAfter (vbTab &amp; \"Print Date: \")\n        ran1.Collapse Direction:=wdCollapseEnd\n        ran1.Fields.Add Range:=ran1, Type:=wdFieldEmpty, Text:=\"PRINTDATE \\@ \"\"yyyy/MM/dd\"\"\", PreserveFormatting:=True\n\n        ' Save updated file\n        pat = \"M:\\test1\" &amp; \"\\\" &amp; fil.name\n        doc.saveas pat\n\n    End If\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "popup", "message"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1488327104, "post_id": 42520968, "comment_id": 72178963, "body": "What exactly is &quot;a certain mistake in my coding&quot;? Can you edit the question to include the incorrect and expected behavior?"}, {"owner": {"reputation": 1, "user_id": 7637050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f851214ff39fa0f2b59e02a809b2c217?s=128&d=identicon&r=PG&f=1", "display_name": "G.T.J", "link": "https://stackoverflow.com/users/7637050/g-t-j"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1488327580, "post_id": 42520968, "comment_id": 72179084, "body": "@comintern I made corrections !"}], "answers": [{"tags": [], "owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "is_accepted": false, "score": 0, "last_activity_date": 1488390207, "last_edit_date": 1488390207, "creation_date": 1488388826, "answer_id": 42538087, "question_id": 42520968, "link": "https://stackoverflow.com/questions/42520968/pop-up-message-when-the-stock-levels-reach-the-critical-level/42538087#42538087", "title": "Pop Up Message when the Stock Levels reach the Critical Level", "body": "<p>Further to my comment this is a not going to work. Create a list box and populate it with the stock shortages, something like this;</p>\n\n<pre><code>Dim rsAlert         As Recordset\nDim sSql            As String\n\nsSql = \"SELECT ProductID, Description, OtherFields, GoHere FROM tblproduct WHERE ROQ &gt;= QTY AND ROQ &gt; 0\"\n\nSet rsAlert = CurrentDb.OpenRecordset(sSql, dbOpenSnapshot)\n\nIf Not rsAlert.EOF Then                    'There are records (shortages) so unhide and poulate the list box (called lstShortageListBox)\n    Me.lstShortageListBox.Visible = True\n    Me.lstShortageListBox.RowSource = sSql\nElse\n\n    Me.lstShortageListBox.Visible = False\nEnd If\n\n' Tidy Up\nrsAlert.Close\nSet rsAlert = Nothing\n</code></pre>\n\n<p>Obviously make sure that the recordsets criteria are correct - I've made some guesses about that bit.</p>\n"}], "owner": {"reputation": 1, "user_id": 7637050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f851214ff39fa0f2b59e02a809b2c217?s=128&d=identicon&r=PG&f=1", "display_name": "G.T.J", "link": "https://stackoverflow.com/users/7637050/g-t-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488390207, "creation_date": 1488326720, "last_edit_date": 1488386401, "question_id": 42520968, "link": "https://stackoverflow.com/questions/42520968/pop-up-message-when-the-stock-levels-reach-the-critical-level", "title": "Pop Up Message when the Stock Levels reach the Critical Level", "body": "<p>The Basic Function of this is that when you Log in to the system and when on load of the Main Menu it should show a message if certain Products have reached the critical level and when you press yes it should redirect to the form where it shows a detailed view.</p>\n\n<p>In this Case the Quantity in hand is \"QTY\" and Critical Level is \"ROQ\" (Field names in the tblProduct)</p>\n\n<pre><code>    Dim Alert As Integer\n\n    Dim rsAlert As New Adodb.Recordset\n\n    rsAlert.Open \"select * from tblproduct , CurrentProject.Connection\"\n\n    Alert = DCount(\"[qty]\", \"[tblProduct]\", \" [ROQ]  &lt;= Qty and =0\")\n\n    If Alert = 0 Then\n\n    Exit Sub\n\n    Else\n\n     If MsgBox(\"This/These \" &amp; Alert &amp; \" product/products have reached their critical levels\" &amp; _\n     vbCrLf &amp; vbCrLf &amp; \"Would you like to see these now?\", _\n     vbYesNo, \"Alert...\") = vbYes Then\n\n    DoCmd.Minimize\n    DoCmd.OpenForm \"frmAlerts\", acNormal\n    Else\n        Exit Sub\n    End If\n    End If\n\n    End Sub\n</code></pre>\n\n<p>The error I get is that when load my menu menu it doesn't show the number of products which are under the critical level ! If anyone can help it would be a Great Help! </p>\n\n<p>This has been done in Microsoft Access.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 1, "creation_date": 1488323632, "post_id": 42520480, "comment_id": 72177993, "body": "I tried to change the data-source from Input1 to Input2 and found out it was the problem with the headphone data and the code is not dynamic enough...Kindly do share your views"}], "answers": [{"comments": [{"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 0, "creation_date": 1488326710, "post_id": 42520880, "comment_id": 72178853, "body": "Thanks for the reply. No, Its actually this line where we kind of add &quot;Seller1&quot;, = &quot;Mobile+HeadPhone&quot;, True . Because it doesn&#39;t exist it throws an error"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 0, "creation_date": 1488327284, "post_id": 42520880, "comment_id": 72179012, "body": "What do you want to add instead then? If you can&#39;t add it, then just remove the line or replace it with what you want to add that works. If you instead want to be able to dynamically change the field you could use a string variable."}, {"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 1, "creation_date": 1488327845, "post_id": 42520880, "comment_id": 72179154, "body": "Yup ! The String variable is what I am actually looking for, but just don&#39;t know how to do it. Please help me with that"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 0, "creation_date": 1488328685, "post_id": 42520880, "comment_id": 72179372, "body": "Oh, that should be super simple. See my revised code."}, {"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 0, "creation_date": 1488328869, "post_id": 42520880, "comment_id": 72179419, "body": "Thanks ! You are a Super man !! I will wait for the changes to reflect in the revised code..It hasn&#39;t yet though"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 0, "creation_date": 1488328956, "post_id": 42520880, "comment_id": 72179447, "body": "Sorry, I commented before editing. You should see them now. Basically, all you need to do is replace the string within the arguments with the string you want to use. I didn&#39;t use any error checking, data validation, etc. This is just a proof of concept. You will want to practice and develop your code a bit further to ensure only valid formulas can be passed in."}, {"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 0, "creation_date": 1488329044, "post_id": 42520880, "comment_id": 72179469, "body": "Thank you Sir. I will develop the rest ! Thanks a million"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 0, "creation_date": 1488329098, "post_id": 42520880, "comment_id": 72179482, "body": "Not a problem at all :). Good luck!"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1488348411, "post_id": 42520880, "comment_id": 72184952, "body": "Nice, you can have a better use of your <code>With Ppt2</code> , the following line you have <code>.PivotTables(&quot;PivotTable2&quot;).PivotFields(&quot;Model&quot;), &quot;Count of Model&quot;, xlCount</code>, you can just write <code>.PivotFields(&quot;Model&quot;), &quot;Count of Model&quot;, xlCount</code>"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1488368401, "post_id": 42520880, "comment_id": 72197183, "body": "Good catch. Adjusted the references within the with block."}], "tags": [], "owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "is_accepted": true, "score": 1, "last_activity_date": 1488368366, "last_edit_date": 1488368366, "creation_date": 1488326123, "answer_id": 42520880, "question_id": 42520480, "link": "https://stackoverflow.com/questions/42520480/pivot-table-calculated-item-produces-error/42520880#42520880", "title": "Pivot table calculated item produces error", "body": "<p>Is it just \".PivotItems('HeadPhone').Visible = False\" that is creating the error? The simplest fix would be to not include this item. However you can make your code far more dynamic with a few tweaks:</p>\n\n<pre><code>        Dim wb as Workbook\n\n        ' Use variables, they are more accurate and it helps make your code\n        ' more dynamic.\n        Dim wsIn_1 as Worksheet, wsIn_2 as Worksheet, _\n        wsOut_1 as Worksheet, wsOut_2 as Worksheet\n\n        Dim pt1 as PivotTable, pt2 as PivotTable\n\n        ' For use in looping pivotitems if you need to\n        Dim pi as PivotItem\n\n\n        Dim sCalculate as String\n\n        ' Set it however you wish, this just prompts the user.\n        sCalculate = Inputbox(\"Please enter the formula you would like to use.\")\n        ' Assumes that workbook running code is the same one being edited.\n        Set wb = ThisWorkbook\n\n        ' Set the worksheet variables\n        With wb\n            Set wsIn_1 = .Sheets(\"Input1\")\n            Set wsIn_2 = .Sheets(\"Input2\")\n            Set wsOut_1 = .Sheets(\"Output1\")\n            Set wsOut_2 = .Sheets(\"Output2\")\n        End With\n\n        ' Always name your pivot tables. It is good practice. In this case\n        ' I created a generic name but you can make something more precise.\n        wb.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n            \"Input1!R1C1:R1048576C5\", Version:=xlPivotTableVersion12).CreatePivotTable _\n            TableDestination:=\"Output1!R8C2:R20C14\", TableName:=\"pt_Output_1\", _\n            DefaultVersion:=xlPivotTableVersion12\n\n        ' It is best to avoid activate and select, but I am including it\n        ' in case it is somehow important for the sheet to be active on the\n        ' so you can see the code running. No need to activate it just to work\n        ' on it though.\n        wsOut_1.Activate\n\n        With wsOut_1.PivotTables(\"pt_Output_1\").PivotFields(\"Product\")\n            .Orientation = xlColumnField\n            .Position = 1\n        End With\n\n        Set pt2 = wsOut_1.PivotTables(\"PivotTable2\")\n\n        With pt2\n            .AddDataField \n            .PivotFields(\"Model\"), \"Count of Model\", xlCount    \n            ' All you need to do is replace the string within the code with a string variable\n            ' It would be ideal to have some kind of data validation in here to ensure\n            ' only valid strings can be passed in. You will also need to somehow ensure\n            ' that you are entering an appropriate formula.\n            .PivotFields(\"Product\").CalculatedItems.Add \"Seller1\", sCalculate, True\n            .PivotFields(\"Product\").CalculatedItems.Add \"Seller2\", \"=Watch +TV\", True\n\n\n            ' I commented out the entire block below since I dont think this\n            ' is what you are trying to accomplish. Instead use this:\n\n            .PivotFields(\"Product\").Visible = xlHidden\n\n            ' With .PivotFields(\"Product\")\n                ' Since it looks like you are simply hiding everything\n                ' use a for loop instead.\n\n                ' I have made kept all of this commented out because\n                ' because you will run into an error if there isn't at\n                ' least one visible item.\n\n                ' For each pi in .PivotItems\n                '     pi.Visible = False\n                ' Next\n                ' .PivotItems(\"HeadPhone\").Visible = False\n                ' .PivotItems(\"Mobile\").Visible = False\n                ' .PivotItems(\"TV\").Visible = False\n                ' .PivotItems(\"Watch\").Visible = False\n                ' .PivotItems(\"Watch \").Visible = False\n                ' .PivotItems(\"(blank)\").Visible = False\n           ' End With\n        End With\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 1, "accepted_answer_id": 42520880, "answer_count": 1, "score": 2, "last_activity_date": 1490022596, "creation_date": 1488323504, "last_edit_date": 1490022596, "question_id": 42520480, "link": "https://stackoverflow.com/questions/42520480/pivot-table-calculated-item-produces-error", "title": "Pivot table calculated item produces error", "body": "<p>I have two different worksheets (Input1 and Input2) and I am writing a piece of code to build a report. My Code runs successfully on Input1 - worksheet but not on Input 2 - Worksheet.</p>\n\n<p>This is my data - INPUT 1</p>\n\n<pre><code>Model       Date      Product     Payment   Mode\nBlackberry  1/31/2010   Watch     Card      Online\nBlackberry  2/1/2010    TV        Card      Online\nBlackberry  1/31/2010   Watch     Cash      Online\nBlackberry  2/3/2010    TV        Card      Online\nBlackberry  2/4/2010    TV        Cash      Online\nBlackberry  1/31/2010   Mobile    Cash      Store\nApple       2/6/2010    HeadPhone Cash      Store\nApple       1/31/2010   Watch     Cash      Store\nApple       2/8/2010    Watch     Cash      Store\n</code></pre>\n\n<p>I am trying to build a Pivot table that makes use of two calculated fields.</p>\n\n<ul>\n<li>Seller1 which just adds Mobile and Headphones</li>\n<li>Seller2 which adds TV and Watch.</li>\n</ul>\n\n<p>In Input2, I don't have a headphone. So, the code that worked for Input1 is not working.</p>\n\n<pre><code>     Cells.Select\n        ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n            \"Input1!R1C1:R1048576C5\", Version:=xlPivotTableVersion12).CreatePivotTable _\n            TableDestination:=\"Output1!R8C2:R20C14\", TableName:=\"PivotTable2\", _\n            DefaultVersion:=xlPivotTableVersion12\n        Sheets(\"Output1\").Select\n\n        With ActiveSheet.PivotTables(\"PivotTable2\").PivotFields(\"Product\")\n            .Orientation = xlColumnField\n            .Position = 1\n        End With\n\nActiveSheet.PivotTables(\"PivotTable2\").AddDataField \nActiveSheet.PivotTables( _\n            \"PivotTable2\").PivotFields(\"Model\"), \"Count of Model\", xlCount\n        Range(\"C9\").Select    ActiveSheet.PivotTables(\"PivotTable2\").PivotFields(\"Product\").CalculatedItems. _\n            Add \"Seller1\", \"=Mobile +HeadPhone\", True\n\n\nActiveSheet.PivotTables(\"PivotTable2\").PivotFields(\"Product\").CalculatedItems. _\n        Add \"Seller2\", \"=Watch +TV\", True\n    With ActiveSheet.PivotTables(\"PivotTable2\").PivotFields(\"Product\")\n        .PivotItems(\"HeadPhone\").Visible = False\n        .PivotItems(\"Mobile\").Visible = False\n        .PivotItems(\"TV\").Visible = False\n        .PivotItems(\"Watch\").Visible = False\n        .PivotItems(\"Watch \").Visible = False\n        .PivotItems(\"(blank)\").Visible = False\n    End With\n\n    End Sub\n</code></pre>\n\n<p>This is the Output that I am looking for - <img src=\"https://i.stack.imgur.com/W01qw.png\" alt=\"Output Required\"></p>\n"}, {"tags": ["vba", "excel", "date"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1488323663, "post_id": 42520382, "comment_id": 72178006, "body": "See <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a>."}], "answers": [{"comments": [{"owner": {"reputation": 4563, "user_id": 70592, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8e624a38714066f0996aeb69d8e7ca7d?s=128&d=identicon&r=PG", "display_name": "John Adams", "link": "https://stackoverflow.com/users/70592/john-adams"}, "edited": false, "score": 0, "creation_date": 1488394603, "post_id": 42520534, "comment_id": 72215254, "body": "Thank you. I replaced my attempt above with your code and ran the whole new addin. The values of the cells in column H remain as before (i.e. a typical value is shown as 11/22/2016). Yet when I click on one of the cells in column H and chose &quot;Format Cells&quot;, the format has indeed been changed from General to Custom and dd-mmm-yyyy. Is there another statement needed to actually &quot;apply&quot; the new format to the cell value so it would display as 22-Nov-2016?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 4563, "user_id": 70592, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8e624a38714066f0996aeb69d8e7ca7d?s=128&d=identicon&r=PG", "display_name": "John Adams", "link": "https://stackoverflow.com/users/70592/john-adams"}, "edited": false, "score": 0, "creation_date": 1488398270, "post_id": 42520534, "comment_id": 72217484, "body": "It would appear that your dates are not true dates at all; merely text that looks like dates. Select the column and use Data, Text-to-Columns and select the correct MDY format on the third screen. Additionally, this needs to be done on future imports when you bring in new data."}, {"owner": {"reputation": 4563, "user_id": 70592, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8e624a38714066f0996aeb69d8e7ca7d?s=128&d=identicon&r=PG", "display_name": "John Adams", "link": "https://stackoverflow.com/users/70592/john-adams"}, "edited": false, "score": 0, "creation_date": 1488398631, "post_id": 42520534, "comment_id": 72217694, "body": "Thank you. See my EDIT of OP above. Your answer helped greatly."}, {"owner": {"reputation": 4563, "user_id": 70592, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8e624a38714066f0996aeb69d8e7ca7d?s=128&d=identicon&r=PG", "display_name": "John Adams", "link": "https://stackoverflow.com/users/70592/john-adams"}, "edited": false, "score": 0, "creation_date": 1488484572, "post_id": 42520534, "comment_id": 72263416, "body": "Please see my EDIT above. I still need your help."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1488323851, "creation_date": 1488323851, "answer_id": 42520534, "question_id": 42520382, "link": "https://stackoverflow.com/questions/42520382/vba-excel-add-in-code-to-change-format-of-column-from-general-to-custom-date/42520534#42520534", "title": "VBA Excel add-in: code to change format of column from general to custom date", "body": "<p>You are only operating on the last cell with a value in column H. Span from H2 to the last cell to set the format of all of the cells.</p>\n\n<pre><code>with ActiveSheet\n    .Range(.cells(2, \"H\"), .cells(.rows.count, \"H\").End(xlUp)).NumberFormat = \"dd-mmm-yyyy\"\nend with\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4563, "user_id": 70592, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8e624a38714066f0996aeb69d8e7ca7d?s=128&d=identicon&r=PG", "display_name": "John Adams", "link": "https://stackoverflow.com/users/70592/john-adams"}, "edited": false, "score": 0, "creation_date": 1488397449, "post_id": 42526168, "comment_id": 72216994, "body": "Thanks. Got compile error(s) trying your suggestion. So I added: Dim i as Integer then dim currentCell as Object in front of For loop. Then I got error code 6 overflow."}], "tags": [], "owner": {"reputation": 1320, "user_id": 2315991, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6e307d234c7226b7d0c1198236f21c31?s=128&d=identicon&r=PG", "display_name": "ThomasMX", "link": "https://stackoverflow.com/users/2315991/thomasmx"}, "is_accepted": false, "score": 0, "last_activity_date": 1488355514, "last_edit_date": 1488355514, "creation_date": 1488355142, "answer_id": 42526168, "question_id": 42520382, "link": "https://stackoverflow.com/questions/42520382/vba-excel-add-in-code-to-change-format-of-column-from-general-to-custom-date/42526168#42526168", "title": "VBA Excel add-in: code to change format of column from general to custom date", "body": "<p>This four-line-loop should do the trick. Tested it. ;)</p>\n\n<pre><code>For i = 2 To Columns(\"H\").End(xlDown).Row 'from row nr 2 to the rownr of last cell of column H\n    Set currentCell = Cells(i, \"h\")\n    currentCell.Value = Format(currentCell.Value, \"dd-mm-yyyy\")\nNext i\n</code></pre>\n\n<p>It strolls though each cell and applies the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251755.aspx\" rel=\"nofollow noreferrer\">Format()</a> function on them to convert the text format. Let me know if that helps. </p>\n"}, {"tags": [], "owner": {"reputation": 361, "user_id": 1544175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c508860fc0c90c56301edb2de8db1d4?s=128&d=identicon&r=PG", "display_name": "Wayne", "link": "https://stackoverflow.com/users/1544175/wayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1520897819, "creation_date": 1520897819, "answer_id": 49246042, "question_id": 42520382, "link": "https://stackoverflow.com/questions/42520382/vba-excel-add-in-code-to-change-format-of-column-from-general-to-custom-date/49246042#49246042", "title": "VBA Excel add-in: code to change format of column from general to custom date", "body": "<p>Just solved this for the same issue you have.  Tested your case as well. The key is the TextToColumns command.  With your code, give this a try:</p>\n\n<pre><code>With ActiveSheet.Range(\"H:H\")\n    .NumberFormat = \"dd-mmm-yyyy\"\n    .TextToColumns\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 4563, "user_id": 70592, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8e624a38714066f0996aeb69d8e7ca7d?s=128&d=identicon&r=PG", "display_name": "John Adams", "link": "https://stackoverflow.com/users/70592/john-adams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2045, "favorite_count": 0, "accepted_answer_id": 42520534, "answer_count": 3, "score": 3, "last_activity_date": 1520897819, "creation_date": 1488322972, "last_edit_date": 1488484530, "question_id": 42520382, "link": "https://stackoverflow.com/questions/42520382/vba-excel-add-in-code-to-change-format-of-column-from-general-to-custom-date", "title": "VBA Excel add-in: code to change format of column from general to custom date", "body": "<p>My data provider has changed several things in the .XLSX file I get. I have added a new sub to fix the data according to the model this application expects:</p>\n\n<pre><code>Sub Feb27FixModel()\n    ActiveSheet.Range(\"H2\").End(xlDown).NumberFormat = \"dd-mmm-yyyy\"            'change format of Processed Date\n    Dim colNum As Integer\n    colNum = ActiveSheet.Rows(1).Find(what:=\"Legacy code\", lookat:=xlWhole).Column\n    ' Done twice to insert 2 new cols\n    ActiveSheet.Columns(colNum + 1).Insert\n    ActiveSheet.Columns(colNum + 1).Insert\n    ' New col headings\n    ActiveSheet.Cells(1, colNum + 1).Value = \"Origin Code\"\n    ActiveSheet.Cells(1, colNum + 2).Value = \"Jurisdiction Code\"\n    Range(\"A1\").Select\n    ActiveCell.FormulaR1C1 = \"County Name\"\n    Range(\"B1\").Select\n    ActiveCell.FormulaR1C1 = \"State Abbreviation\"\n    ActiveWorkbook.Save\nEnd Sub\n</code></pre>\n\n<p>Everything works EXCEPT the result of the 1st line above. In the active worksheet, column H has a header row value of \"Processed Date\" and the H2 cell and cells below it are stored as General with values like 11/15/2016. I need to change all the dates to a custom date as dd-mmm-yyyy. The statement below fails to get this done for me:</p>\n\n<pre><code>ActiveSheet.Range(\"H2\").End(xlDown).NumberFormat = \"dd-mmm-yyyy\"\n</code></pre>\n\n<p><strong>EDIT (01March2017):</strong> </p>\n\n<p>Thanks to the answer from @Jeeped below, I added another statement and this is the code that was the solution:</p>\n\n<pre><code>With ActiveSheet\n    .Range(.Cells(2, \"H\"), .Cells(.Rows.Count, \"H\").End(xlUp)).NumberFormat = \"dd-mmm-yyyy\"\n    .Range(.Cells(2, \"H\"), .Cells(.Rows.Count, \"H\").End(xlUp)).Value = ActiveCell.Text\nEnd With\n</code></pre>\n\n<p><strong>EDIT (02March2017):</strong> </p>\n\n<p>I made a mistake yesterday. In debugging, I must have had a good cell selected in the worksheet at a breakpoint; hence, refering to ActiveCell.Text \"sort of worked\". It had the effect of replicating the Text to be \"14-Oct-2016\" in EVERY row for column H (except the first row). This was minimally acceptable. </p>\n\n<p>What I really need is a statement that will take the Text of all rows of column H and change the stored value from displaying as 10/14/2016 to 14-Oct-2016, etc. It is not enough to just change the format to custom. I need to change the stored values too. I don't know how to do that.</p>\n"}]