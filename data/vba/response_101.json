[{"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1481901432, "post_id": 41159049, "comment_id": 69574582, "body": "@DeathKamp (alias &quot;cloud&quot;), if my answer solved <i>this</i> post then please mark answer as accepted. Thank you!"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1481903534, "post_id": 41159049, "comment_id": 69575824, "body": "@Deathkamp, to accept an answer you have to <i>click on the check mark beside the answer to toggle it from greyed out to filled in</i> (as you can see in <a href=\"http://stackoverflow.com/help/someone-answers\">What should I do when someone answers my question?</a>)"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1481788474, "creation_date": 1481788474, "answer_id": 41159049, "question_id": 41154245, "link": "https://stackoverflow.com/questions/41154245/button-generates-the-columns-from-user-input-but-not-the-cell-lines/41159049#41159049", "title": "Button Generates the columns from user input but not the cell lines?", "body": "<p>you could try this:</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n    Dim colIndex As Variant\n\n    colIndex = Application.InputBox(\"Enter a column that you want to add: \", \"What column?\", , , , , , 2) '&lt;--| force a text\n    If colIndex = \"\" Then Exit Sub\n    With ThisWorkbook.Sheets(\"Sheet1\").Columns(colIndex) '&lt;--| reference column you want to insert\n        .Insert shift:=xlRight '&lt;--| insert a new column , then the referenced one shifts one column to the right of the inserted one \n        .Offset(, -2).Copy '&lt;--| copy the column two columns to the left of the referenced one (i.e. one column left of the new one)\n        .Offset(, -1).PasteSpecial xlPasteFormats '&lt;--| paste formats to the new column \n        Application.CutCopyMode = False\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7299357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48ac39d9a3e2a52521204190ea63fcdf?s=128&d=identicon&r=PG&f=1", "display_name": "cloud", "link": "https://stackoverflow.com/users/7299357/cloud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1536309497, "creation_date": 1481759695, "last_edit_date": 1536309497, "question_id": 41154245, "link": "https://stackoverflow.com/questions/41154245/button-generates-the-columns-from-user-input-but-not-the-cell-lines", "title": "Button Generates the columns from user input but not the cell lines?", "body": "<p>I implemented a button that ask the user where to add a column, and the button takes the user input(A-Z) and generates the column until the end of the table <strong>NOT SPREADSHEET</strong>. The column ends based on how many rows there are in my table, meaning if there are 10 rows, after the user clicks the button an inputs where they want the column to be(They input a letter of the column A-Z), I should not see a column box on line 11 of the spreadsheet. </p>\n\n<p>Now I've managed to do this my issue is below:</p>\n\n<p>My issue is the cells the button generate does not include the lines or boxes around the cells so that you are aware that its an extension of the table? </p>\n\n<p>here is what I mean: <a href=\"https://imgur.com/a/GtvKb\" rel=\"nofollow noreferrer\">Picture of spreadsheet</a></p>\n\n<p>notice the i column there are no lines around the cells? </p>\n\n<p>Here is code, I think I am missing a copy function after the line \nshift:=xlRight, but I don't know how to implement it?</p>\n\n<p>I don't want to use macros because since the tables rows and column change due to the user's input I will have to constantly hard-code the range into the macro which i dont want.\nTrust me I tried it an its annoying.</p>\n\n<pre><code>Private Sub CommandButton2_Click()\nDim x As Variant\nDim ColumnNum\n\nx = InputBox(\"Enter a column that you want to add: \", \"What column?\")\nIf x = \"\" Then Exit Sub\nColumnNum = x\n\nThisWorkbook.Sheets(\"Sheet1\").Columns(ColumnNum).Insert shift:=xlRight\n\n\nThisWorkbook.Sheets(\"Sheet1\").Columns(ColumnNum).ClearContents\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "vba", "internet-explorer"], "comments": [{"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1481810907, "post_id": 41154179, "comment_id": 69532724, "body": "There is no button in the HTML. The element you call click for is a table cell. You could simplify the code by using <code>querySelector</code> or by using <code>Function querySelectorAll(v As String) As IHTMLDOMChildrenCollection</code>. Example: <code>IE.Document.querySelector(&quot;td[title=&#39;Save Chart&#39;]&quot;)</code>."}, {"owner": {"reputation": 13, "user_id": 6090791, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tmqI2dvXISs/AAAAAAAAAAI/AAAAAAAAAGs/BDnoG1ybPAo/photo.jpg?sz=128", "display_name": "Brad Hodge", "link": "https://stackoverflow.com/users/6090791/brad-hodge"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1481917733, "post_id": 41154179, "comment_id": 69582770, "body": "Nice!  In my young HTML automation career, I&#39;ve not used querySelector.  I just replaced most of my code with your suggested IE.Document.querySelector(&quot;td[title=&#39;Save Chart&#39;]&quot;)."}, {"owner": {"reputation": 13, "user_id": 6090791, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tmqI2dvXISs/AAAAAAAAAAI/AAAAAAAAAGs/BDnoG1ybPAo/photo.jpg?sz=128", "display_name": "Brad Hodge", "link": "https://stackoverflow.com/users/6090791/brad-hodge"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1481917810, "post_id": 41154179, "comment_id": 69582800, "body": "Nice!  In my young HTML automation career, I&#39;ve not used querySelector.  I just replaced most of my code with your suggested IE.Document.querySelector(&quot;td[title=&#39;Save Chart&#39;]&quot;).  It worked, but again, just on the first pass.  It didn&#39;t actually perform the action on any of the subsequent passes."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1481923399, "post_id": 41154179, "comment_id": 69585007, "body": "Yes <code>queryString</code> is very useful! I learned it here on SO as well. To be honest I don&#39;t know what is wrong with the next <code>Clicks</code>. What does the first <code>Click</code> do? Is there some <code>java-script</code> attached to <code>onclick</code> event of the <code>td</code> elements? Maybe the java-script changes something and so the next clicks don&#39;t work the same way?"}, {"owner": {"reputation": 13, "user_id": 6090791, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tmqI2dvXISs/AAAAAAAAAAI/AAAAAAAAAGs/BDnoG1ybPAo/photo.jpg?sz=128", "display_name": "Brad Hodge", "link": "https://stackoverflow.com/users/6090791/brad-hodge"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1481988862, "post_id": 41154179, "comment_id": 69599677, "body": "How would I find out whether there is java-script involved?"}, {"owner": {"reputation": 13, "user_id": 6090791, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tmqI2dvXISs/AAAAAAAAAAI/AAAAAAAAAGs/BDnoG1ybPAo/photo.jpg?sz=128", "display_name": "Brad Hodge", "link": "https://stackoverflow.com/users/6090791/brad-hodge"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1481988955, "post_id": 41154179, "comment_id": 69599709, "body": "I hate it that I keep hitting enter, before I&#39;m done typing.  :(  The first click (that works) opens another window, and that window has buttons with IDs that are easy to control."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1481989909, "post_id": 41154179, "comment_id": 69599989, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/gg589512(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Use F12 in IE</a>. Then go to <code>scripts</code> tab and try to find some script which could be atached to that <code>click</code>."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1481990518, "post_id": 41154179, "comment_id": 69600166, "body": "Hmm another window opens? Thats is maybe the problem because you are referencing elements in the previous window, but buttons are in another window. Probably you would need something like <a href=\"http://stackoverflow.com/questions/20664845/get-ie-window-object-by-window-title-with-vba\">this</a> or <a href=\"https://social.msdn.microsoft.com/Forums/en-US/596c22cb-2140-404c-87b1-b115ecf1da03/controlling-open-internet-explorer-windows-with-vba?forum=isvvba\" rel=\"nofollow noreferrer\">this</a>. Then when you have reference to the active IE use Document of it."}, {"owner": {"reputation": 13, "user_id": 6090791, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tmqI2dvXISs/AAAAAAAAAAI/AAAAAAAAAGs/BDnoG1ybPAo/photo.jpg?sz=128", "display_name": "Brad Hodge", "link": "https://stackoverflow.com/users/6090791/brad-hodge"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1482115586, "post_id": 41154179, "comment_id": 69629032, "body": "So, here is what I found from your suggestions... (1) No Java-script associated with that one.  (2) The onclick event should open another window, but the other window does not have it&#39;s own URL (at least not visible).  And... the buttons on the window that opens are easily controlled, so once it opens, I&#39;m Golden.  I just need it to open every time.  Any other thoughts?  And... many thanks for your help in this."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1482167723, "post_id": 41154179, "comment_id": 69654366, "body": "You are welcome! But I am little confused. Could you add some screen shots or video where the situation with the another window(s) will be shown?"}, {"owner": {"reputation": 13, "user_id": 6090791, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tmqI2dvXISs/AAAAAAAAAAI/AAAAAAAAAGs/BDnoG1ybPAo/photo.jpg?sz=128", "display_name": "Brad Hodge", "link": "https://stackoverflow.com/users/6090791/brad-hodge"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1482259902, "post_id": 41154179, "comment_id": 69698729, "body": "I&#39;m really sorry, but I don&#39;t feel comfortable posting pics or video of this process on the web.  It&#39;s not my data."}, {"owner": {"reputation": 13, "user_id": 6090791, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tmqI2dvXISs/AAAAAAAAAAI/AAAAAAAAAGs/BDnoG1ybPAo/photo.jpg?sz=128", "display_name": "Brad Hodge", "link": "https://stackoverflow.com/users/6090791/brad-hodge"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1482260073, "post_id": 41154179, "comment_id": 69698824, "body": "Darn Enter Key Again!!!   The Save Data &quot;button&quot; (actually table cell) is just a button that says Save Data when you hover it.  When you click it, a small window opens (that does not have its own URL), and it has two buttons (Upload and Cancel).  I have been able to click these buttons without difficulty.  The problem is just clicking that Save Chart button (or should I say... Having it respond to my click)."}], "owner": {"reputation": 13, "user_id": 6090791, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tmqI2dvXISs/AAAAAAAAAAI/AAAAAAAAAGs/BDnoG1ybPAo/photo.jpg?sz=128", "display_name": "Brad Hodge", "link": "https://stackoverflow.com/users/6090791/brad-hodge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 760, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1481759285, "creation_date": 1481759285, "question_id": 41154179, "link": "https://stackoverflow.com/questions/41154179/vba-html-click-not-working", "title": "vba html click not working", "body": "<p>I am getting URLs from charts that are generated from a web page.  It loops through stocks, and then creates the charts.  I have the whole process automated except for one button.</p>\n\n<p>On the first stock, my code works great, but it doesn't work after that.</p>\n\n<p>Here is the HTML...</p>\n\n<pre><code>&lt;tr data-menuitem=\"save\" style=\"border: 1px solid rgb(174, 185, 197); height: 32px; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 11px; line-height: normal; font-family: Arial; background-color: rgba(179, 213, 253, 0);\"&gt;\n&lt;td valign=\"middle\" align=\"center\" title=\"Save Chart\" style=\"cursor: default; border: none;\"&gt;  &lt;img width=\"24\" height=\"24\" class=\"icon\" style=\"display:block\" src=\"/chartnotes/img/unsaved.gif\"&gt;\n&lt;/td&gt;\n&lt;/tr&gt;\n</code></pre>\n\n<p>And here is my vba trying to click the button...</p>\n\n<pre><code>        Set IEDoc = IE.Document.getElementsByTagName(\"td\")\n        If IEDoc(258).getAttribute(\"Title\") = \"Save Chart\" Then\n            IEDoc(258).Click\n        ElseIf IEDoc(114).getAttribute(\"Title\") = \"Save Chart\" Then\n            IEDoc(114).Click\n        Else\n            Stop\n        End If\n</code></pre>\n\n<p>I am sure that it is finding the correct element, because it runs the code for IEDoc(258).Click each time.  But the actual action of the button only happens on the first pass.</p>\n\n<p>Thoughts?</p>\n"}, {"tags": ["vba", "ms-access", "macros"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1481789142, "post_id": 41154150, "comment_id": 69519438, "body": "What is the <code>TimerInterval</code> setting of the hidden form? I must say, I use <code>Form_Timer</code> for a few things, and it has never broken anything."}, {"owner": {"reputation": 159, "user_id": 6052693, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3c5554d0b95c0444b0bdf1cf09a644cb?s=128&d=identicon&r=PG&f=1", "display_name": "Kayracer", "link": "https://stackoverflow.com/users/6052693/kayracer"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1482160913, "post_id": 41154150, "comment_id": 69650306, "body": "The TimerInterval is used to specify the interval, in milliseconds, between timer events on a form.  I got this from the MS website and just changed the bottom to close the database instead of what they had done. Also could you please post your Form_Timer, I would like to see it."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1482164823, "post_id": 41154150, "comment_id": 69652780, "body": "Sorry for being unclear, I know what <code>TimerInterval</code> is. :) I meant: which value for TimerInterval does your form have? i.e. how often is your sub called?"}, {"owner": {"reputation": 159, "user_id": 6052693, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3c5554d0b95c0444b0bdf1cf09a644cb?s=128&d=identicon&r=PG&f=1", "display_name": "Kayracer", "link": "https://stackoverflow.com/users/6052693/kayracer"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1482168219, "post_id": 41154150, "comment_id": 69654656, "body": "Ohh and I had it set to 1000 so every second it would update, I then changed it to 5000 for every 5 seconds to run and what I found out is if I use my other code through buttons, they will work as long as i dont run or hit the buttons on the 5th sec.  so it breaks when the desired interval runs the code even if there is no code."}], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 6052693, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3c5554d0b95c0444b0bdf1cf09a644cb?s=128&d=identicon&r=PG&f=1", "display_name": "Kayracer", "link": "https://stackoverflow.com/users/6052693/kayracer"}, "edited": false, "score": 0, "creation_date": 1482160334, "post_id": 41158626, "comment_id": 69649914, "body": "That is very upsetting.  The only reason I added this was because I needed to compact and repair the database and I cant seem to get every one off or it is corrupt and think everyone is on when no one is.  I am going to try and copy the data base, compact and repair it and send out a new front end that is connected to the new back end. This is the best I have thought of"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1481786895, "creation_date": 1481786895, "answer_id": 41158626, "question_id": 41154150, "link": "https://stackoverflow.com/questions/41154150/access-autoexec-for-detectidletime-breaks-other-code/41158626#41158626", "title": "Access AutoExec for DetectIdleTime breaks other code", "body": "<p>That is a well-known issue. The timer breaks in and may disrupt what the user is currently working with.</p>\n\n<p>Sadly, there is no way around it, and I have wondered for years why such code still is recommended. It will cause nothing but trouble - as you have seen.</p>\n"}, {"tags": [], "owner": {"reputation": 159, "user_id": 6052693, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3c5554d0b95c0444b0bdf1cf09a644cb?s=128&d=identicon&r=PG&f=1", "display_name": "Kayracer", "link": "https://stackoverflow.com/users/6052693/kayracer"}, "is_accepted": true, "score": 1, "last_activity_date": 1482188518, "creation_date": 1482188518, "answer_id": 41232395, "question_id": 41154150, "link": "https://stackoverflow.com/questions/41154150/access-autoexec-for-detectidletime-breaks-other-code/41232395#41232395", "title": "Access AutoExec for DetectIdleTime breaks other code", "body": "<p>After messing around I found a work around for this problem.  What I did was made a new method found below where i call it in my other methods twice.  This is so it shuts off the timer first, does what it has to do and calls this again to re-enable the timer.  only down side is I have to add it to all the methods that need it.</p>\n\n<pre><code>Private Sub TimerIntervalSwitch()\n\n'MsgBox \"TimerIntervalSwitch was called\"\n'To turn off and on the timer on the form DetectIdleTime\nIf Form_DetectIdleTime.TimerInterval = 1000 Then\n    Form_DetectIdleTime.TimerInterval = 0\n    MsgBox \"Timer Off\"\nElseIf (Form_DetectIdleTime.TimerInterval = 0) Then\n    Form_DetectIdleTime.TimerInterval = 1000\n    MsgBox \"Timer On\"\n\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 6052693, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3c5554d0b95c0444b0bdf1cf09a644cb?s=128&d=identicon&r=PG&f=1", "display_name": "Kayracer", "link": "https://stackoverflow.com/users/6052693/kayracer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "accepted_answer_id": 41232395, "answer_count": 2, "score": 1, "last_activity_date": 1482188518, "creation_date": 1481759078, "question_id": 41154150, "link": "https://stackoverflow.com/questions/41154150/access-autoexec-for-detectidletime-breaks-other-code", "title": "Access AutoExec for DetectIdleTime breaks other code", "body": "<p>I have a data base using Access 2007-2010 and I have a AutoExec that auto starts to start detecting when and if a user leaves the front end open, it will close after an hour.  I used the Detect User Idle Time from Microsoft website <a href=\"https://msdn.microsoft.com/en-us/library/office/ff192885.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff192885.aspx</a> and at the end of it I had it save and close the program instead of how they did it.  The problem I am having is that it breaks all other code that was written in vba. I have another form with buttons that copy entrys in a table and change what the user wants, and all of them worked until I added this macro. When I comment out all of my code so that it does nothing and I leave the macro the same to start up,  it still breaks the other code.  Im not sure if it is because I have the macro start a form with the code to detect idle time that is constantly running causing everything else to partially work. </p>\n\n<p><a href=\"https://i.stack.imgur.com/Wclu4.png\" rel=\"nofollow noreferrer\">My Macro that is named \"AutoExec\"</a></p>\n\n<p>Here is my code for the detecting the idle time</p>\n\n<pre><code>    Option Compare Database\n\n    Sub Form_Timer()\n\n     ' IDLEMINUTES determines how much idle time to wait for before\n     ' running the IdleTimeDetected subroutine.\n     Const IDLEMINUTES = 60\n\n     Static PrevControlName As String\n     Static PrevFormName As String\n     Static ExpiredTime\n\n     Dim ActiveFormName As String\n     Dim ActiveControlName As String\n     Dim ExpiredMinutes\n\n     On Error Resume Next\n\n     ' Get the active form and control name.\n\n     ActiveFormName = Screen.ActiveForm.Name\n     If Err Then\n        ActiveFormName = \"No Active Form\"\n        Err = 0\n     End If\n\n     ActiveControlName = Screen.ActiveControl.Name\n        If Err Then\n        ActiveControlName = \"No Active Control\"\n        Err = 0\n     End If\n\n    Me.CurFormtxt = ActiveFormName\n\n     ' Record the current active names and reset ExpiredTime if:\n     '    1. They have not been recorded yet (code is running\n     '       for the first time).\n     '    2. The previous names are different than the current ones\n     '       (the user has done something different during the timer\n     '        interval).\n     If (PrevControlName = \"\") Or (PrevFormName = \"\") _\n       Or (ActiveFormName &lt;&gt; PrevFormName) _\n       Or (ActiveControlName &lt;&gt; PrevControlName) Then\n        PrevControlName = ActiveControlName\n        PrevFormName = ActiveFormName\n        ExpiredTime = 0\n     Else\n        ' ...otherwise the user was idle during the time interval, so\n        ' increment the total expired time.\n        ExpiredTime = ExpiredTime + Me.TimerInterval\n     End If\n\n     ' Does the total expired time exceed the IDLEMINUTES?\n     ExpiredMinutes = (ExpiredTime / 1000) / 60\n     Me.TimeInactivitytxt = ExpiredMinutes\n     If ExpiredMinutes &gt;= IDLEMINUTES Then\n        ' ...if so, then reset the expired time to zero...\n        ExpiredTime = 0\n\n        ' ...and close the program\n        Application.Quit acQuitSaveAll\n     End If\n  End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1481757625, "post_id": 41153872, "comment_id": 69509775, "body": "<code>s = Selection</code>  ==&gt; <code>Set s = Selection</code>, although <code>Set s = Target</code> would also work."}, {"owner": {"reputation": 9858, "user_id": 1152809, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7bA0M.jpg?s=128&g=1", "display_name": "Travis Heeter", "link": "https://stackoverflow.com/users/1152809/travis-heeter"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1481758626, "post_id": 41153872, "comment_id": 69510048, "body": "@JohnColeman I tried <code>Set s = Selection</code> and got <code>Run-time error &#39;91&#39;: Object variable or With block variable not set</code> same as before."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1481758858, "post_id": 41153872, "comment_id": 69510117, "body": "<i>Where</i> are these modules? I copied your code: 1) the public <code>s</code> declaration in a standard code module, 2) the <code>selection_change</code> in a worksheet module, and 3) the <code>activate</code>/<code>deactivate</code> in the workbook module -- and they all work for me (after using <code>Set</code>). My guess is that you are not using <code>Option Explicit</code>. Public variables should be declared in standard code modules. If not, the variable <code>s</code> won&#39;t be visible in the <code>workbook</code> module."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1481815244, "post_id": 41153872, "comment_id": 69535665, "body": "If you first open the workbook <code>Activate</code> will trigger before <code>SelectionChange</code>, hence you will get a runtime error since <code>s</code> will still be nothing. That is one of the problems that the last part of my answer is designed to address."}, {"owner": {"reputation": 9858, "user_id": 1152809, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7bA0M.jpg?s=128&g=1", "display_name": "Travis Heeter", "link": "https://stackoverflow.com/users/1152809/travis-heeter"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1481815265, "post_id": 41153872, "comment_id": 69535677, "body": "@JohnColeman <a href=\"https://i.stack.imgur.com/ryIBc.png\" rel=\"nofollow noreferrer\">and Sheet1</a>. Edit (after reading your last comment): OH, OK! Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481761877, "post_id": 41154362, "comment_id": 69510948, "body": "FWIW - if <code>s</code> was declared <code>Public</code> in the code module of a sheet which has a code name of <code>Sheet1</code> (not the worksheet <code>.Name</code>, the actual code name), then it can be accessed from other modules within the project as <code>Sheet1.s</code>.  But this would be highly <b>NOT</b> recommended (at least be me) so the idea of placing it in a standard code module is better."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 1, "last_activity_date": 1481760636, "creation_date": 1481760636, "answer_id": 41154362, "question_id": 41153872, "link": "https://stackoverflow.com/questions/41153872/how-to-send-variables-between-a-sheet-and-book/41154362#41154362", "title": "How to send variables between a sheet and book?", "body": "<p>There are a few issues:</p>\n\n<p>1) In order to be visible throughout the project, Public variable declarations must be in a standard code module. Thus the line</p>\n\n<pre><code>Public s As Range\n</code></pre>\n\n<p>shouldn't be in <code>ThisWorkbook</code> but should be in a standard code module.</p>\n\n<p>2) <code>s = Selection</code> should be changed to <code>Set s = Selection</code></p>\n\n<p>3) The sub </p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Set s = Selection\nEnd Sub\n</code></pre>\n\n<p>Should be in a sheet module (and repeated for every sheet that you want this for). It isn't a syntax error to have it in <code>ThisWorkbook</code>, but it won't work as intended.</p>\n\n<p>4) It is dangerous to assume that <code>s</code> is defined whenever the <code>activate</code> or <code>deactivate</code> is triggered. You should guard against that. Something like:</p>\n\n<pre><code>Private Sub Workbook_Activate()\n    If s Is Nothing Then\n        Set s = Selection\n        Exit Sub\n    End If\n    s.Interior.ColorIndex = xlColorIndexNone\n    s.Interior.Color = RGB(100, 204, 204)  ' Blue\nEnd Sub\n</code></pre>\n\n<p>With something similar for <code>Deactivate</code>.</p>\n"}], "owner": {"reputation": 9858, "user_id": 1152809, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7bA0M.jpg?s=128&g=1", "display_name": "Travis Heeter", "link": "https://stackoverflow.com/users/1152809/travis-heeter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "accepted_answer_id": 41154362, "answer_count": 1, "score": 0, "last_activity_date": 1481816398, "creation_date": 1481757318, "last_edit_date": 1531164843, "question_id": 41153872, "link": "https://stackoverflow.com/questions/41153872/how-to-send-variables-between-a-sheet-and-book", "title": "How to send variables between a sheet and book?", "body": "<p>Ultimately, I'm trying to highlight cells when focus moves away from a workbook. </p>\n\n<p>Here's my code (In <code>ThisWorkbook</code>):</p>\n\n<pre><code>Public s As Range\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    s = Selection\nEnd Sub\n\nPrivate Sub Workbook_Deactivate()\n    s.Interior.ColorIndex = xlColorIndexNone\n    s.Interior.Color = RGB(0, 0, 0)\nEnd Sub\n\nPrivate Sub Workbook_Activate()\n    s.Interior.ColorIndex = xlColorIndexNone\n    s.Interior.Color = RGB(100, 204, 204)  ' Blue\nEnd Sub\n</code></pre>\n\n<p>But I'm getting an error on the first <code>s.Interior.ColorIndex</code> encountered:</p>\n\n<blockquote>\n  <p><code>Object variable or With block variable not set</code></p>\n</blockquote>\n\n<hr>\n\n<p>Here's some images of my env:</p>\n\n<p><strong>Sheet1</strong>\n<a href=\"https://i.stack.imgur.com/yyY7m.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yyY7m.png\" alt=\"Sheet1\"></a></p>\n\n<p><strong>ThisWorkbook</strong> (Error highlighted):\n<a href=\"https://i.stack.imgur.com/SAcnS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SAcnS.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1481756361, "post_id": 41153675, "comment_id": 69509309, "body": "Something like <code>Range().Offset(1,0).EntireRow.Delete</code>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1481756410, "post_id": 41153675, "comment_id": 69509326, "body": "<code>Cells(iRow+1, RATE_COL).entirerow.delete</code> ???"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1481757085, "post_id": 41153675, "comment_id": 69509590, "body": "Btw your code will error at the end of your loop because iRow-1=0."}, {"owner": {"reputation": 311, "user_id": 2378895, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/44614b12eb7d2787b2c7ebb50c69a555?s=128&d=identicon&r=PG", "display_name": "user2378895", "link": "https://stackoverflow.com/users/2378895/user2378895"}, "edited": false, "score": 0, "creation_date": 1481758140, "post_id": 41153675, "comment_id": 69509911, "body": "Thanks SJR, yes all of my iRow -1 should be iRow +1"}], "answers": [{"tags": [], "owner": {"reputation": 311, "user_id": 2378895, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/44614b12eb7d2787b2c7ebb50c69a555?s=128&d=identicon&r=PG", "display_name": "user2378895", "link": "https://stackoverflow.com/users/2378895/user2378895"}, "is_accepted": false, "score": 2, "last_activity_date": 1481759107, "creation_date": 1481759107, "answer_id": 41154156, "question_id": 41153675, "link": "https://stackoverflow.com/questions/41153675/delete-row-offset-by-1/41154156#41154156", "title": "Delete row offset by 1", "body": "<p>Here's final working code:</p>\n\n<pre><code>Private Const RATE_TABLE_COL = 1\nPrivate Const RATE_DATE_COL = 2\nPrivate Const RATE_COL = 3\n\nSub RemoveDuplicateRatesRev2()\n    Dim iLastRow As Long, iRow As Long, sThisRate As String, sPrevRate As String, shtSource As Worksheet\n\n    Set shtSource = ActiveSheet\n\n    'Find the last row (in column A) with data.\n    iLastRow = shtSource.Range(\"A:A\").Find(\"*\", searchdirection:=xlPrevious).Row\n\n    If iLastRow &lt; 2 Then\n        MsgBox \"No data to process!\", vbCritical\n        Exit Sub\n    End If\n\n    sThisRate = \"\"\n    sPrevRate = \"\"\n\n    For iRow = iLastRow To 1 Step -1\n        sPrevRate = sThisRate\n        sThisRate = shtSource.Cells(iRow, 1)\n        If sThisRate = sPrevRate Then\n            If shtSource.Cells(iRow, RATE_COL) = shtSource.Cells(iRow + 1, RATE_COL) _\n                And shtSource.Cells(iRow, RATE_DATE_COL) &lt; shtSource.Cells(iRow + 1, RATE_DATE_COL) Then\n                ' need code here to delete row offset by 1 from iRow\n                shtSource.Cells(iRow + 1, RATE_COL).EntireRow.Delete\n            End If\n        End If\n    Next iRow\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 311, "user_id": 2378895, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/44614b12eb7d2787b2c7ebb50c69a555?s=128&d=identicon&r=PG", "display_name": "user2378895", "link": "https://stackoverflow.com/users/2378895/user2378895"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1201, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1481759107, "creation_date": 1481756233, "last_edit_date": 1531161705, "question_id": 41153675, "link": "https://stackoverflow.com/questions/41153675/delete-row-offset-by-1", "title": "Delete row offset by 1", "body": "<p>I am trying to write a macro that loops through a set of rates that has 3 columns:\nrate_table, rate_date, rate</p>\n\n<p>Here's what I have so far. I think I just need the command to delete the row</p>\n\n<pre><code>Private Const RATE_TABLE_COL = 1\nPrivate Const RATE_DATE_COL = 2\nPrivate Const RATE_COL = 3\n\nSub RemoveDuplicateRates()\n    Dim iLastRow As Long, iRow As Long, sThisRate As String, sPrevRate As String\n\n    'Find the last row (in column A) with data.\n    iLastRow = shtSource.Range(\"A:A\").Find(\"*\", searchdirection:=xlPrevious).Row\n\n    If iLastRow &lt; 2 Then\n        MsgBox \"No data to process!\", vbCritical\n        Exit Sub\n    End If\n\n    sThisRate = \"\"\n    sPrevRate = \"\"\n\n    For iRow = iLastRow To 1 Step -1\n        sPrevRate = sThisRate\n        sThisRate = Cells(iRow, 1)\n        If sThisRate = sPrevRate Then\n            If Cells(iRow, RATE_COL) = Cells(iRow - 1, RATE_COL) Then\n                ' need code here to delete row offset by 1 from iRow\n            End If\n        End If\n    Next iRow\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "time", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1481762950, "post_id": 41153592, "comment_id": 69511213, "body": "You need to set the <code>NumberFormat</code> of the <b><i>cell</i></b> - otherwise Excel will simply reformat it after you write to it.  <code>&quot;mm:ss;@&quot;</code> or <code>&quot;h:mm:ss;@&quot;</code> should work."}, {"owner": {"reputation": 37, "user_id": 7235970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06f16631fcb99e5ad3813e685ba25a79?s=128&d=identicon&r=PG&f=1", "display_name": "Marcus", "link": "https://stackoverflow.com/users/7235970/marcus"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481794660, "post_id": 41153592, "comment_id": 69522509, "body": "Sadly that does have the desired effect - thanks though"}], "answers": [{"comments": [{"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "reply_to_user": {"reputation": 37, "user_id": 7235970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06f16631fcb99e5ad3813e685ba25a79?s=128&d=identicon&r=PG&f=1", "display_name": "Marcus", "link": "https://stackoverflow.com/users/7235970/marcus"}, "edited": false, "score": 0, "creation_date": 1482100108, "post_id": 41166413, "comment_id": 69625917, "body": "@Marc happy to help!"}], "tags": [], "owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "is_accepted": true, "score": 0, "last_activity_date": 1481811584, "creation_date": 1481811584, "answer_id": 41166413, "question_id": 41153592, "link": "https://stackoverflow.com/questions/41153592/how-do-i-switch-from-pm-am-to-24h-in-excel-with-vba/41166413#41166413", "title": "How do I switch from PM/AM to 24h in Excel with VBA", "body": "<p>I can replicate your problem, but also easily fix it by setting the <code>NumberFormat</code> as Comintern suggests which you seem unsure about.</p>\n\n<p>To do this programmatically, do the following:</p>\n\n<pre><code>wks.Range(\"I1\").NumberFormat = \"General\"\nwks.Range(\"I1\").Value = Format(t, \"nn:ss\")\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 7235970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06f16631fcb99e5ad3813e685ba25a79?s=128&d=identicon&r=PG&f=1", "display_name": "Marcus", "link": "https://stackoverflow.com/users/7235970/marcus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 735, "favorite_count": 0, "accepted_answer_id": 41166413, "answer_count": 1, "score": 0, "last_activity_date": 1481811584, "creation_date": 1481755817, "last_edit_date": 1531161705, "question_id": 41153592, "link": "https://stackoverflow.com/questions/41153592/how-do-i-switch-from-pm-am-to-24h-in-excel-with-vba", "title": "How do I switch from PM/AM to 24h in Excel with VBA", "body": "<p>as 4 Leave Cover has stated his Problem with switching 24h to PM/AM - <a href=\"https://stackoverflow.com/questions/16681900/excel-vba-timevalue-format-hhmm-am-pm\">EXCEL VBA Timevalue format (hh:mm am/pm)</a></p>\n\n<p>I have exactly the opposite problem:</p>\n\n<p>I use following code (t = 1,39)</p>\n\n<pre><code>t = wks.Range(\"G1\").Value / 1440\nwks.Range(\"I1\").Value = Format(t, \"hh:mm:ss\")\n</code></pre>\n\n<p>which gives me 00:01:23 in the formula text field, but in cell it is formatted as 12:01:23 AM. The problem is: In cell I want it to be formatted as 00:01:23 as well. If possible - I would even like to have it just minutes and seconds. - but \"nn:ss\" gives me 1:23:00 AM and \"mm:ss\" gives me 12:23:00 PM.</p>\n\n<p>I have also tried a TimeSerial-Function but the output in cell is basically the same as mentioned above- In opposite to debug.print however, which gives me the desired results - not in a cell though:</p>\n\n<pre><code>Public Function FromTimeToDecimal(ByVal t As Double) As Date\nFromTimeToDecimal = TimeSerial(0, Fix(t), (t - Fix(t)) * 60)\nEnd Function\n</code></pre>\n\n<p>So basically I am out of clue at the moment</p>\n\n<p>(country setting is set to Germany - in case that matters)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1481785854, "post_id": 41153557, "comment_id": 69517855, "body": "do you mean you have to call <code>ATPVBAEN.XLAM!Regress</code> for every single filtered cell?"}, {"owner": {"reputation": 31, "user_id": 7299188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5bdc423bdb0d3d54dd76014cd8cb034?s=128&d=identicon&r=PG&f=1", "display_name": "Malhuneidi", "link": "https://stackoverflow.com/users/7299188/malhuneidi"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1481787078, "post_id": 41153557, "comment_id": 69518435, "body": "More like, I have a dataset with quarters/years. and I want to run a regression for every quarter/year. I have 44000 rows and 44 different quarter/year combination."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1481787980, "post_id": 41153557, "comment_id": 69518854, "body": "then have your <code>Regress</code> Function loop through filtered cells only. You may want to post its code"}], "owner": {"reputation": 31, "user_id": 7299188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5bdc423bdb0d3d54dd76014cd8cb034?s=128&d=identicon&r=PG&f=1", "display_name": "Malhuneidi", "link": "https://stackoverflow.com/users/7299188/malhuneidi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 194, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1481811603, "creation_date": 1481755687, "last_edit_date": 1481811603, "question_id": 41153557, "link": "https://stackoverflow.com/questions/41153557/vba-filter-and-loop-regression", "title": "VBA Filter and loop regression", "body": "<p>I am trying to run a regression multiple times and copying certain outputs (Intercept &amp; Beta) into a new worksheet.\nI am by no means a VBA programmer, this is the code I have come up with.</p>\n\n<p>Basically, I have a field (field 6 in the below code). I need to run a regression on each of the filtered values in field 6 (which is a year/Quarter concatenation).</p>\n\n<p>Any help would be great!</p>\n\n<pre><code>Sub RunRegression() ' ' RunRegression Macro '\n\n'Add for loop to run through different filters\n    ActiveSheet.Range(\"$A$1:$AW$34712\").AutoFilter Field:=6, Criteria1:=\"20044\"\n     Application.Run \"ATPVBAEN.XLAM!Regress\", ActiveSheet.Range(\"$AQ$1:$AQ$30274\" _\n        ), ActiveSheet.Range(\"$AF$1:$AF$30274\"), False, True, , \"Output\", False _\n        , False, False, False, , False\n    Range(\"B17:B18\").Select\n    Selection.Copy\n    Sheets(\"Sheet5\").Select\n    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n        False, Transpose:=True\n        ActiveCell.Offset(1, 0).Select\n        Sheets(\"Output\").Delete\n         End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1481753982, "post_id": 41153168, "comment_id": 69508426, "body": "Exactly how is the cell being populated?  Showing your code always helps with answers."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1481754476, "post_id": 41153168, "comment_id": 69508617, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/20648149/what-are-numberformat-options-in-excel-vba\">What are .NumberFormat Options In Excel VBA?</a>"}, {"owner": {"reputation": 1256, "user_id": 384972, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6fdef52bfbc673f90ccffdf00451201?s=128&d=identicon&r=PG", "display_name": "Assaf", "link": "https://stackoverflow.com/users/384972/assaf"}, "edited": false, "score": 0, "creation_date": 1481754812, "post_id": 41153168, "comment_id": 69508716, "body": "It probably has to do with <i>how</i> the vba code is changing the cell values as a result of using the different cell properties. Take a look at: <a href=\"http://stackoverflow.com/questions/17359835/what-is-the-difference-between-text-value-and-value2\" title=\"what is the difference between text value and value2\">stackoverflow.com/questions/17359835/&hellip;</a>"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1481763562, "post_id": 41153168, "comment_id": 69511384, "body": "<code>#</code> is used to display non-zero digits. The number Format doesn&#39;t affect the actual cell value, but only how it&#39;s displayed. You can use <code>.Text</code> instead of <code>.Value</code> if you want to get the formatted value instead of the actual cell value."}, {"owner": {"reputation": 97, "user_id": 4934785, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf4026ca29a3a238d6d38e538fc0d05b?s=128&d=identicon&r=PG&f=1", "display_name": "geddeca", "link": "https://stackoverflow.com/users/4934785/geddeca"}, "edited": false, "score": 0, "creation_date": 1481764758, "post_id": 41153168, "comment_id": 69511695, "body": "I put in the code and 2 images. the first how it formats when user puts numbers in. the second - what happens when the cell is calculated using the vba code. sometimes it is a massive amount of decimal places 20??"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1481765604, "post_id": 41153168, "comment_id": 69511916, "body": "Simple solution buddy - just add to the VBA code right before you update the value <code>range(&quot;B5&quot;).NumberFormat = &quot;0.00&quot;</code> Alternatively, you can wrap the line in <code>Round((range(&quot;D5&quot;).Value &#47; range(&quot;D4&quot;).Value) * 100,2)</code>"}, {"owner": {"reputation": 97, "user_id": 4934785, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf4026ca29a3a238d6d38e538fc0d05b?s=128&d=identicon&r=PG&f=1", "display_name": "geddeca", "link": "https://stackoverflow.com/users/4934785/geddeca"}, "edited": false, "score": 0, "creation_date": 1481827646, "post_id": 41153168, "comment_id": 69542746, "body": "Slai, Thank you for your input. I am just wondering, would changing the value to .text not stop my calculations from working?"}, {"owner": {"reputation": 97, "user_id": 4934785, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf4026ca29a3a238d6d38e538fc0d05b?s=128&d=identicon&r=PG&f=1", "display_name": "geddeca", "link": "https://stackoverflow.com/users/4934785/geddeca"}, "edited": false, "score": 1, "creation_date": 1481827703, "post_id": 41153168, "comment_id": 69542782, "body": "user1274820 - I just see this now. Why wasn&#39;t it visible earlier? OK maybe I am going blind and didn&#39;t see it. Thank you again for your great answer"}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 4934785, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf4026ca29a3a238d6d38e538fc0d05b?s=128&d=identicon&r=PG&f=1", "display_name": "geddeca", "link": "https://stackoverflow.com/users/4934785/geddeca"}, "edited": false, "score": 1, "creation_date": 1481827447, "post_id": 41155021, "comment_id": 69542632, "body": "User1274820, I am sorry, I didn&#39;t see your original comment. I still don&#39;t. I used your solution and it worked perfect. Thank you."}], "tags": [], "owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "is_accepted": true, "score": 0, "last_activity_date": 1481766089, "last_edit_date": 1481766089, "creation_date": 1481765745, "answer_id": 41155021, "question_id": 41153168, "link": "https://stackoverflow.com/questions/41153168/using-excel-vba-to-autocalculate-some-cells-cell-formatting-of-2-decimal-places/41155021#41155021", "title": "using excel vba to autocalculate some cells. Cell formatting of 2 decimal places is overwritten", "body": "<p>As I said in my comment, if you want to change the number format, use:</p>\n\n<pre><code>range(\"B5\").NumberFormat = \"0.00\\%\"\nrange(\"B5\") = (range(\"D5\").Value / range(\"D4\").Value) * 100\n</code></pre>\n\n<p>If you want to actually round the number, use</p>\n\n<pre><code>range(\"B5\") = Round((range(\"D5\").Value / range(\"D4\").Value) * 100,2)\n</code></pre>\n\n<p>The parameters of <code>Round</code> are: <code>Round(Number, [Decimal Places])</code></p>\n"}], "owner": {"reputation": 97, "user_id": 4934785, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf4026ca29a3a238d6d38e538fc0d05b?s=128&d=identicon&r=PG&f=1", "display_name": "geddeca", "link": "https://stackoverflow.com/users/4934785/geddeca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 41155021, "answer_count": 1, "score": 1, "last_activity_date": 1481766089, "creation_date": 1481753769, "last_edit_date": 1481763453, "question_id": 41153168, "link": "https://stackoverflow.com/questions/41153168/using-excel-vba-to-autocalculate-some-cells-cell-formatting-of-2-decimal-places", "title": "using excel vba to autocalculate some cells. Cell formatting of 2 decimal places is overwritten", "body": "<p>I have cells that are formatted 0.00%. When typed in by the user it formats fine But if a cell is populated by a calculation done in vba it doesn't limit to 2 decimal places but goes like  33.3333333333. Is there a way to have it conform to what the cell is formatted as? thanks. cgeddes</p>\n\n<p><a href=\"https://i.stack.imgur.com/IDCAj.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IDCAj.jpg\" alt=\"\"></a></p>\n\n<p>B5 changed by downpayment change</p>\n\n<p><a href=\"https://i.stack.imgur.com/HOjnT.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HOjnT.jpg\" alt=\"\"></a></p>\n\n<pre><code>    Case \"$D$5\" ' Downpayment Entered\n        Me.Unprotect\n        range(\"B5\") = (range(\"D5\").Value / range(\"D4\").Value) * 100\n        Debug.Print \"Percent \" &amp; range(\"B5\").Value\n        range(\"D6\").Value = (range(\"D4\").Value - range(\"D5\").Value)\n          If range(\"D21\") &lt;&gt; 0 Then\n       MsgBox \"The Total Mortgaged Amount has changed, The Mortgage Payment Amount (Cell D21) is no longer valid. Please Re-calculate Mortgage with New Amount\"\n       End If\n</code></pre>\n\n<p>The formatting on B5 is 0.00##\\% When a user enters is displays as 5.00% or 10.00% whatever they enter.</p>\n\n<p>Hmmm. Maybe the ## means something ?? \nThank you Tim for helping be again today. </p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 145, "user_id": 6079835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242191f996e245a22cef6553b047fc6f?s=128&d=identicon&r=PG&f=1", "display_name": "ballsy26", "link": "https://stackoverflow.com/users/6079835/ballsy26"}, "edited": false, "score": 0, "creation_date": 1481754063, "post_id": 41153159, "comment_id": 69508458, "body": "the way i&#39;ve done it in the past is with <code>application.ontime setTime,&quot;subToCloseForm&quot;</code> rather than a loop."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1481754065, "post_id": 41153159, "comment_id": 69508459, "body": "Not sure about Access, but for Excel, I can auto unload UserForm by <code>Application.OnTime</code> to call a Sub in normal module which unloads the UserForm."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1481754079, "post_id": 41153159, "comment_id": 69508464, "body": "Where is the <code>Close</code> line?"}, {"owner": {"reputation": 23, "user_id": 7017098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bb51369f77ad202ce93e3887c435b72?s=128&d=identicon&r=PG&f=1", "display_name": "SheepBandit", "link": "https://stackoverflow.com/users/7017098/sheepbandit"}, "edited": false, "score": 0, "creation_date": 1481754275, "post_id": 41153159, "comment_id": 69508547, "body": "Sorry must have deleted the close line while reformatting. It&#39;s back in now."}, {"owner": {"reputation": 23, "user_id": 7017098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bb51369f77ad202ce93e3887c435b72?s=128&d=identicon&r=PG&f=1", "display_name": "SheepBandit", "link": "https://stackoverflow.com/users/7017098/sheepbandit"}, "edited": false, "score": 0, "creation_date": 1481755291, "post_id": 41153159, "comment_id": 69508901, "body": "Do I need to install a package to use Application.OnTime? I&#39;m getting a compile error that says method or data member not found."}, {"owner": {"reputation": 834, "user_id": 7254350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d50e0010acd2ec89f9242bfa8ea48e9?s=128&d=identicon&r=PG&f=1", "display_name": "tlemaster", "link": "https://stackoverflow.com/users/7254350/tlemaster"}, "edited": false, "score": 0, "creation_date": 1481756291, "post_id": 41153159, "comment_id": 69509284, "body": "To add to ballsy26&#39;s answer. Put your DoCmd.Close statement in a separate Sub called subToCloseForm. Put this statement in your Form_Load:     Application.OnTime Now + TimeValue(&quot;00:00:15&quot;), &quot;subToCloseForm&quot;"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1481757415, "post_id": 41153159, "comment_id": 69509705, "body": "If it is only 15 seconds, you could use a loop which repeatedly tests <code>Timer</code> (relative to a fixed time) with the body of the loop simply <code>DoEvents</code> so that the form will remain responsive to user input."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1481852115, "post_id": 41153159, "comment_id": 69552631, "body": "Application.OnTime is not available in access VBA"}], "answers": [{"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1481852085, "post_id": 41154892, "comment_id": 69552622, "body": "<code>Application.OnTime</code> is not available in access VBA"}, {"owner": {"reputation": 145, "user_id": 6079835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242191f996e245a22cef6553b047fc6f?s=128&d=identicon&r=PG&f=1", "display_name": "ballsy26", "link": "https://stackoverflow.com/users/6079835/ballsy26"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1481853533, "post_id": 41154892, "comment_id": 69552957, "body": "Wasn&#39;t aware of that. <a href=\"https://www.experts-exchange.com/questions/27034755/Application-OnTime-in-Access.html\" rel=\"nofollow noreferrer\" title=\"Application OnTime in Access.html\">experts-exchange.com/questions/27034755/&hellip;</a> this looks like an alternative to <code>application.ontime</code>"}], "tags": [], "owner": {"reputation": 145, "user_id": 6079835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242191f996e245a22cef6553b047fc6f?s=128&d=identicon&r=PG&f=1", "display_name": "ballsy26", "link": "https://stackoverflow.com/users/6079835/ballsy26"}, "is_accepted": false, "score": 1, "last_activity_date": 1481764730, "creation_date": 1481764730, "answer_id": 41154892, "question_id": 41153159, "link": "https://stackoverflow.com/questions/41153159/vba-how-to-keep-a-form-open-for-a-set-amount-of-seconds/41154892#41154892", "title": "VBA: How to keep a form open for a set amount of seconds", "body": "<p>putting all the prior comments together </p>\n\n<pre><code>Private Sub Form_Load()\n\n    setTime = Now + TimeValue(\"00:00:10\")    \n\n    Application.OnTime setTime, \"subToCloseForm\"\n\nEnd Sub\n\nSub subToCloseForm\n\n    DoCmd.Close\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7017098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bb51369f77ad202ce93e3887c435b72?s=128&d=identicon&r=PG&f=1", "display_name": "SheepBandit", "link": "https://stackoverflow.com/users/7017098/sheepbandit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 526, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513004413, "creation_date": 1481753721, "last_edit_date": 1513004413, "question_id": 41153159, "link": "https://stackoverflow.com/questions/41153159/vba-how-to-keep-a-form-open-for-a-set-amount-of-seconds", "title": "VBA: How to keep a form open for a set amount of seconds", "body": "<p>I'm creating a member sign in program using VBA and Microsoft Access. So i have the user enter their information and then everything is inserted into my database tables. After I do that I want to display a form with some information back to the user. However, I only want it to stay up for maybe 15 seconds and then close. Is there a way to do that?</p>\n\n<p>Here's a snippet of what I tried. Essentially I opened the form and then set a timer to close the form. When I do it this way the form is never actually displayed to the user. Any reason for this? It does show if I remove the close in the last line.</p>\n\n<pre><code>    Private Sub Form_Load()\n\n    [Forms]![SwipeServiceDatesHidden].Requery\n\n    currentTime = Now()\n    setTime = currentTime + TimeValue(\"00:00:10\")\n    Do While currentTime &lt; setTime\n        currentTime = Now()\n    Loop\n\n    DoCmd.Close acForm, \"SwipeServiceDatesHidden\", acSaveNo\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "object", "textbox", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1481755316, "post_id": 41152939, "comment_id": 69508916, "body": "Wow, 3000 shapes sounds excessive. I&#39;m sure there must be a better approach. That said you can check for an <code>Intersect</code> using the e.g. <code>Topleftcell</code> property of a shape."}, {"owner": {"reputation": 1, "user_id": 7299000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/520694d76fb6d3024fe18e1c767c624a?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/7299000/josh"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1483461265, "post_id": 41152939, "comment_id": 70102503, "body": "It is alot of shapes.  Currently I thinned it down to about 1400 but I am expecting a lot of more (2000 +) inputs shortly."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7299000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/520694d76fb6d3024fe18e1c767c624a?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/7299000/josh"}, "edited": false, "score": 0, "creation_date": 1483461137, "post_id": 41169742, "comment_id": 70102434, "body": "Thanks for the feedback.  I will attempt to incorporate your ideas to speed up my macro.  I do have the screenupdating set to false on my main macro which calls this macro. However, I am not familiar with either using dictionary or class type.  Those might be above my skill level at this time.  Thanks again for the response."}], "tags": [], "owner": {"reputation": 24, "user_id": 5343913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09cfd005f7f821b78a24e253a0f523b9?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/5343913/patrick-lepelletier"}, "is_accepted": false, "score": 0, "last_activity_date": 1481821884, "creation_date": 1481821884, "answer_id": 41169742, "question_id": 41152939, "link": "https://stackoverflow.com/questions/41152939/excel-vba-move-overlapping-shapes-on-worksheet/41169742#41169742", "title": "excel VBA: move overlapping shapes on worksheet", "body": "<p>The first thing would be to use <code>application.screenupdating</code>.</p>\n\n<p>Also some variable declarations are not or badly done (i, Sh).</p>\n\n<p>Don't use <code>Goto</code>. (i may use a <code>do while</code> or <code>do until</code> loop)</p>\n\n<p>Why test on each loop  <code>If i &lt;= sh.Shapes.count Then</code>wich obviously is the case?</p>\n\n<p>You can avoid <code>If s2.ID = s1.ID Then GoTo Suit</code> by not using a for each (wich tests shapes already corrected also), but <code>for j=i+ 1 to sh.shapes.count : set S2=sh.shapes(j)</code> ....`</p>\n\n<p>little reminder : on long IF tests , with several conditions, VBA will test all the conditions before continuing, so instead of testing 4 conditions, test only the 2 more important and <code>then</code> test the two others, for example.</p>\n\n<p>Beware, comments, buttons, and many other stuff is also a shape, so you might need a test of the shape's type (on s1). Avoid unessaceray looping.</p>\n\n<p>On a personal note, i'd use a dictionary and a class type, the whole thing would take max 5 secondes to loop, and no i won't write that code for you.\nYour approach is more at your level and is good enough with a bit of code optimization using the hints i gave.</p>\n"}], "owner": {"reputation": 1, "user_id": 7299000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/520694d76fb6d3024fe18e1c767c624a?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/7299000/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 933, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481821884, "creation_date": 1481752676, "last_edit_date": 1531164843, "question_id": 41152939, "link": "https://stackoverflow.com/questions/41152939/excel-vba-move-overlapping-shapes-on-worksheet", "title": "excel VBA: move overlapping shapes on worksheet", "body": "<p>I am creating a calendar where it pulls events from a user inputsheet and places a text box object on another worksheet (Dates across the top and different departments down the left).  It currently seperates the events on the top row of each section (i.e. all HR events on top row of HR section).  I then run a MACRO to check for overlapping objects and move them down to the next row.</p>\n\n<p>The code I use to move objects is below:</p>\n\n<pre><code>Sub MoveShapes()\n\n'This Macro moves overlapping shapes down to the next row\n\nDim wb As Workbook\nSet wb = ActiveWorkbook\nDim sh As Worksheet\nSet sh = wb.ActiveSheet\nDim s1 As Shape\nDim s2 As Shape\nDim CheckOverlap As Boolean\n\nWorksheets(\"SRTC\").Activate\n\n    For i = 1 To sh.Shapes.count\n        If i &lt;= sh.Shapes.count Then\n            Set s1 = sh.Shapes(i)\nSearch:\n        CheckOverlap = False\n            For Each s2 In Worksheets(\"SRTC\").Shapes\n                If s2.ID = s1.ID Then GoTo Suit\n                If s2.Left &lt;= (s1.Left + s1.Width) And s2.Left &gt;= s1.Left _\n                And s2.Top &lt;= (s1.Top + s1.Height) And s2.Top &gt;= s1.Top Then\n                    s1.Top = s1.Top + 18 ' 32\n                CheckOverlap = True\n            Exit For\n            End If\nSuit:\n            Next\n        If CheckOverlap = True Then GoTo Search\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>(I found this code in a different forum) This code works but is extremely slow.  It is comparing each textbox with all the text boxes on the worksheet.  My worksheet has over 3000 shapes and the MACRO takes over 4 hours to run.</p>\n\n<p>Is there a way to write this code to only move objects within certain ranges? (ie only HR section)</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "powershell"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1481751224, "post_id": 41152477, "comment_id": 69507302, "body": "Would help to include the relevant Powershell lines also"}, {"owner": {"reputation": 2034, "user_id": 2486496, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Rpd3r.jpg?s=128&g=1", "display_name": "gravity", "link": "https://stackoverflow.com/users/2486496/gravity"}, "edited": false, "score": 0, "creation_date": 1481751257, "post_id": 41152477, "comment_id": 69507319, "body": "Your code snippet is a VBScript.  It appears that your PowerShell script needs to be provided, as that is indicative of PowerShell indicating an unexpected term.  And no, you can&#39;t &quot;<i>write VB script inside PowerShell</i>&quot; you&#39;d have to invoke it, and pass data back and forth... but that seems very unnecessary.  Just use PowerShell."}, {"owner": {"reputation": 680, "user_id": 5418922, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh4.googleusercontent.com/-58gRw977WcA/AAAAAAAAAAI/AAAAAAAAAEk/el3e4oUFhw4/photo.jpg?sz=128", "display_name": "Nate", "link": "https://stackoverflow.com/users/5418922/nate"}, "edited": false, "score": 0, "creation_date": 1481751408, "post_id": 41152477, "comment_id": 69507385, "body": "My PowerShell code is fine.  The only reference to the .vbs within that is vb argument/invocation <code>.\\Converter.vbs &quot;$Selection&quot; &quot;$WorkCSV&quot;</code>.  If anyone knows how to get that Scripting Guy part to work though, that would resolve my issue."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1481751429, "post_id": 41152477, "comment_id": 69507398, "body": "There&#39;s no need to use VBS when you could do this directly in Powershell itself:  <a href=\"https://blogs.technet.microsoft.com/heyscriptingguy/2006/09/08/how-can-i-use-windows-powershell-to-automate-microsoft-excel/\" rel=\"nofollow noreferrer\">blogs.technet.microsoft.com/heyscriptingguy/2006/09/08/&hellip;</a>"}, {"owner": {"reputation": 680, "user_id": 5418922, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh4.googleusercontent.com/-58gRw977WcA/AAAAAAAAAAI/AAAAAAAAAEk/el3e4oUFhw4/photo.jpg?sz=128", "display_name": "Nate", "link": "https://stackoverflow.com/users/5418922/nate"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1481752003, "post_id": 41152477, "comment_id": 69507644, "body": "@TimWilliams thanks for that.  I&#39;m looking at that but I&#39;m not sure how I call my specific Excel file with that.  I get how it turns to the specified sheet and saves, but I&#39;m not sure how I load my Excel document into that."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1481752087, "post_id": 41152477, "comment_id": 69507681, "body": "See my answer below - has hard-coded paths but if you have variables with &quot;in&quot; and &quot;out&quot; paths you would just use those instead"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1481752027, "creation_date": 1481752027, "answer_id": 41152763, "question_id": 41152477, "link": "https://stackoverflow.com/questions/41152477/run-vb-code-inside-powershell/41152763#41152763", "title": "Run VB Code Inside PowerShell", "body": "<p>There's no need to use VBS when you could do this directly in Powershell itself:</p>\n\n<pre><code>$a = New-Object -comobject Excel.Application\n$a.Visible = $True\n\n$b = $a.Workbooks.Open(\"C:\\_Stuff\\test2.xlsx\")\n$c = $b.Worksheets.Item(2)\n$c.Activate()\n$b.SaveAs(\u201cC:\\_Stuff\\Test.csv\u201d,6)\n$b.Close(0)\n$a.Quit()\n</code></pre>\n\n<p><a href=\"https://blogs.technet.microsoft.com/heyscriptingguy/2006/09/08/how-can-i-use-windows-powershell-to-automate-microsoft-excel/\" rel=\"nofollow noreferrer\">https://blogs.technet.microsoft.com/heyscriptingguy/2006/09/08/how-can-i-use-windows-powershell-to-automate-microsoft-excel/</a></p>\n"}], "owner": {"reputation": 680, "user_id": 5418922, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh4.googleusercontent.com/-58gRw977WcA/AAAAAAAAAAI/AAAAAAAAAEk/el3e4oUFhw4/photo.jpg?sz=128", "display_name": "Nate", "link": "https://stackoverflow.com/users/5418922/nate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1168, "favorite_count": 0, "accepted_answer_id": 41152763, "answer_count": 1, "score": -1, "last_activity_date": 1481752027, "creation_date": 1481750886, "question_id": 41152477, "link": "https://stackoverflow.com/questions/41152477/run-vb-code-inside-powershell", "title": "Run VB Code Inside PowerShell", "body": "<p>Is it possible to run VB Code <em>inside</em> PowerShell?  I don't want to invoke a .vbs from inside PowerShell, I want to embed the VB code inside the PowerShell script.  I'm like, 90% sure you can do that, but I don't know how and can't seem to get a solid Google result.  I'm just guessing at this point.</p>\n\n<p>I am currently invoking a .vbs with arguments inside PowerShell because the argument parameters are based on a selection the executer makes while running PowerShell, but I'd really like to wrap it all up into one file.</p>\n\n<p>Currently, I am using this to turn page 2 of an Excel sheet into a CSV:</p>\n\n<pre><code>Dim oExcel\nSet oExcel = CreateObject(\"Excel.Application\")\nDim oBook\nSet oBook = oExcel.Workbooks.Open(Wscript.Arguments.Item(0))\noBook.Worksheets(2).Activate\noBook.SaveAs WScript.Arguments.Item(1), 6\noBook.Close False\noExcel.Quit\n</code></pre>\n\n<p>I tried to use <A HREF=\"https://blogs.technet.microsoft.com/heyscriptingguy/2005/03/22/how-can-i-save-a-single-excel-worksheet-to-a-csv-file/\" rel=\"nofollow noreferrer\">this from the Scripting Guy blog</A> but couldn't get it to work and never got an answer there.  </p>\n\n<p>I get this error:</p>\n\n<pre><code>Const : The term 'Const' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify \nthat the path is correct and try again.\nAt line:1 char:1\n+ Const xlCSV = 6\n+ ~~~~~\n    + CategoryInfo          : ObjectNotFound: (Const:String) [],     CommandNotFoundException\n    + FullyQualifiedErrorId : CommandNotFoundException\n</code></pre>\n\n<p>If anyone can show me how this PowerShell code would work to get the second sheet of my Excel sheet (SHEET1) I'd love that too.</p>\n\n<p>I hope the answer is as simple and dumb as I think it is.  Thanks for any assistance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1481750992, "post_id": 41152338, "comment_id": 69507180, "body": "Alt + Enter, creates a line break in cell. <code>TRIM</code> won&#39;t help as its not space. Use substitute. Like : <code>=SUBSTITUTE(A1,CHAR(10),&quot;&quot;)</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481753579, "post_id": 41152338, "comment_id": 69508275, "body": "If you really do mean &quot;remove everything in the cell after the <b>second</b> line&quot;, some tweaks will need to be made to the answers provided.  (But hopefully that is just a typo and you meant &quot;first line&quot;.)"}, {"owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "edited": false, "score": 0, "creation_date": 1481806555, "post_id": 41152338, "comment_id": 69529755, "body": "ah yes, I meant everything on the second line, so after first."}], "answers": [{"comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1481750995, "post_id": 41152454, "comment_id": 69507183, "body": "There are several different possibilities for line breaks. <code>Chr(10)</code> is just one of them. You might want to include <code>vbCrLf</code> and <code>vbNewLine</code> just to render your solution more complete."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1481751263, "post_id": 41152454, "comment_id": 69507323, "body": "@Ralph  I will fix this."}, {"owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "edited": false, "score": 0, "creation_date": 1481807382, "post_id": 41152454, "comment_id": 69530250, "body": "The first one seems to work perfectly for what I intended. The edit is giving me a the error <code>Wrong number of arguments or invalid property assignment</code> Now, to spend some time on google so I can understand what you&#39;ve provided me with. Thanks so much!"}, {"owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "edited": false, "score": 0, "creation_date": 1481813592, "post_id": 41152454, "comment_id": 69534516, "body": "Is it possible to achieve this using a less strenuous method? I have 140k rows in my column that it is having to loop through, I had to close out after about 15 minutes of Excel not responding. I did turn off screen updating but doesn&#39;t seem to help much and that is about as far as my inexperience with VBA can take me.  Thanks much for any response."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "edited": false, "score": 0, "creation_date": 1481814292, "post_id": 41152454, "comment_id": 69535039, "body": "@Awill  See my <b>EDIT#2</b>"}, {"owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "edited": false, "score": 0, "creation_date": 1481816244, "post_id": 41152454, "comment_id": 69536265, "body": "This is possible to do without knowing what the values of the cell should be? There are thousands of items that will change on a monthly basis. Sorry for my lack of understanding, I am trying to research how to execute the options you gave in edit # 2."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "edited": false, "score": 0, "creation_date": 1481819638, "post_id": 41152454, "comment_id": 69538435, "body": "@Awill  <b>Which column holds the data you are trying to process ??</b>"}, {"owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "edited": false, "score": 0, "creation_date": 1481828134, "post_id": 41152454, "comment_id": 69543009, "body": "Column 7 of my table. What I attempted was; <code>Sub KleanUp()     Dim r As Range ActiveSheet.Range (&quot;Table2&quot;).Columns (7).Select     For Each r In Selection         r.Value = Split(r.Value, Chr(10))(0)     Next r End Sub</code>"}, {"owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1481828588, "post_id": 41152454, "comment_id": 69543260, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/130723/discussion-between-awill-and-garys-student\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 3, "last_activity_date": 1481814264, "last_edit_date": 1481814264, "creation_date": 1481750770, "answer_id": 41152454, "question_id": 41152338, "link": "https://stackoverflow.com/questions/41152338/identify-second-line-of-text-in-a-cell-with-vba/41152454#41152454", "title": "Identify second line of text in a cell with VBA", "body": "<p>Just look for the <em>ASCII-10</em>.  Select the cells you wish to process and run:</p>\n\n<pre><code>Sub KleanUp()\n    Dim r As Range\n    For Each r In Selection\n        r.Value = Split(r.Value, Chr(10))(0)\n    Next r\nEnd Sub\n</code></pre>\n\n<p>Only the first line will be retained in each cell.</p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>As Ralph points out, <em>ASCII-13</em> should also be considered, therefore:</p>\n\n<pre><code>Sub KleanUp2()\n    Dim r As Range\n    For Each r In Selection\n        r.Value = Split(Replace(r.Value, Chr(13), Chr(10)), Chr(10))(0)\n    Next r\nEnd Sub\n</code></pre>\n\n<p>This converts to a single-style line-break.</p>\n\n<p><strong>EDIT#2:</strong></p>\n\n<p>It is possible to improve the performance of the sub by:</p>\n\n<ul>\n<li>reading the data into a VBA array  as a single large block</li>\n<li>looping through the array <em>(in VBA)</em></li>\n<li>transferring the data back to the worksheet in a single block</li>\n</ul>\n"}], "owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2181, "favorite_count": 0, "accepted_answer_id": 41152454, "answer_count": 1, "score": 0, "last_activity_date": 1481814264, "creation_date": 1481750197, "last_edit_date": 1531164843, "question_id": 41152338, "link": "https://stackoverflow.com/questions/41152338/identify-second-line-of-text-in-a-cell-with-vba", "title": "Identify second line of text in a cell with VBA", "body": "<p>I have a bunch of cells that have two lines of text in each cell after pulling the data into Excel.\nWhat I am looking to do is use a macro with the <code>Trim</code> function to remove everything in the cell after the second line.\nI'm puzzled with this data, it's as if you were to enter data in a cell and Enter down to the next cell, but it's one cell and is not merged.</p>\n\n<p>ex.</p>\n\n<p><code>Someone's Name [123]\nProcedure room, procedure done</code></p>\n\n<p>Is there a way to identify this line break?</p>\n\n<p>thanks so much for any assistance, my heads spinning and I'm punching out for the day.\ncheers</p>\n"}, {"tags": ["excel", "row", "cell", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1481749831, "post_id": 41152207, "comment_id": 69506648, "body": "You will need to include more code than this, and be sure to copy it from the VB Editor to ensure it&#39;s formatted correctly and an exact match to the code you&#39;re working with.  It&#39;s clear the code above was not copied from the editor."}, {"owner": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "edited": false, "score": 0, "creation_date": 1481752521, "post_id": 41152207, "comment_id": 69507858, "body": "the xldown is the problem. There is nothing Under the first line, so it returns &quot; &quot;"}], "owner": {"reputation": 9, "user_id": 7298617, "user_type": "registered", "profile_image": "https://graph.facebook.com/1180337905414617/picture?type=large", "display_name": "Broesen", "link": "https://stackoverflow.com/users/7298617/broesen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 217, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1481883909, "creation_date": 1481749674, "last_edit_date": 1531164843, "question_id": 41152207, "link": "https://stackoverflow.com/questions/41152207/last-row-value-returns-blank-with-only-one-data-row", "title": "last row value returns blank with only one data row", "body": "<p>HI I have copied some code. It works fine as long there are more than two rows in each column. If there is only only one row it returns the value \" \"\n'and not the first and only value in that column. Have can I get it to work? </p>\n\n<pre><code>Sub ListCombinations()\n</code></pre>\n\n<p>Dim col As New Collection\nDim c As Range, sht As Worksheet, res\nDim i As Long, arr, numCols As Long\nDim numCol As Integer\nDim Col_Cnt As Integer\nDim Rows_Cnt As Integer\n    Set sht = Worksheets(\"Sheet5\")\n    Col_Cnt = sht.UsedRange.Columns.Count 'add\n    Rows_Cnt = sht.UsedRange.Rows.Count ' add</p>\n\n<pre><code>For Each c In sht.Range(\"A1:B1\").Cells\n    col.add Application.Transpose(sht.Range(c, c.End(xlDown)))\n    numCols = numCols + 1\n    MsgBox \"numCols =  \" &amp; numCols\nNext c\n\nres = Combine(col, \"~~\")\n\nFor i = 0 To UBound(res)\n    arr = Split(res(i), \"~~\")\n    sht.Range(\"H1\").Offset(i, 0).Resize(1, numCols) = arr\nNext i\n</code></pre>\n\n<p>End Sub</p>\n\n<p>'create combinations from a collection of string arrays\nFunction Combine(col As Collection, SEP As String) As String()</p>\n\n<pre><code>Dim rv() As String\nDim pos() As Long, lengths() As Long, lbs() As Long, ubs() As Long\nDim t As Long, i As Long, n As Long, ub As Long\nDim numIn As Long, s As String, r As Long\n\nnumIn = col.Count\nMsgBox numIn\nReDim pos(1 To numIn)\nReDim lbs(1 To numIn)\nReDim ubs(1 To numIn)\nReDim lengths(1 To numIn)\nt = 0\nFor i = 1 To numIn  'calculate # of combinations, and cache bounds/lengths\n    lbs(i) = LBound(col(i))\n    ubs(i) = UBound(col(i))\n    lengths(i) = (ubs(i) - lbs(i)) + 1\n    pos(i) = lbs(i)\n    t = IIf(t = 0, lengths(i), t * lengths(i))\nNext i\nReDim rv(0 To t - 1) 'resize destination array\n\nFor n = 0 To (t - 1)\n    s = \"\"\n    For i = 1 To numIn\n        s = s &amp; IIf(Len(s) &gt; 0, SEP, \"\") &amp; col(i)(pos(i)) 'build the string\n    Next i\n    rv(n) = s\n\n    For i = numIn To 1 Step -1\n        If pos(i) &lt;&gt; ubs(i) Then   'Not done all of this array yet...\n            pos(i) = pos(i) + 1    'Increment array index\n            For r = i + 1 To numIn 'Reset all the indexes\n                pos(r) = lbs(r)    '   of the later arrays\n            Next r\n            Exit For\n        End If\n    Next i\nNext n\n\nCombine = rv\n</code></pre>\n\n<p>End Function</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1481749712, "post_id": 41151827, "comment_id": 69506590, "body": "I would uninstall office, make a full-system scan and re-install."}], "answers": [{"comments": [{"owner": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "edited": false, "score": 0, "creation_date": 1481752698, "post_id": 41152384, "comment_id": 69507933, "body": "But what was the problem? Was there a problem in the System, or Excel it self? Or it was Macro Security problem?"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1481750420, "creation_date": 1481750420, "answer_id": 41152384, "question_id": 41151827, "link": "https://stackoverflow.com/questions/41151827/excel-personal-worksheet-vba-modules-wont-allow-me-to-view-code/41152384#41152384", "title": "Excel Personal Worksheet VBA Module&#39;s won&#39;t allow me to view code", "body": "<p>I had a similar problem a while ago.  I had to:</p>\n\n<ul>\n<li>close Excel</li>\n<li>re-name PERSONAL.xlsm to something else <em>(like temp.xlsm)</em></li>\n<li>open Excel and verify it does not \"see\" or attempt to open PERSONAL</li>\n<li>create a new PERSONAL.xlsm</li>\n<li>copy all VBA from temp.xlsm to the new PERSONAL.xlsm</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 24, "user_id": 5343913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09cfd005f7f821b78a24e253a0f523b9?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/5343913/patrick-lepelletier"}, "is_accepted": false, "score": -1, "last_activity_date": 1481820260, "creation_date": 1481820260, "answer_id": 41169244, "question_id": 41151827, "link": "https://stackoverflow.com/questions/41151827/excel-personal-worksheet-vba-modules-wont-allow-me-to-view-code/41169244#41169244", "title": "Excel Personal Worksheet VBA Module&#39;s won&#39;t allow me to view code", "body": "<p>Can't comment yet, so i apologize in advance.</p>\n\n<p>It is definitely Excel at fault, it happens to me so often (on big files including VBA) that my before_save saves a copy of the file with time in its name, and all module's, userform's, sheet's code as *.frm, *.cls, *.bas.</p>\n\n<p>I usually can also open corrupt files by holding SHIFT key (force designer mode) and then copy manually stuff.</p>\n"}], "owner": {"reputation": 1, "user_id": 7298751, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PNNqp1KQbQI/AAAAAAAAAAI/AAAAAAAAAF8/S8_y3B8i-EI/photo.jpg?sz=128", "display_name": "Kai", "link": "https://stackoverflow.com/users/7298751/kai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1420, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1481820260, "creation_date": 1481748285, "question_id": 41151827, "link": "https://stackoverflow.com/questions/41151827/excel-personal-worksheet-vba-modules-wont-allow-me-to-view-code", "title": "Excel Personal Worksheet VBA Module&#39;s won&#39;t allow me to view code", "body": "<p>My personal workbook (PERSONAL.xlsm) has stopped allowing me to view the code or any details of the modules I have saved there. It also will not allow me to run any of the Macros it once included. I don't know if they got deleted or are hiding somewhere (but I am hoping it is the later). I have not done anything out of the ordinary. Before this issue was happening all I had done with excel today was run one of these macros (without issue), make an edit to include the solver in a macro, and save it.</p>\n\n<p>In addition to this problem there are a few others that seem to accompany it:</p>\n\n<ul>\n<li>Occasionally when I close excel without saving a file, excel crashes.</li>\n<li>If I attempt to record a macro (either in the Personal Workbook or to\nanother location) one of the following happens:</li>\n<li>a. Excel crashes.</li>\n<li>b. Excel gives me an Invalid Name Error (despite the name being perfectly valid.</li>\n</ul>\n\n<p>It is worth noting that macros not saved in the Personal Workbook work just fine. I am very stumped and cannot find a solution to this problem anywhere. I have tried the obvious (rebooting my computer), the not so obvious (restoring previous versions of files), and the weird (disabling and enabling random things in the excel options section). Please, if you have a solution let me know!</p>\n\n<p>Thank you in advance, all and any suggestions are appreciated!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1481748486, "post_id": 41151801, "comment_id": 69505951, "body": "If there are blank rows at the top, <code>UsedRange</code>&#39;s row index won&#39;t necessarily match the worksheet&#39;s row index."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1481748567, "post_id": 41151801, "comment_id": 69505998, "body": "Well, the code is a bit messy. E.g. defining variables inside a loop gives me nausea. But actually it is deleting every full row where there is nothing from column 4 (D) to column 11 (K). So if your cells in D8:K8 are empty, row 8 will be deleted. Try stepping through your code with F8."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1481748731, "post_id": 41151801, "comment_id": 69506074, "body": "or try to put something (i.e. some blank characters) in the cell &quot;D8&quot;. Or, in the code, check for (<code>If n &lt;&gt; 8</code>)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481749061, "post_id": 41151801, "comment_id": 69506267, "body": "Instead of all those <code>If x = &quot;&quot;</code> couldn&#39;t you do <code>If isEmpty(Range(Cells(n,4),Cells(n,11))</code>?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1481749063, "post_id": 41151801, "comment_id": 69506269, "body": "I thought the comment by @Comintern would probably be the reason, but you are always using rows as an offset from the start of the <code>UsedRange</code> anyway - it is actually the <b>columns</b> that you aren&#39;t offsetting from the start of <code>UsedRange</code>.  I would bet that you have a completely empty column in either column A, B or C, and therefore <code>rw.Cells(n, 4)</code> is not referring to column D (etc)"}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481749260, "post_id": 41151801, "comment_id": 69506359, "body": "@YowE3K Yes columns A, B and C are empty. The reason for that i don&#39;t know, they give me the file like that and every excel file they send formatted in that way."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481749360, "post_id": 41151801, "comment_id": 69506414, "body": "If your <code>UsedRange</code> starts at column D, <code>rw.Cells(n, 4).Value</code> will be looking in column G, i.e. four columns from the left of the range."}, {"owner": {"reputation": 1556, "user_id": 5061821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3880a7c7ddf65d95ddd3152bd13a41b5?s=128&d=identicon&r=PG", "display_name": "Wyatt Shipman", "link": "https://stackoverflow.com/users/5061821/wyatt-shipman"}, "edited": false, "score": 2, "creation_date": 1481749362, "post_id": 41151801, "comment_id": 69506415, "body": "Do you just need to update you For loop to <code>For n= nlast to 2 step -1</code> because the header is being counted in the <code>UsedRange</code>?"}, {"owner": {"reputation": 1556, "user_id": 5061821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3880a7c7ddf65d95ddd3152bd13a41b5?s=128&d=identicon&r=PG", "display_name": "Wyatt Shipman", "link": "https://stackoverflow.com/users/5061821/wyatt-shipman"}, "edited": false, "score": 1, "creation_date": 1481749677, "post_id": 41151801, "comment_id": 69506570, "body": "What is an example of your <code>UsedRange</code>?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481749717, "post_id": 41151801, "comment_id": 69506594, "body": "You can get around the column offset issue by just using <code>Set rw = ActiveWorkbook.ActiveSheet.UsedRange.EntireRow.Rows</code>, but Wyatt&#39;s solution is probably easier."}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "edited": false, "score": 0, "creation_date": 1481750168, "post_id": 41151801, "comment_id": 69506812, "body": "I don&#39;t completely understand why usedrange is an issue here, If I set my columns from D to K then the range should be narrowed down to those columns."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481750666, "post_id": 41151801, "comment_id": 69507035, "body": "If <code>UsedRange</code> doesn&#39;t start until column D, then <code>rw.Cells(n, 4)</code> <i>isn&#39;t</i> in column D, it&#39;s in column G. Similar with rows.  <code>.Cells(1, 1)</code> is to top left cell, wherever it happens to be."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481750673, "post_id": 41151801, "comment_id": 69507039, "body": "If <code>UsedRange</code> is <code>$D$7:$L$34</code> then <code>rw.Cells(n, 4)</code> is referring to the spreadsheet row 7+(n-1), and the spreadsheet column 4+(4-1).  What is happening with rows is exactly what you need to happen, but what is happening with columns is not what you are expecting."}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "edited": false, "score": 0, "creation_date": 1481750762, "post_id": 41151801, "comment_id": 69507081, "body": "It starts at column G because of the loop?? or because of rw.cell(x,x)?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481751091, "post_id": 41151801, "comment_id": 69507231, "body": "The 4th column starting from column D (i.e. the first column in <code>rw</code>) is column G.  So to reference column D in your original code you should have used <code>rw.Cells(n, 1)</code>, i.e. the first column of <code>rw</code> in the nth row of <code>rw</code>."}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481751364, "post_id": 41151801, "comment_id": 69507369, "body": "@YowE3K So replace rw.cells(n,4) with rw.Cells(n, 1) and replace everything after with rw.Cells(n, 2) rw.Cells(n, 3) etc...."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481751797, "post_id": 41151801, "comment_id": 69507541, "body": "The answer by @comintern is probably the best way to go, but there is still an issue with his loop that needs to be fixed.  (Hopefully he will do so soon.)   EDIT - Now fixed."}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481757266, "post_id": 41151801, "comment_id": 69509663, "body": "<code>For n = nlast To 9 Step -1</code>  worked for now but like @YowE3K said I need to clean up my loop"}], "answers": [{"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "edited": false, "score": 0, "creation_date": 1481750489, "post_id": 41152255, "comment_id": 69506950, "body": "@MTBthePRO - Yup. Fixed."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "edited": false, "score": 1, "creation_date": 1481750707, "post_id": 41152255, "comment_id": 69507054, "body": "<code>For n = nlast To 9 Step -1</code>"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 3, "last_activity_date": 1481751927, "last_edit_date": 1481751927, "creation_date": 1481749882, "answer_id": 41152255, "question_id": 41151801, "link": "https://stackoverflow.com/questions/41151801/vba-code-deleting-incorrect-rows/41152255#41152255", "title": "VBA code deleting incorrect rows", "body": "<p>The issue is that you are using the row and column indexes of <code>UsedRange</code> with the assumption that they match the indexes of the <code>Worksheet</code>.  This isn't necessarily the case.  As you pointed out to @YowE3K in the comments, you have some completely empty columns.</p>\n\n<p>The solution is pretty easy - just use the <code>ws.Cells</code> instead of <code>rw.Cells</code>.  I'd also throw everything inside the loop into a <code>With</code> block to make it faster and more readable.  You can also short-circuit that long <code>If</code> statement by converting it into a <code>Select Case</code> ladder:</p>\n\n<pre><code>Sub RemoveEmptyRows()\n    Dim ws As Worksheet\n    For Each ws In ThisWorkbook.Sheets\n        With ws\n            Dim n As Long\n            Dim nlast As Long\n            nlast = .UsedRange.Rows(.UsedRange.Rows.Count).Row\n            For n = nlast To 9 Step -1\n                Select Case False\n                    Case .Cells(n, 4).Value = vbNullString\n                    Case .Cells(n, 5).Value = vbNullString\n                    Case .Cells(n, 6).Value = vbNullString\n                    Case .Cells(n, 7).Value = vbNullString\n                    Case .Cells(n, 8).Value = vbNullString\n                    Case .Cells(n, 9).Value = vbNullString\n                    Case .Cells(n, 10).Value = vbNullString\n                    Case .Cells(n, 11).Value = vbNullString\n                    Case Else\n                        .Rows(n).Delete\n                End Select\n            Next n\n        End With\n    Next ws\nEnd Sub\n</code></pre>\n\n<p>Note that there are also more reliable ways to find the last row of the sheet.</p>\n"}, {"tags": [], "owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "is_accepted": false, "score": 0, "last_activity_date": 1481750490, "creation_date": 1481750490, "answer_id": 41152404, "question_id": 41151801, "link": "https://stackoverflow.com/questions/41151801/vba-code-deleting-incorrect-rows/41152404#41152404", "title": "VBA code deleting incorrect rows", "body": "<p>Here is your code a little amended.  </p>\n\n<pre><code>Sub RemoveEmptyRows()\n\n    Dim ws As Worksheet\n    Dim n As Long\n    Dim nlast As Long\n    Dim rw As Range\n\n    For Each ws In Worksheets 'changed. In case there are Chart Sheets.\n    'deleted ws.activate. AVOID THAT AS PLAGUE\n        Set rw = ws.UsedRange.Rows\n        With rw\n            nlast = .Count\n            For n = nlast To 2 Step -1 'Note the 2, to skip title row. As was pointed in comments.\n                If (.Cells(n, 4).Value2 = \"\" And .Cells(n, 5).Value2 = \"\" And .Cells(n, 6).Value2 = \"\" And .Cells(n, 7).Value2 = \"\" And .Cells(n, 8).Value2 = \"\" And .Cells(n, 9).Value2 = \"\" And .Cells(n, 10).Value2 = \"\" And .Cells(n, 11).Value2 = \"\") Then\n                    .Rows(n).Delete\n                End If\n            Next n\n        End With 'rw\n    Next ws\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "is_accepted": false, "score": 1, "last_activity_date": 1481753039, "creation_date": 1481753039, "answer_id": 41153025, "question_id": 41151801, "link": "https://stackoverflow.com/questions/41151801/vba-code-deleting-incorrect-rows/41153025#41153025", "title": "VBA code deleting incorrect rows", "body": "<p>your Title is in C8, then don't delete until Row number 1 :</p>\n\n<p>replace</p>\n\n<pre><code>For n = nlast To 1 Step -1\n</code></pre>\n\n<p>by</p>\n\n<pre><code>For n = nlast To 9 Step -1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1481753731, "creation_date": 1481753731, "answer_id": 41153160, "question_id": 41151801, "link": "https://stackoverflow.com/questions/41151801/vba-code-deleting-incorrect-rows/41153160#41153160", "title": "VBA code deleting incorrect rows", "body": "<p>You could try this (not tested) code:</p>\n\n<pre><code>Sub RemoveEmptyRows()\n    Dim ws As Worksheet\n    Dim nCols As Long\n\n    For Each ws In Sheets\n        With Intersect(.Range(\"D:K\"), .UsedRange)\n            nCols = .Columns.Count\n            With .SpecialCells(xlCellTypeBlanks)\n                For iArea = .Areas.Count To 1 Step -1\n                    If .Areas(iArea).Count = nCols Then .Areas(iArea).EntireRow.Delete\n                Next\n            End With\n        End With\n    Next ws  \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 41152255, "answer_count": 4, "score": 1, "last_activity_date": 1481753731, "creation_date": 1481748192, "last_edit_date": 1481749508, "question_id": 41151801, "link": "https://stackoverflow.com/questions/41151801/vba-code-deleting-incorrect-rows", "title": "VBA code deleting incorrect rows", "body": "<p>I have this code that deletes a row if it has empty cells in columns D to L.<br>\nFor some reason it is also deleting my title cell which is located at C8.<br>\nAnyone knows why? And how to fix it?</p>\n\n<pre><code>Sub RemoveEmptyRows()\n\nDim ws As Worksheet\nFor Each ws In Sheets\nws.Activate\n\n  Dim n As Long\n    Dim nlast As Long\n    Dim rw As Range\n    Set rw = ActiveWorkbook.ActiveSheet.UsedRange.Rows\n    nlast = rw.count\n    For n = nlast To 1 Step -1\n        If (rw.Cells(n, 4).Value = \"\" And rw.Cells(n, 5).Value = \"\" And rw.Cells(n, 6).Value = \"\" And rw.Cells(n, 7).Value = \"\" And rw.Cells(n, 8).Value = \"\" And rw.Cells(n, 9).Value = \"\" And rw.Cells(n, 10).Value = \"\" And rw.Cells(n, 11).Value = \"\") Then\n            rw.Rows(n).Delete\n        End If\n    Next n\n    Next ws\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7298763, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4I50NUfnUsI/AAAAAAAAAAI/AAAAAAAAAEI/DBEsToIP0oE/photo.jpg?sz=128", "display_name": "Jeremy Runkles", "link": "https://stackoverflow.com/users/7298763/jeremy-runkles"}, "edited": false, "score": 0, "creation_date": 1481814014, "post_id": 41152860, "comment_id": 69534826, "body": "Correct, I think I solved my own problem. This file will be on a network so I believe when they hit the submit button it wont prompt them to save since its already there."}, {"owner": {"reputation": 11, "user_id": 7298763, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4I50NUfnUsI/AAAAAAAAAAI/AAAAAAAAAEI/DBEsToIP0oE/photo.jpg?sz=128", "display_name": "Jeremy Runkles", "link": "https://stackoverflow.com/users/7298763/jeremy-runkles"}, "edited": false, "score": 0, "creation_date": 1481821235, "post_id": 41152860, "comment_id": 69539371, "body": "Actually I have another issue, I need to the document to save in a specific location. Right now its saving over the old document and I need to to save to a specific location in order to send it in an email."}], "tags": [], "owner": {"reputation": 38, "user_id": 7196723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a69c2cc89ed9fa6f9324d44bf22f8c6a?s=128&d=identicon&r=PG&f=1", "display_name": "Steffen", "link": "https://stackoverflow.com/users/7196723/steffen"}, "is_accepted": false, "score": 0, "last_activity_date": 1481752356, "creation_date": 1481752356, "answer_id": 41152860, "question_id": 41151695, "link": "https://stackoverflow.com/questions/41151695/save-form-automatically-rather-than-generating-prompt-to-save-manually/41152860#41152860", "title": "Save form automatically rather than generating prompt to save manually", "body": "<p>I don't know if I really got your question. You don't want this prompt?</p>\n\n<pre><code>Set Doc = ActiveDocument\nDoc.Save\n</code></pre>\n\n<p>This saves the document. If you don't want to save it, remove those lines.</p>\n"}], "owner": {"reputation": 11, "user_id": 7298763, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4I50NUfnUsI/AAAAAAAAAAI/AAAAAAAAAEI/DBEsToIP0oE/photo.jpg?sz=128", "display_name": "Jeremy Runkles", "link": "https://stackoverflow.com/users/7298763/jeremy-runkles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481758677, "creation_date": 1481747741, "last_edit_date": 1481758677, "question_id": 41151695, "link": "https://stackoverflow.com/questions/41151695/save-form-automatically-rather-than-generating-prompt-to-save-manually", "title": "Save form automatically rather than generating prompt to save manually", "body": "<p>I have a form that has a submit button. When I do it on my PC it works fine but on someone else's that does not have the file saved, it prompts them to save it. I was wondering if I could add something that will automatically save it to their documents folder before sending it. </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim OL              As Object\n    Dim EmailItem       As Object\n    Dim Doc             As Document\n\n    Application.ScreenUpdating = False\n    Set OL = CreateObject(\"Outlook.Application\")\n    Set EmailItem = OL.CreateItem(olMailItem)\n    Set Doc = ActiveDocument\n    Doc.Save\n\n    With EmailItem\n        .Subject = \"subject\"\n        .Body = \"BODY MESSAGE\"\n        .To = \"email here\"\n        .Importance = olImportanceNormal\n        .Attachments.Add Doc.FullName\n        .Display\n    End With\n\n    Application.ScreenUpdating = True\n\n    Set Doc = Nothing\n    Set OL = Nothing\n    Set EmailItem = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481745375, "post_id": 41150748, "comment_id": 69504351, "body": "I hope your update checker exits gracefully when the user is not connected to the internet."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1481745883, "post_id": 41150748, "comment_id": 69504630, "body": "Show the <code>CheckForUpdate()</code> code. Which line of the code takes the longest time? You should run check in another process, or via XHR in asynchronous mode."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1481746917, "post_id": 41150748, "comment_id": 69505145, "body": "If it&#39;s interfering with <code>Workbook_Open()</code>, why not just use <code>Application.OnTime</code> to schedule it for 10-15 seconds after the workbook loads?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1481747186, "post_id": 41150748, "comment_id": 69505258, "body": "How about an asynchronous VBScript (that is bundled with the add-in) which is launched by the open event. Excel can keep on running while the VBScript is running in its own thread. The VBScript can popup a message if an update is available."}, {"owner": {"reputation": 45, "user_id": 7001768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34e52b9c753891fdda481d2c39dbfcbc?s=128&d=identicon&r=PG&f=1", "display_name": "carole1", "link": "https://stackoverflow.com/users/7001768/carole1"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1481747353, "post_id": 41150748, "comment_id": 69505349, "body": "@omegastripes I added some code."}, {"owner": {"reputation": 45, "user_id": 7001768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34e52b9c753891fdda481d2c39dbfcbc?s=128&d=identicon&r=PG&f=1", "display_name": "carole1", "link": "https://stackoverflow.com/users/7001768/carole1"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481747373, "post_id": 41150748, "comment_id": 69505360, "body": "@YowE3K Yes. I omitted error checking in my example, but I&#39;ll have it in my production code."}, {"owner": {"reputation": 45, "user_id": 7001768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34e52b9c753891fdda481d2c39dbfcbc?s=128&d=identicon&r=PG&f=1", "display_name": "carole1", "link": "https://stackoverflow.com/users/7001768/carole1"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481747379, "post_id": 41150748, "comment_id": 69505363, "body": "@Comintern I can&#39;t get that to work. It says it can&#39;t find the macro. I think it&#39;s looking in the open workbook and not the add-in workbook."}, {"owner": {"reputation": 45, "user_id": 7001768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34e52b9c753891fdda481d2c39dbfcbc?s=128&d=identicon&r=PG&f=1", "display_name": "carole1", "link": "https://stackoverflow.com/users/7001768/carole1"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1481747526, "post_id": 41150748, "comment_id": 69505444, "body": "@JohnColeman I&#39;m not sure how to do that. How do I make an asynchronous VBScript?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1481748352, "post_id": 41150748, "comment_id": 69505878, "body": "You actually don&#39;t need to package the VBScript separately if you go that route (you can generate it at runtime).  There&#39;s an example of something similar to what @JohnColeman was referring to <a href=\"http://stackoverflow.com/a/29869308/4088852\">in this answer</a>."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 1, "creation_date": 1481750205, "post_id": 41150748, "comment_id": 69506830, "body": "Actually, the internetexplorer object has a set of events that get triggered. I&#39;d add a class module that handles the call to IE and responds to its events. That way the call becomes asynchronous all by itself. You do have to use early binding then however. The NavigateComplete2 event sounds most promising."}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 7297934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f43da431a6c08b442bfb5eb10169afc5?s=128&d=identicon&r=PG&f=1", "display_name": "jerryact", "link": "https://stackoverflow.com/users/7297934/jerryact"}, "is_accepted": true, "score": 3, "last_activity_date": 1481750908, "creation_date": 1481750908, "answer_id": 41152479, "question_id": 41150748, "link": "https://stackoverflow.com/questions/41150748/excel-add-in-when-to-check-for-updates/41152479#41152479", "title": "Excel Add-in, when to check for updates?", "body": "<p>Ok, I ran your code and reproduced the issue, with Excel 2013. I didn't test on any other version.</p>\n\n<p>It looks like what happens is if your code runs before a workbook is visible, it causes problems. I think it has more to do with the IE part, than anything else.</p>\n\n<p>I tried using <code>Application.OnTime Now + TimeValue(\"00:00:15\"), \"CheckForUpdate\"</code>. The problem with that is that if the user starts excel and out waits the timer before opening a workbook, you have exactly the same problem. I suspect the persons suggesting asynchronous VBScript will have exactly the same issue, but in a much more complicated way.</p>\n\n<p>So let's go simple. You asked for a better place to put your code than <code>Workbook_Open()</code>. There is one.</p>\n\n<p>Here's what worked for me:</p>\n\n<p>Start a new add-in project. Add your <code>CheckForUpdates</code> function to a new module. Add the following code to <code>ThisWorkbook</code>.</p>\n\n<pre><code>Private WithEvents App As Application\n\nPrivate Sub App_WorkbookActivate(ByVal Wb As Workbook)\n    CheckForUpdate\nEnd Sub\n\nPrivate Sub Workbook_Open()\n    Set App = Application\nEnd Sub\n</code></pre>\n\n<p>With this code, your update procedure will run when a workbook is activated. It appears to not cause problems there.</p>\n\n<p>Please let me know if that works. Good luck.</p>\n"}], "owner": {"reputation": 45, "user_id": 7001768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34e52b9c753891fdda481d2c39dbfcbc?s=128&d=identicon&r=PG&f=1", "display_name": "carole1", "link": "https://stackoverflow.com/users/7001768/carole1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 1, "accepted_answer_id": 41152479, "answer_count": 1, "score": 1, "last_activity_date": 1481750908, "creation_date": 1481744092, "last_edit_date": 1531161705, "question_id": 41150748, "link": "https://stackoverflow.com/questions/41150748/excel-add-in-when-to-check-for-updates", "title": "Excel Add-in, when to check for updates?", "body": "<p>I've made a useful Excel VBA add-in that I'm almost ready to publish. I only have one problem. I want the add-in to check for updates whenever it is ran, and to notify the user if they're using an old version.</p>\n\n<p>I have written a public sub that will check my website for the update using internet explorer automation. It is working fine when I run it manually.</p>\n\n<p>My issue is, when should I call the <code>CheckForUpdate()</code> sub? I've tried putting it in <code>Workbook_Open()</code>, but the issue I've found is that if it takes too long, it blocks Excel from loading properly.</p>\n\n<p>Is there a standard way that add-in writers check for updates? Why does Excel not load up a workbook when I have code in <code>Workbook_Open()</code>?</p>\n\n<p>Thanks!</p>\n\n<p><strong>Edit</strong>: Here is my entire code. If this is added to an add-in workbook, and then the add-in is activated, I can't open any Excel files.</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Call CheckForUpdate\nEnd Sub\n\nPublic Sub CheckForUpdate()\n    Dim ie As Object\n    Set ie = CreateObject(\"internetexplorer.application\")\n    ie.Visible = False\n    ie.navigate \"https://example.com/checkforupdate\"\n\n    Do While ie.readystate &lt;&gt; 4: DoEvents: Loop\n\n    Set HTML = ie.document\n    If HTML.DocumentElement.innerHTML = \"update is available\" Then\n        MsgBox \"An update is ready. Go get it!\"\n    Else\n        MsgBox \"no update\"\n    End If\n\n    Set ie = Nothing\nEnd Sub\n</code></pre>\n\n<p><strong>Update</strong>: I've tested on three computers now. 2 of them have Excel 2013 and the problem happens. One has Excel 2016 and it doesn't have the problem. I want to support all Excel versions, so I still need a work around.</p>\n"}, {"tags": ["sql", "database", "vba", "select", "insert-into"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1481753608, "post_id": 41150573, "comment_id": 69508287, "body": "Try getting the string from <code>strSQL</code>, copy it and use it to run a query in the Access GUI.  It will often give better error messages."}, {"owner": {"reputation": 11, "user_id": 7287614, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211669500523774/picture?type=large", "display_name": "X Y", "link": "https://stackoverflow.com/users/7287614/x-y"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1481754868, "post_id": 41150573, "comment_id": 69508737, "body": "Solved, was a typo. <code>WHERE PurchaseOrder.PurchaseOrder_ID =..</code>"}], "owner": {"reputation": 11, "user_id": 7287614, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211669500523774/picture?type=large", "display_name": "X Y", "link": "https://stackoverflow.com/users/7287614/x-y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 251, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1481743449, "creation_date": 1481743449, "question_id": 41150573, "link": "https://stackoverflow.com/questions/41150573/sql-vba-insert-into-select-statement-data-from-2-or-more-tables-into-one", "title": "SQL/VBA INSERT INTO SELECT Statement, Data from 2 or more tables into one", "body": "<ul>\n<li><p>I have a table1 (<strong>tblPurchaseOrders</strong>) and a table2\n(<strong>tblPurchaseOrderDetails</strong>).</p></li>\n<li><p>The table 1 contains <strong>PurchaseOrder_ID</strong>, Supplier_FK, Employee_FK,\n<strong>Status</strong>  which contains 2 records (New and Done). The table2 contains PurchaseOrder_FK, <strong>Product_FK</strong>, <strong>Quantity</strong> and Price.</p></li>\n<li>I made a Form (from table1) and a sub-form in it (from table 2). The\nMain form is the Purchase Order (frmPurchaseOrder) and the sub-form\n(frmPurchaseOrderDetails) contains all the products purchased with\nthat purchase order,</li>\n</ul>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>tblPurchaseOrder.PurchaseOrder_ID = tblPurchaseOrderDetails.PurchaseOrder_FK</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<ul>\n<li><p>I want to take PurchaseOrder_ID and Status from table1, Product_FK\nand Quantity from table 2 and put all the records into a table3\ntblStockMovements. Not just one record but all of them with the\nstatement above. So when I open the main Form, lets say the\nPurchaseOrder_ID is \"10\" and the Status is \"Done\" and in the sub-form\nthere are 2 records:</p>\n\n<ol>\n<li>record 1) Product_FK \"Nokia N8\", Quantity \"10\";</li>\n<li>record 2) Product_FK \"Samsung S3\", Quantity \"20\".</li>\n</ol></li>\n<li><p>There will be a button in the form which will run the code on click\nand move the above records to tblStockMovements. After clicking the\nbutton the tblStockMovements will look like on the picture</p>\n\n<p><a href=\"https://i.stack.imgur.com/BJd16.png\" rel=\"nofollow noreferrer\">tblStockMovements after button click in main form</a></p></li>\n</ul>\n\n<p>The code I tried is next:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>Private Sub cmdOrder_Click()\r\n \r\n    Dim strSQL As String\r\n \r\n    strSQL = \"\"\r\n    strSQL = strSQL &amp; \"INSERT INTO tblStockMovement ( \"\r\n    strSQL = strSQL &amp; \"  Product_FK \"\r\n    strSQL = strSQL &amp; \", Status \"\r\n    strSQL = strSQL &amp; \", Quantity \"\r\n    strSQL = strSQL &amp; \", PurchaseOrder_FK \"\r\n    strSQL = strSQL &amp; \") SELECT \"\r\n    strSQL = strSQL &amp; \"  tblPurchaseOrderDetails.Product_FK \"\r\n    strSQL = strSQL &amp; \", tblPurchaseOrder.Status \"\r\n    strSQL = strSQL &amp; \", tblPurchaseOrderDetails.Quantity \"\r\n    strSQL = strSQL &amp; \", tblPurchaseOrder.PurchaseOrder_ID \"\r\n    strSQL = strSQL &amp; \"FROM tblPurchaseOrder \"\r\n    strSQL = strSQL &amp; \"LEFT JOIN tblPurchaseOrderDetails \"\r\n    strSQL = strSQL &amp; \"ON tblPurchaseOrder.PurchaseOrder_ID= tblPurchaseOrderDetails.PurchaseOrder_FK \"\r\n    strSQL = strSQL &amp; \"WHERE PurchaseOrder_ID=\" &amp; Me!PurchaseOrder_ID\r\n \r\n    CurrentDB.Execute strSQL, dbFailOnError + dbSeeChanges\r\n    Me.Requery\r\n \r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<ul>\n<li>When I run it I get the error \"get the same error \"Syntax error in\nFROM clause (3131)\" . I tried to add [PurchaseOrdersDetails] in the\nFROM code line but then I get the syntax error in JOIN operation\n(3135)</li>\n</ul>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 1, "creation_date": 1481743468, "post_id": 41150476, "comment_id": 69503314, "body": "You an use the Left function:  Left(.Attachments.Item(1).DisplayName, Len(.Attachments.Item(1).DisplayName) - 4)"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 1, "creation_date": 1481744029, "post_id": 41150476, "comment_id": 69503589, "body": "if the extension may be more than 4 characters then you could use InStr to get the location of the period:  Left(.Attachments.Item(1).DisplayName, InStr(1, .Attachments.Item(1).DisplayName, &quot;.&quot;) - 1)"}, {"owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1481744566, "post_id": 41150476, "comment_id": 69503858, "body": "It just depends on the extension. Most the time I feel like the extension is 4 characters (including the period, like &quot;.pdf&quot;). Other times it may be 5-7 characters long."}], "answers": [{"comments": [{"owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1482512110, "post_id": 41152934, "comment_id": 69812927, "body": "I&#39;m curious, if I wanted to move keep this existing functionality, but also now add the attachment name into the body of the email, how would I do that?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "reply_to_user": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1482876342, "post_id": 41152934, "comment_id": 69907415, "body": "You can use <code>.Body</code> or <code>.HTMLBody</code> if it&#39;s an mail item. Most item types has the <code>.Body</code> that you can manipulate."}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 1, "last_activity_date": 1481752657, "creation_date": 1481752657, "answer_id": 41152934, "question_id": 41150476, "link": "https://stackoverflow.com/questions/41150476/removing-part-of-text-using-vba-outlook-2010/41152934#41152934", "title": "Removing part of text using VBA (Outlook 2010)", "body": "<p>Perhaps this is more simpler (drops anything from the last period).</p>\n\n<pre><code>Function DropExtension(sName As String) As String\n    If InStr(1, sName, \".\", vbTextCompare) = 0 Then\n        DropExtension = sName ' No file extension\n    Else\n        DropExtension = Left(sName, InStrRev(sName, \".\") - 1)\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481752657, "creation_date": 1481743110, "question_id": 41150476, "link": "https://stackoverflow.com/questions/41150476/removing-part-of-text-using-vba-outlook-2010", "title": "Removing part of text using VBA (Outlook 2010)", "body": "<p>I currently use a macro in Outlook that takes the attachment name and uses that as the Subject.</p>\n\n<p>The macro is:</p>\n\n<pre><code>Sub AttachmentNameAsSubject()\n\nDim AttachmentName As String\nDim currItem As Object\n\nSet currItem = ActiveInspector.CurrentItem\n\nWith currItem\n    If .Attachments.Count &gt; 0 Then\n        AttachmentName = .Attachments.Item(1).DisplayName\n        .Subject = AttachmentName\n    End If\n\nEnd With\nEnd Sub\n</code></pre>\n\n<p>The attachment is typically some kind of .pdf or .xls file, so if the attachment is: \"MyAttachment.pdf\", the subject line will read \"MyAttachment.pdf\".</p>\n\n<p>Is there a way to remove any text after the period in the subject line so that the Subject line simply reads \"MyAttachment\", and does not include the \".pdf\" or whatever the extension may be.</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1481741784, "post_id": 41150052, "comment_id": 69502440, "body": "Change <code>PasteSelection.</code> to <code>Selection</code>.  but you should learn to avoid using Select see: <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\" title=\"how to avoid using select in excel vba macros\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1481741900, "post_id": 41150052, "comment_id": 69502505, "body": "Also you can do this as one row inside the IF: <code>ActiveSheet.Range(&quot;A5&quot; &amp; lastRow).Offset(1, 0).Value = ActiveSheet.Range(&quot;A5&quot; &amp; lastRow).Value</code> and avoid the clipboard."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1481742919, "post_id": 41150052, "comment_id": 69503032, "body": "Why did you remove your code?"}, {"owner": {"reputation": 3, "user_id": 6533936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131418812dec4e24dc54c33f7a6b7e41?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/6533936/ben"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481743136, "post_id": 41150052, "comment_id": 69503153, "body": "@YowE3K it wasn&#39;t functional and I thought it might confuse readers of the purpose. I will put it back up."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481743207, "post_id": 41150052, "comment_id": 69503188, "body": "The whole purpose (I think) of SO is to turn non-functional code into something that works.  Without code showing, the question will be down-voted into oblivion."}, {"owner": {"reputation": 3, "user_id": 6533936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131418812dec4e24dc54c33f7a6b7e41?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/6533936/ben"}, "edited": false, "score": 0, "creation_date": 1481743343, "post_id": 41150052, "comment_id": 69503248, "body": "It is back up. Appreciate your answer all considered."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481743505, "post_id": 41150052, "comment_id": 69503344, "body": "I edited the question and rolled it back to Scott&#39;s earlier edit, so that the code is formatted nicely."}], "answers": [{"tags": [], "owner": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "is_accepted": false, "score": 0, "last_activity_date": 1481742520, "creation_date": 1481742520, "answer_id": 41150300, "question_id": 41150052, "link": "https://stackoverflow.com/questions/41150052/copy-a-range-and-shift-it-down-one-row-on-the-same-sheet/41150300#41150300", "title": "Copy a range and shift it down one row on the same sheet", "body": "<p><code>Set rng = ActiveSheet.Range(\"A1\").Value</code> ???</p>\n\n<p>if rng is a range, then replace it by : </p>\n\n<pre><code>Set rng = ActiveSheet.Range(\"A1\")\n</code></pre>\n\n<p>or if rng is a variable, replace </p>\n\n<pre><code>Dim rng As Range\n</code></pre>\n\n<p>by</p>\n\n<pre><code>Dim rng As variant\nrng = ActiveSheet.Range(\"A1\").Value\n</code></pre>\n\n<p>another error :</p>\n\n<p>you declared rng as range and then you test if it is > 0</p>\n\n<pre><code>If rng &gt; 0 Then ...\n</code></pre>\n\n<p>it is not possible</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 6533936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131418812dec4e24dc54c33f7a6b7e41?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/6533936/ben"}, "edited": false, "score": 0, "creation_date": 1481743950, "post_id": 41150460, "comment_id": 69503552, "body": "Thanks again for your response. The code you provided is moving the data in column A down one row, however, I would need the entire range A5:AZ1000 (last row and column with data) to move down as the macro is clicked and the user may begin to enter new data in row A5:A5. Does this clear the question up for you?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 3, "user_id": 6533936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131418812dec4e24dc54c33f7a6b7e41?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/6533936/ben"}, "edited": false, "score": 0, "creation_date": 1481744237, "post_id": 41150460, "comment_id": 69503696, "body": "@ben - Hmmm - for my testing I had data up to column L on row 4 (the one being used to test how many columns to copy) and it moved A5:L21 down to A6:L22.  Does your AZ4 contain anything?"}, {"owner": {"reputation": 3, "user_id": 6533936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131418812dec4e24dc54c33f7a6b7e41?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/6533936/ben"}, "edited": false, "score": 0, "creation_date": 1481744758, "post_id": 41150460, "comment_id": 69503958, "body": "it seems to be working just fine now! My mistake, the validation I had somehow disappeared. Thanks again."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1481743072, "creation_date": 1481743072, "answer_id": 41150460, "question_id": 41150052, "link": "https://stackoverflow.com/questions/41150052/copy-a-range-and-shift-it-down-one-row-on-the-same-sheet/41150460#41150460", "title": "Copy a range and shift it down one row on the same sheet", "body": "<p>Normally I wouldn't answer if the question doesn't include any code to show effort, but I started writing the below while the question actually <strong>did</strong> show code so I may as well provide it.  It may achieve what you are after.</p>\n\n<pre><code>Sub shiftdown()\n' shiftdown Macro\n    Dim rng As Range\n    With ActiveSheet\n        If .Range(\"A1\").Value &gt; 0 Then\n\n            Set rng = .Range(.Cells(5, 1), _\n                             .Cells(.Cells(.Rows.Count, 1).End(xlUp).Row, _\n                                    .Cells(4, .Columns.Count).End(xlToLeft).Column))\n            rng.Offset(1, 0).Value = rng.Value\n            .Rows(5).EntireRow.ClearContents\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6533936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131418812dec4e24dc54c33f7a6b7e41?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/6533936/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2118, "favorite_count": 0, "accepted_answer_id": 41150460, "answer_count": 2, "score": -1, "last_activity_date": 1481743424, "creation_date": 1481741617, "last_edit_date": 1481743424, "question_id": 41150052, "link": "https://stackoverflow.com/questions/41150052/copy-a-range-and-shift-it-down-one-row-on-the-same-sheet", "title": "Copy a range and shift it down one row on the same sheet", "body": "<p>I am fairly new in excel VBA and would really appreciate any help on this matter.</p>\n\n<p>The workbook includes data from range A5:AZ1000 (new client info is inputted in new rows, but some cells may be empty depending on the nature of the case). When a user inputs new client info (begins a new row) I would like the existing data (range A5:AZ1000) to shift down one row, and a blank row to appear in range A5:AZ:5. I would like users to be able to click a macro \"New Client\" for this to happen. </p>\n\n<p>It should be noted that this is a shared workbook and therefore I cannot have macro that adds a new row.</p>\n\n<p>Here is the code I'm working with:</p>\n\n<pre><code>Sub shiftdown()\n' shiftdown Macro\nDim lastRow As Long\nDim lastColumn As Long\nDim rngToCopy As Range\nDim rng As Range\nSet rng = ActiveSheet.Range(\"A1\").Value\nlastColumn = ActiveSheet.Cells(4, Columns.Count).End(xlToLeft).Column\nlastRow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nIf rng &gt; 0 Then\n     ActiveSheet.Range(\"A5\" &amp; lastRow).Select\n     Selection.Copy\n     PasteSelection.Offset(1, 0).PasteSpecial xlPasteValues\n     'Error Object Required\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 676, "user_id": 1611925, "user_type": "registered", "accept_rate": 15, "profile_image": "https://i.stack.imgur.com/VVlis.jpg?s=128&g=1", "display_name": "Julien Lamarche", "link": "https://stackoverflow.com/users/1611925/julien-lamarche"}, "is_accepted": false, "score": 3, "last_activity_date": 1481738876, "last_edit_date": 1481738876, "creation_date": 1481738517, "answer_id": 41149179, "question_id": 41149178, "link": "https://stackoverflow.com/questions/41149178/how-to-query-the-database-from-the-vba-console/41149179#41149179", "title": "How to query the database from the VBA console?", "body": "<p>This worked for me with a query that return integers:</p>\n\n<pre><code>Public Sub runQuery(ByVal query As String)\n\n    Dim DB As DAO.Database: Set DB = CurrentDb()\n    Dim rst As DAO.Recordset: Set rst = DB.OpenRecordset(query)\n\n    Do While Not rst.EOF\n        Dim rowStr As String: rowStr = \"\"\n        Dim fld As Field\n        For Each fld In rst.Fields\n            rowStr = rowStr &amp; fld &amp; \"    \"\n        Next fld\n\n        Debug.Print (rowStr)\n\n        rst.MoveNext\n\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>Then call it from the immediate window:</p>\n\n<pre><code>runQuery \"SELECT Foo, Bar FROM MyTable WHERE Foo &lt; 42\"\n</code></pre>\n"}], "owner": {"reputation": 676, "user_id": 1611925, "user_type": "registered", "accept_rate": 15, "profile_image": "https://i.stack.imgur.com/VVlis.jpg?s=128&g=1", "display_name": "Julien Lamarche", "link": "https://stackoverflow.com/users/1611925/julien-lamarche"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594640838, "creation_date": 1481738517, "last_edit_date": 1594640838, "question_id": 41149178, "link": "https://stackoverflow.com/questions/41149178/how-to-query-the-database-from-the-vba-console", "title": "How to query the database from the VBA console?", "body": "<p>Any way I can run a select query within the immediate console of VBA Access 2010 (VBA 7.0)?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1481738133, "post_id": 41149029, "comment_id": 69500514, "body": "If your sheet is protected (whether or not there&#39;s a password makes no real difference here) and the cell is locked then you will need to unprotect before making any changes from code, unless you protected in VBA using the <code>UserInterfaceOnly</code> argument."}, {"owner": {"reputation": 97, "user_id": 4934785, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf4026ca29a3a238d6d38e538fc0d05b?s=128&d=identicon&r=PG&f=1", "display_name": "geddeca", "link": "https://stackoverflow.com/users/4934785/geddeca"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1481750283, "post_id": 41149029, "comment_id": 69506864, "body": "am not sure that I explained correctly what I want. I want the field D6 locked because it isn&#39;t a field that the user should enter anything into. My vba code fills it in from the other cell entries. The problem is, that once I protect the page and then give it to the user the calculations don&#39;t autopopulate into D6. It stays at $0. I actually don&#39;t know why I should protect the sheet at all Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 4934785, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf4026ca29a3a238d6d38e538fc0d05b?s=128&d=identicon&r=PG&f=1", "display_name": "geddeca", "link": "https://stackoverflow.com/users/4934785/geddeca"}, "edited": false, "score": 0, "creation_date": 1481748849, "post_id": 41151553, "comment_id": 69506144, "body": "I don&#39;t know if what you wrote is for me. Where do you place that code? in a Module? I am not sure that I explained correctly what I want. I want the field D6 locked because it isn&#39;t a field that the user should enter anything into. My vba code fills it in from the other cell entries. The problem is, that once I protect the page and then give it to the user the calculations don&#39;t autopopulate into D6. It stays at $0. I actually don&#39;t know why I should protect the sheet at all."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 97, "user_id": 4934785, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf4026ca29a3a238d6d38e538fc0d05b?s=128&d=identicon&r=PG&f=1", "display_name": "geddeca", "link": "https://stackoverflow.com/users/4934785/geddeca"}, "edited": false, "score": 0, "creation_date": 1481750538, "post_id": 41151553, "comment_id": 69506970, "body": "ok, I edited the answer. KEEP IN MIND that you have to make sure cell D6 is locked. To do that right click on cell D6 &gt; Format Cell &gt; Protection and checkmark should be there for Locked. To do this, your sheet must be unprotected"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1481750875, "post_id": 41151553, "comment_id": 69507134, "body": "If the sheet being updated is &quot;Loading&quot; then you can use (e.g.) <code>Me.Unprotect</code> instead of hard-coding in the sheet name.  In a Worksheet code module, <code>Me</code> refers to the associated worksheet."}, {"owner": {"reputation": 97, "user_id": 4934785, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf4026ca29a3a238d6d38e538fc0d05b?s=128&d=identicon&r=PG&f=1", "display_name": "geddeca", "link": "https://stackoverflow.com/users/4934785/geddeca"}, "edited": false, "score": 0, "creation_date": 1481752231, "post_id": 41151553, "comment_id": 69507732, "body": "Thank you Tim Williams. I used Me.Protect/Unprotect. It worked perfectly. Now I don&#39;t have to leave it unlock and trust the user not to enter anything. Very useful tidbit of code for me. Just new to this. Bit off a big chunk to chew and finally got the worksheets done. Thank you."}], "tags": [], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "is_accepted": true, "score": 0, "last_activity_date": 1481750450, "last_edit_date": 1481750450, "creation_date": 1481747146, "answer_id": 41151553, "question_id": 41149029, "link": "https://stackoverflow.com/questions/41149029/protected-sheet-cell-locked-wont-accept-vba-code/41151553#41151553", "title": "Protected Sheet, Cell locked, won&#39;t accept VBA code", "body": "<p>You have a worksheet change event that may change the value of cell D6.  To change the value of D6, if the cell is locked, then VBA needs to have it unprotected first. Now that you are saying you want D6 to be always protected, do this:</p>\n\n<pre><code> Case \"$D$4\"\n    'unprotect sheet\n    Worksheets(\"Loading\").Unprotect\n\n   'Recalculate Downpayment D5 if Purchase Price is changed\n\n   range(\"D5\").Value = (range(\"D4\").Value * range(\"B5\").Value) / 100\n   Debug.Print \"New value for D5 Downpayment \"; range(\"D5\").Value\n   range(\"D6\").Value = (range(\"D4\").Value - range(\"D5\").Value) \n   Debug.Print \"D6 New Mortgage \" &amp; range(\"D6\").Value\n\n  'protect the sheet back\n   Worksheets(\"Loading\").Protect\n</code></pre>\n\n<p>Please hit the check mark if this answered your question.</p>\n"}], "owner": {"reputation": 97, "user_id": 4934785, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf4026ca29a3a238d6d38e538fc0d05b?s=128&d=identicon&r=PG&f=1", "display_name": "geddeca", "link": "https://stackoverflow.com/users/4934785/geddeca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1257, "favorite_count": 0, "accepted_answer_id": 41151553, "answer_count": 1, "score": 0, "last_activity_date": 1481750450, "creation_date": 1481737919, "last_edit_date": 1481744114, "question_id": 41149029, "link": "https://stackoverflow.com/questions/41149029/protected-sheet-cell-locked-wont-accept-vba-code", "title": "Protected Sheet, Cell locked, won&#39;t accept VBA code", "body": "<p>I have a protected sheet WITH NO PASSWORD, cell D6 Locked. VBA code for that cell won't run.</p>\n\n<p>I have read some posts here. This came as a solution to a similar problem. Not sure how to use it or where to put it. As stated I don't have a password on it.</p>\n\n<pre><code>Worksheets(\"Loading\").Protect Password:=****, UserInterfaceOnly:=True\n\nPrivate Sub Worksheet_Change(ByVal Target As range)\n\nApplication.EnableEvents = False '&lt;--| disable events handling\nOn Error GoTo ErrorHandler '&lt;--| be sure to catch any error and enable events handling back\n\nSelect Case Target.Address\n\n    Case \"$D$4\"\n       'Recalculate Downpayment D5 if Purchase Price is changed\n\n       range(\"D5\").Value = (range(\"D4\").Value * range(\"B5\").Value) / 100\n       Debug.Print \"New value for D5 Downpayment \"; range(\"D5\").Value\n       range(\"D6\").Value = (range(\"D4\").Value - range(\"D5\").Value) ' This cell won't activate when locked and sheet protected\n       Debug.Print \"D6 New Mortgage \" &amp; range(\"D6\").Value\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/B0yxm.jpg\" alt=\"Cells\"></p>\n"}, {"tags": ["excel", "vba", "pdf", "macros"], "answers": [{"tags": [], "owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "is_accepted": false, "score": 0, "last_activity_date": 1481737235, "creation_date": 1481737235, "answer_id": 41148840, "question_id": 41148773, "link": "https://stackoverflow.com/questions/41148773/change-existing-macro-to-print-to-pdf-instead/41148840#41148840", "title": "Change Existing Macro to Print to PDF instead", "body": "<p>You can just save as PDF depending on the version of Excel you are using.</p>\n\n<pre><code>ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n    \"C:\\Users\\sample\\Documents\\mySheet.pdf\", Quality:= _\n    xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, _\n    OpenAfterPublish:=False\n</code></pre>\n\n<p>Whereby <code>C:\\Users..</code> is the path and file name where you wish to save.</p>\n"}], "owner": {"reputation": 1, "user_id": 7298020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8df3593f6715909b4d42c610be88625e?s=128&d=identicon&r=PG&f=1", "display_name": "Abraham Gleason", "link": "https://stackoverflow.com/users/7298020/abraham-gleason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 336, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481737235, "creation_date": 1481736987, "question_id": 41148773, "link": "https://stackoverflow.com/questions/41148773/change-existing-macro-to-print-to-pdf-instead", "title": "Change Existing Macro to Print to PDF instead", "body": "<p>I am new to VBA and do not know how to accomplish what I would like.</p>\n\n<p>Can someone tell me how to make the below macro print to PDF instead of the default printer?</p>\n\n<pre><code>Sub PRINTMULTIPACKS()\n'\n' PRINTMULTIPACKS Macro\n'\n\n'\nActiveSheet.Unprotect\nActiveSheet.Range(\"$C$13:$D$22\").AutoFilter Field:=1, Criteria1:=\"&lt;&gt;\"\nSheets(\"EXPORT TO VENDOR MULTIPLE AREAS\").Select\nActiveSheet.Unprotect\nActiveSheet.Range(\"$A$11:$AD$261\").AutoFilter Field:=3, Criteria1:=\"&lt;&gt;\"\nSheets(\"FIXTURE SCHEDULE\").Select\nActiveSheet.Unprotect\nActiveSheet.Range(\"$A$4:$S$874\").AutoFilter Field:=17, Criteria1:=\"&lt;&gt;\"\n\nSheets(\"COVER MULTIPLE AREAS\").Select\nRange(\"D10\").Select\nSheets(Array(\"COVER MULTIPLE AREAS\", \"EXPORT TO VENDOR MULTIPLE AREAS\")).Select\nSheets(\"COVER MULTIPLE AREAS\").Activate\nExecuteExcel4Macro \"PRINT(1,,,1,,,,,,,,2,,,TRUE,,FALSE)\"\nSheets(\"FIXTURE SCHEDULE\").Select\nActiveSheet.Range(\"$A$4:$S$874\").AutoFilter Field:=17\nActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _\n    , AllowFiltering:=True\n\nSheets(\"EXPORT TO VENDOR MULTIPLE AREAS\").Select\nActiveSheet.Range(\"$A$11:$AD$261\").AutoFilter Field:=3\nActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _\n    , AllowFiltering:=True\nSheets(\"COVER MULTIPLE AREAS\").Select\nActiveSheet.Range(\"$C$13:$D$22\").AutoFilter Field:=1\nActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _\n    , AllowFiltering:=True\nRange(\"C10\").Select\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "vba", "macros"], "comments": [{"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1481737030, "post_id": 41148585, "comment_id": 69499948, "body": "Yes thats exactly what you need to get the last modified date of the file you pull from. But without any code no idea how this will fit with what you&#39;re already doing. <code>FileDateTime(&quot;C:\\Example.xls&quot;)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4282809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LGx6X.png?s=128&g=1", "display_name": "Nexter1", "link": "https://stackoverflow.com/users/4282809/nexter1"}, "edited": false, "score": 0, "creation_date": 1481743106, "post_id": 41148802, "comment_id": 69503130, "body": "Hi A.S.H. thanks for your response!  Sorry, I&#39;m a little new to VBA/Macros, where in the code would I put the specific cell that I would like the information to print into?  (sorry if that&#39;s a stupid question)    Also, when I try to run it, it says, Compile error: User-defined type not defined, and it highlights : &quot;fso As FileSystemObject&quot;"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 3, "user_id": 4282809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LGx6X.png?s=128&g=1", "display_name": "Nexter1", "link": "https://stackoverflow.com/users/4282809/nexter1"}, "edited": false, "score": 0, "creation_date": 1481745511, "post_id": 41148802, "comment_id": 69504425, "body": "you should add a reference to the VBA project: <code>Tools-&gt;References-&gt;Check Microsoft Scripting Runtime</code>. Then to write the file&#39;s name to a cell, for example in cell A1: <code>Range(&quot;A1&quot;).Value = f.DateLastModified</code>"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 0, "last_activity_date": 1481745556, "last_edit_date": 1481745556, "creation_date": 1481737109, "answer_id": 41148802, "question_id": 41148585, "link": "https://stackoverflow.com/questions/41148585/showing-date-modified-of-a-separate-excel-document-in-a-cell/41148802#41148802", "title": "Showing date modified of a separate excel document in a cell", "body": "<pre><code>Dim fso As FileSystemObject, f As File '&lt;-- reference: Microsoft Scripting Runtime\nSet fso = New FileSystemObject\nSet f = fso.GetFile(mySourceWorkbook.FullName)\n\nDebug.Print f.DateCreated f.DateLastAccessed f.DateLastModified\n' And you can get much more information about the file\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4282809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LGx6X.png?s=128&g=1", "display_name": "Nexter1", "link": "https://stackoverflow.com/users/4282809/nexter1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 41148802, "answer_count": 1, "score": 0, "last_activity_date": 1481745556, "creation_date": 1481736241, "question_id": 41148585, "link": "https://stackoverflow.com/questions/41148585/showing-date-modified-of-a-separate-excel-document-in-a-cell", "title": "Showing date modified of a separate excel document in a cell", "body": "<p>I have an excel that is pulling data from another excel via a simple range copy formula, however I was wondering if it is possible to also pull the date &amp; time that the source excel was last modified and put it into a cell in the target excel.  </p>\n\n<p>Through research, I found out about the FILEDATETIME function, however I'm not sure if this would work for what I'm trying to do.</p>\n\n<p>Any help would be super appreciated!  Thank you so much!!</p>\n"}, {"tags": ["excel", "excel-addins", "vba"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1481736109, "post_id": 41148376, "comment_id": 69499405, "body": "Read the documentation: <a href=\"https://msdn.microsoft.com/en-us/library/bb687915.aspx\" rel=\"nofollow noreferrer\">How to: Access DLLs in Excel</a>"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 1, "creation_date": 1481737938, "post_id": 41148376, "comment_id": 69500410, "body": "I suggest you to try with <a href=\"http://exceldna.codeplex.com/wikipage?title=Getting%20Started\" rel=\"nofollow noreferrer\">Excel-DNA</a> instead"}], "owner": {"reputation": 111, "user_id": 7297934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f43da431a6c08b442bfb5eb10169afc5?s=128&d=identicon&r=PG&f=1", "display_name": "jerryact", "link": "https://stackoverflow.com/users/7297934/jerryact"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 876, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1481735543, "creation_date": 1481735543, "last_edit_date": 1531161705, "question_id": 41148376, "link": "https://stackoverflow.com/questions/41148376/how-to-call-dll-function-returing-string-from-excel-vba", "title": "How to call DLL function returing string from Excel VBA?", "body": "<p>I have a compiled DLL coded in C that exports this function:</p>\n\n<pre><code>__stdcall const char *GetVersion() {\n    return \"1.0.2\";\n}\n</code></pre>\n\n<p>I'm trying to call that function from Excel VBA. I've declared it as follows:</p>\n\n<pre><code>Private Declare PtrSafe Function GetVersion Lib \"example64.dll\" () As String\n</code></pre>\n\n<p>But when I try to call it:</p>\n\n<pre><code>Debug.Print(GetVersion())\n</code></pre>\n\n<p>Excel crashes.</p>\n\n<p>I have several other functions working fine that return numbers and such. It's just this one that returns a constant string that is giving me fits. How do I get this to work?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["sql-server", "excel", "stored-procedures", "oledbconnection", "vba"], "comments": [{"owner": {"reputation": 8287, "user_id": 3611669, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f87a44fc3ba9cfb0975908cba210dc30?s=128&d=identicon&r=PG&f=1", "display_name": "GuidoG", "link": "https://stackoverflow.com/users/3611669/guidog"}, "edited": false, "score": 1, "creation_date": 1481734790, "post_id": 41148093, "comment_id": 69498594, "body": "set nocount on must be the first line of code in the stored procedure, not in the vba code"}, {"owner": {"reputation": 9, "user_id": 6727687, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061306837251809/picture?type=large", "display_name": "Nancy Wilson", "link": "https://stackoverflow.com/users/6727687/nancy-wilson"}, "reply_to_user": {"reputation": 8287, "user_id": 3611669, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f87a44fc3ba9cfb0975908cba210dc30?s=128&d=identicon&r=PG&f=1", "display_name": "GuidoG", "link": "https://stackoverflow.com/users/3611669/guidog"}, "edited": false, "score": 0, "creation_date": 1481737882, "post_id": 41148093, "comment_id": 69500381, "body": "Still getting same error."}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 6727687, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061306837251809/picture?type=large", "display_name": "Nancy Wilson", "link": "https://stackoverflow.com/users/6727687/nancy-wilson"}, "is_accepted": false, "score": 0, "last_activity_date": 1481739101, "creation_date": 1481739101, "answer_id": 41149318, "question_id": 41148093, "link": "https://stackoverflow.com/questions/41148093/excel-vba-call-to-sql-stored-procedure-returning-bogus-connection-error/41149318#41149318", "title": "Excel VBA Call to SQL Stored Procedure Returning Bogus Connection Error", "body": "<p>Figured it out... after two+ entire days spent paining over this!  </p>\n\n<p>Changed the CommandText to match the stored procedure:</p>\n\n<pre><code>    .CommandText = \"Declare @return_Value int EXEC @return_Value = DCSTransfer.dbo.InsertTags '\" &amp; Parm1 &amp; \"', '\" &amp; Parm2 &amp; \"', \" &amp; Parm3 &amp; \"SELECT 'Return Value' = @return_value\"\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6727687, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061306837251809/picture?type=large", "display_name": "Nancy Wilson", "link": "https://stackoverflow.com/users/6727687/nancy-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 456, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507152218, "creation_date": 1481734597, "last_edit_date": 1531161705, "question_id": 41148093, "link": "https://stackoverflow.com/questions/41148093/excel-vba-call-to-sql-stored-procedure-returning-bogus-connection-error", "title": "Excel VBA Call to SQL Stored Procedure Returning Bogus Connection Error", "body": "<p>I am working on a script to loop through an excel sheet, pass parameters to an SQL Server procedure that takes three parms and generates records based on the parms.  When I make the call, it actually does pass the parameters correctly, executes the procedure and writes the records, but then I get a runtime error \"1004 The query did not run...\"   </p>\n\n<p>I've found comments that state to change Background Query = False - check.  Set NoCount On - check...  still getting the error.</p>\n\n<p>The SQL Server procedure does include a ReturnValue parm (1/0), which I am not passing, because it states \"Too Many Parameters\" when I try to do that. Is that possibly the problem?  Not sure how to receive back a return value. </p>\n\n<p>Here is my VBA Code:</p>\n\n<pre><code>Sub CallProc()\n    Dim ws As Worksheet\n    Worksheets(\"AllTags\").Activate\n\n    Dim Parm1 As String\n    Dim Parm2 As String\n    Dim Parm3 As Integer\n    Dim RowIndex As Long\n    Dim ReturnValue As Integer\n\n    RowIndex = 2\n\n   Do While Sheets(\"AllTags\").Cells(RowIndex, 2).Value &lt;&gt; \"\"\n\n   If Sheets(\"AllTags\").Cells(RowIndex, 3).Value &gt; 0 Then\n   ReturnValue = 0\n   Parm1 = Sheets(\"AllTags\").Cells(RowIndex, 1).Value\n   Parm2 = Sheets(\"AllTags\").Cells(RowIndex, 2).Value\n   Parm3 = Sheets(\"AllTags\").Cells(RowIndex, 3).Value\n\n   With ActiveWorkbook.Connections(\"TagUpload\").OLEDBConnection\n\n   ' SET NOCOUNT ON;  ** IT DOESN'T LIKE THIS \n\n    .BackgroundQuery = False\n    .CommandText = \"EXECUTE DCSTransfer.dbo.InsertTags '\" &amp; Parm1 &amp; \"', '\" &amp;  \n        Parm2 &amp; \"', \" &amp; Parm3\n    .CommandType = xlCmdSql\n    .Connection = Array( _\n    \"OLEDB;Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security  \n     Info=True;Initial Catalog=DCSTransfer;Data Source=bdata03;Use Proc\" _\n    , _\n    \"edure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation \n      ID=B-MIS-NWILSON1;Use Encryption for Data=False;Tag with co\" _\n    , \"lumn collation when possible=False;\")\n\n\n    .RefreshOnFileOpen = False\n    .SavePassword = False\n    .SourceConnectionFile = \"\"\n    .SourceDataFile = \"\"\n    .ServerCredentialsMethod = xlCredentialsMethodIntegrated\n\n     ActiveWorkbook.Connections(\"TagUpload\").Refresh\n    .BackgroundQuery = False\n\n     On Error Resume Next  ' **** NEVER GETS THIS FAR ***\n\n     End With\n\n     End If\n\n     RowIndex = RowIndex + 1\n     Loop\n\n     End\n End Sub\n</code></pre>\n\n<p>Here is the script generated when I manually call the procedure in SQL Server and enter the Parms:</p>\n\n<pre><code>USE [DCSTransfer]\n GO\n\nDECLARE @return_value int\n\n EXEC   @return_value = [dbo].[InsertTags]\n        @Badge = N'9046',\n        @StartTag = N'80996',\n        @Qty = 70\n\n SELECT 'Return Value' = @return_value\n\n GO\n</code></pre>\n\n<p>Any other suggestions?  </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 4089, "user_id": 5106, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/482709c8157cf3e9dd67555a06b09370?s=128&d=identicon&r=PG", "display_name": "Jon Fournier", "link": "https://stackoverflow.com/users/5106/jon-fournier"}, "is_accepted": false, "score": 5, "last_activity_date": 1481734577, "creation_date": 1481734577, "answer_id": 41148084, "question_id": 41148083, "link": "https://stackoverflow.com/questions/41148083/type-mismatch-error-setting-excel-app-calculation/41148084#41148084", "title": "Type Mismatch error setting Excel app calculation", "body": "<p>The Excel application has to have at least one workbook open before you can set the Calculation property on the Application object.</p>\n\n<p>Move the .Calculation setting to after there's a workbook open.</p>\n"}, {"comments": [{"owner": {"reputation": 4089, "user_id": 5106, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/482709c8157cf3e9dd67555a06b09370?s=128&d=identicon&r=PG", "display_name": "Jon Fournier", "link": "https://stackoverflow.com/users/5106/jon-fournier"}, "edited": false, "score": 0, "creation_date": 1481819660, "post_id": 41149657, "comment_id": 69538449, "body": "I use late binding, but I do have all the Excel constants defined.  Instead I found that it&#39;s just not possible to set the .Calculation property on Excel&#39;s Application unless there&#39;s a workbook open."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1481740310, "creation_date": 1481740310, "answer_id": 41149657, "question_id": 41148083, "link": "https://stackoverflow.com/questions/41148083/type-mismatch-error-setting-excel-app-calculation/41149657#41149657", "title": "Type Mismatch error setting Excel app calculation", "body": "<p>I don't know Visio and I go on with the general assumption that it doesn't share Excel enumerations, like <code>XlCalculation</code> is</p>\n\n<p>So you:</p>\n\n<ul>\n<li><p>either use <em>actual</em> enumeration values</p>\n\n<p>for instance xlCalculationManual has a value of -4135, then you want to code</p>\n\n<pre><code>XLApp.Calculation = -4135\n</code></pre></li>\n<li><p>or use Excel enumerations name by referencing Excel Application object</p>\n\n<pre><code>XLApp.Calculation = XLApp.xlCalculationManual \n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 4089, "user_id": 5106, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/482709c8157cf3e9dd67555a06b09370?s=128&d=identicon&r=PG", "display_name": "Jon Fournier", "link": "https://stackoverflow.com/users/5106/jon-fournier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 758, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1481740310, "creation_date": 1481734577, "question_id": 41148083, "link": "https://stackoverflow.com/questions/41148083/type-mismatch-error-setting-excel-app-calculation", "title": "Type Mismatch error setting Excel app calculation", "body": "<p>I have a macro that gets or starts Excel from Visio using VBA and creates a workbook to accompany the active Visio drawing.</p>\n\n<p>When the macro goes to turn off Excel auto calculation I get a type mismatch error, but it doesn't always give that error.</p>\n\n<p>Why does the code work sometimes, and not others?</p>\n\n<pre><code>Dim XLCalcMode As Long\nXLCalcMode = XLApp.Calculation\nXLApp.Calculation = xlCalculationManual\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "multiple-choice", "multiplechoicefield"], "comments": [{"owner": {"reputation": 327, "user_id": 6229637, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2Lxry.jpg?s=128&g=1", "display_name": "Xam Eseerts", "link": "https://stackoverflow.com/users/6229637/xam-eseerts"}, "edited": false, "score": 0, "creation_date": 1481735920, "post_id": 41147965, "comment_id": 69499287, "body": "If I understand your problem correctly you should just do a many-to-many relation between Student and Module (e.g. have a table between those two tables which connects them by storing pairs of StudentID and ModuleID)."}, {"owner": {"reputation": 23, "user_id": 3167227, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/d520301eb5ae451d421206d4440d0ceb?s=128&d=identicon&r=PG&f=1", "display_name": "user3167227", "link": "https://stackoverflow.com/users/3167227/user3167227"}, "reply_to_user": {"reputation": 327, "user_id": 6229637, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2Lxry.jpg?s=128&g=1", "display_name": "Xam Eseerts", "link": "https://stackoverflow.com/users/6229637/xam-eseerts"}, "edited": false, "score": 0, "creation_date": 1481743573, "post_id": 41147965, "comment_id": 69503362, "body": "Thanks for your quick reply!"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 3167227, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/d520301eb5ae451d421206d4440d0ceb?s=128&d=identicon&r=PG&f=1", "display_name": "user3167227", "link": "https://stackoverflow.com/users/3167227/user3167227"}, "edited": false, "score": 0, "creation_date": 1481743598, "post_id": 41148964, "comment_id": 69503380, "body": "Thanks so much for your quick and detailed response this has really helped me and i appreciate it!"}], "tags": [], "owner": {"reputation": 327, "user_id": 6229637, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2Lxry.jpg?s=128&g=1", "display_name": "Xam Eseerts", "link": "https://stackoverflow.com/users/6229637/xam-eseerts"}, "is_accepted": false, "score": 2, "last_activity_date": 1481737688, "creation_date": 1481737688, "answer_id": 41148964, "question_id": 41147965, "link": "https://stackoverflow.com/questions/41147965/storing-multiple-choice-answers-of-a-module-options-form-in-a-microsoft-access-d/41148964#41148964", "title": "Storing Multiple choice answers of a Module Options Form in a Microsoft Access Database", "body": "<p>As for your core problem, I think the database design outlined below should be sufficient:</p>\n\n<p><a href=\"https://i.stack.imgur.com/rRBRj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rRBRj.png\" alt=\"A simple ERM solving the problem\"></a></p>\n\n<p>You should not store both, the modules a student selects and the programme he is enrolled in in the same table. Instead do it like outlined above. </p>\n\n<ul>\n<li>The programme a student is enrolled in should just be a foreign key in the student table, therefore giving you a one-to-many-relation (This is a crucial point though, because this means any one student can only be enrolled in one programme! If your database has to be able to have one student be enrolled in more than one programme, you need a many-to-many-relation there too.).</li>\n<li>The modules should be related to a student via a middle table (I called it StudentModule in this case), therefore giving you the desired many-to-many-relation. What you now have to do of course is check via code, if the module isn't already selected by the student (as well as all the other small and big details there are...). But this you would have to do with any database design as far as I know.</li>\n<li>As you can see, I also inserted a middle table for the module to programme relation. This is because I assume that one module is eligible for multiple programmes. By relating modules to programmes in this way, you can then check for stuff like \"can this student elect this module\", ...</li>\n</ul>\n"}], "owner": {"reputation": 23, "user_id": 3167227, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/d520301eb5ae451d421206d4440d0ceb?s=128&d=identicon&r=PG&f=1", "display_name": "user3167227", "link": "https://stackoverflow.com/users/3167227/user3167227"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481737688, "creation_date": 1481734226, "question_id": 41147965, "link": "https://stackoverflow.com/questions/41147965/storing-multiple-choice-answers-of-a-module-options-form-in-a-microsoft-access-d", "title": "Storing Multiple choice answers of a Module Options Form in a Microsoft Access Database", "body": "<p>I currently am trying to work out how to create a relational database for a University Module Options form. First you enter your student ID, Name, Surname and select your degree programme e.g. Human Resource Management then choose multiple modules through the form using checkboxes until the total credits for each semester for each programme is chosen.</p>\n\n<p>However in choosing multiple modules and in being a relational database design i am unsure of how to store these multiple answers in the Student Options table as shown below.</p>\n\n<p>I currently have the tables of</p>\n\n<p><strong>Table: Student</strong>\nField Names:\nStudent ID (primary key)\nName\nSurname</p>\n\n<p><strong>Table: Programme</strong>\nProgramme (primary key)\nSemester 1 Credits (different programmes allow different amount of credits )\nSemester 2 Credits  (different programmes allow different amount of credits )</p>\n\n<p><strong>Table: Module</strong>\nModule ID (primary key)\nModule Name\nCredits\nPrerequisite</p>\n\n<p>The last table is one i am struggling with as after the modules are chosen from the form they will be stored in this table and currently have this...</p>\n\n<p><strong>Table: Student Options</strong>\nStudent ID (primary key)\nProgramme (link to programme table)</p>\n\n<p>However i am unsure what fields to have to store them in without being too cluttered and still having a link to the modules table as shown below which are all stored individually.</p>\n\n<p>Does my modules table need to have a relationship link to the student options table to be a relational database ?</p>\n\n<p>How would i store the multiple modules chosen into the student options form?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1481734384, "post_id": 41147885, "comment_id": 69498365, "body": "You could perhaps turn your select case statements round to <code>Select Case True</code> and then your first case could be <code>Range(&quot;O&quot; &amp; i)= &quot;University of Illinois&quot; and Range(&quot;P&quot; &amp; i)=&quot;Urbana&quot;</code> (but then arguably you might as well use <code>If</code>)."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1481734401, "post_id": 41147885, "comment_id": 69498374, "body": "If the conditions for the various cases involve multiple criteria based on multiple values, why not just use an <code>If - Then - ElseIf ...</code> cascade rather than <code>Select Case</code>? That allows you to use Boolean operators in the conditions."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1481736154, "post_id": 41147885, "comment_id": 69499428, "body": "@Robby try the code in my work-around answer below, there is a way to &quot;Cheat&quot; the <code>Select Case</code> to work with the <code>Like</code> operator"}], "answers": [{"comments": [{"owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "edited": false, "score": 0, "creation_date": 1481736277, "post_id": 41147970, "comment_id": 69499500, "body": "That&#39;s close. &quot;Urbana&quot; and &quot;Chicago&quot; need to be different cases. That points me in the right direction though. If I separate them into separate cases, it works. Thanks."}], "tags": [], "owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "is_accepted": true, "score": 3, "last_activity_date": 1481734240, "creation_date": 1481734240, "answer_id": 41147970, "question_id": 41147885, "link": "https://stackoverflow.com/questions/41147885/excel-select-case-with-multiple-criteria/41147970#41147970", "title": "Excel - Select Case with multiple criteria", "body": "<pre><code>Select Case Range(\"O\" &amp; i)\n    Case \"University of Illinois\", \"UofI\"\n        Select Case Range(\"P\" &amp; i\")\n            Case \"Urbana\", \"Chicago\"\n                Range(\"N\" &amp; i) = \"1234\"\n        End Select\nEnd Select\n</code></pre>\n\n<p>Does this suffice? Have not tested so please feedback so we can get you to a solution</p>\n"}, {"comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1481736450, "post_id": 41148493, "comment_id": 69499623, "body": "That is a neat trick, although I feel ambivalent about it in terms of readability."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 3, "last_activity_date": 1481735925, "creation_date": 1481735925, "answer_id": 41148493, "question_id": 41147885, "link": "https://stackoverflow.com/questions/41147885/excel-select-case-with-multiple-criteria/41148493#41148493", "title": "Excel - Select Case with multiple criteria", "body": "<p>Under normal circumstances, the <code>Select Case</code> statement doesn't work with the <code>Like</code> operator. However, there is a work-around.</p>\n\n<p>In order for the <code>Select Case</code> to work with the <code>Like</code>, we will add a <code>True</code> expression.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Sub Test4()\n\n    Dim LastRow As Long\n    Dim i As Long\n\n    LastRow = Range(\"O\" &amp; Rows.Count).End(xlUp).Row\n    For i = 84 To LastRow\n\n        Dim wordStr\n        wordStr = Range(\"K\" &amp; i)\n\n        ' adding True to enter the below Case with Like\n        Select Case True\n            Case wordStr Like \"B*\", wordStr Like \"M*\", wordStr Like \"D*\"\n                Select Case Range(\"O\" &amp; i)\n                    Case \"University of Illinois\", \"UofI\"\n                        Range(\"N\" &amp; i) = \"1234\"\n\n                End Select\n\n            Case wordStr Like \"A*\"\n                Select Case Range(\"O\" &amp; i)\n                    Case \"New York University\", \"NYU\"\n                        Range(\"N\" &amp; i) = \"5075\"\n\n                End Select\n\n        End Select\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1481742091, "creation_date": 1481742091, "answer_id": 41150185, "question_id": 41147885, "link": "https://stackoverflow.com/questions/41147885/excel-select-case-with-multiple-criteria/41150185#41150185", "title": "Excel - Select Case with multiple criteria", "body": "<p>since you need to catch <em>\"word that begins with\"</em> you could go like this</p>\n\n<pre><code>Sub Test4()\n    Dim LastRow As Long, i As Long\n\n    LastRow = Range(\"O\" &amp; Rows.count).End(xlUp).row\n    For i = 84 To LastRow\n        Select Case Left(Range(\"K\" &amp; i).Value, 1)\n            Case \"B\", \"M\", \"D\"\n                Select Case Range(\"O\" &amp; i).Value\n                    Case \"University of Illinois\", \"UofI\"\n                        Range(\"N\" &amp; i) = \"1234\"\n                End Select\n            Case \"A\"\n                Select Case Range(\"O\" &amp; i).Value\n                    Case \"New York University\", \"NYU\"\n                        Range(\"N\" &amp; i) = \"5075\"\n                End Select\n        End Select\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4790, "favorite_count": 0, "accepted_answer_id": 41147970, "answer_count": 3, "score": 1, "last_activity_date": 1481742091, "creation_date": 1481733999, "last_edit_date": 1481734167, "question_id": 41147885, "link": "https://stackoverflow.com/questions/41147885/excel-select-case-with-multiple-criteria", "title": "Excel - Select Case with multiple criteria", "body": "<p>The code below is sort of an excerpt of my full Sub just because it'll be easier to read here. I need to add more criteria to some of the cases, and I'm not sure how to implement that.</p>\n\n<p>To sum up what this is doing, in a row, if column K has a word that begins with B, M, or D, it runs a set of cases. If column K has a word that begins with an A, it runs a different set of cases. Again, this is working. But in some of these cases, I need it to have more criteria instead of only looking at column O.</p>\n\n<p>For example, in the first case, it needs to check for \"University of Illinois\" and \"UofI,\" but it also needs to check column P for the values of \"Urbana\" and \"Chicago.\" How can I do that?</p>\n\n<pre><code>Sub Test4()\n    Dim LastRow As Long\n    Dim i As Long\n    LastRow = Range(\"O\" &amp; Rows.Count).End(xlUp).Row\n    For i = 84 To LastRow\n        If Range(\"K\" &amp; i) Like \"B*\" Or Range(\"K\" &amp; i) Like \"M*\" Or Range(\"K\" &amp; i) Like \"D*\" Then\n            Select Case Range(\"O\" &amp; i)\n                Case \"University of Illinois\", \"UofI\"\n                    Range(\"N\" &amp; i) = \"1234\"\n            End Select\n        End If\n        If Range(\"K\" &amp; i) Like \"A*\" Then\n            Select Case Range(\"O\" &amp; i)\n                Case \"New York University\", \"NYU\"\n                    Range(\"N\" &amp; i) = \"5075\"\n            End Select\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["xml", "vba", "excel", "xdoc"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481733938, "post_id": 41147780, "comment_id": 69498065, "body": "Get the <code>GetUserInfo</code> node first, then select from the subnodes."}, {"owner": {"reputation": 169, "user_id": 7150666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4bdbe3a8c7b7a9e9ec16859ac97c0f9?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/7150666/david"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481734524, "post_id": 41147780, "comment_id": 69498436, "body": "@Comintern I don&#39;t get it, can you please explain your answer? or give an example ?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481735636, "post_id": 41147780, "comment_id": 69499112, "body": "See <a href=\"http://stackoverflow.com/a/29726379/4088852\">this answer</a>."}, {"owner": {"reputation": 169, "user_id": 7150666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4bdbe3a8c7b7a9e9ec16859ac97c0f9?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/7150666/david"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481735834, "post_id": 41147780, "comment_id": 69499235, "body": "10X for your answer!"}], "answers": [{"comments": [{"owner": {"reputation": 169, "user_id": 7150666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4bdbe3a8c7b7a9e9ec16859ac97c0f9?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/7150666/david"}, "edited": false, "score": 0, "creation_date": 1482062412, "post_id": 41148405, "comment_id": 69614946, "body": "oDoc.LoadXML XML ---&gt;oDoc.Load XML"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 169, "user_id": 7150666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4bdbe3a8c7b7a9e9ec16859ac97c0f9?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/7150666/david"}, "edited": false, "score": 0, "creation_date": 1482079918, "post_id": 41148405, "comment_id": 69619966, "body": "My answer doesn&#39;t need editing: I&#39;m using your XML stored in a worksheet cell and using <code>LoadXML</code> to load the document from that string.  <code>Load</code> is correct if you want to load the document from a file."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1482079995, "last_edit_date": 1482079995, "creation_date": 1481735627, "answer_id": 41148405, "question_id": 41147780, "link": "https://stackoverflow.com/questions/41147780/read-xml-attribute-vba/41148405#41148405", "title": "Read XML Attribute VBA", "body": "<p>This worked for me:</p>\n\n<pre><code>Dim oDoc As New MSXML2.DOMDocument30\nDim el As Object\nDim XML As String\n\nXML = ActiveSheet.Range(\"B1\").Value 'for testing....\n\noDoc.validateOnParse = True\noDoc.LoadXML XML  '&lt;&lt; using LoadXML to load from a string\n                  '   use Load if you're reading from a file\n\n'select the User node with ID=21\nSet el = oDoc.SelectSingleNode(\"//GetUserInfo/User[@ID=\"\"21\"\"]\")\n\nIf Not el Is Nothing Then\n    Debug.Print el.getAttribute(\"Name\")\nElse\n    Debug.Print \"user id not found!\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 169, "user_id": 7150666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4bdbe3a8c7b7a9e9ec16859ac97c0f9?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/7150666/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1205, "favorite_count": 1, "accepted_answer_id": 41148405, "answer_count": 1, "score": 1, "last_activity_date": 1482079995, "creation_date": 1481733742, "last_edit_date": 1495540801, "question_id": 41147780, "link": "https://stackoverflow.com/questions/41147780/read-xml-attribute-vba", "title": "Read XML Attribute VBA", "body": "<p>I am trying to get the attribute of a single node in VBA, but can't manage it using DOM</p>\n\n<p>The XML looks like following:</p>\n\n<pre><code>    &lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n       &lt;soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"&gt;\n          &lt;soap:Body&gt;\n             &lt;GetUserInfoResponse xmlns=\"http://schemas.microsoft.com/sharepoint/soap/directory/\"&gt;\n                &lt;GetUserInfoResult&gt;\n                   &lt;GetUserInfo&gt;\n                      &lt;User ID=\"16\" Name=\"David\" LoginName=\"login\" Email=\"\" Notes=\"\" IsSiteAdmin=\"False\" IsDomainGroup=\"False\" /&gt;\n                      &lt;User ID=\"17\" Name=\"Gal\" LoginName=\"login\" Email=\"\" Notes=\"\" IsSiteAdmin=\"False\" IsDomainGroup=\"False\" /&gt;\n                      &lt;User ID=\"18\" Name=\"Netzer\" LoginName=\"login\" Email=\"\" Notes=\"\" IsSiteAdmin=\"False\" IsDomainGroup=\"False\" /&gt;\n                      &lt;User ID=\"3\" Name=\"More\" LoginName=\"login\" Email=\"\" Notes=\"\" IsSiteAdmin=\"False\" IsDomainGroup=\"False\" /&gt;\n                      &lt;User ID=\"20\" Name=\"Alon\" LoginName=\"login\" Email=\"\" Notes=\"\" IsSiteAdmin=\"False\" IsDomainGroup=\"False\" /&gt;\n                      &lt;User ID=\"21\" Name=\"Dan\" LoginName=\"login\" Email=\"\" Notes=\"\" IsSiteAdmin=\"False\" IsDomainGroup=\"False\" /&gt;\n                      &lt;User ID=\"708\" Name=\"Yaron\" LoginName=\"login\" Email=\"\" Notes=\"\" IsSiteAdmin=\"False\" IsDomainGroup=\"False\" /&gt;\n                &lt;/GetUserInfo&gt;\n             &lt;/GetUserInfoResult&gt;\n          &lt;/GetUserInfoResponse&gt;\n       &lt;/soap:Body&gt;\n    &lt;/soap:Envelope&gt;\n</code></pre>\n\n<p>I am basically just trying to get the value of the ID attribute. Any help would be appreciated.</p>\n\n<p>this is same question as in the following link:\n<a href=\"https://stackoverflow.com/questions/5297068/read-xml-attribute-vba\">Read XML Attribute VBA</a>\n with small change ! as you can see in XML file there is more then one USER \nso the following answer doesn't fit,</p>\n\n<pre><code>Try:\n\n(Include a reference to Microsoft XML v3, I saved your xml to a file on my desktop)\n\n    Dim xmlDoc As DOMDocument30\n    Set xmlDoc = New DOMDocument30\n    xmlDoc.Load (\"C:\\users\\jon\\desktop\\test.xml\")\n\n    Dim id As String\n    id = xmlDoc.SelectSingleNode(\"//GetUserInfo/User\").Attributes.getNamedItem(\"ID\").Text\n</code></pre>\n\n<p>how can i know the name of user that his ID  is \"21\"?</p>\n\n<p>really be glad if someone can help me </p>\n"}, {"tags": ["sql-server", "ms-access", "vba", "odbc", "ms-access-2016"], "comments": [{"owner": {"reputation": 2504, "user_id": 7125938, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d7039fba933d06fb1ef9434d48c1b4a1?s=128&d=identicon&r=PG&f=1", "display_name": "cloudsafe", "link": "https://stackoverflow.com/users/7125938/cloudsafe"}, "edited": false, "score": 2, "creation_date": 1481733049, "post_id": 41147503, "comment_id": 69497481, "body": "Yes. You can do this by creating in Access VBA a QueryDef that is a PASS THROUGH QUERY. It passes the parameter to SQL Server and only returns the rows required. Another way is to create a table on SQL Server that holds filter condition values corresponding to columns in a table. You create a view that is filtered by this parameter table. Update the values in the parameter table from Access to change the results of the view."}, {"owner": {"reputation": 3496, "user_id": 2961734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79f0229603e30b04fddc833d85afc9e0?s=128&d=identicon&r=PG&f=1", "display_name": "Laughing Vergil", "link": "https://stackoverflow.com/users/2961734/laughing-vergil"}, "edited": false, "score": 2, "creation_date": 1481733715, "post_id": 41147503, "comment_id": 69497922, "body": "Creating a view on SQL Server that returns only the information you want is also another way of doing this. It would also allow you to completely ignore any data columns you don&#39;t need for this reporting."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2556480"}, "edited": false, "score": 0, "creation_date": 1481734319, "post_id": 41147503, "comment_id": 69498324, "body": "I&#39;ll check out QueryDef and see if that offers the solution I need. Thanks."}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "reply_to_user": {"reputation": 3496, "user_id": 2961734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79f0229603e30b04fddc833d85afc9e0?s=128&d=identicon&r=PG&f=1", "display_name": "Laughing Vergil", "link": "https://stackoverflow.com/users/2961734/laughing-vergil"}, "edited": false, "score": 0, "creation_date": 1481734386, "post_id": 41147503, "comment_id": 69498366, "body": "@LaughingVergil mostly in MS Access you need to add an index through VBA when you create a view, but I do like views."}], "answers": [{"comments": [{"owner": {"reputation": 2504, "user_id": 7125938, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d7039fba933d06fb1ef9434d48c1b4a1?s=128&d=identicon&r=PG&f=1", "display_name": "cloudsafe", "link": "https://stackoverflow.com/users/7125938/cloudsafe"}, "edited": false, "score": 0, "creation_date": 1481733445, "post_id": 41147564, "comment_id": 69497739, "body": "This will return all the rows from the table, then filter them with the WHERE clause. It can cause network problems and slowness."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2556480"}, "edited": false, "score": 0, "creation_date": 1481734133, "post_id": 41147564, "comment_id": 69498193, "body": "Are you saying import all the data and query it independently to get the rows I need? If so I don&#39;t want to use this method. I only want to bring in the rows I need and then I will query those rows."}, {"owner": {"reputation": 87, "user_id": 1283967, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/de997ef74bbca5b3ec25058c0d7bed8c?s=128&d=identicon&r=PG", "display_name": "niemoy", "link": "https://stackoverflow.com/users/1283967/niemoy"}, "edited": false, "score": 0, "creation_date": 1481734507, "post_id": 41147564, "comment_id": 69498424, "body": "Do you have access to the SQL SERVER database?  If so, create a view in the SQL Server DB and connect to the view through access or have a DBA create the view for you."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2556480"}, "edited": false, "score": 0, "creation_date": 1481735410, "post_id": 41147564, "comment_id": 69498973, "body": "I don&#39;t have enough privilege to create a view."}, {"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "edited": false, "score": 0, "creation_date": 1481923093, "post_id": 41147564, "comment_id": 69584879, "body": "Using a where clause in SQL does NOT pull or grab all rows and then filter  - so couldsafe is 100% wrong on this issue.  this includes using + building a query in the access client that based on linked tables."}, {"owner": {"reputation": 87, "user_id": 1283967, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/de997ef74bbca5b3ec25058c0d7bed8c?s=128&d=identicon&r=PG", "display_name": "niemoy", "link": "https://stackoverflow.com/users/1283967/niemoy"}, "edited": false, "score": 0, "creation_date": 1482425178, "post_id": 41147564, "comment_id": 69778198, "body": "Pretty sure I was the one that recommended having a DBA to create a view for you"}], "tags": [], "owner": {"reputation": 87, "user_id": 1283967, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/de997ef74bbca5b3ec25058c0d7bed8c?s=128&d=identicon&r=PG", "display_name": "niemoy", "link": "https://stackoverflow.com/users/1283967/niemoy"}, "is_accepted": false, "score": -1, "last_activity_date": 1481733047, "creation_date": 1481733047, "answer_id": 41147564, "question_id": 41147503, "link": "https://stackoverflow.com/questions/41147503/link-sql-server-data-to-ms-access-database-with-filters/41147564#41147564", "title": "Link SQL Server data to MS Access database with filters", "body": "<p>Connect to the SQL Server database in Access using the External Data tab via ODBC and use SQL in ACCESS or the query desinger on the Create Tab to query the data you need.\nSELECT * from TABLE WHERE DATEFIELD > whatever date</p>\n"}, {"tags": [], "owner": {"reputation": 2504, "user_id": 7125938, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d7039fba933d06fb1ef9434d48c1b4a1?s=128&d=identicon&r=PG&f=1", "display_name": "cloudsafe", "link": "https://stackoverflow.com/users/7125938/cloudsafe"}, "is_accepted": false, "score": 0, "last_activity_date": 1481734843, "last_edit_date": 1481734843, "creation_date": 1481734214, "answer_id": 41147959, "question_id": 41147503, "link": "https://stackoverflow.com/questions/41147503/link-sql-server-data-to-ms-access-database-with-filters/41147959#41147959", "title": "Link SQL Server data to MS Access database with filters", "body": "<p>This is an example of how a parameter table works in SQL Server, that can easily be updated from Access. The table is updated or inserted with the current username and the filter value, changing the rows returned by the view.</p>\n\n<p><code>\n    create table Params (\n        usrname as nvarchar(100) CONSTRAINT [df_load_date] DEFAULT @@SUSER_NAME\n      , pvalue as nvarchar(100))\n    Insert into params (pvalue) values ( 'MytableName')\n    Create view vw_test\n    as\n    select * from sysobjects where name in (\n        Select pvalue from Params where usrname = @@SUSER_NAME)\n</code></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2556480"}, "is_accepted": true, "score": 0, "last_activity_date": 1481836892, "creation_date": 1481836892, "answer_id": 41173532, "question_id": 41147503, "link": "https://stackoverflow.com/questions/41147503/link-sql-server-data-to-ms-access-database-with-filters/41173532#41173532", "title": "Link SQL Server data to MS Access database with filters", "body": "<p>I talked to our DBA. I'm going to create a view. cloudsafe thanks for the suggestion, I just didn't have the time to investigate QueryDef in Access, but I've I made a note of it for possibly future usage.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2556480"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 892, "favorite_count": 0, "accepted_answer_id": 41173532, "answer_count": 3, "score": 0, "last_activity_date": 1481836892, "creation_date": 1481732855, "question_id": 41147503, "link": "https://stackoverflow.com/questions/41147503/link-sql-server-data-to-ms-access-database-with-filters", "title": "Link SQL Server data to MS Access database with filters", "body": "<p>I would like to create a link from an SQL Server database to an MS Access database for reporting purposes. I don't need all the data from the table just the past few years worth. Is there a way through Access VBA or MS Access tools to only bring in the rows I need rather then all rows?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "edited": false, "score": 0, "creation_date": 1481733345, "post_id": 41147452, "comment_id": 69497677, "body": "See <a href=\"https://www.extendoffice.com/documents/excel/3360-excel-transpose-every-5-rows.html#a1\" rel=\"nofollow noreferrer\">extendoffice.com/documents/excel/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 3, "last_activity_date": 1481733469, "last_edit_date": 1481733469, "creation_date": 1481733111, "answer_id": 41147576, "question_id": 41147452, "link": "https://stackoverflow.com/questions/41147452/excel-horizontal-list-to-columns/41147576#41147576", "title": "Excel horizontal list to columns", "body": "<p>Put this in the upper left cell desired:</p>\n\n<pre><code>=INDEX(Sheet1!$A:$A,(ROW(1:1)-1)*6+COLUMN(A:A))\n</code></pre>\n\n<p>Then copy/drag over 6 columns and down till you finish the list</p>\n\n<p><a href=\"https://i.stack.imgur.com/AXpcY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AXpcY.png\" alt=\"![enter image description here\"></a></p>\n\n<p>Sheet1</p>\n\n<p><a href=\"https://i.stack.imgur.com/x9ypM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/x9ypM.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 7, "user_id": 7051821, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SEHy9IbwL5s/AAAAAAAAAAI/AAAAAAAAACw/vayUABoBBDw/photo.jpg?sz=128", "display_name": "Metric Candy", "link": "https://stackoverflow.com/users/7051821/metric-candy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 41147576, "answer_count": 1, "score": 0, "last_activity_date": 1486151644, "creation_date": 1481732739, "last_edit_date": 1531161705, "question_id": 41147452, "link": "https://stackoverflow.com/questions/41147452/excel-horizontal-list-to-columns", "title": "Excel horizontal list to columns", "body": "<p>I am looking to format some data. To make it more easy I use an example with simple numbers.</p>\n\n<pre><code>Sheet 1 ('S1'):\nA1 10 \nA2 14 \nA3 23 \nA4 12 \nA5 64 \nA6 32\n.... etc\n</code></pre>\n\n<p>It is a long list(vertical) of 600 values</p>\n\n<p>Now I want in Sheet 2('S2'): </p>\n\n<p>To show it as:</p>\n\n<pre><code>S1!A1 S1!A2 S1!A3 S1!A4 S1!A5 S1!A6\nS1!A7 S1!A8 S1!A9 S1!A10 S1!A11 S1!A12\nS1!A13 S1!A14 S1!A15 S1!A16 S1!A17 S1!A18\n</code></pre>\n\n<p>References to the cells in the other sheet. </p>\n\n<p>I have tried to transpose them but I cannot find a modifier to set an amount of columns used. i.e. I would get 1 row with all my data. I want only the first 6 in row, next 6 in next row, next 6... etc.</p>\n\n<p>Thanks for any help/feedback given.</p>\n"}, {"tags": ["excel", "reportingservices-2005", "vba"], "answers": [{"tags": [], "owner": {"reputation": 335, "user_id": 3866299, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6ZBbc.jpg?s=128&g=1", "display_name": "Nathan Dudley", "link": "https://stackoverflow.com/users/3866299/nathan-dudley"}, "is_accepted": true, "score": 1, "last_activity_date": 1481738235, "creation_date": 1481738235, "answer_id": 41149112, "question_id": 41146972, "link": "https://stackoverflow.com/questions/41146972/building-excel-report-with-ssrs-link-how-to-pass-dynamic-date-parameters-enter/41149112#41149112", "title": "Building excel report with ssrs link - how to pass dynamic date parameters entered in excel sheet", "body": "<p>You can simply read the dates from the spreadsheet into variables and format them. Then concatenate those variables with the URL. </p>\n\n<p>Assuming your beginning date is in cell \"A1\" and your end date is in cell \"A2\".</p>\n\n<pre><code>Dim fromDate As String\nDim toDate As String\n\nfromDate = Format(Range(\"a1\").Value, \"dd/mm/yyyy\")\ntoDate = Format(Range(\"a2\").Value, \"dd/mm/yyyy\")\n\n\nWorkbooks.Open Filename:= _\n\"http://Serverlink/ReportServer?%2fFinance%2fReportname&amp;rs:Command=Render&amp;FromDate=\" &amp; fromDate &amp; \"&amp;ToDate=\" &amp; toDate &amp; \"&amp;rs:Format=Excel\"\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7297154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/936a1c981e3a791c255c21052424ecd6?s=128&d=identicon&r=PG&f=1", "display_name": "suzi", "link": "https://stackoverflow.com/users/7297154/suzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 492, "favorite_count": 0, "accepted_answer_id": 41149112, "answer_count": 1, "score": 1, "last_activity_date": 1481738235, "creation_date": 1481731275, "last_edit_date": 1531161705, "question_id": 41146972, "link": "https://stackoverflow.com/questions/41146972/building-excel-report-with-ssrs-link-how-to-pass-dynamic-date-parameters-enter", "title": "Building excel report with ssrs link - how to pass dynamic date parameters entered in excel sheet", "body": "<p>I have excel report using ssrs report link -</p>\n\n<p><a href=\"http://Serverlink/ReportServer?%2fFinance%2fReportname&amp;rs:Command=Render&amp;FromDate=01/31/2016&amp;ToDate=03/13/2016&amp;rs:Format=Excel\" rel=\"nofollow noreferrer\">http://Serverlink/ReportServer?%2fFinance%2fReportname&amp;rs:Command=Render&amp;FromDate=01/31/2016&amp;ToDate=03/13/2016&amp;rs:Format=Excel</a> . This works fine when I use it in Macro to run report on button click command</p>\n\n<pre><code>Private Sub ViewReport_Click()\nWorkbooks.Open Filename:= _\n\"http://Serverlink/ReportServer?%2fFinance%2fReportname&amp;rs:Command=Render&amp;FromDate=01/31/2016&amp;ToDate=03/13/2016&amp;rs:Format=Excel\"\n\nActiveSheet.Range(\"A8:I2000\").Select\nSelection.Copy\nApplication.DisplayAlerts = False\nActiveWorkbook.Close SaveChanges:=False\nWindows(ThisWorkbook.Name).Activate\nRange(\"A8\").Select\nActiveSheet.Paste\nEnd Sub\n</code></pre>\n\n<p>But I need to pass dynamic dates entered in excel sheet to url link- in DTPicker. How can I acheive it?  </p>\n\n<p><a href=\"https://i.stack.imgur.com/uIdvP.png\" rel=\"nofollow noreferrer\">Ecxel macro capture</a></p>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2007"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1481733782, "post_id": 41146968, "comment_id": 69497965, "body": "My guess is you need VBA."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1481733787, "post_id": 41146968, "comment_id": 69497968, "body": "You probably could do this with formulae, but I would do it with VBA. You could use Split to break up the strings by &#39;;&#39; and then Split each of them by &#39;=&#39;, look for a heading match and place the second element in the appropriate column. You need to have a stab yourself first and then come back if and when you get stuck."}], "answers": [{"comments": [{"owner": {"reputation": 2608, "user_id": 3258462, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/fspw2.png?s=128&g=1", "display_name": "Vincent Tang", "link": "https://stackoverflow.com/users/3258462/vincent-tang"}, "edited": false, "score": 0, "creation_date": 1482874031, "post_id": 41351790, "comment_id": 69906664, "body": "I just finished writing my code right as you posted this. Took me awhile though, had to spent alot of time going through VBA tutorials for the past 1-2 weeks. Here it is: <a href=\"https://github.com/AnacondaPython/CodeSnippets/blob/master/excelVBA/DelimitFilter.vbs\" rel=\"nofollow noreferrer\">github.com/AnacondaPython/CodeSnippets/blob/master/excelVBA/&zwnj;&#8203;&hellip;</a>"}, {"owner": {"reputation": 2608, "user_id": 3258462, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/fspw2.png?s=128&g=1", "display_name": "Vincent Tang", "link": "https://stackoverflow.com/users/3258462/vincent-tang"}, "edited": false, "score": 0, "creation_date": 1482874795, "post_id": 41351790, "comment_id": 69906929, "body": "also I tried running your code (using A1, A2, A3, A4, etc) as the cell value input reference. But I got this error. <a href=\"http://i.imgur.com/BhUOOEk.png\" rel=\"nofollow noreferrer\">i.imgur.com/BhUOOEk.png</a>"}, {"owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "reply_to_user": {"reputation": 2608, "user_id": 3258462, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/fspw2.png?s=128&g=1", "display_name": "Vincent Tang", "link": "https://stackoverflow.com/users/3258462/vincent-tang"}, "edited": false, "score": 1, "creation_date": 1482928766, "post_id": 41351790, "comment_id": 69925788, "body": "I&#39;m entirely sure about the error, but here&#39;s what MSDN says about it: <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264133.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/gg264133.aspx</a>"}, {"owner": {"reputation": 2608, "user_id": 3258462, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/fspw2.png?s=128&g=1", "display_name": "Vincent Tang", "link": "https://stackoverflow.com/users/3258462/vincent-tang"}, "edited": false, "score": 0, "creation_date": 1482935305, "post_id": 41351790, "comment_id": 69929400, "body": "sorry the error I got was 424 after I turned off breakmode  <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251554.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/gg251554.aspx</a>"}, {"owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "reply_to_user": {"reputation": 2608, "user_id": 3258462, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/fspw2.png?s=128&g=1", "display_name": "Vincent Tang", "link": "https://stackoverflow.com/users/3258462/vincent-tang"}, "edited": false, "score": 1, "creation_date": 1482935681, "post_id": 41351790, "comment_id": 69929591, "body": "Is there a value in the variable DataFromCell(0)? That might cause this error if it is trying to look for <code>nothing</code>."}, {"owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "reply_to_user": {"reputation": 2608, "user_id": 3258462, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/fspw2.png?s=128&g=1", "display_name": "Vincent Tang", "link": "https://stackoverflow.com/users/3258462/vincent-tang"}, "edited": false, "score": 1, "creation_date": 1482936015, "post_id": 41351790, "comment_id": 69929775, "body": "You could also change this line to use <code>MATCH</code> something like: <code>set FoundCell = Application.MATCH(DataFromCell(0),Range(Cells(1,2),Cells(1,L&zwnj;&#8203;astCol)),0)</code>   You would also have to move the <code>LastCol = </code> up higher so that you can use is sooner."}], "tags": [], "owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "is_accepted": false, "score": 1, "last_activity_date": 1482937009, "last_edit_date": 1482937009, "creation_date": 1482870415, "answer_id": 41351790, "question_id": 41146968, "link": "https://stackoverflow.com/questions/41146968/how-to-extract-excel-cell-values-delimited-with-filters/41351790#41351790", "title": "How to extract excel cell values delimited with filters?", "body": "<p>You could go with something like this, though you'll have to update the sheet name and probably where you want the final data located.</p>\n\n<pre><code>Sub SplitCell()\n    Dim DataFromCell, FoundCell\n    Dim Testing, Counted, LastCol\n    For Each c In Range(Range(\"A1\"), Range(\"A\" &amp; Rows.count).End(xlUp))\n        Testing = Split(c.Value, \";\")\n        Range(\"B\" &amp; c.row + 1).Value = \"A\" &amp; c.row\n        Counted = UBound(Testing)\n        For Each x In Testing\n            DataFromCell = Split(x, \"=\")\n            With Sheet2\n                Set FoundCell = .Cells.Find(What:=DataFromCell(0), after:=.Cells(1, 2), _\n                    LookIn:=xlValues, lookat:=1, searchorder:=xlByColumns, searchdirection:=xlNext, _\n                    MatchCase:=False, searchformat:=False)\n            End With\n            If Not FoundCell Is Nothing Then\n                Cells(c.row + 1, FoundCell.Column).Value = DataFromCell(1)\n            End If\n            If FoundCell Is Nothing Then\n                LastCol = Sheet2.Cells(1, Sheet2.Columns.count).End(xlToLeft).Column\n                Cells(1, LastCol + 1).Value = DataFromCell(0)\n                Cells(c.row + 1, LastCol + 1).Value = DataFromCell(1)\n            End If\n        Next x\n    Next c\nEnd Sub\n</code></pre>\n\n<p><strong>Edit</strong></p>\n\n<p>Since the above was giving you errors you could try this one:</p>\n\n<pre><code>Sub SplitCell()\n    Dim DataFromCell, FoundCell\n    Dim Testing, Counted, LastCol\n    For Each c In Range(Range(\"A1\"), Range(\"A\" &amp; Rows.count).End(xlUp))\n        Testing = Split(c.Value, \";\")\n        Range(\"B\" &amp; c.row + 1).Value = \"A\" &amp; c.row\n        Counted = UBound(Testing)\n        For Each x In Testing\n            DataFromCell = Split(x, \"=\")\n            LastCol = Sheet2.Cells(1, Sheet2.Columns.count).End(xlToLeft).Column\n            With Sheet2\n                FoundCell = Application.Match(DataFromCell(0), Range(Cells(1, 2), Cells(1, LastCol)), 0)\n                'Set FoundCell = .Cells.Find(What:=DataFromCell(0), after:=.Cells(1, 2), _\n                    LookIn:=xlValues, lookat:=1, searchorder:=xlByColumns, searchdirection:=xlNext, _\n                    MatchCase:=False, searchformat:=False)\n            End With\n            If Not IsError(FoundCell) Then\n                Cells(c.row + 1, FoundCell + 1).Value = DataFromCell(1)\n            End If\n            If IsError(FoundCell) Then\n\n                Cells(1, LastCol + 1).Value = DataFromCell(0)\n                Cells(c.row + 1, LastCol + 1).Value = DataFromCell(1)\n            End If\n        Next x\n    Next c\nEnd Sub\n</code></pre>\n\n<p>Only changed a few things so that it is using <code>Match</code> instead of <code>Find</code></p>\n"}, {"tags": [], "owner": {"reputation": 2608, "user_id": 3258462, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/fspw2.png?s=128&g=1", "display_name": "Vincent Tang", "link": "https://stackoverflow.com/users/3258462/vincent-tang"}, "is_accepted": true, "score": 0, "last_activity_date": 1482875085, "creation_date": 1482875085, "answer_id": 41352573, "question_id": 41146968, "link": "https://stackoverflow.com/questions/41146968/how-to-extract-excel-cell-values-delimited-with-filters/41352573#41352573", "title": "How to extract excel cell values delimited with filters?", "body": "<p>My solution below works as intended but the data wasn't as formatted as I originally thought. </p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Auto_Open()\n\nMsgBox (\"Welcome to the delimiter file set.\")\n\n\nEnd Sub\n\n'What this program does:\n'http://i.imgur.com/7MVuZLt.png\n\nSub DelimitFilter()\n\nDim curSpec As String\nDim curSpecArray() As String\nDim i As Integer, IntColCounter As Integer, iCounter As Integer, argCounter As Integer\nDim WrdString0 As String, WrdString1 As String\nDim dblColNo As Double, dblRowNo As Double\n\nWorksheets(1).Activate\n\n'Reference to cell values that always have data associated to them\nRange(\"W2\").Activate\n\n'checks for number of arguments to iterate through later\nDo\n\n    If ActiveCell.Value = \"\" Then Exit Do\n    ActiveCell.Offset(1, 0).Activate\n    argCounter = argCounter + 1\n\nLoop\n\n'Check # of arguments\nDebug.Print (argCounter)\n\n'Values to delimit\nRange(\"X2\").Activate\nIntColCounter = 1\n\n'Loop each row argument\nFor iCounter = 0 To argCounter\n\n    'Set var to activecell name\n    dblColNo = ActiveCell.Column\n    dblRowNo = ActiveCell.Row\n\n    'Grab input at active cell\n    curSpecArray() = Split(ActiveCell.Value, \";\")\n\n    'Ignore empty rows\n    If Not IsEmpty(curSpecArray) Then\n\n        'Iterate every delimited active cell value at that row\n        For i = LBound(curSpecArray) To UBound(curSpecArray)\n\n            'Checks for unique attribute name, if none exists, make one\n            WrdString0 = Split(curSpecArray(i), \"=\")(0)\n\n            'a large range X1:ZZ1 is used as there are many unique column names\n            If IsError(Application.Match(WrdString0, Range(\"X1:ZZ1\"), 0)) Then  'if NOT checks if value exists\n                Cells(1, dblColNo + IntColCounter).Value = WrdString0\n                IntColCounter = IntColCounter + 1\n            End If\n\n            'Output attribute value to matching row and column\n            WrdString1 = Trim(Split(curSpecArray(i), \"=\")(1))\n            Debug.Print (WrdString1)\n            Cells(dblRowNo, -1 + dblColNo + Application.Match(WrdString0, Range(\"X1:ZZ1\"), 0)).Value = WrdString1\n\n\n        Next i\n\n    End If\n\n    'Iterate Next row value\n    ActiveCell.Offset(1, 0).Activate\n\nNext iCounter\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2608, "user_id": 3258462, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/fspw2.png?s=128&g=1", "display_name": "Vincent Tang", "link": "https://stackoverflow.com/users/3258462/vincent-tang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 41352573, "answer_count": 2, "score": 1, "last_activity_date": 1482937009, "creation_date": 1481731253, "last_edit_date": 1481731464, "question_id": 41146968, "link": "https://stackoverflow.com/questions/41146968/how-to-extract-excel-cell-values-delimited-with-filters", "title": "How to extract excel cell values delimited with filters?", "body": "<p>In the each cell in a column I have this information in the cells:</p>\n\n<p>A1 values:</p>\n\n<p><code>Depth=standard;Size=1 section;Doors=hinged solid;Interior configuration=shelves;Compressor HP=1/2 HP;Interior finish=stainless steel;Exterior finish=stainless steel;Refrigeration=top mount self-contained\n</code></p>\n\n<p>A2 values:</p>\n\n<p><code>Top openings=  6 pan;Size=1 section;Compressor HP=1/6 HP;Style=drawers;Exterior finish=stainless steel;Interior finish=stainless steel;Refrigeration=rear mounted\n</code></p>\n\n<p>A3,A4,A5 etc all follow similar formats</p>\n\n<p>I need some method of abstracting out the following information into its own cells:</p>\n\n<p><img src=\"https://i.imgur.com/1RIRvJi.png\" alt=\"\"></p>\n\n<p>I need each semicolon separated value to be checked if there is a column name for it already, if not, make a new column and put all corresponding values where they need to be</p>\n\n<p>I thought about using text->columns and then using index/match but I haven't been able to get my match criteria to work correctly. Was going to do this for each unique column. Or do I need to use VBA?</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 1, "creation_date": 1481731173, "post_id": 41146908, "comment_id": 69496169, "body": "<code>On Error Resume Next</code>?"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1481731346, "post_id": 41146908, "comment_id": 69496286, "body": "now i feel like an idiot. please put as answer so i can mark it as such."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1481731389, "post_id": 41146908, "comment_id": 69496312, "body": "That code doesn&#39;t cause VBA to enter break-mode. Something else is going on."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1481731492, "post_id": 41146908, "comment_id": 69496383, "body": "@JohnColeman You are right! I had the code directly on the worksheet, not in a module. Worksfine if i put it in a module."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1481731639, "post_id": 41146908, "comment_id": 69496493, "body": "@rohrl77 That&#39;s odd, it works for me in a worksheet module just as well. Sometimes bug-conditions can be very hard to track down."}], "answers": [{"comments": [{"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1481786638, "post_id": 41152587, "comment_id": 69518220, "body": "I had the code in a fresh workbook with nothing else in it. It was really baffling me. The one thing I had not tried was the logical on error resume next. since neither John or Jordan opted to put an answer i&#39;ll accept yours. cheers."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1481787767, "post_id": 41152587, "comment_id": 69518761, "body": "FYI: I just tested your first statement... the one with just End.... that didn&#39;t work. I need the On Error Resume Next."}], "tags": [], "owner": {"reputation": 98, "user_id": 3230453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/COYUq.jpg?s=128&g=1", "display_name": "Ricky", "link": "https://stackoverflow.com/users/3230453/ricky"}, "is_accepted": true, "score": 1, "last_activity_date": 1481752186, "last_edit_date": 1481752186, "creation_date": 1481751281, "answer_id": 41152587, "question_id": 41146908, "link": "https://stackoverflow.com/questions/41146908/adding-control-to-worksheet-causes-cant-execute-code-in-break-mode/41152587#41152587", "title": "Adding Control to worksheet causes &quot;Can&#39;t execute code in break mode&quot;", "body": "<p>I am not sure this is the safest solution but you will not get a error since adding \"End\" kills all macros. The only time i ever really use it is on progressbars. I would dig harder on the real issue using \"On error resume next\" is a bandaid. If you do use it make sure to restore your default error handling with \"On error goto 0\". </p>\n\n<pre><code>Sub DropCheckboxOnSheet()\n   ActiveSheet.OLEObjects.Add ClassType:=\"Forms.CheckBox.1\"\n End\nEnd Sub\n</code></pre>\n\n<p>e.g.</p>\n\n<pre><code>Sub DropCheckboxOnSheet()\n On error resume next\n   ActiveSheet.OLEObjects.Add ClassType:=\"Forms.CheckBox.1\"\n On error goto 0\nEnd Sub\n</code></pre>\n\n<p>Changing the name of the sub might fix your issue.  If you have the same sub in another open workbook it could be throwing the error.</p>\n"}], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 413, "favorite_count": 0, "accepted_answer_id": 41152587, "answer_count": 1, "score": 0, "last_activity_date": 1481752186, "creation_date": 1481731061, "last_edit_date": 1531164843, "question_id": 41146908, "link": "https://stackoverflow.com/questions/41146908/adding-control-to-worksheet-causes-cant-execute-code-in-break-mode", "title": "Adding Control to worksheet causes &quot;Can&#39;t execute code in break mode&quot;", "body": "<p>I'm trying to add a checkbox to my worksheet using code:</p>\n\n<pre><code>Sub DropCheckboxOnSheet()\n   ActiveSheet.OLEObjects.Add ClassType:=\"Forms.CheckBox.1\"\nEnd Sub\n</code></pre>\n\n<p>When I run this code, I do get a checkbox added to the worksheet, however I also receive the message that Excel \"Can't execute code in break mode\". I get that my code adds an object to the object model and that this is why it breaks, but it also offeres me the option of continuing.</p>\n\n<p><strong>How do I tell VBA to continue after adding the object?</strong></p>\n\n<p>What i've tried:\nAdding <code>DisplayAlerts=False</code> does not work.\nMSDN offers no help either:<a href=\"https://msdn.microsoft.com/en-us/library/office/gg264133.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/gg264133.aspx</a></p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 739, "user_id": 2259735, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b5c3cfaaaae0be97a5d9a22e702202e4?s=128&d=identicon&r=PG", "display_name": "jonplaca", "link": "https://stackoverflow.com/users/2259735/jonplaca"}, "is_accepted": false, "score": 1, "last_activity_date": 1481730831, "creation_date": 1481730831, "answer_id": 41146824, "question_id": 41146766, "link": "https://stackoverflow.com/questions/41146766/ms-access-vba-onclick-event-error-method-or-data-member-not-found/41146824#41146824", "title": "MS Access + VBA - OnClick() event error: &quot;Method or Data Member not found&quot;", "body": "<p>Nevermind, I am a dummy.</p>\n\n<p>Due to the similar naming convention of the button name and the macro, MS Access was throwing an error.</p>\n\n<p>I've updated the button name to \"reviewCatalogs\" (from \"reviewCatalog\"). After updating the button name and the Public Sub to <code>Public Sub reviewCatalogs_Click()</code>, the script worked. </p>\n"}], "owner": {"reputation": 739, "user_id": 2259735, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b5c3cfaaaae0be97a5d9a22e702202e4?s=128&d=identicon&r=PG", "display_name": "jonplaca", "link": "https://stackoverflow.com/users/2259735/jonplaca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 473, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481730831, "creation_date": 1481730674, "question_id": 41146766, "link": "https://stackoverflow.com/questions/41146766/ms-access-vba-onclick-event-error-method-or-data-member-not-found", "title": "MS Access + VBA - OnClick() event error: &quot;Method or Data Member not found&quot;", "body": "<p><strong>OBJECTIVE</strong></p>\n\n<p>Create a dashboard for the Marketing team to pull in product information (e.g product, customer, inventory, sales forecasts, etc.) for further analysis.</p>\n\n<p><strong>APPROACH</strong></p>\n\n<ol>\n<li>Access Product, Inventory, and Sales databases.</li>\n<li>Create Query to join Product, Inventory, and Sales details.</li>\n<li>Create a simple UI for the Marketing team to interact with queried results.</li>\n</ol>\n\n<p><strong>CODE</strong></p>\n\n<p><em>simple script for the Marketing team to review a table, prior to query execution</em></p>\n\n<pre><code>Public Sub reviewCatalog()\nDoCmd.OpenTable \"Table - Active Customer Catalog\", acViewNormal\nDoCmd.OpenTable \"Table - Active Product Catalog\", acViewNormal\nEnd Sub\n</code></pre>\n\n<p><em>call <code>reviewCatalog()</code> script from a button <code>OnClick()</code> event that is presented in a simple UI/Form</em></p>\n\n<pre><code>Public Sub reviewCatalog_Click()\nCall reviewCatalog.reviewCatalog\nEnd Sub\n</code></pre>\n\n<p><strong>ERROR</strong></p>\n\n<blockquote>\n  <p>Compile Error: Methor or data member not found</p>\n</blockquote>\n\n<p><strong>NOTES</strong></p>\n\n<ul>\n<li>When the macro is run independently of a button click, the script runs without error.</li>\n<li>I've confirmed that the button assigned to the macro (called \"reviewCatalog\") is handling an \"Event Procedure\" for an OnClick event.</li>\n</ul>\n\n<p><strong>QUESTIONS</strong></p>\n\n<ol>\n<li>What is the nature of the error being thrown? Why is it only occuring on the reviewCatalog_onClick() event (as opposed to other, similar buttons &amp; scripts)?</li>\n</ol>\n"}, {"tags": ["sql", "sql-server", "excel", "vba", "stored-procedures"], "answers": [{"tags": [], "owner": {"reputation": 140, "user_id": 3828905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JzFtQ.jpg?s=128&g=1", "display_name": "Roie R", "link": "https://stackoverflow.com/users/3828905/roie-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1481795366, "creation_date": 1481795366, "answer_id": 41161066, "question_id": 41146194, "link": "https://stackoverflow.com/questions/41146194/running-a-stored-proc-via-excel-connection-works-in-ssms-but-not-via-the-vba-m/41161066#41161066", "title": "Running a Stored Proc via Excel Connection - works in SSMS but not via the VBA macro", "body": "<p>In my experience if you generate the database connection in VBA, (there are <a href=\"https://stackoverflow.com/questions/1120674/accessing-sql-database-in-excel-vba\">multiple previous questions</a> about that), rather than rely on an existing workbook connection, your stored procedure will execute regardless of what it returns.</p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 5815299, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156592638250438/picture?type=large", "display_name": "Dan", "link": "https://stackoverflow.com/users/5815299/dan"}, "is_accepted": true, "score": 0, "last_activity_date": 1481881970, "creation_date": 1481881970, "answer_id": 41181565, "question_id": 41146194, "link": "https://stackoverflow.com/questions/41146194/running-a-stored-proc-via-excel-connection-works-in-ssms-but-not-via-the-vba-m/41181565#41181565", "title": "Running a Stored Proc via Excel Connection - works in SSMS but not via the VBA macro", "body": "<p>The problem I have is that by merely creating the connection without specifying a cell to return data to, nothing happens.</p>\n\n<p>In addition, if I specify a cell to return data to, nothing happens unless I use my 'fix' which is to create an empty table at the end of the SP.</p>\n"}], "owner": {"reputation": 3, "user_id": 5815299, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156592638250438/picture?type=large", "display_name": "Dan", "link": "https://stackoverflow.com/users/5815299/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 496, "favorite_count": 0, "accepted_answer_id": 41181565, "answer_count": 2, "score": 0, "last_activity_date": 1481881970, "creation_date": 1481729055, "last_edit_date": 1481732601, "question_id": 41146194, "link": "https://stackoverflow.com/questions/41146194/running-a-stored-proc-via-excel-connection-works-in-ssms-but-not-via-the-vba-m", "title": "Running a Stored Proc via Excel Connection - works in SSMS but not via the VBA macro", "body": "<p>I've successfully created many connections in an Excel file to a Database so the issue is directly related only to this particular scenario. Server is 2012, Excel is 2013.</p>\n\n<p>I have the following SP:</p>\n\n<pre><code>IF OBJECT_ID('usp_LockUnlockCustomer', 'P') IS NOT NULL\n    DROP PROCEDURE usp_LockUnlockCustomer\nGO\nCREATE PROCEDURE usp_LockUnlockCustomer \n    @Lock AS CHAR(10), @Id AS nvarchar(50), @LockedBy AS nvarchar(50)=null\nAS BEGIN\nSET NOCOUNT ON;\nIF @Lock = 'Lock'\n    INSERT INTO IO_Call_DB..IdLock (Id, LockedBy, LockedDtTm)\n    VALUES(@Id,@LockedBy,GETDATE())\n;\nIF @Lock = 'Unlock'\n    DELETE FROM IO_Call_DB..IdLock\n    WHERE Id = @Id\n;\nEND;\n--EXEC usp_LockUnlockCustomer 'Lock','123456789', 'Test User'\n</code></pre>\n\n<p>The above SP is called via some VBA as follows:</p>\n\n<pre><code>With ActiveWorkbook.Connections(\"usp_LockUnlockCustomer\").OLEDBConnection\n    .CommandText = \"EXECUTE dbo.usp_LockUnlockCustomer '\" &amp; bLock &amp; \"','\" &amp; Id &amp; \"','\" &amp; LockedBy &amp; \"'\"\nEnd With\n</code></pre>\n\n<p>I have tested the string and the string is formatted correct &amp; contains all required data.</p>\n\n<p>The connection between Excel and SQL is created via \"Data > From Other Sources > From SQL Server\", it's a fairly standard process which has worked for all other SP's and general queries.</p>\n\n<p>I think, because this connection is not returning data to Excel (I only set up the connection rather than specifying that Excel should return data to a cell) that this may be the issue.</p>\n\n<p>Has anyone experienced this issue before?</p>\n\n<p>EDIT1: I have resolved the issue but it's not a particularly great outcome. Some help would be appreciated.\nTo resolve the issue, you have to include a \"select * from\" process at the end of the stored procedure and also tell Excel to output the data to a range within the workbook. This allows the .Refresh portion of the VBA to do whatever it does &amp; submit the SP to SQL.</p>\n\n<p>Essentially, you're being forced to create a data table - but I don't want any data, I just want to submit a command.</p>\n\n<p>So, how do you submit a command and not have Excel require that you 1) explicitly state where the data should be put 2) include a SELECT statement within the stored procedure when I don't require any data to be returned.</p>\n\n<p>My fix was to \"select top 0\" from the table, at least that way the data table being output to Excel won't grow.</p>\n"}, {"tags": ["excel", "vba", "matlab", "com", "activex"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7049544, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-s3sxepNziyo/AAAAAAAAAAI/AAAAAAAAATo/VPoVvtOqKBo/photo.jpg?sz=128", "display_name": "Polina", "link": "https://stackoverflow.com/users/7049544/polina"}, "edited": false, "score": 0, "creation_date": 1481735108, "post_id": 41147753, "comment_id": 69498786, "body": "OMG This actually works! You are so awesome!!! I have no idea how you figured it out - I read the same documentation but I couldn&#39;t find the correct syntax. Million thanks&#39;!!!!!"}], "tags": [], "owner": {"reputation": 60801, "user_id": 670206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08d285c964555cd9953d70981fd03f27?s=128&d=identicon&r=PG", "display_name": "Suever", "link": "https://stackoverflow.com/users/670206/suever"}, "is_accepted": true, "score": 1, "last_activity_date": 1481733663, "creation_date": 1481733663, "answer_id": 41147753, "question_id": 41145817, "link": "https://stackoverflow.com/questions/41145817/paste-special-transpose-syntax-in-matlab-using-actxserver/41147753#41147753", "title": "Paste Special Transpose Syntax in Matlab using ActXServer", "body": "<p>The documentation for <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838010.aspx\" rel=\"nofollow noreferrer\"><code>PasteSpecial</code></a> has four input arguments to indicate the parameters of the paste operation. As you can see, the fourth option indicates whether to transpose the data or not.</p>\n\n<pre><code>new_sheet.PasteSpecial(NaN, NaN, NaN, true);\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7049544, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-s3sxepNziyo/AAAAAAAAAAI/AAAAAAAAATo/VPoVvtOqKBo/photo.jpg?sz=128", "display_name": "Polina", "link": "https://stackoverflow.com/users/7049544/polina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "accepted_answer_id": 41147753, "answer_count": 1, "score": 0, "last_activity_date": 1486756103, "creation_date": 1481727949, "last_edit_date": 1486756103, "question_id": 41145817, "link": "https://stackoverflow.com/questions/41145817/paste-special-transpose-syntax-in-matlab-using-actxserver", "title": "Paste Special Transpose Syntax in Matlab using ActXServer", "body": "<p>I am working on a code in Matlab that will open excel spreadsheet, copy a certain range, and paste it in a new sheet transposing my range in the process. I am completely stuck on the PasteSpecial method and cannot figure out how to make it transpose my data. I've tried everything I could think of: tried VBA-like syntax (Transpose=True), tried (Transpose, 1), tried ([],[],[],1), tried obj.Transpose(with all kinds of variations in the brackets)... and all kinds of other stuff to no avail. Please help me if anyone had done this before. Below if my simplified code in case it's needed. <strong>Thank you in advance!</strong></p>\n\n<pre><code>   Excel = actxGetRunningServer('excel.application'); \n   set(Excel, 'Visible', 1);\n\n   Workbooks = Excel.Workbooks;\n   Workbook = Excel.Workbooks.Open('C:\\Users\\...test.xlsx');\n   curr_sheet = get(Workbook,'ActiveSheet');\n   rngObj = ('A1:C3')\n   rngObj.Copy\n   Sheets = Excel.ActiveWorkBook.Sheets;\n   new_sheet = Sheets.Add;\n   new_sheet.PasteSpecial; %This is where I am stuck!\n</code></pre>\n"}, {"tags": ["vba", "excel", "combobox"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1481728953, "post_id": 41145577, "comment_id": 69494703, "body": "Look up format control for your combo box and your issue will be solved"}, {"owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "edited": false, "score": 0, "creation_date": 1481729009, "post_id": 41145577, "comment_id": 69494743, "body": "I&#39;m not sure where <code>Sheet2!$D$2</code> comes into this. What would you expect to happen if you selected a different option in your ComboBox, say the one that relates to <code>A2</code>?"}, {"owner": {"reputation": 3, "user_id": 7297084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2a7ed254844723c2fb7a70bc05c363e?s=128&d=identicon&r=PG&f=1", "display_name": "Bleddyn Davies", "link": "https://stackoverflow.com/users/7297084/bleddyn-davies"}, "edited": false, "score": 0, "creation_date": 1481729321, "post_id": 41145577, "comment_id": 69494938, "body": "A1 on Sheet1 relates to D2 on Sheet2 A2 relates to D3 A3 to D4, and so on"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1481729445, "post_id": 41145577, "comment_id": 69495019, "body": "but why <a href=\"https://i.kinja-img.com/gawker-media/image/upload/s--lQ4fx0tr--/c_scale,f_auto,fl_progressive,q_80,w_800/wnfyyiakckla7hs0ptqb.jpg\" rel=\"nofollow noreferrer\">i.kinja-img.com/gawker-media/image/upload/s--lQ4fx0tr--/&hellip;</a>"}, {"owner": {"reputation": 3, "user_id": 7297084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2a7ed254844723c2fb7a70bc05c363e?s=128&d=identicon&r=PG&f=1", "display_name": "Bleddyn Davies", "link": "https://stackoverflow.com/users/7297084/bleddyn-davies"}, "edited": false, "score": 0, "creation_date": 1481729657, "post_id": 41145577, "comment_id": 69495130, "body": "Ok... I have a load of raw data on Sheet2 (answers to questions in this case). On Sheet1 I have a combo box with the questions in. When I select a question from the combo box I want the corresponding answer (from Sheet2) to appear in the linked cell which is G13."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7297084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2a7ed254844723c2fb7a70bc05c363e?s=128&d=identicon&r=PG&f=1", "display_name": "Bleddyn Davies", "link": "https://stackoverflow.com/users/7297084/bleddyn-davies"}, "edited": false, "score": 0, "creation_date": 1481729693, "post_id": 41146391, "comment_id": 69495153, "body": "Thank you, at least someone was trying to help!"}], "tags": [], "owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "is_accepted": true, "score": 0, "last_activity_date": 1481729623, "creation_date": 1481729623, "answer_id": 41146391, "question_id": 41145577, "link": "https://stackoverflow.com/questions/41145577/combobox-linked-cell-display-in-excel/41146391#41146391", "title": "ComboBox linked cell display in excel", "body": "<p>You can't do this directly - the linked cell has to hold the value of the ComboBox. However, if you don't mind an additional step, then the following formula in any other cell on <code>Sheet1</code> will give the result you want:</p>\n\n<pre><code>=INDEX(Sheet2!$D$2:$D$115,MATCH($G$13,$A$1:$A$114,0))\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7297084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2a7ed254844723c2fb7a70bc05c363e?s=128&d=identicon&r=PG&f=1", "display_name": "Bleddyn Davies", "link": "https://stackoverflow.com/users/7297084/bleddyn-davies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1059, "favorite_count": 0, "accepted_answer_id": 41146391, "answer_count": 1, "score": 0, "last_activity_date": 1481729623, "creation_date": 1481727265, "last_edit_date": 1481728437, "question_id": 41145577, "link": "https://stackoverflow.com/questions/41145577/combobox-linked-cell-display-in-excel", "title": "ComboBox linked cell display in excel", "body": "<p>Within <code>Workbook1</code>, I have 2 Sheets, for simplicity I'll call them <code>Sheet1</code> and <code>Sheet2</code>.</p>\n\n<p>On <code>Sheet1</code> I have a Combo Box called <code>ComboBox1</code>, the Combo Box has values in it from cells <code>A1:A114</code>. The linked cell for the Combo Box is <code>G13</code> on <code>Sheet1</code>.</p>\n\n<p>My issue is, when I pick a value from the Combo Box, I want a value to appear in the linked cell from <code>Sheet2</code>.</p>\n\n<p>For example, if I select the value from <code>A1</code> in <code>Sheet1</code>, then the value of <code>Sheet2!$D$2</code> appears in the linked cell <code>(G13)</code>.</p>\n\n<p>Any thoughts?</p>\n"}, {"tags": ["excel", "vba", "loops", "for-loop"], "comments": [{"owner": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 0, "creation_date": 1481726457, "post_id": 41145237, "comment_id": 69492957, "body": "What do you mean by <b><i>...need to find a way to put this into 1 line...</i></b>?"}, {"owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "reply_to_user": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 0, "creation_date": 1481727073, "post_id": 41145237, "comment_id": 69493445, "body": "Sorry for the lack of clarity, will update above @FDavidov"}], "answers": [{"comments": [{"owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 1, "creation_date": 1481728319, "post_id": 41145575, "comment_id": 69494286, "body": "Works Perfectly! I knew there must be a way, Need to study Arrays more!"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 4, "last_activity_date": 1481727264, "creation_date": 1481727264, "answer_id": 41145575, "question_id": 41145237, "link": "https://stackoverflow.com/questions/41145237/how-can-i-use-for-loop-correctly-for-multiple-conditions/41145575#41145575", "title": "How can i use For Loop correctly for multiple conditions", "body": "<pre><code>codes = Array(\"S\", \"YS\")\nFor i = 2 To 26\n    For j = 0 to UBound(codes)\n        Sheets(\"Sheet Name\").Cells(11+j, i).Formula = Application.WorksheetFunction.CountIfs(Sheets(\"Sheet1\").Range(\"F8:F\" &amp; n), Sheets(\"Sheet2\").Range(Chr(64 + i) &amp; \"8\"), Sheets(\"Sheet1\").Range(\"AC8:AC\" &amp; n), codes(j))\n    Next j\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "is_accepted": false, "score": -1, "last_activity_date": 1481728861, "creation_date": 1481728861, "answer_id": 41146122, "question_id": 41145237, "link": "https://stackoverflow.com/questions/41145237/how-can-i-use-for-loop-correctly-for-multiple-conditions/41146122#41146122", "title": "How can i use For Loop correctly for multiple conditions", "body": "<p>The next step in my long list of issues and improvements was to simulate this but for a SUMIFS, as i was looking at cost data.</p>\n\n<p>Please see below and i hope others can benefit from this and perhaps improve!</p>\n\n<pre><code>With Sheets(\"Operations Schedules -Summary\")\n    For i = 2 To 26\n        For j = 0 To UBound(codes)\n            .Cells(37 + j, i).Formula = Application.WorksheetFunction.SumIfs(Sheets(\"Sheet1\").Range(\"AD8:AD\" &amp; n), Sheets(\"Sheet1\").Range(\"F8:F\" &amp; n), Sheets(\"Sheet2\").Range(Chr(64 + i) &amp; \"8\"), Sheets(\"Sheet1\").Range(\"AC8:AC\" &amp; n), codes(j))\n        Next j\n    Next i\nEnd With\n</code></pre>\n\n<p>Some basic syntax of SUMIFS: </p>\n\n<ul>\n<li>The first part is to specify the sum range</li>\n<li>The Second part(s) is to specify the criteria range, and then the critera</li>\n<li>This goes on for 197 criterias i believe!</li>\n</ul>\n\n<p>For any Novices looking at the various qualifications of variables above:</p>\n\n<ul>\n<li>i,j, and n are variables of type long. n is used  to count (dynamically), the number of rows in the target dataset</li>\n</ul>\n"}], "owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 41145575, "answer_count": 2, "score": 1, "last_activity_date": 1481728861, "creation_date": 1481726235, "last_edit_date": 1481727134, "question_id": 41145237, "link": "https://stackoverflow.com/questions/41145237/how-can-i-use-for-loop-correctly-for-multiple-conditions", "title": "How can i use For Loop correctly for multiple conditions", "body": "<p>I have the following loop below:</p>\n\n<pre><code>With Sheets(\"Sheet Name\")\n    For i = 2 To 26\n        .Cells(11, i).Formula = Application.WorksheetFunction.CountIfs(Sheets(\"Sheet1\").Range(\"F8:F\" &amp; n), Sheets(\"Sheet2\").Range(Chr(64 + i) &amp; \"8\"), Sheets(\"Sheet1\").Range(\"AC8:AC\" &amp; n), \"S\")\n        .Cells(12, i).Formula = Application.WorksheetFunction.CountIfs(Sheets(\"Sheet1\").Range(\"F8:F\" &amp; n), Sheets(\"Sheet2\").Range(Chr(64 + i) &amp; \"8\"), Sheets(\"Sheet1\").Range(\"AC8:AC\" &amp; n), \"YS\")            \n    Next i\nEnd With\n</code></pre>\n\n<p>The last condition at the end of each line changes by a string i.e. \"S\", \"YS\". I want to avoid having to use 1 line for each \"S\" and \"YS\" and so on i.e. there will be many lines for each criteria. I also then want to add another for loop that deals with the rows</p>\n"}, {"tags": ["vba", "excel", "excel-addins"], "answers": [{"comments": [{"owner": {"reputation": 251, "user_id": 298138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cea81305807e3fea0f901d91f227f00c?s=128&d=identicon&r=PG", "display_name": "Bj&#246;rn Buckwalter", "link": "https://stackoverflow.com/users/298138/bj%c3%b6rn-buckwalter"}, "edited": false, "score": 1, "creation_date": 1561734469, "post_id": 41151266, "comment_id": 100172784, "body": "FYI this solution makes Excel ask if I want to save my xlam every time I quit Excel. Probably due to the <code>ThisWorkbook.IsAddin</code> toggling. In some cases the screen also flashes so the <code>Application.ScreenUpdating = False</code> doesn&#39;t seem to work consistently."}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": false, "score": 1, "last_activity_date": 1481745908, "creation_date": 1481745908, "answer_id": 41151266, "question_id": 41144765, "link": "https://stackoverflow.com/questions/41144765/when-to-set-macrooptions-for-excel-addin/41151266#41151266", "title": "When to set MacroOptions for Excel Addin", "body": "<p>Almost there. Just convert the add-in as normal workbook, set options and reset as add-in. See code comments for details.</p>\n\n<pre><code>Public Sub MyRegister()\n    Application.ScreenUpdating = False '/ Turn it off to avoid flicker.\n    ThisWorkbook.IsAddin = False '/ Make the add-in workbook as normal, hence unhiding sheets\n    Application.MacroOptions Macro:=\"MyFunctionOne\", Description:=\"Returns 1\", Category:=\"My New Category\"\n    Application.MacroOptions Macro:=\"MyFunctionTwo\", Description:=\"Returns 2\", Category:=\"My New Category\"\n    Application.MacroOptions Macro:=\"MyFunctionThree\", Description:=\"Returns 3\", Category:=\"My New Category\"\n    ThisWorkbook.IsAddin = True '/ Set back as add-in, hides everything.\n    Application.ScreenUpdating = True '/ Turn on screen updating\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 7297934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f43da431a6c08b442bfb5eb10169afc5?s=128&d=identicon&r=PG&f=1", "display_name": "jerryact", "link": "https://stackoverflow.com/users/7297934/jerryact"}, "is_accepted": true, "score": 3, "last_activity_date": 1481751525, "creation_date": 1481751525, "answer_id": 41152653, "question_id": 41144765, "link": "https://stackoverflow.com/questions/41144765/when-to-set-macrooptions-for-excel-addin/41152653#41152653", "title": "When to set MacroOptions for Excel Addin", "body": "<p>Instead of using <code>Workbook_Open</code>, you can do this:</p>\n\n<pre><code>Private WithEvents App As Application\n\nPrivate Sub App_WorkbookActivate(ByVal Wb As Workbook)\n    MyRegister\nEnd Sub\n\nPrivate Sub Workbook_Open()\n    Set App = Application\nEnd Sub\n</code></pre>\n\n<p>That way it'll run when a workbook is active, and you'll avoid the error you're getting.</p>\n"}], "owner": {"reputation": 45, "user_id": 7001768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34e52b9c753891fdda481d2c39dbfcbc?s=128&d=identicon&r=PG&f=1", "display_name": "carole1", "link": "https://stackoverflow.com/users/7001768/carole1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1321, "favorite_count": 1, "accepted_answer_id": 41152653, "answer_count": 2, "score": 3, "last_activity_date": 1481751525, "creation_date": 1481724902, "question_id": 41144765, "link": "https://stackoverflow.com/questions/41144765/when-to-set-macrooptions-for-excel-addin", "title": "When to set MacroOptions for Excel Addin", "body": "<p>I'm making an Excel addin. It consists of a few functions in a module like this:</p>\n\n<pre><code>Public Function MyFunctionOne(X As Range, Y As Double) As Double\n    MyFunctionOne = 1 'Example\nEnd Function\nPublic Function MyFunctionTwo(X As Range, Y As Double) As Double\n    MyFunctionTwo =  2 'Example\nEnd Function\nPublic Function MyFunctionThree(X As Range, Y As Double) As Double\n    MyFunctionThree =  3 'Example\nEnd Function\n</code></pre>\n\n<p>I've saved the whole thing as a <code>.xlam</code> Excel Addin. So those functions are available every-time I start a new spread sheet.</p>\n\n<p>I recently learned that I can assign my functions to a category, which is really helpful. This makes them easy to use from the Excel function wizard. I use the following code to assign categories:</p>\n\n<pre><code>Public Sub MyRegister()\n    Application.MacroOptions Macro:=\"MyFunctionOne\", Description:=\"Returns 1\", Category:=\"My New Category\"\n    Application.MacroOptions Macro:=\"MyFunctionTwo\", Description:=\"Returns 2\", Category:=\"My New Category\"\n    Application.MacroOptions Macro:=\"MyFunctionThree\", Description:=\"Returns 3\", Category:=\"My New Category\"\nEnd Sub\n</code></pre>\n\n<p>Now if I manually run the macro, <code>MyRegister</code>, the functions all get the new category and it works very well. But I don't want to have to manually run the macro each time I start a new spreadsheet. My questions is, how can the addin do this automatically for each new spreadsheet?</p>\n\n<p>I tried putting it in the <code>Workbook_Open</code> of the addin like this:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Call MyRegister\nEnd Sub\n</code></pre>\n\n<p>The problem is that it doesn't work. Whenever Excel starts, I get the error message: \"<a href=\"https://i.stack.imgur.com/Y7v9q.png\" rel=\"nofollow noreferrer\">Cannot edit a macro on a hidden workbook.</a>\" So the <code>Workbook_Open</code> event seems to be the wrong place to do this.</p>\n\n<p>So my question is, how do I run the <code>MyRegister</code> macro at the proper time to assign my addin functions to categories?</p>\n\n<p>By the way, I really don't want to make a template. I really to keep this as only and addin.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2034, "user_id": 2486496, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Rpd3r.jpg?s=128&g=1", "display_name": "gravity", "link": "https://stackoverflow.com/users/2486496/gravity"}, "edited": false, "score": 1, "creation_date": 1481724230, "post_id": 41144539, "comment_id": 69491546, "body": "Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>, and include the code in the question (not a screenshot)."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4064868, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9c6df9436475bb2598b6bd3f912263b7?s=128&d=identicon&r=PG&f=1", "display_name": "Deathkamp", "link": "https://stackoverflow.com/users/4064868/deathkamp"}, "edited": false, "score": 0, "creation_date": 1481726464, "post_id": 41145177, "comment_id": 69492960, "body": "I dont understand what you mean by reference what columns in what sheets? In terms of code? since I was planning on making this button universal meaning it doesn&#39;t matter the table size it will always make new columns until the table row ends, I feel like if putting in specific sheets and columns in the code will not make it universal? Since if those changes I have to change the code as weLL?"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 35, "user_id": 4064868, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9c6df9436475bb2598b6bd3f912263b7?s=128&d=identicon&r=PG&f=1", "display_name": "Deathkamp", "link": "https://stackoverflow.com/users/4064868/deathkamp"}, "edited": false, "score": 0, "creation_date": 1481726565, "post_id": 41145177, "comment_id": 69493023, "body": "@Deathkamp yea that&#39;s fine but you still need to fully qualify what you&#39;re wanting to change. With out specifying in some way what exactly needs to be changed the compiler wont know the difference between sheet1 in book1 from sheet2 in book2 if that makes sense."}, {"owner": {"reputation": 35, "user_id": 4064868, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9c6df9436475bb2598b6bd3f912263b7?s=128&d=identicon&r=PG&f=1", "display_name": "Deathkamp", "link": "https://stackoverflow.com/users/4064868/deathkamp"}, "edited": false, "score": 0, "creation_date": 1481726876, "post_id": 41145177, "comment_id": 69493301, "body": "Also I get a type mismatch when i run the code? from   ColumnNum = x"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 35, "user_id": 4064868, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9c6df9436475bb2598b6bd3f912263b7?s=128&d=identicon&r=PG&f=1", "display_name": "Deathkamp", "link": "https://stackoverflow.com/users/4064868/deathkamp"}, "edited": false, "score": 0, "creation_date": 1481726944, "post_id": 41145177, "comment_id": 69493351, "body": "Make sure your x is declared as variant at the top"}, {"owner": {"reputation": 35, "user_id": 4064868, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9c6df9436475bb2598b6bd3f912263b7?s=128&d=identicon&r=PG&f=1", "display_name": "Deathkamp", "link": "https://stackoverflow.com/users/4064868/deathkamp"}, "edited": false, "score": 0, "creation_date": 1481727057, "post_id": 41145177, "comment_id": 69493431, "body": "yup  Dim x As Variant    and I even put option exlicit on top in the general tab and still same error?"}, {"owner": {"reputation": 35, "user_id": 4064868, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9c6df9436475bb2598b6bd3f912263b7?s=128&d=identicon&r=PG&f=1", "display_name": "Deathkamp", "link": "https://stackoverflow.com/users/4064868/deathkamp"}, "edited": false, "score": 0, "creation_date": 1481728360, "post_id": 41145177, "comment_id": 69494315, "body": "this is code: <a href=\"http://imgur.com/a/dzsmE\" rel=\"nofollow noreferrer\">imgur.com/a/dzsmE</a>          I get an error on the private sub commandbutton2 of variable being undefined and then the <b>shift:=xlShiftRight</b> is highlighted"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 35, "user_id": 4064868, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9c6df9436475bb2598b6bd3f912263b7?s=128&d=identicon&r=PG&f=1", "display_name": "Deathkamp", "link": "https://stackoverflow.com/users/4064868/deathkamp"}, "edited": false, "score": 0, "creation_date": 1481728673, "post_id": 41145177, "comment_id": 69494526, "body": "shift right isnt a built in function. I changed to xlRight. see edited posted"}, {"owner": {"reputation": 35, "user_id": 4064868, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9c6df9436475bb2598b6bd3f912263b7?s=128&d=identicon&r=PG&f=1", "display_name": "Deathkamp", "link": "https://stackoverflow.com/users/4064868/deathkamp"}, "edited": false, "score": 0, "creation_date": 1481741721, "post_id": 41145177, "comment_id": 69502404, "body": "Ok it works but it does not generate the lines or boxes around the cells so that you are aware that its an extension of the table? Any Ideas? here is what I mean: <a href=\"http://imgur.com/a/GtvKb\" rel=\"nofollow noreferrer\">imgur.com/a/GtvKb</a>  notice the I column there are no lines??"}, {"owner": {"reputation": 35, "user_id": 4064868, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9c6df9436475bb2598b6bd3f912263b7?s=128&d=identicon&r=PG&f=1", "display_name": "Deathkamp", "link": "https://stackoverflow.com/users/4064868/deathkamp"}, "edited": false, "score": 0, "creation_date": 1481747167, "post_id": 41145177, "comment_id": 69505244, "body": "Doug you there?"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 35, "user_id": 4064868, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9c6df9436475bb2598b6bd3f912263b7?s=128&d=identicon&r=PG&f=1", "display_name": "Deathkamp", "link": "https://stackoverflow.com/users/4064868/deathkamp"}, "edited": false, "score": 0, "creation_date": 1481749044, "post_id": 41145177, "comment_id": 69506257, "body": "If you want to learn how to extend the lines, then you&#39;ll need to post in another question. HOwever you can easily google &quot;add lines to excel sheet vba&quot;"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 35, "user_id": 4064868, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9c6df9436475bb2598b6bd3f912263b7?s=128&d=identicon&r=PG&f=1", "display_name": "Deathkamp", "link": "https://stackoverflow.com/users/4064868/deathkamp"}, "edited": false, "score": 0, "creation_date": 1481749092, "post_id": 41145177, "comment_id": 69506290, "body": "see this <a href=\"http://stackoverflow.com/questions/13121425/border-around-each-cell-in-a-range\" title=\"border around each cell in a range\">stackoverflow.com/questions/13121425/&hellip;</a>"}, {"owner": {"reputation": 35, "user_id": 4064868, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9c6df9436475bb2598b6bd3f912263b7?s=128&d=identicon&r=PG&f=1", "display_name": "Deathkamp", "link": "https://stackoverflow.com/users/4064868/deathkamp"}, "edited": false, "score": 0, "creation_date": 1481753922, "post_id": 41145177, "comment_id": 69508403, "body": "The issue with the range is that the user defines it, so I cant hard-code the range to add lines to a specific cell range? Like in the link you showed me, and google only shows how to do rows and the same hard-coding the range?"}, {"owner": {"reputation": 35, "user_id": 4064868, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9c6df9436475bb2598b6bd3f912263b7?s=128&d=identicon&r=PG&f=1", "display_name": "Deathkamp", "link": "https://stackoverflow.com/users/4064868/deathkamp"}, "edited": false, "score": 0, "creation_date": 1481754362, "post_id": 41145177, "comment_id": 69508583, "body": "ok I am getting really confused now. So tell me if I am wrong, in order to get the column the user inputs to have lines, I need to first pass the user&#39;s input to the UsedRange, then I need to call the range function and have its paramter be UsedRange? If I am right may I get an example of where to start?"}, {"owner": {"reputation": 35, "user_id": 4064868, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9c6df9436475bb2598b6bd3f912263b7?s=128&d=identicon&r=PG&f=1", "display_name": "Deathkamp", "link": "https://stackoverflow.com/users/4064868/deathkamp"}, "edited": false, "score": 0, "creation_date": 1481769794, "post_id": 41145177, "comment_id": 69512962, "body": "Doug? HELP Please. Ive spent all day trying to figure this out and I cannot. Even made a new post  <a href=\"http://stackoverflow.com/questions/41154245/button-generates-the-columns-from-user-input-but-not-the-cell-lines\" title=\"button generates the columns from user input but not the cell lines\">stackoverflow.com/questions/41154245/&hellip;</a>"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 35, "user_id": 4064868, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9c6df9436475bb2598b6bd3f912263b7?s=128&d=identicon&r=PG&f=1", "display_name": "Deathkamp", "link": "https://stackoverflow.com/users/4064868/deathkamp"}, "edited": false, "score": 0, "creation_date": 1481814800, "post_id": 41145177, "comment_id": 69535382, "body": "i created a room for us to take this offline. i will be here but be patient b/c im at work  <a href=\"http://chat.stackoverflow.com/rooms/130706/dzcoats\">chat.stackoverflow.com/rooms/130706/dzcoats</a>"}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": true, "score": 1, "last_activity_date": 1506016176, "last_edit_date": 1506016176, "creation_date": 1481726073, "answer_id": 41145177, "question_id": 41144539, "link": "https://stackoverflow.com/questions/41144539/button-to-add-column/41145177#41145177", "title": "Button to add column?", "body": "<p>This will get you started:</p>\n\n<pre><code>    Dim x As Variant\n    Dim ColumnNum%\n    x = InputBox(\"Enter a column that you want to add: \", \"What column?\")\n    If x = \"\" Then Exit Sub\n    ColumnNum = x\n    ThisWorkbook.Sheets(\"Sheet1\").Columns(ColumnNum).Insert shift:=xlRight\n\n    ThisWorkbook.Sheets(\"Sheet1\").Columns(ColumnNum - 1).Copy\n\n    'THe line above doesnt make any sense whatsoever. \n     'Im not going to try and trouble shoot it but it seems like you dont understand how to\n     ' properly scuplt things. Youll notice i changed how you strucutred the .copy part. \n     'THe part that doesnt make sense to me is the Range section. \n\n    ThisWorkbook.Sheets(\"Sheet1\").Columns(ColumnNum).ClearContents\n</code></pre>\n\n<p>There were a few things wrong with your code.</p>\n\n<ol>\n<li>You need to put Option Explicit at the top of your code. You didnt declare your variables. </li>\n<li>you inpout box needs to be declared as variant</li>\n<li>When i played around with this its clear you didnt fully reference what columns in what sheets need to be inserted. Notice my \"ThisWorkbook.....\"</li>\n<li>Your if statement is structured incorrectly as well. </li>\n</ol>\n\n<p>I suggest you spend some time reading up on the basics some more :)</p>\n"}], "owner": {"reputation": 35, "user_id": 4064868, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9c6df9436475bb2598b6bd3f912263b7?s=128&d=identicon&r=PG&f=1", "display_name": "Deathkamp", "link": "https://stackoverflow.com/users/4064868/deathkamp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1960, "favorite_count": 0, "accepted_answer_id": 41145177, "answer_count": 1, "score": -2, "last_activity_date": 1506016176, "creation_date": 1481724137, "last_edit_date": 1481725917, "question_id": 41144539, "link": "https://stackoverflow.com/questions/41144539/button-to-add-column", "title": "Button to add column?", "body": "<p>In excel 2013 I was hoping if someone can make a code for adding 1 blank column to a spreadsheet based on the user input after they click this button that is an activex control. The column will end based on how many rows there are in my table, meaning if there are 10 rows I should not see a column on line 11 of the spreadsheet. </p>\n\n<p>I keep getting an error saying application defined or object error after I put in the column I want to add, I even tried both caps an lowercase and the same error comes up. </p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\nDim x As String\nx = InputBox(\"Enter a column that you want to add: \", \"What column?\")\nIf x = \"\" Then Exit Sub\n\nColumnNum = x\nColumns(ColumnNum &amp; \":\" &amp; ColumnNum).Insert shift:=xlShiftRight\nColumns(ColumnNum - 1 &amp; \":\" &amp; ColumnNum - 1).Copy Range(\"A1\" &amp; ColumnNum)\nColumns(ColumnNum &amp; \":\" &amp; ColumnNum).ClearContents\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1481723920, "post_id": 41144426, "comment_id": 69491350, "body": "None that I know of. The VBA editor hasn&#39;t really been changed since 1997. Most of us don&#39;t have cars that old."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1481724129, "post_id": 41144426, "comment_id": 69491484, "body": "The <a href=\"http://www.github.com/rubberduck-vba/Rubberduck\" rel=\"nofollow noreferrer\">Rubberduck</a> addin has this functionality (full disclosure, I&#39;m a contributor)."}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 2, "creation_date": 1481724757, "post_id": 41144426, "comment_id": 69491880, "body": "When you have the cursor on the Function Call....hit Shift+F2 and it takes you to that function...is that what you mean?"}, {"owner": {"reputation": 153, "user_id": 3759627, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c9bf4811dbe58a731d49753d8bdaf89b?s=128&d=identicon&r=PG&f=1", "display_name": "Horace", "link": "https://stackoverflow.com/users/3759627/horace"}, "reply_to_user": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1481726935, "post_id": 41144426, "comment_id": 69493347, "body": "@Rdster, Yes exactly! Thanks!"}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1481727755, "post_id": 41144426, "comment_id": 69493935, "body": "@user3759627 Full answer up"}], "answers": [{"tags": [], "owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "is_accepted": false, "score": 3, "last_activity_date": 1481727735, "creation_date": 1481727735, "answer_id": 41145749, "question_id": 41144426, "link": "https://stackoverflow.com/questions/41144426/finding-code-for-a-macro-in-vba/41145749#41145749", "title": "Finding code for a macro in VBA", "body": "<p>When you have the cursor on the Function Call....hit Shift+F2 and it takes you to that function.</p>\n\n<p>You can also hit Ctrl+Shift+F2 to cycle back to the last few cursor locations...not quite as helpful as jumping to the procedure/function header, but if you are just scrolling around following code, you can easily go back and forth.</p>\n\n<p>One trick you can use is in the called function/sub comment out a line with the calling function/subs name...then while you are bouncing around in the code working through something, you can uncomment that line and Shift+F2 back to the calling function/sub.</p>\n\n<p>Hope that makes sense...</p>\n\n<pre><code>Sub Main()\n  ExampleSub   &lt;----Stick your cursor in the name and hit Shift+F2 to jump to the header\nEnd Sub\n\nSub ExampleSub  &lt;----You'll jump here\n'Main 'Calling Proc   &lt;----You can use this to jump back to Main if you uncomment it\n\n'Do Stuff\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 3759627, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c9bf4811dbe58a731d49753d8bdaf89b?s=128&d=identicon&r=PG&f=1", "display_name": "Horace", "link": "https://stackoverflow.com/users/3759627/horace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1481727735, "creation_date": 1481723806, "last_edit_date": 1531164843, "question_id": 41144426, "link": "https://stackoverflow.com/questions/41144426/finding-code-for-a-macro-in-vba", "title": "Finding code for a macro in VBA", "body": "<p>I have an add on with lots of modules and userforms. Of course there is a lot of nesting and macro referrals in each macro. I was wondering if there is a shortcut I am not aware of to find these macros that are referenced, or if I have to go through each modules manually to find them?</p>\n\n<p>In Matlab the shortcut is Ctrl+D and then the IDE would automatically open the script/function highlighted.</p>\n"}, {"tags": ["sql-server", "vba", "excel", "macros"], "answers": [{"comments": [{"owner": {"reputation": 353, "user_id": 7296874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d6448eb7e4756c5b000e7b93ce6bebe?s=128&d=identicon&r=PG&f=1", "display_name": "Samsonite Manly", "link": "https://stackoverflow.com/users/7296874/samsonite-manly"}, "edited": false, "score": 0, "creation_date": 1481724549, "post_id": 41144507, "comment_id": 69491745, "body": "Thanks, that&#39;s great! the error code shows just the second line of the SQL error code : &quot;-2147217865 Cannot drop the table &#39;#MSP_History3&#39;, because it does not exist or you do not have permission.&quot;  Any ideas on how to get the rest of it, or the next line? Number of rows affected is what I&#39;m looking for."}, {"owner": {"reputation": 145, "user_id": 6821241, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/ugKRa.jpg?s=128&g=1", "display_name": "Martin Router King", "link": "https://stackoverflow.com/users/6821241/martin-router-king"}, "reply_to_user": {"reputation": 353, "user_id": 7296874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d6448eb7e4756c5b000e7b93ce6bebe?s=128&d=identicon&r=PG&f=1", "display_name": "Samsonite Manly", "link": "https://stackoverflow.com/users/7296874/samsonite-manly"}, "edited": false, "score": 0, "creation_date": 1481724768, "post_id": 41144507, "comment_id": 69491885, "body": "Your welcome! Glad it was useful for you! It seems like you don&#39;t have enough permission to execute that query... Have you tried to log in with another user?"}, {"owner": {"reputation": 145, "user_id": 6821241, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/ugKRa.jpg?s=128&g=1", "display_name": "Martin Router King", "link": "https://stackoverflow.com/users/6821241/martin-router-king"}, "reply_to_user": {"reputation": 353, "user_id": 7296874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d6448eb7e4756c5b000e7b93ce6bebe?s=128&d=identicon&r=PG&f=1", "display_name": "Samsonite Manly", "link": "https://stackoverflow.com/users/7296874/samsonite-manly"}, "edited": false, "score": 0, "creation_date": 1481724840, "post_id": 41144507, "comment_id": 69491935, "body": "I don&#39;t know... I can&#39;t help you more... I found this code once and I thought it could be useful for you..."}, {"owner": {"reputation": 145, "user_id": 6821241, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/ugKRa.jpg?s=128&g=1", "display_name": "Martin Router King", "link": "https://stackoverflow.com/users/6821241/martin-router-king"}, "reply_to_user": {"reputation": 353, "user_id": 7296874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d6448eb7e4756c5b000e7b93ce6bebe?s=128&d=identicon&r=PG&f=1", "display_name": "Samsonite Manly", "link": "https://stackoverflow.com/users/7296874/samsonite-manly"}, "edited": false, "score": 0, "creation_date": 1481725515, "post_id": 41144507, "comment_id": 69492361, "body": "Check this one.... maybe it works for you! [link] (<a href=\"http://stackoverflow.com/questions/12676747/how-to-get-the-affected-rows-in-vba-ado-execute\" title=\"how to get the affected rows in vba ado execute\">stackoverflow.com/questions/12676747/&hellip;</a>)"}], "tags": [], "owner": {"reputation": 145, "user_id": 6821241, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/ugKRa.jpg?s=128&g=1", "display_name": "Martin Router King", "link": "https://stackoverflow.com/users/6821241/martin-router-king"}, "is_accepted": true, "score": 0, "last_activity_date": 1481724048, "creation_date": 1481724048, "answer_id": 41144507, "question_id": 41144360, "link": "https://stackoverflow.com/questions/41144360/vba-macro-to-copy-a-sql-error-code-into-excel/41144507#41144507", "title": "VBA macro to Copy a SQL error code into Excel", "body": "<p>Maybe you can try with this code... It shows the error on a message box.   </p>\n\n<pre><code>Option Explicit\n\nPublic Sub Connect()\n\nOn Error GoTo InvalidValue:\n\nDim myCn As MyServer\nSet myCn = New MyServer\n\nDim rs As ADODB.Recordset\nSet rs = New ADODB.Recordset\n\nrs.Open \"Select * from myTable\", myCn.GetConnection\n\nRange(\"A1\").CopyFromRecordset rs\n\nrs.Close\nmyCn.Shutdown\n\nSet rs = Nothing\nSet myCn = Nothing\n\nExit Sub\n\nInvalidValue:\n\nMsgBox Err.Number &amp; \" \" &amp; Err.Description\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 353, "user_id": 7296874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d6448eb7e4756c5b000e7b93ce6bebe?s=128&d=identicon&r=PG&f=1", "display_name": "Samsonite Manly", "link": "https://stackoverflow.com/users/7296874/samsonite-manly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 41144507, "answer_count": 1, "score": 0, "last_activity_date": 1481724064, "creation_date": 1481723641, "last_edit_date": 1481724064, "question_id": 41144360, "link": "https://stackoverflow.com/questions/41144360/vba-macro-to-copy-a-sql-error-code-into-excel", "title": "VBA macro to Copy a SQL error code into Excel", "body": "<p>I am trying to write/adopt a macro in VBA to copy a SQL query into Excel.\nI have it connecting and executing. When I run it manually in SQL, this is the error code in SQL:</p>\n\n<pre><code>Msg 3701, Level 11, State 5, Line 1\nCannot drop the table '#MSP_History3', because it does not exist or you do not have permission.\n\n(8661 row(s) affected)\nMsg 3701, Level 11, State 5, Line 1\nCannot drop the table '#MSP1', because it does not exist or you do not have permission.\n\n(8661 row(s) affected)\nMsg 3701, Level 11, State 5, Line 1\nCannot drop the table '#MSP_PBP', because it does not exist or you do not have permission.\n\n(8661 row(s) affected)\nMsg 3701, Level 11, State 5, Line 1\nCannot drop the table 'dbo.MSP_History', because it does not exist or you do not have permission.\nMsg 262, Level 14, State 1, Line 1\nCREATE TABLE permission denied in database 'master'.\n</code></pre>\n\n<p>Looks like its not a great query, but what interests me is the number of rows affected.</p>\n\n<p>Here is the latter portion of the VBA code that someone more skilled than me had  used for a different query that works to paste the table result in A1:</p>\n\n<pre><code>'Open the connection.\ncn.Open strConn\n'\n'Set and Execute SQL Command\nSet cmd1.ActiveConnection = cn\ncmd1.CommandText = SQLquery\ncmd1.CommandType = adCmdText\ncmd1.Execute\n\n'Open Recordset\nSet rs1.ActiveConnection = cn\nrs1.Open cmd1\n\n'Paste Column Headers into Spreadsheet\n    For Col = 0 To rs1.Fields.Count - 1\n    Range(\"A1\").Offset(0, Col).Value = rs1.Fields(Col).Name\n    Next\n\n'Copy Data to Excel\nActiveSheet.Range(\"A2\").CopyFromRecordset rs1\nCells.Select\nCells.EntireColumn.AutoFit\n</code></pre>\n\n<p>This code works for a properly-executed SQL query. Is there a way to copy the error message?</p>\n\n<p>Ideally what I want in cell A1 in Excel is just \"8661\".</p>\n\n<p>Thanks!</p>\n\n<p>edit: Currently the error message in VBA upon executing the \"cmd1.Execute\" line is:</p>\n\n<pre><code>Run-time error '-2147217900 (80040e14)': Automation error\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2016"], "answers": [{"tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": false, "score": 0, "last_activity_date": 1481736297, "last_edit_date": 1495540802, "creation_date": 1481735429, "answer_id": 41148347, "question_id": 41144128, "link": "https://stackoverflow.com/questions/41144128/ontime-event-scheduling-fails-because-of-protected-view/41148347#41148347", "title": "OnTime-event scheduling fails because of protected view", "body": "<p><strong><em>Solution approach explanation:</em></strong>\n<br>The problem relies that, in order to run the macros, the Excel instance needs the permission -which has not been granted yet- .Also, there may be a bug when it analyzes files that are checked out from a server (for example a SharePoint file). \n<br><strong><em>Solution:</em></strong>\n<br>Within the Workbook_Open event you may try something like:</p>\n\n<pre><code>Private Sub Workbook_Open()\nOn Error Resume Next\nIf ActiveWorkbook.ReadOnly = False And Application.ProtectedViewWindows.count &lt; 0 Then Call Tempo\nEnd Sub\n</code></pre>\n\n<p>More info could be consulted in <a href=\"https://stackoverflow.com/questions/19345600/excels-vba-activeworkbook-is-nothing-when-enable-editing-from-protectedview\">this question</a> or <a href=\"https://www.thespreadsheetguru.com/the-code-vault/2014/10/21/prevent-code-from-running-in-read-only\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>**PS: Note that if the permission is not granted it won't be able to run the macro.</p>\n"}], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 272, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481736297, "creation_date": 1481722945, "question_id": 41144128, "link": "https://stackoverflow.com/questions/41144128/ontime-event-scheduling-fails-because-of-protected-view", "title": "OnTime-event scheduling fails because of protected view", "body": "<p>When opening an Excel-file from an untrusted origin, I get asked if I want to \"Enable Editing\":\n<a href=\"https://i.stack.imgur.com/rXeLE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rXeLE.png\" alt=\"enter image description here\"></a></p>\n\n<p>However, when I do click that button, in Excel-files which contain <code>OnTime</code>-scheduling in the <code>Workbook_Open</code>-event, I get an error message and the macro aborts:</p>\n\n<p><a href=\"https://i.stack.imgur.com/dN0vr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dN0vr.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/H9K2l.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/H9K2l.png\" alt=\"enter image description here\"></a></p>\n\n<p>The code calling the macro is in the <code>ThisWorkbook</code>-object and looks like this:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Call Tempo\nEnd Sub\n</code></pre>\n\n<p>While the macro itself is in a regular module, and looks like this:</p>\n\n<p>Option Explicit</p>\n\n<pre><code>Public VARTIMER As Variant\nConst TimeOut As Long = 30 'in minutes\n\nSub Salva()\n    ActiveWorkbook.Save\n    Call Tempo\nEnd Sub\n\nSub Tempo()\n    VARTIMER = Format(Now + TimeSerial(0, TimeOut, 0), \"hh:mm:ss\")\n    If VARTIMER = \"\" Then Exit Sub\n    Application.OnTime TimeValue(VARTIMER), \"Salva\"\nEnd Sub\n</code></pre>\n\n<p>It all works perfectly fine as long as the file isn't opened in protected view, but when it is, I get the error shown above.</p>\n\n<p>Can anyone tell me a way to avoid having the error shown appearing / aborting the code? </p>\n\n<p>Marking all sites as trusted locations is not an option, because of company policies / a lot of users.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "edited": false, "score": 0, "creation_date": 1481722656, "post_id": 41144005, "comment_id": 69490416, "body": "<code>For radek = 47 To 47</code> makes it do only once. Check that line. Maybe it should be <code>For radek = 1 To 47</code>"}, {"owner": {"reputation": 71, "user_id": 7286256, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/86af2722c80dff17ad49f97a986754a9?s=128&d=identicon&r=PG&f=1", "display_name": "Nataniell", "link": "https://stackoverflow.com/users/7286256/nataniell"}, "reply_to_user": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "edited": false, "score": 0, "creation_date": 1481722832, "post_id": 41144005, "comment_id": 69490551, "body": "Its ok. I need only one row. But this code does not insert any data inside workbook."}, {"owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "edited": false, "score": 0, "creation_date": 1481723095, "post_id": 41144005, "comment_id": 69490749, "body": "Ok, then try adding <code>seznam.</code> before <code>Sheets(&quot;SEZNAM_VYDANYCH_DOKUMENTU&quot;).Range(&quot;A&quot; </code>"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1481723131, "post_id": 41144005, "comment_id": 69490772, "body": "<b>seznam.</b> <code>Sheets(&quot;SEZNAM_VYDANYCH_DOKUMENTU&quot;).Range(....</code>"}, {"owner": {"reputation": 71, "user_id": 7286256, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/86af2722c80dff17ad49f97a986754a9?s=128&d=identicon&r=PG&f=1", "display_name": "Nataniell", "link": "https://stackoverflow.com/users/7286256/nataniell"}, "edited": false, "score": 0, "creation_date": 1481723506, "post_id": 41144005, "comment_id": 69491053, "body": "Still not working. Document is opened and closed, but no values here."}, {"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1481724396, "post_id": 41144005, "comment_id": 69491664, "body": "Add <code>ThisWorkbook</code> and the sheetname before <code>Range(&quot;B&quot; &amp; radek &amp; &quot;:H&quot; &amp; radek).Value</code> so it reads: <code>sezname.Sheets(&quot;SEZNAM_VYDANYCH_DOKUMENTU&quot;).Range(&quot;A&quot; &amp; radeklist &amp; &quot;:G&quot; &amp; radeklist).Value = Thisworkbook.Sheets(&quot;SheetName&quot;).Range(&quot;B&quot; &amp; radek &amp; &quot;:H&quot; &amp; radek).Value</code>"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1481724554, "post_id": 41144005, "comment_id": 69491748, "body": "try <code>=ThisWorkbook.SomeWorksheet.Range(&quot;B&quot; &amp; radek &amp; &quot;:H&quot; &amp; radek).Value</code>. And please define radek as Integer, not as Byte. And verify that your source range actually has values and is not empty."}, {"owner": {"reputation": 71, "user_id": 7286256, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/86af2722c80dff17ad49f97a986754a9?s=128&d=identicon&r=PG&f=1", "display_name": "Nataniell", "link": "https://stackoverflow.com/users/7286256/nataniell"}, "reply_to_user": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 1, "creation_date": 1481724991, "post_id": 41144005, "comment_id": 69492029, "body": "@Jordan Thank you. That was that mistake. It is working now."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1481736572, "post_id": 41144005, "comment_id": 69499703, "body": "Editing your question to remove the problem and replace it with working code makes it kind of useless as a question: it&#39;s much better to post your own answer instead."}, {"owner": {"reputation": 71, "user_id": 7286256, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/86af2722c80dff17ad49f97a986754a9?s=128&d=identicon&r=PG&f=1", "display_name": "Nataniell", "link": "https://stackoverflow.com/users/7286256/nataniell"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1481780507, "post_id": 41144005, "comment_id": 69515794, "body": "@TimWilliams ok thx for info. I am new here... :)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1481783953, "post_id": 41144005, "comment_id": 69517060, "body": "Thanks for the fix."}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 7286256, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/86af2722c80dff17ad49f97a986754a9?s=128&d=identicon&r=PG&f=1", "display_name": "Nataniell", "link": "https://stackoverflow.com/users/7286256/nataniell"}, "is_accepted": true, "score": 0, "last_activity_date": 1481780434, "creation_date": 1481780434, "answer_id": 41157163, "question_id": 41144005, "link": "https://stackoverflow.com/questions/41144005/save-row-data-to-different-workbook-with-realtive-path-vba/41157163#41157163", "title": "Save row data to different workbook with realtive path (VBA)", "body": "<p>Working code</p>\n\n<pre><code>Sub test()\nDim radek As Integer\nDim radeklist As Integer\nDim seznam As Workbook\n\nFor radek = 47 To 47\nSet seznam = Workbooks.Open(ThisWorkbook.Path &amp; Application.PathSeparator &amp; \"SEZNAM_VYDANYCH_DOKUMENTU.xlsm\")\nradeklist = seznam.Sheets(\"SEZNAM_VYDANYCH_DOKUMENTU\").Cells(Rows.Count, 1).End(xlUp).Row + 1\n\nseznam.Sheets(\"SEZNAM_VYDANYCH_DOKUMENTU\").Range(\"A\" &amp; radeklist &amp; \":G\" &amp; radeklist).Value = ThisWorkbook.Sheets(\"PREHLED\").Range(\"B\" &amp; radek &amp; \":H\" &amp; radek).Value\nseznam.Save '&lt;~ save and close the target workbook\nseznam.Close savechanges:=False\nNext radek\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 7286256, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/86af2722c80dff17ad49f97a986754a9?s=128&d=identicon&r=PG&f=1", "display_name": "Nataniell", "link": "https://stackoverflow.com/users/7286256/nataniell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 41157163, "answer_count": 1, "score": 0, "last_activity_date": 1481780434, "creation_date": 1481722586, "last_edit_date": 1481780357, "question_id": 41144005, "link": "https://stackoverflow.com/questions/41144005/save-row-data-to-different-workbook-with-realtive-path-vba", "title": "Save row data to different workbook with realtive path (VBA)", "body": "<p>could you help me to find mistake? I need to send some values by button to different workbook and save and close (relative path)</p>\n\n<pre><code>Sub test()\nDim radek As Integer\nDim radeklist As Integer\nDim seznam As Workbook\n\nFor radek = 47 To 47\nSet seznam = Workbooks.Open(ThisWorkbook.Path &amp; Application.PathSeparator &amp; \"SEZNAM_VYDANYCH_DOKUMENTU.xlsm\")\nradeklist = seznam.Sheets(\"SEZNAM_VYDANYCH_DOKUMENTU\").Cells(Rows.Count, 1).End(xlUp).Row + 1\n\nseznam.Sheets(\"SEZNAM_VYDANYCH_DOKUMENTU\").Range(\"A\" &amp; radeklist &amp; \":G\" &amp; radeklist).Value = .Range(\"B\" &amp; radek &amp; \":H\" &amp; radek).Value\nseznam.Save '&lt;~ save and close the target workbook\nseznam.Close savechanges:=False\nNext radek\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "edited": false, "score": 1, "creation_date": 1481722579, "post_id": 41143582, "comment_id": 69490367, "body": "Check <code>rng = &quot;A5:A&quot;</code>. AFAIK, this isnt a valid range."}, {"owner": {"reputation": 83, "user_id": 5791797, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7f1838b38cef5d17d9e1c5f02fbc0e04?s=128&d=identicon&r=PG&f=1", "display_name": "Frank M", "link": "https://stackoverflow.com/users/5791797/frank-m"}, "reply_to_user": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "edited": false, "score": 0, "creation_date": 1481722770, "post_id": 41143582, "comment_id": 69490496, "body": "A is the column for the name. What is the best way of making the range the entire column, starting with cell 5?"}, {"owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "edited": false, "score": 1, "creation_date": 1481723000, "post_id": 41143582, "comment_id": 69490679, "body": "Maybe <code>A:A</code> or <code>A5:A10</code> or whatever range you actually need."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 5791797, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7f1838b38cef5d17d9e1c5f02fbc0e04?s=128&d=identicon&r=PG&f=1", "display_name": "Frank M", "link": "https://stackoverflow.com/users/5791797/frank-m"}, "edited": false, "score": 0, "creation_date": 1481739333, "post_id": 41145420, "comment_id": 69501117, "body": "It works for a brief second &amp; I see the results. Then all the data between  rows 5 &amp; 2004 disappear. The only changes I made were to the sheet name from <b>Sheet1</b> to <b>Walk INs</b> &amp;  the Range from <b>A5:L25</b> to <b>A5:L2003</b> Any idea what happened?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 83, "user_id": 5791797, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7f1838b38cef5d17d9e1c5f02fbc0e04?s=128&d=identicon&r=PG&f=1", "display_name": "Frank M", "link": "https://stackoverflow.com/users/5791797/frank-m"}, "edited": false, "score": 0, "creation_date": 1481792804, "post_id": 41145420, "comment_id": 69521323, "body": "Does column L (12th column in the selected range - <code>Field:=12</code>) have &#39;Yes&#39; in it?"}, {"owner": {"reputation": 83, "user_id": 5791797, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7f1838b38cef5d17d9e1c5f02fbc0e04?s=128&d=identicon&r=PG&f=1", "display_name": "Frank M", "link": "https://stackoverflow.com/users/5791797/frank-m"}, "edited": false, "score": 0, "creation_date": 1481803780, "post_id": 41145420, "comment_id": 69528070, "body": "The first time I ran it, it did not, when I had a Yes in column L, it did show a duplicate. However the data from row 5 to 2003 is gone. The only thing that is on the screen is row 1-4 &amp; 2004 - 65000."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 83, "user_id": 5791797, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7f1838b38cef5d17d9e1c5f02fbc0e04?s=128&d=identicon&r=PG&f=1", "display_name": "Frank M", "link": "https://stackoverflow.com/users/5791797/frank-m"}, "edited": false, "score": 0, "creation_date": 1481807372, "post_id": 41145420, "comment_id": 69530243, "body": "Not sure what you mean. <i>&#39;The first time I ran it, it did not, when I had a Yes in column L, it did show a duplicate.&#39;</i>  When you say the data in rows 5:2003 is gone - do you mean they&#39;re hidden by the filter, or they&#39;re completely gone?  If hidden by the filter - what&#39;s the filter set to?"}, {"owner": {"reputation": 83, "user_id": 5791797, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7f1838b38cef5d17d9e1c5f02fbc0e04?s=128&d=identicon&r=PG&f=1", "display_name": "Frank M", "link": "https://stackoverflow.com/users/5791797/frank-m"}, "edited": false, "score": 0, "creation_date": 1481810274, "post_id": 41145420, "comment_id": 69532233, "body": "Visually there is no data, and I am not able to scroll up. The first row after row 4 is row 2004."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 83, "user_id": 5791797, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7f1838b38cef5d17d9e1c5f02fbc0e04?s=128&d=identicon&r=PG&f=1", "display_name": "Frank M", "link": "https://stackoverflow.com/users/5791797/frank-m"}, "edited": false, "score": 0, "creation_date": 1481813410, "post_id": 41145420, "comment_id": 69534399, "body": "If the row numbers jump from 4 to 2004 then it&#39;s filtered - the data is just hidden.  Row 4 should have little drop-down arrows on the right of the cells.  In 2010 column L should have a little filter icon next to the down arrow, in 2003 the down arrow will be coloured blue (hard to spot).  In 2010 clicking the arrow will show you a list of unique values in that column with a tick next to the one that&#39;s filtered, in 2003 the drop-down list will have highlighted the selected filter.  Is this anything like what you have?"}, {"owner": {"reputation": 83, "user_id": 5791797, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7f1838b38cef5d17d9e1c5f02fbc0e04?s=128&d=identicon&r=PG&f=1", "display_name": "Frank M", "link": "https://stackoverflow.com/users/5791797/frank-m"}, "edited": false, "score": 0, "creation_date": 1481815503, "post_id": 41145420, "comment_id": 69535822, "body": "LOL I totally forgot about the filter.  Is it possible to have the filter turned off, so I don&#39;t have to go through that step every time?  It also adds a column every time it is run. Can it show just the true duplicates in <b>column M</b>?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 83, "user_id": 5791797, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7f1838b38cef5d17d9e1c5f02fbc0e04?s=128&d=identicon&r=PG&f=1", "display_name": "Frank M", "link": "https://stackoverflow.com/users/5791797/frank-m"}, "edited": false, "score": 1, "creation_date": 1481815841, "post_id": 41145420, "comment_id": 69536037, "body": "To remove the filter bit, just comment out or remove the two lines that start <code>.AutoFilter</code>. To set the last column manually to column M change this line: <code>Col = .Cells.Find(&quot;*&quot;, , , , xlByColumns, xlPrevious).Column</code> to <code>Col = 13</code> (you can remove the rest of that block of code as well)."}, {"owner": {"reputation": 83, "user_id": 5791797, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7f1838b38cef5d17d9e1c5f02fbc0e04?s=128&d=identicon&r=PG&f=1", "display_name": "Frank M", "link": "https://stackoverflow.com/users/5791797/frank-m"}, "edited": false, "score": 0, "creation_date": 1481817195, "post_id": 41145420, "comment_id": 69536837, "body": "I removed the line of code &amp; it still is adding a column. Did I miss something? ` On Error Resume Next             Col = 13             Err.Clear         On Error GoTo 0         If Col = 0 Then Col = 1`"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 83, "user_id": 5791797, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7f1838b38cef5d17d9e1c5f02fbc0e04?s=128&d=identicon&r=PG&f=1", "display_name": "Frank M", "link": "https://stackoverflow.com/users/5791797/frank-m"}, "edited": false, "score": 0, "creation_date": 1481822676, "post_id": 41145420, "comment_id": 69540168, "body": "I&#39;ve added another block of code so the last column is always 1 to the right of your defined range - so <code>A5:L25</code> will always be <code>M5:M25</code>."}, {"owner": {"reputation": 83, "user_id": 5791797, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7f1838b38cef5d17d9e1c5f02fbc0e04?s=128&d=identicon&r=PG&f=1", "display_name": "Frank M", "link": "https://stackoverflow.com/users/5791797/frank-m"}, "edited": false, "score": 0, "creation_date": 1481823743, "post_id": 41145420, "comment_id": 69540799, "body": "Did I miss something?  Should I change A5:L25 to M5:M25?"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 0, "last_activity_date": 1481822502, "last_edit_date": 1481822502, "creation_date": 1481726782, "answer_id": 41145420, "question_id": 41143582, "link": "https://stackoverflow.com/questions/41143582/not-able-to-get-highlight-count-vba-working/41145420#41145420", "title": "Not able to get Highlight &amp; Count VBA working", "body": "<p>Maybe this would work for you.</p>\n\n<p>It adds the formula and then uses conditional formatting to highlight the cells.</p>\n\n<pre><code>Public Sub Find_Duplicates()\n\n    Dim wrkSht As Worksheet 'The worksheet that you're lookin for duplicates in.\n    Dim rng As Range        'The range containing the duplicates.\n    Dim Col As Long         'The last column containing data +1\n\n    Set wrkSht = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    With wrkSht\n        'Reference to whole data range.\n        Set rng = .Range(\"A5:L25\")\n\n        'If the sheet is blank an error will be thrown when trying to find the last column.\n        'This code looks for the last column - you could just set Col to equal the last column number + 1.\n        On Error Resume Next\n            Col = .Cells.Find(\"*\", , , , xlByColumns, xlPrevious).Column\n            Err.Clear\n        On Error GoTo 0\n        If Col = 0 Then Col = 1\n\n        'Place a COUNTIF formula in the last column.\n        rng.Offset(, Col).Columns(1).FormulaR1C1 = \"=COUNTIF(\" &amp; rng.Columns(1).Address(ReferenceStyle:=xlR1C1) &amp; \",RC\" &amp; rng.Column &amp; \") &amp; \"\" duplicates.\"\"\"\n\n        With rng\n            'Add conditional formatting to first column in range: If the COUNTIF formula is showing &gt;1 then highlight cell.\n            With .Columns(1)\n                'This formula is =VALUE(LEFT($M5,FIND(\" \",$M5)-1))&gt;1.\n                'It returns only the number from the duplicate count and checks it is higher than 1.\n                .FormatConditions.Add Type:=xlExpression, Formula1:= _\n                    \"=VALUE(LEFT(\" &amp; rng.Offset(, Col).Cells(1).Address(RowAbsolute:=False) &amp; \",FIND(\"\" \"\",\" &amp; _\n                    rng.Offset(, Col).Cells(1).Address(RowAbsolute:=False) &amp; \")-1))&gt;1\"\n                .FormatConditions(.FormatConditions.Count).SetFirstPriority\n                .FormatConditions(.FormatConditions.Count).Interior.Color = RGB(0, 100, 255)\n            End With\n\n            'Apply filter to your range.\n            .AutoFilter\n            .AutoFilter Field:=12, Criteria1:=\"Yes\"\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>Updated code:</strong><br>\nThis will always place the last column as 1 to the right of the range set in the variable <code>rng</code>.</p>\n\n<pre><code>Public Sub Find_Duplicates()\n\n    Dim wrkSht As Worksheet 'The worksheet that you're lookin for duplicates in.\n    Dim rng As Range        'The range containing the duplicates.\n    Dim rLastCol            '1 column to right of rng.\n    Dim Col As Long         'The last column containing data +1\n\n    Set wrkSht = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    With wrkSht\n        'Reference to whole data range.\n        Set rng = .Range(\"A5:L25\")\n        Set rLastCol = rng.Offset(, 1).Columns(rng.Columns.Count)\n\n        'Place a COUNTIF formula in the last column.\n        rLastCol.FormulaR1C1 = \"=COUNTIF(\" &amp; rng.Columns(1).Address(ReferenceStyle:=xlR1C1) &amp; \",RC\" &amp; rng.Column &amp; \") &amp; \"\" duplicates.\"\"\"\n\n        With rng\n            'Add conditional formatting to first column in range: If the COUNTIF formula is showing &gt;1 then highlight cell.\n            With .Columns(1)\n                'This formula is =VALUE(LEFT($M5,FIND(\" \",$M5)-1))&gt;1.\n                'It returns only the number from the duplicate count and checks it is higher than 1.\n                .FormatConditions.Add Type:=xlExpression, Formula1:= _\n                    \"=VALUE(LEFT(\" &amp; rLastCol.Cells(1).Address(RowAbsolute:=False) &amp; \",FIND(\"\" \"\",\" &amp; _\n                    rLastCol.Cells(1).Address(RowAbsolute:=False) &amp; \")-1))&gt;1\"\n                .FormatConditions(.FormatConditions.Count).SetFirstPriority\n                .FormatConditions(.FormatConditions.Count).Interior.Color = RGB(0, 100, 255)\n            End With\n\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 5791797, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7f1838b38cef5d17d9e1c5f02fbc0e04?s=128&d=identicon&r=PG&f=1", "display_name": "Frank M", "link": "https://stackoverflow.com/users/5791797/frank-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 41145420, "answer_count": 1, "score": 0, "last_activity_date": 1481822502, "creation_date": 1481721263, "last_edit_date": 1531164843, "question_id": 41143582, "link": "https://stackoverflow.com/questions/41143582/not-able-to-get-highlight-count-vba-working", "title": "Not able to get Highlight &amp; Count VBA working", "body": "<p>I found a macro to count &amp; Highlight Duplicates. My friend &amp; I have tried to get it working, but have not been able to get it working. Column A  ( Name), Column L ( Yes - Filter), Column M (Duplicate).  In addition to getting the code working, we are trying to get the macro to filter on Yes in column L, and Print <strong>Duplicate</strong> in Column M. Please advise what is wrong &amp; how to fix the problem. Here is the code: </p>\n\n<pre><code>Option Explicit\nSub Find_Duplicates()\n\nDim col As Integer\nDim rng As String\ncol = 3\nrng = \"A5:A\"\nHighLightDuplicates rng, col\nShowMaxOnly rng, col\n\nEnd Sub\n\nSub HighLightDuplicates(ByVal rng As String, ByVal col As Integer)\nDim i, j As Integer\nDim temp As Variant\nRange(rng).Select\nDim Count As Integer\nCount = 1\n\n For i = 1 To Selection.Count\n   temp = Range(Left(rng, 1) &amp; i)\n   For j = i + 1 To Selection.Count\n     If temp = Range(Left(rng, 1) &amp; j) And temp &lt;&gt; \"\" Then\n         Count = Count + 1 'increase the number of duplicates\n         'highlight the duplicates\n         Range(Left(rng, 1) &amp; i).Interior.Color = RGB(0, 100, 255)\n         Range(Left(rng, 1) &amp; j).Interior.Color = RGB(0, 100, 255)\n     End If\n   Next\n   'show the number of duplicates\n   If Count &gt; 1 Then\n     Cells(i, col) = Count &amp; \" duplicates\"\n   End If\n   'reset count\n   Count = 1\n Next\n End Sub\n 'show only the biggest number of duplicates in a group\n\n\n Sub ShowMaxOnly(ByVal rng As String, ByVal col As Integer)\n Dim i, j As Integer\n Dim temp As Variant\n Range(rng).Select\n\n   i = 1\n   For i = 1 To Selection.Count\n     temp = Range(Left(rng, 1) &amp; i)\n     For j = i + 1 To Selection.Count\n      If temp = Range(Left(rng, 1) &amp; j) And temp &lt;&gt; \"\" Then\n         Cells(j, col) = \"\" 'remove the smaller numbers duplicates\n      End If\n    Next\n  Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "charts"], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 4, "last_activity_date": 1481718935, "creation_date": 1481718935, "answer_id": 41142845, "question_id": 41142684, "link": "https://stackoverflow.com/questions/41142684/run-time-error-438-when-referring-to-a-chart-in-vba/41142845#41142845", "title": "Run-time error &#39;438&#39; when referring to a chart in VBA", "body": "<p>A <code>ChartObject</code> functions as a <em>container</em> for a <code>Chart</code> object. Think of it as the window that the chart is embedded in. You need:</p>\n\n<pre><code>Worksheets(\"Report\").ChartObjects(\"ChartVisitors\").Chart.ChartTitle.Text = \"Test\"\n</code></pre>\n\n<p>Rather than</p>\n\n<pre><code>Worksheets(\"Report\").ChartObjects(\"ChartVisitors\").ChartTitle.Text = \"Test\"\n</code></pre>\n\n<p>etc.</p>\n"}], "owner": {"reputation": 54, "user_id": 4502824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eea39103277c9b4d30ab2dbfdef5ea9f?s=128&d=identicon&r=PG&f=1", "display_name": "L-f", "link": "https://stackoverflow.com/users/4502824/l-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1103, "favorite_count": 0, "accepted_answer_id": 41142845, "answer_count": 1, "score": 1, "last_activity_date": 1481718956, "creation_date": 1481718521, "last_edit_date": 1481718956, "question_id": 41142684, "link": "https://stackoverflow.com/questions/41142684/run-time-error-438-when-referring-to-a-chart-in-vba", "title": "Run-time error &#39;438&#39; when referring to a chart in VBA", "body": "<p>I want to manipulate an existing chart to filter data series and change title by clicking command buttons on a worksheet, but I'm getting runtime error 438 when trying to write code for some operations.</p>\n\n<p>First, a line\n<code>Worksheets(\"Report\").ChartObjects(\"ChartVisitors\").Visible=True</code> (or False)<br>\nworks just fine, but when I try:<br>\n<code>Worksheets(\"Report\").ChartObjects(\"ChartVisitors\").ChartTitle.Text = \"Test\"</code> or<br>\n<code>Worksheets(\"Report\").ChartObjects(\"ChartVisitors\").FullSeriesCollection(25).IsFiltered = True (False)</code>, I get runtime error 438. Those two are pretty much the only properties I want to modify, I'm guessing my syntax is wrong? <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195126.aspx\" rel=\"nofollow noreferrer\">MSDN</a> only specifies that the chart should have <code>.HasTitle</code> property set to True, which it does.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1481746401, "post_id": 41142638, "comment_id": 69504883, "body": "One of the sheet names is incorrect, hence error 9. Once you fix that, you will get error 1004, as 300000000 is way more than number if rows in sheet (Excel 2007+) 1048576. another possibility is your sheets and macro are in separate workbooks. fully qalify sheet names with worbook instance. Workbooks(&quot;test.xlsm&quot;).Worksheets(&quot;Arrival&quot;)"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7296467, "user_type": "registered", "profile_image": "https://graph.facebook.com/1442640695776896/picture?type=large", "display_name": "Jason", "link": "https://stackoverflow.com/users/7296467/jason"}, "edited": false, "score": 0, "creation_date": 1481718960, "post_id": 41142745, "comment_id": 69487964, "body": "Thanks, but it didn&#39;t work (yet). Any other suggestions?  <a href=\"http://imgur.com/a/oUSVO\" rel=\"nofollow noreferrer\">imgur.com/a/oUSVO</a>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1, "user_id": 7296467, "user_type": "registered", "profile_image": "https://graph.facebook.com/1442640695776896/picture?type=large", "display_name": "Jason", "link": "https://stackoverflow.com/users/7296467/jason"}, "edited": false, "score": 0, "creation_date": 1481719095, "post_id": 41142745, "comment_id": 69488054, "body": "Check the edition. You exceed the limits of rows in excel. Go below 2^20 rows and not 30 and 300 millions in your code."}, {"owner": {"reputation": 1, "user_id": 7296467, "user_type": "registered", "profile_image": "https://graph.facebook.com/1442640695776896/picture?type=large", "display_name": "Jason", "link": "https://stackoverflow.com/users/7296467/jason"}, "edited": false, "score": 0, "creation_date": 1481719292, "post_id": 41142745, "comment_id": 69488194, "body": "I&#39;ve changed it to 1 million and e&lt;100000, but I&#39;m still getting the same error at the same piece of code.    Really appreciating your help"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1, "user_id": 7296467, "user_type": "registered", "profile_image": "https://graph.facebook.com/1442640695776896/picture?type=large", "display_name": "Jason", "link": "https://stackoverflow.com/users/7296467/jason"}, "edited": false, "score": 0, "creation_date": 1481719434, "post_id": 41142745, "comment_id": 69488296, "body": "write <code>debug.print f,z,x</code> on the line before the error and check the values."}, {"owner": {"reputation": 1, "user_id": 7296467, "user_type": "registered", "profile_image": "https://graph.facebook.com/1442640695776896/picture?type=large", "display_name": "Jason", "link": "https://stackoverflow.com/users/7296467/jason"}, "edited": false, "score": 0, "creation_date": 1481720090, "post_id": 41142745, "comment_id": 69488748, "body": "Where do I put the debug.print line exactly? I tried to put it before the yellow highlighted string <a href=\"http://imgur.com/a/ojSLU\" rel=\"nofollow noreferrer\">imgur.com/a/ojSLU</a>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1, "user_id": 7296467, "user_type": "registered", "profile_image": "https://graph.facebook.com/1442640695776896/picture?type=large", "display_name": "Jason", "link": "https://stackoverflow.com/users/7296467/jason"}, "edited": false, "score": 0, "creation_date": 1481720228, "post_id": 41142745, "comment_id": 69488833, "body": "Exactly as you showed. Put the cursor before the <code>If</code> and press enter."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1, "user_id": 7296467, "user_type": "registered", "profile_image": "https://graph.facebook.com/1442640695776896/picture?type=large", "display_name": "Jason", "link": "https://stackoverflow.com/users/7296467/jason"}, "edited": false, "score": 0, "creation_date": 1481720971, "post_id": 41142745, "comment_id": 69489300, "body": "Yes, it helps. What are the values of Arrival B16 and Information B3?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1, "user_id": 7296467, "user_type": "registered", "profile_image": "https://graph.facebook.com/1442640695776896/picture?type=large", "display_name": "Jason", "link": "https://stackoverflow.com/users/7296467/jason"}, "edited": false, "score": 0, "creation_date": 1481721106, "post_id": 41142745, "comment_id": 69489391, "body": "And add <b>all</b> the variables to the debug.print like this: <code>debug.print &quot; f-&gt;&quot;f , &quot; z-&gt;&quot; z</code> For all the 8 of them."}, {"owner": {"reputation": 1, "user_id": 7296467, "user_type": "registered", "profile_image": "https://graph.facebook.com/1442640695776896/picture?type=large", "display_name": "Jason", "link": "https://stackoverflow.com/users/7296467/jason"}, "edited": false, "score": 0, "creation_date": 1481721205, "post_id": 41142745, "comment_id": 69489458, "body": "Information B3: <a href=\"http://imgur.com/a/htSYt\" rel=\"nofollow noreferrer\">imgur.com/a/htSYt</a>           Arrival B16: <a href=\"http://imgur.com/a/6TmG8\" rel=\"nofollow noreferrer\">imgur.com/a/6TmG8</a>           Thanks so much for your help so far!"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1, "user_id": 7296467, "user_type": "registered", "profile_image": "https://graph.facebook.com/1442640695776896/picture?type=large", "display_name": "Jason", "link": "https://stackoverflow.com/users/7296467/jason"}, "edited": false, "score": 0, "creation_date": 1481721457, "post_id": 41142745, "comment_id": 69489619, "body": "And what happens when you do the new <code>debug.print</code>? Btw, remove the screenshots, the data is probably something that should stay secure."}, {"owner": {"reputation": 1, "user_id": 7296467, "user_type": "registered", "profile_image": "https://graph.facebook.com/1442640695776896/picture?type=large", "display_name": "Jason", "link": "https://stackoverflow.com/users/7296467/jason"}, "edited": false, "score": 0, "creation_date": 1481721510, "post_id": 41142745, "comment_id": 69489659, "body": "New debug request: <a href=\"http://imgur.com/a/PMaZo\" rel=\"nofollow noreferrer\">imgur.com/a/PMaZo</a>        Is the screencap correct? I&#39;ve ran it, doesn&#39;t display anything different."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1, "user_id": 7296467, "user_type": "registered", "profile_image": "https://graph.facebook.com/1442640695776896/picture?type=large", "display_name": "Jason", "link": "https://stackoverflow.com/users/7296467/jason"}, "edited": false, "score": 0, "creation_date": 1481721575, "post_id": 41142745, "comment_id": 69489702, "body": "put the debug.print line exactly before the yellow line and run again."}, {"owner": {"reputation": 1, "user_id": 7296467, "user_type": "registered", "profile_image": "https://graph.facebook.com/1442640695776896/picture?type=large", "display_name": "Jason", "link": "https://stackoverflow.com/users/7296467/jason"}, "edited": false, "score": 1, "creation_date": 1481721712, "post_id": 41142745, "comment_id": 69489797, "body": "<a href=\"http://imgur.com/a/6xcxk\" rel=\"nofollow noreferrer\">imgur.com/a/6xcxk</a>         I&#39;ve removed the images, thanks for the reminder. Here&#39;s the updated debug"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1, "user_id": 7296467, "user_type": "registered", "profile_image": "https://graph.facebook.com/1442640695776896/picture?type=large", "display_name": "Jason", "link": "https://stackoverflow.com/users/7296467/jason"}, "edited": false, "score": 0, "creation_date": 1481722062, "post_id": 41142745, "comment_id": 69490034, "body": "Write these in the lines after the debug.print. <code>debug.print worksheets(&quot;Arrival&quot;).cells(f,14).value</code>  <code>debug.print worksheets(&quot;Information&quot;).cells(z,4).value</code> On two separate lines."}, {"owner": {"reputation": 1, "user_id": 7296467, "user_type": "registered", "profile_image": "https://graph.facebook.com/1442640695776896/picture?type=large", "display_name": "Jason", "link": "https://stackoverflow.com/users/7296467/jason"}, "edited": false, "score": 0, "creation_date": 1481722381, "post_id": 41142745, "comment_id": 69490233, "body": "<a href=\"http://imgur.com/a/Ce1he\" rel=\"nofollow noreferrer\">imgur.com/a/Ce1he</a>     Doesn&#39;t display anything new, neither does this one; <a href=\"http://imgur.com/a/A6uxt\" rel=\"nofollow noreferrer\">imgur.com/a/A6uxt</a>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1, "user_id": 7296467, "user_type": "registered", "profile_image": "https://graph.facebook.com/1442640695776896/picture?type=large", "display_name": "Jason", "link": "https://stackoverflow.com/users/7296467/jason"}, "edited": false, "score": 0, "creation_date": 1481722800, "post_id": 41142745, "comment_id": 69490519, "body": "That is strange. It did not print any values for those two cells. Just to check - <code>Information</code> and <code>Arrival</code> are named exactly like this? And you do not have any other sheet opened. And you work with <code>Option Explicit</code> on top?"}, {"owner": {"reputation": 1, "user_id": 7296467, "user_type": "registered", "profile_image": "https://graph.facebook.com/1442640695776896/picture?type=large", "display_name": "Jason", "link": "https://stackoverflow.com/users/7296467/jason"}, "edited": false, "score": 0, "creation_date": 1481723064, "post_id": 41142745, "comment_id": 69490721, "body": "Yes the sheets are called exactly Information and Arrival:<a href=\"http://imgur.com/a/FhJRb\" rel=\"nofollow noreferrer\">imgur.com/a/FhJRb</a>                   There are no other sheets opened at the moment.      the Option explicit thing you mentioned doesn&#39;t sound familiar to me, what is it?                   Thanks again!"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1, "user_id": 7296467, "user_type": "registered", "profile_image": "https://graph.facebook.com/1442640695776896/picture?type=large", "display_name": "Jason", "link": "https://stackoverflow.com/users/7296467/jason"}, "edited": false, "score": 0, "creation_date": 1481723276, "post_id": 41142745, "comment_id": 69490896, "body": "That&#39;s for the option explicit - <a href=\"http://wellsr.com/vba/excel/vba-option-explicit/\" rel=\"nofollow noreferrer\">wellsr.com/vba/excel/vba-option-explicit</a> probably the problem is somewhere else, but just to make sure. Furthermore, make sure that the cells on those two sheets are not merged and not protected."}, {"owner": {"reputation": 1, "user_id": 7296467, "user_type": "registered", "profile_image": "https://graph.facebook.com/1442640695776896/picture?type=large", "display_name": "Jason", "link": "https://stackoverflow.com/users/7296467/jason"}, "edited": false, "score": 0, "creation_date": 1481723820, "post_id": 41142745, "comment_id": 69491271, "body": "Alright, I&#39;ve checked the variable box in the option explicit menu. The cells aren&#39;t merged. I used &#39;saved as&#39; on the original file (which had protection) to create my own excel file. I do not think it&#39;s protected since I can still enable protection and set a password myself, and it&#39;s not required when opening the file.                                      Also, the other monthly files didn&#39;t all have this problem."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1, "user_id": 7296467, "user_type": "registered", "profile_image": "https://graph.facebook.com/1442640695776896/picture?type=large", "display_name": "Jason", "link": "https://stackoverflow.com/users/7296467/jason"}, "edited": false, "score": 0, "creation_date": 1481724185, "post_id": 41142745, "comment_id": 69491518, "body": "Looks strange. I cannot think of another reason."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1, "user_id": 7296467, "user_type": "registered", "profile_image": "https://graph.facebook.com/1442640695776896/picture?type=large", "display_name": "Jason", "link": "https://stackoverflow.com/users/7296467/jason"}, "edited": false, "score": 0, "creation_date": 1481743838, "post_id": 41142745, "comment_id": 69503485, "body": "I am still thinking. Are you sure that there is no space after &quot;Arrival&quot; in the name of the sheet?"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1481718664, "creation_date": 1481718664, "answer_id": 41142745, "question_id": 41142638, "link": "https://stackoverflow.com/questions/41142638/cant-solve-error-code-9/41142745#41142745", "title": "Cant solve error code 9", "body": "<p>Declare all your variables like this:</p>\n\n<pre><code>Dim x as long\nDim y as long\ndim z as long\netc.\n</code></pre>\n\n<p>and try again. Probably it would work.</p>\n\n<p>And by the way, excel has only 2^20 rows, which is a bit more than 1 million. You are using 30 million on your loops. Try to think of something else.</p>\n"}, {"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1481719426, "creation_date": 1481719426, "answer_id": 41142985, "question_id": 41142638, "link": "https://stackoverflow.com/questions/41142638/cant-solve-error-code-9/41142985#41142985", "title": "Cant solve error code 9", "body": "<p>I recommend to put</p>\n\n<pre><code>Debug.Print f, z, x\n</code></pre>\n\n<p>before the problematic statement, to monitor the values you are referencing in the worksheet.</p>\n\n<p>The number of rows and columns in a worksheet are limited to:</p>\n\n<ul>\n<li>1,048,576 rows</li>\n<li>16,384 columns</li>\n</ul>\n\n<p>I suspect that the value of <code>x</code> has reached too high for the number of columns in the statement</p>\n\n<blockquote>\n  <p><code>If Worksheets(\"Arrival\").Cells(f, 15).Value = Worksheets(\"Information\").Cells(z, x).Value Then</code></p>\n</blockquote>\n\n<p>hence the <em>Subscript out of range</em>. But it might be as well any of the other numbers (f or z) referencing rows.</p>\n\n<p><code>Debug.Print</code> these values before the statement should make things clear.</p>\n\n<p>p.s.: you'd also declare all you variables a long to avoid further problems.</p>\n\n<pre><code>Dim x As Long, y As Long , z as Long, ....\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7296467, "user_type": "registered", "profile_image": "https://graph.facebook.com/1442640695776896/picture?type=large", "display_name": "Jason", "link": "https://stackoverflow.com/users/7296467/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1481719426, "creation_date": 1481718383, "last_edit_date": 1481718704, "question_id": 41142638, "link": "https://stackoverflow.com/questions/41142638/cant-solve-error-code-9", "title": "Cant solve error code 9", "body": "<p>I'm trying to create a log file. When trying to execute this code I get Error 9; subscript out of range. </p>\n\n<p>I'd really appreciate your help, the code seems to run fine for other files (1 for each month of the year) but not for all, and I don't understand.</p>\n\n<p>! [my code] <a href=\"https://imgur.com/a/w6xmd\" rel=\"nofollow noreferrer\">http://imgur.com/a/w6xmd</a></p>\n\n<p>This is also my first question asked regarding VBA, so if you need more screenshots or information, be sure to ask.</p>\n\n<pre><code>    Sub Information()\n\n    Dim x, y, z, g, h, f, e, d As Integer\n\n'  ---------------------------------------------------------------------------------------------------------------------\n'   Departure\n\n    x = 6\n    y = 12\n    z = 2\n    f = 2\n    g = 16\n    e = 1\n\n    For i = 1 To 300000000\n        If e &gt; 30000000 Then\n            f = f + 1\n            e = 1\n            z = 2\n        Else\n            If Worksheets(\"Arrival\").Cells(f, 15).Value = Worksheets(\"Information\").Cells(z, x).Value Then\n               Worksheets(\"Arrival\").Cells(f, 16).Value = Worksheets(\"Information\").Cells(z, 3).Value\n               Worksheets(\"Arrival\").Cells(f, 14).Value = Worksheets(\"Information\").Cells(z, 4).Value\n               Worksheets(\"Arrival\").Cells(f, 17).Value = Worksheets(\"Information\").Cells(z, 5).Value\n               Worksheets(\"Arrival\").Cells(f, 18).Value = Worksheets(\"Information\").Cells(z, 11).Value\n               Worksheets(\"Arrival\").Cells(f, 19).Value = Worksheets(\"Information\").Cells(z, 7).Value\n\n                z = 2\n                f = f + 1\n\n\n            Else\n\n               z = z + 1\n               e = e + 1\n            End If\n        End If\n    Next i\n\n    End Sub\n</code></pre>\n\n<p>Thanks a LOT in advance,</p>\n\n<p>Jason</p>\n"}, {"tags": ["vba", "excel", "ocx", "regsvr32"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1481718214, "post_id": 41142511, "comment_id": 69487480, "body": "I think it&#39;s common controls you need to get up and running <a href=\"https://support.microsoft.com/en-gb/kb/2746232\" rel=\"nofollow noreferrer\">support.microsoft.com/en-gb/kb/2746232</a>"}, {"owner": {"reputation": 2020, "user_id": 3442153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/hwsHp.jpg?s=128&g=1", "display_name": "K\u1d00\u03c4\u1d22", "link": "https://stackoverflow.com/users/3442153/k%e1%b4%80%cf%84%e1%b4%a2"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1481884188, "post_id": 41142511, "comment_id": 69564332, "body": "Works, thanks! You can make an answer if your want and I will accept"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1481886448, "post_id": 41142511, "comment_id": 69565639, "body": "no probs, they can send you mad things like that :)"}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 1, "last_activity_date": 1481886410, "creation_date": 1481886410, "answer_id": 41183048, "question_id": 41142511, "link": "https://stackoverflow.com/questions/41142511/error-registering-mscal-ocx-for-using-old-calender-in-excel-vba/41183048#41183048", "title": "Error registering mscal.ocx for using old calender in excel vba", "body": "<p>it's common controls you need to get up and running support.microsoft.com/en-gb/kb/2746232 </p>\n"}], "owner": {"reputation": 2020, "user_id": 3442153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/hwsHp.jpg?s=128&g=1", "display_name": "K\u1d00\u03c4\u1d22", "link": "https://stackoverflow.com/users/3442153/k%e1%b4%80%cf%84%e1%b4%a2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "accepted_answer_id": 41183048, "answer_count": 1, "score": 0, "last_activity_date": 1481886410, "creation_date": 1481718019, "question_id": 41142511, "link": "https://stackoverflow.com/questions/41142511/error-registering-mscal-ocx-for-using-old-calender-in-excel-vba", "title": "Error registering mscal.ocx for using old calender in excel vba", "body": "<p>I have different pc's with the same configurations (Win7 Prof with Office 2013, exact same build-number). I have a excel file which uses the old calendar control of office 2007.</p>\n\n<p>To solve this problem I register with administrator rights the <code>mscal.ocx</code>:</p>\n\n<pre><code>regsvr32.exe C:\\temp\\mscal.ocx\n</code></pre>\n\n<p>It gives me an success message on every pc. But on some pc's I can not use the old calendar control.</p>\n\n<p><a href=\"https://i.stack.imgur.com/PgGTq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PgGTq.png\" alt=\"enter image description here\"></a></p>\n\n<p>On the pc's that working the calendar control is seen as above in the red square, the pc's it doesn't work the red square is empty and gives the error</p>\n\n<blockquote>\n  <p>Run Time Error '380' on ListBox [Could not set the Selected property. Invalid property value.]</p>\n</blockquote>\n\n<p>I searched and compared the registry on the pc's for <code>mscal.ocx</code> and they are exactly the same. I also added the reference to the <code>mscal.ocx</code> manualy in vba but still the same problem. </p>\n\n<p>Where else can I look to ensure the ocx is correct added? Any idea how to solve it? Thanks</p>\n"}, {"tags": ["c#", "asp.net", "vba", "interop"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1481717880, "post_id": 41142380, "comment_id": 69487259, "body": "<a href=\"http://www.cpearson.com/excel/LastCell.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/LastCell.aspx</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1503, "user_id": 5993382, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/5069bc485a352f0b58f6e4c6c9727304?s=128&d=identicon&r=PG&f=1", "display_name": "Craig Gallagher", "link": "https://stackoverflow.com/users/5993382/craig-gallagher"}, "edited": false, "score": 0, "creation_date": 1481724804, "post_id": 41144055, "comment_id": 69491910, "body": "is there any way I can delete everything after the last cell with text in it to remove the cell style of J32?"}, {"owner": {"reputation": 922, "user_id": 6124497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc7e273f4fb6461113b19f47881f18d?s=128&d=identicon&r=PG&f=1", "display_name": "nvkrj", "link": "https://stackoverflow.com/users/6124497/nvkrj"}, "reply_to_user": {"reputation": 1503, "user_id": 5993382, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/5069bc485a352f0b58f6e4c6c9727304?s=128&d=identicon&r=PG&f=1", "display_name": "Craig Gallagher", "link": "https://stackoverflow.com/users/5993382/craig-gallagher"}, "edited": false, "score": 0, "creation_date": 1481728682, "post_id": 41144055, "comment_id": 69494535, "body": "You could use the row/column numbers of the last cells with text and the last used range cell to remove formatting of all cells in between? (hope that is clear enough)"}, {"owner": {"reputation": 1503, "user_id": 5993382, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/5069bc485a352f0b58f6e4c6c9727304?s=128&d=identicon&r=PG&f=1", "display_name": "Craig Gallagher", "link": "https://stackoverflow.com/users/5993382/craig-gallagher"}, "edited": false, "score": 0, "creation_date": 1481729253, "post_id": 41144055, "comment_id": 69494893, "body": "Would you mind giving me a small example of how to do this? Thanks"}, {"owner": {"reputation": 922, "user_id": 6124497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc7e273f4fb6461113b19f47881f18d?s=128&d=identicon&r=PG&f=1", "display_name": "nvkrj", "link": "https://stackoverflow.com/users/6124497/nvkrj"}, "reply_to_user": {"reputation": 1503, "user_id": 5993382, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/5069bc485a352f0b58f6e4c6c9727304?s=128&d=identicon&r=PG&f=1", "display_name": "Craig Gallagher", "link": "https://stackoverflow.com/users/5993382/craig-gallagher"}, "edited": false, "score": 0, "creation_date": 1481730419, "post_id": 41144055, "comment_id": 69495608, "body": "I edited the code above to clear formatting for all cells from the last cell containing text to the last used cell."}, {"owner": {"reputation": 1503, "user_id": 5993382, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/5069bc485a352f0b58f6e4c6c9727304?s=128&d=identicon&r=PG&f=1", "display_name": "Craig Gallagher", "link": "https://stackoverflow.com/users/5993382/craig-gallagher"}, "edited": false, "score": 0, "creation_date": 1481736698, "post_id": 41144055, "comment_id": 69499769, "body": "this works for deleting any cell style below the cell with text in it however does not delete the cell style to the right of it.y to do this?"}, {"owner": {"reputation": 922, "user_id": 6124497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc7e273f4fb6461113b19f47881f18d?s=128&d=identicon&r=PG&f=1", "display_name": "nvkrj", "link": "https://stackoverflow.com/users/6124497/nvkrj"}, "reply_to_user": {"reputation": 1503, "user_id": 5993382, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/5069bc485a352f0b58f6e4c6c9727304?s=128&d=identicon&r=PG&f=1", "display_name": "Craig Gallagher", "link": "https://stackoverflow.com/users/5993382/craig-gallagher"}, "edited": false, "score": 0, "creation_date": 1481738129, "post_id": 41144055, "comment_id": 69500511, "body": "Double checked it and it&#39;s working fine for cells below and to the right of the cell with text.."}, {"owner": {"reputation": 1503, "user_id": 5993382, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/5069bc485a352f0b58f6e4c6c9727304?s=128&d=identicon&r=PG&f=1", "display_name": "Craig Gallagher", "link": "https://stackoverflow.com/users/5993382/craig-gallagher"}, "edited": false, "score": 0, "creation_date": 1481738654, "post_id": 41144055, "comment_id": 69500750, "body": "I added another image to show what I meant. Anything below the text was removed however anything to the right didn&#39;t get removed"}, {"owner": {"reputation": 922, "user_id": 6124497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc7e273f4fb6461113b19f47881f18d?s=128&d=identicon&r=PG&f=1", "display_name": "nvkrj", "link": "https://stackoverflow.com/users/6124497/nvkrj"}, "reply_to_user": {"reputation": 1503, "user_id": 5993382, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/5069bc485a352f0b58f6e4c6c9727304?s=128&d=identicon&r=PG&f=1", "display_name": "Craig Gallagher", "link": "https://stackoverflow.com/users/5993382/craig-gallagher"}, "edited": false, "score": 0, "creation_date": 1481739590, "post_id": 41144055, "comment_id": 69501240, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/130629/discussion-between-nvj-and-craig-gallagher\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 922, "user_id": 6124497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc7e273f4fb6461113b19f47881f18d?s=128&d=identicon&r=PG&f=1", "display_name": "nvkrj", "link": "https://stackoverflow.com/users/6124497/nvkrj"}, "is_accepted": true, "score": 1, "last_activity_date": 1481730380, "last_edit_date": 1481730380, "creation_date": 1481722724, "answer_id": 41144055, "question_id": 41142380, "link": "https://stackoverflow.com/questions/41142380/find-last-cell-with-text-in-it/41144055#41144055", "title": "Find last cell with text in it", "body": "<p>Based on the fact that the used range should contain the last cell containing text, you can loop from the last cell in the used range to the first cell (one loop for columns and one for rows) to find the last cell on the worksheet containing text. Check out the following code:</p>\n\n<pre><code>Microsoft.Office.Interop.Excel.Application xlApp;\nMicrosoft.Office.Interop.Excel.Workbook xlWorkBook;\nMicrosoft.Office.Interop.Excel.Worksheet xlWorkSheet;\nMicrosoft.Office.Interop.Excel.Range range;\n\nstring str;\n\n\nxlApp = new Microsoft.Office.Interop.Excel.Application();\nxlWorkBook = xlApp.Workbooks.Open(@\"C:\\Users\\Admin\\Desktop\\testCell.xlsx\", 0, true, 5, \"\", \"\", true, Microsoft.Office.Interop.Excel.XlPlatform.xlWindows, \"\\t\", false, false, 0, true, 1, 0);\nxlWorkSheet = (Microsoft.Office.Interop.Excel.Worksheet)xlWorkBook.Worksheets.get_Item(1);\n\n\nrange = xlWorkSheet.UsedRange;\n\nMicrosoft.Office.Interop.Excel.Range last = xlWorkSheet.Cells.SpecialCells(Microsoft.Office.Interop.Excel.XlCellType.xlCellTypeLastCell, Type.Missing);\n\n\nint lastUsedRow = last.Row;\nint lastUsedColumn = last.Column;\n\nint lastColumn = -1;\n\n// Loop to find the last column containing text\nfor(int i = lastUsedColumn; i &gt; 0; i--)\n{\n    if(xlWorkSheet.Application.WorksheetFunction.CountA(xlWorkSheet.Columns[i]) &gt; 0)\n    {\n        lastColumn = i;\n        break;\n    }\n}\n\nint lastRow = -1;\n\n// Loop to find the last row containing text\nfor (int i = lastUsedRow; i &gt; 0; i--)\n{\n    if (xlWorkSheet.Application.WorksheetFunction.CountA(xlWorkSheet.Rows[i]) &gt; 0)\n    {\n        lastRow = i;\n        break;\n    }\n}\n\nConsole.WriteLine(\"Last row containing text: \" + lastRow);\nConsole.WriteLine(\"Last column containing text: \" + lastColumn);\n\n// Clear formatting of all columns from last cell with text to last cell in used range\n// For columns, you will \nxlWorkSheet.Range[xlWorkSheet.Cells[lastRow, lastColumn+1], xlWorkSheet.Cells[lastUsedRow, lastUsedColumn]].ClearFormats();\n\n// Clear formatting of all rows from last cell with text to last cell in used range\nxlWorkSheet.Rows[(lastRow+1) + \":\" + lastUsedRow].ClearFormats();\n\nConsole.ReadLine();\n\nxlWorkBook.Close(true);\nxlApp.Quit();\n</code></pre>\n"}], "owner": {"reputation": 1503, "user_id": 5993382, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/5069bc485a352f0b58f6e4c6c9727304?s=128&d=identicon&r=PG&f=1", "display_name": "Craig Gallagher", "link": "https://stackoverflow.com/users/5993382/craig-gallagher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 855, "favorite_count": 0, "accepted_answer_id": 41144055, "answer_count": 1, "score": 0, "last_activity_date": 1481738603, "creation_date": 1481717638, "last_edit_date": 1481738603, "question_id": 41142380, "link": "https://stackoverflow.com/questions/41142380/find-last-cell-with-text-in-it", "title": "Find last cell with text in it", "body": "<p>I want to be able to find the last cell that contains text. Currently I'm using Interop this works fine to find the usedRnage however I want it to only find the last cell used that contains text. In this example the the last cell used is J32 I want it to only find the last value which contains text so it should be A26. </p>\n\n<p><a href=\"https://i.stack.imgur.com/yuIFU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yuIFU.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/YPNY2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YPNY2.png\" alt=\"enter image description here\"></a></p>\n\n<p>My code is as fallows</p>\n\n<pre><code>            Excel.Application xlApp;\n            Excel.Workbook xlWorkBook;\n            Excel.Worksheet xlWorkSheet;\n            Excel.Range range;\n\n            string str;\n\n\n            xlApp = new Excel.Application();\n            xlWorkBook = xlApp.Workbooks.Open(@\"C:\\Users\\Craig\\Desktop\\testCell.xlsx\", 0, true, 5, \"\", \"\", true, Microsoft.Office.Interop.Excel.XlPlatform.xlWindows, \"\\t\", false, false, 0, true, 1, 0);\n            xlWorkSheet = (Excel.Worksheet)xlWorkBook.Worksheets.get_Item(1);\n\n\n            range = xlWorkSheet.UsedRange;\n\n\n            // Detect Last used Row / Column - Including cells that contains formulas that result in blank values\n           var iTotalColumns = xlWorkSheet.UsedRange.Columns.Count;\n           var iTotalRows = xlWorkSheet.UsedRange.Rows.Count;\n\n            //Excel.Range last = xlWorkSheet.Cells.SpecialCells(Excel.XlCellType.xlCellTypeLastCell, Type.Missing);\n            //Excel.Range lastRange = xlWorkSheet.get_Range(\"A1\", last);\n\n            Excel.Application xlCell;\n\nExcel.Range last = xlWorkSheet.Cells.SpecialCells(Excel.XlCellType.xlCellTypeLastCell, Type.Missing);\n            Excel.Range usedRange = xlWorkSheet.get_Range(\"A1\", last);\n\n\n            int lastUsedRow = last.Row;\n            int lastUsedColumn = last.Column;\n\n            xlWorkBook.Close(@\"C:\\Users\\Craig\\Desktop\\testCell.xlsx\", true, null);\n            xlApp.Quit();\n</code></pre>\n"}, {"tags": ["vba", "excel", "checkbox", "macros"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1481716164, "post_id": 41141846, "comment_id": 69486177, "body": "are they <code>ActiveX</code> checkboxes ?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1481718098, "post_id": 41141846, "comment_id": 69487410, "body": "Your address is wrong, it&#39;s a sheet, not a range something like <code>.LinkedCell = &quot;Data!$K$5&quot;</code>"}, {"owner": {"reputation": 7, "user_id": 7051821, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SEHy9IbwL5s/AAAAAAAAAAI/AAAAAAAAACw/vayUABoBBDw/photo.jpg?sz=128", "display_name": "Metric Candy", "link": "https://stackoverflow.com/users/7051821/metric-candy"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1481718697, "post_id": 41141846, "comment_id": 69487781, "body": "@ShaiRado They are not activeX checkboxes, but form ones."}, {"owner": {"reputation": 7, "user_id": 7051821, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SEHy9IbwL5s/AAAAAAAAAAI/AAAAAAAAACw/vayUABoBBDw/photo.jpg?sz=128", "display_name": "Metric Candy", "link": "https://stackoverflow.com/users/7051821/metric-candy"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1481718848, "post_id": 41141846, "comment_id": 69487890, "body": "@Nathan_Sav Yes something like that has to be the fact for the checkbox in K5, but it need to run for all the checkboxes in the sheet."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1481719186, "post_id": 41141846, "comment_id": 69488116, "body": "So you want to know how to loop sheets and then work on them?  Look a the <code>worksheets</code> collection"}, {"owner": {"reputation": 7, "user_id": 7051821, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SEHy9IbwL5s/AAAAAAAAAAI/AAAAAAAAACw/vayUABoBBDw/photo.jpg?sz=128", "display_name": "Metric Candy", "link": "https://stackoverflow.com/users/7051821/metric-candy"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1481719723, "post_id": 41141846, "comment_id": 69488478, "body": "@Nathan_Sav I need it to run once for 1 sheet, wich contains 500 checkboxes and give each checkbox a link to a cell on a sheet called &quot;data&quot;. i.e. checkbox on A1 should link to data!A1"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1481721539, "post_id": 41141846, "comment_id": 69489680, "body": "so what is the issue you are having? your linked cell ref needs to be changed to the correct syntax, use the suggestion from rory for that"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 7051821, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SEHy9IbwL5s/AAAAAAAAAAI/AAAAAAAAACw/vayUABoBBDw/photo.jpg?sz=128", "display_name": "Metric Candy", "link": "https://stackoverflow.com/users/7051821/metric-candy"}, "edited": false, "score": 0, "creation_date": 1481722024, "post_id": 41143550, "comment_id": 69490010, "body": "&lt;3 Thanks!!! This worked exactly as I wanted. + ed the comment(it said it was registered but i am to low lvl to show) and marked as answer."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 0, "last_activity_date": 1481721176, "creation_date": 1481721176, "answer_id": 41143550, "question_id": 41141846, "link": "https://stackoverflow.com/questions/41141846/excel-vba-macro-assign-checkboxes-to-cells-in-different-sheet/41143550#41143550", "title": "excel vba macro assign checkboxes to cells in different sheet", "body": "<p>If you wish to link them to the cells that they are over, but on a different sheet:</p>\n\n<pre><code>Sub LinkCheckBoxes()\n   Dim chk As CheckBox\n\n   For Each chk In ActiveSheet.CheckBoxes\n      chk.LinkedCell = \"Data!\" &amp; chk.Topleftcell.address\n   Next chk\n\nEnd Sub\n</code></pre>\n\n<p>Note that this uses the cell under the top left corner of the checkbox shape, which may not be the same as the cell the actual checkbox appears to be over.</p>\n"}], "owner": {"reputation": 7, "user_id": 7051821, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SEHy9IbwL5s/AAAAAAAAAAI/AAAAAAAAACw/vayUABoBBDw/photo.jpg?sz=128", "display_name": "Metric Candy", "link": "https://stackoverflow.com/users/7051821/metric-candy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 911, "favorite_count": 0, "accepted_answer_id": 41143550, "answer_count": 1, "score": 0, "last_activity_date": 1481721176, "creation_date": 1481716106, "question_id": 41141846, "link": "https://stackoverflow.com/questions/41141846/excel-vba-macro-assign-checkboxes-to-cells-in-different-sheet", "title": "excel vba macro assign checkboxes to cells in different sheet", "body": "<p>I am trying to run a macro that will assign all checkboxes in a sheet to the same cell in an other sheet.\nBut i am not good in vba (never done it actually, so read not good as... ).\nI do understand some progamming so this is what i came up with so far, but i am stuck:</p>\n\n<pre><code>    Sub LinkCheckBoxes()\nDim chk As CheckBox\n\nFor Each chk In ActiveSheet.CheckBoxes\n    With chk\n        .LinkedCell = Worksheets(\"data\").Address\n    End With\n\nNext chk\n\nEnd Sub\n</code></pre>\n\n<p>This does not work and I am unable to find the correct code to make it work.\nIt only has to run once, to set the links as they are now unlinked.</p>\n\n<p>(if it runs it will take care of 500 checkboxes for me...)</p>\n\n<p>Thanks </p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1481714800, "post_id": 41141388, "comment_id": 69485356, "body": "either <code>Function hi() As String</code> , or you need to declare <code>hi</code> somewhere. Why do you need a <code>Function</code> ? why not a regular <code>Sub</code> ?"}, {"owner": {"reputation": 855, "user_id": 1805743, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c82f9462a3182e4459d8b30792918cf9?s=128&d=identicon&r=PG", "display_name": "user1805743", "link": "https://stackoverflow.com/users/1805743/user1805743"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1481715259, "post_id": 41141388, "comment_id": 69485630, "body": "thanks Shai Rado. i am not yet selecting function or sub for  a particular reason. first i need to find out how thy work :( see the edited original post, a added 2 images of my error"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1481715469, "post_id": 41141388, "comment_id": 69485755, "body": "Calling a function with parenthesis will return an object, so it&#39;s expecting s=hi() or call hi to just run"}, {"owner": {"reputation": 855, "user_id": 1805743, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c82f9462a3182e4459d8b30792918cf9?s=128&d=identicon&r=PG", "display_name": "user1805743", "link": "https://stackoverflow.com/users/1805743/user1805743"}, "edited": false, "score": 0, "creation_date": 1481715609, "post_id": 41141388, "comment_id": 69485855, "body": "thanks, i guess that&#39;s it. sorry for wasting your time on such stuff."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1481736764, "post_id": 41141388, "comment_id": 69499808, "body": "If you want to call your function from the Immediate pane and print the output then you need to call it like this : <code>? hi()</code>  (same as <code>Debug.Print hi()</code>)"}], "answers": [{"comments": [{"owner": {"reputation": 855, "user_id": 1805743, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c82f9462a3182e4459d8b30792918cf9?s=128&d=identicon&r=PG", "display_name": "user1805743", "link": "https://stackoverflow.com/users/1805743/user1805743"}, "edited": false, "score": 0, "creation_date": 1481715818, "post_id": 41141686, "comment_id": 69485975, "body": "this actually helps me a lot understanding that VBA. Thanks!"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1481715870, "last_edit_date": 1481715870, "creation_date": 1481715603, "answer_id": 41141686, "question_id": 41141388, "link": "https://stackoverflow.com/questions/41141388/return-a-string-from-a-vba-function/41141686#41141686", "title": "Return a string from a VBA function", "body": "<p>You can use 2 ways to implement your \"Hello Worls example.</p>\n\n<p><strong>Option 1:</strong> Simple and good enough for your example, using a regular <code>Sub</code> :</p>\n\n<pre><code>Sub Hi_()\n\nDim HiStr   As String\n\nHiStr = \"Hello World\"\nMsgBox HiStr\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Option 2:</strong> Using a <code>Function</code> with \"Hello World\" example:</p>\n\n<pre><code>Function Hi(TestHi As String) As String\n\n' Input: this function receives a string as a parameter\n' Output: returns a string\n\nHi = \"Test Function with \" &amp; TestHi\n\nEnd Function\n</code></pre>\n\n<p>Now we need a <code>Sub</code> to test the <code>Function</code>:</p>\n\n<pre><code>Sub Test_Hi_Function()\n\nDim TstHiFunc As String\n\n' send \"Hello World\" to Function Hi as a parameter\n' TstHiFunc gets the returnedstring result \nTstHiFunc = Hi(\"Hello World\")\n\n' for debug only\nMsgBox TstHiFunc\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 855, "user_id": 1805743, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c82f9462a3182e4459d8b30792918cf9?s=128&d=identicon&r=PG", "display_name": "user1805743", "link": "https://stackoverflow.com/users/1805743/user1805743"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27494, "favorite_count": 0, "accepted_answer_id": 41141686, "answer_count": 1, "score": 0, "last_activity_date": 1487010260, "creation_date": 1481714705, "last_edit_date": 1487010260, "question_id": 41141388, "link": "https://stackoverflow.com/questions/41141388/return-a-string-from-a-vba-function", "title": "Return a string from a VBA function", "body": "<p>I am following a tutorial and get a compile error at the hello world example function.</p>\n\n<p>What's wrong here?</p>\n\n<p><a href=\"https://i.stack.imgur.com/8JC3E.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8JC3E.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is the code I tried:</p>\n\n<pre><code>Function hi()\n    hi = \"hello world\"\nEnd Function`\n</code></pre>\n\n<p>edit: suggested declarations didn't help\n<a href=\"https://i.stack.imgur.com/Hrf2G.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Hrf2G.png\" alt=\"enter image description here\"></a></p>\n\n<p>edit: getting closer. brackets seem to be a problem when calling \"hi()\"\n<a href=\"https://i.stack.imgur.com/LOYOa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LOYOa.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1481824544, "post_id": 41141013, "comment_id": 69541212, "body": "I am not sure of this error, but why are you pasting to the same <code>Bookmark</code>? The loops also seem redundant, as first loop copies Column B, while second loop copies Columns B:E.  Can you explain why both are necessary?"}, {"owner": {"reputation": 39, "user_id": 7194075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f43a9331bf5e08555e1fa3a88ed4c983?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/7194075/max"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1482137385, "post_id": 41141013, "comment_id": 69635950, "body": "I am doing this as I want to Format the first paste as a heading and the second as a table and didnt know any other way to do this. With the bookmark I am doing this as I am not sure how many tables will be pasted in and thought by adding a new bookmark bellow with the same Name was the easiest method."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1482186478, "post_id": 41141013, "comment_id": 69663601, "body": "Have you tried the answer I suggested below? Did it work?"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 7194075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f43a9331bf5e08555e1fa3a88ed4c983?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/7194075/max"}, "edited": false, "score": 0, "creation_date": 1484295996, "post_id": 41170627, "comment_id": 70460414, "body": "I tried this solution however it pastes the tables inside of each other instead of bellow as instructed to."}, {"owner": {"reputation": 39, "user_id": 7194075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f43a9331bf5e08555e1fa3a88ed4c983?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/7194075/max"}, "edited": false, "score": 0, "creation_date": 1484296007, "post_id": 41170627, "comment_id": 70460418, "body": "Any other solution?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 39, "user_id": 7194075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f43a9331bf5e08555e1fa3a88ed4c983?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/7194075/max"}, "edited": false, "score": 0, "creation_date": 1484314655, "post_id": 41170627, "comment_id": 70471360, "body": "well, I think you need a different Bookmark fir each table. as in the code you  provided, it only looks at 1 name bookmark. or, you need some other solution to paste 1st table at  bookmark, and any subsequent table assign a different Word Range (NOT the bookmark)."}, {"owner": {"reputation": 39, "user_id": 7194075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f43a9331bf5e08555e1fa3a88ed4c983?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/7194075/max"}, "edited": false, "score": 0, "creation_date": 1484316297, "post_id": 41170627, "comment_id": 70472344, "body": "But the bookmark should be deleted when I replace it with my data so therefore when I add the bookmark again it should be the only one."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 39, "user_id": 7194075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f43a9331bf5e08555e1fa3a88ed4c983?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/7194075/max"}, "edited": false, "score": 0, "creation_date": 1484321036, "post_id": 41170627, "comment_id": 70475461, "body": "Yes, it is, but this is what&#39;s happening: you&#39;re using the bookmark to paste the first table, that&#39;s all good. But then you&#39;re assigning a bookmark to the <i>exact same Range</i> (containing the pasted table) for next, and subsequent iterations. You need to adjust/increment the range to the next line in the document, I think."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 0, "last_activity_date": 1481825141, "creation_date": 1481825141, "answer_id": 41170627, "question_id": 41141013, "link": "https://stackoverflow.com/questions/41141013/copy-and-past-loop-from-excel-to-word-coming-up-with-command-error/41170627#41170627", "title": "Copy and past loop from excel to word coming up with Command Error", "body": "<p>Instead of <code>textMarke.PasteSpecial</code> you may try:</p>\n\n<pre><code>textMarke.Select\ndoc.Parent.CommandBars.ExecuteMso \"PasteExcelTableSourceFormatting\"\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 7194075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f43a9331bf5e08555e1fa3a88ed4c983?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/7194075/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481825141, "creation_date": 1481713402, "last_edit_date": 1531164843, "question_id": 41141013, "link": "https://stackoverflow.com/questions/41141013/copy-and-past-loop-from-excel-to-word-coming-up-with-command-error", "title": "Copy and past loop from excel to word coming up with Command Error", "body": "<p>I have this Code running to select cells from Excel between 2 cells defined in my Code and then paste it into word at the Location of a specific bookmark. However when ever I run the Code it works for the first cells between \"start_of_text\", \"end_of_text\" and \"Start_of_table\", \"End_of_table\" but then i get an error on the second textemarke.pastespecial (xlPasteall) saying run time error '4198' Command Failed.</p>\n\n<p>Anyone have any suggestions?</p>\n\n<pre><code>  Dim rownum As Integer\n  Dim colnum As Integer\n  Dim startrow As Integer\n  Dim endrow As Integer\n  Dim textmarke\n\n   rownum = 1\n   colnum = 2\n\n ' Filtering for T1 line\n\n  ThisWorkbook.Worksheets(\"Template-Referenz-Produkte\").Columns(\"A:A\").AutoFilter Field:=1, Criteria1:=\"=&lt;T1 Line&gt;\" _\n    , Operator:=xlOr\n\n\n   ' Find eveything between start of text and end of text\n    With ThisWorkbook.Worksheets(\"Template-Referenz-Produkte\")\n    For rownum = 1 To 10000\n       Do\n         If .Cells(rownum, 2).Value = \"Start_of_text\" Then\n             startrow = rownum + 1\n          End If\n          rownum = rownum + 1\n\n       If (rownum &gt; 10000) Then Exit For\n\n       Loop Until .Cells(rownum, 2).Value = \"End_of_text\"\n       endrow = rownum - 1\n\n       'Select everything from start of text to end of text\n       ThisWorkbook.Worksheets(\"Template-Referenz-Produkte\").Range(\"B\" &amp; startrow &amp; \":B\" &amp; endrow).Copy\n\n       'Paste description from excel sheet\n       Set textmarke = doc.Bookmarks(\"INSERT_T1_LINE_reference_TABLE\").Range\n       textmarke.PasteSpecial (xlPasteAll)\n       textmarke.Style = \"Heading 4\"\n       doc.Bookmarks.Add \"INSERT_T1_LINE_reference_TABLE\", textmarke 'Set the text marker on this specific range.\n\n    ' Find everything between start of table and end of table\n       Do\n          If .Cells(rownum, 2).Value = \"Start_of_table\" Then\n             startrow = rownum + 1\n          End If\n          rownum = rownum + 1\n\n       If (rownum &gt; 10000) Then Exit For\n\n       Loop Until .Cells(rownum, 2).Value = \"End_of_table\"\n       endrow = rownum - 1\n\n      'Select everything from start of table to end of table\n       ThisWorkbook.Worksheets(\"Template-Referenz-Produkte\").Range(\"B\" &amp; startrow &amp; \":E\" &amp; endrow).Copy\n\n       'Paste description from excel sheet\n       Set textmarke = doc.Bookmarks(\"INSERT_T1_LINE_reference_TABLE\").Range\n       textmarke.PasteSpecial (xlPasteAll)\n       doc.Bookmarks.Add \"INSERT_T1_LINE_reference_TABLE\", textmarke 'Set the text marker on this specific range.\n\n    Next rownum\n    End With\n</code></pre>\n"}, {"tags": ["excel", "vba", "listbox"], "comments": [{"owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "edited": false, "score": 0, "creation_date": 1481713553, "post_id": 41140798, "comment_id": 69484646, "body": "You want to remove selected value from sheet <code>Employees</code> column <code>A </code>, and than reload listbox in your your userform, am I right?"}, {"owner": {"reputation": 3, "user_id": 7295764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a04045485fe5d8f3a004f06b09fa24c5?s=128&d=identicon&r=PG&f=1", "display_name": "Sk8freak", "link": "https://stackoverflow.com/users/7295764/sk8freak"}, "reply_to_user": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "edited": false, "score": 0, "creation_date": 1481713979, "post_id": 41140798, "comment_id": 69484892, "body": "That&#39;s right. I want the user to select a value inside the listbox within the userform and have it be deleted from the second sheet &quot;Employees&quot;. Then have the listbox be updated to show the value has been removed so when I close the userform and come back the value will no longer be there. Like I did with the add button."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7295764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a04045485fe5d8f3a004f06b09fa24c5?s=128&d=identicon&r=PG&f=1", "display_name": "Sk8freak", "link": "https://stackoverflow.com/users/7295764/sk8freak"}, "edited": false, "score": 0, "creation_date": 1481757572, "post_id": 41150950, "comment_id": 69509758, "body": "Awesome! This is exactly what I was looking for and its way better utilized with the for each loop. Thank you! :D If you have a way to delete a certain value within a column like column &quot;A&quot; that would be helpful to know in case I decide to use more columns for information. But regardless, this solved my problem!"}, {"owner": {"reputation": 98, "user_id": 3230453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/COYUq.jpg?s=128&g=1", "display_name": "Ricky", "link": "https://stackoverflow.com/users/3230453/ricky"}, "reply_to_user": {"reputation": 3, "user_id": 7295764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a04045485fe5d8f3a004f06b09fa24c5?s=128&d=identicon&r=PG&f=1", "display_name": "Sk8freak", "link": "https://stackoverflow.com/users/7295764/sk8freak"}, "edited": false, "score": 0, "creation_date": 1481759820, "post_id": 41150950, "comment_id": 69510384, "body": "I added a new button to the end to edit a name not delete it. Let me know if you need any other help. Have a great day!"}], "tags": [], "owner": {"reputation": 98, "user_id": 3230453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/COYUq.jpg?s=128&g=1", "display_name": "Ricky", "link": "https://stackoverflow.com/users/3230453/ricky"}, "is_accepted": true, "score": 0, "last_activity_date": 1481759694, "last_edit_date": 1481759694, "creation_date": 1481744796, "answer_id": 41150950, "question_id": 41140798, "link": "https://stackoverflow.com/questions/41140798/how-to-delete-selected-listbox-value-in-userform-using-data-imported-from-separa/41150950#41150950", "title": "How to delete selected listbox value in userform using data imported from separate sheet", "body": "<p>If you are not set on using \"RowSource.\" Here is a different approach.   </p>\n\n<pre><code>Option Explicit\n\nPrivate Sub btnClear_Click()\n\n'Declaring variable to store new name\nDim Employee As String\nDim wsEmployee As Excel.Worksheet\n'Variable to store the length of rows in column.\nDim lRow As Long, LastRow As Long\nDim oCell As Range\n\nempList.RowSource = \"\"\n\nSet wsEmployee = Sheets(\"Employees\")\n\nLastRow = wsEmployee.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor Each oCell In wsEmployee.Range(\"A1:A\" &amp; LastRow)\n    If oCell.Value = empList.Value Then\n        oCell.EntireRow.Delete\n    End If\nNext oCell\n\nlRow = wsEmployee.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nempList.Clear\n\nFor Each oCell In wsEmployee.Range(\"A1:A\" &amp; lRow)\n    If oCell.Value &lt;&gt; \"\" Then\n        empList.AddItem oCell.Value\n    End If\nNext oCell\n\nCleanUp:\n\nSet wsEmployee = Nothing\n\nEnd Sub\n\n\nPrivate Sub UserForm_Initialize()\n\nDim lRow As Long\nDim oCell As Range\nDim wsEmployee As Excel.Worksheet\n\nSet wsEmployee = Sheets(\"Employees\")\n\nempList.RowSource = \"\"\n\nlRow = wsEmployee.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor Each oCell In wsEmployee.Range(\"A1:A\" &amp; lRow)\n    If oCell.Value &lt;&gt; \"\" Then\n        empList.AddItem oCell.Value\n    End If\nNext oCell\n\nCleanUp:\n\nSet wsEmployee = Nothing\n\nEnd Sub\n\n\nPrivate Sub btnAdd_Click()\n'Declaring variable to store new name\nDim Employee As String\nDim oCell As Range\nDim wsEmployee As Excel.Worksheet\n'Variable to store the length of rows in column.\nDim lRow As Long, LastRow As Long\n\nSet wsEmployee = Sheets(\"Employees\")\n\nLastRow = wsEmployee.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n  'Gather User input of name\nEmployee = Application.InputBox(\"Please Enter an Employee Name (No Numbers)\", \"Employee Name\")\n    'Add Employee to Employees sheet and refresh list\nwsEmployee.Range(\"A\" &amp; LastRow + 1).Value = Employee\n\nlRow = wsEmployee.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nempList.Clear\n\n    For Each oCell In wsEmployee.Range(\"A1:A\" &amp; lRow)\n        If oCell.Value &lt;&gt; \"\" Then\n            empList.AddItem oCell.Value\n        End If\n    Next oCell\n\nCleanUp:\n\nSet wsEmployee = Nothing\n\nEnd Sub\n\nPrivate Sub btnEdit_Click()\n\n'Declaring variable to store new name\nDim Employee As String\nDim wsEmployee As Excel.Worksheet\n'Variable to store the length of rows in column.\nDim lRow As Long, LastRow As Long\nDim oCell As Range\n\nempList.RowSource = \"\"\n\nSet wsEmployee = Sheets(\"Employees\")\n\nLastRow = wsEmployee.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor Each oCell In wsEmployee.Range(\"A1:A\" &amp; LastRow)\nIf oCell.Value = empList.Value Then\n    Employee = Application.InputBox(\"Please Edit an Employee Name (No Numbers)\", \"Employee Name\")\n    oCell.Value = Employee\nEnd If\nNext oCell\n\nlRow = wsEmployee.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nempList.Clear\n\nFor Each oCell In wsEmployee.Range(\"A1:A\" &amp; lRow)\nIf oCell.Value &lt;&gt; \"\" Then\n    empList.AddItem oCell.Value\nEnd If\nNext oCell\n\nCleanUp:\n\nSet wsEmployee = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>I hope that helps you out.  I am at work at the moment.  If you would like further assistance please let me know and i will add in better notes. I build it and tested it. It will delete the entire row. let me know if you would like just the name deleted. </p>\n"}], "owner": {"reputation": 3, "user_id": 7295764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a04045485fe5d8f3a004f06b09fa24c5?s=128&d=identicon&r=PG&f=1", "display_name": "Sk8freak", "link": "https://stackoverflow.com/users/7295764/sk8freak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1083, "favorite_count": 0, "accepted_answer_id": 41150950, "answer_count": 1, "score": 0, "last_activity_date": 1563511805, "creation_date": 1481712836, "last_edit_date": 1563511805, "question_id": 41140798, "link": "https://stackoverflow.com/questions/41140798/how-to-delete-selected-listbox-value-in-userform-using-data-imported-from-separa", "title": "How to delete selected listbox value in userform using data imported from separate sheet", "body": "<p>When I have the user click on a button to open a userform it displays a listbox (empList) containing a list of employees.</p>\n\n<p>The data is retrieved through a hidden sheet within the workbook called \"Employees\" when the userform is initialized.</p>\n\n<p>I have an \"Add\" button and \"Delete\" button to add or delete employees from the list. The add button seems to work by adding a value to the end of the list by inserting the new employee value into the next available open slot of column \"A\" in my Employees worksheet and refreshing the list to display the new changes.</p>\n\n<p>By my knowledge I know how to remove a selected value from a listbox by targeting the list itself, but how can you delete a selected value on the list by removing it from the second sheet where the data is being imported?</p>\n\n<p>Here is my code for the add button:</p>\n\n<pre><code>Private Sub btnAdd_Click()\n    'Declaring variable to store new name\n    Dim Employee As String\n    'Variable to store the length of rows in column.\n    Dim lRow As Long\n    'Gather User input of name\n    Employee = Application.InputBox(\"Please Enter an Employee Name (No Numbers)\", \"Employee Name\")\n    'Add Employee to Employees sheet and refresh list\n    Sheets(\"Employees\").Range(\"A1\").End(xlDown).Offset(1, 0).Value = Employee\n    lRow = Sheets(\"Employees\").UsedRange.Rows(Sheets(\"Employees\").UsedRange.Rows.Count).Row\n    empList.RowSource = \"Employees!A1:A\" &amp; lRow\nEnd Sub\n</code></pre>\n\n<p>And here is my code for when the userform is initialized:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    Dim lRow As Long\n    lRow =Sheets(\"Employees\").UsedRange.Rows(Sheets(\"Employees\").UsedRange.Rows.Count).Row\n    empList.RowSource = \"Employees!A1:A\" &amp; lRow\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "edited": false, "score": 0, "creation_date": 1481713029, "post_id": 41140786, "comment_id": 69484303, "body": "The double quotes. Where you need to show a quote as text use Chr(34) instead. Like <code>Chr(34) &amp; &quot;Model&quot; &amp; Chr(34)</code> instead of <code>&quot;&quot;Model&quot;&quot;</code>"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1481713228, "post_id": 41140786, "comment_id": 69484425, "body": "@OAK is <code>x</code> suppose to be a different row number in Column A ?"}, {"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "reply_to_user": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "edited": false, "score": 0, "creation_date": 1481713679, "post_id": 41140786, "comment_id": 69484723, "body": "Alternatively to @Moacir&#39;s suggestion, you can double up on the quotes to use them as a literal <code>&quot;</code> character. For example, <code>&quot;&quot;&quot;Model&quot;&quot;&quot;</code> - the outer quotes are the string delimiters, and the <code>&quot;&quot;</code> preceding and following the word <code>Model</code> represents a literal <code>&quot;</code>."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1481714405, "post_id": 41140786, "comment_id": 69485145, "body": "What means the second line ??? <code>x = Range(&quot;A139&quot;).Activate</code>"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1481716743, "post_id": 41140786, "comment_id": 69486554, "body": "Since <code>Model</code> is a sheet name (I hope so) it doesn&#39;t need the <code>&quot;&quot;</code> , just the <code>!</code> at the end, so your formula shousd be : <code>&quot;=INDEX(Model!$A$3:$Z$1000,MATCH($&quot; &amp; x &amp; &quot;,Model!$A$3:$A$1000,0),MATCH(E$3,Model!$A$3:$Z$3,0))&quot;</code> . If you could just tell us what does <code>x</code> suppose to be ???"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1481721232, "post_id": 41140786, "comment_id": 69489476, "body": "what is X ? is it the value in Range(&quot;A139&quot;) ? is it the Address of the cell ? or you suppose to <code>Select</code> it? if yes, why ? you realy don&#39;t need to"}, {"owner": {"reputation": 2334, "user_id": 1889418, "user_type": "registered", "accept_rate": 16, "profile_image": "https://www.gravatar.com/avatar/c46eb3814bc8bb24c1a4d3f3e20d6b12?s=128&d=identicon&r=PG", "display_name": "OAK", "link": "https://stackoverflow.com/users/1889418/oak"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1481724700, "post_id": 41140786, "comment_id": 69491847, "body": "@ShaiRado thanks for the information. I tried to revise my initial post and add more information."}], "answers": [{"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 0, "last_activity_date": 1481714485, "creation_date": 1481714485, "answer_id": 41141312, "question_id": 41140786, "link": "https://stackoverflow.com/questions/41140786/excel-vba-syntax-error/41141312#41141312", "title": "excel vba - syntax error", "body": "<p>Type a correct working formula in E139 then use <a href=\"http://idevlop.blogspot.lu/2009/09/generer-du-vba-avec-excel-vba.html\" rel=\"nofollow noreferrer\">this little Sub</a> I wrote once, to turn it into a vba usable formula string.</p>\n\n<pre><code> Sub RngToVba(src As Range)  \n 'writes the VBA code to re-create the formulae in given range  \n 'by Patrick Honorez - www.idevlop.com  \n 'usage: from debug window, type RngToVba [L14:R14]  \n ' or RngToVba range(\"L14:R14\")  \n  Dim c As Range  \n  For Each c In src  \n  Debug.Print \"range(\"\"\" &amp; c.Address &amp; \"\"\").formula = \"\"\" &amp; _  \n        Replace(c.Formula, \"\"\"\", \"\"\"\"\"\") &amp; \"\"\"\"\"\"  \n  Next c  \n End Sub \n</code></pre>\n\n<p>And...for god's sake, stop using those useless <code>select</code> and <code>activate</code>. </p>\n\n<pre><code>Sheets(\"Totals\").Range(\"E139:AB166\").Formula = someString\n</code></pre>\n\n<p>is faster, easier to debug, and more readable.</p>\n"}], "owner": {"reputation": 2334, "user_id": 1889418, "user_type": "registered", "accept_rate": 16, "profile_image": "https://www.gravatar.com/avatar/c46eb3814bc8bb24c1a4d3f3e20d6b12?s=128&d=identicon&r=PG", "display_name": "OAK", "link": "https://stackoverflow.com/users/1889418/oak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 464, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481722215, "creation_date": 1481712792, "last_edit_date": 1481722215, "question_id": 41140786, "link": "https://stackoverflow.com/questions/41140786/excel-vba-syntax-error", "title": "excel vba - syntax error", "body": "<p>I can't quite figure out what the syntax error in Excel VBA is, the error I am seeing is: \"run-time error 1004: Application-defined or object-defined error\"</p>\n\n<pre><code>Sheets(\"Totals\").Select\nx = Range(\"A139\").Activate\nRange(\"E139:AB166\").Formula = \"=INDEX(\"\"Model\"\"!$A$3:$Z$1000,MATCH($\" &amp; x &amp; \",\"\"Model\"\"!$A$3:$A$1000,0),MATCH(E$3,\"\"Model\"\"!$A$3:$Z$3,0))\"\n</code></pre>\n\n<p>I am attempting to use an Index Match Match formula where the index reference is another worksheet in the file. I am trying to populate the formula in Range E139:AB166, such that the x variable is locked to Column A and the last match function is locked on the third row (E$3).</p>\n\n<pre><code>x = Range(\"A139\").Activate\n</code></pre>\n\n<p>This line of code should force the cursor to that cell in the 'model' worksheet. 'Model' is the name of the worksheet in the file. I thought \"\" were necessary to alert vba that the string refers to the worksheet name.\nWhat if the worksheet name is comprised of two strings so \"Model 1\". What would be then the syntax, this?</p>\n\n<pre><code>\"\"Model 1\"\"!A3\n</code></pre>\n\n<p>'x' is the cell where new data is added, I wrote a line of code to have it dynamically changed. </p>\n\n<pre><code>x = Range(\"A\" &amp; insert_at).Activate\n</code></pre>\n\n<p>Where insert_at is a variable that equals the last row,in the worksheet that is not empty, + 1.</p>\n\n<pre><code>insert_at = lastRow + 1\n</code></pre>\n\n<p>So the idea is to dynamically add additional data from the 'Model' worksheet to the current worksheet 'Totals' below any existing data in the 'Totals worksheet.</p>\n\n<p>I appreciate any assistance with this.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1481710118, "post_id": 41139583, "comment_id": 69482541, "body": "Have you looked at this? <a href=\"https://msdn.microsoft.com/en-us/library/office/ff197651.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff197651.aspx</a>"}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 3993827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4fe8aa4f7628700a6ed3942dd6ffebdd?s=128&d=identicon&r=PG&f=1", "display_name": "Vitor Barreto", "link": "https://stackoverflow.com/users/3993827/vitor-barreto"}, "edited": false, "score": 0, "creation_date": 1481719618, "post_id": 41142920, "comment_id": 69488398, "body": "Thank you. Worked very well."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1481719203, "creation_date": 1481719203, "answer_id": 41142920, "question_id": 41139583, "link": "https://stackoverflow.com/questions/41139583/applying-filter-to-access-subform/41142920#41142920", "title": "Applying filter to Access Subform", "body": "<p>You don't need any code at all. </p>\n\n<p>Use the <em>LinkMasterFields</em> and <em>LinkChildFields</em> of the subform control holding the subform. Set the master field to <code>TxtToday</code> and the child field to <code>DATE_FOLLOWUP</code>.</p>\n"}], "owner": {"reputation": 175, "user_id": 3993827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4fe8aa4f7628700a6ed3942dd6ffebdd?s=128&d=identicon&r=PG&f=1", "display_name": "Vitor Barreto", "link": "https://stackoverflow.com/users/3993827/vitor-barreto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 787, "favorite_count": 0, "accepted_answer_id": 41142920, "answer_count": 1, "score": -1, "last_activity_date": 1481719203, "creation_date": 1481709318, "question_id": 41139583, "link": "https://stackoverflow.com/questions/41139583/applying-filter-to-access-subform", "title": "Applying filter to Access Subform", "body": "<p>Maybe this one is easy, because i was able to do it via a simple Macro before, but via VBA i just couldn't get it right.</p>\n\n<p>I'm trying via VBA to filter a subform by trying to apply a DoCmd.Applyfilter command.</p>\n\n<p>I have a data field called TxtToday which has Date() as a default value. I would like to apply on form load a filter which would filter the records on subform which have the same date as the TxtToday field.</p>\n\n<p>As of now i have this code:</p>\n\n<pre><code>Private Sub Form_Load()\n\nDoCmd.ApplyFilter DATE_FOLLOWUP = TxtToday\n\nEnd Sub\n</code></pre>\n\n<p>Thanks for any help.</p>\n"}, {"tags": ["excel", "vba", "comments", "worksheet", "protection"], "answers": [{"comments": [{"owner": {"reputation": 445, "user_id": 4925676, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/000d092f7af6da5c514a3c11d4e132f7?s=128&d=identicon&r=PG&f=1", "display_name": "MrPea", "link": "https://stackoverflow.com/users/4925676/mrpea"}, "edited": false, "score": 0, "creation_date": 1481733381, "post_id": 41138909, "comment_id": 69497702, "body": "thanks for your response.  Yeah that&#39;s an option.  the spreadsheet is 3000 rows and 150 odd columns so it&#39;s going to be annoying for the user to have to navigate back to a button for every cell they want to comment in.  Alternatively I could check if a control has been deleted and undo the action but it doesn&#39;t appear to trigger a sheet event when a control is deleted."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1481707388, "creation_date": 1481707388, "answer_id": 41138909, "question_id": 41138728, "link": "https://stackoverflow.com/questions/41138728/in-excel-vba-how-can-i-enable-comments-on-a-protected-sheet-but-still-protect-fo/41138909#41138909", "title": "In Excel VBA how can I enable comments on a protected sheet but still protect form controls", "body": "<p>Is there a way of enabling comments but protecting the form controls?</p>\n\n<p>Not that I know of. But you may come up with a workaround :)\nLike this:</p>\n\n<ul>\n<li>build a form, that has a text box and a button. Call the form with a shortcut, it would be easier;</li>\n<li>select the cell you want to insert a comment to and call the form;</li>\n<li>write the comment inside the form and press the button;</li>\n</ul>\n\n<p>Something like this may be put in the code of the form. <code>commentCell</code> is the selected cell. Probably some check how many cells are selected can be added as well:</p>\n\n<pre><code>ActiveSheet.Unprotect Password:=sPassword\nRange(commentCell.Address).AddComment\nRange(commentCell.Address).Comment.Text Text:=MyComment\nActiveSheet.Protect Password:=sPassword\n</code></pre>\n"}], "owner": {"reputation": 445, "user_id": 4925676, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/000d092f7af6da5c514a3c11d4e132f7?s=128&d=identicon&r=PG&f=1", "display_name": "MrPea", "link": "https://stackoverflow.com/users/4925676/mrpea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1706, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481707388, "creation_date": 1481706837, "question_id": 41138728, "link": "https://stackoverflow.com/questions/41138728/in-excel-vba-how-can-i-enable-comments-on-a-protected-sheet-but-still-protect-fo", "title": "In Excel VBA how can I enable comments on a protected sheet but still protect form controls", "body": "<p>I have a protected Excel sheet. It has form controls and I have assigned macros to them.  I can enable comments on this sheet by using </p>\n\n<p>.Protect DrawingObjects:=False</p>\n\n<p>but this also allows any form controls to be deleted.</p>\n\n<p>I could change the form controls to activeX controls but this would prevent Mac users using it.</p>\n\n<p>Is there a way of enabling comments but protecting the form controls? </p>\n\n<p>thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "edited": false, "score": 2, "creation_date": 1481706255, "post_id": 41138380, "comment_id": 69480165, "body": "I think a part of your range&#39;s value has nice. In that case you should use <code>InStr(1, Range(&quot;H&quot; &amp; a).Value, &quot;nice&quot;, vbTextCompare) &gt; 0</code>"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1482398719, "post_id": 41138380, "comment_id": 69761007, "body": "@aj_bk have you tried any of the answers below ? any feedbacks would be nice..."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1481707402, "post_id": 41138528, "comment_id": 69480840, "body": "You don&#39;t even need the &gt;0 for this to work. Don&#39;t you also need a 1 as the first parameter in the InStr()?"}, {"owner": {"reputation": 164, "user_id": 6642555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577698e5f4d6349809bb9dd3c9af2ea9?s=128&d=identicon&r=PG&f=1", "display_name": "Mak", "link": "https://stackoverflow.com/users/6642555/mak"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1481707833, "post_id": 41138528, "comment_id": 69481098, "body": "@CallumDA,the first parameter is unnecessary, instr will start from the first letter in VBA. You can try that if you don&#39;t believe."}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1481707900, "post_id": 41138528, "comment_id": 69481139, "body": "I thought that might be the case, although I&#39;d probably call it optional rather than <i>unnecessary</i> :)"}], "tags": [], "owner": {"reputation": 164, "user_id": 6642555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577698e5f4d6349809bb9dd3c9af2ea9?s=128&d=identicon&r=PG&f=1", "display_name": "Mak", "link": "https://stackoverflow.com/users/6642555/mak"}, "is_accepted": false, "score": 1, "last_activity_date": 1481706218, "creation_date": 1481706218, "answer_id": 41138528, "question_id": 41138380, "link": "https://stackoverflow.com/questions/41138380/if-range-of-cells-contains-string-then-goto/41138528#41138528", "title": "if range of cells contains string then goto", "body": "<pre><code>If (Range(\"H\" &amp; a).Value = \"*nice*\") Then\n</code></pre>\n\n<p>change to </p>\n\n<pre><code>If instr(Range(\"H\" &amp; a).Value,\"nice\")&gt;0 Then\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "edited": false, "score": 0, "creation_date": 1481712602, "post_id": 41138573, "comment_id": 69484040, "body": "its still skipping clean an jumping to pre even tho the range containe &quot;nice&quot; :("}, {"owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "edited": false, "score": 0, "creation_date": 1481712711, "post_id": 41138573, "comment_id": 69484106, "body": "there are many words in the range and ig &quot;nice&quot; is in them then it needs to go to clean. e.x. &quot;the boy is very nice today&quot; - this has the word &quot;nice&quot; so go to clean code"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "edited": false, "score": 0, "creation_date": 1481712960, "post_id": 41138573, "comment_id": 69484268, "body": "What is the address of the range?"}, {"owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "edited": false, "score": 0, "creation_date": 1481714309, "post_id": 41138573, "comment_id": 69485081, "body": "address? like from where to where? &quot;h4:h20&quot;"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "edited": false, "score": 0, "creation_date": 1481717498, "post_id": 41138573, "comment_id": 69487015, "body": "You can write <code>stop</code> before <code>goto clean</code> and check whether it stops."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1481706322, "creation_date": 1481706322, "answer_id": 41138573, "question_id": 41138380, "link": "https://stackoverflow.com/questions/41138380/if-range-of-cells-contains-string-then-goto/41138573#41138573", "title": "if range of cells contains string then goto", "body": "<p>Try something like this:</p>\n\n<pre><code>Option Explicit\nSub TestMe()\n    Dim a As Long\n\n    For a = 4 To 20\n        If InStr(1, Range(\"H\" &amp; a).Value, \"nice\") Then\n            GoTo Clean\n        Else\n            GoTo pre\n        End If\n    Next code here\n\nEnd Sub\n</code></pre>\n\n<p>Just one <strong>big reminder</strong> - try to avoid goto statements, as far as they are considered really bad practise in VBA develelopment. What you can do is to create another sub routine and to call it from the code.</p>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 2, "last_activity_date": 1481707167, "creation_date": 1481707167, "answer_id": 41138840, "question_id": 41138380, "link": "https://stackoverflow.com/questions/41138380/if-range-of-cells-contains-string-then-goto/41138840#41138840", "title": "if range of cells contains string then goto", "body": "<p>You can use the <code>Like</code> with the wildcard (<code>*</code>) before and after \"nice\", like :</p>\n\n<pre><code>If Range(\"H\" &amp; a).Value Like \"*nice*\" Then\n</code></pre>\n\n<p>Adding this line into your entire code:</p>\n\n<pre><code>Option Explicit\n\nSub TestLike()\n\nDim a As Long\n\nFor a = 4 To 20\n    If Range(\"H\" &amp; a).Value Like \"*nice*\" Then\n        GoTo Clean\n    Else\n        GoTo pre\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "edited": false, "score": 0, "creation_date": 1481712812, "post_id": 41138862, "comment_id": 69484167, "body": "idk how to do that so im using &quot;go to&quot;"}], "tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": false, "score": 1, "last_activity_date": 1481707230, "creation_date": 1481707230, "answer_id": 41138862, "question_id": 41138380, "link": "https://stackoverflow.com/questions/41138380/if-range-of-cells-contains-string-then-goto/41138862#41138862", "title": "if range of cells contains string then goto", "body": "<p>At the moment you're looking for the string *nice*. The asterisks are not being treated as wildcards.</p>\n\n<p>You can use the <a href=\"https://msdn.microsoft.com/en-us/library/swf8kaxw.aspx\" rel=\"nofollow noreferrer\"><code>Like</code></a> operator, this will then allow you to use asterisks as wildcards:</p>\n\n<pre><code>If (Range(\"H\" &amp; a).Value Like \"*nice*\") Then\n</code></pre>\n\n<p>You can then expand on this; if you only want the word 'nice' to match, and not other words that contain 'nice', you can use the below:</p>\n\n<pre><code>If \" \" &amp; UCase((Range(\"H\" &amp; a).Value) &amp; \" \" Like \"[!A-Z]*NICE*[!A-Z]\"\n</code></pre>\n\n<p>Whilst using <code>Like</code> is slower than using <code>InStr</code>, it allows more complex matching, due to it's similar syntax to RegEx.</p>\n\n<p>I would also suggest, that instead of using the <code>GoTo</code> statement, you use a function or sub procedure for each piece of code that you wish to run.</p>\n"}], "owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4434, "favorite_count": 0, "accepted_answer_id": 41138840, "answer_count": 4, "score": 3, "last_activity_date": 1481707230, "creation_date": 1481705770, "last_edit_date": 1481707060, "question_id": 41138380, "link": "https://stackoverflow.com/questions/41138380/if-range-of-cells-contains-string-then-goto", "title": "if range of cells contains string then goto", "body": "<p>I know this is a topic that is talks about a lot, but I just cant find the answer.</p>\n\n<p>I have a range. if in that range there is a word then I need it to go to the next code. if not, than skip the next code and move on.</p>\n\n<p>I'm unable to define the range.  </p>\n\n<p>this is my code:</p>\n\n<pre><code>For a = 4 To 20\n    If (Range(\"H\" &amp; a).Value = \"*nice*\") Then\n        GoTo Clean \n    Else\n        GoTo pre\n    End If\nNext \n</code></pre>\n\n<p>In the range I do have the word \"nice\" but it still skips clean and goes straight to pre.</p>\n\n<p>whats wrong? how do i define my range and how can the code understand that in my range the word nice\" IS IN there.</p>\n"}, {"tags": ["vba", "excel", "ribbon"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1481707617, "post_id": 41137979, "comment_id": 69480955, "body": "Is the AddIn VBA?"}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 3759627, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c9bf4811dbe58a731d49753d8bdaf89b?s=128&d=identicon&r=PG&f=1", "display_name": "Horace", "link": "https://stackoverflow.com/users/3759627/horace"}, "edited": false, "score": 0, "creation_date": 1481711312, "post_id": 41138800, "comment_id": 69483219, "body": "Yes asking for a programmable interface is something I am pushing in parallel."}, {"owner": {"reputation": 153, "user_id": 3759627, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c9bf4811dbe58a731d49753d8bdaf89b?s=128&d=identicon&r=PG&f=1", "display_name": "Horace", "link": "https://stackoverflow.com/users/3759627/horace"}, "edited": false, "score": 0, "creation_date": 1481711374, "post_id": 41138800, "comment_id": 69483264, "body": "I was hoping there is a way to recognize text and links and therefore it will know where to click.  For the interface stuff, changes will come very slow, and perhaps with some image recognition I can recognize the buttons or at least recognize when the interface changes and abort code"}], "tags": [], "owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "is_accepted": false, "score": 1, "last_activity_date": 1481707057, "creation_date": 1481707057, "answer_id": 41138800, "question_id": 41137979, "link": "https://stackoverflow.com/questions/41137979/accessing-excel-ribbon-buttons-and-controls/41138800#41138800", "title": "Accessing Excel Ribbon Buttons and Controls", "body": "<p>To use webpages, you should use <a href=\"https://codingislove.com/browser-automation-in-excel-selenium/\" rel=\"nofollow noreferrer\">Selenium</a>.</p>\n\n<p>Simulating mouse clicks is never a great solution. What if the interface changes, or you try to use it on a different screen with different resolution, where everything is not where it used to be?</p>\n\n<p>Anyway, you can either send mouse click using VBA:</p>\n\n<pre><code>Public Declare Function SetCursorPos Lib \"user32\" (ByVal x As Long, ByVal y As Long) As Long\nPublic Declare Sub mouse_event Lib \"user32\" (ByVal dwFlags As Long, ByVal dx As Long, ByVal dy As Long, ByVal cButtons As Long, ByVal dwExtraInfo As Long)\nPublic Const MOUSEEVENTF_LEFTDOWN = &amp;H2\nPublic Const MOUSEEVENTF_LEFTUP = &amp;H4\nPublic Const MOUSEEVENTF_RIGHTDOWN As Long = &amp;H8\nPublic Const MOUSEEVENTF_RIGHTUP As Long = &amp;H10\n\nPrivate Sub SingleClick()\n  SetCursorPos 100, 100 'x and y position\n  mouse_event MOUSEEVENTF_LEFTDOWN, 0, 0, 0, 0\n  mouse_event MOUSEEVENTF_LEFTUP, 0, 0, 0, 0\nEnd Sub\n</code></pre>\n\n<p>Or you can use an external program like <a href=\"https://www.autoitscript.com/site/autoit/\" rel=\"nofollow noreferrer\">AutoIt</a>.</p>\n\n<p>But it would be way way better to talk to the autohours of the plugin, and ask for a programmable interface. That would be a lot more robust.</p>\n"}, {"comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1481710264, "post_id": 41139518, "comment_id": 69482625, "body": "Or possible rename to zip, look at the custom ribbon that&#39;s been put in place at the action calls, then you can reference the addin and make the same calls."}, {"owner": {"reputation": 153, "user_id": 3759627, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c9bf4811dbe58a731d49753d8bdaf89b?s=128&d=identicon&r=PG&f=1", "display_name": "Horace", "link": "https://stackoverflow.com/users/3759627/horace"}, "edited": false, "score": 0, "creation_date": 1481711205, "post_id": 41139518, "comment_id": 69483147, "body": "In the zip there is only my xla file, no bin file from the archive."}, {"owner": {"reputation": 153, "user_id": 3759627, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c9bf4811dbe58a731d49753d8bdaf89b?s=128&d=identicon&r=PG&f=1", "display_name": "Horace", "link": "https://stackoverflow.com/users/3759627/horace"}, "edited": false, "score": 0, "creation_date": 1481711282, "post_id": 41139518, "comment_id": 69483196, "body": "In the link CommonSense gave, I would need an old computer with XP and Excel 07, two things that I do not have"}, {"owner": {"reputation": 3655, "user_id": 6634373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLqp9.png?s=128&g=1", "display_name": "CommonSense", "link": "https://stackoverflow.com/users/6634373/commonsense"}, "reply_to_user": {"reputation": 153, "user_id": 3759627, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c9bf4811dbe58a731d49753d8bdaf89b?s=128&d=identicon&r=PG&f=1", "display_name": "Horace", "link": "https://stackoverflow.com/users/3759627/horace"}, "edited": false, "score": 0, "creation_date": 1481713495, "post_id": 41139518, "comment_id": 69484606, "body": "@user3759627 Eh, you dont need a rusty computer to do this, but if your add-in is .xla file - bad news for you. Renaming to .zip works well with .xlam add-ins, because they&#39;re .zip archives with .xml documents inside. .xla add-ins is old format and structure of this file is secret to me, sorry."}, {"owner": {"reputation": 3655, "user_id": 6634373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLqp9.png?s=128&g=1", "display_name": "CommonSense", "link": "https://stackoverflow.com/users/6634373/commonsense"}, "reply_to_user": {"reputation": 153, "user_id": 3759627, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c9bf4811dbe58a731d49753d8bdaf89b?s=128&d=identicon&r=PG&f=1", "display_name": "Horace", "link": "https://stackoverflow.com/users/3759627/horace"}, "edited": false, "score": 1, "creation_date": 1481714396, "post_id": 41139518, "comment_id": 69485139, "body": "@user3759627, but if you interested in source code, you can easy convert .xla to .xlam. Just open .xla file in excel, open immediate window and exec line &quot;thisworkbook.isaddin = false&quot; withnout quotes, then you can save your addin as .xlam and try my answer again."}, {"owner": {"reputation": 153, "user_id": 3759627, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c9bf4811dbe58a731d49753d8bdaf89b?s=128&d=identicon&r=PG&f=1", "display_name": "Horace", "link": "https://stackoverflow.com/users/3759627/horace"}, "edited": false, "score": 0, "creation_date": 1481714897, "post_id": 41139518, "comment_id": 69485409, "body": "oh ok you mean to change the extension, will try right now after i take a dump"}, {"owner": {"reputation": 153, "user_id": 3759627, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c9bf4811dbe58a731d49753d8bdaf89b?s=128&d=identicon&r=PG&f=1", "display_name": "Horace", "link": "https://stackoverflow.com/users/3759627/horace"}, "edited": false, "score": 0, "creation_date": 1481722392, "post_id": 41139518, "comment_id": 69490240, "body": "@CommonSense You are more than common sense. That worked awesomely. Thanks!!"}], "tags": [], "owner": {"reputation": 3655, "user_id": 6634373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLqp9.png?s=128&g=1", "display_name": "CommonSense", "link": "https://stackoverflow.com/users/6634373/commonsense"}, "is_accepted": false, "score": 1, "last_activity_date": 1481709154, "creation_date": 1481709154, "answer_id": 41139518, "question_id": 41137979, "link": "https://stackoverflow.com/questions/41137979/accessing-excel-ribbon-buttons-and-controls/41139518#41139518", "title": "Accessing Excel Ribbon Buttons and Controls", "body": "<p>You can try to replace pass to addin (if this addin was created with excel, but looks like it was) with Hex Editor, so you need only Hex Editor (e.g. Xvi32).</p>\n\n<p>Ok, let's try it:</p>\n\n<ol>\n<li>Rename your add-in file to zip (filename.xlam -> filename.xlam.zip)</li>\n<li>Extract vbaProject.bin from that archive</li>\n<li>Open vbaProject.bin with Hex Editor and find string \"DPB\"\n<a href=\"https://i.stack.imgur.com/GeLWc.png\" rel=\"nofollow noreferrer\">picture</a></li>\n<li>Replace DPB with DPx, save file and Drop that bastard back into archive with replace.</li>\n<li>Rename file back to .xlam (filename.xlam.zip -> filename.xlam)</li>\n<li>Open it, some errors would pop-up, but dont worry, we are hackers, just accept it and move on!</li>\n<li>Right click on addon in VBE editor, go to properties -> protection</li>\n<li>Set new password, save add-in and re-open it to see no errors here.</li>\n</ol>\n\n<p>Cheers (:</p>\n"}], "owner": {"reputation": 153, "user_id": 3759627, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c9bf4811dbe58a731d49753d8bdaf89b?s=128&d=identicon&r=PG&f=1", "display_name": "Horace", "link": "https://stackoverflow.com/users/3759627/horace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 459, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1481709154, "creation_date": 1481704230, "last_edit_date": 1531164843, "question_id": 41137979, "link": "https://stackoverflow.com/questions/41137979/accessing-excel-ribbon-buttons-and-controls", "title": "Accessing Excel Ribbon Buttons and Controls", "body": "<p>At work we have an add-in with some ribbon buttons for us to use. The add-in is password protected and we cannot even see what those ribbon buttons are calling. So there is no way for me that I know of to see any names of any subroutines or macros within the add-in.</p>\n\n<p>I was wondering if it was possible to code something that would mimic the clicking of the buttons? I need something that can interact with these buttons. I am hoping this is possible as later on I would also like to code something that can click links on webpages and buttons on other programs.</p>\n\n<p>Horace</p>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "reply_to_user": {"reputation": 27, "user_id": 619564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc22abb13ca79730f5de1a0027aa3b08?s=128&d=identicon&r=PG", "display_name": "Harkirat", "link": "https://stackoverflow.com/users/619564/harkirat"}, "edited": false, "score": 0, "creation_date": 1481824090, "post_id": 41139728, "comment_id": 69540992, "body": "Glad it worked for you Harkirat. If you can, please up vote the answer. Thanks!"}, {"owner": {"reputation": 27, "user_id": 619564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc22abb13ca79730f5de1a0027aa3b08?s=128&d=identicon&r=PG", "display_name": "Harkirat", "link": "https://stackoverflow.com/users/619564/harkirat"}, "edited": false, "score": 0, "creation_date": 1481951297, "post_id": 41139728, "comment_id": 69590858, "body": "I did upvote, but apparently i am not reputable enough for it to show"}], "tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": true, "score": 0, "last_activity_date": 1481709770, "creation_date": 1481709770, "answer_id": 41139728, "question_id": 41137836, "link": "https://stackoverflow.com/questions/41137836/error-extracting-images-in-powerpoint-using-shape-export-and-identifying-paragra/41139728#41139728", "title": "Error extracting images in powerpoint using shape.export and identifying paragraph format as bullets in VBA", "body": "<p>For the first part, I think you probably need to recursively check each paragraph within the TextRange as bullets can be set for the whole text range or specific paragraphs within it and if there is a mix, you'll get unexpected results. I also don't see why the replacement is being made for Char 10. I think you should be returning the text for the paragraphs where a bullet is found and prefixing it with your Wiki string. For example:</p>\n\n<pre><code>' Check for bullets\nDim p As Long\nDim para As String\nWith oShape.TextFrame.TextRange\n  For p = 1 To .Paragraphs.Count\n    If .Paragraphs(p).ParagraphFormat.Bullet.Type &lt;&gt; ppBulletNone Then\n      para = \" * \" &amp; .Paragraphs(p).Text\n    Else\n      para = .Paragraphs(p).Text\n    End If\n    outText = outText &amp; para\n  Next\nEnd With\n</code></pre>\n\n<p>For the second point, I got the same error because the images sub folder didn't exist. Once I created it manually, the code ran on PC. For Mac, you'll need to use POSIX or AppleScript path syntax if I recall correctly, for example:</p>\n\n<pre><code>#If Mac Then\n  Public Const PathSeparator = \":\"\n#Else\n  Public Const PathSeparator = \"\\\"\n#End If\n</code></pre>\n\n<p>However, if you're using PowerPoint:mac 2016 then things are more complicated due to its sandboxed environment. Check this article for more info:</p>\n\n<p><a href=\"http://www.rondebruin.nl/mac/mac034.htm\" rel=\"nofollow noreferrer\">http://www.rondebruin.nl/mac/mac034.htm</a></p>\n"}], "owner": {"reputation": 27, "user_id": 619564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc22abb13ca79730f5de1a0027aa3b08?s=128&d=identicon&r=PG", "display_name": "Harkirat", "link": "https://stackoverflow.com/users/619564/harkirat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 41139728, "answer_count": 1, "score": 0, "last_activity_date": 1481709770, "creation_date": 1481703698, "question_id": 41137836, "link": "https://stackoverflow.com/questions/41137836/error-extracting-images-in-powerpoint-using-shape-export-and-identifying-paragra", "title": "Error extracting images in powerpoint using shape.export and identifying paragraph format as bullets in VBA", "body": "<p>I repurposed the code on <a href=\"https://moinmo.in/MicrosoftPowerpointConverter\" rel=\"nofollow noreferrer\">MicrosoftPowerpointConverter - MoinMoin</a> to work without the Microsoft Scripting Runtime. </p>\n\n<p>I was able to generate a new file and export text to it, (I know that's the easy part), where I am getting stuck is in two places:</p>\n\n<ol>\n<li><p>Formatting bullets:</p>\n\n<ul>\n<li><p>Original code</p>\n\n<pre><code>' Check for bullets\nIf aShape.TextFrame.TextRange.ParagraphFormat.Bullet = msoTrue Then\n    outText = Replace(outText, Chr(10), \" * \")\nEnd If\n</code></pre></li>\n<li><p>My  code</p>\n\n<pre><code>' Check for bullets\nIf oShape.TextFrame.TextRange.ParagraphFormat.Bullet.Type &lt;&gt; ppBulletNone Then\n     outText = Replace(outText, Chr(10), \" * \")\nEnd If\n</code></pre></li>\n</ul></li>\n</ol>\n\n<blockquote>\n  <p>This doesn't work at all, and it totally ignores bullet formatting, but still outputs the content without the *</p>\n</blockquote>\n\n<ol start=\"2\">\n<li><p>Exporting images:</p>\n\n<ul>\n<li><p>Original Code</p>\n\n<pre><code>' Is it a picture or embedded object\nIf aShape.Type = msoPicture Or aShape.Type = msoEmbeddedOLEObject Or aShape.Type = msoLinkedPicture Or aShape.Type = msoGroup Then\n    aShape.Export outPath + \"\\image\" + Trim(Str(i)) + Trim(Str(j)) + \".png\", ppShapeFormatPNG\n    oFileStream.WriteLine (Chr(13) + \"attachment:image\" + Trim(Str(i)) + Trim(Str(j)) + \".png\" + Chr(13))\nEnd If\n</code></pre></li>\n<li><p>My code</p>\n\n<pre><code>' Is it a picture or embedded object\nIf oShape.Type = msoPicture Or oShape.Type = msoEmbeddedOLEObject Or oShape.Type = msoLinkedPicture Or oShape.Type = msoGroup Then\n    Dim imagepath\n    imagepath = oPres.Path &amp; \"/images/slide\" + Trim(Str(i)) + Trim(Str(j)) + \".png\"\n    oShape.Export imagepath, ppShapeFormatPNG\n    Print #iFile, (Chr(13) + \"&lt;img src=\" + Chr(34) + \"/images/slide\" + Trim(Str(i)) + Trim(Str(j)) + \".png\" + Chr(34) + \"&gt;\" + Chr(13))\nEnd If\n</code></pre></li>\n</ul></li>\n</ol>\n\n<blockquote>\n  <p>This code throws up the <a href=\"https://i.stack.imgur.com/ZEdOU.png\" rel=\"nofollow noreferrer\">following error</a> in windows, and is totally ignored in Mac</p>\n</blockquote>\n\n<p>Adding my complete code below:</p>\n\n<pre><code>Sub ExportToWiki()\n\n\n\n' Iterators\nDim i As Integer\nDim j As Integer\n\n' Pres, Slide, Shape\nDim oPres As Presentation\nDim oSlides As Slides\nDim oSlide As Slide         'Slide Object\nDim oShp As Shape         'Shape Object\nDim iFile As Integer      'File handle for output\niFile = FreeFile          'Get a free file number\nDim PathSep As String\nDim FileNum As Integer\n\n\nSet oPres = ActivePresentation\nSet oSlides = oPres.Slides\n\nFileNum = FreeFile\n\n'Open output file\n' NOTE:  errors here if file hasn't been saved\nOpen oPres.Path &amp; \"/text.xml\" For Output As FileNum\n\n' File Handling\nDim outText As String\n\n' Table exports\nDim row As Integer\nDim col As Integer\nDim cellText As String\n\n\n' Select my ppt\n\n' Write TOC\nPrint #iFile, (\"[[TableOfContents]]\")\n\n' Loop through slides\nFor i = 1 To oPres.Slides.Count\n\n    Set oSlide = oPres.Slides(i)\n\n    ' Loop through shapes\n    For j = 1 To oSlide.Shapes.Count\n\n        Set oShape = oSlide.Shapes(j)\n\n        ' Is it a text frame?\n        If oShape.HasTextFrame Then\n\n            If oShape.TextFrame.HasText Then\n\n                outText = oShape.TextFrame.TextRange.Text\n\n                ' Check for bullets\n                If oShape.TextFrame.TextRange.ParagraphFormat.Bullet.Type &lt;&gt; ppBulletNone Then\n                    outText = Replace(outText, Chr(10), \" * \")\n                End If\n\n                If j = 1 Then ' Assume first text is always the header\n                    outText = \"= \" + outText + \" =\"\n                 End If\n\n                 Print #iFile, (outText + Chr(13) + \"[[BR]]\" + Chr(13))\n\n            End If\n\n        End If\n\n        ' Is it a table?\n        If oShape.Type = msoTable Then\n\n            cellText = \"\"\n\n            For row = 1 To oShape.Table.Rows.Count\n                For col = 1 To oShape.Table.Columns.Count\n\n                    If row = 1 Then\n                        cellText = cellText + \"||&lt;class=\" + Chr(34) + \"tableheader\" + Chr(34) + \"&gt;\" + oShape.Table.Columns.Item(col).Cells(row).Shape.TextFrame.TextRange.Text\n                    Else\n                        cellText = cellText + \"||\" + oShape.Table.Columns.Item(col).Cells(row).Shape.TextFrame.TextRange.Text\n                    End If\n\n                    If col = oShape.Table.Columns.Count Then\n                        cellText = cellText + \"||\" + Chr(13)\n                    End If\n\n                Next col\n            Next row\n\n            Print #iFile, (Chr(13) + cellText + Chr(13))\n\n        End If\n\n        ' Is it a picture or embedded object\n        If oShape.Type = msoPicture Or oShape.Type = msoEmbeddedOLEObject Or oShape.Type = msoLinkedPicture Or oShape.Type = msoGroup Then\n            Dim imagepath\n            imagepath = oPres.Path &amp; \"/images/slide\" + Trim(Str(i)) + Trim(Str(j)) + \".png\"\n            oShape.Export imagepath, ppShapeFormatPNG\n            Print #iFile, (Chr(13) + \"&lt;img src=\" + Chr(34) + \"/images/slide\" + Trim(Str(i)) + Trim(Str(j)) + \".png\" + Chr(34) + \"&gt;\" + Chr(13))\n        End If\n\n    Next j\nNext i\n\nClose #iFile\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481703104, "post_id": 41137643, "comment_id": 69478492, "body": "What code are you using? Can you post it please? Also, let us know what line throws the error."}, {"owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "edited": false, "score": 0, "creation_date": 1481704692, "post_id": 41137643, "comment_id": 69479347, "body": "Haven&#39;t seen your code yet. But here is a solution to a very similar problem. Also look at other answers in the same post. <a href=\"http://stackoverflow.com/a/41031394/1651993\">stackoverflow.com/a/41031394/1651993</a>"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1481705712, "post_id": 41137643, "comment_id": 69479884, "body": "step into your code with F8  and let us know which line the error is on"}, {"owner": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "edited": false, "score": 0, "creation_date": 1481706001, "post_id": 41137643, "comment_id": 69480042, "body": "When i press F8, the first line highlighted. Btw, i now im getting &quot;Run-time error 1004:  Application-defined or object-defined error&quot;"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1481709255, "post_id": 41137643, "comment_id": 69482003, "body": "@tompreston did you notice he his using <b>Late Binding</b> for the <code>Dictionary</code>, right ?"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1481709731, "post_id": 41137643, "comment_id": 69482316, "body": "@ShaiRado touch&#233;, will edit that out right now..."}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1481710017, "post_id": 41137643, "comment_id": 69482494, "body": "First, can you remove the suffixes in the variable names? Second, you don&#39;t often see something set to empty (I don&#39;t know if this is considered good practice?), Third, you&#39;re dimensioning Key as variant, is this what you want?  Finally, this doesn&#39;t compile for me unless i use worksheets in the place of sheets"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1481725281, "post_id": 41137643, "comment_id": 69492223, "body": "@Jeeva read my answer below, and try the code to see if it works as you intended"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1481828489, "post_id": 41137643, "comment_id": 69543209, "body": "@Jeeva have you tried the code in my answer below ? any feedback ?"}, {"owner": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1481856249, "post_id": 41137643, "comment_id": 69553451, "body": "@ShaiRado its working now. thanks"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1481856803, "post_id": 41137643, "comment_id": 69553568, "body": "@Jeeva you&#39;re welcome , please mark as answer"}], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1481713172, "post_id": 41139831, "comment_id": 69484384, "body": "you can use <code>With Sheets(&quot;Sheet3&quot;)</code> to clean up your code a little"}], "tags": [], "owner": {"reputation": 1069, "user_id": 5620071, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Vw86Z.jpg?s=128&g=1", "display_name": "Mister 832", "link": "https://stackoverflow.com/users/5620071/mister-832"}, "is_accepted": true, "score": 0, "last_activity_date": 1481710552, "last_edit_date": 1481710552, "creation_date": 1481710042, "answer_id": 41139831, "question_id": 41137643, "link": "https://stackoverflow.com/questions/41137643/excel-vba-loop-transpose/41139831#41139831", "title": "Excel VBA - Loop Transpose", "body": "<p>Try this: </p>\n\n<pre><code>Sub test()\n      Dim Dic As Object: Set Dic = CreateObject(\"Scripting.Dictionary\")\n      Dim CLa As Range, CLb As Range, x&amp;, Names$, ID$, Key\n      Dim n As Integer\n      Dim trValue() As String\n\n\n      x = Sheets(\"Sheet3\").Cells(Rows.Count, \"A\").End(xlUp).Row\n      For Each CLa In Sheets(\"Sheet3\").Range(\"A1:A\" &amp; x)\n          If Not Dic.exists(CStr(CLa.Value)) Then\n              ID = CLa.Value\n\n              For Each CLb In Sheets(\"Sheet3\").Range(\"A1:A\" &amp; x)\n                  If CLb.Value = ID Then\n\n                      If Names = \"\" Then\n                          Names = CLb.Offset(, 3).Value\n                      Else\n                          Names = Names &amp; \",\" &amp; CLb.Offset(, 3).Value\n                      End If\n\n                  End If\n\n              Next CLb\n\n              Dic.Add ID, Names\n          End If\n      ID = Empty: Names = Empty\n      Next CLa\n\n      x = 1\n      n = 0\n      For Each Key In Dic\n          Sheets(\"Sheet2\").Cells(x, 1).Value = Key\n\n          trValue = Split(Dic(Key), \",\")\n          For n = 0 To UBound(trValue)\n              Sheets(\"Sheet2\").Cells(x, n + 2).Value = Trim(trValue(n))\n          Next n\n\n\n\n          x = x + 1\n      Next Key\n\n    Sheets(\"Sheet2\").Cells.Replace \"#N/A\", Replacement:=\"\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1481724964, "creation_date": 1481724964, "answer_id": 41144789, "question_id": 41137643, "link": "https://stackoverflow.com/questions/41137643/excel-vba-loop-transpose/41144789#41144789", "title": "Excel VBA - Loop Transpose", "body": "<p>Since you want to keep the values of columns A:C as a unique ID, there is a need to \"Merge\" them together as a <code>String</code> when saving them inside the <code>Dictionary</code> as <code>Key</code>s (adding a <code>,</code> in between them). Later, when extracting the information to \"Sheet2\", we can use the <code>Split</code> funtion to extract the string to 3 elements in <code>IDVal</code> array.</p>\n\n<pre><code>Option Explicit\n\nSub TestDict()\n\nDim Dic As Object\nDim CLa As Range, CLb As Range, lRow As Long\nDim Names As String, ID$, Key As Variant, KeyVal As Variant, IDVal As Variant\n\nSet Dic = CreateObject(\"Scripting.Dictionary\")\n\nWith Sheets(\"Sheet3\")\n    lRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n    For Each CLa In .Range(\"A1:A\" &amp; lRow).Cells\n        If Not Dic.exists(CStr(CLa.Value &amp; \",\" &amp; CLa.Offset(0, 1).Value &amp; \",\" &amp; CLa.Offset(0, 2).Value)) Then  ' If Not Dic.exists(CStr(CLa.Value)) Then\n            ID = CLa.Value\n\n            For Each CLb In .Range(\"A1:A\" &amp; lRow).Cells\n\n                If CLb.Value = ID Then\n                    If Names = \"\" Then\n                        Names = CLb.Offset(, 4).Value\n                    Else\n                        Names = Names &amp; \",\" &amp; CLb.Offset(, 4).Value\n                    End If\n                End If\n            Next CLb\n\n            ' \"Fix\"ing the key to include values from columns A:C &gt;&gt; will split them later\n            ID = CLa.Value &amp; \",\" &amp; CLa.Offset(0, 1).Value &amp; \",\" &amp; CLa.Offset(0, 2).Value\n\n            Dic.Add ID, Names\n        End If\n\n        ID = Empty: Names = Empty\n    Next CLa\nEnd With\n\nlRow = 1\nWith Sheets(\"Sheet2\")\n    For Each Key In Dic.Keys\n        ' splitting values from \"Merged\" string Key to array\n        IDVal = Split(Key, \",\")\n        .Range(\"A\" &amp; lRow).Resize(1, UBound(IDVal) + 1).Value = IDVal\n\n        KeyVal = Split(Dic(Key), \",\")\n        .Range(\"D\" &amp; lRow).Resize(1, UBound(KeyVal) + 1).Value = KeyVal\n        lRow = lRow + 1\n    Next Key\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 420, "favorite_count": 0, "accepted_answer_id": 41139831, "answer_count": 2, "score": 0, "last_activity_date": 1481724964, "creation_date": 1481703008, "last_edit_date": 1495542293, "question_id": 41137643, "link": "https://stackoverflow.com/questions/41137643/excel-vba-loop-transpose", "title": "Excel VBA - Loop Transpose", "body": "<p>I have a certain range of data. Below are the example data:</p>\n\n<pre><code>PAT   PID 0     Min     3001\nPAT   PID 0     Mean    3754\nPAT   PID 0     Max     4542\nCAT   PID 1     Min     15004\nCAT   PID 1     Mean    15040\nCAT   PID 1     Max     15141\nEMM   PID 201   Min     32105\nEMM   PID 201   Mean    584120\nEMM   PID 201   Max     1339633\n</code></pre>\n\n<p>And I would like to transpose the data as follow:</p>\n\n<pre><code>PAT   PID 0     3001  3754   4542\nCAT   PID 1     15004 15040  15141\nEMM   PID 201   32105 584120 1339633\n</code></pre>\n\n<p>I found a similar situation posted in the forum previously(as below)</p>\n\n<p><a href=\"https://stackoverflow.com/questions/30041954/vba-code-copy-and-transpose-paste-with-specific-conditions\">VBA Code - Copy and Transpose paste with specific conditions</a></p>\n\n<p>Unfortunately i get this error \"error 9: Subscript out of range.\".\nI have checked  the sheet name and debugged everything but no luck.</p>\n\n<p><strong>Edited</strong></p>\n\n<p>As requested below are the code i tried to used:</p>\n\n<pre><code>Sub test()\nDim Dic As Object: Set Dic = CreateObject(\"Scripting.Dictionary\")\nDim CLa As Range, CLb As Range, x&amp;, Names$, ID$, Key\n\nx = Sheets(\"Sheet3\").Cells(Rows.Count, \"A\").End(xlUp).Row\nFor Each CLa In Sheets(\"Sheet3\").Range(\"A1:A\" &amp; x)\nIf Not Dic.exists(CStr(CLa.Value)) Then\n    ID = CLa.Value\n\n    For Each CLb In Sheets(\"Sheet3\").Range(\"A1:A\" &amp; x)\n        If CLb.Value = ID Then\n\n            If Names = \"\" Then\n                Names = CLb.Offset(, 1).Value\n            Else\n                Names = Names &amp; \",\" &amp; CLb.Offset(, 1).Value\n            End If\n\n        End If\n    Next CLb\n\nDic.Add ID, Names\nEnd If\nID = Empty: Names = Empty\nNext CLa\n\nx = 1\nFor Each Key In Dic\nSheets(\"Sheet2\").Cells(x, 1).Value = Key\nSheets(\"Sheet2\").Range(Cells(x, 2), Cells(x, 4)) = Split(Dic(Key), \",\")\nx = x + 1\nNext Key\n\nSheets(\"Sheet2\").Cells.Replace \"#N/A\", Replacement:=\"\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "rows"], "comments": [{"owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "edited": false, "score": 0, "creation_date": 1481703030, "post_id": 41137440, "comment_id": 69478456, "body": "I am guessing thats because when you change observation type dropdown , the value in the Target is a observation type. this value does not match with any of the cases in the payoff. hence the <code>case else</code> is run which shows all the rows."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481703042, "post_id": 41137440, "comment_id": 69478460, "body": "At a quick glance, and more of a comment than solution, you use <code>With Sheets(&quot;Output&quot;)</code> but then go on and declare it each time, instead of just doing <code>.Rows(&quot;1:2&quot;)...</code> No need to keep repeating that."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 3, "creation_date": 1481703951, "post_id": 41137440, "comment_id": 69478920, "body": "@excelnewbie, you already posted this question <a href=\"http://stackoverflow.com/questions/41098986/unable-to-hide-rows-correctly-vba\">yesterday</a> and a very similar one <a href=\"http://stackoverflow.com/questions/41056861/sheet-refresh-sheet-doesnt-accept-entered-values\">on the 9th of december</a>. You should either try to follow up answers/suggestions already given to you and/or show some efforts from your part instead of merely repeating the same code over and over again"}, {"owner": {"reputation": 1, "user_id": 7047752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db87f9ae3bbf37ca3e51064ec7438e57?s=128&d=identicon&r=PG&f=1", "display_name": "excelnewbie", "link": "https://stackoverflow.com/users/7047752/excelnewbie"}, "reply_to_user": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "edited": false, "score": 0, "creation_date": 1481708844, "post_id": 41137440, "comment_id": 69481736, "body": "@nightcrawler23 thank you for you comment but it doesn&#39;t help. A window is opened where the line &quot;Select Case Target.Value&quot; is marked"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7047752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db87f9ae3bbf37ca3e51064ec7438e57?s=128&d=identicon&r=PG&f=1", "display_name": "excelnewbie", "link": "https://stackoverflow.com/users/7047752/excelnewbie"}, "edited": false, "score": 0, "creation_date": 1481708791, "post_id": 41137877, "comment_id": 69481702, "body": "thank you for your answer but it doesn&#39;t work. A debug window will be opened where the line &quot;Select Case Target.Value&quot; is marked"}, {"owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "reply_to_user": {"reputation": 1, "user_id": 7047752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db87f9ae3bbf37ca3e51064ec7438e57?s=128&d=identicon&r=PG&f=1", "display_name": "excelnewbie", "link": "https://stackoverflow.com/users/7047752/excelnewbie"}, "edited": false, "score": 0, "creation_date": 1481709261, "post_id": 41137877, "comment_id": 69482010, "body": "See my changes above. You need to send the Target.Value to the subs as they do not have the variable Target"}, {"owner": {"reputation": 1, "user_id": 7047752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db87f9ae3bbf37ca3e51064ec7438e57?s=128&d=identicon&r=PG&f=1", "display_name": "excelnewbie", "link": "https://stackoverflow.com/users/7047752/excelnewbie"}, "edited": false, "score": 0, "creation_date": 1483007334, "post_id": 41137877, "comment_id": 69957313, "body": "yes I thought I already have thanked you but maybe i forgot to click on enter. Sorry for disturbing you but could you help me on another problem? I have two Cases which hide rows and one case intersects the other one. e.g. one case says hide rows 100:158 and the other one says unhide 120:138. Do you know how to solve it? I would appreciate your help so much. Thanks a lot."}, {"owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "reply_to_user": {"reputation": 1, "user_id": 7047752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db87f9ae3bbf37ca3e51064ec7438e57?s=128&d=identicon&r=PG&f=1", "display_name": "excelnewbie", "link": "https://stackoverflow.com/users/7047752/excelnewbie"}, "edited": false, "score": 0, "creation_date": 1483016037, "post_id": 41137877, "comment_id": 69962004, "body": "if your problem was solved, could please accept the answer. For your other problem, i don&#39;t understand what the issue is. However you can submit another question. Thanks"}], "tags": [], "owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "is_accepted": true, "score": 0, "last_activity_date": 1481709216, "last_edit_date": 1481709216, "creation_date": 1481703817, "answer_id": 41137877, "question_id": 41137440, "link": "https://stackoverflow.com/questions/41137440/rows-hidden-on-dropdown-selection-become-unhidden-upon-selection-from-second-dro/41137877#41137877", "title": "Rows hidden on dropdown selection become unhidden upon selection from second dropdown", "body": "<p>Since you gave used Target in your code, i am guessing you used Worksheet_Change module to run your code. However your code should look something like this to achieve your required behaviour. <em>Also, see my comment above</em>.</p>\n\n<p>i have used A1 and A2 as the position of the dropdown lists. You need to change these accordingly</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not (Intersect(Range(\"A1\"), Target) Is Nothing) Then\n        Call showObservation(Target.value)  '@nightcrawler23\n        ElseIf Not (Intersect(Range(\"A2\"), Target) Is Nothing) Then\n        Call showPayoff(Target.value)  '@nightcrawler23\n    End If\nEnd Sub\n\nSub showPayoff(myCase as String)  '@nightcrawler23\n    With Sheets(\"Output\")\n        .Rows(\"112:137\").Hidden = False\n        .Rows(\"138:151\").Hidden = False\n        Select Case myCase  '@nightcrawler23\n            Case \"Bonus Capped Single Index\"\n                .Rows(\"112:154\").Hidden = True\n            Case \"Bonus Capped Single Share\"\n                .Rows(\"112:154\").Hidden = True\n            Case \"Bonus Uncapped Single Index\"\n                .Rows(\"112:154\").Hidden = True\n                .Rows(\"256:257\").Hidden = True\n            Case \"Bonus Uncapped Single Share\"\n                .Rows(\"112:154\").Hidden = True\n                .Rows(\"256:257\").Hidden = True\n            Case \"Bonus Uncapped Single Index\"\n                .Rows(\"112:154\").Hidden = True\n                .Rows(\"256:257\").Hidden = True\n            Case \"Bonus Capped Worst of Indices\"\n                .Rows(\"112:154\").Hidden = True\n            '...\n            '...\n            '...\n            '...\n        End Select\n    End With\nEnd Sub\n\nSub showObservation(myCase as String) '@nightcrawler23\n    With Sheets(\"Output\") 'Observation and delivery\n        .Rows(\"158:212\").Hidden = False\n        .Rows(\"246:253\").Hidden = False\n\n        Select Case myCase '@nightcrawler23\n            Case \"American Cash\"\n                .Rows(\"177:212\").Hidden = True\n                .Rows(\"165\").Hidden = True\n                .Rows(\"176\").Hidden = True\n            Case \"American Physical\"\n                .Rows(\"162:164\").Hidden = True\n                .Rows(\"177:212\").Hidden = True\n                .Rows(\"173:175\").Hidden = True\n                .Rows(\"246:253\").Hidden = True\n            '...\n            '...\n            '...\n            '...\n        End Select\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7047752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db87f9ae3bbf37ca3e51064ec7438e57?s=128&d=identicon&r=PG&f=1", "display_name": "excelnewbie", "link": "https://stackoverflow.com/users/7047752/excelnewbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 41137877, "answer_count": 1, "score": -5, "last_activity_date": 1518381441, "creation_date": 1481702225, "last_edit_date": 1518381441, "question_id": 41137440, "link": "https://stackoverflow.com/questions/41137440/rows-hidden-on-dropdown-selection-become-unhidden-upon-selection-from-second-dro", "title": "Rows hidden on dropdown selection become unhidden upon selection from second dropdown", "body": "<p>In Sheet \"Input\" I have two Dropdown lists. The first one is to select between payoffs and the second is to select between observation types.</p>\n\n<p>In the Sheet \"Output\" the rows are hidden. </p>\n\n<p>When I select one payoff the specified rows are hidden which is good but after selecting the observation type the rows of the payoff are unhidden which is bad.</p>\n\n<p>I'm using the following code:</p>\n\n<pre><code>With Sheets(\"Output\")\nSheets(\"Output\").Rows(\"112:137\").Hidden = False\nSheets(\"Output\").Rows(\"138:151\").Hidden = False\nSelect Case Target.Value\nCase \"Bonus Capped Single Index\"\nSheets(\"Output\").Rows(\"112:154\").Hidden = True\nCase \"Bonus Capped Single Share\"\nSheets(\"Output\").Rows(\"112:154\").Hidden = True\nCase \"Bonus Uncapped Single Index\"\nSheets(\"Output\").Rows(\"112:154\").Hidden = True\nSheets(\"Output\").Rows(\"256:257\").Hidden = True\nCase \"Bonus Uncapped Single Share\"\nSheets(\"Output\").Rows(\"112:154\").Hidden = True\nSheets(\"Output\").Rows(\"256:257\").Hidden = True\nCase \"Bonus Uncapped Single Index\"\nSheets(\"Output\").Rows(\"112:154\").Hidden = True\nSheets(\"Output\").Rows(\"256:257\").Hidden = True\nCase \"Bonus Capped Worst of Indices\"\nSheets(\"Output\").Rows(\"112:154\").Hidden = True\nCase \"Bonus Capped Worst of Shares\"\nSheets(\"Output\").Rows(\"112:154\").Hidden = True\nCase \"Bonus Uncapped Worst of Indices\"\nSheets(\"Output\").Rows(\"112:154\").Hidden = True\nSheets(\"Output\").Rows(\"256:257\").Hidden = True\nCase \"Bonus Uncapped Worst of Shares\"\nSheets(\"Output\").Rows(\"112:154\").Hidden = True\nSheets(\"Output\").Rows(\"256:257\").Hidden = True\nCase \"Phoenix Single Share\"\nSheets(\"Output\").Rows(\"116:133\").Hidden = True\nSheets(\"Output\").Rows(\"139\").Hidden = True\nSheets(\"Output\").Rows(\"254:257\").Hidden = True    \nCase \"Phoenix Single Index\"\nSheets(\"Output\").Rows(\"116:133\").Hidden = True\nSheets(\"Output\").Rows(\"138\").Hidden = True\nSheets(\"Output\").Rows(\"254:257\").Hidden = True\nCase \"Phoenix Yeti Single Index\"\nSheets(\"Output\").Rows(\"138\").Hidden = True\nSheets(\"Output\").Rows(\"116:131\").Hidden = True\nSheets(\"Output\").Rows(\"254:257\").Hidden = True\nCase \"Phoenix Yeti Single Share\"\nSheets(\"Output\").Rows(\"139\").Hidden = True\nSheets(\"Output\").Rows(\"116:131\").Hidden = True\nSheets(\"Output\").Rows(\"254:257\").Hidden = True\nCase \"Worst of Indices Phoenix\"\nSheets(\"Output\").Rows(\"138\").Hidden = True\nSheets(\"Output\").Rows(\"254:257\").Hidden = True\nSheets(\"Output\").Rows(\"116:131\").Hidden = True\nCase \"Worst of Shares Phoenix\"\nSheets(\"Output\").Rows(\"138\").Hidden = True\nSheets(\"Output\").Rows(\"254:257\").Hidden = True\nSheets(\"Output\").Rows(\"116:131\").Hidden = True\nCase \"Worst of Shares Phoenix Yeti\"\nSheets(\"Output\").Rows(\"116:131\").Hidden = True\nSheets(\"Output\").Rows(\"138\").Hidden = True\nSheets(\"Output\").Rows(\"254:257\").Hidden = True\nCase \"Worst of Indices Phoenix Yeti\"\nSheets(\"Output\").Rows(\"139\").Hidden = True\nSheets(\"Output\").Rows(\"116:131\").Hidden = True\nSheets(\"Output\").Rows(\"254:257\").Hidden = True\nCase \"Autocall Single Index\"\nSheets(\"Output\").Rows(\"254:257\").Hidden = True\nSheets(\"Output\").Rows(\"112:131\").Hidden = True\nSheets(\"Output\").Rows(\"138\").Hidden = True\nCase \"Autocall Single Share\"\nSheets(\"Output\").Rows(\"254:257\").Hidden = True\nSheets(\"Output\").Rows(\"112:131\").Hidden = True\nSheets(\"Output\").Rows(\"139\").Hidden = True\nCase \"Autocall Worst of Shares\"\nSheets(\"Output\").Rows(\"254:257\").Hidden = True    \nSheets(\"Output\").Rows(\"112:131\").Hidden = True\nSheets(\"Output\").Rows(\"139\").Hidden = True\nCase \"Autocall Worst of Indices\"\nSheets(\"Output\").Rows(\"254:257\").Hidden = True\nSheets(\"Output\").Rows(\"112:131\").Hidden = True\nSheets(\"Output\").Rows(\"138\").Hidden = True\nCase \"Reverse Convertible Single Share\"\nSheets(\"Output\").Rows(\"116:133\").Hidden = True\nSheets(\"Output\").Rows(\"138:154\").Hidden = True\nSheets(\"Output\").Rows(\"254:257\").Hidden = True\nSheets(\"Output\").Rows(\"162:164\").Hidden = True\nSheets(\"Output\").Rows(\"173:175\").Hidden = True\nCase \"Reverse Convertible Single Index\"\nSheets(\"Output\").Rows(\"116:133\").Hidden = True\nSheets(\"Output\").Rows(\"138:154\").Hidden = True    \nSheets(\"Output\").Rows(\"254:257\").Hidden = True\nSheets(\"Output\").Rows(\"162:164\").Hidden = True\nSheets(\"Output\").Rows(\"173:175\").Hidden = True\nCase \"Worst of Shares Reverse Convertible\"\nSheets(\"Output\").Rows(\"116:133\").Hidden = True\nSheets(\"Output\").Rows(\"138:154\").Hidden = True\nSheets(\"Output\").Rows(\"254:257\").Hidden = True\nSheets(\"Output\").Rows(\"162:164\").Hidden = True\nSheets(\"Output\").Rows(\"173:175\").Hidden = True\nCase \"Worst of Indices Reverse Convertible\"\nSheets(\"Output\").Rows(\"116:133\").Hidden = True\nSheets(\"Output\").Rows(\"138:154\").Hidden = True    \nSheets(\"Output\").Rows(\"254:257\").Hidden = True\nSheets(\"Output\").Rows(\"162:164\").Hidden = True\nSheets(\"Output\").Rows(\"173:175\").Hidden = True\nCase \"Coupon Linker Index\"\nSheets(\"Output\").Rows(\"160:164\").Hidden = True\nSheets(\"Output\").Rows(\"254:257\").Hidden = True\nSheets(\"Output\").Rows(\"171:175\").Hidden = True\nSheets(\"Output\").Rows(\"116:133\").Hidden = True\nSheets(\"Output\").Rows(\"138:154\").Hidden = True\nCase \"Fix Coupon Express Single Index\"\nSheets(\"Output\").Rows(\"116:133\").Hidden = True\nSheets(\"Output\").Rows(\"254:257\").Hidden = True\nSheets(\"Output\").Rows(\"136:137\").Hidden = True\nSheets(\"Output\").Rows(\"139\").Hidden = True\nCase \"Fix Coupon Express Single Share\"\nSheets(\"Output\").Rows(\"116:133\").Hidden = True\nSheets(\"Output\").Rows(\"254:257\").Hidden = True\nSheets(\"Output\").Rows(\"136:137\").Hidden = True\nSheets(\"Output\").Rows(\"138\").Hidden = True\nCase \"Fix Coupon Worst of Shares\"\nSheets(\"Output\").Rows(\"116:133\").Hidden = True\nSheets(\"Output\").Rows(\"254:257\").Hidden = True\nSheets(\"Output\").Rows(\"136:137\").Hidden = True\nSheets(\"Output\").Rows(\"138\").Hidden = True\nCase \"Fix Coupon Worst of Indices\"\nSheets(\"Output\").Rows(\"116:133\").Hidden = True\nSheets(\"Output\").Rows(\"254:257\").Hidden = True\nSheets(\"Output\").Rows(\"136:137\").Hidden = True\nSheets(\"Output\").Rows(\"138\").Hidden = True\nCase Else\nSheets(\"Output\").Rows(\"112:137\").Hidden = False\nSheets(\"Output\").Rows(\"138:151\").Hidden = False\nEnd Select\nEnd With\n\nWith Sheets(\"Output\") 'Observation and delivery\nSheets(\"Output\").Rows(\"158:212\").Hidden = False\nSheets(\"Output\").Rows(\"246:253\").Hidden = False\nSelect Case Target.Value\nCase \"American Cash\"\nSheets(\"Output\").Rows(\"177:212\").Hidden = True\nSheets(\"Output\").Rows(\"165\").Hidden = True\nSheets(\"Output\").Rows(\"176\").Hidden = True\nCase \"American Physical\"\nSheets(\"Output\").Rows(\"162:164\").Hidden = True\nSheets(\"Output\").Rows(\"177:212\").Hidden = True\nSheets(\"Output\").Rows(\"173:175\").Hidden = True\nSheets(\"Output\").Rows(\"246:253\").Hidden = True\nCase \"European Cash\"\nSheets(\"Output\").Rows(\"170:172\").Hidden = True\nSheets(\"Output\").Rows(\"159:164\").Hidden = True\nSheets(\"Output\").Rows(\"165\").Hidden = True\nSheets(\"Output\").Rows(\"176\").Hidden = True\nCase \"European Physical\"\nSheets(\"Output\").Rows(\"159:164\").Hidden = True\nSheets(\"Output\").Rows(\"170:175\").Hidden = True\nSheets(\"Output\").Rows(\"246:258\").Hidden = True\nCase Else\nSheets(\"Output\").Rows(\"158:212\").Hidden = False\nSheets(\"Output\").Rows(\"246:253\").Hidden = False\nEnd Select\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1481701080, "post_id": 41136626, "comment_id": 69477508, "body": "I would guess and say that <code>&quot;4038 Only!R1C1:R211C87&quot;</code> should at least to be a valid sheet/range, i.e. <code>&quot;&#39;4038 Only&#39;!R1C1:R211C87&quot;</code>.  Similarly <code>wsNew.Name &amp; &quot;!R1C1&quot;</code> would need to be <code>&quot;&#39;&quot; &amp; wsNew.Name &amp; &quot;&#39;!R1C1&quot;</code>."}, {"owner": {"reputation": 105, "user_id": 6930826, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0f40815d9db6f94ab6837f4d621157ee?s=128&d=identicon&r=PG&f=1", "display_name": "Anne", "link": "https://stackoverflow.com/users/6930826/anne"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481702491, "post_id": 41136626, "comment_id": 69478198, "body": "got it working! Thanks!!! @YowE3K"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481729232, "post_id": 41136626, "comment_id": 69494876, "body": "I didn&#39;t have time last night to check if that was the only issue or not, so I&#39;m glad that was the only problem - it&#39;s something that is easy to fix :)"}, {"owner": {"reputation": 105, "user_id": 6930826, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0f40815d9db6f94ab6837f4d621157ee?s=128&d=identicon&r=PG&f=1", "display_name": "Anne", "link": "https://stackoverflow.com/users/6930826/anne"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481764935, "post_id": 41136626, "comment_id": 69511745, "body": "I&#39;m pretty new to VBA. you&#39;ve been great @YowE3K thanks!"}, {"owner": {"reputation": 105, "user_id": 6930826, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0f40815d9db6f94ab6837f4d621157ee?s=128&d=identicon&r=PG&f=1", "display_name": "Anne", "link": "https://stackoverflow.com/users/6930826/anne"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481770097, "post_id": 41136626, "comment_id": 69513043, "body": "thanks, but what if I extract it not in pivot how about here I also have error <code>If Application.WorksheetFunction.Subtotal(103, currRange) - 1 &gt; 0 Then                     dataRng.SpecialCells(xlCellTypeVisible).Copy Destination:=wsNew.Name(currCell.Value).Range(&quot;A1&quot;)                 End If</code>  @YowE3K"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481770513, "post_id": 41136626, "comment_id": 69513158, "body": "<code>Destination:=wsNew.Name(currCell.Value).Range(&quot;A1&quot;)</code> should probably be <code>Destination:=wsNew.Range(&quot;A1&quot;)</code> (but I&#39;m guessing as to what you intend by that statement, because I have no idea what your <code>currCell</code> object is - it&#39;s not mentioned in any of the code you have shown so far)"}, {"owner": {"reputation": 105, "user_id": 6930826, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0f40815d9db6f94ab6837f4d621157ee?s=128&d=identicon&r=PG&f=1", "display_name": "Anne", "link": "https://stackoverflow.com/users/6930826/anne"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481772526, "post_id": 41136626, "comment_id": 69513659, "body": "hi @YowE3K is there a way where I filter the master sheet with a criteria for example &quot;Apple&quot; in column G but there is no result but I want to create a new sheet with name Apple with the headers from master sheet even though there are no values."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481773511, "post_id": 41136626, "comment_id": 69513902, "body": "I&#39;m not sure.  (But I assume there would be.)  Perhaps it would be best if you submit a question, as that has nothing to do with this question."}], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1481707379, "post_id": 41137540, "comment_id": 69480831, "body": "for futre MACROs with <code>PivotTable</code>, it&#39;s recommended to define and set your variblaes, such as <code>Dim PvtTbl As PivotTable</code> , and <code>Dim PvtCache As PivotCache</code>. You can also use <code>Dim PvtFld As PivotField</code>"}, {"owner": {"reputation": 105, "user_id": 6930826, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0f40815d9db6f94ab6837f4d621157ee?s=128&d=identicon&r=PG&f=1", "display_name": "Anne", "link": "https://stackoverflow.com/users/6930826/anne"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1486027218, "post_id": 41137540, "comment_id": 71173177, "body": "hi @R3uK haha don&#39;t know where can I accept? I&#39;ll go through it later! Thanks for your assistance :D"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1486027308, "post_id": 41137540, "comment_id": 71173240, "body": "@Anne : If I remember well, right under the downvote button of the answer, like every other answer! ;)"}], "tags": [], "owner": {"reputation": 105, "user_id": 6930826, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0f40815d9db6f94ab6837f4d621157ee?s=128&d=identicon&r=PG&f=1", "display_name": "Anne", "link": "https://stackoverflow.com/users/6930826/anne"}, "is_accepted": true, "score": 0, "last_activity_date": 1481702635, "creation_date": 1481702635, "answer_id": 41137540, "question_id": 41136626, "link": "https://stackoverflow.com/questions/41136626/creating-pivot-table-to-new-worksheet-error-on-table-destination-vba/41137540#41137540", "title": "Creating Pivot Table to new worksheet Error on table destination VBA", "body": "<p>got it working with the help of @YowE3K. Please see his comment. :)</p>\n\n<pre><code>Dim wsNew As Worksheet\n    Set wsNew = ThisWorkbook.Sheets.Add(After:= _\n             ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))\n    wsNew.Name = \"4038 future project\"\n\n    ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n        \"'4038 Only'!R1C1:R211C87\", Version:=xlPivotTableVersion12).CreatePivotTable _\n        TableDestination:=\"'\" &amp; wsNew.Name &amp; \"'!R1C1\", TableName:=\"PivotTable1\", _\n        DefaultVersion:=xlPivotTableVersion12\n</code></pre>\n\n<p>validate sheet range</p>\n"}], "owner": {"reputation": 105, "user_id": 6930826, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0f40815d9db6f94ab6837f4d621157ee?s=128&d=identicon&r=PG&f=1", "display_name": "Anne", "link": "https://stackoverflow.com/users/6930826/anne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2533, "favorite_count": 0, "accepted_answer_id": 41137540, "answer_count": 1, "score": 0, "last_activity_date": 1481702635, "creation_date": 1481698909, "last_edit_date": 1531164843, "question_id": 41136626, "link": "https://stackoverflow.com/questions/41136626/creating-pivot-table-to-new-worksheet-error-on-table-destination-vba", "title": "Creating Pivot Table to new worksheet Error on table destination VBA", "body": "<p>this has been asked a lot of times but may I ask where is the error here </p>\n\n<pre><code>Sub PivotFutureProj()\n\nDim wsNew As Worksheet\n    Set wsNew = ThisWorkbook.Sheets.Add(After:= _\n             ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))\n    wsNew.Name = \"4038 future project\"\n\n    ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n        \"4038 Only!R1C1:R211C87\", Version:=xlPivotTableVersion12).CreatePivotTable _\n        TableDestination:=wsNew.Name &amp; \"!R1C1\", TableName:=\"PivotTable1\", _\n        DefaultVersion:=xlPivotTableVersion12\n\n    With ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"MONTH\")\n        .Orientation = xlPageField\n        .Position = 1\n    End With\n</code></pre>\n\n<p>having error on this part </p>\n\n<pre><code>ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n        \"4038 Only!R1C1:R211C87\", Version:=xlPivotTableVersion12).CreatePivotTable _\n        TableDestination:=wsNew.Name &amp; \"!R1C1\", TableName:=\"PivotTable1\", _\n        DefaultVersion:=xlPivotTableVersion12\n</code></pre>\n\n<p>I'm thinking because of this</p>\n\n<pre><code>TableDestination:=wsNew.Name &amp; \"!R1C1\"\n</code></pre>\n\n<p>Tried different approach. it's just that I'm running out of time.</p>\n\n<p>I'll be grateful for every help!</p>\n"}, {"tags": ["vba", "excel", "exception-handling"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481698215, "post_id": 41136380, "comment_id": 69476169, "body": "What&#39;s <code>[holidays]</code> supposed to be? Is it a named range? Is that literally how your code is written? I assume your error occurs on the <code>temp = Application....</code> line?"}, {"owner": {"reputation": 1, "user_id": 7294935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d31162b4b9fadec980e771dc516525?s=128&d=identicon&r=PG&f=1", "display_name": "Madhu", "link": "https://stackoverflow.com/users/7294935/madhu"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481698973, "post_id": 41136380, "comment_id": 69476505, "body": "holidays is the named list."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481699938, "post_id": 41136380, "comment_id": 69476970, "body": "Wouldn&#39;t it just be <code>holidays</code> then? no brackets on either side? Unless you have it literally named <code>[holidays]</code> (but I&#39;m not sure if you can have brackets in a named range)"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1481703630, "post_id": 41136380, "comment_id": 69478753, "body": "@BruceWayne brackets are an (ugly, to me) alternative to <code>Range</code>, so <code>[holidays]</code> equals <code>Range(&quot;holidays&quot;)</code>"}, {"owner": {"reputation": 1, "user_id": 7294935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d31162b4b9fadec980e771dc516525?s=128&d=identicon&r=PG&f=1", "display_name": "Madhu", "link": "https://stackoverflow.com/users/7294935/madhu"}, "edited": false, "score": 0, "creation_date": 1481703975, "post_id": 41136380, "comment_id": 69478934, "body": "If you have to use a named range in a vlookup, you have to specify it in square brackets. I have tried this in other examples and it has worked."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481704295, "post_id": 41136380, "comment_id": 69479118, "body": "Instead of vlookup, perhaps try countif()?"}, {"owner": {"reputation": 1, "user_id": 7294935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d31162b4b9fadec980e771dc516525?s=128&d=identicon&r=PG&f=1", "display_name": "Madhu", "link": "https://stackoverflow.com/users/7294935/madhu"}, "edited": false, "score": 0, "creation_date": 1481704768, "post_id": 41136380, "comment_id": 69479388, "body": "Hi, sorry all these times I was referring to column 2 in vlookup. That was causing the problem. The list of holiday is a single column list. Hence vlookup was throwing error. ANd one more thing the named ranges work as I have entered and even the actual range also gives the same result."}, {"owner": {"reputation": 1, "user_id": 7294935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d31162b4b9fadec980e771dc516525?s=128&d=identicon&r=PG&f=1", "display_name": "Madhu", "link": "https://stackoverflow.com/users/7294935/madhu"}, "edited": false, "score": 0, "creation_date": 1481704857, "post_id": 41136380, "comment_id": 69479436, "body": "By the way I wanted to know the difference between Application. Vlookup and APplication.Worksheetfunction.Vlookup? Can anybody explain about these please?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7294935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d31162b4b9fadec980e771dc516525?s=128&d=identicon&r=PG&f=1", "display_name": "Madhu", "link": "https://stackoverflow.com/users/7294935/madhu"}, "edited": false, "score": 0, "creation_date": 1481699496, "post_id": 41136582, "comment_id": 69476755, "body": "Now, im not getting the error. However, the vlookup fucntionality itself is not working properly now. Actually I want to highlight the cells when there is a match in vlookup. Even thought there are 5 such dates, vlookup is not highlighting any of those cells. Please note I just changed the If Not to If in my code. When I used the code as you have provided, all the cells highlighted which means that everytime vlookup is returning error."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 1, "user_id": 7294935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d31162b4b9fadec980e771dc516525?s=128&d=identicon&r=PG&f=1", "display_name": "Madhu", "link": "https://stackoverflow.com/users/7294935/madhu"}, "edited": false, "score": 0, "creation_date": 1481699618, "post_id": 41136582, "comment_id": 69476814, "body": "you may want to post some shots of your data to see where <code>[holidays]</code> are and what cells are to be checked against that range"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 1, "user_id": 7294935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d31162b4b9fadec980e771dc516525?s=128&d=identicon&r=PG&f=1", "display_name": "Madhu", "link": "https://stackoverflow.com/users/7294935/madhu"}, "edited": false, "score": 0, "creation_date": 1481701538, "post_id": 41136582, "comment_id": 69477737, "body": "I think he just needs to do <code>holidays</code>, not <code>[holidays]</code>? Or am I missing something? But I agree, it&#39;d help a lot to see a screen shot of what <code>[holidays]</code> is.  Also, @Madhu, replace <code>[holidays]</code> with the actual range and check if it works. If it does work, then it&#39;s an issue with the way the range is named, not necessarily the formula/VBA."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1481704047, "post_id": 41136582, "comment_id": 69478975, "body": "@BruceWayne, as for the &quot;brackets&quot; issue see my comment at OP"}, {"owner": {"reputation": 1, "user_id": 7294935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d31162b4b9fadec980e771dc516525?s=128&d=identicon&r=PG&f=1", "display_name": "Madhu", "link": "https://stackoverflow.com/users/7294935/madhu"}, "edited": false, "score": 0, "creation_date": 1481704108, "post_id": 41136582, "comment_id": 69479012, "body": "Right now im in office. Taking screen print has been disabled here. I will upload the screen once I reach home. Meanwhile I replaced the named range with the actual range and still the same problem exists."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1481704240, "post_id": 41136582, "comment_id": 69479086, "body": "in the meanwhile you may type ranges address here, and specify what format are dates input in there"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1481698749, "creation_date": 1481698749, "answer_id": 41136582, "question_id": 41136380, "link": "https://stackoverflow.com/questions/41136380/run-time-error-1004-on-using-vlookup-function/41136582#41136582", "title": "Run time error 1004 on using Vlookup function", "body": "<p><code>Range(Cells(1, i))</code> isn't a valid range reference</p>\n\n<p>maybe you wanted to reference <code>Cells(1, i)</code></p>\n\n<p>furthermore you can exploit the <code>Application</code> <code>VLookup()</code> method that wraps the possible error in the returned variant variable that you can check with <code>IsError()</code> function like follows:</p>\n\n<pre><code>Dim temp As Variant\nFor i = 1 To 10\n    Set myrange = Range(Cells(1, i), Cells(10, i))\n    temp = Application.VLookup(Cells(1, i), [holidays], 2, False)\n    If Not IsError(temp) Then Cells(1, i).Interior.Color = 3\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7294935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d31162b4b9fadec980e771dc516525?s=128&d=identicon&r=PG&f=1", "display_name": "Madhu", "link": "https://stackoverflow.com/users/7294935/madhu"}, "edited": false, "score": 0, "creation_date": 1481700442, "post_id": 41136706, "comment_id": 69477219, "body": "Thanks for your help. I wanted to do this in VBA not through excel formula."}], "tags": [], "owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "is_accepted": false, "score": 0, "last_activity_date": 1481699224, "creation_date": 1481699224, "answer_id": 41136706, "question_id": 41136380, "link": "https://stackoverflow.com/questions/41136380/run-time-error-1004-on-using-vlookup-function/41136706#41136706", "title": "Run time error 1004 on using Vlookup function", "body": "<p>Here is a conditional formatting method, without using VBA.</p>\n\n<p>Select your range > Conditional Formating > New Rule > Use a formula ...</p>\n\n<p>Enter this formula </p>\n\n<pre><code>=VLOOKUP($A2,$J$2:$K$6,1,FALSE)\n</code></pre>\n\n<p>Take care of the \"$\" in the formula. This should highlight all cells that were found in the holidays list.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Fl92m.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Fl92m.png\" alt=\"Conditional Formatting V lookup\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 732, "user_id": 3025905, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c2fa2b33fcfe80d872becd5026ebb8fa?s=128&d=identicon&r=PG&f=1", "display_name": "PankajKushwaha", "link": "https://stackoverflow.com/users/3025905/pankajkushwaha"}, "is_accepted": false, "score": 0, "last_activity_date": 1481704336, "creation_date": 1481704336, "answer_id": 41138004, "question_id": 41136380, "link": "https://stackoverflow.com/questions/41136380/run-time-error-1004-on-using-vlookup-function/41138004#41138004", "title": "Run time error 1004 on using Vlookup function", "body": "<p>Your code is okay , It worked in Excel 2010 , Your problem is with VBA Error handling method.</p>\n\n<p>Go to Tools --> Options -->General --> Error Trapping \nAnd check \"Break on unhanded Errors\"</p>\n\n<p><a href=\"https://i.stack.imgur.com/AyCsP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AyCsP.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7294935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d31162b4b9fadec980e771dc516525?s=128&d=identicon&r=PG&f=1", "display_name": "Madhu", "link": "https://stackoverflow.com/users/7294935/madhu"}, "is_accepted": false, "score": 0, "last_activity_date": 1481704901, "creation_date": 1481704901, "answer_id": 41138140, "question_id": 41136380, "link": "https://stackoverflow.com/questions/41136380/run-time-error-1004-on-using-vlookup-function/41138140#41138140", "title": "Run time error 1004 on using Vlookup function", "body": "<p>sorry all these times I was referring to column 2 in vlookup. That was causing the problem. The list of holiday is a single column list. Hence vlookup was throwing error. ANd one more thing the named ranges work as I have entered and even the actual range also gives the same result.</p>\n\n<p>Sub highlight_cells()\nDim myrange As Range</p>\n\n<p>For i = 1 To 10</p>\n\n<p>Set myrange = Range(Cells(1, i), Cells(10, i))\nMsgBox Cells(1, i)\ntemp = Application.VLookup(Cells(1, i), [holidays], 1, False)\nIf Not IsError(temp) Then\nmyrange.Interior.ColorIndex = 3\nEnd If</p>\n\n<p>Next i</p>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 1, "user_id": 7294935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d31162b4b9fadec980e771dc516525?s=128&d=identicon&r=PG&f=1", "display_name": "Madhu", "link": "https://stackoverflow.com/users/7294935/madhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 294, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1481704901, "creation_date": 1481697906, "last_edit_date": 1481699425, "question_id": 41136380, "link": "https://stackoverflow.com/questions/41136380/run-time-error-1004-on-using-vlookup-function", "title": "Run time error 1004 on using Vlookup function", "body": "<p>Im trying to highlight range of cells when a date is present in the list of holidays. But on running the below code, the Run time error 1004 is displayed. I have even tried handling it in error handler; but it is not working. Can somebody please help me why this error is occuring and resolve the same?</p>\n\n<pre><code>Sub highlight_cells()\nDim myrange As Range\nOn Error GoTo myerr:\nFor i = 1 To 10\nSet myrange = Range(Cells(1, i), Cells(10, i))\ntemp = Application.WorksheetFunction.VLookup(Range(Cells(1, i)), [holidays], 2, False)\nIf (Application.WorksheetFunction.IsNA(temp)) Then\nmyrange.Interior.Color = 3\nEnd If\nNext i\n\nmyerr:\nIf Err.Number = 1004 Then\nMsgBox \"vlookup error\"\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "edited": false, "score": 1, "creation_date": 1481696378, "post_id": 41135753, "comment_id": 69475486, "body": "Try adding <code>Sheets(&quot;XCFIL_&quot; &amp; NumMax).Cells.RowHeight = 10</code> to the end of your code."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481697849, "post_id": 41135753, "comment_id": 69476025, "body": "Is that all of the code? What happens after <code>Range(&quot;A1&quot;).Select</code>?"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1481699064, "post_id": 41135753, "comment_id": 69476556, "body": "I tried this <code>Worksheets(&quot;XCFIL_1&quot;).Range(&quot;A1:A&quot; &amp; Rows.Count).Rows.AutoFit</code> at the same time as I posted this question, and the computer is still running the code. It&#39;s about 25% done now."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481699166, "post_id": 41135753, "comment_id": 69476597, "body": "@BruceWayne The code copies sheet Resultat to Resultat_1 and updates the pivot tables. So in short, yes that is all."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1481699183, "post_id": 41135753, "comment_id": 69476601, "body": "either your source sheet (&quot;XCFIL&quot;) have all rows hidden or there&#39;s some Workbook event handler hiding rows in every new sheet."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1481699318, "post_id": 41135753, "comment_id": 69476668, "body": "@user3598756 On XCFIL there is a table of 200.000 rows with header row freezed pane. Nothing is hidden, no filter is active. There is a filter, but nothing is filtered."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1481699355, "post_id": 41135753, "comment_id": 69476687, "body": "@user3598756 And no event  handler."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1481699442, "post_id": 41135753, "comment_id": 69476730, "body": "And the strange thing is that I use the same code to copy the Resultat sheet and it works great."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1481699445, "post_id": 41135753, "comment_id": 69476733, "body": "then check for workbook event handler in <code>ThisWorkbook</code> code pane. Finally you may want to step through your code and see what&#39;s actually happening"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1481699615, "post_id": 41135753, "comment_id": 69476812, "body": "@user3598756 all sheet vba code is empty. The only code that is not in module is on sheet Resultat: <code>Private Sub CommandButton1_Click()     PivotSourceChangeAll End Sub</code> and this runs the code above in question"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1481699697, "post_id": 41135753, "comment_id": 69476858, "body": "have you checked <code>ThisWorkbook</code> code pane?"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1481699811, "post_id": 41135753, "comment_id": 69476910, "body": "@user3598756 yes. It&#39;s empty. I steped through the code and all worked great until <code>Range(&quot;A1&quot;).PasteSpecial xlPasteAll</code> that&#39;s when all rows got hidden"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481700114, "post_id": 41135753, "comment_id": 69477069, "body": "Quick test - just copy <i>one</i> value and paste <i>one</i> value - do the rows still hide? If you step through the code, are the rows hidden before you paste? When stepping through, <i>when</i> do the rows get hidden, at the <code>... xlPasteAll</code> command only?  As an alternative, why not just copy the worksheet itself, then if you need the formatting, copy the formatting and apply it? Thus avoiding <code>Cells</code> which can take some time to copy/paste, depending on the size of your data."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481700767, "post_id": 41135753, "comment_id": 69477358, "body": "@BruceWayne Yes the hiding happens on xlPasteAll. Nothing is odd before and as the yellow marker in debugger passes this row all the cells are hidden. How would I copy the worksheet? Formatting is not really an issue. It&#39;s just data"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481700892, "post_id": 41135753, "comment_id": 69477409, "body": "@Andreas - Turn on the macro recorder, then right click the sheet --&gt; Copy --&gt; Then you should be able to choose to &quot;create a copy&quot; and put it after the current sheet.  Also, if you just need values, perhaps instead try <code>Sheets(&quot;XCFIL_&quot; &amp; NumMax).Cells.Value = Sheets(&quot;XCFIL&quot;).Cells.Value</code> instead of the paste special block (it&#39;d be put right after the <code>....Name = &quot;Resultat_&quot; &amp; NumMax</code> line, no need for anything else.) But do note, using <code>Cells</code> can take time, but basically instead of copy/paste, just set the two ranges&#39; values equal:<code>Range([destination Range]).Value = Range([copy from]).Value</code>"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481701096, "post_id": 41135753, "comment_id": 69477519, "body": "@BruceWayne When I right click on the sheet, I do not have a option to copy"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481701234, "post_id": 41135753, "comment_id": 69477595, "body": "First, try the <code>Sheets(&quot;XCFIL_&quot; &amp; NumMax).Cells.Value = Sheets(&quot;XCFIL&quot;).Cells.Value</code> option.  ...but when you right click the worksheet <i>tab</i> in Excel, you don&#39;t see &quot;Move or Copy&quot;? That should show up (along with like, Hide, Insert, Delete, Rename, etc.)"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481701842, "post_id": 41135753, "comment_id": 69477885, "body": "@BruceWayne The first option you gave me resulted in err 7 &#39; out of memory&#39;"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1481701864, "post_id": 41135753, "comment_id": 69477896, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/130581/discussion-between-brucewayne-and-andreas\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1481704665, "post_id": 41137566, "comment_id": 69479331, "body": "@Andreas you&#39;re welcome! Out of curiosity does the second macro work? I&#39;m curious to see if so, and if the rows remain visible. No need to spend much more time on it, but if you have an extra few minutes I&#39;d be interested to know."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1481705807, "post_id": 41137566, "comment_id": 69479934, "body": "I will try it later, don&#39;t have time to do it now."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1481818928, "post_id": 41137566, "comment_id": 69537994, "body": "@Andreas - Yay! Glad both versions work.  ...I&#39;m still just really curious why your original code hid all the rows.  I know you&#39;ve got a working solution, so perhaps when you&#39;re bored, do you mind trying something for me and letting me know how it goes?  In the second macro I posted, change that last line (<code>destWS.Range(...).Value = copyRng.Value</code> to this: <code>copyRng.Copy</code> then next line <code>destWS.Range(&quot;A1&quot;).PasteSpecial xlPasteAll</code>  and see if it hides the rows.  I&#39;m going to guess it <i>won&#39;t</i>, but who knows!"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1481702725, "creation_date": 1481702725, "answer_id": 41137566, "question_id": 41135753, "link": "https://stackoverflow.com/questions/41135753/paste-data-on-new-sheet-and-all-cells-are-hidden/41137566#41137566", "title": "Paste data on new sheet and all cells are hidden", "body": "<p>Per the chat, a quick solution is:</p>\n\n<pre><code>'Other option is to simply copy/paste the sheet\nNumMax = NumMax + 1 'there is more code above that sets NumMax\nWith ThisWorkbook\n.Sheets(\"XCFIL\").Copy After:=.Sheets(.Sheets.Count)\nActiveSheet.Name = \"XCFIL_\" &amp; NumMax\nEnd With\n</code></pre>\n\n<p>But, I was working on the below, which may work as well. </p>\n\n<pre><code>Sub t()\nDim originWS As Worksheet, destWS As Worksheet\nDim NumMax As Long\n\nNumMax = NumMax + 1 'there is more code above that sets NumMax\n\nWith ThisWorkbook\nSet originWS = .Sheets(\"XCFIL\")\nSet destWS = .Sheets.Add(After:=.Sheets(.Sheets.Count))\ndestWS.Name = \"XCFIL_\" &amp; NumMax\nEnd With\n\nDim copyRng As Range\nDim lastCol As Long, lastRow As Long\n\nWith originWS\n    lastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n    lastRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n    Set copyRng = .Range(.Cells(1, 1), .Cells(lastRow, lastCol)) 'assuming your data starts in A1\nEnd With\n\ndestWS.Range(destWS.Cells(1, 1), destWS.Cells(lastRow, lastCol)).Value = _\n    copyRng.Value\nEnd Sub\n</code></pre>\n\n<p>And as a note, it's always a good idea to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">avoid using <code>.Select</code>/<code>.Activate</code></a>.</p>\n\n<p>Also, this doesn't get to the very quirky issue of the rows hiding on <code>PasteSpecial</code>. ...but oh well, if it works, it works.</p>\n"}], "owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 41137566, "answer_count": 1, "score": 1, "last_activity_date": 1481702725, "creation_date": 1481694811, "last_edit_date": 1481699997, "question_id": 41135753, "link": "https://stackoverflow.com/questions/41135753/paste-data-on-new-sheet-and-all-cells-are-hidden", "title": "Paste data on new sheet and all cells are hidden", "body": "<p>By some reason every time I run this code it hides all the data on the new sheet.<br>\nThe row heights are set to 0.  </p>\n\n<p>I have to use the mouse to pull on the row height to make the last cell visible then from there I can click on a cell and \"get up\" to the data.  </p>\n\n<p>How can I fix this? It's very annoying.<br>\nIs it something with my code or do I need to set the row height after pasting data like this?</p>\n\n<p><a href=\"https://i.stack.imgur.com/5tGYs.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5tGYs.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/WsHSG.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WsHSG.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>NumMax = NumMax + 1 'there is more code above that sets NumMax\n\nThisWorkbook.Activate\nThisWorkbook.Sheets.Add(After:=wb.Sheets(wb.Sheets.Count)).Name = \"XCFIL_\" &amp; NumMax\nThisWorkbook.Sheets.Add(After:=wb.Sheets(wb.Sheets.Count)).Name = \"Resultat_\" &amp; NumMax\n\nSheets(\"XCFIL\").Activate\nCells.Copy\nSheets(\"XCFIL_\" &amp; NumMax).Activate\nRange(\"A1\").PasteSpecial xlPasteAll\nRange(\"A1\").Select ' a try to get up in the sheet, but it does not work\n</code></pre>\n\n<p>EDIT: Code panes:\n<a href=\"https://i.stack.imgur.com/xI7Kd.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xI7Kd.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "formula"], "comments": [{"owner": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 0, "creation_date": 1481694398, "post_id": 41135500, "comment_id": 69474804, "body": "You need to better define your problem. First, and to check your claim that the loop does not advance, add a breakpoint at the first <code>If</code> within the loop and check the value of <code>cell</code> (or simply use a message window to display the address of it as <code>cell.Address()</code>. Second, you claim that <code>L583</code> is not changing. Why should it change if you are using a <i>literal value</i>?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 2, "creation_date": 1481694544, "post_id": 41135618, "comment_id": 69474858, "body": "<code>ActiveCell</code> should be changed to <code>cell</code> and  <code>cell.Address()</code> need to be changed to <code>cell.Offset(0 ,1).Address()</code>"}, {"owner": {"reputation": 1, "user_id": 6707353, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8f2f3c0edc84474e9e5b3acaa26f9e00?s=128&d=identicon&r=PG&f=1", "display_name": "J.Woe", "link": "https://stackoverflow.com/users/6707353/j-woe"}, "edited": false, "score": 0, "creation_date": 1481731821, "post_id": 41135618, "comment_id": 69496615, "body": "Hello Craig T, I have inputted your code. Thank you for the help, but I am running into a Type Error Mismatch (13) once I get to the &#39;For Each&#39; statement. Another factor I did not mention was that column J as well as K is not completely empty, so I would have to disregard those cells, only IndexMatching ones that are empty. Does the code encompass that issue?"}], "tags": [], "owner": {"reputation": 2663, "user_id": 62765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f7cdd98de0548146a2677029896bed9e?s=128&d=identicon&r=PG", "display_name": "Craig T", "link": "https://stackoverflow.com/users/62765/craig-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1481697533, "last_edit_date": 1481697533, "creation_date": 1481694177, "answer_id": 41135618, "question_id": 41135500, "link": "https://stackoverflow.com/questions/41135500/excel-vba-for-each-loop-is-not-running-through-each-cell/41135618#41135618", "title": "Excel VBA - For Each loop is not running through each cell", "body": "<p>The \"L583\" was not changing because you were not telling it to. The code below should change the reference as the cell address changes.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff837625.aspx\" rel=\"nofollow noreferrer\">Range.Address Property</a></p>\n\n<pre><code>Sub FillVPs()\nDim FillRng As Range, FillRng1 As Range, cell As Range\n\nSet FillRng = Range(\"J2:J2000\")\nSet FillRng1 = Range(\"K2:K2000\")\n\nFor Each cell In FillRng1\n    If cell.Value = \"\" Then\n        cell.Formula = _\n    \"=INDEX(Table4[[#All],[MGRS]], MATCH(\" &amp; cell.Offset(0,1).Address() &amp; \",Table4[[#All],[EMPS]],0))\"\n\n End If\n  Next cell\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6707353, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8f2f3c0edc84474e9e5b3acaa26f9e00?s=128&d=identicon&r=PG&f=1", "display_name": "J.Woe", "link": "https://stackoverflow.com/users/6707353/j-woe"}, "edited": false, "score": 0, "creation_date": 1481732053, "post_id": 41135671, "comment_id": 69496763, "body": "I was looking for a quick and easy way to locate and match all empty cells in column J and K, which your suggestion adequately provides - thanks! In regards to dynamic ranges, could you kindly provide guidance or a resource that would help teach me that logic. I am fairly new to data mining in Excel so I appreciate it."}, {"owner": {"reputation": 1, "user_id": 6707353, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8f2f3c0edc84474e9e5b3acaa26f9e00?s=128&d=identicon&r=PG&f=1", "display_name": "J.Woe", "link": "https://stackoverflow.com/users/6707353/j-woe"}, "edited": false, "score": 0, "creation_date": 1483566663, "post_id": 41135671, "comment_id": 70153480, "body": "Your update worked, and the lesson on dynamic ranges is much appreciated. A follow-up question: is there a way to run the IndexMatch formula only in blank cells while ignoring cells with text?"}, {"owner": {"reputation": 1, "user_id": 6707353, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8f2f3c0edc84474e9e5b3acaa26f9e00?s=128&d=identicon&r=PG&f=1", "display_name": "J.Woe", "link": "https://stackoverflow.com/users/6707353/j-woe"}, "edited": false, "score": 0, "creation_date": 1486406100, "post_id": 41135671, "comment_id": 71321103, "body": "Hi Thomas Inzina. Since you have been the most helpful to me in my Excel VBA project, I was hoping you could answer a question I had in regards to using a reference range to highlight cells in an adjacent table."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 1, "user_id": 6707353, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8f2f3c0edc84474e9e5b3acaa26f9e00?s=128&d=identicon&r=PG&f=1", "display_name": "J.Woe", "link": "https://stackoverflow.com/users/6707353/j-woe"}, "edited": false, "score": 0, "creation_date": 1486431957, "post_id": 41135671, "comment_id": 71331965, "body": "Okay  @J.Woe. What is it?"}, {"owner": {"reputation": 1, "user_id": 6707353, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8f2f3c0edc84474e9e5b3acaa26f9e00?s=128&d=identicon&r=PG&f=1", "display_name": "J.Woe", "link": "https://stackoverflow.com/users/6707353/j-woe"}, "edited": false, "score": 0, "creation_date": 1486493331, "post_id": 41135671, "comment_id": 71365635, "body": "I am attempting to annotate rows of data on a table (Table 1). It will be at random, based on two criterias from a separate table (Table 2).  Table 1 has two columns; Column A which will have a &quot;Check&quot; word coded to be populated randomly based on criteria from Table 2, and Column B which has different names down the rows, some of which could be duplicates.  Table 2&#39;s Column A will have all the names in Table 1 de-duplicated, and their Column B will have a number which indicates the number of rows to be annotated in Table 1 - based on a match between Table 1&#39;s Column B and Table 2&#39;s Column A."}, {"owner": {"reputation": 1, "user_id": 6707353, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8f2f3c0edc84474e9e5b3acaa26f9e00?s=128&d=identicon&r=PG&f=1", "display_name": "J.Woe", "link": "https://stackoverflow.com/users/6707353/j-woe"}, "edited": false, "score": 1, "creation_date": 1486493508, "post_id": 41135671, "comment_id": 71365735, "body": "I am at a standstill with this and sincerely appreciate any help you can provide."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 1, "user_id": 6707353, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8f2f3c0edc84474e9e5b3acaa26f9e00?s=128&d=identicon&r=PG&f=1", "display_name": "J.Woe", "link": "https://stackoverflow.com/users/6707353/j-woe"}, "edited": false, "score": 0, "creation_date": 1486677238, "post_id": 41135671, "comment_id": 71461607, "body": "@J.Woe Sorry that I haven&#39;t got back to you before now.  I&#39;m not quite sure what you mean.  If you email me a sample workbook at tommy70458@gmail.com I&#39;ll look it over.  I&#39;m pretty busy right now, you&#39;ll probably get a quicker response by posting the Question to SO.  If you do please send me the link."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 0, "last_activity_date": 1483567214, "last_edit_date": 1483567214, "creation_date": 1481694418, "answer_id": 41135671, "question_id": 41135500, "link": "https://stackoverflow.com/questions/41135500/excel-vba-for-each-loop-is-not-running-through-each-cell/41135671#41135671", "title": "Excel VBA - For Each loop is not running through each cell", "body": "<p>The problem is that you are only setting the formula for the <code>ActiveCell</code>.  </p>\n\n<pre><code>ActiveCell.Formula = _\n\"=INDEX(Table4[[#All],[MGRS]], MATCH(L583,Table4[[#All],[EMPS]],0))\"\n</code></pre>\n\n<p>This should fix it</p>\n\n<pre><code>cell.Formula = _\n\"=INDEX(Table4[[#All],[MGRS]], MATCH(L583,Table4[[#All],[EMPS]],0))\"\n</code></pre>\n\n<p>You'll probably need to adjust <code>L583</code>.  It will not fill correctly unless you are filling across all cell.</p>\n\n<p>These ranges should probably be changed so that they are dynamic.</p>\n\n<pre><code>Set FillRng = Range(\"J2:J2000\")\nSet FillRng1 = Range(\"K2:K2000\")\n</code></pre>\n\n<p>You should apply the formula to all the cells in the range</p>\n\n<blockquote>\n  <p>Range(\"K2:K2000\").Formula = \"=INDEX(Table4[[#All],[MGRS]], MATCH(L2,Table4[[#All],[EMPS]],0))\"</p>\n</blockquote>\n\n<h2>UPDATE: Dynamic Range</h2>\n\n<p>Every table in Excel should have at least one column that contain an entry for every record in the table.  This column should be used to define the height of the Dynamic Range.</p>\n\n<p>For instance if Column A always has entries and you want to create a Dynamic Range for Column K</p>\n\n<pre><code>lastrow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nSet rng1 = Range(\"K2:K\" &amp; lastrow)\n</code></pre>\n\n<p>Or </p>\n\n<pre><code>Set rng1 = Range(\"A2:A\" &amp; Rows.Count).End(xlUp).Offset(0, 10)\n</code></pre>\n\n<h2>UPDATE:</h2>\n\n<p>Use <code>Range.SpecialCells(xlCellTypeBlanks)</code> to target the blank cells. You'll have to add an Error handler because <code>SpecialCells</code> will throw an Error if no blank cells were found.</p>\n\n<p><a href=\"https://i.stack.imgur.com/5Vv2p.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5Vv2p.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>On Error Resume Next\nSet rng1 = Range(\"A2:A\" &amp; Rows.Count).End(xlUp).Offset(0, 10).SpecialCells(xlCellTypeBlanks)\nOn Error GoTo 0\n\nIf rng1 Is Nothing Then\n    MsgBox \"There were no Blank Cels Found\", vbInformation, \"Action Cancelled\"\n    Exit Sub\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6707353, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8f2f3c0edc84474e9e5b3acaa26f9e00?s=128&d=identicon&r=PG&f=1", "display_name": "J.Woe", "link": "https://stackoverflow.com/users/6707353/j-woe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1415, "favorite_count": 0, "accepted_answer_id": 41135671, "answer_count": 2, "score": 0, "last_activity_date": 1483567214, "creation_date": 1481693530, "last_edit_date": 1481693797, "question_id": 41135500, "link": "https://stackoverflow.com/questions/41135500/excel-vba-for-each-loop-is-not-running-through-each-cell", "title": "Excel VBA - For Each loop is not running through each cell", "body": "<p>I am currently facing an issue in which my 'for each' loop is not moving onto subsequent cells for each cell in the range I have defined when I try to execute the script. The context around the data is below:</p>\n\n<p>I have 3 columns of data. Column L contains employees, Column K contains managers, and column J contains VPs. Column K &amp; J containing managers and VPs are not fully populated - therefore, I would like to use a VBA script &amp; Index Match to populate all the cells and match employees to managers to VPs. </p>\n\n<p>I have created a reference table in which I have populated all the employees to managers to directors and have named this table \"Table 4\". I am then using the VBA code below to try and run through each cell in column K to populate managers:</p>\n\n<pre><code>Sub FillVPs()\nDim FillRng As Range, FillRng1 As Range, cell As Range\n\nSet FillRng = Range(\"J2:J2000\")\nSet FillRng1 = Range(\"K2:K2000\")\n\nFor Each cell In FillRng1\n    If cell.Value = \"\" Then\n        ActiveCell.Formula = _\n    \"=INDEX(Table4[[#All],[MGRS]], MATCH(L583,Table4[[#All],[EMPS]],0))\"\n\n End If\n  Next cell\nEnd Sub\n</code></pre>\n\n<p>I feel that something is definitely wrong with the index match formula as the match cell \"L583\" is not moving to the next cell each time it runs through the loop; however, I am not sure how to fix it. I also do not know what else is potentially missing. The code currently executes, but it stays stuck on one cell.</p>\n\n<p>Any help is greatly appreciated, and I will make sure to clarify if necessary. Thank you in advance.</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 2, "last_activity_date": 1481691503, "creation_date": 1481691503, "answer_id": 41135137, "question_id": 41135094, "link": "https://stackoverflow.com/questions/41135094/excel-rename-sheets-consecutively-with-vba/41135137#41135137", "title": "Excel rename sheets consecutively with VBA", "body": "<p><a href=\"https://msdn.microsoft.com/en-us/library/bbx05d0c(v=vs.90).aspx\" rel=\"nofollow noreferrer\">MSDN DateSerial Function (Visual Basic)</a>: Returns a Date value representing a specified year, month, and day, with the time information set to midnight (00:00:00).</p>\n\n<pre><code>ActiveSheet.Name = Format(DateSerial(2017,I,1), \"dd-mm-yy\")\n</code></pre>\n"}], "owner": {"reputation": 169, "user_id": 2203930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ece714a706ba754910b5ffe694e0ef79?s=128&d=identicon&r=PG", "display_name": "Exhausted", "link": "https://stackoverflow.com/users/2203930/exhausted"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "accepted_answer_id": 41135137, "answer_count": 1, "score": 1, "last_activity_date": 1481691503, "creation_date": 1481691245, "question_id": 41135094, "link": "https://stackoverflow.com/questions/41135094/excel-rename-sheets-consecutively-with-vba", "title": "Excel rename sheets consecutively with VBA", "body": "<p>I'm using the below code to duplicate my excel sheets (it pops up a box asking the user how many times they want to duplicate the sheet)</p>\n\n<pre><code>Sub Create()\n'Updateby Extendoffice 20160704\n    Dim I As Long\n    Dim xNumber As Integer\n    Dim xName As String\n    Dim xActiveSheet As Worksheet\n    On Error Resume Next\n    Application.ScreenUpdating = False\n    Set xActiveSheet = ActiveSheet\n    xNumber = InputBox(\"Enter number of times to duplicate this sheet\")\n    For I = 1 To xNumber\n        xName = ActiveSheet.Name\n        xActiveSheet.Copy After:=ActiveWorkbook.Sheets(xName)\n        ActiveSheet.Name = \"dd-mm-yy\" &amp; I\n    Next\n    xActiveSheet.Activate\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>I would like excel VBA to consecutively rename the sheets</p>\n\n<p>The sheet to be duplicated will always be the start of the month \"01-01-17\" and i would like each sheet to be renamed accordingly, \"02-01-17, 03-01-17 etc\"</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 1126, "user_id": 1368115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24bed58b351e881fc981f08bef1877b?s=128&d=identicon&r=PG", "display_name": "DHW", "link": "https://stackoverflow.com/users/1368115/dhw"}, "edited": false, "score": 0, "creation_date": 1481707873, "post_id": 41134780, "comment_id": 69481123, "body": "Off the top of my head, try removing the semicolon from the end of the the strSQL query.  Other than that, I&#39;d be curious to know what <code>qdf.Parameters.Count</code> is, before the execute."}], "answers": [{"tags": [], "owner": {"reputation": 305, "user_id": 6435422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ebd2c80f456dc3596617b2d8505f70b?s=128&d=identicon&r=PG&f=1", "display_name": "Lybren", "link": "https://stackoverflow.com/users/6435422/lybren"}, "is_accepted": false, "score": 1, "last_activity_date": 1481745021, "last_edit_date": 1481745021, "creation_date": 1481720767, "answer_id": 41143416, "question_id": 41134780, "link": "https://stackoverflow.com/questions/41134780/access-vba-adding-filename-field-when-importing-multiple-files/41143416#41143416", "title": "Access VBA: Adding &#39;filename&#39; field when importing multiple files", "body": "<p>Adjust your SQL query, your's doesn't contain the parameter.  </p>\n\n<pre><code>strSQL = \"PARAMETERS pfilename Text ( 255 ); UPDATE Test SET FileName=[pFileName] WHERE FileName Is Null OR FileName='';\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 1, "last_activity_date": 1481746242, "creation_date": 1481746242, "answer_id": 41151343, "question_id": 41134780, "link": "https://stackoverflow.com/questions/41134780/access-vba-adding-filename-field-when-importing-multiple-files/41151343#41151343", "title": "Access VBA: Adding &#39;filename&#39; field when importing multiple files", "body": "<p>Adding a <em>FileName</em> field is markedly different than updating its value. Hence, you need two SQL action queries: <code>ALTER</code> and <code>UPDATE</code> statements.</p>\n\n<p>Specifically, the query requires two components that are unknown by the engine: <em>FileName</em> column and <em>[pFileName]</em> parameter value. Most likely, your Excel worksheets do not have a <em>FileName</em> column being imported into <em>Test</em> table. </p>\n\n<p>Consider the following setup employing an <code>ALTER</code> statement within loop (only on very first iteration since all worksheets append to same table):</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>'Add filename field\nFor intFile = 1 To UBound(strFileList)    \n    filename = path &amp; strFileList(intFile)\n    DoCmd.TransferSpreadsheet acImport, 9, \"Test\", filename, True\n\n    If intFile = 1 then\n       ' ALTER TABLE\n       CurrentDb.Execute \"ALTER TABLE [Test] ADD COLUMN [FileName] TEXT(255)\", dbFailOnError\n    End If\n\n    ' UPDATE TABLE (PASSING PARAM VALUE)\n    qdf.Parameters(\"pFileName\").Value = strFileList(intFile)\n    qdf.Execute dbFailOnError   \nNext intFile\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7187041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/982051741b523eb0abf5cdceb9800d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Dominic", "link": "https://stackoverflow.com/users/7187041/dominic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1797, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1481746242, "creation_date": 1481689177, "last_edit_date": 1495542633, "question_id": 41134780, "link": "https://stackoverflow.com/questions/41134780/access-vba-adding-filename-field-when-importing-multiple-files", "title": "Access VBA: Adding &#39;filename&#39; field when importing multiple files", "body": "<p>I have some working code that loops through a folder full of Excel files, and imports a table from each into the an Access table.  All I'm trying to do is add a field at the end of the table called <em>FileName</em> that has the name of the source Excel file.</p>\n\n<p>I've done some Googling and found this solution:\n<a href=\"https://stackoverflow.com/questions/37861815/how-to-add-file-name-when-importing-multiple-excel-files-to-one-access-table\">How to add file name when importing multiple Excel files to one Access table</a></p>\n\n<p>I've tried to incorporate the solution into my code, but when I reach the execute statement, I get:</p>\n\n<blockquote>\n  <p>Run-time error '3061' Too few parameters.  Expected 2.</p>\n</blockquote>\n\n<p>I think the problem is just with the <code>strSQL</code> statement and/or the way I'm executing it at the end.    </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub Command0_Click()\n\nDim strFile As String 'Filename\nDim strFileList() As String 'File Array\nDim intFile As Integer 'File Number\nDim filename As String\nDim path As String\nDim qdf As DAO.QueryDef\n\nSet db = CurrentDb()\n'make the UPDATE a parameter query ...\nstrSQL = \"UPDATE Test SET FileName=[pFileName] WHERE FileName Is Null OR\nFileName='';\"\nSet qdf = db.CreateQueryDef(vbNullString, strSQL)\n\npath = \"C:\\Users\\u005984\\Desktop\\Test\\\"\n\n'Loop through the folder &amp; build file list\nstrFile = Dir(path &amp; \"*.xlsx\")\n\nWhile strFile &lt;&gt; \"\"\n   'add files to the list\n   intFile = intFile + 1\n   ReDim Preserve strFileList(1 To intFile)\n   strFileList(intFile) = strFile\n   strFile = Dir()\nWend\n\n'see if any files were found\nIf intFile = 0 Then\n    MsgBox \"No files found\"\n    Exit Sub\nEnd If\n\n'cycle through the list of files\nFor intFile = 1 To UBound(strFileList)\n    filename = path &amp; strFileList(intFile)\n    DoCmd.TransferSpreadsheet acImport, 9, \"Test\", filename, True\n\n    'Add filename field\n    qdf.Parameters(\"pFileName\").Value = strFileList(intFile)\n    qdf.Execute dbFailOnError   \nNext intFile\n\nEnd Sub\n</code></pre>\n\n<p>I'm new to Access VBA and SQL, and can't figure out why its expecting 2 parameters. Grateful for any help.</p>\n"}, {"tags": ["excel", "excel-formula", "worksheet-function", "worksheet", "vba"], "comments": [{"owner": {"reputation": 1069, "user_id": 5620071, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Vw86Z.jpg?s=128&g=1", "display_name": "Mister 832", "link": "https://stackoverflow.com/users/5620071/mister-832"}, "edited": false, "score": 0, "creation_date": 1481705726, "post_id": 41134704, "comment_id": 69479896, "body": "Could you Show us some code? It makes it easier to help you."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 7208533, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6f304f52074ca63ca02920bd4226ff16?s=128&d=identicon&r=PG&f=1", "display_name": "leveygao", "link": "https://stackoverflow.com/users/7208533/leveygao"}, "edited": false, "score": 0, "creation_date": 1481859515, "post_id": 41140879, "comment_id": 69554178, "body": "Thank you for the advice &quot;&#39;=&#39;&quot; &amp; sheetname &amp; &quot;!&#39;$B$2&quot; is the correct form!"}, {"owner": {"reputation": 330, "user_id": 7291399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUn81.jpg?s=128&g=1", "display_name": "Scarfe", "link": "https://stackoverflow.com/users/7291399/scarfe"}, "reply_to_user": {"reputation": 73, "user_id": 7208533, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6f304f52074ca63ca02920bd4226ff16?s=128&d=identicon&r=PG&f=1", "display_name": "leveygao", "link": "https://stackoverflow.com/users/7208533/leveygao"}, "edited": false, "score": 0, "creation_date": 1481875259, "post_id": 41140879, "comment_id": 69559412, "body": "No problem - glad you got it sorted!"}], "tags": [], "owner": {"reputation": 330, "user_id": 7291399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUn81.jpg?s=128&g=1", "display_name": "Scarfe", "link": "https://stackoverflow.com/users/7291399/scarfe"}, "is_accepted": true, "score": 0, "last_activity_date": 1481713043, "creation_date": 1481713043, "answer_id": 41140879, "question_id": 41134704, "link": "https://stackoverflow.com/questions/41134704/how-to-input-formula-into-cells-while-citing-different-worksheets/41140879#41140879", "title": "How to input formula into cells while citing different worksheets", "body": "<p>It is difficult to understand what you are trying to ask, but I'll do my best to solve your problem. In future, it is advisable to include code along with your question.</p>\n\n<p>To input formula into a cell, you can use the <code>Range.Formula</code> method. There is a good explanation on how this works here:- <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838835.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff838835.aspx</a></p>\n\n<p>It is my understanding, however, that you are looking to input the formula as text, so that you can refer to it later on. The simplest way to do this is to use the <code>Range.Value</code> method. This is described here:- <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195193.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff195193.aspx</a></p>\n\n<p>However, if you simply insert a formula in the format <code>=FORMULA</code> into <code>Range.Value</code> you will find that Excel will interpret this as a formula and thus attempt to display the value for its solution. The simplest way to overcome this is to include an apostrophe before the equals sign in your formula like so:-  <code>'=FORMULA</code></p>\n\n<p>This forces Excel to interpret the formula as text only. The cell will display your chosen formula in a readable format. Therefore, your solution will look something like so:-</p>\n\n<pre><code>Cells(1,2).Value = \"'='\" &amp; Cells(1,1).Value &amp; \"!'$B$2\"\n</code></pre>\n\n<p>Whereby <code>Cells(1,1)</code> contains the name of your worksheet, and <code>Cells(1,2)</code> will become your reference formula. </p>\n\n<p>To later refer to this cell and use it as a formula you will need to remove the apostrophe we have just added. There are a number of ways you could do this; if you need additional help just ask.</p>\n"}], "owner": {"reputation": 73, "user_id": 7208533, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6f304f52074ca63ca02920bd4226ff16?s=128&d=identicon&r=PG&f=1", "display_name": "leveygao", "link": "https://stackoverflow.com/users/7208533/leveygao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 41140879, "answer_count": 1, "score": 0, "last_activity_date": 1481778577, "creation_date": 1481688608, "last_edit_date": 1531161705, "question_id": 41134704, "link": "https://stackoverflow.com/questions/41134704/how-to-input-formula-into-cells-while-citing-different-worksheets", "title": "How to input formula into cells while citing different worksheets", "body": "<p>I have been using VBA for a while and now I am stuck on this issue:</p>\n\n<p>Say I have A,B,C,D,E... in each cell as worksheets' names&amp;&amp;the name matches 100% each worksheet's name(worksheet A, B, C...)</p>\n\n<p>So how do I use VBA to input formula into COL2, as the form like ='sheetname!'$B$2(Cell address)?\nThe sheetname inside formula corresponds to COL1(&amp;&amp;each worksheet's name)</p>\n\n<p>Usually the VBA returns the value only, but I need REFERENCE by printing the formula this time.</p>\n\n<p>----COL1----COL2</p>\n\n<p>R1-- A  \uff1d'A!'$B$2</p>\n\n<p>R2-- B  \uff1d'B!'$B$2</p>\n\n<p>R3-- C  \uff1d'C!'$B$2</p>\n\n<p>R4-- D  \uff1d'D!'$B$2</p>\n\n<p>R.-- ...    \uff1d'...!'$B$2</p>\n\n<p>In real case the worksheet name is very messy,not like structured letter&amp;num,</p>\n\n<h1>Your advice is much appreciated! Thank you!</h1>\n\n<p>I guess two pictures will illustrate my question better:</p>\n\n<p><a href=\"https://i.stack.imgur.com/dVTKt.jpg\" rel=\"nofollow noreferrer\">overview</a>\n<a href=\"https://i.stack.imgur.com/86to8.jpg\" rel=\"nofollow noreferrer\">worksheets</a></p>\n\n<p>seems I cant embed image yet..but anyway...\nso my goal is:\n1.Get the name from Name(C) col.\n2.Write the formula in Supplier(D) col.  ='(name in Col.C)'!$B$2</p>\n\n<p>Note:The names in col.C correspond to worksheets.(picture2)</p>\n\n<p>*My original plan is:</p>\n\n<p>For Each wrksheet In Worksheets</p>\n\n<pre><code>    If wrksheet.Index &gt;= 10  Then\n\n        sheetname = wrksheet.Name #1 pass wrksheet's name into sheetname variable\n        sum.Cells(i, 4).formula = \"='sheetname!'$B$2\" #2 input current worksheet's cell(B2) and print into worksheet sum's cell(i,4)\n\n    End If\n    i=i+1\n</code></pre>\n\n<p>But, obviously, this trick (#2) doesn't work....\nSo how do I auto-write formula after getting worksheet's name?\nHope this is clear for you guys?</p>\n\n<p>==========================================\nSub formula()</p>\n\n<pre><code>Dim s As Worksheet, w As Worksheet\nSet s = Worksheets(\"Summary\")\nDim i, stname\n\ni = 1\nFor Each w In Worksheets\n\n    If w.Index &gt; 1 Then\n\n        stname = w.Name\n        s.Cells(i, 4).formula = \"=\" &amp; stname &amp; \"!$B$2\"\n\n\n    End If\n    i = i + 1\nNext w\n</code></pre>\n\n<p>End Sub</p>\n\n<p>but the code reports problem...why is that?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1574, "user_id": 6304906, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/783a08c5d7a3ca42d6fb007774a49f45?s=128&d=identicon&r=PG&f=1", "display_name": "Barney", "link": "https://stackoverflow.com/users/6304906/barney"}, "edited": false, "score": 2, "creation_date": 1481687618, "post_id": 41134548, "comment_id": 69472984, "body": "last_row = ActiveSheet.Range(&quot;a1048576&quot;).End(xlUp).Row  Change the Cell reference per your requirement"}, {"owner": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "reply_to_user": {"reputation": 1574, "user_id": 6304906, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/783a08c5d7a3ca42d6fb007774a49f45?s=128&d=identicon&r=PG&f=1", "display_name": "Barney", "link": "https://stackoverflow.com/users/6304906/barney"}, "edited": false, "score": 0, "creation_date": 1481688175, "post_id": 41134548, "comment_id": 69473087, "body": "hi @barney, the code  you gave is just return the row number. i want the last row value. sorry if i din&#39;t mention previously."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1481689819, "post_id": 41134548, "comment_id": 69473444, "body": "You should post your code so that we can tailor an answer to it.  Anyway this is Excel VBA 101.  Change x to your column <code>Cells(Rows.Count, x).End (xlUp)</code>.  You should watch <a href=\"https://www.youtube.com/watch?v=c8reU-H1PKQ&amp;index=5&amp;list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5&amp;t=3116s\" rel=\"nofollow noreferrer\">Excel VBA Introduction Part 5 - Selecting Cells (Range, Cells, Activecell, End, Offset) by WiseOwlTutorials</a>"}], "answers": [{"tags": [], "owner": {"reputation": 47, "user_id": 5761418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AcYfL.png?s=128&g=1", "display_name": "xtoybox", "link": "https://stackoverflow.com/users/5761418/xtoybox"}, "is_accepted": false, "score": 2, "last_activity_date": 1481690080, "creation_date": 1481690080, "answer_id": 41134921, "question_id": 41134548, "link": "https://stackoverflow.com/questions/41134548/excel-vba-finding-last-non-empty-row-based-on-column-header/41134921#41134921", "title": "Excel VBA - Finding Last Non-Empty Row Based on Column Header", "body": "<p>for the example given, column B, this should do the trick</p>\n\n<pre><code>Dim lastrow as Integer, val\nlastrow = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nval = range(\"B\" &amp; lastrow + 2).Value\n</code></pre>\n\n<p>to iterate through your rows(header) that is not empty is another story that you can easily search for.</p>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1481869876, "post_id": 41136962, "comment_id": 69557099, "body": "@Jeeva, would you give any feedback?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1481700165, "creation_date": 1481700165, "answer_id": 41136962, "question_id": 41134548, "link": "https://stackoverflow.com/questions/41134548/excel-vba-finding-last-non-empty-row-based-on-column-header/41136962#41136962", "title": "Excel VBA - Finding Last Non-Empty Row Based on Column Header", "body": "<p>you may be after something like this</p>\n\n<pre><code>Dim svVal As String\n\nsvVal = \"SVC525\" '&lt;--| set your header value to be searched for in row 1\nWith Worksheets(\"averages\") '&lt;--| change \"Averages\" tou your actual sheet name\n    MsgBox .Cells(.Rows.count, .Range(\"A1\", .Cells(1, .Columns.count).End(xlToLeft)).Find(what:=svVal, LookIn:=xlValues, lookat:=xlWhole).column).End(xlUp)\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9299, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1523867089, "creation_date": 1481687261, "last_edit_date": 1508249772, "question_id": 41134548, "link": "https://stackoverflow.com/questions/41134548/excel-vba-finding-last-non-empty-row-based-on-column-header", "title": "Excel VBA - Finding Last Non-Empty Row Based on Column Header", "body": "<p>I am currently creating a reporting sheet for equipment for our company. This sheet will grab data from multiple Excel sheets and populate it based on our custom report template. So far I have managed to find on how to merge multiple sheets and find the column header. But now I'm stucked on how to find the last non empty value based on column header. </p>\n\n<p><a href=\"https://i.stack.imgur.com/XU8D3.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XU8D3.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Attached in the picture above is the sample data. As you can see, the last non empty cell in each row is the average of the row. What I am trying to do is to find the header column(eg SVC525) and take the last non empty value of the column, which is average.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 330, "user_id": 7291399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUn81.jpg?s=128&g=1", "display_name": "Scarfe", "link": "https://stackoverflow.com/users/7291399/scarfe"}, "is_accepted": false, "score": 1, "last_activity_date": 1481705041, "creation_date": 1481705041, "answer_id": 41138171, "question_id": 41133592, "link": "https://stackoverflow.com/questions/41133592/tables-worksheet-change-fires-multiple-times/41138171#41138171", "title": "Tables - Worksheet_Change Fires Multiple Times", "body": "<p>The easiest workaround for this is to add an assertion at the beginning of your event, that checks that the target cell does not already contain a default column name.</p>\n\n<p>I would do this with a simple <code>if</code> and <code>like</code> statement, which catches when a heading begins with \"Column\" and exits the event using <code>Exit Sub</code>. You could do all of this in one simple line of code. Something like...</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.value Like \"Column*\" Then Exit Sub\napplication.EnableEvents = False    \n    If Not Intersect(Target, Me.ListObjects(\"Table1\").HeaderRowRange) Is Nothing Then\n        msgbox \"Hello\"\n    end if\napplication.EnableEvents = True  \nEnd Sub \n</code></pre>\n\n<p>This code is admittedly untested but it should provide you with a good base to start from.</p>\n"}], "owner": {"reputation": 21, "user_id": 7293969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1555724143337cd631e8e24957fabfe?s=128&d=identicon&r=PG&f=1", "display_name": "nohydro", "link": "https://stackoverflow.com/users/7293969/nohydro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1481705041, "creation_date": 1481680714, "last_edit_date": 1531161705, "question_id": 41133592, "link": "https://stackoverflow.com/questions/41133592/tables-worksheet-change-fires-multiple-times", "title": "Tables - Worksheet_Change Fires Multiple Times", "body": "<p>I'm trying to capture the worksheet change event when a table heading is cleared by the user.    </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\napplication.EnableEvents = False    \n    If Not Intersect(Target, Me.ListObjects(\"Table1\").HeaderRowRange) Is Nothing Then\n        msgbox \"Hello\"\n    end if\napplication.EnableEvents = True  \nEnd Sub \n</code></pre>\n\n<p>If the user presses \"delete\" to clear a non-default heading name on the table, Excel automatically replaces the blank heading with the default heading name (eg. \"Column1\").  This seems to cause the worksheet change event to run multiple times.  I'd like to figure out a way to have this event run only once when the user clears the a heading.  </p>\n\n<p>Any help is greatly appreciated. </p>\n"}, {"tags": ["vba", "excel", "macros"], "answers": [{"tags": [], "owner": {"reputation": 429, "user_id": 1406609, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0c20387b206378db5b52532238478a34?s=128&d=identicon&r=PG", "display_name": "FancyDolphin", "link": "https://stackoverflow.com/users/1406609/fancydolphin"}, "is_accepted": false, "score": 0, "last_activity_date": 1481681388, "creation_date": 1481681388, "answer_id": 41133689, "question_id": 41133586, "link": "https://stackoverflow.com/questions/41133586/intuitive-auto-population-of-data-between-two-worksheets/41133689#41133689", "title": "Intuitive auto-population of data between two worksheets", "body": "<p>The quickest way is to use powerpivot. You'll have to look at your version of excel to see how to access it. For instance, powerpivot is included and preset in excel 2016, and is a free add-on you'll need to download for excel 2010.   </p>\n\n<p>You can uplaod both those tables into the powerpivot model, define the relationship between the two tables (as simple as dragging the relationships in a diagram view). Then you literally have a pivot table that connects both and you can create a measure that does what you're saying. The plus is that there's so much more you can do!<br>\nHearing how your data is set up if you run through a powerpivot table tutorial you might even rethink your data set-up. The advantage is you don't need to learn vba just learn to apply your current and new excel skills. A good starting point is here: \n<a href=\"https://msdn.microsoft.com/en-us/library/gg413497(v=sql.110).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/gg413497(v=sql.110).aspx</a></p>\n\n<p>There are also 5 min youtube clips that'll give you a good idea of what else you can do with it. </p>\n"}], "owner": {"reputation": 1, "user_id": 7293974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20a3febb9a08140e1583ca2fe819de85?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/7293974/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1481681388, "creation_date": 1481680623, "question_id": 41133586, "link": "https://stackoverflow.com/questions/41133586/intuitive-auto-population-of-data-between-two-worksheets", "title": "Intuitive auto-population of data between two worksheets", "body": "<p>I have two excel tables. One is a list of names with a calendar that tracks number of days traveled and puts it in percentage. The other table shows proposed travel schedules for the same list of people but in a different format. I have to manually find their percentage in table 1 and input them to the second table for presentations. I want to develop something that reads the names in both tables and can copy their travel time percentage into the second chart. Maybe adding it in the cell or to a blank row below. I have been unable to find any previous threads relating to this. I am new to programing and do not know if this can be done in VBA macro for excel. Does anyone know what functions I could use to accomplish this?</p>\n"}, {"tags": ["vba", "excel", "apache-poi"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1481673971, "post_id": 41132541, "comment_id": 69469492, "body": "perhaps <code>=CELL(&quot;filename&quot;)</code> works for you?"}, {"owner": {"reputation": 22219, "user_id": 14663, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/611db642b9164a9425f953071a5939ff?s=128&d=identicon&r=PG", "display_name": "WW.", "link": "https://stackoverflow.com/users/14663/ww"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1481674388, "post_id": 41132541, "comment_id": 69469616, "body": "@CallumDA This returns the current spreadsheet location and workbook name."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481675043, "post_id": 41132541, "comment_id": 69469824, "body": "What&#39;s the difference then? I&#39;m not sure what you&#39;re looking for. Doesn&#39;t <code>=Cell(&quot;filename&quot;)</code> return something like <code>C:\\Users\\Myself\\blah\\[VariousData.xlsx]SummarySheet</code>? What&#39;s the &quot;abosulte path&quot; you&#39;re looking for?"}, {"owner": {"reputation": 22219, "user_id": 14663, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/611db642b9164a9425f953071a5939ff?s=128&d=identicon&r=PG", "display_name": "WW.", "link": "https://stackoverflow.com/users/14663/ww"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481675746, "post_id": 41132541, "comment_id": 69470007, "body": "@BruceWayne I&#39;ve some steps to the question in an attempt to clarify.  I want to know the absolute path to the document which is saved in the spreadsheet itself, rather than where it is now."}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481698444, "post_id": 41133325, "comment_id": 69476274, "body": "&quot;This is why it is not a good idea to share work-related spreadsheets with other people, unless you first clear out this sort of information&quot; - how would one make sure this info. isn&#39;t there, when sharing worksheets?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1481700838, "post_id": 41133325, "comment_id": 69477386, "body": "@BruceWayne - that would be the same way that the OP did - by using the Document Inspector.  In Excel 2010 that can be found from File / Info /  Check for Issues.  Other versions will have slightly different ways to get to it."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481701452, "post_id": 41133325, "comment_id": 69477699, "body": "Ah! Sorry - didn&#39;t know that was what that does...I thought it just <i>checked</i> for issues, not also helps you remove such info. Thanks!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1481701566, "post_id": 41133325, "comment_id": 69477752, "body": "@BruceWayne - to be honest, I&#39;ve never actually used it myself, and I only found out it even existed a couple of months ago - it&#39;s not exactly the sort of thing one expects to find, or goes looking for unless someone mentions it exists."}, {"owner": {"reputation": 22219, "user_id": 14663, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/611db642b9164a9425f953071a5939ff?s=128&d=identicon&r=PG", "display_name": "WW.", "link": "https://stackoverflow.com/users/14663/ww"}, "edited": false, "score": 0, "creation_date": 1481767129, "post_id": 41133325, "comment_id": 69512319, "body": "Thanks for this answer, but unfortunately I have an .xls file."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 22219, "user_id": 14663, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/611db642b9164a9425f953071a5939ff?s=128&d=identicon&r=PG", "display_name": "WW.", "link": "https://stackoverflow.com/users/14663/ww"}, "edited": false, "score": 0, "creation_date": 1482315263, "post_id": 41133325, "comment_id": 69720812, "body": "@WW. - is it &#39;real&#39; xls file or an xlsx where someone then did a &#39;save as&#39; as xls ?"}, {"owner": {"reputation": 22219, "user_id": 14663, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/611db642b9164a9425f953071a5939ff?s=128&d=identicon&r=PG", "display_name": "WW.", "link": "https://stackoverflow.com/users/14663/ww"}, "edited": false, "score": 0, "creation_date": 1482317171, "post_id": 41133325, "comment_id": 69722220, "body": "I think it&#39;s a real xls. How would I tell?"}, {"owner": {"reputation": 3239, "user_id": 2066598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a26e694851b45c593c3f335a06dc002?s=128&d=identicon&r=PG", "display_name": "kiwiwings", "link": "https://stackoverflow.com/users/2066598/kiwiwings"}, "reply_to_user": {"reputation": 22219, "user_id": 14663, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/611db642b9164a9425f953071a5939ff?s=128&d=identicon&r=PG", "display_name": "WW.", "link": "https://stackoverflow.com/users/14663/ww"}, "edited": false, "score": 0, "creation_date": 1482388427, "post_id": 41133325, "comment_id": 69755564, "body": "@WW the <a href=\"http://poi.apache.org/apidocs/org/apache/poi/ss/usermodel/WorkbookFactory.html\" rel=\"nofollow noreferrer\">WorkbookFactory</a> parses the file magic and not the extension ... if you receive a HSSFWorkbook its in BIFF8 format otherwise its in OOXML format"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 9, "last_activity_date": 1481678744, "creation_date": 1481678744, "answer_id": 41133325, "question_id": 41132541, "link": "https://stackoverflow.com/questions/41132541/obtain-the-absolute-path-to-the-workbook-from-an-xls-file/41133325#41133325", "title": "Obtain the &quot;absolute path to the workbook&quot; from an .xls file", "body": "<p>Assuming it is an <code>.xlsx</code> file rather than an older-style <code>.xls</code> file, you can </p>\n\n<ol>\n<li>Rename the workbook as a <code>.zip</code> file</li>\n<li>Look at the <code>xl\\workbook.xml</code> \"file\" within the <code>.zip</code> file</li>\n</ol>\n\n<p>and you will find the absolute path when last saved from Excel.</p>\n\n<p>This is why it is not a good idea to share work-related spreadsheets with other people, unless you first clear out this sort of information.</p>\n\n<hr>\n\n<p>I'm not sure how to find it in the binary format files.</p>\n"}, {"comments": [{"owner": {"reputation": 22219, "user_id": 14663, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/611db642b9164a9425f953071a5939ff?s=128&d=identicon&r=PG", "display_name": "WW.", "link": "https://stackoverflow.com/users/14663/ww"}, "edited": false, "score": 0, "creation_date": 1482201846, "post_id": 41233543, "comment_id": 69667744, "body": "I tried a hex editor on the file I have and found nothing before posting this question.  I thought perhaps Excel used some esoteric encoding.  I&#39;ve ran the commands you listed, which all worked but none produced the full path.  So potentially it&#39;s being reported incorrectly by Excel in the first place."}], "tags": [], "owner": {"reputation": 3239, "user_id": 2066598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a26e694851b45c593c3f335a06dc002?s=128&d=identicon&r=PG", "display_name": "kiwiwings", "link": "https://stackoverflow.com/users/2066598/kiwiwings"}, "is_accepted": true, "score": 11, "last_activity_date": 1482196842, "creation_date": 1482196842, "answer_id": 41233543, "question_id": 41132541, "link": "https://stackoverflow.com/questions/41132541/obtain-the-absolute-path-to-the-workbook-from-an-xls-file/41233543#41233543", "title": "Obtain the &quot;absolute path to the workbook&quot; from an .xls file", "body": "<p>I can reproduced that warning message by simply creating an empty Excel file, added a formula, saved it as BIFF8 (.xls). The Document Inspector will then warn about the absolute path. ... but in my case, there was no filename inside the file.</p>\n\n<p>A simple way to verify this, is to open the file in a hex-editor and search for a well-known save location (i.e. the location where a dummy/test file was stored)  - this is either stored as ASCII or as 16-bit string, i.e. every odd byte is a character.</p>\n\n<p>If you want to use the POI developer tools, you can use the following:</p>\n\n<p>To list all Excel records:<br>\n<code>java -cp poi-3.16-beta1.jar org.apache.poi.hssf.dev.BiffViewer file.xls</code></p>\n\n<p>To list the document and summary properties:<br>\n<code>java -cp poi-3.16-beta1.jar org.apache.poi.hpsf.extractor.HPSFPropertiesExtractor file.xls</code></p>\n\n<p>To list any embedded objects beside the usual suspects <code>SummaryInformation</code>, <code>DocumentSummaryInformation</code> and <code>Workbook</code>:<br>\n<code>java -cp poi-3.16-beta1.jar org.apache.poi.poifs.dev.POIFSLister file.xls</code></p>\n\n<p>So after running the tools and recording the output, you can then remove the properties via the Excel Document Inspector and execute the tools again. The output can be diffed and you might find the culprit.</p>\n"}], "owner": {"reputation": 22219, "user_id": 14663, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/611db642b9164a9425f953071a5939ff?s=128&d=identicon&r=PG", "display_name": "WW.", "link": "https://stackoverflow.com/users/14663/ww"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5444, "favorite_count": 1, "accepted_answer_id": 41233543, "answer_count": 2, "score": 14, "last_activity_date": 1530111158, "creation_date": 1481672924, "last_edit_date": 1530111158, "question_id": 41132541, "link": "https://stackoverflow.com/questions/41132541/obtain-the-absolute-path-to-the-workbook-from-an-xls-file", "title": "Obtain the &quot;absolute path to the workbook&quot; from an .xls file", "body": "<p>When I use the Excel \"Document Inspector\" on a particular .xls file to check for \"hidden properties or personal information\" it says:</p>\n\n<blockquote>\n  <p>The following document information was found:<br>\n  * Absolute path to the workbook</p>\n</blockquote>\n\n<p>How can I obtain the absolute path of the workbook from the file?  If it needs to be done programmatically, I could use Java (e.g. Apache POI) or VBA.</p>\n\n<p>I know where the file is currently saved, but what I want to extract is the absolute path to the workbook which is saved in the file I have.  This is so I can know where it was saved by the author.</p>\n\n<p>Here's what has happened to the file:</p>\n\n<ol>\n<li>Someone authored it, saving it at some absolute filepath unknown to me</li>\n<li>They uploaded it to a website</li>\n<li>I downloaded it from the website</li>\n</ol>\n\n<p>Excel indicates that the document contains the absolute path from step 1.  I'm after this path, not the place I saved it at step 3 since I know that.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1481672885, "post_id": 41132467, "comment_id": 69469185, "body": "This isn&#39;t a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. At the very least it would help if you give an example of a string <code>varItem.innerhtml</code> that is &quot;getting cut off&quot; together with the intended value of <code>strDCStatus</code> after that statement is executed."}, {"owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "edited": false, "score": 0, "creation_date": 1481672996, "post_id": 41132467, "comment_id": 69469221, "body": "If I&#39;m not mistaken string length is limited to 255 chars but there are ways around.  Just search SO."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "edited": false, "score": 0, "creation_date": 1481673077, "post_id": 41132467, "comment_id": 69469238, "body": "@mrbungle If you are referring to VBA strings, you are mistaken. Typing <code>?len(string(10^6,&quot;*&quot;))</code> in the immediate window instantly prints <code>1000000</code> rather than throwing an error."}, {"owner": {"reputation": 7037, "user_id": 2628921, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/510986610/picture?type=large", "display_name": "SBB", "link": "https://stackoverflow.com/users/2628921/sbb"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1481673245, "post_id": 41132467, "comment_id": 69469283, "body": "@JohnColeman Updated with a snippet of code its looking through."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1481673937, "post_id": 41132467, "comment_id": 69469475, "body": "<code>Split</code> is case sensitive and <code>&lt;td&gt;</code> isn&#39;t <code>&lt;TD&gt;</code>"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1481675311, "post_id": 41132467, "comment_id": 69469888, "body": "How are you checking the value of <code>varItem.innerhtml</code>? What you are seeing might be an artifact of your checking. What happens if you insert the line <code>Debug.Print Len(varItem.innerhtml)</code>?"}, {"owner": {"reputation": 7037, "user_id": 2628921, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/510986610/picture?type=large", "display_name": "SBB", "link": "https://stackoverflow.com/users/2628921/sbb"}, "edited": false, "score": 0, "creation_date": 1481675362, "post_id": 41132467, "comment_id": 69469899, "body": "I added the var to my watch list and then copied the value from there into notepad and saw it cutoff."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1481675428, "post_id": 41132467, "comment_id": 69469921, "body": "The debugging tool will only show you a part of a long string (perhaps even ending with <code>...</code>)."}, {"owner": {"reputation": 7037, "user_id": 2628921, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/510986610/picture?type=large", "display_name": "SBB", "link": "https://stackoverflow.com/users/2628921/sbb"}, "edited": false, "score": 0, "creation_date": 1481675516, "post_id": 41132467, "comment_id": 69469942, "body": "Good to know, the ellipses don&#39;t show up but surprisingly, the case sensitivity you mentioned fixed my issue. There was nothing wrong with the code, the HTML tags case just changed on the source page which caused this whole mess. Thanks you for the mini-lesson :)"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1481675874, "post_id": 41132467, "comment_id": 69470045, "body": "I added it as an answer just in case someone else gets misled by the watches window and searches for a solution."}], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 6, "last_activity_date": 1481675783, "creation_date": 1481675783, "answer_id": 41132934, "question_id": 41132467, "link": "https://stackoverflow.com/questions/41132467/vba-cutting-off-string/41132934#41132934", "title": "VBA Cutting off String?", "body": "<p>The <code>Watches</code> window only shows a portion of a long string (although, unlike the <code>Locals</code> window, it doesn't indicate this with a terminating <code>...</code>).</p>\n\n<p>For example, when I put a watch on the variable <code>t</code> in:</p>\n\n<pre><code>Sub test()\n    Dim s As String, t As String\n    Dim i As Long\n    For i = 0 To 9\n        s = s &amp; String(50, CStr(i))\n    Next i\n    t = s\nEnd Sub\n</code></pre>\n\n<p>and then copy-paste the value into notepad I see:</p>\n\n<pre><code>\"0000000000000000000000000000000000000000000000000011111111111111111111111111111111111111111111111111222222222222222222222222222222222222222222222222223333333333333333333333333333333333333333333333333344444444444444444444444444444444444444444444444444\n</code></pre>\n\n<p>even though the string is clearly much longer.</p>\n\n<p>The real bug in the code itself is likely due to the case-sensitivity of strings in <code>Split</code> and the resulting fact that the delimiter <code>&lt;td&gt;</code> differs from the delimiter <code>&lt;TD&gt;</code></p>\n"}], "owner": {"reputation": 7037, "user_id": 2628921, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/510986610/picture?type=large", "display_name": "SBB", "link": "https://stackoverflow.com/users/2628921/sbb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1121, "favorite_count": 0, "accepted_answer_id": 41132934, "answer_count": 1, "score": 1, "last_activity_date": 1481675783, "creation_date": 1481672455, "last_edit_date": 1481673220, "question_id": 41132467, "link": "https://stackoverflow.com/questions/41132467/vba-cutting-off-string", "title": "VBA Cutting off String?", "body": "<p>I openly admit I know nothing about vba..</p>\n\n<p>I am working on a legacy tool for a project and its written in VBA. There is a bug I am working on and I have narrowed down the issue but unable to figure out why my string is apparently being cutoff?</p>\n\n<pre><code> strXPlusLast4 = \"xxxxxxxxxxxx\" &amp; strDCLast4\n    For Each varItem In objIE.Document.getElementsByTagName(\"tr\")\n        If InStr(varItem.innerhtml, strXPlusLast4) Then\n            strDCStatus = Replace(Split(Split(varItem.innerhtml, \"&lt;TD&gt;\")(3), \"&lt;/TD&gt;\")(0), \"&amp;nbsp;\", \"\")\n</code></pre>\n\n<p>Using an IE object to navigate to a page, it is looking through the all of the <code>tr</code>. Within the <code>tr</code>'s that it finds, it is looking to see if a string exists.</p>\n\n<p>If it finds this string, it goes into the <code>IF statement</code> which is where I am stuck.</p>\n\n<p>Once here, I check the value of the <code>varitem.innerHTML</code> and it is getting cutoff around 250 characters, right in the middle of the actual row data. </p>\n\n<p>I am trying to just find out if there is any limitation as to why the value of <code>innerHTML</code> is not the full <code>HTML</code> content I expect to see that I am looking at on the web page it is scraping.</p>\n\n<p>This data is also cutoff when I add <code>varItem</code> to my watches and look at the <code>innerHTML</code> of the object. </p>\n\n<p>Can anyone shed any light on the little bit of code I am able to post around this issue? My root problem is that I am not getting the <code>strDCStatus</code> I would expect because it is not searching the full row of data as something is getting cutoff.</p>\n\n<p><strong>Update</strong></p>\n\n<p>Here is the best I can provide for the <code>TR</code> that this is looking within:</p>\n\n<pre><code>&lt;tr class=\"\"&gt;\n  &lt;td&gt;\n    &amp;nbsp;\n  &lt;/td&gt;\n  &lt;td&gt;2 Blah Blah &amp;nbsp;&lt;/td&gt;\n  &lt;td class=\"AccountNumber\"&gt;\n    xxxxxxxxxxxx1234 &amp;nbsp;&amp;nbsp;\n    &lt;a href=\"#\" onclick=\"view(this, event,'12345', '45678');return false\" class=\"\"&gt;&lt;img src=\"https://MySite\" title=\"Click to Expand\" alt=\"!\"&gt;&lt;/a&gt;\n    &amp;nbsp;\n  &lt;/td&gt;\n  &lt;td&gt;Closed&amp;nbsp;&lt;/td&gt;\n  &lt;td&gt;Jan 1, 2011&amp;nbsp;&lt;/td&gt;\n  &lt;td&gt;Nov 30, 2011&amp;nbsp;&lt;/td&gt;\n  &lt;td&gt;N/A&amp;nbsp;&lt;/td&gt;\n  &lt;td&gt;\n    xx/xxxx &amp;nbsp;&amp;nbsp;\n    &lt;a href=\"#\" onclick=\"view(this, event,'12345', '56789'); return false;\" class=\"\"&gt;&lt;img src=\"https://MySite\" title=\"Click to Expand\"&gt;&lt;/a&gt;\n    &amp;nbsp;\n  &lt;/td&gt;\n&lt;/tr&gt;\n</code></pre>\n\n<p>It is using the <code>innerHTML</code> so everything between the <code>&lt;tr&gt;</code> tags. it is getting cut off around the <code>onClick</code> HTML data.</p>\n\n<p>The status I will eventually try and get is \"Closed\" in the 4th <code>td</code> but I haven't been able to attempt that since I don't appear to have a full row html to look through. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1481672304, "post_id": 41132359, "comment_id": 69469029, "body": "Why do you have <code>Settings.Range(&quot;b2&quot;) = civa.Value</code>?  What is <code>civa.Value</code> before you have even opened the form?  I&#39;m assuming that <code>civa</code> is some sort of control in <code>frmAdmin</code>.  Perhaps that line should be reversed?"}, {"owner": {"reputation": 1, "user_id": 2525062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc2509132d09d68e49d74ba5ae7ca8c?s=128&d=identicon&r=PG", "display_name": "user2525062", "link": "https://stackoverflow.com/users/2525062/user2525062"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1481672890, "post_id": 41132359, "comment_id": 69469186, "body": "Thanks @OpiesDad that was reversed and i made it Sheets(&quot;Settings&quot;) and it appeared to fix the issue."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 1, "creation_date": 1481677274, "post_id": 41132359, "comment_id": 69470380, "body": "<code>ActiveWorkbook.Save</code> doesn&#39;t take any parameters.  You should remove <code>SaveChanges:=True</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1481678469, "post_id": 41132359, "comment_id": 69470699, "body": "@OpiesDad either you or the OP should post an answer ao that the OP can close the question."}], "answers": [{"tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": false, "score": 0, "last_activity_date": 1481739677, "creation_date": 1481739677, "answer_id": 41149466, "question_id": 41132359, "link": "https://stackoverflow.com/questions/41132359/run-time-424-error-opening-userform-from-commandbox-click/41149466#41149466", "title": "run-time 424 error opening userform from commandbox_click", "body": "<p><code>Settings.Range(\"b2\") = civa.Value</code> doesn't make sense in the <code>UserForm_Initialize()</code> event.  </p>\n\n<p>As <code>civa</code> is a control on the form, it doesn't have a value yet, so you can't use it to assign a value to a cell in your sheet.</p>\n\n<p>Instead, I think you meant <code>civa.Value = Settings.Range(\"b2\")</code></p>\n"}], "owner": {"reputation": 1, "user_id": 2525062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc2509132d09d68e49d74ba5ae7ca8c?s=128&d=identicon&r=PG", "display_name": "user2525062", "link": "https://stackoverflow.com/users/2525062/user2525062"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481739677, "creation_date": 1481671814, "question_id": 41132359, "link": "https://stackoverflow.com/questions/41132359/run-time-424-error-opening-userform-from-commandbox-click", "title": "run-time 424 error opening userform from commandbox_click", "body": "<p>I've been searching and can't find what the cause of my error is. \nI'm creating a VBA application in Excel to assist in processing financial reports. I have the basic functionality complete and am trying to build an Admin function to allow end users to log in and change the multiplier in the equation. \nI have 2 userforms, frmLogin and frmAdmin. </p>\n\n<p>frmLogin - is very basic, however when it tries to do frmAdmin.Show i get the run-time 424 error. </p>\n\n<p>frmLogin</p>\n\n<pre><code>Private Sub LoginButton_Click()\nIf Me.txtUsername.Value = \"Admin\" Then\n    If Me.txtPassword.Value = \"password\" Then\n        Unload Me\n        frmAdmin.Show\n        Exit Sub\n    Else\n    MsgBox \"Sorry, Incorrect Login Details\"\n    Me.txtUsername.SetFocus\n    End If\nElse\nMsgBox \"Sorry, Incorrect Login Details\"\nMe.txtUsername.SetFocus\nEnd If\nEnd Sub\n</code></pre>\n\n<p>frmAdmin</p>\n\n<pre><code>Private Sub Save_Click()\nWorkbook_Refresh\nSaveBackup\nSaveSettings\nCloseForm\nEnd Sub\n\nPrivate Sub Update_Click()\nciva.Value = Sheets(\"Settings\").Range(\"b1\")\noral.Value = Sheets(\"Settings\").Range(\"b2\")\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\nSettings.Range(\"b2\") = civa.Value\nSettings.Range(\"b3\") = oral.Value\nEnd Sub\n\nPrivate Sub SaveSettings()\nActiveWorkbook.Save SaveChanges:=True\nEnd Sub\n\nPrivate Sub CloseForm()\nApplication.Goto Worksheets(\"Home Screen\").Range(\"D4\")\nUnload Me\nEnd Sub\n</code></pre>\n\n<p>WorkbookRefresh is called from Module1. </p>\n\n<p>Any help will be greatly appreciated. </p>\n\n<p>Steven</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1481671839, "post_id": 41132329, "comment_id": 69468889, "body": "<code>A = R.Value</code> where <code>A</code> is a variant and <code>R</code> is the target range is all you need (assuming that <code>R</code> is a rectangular range)."}, {"owner": {"reputation": 77, "user_id": 7293581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afcc9198cc2434d3597f2a0ac7aca851?s=128&d=identicon&r=PG&f=1", "display_name": "Yszty", "link": "https://stackoverflow.com/users/7293581/yszty"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1481672149, "post_id": 41132329, "comment_id": 69468982, "body": "I dont know target range, its depend what was selected by user."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1481672284, "post_id": 41132329, "comment_id": 69469021, "body": "<code>Selection</code> is the range that the user has selected (unless you are getting input from the user in some other way). You need to show your code and explain your  problem -- as it is your question is very unclear."}, {"owner": {"reputation": 1444, "user_id": 2696497, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d01be1a281ffad5a8dd64a70d1013ef?s=128&d=identicon&r=PG&f=1", "display_name": "ryansin", "link": "https://stackoverflow.com/users/2696497/ryansin"}, "edited": false, "score": 0, "creation_date": 1481672298, "post_id": 41132329, "comment_id": 69469026, "body": "Would Selection.Value work then?"}], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1481681686, "post_id": 41133502, "comment_id": 69471498, "body": "if a single row of cells is selected, <code>Selection.Value</code> still returns a 2D array,  size (1 to 1, 1 to n)"}, {"owner": {"reputation": 587, "user_id": 2089396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QENPW.png?s=128&g=1", "display_name": "Albin", "link": "https://stackoverflow.com/users/2089396/albin"}, "edited": false, "score": 0, "creation_date": 1544644626, "post_id": 41133502, "comment_id": 94353608, "body": "is there a reason why the first <code>Debug.Print Selection.Address(0, 0)</code> is there? in my view the second one (<code>Debug.Print area.Address(0, 0)</code>) will catch all &quot;selections/areas&quot;."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 587, "user_id": 2089396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QENPW.png?s=128&g=1", "display_name": "Albin", "link": "https://stackoverflow.com/users/2089396/albin"}, "edited": false, "score": 0, "creation_date": 1544648146, "post_id": 41133502, "comment_id": 94355089, "body": "@Albin the first one shows the address of the whole selection, and second one shows how to loop the rectangular areas, as non-contiguous range can&#39;t be put in array directly"}, {"owner": {"reputation": 587, "user_id": 2089396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QENPW.png?s=128&g=1", "display_name": "Albin", "link": "https://stackoverflow.com/users/2089396/albin"}, "edited": false, "score": 0, "creation_date": 1544656960, "post_id": 41133502, "comment_id": 94358602, "body": "but still, essentially the both show the same data, right? Only that <code>selection.</code> shows the selected ranges &quot;all at once&quot; and <code>area.</code> shows each range &quot;individually&quot;."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 587, "user_id": 2089396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QENPW.png?s=128&g=1", "display_name": "Albin", "link": "https://stackoverflow.com/users/2089396/albin"}, "edited": false, "score": 0, "creation_date": 1544689574, "post_id": 41133502, "comment_id": 94367512, "body": "@Albin yes, exactly"}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": true, "score": 1, "last_activity_date": 1506014522, "last_edit_date": 1506014522, "creation_date": 1481680013, "answer_id": 41133502, "question_id": 41132329, "link": "https://stackoverflow.com/questions/41132329/vba-how-to-get-values-from-selected-cells/41133502#41133502", "title": "VBA How to get values from selected cells", "body": "<p><code>Application.Selection</code> is not always <code>Range</code> (for example if Shape(s) or ActiveX Control(s) are selected), and <code>Selection.Value</code> returns different things depending on what is selected:</p>\n\n<ul>\n<li>cell value if only one cell is selected</li>\n<li>2D Variant array of cell values if more than one cell is selected</li>\n<li>error if the object(s) selected don't have a <code>.Value</code> property</li>\n</ul>\n\n<p>If more than one area is selected, <code>.Value</code> returns the value(s) only of the first area.</p>\n\n<hr>\n\n<pre><code>If TypeOf Selection Is Excel.Range Then\n    Debug.Print Selection.Address(0, 0)\n\n    For Each area In Selection.Areas\n        Debug.Print area.Address(0, 0)\n    Next\nElse\n    Debug.Print TypeName(Selection)\nEnd If\n</code></pre>\n\n<p>The <a href=\"https://stackoverflow.com/questions/16066878/how-to-list-properties-of-a-chart-object-in-vba\">Locals</a> window can make it easier to see the contents of the <code>Application.Selection</code></p>\n"}, {"tags": [], "owner": {"reputation": 233, "user_id": 924439, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2086280e6525a2da419311361e567850?s=128&d=identicon&r=PG", "display_name": "Navin", "link": "https://stackoverflow.com/users/924439/navin"}, "is_accepted": false, "score": 0, "last_activity_date": 1516344126, "creation_date": 1516344126, "answer_id": 48335484, "question_id": 41132329, "link": "https://stackoverflow.com/questions/41132329/vba-how-to-get-values-from-selected-cells/48335484#48335484", "title": "VBA How to get values from selected cells", "body": "<p>You don't have to use <code>OneCell.Value</code> as the cell itself holds the value.\nIf you want to get the cells formula then use <code>OneCell.FormulaR1C1</code>.</p>\n\n<pre><code>    For Each OneCell In Selection\n        MsgBox (OneCell)\n    Next OneCell\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 7293581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afcc9198cc2434d3597f2a0ac7aca851?s=128&d=identicon&r=PG&f=1", "display_name": "Yszty", "link": "https://stackoverflow.com/users/7293581/yszty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35715, "favorite_count": 0, "accepted_answer_id": 41133502, "answer_count": 2, "score": 0, "last_activity_date": 1516344126, "creation_date": 1481671655, "last_edit_date": 1531164843, "question_id": 41132329, "link": "https://stackoverflow.com/questions/41132329/vba-how-to-get-values-from-selected-cells", "title": "VBA How to get values from selected cells", "body": "<p>I need put data from selected cells to array. How to do it? I cant find any example. I know how to get value from one cell by <code>ActiveCell.Value</code> but how its work with multiple selection. Guess I should selected range put to variable as object and process it by foreach loop. Can anyone write example for it?</p>\n\n<p>Solution: </p>\n\n<pre><code>Sub Button1_Click()\n\nFor Each OneCell In Selection\n MsgBox (OneCell.Value)\nNext\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-office"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 1775308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fefed4b9db8e3cdae96a02a24affef20?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/1775308/eric"}, "edited": false, "score": 0, "creation_date": 1481918234, "post_id": 41142722, "comment_id": 69582984, "body": "I was afraid of that. Thanks!"}], "tags": [], "owner": {"reputation": 140, "user_id": 3828905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JzFtQ.jpg?s=128&g=1", "display_name": "Roie R", "link": "https://stackoverflow.com/users/3828905/roie-r"}, "is_accepted": false, "score": 2, "last_activity_date": 1481718602, "creation_date": 1481718602, "answer_id": 41142722, "question_id": 41131982, "link": "https://stackoverflow.com/questions/41131982/show-files-only-not-folders-in-a-office-filedialog-window/41142722#41142722", "title": "Show files only (not folders) in a Office.FileDialog window?", "body": "<p>As filtering applies only to files, and there's nothing of the kind in <code>fileDialogType</code> - I don't think what you're asking for is possible in VBA.</p>\n"}, {"tags": [], "owner": {"reputation": 98, "user_id": 3230453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/COYUq.jpg?s=128&g=1", "display_name": "Ricky", "link": "https://stackoverflow.com/users/3230453/ricky"}, "is_accepted": false, "score": 0, "last_activity_date": 1481749923, "last_edit_date": 1481749923, "creation_date": 1481748466, "answer_id": 41151875, "question_id": 41131982, "link": "https://stackoverflow.com/questions/41131982/show-files-only-not-folders-in-a-office-filedialog-window/41151875#41151875", "title": "Show files only (not folders) in a Office.FileDialog window?", "body": "<p>This will show only .pdf Files in the FileDialog. Just Add the specific path to the folder you want to open the FileDialog to in the quotations after ChDir \"YourFile_Path\".</p>\n\n<pre><code>Dim myFile As String\nChDir \"C:\\Users\\Documents\"\nmyFile = Application.GetOpenFilename(Title:=\"Import pdf File\", FileFilter:=\"Pdf Files *.pdf (*.pdf),\")\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 1775308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fefed4b9db8e3cdae96a02a24affef20?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/1775308/eric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1481749923, "creation_date": 1481669703, "last_edit_date": 1481672561, "question_id": 41131982, "link": "https://stackoverflow.com/questions/41131982/show-files-only-not-folders-in-a-office-filedialog-window", "title": "Show files only (not folders) in a Office.FileDialog window?", "body": "<p>I have a procedure using the <code>Office.FileDialog</code> object that goes to a remote folder, sets a <code>FileDialog.Filter</code> to search for a specific file in that folder (i.e., <code>.Filter = \"\\\\PATH\\MYFILE*.pdf\"</code>), and then uses <code>FileDialog.Show</code> to display a window containing only that target file. When the window is displayed, it contains not only my target file but also all of the sub-folders in the target folder. How can I display only the files, and not the sub-folders?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1481669737, "post_id": 41131935, "comment_id": 69468214, "body": "It looks like you are looking for a vba solution - do you have any code already?"}], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1481673157, "post_id": 41132118, "comment_id": 69469261, "body": "Don&#39;t post additional info as an answer, edit it into your <i>question</i>"}], "tags": [], "owner": {"reputation": 739, "user_id": 7262393, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/10209827239390452/picture?type=large", "display_name": "Dan", "link": "https://stackoverflow.com/users/7262393/dan"}, "is_accepted": false, "score": 0, "last_activity_date": 1481675125, "last_edit_date": 1481675125, "creation_date": 1481670450, "answer_id": 41132118, "question_id": 41131935, "link": "https://stackoverflow.com/questions/41131935/vba-range-pairwise-division/41132118#41132118", "title": "Vba range pairwise division", "body": "<p>I only have a do loop to count the number of cells in the range.  This gives the number of columns that is contained in the range.  What I do not know how to do is then take and store a double of whatever division may come from all the pairwise divisions.  So if it were 2 rows there would be two answers, 3 rows and there would be 6, 4 and there would be 12...i think the function will be n(n-1) now that i think about it.</p>\n\n<pre><code>Option Explicit\n\nSub Bold()\n\nDim i, j As Integer\ni = 2  'Row\nj = 3  'Column\n\n\nDo\n    If Cells(i,j).Value &lt;&gt;\"\" Then\n        i = i + 1\n    End If\n\nLoop Until Cells(i, j).Value = \"\"\ni = i - 1\n</code></pre>\n\n<p>I figure it would be some sort of nested loop but I'm not quite sure where to start with the function on the number of rows.</p>\n"}], "owner": {"reputation": 739, "user_id": 7262393, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/10209827239390452/picture?type=large", "display_name": "Dan", "link": "https://stackoverflow.com/users/7262393/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481675125, "creation_date": 1481669433, "last_edit_date": 1481671222, "question_id": 41131935, "link": "https://stackoverflow.com/questions/41131935/vba-range-pairwise-division", "title": "Vba range pairwise division", "body": "<p>I have a set of variable ranges and I want to do pairwise division of each of the members of each range and bold the member or two highest members if there is a difference of 3/1</p>\n\n<p>Example 1</p>\n\n<pre><code>Column A.   Ferrets.  Rabbits. Foxes.            \nColumn B. 3000 1000 4000\n</code></pre>\n\n<p>Because Ferrets and Foxes are in greater than 3/1 proportion to rabbits bold them</p>\n\n<p>Example 2</p>\n\n<pre><code>Column A. Ferrets. Rabbits. Foxes.            \nColumn B 1000 1000 4000\n</code></pre>\n\n<p>Because foxes are in greater than 3/1 proportion to ferrets and rabbits bold them</p>\n\n<p>Example 3</p>\n\n<pre><code>Column A.  Ferrets.  Rabbits. Foxes.            \nColumn B. 3000 3500 4000\n</code></pre>\n\n<p>Bold nothing</p>\n\n<p>I can get the logic to bold but im not quite sure where to begin to get excel to loop through all the possible divisions.  Note the range will vary with the number of rows.  Sometimes up to 5 and 6 or maybe more which is why im having the problem.</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481670933, "post_id": 41131717, "comment_id": 69468613, "body": "&quot;...doesn&#39;t work&quot; - how so? Do you get an error? Does it not do the position you want, does it just skip that line entirely?  Also, how do you declare <code>a</code> and <code>b</code>?"}, {"owner": {"reputation": 49, "user_id": 4484489, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0ea596529bdef28b2ea628fc5bd9725d?s=128&d=identicon&r=PG", "display_name": "user209396", "link": "https://stackoverflow.com/users/4484489/user209396"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481671123, "post_id": 41131717, "comment_id": 69468669, "body": "I get the following error &quot; application defined or object defined error&quot; ; a and b were just used here in the question as a reference, in my code the positions have been hard coded"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481671758, "post_id": 41131717, "comment_id": 69468858, "body": "I assume you get that error at the second line?  Is <code>objWord.Selection.Rows</code> a valid use in Word VBA? (I&#39;m not too familiar with Word VBA, so am just making sure) and not perhaps something like <code>objWord.Selection.Table</code>?"}, {"owner": {"reputation": 49, "user_id": 4484489, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0ea596529bdef28b2ea628fc5bd9725d?s=128&d=identicon&r=PG", "display_name": "user209396", "link": "https://stackoverflow.com/users/4484489/user209396"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481672318, "post_id": 41131717, "comment_id": 69469038, "body": "The intellisense tool built into VBA doesn&#39;t show an error with selection.rows; but does with the latter"}, {"owner": {"reputation": 49, "user_id": 4484489, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0ea596529bdef28b2ea628fc5bd9725d?s=128&d=identicon&r=PG", "display_name": "user209396", "link": "https://stackoverflow.com/users/4484489/user209396"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481672377, "post_id": 41131717, "comment_id": 69469051, "body": "I tried using . Paragraph Format instead but that doesn&#39;t really have a method for the coordinates :/"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481673915, "post_id": 41131717, "comment_id": 69469468, "body": "Can you perhaps post a screenshot of where in a document you&#39;re trying to insert the data? It&#39;s not clear from your description - you&#39;re inserting it into a table, within a table?"}, {"owner": {"reputation": 49, "user_id": 4484489, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0ea596529bdef28b2ea628fc5bd9725d?s=128&d=identicon&r=PG", "display_name": "user209396", "link": "https://stackoverflow.com/users/4484489/user209396"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481674372, "post_id": 41131717, "comment_id": 69469612, "body": "I am essentially inserting the value in an excel cell into a word document; not into a table in the word document"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481674890, "post_id": 41131717, "comment_id": 69469774, "body": "Oh ...then what&#39;s the Rows doing? Is that to determine where <i>exactly</i> in the document the data is to go? Can you please post the rest of your code?  What tables are you referring to? Ones in Word or Excel? Please add more detail to your OP for clarity."}], "owner": {"reputation": 49, "user_id": 4484489, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0ea596529bdef28b2ea628fc5bd9725d?s=128&d=identicon&r=PG", "display_name": "user209396", "link": "https://stackoverflow.com/users/4484489/user209396"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 332, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1495416503, "creation_date": 1481668422, "last_edit_date": 1495416503, "question_id": 41131717, "link": "https://stackoverflow.com/questions/41131717/insert-a-text-value-from-excel-cell-at-a-specific-location-in-the-word-document", "title": "Insert a text value from Excel cell at a specific location in the Word document in VBA", "body": "<p>I currently have a variable say x which stores a cell value from Excel and I am trying to place x at (a,b) in the Word document. </p>\n\n<p>I have used:</p>\n\n<pre><code>With objword.Selection\n   .Rows.HorizontalPosition=a\n   .Rows.VerticalPosition=b\n   .TypeText(x)\nEnd With\n</code></pre>\n\n<p>But this doesn't work - I get this error:</p>\n\n<blockquote>\n  <p>Application defined or object defined error</p>\n</blockquote>\n\n<p>I have a table that is at a different position on the table and they shouldn't be overlapping, but could this be the issue?  I tried using <code>.ParagraphFormat</code> instead but that doesn't really have a method for the coordinates </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1481668757, "post_id": 41131634, "comment_id": 69467881, "body": "Do you have any code we can take a look at?"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1481669538, "post_id": 41131634, "comment_id": 69468134, "body": "You are struggling so we should write the code for you or you are struggling and are stuck with a specific line of code error and want us to debug?  The first is going to get your question closed, the later requires you to post code."}, {"owner": {"reputation": 3, "user_id": 7293445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fbb1d0ca863b04dc9cfec397e390f22?s=128&d=identicon&r=PG&f=1", "display_name": "anu", "link": "https://stackoverflow.com/users/7293445/anu"}, "edited": false, "score": 0, "creation_date": 1481731149, "post_id": 41131634, "comment_id": 69496154, "body": "I have added the code which I have been able to write so far. Also attached is the image of the survey responses excel."}, {"owner": {"reputation": 3, "user_id": 7293445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fbb1d0ca863b04dc9cfec397e390f22?s=128&d=identicon&r=PG&f=1", "display_name": "anu", "link": "https://stackoverflow.com/users/7293445/anu"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1481922198, "post_id": 41131634, "comment_id": 69584566, "body": "@Chrismas007: Can you help now?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7293445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fbb1d0ca863b04dc9cfec397e390f22?s=128&d=identicon&r=PG&f=1", "display_name": "anu", "link": "https://stackoverflow.com/users/7293445/anu"}, "edited": false, "score": 0, "creation_date": 1481731300, "post_id": 41132181, "comment_id": 69496247, "body": "I have added the code above, can you please look into that and let me know what is the issue."}, {"owner": {"reputation": 3, "user_id": 7293445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fbb1d0ca863b04dc9cfec397e390f22?s=128&d=identicon&r=PG&f=1", "display_name": "anu", "link": "https://stackoverflow.com/users/7293445/anu"}, "edited": false, "score": 0, "creation_date": 1481924614, "post_id": 41132181, "comment_id": 69585470, "body": "I am getting an error Object Required 424 on the last line rng.Copy.Range(&quot;A&quot; &amp; lastrow).PasteSpecial xlPasteValues"}, {"owner": {"reputation": 3, "user_id": 7293445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fbb1d0ca863b04dc9cfec397e390f22?s=128&d=identicon&r=PG&f=1", "display_name": "anu", "link": "https://stackoverflow.com/users/7293445/anu"}, "edited": false, "score": 0, "creation_date": 1481925270, "post_id": 41132181, "comment_id": 69585658, "body": "I was able work with the code you shared. Many thanks. The only problem is that the rows are copied in reverse order in Master excel. the row at position 1 is being copied at the last and the row at last in the Survey excel is being copied as first row in Master. Can you tell what&#39;s happening. I have added my updated code above."}, {"owner": {"reputation": 2342, "user_id": 6283475, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/s6Dic.jpg?s=128&g=1", "display_name": "KyloRen", "link": "https://stackoverflow.com/users/6283475/kyloren"}, "reply_to_user": {"reputation": 3, "user_id": 7293445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fbb1d0ca863b04dc9cfec397e390f22?s=128&d=identicon&r=PG&f=1", "display_name": "anu", "link": "https://stackoverflow.com/users/7293445/anu"}, "edited": false, "score": 0, "creation_date": 1481932285, "post_id": 41132181, "comment_id": 69587716, "body": "Please mark the answer solved by clicking the &#39;Tick&#39; below the arrows. And if that is the case just loop through it backwards as the rows are added in order of the loop."}, {"owner": {"reputation": 3, "user_id": 7293445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fbb1d0ca863b04dc9cfec397e390f22?s=128&d=identicon&r=PG&f=1", "display_name": "anu", "link": "https://stackoverflow.com/users/7293445/anu"}, "edited": false, "score": 0, "creation_date": 1482122625, "post_id": 41132181, "comment_id": 69630495, "body": "I did that and the only problem left is that the rows in the master excel are written from the second row. The code leaves the first row as blank."}, {"owner": {"reputation": 2342, "user_id": 6283475, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/s6Dic.jpg?s=128&g=1", "display_name": "KyloRen", "link": "https://stackoverflow.com/users/6283475/kyloren"}, "reply_to_user": {"reputation": 3, "user_id": 7293445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fbb1d0ca863b04dc9cfec397e390f22?s=128&d=identicon&r=PG&f=1", "display_name": "anu", "link": "https://stackoverflow.com/users/7293445/anu"}, "edited": false, "score": 0, "creation_date": 1482125353, "post_id": 41132181, "comment_id": 69631169, "body": "@Do you need the code to copy side by side cells? (not one cell but two)"}], "tags": [], "owner": {"reputation": 2342, "user_id": 6283475, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/s6Dic.jpg?s=128&g=1", "display_name": "KyloRen", "link": "https://stackoverflow.com/users/6283475/kyloren"}, "is_accepted": true, "score": 0, "last_activity_date": 1481671808, "last_edit_date": 1481671808, "creation_date": 1481670819, "answer_id": 41132181, "question_id": 41131634, "link": "https://stackoverflow.com/questions/41131634/compare-and-copy-from-one-spreadsheet-to-another/41132181#41132181", "title": "Compare and Copy from one spreadsheet to another", "body": "<p>This is untested code but it should help you with anything you already have. You will need to adjust the ranges to suit yourself, but it will loop through one sheet and collect values that dont exists and then copy them to another sheet.</p>\n\n<p>Try this,</p>\n\n<pre><code>Sub dave()\nDim cel As Range\nDim rng As Range\nDim r As Range\nDim lastrow As Long\n\n\n    With Sheets(\"Master\")\n     lastrow = .Cells(.Rows.Count, 1).End(xlUp).Row\n        For Each cel In Sheets(\"Sheet1\").Range(\"D1:D22\")\n            Set r = .Range(\"D:D\").Find(What:=cel, LookIn:=xlFormulas, _\n        LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n        MatchCase:=False, SearchFormat:=False)\n            If r Is Nothing Then\n                If Not rng Is Nothing Then Set rng = Union(rng, cel) Else Set rng = cel\n            End If\n        Next cel\n        rng.Copy\n        .Range(\"A\" &amp; lastrow).PasteSpecial xlPasteValues\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7293445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fbb1d0ca863b04dc9cfec397e390f22?s=128&d=identicon&r=PG&f=1", "display_name": "anu", "link": "https://stackoverflow.com/users/7293445/anu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 41132181, "answer_count": 1, "score": 0, "last_activity_date": 1556414889, "creation_date": 1481668042, "last_edit_date": 1556414889, "question_id": 41131634, "link": "https://stackoverflow.com/questions/41131634/compare-and-copy-from-one-spreadsheet-to-another", "title": "Compare and Copy from one spreadsheet to another", "body": "<p>There are two Excel workbooks, Master and Survey Responses.</p>\n\n<p>I have to loop through each row in Survey Responses, to select the value from the 4th column and compare it to the 4th column in Master. If there is no match then copy the complete row from Survey Responses to the end of Master. For the first time there will be no rows in Master so all rows must be copied from  Survey Responses.</p>\n\n<p>Survey Responses<br>\n<img src=\"https://i.stack.imgur.com/9KuM4.png\" alt=\"Survey Responses Excel\"></p>\n\n<p>The below code does not loop through all rows and if I run it a second time it copies all rows without performing the comparison.</p>\n\n<pre><code>'''''Define Object for Target Workbook\nDim Target_Workbook As Workbook\nDim Source_Workbook As Workbook\nDim Source_Path As String\n\n\n'''''Assign the Workbook File Name along with its Path\nSource_Path = \"C:\\Users\\Survey Responses\\Survey Response.xls\"\n\nSet Source_Workbook = Workbooks.Open(Source_Path)\nSet Target_Workbook = ThisWorkbook\n\n\n'''''With Source_Workbook object now, it is possible to pull any data from it\n'''''Read Data from Source File\n\n\n'''''Logic to select unique rows only\nDim rngSource As Range, rngTarget As Range, cellSource As Range, cellTarget As Range\n\nSet rngSource = Source_Workbook.Sheets(1).Range(\"Responses\")\nSet rngTarget = Target_Workbook.Sheets(2).Range(\"Responses\")\n\nDim rowNr_target As Integer, Rng As Range\n\n\nWith Target_Workbook.Sheets(2)\n  rowNr_target = .Cells(.Rows.Count, \"A\").End(xlUp).Row\nEnd With\n\nDim counter As Integer, found As Boolean, inner_counter As Integer\ncounter = 1\n\nFor Each cellSource In rngSource.Rows\n 'On Error Resume Next\n\n    If cellSource.Cells(counter, 1).Value = \"\" Then\n      Exit For\n    End If\n\n    found = False\n\n    inner_counter = 1\n\n    For Each cellTarget In rngTarget.Rows\n\n        If cellTarget.Cells(inner_counter, 1).Value = \"\" Then\n          Exit For\n        End If\n\n        ''''test = Application.WorksheetFunction.VLookup(test1, rngTarget, 1, False)\n        If (cellSource.Cells(counter, 4) = cellTarget.Cells(inner_counter, 4)) Then\n            found = True\n            Exit For\n        End If\n\n        inner_counter = inner_counter + 1\n\n    Next\n\n    If (found = False) Then\n        cellSource.EntireRow.Copy\n\n        If (rowNr_target &gt; 1) Then\n            rngTarget.Rows(rowNr_target + 1).Insert\n        Else\n            rngTarget.Rows(rowNr_target).Insert\n        End If\n\n        rowNr_target = rowNr_target + 1\n    End If\n\n    counter = counter + 1\n 'On Error GoTo 0\n\nNext\n\n'''''Target_Workbook.Sheets(2).Range(\"Responses\").Value = Source_data\n\n\n'''''Close Target Workbook\nSource_Workbook.Save\nTarget_Workbook.Save\n''''Source_Workbook.Close False\n\n'''''Process Completed\nMsgBox \"Task Completed\"\n</code></pre>\n\n<hr>\n\n<p>Updated code:</p>\n\n<pre><code>Dim cel As Range\nDim rng As Range\nDim r As Range\nDim lastrow As Long\n\nDim Target_Workbook As Workbook\nDim Source_Workbook As Workbook\nDim Source_Path As String\n\n\n'''''Assign the Workbook File Name along with its Path\nSource_Path = \"C:\\Users\\Survey Responses\\Survey Response.xls\"\nSet Source_Workbook = Workbooks.Open(Source_Path)\nSet Target_Workbook = ThisWorkbook\n\nDim rngSource As Range, rngTarget As Range, cellSource As Range, cellTarget As Range\n\nSet rngSource = Source_Workbook.Sheets(1).Range(\"Responses\")\nSet rngTarget = Target_Workbook.Sheets(2).Range(\"Responses\")\n\n\n    With Target_Workbook.Sheets(2)\n     lastrow = .Cells(.Rows.Count, 1).End(xlUp).Row\n\n        For Each cel In Source_Workbook.Sheets(1).Range(\"D:D\")\n\n            If cel.Value = \"\" Then\n              Exit For\n            End If\n\n            Set r = .Range(\"D:D\").Find(What:=cel, LookIn:=xlFormulas, _\n            LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n            MatchCase:=False, SearchFormat:=False)\n\n            If r Is Nothing Then\n                cel.EntireRow.Copy\n                rngTarget.Rows(lastrow).Insert\n                ''If Not rng Is Nothing Then Set rng = Union(rng, cel) Else Set rng = cel\n            End If\n\n        Next cel\n\n        ''rng.Copy.Range(\"A\" &amp; lastrow).PasteSpecial xlPasteValues\n\n    End With\n\n'''''Close Target Workbook\nSource_Workbook.Save\nTarget_Workbook.Save\n''''Source_Workbook.Close False\n\n'''''Process Completed\nMsgBox \"Task Completed\"\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481669231, "post_id": 41131588, "comment_id": 69468033, "body": "What do you expect <code>AA</code>, <code>BB</code>, <code>CC</code>, to be? Sheet names? Those aren&#39;t declared so VBA is assuming they&#39;re some kind of variable I think..."}], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 6712951, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/76695526b789999adfdd389a09b50a29?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/6712951/martin"}, "edited": false, "score": 0, "creation_date": 1481668679, "post_id": 41131696, "comment_id": 69467848, "body": "I did it as you have suggested and now it highlights line 2. The line of your suggestion."}], "tags": [], "owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "is_accepted": false, "score": 0, "last_activity_date": 1481668289, "creation_date": 1481668289, "answer_id": 41131696, "question_id": 41131588, "link": "https://stackoverflow.com/questions/41131588/excel-vba-clearcontents-error/41131696#41131696", "title": "Excel VBA ClearContents error", "body": "<p>Use:</p>\n\n<pre><code>Snames = Split(\"AA\", \"BB\", \"CC\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 347, "user_id": 6712951, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/76695526b789999adfdd389a09b50a29?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/6712951/martin"}, "edited": false, "score": 0, "creation_date": 1481669911, "post_id": 41131884, "comment_id": 69468273, "body": "I&#39;m afraid macro is deleting only a bottom left cell in every sheet rather then deleting the whole table <a href=\"https://s29.postimg.org/anfea8nmf/image.png\" rel=\"nofollow noreferrer\">follow the link tot the image</a>"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 347, "user_id": 6712951, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/76695526b789999adfdd389a09b50a29?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/6712951/martin"}, "edited": false, "score": 1, "creation_date": 1481670140, "post_id": 41131884, "comment_id": 69468358, "body": "@Martin it is not clear what exactly you want to delete: the last row? all the rows? the cells <code>A to C</code> from the last row? once you clarify it CallumDA can edit the answer accordingly."}, {"owner": {"reputation": 347, "user_id": 6712951, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/76695526b789999adfdd389a09b50a29?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/6712951/martin"}, "edited": false, "score": 0, "creation_date": 1481671812, "post_id": 41131884, "comment_id": 69468875, "body": "Im sorry if it wasnt clear at the beginning. I want to delete all the contents by selecting A3:C3 and then pressing arrow down whilst holding Ctrl+Shift. I want to use this method because I will have different amount of rows containing data. One time it could be A3:C15 next time A3:C36 that i want to delete but the range will always start at A3."}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1481671910, "post_id": 41131884, "comment_id": 69468907, "body": "Thanks for clarifying, I update the code accordingly"}, {"owner": {"reputation": 347, "user_id": 6712951, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/76695526b789999adfdd389a09b50a29?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/6712951/martin"}, "edited": false, "score": 0, "creation_date": 1481673133, "post_id": 41131884, "comment_id": 69469254, "body": "I have updated the original post, could you please review and tell me which one will be processed using less of computers resources."}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1481673576, "post_id": 41131884, "comment_id": 69469383, "body": "I&#39;m not an expert when it comes to these kind of questions but I&#39;d say the solution I provided uses less resources because it doesn&#39;t create an extra variable for the address and also I think declaring variable types before you use the variables makes the code run quicker - <code>Variant</code> type would probably be an exception though"}, {"owner": {"reputation": 347, "user_id": 6712951, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/76695526b789999adfdd389a09b50a29?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/6712951/martin"}, "edited": false, "score": 0, "creation_date": 1481734603, "post_id": 41131884, "comment_id": 69498481, "body": "Thank you for your support, may I ask you to look at the code in my original post and tell me if I can squeeze it into the loop as you did with copy paste bit. Hope it&#39;s not too much what im asking from you."}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 347, "user_id": 6712951, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/76695526b789999adfdd389a09b50a29?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/6712951/martin"}, "edited": false, "score": 0, "creation_date": 1481756051, "post_id": 41131884, "comment_id": 69509182, "body": "Hi @Martin, this is not the right place for me to look at all of your code and improve it. You can post it on Code Review - but before you do so I&#39;d recommend taking a look at this first for how to avoid using <code>Select</code> <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\" title=\"how to avoid using select in excel vba macros\">stackoverflow.com/questions/10714251/&hellip;</a>"}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": true, "score": 3, "last_activity_date": 1481670204, "last_edit_date": 1481670204, "creation_date": 1481669189, "answer_id": 41131884, "question_id": 41131588, "link": "https://stackoverflow.com/questions/41131588/excel-vba-clearcontents-error/41131884#41131884", "title": "Excel VBA ClearContents error", "body": "<p>Try this. I've declared your variables properly and also assigned values to your array using <code>Array()</code> rather than <code>Split()</code> both are fine, but <code>Array()</code> is more flexible</p>\n\n<pre><code>Sub clear_sheets()\n    Dim sheetNames As Variant\n    Dim count As Integer\n    sheetNames = Array(\"AA\", \"BB\", \"CC\")\n\n    For Count = 0 To UBound(Snames)\n        With Sheets(sheetNames(Count))\n            Range(.Range(\"A3\"), .Range(\"C3\").End(xlDown)).ClearContents\n        End With\n    Next\n\n    Sheets(\"MENU\").Select\n    Optimise (False)\nEnd Sub\n</code></pre>\n\n<p>Also, it's better to use <code>ThisWorkbook.Sheets()</code>rather than just <code>Sheets()</code> if your code refers to the same workbook you are writing your VBA in. If you don't do this then VBA will assume you are referring to the sheets in whichever workbook is active when you run the code - that's not usually a good thing.</p>\n\n<p><strong>Update</strong>\nI've changed the code to delete what I <em>think</em> you might want deleted?</p>\n"}], "owner": {"reputation": 347, "user_id": 6712951, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/76695526b789999adfdd389a09b50a29?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/6712951/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 706, "favorite_count": 0, "accepted_answer_id": 41131884, "answer_count": 2, "score": 1, "last_activity_date": 1488284080, "creation_date": 1481667825, "last_edit_date": 1488284080, "question_id": 41131588, "link": "https://stackoverflow.com/questions/41131588/excel-vba-clearcontents-error", "title": "Excel VBA ClearContents error", "body": "<p>Im trying to run macro which should clear contents from sheets AA, BB and CC and then move into sheet MENU but its highliting me an error on line 4. Please see the code below.</p>\n\n<pre><code>Sub clear_sheets()\n\nSnames = Split(AA, BB, CC)\n\nFor Count = 0 To UBound(Snames)\n\n    Sheets(Snames(Count)).Range(\"A3:C3\").End(xlDown).ClearContents\n\nNext\n    Sheets(\"MENU\").Select\nOptimise (False)\n\nEnd Sub\n</code></pre>\n\n<p>I got a little bit different approach posted on a different forum. Which would run more efficiently, I mean which one will will be putting less stress on a processing?</p>\n\n<pre><code>    Sub clear_sheets()\n\nOptimise (True)\n\nSnames = Split(\"AA, BB, CC\", \", \")\n\nFor count = 0 To UBound(Snames)\nMyRange = Range(\"A3:C3\", Range(\"A3:C3\").End(xlDown)).Address\n\n    ThisWorkbook.Sheets(Snames(count)).Range(MyRange).ClearContents\n\nNext\n    Sheets(\"MENU\").Select\nOptimise (False)\n\nEnd Sub\n</code></pre>\n\n<p><strong>Update</strong>\nI understand this is not a code writing website but I would like to ask you if you could have a look at my code below.</p>\n\n<pre><code>Sub distribute_dsp_data_9()\n\nSheets(\"raw_data_1_9\").Visible = True\n\nSheets(\"raw_data_1_9\").Select\nActiveSheet.ListObjects(\"COMP_summ_9\").Range.AutoFilter Field:=2, Criteria1 _\n    :=\"DTTD\"\nRange(\"C2\").Select\nRange(Selection, Selection.End(xlDown)).Select\nRange(Selection, Selection.End(xlToLeft)).Select\nSelection.Copy\nSheets(\"DTTD\").Select\nRange(\"A3\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n\nSheets(\"raw_data_1_9\").Select\nActiveSheet.ListObjects(\"COMP_summ_9\").Range.AutoFilter Field:=2, Criteria1 _\n    :=\"FDTL\"\nRange(\"C2\").Select\nRange(Selection, Selection.End(xlDown)).Select\nRange(Selection, Selection.End(xlToLeft)).Select\nSelection.Copy\nSheets(\"FDTL\").Select\nRange(\"A3\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n\nSheets(\"raw_data_1_9\").Select\nActiveSheet.ListObjects(\"COMP_summ_9\").Range.AutoFilter Field:=2, Criteria1 _\n    :=\"FULL\"\nRange(\"C2\").Select\nRange(Selection, Selection.End(xlDown)).Select\nRange(Selection, Selection.End(xlToLeft)).Select\nSelection.Copy\nSheets(\"FUL ON\").Select\nRange(\"A3\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n\nSheets(\"raw_data_1_9\").Select\nActiveSheet.ListObjects(\"COMP_summ_9\").Range.AutoFilter Field:=2\n\nSheets(\"raw_data_1_9\").Visible = False\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 1018, "user_id": 6706734, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89cf86a3fd50974771d8041b8f13e5b0?s=128&d=identicon&r=PG&f=1", "display_name": "J_Lard", "link": "https://stackoverflow.com/users/6706734/j-lard"}, "edited": false, "score": 1, "creation_date": 1481666046, "post_id": 41131149, "comment_id": 69466701, "body": "Instead of copying and pasting values just directly set the new values like this. <code>Sheets(&quot;Employee import&quot;).Range(&quot;G&quot; &amp; i).Value = Sheets(&quot;Demographic&quot;).Range(&quot;AO&quot; &amp; i)</code>. This will probably speed up the code quite a bit."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 4, "creation_date": 1481666057, "post_id": 41131149, "comment_id": 69466709, "body": "Directly assigning values should already be faster then copy/Paste. Try it and let us see if it pays out: <code>Sheets(&quot;Employee import&quot;).Range(&quot;F&quot; &amp; i).Value = Sheets(&quot;Demographic&quot;).Range(&quot;AU&quot; &amp; i).Value</code>"}, {"owner": {"reputation": 1, "user_id": 7293181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c99c6c6e1766b458e78e86b1937b6f4e?s=128&d=identicon&r=PG&f=1", "display_name": "guarcleveland", "link": "https://stackoverflow.com/users/7293181/guarcleveland"}, "edited": false, "score": 2, "creation_date": 1481666708, "post_id": 41131149, "comment_id": 69466996, "body": "Thank you! I&#39;m an idiot lol"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481666786, "post_id": 41131149, "comment_id": 69467030, "body": "Approximately how many rows of data are you processing?  P.S.  Ignore my previous comment, I didn&#39;t notice that <code>i</code> was being incremented every time through the loop - I thought it was only being incremented if the data was copied."}, {"owner": {"reputation": 834, "user_id": 7254350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d50e0010acd2ec89f9242bfa8ea48e9?s=128&d=identicon&r=PG&f=1", "display_name": "tlemaster", "link": "https://stackoverflow.com/users/7254350/tlemaster"}, "edited": false, "score": 0, "creation_date": 1481667223, "post_id": 41131149, "comment_id": 69467223, "body": "After debugging, place the following at the start of your subroutine:      Application.ScreenUpdating = False At the end of the subroutine:     Application.ScreenUpdating = True This will speed up processing a lot."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 1, "creation_date": 1481667992, "post_id": 41131149, "comment_id": 69467575, "body": "Along the lines of screen updating you can stop automatic calculation as well, this may help: Application.Calculation = xlCalculationManual your code here... Application.Calculation = xlCalculationAutomatic"}], "answers": [{"comments": [{"owner": {"reputation": 276, "user_id": 4885960, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/478d641800a96aa96167f35401a7e7aa?s=128&d=identicon&r=PG&f=1", "display_name": "NuWin", "link": "https://stackoverflow.com/users/4885960/nuwin"}, "edited": false, "score": 0, "creation_date": 1481675584, "post_id": 41131778, "comment_id": 69469958, "body": "Don&#39;t formula arrays slow down Excel dramatically?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 276, "user_id": 4885960, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/478d641800a96aa96167f35401a7e7aa?s=128&d=identicon&r=PG&f=1", "display_name": "NuWin", "link": "https://stackoverflow.com/users/4885960/nuwin"}, "edited": false, "score": 0, "creation_date": 1481675856, "post_id": 41131778, "comment_id": 69470040, "body": "@NuWin why should they? it depends, here the point is to compare them to a &quot;line-by-line VBA code&quot;. Anyway, if you look further into the code, I erased the formulas right after getting the values, so these formlas are executed just once, in the macro, then removed."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1481668716, "creation_date": 1481668716, "answer_id": 41131778, "question_id": 41131149, "link": "https://stackoverflow.com/questions/41131149/need-more-efficiency-than-for-each-loop-vba/41131778#41131778", "title": "Need more efficiency than For Each Loop vba", "body": "<p>A formula array should be your best hope. This supposes that the cells that do not match will lead to empty values in the destination range:</p>\n\n<pre><code>chk = \"Demographic!AU2:AU\" &amp; lastRow\nsrc = \"Demographic!AU2:AU\" &amp; lastRow\nWith Sheets(\"Employee import\").Range(\"F2:F\" &amp; lastRow)\n  .FormulaArray = \"=IF(\" &amp; chk &amp; \"&lt;&gt; \"\"\"\",\" &amp; src &amp; \", \"\"\"\")\"\n  .Value = .Value '&lt;-- if you want to remove the formulas and keep only the copied values\nEnd With\n\nchk = \"Demographic!AM2:AM\" &amp; lastRow\nsrc = \"Demographic!AO2:AO\" &amp; lastRow\nWith Sheets(\"Employee import\").Range(\"G2:G\" &amp; lastRow)\n  .FormulaArray = \"=IF(\" &amp; chk &amp; \"= \"\"T\"\",\" &amp; src &amp; \", \"\"\"\")\"\n  .Value = .Value '&lt;-- if you want to remove the formulas and keep only the copied values\nEnd With\n</code></pre>\n\n<p>Not sure that it will be faster with your dataset though, you can only verify by trying it.</p>\n"}, {"tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": false, "score": 1, "last_activity_date": 1481671862, "creation_date": 1481671862, "answer_id": 41132366, "question_id": 41131149, "link": "https://stackoverflow.com/questions/41131149/need-more-efficiency-than-for-each-loop-vba/41132366#41132366", "title": "Need more efficiency than For Each Loop vba", "body": "<p>If you just want a straight data transfer (ie no formulas or formats), and your data set is large, then you could consider writing the data in one batch by way of an array.</p>\n\n<p>Your own code shouldn't be horrendously slow though, so it suggests you have some calculations running or maybe you're handling Worksheet_Change events. If this is possible, then you might want to disable those during the data transfer:</p>\n\n<pre><code>With Application\n    .EnableEvents = False\n    .ScreenUpdating = False\n    .Calculation = xlCalculationManual\nEnd With\n</code></pre>\n\n<p>Just remember to reset them at the end of your routine:</p>\n\n<pre><code>With Application\n    .EnableEvents = True\n    .ScreenUpdating = True\n    .Calculation = xlCalculationAutomatic\nEnd With\n</code></pre>\n\n<p>If you went the array route, skeleton code would be like so:</p>\n\n<pre><code>Dim inData As Variant\nDim outData() As Variant\nDim r As Long\n\n'Read the demographic data\nWith Worksheets(\"Demographic\")\n    inData = .Range(.Cells(2, \"AU\"), .Cells(.Rows.Count, \"AU\").End(xlUp)).Value2\nEnd With\n\n'Use this if your column F is to be entirely overwritten\nReDim outData(1 To UBound(inData, 1), 1 To UBound(inData, 2))\n\n'Use this if you have exisiting data in column F\n'With Worksheets(\"Employee import\")\n'    outData = .Cells(2, \"F\").Resize(UBound(inData, 1)).Value2\n'End With\n\n'Pass the values across\nFor r = 1 To UBound(inData, 1)\n    If Not IsEmpty(inData(r, 1)) Then\n        outData(r, 1) = inData(r, 1)\n    End If\nNext\n\n'Write the new values\nWorksheets(\"Employee import\").Cells(2, \"F\").Resize(UBound(outData, 1)).Value = outData\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1481701509, "creation_date": 1481701509, "answer_id": 41137251, "question_id": 41131149, "link": "https://stackoverflow.com/questions/41131149/need-more-efficiency-than-for-each-loop-vba/41137251#41137251", "title": "Need more efficiency than For Each Loop vba", "body": "<p>as for your first copy/paste values, it actually doesn't need any check, since blank values would be pasted as blank ones...</p>\n\n<p>so you could go:</p>\n\n<pre><code>With Worksheets(\"Demographic\")\n    With .Range(\"AU2\", .Cells(.Rows.count, \"AU\").End(xlUp))\n        Worksheets(\"Employee import\").Range(\"F2\").Resize(.Rows.count).Value = .Value\n    End With\nEnd With\n</code></pre>\n\n<p>as for your 2nd copy/paste values, you could paste all values and then filter not wanted ones and clear them in target sheet\nlike follows:</p>\n\n<pre><code>With Worksheets(\"Demographic\")\n    With .Range(\"AM2\", .Cells(.Rows.count, \"AM\").End(xlUp))\n        Worksheets(\"Employee import\").Range(\"G2\").Resize(.Rows.count).Value = .Offset(, 2).Value\n    End With\nEnd With\n\nWith Worksheets(\"Employee import\")\n    With .Range(\"G1\", .Cells(.Rows.count, \"G\").End(xlUp))\n        .AutoFilter field:=1, Criteria1:=\"&lt;&gt;T\"\n        .Resize(.Rows.count).Offset(1).SpecialCells(xlCellTypeVisible).ClearContents\n    End With\n    .AutoFilterMode = False\nEnd With\n</code></pre>\n\n<p>that said, if your workbook has many formulas and/or event handlers then you would also greatly benefit from disabling them (<code>Application.EnableEvents = False</code>, <code>Application.Calculation = xlCalculationManual</code>) before running your code and enabling them back (<code>Application.EnableEvents = True</code>, <code>Application.Calculation = xlCalculationAutomatic</code>) after you code completes </p>\n"}], "owner": {"reputation": 1, "user_id": 7293181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c99c6c6e1766b458e78e86b1937b6f4e?s=128&d=identicon&r=PG&f=1", "display_name": "guarcleveland", "link": "https://stackoverflow.com/users/7293181/guarcleveland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1481701509, "creation_date": 1481665784, "last_edit_date": 1481665884, "question_id": 41131149, "link": "https://stackoverflow.com/questions/41131149/need-more-efficiency-than-for-each-loop-vba", "title": "Need more efficiency than For Each Loop vba", "body": "<p>I am a newcomer to vba/excel macros and need a more efficient way to run the below code. I am using a for each loop to return a value from a row based on a column's value (same row). The code works, but takes far too much processing power and time to get through the loops (often freezing the computer or program). I would appreciate any suggestions...</p>\n\n<p>'The following is searching each cell in a range to determine if a cell is not empty. If the cell is not empty, the macro will copy the value of the cell and paste it in to another worksheet (same row)</p>\n\n<pre><code>Set rng = Worksheets(\"Demographic\").Range(\"AU2:AU\" &amp; lastRow)  \ni = \"2\"  \nFor Each cell In rng  \n    If Not IsEmpty(cell.Value) Then  \n        Sheets(\"Demographic\").Range(\"AU\" &amp; i).Copy  \n        Sheets(\"Employee import\").Range(\"F\" &amp; i).PasteSpecial xlPasteValues  \n    End If  \n    i = i + 1  \nNext  \n</code></pre>\n\n<p>'The following is searching each cell in a range to determine if a cell contains a \"T\". If the cell contains a \"T\", the macro will copy the value of a different column (same row) and paste it in to another worksheet (same row)</p>\n\n<pre><code>Set rng = Worksheets(\"Demographic\").Range(\"AM2:AM\" &amp; lastRow)  \ni = \"2\"  \nFor Each cell In rng  \n    If cell.Value = \"T\" Then  \n        Sheets(\"Demographic\").Range(\"AO\" &amp; i).Copy  \n        Sheets(\"Employee import\").Range(\"G\" &amp; i).PasteSpecial xlPasteValues  \n    End If  \n    i = i + 1  \nNext\n</code></pre>\n"}, {"tags": ["excel", "vba", "formatting"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1481668170, "post_id": 41131052, "comment_id": 69467643, "body": "Really confused. Are you trying to add a different conditional formatting or just regular formatting to alternating rows? If it is just formatting what errors are you getting on the &quot;ShadeEveryOtherRow&quot; sub? This one seems like it should work."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1481673473, "post_id": 41132266, "comment_id": 69469362, "body": "I have thirty tables, and I am keen to add this to my code, so I am looking for VBA element"}, {"owner": {"reputation": 1624, "user_id": 2461854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/47e730b86ab52e2857d82e1f3d9d6a43?s=128&d=identicon&r=PG", "display_name": "Tom Malkin", "link": "https://stackoverflow.com/users/2461854/tom-malkin"}, "reply_to_user": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1481769546, "post_id": 41132266, "comment_id": 69512900, "body": "@user3287522 I guess this comes down to how often you need to do this - If it&#39;s a once only then it might just be faster to copy/paste the formats across the 30 tables.  Another option would be to copy the format over one table, and then make a VBA sub that copy and pastes the formats over the applicable tables, rather than actually setting the formats using the code"}, {"owner": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1481824209, "post_id": 41132266, "comment_id": 69541064, "body": "I agree with you mate, but I have to do various reports on a weekly basis, so this part would be a lot easier, as I have created a dynamic range, I just need to add this into the code, if I get the above to work, as at the mo, it just colours my whole tables in black."}, {"owner": {"reputation": 1624, "user_id": 2461854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/47e730b86ab52e2857d82e1f3d9d6a43?s=128&d=identicon&r=PG", "display_name": "Tom Malkin", "link": "https://stackoverflow.com/users/2461854/tom-malkin"}, "reply_to_user": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1481841935, "post_id": 41132266, "comment_id": 69549692, "body": "@user3287522 To be honest I recommended going the conditional formatting route without even looking at your code - but if your heart is set on fixing up your code, the issue is the delimiter in your parameters. The colon in VBA means new line, try using a comma instead. Added an example to my answer"}, {"owner": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1482855119, "post_id": 41132266, "comment_id": 69898544, "body": "Hi everyone, I was able to record a macro with a sample range using the conditional formatting element. I than edited my sample range and applied it to all my tables, by making the range dynamic and using union, this solved my problem."}], "tags": [], "owner": {"reputation": 1624, "user_id": 2461854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/47e730b86ab52e2857d82e1f3d9d6a43?s=128&d=identicon&r=PG", "display_name": "Tom Malkin", "link": "https://stackoverflow.com/users/2461854/tom-malkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1481842044, "last_edit_date": 1481842044, "creation_date": 1481671312, "answer_id": 41132266, "question_id": 41131052, "link": "https://stackoverflow.com/questions/41131052/colour-formatting-every-other-row/41132266#41132266", "title": "Colour Formatting every other row", "body": "<p>You don't need VBA for this - you can use conditional formatting with a formula:</p>\n\n<pre><code>=MOD(ROW(),2)=1\n</code></pre>\n\n<p>and set the format to light grey. Do this for the first row and then copy that row across the area as <strong>formats</strong> (paste special).</p>\n\n<p>Your code however uses the wrong delimiter in the parameters, colon in VBA means new line, so your statement</p>\n\n<pre><code>Range(\"A1:E30\").Rows(Counter).Interior.Pattern = xlSolid: PatternColorIndex = xlAutomatic\n</code></pre>\n\n<p>Is the same as</p>\n\n<pre><code>Range(\"A1:E30\").Rows(Counter).Interior.Pattern = xlSolid \nPatternColorIndex = xlAutomatic\n</code></pre>\n\n<p>And I assume VBA is using your latest selection for the second line.</p>\n\n<p>Try:</p>\n\n<pre><code>Range(\"A1:E30\").Rows(Counter).Interior.Pattern = xlSolid, PatternColorIndex = xlAutomatic\n</code></pre>\n\n<p>etc</p>\n"}], "owner": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481842044, "creation_date": 1481665338, "question_id": 41131052, "link": "https://stackoverflow.com/questions/41131052/colour-formatting-every-other-row", "title": "Colour Formatting every other row", "body": "<p>I was able to find two codes on stack overflow, but not get it to give one light grey formatted row, followed by white row, help would be appreciated, tried both codes</p>\n\n<pre><code>Sub Colour(rng As Range, firstColor As Long, secondColor As Long)\n    rng.Interior.ColorIndex = xlAutomatic\n    rng.FormatConditions.Add Type:=xlExpression, Formula1:=\"=MOD(ROW(),2)=0\"\n    rng.FormatConditions(1).Interior.Color = firstColor\n    rng.FormatConditions.Add Type:=xlExpression, Formula1:=\"=MOD(ROW(),2)&lt;&gt;0\"\n    rng.FormatConditions(2).Interior.Color = secondColor\nEnd Sub\n'Usage:\n'\nSub ColourFormatting()\n    Dim rng As Range\n    Dim firstColor As Long\n    Dim secondColor As Long\n\n    Set rng = Range(\"A1:E10\")\n    firstColor = Pattern = xlSolid: PatternColorIndex = xlAutomatic: ThemeColor = xlThemeColorDark1: TintAndShade = -0.149998474074526: PatternTintAndShade = 0\n    secondColor = TintAndShade = 0: PatternTintAndShade = 0\n'\n    Call Colour(rng, firstColor, secondColor)\nEnd Sub\n\nSub ShadeEveryOtherRow()\n    Dim Counter As Integer\n\n    'For every row in the current selection...\n    For Counter = 1 To Range(\"A1:E30\").Rows.Count\n        'If the row is an odd number (within the selection)...\n        If Counter Mod 2 = 1 Then\n            'Set the pattern to xlGray16.\n            Range(\"A1:E30\").Rows(Counter).Interior.Pattern = xlSolid: PatternColorIndex = xlAutomatic: ThemeColor = xlThemeColorDark1: TintAndShade = -0.149998474074526: PatternTintAndShade = 0\n\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481667526, "post_id": 41130725, "comment_id": 69467350, "body": "If you want to force them to use your path, and only allow them to give a filename, why use the <code>GetSaveAsFilename</code> dialog at all - just use an <code>InputBox</code> and ask them to supply the filename (and then prepend your fixed path to whatever they give)?  Or, if you want to use <code>GetSaveAsFilename</code> so that they can click an existing filename rather than typing it in, you could either strip off the path portion of <code>FileNameVal</code> and put your own path in, or you could make the user keep choosing filenames until the path matches your required path."}, {"owner": {"reputation": 13, "user_id": 7293211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/825d836ec00edffa3dfe27d82af0b21c?s=128&d=identicon&r=PG&f=1", "display_name": "Remco H.", "link": "https://stackoverflow.com/users/7293211/remco-h"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481744039, "post_id": 41130725, "comment_id": 69503595, "body": "The filename i am using is yymmdd-followup as in 161214-1, 14th of december 2016 with follow up number 1. With the save as dialog they always have to check the available follow up number in the specific folder. It&#39;s not possible to define the correct name without checking the folder. So what i have now is the save as box popping up and the document is set to macro enabled workbook. I only need the path specified. Or is it possible to create the filename automatically with the right follow up number (checking the folder). In that case, i can work with that. But i might need some help or tips.."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7293211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/825d836ec00edffa3dfe27d82af0b21c?s=128&d=identicon&r=PG&f=1", "display_name": "Remco H.", "link": "https://stackoverflow.com/users/7293211/remco-h"}, "edited": false, "score": 0, "creation_date": 1481746621, "post_id": 41150965, "comment_id": 69504999, "body": "Thank you for your help. This is almost working flawless. When i press save in the document, i still have to click a random map (folder). After selecting the random map, it automatically generates the specific filename with the follow up in the correct folder."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 13, "user_id": 7293211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/825d836ec00edffa3dfe27d82af0b21c?s=128&d=identicon&r=PG&f=1", "display_name": "Remco H.", "link": "https://stackoverflow.com/users/7293211/remco-h"}, "edited": false, "score": 0, "creation_date": 1481747309, "post_id": 41150965, "comment_id": 69505324, "body": "@RemcoH. - Don&#39;t show the dialog, just save the file where you want it to go.  (See edit)"}, {"owner": {"reputation": 13, "user_id": 7293211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/825d836ec00edffa3dfe27d82af0b21c?s=128&d=identicon&r=PG&f=1", "display_name": "Remco H.", "link": "https://stackoverflow.com/users/7293211/remco-h"}, "edited": false, "score": 0, "creation_date": 1481747868, "post_id": 41150965, "comment_id": 69505618, "body": "This created another problem. Saving the file will generate a new number automatically. For example, i edited document 161214-3 and im trying to save it, it will automatically create a new number (161214-4). The template has to create new numbers, but editing an existing document should not change the name after saving. So close!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 13, "user_id": 7293211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/825d836ec00edffa3dfe27d82af0b21c?s=128&d=identicon&r=PG&f=1", "display_name": "Remco H.", "link": "https://stackoverflow.com/users/7293211/remco-h"}, "edited": false, "score": 0, "creation_date": 1481748284, "post_id": 41150965, "comment_id": 69505838, "body": "@RemcoH. After my previously mentioned edit, I edited it again soon after to put the <code>If SaveAsUI Then</code> back in (with a comment to get rid of the <code>If</code> if you wanted it to generate a new number every time).  Check to make sure you are looking at the latest edit.  So for my testing it ended up updating the number if I did a &quot;Save As&quot; but left the number unchanged with a &quot;Save&quot;."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1481747651, "last_edit_date": 1481747651, "creation_date": 1481744846, "answer_id": 41150965, "question_id": 41130725, "link": "https://stackoverflow.com/questions/41130725/excel-vba-saveasui-file-path/41150965#41150965", "title": "excel vba saveasui file path", "body": "<p>If you wish to generate a unique filename, you could use something like the following function:</p>\n\n<pre><code>Function NextFileName(basename As String) As String\n    Dim followup As Integer\n    Dim pathname As String\n    pathname = \"C:\\Temp\\Temp\\\" ' Include the trailing path separator so that we don't have to do it later\n    followup = 1\n    Do\n        NextFileName = pathname &amp; basename &amp; \"-\" &amp; followup &amp; \".xlsm\"\n        If Dir(NextFileName) = \"\" Then Exit Function\n        followup = followup + 1\n    Loop\nEnd Function\n</code></pre>\n\n<p>You could then call it from your main code as</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n    Dim FileNameVal As String\n    If SaveAsUI Then  ' &lt;-- Exclude the IF statement if you want EVERY save to have a new follow up number\n                      '     rather than just \"Save As\" saves\n        Application.EnableEvents = False\n        'Generate the filename\n        FileNameVal = NextFileName(Format(Now, \"yymmdd\"))\n        ThisWorkbook.SaveAs Filename:=FileNameVal, FileFormat:=xlOpenXMLWorkbookMacroEnabled\n        'Maybe advise the user that the save has happened, and where it went to\n        MsgBox \"Spreadsheet saved as \" &amp; FileNameVal\n        Cancel = True\n        Application.EnableEvents = True\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7293211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/825d836ec00edffa3dfe27d82af0b21c?s=128&d=identicon&r=PG&f=1", "display_name": "Remco H.", "link": "https://stackoverflow.com/users/7293211/remco-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 529, "favorite_count": 0, "accepted_answer_id": 41150965, "answer_count": 1, "score": 1, "last_activity_date": 1481747651, "creation_date": 1481663960, "last_edit_date": 1531161705, "question_id": 41130725, "link": "https://stackoverflow.com/questions/41130725/excel-vba-saveasui-file-path", "title": "excel vba saveasui file path", "body": "<p>I have created a template for registration of changes. These are the requests and further administration in the process. I have a code in this template to save the file as an excel macro enabled workbook, always. The problem with this code is that i can't define a specific folder to save the documents. In all cases the save as dialog box will pop up and the user must be able to define their own file name. I want to define the path for all the users. Does anyone know how to add a file location (path) in this macro in order to make it work?</p>\n\n<pre><code>    Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\nDim FileNameVal As String\nIf SaveAsUI Then\n    FileNameVal = Application.GetSaveAsFilename(, \"Excel Macro-Enabled Workbook (*.xlsm), *.xlsm\")\n    Cancel = True\n    If FileNameVal = \"False\" Then 'User pressed cancel\n        Exit Sub\n    End If\n    Application.EnableEvents = False\n        If Right(ThisWorkbook.Name, 5) &lt;&gt; \".xlsm\" Then\n            ThisWorkbook.SaveAs Filename:=FileNameVal, FileFormat:=xlOpenXMLWorkbookMacroEnabled\n        Else\n            ThisWorkbook.SaveAs Filename:=FileNameVal, FileFormat:=xlOpenXMLWorkbookMacroEnabled\n        End If\n    Application.EnableEvents = True\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance.</p>\n\n<p>Kind regards,\nRemco H.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1481665523, "post_id": 41130247, "comment_id": 69466421, "body": "Did you consider the Outlook mail rules? They can do this for you. You can specify where to move mails with very specific criteria."}], "answers": [{"comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 1, "creation_date": 1481666283, "post_id": 41131185, "comment_id": 69466812, "body": "I think the code would not work since the original code is an outlook vba while you mixed it up with excel vba without referencing correctly"}, {"owner": {"reputation": 1567, "user_id": 7179349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d664b43aa7208663483a4c815f000907?s=128&d=identicon&r=PG&f=1", "display_name": "Wedge", "link": "https://stackoverflow.com/users/7179349/wedge"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1481674079, "post_id": 41131185, "comment_id": 69469529, "body": "Yeah that&#39;s true, I was thinking the VBA was in Excel since he was asking how to do it using Excel data. It would be easy to add a reference to an Excel workbook and have a proper sheet reference in there instead. It would probably be easier to do the entire thing with arrays in VBA anyways, unless there is actually a huge data set of unique e-mail subjects they are trying to categorize like this."}], "tags": [], "owner": {"reputation": 1567, "user_id": 7179349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d664b43aa7208663483a4c815f000907?s=128&d=identicon&r=PG&f=1", "display_name": "Wedge", "link": "https://stackoverflow.com/users/7179349/wedge"}, "is_accepted": false, "score": 0, "last_activity_date": 1481665914, "creation_date": 1481665914, "answer_id": 41131185, "question_id": 41130247, "link": "https://stackoverflow.com/questions/41130247/how-can-i-move-mails-items-from-outlook-inbox-with-specific-subject-to-specific/41131185#41131185", "title": "How can I move Mails Items from Outlook Inbox with specific subject to specific folder/sub folder?", "body": "<p>I would use an explicit reference to your sheet instead of ActiveSheet unless you are actually running the Macro on a bunch of different sheets. And I'm just assuming your data is in column A and B and starts at row 2 for examples sake. This is how you would loop through your data and trying to match the subject, then move it to a folder with the name in the next column if it matches. </p>\n\n<pre><code>If Item.Class = olMail Then\n\n    For i = 2 To ActiveSheet.Range(\"A\" &amp; ActiveSheet.Rows.Count).End(xlUp).Row\n\n        If ActiveSheet.Range(\"A\" &amp; i).Value = Item.Subject Then\n              '// Set SubFolder of Inbox\n            Set SubFolder = Inbox.Folders(ActiveSheet.Range(\"B\" &amp; i).Value)\n               '// Mark As Read\n            Item.UnRead = False\n               '// Move Mail Item to sub Folder\n            Item.Move SubFolder\n        End If\n\n    Next\n\nEnd If\n</code></pre>\n\n<p>There are ways you could check without using a loop as well such as the Find method</p>\n\n<pre><code>Dim rnFind As Range\n\nIf Item.Class = olMail Then\n\n    Set rnFind = ActiveSheet.Range(\"A2\", ActiveSheet.Range(\"A\" &amp; ActiveSheet.Rows.Count).End(xlUp)).Find(Item.Subject)\n\n        If Not rnFind Is Nothing Then\n              '// Set SubFolder of Inbox\n            Set SubFolder = Inbox.Folders(rnFind.Offset(, 1).Value)\n               '// Mark As Read\n            Item.UnRead = False\n               '// Move Mail Item to sub Folder\n            Item.Move SubFolder\n        End If\n\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "is_accepted": false, "score": 1, "last_activity_date": 1482009036, "last_edit_date": 1482009036, "creation_date": 1481681846, "answer_id": 41133744, "question_id": 41130247, "link": "https://stackoverflow.com/questions/41130247/how-can-i-move-mails-items-from-outlook-inbox-with-specific-subject-to-specific/41133744#41133744", "title": "How can I move Mails Items from Outlook Inbox with specific subject to specific folder/sub folder?", "body": "<p>You have few options to do this, the painless one is to run Outlook VBA code from inside outlook so you don't need to go through a lot of referencing problem, but at the same time if you are insisting in having your list of subjects and folder in an Excel file, then it is better to run it from Excel, but here is the issue: You'd better not try to run the code from Excel because Microsoft is not supporting that method, so the best way is to write the code in Excel VBA, and again you can do late (runtime) binding or early binding, but I prefer early binding to use intellisence for better referencing outlook objects and avoid late binding performance and/or debugging problems.</p>\n\n<p>Here is the code and how you should use it:</p>\n\n<p>Go to the excel file that you have your subject and folders list or create a new one. Hit ALT+F11 to go to VBE. On the left panel (project explorer) right click and insert a module. Paste this code in there:</p>\n\n<pre><code>Option Explicit\nPublic Sub MoveEmailsToFolders()\n    'arr will be a 2D array sitting in an Excel file, 1st col=subject, 2nd col=folder name\n    '   // Declare your Variables\n    Dim i As Long\n    Dim rowCount As Integer\n    Dim strSubjec As String\n    Dim strFolder As String\n\n    Dim olApp As Outlook.Application\n    Dim olNs As Outlook.Namespace\n    Dim myFolder As Outlook.Folder\n    Dim Item As Object\n\n    Dim Inbox As Outlook.MAPIFolder\n    Dim SubFolder As Outlook.MAPIFolder\n\n    Dim lngCount As Long\n    Dim Items As Outlook.Items\n    Dim arr() As Variant 'store Excel table as an array for faster iterations\n    Dim WS As Worksheet\n\n    'On Error GoTo MsgErr\n\n    'Set Excel references\n    Set WS = ActiveSheet\n    If WS.ListObjects.Count = 0 Then\n        MsgBox \"Activesheet did not have the Excel table containing Subjects and Outlook Folder Names\", vbCritical, \"Error\"\n        Exit Sub\n    Else\n        arr = WS.ListObjects(1).DataBodyRange.Value\n        rowCount = UBound(arr, 2)\n        If rowCount = 0 Then\n            MsgBox \"Excel table does not have rows.\", vbCritical, \"Error\"\n            Exit Sub\n        End If\n    End If\n\n\n    'Set Outlook Inbox Reference\n    Set olApp = New Outlook.Application\n    Set olNs = olApp.GetNamespace(\"MAPI\")\n    Set myFolder = olNs.GetDefaultFolder(olFolderInbox)\n\n    Set Inbox = olNs.GetDefaultFolder(olFolderInbox)\n    Set Items = Inbox.Items\n\n      '   // Loop through the Items in the folder backwards\n      For lngCount = Items.Count To 1 Step -1\n        strFolder = \"\"\n        Set Item = Items.Item(lngCount)\n\n        'Debug.Print Item.Subject\n\n        If Item.Class = olMail Then\n            'Determine whether subject is among the subjects in the Excel table\n            For i = 1 To rowCount\n                If arr(i, 1) = Item.Subject Then\n                    strFolder = arr(i, 2)\n\n                    '// Set SubFolder of Inbox, read the appropriate folder name from table in Excel\n                    Set SubFolder = Inbox.Folders(strFolder)\n                    '// Mark As Read\n                    Item.UnRead = False\n                    '// Move Mail Item to sub Folder\n                    Item.Move SubFolder\n                    Exit For\n                    End If\n                Next i\n            End If\n\n      Next lngCount\n\n  MsgErr_Exit:\n    Set Inbox = Nothing\n      Set SubFolder = Nothing\n    Set olNs = Nothing\n    Set Item = Nothing\n\n    Exit Sub\n\n '// Error information\nMsgErr:\n    MsgBox \"An unexpected Error has occurred.\" _\n        &amp; vbCrLf &amp; \"Error Number: \" &amp; Err.Number _\n        &amp; vbCrLf &amp; \"Error Description: \" &amp; Err.Description _\n        , vbCritical, \"Error!\"\n  Resume MsgErr_Exit\nEnd Sub\n</code></pre>\n\n<p><strong>Set Reference:</strong></p>\n\n<p>To use outlook objects, in Excel VBE go to Tools, References and check Microsoft Outlook object library. </p>\n\n<p><strong>Set Excel Sheet:</strong></p>\n\n<p>In an Excel sheet, create a table with two columns that the first column contains email subjects and the second column contains folders to which you want those emails to be moved.</p>\n\n<p>Then, insert a shape and right click on that and Assign a Macro, find the name of the macro (MoveEmailsToFolders) and click ok.</p>\n\n<p><strong>Suggestions:</strong></p>\n\n<p>You can develop the code more to disregard matchcase. To do that replace this line:</p>\n\n<pre><code>arr(i, 1) = Item.Subject\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>Ucase(arr(i, 1)) = Ucase(Item.Subject)\n</code></pre>\n\n<p>Also, you can move the emails that contain the subject rather than matching an exact title, for example if an email subject had \"test\", or begins with \"test\", or ends with \"test\", then move it to the corresponding folder. Then, the comparison clause would be:</p>\n\n<pre><code> If arr(i, 1) Like Item.Subject &amp; \"*\" Then 'begins with\n If arr(i, 1) Like  \"*\" &amp; Item.Subject &amp; \"*\" Then 'contains\n If arr(i, 1) Like  \"*\" &amp; Item.Subject Then 'ends with\n</code></pre>\n\n<p>Hope this helps! Please hit the check mark to make this as the right answer to your questions if it did</p>\n"}, {"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1481969655, "creation_date": 1481969655, "answer_id": 41197513, "question_id": 41130247, "link": "https://stackoverflow.com/questions/41130247/how-can-i-move-mails-items-from-outlook-inbox-with-specific-subject-to-specific/41197513#41197513", "title": "How can I move Mails Items from Outlook Inbox with specific subject to specific folder/sub folder?", "body": "<p>Use <strong><code>Do Until IsEmpty loop</code></strong>, Make sure to set Excel Object Referees...</p>\n\n<p>See Example on how to loop from Outlook... </p>\n\n<pre><code>Option Explicit\nPublic Sub Move_Items()\n    '// Declare your Variables\n    Dim Inbox As Outlook.MAPIFolder\n    Dim SubFolder As Outlook.MAPIFolder\n    Dim olNs As Outlook.NameSpace\n    Dim Items As Outlook.Items\n    Dim xlApp As Excel.Application\n    Dim xlBook As Excel.Workbook\n    Dim Item As Object\n    Dim ItemSubject As String\n    Dim SubFldr As String\n    Dim lngCount As Long\n    Dim lngRow As Long\n\n    On Error GoTo MsgErr\n    '// Set Inbox Reference\n    Set olNs = Application.GetNamespace(\"MAPI\")\n    Set Inbox = olNs.GetDefaultFolder(olFolderInbox)\n    Set Items = Inbox.Items\n\n    '// Excel Book Reference\n    Set xlApp = New Excel.Application\n    Set xlBook = xlApp.Workbooks.Open(\"C:\\Temp\\Book1.xlsx\") ' Excel Book Path\n\n    lngRow = 2 ' Start Row\n\n    With xlBook.Worksheets(\"Sheet1\") ' Sheet Name\n\n        Do Until IsEmpty(.Cells(lngRow, 1))\n            ItemSubject = .Cells(lngRow, 1).Value ' Subject\n            SubFldr = .Cells(lngRow, 2).Value ' Folder Name\n\n            '// Loop through the Items in the folder backwards\n            For lngCount = Items.Count To 1 Step -1\n                Set Item = Items.Item(lngCount)\n\n                If Item.Class = olMail Then\n\n                    If Item.Subject = ItemSubject Then\n\n                        Debug.Print Item.Subject\n                        Set SubFolder = Inbox.Folders(SubFldr) ' Set SubFolder\n\n                        Debug.Print SubFolder\n                        Item.UnRead = False ' Mark As Read\n                        Item.Move SubFolder ' Move to sub Folder\n\n                    End If\n\n                End If\n            Next\n            lngRow = lngRow + 1\n        Loop\n    End With\n\n    xlBook.Close\n\nMsgErr_Exit:\n    Set Inbox = Nothing\n    Set SubFolder = Nothing\n    Set olNs = Nothing\n    Set Item = Nothing\n    Set xlApp = Nothing\n    Set xlBook = Nothing\n\nExit Sub\n\n'// Error information\nMsgErr:\n   MsgBox \"An unexpected Error has occurred.\" _\n     &amp; vbCrLf &amp; \"Error Number: \" &amp; Err.Number _\n     &amp; vbCrLf &amp; \"Error Description: \" &amp; Err.Description _\n     , vbCritical, \"Error!\"\n  Resume MsgErr_Exit\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 6373098, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10154169581034076/picture?type=large", "display_name": "Hakan Y\u0131lmaz", "link": "https://stackoverflow.com/users/6373098/hakan-y%c4%b1lmaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1433, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1593414995, "creation_date": 1481661929, "last_edit_date": 1593414995, "question_id": 41130247, "link": "https://stackoverflow.com/questions/41130247/how-can-i-move-mails-items-from-outlook-inbox-with-specific-subject-to-specific", "title": "How can I move Mails Items from Outlook Inbox with specific subject to specific folder/sub folder?", "body": "<p>My mails in Outlook has all specific subjects. I have a Excel Sheet which has subject and Folder Name. </p>\n\n<p>I have already this code from <a href=\"https://stackoverflow.com/a/29910853/4539709\">Stackoverflow</a> </p>\n\n<pre><code>Option Explicit\nPublic Sub Move_Items()\n    '// Declare your Variables\n    Dim Inbox As Outlook.MAPIFolder\n    Dim SubFolder As Outlook.MAPIFolder\n    Dim olNs As Outlook.NameSpace\n    Dim Item As Object\n    Dim lngCount As Long\n    Dim Items As Outlook.Items\n\n    On Error GoTo MsgErr\n    '// Set Inbox Reference\n    Set olNs = Application.GetNamespace(\"MAPI\")\n    Set Inbox = olNs.GetDefaultFolder(olFolderInbox)\n    Set Items = Inbox.Items\n\n    '// Loop through the Items in the folder backwards\n    For lngCount = Items.Count To 1 Step -1\n        Set Item = Items.Item(lngCount)\n\n        Debug.Print Item.Subject\n\n        If Item.Class = olMail Then\n            '// Set SubFolder of Inbox\n            Set SubFolder = Inbox.Folders(\"Temp\")\n            '// Mark As Read\n            Item.UnRead = False\n            '// Move Mail Item to sub Folder\n            Item.Move SubFolder\n        End If\n    Next lngCount\n\nMsgErr_Exit:\n    Set Inbox = Nothing\n    Set SubFolder = Nothing\n    Set olNs = Nothing\n    Set Item = Nothing\n\nExit Sub\n\n'// Error information\nMsgErr:\n   MsgBox \"An unexpected Error has occurred.\" _\n     &amp; vbCrLf &amp; \"Error Number: \" &amp; Err.Number _\n     &amp; vbCrLf &amp; \"Error Description: \" &amp; Err.Description _\n     , vbCritical, \"Error!\"\n  Resume MsgErr_Exit\nEnd Sub\n</code></pre>\n\n<p>I want the code to read the active sheet columns, as follow:</p>\n\n<pre><code>Subject.mail   folder_name\n    A                1\n    B                2\n    C                3\n</code></pre>\n\n<p>For example Mail in the Inbox with subject \"A\" then it has to place that mail in folder \"1\".</p>\n\n<p>How do I loop? to look at the Sheet1 and to read to which sub folder it has to move ? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 2, "creation_date": 1481661736, "post_id": 41130156, "comment_id": 69464434, "body": "rw.Rows(n).Resize(4).Delete"}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1481661820, "post_id": 41130156, "comment_id": 69464480, "body": "You could do: rw.Rows(n).Delete,rw.Rows(n-1).Delete, rw.Rows(n-2).Delete, rw.Rows(n-4).Delete"}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1481662002, "post_id": 41130156, "comment_id": 69464595, "body": "@user3598756 Lol Thank you, that worked just fine."}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "reply_to_user": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1481662022, "post_id": 41130156, "comment_id": 69464604, "body": "@VBAPete This works too"}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1481662137, "post_id": 41130156, "comment_id": 69464670, "body": "No worries @MTBthePRO"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1481664167, "post_id": 41130156, "comment_id": 69465702, "body": "@user3598756 - How have I not come across <code>Resize()</code> before?! Thanks for that."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1481664570, "post_id": 41130156, "comment_id": 69465923, "body": "@BruceWayne, you most probably simply don&#39;t remember it!"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1481665106, "post_id": 41130156, "comment_id": 69466193, "body": "@MTBthePRO, you are welcome"}], "answers": [{"tags": [], "owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "is_accepted": true, "score": 0, "last_activity_date": 1487878856, "creation_date": 1487878856, "answer_id": 42424725, "question_id": 41130156, "link": "https://stackoverflow.com/questions/41130156/vba-how-to-delete-the-next-three-rows-based-on-criteria/42424725#42424725", "title": "VBA: How to delete the next three rows based on criteria?", "body": "<pre><code>  Sub Second_DeletingPGM()\n    Dim n As Long\n    Dim nlast As Long\n    Dim rw As Range\n\n    Set rw = ActiveWorkbook.ActiveSheet.UsedRange.Rows\n\n    nlast = rw.Count\n    For n = nlast To 1 Step -1\n        If (rw.Cells(n, 1).Value = \"PGM:AGEDP\") Then\n            rw.Rows(n).Resize(4).Delete\n        End If\n\n    Next n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 42424725, "answer_count": 1, "score": 2, "last_activity_date": 1487878856, "creation_date": 1481661566, "last_edit_date": 1482947509, "question_id": 41130156, "link": "https://stackoverflow.com/questions/41130156/vba-how-to-delete-the-next-three-rows-based-on-criteria", "title": "VBA: How to delete the next three rows based on criteria?", "body": "<p>I have this code that only deletes the row containing the letters <strong>PGM:AGEDP</strong>  but I don't know how to delete the next <strong>three rows</strong> following the first delete. The three rows after <strong>PGM:AGEDP</strong> row are junk they contain some letters, numbers and symbols which come in variety everytime but letters <strong>PGM:AGEDP</strong> will always stay the same . Just for simplicity, if the first row contains the letters then it should be deleted with the bottom three more rows.These four rows come very offend in the whole worksheet more than 30Xs</p>\n\n<pre><code>Sub RemovingPGM()\n\nDim ws As Worksheet\nFor Each ws In Sheets\nws.Activate\n\n  Dim n As Long\n    Dim nlast As Long\n    Dim rw As Range\n    Set rw = ActiveWorkbook.ActiveSheet.UsedRange.Rows\n    nlast = rw.Count\n    For n = nlast To 1 Step -1\n        If (rw.Cells(n, 1).Value = \"PGM:AGEDP\") Then\n            rw.Rows(n).Delete\n        End If\n    Next n\n    Next ws\nEnd Sub\n</code></pre>\n\n<p>Any question regarding further explanation please feel free to ask.</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1481661898, "post_id": 41130143, "comment_id": 69464537, "body": "Hint...using the recorder, try Ctrl+Right Arrow to find the last used column."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 7293074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac02279d2031140321b3ea589949d9b2?s=128&d=identicon&r=PG&f=1", "display_name": "Monu", "link": "https://stackoverflow.com/users/7293074/monu"}, "edited": false, "score": 0, "creation_date": 1481663850, "post_id": 41130286, "comment_id": 69465542, "body": "Do I replace Sheets(&quot;Results&quot;).Select with what you added? it is giving me an error"}, {"owner": {"reputation": 47, "user_id": 7293074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac02279d2031140321b3ea589949d9b2?s=128&d=identicon&r=PG&f=1", "display_name": "Monu", "link": "https://stackoverflow.com/users/7293074/monu"}, "edited": false, "score": 0, "creation_date": 1481669104, "post_id": 41130286, "comment_id": 69467998, "body": "This is what I have and I am getting an application defined error Sheets(&quot;Daily Snapshot&quot;).Select With Sheets(&quot;Results&quot;)     .Range(2, .Columns.Count).End(xlToLeft).Offset(, 1).Resize(4).Value = Range(&quot;J10:J13&quot;).Value End With"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 47, "user_id": 7293074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac02279d2031140321b3ea589949d9b2?s=128&d=identicon&r=PG&f=1", "display_name": "Monu", "link": "https://stackoverflow.com/users/7293074/monu"}, "edited": false, "score": 0, "creation_date": 1481741147, "post_id": 41130286, "comment_id": 69502043, "body": "sorry, I mistyped <code>Cells</code> with <code>Range</code>: see edited code"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1481741089, "last_edit_date": 1481741089, "creation_date": 1481662109, "answer_id": 41130286, "question_id": 41130143, "link": "https://stackoverflow.com/questions/41130143/macro-to-copy-and-paste-from-one-sheet-into-next-open-column-in-another-sheet/41130286#41130286", "title": "Macro to Copy and paste from one sheet into next open column in another sheet", "body": "<pre><code>With Sheets(\"Results\")\n    .Cells(2, .Columns.count).End(xlToLeft).Offset(, 1).Resize(4).Value = Range(\"J10:J13\").Value\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "is_accepted": false, "score": 0, "last_activity_date": 1481664097, "creation_date": 1481664097, "answer_id": 41130756, "question_id": 41130143, "link": "https://stackoverflow.com/questions/41130143/macro-to-copy-and-paste-from-one-sheet-into-next-open-column-in-another-sheet/41130756#41130756", "title": "Macro to Copy and paste from one sheet into next open column in another sheet", "body": "<p>If you change :</p>\n\n<pre><code>Range(\"C2\").Select\n</code></pre>\n\n<p>by</p>\n\n<pre><code>c = Cells(2, 3).End(xlToRight).Column + 1\nCells(2, c).Select\n</code></pre>\n\n<p>c is an integer. It gives you the number of the next empty column in the row 2.</p>\n"}], "owner": {"reputation": 47, "user_id": 7293074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac02279d2031140321b3ea589949d9b2?s=128&d=identicon&r=PG&f=1", "display_name": "Monu", "link": "https://stackoverflow.com/users/7293074/monu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 565, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1481741089, "creation_date": 1481661515, "question_id": 41130143, "link": "https://stackoverflow.com/questions/41130143/macro-to-copy-and-paste-from-one-sheet-into-next-open-column-in-another-sheet", "title": "Macro to Copy and paste from one sheet into next open column in another sheet", "body": "<p>I am new to vba and don't know how to code. I recorded a macro to copy specified cells from one sheet into cells in another sheet, but it keeps pasting into the same column and  I want the paste to be into the next open column. This is all I have. </p>\n\n<p>Sub Weekday()\n'\n' Weekday Macro\n'</p>\n\n<pre><code>Range(\"J10:J13\").Select\nSelection.Copy\nSheets(\"Results\").Select\nRange(\"C2\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1481661293, "post_id": 41130065, "comment_id": 69464160, "body": "Instr finds the position in the string of the first occurrence, not a count of occurrences.  You are asking if the <code>&#47;</code> is in position 2 or greater not if there are more than one <code>&#47;</code>.  The replace will replace all occurrences."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1481661302, "post_id": 41130065, "comment_id": 69464164, "body": "Instr returns the location of the string being sought, not the count."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1481661456, "post_id": 41130065, "comment_id": 69464276, "body": "Have a look at the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264811.aspx\" rel=\"nofollow noreferrer\">msdn documentation</a> of InStr function."}, {"owner": {"reputation": 21, "user_id": 7168705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d0b06ec76049614afe526b6362a696d?s=128&d=identicon&r=PG&f=1", "display_name": "Medicated Gorilla", "link": "https://stackoverflow.com/users/7168705/medicated-gorilla"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1481661525, "post_id": 41130065, "comment_id": 69464311, "body": "@ScottCraner What would you suggest as a solution to the issue?"}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 2, "creation_date": 1481663314, "post_id": 41130065, "comment_id": 69465271, "body": "<code>myCell</code> is not defined. <code>Option Explicit</code> would be your friend here."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1481663478, "post_id": 41130065, "comment_id": 69465355, "body": "How <a href=\"https://exceljet.net/formula/count-specific-characters-in-a-cell\" rel=\"nofollow noreferrer\">Count specific characters in a cell</a> woks."}, {"owner": {"reputation": 21, "user_id": 7168705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d0b06ec76049614afe526b6362a696d?s=128&d=identicon&r=PG&f=1", "display_name": "Medicated Gorilla", "link": "https://stackoverflow.com/users/7168705/medicated-gorilla"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1481663601, "post_id": 41130065, "comment_id": 69465405, "body": "@dee I tried changing myCell to cell and to rng both already defined variables and it&#39;s still not working."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1481663771, "post_id": 41130065, "comment_id": 69465498, "body": "You have <code>For Each cell in rng</code>, and then <code>If If (Len(myCell) ...</code>.  In this context, <code>myCell</code> is not assigned any value. You should do <code>For Each myCell in rng...</code> (and clean up your earlier use of <code>cell</code> as well, up to and including the declaration)."}], "answers": [{"comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1481662130, "post_id": 41130222, "comment_id": 69464668, "body": "@ScottCraner Oops.  Thanks"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1481662144, "post_id": 41130222, "comment_id": 69464674, "body": "@TimWilliams Thanks"}, {"owner": {"reputation": 21, "user_id": 7168705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d0b06ec76049614afe526b6362a696d?s=128&d=identicon&r=PG&f=1", "display_name": "Medicated Gorilla", "link": "https://stackoverflow.com/users/7168705/medicated-gorilla"}, "edited": false, "score": 0, "creation_date": 1481662967, "post_id": 41130222, "comment_id": 69465085, "body": "I apologize for not being more clear. This is exactly what I would like to accomplish however something in the answer provided does not work for me. For some reason when I look step by step, it gets to your if statement then goes to end if as if it didn&#39;t meet the standards listed"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 21, "user_id": 7168705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d0b06ec76049614afe526b6362a696d?s=128&d=identicon&r=PG&f=1", "display_name": "Medicated Gorilla", "link": "https://stackoverflow.com/users/7168705/medicated-gorilla"}, "edited": false, "score": 0, "creation_date": 1481663084, "post_id": 41130222, "comment_id": 69465140, "body": "@MedicatedGorilla Edit your question to show the actual code you are using.  I don&#39;t like to use <code>cell</code> as a variable since it is also a key word in VBA.  So you may have messed something up there."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 21, "user_id": 7168705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d0b06ec76049614afe526b6362a696d?s=128&d=identicon&r=PG&f=1", "display_name": "Medicated Gorilla", "link": "https://stackoverflow.com/users/7168705/medicated-gorilla"}, "edited": false, "score": 1, "creation_date": 1481663568, "post_id": 41130222, "comment_id": 69465393, "body": "@MedicatedGorilla you&#39;ve used <code>myCell</code> but you&#39;re also using <code>cell</code> still as the loop variable. In this case, <code>myCell</code> is never assigned a value and defaults to empty/nullstring. Replace <b>all</b> instances of <code>cell</code> with <code>myCell</code>. Using <code>Option Explicit</code> to require variable declaration would help alert you to typos like this :)"}, {"owner": {"reputation": 21, "user_id": 7168705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d0b06ec76049614afe526b6362a696d?s=128&d=identicon&r=PG&f=1", "display_name": "Medicated Gorilla", "link": "https://stackoverflow.com/users/7168705/medicated-gorilla"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1481663822, "post_id": 41130222, "comment_id": 69465527, "body": "@DavidZemens THANK YOU! I&#39;m not that great at VBA yet so thanks for telling me that!"}, {"owner": {"reputation": 21, "user_id": 7168705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d0b06ec76049614afe526b6362a696d?s=128&d=identicon&r=PG&f=1", "display_name": "Medicated Gorilla", "link": "https://stackoverflow.com/users/7168705/medicated-gorilla"}, "edited": false, "score": 0, "creation_date": 1481663895, "post_id": 41130222, "comment_id": 69465576, "body": "Thanks @RonRosenfeld !"}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 4, "last_activity_date": 1481662107, "last_edit_date": 1481662107, "creation_date": 1481661815, "answer_id": 41130222, "question_id": 41130065, "link": "https://stackoverflow.com/questions/41130065/using-instr-to-determine-the-amount-of-occurrences-of-a-specific-character/41130222#41130222", "title": "Using InStr to determine the amount of occurrences of a specific character?", "body": "<p>If you want to replace all of the \"/\" if there are more than two, then:</p>\n\n<pre><code>If (Len(myCell) - Len(Replace(myCell, \"/\", \"\"))) &gt; 1 Then\n    myCell = Replace(myCell.Text, \"/\", \"\")\nEnd If\n</code></pre>\n\n<p>If you want something else, please be specific.</p>\n"}, {"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1481727921, "creation_date": 1481727921, "answer_id": 41145808, "question_id": 41130065, "link": "https://stackoverflow.com/questions/41130065/using-instr-to-determine-the-amount-of-occurrences-of-a-specific-character/41145808#41145808", "title": "Using InStr to determine the amount of occurrences of a specific character?", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251796.aspx\" rel=\"nofollow noreferrer\"><code>Like</code></a> operator makes it easier to check if a value contains or starts/ends with something:</p>\n\n<pre><code>For Each cell In rng\n\n    If cell Like \"*/*/*\" Then cell.Replace \"/\", \", \"    ' * matches 0 or more characters\n\nNext cell\n</code></pre>\n\n<p>Another option can be to split the value and check upper bound of the result array:</p>\n\n<pre><code>For Each cell In rng\n\n    a = Split(cell, \"/\")\n\n    If UBound(a) &gt; 1 Then cell.Value = Join(a, \", \")\n\nNext cell\n</code></pre>\n\n<p>You can also replace all cells at once without loop with Excel Data Filter:</p>\n\n<pre><code>Set rng = Columns(\"F\")          ' the filter needs the first header cell\n\nrng.AutoFilter 1, \"*/*/*\"       ' add Excel Data Filter to the Range\nrng.Replace \"/\", \", \", xlPart   ' ignores the filtered cells\nrng.AutoFilter                  ' optional to remove the filter\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7168705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d0b06ec76049614afe526b6362a696d?s=128&d=identicon&r=PG&f=1", "display_name": "Medicated Gorilla", "link": "https://stackoverflow.com/users/7168705/medicated-gorilla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 1, "accepted_answer_id": 41130222, "answer_count": 2, "score": 1, "last_activity_date": 1481727921, "creation_date": 1481661172, "last_edit_date": 1481663107, "question_id": 41130065, "link": "https://stackoverflow.com/questions/41130065/using-instr-to-determine-the-amount-of-occurrences-of-a-specific-character", "title": "Using InStr to determine the amount of occurrences of a specific character?", "body": "<p>I'm doing some data processing and I used the code </p>\n\n<pre><code>If InStr(1, cell.Value, \"/\") &gt; 1 Then\n    cell.Replace \"/\", \", \"\nEnd If\n</code></pre>\n\n<p>Now my understanding would be that if \"/\" appeared more than once it would then go ahead and replace it with \",\". However, it seems as though even if there is only 1 \"/\" it still executes the replace. I'm no coding wizard but it seems like the math is a little flawed. Does anyone know what might be the issue?</p>\n\n<p>Edit: Full code</p>\n\n<pre><code>Sub Title()\n\nApplication.ScreenUpdating = False\nDim rng As Range\nDim ws As Worksheet\nSet ws = ActiveSheet\nDim cell As Range\nSet rng = ws.Range(ws.Cells(2, 2), ws.Cells(ws.Rows.Count, 2).End(xlUp))\n\nFor Each cell In rng\n    If InStr(1, cell.Value, \" \") &gt; 0 Then\n        cell.Value = \" \" &amp; cell.Value &amp; \" \"\n    End If\nNext cell\nrng.Replace \"  \", \" \"\n'Data Breakdown\n\n'Remove phrases\n rng.Replace \"at *\", \"\"\n rng.Replace \"We're *\", \"\"\n rng.Replace \"We are *\", \"\"\n rng.Replace \"we're *\", \"\"\n rng.Replace \"we are *\", \"\"\n\nFor Each cell In rng\n\n  If (Len(myCell) - Len(Replace(myCell, \"/\", \"\"))) &gt; 1 Then\n    myCell = Replace(myCell.Text, \"/\", \"\")\n  End If\n\n\nIf InStr(1, cell.Value, \" Manager of \") &gt; 0 Then\n    cell.Replace \" Manager of \", \" Manager, \"\nEnd If\n\nNext cell\n\nrng.Replace \" IT \", \" IT, \"\nrng.Replace \" Manager \", \" Manager, \"\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "is_accepted": true, "score": 1, "last_activity_date": 1481661126, "last_edit_date": 1481661126, "creation_date": 1481660564, "answer_id": 41129927, "question_id": 41129509, "link": "https://stackoverflow.com/questions/41129509/how-do-i-use-one-control-source-with-multiple-combo-boxes-from-a-user-form-in-a/41129927#41129927", "title": "How do I use ONE control source with MULTIPLE combo boxes from a USER FORM, in Access?", "body": "<p>You can't use the same control sources to generate multiple records on the same form. They must be unbound. At least, I don't know how to make that work the way you have it set up, but can still help.</p>\n\n<p>Delete the control sources but keep the row sources.</p>\n\n<p>You will need a query to save the values to your table:</p>\n\n<pre><code>INSERT INTO MyTableName ([MyFieldName]) VALUES ('[ComboboxValue]');\n</code></pre>\n\n<p>Copy this code and paste in query builder. Overwrite \"MyTableName\" and \"MyFieldName\" with the appropriate object names for where you want a single combobox value to be saved. It only adds one row at a time. <code>[ComboboxValue]</code> will be the parameter we use to pass each combo value to the query to execute.</p>\n\n<p>Name the query whatever you want and save it. I will use the placeholder \"MyQuery,\" make sure you update it!</p>\n\n<p>Create a command button on your form, and in its On Click event, paste in this VBA code (you will need to update the combobox references where I use <code>Me!ComboboxName</code>):</p>\n\n<pre><code>Dim qdf As DAO.QueryDef\nDim combo As String\n\nSet qdf = CurrentDb.QueryDefs(\"MyQuery\")\n\ncombo = Me!Combobox1Name\nqdf!ComboboxValue = combo\nqdf.Execute\n\ncombo = Me!Combobox2Name\nqdf!ComboboxValue = combo\nqdf.Execute\n\n'Copy those three lines for each combobox, adjust your combobox references accordingly, \n'or use a loop\n\n'End your procedure like this:\nSet qdf = Nothing\n</code></pre>\n\n<p>If you are using a multi-column combobox, you may need to adjust the reference from <code>Me!Combobox1Name</code> to <code>Me!Combobox1Name.Column(1)</code>.</p>\n"}], "owner": {"reputation": 815, "user_id": 6571492, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/33cca8797c533e67bae63c59711d10db?s=128&d=identicon&r=PG&f=1", "display_name": "ZacAttack", "link": "https://stackoverflow.com/users/6571492/zacattack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 671, "favorite_count": 0, "accepted_answer_id": 41129927, "answer_count": 1, "score": 0, "last_activity_date": 1481661126, "creation_date": 1481658990, "question_id": 41129509, "link": "https://stackoverflow.com/questions/41129509/how-do-i-use-one-control-source-with-multiple-combo-boxes-from-a-user-form-in-a", "title": "How do I use ONE control source with MULTIPLE combo boxes from a USER FORM, in Access?", "body": "<p>I am currently developing A quote sheet for work, I have 21 Combo boxes that are all populated by the same row source. The problems that I am having are When all my combo boxes are set to the same control source all the list values in the combo box are filtered and set to one value. For example combo box 1 is selected and prep is selected now the other 20 combo boxes are set to prep, and I can't select the other options. Now if I have no control source for my combo boxes than previous example works. If I select combo box 1 and set it to prep then I can select combo box 2,3,4... and put any value I want for each one. I want to be able to have each combo box with its own value.</p>\n\n<p>The reason I am wanting the combo boxes to have the same control source is so when a combo box has a selected value it will add a new record to my table. So  if 10 combo boxes have values selected then there will be 10 new rows added to my table when I click my add record button.</p>\n\n<p>I am thinking a maybe having a loop do the work, but am not to familiar with with using vba to run sql??</p>\n"}, {"tags": ["sql-server", "excel", "vba"], "comments": [{"owner": {"reputation": 770, "user_id": 1183079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca9d7069ddf9f6ff0b7eeaa7fbe96d0?s=128&d=identicon&r=PG", "display_name": "Kateract", "link": "https://stackoverflow.com/users/1183079/kateract"}, "edited": false, "score": 0, "creation_date": 1481660192, "post_id": 41129497, "comment_id": 69463560, "body": "Welcome to StackOverflow!  Check out <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> for tips on how to get the most out of the questions you ask here.  For example, in this case it&#39;s better if you start off by just trying something, then coming back if you have a more specific problem.  For your particular question, there&#39;s a good chance that SQL will be much faster for what you are trying to do, but you will probably benefit more from learning how to write it yourself so that you understand what it&#39;s doing.  You probably shouldn&#39;t use code you don&#39;t understand.  Search for how to use Aggregate functions and group by."}, {"owner": {"reputation": 1, "user_id": 7292677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71371e5c8a27622583de388cbe66159d?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/7292677/andy"}, "reply_to_user": {"reputation": 770, "user_id": 1183079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca9d7069ddf9f6ff0b7eeaa7fbe96d0?s=128&d=identicon&r=PG", "display_name": "Kateract", "link": "https://stackoverflow.com/users/1183079/kateract"}, "edited": false, "score": 0, "creation_date": 1481819429, "post_id": 41129497, "comment_id": 69538308, "body": "Thank you, I would much prefer to get help pointing me in the right direction than &quot;here use this&quot;. I shall go delving as I think Group is perhaps the bit that I was missing.when I was trying to get my head round this before."}], "answers": [{"tags": [], "owner": {"reputation": 1701, "user_id": 6173015, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iRT3E.jpg?s=128&g=1", "display_name": "pacreely", "link": "https://stackoverflow.com/users/6173015/pacreely"}, "is_accepted": false, "score": 0, "last_activity_date": 1481659545, "creation_date": 1481659545, "answer_id": 41129658, "question_id": 41129497, "link": "https://stackoverflow.com/questions/41129497/sql-pivot-calculated-fields-is-this-possible/41129658#41129658", "title": "SQL/pivot Calculated fields, is this possible", "body": "<p>Pre-calculated aggregates in SQL can go very wrong in an Excel Pivot.</p>\n\n<p>Firstly, you can accidentally take an average of an average.</p>\n\n<p>Secondly, once users start re-arranging the pivot you can get very strange sub-totals and totals.</p>\n\n<p>Try to ensure you do all of your aggregation in one place. \nIf possible try to use SQL with SSRS, you can base a report on a parameterised stored procedure. Consequently you push all of the hard work onto the SQL box, and you restrict users from pivoting things around improperly.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7292677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71371e5c8a27622583de388cbe66159d?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/7292677/andy"}, "is_accepted": true, "score": 0, "last_activity_date": 1482141826, "creation_date": 1482141826, "answer_id": 41220052, "question_id": 41129497, "link": "https://stackoverflow.com/questions/41129497/sql-pivot-calculated-fields-is-this-possible/41220052#41220052", "title": "SQL/pivot Calculated fields, is this possible", "body": "<p>SELECT          Raw_Data.ID, Raw_Data.fldDate, CONVERT(datetime, DATEADD(second, SUM(DATEDIFF(second, 0, Raw_Data.TotalHandle)) / SUM(Raw_Data.[Call Count]), 0), 108) AS avgHandled\nFROM            Raw_Data \nWHERE           (Raw_Data.fldDate BETWEEN '05-12-2016' AND '07-12-2016')\nGROUP BY    Raw_Data.fldDate, Raw_Data.ID</p>\n\n<p>For anyone interested here is the results of my searching.  Thank you for the help that pointed me in the right direction.  It seems quite clumsy with the conversions due to a time Datatype but it's working.</p>\n"}], "owner": {"reputation": 1, "user_id": 7292677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71371e5c8a27622583de388cbe66159d?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/7292677/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 493, "favorite_count": 0, "accepted_answer_id": 41220052, "answer_count": 2, "score": 0, "last_activity_date": 1482141826, "creation_date": 1481658969, "last_edit_date": 1531164843, "question_id": 41129497, "link": "https://stackoverflow.com/questions/41129497/sql-pivot-calculated-fields-is-this-possible", "title": "SQL/pivot Calculated fields, is this possible", "body": "<p>I'm using Microsoft SQL Server and Excel. I have an issue I'm having problems getting my head round surrounding how to get some fields calculated so  that it runs faster. I have a large data set that gets dropped into excel and stuck into a pivot table. </p>\n\n<p>The table at it's simplest will contain a number of fields similar to the below. </p>\n\n<p>Date    user    WorkType    Count   TotalTime</p>\n\n<p>My issue is that I need to calculate an average in a particular way. Each user may have several worktypes on any given day. The formula I have is for each Date&amp;User Sum(TotalTime)/Sum(Count) to get me the following</p>\n\n<p>Date    user    Average</p>\n\n<p>Currently I dump a select query into excel, apply formula to a column to get my averages then construct the pivot table using the personal details and the averages.</p>\n\n<p>The calculation on over 20,000 rows however is about 5-7 minutes.</p>\n\n<p>So my question is that possible to do that type of calculation in either SQL or Pivot table to cut down the processing time.   I'm not very confident with Pivot tables, and I'm considered fairly inexperienced at SQL compared to here. I can manage bits of this but pulling it all together with the conditions of matching Date and User is beyond me right now.</p>\n\n<p>I could parse the recordset into an array to do my calculations that way before it gets written to the spreadsheet, but I just feel that there should be a better way to achieve the same end.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "edited": false, "score": 2, "creation_date": 1481659195, "post_id": 41129414, "comment_id": 69463017, "body": "<a href=\"http://www.ozgrid.com/VBA/delete-module.htm\" rel=\"nofollow noreferrer\">Maybe relevant</a>"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 2, "creation_date": 1481659245, "post_id": 41129414, "comment_id": 69463036, "body": "Yes and no, you may try <a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">writing the excel VBA itself</a> or with <a href=\"http://www.snb-vba.eu/VBA_Excel_VBproject_en.html\" rel=\"nofollow noreferrer\">this one</a>, however, it&#39;s not hard to surpass it for some mid user, excel is not a reliable tool to keep copyrighted your job."}, {"owner": {"reputation": 318, "user_id": 3250452, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b3ce4422a640b06398cde22466f0f9ac?s=128&d=identicon&r=PG&f=1", "display_name": "C-Love511", "link": "https://stackoverflow.com/users/3250452/c-love511"}, "edited": false, "score": 0, "creation_date": 1481659612, "post_id": 41129414, "comment_id": 69463245, "body": "It looks like the hangup would be accessing the VBProject object. That would get caught by an antivirus and remove the module (And I don&#39;t want that because they&#39;ll need to use it to test it...or the killswitch will be removed)."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1481659726, "post_id": 41129414, "comment_id": 69463311, "body": "Sorry, but IMO this is doomed. The only &quot;safe&quot; macro is a macro that isn&#39;t distributed. Look for a <a href=\"http://www.crunchcode.de/en/index.html\" rel=\"nofollow noreferrer\">good code obfuscation tool</a> instead, to make the VBA completely and utterly undecypherable (yet still functional); that way you can have a plain Boolean <code>IsDisabled</code> check that is outright impossible to tell from the rest of the code."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481659789, "post_id": 41129414, "comment_id": 69463348, "body": "Hm - one way, although it&#39;d be pretty slapdash, would be to somehow pull the VBEditor up, and use <code>SendKeys</code> to just &quot;CTRL + A, DEL&quot; everything.  I&#39;ve accidentally put focus on the VBA Editor when using sendkeys, and it puts that info in there instead of my target document.  Also, I&#39;m pretty sure VBA is not super secure, so if someone&#39;s clever enough, they&#39;d be able to grab your code one way or another.  What about using an AddIn? (I know little about those, but maybe that&#39;s an option?)"}, {"owner": {"reputation": 161, "user_id": 7439152, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9f8af9a0c161f05c27bcd2a466ff7351?s=128&d=identicon&r=PG&f=1", "display_name": "YeP", "link": "https://stackoverflow.com/users/7439152/yep"}, "edited": false, "score": 0, "creation_date": 1551917572, "post_id": 41129414, "comment_id": 96820785, "body": "Don&#39;t think this is a good idea, and the Self-Destruct Switch code can be manipulated without too much effort... unless you obfuscate your VBA code. If you are interested in VBA obfuscation, I&#39;d recommend a tool call VBASH (www.ayedeal.com/vbash). It may help you protect your project."}], "answers": [{"comments": [{"owner": {"reputation": 318, "user_id": 3250452, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b3ce4422a640b06398cde22466f0f9ac?s=128&d=identicon&r=PG&f=1", "display_name": "C-Love511", "link": "https://stackoverflow.com/users/3250452/c-love511"}, "edited": false, "score": 0, "creation_date": 1481660186, "post_id": 41129745, "comment_id": 69463557, "body": "First time hearing about obfuscation. Much better solution."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 318, "user_id": 3250452, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b3ce4422a640b06398cde22466f0f9ac?s=128&d=identicon&r=PG&f=1", "display_name": "C-Love511", "link": "https://stackoverflow.com/users/3250452/c-love511"}, "edited": false, "score": 0, "creation_date": 1481660254, "post_id": 41129745, "comment_id": 69463581, "body": "@C-Love511 - On a more serious note (I just wanted to add that <code>MsgBox</code>), you might also take a look at running pre-assembled code."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 318, "user_id": 3250452, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b3ce4422a640b06398cde22466f0f9ac?s=128&d=identicon&r=PG&f=1", "display_name": "C-Love511", "link": "https://stackoverflow.com/users/3250452/c-love511"}, "edited": false, "score": 2, "creation_date": 1481661139, "post_id": 41129745, "comment_id": 69464090, "body": "@C-Love511 Note: without obfuscation, this code would destroy <i>the one copy of the macro-enabled workbook that&#39;s currently running</i>. If your user made copies, or even just backups of their network folders, they can always restore a backup and trick your code into believing that the trial is still in effect, until they figure out a way to crack the code and tweak it. Properly obfuscated, they can do that and crack open the code... only to find that there&#39;s nothing meaningful there to see, and that it&#39;s going to cost more to reverse-engineer <i>that</i> than to just pay you for your work."}, {"owner": {"reputation": 318, "user_id": 3250452, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b3ce4422a640b06398cde22466f0f9ac?s=128&d=identicon&r=PG&f=1", "display_name": "C-Love511", "link": "https://stackoverflow.com/users/3250452/c-love511"}, "edited": false, "score": 0, "creation_date": 1481661234, "post_id": 41129745, "comment_id": 69464127, "body": "Google search isn&#39;t bringing up anything meaningful for &quot;pre-assembled VBA&quot; or even &quot;pre-assembled code&quot;. Is that another way of saying &quot;Obfuscation&quot; or was there a more specific resource you could point me to?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 318, "user_id": 3250452, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b3ce4422a640b06398cde22466f0f9ac?s=128&d=identicon&r=PG&f=1", "display_name": "C-Love511", "link": "https://stackoverflow.com/users/3250452/c-love511"}, "edited": false, "score": 0, "creation_date": 1481661616, "post_id": 41129745, "comment_id": 69464367, "body": "@C-Love511 - Sorry, gave you <a href=\"https://www.google.com/?gws_rd=ssl#q=vb6+inline+assembly+language\" rel=\"nofollow noreferrer\">the wrong search term</a>."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 318, "user_id": 3250452, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b3ce4422a640b06398cde22466f0f9ac?s=128&d=identicon&r=PG&f=1", "display_name": "C-Love511", "link": "https://stackoverflow.com/users/3250452/c-love511"}, "edited": false, "score": 0, "creation_date": 1481661955, "post_id": 41129745, "comment_id": 69464573, "body": "@C-Love511 Although this <a href=\"http://www.everythingaccess.com/tutorials.asp?ID=A-new-method-for-disabling-the-Mouse-Scroll-Wheel-in-Access-forms\" rel=\"nofollow noreferrer\">site</a> is for Access, the approach is entirely usable in any VBA host."}, {"owner": {"reputation": 318, "user_id": 3250452, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b3ce4422a640b06398cde22466f0f9ac?s=128&d=identicon&r=PG&f=1", "display_name": "C-Love511", "link": "https://stackoverflow.com/users/3250452/c-love511"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1481665130, "post_id": 41129745, "comment_id": 69466201, "body": "@Mat&#39;sMug Thanks for the info, too. While I&#39;m learning about Obfuscation, I&#39;m curious: how much would you charge a person <i>who knows nothing about computers</i> to hack a VBA password AND dig through a couple hundred lines of code to find any safety measures hidden inside, disguised as harmless functions in the code?  (The idea being that these seemingly normal-looking functions would destroy the way the code interacts with the sheets, requiring a new programmer to fix or recreate the sheets so they match up to the code.)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 318, "user_id": 3250452, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b3ce4422a640b06398cde22466f0f9ac?s=128&d=identicon&r=PG&f=1", "display_name": "C-Love511", "link": "https://stackoverflow.com/users/3250452/c-love511"}, "edited": false, "score": 0, "creation_date": 1481665550, "post_id": 41129745, "comment_id": 69466437, "body": "@C-Love511 someone who knows nothing about computers won&#39;t be able to do anything no matter how much you give him. Once I was given a piece of code crippled by <a href=\"http://www.crunchcode.de/en/index.html\" rel=\"nofollow noreferrer\">crunchcode</a>, and with my <a href=\"https://github.com/rubberduck-vba/Rubberduck\" rel=\"nofollow noreferrer\">Rubberduck</a> I could rename identifiers at will, but that didn&#39;t help - I&#39;m no whizz though, but to answer you question... I&#39;ve no idea. That said if you want to chat, we&#39;re in <a href=\"http://chat.stackexchange.com/rooms/14929/vba-rubberducking\">VBA Rubberducking</a> - comments aren&#39;t ideal for discussion."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 318, "user_id": 3250452, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b3ce4422a640b06398cde22466f0f9ac?s=128&d=identicon&r=PG&f=1", "display_name": "C-Love511", "link": "https://stackoverflow.com/users/3250452/c-love511"}, "edited": false, "score": 0, "creation_date": 1481665609, "post_id": 41129745, "comment_id": 69466472, "body": "@C-Love511 - I&#39;d just do it myself. ;-)"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 6, "last_activity_date": 1481659921, "creation_date": 1481659921, "answer_id": 41129745, "question_id": 41129414, "link": "https://stackoverflow.com/questions/41129414/excel-vba-self-destruct-switch/41129745#41129745", "title": "Excel VBA Self-Destruct Switch", "body": "<p>I'll leave the comments to debating whether or not this is a good idea (IMHO it probably isn't).  As to the question itself, of course it's possible, and won't interrupt macro execution:</p>\n\n<pre><code>Public Sub Example()\n    Dim proj As Object\n    Set proj = ThisWorkbook.VBProject\n    Dim comp As Object\n    For Each comp In proj.VBComponents\n        With comp.CodeModule\n            .DeleteLines 1, .CountOfLines\n            If comp.Name = \"ThisWorkbook\" Then\n                .InsertLines 1, \"Private Sub Workbook_Open()\" &amp; vbCrLf &amp; _\n                                vbTab &amp; \"MsgBox \"\"Where's my money, @#$%&amp;!?\"\"\" &amp; vbCrLf &amp; _\n                                \"End Sub\"\n            End If\n        End With\n    Next\n    ThisWorkbook.Save\nEnd Sub\n</code></pre>\n\n<p>Obfuscation is an exercise for the reader.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 14386704, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/35d0d6c4af6622dcbca5782e0fbaffa8?s=128&d=identicon&r=PG", "display_name": "Yogesh", "link": "https://stackoverflow.com/users/14386704/yogesh"}, "is_accepted": false, "score": 1, "last_activity_date": 1601761114, "creation_date": 1601761114, "answer_id": 64189267, "question_id": 41129414, "link": "https://stackoverflow.com/questions/41129414/excel-vba-self-destruct-switch/64189267#64189267", "title": "Excel VBA Self-Destruct Switch", "body": "<p>Put a loop with due date as your payment data . Inside write code to get macro into infinity loop or to delete code.\nIf payment happens on time then just comment above piece of code or else just wait client come back to you on next day defined in loop.</p>\n"}], "owner": {"reputation": 318, "user_id": 3250452, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b3ce4422a640b06398cde22466f0f9ac?s=128&d=identicon&r=PG&f=1", "display_name": "C-Love511", "link": "https://stackoverflow.com/users/3250452/c-love511"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2878, "favorite_count": 1, "accepted_answer_id": 41129745, "answer_count": 2, "score": 4, "last_activity_date": 1601761114, "creation_date": 1481658696, "question_id": 41129414, "link": "https://stackoverflow.com/questions/41129414/excel-vba-self-destruct-switch", "title": "Excel VBA Self-Destruct Switch", "body": "<p>I have had my first \"Client-took-my-work-and-then-ghosted-me-without-paying\" experience. For the future, I want to put in a killswitch, disguised as a regular macro, which makes the whole thing unusable. That way, even if they hire someone to crack the password and remove my \"Your trial has expired...\" check, a normal-looking macro (Something like \"Fix_Sheet_Formatting\") would be easily overlooked and run, destroying everything and saving the changes.</p>\n\n<p>However, that leaves the VBA... We're talking a full purge here, so everything must go. I'll figure out how to <strong>do</strong> all of this on my own, I just don't want to waste time pursuing something that isn't possible:</p>\n\n<p>Can VBA code delete <strong>itself</strong> from a workbook <strong>while running</strong> or does it <em>have</em> to be deleted from a macro on another workbook? And would deleting the code cause the macro to stop running, or can I have it delete everything except a nasty MsgBox after everything is done?</p>\n"}, {"tags": ["vba", "hyperlink", "vlookup"], "answers": [{"tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1481668184, "creation_date": 1481668184, "answer_id": 41131667, "question_id": 41129402, "link": "https://stackoverflow.com/questions/41129402/vlookup-with-hyperlink-vba/41131667#41131667", "title": "Vlookup with Hyperlink - VBA", "body": "<p>I think you are close. Try below code.<br>\nNote as a practice, try not to use \"add\" as a variable name. It messes the IntelliSense, i changed to <code>addr</code>.<br>\nWouldn't the Q,R,S,T columns better off with Formula instead of fixed value? Unless you have an Event code to call this Sub when cells in column G are changed.</p>\n\n<pre><code>Sub Update()\n    Dim calData As String\n    Dim addr As String\n    Dim i As Long, LastRow As Long\n\n    LastRow = Range(\"G\" &amp; Rows.Count).End(xlUp).Row\n    For i = 3 To LastRow\n        If Cells(i, \"G\").Value &lt;&gt; \"\" Then\n            Range(\"Q\" &amp; i).Value = Application.VLookup(Cells(i, \"G\"), Sheets(\"Category\").Range(\"A2:H60\"), 4, False)\n            Range(\"R\" &amp; i).Value = Application.VLookup(Cells(i, \"G\"), Sheets(\"Category\").Range(\"A2:H60\"), 6, False)\n\n            calData = Worksheets(\"Calendar\").Range(\"R\" &amp; i).Value ' Or .Text, depends on data\n            addr = \"G:\\Engineering\\Engineering trainees (HUG)\\Etalonnage\\Proc\u00e9dures calibration\\\" &amp; calData\n            With Worksheets(\"Calendar\")\n                .Hyperlinks.Add Anchor:=.Range(\"R\" &amp; i), Address:=addr, TextToDisplay:=calData\n            End With\n\n            Range(\"S\" &amp; i).Value = Application.VLookup(Cells(i, \"G\"), Sheets(\"Category\").Range(\"A2:H60\"), 7, False)\n            Range(\"T\" &amp; i).Value = Application.VLookup(Cells(i, \"G\"), Sheets(\"Category\").Range(\"A2:H60\"), 8, False)\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7292835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e0KIVWQ8XdQ/AAAAAAAAAAI/AAAAAAAAALQ/dM0OrHoXr7c/photo.jpg?sz=128", "display_name": "Louis-Philippe Talbot", "link": "https://stackoverflow.com/users/7292835/louis-philippe-talbot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 584, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481668184, "creation_date": 1481658632, "question_id": 41129402, "link": "https://stackoverflow.com/questions/41129402/vlookup-with-hyperlink-vba", "title": "Vlookup with Hyperlink - VBA", "body": "<p>I'm currently seaching to find a way to copy and paste hyperlink link from another sheet. </p>\n\n<p>The way the program supposed to be working is that you choose from a list a item category and then all the following columns are automatically filled with Vlookup check-up on the ''Category'' Sheet</p>\n\n<p>The problem :\nNeed to keep the hyperlink when copy and past the information, I'm still new in the code and currently have no idea how to make it worked. </p>\n\n<p>I really want to keep the VBA, because the code is hide and people won't be able to mess with it and can write on top off the cell for special case. </p>\n\n<pre><code>Sub Update()\n Dim calData As String\n Dim add As String\n Dim i, LastRow\n LastRow = Range(\"G\" &amp; Rows.Count).End(xlUp).Row\n For i = 3 To LastRow\n If Cells(i, \"G\").Value &lt;&gt; \"\" Then\n    Range(\"Q\" &amp; i).Value = Application.VLookup(Cells(i, \"G\"), Sheets(\"Category\").Range(\"A2:H60\"), 4, False)\n    Range(\"R\" &amp; i).Value = Application.VLookup(Cells(i, \"G\"), Sheets(\"Category\").Range(\"A2:H60\"), 6, False)\n    'Set calData = Worksheets(\"Calendar\").Range(\"R\" &amp; i)\n    'add = \"G:\\Engineering\\Engineering trainees (HUG)\\Etalonnage\\Proc\u00e9dures calibration\\\" &amp; Data\n        'With Worksheets(\"Calendar\")\n        '.Hyperlinks.add Anchor:=.Range(\"R\" &amp; i), _\n        'Address:=add, _\n        'TextToDisplay:=Data\n        'End With\n    Range(\"S\" &amp; i).Value = Application.VLookup(Cells(i, \"G\"), Sheets(\"Category\").Range(\"A2:H60\"), 7, False)\n    Range(\"T\" &amp; i).Value = Application.VLookup(Cells(i, \"G\"), Sheets(\"Category\").Range(\"A2:H60\"), 8, False)\n End If\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "events"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1481658235, "post_id": 41129254, "comment_id": 69462473, "body": "set it as a module variable where my sub is private myStruct as xyz then assign and use. use structCalculateDateValues  as a function with a return of your struct also maybe"}, {"owner": {"reputation": 1378, "user_id": 2778405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/704439289/picture?type=large", "display_name": "Jamie Marshall", "link": "https://stackoverflow.com/users/2778405/jamie-marshall"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1481658831, "post_id": 41129254, "comment_id": 69462809, "body": "If I understand this you are suggesting that I recalculate my Struct in the event handler.  This is easy to do yes, and my struct is a module set up like you suggest.  However, i&#39;d like to save my  processor the effort if possible.  Essentially i&#39;d be duplicating work (if I&#39;m understanding you here)."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1481659081, "post_id": 41129254, "comment_id": 69462967, "body": "so just use it, if you have private struct at the top, then you can use in current"}], "answers": [{"comments": [{"owner": {"reputation": 1378, "user_id": 2778405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/704439289/picture?type=large", "display_name": "Jamie Marshall", "link": "https://stackoverflow.com/users/2778405/jamie-marshall"}, "edited": false, "score": 0, "creation_date": 1481662284, "post_id": 41129971, "comment_id": 69464756, "body": "Won&#39;t a global or module level variable be lost to garbage collection?  I believe in VBA after my Main Sub ends the references are released and all variables are garbage collected, correct?  Also, I don&#39;t have free rein with the event handlers concerning a continuous form.  They are in a separate module inside their own access object."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1378, "user_id": 2778405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/704439289/picture?type=large", "display_name": "Jamie Marshall", "link": "https://stackoverflow.com/users/2778405/jamie-marshall"}, "edited": false, "score": 0, "creation_date": 1481662352, "post_id": 41129971, "comment_id": 69464793, "body": "VBA does no garbage collection, it&#39;s reference-counted, and it won&#39;t &quot;reset&quot; until the <code>End</code> keyword is encountered or your macro bursts into flames."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1378, "user_id": 2778405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/704439289/picture?type=large", "display_name": "Jamie Marshall", "link": "https://stackoverflow.com/users/2778405/jamie-marshall"}, "edited": false, "score": 1, "creation_date": 1481662811, "post_id": 41129971, "comment_id": 69465006, "body": "@JamieMarshall note: by <code>End</code> I mean the actual <code>End</code> instruction, not the <code>End</code> part of the <code>End Sub</code> token. As long as the host application is alive, module variables live, unless you kill &#39;em with the <code>End</code> nuke."}, {"owner": {"reputation": 1378, "user_id": 2778405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/704439289/picture?type=large", "display_name": "Jamie Marshall", "link": "https://stackoverflow.com/users/2778405/jamie-marshall"}, "edited": false, "score": 0, "creation_date": 1481668369, "post_id": 41129971, "comment_id": 69467735, "body": "Your solution works!  I&#39;m surprised.  What references still exist to keep a variable alive where there is no code execution within the module?  Thanks by the way."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1378, "user_id": 2778405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/704439289/picture?type=large", "display_name": "Jamie Marshall", "link": "https://stackoverflow.com/users/2778405/jamie-marshall"}, "edited": false, "score": 0, "creation_date": 1481668483, "post_id": 41129971, "comment_id": 69467777, "body": "It&#39;s just &quot;there&quot;, sitting in global space - the execution context remains &quot;alive&quot; until you kill it with <code>End</code> (either in code or in the immediate pane - not sure pressing the &#39;Stop&#39; button does the same, but it&#39;s possible), or until the host application exits."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1506030027, "last_edit_date": 1506030027, "creation_date": 1481660718, "answer_id": 41129971, "question_id": 41129254, "link": "https://stackoverflow.com/questions/41129254/passing-variable-to-vba-event-handler-after-execution/41129971#41129971", "title": "Passing variable to VBA event handler after execution", "body": "<p>You need a <em>module-level</em> variable. That way you can access it from anywhere within the module:</p>\n\n<pre><code>Option Explicit\nPrivate MyValue As MyValueType '&lt;---\n\nPrivate Sub Some_ParameterlessEventHandler()\n    MyValue.SomeMember = 42\nEnd Sub\n\nPrivate Sub SomeProcedureThatRunsAfterTheHandler()\n    Debug.Print MyValue.SomeMember 'outputs 42\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1378, "user_id": 2778405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/704439289/picture?type=large", "display_name": "Jamie Marshall", "link": "https://stackoverflow.com/users/2778405/jamie-marshall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 726, "favorite_count": 0, "accepted_answer_id": 41129971, "answer_count": 1, "score": 0, "last_activity_date": 1506030027, "creation_date": 1481658036, "question_id": 41129254, "link": "https://stackoverflow.com/questions/41129254/passing-variable-to-vba-event-handler-after-execution", "title": "Passing variable to VBA event handler after execution", "body": "<p>How do I pass a variable to an event in VBA, when the event occurs after execution of my method/sub?</p>\n\n<p>In Detail:</p>\n\n<pre><code>'My Sub''''''''''''''''''''''''''\nPrivate Sub mySub()\n   structCalculateDateValues 'calculates a number of dates that I want to be unlocked on my form\n   fnCreateTable  'create a table will all dates form my database\nEnd Sub\n\n'Event handler for continous form'''''''''''''''\nPrivate Sub Form_Current()\n   'Some code to get the value of my Struct - structCalculateDateValues\n   'Lock records that do not fall within of the date parameters of the values in structCalculateDateValues \nEnd Sub\n</code></pre>\n\n<p>The concept here is I want a form to show a record for all dates in a temp table, but only allow some of those records to be editable. This takes place in MS Access 2013.  The way I have it set up is:</p>\n\n<ol>\n<li>Create a struct containing all date calculation</li>\n<li>Load values into temp table based on those calculations</li>\n<li>A continuous form that is bound to that table already exists</li>\n<li>Execution would normally end here</li>\n<li>As the form open it triggers the Form_Current Event Handler</li>\n<li>Pass struct values to that handler somehow??????</li>\n</ol>\n\n<p>This is more a question of efficiency than anything else and a big question is how that event is triggered. I also want to avoid an answer that results in me writing my struct member values to the database (would be a cop-out).  I think there has to be a way in VBA to pause execution to detect an event right? </p>\n\n<p>Thanks, </p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1481657300, "post_id": 41128998, "comment_id": 69461945, "body": "If you include the code that is causing you problems, we might be able to help you fix it.  Without your code, we would have to start from scratch, which would make the question &quot;too broad&quot; and it will get closed very quickly."}, {"owner": {"reputation": 13, "user_id": 7292777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ded1f14488a31f36f1df1af146d6666?s=128&d=identicon&r=PG&f=1", "display_name": "squarelyjc", "link": "https://stackoverflow.com/users/7292777/squarelyjc"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481660502, "post_id": 41128998, "comment_id": 69463728, "body": "Thank you for your reply - I have updated my original question."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1481660857, "post_id": 41128998, "comment_id": 69463936, "body": "I don&#39;t know if that is enough to help. You&#39;ve given formula with no example data, no example output, and read your question text: how likely do you think it is that <i>anyone</i>, anywhere knows what you mean by: <i>Summary table in excel - show specific columns, sorted by date, conditional on column data, and limited to 5 results - VBA, Formula, or other?</i> (and further, how well does that question title actually describe, concisely, your specific problem, which seems to be the sorting of the data?  hint: it doesn&#39;t)."}, {"owner": {"reputation": 13, "user_id": 7292777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ded1f14488a31f36f1df1af146d6666?s=128&d=identicon&r=PG&f=1", "display_name": "squarelyjc", "link": "https://stackoverflow.com/users/7292777/squarelyjc"}, "edited": false, "score": 0, "creation_date": 1481662559, "post_id": 41128998, "comment_id": 69464890, "body": "Updated the question. Hopefully there is enough information now."}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1481666681, "post_id": 41128998, "comment_id": 69466984, "body": "Hi. Is the Power query addin by MS out of question?"}, {"owner": {"reputation": 13, "user_id": 7292777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ded1f14488a31f36f1df1af146d6666?s=128&d=identicon&r=PG&f=1", "display_name": "squarelyjc", "link": "https://stackoverflow.com/users/7292777/squarelyjc"}, "edited": false, "score": 0, "creation_date": 1481732832, "post_id": 41128998, "comment_id": 69497332, "body": "It is not - I am installing it now, though I have never used it."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7292777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ded1f14488a31f36f1df1af146d6666?s=128&d=identicon&r=PG&f=1", "display_name": "squarelyjc", "link": "https://stackoverflow.com/users/7292777/squarelyjc"}, "edited": false, "score": 0, "creation_date": 1481744344, "post_id": 41148009, "comment_id": 69503746, "body": "This looks great - one question I do have, though, is do I have to manually refresh the query every time a change is made to the source data?"}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "reply_to_user": {"reputation": 13, "user_id": 7292777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ded1f14488a31f36f1df1af146d6666?s=128&d=identicon&r=PG&f=1", "display_name": "squarelyjc", "link": "https://stackoverflow.com/users/7292777/squarelyjc"}, "edited": false, "score": 0, "creation_date": 1481744575, "post_id": 41148009, "comment_id": 69503861, "body": "That is correct. The result will update only on refresh."}, {"owner": {"reputation": 13, "user_id": 7292777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ded1f14488a31f36f1df1af146d6666?s=128&d=identicon&r=PG&f=1", "display_name": "squarelyjc", "link": "https://stackoverflow.com/users/7292777/squarelyjc"}, "edited": false, "score": 0, "creation_date": 1481752317, "post_id": 41148009, "comment_id": 69507767, "body": "I was able to get it to auto-refresh every 1 minute by going to &#39;Data, Connections&#39; and changing the properties. This works for my purposes. Thanks for your help!"}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "reply_to_user": {"reputation": 13, "user_id": 7292777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ded1f14488a31f36f1df1af146d6666?s=128&d=identicon&r=PG&f=1", "display_name": "squarelyjc", "link": "https://stackoverflow.com/users/7292777/squarelyjc"}, "edited": false, "score": 0, "creation_date": 1481782209, "post_id": 41148009, "comment_id": 69516364, "body": "Glad to be of help. Yes, right! I forgot that you can do that. I see you are a fast learner, well done."}], "tags": [], "owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "is_accepted": true, "score": 0, "last_activity_date": 1481734692, "last_edit_date": 1481734692, "creation_date": 1481734341, "answer_id": 41148009, "question_id": 41128998, "link": "https://stackoverflow.com/questions/41128998/how-can-i-prevent-tables-from-being-effected-when-sorting-source-data/41148009#41148009", "title": "How can I prevent tables from being effected when sorting source data?", "body": "<p>We can use <a href=\"https://support.office.com/en-us/article/Introduction-to-Microsoft-Power-Query-for-Excel-6e92e2f4-2079-4e1f-bad5-89f6269cd605\" rel=\"nofollow noreferrer\">Power Query addin by MS</a> to achieve desired result, and it's fairly easy.  </p>\n\n<p>Let consider such raw data (the source table, yours has 10 columns, mine 5 but the idea is the same).<br>\n<a href=\"https://i.stack.imgur.com/MzRbm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MzRbm.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now we use the power query. Put cursor into the table and choose Create query from table.  </p>\n\n<p>In Excel 2016 you get this (with just maybe 2 steps in the \"APPLIED STEPS\" pane on bottom right. Additional steps will appear as soon as you apply filter and sort and other steps.):<br>\n<a href=\"https://i.stack.imgur.com/aDLnc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aDLnc.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now you need to \"teach\" the query what to do each time it gets refreshed.\nI chose these steps:  </p>\n\n<ol>\n<li>Filter the Completed tasks, so only FALSE remained.<br>\n<a href=\"https://i.stack.imgur.com/KUSbU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KUSbU.png\" alt=\"enter image description here\"></a></li>\n<li>Sorted the Due Date from A-Z. You should do this EXPLICITLY, even if the source data is already sorted in the right order. Remember, we are teaching the query, what to do each time it gets refreshed.\n<a href=\"https://i.stack.imgur.com/oMXqP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oMXqP.png\" alt=\"enter image description here\"></a></li>\n<li>Removed unnecessary columns (Complete, Lead). Note, the filter still applies, even if you remove them from query.\n<a href=\"https://i.stack.imgur.com/Gk3MO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Gk3MO.png\" alt=\"enter image description here\"></a></li>\n<li>Find \"Keep rows\" and set it to 5 max.\n<a href=\"https://i.stack.imgur.com/ISX18.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ISX18.png\" alt=\"enter image description here\"></a></li>\n</ol>\n\n<p>The result looks like this:<br>\n<a href=\"https://i.stack.imgur.com/Dxhrm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Dxhrm.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 13, "user_id": 7292777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ded1f14488a31f36f1df1af146d6666?s=128&d=identicon&r=PG&f=1", "display_name": "squarelyjc", "link": "https://stackoverflow.com/users/7292777/squarelyjc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 2, "accepted_answer_id": 41148009, "answer_count": 1, "score": -1, "last_activity_date": 1481734692, "creation_date": 1481657055, "last_edit_date": 1531161705, "question_id": 41128998, "link": "https://stackoverflow.com/questions/41128998/how-can-i-prevent-tables-from-being-effected-when-sorting-source-data", "title": "How can I prevent tables from being effected when sorting source data?", "body": "<p>I have a table with 10 columns for project management. Each row represents a task to be completed. I would like to summarize this information on a dashboard (same workbook, different sheet). The summary will show the 'Next 5 Tasks' (including overdue tasks) that are NOT marked complete (Cell values with 'No' in column 9 of the source table). The only three columns I want to show are End Date, Project, and Task (8, 1, 2), in this order. The rows should be ordered by the SOONEST end date first, then the next, etc. If the tasks are overdue, they should appear first, with the oldest due date appearing first.</p>\n\n<p>However, if I change the way the source table is sorted, the newly created 'summary table' as I am calling it, is also sorted. I do not want this to happen.</p>\n\n<p>The columns in my original table (Table 1133) are (in this order):<br>\nProject | Task | Category | Priority | Owner | Effort | Start Date | End Date | Complete? | Notes</p>\n\n<p>In my summary table, I am using these formulas to pull in the information I want:</p>\n\n<p>Column 1 - Due Date:<br>\n    <code>=INDEX('Master Task List'!B6:L31,MATCH(\"No\",Table1133[Complete?],0),8)</code></p>\n\n<p>Column 2 - Project:<br>\n    <code>=INDEX('Master Task List'!B6:L31,MATCH(\"No\",Table1133[Complete?],0),1)</code></p>\n\n<p>Column 3 - Task:<br>\n    <code>=INDEX('Master Task List'!B6:L31,MATCH(\"No\",Table1133[Complete?],0),2)</code></p>\n\n<p>The output is this:  </p>\n\n<p>Due Date | Project | Task<br>\n12/12 | Marketing | Design the brochure<br>\n12/13 | Administrative | Complete expenses for Q1<br>\n12/15 | Secret Project | Secure meeting location<br>\n12/15 | Travel Overhaul | Write RFP for local agencies<br>\n12/31 | Branding Campaign | Send email to media contacts    </p>\n\n<p>I would like the data to stay this way, no matter how the original table gets sorted. However, the dates in this newly created table are rearranged in my if the sorting in the source table changes.</p>\n\n<p>Is there a way to prevent my summary table from being effected by sorting the original data? Or is there a better way to accomplish this?</p>\n"}, {"tags": ["vba", "excel", "user-defined-functions"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 5, "creation_date": 1481656116, "post_id": 41128718, "comment_id": 69461361, "body": "<a href=\"http://stackoverflow.com/posts/41128718/edit\">Please edit your question to include the relevant code</a>.  Not many people are going to (should) download and open a random macro enabled Excel file, and assuming they would, this question doesn&#39;t help anyone else with a similar issue if the link goes dead."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1481656123, "post_id": 41128718, "comment_id": 69461366, "body": "There are many that will not download a macro enabled workbook from a public forum.  Please include the code and describe how you are using it in the Original post."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 5, "creation_date": 1481656197, "post_id": 41128718, "comment_id": 69461400, "body": "I&#39;m not downloading your macro-enabled virus, and nobody should. That&#39;s not how this site works."}, {"owner": {"reputation": 76, "user_id": 7269695, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xYV8e.png?s=128&g=1", "display_name": "Firefighter1017", "link": "https://stackoverflow.com/users/7269695/firefighter1017"}, "edited": false, "score": 0, "creation_date": 1481657044, "post_id": 41128718, "comment_id": 69461797, "body": "Thanks all, makes a lot of sense.  I just updated the post with relevant info.  Let me know if I should post more."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1481657132, "post_id": 41128718, "comment_id": 69461854, "body": "At this point it might be a better idea to delete this question, read the <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask</a> page, and ask it again, this time including all the relevant info on the first go. :)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481657139, "post_id": 41128718, "comment_id": 69461858, "body": "I think you will need to include the code of the function, not just show how it is called."}, {"owner": {"reputation": 76, "user_id": 7269695, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xYV8e.png?s=128&g=1", "display_name": "Firefighter1017", "link": "https://stackoverflow.com/users/7269695/firefighter1017"}, "edited": false, "score": 0, "creation_date": 1481657631, "post_id": 41128718, "comment_id": 69462129, "body": "Thanks YowE3K, I realized that right after I posted the update."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481661276, "post_id": 41128718, "comment_id": 69464149, "body": "I&#39;m scratching my head now - I wouldn&#39;t have thought that a UDF would have been able to insert new data into a table.  Maybe this is another loophole that <b>does</b> allow a UDF to update more than the current cell."}, {"owner": {"reputation": 76, "user_id": 7269695, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xYV8e.png?s=128&g=1", "display_name": "Firefighter1017", "link": "https://stackoverflow.com/users/7269695/firefighter1017"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481661693, "post_id": 41128718, "comment_id": 69464416, "body": "@YowE3K: It might explains all the crashes I experience and loosing  input parameter&#39;s value during execution...  Excel is really surprising these days... In all means possible!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1481661699, "post_id": 41128718, "comment_id": 69464422, "body": "Yes I&#39;m amazed if that works at all as a UDF.  As for multiple executions - that is not uncommon and is covered by Charles Williams here: <a href=\"http://www.decisionmodels.com/calcsecretsj.htm\" rel=\"nofollow noreferrer\">decisionmodels.com/calcsecretsj.htm</a>"}, {"owner": {"reputation": 76, "user_id": 7269695, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xYV8e.png?s=128&g=1", "display_name": "Firefighter1017", "link": "https://stackoverflow.com/users/7269695/firefighter1017"}, "edited": false, "score": 0, "creation_date": 1481661914, "post_id": 41128718, "comment_id": 69464550, "body": "Can you please reopen the question?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481661937, "post_id": 41128718, "comment_id": 69464565, "body": "I just tried running it with your sample table.  I had to modify <code>&quot;table_Sequence_1[Letter]&quot;</code> to <code>&quot;table_Sequence[Letter]&quot;</code> before it would work.  (I assume the table is called <code>table_Sequence</code>.)  The code ran once and returned <code>&quot;B&quot;</code>."}, {"owner": {"reputation": 76, "user_id": 7269695, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xYV8e.png?s=128&g=1", "display_name": "Firefighter1017", "link": "https://stackoverflow.com/users/7269695/firefighter1017"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1481662081, "post_id": 41128718, "comment_id": 69464638, "body": "@Tim Williams: What would be a good practice to achieve this without using a UDF?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481662247, "post_id": 41128718, "comment_id": 69464741, "body": "FWIW - The code that I suspected would kill a UDF can&#39;t actually be executed - <code>If tbl.ListRows.Count = 0 Then</code> is preceded by a statement which accesses <code>tbl.ListRows(1)</code> so that statement would crash before the <code>If</code> block could be executed.  (I&#39;m rather surprised that the <code>Sort</code> works but I guess that is somewhat acceptable behaviour.)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1481662666, "post_id": 41128718, "comment_id": 69464945, "body": "@Firefighter1017 - if the code &quot;works&quot; you can call it from a Sub as long as you can create a suitable trigger (a button or maybe an event) to kick off the sub."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481663796, "post_id": 41128718, "comment_id": 69465512, "body": "You use <code>Field3</code> in one of your filters - it should be <code>Field2</code>.  And <code>suffix = tbl.ListRows(1).Range.Cells(1, 3).Value</code> doesn&#39;t return the first <b>visible</b> row (so you will always be returning <code>&quot;B&quot;</code> at the moment)."}, {"owner": {"reputation": 76, "user_id": 7269695, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xYV8e.png?s=128&g=1", "display_name": "Firefighter1017", "link": "https://stackoverflow.com/users/7269695/firefighter1017"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481670053, "post_id": 41128718, "comment_id": 69468320, "body": "@YowE3K: Just stumbled upon this last statement of yours... I guess I&#39;ll have to figure out how I can determine if the filters have selected any rows.  Thanks, I didn&#39;t figure this one out until I read and understood what you were saying"}], "answers": [{"comments": [{"owner": {"reputation": 76, "user_id": 7269695, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xYV8e.png?s=128&g=1", "display_name": "Firefighter1017", "link": "https://stackoverflow.com/users/7269695/firefighter1017"}, "edited": false, "score": 0, "creation_date": 1496588934, "post_id": 41200496, "comment_id": 75712981, "body": "Oh, and thanks for those who voted negative, it really gives me a sense that my contribution counts.  ... not really..."}], "tags": [], "owner": {"reputation": 76, "user_id": 7269695, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xYV8e.png?s=128&g=1", "display_name": "Firefighter1017", "link": "https://stackoverflow.com/users/7269695/firefighter1017"}, "is_accepted": false, "score": 0, "last_activity_date": 1481990880, "creation_date": 1481990880, "answer_id": 41200496, "question_id": 41128718, "link": "https://stackoverflow.com/questions/41128718/excel-vba-udf-executing-3-times-when-used-in-formula/41200496#41200496", "title": "excel vba UDF executing 3 times when used in formula", "body": "<p>For those needing closure on this issue, </p>\n\n<p>I gave up trying to use a UDF to retreive proper code.\nI simply created triggers on WorkSheet.Change and WorkSheet.BeforeDoubleClick events.</p>\n\n<p>If you need me to post the code and data let me know.</p>\n\n<p>Thanks YowE3K and Tom Williams for their help.</p>\n"}], "owner": {"reputation": 76, "user_id": 7269695, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xYV8e.png?s=128&g=1", "display_name": "Firefighter1017", "link": "https://stackoverflow.com/users/7269695/firefighter1017"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1481990880, "creation_date": 1481655957, "last_edit_date": 1531164843, "question_id": 41128718, "link": "https://stackoverflow.com/questions/41128718/excel-vba-udf-executing-3-times-when-used-in-formula", "title": "excel vba UDF executing 3 times when used in formula", "body": "<p>I would like to know how I can prevent my UDF to execute 3 times when used as a formula.</p>\n\n<p>Excel 2013 (build: 15.0.4859.1002)</p>\n\n<p>I built a User defined Function that must validate a set of two values against an excel ListObject named \"table_Sequence\".\nIf the values exist, the function returns the corresponding letter.</p>\n\n<p>So basically, I'm trying to create a tool that will help us build our SAP FLOC structure based on certain rules.  One of which, Level 5 is 3 digits code that contains a reference number that comes from tab \"5- Function list\" and a unique letter for every Customtext entered in tab Equipements, column 'M'.</p>\n\n<p>So my idea was to first check if the key already exist, and if not, create it in table_Sequence.</p>\n\n<p>The code works fine.</p>\n\n<p>But...  <strong>It runs three times every time I update a cell using that UDF</strong>!!!\nSo I am afraid that if a user wants to copy this formula throughout the column it will create a terrible lag whenever dependencies are updated.</p>\n\n<p>Can someone help me understand what's going on and how I can prevent this?</p>\n\n<p>Any help will be appreciated,</p>\n\n<p>table_Sequence looks like this:</p>\n\n<pre><code>Struct             |CustomText  |Letter\n----------------   |------      |---\n2151-05-01-22-23   |#1 L1       |B\n2151-05-01-22-86   |#2 L1       |A\n</code></pre>\n\n<p>So in a cell I call the UDF like this:</p>\n\n<pre><code>=GetNextSequence(\"2151-05-01-22-23\";\"#1 L1\")\n</code></pre>\n\n<p>And it returns \"B\" which is good.\nOnly it executes 3 times before it gets the result back</p>\n\n<p>Here's the UDF code:</p>\n\n<pre><code>'**************************************************************************************************\n'**     Name:       GetNextSequence\n'**     Purpose:    Assign next sequence for current structure element\n'**\n'**     Input:      Current Cell\n'**                 Level Number at which we may stop the structure\n'**\n'**     Output:     Sequence string\n'**\n'**************************************************************************************************\nPublic Function GetNextSequence(Struct As String, CustomText As String) As String\n\nDim i As Long\nDim Result As Variant\nDim suffix As String\nDim NewRow As Range\nDim tbl As ListObject\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\n\n'** Filter and sort sequence table\nSet tbl = ActiveWorkbook.Worksheets(\"Sequence\").ListObjects(\"table_Sequence\")\ntbl.Sort.SortFields.Clear\ntbl.Sort.SortFields.Add Key:=Range(\"table_Sequence_1[Letter]\"), SortOn:= _\n    xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\nWith tbl.Sort\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\ntbl.Range.AutoFilter Field:=1, Criteria1:=Struct\ntbl.Range.AutoFilter Field:=3, Criteria1:=CustomText\n'** Store Last letter used\nsuffix = tbl.ListRows(1).Range.Cells(1, 3).Value\n\nIf tbl.ListRows.Count = 0 Then\n    '** Increment sequence\n    suffix = Chr(Asc(suffix) + 1)\n    '** Add row and return new letter\n    Set NewRow = tbl.ListRows.Add.Range\n    iColumn = tbl.ListColumns(\"Letter\").Index\n    NewRow.Cells(1, 3).Value = suffix\n    NewRow.Cells(1, 1).Value = Struct\n    NewRow.Cells(1, 2).Value = CustomText\n\nEnd If\n\nGetNextSequence = suffix\n\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1009, "user_id": 544982, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/1867244bd7ca26507df93c7f6407e26b?s=128&d=identicon&r=PG", "display_name": "p0tta", "link": "https://stackoverflow.com/users/544982/p0tta"}, "edited": false, "score": 0, "creation_date": 1481656709, "post_id": 41128826, "comment_id": 69461640, "body": "Works like a charm now! Thanks! :)"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 2, "last_activity_date": 1481656359, "creation_date": 1481656359, "answer_id": 41128826, "question_id": 41128649, "link": "https://stackoverflow.com/questions/41128649/dynamically-select-the-number-of-columns-to-copy-over-to-another-sheet-in-excel/41128826#41128826", "title": "Dynamically select the number of columns to copy over to another sheet in excel macro", "body": "<p>Using your suggested approach, you could specify the range of columns as <code>.Columns(\"A:E\")</code> so:</p>\n\n<pre><code>e.Rows(d).Columns(\"A:E\").Value = i.Rows(j).Columns(\"A:E\").Value\n</code></pre>\n"}], "owner": {"reputation": 1009, "user_id": 544982, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/1867244bd7ca26507df93c7f6407e26b?s=128&d=identicon&r=PG", "display_name": "p0tta", "link": "https://stackoverflow.com/users/544982/p0tta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 356, "favorite_count": 0, "accepted_answer_id": 41128826, "answer_count": 1, "score": 2, "last_activity_date": 1481656554, "creation_date": 1481655741, "last_edit_date": 1481656554, "question_id": 41128649, "link": "https://stackoverflow.com/questions/41128649/dynamically-select-the-number-of-columns-to-copy-over-to-another-sheet-in-excel", "title": "Dynamically select the number of columns to copy over to another sheet in excel macro", "body": "<p>So I have 2 sheets in my Excel file and I am trying to copy only some columns (say 5) to the second sheet. How do I do that? Here is my VBA code</p>\n\n<pre><code>Sub button_click()\n   Set i = Sheets(\"Sheet1\")\n   Set e = Sheets(\"Sheet2\")\n   Dim d\n   Dim j\n   d = 1\n   j = 13\n\n   Do Until IsEmpty(i.Range(\"K\" &amp; j))\n\n   If i.Range(\"K\" &amp; j) = \"Y\" Then\n   d = d + 1\n   e.Rows(d).Value = i.Rows(j).Value\n\n   End If\n   j = j + 1\n   Loop\nEnd Sub\n</code></pre>\n\n<p>So this works right now but the only thing I need changed is, there are about 10 columns but I only want the first 5 to copy over. If I use Columns in addition to the Rows like i.Rows(j).Columns(5).Value it only copies 1 column. I am not sure how to copy all the columns that I need. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 2, "creation_date": 1481656656, "post_id": 41128633, "comment_id": 69461620, "body": "If a cell has a date in it, use this to return the three letter month into your variable: <code>Format(Cells(300, 10), &quot;MMM&quot;)</code>"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1481656670, "post_id": 41128633, "comment_id": 69461624, "body": "Use the Format function Format(&lt;date&gt;, &quot;MMM&quot;)"}, {"owner": {"reputation": 9, "user_id": 6879759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd9f821a6c43125c1b70e30321d7326?s=128&d=identicon&r=PG&f=1", "display_name": "Kisheon", "link": "https://stackoverflow.com/users/6879759/kisheon"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1481661770, "post_id": 41128633, "comment_id": 69464453, "body": "Oh yes! thank you @tigeravatar  simple fix"}], "owner": {"reputation": 9, "user_id": 6879759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd9f821a6c43125c1b70e30321d7326?s=128&d=identicon&r=PG&f=1", "display_name": "Kisheon", "link": "https://stackoverflow.com/users/6879759/kisheon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1481655677, "creation_date": 1481655677, "question_id": 41128633, "link": "https://stackoverflow.com/questions/41128633/vba-read-text-of-date-as-displayed", "title": "VBA - Read Text of Date as Displayed", "body": "<p>I want to read the text part of the date as it is displayed to compare it else where. The date is formatted in the cell to show as \"19 Dec\" which is the formatted version for \"12/19/2016\". How can I be able to read just \"Dec\" in text? I am writing this to read from an external workbook and I do not have control of that workbook's format. I have part of the code below. The two main lines I am dealing with are \"Alpha...\" and \"Omega...\" I have also thought of doing it another way using that commented line of code starting with \"ActiveSheet.Range...\" Any help will be appreciated. Thanks. </p>\n\n<pre><code>Sub DataImport()\n   Workbooks.Open \"\\\\Issues\\Inventory\\PA2016.xlsx\"\nWorksheets(\"Total Year\").Activate\nAlpha = Right(Cells(300, 10), 3)\nOmega = Right(Cells(600, 10), 3)\n\n'ActiveSheet.Range(Right(Cells(300, 10), 3), Right(Cells(600, 10), 3)).Select\n\nDebug.Print Alpha\nDebug.Print Omega\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1481655488, "post_id": 41128568, "comment_id": 69461018, "body": "There may be other issues but you are missing an ampersand after the &#39;a&#39;."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1481655830, "post_id": 41128568, "comment_id": 69461206, "body": "<code>Path = &quot;C:\\Users\\Pudge\\Desktop\\Report\\Scorecard\\&quot; &amp; a &amp; &quot;\\Scorecard.xlsx&quot;</code>"}, {"owner": {"reputation": 189, "user_id": 5656327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ahQ4O.png?s=128&g=1", "display_name": "Worst SQL Noob", "link": "https://stackoverflow.com/users/5656327/worst-sql-noob"}, "edited": false, "score": 0, "creation_date": 1481656736, "post_id": 41128568, "comment_id": 69461665, "body": "Now a geta compile error: syntax error for this path"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1481711219, "post_id": 41128568, "comment_id": 69483152, "body": "Are you entering the date as, for example, <code>12&#47;12&#47;2016</code>.  The slash is illegal in paths.  Check your date is valid and then format as <code>dd-mmm-yyyy</code> - or any variation that doesn&#39;t include illegal characters.  Saying that... just realised <code>a</code> is a long so is holding a number. <a href=\"http://stackoverflow.com/questions/1976007/what-characters-are-forbidden-in-windows-and-linux-directory-names\" title=\"what characters are forbidden in windows and linux directory names\">stackoverflow.com/questions/1976007/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 330, "user_id": 7291399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUn81.jpg?s=128&g=1", "display_name": "Scarfe", "link": "https://stackoverflow.com/users/7291399/scarfe"}, "is_accepted": true, "score": 0, "last_activity_date": 1481707736, "creation_date": 1481707736, "answer_id": 41139029, "question_id": 41128568, "link": "https://stackoverflow.com/questions/41128568/how-to-use-varible-to-control-the-path-for-the-workbook-in-vba/41139029#41139029", "title": "How to use varible to control the path for the workbook in VBA", "body": "<p>Firstly, there is an issue with your <code>Path</code> variable that has been solved above. I have mentioned that for the sake of providing a complete solution.</p>\n\n<p>There is a spelling mistake at the beginning of your macro; you have dimensioned <code>Templete</code> but later referred to <code>Template</code>.</p>\n\n<p>I believe your main issue most likely lies with your variable <code>a</code>. It is probably causing an incorrect / invalid path reference. There is no need to dimension this as <code>Long</code>; since you are concatenating it with other strings it is more logical to use <code>String</code>.</p>\n\n<p>Please see the example code below:</p>\n\n<pre><code>Sub Scorecard()\nDim Target_Workbook, Template As Workbook\nDim Path, a As String\na = InputBox(Prompt:=\"Week End Date:\", Title:=\"Enter Your Week End Date\")\nPath = \"C:\\Users\\Pudge\\Desktop\\Report\\Scorecard\\\" &amp; a &amp; \"\\Scorecard.xlsx\"\nSet Target_Workbook = Workbooks.Open(Path)\nSet Template = ThisWorkbook\nEnd Sub\n</code></pre>\n\n<p>Whilst I have not tested the above code, it <em>should</em> work. Experiment with alternative inputs; try using simple numbers to start with, and verify that the path is correct.</p>\n\n<p>If that works, but your chosen application doesn't, there is likely an issue with your user input.</p>\n"}], "owner": {"reputation": 189, "user_id": 5656327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ahQ4O.png?s=128&g=1", "display_name": "Worst SQL Noob", "link": "https://stackoverflow.com/users/5656327/worst-sql-noob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 41139029, "answer_count": 1, "score": 0, "last_activity_date": 1481707736, "creation_date": 1481655425, "question_id": 41128568, "link": "https://stackoverflow.com/questions/41128568/how-to-use-varible-to-control-the-path-for-the-workbook-in-vba", "title": "How to use varible to control the path for the workbook in VBA", "body": "<p>I met a problem when I want to write a VBA to copy the data from a specific path to another workbook</p>\n\n<pre><code>Sub Scorecard()\nDim Target_Workbook As Workbook\nDim Templete As Workbook\nDim Path As String\nDim a As Long\na = InputBox(Prompt:=\"Week End Date:\", _\n          Title:=\"Enter Your Week End Date \", Default:=\"\")\nPath = \"C:\\Users\\Pudge\\Desktop\\Report\\Scorecard\\\"&amp;a\"\\Scorecard.xlsx\"\nSet Target_Workbook = Workbooks.Open(Path)\nSet Template = ThisWorkbook\nEnd Sub\n</code></pre>\n\n<p>I want to use the variable a to direct the path go different folder based on the a I provided;</p>\n\n<p>Since In the folder Scorecard, there are many sub folders with name for example 1, 2,3,4,5; so what I want to do is if I give the vaule 1 for a, let go to open the scorecard.xlsx in the folder 1.</p>\n\n<p>But it keeps give me compile error..</p>\n\n<p>Please offer me a help if you have any idea.</p>\n\n<p>Thx\nPudge</p>\n"}, {"tags": ["vba", "excel", "oledbconnection"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481655764, "post_id": 41128564, "comment_id": 69461168, "body": "Give <code>Extended Properties=&quot;EXCEL 8.0;HDR=YES;Mode=Read;ReadOnly=True;</code> in your connection string a shot."}, {"owner": {"reputation": 45, "user_id": 6465008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d1876ad046b3a5d2a3a212369c50a4?s=128&d=identicon&r=PG&f=1", "display_name": "tibz64", "link": "https://stackoverflow.com/users/6465008/tibz64"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481656398, "post_id": 41128564, "comment_id": 69461484, "body": "I&#39;ve just tried and it doesn&#39;t resolve the issue... My datasource xlsm excel file still opens as read only in a new instance of excel when I launch the connection...."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1481656809, "post_id": 41128564, "comment_id": 69461704, "body": "<i>off-topic</i> : why do you need to have two different providers?"}, {"owner": {"reputation": 45, "user_id": 6465008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d1876ad046b3a5d2a3a212369c50a4?s=128&d=identicon&r=PG&f=1", "display_name": "tibz64", "link": "https://stackoverflow.com/users/6465008/tibz64"}, "edited": false, "score": 0, "creation_date": 1481666383, "post_id": 41128564, "comment_id": 69466852, "body": "Any additional idea?"}, {"owner": {"reputation": 45, "user_id": 6465008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d1876ad046b3a5d2a3a212369c50a4?s=128&d=identicon&r=PG&f=1", "display_name": "tibz64", "link": "https://stackoverflow.com/users/6465008/tibz64"}, "edited": false, "score": 0, "creation_date": 1481666500, "post_id": 41128564, "comment_id": 69466905, "body": "Ash, i just import data from an another Excel Workook which compute data on a r&#233;al Time basis"}], "owner": {"reputation": 45, "user_id": 6465008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d1876ad046b3a5d2a3a212369c50a4?s=128&d=identicon&r=PG&f=1", "display_name": "tibz64", "link": "https://stackoverflow.com/users/6465008/tibz64"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 300, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1481655416, "creation_date": 1481655416, "last_edit_date": 1531164843, "question_id": 41128564, "link": "https://stackoverflow.com/questions/41128564/prevent-from-opening-excel-sheet-ridden-with-oledb-connection", "title": "Prevent from opening Excel sheet ridden with OLEDB Connection", "body": "<p>I am currently using OLEDB connection to import/data in excel workbook from an another workbook which is running on another computer. \nThe connection mode I use is 'adModeRead'. So far it worked well but since a few days I have been facing an issue :</p>\n\n<p>Eachtime I launch the import/update of the data it opens on my computer the data source excel workbook in read only mode. \nDo you know how I can prevent from opening the data source file on my computer? (I just want to import the data without open the excel file)</p>\n\n<p>Here under my code:</p>\n\n<pre><code>Public Sub GetExistingData()\nDim Cn As ADODB.Connection\nDim texte_SQL As String\nDim Rst As ADODB.Recordset\n\nSet Cn = New ADODB.Connection\n\n'--- Connection ---\nWith Cn\n    .Provider = \"Microsoft.Jet.OLEDB.4.0\"\n    .ConnectionString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" _\n        &amp; Folder &amp; \"\\\" MyDataSource.xlsm\";Extended Properties=\"\"Excel 12.0;HDR=YES;\"\"\"\n    .Mode = adModeRead\n    .Open\nEnd With\n\n\ntexte_SQL = \"SELECT * FROM [\" &amp; dataSheetName &amp; \"$]\"\n\nSet Rst = New ADODB.Recordset\nSet Rst = Cn.Execute(texte_SQL)\n</code></pre>\n"}]