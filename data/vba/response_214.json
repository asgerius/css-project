[{"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1550102946, "creation_date": 1550102946, "answer_id": 54681360, "question_id": 54681250, "link": "https://stackoverflow.com/questions/54681250/create-and-display-msgbox-and-output-array-contents-and-word-lengths-to-workshee/54681360#54681360", "title": "Create and display Msgbox and output array contents and word lengths to worksheet", "body": "<p>Example code not using Array. You just need to modify the loop to look at a variable index in array rather variable row in column loop. Then, the logic used below should be easily extended to your problem. </p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nSub Example()\n\nDim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"Sheet1\")\nDim LR As Long, i As Long\nDim MyString As String, MyCounter As Long, Arr\n\nLR = ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row\n\nFor i = 1 To LR\n    MyString = MyString &amp; ws.Range(\"A\" &amp; i) &amp; \", \"\n\n    If Len(ws.Range(\"A\" &amp; i)) &gt; 5 Then\n        MyCounter = MyCounter + 1\n    End If\nNext i\n\nMyString = Left(MyString, Len(MyString) - 2) 'Remove last \", \"\nArr = Split(MyString, \", \")\n\nMsgBox \"Total Words: \" &amp; UBound(Arr) + 1 &amp; vbNewLine &amp; \"Large Words: \" &amp; MyCounter\n\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/kEYLt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kEYLt.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 10510246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f1059aad0e4e1922b0322576f91b2bb?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/10510246/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550129023, "creation_date": 1550102059, "last_edit_date": 1550129023, "question_id": 54681250, "link": "https://stackoverflow.com/questions/54681250/create-and-display-msgbox-and-output-array-contents-and-word-lengths-to-workshee", "title": "Create and display Msgbox and output array contents and word lengths to worksheet", "body": "<p>I'm trying to create a Msgbox that displays all of the words in a column on a worksheet. Then create another message box with the count of the number of words along with words with greater than 5 characters. I'm not quite sure of how to create the Msgbox with the below variables so I would appreciate some help!</p>\n\n<p>So far I wrote a sub that imports a single line of text from a text file using GetOpenFilename. Then I used split to parse the file using a delimiter. </p>\n\n<p>The contents of the text file are as follows:</p>\n\n<p>Zags, Golden Eagles, Hawks, Peacocks, Greyhounds, Golden Griffens, Dons, Musketeers</p>\n\n<p>Below is the code I have so far:</p>\n\n<pre><code>Sub ImportTextFile()\n\nDim fileName As Variant     ' array will hold the file name or names to import\n\nDim i As Integer            ' counter for loops\nDim nLargeWords As Integer  ' counter for words longer than 5 characters\n\nDim dataLine As String      ' string to hold a single line of text from file\nDim lineCount As Integer\n\nDim arrWords() As String    ' array that will hold the contents of the text file\nDim msg As String           ' string for building the first message box\n\nConst delim = \",\"           ' Added a constant for the delimiter in Split function\n\nWith Range(\"Output_lbl\")\n         Range(.Offset(1, 1), .Offset(100, 2)).ClearContents\nEnd With\n\n'============Navigate to file location and get filename of text file\n\n\nfileName = Application.GetOpenFilename(, , \"Select a text file\", , False)       ' Used GetOpenFilename method to navigate to the file and obtain the file name.\n\n\n'============Import file into temp string variable then parse into an array\n\n\nOpen fileName For Input As #1       ' To open the text file.\n    i = 0\n    With Range(\"Output_lbl\")\n        Do Until EOF(1)\n\n            Line Input #1, dataLine             ' Setting the first line of the text file to a string variable.\n            arrWords() = Split(dataLine, delim)         ' Using Split to parse the file. The delimiter was determined to be \",\" which was declared a constant above.\n            For i = LBound(arrWords()) To UBound(arrWords())        ' Parse into an array.\n                .Offset(i, 0) = Trim(arrWords(i))\n            Next i\n            i = i + 1\n        Loop\n    End With\n\nClose #1                            ' To close the text file.\n\n\n'============Create and display the message boxes and output array contents and word lengths to the output sheet.\n\n\nEnd Sub\n</code></pre>\n\n<p>One message box should be formatted like this:</p>\n\n<p>Words in the file.</p>\n\n<pre><code>Zags\nGolden Eagles\nHawks\nPeacocks\nGreyhounds\nGolden Griffins\nDons\nMusketeers\n</code></pre>\n\n<p>The other message box should be formatted like this:</p>\n\n<p>Microsoft Excel</p>\n\n<pre><code>Total Words:    8\nLarge Words:    5\n</code></pre>\n"}, {"tags": ["excel", "vba", "radio-button", "activex", "form-control"], "answers": [{"tags": [], "owner": {"reputation": 77, "user_id": 10506130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a98fa88f983b228ebc579d726abd5f0?s=128&d=identicon&r=PG&f=1", "display_name": "T C", "link": "https://stackoverflow.com/users/10506130/t-c"}, "is_accepted": true, "score": 0, "last_activity_date": 1550102283, "creation_date": 1550102283, "answer_id": 54681273, "question_id": 54681175, "link": "https://stackoverflow.com/questions/54681175/how-to-add-a-form-control-optionbutton-in-vba-not-activex-optionbutton/54681273#54681273", "title": "How to add a form control-optionbutton in VBA (not ActiveX-optionbutton)?", "body": "<p>Hmpf...</p>\n\n<pre><code>Dim OptBtn As OptionButton\nSet OptBtn = ActiveSheet.OptionButtons.Add(580.5, 48.75, 72, 72)\n</code></pre>\n\n<p>seems to do the trick.</p>\n"}], "owner": {"reputation": 77, "user_id": 10506130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a98fa88f983b228ebc579d726abd5f0?s=128&d=identicon&r=PG&f=1", "display_name": "T C", "link": "https://stackoverflow.com/users/10506130/t-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 0, "accepted_answer_id": 54681273, "answer_count": 1, "score": 0, "last_activity_date": 1550102283, "creation_date": 1550101564, "question_id": 54681175, "link": "https://stackoverflow.com/questions/54681175/how-to-add-a-form-control-optionbutton-in-vba-not-activex-optionbutton", "title": "How to add a form control-optionbutton in VBA (not ActiveX-optionbutton)?", "body": "<p>I need to know how to add Form control optionbuttons to a WorkSheet by VBA. So far I've only managed to add ActiveX controls, which behave differently.</p>\n\n<p>I'm building an Excel 365 form (on a WorkSheet, not a VBA UserForm) including several groups of radiobuttons/optionbuttons. I see that I can add two kinds of optionnbuttons: Form controls and ActiveX controls.\nBoth controls can be linked to a cell, but return different results:\nForm controls return a number as a result\nActiveX controls return TRUE or FALSE</p>\n\n<p>I can add a optionbutton to my sheet using this code:</p>\n\n<pre><code>With FormSheet.OLEObjects.Add(ClassType:=\"Forms.Optionbutton.1\")\n    .Left = 10\nend with\n</code></pre>\n\n<p>I was hoping to get Form Controls, but as far as I can see the created controls are ActiveX controls. When I add a .LinkedCell, they return Boolean values.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 252, "user_id": 1866809, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/536ac11714e671a831c02e8f3470d2f3?s=128&d=identicon&r=PG", "display_name": "Brad", "link": "https://stackoverflow.com/users/1866809/brad"}, "edited": false, "score": 0, "creation_date": 1550100978, "post_id": 54680896, "comment_id": 96151017, "body": "Do you know how many rows will ultimately need a combobox or are you just looking for something that will work with an arbitrary number of rows\\comboboxes?"}, {"owner": {"reputation": 3, "user_id": 11058415, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Mg-iKqUn22E/AAAAAAAAAAI/AAAAAAAAAFo/jIgfthjQPHk/photo.jpg?sz=128", "display_name": "Tom Irlik", "link": "https://stackoverflow.com/users/11058415/tom-irlik"}, "reply_to_user": {"reputation": 252, "user_id": 1866809, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/536ac11714e671a831c02e8f3470d2f3?s=128&d=identicon&r=PG", "display_name": "Brad", "link": "https://stackoverflow.com/users/1866809/brad"}, "edited": false, "score": 0, "creation_date": 1550103583, "post_id": 54680896, "comment_id": 96151792, "body": "Hi Brad, it would be arbitrary. For instance, I may look to take a single reference row and copy/insert it 10 times.The number of rows will be dependent on the amount of records I download and need to allocate via the dropdown."}, {"owner": {"reputation": 252, "user_id": 1866809, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/536ac11714e671a831c02e8f3470d2f3?s=128&d=identicon&r=PG", "display_name": "Brad", "link": "https://stackoverflow.com/users/1866809/brad"}, "edited": false, "score": 0, "creation_date": 1550105869, "post_id": 54680896, "comment_id": 96152336, "body": "I&#39;m not sure if this would work, but maybe something along the lines of having an array of comboboxes that you could reference and then having generic functions that they could call do to the filtering? I&#39;m not sure if VBA can be tortured to do such a thing, though."}], "owner": {"reputation": 3, "user_id": 11058415, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Mg-iKqUn22E/AAAAAAAAAAI/AAAAAAAAAFo/jIgfthjQPHk/photo.jpg?sz=128", "display_name": "Tom Irlik", "link": "https://stackoverflow.com/users/11058415/tom-irlik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550100635, "creation_date": 1550099715, "last_edit_date": 1550100635, "question_id": 54680896, "link": "https://stackoverflow.com/questions/54680896/data-validation-with-filter", "title": "Data Validation with filter", "body": "<p>I am aware of how to create a combobox to emulate a data validation cell based off of a range list, featuring the ability to filter the dropdown list based on what you type in. This is similar in functionality to how column filtering in an Excel table works, where if I start typing \"tor\" it will immediately filter the preview window for items only containing the string \"tor\".</p>\n\n<p>However, I am trying to create a report where every row requires the same dropdown menu, and ideally what I hope to do is have each row have this cell where you can click on the dropdown, start typing, and the list will narrow down. However, I realize a combobox is a unique object and it cannot be duplicated as simply as copying and inserting a row with a data validation field.</p>\n\n<p>Is there a way I can easily duplicate this sort of drop down where a list preview filters based on what is typed into the cell, either via vba or plain data validation? In short, can a dropdown with the filtering preview capability as my code below be copied and pasted as easily as a simple data validated cell within a row?</p>\n\n<p>For reference here is my combobox code, listing range A2:A791 on sheet DVTest:</p>\n\n<pre><code>Sub ComboBox1_Populate(Optional fltr As String)\nComboBox1.List = \nFilter(Application.Transpose(Worksheets(\"DVTest\").Range(\"A2:A791\" &amp; \nSymbolCount).Value), fltr)\nEnd Sub\n\nPrivate Sub ComboBox1_KeyUp(ByVal KeyCode As MSForms.ReturnInteger, ByVal \nShift As Integer)\nCall ComboBox1_Populate(ComboBox1.Text)\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\nCall ComboBox1_Populate\nEnd Sub\n</code></pre>\n\n<p>Thanks kindly!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1550100083, "post_id": 54680872, "comment_id": 96150782, "body": "These are not your issues but.... you can remove the <code>=True</code> part and reduce your line to <code>If m_db.OpenRs(rs, sql) Then</code>. You can also remove <code>Call</code> from <code>Call ClearIndivTable</code>"}, {"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1550100215, "post_id": 54680872, "comment_id": 96150820, "body": "That&#39;s true - the = true is from the legacy system I inherited, but the Call is a desire to hit people over the head with what I&#39;m doing for readability"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 13811854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/340e958c68df2c249725a44441ebee89?s=128&d=identicon&r=PG&f=1", "display_name": "Duncan", "link": "https://stackoverflow.com/users/13811854/duncan"}, "is_accepted": false, "score": 0, "last_activity_date": 1612358339, "last_edit_date": 1612358339, "creation_date": 1612356229, "answer_id": 66027816, "question_id": 54680872, "link": "https://stackoverflow.com/questions/54680872/pasting-from-a-recordset-into-a-table-with-additional-formulas-fails-to-do-anyth/66027816#66027816", "title": "Pasting from a recordset into a table with additional formulas fails to do anything", "body": "<p>I ran into a similar problem and have a solution:</p>\n<pre><code>'//BOILERPLATE CODE TO OUTPUT A RECORDSET TO A LISTOBJECT\nPublic Sub RecordsetToLo(ByRef lo As ListObject, ByRef rs As Recordset)\n    \n    '// checking that the recordset has returned data\n    If rs.EOF And rs.BOF = True Then Exit Sub\n    \n    '// clear the existing data out of the listobject (lo)\n    '// if omitted, old data would spill under the databodyrange of the object\n    lo.DataBodyRange.Offset(1, 0).ClearContents\n    \n    '// for the formulae to drag down, no gap in the formulae column is allowed\n    '// hence we must reduce the bodyrange to 1 row\n    lo.Resize lo.Range.Resize(2)\n    \n    '// we may prepare a landing zone (LZ) to receive the new data\n    '// but this step is optional since resizing the bodyrange to 1 row should\n    '// achieve the same thing\n    '    Dim LZ As Range: Set LZ = lo.Range.Resize(rs.RecordCount + 1)\n    '    lo.Resize LZ\n\n    '// Finally, we paste the data in the LO, the formulae should drag down\n    lo.Range.Cells(2, 1).CopyFromRecordset rs\n\nEnd Sub\n</code></pre>\n<p>Without the comments:</p>\n<pre><code>Public Sub RecordsetToLo(ByRef lo As ListObject, ByRef rs As Recordset)\n    If rs.EOF And rs.BOF = True Then Exit Sub\n    lo.DataBodyRange.Offset(1, 0).ClearContents\n    lo.Resize lo.Range.Resize(2)\n    lo.Range.Cells(2, 1).CopyFromRecordset rs\nEnd Sub\n</code></pre>\n<p>Resizing a table with formulae is expensive and can take time. This version only resizes if required and only deletes the content of the cells up to the number of fields in the recordset:</p>\n<pre><code>'//BOILERPLATE CODE TO OUTPUT A RECORDSET TO A LISTOBJECT\nPublic Sub rs_to_lo(ByRef lo As ListObject, ByRef rs As Recordset, Optional resize As Boolean = False)\n    \n    '// checking that the recordset has returned data\n    If rs.EOF And rs.BOF = True Then Exit Sub\n    lo.DataBodyRange.Offset(1, 0).resize(lo.ListRows.Count, rs.fields.Count).ClearContents\n    If resize Then lo.resize lo.Range.resize(2)\n    lo.Range.Cells(2, 1).CopyFromRecordset rs\n\nEnd Sub\n</code></pre>\n<p>Note that to be able to use <strong>rs.RecordCount</strong>, I think you need to open a server cursor:</p>\n<pre><code>Optional cursorLocation As ADODB.CursorLocationEnum = adUseServer\n</code></pre>\n"}], "owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 169, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1612358339, "creation_date": 1550099553, "last_edit_date": 1550129017, "question_id": 54680872, "link": "https://stackoverflow.com/questions/54680872/pasting-from-a-recordset-into-a-table-with-additional-formulas-fails-to-do-anyth", "title": "Pasting from a recordset into a table with additional formulas fails to do anything", "body": "<p>So I have a short code snippet:</p>\n\n<pre><code>Dim rs As ADODB.Recordset\nIf (m_db.OpenRs(rs, sql) = True) Then\n    Call ClearIndivTable\n    shReportIndiv.ListObjects(\"Tb_GL_Report_Indiv\").DataBodyRange(1, 1).CopyFromRecordset rs\n    rs.Close\nEnd If\n</code></pre>\n\n<p>What I would expect to happen is the lines found in rs would paste themselves into the table. What actually happens is nothing.</p>\n\n<p>Using the same properties on a table sized exactly the same as the recordset results in the data being pasted in. </p>\n\n<pre><code> With table\n        If Not .DataBodyRange Is Nothing Then\n            .DataBodyRange.Delete\n        End If\n\n        If (m_db.OpenRs(rs, sql) = True) Then\n\n            Set rng = shDefective.Range(table.Range.Cells(1).Address).Offset(1, 0)\n            rng.CopyFromRecordset rs\n        End If\n    End With\n</code></pre>\n\n<p>This code is working. I've tried with the offset as well, but that doesn't work. I don't current suspect that's the issue.</p>\n\n<p>Using the same code, but pasting into a range, results in the data getting pasted. However, I'm trying to paste into a cell in a table that has additional formulas, but it's not working.</p>\n\n<pre><code>If (m_db.OpenRs(rs, sql) = True) Then\n    pOutput.Range(\"A13\").CopyFromRecordset rs\n    rs.Close\nEnd If\n</code></pre>\n\n<p>-More working code examples</p>\n\n<p>I do hope to refactor the entire thing to use Excel's native tools one day... but that day isn't today.</p>\n\n<p>I'm basically at my wits end how to paste this data in. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1550109840, "post_id": 54680866, "comment_id": 96153244, "body": "What line returns the error?  How long are the lists?  What error are you trying to avoid with your <code>On Error Resume Next</code> statements?"}, {"owner": {"reputation": 1, "user_id": 11059179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f11c1a32b837dcb9d47906e8fde1cb1a?s=128&d=identicon&r=PG&f=1", "display_name": "Stephan_0815", "link": "https://stackoverflow.com/users/11059179/stephan-0815"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1550147216, "post_id": 54680866, "comment_id": 96168269, "body": "The list is somewhat 650 characters long and has around 30 items."}, {"owner": {"reputation": 1, "user_id": 11059179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f11c1a32b837dcb9d47906e8fde1cb1a?s=128&d=identicon&r=PG&f=1", "display_name": "Stephan_0815", "link": "https://stackoverflow.com/users/11059179/stephan-0815"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1550147355, "post_id": 54680866, "comment_id": 96168357, "body": "&amp; yes I am trying to avoid with resume next - but it is somewhat hard to sell user-experience-wise ... (no selection &amp; you have to copy manually ...). Especially, as it has been working in the past. (Same length of the list. No changes on that side)"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1550147687, "post_id": 54680866, "comment_id": 96168560, "body": "You have chosen not to share information about the which line returns the error.  And handling errors, rather than ignoring them, should give you the level of control you require without upsetting user experience. Your error probably means there is a problem with the way you are setting up the conditional format object.  (I had found that with very long lists, there was a problem with <code>.xlsm</code> not present with <code>.xlsb</code> files, but those lists were &gt; 1000 words, and gave a different error."}, {"owner": {"reputation": 1, "user_id": 11059179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f11c1a32b837dcb9d47906e8fde1cb1a?s=128&d=identicon&r=PG&f=1", "display_name": "Stephan_0815", "link": "https://stackoverflow.com/users/11059179/stephan-0815"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1550220339, "post_id": 54680866, "comment_id": 96196659, "body": "The line returning the error is the one with .validation.add."}, {"owner": {"reputation": 1, "user_id": 11059179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f11c1a32b837dcb9d47906e8fde1cb1a?s=128&d=identicon&r=PG&f=1", "display_name": "Stephan_0815", "link": "https://stackoverflow.com/users/11059179/stephan-0815"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1550220377, "post_id": 54680866, "comment_id": 96196669, "body": "(Sorry for not deleting the on error line causing confusion)"}, {"owner": {"reputation": 1, "user_id": 11059179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f11c1a32b837dcb9d47906e8fde1cb1a?s=128&d=identicon&r=PG&f=1", "display_name": "Stephan_0815", "link": "https://stackoverflow.com/users/11059179/stephan-0815"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1550220542, "post_id": 54680866, "comment_id": 96196745, "body": "... have introduced the &quot;resume next&quot; in order to continue working."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1550229533, "post_id": 54680866, "comment_id": 96201909, "body": "I cannot reproduce your error with a shorter list and a <b><i>hard-coded</i></b> <code>Me.Vars.Rng</code>.  Suggests your code is OK."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1550230163, "post_id": 54680866, "comment_id": 96202217, "body": "A little testing suggests the length of a validation list string is limited to 255 characters.  I suggest you set up your validation list as a range, rather than a string."}], "owner": {"reputation": 1, "user_id": 11059179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f11c1a32b837dcb9d47906e8fde1cb1a?s=128&d=identicon&r=PG&f=1", "display_name": "Stephan_0815", "link": "https://stackoverflow.com/users/11059179/stephan-0815"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550099627, "creation_date": 1550099510, "last_edit_date": 1550099627, "question_id": 54680866, "link": "https://stackoverflow.com/questions/54680866/error-1004-while-setting-validations-via-vba", "title": "Error 1004 while setting validations via vba", "body": "<p>I'am setting validations based on list in text format on a cell via vba using XL365. Lists are quite long but this never caused an issue (for months) - and did not on Excel2013 on a different PC this morning.  </p>\n\n<p>It returns a 1004 error now. </p>\n\n<p>Have set up my PC from scratch last week. Did not try the code again before today. Observed some updates being installed today as well. </p>\n\n<p>The lists used for validation did not change. They have been very very long ever since. </p>\n\n<p>(me.vars.rng is just a simple Xl range defined in a variable container)</p>\n\n<pre><code>Public Sub subSetValidationListOnRng(strValidationList As String)\n    With Me.Vars.Rng\n        On Error Resume Next\n        .Validation.Delete\n        If Len(strValidationList) = 0 Then Exit Sub\n        .Validation.Delete\n        On Error Resume Next\n        .Validation.Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n            xlBetween, Formula1:=strValidationList\n        .Validation.IgnoreBlank = True\n        .Validation.InCellDropdown = True\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "selenium", "selenium-webdriver"], "comments": [{"owner": {"reputation": 1866, "user_id": 1183506, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2aba83296f9be999e2fab8eab88b4727?s=128&d=identicon&r=PG", "display_name": "mrfreester", "link": "https://stackoverflow.com/users/1183506/mrfreester"}, "edited": false, "score": 0, "creation_date": 1550097762, "post_id": 54680394, "comment_id": 96150023, "body": "Sounds like you might need to use <code>Selenium.actions</code> to string a couple actions together which is needed often when dropdowns are involved. I&#39;m not so familiar with VBA, but maybe that bit of direction helps."}, {"owner": {"reputation": 1866, "user_id": 1183506, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2aba83296f9be999e2fab8eab88b4727?s=128&d=identicon&r=PG", "display_name": "mrfreester", "link": "https://stackoverflow.com/users/1183506/mrfreester"}, "edited": false, "score": 0, "creation_date": 1550098302, "post_id": 54680394, "comment_id": 96150214, "body": "I take back my previous comment, I think Kajal&#39;s selector adjustments are probably all you need. Update us if not :)"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 11035065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b3d262e60834a0f104b218dde7578c5?s=128&d=identicon&r=PG&f=1", "display_name": "DaultonB", "link": "https://stackoverflow.com/users/11035065/daultonb"}, "edited": false, "score": 0, "creation_date": 1550097540, "post_id": 54680522, "comment_id": 96149949, "body": "The first one results in a Run-time Error &#39;32&#39;:  Invalid Selector Error. The other results on Run-time Error &#39;438&#39;: Object doesn&#39;t support this property or method."}, {"owner": {"reputation": 26505, "user_id": 10885684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66b93ef11f20d07cf796af83ae1ffe83?s=128&d=identicon&r=PG&f=1", "display_name": "KunduK", "link": "https://stackoverflow.com/users/10885684/kunduk"}, "reply_to_user": {"reputation": 37, "user_id": 11035065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b3d262e60834a0f104b218dde7578c5?s=128&d=identicon&r=PG&f=1", "display_name": "DaultonB", "link": "https://stackoverflow.com/users/11035065/daultonb"}, "edited": false, "score": 0, "creation_date": 1550098380, "post_id": 54680522, "comment_id": 96150239, "body": "I have modified my answer please try now."}, {"owner": {"reputation": 37, "user_id": 11035065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b3d262e60834a0f104b218dde7578c5?s=128&d=identicon&r=PG&f=1", "display_name": "DaultonB", "link": "https://stackoverflow.com/users/11035065/daultonb"}, "edited": false, "score": 0, "creation_date": 1550099494, "post_id": 54680522, "comment_id": 96150615, "body": "Thanks a lot for the help so far. The first one seems to be working to select and click the button but my spreadsheet data is not updating correctly. For example before changing it to today&#39;s date it defaults to show the last 30 days and that is the data that it is pulling currently (with your answer), not the new updated information that should auto-fill once &#39;Today&#39; is selected and the button &quot;Apply&#39; is clicked. What would be the best way to delay grabbing the data until it auto-fills in &#39;Today&#39; information. For further details here is the other relevant HTML: <a href=\"https://pastebin.com/X1N2SYLz\" rel=\"nofollow noreferrer\">pastebin.com/X1N2SYLz</a>"}, {"owner": {"reputation": 26505, "user_id": 10885684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66b93ef11f20d07cf796af83ae1ffe83?s=128&d=identicon&r=PG&f=1", "display_name": "KunduK", "link": "https://stackoverflow.com/users/10885684/kunduk"}, "reply_to_user": {"reputation": 37, "user_id": 11035065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b3d262e60834a0f104b218dde7578c5?s=128&d=identicon&r=PG&f=1", "display_name": "DaultonB", "link": "https://stackoverflow.com/users/11035065/daultonb"}, "edited": false, "score": 0, "creation_date": 1550099768, "post_id": 54680522, "comment_id": 96150699, "body": "Ok.Let me check.Could you please accept my answer by clicking accept button."}, {"owner": {"reputation": 26505, "user_id": 10885684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66b93ef11f20d07cf796af83ae1ffe83?s=128&d=identicon&r=PG&f=1", "display_name": "KunduK", "link": "https://stackoverflow.com/users/10885684/kunduk"}, "reply_to_user": {"reputation": 37, "user_id": 11035065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b3d262e60834a0f104b218dde7578c5?s=128&d=identicon&r=PG&f=1", "display_name": "DaultonB", "link": "https://stackoverflow.com/users/11035065/daultonb"}, "edited": false, "score": 0, "creation_date": 1550100303, "post_id": 54680522, "comment_id": 96150848, "body": "You need to wait for the element to be present in page or you can put some implicit delay. I don&#39;t know how to make it selenium VBA.I am good at selenium Java &amp; Python.I have to check for the syntax then only able to say something.As per you said unable to click the button I had tried to help to you."}], "tags": [], "owner": {"reputation": 26505, "user_id": 10885684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66b93ef11f20d07cf796af83ae1ffe83?s=128&d=identicon&r=PG&f=1", "display_name": "KunduK", "link": "https://stackoverflow.com/users/10885684/kunduk"}, "is_accepted": true, "score": 1, "last_activity_date": 1550098866, "last_edit_date": 1550098866, "creation_date": 1550097338, "answer_id": 54680522, "question_id": 54680394, "link": "https://stackoverflow.com/questions/54680394/how-to-target-css-button-elements-properly-with-vba-selenium-when-they-dont-hav/54680522#54680522", "title": "How to target CSS button elements properly with VBA Selenium when they don&#39;t have any IDs?", "body": "<p>Please try either of this two methods.It should work.</p>\n\n<pre><code>findElementByXPath(\"//button[contains(text(), 'Apply')]\")\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>findElementByXPath(\"//button[text()[contains(.,'Apply')]]\")\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>driver.findElementByCssSelector(\"button.applyBtn\")\n</code></pre>\n\n<p>Please let me know if this work.</p>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1550134627, "creation_date": 1550134627, "answer_id": 54686515, "question_id": 54680394, "link": "https://stackoverflow.com/questions/54680394/how-to-target-css-button-elements-properly-with-vba-selenium-when-they-dont-hav/54686515#54686515", "title": "How to target CSS button elements properly with VBA Selenium when they don&#39;t have any IDs?", "body": "<p>You can reduce the css selector further and use a single class selector. Css selector method will be faster than xpath:</p>\n\n<pre><code>driver.findElementByCss(\".applyBtn\").click\n</code></pre>\n\n<p>The correct syntax is <code>findElementByCss</code> for VBA selenium basic</p>\n"}], "owner": {"reputation": 37, "user_id": 11035065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b3d262e60834a0f104b218dde7578c5?s=128&d=identicon&r=PG&f=1", "display_name": "DaultonB", "link": "https://stackoverflow.com/users/11035065/daultonb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2409, "favorite_count": 1, "accepted_answer_id": 54680522, "answer_count": 2, "score": 1, "last_activity_date": 1550134627, "creation_date": 1550096651, "last_edit_date": 1550128994, "question_id": 54680394, "link": "https://stackoverflow.com/questions/54680394/how-to-target-css-button-elements-properly-with-vba-selenium-when-they-dont-hav", "title": "How to target CSS button elements properly with VBA Selenium when they don&#39;t have any IDs?", "body": "<p>I am trying to target and click a button on a site that requires me to open up a dropdown menu, select the option on the list, and click Apply. I have gotten it most of the way there but I can't seem to get it to click the button. Here is a link to the relevant HTML that I am working with <a href=\"https://pastebin.com/n5hJY3ua\" rel=\"nofollow noreferrer\">https://pastebin.com/n5hJY3ua</a>. And the full Xpath of the button is: /html/body/div[5]/div[3]/div/button[1]</p>\n\n<p>I have tried various ways to target the button such as:</p>\n\n<pre><code>.FindElementByXPath(\"//div[@button='Apply']\").Click\n\n.FindElementByClass(\"applyBtn btn btn-small btn-success\").Click\n\n.FindElementByXPath(\".//div[@button, 'Apply']\").Click\n</code></pre>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub ClickDate()\n    Dim t As Date\n    Dim ele As Object\n    Dim driver As New ChromeDriver\n    Dim post As WebElement\n    Dim i As Integer\n    Dim mysheet As Worksheet        \n\n    Const MAX_WAIT_SEC As Long = 10\n    Const INURL = \"https://ss3.shipstation.com/#/dashboard\"\n    Const URL = \"https://ss3.shipstation.com/\"\n\n    Set mysheet = Sheets(\"Sheet1\")\n\n    With driver '&lt;==log into shipstation\n        .Start \"Chrome\"\n        .get URL\n        t = Timer\n        Do\n            On Error Resume Next\n            Set ele = .FindElementById(\"username\")\n            On Error GoTo 0\n            If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n        Loop While ele Is Nothing\n\n        If ele Is Nothing Then Exit Sub\n        ele.SendKeys \"Username\"\n        .FindElementById(\"password\").SendKeys \"Password\"\n        .FindElementById(\"btn-login\").Click\n    End With\n\n\n    With driver '&lt;==select todays date\n        .get INURL  \n        Dim drf As Object\n        t = Timer\n\n        Do\n            Set drf = driver.FindElementsByCss(\".col-sm-4 h2\")\n            If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n        Loop While drf.Count = 0\n\n        If drf.Count &gt; 0 Then\n            .FindElementByClass(\"display-date\").Click\n\n            With .FindElementByXPath(\"//html/body/div/*/ul/li[1]\")\n                .Click\n            End With\n\n            .FindElementByXPath(\"//div[contains(@button, 'applyBtn btn btn-small btn-success')]\").Click\n        End If\n\n        i = 2\n        Dim item As Object, nodeList As Object, r As Long\n        t = Timer\n\n        Do\n            Set nodeList = driver.FindElementsByCss(\".col-sm-4 h2\")\n            If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n        Loop While nodeList.Count = 0\n\n        If nodeList.Count &gt; 0 Then\n            For Each item In nodeList\n                r = r + 1\n                ActiveSheet.Cells(2, r) = item.Text\n            Next\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>I need it to click Apply causing the site to search Today's Date and then grab the data and display it on an excel sheet. Everything is working except being able to click the button. It is returning to me </p>\n\n<blockquote>\n  <p>Run-time error '7': NoSuchElementError. </p>\n</blockquote>\n"}, {"tags": ["arrays", "excel", "vba", "loops", "variables"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1550096956, "post_id": 54680351, "comment_id": 96149770, "body": "just add say, <code>x = x+1</code> after you use it?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1550097131, "post_id": 54680351, "comment_id": 96149825, "body": "Or move your <code>Next x</code> to be above <code>Next i</code>"}, {"owner": {"reputation": 45, "user_id": 10097577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b874019a90f4f51a0e4e89ebc64a193f?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Roy", "link": "https://stackoverflow.com/users/10097577/daniel-roy"}, "edited": false, "score": 0, "creation_date": 1550097421, "post_id": 54680351, "comment_id": 96149915, "body": "That was it... it was seriously that simple... x before i... sometimes i hate this thing... lol Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 10097577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b874019a90f4f51a0e4e89ebc64a193f?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Roy", "link": "https://stackoverflow.com/users/10097577/daniel-roy"}, "edited": false, "score": 0, "creation_date": 1550101929, "post_id": 54680550, "comment_id": 96151288, "body": "It runs through and ends up pasting the last page of the first array (I) on every page... So it acts like it is pasting 2, 3, 5, 6 on every page, and 6 being the last one is the one that shows... It should be pasting I-2 on x-1 i-3 on x-2 and so on..."}, {"owner": {"reputation": 45, "user_id": 10097577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b874019a90f4f51a0e4e89ebc64a193f?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Roy", "link": "https://stackoverflow.com/users/10097577/daniel-roy"}, "edited": false, "score": 0, "creation_date": 1550102958, "post_id": 54680550, "comment_id": 96151601, "body": "Stepping through it is is runnin next x 4 times and then going to next i and x 4 times... so it is not reading them together... it needs to be next x and i at the same time"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 45, "user_id": 10097577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b874019a90f4f51a0e4e89ebc64a193f?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Roy", "link": "https://stackoverflow.com/users/10097577/daniel-roy"}, "edited": false, "score": 0, "creation_date": 1550102983, "post_id": 54680550, "comment_id": 96151605, "body": "Oh - so you only need 4 copy/pastes?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 45, "user_id": 10097577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b874019a90f4f51a0e4e89ebc64a193f?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Roy", "link": "https://stackoverflow.com/users/10097577/daniel-roy"}, "edited": false, "score": 0, "creation_date": 1550103070, "post_id": 54680550, "comment_id": 96151635, "body": "I follow, please see the edit at bottom of my solution. This is dependent on <code>Arr1</code> and <code>Arr3</code> always being the same size."}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 2, "last_activity_date": 1550103040, "last_edit_date": 1550103040, "creation_date": 1550097518, "answer_id": 54680550, "question_id": 54680351, "link": "https://stackoverflow.com/questions/54680351/how-to-get-to-different-array-progressing-in-a-loop/54680550#54680550", "title": "How to get to different array progressing in a loop", "body": "<p>To increment <code>x</code> before <code>i</code> just switch the <code>Next x</code> to be before <code>Next i</code>. </p>\n\n<hr>\n\n<pre><code>Sub TransAll()\n\nDim wb1 As Workbook: Set wb1 = Workbooks(\"primecost.xlsm\")\nDim wb2 As Workbook: Set wb2 = Workbooks(\"inventory.xlsm\")\nDim wb3 As Workbook: Set wb3 = Workbooks(\"transmanager.xlsm\")\n\nDim Arr1, Arr2, Arr3, Arr4\nDim i As Long, x As Long\n\nArr1 = Array(2, 3, 5, 6)\nArr2 = Array(2, 3, 4, 5, 6, 7)\nArr3 = Array(1, 2, 3, 4)\nArr4 = Array(5, 6, 7, 8, 9)\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False  '&lt;-- Is this one needed?\nApplication.EnableEvents = False\n\n    For i = LBound(Arr1) To UBound(Arr1)\n        For x = LBound(Arr3) To UBound(Arr3)\n            wb1.Sheets(Arr1(i)).Cells.Copy\n            wb3.Sheets(Arr3(x)).Cells.PasteSpecial Paste:=xlPasteValues\n        Next x\n    Next i\n\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Also applied a little cleaner (<em>in my opinion</em>) structure to your code. \nNote that variables not defined default to <code>Variant</code> so when declaring variants, you can just use <code>Dim Arr</code></p>\n\n<p>If you had indented your code in this order, you may have noticed the issue without needing to post. Notice that the open and closing statements around loops are aligned. Your code in the below format would have made the issue stand out a little more making it easier to debug/correct since i and x would have been on different indentations - just an example of the power of adopting standard indentation/structure when coding</p>\n\n<pre><code>'Notice the i &amp; x statements are misaligned!\nApplication.Screen/Alerts/Events \n    For i = ..\n        For x = ..\n            'Action Statements\n        Next i\n    Next x\nApplication.Screen/Alerts/Events\n</code></pre>\n\n<hr>\n\n<h2>Solution Post Comments</h2>\n\n<p>Update your loop to </p>\n\n<pre><code>For i = LBound(Arr1) To UBound(Arr1)\n     wb1.Sheets(Arr1(i)).Cells.Copy\n     wb3.Sheets(Arr3(i)).Cells.PasteSpecial Paste:=xlPasteValues\nNext i\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 10097577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b874019a90f4f51a0e4e89ebc64a193f?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Roy", "link": "https://stackoverflow.com/users/10097577/daniel-roy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 54680550, "answer_count": 1, "score": 0, "last_activity_date": 1550103709, "creation_date": 1550096455, "question_id": 54680351, "link": "https://stackoverflow.com/questions/54680351/how-to-get-to-different-array-progressing-in-a-loop", "title": "How to get to different array progressing in a loop", "body": "<p>So I am basically needing to different arrays to progress at the same time in the loop for it to paste values on each different sheet. I am not understanding how to get both to progress...</p>\n\n<pre><code>    Sub TransAll()\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    Application.EnableEvents = False\n\n    Dim wb1 As Workbook, wb2 As Workbook, wb3 As Workbook\n    Dim Arr1 As Variant, Arr2 As Variant, Arr3 As Variant, Arr4 As Variant\n    Dim i As Integer\n    Dim x As Integer\n\n    Set wb1 = Workbooks(\"primecost.xlsm\")\n    Set wb2 = Workbooks(\"inventory.xlsm\")\n    Set wb3 = Workbooks(\"transmanager.xlsm\")\n\n    Arr1 = Array(2, 3, 5, 6)\n    Arr2 = Array(2, 3, 4, 5, 6, 7)\n\n    Arr3 = Array(1, 2, 3, 4)\n    Arr4 = Array(5, 6, 7, 8, 9)\n\n\n    'for \"I\" works fine by iteself, but it needs \"I\" and \"X\" to progress accordingly in the same loop according to the different arrays.\n\n    For i = LBound(Arr1) To UBound(Arr1)\n    'For x = LBound(Arr3) To UBound(Arr3)\n\n        wb1.Sheets(Arr1(i)).Cells.Copy\n            wb3.Sheets(Arr3(x)).Cells.PasteSpecial Paste:=xlPasteValues\n    Next i\n    'Next x\n\n\n    '------------------------------------------------------------------\n        'this works but on at a time... very slow and a pain\n        'wb1.Sheets(6).Cells.Copy\n            'wb3.Sheets(1).Cells.PasteSpecial Paste:=xlPasteValues    \n    '------------------------------------------------------------------      \n\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n    Application.DisplayAlerts = True\n    End Sub\n</code></pre>\n\n<p>I just need to know how to get both variants progressing inside the same loop.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1550096767, "post_id": 54680011, "comment_id": 96149699, "body": "Why not just rename them before you copy them? so before <code>ws.copy</code> do a <code>ws.Name = &lt;new Name&gt;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 2304944, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/87hTH.png?s=128&g=1", "display_name": "codenewb", "link": "https://stackoverflow.com/users/2304944/codenewb"}, "edited": false, "score": 0, "creation_date": 1550185993, "post_id": 54680638, "comment_id": 96187760, "body": "Thanks! I had it in my mind that I needed to do a nested loop, but I see now I can just increment in the Do While Filename &lt;&gt; &quot; &quot; loop. Much more straightforward than I thought it would be."}, {"owner": {"reputation": 33, "user_id": 2304944, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/87hTH.png?s=128&g=1", "display_name": "codenewb", "link": "https://stackoverflow.com/users/2304944/codenewb"}, "edited": false, "score": 0, "creation_date": 1550243694, "post_id": 54680638, "comment_id": 96209926, "body": "Finally had a chance to try, and yes, works perfectly."}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 1, "last_activity_date": 1550098078, "creation_date": 1550098078, "answer_id": 54680638, "question_id": 54680011, "link": "https://stackoverflow.com/questions/54680011/how-can-i-rename-sheets-when-combining-workbooks/54680638#54680638", "title": "How can I rename sheets when combining Workbooks?", "body": "<p>Use variable <code>i</code> to rename your sheets before moving them to your other book. The <code>i</code> corresponds to the book the sheet came from in your loop. </p>\n\n<p>So the 5th book will have a sheet name of <code>Sheet1 5</code> and the 6th book will be <code>Sheet1 6</code> and so on for every sheet in every book.</p>\n\n<hr>\n\n<pre><code>Dim i As Long\ni = 1\n\nDo While Filename &lt;&gt; \"\"\n    Set wb2 = Workbooks.Open(directory &amp; Filename)\n        For Each ws In wb2.Sheets\n            ws.Name = ws.Name &amp; Chr(32) &amp; i               '&lt;-- Rename\n            ws.Copy after:=wb1.Sheets(Sheets.Count)\n        Next ws\n    wb2.Close savechanges:=False\n    Filename = Dir\n    i = i + 1                                             '&lt;-- Increment i for next bok\nLoop\n</code></pre>\n\n<p><em>This will only work if the code is ran once - If you try to re-run the code on the same books with similar names, the index <code>i</code> will have already been used. If this is a problem, you can rename the sheets to corrospond with the number of sheets that are on the book (<code>wb1.Sheets.Count</code>)</em></p>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 2304944, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/87hTH.png?s=128&g=1", "display_name": "codenewb", "link": "https://stackoverflow.com/users/2304944/codenewb"}, "is_accepted": false, "score": 0, "last_activity_date": 1550287627, "last_edit_date": 1550287627, "creation_date": 1550248736, "answer_id": 54713551, "question_id": 54680011, "link": "https://stackoverflow.com/questions/54680011/how-can-i-rename-sheets-when-combining-workbooks/54713551#54713551", "title": "How can I rename sheets when combining Workbooks?", "body": "<p>Building off of <strong>urdearboy</strong>'s response, I added user prompts to choose whether a batch rename is wanted, and if it is, to choose the batch name. It's nice to have the option when needed!</p>\n\n<pre><code>Sub MergeWorkbooks()\n\nDim FolderName As String\nDim directory As String, fileName As String\nDim wb1 As Workbook, wb2 As Workbook\nDim ws As Worksheet\nDim iAnswer As VbMsgBoxResult\nDim xAppend As String\n\nSet wb1 = Workbooks.Add\n\nWith Application.FileDialog(msoFileDialogFolderPicker)\n    .Title = \"Please select a folder.\"\n    .AllowMultiSelect = False\n    .Show\n    On Error Resume Next\n    FolderName = .SelectedItems(1)\n    Err.Clear\n    On Error GoTo 0\nEnd With\n\ndirectory = FolderName &amp; \"\\\"\nfileName = Dir(directory &amp; \"*.xls?\")\n\n'Prompt user to decide if batch rename is required\niAnswer = MsgBox(\"Would you like to batch rename the worksheets?\", vbYesNoCancel + vbQuestion + vbDefaultButton1, \"Sort Worksheets\")\n\n    'vbYes: Rename Worksheets\n    If iAnswer = vbYes Then\n\n1:\n\n        xAppend = InputBox(Prompt:= _\n                    \"Enter new batch name for worksheets.\" _\n                    &amp; vbNewLine &amp; vbNewLine &amp; _\n                    \"Sheets will be appended with number based on the order in which they are copied.\" _\n                    &amp; vbNewLine &amp; vbNewLine &amp; _\n                    \"If 'Cancel' is selected, worksheets will be renamed as number only, based on order in which they are copied.\", _\n                    Title:=\"Naming Convention\")\n\n                        If InStr(xAppend, \"&lt;\") &gt; 0 _\n                            Or InStr(xAppend, \"&gt;\") &gt; 0 _\n                            Or InStr(xAppend, \":\") &gt; 0 _\n                            Or InStr(xAppend, Chr(34)) &gt; 0 _\n                            Or InStr(xAppend, \"/\") &gt; 0 _\n                            Or InStr(xAppend, \"\\\") &gt; 0 _\n                            Or InStr(xAppend, \"|\") &gt; 0 _\n                            Or InStr(xAppend, \"?\") &gt; 0 _\n                            Or InStr(xAppend, \"*\") &gt; 0 _\n                                 Then\n                                    MsgBox \"Suggested filename contains an invalid character\"\n                                    GoTo 1\n                        End If\n\n            Dim i As Long\n            i = 1\n\n            Do While fileName &lt;&gt; \"\"\n                Set wb2 = Workbooks.Open(directory &amp; fileName)\n                    For Each ws In wb2.Sheets\n                        ws.Name = xAppend &amp; i                       '&lt;-- Rename\n                        ws.Copy after:=wb1.Sheets(Sheets.Count)\n                    Next ws\n                wb2.Close savechanges:=False\n                fileName = Dir\n                i = i + 1                                            '&lt;-- Increment i for next bok\n            Loop\n\n\n        'vbNo: Rename Worksheets\n        ElseIf iAnswer = vbNo Then\n\n            Do While fileName &lt;&gt; \"\"\n                Set wb2 = Workbooks.Open(directory &amp; fileName)\n                    For Each ws In wb2.Sheets\n                        ws.Copy after:=wb1.Sheets(Sheets.Count)\n                Next ws\n            wb2.Close savechanges:=False\n            fileName = Dir\n            Loop\n\n        'vb Canel: Exit\n        Else\n            Exit Sub\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 2304944, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/87hTH.png?s=128&g=1", "display_name": "codenewb", "link": "https://stackoverflow.com/users/2304944/codenewb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 54680638, "answer_count": 2, "score": 0, "last_activity_date": 1550287627, "creation_date": 1550094721, "last_edit_date": 1550128881, "question_id": 54680011, "link": "https://stackoverflow.com/questions/54680011/how-can-i-rename-sheets-when-combining-workbooks", "title": "How can I rename sheets when combining Workbooks?", "body": "<p>I need to combine workbooks from a folder, and I found the below code which should do exactly what I need. The code is from <a href=\"https://www.mrexcel.com/forum/excel-questions/956804-merge-all-workbooks-worksheets-folder-vba-prompt-select-folder.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>The issue I am encountering, that the worksheets in my workbooks all have the same long title, and it seems to crash the Sub as excel can't auto rename the sheets due to conflict (e.g. there is no room to append with (2) and (3) etc.). </p>\n\n<p>How can I add onto the code to rename the sheets something arbitrary, e.g. Copied1, Copied 2, etc... ?</p>\n\n<pre><code>Sub MergeWorkbooks()\n\nDim FolderName As String\nDim directory As String, fileName As String\nDim wb1 As Workbook, wb2 As Workbook\nDim ws As Worksheet\n\nSet wb1 = Workbooks.Add\n\nWith Application.FileDialog(msoFileDialogFolderPicker)\n    .Title = \"Please select a folder.\"\n    .AllowMultiSelect = False\n    .Show\n    On Error Resume Next\n    FolderName = .SelectedItems(1)\n    Err.Clear\n    On Error GoTo 0\nEnd With\n\ndirectory = FolderName &amp; \"\\\"\nfileName = Dir(directory &amp; \"*.xls?\")\n\nDo While fileName &lt;&gt; \"\"\nSet wb2 = Workbooks.Open(directory &amp; fileName)\nFor Each ws In wb2.Sheets\n    ws.Copy after:=wb1.Sheets(Sheets.Count)\nNext ws\nwb2.Close savechanges:=False\nfileName = Dir\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1550092240, "post_id": 54679420, "comment_id": 96147799, "body": "Change your <code>With</code> to : <code>With ActiveSheet</code> and use <code>HighPoint = Application.MATCH(Application.MAX(.Range(&quot;A:A&quot;)),.Range(&quot;A:A&zwnj;&#8203;&quot;),0)</code>"}, {"owner": {"reputation": 1, "user_id": 11058581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f726745720ea8ba20a591476a273eba0?s=128&d=identicon&r=PG&f=1", "display_name": "Sax Max", "link": "https://stackoverflow.com/users/11058581/sax-max"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1550092663, "post_id": 54679420, "comment_id": 96147993, "body": "Brilliant, thanks! Should have used Match instead. What would you change if there was a chance that there would be two identical max values in the dataset?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1550093019, "post_id": 54679420, "comment_id": 96148135, "body": "Also, try <code>LookIn:=xlFormulas</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11058581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f726745720ea8ba20a591476a273eba0?s=128&d=identicon&r=PG&f=1", "display_name": "Sax Max", "link": "https://stackoverflow.com/users/11058581/sax-max"}, "edited": false, "score": 0, "creation_date": 1550092744, "post_id": 54679526, "comment_id": 96148040, "body": "Thanks for the feedback. Looks like match is a better function for this application."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11053804"}, "is_accepted": false, "score": 1, "last_activity_date": 1550092488, "creation_date": 1550092488, "answer_id": 54679526, "question_id": 54679420, "link": "https://stackoverflow.com/questions/54679420/issues-with-find-function-returning-errors-when-searching-for-a-maximum-value-i/54679526#54679526", "title": "Issues with .Find function returning errors when searching for a maximum value in a range", "body": "<p>Use the worksheet's Match function to locate the row containing the maximum number.</p>\n\n<pre><code>Dim dMax As Double\nDim HighPoint As Long\n\nWith ActiveSheet.Range(\"A:A\")\n\n    dMax = application.Max(.cells)\n    MsgBox dMax\n\n    If dMax &gt; 0 Then\n\n        HighPoint = application.Match(application.Max(.cells), .cells, 0)\n\n    End If\nEnd With\n\ndebug.print HighPoint \n</code></pre>\n\n<p>Your own code may be suffering from a floating point decimal problem.</p>\n\n<p>Watch your use of With, End With blocks. <code>.Range(\"A2:A10000\")</code> within <code>ActiveSheet.Range(\"A2:A10000\")</code> is actually <code>.Range(\"A3:A10001\")</code> on the worksheet and you were missing the prefix <code>.</code> in the second use of <code>Range(\"A2:A10000\")</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 174, "user_id": 10958093, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EPASDnRpi7o/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZyiOkfp3ziX8Lbgbaz2V8fp8vohA/mo/photo.jpg?sz=128", "display_name": "DanStu", "link": "https://stackoverflow.com/users/10958093/danstu"}, "edited": false, "score": 0, "creation_date": 1550092950, "post_id": 54679579, "comment_id": 96148114, "body": "Also this isn&#39;t entirely related, but it may help you in the future. If you are using MsgBox to display intermediate values to check for errors, replacing it with Debug.Print might save you some time (the values appear in the immediate window, show by pressing cntrl + G on Windows)"}, {"owner": {"reputation": 1, "user_id": 11058581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f726745720ea8ba20a591476a273eba0?s=128&d=identicon&r=PG&f=1", "display_name": "Sax Max", "link": "https://stackoverflow.com/users/11058581/sax-max"}, "edited": false, "score": 0, "creation_date": 1550093119, "post_id": 54679579, "comment_id": 96148180, "body": "Thanks for the tip"}], "tags": [], "owner": {"reputation": 174, "user_id": 10958093, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EPASDnRpi7o/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZyiOkfp3ziX8Lbgbaz2V8fp8vohA/mo/photo.jpg?sz=128", "display_name": "DanStu", "link": "https://stackoverflow.com/users/10958093/danstu"}, "is_accepted": false, "score": 1, "last_activity_date": 1550092735, "creation_date": 1550092735, "answer_id": 54679579, "question_id": 54679420, "link": "https://stackoverflow.com/questions/54679420/issues-with-find-function-returning-errors-when-searching-for-a-maximum-value-i/54679579#54679579", "title": "Issues with .Find function returning errors when searching for a maximum value in a range", "body": "<p>You are referencing an \"After\" value outside your search range. You can simply delete this named parameter, or change it to </p>\n\n<pre><code>HighPoint = Range(\"A2:A10000\").Find(What:=dMax, After:=Cells(2, 1), _\nLookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\nMatchCase:=False).Row\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11058581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f726745720ea8ba20a591476a273eba0?s=128&d=identicon&r=PG&f=1", "display_name": "Sax Max", "link": "https://stackoverflow.com/users/11058581/sax-max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1550092735, "creation_date": 1550091995, "last_edit_date": 1550092286, "question_id": 54679420, "link": "https://stackoverflow.com/questions/54679420/issues-with-find-function-returning-errors-when-searching-for-a-maximum-value-i", "title": "Issues with .Find function returning errors when searching for a maximum value in a range", "body": "<p>I am trying to find and define a row which describes the maximum value in a range. The range is a column of numbers with decimal points which is imported into the sheet. I can find the max value but the .Find function is returning \"object variable or with block variable not set\" when I try and define the row it is in.</p>\n\n<p>I know that this error is returned if the value is not found. MsgBox dMax just prior to the .Find operation shows that it has found the max value for the range.</p>\n\n<p>The data set is a series of long positive and negative non integer numbers, e.g. -0.594396474479286. I've ensured that the data format is \"general\".</p>\n\n<pre><code>'finding highpoint\n\nDim dMax As Double\nDim HighPoint As Long\n\n   With ActiveSheet.Range(\"A2:A10000\")\n        dMax = WorksheetFunction.Max(.Range(\"A2:A10000\"))\n\n        MsgBox dMax\n\n        If dMax &gt; 0 Then\n\n         HighPoint = Range(\"A2:A10000\").Find(What:=dMax, After:=.Cells(1, 1), _\nLookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\nMatchCase:=False).Row\n\n\n        End If\n    End With\n</code></pre>\n\n<p>Can anyone point to what I have done wrong here? It seems like the .find function can't find the max value..</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1550092179, "post_id": 54679278, "comment_id": 96147763, "body": "Why do you need <code>SetSourceData</code> AND <code>FullSeriesCollection(1)</code>? Why not just set your chart range with <code>SetSourceData</code> and be done with it?"}, {"owner": {"reputation": 31, "user_id": 9643280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/268793801e79d2d12fc89987646b6be6?s=128&d=identicon&r=PG", "display_name": "Jake Winters", "link": "https://stackoverflow.com/users/9643280/jake-winters"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1550092810, "post_id": 54679278, "comment_id": 96148068, "body": "That what I got when I recorded the macro, X axis labels are not immediately next to the data that is being plotted (see either image)"}], "answers": [{"tags": [], "owner": {"reputation": 893, "user_id": 10794555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0D8LRxW70DQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-icioZDBlm6V-nHzFzMNQ2LTv2Nmg/mo/photo.jpg?sz=128", "display_name": "Ama", "link": "https://stackoverflow.com/users/10794555/ama"}, "is_accepted": false, "score": 2, "last_activity_date": 1550099094, "creation_date": 1550099094, "answer_id": 54680787, "question_id": 54679278, "link": "https://stackoverflow.com/questions/54679278/how-to-determine-what-data-is-included-on-the-y-axis-when-creating-charts-in-vba/54680787#54680787", "title": "How to determine what data is included on the Y axis when creating charts in VBA", "body": "<p>Try this: <code>ActiveChart.SetSourceData Source:=ActiveSheet.range(\"A5:E15\"), PlotBy:=xlColumns</code></p>\n\n<p>Source: <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.chart.setsourcedata\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.chart.setsourcedata</a></p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 9643280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/268793801e79d2d12fc89987646b6be6?s=128&d=identicon&r=PG", "display_name": "Jake Winters", "link": "https://stackoverflow.com/users/9643280/jake-winters"}, "edited": false, "score": 0, "creation_date": 1550170038, "post_id": 54680807, "comment_id": 96181478, "body": "Thanks for the response IAmNerd2000, the loop creating a new data series clears things up. And thanks for the &quot;best coding practice&quot; feedback!"}], "tags": [], "owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "is_accepted": false, "score": 2, "last_activity_date": 1550101381, "last_edit_date": 1550101381, "creation_date": 1550099225, "answer_id": 54680807, "question_id": 54679278, "link": "https://stackoverflow.com/questions/54679278/how-to-determine-what-data-is-included-on-the-y-axis-when-creating-charts-in-vba/54680807#54680807", "title": "How to determine what data is included on the Y axis when creating charts in VBA", "body": "<p>You can try this. As I don't have your data, you may still need to modify this a little.  Also, you should use a xyscatter plot (that is what I used). Finally, it is bad practice to use selection and select when making code. Try to modify it to not use these.</p>\n\n<pre><code>Sub Test()\n    Dim rng As Range\n    Dim sht As Worksheet\n\n    Dim intI As Integer\n    Dim strSheet As String\n    Dim lCol As Long\n    Dim lCol2 As Long\n    Dim lRow As Long\n    Dim lRow2 As Long\n\n    strSheet = \"Sheet1\"\n    Set sht = ThisWorkbook.Worksheets(strSheet)\n\n    Set rng = sht.Range(\"D5\")\n    lCol = rng.Column\n    lCol2 = sht.Range(sht.Cells(rng.Row, _\n                      sht.Columns.Count).Address).End(xlToLeft).Column\n    lRow = rng.Row + 3 '3 is the offset from D5!\n    lRow2 = sht.Range(sht.Cells(sht.Rows.Count, _\n                      rng.Column).Address).End(xlUp).Row\n\n    sht.Shapes.AddChart2 -1, xlXYScatterLines, , , _\n                         WorksheetFunction.Max(500, 1.7 * lCol)\n\n    With sht.Shapes(sht.Shapes.Count).Chart\n        '.SetSourceData Source:=Rng\n        For intI = lCol To lCol2\n            .SeriesCollection.NewSeries\n            .FullSeriesCollection(1).XValues = _\n                       sht.Range(sht.Cells(rng.Row, lCol), sht.Cells(rng.Row, lCol2))\n            .FullSeriesCollection(1).Values = _\n                       sht.Range(sht.Cells(lRow, intI), sht.Cells(lRow2, intI))\n        Next intI\n\n        .SetElement msoElementPrimaryCategoryAxisTitleAdjacentToAxis\n        .SetElement msoElementPrimaryValueAxisTitleAdjacentToAxis\n\n        .HasTitle = True\n        .ChartTitle.Text = \"Equipment Utilization (Weekly)\"\n        .Axes(xlCategory, xlPrimary).HasTitle = True\n        .Axes(xlCategory, xlPrimary).AxisTitle.Text = \"Date\"\n        .Axes(xlValue, xlPrimary).HasTitle = True\n        .Axes(xlValue, xlPrimary).AxisTitle.Text = \"Utilization\"\n        .HasLegend = True\n        .Axes(xlCategory).TickLabels.Orientation = xlUpward\n\n        '.Axes(xlSecondary).TickLabels.NumberFormat = \"0.0%\"\n        '.Axes(xlValue).MaximumScale = 1\n\n    End With\n\n    Set rng = Nothing\n    Set sht = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 9643280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/268793801e79d2d12fc89987646b6be6?s=128&d=identicon&r=PG", "display_name": "Jake Winters", "link": "https://stackoverflow.com/users/9643280/jake-winters"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1550101381, "creation_date": 1550091384, "last_edit_date": 1550092709, "question_id": 54679278, "link": "https://stackoverflow.com/questions/54679278/how-to-determine-what-data-is-included-on-the-y-axis-when-creating-charts-in-vba", "title": "How to determine what data is included on the Y axis when creating charts in VBA", "body": "<p>I am using vba to create charts with dynamic ranges, and excel is automatically choosing if the row or columnn of data is used to create the \"series\" for the charts based on relative dimensions of the dataset (see images). How do I pre determine that the y values of a \"series\" are always data in the same row, never in the same column.\n![incorrect]:<a href=\"https://imgur.com/gallery/4pm5E51\" rel=\"nofollow noreferrer\">https://imgur.com/gallery/4pm5E51</a>\n![Correct]:<a href=\"https://imgur.com/gallery/11vIQGe\" rel=\"nofollow noreferrer\">https://imgur.com/gallery/11vIQGe</a></p>\n\n<p>First post, apologies for incorrect formatting, etc</p>\n\n<p>Confirmed that the data range is correct. Almost 100% sure it's because in the incorrect scenario, there are more rows than columns, so it defaults to using the values from one column instead of values from one row.</p>\n\n<pre><code>Set rng = Selection\n\n    Sheet9.Activate\n    ActiveSheet.Shapes.AddChart2(-1, xlLine, , , WorksheetFunction.max(500, 1.7 * lcol)).Select\n\n    With ActiveChart\n        .SetSourceData Source:=rng\n        .FullSeriesCollection(1).XValues = Sheet10.Range(Sheet10.Cells(5, 3), Sheet10.Cells(5, lcol2))\n\n        .SetElement (msoElementPrimaryCategoryAxisTitleAdjacentToAxis)\n        .SetElement (msoElementPrimaryValueAxisTitleAdjacentToAxis)\n\n        .HasTitle = True\n        .ChartTitle.Text = \"Equipment Utilization (Weekly)\"\n        .Axes(xlCategory, xlPrimary).HasTitle = True\n        .Axes(xlCategory, xlPrimary).AxisTitle.Text = \"Date\"\n        .Axes(xlValue, xlPrimary).HasTitle = True\n        .Axes(xlValue, xlPrimary).AxisTitle.Text = \"Utilization\"\n        .HasLegend = True\n        .Axes(xlCategory).Select\n        Selection.TickLabels.Orientation = xlUpward\n\n        .Axes(xlSecondary).TickLabels.NumberFormat = \"0.0%\"\n        .Axes(xlValue).MaximumScale = 1\n\n    End With\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 314, "user_id": 10812919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y4hHw.jpg?s=128&g=1", "display_name": "healey", "link": "https://stackoverflow.com/users/10812919/healey"}, "edited": false, "score": 0, "creation_date": 1550091232, "post_id": 54679211, "comment_id": 96147372, "body": "I&#39;d recommend sharing your code and a sample document if possible."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1550091257, "post_id": 54679211, "comment_id": 96147383, "body": "The best you can do is to debug and see exactly where the code stucks, you probably enter a very long unwanted loop. In any case, you should post some code here to have some help."}, {"owner": {"reputation": 966, "user_id": 2166750, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b7a98a414302c4331caa45d56a522202?s=128&d=identicon&r=PG", "display_name": "Bert Verhees", "link": "https://stackoverflow.com/users/2166750/bert-verhees"}, "edited": false, "score": 1, "creation_date": 1550092523, "post_id": 54679211, "comment_id": 96147933, "body": "Indeed, without code-example this question is useless and not answerable."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1550093508, "post_id": 54679211, "comment_id": 96148361, "body": "Set Application.ScreenUpdating=False before the start of your search (and back on again afterwards) may help as it will stop word reformatting the document every time you make a deletion."}], "answers": [{"tags": [], "owner": {"reputation": 893, "user_id": 10794555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0D8LRxW70DQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-icioZDBlm6V-nHzFzMNQ2LTv2Nmg/mo/photo.jpg?sz=128", "display_name": "Ama", "link": "https://stackoverflow.com/users/10794555/ama"}, "is_accepted": false, "score": 0, "last_activity_date": 1550099799, "creation_date": 1550099799, "answer_id": 54680906, "question_id": 54679211, "link": "https://stackoverflow.com/questions/54679211/vba-search-and-replace-script-produce-long-delays/54680906#54680906", "title": "VBA search and replace script produce long delays", "body": "<p>Why not modifying the text file which contains the transcript? I would expect you end up with a .txt file.</p>\n\n<p>See example below, highly insipred from: <a href=\"https://stackoverflow.com/questions/10434335/text-file-in-vba-open-find-replace-saveas-close-file\">Text file in VBA: Open/Find Replace/SaveAs/Close File</a></p>\n\n<pre><code>Sub CleanFile()\n\nDim sBuf As String\nDim sTemp As String\nDim iFileNum As Integer\nDim sFileName As String\n\n' Edit as needed\nsFileName = application.GetOpenFilename\n\niFileNum = FreeFile\nOpen sFileName For Input As iFileNum\n\nDo Until EOF(iFileNum)\n    Line Input #iFileNum, sBuf\n    'If the line does not contain a ':', then include the line in the memory sTemp \n    if If InStr(sBuf, \":\") = 0 Then sTemp = sTemp &amp; sBuf &amp; vbCrLf\nLoop\nClose iFileNum\n\niFileNum = FreeFile\n\nsFileName = Application.GetSaveAsFilename()\nOpen sFileName For Output As iFileNum\nPrint #iFileNum, sTemp\nClose iFileNum\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": true, "score": 0, "last_activity_date": 1550179211, "last_edit_date": 1550179211, "creation_date": 1550114020, "answer_id": 54682670, "question_id": 54679211, "link": "https://stackoverflow.com/questions/54679211/vba-search-and-replace-script-produce-long-delays/54682670#54682670", "title": "VBA search and replace script produce long delays", "body": "<p>You don't need a macro for this - all you need is a <em>wildcard</em> Find/Replace, with:</p>\n\n<pre><code>Find = &lt;[0-9]@:[0-9]@&gt;*^13\nReplace = nothing\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11058745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5e4bd554a67569b22c8b7aeba7b5ac2?s=128&d=identicon&r=PG&f=1", "display_name": " B. Little", "link": "https://stackoverflow.com/users/11058745/b-little"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 54682670, "answer_count": 2, "score": -3, "last_activity_date": 1550179211, "creation_date": 1550091058, "last_edit_date": 1550162859, "question_id": 54679211, "link": "https://stackoverflow.com/questions/54679211/vba-search-and-replace-script-produce-long-delays", "title": "VBA search and replace script produce long delays", "body": "<p>[[UPDATE: Apologies...I forgot the code block. Edited.]]</p>\n\n<p>This is a question from one of my faculty, so I'll quote him directly, and preface this by saying I don't know VB (just the conduit here):</p>\n\n<p>\"In order to help an international student, I need to convert Youtube transcripts and Closed Captionings into readable text.</p>\n\n<p>I wrote this routine for the purpose of eliminating time code marks from Youtube transcripts by invoking Visual Basic from within Microsoft Word. Since time codes are always on a separate line and since time codes must contain \u201c:\u201d, I am searching for the character \u201c:\u201d and then deleting the whole line in which it occurs. For some reason, the routine I have written, when completed, forces Word into a long unresponsive period (around 60-100 seconds) after which it works perfectly well. Any suggestions for avoiding that delay or for solving this problem within Word, without writing macros?\"</p>\n\n<pre><code>Sub Deleteyt()\n\nDim oRng As Word.Range\n\nDim oRngDelete As Word.Range\n\nSet oRng = ActiveDocument.Range\n\nWith oRng.Find\n\n.Text = \":\"\n\nWhile .Execute\n\noRng.Select\n\nSet oRngDelete = ActiveDocument.Bookmarks(\"\\Line\").Range\n\noRngDelete.Delete\n\nWend\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>So the code works, there's just the long delay up front. Any ideas?</p>\n"}, {"tags": ["excel", "vba", "vbscript", "hta", "identification"], "comments": [{"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 3, "creation_date": 1550092104, "post_id": 54679157, "comment_id": 96147732, "body": "I think I&#39;m missing something --- why does that matter? If you are writing a code meant to run anywhere, then you shouldn&#39;t care what engine it is, right?"}, {"owner": {"reputation": 178, "user_id": 11058699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LRCyk.png?s=128&g=1", "display_name": "CyberTaco", "link": "https://stackoverflow.com/users/11058699/cybertaco"}, "reply_to_user": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 0, "creation_date": 1550099187, "post_id": 54679157, "comment_id": 96150530, "body": "The problem is that there are a few basic things that differ between the engines (for instance, how to tell what file the code is running from, or how to make a delay). If I have a way to detect which engine is running, I can make code that branches to handle things like that automatically without modification."}], "answers": [{"comments": [{"owner": {"reputation": 178, "user_id": 11058699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LRCyk.png?s=128&g=1", "display_name": "CyberTaco", "link": "https://stackoverflow.com/users/11058699/cybertaco"}, "edited": false, "score": 0, "creation_date": 1550093116, "post_id": 54679459, "comment_id": 96148178, "body": "Hmm, interesting! How would I go about actually doing that, code-wise? Do you have a few lines of sample code I could test out and experiment with?"}, {"owner": {"reputation": 178, "user_id": 11058699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LRCyk.png?s=128&g=1", "display_name": "CyberTaco", "link": "https://stackoverflow.com/users/11058699/cybertaco"}, "edited": false, "score": 1, "creation_date": 1550099305, "post_id": 54679459, "comment_id": 96150561, "body": "Ahh, I see about testing for the name, that&#39;s a great way to get around if someone redefined the object. Unfortunately, trying this kind of code in a VBA with Option Explicit crashes with &quot;Compile error: Variable not defined&quot; at the first mention of WScript."}, {"owner": {"reputation": 178, "user_id": 11058699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LRCyk.png?s=128&g=1", "display_name": "CyberTaco", "link": "https://stackoverflow.com/users/11058699/cybertaco"}, "edited": false, "score": 0, "creation_date": 1550099329, "post_id": 54679459, "comment_id": 96150568, "body": "Is there perhaps a roundabout way to identify the engine without checking for objects that may or may not exist?"}, {"owner": {"reputation": 186, "user_id": 11047851, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/43f607b763e211a8674c232e03b56400?s=128&d=identicon&r=PG", "display_name": "Noodles", "link": "https://stackoverflow.com/users/11047851/noodles"}, "reply_to_user": {"reputation": 178, "user_id": 11058699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LRCyk.png?s=128&g=1", "display_name": "CyberTaco", "link": "https://stackoverflow.com/users/11058699/cybertaco"}, "edited": false, "score": 0, "creation_date": 1550102266, "post_id": 54679459, "comment_id": 96151382, "body": "That&#39;s the whole idea of COM checking if objects are available, so you can choose a different one if not. Normally Basic hides the details from us."}, {"owner": {"reputation": 186, "user_id": 11047851, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/43f607b763e211a8674c232e03b56400?s=128&d=identicon&r=PG", "display_name": "Noodles", "link": "https://stackoverflow.com/users/11047851/noodles"}, "reply_to_user": {"reputation": 178, "user_id": 11058699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LRCyk.png?s=128&g=1", "display_name": "CyberTaco", "link": "https://stackoverflow.com/users/11058699/cybertaco"}, "edited": false, "score": 0, "creation_date": 1550102401, "post_id": 54679459, "comment_id": 96151429, "body": "<code>Dim wscript as object</code>."}, {"owner": {"reputation": 186, "user_id": 11047851, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/43f607b763e211a8674c232e03b56400?s=128&d=identicon&r=PG", "display_name": "Noodles", "link": "https://stackoverflow.com/users/11047851/noodles"}, "reply_to_user": {"reputation": 178, "user_id": 11058699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LRCyk.png?s=128&g=1", "display_name": "CyberTaco", "link": "https://stackoverflow.com/users/11058699/cybertaco"}, "edited": false, "score": 0, "creation_date": 1550105305, "post_id": 54679459, "comment_id": 96152199, "body": "<code>Dim WScript as Object</code> allocates 16 bytes of memory 1 x 32 bit reference count, 1 x 32 bit pointer to the VTable (Virtual Function Table - the memory address of all methods and properties), and 2 x 32 bit unused numbers. They are all set to 0 (or nothing) till you use the <code>set</code> command. So <code>Option Explicit</code> will be happy."}], "tags": [], "owner": {"reputation": 186, "user_id": 11047851, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/43f607b763e211a8674c232e03b56400?s=128&d=identicon&r=PG", "display_name": "Noodles", "link": "https://stackoverflow.com/users/11047851/noodles"}, "is_accepted": false, "score": -1, "last_activity_date": 1550098168, "last_edit_date": 1550098168, "creation_date": 1550092185, "answer_id": 54679459, "question_id": 54679157, "link": "https://stackoverflow.com/questions/54679157/how-can-my-code-find-out-if-its-running-as-vbscript-hta-or-vba/54679459#54679459", "title": "How can my code find out if it&#39;s running as VBScript, .HTA, or VBA?", "body": "<p>All programs have a host that provides a global <code>Application</code> object at a minimum. WScript provides the global <code>WScript</code>, Word/Excel an <code>Application</code> object, an HTA an IE Window object (which through the parent property gives access to <code>InternetExplorer.Application</code> object.</p>\n\n<p>In COM we call QueryRef on the IUnknown interface to find what objects it has. This happens under the hood. The principal is you try to use it and look for the error that says for a property E_Not_Implemented.</p>\n\n<p>This is the standard on what should be in an Application object <a href=\"https://docs.microsoft.com/en-au/previous-versions/windows/desktop/automat/using-the-application-object-in-a-type-library\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-au/previous-versions/windows/desktop/automat/using-the-application-object-in-a-type-library</a></p>\n\n<p>So <code>wscript.name</code>, <code>InternetExplorer.Application.Name</code>, and <code>Word.Application.Name</code>.</p>\n\n<p>In Wscript this code prints <code>Windows Scripting Host</code>. In Word it prints <code>Normal 424 Object Required</code>. In an HTA <code>Microsoft VBScript runtime error 424 Object required</code>.</p>\n\n<pre><code>On Error Resume Next\nx = wscript.name\nIf err.Number = 0 then\n    Msgbox x\nElse\n    Msgbox err.source &amp; \" \" &amp; err.number &amp; \" \" &amp; err.description\nEnd If\n</code></pre>\n\n<p>Likewise in Word <code>Microsoft Word</code>, VBS <code>Microsoft VBScript runtime error 424 Object required</code>, and HTA <code>Microsoft VBScript runtime error 424 Object required</code>.</p>\n\n<pre><code>On Error Resume Next\nx = Application.Name\nIf Err.Number = 0 Then\n    MsgBox x\nElse\n    MsgBox Err.Source &amp; \" \" &amp; Err.Number &amp; \" \" &amp; Err.Description\nEnd If\n</code></pre>\n\n<p>Also note testing for Application is defined or not is not robust. Excel also has an Application object. You have to test for the <code>name</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1550094772, "post_id": 54679476, "comment_id": 96148915, "body": "That&#39;s definitely on the right track, however <code>On Error Resume Next</code> will make the function not work as intended. Upvoted for the idea, but needs more work."}, {"owner": {"reputation": 449, "user_id": 293047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ca4eb9eaca08efd239478f5ad39d8d7?s=128&d=identicon&r=PG", "display_name": "zc2", "link": "https://stackoverflow.com/users/293047/zc2"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1550095693, "post_id": 54679476, "comment_id": 96149292, "body": "Not sure what did you mean by &quot;will make the function not work as intended&quot;. O.E.R.N. is exactly what needs here, without that the code will just crash. It&#39;s like using try{}catch() blocks in other languages."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1550095819, "post_id": 54679476, "comment_id": 96149341, "body": "What I mean is that what follows the <code>Then</code> token will be executed unconditionally in case of an error, making the function return the wrong value; see <a href=\"https://stackoverflow.com/a/54680222/1188513\">this answer</a>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1550096450, "post_id": 54679476, "comment_id": 96149576, "body": "The error OERN is shrugging off is RTE 424 &quot;object required&quot;, which is tripped by the <code>Is Nothing</code> check against what&#39;s a <code>Variant&#47;Empty</code> at run-time. You can&#39;t unconditionally return &quot;WScript&quot;, you need to first check whether the null-check has thrown an error. As-is, this logic returns whatever the first check decides to return."}, {"owner": {"reputation": 449, "user_id": 293047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ca4eb9eaca08efd239478f5ad39d8d7?s=128&d=identicon&r=PG", "display_name": "zc2", "link": "https://stackoverflow.com/users/293047/zc2"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1550097716, "post_id": 54679476, "comment_id": 96150009, "body": "Very good point. I updated my sample code. It works properly now, just tested it."}], "tags": [], "owner": {"reputation": 449, "user_id": 293047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ca4eb9eaca08efd239478f5ad39d8d7?s=128&d=identicon&r=PG", "display_name": "zc2", "link": "https://stackoverflow.com/users/293047/zc2"}, "is_accepted": false, "score": 2, "last_activity_date": 1550097658, "last_edit_date": 1550097658, "creation_date": 1550092274, "answer_id": 54679476, "question_id": 54679157, "link": "https://stackoverflow.com/questions/54679157/how-can-my-code-find-out-if-its-running-as-vbscript-hta-or-vba/54679476#54679476", "title": "How can my code find out if it&#39;s running as VBScript, .HTA, or VBA?", "body": "<p>Try to check existence of context objects, like</p>\n\n<pre><code>Function ScriptEngine()\n    dim tst\n    on error resume next\n    Err.Clear\n    tst = WScript is Nothing\n    if Err=0 then ScriptEngine=\"WScript\" : exit function\n    Err.Clear\n' similar way check objects in other environments\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 178, "user_id": 11058699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LRCyk.png?s=128&g=1", "display_name": "CyberTaco", "link": "https://stackoverflow.com/users/11058699/cybertaco"}, "edited": false, "score": 0, "creation_date": 1550097794, "post_id": 54680222, "comment_id": 96150035, "body": "Unfortunately, trying this code in a VBA with Option Explicit crashes with &quot;Compile error: Variable not defined&quot; on the first WScript reference."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 178, "user_id": 11058699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LRCyk.png?s=128&g=1", "display_name": "CyberTaco", "link": "https://stackoverflow.com/users/11058699/cybertaco"}, "edited": false, "score": 1, "creation_date": 1550098174, "post_id": 54680222, "comment_id": 96150176, "body": "@CyberTaco yes, it&#39;s relying on the <code>Variant&#47;Empty</code> behavior of undeclared variables: you can&#39;t have it both ways - if you declare <code>WScript</code> or <code>Application</code> then you&#39;re shadowing the global declarations and making everything useless. You can&#39;t have <code>Option Explicit</code> specified for this. I&#39;ve edited the answer accordingly."}, {"owner": {"reputation": 178, "user_id": 11058699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LRCyk.png?s=128&g=1", "display_name": "CyberTaco", "link": "https://stackoverflow.com/users/11058699/cybertaco"}, "edited": false, "score": 0, "creation_date": 1550098441, "post_id": 54680222, "comment_id": 96150270, "body": "Indeed, and that&#39;s exactly my point - I&#39;m looking for a way around the problem, and that way has to function with Option Explicit on. So the trick becomes what <i>other</i> ways to detect the engine could there be, direct or indirect, besides trying to test objects that may not exist? :-)"}, {"owner": {"reputation": 178, "user_id": 11058699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LRCyk.png?s=128&g=1", "display_name": "CyberTaco", "link": "https://stackoverflow.com/users/11058699/cybertaco"}, "edited": false, "score": 0, "creation_date": 1550098457, "post_id": 54680222, "comment_id": 96150278, "body": "(And yes, I fully admit this is tricky - hence why I&#39;m here. :-) )"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 178, "user_id": 11058699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LRCyk.png?s=128&g=1", "display_name": "CyberTaco", "link": "https://stackoverflow.com/users/11058699/cybertaco"}, "edited": false, "score": 0, "creation_date": 1550098533, "post_id": 54680222, "comment_id": 96150316, "body": "@CyberTaco then I would heed <a href=\"https://stackoverflow.com/questions/54679157/how-can-my-code-find-out-if-its-running-as-vbscript-hta-or-vba#comment96147732_54679157\">this questioning</a> and take a step back and ask myself exactly why this matters at all."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1550098322, "last_edit_date": 1550098322, "creation_date": 1550095762, "answer_id": 54680222, "question_id": 54679157, "link": "https://stackoverflow.com/questions/54679157/how-can-my-code-find-out-if-its-running-as-vbscript-hta-or-vba/54680222#54680222", "title": "How can my code find out if it&#39;s running as VBScript, .HTA, or VBA?", "body": "<p>Any undeclared variable will be <code>Variant/Empty</code>, so <code>VarType(something)</code> will be <code>vbEmpty</code> (or <code>0</code>) if <code>something</code> is undefined.</p>\n\n<p>Unless <code>VarType</code> doesn't exist outside the VBA standard library (I've no idea TBH), then there's no need to trap/skip/handle any errors for this to work - tested in VBA:</p>\n\n<pre><code>Function GetHostType()\n    If VarType(wscript) &lt;&gt; vbEmpty Then\n        GetHostType = \"VBS\"\n        Exit Function\n    End If        \n    If VarType(Application) &lt;&gt; vbEmpty Then\n        GetHostType = \"VBA\"\n        Exit Function\n    End If        \n    GetHostType = \"HTA\"\nEnd Function\n</code></pre>\n\n<p>Note that this will yield unexpected results if e.g. <code>Application</code> or <code>WScript</code> <em>is</em> defined somewhere and the host isn't VBA or VBScript, respectively.</p>\n\n<p>Alternatively, this would work whether <code>VarType</code> is defined or not:</p>\n\n<pre><code>Function GetHostType()\n    On Error Resume Next\n\n    If Not WScript Is Nothing Then\n        If Err.Number = 0 Then\n            GetHostType = \"VBS\"\n            Exit Function\n        End If\n    End If\n    Err.Clear ' clear error 424 if not VBS\n\n    If Not Application Is Nothing Then\n        If Err.Number = 0 Then\n            GetHostType = \"VBA\"\n            Exit Function\n        End If\n    End If\n    Err.Clear ' clear error 424 if not VBA\n\n    GetHostType = \"HTA\"\nEnd Function\n</code></pre>\n\n<p>Again it assumes that no object by these names are defined; the mechanism relies on <code>WScript</code>/<code>Application</code> being a <code>Variant/Empty</code> and thus throwing run-time error 424 \"Object Required\" when tested with <code>Is Nothing</code>.</p>\n\n<p>Note that you can't have <code>Option Explicit</code> specified for this. The reason is because if you do <code>Dim WScript</code> and <code>Dim Application</code> to satisfy the compiler, then at runtime these variables will be shadowing the global identifiers you're checking, and the function will consistently return whatever host you checked first.</p>\n"}, {"comments": [{"owner": {"reputation": 178, "user_id": 11058699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LRCyk.png?s=128&g=1", "display_name": "CyberTaco", "link": "https://stackoverflow.com/users/11058699/cybertaco"}, "edited": false, "score": 0, "creation_date": 1550170750, "post_id": 54681255, "comment_id": 96181778, "body": "That&#39;s actually along the lines of what the end result of this would be, except I&#39;m trying to have it as one piece of code I can use for all three engines. Maintaining three separate sets of sets of code for my common functions has become a bit of a bear. If I can get this detection thing down, then I can write that MySleep funtion (among others) once, have it handle sleeping depending on which engine is running, and poof, problem solved. :-)"}], "tags": [], "owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "is_accepted": false, "score": 1, "last_activity_date": 1550102105, "creation_date": 1550102105, "answer_id": 54681255, "question_id": 54679157, "link": "https://stackoverflow.com/questions/54679157/how-can-my-code-find-out-if-its-running-as-vbscript-hta-or-vba/54681255#54681255", "title": "How can my code find out if it&#39;s running as VBScript, .HTA, or VBA?", "body": "<p>I'd suggest that you are approaching the problem backward. Instead of asking \"who's the host here?\", you should instead have a common interface for tasks. As an example, You would have a module - let's call it <code>MyAPI</code>:</p>\n\n<pre><code>Public Function MySleep(Milliseconds As Long)\nEnd Function\n</code></pre>\n\n<p>You can then implement one for VBA, one for VBS, other for HTA (though I question whether there's a real difference. Your host-agnostic code then would require inclusion of that module of which all should allow for. For example, <a href=\"https://stackoverflow.com/questions/316166/how-do-i-include-a-common-file-in-vbscript-similar-to-c-include\">see here for including a file to VBS</a>. It also looks like <a href=\"https://stackoverflow.com/questions/31499095/load-subroutines-from-external-script-file\">HTA has something similar</a>. In VBA, that's just another module. </p>\n\n<p>Then in your agnostic-host code, you would call <code>MySleep</code> instead of API-declared <code>Sleep</code> or <code>WScript.Sleep</code>, and let the included module provide the host-specific implementation without any branching and therefore any need to disable <code>Option Explicit</code> nor testing for non-existent objects.</p>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1550105116, "post_id": 54681567, "comment_id": 96152161, "body": "Wow, that&#39;s some clever hack."}, {"owner": {"reputation": 178, "user_id": 11058699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LRCyk.png?s=128&g=1", "display_name": "CyberTaco", "link": "https://stackoverflow.com/users/11058699/cybertaco"}, "edited": false, "score": 0, "creation_date": 1550170907, "post_id": 54681567, "comment_id": 96181843, "body": "VERY clever! Thank you, this is pretty slick!"}, {"owner": {"reputation": 178, "user_id": 11058699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LRCyk.png?s=128&g=1", "display_name": "CyberTaco", "link": "https://stackoverflow.com/users/11058699/cybertaco"}, "edited": false, "score": 0, "creation_date": 1550177730, "post_id": 54681567, "comment_id": 96184719, "body": "Wait a minute - the VBA one is stopping with &quot;Run-time error &#39;13&#39;: Type mismatch&quot; on the &quot;Set foo=foo&quot; line, despite the On Error being in there."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 178, "user_id": 11058699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LRCyk.png?s=128&g=1", "display_name": "CyberTaco", "link": "https://stackoverflow.com/users/11058699/cybertaco"}, "edited": false, "score": 0, "creation_date": 1550177867, "post_id": 54681567, "comment_id": 96184780, "body": "@CyberTaco - Uh... it shouldn&#39;t - I&#39;m not replicating that in Excel 2013 x32. Do you have the VBE set up for &quot;Break on All Errors&quot;?"}, {"owner": {"reputation": 178, "user_id": 11058699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LRCyk.png?s=128&g=1", "display_name": "CyberTaco", "link": "https://stackoverflow.com/users/11058699/cybertaco"}, "edited": false, "score": 1, "creation_date": 1550194303, "post_id": 54681567, "comment_id": 96189515, "body": "Huh, it seems yes, yes I do! Wow, I set that ages ago, I&#39;d long forgotten about that! Ok, that works much better now, thank you! :-)"}, {"owner": {"reputation": 178, "user_id": 11058699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LRCyk.png?s=128&g=1", "display_name": "CyberTaco", "link": "https://stackoverflow.com/users/11058699/cybertaco"}, "edited": false, "score": 0, "creation_date": 1550194365, "post_id": 54681567, "comment_id": 96189535, "body": "Fun fact: I found out how to tell between VBScript and an HTA in the same function - if you try ReDim WScript(0) , VBScript throws an error, but an HTA has no problem at all with that idea! :-)"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 178, "user_id": 11058699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LRCyk.png?s=128&g=1", "display_name": "CyberTaco", "link": "https://stackoverflow.com/users/11058699/cybertaco"}, "edited": false, "score": 2, "creation_date": 1550194827, "post_id": 54681567, "comment_id": 96189653, "body": "@CyberTaco Glad that&#39;s working for you. The reason <code>ReDim WScript(0)</code> works in HTA and not VBScript is because in VBScript it&#39;s the application object, so you&#39;d get a type mismatch. In HTA, it would be an undeclared variable (which defaults to <code>Variant</code>). The <code>Redim</code> just redefines it as an array of <code>Variant</code> with one (empty) element."}, {"owner": {"reputation": 178, "user_id": 11058699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LRCyk.png?s=128&g=1", "display_name": "CyberTaco", "link": "https://stackoverflow.com/users/11058699/cybertaco"}, "edited": false, "score": 0, "creation_date": 1550282991, "post_id": 54681567, "comment_id": 96223971, "body": "Actually, that&#39;s the weird thing. In an HTA and VBA, if you try to ReDim an object that does already exist in those engines (like &quot;Window&quot;, or &quot;Application&quot;), it lets you! You end up with a new local variable that overrides the built in object until it goes out of scope. VBScript is the only one of the three that complains. Interesting, and oddly useful!"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 178, "user_id": 11058699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LRCyk.png?s=128&g=1", "display_name": "CyberTaco", "link": "https://stackoverflow.com/users/11058699/cybertaco"}, "edited": false, "score": 2, "creation_date": 1550284321, "post_id": 54681567, "comment_id": 96224135, "body": "@CyberTaco - That&#39;s normal scope resolution. A <code>ReDim</code> statement counts as a declaration (it can be used on its own even without a <code>Dim</code> if <code>Option Explicit</code> is specified).  The new variable &quot;hides&quot; the one within the scope that it&#39;s defined in. See the second bullet under &quot;Static Sematics&quot; for <code>ReDim</code> in the <a href=\"https://msdn.microsoft.com/en-us/library/ee156854.aspx\" rel=\"nofollow noreferrer\">VBA spec</a>."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 10, "last_activity_date": 1550119600, "last_edit_date": 1550119600, "creation_date": 1550104602, "answer_id": 54681567, "question_id": 54679157, "link": "https://stackoverflow.com/questions/54679157/how-can-my-code-find-out-if-its-running-as-vbscript-hta-or-vba/54681567#54681567", "title": "How can my code find out if it&#39;s running as VBScript, .HTA, or VBA?", "body": "<p>The restriction on requiring <code>Option Explicit</code> in the VBA implementation makes this a little more difficult than it otherwise would be (it's a one-liner without it)... Ironically it also turns out to be the key to the solution.\nIf you don't limit yourself to a single function, you can get away with it by doing something like this:</p>\n\n<pre><code>Dim hta\n\nSub window_onload()\n     hta = True\nEnd Sub\n\nFunction HostType()\n    On Error Resume Next\n    If hta Then\n        HostType = \"HTA\"\n    Else\n        Dim foo\n        Set foo = foo\n        If Err.Number = 13 Then\n            HostType = \"VBA\"\n        Else\n            HostType = \"VBS\"\n        End If\n    End If\nEnd Function\n</code></pre>\n\n<p>It works like this - If it's loaded via an HTA file, the <code>window_onload</code> event handler runs, setting the <code>hta</code> variable to <code>True</code>.  That's the first test.  The second \"test\" is on the error thrown by the line <code>Set foo = foo</code>.  This is a type mismatch in VBA, where it is interpreted as trying to <code>Set</code> a <code>Variant</code> to <code>Empty</code>, which isn't a compatible type.  The same line of code throws an error 424 (Object required) in VBScript because it is not a strongly typed language.  That means VBA's type check is skipped and it attempts to actually perform the assignment (which fails). The rest is just figuring out how it threw and returning the result.</p>\n\n<h2>Test code</h2>\n\n<p><strong>VBA</strong></p>\n\n<pre><code>Option Explicit\n\nDim hta\n\nSub Test()\n    Debug.Print HostType    'VBA\nEnd Sub\n\nSub window_onload()\n     hta = True\nEnd Sub\n\nFunction HostType()\n    On Error Resume Next\n    If hta Then\n        HostType = \"HTA\"\n    Else\n        Dim foo\n        Set foo = foo\n        If Err.Number = 13 Then\n            HostType = \"VBA\"\n        Else\n            HostType = \"VBS\"\n        End If\n    End If\nEnd Function\n</code></pre>\n\n<p><strong>VBScript</strong></p>\n\n<pre><code>WSCript.Echo HostType\n\nDim hta\n\nSub window_onload()\n     hta = True\nEnd Sub\n\nFunction HostType()\n    On Error Resume Next\n    If hta Then\n        HostType = \"HTA\"\n    Else\n        Dim foo\n        Set foo = foo\n        If Err.Number = 13 Then\n            HostType = \"VBA\"\n        Else\n            HostType = \"VBS\"\n        End If\n    End If\nEnd Function\n</code></pre>\n\n<p><strong>HTA</strong></p>\n\n<pre><code>&lt;HTML&gt;\n    &lt;BODY&gt;\n        &lt;script type=\"text/vbscript\"&gt;\n            Dim hta\n\n            Sub Test()\n                MsgBox HostType \n            End Sub\n\n            Sub window_onload()\n                 hta = True\n            End Sub\n\n            Function HostType()\n                On Error Resume Next\n                If hta Then\n                    HostType = \"HTA\"\n                Else\n                    Dim foo\n                    Set foo = foo\n                    If Err.Number = 13 Then\n                        HostType = \"VBA\"\n                    Else\n                        HostType = \"VBS\"\n                    End If\n                End If\n            End Function\n        &lt;/script&gt;\n        &lt;button onclick=\"vbscript:Test()\"&gt;Click me&lt;/button&gt; \n    &lt;/BODY&gt;\n&lt;/HTML&gt;\n</code></pre>\n\n<hr>\n\n<p><strong>EDIT:</strong></p>\n\n<p>FWIW, the one-liner referenced above if <code>Option Explicit</code> isn't needed is simply this:</p>\n\n<pre><code>Function HostString()\n    HostString = Application &amp; document &amp; WScript\nEnd Function\n</code></pre>\n\n<p>All three objects have a default property that returns a <code>String</code>.  In VBScript, this will return \"Windows Script Host\". In VBA, it will return the name of the host (i.e. \"Microsoft Excel\" in Excel). In HTA it will return \"[object]\".</p>\n"}, {"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1550251726, "post_id": 54714127, "comment_id": 96214260, "body": "Nice! I caught the VBScript label thing when I was playing around with it, but I didn&#39;t think to make it a function call."}], "tags": [], "owner": {"reputation": 15773, "user_id": 893670, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h53Sy.png?s=128&g=1", "display_name": "Kul-Tigin", "link": "https://stackoverflow.com/users/893670/kul-tigin"}, "is_accepted": false, "score": 5, "last_activity_date": 1550251367, "last_edit_date": 1550251367, "creation_date": 1550251000, "answer_id": 54714127, "question_id": 54679157, "link": "https://stackoverflow.com/questions/54679157/how-can-my-code-find-out-if-its-running-as-vbscript-hta-or-vba/54714127#54714127", "title": "How can my code find out if it&#39;s running as VBScript, .HTA, or VBA?", "body": "<p>Although I agree with <a href=\"https://stackoverflow.com/questions/54679157/how-can-my-code-find-out-if-its-running-as-vbscript-hta-or-vba#comment96147732_54679157\">@this</a> here's my <code>Option Explicit</code>-safe method with no <code>On Error</code> statements that uses <code>Window_OnLoad</code> listener for HTA (like <a href=\"https://stackoverflow.com/users/4088852/comintern\">Comintern</a> did) and a line label trick to distinguish VBScript from VBA.</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim IsInHTA, IsInVBScript\n\nSub Window_Onload()\n    IsInHTA = True\nEnd Sub\n\nSub LineLabelTest()\n'VBA and VB6 (maybe VB5 too, IDK) treats \"DummyLabel:\" as a line label\n'VBScript treats \"DummyLabel\" as an expression to call and treats \":\" as a statement separator.\nDummyLabel:\nEnd Sub\n\nSub DummyLabel()\n    'this is called by the LineLabelTest subroutine only in VBScript\n    IsInVBScript = True\nEnd Sub\n\nFunction HostType()\n    LineLabelTest\n\n    If IsInVBScript Then\n        If IsInHTA Then \n            HostType = \"HTA\"\n        Else\n            HostType = \"VBS\" 'Other hosts incuding WSH, ASP, Custom\n        End If\n    Else\n        HostType = \"VBA\" 'VBA or VB6 (maybe VB5 too, don't know)\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 178, "user_id": 11058699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LRCyk.png?s=128&g=1", "display_name": "CyberTaco", "link": "https://stackoverflow.com/users/11058699/cybertaco"}, "is_accepted": false, "score": 1, "last_activity_date": 1565738331, "creation_date": 1565738331, "answer_id": 57486404, "question_id": 54679157, "link": "https://stackoverflow.com/questions/54679157/how-can-my-code-find-out-if-its-running-as-vbscript-hta-or-vba/57486404#57486404", "title": "How can my code find out if it&#39;s running as VBScript, .HTA, or VBA?", "body": "<p>For anyone coming across this in the future, this is the final code I ended up making, and it works! Special thanks to everyone in this thread that contributed the ideas that came together to make this work! :-)</p>\n\n<pre><code>'------------------------------------------------------------------\n'--- Function ScriptEngine\n'---\n'--- Returns a string containing which script engine this is\n'--- running in.\n'--- Will return either \"VBScript\",\"VBA\", or \"HTA\".\n\nFunction ScriptEngine\n\n    On Error Resume Next\n\n    ScriptEngine=\"VBA\"\n\n    ReDim WScript(0)\n    If Err.Number=501 Then ScriptEngine=\"VBScript\"\n\n    Err.Clear\n\n    ReDim Window(0)\n    If Err.Number=501 Then ScriptEngine=\"HTA\"\n\n    On Error Goto 0\n\n    End Function\n\n'-------------------------------------------------------------------\n</code></pre>\n"}], "owner": {"reputation": 178, "user_id": 11058699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LRCyk.png?s=128&g=1", "display_name": "CyberTaco", "link": "https://stackoverflow.com/users/11058699/cybertaco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 960, "favorite_count": 4, "answer_count": 7, "score": 7, "last_activity_date": 1565738518, "creation_date": 1550090851, "last_edit_date": 1565738518, "question_id": 54679157, "link": "https://stackoverflow.com/questions/54679157/how-can-my-code-find-out-if-its-running-as-vbscript-hta-or-vba", "title": "How can my code find out if it&#39;s running as VBScript, .HTA, or VBA?", "body": "<p>(Final edit: The code I ended up putting together that works is way down below, it's probably the final reply in this thread. :-) )</p>\n\n<p>I'm trying to write generic copy-and-paste code that will work in a standalone VBScript (a .vbs file), in a .hta file, and as VBA (for instance, in an Excel file). To do that, I need some way for the code itself to tell what engine it's running in.</p>\n\n<p>The best idea I've heard so far involved testing if certain objects exist or not, but in VBA, that fails at compile time (so I can't bypass it with On Error), so that didn't work out. Trying to find out the name of the file it's running didn't end up being viable; that's one of the things that's done differently depending on which of the three script engines the code's running in.\nI would love to have something simple like this, but am not sure what to fill it in with:</p>\n\n<p>Edit: Most responses so far involve checking for possibly non-existent objects, which outright does not work in VBA with Option Explicit on (it throws a compile-time error, so On Error doesn't work, and turning off Option Explicit is not an option). Is there some other roundabout / out-of-the-box way to find out what's needed here?</p>\n\n<pre><code>Option Explicit\n\n'--- Returns a string containing which script engine this is running in,\n'--- either \"VBScript\", \"VBA\", or \"HTA\".\n\nFunction ScriptEngine()\n\n    If {what goes here?} Then ScriptEngine=\"VBS\"\n    If {what goes here?} Then ScriptEngine=\"VBA\"\n    If {what goes here?} Then ScriptEngine=\"HTA\"\n    End Function\n</code></pre>\n\n<p>If this is filled in right, you should be able to copy and paste that function into any VBA, VBS, or HTA file without modification, call it, and get a result instead of an error, even when Option Explicit is on.\nWhat's the best way to go about this?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1245, "user_id": 5938276, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh6.googleusercontent.com/-zolc90p2grA/AAAAAAAAAAI/AAAAAAAAOBU/TloVnogHxWU/photo.jpg?sz=128", "display_name": "Al Grant", "link": "https://stackoverflow.com/users/5938276/al-grant"}, "edited": false, "score": 0, "creation_date": 1550092749, "post_id": 54679323, "comment_id": 96148041, "body": "I was copying the recipient value from the watch window in VBA IDE - it wasn&#39;t copying the full length of the string which was part of the confusion. Have also added edits as suggested. Thanks."}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 2, "last_activity_date": 1550091547, "creation_date": 1550091547, "answer_id": 54679323, "question_id": 54679130, "link": "https://stackoverflow.com/questions/54679130/looping-over-worksheets-and-applying-filter/54679323#54679323", "title": "Looping over worksheets and applying filter", "body": "<p>You have a worksheet variable, so use it! No need for activating sheets when the sheet is explicitly defined. </p>\n\n<p>You should change to worksheet variable to <strong>not</strong> match key VBA words/objects. I have changed it to <code>ws</code> since your naming method was too close to pre-defined VBA objects</p>\n\n<p>Also, you build a string with the <code>&amp;</code> operator, not <code>+</code></p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub someFunction()\n\nDim mystring As String\nDim recipient As Range\nDim colNum As Long\nDim ws As Worksheet\n\nFor Each ws In ActiveWorkbook.Worksheets\n    Select Case ws.Name\n        Case \"ABC Group\", \"DEF Group\"\n            ' DO NOTHING\n        Case Else\n            colNum = Application.WorksheetFunction.Match(\"a column name\", ws.Rows(5), 0)\n            ws.Rows(5).AutoFilter Field:=colNum - 1, Criteria1:=\"=some string*\"\n\n                For Each recipient In ws.Range(\"B6:B\" &amp; ws.UsedRange.Rows.Count).SpecialCells(xlCellTypeVisible).Cells\n                    mystring = mystring &amp; recipient &amp; \";\"\n                Next recipient\n\n    End Select\nNext ws\n\nmystring = Left(mystring, Len(mystring) - 1) '&lt;-- Remove last instance of \";\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1245, "user_id": 5938276, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh6.googleusercontent.com/-zolc90p2grA/AAAAAAAAAAI/AAAAAAAAOBU/TloVnogHxWU/photo.jpg?sz=128", "display_name": "Al Grant", "link": "https://stackoverflow.com/users/5938276/al-grant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 54679323, "answer_count": 1, "score": 0, "last_activity_date": 1550128857, "creation_date": 1550090731, "last_edit_date": 1550128857, "question_id": 54679130, "link": "https://stackoverflow.com/questions/54679130/looping-over-worksheets-and-applying-filter", "title": "Looping over worksheets and applying filter", "body": "<p>When I loop over worksheets and apply a filter it only adds the recipients (column B) from the first matching sheet, not the subsequent sheets.</p>\n\n<pre><code>Public Sub someFunction()\n\nDim recipients As String\nDim recipient As Range\nDim worksheet As worksheet\n\nFor Each worksheet In ActiveWorkbook.Worksheets\n    Select Case worksheet.Name\n        Case \"ABC Group\", \"DEF Group\"\n            ' DO NOTHING\n        Case Else\n            Worksheets(Worksheet.Name).Activate\n            colNum = Application.WorksheetFunction.Match(\"a column name\", ActiveSheet.Rows(5), 0)\n            Rows(5).AutoFilter Field:=colNum - 1, Criteria1:=\"=some string*\"\n            With ActiveSheet ' ThisWorkbook.Sheets(\"Sheet1\") - Or ActiveSheet\n                For Each recipient In .Range(\"B6:B\" &amp; .UsedRange.Rows.Count).SpecialCells(xlCellTypeVisible).Cells\n                    recipients = recipients + recipient + \";\"\n                Next recipient\n            End With\n    End Select\nNext\nEnd Sub\n</code></pre>\n\n<p>The filter is however correctly applied to all matching sheets, and in the GUI the code finishes on the final sheet.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1550090550, "post_id": 54679037, "comment_id": 96147060, "body": "<code>ThisWorkbook</code> is always going to be the workbook that contains the VBA code you&#39;re looking at."}, {"owner": {"reputation": 11, "user_id": 7748390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6dcbe3aef7bdbc2526a6e14c0a97e2?s=128&d=identicon&r=PG&f=1", "display_name": "Leandro Teixeira", "link": "https://stackoverflow.com/users/7748390/leandro-teixeira"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1550090946, "post_id": 54679037, "comment_id": 96147263, "body": "Exactly. The problem is that wen I use &quot;ThisWorkbook.Activate&quot;, it does not change the &quot;ActiveWorkbook.Name&quot; to the Workbook where the macro is programmed."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1550091019, "post_id": 54679037, "comment_id": 96147291, "body": "@LeandroTeixeira is there a reason why you wouldn&#39;t say <code>WB_Ativa = ThisWorkbook.Name</code> then?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1550091069, "post_id": 54679037, "comment_id": 96147315, "body": "The point is, <code>ThisWorkbook</code> is always the same workbook. Do you have a reference to &quot;the other workbook&quot; somewhere? Is it VBA code that&#39;s opening it, or the user? Is it always the same file name? If so, then you can do <code>Set theOtherBook = Workbooks(&quot;theOtherBook.xlsx&quot;)</code> and go <code>theOtherBook.Activate</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1550091261, "post_id": 54679037, "comment_id": 96147385, "body": "@MatteoNNZ my understanding is that they have two workbooks opened, and they want to activate the one that isn&#39;t <code>ThisWorkbook</code>. Hard to answer this question without knowing anything about that other workbook other than, well, it&#39;s opened, and not active."}, {"owner": {"reputation": 11, "user_id": 7748390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6dcbe3aef7bdbc2526a6e14c0a97e2?s=128&d=identicon&r=PG&f=1", "display_name": "Leandro Teixeira", "link": "https://stackoverflow.com/users/7748390/leandro-teixeira"}, "edited": false, "score": 0, "creation_date": 1550091424, "post_id": 54679037, "comment_id": 96147450, "body": "The other workbook is opened by other Sub and it is a variable. (Workbooks(Arq_Cronograma).Sheets(&quot;Tarefas&quot;).Activate) and it&#39;s working correcly."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1550091466, "post_id": 54679037, "comment_id": 96147464, "body": "Good. Then <code>Workbooks(Arq_Cronograma).Activate</code> should do what you need! Or is <code>Arq_Cronograma</code> out of scope?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1550091581, "post_id": 54679037, "comment_id": 96147519, "body": "Rather than using ThisWorkbook, which appears to be working as intended, why not use something such as Dim SrcWB as Workbook, DstWB as Workbook, Set each, and use those when qualifying?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1550091782, "post_id": 54679037, "comment_id": 96147608, "body": "@Cyril if one of the two workbooks involved is <code>ThisWorkbook</code>, IMO copying that reference to a variable is only going to make the code harder to follow. <code>ThisWorkbook</code> is unambiguously <code>ThisWorkbook</code>. I can stand behind <code>srcWb</code> and <code>dstWb</code> <i>parameters</i> for a procedure that performs operations across any two workbooks, but I would deem copying the object reference of <code>ThisWorkbook</code> to another variable, harmful."}, {"owner": {"reputation": 11, "user_id": 7748390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6dcbe3aef7bdbc2526a6e14c0a97e2?s=128&d=identicon&r=PG&f=1", "display_name": "Leandro Teixeira", "link": "https://stackoverflow.com/users/7748390/leandro-teixeira"}, "edited": false, "score": 0, "creation_date": 1550091838, "post_id": 54679037, "comment_id": 96147629, "body": "The WB_Ativa variable is only a test line I put to see if the instruction ThisWorkbook.Activate is working. But this line shows that it&#39;s not working, because it remains in the other workbook."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1550092093, "post_id": 54679037, "comment_id": 96147729, "body": "Try taking everything you have after <code>Me.Hide</code>, and put that in whatever code is invoking the form."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1550092882, "post_id": 54679037, "comment_id": 96148090, "body": "I can&#39;t reproduce the issue. What version of Excel are you using, and can you please <a href=\"https://stackoverflow.com/posts/54679037/edit\">edit</a> your question so that it contains a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that consistently reproduces the problem? There are too many unknowns here."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1550093058, "post_id": 54679037, "comment_id": 96148151, "body": "Add a <code>DoEvents</code>.  Judging by your screenshot, you&#39;ve probably managed to deadlock it somewhere."}, {"owner": {"reputation": 11, "user_id": 7748390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6dcbe3aef7bdbc2526a6e14c0a97e2?s=128&d=identicon&r=PG&f=1", "display_name": "Leandro Teixeira", "link": "https://stackoverflow.com/users/7748390/leandro-teixeira"}, "edited": false, "score": 0, "creation_date": 1550093239, "post_id": 54679037, "comment_id": 96148224, "body": "I put the code before the Userform.Show and it worked... I use this all over my program that is very big.. And this works everywhere. Only in this case of this OK button click that it&#39;s not working.."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1550093314, "post_id": 54679037, "comment_id": 96148258, "body": "The OK button should do <code>Me.Hide</code> <i>and nothing else</i> though."}, {"owner": {"reputation": 11, "user_id": 7748390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6dcbe3aef7bdbc2526a6e14c0a97e2?s=128&d=identicon&r=PG&f=1", "display_name": "Leandro Teixeira", "link": "https://stackoverflow.com/users/7748390/leandro-teixeira"}, "edited": false, "score": 0, "creation_date": 1550093606, "post_id": 54679037, "comment_id": 96148416, "body": "I&#39;m using Office 365 ProPlus. Excel Version 1808(16.0.10730.20264) 64 bit. My older Excel where this program worked was 32 bits."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1550094080, "post_id": 54679037, "comment_id": 96148632, "body": "@LeandroTeixeira You&#39;re probably lucky that it worked at all - based on what it looks like you&#39;re trying to do (I&#39;m <i>still</i> not entirely clear on that based on the question and comments), it seems pretty close to how I would demonstrate how to cause a deadlock."}, {"owner": {"reputation": 11, "user_id": 7748390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6dcbe3aef7bdbc2526a6e14c0a97e2?s=128&d=identicon&r=PG&f=1", "display_name": "Leandro Teixeira", "link": "https://stackoverflow.com/users/7748390/leandro-teixeira"}, "edited": false, "score": 0, "creation_date": 1550094437, "post_id": 54679037, "comment_id": 96148791, "body": "DoEvents did not solve the problem"}], "owner": {"reputation": 11, "user_id": 7748390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6dcbe3aef7bdbc2526a6e14c0a97e2?s=128&d=identicon&r=PG&f=1", "display_name": "Leandro Teixeira", "link": "https://stackoverflow.com/users/7748390/leandro-teixeira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1039, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550095246, "creation_date": 1550090368, "last_edit_date": 1550095246, "question_id": 54679037, "link": "https://stackoverflow.com/questions/54679037/the-instruction-thisworkbook-activate-is-not-working", "title": "The instruction ThisWorkbook.Activate is not working", "body": "<p>I have two workbooks. In the first one, I call a macro that activate the other one and take several data from there. Then it opens an UserForm, where it runs a macro in the OK button click. In this moment, the function ThisWorkbook.Activate doesn't work. The ActiveWorkbook.Name remains the other one. But when the macro stops, the Activeworkbook turn correct. Why this can happen. (I didn't have this problem in older Excel Version I had)</p>\n\n<p>I tried to change screenupdating. I tried to wait a time before and after activate.  I tried to unprotect sheet. I have no idea of what to do.</p>\n\n<pre><code>Private Sub btOK_Click()    \n    'Application.ScreenUpdating = True    \n    Me.Hide    \n    Plan_Inser_Ativ = ValorVariavel(\"Plan_Inser_Ativ\") 'Function to Take a recorded text of Sheet Name (This is working)    \n    ThisWorkbook.Unprotect    \n    ThisWorkbook.Sheets(Plan_Inser_Ativ).Activate 'I tried to activate the workbook by this method, but this is not working    \n    ThisWorkbook.Activate 'I tried to activate by this other method, but this is not working too    \n    'Application.Wait (Now + TimeValue(\"0:00:03\"))    \n    ThisWorkbook.Activate 'I tried to insist in it to see what happens :-)    \n    WB_Ativa = ActiveWorkbook.Name 'The WB_Ativa variable remains with the other Workbook name.    \n    Stop 'When the macro stops, if I place the mouse over the ActiveWorkbook.Name statement, it shows that the active Workbook is correct. But before the macro to stop, it was not.`\n    ..    \n    ..    \n    ..    \n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/JTdET.png\" alt=\"Print Screen of Macro variable states\"></p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "answers": [{"tags": [], "owner": {"reputation": 58, "user_id": 8482598, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5133b545defe9913bfafc13de45673c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leighholling", "link": "https://stackoverflow.com/users/8482598/leighholling"}, "is_accepted": false, "score": 0, "last_activity_date": 1550138723, "creation_date": 1550138723, "answer_id": 54687797, "question_id": 54678718, "link": "https://stackoverflow.com/questions/54678718/vba-to-create-pivot/54687797#54687797", "title": "VBA to create pivot", "body": "<p>Thanks to anyone who may have been looking at this but I have fixed this now please see amended code below.</p>\n\n<pre><code>Sub createPivot()\nDim PSheet As Worksheet, Dsheet As Worksheet\nDim PCache As PivotCache\nDim Ptable As PivotTable\nDim pRange As Range\nDim lastRow As Long\nDim lastCol As Long\n\n On Error Resume Next\n\nApplication.DisplayAlerts = False\n\nWorksheets(\"by Account\").Delete\n\nSheets.Add After:=ActiveSheet\n\nActiveSheet.Name = \"by Account\"\n\nSet PSheet = Worksheets(\"by Account\")\nSet Dsheet = Sheets(1)\n\nlastRow = Sheet6.UsedRange.Row + Sheet6.UsedRange.Rows.Count - 4\nlastCol = Sheet6.UsedRange.Column + Sheet6.UsedRange.Columns.Count - 1\n\nSet pRange = Dsheet.Cells(4, 1).Resize(lastRow, lastCol)\n\n\n    ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n       pRange, Version:=xlPivotTableVersion14).CreatePivotTable _\n    TableDestination:=PSheet.Cells(1, 1), TableName:=\"byAccountPivotTable\", _\n        DefaultVersion:=xlPivotTableVersion14\n\n\n    ActiveSheet.PivotTables(\"byAccountPivotTable\").AddDataField ActiveSheet.PivotTables( _\n        \"byAccountPivotTable\").PivotFields(\"Amount\"), \"Sum of Amount\", xlSum\n\n     With ActiveSheet.PivotTables(\"byAccountPivotTable\").PivotFields(\"Account Code\")\n        .Orientation = xlColumnField\n        .Position = 1\n    End With\n\n    With ActiveSheet.PivotTables(\"byAccountPivotTable\").PivotFields(\"Surname\")\n       .Orientation = xlRowField\n       .Position = 1\n    End With\n\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 58, "user_id": 8482598, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5133b545defe9913bfafc13de45673c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leighholling", "link": "https://stackoverflow.com/users/8482598/leighholling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550138723, "creation_date": 1550088924, "last_edit_date": 1550089798, "question_id": 54678718, "link": "https://stackoverflow.com/questions/54678718/vba-to-create-pivot", "title": "VBA to create pivot", "body": "<p><a href=\"https://i.stack.imgur.com/Y7eWP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Y7eWP.png\" alt=\"Desired output\"></a><a href=\"https://i.stack.imgur.com/GBI6J.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GBI6J.png\" alt=\"Result from running the code\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/MP27D.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MP27D.png\" alt=\"Data Source\"></a>I have amended some code I found on the internet which I am trying to use to create a pivot table. I have used code name for one worksheet because it will be used on multiple workbooks whose sheet name will be different.</p>\n\n<p>When I run the below code it creates a pivot table but with just the area as a lone column</p>\n\n<p>What I want is surnames for rows and account codes for balances with a total at the end of each row.</p>\n\n<p>Please see code, and help me get this to populate the rows properly.</p>\n\n<pre><code>Sub InsertPivotTable()\n\n\n 'Declare Variables\n  Dim PSheet As Worksheet\n  Dim DSheet As Worksheet\n  Dim PCache As PivotCache\n  Dim PTable As PivotTable\n  Dim PRange As Range\n  Dim LastRow As Long\n  Dim LastCol As Long\n\n 'Insert a New Blank Worksheet\n  On Error Resume Next\n  Application.DisplayAlerts = False\n  Worksheets(\"byAccount\").Delete\n  Sheets.Add After:=ActiveSheet\n  ActiveSheet.Name = \"byAccount\"\n  Application.DisplayAlerts = True\n  Set PSheet = Worksheets(\"byAccount\")\n  Set DSheet = Worksheets(1)\n\n 'Define Data Range\n  LastRow = DSheet.Cells(Rows.Count, 4).End(xlUp).Row\n  LastCol = DSheet.Cells(1, Columns.Count).End(xlToLeft).Column\n  Set PRange = DSheet.Cells(4, 1).Resize(LastRow, LastCol)\n\n 'Define Pivot Cache\n  Set PCache = ActiveWorkbook.PivotCaches.Create _\n  (SourceType:=xlDatabase, SourceData:=PRange). _\n  CreatePivotTable(TableDestination:=PSheet.Cells(1, 1), _\n  TableName:=\"byAccountPivot\")\n\n'Insert Blank Pivot Table\n Set PTable = PCache.CreatePivotTable _\n(TableDestination:=PSheet.Cells(1, 1), TableName:=\"byAccountPivot\")\n\n 'Insert Row Fields\n  With ActiveSheet.PivotTables(\"byAccountPivot\").PivotFields(\"Surname\")\n .Orientation = xlRowField\n .Position = 1\n End With\n\n   With ActiveSheet.PivotTables(\"byAccountPivot\").PivotFields(\"Account Code\")\n  .Orientation = xlRowField\n  .Position = 2\n  End With\n\n  'Insert Column Fields\n   With ActiveSheet.PivotTables(\"byAccountPivot\").PivotFields(\"Amount\")\n  .Orientation = xlColumnField\n  .Position = 1\n  End With\n\n 'Insert Data Field\n With ActiveSheet.PivotTables(\"byAccountPivot\") \n .PivotFields (\"Amount\")\n .Orientation = xlDataField\n .Function = xlSum\n .NumberFormat = \"#,##0\"\n .Name = \"Amount\"\n End With\n\n'Format Pivot Table\n ActiveSheet.PivotTables(\"byAccountPivot\").ShowTableStyleRowStripes = True\n ActiveSheet.PivotTables(\"byAccountPivot\").TableStyle2 =      \"PivotStyleMedium9\"\n\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "if-statement", "copy", "paste"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11034423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2f45207b9c5d2674d19f0ebd54c6b4?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/11034423/billy"}, "edited": false, "score": 0, "creation_date": 1550093222, "post_id": 54678856, "comment_id": 96148217, "body": "Awesome!  Thanks so much!!"}], "tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": true, "score": 0, "last_activity_date": 1550089561, "creation_date": 1550089561, "answer_id": 54678856, "question_id": 54678709, "link": "https://stackoverflow.com/questions/54678709/how-do-i-use-a-macro-to-copy-and-paste-in-the-same-row-if-a-condition-is-met/54678856#54678856", "title": "How do I use a macro to copy and paste in the same row if a condition is met?", "body": "<p>You need to copy only the lines for which the condition returns true. Try:</p>\n\n<pre><code>If Worksheets(\"Sheet1\").Cells(i, 8).Value = \"Y\" Then\n    Worksheets(\"Sheet1\").Range(\"C\" &amp; i &amp; \":H\" &amp; i).copy Worksheets(\"Sheet1\").Range(\"B\" &amp; i &amp; \":G\" &amp; i)\nEnd If\n</code></pre>\n\n<p>An alternative: you can delete cell in column <code>C</code>, shifting the others towards the left:</p>\n\n<pre><code>If Worksheets(\"Sheet1\").Cells(i, 8).Value = \"Y\" Then\n    Worksheets(\"Sheet1\").Range(\"C\" &amp; i).Delete Shift:=xlToLeft\nEnd If\n</code></pre>\n\n<p>or</p>\n\n<pre><code>If Worksheets(\"Sheet1\").Cells(i, 8).Value = \"Y\" Then\n    Worksheets(\"Sheet1\").Cells(i, 3).Delete Shift:=xlToLeft\nEnd If\n</code></pre>\n\n<p>(note that this will shift <em>all</em> cells on a given row and may result in something you don't want)</p>\n"}], "owner": {"reputation": 5, "user_id": 11034423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2f45207b9c5d2674d19f0ebd54c6b4?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/11034423/billy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 54678856, "answer_count": 1, "score": 0, "last_activity_date": 1550089561, "creation_date": 1550088883, "question_id": 54678709, "link": "https://stackoverflow.com/questions/54678709/how-do-i-use-a-macro-to-copy-and-paste-in-the-same-row-if-a-condition-is-met", "title": "How do I use a macro to copy and paste in the same row if a condition is met?", "body": "<p>I'm still new to VBA and I'm running a report and the way I receive it a few of the rows have an additional column of data that I don't need but it messes up formatting for those entries.  For example, in Column B I have the profiles listed for everyone but for these few entries I have a number or something else (it isn't consistent for each one).  But for those same entries I have a \"Y\" in Column H that none of the other entries have.  I'm trying to search through the report for the \"Y\" in Column H and then copy columns C through H and paste it in Column B so that all the data aligns.  Out of a couple hundred entries there might be 6-7 that need to be moved. Here is some sample data that I hope shows the issue.  BTHOMAS  Column B is the problem in this example. </p>\n\n<pre><code>   A      |    B     |    C    |    D       |    E      |    F      |     G     |   H\n--------------------------------------------------------------------------------------------\n  ID      | PROFILE  | STATUS  | DATE ADDED | LAST USED | EXP DATE  |  P/W EXP  |\n  SBUTLER | NOM      | ENABLED | 9/9/2014   | 10/5/2018 | 00/00/00  |  N        |\n  WPERRY  | NOM      | ENABLED | 10/29/2014 | 10/4/2018 | 00/00/00  |  N        |\n  BTHOMAS | 1234     | NOM     | ENABLED    | 2/1/2017  | 9/28/2018 |  00/00/00 | Y\n\n</code></pre>\n\n<p>I've done a lot of research on copy and paste macros, but everything I have found is either a single cell or the entire row and they paste it to another sheet.  I just want to copy and paste in the same row.  Here is the code I have so far, unfortunately it moves every column.</p>\n\n<pre><code>Sub MoveColumns()\n\nLR = Cells(Rows.Count, \"B\").End(xlUp).Row\na = Worksheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Row\n\n    For i = 2 To a\n\n        If Worksheets(\"Sheet1\").Cells(i, 8).Value = \"Y\" Then\n            Range(\"C:H\").copy Range(\"B:G\")\n\n        End If\n\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>The expected result is for the report to be aligned like in the example below.  There is data in columns I through J so I can only copy columns C through H.  Thanks for your time.</p>\n\n<pre><code> A      |    B     |    C    |    D       |    E      |    F      |     G     |   H\n--------------------------------------------------------------------------------------------\n  ID      | PROFILE  | STATUS  | DATE ADDED | LAST USED | EXP DATE  |  P/W EXP  |\n  SBUTLER | NOM      | ENABLED | 9/9/2014   | 10/5/2018 | 00/00/00  |  N        |\n  WPERRY  | NOM      | ENABLED | 10/29/2014 | 10/4/2018 | 00/00/00  |  N        |\n  BTHOMAS | NOM      | ENABLED | 2/1/2017   | 9/28/2018 | 00/00/00  |  Y\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1550088992, "post_id": 54678444, "comment_id": 96146350, "body": "Never done this. Very odd. Why would users be allowed to modify db structure? Is it the same tables for all users? Build these tables into the master frontend."}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1550089287, "post_id": 54678444, "comment_id": 96146491, "body": "If these users are creating temp tables and queries in support of reporting functions, I would suggest Excel. It has excellent integration with Access."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1550089632, "post_id": 54678444, "comment_id": 96146635, "body": "This question is very broad, but have a look at <a href=\"https://stackoverflow.com/q/187506/7296893\">this Q&amp;A</a> about version control. I&#39;m using code like this to have an updater that pulls in new linked tables/queries/forms/modules while preserving user-created tables and queries."}, {"owner": {"reputation": 3, "user_id": 11058542, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-F-j2yrAEA2k/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQONgTSteLz2YXb_BQF3KWyhmr8KmQ/mo/photo.jpg?sz=128", "display_name": "Mark O", "link": "https://stackoverflow.com/users/11058542/mark-o"}, "edited": false, "score": 0, "creation_date": 1550092313, "post_id": 54678444, "comment_id": 96147830, "body": "Thank you all for the quick feedback.  All but 2 particular users will not be creating any tables or queries; this really is just for two users that while aren&#39;t developers will need to create queries and will need to run them from time to time.  Erik, I like your approach and will research that link.  It sounds like a solution that could work."}, {"owner": {"reputation": 3725, "user_id": 6777839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYN3g.jpg?s=128&g=1", "display_name": "Wolfgang Kais", "link": "https://stackoverflow.com/users/6777839/wolfgang-kais"}, "edited": false, "score": 0, "creation_date": 1550097977, "post_id": 54678444, "comment_id": 96150096, "body": "Why not give these special users another (blank) database to play with? That database could contain all linked tables but no frontend things like forms or reports that are to be updated with the new frontend version."}], "answers": [{"tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": true, "score": 0, "last_activity_date": 1550092597, "creation_date": 1550092597, "answer_id": 54679551, "question_id": 54678444, "link": "https://stackoverflow.com/questions/54678444/retain-created-tables-queries-in-front-end-database/54679551#54679551", "title": "Retain created tables/queries in front-end database", "body": "<p>This is a very strange situation but this is what I would do, as long as all they are adding is tables/queries and not forms/reports/vba code.</p>\n\n<p>These users can have their own Access file that they create their \"personal\" tables/queries and then link them to their copy of the front end. When you push a new front end all they have to do it re-link everything from their personal access file to their front end.</p>\n\n<p>You can start the file by copying their current front end and deleting all forms/reports/modules but leave all tables (linked and local) and queries. Then delete these additions from their front end and link them from the copy. Train them to add new items to that copy and linking them instead of just adding them to the front end file.</p>\n\n<p>Essentially give each of these users and additional data/back end file that is personal to them.</p>\n"}], "owner": {"reputation": 3, "user_id": 11058542, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-F-j2yrAEA2k/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQONgTSteLz2YXb_BQF3KWyhmr8KmQ/mo/photo.jpg?sz=128", "display_name": "Mark O", "link": "https://stackoverflow.com/users/11058542/mark-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 54679551, "answer_count": 1, "score": 0, "last_activity_date": 1550092597, "creation_date": 1550087878, "last_edit_date": 1550088879, "question_id": 54678444, "link": "https://stackoverflow.com/questions/54678444/retain-created-tables-queries-in-front-end-database", "title": "Retain created tables/queries in front-end database", "body": "<p>I have an access database split which has two different types of users.  One base of users creates tables/queries on their local front-end.  When they get a new version of the front end they lose those tables/queries.</p>\n\n<p>I want to establish a process for retaining/transferring them to the new front end. Has anyone done this before?</p>\n\n<p>So I'm thinking something like this:</p>\n\n<p>Before the front-end on the local machine gets replaced, compare the tables/queries against the network copy. Any tables/queries found should be exported/imported into the new version.</p>\n\n<p>Any direction or guidance would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1550088007, "post_id": 54678409, "comment_id": 96145887, "body": "This should do it <code>Criteria1:=&quot;&lt;&gt;&quot; &amp; sCriteria</code>. That&#39;s if you&#39;re checking the whole cell contents. Otherwise <code>Criteria1:=&quot;&lt;&gt;*&quot; &amp; sCriteria &amp; &quot;*&quot;</code>"}, {"owner": {"reputation": 3, "user_id": 10108404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9488c03f816381c6013c2f3d56ef551?s=128&d=identicon&r=PG&f=1", "display_name": "Tejinder Mangat", "link": "https://stackoverflow.com/users/10108404/tejinder-mangat"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1550092008, "post_id": 54678409, "comment_id": 96147699, "body": "Hi @SJR, thank you for your input. I&#39;ve tried this but unfortunately it ends up deleting every row including the ones with the values I&#39;m trying to save. I have updated the code snippet in my original post above, could you please take a look and see if you might know what I&#39;m missing?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1550092702, "post_id": 54678409, "comment_id": 96148012, "body": "OK dates are a bit tricky in Autofilter. Are they actual dates formatted in that way or just straight text?"}, {"owner": {"reputation": 3, "user_id": 10108404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9488c03f816381c6013c2f3d56ef551?s=128&d=identicon&r=PG&f=1", "display_name": "Tejinder Mangat", "link": "https://stackoverflow.com/users/10108404/tejinder-mangat"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1550093723, "post_id": 54678409, "comment_id": 96148481, "body": "@SJR Just straight text"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1550094583, "post_id": 54678409, "comment_id": 96148842, "body": "Tbh, it&#39;s a bit of a faff and I hate Excel dates! Autofilter is generally better than looping but in this case I would go for the latter, or wait for someone is better at dates than me."}, {"owner": {"reputation": 3, "user_id": 10108404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9488c03f816381c6013c2f3d56ef551?s=128&d=identicon&r=PG&f=1", "display_name": "Tejinder Mangat", "link": "https://stackoverflow.com/users/10108404/tejinder-mangat"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1550095082, "post_id": 54678409, "comment_id": 96149041, "body": "@SJR Fair enough. Dates work a lot better in OpenOffice Calc for me. What if we pretended it wasn&#39;t a date I was looking to keep but a random piece of text like &quot;Mac&quot;? Would that make it easier?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1550138332, "post_id": 54678409, "comment_id": 96163197, "body": "That should work fine - try it. But change the inputbox type to 2 which is string (1 is a number I think)."}, {"owner": {"reputation": 3, "user_id": 10108404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9488c03f816381c6013c2f3d56ef551?s=128&d=identicon&r=PG&f=1", "display_name": "Tejinder Mangat", "link": "https://stackoverflow.com/users/10108404/tejinder-mangat"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1550162665, "post_id": 54678409, "comment_id": 96177943, "body": "@SJR that worked, thank you! I will update my question  above with the solution :)"}], "owner": {"reputation": 3, "user_id": 10108404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9488c03f816381c6013c2f3d56ef551?s=128&d=identicon&r=PG&f=1", "display_name": "Tejinder Mangat", "link": "https://stackoverflow.com/users/10108404/tejinder-mangat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 186, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550164912, "creation_date": 1550087758, "last_edit_date": 1550164912, "question_id": 54678409, "link": "https://stackoverflow.com/questions/54678409/how-can-i-delete-rows-that-dont-meet-conditions-of-user-input", "title": "How can I delete rows that don&#39;t meet conditions of user input?", "body": "<p>I want to record a macro that will delete any row in a data table that DOES NOT match a cell value in Column G that a user defines and shifts the remaining rows up. For example, if I want to delete any rows that don't have \"Dec 2018\" in Column G.</p>\n\n<p>My understanding is that this code from Excel Campus below could generate a pop up box for a user to define what they're looking for, but I am unclear on how to change the conditions so that it deletes any row that doesn't match the condition rather than matching the condition:</p>\n\n<pre><code>Sub RemoveOldReleases()\n'Display Yes/No message prompt before deleting rows\n'Source: https://www.excelcampus.com/vba/delete-rows-cell-values/\n\nDim lo As ListObject\nDim lRows As Long\nDim vbAnswer As VbMsgBoxResult\nDim sCriteria As Variant\n\n  'Set reference to the sheet and Table.\n  Set lo = RAW.ListObjects(1)\n  lo.Parent.Activate 'Activate sheet that Table is on.\n\n  'Clear any existing filters\n  lo.AutoFilter.ShowAllData\n\n  'Ask user for input\n  sCriteria = Application.InputBox(Prompt:=\"Please enter the release month your trying to keep in the format Sep 2018\" _\n                                    &amp; vbNewLine &amp; \"Leave the box empty to filter for blanks.\", _\n                                    Title:=\"Filter Criteria\", _\n                                    Type:=2)\n\n  'Exit if user presses Cancel button\n  If sCriteria = False Then Exit Sub\n\n  '1. Apply Filter\n  lo.Range.AutoFilter Field:=7, Criteria1:=sCriteria\n\n  'Count Rows &amp; display message\n  On Error Resume Next\n    lRows = WorksheetFunction.Subtotal(103, lo.ListColumns(1).DataBodyRange.SpecialCells(xlCellTypeVisible))\n  On Error GoTo 0\n\n  vbAnswer = MsgBox(lRows &amp; \" Rows will be deleted.  Do you want to continue?\", vbYesNo, \"Delete Rows Macro\")\n\n  If vbAnswer = vbYes Then\n\n    'Delete Rows\n    Application.DisplayAlerts = False\n      lo.DataBodyRange.SpecialCells(xlCellTypeVisible).Delete\n    Application.DisplayAlerts = True\n\n    'Clear Filter\n    lo.AutoFilter.ShowAllData\n\n  End If\n\nEnd Sub\n</code></pre>\n\n<p>Here is a screenshot of my data table: <a href=\"https://i.stack.imgur.com/KhXmK.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/KhXmK.png</a></p>\n\n<p>My workbook name: MasterSKUImport.xlsm</p>\n\n<p>My worksheet name: RAW</p>\n\n<p>Cell Range: A1:J100000</p>\n\n<p>Column with value: G</p>\n\n<p>Example of a value to search for: \"Sep 2018\"</p>\n\n<p>Bonus points if I can generate the default value in the pop up box to always be the previous month in the format Mmm YYYY (Sep 2018).</p>\n\n<p>UPDATE:</p>\n\n<p>I've tried this code as suggested by @SJR and it works!:</p>\n\n<pre><code>Sub RemoveOldReleases()\n\nDim ws As Worksheet\n\nSet ws = ThisWorkbook.Worksheets(\"RAW\")\n\n  'Ask user for input\n  sCriteria = Application.InputBox(Prompt:=\"Please enter the Release Month you're trying to keep in the format Mmm YYYY (ex. Sep 2018)\", _\n                                Title:=\"Release Month\", _\n                                Default:=Format(DateAdd(\"m\", -1, Date), \"mmm yyyy\"), _\n                                    Type:=2)\n\n  'Exit if user presses Cancel button\n  If sCriteria = False Then Exit Sub\n\n  '1. Apply Filter\n  ws.Range(\"$A$1:$J$100000\").AutoFilter Field:=7, Criteria1:=\"&lt;&gt;*\" &amp; sCriteria &amp; \"*\", Operator:=xlFilterValues\n\n    'Delete Rows\n    Application.DisplayAlerts = False\n      ws.Range(\"$A$2:$J$100000\").SpecialCells(xlCellTypeVisible).Delete\n    Application.DisplayAlerts = True\n\n    'Clear Filter\n    ws.Range(\"$A$1:$J$100000\").AutoFilter\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1550090136, "creation_date": 1550090136, "answer_id": 54678988, "question_id": 54678361, "link": "https://stackoverflow.com/questions/54678361/how-to-fill-multiple-bookmarks-formfields-in-word-from-the-same-field-in-acces/54678988#54678988", "title": "How to fill multiple Bookmarks / FormFields in Word from the same field in Access using VBA", "body": "<p>Building on the code in the question and the background question...</p>\n\n<p>Word can duplicate the content of a bookmark using <code>REF</code> field codes. Since form fields also use bookmark identifiers, this will work with existing form fields as well as bookmarked content. REF fields can be inserted directly, if a person is familiar with doing so OR by inserting a cross-reference to the bookmark.</p>\n\n<p>Referring to the work-around for inserting more than 255 characters, in this case it will be necessary to also place a bookmark around the range being inserted and to update the <code>REF</code> fields so that they mirror the bookmark content throughout the document. The modified section of code is below.</p>\n\n<pre><code>'Declarations to be added at the beginning of the procedure\nDim fld As Word.Field\nDim bkmName As String\n\n'Name of form field, bookmark to be added and text in REF field code\nbkmName = \"txtReasonforReward\"     \n\n'Existing code\nIf doc.ProtectionType &lt;&gt; wdNoProtection Then\n   doc.Unprotect\nEnd If\nSet rng = doc.Bookmarks(bkmName).Range\nrng.MoveStart wdCharacter, -1\nx = rng.Characters.First\nrng.FormFields(1).Delete\nrng.Text = x &amp; Me![Reason for Reward]\n\n' New code\n'Leave that single character out of the range for the bookmark\nrng.MoveStart wdCharacter, 1\n'Bookmark the inserted content\ndoc.Bookmarks.Add bkmName, rng\n'Update fields so that REF's pick up the bookmark content\nFor Each fld In doc.Fields\n    If fld.Type = wdFieldRef Then\n        fld.Update\n    End If\nNext\n\ndoc.Protect wdAllowOnlyFormFields, True\n</code></pre>\n\n<p>This approach will get a bit unwieldy if it needs to be applied to many fields. It might make sense to do something like write the bookmark names to a <code>Tag</code> property of the controls in the Access form then loop the controls to pick up bookmark name and data from the control, rather than writing each out explicitly - but this is just a thought for the future.</p>\n\n<p>All that being said, the \"modern\" way to achieve this is to work with content controls instead of form fields/bookmarks. Content controls do not have the 255 character limit, the document can be protected as a form, multiple content controls can have the same title (name) and/or tag. Furthermore, content controls can be \"mapped\" to a Custom XML Part stored in the document so that changing the content of one will change the content of another. Trying to describe all that would go beyond what should be in an \"answer\", here, but is all publicly available by searching the Internet.</p>\n\n<p>Personally, if this were my project and knowing what I know of it: If form fields are not required in the document (no user input via the fields is expected) I would use bookmarks and REF fields, only. </p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1550190543, "creation_date": 1550190543, "answer_id": 54701102, "question_id": 54678361, "link": "https://stackoverflow.com/questions/54678361/how-to-fill-multiple-bookmarks-formfields-in-word-from-the-same-field-in-acces/54701102#54701102", "title": "How to fill multiple Bookmarks / FormFields in Word from the same field in Access using VBA", "body": "<p>There are so may ways to do this kind of thing.  Take a look at the approach below and see if you can get it to work.  </p>\n\n<pre><code>Option Compare Database\n' This concept uses Docvariables in MS Word\nSub PushToWord()\n\nDim wapp As Word.Application\nDim wdoc As Word.Document\nDim db As DAO.Database\nDim fld As DAO.Field\nDim rs As DAO.Recordset\nDim filenm As String\nDim NumFields As Integer\nDim i As Integer\n\nSet db = CurrentDb\nSet rs = db.OpenRecordset(\"tbl_CustomerData\")\n\nSet wapp = New Word.Application\nwapp.Visible = True\n\n\nSet rs = DBEngine(0)(0).OpenRecordset(\"SELECT * FROM tbl_CustomerData\")\n\nIf rs.RecordCount &gt; 0 Then\n  rs.MoveFirst\n\n  Do While Not rs.EOF\n     For i = 0 To rs.Fields.Count - 1\n        Set fld = rs.Fields(i)\n        Debug.Print fld.Name, fld.Value\n            If fld.Value = 20 Then\n                filenm = \"C:\\Users\\Ryan\\Desktop\\Coding\\Integrating Access and Word\\From Access to Word\\Letter1.doc\"\n                    Set wdoc = wapp.Documents.Open(filenm)\n                wapp.ActiveDocument.Variables(\"Name\").Value = rs.Fields(\"Name\").Value\n            End If\n     Next\n     rs.MoveNext\n  Loop\n  Set fld = Nothing\n  rs.Close\nEnd If\nSet rs = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>The code runs from Access, and you can fire it off any number of ways (button click event, form load event, some other object event, etc.)</p>\n"}], "owner": {"reputation": 65, "user_id": 5083487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/351nC.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5083487/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 843, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1550190543, "creation_date": 1550087573, "question_id": 54678361, "link": "https://stackoverflow.com/questions/54678361/how-to-fill-multiple-bookmarks-formfields-in-word-from-the-same-field-in-acces", "title": "How to fill multiple Bookmarks / FormFields in Word from the same field in Access using VBA", "body": "<p>I had previously been using some VBA to pass fields from Access into a Word document, until coming up against the 255 character limit. Assistance from this <a href=\"https://stackoverflow.com/questions/54670845/how-to-get-around-the-character-limit-on-formfields-vba-passing-from-access-to-w/\">site</a> has led me to now use Bookmarks instead of Form Fields.</p>\n\n<p>I was originally filling many different fields on Word and in some instances using the same data from Access in two places on the Word document. I was achieving this by calling:</p>\n\n<pre><code>.FormFields(\"txtReasonforReward\").Result = Me![Reason for Reward]\n.FormFields(\"txtReasonforReward2\").Result = Me![Reason for Reward]\n</code></pre>\n\n<p>As I now have a different way of filling the \"Reason for Reward\" box, to circumvent the character limit (code below), I'm not sure how to fill \"txtReasonforReward2\". I do have several instances where I've added a second field and stuck a 2 on the end... I'm not convinced this is the best way so if anybody can advise on how to achieve this with both FormFields and Bookmarks, I'd be really grateful.</p>\n\n<pre><code>Dim objWord As Object\nSet objWord = CreateObject(\"Word.Application\")\nobjWord.Visible = True\nSet doc = objWord.Documents.Open(***path to file***, , True)\n\nDim rng As Word.Range\nDim x As String\n\nWith doc\n.FormFields(\"txtFirstName\").Result = Me![First Name]\n.FormFields(\"txtLastName\").Result = Me![Last Name]\n`examples cut for clarity...\n.FormFields(\"txtHRID\").Result = Me![ID]\n.FormFields(\"txtPeriod\").Result = Me![Period]\n\nIf doc.ProtectionType &lt;&gt; wdNoProtection Then\n   doc.Unprotect\nEnd If\n\nSet rng = doc.Bookmarks(\"txtReasonforReward\").Range\nrng.MoveStart wdCharacter, -1\nx = rng.Characters.First\nrng.FormFields(1).Delete\nrng.Text = x &amp; Me![Reason for Reward]\ndoc.Protect wdAllowOnlyFormFields, True\n\n.Visible = True\n.Activate\n\nEnd With\n\nobjWord.View.ReadingLayout = True\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 4, "creation_date": 1550086813, "post_id": 54678118, "comment_id": 96145304, "body": "(<a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">Please don&#39;t use <code>.Select</code>/<code>.Activate</code></a>). Also, what is <code>Cells(RR, 33).Select</code>? Does that not throw an error? At the very least I&#39;d think that needs to be <code>Cells(33,&quot;RR&quot;)</code>?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1550086986, "post_id": 54678118, "comment_id": 96145386, "body": "Shouldn&#39;t <code>RR</code> be <code>RV</code>?"}, {"owner": {"reputation": 23, "user_id": 11058425, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HpcAD63T_E4/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM_H5o9HcTXk9ZrC2OCDFST1zpx1A/mo/photo.jpg?sz=128", "display_name": "Nuno Filipe", "link": "https://stackoverflow.com/users/11058425/nuno-filipe"}, "edited": false, "score": 0, "creation_date": 1550087112, "post_id": 54678118, "comment_id": 96145432, "body": "&#39;cells(RR, 33).select&#39; RR would be the value of cell &quot;AI2&quot; which would match the row that has the info that needs copying, where the 33 would be the column (AG)"}, {"owner": {"reputation": 23, "user_id": 11058425, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HpcAD63T_E4/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM_H5o9HcTXk9ZrC2OCDFST1zpx1A/mo/photo.jpg?sz=128", "display_name": "Nuno Filipe", "link": "https://stackoverflow.com/users/11058425/nuno-filipe"}, "edited": false, "score": 0, "creation_date": 1550087338, "post_id": 54678118, "comment_id": 96145544, "body": "I corrected that but still, when I make the value of cell &quot;AI2&quot; change, even though it becomes unequal to &quot;0&quot;, it does not trigger anything, but no error messages show"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1550087771, "post_id": 54678118, "comment_id": 96145763, "body": "Worksheet_Change will not pickup a change due to a formula, only ones done manually."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1550088101, "post_id": 54678118, "comment_id": 96145923, "body": "To extend on @ScottCraner comment, you need to change your <code>Worksheet_Change</code> event to trigger when a manual change is made that you expect will make a change to <code>Range(&quot;AI2&quot;)</code>. So, it looks like you need your macro to look for changes in <code>Column AH</code> rather the entire sheet"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1550088483, "post_id": 54678118, "comment_id": 96146117, "body": "If your value in AI2 = 5, what range will you be copying?"}, {"owner": {"reputation": 23, "user_id": 11058425, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HpcAD63T_E4/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM_H5o9HcTXk9ZrC2OCDFST1zpx1A/mo/photo.jpg?sz=128", "display_name": "Nuno Filipe", "link": "https://stackoverflow.com/users/11058425/nuno-filipe"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1550088755, "post_id": 54678118, "comment_id": 96146237, "body": "@urdearboy that would make the reference cell &quot;AH5&quot; and the range to copy &quot;AB5:AG5&quot;"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1550089132, "post_id": 54678118, "comment_id": 96146421, "body": "I don&#39;t see why <code>AH5</code> is relevant here. If <code>AI2 = 5</code>, you want to copy <code>AB:AG</code> on 5th row? And if <code>AI2 = 10</code> you want to copy <code>AB:AG</code> on 10th row? If so, the solution I provided you will, <i>should</i>, work"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1550092433, "post_id": 54678118, "comment_id": 96147892, "body": "@Nuno Filipe: You cannot upvote, yet. But soon when you&#39;ll have 15 reputation you can come back and do so. Thanks for the kind reply."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11058425, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HpcAD63T_E4/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM_H5o9HcTXk9ZrC2OCDFST1zpx1A/mo/photo.jpg?sz=128", "display_name": "Nuno Filipe", "link": "https://stackoverflow.com/users/11058425/nuno-filipe"}, "edited": false, "score": 0, "creation_date": 1550090072, "post_id": 54678736, "comment_id": 96146841, "body": "this worked to some extent, as it is always copying the top row within the (AB:AG) column range no matter the row within column 34. I will try to figure out how your code works as I don&#39;t know what half of those commands mean.  Thank you :)"}, {"owner": {"reputation": 23, "user_id": 11058425, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HpcAD63T_E4/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM_H5o9HcTXk9ZrC2OCDFST1zpx1A/mo/photo.jpg?sz=128", "display_name": "Nuno Filipe", "link": "https://stackoverflow.com/users/11058425/nuno-filipe"}, "edited": false, "score": 0, "creation_date": 1550091002, "post_id": 54678736, "comment_id": 96147282, "body": "@urdearboy I got it to work, the issue was that the <code>If Range(&quot;AI2&quot;) &gt; 0...</code>  Needed to be <code>If Range(&quot;AI2&quot;) &lt;&gt; 0...</code> Because the way &quot;AI2&quot; formula is written =IFERROR(SUM(1+AH:AH),&quot;0&quot;) the cell value was 1+whatever value would be in the AH column, so i&#39;m guessing the macro was always looking for the 1. when i changed the &quot;&gt;&quot; to &quot;&lt;&gt;&quot; it worked perfectly :)  Nonetheless I will still try to learn your code so i can eventually write working macros with my own knowledge  Thank you very much for the help :D"}, {"owner": {"reputation": 23, "user_id": 11058425, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HpcAD63T_E4/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM_H5o9HcTXk9ZrC2OCDFST1zpx1A/mo/photo.jpg?sz=128", "display_name": "Nuno Filipe", "link": "https://stackoverflow.com/users/11058425/nuno-filipe"}, "reply_to_user": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1550091797, "post_id": 54678736, "comment_id": 96147614, "body": "@VBasic2008 both of them worked and I thank you both, for the time and patience you expended with my post. I upvoted both solutions and accepted urdearboy&#39;s answer because his macro pasted the info in a new row every time it ran, making it so i keep all the info logged of  any row i edit in collumn &quot;AH&quot;  I hope that if we speak again, I will at least be able to understand the code  Again, Thank you very much for all the help and my apologies for the eventual dead neuron. Cheers"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 1, "last_activity_date": 1550091156, "last_edit_date": 1550091156, "creation_date": 1550089019, "answer_id": 54678736, "question_id": 54678118, "link": "https://stackoverflow.com/questions/54678118/how-can-i-set-the-value-of-a-cell-in-cells-select-command-to-the-value-of-a-ce/54678736#54678736", "title": "How can I set the value of a cell in Cells().Select command to the value of a cell that has a formula in it?", "body": "<p>I am limiting the scope of your <code>Worksheet_Change</code> to only fire when a change is registered in <code>Column AH</code> since this is the column that will trigger a formula change in <code>Column AI</code></p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Column = 34 Then\n        If Range(\"AI2\") &lt;&gt; 0 Then\n            Macro2\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p></p>\n\n<pre><code>Sub Macro2()\n\nDim cs As Worksheet: Set cs = ThisWorkbook.Sheets(\"Sheet1\")\nDim ps As Worksheet: Set ps = ThisWorkbook.Sheets(\"Sheet2\")\n\nDim xRow As Long, LR As Long\nLR = ps.Range(\"A\" &amp; ps.Rows.Count).End(xlUp).Offset(1).Row\nxRow = cs.Range(\"AI2\").Value\n\ncs.Range(cs.Cells(xRow, \"AB\"), cs.Cells(xRow, \"AG\")).Copy\n    ps.Range(\"A\" &amp; LR).PasteSpecial xlPasteValues\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1550099546, "last_edit_date": 1550099546, "creation_date": 1550089717, "answer_id": 54678892, "question_id": 54678118, "link": "https://stackoverflow.com/questions/54678118/how-can-i-set-the-value-of-a-cell-in-cells-select-command-to-the-value-of-a-ce/54678892#54678892", "title": "How can I set the value of a cell in Cells().Select command to the value of a cell that has a formula in it?", "body": "<h1>Copy Range to First Empty Cell</h1>\n\n<h2>Calculate</h2>\n\n<p>If you are using a formula in the cell range <code>AI2</code> you <strong>should</strong> use the <strong>Worksheet Calculate</strong> event which will occur everytime the formula is being calculated.</p>\n\n<p><strong>Standard Module</strong></p>\n\n<pre><code>Option Explicit\n\nPublic Const strRange As String = \"AI2\"\nPublic vntValue As Variant\n\nSub macro1()\n\n    Dim rng As Range  ' Target Cell Range\n    Dim RV As Long    ' Row Value\n\n    ' In Target Worksheet\n    With ThisWorkbook.Sheets(\"Sheet2\")\n        ' Calculate the first empty (unused) cell in column A (A1 not included).\n        Set rng = .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1)\n    End With\n\n    ' In Source Worksheet\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        ' Write the value of Row Cell to Row Value.\n        RV = .Range(strRange).Value\n        With .Cells(RV, \"AH\") ' or 33\n            ' Copy range from \"AB\" to \"AG\" in row defined by Row Value in\n            ' Source Worksheet to the range from \"A\" to \"F\" in row of Target\n            ' Cell Range in Target Worksheet.\n            rng.Resize(, 6) = Range(.Offset(0, -6), .Offset(0, -1)).Value\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>Sheet1</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Calculate()\n    If vntValue &lt;&gt; Range(strRange).Value Then\n        vntValue = Range(strRange).Value\n        If Range(strRange).Value &lt;&gt; \"0\" Then macro1\n    End If\nEnd Sub\n</code></pre>\n\n<p><strong>ThisWorkbook</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_Open()\n    vntValue = Worksheets(\"Sheet1\").Range(strRange).Value\nEnd Sub\n</code></pre>\n\n<h2>Change</h2>\n\n<p>If you are manually changing the values in the cell range <code>AI2</code>, you <strong>have to</strong> use the <strong>Worksheet Change</strong> event.</p>\n\n<p><strong>Standard Module</strong></p>\n\n<pre><code>Option Explicit\n\nSub macro1()\n\n    Dim rng As Range  ' Target Cell Range\n    Dim RV As Long    ' Row Value\n\n    ' In Target Worksheet\n    With ThisWorkbook.Sheets(\"Sheet2\")\n        ' Calculate the first empty (unused) cell in column A (A1 not included).\n        Set rng = .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1)\n    End With\n\n    ' In Source Worksheet\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        ' Write the value of Row Cell to Row Value.\n        RV = .Range(\"AI2\").Value\n        ' In cell at the intersection of Row Value and column \"AH\".\n        With .Cells(RV, \"AH\") ' or 33\n            ' Copy range from \"AB\" to \"AG\" in row defined by Row Value in\n            ' Source Worksheet to the range from \"A\" to \"F\" in row of Target\n            ' Cell Range in Target Worksheet.\n            rng.Resize(, 6) = Range(.Offset(0, -6), .Offset(0, -1)).Value\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>Sheet1</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n     Const cCell As String = \"AI2\"\n     If Target = Range(cCell) Then\n         If Range(cCell).Value &lt;&gt; \"0\" Then macro1\n     End If\nEnd Sub\n</code></pre>\n\n<p>Like in the <strong>Calculate</strong> version, you might also want to use a public variable (<code>vntValue</code>) to prevent triggering <code>macro1</code> in case the value in cell range <code>AI2</code> hasn't actually changed.</p>\n"}], "owner": {"reputation": 23, "user_id": 11058425, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HpcAD63T_E4/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM_H5o9HcTXk9ZrC2OCDFST1zpx1A/mo/photo.jpg?sz=128", "display_name": "Nuno Filipe", "link": "https://stackoverflow.com/users/11058425/nuno-filipe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 54678736, "answer_count": 2, "score": 2, "last_activity_date": 1550099546, "creation_date": 1550086680, "last_edit_date": 1550091529, "question_id": 54678118, "link": "https://stackoverflow.com/questions/54678118/how-can-i-set-the-value-of-a-cell-in-cells-select-command-to-the-value-of-a-ce", "title": "How can I set the value of a cell in Cells().Select command to the value of a cell that has a formula in it?", "body": "<p>I'm trying to make a macro that copies the values inside certain cells of sheet1 and pastes then in sheet2.</p>\n\n<p>This is a formula that i wrote inside cell \"AI2\":</p>\n\n<pre><code>=IFERROR(SUM(1+AH:AH),\"0\")\n</code></pre>\n\n<p>and it produces a number that I want to use in the macro as a variable row coordinate.</p>\n\n<p>This is the code i have in my worksheet in order to trigger the macro:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Excel.Range)\n     If Range(\"AI2\") &lt;&gt; 0 Then\n     Call macro1\n     End If\nEnd Sub\n</code></pre>\n\n<p>And this is the macro:</p>\n\n<pre><code>Sub macro1()\nDim RV As Integer\nRV = Sheets(\"sheet1\").Range(\"AI2\").Value\nCells(RR, 33).Select\nRange(ActiveCell.Offset(0, -6), ActiveCell.Offset(0, -1)).Select\nSelection.Copy\nSheets(\"sheet2\").Select\nRange(\"A1048576\").Select\nSelection.End(xlUp).Select\nActiveCell.Offset(1, 0).Range(\"A1\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nEnd Sub\n</code></pre>\n\n<p>If I delete the first 3 lines of code, the macro works, but I have to manually select the cell for the offsets to reference from.</p>\n\n<p>I need to make it so the value of cell \"AI2\" is used as the first coordinate in this line of code:</p>\n\n<pre><code>Cells(RR, 33).Select\n</code></pre>\n\n<p>I am very new to any kind of programming, but I want to learn this in order to achieve my goals for this spreadsheet and future ones with similar functions.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "is_accepted": true, "score": 0, "last_activity_date": 1550087840, "last_edit_date": 1550087840, "creation_date": 1550086819, "answer_id": 54678148, "question_id": 54677928, "link": "https://stackoverflow.com/questions/54677928/combobox-filter-list-based-on-input-text/54678148#54678148", "title": "Combobox - Filter list based on input text", "body": "<p>According to the documentation on the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/filter-function?f1url=https%3A%2F%2Fmsdn.microsoft.com%2Fquery%2Fdev11.query%3FappId%3DDev11IDEF1%26l%3Den-US%26k%3Dk(vblr6.chm1008912)%3Bk(TargetFrameworkMoniker-Office.Version%3Dv15)%26rd%3Dtrue\" rel=\"nofollow noreferrer\">Filter Function</a>, the <code>sourcearray</code> is a one-dimensional array of strings.  </p>\n\n<ul>\n<li>You are clearly specifying a multi-dimensional array with <code>Resize(790, 10)</code>.</li>\n<li>And <code>.Value</code> returns an array of variants, not strings.</li>\n</ul>\n\n<hr>\n\n<p>Upon review, an array or variants is OK, but it has to be one-dimensional; so you'll have to process the range, since even 1 column will result in a 2 dimensional array.  Here is what I would use to bridge the gap...</p>\n\n<pre><code>Function RangeToOneDemensionalArray(Target As Range) As Variant\nDim Cell As Range\nDim ResultArr\nDim i As Long\n\n    If Target Is Nothing Then Exit Function\n    ReDim ResultArr(Target.Count - 1) As String\n\n    For Each Cell In Target\n        ResultArr(i) = Cell.Value\n        i = i + 1\n    Next\n\n    RangeToOneDemensionalArray = ResultArr\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11058415, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Mg-iKqUn22E/AAAAAAAAAAI/AAAAAAAAAFo/jIgfthjQPHk/photo.jpg?sz=128", "display_name": "Tom Irlik", "link": "https://stackoverflow.com/users/11058415/tom-irlik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 54678148, "answer_count": 1, "score": 0, "last_activity_date": 1550087840, "creation_date": 1550085926, "question_id": 54677928, "link": "https://stackoverflow.com/questions/54677928/combobox-filter-list-based-on-input-text", "title": "Combobox - Filter list based on input text", "body": "<p>I am trying to modify the following code to allow for a combobox where the list is automatically filtered based on your input, similar to how a filter preview narrows fields when you are filtering a table column.</p>\n\n<p>The code is supposed to pull in the range A1:A791 for a list of 790 items I want included in the combobox dropdown. Originally, the filter worked when I defined a static array as follows:</p>\n\n<pre><code>Sub ComboBox1_Populate(Optional fltr As String)\nComboBox1.List = Filter(Array(\"qqq\", \"qqwww\", \"qqttt\", \"qwer\"), fltr)     \nEnd Sub\n\nPrivate Sub ComboBox1_KeyUp(ByVal KeyCode As MSForms.ReturnInteger, ByVal \nShift As Integer)\nCall ComboBox1_Populate(ComboBox1.Text)\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\nCall ComboBox1_Populate\nEnd Sub\n</code></pre>\n\n<p>However, when I instead try to filter the range values as follows, I receive a Type Mismatch runtime error 13 with the following:</p>\n\n<pre><code>Sub ComboBox1_Populate(Optional fltr As String)\nComboBox1.List = Filter(Sheets(\"DVTest\").Cells(2, 1).Resize(790, 10).Value, \nfltr)\nEnd Sub\n\nPrivate Sub ComboBox1_KeyUp(ByVal KeyCode As MSForms.ReturnInteger, ByVal \nShift As Integer)\nCall ComboBox1_Populate(ComboBox1.Text)\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\nCall ComboBox1_Populate\nEnd Sub\n</code></pre>\n\n<p>I am looking for advice on how I can get the same filtering capability in the combobox list based on the specified range, as opposed to the static array of 4 text options.</p>\n\n<p>Thanks for the help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1550083866, "post_id": 54677383, "comment_id": 96143956, "body": "What have you tried? Have you <a href=\"https://www.google.com/search?q=vba+loop+through+range\" rel=\"nofollow noreferrer\">searched at all</a> for how to loop through a range?  Or <a href=\"https://www.google.com/search?q=find+last+row+VBA\" rel=\"nofollow noreferrer\">find last row</a>?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1550084108, "post_id": 54677383, "comment_id": 96144073, "body": "What does your question have to do with the (ungrammatical) title of the question (which seems to be about converting non-integer values to integers)? The question is unclear. For example, what does &quot;end of the row in the same column&quot; even mean?"}, {"owner": {"reputation": 25, "user_id": 10072072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e04a248ae517dbf3bee67e2bb19b292?s=128&d=identicon&r=PG&f=1", "display_name": "Andy ", "link": "https://stackoverflow.com/users/10072072/andy"}, "edited": false, "score": 0, "creation_date": 1550085520, "post_id": 54677383, "comment_id": 96144686, "body": "sorry for not clear &quot;end of the row in same column&quot; mean copy cell (BD2) and pasted over same column until row 109, but not using (bd2:d) because this pass paste row 109."}], "answers": [{"comments": [{"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1550085966, "post_id": 54677893, "comment_id": 96144894, "body": "Your rows and columns are in the wrong order on <code>lastRow</code>"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 0, "last_activity_date": 1550097076, "last_edit_date": 1550097076, "creation_date": 1550085777, "answer_id": 54677893, "question_id": 54677383, "link": "https://stackoverflow.com/questions/54677383/how-to-value-to-integer-vba/54677893#54677893", "title": "how to value to integer VBA", "body": "<p>So you need to find the lastRow based on the column where the actual data is...</p>\n\n<p>Try something like this:</p>\n\n<pre><code>With worksheets(\"mySheet\")\n\n    Dim lastRow as Long\n    lastRow = .Cells(.Rows.Count,1).End(xlUp).Row 'this uses column A for example\n\n    .Range(\"BD2:BD\" &amp; lastRow).Formula = \"=TODAY()\"\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10072072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e04a248ae517dbf3bee67e2bb19b292?s=128&d=identicon&r=PG&f=1", "display_name": "Andy ", "link": "https://stackoverflow.com/users/10072072/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 54677893, "answer_count": 1, "score": -4, "last_activity_date": 1550097076, "creation_date": 1550083807, "last_edit_date": 1550084694, "question_id": 54677383, "link": "https://stackoverflow.com/questions/54677383/how-to-value-to-integer-vba", "title": "how to value to integer VBA", "body": "<p>I\u2019m trying to create VBA that allows me to copy the one of a cell and paste over until end of the row in the same column. \nBut I\u2019m unable to figure out how this works, I have a total of 109 rows with 20 columns and in column \u201cBD\u201d that is an empty column and I want to put today date and fill up rest of the same column until end of row.</p>\n\n<p>Please see the code at the bottom</p>\n\n<pre><code>Sub CopyInsert()\n\n    Range(\"BD2\").Select\n\n    ActiveCell.FormulaR1C1 = \"=TODAY()\"\n    Range(\"BD2\").Select\n    Selection.Copy\n    Range(Selection, ActiveCell.SpecialCells(xlLastCell)).Select\n    ActiveSheet.Paste\nEnd Sub  \n</code></pre>\n\n<p>This code is working fine but I\u2019m not getting the right result what these codes do is copy and paste over pass 109 rows mean is paste over up to around 2000 rows\nMy question is how can I copy and paste over until the end of the row like till row 109! If we have over 200 rows, how to copy and paste until end of the row, row 200 in one column! But not using (BD2:BD), I have tried (BD2:BD) and is paste over 109 rows is not stopped at the end of row.</p>\n\n<p>many thanks. </p>\n"}, {"tags": ["regex", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1459, "user_id": 5539694, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0d55a03f051017933f2a1b54eb50f92f?s=128&d=identicon&r=PG&f=1", "display_name": "learningbyexample", "link": "https://stackoverflow.com/users/5539694/learningbyexample"}, "edited": false, "score": 0, "creation_date": 1550092619, "post_id": 54677442, "comment_id": 96147975, "body": "Giving errors still   tmp2 = strColS   Set RegX3 = CreateObject(&quot;VBScript.RegExp&quot;)   With RegX3       .Global = True       .ignorecase = True       .Pattern = &quot;map\\s*(\\S+)&quot;       Set Mats2 = .Execute(tmp2)   End With   If (RegX3.Test(tmp2)) Then      Set Mats2 = RegX3.Execute(tmp2)      tmp2 = Mats2(0)   Else       With RegX3         .ignorecase = True         .Pattern = &quot;map\\s*(\\S+)&quot;         Set Mats2 = .Execute(tmp2)       End With       If (RegX3.Test(tmp2)) Then         tmp2 = Mats2(0)       End If   End If   Set Mats2 = Nothing   Set RegX3 = Nothing"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 1459, "user_id": 5539694, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0d55a03f051017933f2a1b54eb50f92f?s=128&d=identicon&r=PG&f=1", "display_name": "learningbyexample", "link": "https://stackoverflow.com/users/5539694/learningbyexample"}, "edited": false, "score": 0, "creation_date": 1550093576, "post_id": 54677442, "comment_id": 96148399, "body": "From your comment, I don&#39;t have a clue.  You did not mention in your question anything about an error.  What you asked for was a regex that would meet certain requirements.  The one I provided does that. If you have other problems, I suggest you ask a different question that clearly explains the problem.  Suggest you read the HELP pages for information as to <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask a Good Question</a>, and <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a> to help in formulating a good question."}, {"owner": {"reputation": 1459, "user_id": 5539694, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0d55a03f051017933f2a1b54eb50f92f?s=128&d=identicon&r=PG&f=1", "display_name": "learningbyexample", "link": "https://stackoverflow.com/users/5539694/learningbyexample"}, "edited": false, "score": 0, "creation_date": 1550151302, "post_id": 54677442, "comment_id": 96170776, "body": "Sorry, what I meant was that it does find the map but if it does not it would give the full text rather than just leaving it blank since &quot;map&quot; was not added in the text."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 1459, "user_id": 5539694, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0d55a03f051017933f2a1b54eb50f92f?s=128&d=identicon&r=PG&f=1", "display_name": "learningbyexample", "link": "https://stackoverflow.com/users/5539694/learningbyexample"}, "edited": false, "score": 0, "creation_date": 1550151846, "post_id": 54677442, "comment_id": 96171101, "body": "I suggest you familiarize yourself with the regex object methods.  In particular, you are using the <code>.test</code> method which tells you if there is or is not a match.  You can then decide what you want to return based on that result.  It is straightforward Boolean logic."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 1, "last_activity_date": 1550084020, "creation_date": 1550084020, "answer_id": 54677442, "question_id": 54676870, "link": "https://stackoverflow.com/questions/54676870/how-do-i-filter-for-a-specific-word-map-then-capture-the-next-text-up-until-th/54677442#54677442", "title": "How do I filter for a specific word (map) then capture the next text up until the next space?", "body": "<p>To extract the substring as you specify:</p>\n\n<pre><code>.ignorecase = True\n.pattern = \"map\\s*(\\S+)\"\n</code></pre>\n\n<p>or</p>\n\n<pre><code>.pattern = \"\\bmap\\s*(\\S+)\"\n</code></pre>\n\n<p>The substring will be in capturing group 1</p>\n\n<p>If there is no <code>map</code> then the <code>.test(..)</code> line will return <code>False</code></p>\n\n<h2>Regex Explained</h2>\n\n<pre><code>\\bmap\\s*(\\S+)\n</code></pre>\n\n<p>Options: Case\u00a0insensitive; ^$\u00a0don\u2019t\u00a0match\u00a0at\u00a0line\u00a0breaks</p>\n\n<ul>\n<li><a href=\"http://www.regular-expressions.info/wordboundaries.html\" rel=\"nofollow noreferrer\">Assert position at a word boundary</a> <code>\\b</code></li>\n<li><a href=\"http://www.regular-expressions.info/characters.html\" rel=\"nofollow noreferrer\">Match the character string \u201cmap\u201d literally</a> <code>map</code></li>\n<li><a href=\"http://www.regular-expressions.info/shorthand.html\" rel=\"nofollow noreferrer\">Match a single character that is a \u201cwhitespace character\u201d</a> <code>\\s*</code>\n\n<ul>\n<li><a href=\"http://www.regular-expressions.info/repeat.html\" rel=\"nofollow noreferrer\">Between zero and unlimited times, as many times as possible, giving back as needed (greedy)</a> <code>*</code></li>\n</ul></li>\n<li><a href=\"http://www.regular-expressions.info/brackets.html\" rel=\"nofollow noreferrer\">Match the regex below and capture its match into backreference number 1</a> <code>(\\S+)</code>\n\n<ul>\n<li><a href=\"http://www.regular-expressions.info/shorthand.html\" rel=\"nofollow noreferrer\">Match a single character that is NOT a \u201cwhitespace character\u201d</a> <code>\\S+</code>\n\n<ul>\n<li><a href=\"http://www.regular-expressions.info/repeat.html\" rel=\"nofollow noreferrer\">Between one and unlimited times, as many times as possible, giving back as needed (greedy)</a> <code>+</code></li>\n</ul></li>\n</ul></li>\n</ul>\n\n<p>Created with <a href=\"http://www.regexbuddy.com/\" rel=\"nofollow noreferrer\">RegexBuddy</a></p>\n"}], "owner": {"reputation": 1459, "user_id": 5539694, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0d55a03f051017933f2a1b54eb50f92f?s=128&d=identicon&r=PG&f=1", "display_name": "learningbyexample", "link": "https://stackoverflow.com/users/5539694/learningbyexample"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550084020, "creation_date": 1550081785, "last_edit_date": 1550083487, "question_id": 54676870, "link": "https://stackoverflow.com/questions/54676870/how-do-i-filter-for-a-specific-word-map-then-capture-the-next-text-up-until-th", "title": "How do I filter for a specific word (map) then capture the next text up until the next space?", "body": "<p>I am trying to get the text right after - Map in this case example it is \"AVE_NMHG_I_214_4010_XML_SAT\" and input that into each Map Name row within the column up until the next space character found in could end up being \"AVE_I_214_4010\" as another example. </p>\n\n<p>this is where I'm trying to make this fit.</p>\n\n<pre><code>Dim tmp As String\nDim RegX2 As Object, Mats1 As Object\n\ntmp = strColS\nSet RegX2 = CreateObject(\"VBScript.RegExp\")\nWith RegX2\n    .Global = True\n    .Pattern = \"Map\\d{7}\"\n    Set Mats1 = .Execute(tmp)\nEnd With\nIf (RegX2.Test(tmp)) Then\n   Set Mats1 = RegX2.Execute(tmp)\n   tmp = Mats1(0)\nElse\n    With RegX2\n      .Pattern = \"MAP\\d{9}\"\n      Set Mats1 = .Execute(tmp)\n    End With\n    If (RegX.Test(tmp)) Then\n        tmp = Mats1(0)\n    End If\nEnd If\nSet Mats1 = Nothing\nSet RegX2 = Nothing\n</code></pre>\n\n<p>Note: there isn't always a Map specified and sometimes it is defined as MAP or map.</p>\n\n<p>This code works by selecting the emails in outlook and then running the macro for only that selected emails.</p>\n\n<p>This is an example of a subject that has the</p>\n\n<p>Example Subject</p>\n\n<pre><code>RE: TS001889493 - Translation failure - Inbound - ( VEXP/ HONCE/ Document Type 214 - Map AVE_NMHG_I_214_4010_XML_SAT - Error Conditional Relationship Error in N103 (0066) [ ref:_00D50c9MW._5000z1J3cG8:ref ]\n</code></pre>\n\n<hr>\n\n<p>Example of body</p>\n\n<pre><code>Dear Valued Trading Partner,\n\nWe received the attached 214 transactions from Sender ID: VEXP/ Receiver ID: HONCE that failed due to Conditional Relationship Error in the N1_03 (0066).\n\nAs per the map logic, If either N103 or N104 is present, then the other is required as they are in conditional relationship with each other. But in the input file received, N104 value is missing hence the error.\n\nTransaction Details: #4# Attached\n\nPlease correct and resend the data.\n\nThank you, Simon Huggs | Sass support - Basic\n</code></pre>\n\n<hr>\n\n<p>What happens in the #num# is that it gets the sum of all these after making a match of the \"TS\" ticket ID.</p>\n\n<p>This is the code I have up until now</p>\n\n<pre><code>Option Explicit\nSub WritingTicketNumberAndfailuresnew()\n Dim xlApp As Object\n Dim xlWB As Object\n Dim xlSheet As Object\n Dim rCount, STicket, SticketNumber As Long\n Dim bXStarted As Boolean\n Dim enviro As String\n Dim strPath, SSubject As String\n\n Dim currentExplorer As Explorer\n Dim Selection As Selection\n Dim olItem As Outlook.MailItem\n Dim obj As Object\n Dim strColS, strColB, sassupport, sMailDateReceived, SFrom As String\n\n\n Dim Actions1, Actions2, Actions3, Actions4 As Boolean\n Dim I, cnt, email_needed As Integer\n\n' Get Excel set up\n     On Error Resume Next\n     Set xlApp = GetObject(, \"Excel.Application\")\n     If Err &lt;&gt; 0 Then\n         Application.StatusBar = \"Please wait while Excel source is opened ... \"\n         Set xlApp = CreateObject(\"Excel.Application\")\n         bXStarted = True\n     End If\n     On Error GoTo 0\n\n'Open a specific workbook to input the data the path of the workbook under the windows user account\n\n     enviro = CStr(Environ(\"USERPROFILE\"))\n     strPath = enviro &amp; \"\\Documents\\topthreeticket.xlsx\"\n     Set xlWB = xlApp.Workbooks.Open(strPath)\n     Set xlSheet = xlWB.Sheets(\"Sheet1\")\n\n\n' Add column names\n  xlSheet.Range(\"A1\") = \"Email Subject\"\n  xlSheet.Range(\"B1\") = \"Map Name\"\n  xlSheet.Range(\"C1\") = \"Case Number\"\n  xlSheet.Range(\"D1\") = \"No. Of Failures\"\n  xlSheet.Range(\"E1\") = \"Date\"\n  xlSheet.Range(\"F1\") = \"Week Number\"\n\n\nsassupport = \"sassuport@sass.com\"\n\n\nOn Error Resume Next\n'Find the next empty line of the worksheet\nrCount = xlSheet.Range(\"A\" &amp; xlSheet.Rows.Count).End(-4162).Row\n'needed for Exchange 2016. Remove if causing blank lines.\nrCount = rCount + 1\n\n' get the values from outlook\nSet currentExplorer = Application.ActiveExplorer\nSet Selection = currentExplorer.Selection\n    For Each obj In Selection\n    Set olItem = obj\n\n'collect the fields for ticket number and failure count\n    strColS = olItem.Subject\n    strColB = olItem.Body\n    SFrom = olItem.SenderEmailAddress\n    sMailDateReceived = olItem.ReceivedTime\n\nDim sFailures, stmp1, stmp2, stmp3 As String\nDim RegX As Object, Mats As Object\nDim Found As Boolean\n\n' Check the number of failures from body\n   sFailures = \"0\"\n\n   stmp1 = strColB\n   Set RegX = CreateObject(\"VBScript.RegExp\")\n   With RegX\n       .Global = True\n       .Pattern = \"#\\d+#\"\n       Set Mats = .Execute(stmp1)\n   End With\n   If (RegX.Test(stmp1)) Then\n       stmp2 = Mats(0)\n       Found = True\n       stmp3 = Mid(stmp2, 2, Len(stmp2) - 2)\n       sFailures = stmp3\n    Else\n       With RegX\n          .Pattern = \"#d\\d+\"\n          Set Mats = .Execute(stmp1)\n       End With\n       If (RegX.Test(stmp1)) Then\n           stmp2 = Mats(0)\n           Found = True\n           stmp3 = Mid(stmp2, 2, Len(stmp2) - 1)\n           sFailures = stmp3\n        End If\n    End If\n\n    Set Mats = Nothing\n    Set RegX = Nothing\n\nDim tmp As String\nDim RegX2 As Object, Mats1 As Object\n\ntmp = strColS\nSet RegX2 = CreateObject(\"VBScript.RegExp\")\nWith RegX2\n    .Global = True\n    .Pattern = \"Map\\d{7}\"\n    Set Mats1 = .Execute(tmp)\nEnd With\nIf (RegX2.Test(tmp)) Then\n   Set Mats1 = RegX2.Execute(tmp)\n   tmp = Mats1(0)\nElse\n    With RegX2\n      .Pattern = \"MAP\\d{9}\"\n      Set Mats1 = .Execute(tmp)\n    End With\n    If (RegX.Test(tmp)) Then\n        tmp = Mats1(0)\n    End If\nEnd If\nSet Mats1 = Nothing\nSet RegX2 = Nothing\n\n\n\nDim tempticketnum, tmpdate As String\nDim ticketnumposition As Integer\n'write them in the excel sheet\nIf SFrom = sassupport Then\n    xlSheet.Range(\"A\" &amp; rCount) = strColS\n    xlSheet.Range(\"B\" &amp; rCount) = tmp2\n    xlSheet.Range(\"C\" &amp; rCount) = tmp\n    xlSheet.Range(\"D\" &amp; rCount) = sFailures ' number of failures\n    xlSheet.Range(\"E\" &amp; rCount) = sMailDateReceived\n    rCount = rCount + 1\nEnd If\nNext\n\n     Set olItem = Nothing\n     Set obj = Nothing\n     Set currentExplorer = Nothing\n     Set xlSheet = Nothing\n     Set xlWB = Nothing\n     Set xlApp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1550080518, "post_id": 54676520, "comment_id": 96142365, "body": "The <code>.PasteSpecial</code> line has <code>Cells(5, x)</code> each time (the <code>5</code>, being the row, never changes).  Would you just need to increment that number?"}, {"owner": {"reputation": 809, "user_id": 6301517, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bae3b1b6120f28d727740eb0695836a2?s=128&d=identicon&r=PG&f=1", "display_name": "Yolo_chicken", "link": "https://stackoverflow.com/users/6301517/yolo-chicken"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1550080978, "post_id": 54676520, "comment_id": 96142583, "body": "Yes, the 5 would have to be 1+last import. I want to open a Word Document, click the Excel button to import into a new row, close word, open new document, repeat."}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 11047994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb16beb164ad046062f399f59dbc6be?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/11047994/mike"}, "is_accepted": false, "score": 0, "last_activity_date": 1550091556, "creation_date": 1550091556, "answer_id": 54679326, "question_id": 54676520, "link": "https://stackoverflow.com/questions/54676520/vba-paste-copied-value-from-word-into-next-empty-row-of-excel/54679326#54679326", "title": "VBA Paste Copied Value from Word into Next Empty Row of Excel", "body": "<p>First, find the last row number. Then, paste in last row + 1.</p>\n\n<pre><code>Dim LastRow as Double\nLastRow = ActiveSheet.UsedRange.Rows.Count\n' ...\nCells(LastRow + 1, 1).PasteSpecial (xlPasteValues)\n</code></pre>\n"}], "owner": {"reputation": 809, "user_id": 6301517, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bae3b1b6120f28d727740eb0695836a2?s=128&d=identicon&r=PG&f=1", "display_name": "Yolo_chicken", "link": "https://stackoverflow.com/users/6301517/yolo-chicken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550091556, "creation_date": 1550080369, "question_id": 54676520, "link": "https://stackoverflow.com/questions/54676520/vba-paste-copied-value-from-word-into-next-empty-row-of-excel", "title": "VBA Paste Copied Value from Word into Next Empty Row of Excel", "body": "<p>I have a Word Document with a few tables and I need to grab certain values and place them in an Excel File. There will be new Word documents each day to update the Excel file. This is what I have so far:</p>\n\n<pre><code>Private Sub copyTable_Button()\n\nDim WrdApp As Word.Application\nDim wrddoc As Word.Document\n\nSet WrdApp = GetObject(, \"Word.Application\")\nWrdApp.Visible = True\nSet wddoc = WrdApp.ActiveDocument\n\n'Column 1'\nCells(5, 1) = wrddoc.Name\n\n'Column 2 from table value\nwrddoc.Tables(1).Cell(1, 3).Range.Copy\nCells(5, 2).PasteSpecial (xlPasteValues)\n\n'Column 3 from table value\nwrddoc.Tables(1).Cell(1, 2).Range.Copy\nCells(5, 3).PasteSpecial (xlPasteValues)\n\n'Column 4 from table value\nwddoc.Tables(1).Cell(3, 2).Range.Copy\nCells(5, 4).PasteSpecial (xlPasteValues)\nEnd Sub\n</code></pre>\n\n<p>The Excel VBA selects the open Word document and places each table value  in the appropriate Excel column. I don't want to overwrite any values but instead copy the value in the next row down.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 1894533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcafca3884f7d1eb6ee4d2086ccc6966?s=128&d=identicon&r=PG", "display_name": "eGeekster", "link": "https://stackoverflow.com/users/1894533/egeekster"}, "edited": false, "score": 0, "creation_date": 1550080397, "post_id": 54676501, "comment_id": 96142306, "body": "Gah! How careless of me!"}, {"owner": {"reputation": 23, "user_id": 1894533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcafca3884f7d1eb6ee4d2086ccc6966?s=128&d=identicon&r=PG", "display_name": "eGeekster", "link": "https://stackoverflow.com/users/1894533/egeekster"}, "edited": false, "score": 1, "creation_date": 1550080421, "post_id": 54676501, "comment_id": 96142320, "body": "Great catch, by the way. Thank you! (I will best answer this once it allows me to in 11 minutes :-) )"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 23, "user_id": 1894533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcafca3884f7d1eb6ee4d2086ccc6966?s=128&d=identicon&r=PG", "display_name": "eGeekster", "link": "https://stackoverflow.com/users/1894533/egeekster"}, "edited": false, "score": 0, "creation_date": 1550080572, "post_id": 54676501, "comment_id": 96142390, "body": "@eGeekster - welcome. Not referring the correct worksheet causes quite a lot of problems with VBA. Btw, this is one of the most robust functions in VBA I am using, making the column a variable one - <code>lastRow()</code> - <a href=\"https://github.com/Vitosh/VBA_personal/blob/master/LastThings.vb\" rel=\"nofollow noreferrer\">github.com/Vitosh/VBA_personal/blob/master/LastThings.vb</a>"}, {"owner": {"reputation": 23, "user_id": 1894533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcafca3884f7d1eb6ee4d2086ccc6966?s=128&d=identicon&r=PG", "display_name": "eGeekster", "link": "https://stackoverflow.com/users/1894533/egeekster"}, "edited": false, "score": 0, "creation_date": 1550232722, "post_id": 54676501, "comment_id": 96203591, "body": "Appreciate the additional info, I have already noticed a number of ways to improve my code. The project I&#39;m currently undertaking requires a deeper understanding of VB that I&#39;m stumbling through. At this point, I&#39;m searching for a method similar to PHP&#39;s include/require. Any suggestions?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 23, "user_id": 1894533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcafca3884f7d1eb6ee4d2086ccc6966?s=128&d=identicon&r=PG", "display_name": "eGeekster", "link": "https://stackoverflow.com/users/1894533/egeekster"}, "edited": false, "score": 0, "creation_date": 1550234182, "post_id": 54676501, "comment_id": 96204330, "body": "@eGeekster - in general, you may add some additional libraries. But it depends on the context and what exactly is needed."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1550080321, "creation_date": 1550080321, "answer_id": 54676501, "question_id": 54676471, "link": "https://stackoverflow.com/questions/54676471/finding-the-first-empty-row-in-excel-with-vba-occasionally-causes-skipped-rows/54676501#54676501", "title": "Finding the first empty row in Excel with VBA occasionally causes skipped rows", "body": "<p>You have to refer the <code>ws</code> in the function:</p>\n\n<pre><code>Function firstBlankRow(ws As Worksheet) As Long\n     firstBlankRow = ws.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\nEnd Function\n</code></pre>\n\n<p>Otherwise it takes either the <code>ActiveSheet</code> or the sheet where the code is.</p>\n"}], "owner": {"reputation": 23, "user_id": 1894533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcafca3884f7d1eb6ee4d2086ccc6966?s=128&d=identicon&r=PG", "display_name": "eGeekster", "link": "https://stackoverflow.com/users/1894533/egeekster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 54676501, "answer_count": 1, "score": 1, "last_activity_date": 1550080321, "creation_date": 1550080233, "last_edit_date": 1550080272, "question_id": 54676471, "link": "https://stackoverflow.com/questions/54676471/finding-the-first-empty-row-in-excel-with-vba-occasionally-causes-skipped-rows", "title": "Finding the first empty row in Excel with VBA occasionally causes skipped rows", "body": "<p>When utilizing this function, every so often it seems to skip a few lines and writes to line 12 instead of line 9, even though the contents of those cells are empty. Any thoughts?</p>\n\n<pre><code>Function firstBlankRow(ws As Worksheet) As Long\n     firstBlankRow = Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "combobox", "cascading"], "comments": [{"owner": {"reputation": 393, "user_id": 1197934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49888a0530e8444121435d2486107224?s=128&d=identicon&r=PG", "display_name": "fbueckert", "link": "https://stackoverflow.com/users/1197934/fbueckert"}, "edited": false, "score": 1, "creation_date": 1550079775, "post_id": 54676326, "comment_id": 96141958, "body": "You have a typo.  Running the debugger should tell you exactly what line it&#39;s on."}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 0, "creation_date": 1550080384, "post_id": 54676326, "comment_id": 96142301, "body": "The code is VB.NET but you tagged this as VBA. Are you sure about the tags? VB.NET and VBA are two wildly different languages that shares the first two letters, no more."}, {"owner": {"reputation": 1, "user_id": 8554646, "user_type": "registered", "profile_image": "https://graph.facebook.com/2003302703240270/picture?type=large", "display_name": "Harry Bilney", "link": "https://stackoverflow.com/users/8554646/harry-bilney"}, "edited": false, "score": 0, "creation_date": 1550081915, "post_id": 54676326, "comment_id": 96143030, "body": "Fixed the typo, but now not getting anything in combobox cbFixture or cbMode"}, {"owner": {"reputation": 393, "user_id": 1197934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49888a0530e8444121435d2486107224?s=128&d=identicon&r=PG", "display_name": "fbueckert", "link": "https://stackoverflow.com/users/1197934/fbueckert"}, "edited": false, "score": 0, "creation_date": 1550082604, "post_id": 54676326, "comment_id": 96143380, "body": "You should ask a new question for your new problem.  If this one is solved, then you can either answer it yourself, or delete it if you feel it won&#39;t help others in the future."}], "answers": [{"comments": [{"owner": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 0, "creation_date": 1550680247, "post_id": 54677840, "comment_id": 96360323, "body": "That should be a parameter."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1550085541, "creation_date": 1550085541, "answer_id": 54677840, "question_id": 54676326, "link": "https://stackoverflow.com/questions/54676326/visual-basic-accdb-file-read-for-cascading-combo-box/54677840#54677840", "title": "Visual Basic ACCDB File Read for Cascading Combo Box", "body": "<p>You don't <em>select</em> any field(s), and property <em>Text</em> is only valid for the control having focus, so:</p>\n\n<pre><code>   .CommandText = \"SELECT * from Fixtures where [Manufacture]='\" &amp; Me.cbManufacture.Value &amp; \"';\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8554646, "user_type": "registered", "profile_image": "https://graph.facebook.com/2003302703240270/picture?type=large", "display_name": "Harry Bilney", "link": "https://stackoverflow.com/users/8554646/harry-bilney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1550085541, "creation_date": 1550079593, "question_id": 54676326, "link": "https://stackoverflow.com/questions/54676326/visual-basic-accdb-file-read-for-cascading-combo-box", "title": "Visual Basic ACCDB File Read for Cascading Combo Box", "body": "<p>So I've got an access database with three columns in: Manufacture, Fixture and Mode</p>\n\n<p>I'm using the code below to create cascading combo boxes in my form.</p>\n\n<pre><code>Imports System.Data.OleDb\n\n\nPublic Class Add_Fixtures\n   Dim con As New OleDbConnection\n   Dim constring As String\n   Dim cmd As New OleDbCommand\n   Dim dr As OleDbDataReader\n   Dim cmd1 As New OleDbCommand\n   Dim dr1 As OleDbDataReader\n   Dim cmd2 As New OleDbCommand\n   Dim dr2 As OleDbDataReader\n\nPrivate Sub Add_Fixtures_Load(sender As Object, e As EventArgs) Handles Me.Load\n    constring = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=|DataDirectory|/FixtureLibrary.accdb\"\n    With con\n        .ConnectionString = constring\n        .Open()\n    End With\n\n    With cmd\n        .Connection = con\n        .CommandType = CommandType.Text\n        .CommandText = \"SELECT DISTINCT Fixtures.Manufacture from Fixtures;\"\n    End With\n\n    dr = cmd.ExecuteReader()\n\n    While dr.Read\n        cbManufacture.Items.Add(dr(\"Manufacture\"))\n    End While\n\n    With cmd1\n        .Connection = con\n        .CommandType = CommandType.Text\n        .CommandText = \"SELECT  from Fixtures where [Manufacture]='\" &amp; Me.cbManufacture.Text &amp; \"';\"\n    End With\n\n    dr1 = cmd1.ExecuteReader()\n\n    While dr1.Read\n        cbFixture.Items.Add(dr1(\"Fixture\"))\n    End While\n\n    With cmd2\n        .Connection = con\n        .CommandType = CommandType.Text\n        .CommandText = \"SELECT DISTINCT Fixtures.Mode from Fixtures where [Fixture] ='\" &amp; Me.cbFixture.Text &amp; \"';\"\n    End With\n\n    dr2 = cmd2.ExecuteReader()\n\n    While dr2.Read\n        cbMode.Items.Add(dr2(\"Mode\"))\n    End While\nEnd Sub\nEnd Class\n</code></pre>\n\n<p>But on this line: dr1 = cmd1.ExecuteReader()</p>\n\n<p>I get this error</p>\n\n<p>System.Data.OleDb.OleDbException: 'The SELECT statement includes a reserved word or an argument name that is misspelled or missing, or the punctuation is incorrect.'</p>\n\n<p>Anyone have any ideas why or what is causing it?</p>\n\n<p>Cheers</p>\n"}, {"tags": ["excel", "vba", "exception", "try-catch"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 4, "creation_date": 1550078239, "post_id": 54675947, "comment_id": 96141091, "body": "vba doesn&#39;t support try catch. VB.net does"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1550078675, "post_id": 54675947, "comment_id": 96141333, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/44638867/vba-excel-try-catch\">VBA + Excel + Try Catch</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1550079699, "post_id": 54675947, "comment_id": 96141917, "body": "Any Microsoft documentation that is about &quot;Visual Basic&quot; is filed under .NET and is about VB.NET; <a href=\"https://docs.microsoft.com/en-us/office/vba/api/overview/\" rel=\"nofollow noreferrer\">here</a> is the docs.microsoft for VBA."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1550080609, "post_id": 54675947, "comment_id": 96142404, "body": "Are you programming in VB.NET or VBA? The compile error that I&#39;d expect in VBA would be &quot;Sub or Function not defined&quot; on the <code>Try</code> line.  If it got past that, it would fail with a generic &quot;Syntax error&quot; on the <code>Catch</code> line."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9344090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bddd37732dba9c5ea502bcb56bd84c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Lambert", "link": "https://stackoverflow.com/users/9344090/jimmy-lambert"}, "edited": false, "score": 0, "creation_date": 1550160737, "post_id": 54676005, "comment_id": 96176776, "body": "So I&#39;m assuming based on your response that It would not be possible to get the inner exception from the original exception that was sent. Thanks for the response."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21, "user_id": 9344090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bddd37732dba9c5ea502bcb56bd84c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Lambert", "link": "https://stackoverflow.com/users/9344090/jimmy-lambert"}, "edited": false, "score": 0, "creation_date": 1550163378, "post_id": 54676005, "comment_id": 96178411, "body": "what do you mean by that? The exception is basically the Case  number with associated err.Description in the error handler of the bottom version. Apologies if I have misunderstood."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 6, "last_activity_date": 1550078343, "creation_date": 1550078343, "answer_id": 54676005, "question_id": 54675947, "link": "https://stackoverflow.com/questions/54675947/error-when-trying-to-use-try-catch-blocks-within-excel-vba-to-get-inner-exceptio/54676005#54676005", "title": "Error when Trying to use Try-Catch blocks within excel VBA to get inner exceptions", "body": "<p>VBA doesn't support Try Catch. You can use error handling or more simply</p>\n\n<pre><code>On Error Resume Next\nSet sm = CreateObject(\"SpectrumManager.Application\")\nOn Error GoTo 0\nIf sm Is Nothing Then\n    MsgBox \"Can't Create Object\"\nEnd If\n</code></pre>\n\n<hr>\n\n<p>A simple error handling routine might look like:</p>\n\n<pre><code>Public Sub test()\n    Dim sm As Object\n    On Error GoTo errhand\n    Set sm = CreateObject(\"SpectrumManager.Application\")\n    'other code\n    Exit Sub\nerrhand:\n    Select Case Err.Number\n    Case 429\n        MsgBox \"Can't Create Object\"\n        'Case... other errors\n    End Select\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1550084203, "post_id": 54676437, "comment_id": 96144112, "body": "@QHarr it&#39;s not free, but it&#39;s not very expensive and it&#39;s totally worth it. Its author has also contributed very cool stuff in Rubberduck (giving it the ability to run unit tests in <i>any</i> host application, among other things), but the error handling &amp; call stack black magic is unlikely to ever be open-sourced."}], "tags": [], "owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "is_accepted": false, "score": 2, "last_activity_date": 1550080099, "creation_date": 1550080099, "answer_id": 54676437, "question_id": 54675947, "link": "https://stackoverflow.com/questions/54675947/error-when-trying-to-use-try-catch-blocks-within-excel-vba-to-get-inner-exceptio/54676437#54676437", "title": "Error when Trying to use Try-Catch blocks within excel VBA to get inner exceptions", "body": "<p>For those who are willing to consider commercial third party as options, there is the option to buy <a href=\"https://www.everythingaccess.com/vbwatchdog.asp\" rel=\"nofollow noreferrer\">vbWatchDog</a>, which enables a form of Try/Catch pattern with VBA. A possible sample:</p>\n\n<pre><code>Public Sub Derp(Faceplant As Boolean)\n  If Faceplant = False Then\n    ErrEx.DoFinally\n  End If\n\n  Debug.Print 1 / 0\n\nErrEx.Catch 91\n  Debug.Print \"I didn't set something on fire....\"\nErrEx.CatchAll\n  Debug.Print \"Welp. I failed.\"\nErrEx.Finally\n  Debug.Print \"Goodbye, cruel world.\"\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://www.everythingaccess.com/vbwatchdog/introduction.htm\" rel=\"nofollow noreferrer\">Relevant documentation</a></p>\n\n<p>Note: I'm a customer of vbWatchDog. </p>\n"}], "owner": {"reputation": 21, "user_id": 9344090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bddd37732dba9c5ea502bcb56bd84c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Lambert", "link": "https://stackoverflow.com/users/9344090/jimmy-lambert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15977, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1550160934, "creation_date": 1550078168, "last_edit_date": 1550160934, "question_id": 54675947, "link": "https://stackoverflow.com/questions/54675947/error-when-trying-to-use-try-catch-blocks-within-excel-vba-to-get-inner-exceptio", "title": "Error when Trying to use Try-Catch blocks within excel VBA to get inner exceptions", "body": "<p>I am working through excel and VBA. I am trying to get the inner exception from an automation exception, but to start off I need to get try catch blocks working in the first place. It looks like I've exactly replicated the syntax from the microsoft documentation. Here is the code:</p>\n\n<pre><code>Try\n    Set sm = CreateObject(\"SpectrumManager.Application\")\nCatch ex As Exception\n    MsgBox (\"Can't Create Object\") 'placeholder\n    'I want to get the inner exception from ex here\nEnd Try\n</code></pre>\n\n<p>The error message at End Try is this: \"Expected: If or Select or Sub or Function or Property or Type or With or Enum or end of statement\"\nThe error message at the Catch is this: \"Expected: end of statement\"</p>\n\n<p>What am I doing wrong? thanks for the help in advance.\nedit: I realize now that vba does not support try-catch blocks. That leads me to the question, is there any way to get an inner exception from the original exception that was sent? Or is that information lost when it is converted into a vba Error?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1550077984, "post_id": 54675725, "comment_id": 96140964, "body": "Microsoft discourage <code>ReadAll</code> for large files: <i>&quot;For large files, using the ReadAll method wastes memory resources. Other techniques should be used to input a file, such as reading a file line-by-line.&quot;</i>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1550078098, "post_id": 54675725, "comment_id": 96141019, "body": "Sounds like you&#39;re hitting the limits of <code>Application.Transpose</code>. Why not shape the array as a 2D variant array in the first place, and skip the <code>Application.Transpose</code> step (i.e. <code>Destination.Value = arrLines</code>, where <code>arrLines</code> is already shaped as needed)? Or, have the file properly formatted, and <i>import</i> its data?"}, {"owner": {"reputation": 781, "user_id": 6299848, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DwEAxXq6T1I/AAAAAAAAAAI/AAAAAAAAAPA/Bcu8ARbxjmw/photo.jpg?sz=128", "display_name": "simple-solution", "link": "https://stackoverflow.com/users/6299848/simple-solution"}, "edited": false, "score": 2, "creation_date": 1550078621, "post_id": 54675725, "comment_id": 96141304, "body": "Why don&#39;t you open the text files directly with workbook.open?"}], "answers": [{"tags": [], "owner": {"reputation": 893, "user_id": 10794555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0D8LRxW70DQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-icioZDBlm6V-nHzFzMNQ2LTv2Nmg/mo/photo.jpg?sz=128", "display_name": "Ama", "link": "https://stackoverflow.com/users/10794555/ama"}, "is_accepted": false, "score": 1, "last_activity_date": 1550079361, "creation_date": 1550079361, "answer_id": 54676259, "question_id": 54675725, "link": "https://stackoverflow.com/questions/54675725/best-way-to-read-a-very-large-array-into-excel-sheet/54676259#54676259", "title": "Best way to read a very large array into excel sheet", "body": "<p>You could use and automate the 'Data' -> 'From Text/CSV' wizard of Excel.</p>\n\n<p>Using the Macro recorder you end up with this, which should be a good start:</p>\n\n<pre><code>ActiveWorkbook.Queries.Add Name:=\"MyFile\", Formula:=\"let\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    Source = Table.FromColumns({Lines.FromBinary(File.Contents(\"\"C:\\Path\\MyFile.txt\"\"), null, null, 1252)})\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"in\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    Source\"\nActiveWorkbook.Worksheets.Add\nWith ActiveSheet.ListObjects.Add(SourceType:=0, Source:=\"OLEDB;Provider=Microsoft.Mashup.OleDb.1;Data Source=$Workbook$;Location=\"\"MyFile\"\";Extended Properties=\"\"\"\"\", Destination:=Range(\"$A$1\")).QueryTable\n    .CommandType = xlCmdSql\n    .CommandText = Array(\"SELECT * FROM [MyFile]\")\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .BackgroundQuery = True\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .PreserveColumnInfo = True\n    .ListObject.DisplayName = \"MyFile\"\n    .Refresh BackgroundQuery:=False\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1550084598, "post_id": 54677091, "comment_id": 96144287, "body": "If you could enlighten us how exactly did you do this?"}], "tags": [], "owner": {"reputation": 152, "user_id": 9328912, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-8XUoeA5ztnc/AAAAAAAAAAI/AAAAAAAAACw/GRyFXZYc3oM/photo.jpg?sz=128", "display_name": "Patrick Foy", "link": "https://stackoverflow.com/users/9328912/patrick-foy"}, "is_accepted": true, "score": 0, "last_activity_date": 1550087214, "last_edit_date": 1550087214, "creation_date": 1550082622, "answer_id": 54677091, "question_id": 54675725, "link": "https://stackoverflow.com/questions/54675725/best-way-to-read-a-very-large-array-into-excel-sheet/54677091#54677091", "title": "Best way to read a very large array into excel sheet", "body": "<p>Mathieu Guindon had EXACTLY the solution I was hoping for.  Eliminating the transpose has solved the issue with the #N/A values.  Thank you!</p>\n\n<p>Edit: </p>\n\n<p>The code just loops the arrayed data a second time into a two dimensional array and then posts it to the range without the transpose effect.  It's a little slower than the old way (taking about two minutes or so longer), but it's still pretty fast and produces the results I want.  Code is as follows:</p>\n\n<pre><code>    lineValue = ts.ReadAll\nDoEvents\narrLines() = Split(lineValue, vbCrLf)\nDim arrBetween() As Variant\nReDim arrBetween(UBound(arrLines), 0)\n\nLoopLength = UBound(arrLines) - 1\n\nFor i = 0 To LoopLength\n    arrBetween(i, 0) = arrLines(i)\n\n    DoEvents\n\n    If i Mod 2500 = 0 Or i = LoopLength Then\n        Application.StatusBar = \"Importing \" &amp; WorksheetName &amp; \" \" &amp; (i) &amp; \" .\"\n    End If\nNext i\n\nDim Destination As Range\nSet Destination = Worksheets(WorksheetName).Range(\"A2:A\" &amp; UBound(arrLines))\n\nDestination.Value = arrBetween\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1550085558, "last_edit_date": 1550085558, "creation_date": 1550084041, "answer_id": 54677449, "question_id": 54675725, "link": "https://stackoverflow.com/questions/54675725/best-way-to-read-a-very-large-array-into-excel-sheet/54677449#54677449", "title": "Best way to read a very large array into excel sheet", "body": "<h1>Copy Text Files to Excel</h1>\n\n<p>Credits to <a href=\"https://stackoverflow.com/users/6299848/simple-solution\">simple-solution</a> for suggesting (in the comments) to open the text files with <code>Workbooks.Open</code>.</p>\n\n<h2>The Code</h2>\n\n<pre><code>Sub CopyTextFilesToExcel()\n\n    ' Search Folder Path\n    Const cStrPath As String _\n            = \"D:\\Excel\\MyDocuments\\StackOverflow\\\"\n    Const cStrExt As String = \"*.txt\"       ' File Extension\n    Const cFolderPicker As Boolean = False  ' True to enable FolderPicker\n\n    Dim wb As Workbook          ' Current File\n    Dim strPath As String       ' Path of Search Folder (Incl. \"\\\" at the end.)\n    Dim strFileName As String   ' Current File Name\n\n    With Application\n        .ScreenUpdating = False\n        .DisplayAlerts = False\n    End With\n\n    On Error GoTo ProcedureExit\n\n    ' Determine Search Path (\"\\\" Issue)\n    If cFolderPicker Then\n        With Application.FileDialog(msoFileDialogFolderPicker)\n            If .Show = False Then Exit Sub\n            strPath = .SelectedItems(1) &amp; \"\\\"\n        End With\n      Else\n        If Right(cStrPath, 1) &lt;&gt; \"\\\" Then\n            strPath = cStrPath &amp; \"\\\"\n          Else\n            strPath = cStrPath\n        End If\n    End If\n\n    ' Determine first Current File Name.\n    strFileName = Dir(strPath &amp; cStrExt)\n\n    With ThisWorkbook ' Target Workbook\n        ' Loop through files in folder.\n        Do While strFileName &lt;&gt; \"\"\n            ' Create a reference to the Current File.\n            Set wb = Workbooks.Open(cStrPath &amp; strFileName)\n            ' Copy first worksheet of Current File after the last sheet\n            ' (.Sheets.Count) in Target Workbook.\n            wb.Worksheets(1).Copy After:=.Worksheets(.Sheets.Count)\n            ' Close Current File without saving changes (False).\n            wb.Close False\n            ' Find next File(name).\n            strFileName = Dir()\n        Loop\n    End With\n\n    MsgBox \"All files copied!\"\n\nProcedureExit:\n\n  With Application\n      .ScreenUpdating = True\n      .DisplayAlerts = True\n  End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 152, "user_id": 9328912, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-8XUoeA5ztnc/AAAAAAAAAAI/AAAAAAAAACw/GRyFXZYc3oM/photo.jpg?sz=128", "display_name": "Patrick Foy", "link": "https://stackoverflow.com/users/9328912/patrick-foy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 2, "accepted_answer_id": 54677091, "answer_count": 3, "score": 1, "last_activity_date": 1550087214, "creation_date": 1550077402, "question_id": 54675725, "link": "https://stackoverflow.com/questions/54675725/best-way-to-read-a-very-large-array-into-excel-sheet", "title": "Best way to read a very large array into excel sheet", "body": "<p>I have to import a number of text files into excel and add each text file to a new sheet. The number of lines on some files are in excess of 350,000.  Loops take so long that it's not really user friendly.  I've tried using this to read the data in quickly</p>\n\n<pre><code>Dim arrLines() As String\nDim lineValue As String\n\nlineValue = ts.ReadAll\nDoEvents\narrLines() = Split(lineValue, vbCrLf)\n\n\nDim Destination As Range\nSet Destination = Worksheets(WorksheetName).Range(\"A2\")\nSet Destination = Destination.Resize(UBound(arrLines), 1)\nDestination.Value = Application.Transpose(arrLines)\n</code></pre>\n\n<p>but this results in every value AFTER line 41243 simply having a value of \"#N/A\".  I was thinking to use a Application.Index to split up the array into smaller arrays, but you need to give the index function an array of lines that you want to compose the new array, and that would mean creating a loop to run through the numbers 1-41000, then 41001-82000, etc.  At the point i'm doing a loop to create the arrays it's not really faster.  looping through the file line by line is similarly too slow.  What's a good way of reading in a such a large number of lines without ending up with the missing values?</p>\n"}, {"tags": ["excel", "vba", "excel-2016"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 3, "creation_date": 1550076223, "post_id": 54675299, "comment_id": 96140012, "body": "<code>MyObj</code> is <code>Nothing</code> you didn&#39;t define it."}, {"owner": {"reputation": 3016, "user_id": 1926221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/GafDJ.jpg?s=128&g=1", "display_name": "IGRACH", "link": "https://stackoverflow.com/users/1926221/igrach"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1550076278, "post_id": 54675299, "comment_id": 96140055, "body": "Dim MyObj As Object or I need to use set command?"}], "answers": [{"comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 2, "creation_date": 1550077134, "post_id": 54675357, "comment_id": 96140507, "body": "Another option would be to reference FSO in VBA and set <code>MyObj</code> to that (i.e. <code>Dim MyObj As New FileSystemObject</code>)"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 3, "last_activity_date": 1550076351, "creation_date": 1550076351, "answer_id": 54675357, "question_id": 54675299, "link": "https://stackoverflow.com/questions/54675299/looping-through-files-in-folder-with-excel-macro/54675357#54675357", "title": "Looping through files in folder with Excel macro", "body": "<p>You would need to <code>Set MyObj</code> for example</p>\n\n<pre><code>Dim MyObj As Object\nSet MyObj = CreateObject(\"Scripting.FileSystemObject\")\n</code></pre>\n\n<p>otherwise <code>MyObj</code> is a empty variable and returns <code>Nothing</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 2, "last_activity_date": 1550076826, "creation_date": 1550076826, "answer_id": 54675517, "question_id": 54675299, "link": "https://stackoverflow.com/questions/54675299/looping-through-files-in-folder-with-excel-macro/54675517#54675517", "title": "Looping through files in folder with Excel macro", "body": "<p>Use the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/dir-function\" rel=\"nofollow noreferrer\"><code>Dir</code> function</a>?</p>\n\n<pre><code>Sub LoopThroughFiles()\n    Dim FileName AS String\n\n    FileName = Dir(\"c:\\test\\*\") 'Any file in the folder\n\n    While Len(FileName) &gt; 0\n        MsgBox FileName 'Say the file's name\n        FileName = Dir() 'Get next item that matches the filter\n    Wend\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3016, "user_id": 1926221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/GafDJ.jpg?s=128&g=1", "display_name": "IGRACH", "link": "https://stackoverflow.com/users/1926221/igrach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 54675357, "answer_count": 2, "score": 2, "last_activity_date": 1550076826, "creation_date": 1550076100, "last_edit_date": 1550076120, "question_id": 54675299, "link": "https://stackoverflow.com/questions/54675299/looping-through-files-in-folder-with-excel-macro", "title": "Looping through files in folder with Excel macro", "body": "<p>I have been trying to write excel macro that loops through files in folder returns names of the files. I have been googling and testing but I'm unable to make it work. This is the code:</p>\n\n<pre><code>Sub LoopThroughFiles()\n\n   Dim MyObj As Object, MySource As Object, file As Variant\n   Set MySource = MyObj.GetFolder(\"c:\\test\\\")\n   For Each file In MySource.Files\n      MsgBox file\n   Next file\n\nEnd Sub\n</code></pre>\n\n<p>I'm getting this error:</p>\n\n<blockquote>\n  <p>Run-time error '91':</p>\n  \n  <p>Object Variable or with block variable not set.</p>\n</blockquote>\n\n<p>Excel file is named <code>test.xlsm</code>. There are 3 files in the folder: <code>test01.txt</code>, <code>test02.txt</code>, <code>test03.txt</code>. I'm using windows 7, 64 bit. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1550157560, "post_id": 54675116, "comment_id": 96174831, "body": "I have added a solution to your y-problem, so you see there is always a solution if you ask the correct question."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10608775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b18a762ba05e7a6b957a9ca29d237602?s=128&d=identicon&r=PG&f=1", "display_name": "Mandragor", "link": "https://stackoverflow.com/users/10608775/mandragor"}, "edited": false, "score": 0, "creation_date": 1550164122, "post_id": 54693735, "comment_id": 96178849, "body": "Thanks PEH! I will test the solution when I have a moment. Nice!"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1550158916, "last_edit_date": 1550158916, "creation_date": 1550157712, "answer_id": 54693735, "question_id": 54675116, "link": "https://stackoverflow.com/questions/54675116/using-the-content-of-a-variable-in-an-instruction/54693735#54693735", "title": "Using the content of a variable in an instruction", "body": "<p><strong>Solution to your Y-Problem:</strong></p>\n\n<p>You could use a dictionary to collect all the PRS-XX arrays.</p>\n\n<pre><code>Option Explicit\n\nDim PRS As Object\n\nSub Test()\n    Set PRS = CreateObject(\"Scripting.Dictionary\")\n    'fill dictionary\n    PRS.Add \"PRS-02\", Array(\"201010\", \"207201\", \"213004\", \"210110\")\n    PRS.Add \"PRS-03\", Array(\"201010\", \"207201\", \"213004\")\n\n    'call it\n    findCaMaterialsAndSumWeights caMaterials, caMaterialsW, caMat, caMatW, diMatSE(i), diMatNotSE(i), i, posCaMaterialsTaken\nEnd Sub\n</code></pre>\n\n<p>And then you could use it like <code>PRS(\"PRS-02\")</code> to get the array <code>Array(\"201010\", \"207201\", \"213004\", \"210110\")</code>. or even <code>PRS(\"PRS-02\")(1)</code> to eg access item <code>1</code> of the array directly. If you now use your variable <code>diMatSE = \"PRS-02\"</code> like <code>PRS(diMatSE)</code> it takes the correct array according to your variable value.</p>\n\n<p>So you only have the code once and can add as many <code>PRS-xx</code> to your dictionary as you want without touching this procedure again.</p>\n\n<pre><code>Private Sub findCaMaterialsAndSumWeights(caMaterials As Variant, caMaterialsW As Variant, caMat As Variant, caMatW As Variant, diMatSE As Variant, diMatNotSE As Variant, y As Variant, posCaMaterialsTaken As Variant)\n     For i = LBound(PRS(diMatSE)) To UBound(PRS(diMatSE))\n        Call posInTheArrayIgnoringPos(caMaterials, PRS(diMatSE)(i), posInArray, posCaMaterialsTaken)\n\n        If posInArray &lt;&gt; 0 Then 'If found one CA material that is a component from a Diko SE\n            numFound = numFound + 1\n            posCaMaterialsTaken(posInArray) = \"x\"\n            If caMatW(y) = \"\" Then\n                caMatW(y) = 0\n            End If\n            caMatW(y) = caMatW(y) + caMaterialsW(posInArray)\n            If numFound = UBound(PRS(diMatSE)) + 1 Then 'If all Diko SE materials are found in Diko materials\n                caMat(y) = diMatSE\n                For x = LBound(posCaMaterialsTaken) To UBound(posCaMaterialsTaken)\n                    If posCaMaterialsTaken(x) = \"x\" Then 'Saving CA materials positions that compound a Diko SE\n                        posCaMaterialsTaken(x) = 1\n                        numFound = numFound - 1\n                        If numFound = 0 Then\n                            Exit For\n                        End If\n                    End If\n                Next x\n            End If\n           '...\n        Else 'Not found one SE material\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10608775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b18a762ba05e7a6b957a9ca29d237602?s=128&d=identicon&r=PG&f=1", "display_name": "Mandragor", "link": "https://stackoverflow.com/users/10608775/mandragor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 54693735, "answer_count": 1, "score": 2, "last_activity_date": 1550158916, "creation_date": 1550075518, "last_edit_date": 1550156130, "question_id": 54675116, "link": "https://stackoverflow.com/questions/54675116/using-the-content-of-a-variable-in-an-instruction", "title": "Using the content of a variable in an instruction", "body": "<p>I explain one Y problem:\nThis is the call and <code>diMatSE(i)</code> can have different values, for example <code>PRS02</code> and <code>PRS03</code> for this example.</p>\n\n<pre><code>Call findCaMaterialsAndSumWeights(caMaterials, caMaterialsW, caMat, caMatW, diMatSE(i), diMatNotSE(i), i, posCaMaterialsTaken)\n</code></pre>\n\n<p>Here the definition of the arrays:</p>\n\n<pre><code>PRS02 = Array(\"201010\", \"207201\", \"213004\", \"210110\")\nPRS03 = Array(\"201010\", \"207201\", \"213004\")\n</code></pre>\n\n<p>Here the summary sub:</p>\n\n<pre><code>Private Sub findCaMaterialsAndSumWeights(caMaterials As Variant, caMaterialsW As Variant, caMat As Variant, caMatW As Variant, diMatSE As Variant, diMatNotSE As Variant, y As Variant, posCaMaterialsTaken As Variant)\n    Select Case diMatSE\n        Case \"PRS-02\"\n             For i = LBound(PRS02) To UBound(PRS02)\n                Call posInTheArrayIgnoringPos(caMaterials, PRS02(i), posInArray, posCaMaterialsTaken)\n\n                If posInArray &lt;&gt; 0 Then 'If found one CA material that is a component from a Diko SE\n                    numFound = numFound + 1\n                    posCaMaterialsTaken(posInArray) = \"x\"\n                    If caMatW(y) = \"\" Then\n                        caMatW(y) = 0\n                    End If\n                    caMatW(y) = caMatW(y) + caMaterialsW(posInArray)\n                    If numFound = UBound(PRS02) + 1 Then 'If all Diko SE materials are found in Diko materials\n                        caMat(y) = \"PRS-02\"\n                        For x = LBound(posCaMaterialsTaken) To UBound(posCaMaterialsTaken)\n                            If posCaMaterialsTaken(x) = \"x\" Then 'Saving CA materials positions that compound a Diko SE\n                                posCaMaterialsTaken(x) = 1\n                                numFound = numFound - 1\n                                If numFound = 0 Then\n                                    Exit For\n                                End If\n                            End If\n                        Next x\n                    End If\n                   ...\n                Else 'Not found one SE material\n                End If\n            Next i\n         Case \"PRS-03\"  \n            (same code as PRS-02 case but PRS03 instead PRS02)\n        Case \"PRS-04\"\n            (same code as PRS-02 case but PRS04 instead PRS02)\n        ...\n        Case else\n</code></pre>\n\n<p>Now I have several cases with the code repeated for the different values.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 3, "creation_date": 1550075245, "post_id": 54674938, "comment_id": 96139390, "body": "What do you mean it &quot;gets stuck&quot;? Does it loop but never do anything, does it throw an error, etc.?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1550075570, "post_id": 54674938, "comment_id": 96139601, "body": "<code>Set rng = sh.Cells(cell.Row, 1).Range(&quot;C1:C1&quot;)</code> - in your comment you say columns C-Z - It looks like you&#39;re just looking at column C?"}, {"owner": {"reputation": 3, "user_id": 11056303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5454919034d5b5e33f10c2c15251514?s=128&d=identicon&r=PG&f=1", "display_name": "Tony K", "link": "https://stackoverflow.com/users/11056303/tony-k"}, "edited": false, "score": 0, "creation_date": 1550138246, "post_id": 54674938, "comment_id": 96163142, "body": "Hi BruceWayne, the macro throws up an error and stops in the line .Attachments.Add FileCell.Value. The error advises that the file path cant be found."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11056303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5454919034d5b5e33f10c2c15251514?s=128&d=identicon&r=PG&f=1", "display_name": "Tony K", "link": "https://stackoverflow.com/users/11056303/tony-k"}, "edited": false, "score": 0, "creation_date": 1550162010, "post_id": 54675833, "comment_id": 96177552, "body": "Hi Raul. This update to the code has got the Macro to run. Many thanks for your input. When the Macro runs it is producing the emails as expected but each email has all the files in the list attached. How do i get the macro to only attach the file on each line to the email address on that line? I have attached an image of the excel sheet i am working on near the top."}, {"owner": {"reputation": 328, "user_id": 11053636, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-905Cm0oxwsg/AAAAAAAAAAI/AAAAAAAAAAc/s9eGPJxrdVU/photo.jpg?sz=128", "display_name": "Raul Guerrero", "link": "https://stackoverflow.com/users/11053636/raul-guerrero"}, "reply_to_user": {"reputation": 3, "user_id": 11056303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5454919034d5b5e33f10c2c15251514?s=128&d=identicon&r=PG&f=1", "display_name": "Tony K", "link": "https://stackoverflow.com/users/11056303/tony-k"}, "edited": false, "score": 0, "creation_date": 1550187875, "post_id": 54675833, "comment_id": 96188214, "body": "Yes, actually i just comment the &quot;for  each FileCell&quot;, please see try with this code!!!!  i hope this works for you!"}, {"owner": {"reputation": 3, "user_id": 11056303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5454919034d5b5e33f10c2c15251514?s=128&d=identicon&r=PG&f=1", "display_name": "Tony K", "link": "https://stackoverflow.com/users/11056303/tony-k"}, "edited": false, "score": 0, "creation_date": 1550224308, "post_id": 54675833, "comment_id": 96198913, "body": "The update to the code is now working exactly as required. Many thanks for your assistance"}], "tags": [], "owner": {"reputation": 328, "user_id": 11053636, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-905Cm0oxwsg/AAAAAAAAAAI/AAAAAAAAAAc/s9eGPJxrdVU/photo.jpg?sz=128", "display_name": "Raul Guerrero", "link": "https://stackoverflow.com/users/11053636/raul-guerrero"}, "is_accepted": true, "score": 0, "last_activity_date": 1550187948, "last_edit_date": 1550187948, "creation_date": 1550077772, "answer_id": 54675833, "question_id": 54674938, "link": "https://stackoverflow.com/questions/54674938/attaching-files-to-email-using-vba/54675833#54675833", "title": "Attaching files to email using VBA", "body": "<p>Can you try this?:</p>\n\n<pre><code>Sub Send_Files()\nDim OutApp As Object\nDim OutMail As Object\nDim sh As Worksheet\nDim cell As Range\nDim FileCell As Range\nDim rng As Range\n\nWith Application\n    .EnableEvents = False\n    .ScreenUpdating = False\nEnd With\n\nSet sh = Sheets(\"List\")\n\nSet OutApp = CreateObject(\"Outlook.Application\")\n\nFor Each cell In sh.Range(\"B1:B\" &amp; sh.Range(\"c1048576\").End(xlUp).Row)\n\n    'Enter the path/file names in the C:Z column in each row\n    Set rng = sh.Range(\"C1:C\" &amp; sh.Range(\"c1048576\").End(xlUp).Row)\n\n    If cell.Value Like \"?*@?*.?*\" And _\n       Application.WorksheetFunction.CountA(rng) &gt; 0 Then\n        Set OutMail = OutApp.CreateItem(0)\n\n        With OutMail\n            .To = cell.Value\n            .Subject = \"Curent Week Supplies\"\n            .Body = \"Good Morning\" &amp; Cells(cell.Row, \"A\").Value _\n                &amp; vbNewLine &amp; vbNewLine &amp; _\n                    \"Please find attached this week's CWS file.\" &amp; _\n                vbNewLine &amp; vbNewLine &amp; _\n                    \"If you have any queries concerning this then please feel         free to contact us.\" &amp; _\n                vbNewLine &amp; vbNewLine &amp; _\n                    \"Best regards\"\n\n            'For Each FileCell In sh.Range(\"C1:C\" &amp;     sh.Range(\"c1048576\").End(xlUp).Row)\n            'If IsEmpty(FileCell.Value) Then Exit For\n\n             .Attachments.Add cell.Offset(0, 1).Value\n            'Next FileCell\n\n            'Take a look before send\n            '.display\n\n            .Send\n        End With\n\n        Set OutMail = Nothing\n    End If\nNext cell\n\nSet OutApp = Nothing\nWith Application\n    .EnableEvents = True\n    .ScreenUpdating = True\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11056303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5454919034d5b5e33f10c2c15251514?s=128&d=identicon&r=PG&f=1", "display_name": "Tony K", "link": "https://stackoverflow.com/users/11056303/tony-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 54675833, "answer_count": 1, "score": 0, "last_activity_date": 1550187948, "creation_date": 1550075043, "last_edit_date": 1550077710, "question_id": 54674938, "link": "https://stackoverflow.com/questions/54674938/attaching-files-to-email-using-vba", "title": "Attaching files to email using VBA", "body": "<p>I am trying to write a macro to automatically generate and send emails out to a list of addresses while attaching a specific file to each.<br>\nStill being a bit green to coding in VBA I have \"kitbashed\" the below but am having trouble working out how to get the file path to read properly.</p>\n\n<pre><code>Sub Send_Files()\nDim OutApp As Object\nDim OutMail As Object\nDim sh As Worksheet\nDim cell As Range\nDim FileCell As Range\nDim rng As Range\n\nWith Application\n    .EnableEvents = False\n    .ScreenUpdating = False\nEnd With\n\nSet sh = Sheets(\"List\")\n\nSet OutApp = CreateObject(\"Outlook.Application\")\n\nFor Each cell In sh.Columns(\"B\").Cells.SpecialCells(xlCellTypeConstants)\n\n    'Enter the path/file names in the C:Z column in each row\n    Set rng = sh.Cells(cell.Row, 1).Range(\"C1:C1\")\n\n    If cell.Value Like \"?*@?*.?*\" And _\n       Application.WorksheetFunction.CountA(rng) &gt; 0 Then\n        Set OutMail = OutApp.CreateItem(0)\n\n        With OutMail\n            .To = cell.Value\n            .Subject = \"Curent Week Supplies\"\n            .Body = \"Good Morning\" &amp; Cells(cell.Row, \"A\").Value _\n                &amp; vbNewLine &amp; vbNewLine &amp; _\n                    \"Please find attached this week's CWS file.\" &amp; _\n                vbNewLine &amp; vbNewLine &amp; _\n                    \"If you have any queries concerning this then please feel free to contact us.\" &amp; _\n                vbNewLine &amp; vbNewLine &amp; _\n                    \"Best regards\"\n\n            For Each FileCell In rng.SpecialCells(xlCellTypeConstants)\n                If Trim(FileCell) &lt;&gt; \"\" Then\n                    If Dir(FileCell.Value) &lt;&gt; \"\" Then\n                        .Attachments.Add FileCell.Value\n                    End If\n                End If\n            Next FileCell\n\n            .Send\n        End With\n\n        Set OutMail = Nothing\n    End If\nNext cell\n\nSet OutApp = Nothing\nWith Application\n    .EnableEvents = True\n    .ScreenUpdating = True\nEnd With\nEnd Sub\n</code></pre>\n\n<p>When the macro tries to attach the file it gets stuck with this: - </p>\n\n<pre><code>For Each FileCell In rng.SpecialCells(xlCellTypeConstants)\n                If Trim(FileCell) &lt;&gt; \"\" Then\n                    If Dir(FileCell.Value) &lt;&gt; \"\" Then\n                        .Attachments.Add FileCell.Value\n                    End If\n                End If\n            Next FileCell\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/vbIZf.jpg\" alt=\"Excel data in used for macro\"></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 2, "creation_date": 1550074852, "post_id": 54674732, "comment_id": 96139115, "body": "Do you have to use <code>VBA</code> for this? can you not just use <code>Formula&#39;s</code>?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1550075523, "post_id": 54674732, "comment_id": 96139574, "body": "To add to @Zac&#39;s comment, would a simple <code>VLOOKUP()</code> table not work?"}, {"owner": {"reputation": 3, "user_id": 11051266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2837c5acc01435fe7a9d8d0b442df2bc?s=128&d=identicon&r=PG&f=1", "display_name": "fl_bell", "link": "https://stackoverflow.com/users/11051266/fl-bell"}, "edited": false, "score": 0, "creation_date": 1550076218, "post_id": 54674732, "comment_id": 96140007, "body": "Your right. I guess i was over complicating things"}], "owner": {"reputation": 3, "user_id": 11051266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2837c5acc01435fe7a9d8d0b442df2bc?s=128&d=identicon&r=PG&f=1", "display_name": "fl_bell", "link": "https://stackoverflow.com/users/11051266/fl-bell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550075268, "creation_date": 1550074453, "last_edit_date": 1550075268, "question_id": 54674732, "link": "https://stackoverflow.com/questions/54674732/is-there-a-way-to-enter-text-for-specific-cells-with-in-a-range-selected", "title": "Is there a way to enter text for Specific cells with in a range selected?", "body": "<p>New to Vba excel and I can't figure out how to enter in text to range of cells that is within an already selected range of cells.</p>\n\n<p>I have a list of data going down about 10K rows. I have added a new header attempting to add text to it for each row going down. </p>\n\n<p>So basically if I <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>Down</kbd> (in the data set I have) and shift over to my new header I have the data range I want but I can't figure how to enter in text under the header within this range. Hope this all makes sense. </p>\n\n<p>I have already tried this. </p>\n\n<p>So I have only gotten as far as selecting the range through VBA. Ideally I want the new header to be able to run \"If then\" checks and update each cell under the new header accordingly. So if cell \"H8\" says whatever then \"P8\" will is where I want the result.</p>\n\n<pre><code>Sub Card_type_test()\n\n    Dim CT As String\n\n    CT = ActiveCell.Value\n\n    If CT = \"AMERICAN EXPRESS\" Then\n        ActiveCell(1, 9).Value = \"AMEX2\"\n    ElseIf CT = \"MASTERCARD\" Then\n        ActiveCell(1, 9).Value = \"MC2\"\n    ElseIf CT = \"VISA\" Then\n        ActiveCell(1, 9).Value = \"VISA2\"\n    Else\n    End If\n\nEnd Sub\n\nSub Selecting_correct_Cells()\n\n    Range(Range(\"P8\"), Range(\"H8\").End(xlDown)).Select\n\nEnd Sub\n</code></pre>\n\n<p>The first Sub was a test to see if the \"if then\" statement worked. Which it does if I am highlighting \"H8\" for example as the active cell. The last sub is the range selected I am trying to achieve.</p>\n"}, {"tags": ["vba", "if-statement", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1550075267, "post_id": 54674479, "comment_id": 96139412, "body": "Unfortunately you provide no details about <i>HOW</i> it &quot;doesn&#39;t work&quot;. That makes trouble-shooting very difficult. But FWIW at a glance... This formulation <code>If DryCycle_status.Value = &quot;OK&quot; Or &quot;N&#47;A&quot;</code> is not allowed in VBA. It needs to be <code>If DryCycle_status.Value = &quot;OK&quot; Or DryCycle_status.Value = &quot;N&#47;A&quot;</code> - it&#39;s necessary to state <i>both sides</i> of the comparison with each comparison operator - no shortcuts."}, {"owner": {"reputation": 25, "user_id": 9962578, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i2xECZABrK0/AAAAAAAAAAI/AAAAAAAAADs/yX6ZrFQ-UQ4/photo.jpg?sz=128", "display_name": "Joey b", "link": "https://stackoverflow.com/users/9962578/joey-b"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1550129623, "post_id": 54674479, "comment_id": 96158688, "body": "@CindyMeister; sorry I didnt elaborate on why it didnt work. I recieved a <code>Error 13 type match</code>. I have also tried the way you suggest (I will edit into the original post."}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 9962578, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i2xECZABrK0/AAAAAAAAAAI/AAAAAAAAADs/yX6ZrFQ-UQ4/photo.jpg?sz=128", "display_name": "Joey b", "link": "https://stackoverflow.com/users/9962578/joey-b"}, "is_accepted": true, "score": 0, "last_activity_date": 1550648522, "last_edit_date": 1550648522, "creation_date": 1550138446, "answer_id": 54687696, "question_id": 54674479, "link": "https://stackoverflow.com/questions/54674479/validate-multiple-textboxes-with-two-values-to-summarize-report/54687696#54687696", "title": "Validate multiple textboxes with two values to summarize report", "body": "<p>I have come up with a work around. It aint pretty, but works for me. I want the summary to say <strong>\"NOK\"</strong> whenever there is 1 or more <strong>\"NOK\"</strong> or empty fields <strong>\"\"</strong>. This is what the code below does for me. </p>\n\n<pre><code>If DryCycle_status.Value = \"NOK\" Or Temp_status = \"NOK\" Or BackPressure_status.Value = \"NOK\" Or _\nFilling_status = \"NOK\" Or Injection_status.Value = \"NOK\" Or HoldingPressure_status \"NOK\" _\nOr CoolingTime_status.Value = \"NOK\" Or ClampingForce_status = \"NOK\" Or _\nProcessStability_status.Value = \"NOK\" Or AdditionalTesting_status = \"NOK\" _\nDryCycle_status.Value = \"\" Or Temp_status = \"\" Or BackPressure_status.Value = \"\" Or _\nFilling_status = \"\" Or Injection_status.Value = \"\" Or HoldingPressure_status = \"\" _\nOr CoolingTime_status.Value = \"\" Or ClampingForce_status = \"\" Or _\nProcessStability_status.Value = \"\" Or AdditionalTesting_status = \"\" Then \nMouldTotal.Value = \"NOK\" Else MouldTotal.Value = \"OK\"\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9962578, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i2xECZABrK0/AAAAAAAAAAI/AAAAAAAAADs/yX6ZrFQ-UQ4/photo.jpg?sz=128", "display_name": "Joey b", "link": "https://stackoverflow.com/users/9962578/joey-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 54687696, "answer_count": 1, "score": 0, "last_activity_date": 1550648522, "creation_date": 1550073745, "last_edit_date": 1550130932, "question_id": 54674479, "link": "https://stackoverflow.com/questions/54674479/validate-multiple-textboxes-with-two-values-to-summarize-report", "title": "Validate multiple textboxes with two values to summarize report", "body": "<p>For our machines we have multiple validation phases. Each phase needs to be \"OK\" or  \"N/A\" before we can send the machine of to the customer. I have multiple textboxes where they fill in whether the specific phase is \"OK\" or \"NOK\"(not oke) or \"N/A\". </p>\n\n<p>If everything is \"OK\" or \"N/A\" then <code>MouldTotal.value=\"OK\" Else MouldTotal.value=\"NOK\"</code></p>\n\n<p>I cant get this to work and have not found a way that is applicable for this situation. </p>\n\n<p>Thanks for any help in advance. </p>\n\n<p>For the first code below I recieved an error 13 type match.</p>\n\n<pre><code>If DryCycle_status.Value = \"OK\" Or \"N/A\" And Temp_status = \"OK\" Or \"N/A\" And _ \nBackPressure_status.Value = \"OK\" Or \"N/A\" And _\nFilling_status = \"OK\" Or \"N/A\" And Injection_status.Value = \"OK\" Or \"N/A\" _ \nAnd HoldingPressure_status = \"OK\" Or \"N/A\" _\nAnd CoolingTime_status.Value = \"OK\" Or \"N/A\" And ClampingForce_status = \"OK\" Or \"N/A\" And _\nProcessStability_status.Value = \"OK\" Or \"N/A\" And AdditionalTesting_status = \"OK\" Or \"N/A\" _\nThen MouldTotal.Value = \"OK\" Else MouldTotal.Value = \"NOK\"\n</code></pre>\n\n<p>I have also tried the code below. This one didnt result in an error but also didnt do anything with the code. It appears to just read the value of <code>MouldTotal</code>.</p>\n\n<p>Edit; it only seems to read <code>DryCycle_status</code>, because when I change this one to \"NOK\", then <code>MouldTotal</code> does change to \"NOK\". When I change any other \"status\" it doesnt affect <code>MouldTotal</code></p>\n\n<pre><code>If DryCycle_status.Value = \"OK\" Or DryCycle_status.Value = \"N/A\" And _\nTemp_status = \"OK\" Or Temp_status.Value = \"N/A\" And _\nBackPressure_status.Value = \"OK\" Or BackPressure_status.Value = \"N/A\" And _\nFilling_status = \"OK\" Or Filling_status.Value = \"N/A\" And _\nInjection_status.Value = \"OK\" Or Injection_status.Value = \"N/A\" And _\nHoldingPressure_status = \"OK\" Or _\nHoldingPressure_status.Value = \"N/A\" And CoolingTime_status.Value = \"OK\" Or _\nCoolingTime_status.Value = \"N/A\" And ClampingForce_status = \"OK\" Or _\nClampingForce_status.Value = \"N/A\" And _\nProcessStability_status.Value = \"OK\" Or ProcessStability_status.Value =  \"N/A\" _\nAnd AdditionalTesting_status = \"OK\" Or AdditionalTesting_status.Value  = \"N/A\" _\nThen MouldTotal.Value = \"OK\" Else MouldTotal.Value = \"NOK\"\n</code></pre>\n"}, {"tags": ["c++", "vba", "visio"], "answers": [{"tags": [], "owner": {"reputation": 687, "user_id": 7990528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gWVHp.png?s=128&g=1", "display_name": "Surrogate", "link": "https://stackoverflow.com/users/7990528/surrogate"}, "is_accepted": false, "score": 0, "last_activity_date": 1550620680, "last_edit_date": 1550620680, "creation_date": 1550138247, "answer_id": 54687625, "question_id": 54674258, "link": "https://stackoverflow.com/questions/54674258/visio-drawline-method-is-not-working-as-i-expect/54687625#54687625", "title": "Visio DrawLine() method is not working as I expect", "body": "<p>Nerea Murua !</p>\n\n<p>Just check documentation about <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Visio.Shape.DrawLine\" rel=\"nofollow noreferrer\">DrawLine method</a> syntax, this method have only 4 parameters.</p>\n\n<pre><code>expression.DrawLine(xBegin, yBegin, xEnd, yEnd)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11057421, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i2YvbAe03Vs/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOvcIjyb_S5KAey1lvgKBZas_u4Eg/mo/photo.jpg?sz=128", "display_name": "Nerea Murua", "link": "https://stackoverflow.com/users/11057421/nerea-murua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1550620680, "creation_date": 1550073149, "last_edit_date": 1550081325, "question_id": 54674258, "link": "https://stackoverflow.com/questions/54674258/visio-drawline-method-is-not-working-as-i-expect", "title": "Visio DrawLine() method is not working as I expect", "body": "<p>Shape.DrawLine Method (Visio) is not working as I expect. It draws the lines where it wants, not in the positions I give. It doesn't matter where it is located the main shape, it always makes the drawings in the same position. Until now I was using Visio 2000 with its SDK, and I didn't have any problem with this function. But now that I have updated to Visio 2016 it is not working as before. What I am doing wrong?</p>\n\n<p>Thanks in advance!</p>\n\n<pre><code>x1 = TO_INCH(pEntidad-&gt;m_datos_entidad.linea.x1);\ny1 = TO_INCH(pEntidad-&gt;m_datos_entidad.linea.y1);\nx2 = TO_INCH(pEntidad-&gt;m_datos_entidad.linea.x2);\ny2 = TO_INCH(pEntidad-&gt;m_datos_entidad.linea.y2);\n\nhr = elSimbolo.DrawLine(x1, y1, x2, y2, laLinea);\n</code></pre>\n\n<p>I'm trying with very basic shapes, for example drawing a rectangle, and I don't get a rectangle</p>\n"}, {"tags": ["sql-server", "vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1550088811, "post_id": 54678516, "comment_id": 96146267, "body": "I should add that I tried to make the class persistent (<code>PredeclaredID=True</code>), and it crashed my PowerPoint when I reopened it. There may have been another issue, but I didn&#39;t find it."}, {"owner": {"reputation": 21, "user_id": 11057321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e509ffe598f1d7acbaf68d0dd586aa?s=128&d=identicon&r=PG&f=1", "display_name": "PJones", "link": "https://stackoverflow.com/users/11057321/pjones"}, "edited": false, "score": 0, "creation_date": 1550168420, "post_id": 54678516, "comment_id": 96180817, "body": "This looks very interesting.  I&#39;ll check it out."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1550173354, "post_id": 54678516, "comment_id": 96182883, "body": "@PeterT Re: &quot;When you open the VBE, there are no modules, classes, or objects of any kind available&quot; Intellisense will help, or as with the other Office apps&#39; VBE, press F2 to see the Object Browser, which lists PPT&#39;s own classes etc. Of course there <i>are</i> no modules until you&#39;ve added them the current open file&#39;s project or to projects in other open files. You can&#39;t see modules/classes that are in add-ins unless you modify the registry."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 1, "creation_date": 1550173574, "post_id": 54678516, "comment_id": 96182981, "body": "If you save PeterT&#39;s code as an Add-in, you can include an Auto_Open subroutine; this will automatically run when the add-in loads (at PPT startup, once you&#39;ve installed the add-in). Re making all of this run periodically, it might be simpler to write the update code as a VBScript or even an EXE that uses COM to drive PowerPoint, then set up the Windows scheduler to launch the script/EXE once a day."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1550184046, "post_id": 54678516, "comment_id": 96187226, "body": "@SteveRindsberg... thanks!  that&#39;s the real answer for the missing part. I should have thought about the add-in solution."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1550246212, "post_id": 54678516, "comment_id": 96211456, "body": "@PeterT  You know what they say: To a man with a hammer, every problem looks like a nail.  I write add-ins.  And sometimes the problem really IS a nail ;-)"}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 0, "last_activity_date": 1550088109, "creation_date": 1550088109, "answer_id": 54678516, "question_id": 54674208, "link": "https://stackoverflow.com/questions/54674208/refresh-textbox-when-powerpoint-slide-is-shown/54678516#54678516", "title": "refresh textbox when powerpoint slide is shown", "body": "<p>This is a tricky and interesting problem and I'll admit that this is <strong>most</strong> of the solution, but there is a missing part. I haven't done much programming in Powerpoint, so it was a challenge. When you open the VBE, there are no modules, classes, or objects of any kind available. This is quite different from Word and Excel. This means we're all on our own...</p>\n\n<p>I created a Presentation with five slides. On the third slide, I inserted some objects so it looked like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/f4b8G.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/f4b8G.png\" alt=\"enter image description here\"></a></p>\n\n<p>For the VBA part, the first thing I had to learn was to create a <a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2003/aa211599(v=office.11)\" rel=\"nofollow noreferrer\">class module that will catch all of the events for the presentation</a>. My very simple class is called <code>EventClassModule</code> and looks like this:</p>\n\n<pre><code>Option Explicit\n\nPublic WithEvents App As Application\n\nPrivate Sub App_SlideShowNextSlide(ByVal Wn As SlideShowWindow)\n    If Wn.View.CurrentShowPosition = 3 Then\n        UpdateTheCount Wn.View.Slide\n    End If\nEnd Sub\n</code></pre>\n\n<p>So now in a regular module, you have to run something to create and initialize this class as a global object. </p>\n\n<pre><code>Option Explicit\n\nDim eventClass As EventClassModule\n\nSub InitializeApp()\n    Set eventClass = New EventClassModule\n    Set eventClass.App = Application\nEnd Sub\n</code></pre>\n\n<p>In my testing, I just manually ran the <code>InitializeApp</code> procedure to create the global object. <strong><em>This is the missing part of my solution... - I don't know how to automatically run this initialization to create the object. Maybe a ribbon button?</em></strong></p>\n\n<p>Then, also in the regular code module is the procedure to update the textbox:</p>\n\n<pre><code>Public Sub UpdateTheCount(ByRef thisSlide As Slide)\n    '--- loop through all the shapes to find the correct textbox,\n    '    then update the value for display\n    Const LABEL_TEXT As String = \"Value to update:\"\n    Dim shp As Shape\n    For Each shp In thisSlide.Shapes\n        If shp.Type = msoTextBox Then\n            Dim theText As String\n            theText = shp.TextFrame.TextRange.Text\n            If InStr(1, theText, LABEL_TEXT, vbTextCompare) = 1 Then\n                Dim colonPos As Long\n                Dim theValue As Long\n                colonPos = InStr(1, theText, \":\", vbTextCompare)\n                theValue = CLng(Right$(theText, Len(theText) - colonPos))\n                theValue = theValue + 1\n                theText = LABEL_TEXT &amp; \" \" &amp; theValue\n                shp.TextFrame.TextRange.Text = theText\n            End If\n        End If\n    Next shp\nEnd Sub\n</code></pre>\n\n<p>Once your code is in place and you've run the <code>InitializeApp()</code> sub manually, just start the slide show (and probably set it to loop from the end) and step through it. The textbox value will update and increment automatically.</p>\n\n<p>I'm interested in learning how to kick this off automatically from someone who's got that experience.</p>\n"}], "owner": {"reputation": 21, "user_id": 11057321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e509ffe598f1d7acbaf68d0dd586aa?s=128&d=identicon&r=PG&f=1", "display_name": "PJones", "link": "https://stackoverflow.com/users/11057321/pjones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 215, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1606084493, "creation_date": 1550073001, "last_edit_date": 1550080911, "question_id": 54674208, "link": "https://stackoverflow.com/questions/54674208/refresh-textbox-when-powerpoint-slide-is-shown", "title": "refresh textbox when powerpoint slide is shown", "body": "<p>I'm using PowerPoint 2016 for a Wallboard display and I'd like it to pull a number from an MSSQL-Server table. I can get the SQL data into Powerpoint easily enough but I would like the data to refresh every day automatically and leave the wallboard running continuously. </p>\n\n<p>I have a textbox on a slide that pulls data from an SQL VBA script. Is there a way to automatically run the script each time the slide is shown while the presentation is running or have the script run once every 24 hours to refresh the textbox?</p>\n"}, {"tags": ["excel", "xml", "vba", "nodes"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1550073616, "post_id": 54674179, "comment_id": 96138347, "body": "Have you tried something like <code>getElementsByTagName</code>? <a href=\"https://stackoverflow.com/questions/40907223/vba-getelementsbytagname-issue%5D\">this might help</a>"}], "answers": [{"tags": [], "owner": {"reputation": 781, "user_id": 6299848, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DwEAxXq6T1I/AAAAAAAAAAI/AAAAAAAAAPA/Bcu8ARbxjmw/photo.jpg?sz=128", "display_name": "simple-solution", "link": "https://stackoverflow.com/users/6299848/simple-solution"}, "is_accepted": false, "score": 0, "last_activity_date": 1550075267, "creation_date": 1550075267, "answer_id": 54675029, "question_id": 54674179, "link": "https://stackoverflow.com/questions/54674179/how-to-retrieve-specific-information-from-xml-type-document/54675029#54675029", "title": "How to retrieve specific information from XML type document", "body": "<p>Thickness is saved as XML element in your example.<br/>\nThe length is stored as an XML attribute.<br/>\n(see <a href=\"https://www.xmlfiles.com/xml/xml-attributes/\" rel=\"nofollow noreferrer\">https://www.xmlfiles.com/xml/xml-attributes/</a>)<br/></p>\n\n<p>To read an XML attribute please have a look at: \n<a href=\"https://stackoverflow.com/questions/5297068/read-xml-attribute-vba\">Read XML Attribute VBA</a></p>\n\n<p>Based on the code presented there you should be able to solve your issue with:</p>\n\n<pre><code>'Include a reference to Microsoft XML v3\nDim XMLDataDrg As DOMDocument30\nSet XMLDataDrg = New DOMDocument30\nXMLDataDrg.Load (\"C:\\...\\sample.xml\")\n\n'...\n\nDim id As String\nid = XMLDataDrg.SelectSingleNode(\"//Info/MC/Tool\").Attributes.getNamedItem(\"length\").Text\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1550076613, "creation_date": 1550076613, "answer_id": 54675447, "question_id": 54674179, "link": "https://stackoverflow.com/questions/54674179/how-to-retrieve-specific-information-from-xml-type-document/54675447#54675447", "title": "How to retrieve specific information from XML type document", "body": "<p>You can use an xpath to restrict to <code>Tool</code> elements with attribute <code>name</code> having value <code>TN901</code> then loop all the attributes and write out. I am reading your XML from a file on desktop.</p>\n\n<pre><code>Option Explicit\nPublic Sub test()\n    Dim xmlDoc As Object\n    Set xmlDoc = CreateObject(\"MSXML2.DOMDocument\")\n    With xmlDoc\n        .validateOnParse = True\n        .setProperty \"SelectionLanguage\", \"XPath\"\n        .async = False\n\n        If Not .Load(\"C:\\Users\\User\\Desktop\\Test.xml\") Then\n            Err.Raise .parseError.ErrorCode, , .parseError.reason\n        End If\n    End With\n    Dim elem As Object, attrib As Object\n\n    For Each elem In xmlDoc.SelectNodes(\"//Tool[@name='TN901']\")\n       For Each attrib In elem.Attributes\n           Debug.Print attrib.nodeName, attrib.Text\n       Next\n    Next\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/NYQDg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NYQDg.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 4503883, "user_type": "registered", "profile_image": "https://graph.facebook.com/774668210/picture?type=large", "display_name": "Simon Marston", "link": "https://stackoverflow.com/users/4503883/simon-marston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1550076613, "creation_date": 1550072894, "last_edit_date": 1550072981, "question_id": 54674179, "link": "https://stackoverflow.com/questions/54674179/how-to-retrieve-specific-information-from-xml-type-document", "title": "How to retrieve specific information from XML type document", "body": "<p>I`m working on a VBA macro in Excel, to gather information from a CNC program code.\nSo far, I have gotten Material type, thickness, x &amp; Y sizes, and qty used.</p>\n\n<p>I`m trying to get the 'cutting length' now - so I can use it in costing calculations.</p>\n\n<p>Here is the XML code segment :</p>\n\n<pre><code>&lt;Info num=\"6\" name=\"Tools\"&gt;\n      &lt;MC machine=\"psys_ETN_5\"&gt;\n        &lt;Tool name=\"TN901\" length=\"16262.96209\" time=\"53.72817301\" cutoutArea=\"8138.657052\"/&gt;\n      &lt;/MC&gt;\n    &lt;/Info&gt;\n</code></pre>\n\n<p>There are lots of 'Info' lines.\nThere may be more than one 'Tool' line, but I`m only after anything from line with 'TN901'.</p>\n\n<p>The data I`m trying to capture is the value of 'Length=\"######.##\"'</p>\n\n<p>I`ve captured everything else I need from code like this :</p>\n\n<pre><code>&lt;Material&gt;316&lt;/Material&gt;\n      &lt;SheetX&gt;2000&lt;/SheetX&gt;\n      &lt;SheetY&gt;1000&lt;/SheetY&gt;\n      &lt;Thickness&gt;3&lt;/Thickness&gt;\n&lt;/Material&gt;\n</code></pre>\n\n<p>using code like this:</p>\n\n<pre><code>    For Each nodemat In XMLDataDrg.SelectNodes(\"//Material\")\n        Matl = nodemat.Text\n        Worksheets(\"Sheet4\").Range(\"H\" &amp; RowA).Value = Matl\n    Next\n    For Each nodesht In XMLDataDrg.SelectNodes(\"//Thickness\")\n        Thk = nodesht.Text\n        Worksheets(\"Sheet4\").Range(\"I\" &amp; RowA).Value = Thk\n    Next\n</code></pre>\n\n<p>But that type of code does not get the cutting length.</p>\n\n<p>Any help please ? :)</p>\n\n<p>Thanks</p>\n\n<p>Simon</p>\n"}, {"tags": [".net", "excel", "vba", "excel-interop", "blueprism"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1550072798, "post_id": 54673922, "comment_id": 96137860, "body": "Set openedBook = Application.Workbooks.Open(book2open) When you are running this from C#, what is the application object? Do you think it can open a workbook?"}, {"owner": {"reputation": 3132, "user_id": 4385647, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/V3X9c.png?s=128&g=1", "display_name": "Dirk Horsten", "link": "https://stackoverflow.com/users/4385647/dirk-horsten"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 1, "creation_date": 1550072961, "post_id": 54673922, "comment_id": 96137968, "body": "It is the Excel application, and it obviously can, because it does so when called from the imediate window"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1550073243, "post_id": 54673922, "comment_id": 96138137, "body": "So, pretty much, the BluePrism is not relevant to the question? E.g. the question could be <b>how to call the &quot;macro&quot; from C#</b>? It really seems interesting, thus you may consider edititng it a bit and provide some <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> of how/what you tried in a C# console application? Furthermore, you may make your &quot;macro&quot; to just one robust line <code>MsgBox &quot;Something&quot;</code> to make sure you can access it from C#."}, {"owner": {"reputation": 3132, "user_id": 4385647, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/V3X9c.png?s=128&g=1", "display_name": "Dirk Horsten", "link": "https://stackoverflow.com/users/4385647/dirk-horsten"}, "edited": false, "score": 1, "creation_date": 1550073304, "post_id": 54673922, "comment_id": 96138161, "body": "Most probably.That is why it is not in the title."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1550073320, "post_id": 54673922, "comment_id": 96138167, "body": "The immediate window in the visual basic window in excel? When you have the excel application running? But you are calling your macro from BluePrism via MS Excel VBO - Extended - So is there an instance of Excel running at that point? or is the running application some sort of vb hosting app? Does BluePrism launch Excel?"}, {"owner": {"reputation": 3132, "user_id": 4385647, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/V3X9c.png?s=128&g=1", "display_name": "Dirk Horsten", "link": "https://stackoverflow.com/users/4385647/dirk-horsten"}, "edited": false, "score": 1, "creation_date": 1550073535, "post_id": 54673922, "comment_id": 96138295, "body": "Ineed, I first instantiate Excel from BluePrism, then open the macro enabled workbook. (Actually I open a macro enabled template.) All this runs some snippets of C# code, including the <code>GetInstance(Handle).Run(Macro_Name)</code>"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1550074039, "post_id": 54673922, "comment_id": 96138600, "body": "Can you not open the workbook directly from Blue Prism? why do you need to open a workbook that opens another workbook?. Also, whats the value of <code>book2open</code> when it attempts to open from Blue Prism?"}, {"owner": {"reputation": 3132, "user_id": 4385647, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/V3X9c.png?s=128&g=1", "display_name": "Dirk Horsten", "link": "https://stackoverflow.com/users/4385647/dirk-horsten"}, "edited": false, "score": 0, "creation_date": 1550135383, "post_id": 54673922, "comment_id": 96161467, "body": "I have to call that VBA Sub because it not only copies data from the source, it also validates and preprocesses it."}, {"owner": {"reputation": 339, "user_id": 10806412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898f8df491b04e0239414ca3033ccf1d?s=128&d=identicon&r=PG&f=1", "display_name": "Damian B", "link": "https://stackoverflow.com/users/10806412/damian-b"}, "edited": false, "score": 1, "creation_date": 1550500947, "post_id": 54673922, "comment_id": 96281456, "body": "The problem may be with your Macro_Name input format. If you want to pass path as string parameter within macro name string parameter, then it should look like this: &quot;OpenMyFile(&quot;&quot;\\\\myCompany\\myFolder\\myWorkbook.xlsx&quot;&quot;)&quot;."}, {"owner": {"reputation": 3132, "user_id": 4385647, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/V3X9c.png?s=128&g=1", "display_name": "Dirk Horsten", "link": "https://stackoverflow.com/users/4385647/dirk-horsten"}, "edited": false, "score": 0, "creation_date": 1550565085, "post_id": 54673922, "comment_id": 96304046, "body": "Indeed, you have to write <code>&quot;OpenMyFile(&quot;&quot;\\\\myCompany\\myFolder\\myWorkbook.xlsx&quot;&quot;)&quot;</code> to pass <code>OpenMyFile(&quot;\\\\myCompany\\myFolder\\myWorkbook.xlsx&quot;)</code>. That is what I do."}, {"owner": {"reputation": 339, "user_id": 10806412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898f8df491b04e0239414ca3033ccf1d?s=128&d=identicon&r=PG&f=1", "display_name": "Damian B", "link": "https://stackoverflow.com/users/10806412/damian-b"}, "edited": false, "score": 1, "creation_date": 1550575880, "post_id": 54673922, "comment_id": 96310673, "body": "I have no idea why it does not work, however you can try some workaround to provide the path. Instead of passing the path through sub parameter, pass it to Excel file with macro (for example to 1st cell of 1st sheet) using Set Cell Value action, then get path from cell in the macro (book2open = ThisWorkbook.Sheets(1).Cells(1, 1).Value) and use it to open the target Workbook."}], "answers": [{"tags": [], "owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "is_accepted": false, "score": 0, "last_activity_date": 1550683149, "last_edit_date": 1550683149, "creation_date": 1550681033, "answer_id": 54791377, "question_id": 54673922, "link": "https://stackoverflow.com/questions/54673922/why-does-a-vba-macro-that-opens-another-workbook-not-work-when-callend-from-dot/54791377#54791377", "title": "Why does a VBA macro that opens another workbook not work when callend from dot.net", "body": "<p>It is usually the case that Application.Run takes parameters to functions as separate arguments:</p>\n\n<p>This argument is not appropriate for Application.Run:\n<code>OpenMyFile(\"\\\\myCompany\\myFolder\\myWorkbook.xlsx\")</code></p>\n\n<p>You can try to amend the VBO to have a run parameter with arguments:\nWrite another code stage called 'Run Macro With Parameter' (or whatever you want to call it)</p>\n\n<p><code>GetInstance(Handle).Run(Macro_Name, param1)</code></p>\n\n<p>where Macro_Name is \"OpenMyFile\", and param1 is \"\\\\myCompany\\myFolder\\myWorkbook.xlsx\"</p>\n"}], "owner": {"reputation": 3132, "user_id": 4385647, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/V3X9c.png?s=128&g=1", "display_name": "Dirk Horsten", "link": "https://stackoverflow.com/users/4385647/dirk-horsten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 587, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550683149, "creation_date": 1550072168, "last_edit_date": 1550245595, "question_id": 54673922, "link": "https://stackoverflow.com/questions/54673922/why-does-a-vba-macro-that-opens-another-workbook-not-work-when-callend-from-dot", "title": "Why does a VBA macro that opens another workbook not work when callend from dot.net", "body": "<p>When working in BluePrism, I have a problem running an Excel macro that opens another workbook.</p>\n\n<h2>The Excel-VBA routine</h2>\n\n<p>I have a <code>Sub</code> in a macro enabled excel workbook <code>\\\\myCompany\\myFolder\\myMasterbook.xlsm</code> that opens another workbook</p>\n\n<pre><code>Public Sub OpenMyFile(Optional book2open As String = \"\")\n    Dim openedBook As Workbook\n    Debug.Print \"About to open\", book2open\n\n    Set openedBook = Application.Workbooks.Open(book2open)\n    If openedBook Is Nothing Then\n        Debug.Print \"Could not open it\"\n    Else\n        Debug.Print \"I found\", openedBook.Worksheets(1).Cells(1, 1).Value\n        ' Actually, I do a lot more with that workbook, of course\n        openedBook.Close\n    End If\nEnd Sub\n</code></pre>\n\n<p>When, in the Immidiate window (which you open with <code>Ctrl-G</code>), I enter </p>\n\n<pre><code>call OpenMyFile (\"\\\\myCompany\\myFolder\\myWorkbook.xlsx\")\n</code></pre>\n\n<p>I see the workbook open and close and get the response in the Immediate window</p>\n\n<pre><code>About to open   \\\\myCompany\\myFolder\\myWorkbook.xlsx\nI found   Cell A1 content\n</code></pre>\n\n<h2>Calling the VBA from BluePrism</h2>\n\n<p>In a Robotic Automation Process (RPA), using BluePrism, I need to open the workbook that contains this VBA <code>Sub</code> and run it.\nIn the Immidiate window, I now get</p>\n\n<pre><code>About to open   \\\\myCompany\\myFolder\\myWorkbook.xlsx\nCould not open it\n</code></pre>\n\n<p>I tried two things to resolve it</p>\n\n<h3>Call without arguments</h3>\n\n<p>If I define my <code>Sub</code> in VBA as </p>\n\n<pre><code>Public Sub OpenMyFile(Optional book2open As String = \"\\\\myCompany\\myFolder\\myWorkbook.xlsx\")\n</code></pre>\n\n<p>and call it with <code>OpenMyFile</code>, but that does not resolve my problem, as I <strong>need</strong> to pass <code>book2open</code> to VBA.</p>\n\n<h3>Make the parameter mandatory</h3>\n\n<p>If I define my <code>Sub</code> in VBA as <code>Public Sub OpenMyFile(book2open As String')</code>, I get this error: `Internal : Could not execute code stage because exception thrown by code stage: Cannot run the macro </p>\n\n<p>'OpenMyFile(\"C:\\Users\\P01549\\Documents\\TestHorsten.xlsx\", -1)'. The macro may not be available in this workbook or all macros may be disabled.`</p>\n\n<h2>The <code>MS Excel VBO - Extended</code> object uses interop</h2>\n\n<p>Part of the dot.net code can be found in BluePrisms <em>Object Studio</em>. I run the following \"Actions\" of this object</p>\n\n<h3>Create Instance</h3>\n\n<pre><code>Dim excel as Object = CreateObject(\"Excel.Application\")\n\n' Create a GUID with which we can kill the instance later\n' if we have to play hardball to get rid of it.\nexcel.Caption = System.Guid.NewGuid().ToString().ToUpper()\n\nhandle = GetHandle(excel)\n</code></pre>\n\n<h3>Open Workbook</h3>\n\n<pre><code>Dim wb as Object = GetInstance(handle).Workbooks.Open(filename)\nname = wb.Name\nwb.Activate()\n</code></pre>\n\n<p>With </p>\n\n<ul>\n<li><code>handle</code> : the handle returned by Create Instance</li>\n<li><code>filename</code> : <code>\\\\myCompany\\myFolder\\myMasterbook.xlsm</code></li>\n</ul>\n\n<h3>Run Macro</h3>\n\n<pre><code>GetInstance(Handle).Run(Macro_Name)\n</code></pre>\n\n<p>With </p>\n\n<ul>\n<li><code>handle</code> : the handle returned by Create Instance</li>\n<li><code>Macro_Name</code> : <code>OpenMyFile(\"\\\\myCompany\\myFolder\\myWorkbook.xlsx\")</code></li>\n</ul>\n\n<p>Does anyone have an explanation or a workacound?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 4, "creation_date": 1550070548, "post_id": 54673323, "comment_id": 96136453, "body": "This is off topic here - there is a <b>Overflow</b> site specifically fore mathematics. Voting to close as this is not a coding problem"}], "answers": [{"tags": [], "owner": {"reputation": 781, "user_id": 6299848, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DwEAxXq6T1I/AAAAAAAAAAI/AAAAAAAAAPA/Bcu8ARbxjmw/photo.jpg?sz=128", "display_name": "simple-solution", "link": "https://stackoverflow.com/users/6299848/simple-solution"}, "is_accepted": false, "score": 0, "last_activity_date": 1550828562, "last_edit_date": 1550828562, "creation_date": 1550826422, "answer_id": 54823517, "question_id": 54673323, "link": "https://stackoverflow.com/questions/54673323/how-to-optimize-two-ranges-for-the-determination-of-the-intersection-point-betwe/54823517#54823517", "title": "How to optimize two ranges for the determination of the intersection point between two curves", "body": "<p>Your question gave me some days of thinking and research.<br/>\nWith the help of <a href=\"https://pomax.github.io/bezierinfo/\" rel=\"nofollow noreferrer\">https://pomax.github.io/bezierinfo/</a>  </p>\n\n<blockquote>\n  <p>\u00a7 27 - Intersections (Line-line intersections)</p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>\u00a7 28 - Curve/curve intersection<br/></p>\n</blockquote>\n\n<p>your problem can be solved in Excel.<br/>\n<br/>\nAbout the mystery of Excel smoothed lines you find details here:\n<a href=\"https://blog.splitwise.com/2012/01/31/mystery-solved-the-secret-of-excel-curved-line-interpolation/\" rel=\"nofollow noreferrer\">https://blog.splitwise.com/2012/01/31/mystery-solved-the-secret-of-excel-curved-line-interpolation/</a></p>\n\n<p>The author of this fit is Dr. Brian T. Murphy, PhD, PE from www.xlrotor.com. You find details here:<br/>\n<a href=\"https://www.xlrotor.com/index.php/our-company/about-dr-murphy\" rel=\"nofollow noreferrer\">https://www.xlrotor.com/index.php/our-company/about-dr-murphy</a><br/>\n<a href=\"https://www.xlrotor.com/index.php/knowledge-center/files\" rel=\"nofollow noreferrer\">https://www.xlrotor.com/index.php/knowledge-center/files</a><br/>\n=>see  Smooth_curve_bezier_example_file.xls<br/>\n<a href=\"https://www.xlrotor.com/smooth_curve_bezier_example_file.zip\" rel=\"nofollow noreferrer\">https://www.xlrotor.com/smooth_curve_bezier_example_file.zip</a><br/></p>\n\n<p>These knitted together you get the <strong>following results</strong> for the intersection of your given curves:<br/></p>\n\n<pre><code>for the straight line intersection:\n(x = -1,02914127711195 / y = 23,2340949174492)\n\nfor the smooth line intersection:\n(x = -1,02947493047196 / y = 23,2370611219553)\n</code></pre>\n\n<p>For a full automation of your task you would need to add more details regarding the needed accuracy and what details you need for further processing (and this is actually not the scope of this website ;-).<br/>\n<br/>\n<br/>\n<strong>Intersection of the straight lines:</strong><br/>\n<br/></p>\n\n<p><a href=\"https://i.stack.imgur.com/KXabq.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KXabq.jpg\" alt=\"enter image description here\"></a>\n<br/>\n<br/>\n<strong>Intersection of the smoothed lines:</strong><br/>\n<br/>\n<a href=\"https://i.stack.imgur.com/iVcKQ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iVcKQ.jpg\" alt=\"enter image description here\"></a>\n<br/>\n<br/>\n<strong>comparison charts:</strong><br/>\n<br/>\n<a href=\"https://i.stack.imgur.com/Kxbh3.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Kxbh3.jpg\" alt=\"enter image description here\"></a>\n<br/></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11057054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/877c50f42f9e542294a4381533a645c5?s=128&d=identicon&r=PG&f=1", "display_name": "kalo86", "link": "https://stackoverflow.com/users/11057054/kalo86"}, "is_accepted": false, "score": 0, "last_activity_date": 1550934087, "creation_date": 1550934087, "answer_id": 54842907, "question_id": 54673323, "link": "https://stackoverflow.com/questions/54673323/how-to-optimize-two-ranges-for-the-determination-of-the-intersection-point-betwe/54842907#54842907", "title": "How to optimize two ranges for the determination of the intersection point between two curves", "body": "<p>solution,</p>\n\n<p>Thank you very much for the anwer, you perfectly centered my goal.\nYour solution (for the smoothed lines) is very very close to what I determine in Siemens NX.\nI'm going to read the documentation at the provided link <a href=\"https://pomax.github.io/bezierinfo/\" rel=\"nofollow noreferrer\">https://pomax.github.io/bezierinfo/</a> in order to better understand the math behind this argument.</p>\n\n<p>Then, to resume my request, you have been able to find the coordinates (x,y) of the intersection point between two curves without passing through an advanced CAD system with a very good precision.</p>\n\n<p>I am starting to study now, best regards!</p>\n\n<p>kalo86</p>\n"}], "owner": {"reputation": 1, "user_id": 11057054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/877c50f42f9e542294a4381533a645c5?s=128&d=identicon&r=PG&f=1", "display_name": "kalo86", "link": "https://stackoverflow.com/users/11057054/kalo86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1550934087, "creation_date": 1550070421, "last_edit_date": 1550072870, "question_id": 54673323, "link": "https://stackoverflow.com/questions/54673323/how-to-optimize-two-ranges-for-the-determination-of-the-intersection-point-betwe", "title": "How to optimize two ranges for the determination of the intersection point between two curves", "body": "<p>I start this thread asking for your help in Excel.\nThe main goal is to determine the coordinates of the intersection point P=(x,y) between two curves (curve A, curve B) modeled by points.\nThe curves are non-linear and each defining point is determined using complex equations (equations are dependent by a lot of parameters chosen by user, as well as user will choose the number of points which will define the accuracy of the curves). That is to say that each curve (curve A and curve B) is always changing in the plane XY (Z coordinate is always zero, we are working on the XY plane) according to the input parameters and the number of the defining points is also depending by the user choice.</p>\n\n<p>My first attempt was to determine the intersection point through the trend equations of each curve (I used the LINEST function to determine the coefficients of the polynomial equation) and by solving the solution putting them into a system. The problem is that Excel is not interpolating very well the curves because they are too wide, then the intersection point (the solution of the system) is very far from the real solution.\nThen, what I want to do is to shorten the ranges of points to be able to find two defining trend equations for the curves, cutting away the portion of curves where cannot exist the intersection.</p>\n\n<p>Today, in order to find the solution, I plot the curves on Siemens NX cad using multi-segment splines with order 3 and then I can easily find the coordinates of the intersection point. Please notice that I am using the multi-segment splines to be more precise with the approximation of the functions curve A and curve B.</p>\n\n<p>Since I want to avoid the CAD tool and stay always on Excel, is there a way to select a shorter range of the defining points close to the intersection point in order to better approximate curve A and curve B with trend equations (Linest function with 4 points and 3rd order spline) and then find the solution?</p>\n\n<p>I attach a picture to give you an example of Curve A and Curve B on the plane:\n<a href=\"https://postimg.cc/MfnKYqtk\" rel=\"nofollow noreferrer\">https://postimg.cc/MfnKYqtk</a></p>\n\n<p>At the following link you can find the Excel file with the coordinate points and the curve plot:\n<a href=\"https://www.mediafire.com/file/jqph8jrnin0i7g1/intersection.xlsx/file\" rel=\"nofollow noreferrer\">https://www.mediafire.com/file/jqph8jrnin0i7g1/intersection.xlsx/file</a></p>\n\n<p>I hope to solve this problem with your help, thank you in advance!\nkalo86</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1550070417, "post_id": 54673196, "comment_id": 96136368, "body": "Try <code>wordApp.Quit</code>"}, {"owner": {"reputation": 11, "user_id": 11037433, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216309804290724/picture?type=large", "display_name": "Marie", "link": "https://stackoverflow.com/users/11037433/marie"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1550070934, "post_id": 54673196, "comment_id": 96136714, "body": "I tried it but it gave me an error :( Where exactly should i put that statement in the code=?"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1550071046, "post_id": 54673196, "comment_id": 96136793, "body": "After you have done all the process, when you want to quit the instance of Word. Try adding it right before <code>Set wordApp = Nothing</code>"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1550071260, "post_id": 54673196, "comment_id": 96136941, "body": "@urdearboy Where is it done?"}, {"owner": {"reputation": 11, "user_id": 11037433, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216309804290724/picture?type=large", "display_name": "Marie", "link": "https://stackoverflow.com/users/11037433/marie"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1550071306, "post_id": 54673196, "comment_id": 96136977, "body": "@FoxfireAndBurnsAndBurns Ok, I wrote it at the wrong place - now it works fine! Thank you very much :) <b>If you write this as answer I could accept the answer ;)</b>"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1550071391, "post_id": 54673196, "comment_id": 96137021, "body": "@urdearboy You mean <code>Set wordApp = Nothing</code>? This line only breaks the binding she did, but instance of Word keeps executing. To close the Word Object, you need to quit with a line kind of <code>Object.Quit</code>"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1550071442, "post_id": 54673196, "comment_id": 96137052, "body": "Youre right, I completely misread your comment above. You were telling her to add <code>Quit</code> before <code>Set = Nothing</code>. I thought you saying to add the nothing - my apologies"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1550071527, "post_id": 54673196, "comment_id": 96137100, "body": "@urdearboy No problem at all! Sometimes I also misread code lines. No need of apologies. :)"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1550071565, "post_id": 54673196, "comment_id": 96137127, "body": "@Marie Post it as an answer. Glad it worked :)"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11037433, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216309804290724/picture?type=large", "display_name": "Marie", "link": "https://stackoverflow.com/users/11037433/marie"}, "edited": false, "score": 0, "creation_date": 1550071660, "post_id": 54673674, "comment_id": 96137189, "body": "Perfect &lt;3 Thank you very much"}], "tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": true, "score": 1, "last_activity_date": 1550071443, "creation_date": 1550071443, "answer_id": 54673674, "question_id": 54673196, "link": "https://stackoverflow.com/questions/54673196/improve-vba-code-it-keeps-word-instance-open-after-running/54673674#54673674", "title": "Improve VBA Code - it keeps word instance open after running", "body": "<p>Try adding <code>wordApp.Quit</code> right before <code>Set wordApp = Nothing</code> </p>\n"}], "owner": {"reputation": 11, "user_id": 11037433, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216309804290724/picture?type=large", "display_name": "Marie", "link": "https://stackoverflow.com/users/11037433/marie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 54673674, "answer_count": 1, "score": 0, "last_activity_date": 1550071443, "creation_date": 1550070042, "last_edit_date": 1550071216, "question_id": 54673196, "link": "https://stackoverflow.com/questions/54673196/improve-vba-code-it-keeps-word-instance-open-after-running", "title": "Improve VBA Code - it keeps word instance open after running", "body": "<p>I have got an Excel-Code to generate singular word-mailmerged-documents.\nIt all work fine. The only problem is that after running the code and closing excel there is still one word instance running in the taskmanager. \nCan someone help me fixing this?</p>\n\n<p>My code so far is:</p>\n\n<p>Private Sub CommandButton1_Click()</p>\n\n<pre><code>Dim wordApp As Word.Application\nDim wordTemplate As Word.Document\nDim wordMergedDoc As Word.MailMerge\n\nDim sourceBookPath As String\nDim sheetSourceName As String\nDim excelColumnFilter As String\nDim queryString As String\nDim baseQueryString As String\n\nDim wordTemplateDirectory As String\nDim wordTemplateFileName As String\nDim wordTemplateFullPath As String\nDim wordOutputDirectory As String\nDim wordOutputFileName As String\nDim wordOutputFullPath As String\n\nDim idListValues As Variant\nDim idValue As Integer\nDim idCounter As Integer\nDim recordCounter As Integer\nDim fileCounter As Integer\n\n\nidListValues = Array(1, 2, 3, 4, 5, 6, 7)\n\nsourceBookPath = ThisWorkbook.FullName\nsheetSourceName = \"Sheet1\"\nexcelColumnFilter = \"Anz\"\nbaseQueryString = \"SELECT * FROM `\" &amp; sheetSourceName &amp; \"$` where `\" &amp; excelColumnFilter &amp; \"` = [columFilterValue] order by `\" &amp; excelColumnFilter &amp; \"` ASC\"\n\n' Word:\nwordTemplateDirectory = ThisWorkbook.Path &amp; \"\\\"\nwordTemplateFileName = \"sb[columFilterValue].docx\"\nwordOutputDirectory = ThisWorkbook.Path &amp; \"\\\"\nwordOutputFileName = \"MailMergeDifferent[columFilterValue]_[Record]\"\n\nSet wordApp = New Word.Application\nwordApp.Visible = False\nwordApp.DisplayAlerts = wdAlertsNone\n\nMsgBox \"Verteidigungsanzeigen werden erstellt, bitte kurz warten :)\", vbOKOnly + vbInformation, \"Information\"\n\nFor idCounter = 0 To UBound(idListValues)\n\n    idValue = idListValues(idCounter)\n    queryString = Replace(baseQueryString, \"[columFilterValue]\", idValue)\n    wordTemplateFullPath = wordTemplateDirectory &amp; Replace(wordTemplateFileName, \"[columFilterValue]\", idValue)\n\n    Set wordTemplate = wordApp.Documents.Open(wordTemplateFullPath)\n\n    Set wordMergedDoc = wordTemplate.MailMerge\n\n      With wordMergedDoc\n\n        .MainDocumentType = wdFormLetters\n\n        .OpenDataSource _\n            Name:=sourceBookPath, _\n            ReadOnly:=True, _\n            Format:=wdOpenFormatAuto, _\n            Revert:=False, _\n            AddToRecentFiles:=False, _\n            LinkToSource:=False, _\n            Connection:=\"Provider=Microsoft.ACE.OLEDB.12.0;User ID=Admin;\" &amp; _\n                \"Data Source=\" &amp; sourceBookPath &amp; \";Mode=Read;Extended Properties=\"\"HDR=YES;IMEX=1\"\";\", _\n            SQLStatement:=queryString\n\n        .Destination = wdSendToNewDocument\n\n        .SuppressBlankLines = True\n\n                  For recordCounter = 1 To .DataSource.RecordCount\n\n           With .DataSource\n\n                .FirstRecord = wordMergedDoc.DataSource.ActiveRecord\n                .LastRecord = wordMergedDoc.DataSource.ActiveRecord\n                Dokumentenname = .DataFields(\"ID\")\n\n            End With\n            .Execute Pause:=False\n\n            wordOutputFullPath = wordOutputDirectory &amp; Replace(Replace(wordOutputFileName, \"[columFilterValue]\", idValue), \"[Record]\", recordCounter)\n\n            wordApp.ActiveDocument.SaveAs2 Filename:=wordOutputDirectory &amp; Dokumentenname &amp; \".docx\", FileFormat:=wdFormatXMLDocument, AddToRecentFiles:=False\n            wordApp.ActiveDocument.Close SaveChanges:=False\n\n            .DataSource.ActiveRecord = wdNextRecord\n\n            fileCounter = fileCounter + 1\n\n\n        Next recordCounter\n\n    End With\n\n    wordTemplate.Close False\n\nNext idCounter\n\nwordApp.Visible = False\nSet wordApp = Nothing\n\n\nMsgBox \"Geschafft! Es wurden \" &amp; fileCounter &amp; \"  Verteidigungsanzeigen erstellt\", vbOKOnly + vbInformation, \"Information\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 2, "creation_date": 1550069533, "post_id": 54672980, "comment_id": 96135719, "body": "Just put the code in one event then."}, {"owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 3, "creation_date": 1550070717, "post_id": 54672980, "comment_id": 96136557, "body": "The answers provided are all good except that they have no error handling.  So if your code fails between the &quot;Application.EnableEvents = False&quot; and the &quot;Application.EnableEvents = True&quot; statements, then you just left Excel is a bad state where no events will fire.  Any time you use &quot;Application.EnableEvents&quot;, &quot;Application.ScreenUpdating&quot;, etc. always use error handling to make sure that if your code fails, those kind of settings get set back to what they need to be.  I&#39;m a .NET/C# developer (VBA = Megablocks, C#=Lego Technic) and error handling is a must."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 1, "creation_date": 1550072311, "post_id": 54672980, "comment_id": 96137582, "body": "@FrankBall Right, added one in my answer."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 3722957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72017c51de08875dec5864cbef366d29?s=128&d=identicon&r=PG&f=1", "display_name": "user3722957", "link": "https://stackoverflow.com/users/3722957/user3722957"}, "edited": false, "score": 0, "creation_date": 1550070468, "post_id": 54673053, "comment_id": 96136393, "body": "Thank you! That fixes it"}], "tags": [], "owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "is_accepted": true, "score": 1, "last_activity_date": 1550069598, "creation_date": 1550069598, "answer_id": 54673053, "question_id": 54672980, "link": "https://stackoverflow.com/questions/54672980/multiple-worksheet-change-events-in-vba-code/54673053#54673053", "title": "Multiple Worksheet_Change events in vba code", "body": "<p>Like this you can do both the things in same event</p>\n\n<p>You have to add <code>Application.EnableEvents = False</code> at the starting to avoid race condition.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n Application.EnableEvents = False\n\n    Dim ccr As Range, acr as Range\n\n    Set ccr = Range(\"C6\")\n    For Each Cell In ccr\n      Cell.Value = LCase(Cell)\n    Next Cell\n\n    Set acr = Range(\"C9:G9\")\n    For Each Cell In acr\n      Cell.Value = LCase(Cell)\n    Next Cell\n Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 6, "last_activity_date": 1550072393, "last_edit_date": 1550072393, "creation_date": 1550069801, "answer_id": 54673117, "question_id": 54672980, "link": "https://stackoverflow.com/questions/54672980/multiple-worksheet-change-events-in-vba-code/54673117#54673117", "title": "Multiple Worksheet_Change events in vba code", "body": "<p>The main issue is that changing a cell value <code>Cell.Value</code> will trigger another <code>Worksheet_Change</code> immediately. You need to <code>Application.EnableEvents = False</code> to prevent this.</p>\n\n<p>Also I recommend to work with <code>Intersect</code> so the code only runs on the cells that are actually changed.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Dim AffectedRange As Range\n    Set AffectedRange = Intersect(Target, Target.Parent.Range(\"C6, C9:G9\"))\n\n    If Not AffectedRange Is Nothing Then\n        Application.EnableEvents = False 'pervent triggering another change event\n\n        Dim Cel As Range\n        For Each Cel In AffectedRange.Cells\n            Cel.Value = LCase$(Cel.Value)\n        Next Cel\n\n        Application.EnableEvents = True 'don't forget to re-enable events in the end\n    End If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>In addition to @Frank Ball's comment including error handling:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim AffectedRange As Range\n    Set AffectedRange = Intersect(Target, Target.Parent.Range(\"C6, C9:G9\"))\n\n    Application.EnableEvents = False 'pervent triggering another change event\n    On Error GoTo ERR_HANDLING\n\n    If Not AffectedRange Is Nothing Then\n        Dim Cel As Range\n        For Each Cel In AffectedRange.Cells\n            Cel.Value = LCase$(Cel.Value)\n        Next Cel\n    End If\n\n    On Error GoTo 0\n\n    'no Exit Sub here!\nERR_HANDLING:\n    Application.EnableEvents = True \n\n    If Err.Number &lt;&gt; 0 Then\n        Err.Raise Err.Number, Err.Source, Err.Description, Err.HelpFile, Err.HelpContext\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1550070193, "creation_date": 1550070193, "answer_id": 54673252, "question_id": 54672980, "link": "https://stackoverflow.com/questions/54672980/multiple-worksheet-change-events-in-vba-code/54673252#54673252", "title": "Multiple Worksheet_Change events in vba code", "body": "<p>The two <code>Worksheet_Change</code> events are quite the same, they are a loop around a range, returning <code>LCase()</code>. Thus, it is a good idea to make a separate Sub for it like this:</p>\n\n<pre><code>Sub FixRangeLCase(rangeToFix As Range)        \n    Dim myCell As Range\n    For Each myCell In rangeToFix\n        myCell.Value2 = LCase(myCell.Value2)\n    Next myCell    \nEnd Sub\n</code></pre>\n\n<p>Then, refer the Worksheet_Change event to it. As far as the <code>Worksheet_Change</code> event is quite \"expensive\", running always, it is a good idea to run it only when a specific Target cell is changed and otherwise exit the procedure -     <code>If Intersect(Target, Range(\"C6\"), Range(\"C9:G9\")) Is Nothing Then Exit Sub</code></p>\n\n<p>The <code>Application.EnableEvents = False</code> is needed to disable the events. At the end it is set back to <code>True</code>.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Not Intersect(Target, Range(\"C6\"), Range(\"C9:G9\")) Is Nothing Then Exit Sub\n    Application.EnableEvents = False\n    FixRangeLCase Range(\"C6\")\n    FixRangeLCase Range(\"C9:G9\")\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1550070436, "post_id": 54673307, "comment_id": 96136376, "body": "This is not right because it only changes target cell"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1550070472, "post_id": 54673307, "comment_id": 96136396, "body": "This <code>Target.Value = LCase(Target.Value)</code> fails if <code>Target</code> is a range of multiple cells. <code>LCase</code> cannot handle an array of values <code>Target.Value</code>."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1550070937, "post_id": 54673307, "comment_id": 96136717, "body": "@newguy what you mention is not an issue here because only <code>Target</code> cells actually changed so the others are already lower case (and don&#39;t need to be converted again). \u2022  The issue here would be that it would run on <b>all</b> changed cells even outside the given range not only on the cells in <code>C6, C9:G9</code> (but actually it fails because of the reason I mentioned above)."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1550071594, "post_id": 54673307, "comment_id": 96137149, "body": "@Error When using the <code>Worksheet_Change</code> event always keep in mind that <code>Target</code> can be a pasted <code>Range</code> not only a singe cell."}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1550072493, "post_id": 54673307, "comment_id": 96137682, "body": "@P\u1d07\u029c i believe i get the point &amp; i have edit the answer. Is it correct?"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1550072658, "post_id": 54673307, "comment_id": 96137782, "body": "@newguy answer edited. any other suggestions or corrections are welcome!"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1550072716, "post_id": 54673307, "comment_id": 96137820, "body": "Better in the meaning of not crashing because of <code>Target</code> beeing a range. But note that if eg only cell C10 is edited the complete <code>rng</code> is converted to lower case while only C10 changed and it would be sufficient to convert this cell only. To prevent this see my answer where I used <code>AffectedRange = Intersect(Target, Target.Parent.Range(&quot;C6, C9:G9&quot;))</code> to get only the changed cells of the desired range. So you would end up with what I answered."}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1550072935, "post_id": 54673307, "comment_id": 96137948, "body": "What is .parent use for?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1550073242, "post_id": 54673307, "comment_id": 96138136, "body": "If the event is triggered while another worksheet has focus I&#39;m not sure to which worksheet <code>Range</code> would default <code>Target.Parent</code> gives the worksheet where the range <code>Target</code> is in. So this ensures that <code>Range(&quot;C6, C9:G9&quot;)</code> points to the same worksheet as <code>Target</code> points to. Just to be save and not let Excel decide which sheet I mean."}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 1, "last_activity_date": 1550072442, "last_edit_date": 1550072442, "creation_date": 1550070382, "answer_id": 54673307, "question_id": 54672980, "link": "https://stackoverflow.com/questions/54672980/multiple-worksheet-change-events-in-vba-code/54673307#54673307", "title": "Multiple Worksheet_Change events in vba code", "body": "<p>Also you can use:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim rng As Range, cell As Range\n\n    Application.EnableEvents = False\n\n        If Not Intersect(Target, Range(\"C6\")) Is Nothing Or Not Intersect(Target, Range(\"C9:G9\")) Is Nothing Then\n            Set rng = Range(\"C9:G9\", \"C6\")\n\n            For Each cell In rng\n                cell.Value = LCase(cell.Value)\n            Next\n        End If\n\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 3722957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72017c51de08875dec5864cbef366d29?s=128&d=identicon&r=PG&f=1", "display_name": "user3722957", "link": "https://stackoverflow.com/users/3722957/user3722957"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4206, "favorite_count": 0, "accepted_answer_id": 54673053, "answer_count": 4, "score": 4, "last_activity_date": 1610962165, "creation_date": 1550069359, "last_edit_date": 1550069428, "question_id": 54672980, "link": "https://stackoverflow.com/questions/54672980/multiple-worksheet-change-events-in-vba-code", "title": "Multiple Worksheet_Change events in vba code", "body": "<p>I'm having problems merging two Worksheet_Change events - could I please get some advice from a guru?</p>\n\n<p>The aim of the code is to convert any uppercase text in the cell ranges given to lowercase, but obviously I can't have two events.</p>\n\n<p>I've tried copying both into the same Worksheet_Change, but Excel goes berzerk and crashed.</p>\n\n<p>Range 1:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim ccr As Range\n    Set ccr = Range(\"C6\")\n    For Each Cell In ccr\n    Cell.Value = LCase(Cell)\n    Next Cell\nEnd Sub\n</code></pre>\n\n<p>Range 2:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim acr As Range\n    Set acr = Range(\"C9:G9\")\n    For Each Cell In acr\n    Cell.Value = LCase(Cell)\n    Next Cell\nEnd Sub\n</code></pre>\n\n<p>Many thanks</p>\n"}, {"tags": ["excel", "vba", "web-scraping", "internet-explorer-11"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1550069346, "post_id": 54672843, "comment_id": 96135591, "body": "Note that your <code>If</code> statement <code>If haberbb = &quot;begen&quot; Then</code>  doesn&#39;t make any sense. It runs exactly the same code on <code>Then</code> as on <code>Else</code>!"}, {"owner": {"reputation": 3, "user_id": 11056393, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cWmBY2lH3FI/AAAAAAAAAAI/AAAAAAAAAC4/dTLP5l6LvlM/photo.jpg?sz=128", "display_name": "Zeyyat \u0130ZG\u0130", "link": "https://stackoverflow.com/users/11056393/zeyyat-%c4%b0zg%c4%b0"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1550082492, "post_id": 54672843, "comment_id": 96143326, "body": "Thank you for your answer. I&#39;m aware of my mistake. But I did it this way to see if they clicked positively or negatively."}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1550075514, "post_id": 54673498, "comment_id": 96139567, "body": "Thanks for that @P\u1d07\u029c"}, {"owner": {"reputation": 3, "user_id": 11056393, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cWmBY2lH3FI/AAAAAAAAAAI/AAAAAAAAAC4/dTLP5l6LvlM/photo.jpg?sz=128", "display_name": "Zeyyat \u0130ZG\u0130", "link": "https://stackoverflow.com/users/11056393/zeyyat-%c4%b0zg%c4%b0"}, "edited": false, "score": 0, "creation_date": 1550081879, "post_id": 54673498, "comment_id": 96143018, "body": "Thank you for your answer. I will try and inform you at the first opportunity"}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1550110267, "post_id": 54673498, "comment_id": 96153329, "body": "I try to click the like button and I can click it manually, than I try to run the @QHarr code and find that it is also working on my side with IE 11. Here is the testing result. <a href=\"https://i.postimg.cc/gJyYJMcS/45.gif\" rel=\"nofollow noreferrer\">i.postimg.cc/gJyYJMcS/45.gif</a>"}, {"owner": {"reputation": 3, "user_id": 11056393, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cWmBY2lH3FI/AAAAAAAAAAI/AAAAAAAAAC4/dTLP5l6LvlM/photo.jpg?sz=128", "display_name": "Zeyyat \u0130ZG\u0130", "link": "https://stackoverflow.com/users/11056393/zeyyat-%c4%b0zg%c4%b0"}, "edited": false, "score": 0, "creation_date": 1550130472, "post_id": 54673498, "comment_id": 96159074, "body": "Thank you. &quot;querySelector&quot; has solved my problem. Thanks for learning something new. Thanks again."}, {"owner": {"reputation": 3, "user_id": 11056393, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cWmBY2lH3FI/AAAAAAAAAAI/AAAAAAAAAC4/dTLP5l6LvlM/photo.jpg?sz=128", "display_name": "Zeyyat \u0130ZG\u0130", "link": "https://stackoverflow.com/users/11056393/zeyyat-%c4%b0zg%c4%b0"}, "edited": false, "score": 0, "creation_date": 1550154427, "post_id": 54673498, "comment_id": 96172690, "body": "Dear Qharr , When I clicked the button, they did it with a &quot;like&quot; increase. What I want to do is increase by 10 when I click. Is there a way to do this?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1550217925, "post_id": 54673498, "comment_id": 96195641, "body": "if you want to do 10 clicks then put the .click line instead of a for loop which runs from 1 to 10."}, {"owner": {"reputation": 3, "user_id": 11056393, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cWmBY2lH3FI/AAAAAAAAAAI/AAAAAAAAAC4/dTLP5l6LvlM/photo.jpg?sz=128", "display_name": "Zeyyat \u0130ZG\u0130", "link": "https://stackoverflow.com/users/11056393/zeyyat-%c4%b0zg%c4%b0"}, "edited": false, "score": 0, "creation_date": 1550243559, "post_id": 54673498, "comment_id": 96209843, "body": "When I press the like button, the number is increasing. but when I press a second time, the number doesn&#39;t increase. I think there is a case about the script. if I can solve it for - next cycle solves my job as you said."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1550243617, "post_id": 54673498, "comment_id": 96209875, "body": "Can you manually increase it more than once? I suspect the page is designed to prevent someone sock-puppet like voting."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1550075530, "last_edit_date": 1550075530, "creation_date": 1550070910, "answer_id": 54673498, "question_id": 54672843, "link": "https://stackoverflow.com/questions/54672843/object-htmldivelement-doesnt-click-on-ie11/54673498#54673498", "title": "Object htmldivelement doesn&#39;t click on IE11", "body": "<p>I don\u2019t know if that is functional or needs some form of login. I cannot manually click like.</p>\n\n<p>Here are 3 code ways:</p>\n\n<pre><code>Ie.document.querySelector(\".begen\").click\n\nIe.document.querySelector(\".begen\").FireEvent \"OnClick\"\n\nIe.document.parentWindow.execScript \"document.querySelector('.begen').click;\"\n</code></pre>\n\n<hr>\n\n<pre><code>Option Explicit\nPublic Sub AttemptClick()\n    Dim ie As New InternetExplorer\n    With ie\n        .Visible = True\n        .Navigate2 \"http://mukerremalikayanilkokulu.meb.k12.tr/icerikler/eglen-dusun-bul_6506730.html\"\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n        .document.querySelector(\".begen\").FireEvent \"onclick\"\n        .document.querySelector(\".begen\").Click\n        .document.parentWindow.execScript \"document.querySelector('.begen').click();\"\n        Stop\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 11056393, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cWmBY2lH3FI/AAAAAAAAAAI/AAAAAAAAAC4/dTLP5l6LvlM/photo.jpg?sz=128", "display_name": "Zeyyat \u0130ZG\u0130", "link": "https://stackoverflow.com/users/11056393/zeyyat-%c4%b0zg%c4%b0"}, "edited": false, "score": 0, "creation_date": 1550081937, "post_id": 54673806, "comment_id": 96143043, "body": "Thank you for your answer. I will try and inform you at the first opportunity"}, {"owner": {"reputation": 3, "user_id": 11056393, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cWmBY2lH3FI/AAAAAAAAAAI/AAAAAAAAAC4/dTLP5l6LvlM/photo.jpg?sz=128", "display_name": "Zeyyat \u0130ZG\u0130", "link": "https://stackoverflow.com/users/11056393/zeyyat-%c4%b0zg%c4%b0"}, "edited": false, "score": 0, "creation_date": 1550082267, "post_id": 54673806, "comment_id": 96143216, "body": "Application.Wait (Now + TimeValue(&quot;0:00:04&quot;))  this command I think hope yet"}, {"owner": {"reputation": 3, "user_id": 11056393, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cWmBY2lH3FI/AAAAAAAAAAI/AAAAAAAAAC4/dTLP5l6LvlM/photo.jpg?sz=128", "display_name": "Zeyyat \u0130ZG\u0130", "link": "https://stackoverflow.com/users/11056393/zeyyat-%c4%b0zg%c4%b0"}, "edited": false, "score": 0, "creation_date": 1550130681, "post_id": 54673806, "comment_id": 96159174, "body": "I heard &quot;ready state&quot; doesn&#39;t work at &quot;i11&quot;. it actually changed. :) worked very nice. Thank you too."}], "tags": [], "owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "is_accepted": false, "score": 0, "last_activity_date": 1550071869, "creation_date": 1550071869, "answer_id": 54673806, "question_id": 54672843, "link": "https://stackoverflow.com/questions/54672843/object-htmldivelement-doesnt-click-on-ie11/54673806#54673806", "title": "Object htmldivelement doesn&#39;t click on IE11", "body": "<p>In addition to QHarr's answer, your <code>Do While...Loop</code> isn't quite right.  </p>\n\n<ol>\n<li>You should do something in the loop, otherwise you are just going to spike the CPU usage. You should at least add a <code>DoEvents</code> in between to allow windows to process other programs/messages.</li>\n<li>It doesn't look like you are waiting for the page load to complete.  Try adding <code>Or ReadyState &lt; READYSTATE_COMPLETE</code> to the loop condition.</li>\n</ol>\n\n<p>Putting it together, the loop should look like:</p>\n\n<pre><code>Do While IE.Busy Or IE.ReadyState &lt; READYSTATE_COMPLETE ' = 4\n    DoEvents\nLoop\n</code></pre>\n\n<p>Here are some other references that might help:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/23299134/failproof-wait-for-ie-to-load\">Failproof Wait for IE to load</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/47455109/how-to-wait-for-the-page-to-load-after-click\">How to wait for the page to load after click</a></p>\n"}], "owner": {"reputation": 3, "user_id": 11056393, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cWmBY2lH3FI/AAAAAAAAAAI/AAAAAAAAAC4/dTLP5l6LvlM/photo.jpg?sz=128", "display_name": "Zeyyat \u0130ZG\u0130", "link": "https://stackoverflow.com/users/11056393/zeyyat-%c4%b0zg%c4%b0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 54673498, "answer_count": 2, "score": 0, "last_activity_date": 1557407175, "creation_date": 1550068974, "last_edit_date": 1557407175, "question_id": 54672843, "link": "https://stackoverflow.com/questions/54672843/object-htmldivelement-doesnt-click-on-ie11", "title": "Object htmldivelement doesn&#39;t click on IE11", "body": "<p>Will go to the school page and click on the like button. I'm going to the page object <code>htmldivelement</code> feature does not click the button. My commands are running with IE10, but it doesn't work with IE11.</p>\n\n<pre><code>Set hIE = CreateObject(\"InternetExplorer.Application\")   \nhURL = \"http://mukerremalikayanilkokulu.meb.k12.tr/icerikler/eglen-dusun-bul_6506730.html\"\n\nWith hIE\n    .Navigate hURL\n    .Visible = True\n\n    Do While hIE.Busy\n    Loop\nEnd With\n\nSet haberss = hIE.document.getElementsByClassName(\"begen\")\nFor Each haberbb In haberss\n    If haberbb = \"begen\" Then\n        Do While hIE.Busy\n        Loop\n        haberbb.Click\n        Set hIE = hIE.Quit\n        Exit For\n    Else\n        Do While hIE.Busy\n        Loop\n        haberbb.Click\n        Set hIE = hIE.Quit\n        Exit For\n    End If\n</code></pre>\n\n<p>The <code>haberbb</code> button works on IE10, but on IE11 it does not work.</p>\n"}, {"tags": ["vba", "coreldraw"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11056850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/416c09336c6c98d107eb47cf51dec63a?s=128&d=identicon&r=PG&f=1", "display_name": "Thirdcube", "link": "https://stackoverflow.com/users/11056850/thirdcube"}, "edited": false, "score": 0, "creation_date": 1550069258, "post_id": 54672678, "comment_id": 96135542, "body": "My understanding is that arrays need to be set with a given length. Can this be done dynamically using vr.count as per my original code example?"}, {"owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 0, "creation_date": 1550069471, "post_id": 54672678, "comment_id": 96135672, "body": "@Nathan_Sav You should move the contents of your comment into the question if they are relevant to the answer. Comments are ephemeral and not an appropriate place to provide a solution."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1550069843, "post_id": 54672678, "comment_id": 96135956, "body": "The <code>for....each</code> loop will sort itself out from the start of the array to the end, you can say from lbound to ubound."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 1, "last_activity_date": 1550069890, "last_edit_date": 1550069890, "creation_date": 1550068450, "answer_id": 54672678, "question_id": 54672524, "link": "https://stackoverflow.com/questions/54672524/how-to-merge-duplicate-data-in-a-single-array-dictionary-and-return-values/54672678#54672678", "title": "How to merge duplicate data in a single array/dictionary and return values?", "body": "<p>Use scripting.dictionary using the shape name as key for example, and use it's .exists method then have the item as the count and have a separate dictionary with the same key name, and then have a class/type/array/collection/dictionary with the dimensions in.</p>\n\n<p>Something like this would be a good start.</p>\n\n<pre><code>Sub x()\n\nDim a() As Variant\nDim d As Scripting.Dictionary\nDim v As Variant\n\na = Array(\"10 x 10\", \"20 x 20\", \"30 x 30\", \"10 x 10\")\n\nSet d = New Scripting.Dictionary\n\nFor Each v In a\n\n    If Not d.Exists(v) Then\n        d.Add v, 1\n    Else\n        d(v) = d(v) + 1\n    End If\n\nNext v\n\nFor Each v In d.Keys\n\n    Debug.Print d(v) &amp; \" of \" &amp; v\n\nNext v\n\nEnd Sub\n</code></pre>\n\n<p>Gives the result</p>\n\n<p>2 of 10 x 10</p>\n\n<p>1 of 20 x 20</p>\n\n<p>1 of 30 x 30</p>\n"}], "owner": {"reputation": 3, "user_id": 11056850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/416c09336c6c98d107eb47cf51dec63a?s=128&d=identicon&r=PG&f=1", "display_name": "Thirdcube", "link": "https://stackoverflow.com/users/11056850/thirdcube"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 54672678, "answer_count": 1, "score": 0, "last_activity_date": 1550069890, "creation_date": 1550067961, "last_edit_date": 1550069433, "question_id": 54672524, "link": "https://stackoverflow.com/questions/54672524/how-to-merge-duplicate-data-in-a-single-array-dictionary-and-return-values", "title": "How to merge duplicate data in a single array/dictionary and return values?", "body": "<p>I've written a VBA macro for CorelDraw that loops through selected objects and returns values as a string. I want it to be able to handle duplicate data better, for example if two objects have the same size, it should return</p>\n\n<pre><code>\"2 of 10 x 10\"\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>\"1 of 10 x 10\"\n\"1 of 10 x 10\"\n</code></pre>\n\n<p>Coming from Ruby (specifically thinking of hashes), I'm thinking that the macro should loop through the selected range, add (object.sizeWidth, object.sizeHeight) data as strings to an array/dictionary where it should be checked for duplicates and count them. I don't know what's best or how to set/check their values.</p>\n\n<p>Here is my code so far</p>\n\n<pre><code>Sub objectsToString()\n\nDim str As String\nDim v As Shape, vr As ShapeRange\nDim xSize#, ySize#\nDim dupCount As Integer\n\nstr = \"\"\nSet vr = ActiveSelectionRange\n\n    For Each v In vr\n    dupCount = 'value assigned via iteration\n    xSize = v.SizeWidth\n    ySize = v.SizeHeight\n    str = str &amp; dupCount &amp; \" of \" &amp; xSize &amp; \" x \" &amp; ySize &amp; vbNewLine\n\n    Next v\n\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1550067583, "post_id": 54672336, "comment_id": 96134410, "body": "You need to say <code>.Range(&quot;X&quot; &amp; LastRow).Value</code> or <code>.cells(lastrow,24)</code> you are not supplying a column, just the row."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 10429930, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rp3ogmNMJGI/AAAAAAAAAAI/AAAAAAAAAK4/kIfiLQ4Xju8/photo.jpg?sz=128", "display_name": "David Cady", "link": "https://stackoverflow.com/users/10429930/david-cady"}, "edited": false, "score": 0, "creation_date": 1550071084, "post_id": 54672406, "comment_id": 96136815, "body": "I tried it like this;  doc.FormFields(&quot;ClaimNumber&quot;).Text = .Range(&quot;A&quot; &amp; LastRow).Value   and it returned a Type Mismatch.... and when I tried it like this;   doc.FormFields(&quot;ClaimNumber&quot;).Text = .Cells(LastRow, 24) i got an error that the Object doesn&#39;t support this property or method."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 61, "user_id": 10429930, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rp3ogmNMJGI/AAAAAAAAAAI/AAAAAAAAAK4/kIfiLQ4Xju8/photo.jpg?sz=128", "display_name": "David Cady", "link": "https://stackoverflow.com/users/10429930/david-cady"}, "edited": false, "score": 0, "creation_date": 1550071550, "post_id": 54672406, "comment_id": 96137119, "body": "What is <code>LastRow</code> at this point.  What is the sheet this is referencing?"}, {"owner": {"reputation": 61, "user_id": 10429930, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rp3ogmNMJGI/AAAAAAAAAAI/AAAAAAAAAK4/kIfiLQ4Xju8/photo.jpg?sz=128", "display_name": "David Cady", "link": "https://stackoverflow.com/users/10429930/david-cady"}, "edited": false, "score": 0, "creation_date": 1550073725, "post_id": 54672406, "comment_id": 96138414, "body": "I have this piece where I define LastRow:  Set wkbk = Workbooks.Open(&quot;J:\\Accident Reports\\98 Claims Register.xlsx&quot;)          With wkbk.Sheets(&quot;Sheet1&quot;)         LastRow = .Range(&quot;A&quot; &amp; .Rows.Count).End(xlUp).Row     End With"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 61, "user_id": 10429930, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rp3ogmNMJGI/AAAAAAAAAAI/AAAAAAAAAK4/kIfiLQ4Xju8/photo.jpg?sz=128", "display_name": "David Cady", "link": "https://stackoverflow.com/users/10429930/david-cady"}, "edited": false, "score": 0, "creation_date": 1550073977, "post_id": 54672406, "comment_id": 96138560, "body": "And you&#39;re enclosing <code>.cells(lastrow,24)</code> in the with block also?"}, {"owner": {"reputation": 61, "user_id": 10429930, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rp3ogmNMJGI/AAAAAAAAAAI/AAAAAAAAAK4/kIfiLQ4Xju8/photo.jpg?sz=128", "display_name": "David Cady", "link": "https://stackoverflow.com/users/10429930/david-cady"}, "edited": false, "score": 0, "creation_date": 1550075746, "post_id": 54672406, "comment_id": 96139712, "body": "I think I might be misunderstanding. I am defining it here:                                      (With wkbk.Sheets(&quot;Sheet1&quot;)         LastRow = .Range(&quot;A&quot; &amp; .Rows.Count).End(xlUp).Row     End With)                            Then I am calling it here:                                              (With doc         doc.FormFields(&quot;ClaimNumber&quot;).Text = .Cells(LastRow, 24)         End With)"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 61, "user_id": 10429930, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rp3ogmNMJGI/AAAAAAAAAAI/AAAAAAAAAK4/kIfiLQ4Xju8/photo.jpg?sz=128", "display_name": "David Cady", "link": "https://stackoverflow.com/users/10429930/david-cady"}, "edited": false, "score": 0, "creation_date": 1550135967, "post_id": 54672406, "comment_id": 96161792, "body": "your with block is word doc then, not the excel sheet.  you need to chose one to reference properly."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 1, "last_activity_date": 1550067654, "creation_date": 1550067654, "answer_id": 54672406, "question_id": 54672336, "link": "https://stackoverflow.com/questions/54672336/trying-to-populate-an-activex-textbox-in-word-with-the-last-cell-value-of-an-exc/54672406#54672406", "title": "Trying to populate an ActiveX Textbox in Word with the last cell value of an Excel Sheet", "body": "<p>You are not supplying a column, just the row, so you need to say <code>.Range(\"X\" &amp; LastRow).Value</code> or <code>.cells(lastrow,24)</code></p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 10429930, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rp3ogmNMJGI/AAAAAAAAAAI/AAAAAAAAAK4/kIfiLQ4Xju8/photo.jpg?sz=128", "display_name": "David Cady", "link": "https://stackoverflow.com/users/10429930/david-cady"}, "is_accepted": false, "score": 0, "last_activity_date": 1550093893, "creation_date": 1550093893, "answer_id": 54679843, "question_id": 54672336, "link": "https://stackoverflow.com/questions/54672336/trying-to-populate-an-activex-textbox-in-word-with-the-last-cell-value-of-an-exc/54679843#54679843", "title": "Trying to populate an ActiveX Textbox in Word with the last cell value of an Excel Sheet", "body": "<p>I figured it out. Here is the final code that works.</p>\n\n<pre><code>Private Sub RequestClaimNumber_Click()\n\n    Dim wkbk As Workbook\n    Dim lastColumn As Long\n\n    RequiredField PolicyName, \"Please insert a name for the Policy Holder in the 'Policy Holder Name' field.\"\n    RequiredField InsuredName, \"Please insert a name for the Contractor in the 'Insured Name' field.\"\n    RequiredField DOL, \"Please enter a Date of Loss for this incident.\"\n\n    Set wkbk = Workbooks.Open(\"J:\\Accident Reports\\98 Claims Register.xlsx\")\n\n    With wkbk.Sheets(\"Sheet1\")\n        lastColumn = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row\n    End With\n\n    With wkbk.Sheets(\"Sheet1\")\n        rw = GetLastRow(\"B\")\n        .Range(\"B\" &amp; rw) = ThisDocument.ReportDate\n        rw = GetLastRow(\"C\")\n        .Range(\"C\" &amp; rw) = ThisDocument.DOL\n        rw = GetLastRow(\"D\")\n        .Range(\"D\" &amp; rw) = ThisDocument.PolicyName\n        rw = GetLastRow(\"E\")\n        .Range(\"E\" &amp; rw) = ThisDocument.InsuredName\n        rw = GetLastRow(\"F\")\n        .Range(\"F\" &amp; rw) = ThisDocument.UserID\n        ClaimNumber.Text = .Range(\"A\" &amp; lastColumn + 1).Text\n    End With\n    wkbk.Save\n    wkbk.Close\n    Set wkbk = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 10429930, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rp3ogmNMJGI/AAAAAAAAAAI/AAAAAAAAAK4/kIfiLQ4Xju8/photo.jpg?sz=128", "display_name": "David Cady", "link": "https://stackoverflow.com/users/10429930/david-cady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1550093893, "creation_date": 1550067443, "last_edit_date": 1550067622, "question_id": 54672336, "link": "https://stackoverflow.com/questions/54672336/trying-to-populate-an-activex-textbox-in-word-with-the-last-cell-value-of-an-exc", "title": "Trying to populate an ActiveX Textbox in Word with the last cell value of an Excel Sheet", "body": "<p>I am auto incrementing Column A in an excel spreadsheet with this;</p>\n\n<pre><code>=IF(B3=\"\",\"\",A2+1)\n</code></pre>\n\n<p>I do this so that when data is added to Column B the ID number in Column A increments by 1.</p>\n\n<p>At the same time, I have a Word doc that I added a Command Button to. The idea is that the user will press the command button, it will populate columns B through E with data from the Word Doc, which will cause A to increment, then I want to take the value of A and put it into an ActiveX Textbox back on the word doc. I have everything working except for the transfer of the incremented ID # in column A back to the Word doc. Here is what I have so far. The first function finds the last row for me in order to populate the data from the word doc to the excel spreadsheet. It works fine for that purpose, but using it the opposite way doesn't work. The second function is something I use to make sure the required fields have actual data in them so I am not trying to write blank fields to the spreadsheet.</p>\n\n<pre><code>Function GetLastRow(ByVal col As String) As Long\n   With Worksheets(\"Sheet1\")\n      GetLastRow = .Range(col &amp; .Rows.Count).End(xlUp).Row + 1\n   End With\nEnd Function\n\nFunction RequiredField(strQuestion, strMessage)\n    If strQuestion.Text = \"\" Then\n        Do\n            sInFld = InputBox(strMessage)\n        Loop While sInFld = \"\"\n            strQuestion.Text = sInFld\n    End If\n    'Required Field Prompt Function w/ input box\n\nEnd Function\n\nPrivate Sub RequestClaimNumber_Click()\n\n    Dim wkbk As Workbook\n    Dim doc As Object\n    Dim app As Object\n    Dim sdocname As String\n    Dim LastRow As Long\n\n    Set app = GetObject(, \"Word.Application\")\n    sdocname = \"J:\\Correspondence\\CAST Database\\Word Docs\\General Loss Form.docm\"\n    Set doc = ThisDocument\n    Set wkbk = Workbooks.Open(\"J:\\Accident Reports\\98 Claims Register.xlsx\")\n\n    With wkbk.Sheets(\"Sheet1\")\n        LastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n    End With\n    Debug.Print LastRow\n\n    RequiredField PolicyName, \"Please insert a name for the Policy Holder in the 'Policy Holder Name' field.\"\n    RequiredField InsuredName, \"Please insert a name for the Contractor in the 'Insured Name' field.\"\n    RequiredField DOL, \"Please enter a Date of Loss for this incident.\"\n\n    With wkbk.Sheets(\"Sheet1\")\n        rw = GetLastRow(\"B\")\n        .Range(\"B\" &amp; rw) = ThisDocument.ReportDate\n        rw = GetLastRow(\"C\")\n        .Range(\"C\" &amp; rw) = ThisDocument.DOL\n        rw = GetLastRow(\"D\")\n        .Range(\"D\" &amp; rw) = ThisDocument.PolicyName\n        rw = GetLastRow(\"E\")\n        .Range(\"E\" &amp; rw) = ThisDocument.InsuredName\n        With doc\n            doc.FormFields(\"ClaimNumber\").Result = .Range(LastRow).Value\n        End With\n    End With\n    wkbk.Save\n    wkbk.Close\n    Set wkbk = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>The problem seems to be with this: </p>\n\n<pre><code>LastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n</code></pre>\n\n<p>When I debug that line it returns with the number 30687. I am assuming this is supposed to be the cell that it is returning on the spreadsheet. I also get a </p>\n\n<blockquote>\n  <p>\"Subscript Out of Range\" </p>\n</blockquote>\n\n<p>error, and it highlights this row;</p>\n\n<pre><code>doc.FormFields(\"ClaimNumber\").Result = .Range(LastRow).Value\n</code></pre>\n\n<p>My assumption is that it is not finding the actual last used cell in column A. It is going to the very bottom of A and not finding anything. To this end I have tried several methods of trying to find the last cell, but they all give me the same subscript out of range error, and they all return the value of 30687 when I debug them.</p>\n\n<p>If there is a different way of doing this that I don't know of I am open to suggestions. Otherwise I just need to figure out where my problem is with my existing code so I can get this working.</p>\n"}, {"tags": ["excel", "vba", "copy", "range", "trace"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1550067543, "post_id": 54672306, "comment_id": 96134371, "body": "Where do you want the changes tracked? What changes to you want tracked? Do you want the time it was changed? The old value?"}, {"owner": {"reputation": 3, "user_id": 11056834, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rEoxEgvzfdo/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNVstQ_Q-u_BZ_65j-pwMu50KuCCQ/mo/photo.jpg?sz=128", "display_name": "Duedrengen", "link": "https://stackoverflow.com/users/11056834/duedrengen"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1550068059, "post_id": 54672306, "comment_id": 96134743, "body": "I would like new value, old value, time, author, and cell number which was changed.  I would like the location of the track-changes to be at A96:E96 in the same document as the table."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11056834, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rEoxEgvzfdo/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNVstQ_Q-u_BZ_65j-pwMu50KuCCQ/mo/photo.jpg?sz=128", "display_name": "Duedrengen", "link": "https://stackoverflow.com/users/11056834/duedrengen"}, "edited": false, "score": 0, "creation_date": 1550068803, "post_id": 54672640, "comment_id": 96135239, "body": "Thanks a lot. This was exactly what I was looking for."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1550068984, "post_id": 54672640, "comment_id": 96135358, "body": "Note that worksheet changes are specific to one sheet so you do not need to test the sheet here. The <code>Target</code> will always and forever exist on the sheet that houses this code. It is a redundant check"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1550069024, "post_id": 54672640, "comment_id": 96135384, "body": "So, that means you can reduce to <code>If Target.Cells.Count &gt; 1 or Target.Column &lt;&gt; 4 Then Exit Sub</code>"}], "tags": [], "owner": {"reputation": 824, "user_id": 5023092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNreo.png?s=128&g=1", "display_name": "Gordon K", "link": "https://stackoverflow.com/users/5023092/gordon-k"}, "is_accepted": true, "score": 0, "last_activity_date": 1550068921, "last_edit_date": 1550068921, "creation_date": 1550068339, "answer_id": 54672640, "question_id": 54672306, "link": "https://stackoverflow.com/questions/54672306/how-to-make-track-changes-column-range-specific/54672640#54672640", "title": "How to make track-changes column/range specific", "body": "<p>You can do it by adding a single line to your existing code:</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n    Dim bBold As Boolean\n    If Target.Cells.Count &gt; 1 Then Exit Sub\n    If ActiveSheet.Name = \"Pricing\" Then Exit Sub\n    If Target.Column &lt;&gt; 4 Then Exit Sub\n</code></pre>\n\n<p>This will just check to see if it is the 4th column of your sheet that has been changed and will ignore changes elsewhere.</p>\n"}], "owner": {"reputation": 3, "user_id": 11056834, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rEoxEgvzfdo/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNVstQ_Q-u_BZ_65j-pwMu50KuCCQ/mo/photo.jpg?sz=128", "display_name": "Duedrengen", "link": "https://stackoverflow.com/users/11056834/duedrengen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 54672640, "answer_count": 1, "score": 0, "last_activity_date": 1550068921, "creation_date": 1550067383, "last_edit_date": 1550067829, "question_id": 54672306, "link": "https://stackoverflow.com/questions/54672306/how-to-make-track-changes-column-range-specific", "title": "How to make track-changes column/range specific", "body": "<p>I have a table with a number of columns and rows in it and I would like to track the changes made in a specific column. I found the code (see bottom of message) online, and it works perfectly. However, it tracks \u201call changes\u201d. Is there a way to make it range specific. For example I only want to track the changes made in the column with the red numbers. Please see the example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/w7db6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w7db6.png\" alt=\"enter image description here\"></a></p>\n\n<p>The code I found online is the following:</p>\n\n<pre><code>Option Explicit\n\nDim vOldVal 'Must be at top of module\n\nPrivate Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n    Dim bBold As Boolean\n    If Target.Cells.Count &gt; 1 Then Exit Sub\n    If ActiveSheet.Name = \"Pricing\" Then Exit Sub\n    'On Error Resume Next\n    With Application\n         .ScreenUpdating = False\n         .EnableEvents = False\n    End With\n    If IsEmpty(vOldVal) Then vOldVal = \"Empty Cell\"\n    bBold = Target.HasFormula\n        With Sheets(\"Data\")\n            '.Unprotect Password:=\"Secret\"\n                If .Range(\"A96\") = vbNullString Then\n                    .Range(\"A96:H96\") = Array(\"Cell Changed\", \"Old Value\", _\n                        \"New Value\", \"Old Formula\", \"New Formula\", \"Time of Change\")\n                End If\n            With .Cells(.Rows.Count, 1).End(xlUp)(2, 1)\n                  .Value = ActiveSheet.Name &amp; \" : \" &amp; Target.Address\n                  .Offset(0, 1) = vOldVal\n            With .Offset(0, 2)\n              If bBold = True Then\n                .ClearComments\n                .AddComment.Text Text:= _\n                     \"OzGrid.com:\" &amp; Chr(10) &amp; \"\" &amp; Chr(10) &amp; _\n                        \"Bold values are the results of formulas\"\n              End If\n                .Value = Target\n                .Font.Bold = bBold\n\n            End With\n                .Offset(0, 3) = Time\n                .Offset(0, 4) = Date\n                .Offset(0, 5) = Application.UserName\n            End With\n            .Cells.Columns.AutoFit\n            '.Protect Password:=\"Secret\"\n        End With\n    vOldVal = vbNullString\n    With Application\n         .ScreenUpdating = True\n         .EnableEvents = True\n    End With\n    On Error GoTo 0\nEnd Sub\n\n\nPrivate Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)\n        vOldVal = Target\nEnd Sub\n\n\nPrivate Sub test()\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Please keep in mind that I'm very new to VBA coding.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1550067489, "last_edit_date": 1550067489, "creation_date": 1550066977, "answer_id": 54672162, "question_id": 54671525, "link": "https://stackoverflow.com/questions/54671525/errorhandler-not-working-compiling-error-object-not-found/54672162#54672162", "title": "ErrorHandler not working -&gt; compiling error / object not found", "body": "<p>Compiling errors are errors, which occur in compiling time. They cannot be covered by <code>OnError</code> statement. The errors, covered by <code>OnError</code> are run-time errors, which appear after compiling and during run time.</p>\n\n<p>\"As long as there is an object (SpinButton_Nr) it's working. With no object I get a compiling error.\" - If you want to get run-time error and not compiling error, the binding of the object should be done during run-time.</p>\n\n<p>Imagine the following scenario, with <code>Tabelle5</code> as a worksheet variable in Excel:</p>\n\n<pre><code>Sub CompileTimeError()\n    With Tabelle5\n        Debug.Print .Cells(1, 1)\n    End With\nEnd Sub\n</code></pre>\n\n<p>This would not compile, because VBE would not find the <code>Tabelle5</code> object. However, if you want a run-time error, this is a possible solution:</p>\n\n<pre><code>Sub RunTimeError()\n\n    Dim nameOfWorksheet As String\n    nameOfWorksheet = \"Tabelle5\"\n    With Worksheets(nameOfWorksheet)\n        Debug.Print .Cells(1, 1)\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1550068994, "last_edit_date": 1550068994, "creation_date": 1550068692, "answer_id": 54672756, "question_id": 54671525, "link": "https://stackoverflow.com/questions/54671525/errorhandler-not-working-compiling-error-object-not-found/54672756#54672756", "title": "ErrorHandler not working -&gt; compiling error / object not found", "body": "<p>I suggest the following:</p>\n\n<p>So you actually test if a spin button exists if not create it before you start formatting. No odd error handling and goto jumps in your procedure.</p>\n\n<pre><code>Option Explicit\n\nSub Cal_SpinButton_Nr()\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Tabelle5\") '&lt;-- tab name\n    'OR\n    'Set ws = Tabelle5 '&lt;-- VBA code name\n\n    Dim SpinBtn As Object\n    On Error Resume Next 'next line errors if no spinbutton exists\n    Set SpinBtn = ws.OLEObjects(\"SpinButton_Nr\")\n    On Error Goto 0 'always re-activate error reporting!\n\n    'if no spinbutton is found create it before formatting starts\n    If SpinBtn Is Nothing Then\n        Set SpinBtn = ws.OLEObjects.Add(\"Forms.SpinButton.1\")\n        SpinBtn.Name = \"SpinButton_Nr\"\n    End If\n\n    'format spin button\n    With SpinBtn\n        .Left = 198\n        .Height = 65.25\n        .Top = 1.5\n        .Width = 54.75\n\n        'not that for these .Object is necessary because of using .OLEObjects(\"SpinButton_Nr\")\n        .Object.Orientation = fmOrientationVertical\n        .Object.BackColor = &amp;H8000000F\n        .Object.ForeColor = &amp;H80000012\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 11028424, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-il2aECI8nzI/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOJvkT5hTYGMByqbeJudx4PEhBRhg/mo/photo.jpg?sz=128", "display_name": "rRacing9", "link": "https://stackoverflow.com/users/11028424/rracing9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 54672756, "answer_count": 2, "score": 1, "last_activity_date": 1550068994, "creation_date": 1550064960, "last_edit_date": 1550065820, "question_id": 54671525, "link": "https://stackoverflow.com/questions/54671525/errorhandler-not-working-compiling-error-object-not-found", "title": "ErrorHandler not working -&gt; compiling error / object not found", "body": "<p>I've created an excelfile with a couple of activeX-elements. So far the file is working as intended, now I'm working around \"user errors\" which might occur during daily business.\nFor later use the activeX-elements (Toggle-, Command- &amp; SpinButtons) are quite important, so I've created some subs to restore each element. They are working as expected.</p>\n\n<p>The issue: now what if someone deletes a button? I tried working with If-Statements (if >element&lt; is nothing then...), but it didn't work. The next approach was \"On Error GoTo\".\nSo I've built an ErrorHandler and as a regular code it works as intended. The handler creates an SpinButton with the desired name. If I build an error into my code (a = 1/0) the handler is doing his job, but that's just 'in vitro'.</p>\n\n<p>In vivo, if my desired >element&lt; is not there, my code ends in an error (compiling error_ method or object not found), but my handler does nothing, despite this is its sole purpose.</p>\n\n<p>My code:</p>\n\n<pre><code>Sub Cal_SpinButton_Nr()\nSubroutine: \n    On Error GoTo CreateObject:\nWith Tabelle5.SpinButton_Nr\n    .Left = 198\n    .Height = 65.25\n    .Top = 1.5\n    .Width = 54.75\n    .Orientation = fmOrientationVertical\n    .BackColor = &amp;H8000000F\n    .ForeColor = &amp;H80000012\nEnd With\n\nExit Sub\nCreateObject:\nTabelle5.OLEObjects.Add(\"Forms.SpinButton.1\").Name = \"SpinButton_Nr2\"\n'Resume Subroutine\nEnd Sub\n</code></pre>\n\n<p>Option Explicit is on and the sub contains no variables. As long as there is an object (SpinButton_Nr) it's working. With no object I get a compiling error.</p>\n\n<p>\"Resume Subroutine\" is silenced right now to avoid an endless loop (I learned my lesson by silencing \"exit sub\" first and pressing F5...), regular function is to fire the same sub again in order to put the new object in the right place.\nFor ('in vitro') testing reasons the new object is called _Nr2, later it's just _Nr.</p>\n\n<p>Now the question: Why is a compiling error not covered by the \"on error\"-statement? How can the code be modified in order to work properly?</p>\n\n<p>Syntax should be \"If >element&lt; exists, set properties, if <code>&lt;element&gt;</code> is not there then create it and set properties afterwards.</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 809, "user_id": 6301517, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bae3b1b6120f28d727740eb0695836a2?s=128&d=identicon&r=PG&f=1", "display_name": "Yolo_chicken", "link": "https://stackoverflow.com/users/6301517/yolo-chicken"}, "edited": false, "score": 0, "creation_date": 1550064864, "post_id": 54671370, "comment_id": 96132703, "body": "Could I also write in the ability to copy in a currently open word doc? As opposed to running through a directory, It looks at the open document and places it inside the excel sheet?"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 809, "user_id": 6301517, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bae3b1b6120f28d727740eb0695836a2?s=128&d=identicon&r=PG&f=1", "display_name": "Yolo_chicken", "link": "https://stackoverflow.com/users/6301517/yolo-chicken"}, "edited": false, "score": 0, "creation_date": 1550065802, "post_id": 54671370, "comment_id": 96133320, "body": "Yes - but in that case you need to point your object variable to the existing word instance: Dim wd As Word.Application Set wd = GetObject(, &quot;Word.Application&quot;)"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 1, "last_activity_date": 1550064460, "creation_date": 1550064460, "answer_id": 54671370, "question_id": 54671140, "link": "https://stackoverflow.com/questions/54671140/populate-excel-file-from-word-document-tables-vba/54671370#54671370", "title": "Populate Excel File from Word Document Tables - VBA", "body": "<p>That's the simplest solution. In Excel set a reference to Word in the VB Editor using Tools, References - you can then write code to manipulate Word from within Excel. You can use the keyword DIR to look for files in a folder, then declare a Word object, open the word document, iterate over the tables in the document and copy the values across to the right cells in Excel. Just watch for the ^p character that Word sticks in the cells - I tend to out the word cell's contents into a string variable and then take Left(s,len(s)-1) into excel to drop the last char.</p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": true, "score": 1, "last_activity_date": 1550071037, "creation_date": 1550071037, "answer_id": 54673537, "question_id": 54671140, "link": "https://stackoverflow.com/questions/54671140/populate-excel-file-from-word-document-tables-vba/54673537#54673537", "title": "Populate Excel File from Word Document Tables - VBA", "body": "<p>How about this?</p>\n\n<pre><code>Sub ImportFromWord()\n\nDim wrdApp As Word.Application\nDim wrdDoc As Word.Document\n\nSet wrdApp = CreateObject(\"Word.Application\")\nwrdApp.Visible = True\n\nSet wrdDoc = wrdApp.Documents.Open(ThisWorkbook.Path &amp; \"\\My document.doc\")\n'Use below line if document is already open.\n'Set wrdDoc = Documents(\"My document.doc\")\n\nWith wrdDoc\n\n    N_Of_tbles = .Tables.Count\n\n    If N_Of_tbles = 0 Then\n        MsgBox \"There are no tables in word document\"\n    End If\n\n    Set wrdTbl = .Tables(1)\n\n    ColCount = wrdTbl.Columns.Count\n    RowCount = wrdTbl.Rows.Count\n\n\n    ' Loop through each row of the table\n    For i = 1 To RowCount\n        'Loop through each column of that row\n        For j = 1 To ColCount\n            'This gives you the cell contents\n            Worksheets(\"sheet1\").Cells(i, j) = wrdTbl.Cell(i, j).Range.Text\n        Next j\n    Next i\nEnd With\n\nSet wrdDoc = Nothing\nSet wrdApp = Nothing\n\nMsgBox \"completed\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 809, "user_id": 6301517, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bae3b1b6120f28d727740eb0695836a2?s=128&d=identicon&r=PG&f=1", "display_name": "Yolo_chicken", "link": "https://stackoverflow.com/users/6301517/yolo-chicken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 413, "favorite_count": 0, "accepted_answer_id": 54673537, "answer_count": 2, "score": -2, "last_activity_date": 1550071037, "creation_date": 1550063804, "last_edit_date": 1550067638, "question_id": 54671140, "link": "https://stackoverflow.com/questions/54671140/populate-excel-file-from-word-document-tables-vba", "title": "Populate Excel File from Word Document Tables - VBA", "body": "<p>I'm fairly new to VBA and trying to populate a preexisting excel document based on Word Documents. </p>\n\n<p>The Word Documents will have three tables, and certain cells will become the Excel columns. The idea is, every day new product information sheets come in and the Excel sheet will need to be appended. I've started by looking over <a href=\"https://stackoverflow.com/questions/12138958/vba-copy-from-word-table-to-excel\">this</a> previously asked question. Do I create a macro-enabled excel sheet and run it from within Excel? Could I get the macro to look inside a directory for the word documents, and perform an iterative macro? </p>\n"}, {"tags": ["excel", "vba", "batch-file", "cmd"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1550064665, "post_id": 54671097, "comment_id": 96132582, "body": "I would handle a WMI process start and stop events from Excel VBA."}], "answers": [{"tags": [], "owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "is_accepted": false, "score": 1, "last_activity_date": 1550066840, "last_edit_date": 1550066840, "creation_date": 1550064720, "answer_id": 54671444, "question_id": 54671097, "link": "https://stackoverflow.com/questions/54671097/how-to-pass-string-or-parameters-from-batch-filecmd-to-excel-vba-program-or-ex/54671444#54671444", "title": "How to pass string or parameters from batch file(cmd) to excel vba program or excel cells?", "body": "<p>I advise you to work in the opposite direction: Instead of launching batch files and pass the results to Excel VBA, you might use the <code>Shell</code> VBA command in order to start the mentioned batch files from VBA.</p>\n"}], "owner": {"reputation": 1, "user_id": 10505975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d7b3817abf575a0d22d0552494c1fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Anavarathan", "link": "https://stackoverflow.com/users/10505975/anavarathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "closed_date": 1550122434, "answer_count": 1, "score": -4, "last_activity_date": 1550066840, "creation_date": 1550063706, "last_edit_date": 1550064781, "question_id": 54671097, "link": "https://stackoverflow.com/questions/54671097/how-to-pass-string-or-parameters-from-batch-filecmd-to-excel-vba-program-or-ex", "closed_reason": "Needs more focus", "title": "How to pass string or parameters from batch file(cmd) to excel vba program or excel cells?", "body": "<p>I am running multiple batch files. I would like to pass message(string) when batch files starting and ending to excel vba code or excel cells.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1550081736, "post_id": 54670907, "comment_id": 96142925, "body": "Take a look at - <a href=\"https://docs.microsoft.com/en-us/office/vba/access/concepts/date-time/find-the-number-of-working-days-between-two-dates\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/access/concepts/date-tim&zwnj;&#8203;e/&hellip;</a>.  Access doesn&#39;t have a defined function for this but there are many solutions-quite a few on stackoverflow itself."}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1550085061, "creation_date": 1550085061, "answer_id": 54677701, "question_id": 54670907, "link": "https://stackoverflow.com/questions/54670907/number-of-business-days-dynamic-month/54677701#54677701", "title": "Number of business days dynamic month", "body": "<p>You can use this expression:</p>\n\n<pre><code>WorkDays: ISO_WorkdayDiff(DateSerial(Year([TaetigkeitsDatum]), Month([TaetigkeitsDatum]), 1), DateSerial(Year([TaetigkeitsDatum]), Month([TaetigkeitsDatum]) + 1, 1))\n</code></pre>\n\n<p>and a function like this:</p>\n\n<pre><code>Public Function ISO_WorkdayDiff( _\n  ByVal datDateFrom As Date, _\n  ByVal datDateTo As Date, _\n  Optional ByVal booExcludeHolidays As Boolean) _\n  As Long\n\n' Purpose: Calculate number of working days between dates datDateFrom and datDateTo.\n' Assumes: 5 or 6 working days per week. Weekend is (Saturday and) Sunday.\n' May be freely used and distributed.\n\n' 1999-04-23. Gustav Brock, Cactus Data ApS, Copenhagen\n' 2000-10-03. Constants added.\n'             Option for 5 or 6 working days per week added.\n' 2008-06-12. Option to exclude holidays from the count of workdays.\n\n  Const cbytWorkdaysOfWeek  As Byte = 5\n  ' Name of table with holidays.\n  Const cstrTableHoliday    As String = \"tblHoliday\"\n  ' Name of date field in holiday table.\n  Const cstrFieldHoliday    As String = \"HolidayDate\"\n\n  Dim bytSunday             As Byte\n  Dim intWeekdayDateFrom    As Integer\n  Dim intWeekdayDateTo      As Integer\n  Dim lngDays               As Long\n  Dim datDateTemp           As Date\n  Dim strDateFrom           As String\n  Dim strDateTo             As String\n  Dim lngHolidays           As Long\n  Dim strFilter             As String\n\n  ' Reverse dates if these have been input reversed.\n  If datDateFrom &gt; datDateTo Then\n    datDateTemp = datDateFrom\n    datDateFrom = datDateTo\n    datDateTo = datDateTemp\n  End If\n\n  ' Find ISO weekday for Sunday.\n  bytSunday = Weekday(vbSunday, vbMonday)\n\n  ' Find weekdays for the dates.\n  intWeekdayDateFrom = Weekday(datDateFrom, vbMonday)\n  intWeekdayDateTo = Weekday(datDateTo, vbMonday)\n\n  ' Compensate weekdays' value for non-working days (weekends).\n  intWeekdayDateFrom = intWeekdayDateFrom + (intWeekdayDateFrom = bytSunday)\n  intWeekdayDateTo = intWeekdayDateTo + (intWeekdayDateTo = bytSunday)\n\n  ' Calculate number of working days between the two weekdays, ignoring number of weeks.\n  lngDays = intWeekdayDateTo - intWeekdayDateFrom - (cbytWorkdaysOfWeek * (intWeekdayDateTo &lt; intWeekdayDateFrom))\n  ' Add number of working days between the weeks of the two dates.\n  lngDays = lngDays + (cbytWorkdaysOfWeek * DateDiff(\"w\", datDateFrom, datDateTo, vbMonday, vbFirstFourDays))\n\n  If booExcludeHolidays And lngDays &gt; 0 Then\n    strDateFrom = Format(datDateFrom, \"yyyy\\/mm\\/dd\")\n    strDateTo = Format(datDateTo, \"yyyy\\/mm\\/dd\")\n    strFilter = cstrFieldHoliday &amp; \" Between #\" &amp; strDateFrom &amp; \"# And #\" &amp; strDateTo &amp; \"# And Weekday(\" &amp; cstrFieldHoliday &amp; \", 2) &lt;= \" &amp; cbytWorkdaysOfWeek &amp; \"\"\n    lngHolidays = DCount(\"*\", cstrTableHoliday, strFilter)\n  End If\n\n  ISO_WorkdayDiff = lngDays - lngHolidays\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 10362103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a3b1f57e7d1ebfcebfa1dba466b847?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/10362103/felix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 54677701, "answer_count": 1, "score": 0, "last_activity_date": 1550085061, "creation_date": 1550063086, "question_id": 54670907, "link": "https://stackoverflow.com/questions/54670907/number-of-business-days-dynamic-month", "title": "Number of business days dynamic month", "body": "<p>I need to make a report in Access about how many overtime every employee has. Because some workes work from Mo-Th 10h and Fr 0h i cant say </p>\n\n<blockquote>\n  <p>Count everything above 8h . </p>\n</blockquote>\n\n<p>Therefore I need all business days a month * 8h and  compare it with actual working time which I Sum by month ( already working! )</p>\n\n<p>Solution approach:</p>\n\n<pre><code> SELECT Format([TaetigkeitsDatum],\"mmmm yy\") AS Monat,  \n tbl_Taetigkeitserfassung.TaetigkeitsPersonalID,  \n Sum(tbl_Taetigkeitserfassung.TaetigkeitsStundenAnzeigen) AS  SummevonTaetigkeitsStundenAnzeigen\n FROM tbl_Taetigkeitserfassung\n GROUP BY Format([TaetigkeitsDatum],\"mmmm yy\"),  \n tbl_Taetigkeitserfassung.TaetigkeitsPersonalID;\n</code></pre>\n\n<p>This shows me the formatted Month(TaetigkeitsDatum), the Employee(TaetigkeitsPersonalID) and the Sum of the Working Hours ( TaetigkeitsStundenAnzeigen). </p>\n\n<p>But I dont know how to display the hours of Business days that month so I can compare and display overtime...</p>\n\n<p>Expected Solution:</p>\n\n<p>January 19: 23Days (without Weekend, holidays dont matter) * 8h = 184h\nWorking Time of Mr.X = 186h   -> 2h Overtime </p>\n\n<p>DateDiff isnt working, because I need 2 Dates for it to work and than there is the \"only count business days\" problem.</p>\n"}, {"tags": ["vba", "ms-access", "ms-word"], "comments": [{"owner": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "edited": false, "score": 0, "creation_date": 1550063063, "post_id": 54670845, "comment_id": 96131532, "body": "What is the datatype of <code>txtReasonforReward</code>? if it is <code>Short text</code> than change the datatype to <code>Long text</code> and under it change TextFormat to <code>RichText</code>."}, {"owner": {"reputation": 65, "user_id": 5083487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/351nC.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5083487/joe"}, "reply_to_user": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "edited": false, "score": 0, "creation_date": 1550063110, "post_id": 54670845, "comment_id": 96131563, "body": "Hi Tarun, do you mean within Access? Will this remove the issue of the character count without changing my code?"}, {"owner": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "edited": false, "score": 0, "creation_date": 1550063268, "post_id": 54670845, "comment_id": 96131662, "body": "are you able to see whole text in <code>Reason for Reward</code> in Form?"}, {"owner": {"reputation": 126, "user_id": 8800451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YBJyB.jpg?s=128&g=1", "display_name": "Ice Ax", "link": "https://stackoverflow.com/users/8800451/ice-ax"}, "edited": false, "score": 0, "creation_date": 1550063300, "post_id": 54670845, "comment_id": 96131677, "body": "<code>Short Text</code> is limited up to 255 characters. You can change it, it will not impact your code."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1550067787, "post_id": 54670845, "comment_id": 96134546, "body": "Joe, is it absolutely necessary to use form fields? Do you expect the user to afterward edit this information in a protected document? If not, use a <code>Bookmark</code> as the data target. A form field name is also a bookmark, so all that would be necessary is to unprotect the document and write to the bookmark..."}, {"owner": {"reputation": 65, "user_id": 5083487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/351nC.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5083487/joe"}, "reply_to_user": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "edited": false, "score": 0, "creation_date": 1550069686, "post_id": 54670845, "comment_id": 96135831, "body": "@Tarun.P tried your suggestion to no success I&#39;m afraid. The fields are Rich Text and set to Long."}, {"owner": {"reputation": 65, "user_id": 5083487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/351nC.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5083487/joe"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1550069728, "post_id": 54670845, "comment_id": 96135865, "body": "@CindyMeister No particular reason for using formfields, other than I didn&#39;t know anything about Bookmarks! Will this lift the 255 character limit?"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 5083487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/351nC.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5083487/joe"}, "edited": false, "score": 0, "creation_date": 1550071839, "post_id": 54673575, "comment_id": 96137291, "body": "Hi Cindy, thanks for the assistance. Can you advise how one would go about implementing this within my existing code block?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 65, "user_id": 5083487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/351nC.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5083487/joe"}, "edited": false, "score": 0, "creation_date": 1550072316, "post_id": 54673575, "comment_id": 96137590, "body": "@Joe I was on a mobile device, when I realized I needed to check my logic... I&#39;ve edited the code after testing. The comments should explain how it works. Put the declarations with the other ones, then put the rest in after writing to the form fields. (Remember to remove the one that&#39;s currently causing the error, that this is replacing.)"}, {"owner": {"reputation": 65, "user_id": 5083487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/351nC.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5083487/joe"}, "edited": false, "score": 0, "creation_date": 1550072804, "post_id": 54673575, "comment_id": 96137865, "body": "Think I&#39;m going wrong somewhere...   I&#39;ve put the first two lines above my With doc section, and then the rest after my End with to no success"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 65, "user_id": 5083487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/351nC.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5083487/joe"}, "edited": false, "score": 0, "creation_date": 1550074125, "post_id": 54673575, "comment_id": 96138654, "body": "Before the <code>End With</code> - in the position I show after writing to form fields; I copied/pasted the last two lines from your code in order to show the position. If it&#39;s still &quot;not working&quot; you need to provide more information about <i>how</i> it&#39;s not working."}, {"owner": {"reputation": 65, "user_id": 5083487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/351nC.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5083487/joe"}, "edited": false, "score": 0, "creation_date": 1550075822, "post_id": 54673575, "comment_id": 96139762, "body": "Apologies... didn&#39;t notice that they were the last two lines... Just to confirm, your first two lines DO NOT go within the With? I have it working with them outside..."}, {"owner": {"reputation": 65, "user_id": 5083487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/351nC.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5083487/joe"}, "edited": false, "score": 0, "creation_date": 1550076299, "post_id": 54673575, "comment_id": 96140066, "body": "Next question, I need the data from [Reason for Reward] to go into two separate fields within the Word document, is there an easy way to send it to two locations?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 65, "user_id": 5083487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/351nC.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5083487/joe"}, "edited": false, "score": 0, "creation_date": 1550076693, "post_id": 54673575, "comment_id": 96140292, "body": "Next question should be a <i>new</i> question @Joe ... How have you been doing it up untl now? If you haven&#39;t, then definitely a new question, with all the background infornation to be able to reproduce the logic and the situation."}, {"owner": {"reputation": 65, "user_id": 5083487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/351nC.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5083487/joe"}, "edited": false, "score": 0, "creation_date": 1550076854, "post_id": 54673575, "comment_id": 96140369, "body": "Hi Cindy, I was doing it before with a slightly backdoor solution:  .FormFields(&quot;txtReasonforReward2&quot;).Result = Me![Reason for Reward] Is there a quick way to implement this with what you&#39;ve supplied?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 65, "user_id": 5083487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/351nC.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5083487/joe"}, "edited": false, "score": 0, "creation_date": 1550077553, "post_id": 54673575, "comment_id": 96140747, "body": "In that case, please make it a new question as the approach used up until now (altered to fit the different field name) would also work with the proposed answer to the question of how to avoid the character limit with form fields. Different topic = different question according to site guidelines :-)"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1550072191, "last_edit_date": 1550072191, "creation_date": 1550071138, "answer_id": 54673575, "question_id": 54670845, "link": "https://stackoverflow.com/questions/54670845/how-to-get-around-the-character-limit-on-formfields-vba-passing-from-access-to-w/54673575#54673575", "title": "How to get around the character limit on FormFields VBA passing from Access to Word", "body": "<p>Word has a number of possible objects that can be used as \"data targets\", of which form fields is one. Bookmarks and content controls are additional (but not the only) possibilities.</p>\n\n<p>In this case, I would suggest writing the data to a <code>Bookmark</code>, since a form field is also a bookmark - the target document wouldn't need to be changed. This will avoid the 255 character limit, which is due to the form field, not to Word. </p>\n\n<p>In order to write to a bookmark in a document protected as a form (which this appears to be) it is necessary to remove forms protection. This can be re-instated writing the data. It's probably a good idea to do so, as otherwise the form fields could reset, which would lose the data written to them. That, or apply the bookmark technique across the board rather than to only one data target. </p>\n\n<pre><code>'Add objects to the declarations\nDim rng As Word.Range\nDim x As String\n\n'Do things...\n\n.FormFields(\"txtHRID\").Result = Me![ID]\n.FormFields(\"txtPeriod\").Result = Me![Period]\n\n'After writing to the form fields, add the long string of data\nIf doc.ProtectionType &lt;&gt; wdNoProtection Then\n   doc.Unprotect\nEnd If\n'Get the range of the form field, based on its name\nSet rng = doc.Bookmarks(\"txtReasonforReward\").Range\n'Move the starting point back one character so that the form field can be deleted. \nrng.MoveStart wdCharacter, -1\n'Be sure to save this character as the deletion will remove it\nx = rng.Characters.First\nrng.FormFields(1).Delete\n'Assign the value\nrng.Text = x &amp; Me![Reason for Reward]\n'Re-instate document protection\ndoc.Protect wdAllowOnlyFormFields, True\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 5083487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/351nC.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5083487/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 54673575, "answer_count": 1, "score": 0, "last_activity_date": 1550072191, "creation_date": 1550062839, "question_id": 54670845, "link": "https://stackoverflow.com/questions/54670845/how-to-get-around-the-character-limit-on-formfields-vba-passing-from-access-to-w", "title": "How to get around the character limit on FormFields VBA passing from Access to Word", "body": "<p>I'm attempting to pass the content of fields in an Access form to a Word document, which, using the below code, does exactly what I need it to, except for one small issue with one of the fields. </p>\n\n<pre><code>.FormFields(\"txtReasonforReward\").Result = Me![Reason for Reward]\n</code></pre>\n\n<p>is giving me some issues as I am hitting the character limit.</p>\n\n<p>I've seen several examples on how to circumvent this, but I'm not sure how they work within my base code. I'm feeling a little inadequate in my understanding of VBA at the moment so any clear idiot-proof advice would be appreciated.</p>\n\n<p>Please could someone give me a heads up on how to proceed.</p>\n\n<pre><code>Dim objWord As Object\nSet objWord = CreateObject(\"Word.Application\")\nobjWord.Visible = True\nSet doc = objWord.Documents.Open(***path to file***, , True)\nWith doc\n.FormFields(\"txtFirstName\").Result = Me![First Name]\n.FormFields(\"txtLastName\").Result = Me![Last Name]\n.FormFields(\"txtReasonforReward\").Result = Me![Reason for Reward]\n.FormFields(\"txtCompanyValue\").Result = Me![Company Value]\n.FormFields(\"txtRequestingManager\").Result = Me![Requesting Manager]\n.FormFields(\"txtLocation\").Result = Me![Location]\n.FormFields(\"txtJobTitle\").Result = Me![Job Title]\n.FormFields(\"txtReqMgrJobTitle\").Result = Me![Requesting Manager Job Title]\n.FormFields(\"txtMonetaryValue\").Result = Me![MoneyCalculated]\n.FormFields(\"txtDesc\").Result = Me![Description]\n.FormFields(\"txtPayroll\").Result = Me![Payroll Number]\n.FormFields(\"txtGrade\").Result = Me![Grade]\n.FormFields(\"txtLocation2\").Result = Me![Location]\n.FormFields(\"txtRequestingMgr\").Result = Me![Requesting Manager]\n.FormFields(\"txtLevelofAction\").Result = Me![ValueofPayment]\n.FormFields(\"txtGemNom\").Result = Me![GemNomination]\n.FormFields(\"txtHRID\").Result = Me![ID]\n.FormFields(\"txtPeriod\").Result = Me![Period]\n\n.Visible = True\n.Activate\n\nEnd With\n\nobjWord.View.ReadingLayout = True\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 57, "user_id": 10941795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2a5ffe6f90206f46deff084ac9160b?s=128&d=identicon&r=PG&f=1", "display_name": "Roxana", "link": "https://stackoverflow.com/users/10941795/roxana"}, "edited": false, "score": 0, "creation_date": 1550062584, "post_id": 54670551, "comment_id": 96131221, "body": "Thanks for the edit. Unfortunatly the code still does the same. I need it to be formatted as a table in order to visualize it with a pivot chart. I created the columns for the table already but the data is filled in below the table as I think VBA doesn&#39;t recognize the empty cells of the table as empty."}, {"owner": {"reputation": 415, "user_id": 6339516, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/piSbx.jpg?s=128&g=1", "display_name": "J.B.", "link": "https://stackoverflow.com/users/6339516/j-b"}, "edited": false, "score": 0, "creation_date": 1550062921, "post_id": 54670551, "comment_id": 96131452, "body": "I do not see the code for paste. Also not sure in which sheet you want to paste the rows."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 1, "creation_date": 1550062948, "post_id": 54670551, "comment_id": 96131473, "body": "Hi Anna. Edits on questions don&#39;t provide answers. I edited this to make the code more readable for the community."}, {"owner": {"reputation": 57, "user_id": 10941795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2a5ffe6f90206f46deff084ac9160b?s=128&d=identicon&r=PG&f=1", "display_name": "Roxana", "link": "https://stackoverflow.com/users/10941795/roxana"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1550063075, "post_id": 54670551, "comment_id": 96131543, "body": "@RyanWildry oh my bad, didn&#39;t know that"}, {"owner": {"reputation": 57, "user_id": 10941795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2a5ffe6f90206f46deff084ac9160b?s=128&d=identicon&r=PG&f=1", "display_name": "Roxana", "link": "https://stackoverflow.com/users/10941795/roxana"}, "reply_to_user": {"reputation": 415, "user_id": 6339516, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/piSbx.jpg?s=128&g=1", "display_name": "J.B.", "link": "https://stackoverflow.com/users/6339516/j-b"}, "edited": false, "score": 0, "creation_date": 1550063190, "post_id": 54670551, "comment_id": 96131619, "body": "@J.B.      ws.Range(&quot;A14:L26&quot;).Copy             Sheets(&quot;Pivot_Time&quot;).Cells(Rows.Count, &quot;K&quot;).End(xlUp).Offset (1)         This part copies and pastes the Range. The Range should be pasted in the worksheet &quot;Pivot_Time&quot;"}, {"owner": {"reputation": 57, "user_id": 10941795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2a5ffe6f90206f46deff084ac9160b?s=128&d=identicon&r=PG&f=1", "display_name": "Roxana", "link": "https://stackoverflow.com/users/10941795/roxana"}, "edited": false, "score": 0, "creation_date": 1550063260, "post_id": 54670551, "comment_id": 96131657, "body": "So far the code does what it should. My problem is just that the pasted cells are not formatted as tables and therefore can&#39;t be automatically visualized with a Pivotchart. What I want the code to do is add the cells to the table I created"}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1550063919, "post_id": 54670551, "comment_id": 96132091, "body": "As per my understanding the values pasted are going to be part of one big table, right?"}, {"owner": {"reputation": 57, "user_id": 10941795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2a5ffe6f90206f46deff084ac9160b?s=128&d=identicon&r=PG&f=1", "display_name": "Roxana", "link": "https://stackoverflow.com/users/10941795/roxana"}, "reply_to_user": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1550064017, "post_id": 54670551, "comment_id": 96132160, "body": "@Ricardo Diaz excactly! The values should be added to the already existing table."}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 1, "creation_date": 1550064355, "post_id": 54670551, "comment_id": 96132375, "body": "And the existing table is an structured Excel table? If it is, it isn\u2019t auto-expanding? <a href=\"https://support.office.com/en-us/article/overview-of-excel-tables-7ab0bb7d-3a9e-4b56-a3c9-6c94334e492c\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 57, "user_id": 10941795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2a5ffe6f90206f46deff084ac9160b?s=128&d=identicon&r=PG&f=1", "display_name": "Roxana", "link": "https://stackoverflow.com/users/10941795/roxana"}, "edited": false, "score": 0, "creation_date": 1550064585, "post_id": 54670551, "comment_id": 96132539, "body": "yes it is a structured Excel table. And the data is pasted below the last cell of the table instead of in the table. I think VBA doesn&#39;t recognize the cells of the table as empty cells and therefore pastes the data below, where they are not formatted as tables"}, {"owner": {"reputation": 57, "user_id": 10941795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2a5ffe6f90206f46deff084ac9160b?s=128&d=identicon&r=PG&f=1", "display_name": "Roxana", "link": "https://stackoverflow.com/users/10941795/roxana"}, "edited": false, "score": 0, "creation_date": 1550064740, "post_id": 54670551, "comment_id": 96132629, "body": "I have structured the head of the table in Range (K1:V1) but as I said the data is not pasted in the table"}, {"owner": {"reputation": 57, "user_id": 10941795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2a5ffe6f90206f46deff084ac9160b?s=128&d=identicon&r=PG&f=1", "display_name": "Roxana", "link": "https://stackoverflow.com/users/10941795/roxana"}, "edited": false, "score": 0, "creation_date": 1550066602, "post_id": 54670551, "comment_id": 96133819, "body": "Any ideas on how to change that would be great! Or how the imported cells can be automatically moved upwards to the range (K2:W2) , so they will be pasted over what VBA thinks are nonempty cells."}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1550072572, "post_id": 54670551, "comment_id": 96137728, "body": "Check the answer I provided and let me know if it helps. I refactored the code so it&#39;s easier to customize to fit your needs and prevents possible errors.."}], "answers": [{"tags": [], "owner": {"reputation": 415, "user_id": 6339516, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/piSbx.jpg?s=128&g=1", "display_name": "J.B.", "link": "https://stackoverflow.com/users/6339516/j-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1550063472, "creation_date": 1550063472, "answer_id": 54671017, "question_id": 54670551, "link": "https://stackoverflow.com/questions/54670551/copy-range-from-worksheets-to-master-worksheet-where-data-is-visualized/54671017#54671017", "title": "Copy Range from Worksheets to Master Worksheet where data is visualized", "body": "<p>I am not sure but still you can refresh the existing pivot table with new range by using following code:</p>\n\n<pre><code>   'Refresh Pivot table\n    LastRow = Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n    NewRange = \"Pivot_Time!A1:AL\" &amp; LastRow 'Set Range as per your requirement\n    Sheets(\"Pivot Sheet\").Select 'Set the sheet name where your pivot table is saved\n    Sheets(\"Pivot Sheet\").PivotTables(\"pivot table name\").ChangePivotCache ThisWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=NewRange)\n    ThisWorkbook.Worksheets(\"Pivot Sheet\").PivotTables(\"pivot table name\").RefreshTable\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1550072022, "creation_date": 1550072022, "answer_id": 54673871, "question_id": 54670551, "link": "https://stackoverflow.com/questions/54670551/copy-range-from-worksheets-to-master-worksheet-where-data-is-visualized/54673871#54673871", "title": "Copy Range from Worksheets to Master Worksheet where data is visualized", "body": "<p>Paste this code in a module and adapt the &lt;&lt;&lt;&lt; customize this >>>> section</p>\n\n<pre><code>Sub CopyRangeToPivotTable_Pivot_Time()\n\n    ' Declare objects variables\n    Dim sourceSheet As Worksheet\n    Dim destinationTable As ListObject\n\n    ' Declare other variables\n    Dim destinationSheetName As String\n    Dim destinationTableName As String\n    Dim sourceRangeAddress As String\n    Dim specialSheetsList() As Variant\n\n    ' &lt;&lt;&lt;&lt; Customize this &gt;&gt;&gt;&gt;\n    destinationSheetName = \"Pivot_Time\"\n    destinationTableName = \"Table1\"\n    sourceRangeAddress = \"A14:L26\"\n    specialSheetsList = Array(\"Pivot_Time\", \"Pivot_Expenses\", \"Pull &amp; Copy Data\")\n\n    ' Initialize destination table\n    Set destinationTable = ThisWorkbook.Worksheets(destinationSheetName).ListObjects(destinationTableName)\n\n    ' When using screenupdating you better add an error handler, cause you might end up with the screen not updating, restarting excel if the procedure fails, and possibly loosing data\n    Application.ScreenUpdating = False\n\n    For Each sourceSheet In ThisWorkbook.Worksheets ' if the macro is going to run in other workbooks, return to activeworkbook\n\n        If IsInArray(sourceSheet.Name, specialSheetsList) = False Then\n\n\n            ' Copy the range - no clipboard\n            destinationTable.DataBodyRange.Cells(destinationTable.DataBodyRange.Rows.Count, 1).Offset(1, 0).Resize(Range(sourceRangeAddress).Rows.Count, Range(sourceRangeAddress).Columns.Count).Value = sourceSheet.Range(sourceRangeAddress).Value\n\n            ' Resize the table to include the new data\n            destinationTable.Resize destinationTable.Range.CurrentRegion\n\n\n        End If\n\n    Next sourceSheet\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n\n' Credits: https://wellsr.com/vba/2016/excel/check-if-value-is-in-array-vba/\nPrivate Function IsInArray(valToBeFound As Variant, arr As Variant) As Boolean\n'DEVELOPER: Ryan Wells (wellsr.com)\n'DESCRIPTION: Function to check if a value is in an array of values\n'INPUT: Pass the function a value to search for and an array of values of any data type.\n'OUTPUT: True if is in array, false otherwise\nDim element As Variant\nOn Error GoTo IsInArrayError: 'array is empty\n    For Each element In arr\n        If element = valToBeFound Then\n            IsInArray = True\n            Exit Function\n        End If\n    Next element\nExit Function\nIsInArrayError:\nOn Error GoTo 0\nIsInArray = False\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 10941795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2a5ffe6f90206f46deff084ac9160b?s=128&d=identicon&r=PG&f=1", "display_name": "Roxana", "link": "https://stackoverflow.com/users/10941795/roxana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1550072022, "creation_date": 1550061974, "last_edit_date": 1550064710, "question_id": 54670551, "link": "https://stackoverflow.com/questions/54670551/copy-range-from-worksheets-to-master-worksheet-where-data-is-visualized", "title": "Copy Range from Worksheets to Master Worksheet where data is visualized", "body": "<p>I am trying to copy a certain range of data from all worksheets that don't have the name \"Pivot_Time\" or \"Pivot_Expenses\" or \"Pull &amp; Copy Data\" and paste it into the current worksheet.</p>\n\n<p>So far my code does what I want but since I want to visualize the data with a pivot chart the pasted data has to be formatted as a table. Unfortunately my code doesn't do that. Any ideas on how I can do that?</p>\n\n<p>Thanks in advance!</p>\n\n<p>This is the code I've tried:</p>\n\n<pre><code>Option Explicit\n\nSub CopyRangeToPivotTable_Pivot_Time()\n    Dim ws As Worksheet\n    Application.ScreenUpdating = False\n    For Each ws In ActiveWorkbook.Worksheets\n        If ws.Name &lt;&gt; \"Pivot_Time\" And ws.Name &lt;&gt; \"Pivot_Expenses\" _\n        And ws.Name &lt;&gt; \"Pull &amp; Copy Data\" Then\n            ws.Range(\"A14:L26\").Copy\n            Sheets(\"Pivot_Time\").Cells(Rows.Count, \"K\").End(xlUp).Offset (1)\n        End If\n    Next\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["mysql", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1744, "user_id": 10600584, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/319eb863cdc0db2dd90b533b742f8738?s=128&d=identicon&r=PG", "display_name": "FXD", "link": "https://stackoverflow.com/users/10600584/fxd"}, "is_accepted": true, "score": 0, "last_activity_date": 1550062315, "creation_date": 1550062315, "answer_id": 54670664, "question_id": 54670344, "link": "https://stackoverflow.com/questions/54670344/error-handling-in-excel-vba-connecting-to-remote-mysql/54670664#54670664", "title": "Error handling in Excel VBA connecting to remote MySQL", "body": "<p>You need to add a <code>On Error ...</code> and test on the next line if you are connected; if you aren't, then connect to your backup server. Finally, deactivate the error handling.</p>\n\n<pre><code>Dim Cn As ADODB.Connection\nSet Cn = New ADODB.Connection\n\nOn Error Resume Next\nCn.Open \"Driver={MySQL ODBC 5.3 ANSI Driver};Server=\" &amp; Server_Name &amp; \";PORT=\" &amp; Port &amp; \";Database=\" &amp; Database_Name &amp; \";Uid=\" &amp; User_ID &amp; \" ;Pwd=\" &amp; Password &amp; \";\"\n\nif Cn.State = 0 Then : _\n    Cn.Open ... 'Backup connection\n\nOn Error Goto 0\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11056430, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ARhgFb9LGEU/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM5zdeJlHNFPXZXKSzumoIKkc3jYg/mo/photo.jpg?sz=128", "display_name": "Andrea Capone", "link": "https://stackoverflow.com/users/11056430/andrea-capone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 54670664, "answer_count": 1, "score": 0, "last_activity_date": 1550062315, "creation_date": 1550061346, "question_id": 54670344, "link": "https://stackoverflow.com/questions/54670344/error-handling-in-excel-vba-connecting-to-remote-mysql", "title": "Error handling in Excel VBA connecting to remote MySQL", "body": "<p>I'm creating a macro to connect an excel sheet to a SQL server.\nThe excel file will be used both when I'm home and when I'm outside.\nNow everything is working adressing to my DNS www.server1.com.</p>\n\n<p>Now, if for some reason the server 1 is not working, I want to adress to the second backup server www.server2.com</p>\n\n<p>The problem is that I cannot handle the error.\nafter the \"Cn.Open ....\" if it cannot communicate with the server, the macro is stopped and I receive the excel error:\n\"Run-rime error: '-2147467259 (80004005)\"</p>\n\n<p>I want that instead of return this error, I can manually handle the error with something like that:\nIf Cn.Error Then\nServer_Name = \"www.server2.com\"\netc ...</p>\n\n<p>How can I do that?</p>\n\n<pre><code>Server_Name = \"www.server1.com\" ' Enter your server name here\nPort = \"3306\"\nDatabase_Name = \"mydb\" ' Enter your database name here\nUser_ID = \"myuserid\" ' enter your user ID here\nPassword = \"mypassword\" ' Enter your password here\n\nDim Cn As ADODB.Connection\nSet Cn = New ADODB.Connection\n\nCn.Open \"Driver={MySQL ODBC 5.3 ANSI Driver};Server=\" &amp; Server_Name &amp; \";PORT=\" &amp; Port &amp; \";Database=\" &amp; Database_Name &amp; \";Uid=\" &amp; User_ID &amp; \" ;Pwd=\" &amp; Password &amp; \";\"\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11056361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71270a064b30dc8c074d461eb515a0ae?s=128&d=identicon&r=PG&f=1", "display_name": "tnuesschen", "link": "https://stackoverflow.com/users/11056361/tnuesschen"}, "edited": false, "score": 0, "creation_date": 1550064602, "post_id": 54671025, "comment_id": 96132546, "body": "Unfortunately it results in Error 438&quot;Object Doesn&#39;t Support This Property or Method&quot;"}, {"owner": {"reputation": 3, "user_id": 11056361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71270a064b30dc8c074d461eb515a0ae?s=128&d=identicon&r=PG&f=1", "display_name": "tnuesschen", "link": "https://stackoverflow.com/users/11056361/tnuesschen"}, "edited": false, "score": 0, "creation_date": 1550065398, "post_id": 54671025, "comment_id": 96133031, "body": "Wow that works well! Thank you for the quick reply and answer to my question."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 3, "user_id": 11056361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71270a064b30dc8c074d461eb515a0ae?s=128&d=identicon&r=PG&f=1", "display_name": "tnuesschen", "link": "https://stackoverflow.com/users/11056361/tnuesschen"}, "edited": false, "score": 0, "creation_date": 1550065462, "post_id": 54671025, "comment_id": 96133078, "body": "@tnuesschen, If this has answered your question than please mark as such."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 0, "last_activity_date": 1550064999, "last_edit_date": 1550064999, "creation_date": 1550063513, "answer_id": 54671025, "question_id": 54670275, "link": "https://stackoverflow.com/questions/54670275/insert-excel-cell-text-in-word-after-bookmark-via-vba/54671025#54671025", "title": "Insert Excel cell text in Word after bookmark via VBA", "body": "<p>Would this work for you? (I can't take credit for the code):</p>\n\n<pre><code>Sub test()\n\nDim objWord As Object\nDim ws As Worksheet\n\nSet ws = ThisWorkbook.Sheets(1)\nSet objWord = CreateObject(\"Word.Application\")\nobjWord.Visible = True\nobjWord.Documents.Open \"C:\\test.docx\" ' change as required\nWith objWord.ActiveDocument\n    .Bookmarks(\"bookmark_1\").Range.Text = ws.Range(\"A1\").Value\nEnd With\nSet objWord = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11056361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71270a064b30dc8c074d461eb515a0ae?s=128&d=identicon&r=PG&f=1", "display_name": "tnuesschen", "link": "https://stackoverflow.com/users/11056361/tnuesschen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 766, "favorite_count": 0, "accepted_answer_id": 54671025, "answer_count": 1, "score": 0, "last_activity_date": 1550069001, "creation_date": 1550061119, "last_edit_date": 1550069001, "question_id": 54670275, "link": "https://stackoverflow.com/questions/54670275/insert-excel-cell-text-in-word-after-bookmark-via-vba", "title": "Insert Excel cell text in Word after bookmark via VBA", "body": "<p>Excel provides me a customized text in cell A1, which then should be passed on to a word letter at a specific section (after a bookmark).</p>\n\n<p>Just started with VBA and found+edited a code that was able to provide half of the solution. Where I struggle is <strong>how to insert the text in cell A1 in sheet OutputText to the word document after the bookmark?</strong> </p>\n\n<p>Here is my code so far:   </p>\n\n<pre><code>Function FnBookMarkInsertAfter()\n       Dim objWord\n       Dim objDoc\n       Dim objRange\n         Set objWord = CreateObject(\"Word.Application\")\n         Set objDoc = objWord.Documents.Open(\"C:\\Users\\[...]\")\n         objWord.Visible = True\n         Set objRange = objDoc.Bookmarks(\"bookmark_1\").Range\n         objRange.InsertAfter (\"Cell A1 from Sheet OutputText\")\n    End Function\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba", "web-scraping", "printing-web-page"], "answers": [{"comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 11, "user_id": 10968806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef965757f37f4440d59a165e731b8f51?s=128&d=identicon&r=PG&f=1", "display_name": "giagrifi", "link": "https://stackoverflow.com/users/10968806/giagrifi"}, "edited": false, "score": 0, "creation_date": 1550063124, "post_id": 54670488, "comment_id": 96131575, "body": "Great, if this helped have a look here. <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a> We like to mark questions as closed so we know your question has been answered."}, {"owner": {"reputation": 11, "user_id": 10968806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef965757f37f4440d59a165e731b8f51?s=128&d=identicon&r=PG&f=1", "display_name": "giagrifi", "link": "https://stackoverflow.com/users/10968806/giagrifi"}, "edited": false, "score": 0, "creation_date": 1550063635, "post_id": 54670488, "comment_id": 96131898, "body": "ACCEPTED   EDIT: please can you let me know how to integrate a proxy connection? When I run the code on my company&#39;s network I need to go through a proxy server &amp; port."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 11, "user_id": 10968806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef965757f37f4440d59a165e731b8f51?s=128&d=identicon&r=PG&f=1", "display_name": "giagrifi", "link": "https://stackoverflow.com/users/10968806/giagrifi"}, "edited": false, "score": 0, "creation_date": 1550063776, "post_id": 54670488, "comment_id": 96131995, "body": "@giagrifi, this sounds like a new question. On stackoverflow we generally limit a single question to a post. Feel free to make a new question."}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": true, "score": 0, "last_activity_date": 1550061767, "creation_date": 1550061767, "answer_id": 54670488, "question_id": 54670251, "link": "https://stackoverflow.com/questions/54670251/copy-web-page-content-to-a-string/54670488#54670488", "title": "Copy web-page content to a string", "body": "<p>Yes there is a method to do this without using Internet Explorer, you can use a web request.</p>\n\n<p>Here is a sample method. Basically, you are emulating the communication that would normally take place between a browser and server.</p>\n\n<pre><code>Option Explicit\n\nPublic Function getPageText(url As String)\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", url\n        .send\n        getPageText = .responseText\n    End With\nEnd Function\n\nSub Example()\n    Dim url As String: url = \"http://re.jrc.ec.europa.eu/pvgis5/PVcalc.php?lat=45&amp;lon=8&amp;peakpower=1&amp;loss=14&amp;optimalangles=1&amp;outputformat=basic\"\n    Debug.Print getPageText(url)\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 10968806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef965757f37f4440d59a165e731b8f51?s=128&d=identicon&r=PG&f=1", "display_name": "giagrifi", "link": "https://stackoverflow.com/users/10968806/giagrifi"}, "edited": false, "score": 0, "creation_date": 1550398182, "post_id": 54672462, "comment_id": 96246981, "body": "Hi there, thanks for your answer! In my case I do care create the object every time, I create it and the loop, asking multiple queries and always obtaining a short text back. As such, the first solution proposed by Ryan works fine (apart from the proxy access, which I haven\u2019t figured out yet...). I would like to stress that is necessary to have a synchronous query, otherwise the"}, {"owner": {"reputation": 11, "user_id": 10968806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef965757f37f4440d59a165e731b8f51?s=128&d=identicon&r=PG&f=1", "display_name": "giagrifi", "link": "https://stackoverflow.com/users/10968806/giagrifi"}, "edited": false, "score": 0, "creation_date": 1550398634, "post_id": 54672462, "comment_id": 96247091, "body": "... otherwise you get an error when trying to pull the answer since it\u2019s not ready yet. That is ahieved with the \u201cFalse\u201d in the .Open method, missing in the answer from Ryan and causing me a couple of headaches."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11, "user_id": 10968806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef965757f37f4440d59a165e731b8f51?s=128&d=identicon&r=PG&f=1", "display_name": "giagrifi", "link": "https://stackoverflow.com/users/10968806/giagrifi"}, "edited": false, "score": 0, "creation_date": 1550399046, "post_id": 54672462, "comment_id": 96247173, "body": "I included False in my answer for that reason. You do not need to create each time in a loop, it is inefficient. That is the problem with the other answer as well. You only need to create it once and hold a reference to that object whilst you loop your request urls. Using a function in that manner is not good coding practice for large numbers of requests in particular."}, {"owner": {"reputation": 11, "user_id": 10968806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef965757f37f4440d59a165e731b8f51?s=128&d=identicon&r=PG&f=1", "display_name": "giagrifi", "link": "https://stackoverflow.com/users/10968806/giagrifi"}, "edited": false, "score": 0, "creation_date": 1550404831, "post_id": 54672462, "comment_id": 96248471, "body": "I create the object once only, outside the loop. And then loop... to give an idea of how long does it take, i looped 16471 times on a hotel (slow) wifi and only added a string manipulation and save in a worksheet cell, it took about 38 minutes - more than two thirds of it I estimate is due to the website response time, not much I can do about that, other than have them to agree releasing their code so ai can include it in mine"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11, "user_id": 10968806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef965757f37f4440d59a165e731b8f51?s=128&d=identicon&r=PG&f=1", "display_name": "giagrifi", "link": "https://stackoverflow.com/users/10968806/giagrifi"}, "edited": false, "score": 0, "creation_date": 1550404906, "post_id": 54672462, "comment_id": 96248491, "body": "So you are not using the function as shown in the other answers?"}, {"owner": {"reputation": 11, "user_id": 10968806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef965757f37f4440d59a165e731b8f51?s=128&d=identicon&r=PG&f=1", "display_name": "giagrifi", "link": "https://stackoverflow.com/users/10968806/giagrifi"}, "edited": false, "score": 0, "creation_date": 1550490805, "post_id": 54672462, "comment_id": 96275222, "body": "No, I create the object outside the loop and then use Ryan\u2019s solution in the loop with synchronous access to the webpage. No need If a separate function to open and get the page content."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1550068334, "last_edit_date": 1550068334, "creation_date": 1550067785, "answer_id": 54672462, "question_id": 54670251, "link": "https://stackoverflow.com/questions/54670251/copy-web-page-content-to-a-string/54672462#54672462", "title": "Copy web-page content to a string", "body": "<p>With this number of requests it would be better to use a class to hold the xmlhttp object rather than using a function (where you create and destroy the object each time). Then run a sub that passes all the urls to that object. Provide the class with a method to return the string.</p>\n\n<p>Class module: <code>clsHTTP</code></p>\n\n<pre><code>Option Explicit  \nPrivate http As Object\n\nPrivate Sub Class_Initialize()\n    Set http = CreateObject(\"MSXML2.XMLHTTP\")\nEnd Sub\n\nPublic Function GetString(ByVal url As String) As String\n    Dim sResponse As String\n    With http\n        .Open \"GET\", url, False\n        .send\n        GetString = .responseText\n    End With\nEnd Function\n</code></pre>\n\n<p>Standard module 1:</p>\n\n<pre><code>Option Explicit \nPublic Sub GetStrings()\n    Dim urls, ws As Worksheet, i As Long, http As clsHTTP\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set http = New clsHTTP\n    'read in from sheet the urls\n    urls = Application.Transpose(ws.Range(\"A1:A2\").Value) 'Alter range to get all urls\n    Application.ScreenUpdating = False\n    For i = LBound(urls) To UBound(urls)\n        ws.Cells(i, 2) = http.GetString(urls(i))\n    Next\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1559809871, "last_edit_date": 1559809871, "creation_date": 1550298816, "answer_id": 54720520, "question_id": 54670251, "link": "https://stackoverflow.com/questions/54670251/copy-web-page-content-to-a-string/54720520#54720520", "title": "Copy web-page content to a string", "body": "<p>I use the function variations below <strong><em>constantly</em></strong> for things like extracting html from a web page, or JSON results from querying an API, and so much more.</p>\n\n<hr>\n\n<h1>Late-Bound Version</h1>\n\n<p>This \"stand-alone\" version <strong>requires no references</strong>:</p>\n\n<pre><code>Public Function getHTTP(ByVal url As String) As String\n'returns HTML from URL (works on *almost* any URL you throw at it)\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", url, False\n        .Send\n        getHTTP = StrConv(.responseBody, vbUnicode)\n    End With\nEnd Function\n</code></pre>\n\n<hr>\n\n<h1>Early-Bound Version</h1>\n\n<p>If you're going to be hitting several sites, it's more efficient (<strong>up to twice as fast</strong>  and much easier on system resources) to use this version instead.  You'll need to add a reference to MS XML library (<kbd>Tools</kbd> \u2192 <kbd>References</kbd> \u2192 <code>Microsoft XML, v6.0</code>). </p>\n\n<pre><code>Public Function getHTTP(ByVal url As String) As String  \n'Returns HTML from a URL, early bound (requires reference to MS XML6)\n    Dim msXML As New XMLHTTP60\n    With msXML\n        .Open \"GET\", url, False\n        .Send\n        getHTTP = StrConv(.responseBody, vbUnicode)\n    End With\n    Set msXML = Nothing\nEnd Function\n</code></pre>\n\n<hr>\n\n<h2><em>Returning Only Text</em></h2>\n\n<p>When using the functions above to call a web page, they will return the raw HTML source code. You can <strong>strip the HTML tags</strong> and be left with only the a e \"plain text\" version of the pagewith this nifty function from <a href=\"https://stackoverflow.com/a/5334547/8112776\">Tim Williams</a>:</p>\n\n<pre><code>Function HtmlToText(sHTML) As String\n'requires reference: Tools \u2192 References \u2192 \"Microsoft HTML Object Library\"\n    Dim oDoc As HTMLDocument\n    Set oDoc = New HTMLDocument\n    oDoc.body.innerHTML = sHTML\n    HtmlToText = oDoc.body.innerText\nEnd Function\n</code></pre>\n\n<hr>\n\n<h1>Example:</h1>\n\n<p>Putting it together, the example below returns the plain text of \"this\" web page.</p>\n\n<pre><code>Option Explicit\n'requires reference: Tools &gt; References &gt; \"Microsoft HTML Object Library\"\n\nFunction HtmlToText(sHTML) As String\n    Dim oDoc As HTMLDocument\n    Set oDoc = New HTMLDocument\n    oDoc.body.innerHTML = sHTML\n    HtmlToText = oDoc.body.innerText\nEnd Function\n\nPublic Function getHTTP(ByVal url As String) As String\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", url, False\n        .Send\n        getHTTP = StrConv(.responseBody, vbUnicode)\n    End With\nEnd Function\n\nSub Demo()\n    Const url = \"https://stackoverflow.com/questions/54670251\"\n    Dim html As String, txt As String\n\n    html = getHTTP(url)\n    txt = HtmlToText(html)\n\n    Debug.Print txt &amp; vbLf  'Hit CTRL+G to view output in Immediate Window\n    Debug.Print \"HTML source = \" &amp; Len(html) &amp; \" bytes\"\n    Debug.Print \"Plain Text  = \" &amp; Len(txt) &amp; \" bytes\"\nEnd Sub\n</code></pre>\n\n<hr>\n\n<h2>More Information:</h2>\n\n<ul>\n<li><p>Coding is Love : <a href=\"https://codingislove.com/http-requests-excel-vba/\" rel=\"nofollow noreferrer\"><strong>XmlHttpRequest \u2013 Http requests in Excel VBA</strong></a>    </p></li>\n<li><p>Coding is Love : <a href=\"https://codingislove.com/parse-html-in-excel-vba/\" rel=\"nofollow noreferrer\"><strong>Parse HTML in Excel VBA</strong></a>  </p></li>\n<li><p>Coding is Love : <a href=\"https://codingislove.com/excel-json/\" rel=\"nofollow noreferrer\"><strong>Import Json \u21c4 Excel</strong></a> (Uses <a href=\"https://github.com/VBA-tools/VBA-JSON/blob/master/README.md\" rel=\"nofollow noreferrer\"><code>VBA-JSON</code></a>)  </p></li>\n<li><p>Microsoft Docs : <strong><a href=\"http://msdn.microsoft.com/library/aa140042(office.10).aspx\" rel=\"nofollow noreferrer\">Microsoft HTML Object Library</strong></a> </p></li>\n<li><p>Microsoft Docs : <a href=\"https://docs.microsoft.com/previous-versions/windows/internet-explorer/ie-developer/\" rel=\"nofollow noreferrer\"><strong>Internet Explorer for Developers</strong></a>   </p></li>\n<li><p>Microsoft Docs : <a href=\"https://docs.microsoft.com/previous-versions/windows/desktop/ms757849(v%3Dvs.85)\" rel=\"nofollow noreferrer\"><strong><code>open</code> Method (IXMLHTTPRequest)</strong></a>  </p></li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 10968806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef965757f37f4440d59a165e731b8f51?s=128&d=identicon&r=PG&f=1", "display_name": "giagrifi", "link": "https://stackoverflow.com/users/10968806/giagrifi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1412, "favorite_count": 1, "accepted_answer_id": 54670488, "answer_count": 3, "score": -2, "last_activity_date": 1574344527, "creation_date": 1550061036, "last_edit_date": 1574344527, "question_id": 54670251, "link": "https://stackoverflow.com/questions/54670251/copy-web-page-content-to-a-string", "title": "Copy web-page content to a string", "body": "<p>I need to access web-pages and copy their content (everything) into a string which I will then extract some figures from.</p>\n\n<p>The web-page address changes each time, as I am basically accessing an online simulation tool and I have to specify the sim parameters each time. And the output is always a string of about 320 characters. the web page consists ONLY in that text.</p>\n\n<p>Example of web address / query:</p>\n\n<p><strong><a href=\"http://re.jrc.ec.europa.eu/pvgis5/PVcalc.php?lat=45&amp;lon=8&amp;peakpower=1&amp;loss=14&amp;optimalangles=1&amp;outputformat=basic\" rel=\"nofollow noreferrer\">http://re.jrc.ec.europa.eu/pvgis5/PVcalc.php?lat=45&amp;lon=8&amp;peakpower=1&amp;loss=14&amp;optimalangles=1&amp;outputformat=basic</a></strong></p>\n\n<p>Example of web-page content (string to retrieve):\n<strong>37 0 1 54.9 72.1 7.21 2 73.1 96.0 12.0 3 114 149 15.5 4 121 160 17.9 5 140 185 11.3 6 142 188 9.31 7 161 212 10.2 8 149 197 10.0 9 123 162 10.3 10 83.0 109 15.5 11 55.8 73.3 13.5 12 55.8 73.2 9.47 Year 1270 1680 58.8 AOI loss: 2.7% Spectral effects: - Temperature and low irradiance loss: 8.0% Combined losses: 24.1%</strong></p>\n\n<p><strong><em>Question to you</em></strong></p>\n\n<p>Is there a method to copy that string without having to open and close a browser each time? I have to repeat that operation (determine the query parameters, retrieve the relative string, extract the values that I need from the string) a total of <strong>7200 times</strong> when I run my analysis and I'd like it to be as smooth and as fast as possible.</p>\n\n<p><strong>Note:</strong> I don't necessary need to save the string text on a document but it would be OK to do so if needed, and then open the file and retrieve my string. But that sounds so inefficient that I'm sure there must be a better way of doing it!</p>\n"}, {"tags": ["excel", "vba", "for-loop", "if-statement"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11053804"}, "is_accepted": false, "score": 1, "last_activity_date": 1550062019, "creation_date": 1550062019, "answer_id": 54670560, "question_id": 54670248, "link": "https://stackoverflow.com/questions/54670248/sum-values-in-the-range-based-on-if-condition-and-for-each-loop/54670560#54670560", "title": "Sum values in the range based on if condition and for each loop", "body": "<p>There are built-in functions that can help you.</p>\n\n<pre><code>sub test()\n\n    Dim ws1 As Worksheet\n\n    Set ws1 = ThisWorkbook.Sheets(\"Sheet3\")\n\n    With ws1\n        with .range(.cells(3, \"A\"), .cells(.rows.count, \"C\").end(xlup).offset(0, 1))\n            .columns(4).cells.formular1c1 = \"=if(rc[-2]&gt;0, sumifs(c[-1], c[-3], rc[-3]), rc[-1])\"\n            .columns(3).cells = .columns(4).cells.value\n            .columns(4).cells.clear\n        end with\n    end with\n\nend sub\n</code></pre>\n\n<p>BTW, your range objects were being set all the way down to the bottom of the worksheet. You were missing the <code>.end(xlup)</code> at the end.</p>\n"}], "owner": {"reputation": 145, "user_id": 8799840, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5614405d8d36388f027f25c83c4d78f4?s=128&d=identicon&r=PG&f=1", "display_name": "Dozens", "link": "https://stackoverflow.com/users/8799840/dozens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553695920, "creation_date": 1550061017, "last_edit_date": 1553695920, "question_id": 54670248, "link": "https://stackoverflow.com/questions/54670248/sum-values-in-the-range-based-on-if-condition-and-for-each-loop", "title": "Sum values in the range based on if condition and for each loop", "body": "<p>I have 3 columns of data (I present a subset for ease of understanding). The first column shows label number, 2nd column the quanatities along label number, and 3rd the price.</p>\n\n<p>I want to sum the price in for labels in columns 3 but only if Quantity in column 2 is >= 1, otherwise do nothing. </p>\n\n<p>Data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/OUs2L.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OUs2L.png\" alt=\"enter image description here\"></a></p>\n\n<p>Desired outcome:</p>\n\n<p><a href=\"https://i.stack.imgur.com/HBkCY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HBkCY.png\" alt=\"enter image description here\"></a></p>\n\n<p>In the outcome, the Price in 3rd column is summed out of all values for Label1 and assigned to each label If Quantity in column 2 is >=1. For all the others, the price does not change because quantity is 0.</p>\n\n<p>I am getting the mismatch for the ranges used. I am not sure if I should use arrays:</p>\n\n<pre><code>Sub test()\n\nDim cell As Range\nDim cell2 As Range\nDim rngLabel As Range\nDim rngQuantity As Range\nDim rngAmount As Range\n\nDim ws1 As Worksheet\n\nSet ws1 = ThisWorkbook.Sheets(\"Sheet3\")\n\nWith ws1\n\n    Set rngLabel = .Range(.Cells(3, 1), .Cells(.Rows.Count, 1))\n    Set rngQuantity = .Range(.Cells(3, 2), .Cells(.Rows.Count, 2))\n    Set rngAmount = .Range(.Cells(3, 3), .Cells(.Rows.Count, 3))\n\n    For Each cell In rngLabel.Cells\n        For Each cell2 In rngAmount.Cells\n            If rngQuantity.Value &gt;= 1 Then\n            cell = WorksheetFunction.Sum(rngAmount)\n            End If\n        Next cell2\n    Next cell\n\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "split", "userform"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 10977740, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YeeSxbW5K4M/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOCanHLPKup64monLqGYtYxGGd5Bg/mo/photo.jpg?sz=128", "display_name": "Bonnie Z", "link": "https://stackoverflow.com/users/10977740/bonnie-z"}, "edited": false, "score": 0, "creation_date": 1550063238, "post_id": 54670535, "comment_id": 96131643, "body": "awesome, I&#39;ll try that and let you know how it works."}], "tags": [], "owner": {"reputation": 16, "user_id": 11056506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/789409125f7b20e37f832c3808fea303?s=128&d=identicon&r=PG", "display_name": "Ulrich", "link": "https://stackoverflow.com/users/11056506/ulrich"}, "is_accepted": true, "score": 0, "last_activity_date": 1550063774, "last_edit_date": 1550063774, "creation_date": 1550061937, "answer_id": 54670535, "question_id": 54669915, "link": "https://stackoverflow.com/questions/54669915/use-split-function-to-seperate-a-list-of-numbers-from-a-userform/54670535#54670535", "title": "use SPLIT function to seperate a list of numbers from a userform", "body": "<p>Try this:</p>\n\n<pre><code>myString = ...\ndata = split(myString, vbcrlf)\nworkbooks(\"workbookA\").worksheets(1).range(\"A2\").resize(ubound(data)+1,1).value = application.transpose(data)\n</code></pre>\n\n<p><strong>myString</strong> is the String with your data. </p>\n\n<p>In VBA you have the constants <code>vbLf</code>, <code>vbCr</code>, <code>vbCrLf</code> for linefeed, carriage return and linefeed + carriage return (<a href=\"https://en.wikipedia.org/wiki/Newline\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Newline</a>), which represent the characters.</p>\n"}], "owner": {"reputation": 39, "user_id": 10977740, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YeeSxbW5K4M/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOCanHLPKup64monLqGYtYxGGd5Bg/mo/photo.jpg?sz=128", "display_name": "Bonnie Z", "link": "https://stackoverflow.com/users/10977740/bonnie-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 54670535, "answer_count": 1, "score": 0, "last_activity_date": 1550064679, "creation_date": 1550059891, "last_edit_date": 1550064679, "question_id": 54669915, "link": "https://stackoverflow.com/questions/54669915/use-split-function-to-seperate-a-list-of-numbers-from-a-userform", "title": "use SPLIT function to seperate a list of numbers from a userform", "body": "<p>I have a userform that has a list of numbers entered in column style with no separator other than being on a separate line.  Entry into the user form will look something like this:</p>\n\n<pre><code>2172223333\n2172223334\n2172223335\n2172223336\n2172223337\n</code></pre>\n\n<p>How do I use the SPLIT function to separate this bulk entry into the user form into separate cells in the same column on a spreadsheet?  I'm familiar with how it works if there is a comma or space to look for between the terms but will it somehow recognize a separate line as a delineator and if so, what symbol do I use to represent that in the code?</p>\n\n<p>I want to be able to read this input and have it entered in a workbook, say (\"workbookA\") and sheets(1) and put it in Column A starting at row 2 and going downward staying in column A.</p>\n"}, {"tags": ["vba", "dialog", "userform", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11056315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c443834bff2f018aaf6f7e69f263a3f4?s=128&d=identicon&r=PG&f=1", "display_name": "J.S.", "link": "https://stackoverflow.com/users/11056315/j-s"}, "edited": false, "score": 0, "creation_date": 1550067496, "post_id": 54671213, "comment_id": 96134350, "body": "Thank you very much :) Such a simple answer just shows I clearly lack the basics. Thank you once again and a good day to you Brian."}], "tags": [], "owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "is_accepted": true, "score": 0, "last_activity_date": 1550064000, "creation_date": 1550064000, "answer_id": 54671213, "question_id": 54669913, "link": "https://stackoverflow.com/questions/54669913/vba-multiple-option-dialog-box-output/54671213#54671213", "title": "VBA multiple option dialog box output", "body": "<p>The issue is that you are unloading the UserForm, meaning the controls are not available to you.  The solution is to just hide the UserForm:</p>\n\n<pre><code>Private Sub OptionButton1_Click()\n    Hide\nEnd Sub\n\nPrivate Sub OptionButton2_Click()\n    Hide\nEnd Sub\n\nPrivate Sub OptionButton3_Click()\n    Hide\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11056315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c443834bff2f018aaf6f7e69f263a3f4?s=128&d=identicon&r=PG&f=1", "display_name": "J.S.", "link": "https://stackoverflow.com/users/11056315/j-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 1, "accepted_answer_id": 54671213, "answer_count": 1, "score": 0, "last_activity_date": 1550064000, "creation_date": 1550059888, "last_edit_date": 1550060030, "question_id": 54669913, "link": "https://stackoverflow.com/questions/54669913/vba-multiple-option-dialog-box-output", "title": "VBA multiple option dialog box output", "body": "<p>I created a user form with multiple options and now I want that the option the user selects is shown in a label under the button that calls the user form.<a href=\"https://i.stack.imgur.com/8kOQD.png\" rel=\"nofollow noreferrer\">I changed the caption in the text box under the button to resemble what should happen</a></p>\n\n<p>However my options aren't working. Should I save the output in a global variable and then call it back to change the label and if so how do I do that? Or is it possible to just call the selection within the user form?</p>\n\n<p>The code I was trying to run was this one to call the message box and then change the text box which is actually a label called \"labelpage\"</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nUserForm1.Show\nIf UserForm1.OptionButton1 = True Then LabelPage.Caption = \"Company Restricted\"\nIf UserForm1.OptionButton2 = True Then LabelPage.Caption = \"Strictly Confidential\"\nIf UserForm1.OptionButton2 = True Then LabelPage.Caption = \"Public Information (does not need to be marked)\"\n\nEnd Sub\n</code></pre>\n\n<p>I also had this for each button click just to close them after selection, within the user form code.</p>\n\n<pre><code>Private Sub OptionButton1_Click()\n    OptionButton1.Value = True\n    Unload Me\nEnd Sub\n\nPrivate Sub OptionButton2_Click()\n    OptionButton2.Value = True\n    Unload Me\nEnd Sub\n\nPrivate Sub OptionButton3_Click()\n    OptionButton3.Value = True\n    Unload Me\nEnd Sub\n</code></pre>\n\n<p>Is there just a tiny mistake of syntax or something like that or is this just completely wrong? Thank you in advance for your help.</p>\n"}, {"tags": ["python", "excel", "vba", "pythoncom"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1550059798, "post_id": 54669716, "comment_id": 96129638, "body": "I have added Python tags."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1550075388, "post_id": 54669716, "comment_id": 96139479, "body": "Could you not have workbook import a module when it opens instead of trying to add it through <code>python</code>?"}, {"owner": {"reputation": 11, "user_id": 6695456, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9zrauI_E86s/AAAAAAAAAAI/AAAAAAAAQP0/2xKpbkjOrFA/photo.jpg?sz=128", "display_name": "bozo", "link": "https://stackoverflow.com/users/6695456/bozo"}, "edited": false, "score": 0, "creation_date": 1550130931, "post_id": 54669716, "comment_id": 96159284, "body": "Zac , could you elaborate, please?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6695456, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9zrauI_E86s/AAAAAAAAAAI/AAAAAAAAQP0/2xKpbkjOrFA/photo.jpg?sz=128", "display_name": "bozo", "link": "https://stackoverflow.com/users/6695456/bozo"}, "edited": false, "score": 0, "creation_date": 1550061270, "post_id": 54669921, "comment_id": 96130449, "body": "Thank you for input! Unfortunately it keeps crashing with xlsm file. I even added some code via editor to ensure that codemodule exists - still no luck."}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 0, "last_activity_date": 1550059907, "creation_date": 1550059907, "answer_id": 54669921, "question_id": 54669716, "link": "https://stackoverflow.com/questions/54669716/excel-vba-crashes-wihile-accessing-codemodule/54669921#54669921", "title": "(Excel) VBA Crashes wihile accessing CodeModule", "body": "<p>The file is an xlsx so it won't have a VBProject.  Admittedly, it ought to throw an error instead of crashing.  You need a file type of xlsm.</p>\n"}], "owner": {"reputation": 11, "user_id": 6695456, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9zrauI_E86s/AAAAAAAAAAI/AAAAAAAAQP0/2xKpbkjOrFA/photo.jpg?sz=128", "display_name": "bozo", "link": "https://stackoverflow.com/users/6695456/bozo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 243, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1550061762, "creation_date": 1550059230, "last_edit_date": 1550061762, "question_id": 54669716, "link": "https://stackoverflow.com/questions/54669716/excel-vba-crashes-wihile-accessing-codemodule", "title": "(Excel) VBA Crashes wihile accessing CodeModule", "body": "<p>I'm trying to insert some code to VBA codemodule and excel crashes while reading CodeModule property. Here's an example code in python:</p>\n\n<pre><code>excel = win32com.client.Dispatch(\"Excel.Application\")\nexcel.Visible = False\nworkbook = excel.Workbooks.Open(\"C:\\\\test\\\\test1.xlsx\")\nexcel.VBE.MainWindow.Visible = False\nsheet = workbook.Worksheets(1) \nvbp = workbook.VBProject\ncomp = vbp.VBComponents(workbook.CodeName)\ncm = comp.CodeModule   #     &lt;--------------- !!! Excel crashes here\ncurLine = cm.CreateEventProc(\"Open\", \"Workbook\")\ncm.InsertLines(curLine + 1, \"some text\")\n</code></pre>\n\n<p>Faulting application name: EXCEL.EXE, version: 16.0.11231.20174, timestamp: 0x5c5e3867</p>\n\n<p>Faulting module name: combase.dll, version: 10.0.14393.2791, timestamp: 0x5c5a43d3</p>\n\n<p>Exception code: 0xc0000005</p>\n\n<p>OS: Windows Server 2016 Standard, up to date</p>\n\n<p>This is not a pywin32 specific problem, I've tested this. Also I've tried x86 and x64 office versions, both are crashing. What's interesting is that excel com object remains alive and I am still to able to manipulate it and save the file. But VBProject is empty.</p>\n\n<p>Any ideas where to dig?</p>\n"}, {"tags": ["excel", "vba", "pivot", "pivot-table"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 2, "creation_date": 1550058776, "post_id": 54669135, "comment_id": 96129006, "body": "Using <code>ActiveSheet</code> is a bad idea. This is because at any given point, <code>ActiveSheet</code> could not be the sheet you want to reference. Try qualifying your sheet (i.e. <code>With ThisWorkbook.Worksheet(&quot;Sheet1&quot;)</code>). Also, if you want to refresh all pivot tables on a sheet, I would just iterate through the pivot table on the sheet. This way if you ever change the names of pivot tables, your <code>Refresh</code> will still work"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1550059782, "post_id": 54669135, "comment_id": 96129627, "body": "Do you get the same issue when using <code>PivotTable.PivotCache.Refresh</code> instead of <code>PivotTable.RefreshTable</code>?  Do the Values you have filtered on still exist?  What are the states of the &quot;Include new items in manual filter&quot; and &quot;Show items with no data&quot; settings in the PivotField?"}, {"owner": {"reputation": 103, "user_id": 10265592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f8420e6695c8dadf0a29bd59cde88ee?s=128&d=identicon&r=PG&f=1", "display_name": "n4pster", "link": "https://stackoverflow.com/users/10265592/n4pster"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1550062458, "post_id": 54669135, "comment_id": 96131153, "body": "@Zac Roger that I changed that! @Chronocidal Thanks for your response! I tried <code>PivotTable.PivotCache.Refresh</code> and the problem persists unfortunately. The values I filter still exist. BOTH &quot;Include New items in manual filter&quot; and &quot;show items with no data&quot; are NOT checked. Any ideas? thanks again!!"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1550063625, "post_id": 54669135, "comment_id": 96131886, "body": "Can you post your updated code?"}, {"owner": {"reputation": 103, "user_id": 10265592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f8420e6695c8dadf0a29bd59cde88ee?s=128&d=identicon&r=PG&f=1", "display_name": "n4pster", "link": "https://stackoverflow.com/users/10265592/n4pster"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1550071876, "post_id": 54669135, "comment_id": 96137307, "body": "@Zac updated code posted! Yet the issue is still there. The pivot table do not update correctly?"}], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 1, "last_activity_date": 1550059501, "creation_date": 1550059501, "answer_id": 54669800, "question_id": 54669135, "link": "https://stackoverflow.com/questions/54669135/use-vba-to-refresh-pivot-tables/54669800#54669800", "title": "Use VBA to refresh pivot tables", "body": "<p>Do not use ActiveSheet. In my opinion is better to use create a with statement refers to the sheet you want and use refresh all instead of one by one.</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        .RefreshAll\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "is_accepted": false, "score": 1, "last_activity_date": 1550074890, "creation_date": 1550074890, "answer_id": 54674876, "question_id": 54669135, "link": "https://stackoverflow.com/questions/54669135/use-vba-to-refresh-pivot-tables/54674876#54674876", "title": "Use VBA to refresh pivot tables", "body": "<p>This is a nice way to loop through all worksheets and refresh all pivot tables:</p>\n\n<pre><code>Dim ws As Worksheet\nDim pt As PivotTable\n\nFor Each ws In wb.Sheets\n  For Each pt In ws.PivotTables\n    pt.PivotCache.Refresh\n  Next pt\nNext ws\n</code></pre>\n\n<p>Of course, you can easily impose limits if you want to exclude any worksheets or pivot tables.  The nice thing about this is not only does it do all tables in blocks (by sheet), but if tables are added, removed or renamed, it doesn't crash when looking for specific tables.</p>\n"}], "owner": {"reputation": 103, "user_id": 10265592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f8420e6695c8dadf0a29bd59cde88ee?s=128&d=identicon&r=PG&f=1", "display_name": "n4pster", "link": "https://stackoverflow.com/users/10265592/n4pster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1118, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1550074890, "creation_date": 1550057414, "last_edit_date": 1550071768, "question_id": 54669135, "link": "https://stackoverflow.com/questions/54669135/use-vba-to-refresh-pivot-tables", "title": "Use VBA to refresh pivot tables", "body": "<p>I am working on a project, where I dump data on a monthly basis in Sheet1. In my sheet analysis, I have three pivot tables summarizing this data using certain filter, which should remain unchanged even if the raw data changes. </p>\n\n<p>I use the following VBA code to update the pivot tables after the data dump.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n\nWith ThisWorkbook.Worksheets(\"Analysis\")\n\n.PivotTables(\"PivotTable1\").RefreshTable\n.PivotTables(\"PivotTable2\").RefreshTable\n\nEnd With\n\nSheets(\"Output\").Activate\n\nEnd Sub\n</code></pre>\n\n<p>The problem is, whenever I have a new data dump in Sheet 1 and then run the code, I get the following message: <em>There is already data in [Dokument1]Analysis. Do you want to replace it?</em> After this the output from the pivot tables is wrong and the supposedly static pivot filters are no longer there. </p>\n\n<p>I made sure that there is more than enough space between the pivot tables and there cannot be any overlaps. I have had this problem for a long time and do not know how to solve it, so any help is appreciated.</p>\n"}, {"tags": ["excel", "vba", "http", "web-scraping"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1550059181, "post_id": 54669059, "comment_id": 96129256, "body": "What is the error message? On which specific line? (Please don&#39;t refer to line numbers)"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 3529237, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000169137351/picture?type=large", "display_name": "user3529237", "link": "https://stackoverflow.com/users/3529237/user3529237"}, "edited": false, "score": 0, "creation_date": 1550083381, "post_id": 54669756, "comment_id": 96143719, "body": "thanks for reply, but the code is able to get value of attribute like name, values, id etc.. I am not able to grab Text values falling under class. for example (in above given HTML Code) what I am trying to grab is something like.                                                             APOLLOTYRE, NSE, 163, bullish, EQ, 0.00, 201.00, 0.00, 199.50, 1990, 199.20, ......... Etc. will it be possible to grab every stock data as it is falling under <b>class</b>."}, {"owner": {"reputation": 15, "user_id": 3529237, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000169137351/picture?type=large", "display_name": "user3529237", "link": "https://stackoverflow.com/users/3529237/user3529237"}, "edited": false, "score": 1, "creation_date": 1550087321, "post_id": 54669756, "comment_id": 96145535, "body": "Thanks a lot QHarr..!! I think This is what exactly I required... thanks once again..!!"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1550087394, "last_edit_date": 1550087394, "creation_date": 1550059369, "answer_id": 54669756, "question_id": 54669059, "link": "https://stackoverflow.com/questions/54669059/how-to-get-values-from-http-response-to-excel-with-vba-code/54669756#54669756", "title": "how to get values from HTTP Response to Excel with VBA Code", "body": "<p>You can use css selectors to target the td elements</p>\n\n<pre><code>Dim nodeList As Object, i As Long\nSet nodeList = html.querySelectorAll(\"#data_table tr.tinside td\")\nFor i = 0 To nodeList.Length -1\n    Debug.Print nodeList.item(i).innerText\nNext\n</code></pre>\n\n<p>The whole table you can use id selector</p>\n\n<pre><code>Dim ele As Object\nSet ele  = html.getElementById(\"data_table\")\n' then loop the tr tags and then the td tags\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 3529237, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000169137351/picture?type=large", "display_name": "user3529237", "link": "https://stackoverflow.com/users/3529237/user3529237"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 0, "accepted_answer_id": 54669756, "answer_count": 1, "score": -2, "last_activity_date": 1550087394, "creation_date": 1550057113, "last_edit_date": 1550064671, "question_id": 54669059, "link": "https://stackoverflow.com/questions/54669059/how-to-get-values-from-http-response-to-excel-with-vba-code", "title": "how to get values from HTTP Response to Excel with VBA Code", "body": "<p>I need your little help to get stock value(corresponding to stock name) from the HTTP Response I got. Received Response is in form of HTML, of which i put some part as code is too long. downwards I have mention the VBA Code i am using but it is showing error. Please anyone help me..!!\nNote: Stock Name and Values are present in \"Input type\"(line 5 from down)</p>\n\n<pre><code>&lt;!--    &lt;table align=\"left\"&gt;\n    &lt;tr&gt;\n    &lt;td&gt; --&gt;\n        &lt;div class=\"table-responsive\" style=\"width: 110%;\"&gt;\n          &lt;table border=\"0\" align=\"left\" width=\"688\" cellpadding=\"5\" cellspacing=\"1\" class=\"table_style table_111111\" id=\"data_table\"&gt;\n                &lt;thead&gt;\n                    &lt;tr class=\"table_header\"&gt; \n                        &lt;td width=\"15\" class=\"center_align\"&gt;&lt;strong&gt;&lt;/strong&gt;&lt;/td&gt;\n                        &lt;td width=\"50\" class=\"left_align\"&gt;&lt;strong&gt;Security &lt;/strong&gt;&lt;/td&gt;\n                        &lt;td width=\"20\" class=\"center_align\"&gt;&lt;strong&gt;ME&lt;/strong&gt;&lt;/td&gt;\n                        &lt;td width=\"15\" class=\"center_align\"&gt;&lt;strong&gt;Exch Code&lt;/strong&gt;&lt;/td&gt;\n                        &lt;td width=\"15\" class=\"center_align\"&gt;&lt;strong&gt;Tradesmart Trends&lt;/strong&gt;&lt;/td&gt;\n                        &lt;td width=\"20\" class=\"center_align\"&gt;&lt;strong&gt;IT&lt;/strong&gt;&lt;/td&gt;\n                        &lt;td width=\"50\" class=\"center_align\"&gt;&lt;strong&gt;Expiry Date&lt;/strong&gt;&lt;/td&gt;\n                        &lt;td width=\"50\" class=\"center_align\"&gt;&lt;strong&gt;Strike Price&lt;/strong&gt;&lt;/td&gt;\n                        &lt;td width=\"10\" class=\"center_align\"&gt;&lt;strong&gt;Opt Type&lt;/strong&gt;&lt;/td&gt;\n                        &lt;td width=\"32\" class=\"center_align\"&gt;&lt;strong&gt;Open Price&lt;/strong&gt;&lt;/td&gt;\n                        &lt;td width=\"40\" class=\"center_align\"&gt;&lt;strong&gt;Buy Price&lt;/strong&gt;&lt;/td&gt;\n                        &lt;td width=\"32\" class=\"center_align\"&gt;&lt;strong&gt;Buy Vol&lt;/strong&gt;&lt;/td&gt;\n                        &lt;td width=\"41\" class=\"center_align\"&gt;&lt;strong&gt;Sell Price&lt;/strong&gt;&lt;/td&gt;\n                        &lt;td width=\"32\" class=\"center_align\"&gt;&lt;strong&gt;Sell Vol&lt;/strong&gt;&lt;/td&gt;\n                        &lt;td width=\"41\" class=\"center_align\"&gt;&lt;strong&gt;Last Price&lt;/strong&gt;&lt;/td&gt;\n                        &lt;td width=\"28\" class=\"center_align\"&gt;&lt;strong&gt;High Price&lt;/strong&gt;&lt;/td&gt;\n                        &lt;td width=\"41\" class=\"center_align\"&gt;&lt;strong&gt;Low Price&lt;/strong&gt;&lt;/td&gt;\n                        &lt;td width=\"25\" class=\"center_align\"&gt;&lt;strong&gt;O.I.&lt;/strong&gt;&lt;/td&gt;\n                        &lt;td width=\"20\" class=\"center_align\"&gt;&lt;strong&gt;CAs&lt;/strong&gt;&lt;/td&gt;\n                        &lt;td width=\"50\" class=\"center_align\"&gt;&lt;strong&gt; % Change&lt;/strong&gt;&lt;/td&gt;\n                        &lt;td width=\"50\" class=\"center_align\"&gt;&lt;strong&gt;Net Change&lt;/strong&gt;&lt;/td&gt;\n\n                    &lt;/tr&gt;\n                &lt;/thead&gt;\n\n&lt;input type='hidden' id='first_watch' name='first_watch' value='current'/&gt;&lt;tr class='tinside'&gt;&lt;td class=\"left_align\"&gt;&lt;input type=checkbox name=\"stkcode\" value=\"1157(NN)EQ\" onClick=\"checkCheck(4);\"&gt;&lt;/td&gt;&lt;td class=\"left_align\"&gt;APOLLOTYRE&lt;/td&gt;&lt;td class=\"center_align\"&gt;NSE&lt;/td&gt;&lt;td class=\"center_align\"&gt;163&lt;/td&gt;&lt;td class=\"center_align\"&gt;&lt;A style='font-family: Arial, Helvetica, sans-serif; font-size: 11px; color: #31B404; font-weight: bold;' HREF=\"/itrade/user/recognia.exe?action=access\"  &gt;Bullish&lt;/A&gt;&lt;/td&gt;&lt;td class=\"center_align\"&gt;EQ&lt;/td&gt;&lt;td class=\"center_align\"&gt;-&lt;/td&gt;&lt;td class=\"center_align\"&gt;0.00&lt;/td&gt;&lt;td class=\"center_align\"&gt;- &lt;/td&gt;&lt;td class=\"center_align\"&gt;201.00&lt;/td&gt;&lt;td class=\"center_align\"&gt;0.00&lt;/td&gt;&lt;td class=\"center_align\"&gt;&lt;/td&gt;&lt;td class=\"center_align\"&gt;199.50&lt;/td&gt;&lt;td class=\"center_align\"&gt;1,990&lt;/td&gt;&lt;td class=\"center_align\"&gt;199.50&lt;/td&gt;&lt;td class=\"center_align\"&gt;203.85&lt;/td&gt;&lt;td class=\"center_align\"&gt;198.50&lt;/td&gt;&lt;td class=\"center_align\"&gt;    0&lt;/td&gt;&lt;td class=\"center_align\"&gt;XD&lt;/td&gt;  &lt;td class=\"center_align\"&gt;    0.00&lt;/td&gt;  &lt;td class=\"center_align\"&gt;    0.00&lt;/td&gt;  &lt;/tr&gt;&lt;tr class='tinside'&gt;&lt;td class=\"left_align\"&gt;&lt;input type=checkbox name=\"stkcode\" value=\"2441(NN)EQ\" onClick=\"checkCheck(5);\"&gt;&lt;/td&gt;&lt;td class=\"left_align\"&gt;SUNPHARMA&lt;/td&gt;&lt;td class=\"center_align\"&gt;NSE&lt;/td&gt;&lt;td class=\"center_align\"&gt;3351&lt;/td&gt;&lt;td class=\"center_align\"&gt;&lt;A style='font-family: Arial, Helvetica, sans-serif; font-size: 11px; color: #31B404; font-weight: bold;' HREF=\"/itrade/user/recognia.exe?action=access\"  &gt;Bullish&lt;/A&gt;&lt;/td&gt;&lt;td class=\"center_align\"&gt;EQ&lt;/td&gt;&lt;td class=\"center_align\"&gt;-&lt;/td&gt;&lt;td class=\"center_align\"&gt;0.00&lt;/td&gt;&lt;td class=\"center_align\"&gt;- &lt;/td&gt;&lt;td class=\"center_align\"&gt;454.90&lt;/td&gt;&lt;td class=\"center_align\"&gt;0.00&lt;/td&gt;&lt;td class=\"center_align\"&gt;&lt;/td&gt;&lt;td class=\"center_align\"&gt;431.25&lt;/td&gt;&lt;td class=\"center_align\"&gt;66,412&lt;/td&gt;&lt;td class=\"center_align\"&gt;431.25&lt;/td&gt;&lt;td class=\"center_align\"&gt;455.00&lt;/td&gt;&lt;td class=\"center_align\"&gt;426.45&lt;/td&gt;&lt;td class=\"center_align\"&gt;    0&lt;/td&gt;&lt;td class=\"center_align\"&gt;XD&lt;/td&gt;  &lt;td class=\"center_align\"&gt;    0.00&lt;/td&gt;  &lt;td class=\"center_align\"&gt;    0.00&lt;/td&gt;  &lt;/tr&gt;&lt;/table&gt;\n&lt;/div&gt;\n&lt;!--&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n</code></pre>\n\n<p>Here is the VBA Code. what I am Using to send POST Req to get stock value in response.</p>\n\n<pre><code>Dim cook As String, bodyk As String, xmlhttp As Object, response As String\nDim getcookres As String, html As New HTMLDocument\nDim document As Object\n\nSet xmlhttp = CreateObject(\"MSXML2.ServerXMLHTTP.6.0\")\ncook = Worksheets(\"Action\").Range(\"X2\").Value\nbodyk = Worksheets(\"Action\").Range(\"X1\").Value\n\n\nURL = \"https://www.xxxxxxxx.com/itrade/user/watch.exe?action=C\"\nxmlhttp.Open \"POST\", URL, False\nxmlhttp.setRequestHeader \"Host\", \"www.xxxxxxxx.com\"\nxmlhttp.setRequestHeader \"Connection\", \"keep-alive\"\nxmlhttp.setRequestHeader \"Content-Length\", \"700\"\nxmlhttp.setRequestHeader \"Cache-Control\", \"max-age=0\"\nxmlhttp.setRequestHeader \"Origin\", \"https://www.xxxxxxxx.com\"\nxmlhttp.setRequestHeader \"Upgrade-Insecure-Requests\", \"1\"\nxmlhttp.setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\nxmlhttp.setRequestHeader \"User-Agent\", \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36\"\nxmlhttp.setRequestHeader \"Accept\", \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8\"\nxmlhttp.setRequestHeader \"Referer\", \"https://www.xxxxxxxx.com/itrade/user/watch.exe?action=C\"\nxmlhttp.setRequestHeader \"Accept-Encoding\", \"gzip, deflate, br\"\nxmlhttp.setRequestHeader \"Accept-Language\", \"en-US,en;q=0.9\"\nxmlhttp.setRequestHeader \"Cookie\", cook\n\nxmlhttp.send bodyk\n\nhtml.body.innerHTML = xmlhttp.responseText\n\n'Set document = html.getElementsByid(\"header\").getElementsByid(\"container\")(0).getElementsByClassName(\"table-responsive\")(0).getElementsByid(\"first_watch\")(1)\n\nSet document = html.getElementsByClassName(\"tinside\")\n'Debug.Print html.body.innerHTML\nDebug.Print document\nSheets(1).Cells(2, 1).Value = document.getElementsByTagName(\"td\")(0).innerText\n</code></pre>\n"}, {"tags": ["excel", "vba", "permutation"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1550059132, "post_id": 54669041, "comment_id": 96129221, "body": "How many <b>&quot;Levels&quot;</b> do you need to cover? or do you need that to be dynamic?"}, {"owner": {"reputation": 13, "user_id": 7019564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2bd9fa2507054dcc49ceb278123820b?s=128&d=identicon&r=PG&f=1", "display_name": "Surreall", "link": "https://stackoverflow.com/users/7019564/surreall"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1550059419, "post_id": 54669041, "comment_id": 96129413, "body": "Ideally dynamic :-( I can&#39;t seem to edit the main post, my output numbers are wrong. level 2 = 1, 1 - 1, 2 - 2, 1 - 2, 2 e.g."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1550060701, "post_id": 54669041, "comment_id": 96130099, "body": "You could loop 2^x where x is the levels, then use a Decimal to Binary converter and replace 0&#39;s to 2&#39;s?  Outputs like so 0000=0,0001=1,0010=2..."}, {"owner": {"reputation": 6870, "user_id": 598599, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3f0d59c484274d5ec80b566ea737666?s=128&d=identicon&r=PG", "display_name": "AutomatedChaos", "link": "https://stackoverflow.com/users/598599/automatedchaos"}, "edited": false, "score": 1, "creation_date": 1550061501, "post_id": 54669041, "comment_id": 96130591, "body": "Just FYI, what you want is called <i>permutations</i>. If you google on it you can find some solutions like <a href=\"http://spreadsheetpage.com/index.php/tip/generating_permutations/\" rel=\"nofollow noreferrer\">this one</a>."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7019564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2bd9fa2507054dcc49ceb278123820b?s=128&d=identicon&r=PG&f=1", "display_name": "Surreall", "link": "https://stackoverflow.com/users/7019564/surreall"}, "edited": false, "score": 0, "creation_date": 1550061201, "post_id": 54670201, "comment_id": 96130409, "body": "You genius! So i could use the sArray and loop over each character in the string?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 13, "user_id": 7019564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2bd9fa2507054dcc49ceb278123820b?s=128&d=identicon&r=PG&f=1", "display_name": "Surreall", "link": "https://stackoverflow.com/users/7019564/surreall"}, "edited": false, "score": 0, "creation_date": 1550061453, "post_id": 54670201, "comment_id": 96130563, "body": "@Surreall - Welcome. Concerning the <code>sArray</code> and looping over its characters - it is better to avoid writing to a string, but simply looping through <code>myArray</code>."}, {"owner": {"reputation": 13, "user_id": 7019564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2bd9fa2507054dcc49ceb278123820b?s=128&d=identicon&r=PG&f=1", "display_name": "Surreall", "link": "https://stackoverflow.com/users/7019564/surreall"}, "edited": false, "score": 0, "creation_date": 1550062270, "post_id": 54670201, "comment_id": 96131029, "body": "Worked a treat, thank you! This was driving me crazy."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1550061259, "last_edit_date": 1550061259, "creation_date": 1550060883, "answer_id": 54670201, "question_id": 54669041, "link": "https://stackoverflow.com/questions/54669041/vba-write-all-permutations-of-numbers-to-an-array/54670201#54670201", "title": "VBA - write all permutations of numbers to an array", "body": "<p>Some time ago, I did not have anything better to do and I wrote exactly the code you are looking for - <a href=\"https://www.vitoshacademy.com/vba-nested-loops-with-recursion/\" rel=\"nofollow noreferrer\">https://www.vitoshacademy.com/vba-nested-loops-with-recursion/</a></p>\n\n<p>Thus, if you change it a bit, avoiding the <code>_</code> and putting the <code>size</code> variable into a loop, it prints the desired result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0vRMG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0vRMG.png\" alt=\"enter image description here\"></a></p>\n\n<p>If you change <code>c = Array(1, 2)</code> to <code>c = Array(1, 2, 3)</code> it would add a third element to the system.</p>\n\n<pre><code>Sub Main()\n\n    Static size         As Long\n    Static c            As Variant\n    Static arr          As Variant\n    Static n            As Long\n\n    c = Array(1, 2)\n    n = UBound(c) + 1\n    For size = 1 To 4\n        ReDim arr(size - 1)\n        EmbeddedLoops 0, size, c, n, arr\n        Debug.Print \"---------\"\n    Next size\n\nEnd Sub\n\nFunction EmbeddedLoops(index, k, c, n, arr)\n\n    Dim i                   As Variant\n    If index &gt;= k Then\n        PrintArrayInOneLine arr\n    Else\n        For Each i In c\n            arr(index) = i\n            EmbeddedLoops index + 1, k, c, n, arr\n        Next i\n    End If\n\nEnd Function\n\nPublic Sub PrintArrayInOneLine(myArray As Variant)\n\n    Dim counter     As Long\n    Dim sArray      As String\n    For counter = LBound(myArray) To UBound(myArray)\n        sArray = sArray &amp; myArray(counter)\n    Next counter\n    Debug.Print sArray\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7019564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2bd9fa2507054dcc49ceb278123820b?s=128&d=identicon&r=PG&f=1", "display_name": "Surreall", "link": "https://stackoverflow.com/users/7019564/surreall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "accepted_answer_id": 54670201, "answer_count": 1, "score": 1, "last_activity_date": 1550135404, "creation_date": 1550057064, "last_edit_date": 1550135404, "question_id": 54669041, "link": "https://stackoverflow.com/questions/54669041/vba-write-all-permutations-of-numbers-to-an-array", "title": "VBA - write all permutations of numbers to an array", "body": "<p>Currently i am manually entering the values into array, sign_array(a, b, c). Where c is the level number. So see my output below, where c = 1 there are only two inputs to the array. When c = 2 (or level 2) there are 4 inputs. Level 3 = 8 inputs, level 4 there are 16 inputs. But writing these all out is getting very tiresome.</p>\n\n<p>I am really struggling with this. I need to write to an array all combinations of 1 or 2, and looking for an output of:</p>\n\n<pre><code>1    \n2\n1, 1    \n1, 2    \n2, 1\n2, 2  \n1, 1, 1  \n2, 1, 1    \n1, 2, 1    \n1, 1, 2    \n2, 2, 1    \n2, 1, 2    \n1, 2, 2    \n2, 2, 2    \n1, 1, 1, 1    \n2, 1, 1, 1\netc\n</code></pre>\n\n<p>Please see below how far I got, but have no idea what to do, to distinguish between a 1 or a 2. Any help would be greatly appreciated. At the moment i am manually putting in the combinations myself, but I its getting far to big the more dimensions I have.</p>\n\n<p>I don't mind have a for loop for each level creation.</p>\n\n<pre><code>levels_to_use = 4\nfor i = 1 to levels_to_use  ^ 2\n    for j = 1 to levels_to_use \n        ' in here how to chose between 1 or 2\n        sign_array(i, j, levels_to_use) = 1\n    next\nnext\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1439, "user_id": 7396613, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea7490a33ebc405a244013b37af249ec?s=128&d=identicon&r=PG&f=1", "display_name": "M.K", "link": "https://stackoverflow.com/users/7396613/m-k"}, "edited": false, "score": 4, "creation_date": 1550055793, "post_id": 54668505, "comment_id": 96127286, "body": "And what have you tried...?"}, {"owner": {"reputation": 4200, "user_id": 3104974, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bf327f4729e0af1e6bf0582391fad75?s=128&d=identicon&r=PG&f=1", "display_name": "ascripter", "link": "https://stackoverflow.com/users/3104974/ascripter"}, "edited": false, "score": 0, "creation_date": 1551274185, "post_id": 54668505, "comment_id": 96580242, "body": "If my answer was helpful to you, please accept it."}], "answers": [{"tags": [], "owner": {"reputation": 4200, "user_id": 3104974, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bf327f4729e0af1e6bf0582391fad75?s=128&d=identicon&r=PG&f=1", "display_name": "ascripter", "link": "https://stackoverflow.com/users/3104974/ascripter"}, "is_accepted": false, "score": 0, "last_activity_date": 1550058080, "creation_date": 1550058080, "answer_id": 54669323, "question_id": 54668505, "link": "https://stackoverflow.com/questions/54668505/with-having-two-dates-now-i-month-wise-days-calculation-required/54669323#54669323", "title": "With having two dates now i month wise days calculation required", "body": "<p>Here is a simple solution if your <em>Active Month</em> column entries are not the names of the month, but the last day.</p>\n\n<pre><code>31.01.2019  28.02.2019  ...\n</code></pre>\n\n<p>For the January column you can then use</p>\n\n<pre><code>=MAX(0, MIN($AV14-$AT14, AY$13-$AV14))\n</code></pre>\n\n<p>and for the other months you have to subtract the days aggregated since January. Here for February:</p>\n\n<pre><code>=MAX(0, MIN($AV14-$AT14, AZ$13-$AV14) - SUM($AY14:AY14))\n</code></pre>\n\n<p>Expand the last formula from Feb to Dec.</p>\n"}], "owner": {"reputation": 1, "user_id": 11055866, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ORnPjI4oP8w/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNbJbLy7GNV_TtfWBX6-YvgCyuK2w/mo/photo.jpg?sz=128", "display_name": "Sayed Iqbal", "link": "https://stackoverflow.com/users/11055866/sayed-iqbal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1550064653, "creation_date": 1550055341, "last_edit_date": 1550064653, "question_id": 54668505, "link": "https://stackoverflow.com/questions/54668505/with-having-two-dates-now-i-month-wise-days-calculation-required", "title": "With having two dates now i month wise days calculation required", "body": "<p>I have two dates. Now my aim is to calculate the number of days, month wise for <code>n</code> number of rows</p>\n\n<p>Input:</p>\n\n<pre><code>start date    22/01/2019\nfinish date   21/06/2019\n</code></pre>\n\n<p>Output &amp; result should be</p>\n\n<pre><code>January February   March    April   May     June\n9       28         31       30      31      21                          \n</code></pre>\n\n<p>for many rows.</p>\n\n<p>Excel or VBA Excel formula both will be great,\nThanks in advance....</p>\n\n<p>Here is a screenshot of my Excel table:\n<a href=\"https://ibb.co/tC38jzs\" rel=\"nofollow noreferrer\">https://ibb.co/tC38jzs</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1550055788, "post_id": 54668255, "comment_id": 96127283, "body": "You can check <code>if result &lt;&gt; &quot;&quot; then</code>"}, {"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1550055955, "post_id": 54668255, "comment_id": 96127383, "body": "@Nathan_Sav there is no such method"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11055900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbe0fa55d93d373d0fd67e079268b14?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Jacques", "link": "https://stackoverflow.com/users/11055900/ryan-jacques"}, "edited": false, "score": 0, "creation_date": 1550057786, "post_id": 54668900, "comment_id": 96128438, "body": "Brill, that got it! Thanks!"}], "tags": [], "owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "is_accepted": true, "score": 0, "last_activity_date": 1550056605, "creation_date": 1550056605, "answer_id": 54668900, "question_id": 54668255, "link": "https://stackoverflow.com/questions/54668255/vba-show-message-if-nothing-selected-listbox-multiselect/54668900#54668900", "title": "VBA Show message if nothing selected Listbox Multiselect", "body": "<p>Try this </p>\n\n<pre><code>Dim i As Integer\n\nWith Worksheets(\"SQL Sheet\").ListBoxes(\"31\")\n\n    result = \"\"\n\n    For i = 1 To .ListCount\n        If .Selected(i) Then\n            result = result &amp; \"','\" &amp; .List(i)\n        End If\n    Next i\n\nEnd With\n\nif result &lt;&gt; \"\" then\n  result = result &amp; \"'\"\n  result = Right(result, Len(result) - 2)\n  MsgBox result\nelse\n  Msgbox \"Nothing Selected.\"\nEnd  if\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11055900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbe0fa55d93d373d0fd67e079268b14?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Jacques", "link": "https://stackoverflow.com/users/11055900/ryan-jacques"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 54668900, "answer_count": 1, "score": 0, "last_activity_date": 1550064646, "creation_date": 1550054608, "last_edit_date": 1550064646, "question_id": 54668255, "link": "https://stackoverflow.com/questions/54668255/vba-show-message-if-nothing-selected-listbox-multiselect", "title": "VBA Show message if nothing selected Listbox Multiselect", "body": "<p>Currently have a multi select listbox, on button press it shows options which im going to pass to SQL, how do I get it so a msg shows if none are selected</p>\n\n<pre><code>Dim i As Integer\n\nWith Worksheets(\"SQL Sheet\").ListBoxes(\"31\")\n\n\n    For i = 1 To .ListCount\n        If .Selected(i) Then\n            result = result &amp; \"','\" &amp; .List(i)\n        End If\n    Next i\n\nEnd With\n\nresult = result &amp; \"'\"\nresult = Right(result, Len(result) - 2)\nMsgBox result\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2016"], "answers": [{"comments": [{"owner": {"reputation": 118, "user_id": 2002716, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/63eba881cbc82d9e4ba86dc3da5ac0e0?s=128&d=identicon&r=PG", "display_name": "user2002716", "link": "https://stackoverflow.com/users/2002716/user2002716"}, "edited": false, "score": 0, "creation_date": 1550057968, "post_id": 54668656, "comment_id": 96128541, "body": "I tried that and it didn\u2019t work. I\u2019ll double check my code, but I\u2019m sure that\u2019s exactly what I have... well plus with the other two fields"}, {"owner": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "reply_to_user": {"reputation": 118, "user_id": 2002716, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/63eba881cbc82d9e4ba86dc3da5ac0e0?s=128&d=identicon&r=PG", "display_name": "user2002716", "link": "https://stackoverflow.com/users/2002716/user2002716"}, "edited": false, "score": 0, "creation_date": 1550059206, "post_id": 54668656, "comment_id": 96129275, "body": "Forms![MEMBER].Textbox1= Me.Combo0.Column(1). try this"}, {"owner": {"reputation": 118, "user_id": 2002716, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/63eba881cbc82d9e4ba86dc3da5ac0e0?s=128&d=identicon&r=PG", "display_name": "user2002716", "link": "https://stackoverflow.com/users/2002716/user2002716"}, "edited": false, "score": 0, "creation_date": 1550125093, "post_id": 54668656, "comment_id": 96156808, "body": "yeah that worked, still trying to figure out how to get all thre fields into one single text box though."}, {"owner": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "reply_to_user": {"reputation": 118, "user_id": 2002716, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/63eba881cbc82d9e4ba86dc3da5ac0e0?s=128&d=identicon&r=PG", "display_name": "user2002716", "link": "https://stackoverflow.com/users/2002716/user2002716"}, "edited": false, "score": 0, "creation_date": 1550129069, "post_id": 54668656, "comment_id": 96158462, "body": "that&#39;s easy <code>Forms![MEMBER].Textbox1 = Me.Combo1.Column(1) &amp; &quot; &quot; &amp; Me.Combo2.Column(1) &amp; &quot; &quot; &amp; Me.Combo3.Column(1)</code> change the combox Name and column index value as your need."}], "tags": [], "owner": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1550055800, "creation_date": 1550055800, "answer_id": 54668656, "question_id": 54668145, "link": "https://stackoverflow.com/questions/54668145/populate-text-box-on-one-form-based-on-combo-box-selection-on-another-form/54668656#54668656", "title": "populate text box on one form based on combo box selection on another form", "body": "<p>Before closing the Form, Use the Vba code as below</p>\n\n<pre><code>Forms![MEMBER].Textbox1= Me.Combobox1  ' set the value of combobox to your Textbox in Form1\nDocmd.close 'Close the form\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 118, "user_id": 2002716, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/63eba881cbc82d9e4ba86dc3da5ac0e0?s=128&d=identicon&r=PG", "display_name": "user2002716", "link": "https://stackoverflow.com/users/2002716/user2002716"}, "edited": false, "score": 0, "creation_date": 1550125022, "post_id": 54669692, "comment_id": 96156784, "body": "I have this, the issue is I&#39;m wanting to store Column(0), Column(1), and Column(2) into one text box, with a space beteween each."}], "tags": [], "owner": {"reputation": 221, "user_id": 9994550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c894ad9ce27a5c6290b356850530ac18?s=128&d=identicon&r=PG&f=1", "display_name": "S.Jose", "link": "https://stackoverflow.com/users/9994550/s-jose"}, "is_accepted": false, "score": 0, "last_activity_date": 1550132182, "last_edit_date": 1550132182, "creation_date": 1550059129, "answer_id": 54669692, "question_id": 54668145, "link": "https://stackoverflow.com/questions/54668145/populate-text-box-on-one-form-based-on-combo-box-selection-on-another-form/54669692#54669692", "title": "populate text box on one form based on combo box selection on another form", "body": "<p>To set the value on form1, use the <code>Column</code> property of <code>Combobox</code> with index value, </p>\n\n<pre><code>Forms!form1!Textbox1 = Me.Combobox1.Column(0) &amp; \" \" &amp; Me.Combobox1.Column(1) &amp; \" \" &amp; Me.Combobox1.Column(2)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 118, "user_id": 2002716, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/63eba881cbc82d9e4ba86dc3da5ac0e0?s=128&d=identicon&r=PG", "display_name": "user2002716", "link": "https://stackoverflow.com/users/2002716/user2002716"}, "is_accepted": false, "score": -2, "last_activity_date": 1550126564, "creation_date": 1550126564, "answer_id": 54684555, "question_id": 54668145, "link": "https://stackoverflow.com/questions/54668145/populate-text-box-on-one-form-based-on-combo-box-selection-on-another-form/54684555#54684555", "title": "populate text box on one form based on combo box selection on another form", "body": "<p>nevermind I was able to figure it out once my brain started working...</p>\n\n<pre><code>Dim supervisor1 As Variant\nDim supervisor2 As Variant\nDim supervisor3 As Variant\nDim supervisor4 As Variant\n\nsupervisor1 = Me.Combo0.Column(0)\nsupervisor2 = Me.Combo0.Column(1)\nsupervisor3 = Me.Combo0.Column(2)\nsupervisor4 = supervisor1 &amp; \" \" &amp; supervisor3 &amp; \" \" &amp; supervisor2\nForms![Member].Text48 = supervisor4\n</code></pre>\n"}], "owner": {"reputation": 118, "user_id": 2002716, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/63eba881cbc82d9e4ba86dc3da5ac0e0?s=128&d=identicon&r=PG", "display_name": "user2002716", "link": "https://stackoverflow.com/users/2002716/user2002716"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 653, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1550132182, "creation_date": 1550054340, "question_id": 54668145, "link": "https://stackoverflow.com/questions/54668145/populate-text-box-on-one-form-based-on-combo-box-selection-on-another-form", "title": "populate text box on one form based on combo box selection on another form", "body": "<p>I've been looking around and can't seem to find an accurate answer to at least steer me in the right direction. On form1 (Members) i have a button that opens another form (supervisor) with a combo. The combo has 3 fields and upon selection I want it to store the 3 values in a text box on form1 then close form 2 (which I know this code).</p>\n"}, {"tags": ["c#", "excel", "vba", "vsto"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1550057084, "post_id": 54668057, "comment_id": 96128029, "body": "This may help - <a href=\"https://stackoverflow.com/questions/41162601/intellisense-in-custom-com-classes-in-vba\" title=\"intellisense in custom com classes in vba\">stackoverflow.com/questions/41162601/&hellip;</a>"}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 3, "creation_date": 1550057481, "post_id": 54668057, "comment_id": 96128264, "body": "FWIW, I would add that I&#39;m not seeing a reason why you need VSTO here. This can be done with just a plain C# DLL referenced in VBA project, as @Vityata linked to. Normally, you use VSTO because you want to customize the host, expose some custom functionality on the Office host or something like that. But for a bunch of functions? VSTO is just making it more complicated for you. COM Interop is all you need."}], "answers": [{"tags": [], "owner": {"reputation": 893, "user_id": 10794555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0D8LRxW70DQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-icioZDBlm6V-nHzFzMNQ2LTv2Nmg/mo/photo.jpg?sz=128", "display_name": "Ama", "link": "https://stackoverflow.com/users/10794555/ama"}, "is_accepted": false, "score": 0, "last_activity_date": 1550078170, "creation_date": 1550078170, "answer_id": 54675948, "question_id": 54668057, "link": "https://stackoverflow.com/questions/54668057/making-types-created-in-c-accessible-from-vba-using-vsto/54675948#54675948", "title": "Making types created in C# accessible from vba using VSTO", "body": "<p>No need for VSTO here. Since you intend to run your functions from VBA, you do not need to run your build to communicate with Excel, but only with VBA and when it needs it.</p>\n\n<p>So best would be to create a Class Library project (DLL), which you can then reference from VBA.</p>\n\n<ul>\n<li>How to reference:\n<a href=\"https://docs.microsoft.com/en-us/office/vba/language/how-to/check-or-add-an-object-library-reference\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/language/how-to/check-or-add-an-object-library-reference</a></li>\n<li>How to interface with VBA (it's for C++ but the principle is the\nsame): <a href=\"https://onlinelibrary.wiley.com/doi/pdf/10.1002/9781119206149.app4\" rel=\"nofollow noreferrer\">https://onlinelibrary.wiley.com/doi/pdf/10.1002/9781119206149.app4</a></li>\n</ul>\n"}], "owner": {"reputation": 387, "user_id": 3227830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935376e1d436d541981377474a2524e2?s=128&d=identicon&r=PG&f=1", "display_name": "bgarrood", "link": "https://stackoverflow.com/users/3227830/bgarrood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 438, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1550078170, "creation_date": 1550054071, "question_id": 54668057, "link": "https://stackoverflow.com/questions/54668057/making-types-created-in-c-accessible-from-vba-using-vsto", "title": "Making types created in C# accessible from vba using VSTO", "body": "<p>I'm using VSTO to make a bunch of functions written in C# accessible from Excel VBA.  It would be convenient to create types (say, a class) with a number of properties to allow me to pass that single class to and from excel.</p>\n\n<p>VSTO overrides the RequestComAddInAutomationService method to expose a single class which contains the methods I want to expose.  I therefore cannot figure out how to expose a second class or struct etc.   My class uses an interface to expose its methods to vba, but you cannot define types in an interface.  I have tried to create the type class within my main class, but am unable to get vba to recognise it.</p>\n\n<p>This is the code inside \"ThisAddIn.cs:</p>\n\n<pre><code>public partial class ThisAddIn\n{\n  private void ThisAddIn_Startup(object sender, System.EventArgs e)\n  {\n  }\n\n  private void ThisAddIn_Shutdown(object sender, System.EventArgs e)\n  {\n  }\n\n  #region VSTO generated code\n\n  /// &lt;summary&gt;\n  /// Required method for Designer support - do not modify\n  /// the contents of this method with the code editor.\n  /// &lt;/summary&gt;\n  private void InternalStartup()\n  {\n    this.Startup += new System.EventHandler(ThisAddIn_Startup);\n    this.Shutdown += new System.EventHandler(ThisAddIn_Shutdown);\n  }\n\n  #endregion\n\n  private AddInUtilities utilities;\n\n  protected override object RequestComAddInAutomationService()\n  {\n    if (utilities == null) utilities = new AddInUtilities();\n\n    return utilities;\n  }\n}\n</code></pre>\n\n<p>And in AddInUtilities.cs:</p>\n\n<p>[ComVisible(true)]\n    public interface IAddInUtilities\n    {\n      string[] ListKeyMetrics();\n      string[]  ListSetptMetrics();\n      AddInUtilities.testStruct myTest();\n      double test { get; set; }\n    }</p>\n\n<pre><code>[ComVisible(true)]\n[ClassInterface(ClassInterfaceType.None)]\npublic class AddInUtilities : IAddInUtilities\n{\n  public class testStruct\n  {\n    private double _x;\n    private double _y;\n\n    public testStruct(int z)\n    {\n      _x = 0;\n      _y = 0;\n    }\n\n    public double x\n    {\n      get { return _x; }\n      set { _x = value; }\n    }\n\n    public double y\n    {\n      get { return _y; }\n      set { _y = value; }\n    }\n  }\n\n  public double test\n  {\n    get; set;\n\n  } = 5;\n\n  public string[] ListKeyMetrics()\n  {\n    string[] ret = { \"SCz\", \"SCx\", \"etc\" };\n    return ret;\n  }\n\n  public string[] ListSetptMetrics()\n  {\n    string[] ret = { \"FRH\", \"RRH\", \"etc\" };\n    return ret;\n\n  }\n\n  public testStruct myTest()\n  {\n    testStruct ret = new testStruct(0);\n    ret.x = 1;\n    ret.y = 2;\n    return ret;\n  }\n\n}\n</code></pre>\n\n<p>Any suggestions on how I can create a type in VSTO and have it visible from vba?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 3, "creation_date": 1550054056, "post_id": 54667966, "comment_id": 96126191, "body": "If you show us your code, you will get much better help!"}, {"owner": {"reputation": 7, "user_id": 10608784, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JqKyUjORink/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAM6ODzuujINOlwUCuey8JpT9gPvQ/mo/photo.jpg?sz=128", "display_name": "ANTONIO SAVIO RANIERI", "link": "https://stackoverflow.com/users/10608784/antonio-savio-ranieri"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1550055245, "post_id": 54667966, "comment_id": 96126941, "body": "well I haven&#39;t got. I\u2019m trying to generate one but my experience now is limited \ud83d\ude01"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1550059595, "post_id": 54667966, "comment_id": 96129511, "body": "Any other <b>special rules</b> other than the one&#39;s for <code>JAZZ</code> and <code>WT</code>?  Also, your screenshot of data is virtually useless for doing proper troubleshooting. It cannot be copy/pasted into a worksheet. Having to manually enter it is discouraging to those who might assist you. To make the data useful edit your question to post it as text, perhaps using this <a href=\"https://www.tablesgenerator.com/markdown_tables\" rel=\"nofollow noreferrer\">Markdown Tables Generator</a>, or possibly upload a workbook (with sensitive information removed) to some public website and post a link in your original question."}, {"owner": {"reputation": 7, "user_id": 10608784, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JqKyUjORink/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAM6ODzuujINOlwUCuey8JpT9gPvQ/mo/photo.jpg?sz=128", "display_name": "ANTONIO SAVIO RANIERI", "link": "https://stackoverflow.com/users/10608784/antonio-savio-ranieri"}, "edited": false, "score": 0, "creation_date": 1550059683, "post_id": 54667966, "comment_id": 96129567, "body": "Thank you so much. Really."}, {"owner": {"reputation": 7, "user_id": 10608784, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JqKyUjORink/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAM6ODzuujINOlwUCuey8JpT9gPvQ/mo/photo.jpg?sz=128", "display_name": "ANTONIO SAVIO RANIERI", "link": "https://stackoverflow.com/users/10608784/antonio-savio-ranieri"}, "edited": false, "score": 0, "creation_date": 1550059720, "post_id": 54667966, "comment_id": 96129586, "body": "The special rules are only for jazz and wt"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1550059763, "post_id": 54667966, "comment_id": 96129619, "body": "And what exactly do you mean by <code>CMXXAB</code>?"}, {"owner": {"reputation": 7, "user_id": 10608784, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JqKyUjORink/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAM6ODzuujINOlwUCuey8JpT9gPvQ/mo/photo.jpg?sz=128", "display_name": "ANTONIO SAVIO RANIERI", "link": "https://stackoverflow.com/users/10608784/antonio-savio-ranieri"}, "edited": false, "score": 0, "creation_date": 1550059957, "post_id": 54667966, "comment_id": 96129718, "body": "As you can see in shoot, there are several of string that begin in CM. All three begin with CM00PR but they could be CM01VC or CM06VE. Hope I\u2019ve been clear"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1550061129, "post_id": 54667966, "comment_id": 96130369, "body": "So do you mean any string that starts with <code>CM</code>?  or do you mean any string that starts with <code>CM0</code>?  Or something else?"}, {"owner": {"reputation": 7, "user_id": 10608784, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JqKyUjORink/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAM6ODzuujINOlwUCuey8JpT9gPvQ/mo/photo.jpg?sz=128", "display_name": "ANTONIO SAVIO RANIERI", "link": "https://stackoverflow.com/users/10608784/antonio-savio-ranieri"}, "edited": false, "score": 0, "creation_date": 1550061403, "post_id": 54667966, "comment_id": 96130538, "body": "Any strings that starts with CM"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1550061537, "post_id": 54667966, "comment_id": 96130616, "body": "OK, add a comment addressed to me after you&#39;ve posted usable data, and I&#39;ll check back."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1550091533, "post_id": 54667966, "comment_id": 96147495, "body": "Also, I note that row 9 does not start with <code>CM</code> yet you show <code>WT</code>.  What is the logic behind that?"}], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 0, "last_activity_date": 1550586599, "last_edit_date": 1550586599, "creation_date": 1550061637, "answer_id": 54670451, "question_id": 54667966, "link": "https://stackoverflow.com/questions/54667966/vba-excel-how-to-copy-characters-from-a-cell-to-another/54670451#54670451", "title": "vba excel: how to copy characters from a cell to another", "body": "<p>I think this will help you:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim LastrowA As Long, i As Long, AppearA As Long, AppearB As Long\n    Dim strA As String, strB As String\n\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        LastrowA = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n        For i = 1 To LastrowA\n\n            strA = .Range(\"A\" &amp; i).Value\n            strB = .Range(\"C\" &amp; i).Value\n\n            'Check if strA appears in strB\n            AppearA = InStr(1, strB, strA)\n            If AppearA &gt; 0 Then\n                .Range(\"B\" &amp; i).Value = strA\n                Exit For\n            End If\n\n            'Check if strB appears in strA\n            AppearB = InStr(1, strA, strB)\n            If AppearB &gt; 0 Then\n                .Range(\"B\" &amp; i).Value = strB\n                Exit For\n            End If\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>Thank you so much for help. \n  after few days i've found solution for problem in my question.\n  infact, this is my solution and I hope to be good for helping anyone need something like this.</p>\n</blockquote>\n\n<pre><code>Sub AssociazioneRotabiliPerPivot()\n\nDim LastrowA, LastrowC As Long, i, j As Long, AppearA As Long, AppearB As Long\nDim strA As String, strB As String\n\nWith ThisWorkbook.Worksheets(\"sheet1\")\n\n    LastrowA = .Cells(.Rows.count, \"A\").End(xlUp).Row\n    LastrowC = .Cells(.Rows.count, \"C\").End(xlUp).Row\n\n    For j = 1 To LastrowC   \n\n        For i = 1 To LastrowA   \n\n            strA = .Range(\"A\" &amp; i).Value\n            strB = .Range(\"C\" &amp; j).Value\n\n            AppearC = InStr(1, strA, strB)\n            If AppearB &gt; 0 Then\n                .Range(\"B\" &amp; i).Value = strB\n            End If\n\n            If (InStr(1, strA, \"CM\") Or InStr(1, strA, \"C4551R\")) &gt; 0 Then\n\n                .Range(\"B\" &amp; i).Value = \"WT\"   \n\n            ElseIf InStr(1, strA, \"ETR425\") &gt; 0 Then   \n\n                .Range(\"B\" &amp; i).Value = \"JAZZ\"  \n\n            End If\n\n        Next i\n\n    Next j\n\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 7, "user_id": 10608784, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JqKyUjORink/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAM6ODzuujINOlwUCuey8JpT9gPvQ/mo/photo.jpg?sz=128", "display_name": "ANTONIO SAVIO RANIERI", "link": "https://stackoverflow.com/users/10608784/antonio-savio-ranieri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 329, "favorite_count": 1, "accepted_answer_id": 54670451, "answer_count": 1, "score": -5, "last_activity_date": 1550586599, "creation_date": 1550053840, "last_edit_date": 1550064641, "question_id": 54667966, "link": "https://stackoverflow.com/questions/54667966/vba-excel-how-to-copy-characters-from-a-cell-to-another", "title": "vba excel: how to copy characters from a cell to another", "body": "<p>I'm new in VBA world and I'm learning by your suggestions.</p>\n\n<p>I've looked for several solutions, tried them but they were't ideal for my problem.</p>\n\n<p>Here are the links</p>\n\n<p><a href=\"https://stackoverflow.com/questions/10904012/find-a-string-within-a-cell-using-vba\">Find a string within a cell using VBA</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/21371817/how-to-count-the-number-of-a-specific-character-in-a-cell-with-excel-vba\">How to Count the Number of a Specific Character in a Cell with Excel VBA\n</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/1725089/which-command-in-vba-can-count-the-number-of-characters-in-a-string-variable\">Which command in VBA can count the number of characters in a string variable?</a></p>\n\n<p>What I need is the possibility to check the characters in<code>Input</code> and match with <code>Match list key</code>. After matched the string, copy the characters I in output. </p>\n\n<p><a href=\"https://i.stack.imgur.com/3xbIa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3xbIa.png\" alt=\"Here and example in sheet\"></a></p>\n\n<p>As you can see, first rows are simple to match but in <code>A8</code> cell (for example)  there is a string with fourteen characters.\nIn this case I need that, when there is a string that begin with CMXXAB, the match is with WT (ALWAYS!). \nThe same thing happen when we have A12: it begins with ETRxxx and, after match will begin in output like JAZZ.</p>\n"}, {"tags": ["excel", "vba", "web-scraping"], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1550055980, "creation_date": 1550055980, "answer_id": 54668715, "question_id": 54667280, "link": "https://stackoverflow.com/questions/54667280/excel-vba-translate-ie-document-empty/54668715#54668715", "title": "Excel vba Translate IE.Document empty", "body": "<p>Use a proper page wait. I also use a different element selector</p>\n\n<pre><code>Option Explicit\nPublic Sub GetTranslation()\n    Dim ie As New InternetExplorer, ws As Worksheet\n    Dim inputString As String, outputString As String, text_to_convert As String, translation As String\n    inputString = \"en\"\n    outputString = \"da\"\n    text_to_convert = \"Banana\"\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    With ie\n        .Visible = True\n        .Navigate2 \"https://translate.google.com/#\" &amp; inputString &amp; \"/\" &amp; outputString &amp; \"/\" &amp; text_to_convert\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n        translation = ie.document.querySelector(\".translation\").innerText\n        ws.Cells(1, 1) = translation\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10943648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oTrwSkNuACw/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbvD7N5H9iZFn2Rmp_9kSJvhlDq2A/mo/photo.jpg?sz=128", "display_name": "Esben Jensen", "link": "https://stackoverflow.com/users/10943648/esben-jensen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "accepted_answer_id": 54668715, "answer_count": 1, "score": 1, "last_activity_date": 1550055997, "creation_date": 1550051907, "last_edit_date": 1550055997, "question_id": 54667280, "link": "https://stackoverflow.com/questions/54667280/excel-vba-translate-ie-document-empty", "title": "Excel vba Translate IE.Document empty", "body": "<p>This is a VBA script i am using to translate fields in a excell sheet.\nThe problem is that the script works for me about 2 3 month ago, but now the IE.Document is empty after translating. \nThe page comes up with correct translation but i can't get the result inside my excel sheet</p>\n\n<pre><code>inputstring = \"en\"\noutputstring = \"da\"\ntext_to_convert = str\n\n'open website\n\nIE.Visible = True\nIE.navigate \"https://translate.google.com/#\" &amp; inputstring &amp; \"/\" &amp; outputstring &amp; \"/\" &amp; text_to_convert\n\nDo Until IE.ReadyState = 4\n    DoEvents\nLoop\n\nApplication.Wait (Now + TimeValue(\"0:00:4\"))\n\nDo Until IE.ReadyState = 4\n    DoEvents\nLoop\ntest = IE.Document.getElementById(\"result_box\")\n</code></pre>\n"}, {"tags": ["vba", "jenkins"], "owner": {"reputation": 120, "user_id": 10242972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2edb9ab4ecc8cbb832407cc1e4360a8?s=128&d=identicon&r=PG&f=1", "display_name": "Inbar", "link": "https://stackoverflow.com/users/10242972/inbar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1550565718, "creation_date": 1550051756, "last_edit_date": 1550565718, "question_id": 54667235, "link": "https://stackoverflow.com/questions/54667235/sending-text-file-to-jenkins-via-remote-trigger-from-excel-vba", "title": "Sending text file to Jenkins via remote trigger - from excel (VBA)", "body": "<p>I have a job in Jenkins that accepts a text file parameter.\nBuilds are triggered from an excel macro - and I'm having difficulty understanding how to send the file to Jenkins.</p>\n\n<p>Up until now, what I understood is the following:</p>\n\n<ul>\n<li>the file must be sent in an HTTP POST request, in the body.</li>\n<li>the file must be sent in multipart/form-data format.</li>\n</ul>\n\n<p>What I can't seem to manage to find out:</p>\n\n<ul>\n<li>how exactly do I encode my file to multipart/form-data in VBA?</li>\n<li>how do I send multiple files to Jenkins in the same HTTP POST request?</li>\n</ul>\n\n<p>More information that might be helpful:</p>\n\n<ul>\n<li>I'm using MSXML2.XMLHTTP60. </li>\n<li>The job has other parameters (string, password), so I'm using the format:\n<a href=\"http://server/job/myjob/buildWithParameters?PARAM1=Value1&amp;PARAM2=Value2\" rel=\"nofollow noreferrer\">http://server/job/myjob/buildWithParameters?PARAM1=Value1&amp;PARAM2=Value2</a></li>\n</ul>\n\n<p>Thank you in advance for any help. </p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>After a lot of headeache, I discovered that currently, the option of sending a file parameter via an http POST request is not supported:\n<a href=\"https://issues.jenkins-ci.org/browse/JENKINS-56169\" rel=\"nofollow noreferrer\">https://issues.jenkins-ci.org/browse/JENKINS-56169</a></p>\n\n<p>But it has been opened as a new feature request.</p>\n\n<p>The only option is pretending to be the web browser, and sending an http POST request identical to the one the Jenkins server is expecting to receive.\nThis poses the problem I described in the Jenkins Issue - the server's response doesn't contain the item's location in the queue.</p>\n"}, {"tags": ["excel", "vba", "duplicates"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1550051003, "post_id": 54666871, "comment_id": 96124201, "body": "And what did you find so far researching?"}, {"owner": {"reputation": 3, "user_id": 10319660, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BhsG2ZYM_nM/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPmozqgMuJvq8ft_-opuaFQIBfHcA/mo/photo.jpg?sz=128", "display_name": "Zenek Kredek", "link": "https://stackoverflow.com/users/10319660/zenek-kredek"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1550051721, "post_id": 54666871, "comment_id": 96124677, "body": "I only find macros which delete duplicates from 2 columns, anything with 3 columns. I am not programmer, but I need so much somthing like this."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1550051987, "post_id": 54666871, "comment_id": 96124847, "body": "In that case I&#39;m sorry, but this isn&#39;t a free coding website. People post here when stuck in code/formula&#39;s but in your case I would suggest looking into learning or hiring."}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1550070745, "post_id": 54666871, "comment_id": 96136575, "body": "You could easily record a Macro to do this.  Read the code that the Macro Recorder generates, and you&#39;ll learn a lot from this kind of exercise."}], "answers": [{"comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 3, "user_id": 10319660, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BhsG2ZYM_nM/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPmozqgMuJvq8ft_-opuaFQIBfHcA/mo/photo.jpg?sz=128", "display_name": "Zenek Kredek", "link": "https://stackoverflow.com/users/10319660/zenek-kredek"}, "edited": false, "score": 0, "creation_date": 1550058622, "post_id": 54667252, "comment_id": 96128908, "body": "It worked for me. Why do you think it can&#39;t do the same for you?"}, {"owner": {"reputation": 3, "user_id": 10319660, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BhsG2ZYM_nM/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPmozqgMuJvq8ft_-opuaFQIBfHcA/mo/photo.jpg?sz=128", "display_name": "Zenek Kredek", "link": "https://stackoverflow.com/users/10319660/zenek-kredek"}, "edited": false, "score": 0, "creation_date": 1550064399, "post_id": 54667252, "comment_id": 96132407, "body": "I don&#39;t know why, i use 2010"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 3, "user_id": 10319660, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BhsG2ZYM_nM/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPmozqgMuJvq8ft_-opuaFQIBfHcA/mo/photo.jpg?sz=128", "display_name": "Zenek Kredek", "link": "https://stackoverflow.com/users/10319660/zenek-kredek"}, "edited": false, "score": 0, "creation_date": 1550108929, "post_id": 54667252, "comment_id": 96153050, "body": "I use Excel 2010, too. Did you copy your data to A20:C29? The formula won&#39;t work if they are in A2:C11 unless you tweak the references."}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1550051808, "creation_date": 1550051808, "answer_id": 54667252, "question_id": 54666871, "link": "https://stackoverflow.com/questions/54666871/how-to-delete-combine-duplicates/54667252#54667252", "title": "How to delete combine duplicates", "body": "<p>I entered your sample data in the range A20:C29. Then I created a helper column with the formula below.</p>\n\n<pre><code>=SUMIFS($B$20:$B$29,$A$20:$A$29,$A20,$C$20:$C$29,$C20)\n</code></pre>\n\n<p>Copy the helper column to the Clipboard and PasteSpecial > Values (to replace the formulas with the result values). </p>\n\n<p>Then cut/paste the helper column into column B and <em>Remove Duplicates</em> based on columns A and C.</p>\n"}, {"comments": [{"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 3, "user_id": 10319660, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BhsG2ZYM_nM/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPmozqgMuJvq8ft_-opuaFQIBfHcA/mo/photo.jpg?sz=128", "display_name": "Zenek Kredek", "link": "https://stackoverflow.com/users/10319660/zenek-kredek"}, "edited": false, "score": 0, "creation_date": 1550064330, "post_id": 54669695, "comment_id": 96132358, "body": "Glad to hear that i help."}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 0, "last_activity_date": 1550059156, "creation_date": 1550059156, "answer_id": 54669695, "question_id": 54666871, "link": "https://stackoverflow.com/questions/54666871/how-to-delete-combine-duplicates/54669695#54669695", "title": "How to delete combine duplicates", "body": "<p>Try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim LastrowA As Long, LastrowF, i As Long, y As Long, j As Long\n    Dim Ad_Desc As String\n    Dim Total As Double\n    Dim arr As Variant\n    Dim Exist As Boolean\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        LastrowA = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n        For i = 2 To LastrowA\n            Ad_Desc = .Range(\"A\" &amp; i).Value &amp; \"_\" &amp; .Range(\"C\" &amp; i).Value\n            Total = .Range(\"B\" &amp; i).Value\n\n            If i = 2 Then\n                For y = i + 1 To LastrowA\n                    If .Range(\"A\" &amp; y).Value &amp; \"_\" &amp; .Range(\"C\" &amp; y).Value = Ad_Desc Then\n                        Total = Total + .Range(\"B\" &amp; y).Value\n                    End If\n                Next y\n\n                    LastrowF = .Cells(.Rows.Count, \"F\").End(xlUp).Row\n                    .Range(\"F\" &amp; LastrowF + 1).Value = .Range(\"A\" &amp; i).Value\n                    .Range(\"G\" &amp; LastrowF + 1).Value = Total\n                    .Range(\"H\" &amp; LastrowF + 1).Value = .Range(\"C\" &amp; i).Value\n\n\n                    arr = Array(Ad_Desc)\n\n            Else\n                Exist = False\n                For j = LBound(arr) To UBound(arr)\n                    If arr(j) = Ad_Desc Then\n                        Exist = True\n                        Exit For\n                    Else\n                        Exist = False\n                    End If\n                Next j\n\n                If Exist = False Then\n\n                    For y = i + 1 To LastrowA\n                        If .Range(\"A\" &amp; y).Value &amp; \"_\" &amp; .Range(\"C\" &amp; y).Value = Ad_Desc Then\n                            Total = Total + .Range(\"B\" &amp; y).Value\n                        End If\n                    Next y\n\n                    LastrowF = .Cells(.Rows.Count, \"F\").End(xlUp).Row\n                    .Range(\"F\" &amp; LastrowF + 1).Value = .Range(\"A\" &amp; i).Value\n                    .Range(\"G\" &amp; LastrowF + 1).Value = Total\n                    .Range(\"H\" &amp; LastrowF + 1).Value = .Range(\"C\" &amp; i).Value\n\n                    ReDim Preserve arr(0 To UBound(arr) + 1)\n                        arr(UBound(arr)) = Ad_Desc\n\n                End If\n\n            End If\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>Result:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/KRmkW.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KRmkW.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 10319660, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BhsG2ZYM_nM/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPmozqgMuJvq8ft_-opuaFQIBfHcA/mo/photo.jpg?sz=128", "display_name": "Zenek Kredek", "link": "https://stackoverflow.com/users/10319660/zenek-kredek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 54669695, "answer_count": 2, "score": -2, "last_activity_date": 1550059156, "creation_date": 1550050727, "last_edit_date": 1550052715, "question_id": 54666871, "link": "https://stackoverflow.com/questions/54666871/how-to-delete-combine-duplicates", "title": "How to delete combine duplicates", "body": "<p>i have got problem</p>\n\n<p><a href=\"https://i.stack.imgur.com/mClF5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mClF5.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have to delete duplicates from column 3, but only when column 1 is the same, and sum value duplicates.</p>\n\n<p>Thanks for answers</p>\n"}, {"tags": ["vba", "object", "reference", "set", "copy"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 10899408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/182cc650b61eb43127a0fbd584d409c2?s=128&d=identicon&r=PG&f=1", "display_name": "Charlex", "link": "https://stackoverflow.com/users/10899408/charlex"}, "edited": false, "score": 0, "creation_date": 1550052221, "post_id": 54667151, "comment_id": 96125009, "body": "Thank you for your answer. In my code i have a lot more Properties than just one (x). Is i possible to clone all properties at once?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 33, "user_id": 10899408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/182cc650b61eb43127a0fbd584d409c2?s=128&d=identicon&r=PG&f=1", "display_name": "Charlex", "link": "https://stackoverflow.com/users/10899408/charlex"}, "edited": false, "score": 0, "creation_date": 1550052917, "post_id": 54667151, "comment_id": 96125460, "body": "You will need to be a little fancy, maybe create a dictionary or collection in your class, called <code>Properties</code> and may be iterate through these.  Setting the new collection to be the old, may not work that easy."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 33, "user_id": 10899408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/182cc650b61eb43127a0fbd584d409c2?s=128&d=identicon&r=PG&f=1", "display_name": "Charlex", "link": "https://stackoverflow.com/users/10899408/charlex"}, "edited": false, "score": 0, "creation_date": 1550053180, "post_id": 54667151, "comment_id": 96125628, "body": "@Charlex  I&#39;ve added a quick attempt"}, {"owner": {"reputation": 33, "user_id": 10899408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/182cc650b61eb43127a0fbd584d409c2?s=128&d=identicon&r=PG&f=1", "display_name": "Charlex", "link": "https://stackoverflow.com/users/10899408/charlex"}, "edited": false, "score": 0, "creation_date": 1550056687, "post_id": 54667151, "comment_id": 96127802, "body": "That answered my question, thank you for this solution.That answered my question, thank you for this solution."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1550058494, "post_id": 54667151, "comment_id": 96128845, "body": "So pretty much, following this pattern, every object could set its own properties? E.g., <code>o2.Set_Property &quot;SomeNewProperty&quot;, 19999</code>. This does not look close to OOP."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 2, "last_activity_date": 1550053163, "last_edit_date": 1550053163, "creation_date": 1550051513, "answer_id": 54667151, "question_id": 54666843, "link": "https://stackoverflow.com/questions/54666843/copy-an-object-without-reference-in-vba/54667151#54667151", "title": "Copy an object without reference in VBA", "body": "<p>You could add a <code>clone</code> method to the class, so I have</p>\n\n<p>My class</p>\n\n<pre><code>Public x As Integer\n\nPublic Function Clone() As Class1\n    Set Clone = New Class1\n    Clone.x = x\nEnd Function\n</code></pre>\n\n<p>My module</p>\n\n<pre><code>Sub a()\n\nDim o As Class1\nDim o2 As Class1\n\nSet o = New Class1\no.x = 20\n\nSet o2 = o.Clone\no2.x = 500\n\nDebug.Print o.x, o2.x\n\nEnd Sub\n</code></pre>\n\n<p>-------------------   COPY ALLL AT ONCE IDEA ---------------------</p>\n\n<p>New class</p>\n\n<pre><code>Public Properties_ As Scripting.Dictionary\n\nPrivate Sub Class_Initialize()\n    Set Properties_ = New Scripting.Dictionary\nEnd Sub\n\nPublic Sub Set_Property(strPropertyName As String, varProperty As Variant)\n    If Properties_.Exists(strPropertyName) Then\n        Properties_(strPropertyName) = varProperty\n    Else\n        Properties_.Add strPropertyName, varProperty\n    End If\nEnd Sub\n\nPublic Function Clone_() As Class1\n\n    Set Clone_ = New Class1\n\n    For i = 0 To Properties_.Count - 1\n        Clone_.Set_Property CStr(Properties_.Keys()(i)), Properties_.Items()(i)\n\n    Next i\n\nEnd Function\n</code></pre>\n\n<p>New Module</p>\n\n<pre><code>Public Sub x()\n\nDim o1 As Class1\nDim o2 As Class1\n\nSet o1 = New Class1\n\no1.Set_Property \"Date\", Now\no1.Set_Property \"Name\", \"Test Name\"\n\nSet o2 = o1.Clone_\n\no2.Set_Property \"Date\", DateSerial(2000, 1, 1)\n\nDebug.Print o1.Properties_(\"Date\"), o2.Properties_(\"Date\")\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 10899408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/182cc650b61eb43127a0fbd584d409c2?s=128&d=identicon&r=PG&f=1", "display_name": "Charlex", "link": "https://stackoverflow.com/users/10899408/charlex"}, "edited": false, "score": 1, "creation_date": 1550056161, "post_id": 54668341, "comment_id": 96127489, "body": "Exactly what i needed, thank you! Unfortunately VBA itself does not provide something like an argument where you just say &quot;Reference = True/False&quot;"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 33, "user_id": 10899408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/182cc650b61eb43127a0fbd584d409c2?s=128&d=identicon&r=PG&f=1", "display_name": "Charlex", "link": "https://stackoverflow.com/users/10899408/charlex"}, "edited": false, "score": 0, "creation_date": 1550056247, "post_id": 54668341, "comment_id": 96127539, "body": "@Charlex - welcome. VBA does not have a lot of things, but one may always build them. It is funnier this way! :D"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1550056593, "last_edit_date": 1550056593, "creation_date": 1550054840, "answer_id": 54668341, "question_id": 54666843, "link": "https://stackoverflow.com/questions/54666843/copy-an-object-without-reference-in-vba/54668341#54668341", "title": "Copy an object without reference in VBA", "body": "<p><a href=\"https://stackoverflow.com/a/4805812/5448626\">This answer about VB6 is pretty good</a>, the implementation of the <a href=\"https://en.wikipedia.org/wiki/Memento_pattern\" rel=\"nofollow noreferrer\">memento pattern</a> and the way to refer to the properties through a type in VBA is what achieves the copying of the properties.</p>\n\n<hr>\n\n<p>An object of type Employee with properties <code>Salary</code>, <code>Age</code> and <code>RelevantExperience</code> is created. Then a new object, copying the old one with the function <code>.Copy</code> is created. The new object initially has the same properties, but we may choose to change some of them. In the code below the <strong>Experience</strong> and the <strong>Age</strong> is changed, the <strong>Salary</strong> is not mentioned, thus it stays the same:</p>\n\n<pre><code>Dim newEmp As Employee\nDim oldEmp As Employee\n\nSet newEmp = New Employee\nWith newEmp\n    .Salary = 100\n    .Age = 22\n    .RelevantExperience = 1\nEnd With\n\nSet oldEmp = newEmp.Copy\nWith oldEmp\n    'Salary is the same as in the NewEmp\n    .Age = 99\n    .RelevantExperience = 10\nEnd With\n</code></pre>\n\n<p>This is the result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/dasae.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dasae.png\" alt=\"enter image description here\"></a></p>\n\n<p>The old Employee has the same salary, \"inherited\" by the new employee, when he is copied. The Experience and the Age are different.</p>\n\n<p><strong>Full implementation</strong></p>\n\n<p>In a module:</p>\n\n<pre><code>Type MyMemento\n    Salary As Double\n    Age As Long\n    RelevantExperience As Long\nEnd Type\n\nSub Main()\n\n    Dim newEmp As Employee\n    Dim oldEmp As Employee\n\n    Set newEmp = New Employee\n    With newEmp\n        .Salary = 100\n        .Age = 22\n        .RelevantExperience = 1\n    End With\n\n    Set oldEmp = newEmp.Copy\n    With oldEmp\n        'Salary is inherited, thus the same\n        .Age = 99\n        .RelevantExperience = 10\n    End With\n\n    Debug.Print \"Salary\"; vbCrLf; newEmp.Salary, oldEmp.Salary\n    Debug.Print \"Experience\"; vbCrLf; newEmp.RelevantExperience, oldEmp.RelevantExperience\n    Debug.Print \"Age\"; vbTab; vbCrLf; newEmp.Age, oldEmp.Age\n\nEnd Sub\n</code></pre>\n\n<p>In a class module, called <code>Employee</code>:</p>\n\n<pre><code>Private Memento As MyMemento\n\nFriend Sub SetMemento(NewMemento As MyMemento)\n    Memento = NewMemento\nEnd Sub\n\nPublic Function Copy() As Employee\n    Dim Result As Employee\n    Set Result = New Employee        \n    Result.SetMemento Memento\n    Set Copy = Result        \nEnd Function\n\nPublic Property Get Salary() As Double\n    Salary = Memento.Salary\nEnd Property    \nPublic Property Let Salary(value As Double)\n    Memento.Salary = value\nEnd Property\n\nPublic Property Get Age() As Long\n    Age = Memento.Age\nEnd Property    \nPublic Property Let Age(value As Long)\n    Memento.Age = value\nEnd Property\n\nPublic Property Get RelevantExperience() As Long\n    RelevantExperience = Memento.RelevantExperience\nEnd Property    \nPublic Property Let RelevantExperience(value As Long)\n    Memento.RelevantExperience = value\nEnd Property\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 10899408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/182cc650b61eb43127a0fbd584d409c2?s=128&d=identicon&r=PG&f=1", "display_name": "Charlex", "link": "https://stackoverflow.com/users/10899408/charlex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1442, "favorite_count": 2, "accepted_answer_id": 54667151, "answer_count": 2, "score": 1, "last_activity_date": 1550056726, "creation_date": 1550050654, "last_edit_date": 1550056726, "question_id": 54666843, "link": "https://stackoverflow.com/questions/54666843/copy-an-object-without-reference-in-vba", "title": "Copy an object without reference in VBA", "body": "<p>I have trouble with Object Variables in VBA. Is it possible to just copy object variables without any reference?</p>\n\n<p>Here the class module \"clstest\"</p>\n\n<pre><code>Option Explicit\n\nPublic x As Single\n</code></pre>\n\n<p>And here is my Sub:</p>\n\n<pre><code>Sub CopyWithoutReference()\n\nDim standard As New clstest\nSet standard = New clstest\n\nDim different As New clstest\n\nstandard.x = 20\n\nSet different = standard\ndifferent.x = 30\n\nMsgBox \"I want standard.x to be 20 and not 30\"\nMsgBox standard.x\nMsgBox different.x\n</code></pre>\n\n<p>I want standard.x to keep its value and not change if different.x changes.\nI read this Article here:\n<a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/set-statement\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/set-statement</a>\nAnd it says: </p>\n\n<p>\"Because such variables are references to the object rather than copies of the object, any change in the object is reflected in all variables that refer to it.\"</p>\n\n<p>But i don't know how to obviate this problem. Anyone of you know how to help me?</p>\n"}, {"tags": ["vba", "loops", "search", "copy", "paste"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1550049992, "post_id": 54666352, "comment_id": 96123521, "body": "<code>range(&quot;a1&quot;).end(xlDown)</code> or <code>cells(rows.count,1).end(xlUp)</code> will be a good start, this goes from A1 to the next blank cell, or from the bottom of column A to the next row.  <code>cl.end(xlDown)</code> maybe for you."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1550050258, "post_id": 54666352, "comment_id": 96123698, "body": "Or even something like so <code>range(&quot;Q36:Q47&quot;).SpecialCells(xlCellTypeBlanks).Cells(1,1).r&zwnj;&#8203;ow</code>"}], "owner": {"reputation": 1, "user_id": 11055394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f99b8f30df110dd8a833d1a339eb738?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/11055394/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550049997, "creation_date": 1550049068, "last_edit_date": 1550049997, "question_id": 54666352, "link": "https://stackoverflow.com/questions/54666352/search-a-colum-for-a-value-copy-the-cell-in-the-previous-colum-and-the-paste-it", "title": "search a colum for a value, copy the cell in the previous colum and the paste it to the first available blank in a range. All on a loop", "body": "<p>So i'm wanting to search column e4:e70.  I want to search for the word \"hol\" and then copy the name from the value from the same row but column before.  I then want to paste this in the first available blank space between range Q36:Q47.  I then want to delete the original data</p>\n\n<p>So I can get it to search the column in a loop, find what it needs to find.  and then clear the contents.  i'm struggling to get it to plave it in the first available space.</p>\n\n<pre><code>   set rng = range(\"e3:e70\")\n   for each cl in range\n   if cl.value=\"hol\" then cl.offset(, -1).clear contents\n   next cl\n</code></pre>\n\n<p>I want to copy the value first and paste it to the first available cell between Q36:Q47 before clearing it from its original cell</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4958, "user_id": 4627262, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iTGZT9YcyLE/AAAAAAAAAAI/AAAAAAAAALU/-5defYeBo50/photo.jpg?sz=128", "display_name": "rrd", "link": "https://stackoverflow.com/users/4627262/rrd"}, "edited": false, "score": 0, "creation_date": 1550049222, "post_id": 54666280, "comment_id": 96123030, "body": "What have you tried so far? Have you found online guides how to do this?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1550049223, "post_id": 54666280, "comment_id": 96123033, "body": "What have you researched, and if so, what part of code are you confused about/do you need help with?"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 11055328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QNnkNQUhgEc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPX6DLRZcwPeyEokdRs8j8__7AXvQ/mo/photo.jpg?sz=128", "display_name": "PathFinder", "link": "https://stackoverflow.com/users/11055328/pathfinder"}, "edited": false, "score": 1, "creation_date": 1550050749, "post_id": 54666597, "comment_id": 96124038, "body": "Thanks a lot    @Error for the help, that worked pretty fine."}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 1, "last_activity_date": 1550050419, "last_edit_date": 1550050419, "creation_date": 1550049903, "answer_id": 54666597, "question_id": 54666280, "link": "https://stackoverflow.com/questions/54666280/vba-create-new-workbook-on-a-specific-directory/54666597#54666597", "title": "VBA: Create New Workbook on a specific Directory", "body": "<pre><code>Option Explicit\n\nSub test()\n\n    Dim Path As String, DocName As String\n\n    Path = \"D:\\SALES_RFQ Database\"\n    DocName = \"M.O Control Number Database\"\n\n    If Dir(Path &amp; \"\\\" &amp; DocName &amp; \".xlsx\") = \"\" Then\n        Workbooks.Add\n        ActiveWorkbook.SaveAs Path &amp; \"\\\" &amp; DocName &amp; \".xlsx\"\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 11055328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QNnkNQUhgEc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPX6DLRZcwPeyEokdRs8j8__7AXvQ/mo/photo.jpg?sz=128", "display_name": "PathFinder", "link": "https://stackoverflow.com/users/11055328/pathfinder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2724, "favorite_count": 1, "accepted_answer_id": 54666597, "answer_count": 1, "score": -1, "last_activity_date": 1550053080, "creation_date": 1550048846, "last_edit_date": 1550053080, "question_id": 54666280, "link": "https://stackoverflow.com/questions/54666280/vba-create-new-workbook-on-a-specific-directory", "title": "VBA: Create New Workbook on a specific Directory", "body": "<p>I would like to create a new workbook on a specific directory using a button from an activeworkbook.</p>\n\n<p>Directory will be Drive D:\\SALES_RFQ Database</p>\n\n<p>WorkBook name is \"M.O Control Number Database\"</p>\n\n<p>Condition:\nThe code has to check if the workbook does exists, if not, if has to create the workbook on the given directory.</p>\n\n<p>Any help with much appreciated.\nThanks in advance</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 398, "user_id": 1568996, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e626621d7b6054a4f491fc974063d8ae?s=128&d=identicon&r=PG", "display_name": "DeerSpotter", "link": "https://stackoverflow.com/users/1568996/deerspotter"}, "edited": false, "score": 0, "creation_date": 1586266648, "post_id": 54665987, "comment_id": 108061134, "body": "This is doable, surprised nobody answered you. Did you figure this out yet?"}, {"owner": {"reputation": 398, "user_id": 1568996, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e626621d7b6054a4f491fc974063d8ae?s=128&d=identicon&r=PG", "display_name": "DeerSpotter", "link": "https://stackoverflow.com/users/1568996/deerspotter"}, "edited": false, "score": 0, "creation_date": 1586266705, "post_id": 54665987, "comment_id": 108061175, "body": "This is not a duplicate either lol. Since you are trying to find the most recent file name."}], "owner": {"reputation": 21, "user_id": 6279722, "user_type": "registered", "profile_image": "https://graph.facebook.com/969427799836550/picture?type=large", "display_name": "Nick Doss", "link": "https://stackoverflow.com/users/6279722/nick-doss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "closed_date": 1550048659, "answer_count": 0, "score": 2, "last_activity_date": 1593954263, "creation_date": 1550047928, "last_edit_date": 1593954263, "question_id": 54665987, "link": "https://stackoverflow.com/questions/54665987/access-vba-list-all-files-in-a-folder-and-all-of-its-subfolders", "closed_reason": "Duplicate", "title": "Access VBA List All Files in a folder and all of its subfolders", "body": "<p>Im trying to create some code in Access which will loop through a folder i.e. C:\\Users\\ANON\\LotsofSubFolders and find the most recent file in all of the subfolders that matches a specific name. </p>\n\n<p>For Example, in C:\\Users\\ANON\\Data there is a folder for this 2018, 2019... and inside each 2018 and 2019 there is another folder i.e. Jan, Feb, etc. \nI want to be able to find the most recent file named \"FindFile_1.xlsx\".</p>\n\n<p>Example File Paths:\nC:\\Users\\ANON\\Data\\2019\\Jan\\FindFile_1.xlsx\nC:\\Users\\ANON\\Data\\2019\\Feb\\FindFile_1.xlsx\nC:\\Users\\ANON\\Data\\2018\\Dec\\FindFile_1.xlsx</p>\n\n<p>I have been able to use the following script to find the first subfolder i.e. 2018 or 2019, however it does not go down the next level and so on. </p>\n\n<pre><code>Sub GetSubFolderNames()\nDim MyFSO As FileSystemObject\nDim MyFile As File\nDim MyFolder As Folder\nDim MySubFolder As Folder\n\nSet MyFSO = New Scripting.FileSystemObject\nSet MyFolder = MyFSO.GetFolder(\"C:\\Users\\sumit\\Desktop\\Test\")\n\nFor Each MySubFolder In MyFolder.SubFolders\n    Debug.Print MySubFolder.Name\nNext MySubFolder\n\nEnd Sub\n</code></pre>\n\n<p>Im then faced with the challenge of trying to the find the most recent file named   xxxx once i have all of the subfolders.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1550047976, "post_id": 54665865, "comment_id": 96122320, "body": "You might benefit from reading <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and  <a href=\"https://meta.stackoverflow.com/a/284237/3219613\">Why is \u201cCan someone help me?\u201d not an actual question?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11055273, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vqcXepViV4k/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOejt3fc4tCd5AjLFx29GTlkyNCRw/mo/photo.jpg?sz=128", "display_name": "Javi Caravaggio", "link": "https://stackoverflow.com/users/11055273/javi-caravaggio"}, "edited": false, "score": 0, "creation_date": 1550049664, "post_id": 54666207, "comment_id": 96123309, "body": "Hi error 1004, Many thanks for replying! highly appreciated! However, when I copy your code in VBA and I tried to run it, it does not populate anything in &quot;sheet 2&quot;. It does not show any error message either."}, {"owner": {"reputation": 1, "user_id": 11055273, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vqcXepViV4k/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOejt3fc4tCd5AjLFx29GTlkyNCRw/mo/photo.jpg?sz=128", "display_name": "Javi Caravaggio", "link": "https://stackoverflow.com/users/11055273/javi-caravaggio"}, "edited": false, "score": 0, "creation_date": 1550066695, "post_id": 54666207, "comment_id": 96133887, "body": "I&#180;ve actually managed to create a code that copies all rows with &quot;yes&quot; in E column. See code below:"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1550066882, "last_edit_date": 1550066882, "creation_date": 1550048650, "answer_id": 54666207, "question_id": 54665865, "link": "https://stackoverflow.com/questions/54665865/copy-specific-cells-from-sheet-to-sheet-based-on-condition/54666207#54666207", "title": "Copy specific cells from sheet to sheet based on condition", "body": "<p>Try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim ws1 As Worksheet, ws2 As Worksheet\n    Dim wsRE As Long, i As Long, LastrowC As Long, LastrowE As Long, LastrowF As Long\n\n    'Set ws1\n    Set ws1 = ThisWorkbook.Worksheets(\"Sheet1\")\n    'Set ws2\n    Set ws2 = ThisWorkbook.Worksheets(\"Sheet2\")\n\n    wsRE = ws2.Cells(ws2.Rows.Count, \"E\").End(xlUp).Row\n\n    'Starting from Row 2 - let us assume that their is a header\n    For i = 2 To wsRE\n        'Check if the value in column E is yes\n        If ws2.Range(\"E\" &amp; i).Value = \"Yes\" Then\n            'Find the Last row in Sheet1 Column C\n            LastrowC = ws1.Cells(ws1.Rows.Count, \"C\").End(xlUp).Row\n            'Copy row i, Column A from Sheet 1 and paste it in Sheet 2 after the lastrow in column C\n            ws2.Range(\"A\" &amp; i).Copy ws1.Cells(LastrowC + 1, 3)\n            'Find the Last row in Sheet1 Column E\n            LastrowE = ws1.Cells(ws1.Rows.Count, \"E\").End(xlUp).Row\n            'Copy row i, Column B from Sheet 1 and paste it in Sheet 2 after the lastrow in column E\n            ws2.Range(\"B\" &amp; i).Copy ws1.Cells(LastrowE + 1, 5)\n            'Find the Last row in Sheet1 Column F\n            LastrowF = ws1.Cells(ws1.Rows.Count, \"F\").End(xlUp).Row\n            'Copy row i ,Column C from Sheet 1 and paste it in Sheet 2 after the lastrow in column F\n            ws2.Range(\"C\" &amp; i).Copy ws1.Cells(LastrowF + 1, 6)\n\n        End If\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11055273, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vqcXepViV4k/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOejt3fc4tCd5AjLFx29GTlkyNCRw/mo/photo.jpg?sz=128", "display_name": "Javi Caravaggio", "link": "https://stackoverflow.com/users/11055273/javi-caravaggio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1550066933, "creation_date": 1550047525, "last_edit_date": 1550066933, "question_id": 54665865, "link": "https://stackoverflow.com/questions/54665865/copy-specific-cells-from-sheet-to-sheet-based-on-condition", "title": "Copy specific cells from sheet to sheet based on condition", "body": "<h1>'Sub CopyRowToSheet23()</h1>\n\n<pre><code>Worksheets(\"Sheet2\").Range(\"A2:E1000\").Clear\nDim LastRowSheet1, LastRowSheet2 As Long\nDim i As Long\nApplication.ScreenUpdating = False\nLastRowSheet2 = Worksheets(\"Sheet2\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nSheets(\"Sheet2\").Range(\"A2:E\" &amp; LastRowSheet2).ClearContents\nLastRowSheet1 = Worksheets(\"Sheet1\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nWith Worksheets(\"Sheet1\")\n    For i = 2 To LastRowSheet1 Step 1\n        If Cells(i, \"E\").Value = \"YES\" Then\n            LastRowSheet2 = Worksheets(\"Sheet2\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n            Rows(i).Copy Worksheets(\"Sheet2\").Range(\"A\" &amp; LastRowSheet2 + 1)\n        End If\n    Next i\nEnd With\nApplication.ScreenUpdating = True\nSheet3.Select\n</code></pre>\n\n<p>End Sub'</p>\n\n<p>I\u00b4ve managed to create the code above to get all rows that have \"yes\" in column E. However, I\u00b4m having issues when trying to run the macro in other sheets different than Sheet1. I would like to run it in sheet3 but I haven\u00b4t found why it does not help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1550046482, "post_id": 54665453, "comment_id": 96121512, "body": "Note that because of <code>On Error Resume Next</code> you don&#39;t see the errors (it hides all the messages) but the errors still occur! Remove that line and fix your errors. \u2022 For your issue see also <a href=\"https://support.microsoft.com/en-us/help/2790229/step-by-step-rename-excel-sheet-with-cell-contents-by-using-macro\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/help/2790229/&hellip;</a>"}, {"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1550047349, "post_id": 54665453, "comment_id": 96121960, "body": "Your code is working just fine. I do not get any problem with your code."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1550047369, "post_id": 54665453, "comment_id": 96121971, "body": "If it is not renaming the other sheets then it means that there is no value in cell A2 of those sheets. Physically check by clicking on that cell and checking if there is any value"}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1550047584, "post_id": 54665765, "comment_id": 96122097, "body": "You should <code>Dim i As Long</code> and <code>Rows.Count</code> must start with a dot <code>.Rows.Count</code>."}, {"owner": {"reputation": 5, "user_id": 9949587, "user_type": "registered", "profile_image": "https://graph.facebook.com/1786210741444715/picture?type=large", "display_name": "Shriharsha Hunsur", "link": "https://stackoverflow.com/users/9949587/shriharsha-hunsur"}, "edited": false, "score": 0, "creation_date": 1550047605, "post_id": 54665765, "comment_id": 96122110, "body": "I need one more help for this 1st 3sheets dont change the name from 4th sheet only change the tab names how can i set"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1550050639, "post_id": 54665765, "comment_id": 96123958, "body": "Have in mind that if you try to change sheet name with a name that already exist you will receive an error."}], "tags": [], "owner": {"reputation": 61, "user_id": 10962285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90dc739399ca749dc4fcc10d890e8e04?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey", "link": "https://stackoverflow.com/users/10962285/sergey"}, "is_accepted": true, "score": 0, "last_activity_date": 1550048737, "last_edit_date": 1550048737, "creation_date": 1550047166, "answer_id": 54665765, "question_id": 54665453, "link": "https://stackoverflow.com/questions/54665453/worksheet-tab-name-change-based-on-cell-value/54665765#54665765", "title": "Worksheet Tab name change based on cell value", "body": "<p>Try this macro:</p>\n\n<pre><code>Public Sub ChangeSheetNames()\n    Dim lLastRow As Long\n    With Worksheets(1)\n        lLastRow = .Cells(Rows.Count, 1).End(xlUp).Row\n        For i = 1 To Worksheets.Count\n            If .Cells(i, 1).Value &lt;&gt; \"\" Then Worksheets(i).Name = .Cells(i, 1).Value\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9949587, "user_type": "registered", "profile_image": "https://graph.facebook.com/1786210741444715/picture?type=large", "display_name": "Shriharsha Hunsur", "link": "https://stackoverflow.com/users/9949587/shriharsha-hunsur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 54665765, "answer_count": 1, "score": 0, "last_activity_date": 1550048737, "creation_date": 1550045941, "last_edit_date": 1550046432, "question_id": 54665453, "link": "https://stackoverflow.com/questions/54665453/worksheet-tab-name-change-based-on-cell-value", "title": "Worksheet Tab name change based on cell value", "body": "<p>I want to change the worksheet tab names based on the cell value its changing only in sheet 1 other sheets not changing</p>\n\n<p>nothing</p>\n\n<pre><code>Public Sub ChangeSheetNames()\n    Dim ws As Worksheet\n\n    'lastRow = ws.Cells(Rows.Count, \"A\").End(xlUp).Row\n    'For i = 2 To lastRow\n    On Error Resume Next\n    For Each ws In Worksheets\n    'ws.Tab = ws.Cells(i, 2)\n\n       If ws.Range(\"A2\").Value &lt;&gt; \"\" Then\n          ws.Name = ws.Range(\"A2\").Value\n       End If\n\n    Next ws\nEnd Sub\n</code></pre>\n\n<p>changing only for sheet 1 I need to change min 50 sheets</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 1, "creation_date": 1550044453, "post_id": 54664580, "comment_id": 96120519, "body": "On Windows 10, you could add a line with <code>AppActivate OpenFold</code> and it should bring the File Explorer window on top."}, {"owner": {"reputation": 33, "user_id": 9126536, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AQGoVJMQt4E/AAAAAAAAAAI/AAAAAAAAFR0/pENQiJoZTBM/photo.jpg?sz=128", "display_name": "wee cheng yong", "link": "https://stackoverflow.com/users/9126536/wee-cheng-yong"}, "reply_to_user": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1550044965, "post_id": 54664580, "comment_id": 96120768, "body": "I already try but it show me Invalid procedure call or argument"}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 2, "creation_date": 1550045726, "post_id": 54664580, "comment_id": 96121156, "body": "I don&#39;t mind helping, but looking at your history, I don&#39;t see a single question marked as answered which gives me the impression that you don&#39;t value the help you are receiving from the community. I would ask you kindly to address this issue before going further."}, {"owner": {"reputation": 33, "user_id": 9126536, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AQGoVJMQt4E/AAAAAAAAAAI/AAAAAAAAFR0/pENQiJoZTBM/photo.jpg?sz=128", "display_name": "wee cheng yong", "link": "https://stackoverflow.com/users/9126536/wee-cheng-yong"}, "reply_to_user": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1550222953, "post_id": 54664580, "comment_id": 96198078, "body": "You mine my answers still 0 on my blog ? Maybe I still need to learn more with you all for me can answer and help others on their problem, I will try to do that as I can"}, {"owner": {"reputation": 33, "user_id": 9126536, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AQGoVJMQt4E/AAAAAAAAAAI/AAAAAAAAFR0/pENQiJoZTBM/photo.jpg?sz=128", "display_name": "wee cheng yong", "link": "https://stackoverflow.com/users/9126536/wee-cheng-yong"}, "reply_to_user": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1550223080, "post_id": 54664580, "comment_id": 96198142, "body": "Sorry for late respond as I in very busy for this 2 days"}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1550223943, "post_id": 54664580, "comment_id": 96198680, "body": "I&#39;m talking about <a href=\"https://meta.stackexchange.com/a/5235/372533\">accepting answers</a>"}, {"owner": {"reputation": 33, "user_id": 9126536, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AQGoVJMQt4E/AAAAAAAAAAI/AAAAAAAAFR0/pENQiJoZTBM/photo.jpg?sz=128", "display_name": "wee cheng yong", "link": "https://stackoverflow.com/users/9126536/wee-cheng-yong"}, "reply_to_user": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1550224885, "post_id": 54664580, "comment_id": 96199248, "body": "Ohh I get it , will do that asap after I read and understand you link , thx"}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1565937156, "post_id": 54664580, "comment_id": 101506997, "body": "I just noticed that you did accept accept answers to your previous questions. Are you still looking for an answer to this question?"}], "owner": {"reputation": 33, "user_id": 9126536, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AQGoVJMQt4E/AAAAAAAAAAI/AAAAAAAAFR0/pENQiJoZTBM/photo.jpg?sz=128", "display_name": "wee cheng yong", "link": "https://stackoverflow.com/users/9126536/wee-cheng-yong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 323, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550044032, "creation_date": 1550042295, "last_edit_date": 1550044032, "question_id": 54664580, "link": "https://stackoverflow.com/questions/54664580/check-if-folder-is-open-vba-then-show-it-on-top", "title": "check if folder is open vba then show it on top", "body": "<p>I have found a post and the code on stack overflow about <a href=\"https://stackoverflow.com/a/17097610/9126536\">check if a folder is open (vba)</a>.</p>\n\n<p>How about just show it on top of screen if the folder is already open ?</p>\n\n<pre><code>Sub test1()\n    Dim OpenFold As Variant\n    Dim oShell As Object\n    Dim Wnd As Object\n    Dim strFolder\n\n    OpenFold = \"mysubfolder\"\n    strFolder = \"U:\\myfolder\\\" &amp; OpenFold\n    Set oShell = CreateObject(\"Shell.Application\")\n\n    For Each Wnd In oShell.Windows\n        If Wnd.Name = \"Windows Explorer\" Then\n           If Wnd.Document.Folder.Self.Path = strFolder Then Exit Sub \n        End If\n    Next Wnd\n    Application.ThisWorkbook.FollowHyperlink Address:=strFolder, NewWindow:=True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1550049110, "post_id": 54663301, "comment_id": 96122959, "body": "Make the line <code>sKaz = Array(ChrW(...), ChrW(...), ChrW(...), ...)</code> so that it doesn&#39;t contain any non-latin chars. Also the range <code>For i = LBound(sKaz) To UBound(sLat) </code> set inconsistently."}, {"owner": {"reputation": 21, "user_id": 5840791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8a39551b6051d5e6d9619474852fa7f?s=128&d=identicon&r=PG&f=1", "display_name": "Muravei", "link": "https://stackoverflow.com/users/5840791/muravei"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1550050630, "post_id": 54663301, "comment_id": 96123952, "body": "Thank you! Now, with ChrW, should I use decimal or hexadecimal codes? Which is faster? Which is reliable? In sLat array, should I use ChrW for all latin letters? Would that make the code run faster? And I don&#39;t understand what you meant by &quot;the range ... set inconsistently&quot;. Also, does this code work for any fonts?"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1550051379, "post_id": 54663301, "comment_id": 96124438, "body": "Inconsistently means that lower bound set by one array and upper bound by another. There is no need to use <code>ChrW()</code> for ASCII chars (codes from 32 to 127). Although you may use the arrays of char codes instead of chars. Actually no difference if you use decimal or heximal, since all such constants are coerced to Long or Integer intrinsic type while compilation."}], "owner": {"reputation": 21, "user_id": 5840791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8a39551b6051d5e6d9619474852fa7f?s=128&d=identicon&r=PG&f=1", "display_name": "Muravei", "link": "https://stackoverflow.com/users/5840791/muravei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1550036828, "creation_date": 1550036535, "last_edit_date": 1550036828, "question_id": 54663301, "link": "https://stackoverflow.com/questions/54663301/cyrillic-to-latin-converter-some-characters-are-not-recognized-on-some-compute", "title": "Cyrillic to Latin converter - some characters are not recognized on some computers", "body": "<p>I have a macros in VBA for MS Word 2010. It converts Kazakh letters from cyrillic to latin letters (some with acutes). I'm using it by incorporating it (.docm file) that contains the module with my VBA code into MS Word's global template (normal.dotm). It works fine on my computer and a few others, but on some other computers it fails to convert some of the characters like \"\u0492\" or \"\u04a2\".</p>\n\n<pre><code>Sub KazLat()\n'Replacing All Cyrillic Characters to Latin\nDim i As Integer\nDim sKaz As Variant\nDim sLat As Variant\nDim a As String    \nDim b As String    \na = \"I\" &amp; ChrW(221)    \nb = \"i\" &amp; ChrW(253)    \nDim rDoc As Range    \nSet rDoc = ActiveDocument.Range\n\n'List of Cyrillic Characters    \nsKaz = Array(an array of kazakh letters in cyrillic. I am not showing it here \nbecause it gets corrupted)    \n\n'List of Latin Characters    \nsLat = Array(\"A\", \"a\", ChrW(193), ChrW(225), \"B\", \"b\", \"V\", \"v\", \"G\", \"g\", \nChrW(500), ChrW(501), \"D\", \"d\", \"E\", \"e\", \"Io\", \"io\", \"J\", \"j\", \"Z\", \"z\", \n\"I\", \"i\", \"I\", \"i\", \"K\", \"k\", \"Q\", \"q\", \"L\", \"l\", \"M\", \"m\", \"N\", \"n\", \nChrW(323), ChrW(324), \"O\", \"o\", ChrW(211), ChrW(243), \"P\", \"p\", \"R\", \"r\", \n\"S\", \"s\", \"T\", \"t\", ChrW(221), ChrW(253), \"U\", \"u\", ChrW(218), ChrW(250), \n\"F\", \"f\", \"H\", \"h\", \"H\", \"h\", \"Ts\", \"ts\", \"Ch\", \"ch\", \"Sh\", \"sh\", \"Sh\", \"sh\", \n\"\", \"\", \"Y\", \"y\", \"I\", \"i\", \"\", \"\", \"E\", \"e\", a, b, \"Ia\", \"ia\")    \n\n'No screen update while code is running    \nApplication.ScreenUpdating = False    \nWith rDoc.Find    \n\n'Replacing cyrillic characters to latin characters    \n   .ClearFormatting    \n   .Replacement.ClearFormatting    \n   .Forward = True    \n   .Wrap = wdFindStop    \n   .MatchWildcards = False    \n   .Format = True    \n   .MatchCase = True    \nFor i = LBound(sKaz) To UBound(sLat)    \n   .Text = sKaz(i)    \n   .Replacement.Text = sLat(i)    \n   .Execute Replace:=wdReplaceAll    \nNext i    \nEnd With    \n\n'Updating screen    \nApplication.ScreenUpdating = True    \nEnd Sub    \n</code></pre>\n\n<p>Just need to know what I need to fix in the code so that it works on all computers with MS Word.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1550036201, "post_id": 54663146, "comment_id": 96117028, "body": "Replace the instances of <code>Folder - Name</code> with <code>FolderName</code>. Looks like a typo, or perhaps whatever site you found it on needs to get its act together."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 1, "creation_date": 1550037565, "post_id": 54663146, "comment_id": 96117502, "body": "Or did someone do a edit:find/replace without thinking of all the consequences?"}], "owner": {"reputation": 11, "user_id": 11054491, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--BE0H-VG3EA/AAAAAAAAAAI/AAAAAAAAAAA/VZOEw_62JRQ/photo.jpg?sz=128", "display_name": "Rahul Bettakote", "link": "https://stackoverflow.com/users/11054491/rahul-bettakote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1555477178, "creation_date": 1550035735, "last_edit_date": 1555477178, "question_id": 54663146, "link": "https://stackoverflow.com/questions/54663146/invalid-qualifier-error-on-folder-name-name", "title": "Invalid qualifier error on Folder - Name.Name", "body": "<p>I picked up code online, for getting folder names and size</p>\n\n<p>I get Invalid qualifier error @ \n<code>ThisWorkbook.Sheets(1).Cells(i, 1) = Folder - Name.Name</code></p>\n\n<pre><code>Sub GetFolderSizeDetails()\n\n    Dim FSO As FileSystemObject\n    Dim FolderName As Folder\n\n    'Assign path of folder for which you want it's sub folder list and size\n    RootPath = \"C:\\\"\n    ThisWorkbook.Sheets(1).Range(\"A2:D100\").ClearContents\n\n    'Initialize Variables And Objects\n    i = 1\n    Set FSO = New FileSystemObject\n\n    'Loop to get each Subfolder in the Root Path\n    For Each FolderName In FSO.GetFolder(RootPath).SubFolders\n        i = i + 1\n        ThisWorkbook.Sheets(1).Cells(i, 1) = Folder - Name.Name\n        On Error Resume Next\n        'Folder-Name.Size returns value in Bytes. Thus divided by 1024 to convert in MB\n        ThisWorkbook.Sheets(1).Cells(i, 2) = (Folder - Name.Size / 1024) / 1024\n    Next\n\n    MsgBox \"All folders listed with their size\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 752, "user_id": 9538700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf60807a4c8210fb503d2f875a3299cd?s=128&d=identicon&r=PG", "display_name": "horst", "link": "https://stackoverflow.com/users/9538700/horst"}, "edited": false, "score": 0, "creation_date": 1550035975, "post_id": 54663002, "comment_id": 96116957, "body": "You can check the size of an array with <code>Ubound(Arrayname)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5470475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d86b00190754c9e09916c5fe58e709aa?s=128&d=identicon&r=PG&f=1", "display_name": "dsamorano", "link": "https://stackoverflow.com/users/5470475/dsamorano"}, "edited": false, "score": 0, "creation_date": 1550379199, "post_id": 54664486, "comment_id": 96243681, "body": "Division by zero error userform1.textbox1 = ((rarray(curretpostion)-1 +3 + count) mod count)+1"}, {"owner": {"reputation": 11, "user_id": 5470475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d86b00190754c9e09916c5fe58e709aa?s=128&d=identicon&r=PG&f=1", "display_name": "dsamorano", "link": "https://stackoverflow.com/users/5470475/dsamorano"}, "edited": false, "score": 0, "creation_date": 1550382631, "post_id": 54664486, "comment_id": 96244128, "body": "Division by zero error userform1.textbox1 = ((rarray(currentposition)-1 +3 + count) mod count)+1                                                                                     count = 4    currentposition =1 showing red if click on 3 right should display black if I click on 3 left should display blue"}, {"owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "reply_to_user": {"reputation": 11, "user_id": 5470475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d86b00190754c9e09916c5fe58e709aa?s=128&d=identicon&r=PG&f=1", "display_name": "dsamorano", "link": "https://stackoverflow.com/users/5470475/dsamorano"}, "edited": false, "score": 0, "creation_date": 1550522928, "post_id": 54664486, "comment_id": 96291889, "body": "The only way that you would get a <i>Division by zero</i> error, is if the the second parameter in the Mod function (Count) was 0.  It should actually be a constant value of 4,  Make sure that you have <code>Option Explicit</code> as the first line in the module, to make sure that you&#39;re defining everything and that you don&#39;t have any easy typos.  (Make it default, by selecting Tools--&gt;Options--&gt;Require Variable Declaration)"}, {"owner": {"reputation": 11, "user_id": 5470475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d86b00190754c9e09916c5fe58e709aa?s=128&d=identicon&r=PG&f=1", "display_name": "dsamorano", "link": "https://stackoverflow.com/users/5470475/dsamorano"}, "edited": false, "score": 0, "creation_date": 1550555006, "post_id": 54664486, "comment_id": 96299958, "body": "thanks division by zero is gone but now the 1 to the left button come up with a error -1 for the following code.  if I start with black works till it gets to red then instead of going back to black it give error because its calculating -1 for the array index instead of 3 . Other left buttons 2 or 3 work but they get to red and don&#39;t start over from 3.       colors = Array(&quot;red&quot;, &quot;blue&quot;, &quot;brown&quot;, &quot;black&quot;) ColorIndex = posInArray(UserForm1.TextBox1.Text, colors) Count = UBound(colors) + 1 Index = (ColorIndex + 2 - Count) Mod Count  UserForm1.TextBox1 = colors(Index)"}], "tags": [], "owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "is_accepted": false, "score": 0, "last_activity_date": 1550041908, "creation_date": 1550041908, "answer_id": 54664486, "question_id": 54663002, "link": "https://stackoverflow.com/questions/54663002/excel-vba-step-through-array-with-button-forward-and-backward/54664486#54664486", "title": "Excel vba step through array with button forward and backward", "body": "<p>You've not actually actually using an array that is base 1 are you?  That would be the first mistake.  </p>\n\n<p>If you have 4 values, then </p>\n\n<pre><code>Count = 4\nRedim Colours(Count-1)\n</code></pre>\n\n<p>The array should start at 0, so valid indexes should be 0,1,2,3.</p>\n\n<p>Anyway, what you are looking for is the <code>Mod</code> function.  It basically gives you the remainder after a division operation.  It's very hand in shifting array indexes in the way that you want.</p>\n\n<pre><code>Index = (Index + Offset + Count) Mod Count\n</code></pre>\n\n<p>Using the <code>Mod</code> function will guarantee a value between <code>-Count+1</code> to <code>Count-1</code></p>\n\n<p>Where <code>Offset</code> is any value from <code>-Count</code> to <code>Count</code>.</p>\n\n<p>The <code>+ Count</code> makes sure that you don't actually get any negative values.</p>\n\n<p>If you insist on using an array that starts at base 1 then the formula turns into</p>\n\n<pre><code>Index = ((Index - 1 + Offset + Count) Mod Count) + 1\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5470475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d86b00190754c9e09916c5fe58e709aa?s=128&d=identicon&r=PG&f=1", "display_name": "dsamorano", "link": "https://stackoverflow.com/users/5470475/dsamorano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550041908, "creation_date": 1550034987, "last_edit_date": 1550035504, "question_id": 54663002, "link": "https://stackoverflow.com/questions/54663002/excel-vba-step-through-array-with-button-forward-and-backward", "title": "Excel vba step through array with button forward and backward", "body": "<p>I have a array (red,blue,brown,black) trying to add 6 buttons \"right +3\" and \"left +3\" to userform that displays the array element 4 positions 1 to 4. Example if element 3 is displayed \"brown\", then I click on \"left+3\", the textbox will now display element 4 \"Black\" moves 3 positions left 3,2,1,4. Now if i click on \"right+3\" now it will display \"brown\" so that it moves 3 positions to the right which would be 4, 1, 2, 3.\n I can subtract or add from array position but if im at position 4 and I add 3 i get error because there is no element 7:</p>\n\n<pre><code>MsgBox RARRY(4) + 3\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/lavXD.png\" alt=\"enter image description here\">\n<img src=\"https://i.stack.imgur.com/IBPvO.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "is_accepted": false, "score": 1, "last_activity_date": 1550040023, "last_edit_date": 1550040023, "creation_date": 1550036244, "answer_id": 54663244, "question_id": 54662875, "link": "https://stackoverflow.com/questions/54662875/copying-the-range-and-pasting-it-directly-to-a-txt-file/54663244#54663244", "title": "Copying the range and pasting it directly to a .txt file", "body": "<p>Try this</p>\n\n<pre><code>Option Explicit\n\n'Copy the contents of a worksheet, and save it as a new workbook as a .txt file\nSub Sheet1_Tab()\nDim wbSource As Workbook\nDim wsSource As Worksheet\nDim wbDest As Workbook\nDim fName As String\n\n'References\nSet wbSource = ActiveWorkbook\nSet wsSource = ThisWorkbook.Sheets(\"Sheet1\") 'Change as per your requirement\nSet wbDest = Workbooks.Add\n\n'Copy range on original sheet\n'Assuming your range is contiguous.\nwsSource.UsedRange.Copy\n\n'Save in new workbook\nwbDest.Worksheets(1).Cells(1, 1).PasteSpecial Paste:=xlPasteValuesAndNumberFormats\nApplication.CutCopyMode = False\n\n'Get file name and location\nfName = ThisWorkbook.Path &amp; \"\\Sheet1.txt\"\n\n'Save new tab delimited file\nwbDest.SaveAs fName, xlText\n\nwbDest.Close SaveChanges:=True\n\nEnd Sub\n</code></pre>\n\n<p>You can also use notepad route :</p>\n\n<p>Alternately The following program gets values from a range of cells on a worksheet to copy to clipboard, gets the clipboard content into a string, saves that string to a temp file and then opens <code>Notepad.exe</code> with the content of the temp file</p>\n\n<p>Code:</p>\n\n<pre><code>Option Explicit\n\nSub ThroughNotePadTxt()\n\n    Dim rngDat As Range\n    Dim strData As String\n    Dim strTempFl As String\n\n    ' copy some range values\n    Set rngDat = Sheets(\"Sheet1\").Range(\"A1:G20\")' Change as per your requirement\n    rngDat.Copy\n\n    ' get the clipboard data\n    ' magic code for is for early binding to MSForms.DataObject\n    With CreateObject(\"New:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n        .GetFromClipBoard\n        strData = .GetText\n    End With\n\n    ' write to temp file\n    strTempFl = \"C:\\temp.txt\" 'Change as per your reqirement. Directory to have permission to write the file\n    With CreateObject(\"Scripting.FileSystemObject\")\n        ' true to overwrite existing temp file\n        .CreateTextFile(strTempFl, True).Write strData\n    End With\n\n    ' open notepad with tempfile\n    Shell \"cmd /c \"\"notepad.exe \"\"\" &amp; strTempFl &amp; \"\"\"\", vbHide\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10921212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab68172a627c1865ce3cf3702269e832?s=128&d=identicon&r=PG&f=1", "display_name": "raytk", "link": "https://stackoverflow.com/users/10921212/raytk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1550043950, "creation_date": 1550034255, "last_edit_date": 1550043950, "question_id": 54662875, "link": "https://stackoverflow.com/questions/54662875/copying-the-range-and-pasting-it-directly-to-a-txt-file", "title": "Copying the range and pasting it directly to a .txt file", "body": "<p>I need help on trying to copy a range of data from excel to a new .txt file\nI have gotten to the point of creating a text file but i am stuck in trying to copy the range and pasting it to the .txt file. \nThe format of the data needs to be vertical to enable another program to read it.</p>\n"}, {"tags": ["excel", "vba", "rename", "worksheet"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1550033036, "post_id": 54662637, "comment_id": 96116167, "body": "Is this code in a regular module or in a sheet code module?"}, {"owner": {"reputation": 5, "user_id": 9949587, "user_type": "registered", "profile_image": "https://graph.facebook.com/1786210741444715/picture?type=large", "display_name": "Shriharsha Hunsur", "link": "https://stackoverflow.com/users/9949587/shriharsha-hunsur"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1550033535, "post_id": 54662637, "comment_id": 96116301, "body": "Regular code referred from <a href=\"https://docs.microsoft.com/en-us/office/vba/excel/concepts/workbooks-and-worksheets/name-a-worksheet-by-using-a-cell-value\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/excel/concepts/&hellip;</a>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1550033697, "post_id": 54662637, "comment_id": 96116337, "body": "<code>Sub Worksheet_Change</code> is the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.change\" rel=\"nofollow noreferrer\">Worksheet.Change</a> event code and goes in a sheet code module. Right click on the sheet tab, click <i>View Code</i> and paste the code there."}, {"owner": {"reputation": 5, "user_id": 9949587, "user_type": "registered", "profile_image": "https://graph.facebook.com/1786210741444715/picture?type=large", "display_name": "Shriharsha Hunsur", "link": "https://stackoverflow.com/users/9949587/shriharsha-hunsur"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1550034792, "post_id": 54662637, "comment_id": 96116626, "body": "its asking create a macro"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1550070876, "creation_date": 1550070876, "answer_id": 54673482, "question_id": 54662637, "link": "https://stackoverflow.com/questions/54662637/rename-the-worksheet-based-on-excel-cell-value/54673482#54673482", "title": "Rename the worksheet based on excel cell value", "body": "<p>Something like this should do what you want.</p>\n\n<pre><code>Sub RenameSheet()\n\nDim xWs As Worksheet\nDim xRngAddress As String\nDim xName As String\nxRngAddress = Application.ActiveCell.Address\nFor Each xWs In Application.ActiveWorkbook.Sheets\n    xName = xWs.Range(xRngAddress).Value\n    If xName &lt;&gt; \"\" Then\n        xWs.Name = xName\n    End If\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9949587, "user_type": "registered", "profile_image": "https://graph.facebook.com/1786210741444715/picture?type=large", "display_name": "Shriharsha Hunsur", "link": "https://stackoverflow.com/users/9949587/shriharsha-hunsur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 280, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550070876, "creation_date": 1550032871, "last_edit_date": 1550032960, "question_id": 54662637, "link": "https://stackoverflow.com/questions/54662637/rename-the-worksheet-based-on-excel-cell-value", "title": "Rename the worksheet based on excel cell value", "body": "<p>I try to change the worksheet tab name based excel cell value but when i try to run the code its asking create a macro please help</p>\n\n<p>I created one more sub but not workd</p>\n\n<pre><code>Sub Worksheet_Change(ByVal Target As Range)\n    'Specify the target cell whose entry shall be the sheet tab name.\n    If Target.Address &lt;&gt; \"$A$2\" Then Exit Sub\n        'If the target cell is empty (contents cleared) then do not change the shet name\n    If IsEmpty(Target) Then Exit Sub\n\n    'If the length of the target cell's entry is greater than 31 characters, disallow the entry.\n    If Len(Target.Value) &gt; 21 Then\n        MsgBox \"Worksheet tab names cannot be greater than 31 characters in length.\" &amp; vbCrLf &amp; _\n        \"You entered \" &amp; Target.Value &amp; \", which has \" &amp; Len(Target.Value) &amp; \" characters.\", , \"Keep it under 21 characters\"\n        Application.EnableEvents = False\n        Target.ClearContents\n        Application.EnableEvents = True\n        Exit Sub\n    End If\n\n    'Sheet tab names cannot contain the characters /, \\, [, ], *, ?, or :.\n    'Verify that none of these characters are present in the cell's entry.\n    Dim IllegalCharacter(1 To 7) As String, i As Integer\n    IllegalCharacter(1) = \"/\"\n    IllegalCharacter(2) = \"\\\"\n    IllegalCharacter(3) = \"[\"\n    IllegalCharacter(4) = \"]\"\n    IllegalCharacter(5) = \"*\"\n    IllegalCharacter(6) = \"?\"\n    IllegalCharacter(7) = \":\"\n    For i = 1 To 7\n        If InStr(Target.Value, (IllegalCharacter(i))) &gt; 0 Then\n            MsgBox \"You used a character that violates sheet naming rules.\" &amp; vbCrLf &amp; vbCrLf &amp; _\n            \"Please re-enter a sheet name without the ''\" &amp; IllegalCharacter(i) &amp; \"'' character.\", 48, \"Not a possible sheet name !!\"\n            Application.EnableEvents = False\n            Target.ClearContents\n            Application.EnableEvents = True\n            Exit Sub\n        End If\n    Next i\n\n    'Verify that the proposed sheet name does not already exist in the workbook.\n    Dim strSheetName As String, wks As Worksheet, bln As Boolean\n    strSheetName = Trim(Target.Value)\n    On Error Resume Next\n    Set wks = ActiveWorkbook.Worksheets(strSheetName)\n    On Error Resume Next\n    If Not wks Is Nothing Then\n        bln = True\n    Else\n        bln = False\n        Err.Clear\n    End If\n\n    'If the worksheet name does not already exist, name the active sheet as the target cell value.\n    'Otherwise, advise the user that duplicate sheet names are not allowed.\n    If bln = False Then\n        ActiveSheet.Name = strSheetName\n    Else\n        MsgBox \"There is already a sheet named \" &amp; strSheetName &amp; \".\" &amp; vbCrLf &amp; _\n        \"Please enter a unique name for this sheet.\"\n        Application.EnableEvents = False\n        Target.ClearContents\n        Application.EnableEvents = True\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "performance", "copy"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1550032805, "post_id": 54662491, "comment_id": 96116124, "body": "If you step through with <code>F8</code>, can you isolate which line causes the crash?"}, {"owner": {"reputation": 45, "user_id": 10097577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b874019a90f4f51a0e4e89ebc64a193f?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Roy", "link": "https://stackoverflow.com/users/10097577/daniel-roy"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1550033308, "post_id": 54662491, "comment_id": 96116239, "body": "it wants to flag at the Windows(&quot;PrimeCost.xlsm&quot;).Activate part"}, {"owner": {"reputation": 752, "user_id": 9538700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf60807a4c8210fb503d2f875a3299cd?s=128&d=identicon&r=PG", "display_name": "horst", "link": "https://stackoverflow.com/users/9538700/horst"}, "edited": false, "score": 0, "creation_date": 1550035587, "post_id": 54662491, "comment_id": 96116843, "body": "<a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": false, "score": 0, "last_activity_date": 1550042699, "creation_date": 1550042699, "answer_id": 54664685, "question_id": 54662491, "link": "https://stackoverflow.com/questions/54662491/why-does-this-sheet-array-code-cause-a-system-crash/54664685#54664685", "title": "Why does this sheet array code cause a system crash?", "body": "<p>As commented by @Bigben and @horst may try simple loop approach </p>\n\n<pre><code>    Sub TransAll()\n    Dim Wb1 As Workbook, Wb2 As Workbook, Wb3 As Workbook\n    'Dim Ws As Worksheets\n    Dim Arr1 As Variant, Arr2 As Variant, i As Integer\n    Arr1 = Array(\"Invoice Log\", \"Beer Inventory\", \"Liquor Inventory\", \"Wine Inventory\", \"Food Inventory\", \"Other Inventory\", \"Transfer Worksheet\")\n    Arr2 = Array(\"Sales\", \"Labor\", \"Cost of Sales\", \"Prime Cost\")\n\n    Set Wb1 = Workbooks(\"Inventory.xlsm\")\n    Set Wb2 = Workbooks(\"PrimeCost.xlsm\")\n    Set Wb3 = Workbooks(\"TransManager.xlsm\")\n\n    'suggest not to operating on all three excel file open at a time. \n    'instead of above three lines may try commented out code to optimize use of \n    'system resources. if your requirement permits, try copying one file at a time.\n\n    'Set Wb1 = Workbooks.Open(\"C:\\users\\user\\Desktop\\Inventory.xlsm\")\n    'Set Wb3 = Workbooks.Open(\"C:\\users\\user\\Desktop\\TransManager.xlsm\")\n\n    Application.Calculation = xlCalculationManual\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    Application.EnableEvents = False\n\n        For i = LBound(Arr1) To UBound(Arr1)\n        Wb1.Worksheets(Arr1(i)).Copy Before:=Wb3.Sheets(1)\n        Next i\n        ' also suggest to close wb1 here and open wb2 here\n        'Wb1.Close False\n        'Set Wb2 = Workbooks.Open(\"C:\\users\\user\\Desktop\\PrimeCost.xlsm\")\n\n        For i = LBound(Arr2) To UBound(Arr2)\n        Wb2.Worksheets(Arr2(i)).Copy Before:=Wb3.Sheets(1)\n        Next i\n        'Wb2.Close False\n\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\n    Application.EnableEvents = True\n    Application.Calculation = xlCalculationAutomatic\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 10097577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b874019a90f4f51a0e4e89ebc64a193f?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Roy", "link": "https://stackoverflow.com/users/10097577/daniel-roy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550042699, "creation_date": 1550031959, "question_id": 54662491, "link": "https://stackoverflow.com/questions/54662491/why-does-this-sheet-array-code-cause-a-system-crash", "title": "Why does this sheet array code cause a system crash?", "body": "<p>This code is to pull multiple sheets over and paste into another workbook for saving as a historical file, it keeps causing a system crash though... any ideas?</p>\n\n<pre><code>    Sub TransAll()\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n\n    Windows(\"Inventory.xlsm\").Activate\n    Sheets(Array(\"Invoice Log\", \"Beer Inventory\", \"Liquor Inventory\", \"Wine \n    Inventory\" _\n    , \"Food Inventory\", \"Other Inventory\", \"Transfer Worksheet\")).Select\n    Sheets(Array(\"Invoice Log\", \"Beer Inventory\", \"Liquor Inventory\", \"Wine \n    Inventory\" _\n    , \"Food Inventory\", \"Other Inventory\", \"Transfer Worksheet\")).Copy \n    Before:= _\n    Workbooks(\"TransManager.xlsm\").Sheets(1)\n\n    Windows(\"PrimeCost.xlsm\").Activate\n    Sheets(Array(\"Sales\", \"Labor\", \"Cost of Sales\", \"Prime Cost\")).Select\n    Sheets(Array(\"Prime Cost\", \"Sales\", \"Labor\", \"Cost of Sales\")).Copy \n    Before:= _\n    Workbooks(\"TransManager.xlsm\").Sheets(1)\n\n    Application.DisplayAlerts = True\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 2, "last_activity_date": 1550031403, "creation_date": 1550031403, "answer_id": 54662419, "question_id": 54662343, "link": "https://stackoverflow.com/questions/54662343/getting-row-number-of-a-cell-in-respect-to-a-specified-range/54662419#54662419", "title": "Getting row number of a cell in respect to a specified range", "body": "<p>One option is to adjust based on the number of the first row of <code>rng</code>, using simple math.</p>\n\n<pre><code>rng.Cells(findCell.Row - rng.Row + 1, 2).Value = \"change to something.\"\n</code></pre>\n\n<p>In this case <code>6 - 4 + 1</code> = <code>3</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1550043799, "post_id": 54664860, "comment_id": 96120210, "body": "Instead of <code>.Cells(rng.Row, rng.Column + 1).Value</code> just <code>rng.Offset(0, 1).Value</code> and you must check <code>If Not rng Is Nothing</code> after find otherwise it will fail if nothing is found."}, {"owner": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1550049222, "post_id": 54664860, "comment_id": 96123032, "body": "Isn&#39;t this way taking the &quot;whole&quot; worksheet(used cells in the worksheet) as the range and not the defined range?"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1550049507, "post_id": 54664860, "comment_id": 96123208, "body": "Yes use every used cell. Which range you want to use? with Set rng = ActiveWS.Range(&quot;B4&quot;, &quot;C10&quot;) you indicate that you will use only this to Cells and not from B4 to C10."}, {"owner": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1550049697, "post_id": 54664860, "comment_id": 96123332, "body": "@P\u1d07\u029c Yes, I did realize I could do it using offset as I mentioned in the question. Out of curiosity, I wanted to know if vba had a way to get the row number of a cell from a defined range."}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1550050215, "post_id": 54664860, "comment_id": 96123668, "body": "@DSM see edited answer and hope my notes help you to understand."}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 1, "last_activity_date": 1550050180, "last_edit_date": 1550050180, "creation_date": 1550043458, "answer_id": 54664860, "question_id": 54662343, "link": "https://stackoverflow.com/questions/54662343/getting-row-number-of-a-cell-in-respect-to-a-specified-range/54664860#54664860", "title": "Getting row number of a cell in respect to a specified range", "body": "<p>You can use:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim rng As Range\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        'If your searching area for A,B,C etc is from B4 to B10 just use\n        Set rng = .Range(\"B4:B10\").Cells.Find(what:=\"C\")\n        'If your searching area for A,B,C etc is from B4 to C10 just use\n        Set rng = .Range(\"B4:C10\").Cells.Find(what:=\"C\")\n\n        If Not rng Is Nothing Then\n            'Way 1\n            .Cells(rng.Row, rng.Column + 1).Value = \"change to something.\"\n            'Way 2\n            rng.Offset(0, 1).Value = \"change to something.\"\n        Else\n            MsgBox \"No \"\"C\"\" found.\"\n        End If\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1038, "favorite_count": 0, "accepted_answer_id": 54662419, "answer_count": 2, "score": 1, "last_activity_date": 1550050180, "creation_date": 1550030800, "last_edit_date": 1550043691, "question_id": 54662343, "link": "https://stackoverflow.com/questions/54662343/getting-row-number-of-a-cell-in-respect-to-a-specified-range", "title": "Getting row number of a cell in respect to a specified range", "body": "<p>I am trying to get the row number of a cell in a range that I specify with vba. I want to get the row number of the cell in the range but what I am getting is the row number of the cell in the worksheet.</p>\n\n<p>This is the vba code I am using currently. I have set a range and within the range I search for a cell that contains the text string \"C\". Once I have found the cell I want to make changes to the value in the second column of the range.</p>\n\n<pre><code>Sub trial2()\n\nDim ActiveWB As Workbook\nDim ActiveWS As Worksheet\nDim rng As Range, findCell As Range\n\nSet ActiveWB = ActiveWorkbook\nSet ActiveWS = ActiveWB.ActiveSheet\n\nSet rng = ActiveWS.Range(\"B4\", \"C10\")\n\nWith rng\n    Set findCell = .Cells.Find(what:=\"C\")\nEnd With\n\nrng.Cells(findCell.Row, 2).Value = \"change to something.\"\n\nEnd Sub\n</code></pre>\n\n<p>Before running the code:</p>\n\n<p><a href=\"https://i.stack.imgur.com/goxlc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/goxlc.png\" alt=\"enter image description here\"></a></p>\n\n<p>After running the code:</p>\n\n<p><a href=\"https://i.stack.imgur.com/VCmnK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VCmnK.png\" alt=\"enter image description here\"></a></p>\n\n<p>the cell value that contains \"C\" is in the 6th row of the worksheet, but in the 3rd row of the range. I was wondering how do I get the 3rd row of the range. I am aware that I can just offset the cell by 1 column to solve this problem, but I am curious about getting row numbers of cells in respect to a defined range.</p>\n"}, {"tags": ["excel", "vba", "loops"], "answers": [{"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": true, "score": 1, "last_activity_date": 1550028549, "creation_date": 1550028549, "answer_id": 54662068, "question_id": 54661938, "link": "https://stackoverflow.com/questions/54661938/vba-input-formula-referencing-cell-from-another-dynamic-sheet/54662068#54662068", "title": "vba input formula referencing cell from another dynamic sheet", "body": "<p>Try <code>sht2.Range(\"D\" &amp; (row)).Formula = \"= '\" &amp; sht1.Name &amp; \"'!\" &amp; \"N876\"</code></p>\n"}], "owner": {"reputation": 55, "user_id": 9422609, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "chan hong chon", "link": "https://stackoverflow.com/users/9422609/chan-hong-chon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13, "favorite_count": 0, "accepted_answer_id": 54662068, "answer_count": 1, "score": 0, "last_activity_date": 1550028549, "creation_date": 1550027614, "question_id": 54661938, "link": "https://stackoverflow.com/questions/54661938/vba-input-formula-referencing-cell-from-another-dynamic-sheet", "title": "vba input formula referencing cell from another dynamic sheet", "body": "<p>I am trying to input formula into cells based on the month of the year. \nThe problem I am facing now is that the same string that is used to name the sheet is not able to be populated nicely into the formula.\nwhat I am getting is <code>=Jan-'19'!N876</code> instead of <code>='Jan-19'!N876</code> in the cell.\nAppreciate if anyone could help with that.\nThanks!</p>\n\n<pre><code>Sub Summary()\n\nDim wb As Workbook\nDim sht1 As Worksheet\nDim sht2 As Worksheet\nDim row As String\nDim newmth As String\nnewmth = Format(DateAdd(\"m\", -1, Date), \"mmm-yy\")\n\nrow = 4\nSet wb = ThisWorkbook\nSet sht1 = wb.Sheets(newmth)\nSet sht2 = wb.Sheets(\"Summary\")\n\nApplication.ScreenUpdating = False\n\nDo While sht2.Range(\"B\" &amp; (row)) &lt;&gt; \"\"\n\nIf sht2.Range(\"B\" &amp; (row)).Text = newmth Then\n\nsht2.Range(\"D\" &amp; (row)).Formula = \"=\" &amp; sht1.Name &amp; \"!\" &amp; \"N876\"\n\nEnd If\nrow = row + 1\nLoop\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1550098727, "post_id": 54661270, "comment_id": 96150384, "body": "<i>has two main issues:</i> ... create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can help you solve <b>one specific problem</b>"}, {"owner": {"reputation": 15, "user_id": 10819615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb2de14518ba082ca5aaf28ad6ce6c6?s=128&d=identicon&r=PG&f=1", "display_name": "DJSingh", "link": "https://stackoverflow.com/users/10819615/djsingh"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1550118434, "post_id": 54661270, "comment_id": 96155042, "body": "@ScottHoltzman thanks for your guidance. Is there any way to edit this one or should I create new post?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1550161739, "post_id": 54661270, "comment_id": 96177394, "body": "You can <a href=\"https://stackoverflow.com/posts/54661270/edit\">edit</a> by clicking on edit above or the link I made for you."}, {"owner": {"reputation": 15, "user_id": 10819615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb2de14518ba082ca5aaf28ad6ce6c6?s=128&d=identicon&r=PG&f=1", "display_name": "DJSingh", "link": "https://stackoverflow.com/users/10819615/djsingh"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1550203572, "post_id": 54661270, "comment_id": 96191314, "body": "@ScottHoltzman: Hopefully, now the issue is more clear."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10819615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb2de14518ba082ca5aaf28ad6ce6c6?s=128&d=identicon&r=PG&f=1", "display_name": "DJSingh", "link": "https://stackoverflow.com/users/10819615/djsingh"}, "edited": false, "score": 0, "creation_date": 1551315450, "post_id": 54877923, "comment_id": 96599681, "body": "I am getting an error. Run-time error \u2018287\u2019 Application-defined or object-defined error. In the class module, SearchString = urn:schemas:httpmail:subject like &#39;Mid-Year Report&#39;&quot; So it is searching for subject. outlookSearch = &quot;Search Tag&quot; but then it just keep looping over the While Loop and then I get an error."}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "reply_to_user": {"reputation": 15, "user_id": 10819615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb2de14518ba082ca5aaf28ad6ce6c6?s=128&d=identicon&r=PG&f=1", "display_name": "DJSingh", "link": "https://stackoverflow.com/users/10819615/djsingh"}, "edited": false, "score": 0, "creation_date": 1551315552, "post_id": 54877923, "comment_id": 96599700, "body": "Just to be sure, a reference to the Microsoft Outlook library is required. Have you add it in the VBE?"}, {"owner": {"reputation": 15, "user_id": 10819615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb2de14518ba082ca5aaf28ad6ce6c6?s=128&d=identicon&r=PG&f=1", "display_name": "DJSingh", "link": "https://stackoverflow.com/users/10819615/djsingh"}, "edited": false, "score": 0, "creation_date": 1551315882, "post_id": 54877923, "comment_id": 96599768, "body": "Yes I did. Microsoft Outlook 15.0 Object Library is checked."}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "reply_to_user": {"reputation": 15, "user_id": 10819615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb2de14518ba082ca5aaf28ad6ce6c6?s=128&d=identicon&r=PG&f=1", "display_name": "DJSingh", "link": "https://stackoverflow.com/users/10819615/djsingh"}, "edited": false, "score": 0, "creation_date": 1551315976, "post_id": 54877923, "comment_id": 96599788, "body": "Please set a break point at that line and try to run the code so we can make sure that&#39;s the line that is raising the error"}, {"owner": {"reputation": 15, "user_id": 10819615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb2de14518ba082ca5aaf28ad6ce6c6?s=128&d=identicon&r=PG&f=1", "display_name": "DJSingh", "link": "https://stackoverflow.com/users/10819615/djsingh"}, "edited": false, "score": 0, "creation_date": 1551317597, "post_id": 54877923, "comment_id": 96600169, "body": "Thanks. I commented the line &quot;customMailItem.Body = &quot;Just a reply text &quot; &amp; customMailItem.Body&quot; then the code was working. I do not know why this line is giving an error. Also, right now the code searches for only inbox and sent items. How do I search for all the folders in inbox. I have like 50 subfolders in inbox."}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "reply_to_user": {"reputation": 15, "user_id": 10819615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb2de14518ba082ca5aaf28ad6ce6c6?s=128&d=identicon&r=PG&f=1", "display_name": "DJSingh", "link": "https://stackoverflow.com/users/10819615/djsingh"}, "edited": false, "score": 0, "creation_date": 1551318470, "post_id": 54877923, "comment_id": 96600327, "body": "Sorry my bad. In my testing I left the searchsubfolders to false. Change the false to true in this line: Call oOutlook.SearchAndReply(subjectCell.Value, searchFolderName, False)"}, {"owner": {"reputation": 15, "user_id": 10819615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb2de14518ba082ca5aaf28ad6ce6c6?s=128&d=identicon&r=PG&f=1", "display_name": "DJSingh", "link": "https://stackoverflow.com/users/10819615/djsingh"}, "edited": false, "score": 0, "creation_date": 1551323309, "post_id": 54877923, "comment_id": 96601375, "body": "Awesome thanks!.. this works. Also when removed &quot;&amp; customMailItem.Body&quot; from the commented line, i.e. from &quot;customMailItem.Body = &quot;Just a reply text &quot; &amp; customMailItem.Body&quot; to &quot;customMailItem.Body = &quot;Just a reply text &quot; &quot;. This line works, However, the body of the reply contains only &quot;Just a reply text&quot; and email chain below is deleted. Is there any way I can retain the email chain while including text for new email?"}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "reply_to_user": {"reputation": 15, "user_id": 10819615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb2de14518ba082ca5aaf28ad6ce6c6?s=128&d=identicon&r=PG&f=1", "display_name": "DJSingh", "link": "https://stackoverflow.com/users/10819615/djsingh"}, "edited": false, "score": 0, "creation_date": 1551323442, "post_id": 54877923, "comment_id": 96601408, "body": "Great! Please consider marking this answer. Regarding the final question, this part is the one to keep the original email:  &amp; customMailItem.Body There must be an special email/case that is raising the error. you could add an error handler"}, {"owner": {"reputation": 15, "user_id": 10819615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb2de14518ba082ca5aaf28ad6ce6c6?s=128&d=identicon&r=PG&f=1", "display_name": "DJSingh", "link": "https://stackoverflow.com/users/10819615/djsingh"}, "edited": false, "score": 0, "creation_date": 1551323698, "post_id": 54877923, "comment_id": 96601466, "body": "Thanks a ton.  You saved me a lot of time. :) I am not able to mark the answer +1 but can only make the check mark green which I already did."}], "tags": [], "owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "is_accepted": true, "score": 0, "last_activity_date": 1551150964, "creation_date": 1551150964, "answer_id": 54877923, "question_id": 54661270, "link": "https://stackoverflow.com/questions/54661270/search-by-subject-for-latest-email-in-all-folders-and-reply-all/54877923#54877923", "title": "Search by subject for latest email in all folders and reply all", "body": "<p>I have tested the code below and even though you can polish it, should get you started.</p>\n\n<p>Let me know and mark the answer if it helps.</p>\n\n<p>Add in a vba module this code:</p>\n\n<pre><code>Public Sub ProcessEmails()\n\n    Dim testOutlook As Object\n    Dim oOutlook As clsOutlook\n    Dim searchRange As Range\n    Dim subjectCell As Range\n\n    Dim searchFolderName As String\n\n    ' Start outlook if it isn't opened (credits: https://stackoverflow.com/questions/33328314/how-to-open-outlook-with-vba)\n    On Error Resume Next\n    Set testOutlook = GetObject(, \"Outlook.Application\")\n    On Error GoTo 0\n\n    If testOutlook Is Nothing Then\n        Shell (\"OUTLOOK\")\n    End If\n\n    ' Initialize Outlook class\n    Set oOutlook = New clsOutlook\n\n    ' Get the outlook inbox and sent items folders path (check the scope specification here: https://docs.microsoft.com/en-us/office/vba/api/outlook.application.advancedsearch)\n    searchFolderName = \"'\" &amp; Outlook.Session.GetDefaultFolder(olFolderInbox).FolderPath &amp; \"','\" &amp; Outlook.Session.GetDefaultFolder(olFolderSentMail).FolderPath &amp; \"'\"\n\n    ' Loop through excel cells with subjects\n    Set searchRange = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A2:A4\")\n\n    For Each subjectCell In searchRange\n\n        ' Only to cells with actual subjects\n        If subjectCell.Value &lt;&gt; vbNullString Then\n\n            Call oOutlook.SearchAndReply(subjectCell.Value, searchFolderName, False)\n\n        End If\n\n    Next subjectCell\n\n    MsgBox \"Search and reply completed\"\n\n    ' Clean object\n    Set testOutlook = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Then add a class module and name it: clsOutlook</p>\n\n<p>To the class module add the following code:</p>\n\n<pre><code>Option Explicit\n\n' Credits: Based on this answer: https://stackoverflow.com/questions/31909315/advanced-search-complete-event-not-firing-in-vba\n\n' Event handler for outlook\nDim WithEvents OutlookApp As Outlook.Application\nDim outlookSearch As Outlook.Search\nDim outlookResults As Outlook.Results\n\nDim searchComplete As Boolean\n\n\n' Handler for Advanced search complete\nPrivate Sub outlookApp_AdvancedSearchComplete(ByVal SearchObject As Search)\n    'MsgBox \"The AdvancedSearchComplete Event fired.\"\n    searchComplete = True\nEnd Sub\n\n\nSub SearchAndReply(emailSubject As String, searchFolderName As String, searchSubFolders As Boolean)\n\n    ' Declare objects variables\n    Dim customMailItem As Outlook.MailItem\n    Dim searchString As String\n    Dim resultItem As Integer\n\n    ' Variable defined at the class level\n    Set OutlookApp = New Outlook.Application\n\n    ' Variable defined at the class level (modified by outlookApp_AdvancedSearchComplete when search is completed)\n    searchComplete = False\n\n    ' You can look up on the internet for urn:schemas strings to make custom searches\n    searchString = \"urn:schemas:httpmail:subject like '\" &amp; emailSubject &amp; \"'\" ' Use: subject like '%\" &amp; emailSubject &amp; \"%'\" if you want to include words see %\n\n    ' Perform advanced search\n    Set outlookSearch = OutlookApp.AdvancedSearch(searchFolderName, searchString, searchSubFolders, \"SearchTag\")\n\n    ' Wait until search is complete based on outlookApp_AdvancedSearchComplete event\n    While searchComplete = False\n        DoEvents\n    Wend\n\n    ' Get the results\n    Set outlookResults = outlookSearch.Results\n\n    If outlookResults.Count = 0 Then Exit Sub\n\n    ' Sort descending so you get the latest\n    outlookResults.Sort \"[SentOn]\", True\n\n    ' Reply only to the latest one\n    resultItem = 1\n\n    ' Some properties you can check from the email item for debugging purposes\n    On Error Resume Next\n    Debug.Print outlookResults.Item(resultItem).SentOn, outlookResults.Item(resultItem).ReceivedTime, outlookResults.Item(resultItem).SenderName, outlookResults.Item(resultItem).Subject\n    On Error GoTo 0\n\n    Set customMailItem = outlookResults.Item(resultItem).ReplyAll\n\n    ' At least one reply setting is required in order to replyall to fire\n    customMailItem.Body = \"Just a reply text \" &amp; customMailItem.Body\n\n    customMailItem.Display\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10819615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb2de14518ba082ca5aaf28ad6ce6c6?s=128&d=identicon&r=PG&f=1", "display_name": "DJSingh", "link": "https://stackoverflow.com/users/10819615/djsingh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 928, "favorite_count": 0, "accepted_answer_id": 54877923, "answer_count": 1, "score": 0, "last_activity_date": 1592693175, "creation_date": 1550022258, "last_edit_date": 1592693175, "question_id": 54661270, "link": "https://stackoverflow.com/questions/54661270/search-by-subject-for-latest-email-in-all-folders-and-reply-all", "title": "Search by subject for latest email in all folders and reply all", "body": "<p>The code below doesn't execute reply all property, hence, I am not able to edit the body of the email and keep the conversation of the email chain.  </p>\n\n<p>I think the best option is to use Application.advancesearch as it gives you latest email by searching through all folders. But I do not know how to run it through Excel. </p>\n\n<p>Objective:<br>\n1) Search the inbox and subfolders (multiple) and Sent items folder for the latest email for selected \"Subject\"<br>\n2) select the latest email and reply to all  </p>\n\n<pre><code>Sub ReplyMail()\n\n    ' Variables\n    Dim OutlookApp As Object\n    Dim IsOutlookCreated As Boolean\n    Dim sFilter As String, sSubject As String\n    Dim SentTime As Long\n    Dim IndoxTime As Long\n\n    Dim olEmailIndox As Outlook.MailItem\n    Dim olEmailSent As Outlook.MailItem\n\n    ' Get/create outlook object\n    On Error Resume Next\n    Set OutlookApp = GetObject(, \"Outlook.Application\")\n    If Err Then\n        Set OutlookApp = CreateObject(\"Outlook.Application\")\n        IsOutlookCreated = True\n    End If\n    On Error GoTo 0\n\n    Set olEmailIndox = OutlookApp.CreateItem(olMailItem)\n    Set olEmailSent = OutlookApp.CreateItem(olMailItem)\n\n\n\n        ' Restrict items\n        sSubject = \"Subject 1\"\n        sFilter = \"[Subject] = '\" &amp; sSubject &amp; \"'\"\n\n        ' Main\n        With OutlookApp.Session.GetDefaultFolder(olFolderSentMail).Items.Restrict(sFilter)\n            If .Count &gt; 0 Then\n                .Sort \"ReceivedTime\", True\n                Set olEmailSent = .Item(1)\n                SentTime = olEmailSent.SentOn\n            End If\n        End With\n\n        With OutlookApp.Session.GetDefaultFolder(olFolderInbox).Items.Restrict(sFilter)\n            If .Count &gt; 0 Then\n                .Sort \"ReceivedTime\", True\n                Set olEmailInbox = .Item(1)\n                InboxTime = olEmailInbox.ReceivedTime\n            End If\n        End With\n\n        If SentTime &gt; InboxTime Then\n            With olEmailSent\n                .ReplyAll\n                .Display\n                '.body\n                '.Send\n            End With\n\n        Else\n            With olEmailInbox\n                .ReplyAll\n                .Display\n                '.body\n                '.Send\n            End With\n\n        End If\n\n\n\n    ' Quit Outlook instance if it was created by this code\n    If IsOutlookCreated Then\n        OutlookApp.Quit\n        Set OutlookApp = Nothing\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "edited": false, "score": 0, "creation_date": 1550023052, "post_id": 54661293, "comment_id": 96113933, "body": "I think you mean <code>ws.Range(&quot;A1:J100000&quot;).AutoFilter Field:=2, Criteria1:=&quot;EDO&quot;, Criteria2:=&quot;DOS&quot;, operator:=xlOr</code>. Also they need to change <code>Regular Range</code> to <code>Sheet1</code> at the start."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11053804"}, "reply_to_user": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "edited": false, "score": 0, "creation_date": 1550023306, "post_id": 54661293, "comment_id": 96114000, "body": "If  the filter is restricted to column B then Field:=1 is appropriate. It looks like <i>Regular Range</i> is the name of the worksheet they want to work on. If it isn&#39;t I hope they could change that part themselves."}, {"owner": {"reputation": 3, "user_id": 10108404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9488c03f816381c6013c2f3d56ef551?s=128&d=identicon&r=PG&f=1", "display_name": "Tejinder Mangat", "link": "https://stackoverflow.com/users/10108404/tejinder-mangat"}, "edited": false, "score": 0, "creation_date": 1550079746, "post_id": 54661293, "comment_id": 96141938, "body": "Thank you @user11053804. Field 2 worked for me and I did need to change the worksheet name (I was unclear what Regular Range was in the original code). How would I add even more condiitions to this statement? Say I wanted to look for &quot;3DO&quot;, &quot;DOS&quot;, and &quot;All Other&quot;"}, {"owner": {"reputation": 3, "user_id": 10108404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9488c03f816381c6013c2f3d56ef551?s=128&d=identicon&r=PG&f=1", "display_name": "Tejinder Mangat", "link": "https://stackoverflow.com/users/10108404/tejinder-mangat"}, "reply_to_user": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "edited": false, "score": 0, "creation_date": 1550079769, "post_id": 54661293, "comment_id": 96141953, "body": "Thank you @Profex. Field 2 worked for me and I did need to change the worksheet name (I was unclear what Regular Range was in the original code). How would I add even more conditions to this statement? Say I wanted to look for &quot;3DO&quot;, &quot;DOS&quot;, and &quot;All Other&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11053804"}, "reply_to_user": {"reputation": 3, "user_id": 10108404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9488c03f816381c6013c2f3d56ef551?s=128&d=identicon&r=PG&f=1", "display_name": "Tejinder Mangat", "link": "https://stackoverflow.com/users/10108404/tejinder-mangat"}, "edited": false, "score": 0, "creation_date": 1550080660, "post_id": 54661293, "comment_id": 96142422, "body": "@TejinderMangat - See the edit made above. Note that the AutoFilter range is <code>B3:B1000</code> to use <code>Field:=1</code>."}, {"owner": {"reputation": 3, "user_id": 10108404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9488c03f816381c6013c2f3d56ef551?s=128&d=identicon&r=PG&f=1", "display_name": "Tejinder Mangat", "link": "https://stackoverflow.com/users/10108404/tejinder-mangat"}, "edited": false, "score": 0, "creation_date": 1550081148, "post_id": 54661293, "comment_id": 96142661, "body": "Thank you @user11053804, and the xlFilterValues addition you added is working!"}, {"owner": {"reputation": 3, "user_id": 10108404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9488c03f816381c6013c2f3d56ef551?s=128&d=identicon&r=PG&f=1", "display_name": "Tejinder Mangat", "link": "https://stackoverflow.com/users/10108404/tejinder-mangat"}, "reply_to_user": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "edited": false, "score": 0, "creation_date": 1550083634, "post_id": 54661293, "comment_id": 96143844, "body": "Thank you again @Profex, user11053804 pointed out how to add 3+ criteria and I have updated the original post with that solution. Now I am curious how I could modify this code to delete rows that DON&#39;T meet a criteria. For example, delete all rows that don&#39;t have the value &quot;Dec 2018&quot; in column G?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11053804"}, "edited": false, "score": 0, "creation_date": 1550083986, "post_id": 54661293, "comment_id": 96144024, "body": "Stop changing the original conditions of your question. If you have another question, then ask another question. These <i>&#39; but what is I want to ...&#39;</i> additions are toxic."}, {"owner": {"reputation": 3, "user_id": 10108404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9488c03f816381c6013c2f3d56ef551?s=128&d=identicon&r=PG&f=1", "display_name": "Tejinder Mangat", "link": "https://stackoverflow.com/users/10108404/tejinder-mangat"}, "edited": false, "score": 0, "creation_date": 1550087206, "post_id": 54661293, "comment_id": 96145479, "body": "Fair enough @user11053804, thank you for your help and sorry for the trouble."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11053804"}, "is_accepted": false, "score": 0, "last_activity_date": 1550080608, "last_edit_date": 1550080608, "creation_date": 1550022449, "answer_id": 54661293, "question_id": 54661257, "link": "https://stackoverflow.com/questions/54661257/delete-rows-based-on-cell-values/54661293#54661293", "title": "Delete Rows Based on Cell Values", "body": "<p>Your AutoFilter statement is inadequate.</p>\n\n<pre><code>ws.Range(\"B3:B1000\").AutoFilter Field:=1, Criteria1:=\"EDO\", Criteria2:=\"DOS\", operator:=xlOr\n</code></pre>\n\n<p>Additional criteria would require an array with xlFilterValues.</p>\n\n<pre><code>ws.Range(\"B3:B1000\").AutoFilter Field:=1, Criteria1:=array(\"EDO\", \"DOS\", \"All Others\"), operator:=xlFilterValues\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 10108404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9488c03f816381c6013c2f3d56ef551?s=128&d=identicon&r=PG&f=1", "display_name": "Tejinder Mangat", "link": "https://stackoverflow.com/users/10108404/tejinder-mangat"}, "edited": false, "score": 0, "creation_date": 1550079355, "post_id": 54661447, "comment_id": 96141710, "body": "This worked well for me! Thank you @Harun24HR. How would I add more values to search and delete for in this statement? Say I wanted to look for &quot;3DO&quot;, &quot;DOS&quot;, and &quot;All Other&quot;, could I modify the line like this:     ``` ws.Range(&quot;$A$1:$J$10000&quot;).AutoFilter Field:=2, Criteria1:=&quot;=3DO&quot;, _         Operator:=xlOr, Criteria2:=&quot;=DOS&quot;, Operator:xIOr, Criteria3 =&quot;=All Other&quot; ```"}, {"owner": {"reputation": 3, "user_id": 10108404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9488c03f816381c6013c2f3d56ef551?s=128&d=identicon&r=PG&f=1", "display_name": "Tejinder Mangat", "link": "https://stackoverflow.com/users/10108404/tejinder-mangat"}, "edited": false, "score": 0, "creation_date": 1550083518, "post_id": 54661447, "comment_id": 96143781, "body": "Thank you again @Harun24HR, user11053804 below pointed out how to add 3+ criteria and I have updated the original post with that solution. Now I am curious how I could modify this code to delete rows that DON&#39;T meet a criteria. For example, delete all rows that don&#39;t have the value &quot;Dec 2018&quot; in column G?"}], "tags": [], "owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "is_accepted": false, "score": 1, "last_activity_date": 1550023862, "creation_date": 1550023862, "answer_id": 54661447, "question_id": 54661257, "link": "https://stackoverflow.com/questions/54661257/delete-rows-based-on-cell-values/54661447#54661447", "title": "Delete Rows Based on Cell Values", "body": "<p>What about following codes? Can you please have a try and feedback us.</p>\n\n<pre><code>Sub DelVisible()\nDim ws As Worksheet\n\nSet ws = ThisWorkbook.Worksheets(\"Regular Range\")\n\n    ws.Range(\"$A$1:$J$10000\").AutoFilter Field:=2, Criteria1:=\"=3DO\", _\n        Operator:=xlOr, Criteria2:=\"=DOS\"\n\n    ws.Range(\"$A$2:$J$10000\").SpecialCells(xlCellTypeVisible).EntireRow.Delete\n    ws.Range(\"$A$1:$J$10000\").AutoFilter\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10108404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9488c03f816381c6013c2f3d56ef551?s=128&d=identicon&r=PG&f=1", "display_name": "Tejinder Mangat", "link": "https://stackoverflow.com/users/10108404/tejinder-mangat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 880, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1553689721, "creation_date": 1550022145, "last_edit_date": 1553689721, "question_id": 54661257, "link": "https://stackoverflow.com/questions/54661257/delete-rows-based-on-cell-values", "title": "Delete Rows Based on Cell Values", "body": "<p>I want to delete any row in a data table with a cell value in column B of \"3DO\" or \"DOS\" and shift remaining cells up.</p>\n\n<p>Screenshot of data table<br>\n<a href=\"https://i.stack.imgur.com/KhXmK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KhXmK.png\" alt=\"enter image description here\"></a></p>\n\n<p>Workbook Name: StackOverflowTest.xlsm</p>\n\n<p>Worksheet Name: Sheet1</p>\n\n<p>Cell range: A1:J100000</p>\n\n<p>Column with value: B</p>\n\n<p>Values to search for: \"3DO\", \"DOS\"</p>\n\n<p>My understanding is that the following VBA code could be altered to achieve this:</p>\n\n<pre><code>Sub Delete_Rows_Based_On_Value()\n'Apply a filter to a Range and delete visible rows\n'Source: https://www.excelcampus.com/vba/delete-rows-cell-values/\n\n\nDim ws As Worksheet\n\n  'Set reference to the sheet in the workbook.\n  Set ws = ThisWorkbook.Worksheets(\"Regular Range\")\n  ws.Activate 'not required but allows user to view sheet if warning message appears\n\n  'Clear any existing filters\n  On Error Resume Next\n    ws.ShowAllData\n  On Error GoTo 0\n\n  '1. Apply Filter\n  ws.Range(\"B3:G1000\").AutoFilter Field:=4, Criteria1:=\"\"\n\n  '2. Delete Rows\n  Application.DisplayAlerts = False\n    ws.Range(\"B4:G1000\").SpecialCells(xlCellTypeVisible).Delete\n  Application.DisplayAlerts = True\n\n  '3. Clear Filter\n  On Error Resume Next\n    ws.ShowAllData\n  On Error GoTo 0\n\nEnd Sub\n</code></pre>\n\n<p>UPDATE:</p>\n\n<p>This code from @Harun24HR seems to do the trick for me</p>\n\n<pre><code>Sub DelVisible()\nDim ws As Worksheet\n\nSet ws = ThisWorkbook.Worksheets(\"RAW\")\n\n    ws.Range(\"$A$1:$J$100000\").AutoFilter Field:=2, Criteria1:=\"=3DO\", _\n        Operator:=xlOr, Criteria2:=\"=DOS\"\n\n    ws.Range(\"$A$2:$J$100000\").SpecialCells(xlCellTypeVisible).EntireRow.Delete\n    ws.Range(\"$A$1:$J$100000\").AutoFilter\n\nEnd Sub\n</code></pre>\n\n<p>But now I'd like to add more criteria to search for in this statement and I'm unclear on how to do that. Say I am looking for \"3DO\", \"DOS\", and \"Mac\" for example, how would I add the \"Mac\" criteria in addition to this statement?</p>\n\n<p>Update #2</p>\n\n<p>Thanks to @user11053804 I have a working solution for looking for 3+ criteria</p>\n\n<pre><code>Sub RemoveOldPlatforms()\nDim ws As Worksheet\n\nSet ws = ThisWorkbook.Worksheets(\"RAW\")\n\n    ws.Range(\"$A$1:$J$100000\").AutoFilter Field:=2, Criteria1:=Array(\"3DO\", \"All Other\", \"DOS\", \"Mac\"), Operator:=xlFilterValues\n\n    ws.Range(\"$A$2:$J$100000\").SpecialCells(xlCellTypeVisible).EntireRow.Delete\n    ws.Range(\"$A$1:$J$100000\").AutoFilter\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1550026748, "post_id": 54661149, "comment_id": 96114723, "body": "<code>Selection.Paragraphs(1).Range</code> isn&#39;t defined by your code."}, {"owner": {"reputation": 3, "user_id": 11031258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01699ca176d8e899734270363e510ac0?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Mc Callum", "link": "https://stackoverflow.com/users/11031258/kevin-mc-callum"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1550027185, "post_id": 54661149, "comment_id": 96114816, "body": "@Variatus It\u2019s defined inside the \u201cIF\u201d or what should I change?"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1550027677, "post_id": 54661149, "comment_id": 96114933, "body": "<code>Selection</code> is the range which is currently selected in the document. It&#39;s a UI thing. Addressing an InlineShape doesn&#39;t by VBA <code>Select</code> its range on the screen."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11031258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01699ca176d8e899734270363e510ac0?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Mc Callum", "link": "https://stackoverflow.com/users/11031258/kevin-mc-callum"}, "edited": false, "score": 0, "creation_date": 1550040143, "post_id": 54661912, "comment_id": 96118561, "body": "It works perfectly thank you. I have another issue, is there a way to loop through the paragraphs to check if the paragraph is empty until it finds text and stores it into the string variable?...I am new to vba"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 3, "user_id": 11031258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01699ca176d8e899734270363e510ac0?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Mc Callum", "link": "https://stackoverflow.com/users/11031258/kevin-mc-callum"}, "edited": false, "score": 0, "creation_date": 1550043263, "post_id": 54661912, "comment_id": 96119933, "body": "I have modified the code to ignore blank paragraphs except for the last one in the document. In fact, if the last paragraph in the document contains the picture itself, an error will occur."}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": true, "score": 0, "last_activity_date": 1550043181, "last_edit_date": 1550043181, "creation_date": 1550027475, "answer_id": 54661912, "question_id": 54661149, "link": "https://stackoverflow.com/questions/54661149/how-to-prompt-first-paragraph-after-every-image/54661912#54661912", "title": "How to prompt first paragraph after every image", "body": "<p>This code might work, depending upon how your InlineShapes are positioned. The code presumes that each picture is in its own paragraph and then picks out the next.</p>\n\n<pre><code>Sub Example1()\n\n    Dim i As Integer\n    Dim strCaption As String\n    Dim Rng As Range\n\n    With ActiveDocument.InlineShapes\n        'loop through inline shapes\n        For i = 1 To .Count\n            With .Item(i)\n                'check if the current shape is a picture\n                If .Type = wdInlineShapePicture Then\n                    Set Rng = .Range.Paragraphs(1).Range\n                    With Rng\n                        Do\n                            .Collapse wdCollapseEnd\n                            .MoveEnd wdParagraph\n                        Loop While Len(Trim(.Text)) = 1 And _\n                                   .End &lt; .Document.Content.End\n                        strCaption = Rng.Text\n                   End With\n                   MsgBox strCaption\n                End If\n            End With\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1550040579, "creation_date": 1550040579, "answer_id": 54664187, "question_id": 54661149, "link": "https://stackoverflow.com/questions/54661149/how-to-prompt-first-paragraph-after-every-image/54664187#54664187", "title": "How to prompt first paragraph after every image", "body": "<p>If the text you're after is in the same paragraph as the inlineshape you could use code like:</p>\n\n<pre><code>Sub Demo()\nDim iSHp As InlineShape, Rng As Range\nFor Each iSHp In ActiveDocument.InlineShapes\n  Set Rng = iSHp.Range.Paragraphs(1).Range\n  With Rng\n    .Start = iSHp.Range.End\n    MsgBox .Text\n  End With\nNext\nEnd Sub\n</code></pre>\n\n<p>If the text you're after is in the next paragraph after the inlineshape you could use code like:</p>\n\n<pre><code>Sub Demo()\nDim iSHp As InlineShape, Rng As Range\nFor Each iSHp In ActiveDocument.InlineShapes\n  Set Rng = iSHp.Range.Paragraphs(1).Range\n  With Rng\n    .Collapse wdCollapseEnd\n    .MoveEnd wdParagraph, 1\n    MsgBox .Text\n  End With\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11031258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01699ca176d8e899734270363e510ac0?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Mc Callum", "link": "https://stackoverflow.com/users/11031258/kevin-mc-callum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 54661912, "answer_count": 2, "score": 0, "last_activity_date": 1550043938, "creation_date": 1550021296, "last_edit_date": 1550043938, "question_id": 54661149, "link": "https://stackoverflow.com/questions/54661149/how-to-prompt-first-paragraph-after-every-image", "title": "How to prompt first paragraph after every image", "body": "<p>I am trying to prompt every paragraph after every image in an active document. For some reason, the prompt pops up empty.</p>\n\n<pre><code>Sub Example1()\nDim intCount As Integer\nDim i As Integer\nDim strCaption As String\n\n'loop through inline shapes\nFor i = 1 To ActiveDocument.InlineShapes.Count\n'check if the current shape is an picture\n    If ActiveDocument.InlineShapes.Item(i).Type = wdInlineShapePicture Then\n       strCaption = Selection.Paragraphs(1).Range\n       MsgBox strCaption\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "insert", "copy"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11053804"}, "is_accepted": false, "score": 1, "last_activity_date": 1550020060, "creation_date": 1550020060, "answer_id": 54661030, "question_id": 54660911, "link": "https://stackoverflow.com/questions/54660911/how-to-automatically-insert-a-copied-row-after-a-specific-value-in-a-cell-with-v/54661030#54661030", "title": "How to automatically insert a copied row after a specific value in a cell with VBA", "body": "<p>On the Excel worksheet GUI menu, this is called Insert Copied Cells.</p>\n\n<pre><code>Option Explicit\n\nSub Macro1()\n\n    Dim i As Long\n\n    With Worksheets(\"sheet1\")\n\n        For i = .Cells(.Rows.Count, \"A\").End(xlUp).Row To 2 Step -1\n            If Right(.Cells(i, \"B\").Value2, 7) = \"-edubnd\" Then\n                .Cells(i, \"A\").Resize(1, 4).Copy\n                .Cells(i, \"A\").Resize(2, 4).Insert Shift:=xlDown\n                Application.CutCopyMode = False\n            End If\n        Next i\n\n    End With '\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": true, "score": 0, "last_activity_date": 1550020812, "creation_date": 1550020812, "answer_id": 54661101, "question_id": 54660911, "link": "https://stackoverflow.com/questions/54660911/how-to-automatically-insert-a-copied-row-after-a-specific-value-in-a-cell-with-v/54661101#54661101", "title": "How to automatically insert a copied row after a specific value in a cell with VBA", "body": "<p>Pleased try this code after making the appropriate modifications to its parameters.</p>\n\n<pre><code>Sub InsertDuplicates()\n\n    Const TestClm As String = \"B\"               ' modify as appropriate\n    Const SearchCrit As String = \"edubnd\"\n\n    Dim R As Long\n\n    Application.ScreenUpdating = False\n    With ThisWorkbook.Worksheets(\"InsRows\")     ' change as appropriate\n        For R = .Cells(.Rows.Count, TestClm).End(xlUp).Row To 2 Step -1\n            If InStr(1, .Cells(R, TestClm).Value, SearchCrit, vbTextCompare) Then\n                .Rows(R).EntireRow.Copy\n                .Range(.Rows(R + 1), .Rows(R + 2)).Insert Shift:=xlDown\n                Application.CutCopyMode = False\n            End If\n        Next R\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11053724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725c83e63c4ab29c5e2927e6b027103e?s=128&d=identicon&r=PG&f=1", "display_name": "Tim E", "link": "https://stackoverflow.com/users/11053724/tim-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 54661101, "answer_count": 2, "score": 0, "last_activity_date": 1550043669, "creation_date": 1550019138, "last_edit_date": 1550043669, "question_id": 54660911, "link": "https://stackoverflow.com/questions/54660911/how-to-automatically-insert-a-copied-row-after-a-specific-value-in-a-cell-with-v", "title": "How to automatically insert a copied row after a specific value in a cell with VBA", "body": "<p>I have a table that contains a set of bundles that have to be broken down into their components. For this I'm looking for VBA instructions that will copy any row that contains the tag \"-edubnd\" at the end of the 'sku' cell (please see table bellow for example) twice underneath itself.</p>\n\n<p>It might be easier to ignore the tag component and use a specific set of values that the code looks for, that's also possible as the values marked as bundles are always the same in the column. What I mean is, instead of looking for the -edubnd tag, the code just looks for a specific value in that column, </p>\n\n<p>I have created a sample table below that is similar-enough to my table in excel that it should serve to illustrate the question.</p>\n\n<p>I'm currently filtering out the dataset, copying it into a different excel document, then running this:</p>\n\n<pre><code>Sub insertrows()\n    Dim I As Long\n    Dim xCount As Integer\n\nLableNumber:\n    xCount = 2\n    For I = Range(\"A\" &amp; Rows.CountLarge).End(xlUp).Row To 1 Step -1\n        Rows(I).Copy\n        Rows(I).Resize(xCount).Insert\n    Next\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<h2>Current table:</h2>\n\n<pre><code>column1   |    column2    |  column3 |  column3\n----------------------------------------------\n  A       |      pear     |  blue    |  10\n  A       |      apple    |  orange  |  50\n  A       |      orange   |  yellow  |  30\n  A       |      kiwi     |  yellow  |  20\n  A       | orange-edubnd |  blue    |  100\n  A       |      apple    |  green   |  10\n  A       |  pear-edubnd  |  green   |  50\n  A       |      mango    |  pink    |  60\n</code></pre>\n\n<h2>Desired table</h2>\n\n<p><strong>Note:</strong> the copied row after each distinct column2 with the -edubnd tag</p>\n\n<pre><code> column1   |    column2    |  column3 |  column3\n----------------------------------------------\n  A       |      pear     |  blue    |  10\n  A       |      apple    |  orange  |  50\n  A       |      orange   |  yellow  |  30\n  A       |      kiwi     |  yellow  |  20\n  A       | orange-edubnd |  blue    |  100\n  A       | orange-edubnd |  blue    |  100\n  A       | orange-edubnd |  blue    |  100\n  A       |      apple    |  green   |  10\n  A       |  pear-edubnd  |  green   |  50\n  A       |  pear-edubnd  |  green   |  50\n  A       |  pear-edubnd  |  green   |  50\n  A       |      mango    |  pink    |  60\n</code></pre>\n"}, {"tags": ["excel", "vba", "filter"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 11053647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/694a9ab7de42cdcee197aa01c8aca8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Z.Doe", "link": "https://stackoverflow.com/users/11053647/z-doe"}, "edited": false, "score": 0, "creation_date": 1550023663, "post_id": 54661010, "comment_id": 96114071, "body": "Thank you so much for your reply, and I have tried what you suggest. It works to an extent. The problem is that I would like Column A to filter cells that only contain characters matching the checked boxes. So, as in the picture you provided, if &#39;a&#39; is checked, then only &#39;aa&#39; should show in the filtered column. If &#39;a&#39;  and &#39;c&#39; are checked, then the filtered column would show any cell that has any combination of &#39;a&#39; and &#39;c&#39;."}], "tags": [], "owner": {"reputation": 1842, "user_id": 1226436, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/abb50b705a430e14fd745bf6f3513249?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/1226436/miguel"}, "is_accepted": false, "score": 1, "last_activity_date": 1550019865, "creation_date": 1550019865, "answer_id": 54661010, "question_id": 54660773, "link": "https://stackoverflow.com/questions/54660773/filter-excel-column-for-cells-that-contain-various-combinations-of-characters/54661010#54661010", "title": "Filter Excel column for cells that contain various combinations of characters", "body": "<p>Well this can be done a few different ways. However, this is one way you can acomplish what you are trying to do. \nCreate three checkboxes by using design mode from the developer tab and then simply assign 3 macros to do the 3 different buttons. You can also just create one sub and than just have that one sub(macro) do all the work. Is really up to you.</p>\n\n<pre><code> Sub OptionButton1_Click()\n\n Range(\"A1\").Select\n    Selection.AutoFilter\n    ActiveSheet.Range(\"$A$1:$A$10\").AutoFilter Field:=1, Criteria1:=\"=a*\", _\n        Operator:=xlAnd\n\nEnd Sub\n\nSub OptionButton2_Click()\n Range(\"A1\").Select\n    Selection.AutoFilter\n    ActiveSheet.Range(\"$A$1:$A$10\").AutoFilter Field:=1, Criteria1:=\"=b*\", _\n        Operator:=xlAnd\nEnd Sub\n\nSub option3_click()\n Range(\"A1\").Select\n    Selection.AutoFilter\n    ActiveSheet.Range(\"$A$1:$A$10\").AutoFilter Field:=1, Criteria1:=\"=c*\", _\n        Operator:=xlAnd\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/IYdDc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IYdDc.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 11053647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/694a9ab7de42cdcee197aa01c8aca8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Z.Doe", "link": "https://stackoverflow.com/users/11053647/z-doe"}, "edited": false, "score": 0, "creation_date": 1550024314, "post_id": 54661082, "comment_id": 96114212, "body": "Thank you I have adjusted my post based on your suggestion."}, {"owner": {"reputation": 27, "user_id": 11053647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/694a9ab7de42cdcee197aa01c8aca8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Z.Doe", "link": "https://stackoverflow.com/users/11053647/z-doe"}, "edited": false, "score": 0, "creation_date": 1550083158, "post_id": 54661082, "comment_id": 96143626, "body": "Thank you! I have also managed to make it work in GoogleSheets via the =FILTER function, with some tweaking. Unfortunately this feature is not yet available in Excel."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11053804"}, "is_accepted": true, "score": 0, "last_activity_date": 1550055410, "last_edit_date": 1550055410, "creation_date": 1550020642, "answer_id": 54661082, "question_id": 54660773, "link": "https://stackoverflow.com/questions/54660773/filter-excel-column-for-cells-that-contain-various-combinations-of-characters/54661082#54661082", "title": "Filter Excel column for cells that contain various combinations of characters", "body": "<p>You cannot do this the way you've described.</p>\n\n<ol>\n<li>Filtering requires a columns header. Data would have to start in row 2, not row 1.</li>\n<li>Filtering or hiding can only be performed on full rows or full columns. If the <em>A's</em> were hidden, your checkboxes in C1:C3 would also be hidden.</li>\n</ol>\n\n<p>Rethink your proposal and try to accomplish something towards a solution. If you run into trouble, edit your post to include new details.</p>\n\n<blockquote>\n  <p>if 'a' were checked under the CHECKBOXES column, the DATA column would show cells that only contained the letter a, not 'b' or 'c'. But if 'a' and 'b' were checked, the DATA column would show cells that contained either the letters a OR b, but not 'c'. If all three 'a', 'b', and 'c' were checked, there would obviously not be any filtering needed.</p>\n</blockquote>\n\n<p>Here's a method that works.</p>\n\n<ul>\n<li>Use Developer, Controls, Insert to add three <strong>ActiveX Checkboxes</strong>. Do <strong>not</strong> add Form Control Checkboxes and do <strong>not</strong> add Option buttons of any kind.</li>\n<li>One by one, right-click the <strong>ActiveX Checkboxes</strong> and access the Properties. Change the Names to <em>CheckBoxA, CheckBoxB</em> and <em>CheckBoxC</em> and the Captions to <em>A, B</em> and <em>C</em>.</li>\n<li>Resize the checkboxes as appropriate and position them in the top row where they will not be hidden by filtering values. When you're happy with the results, click Developer, Controls, Design Mode to exit Design Mode.</li>\n<li><p>Right-click the worksheet's name tab and choose View Code. Paste in the following.</p>\n\n<pre><code>Option Explicit\n\nSub CheckBoxABC_Click()\n\n    Dim i As Long, dict As Object, str As String\n\n    Set dict = CreateObject(\"scripting.dictionary\")\n    dict.comparemode = vbTextCompare\n\n    If AutoFilterMode Then AutoFilterMode = False\n\n    With Range(Cells(1, \"A\"), Cells(Rows.Count, \"A\").End(xlUp))\n\n        For i = 2 To .Rows.Count\n            'store the cell value\n            str = .Cells(i, \"A\").Value\n\n            'see if it might belong and add it\n            If CBool(InStr(1, str, \"A\", vbTextCompare)) And .Parent.CheckBoxA Then _\n                dict.Item(str) = vbNullString\n            If CBool(InStr(1, str, \"B\", vbTextCompare)) And .Parent.CheckBoxB Then _\n                dict.Item(str) = vbNullString\n            If CBool(InStr(1, str, \"C\", vbTextCompare)) And .Parent.CheckBoxC Then _\n                dict.Item(str) = vbNullString\n\n            'see if it doesn't belong and remove it\n            If dict.Exists(str) And CBool(InStr(1, str, \"A\", vbTextCompare)) And Not .Parent.CheckBoxA Then _\n                dict.Remove str\n            If dict.Exists(str) And CBool(InStr(1, str, \"B\", vbTextCompare)) And Not .Parent.CheckBoxB Then _\n                dict.Remove str\n            If dict.Exists(str) And CBool(InStr(1, str, \"C\", vbTextCompare)) And Not .Parent.CheckBoxC Then _\n                dict.Remove str\n\n        Next i\n\n        If dict.Count &gt; 0 Then\n            .AutoFilter field:=1, Criteria1:=dict.keys, Operator:=xlFilterValues, VisibleDropDown:=False\n        Else\n            .AutoFilter field:=1, Criteria1:=\"Z\", VisibleDropDown:=False\n        End If\n\n    End With\nEnd Sub\n\nPrivate Sub CheckBoxA_Click()\n    CheckBoxABC_Click\nEnd Sub\n\nPrivate Sub CheckBoxB_Click()\n    CheckBoxABC_Click\nEnd Sub\n\nPrivate Sub CheckBoxC_Click()\n    CheckBoxABC_Click\nEnd Sub\n</code></pre></li>\n<li><p>Your results should be similar to the following.</p></li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/p2hW8.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p2hW8.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 27, "user_id": 11053647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/694a9ab7de42cdcee197aa01c8aca8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Z.Doe", "link": "https://stackoverflow.com/users/11053647/z-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 54661082, "answer_count": 2, "score": 0, "last_activity_date": 1550055410, "creation_date": 1550018058, "last_edit_date": 1550024091, "question_id": 54660773, "link": "https://stackoverflow.com/questions/54660773/filter-excel-column-for-cells-that-contain-various-combinations-of-characters", "title": "Filter Excel column for cells that contain various combinations of characters", "body": "<p>I am trying to filter a range in Excel, say DATA, based on if cells in another column, say CHECKBOXES are checked via a checkbox. It would look something like this:</p>\n\n<p><strong>DATA</strong><br>\naa <br>\nab<br>\nac<br>\nba<br>\nbb<br>\nbc<br>\nca<br>\ncb<br>\ncc<br></p>\n\n<p><strong>CHECKBOXES</strong><br>\na [x]<br>\nb [x]<br>\nc [x]<br></p>\n\n<p>So, if 'a' were checked under the CHECKBOXES column, the DATA column would show  cells that only contained the letter a, not 'b' or 'c'. But if 'a' and 'b' were checked, the DATA column would show cells that contained either the letters a <strong>OR</strong> b, but not 'c'. If all three 'a', 'b', and 'c' were checked, there would obviously not be any filtering needed. </p>\n\n<p>I would like to implement this across a large range of data with both columns. \nAny and all help is much appreciated, Thank You. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "edited": false, "score": 0, "creation_date": 1550022682, "post_id": 54660700, "comment_id": 96113853, "body": "I&#39;ve bumped into this using VSTO, but fundamentally the .Net Excel.Interop is the same as the VBA Object Model underneath. Whats the error message? I think @Profex might have solved it but if that doesn&#39;t work can you try with Admin: <a href=\"https://stackoverflow.com/questions/10875278/vsto-add-ins-comaddins-and-requestcomaddinautomationservice\" title=\"vsto add ins comaddins and requestcomaddinautomationservice\">stackoverflow.com/questions/10875278/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "is_accepted": false, "score": 1, "last_activity_date": 1550022620, "creation_date": 1550022620, "answer_id": 54661316, "question_id": 54660700, "link": "https://stackoverflow.com/questions/54660700/executing-add-in-element-on-the-ribbon-with-vba/54661316#54661316", "title": "Executing Add-in element on the ribbon with VBA", "body": "<p>You have to use the <code>progID</code> not the <code>description</code>.</p>\n\n<p>For a list of all the COM add-ins running just run:</p>\n\n<pre><code>Dim i As Long\nFor i = 1 To Application.COMAddIns.Count\n    With Application.COMAddIns(i)\n        Debug.Print .progID &amp; \"  :  \" &amp; .Description\n    End With\nNext\n</code></pre>\n\n<p>If it's loaded, you should see it in the list.</p>\n"}], "owner": {"reputation": 11, "user_id": 7852225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/449f336141556793cb1a3a2758722c7d?s=128&d=identicon&r=PG&f=1", "display_name": "Andrzej T", "link": "https://stackoverflow.com/users/7852225/andrzej-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550022620, "creation_date": 1550017470, "question_id": 54660700, "link": "https://stackoverflow.com/questions/54660700/executing-add-in-element-on-the-ribbon-with-vba", "title": "Executing Add-in element on the ribbon with VBA", "body": "<p>I have an excel COM add-in that have quick access toolbar with element that i can execute by clicking on it.\nRight now I want to write VBA macro that executes this element multiple times.\nI am trying to get to this add-in elements with this lines:</p>\n\n<p><code>Dim addinModule As Object \nSet addinModule = Application.COMAddIns.Item(\"MyExcelAddin\").Object</code>\nBut all I can get is error that says \"Run-time Error 9: Subscript out of range\"</p>\n\n<p>I can't add it in tools-> references, in COM-Addins section in developer mode it is loaded.</p>\n\n<p>Regards</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 2320826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e669c798427613b2a065884c7a7d1b4?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/2320826/miguel"}, "edited": false, "score": 0, "creation_date": 1550018740, "post_id": 54660802, "comment_id": 96112974, "body": "humm but it&#39;s a table the one i have, however for some reason when some people have added rows to it it did not inserted correctly or at least it was not counting has it was on table. The rows numbers in the left side only 15 of them were blue all the others to 38 were with no color."}, {"owner": {"reputation": 89, "user_id": 2320826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e669c798427613b2a065884c7a7d1b4?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/2320826/miguel"}, "edited": false, "score": 0, "creation_date": 1550018794, "post_id": 54660802, "comment_id": 96112989, "body": "humm a table name ??? i did not set any name for the table, i just clicked where it said table in the beginning to start it. where do i check is name ?"}, {"owner": {"reputation": 89, "user_id": 2320826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e669c798427613b2a065884c7a7d1b4?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/2320826/miguel"}, "edited": false, "score": 0, "creation_date": 1550018952, "post_id": 54660802, "comment_id": 96113026, "body": "ohh found it is &quot;Table1&quot; the table name"}, {"owner": {"reputation": 89, "user_id": 2320826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e669c798427613b2a065884c7a7d1b4?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/2320826/miguel"}, "edited": false, "score": 0, "creation_date": 1550021116, "post_id": 54660802, "comment_id": 96113524, "body": "well i did half what you said cause i was not sure how to use the With MyLO.Autoflter part... i will update main topic to what i have done and it seems to be working fine..."}, {"owner": {"reputation": 89, "user_id": 2320826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e669c798427613b2a065884c7a7d1b4?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/2320826/miguel"}, "edited": false, "score": 0, "creation_date": 1550023163, "post_id": 54660802, "comment_id": 96113962, "body": "on the Field:=2 line is a columns with dates ... how can i set it a criteria to search in the format &quot;yyyy mmmm dd&quot; . When trying with Format(Cells(target.Row, 2).Value, &quot;yyyy mmmm dd&quot;) does not work cause it&#39;s searching in a small different way (shows on the filter text box It&#39;s equal to &quot;2019 February 11&quot; however when testing it manually it show on filter title It&#39;s equal to &quot;&quot;2019 February 11&quot;&quot;"}, {"owner": {"reputation": 1744, "user_id": 10600584, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/319eb863cdc0db2dd90b533b742f8738?s=128&d=identicon&r=PG", "display_name": "FXD", "link": "https://stackoverflow.com/users/10600584/fxd"}, "reply_to_user": {"reputation": 89, "user_id": 2320826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e669c798427613b2a065884c7a7d1b4?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/2320826/miguel"}, "edited": false, "score": 0, "creation_date": 1550031369, "post_id": 54660802, "comment_id": 96115768, "body": "The value and the text <b>displayed</b> are 2 different things. I suggest you record a macro with you doing that to see the corresponding VBA code. You should end up with something like e.g. <code>MyLO.Range.AutoFilter Field:=1, Operator:=        xlFilterValues, Criteria2:=Array(2, &quot;1&#47;11&#47;2019&quot;, 1, &quot;3&#47;10&#47;2019&quot;)</code>. Note the <code>2</code> in <code>Array(2, &quot;1&#47;11&#47;2019&quot;, 1, &quot;3&#47;10&#47;2019&quot;)</code> means &quot;day&quot;. Use <code>0</code> to filter on the year, <code>1</code> to filter on year+month (but still specify a complete date)."}], "tags": [], "owner": {"reputation": 1744, "user_id": 10600584, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/319eb863cdc0db2dd90b533b742f8738?s=128&d=identicon&r=PG", "display_name": "FXD", "link": "https://stackoverflow.com/users/10600584/fxd"}, "is_accepted": true, "score": 0, "last_activity_date": 1550018288, "creation_date": 1550018288, "answer_id": 54660802, "question_id": 54660525, "link": "https://stackoverflow.com/questions/54660525/autofilter-not-including-all-rows-when-filtering-using-vba/54660802#54660802", "title": "autofilter not including all rows when filtering using vba", "body": "<p>I would suggest you modify the range for it to be a table (Menu item: Format as Table). They are much easier to handle in VBA.</p>\n\n<p>When a filter does not apply to all the rows in a worksheet, there is no easy way to tell (which is what you are experiencing).<br>\nOn the other hand, a table manages its own rows itself, i.e. it is able to grow if you add more data.</p>\n\n<ul>\n<li>Type of table in VBA: <code>ListObject</code></li>\n<li>Assignment: <code>Set MyLO = Worksheets(1).ListObjects(1)</code><br>\nOr <code>Set MyLO = Worksheets(1).ListObjects(\"TableName\")</code></li>\n<li>Properties returning a range (do not forget to test <code>If Not MyLo.&lt;Range as defined below&gt; Is Nothing</code>).<br>\nThey allow to never have to write <code>SomeCell.End(xlDown)...</code>:\n\n<ul>\n<li>Header: <code>MyLO.HeaderRowRange</code></li>\n<li>Data: <code>MyLO.DataBodyRange</code></li>\n<li>Insert row (if no data in the table): <code>MyLO.InsertRowRange</code></li>\n<li>Totals: <code>MyLO.TotalsRowRange</code></li>\n</ul></li>\n<li>Filter:<br>\n<code>With MyLO.AutoFilter\n...\nEnd With</code></li>\n</ul>\n"}], "owner": {"reputation": 89, "user_id": 2320826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e669c798427613b2a065884c7a7d1b4?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/2320826/miguel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 54660802, "answer_count": 1, "score": 0, "last_activity_date": 1550021241, "creation_date": 1550015880, "last_edit_date": 1550021241, "question_id": 54660525, "link": "https://stackoverflow.com/questions/54660525/autofilter-not-including-all-rows-when-filtering-using-vba", "title": "autofilter not including all rows when filtering using vba", "body": "<p>For some reason autofilter is not including all rows with the information. I have about 40 rows with information but he is only including 15 of them (has you can see in the picture, it seems autofilter table puts at blue the rows numbers)</p>\n\n<pre><code>Option Explicit\nPrivate Sub Worksheet_Change(ByVal target As Range)\nActiveSheet.Unprotect\nApplication.EnableEvents = False\n\nDim sht As Worksheet\nDim LastRow As Long\n\nSet sht = ActiveSheet\nLastRow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\n\nIf target.Row = 1 Then\n    If target.Column &gt; 1 Then\n        If target.Column = 5 Then\n            Cells(target.Row, 6).NumberFormat = \"0\"\n\n            Cells(target.Row, 9).NumberFormat = \"General\"\n            Cells(target.Row, 9).Value = \"Figueira da Foz\"\n        End If\n    End If\n\n    With ActiveSheet\n        Dim tableData As ListObject\n        Set tableData = .ListObjects(\"Tabela1\")\n\n        If Not tableData Is Nothing Then\n\n            With Range(\"A3\")\n                .AutoFilter Field:=1, VisibleDropDown:=False\n                .AutoFilter Field:=2, VisibleDropDown:=False\n                .AutoFilter Field:=3, VisibleDropDown:=False\n                .AutoFilter Field:=4, VisibleDropDown:=False\n                .AutoFilter Field:=5, Criteria1:=\"*\" &amp; Cells(target.Row, 5).Value &amp; \"*\", VisibleDropDown:=False\n                .AutoFilter Field:=6, VisibleDropDown:=False\n                .AutoFilter Field:=7, Criteria1:=\"*\" &amp; Cells(target.Row, 7).Value &amp; \"*\", VisibleDropDown:=False\n                .AutoFilter Field:=8, Criteria1:=\"*\" &amp; Cells(target.Row, 8).Value &amp; \"*\", VisibleDropDown:=False\n                .AutoFilter Field:=9, VisibleDropDown:=False\n                If target.Column = 10 Then\n                    If target.Value = vbNullString Then\n                        .AutoFilter Field:=10, VisibleDropDown:=False\n                    Else\n                        .AutoFilter Field:=10, Criteria1:=\"\" &amp; Cells(target.Row, 10).Value, VisibleDropDown:=False\n                    End If\n                End If\n            End With\n        End If\n    End With\nEnd If\nEnd Sub\n</code></pre>\n\n<p>if i place instead  With .Range(\"A3:A\" &amp; LastRow) it will give an error \"Run-time error '1004': AutoFilter method of range class failed\". The idea was for the autofilter to filter all data until the last filled row, not only 15</p>\n\n<p>have no idea how to fix this, can anyone help me ?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1550016128, "post_id": 54660446, "comment_id": 96112357, "body": "<a href=\"https://en.wikipedia.org/wiki/Bubble_sort\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Bubble_sort</a>"}, {"owner": {"reputation": 5, "user_id": 11042617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f2582595e41640de2d8562565f23e7?s=128&d=identicon&r=PG&f=1", "display_name": "idodna", "link": "https://stackoverflow.com/users/11042617/idodna"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1550016783, "post_id": 54660446, "comment_id": 96112529, "body": "Perfect!  Thank you.  So the sort values come from the position in the array list?    Make an answer so I can mark correct."}], "owner": {"reputation": 5, "user_id": 11042617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f2582595e41640de2d8562565f23e7?s=128&d=identicon&r=PG&f=1", "display_name": "idodna", "link": "https://stackoverflow.com/users/11042617/idodna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550015274, "creation_date": 1550015274, "question_id": 54660446, "link": "https://stackoverflow.com/questions/54660446/explanation-of-inherited-code-sorts-an-array-but-im-not-sure-how", "title": "explanation of inherited code - sorts an array but I&#39;m not sure how", "body": "<p>I need to update a macro to add some new information to log sheets and a couple other fixes.  I want to understand how this codes sorts an array (why are there 3 variable) so I don't break the macro when I update it.</p>\n\n<p>I understand the array components - but i'm not sure how the columns end up sorted into the array order when the loops are finished.</p>\n\n<pre><code>Dim rang As Range\nDim i As Integer\nDim j As Integer\nDim Temp\nDim nams As Variant\nDim F\nDim Dex As Integer\nnams = Array(\"Assay_type\", \"Revd_date\", \"Lab#\", \"Outside#\", \"Last,First \nName\", \"MRN\", \"DOB\", \"Requestor\", \"CollDate\", \"Sample_info\", \n\"Order_Comment\", \"Signout_comment\", \"Sample_Comment\", \"Materials_recvd\", \n\"Order_status\", \"DIagnosis.1\", \"Molec_Summary\")\nSet rang = Range(\"A1\").CurrentRegion\nFor i = 1 To rang.Columns.Count\n    For j = i To rang.Columns.Count\n        For F = 0 To UBound(nams)\n            If nams(F) = rang(j) Then Dex = F: Exit For\n        Next F\n        If F &lt; i Then\n            Temp = rang.Columns(i).value\n            rang(i).Resize(rang.Rows.Count) = rang.Columns(j).value\n            rang(j).Resize(rang.Rows.Count) = Temp\n        End If\n    Next j\nNext i\n</code></pre>\n\n<p>I added two new columns to the array and I want to make sure the code will sort them with no problem. I'm just learning to make and update these macros and would like to be careful.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 3, "creation_date": 1550015169, "post_id": 54660375, "comment_id": 96112151, "body": "A perfect time to read up on <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using <code>.Select</code>/<code>.Activate</code></a>"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 1, "creation_date": 1550018219, "post_id": 54660375, "comment_id": 96112829, "body": "<code>Select</code> and <code>Activate</code> are commands Excel requires for its user interface. They are <i>never</i> needed by VBA. Take this one step further. If you can&#39;t use <code>Select</code> then <code>Rows(&quot;42:42&quot;).Select : Selection.Delete</code> could be replaced with <code>Rows(&quot;42:42&quot;).Delete</code> (Correct assumption!). But if your code contains <code>Rows(&quot;42:42&quot;).Delete</code>, is it a surprise that row 42 gets deleted every time you run the code? If you remove all <code>Select</code> statements from your code it will be 60% smaller and much more comprehensible. You will be able to at least see the problems you may need to ask about."}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": true, "score": 0, "last_activity_date": 1612484333, "last_edit_date": 1612484333, "creation_date": 1550025621, "answer_id": 54661662, "question_id": 54660375, "link": "https://stackoverflow.com/questions/54660375/delete-sorted-rows/54661662#54661662", "title": "Delete sorted rows", "body": "<p>So, instead of this:</p>\n<pre><code>&quot;$A$1:$C$396&quot;\n&quot;$A$1:$C$42&quot;\n</code></pre>\n<p>Find the last used row and last used column dynamically.</p>\n<pre><code>Dim sht As Worksheet\nDim LastRow As Long\n\nSet sht = ActiveSheet\n\n'Ctrl + Shift + End\n  LastRow = sht.Cells(sht.Rows.Count, &quot;A&quot;).End(xlUp).Row\n</code></pre>\n<p>And . . .</p>\n<pre><code>Dim sht As Worksheet\nDim LastColumn As Long\n\nSet sht = ThisWorkbook.Worksheets(&quot;Sheet1&quot;)\n\n'Using UsedRange\n  sht.UsedRange 'Refresh UsedRange\n  LastColumn = sht.UsedRange.Columns(sht.UsedRange.Columns.Count).Column\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 11053555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IN0DU.jpg?s=128&g=1", "display_name": "T Ford", "link": "https://stackoverflow.com/users/11053555/t-ford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 54661662, "answer_count": 1, "score": 0, "last_activity_date": 1619115505, "creation_date": 1550014882, "last_edit_date": 1619115505, "question_id": 54660375, "link": "https://stackoverflow.com/questions/54660375/delete-sorted-rows", "title": "Delete sorted rows", "body": "<p>I am subtotaling data, copying that data to another worksheet, then filtering for a column and deleting those rows.</p>\n<p>The problem is that the range of the data to delete will vary every time the macro is run.</p>\n<p>Here's an example of what I have:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Range(&quot;A2&quot;).Select\nColumns(&quot;A:C&quot;).Select\nSelection.Subtotal GroupBy:=1, Function:=xlCount, TotalList:=Array(3), _\n    Replace:=True, PageBreaks:=False, SummaryBelowData:=True\nRange(&quot;A2:C2&quot;).Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Copy\nRange(&quot;A2&quot;).Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nActiveSheet.Range(&quot;$A$1:$C$396&quot;).AutoFilter Field:=2, Criteria1:=&quot;&lt;&gt;&quot;\nRows(&quot;2:394&quot;).Select\nApplication.CutCopyMode = False\nSelection.Delete Shift:=xlUp\nActiveSheet.Range(&quot;$A$1:$C$42&quot;).AutoFilter Field:=2\nRange(&quot;A22&quot;).Select\nSelection.End(xlDown).Select\nRows(&quot;42:42&quot;).Select\nSelection.Delete Shift:=xlUp\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1550023010, "post_id": 54660240, "comment_id": 96113924, "body": "What is the use case for this? A dictionary typically only ensures that the <i>key</i> is unique - do you need both the key and the value to be unique?  If not, is there a rule as to which key you would return if there are duplicates?"}, {"owner": {"reputation": 27, "user_id": 9152099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e60e59f048b28abdb2964f17003fbe?s=128&d=identicon&r=PG&f=1", "display_name": "Kinote", "link": "https://stackoverflow.com/users/9152099/kinote"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1550024661, "post_id": 54660240, "comment_id": 96114277, "body": "I currently have a few little projects on the go and for convenient updating have created the dictionary as a central place for all the codes I need to check against/verify are correct/present in a string. In this case, when I discover a legal code I want to be able to quickly call its associated one (which can then be added to a new string and printed). If BBBB is in the string, I want to be able to find its counterpart; AAAA in this case. Each key/value would have to be unique, yes. AAAA would always only be 1, BBBB only ever 2, etc."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1550025087, "post_id": 54660240, "comment_id": 96114356, "body": "Unique key/value pairs aren&#39;t really the same thing as unique <i>values</i>.  To rephrase the question, is there only one 1, only one 2, etc."}, {"owner": {"reputation": 27, "user_id": 9152099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e60e59f048b28abdb2964f17003fbe?s=128&d=identicon&r=PG&f=1", "display_name": "Kinote", "link": "https://stackoverflow.com/users/9152099/kinote"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1550025901, "post_id": 54660240, "comment_id": 96114538, "body": "Yes, there&#39;s only one of each."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 9152099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e60e59f048b28abdb2964f17003fbe?s=128&d=identicon&r=PG&f=1", "display_name": "Kinote", "link": "https://stackoverflow.com/users/9152099/kinote"}, "edited": false, "score": 0, "creation_date": 1550016965, "post_id": 54660413, "comment_id": 96112560, "body": "<code>ReDim dSCACArr(Application.Min(dSCAC.Items) To Application.Max(dSCAC.Items))</code>                                          seems to cause Run-Time Error 438: Object doesn&#39;t support this property or method"}, {"owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "reply_to_user": {"reputation": 27, "user_id": 9152099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e60e59f048b28abdb2964f17003fbe?s=128&d=identicon&r=PG&f=1", "display_name": "Kinote", "link": "https://stackoverflow.com/users/9152099/kinote"}, "edited": false, "score": 0, "creation_date": 1550021878, "post_id": 54660413, "comment_id": 96113693, "body": "You&#39;re absolutely right, sorry. I don&#39;t know why my brain went straight to Excel functions. You could bypass the array method by just using another dictionary. I&#39;ve modified my code to reflect that."}, {"owner": {"reputation": 27, "user_id": 9152099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e60e59f048b28abdb2964f17003fbe?s=128&d=identicon&r=PG&f=1", "display_name": "Kinote", "link": "https://stackoverflow.com/users/9152099/kinote"}, "edited": false, "score": 0, "creation_date": 1550025125, "post_id": 54660413, "comment_id": 96114366, "body": "No worries, and thanks for the help! Say my search returned a value of 3, how could I make that call CCCC?"}], "tags": [], "owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "is_accepted": false, "score": 0, "last_activity_date": 1550021867, "last_edit_date": 1550021867, "creation_date": 1550015107, "answer_id": 54660413, "question_id": 54660240, "link": "https://stackoverflow.com/questions/54660240/vba-dictionary-calling-key-by-value/54660413#54660413", "title": "VBA - Dictionary Calling Key by Value?", "body": "<p>You could always create an additional dictionary to store your <code>Key-Value</code> pairs with your <code>Value</code> as your <code>key</code> and your <code>key</code> as the <code>value</code></p>\n\n<pre><code>Sub test()\nDim dSCAC As Object\nDim dSCACArr As Object\nDim varOtherSCAC As String\nDim key\nDim varSCAC\n\n\nSet dSCAC = CreateObject(\"Scripting.Dictionary\")\nSet dSCACArr = CreateObject(\"Scripting.Dictionary\")\n\ndSCAC.Add \"AAAA\", 1\ndSCAC.Add \"BBBB\", 2\ndSCAC.Add \"CCCC\", 3\ndSCAC.Add \"DDDD\", 4\n\nFor Each key In dSCAC.Keys\n    dSCACArr.Add dSCAC(key), key\nNext\n\nFor Each varSCAC In dSCAC.Keys\n    If dSCAC(varSCAC) Mod 2 Then\n            Debug.Print \"Odd \" &amp; \"PAPS\"\n            varOtherSCAC = dSCACArr(dSCAC(varSCAC) + 1)\n            Debug.Print \"Opposite SCAC is \" &amp; varOtherSCAC\n\n            Else\n            Debug.Print \"Even \" &amp; \" PARS\"\n            varOtherSCAC = dSCACArr(dSCAC(varSCAC) - 1)\n            Debug.Print \"Opposite SCAC is \" &amp; varOtherSCAC\n    End If\nNext\n\nEnd Sub\n</code></pre>\n\n<p>This yielded results</p>\n\n<pre><code>Odd PAPS\nOpposite SCAC is BBBB\nEven  PARS\nOpposite SCAC is AAAA\nOdd PAPS\nOpposite SCAC is DDDD\nEven  PARS\nOpposite SCAC is CCCC\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p><code>For Each varSCAC In dSCAC.Keys...Next</code> is only included for proof of concept.</p>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 9152099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e60e59f048b28abdb2964f17003fbe?s=128&d=identicon&r=PG&f=1", "display_name": "Kinote", "link": "https://stackoverflow.com/users/9152099/kinote"}, "edited": false, "score": 0, "creation_date": 1550028613, "post_id": 54661942, "comment_id": 96115171, "body": "I like the idea of a common interface, but I&#39;ve never dealt with class modules before so it might take a little while for me to wrap my head around. Thanks for the help!"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 27, "user_id": 9152099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e60e59f048b28abdb2964f17003fbe?s=128&d=identicon&r=PG&f=1", "display_name": "Kinote", "link": "https://stackoverflow.com/users/9152099/kinote"}, "edited": false, "score": 0, "creation_date": 1550028708, "post_id": 54661942, "comment_id": 96115203, "body": "@Kinote This would be the perfect opportunity to play with them.  ;-)  Stepping through the sample code line by line in the debugger will give you a pretty good idea of how it works.  You&#39;re basically implementing your own custom dictionary class."}, {"owner": {"reputation": 27, "user_id": 9152099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e60e59f048b28abdb2964f17003fbe?s=128&d=identicon&r=PG&f=1", "display_name": "Kinote", "link": "https://stackoverflow.com/users/9152099/kinote"}, "edited": false, "score": 0, "creation_date": 1550029350, "post_id": 54661942, "comment_id": 96115329, "body": "Compile Error: User-defined type not defined when I hit the class module - when it hits the first line <code>Private backing As Scripting.Dictionary</code>  - Might all be a little above my head, syntax wise. The concept of the double dictionary does indeed solve my issue, the syntax for making it work... that&#39;ll take a while. I kind of stumbled into getting my current one working when my other modules interact with it."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 27, "user_id": 9152099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e60e59f048b28abdb2964f17003fbe?s=128&d=identicon&r=PG&f=1", "display_name": "Kinote", "link": "https://stackoverflow.com/users/9152099/kinote"}, "edited": false, "score": 0, "creation_date": 1550029910, "post_id": 54661942, "comment_id": 96115461, "body": "@Kinote That&#39;s the comment at the top - you either need to add a reference to the Microsoft Scripting Runtime (better) or <a href=\"https://stackoverflow.com/q/50583705/4088852\">change it to late binding</a>."}, {"owner": {"reputation": 27, "user_id": 9152099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e60e59f048b28abdb2964f17003fbe?s=128&d=identicon&r=PG&f=1", "display_name": "Kinote", "link": "https://stackoverflow.com/users/9152099/kinote"}, "edited": false, "score": 0, "creation_date": 1550031393, "post_id": 54661942, "comment_id": 96115774, "body": "Ah. Kind of figured that&#39;s what I was missing. How would I go about adding a reference to the MSR? Apologies for all the rookie questions!"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 27, "user_id": 9152099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e60e59f048b28abdb2964f17003fbe?s=128&d=identicon&r=PG&f=1", "display_name": "Kinote", "link": "https://stackoverflow.com/users/9152099/kinote"}, "edited": false, "score": 0, "creation_date": 1550031717, "post_id": 54661942, "comment_id": 96115842, "body": "Tools -&gt; References... find Microsoft Scripting Runtime (scroll <i>way</i> down), check the box, then hit [OK].  That&#39;s all there is to it."}, {"owner": {"reputation": 27, "user_id": 9152099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e60e59f048b28abdb2964f17003fbe?s=128&d=identicon&r=PG&f=1", "display_name": "Kinote", "link": "https://stackoverflow.com/users/9152099/kinote"}, "edited": false, "score": 0, "creation_date": 1550101916, "post_id": 54661942, "comment_id": 96151283, "body": "Found it! Code seems to run just fine now and looks very interesting, I&#39;ll tinker with it a bit when I get some time. Thanks for all the help!"}, {"owner": {"reputation": 27, "user_id": 9152099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e60e59f048b28abdb2964f17003fbe?s=128&d=identicon&r=PG&f=1", "display_name": "Kinote", "link": "https://stackoverflow.com/users/9152099/kinote"}, "edited": false, "score": 0, "creation_date": 1550106872, "post_id": 54661942, "comment_id": 96152587, "body": "Any idea why it only works in the third case? <code>&#39;Test 1 - Doesn&#39;t work     Dim strTestSCACValue As String: strTestSCACValue = &quot;3&quot;     Debug.Print sample.KeyFromValue(strTestSCACValue)     &#39;Test 2 - Doesn&#39;t work     Dim intTestSCACValue: intTestSCACValue = &quot;3&quot;     Debug.Print sample.KeyFromValue(intTestSCACValue)     &#39;Test 3 - Works     intTestSCACValue = 3     Debug.Print sample.KeyFromValue(intTestSCACValue)</code>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 27, "user_id": 9152099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e60e59f048b28abdb2964f17003fbe?s=128&d=identicon&r=PG&f=1", "display_name": "Kinote", "link": "https://stackoverflow.com/users/9152099/kinote"}, "edited": false, "score": 0, "creation_date": 1550107942, "post_id": 54661942, "comment_id": 96152802, "body": "@Kinote That doesn&#39;t work with <i>any</i> <code>Dictionary</code>. The first 2 are <code>String</code>s, the last one is an <code>Integer</code>. The key is stored as a hash, so the type has to match."}, {"owner": {"reputation": 27, "user_id": 9152099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e60e59f048b28abdb2964f17003fbe?s=128&d=identicon&r=PG&f=1", "display_name": "Kinote", "link": "https://stackoverflow.com/users/9152099/kinote"}, "edited": false, "score": 0, "creation_date": 1550109287, "post_id": 54661942, "comment_id": 96153129, "body": "Well don&#39;t I feel dumb. This whole time I&#39;ve just been using the wrong type of variable to interact with it! Thanks again!"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 1, "last_activity_date": 1550027621, "creation_date": 1550027621, "answer_id": 54661942, "question_id": 54660240, "link": "https://stackoverflow.com/questions/54660240/vba-dictionary-calling-key-by-value/54661942#54661942", "title": "VBA - Dictionary Calling Key by Value?", "body": "<p>I'd take similar approach to @TateGarringer's, but wrap the two <code>Dictionary</code> objects in a class to give them a common interface and make the thing easier to use:</p>\n\n<pre><code>'In a class module named MirroredDictionary.cls (add reference to Scripting Runtime)\nOption Explicit\n\nPrivate backing As Scripting.Dictionary\nPrivate mirror As Scripting.Dictionary\n\nPrivate Sub Class_Initialize()\n    Set backing = New Scripting.Dictionary\n    Set mirror = New Scripting.Dictionary\nEnd Sub\n\nPublic Sub Add(Key As Variant, Value As Variant)\n    backing.Add Key, Value\n    mirror.Add Value, Key\nEnd Sub\n\nPublic Function KeyExists(Key As Variant) As Boolean\n    KeyExists = backing.Exists(Key)\nEnd Function\n\nPublic Function ValueExists(Value As Variant) As Boolean\n    ValueExists = mirror.Exists(Value)\nEnd Function\n\nPublic Function ValueFromKey(Key As Variant) As Variant\n    ValueFromKey = backing.Item(Key)\nEnd Function\n\nPublic Function KeyFromValue(Value As Variant) As Variant\n    KeyFromValue = mirror.Item(Value)\nEnd Function\n</code></pre>\n\n<p>Depending on how you intend to use this, you may or may not want to wrap additional functions. Usage would be similar to a normal <code>Dictionary</code> (aside from some differences in the property names, although you can change those to taste):</p>\n\n<pre><code>Public Sub Example()\n    Set sample = New MirroredDictionary\n\n    sample.Add \"AAAA\", 1\n    sample.Add \"BBBB\", 2\n    sample.Add \"CCCC\", 3\n    sample.Add \"DDDD\", 4\n\n    Debug.Print sample.ValueFromKey(\"AAAA\")     '1\n    Debug.Print sample.KeyFromValue(1)          'AAAA\n    Debug.Print sample.ValueFromKey(\"BBBB\")     '2\n    Debug.Print sample.KeyFromValue(2)          'BBBB\n    Debug.Print sample.ValueFromKey(\"CCCC\")     '3\n    Debug.Print sample.KeyFromValue(3)          'CCCC\n    Debug.Print sample.ValueFromKey(\"DDDD\")     '4\n    Debug.Print sample.KeyFromValue(4)          'DDDD\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 9152099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e60e59f048b28abdb2964f17003fbe?s=128&d=identicon&r=PG&f=1", "display_name": "Kinote", "link": "https://stackoverflow.com/users/9152099/kinote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 54661942, "answer_count": 2, "score": 0, "last_activity_date": 1592692173, "creation_date": 1550014049, "last_edit_date": 1592692173, "question_id": 54660240, "link": "https://stackoverflow.com/questions/54660240/vba-dictionary-calling-key-by-value", "title": "VBA - Dictionary Calling Key by Value?", "body": "<p>It seems most of the answers for this involve C# so I felt relatively safe asking:</p>\n\n<p>I need to call a dictionary key by it's value. I have a dictionary object with a list of four character keys. For Example:</p>\n\n<pre><code>dSCAC.Add \"AAAA\", 1\ndSCAC.Add \"BBBB\", 2\ndSCAC.Add \"CCCC\", 3\ndSCAC.Add \"DDDD\", 4\n</code></pre>\n\n<p>etc.</p>\n\n<p>I've been able to call the value associated with a key when it's found in a string (in this case, an email subject line) and then add or remove 1 from the value. </p>\n\n<p>Ex: BBBB is detected, value is 2. Modify the value and call the appropriate key. In this case, in the end we'd want varOtherSCAC = AAAA.</p>\n\n<pre><code>If dSCAC(varSCAC) Mod 2 Then\n        Debug.Print \"Odd \" &amp; \"PAPS\"\n        varOtherSCAC = (dSCAC(varSCAC) + 1)            \n        Debug.Print \"Opposite SCAC is \" &amp; varOtherSCAC\n\n        Else\n        Debug.Print \"Even \" &amp; \" PARS\"\n        varOtherSCAC = (dSCAC(varSCAC) - 1)\n        Debug.Print \"Opposite SCAC is \" &amp; varOtherSCAC\nEnd if\n</code></pre>\n\n<p>I haven't been able to work out the syntax for calling the new key based on this value. Is it even possible in VBA? Is there a way around this?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1550024549, "post_id": 54660060, "comment_id": 96114251, "body": "How are you importing the text data? If it&#39;s a problem with the delimiter (based on your description of the behavior), that&#39;s likely more relevant code than the pivot cache creation."}], "owner": {"reputation": 11, "user_id": 8191210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6451e8a7aa6ab727133192be9e2227a7?s=128&d=identicon&r=PG&f=1", "display_name": "Pete.R", "link": "https://stackoverflow.com/users/8191210/pete-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1550013042, "creation_date": 1550013042, "question_id": 54660060, "link": "https://stackoverflow.com/questions/54660060/program-works-when-parsing-semicolon-as-semicolon-true-doesnt-work-when-tab", "title": "Program Works When Parsing Semicolon as &quot;Semicolon:=True&quot; doesn&#39;t work when &quot;Tab:=True&quot;", "body": "<p>I am trying to modify existing code that allows the user to create charts from text data. This code works when the incoming files data uses semicolons to separate the different data it works, but when I changed it to parse using tabs it does not work. The following is the error message that I get:</p>\n\n<p>\"Run time error '1004',The pivotTable name is not valid, to create a PivotTable report, you must use data that is organize as a list with labeled columns. If you are changing the name of a PivotTable Field, you must type a new name for the field.\"</p>\n\n<p>I have tried a few things including changing the name of the PivotTable but that has not worked. </p>\n\n<p>Any help would be appreciated!</p>\n\n<p>I am new to VBA, with no prior experience. I have been given this code to make it work with Text(tab delimited) files.</p>\n\n<pre><code>\n\n    Range(\"A1\").Select\n    Sheets.Add\n    ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n        \"'ISEDIS_Data'!R1C1:R5000C81\", Version:= _\n        xlPivotTableVersion14).CreatePivotTable \n    TableDestination:=\"Sheet1!R3C1\", _\n        TableName:=\"MYTable2\", DefaultVersion:=xlPivotTableVersion14\n\n</code></pre>\n\n<p>The expected output is an excel workbook with 5 tabs. The first four being charts, while the last being the excel data parsed in separate cells.</p>\n"}, {"tags": ["excel", "vba", "performance"], "comments": [{"owner": {"reputation": 113, "user_id": 11053389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cb53c6eaf76dfe18ff9d4b3a3ed3548?s=128&d=identicon&r=PG&f=1", "display_name": "Starshine", "link": "https://stackoverflow.com/users/11053389/starshine"}, "edited": false, "score": 0, "creation_date": 1550011295, "post_id": 54659759, "comment_id": 96111024, "body": "Wasn&#39;t sure about &quot;Performance&quot; tag.  Please remove if inappropriate."}, {"owner": {"reputation": 113, "user_id": 11053389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cb53c6eaf76dfe18ff9d4b3a3ed3548?s=128&d=identicon&r=PG&f=1", "display_name": "Starshine", "link": "https://stackoverflow.com/users/11053389/starshine"}, "edited": false, "score": 0, "creation_date": 1550011472, "post_id": 54659759, "comment_id": 96111097, "body": "For anybody stumbling across this in search of an answer to &quot;why does Excel want me to save?&quot;: This is an Event.  It should be saved in the ThisWorkbook code section."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 11053389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cb53c6eaf76dfe18ff9d4b3a3ed3548?s=128&d=identicon&r=PG&f=1", "display_name": "Starshine", "link": "https://stackoverflow.com/users/11053389/starshine"}, "edited": false, "score": 0, "creation_date": 1550078805, "post_id": 54660028, "comment_id": 96141411, "body": "-Thanks for confirming my suspicions.  Now to just get all of those other search results to agree..."}], "tags": [], "owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "is_accepted": true, "score": 0, "last_activity_date": 1550013483, "last_edit_date": 1550013483, "creation_date": 1550012837, "answer_id": 54660028, "question_id": 54659759, "link": "https://stackoverflow.com/questions/54659759/activeworkbook-saved-versus-thisworkbook-saved-versus-me-saved/54660028#54660028", "title": "ActiveWorkbook.Saved versus ThisWorkbook.Saved versus Me.Saved", "body": "<p><strong><code>ActiveWorkbook</code></strong></p>\n\n<p>I would argue that there <em>are no pros</em> to using <code>ActiveWorkbook</code>, as a direct reference to what you're working with should <strong>always</strong> be preferable, especially in the case stated above where multiple workbooks are involved. Even in the event of opening and working with arbitrary workbooks whose names you don't specifically know (via a <code>FSO</code> or <code>Dir()</code> loop), you can always set a workbook variable equal to the return value of a <code>Workbook.Open</code> function.</p>\n\n<p><strong><code>ThisWorkbook</code></strong></p>\n\n<p>Any time you have code working with more than one workbook or even code working with one workbook while multiple workbooks are open, I would recommend <code>ThisWorkbook</code>. It is versatile in that it can be used in object code modules and generic modules to return a consistent reference to the workbook it is placed within. There really aren't any cons to explicitly specifying <code>ThisWorkbook</code> when that's what you mean to reference.</p>\n\n<p><strong><code>Me</code></strong></p>\n\n<p><code>Me</code> and <code>ThisWorkbook</code> are interchangeable when using them inside the <code>ThisWorkbook</code> object code module, but outside of that, <code>Me</code> refers to the object which it is placed within. For instance <code>Me.Name</code> inside a worksheet object code module will get you the name of the worksheet. Doing the same inside the workbook code module will get you the name of the workbook.</p>\n\n<p>For the sake of clarity and re-usability, I would personally recommend <code>ThisWorkbook</code> out of all 3.</p>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 11018220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6da19de87f1b07b0c9689dacf9dfd6e?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Watt", "link": "https://stackoverflow.com/users/11018220/mr-watt"}, "edited": false, "score": 0, "creation_date": 1550070866, "post_id": 54660065, "comment_id": 96136671, "body": "@Starshine, apparently you do not like any of the answers. Perhaps you should clarify your question to get a more appropriate answer. What is the issue and the desired solution?"}, {"owner": {"reputation": 113, "user_id": 11053389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cb53c6eaf76dfe18ff9d4b3a3ed3548?s=128&d=identicon&r=PG&f=1", "display_name": "Starshine", "link": "https://stackoverflow.com/users/11053389/starshine"}, "edited": false, "score": 0, "creation_date": 1550078955, "post_id": 54660065, "comment_id": 96141498, "body": "I was not the down-voter, but I tend to agree with it. I don&#39;t believe &quot;Me&quot; can refer to anything other than the object it is being used within."}, {"owner": {"reputation": 55, "user_id": 11018220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6da19de87f1b07b0c9689dacf9dfd6e?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Watt", "link": "https://stackoverflow.com/users/11018220/mr-watt"}, "reply_to_user": {"reputation": 113, "user_id": 11053389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cb53c6eaf76dfe18ff9d4b3a3ed3548?s=128&d=identicon&r=PG&f=1", "display_name": "Starshine", "link": "https://stackoverflow.com/users/11053389/starshine"}, "edited": false, "score": 0, "creation_date": 1550179914, "post_id": 54660065, "comment_id": 96185660, "body": "Thanks for the response Starshine. I did not realise that &quot;me&quot; was a special name, I thought you used it as a variable. Updated the text accordingly"}], "tags": [], "owner": {"reputation": 55, "user_id": 11018220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6da19de87f1b07b0c9689dacf9dfd6e?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Watt", "link": "https://stackoverflow.com/users/11018220/mr-watt"}, "is_accepted": false, "score": -1, "last_activity_date": 1550180308, "last_edit_date": 1550180308, "creation_date": 1550013053, "answer_id": 54660065, "question_id": 54659759, "link": "https://stackoverflow.com/questions/54659759/activeworkbook-saved-versus-thisworkbook-saved-versus-me-saved/54660065#54660065", "title": "ActiveWorkbook.Saved versus ThisWorkbook.Saved versus Me.Saved", "body": "<p><strong>Active workbook</strong> is the workbook that is in use/activated (hence can change during code execution) and thus less reliable.</p>\n\n<p><strong>This workbook</strong> is the workbook on which the code is run. Hence, a good option if that is the workbook you want to refer to.  </p>\n\n<p><strong>\"Me\"</strong> refers to where the code is. E.g. if in sheetmodule, it refers to that sheet, if in a userform module it refers to that module, if in thisworkbook module it is the same as 'thisworkbook', etc. </p>\n\n<p>Defining a <strong>variable</strong> as workbook can refer to any open workbook. Can be redefined as desired in the code and hence very flexible as long as you know the name of the book</p>\n\n<p>Application.DisplayAlerts = False can be used to suppress save/overwrite requests. Which can be very handy if you do not want users to receive a prompt.<br>\n Do re-enable as this is a powerful yet 'dangerous' piece of code.</p>\n"}], "owner": {"reputation": 113, "user_id": 11053389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cb53c6eaf76dfe18ff9d4b3a3ed3548?s=128&d=identicon&r=PG&f=1", "display_name": "Starshine", "link": "https://stackoverflow.com/users/11053389/starshine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 613, "favorite_count": 0, "accepted_answer_id": 54660028, "answer_count": 2, "score": 0, "last_activity_date": 1550180308, "creation_date": 1550011265, "question_id": 54659759, "link": "https://stackoverflow.com/questions/54659759/activeworkbook-saved-versus-thisworkbook-saved-versus-me-saved", "title": "ActiveWorkbook.Saved versus ThisWorkbook.Saved versus Me.Saved", "body": "<p>I write Excel VBA reports that tap into SQL databases.  I'm also in a company that uses dozens of such reports, and any user could have multiple such reports open at once from multiple different sources.  Because of this, it is paramount that code does not affect or interfere with any other open workbooks.</p>\n\n<p>My current report unavoidably uses volatile functions, so users that open and then immediately close the file will get prompted with a Save? dialog.  Searching online has always pointed to using </p>\n\n<pre><code>Private Sub Workbook_Open()\n    ActiveWorkbook.Saved = True\nEnd Sub\n</code></pre>\n\n<p>While effective, I've never been a big fan because of the non-specific nature of \"ActiveWorkbook\".</p>\n\n<p><B>Question:</B></p>\n\n<p>What are the pros/cons/pitfalls of using any of the following options-</p>\n\n<ol>\n<li>ActiveWorkbook.Saved</li>\n<li>ThisWorkbook.Saved</li>\n<li>Me.Saved</li>\n<li>Something_I_haven't_thought_of.Saved</li>\n</ol>\n"}, {"tags": ["sql", "excel", "vba", "where", "adodb"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 1, "creation_date": 1550010749, "post_id": 54659558, "comment_id": 96110824, "body": "Can&#39;t see anything wrong with your WHERE clause. But what is <code>MaxCars</code>?  Did you try <code>debug.print strSQL</code> before <code>rs.Open</code> to check the SQL you&#39;re building?"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 1, "creation_date": 1550011446, "post_id": 54659558, "comment_id": 96111079, "body": "When you attempt the data pull with the where-clause, do you get any errors? If so, which errors?"}, {"owner": {"reputation": 43, "user_id": 10675749, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ThtVCZYNKio/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jyM9znRoKYGMWsX2JeGjfLG1AglA/mo/photo.jpg?sz=128", "display_name": "Allied Stack", "link": "https://stackoverflow.com/users/10675749/allied-stack"}, "edited": false, "score": 0, "creation_date": 1550068370, "post_id": 54659558, "comment_id": 96134960, "body": "Here is what I get for strSQL in the watch window.  I will post the error message into the question itself...  &quot;SELECT * FROM [Data$A2:G1000] where [First]=&#39;JOHN&#39;&quot;"}, {"owner": {"reputation": 43, "user_id": 10675749, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ThtVCZYNKio/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jyM9znRoKYGMWsX2JeGjfLG1AglA/mo/photo.jpg?sz=128", "display_name": "Allied Stack", "link": "https://stackoverflow.com/users/10675749/allied-stack"}, "edited": false, "score": 0, "creation_date": 1550069659, "post_id": 54659558, "comment_id": 96135813, "body": "I replaced MaxCars with 1000."}, {"owner": {"reputation": 43, "user_id": 10675749, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ThtVCZYNKio/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jyM9znRoKYGMWsX2JeGjfLG1AglA/mo/photo.jpg?sz=128", "display_name": "Allied Stack", "link": "https://stackoverflow.com/users/10675749/allied-stack"}, "edited": false, "score": 0, "creation_date": 1550070042, "post_id": 54659558, "comment_id": 96136100, "body": "I also tried:      strSQL = &quot;SELECT * FROM [Data$A2:&quot; + Trim(temp) + &quot;] where [First] = &quot;&quot;JOHN&quot;&quot;&quot;        same error."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1550073672, "post_id": 54659558, "comment_id": 96138384, "body": "Do you get the error if you remove the <code>where [First]=&#39;JOHN&#39;</code>?"}, {"owner": {"reputation": 43, "user_id": 10675749, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ThtVCZYNKio/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jyM9znRoKYGMWsX2JeGjfLG1AglA/mo/photo.jpg?sz=128", "display_name": "Allied Stack", "link": "https://stackoverflow.com/users/10675749/allied-stack"}, "edited": false, "score": 0, "creation_date": 1550075130, "post_id": 54659558, "comment_id": 96139309, "body": "I think its the connection... I am not sure yet.  Looking into it."}, {"owner": {"reputation": 43, "user_id": 10675749, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ThtVCZYNKio/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jyM9znRoKYGMWsX2JeGjfLG1AglA/mo/photo.jpg?sz=128", "display_name": "Allied Stack", "link": "https://stackoverflow.com/users/10675749/allied-stack"}, "edited": false, "score": 0, "creation_date": 1550076127, "post_id": 54659558, "comment_id": 96139962, "body": "how would you know what connection to use.  i usually find, cut and paste.  is there a web page explaining which connection to use... I am using 32 bit version of office on 64 bit machine.   But if it was a connection issue, then it shouldn&#39;t have worked without the where condition either, right?  so maybe its not the connection....."}, {"owner": {"reputation": 43, "user_id": 10675749, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ThtVCZYNKio/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jyM9znRoKYGMWsX2JeGjfLG1AglA/mo/photo.jpg?sz=128", "display_name": "Allied Stack", "link": "https://stackoverflow.com/users/10675749/allied-stack"}, "edited": false, "score": 0, "creation_date": 1550082260, "post_id": 54659558, "comment_id": 96143212, "body": "CLR, without where clause it pulls fine."}], "answers": [{"comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1550148856, "post_id": 54678905, "comment_id": 96169241, "body": "Ha! Yes, I see it now. Looking in row 2 for your headers. Can&#39;t believe I didn&#39;t spot that."}], "tags": [], "owner": {"reputation": 43, "user_id": 10675749, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ThtVCZYNKio/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jyM9znRoKYGMWsX2JeGjfLG1AglA/mo/photo.jpg?sz=128", "display_name": "Allied Stack", "link": "https://stackoverflow.com/users/10675749/allied-stack"}, "is_accepted": true, "score": -1, "last_activity_date": 1550089781, "creation_date": 1550089781, "answer_id": 54678905, "question_id": 54659558, "link": "https://stackoverflow.com/questions/54659558/syntax-problem-how-to-use-where-clause-within-excel-for-pulling-from-worksheet/54678905#54678905", "title": "Syntax problem--How to use Where clause within Excel for pulling from Worksheet", "body": "<p>big boo boo... I needed to start with A1 and include the titles in my range.\nIt wasn't a syntax error, but vBA doesn't give you very good error messages!</p>\n"}], "owner": {"reputation": 43, "user_id": 10675749, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ThtVCZYNKio/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jyM9znRoKYGMWsX2JeGjfLG1AglA/mo/photo.jpg?sz=128", "display_name": "Allied Stack", "link": "https://stackoverflow.com/users/10675749/allied-stack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 1, "accepted_answer_id": 54678905, "answer_count": 1, "score": -2, "last_activity_date": 1550089781, "creation_date": 1550010126, "last_edit_date": 1550069641, "question_id": 54659558, "link": "https://stackoverflow.com/questions/54659558/syntax-problem-how-to-use-where-clause-within-excel-for-pulling-from-worksheet", "title": "Syntax problem--How to use Where clause within Excel for pulling from Worksheet", "body": "<p>I figured out how to pull, but having trouble limiting the result.\nHow do you pull with a where clause.</p>\n\n<p>See picture that shows my sheet structure for a tab called \"Data\"</p>\n\n<p>See code below to pull the data.</p>\n\n<p>I am trying to figure out the right syntax for composing the strSQL variable below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/F4mqH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F4mqH.png\" alt=\"Excel with Sheet named Data\"></a></p>\n\n<p>Here is what I get:\n! Run-time error '-2147217904 (80040e10)':  Automation error</p>\n\n<p>My sql string looks like this through the watch window:\n\"SELECT * FROM [Data$A2:G1000] where [First]='JOHN'\"</p>\n\n<p>CODE:</p>\n\n<pre><code>Sub SQL()\n\n    Dim cn As ADODB.Connection\n    Dim strFile As String\n    Dim strCon As String\n    Dim strSQL As String\n\n\n\n    Dim rs As ADODB.Recordset\n\n    strFile = ThisWorkbook.FullName\n    strCon = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; strFile _\n    &amp; \";Extended Properties=\"\"Excel 12.0;HDR=Yes;IMEX=1\"\";\"\n\n    Set cn = CreateObject(\"ADODB.Connection\")\n    Set rs = CreateObject(\"ADODB.Recordset\")\n\n    cn.Open strCon\n\n    Dim temp As String\n    temp = Trim(\"G\" + Trim(Str(1000)))\n\n\n    strSQL = \"SELECT * FROM [Data$A2:\" + Trim(temp) + \"] where [First]='JOHN'\"\n\n    rs.Open strSQL, cn\n\n    MsgBox rs.GetString\n\n    MsgBox \"Data Loaded\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-tables"], "comments": [{"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 1, "creation_date": 1550009688, "post_id": 54659070, "comment_id": 96110463, "body": "Try <code>DataBodyRange.Delete</code> instead of <code>Selection.EntireRow.Delete</code>.  This post may help you out.  <a href=\"https://stackoverflow.com/questions/20663491/delete-all-data-rows-from-an-excel-table-apart-from-the-first\" title=\"delete all data rows from an excel table apart from the first\">stackoverflow.com/questions/20663491/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 7885268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dd5321500837661a0acfab6a34794919?s=128&d=identicon&r=PG&f=1", "display_name": "MSauce", "link": "https://stackoverflow.com/users/7885268/msauce"}, "edited": false, "score": 0, "creation_date": 1550071177, "post_id": 54659564, "comment_id": 96136882, "body": "Almost there! One issue is that if the criteria isn&#39;t there, in this example &quot;Apple&quot;, I get a Run-Time error &#39;1004&#39;: Application-defined or object-defined error . This table changes month to month, so the value isn&#39;t always there."}, {"owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "reply_to_user": {"reputation": 113, "user_id": 7885268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dd5321500837661a0acfab6a34794919?s=128&d=identicon&r=PG&f=1", "display_name": "MSauce", "link": "https://stackoverflow.com/users/7885268/msauce"}, "edited": false, "score": 0, "creation_date": 1550118719, "post_id": 54659564, "comment_id": 96155103, "body": "Use a Subtotal Count to test for how many cells exist in your filtered table. I&#39;ll edit my answer to reflect that."}], "tags": [], "owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "is_accepted": false, "score": 3, "last_activity_date": 1550118754, "last_edit_date": 1550118754, "creation_date": 1550010144, "answer_id": 54659564, "question_id": 54659070, "link": "https://stackoverflow.com/questions/54659070/delete-table-row-based-on-criteria-vba/54659564#54659564", "title": "Delete Table Row Based on Criteria VBA", "body": "<p>You could use <code>.DataBodyRange</code> and <code>.SpecialCells(xlCellTypeVisible)</code> to set a range variable equal to the filtered ranges, then unfilter and delete:</p>\n\n<pre><code>Dim dRng As Range\nWith ActiveSheet.ListObjects(\"Table1\")\n    .Range.AutoFilter Field:=1, Criteria1:=\"Apple\"\n    If WorksheetFunction.Subtotal(2, .DataBodyRange) &gt; 0 Then\n        Set dRng = .DataBodyRange.SpecialCells(xlCellTypeVisible)\n        .Range.AutoFilter\n        dRng.Delete xlUp\n    End If\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 11018220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6da19de87f1b07b0c9689dacf9dfd6e?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Watt", "link": "https://stackoverflow.com/users/11018220/mr-watt"}, "is_accepted": false, "score": 0, "last_activity_date": 1550011738, "last_edit_date": 1550011738, "creation_date": 1550011313, "answer_id": 54659765, "question_id": 54659070, "link": "https://stackoverflow.com/questions/54659070/delete-table-row-based-on-criteria-vba/54659765#54659765", "title": "Delete Table Row Based on Criteria VBA", "body": "<p>You will have to indicate which cells/range you want to delete. You can find the relevant row by using the find function. Since your table is static I would propose the following macro.\nA for loop checking each row is also possible, but not so efficient for a very large table. It can be useful to prepare your dataset by adding a flag to column c (e.g. a 1 if to be deleted).</p>\n\n<p>EDIT suggestion by Tate also looks pretty clean</p>\n\n<pre><code>Sub tabledelete()\n\nDim ws As Worksheet\nDim rangecheck As Range\nDim rcheck As Integer\n\nSet ws = Sheets(\"Sheet1\") 'fill in name of relevant sheet\nSet rangecheck = Range(\"A1\") ' dummy to get the do function started\n\nDo While Not rangecheck Is Nothing\nWith ws\n    With .Range(\"C2:C30\") ' fill in relevant range of table\n        Set rangecheck = .Find(what:=1, LookAt:=xlWhole)\n    End With\nIf Not rangecheck Is Nothing Then 'only do something if a 1 is found\nrcheck = rangecheck.Row\n.Range(.Cells(rcheck, 1), .Cells(rcheck, 3)).Delete Shift:=xlUp 'delete 3 columns in row found\nEnd If\n\nEnd With\n\nLoop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 7885268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dd5321500837661a0acfab6a34794919?s=128&d=identicon&r=PG&f=1", "display_name": "MSauce", "link": "https://stackoverflow.com/users/7885268/msauce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1271, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1550118754, "creation_date": 1550007641, "last_edit_date": 1550043585, "question_id": 54659070, "link": "https://stackoverflow.com/questions/54659070/delete-table-row-based-on-criteria-vba", "title": "Delete Table Row Based on Criteria VBA", "body": "<p>I am attempting to delete a specific table row based on values in two columns. I attempted to apply filters to the table columns to narrow my criteria, but once I click delete, the ENTIRE ROW is deleted causing values outside of the table to be deleted. Also, the macro recorder isn't as dynamic as I'd like it to be, since it ONLY selects the cell I clicked while recording.</p>\n\n<pre><code>   Sub Macro2()\n    '\n    ' Macro2 Macro\n    '\n    '\n         ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=1, Criteria1:= _\n    \"Apple\"                               \\\\Narrowing criteria in Column 1 of the table\n         Range(\"A4\").Select               \\\\This only applies to a specific cell, and the value can shift\n         Selection.EntireRow.Delete       \\\\This will delete the entire sheet row, I'd like for only the table row to be deleted    \n         Range(\"A5\").Select\n         Selection.EntireRow.Delete\n         Selection.EntireRow.Delete\n    End Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/qNzeP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qNzeP.png\" alt=\"enter image description here\"></a></p>\n\n<p>Is there a way to find the desired string in a column and delete only the rows in the table once the criteria is met? I attempted to only delete the ListObject.ListRows, but it only references the row I've selected, and not the one based off criteria. </p>\n"}, {"tags": ["excel", "vba", "binaryfiles"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1550007787, "post_id": 54658840, "comment_id": 96109761, "body": "You mean <a href=\"https://stackoverflow.com/a/26363210/4088852\">like this</a>?"}, {"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1550014347, "post_id": 54658840, "comment_id": 96111945, "body": "I&#39;m not sure if that link answers my question"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1550014574, "post_id": 54658840, "comment_id": 96112015, "body": "You&#39;re outputting 4 bytes of <code>String</code> for each value (2 per character). You just need to convert them to numbers from hex strings.  That link answers the question of how to do that."}], "answers": [{"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 3, "last_activity_date": 1550018315, "creation_date": 1550018315, "answer_id": 54660806, "question_id": 54658840, "link": "https://stackoverflow.com/questions/54658840/write-hex-string-to-file-in-binary-mode/54660806#54660806", "title": "Write hex-string to file in binary mode", "body": "<p>Your data represents Hex values of bytes to be wriiten to a binary file.  <code>Split</code> produces an array of strings, each element being a string represention of a hex value.  As Comintern told you, you need to convert them to numbers.</p>\n\n<p><code>Put</code> uses the type of the <code>Varname</code> parameter to determine the length (number of bytes) to write, so in this case you need to convert to <code>Byte</code>, so use <code>CByte</code> to convert. <code>CByte</code> also needs to know the values are Hex, so prepend with <code>&amp;H</code></p>\n\n<p>All up, your code becomes</p>\n\n<pre><code>Sub Write2Binary()\n    Dim i As Long\n    Dim nFileNum As Integer\n    Dim sFilename As String\n    Dim strBytes As String\n    Dim arrBytes As Variant\n\n    sFilename = \"D:\\OutputPath\\Test.bin\"\n\n    strBytes = \"F3 A1 02 00 04 00 8D 24 44 C3 8C 03 83 49 26 92 B5\"\n    arrBytes = Split(strBytes)\n\n    nFileNum = FreeFile\n\n    Open sFilename For Binary Lock Read Write As #nFileNum\n\n    For i = LBound(arrBytes) To UBound(arrBytes)\n        Put #nFileNum, , CByte(\"&amp;H\" &amp; arrBytes(i))\n    Next i\n\n    Close #nFileNum\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 717, "favorite_count": 0, "accepted_answer_id": 54660806, "answer_count": 1, "score": 0, "last_activity_date": 1550018315, "creation_date": 1550006441, "question_id": 54658840, "link": "https://stackoverflow.com/questions/54658840/write-hex-string-to-file-in-binary-mode", "title": "Write hex-string to file in binary mode", "body": "<p>I want to write the hexadecimal values to a binary file in order they look the same when I open in hex editor.</p>\n\n<p>My current code is this:</p>\n\n<pre><code>Sub Write2Binary()\nDim i As Integer\nDim nFileNum As Integer\nDim sFilename As String\n\nsFilename = \"D:\\OutputPath\\Test.bin\"\n\nstrBytes = \"F3 A1 02 00 04 00 8D 24 44 C3 8C 03 83 49 26 92 B5\"\narrBytes = Split(strBytes)\n\nnFileNum = FreeFile\n\nOpen sFilename For Binary Lock Read Write As #nFileNum\n\nFor i = LBound(arrBytes) To UBound(arrBytes)\n    Put #nFileNum, , arrBytes(i)\nNext i\n\nClose #nFileNum\n\nEnd Sub\n</code></pre>\n\n<p>This code produces the following binary file that when I open it in a Hex editor looks like this:</p>\n\n<pre><code>08 00 02 00 46 33 08 00 02 00 41 31 08 00 02 00 \n30 32 08 00 02 00 30 30 08 00 02 00 30 34 08 00 \n02 00 30 30 08 00 02 00 38 44 08 00 02 00 32 34 \n08 00 02 00 34 34 08 00 02 00 43 33 08 00 02 00 \n38 43 08 00 02 00 30 33 08 00 02 00 38 33 08 00 \n02 00 34 39 08 00 02 00 32 36 08 00 02 00 39 32 \n08 00 02 00 42 35 \n</code></pre>\n\n<p>That is different to the content I want to have in binary file. When I open the file in Hex editor I like to see the following content:</p>\n\n<pre><code>F3 A1 02 00 04 00 8D 24 44 C3 8C 03 83 49 26 92 B5\n</code></pre>\n\n<p>How can I do this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 1, "creation_date": 1550011209, "post_id": 54658739, "comment_id": 96110995, "body": "What error are you getting? I was able to use <code>[]</code> successfully, like <code>tbl = &quot;[PRELEVEMENT PRODUIT]&quot;        rs.Open tbl, cn, adOpenKeyset, adLockOptimistic</code>."}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1550011343, "post_id": 54658739, "comment_id": 96111043, "body": "Maybe try different arguments in your <code>Open</code> method like <code>rs.Open tbl, cn, adOpenStatic</code>. If that works, then it&#39;s not letting you open it or lock the way you want."}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1550017216, "creation_date": 1550017216, "answer_id": 54660673, "question_id": 54658739, "link": "https://stackoverflow.com/questions/54658739/space-in-the-name-of-sql-table/54660673#54660673", "title": "space in the name of sql table", "body": "<p>That's weird!  It works fine for me in my test scenario!</p>\n\n<pre><code>Sub ADOExcelSQLServer()\n     '\n     ' FOR THIS CODE TO WORK\n     ' In VBE you need to go Tools References and check Microsoft Active X Data Objects 2.x library\n     '\n\n    Dim Cn As ADODB.Connection\n    Dim Server_Name As String\n    Dim Database_Name As String\n    Dim User_ID As String\n    Dim Password As String\n    Dim SQLStr As String\n    Dim rs As ADODB.Recordset\n    Set rs = New ADODB.Recordset\n\n    Server_Name = \"EXCEL-PC\\SQLEXPRESS\" ' Enter your server name here\n    Database_Name = \"Test Method\" ' Enter your database name here\n    User_ID = \"\" ' enter your user ID here\n    Password = \"\" ' Enter your password here\n    SQLStr = \"SELECT * FROM [mytable]\" ' Enter your SQL here\n\n    Set Cn = New ADODB.Connection\n    Cn.Open \"Driver={SQL Server};Server=\" &amp; Server_Name &amp; \";Database=\" &amp; Database_Name &amp; _\n    \";Uid=\" &amp; User_ID &amp; \";Pwd=\" &amp; Password &amp; \";\"\n\n    rs.Open SQLStr, Cn, adOpenStatic\n     ' Dump to spreadsheet\n    For iCols = 0 To rs.Fields.Count - 1\n        Worksheets(\"Sheet1\").Cells(1, iCols + 1).Value = rs.Fields(iCols).Name\n    Next\n    With Worksheets(\"sheet1\").Range(\"a2:z500\") ' Enter your sheet name and range here\n        '.ClearContents\n        .CopyFromRecordset rs\n    End With\n     '            Tidy up\n    rs.Close\n    Set rs = Nothing\n    Cn.Close\n    Set Cn = Nothing\nEnd Sub\n</code></pre>\n\n<p>I suppose you can try triple quotes around any 'weird' naming conventions, like spaces in names, or special characters in names.</p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 11108864, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nyI8awEWiDE/AAAAAAAAAAI/AAAAAAAAAC4/nrMzM3OikwQ/photo.jpg?sz=128", "display_name": "Reda HAMZA", "link": "https://stackoverflow.com/users/11108864/reda-hamza"}, "is_accepted": false, "score": -1, "last_activity_date": 1551262180, "creation_date": 1551262180, "answer_id": 54902925, "question_id": 54658739, "link": "https://stackoverflow.com/questions/54658739/space-in-the-name-of-sql-table/54902925#54902925", "title": "space in the name of sql table", "body": "<p>thank you all for your answers, the problem was not worry in space but in one of the Tables, I was able to bypass the problem by replacing the cursor type \"adOpenKeyset\" by \"adOpenDynamic\"\nbut his understanding the problem, may be that another user worked on the table ?!</p>\n"}], "owner": {"reputation": 1, "user_id": 11052874, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215583476112995/picture?type=large", "display_name": "Red", "link": "https://stackoverflow.com/users/11052874/red"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1551262180, "creation_date": 1550005829, "last_edit_date": 1550043572, "question_id": 54658739, "link": "https://stackoverflow.com/questions/54658739/space-in-the-name-of-sql-table", "title": "space in the name of sql table", "body": "<p>the macro below exports data to SQL tables, when the name of the table has no space, it works perfectly, but if the name has a space, it blocks, </p>\n\n<p>it blocks on the rs.Open line tableName, Cn, adOpenKeyset, adLockOptimistic</p>\n\n<p>I tried the hooks [...] the apostrophe '...' and <code>...</code> but nothing works\n   `</p>\n\n<pre><code>Sub Injection()\n\n\nDim Cn As ADODB.connection    \nDim ServerName As String    \nDim DatabaseName As String    \nDim tableName As String    \nDim UserID As String    \nDim Password As String    \nDim rs As ADODB.recordset    \n\nServerName = \"vmalsdisdb\"\nDatabaseName = \"Produits\"\ntableName = \"PRELEVEMENT PRODUIT\"\nUserID = \"\"\nPassword = \"\"\n\n\nSet rs = New ADODB.recordset\n\n\nSet Cn = New ADODB.connection\nCn.Open \"Driver={SQL Server};Server=\" &amp; ServerName &amp; \";Database=\" &amp; DatabaseName &amp; _\n\";Uid=\" &amp; UserID &amp; \";Pwd=\" &amp; Password &amp; \";\"\n\n\nrs.Open tableName, Cn, adOpenKeyset, adLockOptimistic`\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 1, "creation_date": 1550005107, "post_id": 54658553, "comment_id": 96108612, "body": "Show the code for the &quot;I am trying&quot; part please."}, {"owner": {"reputation": 634, "user_id": 6162065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V5BKK.jpg?s=128&g=1", "display_name": "Cabrra", "link": "https://stackoverflow.com/users/6162065/cabrra"}, "edited": false, "score": 1, "creation_date": 1550005780, "post_id": 54658553, "comment_id": 96108885, "body": "Hello, welcome to StackOverflow. Please, check <a href=\"https://stackoverflow.com/tour\">stackoverflow.com/tour</a> and how to ask <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a> to refine your question. As it is it won&#39;t get responded. Showing your work and your thoughts about the problem is a good way to show what you already tried. Hope this helps."}], "owner": {"reputation": 1, "user_id": 11053094, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--DIA61vjHqY/AAAAAAAAAAI/AAAAAAAAAAw/s7VtWJuCZgU/photo.jpg?sz=128", "display_name": "gabriel morel", "link": "https://stackoverflow.com/users/11053094/gabriel-morel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550043545, "creation_date": 1550004891, "last_edit_date": 1550043545, "question_id": 54658553, "link": "https://stackoverflow.com/questions/54658553/i-am-trying-to-have-a-listbox-in-a-user-form-that-when-i-select-an-specific-list", "title": "I am trying to have a listbox in a user form that when i select an specific list item i want a text box to be visible", "body": "<p>I am trying to have a list box in a userform VBA that when i select a specific list item I want a text box to be visible</p>\n"}]