[{"tags": ["vba", "function", "excel"], "answers": [{"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": true, "score": 2, "last_activity_date": 1432773583, "last_edit_date": 1432773583, "creation_date": 1432772341, "answer_id": 30495223, "question_id": 30495072, "link": "https://stackoverflow.com/questions/30495072/how-do-i-call-a-function-inside-another-function-in-vba/30495223#30495223", "title": "How do I call a function inside another function in VBA?", "body": "<p>Your function is not passing anything back.</p>\n\n<p>You probably want to change Col_Letter to myFirstFunction in the first function.</p>\n\n<p>Also in the second function change 65536 to rows.count.</p>\n\n<p>It will then error here:</p>\n\n<pre><code>Some_Column = Range(\"B4\").Address\n</code></pre>\n\n<p>Change it to this:</p>\n\n<pre><code>Set Some_Column = Range(\"B4\")\n</code></pre>\n\n<p>This is because it is defined as a range so you can't pass the address in (which is a string), you pass the object in (which you have to use Set for)</p>\n\n<p>Should be all good after that.</p>\n\n<pre><code>Function myFirstFunction(lngCol As Long) As String\nDim vArr\nvArr = Split(Cells(1, lngCol).Address(True, False), \"$\")\nmyFirstFunction = vArr(0)\nEnd Function\n\nFunction myOtherFunction(myVar As Variant) As Variant\nDim Some_Column As Range\nSet Some_Column = Range(\"B4\")\n\nIf Range((myFirstFunction(Some_Column.Column) &amp; rows.count)).End(xlUp) &lt;&gt; Range(myFirstFunction(Some_Column.Column) &amp; 1) Then\n'...some code\nEnd If\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2039, "user_id": 3848861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhEKB.png?s=128&g=1", "display_name": "dePatinkin", "link": "https://stackoverflow.com/users/3848861/depatinkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1432773006, "last_edit_date": 1495540679, "creation_date": 1432772634, "answer_id": 30495261, "question_id": 30495072, "link": "https://stackoverflow.com/questions/30495072/how-do-i-call-a-function-inside-another-function-in-vba/30495261#30495261", "title": "How do I call a function inside another function in VBA?", "body": "<p>The problematic part is <code>Some_Column = Range(\"B4\").Address</code></p>\n\n<ol>\n<li><code>Dim Some_Column As Range</code> declares the variable as a reference type, which means you need to set it's reference to an object by stating <code>Set Some_Column = ...</code> and preferably release it in the end with <code>Set Some_Column = Nothing</code>.</li>\n<li><code>.Address</code> returns a <code>String</code> and not an object, so your code should be <code>Set Some_Column = Range(\"B4\")</code> to set Some_Column as a Range.</li>\n</ol>\n\n<p>There's an additional mistake in the first function where <code>Col_Letter = vArr(0)</code> should probably be <code>myFirstFunction = vArr(0)</code>, or the other way around. This line sets the function's returned value, <code>function_name = ...</code>. </p>\n\n<p>You copied the solution from this <a href=\"https://stackoverflow.com/questions/12796973/vba-function-to-convert-column-number-to-letter\">question</a> but if you change the function name you have to change it the whole way through.</p>\n"}], "owner": {"reputation": 309, "user_id": 2026655, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3478339daa38d9d2a9a3f7fff87c5dd7?s=128&d=identicon&r=PG", "display_name": "Alex Klinghoffer", "link": "https://stackoverflow.com/users/2026655/alex-klinghoffer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21086, "favorite_count": 0, "accepted_answer_id": 30495223, "answer_count": 2, "score": 2, "last_activity_date": 1432773583, "creation_date": 1432771085, "last_edit_date": 1432772441, "question_id": 30495072, "link": "https://stackoverflow.com/questions/30495072/how-do-i-call-a-function-inside-another-function-in-vba", "title": "How do I call a function inside another function in VBA?", "body": "<p>I have a function 1 that looks like this:                                    </p>\n\n<pre><code>Function myFirstFunction(lngCol As Long) As String\nDim vArr\nvArr = Split(Cells(1, lngCol).Address(True, False), \"$\")\nCol_Letter = vArr(0)\nEnd Function\n</code></pre>\n\n<p>I need to call this function in a separate function like this:</p>\n\n<pre><code>Function myOtherFunction(myVar as Variant) As Variant\nDim Some_Column As Range\nSome_Column = Range(\"B4\").Address\n\nIf Range((myFirstFunction(Some_Column.Column) &amp; 65536)).End(xlUp) &lt;&gt; Range(myFirstFunction(Some_Column.Column) &amp; 1) Then\n...some code\nEnd If\n</code></pre>\n\n<p>It's giving me an error, I would assume because I'm not able to use the first function in the second function. Is there a way to fix this?                                </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1432848661, "post_id": 30494969, "comment_id": 49109908, "body": "This will be much easier to maintain if you <code>Dim SheetFormat as Variant</code> and use <code>SheetFormats = Array (&quot;Mon Maint&quot;, ...)</code> instead of calling them out by index.  Although maybe OP has some other way to make the array."}], "tags": [], "owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "is_accepted": false, "score": 3, "last_activity_date": 1432770341, "creation_date": 1432770341, "answer_id": 30494969, "question_id": 30494803, "link": "https://stackoverflow.com/questions/30494803/group-sheets-with-names-in-a-string-variable/30494969#30494969", "title": "Group sheets with names in a string variable", "body": "<p>Here's a sample procedure to get you going. You can build your array in any number of ways, but the end result will follow this patter--iterating through an array (or similar) to do the same operations on the set of worksheets.</p>\n\n<pre><code>Sub SampleDoSomethingToMultipleSheets()\n\n    Dim SheetsFormat(3) As String\n    SheetsFormat(0) = \"Mon Maint\"\n    SheetsFormat(1) = \"Mon Mgnt\"\n    SheetsFormat(2) = \"Tue Prod\"\n\n    Dim idx As Integer\n    For idx = 0 To UBound(SheetsFormat) - 1\n        With Sheets(SheetsFormat(idx))\n            ' put your code here, e.g.\n            .Range(\"A1\").Value = \"StackOverflow is awesome\"\n        End With\n    Next idx\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 1, "creation_date": 1432848744, "post_id": 30496690, "comment_id": 49109944, "body": "Using <code>&#47;</code> as the delimiter would ensure that it cannot conflict with a sheet name."}], "tags": [], "owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "is_accepted": false, "score": 2, "last_activity_date": 1432783475, "creation_date": 1432783475, "answer_id": 30496690, "question_id": 30494803, "link": "https://stackoverflow.com/questions/30494803/group-sheets-with-names-in-a-string-variable/30496690#30496690", "title": "Group sheets with names in a string variable", "body": "<p>Here's an example that does what you want. It uses the <code>Split</code> function which splits a string into an array based on a separator.</p>\n\n<pre><code>Sub LoopThroughSheetsString()\nDim SheetsFormat As String\nDim ws As Excel.Worksheet\nSheetsFormat = \"Sheet1,Sheet2,Sheet3\"\n\n'loop through the array created by splitting SheetsFormat on commas\nFor Each ws In Sheets(Split(SheetsFormat, \",\"))\n    Debug.Print ws.Name\nNext ws\nEnd Sub\n</code></pre>\n\n<p>Note that it's one long string with double-quotes only at the beginning and end.</p>\n"}], "owner": {"reputation": 1, "user_id": 4946812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf8d0e821946063cca896e1f7dd357ea?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/4946812/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1432783475, "creation_date": 1432769192, "last_edit_date": 1432772736, "question_id": 30494803, "link": "https://stackoverflow.com/questions/30494803/group-sheets-with-names-in-a-string-variable", "title": "Group sheets with names in a string variable", "body": "<p>I want to group a number of sheets that has sheet names with in a string variable, the group of sheets will be used to format each sheet within the group.</p>\n\n<p>The string (let's call it, SheetsFormat) contains all sheet names that need to be formatted, each value within the string was added into the dynamic string when it was created. </p>\n\n<p>The question is how to create a group of sheets that reference the SheetsFormat string?</p>\n\n<p>Example of the string contents: \"Mon Maint\", \"Mon Mgnt\", \"Tue Prod\" etc.</p>\n\n<p>The code I used was:</p>\n\n<pre><code>Dim ws as worksheet, ws_group As Worksheets\nSet ws_group = Sheets(Array(SheetsFormat))\nFor Each ws In ws_group\n'some staff\nNext\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 1, "creation_date": 1432762709, "post_id": 30493585, "comment_id": 49064926, "body": "What&#39;s the question?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1432765022, "post_id": 30493585, "comment_id": 49065777, "body": "Why not input Field1 to Field5 into <code>Func()</code> and have it determine which one of those to return?"}, {"owner": {"reputation": 133, "user_id": 3965018, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/02a7cba8b9850edacfc3ca1c441f4075?s=128&d=identicon&r=PG&f=1", "display_name": "ar1994", "link": "https://stackoverflow.com/users/3965018/ar1994"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1432766303, "post_id": 30493585, "comment_id": 49066238, "body": "@TimWilliams Because the data in fields 1 to 5 is independent of the field that needs to be returned (the selection of field is entirely dependent on Num1 and Num2)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1432766856, "post_id": 30493585, "comment_id": 49066408, "body": "Maybe you&#39;ve oversimplified your real use case, but I&#39;m not seeing why you can&#39;t perform the selection of Fieldx inside your function, based on Num1 and Num2.  It&#39;s difficult to offer suggestions based on the information you provide: for example we have no idea what logic is used in your function to evaluate Num1 and Num2 and thus select a field to return."}], "answers": [{"comments": [{"owner": {"reputation": 400278, "user_id": 73226, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tdqly.png?s=128&g=1", "display_name": "Martin Smith", "link": "https://stackoverflow.com/users/73226/martin-smith"}, "edited": false, "score": 0, "creation_date": 1432763090, "post_id": 30493636, "comment_id": 49065091, "body": "Access doesn&#39;t support \u2019case\u2019 afaik."}, {"owner": {"reputation": 133, "user_id": 3965018, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/02a7cba8b9850edacfc3ca1c441f4075?s=128&d=identicon&r=PG&f=1", "display_name": "ar1994", "link": "https://stackoverflow.com/users/3965018/ar1994"}, "edited": false, "score": 0, "creation_date": 1432763168, "post_id": 30493636, "comment_id": 49065120, "body": "Sorry - I can see now that I messed up my explanation. The function actually outputs the field name (&quot;Field1&quot;,&quot;Field2&quot;,etc). Your solution still works though - thanks! If I can&#39;t find something more robust then I&#39;ll stick to this... I didn&#39;t know you could do switch cases in SQL"}, {"owner": {"reputation": 215643, "user_id": 50552, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/200c020bef60e4d9c4c4ba1c85442026?s=128&d=identicon&r=PG", "display_name": "Andomar", "link": "https://stackoverflow.com/users/50552/andomar"}, "edited": false, "score": 0, "creation_date": 1432770857, "post_id": 30493636, "comment_id": 49067590, "body": "Ouch, forgot about that. You can use <code>iif</code> like Manuel Castro suggests, or <a href=\"http://www.techonthenet.com/access/functions/advanced/switch.php\" rel=\"nofollow noreferrer\"><code>switch()</code></a> which I&#39;ll edit into this answer."}], "tags": [], "owner": {"reputation": 215643, "user_id": 50552, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/200c020bef60e4d9c4c4ba1c85442026?s=128&d=identicon&r=PG", "display_name": "Andomar", "link": "https://stackoverflow.com/users/50552/andomar"}, "is_accepted": true, "score": 1, "last_activity_date": 1432770799, "last_edit_date": 1432770799, "creation_date": 1432762840, "answer_id": 30493636, "question_id": 30493585, "link": "https://stackoverflow.com/questions/30493585/using-udf-output-string-in-sql-select-query/30493636#30493636", "title": "Using UDF output string in SQL SELECT Query?", "body": "<p>You could use a <code>switch</code> statement, like:</p>\n\n<pre><code>select  switch(\n        Func(Num1,Num2) = 1, Field1,\n        Func(Num1,Num2) = 2, Field2,\n        Func(Num1,Num2) = 3, Field3,\n        ...)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 128, "user_id": 4897784, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jN45WYKtevs/AAAAAAAAAAI/AAAAAAAAARs/k87jp5AH7DE/photo.jpg?sz=128", "display_name": "Manuel Castro", "link": "https://stackoverflow.com/users/4897784/manuel-castro"}, "is_accepted": false, "score": 2, "last_activity_date": 1432766867, "creation_date": 1432766867, "answer_id": 30494404, "question_id": 30493585, "link": "https://stackoverflow.com/questions/30493585/using-udf-output-string-in-sql-select-query/30494404#30494404", "title": "Using UDF output string in SQL SELECT Query?", "body": "<p>You could use the IIF function, for example:</p>\n\n<p><code>SELECT \n       Num1, \n       Num2, \n       IIF(NUM1 &lt; NUM2, Field1, IIf(NUM1 = NUM2,Field1, Field2))</code></p>\n\n<p>I've used operations <code>NUM1 &lt; NUM2</code> and <code>NUM1 = NUM2</code> as examples, you could use any other operation as long as the result is boolean.</p>\n\n<p>Note that I only detailed two nested <code>IIF</code> but you can nest as many as you need.</p>\n\n<p>Read up for more: <a href=\"http://www.techonthenet.com/access/functions/advanced/iif.php\" rel=\"nofollow\">http://www.techonthenet.com/access/functions/advanced/iif.php</a></p>\n"}], "owner": {"reputation": 133, "user_id": 3965018, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/02a7cba8b9850edacfc3ca1c441f4075?s=128&d=identicon&r=PG&f=1", "display_name": "ar1994", "link": "https://stackoverflow.com/users/3965018/ar1994"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 30493636, "answer_count": 2, "score": 1, "last_activity_date": 1432875647, "creation_date": 1432762577, "last_edit_date": 1432875647, "question_id": 30493585, "link": "https://stackoverflow.com/questions/30493585/using-udf-output-string-in-sql-select-query", "title": "Using UDF output string in SQL SELECT Query?", "body": "<p>I have a user-defined function (in Microsoft Access) that takes a value from two fields and returns a string, which corresponds to a column name.</p>\n\n<p>This might not seem very clear; below is a simplified example of what I'm trying to do. Unfortunately I can't use the real problem as it's confidential.</p>\n\n<p>Input:</p>\n\n<pre> Num1 | Num2 | Field1 | Field2 | Field3 | Field4 | Field5\n\n .....|......|........|........|........|........|.......\n\n .....|......|........|........|........|........|.......\n\n .....|......|........|........|........|........|.......\n\n SQL query: \"SELECT Num1,Num2,Func(Num1,Num2)</pre>\n\n<p>Output:</p>\n\n<blockquote>\n  <p>Num1 | Num2 | FieldVal</p>\n</blockquote>\n\n<p>In the output, FieldVal can be the value of Field1,Field2,Field3,Field4, or Field5, depending on Num1 and Num2. As of now I have a user defined function that determines which field's being used(1,2,3,4,or 5) based on two inputs (Num1 and Num2).</p>\n\n<p>I guess what I'm trying to say is that I want to query a different column depending on Num1 and Num2.</p>\n"}, {"tags": ["vba", "automation", "ms-word"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432760923, "post_id": 30493138, "comment_id": 49064062, "body": "Good job on finding the code. Now tell us what problems are you facing with the code and what did you try changing in it to make it work :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1432766469, "post_id": 30493138, "comment_id": 49066289, "body": "Word has an Insert \u25ba Text \u25ba Object \u25ba Text from File command that is better suited to inserting text from a file. If you record yourself bringing in one or two TXT files, the rest should be pretty evident. Come back if you are having trouble."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4946547"}, "edited": false, "score": 1, "creation_date": 1432827321, "post_id": 30494740, "comment_id": 49097514, "body": "Thank you! This code opens each text file as an individual word document, but I&#39;m wondering how to get it into a single document. I added objDoc.SaveAs (&quot;P:\\ImportedDescriptions.doc&quot;) as an attempt to save the documents, but it only saved the last one. Should my code save each new document and then merge it into one, or is it possible to directly import the text files into one document? Any advice would be appreciated!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4946547"}, "edited": false, "score": 0, "creation_date": 1432829251, "post_id": 30494740, "comment_id": 49098881, "body": "Would it involve creating an array?"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 1, "last_activity_date": 1432851443, "last_edit_date": 1432851443, "creation_date": 1432768773, "answer_id": 30494740, "question_id": 30493138, "link": "https://stackoverflow.com/questions/30493138/import-folder-of-txt-files-into-word-document/30494740#30494740", "title": "import folder of .txt files into word document", "body": "<p>here is something to get you started</p>\n\n<p><kbd> <strong>Word 2010</strong> </kbd></p>\n\n<p><strong>Edit</strong>  this should allow you to open all txt files in one document and save it</p>\n\n<pre><code>Option Explicit\nSub AllFilesInFolder()\n    Dim myFolder    As String\n    Dim myFile      As String\n    Dim wdDoc       As Document\n    Dim txtFiles    As Document\n\n    Application.ScreenUpdating = False\n\n    myFolder = openFolder\n\n    If myFolder = \"\" Then Exit Sub\n\n    myFile = Dir(myFolder &amp; \"\\*.txt\", vbNormal)\n    Set wdDoc = ActiveDocument\n\n    While myFile &lt;&gt; \"\"\n        Set txtFiles = Documents.Open(FileName:=myFolder &amp; \"\\\" &amp; myFile, AddToRecentFiles:=False, Visible:=False, ConfirmConversions:=False)\n        wdDoc.Range.InsertAfter txtFiles.Range.Text &amp; vbCr\n        txtFiles.Close SaveChanges:=True\n    myFile = Dir()\n    Wend\n\n    Set txtFiles = Nothing\n    Set wdDoc = Nothing\n\n    Application.ScreenUpdating = True\nEnd Sub     \nFunction openFolder() As String\n\n    Dim oFolder     As Object\n\n    openFolder = \"\"\n\n    Set oFolder = CreateObject(\"Shell.Application\").BrowseForFolder(0, \"Choose a folder\", 0)\n        If (Not oFolder Is Nothing) Then openFolder = oFolder.Items.Item.Path\n\n    Set oFolder = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5640094, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/d8f7643a7e73d1652682aa99d96bacdd?s=128&d=identicon&r=PG", "display_name": "Christian", "link": "https://stackoverflow.com/users/5640094/christian"}, "is_accepted": false, "score": 1, "last_activity_date": 1449254907, "last_edit_date": 1449254907, "creation_date": 1449243287, "answer_id": 34091857, "question_id": 30493138, "link": "https://stackoverflow.com/questions/30493138/import-folder-of-txt-files-into-word-document/34091857#34091857", "title": "import folder of .txt files into word document", "body": "<p>Copy all the text files into a single file using the Command Prompt (cmd.exe) and the following command:</p>\n\n<pre><code>copy *.txt NewFile.txt\n</code></pre>\n\n<p>Then open this file with word and modify the way you want to see the text.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4946547"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2488, "favorite_count": 1, "accepted_answer_id": 30494740, "answer_count": 2, "score": 1, "last_activity_date": 1449254907, "creation_date": 1432760747, "last_edit_date": 1432767059, "question_id": 30493138, "link": "https://stackoverflow.com/questions/30493138/import-folder-of-txt-files-into-word-document", "title": "import folder of .txt files into word document", "body": "<p>I've found a lot on importing folder of .txt files into excel, but not many on importing .txt files into word. I'm trying to get my macro to open all .txt files in a specific folder and import them into a single word document, with each .txt file having its own page. This is the code I have so far (that I found online):</p>\n\n<pre><code>Sub AllFilesInFolder()\n    Dim myFolder As String, myFile As String\n    myFolder = Application.FileDialog(msoFileDialogFolderPicker)\n    With Application.FileDialog(msoFileDialogFolderPicker)\n        .AllowMultiSelect = False\n        .Show\n        If .SelectedItems.Count &gt; 0 Then\n            myFolder = .SelectedItems(1)\n        End If\n    End With\n    myFile = Dir(myFolder &amp; \"\\*.txt\") '\n    Do While myFile &lt;&gt; \"\"\n        Open myFolder &amp; \"\\\" &amp; myFile For Input As #1\n        'Copy &amp; Paste Macro?\n        myFile = Dir\n    Loop\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": true, "score": 2, "last_activity_date": 1432760982, "creation_date": 1432760982, "answer_id": 30493199, "question_id": 30492864, "link": "https://stackoverflow.com/questions/30492864/md-access-user-defined-function-value-is-not-showing-in-textbox/30493199#30493199", "title": "Md Access: User defined function value is not showing in Textbox", "body": "<p>You need to set a value to <code>UserTracking</code> within the function.</p>\n\n<pre><code>Function UserTracking() As String\nDim test As String\ntest = \"TEST\"\nUserTracking = test\nEnd Function\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1670773"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 30493199, "answer_count": 1, "score": 0, "last_activity_date": 1432760982, "creation_date": 1432759786, "question_id": 30492864, "link": "https://stackoverflow.com/questions/30492864/md-access-user-defined-function-value-is-not-showing-in-textbox", "title": "Md Access: User defined function value is not showing in Textbox", "body": "<p>In my form I have a textbox, <code>TextBox1</code> and I have set the control source of the textbox to a user defined function as <code>=UserTracking()</code>. UserTracking function is defined in a module named <code>User_Defined_Functions</code>. the function is as follow</p>\n\n<pre><code>Function UserTracking() As String\nDim test As String\ntest = \"TEST\"\nEnd Function\n</code></pre>\n\n<p>Now I am expecting that this <code>TEST</code> should appear in the textbox of the form view but it is not showing. It is not giving any error also. How can I make this work? Thanks in advance.  </p>\n"}, {"tags": ["vba", "excel", "duplicate-removal"], "comments": [{"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "edited": false, "score": 0, "creation_date": 1432801293, "post_id": 30492729, "comment_id": 49078074, "body": "Please use <a href=\"http://www.sensefulsolutions.com/2010/10/format-text-as-table.html\" rel=\"nofollow noreferrer\">sensefulsolutions.com/2010/10/format-text-as-table.html</a> or the like for posting your input table, and add the desired output table (or a least make it clear what it should be)."}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 3861922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bafcd1ef228844eaf8f381eb81e6e9a3?s=128&d=identicon&r=PG", "display_name": "3eyes", "link": "https://stackoverflow.com/users/3861922/3eyes"}, "is_accepted": false, "score": 2, "last_activity_date": 1432760198, "creation_date": 1432760198, "answer_id": 30492976, "question_id": 30492729, "link": "https://stackoverflow.com/questions/30492729/how-to-retain-blank-cells-while-removing-other-duplicates/30492976#30492976", "title": "How to retain blank cells while removing other duplicates?", "body": "<p>You could just sort the data to set aside the rows with missing values at the bottom of the spreadsheet. Then select just the rows from which you want to remove the duplicates, and use the 'remove duplicates'button.</p>\n"}], "owner": {"reputation": 21, "user_id": 4903582, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/973034212730811/picture?type=large", "display_name": "Anne de Groot", "link": "https://stackoverflow.com/users/4903582/anne-de-groot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432789879, "creation_date": 1432759229, "last_edit_date": 1432789879, "question_id": 30492729, "link": "https://stackoverflow.com/questions/30492729/how-to-retain-blank-cells-while-removing-other-duplicates", "title": "How to retain blank cells while removing other duplicates?", "body": "<p>I am working in Excel and want to delete cells based on an ID number (which is one of the variables). However, when I use the 'remove duplicates' function, it will also delete duplicate blank cells (missing values).                                    </p>\n\n<p>How do I prevent Excel from deleting the blanks, but at the same time remove identical ID's? </p>\n\n<p>Example of my data:</p>\n\n<pre><code>    text    favorited   created id  statusSource    screenName  retweetCount    isRetweet   retweeted\n1   RT @cdavandaag: De hashtag #ikstemCDA is deze maand al 7.500 (!) keer gebruikt, fantastisch. Op naar een mooi uitslag. #CDA #PS15 http://t.\u2026    FALSE   17-3-2015 23:58 5,77982E+17 &lt;a href=\"http://twitter.com/download/iphone\" rel=\"nofollow\"&gt;Twitter for iPhone&lt;/a&gt;  Cecile2511  25  TRUE    FALSE\n1   @Sanderderouwe @CDA @InfoPCN Standpunten CDA check: http://t.co/PqBCn3o8N1  FALSE   17-3-2015 13:57 5,77831E+17 &lt;a href=\"http://twitter.com\" rel=\"nofollow\"&gt;Twitter Web Client&lt;/a&gt;  CannaKieswijzer 0   FALSE   FALSE\n2   RT @Matthijs85: Ligt het trouwens aan mij                               \n3   @PuckPetrus bang makerij bemoei je niet met je buurman les 1                                \n4   RT @FrankScholman: Het #CDA kiest #LagereLasten! Hier hebben we 7 goede redenen voor: http://t.co/utQt0LfEzl. #NOSdebat #PS15 #MeerBanen ht\u2026    FALSE   17-3-2015 23:57 5,77982E+17 &lt;a href=\"http://twitter.com/download/iphone\" rel=\"nofollow\"&gt;Twitter for iPhone&lt;/a&gt;  gijsdupont  4   TRUE    FALSE\n5   RT @Jan_Slagter: In Hilversum werden de Buma awards uitgereikt, en  Buma wint het #nosdebat #cda    FALSE   17-3-2015 23:56 5,77982E+17 &lt;a href=\"http://twitter.com/download/iphone\" rel=\"nofollow\"&gt;Twitter for iPhone&lt;/a&gt;  Ztrmarco    38  TRUE    FALSE\n6   RT @StSteenbakkers: Peiling Maurice de Hond: tweestrijd VVD en CDA! Stem CDA!!! #Lagerelasten #CDA #100pBrabant FALSE   17-3-2015 23:56 5,77982E+17 &lt;a href=\"http://twitter.com/download/iphone\" rel=\"nofollow\"&gt;Twitter for iPhone&lt;/a&gt;  gijsdupont  5   TRUE    FALSE\n7   @PuckPetrus  dat ze ze blijven doen 30 jaar lang                                \n8   RT @cdavandaag: .@SybrandBuma pleit tijdens #NOSdebat voor #maatschappelijkedienstplicht. Waarom? Lees meer: http://t.co/5HkCxRrOO8. http:/\u2026    FALSE   17-3-2015 23:55 5,77982E+17 &lt;a href=\"http://twitter.com/download/iphone\" rel=\"nofollow\"&gt;Twitter for iPhone&lt;/a&gt;  Cecile2511  48  TRUE    FALSE\n9   RT @Pran_Westerdam: Stem niet op de PVDA, VVD, D66, GL en CDA: niets doen wordt onze totale ondergang, dat erkennen zal als eerste moeten g\u2026    FALSE   17-3-2015 23:55 5,77982E+17 &lt;a href=\"http://twitter.com\" rel=\"nofollow\"&gt;Twitter Web Client&lt;/a&gt;  worrienie   2   TRUE    FALSE\n10  RT @NederlandKiest: Buma (CDA): Rutte moet kijken naar de Nederlander. De toekomst van onze kinderen is er een met leenstelsel en hoogste s\u2026    FALSE   17-3-2015 23:54 5,77981E+17 &lt;a href=\"http://twitter.com/download/iphone\" rel=\"nofollow\"&gt;Twitter for iPhone&lt;/a&gt;  Cecile2511  34  TRUE    FALSE\n11  CDA-lijsttrekker Marianne van der Sloot: \u2018We sluiten geen partijen uit, ook de PVV niet\u2019 http://t.co/br8gFUTAuH FALSE   17-3-2015 23:53 5,77981E+17 &lt;a href=\"http://www.citytweet.nl\" rel=\"nofollow\"&gt;Citytweet&lt;/a&gt;  EindhovenNL 0   FALSE   FALSE\n</code></pre>\n"}, {"tags": ["vba", "excel", "copy", "paste"], "answers": [{"comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 2, "creation_date": 1432759023, "post_id": 30492629, "comment_id": 49063129, "body": "Another in a long line of good reasons to <i>never</i> use implicit references."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432760830, "post_id": 30492629, "comment_id": 49063998, "body": "++ nicely explained :) You are on fire today :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 7, "last_activity_date": 1432759056, "last_edit_date": 1432759056, "creation_date": 1432758897, "answer_id": 30492629, "question_id": 30492499, "link": "https://stackoverflow.com/questions/30492499/copy-a-range-from-one-worksheet-to-another-using-cells-property/30492629#30492629", "title": "Copy a range from one worksheet to another using cells property", "body": "<p>You are specifying the parent of Range but not of Cells. In short, you are trying to define a range of cells on Sheet1 that contain the cells on Sheet2 and/or vise-versa.</p>\n\n<pre><code>dim ws2 as worksheet\nset ws2 = sheets(\"Sheet2\")\n\nwith sheets(\"Sheet1\")\n    .Range(.Cells(2, 3), .Cells(10, 3)).Copy _\n      Destination:=ws2.Range(ws2.Cells(3,4))\nend with\n</code></pre>\n\n<p>The prefixing period (aka <code>.</code> or <em>full stop</em>) means that the parent of <code>.Range</code> and <code>.Cells</code> is defined with the <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\">With...End With statement</a>. To shorten the code necessary to properly define the range on Sheet2, I assigned a worksheet type variable and used it to show the parent of both the range and the cells.</p>\n\n<p>FWIW, <code>ws2.Range(ws2.Cells(3,4))</code> is redundant. <code>ws2.Cells(3,4)</code> is sufficient.</p>\n"}], "owner": {"reputation": 45, "user_id": 4946333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/902615348949a29a33e3c03dc7fbb30a?s=128&d=identicon&r=PG&f=1", "display_name": "Bobby Saget", "link": "https://stackoverflow.com/users/4946333/bobby-saget"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18902, "favorite_count": 0, "accepted_answer_id": 30492629, "answer_count": 1, "score": 3, "last_activity_date": 1441591439, "creation_date": 1432758431, "last_edit_date": 1531164843, "question_id": 30492499, "link": "https://stackoverflow.com/questions/30492499/copy-a-range-from-one-worksheet-to-another-using-cells-property", "title": "Copy a range from one worksheet to another using cells property", "body": "<p>I am trying to copy a range from one worksheet to another.  I have multiple ranges that I would like to copy and paste at various points in the new worksheet though (for example, I want to paste the first range to D3, then the next range to E12, and so on), so I am using the cells property to describe the range.  However, for some reason, when I describe the range that I want to paste at in the new worksheet using the cells format rather than just putting in a string, it does not work.</p>\n\n<p>This line of code does work:</p>\n\n<pre><code>Sheets(\"Sheet1\").Range(Cells(2, 3), Cells(10, 3)).Copy _\n  Destination:=Sheets(\"Sheet2\").Range(\"D3\")\n</code></pre>\n\n<p>but this one does not:</p>\n\n<pre><code>Sheets(\"Sheet1\").Range(Cells(2, 3), Cells(10, 3)).Copy _\n  Destination:=Sheets(\"Sheet2\").Range(Cells(3,4))\n</code></pre>\n\n<p>When I run the latter line of code, I get a \"Run-time error 1004: application-defined or object defined error\".  Why is this and how can I fix it?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 5, "creation_date": 1432757684, "post_id": 30492225, "comment_id": 49062466, "body": "Welcome to SO! Reading <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask a good question</a> will help you get an answer sooner. Remember, this isn&#39;t a code-writing service, so post what you&#39;ve got &amp; we can help you fix it. If you don&#39;t know where to start, try using the Macro Recorder."}], "answers": [{"comments": [{"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432759613, "post_id": 30492706, "comment_id": 49063408, "body": "I absolutely tested the code, intArr is just holding the 6 different digits that make up the total number, so integer is fine here. (1,3,5,7,8,9 if the number was 135789 for example).  Although I do agree that it shouldn&#39;t be the full code, I had something very similar to this already written up."}, {"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432759838, "post_id": 30492706, "comment_id": 49063506, "body": "Yes, and using this code, you can compare the two numbers (once sorted) to make sure they match.  654321 and 561234 would both return the same number (123456) and from there you could make sure they are equal."}, {"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432760183, "post_id": 30492706, "comment_id": 49063670, "body": "Thanks :) after your comments I realized it made much more sense to right it as a function to use throughout the array."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432760707, "post_id": 30492706, "comment_id": 49063932, "body": "++ Works perfectly :)"}], "tags": [], "owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "is_accepted": false, "score": 2, "last_activity_date": 1432760622, "last_edit_date": 1432760622, "creation_date": 1432759156, "answer_id": 30492706, "question_id": 30492225, "link": "https://stackoverflow.com/questions/30492225/finding-different-numbers-with-same-digits-from-an-array/30492706#30492706", "title": "Finding different numbers with same digits from an array", "body": "<p>I feel a good way to do this would be to take your 6 digit number, create an array containing those 6 digits, sort them, then give you the new number (returned as a string in this example) then compare the two to make sure they are equal.  </p>\n\n<pre><code>Public Function SortNumber(intIn As Long)\n    Dim intArr(1 To 6) As Integer, strResult As String\n    Dim i As Integer\n\n    For i = 1 To 6\n        intArr(i) = Mid(CStr(intIn), i, 1)\n    Next i\n\n    BubbleSort intArr\n\n    For i = 1 To 6\n        strResult = strResult + CStr(intArr(i))\n    Next i\n\n    SortNumber = strResult\nEnd Function\n\nFunction BubbleSort(TempArray As Variant)\n    Dim Temp As Variant\n    Dim i As Integer\n    Dim NoExchanges As Integer\n\n    Do\n        NoExchanges = True\n        For i = 1 To UBound(TempArray) - 1\n            If TempArray(i) &gt; TempArray(i + 1) Then\n                NoExchanges = False\n                Temp = TempArray(i)\n                TempArray(i) = TempArray(i + 1)\n                TempArray(i + 1) = Temp\n            End If\n        Next i\n    Loop While Not (NoExchanges)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 4774927, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Yx_QRP14ZD4/AAAAAAAAAAI/AAAAAAAAFqE/L4e07AH1c_U/photo.jpg?sz=128", "display_name": "Apurva ", "link": "https://stackoverflow.com/users/4774927/apurva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "closed_date": 1432760713, "answer_count": 1, "score": -3, "last_activity_date": 1432760622, "creation_date": 1432757413, "question_id": 30492225, "link": "https://stackoverflow.com/questions/30492225/finding-different-numbers-with-same-digits-from-an-array", "closed_reason": "Needs more focus", "title": "Finding different numbers with same digits from an array", "body": "<p>I have an array of 6 digit numbers in which I need to find numbers with same digits but with different order. How can I do this in vba?</p>\n"}, {"tags": ["excel", "named-ranges", "vba"], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 4770524, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5a24f2d29f3518a6ccce08c72368ceb8?s=128&d=identicon&r=PG&f=1", "display_name": "Les Programmer", "link": "https://stackoverflow.com/users/4770524/les-programmer"}, "edited": false, "score": 0, "creation_date": 1432755726, "post_id": 30491034, "comment_id": 49061302, "body": "Thank you.  The first line works great.    The sub has a problem.  At   set  rngNm = ThisWorkbook.Sheets(&quot;Sheet1&quot;).Range(&quot;NamedRange&quot;)  I get a &#39;1004 error, Application-definded or object-defined error&#39;.  Any suggestions?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 111, "user_id": 4770524, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5a24f2d29f3518a6ccce08c72368ceb8?s=128&d=identicon&r=PG&f=1", "display_name": "Les Programmer", "link": "https://stackoverflow.com/users/4770524/les-programmer"}, "edited": false, "score": 0, "creation_date": 1432756016, "post_id": 30491034, "comment_id": 49061477, "body": "Did you replace the <code>NamedRange</code> with the actual named range?"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 2, "last_activity_date": 1432753460, "creation_date": 1432753460, "answer_id": 30491034, "question_id": 30490978, "link": "https://stackoverflow.com/questions/30490978/get-column-and-row-number-for-named-range/30491034#30491034", "title": "Get column and row number for named range", "body": "<blockquote>\n  <p>how can I insert a column to the right of the NamedRange? </p>\n</blockquote>\n\n<p>Use .Offset to achieve what you want.</p>\n\n<pre><code>Thisworkbook.Sheets(\"Sheet1\").Range(\"NamedRange\").offset(,1).EntireColumn.Insert\n</code></pre>\n\n<blockquote>\n  <p>how can I reference row 1 of the new column to put a header to my new column?</p>\n</blockquote>\n\n<p>Work with the Range Object</p>\n\n<pre><code>Sub Sample()\n    Dim rngNm As Range, NewRng As Range\n\n    Set rngNm = ThisWorkbook.Sheets(\"Sheet1\").Range(\"NamedRange\")\n\n    rngNm.Offset(, 1).EntireColumn.Insert\n\n    Set NewRng = rngNm.Offset(, 1)\n\n    Debug.Print NewRng.Address '&lt;~~ New Columsn Address\n    Debug.Print NewRng.Cells(1,1).Address '&lt;~~ 1st Cell in the range\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 4770524, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5a24f2d29f3518a6ccce08c72368ceb8?s=128&d=identicon&r=PG&f=1", "display_name": "Les Programmer", "link": "https://stackoverflow.com/users/4770524/les-programmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2905, "favorite_count": 0, "accepted_answer_id": 30491034, "answer_count": 1, "score": 1, "last_activity_date": 1432753937, "creation_date": 1432753234, "last_edit_date": 1531161705, "question_id": 30490978, "link": "https://stackoverflow.com/questions/30490978/get-column-and-row-number-for-named-range", "title": "Get column and row number for named range", "body": "<p>I am having a problem referencing a column next to a named range (the NamedRange is only 1 column wide).  I have used the following code to insert a column:</p>\n\n<p><code>.sheets(\"sheet1\").Range(\"NamedRange:NamedRange\").EntireColumn.Insert</code></p>\n\n<p>This works but inserts the column before the <code>NamedRange</code>. It doesn't matter if I add</p>\n\n<p><code>shift:=xlToRight</code> or <code>shift:=xlToLeft</code></p>\n\n<p>It ignores me and inserts the column to the left.</p>\n\n<p>A couple of questions: </p>\n\n<ol>\n<li>How can I insert a column to the right of the NamedRange?  </li>\n<li>How can I reference row 1 of the new column to put a header to my new column?  In other words, how do I find the address of the new column cell(row1,column???)? And how can I extract the new column address of the NamedRange?</li>\n</ol>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 4606449, "user_type": "registered", "accept_rate": 52, "profile_image": "https://lh4.googleusercontent.com/-jlHOOlNoBmw/AAAAAAAAAAI/AAAAAAAACCI/lC6qZF8_UJ8/photo.jpg?sz=128", "display_name": "David Redden", "link": "https://stackoverflow.com/users/4606449/david-redden"}, "edited": false, "score": 0, "creation_date": 1432755761, "post_id": 30491040, "comment_id": 49061322, "body": "I am getting a Compile error:  Method or data member not found"}], "tags": [], "owner": {"reputation": 4317, "user_id": 501667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb4574e474202e9fdde67f884bad0f87?s=128&d=identicon&r=PG", "display_name": "Neps", "link": "https://stackoverflow.com/users/501667/neps"}, "is_accepted": false, "score": 0, "last_activity_date": 1432756544, "last_edit_date": 1432756544, "creation_date": 1432753480, "answer_id": 30491040, "question_id": 30490828, "link": "https://stackoverflow.com/questions/30490828/access-2010-input-filename-with-added-text-at-end/30491040#30491040", "title": "Access 2010, Input Filename with added text at end", "body": "<p>Ah VBA. Can you try this instead?</p>\n\n<pre><code>Dim fso\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nCurrentFile = fso.GetFileName(me.Text1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 147, "user_id": 4606449, "user_type": "registered", "accept_rate": 52, "profile_image": "https://lh4.googleusercontent.com/-jlHOOlNoBmw/AAAAAAAAAAI/AAAAAAAACCI/lC6qZF8_UJ8/photo.jpg?sz=128", "display_name": "David Redden", "link": "https://stackoverflow.com/users/4606449/david-redden"}, "is_accepted": false, "score": 0, "last_activity_date": 1432756608, "creation_date": 1432756608, "answer_id": 30491992, "question_id": 30490828, "link": "https://stackoverflow.com/questions/30490828/access-2010-input-filename-with-added-text-at-end/30491992#30491992", "title": "Access 2010, Input Filename with added text at end", "body": "<p>I got it to work with this.  Not sure if this was the best method or not</p>\n\n<pre><code> CurrentFile = Mid(Left(Me.Text1, InStr(Me.Text1, \".\") - 1), 34,  18)\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 4606449, "user_type": "registered", "accept_rate": 52, "profile_image": "https://lh4.googleusercontent.com/-jlHOOlNoBmw/AAAAAAAAAAI/AAAAAAAACCI/lC6qZF8_UJ8/photo.jpg?sz=128", "display_name": "David Redden", "link": "https://stackoverflow.com/users/4606449/david-redden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594644475, "creation_date": 1432752747, "last_edit_date": 1594644475, "question_id": 30490828, "link": "https://stackoverflow.com/questions/30490828/access-2010-input-filename-with-added-text-at-end", "title": "Access 2010, Input Filename with added text at end", "body": "<p>I have a text string which is the filepath followed by filename.\nHere is an example:\n\\server\\folder\\subfolder\\OUTPUT\\filename_05272015.xlsx\nfilename could also be this:\n\\server\\folder\\subfolder\\OUTPUT\\filename2_05272015.xlsx</p>\n\n<p>What I am trying to accomplish is this: take current filename based on what user selected as \"Input\" and output will be that filename with _Modified.xlsx on the end.</p>\n\n<p>These filenames are Dim'd in my VB </p>\n\n<pre><code> Dim CurrentFile as string\n Dim strPath as string\n   CurrentFile = Mid(me.Text1,34,18)\n   strPath = Me.OutputFolderText &amp; \"\\\" &amp; CurrentFile &amp; \"_Modified.xlsx\"\n DoCmd.TransferSpreadsheet acExport, 10, \"qry_MyQuery\", strPath\n</code></pre>\n\n<p>Problem is the output filename looks like this:</p>\n\n<p>filename2_05272015_Modified.xlsx\nand then</p>\n\n<p>filename_05272015._Modified.xlsx where there is a \".\" after the MMDDYYYY</p>\n\n<p>I am trying to figure out how to get all variations to have an accurate output filename _05272015_modified.xlsx</p>\n\n<p>The text before the _MMDDYYYY may change.  _MMDDYYYY_Modified.xlsx will always be on the end of the filename.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "edited": false, "score": 0, "creation_date": 1432751273, "post_id": 30490171, "comment_id": 49058783, "body": "What kind of object is <code>xl</code> The way to refer to a range in excel from Excel would be <code>[Worksheet Object].Range(&quot;A1&quot;)</code>  If you want to use &quot;Sheet1&quot; then you have to reference a workbook object in front of that.  And from Access you need a Excel Application object in front of that."}, {"owner": {"reputation": 273, "user_id": 3512530, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c40f173cb8f935778e156188466477e7?s=128&d=identicon&r=PG&f=1", "display_name": "Elixir", "link": "https://stackoverflow.com/users/3512530/elixir"}, "reply_to_user": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "edited": false, "score": 0, "creation_date": 1432751338, "post_id": 30490171, "comment_id": 49058820, "body": "I named xl as my Excel Application object"}], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 3512530, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c40f173cb8f935778e156188466477e7?s=128&d=identicon&r=PG&f=1", "display_name": "Elixir", "link": "https://stackoverflow.com/users/3512530/elixir"}, "edited": false, "score": 0, "creation_date": 1432751202, "post_id": 30490308, "comment_id": 49058741, "body": "Thanks I&#39;ll give this a try"}, {"owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "edited": false, "score": 1, "creation_date": 1432752569, "post_id": 30490308, "comment_id": 49059526, "body": "I think you&#39;ll get a syntax error as it is.  If xl is an application object then changing <code>xl.(&quot;Sheet1&quot;).Range(&quot;A1&quot;)</code> to <code>xl.activeworkbook.sheets(&quot;Sheet1&quot;).Range(&quot;A1&quot;)</code> should fix it."}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 2, "last_activity_date": 1432754378, "last_edit_date": 1432754378, "creation_date": 1432751013, "answer_id": 30490308, "question_id": 30490171, "link": "https://stackoverflow.com/questions/30490171/status-bar-to-display-a-cell-value/30490308#30490308", "title": "Status bar to display a cell value?", "body": "<p>When you use 4 (<code>acSysCmdSetStatus</code>) as the first argument to <code>SysCmd</code>, you can include only one additional argument ... so two arguments total, not three.  </p>\n\n<p>But you can combine your proposed second and third arguments into one string, and <code>SysCmd</code> will cooperate ...</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>SysCmd acSysCmdSetStatus, \"Sorting... \" &amp; xl.(\"Sheet1\").Range(\"A1\")\n</code></pre>\n\n<p>Note I assumed <code>xl</code> in your cell reference, <code>xl.(\"Sheet1\").Range(\"A1\")</code>, is an Excel workbook object.  Since it turns out <code>xl</code> is an application object, Sobigen's suggestion, <code>xl.activeworkbook.sheets(\"Sheet1\").Range(\"A1\")</code>, makes sense to me.  </p>\n\n<p>But whatever the correct cell reference is, take that and concatenate it with whatever else you want to appear in the status text ... and use that entire string as the second argument to <code>SysCmd</code></p>\n"}], "owner": {"reputation": 273, "user_id": 3512530, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c40f173cb8f935778e156188466477e7?s=128&d=identicon&r=PG&f=1", "display_name": "Elixir", "link": "https://stackoverflow.com/users/3512530/elixir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 644, "favorite_count": 0, "accepted_answer_id": 30490308, "answer_count": 1, "score": 1, "last_activity_date": 1432754378, "creation_date": 1432750513, "last_edit_date": 1432751044, "question_id": 30490171, "link": "https://stackoverflow.com/questions/30490171/status-bar-to-display-a-cell-value", "title": "Status bar to display a cell value?", "body": "<p>I use the status bar in nearly all my macros . If implemented correctly , allows you to see where your code is at.</p>\n\n<p>E.g</p>\n\n<pre><code>SysCmd(4, \"Sorting...\")\n\nSysCmd(5)\u2019Set status bar back to normal\n</code></pre>\n\n<p>Question - How do I get the status bar to display a cell value?</p>\n\n<p>E.g</p>\n\n<pre><code>SysCmd(4, \"Sorting...\") &amp; xl.(\"Sheet1\").Range(\"A1\")\n</code></pre>\n\n<p>Above doesn\u2019t work, but is there a way of doing this, in Access VBA ?</p>\n"}, {"tags": ["vba", "reference", "tags", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1432837650, "creation_date": 1432837650, "answer_id": 30514391, "question_id": 30490141, "link": "https://stackoverflow.com/questions/30490141/powerpoint-vba-for-tagging-objects-and-dynamically-updating-text-box-slide-refer/30514391#30514391", "title": "PowerPoint VBA for tagging objects and dynamically updating text box slide references", "body": "<p>To tag a shape, assuming it's currently selected:</p>\n\n<pre><code>With ActiveWindow.Selection.ShapeRange(1)\n   .Tags.Add \"TagName\", \"TagValue\"\nEnd With\n</code></pre>\n\n<p>So for example, select the table and:</p>\n\n<pre><code>With ActiveWindow.Selection.ShapeRange(1)\n   .Tags.Add \"ShapeTag\", \"Table1\"\n   ' the value above should be unique\nEnd With\n</code></pre>\n\n<p>Hooking the text that you want to update up to the table will be a bit trickier. I'd approach it by adding two tags to the text shape, the first being the text you want to appear in the text box, but with the slide number included as a replaceable parameter; the next tag would be a reference to the shape in question:</p>\n\n<pre><code>With ActiveWindow.Selection.ShapeRange(1)\n   .Tags.Add \"Text\", \"Refer to page #page#\"\n   .Tags.Add \"Shape\", \"Table1\"\nEnd With\n</code></pre>\n\n<p>To update, you'd run code that checks each shape on each slide and if the shape has Len(.Tags(\"Shape\")) > 0 you'd call a function that looks at each slide/each shape and returns the slide number where it finds a shape tagged \"Table1\".</p>\n\n<p>You'd then substitute the slide number in place of #page# in the .Text tag and apply that as the shape's .TextFrame.TextRange.Text</p>\n"}], "owner": {"reputation": 1, "user_id": 4945936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2383fa8509756db007d47e1e975d9de3?s=128&d=identicon&r=PG&f=1", "display_name": "Danielle Bello", "link": "https://stackoverflow.com/users/4945936/danielle-bello"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1081, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548342185, "creation_date": 1432750425, "last_edit_date": 1548342185, "question_id": 30490141, "link": "https://stackoverflow.com/questions/30490141/powerpoint-vba-for-tagging-objects-and-dynamically-updating-text-box-slide-refer", "title": "PowerPoint VBA for tagging objects and dynamically updating text box slide references", "body": "<p>Wondering if there is a macro that could automatically update slide references for objects on other slides. </p>\n\n<p>For instance, let\u2019s say there is a table on slide X. I want to be able to place a text box on slide 5 and say \u201crefer to page X.\u201d                             </p>\n\n<p>These presentations are printed so using hyperlinks would not work. We do not want to hard code the reference because if we add/delete slides, we do not want to go back and manually update all the references.                          </p>\n\n<p>My VBA knowledge is very limited. Not sure how to \"tag\" an object and then reference it.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2070, "user_id": 2026782, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/aXJk5.jpg?s=128&g=1", "display_name": "Jan Zahradn&#237;k", "link": "https://stackoverflow.com/users/2026782/jan-zahradn%c3%adk"}, "edited": false, "score": 0, "creation_date": 1432751536, "post_id": 30490139, "comment_id": 49058958, "body": "What about =YEAR(A1)"}], "answers": [{"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1432751900, "post_id": 30490204, "comment_id": 49059137, "body": "++ for giving both solutions :) @pnuts: seeing you after a long time:)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1432752196, "post_id": 30490204, "comment_id": 49059314, "body": "The Excel forum is just plain weird. @pnuts - glad to see you&#39;re back as part of it."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 3, "last_activity_date": 1432750611, "creation_date": 1432750611, "answer_id": 30490204, "question_id": 30490139, "link": "https://stackoverflow.com/questions/30490139/how-do-i-change-a-date-to-simply-a-year-in-excel/30490204#30490204", "title": "How do I change a date to simply a year in excel?", "body": "<p>As a worksheet formula,</p>\n\n<pre><code>=YEAR(A1)\n</code></pre>\n\n<p>As VBA code,</p>\n\n<pre><code>dim yr as integer\nyr = year(range(\"A1\"))\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 4946039, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zHR1ubXWxAA/AAAAAAAAAAI/AAAAAAAAAfo/KexrH_u96jI/photo.jpg?sz=128", "display_name": "Michael Royer", "link": "https://stackoverflow.com/users/4946039/michael-royer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432750611, "creation_date": 1432750422, "last_edit_date": 1531161705, "question_id": 30490139, "link": "https://stackoverflow.com/questions/30490139/how-do-i-change-a-date-to-simply-a-year-in-excel", "title": "How do I change a date to simply a year in excel?", "body": "<p>How do I change a date to simply a year in excel? 1/2/1989 to just 1989?</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 137, "user_id": 3167003, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/07e77ab4e6712c92e29c0dc6d8e367d7?s=128&d=identicon&r=PG&f=1", "display_name": "pony2deer", "link": "https://stackoverflow.com/users/3167003/pony2deer"}, "edited": false, "score": 3, "creation_date": 1432749569, "post_id": 30489690, "comment_id": 49057821, "body": "for another idea see <a href=\"http://stackoverflow.com/questions/5459734/using-msgbox-without-pausing-the-application\" title=\"using msgbox without pausing the application\">stackoverflow.com/questions/5459734/&hellip;</a>"}, {"owner": {"reputation": 618, "user_id": 3797860, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b0faeed70727847c1bbb7748d530acb6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_W4588", "link": "https://stackoverflow.com/users/3797860/ryan-w4588"}, "reply_to_user": {"reputation": 137, "user_id": 3167003, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/07e77ab4e6712c92e29c0dc6d8e367d7?s=128&d=identicon&r=PG&f=1", "display_name": "pony2deer", "link": "https://stackoverflow.com/users/3167003/pony2deer"}, "edited": false, "score": 0, "creation_date": 1432750196, "post_id": 30489690, "comment_id": 49058159, "body": "@pony2deer excellent link, just what I was looking for! Thank you very much."}], "answers": [{"comments": [{"owner": {"reputation": 618, "user_id": 3797860, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b0faeed70727847c1bbb7748d530acb6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_W4588", "link": "https://stackoverflow.com/users/3797860/ryan-w4588"}, "edited": false, "score": 0, "creation_date": 1435326638, "post_id": 31041364, "comment_id": 50168405, "body": "I agreed that the Status Bar was very unnoticeable. So much so that I didn&#39;t even realize it had text displaying on it until I was suggested to use it . I actually went with this route anyway, so I&#39;ll accept yours as the answer. Thanks!"}], "tags": [], "owner": {"reputation": 117, "user_id": 4115567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bdac4434725493543ded427cc082fce?s=128&d=identicon&r=PG&f=1", "display_name": "DevBW", "link": "https://stackoverflow.com/users/4115567/devbw"}, "is_accepted": true, "score": 2, "last_activity_date": 1435207453, "creation_date": 1435207453, "answer_id": 31041364, "question_id": 30489690, "link": "https://stackoverflow.com/questions/30489690/access-2010-vba-dialogue-box-that-opens-when-query-starts-closes-when-query-i/31041364#31041364", "title": "Access 2010 VBA - Dialogue box that opens when query starts, closes when query is done", "body": "<p>although pony2deer's link offers the Application.StatusBar solution.. I've found the status bar doesn't attract the user's attention and often goes entirely unnoticed.  </p>\n\n<p>I'd recommend using a form that shows just before the query is executed, then hides just after the query finishes running. If you already have a form open (sounds like you do), you can simply add a label to the form and update the caption.  Update it to #1 below right before the query is executed.  Then update it again to #2 right after the query finishes processing.</p>\n\n<p>1.) labelStatus.Caption = \"Please wait while your query is processed...\"</p>\n\n<p>2.) labelStatus.Caption = \"Success! Your query has finished processing.\"</p>\n\n<p>Jack up the font size, make it colorful, etc.  You really want the status to jump out so your users don't go around clicking things and impacting the performance of your app.</p>\n"}], "owner": {"reputation": 618, "user_id": 3797860, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b0faeed70727847c1bbb7748d530acb6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_W4588", "link": "https://stackoverflow.com/users/3797860/ryan-w4588"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 31041364, "answer_count": 1, "score": 3, "last_activity_date": 1594644247, "creation_date": 1432749003, "last_edit_date": 1594644247, "question_id": 30489690, "link": "https://stackoverflow.com/questions/30489690/access-2010-vba-dialogue-box-that-opens-when-query-starts-closes-when-query-i", "title": "Access 2010 VBA - Dialogue box that opens when query starts, closes when query is done", "body": "<p>I have a query that takes a bit of time to complete. My users don't realize that a query is taking place once they click a button, seeing as there isn't a dialogue box or text explaining what steps the process is on. My question is:</p>\n\n<p><code>Is it possible to create a dialogue box that appears when a query begins, and closes when a query ends?</code></p>\n\n<p>If it's possible to update the dialogue box (i.e. when my first subform is being updated, have the box say <code>Updating User information</code> and when my second subform is being updated it says \n<code>Calculating Monthly Suggestions</code>) in VBA. I am using this in my Access 2010 database.</p>\n\n<p>TIA!</p>\n"}, {"tags": ["vba", "visio"], "answers": [{"tags": [], "owner": {"reputation": 139, "user_id": 2161432, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/95d599e9bcd6c937757d9cd66781a413?s=128&d=identicon&r=PG", "display_name": "M.Ford", "link": "https://stackoverflow.com/users/2161432/m-ford"}, "is_accepted": false, "score": 0, "last_activity_date": 1433184134, "creation_date": 1433184134, "answer_id": 30580846, "question_id": 30489157, "link": "https://stackoverflow.com/questions/30489157/adjust-visio-shape-properties-after-placement/30580846#30580846", "title": "Adjust Visio shape properties after placement", "body": "<p>This is not so much of an answer but a solution. For it to be an answer, I would need to know why I was having problems accessing the properties for a group withing a shape when there is more than one group. The solution was to redesign all the custom shapes to only have one group. once that was done, the code as listed above for setting the property values worked without issue.</p>\n\n<p>I suspect the best solution would be to have to figure out how to reference nested group properties directly.</p>\n\n<p>Thanks.</p>\n\n<p>Michael</p>\n"}], "owner": {"reputation": 139, "user_id": 2161432, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/95d599e9bcd6c937757d9cd66781a413?s=128&d=identicon&r=PG", "display_name": "M.Ford", "link": "https://stackoverflow.com/users/2161432/m-ford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 348, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593554669, "creation_date": 1432747097, "last_edit_date": 1593554669, "question_id": 30489157, "link": "https://stackoverflow.com/questions/30489157/adjust-visio-shape-properties-after-placement", "title": "Adjust Visio shape properties after placement", "body": "<p>I just need some direction, I can find the answer if I know where to look. I am programmatically dropping shapes on a sheet as an output from a db query. Those shapes have a number of properties (prop.). I would like to drop the shape then set those properties to something. The way that I am doing is giving me errors. I suspect that there is a step that I am missing. Here is how I drop the shape</p>\n\n<pre><code>Dim vsoShape As Visio.Shape\nDim vsoMaster As Visio.Master\n\nFor lngRow = LBound(lngRowIDs) + 1 To UBound(lngRowIDs) + 1\n    varRowData = vsoDataRecordset.GetRowData(lngRow)\n\n    Set vsoMaster = Visio.Documents(varRowData(14) + \".vss\").Masters(varRowData(8))\n\n    dblX = dblX + 0.5\n    dblY = dblY + 0.5\n\n    Set vsoShape = ActivePage.Drop(vsoMaster, dblX, dblY)\n\n    'vsoShape.Cells(\"Prop.title\").Formula = Chr(34) &amp; varRowData(0) &amp; Chr(34)\n    'vsoShape.Cells(\"Prop.Entitlements\").Formula = Chr(34) &amp; varRowData(1) &amp; Chr(34)\n    'vsoShape.Cells(\"Prop.environ\").Formula = Chr(34) &amp; varRowData(2) &amp; Chr(34)\n    'vsoShape.Cells(\"Prop.netZone\").Formula = Chr(34) &amp; varRowData(3) &amp; Chr(34)\n    'vsoShape.Cells(\"Prop.Mem\").Formula = Chr(34) &amp; varRowData(4) &amp; Chr(34)\n    'vsoShape.Cells(\"Prop.vcpu_cores\").Formula = Chr(34) &amp; varRowData(5) &amp; Chr(34)\n    'vsoShape.Cells(\"Prop.sockets\").Formula = Chr(34) &amp; varRowData(6) &amp; Chr(34)\n    'vsoShape.Cells(\"Prop.hosts\").Formula = Chr(34) &amp; varRowData(7) &amp; Chr(34)\n    'vsoShape.Cells(\"Prop.shape\").Formula = Chr(34) &amp; varRowData(8) &amp; Chr(34)\n    'vsoShape.Cells(\"Prop.shapeKey\").Formula = Chr(34) &amp; varRowData(15) &amp; Chr(34)            \nNext lngRow\n</code></pre>\n\n<p>I think that what I need to do is get some shape ID after I drop it then use that shape id to set the values. The error seems to be that it cannot find the property name. All the prop.X names are correct. The error that I get is</p>\n\n<blockquote>\n  <p>Run-time error '-2032466967 (86db03e9)': Unexpected end of file</p>\n</blockquote>\n\n<p>I am new to working with Visio VBA. I am more used to Excel.</p>\n\n<p>Michael.</p>\n"}, {"tags": ["excel", "vba", "error-handling"], "answers": [{"tags": [], "owner": {"reputation": 5852, "user_id": 1690392, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/A3DKR.jpg?s=128&g=1", "display_name": "nutsch", "link": "https://stackoverflow.com/users/1690392/nutsch"}, "is_accepted": false, "score": 2, "last_activity_date": 1432764697, "last_edit_date": 1432764697, "creation_date": 1432747063, "answer_id": 30489147, "question_id": 30489035, "link": "https://stackoverflow.com/questions/30489035/vba-excel-simple-error-handling/30489147#30489147", "title": "VBA Excel simple Error Handling", "body": "<p>Try:</p>\n\n<pre><code>On Error Resume Next\n\nfor i = 1 to (a certain number)\n    Set shp = f_overview.Shapes(\"btn_\" &amp; i)\n    if err&lt;&gt;0 then err.clear else shp.delete\nnext\n\non Error Goto 0\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1432753532, "post_id": 30489194, "comment_id": 49060035, "body": "Thanks! I kept trying the suggestions of the other answerers and all failed. This was why although they also provided valuable information!"}, {"owner": {"reputation": 2595, "user_id": 3897316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cf468fea626f3aec65a199e2f67b309?s=128&d=identicon&r=PG&f=1", "display_name": "Degustaf", "link": "https://stackoverflow.com/users/3897316/degustaf"}, "reply_to_user": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1432753692, "post_id": 30489194, "comment_id": 49060115, "body": "@DavidGrand&#39;Maison I agree that the error handling being done in the other answers is cleaner and better.  But your original code should have worked."}], "tags": [], "owner": {"reputation": 2595, "user_id": 3897316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cf468fea626f3aec65a199e2f67b309?s=128&d=identicon&r=PG&f=1", "display_name": "Degustaf", "link": "https://stackoverflow.com/users/3897316/degustaf"}, "is_accepted": true, "score": 8, "last_activity_date": 1432751718, "last_edit_date": 1432751718, "creation_date": 1432747216, "answer_id": 30489194, "question_id": 30489035, "link": "https://stackoverflow.com/questions/30489035/vba-excel-simple-error-handling/30489194#30489194", "title": "VBA Excel simple Error Handling", "body": "<p>It sounds like you have the wrong error trapping option set.  Within the VBA Editor, Select <code>Tools -&gt; Options</code>.  In the window that opens, select the <code>General tab</code>, and pick the <code>Break on Unhandled Errors</code> radio button.  This should allow Excel to properly process the <code>On Error Resume Next</code> command.</p>\n\n<p>I suspect that you have <code>Break on All Errors</code> selected.</p>\n"}, {"comments": [{"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1432753065, "post_id": 30489225, "comment_id": 49059785, "body": "AH excellent! This is the way I will choose to do it. Thank you for the fix. +1 for answer even though you don&#39;t explain how to use error handling :-)"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1432753334, "post_id": 30489225, "comment_id": 49059918, "body": "You are correct on the lack of error handling detail - this loop doesn&#39;t require it, especially not in the way you were thinking. <a href=\"http://stackoverflow.com/a/30489275/2344413\">Mat&#39;s Mug</a> does a fine job of covering error handling in general."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1542642904, "post_id": 30489225, "comment_id": 93632201, "body": "It&#39;s OK, <a href=\"https://stackoverflow.com/questions/30489035/vba-excel-simple-error-handling/30489225#comment90810913_30489225\">@FreeMan</a>, 3 months after that, there was a random drive-by upvote! :)"}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 14, "last_activity_date": 1432747354, "creation_date": 1432747354, "answer_id": 30489225, "question_id": 30489035, "link": "https://stackoverflow.com/questions/30489035/vba-excel-simple-error-handling/30489225#30489225", "title": "VBA Excel simple Error Handling", "body": "<p>Instead of trying to blindly delete shapes and skipping errors, why not run through the list of known shapes and delete them. Then you don't have to worry about an <code>On Error Resume Next</code> which <em>often</em> ends up being abused.</p>\n\n<pre><code>Sub Test(TheSheet As Worksheet)\n\nDim Shp as Shape\n\nFor Each Shp in TheSheet.Shapes\n  If left(Shp.Name, 4) = \"btn_\" Then\n    Shp.Delete\n  End if\nNext\n\nEnd Sub\n</code></pre>\n\n<p>If you want to delete all shapes, remove the <code>If</code> statement. If you want to delete a number of differently named shapes, modify the <code>If</code> statement appropriately.</p>\n"}, {"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1432749071, "post_id": 30489275, "comment_id": 49057552, "body": "++ on Proper Error Handling :)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432750724, "post_id": 30489275, "comment_id": 49058445, "body": "@SiddharthRout yeah, except I didn&#39;t test it and now the more I think of it, the more I believe the assignment would throw an <code>index out of range</code> error, in which case <a href=\"http://stackoverflow.com/a/30489225/1188513\">FreeMan&#39;s answer</a> has a better solution."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432750935, "post_id": 30489275, "comment_id": 49058588, "body": "That;s ok :) Edit your above code. My comment was the proper error handling that you showed t the bottom of the post. i did mention about that in my post as well :)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432752597, "post_id": 30489275, "comment_id": 49059534, "body": "@SiddharthRout edited, ...without stealing from anyone&#39;s answer :)"}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1432753733, "post_id": 30489275, "comment_id": 49060139, "body": "Good tips, for someone new to error handling like me. The reason it was failing, though, was apparently because I had the wrong settings (see chosen answer)."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 25, "last_activity_date": 1432752579, "last_edit_date": 1592644375, "creation_date": 1432747534, "answer_id": 30489275, "question_id": 30489035, "link": "https://stackoverflow.com/questions/30489035/vba-excel-simple-error-handling/30489275#30489275", "title": "VBA Excel simple Error Handling", "body": "<blockquote>\n<p>I have found that most of the time, the reccomended fix is to add (on error resume next) before setting the shape, as I get an error saying it does not exist.</p>\n</blockquote>\n<h1>NO!</h1>\n<p>The recommended way to <em>handle</em> runtime errors is <strong>not</strong> to shove them under the carpet and continue execution as if nothing happened - which is exactly what <code>On Error Resume Next</code> does.</p>\n<p>The simplest way to <em>avoid</em> runtime errors is to check for error conditions, and avoid executing code that results in 100% failure rate, like trying to run a method on an object reference that's <code>Nothing</code>:</p>\n<pre><code>For i = 1 To (a certain number)\n    Set shp = f_overview.Shapes(&quot;btn_&quot; &amp; i)\n    If Not shp Is Nothing Then shp.Delete\nNext\n</code></pre>\n<hr />\n<p>In cases where you can't check for error conditions and <em>must</em> handle errors, the recommended way is to <em>handle</em> them:</p>\n<pre><code>Private Sub DoSomething()\n    On Error GoTo CleanFail\n\n    '...code...\n\nCleanExit:\n    'cleanup code here\n    Exit Sub\n\nCleanFail:\n    If Err.Number = 9 Then 'subscript out of range\n        Err.Clear\n        Resume Next\n    Else\n        MsgBox Err.Description\n        Resume CleanExit\n    End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1432753620, "post_id": 30489547, "comment_id": 49060075, "body": "Thanks for the explanation! The reason it was failing, though, was because I had the wrong settings (see chosen answer)."}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 3, "creation_date": 1432757521, "post_id": 30489547, "comment_id": 49062360, "body": "++ but unfortunately most don&#39;t understand the implications of using OERN. I like that acronym btw. I&#39;m keeping it."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 15, "last_activity_date": 1432749042, "last_edit_date": 1432749042, "creation_date": 1432748534, "answer_id": 30489547, "question_id": 30489035, "link": "https://stackoverflow.com/questions/30489035/vba-excel-simple-error-handling/30489547#30489547", "title": "VBA Excel simple Error Handling", "body": "<p>There is nothing WRONG in using <strong>OERN</strong> (<em>On Error Resume Next</em>) provided you understand what you are doing and how it is going to affect your code.</p>\n\n<p>In your case it is perfectly normal to use OERN</p>\n\n<pre><code>Dim shp As Shape\n\nFor i = 1 To (a certain number)\n    On Error Resume Next\n    Set shp = f_overview.Shapes(\"btn_\" &amp; i)\n    shp.Delete\n    On Error GoTo 0\nNext\n</code></pre>\n\n<p>At the same time ensure that you don't do something like</p>\n\n<pre><code>On Error Resume Next\n&lt;Your Entire Procedure&gt;\nOn Error GoTo 0\n</code></pre>\n\n<p>This will suppress ALL errors. Use proper error handling as shown by Matt</p>\n\n<p><strong>Edit</strong>:</p>\n\n<p>Here is another beautiful example on how to use <strong>OERN</strong> This function checks if a particular worksheet exists or not. </p>\n\n<pre><code>Function DoesWSExist(wsName As String) As Boolean\n    Dim ws As Worksheet\n\n    On Error Resume Next\n    Set ws = ThisWorkbook.Sheets(wsName)\n    On Error GoTo 0\n\n    If Not ws Is Nothing Then DoesWSExist = True\nEnd Function\n</code></pre>\n\n<p>If you wish you can also loop through all the sheets to check is the sheet exists or not!</p>\n"}], "owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3178, "favorite_count": 4, "accepted_answer_id": 30489194, "answer_count": 5, "score": 20, "last_activity_date": 1579882937, "creation_date": 1432746701, "last_edit_date": 1579882937, "question_id": 30489035, "link": "https://stackoverflow.com/questions/30489035/vba-excel-simple-error-handling", "title": "VBA Excel simple Error Handling", "body": "<p>I have looked online as much as I could (except for the Microsoft support website, which is blocked at work for some reason). I am trying to simply skip an error. My code written here is simplified but should work the same way.</p>\n\n<p><strong>What my code is supposed to do:</strong>\nOne of my subs creates shapes in a loop and names them (btn_1, btn_2, etc). But before creating them, it calls a sub that tries to delete them so as not to create duplicates. This sub loops through (btn_1, btn_2, etc) and deletes the shapes using:</p>\n\n<pre><code>for i = 1 to (a certain number)\n    Set shp = f_overview.Shapes(\"btn_\" &amp; i)\n    shp.delete\nnext\n</code></pre>\n\n<p>Of course, it happens that the shape cannot be deleted because it simply does not exist. I have found that most of the time, the reccomended fix is to add (on error resume next) before setting the shape, as I get an error saying it does not exist. I have tried it inside the loop, before the loop, etc, like so:</p>\n\n<pre><code>for i = 1 to (a certain number)\n    On Error Resume Next\n    Set shp = f_overview.Shapes(\"btn_\" &amp; i)\n    shp.delete\nnext\n</code></pre>\n\n<p>As far as I understand it is supposed to loop right through if the shape doesn't exist, but I still get the same error whether or not I add the On error resume next! What am I doing wrong?</p>\n\n<p>EDIT: There is no error when the shapes do exist.</p>\n"}, {"tags": ["sql", "excel", "vba", "parameters"], "answers": [{"tags": [], "owner": {"reputation": 114165, "user_id": 13087, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/260e2731006271646d36705a95c4db48?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/13087/joe"}, "is_accepted": false, "score": 0, "last_activity_date": 1432747011, "last_edit_date": 1495540269, "creation_date": 1432747011, "answer_id": 30489131, "question_id": 30488983, "link": "https://stackoverflow.com/questions/30488983/need-assistance-with-sql-in-excel-specifically-the-parameter/30489131#30489131", "title": "Need assistance with SQL in Excel, specifically the &quot;?&quot; Parameter", "body": "<p>You can't pass multiple parameters in that way.</p>\n\n<p>Depending on what database you're using, you may be able to pass a single string parameter to the databaase engine, and have the database engine split the string for you.</p>\n\n<p>For example, <a href=\"https://stackoverflow.com/questions/5401641/passing-a-sql-parameter-to-an-in-clause-using-typed-datasets-in-net/5401777#5401777\">this answer has a solution for SQL Server</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1432748190, "creation_date": 1432748190, "answer_id": 30489447, "question_id": 30488983, "link": "https://stackoverflow.com/questions/30488983/need-assistance-with-sql-in-excel-specifically-the-parameter/30489447#30489447", "title": "Need assistance with SQL in Excel, specifically the &quot;?&quot; Parameter", "body": "<p>You're close. It's just that <code>=</code> compares only a single value, and you're trying to give it multiple ones. Try an <code>IN</code> statement:</p>\n\n<pre><code>WHERE SEC_ID IN (?)\n</code></pre>\n\n<p>And then this input string should work:</p>\n\n<pre><code>'Justin','John','James'\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4945737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/179dcede245bf50748a9814ead88c8d4?s=128&d=identicon&r=PG&f=1", "display_name": "JW_513", "link": "https://stackoverflow.com/users/4945737/jw-513"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1432748190, "creation_date": 1432746546, "last_edit_date": 1432747257, "question_id": 30488983, "link": "https://stackoverflow.com/questions/30488983/need-assistance-with-sql-in-excel-specifically-the-parameter", "title": "Need assistance with SQL in Excel, specifically the &quot;?&quot; Parameter", "body": "<p>I've set up this SQL query in excel: </p>\n\n<pre><code>SELECT * FROM acct.view_op_seremain\n\nWHERE SEC_ID = (?)\n</code></pre>\n\n<p>I've directed the \"?\" parameter to cell A1 in Excel. Now, I want this A1 parameter cell to contain multiple values but I am unsure if it requires special formatting? So far I have tried to do the following in Cell A1: </p>\n\n<pre><code>Justin, John, James\n\n('Justin','John','James')\n\n'Justin','John','James'\n</code></pre>\n\n<p>None of those formats are giving me results. Do you know what I am doing wrong? </p>\n"}, {"tags": ["excel", "vba", "cell", "selection"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4945729"}, "edited": false, "score": 0, "creation_date": 1432746946, "post_id": 30489031, "comment_id": 49056337, "body": "That was exactly what I wanted to to :)    <code>Application.ActiveCell.Offset(0, 1).Select</code> Thank you so much!"}], "tags": [], "owner": {"reputation": 114165, "user_id": 13087, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/260e2731006271646d36705a95c4db48?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/13087/joe"}, "is_accepted": true, "score": 1, "last_activity_date": 1432746688, "creation_date": 1432746688, "answer_id": 30489031, "question_id": 30488936, "link": "https://stackoverflow.com/questions/30488936/vba-access-sheet-from-userform/30489031#30489031", "title": "VBA: access sheet from userForm", "body": "<p>I'm not sure I fully understand what you're trying to achieve, but can't you simply use:</p>\n\n<pre><code>Application.ActiveCell\n</code></pre>\n\n<p>in <code>UserForm_Terminate</code>?</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4945729"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 593, "favorite_count": 0, "accepted_answer_id": 30489031, "answer_count": 1, "score": 1, "last_activity_date": 1448231740, "creation_date": 1432746372, "last_edit_date": 1448231740, "question_id": 30488936, "link": "https://stackoverflow.com/questions/30488936/vba-access-sheet-from-userform", "title": "VBA: access sheet from userForm", "body": "<p>I am trying to access my workbook and sheets while I am in a subroutine of my UserForm.</p>\n\n<p>My macro starts when the focus in the worksheet is changed:</p>\n\n<pre><code>Sub Worksheet_SelectionChange(ByVal Target As Range)\n    '...\nEnd Sub\n</code></pre>\n\n<p>In my UserForm, I now wanted to define what happens when the red x on the top right is pressed. In that case I want to change the focus/selection in Sheet1 when that UserForm is closed. Though, I want to do this relative to the original position, so relative to <strong>Target</strong> or relative to the <strong>ActiveCell</strong>.</p>\n\n<p>What works in the routine above is:</p>\n\n<pre><code>ActiveCell.Offset(0, 1).Select\n</code></pre>\n\n<p>However, I would like to do this in the routine below:</p>\n\n<pre><code>Sub UserForm_Terminate()\n    Me.Hide\n    'change focus here\n    End\nEnd Sub\n</code></pre>\n\n<p>I was able to select a cell with</p>\n\n<pre><code>Sheet1.Cells(3, 3).Select\n</code></pre>\n\n<p>but that is obviously not relative to the original position. Neither <strong>Target</strong> nor <strong>ActiveCell...</strong> are available in UserForm_Terminate </p>\n\n<p>I hope anyone can help</p>\n\n<p>Vincenz</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 2, "creation_date": 1432746488, "post_id": 30488655, "comment_id": 49056070, "body": "Care to explain the down vote? Other than poor formatting of the issue, it&#39;s actually pretty decent for a first post."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1432746899, "post_id": 30488655, "comment_id": 49056310, "body": "@pnuts - could be - I can&#39;t see VTC. Not sure I&#39;d agree with the sentiment, but what do I know..."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1432751920, "post_id": 30488655, "comment_id": 49059149, "body": "@pnuts (c) - thanks!  <i>blush</i>"}], "answers": [{"comments": [{"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 1, "creation_date": 1432746562, "post_id": 30488935, "comment_id": 49056120, "body": "On replacing the Copy command with setting the value--you are assuming the value is the only thing the OP wanted to copy. If so, this is the better way. However, if the desire is to also copy formatting, then the original method is needed."}, {"owner": {"reputation": 33, "user_id": 4945603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9593546d9d6e5fd713006c06b53d858?s=128&d=identicon&r=PG&f=1", "display_name": "EL BAILARIN", "link": "https://stackoverflow.com/users/4945603/el-bailarin"}, "edited": false, "score": 0, "creation_date": 1432762891, "post_id": 30488935, "comment_id": 49065013, "body": "Rachel / FreeMan: You guys just explained why I kept getting the borders after I ran the macro!!! Thank you! I don&#39;t need the copy formatting, just the value."}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 1, "last_activity_date": 1432746371, "creation_date": 1432746371, "answer_id": 30488935, "question_id": 30488655, "link": "https://stackoverflow.com/questions/30488655/how-do-i-copy-paste-cell-values-if-the-condition-is-true-and-enter-0-if-the-ce/30488935#30488935", "title": "How do I copy/paste cell values if the condition is true and enter &quot;0&quot; if the cell being looked at in the condition isn&#39;t there?", "body": "<p>You are very, very close. </p>\n\n<p>Change this:</p>\n\n<pre><code>If .Range(\"C\" &amp; i) is between 6 &amp; 16 or is between 28 &amp; 39 Then\n</code></pre>\n\n<p>to</p>\n\n<pre><code>If (.Range(\"C\" &amp; i) &gt;= 6 and .Range(\"C\" &amp; i) &lt;= 16) OR _\n   (.Range(\"C\" &amp; i) &gt;= 28 and .Range(\"C\" &amp; i) &lt;=39) Then\n</code></pre>\n\n<p>Also, simplify this:</p>\n\n<pre><code>Sheets(\"DIC2\").Range(\"E\" &amp; i).Copy Destination:=Sheets(\"CANmonitor\").Range(\"C\" &amp; k)\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>Sheets(\"CANmonitor\").Range(\"C\" &amp; k) = Sheets(\"DIC2\").Range(\"E\" &amp; i)\n</code></pre>\n\n<p>It gives the same result, but requires less typing and is easier to read.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 4945603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9593546d9d6e5fd713006c06b53d858?s=128&d=identicon&r=PG&f=1", "display_name": "EL BAILARIN", "link": "https://stackoverflow.com/users/4945603/el-bailarin"}, "edited": false, "score": 0, "creation_date": 1432762777, "post_id": 30488939, "comment_id": 49064960, "body": "This is wonderful! It didn&#39;t work for me but I get what is being done here. This is giving me the same result that I&#39;ve gotten while trying to figure it out. It seems as if it&#39;s not performing the test and just skipping to Else, which just copies over the values and I don&#39;t get the 0s. I&#39;m supposed to have 50 parameters but I end up with only 31 because of the missing 19 values pointed out in the test variant. Also, the &quot;k&quot; should increment after each test, whether it copies the data or sets it to 0."}, {"owner": {"reputation": 33, "user_id": 4945603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9593546d9d6e5fd713006c06b53d858?s=128&d=identicon&r=PG&f=1", "display_name": "EL BAILARIN", "link": "https://stackoverflow.com/users/4945603/el-bailarin"}, "edited": false, "score": 0, "creation_date": 1432769223, "post_id": 30488939, "comment_id": 49067134, "body": "Guys, thank you so much. I think I know what the problem is. If  .Range(&quot;C&quot; &amp; i).Value is never equal to the values between 6 - 16 or 28 - 39, then it can&#39;t set it to zero. That&#39;s what I was missing..........I will never have those values so I just need to set them to zero when &quot;k&quot; equals any of the numbers in the range. I&#39;ll try to code it. Thank you all for your help."}], "tags": [], "owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1432746381, "creation_date": 1432746381, "answer_id": 30488939, "question_id": 30488655, "link": "https://stackoverflow.com/questions/30488655/how-do-i-copy-paste-cell-values-if-the-condition-is-true-and-enter-0-if-the-ce/30488939#30488939", "title": "How do I copy/paste cell values if the condition is true and enter &quot;0&quot; if the cell being looked at in the condition isn&#39;t there?", "body": "<p>I cleaned up your code just a bit to correct a few things (formatting, missing dot, removed problematic With statement), and most importantly, I added the syntax for the \"between\" tests that you needed.</p>\n\n<pre><code>Sub DIC2toCAN()\n\nDim LR As Long, i As Long, k As Long\nWith Sheets(\"DIC2\")\n    LR = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row\n    k = 1\n    For i = 1 To LR\n        If .Range(\"B\" &amp; i).Value = \"1731\" Then\n            Dim test As Variant\n            test = .Range(\"C\" &amp; i).Value\n            If (test &gt;= 6 And test &lt;= 16) Or (test &gt;= 28 And test &lt;= 39) Then\n                Sheets(\"CANmonitor\").Range(\"C\" &amp; k) = 0\n            Else\n                Sheets(\"DIC2\").Range(\"E\" &amp; i).Copy Destination:=Sheets(\"CANmonitor\").Range(\"C\" &amp; k)\n                k = k + 1\n            End If\n         End If\n     Next i\nEnd With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 4945603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9593546d9d6e5fd713006c06b53d858?s=128&d=identicon&r=PG&f=1", "display_name": "EL BAILARIN", "link": "https://stackoverflow.com/users/4945603/el-bailarin"}, "edited": false, "score": 0, "creation_date": 1432763624, "post_id": 30490952, "comment_id": 49065294, "body": "Siddharth, it doesn&#39;t perform the tests and just goes to &quot;case else.&quot; I don&#39;t get the zeros and i&#39;m missing the 19 values (7-15 and 29-38)."}, {"owner": {"reputation": 33, "user_id": 4945603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9593546d9d6e5fd713006c06b53d858?s=128&d=identicon&r=PG&f=1", "display_name": "EL BAILARIN", "link": "https://stackoverflow.com/users/4945603/el-bailarin"}, "edited": false, "score": 0, "creation_date": 1432769249, "post_id": 30490952, "comment_id": 49067145, "body": "Guys, thank you so much. I think I know what the problem is. If  .Range(&quot;C&quot; &amp; i).Value is never equal to the values between 6 - 16 or 28 - 39, then it can&#39;t set it to zero. That&#39;s what I was missing..........I will never have those values so I just need to set them to zero when &quot;k&quot; equals any of the numbers in the range. I&#39;ll try to code it. Thank you all for your help."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 2, "last_activity_date": 1432753132, "creation_date": 1432753132, "answer_id": 30490952, "question_id": 30488655, "link": "https://stackoverflow.com/questions/30488655/how-do-i-copy-paste-cell-values-if-the-condition-is-true-and-enter-0-if-the-ce/30490952#30490952", "title": "How do I copy/paste cell values if the condition is true and enter &quot;0&quot; if the cell being looked at in the condition isn&#39;t there?", "body": "<p>Here is another version. This code declares all the objects beforehand and then works with it. This way if later you need to change the sheet name, you do it at only one place. This code (<strong>Untested</strong>) also uses <code>Select Case</code> for simplicity.</p>\n\n<pre><code>Sub DIC2toCAN()\n    Dim LR As Long, i As Long, k As Long\n    Dim wsI As Worksheet, wsO As Worksheet\n\n    '~~&gt; Set your sheets here\n    Set wsI = ThisWorkbook.Sheets(\"DIC2\")\n    Set wsO = ThisWorkbook.Sheets(\"CANmonitor\")\n\n    With wsI\n        LR = .Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n\n        k = 1\n\n        For i = 1 To LR\n            '~~&gt; Use Val to get the value\n            If Val(.Range(\"B\" &amp; i).Value) = 1731 Then\n                '~~&gt; Use select case for simplicity\n                Select Case Val(.Range(\"C\" &amp; i).Value)\n                Case 6 To 16, 28 To 39\n                    wsO.Range(\"C\" &amp; k).Value = 0\n                Case Else\n                    .Range(\"E\" &amp; i).Copy wsO.Range(\"C\" &amp; k)\n                    k = k + 1\n                End Select\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 4945603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9593546d9d6e5fd713006c06b53d858?s=128&d=identicon&r=PG&f=1", "display_name": "EL BAILARIN", "link": "https://stackoverflow.com/users/4945603/el-bailarin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 429, "favorite_count": 0, "accepted_answer_id": 30488939, "answer_count": 3, "score": 2, "last_activity_date": 1432753132, "creation_date": 1432745467, "last_edit_date": 1531161705, "question_id": 30488655, "link": "https://stackoverflow.com/questions/30488655/how-do-i-copy-paste-cell-values-if-the-condition-is-true-and-enter-0-if-the-ce", "title": "How do I copy/paste cell values if the condition is true and enter &quot;0&quot; if the cell being looked at in the condition isn&#39;t there?", "body": "<p>I'm very new to VBA and I haven't been able to figure this out yet. </p>\n\n<p>I need a code that copies cell <code>.Range(\"E\" &amp; i)</code> to cell <code>Sheets(\"CANmonitor\").Range(\"C\" &amp; k)</code> if Column <code>B = 1731</code>. </p>\n\n<p>However, it needs to look at <code>.Range(\"C\" &amp; i)</code> as well and set <code>Sheets(\"CANmonitor\").Range(\"C\" &amp; K) = 0</code> if <code>.Range(\"C\" &amp; i)</code> is between <code>6</code> &amp; <code>16</code> or between <code>28</code> &amp; <code>39</code>. </p>\n\n<p>To simplify, the value on column <code>C</code> jumps from <code>6</code> to <code>16</code> and from <code>28</code> to <code>39</code>. I need the code to enter <code>0s</code> for the missing values (ex: <code>1731.6</code> = data from <code>cell (\"E\" &amp; i)</code> on sheet <code>DIC2</code>; <code>1731.7</code> = <code>0</code>). Here's what I have so far:</p>\n\n<pre><code>Sub DIC2toCAN()\n    Dim LR As Long, i As Long, k As Long\n\n    With Sheets(\"DIC2\")\n        LR = .Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n\n        k = 1\n        For i = 1 To LR\n            With .Range(\"B\" &amp; i)\n                If .Value = \"1731\" Then\n                    If .Range(\"C\" &amp; i) is between 6 &amp; 16 or is between 28 &amp; 39 Then\n                        Sheets(\"CANmonitor\").Range(\"C\" &amp; k) = 0\n                    Else\n                        Sheets(\"DIC2\").Range(\"E\" &amp; i).Copy _\n                        Destination:=Sheets(\"CANmonitor\").Range(\"C\" &amp; k)\n                        k = k + 1\n                    End If\n                End If\n            End With\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["c++", "windows", "excel", "vba", "dll"], "comments": [{"owner": {"reputation": 3842, "user_id": 2216929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cfa9e99112a82bc03a57d97d09e7217?s=128&d=identicon&r=PG", "display_name": "kaybee99", "link": "https://stackoverflow.com/users/2216929/kaybee99"}, "edited": false, "score": 1, "creation_date": 1432745640, "post_id": 30488628, "comment_id": 49055538, "body": "Try <code>Dim x As LongPtr</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3842, "user_id": 2216929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cfa9e99112a82bc03a57d97d09e7217?s=128&d=identicon&r=PG", "display_name": "kaybee99", "link": "https://stackoverflow.com/users/2216929/kaybee99"}, "is_accepted": false, "score": 1, "last_activity_date": 1432810967, "creation_date": 1432810967, "answer_id": 30504746, "question_id": 30488628, "link": "https://stackoverflow.com/questions/30488628/vba-64-bit-excel-not-passing-pointers-to-dll-functions-c/30504746#30504746", "title": "VBA 64-bit Excel not passing pointers to DLL functions (C++)", "body": "<pre><code>Dim x As LongPtr\nDim z As Double\nz = test(x, CLng(1))\n</code></pre>\n\n<p><code>LongPtr</code> evaluates to <code>Long</code> in 32-Bit environments and to <code>LongLong</code> in 64-Bit environments so defining x as such should work.</p>\n\n<p>Addtionally, <code>CLng</code> will ensure 1 is evaluated as a <code>Long</code> type. If this is not added VBA will assume you mean <code>Integer</code></p>\n"}], "owner": {"reputation": 15, "user_id": 4945716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79ec37319bb1ba2166285d92a8d439fc?s=128&d=identicon&r=PG&f=1", "display_name": "Hamid", "link": "https://stackoverflow.com/users/4945716/hamid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 715, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1432810967, "creation_date": 1432745371, "last_edit_date": 1432745880, "question_id": 30488628, "link": "https://stackoverflow.com/questions/30488628/vba-64-bit-excel-not-passing-pointers-to-dll-functions-c", "title": "VBA 64-bit Excel not passing pointers to DLL functions (C++)", "body": "<p>I have VBA program running on Excel 64-bit calling some DLL functions (C++). The problem is (apparently) it can't pass pointers to C++ program. The program works with Excel 32-bit.The operating system is <strong>Windows 8</strong>. For  Windows 7 both 32-bit and 64-bit versions of Excel are working well. </p>\n\n<p>C++ :</p>\n\n<pre><code>double test(long* v, long i) \n {\n    if (v == NULL)\n        return -88;\n    else\n        return *((long*)v);\n }\n</code></pre>\n\n<p>VBA: </p>\n\n<pre><code>Private Declare PtrSafe Function hamid_test Lib \"...\\CVode.dll\" (ByVal v As LongPtr, ByVal i As Long) As Double\n\n Dim x As LongLong\n Dim z As Double\n z = test(x, 1)\n</code></pre>\n\n<p>It returns <code>-88</code>.</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1432830775, "last_edit_date": 1432830775, "creation_date": 1432747247, "answer_id": 30489201, "question_id": 30488475, "link": "https://stackoverflow.com/questions/30488475/run-excel-macro-via-vba-in-acces/30489201#30489201", "title": "Run Excel Macro via VBA in Acces", "body": "<p>Untested:</p>\n\n<pre><code>Private Sub Main_btn_Click()\n\n    Dim fileInfo(0 To 3, 0 To 2) As String\n    Dim i As Integer\n\n    fileInfo(0, 0) = \"Stock_CC\"\n    fileInfo(0, 1) = \"F:\\370\\Hyperviseur\\SITUATIE\\Macro\\Stock_getdata.xlsm\"\n    fileInfo(0, 2) = \"GetStock\"\n\n    fileInfo(1, 0) = \"Wips_CC\"\n    fileInfo(1, 1) = \"F:\\370\\Hyperviseur\\SITUATIE\\Macro\\Wips_getdata.xlsm\"\n    fileInfo(1, 2) = \"Update\"\n\n    fileInfo(2, 0) = \"CCA_cc\"\n    fileInfo(2, 1) = \"F:\\370\\Hyperviseur\\SITUATIE\\Macro\\SLAcc.xls\"\n    fileInfo(2, 2) = \"Read_CCA\"\n\n    fileInfo(3, 0) = \"Eps_cc\"\n    fileInfo(3, 1) = \"F:\\370\\Hyperviseur\\SITUATIE\\Macro\\eps.xlsm\"\n    fileInfo(3, 2) = \"Update\"\n\n\n    For i = 0 To UBound(fileInfo, 1)\n\n        RunMacroInExcel fileInfo(i, 1), _\n                        fileInfo(i, 2)\n\n        transferSpreadsheetFunction fileInfo(i, 0), fileInfo(i, 1)\n\n    Next i\n\nEnd Sub\n\n\nPrivate Sub RunMacroInExcel(fName As String, macroName As String)\n    Dim XL As Object, wb As Object\n\n    Set XL = CreateObject(\"Excel.Application\")\n    XL.Visible = True\n    Set wb = XL.Workbooks.Open(fName)\n\n    XL.Run macroName\n    wb.Close True\n\n    XL.Quit\n    Set XL = Nothing\nEnd Sub\n\n\nPrivate Sub transferSpreadsheetFunction(ByVal tableName As String, ByVal fileName As String)\n    Dim Msg As String\n    If FileExist(fileName) Then\n        DoCmd.TransferSpreadsheet acImport, , tableName, fileName, True\n    Else\n        Msg = \"Bestand niet gevonden \" &amp; Str(Err.Number) &amp; Err.Source &amp; Err.Description\n        MsgBox Msg\n    End If\nEnd Sub\n\nFunction FileExist(sTestFile As String) As Boolean\n   FileExist = (Len(Dir(sTestFile, vbNormal)) &gt; 0)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 84, "user_id": 4823713, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh5.googleusercontent.com/-lY_lqx8nf8Q/AAAAAAAAAAI/AAAAAAAAEUw/GmchGKzlpqw/photo.jpg?sz=128", "display_name": "Nathalii.", "link": "https://stackoverflow.com/users/4823713/nathalii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 30489201, "answer_count": 1, "score": 0, "last_activity_date": 1594644467, "creation_date": 1432744966, "last_edit_date": 1594644467, "question_id": 30488475, "link": "https://stackoverflow.com/questions/30488475/run-excel-macro-via-vba-in-acces", "title": "Run Excel Macro via VBA in Acces", "body": "<p>I'm new at Access and VBA and I wanted to created an automated process. \nBut I think I'm all over my head with this one. I'm trying to make a macro in Access that:</p>\n\n<ol>\n<li>checks if the file exists</li>\n<li>opens the excel file and runs the macro</li>\n<li>imports the results</li>\n</ol>\n\n<p>I'm trying to get the macro to run the macro in, but it seems a lost cause.\nCan someone assist me?</p>\n\n<pre><code>Private Sub Main_btn_Click()\n\n    Dim fileInfoToBeImported(3, 1)\n\n    fileInfoToBeImported(0, 0) = \"Stock_CC\"\n    fileInfoToBeImported(0, 1) = \"F:\\370\\Hyperviseur\\SITUATIE\\Macro\\Stock_getdata.xlsm\"\n    fileInfoToBeImported(0, 2) = \"GetStock\"\n\n    fileInfoToBeImported(1, 0) = \"Wips_CC\"\n    fileInfoToBeImported(1, 1) = \"F:\\370\\Hyperviseur\\SITUATIE\\Macro\\Wips_getdata.xlsm\"\n    fileInfoToBeImported(1, 2) = \"Update\"\n\n    fileInfoToBeImported(2, 0) = \"CCA_cc\"\n    fileInfoToBeImported(2, 1) = \"F:\\370\\Hyperviseur\\SITUATIE\\Macro\\SLAcc.xls\"\n    fileInfoToBeImported(2, 2) = \"Read_CCA\"\n\n    fileInfoToBeImported(3, 0) = \"Eps_cc\"\n    fileInfoToBeImported(3, 1) = \"F:\\370\\Hyperviseur\\SITUATIE\\Macro\\eps.xlsm\"\n    fileInfoToBeImported(3, 2) = \"Update\"\n\n'-----------------------------------------------------------------------------------------------------------------------------------------\n'LOOP DOOR DE BESTANDEN\n'-----------------------------------------------------------------------------------------------------------------------------------------\n\n    Dim loopIndex As Integer\n    For loopIndex = 0 To UBound(fileInfoToBeImported, 1)\n        RunMacroInExcel fileInfoToBeImported(loopIndex, 0), fileInfoToBeImported(loopIndex, 1), fileInfoToBeImported(loopIndex, 2)\n        transferSpreadsheetFunction fileInfoToBeImported(loopIndex, 0), fileInfoToBeImported(loopIndex, 1)\n    Next loopIndex\nEnd Sub\n\n'-----------------------------------------------------------------------------------------------------------------------------------------\n'LAAT MACRO IN EXCEL LOPEN EN IMPORTEERT GEGEVENS\n'-----------------------------------------------------------------------------------------------------------------------------------------\nPrivate Sub RunMacroInExcel(ByVal Xl As Object)\n\n'Step 1:  Start Excel, then open the target workbook.\n   Set Xl = CreateObject(\"Excel.Application\")\n    Xl.Workbooks.Open (fileInfoToBeImported(loopIndex, 0))\n\n'Step 2:  Make Excel visible\n   Xl.Visible = True\n\n'Step 3:  Run the target macro\n   Xl.Run (fileInfoToBeImported(loopIndex, 2))\n\n'Step 4:  Close and save the workbook, then close Excel\n   Xl.ActiveWorkbook.Close (True)\n    Xl.Quit\n\n'Step 5:  Memory Clean up.\n   Set Xl = Nothing\n\n\nEnd Sub\n\n'-----------------------------------------------------------------------------------------------------------------------------------------\n'IMPORTEERT GEGEVENS\n'-----------------------------------------------------------------------------------------------------------------------------------------\nPrivate Sub transferSpreadsheetFunction(ByVal tableName As String, ByVal fileName As String)\n    If FileExist(fileName) Then\n        DoCmd.TransferSpreadsheet acImport, , tableName, fileName, True\n    Else\n    Dim Msg As String\n        Msg = \"Bestand niet gevonden\" &amp; Str(Err.Number) &amp; Err.Source &amp; Err.Description\n        MsgBox (Msg)\n      End If\nEnd Sub\n\n'-----------------------------------------------------------------------------------------------------------------------------------------\n'IS HET BESTAND AANWEZIG?\n'-----------------------------------------------------------------------------------------------------------------------------------------\n\nFunction FileExist(sTestFile As String) As Boolean\n   Dim lSize As Long\n   On Error Resume Next\n      lSize = -1\n      lSize = FileLen(sTestFile)\n   If lSize &gt; -1 Then\n      FileExist = True\n   Else\n      FileExist = False\n   End If\nEnd Function\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1432746876, "post_id": 30487856, "comment_id": 49056298, "body": "What happens with that code?"}, {"owner": {"reputation": 1, "user_id": 4888401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7f3245289a4e8678ad6f9bc13c9fa0?s=128&d=identicon&r=PG&f=1", "display_name": "tlkfprogrammer", "link": "https://stackoverflow.com/users/4888401/tlkfprogrammer"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1432830052, "post_id": 30487856, "comment_id": 49099386, "body": "I have not tested it yet - still working my way through and trying to understand vba at this point"}, {"owner": {"reputation": 1, "user_id": 4888401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7f3245289a4e8678ad6f9bc13c9fa0?s=128&d=identicon&r=PG&f=1", "display_name": "tlkfprogrammer", "link": "https://stackoverflow.com/users/4888401/tlkfprogrammer"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1432830860, "post_id": 30487856, "comment_id": 49099850, "body": "Just posted a revised question regarding these issues with revised code that  compiles on stepping in"}, {"owner": {"reputation": 1, "user_id": 4888401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7f3245289a4e8678ad6f9bc13c9fa0?s=128&d=identicon&r=PG&f=1", "display_name": "tlkfprogrammer", "link": "https://stackoverflow.com/users/4888401/tlkfprogrammer"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1432833797, "post_id": 30487856, "comment_id": 49101532, "body": "Run time error -424 object required lands on the first If statement in the Do While Not EOF rst.EOF"}, {"owner": {"reputation": 1, "user_id": 4888401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7f3245289a4e8678ad6f9bc13c9fa0?s=128&d=identicon&r=PG&f=1", "display_name": "tlkfprogrammer", "link": "https://stackoverflow.com/users/4888401/tlkfprogrammer"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1432833987, "post_id": 30487856, "comment_id": 49101654, "body": "Run time error -424 object required lands on the first If statement in the Do While Not EOF rst.EOF \u2013 If tmp_peo.prime.nomenclature = tmp_peo.prime_nomenclature = tbl_prime.prime_nomenclature"}, {"owner": {"reputation": 1, "user_id": 4888401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7f3245289a4e8678ad6f9bc13c9fa0?s=128&d=identicon&r=PG&f=1", "display_name": "tlkfprogrammer", "link": "https://stackoverflow.com/users/4888401/tlkfprogrammer"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1432834112, "post_id": 30487856, "comment_id": 49101738, "body": "Looks like I have to define each piece of the record set  and I&#39;m not sure how to go about doing that"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1432835233, "post_id": 30487856, "comment_id": 49102385, "body": "Where you have <code>tmp_peo.prime_nomenclature = tbl_prime.nomenclature</code>, I think your intention is to compare two fields in the current recordset row.  But it doesn&#39;t work like that and Access will complain first about <code>tmp_peo</code> and later about <code>tbl_prime</code>.  I think you need something like this instead ... <code>rst!prime_nomenclature = rst!nomenclature</code>  See the <i>Referencing a Recordset Field</i> section at <a href=\"http://www.utteraccess.com/wiki/index.php/Recordsets_for_Beginners#Referencing_a_Recordset_Field\" rel=\"nofollow noreferrer\">Recordsets for Beginners</a>"}, {"owner": {"reputation": 1, "user_id": 4888401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7f3245289a4e8678ad6f9bc13c9fa0?s=128&d=identicon&r=PG&f=1", "display_name": "tlkfprogrammer", "link": "https://stackoverflow.com/users/4888401/tlkfprogrammer"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1432925336, "post_id": 30487856, "comment_id": 49147458, "body": "If that is the case, I have two tables with 19 fields each and two tables with three fields each.  Does that mean I have to identify parameters for each of these fields and use those parameters in all the code that deals with this multi table record set?"}, {"owner": {"reputation": 1, "user_id": 4888401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7f3245289a4e8678ad6f9bc13c9fa0?s=128&d=identicon&r=PG&f=1", "display_name": "tlkfprogrammer", "link": "https://stackoverflow.com/users/4888401/tlkfprogrammer"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1432925967, "post_id": 30487856, "comment_id": 49147804, "body": "I have taken the time to develop a set of queries to run in a sequential order to produce the required adds/updates I want.  I am trying to avoid the DoCmd.RunSQL because I don&#39;t believe it will allow me to perform transaction rollbacks if errors are encountered. Also, I&#39;m not keen on doing things before they should be done to ensure I capture the correct data.  For example, I have had to add comment records to a table before performing the actual updates that are required."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1432927331, "post_id": 30487856, "comment_id": 49148451, "body": "I don&#39;t see why you should need query parameters in either of those <code>SELECT</code> examples."}, {"owner": {"reputation": 1, "user_id": 4888401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7f3245289a4e8678ad6f9bc13c9fa0?s=128&d=identicon&r=PG&f=1", "display_name": "tlkfprogrammer", "link": "https://stackoverflow.com/users/4888401/tlkfprogrammer"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1433164699, "post_id": 30487856, "comment_id": 49219138, "body": "Actually, I developed the queries at the outset of this project to understand what needed to be accomplished.  Then I started working to develop the VBA to mimic what my queries accomplished.  After reading the Recordset info you referenced, I see now what I need to do - Thank you so very much !!"}, {"owner": {"reputation": 1, "user_id": 4888401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7f3245289a4e8678ad6f9bc13c9fa0?s=128&d=identicon&r=PG&f=1", "display_name": "tlkfprogrammer", "link": "https://stackoverflow.com/users/4888401/tlkfprogrammer"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1433165072, "post_id": 30487856, "comment_id": 49219428, "body": "I am going to attempt this and I will let you know if I can get it to work - thanks again."}, {"owner": {"reputation": 1, "user_id": 4888401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7f3245289a4e8678ad6f9bc13c9fa0?s=128&d=identicon&r=PG&f=1", "display_name": "tlkfprogrammer", "link": "https://stackoverflow.com/users/4888401/tlkfprogrammer"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1433176894, "post_id": 30487856, "comment_id": 49227611, "body": "Help - me again.  I&#39;m not sure I can do that since the tmp_peo table and the tbl_main table each contain fields of the same name.  The tbl_main table also contains fields with the same names as those in the tbl_sub and tbl_prime tables."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1433177153, "post_id": 30487856, "comment_id": 49227760, "body": "That is a pitfall of <code>SELECT *</code>.  Instead of <code>*</code>, you can explicitly list the fields you want and assign different aliases to the duplicate fields: <code>SELECT tmp_peo.fld1 AS peo_fld1,  tbl_main.fld1 AS main_fld1, ...</code> and so forth."}, {"owner": {"reputation": 1, "user_id": 4888401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7f3245289a4e8678ad6f9bc13c9fa0?s=128&d=identicon&r=PG&f=1", "display_name": "tlkfprogrammer", "link": "https://stackoverflow.com/users/4888401/tlkfprogrammer"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1433184543, "post_id": 30487856, "comment_id": 49231770, "body": "Instead of select *,  I changed it to something like this : I did this, but now I get 3296 runtime error -&gt; JOIN expression not supported - sorry to be such a pain, but this has me beating my head against the wall"}, {"owner": {"reputation": 1, "user_id": 4888401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7f3245289a4e8678ad6f9bc13c9fa0?s=128&d=identicon&r=PG&f=1", "display_name": "tlkfprogrammer", "link": "https://stackoverflow.com/users/4888401/tlkfprogrammer"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1433184560, "post_id": 30487856, "comment_id": 49231776, "body": "Select &#39;t_id&#39;, &#39;t_ship&#39;, &#39;t_prime&#39;, &#39;t_primenomen&#39;, &#39;t_sub&#39;,&#39;t_subnomen&#39;, &quot; &amp; _ &quot; &#39;t_qty&#39;, &#39;t_sked_a_mdb&#39;, &#39;t_swbs&#39; ,&#39;t_rdd_to_ptc&#39;, &#39;t_ptc_bedd&#39;, &#39;t_peo_ships_am_rdd&#39;, &quot; &amp; _ &quot; &#39;t_sked_a_date&#39;, &#39;t_sypd&#39;, &#39;t_parm_bedd_date&#39;, &#39;t_yard_actual&#39;, &#39;t_delivered_qty&#39;, &quot; &amp; _ &quot; &#39;t_shipment&#39;,&#39;t_comment&#39;, &quot; &amp; _ &quot; &#39;p_primeid&#39;, &#39;p_prime&#39;, &#39;p_primenomen&#39;, &#39;s_subid&#39;, &#39;s_sub&#39;, &#39;s_subnomen&#39;, &quot; &amp; _ &quot; &#39;m_id&#39;, &#39;m_shipid&#39;,"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1433184813, "post_id": 30487856, "comment_id": 49231930, "body": "Forget about VBA for now.  Just create a query in the query designer.  After  you get a working query there, then you can recreate the same statement with your VBA code."}, {"owner": {"reputation": 1, "user_id": 4888401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7f3245289a4e8678ad6f9bc13c9fa0?s=128&d=identicon&r=PG&f=1", "display_name": "tlkfprogrammer", "link": "https://stackoverflow.com/users/4888401/tlkfprogrammer"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1433255838, "post_id": 30487856, "comment_id": 49266804, "body": "That is where I started this project.  Al my queries work and now I am trying to convert them into VBA.  I am currently attempting your suggestion to define the fields with the &quot;as&quot;"}], "owner": {"reputation": 1, "user_id": 4888401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7f3245289a4e8678ad6f9bc13c9fa0?s=128&d=identicon&r=PG&f=1", "display_name": "tlkfprogrammer", "link": "https://stackoverflow.com/users/4888401/tlkfprogrammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594644471, "creation_date": 1432743149, "last_edit_date": 1594644471, "question_id": 30487856, "link": "https://stackoverflow.com/questions/30487856/access-2010-vba-recordset-updates", "title": "access 2010 vba recordset updates", "body": "<p>New to Access VBA with extensive Informix SQL background.  I have a recordset that includes record from 4 tables. </p>\n\n<p>Based upon different situations, I want to update records in three of these tables with data from the fourth table.                    </p>\n\n<p>I also want to add records to a comment table and output to reports. Can and how do I do this: Code follows:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub query_records_sql()\n\n'Comments: Use the results of a SQL string and to update and add records as required\n\nDim dbs As DAO.Database\nDim rst As DAO.Recordset\nDim strSql As String\n\n' Open pointer to current database\nSet dbs = CurrentDb()\n\nstrSql = \"\"\n\n'Create record set for tmp_peo records that have matches in main/prime/sub tables\nstrSql = \" Select * FROM ((tmp_peo INNER JOIN tbl_prime ON (tmp_peo.prime = tbl_prime.prime)) \" &amp; _\n\" INNER JOIN tbl_sub ON (tmp_peo.sub = tbl_sub.sub)) \" &amp; _\n\" INNER JOIN tbl_main ON (tmp_peo.ship = tbl_main.ship_id) AND \" &amp; _\n\" (tbl_prime.prime_id = tbl_main.prime_id) AND (tbl_sub.sub_id = tbl_main.sub_id)\"\n\n' Create recordset based on SQL\nSet rst = dbs.OpenRecordset(strSql)\n\nDo While Not rst.EOF\n  If (tmp_peo.prime_nomenclature = tbl_prime.nomenclature) Then\n   If (tmp_peo.sub_nomenclature = tbl_sub_nomenclature) Then\n    If (((tmp_peo.quantity = tbl_main.quantity) Or (tmp_peo.quantity Is Null And tbl_main.quantity Is Null)) And\n     ((tmp_peo.sked_a_mdb = tbl_main.sked_a_mbd) Or (tmp_peo.sked_a_mdb Is Null And tbl_main.sked_a_mdb Is Null)) And\n     ((tmp_peo.swbs = tbl_main.swbs) Or (tmp_peo.swbs Is Null And tbl_main.swbs Is Null)) And\n     ((tmp_peo.rdd_to_ptc = tbl_main.rdd_to_ptc) Or (tmp_peo.rdd_to_ptc Is Null And tbl_main.rdd_to_ptc Is Null)) And\n     ((tmp_peo.ptc_bedd = tbl_main.ptc_bedd) Or (tmp_peo.ptc_bedd Is Null And tbl_main.ptc_bedd Is Null)) And\n     ((tmp_peo.peo_ships_am_rdd = tbl_main.peo_ships_am_rdd) Or (tbl_peo.peo_ships_am_rdd Is Null And tbl_main.peo_ships_am_rdd Is Null)) And\n     ((tmp_peo.sked_a_date = tbl_main.sked_a_date) Or (tbl_peo.sked_a_date Is Null And tbl_main.sked_a_date Is Null)) And\n     ((tmp_peo.sypd = tbl_main.sypd) Or (tmp_peo.sypd Is Null And tbl_main.sypd Is Null)) And\n     ((tmp_peo.parm_bedd_date = tbl_main.parm_bedd_date) Or (tmp_peo.par_bedd_date Is Null And tbl_main.parm_bedd_date Is Null)) And\n     ((tmp_peo.yard_actual = tbl_main.yard_actual) Or (tmp_peo.yard_actual Is Null And tbl_main.yard.actual Is Null)) And\n     ((tmp_peo.delivered_quantity = tbl_main.delivered_quantity) Or (tmp_peo.delivered_quantity Is Null And tbl_main.delivered_quantity Is Null)) And\n     ((tmp_peo.shipment = tbl_main.shipment) Or (tmp_peo.shipment Is Null And tbl_main.shipment Is Null))) Then\n     ' Output to 'No Update Required' Report\n    Else\n     ' Update main with tmp_peo data\n     Call update_main\n     Call add_main_comment(tbl_main.main_id, \"PRG\", =DATE(), \"MAIN RECORD UPDATED DURING WEEKLY PEO SKED A UPDATE PROCESS\")\n     'Output to 'Main Record Updated' Report\n    End If\n   Else\n     'Update sub nomen with tmp_peo.sub_nomen\n     Call update_sub\n     Call add_main_comment(tbl_main.main_id, \"PRG\", =DATE(), \"SUB RECORD UPDATED DURING WEEKLY PEO SKED A UPDATE PROCESS\")\n     'Output to 'Sub Record Updated' report\n   End If\n  Else\n      'Update prime nomen with tmp_peo.prime_nomen\n      Call update_prime\n      Call add_main_comment(tbl_main.main_id, \"PRG\", =DATE(), \"PRIME RECORD UPDATED DURING WEEKLY PEO SKED A UPDATE PROCESS\")\n      'Output to \"Prime Record Updated' report\n  End If\n\n  rst.MoveNext\nLoop\n\n'Close recordset\nrst.Close\n\n'Close Reports\n\n'Open action required report\n\nstrSql = \"\"\n\n'Create record set for tmp_peo records that have no matches in main/prime/sub tables\n  strSql = \" Select tmp_peo.* WHERE tmp_peo.id Not In \" &amp; _\n\" (Select * FROM ((tmp_peo INNER JOIN tbl_prime ON (tmp_peo.prime = tbl_prime.prime)) \" &amp; _\n\" INNER JOIN tbl_sub ON (tmp_peo.sub = tbl_sub.sub)) \" &amp; _\n\" INNER JOIN tbl_main ON (tmp_peo.ship = tbl_main.ship_id) AND \" &amp; _\n\" (tbl_prime.prime_id = tbl_main.prime_id) AND (tbl_sub.sub_id = tbl_main.sub_id)\"\n\n\ndbs.Close\n\nEnd Sub    \n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 4925271, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ffb52cd419559357c96bf911b506b226?s=128&d=identicon&r=PG&f=1", "display_name": "Nathaniel Bendinsky", "link": "https://stackoverflow.com/users/4925271/nathaniel-bendinsky"}, "edited": false, "score": 0, "creation_date": 1432745397, "post_id": 30488504, "comment_id": 49055380, "body": "I really should have caught that, given that my comments indicate I had a similar issue when implementing LatToDecimal... thanks for speaking to the blind man."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 143, "user_id": 4925271, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ffb52cd419559357c96bf911b506b226?s=128&d=identicon&r=PG&f=1", "display_name": "Nathaniel Bendinsky", "link": "https://stackoverflow.com/users/4925271/nathaniel-bendinsky"}, "edited": false, "score": 0, "creation_date": 1432745788, "post_id": 30488504, "comment_id": 49055628, "body": "Yes, unfortunately the query&#39;s <i>#Error</i> response is not real useful.  You can get better information by exploring the query issue in the Immediate window ... <code>? doubLat(Null)</code> would give you a clear picture of the real problem."}, {"owner": {"reputation": 143, "user_id": 4925271, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ffb52cd419559357c96bf911b506b226?s=128&d=identicon&r=PG&f=1", "display_name": "Nathaniel Bendinsky", "link": "https://stackoverflow.com/users/4925271/nathaniel-bendinsky"}, "edited": false, "score": 0, "creation_date": 1432746097, "post_id": 30488504, "comment_id": 49055833, "body": "The Immediate window comes up blank, I&#39;m afraid! Even when the error occurred, the query still completed without hanging in the middle of a function. (As you said, it wasn&#39;t run at all.)"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 143, "user_id": 4925271, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ffb52cd419559357c96bf911b506b226?s=128&d=identicon&r=PG&f=1", "display_name": "Nathaniel Bendinsky", "link": "https://stackoverflow.com/users/4925271/nathaniel-bendinsky"}, "edited": false, "score": 1, "creation_date": 1432746257, "post_id": 30488504, "comment_id": 49055947, "body": "Not sure we&#39;re on the same page, Nathaniel.  I meant paste <code>? doubLat(Null)</code> into a new line in the Immediate window and press <code>Enter</code>.  Access should respond with error #94, <i>&quot;Invalid use of Null&quot;</i>.  Isn&#39;t that what you see?"}, {"owner": {"reputation": 143, "user_id": 4925271, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ffb52cd419559357c96bf911b506b226?s=128&d=identicon&r=PG&f=1", "display_name": "Nathaniel Bendinsky", "link": "https://stackoverflow.com/users/4925271/nathaniel-bendinsky"}, "edited": false, "score": 0, "creation_date": 1432746704, "post_id": 30488504, "comment_id": 49056193, "body": "I have thoroughly misunderstood what the Immediate window is meant to do; I&#39;m used to working in Java, so I assumed it was a debug tool that shows the status of all open variables while the code is suspended. I believe I understand now, though."}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 1, "last_activity_date": 1432745050, "creation_date": 1432745050, "answer_id": 30488504, "question_id": 30487632, "link": "https://stackoverflow.com/questions/30487632/access-vba-non-error-values-displaying-as-error/30488504#30488504", "title": "Access-VBA Non-Error Values Displaying as #Error", "body": "<blockquote>\n  <p>what causes the code below to return #Error when the input is null?</p>\n</blockquote>\n\n<p>Your query uses your <em>doubLat()</em> function:</p>\n\n<pre><code>Function doubLat(ByVal latIn As String) As Double\n</code></pre>\n\n<p>If you called that function with Null in an Immediate window session, Access would throw error #94, <em>\"Invalid use of Null\"</em>.  The error handling you included within the function does not come into play because the function does not even run.  (By the way, checking <code>IsNull(latIn)</code> is pointless because you declared <em>latIn</em> <code>As String</code> ... and that means <em>latIn</em> can never be Null.)  </p>\n\n<p>When you use that function as a query field expression and give it Null, Access just displays <em>#Error</em> in the query result set.</p>\n\n<p>Avoid that problem by substituting something else (an empty string?) for Null when you call the function ...</p>\n\n\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT doubLat(IIf(YourField Is Null, '', YourField))\n</code></pre>\n\n<p>Or you could use the VBA <code>Nz()</code> function ...</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT doubLat(Nz(YourField, ''))\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 4925271, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ffb52cd419559357c96bf911b506b226?s=128&d=identicon&r=PG&f=1", "display_name": "Nathaniel Bendinsky", "link": "https://stackoverflow.com/users/4925271/nathaniel-bendinsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 513, "favorite_count": 0, "accepted_answer_id": 30488504, "answer_count": 1, "score": 1, "last_activity_date": 1432745070, "creation_date": 1432742541, "last_edit_date": 1432745070, "question_id": 30487632, "link": "https://stackoverflow.com/questions/30487632/access-vba-non-error-values-displaying-as-error", "title": "Access-VBA Non-Error Values Displaying as #Error", "body": "<p>I am attempting to handle errors caused by blank fields in an Access database. I have a function that takes the <code>Latitude</code> field's value, parses it to another format (from DMS to decimal), and is used in a query as a new field. As long as <code>Latitude</code> contains a valid DMS value, this works as expected. However, if it does not, the new field (<code>decLat</code>) will contain <code>#Error</code>.</p>\n\n<p>From my readings, this is typically caused by the value passed in being an Error itself. However, testing with IsError(doubLat) in the function itself shows that none of the outputs are Error.</p>\n\n<p>My next attempt was to check whether the output was 0 (because the conversion function is meant to return that in event of an error), but that doesn't seem to be the issue either. So the question is, what causes the code below to return <code>#Error</code> when the input is null?</p>\n\n<pre><code>Function LatToDecimal(latIn As Variant) As String 'latIn is Variant as attempt at error handling. Will always be String or Null.\n    On Error GoTo ErrHandler\n    If (latIn = \"\") Then\n        GoTo ErrHandler\n    ElseIf (IsNull(latIn)) Then GoTo ErrHandler\n    End If\nRestart:\n    Dim SplitA() As String\n    SplitA() = Split(latIn, \"\u00b0\") 'A(0) is DEG.\n    Dim SplitB() As String\n    If (UBound(SplitA) &gt; 0) Then\n        SplitB() = Split(SplitA(1), \"'\") 'B(0) is MIN.\n    Else:\n        LatToDecimal = \"0\"\n        Exit Function\n    End If\n    Dim SplitC() As String\n    If (UBound(SplitB) &gt; 0) Then\n        SplitC() = Split(SplitB(1), \"\"\"\") 'C(0) is SEC. C(1) is N/S.\n    Else:\n        LatToDecimal = \"0\"\n        Exit Function\n    End If\n    Dim deg As Double\n    Dim min As Double\n    Dim sec As Double\n\n    deg = CDbl(SplitA(0)) 'Assign more readable names.\n    min = CDbl(SplitB(0))\n    sec = CDbl(SplitC(0))\n\n    Dim minM As Double 'Transitional value.\n    Dim decDeg As Double 'decimal degrees\n\n    'Conversion to decimal\n    minM = min + (sec / 60)\n    decDeg = deg + (minM / 60)\n    If (SplitC(1) = \"S\") Then decDec = decDeg * -1\n\n    'Return value\n    LatToDecimal = decDeg\n    GoTo Finished\n\nErrHandler:\n    latIn = \"0\u00b00'0\"\"\"\n    MsgBox (\"Error!\")\n    GoTo Restart\nFinished:\nEnd Function\n\n'Wrapper to convert decimal latitude (from LatToDecimal) into Double values. Still need one for longitude.\nFunction doubLat(ByVal latIn As String) As Double\n    Dim newLat As Double\n    newLat = CDbl(LatToDecimal(latIn))\n    doubLat = newLat\n    If (doubLat = 0) Then doubLat = 0#\nEnd Function\n</code></pre>\n\n<p>The function <code>doubLat</code> is the one called by my query.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 417, "user_id": 4897271, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AMOHJ.jpg?s=128&g=1", "display_name": "jjjjjjjjjjj", "link": "https://stackoverflow.com/users/4897271/jjjjjjjjjjj"}, "edited": false, "score": 0, "creation_date": 1432743735, "post_id": 30487681, "comment_id": 49054359, "body": "I tried the code, and now it doesn&#39;t move it to the bottom of the existing data anymore, instead it copies it into the first row. I reverted the changes, restarted Excel, and it still doesn&#39;t work. Any ideas why this might be the case?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 417, "user_id": 4897271, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AMOHJ.jpg?s=128&g=1", "display_name": "jjjjjjjjjjj", "link": "https://stackoverflow.com/users/4897271/jjjjjjjjjjj"}, "edited": false, "score": 0, "creation_date": 1432743840, "post_id": 30487681, "comment_id": 49054416, "body": "If you went back to your original code and it still doesn&#39;t work then I have no idea why: you only posted a single line of code so there&#39;s not much to go on there."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 417, "user_id": 4897271, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AMOHJ.jpg?s=128&g=1", "display_name": "jjjjjjjjjjj", "link": "https://stackoverflow.com/users/4897271/jjjjjjjjjjj"}, "edited": false, "score": 0, "creation_date": 1432744169, "post_id": 30487681, "comment_id": 49054648, "body": "Try the second version above."}, {"owner": {"reputation": 417, "user_id": 4897271, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AMOHJ.jpg?s=128&g=1", "display_name": "jjjjjjjjjjj", "link": "https://stackoverflow.com/users/4897271/jjjjjjjjjjj"}, "edited": false, "score": 0, "creation_date": 1432744555, "post_id": 30487681, "comment_id": 49054873, "body": "It works, thanks! I have an additional question, what exactly is the effect of changing xlDown to xlUp? Does the first one go from the first to the last row, and the second one go from the last row to the first row?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 417, "user_id": 4897271, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AMOHJ.jpg?s=128&g=1", "display_name": "jjjjjjjjjjj", "link": "https://stackoverflow.com/users/4897271/jjjjjjjjjjj"}, "edited": false, "score": 0, "creation_date": 1432745909, "post_id": 30487681, "comment_id": 49055701, "body": "Yes, it&#39;s just as it appears. <code>End(xlUp)</code> has the same effect as selecting a cell then clicking <code>Ctrl+UpArrow</code>  and   <code>xlDown</code> is similar but in the other direction"}, {"owner": {"reputation": 417, "user_id": 4897271, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AMOHJ.jpg?s=128&g=1", "display_name": "jjjjjjjjjjj", "link": "https://stackoverflow.com/users/4897271/jjjjjjjjjjj"}, "edited": false, "score": 0, "creation_date": 1432746621, "post_id": 30487681, "comment_id": 49056149, "body": "And is the fact that Rows.Count is a default variable what makes it more robust than the first option?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 417, "user_id": 4897271, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AMOHJ.jpg?s=128&g=1", "display_name": "jjjjjjjjjjj", "link": "https://stackoverflow.com/users/4897271/jjjjjjjjjjj"}, "edited": false, "score": 0, "creation_date": 1432747380, "post_id": 30487681, "comment_id": 49056615, "body": "Not really - going up is typically better because it&#39;s less susceptible to problems if (for example) there&#39;s no data existing on your sheet (or only one row of data) where using <code>xlDown</code> will take you to the bottom if the sheet."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1432744148, "last_edit_date": 1432744148, "creation_date": 1432742674, "answer_id": 30487681, "question_id": 30487628, "link": "https://stackoverflow.com/questions/30487628/offset-destination-row-downward-with-vba/30487681#30487681", "title": "Offset destination row downward with VBA", "body": "<pre><code>Sheets(\"Current\").Range(\"A3:D\").Copy _\n    Destination:=Sheets(\"Archive\").Cells(1).End(xlDown).Offset(1, 0)\n</code></pre>\n\n<p>More robust:</p>\n\n<pre><code>Sheets(\"Current\").Range(\"A3:D\").Copy _\n    Destination:=Sheets(\"Archive\").Cells(Rows.Count, 1).End(xlUp).Offset(2, 0)\n</code></pre>\n"}], "owner": {"reputation": 417, "user_id": 4897271, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AMOHJ.jpg?s=128&g=1", "display_name": "jjjjjjjjjjj", "link": "https://stackoverflow.com/users/4897271/jjjjjjjjjjj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1896, "favorite_count": 0, "accepted_answer_id": 30487681, "answer_count": 1, "score": 0, "last_activity_date": 1432761601, "creation_date": 1432742536, "last_edit_date": 1432761601, "question_id": 30487628, "link": "https://stackoverflow.com/questions/30487628/offset-destination-row-downward-with-vba", "title": "Offset destination row downward with VBA", "body": "<p>I have a VBA code to copy some data to another sheet.</p>\n\n<pre><code>Sheets(\"Current\").Range(\"A3:D\").Copy Destination:=Sheets(\"Archive\").Cells(1).End(xlDown)\n</code></pre>\n\n<p>When pasting, the code appends the data to the first empty row after all the existing entries. I'd like to offset the paste destination down one row further, what is the best way to do this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 2, "creation_date": 1432743927, "post_id": 30487368, "comment_id": 49054488, "body": "You will probably next to reserve the loop to go from the last cell for first cell. Otherwise it&#39;ll skip rows that get deleted."}, {"owner": {"reputation": 598, "user_id": 2683003, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/qV32s.jpg?s=128&g=1", "display_name": "ChicagoMike", "link": "https://stackoverflow.com/users/2683003/chicagomike"}, "reply_to_user": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1432748972, "post_id": 30487368, "comment_id": 49057494, "body": "You shouldn&#39;t use a For ... Each loop in order to remove elements within the collection, as you&#39;re modifying the number of elements in that collection within the loop.  It would be better to use a For I = 1000 To 1 Step -1 loop as @Gareth mentioned."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "reply_to_user": {"reputation": 598, "user_id": 2683003, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/qV32s.jpg?s=128&g=1", "display_name": "ChicagoMike", "link": "https://stackoverflow.com/users/2683003/chicagomike"}, "edited": false, "score": 0, "creation_date": 1432756517, "post_id": 30487368, "comment_id": 49061784, "body": "@ChicagoMike, you can use the <code>For Each</code>, you just cannot <code>Delete</code> inside it without expecting odd behavior (e.g. skipped rows).  See the <code>Union-Delete</code> example below."}], "answers": [{"comments": [{"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1432762364, "post_id": 30491869, "comment_id": 49064771, "body": "Great detailed answer!"}, {"owner": {"reputation": 21, "user_id": 4941211, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh5.googleusercontent.com/-nKdUOYxIOlI/AAAAAAAAAAI/AAAAAAAAATs/0IzqH0sh0rw/photo.jpg?sz=128", "display_name": "HudsonWY", "link": "https://stackoverflow.com/users/4941211/hudsonwy"}, "edited": false, "score": 0, "creation_date": 1432797153, "post_id": 30491869, "comment_id": 49075584, "body": "Very good answer, Thankyou very much!  The only problem I get is when running it i get this error: - Additional information: Conversion from type &#39;Range&#39; to type &#39;String&#39; is not valid On this line of code: - If InStr(rng_delete.Cells(i), &quot;APO&quot;) &gt; 0 Then"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1432822978, "post_id": 30491869, "comment_id": 49094107, "body": "Might mean your range is more than a single column.  Use <code>.Cells(i,1)</code> in that case instead of <code>.Cells(i)</code>."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1432825735, "post_id": 30491869, "comment_id": 49096353, "body": "As the rng_delete Union is more common than a non-union it will speed the code up if you change the order of the IF test."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "reply_to_user": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1432826440, "post_id": 30491869, "comment_id": 49096824, "body": "@brettdj, Flip the <code>If-Else</code> with a <code>Not</code> or put the inner <code>If</code> (<code>...Is Nothing...</code>) on the outside?  I don&#39;t want to <code>Set rng_delete</code> until I know there is a match so I don&#39;t think the latter change is viable."}], "tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": false, "score": 3, "last_activity_date": 1432762674, "last_edit_date": 1432762674, "creation_date": 1432756136, "answer_id": 30491869, "question_id": 30487368, "link": "https://stackoverflow.com/questions/30487368/vb-excel-deleting-rows-on-a-specified-value-being-in-a-cell/30491869#30491869", "title": "VB Excel Deleting Rows On A Specified Value Being In a Cell", "body": "<p>Here are two common patterns for deleting entire rows based on a condition.  The main idea is that you <strong>cannot delete from a collection while you iterate it</strong>.  This means that <code>Delete</code> should not appear in a <code>For Each</code>  This is fairly standard across most programming languages and some even throw an error to prevent it.</p>\n\n<p><strong>Option 1</strong>, use an integer to track the rows and have it work from the end to the beginning.  You need to go backwards because it is the easy way to avoid skipping rows.  It is possible to go forwards, you just need to account for not incrementing when you delete.</p>\n\n<pre><code>Sub DeleteRowsWithIntegerLoop()\n\n    Dim rng_delete As Range\n    Set rng_delete = Range(\"A1:A1000\")\n\n    Dim int_start As Integer\n    int_start = rng_delete.Rows.Count\n\n    Dim i As Integer\n    For i = int_start To 1 Step -1\n        If InStr(rng_delete.Cells(i), \"VALUE\") &gt; 0 Then\n            rng_delete.Cells(i).EntireRow.Delete\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p><strong>Option 2</strong>, use the <code>Union-Delete</code> pattern to build a range of cells and then delete them all in one step at the end.</p>\n\n<pre><code>Sub DeleteRowsWithUnionDelete()\n\n\n    Dim rng_cell As Range\n    Dim rng_delete As Range\n\n    For Each rng_cell In Range(\"A1:A1000\")\n        If InStr(rng_cell, \"VALUE\") &gt; 0 Then\n            If rng_delete Is Nothing Then\n                Set rng_delete = rng_cell\n            Else\n                Set rng_delete = Union(rng_delete, rng_cell)\n            End If\n        End If\n    Next\n\n    rng_delete.EntireRow.Delete\n\nEnd Sub\n</code></pre>\n\n<p><strong>Notes on the code</strong></p>\n\n<p>For Option 2, there is an extra conditional there to create <code>rng_delete</code> when it starts at the first item.  <code>Union</code> does not work with a <code>Nothing</code> reference, so we first check that and if so, <code>Set</code> to the first item.  All others come through and get <code>Set</code> by the <code>Union</code> line.</p>\n\n<p><strong>Preference</strong></p>\n\n<p>When choosing between the two, I always prefer Option 2 because I much prefer to work with <code>Ranges</code> in Excel instead of iterating through <code>Cells</code> with a counter.  There are limitations to this.  The second option also works for discontinuous <code>Ranges</code> and all other variety of weird <code>Ranges</code> (e.g. after a call to <code>SpecialCells</code>) which can make it valuable when you are not sure what data you will be dealing with.</p>\n\n<p><strong>Speed</strong></p>\n\n<p>I am not sure about a speed comparison.  Both can be slow if <code>ScreenUpdating</code> and calculations are enabled.  The first option makes <code>N-1</code> calls to <code>Delete</code> whereas the second option does a single one.  <code>Delete</code> is an expensive operation.  Option 2 does however make <code>N-1</code> calls to <code>Union</code> and <code>Set</code>.  I assume it's faster than the first one based on that (and it seems to be here), but I did not profile it.</p>\n\n<p>Final note: <code>InStr</code> returns an integer indicating where the value was found.  I always like to make the boolean covnersion explicit here and compare to <code>&gt;0</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1432824289, "post_id": 30498850, "comment_id": 49095180, "body": "So far as I can tell, <code>AutoFilter</code> ignores the size of the range that it is being applied to.  That is, calling <code>[A1:A20].AutoFilter</code> with data in rows 21:40 also will extend the <code>AutoFilter</code> to all 40 rows.  This is fine except in the case where the filter returns no results.  The deletion will then be done on the original range <code>[A1:A20].EntireRow</code> (really <code>A2:A21</code>) which is entirely hidden so it will all get deleted.  Normally the <code>AutoFilter-Delete</code> works because Excel will only delete visible rows when applied to a filtered range.  If all go hidden, then it doesn&#39;t work and deletes all."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1432825090, "post_id": 30498850, "comment_id": 49095833, "body": "@byron - no the range doesnt extend."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1432825199, "post_id": 30498850, "comment_id": 49095920, "body": "If you put data in <code>A1:A40</code>, and apply the AutoFilter to <code>A1:A20</code>, do you get filtered rows all the way to row 20 or row 40?"}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1432825257, "post_id": 30498850, "comment_id": 49095954, "body": "Row 20. But you make a good point re deleting all rows if there are no matches - will address"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1432825414, "post_id": 30498850, "comment_id": 49096101, "body": "Very odd.  With a column of <code>1</code>s (so that no rows match <code>*VALUE*</code>) from A1:A40, if I run your code with range A1:A20, and stop it after the <code>AutoFilter</code> is applied (don&#39;t delete), rows 2:40 are hidden.  Excel 2013."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1432825514, "post_id": 30498850, "comment_id": 49096172, "body": "Yes, but rng1 only applies to A1:A20 - not A1:A40"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1432825885, "post_id": 30498850, "comment_id": 49096452, "body": "Ahhh. Ok.  I just meant that the <i>AutoFilter</i> extends not the underlying defined <code>Range</code>.  Sorry for the confusion.  I was really trying to test if <code>.Offset(1)</code> would delete one row of extra data if it was there.  Instead I saw that it deleted everything if no rows matched!  Your edit fixes the problem and the real thing I was testing with <code>Resize</code>.  Good stuff."}], "tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 1, "last_activity_date": 1432825382, "last_edit_date": 1432825382, "creation_date": 1432794768, "answer_id": 30498850, "question_id": 30487368, "link": "https://stackoverflow.com/questions/30487368/vb-excel-deleting-rows-on-a-specified-value-being-in-a-cell/30498850#30498850", "title": "VB Excel Deleting Rows On A Specified Value Being In a Cell", "body": "<p>Dont use loops, use a method such as <code>AutoFilter</code></p>\n\n<pre><code>Sub Recut()\nDim ws As Worksheet\nDim rng1 As Range\n\nSet ws = ActiveSheet\nSet rng1 = ws.[A1:A100]\n\nws.AutoFilterMode = False\n\nApplication.ScreenUpdating = False\nWith rng1\n      .AutoFilter Field:=1, Criteria1:=\"*VALUE*\"\n      `assuming A1 is a header, and checking for at least 1 match on the filtered string\n       If .SpecialCells(xlCellTypeVisible).Cells.Count &gt; 1 Then .Offset(1, 0).Resize(rng1.Rows.Count - 1, 1).EntireRow.Delete\nEnd With\nws.AutoFilterMode = False\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4941211, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh5.googleusercontent.com/-nKdUOYxIOlI/AAAAAAAAAAI/AAAAAAAAATs/0IzqH0sh0rw/photo.jpg?sz=128", "display_name": "HudsonWY", "link": "https://stackoverflow.com/users/4941211/hudsonwy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 642, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1432825382, "creation_date": 1432741874, "last_edit_date": 1531161705, "question_id": 30487368, "link": "https://stackoverflow.com/questions/30487368/vb-excel-deleting-rows-on-a-specified-value-being-in-a-cell", "title": "VB Excel Deleting Rows On A Specified Value Being In a Cell", "body": "<pre><code>    For Each c In oSheet.Range(\"A1:A1000\")\n        If InStr(c.Value, \"VALUE\") Then\n            c.EntireRow.Delete()\n        End If\n    Next\n</code></pre>\n\n<p>This will only delete a few of the rows within the specified range, what could the problem be?</p>\n"}, {"tags": ["vba", "excel", "outlook"], "comments": [{"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1432742311, "post_id": 30487367, "comment_id": 49053433, "body": "Simple Solution create a hidden sheet, where you input the dates, then on workbook activate you can look through the range of dates and if it satisfies, you can send email."}, {"owner": {"reputation": 735, "user_id": 4619569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEDZ7.jpg?s=128&g=1", "display_name": "nicolaus-hee", "link": "https://stackoverflow.com/users/4619569/nicolaus-hee"}, "reply_to_user": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1432742511, "post_id": 30487367, "comment_id": 49053566, "body": "Please clarify how you want to use this in practice. If it&#39;s ok for you to open the excel sheet every day and it&#39;s ok to send the messages at the time of opening it, @PaulFrancis approach will work."}, {"owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "reply_to_user": {"reputation": 735, "user_id": 4619569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEDZ7.jpg?s=128&g=1", "display_name": "nicolaus-hee", "link": "https://stackoverflow.com/users/4619569/nicolaus-hee"}, "edited": false, "score": 0, "creation_date": 1432742804, "post_id": 30487367, "comment_id": 49053772, "body": "@nhee in practice , the user will input the dates they want the email to be sent. The ideal will be for this macro to run  when workbook closed or open."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1432743728, "post_id": 30487367, "comment_id": 49054354, "body": "I would suggest using the <code>Open</code> event instead of <code>Activate</code>, just to reduce the number of times the code will fire, but otherwise, go with the @PaulFrancis approach. Have the user set the dates on a sheet (hidden or not). Your code would loop through all dates, if it finds one that equals today&#39;s date, fire <code>SetRecipients()</code>, delete that date from the list (or move it to a <code>Sent</code> sheet, if you want to keep track of what was done). If you want to get fancy, use the Win Task Scheduler to automatically open the spreadsheet each day, then your code can close Excel when it&#39;s done running."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1432743802, "post_id": 30487367, "comment_id": 49054393, "body": "I would also suggest renaming <code>SetRecipients()</code> since it does so much more than just setting the recipients."}, {"owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "edited": false, "score": 0, "creation_date": 1432827080, "post_id": 30487367, "comment_id": 49097317, "body": "I will try the above"}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1432745862, "creation_date": 1432745862, "answer_id": 30488771, "question_id": 30487367, "link": "https://stackoverflow.com/questions/30487367/sending-email-with-outlook-at-a-particular-date-using-vba-excel/30488771#30488771", "title": "Sending email with outlook at a particular date, using VBA excel", "body": "<p>It looks like you are interested in the <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook._mailitem.deferreddeliverytime.aspx\" rel=\"nofollow\">DeferredDeliveryTime</a> property of Outlook items (MailItem). It allows to set a DateTime indicating the date and time the mail message is to be delivered.</p>\n\n<p>You may find the <a href=\"https://support.microsoft.com/en-us/kb/201096?wa=wsignin1.0\" rel=\"nofollow\">How to automate Outlook from another program</a> article helpful. </p>\n"}], "owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2583, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1432745862, "creation_date": 1432741869, "question_id": 30487367, "link": "https://stackoverflow.com/questions/30487367/sending-email-with-outlook-at-a-particular-date-using-vba-excel", "title": "Sending email with outlook at a particular date, using VBA excel", "body": "<p>I am working a macro of <strong>sending outlook emails</strong> using excel VBA.  i have got the first step of sending an email out to different recipients. My code:</p>\n\n<pre><code>Sub SetRecipients()\nDim aOutlook As Object\nDim aEmail As Object\nDim rngeAddresses As Range, rngeCell As Range, strRecipients As String\n\nSet aOutlook = CreateObject(\"Outlook.Application\")\nSet aEmail = aOutlook.CreateItem(0)\n\nSet rngeAddresses = ActiveSheet.Range(\"A3:A13\")\nFor Each rngeCell In rngeAddresses.Cells\nstrRecipients = strRecipients &amp; \";\" &amp; rngeCell.Value\nNext\n\naEmail.Importance = 2\n\naEmail.Subject = \"Indicator activity warning ( TestMailSend )\"\n\naEmail.Body = \"Hi\"\n\n'aEmail.ATTACHMENTS.Add ActiveWorkbook.Book2.xlsx\n\naEmail.To = strRecipients\n\naEmail.Send\n\nEnd Sub\n</code></pre>\n\n<p><strong>My objective:</strong> is to be able to set a number of <strong>different dates</strong> that this email will be sent automatically. </p>\n\n<p><strong>The Problem:</strong> i am not sure how this can work </p>\n"}, {"tags": ["vba", "email", "outlook"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1432741561, "post_id": 30487198, "comment_id": 49052894, "body": "FYI you can do this with a basic <i>Rules &amp; Alerts</i> rule"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1432744912, "post_id": 30487198, "comment_id": 49055069, "body": "Why do you need to use a VBA macro? Outlook allows to get the job done manually."}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1432743186, "creation_date": 1432743186, "answer_id": 30487864, "question_id": 30487198, "link": "https://stackoverflow.com/questions/30487198/forward-email-based-on-subject-line/30487864#30487864", "title": "Forward email based on subject line", "body": "<p>You can do this using a Run a Script rule</p>\n\n<pre><code>Sub ChangeSubjectForward(Item As Outlook.MailItem)\n    Item.Subject = \"Test\"\n Item.Save\n\nSet olForward = Item.Forward\nolForward.Recipients.Add \"Jasonfish11@domain.com\"\n\nolForward.Send\n\nEnd Sub\n</code></pre>\n\n<p>If a vba you can run on all messages in a folder at any time.</p>\n\n<p>Paste into ThisOutlookSession and run</p>\n\n<pre><code>Sub ChangeSubjectThenSend()\nDim olApp As Outlook.Application\nDim aItem As Object\n\nSet olApp = CreateObject(\"Outlook.Application\")\nSet mail = olApp.ActiveExplorer.CurrentFolder\n\nFor Each aItem In mail.Items\n      aItem.Subject = \"New Subject\"\n    aItem.Save\n\n    Set olForward = aItem.Forward\n    olForward.Recipients.Add \"Jasonfish11@domain.com\"\n    olForward.Send\n\nNext aItem\nEnd Sub\n</code></pre>\n\n<p><a href=\"http://forums.slipstick.com/threads/87770-creating-a-rule-that-both-forwards-the-original-attachment-and-uses-a-template/\" rel=\"nofollow\">source Link</a></p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 4945487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe210ec915f668ebf8744235c0bc547?s=128&d=identicon&r=PG&f=1", "display_name": "Jasonfish11", "link": "https://stackoverflow.com/users/4945487/jasonfish11"}, "edited": false, "score": 0, "creation_date": 1432749621, "post_id": 30488615, "comment_id": 49057852, "body": "Sorry I pasted one of my older iterations of the code (guess I didn&#39;t hit save).  I did have it changed to msg.forward and mymail.send  I&#39;ve given the Instr a try and I am still not able to get it to work.  How do I know what folder is the &quot;default&quot; inbox that I have it searching?  Is it possible that what I consider the default inbox really isn&#39;t?    Sorry I am just stepping into Outlook macros coming from the excel world so a lot of the outlook applications are new to me."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 1, "user_id": 4945487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe210ec915f668ebf8744235c0bc547?s=128&d=identicon&r=PG&f=1", "display_name": "Jasonfish11", "link": "https://stackoverflow.com/users/4945487/jasonfish11"}, "edited": false, "score": 0, "creation_date": 1432753751, "post_id": 30488615, "comment_id": 49060150, "body": "I&#39;d suggest starting from the <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736%28v=office.14%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Getting Started with VBA in Outlook 2010</a> article in MSDN. Try to add <code>Debug.Print</code> statements to the code to see what happens under the hood."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1432745344, "creation_date": 1432745344, "answer_id": 30488615, "question_id": 30487198, "link": "https://stackoverflow.com/questions/30487198/forward-email-based-on-subject-line/30488615#30488615", "title": "Forward email based on subject line", "body": "<blockquote>\n  <p>I'd like to forward any email that contains \"Excel Friday\" in the subject line to another email address.</p>\n</blockquote>\n\n<p>But in the code you check for the exact match of the subject line:</p>\n\n<pre><code>If Msg.Subject = \"Excel Friday\" Then\n</code></pre>\n\n<p>Instead you need to look for a substring. To find the position of a substring in a string, use <strong>Instr</strong> function.</p>\n\n<pre><code>If Instr(Msg.Subject, \"Excel Friday\") Then\n</code></pre>\n\n<p>Also I have noticed that you use the Reply method:</p>\n\n<pre><code>Set myMail = Msg.Reply \n</code></pre>\n\n<p>Use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff865399.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Forward</a> method instead:</p>\n\n<pre><code>Set myMail = Msg.Forward\n</code></pre>\n\n<p>And then use the Send method. </p>\n\n<pre><code> myMail.Recipients.Add \"Eugene Astafiev\" \n\n myMail.Send \n</code></pre>\n\n<p>Be aware, the code is based on the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869609.aspx\" rel=\"nofollow\">ItemAdd</a> event handler. This event is not fired when a large number of items are added to the folder at once (more than 16). </p>\n"}], "owner": {"reputation": 1, "user_id": 4945487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe210ec915f668ebf8744235c0bc547?s=128&d=identicon&r=PG&f=1", "display_name": "Jasonfish11", "link": "https://stackoverflow.com/users/4945487/jasonfish11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9382, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1607442717, "creation_date": 1432741432, "last_edit_date": 1607442717, "question_id": 30487198, "link": "https://stackoverflow.com/questions/30487198/forward-email-based-on-subject-line", "title": "Forward email based on subject line", "body": "<p>I'm trying to forward emails from my company's Outlook to an email account outside of our company. I have been given the ok to do this.</p>\n<p>I'd like to forward any email that contains &quot;Excel Friday&quot; in the subject line.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Private WithEvents Items As Outlook.Items\nPrivate Sub Application_Startup()\n    Dim olApp As Outlook.Application\n    Dim objNS As Outlook.NameSpace\n    Set olApp = Outlook.Application\n    Set objNS = olApp.GetNamespace(&quot;MAPI&quot;)\n    ' default local Inbox\n    Set Items = objNS.GetDefaultFolder(olFolderInbox).Items\nEnd Sub\n \nPrivate Sub Items_ItemAdd(ByVal Item As Object)\n    On Error GoTo ErrorHandler\n    Dim Msg As Outlook.MailItem\n    If TypeName(Item) = &quot;MailItem&quot; Then\n        Set Msg = Item\n        If Msg.Subject = &quot;Excel Friday&quot; Then\n            Dim myMail As Outlook.MailItem\n            Set myMail = Msg.Reply\n            myMail.To = &quot;xxxxxx@fakemail.com&quot;\n            myMail.Display\n        End If\n    End If\nProgramExit:\n    Exit Sub\nErrorHandler:\n    MsgBox Err.Number &amp; &quot; - &quot; &amp; Err.Description\n    Resume ProgramExit\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2003"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1432742359, "post_id": 30487088, "comment_id": 49053466, "body": "If your code works as expected and you&#39;re looking for better, cleaner and/or more efficient ways to code it, you might be interested in <a href=\"https://codereview.stackexchange.com\">Code Review</a> :)"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 2, "creation_date": 1432742493, "post_id": 30487088, "comment_id": 49053555, "body": "You should not need to reload <code>date-table</code> every time.  Use a query to <code>LEFT JOIN</code> the dates table to the holidays table.  Then the Mondays you want are in the query rows where <code>statHolidaysTbl.Date Is Null</code>"}], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 0, "last_activity_date": 1432750073, "creation_date": 1432750073, "answer_id": 30490026, "question_id": 30487088, "link": "https://stackoverflow.com/questions/30487088/vba-built-in-function-for-holidays-during-a-year/30490026#30490026", "title": "Vba built in function for holidays during a year?", "body": "<p>No, there are not built-in VBA functions for holidays.  You must use a customized approach to deal with your organization's chosen holidays.</p>\n\n<p>In your current approach, you discard the contents of <em>[date-table]</em> and then reload it with the dates of Mondays which are not holidays.</p>\n\n<p>I think it should be simpler to leave <em>all</em> the Monday dates in <em>[date-table]</em> and use a query which returns only the non-holiday Mondays.  You can accomplish that by <code>LEFT JOIN</code>ing <em>[date-table]</em> to <em>statHolidaysTbl</em> and asking for only those candidate rows where the right side (the holiday date) is Null.</p>\n\n<p>Save this as <em>qryMondays</em>:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT d.the_date\nFROM\n    [date-table] AS d\n    LEFT JOIN statHolidaysTbl AS h\n    ON d.the_date = h.Date\nWHERE h.Date Is Null;\n</code></pre>\n\n<p>Then wherever you formerly used <em>[date-table]</em>, use <em>qryMondays</em> instead.  </p>\n\n<p>When you need to add more recent Monday dates to <em>[date-table]</em>, just add them.  The query will automatically exclude the Monday holidays (assuming you also keep <em>statHolidaysTbl</em> updated).  But do not \"freshen\" <em>[date-table]</em> by discarding everything from it and then adding all the Mondays from scratch.  That would be unnecessary work and would bloat the database for no good reason.  </p>\n"}], "owner": {"reputation": 3687, "user_id": 4331334, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/aewEH.jpg?s=128&g=1", "display_name": "Coding Enthusiast", "link": "https://stackoverflow.com/users/4331334/coding-enthusiast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1781, "favorite_count": 0, "accepted_answer_id": 30490026, "answer_count": 1, "score": 1, "last_activity_date": 1432750073, "creation_date": 1432741145, "question_id": 30487088, "link": "https://stackoverflow.com/questions/30487088/vba-built-in-function-for-holidays-during-a-year", "title": "Vba built in function for holidays during a year?", "body": "<p>So basically i have two tables. A date table and a statHoliday table. The statholiday table has like all the holidays you can find in this country which is fine. </p>\n\n<ul>\n<li>I auto-populate myDate table to get every monday which is not a\nstat-holiday.</li>\n<li>I delete everything from myDate table before I repopulate everything using auto-execute everytime the database is opened.</li>\n<li>Though it works fine, I am looking for a more efficient way to do this. I think delete everything from table and updating over the years will take time. </li>\n<li>Is there any built functions for holidays in vba?</li>\n</ul>\n\n<p>mydate table looks like this:</p>\n\n<pre><code>the_date\n---------\n08-01-2015\n15-01-2015\n22-01-2015\n29-01-2015\n\n//stat-holiday table\nname     | Date\n---------------------\nNew Year | 01-01-2015\nChristmas| 25-12-2015\n</code></pre>\n\n<p>my function is below: </p>\n\n<pre><code>Function dateTblUpdate()\n\n  DoCmd.SetWarnings False\n  Dim dt As Date\n  Dim rs As DAO.Recordset\n  Dim db As DAO.Database\n  Set db = CurrentDb\n  Dim sqlS As String\n\n  sqlS = \"Select Date as holi from statHolidaysTbl\"\n\n  Set rs = db.OpenRecordset(sqlS)\n\n  DoCmd.RunSQL \"DELETE FROM [date-table]\"\n  For dt = #1/1/2010# To DateSerial(Year(Now), Month(Now), Day(Now))\n      If Weekday(dt) = 2 Then\n         Do While Not rs.EOF \n            If rs!holi &lt;&gt; dt Then\n                DoCmd.RunSQL \"Insert into [date-table] (the_date) values(#\" &amp; dt &amp; \"#)\"\n            End If\n            rs.MoveNext\n         Loop\n         rs.MoveFirst\n       End If\n   Next\n   DoCmd.SetWarnings True\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "pivot-table", "vba"], "answers": [{"tags": [], "owner": {"reputation": 405, "user_id": 1100554, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dd1c1863bd1c9da58ede1932822cb99e?s=128&d=identicon&r=PG", "display_name": "Sam", "link": "https://stackoverflow.com/users/1100554/sam"}, "is_accepted": true, "score": 1, "last_activity_date": 1432758655, "creation_date": 1432758655, "answer_id": 30492565, "question_id": 30486982, "link": "https://stackoverflow.com/questions/30486982/set-dynamic-dates-for-group-selection-in-excel-pivot-table/30492565#30492565", "title": "Set dynamic dates for Group Selection in Excel Pivot Table", "body": "<p>I stumbled across my own solution a few minutes after posting - hopefully, this benefits someone else....</p>\n\n<pre><code>Sub SetStartDate()\n'   Sets the date for the Start Date, End Date, and Groupings for the Date Periods\n\nDim wbk As Workbook\nDim ws As Worksheet\nDim pvt As PivotTable\nDim pvtFld As PivotField\nDim startDate, endDate As Long\nDim pivotName, rowLabel As String\n\nApplication.ScreenUpdating = False\n\nSet wbk = ActiveWorkbook\nSet ws = wbk.ActiveSheet\n    startDate = ws.Range(\"P2\").Value    ' Location of StartDate in Spreadsheet\n    endDate = ws.Range(\"P1\").Value  ' Location of EndDate in Spreadsheet\n\nFor Each pvt In ws.PivotTables\n    For Each pvtFld In pvt.RowFields\n        Debug.Print \"Pivot Field = \" &amp; pvtFld.name\n        rowLabel = pvtFld.name\n'        Debug.Print \"Row Label = \" &amp; rowLabel\n        pvtFld.DataRange.Group start:=startDate, End:=endDate, By:=28, Periods:=Array(False, False, False, True, False, False, False)\n    Next pvtFld\n\nNext pvt\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 405, "user_id": 1100554, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dd1c1863bd1c9da58ede1932822cb99e?s=128&d=identicon&r=PG", "display_name": "Sam", "link": "https://stackoverflow.com/users/1100554/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 941, "favorite_count": 0, "accepted_answer_id": 30492565, "answer_count": 1, "score": 1, "last_activity_date": 1432758655, "creation_date": 1432740863, "last_edit_date": 1531161705, "question_id": 30486982, "link": "https://stackoverflow.com/questions/30486982/set-dynamic-dates-for-group-selection-in-excel-pivot-table", "title": "Set dynamic dates for Group Selection in Excel Pivot Table", "body": "<p>I have a data-set that I pull from TFS that grabs data from the past year (@Today-365).  The data is grabbed by Excel and then used to populate pivot tables which are grouped by a date period of 28 days.  I would like to automate the group-dates but can't get my code to work or find good examples on the 'Net.  </p>\n\n<p>Here's what I've got so far...</p>\n\n<pre><code>Sub SetStartDate()\n'   Sets the date for the Start Date, End Date, and Groupings for the Date Periods\n'\n\nDim wbk As Workbook\nDim ws As Worksheet\nDim pvt As PivotTable\nDim pvtFld As PivotField\nDim startDate As Date\nDim endDate As Date\nDim rowLabel As String\n\n'Application.ScreenUpdating = False    ' Turn on Later\n\nSet wbk = ActiveWorkbook\nSet ws = wbk.ActiveSheet\nSet startDate = Today() 'incomplete\nSet endDate = Today()-365days 'incomplete\n\nFor Each pvt In ws.PivotTables\n    Debug.Print \"Pivot Name = \" &amp; pvt.name\n    Debug.Print \"Pivot Field Count = \" &amp; pvt.PivotFields.Count\n\n    For Each pvtFld In pvt.RowFields\n        Debug.Print \"Pivot Field = \" &amp; pvtFld.name  ' Name of Pivot field\n        rowLabel = pvtFld.name\n        Debug.Print \"Row Label = \" &amp; rowLabel\n'THIS LINE DOESN'T WORK, BUT THIS IS WHERE I RUN INTO TROUBLE IN MY CODE\n        pvtFld.Selection.Group start:=CLng(startDate), End:=CLng(endDate), By:=28, Periods:=Array(False, False, False, True, False, False, False)\n\n    Next pvtFld\nNext pvt\n\n'Application.ScreenUpdating = True    ' Remove comment later\n\nEnd Sub\n</code></pre>\n\n<p>As my comment in the middle states, I am not sure where to go after figuring out what the rowField name is.</p>\n"}, {"tags": ["excel", "cells", "vba"], "comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 4, "creation_date": 1432741936, "post_id": 30486844, "comment_id": 49053172, "body": "Most objects have a default property.  <code>Value</code> is the default property for a Cell.  I prefer <code>Sheet1.Cells(2,1).Value</code> because I prefer to be absolutely explicit.  If you never rely on defaults, you will never be surprised by the default not being what you expect."}, {"owner": {"reputation": 119, "user_id": 3240112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d95708c0de3b8205966474b9f5558a0e?s=128&d=identicon&r=PG&f=1", "display_name": "user3858", "link": "https://stackoverflow.com/users/3240112/user3858"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1432742256, "post_id": 30486844, "comment_id": 49053405, "body": "Thank you, that&#39;s very clear"}], "answers": [{"tags": [], "owner": {"reputation": 2595, "user_id": 3897316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cf468fea626f3aec65a199e2f67b309?s=128&d=identicon&r=PG&f=1", "display_name": "Degustaf", "link": "https://stackoverflow.com/users/3897316/degustaf"}, "is_accepted": true, "score": 2, "last_activity_date": 1432742330, "creation_date": 1432742330, "answer_id": 30487554, "question_id": 30486844, "link": "https://stackoverflow.com/questions/30486844/why-use-cells-value-in-vba-i-tried-to-use-cells-without-value-it-also-worked/30487554#30487554", "title": "why use cells.value in vba? I tried to use cells without value, it also worked", "body": "<p><strong>TL;DR To not be ambiguous</strong></p>\n\n<p>When You write <code>Sheet1.Cells(1,1)</code> you are receiving a range object.  The default property for that object is <code>Value</code>, so when you try to write to that range, it defaults to the value property.  Using the <code>Value</code> property explicitly can prevent confusion later on, particularly if you are also using other properties of that range, such as <code>Formula</code>, <code>FormulaR1C1</code>, <code>Value2</code>, ...</p>\n"}], "owner": {"reputation": 119, "user_id": 3240112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d95708c0de3b8205966474b9f5558a0e?s=128&d=identicon&r=PG&f=1", "display_name": "user3858", "link": "https://stackoverflow.com/users/3240112/user3858"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 422, "favorite_count": 0, "accepted_answer_id": 30487554, "answer_count": 1, "score": 0, "last_activity_date": 1432742330, "creation_date": 1432740499, "last_edit_date": 1531164843, "question_id": 30486844, "link": "https://stackoverflow.com/questions/30486844/why-use-cells-value-in-vba-i-tried-to-use-cells-without-value-it-also-worked", "title": "why use cells.value in vba? I tried to use cells without value, it also worked", "body": "<p>For the two following lines,</p>\n\n<pre><code>Sheet1.Cells(1,1)=7\nSheet1.Cells(2,1).value=7\n</code></pre>\n\n<p>These two lines of codes works exactly the same. Why do we even use Cells.value then?</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1670773"}, "edited": false, "score": 0, "creation_date": 1432740934, "post_id": 30486736, "comment_id": 49052471, "body": "Now I don&#39;t get value in textbox2 at all. I also tried after update event but not working."}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1432741112, "post_id": 30486736, "comment_id": 49052586, "body": "@OP HansUps&#39; answer sounds like a more streamlined answer for you."}], "tags": [], "owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "is_accepted": false, "score": 0, "last_activity_date": 1432740250, "creation_date": 1432740250, "answer_id": 30486736, "question_id": 30486620, "link": "https://stackoverflow.com/questions/30486620/textbox-value-show-only-first-record-of-table/30486736#30486736", "title": "Textbox value show only first record of table", "body": "<p>put this in the textbox1's change event:</p>\n\n<pre><code>me.textbox2.value = me.textbox1.value\n</code></pre>\n\n<p>This is probably all you need to set box2 the same as box1</p>\n\n<p>Just a note, the form load event will only fire once(when the form first loads) where as everytime the textbox changes the change event will fire. When in debug mode you could put break points around and then you will know when events fire, that is if you dont know.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1670773"}, "edited": false, "score": 0, "creation_date": 1432741512, "post_id": 30486968, "comment_id": 49052853, "body": "I want to do it using vba code not like this. Because I have to do lot of calculation on the value of TextBox1 and then show a result in TextBox2."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1670773"}, "edited": false, "score": 0, "creation_date": 1432744054, "post_id": 30486968, "comment_id": 49054578, "body": "In Control Source of TextBox2 I wrote &#39;=YourCustomFunction([TextBox1])&#39; and I wrote a function &#39; Private Sub YourCustomFunction(val As String) Me.TreoRank = val End Sub&#39;   but this is not working"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1432745549, "post_id": 30486968, "comment_id": 49055482, "body": "Telling us just &quot;not working&quot; is not helpful.  We may be able to help if you give us details about exactly what &quot;not working&quot; means."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1432746567, "post_id": 30486968, "comment_id": 49056126, "body": "Go to the Immediate window (Ctrl+g will take you there).  Paste <code>? YourCustomFunction(&quot;Tom&quot;)</code> into a new line and press Enter.  (If <i>&quot;Tom&quot;</i> is not a realistic value, substitute something that is realistic.)  What happens?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1670773"}, "edited": false, "score": 0, "creation_date": 1432747078, "post_id": 30486968, "comment_id": 49056431, "body": "it gives &quot;compiler error: sub or function not defined&quot;"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1432751413, "post_id": 30486968, "comment_id": 49058884, "body": "Good. You need to fix the function before attempting to use it in a text box Control Source. Declaring it <code>Private</code> may be why Access doesn&#39;t find it. And it should be a <code>Function</code>, not a <code>Sub</code>. Create it in a standard module, and start it with <code>Public Function YourCustomFunction(</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1670773"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1432753745, "post_id": 30486968, "comment_id": 49060148, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/78941/discussion-between-user1670773-and-hansup\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": false, "score": 1, "last_activity_date": 1432742838, "last_edit_date": 1432742838, "creation_date": 1432740828, "answer_id": 30486968, "question_id": 30486620, "link": "https://stackoverflow.com/questions/30486620/textbox-value-show-only-first-record-of-table/30486968#30486968", "title": "Textbox value show only first record of table", "body": "<p>It sounds like <em>TextBox2</em> is an unbound text box (its <em>Control Source</em> is blank).  Therefore the continuous form displays multiple copies of that text box, all with the same value.  When you change its value, that new value appears in all the copies.</p>\n\n<p>Since you clarified you don't want <em>TextBox2</em> to contain the same value as <em>TextBox1</em> (despite what you asked for in the question), use the <em>TextBox2</em> <em>Control Source</em> to apply your calculation.  It could be an expression which computes your result based on the value of <em>TextBox1</em>.  Or you could create a custom VBA function to do the calculation and apply the function to the value of <em>TextBox1</em>:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>=Round([TextBox1] / 100, 2)\n=YourCustomFunction([TextBox1])\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1670773"}, "edited": false, "score": 0, "creation_date": 1432741618, "post_id": 30487191, "comment_id": 49052943, "body": "I want to do it using vba code not like this. Because I have to do lot of calculation on the value of TextBox1 and then show a result in TextBox2."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1432741424, "creation_date": 1432741424, "answer_id": 30487191, "question_id": 30486620, "link": "https://stackoverflow.com/questions/30486620/textbox-value-show-only-first-record-of-table/30487191#30487191", "title": "Textbox value show only first record of table", "body": "<p>If TextBox2 should display an exact duplicate of TextBox1, the simplest method is to bind it the same way as TextBox2 - using the same ControlSource.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1670773"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1106, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1432742838, "creation_date": 1432739904, "last_edit_date": 1432741586, "question_id": 30486620, "link": "https://stackoverflow.com/questions/30486620/textbox-value-show-only-first-record-of-table", "title": "Textbox value show only first record of table", "body": "<p>In my MS Access continuous form I have two text boxes, TextBox1 and TextBox2. In TextBox1 I get the value from a table field of database and in TextBox2 I want to show the value of the first textbox and I want to do it using VBA program.</p>\n\n<p>What I am currently doing, on form load </p>\n\n<pre><code>Private Sub Form_Load()\nDim val As String\nval = Me.TextBox1 \nTextBox2.Value = val\nEnd Sub\n</code></pre>\n\n<p>But this show only the first element of the TextBox1 value in all TextBox2 value. TextBox2 value do not change with the change of TextBox1 value.</p>\n\n<p>For example, Currently my output is like this</p>\n\n<pre><code>TextBox1  TextBox2\nTom       Tom\nTommy     Tom\nSam       Tom\nSammy     Tom\n</code></pre>\n\n<p>But I want the output like this</p>\n\n<pre><code>TextBox1  TextBox2\nTom       Tom\nTommy     Tommy\nSam       Sam\nSammy     Sammy\n</code></pre>\n\n<p>That is I want to take the value of TextBox1 and put it in TextBox2 dynamically and I want to do it using code builder. </p>\n\n<p>I want to do it using vba code. Because I have to do lot of calculation on the value of TextBox1 and then show a result in TextBox2. How can I do this?</p>\n"}, {"tags": ["vba", "excel", "ms-office", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1432800597, "post_id": 30487863, "comment_id": 49077642, "body": "My bad, I was in a hurry because I&#39;m working on 5 projects at a time and my boss was on my heels for the others. I didn&#39;t took time to properly Google it... Shame on me! And still thank you because the link is awesome!"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1432817467, "post_id": 30487863, "comment_id": 49089737, "body": "Hey, sorry, that came across really rough. I guess, at the time, it was intended that way, <i>but it shouldn&#39;t have been</i>. Glad the search link was helpful. I&#39;ve found a general <code>&lt;application&gt; VBA &lt;issue&gt;</code> Google search <i>frequently</i> finds what I need, often with a SO link within the top 5, and usually my first choice!"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1432885783, "post_id": 30487863, "comment_id": 49121653, "body": "Don&#39;t worry mate, I could have done the same (and probably worse, as I get mad after every question : &quot;I need to copy ...&quot;). I just felt a bit trolled, but I do love that, so thanks for your help and the <code>&lt;application&gt; VBA &lt;issue&gt;</code> seems to be pretty efficient!"}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": true, "score": 1, "last_activity_date": 1432743184, "creation_date": 1432743184, "answer_id": 30487863, "question_id": 30486189, "link": "https://stackoverflow.com/questions/30486189/word-is-it-possible-to-change-easily-all-links-source-in-a-document/30487863#30487863", "title": "Word - Is it possible to change easily all links&#39; source in a document?", "body": "<p>Is it possible? <strong>Yes</strong></p>\n\n<p>How? A <a href=\"https://www.google.com/search?q=word+vba+change+link+source&amp;ie=utf-8&amp;oe=utf-8\" rel=\"nofollow\">Google search</a> reveals multiple options with lots of code to copy/paste.</p>\n"}], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 292, "favorite_count": 0, "accepted_answer_id": 30487863, "answer_count": 1, "score": 0, "last_activity_date": 1432743184, "creation_date": 1432738740, "question_id": 30486189, "link": "https://stackoverflow.com/questions/30486189/word-is-it-possible-to-change-easily-all-links-source-in-a-document", "title": "Word - Is it possible to change easily all links&#39; source in a document?", "body": "<p>I have 5 <strong>Word template linked to an Excel file</strong> to automatically generate new pre-formated reports.</p>\n\n<p>As I am working on improving it, I have created <strong>copies that will replace the old</strong> version once I'm done. And in each template, I have approximately 70 links, so almost <strong>350 links in total</strong>.</p>\n\n<p>My question is : </p>\n\n<blockquote>\n  <p>Is there a way to change easily the source file for multiple links?</p>\n</blockquote>\n\n<p>Solutions <strong>with or without code</strong> are welcome!</p>\n\n<p><img src=\"https://i.stack.imgur.com/9OkX8.png\" alt=\"Links in Word file\"></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 2, "creation_date": 1432740551, "post_id": 30486339, "comment_id": 49052172, "body": "It&#39;s worth mentioning that the macro recorder does a decent job of helping with the properties and commands needed.  You have to do the normal cleanup, but it&#39;s a good starting place."}], "tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": true, "score": 3, "last_activity_date": 1432739147, "creation_date": 1432739147, "answer_id": 30486339, "question_id": 30486118, "link": "https://stackoverflow.com/questions/30486118/conditional-formatting-without-excel-gui/30486339#30486339", "title": "Conditional Formatting without Excel GUI", "body": "<p>You can add via <code>FormatConditions</code></p>\n\n<p>E.g. Red bg colour for values > 3</p>\n\n<pre><code>With Range(\"a1:a10\").FormatConditions.Add( _\n    XlFormatConditionType.xlCellValue, _\n    XlFormatConditionOperator.xlGreater, _\n    \"=3\")\n\n    .SetFirstPriority\n    .Interior.Color = RGB(255, 0, 0)\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 8345, "user_id": 1887261, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/f1a23a45808b0429be1543ca726d522f?s=128&d=identicon&r=PG", "display_name": "meepl", "link": "https://stackoverflow.com/users/1887261/meepl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 30486339, "answer_count": 1, "score": 2, "last_activity_date": 1432739147, "creation_date": 1432738571, "last_edit_date": 1531161705, "question_id": 30486118, "link": "https://stackoverflow.com/questions/30486118/conditional-formatting-without-excel-gui", "title": "Conditional Formatting without Excel GUI", "body": "<p>I am working on an automated report where'd I'd like to add conditional formatting to some cells.  Unfortunately, the only way to do this seems to be manually.</p>\n\n<p>Does anyone know of a workflow to add conditional formatting only within a function?</p>\n"}, {"tags": ["ms-access", "outlook", "vba"], "comments": [{"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1432739010, "post_id": 30485955, "comment_id": 49050974, "body": "Without HTML, I do not think it is possible."}, {"owner": {"reputation": 1, "user_id": 4585788, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2kjS6krlri8/AAAAAAAAAAI/AAAAAAAAAEo/BO2UL1t0NcY/photo.jpg?sz=128", "display_name": "Shawn", "link": "https://stackoverflow.com/users/4585788/shawn"}, "reply_to_user": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1433336445, "post_id": 30485955, "comment_id": 49307705, "body": "Thanks, your right started working with html and css.  On to the next issue on my list, moving repetitive code from different forms into a stand alone or class module, bbut that for anther day."}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1432740199, "creation_date": 1432740199, "answer_id": 30486714, "question_id": 30485955, "link": "https://stackoverflow.com/questions/30485955/create-a-table-in-an-outlook-message-using-access-vba/30486714#30486714", "title": "create a table in an outlook message using access vba", "body": "<p>The Outlook object model provides three main ways for working with item bodies:</p>\n\n<ol>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff865304(v=office.15).aspx\" rel=\"nofollow\">Body</a>.</li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff868941(v=office.15).aspx\" rel=\"nofollow\">HTMLBody</a>.</li>\n<li>The Word editor. The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff868196(v=office.15).aspx\" rel=\"nofollow\">WordEditor</a> property of the Inspector class returns an instance of the Word Document which represents the message body. So, you can use the Word object model do whatever you need with the message body (create a table using the Word object model). </li>\n</ol>\n\n<p>See <a href=\"https://msdn.microsoft.com/en-us/library/dd492012%28v=office.12%29.aspx\" rel=\"nofollow\">Chapter 17: Working with Item Bodies</a> for more information.</p>\n"}], "owner": {"reputation": 1, "user_id": 4585788, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2kjS6krlri8/AAAAAAAAAAI/AAAAAAAAAEo/BO2UL1t0NcY/photo.jpg?sz=128", "display_name": "Shawn", "link": "https://stackoverflow.com/users/4585788/shawn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2101, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432876309, "creation_date": 1432738172, "last_edit_date": 1432876309, "question_id": 30485955, "link": "https://stackoverflow.com/questions/30485955/create-a-table-in-an-outlook-message-using-access-vba", "title": "create a table in an outlook message using access vba", "body": "<p>I am using Access to create outlook messages. I need to create a table that i will populate with text strings. What I need to start with is how to create a simple table with  one column two rows that is not folder or html based? The first row will say \"I am a Heading\" and the second row will say \"I am a row\". Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1871, "user_id": 4640496, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2d92a3812fa5e8860ad6c993031dd1f?s=128&d=identicon&r=PG", "display_name": "Kevin Nagurski", "link": "https://stackoverflow.com/users/4640496/kevin-nagurski"}, "edited": false, "score": 1, "creation_date": 1432738225, "post_id": 30485753, "comment_id": 49050380, "body": "Can you show your workings?"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 1, "creation_date": 1432740327, "post_id": 30485753, "comment_id": 49052002, "body": "I think you need to show an example of input/output + the code you&#39;ve already tried."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4945216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b1e5ec451623fba95ae0d9b7dcb28f?s=128&d=identicon&r=PG&f=1", "display_name": "leeroysilk", "link": "https://stackoverflow.com/users/4945216/leeroysilk"}, "edited": false, "score": 0, "creation_date": 1433768258, "post_id": 30490912, "comment_id": 49476795, "body": "I don&#39;t know how to add a longer comment on here. Like I said, newbie."}, {"owner": {"reputation": 1, "user_id": 4945216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b1e5ec451623fba95ae0d9b7dcb28f?s=128&d=identicon&r=PG&f=1", "display_name": "leeroysilk", "link": "https://stackoverflow.com/users/4945216/leeroysilk"}, "edited": false, "score": 0, "creation_date": 1433768338, "post_id": 30490912, "comment_id": 49476850, "body": "I want to create a &quot;<a href=\"http://www.google.com\" rel=\"nofollow noreferrer\">google.com</a>&quot; start address with b2, then b3, then b4, etc added to the url, with a bit of text between each cell, such as &quot;&amp;&quot;"}], "tags": [], "owner": {"reputation": 35, "user_id": 2816536, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/bb0f9b04b8235ecc7b089258839b7a85?s=128&d=identicon&r=PG&f=1", "display_name": "Zurix", "link": "https://stackoverflow.com/users/2816536/zurix"}, "is_accepted": false, "score": 0, "last_activity_date": 1432753044, "creation_date": 1432753044, "answer_id": 30490912, "question_id": 30485753, "link": "https://stackoverflow.com/questions/30485753/building-a-url-using-visual-basic/30490912#30490912", "title": "Building a URL using Visual Basic", "body": "<p>You can split the long string in lets say 2 variables and then use them in VBA to concatenate it with your formula.</p>\n\n<p>An example of what you have would be better.</p>\n"}], "owner": {"reputation": 1, "user_id": 4945216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b1e5ec451623fba95ae0d9b7dcb28f?s=128&d=identicon&r=PG&f=1", "display_name": "leeroysilk", "link": "https://stackoverflow.com/users/4945216/leeroysilk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432753044, "creation_date": 1432737644, "last_edit_date": 1531161705, "question_id": 30485753, "link": "https://stackoverflow.com/questions/30485753/building-a-url-using-visual-basic", "title": "Building a URL using Visual Basic", "body": "<p>My name is lee, and I'm new on here. I'm very experienced in Excel, and most aspects of Office, but not so much in VBA.</p>\n\n<p>I have embedded a local map using an API in excel, and want to plot multiple postal codes. I have this working up to 23 postal codes using a Hyperlink and Concatenate in the same formula to build the URL. After 23 postal codes, the formula result exceeds 255 characters, so that's where I fail.</p>\n\n<p>I need one solution - either a way to work around the limit (without using a 3rd party url shortener), or by building the entire URL in VBA. My button launches the formulated url from cell A1, but when it exceeds 255 characters, I assume I will need the button to run the url directly from within VBA?</p>\n\n<p>Anyhow, I'm sure I've probably missed out some vital info, so please, if you think are able to help, ask me and I'll give as much extra detail as possible.</p>\n"}, {"tags": ["vba", "outlook", "outlook-2010"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 4732123, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/46c2df8ae728006324600d4d6d196fb1?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor D", "link": "https://stackoverflow.com/users/4732123/taylor-d"}, "edited": false, "score": 0, "creation_date": 1432738549, "post_id": 30485932, "comment_id": 49050613, "body": "yes but how do you export and transfer the view to another PC?"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 53, "user_id": 4732123, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/46c2df8ae728006324600d4d6d196fb1?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor D", "link": "https://stackoverflow.com/users/4732123/taylor-d"}, "edited": false, "score": 0, "creation_date": 1432739994, "post_id": 30485932, "comment_id": 49051737, "body": "You can develop an add-in or VBA macro."}, {"owner": {"reputation": 53, "user_id": 4732123, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/46c2df8ae728006324600d4d6d196fb1?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor D", "link": "https://stackoverflow.com/users/4732123/taylor-d"}, "edited": false, "score": 0, "creation_date": 1432740146, "post_id": 30485932, "comment_id": 49051868, "body": "Well I know there is a way to incorporate the view to default into the invite for other to see my task manager as I have done this before. But I cannot remember how I was able to accomplish this. I do not believe I used any macros to do this."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 53, "user_id": 4732123, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/46c2df8ae728006324600d4d6d196fb1?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor D", "link": "https://stackoverflow.com/users/4732123/taylor-d"}, "edited": false, "score": 0, "creation_date": 1432740279, "post_id": 30485932, "comment_id": 49051973, "body": "Use superuser.com for non-programming questions."}, {"owner": {"reputation": 53, "user_id": 4732123, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/46c2df8ae728006324600d4d6d196fb1?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor D", "link": "https://stackoverflow.com/users/4732123/taylor-d"}, "edited": false, "score": 0, "creation_date": 1432740549, "post_id": 30485932, "comment_id": 49052171, "body": "Ok I will post the question there"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1432738115, "creation_date": 1432738115, "answer_id": 30485932, "question_id": 30485740, "link": "https://stackoverflow.com/questions/30485740/share-outlook-task-manager-custom-view-with-user-defined-columns/30485932#30485932", "title": "Share Outlook task manager custom view with user defined columns", "body": "<p>Views are defined and customized using the View object's <a href=\"https://msdn.microsoft.com/en-us/library/office/ff868419.aspx\" rel=\"nofollow\">XML</a> property. The XML property allows you to create and set a customized XML schema that defines the various features of a view.</p>\n\n<p>Use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff868419.aspx\" rel=\"nofollow\">CurrentView</a> property of the Explorer or Folder classes to customize the View in Outlook. An XML definition of the view can be exported and transferred to another PC. </p>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 4732123, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/46c2df8ae728006324600d4d6d196fb1?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor D", "link": "https://stackoverflow.com/users/4732123/taylor-d"}, "is_accepted": false, "score": 0, "last_activity_date": 1432763096, "creation_date": 1432763096, "answer_id": 30493696, "question_id": 30485740, "link": "https://stackoverflow.com/questions/30485740/share-outlook-task-manager-custom-view-with-user-defined-columns/30493696#30493696", "title": "Share Outlook task manager custom view with user defined columns", "body": "<p>Ok essentially what I did was I went to view - current view - define views and created a new view selecting Table and This folder, visible to everyone. Then I found pre-definied columns that weren't user defined columns that allowed free text typing like subject, milage, and billing information. Once finished adding all the columns I needed I applied the view. Then I went and changed the name of the columns by right clicking each column header in the task manager and selecting format column. there you chan change the label name to whatever you want the column to be titled. This way you did not have to worry with using user defined columns that can be tricky to share. After that I went back to view - current view - define views, and made a copy of the view I created selecting this folder, visible to everyone.  Then you will want to right on the tasks manager name you created under the My Tasks list and select properties. Make sure to give everyone your sharing it with full permissions as owners so that they can all edit the task manager as they finish each task. Then I shared this task manager by right clicking on the name of my newly created tasks manager (listed under the My Tasks menu) and selecting \"share\". I checked the box in the email stating recipient can add, edit, and delete items in this tasks folder.  Now everyone can see all information displayed in each column and edit it as well hope this helps. </p>\n"}], "owner": {"reputation": 53, "user_id": 4732123, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/46c2df8ae728006324600d4d6d196fb1?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor D", "link": "https://stackoverflow.com/users/4732123/taylor-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 215, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1593306282, "creation_date": 1432737611, "last_edit_date": 1593306282, "question_id": 30485740, "link": "https://stackoverflow.com/questions/30485740/share-outlook-task-manager-custom-view-with-user-defined-columns", "title": "Share Outlook task manager custom view with user defined columns", "body": "<p>I have created a task manager view in Microsoft Outlook which contains user defined fields as well as other Pre-defined fields in the view. I am trying to share this task manager with the rest of my team however, I cannot get it to show all of the columns as they appear on my screen on their screens. I am able to share the task manager but many of the columns are missing. It seems to be because the custom view I created isn't being shared with the other users. On my computer, the custom view is displayed and selected above \"Simple list\" under the Current View menu on the left and the others do no seem to have that as an option. Does anyone know how I can share the view? The tasks are already being shared I just need the View to be shared so my team can see all the columns properly. Thanks for any input you may have to offer.  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1432740365, "post_id": 30485732, "comment_id": 49052033, "body": "What have you tried to get your new desired outcome?  Dumping code and asking us to piece together a solution for you is likely not going to be fruitful."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1432755302, "creation_date": 1432755302, "answer_id": 30491588, "question_id": 30485732, "link": "https://stackoverflow.com/questions/30485732/excel-vba-to-compile-data-from-multiple-selected-excel-files-into-one-analysed-f/30491588#30491588", "title": "Excel-VBA to compile data from multiple selected Excel files into one Analysed file", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834966.aspx\" rel=\"nofollow\">Application.GetOpenFileName method</a> has an optional <em>multiselect</em> parameter.</p>\n\n<p>Working with a returned value that could be either <em>False</em> or an array of filenames and paths (even if that array is an array of one filename/path) is a bit tricky. Here is some framework that should get you started.</p>\n\n<pre><code>Sub collect_fns()\n    Dim f As Long, fNameAndPath As Variant\n\n    fNameAndPath = Application.GetOpenFilename(\"Excel files (*.xl*), *.xl*\", _\n                        Title:=\"Select File(s) To Be Opened\", MultiSelect:=True)\n\n    If IsArray(fNameAndPath) Then\n        For f = LBound(fNameAndPath) To UBound(fNameAndPath)\n            ' do something with each file as fNameAndPath(f)\n            process_each_fn CStr(fNameAndPath(f))\n        Next f\n    Else\n        'no files selected\n    End If\n\nEnd Sub\n\nSub process_each_fn(fn As String)\n\n    Debug.Print fn\n\nEnd Sub\n</code></pre>\n\n<p>It may help to move the bulk of your code to another sub and pass the filename into the new sub through the loop as I'm demonstrated above.</p>\n"}], "owner": {"reputation": 51, "user_id": 4819972, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c8d00191b3a6139b3c7fc488807f4dc4?s=128&d=identicon&r=PG&f=1", "display_name": "Harshit Mehra", "link": "https://stackoverflow.com/users/4819972/harshit-mehra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "accepted_answer_id": 30491588, "answer_count": 1, "score": 0, "last_activity_date": 1432755302, "creation_date": 1432737576, "last_edit_date": 1531164843, "question_id": 30485732, "link": "https://stackoverflow.com/questions/30485732/excel-vba-to-compile-data-from-multiple-selected-excel-files-into-one-analysed-f", "title": "Excel-VBA to compile data from multiple selected Excel files into one Analysed file", "body": "<p>I have written a Macro that opens the selected file, searches where the error is occurred and then places it in the Summary file in the active cell. Its working perfectly but now I want that instead of selecting each file one by one i could select all required files together or i could open one file and it runs till the last file as the file name is in series i.e Motor 21, motor 22 and so on. there is some help give in this post but I don't know if I could use it. </p>\n\n<p><a href=\"http://www.mrexcel.com/forum/excel-questions/602222-macro-compile-data-multiple-excel-files-into-one-summary-file.html\" rel=\"nofollow\">http://www.mrexcel.com/forum/excel-questions/602222-macro-compile-data-multiple-excel-files-into-one-summary-file.html</a> </p>\n\n<pre><code>Sub InputData()\n\nDim fNameAndPath As Variant\nDim wb As Workbook, temporaryWB As Workbook\nDim oRange As Range, aCell As Range, bCell As Range\nDim ws As Worksheet\nDim SearchString As String, DateCol As String\nDim CumSum As Double, counter As Double, cum As Double\nDim strSheetName As String, CellName As String\nDim lastColumn As Long\n\nSet wb = ThisWorkbook\n\nstrSheetName = ActiveSheet.Name\nCellName = ActiveCell.Address\ncum = Range(CellName).Offset(-1, 2).Value\n\nfNameAndPath = Application.GetOpenFilename(Title:=\"Select File To Be Opened\")\nIf fNameAndPath = False Then Exit Sub\nSet temporaryWB = Workbooks.Open(fNameAndPath)\n\nSet ws = ActiveSheet\nSet oRange = ws.Range(\"C:C\")\n\nSearchString = \"10000\"\n\nSet aCell = oRange.Find(What:=SearchString, LookIn:=xlValues, _\n    LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlPrevious, _\n    MatchCase:=False, SearchFormat:=False)\n\n\nIf Not aCell Is Nothing Then ' searching codeID string first time\n\n    aCell.Select\n    DateCol = aCell.Offset(0, -2)\n    counter = aCell.Offset(0, -1)\n\n    wb.Worksheets(strSheetName).Range(CellName) = DateCol\n    wb.Worksheets(strSheetName).Range(CellName).Offset(0, 1) = counter\n\n    CumSum = counter + cum\n    wb.Worksheets(strSheetName).Range(CellName).Offset(0, 2) = CumSum\n    wb.Worksheets(strSheetName).Range(CellName).Offset(0, 3) = \"1000000\"\n    wb.Worksheets(strSheetName).Range(CellName).Offset(0, 4) = \"50\"\n\n    lastColumn = ws.UsedRange.Columns.Count\n\n    If InStr(1, ActiveCell.End(xlToRight).Offset(1, 3).Value, \"1ms\", vbTextCompare) &lt;&gt; 0 Then\n        wb.Worksheets(strSheetName).Range(CellName).Offset(0, 6) = ActiveCell.End(xlToRight).Offset(1, 3)\n        wb.Worksheets(strSheetName).Range(CellName).Offset(0, 7) = ActiveCell.End(xlToRight).Offset(1, 4)\n\n    Else\n\n        wb.Worksheets(strSheetName).Range(CellName).Offset(0, 6) = Application.InputBox(\"Enter error\", \"Dialog box\", ActiveCell.End(xlToRight).Offset(1, 3), , , , , 2)\n        wb.Worksheets(strSheetName).Range(CellName).Offset(0, 7) = Application.InputBox(\"Enter error\", \"Dialog box\", ActiveCell.End(xlToRight).Offset(1, 4), , , , , 2)\n\n    End If\nElse\n    MsgBox SearchString &amp; \" not Found\"\n    Exit Sub\nEnd If\n\ntemporaryWB.Close savechanges:=False\n\nEnd Sub \n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1432737513, "post_id": 30485457, "comment_id": 49049814, "body": "++ I like it when people really explain their questions so well :) Saves a lot of time! Definitely worth an upvote!"}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1432737804, "post_id": 30485457, "comment_id": 49050070, "body": "Thank you very much! I think explaining everything as clearly as possible is a natural extension of SO&#39;s excellent posting guidelines and make the site so easy to use. Other people&#39;s posts, including your own answers, have saved me a lot of time in reading and understanding by doing the same and have served as good role models."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432737922, "post_id": 30485457, "comment_id": 49050152, "body": "Awesome :) Ok can you check something for me? Put a breakpoint before the DIR and manually check the folder and see if the files have been extracted. If you don&#39;t see them does pressing <code>F5</code> help?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1432738255, "post_id": 30485457, "comment_id": 49050401, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/78921/discussion-between-siddharth-rout-and-puzzlepiece87\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 2, "last_activity_date": 1432739007, "creation_date": 1432739007, "answer_id": 30486291, "question_id": 30485457, "link": "https://stackoverflow.com/questions/30485457/dir-function-cant-find-freshly-unzipped-files/30486291#30486291", "title": "Dir() function can&#39;t find freshly unzipped files?", "body": "<p>1 Second wait time is way too less. You have two options.</p>\n\n<p>A) Either increase the wait time. Paste this procedure</p>\n\n<pre><code>Private Sub Wait(ByVal nSec As Long)\n    nSec = nSec + Timer\n    While nSec &gt; Timer\n        DoEvents\n    Wend\nEnd Sub\n</code></pre>\n\n<p>and just before the <code>Dir</code> command type <code>Wait 15</code>. This means your code will wait for 15 seconds before DIR executes again. You can change it to any appropriate number. <code>15</code> is just an example.</p>\n\n<p>B) I would prefer the second way. Here you will loop till DIR finds something in that folder but at the same time I will merge the above code with this</p>\n\n<p>Here is an example</p>\n\n<pre><code>Do While Dir(String12 &amp; \"*.out.zip\") = \"\"\n    Wait 2\nLoop\n\nPrivate Sub Wait(ByVal nSec As Long)\n    nSec = nSec + Timer\n    While nSec &gt; Timer\n        DoEvents\n    Wend\nEnd Sub\n</code></pre>\n\n<p>You can add more functionality to the loop for example, number of attempts. See this</p>\n\n<pre><code>Dim numberOfAttmpts As Long\n\nDo While Dir(String12 &amp; \"*.out.zip\") = \"\"\n    Wait 2\n\n    numberOfAttmpts = numberOfAttmpts + 1\n\n    If numberOfAttmpts &gt; 5 Then\n        MsgBox \"5 attempts also failed. Exiting\"\n        Exit Sub\n    End If\nLoop\n\nPrivate Sub Wait(ByVal nSec As Long)\n    nSec = nSec + Timer\n    While nSec &gt; Timer\n        DoEvents\n    Wend\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 30486291, "answer_count": 1, "score": 1, "last_activity_date": 1432739007, "creation_date": 1432736887, "last_edit_date": 1531164843, "question_id": 30485457, "link": "https://stackoverflow.com/questions/30485457/dir-function-cant-find-freshly-unzipped-files", "title": "Dir() function can&#39;t find freshly unzipped files?", "body": "<p>I've been unzipping files using Example 1 of Ron de Bruin's oft-cited unzipping macro found here: <a href=\"http://www.rondebruin.nl/win/s7/win002.htm\" rel=\"nofollow\">http://www.rondebruin.nl/win/s7/win002.htm</a></p>\n\n<p>I have used it successfully many times so far, but now I am trying to work with downloaded files that are twice-zipped. The problem that I am running into is that the Dir() function in the second portion of code below cannot find the once-unzipped .zip files until I stop the macro in some way.</p>\n\n<p><strong>What I've Tried:</strong>\nPutting DoEvents and a 1-second Wait before the second unzipping portion</p>\n\n<p><strong>What Works:</strong>\nOpening the macro, doing \"Run to Cursor\" to the Dir() line at the top of the second portion of code, and then hitting continue.</p>\n\n<p><strong>Desired behavior:</strong>\nThat the macro is able to run through with a single command rather than having to have it stop via Run to Cursor.</p>\n\n<p>Copying the relevant consecutive portions of code below, the first portion works and the following portion needs the extra push:</p>\n\n<pre><code>'835 Unzipping and Copying Only\nIf String8 = \"835\" Then\n    'Rename as (Directory) (Date) (File Type) (Business Line) (file extension)\n    Name String1 As String3 &amp; String9 &amp; \" \" &amp; String8 &amp; \"s \" &amp; String11 &amp; \".zip\"\n    'Save the complete path as one string\n    String5 = String3 &amp; String9 &amp; \" \" &amp; String8 &amp; \"s \" &amp; String11 &amp; \".zip\"\n    'String6 is the 835s Archive\n    String6 = (full file path, obscured for privacy, can insert generic path if needed)\n    'Database Folder\n    String7 = (full file path, obscured for privacy, can insert generic path if needed)\n    'Copy from the download folder to the archive folder and the database folder\n    FileCopy String5, String6\n    FileCopy String5, String7\n    Kill String5\n    'Unzip selected archive\n    Set Object1 = CreateObject(\"Shell.Application\")\n    String12 = (directory only path with trailing backslash)\n    Variant1 = String12\n    Variant2 = String7\n    Object1.Namespace(Variant1).CopyHere Object1.Namespace(Variant2).items\n    On Error Resume Next\n    Set Object2 = CreateObject(\"scripting.filesystemobject\")\n    Object2.deletefolder Environ(\"Temp\") &amp; \"\\Temporary Directory*\", True\n    On Error GoTo 0\n    Kill String7\n</code></pre>\n\n<p>This portion requires me the \"Run to Cursor\" or the Dir() function will not find the unzipped files and the second unzipping will be skipped. The once-unzipped files end with \".out.zip\". Don't ask me, that's just how I receive them. I have tried putting DoEvents and a one-second wait right before the second line below:</p>\n\n<pre><code>    'Further unzipping\n    String4 = Dir(String12 &amp; \"*.out.zip\")\n    Do While String4 &lt;&gt; \"\"\n        'Save the complete path of the file found\n        String5 = String12 &amp; String4\n        'Unzip selected archive\n        Variant1 = String12\n        Variant2 = String5\n        Object1.Namespace(Variant1).CopyHere Object1.Namespace(Variant2).items\n        On Error Resume Next\n        Object2.deletefolder Environ(\"Temp\") &amp; \"\\Temporary Directory*\", True\n        On Error GoTo 0\n        Kill String5\n        String4 = Dir(String12 &amp; \"*.out.zip\")\n    Loop\n    GoTo AllDone\nEnd If\n</code></pre>\n\n<p><strong>Other Notes:</strong>\nI have DoEvents in one line of my code that occurs earlier than these two portions.</p>\n\n<p>I use Excel 2010.</p>\n"}, {"tags": ["string", "vba", "excel"], "comments": [{"owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432736737, "post_id": 30485234, "comment_id": 49049134, "body": "@SiddharthRout As AE is positioned third in the output."}], "answers": [{"comments": [{"owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "edited": false, "score": 0, "creation_date": 1432736865, "post_id": 30485353, "comment_id": 49049249, "body": "Do you mean that AA 0,/ 1, AE_ABC 2,/ 3 , AE 4 ?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "edited": false, "score": 0, "creation_date": 1432737226, "post_id": 30485353, "comment_id": 49049576, "body": "I think I know what you are trying to achieve. Check my answer. I have edited that. You may have to refresh the page."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 2, "last_activity_date": 1432737050, "last_edit_date": 1432737050, "creation_date": 1432736639, "answer_id": 30485353, "question_id": 30485234, "link": "https://stackoverflow.com/questions/30485234/finding-position-in-a-string/30485353#30485353", "title": "Finding position in a String", "body": "<p>If you just want to find the position of the string then use this</p>\n\n<pre><code>Sub Sample()\n    Debug.Print findPos(\"AE\", \"AA/AE_ABC/AE/CD\")\nEnd Sub\n\nFunction findPos(Searchval As String, Output As String) As Long\n    findPos = InStr(1, Output, Searchval, 0)\nEnd Function\n</code></pre>\n\n<p>BTW, the position is <code>4</code> and not <code>3</code></p>\n\n<p>Edit: If you are looking for position after \"/\" then try this</p>\n\n<pre><code>Sub Sample()\n    Debug.Print findPos(\"AE\", \"AA/AE_ABC/AE/CD\")\nEnd Sub\n\nFunction findPos(Searchval As String, Output As String) As Long\n    Dim MyAr\n    Dim i As Long\n\n    '~~&gt; Check if output has \"/\"\n    If InStr(1, Output, \"/\", 0) Then\n        '~~&gt; Split it and store it in an array\n        MyAr = Split(Output, \"/\")\n\n        '~~&gt; Loop through the array to find an exact match\n        For i = LBound(MyAr) To UBound(MyAr)\n            If MyAr(i) = Searchval Then\n                findPos = i + 1\n                Exit Function\n            End If\n        Next i\n    Else\n        '~~&gt; Check if both Searchval and Output are same\n        If Output = Searchval Then findPos = 1\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 1, "last_activity_date": 1432738586, "last_edit_date": 1432738586, "creation_date": 1432737632, "answer_id": 30485749, "question_id": 30485234, "link": "https://stackoverflow.com/questions/30485234/finding-position-in-a-string/30485749#30485749", "title": "Finding position in a String", "body": "<p>Something like this should work for you, commented for clarity:</p>\n\n<pre><code>Function findPos(ByVal strFind As String, _\n                 ByVal strContent As String, _\n                 Optional ByVal sDelimiter As String = \"/\") As Long\n\n    'strFind is the substring you're searching for\n    'strContent is the string you're looking in for strFind\n    'Be default sDelimiter is '/' but it can be specified as something else\n\n    Dim varSection As Variant\n    Dim i As Long\n\n    'Check if strFind exists in strContent by itself with the delimiter\n    If InStr(1, sDelimiter &amp; strContent &amp; sDelimiter, sDelimiter &amp; strFind &amp; sDelimiter, vbTextCompare) &gt; 0 Then\n        'It exists, loop through delimited sections of strContent to return the position\n        For Each varSection In Split(strContent, sDelimiter)\n            i = i + 1   'Increase section count\n            If varSection = strFind Then    'Check for match\n                'Match found, return position and exit for loop\n                findPos = i\n                Exit For\n            End If\n        Next varSection\n    Else\n        'No match found, return 0\n        findPos = 0\n    End If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 30485353, "answer_count": 2, "score": 0, "last_activity_date": 1432738586, "creation_date": 1432736354, "last_edit_date": 1432738285, "question_id": 30485234, "link": "https://stackoverflow.com/questions/30485234/finding-position-in-a-string", "title": "Finding position in a String", "body": "<p>I want to find the position of a sub String in a String but facing some issues. Here is the code</p>\n\n<pre><code>Function findPos( Searchval As String, Output As String) As Long\nDim pos, i, count As Long\npos = InStr(1, content, searchVal, 0)\n\nIf pos = 0 Then\n    count = 0\nElse\n    count = 1\nEnd If\n\nIf pos &gt; 0 Then\n    For i = 1 To pos\n        If Mid(content, i, 1) = \"/\" Then count = count + 1\n    Next i\nEnd If\n\nfindPos=count\n\nEnd Function\n</code></pre>\n\n<p>For eg: If output is <strong>\"AA/AE_ABC/AE/CD\"</strong> and if I searchVal is <strong>\"AE\"</strong> then I get output position as 2 which is wrong as I should get 3. I know that <strong>pos</strong> in code has to be modified somehow but can't figure it.</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 398, "user_id": 4215263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OUqKk.png?s=128&g=1", "display_name": "andshrew", "link": "https://stackoverflow.com/users/4215263/andshrew"}, "is_accepted": false, "score": 1, "last_activity_date": 1432739999, "creation_date": 1432739999, "answer_id": 30486651, "question_id": 30485227, "link": "https://stackoverflow.com/questions/30485227/ms-access-change-default-printer-via-vba/30486651#30486651", "title": "MS ACCESS: Change default printer via VBA", "body": "<pre><code>Dim prn As Printer\nDim printerFound As Boolean: printerFound = False\n\nFor Each prn In Application.Printers\n    If prn.DeviceName = tempTicket Then\n        Application.Printer = prn\n        printerFound = True\n        Exit For\n    End If\nNext\n\nIf Not printerFound Then\n    ' Handle Printer Not Found Error\nEnd If\n</code></pre>\n\n<p>You're not assigning the Application.Printer correctly, if you use the above it will look for the printer named in tempTicket and if found will set Access to use that as the default printer. If the printer isn't found then you can handle the error as you require.</p>\n"}], "owner": {"reputation": 375, "user_id": 3216034, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/eb061981ca8df90d46d66da96a0b0577?s=128&d=identicon&r=PG&f=1", "display_name": "jpl458", "link": "https://stackoverflow.com/users/3216034/jpl458"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4341, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1521570497, "creation_date": 1432736336, "last_edit_date": 1521570497, "question_id": 30485227, "link": "https://stackoverflow.com/questions/30485227/ms-access-change-default-printer-via-vba", "title": "MS ACCESS: Change default printer via VBA", "body": "<p>I have a small app that changes the default printer to an Ithica ticket printer, then prints some info and resets to the default printer. The program will be used at three different work stations each with its own ticket printer.</p>\n\n<p>The following is my current code attempt, which bombs. What is wrong?</p>\n\n<p><code>\"application.Printer = application.Printers(tempTicket)\"</code>. </p>\n\n<p>Using printer names from \"Devices and Printers\"</p>\n\n<pre><code>   Private Sub Printfoundcardbtn_Click()\n   Dim stEnviron As String\n   Dim tempTicket As String\n   '----- get the Computer Name\n       stEnviron = Environ$(\"COMPUTERNAME\")\n'-------------Set ticket printer associated with \"COMPUTERNAME\"\n        Select Case [stEnviron]\n    Case \"MyComputer\"\n        tempTicket = \"Ithaca USB Printer\"\n    Case \"SSP-REG1\"\n        tempTicket = \"Ithaca USB Printer\"\n    Case \"SSPREGA2\"\n        tempTicket = \"ITherm610\"\n\n End Select\n\n\n    '-----------------------------------------------------------------\n    '-------Set to ticket printer then back to Default---------------------------\n    '------------------------------------------------------------------\n\n     Dim prt As Printer\n     ' Get current default printer\n     Set prt = Application.Printer\n     ' Set default printer\n     application.Printer = Application.Printers(tempTicket)\n     ' Print something, e.g.\n     DoCmd.OpenForm \"couponPrintFForm\"\n     '\n     DoCmd.PrintOut acPages = 1\n          ' Restore original printer\n     Set Application.Printer = prt\n     DoCmd.Close acForm, \"couponPrintFForm\", acSave = yes\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "adodb"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1432736490, "post_id": 30485046, "comment_id": 49048889, "body": "Are you sure the &quot;below code&quot; is <b>exactly</b> what you have in the Visual Basic Editor? Because that code can&#39;t compile without the <code>_</code> line continuations."}], "answers": [{"tags": [], "owner": {"reputation": 457, "user_id": 4515125, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh3.googleusercontent.com/-rCNR0REYrms/AAAAAAAAAAI/AAAAAAAAABA/doHrukMdDwA/photo.jpg?sz=128", "display_name": "Christine Ross", "link": "https://stackoverflow.com/users/4515125/christine-ross"}, "is_accepted": true, "score": 1, "last_activity_date": 1432737304, "last_edit_date": 1495541665, "creation_date": 1432737304, "answer_id": 30485642, "question_id": 30485046, "link": "https://stackoverflow.com/questions/30485046/select-statement-for-excel-datasource/30485642#30485642", "title": "Select Statement for Excel Datasource", "body": "<p>When you set HDR=NO the column titles from the excel table will be ignored and it will be used internal names. See older answer: <a href=\"https://stackoverflow.com/questions/7684416/c-oledb-connection-string-issue\">c#, oledb connection string issue</a></p>\n"}], "owner": {"reputation": 13, "user_id": 4327682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24e719ef0d4858664ecce5d5eb4934c5?s=128&d=identicon&r=PG&f=1", "display_name": "Diwakar2u", "link": "https://stackoverflow.com/users/4327682/diwakar2u"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 30485642, "answer_count": 1, "score": 1, "last_activity_date": 1432882641, "creation_date": 1432735920, "last_edit_date": 1432882641, "question_id": 30485046, "link": "https://stackoverflow.com/questions/30485046/select-statement-for-excel-datasource", "title": "Select Statement for Excel Datasource", "body": "<p>I am connected to Excel sheet, which is acting as database. I need to select some records with where condition but I am getting error:</p>\n\n<blockquote>\n  <p>No value given for one or more required parameters</p>\n</blockquote>\n\n<p>by using below code:</p>\n\n<pre><code>Dim conn As Object\nDim rs As ADODB.Recordset\nSet rs = New ADODB.Recordset\nSet conn = CreateObject(\"ADODB.Connection\")\nXLName = \"C:\\Users\\X\\Desktop\\rawdata.xlsx\"\nconnString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source='\" &amp; \nXLName   &amp; \"';Extended Properties='Excel 12.0;HDR=NO;IMEX=1';\"\nconn.Open connString\nrs.Open (\"SELECT * FROM [data$] where industry='Government'\"), conn, \nadOpenDynamic, adLockReadOnly\nSheet1.Range(\"A2\").CopyFromRecordset rs\nrs.Close  \nconn.Close\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "comparison"], "comments": [{"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1432736031, "post_id": 30484967, "comment_id": 49048493, "body": "is d1 the column ref in the 2d array? e.g. D1 = E is column E?"}, {"owner": {"reputation": 125, "user_id": 4944966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sGUeJ.png?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/4944966/jay"}, "reply_to_user": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 1, "creation_date": 1432736252, "post_id": 30484967, "comment_id": 49048688, "body": "Sorry for the confusion. No. E is just the value I would put in column D if the value in column C was in ArrayE. I will try to make it a little clearer."}, {"owner": {"reputation": 125, "user_id": 4944966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sGUeJ.png?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/4944966/jay"}, "reply_to_user": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1432746850, "post_id": 30484967, "comment_id": 49056284, "body": "Ok, so I am new to Stackoverflow, so I might not understand everything. Someone just posted an answer to my question above and I was able to get it to work for my purposes. However, that post is no longer there. Does that mean the person deleted it?"}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1432800783, "post_id": 30484967, "comment_id": 49077769, "body": "Normally yes, either that or a moderator deleted it for one reason or another"}], "answers": [{"tags": [], "owner": {"reputation": 125, "user_id": 4944966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sGUeJ.png?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/4944966/jay"}, "is_accepted": true, "score": 0, "last_activity_date": 1432761486, "creation_date": 1432761486, "answer_id": 30493320, "question_id": 30484967, "link": "https://stackoverflow.com/questions/30484967/trying-to-compare-a-value-to-multiple-multiple-dimension-arrays/30493320#30493320", "title": "Trying to compare a value to multiple, multiple dimension arrays", "body": "<p>Ok, here is how I got it working. Most of this came from another person, but they deleted their comment so I can't thank them. </p>\n\n<pre><code>arrCols = Array(arrA, arrB, arrC, arrD, arrE)\narrVals = Array(\"Dog\", \"Cat\", \"Bird\", \"Monkey\", \"Blue\")\nFor i = 2 To rCnt\n    pID = Cells(i, 2).Value\n    pName = Cells(i, 3).Value\n    pGroup = Cells(i, 4).Value\n    ans = \"\"\n    For j = LBound(arrCols) To UBound(arrCols)\n        If Not IsError(Application.Match(pGroup, arrCols(j), 0)) Then\n            ans = arrVals(j)\n            Exit For\n        ElseIf Not IsError(Application.Match(pName, arrCols(j), 0)) Then\n            ans = arrVals(j)\n            Exit For\n        ElseIf Not IsError(Application.Match(pID, arrCols(j), 0)) Then\n            ans = arrVals(j)\n            Exit For\n        End If\n    Next j\n Cells(i, 5) = IIf(ans = \"\", \"Other\", ans)\n Next i\n</code></pre>\n\n<p>I created an array of arrays to search through. The i loop cycles through all rows. The j loop cycles through the arrays within the main array. The three IF statements are needed for checking the three different columns. The returned value is defaulted to \"Other\" unless it is found in one of the arrays. </p>\n\n<p>The only thing I was able to add to this code was the stuff needed to check three different columns in the row. </p>\n"}, {"comments": [{"owner": {"reputation": 125, "user_id": 4944966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sGUeJ.png?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/4944966/jay"}, "edited": false, "score": 0, "creation_date": 1432816895, "post_id": 30494166, "comment_id": 49089313, "body": "I am assuming the above code still only checks against the A column? Would I have to copy all of this code three times to compare columns A, B, and C to each array?"}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1432766266, "last_edit_date": 1432766266, "creation_date": 1432765634, "answer_id": 30494166, "question_id": 30484967, "link": "https://stackoverflow.com/questions/30484967/trying-to-compare-a-value-to-multiple-multiple-dimension-arrays/30494166#30494166", "title": "Trying to compare a value to multiple, multiple dimension arrays", "body": "<p>Here is an example of how to do it without looping</p>\n\n<pre><code>If Len(\",\" &amp; Join(ArrayA, \",\") &amp; \",\") &lt;&gt; Len(\",\" &amp; Replace(Join(ArrayA, \",\"), \",\" &amp; Range(\"A1\").Value &amp; \",\", \"\") &amp; \",\") Then\n    Range(\"D1\").Formula = \"Dog\"\nElseIf Len(\",\" &amp; Join(ArrayB, \",\") &amp; \",\") &lt;&gt; Len(\",\" &amp; Replace(Join(ArrayB, \",\"), \",\" &amp; Range(\"A1\").Value &amp; \",\", \"\") &amp; \",\") Then\n    Range(\"D1\").Formula = \"Cat\"\nElseIf Len(\",\" &amp; Join(ArrayC, \",\") &amp; \",\") &lt;&gt; Len(\",\" &amp; Replace(Join(ArrayC, \",\"), \",\" &amp; Range(\"A1\").Value &amp; \",\", \"\") &amp; \",\") Then\n    Range(\"D1\").Formula = \"Bird\"\nElseIf Len(\",\" &amp; Join(ArrayD, \",\") &amp; \",\") &lt;&gt; Len(\",\" &amp; Replace(Join(ArrayD, \",\"), \",\" &amp; Range(\"A1\").Value &amp; \",\", \"\") &amp; \",\") Then\n    Range(\"D1\").Formula = \"Monkey\"\nElseIf Len(\",\" &amp; Join(ArrayE, \",\") &amp; \",\") &lt;&gt; Len(\",\" &amp; Replace(Join(ArrayE, \",\"), \",\" &amp; Range(\"A1\").Value &amp; \",\", \"\") &amp; \",\") Then\n    Range(\"D1\").Formula = \"Blue\"\nElse\n    Range(\"D1\").Formula = \"Other\"\nEnd If\n</code></pre>\n\n<p>Join the array to a string then check the len against the len of the string with the keyword (Range(\"A1\")) replaced with nothing. Put a comma on either side to make sure it is the full word (Don't want something like Catfish to return as a Cat)</p>\n\n<p>And the same thing using InStr instead:</p>\n\n<pre><code>If InStr(1, \",\" &amp; Join(ArrayA, \",\") &amp; \",\", Range(\"A1\").Value) &gt; 0 Then\n    Range(\"D1\").Formula = \"Dog\"\nElseIf InStr(1, \",\" &amp; Join(ArrayB, \",\") &amp; \",\", Range(\"A1\").Value) &gt; 0 Then\n    Range(\"D1\").Formula = \"Cat\"\nElseIf InStr(1, \",\" &amp; Join(ArrayC, \",\") &amp; \",\", Range(\"A1\").Value) &gt; 0 Then\n    Range(\"D1\").Formula = \"Bird\"\nElseIf InStr(1, \",\" &amp; Join(ArrayD, \",\") &amp; \",\", Range(\"A1\").Value) &gt; 0 Then\n    Range(\"D1\").Formula = \"Monkey\"\nElseIf InStr(1, \",\" &amp; Join(ArrayE, \",\") &amp; \",\", Range(\"A1\").Value) &gt; 0 Then\n    Range(\"D1\").Formula = \"Blue\"\nElse\n    Range(\"D1\").Formula = \"Other\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 4944966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sGUeJ.png?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/4944966/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 30493320, "answer_count": 2, "score": 0, "last_activity_date": 1432766266, "creation_date": 1432735731, "last_edit_date": 1432736326, "question_id": 30484967, "link": "https://stackoverflow.com/questions/30484967/trying-to-compare-a-value-to-multiple-multiple-dimension-arrays", "title": "Trying to compare a value to multiple, multiple dimension arrays", "body": "<p>I have a spreadsheet of data in multiple columns. In VBA, I am trying to set a value in each row depending on the data in any one of three of the other columns. It will always be an OR comparison between those data and will need to return one of five values. </p>\n\n<p>So I have created five arrays (they are multidimensional due to reading them in as ranges, however, they could be one dimensional if needed, I suppose), and I was going to compare the three columns to those arrays using a bunch of IF-THEN statements to return the necessary value. </p>\n\n<p>Creating the arrays was easy enough, but I have no idea how to create the IF-THEN process correctly. An example of the process would be something like:</p>\n\n<pre><code>IF A1 is in ArrayA THEN\n\n D1=\"Dog\"\n\nELSEIF A1 is in ArrayB THEN\n\n D1=\"Cat\"\n\nELSEIF B1 is in ArrayC THEN\n\n D1=\"Bird\"\n\nELSEIF B1 is in ArrayD THEN\n\n D1=\"Monkey\"\n\nELSEIF C1 is in ArrayE THEN\n\n D1=\"Blue\"\n\nELSE\n\n D1=\"Other\"\n</code></pre>\n\n<p>I am not sure if this is the most efficient way to accomplish what I am trying to do, so I am definitely open to suggestions for a different approach. Thank you.</p>\n"}, {"tags": ["vba", "excel", "printing"], "comments": [{"owner": {"reputation": 2595, "user_id": 3897316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cf468fea626f3aec65a199e2f67b309?s=128&d=identicon&r=PG&f=1", "display_name": "Degustaf", "link": "https://stackoverflow.com/users/3897316/degustaf"}, "edited": false, "score": 0, "creation_date": 1432734200, "post_id": 30483987, "comment_id": 49047039, "body": "What error are you receiving?"}, {"owner": {"reputation": 37, "user_id": 4841120, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3867fc60e9d348cc4265102b4377b6ee?s=128&d=identicon&r=PG&f=1", "display_name": "Haider", "link": "https://stackoverflow.com/users/4841120/haider"}, "reply_to_user": {"reputation": 2595, "user_id": 3897316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cf468fea626f3aec65a199e2f67b309?s=128&d=identicon&r=PG&f=1", "display_name": "Degustaf", "link": "https://stackoverflow.com/users/3897316/degustaf"}, "edited": false, "score": 0, "creation_date": 1432734697, "post_id": 30483987, "comment_id": 49047471, "body": "runtime error 1004: The text you entered is not a valid refrence or defined name... this error is recieved at ActiveSheet.PageSetup.PrintArea = Arge"}], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 0, "last_activity_date": 1432734847, "last_edit_date": 1495541665, "creation_date": 1432734847, "answer_id": 30484607, "question_id": 30483987, "link": "https://stackoverflow.com/questions/30483987/set-print-area-in-excel-to-a-relative-reference/30484607#30484607", "title": "Set print area in excel to a relative reference", "body": "<p>Two things</p>\n\n<ol>\n<li>Avoid the use of <code>.Select</code>. You may want to see <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">This</a></li>\n<li>the <code>.PrintArea</code> takes a String (Range Address) and not the Range itself. You may want to see <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839804.aspx\" rel=\"nofollow noreferrer\">This</a></li>\n</ol>\n\n<p><strong>Code</strong>:</p>\n\n<pre><code>Sub Sample()\n    Dim ws As Worksheet\n    Dim Arge As Range\n\n    Set ws = ThisWorkbook.Sheets(\"Sheet1\")\n    Set Arge = ws.Range(\"A1:P37\")\n\n    With ws.PageSetup\n        .PrintTitleRows = \"\"\n        .PrintTitleColumns = \"\"\n        .PrintArea = Arge.Address\n    End With\nEnd Sub\n</code></pre>\n\n<p><strong>Note</strong>:</p>\n\n<p>If you really need to work with the <code>Selection</code> Object then ensure that it is a valid range. For example</p>\n\n<pre><code>'~~&gt; Check if what the user selected is a valid range\nIf TypeName(Selection) &lt;&gt; \"Range\" Then\n    MsgBox \"Select a range first.\"\n    Exit Sub\nElse\n    Set Arge = Selection\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 4841120, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3867fc60e9d348cc4265102b4377b6ee?s=128&d=identicon&r=PG&f=1", "display_name": "Haider", "link": "https://stackoverflow.com/users/4841120/haider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 903, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570476938, "creation_date": 1432733424, "last_edit_date": 1570476938, "question_id": 30483987, "link": "https://stackoverflow.com/questions/30483987/set-print-area-in-excel-to-a-relative-reference", "title": "Set print area in excel to a relative reference", "body": "<p>I want to create a loop which prints the selected range on workbook. I have a relative range selected which is stored as \"Arge\".</p>\n\n<p>I want to set the print area as the range selected.</p>\n\n<pre><code>Range(\"A1\").Select\nActiveCell.Offset(1, 0).Range(\"A1:P37\").Select\nDim Arge As Range\nSet Arge = Selection             'PROBLEM\n 'do loop and other code\n\nWith ActiveSheet.PageSetup\n    .PrintTitleRows = \"\"\n    .PrintTitleColumns = \"\"\nEnd With\nActiveSheet.PageSetup.PrintArea = Arge            'PROBLEM with Arge\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "answers": [{"comments": [{"owner": {"reputation": 45896, "user_id": 2442804, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/wBmyS.jpg?s=128&g=1", "display_name": "luk2302", "link": "https://stackoverflow.com/users/2442804/luk2302"}, "edited": false, "score": 0, "creation_date": 1432799608, "post_id": 30495992, "comment_id": 49077033, "body": "Thanks for the ideas, i do however think that most of them don&#180;t work for me: 1. that would maybe work for colors, but definitely not for placeholders 2. could work, don&#180;t like it, mostly because you can select the placeholder again after choosing a valid value 3. for now i have to go with that :/ 4. me neither. 1. - 3. I already display a dialog with 2-6 combo boxes. Laying textboxes over them might work, but its messy, i will try however try it. Showing even more dialogs would lead to a really uncomfortable UI."}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "reply_to_user": {"reputation": 45896, "user_id": 2442804, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/wBmyS.jpg?s=128&g=1", "display_name": "luk2302", "link": "https://stackoverflow.com/users/2442804/luk2302"}, "edited": false, "score": 0, "creation_date": 1432825517, "post_id": 30495992, "comment_id": 49096174, "body": "One thing I would say is &#39;keep it simple&#39;. I have learned from hard experience that the phrases &#39;innovative UI&#39; and &#39;Access&#39; don&#39;t go well together. Not to say that you can&#39;t do it, but it could well wind up being <i>much</i> more work than you anticipated."}, {"owner": {"reputation": 45896, "user_id": 2442804, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/wBmyS.jpg?s=128&g=1", "display_name": "luk2302", "link": "https://stackoverflow.com/users/2442804/luk2302"}, "edited": false, "score": 0, "creation_date": 1432832594, "post_id": 30495992, "comment_id": 49100855, "body": "I am just prototyping a new business model and wanted to know if there is an easy way I am missing - I am very aware of the fact that you cannot build good looking and well performing large scale applications with MS Access :D but is good for prototyping :)"}], "tags": [], "owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "is_accepted": true, "score": 1, "last_activity_date": 1432778447, "creation_date": 1432778447, "answer_id": 30495992, "question_id": 30483868, "link": "https://stackoverflow.com/questions/30483868/specify-format-set-up-placeholder-for-multi-column-combobox/30495992#30495992", "title": "Specify Format / set up placeholder for multi-column ComboBox", "body": "<p>Sounds like you are outgrowing what a ComboBox can easily provide in Access.\nFirst, combo options, and then my real suggestion.</p>\n\n<p>Here are your ComboBox options: </p>\n\n<ol>\n<li>Try conditional formatting, and see if you can get the combo's text box to change color if the value is null.</li>\n<li>You could make a UNION query that appends your placeholder record to the top of your Combo's real recordsource</li>\n<li>You could try to get your users used to the idea of 'blank' = null, and fix it with training.</li>\n<li>I have never seen a way to do different combo column colors in Access.</li>\n</ol>\n\n<p>My <strong>REAL</strong> suggestion: </p>\n\n<ol>\n<li>Ditch the combo and go with a modal dialog form that pops up for the user. This will let you format everything much more closely to what you want. </li>\n<li>You can put textboxes on your main form to display the placeholders.</li>\n<li>The user clicks on the textbox to open your dialog form.</li>\n</ol>\n"}], "owner": {"reputation": 45896, "user_id": 2442804, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/wBmyS.jpg?s=128&g=1", "display_name": "luk2302", "link": "https://stackoverflow.com/users/2442804/luk2302"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 744, "favorite_count": 0, "accepted_answer_id": 30495992, "answer_count": 1, "score": 1, "last_activity_date": 1432778447, "creation_date": 1432733138, "last_edit_date": 1432734190, "question_id": 30483868, "link": "https://stackoverflow.com/questions/30483868/specify-format-set-up-placeholder-for-multi-column-combobox", "title": "Specify Format / set up placeholder for multi-column ComboBox", "body": "<p>I want to show a placeholder in a <code>ComboBox</code> if no values has yet been selected or the previously selected one has been removed / deselected. For single-column <code>ComboBox</code>es that works like a charm using <code>@;\"My placeholder\"</code> as the <code>Format</code> of the <code>ComboBox</code>. So far so good.</p>\n\n<p>The problem starts if my <code>ComboBox</code> has more than one column. How can you set the placeholder value for a multi-column <code>ComboBox</code>? More general: How can you specify the <code>Format</code> for a multi-column <code>ComboBox</code>?</p>\n\n<p>Is it for example possible to color the first column green and the second one red? And if it <em>is</em> possible, please tell me <em>how</em>.<br>\nI could not find any specification on how to set the format for multiple columns. Neither on <a href=\"https://msdn.microsoft.com/en-us/library/office/ff198058.aspx\" rel=\"nofollow\">MSDN</a> nor on <a href=\"https://support.office.com/en-in/article/Specify-how-data-displays-by-using-custom-formatting-a5e5bcde-85da-4c7a-8164-1fe286636668\" rel=\"nofollow\">support.office.com</a>. </p>\n\n<p>P.S.: I do not care if a working solution relies on VBA or if it can achieved just by entering something in the layout or design view.</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1432733372, "post_id": 30483767, "comment_id": 49046400, "body": "Using a unique identifier? I am not able to understand your problem clearly. Could you explain in simple English without any technology jargon, maybe using some examples what is that you want?"}, {"owner": {"reputation": 143, "user_id": 4925271, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ffb52cd419559357c96bf911b506b226?s=128&d=identicon&r=PG&f=1", "display_name": "Nathaniel Bendinsky", "link": "https://stackoverflow.com/users/4925271/nathaniel-bendinsky"}, "reply_to_user": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1432733540, "post_id": 30483767, "comment_id": 49046527, "body": "I have a database containing a Latitude field. I want to use the content of that field as part of my query, but need to reformat it first. (Because it is in DMS, and I need Decimal for another function.)"}, {"owner": {"reputation": 45896, "user_id": 2442804, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/wBmyS.jpg?s=128&g=1", "display_name": "luk2302", "link": "https://stackoverflow.com/users/2442804/luk2302"}, "edited": false, "score": 0, "creation_date": 1432734664, "post_id": 30483767, "comment_id": 49047440, "body": "just wrap it inside another select: make a select query where you transform and do all the needed stuff, but leave the condition <code>decLat BETWEEN 39 AND 41</code> out. then create a second select in which you select <code>FROM</code> the previous select and now use the condition <code>decLat BETWEEN 39 AND 41</code>. Instead of <code>SELECT stuff FROM ... WHERE ... AND declat...</code> do something like <code>SELECT t.* FROM (SELECT stuff FROM ... WHERE ...) AS t WHERE declat...</code>"}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 4925271, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ffb52cd419559357c96bf911b506b226?s=128&d=identicon&r=PG&f=1", "display_name": "Nathaniel Bendinsky", "link": "https://stackoverflow.com/users/4925271/nathaniel-bendinsky"}, "edited": false, "score": 0, "creation_date": 1432735458, "post_id": 30484709, "comment_id": 49048079, "body": "That definitely is a more efficient way of retrieving the field content in VBA, but I suppose I didn&#39;t phrase the question clearly enough; how can I use the converted value (the output of the function) later in my query? I&#39;m currently attempting luk2302&#39;s wrapper method."}, {"owner": {"reputation": 143, "user_id": 4925271, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ffb52cd419559357c96bf911b506b226?s=128&d=identicon&r=PG&f=1", "display_name": "Nathaniel Bendinsky", "link": "https://stackoverflow.com/users/4925271/nathaniel-bendinsky"}, "edited": false, "score": 0, "creation_date": 1432736271, "post_id": 30484709, "comment_id": 49048706, "body": "Further, I am attempting to get the value from this function and pass it back to the query, as <a href=\"http://sqlexamples.info/SQL/inlineudf.htm\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 1330, "user_id": 2340071, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1b7df7b14d4acb8db0ae1931c4ecce27?s=128&d=identicon&r=PG", "display_name": "Don George", "link": "https://stackoverflow.com/users/2340071/don-george"}, "reply_to_user": {"reputation": 143, "user_id": 4925271, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ffb52cd419559357c96bf911b506b226?s=128&d=identicon&r=PG&f=1", "display_name": "Nathaniel Bendinsky", "link": "https://stackoverflow.com/users/4925271/nathaniel-bendinsky"}, "edited": false, "score": 0, "creation_date": 1432736701, "post_id": 30484709, "comment_id": 49049100, "body": "Can you clarify the question?  Once you have Lattitude, or in you code above, doubLat, what do you want to do with that?  Once you have the value in  a variable, you should be able to use that variable later in the script.  Just for a simple example, you can display it with Msgbox (&quot;Lattitude: &quot; &amp; Lattitude &amp; &quot;; converted: &quot; &amp; doubLat)."}, {"owner": {"reputation": 143, "user_id": 4925271, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ffb52cd419559357c96bf911b506b226?s=128&d=identicon&r=PG&f=1", "display_name": "Nathaniel Bendinsky", "link": "https://stackoverflow.com/users/4925271/nathaniel-bendinsky"}, "edited": false, "score": 0, "creation_date": 1432737110, "post_id": 30484709, "comment_id": 49049474, "body": "The problem is that I need to pass each value individually back the the query (SQL) itself; I&#39;m not trying to do anything with them in the VBA script except return the value. The code you posted doesn&#39;t seem to work for that, as any attempt at opening the query (which calls doubLat) now causes Access to stop responding. I&#39;ve added a link to the full current code of doubLat in the question."}, {"owner": {"reputation": 1330, "user_id": 2340071, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1b7df7b14d4acb8db0ae1931c4ecce27?s=128&d=identicon&r=PG", "display_name": "Don George", "link": "https://stackoverflow.com/users/2340071/don-george"}, "reply_to_user": {"reputation": 143, "user_id": 4925271, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ffb52cd419559357c96bf911b506b226?s=128&d=identicon&r=PG&f=1", "display_name": "Nathaniel Bendinsky", "link": "https://stackoverflow.com/users/4925271/nathaniel-bendinsky"}, "edited": false, "score": 0, "creation_date": 1432737552, "post_id": 30484709, "comment_id": 49049852, "body": "OK, I misunderstood - you have a function to convert from Lattitude to DoubLat that you want to use in a query.  I think you need to have a single output from the function, not multiple records (although I&#39;m not sure).  So you need to get the selection criteria inside the function - possibly as another argument or as part of the SQL string.  Will your WHERE clause get you a unique record from the table?"}, {"owner": {"reputation": 1330, "user_id": 2340071, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1b7df7b14d4acb8db0ae1931c4ecce27?s=128&d=identicon&r=PG", "display_name": "Don George", "link": "https://stackoverflow.com/users/2340071/don-george"}, "reply_to_user": {"reputation": 143, "user_id": 4925271, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ffb52cd419559357c96bf911b506b226?s=128&d=identicon&r=PG&f=1", "display_name": "Nathaniel Bendinsky", "link": "https://stackoverflow.com/users/4925271/nathaniel-bendinsky"}, "edited": false, "score": 0, "creation_date": 1432737965, "post_id": 30484709, "comment_id": 49050181, "body": "Another simpler approach is to write a query to convert Lattitude to DoubLat for all the records in the table (just create a query field with &quot;doubLat:CDbl(LatToDecimal(rs.Fields(i).Value))&quot; in it, and use this query as the input to the next query.  Then you have all the original fields and the calculated field for each record."}, {"owner": {"reputation": 143, "user_id": 4925271, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ffb52cd419559357c96bf911b506b226?s=128&d=identicon&r=PG&f=1", "display_name": "Nathaniel Bendinsky", "link": "https://stackoverflow.com/users/4925271/nathaniel-bendinsky"}, "edited": false, "score": 0, "creation_date": 1432738008, "post_id": 30484709, "comment_id": 49050217, "body": "I figured I would need a single output, since the SQL seems to require a return value. <code>strSQL</code> was meant to bring the criteria in; that&#39;s why it&#39;s used as a parameter for <code>rs.OpenRecordset</code>. The full WHERE clause will not return a unique record. (The freeze mentioned in the last comment was because I had forgotten to MoveNext. It has since been fixed, and decLat now has a value, but it is always the same one.)"}, {"owner": {"reputation": 143, "user_id": 4925271, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ffb52cd419559357c96bf911b506b226?s=128&d=identicon&r=PG&f=1", "display_name": "Nathaniel Bendinsky", "link": "https://stackoverflow.com/users/4925271/nathaniel-bendinsky"}, "edited": false, "score": 0, "creation_date": 1432738458, "post_id": 30484709, "comment_id": 49050551, "body": "I may be looking in the wrong place, but when I put that <code>doubLat:...</code> line as a Field in my query (design view) I get an error stating that there may be an invalid period or parentheses, highlighting the dot in <code>Fields(&quot;Latitude&quot;).Value</code>. (<code>i</code> replaced with <code>&quot;Latitude&quot;</code> because I&#39;m not sure where the <code>i</code> is coming from.) EDIT: <code>Expr1: doubLat([Latitude])</code> is also nonfunctional, stating that the expression is typed incorrectly."}, {"owner": {"reputation": 1330, "user_id": 2340071, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1b7df7b14d4acb8db0ae1931c4ecce27?s=128&d=identicon&r=PG", "display_name": "Don George", "link": "https://stackoverflow.com/users/2340071/don-george"}, "reply_to_user": {"reputation": 143, "user_id": 4925271, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ffb52cd419559357c96bf911b506b226?s=128&d=identicon&r=PG&f=1", "display_name": "Nathaniel Bendinsky", "link": "https://stackoverflow.com/users/4925271/nathaniel-bendinsky"}, "edited": false, "score": 0, "creation_date": 1432746128, "post_id": 30484709, "comment_id": 49055860, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/78936/discussion-between-don-george-and-nathaniel-bendinsky\">continue this discussion in chat</a>."}, {"owner": {"reputation": 1330, "user_id": 2340071, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1b7df7b14d4acb8db0ae1931c4ecce27?s=128&d=identicon&r=PG", "display_name": "Don George", "link": "https://stackoverflow.com/users/2340071/don-george"}, "reply_to_user": {"reputation": 143, "user_id": 4925271, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ffb52cd419559357c96bf911b506b226?s=128&d=identicon&r=PG&f=1", "display_name": "Nathaniel Bendinsky", "link": "https://stackoverflow.com/users/4925271/nathaniel-bendinsky"}, "edited": false, "score": 0, "creation_date": 1432750351, "post_id": 30484709, "comment_id": 49058229, "body": "sorry - try DoubLat:cdbl(LatToDecimal(lattitude)).  The other syntax was for the script and the recordset, and I forgot to change it to work in the query."}], "tags": [], "owner": {"reputation": 1330, "user_id": 2340071, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1b7df7b14d4acb8db0ae1931c4ecce27?s=128&d=identicon&r=PG", "display_name": "Don George", "link": "https://stackoverflow.com/users/2340071/don-george"}, "is_accepted": false, "score": 1, "last_activity_date": 1432735094, "creation_date": 1432735094, "answer_id": 30484709, "question_id": 30483767, "link": "https://stackoverflow.com/questions/30483767/ms-access-get-field-value-run-through-vba-function-and-send-to-sql/30484709#30484709", "title": "MS-Access Get field value, run through VBA function, and send to SQL", "body": "<p>rs.fields(\"Lattitude\").value will give you the contents of that field - is that what you mean?  As far as associating it with a specific record, I usually have a loop something like</p>\n\n<pre><code>set rs= ...\nrs.movefirst\ndo while not rs.eof \n   ...\n   Lattidue=rs.fields(\"Lattitude\").value\n   ...\n   rs.movenext\n   loop\n</code></pre>\n\n<p>This deals with one record of the recordset at a time, so you can associate the Lattitude to any other fields of the same record</p>\n"}], "owner": {"reputation": 143, "user_id": 4925271, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ffb52cd419559357c96bf911b506b226?s=128&d=identicon&r=PG&f=1", "display_name": "Nathaniel Bendinsky", "link": "https://stackoverflow.com/users/4925271/nathaniel-bendinsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8644, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1432740998, "creation_date": 1432732918, "last_edit_date": 1432740998, "question_id": 30483767, "link": "https://stackoverflow.com/questions/30483767/ms-access-get-field-value-run-through-vba-function-and-send-to-sql", "title": "MS-Access Get field value, run through VBA function, and send to SQL", "body": "<p>When calling functions from an SQL SELECT statement (Ex <code>SELECT doubLat(\"SELECT [Map index].[Latitude] FROM [Map index]\") AS decLat FROM</code>...) how can you return the value of each item individually? I expect this is done more form the method (here in VBA) than the SQL itself.</p>\n\n<p>Note that I am not referring to changing any field values in the database itself; the goal is simply to pass a modified version into SQL for further processing. The method I currently have is shown below.</p>\n\n<pre><code>Function doubLat(strSQL As String) As Double\n    Dim db As Database\n    Dim rs As DAO.Recordset\n    Set db = CurrentDb\n\n    If (strSQL &lt;&gt; \"\") Then\n        Set rs = db.OpenRecordset(strSQL)\n        For i = 0 To rs.Fields.Count - 1 'For each field in the recordset'\n            If (rs.Fields(i).Name = \"Latitude\") Then\n                doubLat = CDbl(LatToDecimal(rs.Fields(i).Value))\n                MsgBox (doubLat) 'debug message'\n            End If\n        Next i\n        rs.Close\n    End If\nEnd Function\n</code></pre>\n\n<p>LatToDecimal takes a DMS latitude value and returns a Decimal latitude value as a String. doubLat (shown above) serves as a wrapper to convert that String to a Double in order to perform further operations.</p>\n\n<p>How can individual values retrieved from such a function be passed back to an SQL query and associated (preferably temporarily) with the records that generated them if the goal is to use this data in another function later in the query?</p>\n\n<p>EDIT: Further information about the query below.</p>\n\n<p><code>SELECT</code>...<code>[Map index].[Map_Date], doubLat(\"SELECT [Map index].[Latitude] FROM [Map index]\") AS decLat</code>\n<code>FROM [Map index]</code> <code>WHERE</code>...<code>AND (decLat BETWEEN 39 AND 41)</code></p>\n\n<p>The last condition shown (<code>decLat BETWEEN 39 AND 41</code>) is to eventually be replaced with a conditional using the haversine function and a user-defined distance.</p>\n\n<p>An example of what I am attempting to do is <a href=\"http://sqlexamples.info/SQL/inlineudf.htm\" rel=\"nofollow\">here</a>, with the caveat that I need to access the \"new\" data (output) later in the query.</p>\n\n<p>Current doubLat function is <a href=\"http://pastebin.com/Lv6ZyRX7\" rel=\"nofollow\">here</a>. (Edit: Error caused by lack of <code>rs.MoveNext</code> has since been corrected.)</p>\n\n<p>Final Results: As suspected, the solution was fairly simple. The <code>SELECT</code> statement needed to call <code>doubLat([Map index].[Latitude]) AS decLat</code>, where doubLat is as shown below.</p>\n\n<pre><code>Function doubLat(ByVal latIn As String) As Double\n    Dim newLat As Double\n    newLat = CDbl(LatToDecimal(latIn))\n    doubLat = newLat\nEnd Function\n</code></pre>\n\n<p>Note that this solution does not yet account properly for null values in <code>[Map index].[Latitude]</code> and will set <code>decLat</code> to <code>#Error</code> for those records.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1432736130, "post_id": 30483661, "comment_id": 49048582, "body": "One somewhat complicated solution that I can think of involves keeping a specific &quot;Master&quot; workbook open at all times, putting in a timer that searches for other open workbooks and then linking a WithEvents workbook variable in the Master workbook to the other open workbooks.  This way you can catch the events in the other workbooks.  This is somewhat complicated to implement however.  Is this the type of solution you&#39;re looking for?"}, {"owner": {"reputation": 207, "user_id": 3298462, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/lnt6o.jpg?s=128&g=1", "display_name": "Mr. J", "link": "https://stackoverflow.com/users/3298462/mr-j"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1432801085, "post_id": 30483661, "comment_id": 49077957, "body": "@OpiesDad I can see the potential in this solution, however I will be rolling this code out for other people to use and the thought of having a hidden master workbook open in the background of other users&#39; computers strikes me with an element of instability/unpredictability?.."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1432821077, "post_id": 30483661, "comment_id": 49092499, "body": "You need the &quot;Personal.xlsb&quot; workbook open either way?!  Won&#39;t the users need to have SOME workbook open?  nbayly&#39;s solution is a simplified version of what I was talking about, but again, it needs to be in an open workbook.  Their solution does not consider whether the users may open a different excel file in a different instance of Excel.  If they only open things in the SAME instance of Excel, it would work.  See comment on their answer."}], "answers": [{"comments": [{"owner": {"reputation": 207, "user_id": 3298462, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/lnt6o.jpg?s=128&g=1", "display_name": "Mr. J", "link": "https://stackoverflow.com/users/3298462/mr-j"}, "edited": false, "score": 0, "creation_date": 1432800864, "post_id": 30493906, "comment_id": 49077828, "body": "Thanks for your reply! How does this work in conjunction with a &#39;Workbook_BeforeClose&#39; event?"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 207, "user_id": 3298462, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/lnt6o.jpg?s=128&g=1", "display_name": "Mr. J", "link": "https://stackoverflow.com/users/3298462/mr-j"}, "edited": false, "score": 0, "creation_date": 1432821364, "post_id": 30493906, "comment_id": 49092720, "body": "As mentioned in my other comment, this will only work if the user&#39;s open all excel files in the same instance of Excel.  @Mr. J, this code will give you the events in the application for ANY workbook, but it only uses Application level events.  I haven&#39;t done this, but in research I found this documentation: <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.appevents_workbookbeforecloseeventhandler.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/&hellip;</a> that should help in setting up the workbook_beforeclose event on the application level."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1432836691, "post_id": 30493906, "comment_id": 49103263, "body": "@OpiesDad wouldn&#39;t other instances of Excel still be using the same <code>Personal.xlsb</code> template and hence have the VBA code active on any and all instances of Excel? @Mr. J my apologies as I missed changing the event from the source code. You would not call it from the <code>Workbook_BeforeClose</code> but rather from <code>AppEvents_WorkbookBeforeCloseEventHandler</code> event that OpiesDad kindly provided. I will correct my answer for future reference."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1432843616, "post_id": 30493906, "comment_id": 49107349, "body": "If you double-click on an Excel file, it will generally either open Excel if you don&#39;t have it open already or it will open the workbook using the open instance of Excel.  If instead, while you already have Excel open, you click on the Excel icon to open another instance of Excel, then use Open file from the menu, you now have TWO open Excel instances (applications).  This code will only look at the one that your Personal.xlsb file is open in and will not run in any files open in the other Excel instances."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1432843762, "post_id": 30493906, "comment_id": 49107433, "body": "@nbayly I&#39;m not sure the Workbookbeforecloseeventhandler works that way.  If you read the documentation, it looks like it&#39;s more complicated than that....you will need to create a Delegate Sub.  I am not familiar with this and didn&#39;t really have time to play with it to figure out exactly how it works, so thought providing the documentation would at least help."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1432845804, "post_id": 30493906, "comment_id": 49108481, "body": "My understanding is that <b>each</b> instance of Excel opens its own copy of <code>Personal.xlsb</code> automatically. There might be issues if the document is not set to be shared but seems those are fixable. And though the scope of each <code>Personal.xlsb</code> is walled by its Excel instance, as each instance has it&#39;s own version running you are still covering your requirements."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1432846190, "post_id": 30493906, "comment_id": 49108711, "body": "I have not tested that event in particular but when setting the <code>Application</code> object to pass events to the AppEvents variable per <code>WithEvents</code> option, all regular events that pre-built objects (ie <code>ThisWorkbook</code>) have can also be triggered for application events. Hence <code>AppEvents_WorkbookBeforeCloseEventHandler</code> should work exactly as calling a <code>Workbook.BeforeClose</code> event. Full disclosure: I have not tested and basing just on online sources, please feel free to correct me. More info: <a href=\"http://www.cpearson.com/excel/appevent.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/appevent.aspx</a>"}], "tags": [], "owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "is_accepted": false, "score": 0, "last_activity_date": 1432836861, "last_edit_date": 1432836861, "creation_date": 1432764221, "answer_id": 30493906, "question_id": 30483661, "link": "https://stackoverflow.com/questions/30483661/personal-vba-code-workbook-beforeclose-event-across-all-any-open-workbook/30493906#30493906", "title": "Personal VBA code Workbook - BeforeClose event across all/any open workbook", "body": "<p>This can be accomplished by trapping the Application event rather than the Workbook event.</p>\n\n<p>Source: <a href=\"http://www.mrexcel.com/forum/excel-questions/488682-automatically-run-workbook-event-workbook-open.html\" rel=\"nofollow\">http://www.mrexcel.com/forum/excel-questions/488682-automatically-run-workbook-event-workbook-open.html</a></p>\n\n<pre><code>Private WithEvents AppEvents As Application\n\nPrivate Sub Workbook_Open()\n\n    Set AppEvents = Application\n\nEnd Sub\n\nPrivate Sub AppEvents_WorkbookBeforeCloseEventHandler(ByVal Wb As Workbook)\n\n    If Not Wb Is Me Then\n        Call YourMacro(Wb)\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Just encapsulate your code in a Sub and call it where \"YourMacro\" is indicated.</p>\n\n<p>Hope this helps. Cheers.</p>\n"}], "owner": {"reputation": 207, "user_id": 3298462, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/lnt6o.jpg?s=128&g=1", "display_name": "Mr. J", "link": "https://stackoverflow.com/users/3298462/mr-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1313, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1432836861, "creation_date": 1432732644, "last_edit_date": 1432739215, "question_id": 30483661, "link": "https://stackoverflow.com/questions/30483661/personal-vba-code-workbook-beforeclose-event-across-all-any-open-workbook", "title": "Personal VBA code Workbook - BeforeClose event across all/any open workbook", "body": "<p>I have written a <code>Workbook_BeforeClose</code> event in my <code>PERSONAL.XLSB</code> that I would like to apply to all/any open workbooks.</p>\n\n<p>The code is designed to look for a specific string of text in the workbook title and flag a message box if the string of text is found.</p>\n\n<pre><code>Public Sub Workbook_BeforeClose(Cancel As Boolean)\nDim pos As Integer\nDim iRet As Integer\nDim strPrompt As String\nDim strTitle As String\n\n' Test\npos = InStr(ThisWorkbook.Name, \"&lt;Insert String here&gt;\")\n\nIf pos &lt;&gt; 0 Then\n\n    ' Prompt\n    strPrompt = \"&lt;Message&gt;\"\n\n    ' Dialog's Title\n    strTitle = \"&lt;Title&gt;\"\n\n    ' Display MessageBox\n    iRet = MsgBox(strPrompt, vbYesNo, strTitle)\n\n    ' Check pressed button\n    If iRet = vbNo Then\n        Cancel = True\n    Else\n    End If\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I appreciate that because this macro lies within my <code>PERSONAL.XLSB</code> workbook that it applies solely to itself only.</p>\n\n<p>I am looking for a solution where a personal before close macro could apply to all/any open workbooks that do not themselves contain macros.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432732510, "post_id": 30483394, "comment_id": 49045683, "body": "<code>I used below code but other excel also become insible.</code> Open your file in a separate Excel Instance or open the rest of the file in separate instance :)"}], "answers": [{"tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 0, "last_activity_date": 1432736544, "creation_date": 1432736544, "answer_id": 30485303, "question_id": 30483394, "link": "https://stackoverflow.com/questions/30483394/excel-vb-insivible-work-sheet/30485303#30485303", "title": "Excel VB - insivible work sheet", "body": "<p>If I see well what you mean, I think the best thing to do is to make your <code>xlsm</code> file an add-in. In order to do this: </p>\n\n<p>1) Call the <code>UserForm4.Show</code> into the <code>Workbook_Open</code> event of your <code>.xlsm</code>;</p>\n\n<p>2) Save your workbook as <em>Excel Add-In</em> (extensions: <code>.xla</code> or the newer <code>.xlam</code>);</p>\n\n<p>3) Enable the add-in on Excel, so every time that a workbook is opened you can show the form and not the entire workbook, so avoiding also to let the <code>EXCEL.EXE</code> instance open (that will remain so if the <code>Application</code> is <code>Visible=False</code>, because no user would see it after closing the workbook they're working with).  </p>\n\n<p>Add-ins have a great power in terms of use and distribution, I suggest you to get started from <a href=\"http://pcsupport.about.com/od/fileextensions/f/xlamfile.htm\" rel=\"nofollow\">here</a> and go deeper into this very nice tool. </p>\n"}, {"tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": false, "score": 0, "last_activity_date": 1432776016, "creation_date": 1432776016, "answer_id": 30495680, "question_id": 30483394, "link": "https://stackoverflow.com/questions/30483394/excel-vb-insivible-work-sheet/30495680#30495680", "title": "Excel VB - insivible work sheet", "body": "<p>Add the following code to the user form...</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    ThisWorkbook.Windows(1).Visible = False\nEnd Sub\n\nPrivate Sub UserForm_Terminate()\n    ThisWorkbook.Windows(1).Visible = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4866999, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/377c5314fa1fee4a9feb86d3b8c56e47?s=128&d=identicon&r=PG&f=1", "display_name": "Gaus Shaikh", "link": "https://stackoverflow.com/users/4866999/gaus-shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1432776016, "creation_date": 1432731967, "last_edit_date": 1531164843, "question_id": 30483394, "link": "https://stackoverflow.com/questions/30483394/excel-vb-insivible-work-sheet", "title": "Excel VB - insivible work sheet", "body": "<p>I want to open only the userform when I open the excel sheet. I used the below code but other excel also become invisible. I want to display other open excel file and only macro contained file should be disable. </p>\n\n<pre><code>Application.Visible = False\nUserForm4.Show\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "function", "vector"], "comments": [{"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "edited": false, "score": 0, "creation_date": 1432731696, "post_id": 30482688, "comment_id": 49045037, "body": "what is <code>FX</code> in your code, did you mean to have <code>FV</code> instead"}, {"owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "edited": false, "score": 0, "creation_date": 1432731697, "post_id": 30482688, "comment_id": 49045042, "body": "You ReDim FX but declare and return FV.  I don&#39;t see how it would work in either case like that.  Is this code an exact copy of your working code?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4944404"}, "edited": false, "score": 0, "creation_date": 1432732302, "post_id": 30482688, "comment_id": 49045535, "body": "yes, I meant FV, just typing mistake. I&#39;ve already corrected it.  in my original code it&#39;s the same and it&#39;s not working"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1432732495, "post_id": 30482688, "comment_id": 49045676, "body": "Your presumption is wrong. It works the same kind also for column vectors. But it returns a row vector in both cases. Shall it return a row vector if a row vector is given and a column vector if a column vector is given?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4944404"}, "edited": false, "score": 0, "creation_date": 1432927966, "post_id": 30484142, "comment_id": 49148765, "body": "thank you very much, this is exactly what I needed. I have a question though...why would I want to avoid using &quot;Option Base 1&quot;? is it just to have a one line less in the code or can it cause any problems?"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1433060437, "post_id": 30484142, "comment_id": 49182480, "body": "This is simply my convention because i can not rely on Option Base. See <a href=\"https://msdn.microsoft.com/en-us/library/aa266179%28v=vs.60%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa266179%28v=vs.60%29.aspx</a> : &quot;Option Base does not affect ParamArray (or the Array function, when qualified with the name of its type library, for example VBA.Array)&quot;. And Objects from outside the module will also not being affected. So in my opinion it is better to declare the LBound directly."}], "tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": false, "score": 0, "last_activity_date": 1432733788, "creation_date": 1432733788, "answer_id": 30484142, "question_id": 30482688, "link": "https://stackoverflow.com/questions/30482688/vba-how-can-i-make-my-function-work-for-both-vertical-and-horizontal-vector/30484142#30484142", "title": "VBA: How can I make my function work for both vertical and horizontal vector", "body": "<p>I suspect it shall it return a row vector if a row vector is given and a column vector if a column vector is given. If so then:</p>\n\n<pre><code>Public Function TestFunction(arr As Range) As Variant\n Dim i As Integer\n Dim j As Integer\n Dim NoCols As Integer\n Dim NoRws As Integer\n Dim FV() As Double\n\n NoCols = arr.Columns.Count\n NoRws = arr.Rows.Count\n\n If NoCols = 1 Then\n  ReDim FV(1 To NoRws, 1 To 1) ' column vector = multiple rows, 1 column = FV(row, 1), using (1 to ...) DIMs to avoid Option Base 1\n  For i = 1 To NoRws\n   x = arr.Cells(i, 1)\n   FV(i, 1) = x + 5\n  Next i\n ElseIf NoRws = 1 Then\n  ReDim FV(1 To 1, 1 To NoCols) ' row vector = 1 row, multiple columns = FV(1, column)\n  For j = 1 To NoCols\n   y = arr.Cells(1, j)\n   FV(1, j) = y + 5\n  Next j\n End If\n\n TestFunction = FV()\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1432737831, "post_id": 30484565, "comment_id": 49050089, "body": "In this special case your solution is better. But you also working with a two dimensional array. And one should know how those kind of arrays work. What if it explicit shall not work with a block of cells? And/Or if the function for row vectors is different from the function for column vectors?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1432738455, "post_id": 30484565, "comment_id": 49050547, "body": "@AxelRichter  You are correct..............special cases WOULD require special approaches..............for the posted example of adding <b>5</b> to an arbitrary array, my approach will work whether the input is a single row or a single column or a simple block of cells.  <b>The function cells must be inserted in an arrangement that is isomorphic to the input arrangement.</b>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1432734750, "creation_date": 1432734750, "answer_id": 30484565, "question_id": 30482688, "link": "https://stackoverflow.com/questions/30482688/vba-how-can-i-make-my-function-work-for-both-vertical-and-horizontal-vector/30484565#30484565", "title": "VBA: How can I make my function work for both vertical and horizontal vector", "body": "<p>Don't fight against using <strong>two dimensional</strong> arrays.</p>\n\n<p>This will work for a single row or a single column or a block of cells:</p>\n\n<pre><code>Option Base 1\n\nPublic Function TestFunction(arr As Range) As Variant\n   Dim i As Long\n   Dim j As Long\n   Dim NoCols As Long\n   Dim NoRws As Long\n   Dim FV()\n\n   NoCols = arr.Columns.Count\n   NoRws = arr.Rows.Count\n   FV = arr\n\n   For i = 1 To NoRws\n      For j = 1 To NoCols\n         FV(i, j) = FV(i, j) + 5\n      Next j\n   Next i\n\n   TestFunction = FV()\n\nEnd Function\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/NGDCm.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4944404"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 669, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1432734750, "creation_date": 1432730258, "last_edit_date": 1432732152, "question_id": 30482688, "link": "https://stackoverflow.com/questions/30482688/vba-how-can-i-make-my-function-work-for-both-vertical-and-horizontal-vector", "title": "VBA: How can I make my function work for both vertical and horizontal vector", "body": "<p>I have a vector (both row and column) and I want to calculate a specific function (e.g. x+5) for each value in that vector and I want to have it displayed in the specified array of cells. I wrote a function and in Excel it works for a single cell or for row vector. But when I try it on column vector it returns the value computed for the first cell for all values in the array. Can you please help me, what I did wrong or why it is not working?\nMy code lookd like this</p>\n\n<p>Option Base 1</p>\n\n<pre><code>Public Function TestFunction(arr As Range) As Variant\n Dim i As Integer\n Dim j As Integer\n Dim NoCols As Integer\n Dim NoRws As Integer\n Dim FV() As Double\n\n NoCols = arr.Columns.Count\n NoRws = arr.Rows.Count\n\n\nIf NoCols = 1 Then\n  ReDim FV(NoRws)\n     For i = 1 To NoRws\n         x = arr.Rows(i)\n         FV(i) = x + 5\n    Next i\n\nElse\n ReDim FV(NoCols)\n    For j = 1 To NoCols\n     y = arr.Columns(j)\n     FV(j) = y + 5\n    Next j\n\nEnd If\n\nTestFunction = FV()\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 4882144, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d0189bd0ac0ffa39aa4af0f0e001fb21?s=128&d=identicon&r=PG&f=1", "display_name": "Meringue90", "link": "https://stackoverflow.com/users/4882144/meringue90"}, "edited": false, "score": 0, "creation_date": 1432731341, "post_id": 30482416, "comment_id": 49044759, "body": "Unfortunately, this does not solve the problem.  I still get an error on the &quot;InputSheet.Range...&quot; line."}, {"owner": {"reputation": 746, "user_id": 4733869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f0b856d3215d1cbde059e0d411ab55?s=128&d=identicon&r=PG&f=1", "display_name": "Dawid", "link": "https://stackoverflow.com/users/4733869/dawid"}, "reply_to_user": {"reputation": 5, "user_id": 4882144, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d0189bd0ac0ffa39aa4af0f0e001fb21?s=128&d=identicon&r=PG&f=1", "display_name": "Meringue90", "link": "https://stackoverflow.com/users/4882144/meringue90"}, "edited": false, "score": 0, "creation_date": 1432731835, "post_id": 30482416, "comment_id": 49045176, "body": "@Meringue90: Check what value have <code>LastRow</code> and <code>LastColumnNum</code> when an error occurs"}, {"owner": {"reputation": 5, "user_id": 4882144, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d0189bd0ac0ffa39aa4af0f0e001fb21?s=128&d=identicon&r=PG&f=1", "display_name": "Meringue90", "link": "https://stackoverflow.com/users/4882144/meringue90"}, "edited": false, "score": 1, "creation_date": 1432732902, "post_id": 30482416, "comment_id": 49046014, "body": "HOLY MACKEREL! IT WORKED!  Thank you!  AMAZING!"}], "tags": [], "owner": {"reputation": 746, "user_id": 4733869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f0b856d3215d1cbde059e0d411ab55?s=128&d=identicon&r=PG&f=1", "display_name": "Dawid", "link": "https://stackoverflow.com/users/4733869/dawid"}, "is_accepted": true, "score": 2, "last_activity_date": 1432729598, "creation_date": 1432729598, "answer_id": 30482416, "question_id": 30482006, "link": "https://stackoverflow.com/questions/30482006/importing-data-from-another-worksheet-using-getopenfilename-default-method-of-o/30482416#30482416", "title": "Importing Data from Another Worksheet using GetOpenFilename &quot;Default Method of Object Range Failed&quot;", "body": "<p><code>LastColumn</code> is <code>Range</code> and causing problem in <code>Cells(FirstRow, LastColumn)</code> about <code>Cells</code> -> <a href=\"https://msdn.microsoft.com/en-us/library/ff196273(v=office.14).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/ff196273(v=office.14).aspx</a></p>\n\n<p>Try this little modifications:</p>\n\n<pre><code>  'Find last Column of input file\n   Dim LastColumnNum As Integer\n   Set LastColumn = InputSheet.Cells.Find(What:=\"*\", _\n                                     after:=InputSheet.Cells(1), _\n                                     Searchorder:=xlByColumns, _\n                                     SearchDirection:=xlPrevious, _\n                                     MatchCase:=False)\n\n    LastColumnNum = LastColumn.Column\n\nOutputSheet.Range(OutputSheet.Cells(FirstRow, 2), _\n    OutputSheet.Cells(LastRow, 2)).Value = _\nInputSheet.Range(InputSheet.Cells(FirstRow, LastColumnNum), _\n    InputSheet.Cells(LastRow, LastColumnNum)).Value\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 4882144, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d0189bd0ac0ffa39aa4af0f0e001fb21?s=128&d=identicon&r=PG&f=1", "display_name": "Meringue90", "link": "https://stackoverflow.com/users/4882144/meringue90"}, "edited": false, "score": 0, "creation_date": 1432732204, "post_id": 30482527, "comment_id": 49045453, "body": "This is pretty close, it doesn&#39;t give me errors, but when I look at the first column of the Output sheet, it is all zeros.  It does not actually copy the data."}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1432729868, "creation_date": 1432729868, "answer_id": 30482527, "question_id": 30482006, "link": "https://stackoverflow.com/questions/30482006/importing-data-from-another-worksheet-using-getopenfilename-default-method-of-o/30482527#30482527", "title": "Importing Data from Another Worksheet using GetOpenFilename &quot;Default Method of Object Range Failed&quot;", "body": "<p>Try this :</p>\n\n<pre><code>Option Explicit\nPublic Sub ImportData()\nDim InputFilename As String\nDim OutputFilename As String\nDim FirstRow As Integer\nDim LastRow As Integer\nDim LastColumn As Integer\n\nDim InputFile As Workbook\nDim OutputFile As Workbook\nDim OutputSheet As Worksheet\nDim InputSheet As Worksheet\n\nDim UsedRange As Range\n\n\n'Copy data from user-defined sheet to current open sheet\n\n'User selects file to export data from\nInputFilename = Application.GetOpenFilename()\nSet InputFile = Workbooks.Open(InputFilename)\nSet InputSheet = InputFile.Sheets(\"Total Inventory\")\n\n'User defines file to import into\nOutputFilename = Application.GetOpenFilename()\nSet OutputFile = Workbooks.Open(OutputFilename)\nSet OutputSheet = OutputFile.Sheets(\"Total Inventory\")\n\n\n'Find last Row of input file\nFirstRow = 7\nLastRow = InputSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n'Find last Column of input file\nLastColumn = InputSheet.Cells(1, Columns.Count).End(xlToLeft).Column\n\n'Copy the data\nOutputSheet.Range(OutputSheet.Cells(FirstRow, 2), _\n                    OutputSheet.Cells(LastRow, 2)).Value = _\nInputSheet.Range(InputSheet.Cells(FirstRow, LastColumn), _\n                    InputSheet.Cells(LastRow, LastColumn)).Value\n\nInputFile.Close\n\nEnd Sub\n</code></pre>\n\n<p>You were inputing a Range into Cells() so it could work</p>\n"}], "owner": {"reputation": 5, "user_id": 4882144, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d0189bd0ac0ffa39aa4af0f0e001fb21?s=128&d=identicon&r=PG&f=1", "display_name": "Meringue90", "link": "https://stackoverflow.com/users/4882144/meringue90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "accepted_answer_id": 30482416, "answer_count": 2, "score": 0, "last_activity_date": 1432799016, "creation_date": 1432728598, "last_edit_date": 1592644375, "question_id": 30482006, "link": "https://stackoverflow.com/questions/30482006/importing-data-from-another-worksheet-using-getopenfilename-default-method-of-o", "title": "Importing Data from Another Worksheet using GetOpenFilename &quot;Default Method of Object Range Failed&quot;", "body": "<p>I am trying to create a button that imports data from a user-selected file (last month) to a user-selected file (this month).</p>\n<p>I define my variables, and all works well until I get to the actual importing bit, where I set the range from the first workbook equal to the range of the second workbook, I get the following Error:</p>\n<blockquote>\n<p>Run-time error '1004'</p>\n<p>Method '_Default' of object 'Range' failed</p>\n</blockquote>\n<p>Both documents have the same number of rows.  Here is the Applicable Code:</p>\n<pre><code>Option Explicit\nPublic Sub ImportData()\n    Dim InputFilename As Variant\n    Dim OutputFilename As Variant\n    Dim InputFile As Variant\n    Dim InputSheet As Worksheet\n    Dim OutputFile As Variant\n    Dim OutputSheet As Worksheet\n\n      'Copy data from user-defined sheet to current open sheet\n      \n      'User selects file to export data from\n          InputFilename = Application.GetOpenFilename()\n              Set InputFile = Workbooks.Open(InputFilename)\n              Set InputSheet = InputFile.Sheets(&quot;Total Inventory&quot;)\n\n      'User defines file to import into\n          OutputFilename = Application.GetOpenFilename()\n              Set OutputFile = Workbooks.Open(OutputFilename)\n              Set OutputSheet = OutputFile.Sheets(&quot;Total Inventory&quot;)\n\nDim FirstRow As Integer\nDim LastRow As Integer\nDim UsedRange As Range\nDim LastColumn As Range\n\n  'Find last Row of input file\n    InputSheet.Activate\n    FirstRow = 7\n    LastRow = ActiveSheet.UsedRange.Rows.Count\n\n 'Find last Column of input file\n   Set LastColumn = InputSheet.Cells.Find(What:=&quot;*&quot;, _   \n                                     after:=InputSheet.Cells(1), _\n                                     Searchorder:=xlByColumns, _\n                                     SearchDirection:=xlPrevious, _\n                                     MatchCase:=False)_\n                                     .Columns\n\nOutputSheet.Range(OutputSheet.Cells(FirstRow, 2), _\n    OutputSheet.Cells(LastRow, 2)).Value = _\nInputSheet.Range(InputSheet.Cells(FirstRow, LastColumn), _\n    InputSheet.Cells(LastRow, LastColumn)).Value\n\nInputFile.Close\n\nEnd Sub\n</code></pre>\n<p>Any thoughts would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 618, "user_id": 3797860, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b0faeed70727847c1bbb7748d530acb6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_W4588", "link": "https://stackoverflow.com/users/3797860/ryan-w4588"}, "edited": false, "score": 0, "creation_date": 1432746205, "post_id": 30482684, "comment_id": 49055908, "body": "Which portion are you seeing as a range? I dont `"}], "tags": [], "owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "is_accepted": false, "score": 0, "last_activity_date": 1432730253, "creation_date": 1432730253, "answer_id": 30482684, "question_id": 30481888, "link": "https://stackoverflow.com/questions/30481888/external-table-is-not-in-the-expected-format-access-2010-vba/30482684#30482684", "title": "External table is not in the expected format (Access 2010 VBA)", "body": "<p>I am not sure you have the right arguments:</p>\n\n<pre><code>DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, \"QUERY_NAME_2\", CurrentProject.Path &amp; \"\\\" &amp; \"Report.xlsm\", True, \"WORKSHEET_NAME_2\"\n</code></pre>\n\n<p>Seems like you should be using <code>acSpreadsheetTypeExcel12</code> instead of <code>acSpreadsheetTypeExcel9</code>. But more importantly as according to <a href=\"http://%20https://msdn.microsoft.com/en-us/library/office/ff844793.aspx\" rel=\"nofollow\">MSDN</a> the <code>Range</code> field should be left blank as:</p>\n\n<blockquote>\n  <p>[MSDN] Range - (...)When you export to a spreadsheet, you must leave this argument blank.\n  If you enter a range, the export will fail.(...)</p>\n</blockquote>\n"}], "owner": {"reputation": 618, "user_id": 3797860, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b0faeed70727847c1bbb7748d530acb6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_W4588", "link": "https://stackoverflow.com/users/3797860/ryan-w4588"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1396, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432730253, "creation_date": 1432728231, "last_edit_date": 1432728787, "question_id": 30481888, "link": "https://stackoverflow.com/questions/30481888/external-table-is-not-in-the-expected-format-access-2010-vba", "title": "External table is not in the expected format (Access 2010 VBA)", "body": "<p>I am creating a form that generates a table from a query and disperses data over 7 datasheets within an excel file. The issue I am having is extreme inconsistency. This error does not always appear, and when it does it's in one of the 7 exports. </p>\n\n<p>My code:</p>\n\n<pre><code>Private Sub cmdExport_Click()\n\nDim xl As Object\n\n'Step 1:  Start Excel, then open the target workbook.\n    Set xl = CreateObject(\"Excel.Application\")\n    xl.Workbooks.Open (CurrentProject.Path &amp; \"\\\" &amp; \"Report.xlsm\")\n\n'Step 2:  Make Excel visible\n    xl.Visible = True\n    xl.ActiveWorkbook.Activate\n'Step 3:  Run the target macro\n    xl.Run \"PreImport\"\n  '  xl.ActiveWorkbook.Save\n'Step 4:  Close and save the workbook, then close Excel\n    xl.ActiveWorkbook.Close\n    xl.Quit\n\n'Step 5:  Memory Clean up.\n    Set xl = Nothing\n\n\n ' The TransferSpreadsheet command below this comment is where the errors are occuring\n\n\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, \"QUERY_NAME_1\", CurrentProject.Path &amp; \"\\\" &amp; \"Report.xlsm\", True, \"WORKSHEET_NAME_1\"\n\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, \"QUERY_NAME_2\", CurrentProject.Path &amp; \"\\\" &amp; \"Report.xlsm\", True, \"WORKSHEET_NAME_2\"\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, \"QUERY_NAME_3\", CurrentProject.Path &amp; \"\\\" &amp; \"Report.xlsm\", True, \"WORKSHEET_NAME_3\"\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, \"QUERY_NAME_4\", CurrentProject.Path &amp; \"\\\" &amp; \"Report.xlsm\", True, \"WORKSHEET_NAME_4\"\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, \"QUERY_NAME_5\", CurrentProject.Path &amp; \"\\\" &amp; \"Report.xlsm\", True, \"WORKSHEET_NAME_5\"\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, \"QUERY_NAME_6\", CurrentProject.Path &amp; \"\\\" &amp; \"Report.xlsm\", True, \"WORKSHEET_NAME_6\"\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, \"QUERY_NAME_7\", CurrentProject.Path &amp; \"\\\" &amp; \"Report.xlsm\", True, \"WORKSHEET_NAME_7\"\n\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, \"QUERY_NAME_8\", CurrentProject.Path &amp; \"\\\" &amp; \"Report.xlsm\", True, \"WORKSHEET_NAME_8\"\n\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, \"QUERY_NAME_9\", CurrentProject.Path &amp; \"\\\" &amp; \"Report.xlsm\", True, \"WORKSHEET_NAME_9\"\n\n ' The TransferSpreadsheet command above this comment is where the errors are occuring\n\nDim xlapp As Excel.Application\nSet xlapp = CreateObject(\"Excel.Application\")\n\nxlapp.Visible = True\n\nxlapp.Workbooks.Open CurrentProject.Path &amp; \"\\\" &amp; \"Report.xlsm\", True, False\n\nSet xlapp = Nothing\n\n\nEnd Sub\n</code></pre>\n\n<p>The macro \"PreImport\" that is being ran does the following:</p>\n\n<ol>\n<li>Copies/Pastes 2 columns into a new location (to show last week's data).</li>\n<li>Deletes all worksheets from <code>WORKSHEET_NAME_1</code> to <code>WORKSHEET_NAME_9</code></li>\n<li>Saves file</li>\n</ol>\n\n<p>The main code (shown above) is supposed to:</p>\n\n<ol>\n<li>Run <code>PreImport</code> macro</li>\n<li>Dump data into <code>Report.xlsm</code></li>\n<li>Save file</li>\n</ol>\n"}, {"tags": ["excel", "sum", "cells", "vba"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1432727756, "post_id": 30481585, "comment_id": 49042075, "body": "<b>Are the digits in separate cells or in a single cell??</b>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1432728115, "post_id": 30481585, "comment_id": 49042369, "body": "Yes it is possible. Start with <a href=\"http://meta.stackoverflow.com/questions/260648/stack-overflow-question-checklist\">this</a>."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1432732584, "creation_date": 1432732584, "answer_id": 30483633, "question_id": 30481585, "link": "https://stackoverflow.com/questions/30481585/summing-items-under-a-merged-cell/30483633#30483633", "title": "Summing items under a merged cell", "body": "<p>This will work whether the cells are merged or un-merged.  Say we have merged <strong>A1</strong> through <strong>C2</strong> with contents like:</p>\n\n<p><img src=\"https://i.stack.imgur.com/lYAJA.png\" alt=\"enter image description here\"></p>\n\n<p>The following <em>UDF()</em> will give the sum of the numeric values:</p>\n\n<pre><code>Public Function InternalSum(rin As Range) As Double\n   Dim v As String, CH As String, temp As String\n   Dim dot As String, L As Long, i As Long\n   Dim capture As Boolean\n   v = rin(1).Text\n   InternalSum = 0\n   dot = \".\"\n   temp = \"\"\n   capture = False\n   L = Len(v)\n   If L = 0 Then Exit Function\n   For i = 1 To L\n      CH = Mid(v, i, 1)\n      If IsNumeric(CH) Or CH = dot Then\n         capture = True\n         temp = temp &amp; CH\n         If i = L Then\n            InternalSum = InternalSum + CDbl(temp)\n         End If\n      Else\n         If capture Then\n            capture = False\n            InternalSum = InternalSum + CDbl(temp)\n            temp = \"\"\n         End If\n      End If\n   Next i\nEnd Function\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/JhPiU.png\" alt=\"enter image description here\"></p>\n\n<p>Note that both:</p>\n\n<pre><code>=internalsum(A1)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>=internalsum(A1:C2)\n</code></pre>\n\n<p>will work.</p>\n"}], "owner": {"reputation": 41, "user_id": 1158031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/656ff18d1b6bb1cd31e446421dd21762?s=128&d=identicon&r=PG", "display_name": "Blazin&#39;", "link": "https://stackoverflow.com/users/1158031/blazin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 888, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432738968, "creation_date": 1432727327, "last_edit_date": 1531161705, "question_id": 30481585, "link": "https://stackoverflow.com/questions/30481585/summing-items-under-a-merged-cell", "title": "Summing items under a merged cell", "body": "<p>I would like to ask help to sum all items under a merged cell.\nItem looks like this:</p>\n\n<pre><code>       June  \n0 1 2 3 4 5 6 7 8 9  \n2 3 4 5 6 7 8 9 0 1\n</code></pre>\n\n<p>June is a merged cell, and I want to sum all items under it. \nIs this even possible?</p>\n"}, {"tags": ["javascript", "excel", "vba", "vbscript", "internet-explorer-10"], "answers": [{"tags": [], "owner": {"reputation": 592, "user_id": 1458382, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/213fd7b5fa7e6bbae37acaea6c93a1bf?s=128&d=identicon&r=PG", "display_name": "Muhammad Ali", "link": "https://stackoverflow.com/users/1458382/muhammad-ali"}, "is_accepted": false, "score": 0, "last_activity_date": 1432738212, "creation_date": 1432738212, "answer_id": 30485978, "question_id": 30480178, "link": "https://stackoverflow.com/questions/30480178/innertext-auto-truncating-long-text-inside-a-dom-element/30485978#30485978", "title": "innerText auto truncating long text inside a DOM element", "body": "<p>It turns out that the problem was caused due to an integer overflow. The index for the string I was looking for was larger than the capacity of the type Integer in VBA, so VBA silently set it to zero. </p>\n\n<p>As for the reason behind why I wasn't able to find the text inside FireFox, that is still a mystery.</p>\n"}], "owner": {"reputation": 592, "user_id": 1458382, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/213fd7b5fa7e6bbae37acaea6c93a1bf?s=128&d=identicon&r=PG", "display_name": "Muhammad Ali", "link": "https://stackoverflow.com/users/1458382/muhammad-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 319, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594060463, "creation_date": 1432723368, "last_edit_date": 1594060463, "question_id": 30480178, "link": "https://stackoverflow.com/questions/30480178/innertext-auto-truncating-long-text-inside-a-dom-element", "title": "innerText auto truncating long text inside a DOM element", "body": "<p>I am trying to access the content inside a <strong>td</strong> element through the JavaScript <strong>innerText</strong> property (inside an excel VBA macro). It works perfectly for all cases except for this one case where the text inside the <strong>td</strong> element is very long (greater than 85982 characters).</p>\n\n<p>Upon inspection of the text extracted by innerText, I found that innerText seems to be truncating the text after a certain length. Note that this doesn't happen for other cases where the text size is small.</p>\n\n<p>Also, it seems that Mozilla's <strong>textContent</strong> property has a similar problem as well. I tried accessing the truncated part of the text using the developer console in Firefox for the aforementioned DOM element, but it seems that text isn't there in the extracted content (but the not truncated text is there - just like with innerText).</p>\n\n<p>Does anyone know how to bypass this restriction? Is there some internal limit on these functions?</p>\n\n<p>Here's my VBA code that has this problem:</p>\n\n<pre><code>MyInnerText = objElement.ChildNodes(3).innerText\n</code></pre>\n\n<p>Here's an equivalent code run in the Firefox console which has the same problem:</p>\n\n<pre><code>var t = document.getElementsByName(\"chapter11\")[0].parentNode.children[3].textContent;\nt.match(\"some text that is in the part being truncated.\");\n</code></pre>\n\n<p>For Firefox, this problem seems to go away if I inspect the element, and click \"Show all 3396\" nodes. After those nodes are visible, the textContent does not truncate the text anymore.</p>\n\n<p>Please do note that I want to be able to extract the text from inside a VBA script using the Internet Explorer object.</p>\n"}, {"tags": ["vba", "excel", "checkbox", "excel-2013"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 2, "creation_date": 1432721893, "post_id": 30479196, "comment_id": 49037943, "body": "Have you considered calling the function&#39;s recalculation on the <code>Change</code> event of the <code>CheckBox</code>?"}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 2, "creation_date": 1432723222, "post_id": 30479196, "comment_id": 49038850, "body": "I would suggest linking checkbox to a cell, and using simple IF formula instead of VBA UDF."}, {"owner": {"reputation": 14311, "user_id": 423171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/acfd57888c382343f79a7fc3a86569fa?s=128&d=identicon&r=PG", "display_name": "cprcrack", "link": "https://stackoverflow.com/users/423171/cprcrack"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1432733888, "post_id": 30479196, "comment_id": 49046784, "body": "@MatteoNNZ thanks, <code>ActiveSheet.Calculate</code> on the <code>Change</code> event did the trick."}, {"owner": {"reputation": 14311, "user_id": 423171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/acfd57888c382343f79a7fc3a86569fa?s=128&d=identicon&r=PG", "display_name": "cprcrack", "link": "https://stackoverflow.com/users/423171/cprcrack"}, "reply_to_user": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1432733946, "post_id": 30479196, "comment_id": 49046846, "body": "@user3964075 I need to use a UDF, the provided code was just a simplified example."}], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1432734982, "last_edit_date": 1432734982, "creation_date": 1432728942, "answer_id": 30482159, "question_id": 30479196, "link": "https://stackoverflow.com/questions/30479196/excel-vba-user-defined-function-based-on-checkbox-input-not-recalculating/30482159#30482159", "title": "Excel VBA: User defined function based on checkbox input not recalculating", "body": "<p>I'm not sure that you are talking about a <strong>CheckBox in a UserForm</strong>, but if you are just place this line in the <code>CheckBox_Change()</code> :</p>\n\n<pre><code>Sheets(\"Your_Sheet_Name\").Calculate\n</code></pre>\n\n<p>And if it is an <strong>Excel CheckBox</strong> :</p>\n\n<ol>\n<li>Add a linked cell (here is in C1)</li>\n<li>Place this in the Worksheet module</li>\n</ol>\n\n<p>This code:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)    \n    If Application.Intersect(Target, Range(\"C1\")) Is Nothing Then\n      'Nothing\n    Else\n       Sheets(\"Your_Sheet_Name\").Calculate\n    End If    \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 14311, "user_id": 423171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/acfd57888c382343f79a7fc3a86569fa?s=128&d=identicon&r=PG", "display_name": "cprcrack", "link": "https://stackoverflow.com/users/423171/cprcrack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 420, "favorite_count": 0, "accepted_answer_id": 30482159, "answer_count": 1, "score": 0, "last_activity_date": 1432799050, "creation_date": 1432720867, "last_edit_date": 1432799050, "question_id": 30479196, "link": "https://stackoverflow.com/questions/30479196/excel-vba-user-defined-function-based-on-checkbox-input-not-recalculating", "title": "Excel VBA: User defined function based on checkbox input not recalculating", "body": "<p>In Excel 2013, I have defined a custom function <code>CUSTOM_EQUITY</code> which returns <code>\"EXTERNAL\"</code> or <code>\"INTERNAL\"</code> based on whether a checkbox (form control) is checked or not. It works okay when I press enter, but it doesn't auto-update when I click the checkbox, checking or unchecking it.             </p>\n\n<p>Forcing the update with <kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>F9</kbd> works perfectly, but I'm unable to make the cell automatically update when the checkbox is clicked. As you see I have already tried with <code>Application.Volatile</code>.</p>\n\n<pre><code>Function CUSTOM_EQUITY()\n\n    Application.Volatile\n    Application.Calculation = xlCalculationAutomatic\n\n    Dim taxesExt As Boolean\n    taxesExt = ActiveSheet.Shapes(\"TAXES_EXT\").ControlFormat.Value = 1\n\n    If taxesExt Then\n        CUSTOM_EQUITY = \"EXTERNAL\"\n    Else\n        CUSTOM_EQUITY = \"INTERNAL\"\n    End If\n\nEnd Function\n</code></pre>\n\n<p>How can I make my function automatically recalculate when the checkbox value changes?</p>\n"}, {"tags": ["vba", "excel", "text", "split"], "comments": [{"owner": {"reputation": 746, "user_id": 4733869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f0b856d3215d1cbde059e0d411ab55?s=128&d=identicon&r=PG&f=1", "display_name": "Dawid", "link": "https://stackoverflow.com/users/4733869/dawid"}, "edited": false, "score": 1, "creation_date": 1432722451, "post_id": 30479126, "comment_id": 49038289, "body": "Read about <code>Split</code> function -&gt; <a href=\"https://msdn.microsoft.com/en-us/library/6x627e5f%28v=vs.90%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/6x627e5f%28v=vs.90%29.aspx</a>"}, {"owner": {"reputation": 117, "user_id": 4944040, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-Igyx53TP2zo/AAAAAAAAAAI/AAAAAAAAABA/gSRqTDeNOjw/photo.jpg?sz=128", "display_name": "Nur Atiqah Hassan", "link": "https://stackoverflow.com/users/4944040/nur-atiqah-hassan"}, "reply_to_user": {"reputation": 746, "user_id": 4733869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f0b856d3215d1cbde059e0d411ab55?s=128&d=identicon&r=PG&f=1", "display_name": "Dawid", "link": "https://stackoverflow.com/users/4733869/dawid"}, "edited": false, "score": 0, "creation_date": 1432722603, "post_id": 30479126, "comment_id": 49038397, "body": "@Dawid thanks for replying . I&#39;ve tried that it doesn&#39;t work. My data didn&#39;t change. Sorry."}, {"owner": {"reputation": 746, "user_id": 4733869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f0b856d3215d1cbde059e0d411ab55?s=128&d=identicon&r=PG&f=1", "display_name": "Dawid", "link": "https://stackoverflow.com/users/4733869/dawid"}, "edited": false, "score": 0, "creation_date": 1432723238, "post_id": 30479126, "comment_id": 49038864, "body": "Look for example in answer"}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 4944040, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-Igyx53TP2zo/AAAAAAAAAAI/AAAAAAAAABA/gSRqTDeNOjw/photo.jpg?sz=128", "display_name": "Nur Atiqah Hassan", "link": "https://stackoverflow.com/users/4944040/nur-atiqah-hassan"}, "edited": false, "score": 0, "creation_date": 1432882552, "post_id": 30479916, "comment_id": 49119914, "body": "YOU DID IT! OMG THANK YOU SO MUCH @R3uk"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 2, "last_activity_date": 1432727998, "last_edit_date": 1432727998, "creation_date": 1432722723, "answer_id": 30479916, "question_id": 30479126, "link": "https://stackoverflow.com/questions/30479126/how-do-i-split-text-to-a-different-column-or-remove-a-text-from-the-original-col/30479916#30479916", "title": "How do i split text to a different column or remove a text from the original column?", "body": "<p>So test that :</p>\n\n<pre><code>Sub SplitValues()\nDim aSplit As Variant\n\nWith ActiveSheet\n    For I = 2 To Cells(.Rows.Count, \"D\").End(xlUp).Row\n        aSplit = Split(Cells(I, \"D\"), \" \", 2)\n\n        'Write in D and E columns (erase data already in D)\n        Cells(I, \"D\") = aSplit(0)\n        Cells(I, \"E\") = aSplit(1)\n\n        'Write in E and F columns (don't erase data already in D)\n        'Cells(I, \"E\") = ArrSplit(0)\n        'Cells(I, \"F\") = ArrSplit(1)\n    Next I\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>You may simply use a built-in Excel tool :</p>\n\n<blockquote>\n  <p>In <strong>Data</strong> tab, <strong>Convert</strong> tool :</p>\n  \n  <ol>\n  <li>Choose Delimited </li>\n  <li>Chose space as Separator</li>\n  </ol>\n</blockquote>\n\n<p>and just enjoy</p>\n\n<p>No need for VBA there, if you want just take a look at the <a href=\"https://msdn.microsoft.com/fr-fr/library/6x627e5f%28v=vs.90%29.aspx\" rel=\"nofollow\">split function there</a></p>\n"}, {"tags": [], "owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "is_accepted": false, "score": 1, "last_activity_date": 1432722735, "creation_date": 1432722735, "answer_id": 30479922, "question_id": 30479126, "link": "https://stackoverflow.com/questions/30479126/how-do-i-split-text-to-a-different-column-or-remove-a-text-from-the-original-col/30479922#30479922", "title": "How do i split text to a different column or remove a text from the original column?", "body": "<p>If you go to the Data tab on the Ribbon you will see a Text to Columns tool.</p>\n\n<p>Select the data you want to split then click on Text to Columns.</p>\n\n<p>In Step 1, select the Delimited option and click Next.</p>\n\n<p>In Step 2, select just the Space delimiter and click Next.</p>\n\n<p>In Step 3 you will see a preview of how your data will be split and have the option to select a column and not import it.</p>\n"}, {"comments": [{"owner": {"reputation": 117, "user_id": 4944040, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-Igyx53TP2zo/AAAAAAAAAAI/AAAAAAAAABA/gSRqTDeNOjw/photo.jpg?sz=128", "display_name": "Nur Atiqah Hassan", "link": "https://stackoverflow.com/users/4944040/nur-atiqah-hassan"}, "edited": false, "score": 0, "creation_date": 1432725415, "post_id": 30480091, "comment_id": 49040359, "body": "HI! Hello again @Dawid you code works only for the first value."}, {"owner": {"reputation": 746, "user_id": 4733869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f0b856d3215d1cbde059e0d411ab55?s=128&d=identicon&r=PG&f=1", "display_name": "Dawid", "link": "https://stackoverflow.com/users/4733869/dawid"}, "reply_to_user": {"reputation": 117, "user_id": 4944040, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-Igyx53TP2zo/AAAAAAAAAAI/AAAAAAAAABA/gSRqTDeNOjw/photo.jpg?sz=128", "display_name": "Nur Atiqah Hassan", "link": "https://stackoverflow.com/users/4944040/nur-atiqah-hassan"}, "edited": false, "score": 0, "creation_date": 1432725574, "post_id": 30480091, "comment_id": 49040469, "body": "Yes, only for first value. I posted this example to let you know that way is working. If you need for a larger number of rows, try use <code>loop</code> -&gt; <a href=\"http://www.excel-easy.com/vba/loop.html\" rel=\"nofollow noreferrer\">excel-easy.com/vba/loop.html</a>"}, {"owner": {"reputation": 117, "user_id": 4944040, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-Igyx53TP2zo/AAAAAAAAAAI/AAAAAAAAABA/gSRqTDeNOjw/photo.jpg?sz=128", "display_name": "Nur Atiqah Hassan", "link": "https://stackoverflow.com/users/4944040/nur-atiqah-hassan"}, "edited": false, "score": 0, "creation_date": 1432726847, "post_id": 30480091, "comment_id": 49041390, "body": "i have tried to loop it in different ways buy i am unable to do it right. could you maybe try? p.s not all my data is 1675.87 L/s. it differs as it goes down the column"}, {"owner": {"reputation": 746, "user_id": 4733869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f0b856d3215d1cbde059e0d411ab55?s=128&d=identicon&r=PG&f=1", "display_name": "Dawid", "link": "https://stackoverflow.com/users/4733869/dawid"}, "reply_to_user": {"reputation": 117, "user_id": 4944040, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-Igyx53TP2zo/AAAAAAAAAAI/AAAAAAAAABA/gSRqTDeNOjw/photo.jpg?sz=128", "display_name": "Nur Atiqah Hassan", "link": "https://stackoverflow.com/users/4944040/nur-atiqah-hassan"}, "edited": false, "score": 0, "creation_date": 1432727258, "post_id": 30480091, "comment_id": 49041708, "body": "Edit you question and add more data from column D. Maybe we can find another solution. Also you can post code which you did not work"}], "tags": [], "owner": {"reputation": 746, "user_id": 4733869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f0b856d3215d1cbde059e0d411ab55?s=128&d=identicon&r=PG&f=1", "display_name": "Dawid", "link": "https://stackoverflow.com/users/4733869/dawid"}, "is_accepted": false, "score": 1, "last_activity_date": 1432723176, "creation_date": 1432723176, "answer_id": 30480091, "question_id": 30479126, "link": "https://stackoverflow.com/questions/30479126/how-do-i-split-text-to-a-different-column-or-remove-a-text-from-the-original-col/30480091#30480091", "title": "How do i split text to a different column or remove a text from the original column?", "body": "<p>Read about <code>Split</code> function -> <a href=\"https://msdn.microsoft.com/en-us/library/6x627e5f%28v=vs.90%29.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/6x627e5f%28v=vs.90%29.aspx</a></p>\n\n<pre><code>Sub LittleExample()\n\nDim ArrSplit As Variant\n\nCells(6, \"D\") = \"1675.87 L/s\"\n\nArrSplit = Split(Cells(6, \"D\"), \" \")\n\nCells(6, \"D\") = ArrSplit(0) ' 1675.87\nCells(6, \"E\") = ArrSplit(1) ' L/s\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": false, "score": 1, "last_activity_date": 1432849600, "creation_date": 1432849600, "answer_id": 30517637, "question_id": 30479126, "link": "https://stackoverflow.com/questions/30479126/how-do-i-split-text-to-a-different-column-or-remove-a-text-from-the-original-col/30517637#30517637", "title": "How do i split text to a different column or remove a text from the original column?", "body": "<p>As noted, <code>Split</code> is the easy way to do this.  If you know that you will always have a single space you can get all of the cells very quickly with</p>\n\n<pre><code>Sub SplitAndRewrite()\n\n    Dim rng_start As Range\n    Set rng_start = Range(\"D6\")\n\n    Dim rng_cell As Range\n    For Each rng_cell In Range(rng_start, rng_start.End(xlDown))\n        rng_cell.Resize(, 2) = Split(rng_cell, \" \")\n    Next\nEnd Sub\n</code></pre>\n\n<p>Code works by iterating through a <em>contiguous</em> (uses <code>End</code>) column of values and applying <code>Split</code> on the <code></code>.  It then takes the two values and pops them back on top of the cell using <code>Resize</code> to expand the output by one column.</p>\n\n<p><code>Split</code> returns an array so it can be quickly output back into the spreadsheet.</p>\n"}], "owner": {"reputation": 117, "user_id": 4944040, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-Igyx53TP2zo/AAAAAAAAAAI/AAAAAAAAABA/gSRqTDeNOjw/photo.jpg?sz=128", "display_name": "Nur Atiqah Hassan", "link": "https://stackoverflow.com/users/4944040/nur-atiqah-hassan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 30479916, "answer_count": 4, "score": 1, "last_activity_date": 1436948773, "creation_date": 1432720730, "last_edit_date": 1436948773, "question_id": 30479126, "link": "https://stackoverflow.com/questions/30479126/how-do-i-split-text-to-a-different-column-or-remove-a-text-from-the-original-col", "title": "How do i split text to a different column or remove a text from the original column?", "body": "<p>I've copied a column of data starting from D9 to D-whatever, the copied data have both decimal value and text. The data varies in each cell in column D </p>\n\n<h2>Example</h2>\n\n<p>D9 : 1675.87 L/s \nD10 : 1555.87 L/s \nD11 : 1635.87 L/s \nThis is my code i tried..  </p>\n\n<pre><code>    Dim c As Collection, K As Long\n     Set c = New Collection\n     K = 9\n     On Error Resume Next\n     For Each r In Range(\"D9:D\" &amp; Cells(Rows.Count, \"D\").End(xlUp).Row)\n     ary = Split(r.Text, \",\")\n     For Each a In ary\n     c.Add a, CStr(a)\n     If Err.Number = 0 Then\n     Cells(K, \"E\").Value = a\n     K = K + 1\n     Else\n     Err.Number = 0\n     End If\n     Next a\n     Next r\n     On Error GoTo 0\n</code></pre>\n\n<p><strong>I want to split the data so that it will be D6 1675.87 and E6 L/s OR remove the L/s completely.</strong> </p>\n\n<p>I know this is simple for most people but I'm relatively new at this so any help would be good. Thank you. You are much appreciated.</p>\n"}, {"tags": ["vba", "outlook", "email-attachments"], "comments": [{"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1432728971, "post_id": 30479120, "comment_id": 49042966, "body": "What is the actual file path passed to the SaveAsFile method?"}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 0, "last_activity_date": 1432728932, "last_edit_date": 1495540679, "creation_date": 1432728932, "answer_id": 30482157, "question_id": 30479120, "link": "https://stackoverflow.com/questions/30479120/how-to-invoke-code-when-there-is-incoming-mail/30482157#30482157", "title": "How to invoke code when there is incoming mail?", "body": "<p>It looks like you are trying to create a rule which triggers a VBA script for saving attachments on the disk. If so, I'd recommend removing any <code>MsgBox</code> statements from the code. It may stop the code from running. Instead, you may use the <code>Debug.Print</code> statements in the code. See <a href=\"https://stackoverflow.com/questions/2916287/where-does-vba-debug-print-log-to\">Where does VBA Debug.Print log to?</a> for more information. </p>\n\n<p>Instead of using rules you may consider handling the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff863686.aspx\" rel=\"nofollow noreferrer\">NewMailEx</a> event of the Application class. The event fires once for every received item that is processed by Microsoft Outlook. The item can be one of several different item types, for example, MailItem, MeetingItem, or SharingItem. The EntryIDsCollection string contains the Entry ID that corresponds to that item.</p>\n\n<p>Finally, you may find the <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736%28v=office.14%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Getting Started with VBA in Outlook 2010</a> article helpful. </p>\n"}], "owner": {"reputation": 3, "user_id": 4138206, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0Sjl9tHIfjA/AAAAAAAAAAI/AAAAAAAAABI/1hCvPr6Z7_c/photo.jpg?sz=128", "display_name": "Janardhan Yerranagu", "link": "https://stackoverflow.com/users/4138206/janardhan-yerranagu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 30482157, "answer_count": 1, "score": 0, "last_activity_date": 1596876190, "creation_date": 1432720714, "last_edit_date": 1596876190, "question_id": 30479120, "link": "https://stackoverflow.com/questions/30479120/how-to-invoke-code-when-there-is-incoming-mail", "title": "How to invoke code when there is incoming mail?", "body": "<p>I have VBA code to download attachment immediately after mail comes into Outlook.</p>\n<p>How do I invoke this code or is there another way to download attachments automatically?</p>\n<pre><code>Sub saveAttachtoDisk(itm As Outlook.MailItem)\n    Dim saveFolder As String\n    saveFolder = &quot;D:\\outlook\\&quot;\n    For Each objAtt In itm.Attachments\n        MsgBox objAtt\n        objAtt.SaveAsFile saveFolder &amp; &quot;\\&quot; &amp; objAtt.DisplayName\n        MsgBox saveFolder &amp; &quot;\\&quot; &amp; objAtt.DisplayName\n        Set objAtt = Nothing\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432725722, "post_id": 30478923, "comment_id": 49040573, "body": "The above method will give you the last row only for column D. If all the columns have data till the same row then the above method will work else you will have to use <code>.Find</code> to find the last row as shown <a href=\"http://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">Here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 4764329, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65d84b1b6fb30448e792096255d9eae6?s=128&d=identicon&r=PG&f=1", "display_name": "taz", "link": "https://stackoverflow.com/users/4764329/taz"}, "edited": false, "score": 0, "creation_date": 1432721573, "post_id": 30479107, "comment_id": 49037725, "body": "I need to add multiple data and above code replacces the last used row i want to add after that row."}, {"owner": {"reputation": 108, "user_id": 4890139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a10a2c9c114a5f2f21674b8d4fbe5af2?s=128&d=identicon&r=PG", "display_name": "iMan7", "link": "https://stackoverflow.com/users/4890139/iman7"}, "reply_to_user": {"reputation": 85, "user_id": 4764329, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65d84b1b6fb30448e792096255d9eae6?s=128&d=identicon&r=PG&f=1", "display_name": "taz", "link": "https://stackoverflow.com/users/4764329/taz"}, "edited": false, "score": 0, "creation_date": 1432722034, "post_id": 30479107, "comment_id": 49038028, "body": "Is this with the +1 at the end of  <code>activesheet.Cells.(Rows.Count, &quot;D&quot;).End(xlUp).row + 1</code>?  I forgot to add it when I first made the post.  Also can you show how you&#39;re adding the data? How many cells are you adding?"}, {"owner": {"reputation": 85, "user_id": 4764329, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65d84b1b6fb30448e792096255d9eae6?s=128&d=identicon&r=PG&f=1", "display_name": "taz", "link": "https://stackoverflow.com/users/4764329/taz"}, "edited": false, "score": 0, "creation_date": 1432726550, "post_id": 30479107, "comment_id": 49041166, "body": "It works fine. Will i be able to find last used row of sheet1 from sheet2 ??"}, {"owner": {"reputation": 108, "user_id": 4890139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a10a2c9c114a5f2f21674b8d4fbe5af2?s=128&d=identicon&r=PG", "display_name": "iMan7", "link": "https://stackoverflow.com/users/4890139/iman7"}, "reply_to_user": {"reputation": 85, "user_id": 4764329, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65d84b1b6fb30448e792096255d9eae6?s=128&d=identicon&r=PG&f=1", "display_name": "taz", "link": "https://stackoverflow.com/users/4764329/taz"}, "edited": false, "score": 0, "creation_date": 1432727776, "post_id": 30479107, "comment_id": 49042089, "body": "Yes just replace <code>activesheet</code> with something like <code>Worksheets(&quot;SheetName&quot;)</code>"}], "tags": [], "owner": {"reputation": 108, "user_id": 4890139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a10a2c9c114a5f2f21674b8d4fbe5af2?s=128&d=identicon&r=PG", "display_name": "iMan7", "link": "https://stackoverflow.com/users/4890139/iman7"}, "is_accepted": true, "score": 7, "last_activity_date": 1500488654, "last_edit_date": 1500488654, "creation_date": 1432720675, "answer_id": 30479107, "question_id": 30478923, "link": "https://stackoverflow.com/questions/30478923/insert-data-after-last-used-row/30479107#30479107", "title": "Insert data after last used row", "body": "<p>Define <code>lastrow</code> as a variable first.\nWhat <code>.row</code> does is returns a number indicating the row, in this case the last row. The <code>+1</code> moves it down by 1 cell. </p>\n\n<pre><code>Dim lastrow as Long\nlastrow = Activesheet.Cells(Rows.Count, \"D\").End(xlUp).row + 1\n\nActivesheet.Cells(lastrow, \"D\").Value = \"Your Value here\"\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 4764329, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65d84b1b6fb30448e792096255d9eae6?s=128&d=identicon&r=PG&f=1", "display_name": "taz", "link": "https://stackoverflow.com/users/4764329/taz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35308, "favorite_count": 3, "accepted_answer_id": 30479107, "answer_count": 1, "score": 3, "last_activity_date": 1500488654, "creation_date": 1432720284, "last_edit_date": 1531161705, "question_id": 30478923, "link": "https://stackoverflow.com/questions/30478923/insert-data-after-last-used-row", "title": "Insert data after last used row", "body": "<p>**Problem:**I need insert the data after last used row in the worksheet. I was able to find last used row with the following code.</p>\n\n<pre><code>ActiveSheet.Cells.(Rows.count, \"D\").End(xlUp).row\n</code></pre>\n\n<p>Now here I have to insert data next to the last used row.</p>\n"}, {"tags": ["vba", "excel", "move"], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 4837444, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/9433f51c27cfd131d85c0f8ba28ab0fd?s=128&d=identicon&r=PG&f=1", "display_name": "james", "link": "https://stackoverflow.com/users/4837444/james"}, "edited": false, "score": 0, "creation_date": 1432724455, "post_id": 30479493, "comment_id": 49039672, "body": "thanks this works great, but one more thing do you know how I could get the data to start being inputted after row 5?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 153, "user_id": 4837444, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/9433f51c27cfd131d85c0f8ba28ab0fd?s=128&d=identicon&r=PG&f=1", "display_name": "james", "link": "https://stackoverflow.com/users/4837444/james"}, "edited": false, "score": 0, "creation_date": 1432727388, "post_id": 30479493, "comment_id": 49041810, "body": "Test the edit. It was the definition of <code>nxt_row</code> that needed to be changed!"}, {"owner": {"reputation": 153, "user_id": 4837444, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/9433f51c27cfd131d85c0f8ba28ab0fd?s=128&d=identicon&r=PG&f=1", "display_name": "james", "link": "https://stackoverflow.com/users/4837444/james"}, "edited": false, "score": 0, "creation_date": 1432729610, "post_id": 30479493, "comment_id": 49043416, "body": "thanks I tried the edit but I get an application or object undefined error on this line: If Range(&quot;C1&quot;).End(xlDown).Offset(1).Row &gt;= 5 Then"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 153, "user_id": 4837444, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/9433f51c27cfd131d85c0f8ba28ab0fd?s=128&d=identicon&r=PG&f=1", "display_name": "james", "link": "https://stackoverflow.com/users/4837444/james"}, "edited": false, "score": 0, "creation_date": 1432730078, "post_id": 30479493, "comment_id": 49043749, "body": "Mkay I kept your code but if the Sheet is empty the End(xlDown) would be on last row and couldn&#39;t offset more. See the edit ;)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 0, "last_activity_date": 1432730129, "last_edit_date": 1432730129, "creation_date": 1432721614, "answer_id": 30479493, "question_id": 30478664, "link": "https://stackoverflow.com/questions/30478664/excel-vba-move-each-text-file-to-a-new-directory-using-the-file-name/30479493#30479493", "title": "excel vba move each text file to a new directory using the file name?", "body": "<p>You misplaced <code>destPath</code> so it wasn't filled with the document name.\nForgot to create destination directory (with <code>MKDir</code>) and the arguments of the last <code>d=Dir</code> statement</p>\n\n<p>Try this (works for me) :</p>\n\n<pre><code>Sub Import_All_Text_Files_2007()\nDim d As String, ext, x\nDim srcPath As String, destPath As String, srcFile As String\nDim strExtension As String\nDim nxt_row As Long\n\n'Change Path\nConst strPath As String = \"Z:\\NS\\Unactioned\\\"\n\n'Stop Screen Flickering\nApplication.ScreenUpdating = False\n\nChDir strPath\n\n'Change extension\nstrExtension = Dir(strPath &amp; \"*.txt\")\n\nDo While strExtension &lt;&gt; \"\"\n    'Sets Row Number for Data to Begin\n    If Range(\"C\" &amp; Rows.Count).End(xlUp).Offset(1).Row &gt;= 5 Then\n        nxt_row = Range(\"C\" &amp; Rows.Count).End(xlUp).Offset(1).Row\n    Else\n        nxt_row = 5\n    End If\n\n    'Below is from a recorded macro importing a text file\n    FileNum = FreeFile()\n    curCol = 3\n    Open strPath &amp; strExtension For Input As #FileNum\n    While Not EOF(FileNum)\n        Line Input #FileNum, DataLine\n        ActiveSheet.Cells(nxt_row, curCol) = DataLine\n        curCol = curCol + 1\n    Wend\n    Close #FileNum\n\n    strExtension = Dir\nLoop\n\n\nsrcPath = \"Z:\\NS\\Unactioned\\\"\next = Array(\"*.txt\", \"*.xls\")\n\nFor Each x In ext\n    d = Dir(srcPath &amp; x)\n    Do While d &lt;&gt; \"\"\n        srcFile = srcPath &amp; d\n        destPath = \"Z:\\NS\\Actioned\\\" &amp; Left(d, Len(d) - 4) &amp; \"\\\"\n        If Dir(destPath, 16) = \"\" Then MkDir (destPath)\n        FileCopy srcFile, destPath &amp; d\n        Kill srcFile\n        d = Dir(srcPath &amp; x)\n    Loop\nNext x\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 4837444, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/9433f51c27cfd131d85c0f8ba28ab0fd?s=128&d=identicon&r=PG&f=1", "display_name": "james", "link": "https://stackoverflow.com/users/4837444/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1199, "favorite_count": 2, "accepted_answer_id": 30479493, "answer_count": 1, "score": 1, "last_activity_date": 1432799168, "creation_date": 1432719602, "last_edit_date": 1432799168, "question_id": 30478664, "link": "https://stackoverflow.com/questions/30478664/excel-vba-move-each-text-file-to-a-new-directory-using-the-file-name", "title": "excel vba move each text file to a new directory using the file name?", "body": "<p>i am using the following vba code to import all my text files onto a new row in excel. This bit works fine, the next thing I want to do is once this has imported the text files, I want each text file to be moved from one directory <code>'Z:\\NS\\Unactioned\\'</code> to another directory called Actioned <code>'Z:\\NS\\Actioned\\&amp;Filename\\'</code>.                                           </p>\n\n<p>And within that folder create a folder for each of the text files from the filename (minus the file extension) where i can then place each text file in the corresponding folder.  </p>\n\n<p>So if I had 3 .txt files in my folder Unactioned:</p>\n\n<pre><code>1.txt\n2.txt\n3.txt\n</code></pre>\n\n<p>then each txt file would be moved like so:</p>\n\n<pre><code>Actioned/1/1.txt\nActioned/2/2.txt\nActioned/3/3.txt\n</code></pre>\n\n<p>Can someone please show me how I would do this? Thanks</p>\n\n<p>Code:</p>\n\n<pre><code>Sub Import_All_Text_Files_2007()\n\n    Dim nxt_row As Long\n\n     'Change Path\n    Const strPath As String = \"Z:\\NS\\Unactioned\\\"\n    Dim strExtension As String\n\n     'Stop Screen Flickering\n    Application.ScreenUpdating = False\n\n    ChDir strPath\n\n     'Change extension\n    strExtension = Dir(strPath &amp; \"*.txt\")\n\n    Do While strExtension &lt;&gt; \"\"\n\n\n         'Sets Row Number for Data to Begin\n        If Range(\"C1\").Value = \"\" Then\n  nxt_row = 1\nElse\n  If Range(\"C2\").Value = \"\" Then\n    nxt_row = 2\n  Else\n     nxt_row = Range(\"C1\").End(xlDown).Offset(1).Row\n  End If\nEnd If\n\n         'Below is from a recorded macro importing a text file\n        FileNum = FreeFile()\ncurCol = 3\nOpen strPath &amp; strExtension For Input As #FileNum\nWhile Not EOF(FileNum)\n    Line Input #FileNum, DataLine\n    ActiveSheet.Cells(nxt_row, curCol) = DataLine\n    curCol = curCol + 1\nWend\nClose #FileNum\n\n        strExtension = Dir\n    Loop\n\n\n\n\n    Dim d As String, ext, x\nDim srcPath As String, destPath As String, srcFile As String\nsrcPath = \"Z:\\NS\\Unactioned\\\"\ndestPath = \"Z:\\NS\\Actioned\\\" &amp; srcFile &amp; \"\\\"\next = Array(\"*.txt\", \"*.xls\")\nFor Each x In ext\n    d = Dir(srcPath &amp; x)\n        Do While d &lt;&gt; \"\"\n            srcFile = srcPath &amp; d\n            FileCopy srcFile, destPath &amp; d\n            Kill srcFile\n            d = Dir\n        Loop\nNext\n\n\n    Application.ScreenUpdating = True\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "pdf", "printing", "ms-word"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1432798521, "post_id": 30478145, "comment_id": 49076368, "body": "<a href=\"http://www.vbaexpress.com/forum/showthread.php?39616-Add-Background-to-PDF-using-Excel-VBA\" rel=\"nofollow noreferrer\">Excel</a> and <a href=\"http://answers.microsoft.com/en-us/office/forum/office_2010-word/vba-to-add-delete-watermark-on-each-page/7f73b736-5da3-4eea-9af1-4629addcd4b4\" rel=\"nofollow noreferrer\">Word</a>"}], "owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 459, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1432718343, "creation_date": 1432718343, "question_id": 30478145, "link": "https://stackoverflow.com/questions/30478145/printing-pdf-with-watermark-copy", "title": "Printing PDF with watermark copy", "body": "<p>I have several external PDF that I want to print with the watermark copy. See picture:\n<img src=\"https://i.stack.imgur.com/Zil3l.png\" alt=\"Printing pdf\"></p>\n\n<p>So I tried the code below to print the pdf from word, however nothing gets printed, any idea how to achieve this task?</p>\n\n<pre><code>    Public Enum actionType\n    openfile\n    printfile\nEnd Enum\n\n\n\nPublic Declare Function ShellExecute Lib \"shell32.dll\" Alias \"ShellExecuteA\" _\n  (ByVal hWnd As Long, ByVal lpOperation As String, ByVal lpFile As String, _\n  ByVal lpParameters As String, ByVal lpDirectory As String, _\n  ByVal nShowCmd As Long) As Long\n\nFunction ExecuteFile(fileName As String, action As actionType)\n' action can be either \"Openfile\" or \"Printfile\".\n\nDim sAction As String\n\n  Select Case action\n    Case 0 ' openfile\n      sAction = \"Open\"\n    Case 1 ' printfile\n      sAction = \"Print\"\n  End Select\n\n  ShellExecute 0, sAction, fileName, vbNullString, \"\", SW_SHOWNORMAL\nEnd Function\n\nSub TestPrint()\n  ' open a file\n  'ExecuteFile \"C:\\MyFile.xls\", openfile\n  ' print another\n  ExecuteFile \"Z:\\Prosjekt\\32982\\Tegninger\\PDF\\0081606.pdf\", printfile\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1432723078, "creation_date": 1432723078, "answer_id": 30480056, "question_id": 30477928, "link": "https://stackoverflow.com/questions/30477928/changing-excel-worksheet-name-in-vba/30480056#30480056", "title": "Changing Excel worksheet name in VBA", "body": "<p>You can do like this:</p>\n\n<pre><code>Public Sub RenameWorkSheet()\n\n    Dim xls     As Excel.Application\n    Dim wkb     As Excel.Workbook\n    Dim wks     As Excel.Worksheet\n\n    Set xls = New Excel.Application\n    Set wkb = xls.Workbooks.Open(\"c:\\test\\workbook1.xlsx\")\n    Set wks = wkb.Worksheets(1)\n\n    wks.Name = \"My New Name\"\n    wkb.Close True\n\n    Set wks = Nothing\n    Set wkb = Nothing\n\n    xls.Quit\n\n    Set xls = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>And note that not any name is allowed:</p>\n\n<pre><code>Public Function TrimExcelSheetName( _\n  ByVal strSheetName As String) _\n  As String\n\n' Replaces characters in strSheetName that are\n' not allowed by Excel in a sheet name.\n' Truncates length of strSheetName to clngSheetNameLen.\n'\n' 2000-12-07. Gustav Brock, Cactus Data ApS, Copenhagen\n' 2002-05-22. Extended selection of invalid chars.\n'             Replaced string concatenating with Mid().\n\n  ' No special error handling.\n  On Error Resume Next\n\n  ' ' String containing all not allowed characters, minimum.\n  ' Const cstrInValidChars  As String = \"\\/:*?\"\n  ' String containing all not allowed characters, extended.\n  Const cstrInValidChars  As String = \"\\/:*?\"\"&lt;&gt;|[]\"\n  ' Replace character for not allowed characters.\n  Const cstrReplaceChar   As String * 1 = \"-\"\n  ' Maximum length of a sheet name in Excel.\n  Const clngSheetNameLen  As Long = 31\n\n  Dim lngLen    As Long\n  Dim lngPos    As Long\n  Dim strChar   As String\n  Dim strTrim   As String\n\n  ' Strip leading and trailing spaces.\n  strTrim = Left(Trim(strSheetName), clngSheetNameLen)\n  lngLen = Len(strTrim)\n  For lngPos = 1 To lngLen Step 1\n    strChar = Mid(strTrim, lngPos, 1)\n    If InStr(cstrInValidChars, strChar) &gt; 0 Then\n      Mid(strTrim, lngPos) = cstrReplaceChar\n    End If\n  Next\n\n  TrimExcelSheetName = strTrim\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 998548, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d6372e61a744dfbba198fb1da8a08ef1?s=128&d=identicon&r=PG", "display_name": "user998548", "link": "https://stackoverflow.com/users/998548/user998548"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6446, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1432973444, "creation_date": 1432717746, "last_edit_date": 1432973444, "question_id": 30477928, "link": "https://stackoverflow.com/questions/30477928/changing-excel-worksheet-name-in-vba", "title": "Changing Excel worksheet name in VBA", "body": "<p>I need to change the worksheet \"USS IWO JIMA\" with textbox data, in other words the name of the sheet should come from a textbox.  I tried but cant do it</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set objApp = New Excel.Application\n'This is new 'Your excel spreadsheet      file goes here\nSet objBook = objApp.Workbooks.Add(strTemplatePath)\n'Name of sheet you want to export to\nSet objApp = objBook.Parent\nSet objSheet = objBook.Worksheets(\"USS IWO JIMA\")\n</code></pre>\n"}, {"tags": ["vba", "excel", "utf-8"], "comments": [{"owner": {"reputation": 8162, "user_id": 1333133, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/87a3017cfedcddb87f9255dfe42fa0fd?s=128&d=identicon&r=PG", "display_name": "Satya", "link": "https://stackoverflow.com/users/1333133/satya"}, "edited": false, "score": 0, "creation_date": 1432717005, "post_id": 30477550, "comment_id": 49034435, "body": "can you try changing &quot;Content-Type&quot;, &quot;application/text&quot; to &quot;Content-Type&quot;, &quot;text/html&quot;"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1432719440, "post_id": 30477550, "comment_id": 49036197, "body": "The main question is what is the web service expecting from this POST request? Is it really expecting simply byte data within the POST body? How is the web service normally getting its data? If it gets it normally from an HTML Form, then it will expect application/x-www-form-urlencoded."}, {"owner": {"reputation": 335, "user_id": 1033578, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ae83783420d6e6d5baf9b13422f9a0d0?s=128&d=identicon&r=PG", "display_name": "Agent96", "link": "https://stackoverflow.com/users/1033578/agent96"}, "edited": false, "score": 0, "creation_date": 1432722012, "post_id": 30477550, "comment_id": 49038015, "body": "I have tried text/html - same problem.  The web service reads from an InputStream, my understanding is this reads from a stream of bytes.  It does not expect a HTML form.  To me the problem is on the VBA side, if I go to the immediate window and print the contents of fsT.ReadText then this prints the text with question marks - not the Arabic text - so I think it is what is being sent, rather then how it is being received."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1432723368, "post_id": 30477550, "comment_id": 49038952, "body": "The immediate window can&#39;t show Unicode. So this is not a hint. Again: How is the web service normally get its data if it not get them from VBA? And where you see the question marks after the POST request?"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1432726372, "post_id": 30477550, "comment_id": 49041017, "body": "Shot in the dark: Don&#39;t change the stream type to binary but let it be 2 (adTypeText). Then use <code>&quot;Content-Type&quot;, &quot;text&#47;plain; charset=utf-8&quot;</code> and <code>oHttp.send(fsT.ReadText)</code>. Or set the stream type to 1 (adTypeBinary) using <code>fsT.Type = 1</code> - maybe adTypeBinary is not what you thought since you are using late binding. Then use <code>&quot;Content-Type&quot;, &quot;application&#47;octet-stream&quot;</code> and <code>oHttp.send(fsT.Read)</code>."}, {"owner": {"reputation": 335, "user_id": 1033578, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ae83783420d6e6d5baf9b13422f9a0d0?s=128&d=identicon&r=PG", "display_name": "Agent96", "link": "https://stackoverflow.com/users/1033578/agent96"}, "edited": false, "score": 0, "creation_date": 1432887942, "post_id": 30477550, "comment_id": 49122933, "body": "Hi - Thanks for all your replies, sorry I&#39;ve only just got back to this.  I have tired on the server (Java) to read the stream of data directly from the request (HttpServletRequest.getInputStream()) and print it out, I get this: &quot;&#217;\u2026&#216;&#177;&#216;&#173;&#216;&#168;&#216;&#167; &#216;&#168;&#216;&#167;&#217;\u201e&#216;&#185;&#216;&#167;&#217;\u201e&#217;\u2026&quot;  It does not make any difference what I set the content type to on the header.  If I createa a Java UTF-8 InputStreamReader (new InputStreamReader(request.getInputStream(), &quot;UTF-8&quot;) and print out the text I get this: &quot;????? ???????&quot;"}, {"owner": {"reputation": 335, "user_id": 1033578, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ae83783420d6e6d5baf9b13422f9a0d0?s=128&d=identicon&r=PG", "display_name": "Agent96", "link": "https://stackoverflow.com/users/1033578/agent96"}, "edited": false, "score": 0, "creation_date": 1432889984, "post_id": 30477550, "comment_id": 49124325, "body": "As a further test, I have created the VBA stream as a binary stream, written the arabic text directly to the stream as a bytearray, and then sent to the server - I get a different set of funny characters which I can not paste here, changing the encoding on the HTTP headers still has no effect.  I will continue to investigate"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1433061458, "post_id": 30477550, "comment_id": 49182747, "body": "@Agent96: See my answer. It should work. You mentioned: &quot;read the stream of data directly from the request (HttpServletRequest.getInputStream()) and print it out&quot;. Where and how you print it out? Also &quot;(new InputStreamReader(request.getInputStream(), &quot;UTF-8&quot;) and print out the text&quot;. Where and how you print out the text?"}], "answers": [{"comments": [{"owner": {"reputation": 335, "user_id": 1033578, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ae83783420d6e6d5baf9b13422f9a0d0?s=128&d=identicon&r=PG", "display_name": "Agent96", "link": "https://stackoverflow.com/users/1033578/agent96"}, "edited": false, "score": 0, "creation_date": 1433150715, "post_id": 30555113, "comment_id": 49210081, "body": "Thanks for your suggestion, this is exactly how I thought it should work, and was what I had origianally done.  But for whatever reason I could not get this to work.  I have posted an answer which solves the problem for me - I don&#39;t exactly know why it works, but it does."}], "tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": false, "score": 1, "last_activity_date": 1433058881, "creation_date": 1433058881, "answer_id": 30555113, "question_id": 30477550, "link": "https://stackoverflow.com/questions/30477550/send-arabic-text-to-web-service/30555113#30555113", "title": "Send Arabic Text to Web Service", "body": "<p>If both sites (server and client) talking the same language (in this case HTTP) and the server really expects simply UTF-8 encoded bytes in the POST request body, then it should work.</p>\n\n<p>Of course this is a assertion. But i will prove it.</p>\n\n<p>So i have the following simple Java server running:</p>\n\n<pre><code>import java.net.*;\nimport java.io.*;\n\nclass SimplestServerPOST extends Thread {\n\n private ServerSocket srvSock = null;\n private Socket sock = null;\n private BufferedInputStream bin = null;\n private DataOutputStream out = null;\n private int contentLength = 0;     \n private int c = 0;     \n\n SimplestServerPOST(int port, int timeout) {\n\n  super();\n\n  try {\n   System.out.println(\"Server start.\");\n   srvSock = new ServerSocket(port, 5);\n   srvSock.setSoTimeout(timeout);\n   start();\n  } catch (Exception e) {\n   e.printStackTrace();\n  }\n }\n\n public void run() {\n  System.out.println(\"Server run.\");\n\n  while (true) {\n   try {\n    sock = srvSock.accept();\n//Begin request-handling\n    try {\n     StringBuffer headerLine = new StringBuffer(\"\");\n     bin = new BufferedInputStream(sock.getInputStream());\n     out = new DataOutputStream(sock.getOutputStream());\n\n     while ((c = bin.read()) &gt;= 0) {\n      if ((c == 10) || (c == 13)) { //if there is a linebreak, then the line ends\n       if (c == 13) { //handle CRLF linebreak\n        bin.mark(1);\n        if (bin.read() != 10) bin.reset();\n       }\n\n       if (headerLine.length() == 0) break; //the whole header section ends if the first empty line occurs\n       //get the content-length header\n       if (headerLine.toString().toLowerCase().startsWith(\"content-length\")) {\n        contentLength = Integer.parseInt(headerLine.toString().split(\" \")[1]);\n       }\n\n       System.out.println(headerLine.toString());\n\n       headerLine.delete(0, headerLine.length()); //new headerline\n      } else {\n       headerLine.append((char)c); //get one byte for headerline\n      }\n     }\n\n     byte[] buffer = new byte[contentLength];\n     bin.read(buffer);\n\n     System.out.println(new String(buffer, \"UTF-8\"));\n\n     FileWriter fw = new FileWriter(\"POSTContent.txt\");\n     fw.write(new String(buffer, \"UTF-8\"));\n     fw.close();\n\n     out.writeBytes(\"HTTP/1.1 200 OK\\r\\n\");\n     out.writeBytes(\"Connection: close\\r\\n\");\n     out.writeBytes(\"\\r\\n\");\n     out.close();\n    } catch(Exception e) {\n     e.printStackTrace();\n    }\n//End request-handling\n    sock.close();\n   } catch (InterruptedIOException e) {\n    try {\n     int sSTo = srvSock.getSoTimeout();\n     // This is only to understand the functionality.\n     //System.out.println(\"No requests for \" + sSTo + \"ms.\");\n    } catch (Exception et) {\n     et.printStackTrace();\n    }\n   } catch (Exception e) {\n    e.printStackTrace();\n   }\n  }\n }\n\n protected void finalize() {\n  if (srvSock != null) {\n   try {\n    srvSock.close();\n   } catch (Exception e) {\n    e.printStackTrace();\n   }\n   srvSock = null;\n  }\n }\n}\n\nclass SimplestServerPOSTMain {\n public static void main(String[] args) {\n  SimplestServerPOST srv = new SimplestServerPOST(2000, 1000);\n }\n}\n</code></pre>\n\n<p>And i send a POST request to this server from the following VBA:</p>\n\n<pre><code>Sub test()\n\n Set oADOStream = CreateObject(\"ADODB.Stream\")\n oADOStream.Type = 2\n oADOStream.Charset = \"utf-8\"\n oADOStream.Open\n\n oADOStream.WriteText \"Test umlauts: \u00e4\u00f6\u00fc\", 1\n oADOStream.WriteText \"Test euro sign: \u20ac\", 1\n oADOStream.WriteText \"Test arabic: \" &amp; ChrW(1587) &amp; \"  \" &amp; ChrW(1588) &amp; \"  \" &amp; ChrW(1589) &amp; \"  \" &amp; ChrW(1590), 1\n\n oADOStream.Position = 0\n\n Set oWinHTTP = CreateObject(\"MSXML2.XMLHTTP.6.0\")\n oWinHTTP.Open \"POST\", \"http://192.168.0.10:2000\", False\n\n 'oWinHTTP.Send oADOStream.ReadText\n\n oADOStream.Type = 1\n oWinHTTP.Send oADOStream.Read\n\nEnd Sub\n</code></pre>\n\n<p>The result is:</p>\n\n<p><img src=\"https://i.stack.imgur.com/9UtV7.png\" alt=\"enter image description here\"></p>\n\n<p>This console is a Linux console. A Windows console maybe will not be able to display the characters properly. But the file POSTContent.txt should contain them properly.</p>\n"}, {"tags": [], "owner": {"reputation": 335, "user_id": 1033578, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ae83783420d6e6d5baf9b13422f9a0d0?s=128&d=identicon&r=PG", "display_name": "Agent96", "link": "https://stackoverflow.com/users/1033578/agent96"}, "is_accepted": false, "score": 1, "last_activity_date": 1433150575, "creation_date": 1433150575, "answer_id": 30569869, "question_id": 30477550, "link": "https://stackoverflow.com/questions/30477550/send-arabic-text-to-web-service/30569869#30569869", "title": "Send Arabic Text to Web Service", "body": "<p>Ok - thanks for all your help.  I do not know why but none of the suggestions worked. I have however found a solution which works for me.  It is:</p>\n\n<ol>\n<li>Create a Binary Stream,</li>\n<li>Write the Cell values from Excel to a ByteArray - and write the byte array to the stream</li>\n<li>Send the stream - importantly - concatenated with a blank string.</li>\n</ol>\n\n<p>An example of what I have done follows:</p>\n\n<pre><code>Dim fsT 'As New Stream\nSet fsT = CreateObject(\"ADODB.Stream\")\nfsT.Type = adTypeBinary 'Specify stream type - we want To save text/string data.\n\nDim b() As Byte\nFor Each cell In ActiveSheet.UsedRange.Cells\n  b = cell.Value\n  fsT.Write b\nNext\n\nfsT.Position = 0\nCall oHttp.Open(\"POST\", pHtml, False)\noHttp.setRequestHeader \"Content-Type\", \"application/text;charset=UTF-8\"\nCall oHttp.send(\"\" &amp; fsT.Read)\n</code></pre>\n\n<p>Note the last line, if I remove the concatenation of the String, it does not come to the server as Arabic.  </p>\n\n<p>I think perhaps the reason the other answer to this question did not work, is the way I am getting the text (cell.Value) rather then directly writing UniCode to the stream.</p>\n"}, {"comments": [{"owner": {"reputation": 335, "user_id": 1033578, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ae83783420d6e6d5baf9b13422f9a0d0?s=128&d=identicon&r=PG", "display_name": "Agent96", "link": "https://stackoverflow.com/users/1033578/agent96"}, "edited": false, "score": 0, "creation_date": 1433173264, "post_id": 30571597, "comment_id": 49225394, "body": "Yes - it worked!  Thanks for this, it is cleaner, and thanks for the explanation of what is actually happening under the covers."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "reply_to_user": {"reputation": 335, "user_id": 1033578, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ae83783420d6e6d5baf9b13422f9a0d0?s=128&d=identicon&r=PG", "display_name": "Agent96", "link": "https://stackoverflow.com/users/1033578/agent96"}, "edited": false, "score": 0, "creation_date": 1433173906, "post_id": 30571597, "comment_id": 49225837, "body": "Thats fine. Good to know this. Hint: If the <code>ADODB.Stream</code> is only used to create the Unicode string for the HTTP-POST, then the <code>.Charset = &quot;UTF-8&quot;</code> is not needed. It is only needed if the stream shall also be saved in a UTF-8 encoded file. The charset of a <code>ADODB.Stream</code> defaults to Unicode, which is needed for the string. And in my opinion it should also work with <code>oHttp.send fsT.ReadText</code> without the concatenation, since <code>.ReadText</code> returns a string already."}, {"owner": {"reputation": 335, "user_id": 1033578, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ae83783420d6e6d5baf9b13422f9a0d0?s=128&d=identicon&r=PG", "display_name": "Agent96", "link": "https://stackoverflow.com/users/1033578/agent96"}, "edited": false, "score": 0, "creation_date": 1433176731, "post_id": 30571597, "comment_id": 49227514, "body": "Yes, in fact it does work without the empty string concatenation, as expected, and without utf-8 as the Charset.  I&#39;m starting to wonder why I had so many problems, and I think it was my own fault as my Java console was not set to output UTF-8 characters for a lot of my early tests. So all of my initial trials were giving me false information."}], "tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": true, "score": 1, "last_activity_date": 1433160854, "last_edit_date": 1433160854, "creation_date": 1433155873, "answer_id": 30571597, "question_id": 30477550, "link": "https://stackoverflow.com/questions/30477550/send-arabic-text-to-web-service/30571597#30571597", "title": "Send Arabic Text to Web Service", "body": "<p>From your answer I get a suspicion.</p>\n\n<p>What you are doing is the following:</p>\n\n<p>You write the pure unencoded Unicode bytes in the binary  <code>ADODB.Stream</code>. Then with concatenating <code>\"\" &amp; fsT.Read</code> you are creating a Unicode String. As in <a href=\"https://msdn.microsoft.com/en-us/library/ms763706%28v=vs.85%29.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/ms763706%28v=vs.85%29.aspx</a> mentioned: \"If the input type is a BSTR, the response is always encoded as UTF-8.\" So the <code>IXMLHTTPRequest</code> will encode this string to UTF-8.</p>\n\n<p>The text <code>ADODB.Stream</code> with <code>.Charset = \"utf-8\"</code> will also have an Unicode String in it's <code>.ReadText</code>. But after changing to binary, it will have a UTF-8 BOM (EFBBBF) at the beginning of it's <code>.Read</code>. This BOM is what is confusing your webservice.</p>\n\n<p>Please try if</p>\n\n<pre><code> Set fsT = CreateObject(\"ADODB.Stream\")\n fsT.Charset = \"UTF-8\"\n fsT.Type = 2\n\n fsT.Open\n\n For Each cell In ActiveSheet.UsedRange.Cells\n  fsT.WriteText cell.Value\n Next\n\n fsT.Position = 0\n\n Set oHttp = CreateObject(\"MSXML2.XMLHTTP.6.0\")\n oHttp.Open \"POST\", pHtml, False\n oHttp.send \"\" &amp; fsT.ReadText\n</code></pre>\n\n<p>will also work. If so, then this is the cleaner solution in my opinion.</p>\n"}], "owner": {"reputation": 335, "user_id": 1033578, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ae83783420d6e6d5baf9b13422f9a0d0?s=128&d=identicon&r=PG", "display_name": "Agent96", "link": "https://stackoverflow.com/users/1033578/agent96"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1200, "favorite_count": 0, "accepted_answer_id": 30571597, "answer_count": 3, "score": 2, "last_activity_date": 1433160854, "creation_date": 1432716697, "last_edit_date": 1432773374, "question_id": 30477550, "link": "https://stackoverflow.com/questions/30477550/send-arabic-text-to-web-service", "title": "Send Arabic Text to Web Service", "body": "<p>Okay, I'm confused.  My problem is that I want to send the contents of my Excel spreadsheet to a HTTP POST web service, in UTF8 encoding - i.e I want to support Arabic text.</p>\n\n<p>I can iterate through the cells of a spreadsheet writing to a stream:</p>\n\n<pre><code>Dim fsT 'As New Stream\nSet fsT = CreateObject(\"ADODB.Stream\")\nfsT.Type = 2'Specify stream type - we want To save text/string data.\nfsT.Charset = \"utf-8\" 'Specify charset For the source text data.\nfsT.Open 'Open the stream And write binary data To the object\n</code></pre>\n\n<p>I can if I wish save this to a file, my Arabic text is preserved.</p>\n\n<p>When I send this to my service, I send it as a binary, this is possibly my downfall.</p>\n\n<pre><code>'Change stream type To binary\n fsT.Position = 0\n fsT.Type = adTypeBinary\n</code></pre>\n\n<p>Followed by</p>\n\n<pre><code> Set oHttp = CreateObject(\"MSXML2.XMLHTTP.6.0\")\n Call oHttp.Open(\"POST\", pHtml, False)\n oHttp.setRequestHeader \"Content-Type\", \"application/text\"\n oHttp.setRequestHeader \"User-Agent\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\"\n Call oHttp.send(fsT.Read)\n</code></pre>\n\n<p>However I have also tried to send as text, without changing the stream type</p>\n\n<pre><code>Call oHttp.send(fsT.ReadText)\n</code></pre>\n\n<p>In both cases the Arabic text that is received on my server is simply a series of question marks ??? ??? ??? etc.  Which incidentally is what I get on the VBA if I look at the output of sft.ReadText.</p>\n\n<p>So - I can output to a file fine, but not anything else without loosing my text.</p>\n\n<p>My VBA is not great, and I'm sure I'm about to be told how stupid I am, but at the risk of that, can anyone help - I have been trying many permutations of things, and I just can't get the text sent over.  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1432716167, "post_id": 30477228, "comment_id": 49033865, "body": "Merged cells are pain to work with and can cause a lot of problems. Why not use a different technique?"}, {"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1432716283, "post_id": 30477228, "comment_id": 49033933, "body": "How do you plan to select them? If you can create a <code>Range</code>-object, you can simply set <code>.MergeCells = True</code>"}, {"owner": {"reputation": 75, "user_id": 1312158, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/348bd6ea9878fbfe42fb86b4ff3d32e8?s=128&d=identicon&r=PG", "display_name": "i-link", "link": "https://stackoverflow.com/users/1312158/i-link"}, "edited": false, "score": 0, "creation_date": 1432779048, "post_id": 30477228, "comment_id": 49069421, "body": "My probem is I don&#39;t know how to select the cells."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 1312158, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/348bd6ea9878fbfe42fb86b4ff3d32e8?s=128&d=identicon&r=PG", "display_name": "i-link", "link": "https://stackoverflow.com/users/1312158/i-link"}, "edited": false, "score": 0, "creation_date": 1432779092, "post_id": 30477509, "comment_id": 49069432, "body": "I need an answer on how to select the cell rather than how to merge."}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "reply_to_user": {"reputation": 75, "user_id": 1312158, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/348bd6ea9878fbfe42fb86b4ff3d32e8?s=128&d=identicon&r=PG", "display_name": "i-link", "link": "https://stackoverflow.com/users/1312158/i-link"}, "edited": false, "score": 0, "creation_date": 1432800560, "post_id": 30477509, "comment_id": 49077606, "body": "You dont need to select the cell (selecting the cell is actually a very inefficient way of doing things), you can do everything from the range object. In your code you could do something like range(.offset(Rowcount+3,0).address,.offset(Rowcount+4,0).ad&zwnj;&#8203;dress).merge"}], "tags": [], "owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "is_accepted": false, "score": 0, "last_activity_date": 1432716585, "creation_date": 1432716585, "answer_id": 30477509, "question_id": 30477228, "link": "https://stackoverflow.com/questions/30477228/how-to-select-cells-and-merge-them/30477509#30477509", "title": "How to select cells and merge them?", "body": "<p>To merge cells</p>\n\n<pre><code>Range(\"C16:E17\").Merge\n</code></pre>\n\n<p>A couple of things you will come accross is that merged cells are best left alone in Excel especially when it comes to vba as you will get errors when trying to do certain things.</p>\n\n<p>Another thing to bear in mind is that the above code I got from the macro recorder, which can help sometimes.</p>\n"}, {"comments": [{"owner": {"reputation": 117, "user_id": 4944040, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-Igyx53TP2zo/AAAAAAAAAAI/AAAAAAAAABA/gSRqTDeNOjw/photo.jpg?sz=128", "display_name": "Nur Atiqah Hassan", "link": "https://stackoverflow.com/users/4944040/nur-atiqah-hassan"}, "edited": false, "score": 0, "creation_date": 1433161172, "post_id": 30557414, "comment_id": 49216550, "body": "i hope this helped you @i-link"}], "tags": [], "owner": {"reputation": 117, "user_id": 4944040, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-Igyx53TP2zo/AAAAAAAAAAI/AAAAAAAAABA/gSRqTDeNOjw/photo.jpg?sz=128", "display_name": "Nur Atiqah Hassan", "link": "https://stackoverflow.com/users/4944040/nur-atiqah-hassan"}, "is_accepted": false, "score": 0, "last_activity_date": 1433075254, "creation_date": 1433075254, "answer_id": 30557414, "question_id": 30477228, "link": "https://stackoverflow.com/questions/30477228/how-to-select-cells-and-merge-them/30557414#30557414", "title": "How to select cells and merge them?", "body": "<p>This should work</p>\n\n<pre><code>Range(\"C16:C17\").Select\nSelection.Merge\nWith.Selection.Borders(xlEdgeLeft)\n.LineStyle=xlContinuous\n.Weight=xlMedium\nEnd With\nWith.Selection.Borders(xlEdgeTop)\n.LineStyle=xlContinuous\n.Weight=xlMedium\nEnd With\nWith.Selection.Borders(xlEdgeRight)\n.LineStyle=xlContinuous\n.Weight=xlMedium\nEnd With\nWith.Selection.Borders(xlEdgeBottom)\n.LineStyle=xlContinuous\n.Weight=xlMedium\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 1312158, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/348bd6ea9878fbfe42fb86b4ff3d32e8?s=128&d=identicon&r=PG", "display_name": "i-link", "link": "https://stackoverflow.com/users/1312158/i-link"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1433075254, "creation_date": 1432715815, "question_id": 30477228, "link": "https://stackoverflow.com/questions/30477228/how-to-select-cells-and-merge-them", "title": "How to select cells and merge them?", "body": "<p>I'm new to VBA and doing some coding to do produce duplicate table from a form.\nBut I'm stuck with selecting one part where I need to select a few cells and merge them. After merging, I still need to box them up.\nAnyone can help?</p>\n\n<pre><code>For Counter = 1 To Me.Copies.Value\n\nRowCount = Worksheets(\"Sheet1\").Range(\"A1\").CurrentRegion.Rows.Count\nWith Worksheets(\"Sheet1\").Range(\"A1\")\n.Offset(RowCount, 0).Value = Me.Location.Value\n.Offset(RowCount, 0).Select\nCall Macro1\n.Offset(RowCount, 1).Value = StEt\n.Offset(RowCount, 1).Select\nCall Macro1\n.Offset(RowCount, 2).Value = Me.Supervisor.Value\n.Offset(RowCount, 2).Select\nCall Macro1\n.Offset(RowCount + 1, 0).Value = Counter\n.Offset(RowCount + 1, 0).Select\nCall Macro1\n.Offset(RowCount + 1, 1).Value = Me.ExactLoc.Value\n.Offset(RowCount + 1, 1).Select\nCall Macro1\n.Offset(RowCount + 1, 2).Value = Me.SupNum.Value\n.Offset(RowCount + 1, 2).Select\nCall Macro1\n.Offset(RowCount + 2, 0).Value = Me.AddMsg.Value\n'this is where I need the cell and 2 more other cell together for a merge\nEnd With\nNext Counter\n</code></pre>\n\n<p>These codes are based on a button to be click on a form with all the values being filled up in the form.\nThe code will duplicate the value in the text field to the amount of copies need to be produce.</p>\n"}, {"tags": ["vba", "excel", "userform", "multipage"], "comments": [{"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1432717377, "post_id": 30477152, "comment_id": 49034689, "body": "Are you using a Multipage Control?"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 4772555, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6a706e5a544ba58524a144ac518f37c8?s=128&d=identicon&r=PG&f=1", "display_name": "Magnicco", "link": "https://stackoverflow.com/users/4772555/magnicco"}, "edited": false, "score": 0, "creation_date": 1434701378, "post_id": 30478074, "comment_id": 49901414, "body": "In order to create a more accurate code i would like to exclude the possibility for the user to bypass the &quot;Next&quot; button and change page by clicking on it. I&#39;m trying to enable and disable the various pages but I&#39;m not solving the problem. Have you any suggestion?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 45, "user_id": 4772555, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6a706e5a544ba58524a144ac518f37c8?s=128&d=identicon&r=PG&f=1", "display_name": "Magnicco", "link": "https://stackoverflow.com/users/4772555/magnicco"}, "edited": false, "score": 0, "creation_date": 1434702875, "post_id": 30478074, "comment_id": 49902263, "body": "Google : <b>excel vba userform multipage disable</b> : <a href=\"http://stackoverflow.com/questions/25766422/userform-multipage-disabling-tab-click\" title=\"userform multipage disabling tab click\">stackoverflow.com/questions/25766422/&hellip;</a>    <a href=\"http://www.ozgrid.com/forum/showthread.php?t=53750\" rel=\"nofollow noreferrer\">ozgrid.com/forum/showthread.php?t=53750</a> and <a href=\"http://www.mrexcel.com/forum/excel-questions/704934-visual-basic-applications-enable-disaple-pages-multipage-control.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 2, "last_activity_date": 1432718126, "creation_date": 1432718126, "answer_id": 30478074, "question_id": 30477152, "link": "https://stackoverflow.com/questions/30477152/change-user-form-page-in-vba-form/30478074#30478074", "title": "Change User Form Page in VBA Form", "body": "<p>This should do the trick : </p>\n\n<pre><code>If Me.MultiPage1.SelectedItem.Index&lt;&gt;Me.MultiPage1.Pages.Count Then\n    Me.MultiPage1.Value = Me.MultiPage1.SelectedItem.Index + 1\nElse\n    Me.MultiPage1.Value = 0\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 4772555, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6a706e5a544ba58524a144ac518f37c8?s=128&d=identicon&r=PG&f=1", "display_name": "Magnicco", "link": "https://stackoverflow.com/users/4772555/magnicco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1663, "favorite_count": 0, "accepted_answer_id": 30478074, "answer_count": 1, "score": 1, "last_activity_date": 1432802064, "creation_date": 1432715610, "last_edit_date": 1432802064, "question_id": 30477152, "link": "https://stackoverflow.com/questions/30477152/change-user-form-page-in-vba-form", "title": "Change User Form Page in VBA Form", "body": "<p>Good morning!</p>\n\n<p>I have an User Form in VBA Excel with multiple Pages. </p>\n\n<p>I want to create a command button (\"Next\" button) that allow the user to change the page. What code should I use?                                          </p>\n"}, {"tags": ["vba", "excel", "import"], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 4837444, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/9433f51c27cfd131d85c0f8ba28ab0fd?s=128&d=identicon&r=PG&f=1", "display_name": "james", "link": "https://stackoverflow.com/users/4837444/james"}, "edited": false, "score": 0, "creation_date": 1432714078, "post_id": 30476602, "comment_id": 49032610, "body": "Thanks but this gives the error method range of object _Global failed"}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "reply_to_user": {"reputation": 153, "user_id": 4837444, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/9433f51c27cfd131d85c0f8ba28ab0fd?s=128&d=identicon&r=PG&f=1", "display_name": "james", "link": "https://stackoverflow.com/users/4837444/james"}, "edited": false, "score": 0, "creation_date": 1432714298, "post_id": 30476602, "comment_id": 49032746, "body": "Try the alternative then"}, {"owner": {"reputation": 153, "user_id": 4837444, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/9433f51c27cfd131d85c0f8ba28ab0fd?s=128&d=identicon&r=PG&f=1", "display_name": "james", "link": "https://stackoverflow.com/users/4837444/james"}, "edited": false, "score": 0, "creation_date": 1432715075, "post_id": 30476602, "comment_id": 49033239, "body": "Thanks this works great! Is there anyway I could get the rows of data to start from column C instead of column A?"}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "reply_to_user": {"reputation": 153, "user_id": 4837444, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/9433f51c27cfd131d85c0f8ba28ab0fd?s=128&d=identicon&r=PG&f=1", "display_name": "james", "link": "https://stackoverflow.com/users/4837444/james"}, "edited": false, "score": 0, "creation_date": 1432716339, "post_id": 30476602, "comment_id": 49033972, "body": "Sure jest start curCol from 3"}, {"owner": {"reputation": 153, "user_id": 4837444, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/9433f51c27cfd131d85c0f8ba28ab0fd?s=128&d=identicon&r=PG&f=1", "display_name": "james", "link": "https://stackoverflow.com/users/4837444/james"}, "edited": false, "score": 0, "creation_date": 1432718142, "post_id": 30476602, "comment_id": 49035200, "body": "When I do that though the second text file doesn&#39;t get imported?"}], "tags": [], "owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "is_accepted": true, "score": 0, "last_activity_date": 1432714284, "last_edit_date": 1432714284, "creation_date": 1432713982, "answer_id": 30476602, "question_id": 30476545, "link": "https://stackoverflow.com/questions/30476545/import-multiple-text-files-to-a-new-row-in-excel-using-vba/30476602#30476602", "title": "Import multiple text files to a new row in excel using vba?", "body": "<p>I think your issue is with this row:</p>\n\n<pre><code> nxt_row = Range(\"A1\").End(xlUp).Offset(0, 0).Row\n</code></pre>\n\n<p>Replace it with this:</p>\n\n<pre><code> nxt_row = Range(\"A10000\").End(xlUp).Offset(1, 0).Row\n</code></pre>\n\n<p>Or an alternative:</p>\n\n<pre><code>if Range(\"A1\").Value = \"\" then \n  nxt_row = 1\nelse\n  if Range(\"A2\").Value = \"\" then \n    nxt_row = 2\n  else\n     nxt_row = Range(\"A1\").End(xlDown).Offset(1).Row\n  end if\nend if\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 4837444, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/9433f51c27cfd131d85c0f8ba28ab0fd?s=128&d=identicon&r=PG&f=1", "display_name": "james", "link": "https://stackoverflow.com/users/4837444/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 1, "accepted_answer_id": 30476602, "answer_count": 1, "score": 0, "last_activity_date": 1512651354, "creation_date": 1432713814, "last_edit_date": 1432801924, "question_id": 30476545, "link": "https://stackoverflow.com/questions/30476545/import-multiple-text-files-to-a-new-row-in-excel-using-vba", "title": "Import multiple text files to a new row in excel using vba?", "body": "<p>I have the following code which scans my directory for text files. In my directory there are several text files each laid out like so:            </p>\n\n<pre><code>Text File:\nBirmingham\nFrance\nIsle of White\nManchester\nNew-Castle\n</code></pre>\n\n<p>I am then trying to import each text file to a new row in excel and so that each line of text is inserted into a new column within that row. </p>\n\n<pre><code>Birmingham         France      Isle of White       Manchester     New-Castle\n</code></pre>\n\n<p>The code I have does this, however it is only importing one text file and is not importing all of the text files in the directory.</p>\n\n<p>Please can someone show me where I am going wrong? I should be getting the following result:</p>\n\n<pre><code>Row 1\nBirmingham         France      Isle of White       Manchester     New-Castle \n\nRow 2\nLondon             Spain       America             Sutton         Scotland\n</code></pre>\n\n<p>etc...</p>\n\n<p>Code:</p>\n\n<pre><code>Sub Import_All_Text_Files_2007()\n\n    Dim nxt_row As Long\n\n     'Change Path\n    Const strPath As String = \"Z:\\NS\\Unactioned\\\"\n    Dim strExtension As String\n\n     'Stop Screen Flickering\n    Application.ScreenUpdating = False\n\n    ChDir strPath\n\n     'Change extension\n    strExtension = Dir(strPath &amp; \"*.txt\")\n\n    Do While strExtension &lt;&gt; \"\"\n\n\n         'Sets Row Number for Data to Begin\n        nxt_row = Range(\"A1\").End(xlUp).Offset(0, 0).Row\n\n         'Below is from a recorded macro importing a text file\n        FileNum = FreeFile()\ncurCol = 1\nOpen strPath &amp; strExtension For Input As #FileNum\nWhile Not EOF(FileNum)\n    Line Input #FileNum, DataLine\n    ActiveSheet.Cells(nxt_row, curCol) = DataLine\n    curCol = curCol + 1\nWend\nClose #FileNum\n\n        strExtension = Dir\n    Loop\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 3, "last_activity_date": 1432724239, "last_edit_date": 1432724239, "creation_date": 1432714115, "answer_id": 30476659, "question_id": 30476370, "link": "https://stackoverflow.com/questions/30476370/countif-formula-to-vba-giving-run-time-error-1004/30476659#30476659", "title": "Countif formula to vba giving Run time error 1004", "body": "<p>You haven't properly qualified all the <code>.Cells</code> calls with a worksheet object, but since you only want the addresses, you don't actually need to specify a worksheet:</p>\n\n<pre><code>Range(\"A1\").Formula = \"=COUNTIF('Sheet1'!\" &amp; Range(Cells(14, 4), Cells(3000, 4)).Address(False, False) &amp; \",\" &amp; _ \nCells(25, 2).Address(False, False) &amp; \") -\" &amp; _\n\"Countifs('Sheet1'!\" &amp; Range(Cells(14, 4), Cells(3000, 4)).Address(False, False) &amp; \",\" &amp; _ \nCells(25, 2).Address(False, False) &amp; \",'Sheet1'!\" &amp; _\nRange(Cells(14, 5), Cells(3000, 5)).Address(False, False) &amp; \", \"\"No Test\"\")\"\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1432714529, "last_edit_date": 1432714529, "creation_date": 1432714222, "answer_id": 30476688, "question_id": 30476370, "link": "https://stackoverflow.com/questions/30476370/countif-formula-to-vba-giving-run-time-error-1004/30476688#30476688", "title": "Countif formula to vba giving Run time error 1004", "body": "<p>You are specifying the parent of <em>Range</em> but not of <em>Cells</em>. The <code>Cells</code> are defaulting to another worksheet's cells. Essentially you are saying <em>give me a range on Sheet1 that contains the cells in Sheet2</em>.</p>\n\n<p>Use a With/End With and prefix <code>.Range</code> and <code>.Cells</code> with a period to show parentage.</p>\n\n<pre><code>Dim ws2 As Worksheet\n\nSet ws2 = Sheets(\"Sheet2\")\n\nWith Sheets(\"Sheet1\")\n    ws2.Range(\"A1\").Formula = \"=COUNTIF(\" &amp; .Range(.Cells(14, 4), .Cells(3000, 4)).Address(0, 0, external:=True) &amp; \",\" &amp; .Cells(25, 2).Address(0, 0) &amp; \")-\" &amp; _\n       \"COUNTIFS(\" &amp; .Range(.Cells(14, 4), .Cells(3000, 4)).Address(0, 0, external:=True) &amp; \",\" &amp; .Cells(25, 2).Address(0, 0) &amp; \", \" &amp; _\n       .Range(.Cells(14, 5), .Cells(3000, 5)).Address(0, 0, external:=True) &amp; \", \"\"No Test\"\")\"\nEnd With\n</code></pre>\n\n<p>Note that I've used <em>external:=True</em> to include the worksheet names. There does appear to be some confusion as to which worksheet B25 belongs to.</p>\n\n<p>This is what the formula resolves to:</p>\n\n<pre><code>=COUNTIF(Sheet1!D14:D3000, B25)-COUNTIFS(Sheet1!D14:D3000, B25, Sheet1!E14:E3000, \"No Test\")\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1432714859, "post_id": 30476855, "comment_id": 49033104, "body": "Good catch! I forced external address references and discarded the quoted worksheet names but I never would have seen that the first few times around."}, {"owner": {"reputation": 600, "user_id": 4842061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c029acc451f8ec880d76203cfa9a17c5?s=128&d=identicon&r=PG&f=1", "display_name": "Trum", "link": "https://stackoverflow.com/users/4842061/trum"}, "edited": false, "score": 0, "creation_date": 1432715559, "post_id": 30476855, "comment_id": 49033504, "body": "Thanks - I tend to run through bits in chunks until I find what&#39;s up - and it worked this time."}], "tags": [], "owner": {"reputation": 600, "user_id": 4842061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c029acc451f8ec880d76203cfa9a17c5?s=128&d=identicon&r=PG&f=1", "display_name": "Trum", "link": "https://stackoverflow.com/users/4842061/trum"}, "is_accepted": false, "score": 3, "last_activity_date": 1432714752, "creation_date": 1432714752, "answer_id": 30476855, "question_id": 30476370, "link": "https://stackoverflow.com/questions/30476370/countif-formula-to-vba-giving-run-time-error-1004/30476855#30476855", "title": "Countif formula to vba giving Run time error 1004", "body": "<p>The formula itself aside - the reason for the error you are reporting is because of a missing apostrophe when decaring the sheet name:</p>\n\n<p>The below fills in the formula as I imagine it is required:</p>\n\n<pre><code>Range(\"A1\").Formula = \"=COUNTIF('Sheet1'!\" &amp; Sheets(\"Sheet1\").Range(Cells(14, 4), Cells(3000, 4)).Address(False, False) &amp; \",\" &amp; _\nSheets(\"Sheet1\").Cells(25, 2).Address(False, False) &amp; \") -\" &amp; _\n\"Countifs('Sheet1'!\" &amp; Sheets(\"Sheet1\").Range(Cells(14, 4), Cells(3000, 4)).Address(False, False) &amp; \",\" &amp; _\nSheets(\"Sheet1\").Cells(25, 2).Address(False, False) &amp; \",'Sheet1'!\" &amp; _\nSheets(\"Sheet1\").Range(Cells(14, 5), Cells(3000, 5)).Address(False, False) &amp; \", \"\"No Test\"\")\"\n</code></pre>\n"}], "owner": {"reputation": 616, "user_id": 1204868, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/469a6f21c44c41340e2243ec96cc1e2c?s=128&d=identicon&r=PG", "display_name": "user1204868", "link": "https://stackoverflow.com/users/1204868/user1204868"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 786, "favorite_count": 0, "accepted_answer_id": 30476688, "answer_count": 3, "score": 0, "last_activity_date": 1432724239, "creation_date": 1432713294, "last_edit_date": 1531164843, "question_id": 30476370, "link": "https://stackoverflow.com/questions/30476370/countif-formula-to-vba-giving-run-time-error-1004", "title": "Countif formula to vba giving Run time error 1004", "body": "<p>I am trying to convert Countif formulas into a vba formats but its giving me a run time error 1004 application or object define error...</p>\n\n<p>My code and formulas:</p>\n\n<p>For example,</p>\n\n<pre><code>=COUNTIF('Sheet1'!$D$14:$D$3000,$B25)-COUNTIFS('Sheet1'!$D$14:$D$3000,B25,'Sheet1'!$E$14:$E$3000,\"No Test\")\n</code></pre>\n\n<p>to </p>\n\n<pre><code>Range(\"A1\").Formula = \"=COUNTIF('Sheet1'!\" &amp; Sheets(\"Sheet1\").Range(Cells(14, 4), Cells(3000, 4)).Address(False, False) &amp; \",\" &amp; _ \nSheets(\"Sheet1\").Cells(25, 2).Address(False, False) &amp; \") -\" &amp; _\n\"Countifs('Sheet1'!\" &amp; Sheets(\"Sheet1\").Range(Cells(14, 4), Cells(3000, 4)).Address(False, False) &amp; \",\" &amp; _ \nSheets(\"Sheet1\").Cells(25, 2).Address(False, False) &amp; \",'Sheet1!\" &amp; _\nSheets(\"Sheet1\").Range(Cells(14, 5), Cells(3000, 5)).Address(False, False) &amp; \", \"\"No Test\"\")\"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1432713115, "post_id": 30475414, "comment_id": 49032008, "body": "Try to record a macro of you selecting a cell, hence the below range and plotting it into the chart. Hence, use the <code>Worksheet_SelectionChange</code> event to detect when the user is selecting the right cell."}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 3617272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ee2f42c2fe1401a8da15513762fe8228?s=128&d=identicon&r=PG&f=1", "display_name": "Ray Huber", "link": "https://stackoverflow.com/users/3617272/ray-huber"}, "is_accepted": false, "score": 0, "last_activity_date": 1432713083, "creation_date": 1432713083, "answer_id": 30476286, "question_id": 30475414, "link": "https://stackoverflow.com/questions/30475414/do-something-if-cell-is-selected-active/30476286#30476286", "title": "Do something if cell is selected/active?", "body": "<p>You could use the Worksheet_SelectionChange procedure for the worksheet where the tags are located to figure out when a user makes a new selection.</p>\n\n<p>Furthermore, if you create a named range containing the tags you could use the following code to figure out when one of the tags is selected:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\ndim rCell as Range\n\nIf Not Application.Intersect(Target, _TagNamedRange_ )\n    For each rCell in Target\n        'code to determine which specific tag was selected\n    Next\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 2376377, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/04b5b5880177aa5e5389f59bdee843de?s=128&d=identicon&r=PG", "display_name": "koolraj09", "link": "https://stackoverflow.com/users/2376377/koolraj09"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 829, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448231745, "creation_date": 1432710405, "last_edit_date": 1448231745, "question_id": 30475414, "link": "https://stackoverflow.com/questions/30475414/do-something-if-cell-is-selected-active", "title": "Do something if cell is selected/active?", "body": "<p>I have multiple data sets to be plotted using VBA. Each data set (X and Y values) as as whole is tagged by a cell (say Data1 and so on). What I want to do is to plot the data set whose tag is selected by user. </p>\n\n<p>There may be multiple tags selected by the user at the same time. Also user might have imported many data sets in active sheet, but only the data sets whose tag (cell) is activated should be plotted.\nIs this possible? How can I do it?                                  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4085, "user_id": 4185106, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/er5li.png?s=128&g=1", "display_name": "moffeltje", "link": "https://stackoverflow.com/users/4185106/moffeltje"}, "edited": false, "score": 0, "creation_date": 1432710165, "post_id": 30475282, "comment_id": 49030217, "body": "Where is the <code>filesname</code> variable?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432710252, "post_id": 30475282, "comment_id": 49030254, "body": "Does the range have more than one columns?"}, {"owner": {"reputation": 648, "user_id": 4047236, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9jczDrDKoCI/AAAAAAAAAAI/AAAAAAAAAEQ/d0wQv6M3ir8/photo.jpg?sz=128", "display_name": "Tirma", "link": "https://stackoverflow.com/users/4047236/tirma"}, "edited": false, "score": 0, "creation_date": 1432711201, "post_id": 30475282, "comment_id": 49030834, "body": "I think we need some more information of your problem. If I Execute your code, i get a file with a lot of Line Feeder  and nothing else. If i change vbLf   by vbCrlf    i got a file with all the data from the excel, and a lot of carriage return... where is the problem here?"}, {"owner": {"reputation": 83, "user_id": 4477632, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-SbOIzED2QO0/AAAAAAAAAAI/AAAAAAAAJYU/3j8W4uQBxLs/photo.jpg?sz=128", "display_name": "Ashwin Balaji Kuppuraj", "link": "https://stackoverflow.com/users/4477632/ashwin-balaji-kuppuraj"}, "edited": false, "score": 0, "creation_date": 1432711461, "post_id": 30475282, "comment_id": 49031005, "body": "My excel will have list of values in single column."}, {"owner": {"reputation": 83, "user_id": 4477632, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-SbOIzED2QO0/AAAAAAAAAAI/AAAAAAAAJYU/3j8W4uQBxLs/photo.jpg?sz=128", "display_name": "Ashwin Balaji Kuppuraj", "link": "https://stackoverflow.com/users/4477632/ashwin-balaji-kuppuraj"}, "reply_to_user": {"reputation": 648, "user_id": 4047236, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9jczDrDKoCI/AAAAAAAAAAI/AAAAAAAAAEQ/d0wQv6M3ir8/photo.jpg?sz=128", "display_name": "Tirma", "link": "https://stackoverflow.com/users/4047236/tirma"}, "edited": false, "score": 0, "creation_date": 1432711549, "post_id": 30475282, "comment_id": 49031059, "body": "Thanks for the hint @Tirma. I used &quot;vbCrlf&quot; instead of &quot;vbLF&quot;. It worked."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432712628, "post_id": 30475282, "comment_id": 49031723, "body": "just using &quot;vbCrlf&quot; instead of &quot;vbLF&quot; is not good enough. You will still have linefeed in the last line. You need to take care of it in the last record. See the code that I posted"}], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 2, "last_activity_date": 1432712432, "creation_date": 1432712432, "answer_id": 30476087, "question_id": 30475282, "link": "https://stackoverflow.com/questions/30475282/how-can-i-avoid-line-feeder-in-text-file-when-i-write-the-content-from-excel-she/30476087#30476087", "title": "How can I avoid Line feeder in text file when I write the content from excel sheet?", "body": "<p><strong>Suggestions</strong></p>\n\n<ol>\n<li><p>Don't loop through the cells in a range. Store them in an array and loop through the array. It is a much faster method.</p></li>\n<li><p>Working with array also lets us know which record we are handling. In case we are working with the last record we can skip adding the life feed.</p></li>\n</ol>\n\n<p>See this example.</p>\n\n<pre><code>Sub Sample()\n    Dim strPath As String\n    Dim FSO As Object, oFile As Object\n    Dim c As Range\n    Dim linefeed_remover\n    Dim MyAr\n\n    ActiveWorkbook.Sheets(\"Sheet1\").Activate\n    With ActiveSheet\n        .Range(.Cells(1, 1), .Cells.SpecialCells(xlCellTypeLastCell)).Select\n    End With\n\n    Set oFile = Nothing\n\n    strPath = \"C:\\Users\\Siddharth\\Desktop\\\"\n    filesname = \"Sample.Txt\"\n\n    '~~&gt; Transfer the entire range in an array\n    '~~&gt; For faster performcance\n    MyAr = Selection.Value\n\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set oFile = FSO.CreateTextFile(strPath &amp; filesname)\n\n    For i = LBound(MyAr) To UBound(MyAr)\n        '~~&gt; Check if it is the last record so that\n        '~~&gt; We do not add the linefeed\n        If i = UBound(MyAr) Then\n            oFile.Write Application.WorksheetFunction.Clean(MyAr(i, 1))\n        Else\n            oFile.Write Application.WorksheetFunction.Clean(MyAr(i, 1)) &amp; vbNewLine\n        End If\n    Next i\n\n    oFile.Close\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 4477632, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-SbOIzED2QO0/AAAAAAAAAAI/AAAAAAAAJYU/3j8W4uQBxLs/photo.jpg?sz=128", "display_name": "Ashwin Balaji Kuppuraj", "link": "https://stackoverflow.com/users/4477632/ashwin-balaji-kuppuraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 30476087, "answer_count": 1, "score": 1, "last_activity_date": 1432712432, "creation_date": 1432709990, "question_id": 30475282, "link": "https://stackoverflow.com/questions/30475282/how-can-i-avoid-line-feeder-in-text-file-when-i-write-the-content-from-excel-she", "title": "How can I avoid Line feeder in text file when I write the content from excel sheet?", "body": "<p>My Piece of VBA code for writing content from excel sheet to text file is as below.</p>\n\n<pre><code>ActiveWorkbook.Sheets(\"Sheet1\").Activate\nWith ActiveSheet\n    .Range(.Cells(1, 1), .Cells.SpecialCells(xlCellTypeLastCell)).Select\nEnd With\nDim strPath As String\nDim FSO As Object\nDim oFile As Object\nSet oFile = Nothing\nDim c As Range\nDim linefeed_remover\nstrPath = \"path\"\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\nSet oFile = FSO.CreateTextFile(strPath &amp; filesname)\nFor Each c In Selection\n    oFile.Write Application.WorksheetFunction.Clean(c.Value) &amp; vbLf\nNext c\noFile.Close\nstrNameOld = strName &amp; \"_Old\"\n'MsgBox \"File Created\"\n'conn2.Close\n</code></pre>\n\n<p>can anyone help me in solving this?</p>\n"}, {"tags": ["vba", "excel", "duplicates", "excel-2010"], "comments": [{"owner": {"reputation": 4085, "user_id": 4185106, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/er5li.png?s=128&g=1", "display_name": "moffeltje", "link": "https://stackoverflow.com/users/4185106/moffeltje"}, "edited": false, "score": 3, "creation_date": 1432709358, "post_id": 30474923, "comment_id": 49029712, "body": "Did you made an attempt yourself? I don&#39;t see a question here."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1432710544, "post_id": 30474923, "comment_id": 49030424, "body": "Copy column A somewhere and <a href=\"https://support.office.com/en-us/article/Filter-for-unique-values-or-remove-duplicate-values-ccf664b0-81d6-449b-bbe1-8daaec1e83c2\" rel=\"nofollow noreferrer\">Remove Duplicates</a> then use a <a href=\"https://support.office.com/en-US/article/COUNTIF-function-E0DE10C6-F885-4E71-ABB4-1F464816DF34\" rel=\"nofollow noreferrer\">COUNTIF function</a> on the unique values."}], "answers": [{"tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": false, "score": 0, "last_activity_date": 1432711769, "creation_date": 1432711769, "answer_id": 30475879, "question_id": 30474923, "link": "https://stackoverflow.com/questions/30474923/listing-and-counting-unique-from-duplicates/30475879#30475879", "title": "Listing and Counting Unique from Duplicates", "body": "<p>try something like this</p>\n\n<pre><code>Sub test()\n    Dim Dic As Object: Set Dic = CreateObject(\"Scripting.Dictionary\")\n    Dic.CompareMode = vbTextCompare\n    Dim Cl As Range, Data As Range, Key As Variant\n    Set Data = Range(Cells(1, 1), Cells(Cells.Find(\"*\", , , , xlByRows, xlPrevious).Row, 1))\n    For Each Cl In Data\n        If Not Dic.exists(Cl.Value) Then\n            Dic.Add Cl.Value, 1\n        Else\n            Dic(Cl.Value) = CLng(Dic(Cl.Value)) + 1\n        End If\n    Next Cl\n    For Each Key In Dic\n        Debug.Print Key, Dic(Key)\n    Next Key\n    Set Dic = Nothing\nEnd Sub\n</code></pre>\n\n<p>output</p>\n\n<p><img src=\"https://i.stack.imgur.com/gNK9p.jpg\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 125, "user_id": 2036624, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2d491fc3d034455e4c74d54f87fae23f?s=128&d=identicon&r=PG", "display_name": "kernal119", "link": "https://stackoverflow.com/users/2036624/kernal119"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1432711769, "creation_date": 1432708740, "last_edit_date": 1432710698, "question_id": 30474923, "link": "https://stackoverflow.com/questions/30474923/listing-and-counting-unique-from-duplicates", "title": "Listing and Counting Unique from Duplicates", "body": "<p>I have a Table with 6 columns. Column 1 has duplicates:</p>\n\n<pre><code>ABC1\nABC2\nABC3\nABC4\nABC1\nABC1\nABC2\nABC4\n</code></pre>\n\n<p>What I want is the following:</p>\n\n<pre><code>ABC1   3\nABC2   2\nABC3   1\nABC4   2\n</code></pre>\n\n<p>I want to achieve the above via VBA, and the result stored in a 2D array. I am also open to suggestions if it is not possible via VBA.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 45896, "user_id": 2442804, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/wBmyS.jpg?s=128&g=1", "display_name": "luk2302", "link": "https://stackoverflow.com/users/2442804/luk2302"}, "edited": false, "score": 1, "creation_date": 1432707887, "post_id": 30474638, "comment_id": 49028928, "body": "are you asking for the correct syntax to write the sql or do you want to know about how to run sql from within vba?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1670773"}, "reply_to_user": {"reputation": 45896, "user_id": 2442804, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/wBmyS.jpg?s=128&g=1", "display_name": "luk2302", "link": "https://stackoverflow.com/users/2442804/luk2302"}, "edited": false, "score": 0, "creation_date": 1432708232, "post_id": 30474638, "comment_id": 49029106, "body": "I guess I need both. I need to know how to implement the above concept on form load."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1670773"}, "edited": false, "score": 0, "creation_date": 1432710585, "post_id": 30474851, "comment_id": 49030459, "body": "Its working. But could you also show it by using sql query like &#39;SELECT MAX([EMP (staff) Salary]) FROM Employee&#39;"}, {"owner": {"reputation": 45896, "user_id": 2442804, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/wBmyS.jpg?s=128&g=1", "display_name": "luk2302", "link": "https://stackoverflow.com/users/2442804/luk2302"}, "edited": false, "score": 0, "creation_date": 1432711337, "post_id": 30474851, "comment_id": 49030933, "body": "@user1670773 there you go."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1670773"}, "edited": false, "score": 0, "creation_date": 1432735043, "post_id": 30474851, "comment_id": 49047751, "body": "This is working perfectly. But I don&#39;t understand why I need (0)."}, {"owner": {"reputation": 45896, "user_id": 2442804, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/wBmyS.jpg?s=128&g=1", "display_name": "luk2302", "link": "https://stackoverflow.com/users/2442804/luk2302"}, "edited": false, "score": 0, "creation_date": 1432735125, "post_id": 30474851, "comment_id": 49047829, "body": "because in theory the recordset returns you a list/collection/array of fields, you/I want to use only the first one (which in this case is the only one too) - (0) acceses the first element of the returned fields."}, {"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1432806384, "post_id": 30474851, "comment_id": 49081545, "body": "Just curious, Would not using <code>DMax</code> instead of <code>DLookup</code> be more efficient? How about <code>salary</code> coping with <code>NULL</code>?"}, {"owner": {"reputation": 45896, "user_id": 2442804, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/wBmyS.jpg?s=128&g=1", "display_name": "luk2302", "link": "https://stackoverflow.com/users/2442804/luk2302"}, "edited": false, "score": 1, "creation_date": 1432806665, "post_id": 30474851, "comment_id": 49081746, "body": "I have no idea wether one or the other is more efficient, i would guess that DMax just wraps the DLookUp field in a <code>MAX</code> as well ;) Regarding NULL: does not appear to be of any concern here - salary can not be null, would not make sense. I think it is better to give him the more general solution, hence the sql-example as well."}], "tags": [], "owner": {"reputation": 45896, "user_id": 2442804, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/wBmyS.jpg?s=128&g=1", "display_name": "luk2302", "link": "https://stackoverflow.com/users/2442804/luk2302"}, "is_accepted": true, "score": 2, "last_activity_date": 1432711312, "last_edit_date": 1432711312, "creation_date": 1432708468, "answer_id": 30474851, "question_id": 30474638, "link": "https://stackoverflow.com/questions/30474638/ms-access-select-maximum-column-value-of-a-table/30474851#30474851", "title": "MS Access: select maximum column value of a table", "body": "<p>If you just want the maximum you could use the <code>DLookup</code> function instead of writing an actual SQL-Statement:</p>\n\n<pre><code>Private Sub Form_Load()\n    Dim salary As Double\n    salary = DLookup(\"MAX(Salary)\", \"Employee\")\n    salary = salary + (1000 / 23)\n    total_salary.Value = salary\nEnd Sub\n</code></pre>\n\n<p>or via standrad sql</p>\n\n<pre><code>Private Sub Form_Load()\n    Dim salary As Double\n    salary = CurrentDb.OpenRecordset(\"SELECT MAX(Salary) FROM Employee\")(0)\n    salary = salary + (1000 / 23)\n    total_salary.Value = salary\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1670773"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10400, "favorite_count": 0, "accepted_answer_id": 30474851, "answer_count": 1, "score": 2, "last_activity_date": 1485873833, "creation_date": 1432707790, "last_edit_date": 1485873833, "question_id": 30474638, "link": "https://stackoverflow.com/questions/30474638/ms-access-select-maximum-column-value-of-a-table", "title": "MS Access: select maximum column value of a table", "body": "<p>In my microsoft access database name is DBMS.accdb and I have an employee table and one of the column of the table is salary. I have created a form and on form load I want to get the max salary of the table and do some calculation and then set the value in a text box(total_salary) of the form. I want something like this</p>\n\n<pre><code>Private Sub Form_Load()\n    Dim salary As Number\n\n    salary = \"SELECT MAX([EMP (staff) Salary]) FROM Employee\"\n    salary = salary + (1000 / 23)\n    total_salary.Value = salary\nEnd Sub\n</code></pre>\n\n<p>I tried several way using the help from internet but it is not working. I get some error every time.</p>\n\n<p>How can I do this? </p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4896227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/138ba58f51a504054d4623bd6296f92d?s=128&d=identicon&r=PG&f=1", "display_name": "gavin downie", "link": "https://stackoverflow.com/users/4896227/gavin-downie"}, "is_accepted": false, "score": 0, "last_activity_date": 1434040165, "last_edit_date": 1434040165, "creation_date": 1434038847, "answer_id": 30785967, "question_id": 30474336, "link": "https://stackoverflow.com/questions/30474336/issue-with-data-passing-from-one-form-to-another-form-in-ms-access-vba/30785967#30785967", "title": "Issue with Data passing from one form to another form in MS Access VBA", "body": "<p>To pass the quotes into the SQL you need to escape them, and you need additional single quotes as well for the elements of the criteria.</p>\n\n<p>Instead of:</p>\n\n<pre><code>strCriteria = \"CIDCustomer = '\" &amp; Trim(Trim(Me!RID) &amp; \" \" &amp; Trim(Me!RName)) &amp; \"'\"\n</code></pre>\n\n<p>try </p>\n\n<pre><code>strCriteria = \"\" \"CIDCustomer = '\" &amp; Trim(Trim(Me!RID) &amp; \"' &amp; \" \" &amp; '\" Trim(Me!RName)) &amp; \"'\" \"\"\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 2726186, "user_type": "registered", "profile_image": "https://graph.facebook.com/100006576964540/picture?type=large", "display_name": "Sandhya SS", "link": "https://stackoverflow.com/users/2726186/sandhya-ss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1594654568, "creation_date": 1432706700, "last_edit_date": 1594654568, "question_id": 30474336, "link": "https://stackoverflow.com/questions/30474336/issue-with-data-passing-from-one-form-to-another-form-in-ms-access-vba", "title": "Issue with Data passing from one form to another form in MS Access VBA", "body": "<p>Can anyone solve my issue</p>\n\n<p>Form: <strong>SB_1</strong> (this is a Customer Invoice creation form)</p>\n\n<p>Form: <strong>Add_NewRelations</strong> (this is a Customer details adding form)</p>\n\n<p>I have used a VBA code in Form: <strong>SB_1</strong> on a cmd (Button) for Data passing from one form to another form of <strong>Add_NewRelations</strong> for New Customer details are needed to update.</p>\n\n<p>So that VBA working is good as per Code Tag. But some of exist customer details are no need to update into Form: <strong>Add_NewRelations</strong>. So in this case i have added IF Statement with DCount in the VBA code.</p>\n\n<p>When i added If statement with DCount then whole VBA is didn't working... i think DCount is wrong... how can i correction it?? </p>\n\n<p>Can anyone please replay how to solve this problem??</p>\n\n<pre><code>Private Sub Button_Click()\nOn Error GoTo ErrorHandler\n'Me.Refresh\n\nDim strCriteria As String\nstrCriteria = \"CIDCustomer = '\" &amp; Trim(Trim(Me!RID) &amp; \" \" &amp; Trim(Me!RName)) &amp; \"'\"\n\n 'If DCount(\"*\", \"CIDCustomer\", \"RelationsQry\") &gt; 0 Then\n 'Cancel = True\n 'Else\n\nIf DCount(\"*\", \"RelationsQry\", strCriteria) &gt; 0 Then\nCancel = True\nElse\n\n   'If Not IsNull([Customer]) Then\n   'Me.Visible = False\n   DoCmd.OpenForm \"Add_NewRelations\", acNormal, , , , acWindowNormal\n   Forms![Add_NewRelations].Form.RID = Me.CID2\n   Forms![Add_NewRelations].Form.RName = Me.Customer\n   Forms![Add_NewRelations].Form.RType.Value = \"Customer\"\n   Forms![Add_NewRelations].Form.Address = Me.Address\n   Forms![Add_NewRelations].Form.TINNumber = Me.TINNumber\n   Forms![Add_NewRelations].Form.TownVLG = Me.TownVLG\n   Forms![Add_NewRelations].Form.RName.SetFocus\n   'Forms![Add_NewRelations].Visible = False\n   'DoCmd.Close\n\nEnd If\n\nErrorHandler:\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "owner": {"reputation": 103, "user_id": 4910875, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/830ba16f7770d9258b6e61b46cd0f44e?s=128&d=identicon&r=PG&f=1", "display_name": "excel", "link": "https://stackoverflow.com/users/4910875/excel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1432884353, "creation_date": 1432705782, "last_edit_date": 1432884353, "question_id": 30474143, "link": "https://stackoverflow.com/questions/30474143/error-datetime-is-displayed-as-value42150-91666666-after-using-to-concatena", "title": "Error: Datetime is displayed as value(42150.91666666) after using &amp; to concatenate values", "body": "<p>I'm working on a macro which supposed to compile different columns of data into an email subject, the format of the data in terms of columns and samples are provided below:\n<img src=\"https://i.stack.imgur.com/kJNIx.png\" alt=\"enter image description here\"></p>\n\n<p>However, the cells in column AD and AI which displays data and time must contain an apostrophe in the beginning, otherwise the cell would only display time, like shown below:\n<img src=\"https://i.stack.imgur.com/hmfu7.png\" alt=\"enter image description here\"></p>\n\n<p>What's worse, without apostrophe, vba will prompt me the error message of </p>\n\n<blockquote>\n  <p>type mismatch</p>\n</blockquote>\n\n<p>To solve this I changed the concatenation character from <code>+</code> to <code>&amp;</code> at this line:</p>\n\n<pre><code>.Subject = (Sheets(\"Summary\").Cells(i, \"AD\").Value) &amp; (Sheets(\"Summary\").Cells(i, \"AE\").Value) &amp; (Sheets(\"Summary\").Cells(i, \"AF\").Value) &amp; (Sheets(\"Summary\").Cells(i, \"AG\").Value) &amp; (Sheets(\"Summary\").Cells(i, \"AH\").Value) &amp; (Sheets(\"Summary\").Cells(i, \"AI\").Value)\n</code></pre>\n\n<p>I have indeed solved the error message, but now the subject displays the date and time as value such as 42150.91666666. So now the problem I encountered is how to display the date and time properly, without adding the leading apostrophe characters.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1432703993, "post_id": 30473637, "comment_id": 49027322, "body": "You can store the intermediate values on DestSh - just add the second value to the existing value on that sheet.  It&#39;s a little unclear why you&#39;re using End(xlUp) to find where to place the summary values though: if the sheet is empty you could use fixed locations and your code would be clearer."}, {"owner": {"reputation": 108, "user_id": 4890139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a10a2c9c114a5f2f21674b8d4fbe5af2?s=128&d=identicon&r=PG", "display_name": "iMan7", "link": "https://stackoverflow.com/users/4890139/iman7"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1432705655, "post_id": 30473637, "comment_id": 49027905, "body": "@TimWilliams do you mean something like   <code>DestSh.Cells(destrow + 2, 3).Value = DestSh.Cells(destrow + 2, 3).Value + sh.Cells(lastrow, lastcol).Value</code> ?  Actually that works. why didn&#39;t I think of that..."}], "answers": [{"tags": [], "owner": {"reputation": 108, "user_id": 4890139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a10a2c9c114a5f2f21674b8d4fbe5af2?s=128&d=identicon&r=PG", "display_name": "iMan7", "link": "https://stackoverflow.com/users/4890139/iman7"}, "is_accepted": false, "score": 1, "last_activity_date": 1432706287, "creation_date": 1432706287, "answer_id": 30474246, "question_id": 30473637, "link": "https://stackoverflow.com/questions/30473637/how-do-i-reset-a-variable-so-that-another-if-statement-can-use-it/30474246#30474246", "title": "How do I reset a variable so that another If statement can use it?", "body": "<p>Well in light of my novice myopia I didn't quite see the obvious. Thanks @TimWilliams</p>\n\n<p>Changed the formatting to the if and then statements to this:</p>\n\n<pre><code>If Sh.Cells(3, 2).Value Like \"*JAN*\" Then\n     destrow = DestSh.Cells(3, 2).Row\n     DestSh.Cells(destrow, 2).Value = DestSh.Cells(destrow, 2).Value _\n        + Sh.Cells(lastrow, lastcol).Value\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 108, "user_id": 4890139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a10a2c9c114a5f2f21674b8d4fbe5af2?s=128&d=identicon&r=PG", "display_name": "iMan7", "link": "https://stackoverflow.com/users/4890139/iman7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1432706287, "creation_date": 1432703360, "question_id": 30473637, "link": "https://stackoverflow.com/questions/30473637/how-do-i-reset-a-variable-so-that-another-if-statement-can-use-it", "title": "How do I reset a variable so that another If statement can use it?", "body": "<p>So I have data from every month of the year, with each month split into two 15 day worksheets. </p>\n\n<p>I'm trying to sum the two worksheets and then put the value into a compilation worksheet then moving on to the next month. </p>\n\n<p>As it stands it just adds everything starting from January, I've tried resetting it to 0 but that just results in everything being zero.</p>\n\n<p>I could easily just apply a formula at the end of the code that applies a subtraction of the previous cells but I figured it'd be better to learn how to do it in VBA. Perhaps I'm just not using the right words in google. </p>\n\n<p>Thanks for the help. </p>\n\n<pre><code>Sub Sum()\n\nDim DestSh As Worksheet\nDim Sh As Worksheet\nDim lastcol As Long\nDim lastrow As Long\nDim destrow As Long\nDim prevval As Double\nDim nextval As Double\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    Application.DisplayAlerts = False\n\n    'Deletes Compilation worksheet if it exists\n    On Error Resume Next\n    ActiveWorkbook.Worksheets(\"Compilation\").Delete\n    On Error GoTo 0\n    Application.DisplayAlerts = True\n\n    'Add a worksheet with the name \"Compilation\"\n    Set DestSh = ActiveWorkbook.Worksheets.Add\n\n    'loop through all worksheets\n    For Each Sh In ActiveWorkbook.Worksheets\n\n        'Loop through all worksheets except Compilation\n        If IsError(Application.Match(Sh.Name, _\n                                     Array(DestSh.Name), 0)) Then\n\n        'Check for the last column on row 6\n        lastcol = Sh.Cells(6, Columns.Count).End(xlToLeft).Column\n        'Check for the last row that the last column above has\n        lastrow = Sh.Cells(Rows.Count, lastcol).End(xlUp).Row\n\n            'Checks if Cell B3, contains JAN and then enters the contents to DestSh\n            If Sh.Cells(3, 2).Value Like \"*JAN*\" Then\n                destrow = DestSh.Cells(3, 2).End(xlUp).Row\n                    prevval = prevval\n                    nextval = prevval + Sh.Cells(lastrow, lastcol).Value\n                DestSh.Cells(destrow + 2, 2).Value = nextval\n                    prevval = nextval\n            End If\n            If Sh.Cells(3, 2).Value Like \"*FEB*\" Then\n                destrow = DestSh.Cells(3, 3).End(xlUp).Row\n                    prevval = prevval\n                    nextval = prevval + Sh.Cells(lastrow, lastcol).Value\n                DestSh.Cells(destrow + 2, 3).Value = nextval\n                    prevval = nextval\n            End If\n        End If\n    Next\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 851, "user_id": 3439959, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/12f95022006dac6e10f1e107c74672b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sylvain C.", "link": "https://stackoverflow.com/users/3439959/sylvain-c"}, "edited": false, "score": 0, "creation_date": 1432717700, "post_id": 30475321, "comment_id": 49034900, "body": "Thanks @DivisionX but I would like to understand why it&#39;s behaving that way. If i open my subform as a main form directly (Form2 in my example) and I update the field with incorrect content, the BeforeUpdate will be fired only once as it should be.   What are the sequence of events which lead to this event being fired multiple times in the case of linked subform??"}, {"owner": {"reputation": 26, "user_id": 4891719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72af3d29a8765d39186685659a892086?s=128&d=identicon&r=PG&f=1", "display_name": "DivisionX", "link": "https://stackoverflow.com/users/4891719/divisionx"}, "reply_to_user": {"reputation": 851, "user_id": 3439959, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/12f95022006dac6e10f1e107c74672b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sylvain C.", "link": "https://stackoverflow.com/users/3439959/sylvain-c"}, "edited": false, "score": 0, "creation_date": 1432720385, "post_id": 30475321, "comment_id": 49036936, "body": "This is just a theory, but could it be that it first tries to update form 1, then form 2, and then form 1 again because form 2 is a subform of from 1?"}, {"owner": {"reputation": 868, "user_id": 1321707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e64dedac8fa02cae04b5c29e520925d?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1321707/john"}, "edited": false, "score": 0, "creation_date": 1432725807, "post_id": 30475321, "comment_id": 49040634, "body": "Put a breakpoint in your code and watch the execution flow..Events in access are chained and in a specific order..."}], "tags": [], "owner": {"reputation": 26, "user_id": 4891719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72af3d29a8765d39186685659a892086?s=128&d=identicon&r=PG&f=1", "display_name": "DivisionX", "link": "https://stackoverflow.com/users/4891719/divisionx"}, "is_accepted": false, "score": 0, "last_activity_date": 1432710113, "creation_date": 1432710113, "answer_id": 30475321, "question_id": 30473607, "link": "https://stackoverflow.com/questions/30473607/beforeupdate-event-of-a-linked-subform-control-firing-multiple-times/30475321#30475321", "title": "BeforeUpdate event of a linked subform control firing multiple times", "body": "<p>This happens because you do not change the value of Text0 back to what it was.</p>\n\n<p>Try this</p>\n\n<pre><code>Private Sub Text0_BeforeUpdate(Cancel As Integer)\n    If Me.Text0 = \"X\" Then\n        MsgBox \"Wrong value\"\n        Cancel = True\n        Me.Text0.Undo\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 851, "user_id": 3439959, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/12f95022006dac6e10f1e107c74672b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sylvain C.", "link": "https://stackoverflow.com/users/3439959/sylvain-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1432764738, "creation_date": 1432764738, "answer_id": 30493998, "question_id": 30473607, "link": "https://stackoverflow.com/questions/30473607/beforeupdate-event-of-a-linked-subform-control-firing-multiple-times/30493998#30493998", "title": "BeforeUpdate event of a linked subform control firing multiple times", "body": "<p>OK finally found the solution. </p>\n\n<p>It was related to the text box used for storing the Link master fields used by my subform. This control contains the value of my combobox in order to filter out my subform.</p>\n\n<p>The control source definition of this link master field used to be:</p>\n\n<pre><code>=myCombobox.column(0)\n</code></pre>\n\n<p>By replacing the definition by just:</p>\n\n<pre><code>=myCombobox\n</code></pre>\n\n<p>The beforeUpdate event in my linked subform is only triggered once and behaves as expected;</p>\n\n<pre><code>Private Sub Text0_BeforeUpdate(Cancel As Integer)\n    If Me.Text0 = \"X\" Then\n        MsgBox \"Wrong Value\"\n        Cancel = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>I can not explained the magic of why it is behaving that way but this is how I made it worked.</p>\n\n<p>Sylvain</p>\n"}], "owner": {"reputation": 851, "user_id": 3439959, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/12f95022006dac6e10f1e107c74672b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sylvain C.", "link": "https://stackoverflow.com/users/3439959/sylvain-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 342, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1432764738, "creation_date": 1432703175, "question_id": 30473607, "link": "https://stackoverflow.com/questions/30473607/beforeupdate-event-of-a-linked-subform-control-firing-multiple-times", "title": "BeforeUpdate event of a linked subform control firing multiple times", "body": "<p>Good afternoon, </p>\n\n<p>I have to maintain an Access form which contain a linked subform (using Master and Child fields).</p>\n\n<p>Basically, in the main form, the user choose a value in a combobox and the subform is automatically updated.</p>\n\n<p>My issue is that I have a BeforeUpdate event on one field of my subform which is preventing to update the field (Cancel=true) when it does not meet the criteria. The alert msgbox should appear once if there is any error in the field but the BeforeUpdate event is always fired 3 times for unknown reason.</p>\n\n<p>I have created a simple accdb file which reproduce my issue. It is located here: <a href=\"https://www.hightail.com/download/bXBhU2V0Q1JxRTFsQXNUQw\" rel=\"nofollow\">https://www.hightail.com/download/bXBhU2V0Q1JxRTFsQXNUQw</a>.</p>\n\n<p>Open the Form1, choose a value in the combobox and then try to update one of the letters in the subform by X and you will get the msgbox appearing multiple times.</p>\n\n<p>Thanks in advance for your help on this issue as it's driving me crazy.</p>\n\n<p>Sylvain</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": true, "score": 2, "last_activity_date": 1432703006, "creation_date": 1432703006, "answer_id": 30473574, "question_id": 30473540, "link": "https://stackoverflow.com/questions/30473540/rangea-val-a-val2-select/30473574#30473574", "title": "Range(&quot;A&quot; &amp; val &quot;:A&quot; &amp; val2).Select", "body": "<p>You are missing an &amp; after val</p>\n"}], "owner": {"reputation": 29, "user_id": 3701694, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2465b45c48752903a5ca0de7daaeb2f2?s=128&d=identicon&r=PG&f=1", "display_name": "user3701694", "link": "https://stackoverflow.com/users/3701694/user3701694"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 366, "favorite_count": 0, "accepted_answer_id": 30473574, "answer_count": 1, "score": 0, "last_activity_date": 1432800521, "creation_date": 1432702838, "last_edit_date": 1531164843, "question_id": 30473540, "link": "https://stackoverflow.com/questions/30473540/rangea-val-a-val2-select", "title": "Range(&quot;A&quot; &amp; val &quot;:A&quot; &amp; val2).Select", "body": "<p>I am using inputbox for Val and Val2 values. These values i have to give in range of values but the syntax is showing incorrect.                        </p>\n\n<p>Please correct me. Many Thanks.                                    </p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 4843452, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b392671f5d71415d46aeb5ffcaea9c71?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/4843452/mark"}, "edited": false, "score": 0, "creation_date": 1432739165, "post_id": 30485268, "comment_id": 49051086, "body": "It seems that SetFocus is not a supported property in MS-Word for FormFields... but I <i>may</i> be able to use SendKeys and tab backwards... hold that thought!"}, {"owner": {"reputation": 1253, "user_id": 4036218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a98b5cd8145186c7adb64f0a87c9769?s=128&d=identicon&r=PG&f=1", "display_name": "DanielG", "link": "https://stackoverflow.com/users/4036218/danielg"}, "reply_to_user": {"reputation": 27, "user_id": 4843452, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b392671f5d71415d46aeb5ffcaea9c71?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/4843452/mark"}, "edited": false, "score": 0, "creation_date": 1432744000, "post_id": 30485268, "comment_id": 49054543, "body": "SendKeys &quot;+{TAB}&quot;, true may work for that purpose. Seems cryptic, but as long as it works! :-)"}], "tags": [], "owner": {"reputation": 1253, "user_id": 4036218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a98b5cd8145186c7adb64f0a87c9769?s=128&d=identicon&r=PG&f=1", "display_name": "DanielG", "link": "https://stackoverflow.com/users/4036218/danielg"}, "is_accepted": false, "score": 0, "last_activity_date": 1432736437, "creation_date": 1432736437, "answer_id": 30485268, "question_id": 30472393, "link": "https://stackoverflow.com/questions/30472393/select-combobox-if-wrong-item-selected/30485268#30485268", "title": "Select combobox if wrong item selected", "body": "<p>Will this work:</p>\n\n<pre><code>If ActiveDocument.FormFields(\"cbofactor1\").Result = \"(select one)\" Then\n    MsgBox \"You must select either Yes or No.\"\n    ActiveDocument.FormFields(\"cbofactor1\").SetFocus()\n    Exit Sub\nEnd If\n</code></pre>\n\n<p>You can auto drop the list with something like:</p>\n\n<pre><code> SendKeys \"%{down}\", True\n DoEvents\n</code></pre>\n\n<p>Full code:</p>\n\n<pre><code>If ActiveDocument.FormFields(\"cbofactor1\").Result = \"(select one)\" Then\n    MsgBox \"You must select either Yes or No.\"\n    ActiveDocument.FormFields(\"cbofactor1\").SetFocus()\n     SendKeys \"%{down}\", True\n     DoEvents\n    Exit Sub\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 4843452, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b392671f5d71415d46aeb5ffcaea9c71?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/4843452/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1432736437, "creation_date": 1432695546, "last_edit_date": 1432696040, "question_id": 30472393, "link": "https://stackoverflow.com/questions/30472393/select-combobox-if-wrong-item-selected", "title": "Select combobox if wrong item selected", "body": "<p>I have an MS-Word 2013 document with several (legacy) formfields; some text boxes, some comboboxes. The first list item on all of the comboboxes is \"(select one)\" to let the end user know they need to make a selection (I did not draft or design this document, I've just been asked to write the VBA code for it). So I coded each to give a simple VBA message box, ran on exit, if that first selection was not changed, for example:</p>\n\n<pre><code>Public factor1 As Integer\nSub MyFormFieldFactor1()\n  If ActiveDocument.FormFields(\"cbofactor1\").Result = \"(select one)\" Then\n    MsgBox \"You must select either Yes or No.\"\n    Exit Sub\n  End If\n\n  If ActiveDocument.FormFields(\"cbofactor1\").Result = \"Yes\" Then\n    factor1 = 1\n  Else\n    factor1 = 0\n  End If\nEnd Sub\n</code></pre>\n\n<p>The word document automatically goes to the next formfield when you click ok on the message box. Through VBA, I want it to stay on the current formfield when \"(select one)\" is chosen. Bonus points if it stays on the current field and pulls up the list selection automatically.</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1432682385, "creation_date": 1432682385, "answer_id": 30470593, "question_id": 30470381, "link": "https://stackoverflow.com/questions/30470381/userform-to-open-on-only-specific-sheets/30470593#30470593", "title": "Userform to open on only specific sheets", "body": "<pre><code>Private Sub Workbook_SheetActivate(ByVal Sh As Object)\n    If Sh.Name &lt;&gt; \"Front\" Then OpenDataEntryForm\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 4927416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93b930c6e0927c3f486073938cdaa0a9?s=128&d=identicon&r=PG&f=1", "display_name": "Jord27", "link": "https://stackoverflow.com/users/4927416/jord27"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 889, "favorite_count": 0, "accepted_answer_id": 30470593, "answer_count": 1, "score": 0, "last_activity_date": 1432682385, "creation_date": 1432681074, "question_id": 30470381, "link": "https://stackoverflow.com/questions/30470381/userform-to-open-on-only-specific-sheets", "title": "Userform to open on only specific sheets", "body": "<p>I am trying to create a workbook which is for parcel data, the sheets on the work book are specific to the weeks in the year so i have 52 sheets for the weeks named WK 1, Wk 2, Wk 3, etc etc.. and another sheet called \"Front\" which is displayed automatically when the user opens the workbook even if it saved on another sheet.</p>\n\n<p>From the front screen they can select the current week number thus leading them too the sheet and the userform pops up for the data entry to begin, my only problem i have at the minute is if i click back onto the front page the user form appears. Is there any way that i can disable it from opening?</p>\n\n<p>I have currently got some code for the \"Font\" sheet which stops it from opening when the work book is opened but it doesnt stop it when i move to a sheet and back again.</p>\n\n<p>So this  is currently what i have for my front sheet code.</p>\n\n<pre><code>Private Sub ComboBox1_Change()\nSheets(ComboBox1.Value).Select\nApplication.EnableEvents = False\nApplication.EnableEvents = True\n</code></pre>\n\n<p>And this is currently what i have for the workbook code.</p>\n\n<pre><code>Private Sub Workbook_Open()\nWorksheets(\"Front\").Activate\n\nDim iCount As Integer\n\nSheet1.ComboBox1.Clear\n\nFor iCount = 1 To Sheets.Count\n    Sheet1.ComboBox1.AddItem Sheets(iCount).Name\nNext iCount\nEnd Sub\n\nPrivate Sub Workbook_SheetActivate(ByVal Sh As Object)\nCall OpenDataEntryForm\nEnd Sub\n\nPublic Sub OpenDataEntryForm()\n\nDim dataEntryForm As ParcelDataEntry\n\nSet dataEntryForm = New ParcelDataEntry\n\ndataEntryForm.Show\n\nSet dataEntryForm = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1432681103, "post_id": 30470104, "comment_id": 49021107, "body": "Yes, it can be achieved. See <a href=\"http://meta.stackoverflow.com/questions/284236/why-is-can-someone-help-me-not-an-actual-question\">Why is &#39;Can someone help me?&#39; not an actual question?</a> and <a href=\"http://meta.stackoverflow.com/questions/260648/stack-overflow-question-checklist\">Stack Overflow question checklist</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1682, "user_id": 1012022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713ddfe465786d38f356e69f72c942a2?s=128&d=identicon&r=PG", "display_name": "robermann", "link": "https://stackoverflow.com/users/1012022/robermann"}, "edited": false, "score": 0, "creation_date": 1501226600, "post_id": 30470781, "comment_id": 77695195, "body": "You can also add just the column with <code>=IF(F1=TRIM(&quot;&quot;),-1,LEN(TRIM(F1))-LEN(SUBSTITUTE(TRIM(F1),&quot; &quot;,&quot;&quot;)))</code>, and then sort by the menu function, expanding the selection area."}], "tags": [], "owner": {"reputation": 279, "user_id": 2579685, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/538cdfae4c83af57db8b96d8df524656?s=128&d=identicon&r=PG", "display_name": "user2579685", "link": "https://stackoverflow.com/users/2579685/user2579685"}, "is_accepted": false, "score": 2, "last_activity_date": 1438035693, "last_edit_date": 1438035693, "creation_date": 1432683570, "answer_id": 30470781, "question_id": 30470104, "link": "https://stackoverflow.com/questions/30470104/excel-macro-to-sort-data-by-word-count-in-one-column-and-expanding-to-other-data/30470781#30470781", "title": "Excel macro to sort data by word count in one column and expanding to other data columns", "body": "<p>The simplest solution would be to use worksheet formula as suggested in <a href=\"https://support.microsoft.com/en-us/kb/213889\" rel=\"nofollow\">Microsoft support artice kb213889</a>.  If you are prepared to assume the deliminator is a ' ' for example and that the column will only contain valid words, in row L you could add a sort-index column with the following formula:</p>\n\n<pre><code>=IF(F1=TRIM(\"\"),-1,LEN(TRIM(F1))-LEN(SUBSTITUTE(TRIM(F1),\" \",\"\")))\n</code></pre>\n\n<p>There are several options for sorting on the basis of the indexed column e.g. VBA (e.g. <a href=\"http://www.oaltd.co.uk/excel/\" rel=\"nofollow\">Steve Bullen's QuickSort()</a>) or using standard Excel sorting functionality.</p>\n\n<p>If you insist on doing the entire calculation in VBA a possible solution would be to read the entire array into a variant and append an addition column onto the array and again use the QuickSort() algorithm above to sort the array. A simple function to count the number of words could be:</p>\n\n<pre><code>'count words in input string - assume only words passed in\nPublic Function CountWords(vInput As Variant, Optional sDelim As String = \" \") As Integer\nDim iWordCount as integer\nDim sString as string\n\n\n    sString = Trim$(vInput)\n\n    If Len(sString) = 0 Then\n        iWordCount = 0\n    ElseIf InStr(1, sString, sDelim) = 0 Then\n        iWordCount = 1\n    Else\n         'return array 0 based\n         iWordCount = UBound(VBA.Split(sString, sDelim)) + 1\n    End If\n\n    CountWords = iWordCount\n\nEnd \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 2166124, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4e4ef3f700139e9a436fdbc9b2313814?s=128&d=identicon&r=PG", "display_name": "Josef Miller", "link": "https://stackoverflow.com/users/2166124/josef-miller"}, "edited": false, "score": 0, "creation_date": 1432715459, "post_id": 30472679, "comment_id": 49033439, "body": "This is fabulous Vasily. I ran the code and it worked as expected and actually over expected as it sorted Col F in this order 1,10,11,12... 2,21,22 ...3,31,32...etc. Is it possible to get it sorted in an ascending order 1,2,3..10,11,12...20,21,22..etc instead? Very much appreciated."}, {"owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "reply_to_user": {"reputation": 113, "user_id": 2166124, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4e4ef3f700139e9a436fdbc9b2313814?s=128&d=identicon&r=PG", "display_name": "Josef Miller", "link": "https://stackoverflow.com/users/2166124/josef-miller"}, "edited": false, "score": 0, "creation_date": 1432719867, "post_id": 30472679, "comment_id": 49036539, "body": "@JosefMiller sure) post has been updated, now it works as you expected ... I guess)"}, {"owner": {"reputation": 113, "user_id": 2166124, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4e4ef3f700139e9a436fdbc9b2313814?s=128&d=identicon&r=PG", "display_name": "Josef Miller", "link": "https://stackoverflow.com/users/2166124/josef-miller"}, "edited": false, "score": 0, "creation_date": 1432725704, "post_id": 30472679, "comment_id": 49040564, "body": "Very impressive Vasily, the very exact result is reached by running the second version of the code. Thank you very much for your invaluable input which I&#39;m sure will benefit lots of other people. All the best."}], "tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": true, "score": 0, "last_activity_date": 1432720497, "last_edit_date": 1432720497, "creation_date": 1432697570, "answer_id": 30472679, "question_id": 30470104, "link": "https://stackoverflow.com/questions/30470104/excel-macro-to-sort-data-by-word-count-in-one-column-and-expanding-to-other-data/30472679#30472679", "title": "Excel macro to sort data by word count in one column and expanding to other data columns", "body": "<p>below variant based on assumption that your data table in range \"A:K\" (as you mentioned 11 columns). Replace \"Sheet1\" to the sheet name with your data</p>\n\n<pre><code>Sub sort_by_words_count()\n    Dim Cl As Range, S() As String, i&amp;\n    Application.ScreenUpdating = 0\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        i = .Cells.Find(\"*\", , , , xlByRows, xlPrevious).Row\n        For Each Cl In .Range(\"F2:F\" &amp; i)\n            S = Split(WorksheetFunction.Trim(Cl.Value))\n            Cl.Value = Right(\"0000\" &amp; UBound(S()) + 1, 4) &amp; \"|\" &amp; Cl.Value\n        Next Cl\n        If .AutoFilterMode Then .AutoFilterMode = False\n        .Range(\"A1:K\" &amp; i).AutoFilter\n        .AutoFilter.Sort.SortFields.Add _\n            Key:=Range(\"F1:F\" &amp; i), _\n            SortOn:=xlSortOnValues, _\n            Order:=xlAscending, _\n            DataOption:=xlSortNormal\n            With .AutoFilter.Sort\n                .Header = xlYes\n                .MatchCase = False\n                .Orientation = xlTopToBottom\n                .SortMethod = xlPinYin\n                .Apply\n            End With\n        For Each Cl In .Range(\"F2:F\" &amp; i)\n            Cl.Value = Split(Cl.Value, \"|\")(1)\n        Next Cl\n    End With\n    Application.ScreenUpdating = 1\nEnd Sub\n</code></pre>\n\n<p><strong>sheet before sort</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/WeZMB.jpg\" alt=\"enter image description here\"></p>\n\n<p><strong>sheet after sort</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/DUKd8.jpg\" alt=\"enter image description here\"></p>\n"}, {"tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1485791682, "last_edit_date": 1495541808, "creation_date": 1485791682, "answer_id": 41940130, "question_id": 30470104, "link": "https://stackoverflow.com/questions/30470104/excel-macro-to-sort-data-by-word-count-in-one-column-and-expanding-to-other-data/41940130#41940130", "title": "Excel macro to sort data by word count in one column and expanding to other data columns", "body": "<p>Assuming names are in column B, this macro puts all cells including both \"Jon\" and \"Smith\" into an array.  Another array is created to show how many words are in each array element.  The sort2 sub is then called to sort myArr by wordCountarr </p>\n\n<p>I found Sort2 sub <a href=\"https://stackoverflow.com/questions/29923742/vba-sort-array-based-on-another-array\">HERE</a> , it was written by member Gary's Student and appears to work flawlessly.  </p>\n\n<pre><code>Sub create2arr()\nDim myArr() As Variant, name1 As String, name2 As String, firstMarker As Boolean, myArrayCounter As Long, myArray2Counter As Long\nDim splitArr() As String, wordCountArr() As Variant\n\nname1 = \"Jon\"\nname2 = \"Smith\"\nReDim myArr(1 To 1)\nReDim myArr2(1 To 1)\nReDim wordCountArr(1 To 1)\n\nmyArrayCounter = 1\nmyArray2Counter = 1\n\nFor I = 1 To 3\n   splitArr = Split(Sheet6.Range(\"B\" &amp; I))\n   For J = LBound(splitArr) To UBound(splitArr)\n        If splitArr(J) = name1 Or splitArr(J) = name2 Then\n                If firstMarker = True Then\n                    myArr(myArrayCounter) = Sheet6.Range(\"B\" &amp; I)\n                    wordCountArr(myArrayCounter) = UBound(splitArr) + 1\n                    myArrayCounter = myArrayCounter + 1\n                    ReDim Preserve myArr(1 To myArrayCounter)\n                    ReDim Preserve wordCountArr(1 To myArrayCounter)\n                    firstMarker = False\n                Else\n                    firstMarker = True\n                End If\n        End If\n    Next J\nNext I\n\nFor I = 1 To UBound(myArr)\nDebug.Print myArr(I)\nNext I\n\nCall sort2(wordCountArr, myArr)\n\nFor I = 1 To UBound(myArr)\nDebug.Print myArr(I)\nNext I\n\n\nEnd Sub\n\nSub sort2(key() As Variant, other() As Variant)\nDim I As Long, J As Long, Low As Long\nDim Hi As Long, Temp As Variant\n    Low = LBound(key)\n    Hi = UBound(key)\n\n    J = (Hi - Low + 1) \\ 2\n    Do While J &gt; 0\n        For I = Low To Hi - J\n          If key(I) &gt; key(I + J) Then\n            Temp = key(I)\n            key(I) = key(I + J)\n            key(I + J) = Temp\n            Temp = other(I)\n            other(I) = other(I + J)\n            other(I + J) = Temp\n          End If\n        Next I\n        For I = Hi - J To Low Step -1\n          If key(I) &gt; key(I + J) Then\n            Temp = key(I)\n            key(I) = key(I + J)\n            key(I + J) = Temp\n            Temp = other(I)\n            other(I) = other(I + J)\n            other(I + J) = Temp\n          End If\n        Next I\n        J = J \\ 2\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 2166124, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4e4ef3f700139e9a436fdbc9b2313814?s=128&d=identicon&r=PG", "display_name": "Josef Miller", "link": "https://stackoverflow.com/users/2166124/josef-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 868, "favorite_count": 0, "accepted_answer_id": 30472679, "answer_count": 3, "score": -1, "last_activity_date": 1485791682, "creation_date": 1432679684, "question_id": 30470104, "link": "https://stackoverflow.com/questions/30470104/excel-macro-to-sort-data-by-word-count-in-one-column-and-expanding-to-other-data", "title": "Excel macro to sort data by word count in one column and expanding to other data columns", "body": "<p>I have a data worksheet of 11 columns and over 6000 rows. I need to sort column F by the number of words in each cell, smallest to largest, expanding the sort to the entire data in 11 columns.</p>\n\n<p>Can this be achieved? Appreciating any assistance in this matter.</p>\n"}, {"tags": ["vba", "excel", "sorting"], "comments": [{"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1432681674, "post_id": 30470042, "comment_id": 49021252, "body": "Is there anything that doesn&#39;t work as intended? If not then I recommend CodeReview instead."}, {"owner": {"reputation": 25, "user_id": 4789278, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ebcb780b272cb4efa639a4a3558d5aac?s=128&d=identicon&r=PG&f=1", "display_name": "chs", "link": "https://stackoverflow.com/users/4789278/chs"}, "reply_to_user": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1432681902, "post_id": 30470042, "comment_id": 49021321, "body": "I meant to mention this in the post, but i think the issue I&#39;m having is excel not accepting varTblSortName as the range in the =Range part. Each table is the same name as the active sheet. Ex a worksheet titled &quot;Countries&quot; has a table within it called &quot;Countries&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4789278, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ebcb780b272cb4efa639a4a3558d5aac?s=128&d=identicon&r=PG&f=1", "display_name": "chs", "link": "https://stackoverflow.com/users/4789278/chs"}, "edited": false, "score": 0, "creation_date": 1432687394, "post_id": 30471151, "comment_id": 49022924, "body": "thanks, that works perfectly! still learning vba, so what is the purpose of the Cbool line/can you explain it?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 25, "user_id": 4789278, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ebcb780b272cb4efa639a4a3558d5aac?s=128&d=identicon&r=PG&f=1", "display_name": "chs", "link": "https://stackoverflow.com/users/4789278/chs"}, "edited": false, "score": 0, "creation_date": 1432687818, "post_id": 30471151, "comment_id": 49023029, "body": "It generally isn&#39;t necessary as <i>False</i> is considered to be <i>0</i> and anything that is not <i>False</i> is <i>True</i>. Using <code>CBool</code> is really just my coding style and tells me that the <code>InStr</code> is being evaluated as boolean."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1432686827, "last_edit_date": 1432686827, "creation_date": 1432685990, "answer_id": 30471151, "question_id": 30470042, "link": "https://stackoverflow.com/questions/30470042/looping-through-multiple-worksheets-and-tables-to-do-a-multi-criteria-sort/30471151#30471151", "title": "Looping through multiple worksheets and tables to do a multi-criteria sort", "body": "<p>I've extended the use of With/End With and broken your string variables out of the quoted strings.</p>\n\n<pre><code>Sub sorter()\n' Keyboard Shortcut: Ctrl+Shift+F\n    Dim varTblSortName As Variant\n    Dim Client As Worksheet\n\n    For Each Client In ActiveWorkbook.Worksheets\n        With Client\n            If CBool(InStr(1, .Name, \"Client_\", vbTextCompare)) Then\n                varTblSortName = .Name\n                With .ListObjects(varTblSortName)\n                    .Sort.SortFields.Clear\n                    .Sort.SortFields.Add Key:=Range(varTblSortName &amp; \"[Asset Class]\"), SortOn:= _\n                        xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n                    .Sort.SortFields.Add Key:=Range(varTblSortName &amp; \"[Sector]\"), SortOn:=xlSortOnValues, _\n                        Order:=xlAscending, DataOption:=xlSortNormal\n                    .Sort.SortFields.Add Key:=Range(varTblSortName &amp; \"[Ticker]\"), SortOn:=xlSortOnValues, _\n                        Order:=xlAscending, DataOption:=xlSortNormal\n                    With .Sort\n                        .Header = xlYes\n                        .MatchCase = False\n                        .Orientation = xlTopToBottom\n                        .SortMethod = xlPinYin\n                        .Apply\n                    End With\n                End With\n            End If\n        End With\n    Next Client\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4789278, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ebcb780b272cb4efa639a4a3558d5aac?s=128&d=identicon&r=PG&f=1", "display_name": "chs", "link": "https://stackoverflow.com/users/4789278/chs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 443, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477686639, "creation_date": 1432679428, "last_edit_date": 1477686639, "question_id": 30470042, "link": "https://stackoverflow.com/questions/30470042/looping-through-multiple-worksheets-and-tables-to-do-a-multi-criteria-sort", "title": "Looping through multiple worksheets and tables to do a multi-criteria sort", "body": "<p>Trying to create a loop that goes through multiple worksheets, selects the table and sorts it based on multiple criteria. Each worksheet only has one table, and this is what I've come up with so far.                                </p>\n\n<pre><code>    Sub sorter()\n'\n' sorter Macro\n'\n' Keyboard Shortcut: Ctrl+Shift+F\n'\n\nDim varTblSortName As Variant\nvarTblSortName = ActiveSheet.Name\nDim Client As Worksheet\nDim rng As Range\n\n\n\nFor Each Client In ActiveWorkbook.Worksheets\n'This tests to make sure the code is only run on Client_ sheets\n    If InStr(1, Client.Name, \"Client_\", vbTextCompare) Then\n  Set rng = ActiveSheet.ListObjects(1)\n\n\n     Worksheets(Client.Name).Activate\n        'ActiveSheet.ListObjects(1).Range.Select\n\n            'Range(, Selection.End(xlDown)).Select\n            'Range(Selection, Selection.End(xlToRight)).Select\n            'ActiveWorkbook.Worksheets(\"Client_Jamie\").ListObjects(\"Client_Jamie\").Sort. _\n\n               ActiveSheet.ListObjects(1).Sort.SortFields.Clear\n            ActiveWorkbook.ActiveSheet.ListObjects(1).Sort. _\n                SortFields.Add Key:=Range(\"varTblSortName[Asset Class]\"), SortOn:= _\n                xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n            ActiveWorkbook.ActiveSheet.ListObjects(1).Sort. _\n                SortFields.Add Key:=Range(\"varTblSortName[Sector]\"), SortOn:=xlSortOnValues, _\n                Order:=xlAscending, DataOption:=xlSortNormal\n            ActiveWorkbook.ActiveSheet.ListObjects(\"varTblSortName\").Sort. _\n                SortFields.Add Key:=Range(\"varTblSortName[Ticker]\"), SortOn:=xlSortOnValues, _\n                Order:=xlAscending, DataOption:=xlSortNormal\n            With ActiveWorkbook.ActiveSheet.ListObjects(\"varTblSortName\").Sort\n                .Header = xlYes\n                .MatchCase = False\n                .Orientation = xlTopToBottom\n                .SortMethod = xlPinYin\n                .Apply\n            End With\n            End If\n        Next Client\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "controls"], "answers": [{"comments": [{"owner": {"reputation": 5811, "user_id": 1038866, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh6.googleusercontent.com/-6zydemrOVos/AAAAAAAAAAI/AAAAAAAAABE/J4ZvWM6D2Ts/photo.jpg?sz=128", "display_name": "bgmCoder", "link": "https://stackoverflow.com/users/1038866/bgmcoder"}, "edited": false, "score": 1, "creation_date": 1432678933, "post_id": 30469873, "comment_id": 49020311, "body": "That was it!  I was missing the <code>!</code> part.  Thanks for the quick answer!"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 5811, "user_id": 1038866, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh6.googleusercontent.com/-6zydemrOVos/AAAAAAAAAAI/AAAAAAAAABE/J4ZvWM6D2Ts/photo.jpg?sz=128", "display_name": "bgmCoder", "link": "https://stackoverflow.com/users/1038866/bgmcoder"}, "edited": false, "score": 0, "creation_date": 1432680106, "post_id": 30469873, "comment_id": 49020755, "body": "Glad it worked.  But I don&#39;t understand why <code>!</code> was key.  I can refer to my combo box with either <code>Me.MyComboName</code> or <code>Me!MyComboName</code>"}, {"owner": {"reputation": 5811, "user_id": 1038866, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh6.googleusercontent.com/-6zydemrOVos/AAAAAAAAAAI/AAAAAAAAABE/J4ZvWM6D2Ts/photo.jpg?sz=128", "display_name": "bgmCoder", "link": "https://stackoverflow.com/users/1038866/bgmcoder"}, "edited": false, "score": 0, "creation_date": 1432680201, "post_id": 30469873, "comment_id": 49020795, "body": "You can refer to the combobox that way, but NOT the label attached to the combobox"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 5811, "user_id": 1038866, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh6.googleusercontent.com/-6zydemrOVos/AAAAAAAAAAI/AAAAAAAAABE/J4ZvWM6D2Ts/photo.jpg?sz=128", "display_name": "bgmCoder", "link": "https://stackoverflow.com/users/1038866/bgmcoder"}, "edited": false, "score": 0, "creation_date": 1432680414, "post_id": 30469873, "comment_id": 49020878, "body": "I think something else is going on.  <code>TypeName(Me.txtProj_members)</code> tells me <i>ComboBox</i>, <code>Me.txtProj_members.Controls(0).Name</code> shows me the <code>Name</code> of the associated label control, and then <code>Me.txtProj_members.Controls(0).Caption</code> shows me the label&#39;s <code>Caption</code> text."}, {"owner": {"reputation": 5811, "user_id": 1038866, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh6.googleusercontent.com/-6zydemrOVos/AAAAAAAAAAI/AAAAAAAAABE/J4ZvWM6D2Ts/photo.jpg?sz=128", "display_name": "bgmCoder", "link": "https://stackoverflow.com/users/1038866/bgmcoder"}, "edited": false, "score": 0, "creation_date": 1432740458, "post_id": 30469873, "comment_id": 49052101, "body": "Are you testing with Access VBA 2010?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 5811, "user_id": 1038866, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh6.googleusercontent.com/-6zydemrOVos/AAAAAAAAAAI/AAAAAAAAABE/J4ZvWM6D2Ts/photo.jpg?sz=128", "display_name": "bgmCoder", "link": "https://stackoverflow.com/users/1038866/bgmcoder"}, "edited": false, "score": 0, "creation_date": 1432740670, "post_id": 30469873, "comment_id": 49052262, "body": "Yes. (filler characters)"}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 1, "last_activity_date": 1432678536, "creation_date": 1432678536, "answer_id": 30469873, "question_id": 30469745, "link": "https://stackoverflow.com/questions/30469745/how-to-get-label-text-from-control/30469873#30469873", "title": "How to get label text from control?", "body": "<p>The label can be referenced as item 0 in the parent control's <code>.Controls</code> collection, and the label's text is its <code>.Caption</code> property.</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>If IsNull(Me.EditControl) Then\n    msgbox \"My label's text is: \" &amp; Me!EditControl.Controls(0).Caption\nElseif IsNull(Me.ComboboxControl) Then\n    msgbox \"My label's text is: \" &amp; Me!ComboboxControl.Controls(0).Caption\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 5811, "user_id": 1038866, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh6.googleusercontent.com/-6zydemrOVos/AAAAAAAAAAI/AAAAAAAAABE/J4ZvWM6D2Ts/photo.jpg?sz=128", "display_name": "bgmCoder", "link": "https://stackoverflow.com/users/1038866/bgmcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2331, "favorite_count": 0, "accepted_answer_id": 30469873, "answer_count": 1, "score": 1, "last_activity_date": 1432678719, "creation_date": 1432677882, "last_edit_date": 1495540691, "question_id": 30469745, "link": "https://stackoverflow.com/questions/30469745/how-to-get-label-text-from-control", "title": "How to get label text from control?", "body": "<p>On my Access form I have an edit control and a combobox.  Each has a label that is attached to it on the form.</p>\n\n<p>In the code, how can I fetch the text of the label for each control?  I want to produce a msgbox using the label's text.</p>\n\n<p>I am thinking to do something like this [you can't do this, by the way]?</p>\n\n<pre><code>If IsNull(Me.EditControl) Then\n   msgbox \"My label's text is: \" &amp; me.EditControl.Label.text\nElseif IsNull(Me.ComboboxControl) Then\n    msgbox \"My label's text is: \" &amp; me.ComboboxControl.Label.text\nEnd If\n</code></pre>\n\n<p>I would like to fetch the label without having to know the label's ID.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/1637083/how-to-access-the-label-of-a-control-in-code\">I've read through this</a>, but it doesn't seem to work for me.  The intellisense doesn't recognize the construction.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": false, "score": 0, "last_activity_date": 1432679058, "creation_date": 1432679058, "answer_id": 30469975, "question_id": 30469631, "link": "https://stackoverflow.com/questions/30469631/how-is-it-possible-by-using-a-macro-to-reopen-the-workbook-and-suppression-of-pr/30469975#30469975", "title": "How is it possible by using a macro to reopen the workbook and suppression of private sub workbook_open", "body": "<p>This is NOT tested code but should open a workbook with macros disabled.</p>\n\n<pre><code>Public Function OpenWorkbookWithMacrosDisabled(ByRef filePathAndName As String, Optional ByRef openReadOnly As Boolean = False) As Boolean\n\n' Stores the current security settings\n' sets the security to High, then opens the workbook\n' Sets the security settings back to their original settings\n' Simon Leten 27-Jun-2014\n\nDim secAutomation As MsoAutomationSecurity\nDim nameOfFile As String\nDim result As Boolean\n\n' *** Leave errors to get handled by the calling proc ***\n' On Error GoTo ErrorHandler\n' *** Leave errors to get handled by the calling proc ***\n\nConst PROC_NAME As String = \"OpenWorkbookWithMacrosDisabled\"\n\nresult = False\n\nsecAutomation = Application.AutomationSecurity\n\nnameOfFile = Dir$(filePathAndName)\nIf nameOfFile = \"\" Then\n    Err.Raise vbObjectError + 0, PROC_NAME, \"Cannot find the file '\" &amp; filePathAndName &amp; \"'.\"\nElse\n    If WorkbookIsOpen(nameOfFile) Then\n        Err.Raise vbObjectError + 0, PROC_NAME, \"A file with the name '\" &amp; nameOfFile &amp; \"' is already open.\"\n    Else\n        Application.AutomationSecurity = msoAutomationSecurityForceDisable\n        Application.Workbooks.Open Filename:=filePathAndName, ReadOnly:=openReadOnly, AddToMru:=False\n        result = True\n    End If\nEnd If\n\nExitProc:\nApplication.AutomationSecurity = secAutomation\nOpenWorkbookWithMacrosDisabled = result\nExit Function\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1432682072, "creation_date": 1432682072, "answer_id": 30470553, "question_id": 30469631, "link": "https://stackoverflow.com/questions/30469631/how-is-it-possible-by-using-a-macro-to-reopen-the-workbook-and-suppression-of-pr/30470553#30470553", "title": "How is it possible by using a macro to reopen the workbook and suppression of private sub workbook_open", "body": "<p>Say we have a workbook called <em>yesterday.xlsm</em> which we want to open but we do NOT  <em>yesterday</em>'s Open Event macro to trigger.  Run this in another workbook:</p>\n\n<pre><code>Sub PardonMyParanoia()\n   Application.EnableEvents = False\n   Workbooks.Open Filename:=\"C:\\TestFolder\\yesterday.xlsm\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 4548240, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/080d090ef4d153a1f25c572cf9809ee2?s=128&d=identicon&r=PG&f=1", "display_name": "Freek v. wely", "link": "https://stackoverflow.com/users/4548240/freek-v-wely"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1432682072, "creation_date": 1432677346, "last_edit_date": 1432678666, "question_id": 30469631, "link": "https://stackoverflow.com/questions/30469631/how-is-it-possible-by-using-a-macro-to-reopen-the-workbook-and-suppression-of-pr", "title": "How is it possible by using a macro to reopen the workbook and suppression of private sub workbook_open", "body": "<p>I want reopen a read-only workbook as read and write to change value's with a macro. </p>\n\n<p>I want suppression of the private sub workbook_open by reopen workbook:</p>\n\n<pre><code>    Private Sub Workbook_Open()\n\n    Application.DisplayAlerts = False\n    On Error Resume Next\n    ActiveWorkbook.ChangeFileAccess Mode:=xlReadOnly\n</code></pre>\n\n<p>Can anyone help me with this problem?</p>\n\n<p>I know that I have to use a temporary workbook for running the macro for reopening. But I can't find the right vba code. </p>\n"}, {"tags": ["vba", "excel", "excel-2011", "ribbonx"], "comments": [{"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1432678444, "post_id": 30469516, "comment_id": 49020117, "body": "You want to create/edit the ribbon while using a Mac?"}, {"owner": {"reputation": 317, "user_id": 1414792, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/d84a145fffdfc658947da67f08cc350a?s=128&d=identicon&r=PG", "display_name": "sharky", "link": "https://stackoverflow.com/users/1414792/sharky"}, "reply_to_user": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1432706304, "post_id": 30469516, "comment_id": 49028175, "body": "@ChipsLetten nope that is not a necessary condition. I can build it on a Windows"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1432710147, "post_id": 30469516, "comment_id": 49030206, "body": "You can&#39;t customise the Ribbon in Mac Office currently."}, {"owner": {"reputation": 317, "user_id": 1414792, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/d84a145fffdfc658947da67f08cc350a?s=128&d=identicon&r=PG", "display_name": "sharky", "link": "https://stackoverflow.com/users/1414792/sharky"}, "edited": false, "score": 0, "creation_date": 1432724366, "post_id": 30469516, "comment_id": 49039613, "body": "is there any other way i could get buttons or other such options in the UI which triggers a macro in the backend?"}], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 1414792, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/d84a145fffdfc658947da67f08cc350a?s=128&d=identicon&r=PG", "display_name": "sharky", "link": "https://stackoverflow.com/users/1414792/sharky"}, "edited": false, "score": 0, "creation_date": 1437936194, "post_id": 31637770, "comment_id": 51227776, "body": "is there any other possible way to customize the Fluent UI on a Mac?"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 317, "user_id": 1414792, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/d84a145fffdfc658947da67f08cc350a?s=128&d=identicon&r=PG", "display_name": "sharky", "link": "https://stackoverflow.com/users/1414792/sharky"}, "edited": false, "score": 0, "creation_date": 1437942495, "post_id": 31637770, "comment_id": 51229798, "body": "No, I don&#39;t know any other way."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1437918925, "creation_date": 1437918925, "answer_id": 31637770, "question_id": 30469516, "link": "https://stackoverflow.com/questions/30469516/ui-for-creating-a-custom-tab-in-ribbons-for-an-add-in-for-excel-for-mac/31637770#31637770", "title": "UI for creating a custom tab in ribbons for an add in for Excel for Mac", "body": "<p>Firstly, Office for Mac doesn't support COM add-ins. The COM technology lives on Windows only. Instead, you may consider developing an Office App. See <a href=\"https://msdn.microsoft.com/en-us/library/office/jj220060.aspx\" rel=\"nofollow\">Office Add-ins</a> for more information. Note, at the #build2015 MS called Office Apps as add-ins. Anyway, you can't customize the Fluent UI using Apps/add-ins.</p>\n"}, {"comments": [{"owner": {"reputation": 1070, "user_id": 181761, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9899f31fe97387a17c51a2e4c42506d4?s=128&d=identicon&r=PG", "display_name": "amr osama", "link": "https://stackoverflow.com/users/181761/amr-osama"}, "edited": false, "score": 0, "creation_date": 1567435532, "post_id": 35466193, "comment_id": 101953947, "body": "This is great solution, it worked for me on PowerPoint also"}], "tags": [], "owner": {"reputation": 821, "user_id": 537135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f2d64b002580d194a48959aa4f9292?s=128&d=identicon&r=PG", "display_name": "julianm", "link": "https://stackoverflow.com/users/537135/julianm"}, "is_accepted": false, "score": 3, "last_activity_date": 1455738125, "creation_date": 1455738125, "answer_id": 35466193, "question_id": 30469516, "link": "https://stackoverflow.com/questions/30469516/ui-for-creating-a-custom-tab-in-ribbons-for-an-add-in-for-excel-for-mac/35466193#35466193", "title": "UI for creating a custom tab in ribbons for an add in for Excel for Mac", "body": "<p>I know a workaround, but you need to be able to edit the VBA Code in Windows first and save your Macro-enabled .xlsm spreadsheet as a .xlam file. To create the ribbon, the method relies on a 3rd party software called Office Ribbon Editor. Then, go to your Mac computer and install the addin from Tools -> Addins menu.</p>\n\n<p><strong>Part A: Create a custom Ribbon tab for Microsoft Excel in Windows</strong></p>\n\n<p>Here are the detailed steps:</p>\n\n<ol>\n<li><p>Install Office Ribbon Editor. You'd need to download the latest .NET Framework pack during the install process.</p></li>\n<li><p>Once installed, use Run as Administrator to open the Office Ribbon Editor.</p></li>\n<li><p>Create a new Excel 2010 Spreadsheet. </p></li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/c3g8p.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/c3g8p.png\" alt=\"Create a New Excel worksheet add-in\"></a></p>\n\n<p>Here, you'll need to specify the output file. Choose Excel Macro Enabled Workbook (*.xlsm)</p>\n\n<p><a href=\"https://i.stack.imgur.com/VoRIo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VoRIo.png\" alt=\"Save Macro-enabled Excel file\"></a></p>\n\n<ol start=\"4\">\n<li>Add a Custom UI for Office 2010 using Document Explorer pane (at the right).</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/HGQve.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HGQve.png\" alt=\"Add a custom UI\"></a></p>\n\n<ol start=\"5\">\n<li>Use the following code template for the Custom UI content. Edit accordingly.</li>\n</ol>\n\n<p>code snippet:</p>\n\n<pre><code>&lt;customUI xmlns=\"http://schemas.microsoft.com/office/2009/07/customui\"&gt;\n  &lt;ribbon startFromScratch=\"false\"&gt;\n    &lt;tabs&gt;\n        &lt;tab id=\"excelTab\" label=\"FPPT\"&gt;\n            &lt;group id=\"groupExport\" label=\"Export\"&gt;\n              &lt;button id=\"btnExportJPG\" label=\"Export JPG\" imageMso=\"ExportHtmlDocument\" size=\"large\" onAction=\"ExportImages\" /&gt;\n            &lt;/group&gt;\n&lt;group id=\"groupOptions\" label=\"Options\"&gt;\n                &lt;button id=\"btnAbout\" label=\"About\" imageMso=\"FunctionsLogicalInsertGallery\" size=\"large\" onAction=\"About\" /&gt;\n            &lt;/group&gt;\n        &lt;/tab&gt;\n    &lt;/tabs&gt;\n  &lt;/ribbon&gt;\n&lt;/customUI&gt;\n</code></pre>\n\n<ol start=\"6\">\n<li><p>Save the changes and close the application.</p></li>\n<li><p>Now, open the .xlsm file using Microsoft Excel for Windows. </p></li>\n<li><p>Enable the <strong>Developers</strong> tab in the Ribbon.</p></li>\n<li><p>Click VBA Code to view the source code and add a new Module. Then, create a Sub that will be executed when the user clicks the button. For the code I specified above, you'd need to create <code>Sub ExportImages()</code>.</p></li>\n<li><p>Finally, close the VBA editor and click File -> Save As to save your spreadsheet as an Excel Add-in (*.xlam).</p></li>\n</ol>\n\n<p><strong>Part B: Install the add-in on Mac</strong></p>\n\n<ol>\n<li><p>Go to your Mac and open Microsoft Excel for Mac.</p></li>\n<li><p>Go to Tools -> Add-ins and browse for the xlam file you created using Windows.</p></li>\n</ol>\n\n<p>Once the add-in is enabled you should be able to see the custom UI tab in the Ribbon.</p>\n\n<p><a href=\"https://i.stack.imgur.com/9PPYB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9PPYB.png\" alt=\"Custom Ribbon in Excel for Mac\"></a></p>\n\n<p><strong>Misc:</strong></p>\n\n<p>The process also works for other Microsoft Office programs: Excel, PowerPoint and Word. I didn't test the approach for Outlook add-ins.</p>\n\n<p>In fact, I have used this approach to make an add-in for Mac and Windows that exports all the presentation slides in PowerPoint to JPG images, with a single click. This helped me to save valuable time (for years) while uploading the <a href=\"http://www.free-power-point-templates.com/\" rel=\"nofollow noreferrer\">free PowerPoint templates</a> to my site.</p>\n"}], "owner": {"reputation": 317, "user_id": 1414792, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/d84a145fffdfc658947da67f08cc350a?s=128&d=identicon&r=PG", "display_name": "sharky", "link": "https://stackoverflow.com/users/1414792/sharky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3263, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1465510444, "creation_date": 1432676829, "last_edit_date": 1495542696, "question_id": 30469516, "link": "https://stackoverflow.com/questions/30469516/ui-for-creating-a-custom-tab-in-ribbons-for-an-add-in-for-excel-for-mac", "title": "UI for creating a custom tab in ribbons for an add in for Excel for Mac", "body": "<p>Is there any other simple way apart from using the Custom UI Editor as mentioned <a href=\"https://stackoverflow.com/questions/8850836/how-to-add-a-custom-ribbon-tab-using-vba/8852767#8852767\">here</a>? I've tried this method. It works fine for Excel on Windows but simply does not load anything on a Mac.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 4848470, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10153239800741250/picture?type=large", "display_name": "Micah Lankford", "link": "https://stackoverflow.com/users/4848470/micah-lankford"}, "edited": false, "score": 0, "creation_date": 1432732895, "post_id": 30470264, "comment_id": 49046004, "body": "This works great! Thank you so much. Do you have any ideas on how to select a cell above the revision in case there isn&#39;t a step number at the beginning of the row?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 17, "user_id": 4848470, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10153239800741250/picture?type=large", "display_name": "Micah Lankford", "link": "https://stackoverflow.com/users/4848470/micah-lankford"}, "edited": false, "score": 0, "creation_date": 1432738590, "post_id": 30470264, "comment_id": 49050642, "body": "If you need the cell above then   <code>Set c = rng.Tables(1).Cell(rownum-1, 1)</code> should do it.  With a check you&#39;re not already on the first row...."}, {"owner": {"reputation": 17, "user_id": 4848470, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10153239800741250/picture?type=large", "display_name": "Micah Lankford", "link": "https://stackoverflow.com/users/4848470/micah-lankford"}, "edited": false, "score": 0, "creation_date": 1432749437, "post_id": 30470264, "comment_id": 49057737, "body": "Oh duuuuuhhh. Thanks a bunch."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1432680434, "creation_date": 1432680434, "answer_id": 30470264, "question_id": 30469165, "link": "https://stackoverflow.com/questions/30469165/find-revision-and-report-the-step-number-where-the-revision-occurs/30470264#30470264", "title": "Find revision and report the step number where the revision occurs", "body": "<p>You can use the <code>Table.Cell(r, c)</code> approach to get around your merged cells issue:</p>\n\n<pre><code>Sub Tester()\n\n    Dim rng As Range, rev As Revision, c As Cell\n    Dim rownum As Long\n\n    For Each rev In ThisDocument.Revisions\n\n        Set rng = rev.Range\n        rng.Collapse direction:=wdCollapseStart\n\n        If rng.Information(wdWithInTable) Then\n\n            rownum = rng.Information(wdEndOfRangeRowNumber)\n\n            Set c = rng.Tables(1).Cell(rownum, 1) 'first cell on the row\n\n            Debug.Print c.Range.Paragraphs(1).Range.ListFormat.ListString\n\n        End If\n    Next rev\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 4848470, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10153239800741250/picture?type=large", "display_name": "Micah Lankford", "link": "https://stackoverflow.com/users/4848470/micah-lankford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 30470264, "answer_count": 1, "score": 0, "last_activity_date": 1432680434, "creation_date": 1432675380, "question_id": 30469165, "link": "https://stackoverflow.com/questions/30469165/find-revision-and-report-the-step-number-where-the-revision-occurs", "title": "Find revision and report the step number where the revision occurs", "body": "<p>I'm working on a code that will find revisions in a Word document, and report the revision and number from the list (the step number) in a separate table (which is already set up and good to go). (See the attached picture). So for example, any revision in row 3 will report step number 10.1. So what I was thinking was that for each revision it would go to the HOME cell on the row where the step number is located (and then if there is none it moves up to find one). That worked fine when there wasn't any revisions and I just placed the cursor in random cells. I think what's wrong with my code is that it's not placing the cursor at the revision, so having code moving the cursor to the beginning row doesn't do anything. \nI tried changing \nstepnumber = oRevision.Range.Paragraphs(1).Range.ListFormat.ListString \nto \nstepnumber = oRevision.Range.Rows(1).Range.ListFormat.ListString \nbut got the error for vertically merged cells. \nHow can I get the revision text and step number for any cell in the table?</p>\n\n<pre><code>Dim oRange As Range\nDim oRevision As Revision\nDim strText As String\nDim n As Long\nDim i As Long\n\nFor Each oRevision In oDoc.Revisions\n    Select Case oRevision.Type\n        'Only include insertions and deletions\n        Case wdRevisionInsert, wdRevisionDelete\n            'In case of footnote/endnote references (appear as Chr(2)),\n            'insert \"[footnote reference]\"/\"[endnote reference]\"\n            With oRevision\n                'Get the changed text\n                strText = .Range.Text\n\nstepnumber = oRevision.Range.Paragraphs(1).Range.ListFormat.ListString\n\nIf oRevision.Range.Rows(1).Range.ListFormat.ListString = \"\" Then\noRevision.Range.Select\nSelection.HomeKey Unit:=wdRow\nstepnumber = oRevision.Range.Paragraphs(1).Range.ListFormat.ListString\n\nElseIf oRevision.Range.Paragraphs(1).Range.ListFormat.ListString = \"\" Then\nDo\nSelection.MoveUp Unit:=wdLine, Count:=1\nLoop Until oRevision.Range.Paragraphs(1).Range.ListFormat.ListString &lt;&gt; \"\"\nstepnumber = oRevision.Range.Paragraphs(1).Range.ListFormat.ListString\nEnd If\n\n                End With\n            'Add 1 to counter\n            n = n + 1\n            'Add row to table\n            Set oRow = oTable.Rows.Add\n\n            'Insert data in cells in oRow\n            With oRow\n\n\n                'SECTION\n                    .Cells(1).Range.Text = _\n                    \"Step \" &amp; stepnumber\n\n                'Type of revision\n                If oRevision.Type = wdRevisionInsert Then\n                    .Cells(2).Range.Text = \"Inserted: \" &amp; strText\n                    .Range.Font.Bold = False\n\n                Else\n                    .Cells(2).Range.Text = \"Deleted: \" &amp; strText\n                    .Range.Font.Bold = False\n                End If\n\n            End With\n    End Select\nNext oRevision\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/ZbwBE.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["excel", "vba", "shell"], "answers": [{"comments": [{"owner": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "edited": false, "score": 0, "creation_date": 1432812278, "post_id": 30472395, "comment_id": 49085731, "body": "This seems like it would work! I&#39;ll confirm in the afternoon."}, {"owner": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "edited": false, "score": 0, "creation_date": 1432842707, "post_id": 30472395, "comment_id": 49106851, "body": "I couldn&#39;t get it to work. Windows 8 Excel freezes, but resumes after pressing escape. It gives an error and clicking Debug... highlights this in the link above: &quot;Exit Function&quot; for the Error_Handler_Exit label."}, {"owner": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "edited": false, "score": 0, "creation_date": 1432843240, "post_id": 30472395, "comment_id": 49107153, "body": "Nevermind I figured it out. It was looping forever because &quot;Snipping Tool.exe&quot; did not exist. It was &quot;SnippingTool.exe&quot;"}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": true, "score": 2, "last_activity_date": 1432695553, "creation_date": 1432695553, "answer_id": 30472395, "question_id": 30469001, "link": "https://stackoverflow.com/questions/30469001/open-application-using-shell-then-wait-until-it-opens-to-continue-commands/30472395#30472395", "title": "Open application using Shell, then wait until it opens to continue commands", "body": "<p>You could start the Exe then take the IsExeRunning function from here:</p>\n\n<p><a href=\"http://www.devhut.net/2014/10/20/vba-wmi-determine-if-a-process-is-running-or-not/\" rel=\"nofollow\">http://www.devhut.net/2014/10/20/vba-wmi-determine-if-a-process-is-running-or-not/</a></p>\n\n<p>And loop on Do until IsExeRunning(SnippingToolExecutable)</p>\n"}], "owner": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5173, "favorite_count": 0, "accepted_answer_id": 30472395, "answer_count": 1, "score": 1, "last_activity_date": 1585085254, "creation_date": 1432674769, "last_edit_date": 1585085254, "question_id": 30469001, "link": "https://stackoverflow.com/questions/30469001/open-application-using-shell-then-wait-until-it-opens-to-continue-commands", "title": "Open application using Shell, then wait until it opens to continue commands", "body": "<p>Basically I want to replicate the Windows 7 style Snipping Tool so when you open it, it gets a snip ready. But in Windows 8, all it does is open the program and you either have to press CTRL+N or click New. I would like to avoid using Sleep(100) or other time functions as it can be unreliable for different systems under certain loads. I tried looping                                     </p>\n\n<pre><code>While error &lt;&gt; 0\nAppActivate \"Snipping Tool\", True\napplication.SendKeys \"^N\", True\nexit sub\nWend\n</code></pre>\n\n<p>Ok. That's not what I used, but it's along the same lines. The problem with that is it kept giving VB Debug errors (which is good and all, except for this instance) and ruined this possible solution. Any other ideas to wait for the shell to open the program before being able to run            </p>\n\n<pre><code>Application.SendKeys \"^N\", True\n</code></pre>\n\n<p>I have also tried using </p>\n\n<pre><code>shell.Run FileLocation, 1 , True\n</code></pre>\n\n<p>but that runs the sendkeys AFTER it closes! It's nearly what I want.</p>\n\n<hr>\n\n<p>EDIT: WORKING CODE BELOW</p>\n\n<pre><code>//Used to wait for 200 milliseconds in the Sub.\nPublic Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\nPublic Function IsExeRunning(sExeName As String, Optional sComputer As String = \".\") As Boolean\nOn Error GoTo Error_Handler\nDim objProcesses    As Object\n\nSet objProcesses = GetObject(\"winmgmts:{impersonationLevel=impersonate}!\\\\\" &amp; sComputer &amp; \"\\root\\cimv2\").ExecQuery(\"SELECT * FROM Win32_Process WHERE Name = '\" &amp; sExeName &amp; \"'\")\nIf objProcesses.Count &lt;&gt; 0 Then IsExeRunning = True\n\nError_Handler_Exit:\nOn Error Resume Next\nSet objProcesses = Nothing\nExit Function\n\nError_Handler:\nMsgBox \"The following error has occured.\" &amp; vbCrLf &amp; vbCrLf &amp; _\n        \"Error Number: IsExeRunning\" &amp; vbCrLf &amp; _\n        \"Error Description: \" &amp; Err.Description, _\n        vbCritical, \"An Error has Occured!\"\nResume Error_Handler_Exit\n\nEnd Function\n\nSub SnipTool()\n\nDim wsh As Object\nSet wsh = VBA.CreateObject(\"WScript.Shell\")\n\nwsh.Run \"C:\\Windows\\sysnative\\SnippingTool.exe\"\nX = 0\nSelect Case Mid(Application.OperatingSystem, 21)\nCase 6.02\nDo Until IsExeRunning(\"SnippingTool.exe\") = True Or X = 200\n//added Timeout if snipping tool fails to load. Prevents Excel freezing.\nX = X + 1\nLoop\nSleep (200)\nAppActivate \"Snipping Tool\", True\nApplication.SendKeys \"^N\", True\nEnd Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 0, "creation_date": 1432678693, "post_id": 30468563, "comment_id": 49020207, "body": "Be more specific about which part isn&#39;t working. I gather that the last 4 lines are where you are trying to populate the combobox, but in order to help, show us the code for maleInitArray and femailInitArray."}, {"owner": {"reputation": 189, "user_id": 3366154, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/xZbUk.jpg?s=128&g=1", "display_name": "Podis", "link": "https://stackoverflow.com/users/3366154/podis"}, "reply_to_user": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 0, "creation_date": 1432679895, "post_id": 30468563, "comment_id": 49020669, "body": "No problem! I edited it a bit.  The copy/paste doesn&#39;t work well in these.. haha"}, {"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 0, "creation_date": 1432685294, "post_id": 30468563, "comment_id": 49022338, "body": "I&#39;m a little perplexed as to why you would hard-code the student data when you are working in Excel. Try putting that data in a worksheet and take a look at <a href=\"http://www.contextures.com/Excel-VBA-ComboBox-Lists.html\" rel=\"nofollow noreferrer\">this article about how to populate arrays from Excel ranges</a>. Start with assuming a specific user selection (e.g. male soccer players) and once you have the combobox code working then move on to populating it with different sets of students depending on the user&#39;s selection."}, {"owner": {"reputation": 189, "user_id": 3366154, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/xZbUk.jpg?s=128&g=1", "display_name": "Podis", "link": "https://stackoverflow.com/users/3366154/podis"}, "reply_to_user": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 0, "creation_date": 1432687355, "post_id": 30468563, "comment_id": 49022910, "body": "Haha.. I know hard coding the data while working in excel is a bit goofy.  I just wanted to see if it worked this way as well.  I can take out the variables and use the loop in every then/else statement and it works just fine.  Again.. just seeing if it can be done or not =)"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1432707281, "post_id": 30468563, "comment_id": 49028623, "body": "Haha... It can&#39;t be, to do this you need reflection which is not available in VBA. Also <code>dim sport as string</code> and then <code>l = UBound(sport)</code>, how??"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1432712675, "post_id": 30468563, "comment_id": 49031749, "body": "You could store the arrays in a Collection or Dictionary, then you could use the key (&quot;male&quot; or &quot;female&quot; to access the relevant array by name."}, {"owner": {"reputation": 189, "user_id": 3366154, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/xZbUk.jpg?s=128&g=1", "display_name": "Podis", "link": "https://stackoverflow.com/users/3366154/podis"}, "edited": false, "score": 0, "creation_date": 1432750411, "post_id": 30468563, "comment_id": 49058266, "body": "I just ended up hard coding it in there.. I did however take them all and make an array of classes that fit my needs. =)"}], "owner": {"reputation": 189, "user_id": 3366154, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/xZbUk.jpg?s=128&g=1", "display_name": "Podis", "link": "https://stackoverflow.com/users/3366154/podis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1432679832, "creation_date": 1432673163, "last_edit_date": 1531164843, "question_id": 30468563, "link": "https://stackoverflow.com/questions/30468563/using-variables-as-module-array-names", "title": "Using Variables as module/array names", "body": "<p>My ultimate goal is to load a comboBox with elements from different arrays (vba coded).  I have 8 different arrays and 6 option buttons.  The first 2 optionButtons are grouped to eliminate 4 arrays which leaves the last 4 grouped optionButtons to determine the actual input for the combo box.</p>\n\n<p>It works like this:</p>\n\n<pre><code>'first grouped option buttons\nmaleOptionButton\nfemaleOptionButton\n\n'second grouped option buttons\nbasketballOptionButton\nfootballOptionButton\nsoccerOptionButton\nhockeyOptionButton\n</code></pre>\n\n<p>The array's as you can guess are filled with student names that play the sports.  So when the user clicks the first grouped buttons of Male/Female the click even does nothing.. however when they click the second group of option buttons of sports, it calls the same sub procedure within a module that has IF's and Else Ifs to determine the combination of buttons that were selected.</p>\n\n<p>sub maleInitArray()</p>\n\n<pre><code>'declaration section:\nPublic maleSoccerArray(1 to 6) as string\n\n'sub section\ndim mike as student 'calls the class student\nset mike = new student\n\nwith mike\n    .name = \"Michael\"\n    .age = 14\n    .so on and so on = something\nend with\n\nmaleSoccerArray(1) = mike.name\nEnd Sub\n</code></pre>\n\n<p>What I'm trying to do is this:</p>\n\n<pre><code>dim i as integer\ndim l as integer\ndim gender as string\ndim sport as string\n\nif inputForm.soccerOptionButton.value = true then\n    if inputForm.maleOptionButton.value = true then\n        gender = \"male\"\n        sport = \"maleSoccerArray\"\n        call male.maleInitArray    ' inits the array thats hard coded.\n    else\n        gender = \"female\"\n        sport = \"femaleSoccerArray\"\n        call female.femaleInitArray\n Else If... \n ' the list goes on to assign variables depending on the combo boxes.\n\n' doesn't work, but it beats using this every time\nl = UBound(sport) ' Doesn't recognize \"sport\" as an Array  \nfor i = 1 to l\n     ' .AddItem(gender.sport(i)) will not work as well.\n     inputForm.studentComboBox.AddItem(gender.sport(i))\nnext i\n</code></pre>\n\n<p>Seems as though UBound(variable) and AddItem(Variable.Variable)\nwill not work...</p>\n\n<p>I found a few things so far, but none of them have worked.. such as the application.run method and assigning the actual \"male.maleSoccerArray\" method.</p>\n\n<p>Any help would be greatly appreciated.. thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1432673716, "post_id": 30468501, "comment_id": 49018031, "body": "The <a href=\"https://msdn.microsoft.com/en-us/library/office/aa224505(v=office.11).aspx\" rel=\"nofollow noreferrer\">Workbooks Collection</a> does not really explain this at all and in fact uses examples with and without the extension; the only difference being that the without example is already open. Is there any chance of naming ambiguity (a Master Schedule.xlsm and a Master Schedule.xla perhaps)?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 6, "creation_date": 1432673901, "post_id": 30468501, "comment_id": 49018149, "body": "<a href=\"http://www.cpearson.com/excel/fileextensions.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/fileextensions.aspx</a>"}, {"owner": {"reputation": 251, "user_id": 3317664, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1488870286065c8491c1defdd87cb9e7?s=128&d=identicon&r=PG&f=1", "display_name": "Austin Wismer", "link": "https://stackoverflow.com/users/3317664/austin-wismer"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1432674068, "post_id": 30468501, "comment_id": 49018246, "body": "@TimWilliams Interesting. I happened on this same link. What might cause this setting in Windows to change? I simply copied the entire directory over to a different location to do some development work, and it started throwing the error!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1432674219, "post_id": 30468501, "comment_id": 49018334, "body": "Can&#39;t say - I&#39;ve never seen it change by itself...."}, {"owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "edited": false, "score": 0, "creation_date": 1432689549, "post_id": 30468501, "comment_id": 49023478, "body": "An .XLSM file extension indicates an Excel Open XML Macro-Enabled Spreadsheet, so it might be for a security reason (in case your workbook contains VBA macros). Best regards,"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1441496919, "post_id": 30468501, "comment_id": 52703631, "body": "One potential conflict can be caused when you save (a temp file) as &quot;Master Schedule&quot;  with extension <b>xlsx</b> in the same folder, and also have it be open at the same time - Workbooks Collection now contains 2 files with the exact name and the only distinction becomes the file extension"}], "answers": [{"comments": [{"owner": {"reputation": 12628, "user_id": 145757, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/T6ghe.png?s=128&g=1", "display_name": "Pragmateek", "link": "https://stackoverflow.com/users/145757/pragmateek"}, "edited": false, "score": 0, "creation_date": 1583330333, "post_id": 47303450, "comment_id": 107079383, "body": "Unbelievable but this Windows setting impacts the Excel API behavior! Always use the extension, it will work whatever this setting."}], "tags": [], "owner": {"reputation": 21, "user_id": 8940959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d52b62b3bcfa9d7b463ebb58d7b9a139?s=128&d=identicon&r=PG&f=1", "display_name": "MarekK", "link": "https://stackoverflow.com/users/8940959/marekk"}, "is_accepted": false, "score": 1, "last_activity_date": 1510737465, "creation_date": 1510737465, "answer_id": 47303450, "question_id": 30468501, "link": "https://stackoverflow.com/questions/30468501/when-is-an-extension-required-in-workbook-name/47303450#47303450", "title": "When is an extension required in workbook name?", "body": "<p>Have you got \"Show file extension of known file types\" turned on in windows explorer?\nTry to run the code with hidden and visible extensions.</p>\n\n<p>It is good practice to assign the workbook to variable on open.</p>\n\n<pre><code>Dim wbInput as Workbook\nSet wbInput = Workbooks.open (\"C:\\Master Schedule.xslx\")\n</code></pre>\n\n<p>Now you can work on variable without caring about the system settings for extensions.</p>\n"}], "owner": {"reputation": 251, "user_id": 3317664, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1488870286065c8491c1defdd87cb9e7?s=128&d=identicon&r=PG&f=1", "display_name": "Austin Wismer", "link": "https://stackoverflow.com/users/3317664/austin-wismer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 1, "closed_date": 1581072756, "answer_count": 1, "score": 5, "last_activity_date": 1510737465, "creation_date": 1432672927, "last_edit_date": 1432679521, "question_id": 30468501, "link": "https://stackoverflow.com/questions/30468501/when-is-an-extension-required-in-workbook-name", "closed_reason": "Duplicate", "title": "When is an extension required in workbook name?", "body": "<p>I have a directory of excel files that interact with each other through VBA code in a master file.                                                      </p>\n\n<p>I've never had a problem with this before, but after copying the whole directory to do some development work on the copy (keeping the original intact in a different location) I'm running into a \"subscript out of range\" problem when referencing the workbook.</p>\n\n<p>For example, everything ran fine previously with this line of code (nothing in the actual code has been changed):</p>\n\n<p><strong>Code that now throws an error (never used to):</strong></p>\n\n<pre><code>ScheduleLocation = Workbooks(\"Master Schedule\").Path\n</code></pre>\n\n<p>However, this line now throws an error. If I replace \"Master Schedule\" with \"Master Schedule.xlsm\" everything works again. I've had this problem before, but I've never been able to put a finger on the root cause of the problem.</p>\n\n<p><strong>Code that doesn't throw an error:</strong></p>\n\n<pre><code>ScheduleLocation = Workbooks(\"Master Schedule.xlsm\").Path\n</code></pre>\n\n<p>Hence my question: why is this? Why would the name (without extension) be insufficient sometimes, and sometimes not?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "edited": false, "score": 1, "creation_date": 1432672396, "post_id": 30468222, "comment_id": 49017216, "body": "at each <code>for</code> loop the value of a cell will be compared against all the checkbox contents, is it intentional?"}, {"owner": {"reputation": 57, "user_id": 4934670, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a4d974063039a0538350aa4654baa7a7?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Builder", "link": "https://stackoverflow.com/users/4934670/robert-builder"}, "reply_to_user": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "edited": false, "score": 0, "creation_date": 1432675407, "post_id": 30468222, "comment_id": 49018900, "body": "Yes Mate Juhasz. That was intentional."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 4934670, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a4d974063039a0538350aa4654baa7a7?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Builder", "link": "https://stackoverflow.com/users/4934670/robert-builder"}, "edited": false, "score": 0, "creation_date": 1432675198, "post_id": 30468383, "comment_id": 49018801, "body": "Thanks Tim. Food for thought there. I changed the textbox names to txtbx1 txtbx2 and NUM_TEXTBOXES as Long = 5 (amount of textboxes) but the code didn&#39;t color any cells ?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 57, "user_id": 4934670, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a4d974063039a0538350aa4654baa7a7?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Builder", "link": "https://stackoverflow.com/users/4934670/robert-builder"}, "edited": false, "score": 0, "creation_date": 1432675553, "post_id": 30468383, "comment_id": 49018967, "body": "Sorry - fixed a typo in my answer: <code>AddNum</code> &gt;&gt; <code>AbbNum</code>"}, {"owner": {"reputation": 57, "user_id": 4934670, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a4d974063039a0538350aa4654baa7a7?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Builder", "link": "https://stackoverflow.com/users/4934670/robert-builder"}, "edited": false, "score": 0, "creation_date": 1432676008, "post_id": 30468383, "comment_id": 49019166, "body": "The typo fixed it. Massively impressed. Learning curve for me such a small code block instead of multiple IFs. Thank you very much indeed Tim"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 57, "user_id": 4934670, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a4d974063039a0538350aa4654baa7a7?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Builder", "link": "https://stackoverflow.com/users/4934670/robert-builder"}, "edited": false, "score": 1, "creation_date": 1432676427, "post_id": 30468383, "comment_id": 49019328, "body": "No problem - one benefit you get from writing lots of VBA is writing much <i>less</i> VBA..."}, {"owner": {"reputation": 57, "user_id": 4934670, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a4d974063039a0538350aa4654baa7a7?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Builder", "link": "https://stackoverflow.com/users/4934670/robert-builder"}, "edited": false, "score": 0, "creation_date": 1432677694, "post_id": 30468383, "comment_id": 49019861, "body": "I can also see that I can add as many textboxes as I like &amp; I only need to change the NUM_TEXTBOXES as Long = #value. That&#39;s great !"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 3, "last_activity_date": 1432678897, "last_edit_date": 1432678897, "creation_date": 1432672480, "answer_id": 30468383, "question_id": 30468222, "link": "https://stackoverflow.com/questions/30468222/multiple-if-statements-with-textbox-string-comparison/30468383#30468383", "title": "Multiple IF statements with textbox string comparison", "body": "<p>If you name your textboxes \"txtbx1\", \"txtbx2\", etc you can do something like this:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Const NUM_TEXTBOXES as Long = 10 'for example....\n\n    Dim i As Long\n    Dim AbbNum As String, f As Range, rngSrch As Range\n\n    Set rngSrch = Sheets(2).Range(\"A:A\")\n\n    For i = 1 To NUM_TEXTBOXES  \n\n         AbbNum = Me.Controls(\"txtbx\" &amp; i).Value\n\n         If Len(AbbNum) &gt; 0 Then\n             'EDIT: fixed typo in next line\n             Set f = rngSrch.Find(AbbNum, lookin:=xlvalues, lookat:=xlWhole)\n             If Not f Is nothing then f.Interior.ColorIndex = 6\n         End If\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 4934670, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a4d974063039a0538350aa4654baa7a7?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Builder", "link": "https://stackoverflow.com/users/4934670/robert-builder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 592, "favorite_count": 0, "accepted_answer_id": 30468383, "answer_count": 1, "score": 1, "last_activity_date": 1432678897, "creation_date": 1432671920, "last_edit_date": 1531164843, "question_id": 30468222, "link": "https://stackoverflow.com/questions/30468222/multiple-if-statements-with-textbox-string-comparison", "title": "Multiple IF statements with textbox string comparison", "body": "<p>My beginners code [which works perfectly well] uses multiple IF statements. My question is [before I go any further because I will have lots of textboxes [txtbx#] is there any downside of coding this way ?</p>\n\n<p>The user will be typing 40-50 short strings into textboxes while someone reads them to him then clicks a button to fill color all the matches in the worksheet column;                                          </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim i As Integer\n    Dim AbbNum As String\n    Dim AbbNum2 As String\n    Dim AbbNum3 As String\n    Dim AbbNum4 As String\n    Dim AbbNum5 As String\n    Dim c As Integer\n    Dim MySheet As Worksheet\n    Set MySheet = Sheets(2)\n    c = MySheet.Cells(Rows.Count, 2).End(xlUp).Row\n    For i = 2 To c\n         AbbNum = txtbxONE.Value\n            If Cells(i, 1).Value = AbbNum Then\n               Cells(i, 1).Interior.ColorIndex = 6\n            End If\n         AbbNum2 = txtbxTWO.Value\n            If Cells(i, 1).Value = AbbNum2 Then\n               Cells(i, 1).Interior.ColorIndex = 6\n            End If\n         AbbNum3 = txtbxTHREE.Value\n            If Cells(i, 1).Value = AbbNum3 Then\n               Cells(i, 1).Interior.ColorIndex = 6\n            End If\n         AbbNum4 = txtbxFOUR.Value\n            If Cells(i, 1).Value = AbbNum4 Then\n               Cells(i, 1).Interior.ColorIndex = 6\n            End If\n         AbbNum5 = txtbxFIVE.Value\n            If Cells(i, 1).Value = AbbNum5 Then\n               Cells(i, 1).Interior.ColorIndex = 6\n            End If\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2007"], "answers": [{"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432672424, "post_id": 30468098, "comment_id": 49017227, "body": "You may also want to sandwich that between <code>Application.DisplayAlerts = False&#47;True</code> ;)"}], "tags": [], "owner": {"reputation": 153, "user_id": 4847484, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ffbe465422ceecf17a59ba1d46a0e22b?s=128&d=identicon&r=PG&f=1", "display_name": "Federico Sanchez", "link": "https://stackoverflow.com/users/4847484/federico-sanchez"}, "is_accepted": true, "score": 1, "last_activity_date": 1432671479, "creation_date": 1432671479, "answer_id": 30468098, "question_id": 30468021, "link": "https://stackoverflow.com/questions/30468021/replacing-the-existing-sheet-in-excel-2007-using-vba/30468098#30468098", "title": "Replacing the existing sheet in excel 2007 using VBA", "body": "<p>you can try this at the top:</p>\n\n<pre><code>on error resume next\nActiveWorkbook.Sheets(\"your sheet\").delete\non error goto 0\n</code></pre>\n\n<p>if it exists, it will be deleted and your code will make the new one. Does it help?</p>\n"}], "owner": {"reputation": 53, "user_id": 4938061, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ab8286bb9462f96b38c79fd457bc71ac?s=128&d=identicon&r=PG&f=1", "display_name": "jraic", "link": "https://stackoverflow.com/users/4938061/jraic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 30468098, "answer_count": 1, "score": 0, "last_activity_date": 1432671571, "creation_date": 1432671206, "last_edit_date": 1432671279, "question_id": 30468021, "link": "https://stackoverflow.com/questions/30468021/replacing-the-existing-sheet-in-excel-2007-using-vba", "title": "Replacing the existing sheet in excel 2007 using VBA", "body": "<pre><code>Sub testmac()\n'\n' testmac Macro\n'\n'\n    ActiveWorkbook.Names.Add Name:=\"items\", RefersToR1C1:= _\n        \"=Report!R7C8:R486C11\"\n    ActiveWorkbook.Worksheets.Add\n    With ActiveSheet.ListObjects.Add(SourceType:=0, Source:=Array(Array( _\n        \"ODBC;DSN=Excel Files;DBQ=path\n        ), Array(\"P;DriverId=1046;MaxBufferSize=2048;PageTimeout=5;\")), Destination:= _\n        Range(\"$A$1\")).QueryTable\n        .CommandText = Array( _\n        \"TRANSFORM first(`Dimension Value Code`)\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"SELECT items.`No#`, items.`Description`\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"FROM items\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"GROUP BY items.`No#`, items.`Description`\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"PIVOT `Dimension Code`\" _\n        )\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .BackgroundQuery = True\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .PreserveColumnInfo = True\n        .ListObject.DisplayName = \"Table_Query_from_Excel_FilesXY\"\n        .Refresh BackgroundQuery:=False\n\n        End With\n\nEnd Sub\n</code></pre>\n\n<p>I am trying to make a pivot table with this code. The first try went well as it had no sheets. When I tried for the second time it gave me an error as the sheet already existed with table in it having the same name as the previous one. </p>\n\n<p>The error is </p>\n\n<blockquote>\n  <p>Run-time error  '1004': Application-defined or object defined error</p>\n</blockquote>\n\n<p>When I delete the worksheet created in the previous step and try running the macro again works properly, but it does not works without deleting it.</p>\n"}, {"tags": ["string", "vba", "excel"], "comments": [{"owner": {"reputation": 12472, "user_id": 4850, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GOfnj.jpg?s=128&g=1", "display_name": "Andr&#233; Chalella", "link": "https://stackoverflow.com/users/4850/andr%c3%a9-chalella"}, "edited": false, "score": 0, "creation_date": 1432671067, "post_id": 30467930, "comment_id": 49016418, "body": "What line and function call EXACTLY throw the exception? First or second? See what code is highlighted when the error occurs."}, {"owner": {"reputation": 283, "user_id": 4733852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GD1mn.jpg?s=128&g=1", "display_name": "USFBS", "link": "https://stackoverflow.com/users/4733852/usfbs"}, "edited": false, "score": 0, "creation_date": 1432671166, "post_id": 30467930, "comment_id": 49016492, "body": "try using a variable (let&#39;s say <code>temp</code>) to store the value of <code>Mid(targetstring3, 57, 2)</code> before assigning it to <code>B8</code>. I feel as though I had run into similar issues doing some of my earlier macros and that that helped. Not to say it should be a permanent fix, but if it gets your code running whilst waiting for a better answer, that&#39;s helpful at least."}, {"owner": {"reputation": 29, "user_id": 3792323, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/225b315f333f07114ab2df8d16b6ed00?s=128&d=identicon&r=PG&f=1", "display_name": "hippie_poe", "link": "https://stackoverflow.com/users/3792323/hippie-poe"}, "edited": false, "score": 0, "creation_date": 1432671175, "post_id": 30467930, "comment_id": 49016501, "body": "The error itself didn&#39;t highlight any line (normally the error would be a &quot;400&quot; error but I added an error handling code which enabled it to show me &quot;application...object-defined error...&quot;). But I deleted the Range(&quot;B8&quot;).Value = Mid(targetstring3, 57, 2) line and it worked perfectly, with the same mid expression on other strings intact, which is why I thought that line was the error"}, {"owner": {"reputation": 12472, "user_id": 4850, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GOfnj.jpg?s=128&g=1", "display_name": "Andr&#233; Chalella", "link": "https://stackoverflow.com/users/4850/andr%c3%a9-chalella"}, "reply_to_user": {"reputation": 283, "user_id": 4733852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GD1mn.jpg?s=128&g=1", "display_name": "USFBS", "link": "https://stackoverflow.com/users/4733852/usfbs"}, "edited": false, "score": 0, "creation_date": 1432671216, "post_id": 30467930, "comment_id": 49016524, "body": "Try what @USFBS said (<code>foo = Mid(...)</code>) and see if it throws"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1432671271, "post_id": 30467930, "comment_id": 49016563, "body": "Try typing two equals signs into a cell without prefacing them with a single quote."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 3792323, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/225b315f333f07114ab2df8d16b6ed00?s=128&d=identicon&r=PG&f=1", "display_name": "hippie_poe", "link": "https://stackoverflow.com/users/3792323/hippie-poe"}, "edited": false, "score": 0, "creation_date": 1432671499, "post_id": 30468049, "comment_id": 49016699, "body": "I changed it to     john = &quot;&#39;&quot; &amp; Mid(targetstring3, 57, 2) and it gave the same error - what&#39;s happening?"}, {"owner": {"reputation": 12472, "user_id": 4850, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GOfnj.jpg?s=128&g=1", "display_name": "Andr&#233; Chalella", "link": "https://stackoverflow.com/users/4850/andr%c3%a9-chalella"}, "edited": false, "score": 0, "creation_date": 1432671569, "post_id": 30468049, "comment_id": 49016750, "body": "Can you please try your code with some value different than all equal signs?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432671657, "post_id": 30468049, "comment_id": 49016794, "body": "The above code is tried and tested :) What values do you want me to try with?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432671718, "post_id": 30468049, "comment_id": 49016845, "body": "See the edit in my code. You may have to refresh the page to see it"}, {"owner": {"reputation": 29, "user_id": 3792323, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/225b315f333f07114ab2df8d16b6ed00?s=128&d=identicon&r=PG&f=1", "display_name": "hippie_poe", "link": "https://stackoverflow.com/users/3792323/hippie-poe"}, "edited": false, "score": 0, "creation_date": 1432672002, "post_id": 30468049, "comment_id": 49016996, "body": "Thanks! Just found a way around it, I replaced = with &quot;+&quot; and could achieve same thing for all intent and purposes (just need to change it back later in the very end). Sorry for all the fuss!"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432672061, "post_id": 30468049, "comment_id": 49017037, "body": "Like I said, it works with your existing text. No need to change &quot;=&quot; to &quot;+&quot;"}, {"owner": {"reputation": 12472, "user_id": 4850, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GOfnj.jpg?s=128&g=1", "display_name": "Andr&#233; Chalella", "link": "https://stackoverflow.com/users/4850/andr%c3%a9-chalella"}, "edited": false, "score": 0, "creation_date": 1432738785, "post_id": 30468049, "comment_id": 49050791, "body": "@SiddharthRout my previous comment was directed to OP. Looks like he wasn&#39;t too interested, however."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 12472, "user_id": 4850, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GOfnj.jpg?s=128&g=1", "display_name": "Andr&#233; Chalella", "link": "https://stackoverflow.com/users/4850/andr%c3%a9-chalella"}, "edited": false, "score": 1, "creation_date": 1432739074, "post_id": 30468049, "comment_id": 49051021, "body": "@Andr&#233;Neves: Ah :) No worries. that comment didn&#39;t have the @ sign so I thought it was for me..."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 0, "last_activity_date": 1496227139, "last_edit_date": 1496227139, "creation_date": 1432671298, "answer_id": 30468049, "question_id": 30467930, "link": "https://stackoverflow.com/questions/30467930/excel-vba-string-operation-not-working/30468049#30468049", "title": "Excel VBA: string operation not working", "body": "<p>It is obvious that you will get an error. Remember that Excel formulas start with an <code>=</code> sign. And hence you get an error.</p>\n\n<p>Change your code to </p>\n\n<pre><code>Range(\"B8\").Value = \"'\" &amp; Mid(targetstring3, 57, 2)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Range(\"B8\").Value = Chr(34) &amp; Mid(targetstring3, 57, 2) &amp; Chr(34)\n</code></pre>\n\n<p><strong>Edit</strong></p>\n\n<p>Followup from comments</p>\n\n<p>I tried this</p>\n\n<pre><code>Sub Sample()\n    targetstring3 = Range(\"A1\").Value\n    Range(\"B8\").Value = Chr(34) &amp; Mid(targetstring3, 57, 2) &amp; Chr(34)\n    Range(\"B9\").Value = \"'\" &amp; Mid(targetstring3, 57, 2)\nEnd Sub\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/dZcip.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dZcip.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 29, "user_id": 3792323, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/225b315f333f07114ab2df8d16b6ed00?s=128&d=identicon&r=PG&f=1", "display_name": "hippie_poe", "link": "https://stackoverflow.com/users/3792323/hippie-poe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 314, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496227139, "creation_date": 1432670843, "last_edit_date": 1432738702, "question_id": 30467930, "link": "https://stackoverflow.com/questions/30467930/excel-vba-string-operation-not-working", "title": "Excel VBA: string operation not working", "body": "<p>I am trying to work with a string (copied into a cell from <code>.txt</code>) like below:</p>\n\n<pre><code>\"                                    ========   =============   ========   =====================   ==================   =================================================================   ==================================================   =============   ==================\" \n</code></pre>\n\n<p>basically, it's a combo of equal signs and spaces, but I need to do a few things with it later. This is what I did:</p>\n\n<pre><code>targetstring3 = Range(\"A7\").Value\nRange(\"B8\").Value = Mid(targetstring3, 57, 2)\n</code></pre>\n\n<p>And it returned </p>\n\n<blockquote>\n  <p>\"application/object-defined error\"</p>\n</blockquote>\n\n<p>I tried this below and it's still not working:</p>\n\n<pre><code>targetstring3 = Cstr(Range(\"A7\").Value)\nRange(\"B8\").Value = Mid(targetstring3, 57, 2)\n</code></pre>\n\n<p>Any help is appreciated! </p>\n"}, {"tags": ["vba", "dynamic", "powerpoint", "buttonclick"], "comments": [{"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1432674038, "post_id": 30467859, "comment_id": 49018227, "body": "I think you need to change ` ClassName:=&quot;Forms.Label.1&quot;` to ` ClassName:=&quot;Forms.CheckBox.1&quot;` when you are creating the shape. If you were using an ordinary shape you could attach the name of a macro to the <code>OnAction</code> property. You would add the macro to the deck at design time and set the <code>OnAction</code> string to something like <code>.OnAction=&quot;NameOfDeck!NameOfMacro&quot;</code>."}, {"owner": {"reputation": 3, "user_id": 4913545, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c5HOw.jpg?s=128&g=1", "display_name": "agoltz", "link": "https://stackoverflow.com/users/4913545/agoltz"}, "reply_to_user": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1432696697, "post_id": 30467859, "comment_id": 49025233, "body": "Thanks. I am using Label.1 instead of CheckBox.1 because I need the checkbox to be larger than a standard CheckBox object which is not resizable. I can get the box to toggle by entering the <code>Label1_Click( )</code> code manually to the Label on each page after they are built by the VBA but cannot figure out how to have VBA add the code programmatically on the fly. Might the <code>OnAction</code> method you describe be worth pursuing for this approach?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4913545, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c5HOw.jpg?s=128&g=1", "display_name": "agoltz", "link": "https://stackoverflow.com/users/4913545/agoltz"}, "edited": false, "score": 0, "creation_date": 1432822076, "post_id": 30487834, "comment_id": 49093320, "body": "Thanks John. Ran the code in a clean presentation as it did not seem to depend on any of my code. Got a &quot;Compile error: Variable not defined on <code>.Add(vbext_ct_StdModule)</code>. Commented out the final &quot;With...&quot; section of code and the code runs, draws the box but no onClick action (probably commented out the magic.)"}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1432846768, "post_id": 30487834, "comment_id": 49109012, "body": "A simple google search shows that you need to add a reference to Microsoft Visual Basic for Applications Extensibility 5.3. Taken from <a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/vbe.aspx</a>: The VBIDE is the object library that defines all the objects and values that make up VBProject and the Visual Basic Editor. To add this reference, open the VBA editor, open your VBProject in the editor, and go to the Tools menu. There, choose References . In the References dialog, scroll down to Microsoft Visual Basic for Applications Extensibility 5.3 and check that item."}, {"owner": {"reputation": 3, "user_id": 4913545, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c5HOw.jpg?s=128&g=1", "display_name": "agoltz", "link": "https://stackoverflow.com/users/4913545/agoltz"}, "edited": false, "score": 0, "creation_date": 1432911606, "post_id": 30487834, "comment_id": 49139294, "body": "chipsLetten - Discovered the reference last night while researching .CreateEventProc. John&#39;s code now works."}, {"owner": {"reputation": 3, "user_id": 4913545, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c5HOw.jpg?s=128&g=1", "display_name": "agoltz", "link": "https://stackoverflow.com/users/4913545/agoltz"}, "edited": false, "score": 0, "creation_date": 1432913529, "post_id": 30487834, "comment_id": 49140676, "body": "@John Wilson Thanks! I would vote your answer up but don&#39;t have enough points. Vote yourself up for me! If you get a second could you look at the additional information I&#39;ve added to the OP. If you have any experience with .CreateEventProc it would be much appreciated."}], "tags": [], "owner": {"reputation": 26, "user_id": 4945633, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/5665e08c4eed9a29a4db2a1f3e1d36df?s=128&d=identicon&r=PG", "display_name": "John Wilson", "link": "https://stackoverflow.com/users/4945633/john-wilson"}, "is_accepted": true, "score": 0, "last_activity_date": 1432743102, "creation_date": 1432743102, "answer_id": 30487834, "question_id": 30467859, "link": "https://stackoverflow.com/questions/30467859/adding-event-code-to-checkbox-in-powerpoint-vba/30487834#30487834", "title": "Adding event code to checkbox in PowerPoint VBA", "body": "<p>Do you have to use a label? (I understand the size thing but you can maybe add a shape which would be easier.)</p>\n\n<p>Something based on:\nThis can only work if you allow access to the VBE in Security (cannot be done in code)</p>\n\n<pre><code>    Sub makeBox()\nDim strCode As String\nWith ActivePresentation.Slides(1).Shapes.AddShape(msoShapeRectangle, 10, 10, 20, 20)\n.Fill.Visible = False\n.Line.Visible = False\nWith .TextFrame.TextRange.Font\n.Name = \"Wingdings 2\"\n.Size = 40\n.Color.RGB = vbBlack\nEnd With\n.TextFrame.TextRange = \"\u00a3\"\nWith .ActionSettings(ppMouseClick)\n.Action = ppActionRunMacro\n.Run = \"chex\"\nEnd With\nEnd With\nstrCode = \"Sub chex(oshp As Shape)\" &amp; vbCrLf &amp; \"If oshp.TextFrame.TextRange =\" &amp; Chr(34) &amp; \"\u00a3\" &amp; Chr(34) &amp; \"Then\" _\n&amp; vbCrLf &amp; \"oshp.TextFrame.TextRange = \" &amp; Chr(34) &amp; \"R\" &amp; Chr(34) &amp; vbCrLf _\n&amp; \"Else\" &amp; vbCrLf &amp; \"oshp.TextFrame.TextRange =\" &amp; Chr(34) &amp; \"\u00a3\" &amp; Chr(34) &amp; vbCrLf &amp; \"End If\" &amp; vbCrLf &amp; \"End Sub\"\nWith ActivePresentation.VBProject.VBComponents.Add(vbext_ct_StdModule)\n.CodeModule.AddFromString (strCode)\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4913545, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c5HOw.jpg?s=128&g=1", "display_name": "agoltz", "link": "https://stackoverflow.com/users/4913545/agoltz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2610, "favorite_count": 0, "accepted_answer_id": 30487834, "answer_count": 1, "score": 0, "last_activity_date": 1432913180, "creation_date": 1432670627, "last_edit_date": 1525816150, "question_id": 30467859, "link": "https://stackoverflow.com/questions/30467859/adding-event-code-to-checkbox-in-powerpoint-vba", "title": "Adding event code to checkbox in PowerPoint VBA", "body": "<p>I am developing a PowerPoint 2010 deck that presents the user with a series of pages containing one statement, one checkbox (built from a label element to enable changing the size of the checkbox) and forward/back arrows on each page.</p>\n\n<p>Since this will be used on numerous projects with varying numbers of pages I am building the \u201cdeck\u201d dynamically using PowerPoint VBA to construct the pages dynamically from an Excel spreadsheet containing the list of individual statements. </p>\n\n<p>I have been able to write the VBA code to open the Excel file, read the statements into an array in PowerPoint and construct the appropriate number of pages with all of the elements on the page. To this point everything works fine. Where I am having difficulty is in assigning the click action to the checkbox. </p>\n\n<p>Here is the code that is called by the page building routine to insert the checkbox (obviously there is more code prior to this for accessing the Excel file, creating the pages and adding the \u201cstatement\u201d text boxes...all of which works):</p>\n\n<pre><code>Sub AddSelectBox(Index As Integer, pptBuildingSlide As Slide)\n\n'Add Checkbox\n    With pptBuildingSlide.Shapes.AddOLEObject(Left:=342, Top:=294, Width:=42, Height:=42, ClassName:=\"Forms.Label.1\")\n        .Name = \"label\" &amp; Index\n        .OLEFormat.Object.Font.Name = \"Wingdings 2\"\n        .OLEFormat.Object.Font.Charset = \"2\"\n        .OLEFormat.Object.Caption = \"\u00a3\"\n        .OLEFormat.Object.Font.Size = 40\n    End With\n\n'Add Checkbox Click Code\n'(CODE FOR ADDING CLICK EVENT TO EACH BOX GOES HERE)\n\nEnd Sub\n</code></pre>\n\n<p>The checkbox on each page has a discreet name keyed to the page number (e.g. Label1, Label2, etc.). I need to add the following code to each checkbox on each page to toggle the checkmark so later in the program I can see which were checked by reading the \u201ccaption\u201d attributes. (The font is set to \u201cWingdings 2\u201d to give a blank box and a checked box on click)</p>\n\n<pre><code>Private Sub Label1_Click()\n\n   If Label1.Caption = \"\u00a3\" Then\n       Label1.Caption = \"R\"\n   Else\n       Label1.Caption = \"\u00a3\"\n   End If\n\nEnd Sub\n</code></pre>\n\n<p>I have searched the web looking for any references to add event code dynamically and found a number of examples (e.g. <a href=\"https://stackoverflow.com/questions/566770/assign-on-click-vba-function-to-a-dynamically-created-button-on-excel-userform\">Assign on-click VBA function to a dynamically created button on Excel Userform</a>) but almost all are for Excel or Access. I should point out that coding is \u201cnot my day job\u201d and I have managed to get this far reading \u201cMastering VBA for Office 2003\u201d and web searching\u2026so my ability to translate those examples to PowerPoint has come up short. Thanks for any help you can offer.</p>\n\n<p>5/29 Additional information:<br>\nI came across the <code>.CreateEventProc</code> method as a way to write code into VBA. The example I found was written for Excel at <a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">this site</a>. I've gotten this far with it (the message box code would be replaced with the click code but I was just using this for testing to avoid introducing other errors)...</p>\n\n<pre><code>Sub CreateEventProcedure()\n    Dim VBProj As VBIDE.VBProject\n    Dim VBComp As VBIDE.VBComponent\n    Dim CodeMod As VBIDE.CodeModule\n    Dim LineNum As Long\n    Const DQUOTE = \"\"\"\" ' one \" character\n\n    Set VBProj = ActivePresentation.VBProject\n    Set VBComp = VBProj.VBComponents(Slides(1))\n    Set CodeMod = VBComp.CodeModule\n\n    With CodeMod\n        LineNum = .CreateEventProc(\"Click\", \"Label1\")\n        LineNum = LineNum + 1\n        .InsertLines LineNum, \"    MsgBox \" &amp; DQUOTE &amp; \"Hello World\" &amp; DQUOTE\n    End With\nEnd Sub\n</code></pre>\n\n<p>...but get a \"Compile Error: Sub or Function not defined\" at <code>(slides(1))</code>. Any help cleaning it up (if it is in fact an appropriate solution) would be appreciated.</p>\n"}, {"tags": ["excel", "vbscript", "vba"], "comments": [{"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 2, "creation_date": 1432670901, "post_id": 30467841, "comment_id": 49016325, "body": "SO is not a place where you provide requirements and other people write code for you. Show us what you have tried so far (your code) and explain what does not work as expected and we&#39;ll help you improve/fix your code."}, {"owner": {"reputation": 1, "user_id": 4941952, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GLFEhGyhFfU/AAAAAAAAAAI/AAAAAAAAEpg/B7oqtje42Sc/photo.jpg?sz=128", "display_name": "J-Estrella", "link": "https://stackoverflow.com/users/4941952/j-estrella"}, "reply_to_user": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1432730429, "post_id": 30467841, "comment_id": 49044009, "body": "sorry @AnsgarWiechers, I can&#39;t seem to paste it where it keeps the original formatting so it looks like one big paragraph."}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1432735761, "post_id": 30467841, "comment_id": 49048299, "body": "Please <a href=\"http://stackoverflow.com/posts/30467841/edit\">edit</a> your question instead of posting relevant information (and particularly code) in comments."}, {"owner": {"reputation": 1, "user_id": 4941952, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GLFEhGyhFfU/AAAAAAAAAAI/AAAAAAAAEpg/B7oqtje42Sc/photo.jpg?sz=128", "display_name": "J-Estrella", "link": "https://stackoverflow.com/users/4941952/j-estrella"}, "reply_to_user": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1432753386, "post_id": 30467841, "comment_id": 49059945, "body": "done, i&#39;m still learning the site..  newb ~&gt;"}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1432884277, "post_id": 30467841, "comment_id": 49120788, "body": "The code in <code>Test2</code> looks OK, but it&#39;s VBA code, not VBScript. Take a look at my <a href=\"http://sdb.planetcobalt.net/vba2vbs.shtml\" rel=\"nofollow noreferrer\">blog post about translating VBA to VBScript</a>."}], "answers": [{"tags": [], "owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "is_accepted": false, "score": 1, "last_activity_date": 1432758059, "creation_date": 1432758059, "answer_id": 30492391, "question_id": 30467841, "link": "https://stackoverflow.com/questions/30467841/check-if-cell-has-content-and-if-so-input-something-in-a-different-cell/30492391#30492391", "title": "Check if cell has content and if so, input something in a different cell", "body": "<pre><code>if(B2&lt;&gt;\"\") then(J2=\"1\") \n</code></pre>\n\n<p>In the above line <code>B2</code> and <code>J2</code> are (undefined) variables, when you actually want to refer to the cells B2 and J2. Use something like this for the latter:</p>\n\n<pre><code>If objSheet.Range(\"B2\").Value &lt;&gt; \"\" Then objSheet.Range(\"J2\").Value = 1\n</code></pre>\n\n<p>Note, however, that <code>Range(\"B2\")</code> might be relative to the active cell. I find it usually safer to use the <code>Cells</code> collection:</p>\n\n<pre><code>If objSheet.Cells(2, 2).Value &lt;&gt; \"\" Then objSheet.Cells(2, 10).Value = 1\n</code></pre>\n\n<p>Also, this:</p>\n\n<pre><code>set Range = objSheet.Range(\"J1:J2\"&amp;objSheet.UsedRange.Rows.Count)\n</code></pre>\n\n<p>should probably look like this:</p>\n\n<pre><code>set Range = objSheet.Range(\"J1:J\" &amp; objSheet.UsedRange.Rows.Count)\n</code></pre>\n\n<p>With that said, I <strong>strongly</strong> recommend you immerse yourself in a good book about VBA. Once you have a good understanding of how VBA works, <a href=\"http://sdb.planetcobalt.net/vba2vbs.shtml\" rel=\"nofollow\">using it from VBScript</a> won't be too hard.</p>\n"}], "owner": {"reputation": 1, "user_id": 4941952, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GLFEhGyhFfU/AAAAAAAAAAI/AAAAAAAAEpg/B7oqtje42Sc/photo.jpg?sz=128", "display_name": "J-Estrella", "link": "https://stackoverflow.com/users/4941952/j-estrella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1575, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1432884116, "creation_date": 1432670543, "last_edit_date": 1531164843, "question_id": 30467841, "link": "https://stackoverflow.com/questions/30467841/check-if-cell-has-content-and-if-so-input-something-in-a-different-cell", "title": "Check if cell has content and if so, input something in a different cell", "body": "<p>I found a VBScript that opens an certain spreadsheet in Excel 2013, adds a column and puts a name in the first row of the column.  I'm looking to see if someone can help me with a script that can do the following:</p>\n\n<p>The script should check all cells in column B starting at B2.</p>\n\n<ul>\n<li>If B2 has something in it, then put a \"1\" (no quotes) in G2</li>\n<li>Same thing, then if B3 has something in it, put a \"1\" in G3</li>\n<li>And so on until it reaches and empty cell.</li>\n</ul>\n\n<p>Once it hits the empty cell, the script is done.</p>\n\n<p>I have the following script below. I have no idea where to start and I tried a few different things but get errors. This is the last revision where I was just trying to say \"if (b2 is less than or greater than blank then J2 is = to 1) but it's probably not the correct format.</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Const xlToRight = -4161 \nconst xlColumns = &H2 \nconst xlLinear = -4132 \nconst xlDay = 1 \nSet objExcel = CreateObject(\"Excel.Application\") \nobjExcel.Visible = True \nSet objWB = objExcel.Workbooks.Open(\"T:\\Science Data\\SampleFile.xls\") \nSet objSheet = objwb.Sheets(\"sheet\") \nobjSheet.Columns(\"J:J\").Insert xlToRight \nobjSheet.Cells(1, 10).Value = \"GetBestMatch\" \n<b>objSheet.Cells(2, 10).Value = 1</b>\nIf objSheet.Cells(2,2).Value &lt;&gt; \"\" Then objSheet.Cells(2, 10).Value = 1 \nset Range = objSheet.Range(\"J1:J\" & objSheet.UsedRange.Rows.Count) \nRange.DataSeries xlColumns, xlLinear,xlDay, 1, , False \nobjwb.Save \nobjwb.close\nobjExcel.quit</code></pre>\n\n<p>Thanks a lot for the suggestions.  I made the changes to the script.  Removed the <code>objSheet.Cells(2,10).Value = 1</code> line (highlighted in bold) as it was more of a duplicate.  I'm not sure if i can incorporate the following code below.  The line you gave me works great and i can type the same line repeatedly with different cell values for each row.  </p>\n\n<p>Wanted to see if within the <code>If</code> statement you recommended, it could add a statement to keep checking down the B row.  For example, check B3 for data and make J3 a 1 if B3 has data, then B4 and so on, and then stop adding ones to the respective J row once it hits an empty B cell.  I couldn't get anything to work with your If statement so I searched and tried a <code>Do</code> statement that I found but made some changes to it (below).</p>\n\n<p>Hopefully the code below is somewhat correct. I tried it but it doesn't fill in anything.  was trying to make check B2 for data and move over 8 cells to J2 if B2 was empty, add a 1, then go down one row and back 8 to B3, then start the <code>Do</code> statement again from there. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Test2()\n  Range(\"B2\").Select\n  Do Until IsEmpty(ActiveCell)\n    ActiveCell.Offset(0,8).select\n    ActiveCell.value = 1\n    ActiveCell.Offset(1,-8).select\n  Loop\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1432672863, "post_id": 30467723, "comment_id": 49017492, "body": "Try <code>.Item.To = vbNull</code> instead of <code>&quot;&quot;</code>? It should, effectively, be the same, but <code>vbNull</code> may get a slightly different result."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 13, "user_id": 4941805, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-c_uS3Ot3EsI/AAAAAAAAAAI/AAAAAAAAO6Y/Sh0OzP155tU/photo.jpg?sz=128", "display_name": "Uday Neethipudi", "link": "https://stackoverflow.com/users/4941805/uday-neethipudi"}, "edited": false, "score": 0, "creation_date": 1432673293, "post_id": 30467723, "comment_id": 49017771, "body": "@UdayNeethipudi, Change <code>&quot;&quot;</code> to <code>&quot; &quot;</code>. Now try it"}, {"owner": {"reputation": 13, "user_id": 4941805, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-c_uS3Ot3EsI/AAAAAAAAAAI/AAAAAAAAO6Y/Sh0OzP155tU/photo.jpg?sz=128", "display_name": "Uday Neethipudi", "link": "https://stackoverflow.com/users/4941805/uday-neethipudi"}, "edited": false, "score": 0, "creation_date": 1432673337, "post_id": 30467723, "comment_id": 49017800, "body": "With your last suggesting, I have figured out that it is not replacing the old value directly with &quot;&quot; (I mean null) but if I insert, 1 or any other value and then again try to ake it null, it is working. Most disgusting behavior I have noticed till date but somehow a temporary logic and it is working."}, {"owner": {"reputation": 13, "user_id": 4941805, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-c_uS3Ot3EsI/AAAAAAAAAAI/AAAAAAAAO6Y/Sh0OzP155tU/photo.jpg?sz=128", "display_name": "Uday Neethipudi", "link": "https://stackoverflow.com/users/4941805/uday-neethipudi"}, "edited": false, "score": 0, "creation_date": 1432673407, "post_id": 30467723, "comment_id": 49017835, "body": "Now my code that resets values looks like this: <code>ctiveWorkbook.EnvelopeVisible = True             With ActiveSheet.MailEnvelope                 .Item.To = &quot;1&quot;                 .Item.To = &quot;&quot;                 .Item.CC = &quot;1&quot;                 .Item.CC = &quot;&quot;                 .Item.BCC = &quot;1&quot;                 .Item.BCC = &quot;&quot;             End With</code>"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 0, "last_activity_date": 1432673502, "last_edit_date": 1432673502, "creation_date": 1432670147, "answer_id": 30467723, "question_id": 30467601, "link": "https://stackoverflow.com/questions/30467601/how-to-get-blank-email-envelope-template/30467723#30467723", "title": "How to get Blank Email Envelope Template", "body": "<p>Simply Reset it</p>\n\n<pre><code>Sub SendEmailToMe()\n    Sendto = \"aaa@aa.com\"\n    SendMEcc = \"bbb@aa.com\"\n    SendMEbcc = \"ccc@aa.com\"\n    Subj = \"Updates\"\n\n    ActiveWorkbook.EnvelopeVisible = True\n    With ActiveSheet.MailEnvelope\n       .Item.To = Sendto\n       .Item.CC = SendMEcc\n       .Item.BCC = SendMEbcc\n       .Item.Subject = Subj &amp; \" - \" &amp; Format(Now(), \"dd-mmm-yyyy\")\n\n       MsgBox \"This is how it looks before you sent it\"\n\n       .Item.Send\n    End With\n\n    MsgBox \"Press Ok to reset it\"\n\n    ActiveWorkbook.EnvelopeVisible = True\n    With ActiveSheet.MailEnvelope\n       .Item.To = \" \"\n       .Item.CC = \" \"\n       .Item.BCC = \" \"\n       .Item.Subject = \" \"\n    End With\nEnd Sub\n</code></pre>\n\n<p><strong>Screenshot</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/uqAvZ.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 13, "user_id": 4941805, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-c_uS3Ot3EsI/AAAAAAAAAAI/AAAAAAAAO6Y/Sh0OzP155tU/photo.jpg?sz=128", "display_name": "Uday Neethipudi", "link": "https://stackoverflow.com/users/4941805/uday-neethipudi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "accepted_answer_id": 30467723, "answer_count": 1, "score": 1, "last_activity_date": 1432674963, "creation_date": 1432669721, "last_edit_date": 1531161705, "question_id": 30467601, "link": "https://stackoverflow.com/questions/30467601/how-to-get-blank-email-envelope-template", "title": "How to get Blank Email Envelope Template", "body": "<p>When I use Email Envelope method in VBA and enter TO, CC and BCC fields for the first time, during the next iteration, the first iteration/old values auto populate as soon as <code>ActiveWorkbook.EnvelopeVisible = True</code> is executed.</p>\n\n<p>How can we make the workbook to show envelope with blank To, CC and BCC field values? I want a Blank Envelope every time, is this possible?</p>\n\n<p>My piece of code:</p>\n\n<pre><code>Subj = \"Updates\"\nActiveWorkbook.EnvelopeVisible = True\n    With ActiveSheet.MailEnvelope\n       .Item.To = Sendto\n       .Item.CC = Sendcc\n       .Item.BCC = Sendbcc\n       .Item.Subject = Subj &amp; \" - \" &amp; Format(Now(), \"dd-mmm-yyyy\")\n       .Item.Send\n    End With\nActiveWorkbook.EnvelopeVisible = False\n</code></pre>\n"}, {"tags": ["csv", "ms-access", "automation", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1432670490, "post_id": 30467524, "comment_id": 49016081, "body": "Well, natively Access comes with an &quot;Important from an XML File&quot; button. Does that not work for the XML portion?"}, {"owner": {"reputation": 13, "user_id": 4774944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eff58acb8b5d50beb66e715c1611bd2c?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Gillette", "link": "https://stackoverflow.com/users/4774944/jack-gillette"}, "reply_to_user": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1432671846, "post_id": 30467524, "comment_id": 49016910, "body": "It does work pretty well but the user will still have to download and import the file each week. I realize these aren&#39;t difficult tasks, but given that my boss will be doing them every single week once my database is finished,  I&#39;m just trying to see if anyone has any ideas that could cut out any steps."}, {"owner": {"reputation": 128, "user_id": 4897784, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jN45WYKtevs/AAAAAAAAAAI/AAAAAAAAARs/k87jp5AH7DE/photo.jpg?sz=128", "display_name": "Manuel Castro", "link": "https://stackoverflow.com/users/4897784/manuel-castro"}, "edited": false, "score": 0, "creation_date": 1432679371, "post_id": 30467524, "comment_id": 49020474, "body": "Have you read this already: <a href=\"http://stackoverflow.com/questions/7091162/access-vba-how-to-download-xml-file-%20and-enter-its-data-into-a-recordset\" title=\"access vba how to download xml file %2520and enter its data into a recordset\">stackoverflow.com/questions/7091162/&hellip;</a>"}, {"owner": {"reputation": 13, "user_id": 4774944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eff58acb8b5d50beb66e715c1611bd2c?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Gillette", "link": "https://stackoverflow.com/users/4774944/jack-gillette"}, "edited": false, "score": 0, "creation_date": 1432743677, "post_id": 30467524, "comment_id": 49054318, "body": "I read it to see if it could be useful but it seems a little more involved than what is necessary for this problem. I am just trying to replace a file in my database with one that I download online with as little steps for the user as possible. Correct me if I&#39;m wrong, but from my understanding I shouldn&#39;t need to implement the solutions in the answers of that question."}], "owner": {"reputation": 13, "user_id": 4774944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eff58acb8b5d50beb66e715c1611bd2c?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Gillette", "link": "https://stackoverflow.com/users/4774944/jack-gillette"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 531, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1432738619, "creation_date": 1432669427, "last_edit_date": 1432738619, "question_id": 30467524, "link": "https://stackoverflow.com/questions/30467524/what-is-the-best-way-to-routinely-import-a-csv-or-xml-file-into-a-ms-access-data", "title": "What is the best way to routinely import a CSV or XML file into a MS access database?", "body": "<p>I have an Access database that keeps track of many different aspects of my companies performance and I would like to add functionality to keep track of the hours the employees are working.</p>\n\n<p>The hours are all kept track of on a website called timetracker. They have a few reporting options including XML and CSV files. The site has a favorite report feature to get the same data in the format that I want it every week. </p>\n\n<p>What I would like to do is find the best process for getting the data from this website, into a table in my database that I can reference.</p>\n\n<p><em>I will not be the one executing whatever process I come up with and I would really like it to be as easy as possible for whoever it is that does have to do it.</em></p>\n\n<p>Right now I have a linked table that is an XML file in our SharePoint folder. I was thinking that maybe we could just run the report and download the file every week then just save it over the old file with the correct sheet names and it should update. </p>\n\n<p>What I am wondering is if anyone can come up with an easier process for doing this that would take the least amount of time and be easiest to write down instructions for that anyone could execute. \n(Would it maybe be possible to create some sort of macro to actually download the report automatically?)</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": true, "score": 5, "last_activity_date": 1432669444, "last_edit_date": 1432669444, "creation_date": 1432669134, "answer_id": 30467426, "question_id": 30467380, "link": "https://stackoverflow.com/questions/30467380/function-with-optional-parameter/30467426#30467426", "title": "Function with Optional parameter", "body": "<p>Assuming, you want to set <code>Separator</code> as optional parameter, try this:</p>\n\n<pre><code>Private Function SeperateString(MainString As String, _\n           Optional Seperator As String = \"-\") As String\n\n 'Body \n     SeperateString = \"result of function\"\nEnd Function\n</code></pre>\n\n<p><strong>Usage:</strong></p>\n\n<pre><code>result = SeperateString(\"whatever-it-is\") 'uses default separator\nresult = SeperateString(\"whatever-it-is\", \"*\") 'uses another separator\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/sect4ck6.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/sect4ck6.aspx</a></p>\n"}, {"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1432669364, "post_id": 30467439, "comment_id": 49015430, "body": "++ For beating me to it :)"}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 6, "last_activity_date": 1432669982, "last_edit_date": 1432669982, "creation_date": 1432669177, "answer_id": 30467439, "question_id": 30467380, "link": "https://stackoverflow.com/questions/30467380/function-with-optional-parameter/30467439#30467439", "title": "Function with Optional parameter", "body": "<pre><code>Private Function SeparateString(MainString as String, \n                                Optional Separator as String = \"-\") As String\n</code></pre>\n\n<p>Oh, and this is VBA. No <code>{}</code> and no <code>//</code>, but I'm sure you know that...</p>\n\n<p>I would have to suggest, however, that using <code>Split()</code> would likely be a better option than writing your own.</p>\n"}, {"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 4, "last_activity_date": 1432670036, "last_edit_date": 1432670036, "creation_date": 1432669214, "answer_id": 30467455, "question_id": 30467380, "link": "https://stackoverflow.com/questions/30467380/function-with-optional-parameter/30467455#30467455", "title": "Function with Optional parameter", "body": "<p>You are working in VBA and not C# so do away with those curly braces.</p>\n\n<p>The moment you type the first line and press <kbd>Enter</kbd>, the VBE will automatically add <code>End Function</code></p>\n\n<pre><code>Private Function SeperateString(MainString As String, Seperator As String) As String\n\nEnd Function\n</code></pre>\n\n<p>To make a parameter optional, use the keyword <code>Optional</code> before it</p>\n\n<p>Example</p>\n\n<pre><code>Private Function SeperateString(MainString As String, Optional Seperator As String = \"-\") As String\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 481, "favorite_count": 0, "accepted_answer_id": 30467426, "answer_count": 3, "score": 1, "last_activity_date": 1432670036, "creation_date": 1432668967, "question_id": 30467380, "link": "https://stackoverflow.com/questions/30467380/function-with-optional-parameter", "title": "Function with Optional parameter", "body": "<p>I am trying to learn and implement a Function in VBA with an optional argument. I am trying to seperate values in a string given a character or substring to seperate.</p>\n\n<pre><code>Private Function SeperateString(MainString As String, Seperator As String) As String\n{\n\n // Body \n\n}\n</code></pre>\n\n<p>Eg: I want to seperate \"1-2-3-4-5\" using seperator \"-\" or \"1/2/3/4/5\" using seperator \"/\". </p>\n\n<p>I will write the logic using Instr and other functions. My doubt is I want to pass a seperator so I don't need to write a seperate function for each and want \"-\" to be default if nothing is passed. Can I do that?</p>\n"}, {"tags": ["vba", "date", "excel"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4938956, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-KYzubtHUx9c/AAAAAAAAAAI/AAAAAAAAAC8/LQqRiKje6B8/photo.jpg?sz=128", "display_name": "piccolomair", "link": "https://stackoverflow.com/users/4938956/piccolomair"}, "edited": false, "score": 0, "creation_date": 1432683870, "post_id": 30468588, "comment_id": 49021933, "body": "Hi, it didn&#39;t work for me,  it gets stuck when setting the Pivot Table.  Is the Pivot table necessary?"}, {"owner": {"reputation": 153, "user_id": 4847484, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ffbe465422ceecf17a59ba1d46a0e22b?s=128&d=identicon&r=PG&f=1", "display_name": "Federico Sanchez", "link": "https://stackoverflow.com/users/4847484/federico-sanchez"}, "reply_to_user": {"reputation": 25, "user_id": 4938956, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-KYzubtHUx9c/AAAAAAAAAAI/AAAAAAAAAC8/LQqRiKje6B8/photo.jpg?sz=128", "display_name": "piccolomair", "link": "https://stackoverflow.com/users/4938956/piccolomair"}, "edited": false, "score": 0, "creation_date": 1432730889, "post_id": 30468588, "comment_id": 49044388, "body": "i was assuming you had one, if not, use something like:      Set PRange = Range(&quot;Table_D&quot;) &#39;     Set MyWorkbook = ActiveWorkbook        MyWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=PRange, Version:=xlPivotTableVersion14).CreatePivotTable TableDestination:=Sheets(&quot;Pivot&quot;).Range(&quot;A1&quot;), TableName:=&quot;PivotTable1&quot; _  , DefaultVersion:=xlPivotTableVersion14  i think slicers come with the pivot table. it would be better if you had one."}], "tags": [], "owner": {"reputation": 153, "user_id": 4847484, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ffbe465422ceecf17a59ba1d46a0e22b?s=128&d=identicon&r=PG&f=1", "display_name": "Federico Sanchez", "link": "https://stackoverflow.com/users/4847484/federico-sanchez"}, "is_accepted": false, "score": 0, "last_activity_date": 1432673260, "creation_date": 1432673260, "answer_id": 30468588, "question_id": 30467355, "link": "https://stackoverflow.com/questions/30467355/control-multiple-slicers-with-a-single-prompt-using-vba/30468588#30468588", "title": "Control multiple slicers with a single prompt using vba", "body": "<p>i have something like:\n    dim PT as pivottable\n    Dim Sdate As SlicerCache\n    Dim DateSlicer As Slicer</p>\n\n<pre><code>Set PT = Sheets(\"Pivot\").PivotTables(\"PivotTable1\")\nSet Sdate = MyWorkbook.SlicerCaches.Add(PT, \"Dates\")'\"Dates\" is the header of the column\nSet DateSlicer = Sdate.Slicers.Add(SlicerDestination:=Sheets(\"Pivot\"), Name:=\"Time period\", Caption:=\"Dte\", Top:=40 + 187.5 + 187.5, Left:=width_counter, Width:=144, Height:=187.5) 'Top Left WIDTH HEIGHT\n\n'Loop a slicer\nFor Each sI In Sdate.SlicerItems\n\n    Debug.Print \"Caption; \u2013 &gt; \" &amp; sI.Caption\n    Debug.Print \"Value; \u2013 &gt; \" + CStr(sI.Value)\n    Debug.Print \"Unique; Name; \u2013 &gt; \" + sI.Name\n    Debug.Print \"\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\"\n    hoy = Format(Date, \"mm/dd/yyyy\")\n\n    If CDate(sI.Value) &lt; CDate(hoy) Then\n    sI.Selected = False\n    End If\n\n\n\nNext\n</code></pre>\n\n<p>that way you filter the dates to leave the ones after today for example</p>\n"}], "owner": {"reputation": 25, "user_id": 4938956, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-KYzubtHUx9c/AAAAAAAAAAI/AAAAAAAAAC8/LQqRiKje6B8/photo.jpg?sz=128", "display_name": "piccolomair", "link": "https://stackoverflow.com/users/4938956/piccolomair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 717, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432673260, "creation_date": 1432668894, "last_edit_date": 1432670885, "question_id": 30467355, "link": "https://stackoverflow.com/questions/30467355/control-multiple-slicers-with-a-single-prompt-using-vba", "title": "Control multiple slicers with a single prompt using vba", "body": "<p>I currently have a spreadsheet that has about 40 columns of data, 16 of which are dates.  I was tasked to add some sort of function that would allow an easier ability to filter through dates and date ranges. </p>\n\n<p>What I did was I transformed the spreadsheet into an xml table and then added slicers to each of the columns that utilized dates. I added a macro button to help clear selections as well. </p>\n\n<p>However I was told I didn't quite hit the mark as they want the function to filter all of the date columns from one central function (instead of various slicers) </p>\n\n<p>Ideally what they want is a place to input two dates (start and end) and have the entire file filter to where those dates are true. </p>\n\n<p>Supposedly they have utilized a spreadsheet that did exactly this using vba macros,  but I have no idea how to even start controlling the slicers. </p>\n\n<p>I did create a vba code that auto filtered from a given date range,  but I can't get it to work with multiple filters (and I have to convert my xml table back to range) </p>\n\n<pre><code>Public Sub allFilter()\n\n    Dim lngStart As Long, lngEnd As Long\n\n    lngStart = Range(\"B1\").Value 'assume this is the start date\n\n    lngEnd = Range(\"B2\").Value 'assume this is the end date\n\n    Range(\"M5:M900\").AutoFilter field:=1, _\n\n        Criteria1:=\"&gt;=\" &amp; lngStart, _\n\n        Operator:=xlAnd, _\n\n        Criteria2:=\"&lt;=\" &amp; lngEnd\n\nEnd Sub\n</code></pre>\n\n<p>Again,  ideally they want to be able to input the date range and have all filters respond to that input,  but I figure I've already created all the slicers and it may be easier to tell all slicers to filter the same way. </p>\n\n<p>Sorry if this is confusing. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 169, "user_id": 4939876, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/d4668dc8c8e1ab25fd883e7407542c79?s=128&d=identicon&r=PG&f=1", "display_name": "David H", "link": "https://stackoverflow.com/users/4939876/david-h"}, "edited": false, "score": 0, "creation_date": 1433304656, "post_id": 30467420, "comment_id": 49288307, "body": "I can get the departure and arrival times but I don&#39;t know how to work out whether the current step is a walking, driving or transit step for example, a route may start off by walking to a bus stop, Catch bus 55 etc."}], "tags": [], "owner": {"reputation": 390, "user_id": 4889516, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JExrI.jpg?s=128&g=1", "display_name": "iShaymus", "link": "https://stackoverflow.com/users/4889516/ishaymus"}, "is_accepted": false, "score": 0, "last_activity_date": 1432669109, "creation_date": 1432669109, "answer_id": 30467420, "question_id": 30467183, "link": "https://stackoverflow.com/questions/30467183/excel-vba-accessing-transit-details-array-from-google-directions-api-using-xml/30467420#30467420", "title": "Excel VBA - Accessing transit_details array from Google directions API using XML", "body": "<p>Sounds like you need an XML Parser for VBA so that you can reference the XML with it's native structure.  I'm not sure if there's XML parsers for VBA, I'll look when I get home from work (no time now)</p>\n"}], "owner": {"reputation": 169, "user_id": 4939876, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/d4668dc8c8e1ab25fd883e7407542c79?s=128&d=identicon&r=PG&f=1", "display_name": "David H", "link": "https://stackoverflow.com/users/4939876/david-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 231, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432669109, "creation_date": 1432668309, "last_edit_date": 1531164843, "question_id": 30467183, "link": "https://stackoverflow.com/questions/30467183/excel-vba-accessing-transit-details-array-from-google-directions-api-using-xml", "title": "Excel VBA - Accessing transit_details array from Google directions API using XML", "body": "<p>I am accessing the Google Directions API from Excel using VBA. I would like to be able to access the transit_details array in the Google directions API when retrieving transit directions using XML from VBA so I can get number of stops etc. At the moment I have code that gives me basic directions but I don't get stop numbers etc for transit directions:\nThe following is the Google Directions API webpage: <a href=\"https://developers.google.com/maps/documentation/directions/\" rel=\"nofollow\">https://developers.google.com/maps/documentation/directions/</a></p>\n\n<pre><code>'Get Directions\n        For Each nodeRoute In .SelectSingleNode(\"//route/leg\").ChildNodes\n        If nodeRoute.BaseName = \"step\" Then\n            strInstructions = strInstructions &amp; nodeRoute.SelectSingleNode(\"html_instructions\").text &amp; \" - \" &amp; nodeRoute.SelectSingleNode(\"distance/text\").text &amp; vbCrLf\n                   End If\n    Next\n\n    strInstructions = CleanHTML(strInstructions) 'Removes MetaTag information from HTML result to convert to plain text.\n\nElse\n    strError = .SelectSingleNode(\"//status\").text\n    GoTo errorHandler\nEnd If\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "edited": false, "score": 0, "creation_date": 1432707403, "post_id": 30466844, "comment_id": 49028674, "body": "Thank you for your great and very helpful answer. I removed the border."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 2, "last_activity_date": 1432668071, "last_edit_date": 1432668071, "creation_date": 1432667183, "answer_id": 30466844, "question_id": 30466669, "link": "https://stackoverflow.com/questions/30466669/align-text-in-labels-and-text-boxes/30466844#30466844", "title": "Align text in labels and text boxes?", "body": "<p>Assuming that the <code>.Top</code> and <code>.Font</code> and <code>.FontSize</code> of both the controls are same, there will still be some difference because the TextBox has a border and the Label doesn't. </p>\n\n<p><img src=\"https://i.stack.imgur.com/t7oSy.jpg\" alt=\"enter image description here\"></p>\n\n<p>You will have to either</p>\n\n<ol>\n<li>Manually move the Label up and down or </li>\n<li>Remove the border of the Textbox.</li>\n</ol>\n\n<p><img src=\"https://i.stack.imgur.com/CafHH.jpg\" alt=\"enter image description here\"></p>\n\n<p>Here is a side by side comparison</p>\n\n<p><img src=\"https://i.stack.imgur.com/CjFG0.jpg\" alt=\"enter image description here\"></p>\n\n<p><strong>Edit</strong>: Oh BTW, if you choose the first option, i.e, moving the Label up and down, then here is a neat trick which may help you. Add a command button and reduce it's height so it looks like a thin line. Use that as a scale to align the controls and then in the end simply delete the command button.</p>\n\n<p><img src=\"https://i.stack.imgur.com/VRHYU.jpg\" alt=\"enter image description here\"></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 14333047, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iHXK5zjMj80/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucnXLkbfGMOTdv710PrUdXWgwefHEQ/photo.jpg?sz=128", "display_name": "Daan", "link": "https://stackoverflow.com/users/14333047/daan"}, "is_accepted": false, "score": 1, "last_activity_date": 1602668416, "creation_date": 1602668416, "answer_id": 64350547, "question_id": 30466669, "link": "https://stackoverflow.com/questions/30466669/align-text-in-labels-and-text-boxes/64350547#64350547", "title": "Align text in labels and text boxes?", "body": "<p>After many years this question was still relevant to me. Here's my solution:</p>\n<p>I found that this is easily solved by looping over every control when initializing the form and adjusting the height for each label by 2. All you need to do is give all labels that you want to move a similar naming convention which you can use in the If statement, &quot;lbl_&quot; in my case.</p>\n<pre><code>For Each contr In Me.Controls\n\nIf contr.Name Like &quot;lbl_*&quot; Then\n    \n    contr.top = contr.top + 2\n    \nEnd If\nNext\n</code></pre>\n"}], "owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3471, "favorite_count": 0, "accepted_answer_id": 30466844, "answer_count": 2, "score": 1, "last_activity_date": 1602668416, "creation_date": 1432666637, "question_id": 30466669, "link": "https://stackoverflow.com/questions/30466669/align-text-in-labels-and-text-boxes", "title": "Align text in labels and text boxes?", "body": "<p>Even if text box controls and label control are aligned, the text in them does not appear in the same vertical position.</p>\n\n<p>Is there any good practice for how to align text in labels and text boxes in VBA userforms?</p>\n\n<p><img src=\"https://i.stack.imgur.com/1eoW7.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["vba", "internet-explorer", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4625572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87a0ed7803cf93e1a5e30685b10c09f9?s=128&d=identicon&r=PG&f=1", "display_name": "dubsCat", "link": "https://stackoverflow.com/users/4625572/dubscat"}, "edited": false, "score": 0, "creation_date": 1432761917, "post_id": 30466880, "comment_id": 49064550, "body": "thank you for your very quick repsonse!   as you mention in your instructions, i had to &#39;flip&#39; the european decimal designator (,) with &quot;.&quot;, and  simply convert to miles - all seems to be working fine, now - thnx again!"}, {"owner": {"reputation": 1, "user_id": 4625572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87a0ed7803cf93e1a5e30685b10c09f9?s=128&d=identicon&r=PG&f=1", "display_name": "dubsCat", "link": "https://stackoverflow.com/users/4625572/dubscat"}, "edited": false, "score": 0, "creation_date": 1432771286, "post_id": 30466880, "comment_id": 49067702, "body": "again, thnx - however, seems to fail at distances over 600mi (c. 1000km); is there a setting in the function code that can be &#39;expanded&#39;, or is this an intrinsic limitation with the the googlemaps api?"}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "reply_to_user": {"reputation": 1, "user_id": 4625572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87a0ed7803cf93e1a5e30685b10c09f9?s=128&d=identicon&r=PG&f=1", "display_name": "dubsCat", "link": "https://stackoverflow.com/users/4625572/dubscat"}, "edited": false, "score": 0, "creation_date": 1432798392, "post_id": 30466880, "comment_id": 49076301, "body": "Please mark as answer then. Probably it fails over 1000km as I am guessing that the output would return the result with a comma like &quot;,&quot;. I will look into my post to correct this soon"}, {"owner": {"reputation": 1, "user_id": 4625572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87a0ed7803cf93e1a5e30685b10c09f9?s=128&d=identicon&r=PG&f=1", "display_name": "dubsCat", "link": "https://stackoverflow.com/users/4625572/dubscat"}, "edited": false, "score": 0, "creation_date": 1432828925, "post_id": 30466880, "comment_id": 49098678, "body": "ANSWERED:  the &#39;distance in meters&#39; function seems to work fine, AnalystCave - I flip the &quot;,&quot; and &quot;.&quot;, then convert to miles; all numbers are coming in fine, in &quot;x,xxx.x&quot; format.   thanks again!"}], "tags": [], "owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "is_accepted": false, "score": 0, "last_activity_date": 1432667281, "creation_date": 1432667281, "answer_id": 30466880, "question_id": 30466591, "link": "https://stackoverflow.com/questions/30466591/entering-addresses-in-googlemaps-directions-via-vba-and-retrieving-miles/30466880#30466880", "title": "Entering addresses in GoogleMaps &quot;Directions&quot; via VBA and retrieving miles", "body": "<p>I wrote 2 posts on how to play with Google API with VBA:</p>\n\n<p><strong>Calculating distances between adresses:</strong></p>\n\n<p><a href=\"http://www.analystcave.com/excel-calculate-distances-between-addresses/\" rel=\"nofollow\">http://www.analystcave.com/excel-calculate-distances-between-addresses/</a></p>\n\n<p><strong>Getting coordinates</strong></p>\n\n<p><a href=\"http://www.analystcave.com/excel-get-geolocation-coordinates-of-an-address/\" rel=\"nofollow\">http://www.analystcave.com/excel-get-geolocation-coordinates-of-an-address/</a></p>\n"}], "owner": {"reputation": 1, "user_id": 4625572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87a0ed7803cf93e1a5e30685b10c09f9?s=128&d=identicon&r=PG&f=1", "display_name": "dubsCat", "link": "https://stackoverflow.com/users/4625572/dubscat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 903, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1432667281, "creation_date": 1432666341, "last_edit_date": 1495542606, "question_id": 30466591, "link": "https://stackoverflow.com/questions/30466591/entering-addresses-in-googlemaps-directions-via-vba-and-retrieving-miles", "title": "Entering addresses in GoogleMaps &quot;Directions&quot; via VBA and retrieving miles", "body": "<p>and many thanks in advance for any assistance!  i am needing to develop an automated excel (2010/13) frontend that will open IE, load in a 'starting point' and 'destination' address, then retrieve the 'miles'.   i have reviewed numerous links (eg, <a href=\"https://stackoverflow.com/questions/26832431/vba-not-able-to-pull-value-within-input-tag-using-getelementsbytagname-valu\">VBA: not able to pull value within &lt;input&gt; tag using getelementsbyTagname().Value</a>) and youtube videos (eg, <a href=\"https://www.youtube.com/watch?v=4C0zhbuo5lI\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=4C0zhbuo5lI</a>) and think i have the basic vba code kernals correct; however, i simply cannot find the correct elementID (eg, \"ie.document.getelementID(\"?????\")...).   i have done numerous searches in the IE source html, as well as google chrome's 'inspect element' feature.  wonder if anyone could point me in the right direction here?  </p>\n\n<p>the url is: <a href=\"https://www.google.com/maps/dir///@34.2889944,-118.8442391,15z\" rel=\"nofollow noreferrer\">https://www.google.com/maps/dir///@34.2889944,-118.8442391,15z</a></p>\n\n<p>and again, i'm trying to find the correct element for \"Choose starting point\" and \"Choose destination\", and then for the 'XXX miles'</p>\n\n<p>i have also tried a couple of loops to determine '...elementByTagName()', without success.  for example:</p>\n\n<pre><code>...\nSet AllHyperLinks = ie.document.getElementsByTagName(\"Directions\")\n    For Each hyper_link In AllHyperLinks\n       MsgBox hyper_link.innerText\n        If hyper_link.innerText = \"Choose starting point\" Then\n            hper_link.Click\n            Exit For\n        End If\n    Next\n ...\n</code></pre>\n\n<p>again, thanks in advance!</p>\n"}, {"tags": ["vba", "excel", "outlook"], "comments": [{"owner": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "edited": false, "score": 0, "creation_date": 1432666313, "post_id": 30466439, "comment_id": 49013674, "body": "Why are you not using the Outlook Object Model?"}, {"owner": {"reputation": 11, "user_id": 4941770, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--UQtQypj6L0/AAAAAAAAAAI/AAAAAAAAIGg/OW-Zj4wDsVQ/photo.jpg?sz=128", "display_name": "Russell Jardine", "link": "https://stackoverflow.com/users/4941770/russell-jardine"}, "reply_to_user": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "edited": false, "score": 0, "creation_date": 1432666713, "post_id": 30466439, "comment_id": 49013918, "body": "This code was being used with groupwise email system but now we have changed to outlook. I know I misspelt Hotmail but that is not the answer. I thought I could just alter the original with the formatting of outlook."}, {"owner": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "edited": false, "score": 0, "creation_date": 1432666914, "post_id": 30466439, "comment_id": 49014040, "body": "That doesn&#39;t really answer my question.  Why are you not using Outlook objects?"}, {"owner": {"reputation": 11, "user_id": 4941770, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--UQtQypj6L0/AAAAAAAAAAI/AAAAAAAAIGg/OW-Zj4wDsVQ/photo.jpg?sz=128", "display_name": "Russell Jardine", "link": "https://stackoverflow.com/users/4941770/russell-jardine"}, "reply_to_user": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "edited": false, "score": 0, "creation_date": 1432667009, "post_id": 30466439, "comment_id": 49014090, "body": "I am not familiar with the outlook object model but I will look it up thanks"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4941770, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--UQtQypj6L0/AAAAAAAAAAI/AAAAAAAAIGg/OW-Zj4wDsVQ/photo.jpg?sz=128", "display_name": "Russell Jardine", "link": "https://stackoverflow.com/users/4941770/russell-jardine"}, "edited": false, "score": 0, "creation_date": 1432668469, "post_id": 30466861, "comment_id": 49014921, "body": "I tried the recipients collection code but it does not put the names in the To: address box"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1432667231, "creation_date": 1432667231, "answer_id": 30466861, "question_id": 30466439, "link": "https://stackoverflow.com/questions/30466439/hard-code-email-address-in-excel/30466861#30466861", "title": "Hard code email address in Excel", "body": "<p>You can automate Outlook from Excel to get the job done. See <a href=\"https://support.microsoft.com/en-us/kb/201096\" rel=\"nofollow\">How to automate Outlook from another program</a> for more information.</p>\n\n<p>Use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff866751.aspx\" rel=\"nofollow\">Recipients</a> collection to specify the To, CC or Bcc recipients.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 4941770, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--UQtQypj6L0/AAAAAAAAAAI/AAAAAAAAIGg/OW-Zj4wDsVQ/photo.jpg?sz=128", "display_name": "Russell Jardine", "link": "https://stackoverflow.com/users/4941770/russell-jardine"}, "edited": false, "score": 0, "creation_date": 1432668919, "post_id": 30467238, "comment_id": 49015167, "body": "That looks great I will give it a try. Thanks"}, {"owner": {"reputation": 11, "user_id": 4941770, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--UQtQypj6L0/AAAAAAAAAAI/AAAAAAAAIGg/OW-Zj4wDsVQ/photo.jpg?sz=128", "display_name": "Russell Jardine", "link": "https://stackoverflow.com/users/4941770/russell-jardine"}, "edited": false, "score": 0, "creation_date": 1432670699, "post_id": 30467238, "comment_id": 49016202, "body": "It works for the sending of the email but it is not including the attachments."}, {"owner": {"reputation": 11, "user_id": 4941770, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--UQtQypj6L0/AAAAAAAAAAI/AAAAAAAAIGg/OW-Zj4wDsVQ/photo.jpg?sz=128", "display_name": "Russell Jardine", "link": "https://stackoverflow.com/users/4941770/russell-jardine"}, "edited": false, "score": 0, "creation_date": 1432670780, "post_id": 30467238, "comment_id": 49016253, "body": "was the line under   For I = LBound(myfilelist) etc"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 11, "user_id": 4941770, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--UQtQypj6L0/AAAAAAAAAAI/AAAAAAAAIGg/OW-Zj4wDsVQ/photo.jpg?sz=128", "display_name": "Russell Jardine", "link": "https://stackoverflow.com/users/4941770/russell-jardine"}, "edited": false, "score": 0, "creation_date": 1432670790, "post_id": 30467238, "comment_id": 49016261, "body": "Sorry my mistake. I had commented the line."}, {"owner": {"reputation": 11, "user_id": 4941770, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--UQtQypj6L0/AAAAAAAAAAI/AAAAAAAAIGg/OW-Zj4wDsVQ/photo.jpg?sz=128", "display_name": "Russell Jardine", "link": "https://stackoverflow.com/users/4941770/russell-jardine"}, "edited": false, "score": 0, "creation_date": 1432670809, "post_id": 30467238, "comment_id": 49016270, "body": "supposed to be a comment?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 11, "user_id": 4941770, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--UQtQypj6L0/AAAAAAAAAAI/AAAAAAAAIGg/OW-Zj4wDsVQ/photo.jpg?sz=128", "display_name": "Russell Jardine", "link": "https://stackoverflow.com/users/4941770/russell-jardine"}, "edited": false, "score": 0, "creation_date": 1432670825, "post_id": 30467238, "comment_id": 49016280, "body": "Remove the <code>&#39;</code> before <code>.Attachments.Add MyFileList(i)</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 11, "user_id": 4941770, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--UQtQypj6L0/AAAAAAAAAAI/AAAAAAAAIGg/OW-Zj4wDsVQ/photo.jpg?sz=128", "display_name": "Russell Jardine", "link": "https://stackoverflow.com/users/4941770/russell-jardine"}, "edited": false, "score": 0, "creation_date": 1432670859, "post_id": 30467238, "comment_id": 49016299, "body": "I have updated the post. You may have to refresh the page to see it :)"}, {"owner": {"reputation": 11, "user_id": 4941770, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--UQtQypj6L0/AAAAAAAAAAI/AAAAAAAAIGg/OW-Zj4wDsVQ/photo.jpg?sz=128", "display_name": "Russell Jardine", "link": "https://stackoverflow.com/users/4941770/russell-jardine"}, "edited": false, "score": 0, "creation_date": 1432671016, "post_id": 30467238, "comment_id": 49016387, "body": "I&#39;ll try again and it works great thank you very much"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 1, "last_activity_date": 1432670777, "last_edit_date": 1432670777, "creation_date": 1432668485, "answer_id": 30467238, "question_id": 30466439, "link": "https://stackoverflow.com/questions/30466439/hard-code-email-address-in-excel/30467238#30467238", "title": "Hard code email address in Excel", "body": "<p>Here is a very basic example of how to automate Outlook from Excel. Please note I am using LateBinding.</p>\n\n<pre><code>Option Explicit\n\nSub Sample()\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim MyFileList(1) As String\n    Dim i As Long\n\n    '~~&gt; Change/Add the file names here\n    MyFileList(0) = \"C:\\Sample1.xlsx\"\n    MyFileList(1) = \"C:\\Sample2.xlsx\"\n\n    '~~&gt; Create a new instance of outlook\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    '~~&gt; Create a new Email\n    Set OutMail = OutApp.CreateItem(0)\n\n    '~~&gt; Set the To/CC/BCC etc here\n    With OutMail\n        .To = \"MyEmail1@123.com\" &amp; \";\" &amp; \"MyEmail2@123.com\" &amp; \";\" &amp; \"MyEmail3@123.com\"\n        .CC = \"MyEmail4@123.com\"\n        .Bcc = \"MyEmail5@123.com\"\n        .Subject = \"Example for attaching 2 files\"\n        .Body = \"Hi Russel :)\"\n\n        '~~&gt; Attaching file\n        For i = LBound(MyFileList) To UBound(MyFileList)\n            .Attachments.Add MyFileList(i)\n        Next i\n\n        '~~&gt; Display the email. To send the email, Change the below to .Send\n        .Display\n    End With\nEnd Sub\n</code></pre>\n\n<p><strong>ScreenShot</strong>:</p>\n\n<p><img src=\"https://i.stack.imgur.com/Qdox9.jpg\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 11, "user_id": 4941770, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--UQtQypj6L0/AAAAAAAAAAI/AAAAAAAAIGg/OW-Zj4wDsVQ/photo.jpg?sz=128", "display_name": "Russell Jardine", "link": "https://stackoverflow.com/users/4941770/russell-jardine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1432670777, "creation_date": 1432665813, "last_edit_date": 1432668873, "question_id": 30466439, "link": "https://stackoverflow.com/questions/30466439/hard-code-email-address-in-excel", "title": "Hard code email address in Excel", "body": "<p>The following is a simple code that will send an email using whatever email program is open. My problem is that I would like to add three emails to the list but outlook 2013 only recognizes it if I have one address.\nWhat is the correct format for outlook?\n<code>Application.Dialogs(xlDialogSendMail).Show _\n arg1:=\"attributes@hotmail.ca\", _\n arg2:=\"East attributes\" &amp; Now()</code></p>\n\n<p>I have tried </p>\n\n<p><code>Application.Dialogs(xlDialogSendMail).Show _\n arg1:=\"attributes@hotmail.ca\" &amp; \";\" &amp; \"runaway@gmail.com\", _\n arg2:=\"East attributes\" &amp; Now()</code></p>\n"}, {"tags": ["excel", "vba", "worksheet"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1432665566, "post_id": 30466233, "comment_id": 49013220, "body": "A good habit is to qualify the application globals with <code>Application.</code> - had you done that, IntelliSense would have told you what you were looking for."}], "answers": [{"tags": [], "owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "is_accepted": false, "score": 11, "last_activity_date": 1432665521, "creation_date": 1432665521, "answer_id": 30466359, "question_id": 30466233, "link": "https://stackoverflow.com/questions/30466233/how-to-declare-an-active-worksheet-in-a-variable/30466359#30466359", "title": "How to declare an Active Worksheet in a variable?", "body": "<p>You need to use <code>ActiveSheet</code> instead of <code>ActiveWorksheet</code></p>\n"}, {"tags": [], "owner": {"reputation": 390, "user_id": 4889516, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JExrI.jpg?s=128&g=1", "display_name": "iShaymus", "link": "https://stackoverflow.com/users/4889516/ishaymus"}, "is_accepted": false, "score": 3, "last_activity_date": 1432668555, "creation_date": 1432668555, "answer_id": 30467258, "question_id": 30466233, "link": "https://stackoverflow.com/questions/30466233/how-to-declare-an-active-worksheet-in-a-variable/30467258#30467258", "title": "How to declare an Active Worksheet in a variable?", "body": "<p>I prefer not to use ActiveSheet in VBA because if further down the track you start writing code that uses multiple worksheets it can become confusing when trying to determine which is which.  I prefer the following</p>\n\n<pre><code>dim ws as Worksheet\n\nws = Thisworkbook.Worksheets(1)\n\nOR\n\nws = Thisworkbook.Worksheets(\"worksheet name\")\n</code></pre>\n\n<p>The only time I use Activesheet now is when I need some code to work on any worksheet regardless of what it contains, which is very rare.  In this case as has been stated above use:</p>\n\n<pre><code>dim ws as Worksheet\n\nws = Thisworkbook.Activesheet\n\nOR\n\nws = Activesheet\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 982, "user_id": 4035306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XirX6.jpg?s=128&g=1", "display_name": "Lutscha", "link": "https://stackoverflow.com/users/4035306/lutscha"}, "is_accepted": false, "score": 0, "last_activity_date": 1508914119, "creation_date": 1508914119, "answer_id": 46925712, "question_id": 30466233, "link": "https://stackoverflow.com/questions/30466233/how-to-declare-an-active-worksheet-in-a-variable/46925712#46925712", "title": "How to declare an Active Worksheet in a variable?", "body": "<p>For me I like to directly speak to the worksheet I want to adress using Sheet(\"Worksheet\").</p>\n\n<p>So if you want to take an information form a particular sheet you can use this:</p>\n\n<pre><code>Dim ExampleWorksheet as Worksheet\nDim Example as Integer\n\nExample = Sheets(\"ExampleWorksheet\").Cells(x,y)\n</code></pre>\n\n<p>So you get rid of messing around with an active or not active worksheets.</p>\n"}], "owner": {"reputation": 71, "user_id": 4921447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0788d61521baa8b1359f6c26a8d38913?s=128&d=identicon&r=PG&f=1", "display_name": "unikitty94", "link": "https://stackoverflow.com/users/4921447/unikitty94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69604, "favorite_count": 0, "answer_count": 3, "score": 5, "last_activity_date": 1573231558, "creation_date": 1432665101, "last_edit_date": 1573231558, "question_id": 30466233, "link": "https://stackoverflow.com/questions/30466233/how-to-declare-an-active-worksheet-in-a-variable", "title": "How to declare an Active Worksheet in a variable?", "body": "<p>I'm trying to keep a variable to the currently open worksheet in VBA. So far I have </p>\n\n<pre><code> Dim Active As Worksheet\n Set Active = ActiveWorksheet \n</code></pre>\n\n<p>For some reason it gives me an error in the last line, saying Object required. My code opens a new worksheet with the data in the Active sheet, so I need a variable to hold my place in the currently active worksheet. Any idea why this isn't working correctly?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "edited": false, "score": 1, "creation_date": 1432665937, "post_id": 30466067, "comment_id": 49013429, "body": "I know you state you want a macro to perform this, but would instead be open to using an Excel formula?  It sounds like a VLOOKUP would solve your problem."}, {"owner": {"reputation": 33, "user_id": 4825328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd948bc1e50542fc894b6a110f93ec53?s=128&d=identicon&r=PG&f=1", "display_name": "samfortunato", "link": "https://stackoverflow.com/users/4825328/samfortunato"}, "reply_to_user": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "edited": false, "score": 0, "creation_date": 1432666198, "post_id": 30466067, "comment_id": 49013595, "body": "Well, I&#39;m trying to change data in a file so I can upload that file to an online store, which will update my price and quantity on there. If I use a formula, would I still be able to save the file properly and upload it to the web?  If so, then I&#39;m all ears... willing to do whatever works."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1432666757, "post_id": 30466067, "comment_id": 49013952, "body": "To return values to the right of the SKU you can use the <a href=\"https://support.office.com/en-us/article/vlookup-function-adceda66-30de-4f26-923b-7257939faa65\" rel=\"nofollow noreferrer\">VLOOKUP function</a>. For values to the left of the SKU you will need an <a href=\"https://support.office.com/en-us/article/index-function-0ee99cef-a811-4762-8cfb-a222dd31368a\" rel=\"nofollow noreferrer\">INDEX</a>/<a href=\"https://support.office.com/en-us/article/match-function-0600e189-9f3c-4e4f-98c1-943a0eb427ca\" rel=\"nofollow noreferrer\">MATCH</a> pair. The formula results can be resolved to their values with Copy, Paste Special, Values."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 4825328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd948bc1e50542fc894b6a110f93ec53?s=128&d=identicon&r=PG&f=1", "display_name": "samfortunato", "link": "https://stackoverflow.com/users/4825328/samfortunato"}, "edited": false, "score": 0, "creation_date": 1432667365, "post_id": 30466699, "comment_id": 49014328, "body": "Alright, I remembered the reason why I want a macro and not a formula: I&#39;m going to be re-downloading updated versions of my product sheet frequently.  I&#39;d be going to my online store, downloading an excel sheet with my product quantity and price data, and then I want to run a macro to compare it to a different excel sheet that has more accurate/updated price and quantity data. I want it to grab the more accurate data and replace the old data in the first sheet I downloaded from my online store, then reupload.  If I put in a formula, I&#39;m going to have to enter in the formula every time (cont)"}, {"owner": {"reputation": 33, "user_id": 4825328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd948bc1e50542fc894b6a110f93ec53?s=128&d=identicon&r=PG&f=1", "display_name": "samfortunato", "link": "https://stackoverflow.com/users/4825328/samfortunato"}, "edited": false, "score": 0, "creation_date": 1432667408, "post_id": 30466699, "comment_id": 49014349, "body": "I re-download my product sheet. Unless there is a VBA macro that will do this for me?"}, {"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "reply_to_user": {"reputation": 33, "user_id": 4825328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd948bc1e50542fc894b6a110f93ec53?s=128&d=identicon&r=PG&f=1", "display_name": "samfortunato", "link": "https://stackoverflow.com/users/4825328/samfortunato"}, "edited": false, "score": 0, "creation_date": 1432667577, "post_id": 30466699, "comment_id": 49014447, "body": "If you&#39;d like to record a macro of yourself entering this formula then posting it here, I can modify it so that it will adjust to any number of rows.  That way it will be a macro as you desire."}, {"owner": {"reputation": 33, "user_id": 4825328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd948bc1e50542fc894b6a110f93ec53?s=128&d=identicon&r=PG&f=1", "display_name": "samfortunato", "link": "https://stackoverflow.com/users/4825328/samfortunato"}, "edited": false, "score": 0, "creation_date": 1432667750, "post_id": 30466699, "comment_id": 49014537, "body": "That would be fantastic, thank you. Do I enter in the formula in the specific column once, or do I enter in the formula once for each cell? I have hundreds of cells... if I have to enter it in each cell, is there a way to do this faster?"}, {"owner": {"reputation": 33, "user_id": 4825328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd948bc1e50542fc894b6a110f93ec53?s=128&d=identicon&r=PG&f=1", "display_name": "samfortunato", "link": "https://stackoverflow.com/users/4825328/samfortunato"}, "edited": false, "score": 0, "creation_date": 1432668026, "post_id": 30466699, "comment_id": 49014677, "body": "Also, I can&#39;t manually enter in the &quot;last row number&quot; of my data, because for each file, I would be adding new products in frequently, so the &quot;last row number&quot; would be constantly changing. Is there something I can enter to always get the &quot;last row number&quot; no matter how many rows I have? Like a &quot;get last row with data&#39;s number&quot; thing?"}, {"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "reply_to_user": {"reputation": 33, "user_id": 4825328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd948bc1e50542fc894b6a110f93ec53?s=128&d=identicon&r=PG&f=1", "display_name": "samfortunato", "link": "https://stackoverflow.com/users/4825328/samfortunato"}, "edited": false, "score": 0, "creation_date": 1432668855, "post_id": 30466699, "comment_id": 49015135, "body": "Yes, I can add that in once I get the macro that you&#39;ve recorded.  That&#39;s what I meant by &quot;adjust to any number of rows.&quot;  And you can simply copy the formula and paste it down to the bottom of your data."}, {"owner": {"reputation": 33, "user_id": 4825328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd948bc1e50542fc894b6a110f93ec53?s=128&d=identicon&r=PG&f=1", "display_name": "samfortunato", "link": "https://stackoverflow.com/users/4825328/samfortunato"}, "edited": false, "score": 0, "creation_date": 1432669726, "post_id": 30466699, "comment_id": 49015641, "body": "Right, sorry, wasn&#39;t reading your comment clearly :P.  I&#39;ve recorded the macro and added it to an edit on my original question post. Didn&#39;t have enough room here.  Also, when I entered in the formulas you gave me, they didn&#39;t work. I just get an #N/A in each cell. Tried to edit the numbers and column letters in the formulas, and it still didn&#39;t work.    Thanks so much for your help so far."}, {"owner": {"reputation": 33, "user_id": 4825328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd948bc1e50542fc894b6a110f93ec53?s=128&d=identicon&r=PG&f=1", "display_name": "samfortunato", "link": "https://stackoverflow.com/users/4825328/samfortunato"}, "edited": false, "score": 0, "creation_date": 1432672432, "post_id": 30466699, "comment_id": 49017231, "body": "It still doesn&#39;t work. Getting an error that says &quot;Can&#39;t execute code in break mode&quot;."}, {"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "reply_to_user": {"reputation": 33, "user_id": 4825328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd948bc1e50542fc894b6a110f93ec53?s=128&d=identicon&r=PG&f=1", "display_name": "samfortunato", "link": "https://stackoverflow.com/users/4825328/samfortunato"}, "edited": false, "score": 0, "creation_date": 1432672821, "post_id": 30466699, "comment_id": 49017455, "body": "That means that you were currently running a macro.  You need to stop that macro (whatever it was) before you can run this one.  If you open the visual basic page, there&#39;s a STOP button (near the top, play, pause, stop) that you will have to click before you can run the new macro."}, {"owner": {"reputation": 33, "user_id": 4825328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd948bc1e50542fc894b6a110f93ec53?s=128&d=identicon&r=PG&f=1", "display_name": "samfortunato", "link": "https://stackoverflow.com/users/4825328/samfortunato"}, "edited": false, "score": 0, "creation_date": 1432676150, "post_id": 30466699, "comment_id": 49019229, "body": "Now I&#39;m getting an error: &quot;Compile Error: Sub or Function not defined&quot;.  Thanks for all your help so far..."}, {"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "reply_to_user": {"reputation": 33, "user_id": 4825328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd948bc1e50542fc894b6a110f93ec53?s=128&d=identicon&r=PG&f=1", "display_name": "samfortunato", "link": "https://stackoverflow.com/users/4825328/samfortunato"}, "edited": false, "score": 0, "creation_date": 1432676465, "post_id": 30466699, "comment_id": 49019344, "body": "My mistake, I missed an &quot;s&quot; on Workbook, line 4 (the &quot;intDataRow =&quot; line).  Edited to accommodate."}, {"owner": {"reputation": 33, "user_id": 4825328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd948bc1e50542fc894b6a110f93ec53?s=128&d=identicon&r=PG&f=1", "display_name": "samfortunato", "link": "https://stackoverflow.com/users/4825328/samfortunato"}, "edited": false, "score": 0, "creation_date": 1432682831, "post_id": 30466699, "comment_id": 49021607, "body": "Getting an RTE now:  Run-time error: &#39;-2147352565 (8002000b)&#39;: The item with the specified name wasn&#39;t found."}, {"owner": {"reputation": 33, "user_id": 4825328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd948bc1e50542fc894b6a110f93ec53?s=128&d=identicon&r=PG&f=1", "display_name": "samfortunato", "link": "https://stackoverflow.com/users/4825328/samfortunato"}, "edited": false, "score": 0, "creation_date": 1433263737, "post_id": 30466699, "comment_id": 49272246, "body": "It doesn&#39;t tell me a row; it gives me that RTE and gives me an option to debug. When I click debug, it points to this line of code and highlights it yellow:  intDataRow = Workbooks(&quot;invexpa.xlsx&quot;).Sheets(&quot;Sheet1&quot;).Cells.Find(&quot;*&quot;, SearchOrder:=xlByRows, SearchDirection:=xlPrevious, After:=[A1]).Row"}, {"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "reply_to_user": {"reputation": 33, "user_id": 4825328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd948bc1e50542fc894b6a110f93ec53?s=128&d=identicon&r=PG&f=1", "display_name": "samfortunato", "link": "https://stackoverflow.com/users/4825328/samfortunato"}, "edited": false, "score": 0, "creation_date": 1433264966, "post_id": 30466699, "comment_id": 49273084, "body": "Do you currently have the invexpa.xlsx workbook open?  And the sheet name is &quot;Sheet1&quot;?  Both of those must be true for the macro to work."}, {"owner": {"reputation": 33, "user_id": 4825328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd948bc1e50542fc894b6a110f93ec53?s=128&d=identicon&r=PG&f=1", "display_name": "samfortunato", "link": "https://stackoverflow.com/users/4825328/samfortunato"}, "edited": false, "score": 0, "creation_date": 1433266775, "post_id": 30466699, "comment_id": 49274170, "body": "Yeah, both the sheet I want to update, and invexpa.xlsx are open. The sheet name is Sheet1.  .xlsx is a Excel 97-2003 workbook file, right?"}, {"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "reply_to_user": {"reputation": 33, "user_id": 4825328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd948bc1e50542fc894b6a110f93ec53?s=128&d=identicon&r=PG&f=1", "display_name": "samfortunato", "link": "https://stackoverflow.com/users/4825328/samfortunato"}, "edited": false, "score": 0, "creation_date": 1433270713, "post_id": 30466699, "comment_id": 49276451, "body": "The file extension for an Excel 97-2003 workbook is .xls (no ending x)."}, {"owner": {"reputation": 33, "user_id": 4825328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd948bc1e50542fc894b6a110f93ec53?s=128&d=identicon&r=PG&f=1", "display_name": "samfortunato", "link": "https://stackoverflow.com/users/4825328/samfortunato"}, "edited": false, "score": 0, "creation_date": 1433273921, "post_id": 30466699, "comment_id": 49278199, "body": "OK, I changed the file extension to .xls in the code. Now, no RTE, but it opens up a prompt for me to open a file when I run the macro. I tried to open the invexpa.xls file, then another Open File prompt came up again... tried to open invexpa.xls again. Came up four times I believe. I hit cancel the last two times, and it left the columns I want edited with a bunch of #N/A left in place."}, {"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "reply_to_user": {"reputation": 33, "user_id": 4825328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd948bc1e50542fc894b6a110f93ec53?s=128&d=identicon&r=PG&f=1", "display_name": "samfortunato", "link": "https://stackoverflow.com/users/4825328/samfortunato"}, "edited": false, "score": 0, "creation_date": 1433278351, "post_id": 30466699, "comment_id": 49280648, "body": "Just to make sure we&#39;re on the same page, you should already have the invexpa.xls file open when you run the code, but you&#39;re have active that page that you&#39;re inputting the formulas to?"}], "tags": [], "owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "is_accepted": false, "score": 0, "last_activity_date": 1433278408, "last_edit_date": 1433278408, "creation_date": 1432666723, "answer_id": 30466699, "question_id": 30466067, "link": "https://stackoverflow.com/questions/30466067/how-to-copy-price-quantity-data-from-one-excel-sheet-to-another-if-the-skus-in/30466699#30466699", "title": "How to copy price + quantity data from one Excel sheet to another if the SKUs in the rows match", "body": "<p>In your File 1, for Inventory, use the formula:\n<code>=VLOOKUP(F2,'[File2Name.xlsx]SheetName'!$E$2:$T$1000,8,FALSE)</code><br>\nAnd in the Price use:<br>\n<code>=VLOOKUP(F2,'[File2Name.xlsx]SheetName'!$E$2:$T$1000,16,FALSE)</code></p>\n\n<p>For these formulas, replace:</p>\n\n<ul>\n<li>\"File2Name\" with File 2's name</li>\n<li>\"SheetName\" with the name of the sheet File 2's data is on</li>\n<li>The \"1000\" in $T$1000 with the last row number of your data.</li>\n</ul>\n\n<p>Then just copy this formula all the way down in both columns.</p>\n\n<p>Try this macro to automatically fill in the formula (you must have the sheet that you're copying TO open):  </p>\n\n<pre><code>Sub stackoverflow_reverb_formula_input()\n\nDim intDataRow As Integer, intCurrentRow As Integer\nintDataRow = Workbooks(\"invexpa.xlsx\").Sheets(\"Sheet1\").Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious, After:=[A1]).Row\nintCurrentRow = ActiveSheet.Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious, After:=[A1]).Row\nRange(\"E2\").FormulaR1C1 = _\n    \"=VLOOKUP(RC[1],[invexpa.xlsx]Sheet1!R1C5:R\" + CStr(intDataRow) + \"C20,8,FALSE)\"\nRange(\"L2\").FormulaR1C1 = _\n    \"=VLOOKUP(RC[-6],[invexpa.xlsx]Sheet1!R1C5:R\" + CStr(intDataRow) + \"C20,16,FALSE)\"\nRange(\"E2\").AutoFill Destination:=Range(\"E2:E\" + CStr(intCurrentRow)), Type:=xlFillDefault\nRange(\"L2\").AutoFill Destination:=Range(\"L2:L\" + CStr(intCurrentRow)), Type:=xlFillDefault\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 4567794, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qJB39.jpg?s=128&g=1", "display_name": "half-man-half-spreadsheet", "link": "https://stackoverflow.com/users/4567794/half-man-half-spreadsheet"}, "is_accepted": false, "score": 0, "last_activity_date": 1433295819, "creation_date": 1433295819, "answer_id": 30609459, "question_id": 30466067, "link": "https://stackoverflow.com/questions/30466067/how-to-copy-price-quantity-data-from-one-excel-sheet-to-another-if-the-skus-in/30609459#30609459", "title": "How to copy price + quantity data from one Excel sheet to another if the SKUs in the rows match", "body": "<p>you could use the vlookup function to do this.</p>\n\n<p>A vlookup is a spreadsheet function which looks for a specified value down the leftmost column of a table and when it finds that value, it returns a value from the same row.</p>\n\n<p>We need to tell it what to search for, where to search for it and which column number to return the value from. </p>\n\n<p>A vlookup looks for a value in the leftmost column of a table and then returns a value from the row that the searched for value is found (how far along that row is determined by you).</p>\n\n<p>The vlookup formula consists of 4 parts:</p>\n\n<p>1.SearchFor this is the value that is being searched for. In our dictionary example it would be the word \u201celucidate\u201d.</p>\n\n<p>2.WhereToSearch this is the range in which to search and in which the answer lives. In our example, it would be columns A to C.</p>\n\n<p>3.WhichColumn this is the column in the WhereToSearch range which has the answer in it. In our dictionary example, it would be the third column.</p>\n\n<p>4.NearOrExact you decide whether the vlookup should search for a close value or an exact value (in our dictionary example we would set this to false as we do want it to search for the exact word \u201celucidate\u201d).</p>\n\n<p>Structure of the vlookup formula:</p>\n\n<p>=vlookup ( SearchFor , WhereToSearch , WhichColumn , NearOrExact )</p>\n\n<p><a href=\"http://www.excelvlookuphelp.com\" rel=\"nofollow\">Source: www.excelvlookuphelp.com</a></p>\n"}], "owner": {"reputation": 33, "user_id": 4825328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd948bc1e50542fc894b6a110f93ec53?s=128&d=identicon&r=PG&f=1", "display_name": "samfortunato", "link": "https://stackoverflow.com/users/4825328/samfortunato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1067, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1433295819, "creation_date": 1432664541, "last_edit_date": 1432674223, "question_id": 30466067, "link": "https://stackoverflow.com/questions/30466067/how-to-copy-price-quantity-data-from-one-excel-sheet-to-another-if-the-skus-in", "title": "How to copy price + quantity data from one Excel sheet to another if the SKUs in the rows match", "body": "<p>I have two separate excel files (File1 and File2). Both are sheets containing data for the same products in a store, with price, quantity, and item SKU/ID data, but each file is formatted and arranged differently.</p>\n\n<p>I want Excel to look in File2, compare it to File1, find the \"price\" and \"quantity\" data for a specific SKU that is in both sheets, and copy the \"price\" and \"quantity\" data from File2 to File1.</p>\n\n<p>For example, say I've got a product with the SKU of \"A3210\". This product is listed in both Excel files with the SKU listed in each as well, each in it's own row with the \"price\" and \"quantity\" data. File2 has more accurate price and quantity data, so I want to copy the correct data over to File1, and replace the \"price\" and \"quantity\" data in that row for that specific product/SKU number. But I don't want to overwrite the entire row, just the data from those specific price + quantity cells, because the row has other data that I need.</p>\n\n<ul>\n<li>Screencap of File1 - <a href=\"http://i.imgur.com/Qv4U0lo.jpg\" rel=\"nofollow\">http://i.imgur.com/Qv4U0lo.jpg</a></li>\n<li>Screencap of File2 - <a href=\"http://i.imgur.com/VnRPV0Q.jpg\" rel=\"nofollow\">http://i.imgur.com/VnRPV0Q.jpg</a></li>\n</ul>\n\n<p>Like I said, I want an Excel macro that tells Excel to compare File1 and File2, and replace the Price and Quantity data in File1 with the Price and Quantity data from File 2. The data has to match up properly in accordance with the SKU; the SKU has to be the same from each row.</p>\n\n<p>Any help? VERY limited knowledge in VBA and all that; not sure how to logically do this or program it so I'm coming here. Thanks in advance everyone...</p>\n\n<p>EDIT: Recorded macro of me adding formula:</p>\n\n<pre><code>Sub stackoverflow_reverb_formula_input()\n'\n' stackoverflow_reverb_formula_input Macro\n'\n\n'\n    ActiveCell.FormulaR1C1 = _\n        \"=VLOOKUP(RC[1],[invexpa.xlsx]Sheet1!R2433C5:R2433C20,8,FALSE)\"\n    Range(\"L2\").Select\n    ActiveCell.FormulaR1C1 = _\n        \"=VLOOKUP(RC[-6],[invexpa.xlsx]Sheet1!R2433C5:R2433C20,16,FALSE)\"\n    Range(\"E2\").Select\n    Selection.AutoFill Destination:=Range(\"E2:E547\"), Type:=xlFillDefault\n    Range(\"E2:E547\").Select\n    Range(\"L2\").Select\n    Selection.AutoFill Destination:=Range(\"L2:L547\"), Type:=xlFillDefault\n    Range(\"L2:L547\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1432666098, "post_id": 30466045, "comment_id": 49013526, "body": "This looked intriguiing and a quick search for <i>VBA network owner</i> produced <a href=\"https://groups.google.com/forum/#!topic/microsoft.public.excel.programming/saSZ1ylixr4\" rel=\"nofollow noreferrer\">File owner attributes through Excel VBA</a> which seems to work well. I&#39;m just posting a link as any answer would seem to plagiarize on some level."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432666234, "post_id": 30466045, "comment_id": 49013614, "body": "<a href=\"http://superuser.com/questions/845084/how-to-get-excel-to-show-username-of-person-that-has-file-open\" title=\"how to get excel to show username of person that has file open\">superuser.com/questions/845084/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 1, "last_activity_date": 1500220362, "last_edit_date": 1500220362, "creation_date": 1432695735, "answer_id": 30472412, "question_id": 30466045, "link": "https://stackoverflow.com/questions/30466045/vba-username-of-open-workbook-read-only/30472412#30472412", "title": "VBA - Username of open workbook (read only)", "body": "<p>This should probably be a comment but my reputation is too low</p>\n\n<p>I've seen this but never needed the info...</p>\n\n<p>Things to try:</p>\n\n<ul>\n<li>ThisWorkbook.UserStatus - array with all current users for the file open as exclusive or shared</li>\n<li>Environ(\"USERNAME\")</li>\n<li>CreateObject(\"WScript.NetWork\").UserName</li>\n<li>API calls:</li>\n</ul>\n\n<p>.</p>\n\n<pre><code>Declare Function WNetGetUser Lib \"mpr.dll\" Alias \"WNetGetUserA\"\n( _\n    ByVal lpName As String, _\n    ByVal lpUserName As String, _\n    lpnLength As Long\n) As Long\n\nDeclare Function GetUserName&amp; Lib \"advapi32.dll\" Alias \"GetUserNameA\" _ \n(ByVal lpBuffer As String, nSize As Long)\n</code></pre>\n\n<p>.</p>\n\n<p>more details about these APIs:</p>\n\n<ul>\n<li><a href=\"https://support.microsoft.com/en-us/kb/161394\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/kb/161394</a></li>\n<li><a href=\"http://www.vbaexpress.com/kb/getarticle.php?kb_id=768\" rel=\"nofollow noreferrer\">http://www.vbaexpress.com/kb/getarticle.php?kb_id=768</a></li>\n</ul>\n\n<hr>\n\n<ul>\n<li>WMI <a href=\"https://msdn.microsoft.com/en-us/library/aa394220(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Win32_NetworkConnection</a>:</li>\n</ul>\n\n<hr>\n\n<pre><code>Public Function GetActiveUser(Optional ByVal computer As String = \".\") As String\n    Dim wmi As Object, itm As String\n\n    On Error Resume Next\n    Set wmi = GetObject(\"winmgmts:\\\\\" &amp; computer &amp; \"\\Root\\CIMv2\")\n    itm = wmi.ExecQuery(\"Select UserName from Win32_NetworkConnection\", , 48)\n    GetNetActiveUser = itm\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 273, "user_id": 3512530, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c40f173cb8f935778e156188466477e7?s=128&d=identicon&r=PG&f=1", "display_name": "Elixir", "link": "https://stackoverflow.com/users/3512530/elixir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1384, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1500220362, "creation_date": 1432664462, "last_edit_date": 1531164843, "question_id": 30466045, "link": "https://stackoverflow.com/questions/30466045/vba-username-of-open-workbook-read-only", "title": "VBA - Username of open workbook (read only)", "body": "<p>If an open workbook (located on a server) is in read only mode, how can I display the active username using VBA?  </p>\n\n<p>I've looked into <code>.WriteReservedBy</code> but this only shows the name of the person that last saved the file with a password.</p>\n"}]