[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1340, "user_id": 2057853, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ab9f003cd362923c6568fdf350c01a44?s=128&d=identicon&r=PG&f=1", "display_name": "BRBT", "link": "https://stackoverflow.com/users/2057853/brbt"}, "edited": false, "score": 0, "creation_date": 1428535199, "post_id": 29526972, "comment_id": 47208311, "body": "First thing I googled has your answer... <a href=\"http://www.mrexcel.com/forum/excel-questions/292819-average-range-cells-visual-basic-applications.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4760562, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-A1a2m75oFHw/AAAAAAAAAAI/AAAAAAAADAg/mjCM-yuADFk/photo.jpg?sz=128", "display_name": "primoz ogrinec", "link": "https://stackoverflow.com/users/4760562/primoz-ogrinec"}, "is_accepted": false, "score": 0, "last_activity_date": 1428535526, "creation_date": 1428535526, "answer_id": 29527073, "question_id": 29526972, "link": "https://stackoverflow.com/questions/29526972/finding-average-of-selection-and-then-assigning-it-to-a-cell/29527073#29527073", "title": "Finding average of selection and then assigning it to a cell", "body": "<p>Have you tried using the Sum worksheet function for calculating the sum of the range?</p>\n\n<p>Xsum = WorksheetFunction.Sum(arrayX) </p>\n\n<p>and dividing the Xsum value with the length of the array?</p>\n"}, {"tags": [], "owner": {"reputation": 1811, "user_id": 4347950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/33c2cda3907b3f3014aee555819a8d68?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Dannemann", "link": "https://stackoverflow.com/users/4347950/joshua-dannemann"}, "is_accepted": false, "score": 0, "last_activity_date": 1428538603, "creation_date": 1428538603, "answer_id": 29527551, "question_id": 29526972, "link": "https://stackoverflow.com/questions/29526972/finding-average-of-selection-and-then-assigning-it-to-a-cell/29527551#29527551", "title": "Finding average of selection and then assigning it to a cell", "body": "<p>One thing I should metion is that you do not need to select the range to work with it. You can use it directly and doing so will also improve how fast your code runs.</p>\n\n<p>To insert your worksheet functions, use the Range.Address function to generate a cell reference to put into the formulas.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff837625.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff837625.aspx</a></p>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 3577213, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SyBNE.jpg?s=128&g=1", "display_name": "Michele", "link": "https://stackoverflow.com/users/3577213/michele"}, "is_accepted": true, "score": 1, "last_activity_date": 1428539412, "last_edit_date": 1428539412, "creation_date": 1428538910, "answer_id": 29527599, "question_id": 29526972, "link": "https://stackoverflow.com/questions/29526972/finding-average-of-selection-and-then-assigning-it-to-a-cell/29527599#29527599", "title": "Finding average of selection and then assigning it to a cell", "body": "<p>You can calculate the average of a selection in this way:</p>\n\n<pre><code>Application.WorksheetFunction.Average(\"Here you put your range\")\n</code></pre>\n\n<p>The result is a value and not an object, so you should use a variable. Taking names from your case you should use it like this:</p>\n\n<pre><code>SelAvgResult = Application.WorksheetFunction.Average(InQuestion)\n</code></pre>\n\n<p>I put another name for the variable, but you may still use SelAvg if you like. Just remind to define it as a variable (you may choose your desired format depending on the data size) instead of object if you do not need it anymore.</p>\n\n<p>You may use then this variable for setting the value of your desired cell.</p>\n\n<p>I have a last note: your code seems to replicate the already existing formula AVERAGEIF. If your criteria column is for instance column A and value you should use for calculating the average are in column C, You could directly set the value of the cell where you want the average like this:</p>\n\n<pre><code>=AVERAGEIF(A:A, \"2000\", C:C)\n</code></pre>\n\n<p>In this case you would avoid VBA.</p>\n"}], "owner": {"reputation": 3, "user_id": 4765598, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204877611914143/picture?type=large", "display_name": "CWHz", "link": "https://stackoverflow.com/users/4765598/cwhz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4185, "favorite_count": 0, "accepted_answer_id": 29527599, "answer_count": 3, "score": 0, "last_activity_date": 1428602954, "creation_date": 1428535010, "last_edit_date": 1428602954, "question_id": 29526972, "link": "https://stackoverflow.com/questions/29526972/finding-average-of-selection-and-then-assigning-it-to-a-cell", "title": "Finding average of selection and then assigning it to a cell", "body": "<p>I am attempting to create some dynamic code that, at this point, will select a bunch of cells, move the selection over two columns, then find the average of that selection and send that value to a cell. This is what I have so far, I am getting stuck at averaging the selection I've made:</p>\n\n<pre><code>Sub StatMakersub(Rng1 As Range)\n\n    Dim MyRange As Range\n    Dim Cell As Object\n    Dim InQuestion As Range\n    Dim SelAvg As Object\n\n     'Check every cell in the range for matching criteria.\n    For Each Cell In Rng1\n        If Cell.Value = 2000 Then\n            If MyRange Is Nothing Then\n                Set MyRange = Range(Cell.Address)\n            Else\n                Set MyRange = Union(MyRange, Range(Cell.Address))\n            End If\n        End If\n    Next\n     'Select the new range of only matching criteria\nMyRange.Select\nSelection.Offset(0, 2).Select\nSet InQuestion = Selection\nRange(\"P2\").Formula = \"=Average(Selection)\"\nRange(\"Q2\").Formula = \"=STDDEVA(Selection)\"\n\nEnd Sub\n</code></pre>\n\n<p>I can't find much on the web about how to average range variables.</p>\n"}, {"tags": ["csv", "ms-access", "vba", "export-to-csv"], "answers": [{"tags": [], "owner": {"reputation": 76, "user_id": 3660722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/866cd82c83a4dc44c4be0d90e8f8e3d3?s=128&d=identicon&r=PG&f=1", "display_name": "chroni", "link": "https://stackoverflow.com/users/3660722/chroni"}, "is_accepted": false, "score": 0, "last_activity_date": 1428566426, "creation_date": 1428566426, "answer_id": 29532985, "question_id": 29526665, "link": "https://stackoverflow.com/questions/29526665/access-2007-docmd-transfertext-acexportdelim-currency/29532985#29532985", "title": "Access 2007 DoCmd.TransferText acExportDelim Currency", "body": "<p>sorry but i ve not enough rep points to comment but if you have formatting issues i would recommend to export a query and not the table directly. You can format the fields in the query, maybe even as text. Maybe there is a better way to solve the problem with formatting but that' s the way i do it.</p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 4766365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b701a46da183d83282ba5ba2fe4f1f8?s=128&d=identicon&r=PG&f=1", "display_name": "Julie Jacob", "link": "https://stackoverflow.com/users/4766365/julie-jacob"}, "is_accepted": false, "score": 0, "last_activity_date": 1428594379, "creation_date": 1428594379, "answer_id": 29543147, "question_id": 29526665, "link": "https://stackoverflow.com/questions/29526665/access-2007-docmd-transfertext-acexportdelim-currency/29543147#29543147", "title": "Access 2007 DoCmd.TransferText acExportDelim Currency", "body": "<p>I did end up finding my own answer.  Thanks Chroni, I did check into exporting as a query.</p>\n\n<p>My answer was to requery the table and use the format FUNCTION (not property) and set it to a \"Fixed\" format.</p>\n\n<p>Works like a charm now and even running thru my macro.</p>\n"}], "owner": {"reputation": 3, "user_id": 4766365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b701a46da183d83282ba5ba2fe4f1f8?s=128&d=identicon&r=PG&f=1", "display_name": "Julie Jacob", "link": "https://stackoverflow.com/users/4766365/julie-jacob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 356, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594645019, "creation_date": 1428533362, "last_edit_date": 1594645019, "question_id": 29526665, "link": "https://stackoverflow.com/questions/29526665/access-2007-docmd-transfertext-acexportdelim-currency", "title": "Access 2007 DoCmd.TransferText acExportDelim Currency", "body": "<p>In Access 2007 I am using the DoCmd.TransferText acExportDelim to export a table as a .csv file type to a specific location on our network.  The transfer itself seems to be working ok and my table that is being transferred is in the correct format with two places after the decimal, even if zero cents.  However, on the Export Specifications I see no column for field types and the resulting .csv file has stripped the trailing zeros that were present in the starting table.</p>\n\n<p>Is there a VBA that I can insert into my (Public Function tsfrPR() DoCmd.TransferText acExportDelim, \"exportspecs\", \"table\", \"\\network\\location\\filename.csv\", False End Function) to retain this formatting in the original table?  Thanks!</p>\n\n<p>Have pictures of what these screens look like, but need 10 rep to post, lol</p>\n"}, {"tags": ["regex", "excel", "vba", "date"], "comments": [{"owner": {"reputation": 12977, "user_id": 4453262, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b98c905b863b482c3d1d6616d3482b54?s=128&d=identicon&r=PG&f=1", "display_name": "karthik manchala", "link": "https://stackoverflow.com/users/4453262/karthik-manchala"}, "edited": false, "score": 0, "creation_date": 1428533504, "post_id": 29526621, "comment_id": 47207785, "body": "What is the error? and it would be helpful if you post expected output and inputs."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1428537407, "post_id": 29526621, "comment_id": 47208980, "body": "An excellent thread for validating date formats with regex was discussed in <a href=\"http://stackoverflow.com/questions/15491894/regex-to-validate-date-format-dd-mm-yyyy\">Regex to validate date format dd/mm/yyyy</a>"}, {"owner": {"reputation": 105, "user_id": 4721081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10152801627643549/picture?type=large", "display_name": "Mohammad Awni Ali", "link": "https://stackoverflow.com/users/4721081/mohammad-awni-ali"}, "edited": false, "score": 0, "creation_date": 1428562184, "post_id": 29526621, "comment_id": 47216616, "body": "No error but it returns false if the date us 1900/07/07"}, {"owner": {"reputation": 105, "user_id": 4721081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10152801627643549/picture?type=large", "display_name": "Mohammad Awni Ali", "link": "https://stackoverflow.com/users/4721081/mohammad-awni-ali"}, "reply_to_user": {"reputation": 12977, "user_id": 4453262, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b98c905b863b482c3d1d6616d3482b54?s=128&d=identicon&r=PG&f=1", "display_name": "karthik manchala", "link": "https://stackoverflow.com/users/4453262/karthik-manchala"}, "edited": false, "score": 0, "creation_date": 1428624930, "post_id": 29526621, "comment_id": 47253887, "body": "@karthikmanchala the problem is I am looking for Hijri calendars where 1435/02/30 is correct, the regex will accept 1435/2/2 but always refuses 1435/02/02"}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 4721081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10152801627643549/picture?type=large", "display_name": "Mohammad Awni Ali", "link": "https://stackoverflow.com/users/4721081/mohammad-awni-ali"}, "edited": false, "score": 0, "creation_date": 1428624817, "post_id": 29545023, "comment_id": 47253849, "body": "I totally agree with you, but what  I am testing is Hijri dates, where 1435/02/30 is correct date, therefore I wrote the regex, but it will always have a problem that the regex accepts 1435/2/2 but refuses 1435/02/02 and always it will accept 1435/02/02222222"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 105, "user_id": 4721081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10152801627643549/picture?type=large", "display_name": "Mohammad Awni Ali", "link": "https://stackoverflow.com/users/4721081/mohammad-awni-ali"}, "edited": false, "score": 0, "creation_date": 1428678090, "post_id": 29545023, "comment_id": 47279019, "body": "This took some puzzling, but I believe my code edits above give you a working solution. Regex is not the way to go with this type of format checking."}, {"owner": {"reputation": 105, "user_id": 4721081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10152801627643549/picture?type=large", "display_name": "Mohammad Awni Ali", "link": "https://stackoverflow.com/users/4721081/mohammad-awni-ali"}, "edited": false, "score": 0, "creation_date": 1428762354, "post_id": 29545023, "comment_id": 47306282, "body": "thank you very much, the code you wrote is exactly what I am looking for :) you made my day pro"}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 0, "last_activity_date": 1428678049, "last_edit_date": 1428678049, "creation_date": 1428600150, "answer_id": 29545023, "question_id": 29526621, "link": "https://stackoverflow.com/questions/29526621/regular-expression-to-test-date-vba/29545023#29545023", "title": "Regular Expression to Test Date VBA", "body": "<p>The more and more I thought about this (and some research), the more I figured that regex is not the best solution to this format problem. Combining a couple of other ideas (with the <code>ReplaceAndSplit</code> function attributed to the owner), this is what I came up with.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub ttt()\n    Dim dateStr() As String\n    Dim i  As Integer\n    dateStr = Split(\"2012/1/1,2012/01/01,2012/1/01,2012/01/1,1435/2/2,\" &amp; _\n                    \"1435/02/02,1900/07/07,1435/02/02222222,2015/Jan/03\", \",\")\n    For i = 1 To UBound(dateStr)\n        Debug.Print \"trying '\" &amp; dateStr(i) &amp; \"' ... \" &amp; testDate(dateStr(i))\n    Next i\nEnd Sub\n\nFunction testDate(strDateToBeTested As String) As Boolean\n    Dim dateParts() As String\n    Dim y, m, d As Long\n    dateParts = ReplaceAndSplit(strDateToBeTested, \"/.-\")\n    testDate = False\n    If IsNumeric(dateParts(0)) Then\n        y = Int(dateParts(0))\n    Else\n        Exit Function\n    End If\n    If IsNumeric(dateParts(1)) Then\n        m = Int(dateParts(1))\n    Else\n        Exit Function\n    End If\n    If IsNumeric(dateParts(2)) Then\n        d = Int(dateParts(2))\n    Else\n        Exit Function\n    End If\n    If (y &gt;= 1435) And (y &lt; 2020) Then  'change or remove the upper limit as needed\n        If (m &gt;= 1) And (m &lt;= 12) Then\n            If (d &gt;= 1) And (d &lt;= 30) Then\n                testDate = True\n            End If\n        End If\n    End If\nEnd Function\n\n'=======================================================\n'ReplaceAndSplit by alainbryden, optimized by aikimark\n'Uses the native REPLACE() function to replace all delimiters with a common\n'delimiter, and then splits them based on that.\n'=======================================================\nFunction ReplaceAndSplit(ByRef Text As String, ByRef DelimChars As String) As String()\n    Dim DelimLen As Long, Delim As Long\n    Dim strTemp As String, Delim1 As String, Arr() As String, ThisDelim As String\n    strTemp = Text\n    Delim1 = Left$(DelimChars, 1)\n    DelimLen = Len(DelimChars)\n    For Delim = 2 To DelimLen\n        ThisDelim = Mid$(DelimChars, Delim, 1)\n        If InStr(strTemp, ThisDelim) &lt;&gt; 0 Then _\n            strTemp = Replace(strTemp, ThisDelim, Delim1)\n    Next\n    ReplaceAndSplit = Split(strTemp, Delim1)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 4721081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10152801627643549/picture?type=large", "display_name": "Mohammad Awni Ali", "link": "https://stackoverflow.com/users/4721081/mohammad-awni-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 914, "favorite_count": 1, "accepted_answer_id": 29545023, "answer_count": 1, "score": 1, "last_activity_date": 1428678049, "creation_date": 1428533063, "question_id": 29526621, "link": "https://stackoverflow.com/questions/29526621/regular-expression-to-test-date-vba", "title": "Regular Expression to Test Date VBA", "body": "<p>I am looking for a code to test date Format, the date should be in one of these formats\nyear : 13xx - 20xx\nmonth: xx,x\nday: xx,x \nthe hole date would be on of the following\n2012/1/1\n2012/01/01\n2012/1/01\n2012/01/1</p>\n\n<p>I tried the following</p>\n\n<pre><code>    Option Explicit\nSub ttt()\nMsgBox (testDate(\"2012/01/01\"))\n\nEnd Sub\n\nFunction testDate(strDateToBeTested As String) As Boolean\nDim regularExpression, match\nSet regularExpression = CreateObject(\"vbscript.regexp\")\ntestDate = False\n'regularExpression.Pattern = \"(14|13|19|20)[0-9]{2}[- /.]([0-9]{1,2})[- /.]([0-9]{1,2})\"\n'regularExpression.Pattern = \"(\\d\\d\\d\\d)/(\\d|\\d\\d)/(\\d|/dd)\"\nregularExpression.Pattern = \"([0-9]{4}[ /](0[1-9]|[12][0-9]|3[01])[ /](0[1-9]|1[012]))\"\nregularExpression.Global = True\nregularExpression.MultiLine = True\n\nIf regularExpression.Test(strDateToBeTested) Then\n\n'    For Each match In regularExpression.Execute(strDateToBeTested)\n      If Len(strDateToBeTested) &lt; 10 Then\n        testDate = True\n'        Exit For\n      End If\n'End If\nEnd If\nSet regularExpression = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": ["xml", "vba", "dom", "xpath", "xml-parsing"], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "edited": false, "score": 1, "creation_date": 1428534412, "post_id": 29526698, "comment_id": 47208070, "body": "Thanks for your response Mathias :) Unfortunately in VBA, <code>text()</code> is required because it essentially says &#39;hey get the text that&#39;s after /author&#39;. To be specific, the error I get is <b>Run-time error &#39;91&#39;: Object variable or With block variable not set</b>. When I remove that line of code, my program works. I think it has something to do with the syntax, because if I set it to something like <code>Title = Author(i).ParentNode.ParentNode.getAttribute(&quot;id&quot;)</code> it works."}, {"owner": {"reputation": 20027, "user_id": 1987598, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/s3j3n.jpg?s=128&g=1", "display_name": "Mathias M&#252;ller", "link": "https://stackoverflow.com/users/1987598/mathias-m%c3%bcller"}, "reply_to_user": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "edited": false, "score": 1, "creation_date": 1428534776, "post_id": 29526698, "comment_id": 47208187, "body": "@NRH That&#39;s what I am trying to explain. Only the grandparent node of this text node really has an <code>id</code> attribute."}, {"owner": {"reputation": 20027, "user_id": 1987598, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/s3j3n.jpg?s=128&g=1", "display_name": "Mathias M&#252;ller", "link": "https://stackoverflow.com/users/1987598/mathias-m%c3%bcller"}, "reply_to_user": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "edited": false, "score": 0, "creation_date": 1428535099, "post_id": 29526698, "comment_id": 47208283, "body": "@NRH Also, why would <code>text()</code> be required in VBA?"}, {"owner": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "edited": false, "score": 0, "creation_date": 1428536208, "post_id": 29526698, "comment_id": 47208597, "body": "Hi Mathias - that&#39;s what I&#39;ve learned from my readings online; I might be wrong though because I&#39;m still really new to this. I did try your recommendation, it gives a <b>Run-time error &#39;94&#39; Invalid use of Null</b> on the line <code>athr = Author(i).NodeValue</code>"}, {"owner": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "edited": false, "score": 0, "creation_date": 1428536814, "post_id": 29526698, "comment_id": 47208786, "body": "What if we use something like NextSibling/PreviousSibling? Do you think that can work in a loop if there were several more books too?"}, {"owner": {"reputation": 20027, "user_id": 1987598, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/s3j3n.jpg?s=128&g=1", "display_name": "Mathias M&#252;ller", "link": "https://stackoverflow.com/users/1987598/mathias-m%c3%bcller"}, "reply_to_user": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "edited": false, "score": 1, "creation_date": 1428582212, "post_id": 29526698, "comment_id": 47228775, "body": "@NRH No, iterating through a set of wanted nodes with searching for next siblings is always discouraged. Please see my edit - I now tested this myself. Absolutely unfamiliar with VBA, most of it is simply trial and error."}, {"owner": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "edited": false, "score": 0, "creation_date": 1428589081, "post_id": 29526698, "comment_id": 47233943, "body": "Thank you, that worked! I&#39;m very new to programming and XML parsing, so I hope you don&#39;t mind but can you please explain what <b>Item(0)</b> is doing in this line <code>Title = Author(i).ParentNode.getElementsByTagName(&quot;title&quot;).Item(0).n&zwnj;&#8203;odeTypedValue</code>? Is it pretty much just getting the entire text block within that node starting from the first character (or 0 position)? Also, is there ever a need for using <code>&#47;text()</code> within the XPath to the node (it doesn&#39;t seem to affect numbers or anything either)? I&#39;ve been doing this for all my previous work so I feel silly now.. thanks again!! :)"}], "tags": [], "owner": {"reputation": 20027, "user_id": 1987598, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/s3j3n.jpg?s=128&g=1", "display_name": "Mathias M&#252;ller", "link": "https://stackoverflow.com/users/1987598/mathias-m%c3%bcller"}, "is_accepted": true, "score": 3, "last_activity_date": 1428594442, "last_edit_date": 1428594442, "creation_date": 1428533531, "answer_id": 29526698, "question_id": 29526531, "link": "https://stackoverflow.com/questions/29526531/vba-dom-parentnode-selectsinglenode/29526698#29526698", "title": "VBA DOM ParentNode SelectSingleNode", "body": "<p>Not familiar with VBA, but most likely you are getting an error because this line</p>\n\n<pre><code>Set Author = XMLFile.SelectNodes(\"/catalog/book/author/text()\")\n</code></pre>\n\n<p>sets an <code>Author</code> variable (?) to a <em>string</em> value, <code>text()</code> means the concatenation of all text nodes that are immediate children of the context element. Strings are very different from elements, they do not have attributes, or child elements.</p>\n\n<p>They <em>do</em> have a parent node, but</p>\n\n<pre><code>BookType = Author(i).ParentNode.getAttribute(\"id\")\n</code></pre>\n\n<p>will try to retrieve the <code>id</code> attribute of the parent of such a text node, which is an <code>author</code> element - but <code>author</code> elements do not have an <code>id</code> attribute.</p>\n\n<p>Change</p>\n\n<pre><code>Set Author = XMLFile.SelectNodes(\"/catalog/book/author/text()\")\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Set Author = XMLFile.SelectNodes(\"/catalog/book/author\")\n</code></pre>\n\n<p>and let me know if that helps.</p>\n\n<hr>\n\n<p><strong>EDIT</strong>: I think I found a working solution, how about the following. However, I am absolutely unfamiliar with VBA - I'm sure this is not a very elegant solution and could be improved a lot.</p>\n\n<pre><code>Sub mySub()\n\nDim XMLFile As MSXML2.DOMDocument\nDim Author As Variant\nDim athr As String, BookType As String, Title As String\nDim AuthorArray() As String, BookTypeArray() As String, TitleArray() As String\nDim i As Long, x As Long, j As Long\n\nDim mainWorkBook As Workbook\nDim n As IXMLDOMNode\nSet mainWorkBook = ActiveWorkbook\nSet XMLFile = CreateObject(\"Microsoft.XMLDOM\")\nXMLFile.Load (\"vba.xml\")\n\n\nx = 1\nj = 0\n\nSet Author = XMLFile.SelectNodes(\"/catalog/book/author\")\nFor i = 0 To (Author.Length - 1)\n    ReDim Preserve AuthorArray(0 To i)\n    ReDim Preserve BookTypeArray(0 To i)\n    ReDim Preserve TitleArray(0 To i)\n    athr = Author(i).Text\n    BookType = Author(i).ParentNode.getAttribute(\"id\")\n    Title = Author(i).ParentNode.getElementsByTagName(\"title\").Item(0).nodeTypedValue\n\n    If athr = \"Ralls, Kim\" Then\n\n        AuthorArray(j) = athr\n        BookTypeArray(j) = BookType\n        TitleArray(j) = Title\n\n        j = j + 1\n        x = x + 1\n    End If\nNext\n\n\n\nRange(\"A3:A\" &amp; UBound(AuthorArray) + 1) = WorksheetFunction.Transpose(AuthorArray)\nRange(\"B3:B\" &amp; UBound(BookTypeArray) + 1) = WorksheetFunction.Transpose(BookTypeArray)\nRange(\"C3:C\" &amp; UBound(BookTypeArray) + 1) = WorksheetFunction.Transpose(TitleArray)\n\n\nEnd Sub\n</code></pre>\n\n<p><strong>Result</strong></p>\n\n<pre><code>Ralls, Kim  Adventure   Midnight Rain\nRalls, Kim  Mystery     Some Mystery Book\n</code></pre>\n\n<hr>\n\n<p><strong>2nd EDIT</strong></p>\n\n<blockquote>\n  <p>can you please explain what Item(0) is doing in this line <code>Title = Author(i).ParentNode.getElementsByTagName(\"title\").Item(0).nodeTypedValue</code>?</p>\n</blockquote>\n\n<p><code>getElementsByTagName()</code> returns a <em>collection</em> of elements, even if there is one one result - it would end up in a collection with just one item. <code>Item(0)</code> selects the first element in this collection.</p>\n\n<p>Then, <a href=\"https://msdn.microsoft.com/en-us/library/ms762308%28v=vs.85%29.aspx\" rel=\"nofollow\"><code>nodeTypedValue</code></a> returns the value of an object, depending on its data type. By the way, the <code>NodeValue</code> property <a href=\"https://msdn.microsoft.com/en-us/library/office/aa213915%28v=office.11%29.aspx\" rel=\"nofollow\">only works on attributes</a> - that's why your code returned an error.</p>\n\n<blockquote>\n  <p>Also, is there ever a need for using /text() within the XPath to the node (it doesn't seem to affect numbers or anything either)?</p>\n</blockquote>\n\n<p>(Finally something I'm comfortable with! I think you would profit from an introduction or tutorial to XPath.)</p>\n\n<p><code>text()</code> <em>is</em> a highly overused construct, but yes, there are uses for it. Think about it that way: When XML is read into memory, a tree-like representation is constructed. In this representation, all kinds of objects are nodes; elements are nodes, attributes are nodes - and text content is a node.</p>\n\n<p>Now, an XPath expression like</p>\n\n<pre><code>/catalog/book/author\n</code></pre>\n\n<p>selects an <em>element node</em> (or, possibly, a set of element nodes). In your case, it is an element node that has a text node as its child. Extending the path expression to</p>\n\n<pre><code>/catalog/book/author/text()\n</code></pre>\n\n<p>selects <em>only</em> the child text nodes of <code>author</code> elements. It's important to understand that an element and its text content are not the same.</p>\n"}], "owner": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3810, "favorite_count": 1, "accepted_answer_id": 29526698, "answer_count": 1, "score": 0, "last_activity_date": 1428594442, "creation_date": 1428532520, "last_edit_date": 1428534285, "question_id": 29526531, "link": "https://stackoverflow.com/questions/29526531/vba-dom-parentnode-selectsinglenode", "title": "VBA DOM ParentNode SelectSingleNode", "body": "<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;catalog&gt;\n&lt;book id=\"Adventure\"&gt;\n   &lt;author&gt;Gambardella, Matthew&lt;/author&gt;\n   &lt;title&gt;XML Developer's Guide&lt;/title&gt;\n   &lt;price&gt;44.95&lt;/price&gt;\n&lt;/book&gt;\n&lt;book id=\"Adventure\"&gt;\n   &lt;author&gt;Ralls, Kim&lt;/author&gt;\n   &lt;title&gt;Midnight Rain&lt;/title&gt;\n   &lt;price&gt;5.95&lt;/price&gt;\n&lt;/book&gt;\n&lt;book id=\"Adventure\"&gt;\n   &lt;author&gt;Boal, John&lt;/author&gt;\n   &lt;title&gt;Mist&lt;/title&gt;\n   &lt;price&gt;15.95&lt;/price&gt;\n&lt;/book&gt;\n&lt;book id=\"Mystery\"&gt;\n   &lt;author&gt;Ralls, Kim&lt;/author&gt;\n   &lt;title&gt;Some Mystery Book&lt;/title&gt;\n   &lt;price&gt;9.95&lt;/price&gt;\n&lt;/book&gt;\n&lt;/catalog&gt;\n</code></pre>\n\n<p>My program searches for all items by a specific author (\"Ralls, Kim\"), and at the same time gathers the BookType (\"book id\") and throws the values into an array. </p>\n\n<p>The issue now though is that the book id's aren't always going to be the same. So since I've already established what the parent node is, I want to pull out the BookTitle - this way I don't have to put a variable in the XPATH that is already stored in an array (that sounds like a nightmare to me).</p>\n\n<pre><code>Sub mySub()\n\nDim XMLFile As Variant\nDim Author As Variant\nDim athr As String, BookType As String, Title As String\nDim AuthorArray() As String, BookTypeArray() As String, TitleArray() As  String\nDim i As Long, x As Long, j As Long\n\nDim mainWorkBook As Workbook\nDim n As IXMLDOMNode\nSet mainWorkBook = ActiveWorkbook\nSet XMLFile = CreateObject(\"Microsoft.XMLDOM\")\nXMLFile.Load (\"C:\\Books.xml\")\n\n\nx = 1\nj = 0\n\nSet Author = XMLFile.SelectNodes(\"/catalog/book/author/text()\")\nFor i = 0 To (Author.Length - 1)\n    ReDim Preserve AuthorArray(0 To i)\n    ReDim Preserve BookTypeArray(0 To i)\n    ReDim Preserve TitleArray(0 To i)\n    athr = Author(i).NodeValue\n    BookType = Author(i).ParentNode.ParentNode.getAttribute(\"id\")\n    Title = Author(i).ParentNode.SelectSingleNode(\"title\")\n\n    If athr = \"Ralls, Kim\" Then\n\n        AuthorArray(j) = athr\n        BookTypeArray(j) = BookType\n        TitleArray(j) = Title\n\n        j = j + 1\n        x = x + 1\n    End If\nNext\n\n\n\nRange(\"A3:A\" &amp; UBound(AuthorArray) + 1) = WorksheetFunction.Transpose(AuthorArray)\nRange(\"B3:B\" &amp; UBound(BookTypeArray) + 1) = WorksheetFunction.Transpose(BookTypeArray)\nRange(\"C3:C\" &amp; UBound(BookTypeArray) + 1) = WorksheetFunction.Transpose(TitleArray)\n\n\nEnd Sub\n</code></pre>\n\n<p>I keep getting an object error on this line of code and I don't understand why:</p>\n\n<pre><code>Title = Author(i).ParentNode.SelectSingleNode(\"title\")\n</code></pre>\n\n<p>Thanks for any help and suggestions.</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 5825, "user_id": 4512948, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/smfCE.png?s=128&g=1", "display_name": "matrixanomaly", "link": "https://stackoverflow.com/users/4512948/matrixanomaly"}, "edited": false, "score": 0, "creation_date": 1428531404, "post_id": 29526221, "comment_id": 47207047, "body": "when you say sized 1 to X and move to an array of size 0 to x-1, do you mean an array of one slot smaller (removing the first/last thing) or same sized slot (also removing the first/last thing)?"}], "answers": [{"comments": [{"owner": {"reputation": 427, "user_id": 2423419, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/dd6441eee534336bcb99ee162c5bb783?s=128&d=identicon&r=PG", "display_name": "Peter F", "link": "https://stackoverflow.com/users/2423419/peter-f"}, "edited": false, "score": 0, "creation_date": 1428531770, "post_id": 29526333, "comment_id": 47207190, "body": "The source array is normally 0 to x... in this method I am creating an array from a collection with toArray, which automatically makes the dimensions 1 to x.."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 427, "user_id": 2423419, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/dd6441eee534336bcb99ee162c5bb783?s=128&d=identicon&r=PG", "display_name": "Peter F", "link": "https://stackoverflow.com/users/2423419/peter-f"}, "edited": false, "score": 1, "creation_date": 1428532823, "post_id": 29526333, "comment_id": 47207581, "body": "Does that still happen if you explicitly declare <code>Option Base 0</code> at the top of the module?"}, {"owner": {"reputation": 427, "user_id": 2423419, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/dd6441eee534336bcb99ee162c5bb783?s=128&d=identicon&r=PG", "display_name": "Peter F", "link": "https://stackoverflow.com/users/2423419/peter-f"}, "edited": false, "score": 0, "creation_date": 1428553059, "post_id": 29526333, "comment_id": 47213086, "body": "Interesting... I will have to try that out. I didn&#39;t know it was a thing."}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 1, "last_activity_date": 1428532983, "last_edit_date": 1428532983, "creation_date": 1428531463, "answer_id": 29526333, "question_id": 29526221, "link": "https://stackoverflow.com/questions/29526221/shift-array-down-by-one-in-vba/29526333#29526333", "title": "Shift array down by one in vba", "body": "<p>You can pass arrays of most types as a <code>Variant</code> between methods and procedures in VBA</p>\n\n<pre><code>Private Function ShiftDownArray(ByRef theArray As Variant) As Variant\n\n    Dim i As Integer\n    ReDim x(0 To UBound(theArray) - 1) As Variant\n\n    For i = 0 To UBound(x)\n        x(i) = theArray(i + 1)\n    Next i\n\n    ShiftDownArray = x\n\nEnd Function\n</code></pre>\n\n<p>But more importantly - why would you want to do this anyway? You can just -/+ 1 to the index in the original array?</p>\n"}, {"tags": [], "owner": {"reputation": 5825, "user_id": 4512948, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/smfCE.png?s=128&g=1", "display_name": "matrixanomaly", "link": "https://stackoverflow.com/users/4512948/matrixanomaly"}, "is_accepted": false, "score": 0, "last_activity_date": 1428531684, "creation_date": 1428531684, "answer_id": 29526382, "question_id": 29526221, "link": "https://stackoverflow.com/questions/29526221/shift-array-down-by-one-in-vba/29526382#29526382", "title": "Shift array down by one in vba", "body": "<p>The Error is most probably in this line: 'ReDim ShiftDownArray(LBound(theArray) - 1 To UBound(theArray) - 1)' </p>\n\n<p>It looks like you're recursively calling itself, which seems odd given there isn't a base case. </p>\n\n<p>See the following example as provided by this <a href=\"http://www.jpsoftwaretech.com/useful-array-functions-for-vba-part-6/\" rel=\"nofollow\">website</a>. The gist of it is that it will skip the first element and copy everything over 'to the left'.</p>\n\n<pre><code>Function Array_Shift(arr As Variant) As Variant\n' http://www.php.net/manual/en/function.array-shift.php\n\n  Dim tempArray As Variant\n  Dim i As Long\n\n  tempArray = arr\n\n  ' shift elements one position up\n  ' by skipping the first element of the source array\n  For i = LBound(tempArray) To UBound(tempArray) - 1\n    tempArray(i) = tempArray(i + 1)\n  Next i\n\n  ' remove last element\n  ' which is now empty\n  ReDim Preserve tempArray(LBound(tempArray) To UBound(tempArray) - 1)\n\n  Array_Shift = tempArray\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "edited": false, "score": 0, "creation_date": 1428533208, "post_id": 29526475, "comment_id": 47207705, "body": "I&#39;m not sure why this isn&#39;t useful, could you please provide some additional feedback? Thanks"}, {"owner": {"reputation": 427, "user_id": 2423419, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/dd6441eee534336bcb99ee162c5bb783?s=128&d=identicon&r=PG", "display_name": "Peter F", "link": "https://stackoverflow.com/users/2423419/peter-f"}, "edited": false, "score": 0, "creation_date": 1428552926, "post_id": 29526475, "comment_id": 47213050, "body": "I didn&#39;t down-vote it, but I am guessing that it is because it is exactly what I have already, and won&#39;t work, either. You can only pass arrays as variants, not strings."}, {"owner": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "reply_to_user": {"reputation": 427, "user_id": 2423419, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/dd6441eee534336bcb99ee162c5bb783?s=128&d=identicon&r=PG", "display_name": "Peter F", "link": "https://stackoverflow.com/users/2423419/peter-f"}, "edited": false, "score": 0, "creation_date": 1428568657, "post_id": 29526475, "comment_id": 47220296, "body": "Thanks, although the problem is not passing an array of strings.  I have updated my post to explain further."}], "tags": [], "owner": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "is_accepted": false, "score": -1, "last_activity_date": 1428570653, "last_edit_date": 1428570653, "creation_date": 1428532221, "answer_id": 29526475, "question_id": 29526221, "link": "https://stackoverflow.com/questions/29526221/shift-array-down-by-one-in-vba/29526475#29526475", "title": "Shift array down by one in vba", "body": "<p>The trouble is not with passing an array of strings as a parameter - you can pass arrays of any type, as far as I'm aware.  However, assigning a value to <code>ShiftDownArray(a - 1)</code> is ambiguous as you could be accessing the a-1th element of the array or passing <code>a - 1</code> as a parameter to the <code>ShiftDownArray()</code> function.</p>\n\n<p>The <code>Function call on left-hand side of assignment must return Variant or Object.</code> error message hints to this.  You are calling the <code>ShiftDownArray()</code> function rather than accessing the array.  The compiler knows you are going to assign something to the value returned by the function (because it is followed by an <code>=</code>) but doesn't know the type as it hasn't yet evaluated <code>theArray(a)</code>.  To ensure that the assignment can complete regardless of the type of <code>theArray(a)</code>, the compiler tries to make sure that <code>ShiftDownArray()</code> returns a <code>Variant</code> or <code>Object</code> to which anything can be assigned.</p>\n\n<p>To avoid this error you can create a temporary array which can be accessed in the conventional manner and assign that array to <code>ShiftDownArray</code> to return from the function.</p>\n\n<p>The following code shows this:</p>\n\n<pre><code>Private Function ShiftDownArray(theArray() As String) As String()\n\n    ReDim tempArray(LBound(theArray) - 1 To UBound(theArray) - 1) As String\n\n    Dim i As Integer\n    For i = LBound(tempArray) To UBound(tempArray)\n        tempArray(i) = theArray(i + 1)\n    Next i\n\n    ShiftDownArray = tempArray\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 427, "user_id": 2423419, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/dd6441eee534336bcb99ee162c5bb783?s=128&d=identicon&r=PG", "display_name": "Peter F", "link": "https://stackoverflow.com/users/2423419/peter-f"}, "edited": false, "score": 0, "creation_date": 1428532775, "post_id": 29526496, "comment_id": 47207570, "body": "This answer actually helped me the most before you edited it. Essentially what it helped me to realize is that although these restrictions on passing arrays are impossible to get around, I can just not use a function. It works just fine if I don&#39;t try to pass it."}], "tags": [], "owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "is_accepted": true, "score": 0, "last_activity_date": 1428532620, "last_edit_date": 1428532620, "creation_date": 1428532315, "answer_id": 29526496, "question_id": 29526221, "link": "https://stackoverflow.com/questions/29526221/shift-array-down-by-one-in-vba/29526496#29526496", "title": "Shift array down by one in vba", "body": "<p>Is this what you are looking for:</p>\n\n<pre><code>Public Sub ShiftArrayTest()\n    'Make an 1-bound array\n    Dim arr1() As String, N As Long, i As Long\n    N = 10\n    ReDim arr1(1 To N)\n    For i = 1 To N\n        arr1(i) = CStr(i)\n    Next i\n\n\n    'Now for the shift\n    Dim arr2() As String\n\n    arr2 = ShiftArray(arr1)\n\nEnd Sub\n\nPublic Function ShiftArray(ByRef theArray() As String) As String()\n    'Now for the shift\n    Dim i1 As Long, N As Long, i As Long, res() As String\n    i1 = LBound(theArray): N = UBound(theArray) - i1 + 1\n    ReDim res(0 To N - 1)\n    For i = 0 To N - 1\n        res(i) = theArray(i1 + i)\n    Next i\n    ShiftArray = res\nEnd Function\n</code></pre>\n\n<p>What I am doing here is taking any array and converting it into a 0-bound array.</p>\n"}], "owner": {"reputation": 427, "user_id": 2423419, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/dd6441eee534336bcb99ee162c5bb783?s=128&d=identicon&r=PG", "display_name": "Peter F", "link": "https://stackoverflow.com/users/2423419/peter-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6183, "favorite_count": 0, "accepted_answer_id": 29526496, "answer_count": 4, "score": 1, "last_activity_date": 1428570653, "creation_date": 1428530784, "question_id": 29526221, "link": "https://stackoverflow.com/questions/29526221/shift-array-down-by-one-in-vba", "title": "Shift array down by one in vba", "body": "<p>I am having some trouble getting a function I have been writing to work properly. I need it to take an array that is sized 1 to x, and transfer it to a new array which is sized 0 to x-1. I would think it would work just like this:</p>\n\n<pre><code>Private Function ShiftDownArray(theArray() As String) As String()\nDim a As Integer\n\n\nReDim ShiftDownArray(LBound(theArray) - 1 To UBound(theArray) - 1)\n\nFor a = LBound(theArray) To UBound(theArray)\n\n    ShiftDownArray(a - 1) = theArray(a)\n\nNext a\n\n\nEnd Function\n</code></pre>\n\n<p>But I get a compile error: Function call on left-hand side of assignment must return Variant or Object. The documentation on this error essentially says delete that line to make it work, which doesn't point me in the right direction. I have tried changing the type to variant, but it starts a chain reaction of needing to change array type from string to variant, and it leads to issues in other parts of my program. </p>\n\n<p>Is there any way to approach this that will allow me to retain the string array type? Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2651, "user_id": 4059942, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/2bmaq.jpg?s=128&g=1", "display_name": "Saagar Elias Jacky", "link": "https://stackoverflow.com/users/4059942/saagar-elias-jacky"}, "edited": false, "score": 0, "creation_date": 1428528990, "post_id": 29525727, "comment_id": 47205912, "body": "You cannot. You need to call the Store procedure again with new values."}, {"owner": {"reputation": 101, "user_id": 4658691, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/924e4142d39acfc5eecb0260d3754a11?s=128&d=identicon&r=PG&f=1", "display_name": "GK1960", "link": "https://stackoverflow.com/users/4658691/gk1960"}, "reply_to_user": {"reputation": 2651, "user_id": 4059942, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/2bmaq.jpg?s=128&g=1", "display_name": "Saagar Elias Jacky", "link": "https://stackoverflow.com/users/4059942/saagar-elias-jacky"}, "edited": false, "score": 0, "creation_date": 1428529688, "post_id": 29525727, "comment_id": 47206260, "body": "hi @ Saagar Elias Jacky, I have just tried but no result displaying. thanks"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 4658691, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/924e4142d39acfc5eecb0260d3754a11?s=128&d=identicon&r=PG&f=1", "display_name": "GK1960", "link": "https://stackoverflow.com/users/4658691/gk1960"}, "edited": false, "score": 0, "creation_date": 1428533450, "post_id": 29526347, "comment_id": 47207775, "body": "Hi @James Toomey, Thanks for the info."}], "tags": [], "owner": {"reputation": 5111, "user_id": 1359088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f4ffb15d50db85cc68143626a8e0046?s=128&d=identicon&r=PG", "display_name": "James Toomey", "link": "https://stackoverflow.com/users/1359088/james-toomey"}, "is_accepted": false, "score": 2, "last_activity_date": 1428531511, "last_edit_date": 1495540612, "creation_date": 1428531511, "answer_id": 29526347, "question_id": 29525727, "link": "https://stackoverflow.com/questions/29525727/how-to-pass-multiple-values-to-stored-procedure-parameter-that-running-from-vba/29526347#29526347", "title": "How to pass multiple values to stored procedure parameter that running from VBA?", "body": "<p>The problem is that the stored procedure only expects one value to be passed, not a series of them. If SQL allowed an IN clause to be passed an array of values like this then you'd be in business:</p>\n\n<pre><code>select * from mytable where id in @parameters\n</code></pre>\n\n<p>But unfortunately it doesn't so that won't work. You could just eliminate the stored procedure and just cobble together a SQL string, which is a SQL injection risk, but if your code is only being used in-house then that won't be as big of a worry. As alluded to in the comments, if you want to use the SP as-is, then you might just have to run the query multiple times and append your results to a local list/array/recordset/whatever each time you run it. There are other ideas but they're all basically the same in that you're cobbling together a custom SQL string, which is more complex and not really using the SP parameters like they're designed.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/16872056/how-to-pass-string-parameter-with-in-operator-in-stored-procedure-sql-server-2\">How to pass string parameter with `IN` operator in stored procedure SQL Server 2008</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/11354287/sql-in-clause-in-stored-procedure\">SQL IN Clause In Stored Procedure</a></p>\n"}], "owner": {"reputation": 101, "user_id": 4658691, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/924e4142d39acfc5eecb0260d3754a11?s=128&d=identicon&r=PG&f=1", "display_name": "GK1960", "link": "https://stackoverflow.com/users/4658691/gk1960"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1453, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1428531511, "creation_date": 1428528648, "question_id": 29525727, "link": "https://stackoverflow.com/questions/29525727/how-to-pass-multiple-values-to-stored-procedure-parameter-that-running-from-vba", "title": "How to pass multiple values to stored procedure parameter that running from VBA?", "body": "<p>I got situation. I have created VBA that calls SP with 2 parameters. How Can I pass 2 values to each parameter?</p>\n\n<p>below code as ex, passing single value to each parameter:</p>\n\n<pre><code>cmd.Parameters.Append cmd.CreateParameter(\"@Class\", adVarChar, adParamInput, 40)\ncmd.Parameters(\"@Class\").Value = \"H\"\n\n\ncmd.Parameters.Append cmd.CreateParameter(\"@Color\", adVarChar, adParamInput, 40)\ncmd.Parameters(\"@Color\").Value = \"Black\"\n</code></pre>\n\n<p>Now I want to pass \"M\",\"Yellow\" also. How can I achieve this?\nDo I need to do any changes to SP also. Please help.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "excel", "match", "vlookup"], "comments": [{"owner": {"reputation": 2834, "user_id": 3230346, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Nc4ve.png?s=128&g=1", "display_name": "useR", "link": "https://stackoverflow.com/users/3230346/user"}, "edited": false, "score": 0, "creation_date": 1428541062, "post_id": 29525707, "comment_id": 47209920, "body": "so your file name are 1.xls, 2.xls, ..., 22.xls?"}, {"owner": {"reputation": 109, "user_id": 4363180, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-sQVzVmv0FNE/AAAAAAAAAAI/AAAAAAAAAPg/d8yd3aGERaI/photo.jpg?sz=128", "display_name": "Maxwell", "link": "https://stackoverflow.com/users/4363180/maxwell"}, "reply_to_user": {"reputation": 2834, "user_id": 3230346, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Nc4ve.png?s=128&g=1", "display_name": "useR", "link": "https://stackoverflow.com/users/3230346/user"}, "edited": false, "score": 0, "creation_date": 1428542623, "post_id": 29525707, "comment_id": 47210387, "body": "Yes :)Those are the names"}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 4363180, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-sQVzVmv0FNE/AAAAAAAAAAI/AAAAAAAAAPg/d8yd3aGERaI/photo.jpg?sz=128", "display_name": "Maxwell", "link": "https://stackoverflow.com/users/4363180/maxwell"}, "edited": false, "score": 0, "creation_date": 1428542310, "post_id": 29527995, "comment_id": 47210292, "body": "So the formula would be ActiveCell.Formula = &quot;=IFERROR(VLOOKUP($I$6,&#39;[&amp; file &amp; &quot;.xls]Sheet1&#39;!$B$4:$V$27,MATCH($F$26,&#39;[&amp; file &amp; &quot;.xls]Sheet1&#39;!$B$3:$V$27,0),FALSE),0)&quot; ? ?? ? ?"}, {"owner": {"reputation": 415, "user_id": 1228741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5908d95b7b98be56735ea0f4b67f6244?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Chad", "link": "https://stackoverflow.com/users/1228741/michael-chad"}, "reply_to_user": {"reputation": 109, "user_id": 4363180, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-sQVzVmv0FNE/AAAAAAAAAAI/AAAAAAAAAPg/d8yd3aGERaI/photo.jpg?sz=128", "display_name": "Maxwell", "link": "https://stackoverflow.com/users/4363180/maxwell"}, "edited": false, "score": 0, "creation_date": 1428544742, "post_id": 29527995, "comment_id": 47210993, "body": "Close, looks like you&#39;re missing a few quotes.  Try this.   <code>&quot;=IFERROR(VLOOKUP($I$6,&#39;[&quot; &amp;  file &amp; &quot;.xls]Sheet1&#39;!$B$4:$V$27,MATCH($F$26,&#39;[&quot; &amp; file &amp; &quot;.xls]Sheet1&#39;!$B$3:$V$27,0),FALSE),0)&quot;</code>"}, {"owner": {"reputation": 109, "user_id": 4363180, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-sQVzVmv0FNE/AAAAAAAAAAI/AAAAAAAAAPg/d8yd3aGERaI/photo.jpg?sz=128", "display_name": "Maxwell", "link": "https://stackoverflow.com/users/4363180/maxwell"}, "edited": false, "score": 0, "creation_date": 1428544956, "post_id": 29527995, "comment_id": 47211056, "body": "Yes it worked! Thank you so much I got another question"}, {"owner": {"reputation": 109, "user_id": 4363180, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-sQVzVmv0FNE/AAAAAAAAAAI/AAAAAAAAAPg/d8yd3aGERaI/photo.jpg?sz=128", "display_name": "Maxwell", "link": "https://stackoverflow.com/users/4363180/maxwell"}, "edited": false, "score": 0, "creation_date": 1428545098, "post_id": 29527995, "comment_id": 47211095, "body": "I have all the 22 files open haha but I want to use the same method Windows(&quot; &quot; &amp; file &amp; &quot;.xls&quot;).Activate     ActiveWorkbook.Save     ActiveWindow.Close But excel is not compiling, you know if it has to do with the Windows.Activate method or my code is wrong?"}, {"owner": {"reputation": 415, "user_id": 1228741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5908d95b7b98be56735ea0f4b67f6244?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Chad", "link": "https://stackoverflow.com/users/1228741/michael-chad"}, "reply_to_user": {"reputation": 109, "user_id": 4363180, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-sQVzVmv0FNE/AAAAAAAAAAI/AAAAAAAAAPg/d8yd3aGERaI/photo.jpg?sz=128", "display_name": "Maxwell", "link": "https://stackoverflow.com/users/4363180/maxwell"}, "edited": false, "score": 0, "creation_date": 1428545655, "post_id": 29527995, "comment_id": 47211215, "body": "Yeah, I think there&#39;s a space in front of your file name that way.  You don&#39;t need the first set of quotes or the &amp;.  This should work.  <code>Windows(file &amp; &quot;.xls&quot;).Activate: ActiveWorkbook.Save: ActiveWindow.Close</code>"}], "tags": [], "owner": {"reputation": 415, "user_id": 1228741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5908d95b7b98be56735ea0f4b67f6244?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Chad", "link": "https://stackoverflow.com/users/1228741/michael-chad"}, "is_accepted": true, "score": 0, "last_activity_date": 1428541648, "creation_date": 1428541648, "answer_id": 29527995, "question_id": 29525707, "link": "https://stackoverflow.com/questions/29525707/vlookup-range-with-a-defined-variable/29527995#29527995", "title": "Vlookup range with a defined variable", "body": "<p>Nice tidy little loop!  OK, I think I have an idea what you're trying to do here.  You want to have the <code>[file.xls]</code> in your formula update dynamically for each iteration of the loop.  Since you're using the <code>formula</code> property, which takes a string, you can concatenate your stored <code>file</code> value right into it.</p>\n\n<p>This should do the trick.</p>\n\n<pre><code>ActiveCell.Formula = \"=IFERROR(VLOOKUP($I$6,'[\" &amp; file &amp; \".xls]Sheet1'!$B$4:$V$27,MATCH($F$26,'[\" &amp; file &amp; \".xls]Sheet1'!$B$3:$V$27,0),FALSE),0)\"\n</code></pre>\n\n<p>Hope I understood properly, if not, we'll go another round!</p>\n"}], "owner": {"reputation": 109, "user_id": 4363180, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-sQVzVmv0FNE/AAAAAAAAAAI/AAAAAAAAAPg/d8yd3aGERaI/photo.jpg?sz=128", "display_name": "Maxwell", "link": "https://stackoverflow.com/users/4363180/maxwell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 29527995, "answer_count": 1, "score": 0, "last_activity_date": 1428541648, "creation_date": 1428528589, "question_id": 29525707, "link": "https://stackoverflow.com/questions/29525707/vlookup-range-with-a-defined-variable", "title": "Vlookup range with a defined variable", "body": "<p>I'm consolidating data from several excel files, I have 22 files to consolidate; however, I need to specifically look up for a cell value.</p>\n\n<p>In my VBA code I declared a variable called file=int(1) and I'm doing a Loop to open and consolidate each excel file to a consolidated file. All of my excel files are numbered from 1 to 22.</p>\n\n<p>What I want to to is Vlookup, but the range of the Vlookup I want it to have the stored value in file while doing the loop.</p>\n\n<p>For example</p>\n\n<pre><code>file = Int(1)\nDo Until file = 22\n\n ActiveCell.Formula = \"=IFERROR(VLOOKUP($I$6,'[file.xls]Sheet1'!$B$4:$V$27,MATCH($F$26,'[file.xls]Sheet1'!$B$3:$V$27,0),FALSE),0)\"\n\nActiveCell.Select\n                Selection.Copy\n                    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n                ActiveCell.Select\n                Selection.Offset(1, 0).Select\n\n                file = file + 1\n</code></pre>\n\n<p>Can you please help me?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 3527381, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3cf2bf60982d0cfed8d7ba78f4aabd37?s=128&d=identicon&r=PG&f=1", "display_name": "JohnFayt", "link": "https://stackoverflow.com/users/3527381/johnfayt"}, "edited": false, "score": 0, "creation_date": 1428613564, "post_id": 29525981, "comment_id": 47249524, "body": "After adding &quot;,True&quot; to the end of the SendKeys statements. It seems to be working in order now"}], "tags": [], "owner": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "is_accepted": true, "score": 2, "last_activity_date": 1428529787, "creation_date": 1428529787, "answer_id": 29525981, "question_id": 29525625, "link": "https://stackoverflow.com/questions/29525625/vba-sendkey-events-happening-out-of-order/29525981#29525981", "title": "VBA SendKey Events Happening Out of Order", "body": "<p>Why not:</p>\n\n<pre><code>Range(\"A2\") = Range(\"A1\")\n</code></pre>\n\n<p>Where A2 is a copy of A1.\nIf you want to use sendkeys, I'd do this:</p>\n\n<pre><code>Range(\"A1\").Select\nSendKeys \"^c\", True\nRange(\"A2\").Select\nSendKeys \"^V\", True 'I'm a Windows user\n</code></pre>\n\n<p>The true means wait, but that's the format for Excel VBA.</p>\n"}, {"tags": [], "owner": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "is_accepted": false, "score": 0, "last_activity_date": 1428530634, "last_edit_date": 1428530634, "creation_date": 1428530221, "answer_id": 29526102, "question_id": 29525625, "link": "https://stackoverflow.com/questions/29525625/vba-sendkey-events-happening-out-of-order/29526102#29526102", "title": "VBA SendKey Events Happening Out of Order", "body": "<p>icebird76 is correct, however you can still use your \"~\" to send an \"Enter\".  This means you won't keep Cell A1 selected as the copied cell.</p>\n\n<pre><code>Range(\"A1\").Select\nSendKeys \"^c\", True\nRange(\"A2\").Select\nSendKeys \"~\", True \n</code></pre>\n\n<p>There's more info on how the SendKeys Statement works and the requirement for \"True\" here.... <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278655.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/gg278655.aspx</a></p>\n"}], "owner": {"reputation": 107, "user_id": 3527381, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3cf2bf60982d0cfed8d7ba78f4aabd37?s=128&d=identicon&r=PG&f=1", "display_name": "JohnFayt", "link": "https://stackoverflow.com/users/3527381/johnfayt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "accepted_answer_id": 29525981, "answer_count": 2, "score": 0, "last_activity_date": 1428530634, "creation_date": 1428528312, "question_id": 29525625, "link": "https://stackoverflow.com/questions/29525625/vba-sendkey-events-happening-out-of-order", "title": "VBA SendKey Events Happening Out of Order", "body": "<p>I'm writing a simple script to copy and paste cell values manually.\nI know that I can do this by other means, but I would like to use the SendKeys.</p>\n\n<p>Here is my script to copy cell A1 into A2:</p>\n\n<pre><code>Public Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n\nSub my_copy()\n\n  Range(\"A1\").Select\n  SendKeys \"^c\"\n  Sleep 10\n  Range(\"A2\").Select\n  SendKeys \"~\"\n  Sleep 10\n\nEnd Sub\n</code></pre>\n\n<p>I can't seem to figure out how to correct the issue I'm having. It selects cell A1, then waits, then A2, then copies and pastes. (Instead of copying after A1 is selected)</p>\n\n<p>Am I missing something here?</p>\n"}, {"tags": ["javascript", "excel", "vba", "internet-explorer", "web-scraping"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1428527750, "creation_date": 1428527750, "answer_id": 29525485, "question_id": 29525345, "link": "https://stackoverflow.com/questions/29525345/submit-button-that-is-in-a-javascript-using-excel-vba/29525485#29525485", "title": "Submit Button that is in a Javascript using Excel VBA", "body": "<p>Try this:</p>\n\n<pre><code>With IE.Document\n\n    .getElementById(\"cfsearchtextboxmain\").Value = _\n          ThisWorkbook.Sheets(\"sheet1\").Range(\"a1\").Value\n\n    .parentWindow.ExecScript \"cfMainFormSubmit()\"\n\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1561608916, "last_edit_date": 1561608916, "creation_date": 1530302334, "answer_id": 51108627, "question_id": 29525345, "link": "https://stackoverflow.com/questions/29525345/submit-button-that-is-in-a-javascript-using-excel-vba/51108627#51108627", "title": "Submit Button that is in a Javascript using Excel VBA", "body": "<p>You could also have used a css selector to target the element.</p>\n\n<pre><code>#cfmainsearchform &gt; a\n</code></pre>\n\n<p>That says <code>a</code> tag within element with id <code>cfmainsearchform</code>.  <code>#</code> is id and <code>&gt;</code> within (<a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/Child_combinator\" rel=\"nofollow noreferrer\">child combinator</a>).</p>\n\n<pre><code>ie.document.querySelector(\"#cfmainsearchform &gt; a\").Click\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4766116, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qCwRbVzevSE/AAAAAAAAAAI/AAAAAAAACsY/er66A7j9SH8/photo.jpg?sz=128", "display_name": "Buu Ngo", "link": "https://stackoverflow.com/users/4766116/buu-ngo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1197, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1561608916, "creation_date": 1428527111, "last_edit_date": 1561608830, "question_id": 29525345, "link": "https://stackoverflow.com/questions/29525345/submit-button-that-is-in-a-javascript-using-excel-vba", "title": "Submit Button that is in a Javascript using Excel VBA", "body": "<p>I cannot seem to submit the click the submit or go button.  It seems to be under a javascript which I am not sure how to enter a code to click the go button.   Here is what I have: </p>\n\n<pre><code>Sub FactFinderForm()\nDim IE As Object\nSet IE = CreateObject(\"InternetExplorer.Application\")\n'create new instance of IE. use reference to return current open IE if\n'you want to use open IE window. Easiest way I know of is via title bar.\nIE.Navigate \"http://factfinder.census.gov/faces/nav/jsf/pages/index.xhtml###\"\n'go to web page listed inside quotes\nIE.Visible = True\n\nWhile IE.busy\nDoEvents 'wait until IE is done loading page.\nWend\n\nIE.Document.getElementsByname(\"cfsearchtextboxmain\").Item.innertext = _\n              ThisWorkbook.Sheets(\"sheet1\").Range(\"a1\")\n\nWhile IE.readyState &lt;&gt; 4\nDoEvents\nWend\n\nSendKeys \"{enter}\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "charts", "stacked-chart", "vba"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 4755513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ae03493286619f4333068a3564e6f4?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4755513/sam"}, "edited": false, "score": 0, "creation_date": 1428585909, "post_id": 29528232, "comment_id": 47231515, "body": "The problem is though I want non-contiguous range in the same series under the same label.  So category A has two type 2 series &quot;ranges&quot;.  I think the problem is that there is no such thing as &quot;ranges&quot; with these type of charts so I am open to other suggestions as a way to go about this."}, {"owner": {"reputation": 471, "user_id": 4616423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86a46559e4c3f1704e0ba1ddfa70cc88?s=128&d=identicon&r=PG&f=1", "display_name": "rgo", "link": "https://stackoverflow.com/users/4616423/rgo"}, "reply_to_user": {"reputation": 43, "user_id": 4755513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ae03493286619f4333068a3564e6f4?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4755513/sam"}, "edited": false, "score": 0, "creation_date": 1428675624, "post_id": 29528232, "comment_id": 47277302, "body": "Filter the data to your non-contiguous range, then copy the range to a blank sheet. Do the same for each non-Contiguous range, then base your chart of the new sheet. You can use your macro recorder to save your filter criteria and construct the chart."}], "tags": [], "owner": {"reputation": 471, "user_id": 4616423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86a46559e4c3f1704e0ba1ddfa70cc88?s=128&d=identicon&r=PG&f=1", "display_name": "rgo", "link": "https://stackoverflow.com/users/4616423/rgo"}, "is_accepted": false, "score": 0, "last_activity_date": 1428543167, "creation_date": 1428543167, "answer_id": 29528232, "question_id": 29525280, "link": "https://stackoverflow.com/questions/29525280/stacked-column-graph-with-multiple-entries-per-category/29528232#29528232", "title": "Stacked column graph with multiple entries per category", "body": "<p>You can add additional series by editing the existing series within the chart. When setting the additional series you get to pick the cell ranges for the series.</p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 4755513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ae03493286619f4333068a3564e6f4?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4755513/sam"}, "edited": false, "score": 0, "creation_date": 1428932130, "post_id": 29564716, "comment_id": 47358939, "body": "So you mean like Type 1a, 1b, 1c... ect?  The problem I have is there are about 5 types, 10 &quot;ranges&quot; of varying types in each category, and 2000 categories."}], "tags": [], "owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "is_accepted": false, "score": 0, "last_activity_date": 1428678045, "creation_date": 1428678045, "answer_id": 29564716, "question_id": 29525280, "link": "https://stackoverflow.com/questions/29525280/stacked-column-graph-with-multiple-entries-per-category/29564716#29564716", "title": "Stacked column graph with multiple entries per category", "body": "<p>If you let yourself be a little flexible about data layout etc, you can get what you want. You may need multiple ranges for each Type, which means you get multiple series in the chart for each Type, which you then must format as all series of that Type.</p>\n"}], "owner": {"reputation": 43, "user_id": 4755513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ae03493286619f4333068a3564e6f4?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4755513/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 836, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1428678045, "creation_date": 1428526873, "last_edit_date": 1531161705, "question_id": 29525280, "link": "https://stackoverflow.com/questions/29525280/stacked-column-graph-with-multiple-entries-per-category", "title": "Stacked column graph with multiple entries per category", "body": "<p>I think that I am dealing with a special type of graph:<br>\n<img src=\"https://i.stack.imgur.com/399v9.jpg\" alt=\"SO29525280 question example\"></p>\n\n<p>I've researched stacked column graphs but they will only allow one series (type) entry per category (A,B,C).</p>\n\n<p>Is there a way to display this using Excel/Access PivotCharts?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1428527969, "post_id": 29525101, "comment_id": 47205403, "body": "You can use <code>application.run</code> or you can set a reference to the VBA project of your personal macro workbook, but you&#39;ll need to change the name of the project from the default &#39;VBAProject&#39; first. Once you have a reference set, you can call the function directly."}, {"owner": {"reputation": 6397, "user_id": 1472743, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f205382e9fa00ee4bdf653ec92a34679?s=128&d=identicon&r=PG", "display_name": "dwstein", "link": "https://stackoverflow.com/users/1472743/dwstein"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1428528589, "post_id": 29525101, "comment_id": 47205731, "body": "I don&#39;t know how to use <code>application.run</code>.  I found this example (<a href=\"http://www.rondebruin.nl/win/s9/win001.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s9/win001.htm</a>), but don&#39;t understand how to apply it here.  Can you pls answer with the proper syntax?  Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 2, "last_activity_date": 1428656480, "last_edit_date": 1428656480, "creation_date": 1428593739, "answer_id": 29542930, "question_id": 29525101, "link": "https://stackoverflow.com/questions/29525101/how-to-i-use-functions-in-vba-from-my-personal-macro-workbook/29542930#29542930", "title": "how to I use functions in vba from my personal macro workbook?", "body": "<p>You have two choices really:</p>\n\n<ol>\n<li>You can use <code>Application.Run</code>; or</li>\n<li>You can set a reference to the VBA project of your personal macro workbook ( but you'll need to change the name of the project from the default 'VBAProject' first). Once you have a reference set, you can call the function directly</li>\n</ol>\n\n<p>To use <code>Application.Run</code> you pass the workbook and routine name as the first argument, then any arguments required by that routine as additional arguments to <code>Run</code>. If the routine name is the same as its parent module, or you have more than one routine in the workbook with the same name, you need to supply the module name too, and if the workbook name contains spaces, you need to enclose it in single quotes. So the basic syntax is either:</p>\n\n<pre><code>Application.Run \"'workbook name.xlsm'!routine_name\", parameter1\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>Application.Run \"'workbook name.xlsm'!module_name.routine_name\", parameter1\n</code></pre>\n\n<p>For example:</p>\n\n<pre><code>dim lCounter as long\nlCounter = Application.Run(\"'Personal.xlsb'!Get_Rows_Generic_personal\", \"some sheet\")\n</code></pre>\n"}], "owner": {"reputation": 6397, "user_id": 1472743, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f205382e9fa00ee4bdf653ec92a34679?s=128&d=identicon&r=PG", "display_name": "dwstein", "link": "https://stackoverflow.com/users/1472743/dwstein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4467, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1428656480, "creation_date": 1428526238, "last_edit_date": 1531164843, "question_id": 29525101, "link": "https://stackoverflow.com/questions/29525101/how-to-i-use-functions-in-vba-from-my-personal-macro-workbook", "title": "how to I use functions in vba from my personal macro workbook?", "body": "<p>I have the following function in my personal workbook:</p>\n\n<pre><code>Public Function Get_Rows_Generic_personal(sheet_name As String) As Long\n    Get_Rows_Generic = Worksheets(sheet_name).UsedRange.Rows.Count\nEnd Function\n</code></pre>\n\n<p>How do I call it from a module in another project?</p>\n\n<p><a href=\"http://www.mrexcel.com/forum/excel-questions/580556-functions-personal-macro-workbook.html\" rel=\"nofollow\">This thread</a> was supposed to have the answer but the link is dead.</p>\n"}, {"tags": ["sql-server", "vba", "excel"], "comments": [{"owner": {"reputation": 2651, "user_id": 4059942, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/2bmaq.jpg?s=128&g=1", "display_name": "Saagar Elias Jacky", "link": "https://stackoverflow.com/users/4059942/saagar-elias-jacky"}, "edited": false, "score": 0, "creation_date": 1428526479, "post_id": 29525094, "comment_id": 47204660, "body": "You might want to check this <a href=\"http://stackoverflow.com/questions/12074939/get-rows-as-columns-sql-server-dynamic-pivot-query\" title=\"get rows as columns sql server dynamic pivot query\">stackoverflow.com/questions/12074939/&hellip;</a> or this <a href=\"http://www.codeproject.com/Tips/500811/Simple-Way-To-Use-Pivot-In-SQL-Query\" rel=\"nofollow noreferrer\">codeproject.com/Tips/500811/&hellip;</a>"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1428526481, "post_id": 29525094, "comment_id": 47204662, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/1187460/sql-rows-to-columns\">SQL Rows to Columns</a>"}, {"owner": {"reputation": 18158, "user_id": 3293914, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fPAnb.jpg?s=128&g=1", "display_name": "Dan Field", "link": "https://stackoverflow.com/users/3293914/dan-field"}, "edited": false, "score": 0, "creation_date": 1428527964, "post_id": 29525094, "comment_id": 47205399, "body": "<a href=\"http://stackoverflow.com/questions/10404348/sql-server-dynamic-pivot-query\" title=\"sql server dynamic pivot query\">stackoverflow.com/questions/10404348/&hellip;</a> is probably what you want"}], "answers": [{"comments": [{"owner": {"reputation": 42694, "user_id": 1175077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AWgLI.jpg?s=128&g=1", "display_name": "jpw", "link": "https://stackoverflow.com/users/1175077/jpw"}, "edited": false, "score": 5, "creation_date": 1428529713, "post_id": 29525845, "comment_id": 47206274, "body": "No no no, the answer would be to use PIVOT, either static or dynamic if the list of items can change. This example code that you copied from the <a href=\"https://technet.microsoft.com/en-us/library/aa258831%28v=sql.80%29.aspx\" rel=\"nofollow noreferrer\">SQL Server 2000 Book Online</a> really has nothing to do with this at all."}], "tags": [], "owner": {"reputation": 63, "user_id": 3934223, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/564f99b27da72550abe88c7073d15382?s=128&d=identicon&r=PG&f=1", "display_name": "cobes", "link": "https://stackoverflow.com/users/3934223/cobes"}, "is_accepted": false, "score": -2, "last_activity_date": 1471641577, "last_edit_date": 1471641577, "creation_date": 1428529160, "answer_id": 29525845, "question_id": 29525094, "link": "https://stackoverflow.com/questions/29525094/can-i-format-results-from-sql-query-like-a-excel-sheet/29525845#29525845", "title": "Can I format results from SQL query like a Excel sheet", "body": "<p>You have to create a stored procedure and cursor like this example below.</p>\n\n<pre><code>SET NOCOUNT ON\nDECLARE @au_id varchar(11),\n @au_fname varchar(20),\n @au_lname varchar(40),\n @message varchar(80),\n @title varchar(80)\nPRINT('-------- Utah Authors report --------')\nDECLARE authors_cursor CURSOR FOR\n(SELECT au_id, au_fname, au_lname\nFROM authors\nWHERE state = 'UT'\nORDER BY au_id)\nOPEN authors_cursor\nFETCH FIRST FROM authors_cursor INTO @au_id, @au_fname, @au_lname\nWHILE @@FETCH_STATUS = 0\nBEGIN\n   PRINT(' ')\n   SET @message = '----- Books by Author: ' + @au_fname + ' ' + @au_lname\n   PRINT(@message)\n   -- Declare an inner cursor based\n   -- on au_id from the outer cursor.\n   DECLARE titles_cursor CURSOR FOR\n   (SELECT t.title\n   FROM titleauthor ta, titles t\n   WHERE ta.title_id = t.title_id AND\n   ta.au_id = @au_id)   -- Variable value from the outer cursor\n   OPEN titles_cursor\n   FETCH FIRST FROM titles_cursor INTO @title\n   IF @@FETCH_STATUS &lt;&gt; 0\n      PRINT('         &lt;&lt;No Books&gt;&gt;')\n   WHILE @@FETCH_STATUS = 0\n   BEGIN\n      SET @message = '         ' + @title\n      PRINT @message\n      FETCH NEXT FROM titles_cursor INTO @title\n   END\n   CLOSE titles_cursor\n   DEALLOCATE titles_cursor\n   -- Get the next author.\n   FETCH NEXT FROM authors_cursor INTO @au_id, @au_fname, @au_lnameEND\nCLOSE authors_cursor\nDEALLOCATE authors_cursor\nGO\n</code></pre>\n"}], "owner": {"reputation": 403, "user_id": 4547107, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/ef42f758ae6b02e6ba7c5371ff4d8738?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4547107/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 185, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471641577, "creation_date": 1428526211, "question_id": 29525094, "link": "https://stackoverflow.com/questions/29525094/can-i-format-results-from-sql-query-like-a-excel-sheet", "title": "Can I format results from SQL query like a Excel sheet", "body": "<p>I am running a query for every truck in our fleet to see the mileage and amount of fuel used over a month, quarter or year time frame. So my columns are Date, Truck, Miles. Formatting the results is time consuming because all the trucks' data are listed together like below.</p>\n\n<pre><code>   Date   Truck   Miles\n   1/1/15   101     542\n   1/2/15   101     342\n</code></pre>\n\n<p>Is there a way to format the query results when coping to Excel or running the query as a macro in Excel so the results are displayed like a 3d table like below?</p>\n\n<pre><code>   Truck  1/1/15  1/2/15  1/3/15\n    101      542     342     741\n    102      121     214     141\n    103      541     741     874\n</code></pre>\n"}, {"tags": ["xml", "ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 1, "creation_date": 1428526543, "post_id": 29525064, "comment_id": 47204689, "body": "Can you provide XML structure and sample data?"}], "answers": [{"tags": [], "owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "is_accepted": true, "score": 2, "last_activity_date": 1428579320, "last_edit_date": 1428579320, "creation_date": 1428578633, "answer_id": 29537199, "question_id": 29525064, "link": "https://stackoverflow.com/questions/29525064/ms-access-vba-parse-xml-file/29537199#29537199", "title": "MS Access VBA parse XML File", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/ms754585%28v=vs.85%29.aspx\" rel=\"nofollow\">.loadXML Method</a> loads the XML from a string, but if you already have the file spec you can just use the <a href=\"https://msdn.microsoft.com/en-us/library/ms762722%28v=vs.85%29.aspx\" rel=\"nofollow\">.load Method</a> to load the XML directly from the file. For example, given the following file \"sample.gpx\" (an XML file used by navigation devices to store locations) ...</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\" ?&gt;\n&lt;gpx xmlns=\"http://www.topografix.com/GPX/1/1\" xmlns:gpxx=\"http://www.garmin.com/xmlschemas/GpxExtensions/v3\" creator=\"Extra_POI_Editor V5.33\" version=\"1.1\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd http://www.garmin.com/xmlschemas/GpxExtensions/v3 http://www8.garmin.com/xmlschemas/GpxExtensions/v3/GpxExtensionsv3.xsd\"&gt;\n  &lt;metadata&gt;&lt;!--\n                                                                                                                                                                                                                                                       Extra_POI_Editor can only be used for personnal usage and not for any commercial purposes without a written permission of the author, aka TurboCCC. I can be reached at turboccc@hotmail.com.\n  --&gt;&lt;link href=\"http://turboccc.wikispaces.com\"&gt;&lt;/link&gt;\n    &lt;time&gt;2013-10-26T00:36:17Z&lt;/time&gt;\n  &lt;/metadata&gt;\n\n  &lt;wpt lat=\"51.056128\" lon=\"-113.982223\"&gt;\n    &lt;name&gt;Harveys: Calgary&lt;/name&gt;\n    &lt;cmt&gt; &lt;/cmt&gt;\n    &lt;extensions&gt;\n      &lt;gpxx:WaypointExtension&gt;\n        &lt;gpxx:Address&gt;\n          &lt;gpxx:StreetAddress&gt;Northgate Village Mall, 525-36th St. N.E.&lt;/gpxx:StreetAddress&gt;\n          &lt;gpxx:City&gt;Calgary&lt;/gpxx:City&gt;\n          &lt;gpxx:State&gt;AB&lt;/gpxx:State&gt;\n          &lt;gpxx:PostalCode&gt;T2A 6K3&lt;/gpxx:PostalCode&gt;\n        &lt;/gpxx:Address&gt;\n        &lt;gpxx:PhoneNumber&gt;403-272-9641&lt;/gpxx:PhoneNumber&gt;\n      &lt;/gpxx:WaypointExtension&gt;\n    &lt;/extensions&gt;\n  &lt;/wpt&gt;\n\n  &lt;wpt lat=\"51.134358\" lon=\"-114.010802\"&gt;\n    &lt;name&gt;Harveys: Calgary (Airport)&lt;/name&gt;\n    &lt;cmt&gt; &lt;/cmt&gt;\n    &lt;extensions&gt;\n      &lt;gpxx:WaypointExtension&gt;\n        &lt;gpxx:Address&gt;\n          &lt;gpxx:StreetAddress&gt;2000 Airport Rd. N.E.&lt;/gpxx:StreetAddress&gt;\n          &lt;gpxx:City&gt;Calgary&lt;/gpxx:City&gt;\n          &lt;gpxx:State&gt;AB&lt;/gpxx:State&gt;\n          &lt;gpxx:PostalCode&gt;T2E 6W5&lt;/gpxx:PostalCode&gt;\n        &lt;/gpxx:Address&gt;\n        &lt;gpxx:PhoneNumber&gt;403-250-9177&lt;/gpxx:PhoneNumber&gt;\n      &lt;/gpxx:WaypointExtension&gt;\n    &lt;/extensions&gt;\n  &lt;/wpt&gt;\n\n&lt;/gpx&gt;\n</code></pre>\n\n<p>... the following code will extract the longitude, latitude, and name of each location ...</p>\n\n<pre class=\"lang-vbs prettyprint-override\"><code>Option Compare Database\nOption Explicit\n\nSub xmlTest()\n    Dim lon As Double, lat As Double, poiName As String\n    ' VBA project reference required:\n    ' Microsoft XML, v6.0\n    Dim xmlDoc As New MSXML2.DOMDocument60\n    If xmlDoc.Load(\"C:\\__tmp\\sample.gpx\") Then\n        Dim xmlTopLevelNode As MSXML2.IXMLDOMNode\n        For Each xmlTopLevelNode In xmlDoc.childNodes\n            If xmlTopLevelNode.nodeName = \"gpx\" Then\n                Dim gpxNode As MSXML2.IXMLDOMNode\n                For Each gpxNode In xmlTopLevelNode.childNodes\n                    If gpxNode.nodeName = \"wpt\" Then\n                        Dim wptAttribute As MSXML2.IXMLDOMNode\n                        For Each wptAttribute In gpxNode.Attributes\n                            Select Case wptAttribute.nodeName\n                                Case \"lat\":\n                                    lat = CDbl(wptAttribute.nodeTypedValue)\n                                Case \"lon\":\n                                    lon = CDbl(wptAttribute.nodeTypedValue)\n                            End Select\n                        Next\n                        Set wptAttribute = Nothing\n                        Dim wptChildNode As MSXML2.IXMLDOMNode\n                        For Each wptChildNode In gpxNode.childNodes\n                            If wptChildNode.nodeName = \"name\" Then\n                                poiName = wptChildNode.nodeTypedValue\n                            End If\n                            Exit For\n                        Next\n                        Set wptChildNode = Nothing\n                        Debug.Print lon &amp; \",\" &amp; lat &amp; \",\" &amp; \"\"\"\" &amp; Replace(poiName, \"\"\"\", \"\"\"\"\"\") &amp; \"\"\"\"\n                    End If\n                Next\n                Set gpxNode = Nothing\n            End If\n        Next\n        Set xmlTopLevelNode = Nothing\n    Else\n        Debug.Print \"Unable to load XML file.\"\n    End If\n    Set xmlDoc = Nothing\nEnd Sub\n</code></pre>\n\n<p>... and print it to the VBA Immediate window:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>-113.982223,51.056128,\"Harveys: Calgary\"\n-114.010802,51.134358,\"Harveys: Calgary (Airport)\"\n</code></pre>\n"}], "owner": {"reputation": 851, "user_id": 986706, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e5cc89933287ac59c5241b75564ab308?s=128&d=identicon&r=PG", "display_name": "MultiGuy", "link": "https://stackoverflow.com/users/986706/multiguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4858, "favorite_count": 0, "accepted_answer_id": 29537199, "answer_count": 1, "score": 1, "last_activity_date": 1594652419, "creation_date": 1428526104, "last_edit_date": 1594652419, "question_id": 29525064, "link": "https://stackoverflow.com/questions/29525064/ms-access-vba-parse-xml-file", "title": "MS Access VBA parse XML File", "body": "<p>I'm having a tough time here. I'm trying to import and parse an XML file with VBA. However, the .LoadXML function doesn't seem to be working. I've loaded the Microsoft XML, v6.0 reference and the XML file is valid.  Here's a portion of the code:</p>\n\n<pre><code>Public Function ParseXML(ByVal strXMLFilename As String) As Boolean\n\nDim intFile As Integer\nDim strXMLFile As String\nDim xmlDoc As Object\nDim xmlTransmission As Object 'MSXML2.IXMLDOMNode\nDim xmlSurvey As Object 'MSXML2.IXMLDOMNode\nDim xmlRecord As Object 'MSXML2.IXMLDOMNode\nDim xmlField As Object 'MSXML2.IXMLDOMNode\nDim xmlAttrib As MSXML2.IXMLDOMAttribute\nDim ctrFields As Long\nDim strTargetTable As String\nDim xmlrs As DAO.Recordset\n\nSet xmlDoc = New MSXML2.DOMDocument\n\nintFile = FreeFile()\nOpen strXMLFilename For Input As intFile\nstrXMLFile = input$(LOF(1), 1)\nClose intFile\n\nSet xmlDoc = CreateObject(\"MSXML2.DOMDocument.6.0\")\nxmlDoc.LoadXML strXMLFile\n\n\nctrFields = 0\n\nFor Each xmlTransmission In xmlDoc.ChildNodes 'xmlNodes\n    '...do a bunch of stuff...\nNext xmlTransmission\n\nEnd Function\n</code></pre>\n\n<p>Once it gets to the \"For Each\" statement, it jumps out of the loop and exits the function. I've also tried to load the strXMLFile variable with:</p>\n\n<pre><code>Open strXMLFilename For Input As intFile\nLine Input #intFile, strXMLFile\nClose intFile\n</code></pre>\n\n<p>But that only by the time I get to the .LoadXML function, strXMLFile is only equal to the last line of the file. What am I doing wrong?</p>\n"}, {"tags": ["excel", "vba", "split", "find", "delimiter"], "answers": [{"tags": [], "owner": {"reputation": 172, "user_id": 2635143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94adfabac995bdc7dfa214e14a7836c3?s=128&d=identicon&r=PG", "display_name": "tpkaplan", "link": "https://stackoverflow.com/users/2635143/tpkaplan"}, "is_accepted": false, "score": 0, "last_activity_date": 1428529280, "creation_date": 1428529280, "answer_id": 29525877, "question_id": 29524822, "link": "https://stackoverflow.com/questions/29524822/excel-vba-findnext-and-split-methods/29525877#29525877", "title": "Excel VBA Findnext and Split Methods", "body": "<p>[Range].TextToColumns is a handy VBA method for converting comma-delimited text directly into a table.  For example, </p>\n\n<pre><code> Range(\"A1:A30\").CurrentRegion.TextToColumns Destination:=Range(\"C1\"), _\n    DataType:=xlDelimited,         TextQualifier:=xlDoubleQuote, _ \n    ConsecutiveDelimiter:=False,   Tab:=True, _\n    Semicolon:=False,              Comma:=True, _\n    Space:=False,                  other:=False\n</code></pre>\n\n<p>Will parse a comma-delimited data dump in cells A1 to A30 and will convert it into a table starting at C1.  The table will have 30 rows and as many columns as necessary to show your data in a table format.</p>\n\n<p>For example, if cells A1:A5 contains the following:</p>\n\n<pre><code>13.67,4182085,13.80,13.54,\"4/8/2015\",65.10,15.50,\"Alcoa Inc. Common Stock\"\n78.69,6385991,79.36,78.30,\"4/8/2015\",14.15,86.31,\"American Express Company Common\"\n153.36,2760993,153.50,152.19,\"4/8/2015\",20.78,135.98,\"Boeing Company (The) Common Sto\"\n15.61,7138359,15.74,15.50,\"4/8/2015\",43.36,16.59,\"Bank of America Corporation Com\"\n80.44,4191357,81.24,79.92,\"4/8/2015\",13.68,90.60,\"Caterpillar, Inc. Common Stock\"\n</code></pre>\n\n<p>then that statement above will create a 5x8 table in cells C1:J5 as follows:</p>\n\n<pre><code>13.67   4182085  13.80  13.54   42102   65.10    15.50  Alcoa Inc. Common Stock\n78.69   6385991  79.36  78.30   42102   14.15    86.31  American Express Company Common\n153.36  2760993 153.50  152.19  42102   20.78   135.98  Boeing Company (The) Common Sto\n15.61   7138359  15.74  15.50   42102   43.36    16.59  Bank of America Corporation Com\n80.44   4191357  81.24  79.92   42102   13.68    90.60  Caterpillar, Inc. Common Stock\n</code></pre>\n\n<p>Full documentation is available at <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff193593.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/EN-US/library/office/ff193593.aspx</a></p>\n\n<p>Cheat sheet is:</p>\n\n<p><em>expression</em><code>.TextToColumns(Destination, DataType, TextQualifier, ConsecutiveDelimiter, Tab, Semicolon, Comma, Space, Other, OtherChar, FieldInfo, DecimalSeparator, ThousandsSeparator, TrailingMinusNumbers)</code></p>\n\n<p>Where <em>expression</em> is a Range object.</p>\n\n<p>All parameters are optional.  Parameters are:</p>\n\n<p><code>Destination</code> ... A Range object that specifies where Microsoft Excel will place the results. If the range is larger than a single cell, the top left cell is used.</p>\n\n<p><code>DataType</code> ... xlDelimited or 1 (Default) indicates that the file is delimited by delimiter characters.   xlFixedWidth or 2 indicates that the data in the file is arranged in columns of fixed widths.</p>\n\n<p><code>TextQualifier</code> ... use TextQualifier:=xlTextQualifierDoubleQuote or TextQualifier:=2 to specify that text is surrounded by double quotes, xlTextQualifierSingleQuote or 1 for single quotes, and xlTextQualifierNone or -4142 (huh??) for no quotes.</p>\n\n<p><code>ConsecutiveDelimiter</code> ... True to have Microsoft Excel consider consecutive delimiters as one delimiter. The default value is False.</p>\n\n<p><code>Tab</code> ... True to have DataType be xlDelimited and to have the tab character be a delimiter. The default value is False.</p>\n\n<p><code>Semicolon</code> ... True to have DataType be xlDelimited and to have the semicolon be a delimiter. The default value is False.</p>\n\n<p><code>Comma</code> ... True to have DataType be xlDelimited and to have the comma be a delimiter. The default value is False.</p>\n\n<p><code>Space</code> ... True to have DataType be xlDelimited and to have the space character be a delimiter. The default value is False.</p>\n\n<p><code>Other</code> ... True to have DataType be xlDelimited and to have the character specified by the OtherChar argument be a delimiter. The default value is False.</p>\n\n<p><code>OtherChar</code> ... The delimiter character when Other is True. </p>\n\n<p><code>FieldInfo</code> ... An array containing parse information for the individual columns of data. This one is very powerful for tables that have funky formatting.  I think you can use it in your case to specify field names.  See Microsoft documentation. </p>\n\n<p><code>DecimalSeparator</code>, <code>ThousandsSeparator</code>, <code>TrailingMinusNumbers</code> are self explanatory</p>\n\n<p>Have fun!</p>\n"}, {"tags": [], "owner": {"reputation": 172, "user_id": 2635143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94adfabac995bdc7dfa214e14a7836c3?s=128&d=identicon&r=PG", "display_name": "tpkaplan", "link": "https://stackoverflow.com/users/2635143/tpkaplan"}, "is_accepted": false, "score": 0, "last_activity_date": 1428530366, "creation_date": 1428530366, "answer_id": 29526132, "question_id": 29524822, "link": "https://stackoverflow.com/questions/29524822/excel-vba-findnext-and-split-methods/29526132#29526132", "title": "Excel VBA Findnext and Split Methods", "body": "<p>Alternatively, based on your example, you could use a simple spreadsheet function. If Cell A1 looks like </p>\n\n<pre><code>Account Number:X7D4332, Account Name:Fidelity, As of Date: 3/15/15, CUSIP #:3136AMKZ1\n</code></pre>\n\n<p>then </p>\n\n<pre><code>B1 =FIND(\"Account Number:\", A1)\nC1 =LEN(\"Account Number:\")\nD1 =FIND(\",\",A1,C1)\nE1 =MID(A1, B1+C1, D1 - C1 - B1)   \n</code></pre>\n\n<p>will show \"X7D4332\" in cell E1.  If you substitute \"Account Name:\" for \"Account Number:\" then you will get \"Fidelity.\"  Etc.</p>\n\n<p>No macros, no complicated VBA Range Methods.</p>\n"}], "owner": {"reputation": 1, "user_id": 4765833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92d22f94fa3f986630ea1e1e7772148c?s=128&d=identicon&r=PG&f=1", "display_name": "brncao", "link": "https://stackoverflow.com/users/4765833/brncao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 367, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1428530366, "creation_date": 1428525211, "question_id": 29524822, "link": "https://stackoverflow.com/questions/29524822/excel-vba-findnext-and-split-methods", "title": "Excel VBA Findnext and Split Methods", "body": "<p>I need help figuring out how to solve this problem using VBA. I have a messy CSV file that needs to be organized into a table. It currently looks like this:\nEdit: looks like I can't post images until I have 10 reps. Let's just say it's disorganized.</p>\n\n<p>I created another worksheet that contains the headers called \"Account Number\", \"Account Name\", \"As of Date\", \"CUSIP #\", \"Market Value\", \"Maturity Date\", \"Description\", \"Tax Cost\", and \"Unit\". I need to copy those values into the appropriate columns.</p>\n\n<p>A Find function is probably the best way I can think of to find the cells with the value \"Account Number:\". However, \"Account Number: 1234567890\" is one cell. I'll need to split the strings up and extract just the \"1234567890\" part. The extracted part is then pasted into the table (the new worksheet that is) in the appropriate header. When it \"FindNext\", it must paste the new value into an empty cell below it (in the new worksheet). This process is repeated until the end. I don't know how best to approach this. Ditto for the other headers.</p>\n"}, {"tags": ["vba", "outlook", "outlook-2013"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4765967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451dc4ad5790e1832251208641090e1d?s=128&d=identicon&r=PG&f=1", "display_name": "ThatDudeWhatziznem", "link": "https://stackoverflow.com/users/4765967/thatdudewhatziznem"}, "edited": false, "score": 0, "creation_date": 1428611474, "post_id": 29538089, "comment_id": 47248314, "body": "I&#39;m not looking for default folders, though. I&#39;m talking about non-default calendars shared with a sharing invitation."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1428581294, "creation_date": 1428581294, "answer_id": 29538089, "question_id": 29524636, "link": "https://stackoverflow.com/questions/29524636/navigationfolders-add-crashes-outlook-for-shared-calendars/29538089#29538089", "title": "NavigationFolders.add() crashes Outlook for shared calendars?", "body": "<p>Try to use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869575(v=office.15).aspx\" rel=\"nofollow\">GetSharedDefaultFolder</a> method of the Namespace class to get the shared folder instead.</p>\n\n<pre><code>Sub ResolveName()  \n Dim myNamespace As Outlook.NameSpace  \n Dim myRecipient As Outlook.Recipient  \n Dim CalendarFolder As Outlook.Folder \n Set myNamespace = Application.GetNamespace(\"MAPI\")  \n Set myRecipient = myNamespace.CreateRecipient(\"Eugene Astafiev\")  \n myRecipient.Resolve  \n If myRecipient.Resolved Then  \n  Call ShowCalendar(myNamespace, myRecipient)  \n End If  \nEnd Sub \n\nSub ShowCalendar(myNamespace, myRecipient)  \n Dim CalendarFolder As Outlook.Folder \n Set CalendarFolder = _  \n myNamespace.GetSharedDefaultFolder _  \n (myRecipient, olFolderCalendar)  \n CalendarFolder.Display  \nEnd Sub\n</code></pre>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff870053(v=office.15).aspx\" rel=\"nofollow\">Add</a> method of the NavigationFolders class adds the specified Folder, as a NavigationFolder object, to the end of the NavigationFolders collection. </p>\n"}], "owner": {"reputation": 1, "user_id": 4765967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451dc4ad5790e1832251208641090e1d?s=128&d=identicon&r=PG&f=1", "display_name": "ThatDudeWhatziznem", "link": "https://stackoverflow.com/users/4765967/thatdudewhatziznem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 238, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593156977, "creation_date": 1428524559, "last_edit_date": 1593156977, "question_id": 29524636, "link": "https://stackoverflow.com/questions/29524636/navigationfolders-add-crashes-outlook-for-shared-calendars", "title": "NavigationFolders.add() crashes Outlook for shared calendars?", "body": "<p>Simple enough line here:</p>\n\n<p>Set navFol = navGroup.NavigationFolders.Add(cal)</p>\n\n<p>This works as expected for any local calendars, but it instantly crashes Outlook if \"cal\" is a shared calendar. Anyone know a workaround to move shared calendars around between navigation folders? I'm quite new to VBA, just hacking my way around to get a macro to do a simple something for me -- or at least something which really should be simple if not for this.</p>\n\n<p>I doubt it matters, but just in case, \"cal\" is being set in a for loop by iterating through a list of EntryIDs like so:</p>\n\n<p>Set cal = Application.GetNamespace(\"MAPI\").GetFolderFromID(str)</p>\n\n<p>And it's not the variable assignment that's failing there (which is why the above line should be irrelevant). I can do anything else with the calendar whether or not it's shared: read the name, grab appointments from it, etc. Outlook just apparently does not like using shared calendars as arguments for NavigationFolders.Add().</p>\n\n<p>EDIT: I'm talking about NON-default calendars shared via sharing invitations. GetDefaultSharedFolder or the like isn't what I want.</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1428526953, "post_id": 29524537, "comment_id": 47204891, "body": "This is similar to <a href=\"http://stackoverflow.com/questions/10823874/with-a-word-contentcontrol-datepicker-how-do-i-get-the-value\" title=\"with a word contentcontrol datepicker how do i get the value\">stackoverflow.com/questions/10823874/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 4765962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c28064455a21a3982bf1f72299a394c7?s=128&d=identicon&r=PG&f=1", "display_name": "partiallyfulltime", "link": "https://stackoverflow.com/users/4765962/partiallyfulltime"}, "edited": false, "score": 0, "creation_date": 1428594397, "post_id": 29525232, "comment_id": 47237935, "body": "Excellent, thank you! This is what I was looking for to get started. I will try this out. Can all the code be run on the Excel file, or does the Word doc require any VBA of it&#39;s own?"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "reply_to_user": {"reputation": 57, "user_id": 4765962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c28064455a21a3982bf1f72299a394c7?s=128&d=identicon&r=PG&f=1", "display_name": "partiallyfulltime", "link": "https://stackoverflow.com/users/4765962/partiallyfulltime"}, "edited": false, "score": 0, "creation_date": 1428594734, "post_id": 29525232, "comment_id": 47238181, "body": "@partiallyfulltime, all of the code will run on the Excel side.  No changes required on the Word side.  It can be helpful to work with the Word object model on the Word side of things when trying to get the right objects, but the final code is all on the Excel side."}], "tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": true, "score": 1, "last_activity_date": 1428526732, "creation_date": 1428526732, "answer_id": 29525232, "question_id": 29524537, "link": "https://stackoverflow.com/questions/29524537/extract-data-from-content-controls-in-word-to-excel/29525232#29525232", "title": "Extract data from content controls in Word to Excel", "body": "<p>Your application is going to have a large number of specific details which are difficult to address without the specifics.  To get started, here is some very simple code to get the Date from a drop-down in Excel from Word.</p>\n\n<p>Note to work with Word, you need to create a reference to \"Microsoft Word 15.0 Object Library\" on the Excel side.  Tools -> References in the VBA Editor.</p>\n\n<p><img src=\"https://i.stack.imgur.com/zEKHX.png\" alt=\"reference addition\"></p>\n\n<p>When working across applications, it can help to write the VBA in Word and then move it over to Excel once you have the properties you want.</p>\n\n<p>This VBA for the Excel side of the equation:</p>\n\n<pre><code>Sub GetDataFromWordFile()\n\n    Dim wrd As Word.Application\n    Dim file As Word.Document\n\n\n    Set wrd = New Word.Application\n    Set file = wrd.Documents.Open(\"test.docx\")\n\n    Range(\"A1\") = file.ContentControls(1).Range.Text\n\n    file.Close\n    wrd.Quit\n\nEnd Sub\n</code></pre>\n\n<p>My Word file includes a single ContentControl.  Not sure how you address the ones you want (trial and error?).</p>\n\n<p><img src=\"https://i.stack.imgur.com/PPxAc.png\" alt=\"Word file\"></p>\n\n<p>The Excel side drops the date in the right place.</p>\n\n<p><img src=\"https://i.stack.imgur.com/LpyAO.png\" alt=\"Excel side\"></p>\n"}], "owner": {"reputation": 57, "user_id": 4765962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c28064455a21a3982bf1f72299a394c7?s=128&d=identicon&r=PG&f=1", "display_name": "partiallyfulltime", "link": "https://stackoverflow.com/users/4765962/partiallyfulltime"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9530, "favorite_count": 0, "protected_date": 1559345282, "accepted_answer_id": 29525232, "answer_count": 1, "score": 1, "last_activity_date": 1559343165, "creation_date": 1428524274, "last_edit_date": 1428536610, "question_id": 29524537, "link": "https://stackoverflow.com/questions/29524537/extract-data-from-content-controls-in-word-to-excel", "title": "Extract data from content controls in Word to Excel", "body": "<p>I have a Word document that is \"form-fillable\", i.e. it has content control objects in it such as rich text and date picker content controls. I am looking to extract the data from specific fields into Excel. For example, every form has the project title, start date, and manager. I would like 1 row for that form with those three pieces of data. Eventually this will need to be done for a few hundred of these forms every few months, but for now I'd like to just start with one.</p>\n\n<p>I envision having a button on the Excel sheet that will run VBA code to pull the data from the Word document, and populate the proper cells in the sheet. With the filepath for the Word doc being specified by the user.</p>\n\n<p>I am new to VBA. How do I point my code at the right file, and then again at the specific field I need? Do I give the fields titles in the Word doc?</p>\n\n<p>This is in MS Office '13</p>\n"}, {"tags": ["database", "vba", "replace", "ms-access-2010", "file-conversion"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4765687, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lbXuy.jpg?s=128&g=1", "display_name": "SDG", "link": "https://stackoverflow.com/users/4765687/sdg"}, "edited": false, "score": 0, "creation_date": 1428609697, "post_id": 29523852, "comment_id": 47247218, "body": "Thanks.  That&#39;s the part I am having problems with. The editor I am using chokes on the file when I manually try to search and replace text strings and remove line feeds. I thought there might be some way to write a simple program (like python, or use see, but I don;t know how to do it) Was looking for some guidance."}], "tags": [], "owner": {"reputation": 1, "user_id": 4765800, "user_type": "registered", "profile_image": "https://graph.facebook.com/788176734570539/picture?type=large", "display_name": "Walt Fair Jr.", "link": "https://stackoverflow.com/users/4765800/walt-fair-jr"}, "is_accepted": false, "score": 0, "last_activity_date": 1438716473, "last_edit_date": 1438716473, "creation_date": 1428521875, "answer_id": 29523852, "question_id": 29523611, "link": "https://stackoverflow.com/questions/29523611/converting-large-text-file-to-database/29523852#29523852", "title": "converting large text file to database", "body": "<p>I'm not sure I understand how you want to map pf your textfile to data base fields.</p>\n\n<p>That's the first thing you need to decide.</p>\n\n<p>Once you've done that I'd suggest putting your text file into columns corresponding to the database columns. Then you should be able to import it into Access.</p>\n"}, {"tags": [], "owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "is_accepted": false, "score": 0, "last_activity_date": 1428923858, "creation_date": 1428923858, "answer_id": 29604012, "question_id": 29523611, "link": "https://stackoverflow.com/questions/29523611/converting-large-text-file-to-database/29604012#29604012", "title": "converting large text file to database", "body": "<p>This is a method I just put together and it comes with no guarantee. It reads the data (you have provided as sample) and displays in the right format as you need. </p>\n\n<pre><code>Public Sub ReadFileAndSave(filePath As String, breakIdentity As String, Optional sepStr As String = \"@\")\n'******************************************************************************\n'   Opens a large TXT File, reads the data until EOF on the Source,\n'       then reformats the data to be saved on the Destination\n'   Arguments:\n'   ``````````\n'       1. The Source File Path - \"C:\\Users\\SO\\FileName.Txt\" (or) D:\\Data.txt\n'       2. The element used to identify new row - \"new row\" (or) \"-\" (or) \"sam\"\n'       3. (Optional) Separator - The separator, you wish to use. Defauls to '@'\n'*******************************************************************************\n    Dim newFilePath As String, strIn As String, tmpStr As String, lineCtr As Long\n\n    'The Destination file is stored in the same drive with a suffix to the source file name\n    newFilePath = Replace(filePath, \".txt\", \"-ReFormatted.txt\")\n\n    'Open the SOURCE file for Read.\n    Open filePath For Input As #1\n\n    'Open/Create the DESTINATION file for Write.\n    Open newFilePath For Output As #2\n\n    'Loop the SOURCE till the last line.\n    Do While Not EOF(1)\n        'Read one line at a time.\n        Line Input #1, strIn\n        'If it is a blank/empty line SKIP.\n        If Len(strIn) &gt; 1 Then\n            lineCtr = lineCtr + 1\n            'Create a String of the same ID.\n            tmpStr = tmpStr &amp; Trim(Mid(strIn, InStr(strIn, \":\") + 1)) &amp; sepStr\n            'If a new row needs to be inserted, the BREAK IDENTITY is analyzed.\n            If InStr(strIn, breakIdentity) &lt;&gt; 0 And lineCtr &gt; 1 Then\n                'Once the new row is triggered, dump the line in the Destination.\n                Print #2, Left(tmpStr, Len(tmpStr) - Len(Mid(strIn, InStr(strIn, \":\") + 1)) - 1) &amp; vbCrLf\n                'Prepare the NEXT ROW\n                tmpStr = Trim(Mid(strIn, InStr(strIn, \":\") + 1)) &amp; sepStr\n            End If\n        End If\n    Loop\n\n    'Print the last line\n    Print #2, Left(tmpStr, Len(tmpStr) - 1) &amp; vbCrLf\n\n    'Close the files.\n    Close #1\n    Close #2\nEnd Sub\n</code></pre>\n\n<p>Again, this code works on my system and I have not tested the bulk of the matter, so it might be slower in yours. Let me know if this works alright for you. </p>\n"}], "owner": {"reputation": 1, "user_id": 4765687, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lbXuy.jpg?s=128&g=1", "display_name": "SDG", "link": "https://stackoverflow.com/users/4765687/sdg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 242, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1438716473, "creation_date": 1428521148, "last_edit_date": 1428923851, "question_id": 29523611, "link": "https://stackoverflow.com/questions/29523611/converting-large-text-file-to-database", "title": "converting large text file to database", "body": "<p><strong>Background</strong></p>\n\n<p>I am not a programmer or technical person \nI have a project where I need to convert a large text file to an access database. \nThe text file is not in traditional flat file format so I need some help pre    processing. \nThe files are large (millions of records) between 100MB and 1GB and seem to be choking all of the editors I have tried (word pad, notepad, vim, em editor)</p>\n\n<p>The following is a sample of the source text file:</p>\n\n<pre><code>product/productId:B000H9LE4U\n\nproduct/title: Copper 122-H04 Hard Drawn Round Tubing, ASTM B75, 1/2&amp;#034; OD, 0.436&amp;#034; ID, 0.032&amp;#034; Wall, 96&amp;#034; Length\n\nproduct/price: 22.14\n\nreview/userId: ABWHUEYK6JTPP\n\nreview/profileName: Robert Campbell\n\nreview/helpfulness: 0/0\n\nreview/score: 1.0\n\nreview/time: 1339113600review/summary: Either 1 or 5 Stars. Depends on how you look at it.\n\nreview/text: Either 1 or 5 Stars. Depends on how you look at it.1 Star because they sent 6 feet of 2\" OD copper pipe.0 Star because they won't accept returns on it.5 stars because I figure it's actually worth $12-15/foot and since they won't take a return I figure I can sell it and make $40-50 on this deal\n\nproduct/productId: B000LDNH8I\n\nproduct/title: Bacharach 0012-7012 Sling Psychrometer, 25?F to 120?F, red spirit filled\n\nproduct/price: 84.99\n\nreview/userId: A19Y7ZIICAKM48\n\nreview/profileName: T Foley \"computer guy\"\n\nreview/helpfulness: 3/3\n\nreview/score: 5.0\n\nreview/time: 1248307200\n\nreview/summary: I recommend this Sling Psychrometer\n\nreview/text: Not too much to say. This instrument is well built, accurate (compared) to a known good source. It's easy to use, has great instructions if you haven't used one before and stores compactly.I compared prices before I purchased and this is a good value.\n</code></pre>\n\n<p>Each line represents a specific attribute of a product, starting at \"product/productId:\"</p>\n\n<p><strong>What I need</strong></p>\n\n<p>I need to convert this file to a character delimited field (i think @ symbol work) by stripping out each of the codes (i.e. product/productId:, product/title:, etc and replacing with the @ and replacing the line feeds.</p>\n\n<p>I want to eliminate the review/text: line</p>\n\n<p>The output would look like this:</p>\n\n<pre><code>B000H9LE4U@Copper 122-H04 Hard Drawn Round Tubing, ASTM B75, 1/2&amp;#034; OD, 0.436&amp;#034; ID, 0.032&amp;#034; Wall, 96&amp;#034; Length@22.14@ABWHUEYK6JTPP@Robert Campbell@0/0@1.0@1339113600@Either 1 or 5 Stars. Depends on how you look at it.\n\nB000LDNH8I@Bacharach 0012-7012 Sling Psychrometer, 25?F to 120?F, red spirit filled@84.99@A19Y7ZIICAKM48@T Foley \"computer guy\"@3/3@5.0@1248307200@I recommend this Sling Psychrometer\n\nB000LDNH8I@Bacharach 0012-7012 Sling Psychrometer, 25?F to 120?F, red spirit filled@84.99@A3683PMJPFMAAS@Spencer L. Cullen@1/1@5.0@1335398400@A very useful tool\n</code></pre>\n\n<p>I now would have a flat file delimited with \"@\" that I can easily import into access. </p>\n\n<p>Sorry for the ramble. I am open to suggestions, but don't understand programming enough to write using the editor language. Thanks in advance</p>\n"}, {"tags": ["excel", "vba", "function", "loops"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1428521556, "post_id": 29523576, "comment_id": 47201892, "body": "When you declare variables, you need to declare the type of each one so: &quot;Dim varDateFrom As Variant, varDateTo As Variant, varDateDuration As Variant&quot;  Dim x,y,z As Variant only sets &#39;z&#39; to variant type.  I don&#39;t think this is the problem, but it can&#39;t help."}, {"owner": {"reputation": 105, "user_id": 4721081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10152801627643549/picture?type=large", "display_name": "Mohammad Awni Ali", "link": "https://stackoverflow.com/users/4721081/mohammad-awni-ali"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1428521682, "post_id": 29523576, "comment_id": 47201964, "body": "@OpiesDad thank you for the information, really this is the first time I got it, I change my variable declaration as you suggested, but unfortunately still the same problem."}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 4721081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10152801627643549/picture?type=large", "display_name": "Mohammad Awni Ali", "link": "https://stackoverflow.com/users/4721081/mohammad-awni-ali"}, "edited": false, "score": 0, "creation_date": 1428532337, "post_id": 29524017, "comment_id": 47207401, "body": "thank you I tried it and didn&#39;t work also, but I tried some strange issue, the code is working on excel 2007, but not on excel 2010!"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 105, "user_id": 4721081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10152801627643549/picture?type=large", "display_name": "Mohammad Awni Ali", "link": "https://stackoverflow.com/users/4721081/mohammad-awni-ali"}, "edited": false, "score": 0, "creation_date": 1428587100, "post_id": 29524017, "comment_id": 47232433, "body": "What happens when you step through the code?  Does it cause an error anywhere?"}, {"owner": {"reputation": 105, "user_id": 4721081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10152801627643549/picture?type=large", "display_name": "Mohammad Awni Ali", "link": "https://stackoverflow.com/users/4721081/mohammad-awni-ali"}, "edited": false, "score": 0, "creation_date": 1428625034, "post_id": 29524017, "comment_id": 47253909, "body": "I tried, it will enter the loop only once, now its working very will on office 2007, but will enter the loop only once on office 2010! wonder why!"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 105, "user_id": 4721081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10152801627643549/picture?type=large", "display_name": "Mohammad Awni Ali", "link": "https://stackoverflow.com/users/4721081/mohammad-awni-ali"}, "edited": false, "score": 0, "creation_date": 1428673227, "post_id": 29524017, "comment_id": 47275518, "body": "What happens when it enters the loop?  If you step through the code, does it get to the &quot;Next i&quot; line, or does something else happen before then?"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 105, "user_id": 4721081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10152801627643549/picture?type=large", "display_name": "Mohammad Awni Ali", "link": "https://stackoverflow.com/users/4721081/mohammad-awni-ali"}, "edited": false, "score": 0, "creation_date": 1428673315, "post_id": 29524017, "comment_id": 47275602, "body": "I just noticed another area where you have the &quot;CInt(CDate....&quot; combination.  You need to remove &quot;CInt&quot; from all of these cases....I think you are getting the same overflow exception I mentioned in my answer."}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": true, "score": 1, "last_activity_date": 1428522376, "creation_date": 1428522376, "answer_id": 29524017, "question_id": 29523576, "link": "https://stackoverflow.com/questions/29523576/loop-not-working-in-udf-function-excel-vba/29524017#29524017", "title": "Loop Not Working in UDF Function Excel VBA?", "body": "<p>The problem is in this line of code:</p>\n\n<pre><code>If CInt(CDate(varDateTo(i))) &gt;= CDate(varDateFrom(i)) Then\n</code></pre>\n\n<p>an integer is too small to hold the date value and is causing an overflow exception.  I'm not sure why you're trying to convert it into an integer anyways as the comparison won't work if you do that.</p>\n\n<p>Try this:</p>\n\n<pre><code>If CDate(varDateTo(i)) &gt;= CDate(varDateFrom(i)) Then\n</code></pre>\n\n<p>It'll at least start getting through the loop.</p>\n\n<p>I'd also define what you want the function to return</p>\n\n<pre><code>Function calcSumDurations(dateFrom As String, dateTo As String, dateDuration As String) As Long\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 4721081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10152801627643549/picture?type=large", "display_name": "Mohammad Awni Ali", "link": "https://stackoverflow.com/users/4721081/mohammad-awni-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 29524017, "answer_count": 1, "score": 0, "last_activity_date": 1428522376, "creation_date": 1428521009, "last_edit_date": 1428521969, "question_id": 29523576, "link": "https://stackoverflow.com/questions/29523576/loop-not-working-in-udf-function-excel-vba", "title": "Loop Not Working in UDF Function Excel VBA?", "body": "<p>I am having a problem running the code below, the code is to calculate the difference between two array of dates, values is separted by line carriage (<code>CHR(10)</code>), for example in cell <code>A1</code> I have the following dates</p>\n\n<pre><code>A1\n12/12/2012\n11/12/2021\n7/8/2015\n9/4/2014\n\nB1\n12/12/2012\n11/12/2021\n7/8/2015\n9/4/2014\n\nC1\n2D\n1D\n4D\n10D\n</code></pre>\n\n<p>in <code>D1</code> I call the function from which is inside module 1 as following</p>\n\n<pre><code>=calcSumDurations(A1,B1,C1)\n</code></pre>\n\n<p>it will always return 0</p>\n\n<p>and when I try to trace the code, it will enter the for loop only once, even than <code>intmax = 3</code>, or <code>4</code> or <code>40</code> in some cases, I tried while, for, foreach, none working.</p>\n\n<pre><code>    Function calcSumDurations(dateFrom, dateTo, dateDuration As String)\n    Dim intmax, intSum, i, intError As Integer\n    Dim varDateFrom, varDateTo, varDateDuration As Variant\n\n    intSum = 0\n    intmax = -1\n    i = 0\n    intError = 0\n    varDateFrom = Split(dateFrom, Chr(10))\n    varDateTo = Split(dateTo, Chr(10))\n    varDateDuration = Split(dateDuration, Chr(10))\n    intmax = UBound(varDateFrom)\n\n\n    If UBound(varDateFrom) = UBound(varDateTo) Then ' both are same lenght\n        If intmax &gt;= 0 Then ' more than one line\n            For i = 0 To intmax\n            'While i &lt; intmax\n                MsgBox (i)\n                If CInt(CDate(varDateTo(i))) &gt;= CDate(varDateFrom(i)) Then                         'check dates are more\n            If testDate(CStr(varDateTo(i))) And                 testDate(CStr(varDateFrom(i))) Then\n                        intDuration = Abs(CInt(CDate(varDateTo(i)) - CDate(varDateFrom(i)))) + 1\n                        intSum = intSum + intDuration\n                        'strRes = strRes &amp; CStr(intDuration) &amp; Chr(10)\n                    Else\n                        intError = 1\n                        'Exit For\n                    End If\n                Else\n                    intError = 2\n                End If\n            Next i\n        End If\n    Else\n        intError = 3\n    End If\n    calcSumDurations = intSum\n            End Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 669, "user_id": 3525024, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/290e39088447a1e671b08a924b4323e1?s=128&d=identicon&r=PG&f=1", "display_name": "9Deuce", "link": "https://stackoverflow.com/users/3525024/9deuce"}, "edited": false, "score": 0, "creation_date": 1428520938, "post_id": 29523494, "comment_id": 47201521, "body": "What change to what variable did you make to make it not work?"}], "answers": [{"tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": false, "score": 0, "last_activity_date": 1428521204, "creation_date": 1428521204, "answer_id": 29523628, "question_id": 29523494, "link": "https://stackoverflow.com/questions/29523494/vba-excel-set-variable-to-row-number-with-row/29523628#29523628", "title": "VBA Excel set variable to row number with .row", "body": "<p>You need to <code>Set</code> the lines below, since they are to be a range variable, and a range is an object.</p>\n\n<p>Change this:</p>\n\n<pre><code>FoundCell_1 = ActiveSheet.Columns(1).Find(What:=Point_1, LookIn:=xlValues, LookAt:=xlPart)\nFoundCell_2 = ActiveSheet.Columns(1).Find(What:=Point_2, LookIn:=xlValues, LookAt:=xlPart)\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>Set FoundCell_1 = ActiveSheet.Columns(1).Find(What:=Point_1, LookIn:=xlValues, LookAt:=xlPart)\nSet FoundCell_2 = ActiveSheet.Columns(1).Find(What:=Point_2, LookIn:=xlValues, LookAt:=xlPart)\n</code></pre>\n\n<p>This change will allow for the <code>.Row</code> property to be pulled from your range object.</p>\n"}], "owner": {"reputation": 1, "user_id": 4765700, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hYjsr69nI1M/AAAAAAAAAAI/AAAAAAAAPuA/6yhSbdIHd28/photo.jpg?sz=128", "display_name": "Walter", "link": "https://stackoverflow.com/users/4765700/walter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1329, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1428521204, "creation_date": 1428520790, "question_id": 29523494, "link": "https://stackoverflow.com/questions/29523494/vba-excel-set-variable-to-row-number-with-row", "title": "VBA Excel set variable to row number with .row", "body": "<p>I have a lot of files and want to find the areas under portions of the curve.\nI define how many curves, the X1 and X2.</p>\n\n<p>The macro then finds the row x1 and x2 and then should give me the row number that they are contained in, but I keep getting an error at this step. </p>\n\n<p>Then later on it uses these values to calcultae the area. </p>\n\n<p>It worked once, I made a change to a variable and have never gotten it to work right since. </p>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub Macro1()\n\nDim myRange, TotalPeak, TotalBack, FoundCell_1, FoundCell_2, J, FileNumber, Point_1, Point_2, CPoint_1, CPoint_2\n\nFileNumber = InputBox(\"Number of curves\")\nPoint_1 = InputBox(\"Enter point one of curve\")\nPoint_2 = InputBox(\"Enter point two of curve\")\n\nFor J = 1 To FileNumber\n\nFoundCell_1 = ActiveSheet.Columns(1).Find(What:=Point_1, LookIn:=xlValues, LookAt:=xlPart)\nFoundCell_2 = ActiveSheet.Columns(1).Find(What:=Point_2, LookIn:=xlValues, LookAt:=xlPart)\n\nCPoint_1 = FoundCell_1.Row\nCPoint_2 = FoundCell_2.Row\n\nmyRange = ActiveSheet.Range(Cells(CPoint_1, J + 1), Cells(CPoint_2, J + 1))\nTotalPeak = Application.WorksheetFunction.Sum(myRange)\nTotalBack = ((Cells(CPoint_1, J + 1) + Cells(CPoint_2, J + 1)) / 2) * Abs((CPoint_2 - CPoint_1))\nWorksheets(\"Sheet2\").Cells(J, 1) = TotalPeak - TotalBack\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "edited": false, "score": 1, "creation_date": 1428520247, "post_id": 29523041, "comment_id": 47201124, "body": "your starting at the bottom and working up but then your deleting the row above? how would that work?!"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1428520814, "post_id": 29523041, "comment_id": 47201449, "body": "never use <code>application.screenupdating = false</code> until your code is working properly. I&#39;m pretty sure that you&#39;ll see the issue if you comment that out."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1428532299, "post_id": 29523041, "comment_id": 47207384, "body": "Have you commented <code>application.screeunpdating</code> and stepped through the code in the debugger to see if you can identify where/why it&#39;s going wrong?"}], "answers": [{"tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 0, "last_activity_date": 1428520893, "creation_date": 1428520893, "answer_id": 29523535, "question_id": 29523041, "link": "https://stackoverflow.com/questions/29523041/macro-to-delete-rows-freezes-half-the-time/29523535#29523535", "title": "Macro to delete rows freezes half the time", "body": "<p>Based on Steve Martin's suggestion, try this:</p>\n\n<pre><code>For a = Lcell To 2 Step -1\n   If Cells(a, 23).Value = Cells(a - 1, 23).Value Then\n       Cells(a-1, 16).Value = Cells(a, 16).Value + Cells(a - 1, 16).Value\n       Cells(a-1, 17).Value = Cells(a, 17).Value + Cells(a - 1, 17).Value\n       Cells(a-1, 18).Value = Cells(a, 18).Value + Cells(a - 1, 18).Value\n       Cells(a, 1).EntireRow.Delete\n   End If\nNext a\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 3822304, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5636f4571c7f83f355936ba91f88916f?s=128&d=identicon&r=PG&f=1", "display_name": "user3822304", "link": "https://stackoverflow.com/users/3822304/user3822304"}, "edited": false, "score": 0, "creation_date": 1428530986, "post_id": 29524931, "comment_id": 47206874, "body": "Good idea Byron, I thought of this as well but you need to delete the rows while you loop through the lines otherwise it will not consolidate all the values in cell(a, 23), there will be duplicates."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "reply_to_user": {"reputation": 31, "user_id": 3822304, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5636f4571c7f83f355936ba91f88916f?s=128&d=identicon&r=PG&f=1", "display_name": "user3822304", "link": "https://stackoverflow.com/users/3822304/user3822304"}, "edited": false, "score": 0, "creation_date": 1428532217, "post_id": 29524931, "comment_id": 47207347, "body": "@user3822304, ahh, I see it now.  You are deleting the row above the last one.  Missed the <code>A-1</code> there.  Can you delete the last row instead and work your way up, or is there something special about the 2nd to last row?  In my code that would be: <code>Cells(A, 1).EntireRow</code> instead of the <code>A-1</code>.  And the formulas above would set <code>Cells(A-1,16) = ...</code> instead of <code>Cells(A,...)</code>."}, {"owner": {"reputation": 31, "user_id": 3822304, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5636f4571c7f83f355936ba91f88916f?s=128&d=identicon&r=PG&f=1", "display_name": "user3822304", "link": "https://stackoverflow.com/users/3822304/user3822304"}, "edited": false, "score": 0, "creation_date": 1428950648, "post_id": 29524931, "comment_id": 47370863, "body": "I was too quick to confirm error resolution; I still get the same issue as above. The debugger is saying the rng_delete.Delete line is the issues. Any guesses?"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "reply_to_user": {"reputation": 31, "user_id": 3822304, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5636f4571c7f83f355936ba91f88916f?s=128&d=identicon&r=PG&f=1", "display_name": "user3822304", "link": "https://stackoverflow.com/users/3822304/user3822304"}, "edited": false, "score": 0, "creation_date": 1428952007, "post_id": 29524931, "comment_id": 47371625, "body": "Hard to say without more info about the specifics of the spreadsheet when it errors.  Using <code>Union</code> makes it a little harder to debug also since it can be a large range that it is trying to delete.  You can try and delete rows as you go again and see if a specific row is causing the error.  You can also do <code>rng_delete.Select</code> instead of deleting to see what it wants to delete.  Or <code>Debug.Print rng_delete.Address</code> if the <code>Select</code> fails."}], "tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": false, "score": 0, "last_activity_date": 1428532582, "last_edit_date": 1428532582, "creation_date": 1428525618, "answer_id": 29524931, "question_id": 29523041, "link": "https://stackoverflow.com/questions/29523041/macro-to-delete-rows-freezes-half-the-time/29524931#29524931", "title": "Macro to delete rows freezes half the time", "body": "<p>One option when deleting cells is to use the UNION-DELETE pattern.  This saves the deletion step until after the logic is determined and does it all at once.  This technique allows deleting a Range that is being iterated through.  It also reduces operations which should improve increase speed.  I have not tested it for speed though.</p>\n\n<p><strong>Edited code to delete last row based on comments</strong></p>\n\n<pre><code>Dim rng_delete As Range\n\nFor A = Lcell To 2 Step -1\n   If Cells(A, 23).Value = Cells(A - 1, 23).Value Then\n       Cells(A - 1, 16).Value = Cells(A, 16).Value + Cells(A - 1, 16).Value\n       Cells(A - 1, 17).Value = Cells(A, 17).Value + Cells(A - 1, 17).Value\n       Cells(A - 1, 18).Value = Cells(A, 18).Value + Cells(A - 1, 18).Value\n\n        'rng_delete starts empty which errors Union on first add\n        If rng_delete Is Nothing Then\n            Set rng_delete = Cells(A, 1).EntireRow\n        Else\n            Set rng_delete = Union(rng_delete, Cells(A, 1).EntireRow)\n        End If\n   End If\nNext A\n\nrng_delete.Delete\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 3822304, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5636f4571c7f83f355936ba91f88916f?s=128&d=identicon&r=PG&f=1", "display_name": "user3822304", "link": "https://stackoverflow.com/users/3822304/user3822304"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 611, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1428532582, "creation_date": 1428519252, "last_edit_date": 1428519303, "question_id": 29523041, "link": "https://stackoverflow.com/questions/29523041/macro-to-delete-rows-freezes-half-the-time", "title": "Macro to delete rows freezes half the time", "body": "<p>Is there a more efficient way to do the below operation of adding three cell values in  a row to the corresponding cells above and then deleting the old row? Half the time the macro freezes; I am running it on about 12,000 lines (there are no dynamic formulas on the sheet).</p>\n\n<pre><code>Application.ScreenUpdating = False\n\nFor a = Lcell To 2 Step -1\n   If Cells(a, 23).Value = Cells(a - 1, 23).Value Then\n       Cells(a, 16).Value = Cells(a, 16).Value + Cells(a - 1, 16).Value\n       Cells(a, 17).Value = Cells(a, 17).Value + Cells(a - 1, 17).Value\n       Cells(a, 18).Value = Cells(a, 18).Value + Cells(a - 1, 18).Value\n       Cells(a - 1, 1).EntireRow.Delete\n   End If\nNext a\n\nApplication.ScreenUpdating = True\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1428519334, "post_id": 29522989, "comment_id": 47200583, "body": "What have you tried so far? Post back with some code, and what issues you are running into, and many here will be glad to help."}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1428519365, "post_id": 29522989, "comment_id": 47200602, "body": "Any reason you can&#39;t just use the native <a href=\"https://support.office.com/en-ZA/article/average-function-7f473887-4818-4212-b85f-474a5be67b8a\" rel=\"nofollow noreferrer\"><code>AVERAGE</code></a>- and <a href=\"https://support.office.com/en-za/article/STDEVS-function-f4660ce6-414a-4225-b671-925fceccbf7b\" rel=\"nofollow noreferrer\"><code>STDEV.S</code></a>-formulas? For that matter, what have you tried so far?"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 1, "creation_date": 1428519528, "post_id": 29522989, "comment_id": 47200705, "body": "This can be done without VBA with the <code>AVERAGE</code> and <code>STDDEV.S</code> formulas mentioned by @eirikdaude. If you have more than one year and need to filter the data, look at <code>SUMPRODUCT</code>."}, {"owner": {"reputation": 3, "user_id": 4765598, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204877611914143/picture?type=large", "display_name": "CWHz", "link": "https://stackoverflow.com/users/4765598/cwhz"}, "edited": false, "score": 0, "creation_date": 1428526111, "post_id": 29522989, "comment_id": 47204455, "body": "Whoops sorry I should have clarified, I actually have a bunch of workbooks like this one that I want to do this same process on so I want to develop a macro that can do it for me. Up until this point I&#39;ve been recording macros then nesting the recorded code in a VBA snippet I found that loops through all the workbooks in the directory. The reason I can&#39;t do this again is because the workbooks all vary slightly in the amount of data present - eg some are missing years, cell values are not consistent etc."}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1428538163, "post_id": 29522989, "comment_id": 47209164, "body": "If the format of the workbooks isn&#39;t consistent, I suspect you&#39;ll have trouble implementing a solution for this in VBA too."}], "answers": [{"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1428521911, "last_edit_date": 1495541603, "creation_date": 1428521405, "answer_id": 29523704, "question_id": 29522989, "link": "https://stackoverflow.com/questions/29522989/select-values-based-on-another-cells-values-then-calculate-a-statistic-from-th/29523704#29523704", "title": "Select values based on another cell&#39;s values, then calculate a statistic from those cells and put it in a specific cell", "body": "<p>I suggest a PivotTable (one month per table) - <code>Year</code> for ROWS and say <code>April</code> for VALUES (once as Average of and once as StdDev of or StdDevp of).  </p>\n\n<p>Or you might 'flatten' the data (eg as shown <a href=\"https://stackoverflow.com/a/20543651/1505120\">here</a>) and use different views of a single PivotTable:  </p>\n\n<p><img src=\"https://i.stack.imgur.com/ko4rf.jpg\" alt=\"SO29522989 example\"></p>\n"}], "owner": {"reputation": 3, "user_id": 4765598, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204877611914143/picture?type=large", "display_name": "CWHz", "link": "https://stackoverflow.com/users/4765598/cwhz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1428521911, "creation_date": 1428519090, "last_edit_date": 1428521178, "question_id": 29522989, "link": "https://stackoverflow.com/questions/29522989/select-values-based-on-another-cells-values-then-calculate-a-statistic-from-th", "title": "Select values based on another cell&#39;s values, then calculate a statistic from those cells and put it in a specific cell", "body": "<p>I have is a dataset of daily stream runoff values for the past 11 years. It looks like this:</p>\n\n<pre><code>  ID    Year    DD  Apr     May     Jun     Jul     Aug     Sep     Oct \n08HF004 2000    1   26.5    37.6    18.3    12.3    8.35    5.19    7.98                        \n08HF004 2000    2   28.8    25.8    19.3    10.4    6.86    4.61    5.86                        \n08HF004 2000    3   34.7    22.8    25.9    9.32    5.82    4.07    4.71                            \n08HF004 2000    4   29.7    19.4    33.8    9.16    5.5     3.61    4.01                            \n08HF004 2000    5   19.9    17.5    38.6    9.01    5.39    3.32    3.53                            \n08HF004 2000    6   15      14.6    33.1    9.04    5.22    3.32    3.2                     \n08HF004 2000    7   11.6    14.1    27      10.3    4.83    4.55    2.96\n</code></pre>\n\n<p>...and so forth for 400+ more lines. What I want to do is use VBA to select all the values from each month (April 2000, May 2000, etc) and figure out the average and standard deviation from each month and send them to a cell in the worksheet, or a cell in another worksheet, or, ideally, a new workbook in the directory I can just call \"results\".</p>\n"}, {"tags": ["sql", "vba", "listview"], "comments": [{"owner": {"reputation": 2886, "user_id": 12897, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6b592fca6012883dcf8d57ca9f6542ca?s=128&d=identicon&r=PG", "display_name": "CindyH", "link": "https://stackoverflow.com/users/12897/cindyh"}, "edited": false, "score": 0, "creation_date": 1428520263, "post_id": 29522439, "comment_id": 47201139, "body": "MANY problems: 1) setting yourself up for SQL injection by saying &quot;where name = &#39;variable&#39;&quot; (see <a href=\"http://www.w3schools.com/sql/sql_injection.asp\" rel=\"nofollow noreferrer\">w3schools.com/sql/sql_injection.asp</a>) 2)  using old join syntax (see <a href=\"http://www.w3schools.com/sql/sql_join_inner.asp\" rel=\"nofollow noreferrer\">w3schools.com/sql/sql_join_inner.asp</a>) 3) attempting to delete list members from active list (confuses it - <a href=\"http://stackoverflow.com/questions/29464800/cant-remove-items-from-list-with-remove/29465099#29465099\" title=\"cant remove items from list with remove\">stackoverflow.com/questions/29464800/&hellip;</a>) 4) I don&#39;t THINK a dataAdapter &quot;fills&quot; anything on a delete statement.  For an answer about deleting with a join, see <a href=\"http://stackoverflow.com/questions/439750/t-sql-selecting-rows-to-delete-via-joins\" title=\"t sql selecting rows to delete via joins\">stackoverflow.com/questions/439750/&hellip;</a>."}, {"owner": {"reputation": 49, "user_id": 4252293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c5cca80f981d788c95fea67a057e9407?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/4252293/andy"}, "reply_to_user": {"reputation": 2886, "user_id": 12897, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6b592fca6012883dcf8d57ca9f6542ca?s=128&d=identicon&r=PG", "display_name": "CindyH", "link": "https://stackoverflow.com/users/12897/cindyh"}, "edited": false, "score": 0, "creation_date": 1428578620, "post_id": 29522439, "comment_id": 47226504, "body": "1st - doesn&#39;t matter. 2nd there are relationships in which i have now remove the other table so that doesn&#39;t matter. 3rd - ok... 4) that kinda helps                                                                                                             ^You haven&#39;t really helped me at all"}, {"owner": {"reputation": 49, "user_id": 4252293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c5cca80f981d788c95fea67a057e9407?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/4252293/andy"}, "reply_to_user": {"reputation": 2886, "user_id": 12897, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6b592fca6012883dcf8d57ca9f6542ca?s=128&d=identicon&r=PG", "display_name": "CindyH", "link": "https://stackoverflow.com/users/12897/cindyh"}, "edited": false, "score": 0, "creation_date": 1428578701, "post_id": 29522439, "comment_id": 47226551, "body": "+ none of the above helps because i need to delete the selected."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 4252293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c5cca80f981d788c95fea67a057e9407?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/4252293/andy"}, "edited": false, "score": 0, "creation_date": 1428586343, "post_id": 29539228, "comment_id": 47231830, "body": "The main issue is with this line Remove = <code>lstViewMembers.Items(i)</code> it states &quot;Overload resolution failed because no accessible &#39;Item&#39; can be called with these arguments&quot; (quoted)"}, {"owner": {"reputation": 2886, "user_id": 12897, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6b592fca6012883dcf8d57ca9f6542ca?s=128&d=identicon&r=PG", "display_name": "CindyH", "link": "https://stackoverflow.com/users/12897/cindyh"}, "reply_to_user": {"reputation": 49, "user_id": 4252293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c5cca80f981d788c95fea67a057e9407?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/4252293/andy"}, "edited": false, "score": 0, "creation_date": 1428588614, "post_id": 29539228, "comment_id": 47233579, "body": "Updated the answer - it was attempting to use &quot;i&quot; as a list, not a specific item."}], "tags": [], "owner": {"reputation": 2886, "user_id": 12897, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6b592fca6012883dcf8d57ca9f6542ca?s=128&d=identicon&r=PG", "display_name": "CindyH", "link": "https://stackoverflow.com/users/12897/cindyh"}, "is_accepted": false, "score": 0, "last_activity_date": 1428588570, "last_edit_date": 1428588570, "creation_date": 1428584460, "answer_id": 29539228, "question_id": 29522439, "link": "https://stackoverflow.com/questions/29522439/getting-a-list-view-entry-into-a-variable-to-remove-from-database/29539228#29539228", "title": "Getting a list view entry into a variable to remove from database", "body": "<p>I'm assuming that con is an active and open connection, not just a connection string.</p>\n\n<p>In order to 1) make minimal changes, 2) delete it from the database, and 3) leave the deleted items in the VB list, here's what I'd do.  I'm quite unfamiliar with DataAdapters - I know there's a way to delete with them but I haven't used it.</p>\n\n<pre><code>Dim Remove As String\nFor Each itemToDelete As ListViewItem In lstViewMembers.SelectedItems\n    Remove = itemToDelete.Text \n\n    sql = \"DELETE FROM tblMembers WHERE Name = '\" &amp; Remove &amp; \"'\"\n\n    SqlCommand cmd = New SqlCommand (sql, con)\n    cmd.ExecuteNonQuery()\nNext\n</code></pre>\n\n<p>Make sure that you close and remove the connection afterwards - connections are expensive.  For a way to do that, see <a href=\"https://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executenonquery(v=vs.110).aspx?cs-save-lang=1&amp;cs-lang=vb#code-snippet-2\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executenonquery(v=vs.110).aspx?cs-save-lang=1&amp;cs-lang=vb#code-snippet-2</a></p>\n\n<p>In order to reduce the sql-injection risk, look here for the use of parameters <a href=\"https://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.parameters%28v=vs.110%29.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.parameters%28v=vs.110%29.aspx</a></p>\n"}], "owner": {"reputation": 49, "user_id": 4252293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c5cca80f981d788c95fea67a057e9407?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/4252293/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1428588570, "creation_date": 1428517355, "last_edit_date": 1428578448, "question_id": 29522439, "link": "https://stackoverflow.com/questions/29522439/getting-a-list-view-entry-into-a-variable-to-remove-from-database", "title": "Getting a list view entry into a variable to remove from database", "body": "<p>What i am trying to to is get the selected list view item into a variable. More importantly a specific entry in the selected so that i can remove it from the database.</p>\n\n<p>My code:</p>\n\n<pre><code>For Each i As ListViewItem In lstViewMembers.SelectedItems\n        lstViewMembers.Items.Remove(i)\n        Dim Remove As String\n        Remove = lstViewMembers.Items(0)\n\n        sql = \"DELETE FROM tblMembers WHERE Name = '\" &amp; Remove &amp; \"'\"\n        da = New OleDb.OleDbDataAdapter(sql, con)\n        da.Fill(ds, \"Remove\")\n    Next\n</code></pre>\n\n<p>Name is the 2nd column in the list view, how would i remove that selected person from the database using the name?</p>\n\n<p>Thanks,</p>\n\n<p>Andy</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1428517773, "post_id": 29522278, "comment_id": 47199629, "body": "That code only gets the filename. You then have to call Save using that filename <code>If varResult &lt;&gt; False</code>."}], "answers": [{"tags": [], "owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "is_accepted": true, "score": 17, "last_activity_date": 1428520932, "last_edit_date": 1428520932, "creation_date": 1428518542, "answer_id": 29522836, "question_id": 29522278, "link": "https://stackoverflow.com/questions/29522278/how-to-save-a-file-selected-in-save-as-dialog/29522836#29522836", "title": "How to save a file selected in Save As dialog?", "body": "<p>You have to actually explicitly tell Excel to save the workbook.</p>\n\n<pre><code>Sub Mac2()\n        Dim varResult As Variant\n        Dim ActBook As Workbook\n\n        'displays the save file dialog\n        varResult = Application.GetSaveAsFilename(FileFilter:= _\n                 \"Excel Files (*.xlsx), *.xlsx\", Title:=\"Save PO\", _\n                InitialFileName:=\"\\\\showdog\\service\\Service_job_PO\\\")\n\n        'checks to make sure the user hasn't canceled the dialog\n        If varResult &lt;&gt; False Then\n            ActiveWorkbook.SaveAs Filename:=varResult, _\n            FileFormat:=xlWorkbookNormal\n            Exit Sub\n        End If\nEnd Sub\n</code></pre>\n\n<p>Using the <code>GetSaveAsFilename</code> only gets the path of the file to save, whereas the <code>SaveAs</code> method actually saves the workbook.</p>\n\n<p>Upon some consideration, I might suggest using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff835014.aspx\" rel=\"noreferrer\">SaveCopyAs</a> method instead of simply SaveAs.  As the name suggests, this will leave your original workbook in tact and save off a copy.  To do this is a rather simply modification.  </p>\n\n<p>You would replace </p>\n\n<pre><code>ActiveWorkbook.SaveAs Filename:=varResult, _\nFileFormat:=xlWorkbookNormal\n</code></pre>\n\n<p>With</p>\n\n<pre><code>ActiveWorkbook.SaveCopyAs Filename:=varResult \n</code></pre>\n\n<p>One final consideration I would add is that if you save your macro-enabled workbook as a .xlsx (either by SaveAs or the SaveCopyAs) then you will lose the macros, either in your original workbook if you use SaveAs or in the copy that is saved if you use SaveCopyAs.  I would consider saving the file as a .xlsm instead, if you need macros to be available.</p>\n"}, {"tags": [], "owner": {"reputation": 69, "user_id": 7155837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/092d5e6099358a6a3bd382a48d4943c5?s=128&d=identicon&r=PG&f=1", "display_name": "TimAi", "link": "https://stackoverflow.com/users/7155837/timai"}, "is_accepted": false, "score": 6, "last_activity_date": 1575587622, "last_edit_date": 1575587622, "creation_date": 1479113747, "answer_id": 40584926, "question_id": 29522278, "link": "https://stackoverflow.com/questions/29522278/how-to-save-a-file-selected-in-save-as-dialog/40584926#40584926", "title": "How to save a file selected in Save As dialog?", "body": "<p>I prefer to use the shortest code:</p>\n\n<pre><code>    Application.Dialogs(xlDialogSaveAs).Show (\"c:\\my_folder\\\")\n</code></pre>\n\n<p>It's the standard Excel save dialog.</p>\n\n<p>It has several parameters (not named), you may need them:</p>\n\n<pre><code>    Dim strFilename As String: strFilename = \"report1\"\n    Dim strFolder As String: strFolder = \"C:\\temp\\\" 'initial directory - NOTE: Only works if file has not yet been saved!\n    Dim xlfFileFormat As XlFileFormat: xlfFileFormat = XlFileFormat.xlOpenXMLWorkbook 'or replace by other XlFileFormat\n    Dim strPassword As String: 'strPassword = \"password\" 'The password with which to protect the file - if any\n    Dim booBackup As Boolean: 'booBackup = True  '(Whether to create a backup of the file.)\n    Dim strWriteReservationPassword As String: 'strWriteReservationPassword = \"password2\" ' (The write-reservation password of the file.)\n    Dim booReadOnlyRecommendation As Boolean: booReadOnlyRecommendation = False '(Whether to recommend to the user that the file be opened in read-only mode.)\n    Dim booWorkbookSaved As Boolean ' true if file saved, false if dialog canceled\n    If Len(strFolder) &gt; 0 Then ChDir strFolder\n    booWorkbookSaved = Application.Dialogs(xlDialogSaveAs).Show(Arg1:=strFilename, Arg2:=xlfFileFormat, Arg3:=strPassword, _\n            Arg4:=booBackup, Arg5:=strWriteReservationPassword, Arg6:=booReadOnlyRecommendation)\n</code></pre>\n"}], "owner": {"reputation": 311, "user_id": 4625094, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3668fc2b694b942575f32afdef39da31?s=128&d=identicon&r=PG&f=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/4625094/rick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45139, "favorite_count": 2, "accepted_answer_id": 29522836, "answer_count": 2, "score": 11, "last_activity_date": 1578835097, "creation_date": 1428516842, "last_edit_date": 1578835097, "question_id": 29522278, "link": "https://stackoverflow.com/questions/29522278/how-to-save-a-file-selected-in-save-as-dialog", "title": "How to save a file selected in Save As dialog?", "body": "<p>I found code online that opens a Save As dialog to a location on a drive.</p>\n\n<p>When you click \"save\" the file does not save.</p>\n\n<pre><code>Dim varResult As Variant\n'displays the save file dialog\nvarResult = Application.GetSaveAsFilename(FileFilter:= _\n  \"Excel Files (*.xlsx), *.xlsx\", Title:=\"Save PO\", _\n  InitialFileName:=\"\\\\showdog\\service\\Service_job_PO\\\")\n'checks to make sure the user hasn't canceled the dialog\nIf varResult &lt;&gt; False Then\n    Exit Sub\nEnd If \n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2601, "user_id": 1988084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZvqeO.png?s=128&g=1", "display_name": "hexerei software", "link": "https://stackoverflow.com/users/1988084/hexerei-software"}, "is_accepted": false, "score": 0, "last_activity_date": 1428517447, "creation_date": 1428517447, "answer_id": 29522477, "question_id": 29522082, "link": "https://stackoverflow.com/questions/29522082/how-to-copy-down-excel-formulas-on-new-tab-in-vba/29522477#29522477", "title": "how to copy down excel formulas on new tab in vba", "body": "<p>First of all it seems you have a simple typo error in your code. You are declaring <code>LastRow</code> which you are also passing to the <code>AutoFill()</code> function, but you are using <code>EndRow</code> to store what you got from your count, so that for one is a reason you are not getting the expected value.</p>\n\n<p>Also i for myself noticed a sometimes unpredictable behavior depending on Excel version used. There are different methods to count the rows in a Sheet, but from what i have experienced with different versions, this is what i use to get the last row:</p>\n\n<pre><code>' get last row of worksheet\nPublic Function GetWSLastRow(ByRef wsSheet As Worksheet) As Double\n\n    ' simply return 0 if no Worksheet was passed\n    If IsNothing(wsSheet) Then\n        GetWSLastRow = 0\n        Exit Function\n    End If\n\n    ' first we try using Find(any) to get last row\n    On Error GoTo errLRFindError\n    GetWSLastRow = wsSheet.Cells.Find(\"*\", , , , xlByRows, xlPrevious).Row\n    ' if there was no error we will just exit function\n    ' otherwise we jump to next method of determining last row\n\nendGetLastRow:\n    On Error GoTo 0\n    Exit Function\n\nerrLRFindError:\n    ' try getting last row by querying for UsedRange's row count\n    On Error GoTo errLRUsedRangeError\n    GetWSLastRow = wsSheet.UsedRange.Rows.Count\n    Resume endGetLastRow\n\nerrLRUsedRangeError:\n    ' last chance rows count, but you should not end up here anyhow\n    GetWSLastRow = wsSheet.Rows.Count\n    Resume endGetLastRow\n\nEnd Function\n</code></pre>\n\n<p>So then using this function your code would look like this:</p>\n\n<pre><code>Sub CopyFormulas_Down()\n    Dim LastRow As Long\n    LastRow = GetWSLastRow(AccountDetail)\n    MasterDetail.Range(\"A2:AZ2\").AutoFill Destination:=Range(\"A2:AZ\" &amp;   LastRow)\nEnd Sub\n</code></pre>\n\n<p>Or even shorter:</p>\n\n<pre><code>Sub CopyFormulas_Down()\n    MasterDetail.Range(\"A2:AZ2\").AutoFill Destination:=Range(\"A2:AZ\" &amp;   GetWSLastRow(AccountDetail))\nEnd Sub\n</code></pre>\n\n<p>Hope that was it.</p>\n"}], "owner": {"reputation": 11, "user_id": 4765216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8957a46c072b486be37b612bfdf0cffb?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Carlson", "link": "https://stackoverflow.com/users/4765216/scott-carlson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1428517447, "creation_date": 1428516180, "question_id": 29522082, "link": "https://stackoverflow.com/questions/29522082/how-to-copy-down-excel-formulas-on-new-tab-in-vba", "title": "how to copy down excel formulas on new tab in vba", "body": "<p>I have an Excel workbook with 2 tabs. The \"AccountDetail\" tab contains multiple variable rows of data (including one header row). The \"MasterDetail\" tab has 2 rows of data (row 1 is a header row, row 2 is a row of formulas).</p>\n\n<p>I want to count the number of data rows on the AccountDetail tab and copy down the formulas on the MasterDetail tab for the equivalent number of rows with data from the AccountDetail tab. This is what I have so far. I could use some suggestions.</p>\n\n<pre><code>Sub CopyFormulas_Down()\nDim LastRow As Long\n\nEndRow = AccountDetail.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nMasterDetail.Range(\"A2:AZ2\").AutoFill Destination:=Range(\"A2:AZ\" &amp;   LastRow)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 4738553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66fdeeb05a4d8f40c5b213782f0a918e?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Frouin", "link": "https://stackoverflow.com/users/4738553/emily-frouin"}, "is_accepted": false, "score": 1, "last_activity_date": 1428516285, "creation_date": 1428516285, "answer_id": 29522117, "question_id": 29521787, "link": "https://stackoverflow.com/questions/29521787/if-the-cell-has-values-select-the-same-quantity-of-lines-in-another-sheet/29522117#29522117", "title": "If The cell has values, select the same quantity of lines in another Sheet", "body": "<p>If you are inputing your data such that each line is filled from the first line down to some line you can find the last row number with the following, where \"A\" is the column the data is in.</p>\n\n<pre><code>Dim sht As Worksheet\nSet sht = ThisWorkbook.Sheets(\"Sheet1\")\nlastrow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\n</code></pre>\n\n<p>Then you can go through the data with a loop like:</p>\n\n<pre><code>For each cell in sht.Range(\"A1:A\" &amp; lastrow)\n    'do something with cell\nnext cell\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4616246, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153070709409757/picture?type=large", "display_name": "Alan Ramos", "link": "https://stackoverflow.com/users/4616246/alan-ramos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1428536130, "creation_date": 1428515345, "last_edit_date": 1428536130, "question_id": 29521787, "link": "https://stackoverflow.com/questions/29521787/if-the-cell-has-values-select-the-same-quantity-of-lines-in-another-sheet", "title": "If The cell has values, select the same quantity of lines in another Sheet", "body": "<p>In my first sheet I insert 389 lines of text, it makes a process and appears in sheet 3 fully processed, but I need to select the same number of lines in the Sheet 3, then copy it.</p>\n\n<p>The main problem is that the quantity of lines that I insert in the first sheet can be from 1 to 10,000.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4586706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131aad3256c0d72a7c760bb329561901?s=128&d=identicon&r=PG&f=1", "display_name": "priyanka -", "link": "https://stackoverflow.com/users/4586706/priyanka"}, "edited": false, "score": 0, "creation_date": 1428515877, "post_id": 29521818, "comment_id": 47198495, "body": "Tried that too..Doesn&#39;t work..gives #Ref error.I think Indirect doesn&#39;t work on closed files."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "reply_to_user": {"reputation": 21, "user_id": 4586706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131aad3256c0d72a7c760bb329561901?s=128&d=identicon&r=PG&f=1", "display_name": "priyanka -", "link": "https://stackoverflow.com/users/4586706/priyanka"}, "edited": false, "score": 0, "creation_date": 1428515967, "post_id": 29521818, "comment_id": 47198553, "body": "What is the exact text contained in cell <code>C3</code>? This indirect should work, but may not if your other worksheet is not open."}, {"owner": {"reputation": 21, "user_id": 4586706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131aad3256c0d72a7c760bb329561901?s=128&d=identicon&r=PG&f=1", "display_name": "priyanka -", "link": "https://stackoverflow.com/users/4586706/priyanka"}, "edited": false, "score": 0, "creation_date": 1428516103, "post_id": 29521818, "comment_id": 47198634, "body": "Yeah,my other file will be closed.The exact text in C3 is Week02;which shall change(i am taking care of that by a different formula) every week.Next week it will be Week03."}], "tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": false, "score": 0, "last_activity_date": 1428515436, "creation_date": 1428515436, "answer_id": 29521818, "question_id": 29521680, "link": "https://stackoverflow.com/questions/29521680/how-to-link-files-in-excel-with-a-text-in-the-path-changing-dynamically/29521818#29521818", "title": "How to link files in excel with a text in the path changing dynamically?", "body": "<p>Try <code>=INDIRECT()</code>:</p>\n\n<pre><code>=INDIRECT(\"\\T:\\Datafile\\weekdata\\2015\\\"&amp;C3&amp;\"[Summary.xlsx]Sales'!D4\")\n</code></pre>\n\n<p>This function does exactly what you are trying to do, takes a built string and makes it a cell reference.</p>\n"}, {"tags": [], "owner": {"reputation": 1079, "user_id": 1013057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fed36038bc7b83917ab133352aff619?s=128&d=identicon&r=PG", "display_name": "minnow", "link": "https://stackoverflow.com/users/1013057/minnow"}, "is_accepted": false, "score": 0, "last_activity_date": 1428524909, "last_edit_date": 1495541603, "creation_date": 1428524551, "answer_id": 29524631, "question_id": 29521680, "link": "https://stackoverflow.com/questions/29521680/how-to-link-files-in-excel-with-a-text-in-the-path-changing-dynamically/29524631#29524631", "title": "How to link files in excel with a text in the path changing dynamically?", "body": "<p>The problem with <code>=INDIRECT()</code> is that it only works if the source workbook is open:</p>\n\n<blockquote>\n  <p>If the source workbook is not open, INDIRECT returns the #REF! error value. </p>\n</blockquote>\n\n<p>(That quote is from <a href=\"https://support.office.com/en-sg/article/INDIRECT-function-21f8bcfc-b174-4a50-9dc6-4dfb5b3361cd\" rel=\"nofollow noreferrer\">https://support.office.com/en-sg/article/INDIRECT-function-21f8bcfc-b174-4a50-9dc6-4dfb5b3361cd</a>)</p>\n\n<p>By googling \"excel convert text to formula\" I found this SO Q&amp;A: <a href=\"https://stackoverflow.com/questions/4471884/turn-a-string-formula-into-a-real-formula\">How to turn a string formula into a &quot;real&quot; formula</a></p>\n\n<p>If you don't like the VBA solution, I had success with \niDevlop's <code>=EVALUATE()</code> solution.</p>\n"}], "owner": {"reputation": 21, "user_id": 4586706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131aad3256c0d72a7c760bb329561901?s=128&d=identicon&r=PG&f=1", "display_name": "priyanka -", "link": "https://stackoverflow.com/users/4586706/priyanka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1637, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1428524909, "creation_date": 1428515009, "last_edit_date": 1428519049, "question_id": 29521680, "link": "https://stackoverflow.com/questions/29521680/how-to-link-files-in-excel-with-a-text-in-the-path-changing-dynamically", "title": "How to link files in excel with a text in the path changing dynamically?", "body": "<p>I have a file which needs to fetch data accordingly every week.\nLet us say the formula to get data in a cell is</p>\n\n<pre><code>=\\T:\\Datafile\\weekdata\\2015\\Week01\\[Summary.xlsx]Sales'!D4\n</code></pre>\n\n<p>I have a cell in the sheet C3 which changes every week accordingly.It will change to week02 next week and i wish the path to change too..to</p>\n\n<pre><code>=\\T:\\Datafile\\weekdata\\2015\\Week02\\[Summary.xlsx]Sales'!D4\"\n</code></pre>\n\n<p>I tried doing a concatenation to make the path dynamic </p>\n\n<pre><code>=\"\\T:\\Datafile\\weekdata\\2015\\\"&amp;C3&amp;\"\\[Summary.xlsx]Sales'!D4\"\n</code></pre>\n\n<p>but it doesn't seem to work out.I checked evaluate formula and it resolves C3 to Week02 but the value doesn't come in the cell.In stead just the below text </p>\n\n<pre><code>\\T:\\Datafile\\weekdata\\2015\\Week02\\[Summary.xlsx]Sales'!D4 \n</code></pre>\n\n<p>appears in the cell instead of any number.</p>\n\n<p>Let me know where am i going wrong and how to resolve it.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1428513958, "post_id": 29521245, "comment_id": 47197372, "body": "You don&#39;t you just create a reference to the cell as a formula?"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1428520064, "post_id": 29521245, "comment_id": 47201011, "body": "ExecuteExcel4Macro call prohibited within UDF, to be precise while UDF is working. But there are few work-arounds that allow to avoid such limitations. See <a href=\"http://stackoverflow.com/a/23232311/2165759\">this</a> and <a href=\"http://stackoverflow.com/a/23437280/2165759\">this</a> and <a href=\"http://stackoverflow.com/a/8711582/2165759\">this</a>. Also here is the similar <a href=\"http://stackoverflow.com/q/22565356/2165759\">question</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4756706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6bb7f18e1887063e55757e3b6c4c14c?s=128&d=identicon&r=PG&f=1", "display_name": "mistre42", "link": "https://stackoverflow.com/users/4756706/mistre42"}, "edited": false, "score": 0, "creation_date": 1428542546, "post_id": 29525428, "comment_id": 47210359, "body": "Great assistance, thank you very much!  Now I must learn exactly what you did.  You gave me a good explanation so I should be able to get through it.  Thanks again."}], "tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": false, "score": 1, "last_activity_date": 1428528235, "last_edit_date": 1428528235, "creation_date": 1428527532, "answer_id": 29525428, "question_id": 29521245, "link": "https://stackoverflow.com/questions/29521245/a-function-within-a-function-in-vba/29525428#29525428", "title": "A function within a function in vba?", "body": "<p>I suggest one of possible workarounds. The approach is as follows: while UDFs are executing, <code>ExecuteExcel4Macro()</code> is being called as a method of late bound <code>Excell.Application</code> instance, but not via host <code>Application</code> object that would give an error. So, that instance should be created and stay accessible while workbook is opened, and be quitted to release OS resources just before workbook closing. Here is the code below.</p>\n\n<p>Place this code into VBAProject Module:</p>\n\n<pre><code>Function ExcelApp()\n    Static objApp As New clsExcelApp\n    Set ExcelApp = objApp.ExcelApp\nEnd Function\n\nFunction xxDay(row) ' the code this function contains is almost all yours\n    Dim fName, Path, strSheet, strRef, strRng As Variant\n\n    xxDay = \"\"\n    Path = \"C:\\Test\\\"\n    fName = \"Source.xlsx\"\n    strSheet = \"Sheet1\"\n    strRng = Cells(row, 3).Address(, , xlR1C1)\n    strRef = \"'\" &amp; Path &amp; \"[\" &amp; fName &amp; \"]\" &amp; strSheet &amp; \"'!\" &amp; strRng\n\n    xxDay = ExcelApp.ExecuteExcel4Macro(strRef) ' reference to ExcelApp object\n\nEnd Function\n</code></pre>\n\n<p>Create Class Module, assign it the name <code>clsExcelApp</code>, and place this code into it:</p>\n\n<pre><code>Public ExcelApp\n\nPrivate Sub Class_Initialize()\n    Set ExcelApp = CreateObject(\"Excel.Application\")\n    ' ExcelApp.Visible = True ' uncomment for debug\nEnd Sub\n\nPrivate Sub Class_Terminate()\n    ExcelApp.Quit ' the only class purpose is to quit app anyway at the end\n    Set ExcelApp = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4756706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6bb7f18e1887063e55757e3b6c4c14c?s=128&d=identicon&r=PG&f=1", "display_name": "mistre42", "link": "https://stackoverflow.com/users/4756706/mistre42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1815, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1428528235, "creation_date": 1428513572, "last_edit_date": 1531164843, "question_id": 29521245, "link": "https://stackoverflow.com/questions/29521245/a-function-within-a-function-in-vba", "title": "A function within a function in vba?", "body": "<p>Here is a simplified version of a function I use in a cell (=xxDay(B7) for example) to retrieve a day from a closed workbook:</p>\n\n<pre><code>    Function xxDay(row)\n\n        Dim fName, Path, strSheet, strRef, strRng As Variant\n\n        xxDay = \"\"\n        Path = \"C:\\MMS\\\"\n        fName = \"Book1.xlsm\"\n        strSheet = \"Sheet1\"\n        strRng = Cells(row, 3).Address(, , xlR1C1)\n        strRef = \"'\" &amp; Path &amp; \"[\" &amp; fName &amp; \"]\" &amp; strSheet &amp; \"'!\" &amp; strRng\n\n        xxDay = ExecuteExcel4Macro(strRef)\n\n    End Function\n</code></pre>\n\n<p>I get a #VALUE returned in the cell.  I run it as Sub and it will return the expected results.  Is it possible to have a function call another function within itself?</p>\n\n<pre><code>    Sub SubxxDay()\n\n        Dim fName, Path, strSheet, strRef, strRng, xxDay, row As Variant\n\n        row = 7\n        xxDay = \"\"\n        Path = \"C:\\MMS\\\"\n        fName = \"Book1.xlsm\"\n        strSheet = \"Sheet1\"\n        strRng = Cells(row, 3).Address(, , xlR1C1)\n        strRef = \"'\" &amp; Path &amp; \"[\" &amp; fName &amp; \"]\" &amp; strSheet &amp; \"'!\" &amp; strRng\n\n        xxDay = ExecuteExcel4Macro(strRef)\n\n        MsgBox xxDay\n    End Sub\n</code></pre>\n\n<p>Much appreciate any response.</p>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1428513226, "post_id": 29521050, "comment_id": 47196972, "body": "Do you really have a sheet called <code>priceDATES</code>?"}, {"owner": {"reputation": 55, "user_id": 2886346, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f83962942e5f355293848c949f3cb343?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/2886346/joseph"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1428514411, "post_id": 29521050, "comment_id": 47197644, "body": "@GSerg yes i have a sheet called pricesDATES and yes is not necessarily to overwrite the variable"}], "answers": [{"tags": [], "owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "is_accepted": false, "score": 0, "last_activity_date": 1431198809, "last_edit_date": 1431198809, "creation_date": 1428517036, "answer_id": 29522339, "question_id": 29521050, "link": "https://stackoverflow.com/questions/29521050/vlookup-error-code-9-subindex-out-of-interval/29522339#29522339", "title": "VLOOKUP error code 9, subindex out of interval", "body": "<p>Try this procedure and let me know if it works:</p>\n\n<pre><code>Sub add_vlookup()\nDim i As Long\nWith Sheets(\"inserts\")\n    For i = 2 To .UsedRange.Rows.Count\n        .Cells(i, 3).Formula = \"=VLOOKUP(\" &amp; _\n        .Cells(i, 1).Address &amp; \",priceDATES!$A:$B,2,0)\"\n    Next\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 2886346, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f83962942e5f355293848c949f3cb343?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/2886346/joseph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1431198809, "creation_date": 1428512917, "last_edit_date": 1428518707, "question_id": 29521050, "link": "https://stackoverflow.com/questions/29521050/vlookup-error-code-9-subindex-out-of-interval", "title": "VLOOKUP error code 9, subindex out of interval", "body": "<p>After looking for some solutions and trying different ways to develop the <code>VLOOKUP</code> function in Excel VBA, I still receive the same error.</p>\n\n<p>I have a worksheet called \"priceDATES\" where I have to find the <em>id</em> of each date that is in the other worksheet.</p>\n\n<pre><code>id_date = Cells(cursor_fecha, 1).Value \nid_date = Application.WorksheetFunction.VLookup(id_date, _\n    ThisWorkbook.Sheets(\"priceDATES\").Range(\"A1:B500\"), 2, False)\n</code></pre>\n\n<p>The error message:</p>\n\n<blockquote>\n  <p>Error number 9 in execution time<br>\n  Subindex out of interval</p>\n</blockquote>\n"}, {"tags": ["vba", "excel", "listboxitems", "automated-deployment"], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 3794203, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cba2a1760eb1c8f18f60de42d7070f21?s=128&d=identicon&r=PG&f=1", "display_name": "user3794203", "link": "https://stackoverflow.com/users/3794203/user3794203"}, "edited": false, "score": 0, "creation_date": 1428527021, "post_id": 29522680, "comment_id": 47204948, "body": "Thank you for your suggestion!  I have implemented this change and am getting a Compile Error: Method or data member not found that refers to the: &quot;With Workbooks(Vval)&quot; line... I have stored the public variable within the beginning of the Module."}, {"owner": {"reputation": 212, "user_id": 4556092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/528a167862c6b00144b7b938e09181af?s=128&d=identicon&r=PG&f=1", "display_name": "shagans", "link": "https://stackoverflow.com/users/4556092/shagans"}, "edited": false, "score": 0, "creation_date": 1428613756, "post_id": 29522680, "comment_id": 47249654, "body": "When someone selects a value in Listbox1, what does the value look like in Vval?"}, {"owner": {"reputation": 185, "user_id": 3794203, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cba2a1760eb1c8f18f60de42d7070f21?s=128&d=identicon&r=PG&f=1", "display_name": "user3794203", "link": "https://stackoverflow.com/users/3794203/user3794203"}, "reply_to_user": {"reputation": 212, "user_id": 4556092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/528a167862c6b00144b7b938e09181af?s=128&d=identicon&r=PG&f=1", "display_name": "shagans", "link": "https://stackoverflow.com/users/4556092/shagans"}, "edited": false, "score": 0, "creation_date": 1428680283, "post_id": 29522680, "comment_id": 47280424, "body": "@shagans - Do you mean in the Immediate window?"}, {"owner": {"reputation": 212, "user_id": 4556092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/528a167862c6b00144b7b938e09181af?s=128&d=identicon&r=PG&f=1", "display_name": "shagans", "link": "https://stackoverflow.com/users/4556092/shagans"}, "edited": false, "score": 0, "creation_date": 1428692379, "post_id": 29522680, "comment_id": 47287043, "body": "I mean during run-time debug. I ask because it&#39;s possible what vVal is storing is not a valid format for Workbooks(vVal) so knowing what the string is that you&#39;re passing in will help suss out potential issues."}], "tags": [], "owner": {"reputation": 36, "user_id": 4738553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66fdeeb05a4d8f40c5b213782f0a918e?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Frouin", "link": "https://stackoverflow.com/users/4738553/emily-frouin"}, "is_accepted": true, "score": 1, "last_activity_date": 1428518028, "creation_date": 1428518028, "answer_id": 29522680, "question_id": 29521016, "link": "https://stackoverflow.com/questions/29521016/recall-user-selections-within-multiple-modules/29522680#29522680", "title": "Recall User Selections Within Multiple Modules", "body": "<p>Firstly, you should be using the public variable vVal that you assigned in the DblClick event. Public variables persist, userform values don't.</p>\n\n<p>Next, you have to tell VBA that the value is a workbook, <code>Workbooks(vVal)</code></p>\n\n<p>Lastly, inside of a <code>With</code> you should only be performing actions on the <code>With</code> object. </p>\n\n<p>So if MYDATA is a worksheet in the vVal workbook:</p>\n\n<pre><code>With Workbooks(vVal)\n   .Worksheets(\"MYDATA\").Range(\"D2:D103\").Select\nEnd With\n</code></pre>\n\n<p><em>Note the period that prefixes Worksheets</em></p>\n"}], "owner": {"reputation": 185, "user_id": 3794203, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cba2a1760eb1c8f18f60de42d7070f21?s=128&d=identicon&r=PG&f=1", "display_name": "user3794203", "link": "https://stackoverflow.com/users/3794203/user3794203"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 29522680, "answer_count": 1, "score": 0, "last_activity_date": 1428611482, "creation_date": 1428512820, "last_edit_date": 1428611482, "question_id": 29521016, "link": "https://stackoverflow.com/questions/29521016/recall-user-selections-within-multiple-modules", "title": "Recall User Selections Within Multiple Modules", "body": "<p>My current code uses the Workbook_Open event to run a userform that asks what the user wants to do, if they select \"A\" it populates a userform with a listbox that displays all open workbooks.name(s). Using the ListBox_DblClick event, I want the user to be able to double-click the name of the workbook that they wish to make active to the run some tasks that involve copying information from one sheet (a workbook that is exported to a temporary folder with an semi-impossible naming system) into a workbook that I know the name and location of. I cannot seem to get the listbox value to be recalled after the double-click event.  Any pointers?</p>\n\n<p>Code within Userform2:</p>\n\n<pre><code>Option Explicit\nPublic Vval As String\nPrivate Sub ListBox1_DblClick(ByVal Cancel As MSForms.ReturnBoolean)\nVval = Me.ListBox1.Value\nCall AUTOMATEME\nUnload Me\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\nDim wkb As Workbook\nWith Me.ListBox1\n    For Each wkb In Application.Workbooks\n        .AddItem wkb.Name\n    Next wkb\nEnd With\nEnd Sub\n</code></pre>\n\n<p><strong>The sub that the double-click event calls (the one that I am having problems with) is:</strong></p>\n\n<pre><code>Sub AUTOMATEME()\n\nWith Listbox1.Value\nWorksheets(\"MYDATA\").Range(\"D2:D103\").Select\nSelection.Copy\nWorkbooks(\"ALL_Data.xlsm\").Worksheets(\"FORMULAS\").Select\nRange(\"G2\").Select\nActiveSheet.Paste\nSheets(\"FORMULAS\").Select\nListBox1.Value.Select\nRange(\"E2:E103\").Select\nSelection.Copy\nWorkbooks(\"ALL_Data.xlsm\").Worksheets(\"FORMULAS\").Select\nRange(\"G2\").Select\nRange(\"E2\").Select\nActiveSheet.Paste\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Thank you for any help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1428536835, "post_id": 29520495, "comment_id": 47208796, "body": "Does it work if you use:<code>Range_To_Send.Address(External:= True)</code>?"}, {"owner": {"reputation": 1, "user_id": 4199491, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/16e38fd49f18c97a0c6ff3b148e4203d?s=128&d=identicon&r=PG&f=1", "display_name": "IFeelYourPain", "link": "https://stackoverflow.com/users/4199491/ifeelyourpain"}, "reply_to_user": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 1, "creation_date": 1428599744, "post_id": 29520495, "comment_id": 47241224, "body": "Thank you sir! That worked perfect!"}], "answers": [{"tags": [], "owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "is_accepted": false, "score": 1, "last_activity_date": 1428633640, "creation_date": 1428633640, "answer_id": 29552437, "question_id": 29520495, "link": "https://stackoverflow.com/questions/29520495/email-macro-works-in-2010-but-not-2013/29552437#29552437", "title": "Email Macro works in 2010 but not 2013?", "body": "<p>I'm going to throw my comment up here as an answer:</p>\n\n<p>Change <code>Source:=Range_To_Send.Address</code> to</p>\n\n<p><code>Source:=Range_To_Send.Address(External:=True)</code></p>\n\n<p>I was guessing that was the answer. I think it has to do with Excel 2013 switching to the \"Single Document Interface,\" which means each workbook is in its own window, as Word has been for a while. While working recently on some VBA that involved windows, I noticed that each window seems to have a separate Application object. I'm not sure is that's accurate, but it prompted the answer above, which fully identifies the workbook path, under the theory that might help communication between applications.</p>\n\n<p>I'm glad I guessed right and that it solved your problem.</p>\n"}], "owner": {"reputation": 1, "user_id": 4199491, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/16e38fd49f18c97a0c6ff3b148e4203d?s=128&d=identicon&r=PG&f=1", "display_name": "IFeelYourPain", "link": "https://stackoverflow.com/users/4199491/ifeelyourpain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1428633640, "creation_date": 1428511151, "last_edit_date": 1428511503, "question_id": 29520495, "link": "https://stackoverflow.com/questions/29520495/email-macro-works-in-2010-but-not-2013", "title": "Email Macro works in 2010 but not 2013?", "body": "<p>This code worked in 2010, but now it doesn't work in 2013, it use to pop up a new window which displayed my info inputted into my excel worksheet. I'm not quiet sure why it's not working, and sometimes the code will work, and sometimes it won't. Doesn't make much sense. I was hoping someone could take a look and see what's going on.</p>\n\n<pre><code>Sub Email()    Dim Bytedata()  As Byte\nDim HTMLcode    As String\nDim HTMLfile    As Object\nDim olApp       As Object\nDim TempFile    As String\nDim Wks         As Worksheet\n\n\n    Set Wks = ActiveSheet\n\n\n    Set Range_To_Send = Wks.Range(\"A1:G29\")\n\n    TempFile = Environ(\"Temp\") &amp; \"\\Temp Email.htm\"\n\n        Set olApp = CreateObject(\"Outlook.Application\")\n\n        With Wks.Parent.PublishObjects\n            .Add(SourceType:=xlSourceRange, _\n                Filename:=TempFile, Sheet:=Wks.Name, _\n                Source:=Range_To_Send.Address, HtmlType:=xlHtmlStatic) _\n            .Publish Create:=True\n        End With\n\n        Open TempFile For Binary Access Read As #1\n            ReDim Bytedata(LOF(1))\n            Get #1, , Bytedata\n        Close #1\n\n        HTMLcode = StrConv(Bytedata, vbUnicode)\n\n        HTMLcode = VBA.Replace(HTMLcode, \"align=center x:publishsource=\", \"align=left x:publishsource=\")\n\n        olApp.Session.getdefaultFolder 6\n\n        With olApp.CreateItem(olMailItem)\n            Select Case Range(\"B2\")\n            Case \"A\"\n            .To = ThisWorkbook.Sheets(\"A\").Range(\"A1\").Value\n            Case \"B\"\n            .To = ThisWorkbook.Sheets(\"B\").Range(\"A1\").Value\n            Case \"C\"\n            .To = ThisWorkbook.Sheets(\"C\").Range(\"A1\").Value\n            Case \"D\"\n            .To = ThisWorkbook.Sheets(\"D\").Range(\"A1\").Value\n            Case \"E\"\n            .To = ThisWorkbook.Sheets(\"E\").Range(\"A1\").Value\n            Case \"F\"\n            .To = ThisWorkbook.Sheets(\"F\").Range(\"A1\").Value\n            Case \"G\"\n            .To = ThisWorkbook.Sheets(\"G\").Range(\"A1\").Value\n            End Select\n            .cc = \"service_djdh@yahoo.com\"\n            If InStr(Time, \"AM\") &gt; 0 Then\n            .Subject = \"AM\"\n            Else\n            .Subject = \"PM\"\n            End If\n            .BodyFormat = 2\n            .HTMLBody = HTMLcode\n            .Display\n        End With\n\n    Kill TempFile\n    Wks.Parent.PublishObjects.Delete\n    Range(\"B11\").Value = \"\"\n    Range(\"B17\").Value = \"\"\n    Range(\"B18\").Value = \"\"\n    Range(\"B19\").Value = \"\"\n    Range(\"B20\").Value = \"\"\n    Range(\"B12\").Value = \"\"\n    Range(\"B22\").Value = \"\"\n    Range(\"B50\").Value = \"0\"\n    Range(\"B51\").Value = \"0\"\n    End Sub\n</code></pre>\n\n<p>It says there is an error and takes me to this code:</p>\n\n<pre><code>            .Add(SourceType:=xlSourceRange, _                    Filename:=TempFile, Sheet:=Wks.Name, _\n                Source:=Range_To_Send.Address, HtmlType:=xlHtmlStatic) _\n            .Publish Create:=True\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 737, "user_id": 2758404, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1fe0bbb8e4cd4f438d7983282ed91dbe?s=128&d=identicon&r=PG&f=1", "display_name": "Mahdi Jazini", "link": "https://stackoverflow.com/users/2758404/mahdi-jazini"}, "edited": false, "score": 0, "creation_date": 1428511128, "post_id": 29520368, "comment_id": 47195698, "body": "but unfortunately the xlFillValues property just copied the number 1 (that was in the B6) to all other cells!!! anyway tnx for your time :("}, {"owner": {"reputation": 737, "user_id": 2758404, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1fe0bbb8e4cd4f438d7983282ed91dbe?s=128&d=identicon&r=PG&f=1", "display_name": "Mahdi Jazini", "link": "https://stackoverflow.com/users/2758404/mahdi-jazini"}, "edited": false, "score": 0, "creation_date": 1428512165, "post_id": 29520368, "comment_id": 47196358, "body": "actually i was searching for a low level way (fast way) like xlFillSeries that officially registered in excel... so, it seems that this low speed way is the only way. anyway tnx for the time :("}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": true, "score": 1, "last_activity_date": 1428511387, "last_edit_date": 1428511387, "creation_date": 1428510747, "answer_id": 29520368, "question_id": 29520281, "link": "https://stackoverflow.com/questions/29520281/how-to-auto-fill-data-only-not-format/29520368#29520368", "title": "How to auto fill data only (not format)", "body": "<p><strike>According to the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838605%28v=office.14%29.aspx\" rel=\"nofollow\">MS Docs</a>*, it seems that <code>xlFillValues</code> would be your best bet:</p>\n\n<blockquote>\n  <p>Copy only the values from the source range to the target range, repeating if necessary.</strike></p>\n</blockquote>\n\n<p>All the other options explicitly state that they will copy formatting. It looks like your only options are:</p>\n\n<ul>\n<li>remove the formatting from the destination cells after copying</li>\n<li>not have formatting to copy by:\n<ol>\n<li>save off the formatting</li>\n<li>remove the formatting from the source cell</li>\n<li>do the <code>.AutoFill</code></li>\n<li>then restore the formatting to the source cell</li>\n</ol></li>\n</ul>\n\n<p><sup>*found by a Google search for \"excel vba .autofill\"</sup></p>\n"}], "owner": {"reputation": 737, "user_id": 2758404, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1fe0bbb8e4cd4f438d7983282ed91dbe?s=128&d=identicon&r=PG&f=1", "display_name": "Mahdi Jazini", "link": "https://stackoverflow.com/users/2758404/mahdi-jazini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1912, "favorite_count": 0, "accepted_answer_id": 29520368, "answer_count": 1, "score": 0, "last_activity_date": 1428511387, "creation_date": 1428510489, "last_edit_date": 1531164843, "question_id": 29520281, "link": "https://stackoverflow.com/questions/29520281/how-to-auto-fill-data-only-not-format", "title": "How to auto fill data only (not format)", "body": "<p>In Cell B6 there is number 1 and its color is red. but other cells are not red and there is no any data in them. after executing the following code, from B6 to B18, will be filled with numbers 1 ~ 13 but here there is a problem! i don't want to copy red color of B6 to B7 ... B8 ... B9 ... and ... i just need to copy without format of the base cell...</p>\n\n<pre><code>    Range(\"B6\").FormulaR1C1 = \"1\"\n    Range(\"B6\").AutoFill Destination:=Range(\"B6:B18\"),Type:=xlFillSeries\n</code></pre>\n\n<p>Can i find something like this property: xlFillSeriesWithoutFormat or a way to do this?</p>\n"}, {"tags": ["excel", "vba", "private-methods"], "comments": [{"owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "edited": false, "score": 0, "creation_date": 1428511948, "post_id": 29520051, "comment_id": 47196212, "body": "Is book <code>Y</code> being opened via VBA?  Or are you opening the book manually?"}, {"owner": {"reputation": 29, "user_id": 4453929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b75f633c5e946ed685ce0b46f753764b?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/4453929/felipe"}, "reply_to_user": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "edited": false, "score": 0, "creation_date": 1428512583, "post_id": 29520051, "comment_id": 47196609, "body": "Manually. Normal double click!"}, {"owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "edited": false, "score": 0, "creation_date": 1428514746, "post_id": 29520051, "comment_id": 47197859, "body": "I like Siphor&#39;s answer, seems to fit.  The only other suggestion I would add is to open book <code>Y</code> in a new instance of Excel.  So go to Start --&gt; Programs --&gt; Excel to open up a separate instance and drag and drop the file on to that instance.  It&#39;s a bit cumbersome but it keeps things separate for me."}, {"owner": {"reputation": 29, "user_id": 4453929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b75f633c5e946ed685ce0b46f753764b?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/4453929/felipe"}, "reply_to_user": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "edited": false, "score": 0, "creation_date": 1428515255, "post_id": 29520051, "comment_id": 47198156, "body": "The problem is that several people open that file. So I cannot tell everyone to do it. I just want to make a way that x workbook macro just run within itself."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 4453929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b75f633c5e946ed685ce0b46f753764b?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/4453929/felipe"}, "edited": false, "score": 0, "creation_date": 1428515168, "post_id": 29520765, "comment_id": 47198105, "body": "Hi Siphor. Thx! But, it hasn&#39;t really worked out. Shall I paste it into workbook &quot;X&quot;?"}, {"owner": {"reputation": 29, "user_id": 4453929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b75f633c5e946ed685ce0b46f753764b?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/4453929/felipe"}, "edited": false, "score": 1, "creation_date": 1428606174, "post_id": 29520765, "comment_id": 47245120, "body": "Hi Siphor. I&#39;ve used your tip together with another trick. I have used a kind of shortcut together with that. I&#39;ve used a module as well:  If ActiveWorkbook.Name = &quot;NAME.xlsm&quot; Then Call CleanCell1_1"}], "tags": [], "owner": {"reputation": 2484, "user_id": 3276974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1afcb9c8d126ce27cdac2e2db19c57fb?s=128&d=identicon&r=PG&f=1", "display_name": "Siphor", "link": "https://stackoverflow.com/users/3276974/siphor"}, "is_accepted": true, "score": 0, "last_activity_date": 1428512023, "creation_date": 1428512023, "answer_id": 29520765, "question_id": 29520051, "link": "https://stackoverflow.com/questions/29520051/avoid-macro-running-in-another-excel-file/29520765#29520765", "title": "Avoid macro running in another Excel file", "body": "<p>I would activate/deactivate the Application.OnKey when the X workbook is active/not active<br>\nLike this:<br>\nIn ThisWorkbook:</p>\n\n<pre><code>Private Sub Workbook_Activate() \n    Application.OnKey \"{DELETE}\", \"CleanCell1_1\"\n    Application.OnKey \"{BACKSPACE}\", \"CleanCell1_1\"\nEnd Sub\n\nPrivate Sub Workbook_Deactivate() \n    Application.OnKey \"{DELETE}\", \"\"\n    Application.OnKey \"{BACKSPACE}\", \"\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 4453929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b75f633c5e946ed685ce0b46f753764b?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/4453929/felipe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1787, "favorite_count": 0, "accepted_answer_id": 29520765, "answer_count": 1, "score": 0, "last_activity_date": 1428512023, "creation_date": 1428509911, "last_edit_date": 1428510286, "question_id": 29520051, "link": "https://stackoverflow.com/questions/29520051/avoid-macro-running-in-another-excel-file", "title": "Avoid macro running in another Excel file", "body": "<p>This code is associated with a .xlsm file, lets say, <code>X</code>. When I open <code>X</code> file and then open a second file <code>Y</code>, the macro from <code>X</code> runs into <code>Y</code> as well when \"delete\" or \"backspace\" is pressed in <code>Y</code>. Moreover, if I open <code>X</code> and <code>Y</code> and then close <code>X</code>, but <code>Y</code> is still opened - if I press \"delete\" or \"backspace\" in <code>Y</code>, <code>X</code> file will be automatically opened. So, I want to avoid that, I want that the code in <code>X</code> just run inside <code>X</code>. Hope it isn't too confused!</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim TestCell\nDim RE As Object\nDim REMatches As Object\nDim Cell1_1 As String\nDim Today As String\nDim Cell As String\n\nThisRow = Target.Row\n\nWith Worksheets(\"Input\")\nApplication.OnKey \"{DELETE}\", \"CleanCell1_1\"\n\nApplication.OnKey \"{BACKSPACE}\", \"CleanCell1_1\"\nEnd With\n\nIf Target.Column = 9 Then\n\nApplication.ScreenUpdating = False\n\nActiveSheet.Unprotect\nColumns(\"I:I\").Columns.AutoFit\nSheets(\"Input\").Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _\n        , AllowFormattingCells:=True\n    Sheets(\"Input\").EnableSelection = xlUnlockedCells\n\nSheets(\"Chart\").Unprotect\nSheets(\"Chart\").Columns(\"B:B\").Columns.AutoFit\nSheets(\"Chart\").Protect DrawingObjects:=True, Contents:=True, Scenarios:=True\nSheets(\"Chart\").EnableSelection = xlNoRestrictions\n\nApplication.ScreenUpdating = True\n\nEnd If\n\nIf Target.Column = 10 Then\n\nSet RE = CreateObject(\"vbscript.regexp\")\n\nWith RE\n    .MultiLine = False\n    .Global = False\n    .IgnoreCase = True\n    .Pattern = \"[G,g,Y,y,R,r]\"\nEnd With\n\nFor Each TestCell In Target.Cells\n\nSet REMatches = RE.Execute(TestCell.Value)\n\nIf REMatches.Count &gt; 0 And Len(Target.Value) = 1 Then\n    If Len(Cells(1, 1).Value) = 1 Then\n        Today = Now()\n        Cell1_1 = Sheets(\"Input\").Cells(1, 1).Value\n        Range(\"K\" &amp; ThisRow) = Cell1_1 + \": \" + Format(Today, \"ddmmmyy\")\n    End If\n\nElseIf Target.Value &lt;&gt; vbNullString Then\n     Row = Target.Row\n     Cells(Row, 10).Value = vbNullString\n     MsgBox \"Please, type only:\" &amp; vbNewLine &amp; vbNewLine &amp; \"G for Green\" &amp; vbNewLine &amp; \"Y for Yellow\" &amp; vbNewLine &amp; \"R for Red\"\n\nEnd If\n\nNext\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "import", "text-files"], "answers": [{"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 1, "last_activity_date": 1428547134, "creation_date": 1428547134, "answer_id": 29528793, "question_id": 29519916, "link": "https://stackoverflow.com/questions/29519916/visual-basic-importing-multiple-textfiles-into-multiple-sheets/29528793#29528793", "title": "Visual Basic: Importing multiple textfiles into multiple sheets", "body": "<p>You were very close. Recording macros is an excellent way to start learning to script your own custom functions. In this case, you were not using the new worksheet you were adding. So add the new sheet, correctly name it, then use that sheet to import the data.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub ExtDataToSheets()\n    Dim fnames() As String\n    Dim fname As Variant\n    Dim fullpath As String\n    Dim newSh As Worksheet\n\n    fnames = Split(\"file1.txt,file2.txt,file3.txt\", \",\")\n\n    For Each fname In fnames\n        fullpath = Application.Path &amp; fname\n        Set newSh = ActiveWorkbook.Sheets.Add\n        newSh.Name = fname\n        With newSh.QueryTables.Add(Connection:=\"TEXT;C:\\Temp\\SampleData.csv\", _\n            Destination:=Range(\"$A$1\"))\n            .Name = \"SampleData\"\n            .FieldNames = True\n            .RowNumbers = False\n            .FillAdjacentFormulas = False\n            .PreserveFormatting = True\n            .RefreshOnFileOpen = False\n            .RefreshStyle = xlInsertDeleteCells\n            .SavePassword = False\n            .SaveData = True\n            .AdjustColumnWidth = True\n            .RefreshPeriod = 0\n            .TextFilePromptOnRefresh = False\n            .TextFilePlatform = 437\n            .TextFileStartRow = 1\n            .TextFileParseType = xlDelimited\n            .TextFileTextQualifier = xlTextQualifierDoubleQuote\n            .TextFileConsecutiveDelimiter = False\n            .TextFileTabDelimiter = False\n            .TextFileSemicolonDelimiter = False\n            .TextFileCommaDelimiter = True\n            .TextFileSpaceDelimiter = False\n            .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1)\n            .TextFileTrailingMinusNumbers = True\n            .Refresh BackgroundQuery:=False\n        End With\n    Next fname\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 1789172, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3abff9c778ddee3581a7e55723dfe54f?s=128&d=identicon&r=PG", "display_name": "Stijn", "link": "https://stackoverflow.com/users/1789172/stijn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 29528793, "answer_count": 1, "score": 0, "last_activity_date": 1428547134, "creation_date": 1428509525, "question_id": 29519916, "link": "https://stackoverflow.com/questions/29519916/visual-basic-importing-multiple-textfiles-into-multiple-sheets", "title": "Visual Basic: Importing multiple textfiles into multiple sheets", "body": "<p>All data is stored in text files. I have multiple of these files and I want to import each in a new sheet that bears the name of the file.</p>\n\n<p>I recorded a macro so that it imports the data to the correct specifications. Afterwards, I added the part where it repeats this process for every file in the directory.</p>\n\n<p>The result of my code is that it creates a new sheet with the correct name for each file, but the sheets are empty.</p>\n\n<pre><code>Sub ImportTextfiles()\n    Dim folderName As String, filePathName As String, FileName As String\n\n    folderName = \"C:\\Users\\MyName\\Documents\\MultipleFiles\\\"\n    FileName = Dir(folderName, vbNormal)\n\n    While FileName &lt;&gt; \"\"\n        filePathName = folderName &amp; FileName\n        Sheets.Add.Name = FileName\n        With ActiveSheet.QueryTables.Add(Connection:= _\n            \"TEXT;\" &amp; filePathName, _\n            Destination:=Range(\"$A$1\"))\n            .Name = FileName\n            .FieldNames = True\n            .RowNumbers = False\n            .FillAdjacentFormulas = False\n            .PreserveFormatting = True\n            .RefreshOnFileOpen = False\n            .RefreshStyle = xlInsertDeleteCells\n            .SavePassword = False\n            .SaveData = True\n            .AdjustColumnWidth = True\n            .RefreshPeriod = 0\n            .TextFilePromptOnRefresh = False\n            .TextFilePlatform = 1251\n            .TextFileStartRow = 1\n            .TextFileParseType = xlFixedWidth\n            .TextFileTextQualifier = xlTextQualifierDoubleQuote\n            .TextFileConsecutiveDelimiter = False\n            .TextFileTabDelimiter = True\n            .TextFileSemicolonDelimiter = False\n            .TextFileCommaDelimiter = False\n            .TextFileSpaceDelimiter = False\n            .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, _\n        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)\n            .TextFileFixedColumnWidths = Array(37, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, _\n        10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, _\n        10, 10, 10, 10, 10)\n            .TextFileDecimalSeparator = \".\"\n            .TextFileThousandsSeparator = \",\"\n        End With\n        FileName = Dir()\n    Wend\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "email", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1428577609, "creation_date": 1428577609, "answer_id": 29536808, "question_id": 29519781, "link": "https://stackoverflow.com/questions/29519781/outlook-2010-rule-to-forward-emails-with-attachment-at-specific-time/29536808#29536808", "title": "Outlook 2010 Rule to forward emails with attachment at specific time", "body": "<p>You can create a rule in Outlook and then assign a VBA macro to forward the incoming email if it meets your conditions. The macro sub should look like the following one:</p>\n\n<pre><code>public sub test(mail as MailItem)\n  ' do whatever you need here\nend sub\n</code></pre>\n\n<p>where the mail object represents the incoming email.</p>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff865399(v=office.15).aspx\" rel=\"nofollow\">Forward</a> method of the MailItem class executes the Forward action for an item and returns the resulting copy as a MailItem object. For example, the following sample illustrates how to use the Forward method:</p>\n\n<pre><code>Sub RemoveAttachmentBeforeForwarding()  \n  Dim myinspector As Outlook.Inspector  \n  Dim myItem As Outlook.MailItem  \n  Dim myattachments As Outlook.Attachments \n\n  Set myinspector = Application.ActiveInspector  \n  If Not TypeName(myinspector) = \"Nothing\" Then  \n    Set myItem = myinspector.CurrentItem.Forward  \n    Set myattachments = myItem.Attachments   \n    While myattachments.Count &gt; 0  \n      myattachments.Remove 1  \n    Wend  \n    myItem.Display  \n    myItem.Recipients.Add \"Eugene Astafiev\"  \n    myItem.Send  \n  Else  \n    MsgBox \"There is no active inspector.\"  \n  End If \nEnd Sub\n</code></pre>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869452(v=office.15).aspx\" rel=\"nofollow\">DeferredDeliveryTime</a> property of the MailItem class allows to set a Date indicating the date and time the mail message is to be delivered.</p>\n\n<p>Finally, you may find the <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736(v=office.14).aspx\" rel=\"nofollow\">Getting Started with VBA in Outlook 2010</a> article helpful. </p>\n"}], "owner": {"reputation": 1467, "user_id": 2781389, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c4a555c9080ea83580d13541743e633?s=128&d=identicon&r=PG&f=1", "display_name": "M06H", "link": "https://stackoverflow.com/users/2781389/m06h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 769, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593156430, "creation_date": 1428509155, "last_edit_date": 1593156430, "question_id": 29519781, "link": "https://stackoverflow.com/questions/29519781/outlook-2010-rule-to-forward-emails-with-attachment-at-specific-time", "title": "Outlook 2010 Rule to forward emails with attachment at specific time", "body": "<p>On a Daily basis, I receive hourly emails that includes attachment and has a subject in the following format <code>2014-02-13 emailAlert</code>. </p>\n\n<p>Is there rule/VBA I can follow to <code>forward</code> this email <code>with attachment</code> to someone automatically <code>everyday</code> at a <code>specific time</code>. </p>\n\n<p>It should forward only the <code>newest</code> email with the subject <code>emailAlert</code> at that specific point in time. </p>\n\n<p>Appreciate if you guys can help :-)</p>\n"}, {"tags": ["class", "excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1428509692, "post_id": 29519751, "comment_id": 47194866, "body": "You didn&#39;t set <code>IDRange</code>"}, {"owner": {"reputation": 6397, "user_id": 1472743, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f205382e9fa00ee4bdf653ec92a34679?s=128&d=identicon&r=PG", "display_name": "dwstein", "link": "https://stackoverflow.com/users/1472743/dwstein"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1428511923, "post_id": 29519751, "comment_id": 47196195, "body": "@TimWilliams I made the change and now get a different error. I edited the question to account for your comment."}, {"owner": {"reputation": 6397, "user_id": 1472743, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f205382e9fa00ee4bdf653ec92a34679?s=128&d=identicon&r=PG", "display_name": "dwstein", "link": "https://stackoverflow.com/users/1472743/dwstein"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1428512306, "post_id": 29519751, "comment_id": 47196434, "body": "@JNevill In my Locals widow I see     <code>: AgentEmail : &lt;Method &#39;VLookup&#39; of object &#39;WorksheetFunction&#39; failed&gt; : String</code>"}, {"owner": {"reputation": 6397, "user_id": 1472743, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f205382e9fa00ee4bdf653ec92a34679?s=128&d=identicon&r=PG", "display_name": "dwstein", "link": "https://stackoverflow.com/users/1472743/dwstein"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1428512892, "post_id": 29519751, "comment_id": 47196778, "body": "now i&#39;m thinking the IDRange needs to include the worksheet??"}], "answers": [{"comments": [{"owner": {"reputation": 6397, "user_id": 1472743, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f205382e9fa00ee4bdf653ec92a34679?s=128&d=identicon&r=PG", "display_name": "dwstein", "link": "https://stackoverflow.com/users/1472743/dwstein"}, "edited": false, "score": 0, "creation_date": 1428513471, "post_id": 29520731, "comment_id": 47197106, "body": "I&#39;m still getting an error.  I&#39;m wondering if IDRange isn&#39;t specific enough.  ie. do I need to somehow include the worksheet?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 6397, "user_id": 1472743, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f205382e9fa00ee4bdf653ec92a34679?s=128&d=identicon&r=PG", "display_name": "dwstein", "link": "https://stackoverflow.com/users/1472743/dwstein"}, "edited": false, "score": 0, "creation_date": 1428513614, "post_id": 29520731, "comment_id": 47197176, "body": "What is the range? Is the range in the same workbook? If not, is the range in a workbook that is open?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 6397, "user_id": 1472743, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f205382e9fa00ee4bdf653ec92a34679?s=128&d=identicon&r=PG", "display_name": "dwstein", "link": "https://stackoverflow.com/users/1472743/dwstein"}, "edited": false, "score": 0, "creation_date": 1428515124, "post_id": 29520731, "comment_id": 47198087, "body": "Updated with some thoughts"}, {"owner": {"reputation": 6397, "user_id": 1472743, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f205382e9fa00ee4bdf653ec92a34679?s=128&d=identicon&r=PG", "display_name": "dwstein", "link": "https://stackoverflow.com/users/1472743/dwstein"}, "edited": false, "score": 0, "creation_date": 1428516739, "post_id": 29520731, "comment_id": 47199034, "body": "that&#39;s a good call.  I&#39;ll go look at everything.  I think i need a class property for vlookp range."}, {"owner": {"reputation": 6397, "user_id": 1472743, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f205382e9fa00ee4bdf653ec92a34679?s=128&d=identicon&r=PG", "display_name": "dwstein", "link": "https://stackoverflow.com/users/1472743/dwstein"}, "edited": false, "score": 1, "creation_date": 1428525144, "post_id": 29520731, "comment_id": 47203945, "body": "The IDRange was for just one column where I needed the whole sheet.  I added a search range property and the whole think worked fine.  Thanks again!"}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 0, "last_activity_date": 1428515115, "last_edit_date": 1428515115, "creation_date": 1428511912, "answer_id": 29520731, "question_id": 29519751, "link": "https://stackoverflow.com/questions/29519751/how-to-set-up-readonly-property-in-excel-vba-class-module/29520731#29520731", "title": "how to set up readonly property in excel vba class module", "body": "<p>Everything here looks fine to me. I've tested it myself and it worked as I believe you expect it should. </p>\n\n<p>The only thing I see going wrong is if your <code>agent_Range.TargetRange</code> has less than 9 columns, since that's what you are looking up in your vlookup with <code>Const AgentEmailCol = 9</code></p>\n\n<h2>Based on your updated question/code:</h2>\n\n<p>It looks like this bit in your <code>clsWorkingRange.set_range()</code> function only returns a range with a single column. You can't do a <code>vlookup</code> that fetches from the 9th column in a 1 column sized range. You'll need to make sure that agent_Range.TargetRange is set to something that is at least 9 columns wide. Check the output of your <code>Debug.Print agent_Individual.IDRange.Address</code> to confirm. </p>\n"}], "owner": {"reputation": 6397, "user_id": 1472743, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f205382e9fa00ee4bdf653ec92a34679?s=128&d=identicon&r=PG", "display_name": "dwstein", "link": "https://stackoverflow.com/users/1472743/dwstein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1867, "favorite_count": 0, "accepted_answer_id": 29520731, "answer_count": 1, "score": 1, "last_activity_date": 1428515115, "creation_date": 1428509094, "last_edit_date": 1531164843, "question_id": 29519751, "link": "https://stackoverflow.com/questions/29519751/how-to-set-up-readonly-property-in-excel-vba-class-module", "title": "how to set up readonly property in excel vba class module", "body": "<p>I have the following in a class module called <code>clsAgent</code>:</p>\n\n<pre><code>Option Explicit\nConst AgentEmailCol = 9\nPrivate pAgentSheetName As String\nPrivate pIDRange As Range\nPrivate pAgentID As String\nPrivate pAgentEmail As String\n\nPublic Property Get AgentSheetName() As String\n    AgentSheetName = pAgentSheetName\nEnd Property\n\nPublic Property Let AgentSheetName(AgentSheetName As String)\n    pAgentSheetName = AgentSheetName\nEnd Property\n\nPublic Property Get IDRange() As Range\n    Set IDRange = pIDRange\nEnd Property\n\nPublic Property Set IDRange(IDRange As Range)\n    Set pIDRange = IDRange\nEnd Property\n\nPublic Property Get AgentID() As String\n    AgentID = pAgentID\nEnd Property\n\nPublic Property Let AgentID(AgentID As String)\n    pAgentID = AgentID\nEnd Property\n\n\nPublic Property Get AgentEmail() As String\n    AgentEmail = WorksheetFunction.VLookup(Me.AgentID, Me.IDRange, AgentEmailCol, False)\nEnd Property\n</code></pre>\n\n<p>in a class called <code>clsWorkingRange</code> I have:</p>\n\n<pre><code>Option Explicit\n\nPrivate pSheetName As String\nPrivate pColNum As Integer\nPrivate pTargetRange As Range\n\nPublic Property Get SheetName() As String\n    SheetName = pSheetName\nEnd Property\n\nPublic Property Let SheetName(SheetName As String)\n    pSheetName = SheetName\nEnd Property\n\n\nPublic Property Get ColNum() As Integer\n    ColNum = pColNum\nEnd Property\n\nPublic Property Let ColNum(ColNum As Integer)\n    pColNum = ColNum\nEnd Property\n\n\nPublic Property Get TargetRange() As Range\n    Set TargetRange = pTargetRange\nEnd Property\n\nPublic Property Set TargetRange(TargetRange As Range)\n    Set pTargetRange = TargetRange\nEnd Property\n\n\nPrivate Function Get_Rows_Generic(work_sheet_get As String, column_num As Integer)\n'worksheet is the name of a sheet in the form of a string\n    Dim ws As Worksheet:             Set ws = Worksheets(work_sheet_get)\n    Dim rows_count As Long:        rows_count = ws.Cells(rows.Count, column_num).End(xlUp).Row\n    Get_Rows_Generic = rows_count\nEnd Function\n\nPublic Function set_range(sheet_name As String, col1 As Integer) As Range\n'   returns the range of a given column using all the rows in a street\n    Dim rows1 As Long\n    rows1 = Get_Rows_Generic(sheet_name, 1)\n    Dim range1 As Range ' range of first search\n    With Worksheets(sheet_name)\n        Set range1 = .Range(.Cells(1, col1), .Cells(rows1, col1)) ' set the range being searched first\n    End With\n\n    Set set_range = range1\nEnd Function\n</code></pre>\n\n<p>I have a class called <code>clsWorkingSheet</code>:</p>\n\n<pre><code>Option Explicit\n\nPrivate pSheetName As String\nPrivate pSheet As Worksheet\n\nPublic Property Get SheetName() As String\n    SheetName = pSheetName\nEnd Property\n\nPublic Property Let SheetName(SheetName As String)\n    pSheetName = SheetName\nEnd Property\n\nPublic Property Get Sheet() As Worksheet\n    Set Sheet = pSheet\nEnd Property\n\nPublic Property Set Sheet(Sheet As Worksheet)\n    Set pSheet = Sheet\nEnd Property\n</code></pre>\n\n<p>In a separate module I have the following:</p>\n\n<pre><code>Sub test_agent_class()\n\nDim agent_Sheet As clsWorkingSheet\nSet agent_Sheet = New clsWorkingSheet\n\nagent_Sheet.SheetName = \"agentsFullOutput.csv\"\nSet agent_Sheet.Sheet = Worksheets(agent_Sheet.SheetName)\n\nDim agent_Range As clsWorkingRange\nSet agent_Range = New clsWorkingRange\n\nSet agent_Range.TargetRange = agent_Range.set_range(agent_Sheet.SheetName, 1)\n\nDim agent_Individual As clsAgent\nSet agent_Individual = New clsAgent\n\nSet agent_Individual.IDRange = agent_Range.TargetRange\n        Debug.Print agent_Individual.IDRange.Address\n\nagent_Individual.AgentID = \"ObjectID(52d56512763f4a1c608b4753)\"\n        Debug.Print agent_Individual.AgentID\n        Debug.Print agent_Individual.AgentEmail\n\nend sub\n</code></pre>\n\n<p>I get the following error: <code>Run-time error '1004': Method 'AgentEmail' of object 'clsAgent' failed</code></p>\n\n<p>\u00b8</p>\n"}, {"tags": ["vba", "unix"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1428509346, "post_id": 29519617, "comment_id": 47194623, "body": "Try having a look at <a href=\"https://social.msdn.microsoft.com/Forums/en-US/39e02965-754b-4bab-8c9a-6e43890f1701/passing-commands-to-unix-from-vba-excel?forum=isvvba\" rel=\"nofollow noreferrer\">this</a>, it seems what you need."}], "answers": [{"tags": [], "owner": {"reputation": 5111, "user_id": 1359088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f4ffb15d50db85cc68143626a8e0046?s=128&d=identicon&r=PG", "display_name": "James Toomey", "link": "https://stackoverflow.com/users/1359088/james-toomey"}, "is_accepted": false, "score": 0, "last_activity_date": 1428588034, "last_edit_date": 1495542491, "creation_date": 1428588034, "answer_id": 29540671, "question_id": 29519617, "link": "https://stackoverflow.com/questions/29519617/run-unix-command-via-vba-and-return-the-results-in-excel-spreadsheet/29540671#29540671", "title": "Run Unix Command via VBA and return the results in Excel Spreadsheet", "body": "<p>The hardest part is getting the file from the Unix box over to your Windows computer. You have a few different approaches to this:</p>\n\n<p>1) Here's a purely VBA approach. You'll need to download the free command-line version of Putty called plink from <a href=\"http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html\" rel=\"nofollow noreferrer\">here</a>. In this approach you're streaming the data on your command-line and transferring the data into a local text file.</p>\n\n<pre><code>cmd = \"C:\\MyUtilities\\plink.exe -pw PASSWORD USERNAME@IPADDRESS cat /dataops/profits/name.csv\"\n\nSet datafile = CreateObject(\"Scripting.FileSystemObject\").CreateTextFile(\"c:\\name.csv\", True)\n\nSet WshShell = CreateObject(\"WScript.Shell\")\nSet oExec = WshShell.Exec(cmd)\nDo While oExec.Status = 0\n   If Not oExec.StdOut.AtEndOfStream Then\n      datafile.WriteLine oExec.StdOut.Readall\n   End If\nLoop\ndatafile.Close\n</code></pre>\n\n<p>2) Another approach would be to run a Windows scheduled task batch file that uses FTP to transfer the file over, as explained <a href=\"https://stackoverflow.com/questions/16158138/how-to-ftp-with-a-batch-file\">here</a>. Personally I think this will be your best bet, because the VBA code can be focused on just loading up the file, rather than connecting to Unix and getting the file too.</p>\n\n<p>3) If you have a Samba share set up on your Unix server for a directory, then you'll be able to see that directory from Windows and can just go there to get the file. </p>\n\n<p>Once you have the file on your Windows computer, you can open Excel and load the file like this:</p>\n\n<pre><code>Set xl = CreateObject(\"Excel.Application\")\nxl.Visible = True\nSet wb = xl.Workbooks.Open(\"c:\\name.csv\")\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 3768039, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/d9c31dcd51743b05aea7b75dc25e69c8?s=128&d=identicon&r=PG&f=1", "display_name": "walkens", "link": "https://stackoverflow.com/users/3768039/walkens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 8021, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1611666460, "creation_date": 1428508776, "last_edit_date": 1428509241, "question_id": 29519617, "link": "https://stackoverflow.com/questions/29519617/run-unix-command-via-vba-and-return-the-results-in-excel-spreadsheet", "title": "Run Unix Command via VBA and return the results in Excel Spreadsheet", "body": "<p>I have this Unix command </p>\n\n<pre><code>cat /dataops/profits/name.csv\n</code></pre>\n\n<p>Can I save it to a <code>.txt</code> file and run via VBA Macro, and then automatically return the results into my Excel spreadsheet? </p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 0, "last_activity_date": 1428512023, "last_edit_date": 1428512023, "creation_date": 1428510944, "answer_id": 29520443, "question_id": 29519473, "link": "https://stackoverflow.com/questions/29519473/using-variables-in-pivot-data-source/29520443#29520443", "title": "Using variables in pivot data source", "body": "<p>You are having syntax issues: missing quotation and breaking lines within object reference. These errors are caught by the compiler before any run of the code.  Also, use the <code>Cells()</code> reference instead of <code>R1C1</code> address reference. Plus, you are combining a string reference to a workbook and worksheet with a Range Address.</p>\n\n<p>Therefore, consider using declared variables (and be sure to uninitialize):</p>\n\n<pre><code>Dim wkb As Workbook, wks As Worksheet\nDim SourceRng As Range\nDim NewCache As PivotCache\n\nSet wkb = Workbooks.Open(\"C:\\Users\\test_h\\Downloads\\New folder\\Book1.xlsm\")\nSet wks = wkb.Sheets(\"Sheet1\")\nSet SourceRng = wks.Range(Cells(1, 1), Cells(30, 14))\nSet NewCache = ActiveWorkbook.PivotCaches.Create( _\n                     SourceType:=xlDatabase, _\n                     SourceData:=SourceRng, _\n                     Version:=xlPivotTableVersion14)\n\nActiveSheet.PivotTables(\"PivotTable1\").ChangePivotCache NewCache\n\nSet wkb = Nothing\nSet wks = Nothing\nSet SourceRng = Nothing\nSet NewCache = Nothing\n</code></pre>\n\n<p>Usually for readability it helps to break arguments into different lines. Of course this is just a personal preference.</p>\n"}], "owner": {"reputation": 11, "user_id": 2421185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be863896f1f5c0745edc580e90bcb4c0?s=128&d=identicon&r=PG", "display_name": "user2421185", "link": "https://stackoverflow.com/users/2421185/user2421185"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 861, "favorite_count": 0, "accepted_answer_id": 29520443, "answer_count": 1, "score": 1, "last_activity_date": 1428512023, "creation_date": 1428508392, "last_edit_date": 1428509017, "question_id": 29519473, "link": "https://stackoverflow.com/questions/29519473/using-variables-in-pivot-data-source", "title": "Using variables in pivot data source", "body": "<p>I would like to replace:</p>\n\n<p><code>C:\\Users\\test_h\\Downloads\\New folder\\[Book1.xlsm]</code> and <code>Sheet1</code> with a variable from the code below:  </p>\n\n<pre><code>ActiveSheet.PivotTables(\"PivotTable1\").ChangePivotCache ActiveWorkbook. _\n\n PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n\n \"C:\\Users\\test_h\\Downloads\\New folder\\[Book1.xlsm]Sheet1!R1C1:R30C14\", Version _\n :=xlPivotTableVersion14)\n</code></pre>\n\n<hr>\n\n<p>I've tried, but cannot get it to work:</p>\n\n<pre><code>Sub test(sht As String, path_name As String)\n\n   ActiveSheet.PivotTables(\"PivotTable1\").ChangePivotCache ActiveWorkbook. _\n\n   PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n\n   path_name &amp; sht &amp; !R1C1:R30C14\", Version _\n\n   :=xlPivotTableVersion14)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1428509987, "post_id": 29519172, "comment_id": 47195045, "body": "You should be able to find places online that answer similar questions. Have you tried anything so far? A recorded macro would actually get you pretty close on this."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4764774, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-o02MjCOpEz0/AAAAAAAAAAI/AAAAAAAAAGc/tHgCE3X7Hck/photo.jpg?sz=128", "display_name": "Kevin Foster", "link": "https://stackoverflow.com/users/4764774/kevin-foster"}, "edited": false, "score": 0, "creation_date": 1428516721, "post_id": 29520313, "comment_id": 47199018, "body": "This does copy the table the way I want, but what I&#39;m not sure of is how to make it go two columns over at the end of it. I&#39;ve tried the code and it just recopies it at the same spot, aka A1:B10 of sheet 2..."}, {"owner": {"reputation": 11, "user_id": 4764774, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-o02MjCOpEz0/AAAAAAAAAAI/AAAAAAAAAGc/tHgCE3X7Hck/photo.jpg?sz=128", "display_name": "Kevin Foster", "link": "https://stackoverflow.com/users/4764774/kevin-foster"}, "edited": false, "score": 0, "creation_date": 1428518174, "post_id": 29520313, "comment_id": 47199895, "body": "I&#39;m currently cheating doing an IF/Else combo, 10 times, so taht each time it checks if there is something and if there is it moves over by whats in my else. It&#39;s not pretty, but I guess it does the trick!"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 11, "user_id": 4764774, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-o02MjCOpEz0/AAAAAAAAAAI/AAAAAAAAAGc/tHgCE3X7Hck/photo.jpg?sz=128", "display_name": "Kevin Foster", "link": "https://stackoverflow.com/users/4764774/kevin-foster"}, "edited": false, "score": 0, "creation_date": 1428518888, "post_id": 29520313, "comment_id": 47200333, "body": "The magic is in the <code>End(xlToLeft).Offset(0, 1)</code> part. This definition of the destination range should pick the first empty column by starting at the farthest right column possible (<code>IV1</code>) and then searching back to the left (<code>xlToLeft</code>) to find the first non-empty cell --- then offset that non-empty cell one column to the right (<code>Offset(0,1)</code>. Each time I ran the code above, the table from Sheet1 was copied to the next empty column on Sheet2. Did you change this line?"}, {"owner": {"reputation": 11, "user_id": 4764774, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-o02MjCOpEz0/AAAAAAAAAAI/AAAAAAAAAGc/tHgCE3X7Hck/photo.jpg?sz=128", "display_name": "Kevin Foster", "link": "https://stackoverflow.com/users/4764774/kevin-foster"}, "edited": false, "score": 0, "creation_date": 1428519722, "post_id": 29520313, "comment_id": 47200808, "body": "I left it exactly like you did, for some reason it only posts the first column. nothing else appears after I click the button numerous times."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 11, "user_id": 4764774, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-o02MjCOpEz0/AAAAAAAAAAI/AAAAAAAAAGc/tHgCE3X7Hck/photo.jpg?sz=128", "display_name": "Kevin Foster", "link": "https://stackoverflow.com/users/4764774/kevin-foster"}, "edited": false, "score": 0, "creation_date": 1428525435, "post_id": 29520313, "comment_id": 47204088, "body": "I updated the code snippet to store the next column location in a helper cell. See if that works for you. I&#39;m not sure why the previous version didn&#39;t work."}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 0, "last_activity_date": 1428525380, "last_edit_date": 1428525380, "creation_date": 1428510600, "answer_id": 29520313, "question_id": 29519172, "link": "https://stackoverflow.com/questions/29519172/excel-cycle-through-columns-and-rows/29520313#29520313", "title": "Excel, cycle through columns and rows", "body": "<p>What you should learn in VBA and modify in this code below is how to determine the actual range of the table on Sheet1 -- instead of hard-coding it to <code>\"A1:B10\"</code></p>\n\n<p><strong>UPDATE</strong>\nNot sure why the previous version didn't work for you, but I've updated the code below to store the next column location in a helper cell to see if that works for you.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub Button1_Click()\n    Dim srcTable As Range\n    Dim dstTable As Range\n    Dim nextLoc As Range\n    Set srcTable = Sheets(\"Sheet1\").Range(\"A1:B10\")\n    Set nextLoc = Sheets(\"Sheet2\").Range(\"A20\")\n\n    '--- if this is your first copy, then cell A1 should be empty\n    If IsEmpty(Sheets(\"Sheet2\").Range(\"A1\").Value) Then\n        Set dstTable = Sheets(\"Sheet2\").Range(\"A1:B10\")\n        nextLoc.Value = 3                           'next location is column 3\n    Else\n        '--- we're adding the next table...\n        Set dstTable = Sheets(\"Sheet2\").Cells(1, nextLoc.Value)\n        nextLoc.Value = nextLoc.Value + 2\n    End If\n    srcTable.Copy dstTable\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4764774, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-o02MjCOpEz0/AAAAAAAAAAI/AAAAAAAAAGc/tHgCE3X7Hck/photo.jpg?sz=128", "display_name": "Kevin Foster", "link": "https://stackoverflow.com/users/4764774/kevin-foster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 324, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1428525380, "creation_date": 1428507487, "question_id": 29519172, "link": "https://stackoverflow.com/questions/29519172/excel-cycle-through-columns-and-rows", "title": "Excel, cycle through columns and rows", "body": "<p>I have an excel table that calculates how many materials we need to order per job we are doing. </p>\n\n<p>What I want to accomplish is to create a button that will copy the existing table on to page 2 of my excel workbook.  The table is two columns wide. Therefore I would like to click the button, it copies the table thats on A and B of page 1 onto page 2 A and B. After having done so, I want excel to remember A and B are taken and next time I click the button, it goes in column C and D, then E and F and so on (always on page 2).</p>\n\n<p>to explain why I would like this, I need to order 1000 sq ft of materials, but in sections. only 250 sq ft of materials at a time. So, I want to fill out how much im ordering, click the button and it saves the information of what was ordered on page 2. That way its easy to go back and see what was done, what date, how much was ordered, what is left to order, etc. </p>\n\n<p>I know with numbers it would be easy by just incrementing i by two at every button click, but I dont know how to go about doing this for the excel columns (letters). </p>\n\n<p>Is there some easy command I just cannot find online to do this sort of thing ?  </p>\n\n<p>Thanks for your help !</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1428507286, "post_id": 29519030, "comment_id": 47193219, "body": "CF doesn&#39;t alter the <code>Interior.Color</code> property. You&#39;d be better off using a formula that counts the cells matching your conditions. From 2010 there is a <code>Displayformat</code> property that reflects the displayed format but it won&#39;t work in a UDF called from a cell."}, {"owner": {"reputation": 573, "user_id": 4565151, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/0JnyG.jpg?s=128&g=1", "display_name": "AJ_91", "link": "https://stackoverflow.com/users/4565151/aj-91"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1428507487, "post_id": 29519030, "comment_id": 47193375, "body": "Ah well i didnt know that did i. Thanks for the help, pointed me in the right direction :))"}], "answers": [{"tags": [], "owner": {"reputation": 471, "user_id": 4616423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86a46559e4c3f1704e0ba1ddfa70cc88?s=128&d=identicon&r=PG&f=1", "display_name": "rgo", "link": "https://stackoverflow.com/users/4616423/rgo"}, "is_accepted": false, "score": 1, "last_activity_date": 1428539091, "creation_date": 1428539091, "answer_id": 29527635, "question_id": 29519030, "link": "https://stackoverflow.com/questions/29519030/counting-coloured-cells-doesnt-work-with-conditional-formatting-in-excel/29527635#29527635", "title": "Counting coloured cells doesn&#39;t work with conditional formatting in Excel", "body": "<p>That's because conditional formatting is not part of the Interior.color collection and as such cannot be read or counted. Depending on what the underlying value is in the cell with the conditional formatting you can count the literal values instead.</p>\n\n<p>For example, set the cell values to Red, Green, Yellow but set the conditional formatting to set the background and foreground colors the same. (i.e. red on red, green on green, etc.) This way you have something to count. Use the values you are interpreting to get to the conditional color as the column to count by.</p>\n"}], "owner": {"reputation": 573, "user_id": 4565151, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/0JnyG.jpg?s=128&g=1", "display_name": "AJ_91", "link": "https://stackoverflow.com/users/4565151/aj-91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1229, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1428539091, "creation_date": 1428507135, "last_edit_date": 1428514377, "question_id": 29519030, "link": "https://stackoverflow.com/questions/29519030/counting-coloured-cells-doesnt-work-with-conditional-formatting-in-excel", "title": "Counting coloured cells doesn&#39;t work with conditional formatting in Excel", "body": "<p>Trying to count the number of certain coloured cells on my worksheet using this peice of VBA code : </p>\n\n<pre><code>Function CountRed(MyRange)\nCountRed = 0\nFor Each Cell In MyRange\nIf Cell.Interior.Color = RGB(255, 0, 0) Then\nCountRed = CountRed + 1\nEnd If\nNext Cell\nEnd Function\n</code></pre>\n\n<p>Basically, counts the number of red cells. Now this works fine if I colour them myself but if i put conditional formatting in my worksheet to colour these cells it doesnt work.</p>\n\n<p>Here is my condition : </p>\n\n<pre><code>=AND(NOT(ISBLANK(A3)),ISBLANK(D3))\n</code></pre>\n\n<p>Basically if the first cell is populated and this one is not then colour it red. </p>\n\n<p>Now when I use my 'CountRed' function to see if this cell (the one with the conditional formatting) is red it doesnt work, but when I 'overwrite' it, i.e fill it Red myself and run the function again it works.</p>\n\n<p>I thought maybe it's to do with the conditional formatting being called before the CountRed function but I didn't have any luck :(</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "edited": false, "score": 0, "creation_date": 1428506635, "post_id": 29518801, "comment_id": 47192762, "body": "So you don&#39;t want any formula on the sheet?"}], "answers": [{"tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": false, "score": 1, "last_activity_date": 1429731576, "last_edit_date": 1429731576, "creation_date": 1428506914, "answer_id": 29518951, "question_id": 29518801, "link": "https://stackoverflow.com/questions/29518801/remove-from-formula-vba/29518951#29518951", "title": "Remove = from formula vba", "body": "<p>You can try something like this:</p>\n\n<pre><code>For Each c in Sheet1.Range(\"A1:C5\").Cells\n    If Left(c.Formula,1) = \"=\" Then c.Formula = \"'\" &amp; c.Formula\nNext\n</code></pre>\n\n<p>Note: above code changes formula to text ;) </p>\n\n<pre><code>A1 =&gt; '=Bla bla bla\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1429731862, "post_id": 29519159, "comment_id": 47742761, "body": "Use <code>Mid(cell.Formula, 2)</code> instead of <code>Right(..,Len()-1)</code>. The mid function returns the remaining string when the length parameter is omitted."}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 0, "last_activity_date": 1428507440, "creation_date": 1428507440, "answer_id": 29519159, "question_id": 29518801, "link": "https://stackoverflow.com/questions/29518801/remove-from-formula-vba/29519159#29519159", "title": "Remove = from formula vba", "body": "<p>This should work smoothly and delete all of your \"=\" in sheet and keep formula visible :</p>\n\n<pre><code>For Each cell In ActiveSheet.UsedRange\n    If Left(cell.Formula, 1) &lt;&gt; \"=\" Then\n\n    Else\n        cell.Formula = \"'\" &amp; Right(cell.Formula, Len(cell.Formula) - 1)\n    End If\nNext cell\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4764754, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rvX3LloL1zQ/AAAAAAAAAAI/AAAAAAAAACo/t26Yl3WDck4/photo.jpg?sz=128", "display_name": "skipjack02", "link": "https://stackoverflow.com/users/4764754/skipjack02"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1222, "favorite_count": 0, "accepted_answer_id": 29519159, "answer_count": 2, "score": 0, "last_activity_date": 1429731576, "creation_date": 1428506535, "question_id": 29518801, "link": "https://stackoverflow.com/questions/29518801/remove-from-formula-vba", "title": "Remove = from formula vba", "body": "<p>My problem is  that i have an excel file where  sometimes a \"=\" is at the beginning of a cell making it a formula for excel.\nHow can i search for those cells and remove the \"=\"?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "edited": false, "score": 0, "creation_date": 1428507351, "post_id": 29518753, "comment_id": 47193272, "body": "Thanks, that is giving me the same out put as before. It replaces the data with each offset. I need it to skip a row and place the next set of data under it. @R3uK"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "edited": false, "score": 0, "creation_date": 1428507742, "post_id": 29518753, "comment_id": 47193575, "body": "Ok, but in the first one, you write 3 times in the same cell <code>shtDest.Range(&quot;B&quot; &amp; currentRow).Value2 =</code> , so here is the main problem! Do you want them to be stack horizontaly or verticaly?"}, {"owner": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "edited": false, "score": 0, "creation_date": 1428508083, "post_id": 29518753, "comment_id": 47193816, "body": "I want them vertical in column B on tab PPPP, not overlapping. I want the information from tab Roadmap column L to populate on tab PPPP column B row 2 - however many rows of data there is, and then Roadmap column M to populate on PPPP 1 cell under where column L data was just moved. @R3uK"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "edited": false, "score": 0, "creation_date": 1428511371, "post_id": 29518753, "comment_id": 47195862, "body": "OK it&#39;s far more clearer, I&#39;m on my phone but I&#39;ll try to edit consequently. Just your 3 different (as said in the previous comment) info are still normal?"}, {"owner": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "edited": false, "score": 0, "creation_date": 1428513499, "post_id": 29518753, "comment_id": 47197125, "body": "Thank you! I did not think I could keep adding the For Each / If statements. I was able to use what you gave a put it into my code to get what I needed. I really appreciate your help!! @R3uK"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1428511881, "last_edit_date": 1428511881, "creation_date": 1428506408, "answer_id": 29518753, "question_id": 29518533, "link": "https://stackoverflow.com/questions/29518533/vba-combine-multiple-columns-of-data-into-1-column/29518753#29518753", "title": "VBA Combine Multiple columns of data into 1 column", "body": "<p>On the first version, try this :</p>\n\n<pre><code> Sub Move_PPPP()\n\nSheets(\"PPPP\").Select\nRows(\"2:1000\").Select\nSelection.ClearContents\n\nDim rowCount2 As Long, shtSrc As Worksheet\nDim shtDest As Worksheet\nDim rng2 As Range\nDim currentRow As Long\n\n    Set shtSrc = Sheets(\"Roadmap\")\n    Set shtDest = Sheets(\"PPPP\")\n\n    rowCount2 = shtSrc.Cells(Rows.Count, \"C\").End(xlUp).Row\n\n    Set rng2 = shtSrc.Range(\"C6:C\" &amp; rowCount2)\n\n    currentRow = shtDest.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n\n        For Each cell2 In rng2.Cells\n        If cell2.Value &lt;&gt; \"\" Then\n\n       shtDest.Range(\"B\" &amp; currentRow).Value2 = \"           \" &amp; cell2.Text &amp; \" - \" &amp; cell2.Offset(0, 10).Text\n       shtDest.Range(\"B\" &amp; currentRow + 1).Value2 = \"           \" &amp; cell2.Text &amp; \" - \" &amp; cell2.Offset(0, 11).Text\n       shtDest.Range(\"B\" &amp; currentRow + 2).Value2 = \"           \" &amp; cell2.Text &amp; \" - \" &amp; cell2.Offset(0, 12).Text\n          currentRow = currentRow + 1\n\n        ElseIf cell2.Value = \"\" Then\n\n        End If\n        Next cell2\n\n Set rng2 = shtSrc.Range(\"D6:D\" &amp; rowCount2)\n\n    currentRow = shtDest.Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1\n\n        For Each cell2 In rng2.Cells\n        If cell2.Value &lt;&gt; \"\" Then\n\n       shtDest.Range(\"B\" &amp; currentRow).Value2 = \"           \" &amp; cell2.Text &amp; \" - \" &amp; cell2.Offset(0, 10).Text\n       shtDest.Range(\"B\" &amp; currentRow + 1).Value2 = \"           \" &amp; cell2.Text &amp; \" - \" &amp; cell2.Offset(0, 11).Text\n       shtDest.Range(\"B\" &amp; currentRow + 2).Value2 = \"           \" &amp; cell2.Text &amp; \" - \" &amp; cell2.Offset(0, 12).Text\n          currentRow = currentRow + 1\n\n        ElseIf cell2.Value = \"\" Then\n\n        End If\n        Next cell2\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1531, "favorite_count": 0, "accepted_answer_id": 29518753, "answer_count": 1, "score": 0, "last_activity_date": 1488362084, "creation_date": 1428505793, "last_edit_date": 1488362084, "question_id": 29518533, "link": "https://stackoverflow.com/questions/29518533/vba-combine-multiple-columns-of-data-into-1-column", "title": "VBA Combine Multiple columns of data into 1 column", "body": "<p>I am still newer to VBA and have been trying everything I can think of to get this accomplished before asking for help, but cannot figure it out.</p>\n\n<p>I have an excel file with multiple tabs. I am only concerned with 2 of them. I need to combine rows based off of their values not being blank from tab \"Roadmap\" into column B on tab \"PPPP\". The code I have will do that for the first set of data, but then replaces that data with the second set.</p>\n\n<pre><code>Sub Move_PPPP()\n\nSheets(\"PPPP\").Select\nRows(\"2:1000\").Select\nSelection.ClearContents\n\nDim rowCount2 As Long, shtSrc As Worksheet\nDim shtDest As Worksheet\nDim rng2 As Range\nDim currentRow As Long\n\n    Set shtSrc = Sheets(\"Roadmap\")\n    Set shtDest = Sheets(\"PPPP\")\n\n    rowCount2 = shtSrc.Cells(Rows.Count, \"C\").End(xlUp).Row\n\n    Set rng2 = shtSrc.Range(\"C6:C\" &amp; rowCount2)\n\n    currentRow = 2\n\n        For Each cell2 In rng2.Cells\n        If cell2.Value &lt;&gt; \"\" Then\n\n       shtDest.Range(\"B\" &amp; currentRow).Value2 = \"           \" &amp; cell2.Text &amp; \" - \" &amp; cell2.Offset(0, 10).Text\n       shtDest.Range(\"B\" &amp; currentRow).Value2 = \"           \" &amp; cell2.Text &amp; \" - \" &amp; cell2.Offset(0, 11).Text\n       shtDest.Range(\"B\" &amp; currentRow).Value2 = \"           \" &amp; cell2.Text &amp; \" - \" &amp; cell2.Offset(0, 12).Text\n          currentRow = currentRow + 1\n\n        ElseIf cell2.Value = \"\" Then\n\n        End If\n        Next cell2\n\nEnd Sub\n</code></pre>\n\n<p>I have tried to add a range for my destination sheet, but doing that is only giving me 9 rows of the last row of data from tab \"Roadmap\"</p>\n\n<pre><code>Sub Move_PPPP()\n\nSheets(\"PPPP\").Select\nRows(\"2:1000\").Select\nSelection.ClearContents\n\nDim rowCount2 As Long, shtSrc As Worksheet\nDim columnCount As Long\nDim shtDest As Worksheet\nDim rng2 As Range\nDim rng As Range\nDim currentRow As Long\n\n    Set shtSrc = Sheets(\"Roadmap\")\n    Set shtDest = Sheets(\"PPPP\")\n\n    rowCount2 = shtSrc.Cells(Rows.Count, \"C\").End(xlUp).Row\n    columnCount = shtDest.Cells(Columns.Count, \"B\").End(xlUp).Row\n\n    Set rng2 = shtSrc.Range(\"C6:C\" &amp; rowCount2)\n    Set rng = shtDest.Range(\"B2:B\" &amp; columnCount &amp; currentRow)\n\n    currentRow = 2\n\n        For Each cell2 In rng2.Cells\n        If cell2.Value &lt;&gt; \"\" Then\n\n        rng.Value = \"           \" &amp; cell2.Text &amp; \" - \" &amp; cell2.Offset(0, 10).Text\n\n            currentRow = currentRow + 1\n\n        ElseIf cell2.Value = \"\" Then\n\n        End If\n        Next cell2\n\n\nEnd Sub\n</code></pre>\n\n<p>Sample Data</p>\n\n<p>Roadmap Tab</p>\n\n<p>Column: C         D      E       F      G      H     I    J    K       L       M\nHeaders: Project   Status  Open  Closed  Name   P1    P2  P3   P4      P5       P6</p>\n\n<p>Row 1: FISMA      New    Yes    No     Albert  na    na  na   na   New Day  Old Data\nRow 2: QRD       Closed   No    Yes    Albert  na   na  na   na     na     Closed</p>\n\n<p>Desired Outcome. Combine Column C with Column M when M &lt;> blank, loop through entire row and put that data in column B of PPPP tab. Then combine column C with N when N &lt;> blank and put that on PPPP tab, column B under the data from column M.</p>\n\n<p>PPPP Tab</p>\n\n<p>Cell B2\nFISMA - New Day</p>\n\n<p>Cell B4\nFISMA - Old Data\nQRD - Closed</p>\n\n<p>SOLUTION:</p>\n\n<pre><code>Sub Move_PPPP()\n\nSheets(\"PPPP\").Select\nRows(\"2:1000\").Select\nSelection.ClearContents\n\nDim rowCount2 As Long, shtSrc As Worksheet\nDim shtDest As Worksheet\nDim rng2 As Range\nDim currentRow As Long\n\n    Set shtSrc = Sheets(\"Roadmap\")\n    Set shtDest = Sheets(\"PPPP\")\n\n    rowCount2 = shtSrc.Cells(Rows.Count, \"C\").End(xlUp).Row\n\n    Set rng2 = shtSrc.Range(\"C6:C\" &amp; rowCount2)\n\n    currentRow = shtDest.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n        For Each cell2 In rng2.Cells\n        If cell2.Value2 &lt;&gt; \"\" Then\n        shtDest.Range(\"A\" &amp; currentRow).Value2 = \"           \" &amp; cell2.Text &amp; \" - \" &amp; cell2.Offset(0, 9).Text\n        currentRow = currentRow + 1\n\n        ElseIf cell2.Value = \"\" Then\n\n        End If\n        Next cell2\n\n    Set rng2 = shtSrc.Range(\"C6:C\" &amp; rowCount2)\n\n    currentRow = shtDest.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n\n       For Each cell2 In rng2.Cells\n       If cell2.Value2 &lt;&gt; \"\"  Then\n       shtDest.Range(\"A\" &amp; currentRow + 1).Value2 = \"           \" &amp; cell2.Text &amp; \" - \" &amp; cell2.Offset(0, 10).Text\n       currentRow = currentRow + 1\n\n        ElseIf cell2.Value = \"\" Then\n\n        End If\n        Next cell2\n\n    Set rng2 = shtSrc.Range(\"C6:C\" &amp; rowCount2)\n\n    currentRow = shtDest.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n\n       For Each cell2 In rng2.Cells\n       If cell2.Value2 &lt;&gt; \"\"  Then\n       shtDest.Range(\"A\" &amp; currentRow + 1).Value2 = \"           \" &amp; cell2.Text &amp; \" - \" &amp; cell2.Offset(0, 11).Text\n       currentRow = currentRow + 1\n\n        ElseIf cell2.Value = \"\" Then\n\n        End If\n        Next cell2\n\n            Set rng2 = shtSrc.Range(\"C6:C\" &amp; rowCount2)\n\n    currentRow = shtDest.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n\n       For Each cell2 In rng2.Cells\n       If cell2.Value2 &lt;&gt; \"\"  Then\n       shtDest.Range(\"A\" &amp; currentRow + 1).Value2 = \"           \" &amp; cell2.Text &amp; \" - \" &amp; cell2.Offset(0, 12).Text\n       currentRow = currentRow + 1\n\n        ElseIf cell2.Value = \"\" Then\n\n        End If\n        Next cell2\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["string", "date", "excel", "vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 2, "creation_date": 1428505382, "post_id": 29518267, "comment_id": 47191810, "body": "I think your problem is that you&#39;re trying to save a file with multiple dots &#39;.&#39; in the filename. Some operating systems allow this, but Windows has had a hard time with it (in my experience). As a long habit, I use underscores. so <code>newfilename = &quot;Invoice&quot; &amp; &quot; &quot; &amp; invoiceno &amp; &quot;_&quot; &amp; Format(tourdate, &quot;dd_mm_yyyy&quot;)</code> should work for you."}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 3579897, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/477d624f954718aa7127d70a1ffd23f9?s=128&d=identicon&r=PG&f=1", "display_name": "Moni", "link": "https://stackoverflow.com/users/3579897/moni"}, "edited": false, "score": 0, "creation_date": 1428728711, "post_id": 29519133, "comment_id": 47297516, "body": "Thank you, I was trying tourdate2 in the file name, didn&#39;t work. I don&#39;t think the dots should be a problem as I do that all the time when not using VBA. I tried tourdate2 = format(tourdate, &quot;dd_mm_yyyy&quot;) and the error persists. The code actually gets stuck on  tourdate2 = Format(tourdate, &quot;dd.mm.yyyy&quot;) where the error is: Wrong number of arguments or wrong allocation or invalid property assignment"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 1, "last_activity_date": 1428507396, "creation_date": 1428507396, "answer_id": 29519133, "question_id": 29518267, "link": "https://stackoverflow.com/questions/29518267/vba-convert-date-dd-mm-yyyy-to-string-in-order-to-use-in-the-file-name/29519133#29519133", "title": "vba convert date dd.mm.yyyy to string in order to use in the file name", "body": "<p>Sorry, not enough reputation to comment...</p>\n\n<p>Your line:</p>\n\n<pre><code>final = destinationpath &amp; Application.PathSeparator &amp; newfilename &amp; tourdate\n</code></pre>\n\n<p>is using the date variable 'tourdate' and not the string variable 'tourdate2' (which is included in newfilename), so maybe change this line to:</p>\n\n<pre><code>final = destinationpath &amp; Application.PathSeparator &amp; newfilename\n</code></pre>\n\n<p>I don't think the multiple dots causes a problem anymore - unless you're still on Windows 98 or something like that.</p>\n"}, {"tags": [], "owner": {"reputation": 93, "user_id": 3579897, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/477d624f954718aa7127d70a1ffd23f9?s=128&d=identicon&r=PG&f=1", "display_name": "Moni", "link": "https://stackoverflow.com/users/3579897/moni"}, "is_accepted": false, "score": 0, "last_activity_date": 1428885914, "creation_date": 1428885914, "answer_id": 29596362, "question_id": 29518267, "link": "https://stackoverflow.com/questions/29518267/vba-convert-date-dd-mm-yyyy-to-string-in-order-to-use-in-the-file-name/29596362#29596362", "title": "vba convert date dd.mm.yyyy to string in order to use in the file name", "body": "<p>I finally got it to work by fist reading the date value as .Text and then converting it to CStr()</p>\n\n<pre><code>      invoiceno = ws1.Cells(10, 3).Value\n      tourdate = ws1.Cells(17, 3).Text\n      tourdate = CStr(tourdate)\n      newfilename = \"Invoice\" &amp; \" \" &amp; invoiceno &amp; \" \" &amp; tourdate &amp; \".xlsx\"\n      newpdfname = \"invoice\" &amp; \" \" &amp; invoiceno &amp; \" \" &amp; tourdate &amp; \".pdf\"\n      final = destinationpath &amp; \"Invoice Out 2015\" &amp; Application.PathSeparator &amp; newfilename\n      finalpdf = destinationpath &amp; \"invoice Out 2015\" &amp; Application.PathSeparator &amp; newpdfname\n      oWorkbook.SaveAs final, xlOpenXMLWorkbook\n      ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=finalpdf\n      oWorkbook.Close\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 3579897, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/477d624f954718aa7127d70a1ffd23f9?s=128&d=identicon&r=PG&f=1", "display_name": "Moni", "link": "https://stackoverflow.com/users/3579897/moni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 907, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1428885914, "creation_date": 1428505070, "last_edit_date": 1531164843, "question_id": 29518267, "link": "https://stackoverflow.com/questions/29518267/vba-convert-date-dd-mm-yyyy-to-string-in-order-to-use-in-the-file-name", "title": "vba convert date dd.mm.yyyy to string in order to use in the file name", "body": "<p>I am trying to grab data from a main excel file, copy parts into a new file, and save it with a date as string in the file name, format dd.mm.yyyy but I cannot get date converted to string in order to use it in the file name. Help much appreciated. I've found a hand full of solutions online but none of them work for me. Help much appreciated.</p>\n\n<pre><code>Sub invoicing()\nDim invoiceno As Variant 'but when grabbed from the file, it's string\nDim tourdate As Date\nDim final As String\nDim tourdate2 As String\n\nDim startrow As Variant\nDim endrow As Variant\nstartrow = 98\nendrow = 170\nDim templatefilename As String\nDim newfilename As Variant\nDim oWorkbook As Workbook\nDim ws1 As Worksheet\nDim ws2 As Worksheet\n\n\nDim destinationpath  As String\ndestinationpath = CurDir\ntemplatefilename = \"Template Invoice.xlsx\"\n\n\nSet oWorkbook = Workbooks.Open(destinationpath &amp; Application.PathSeparator &amp;templatefilename)\noWorkbook.Activate\n\nSet ws1 = oWorkbook.ActiveSheet\nSet ws2 = ThisWorkbook.Sheets(\"2015 client details\")\n\n\nWith ws1\n    .Cells(10, 3).Value = ws2.Cells(startrow, 16).Value     'invoice number\n    .Cells(9, 3).Value = ws2.Cells(startrow, 25).Value      'enquiry date\n    .Cells(11, 3).Value = ws2.Cells(startrow, 9).Value      'first name and last name\n    .Cells(12, 3).Value = ws2.Cells(startrow, 30).Value     'pay date\n    .Cells(12, 4).Value = ws2.Cells(startrow, 18).Value     'pay method\n    .Cells(17, 2).Value = ws2.Cells(startrow, 12).Value     '# Adults, # Children, (Private)\n    .Cells(17, 2).RowHeight = 50\n    .Cells(17, 2).EntireRow.AutoFit\n    .Cells(17, 3).Value = ws2.Cells(startrow, 23).Value     'tour date\n    .Cells(17, 4).Value = ws2.Cells(startrow, 17).Value     'Amount\n    .Cells(17, 5).Value = ws2.Cells(startrow, 17).Value     'Total Amount\n\nEnd With\ninvoiceno = ws1.Cells(10, 3).Value\n\ntourdate = ws1.Cells(17, 3).Value 'as date which cannot be used in file name in this form\n\ntourdate2 = Format(tourdate, \"dd.mm.yyyy\")\n\n\n'tourdate.Value = tourdate.Text\n'tourdate.NumberFormat = \"@\"\n\nnewfilename = \"Invoice\" &amp; \" \" &amp; invoiceno &amp; tourdate2\nfinal = destinationpath &amp; Application.PathSeparator &amp; newfilename &amp; tourdate\noWorkbook.SaveAs final, xlOpenXMLWorkbook\noWorkbook.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "powerquery"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1428506008, "post_id": 29518185, "comment_id": 47192263, "body": "There are a couple of different choices you have, though <code>DoEvents</code> should work. Look at this thread for the discussion <a href=\"http://stackoverflow.com/questions/22083668/wait-until-activeworkbook-refreshall-finishes-vba\">Wait until ActiveWorkbook.RefreshAll finishes - VB</a>"}, {"owner": {"reputation": 61, "user_id": 4764611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1ab278f6e70417839d09e764fb276e2?s=128&d=identicon&r=PG&f=1", "display_name": "Havimo", "link": "https://stackoverflow.com/users/4764611/havimo"}, "edited": false, "score": 0, "creation_date": 1428568655, "post_id": 29518185, "comment_id": 47220294, "body": "Thank you very much ! the DoEvent worked once i disabled the background refresh on the queries."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 4764611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1ab278f6e70417839d09e764fb276e2?s=128&d=identicon&r=PG&f=1", "display_name": "Havimo", "link": "https://stackoverflow.com/users/4764611/havimo"}, "edited": false, "score": 0, "creation_date": 1428568667, "post_id": 29518559, "comment_id": 47220302, "body": "Thank you very much ! the DoEvent worked once i disabled the background refresh on the queries"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 61, "user_id": 4764611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1ab278f6e70417839d09e764fb276e2?s=128&d=identicon&r=PG&f=1", "display_name": "Havimo", "link": "https://stackoverflow.com/users/4764611/havimo"}, "edited": false, "score": 0, "creation_date": 1428569789, "post_id": 29518559, "comment_id": 47220940, "body": "You are welcome! ;) Plz accept answer (tick just under down vote) to close subject."}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 0, "last_activity_date": 1428505880, "creation_date": 1428505880, "answer_id": 29518559, "question_id": 29518185, "link": "https://stackoverflow.com/questions/29518185/refreshing-and-saving-as-a-text-file-in-excel/29518559#29518559", "title": "Refreshing and Saving as a text file in Excel", "body": "<p>Personnaly, I have choose to be a bit patient and added a timer to go on after a few seconds!</p>\n\n<p>Try to add this in between :</p>\n\n<pre><code>DoEvents\nApplication.Wait (Now + TimeValue(\"0:00:05\"))\nDoEvents\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 4764611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1ab278f6e70417839d09e764fb276e2?s=128&d=identicon&r=PG&f=1", "display_name": "Havimo", "link": "https://stackoverflow.com/users/4764611/havimo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 377, "favorite_count": 0, "accepted_answer_id": 29518559, "answer_count": 1, "score": 2, "last_activity_date": 1428505880, "creation_date": 1428504885, "question_id": 29518185, "link": "https://stackoverflow.com/questions/29518185/refreshing-and-saving-as-a-text-file-in-excel", "title": "Refreshing and Saving as a text file in Excel", "body": "<p>I have been trying to automatically refresh my table (obtained from an SQL database via power query) and directly save it as a text file (tab delimited)\nI'm very new with VBA and the macro i used is </p>\n\n<pre><code>    Public Sub UpdatePowerQueries()\n 'Macro to update the Power Query script(s) and save the file as .txt\n\nDim cn As WorkbookConnection\n\nFor Each cn In ThisWorkbook.Connections\n If Left(cn, 13) = \"Power Query -\" Then cn.Refresh\n Next cn\n\nApplication.DisplayAlerts = False\nActiveSheet.SaveAs Filename:=\"customfile\" &amp; Format(Date, \"yyyymmdd\") &amp; \".txt\", FileFormat:=xlTextWindows\nApplication.DisplayAlerts = True\n\n\n End Sub\n</code></pre>\n\n<p>now the issue I've been facing is that the refresh part and the save part work ok on their own, but if I put them in the same macro, the save part happens too soon, and the text file is empty. Can anyone help me ?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "ms-word", "spacing", "paragraph", "word-2007"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 2831074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64e82355799bbba5e47ee9c5d965847d?s=128&d=identicon&r=PG&f=1", "display_name": "user2831074", "link": "https://stackoverflow.com/users/2831074/user2831074"}, "is_accepted": false, "score": 0, "last_activity_date": 1428506007, "creation_date": 1428506007, "answer_id": 29518612, "question_id": 29518002, "link": "https://stackoverflow.com/questions/29518002/i-want-to-set-spacing-to-single-for-all-tables-in-word-2007-document/29518612#29518612", "title": "I want to set spacing to single for all tables in Word 2007 document", "body": "<blockquote>\n  <p>I botched METHOD 3, by referring to the table reference I used in\n  METHOD 2 rather than the current Selection. Here is the correct answer:</p>\n</blockquote>\n\n<pre><code>Sub FixTables()\nDim mytable As Table\nApplication.ScreenUpdating = False\n\nFor Each mytable In ActiveDocument.Tables\nmytable.Range.Editors.Add wdEditorEveryone\nNext\nActiveDocument.SelectAllEditableRanges (wdEditorEveryone)\nActiveDocument.DeleteAllEditableRanges (wdEditorEveryone)\n    With Selection.ParagraphFormat\n        .SpaceBefore = 0\n        .SpaceBeforeAuto = False\n        .SpaceAfter = 0\n        .SpaceAfterAuto = False\n        .LineSpacingRule = wdLineSpaceSingle\n        .LineUnitBefore = 0\n        .LineUnitAfter = 0\n    End With\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 2831074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64e82355799bbba5e47ee9c5d965847d?s=128&d=identicon&r=PG&f=1", "display_name": "user2831074", "link": "https://stackoverflow.com/users/2831074/user2831074"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2765, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593960164, "creation_date": 1428504457, "last_edit_date": 1593960164, "question_id": 29518002, "link": "https://stackoverflow.com/questions/29518002/i-want-to-set-spacing-to-single-for-all-tables-in-word-2007-document", "title": "I want to set spacing to single for all tables in Word 2007 document", "body": "<p>I have an exported Word document in which tables constructed by a database extractor have space between wrapped lines in cells that I can remove by selecting the table and using the paragraph dialog box, but there are many tables and I want to automate this.</p>\n\n<p>All I have to do after selecting all the tables in the document (which I can do with VBA) is set Add Space Before and Add Space After both = 0, which I think, secretly also sets the <code>AddSpaceBeforeAuto = AddSpaceAfterAuto = False</code>.</p>\n\n<p>So I started with a simple select subroutine: </p>\n\n<pre><code>Sub selecttables()    \n    Dim mytable As Table   \n    Application.ScreenUpdating = False\n\n    For Each mytable In ActiveDocument.Tables\n    mytable.Range.Editors.Add wdEditorEveryone    \n    Next    \n    ActiveDocument.SelectAllEditableRanges (wdEditorEveryone)   \n    ActiveDocument.DeleteAllEditableRanges (wdEditorEveryone)   \n    Application.ScreenUpdating = True \nEnd Sub\n</code></pre>\n\n<p>This works fine and leaves all my tables selected. All I want to do now is set the appropriate ParagraphFormat members to mimic my setting of these properties in the Paragraph Dialog to zero and false. </p>\n\n<p>I tried three approaches:\n1. Set the values globally for the Normal style (which all the tables use)\n2. Set the values for each table as they are selected\n3. Set the values on the total selection, after all the tables are selected.</p>\n\n<p>When I do this manually after <code>selecttables()</code> executes, I am doing method 3.</p>\n\n<p>The function below actually tries all three methods. I have selectively commented them out and discovered that no one of the methods works and doing all three doesn't help any. </p>\n\n<p>I tried both \"With Selection.Range.Style.ParagraphFormat\"   and \"With Selection.Range.ParagraphFormat\" for METHOD 3, but neither worked.</p>\n\n<p>I would also like to set the table property, \"Allow row to break across pages\" to False (because, seriously, the default value of True is really dumb!) and can't figure how to do that either.</p>\n\n<p>Here is the function:</p>\n\n<pre><code>Sub FixTables()\n   Dim mytable As Table\n   Dim i As Integer\n   Application.ScreenUpdating = False\n'  METHOD 1:\n   ActiveDocument.Styles(\"Normal\").ParagraphFormat.Space1\n   ActiveDocument.Styles(\"Normal\").ParagraphFormat.SpaceAfter = 0\n   ActiveDocument.Styles(\"Normal\").ParagraphFormat.SpaceBefore = 0\n   ActiveDocument.Styles(\"Normal\").ParagraphFormat.SpaceAfterAuto = False\n   ActiveDocument.Styles(\"Normal\").ParagraphFormat.SpaceBeforeAuto = False\n\nFor Each mytable In ActiveDocument.Tables\n'   METHOD 2:\n    With mytable.Style.ParagraphFormat\n        .Space1\n        .SpaceBefore = 0\n        .SpaceBeforeAuto = False\n        .SpaceAfter = 0\n        .SpaceAfterAuto = False\n    End With\n    mytable.Range.Editors.Add wdEditorEveryone\nNext\n\nActiveDocument.SelectAllEditableRanges (wdEditorEveryone)\nActiveDocument.DeleteAllEditableRanges (wdEditorEveryone)\n'\n    With Selection.Style.ParagraphFormat\n        .SpaceBefore = 0\n        .SpaceBeforeAuto = False\n        .SpaceAfter = 0\n        .SpaceAfterAuto = False\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1429474691, "post_id": 29517957, "comment_id": 47603741, "body": "duplicate: <a href=\"http://stackoverflow.com/q/19801598/119775\">stackoverflow.com/q/19801598/119775</a>"}], "answers": [{"comments": [{"owner": {"reputation": 281, "user_id": 803860, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/62bf1a630f240953afb949dc916c9789?s=128&d=identicon&r=PG", "display_name": "user803860", "link": "https://stackoverflow.com/users/803860/user803860"}, "edited": false, "score": 0, "creation_date": 1428505348, "post_id": 29518134, "comment_id": 47191780, "body": "If it&#39;s for only one column C range C2:C64 how will the code be ?"}, {"owner": {"reputation": 75, "user_id": 3711658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a918b210ac920260613c0919913d397?s=128&d=identicon&r=PG&f=1", "display_name": "Three-D", "link": "https://stackoverflow.com/users/3711658/three-d"}, "reply_to_user": {"reputation": 281, "user_id": 803860, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/62bf1a630f240953afb949dc916c9789?s=128&d=identicon&r=PG", "display_name": "user803860", "link": "https://stackoverflow.com/users/803860/user803860"}, "edited": false, "score": 0, "creation_date": 1428505594, "post_id": 29518134, "comment_id": 47191964, "body": "@user803860 - Change &quot;Columns(&quot;G:G&quot;).Select&quot; to &quot;Range(&quot;C2:C64&quot;).Select&quot;"}, {"owner": {"reputation": 281, "user_id": 803860, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/62bf1a630f240953afb949dc916c9789?s=128&d=identicon&r=PG", "display_name": "user803860", "link": "https://stackoverflow.com/users/803860/user803860"}, "edited": false, "score": 0, "creation_date": 1428515385, "post_id": 29518134, "comment_id": 47198233, "body": "Sub DateFormat() &#39; &#39;Change G:G to the column(s) you would like to change &#39; Columns(&quot;C2:C64&quot;).Select Selection.NumberFormat = &quot;mm/dd/yyyy&quot; Range(&quot;C2&quot;).Select End Sub"}, {"owner": {"reputation": 75, "user_id": 3711658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a918b210ac920260613c0919913d397?s=128&d=identicon&r=PG&f=1", "display_name": "Three-D", "link": "https://stackoverflow.com/users/3711658/three-d"}, "reply_to_user": {"reputation": 281, "user_id": 803860, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/62bf1a630f240953afb949dc916c9789?s=128&d=identicon&r=PG", "display_name": "user803860", "link": "https://stackoverflow.com/users/803860/user803860"}, "edited": false, "score": 0, "creation_date": 1428519719, "post_id": 29518134, "comment_id": 47200804, "body": "@user803860 - you have to change &quot;Columns&quot; to &quot;Range&quot;.......or, just use the new code after I did the edit to my answer."}, {"owner": {"reputation": 75, "user_id": 3711658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a918b210ac920260613c0919913d397?s=128&d=identicon&r=PG&f=1", "display_name": "Three-D", "link": "https://stackoverflow.com/users/3711658/three-d"}, "reply_to_user": {"reputation": 281, "user_id": 803860, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/62bf1a630f240953afb949dc916c9789?s=128&d=identicon&r=PG", "display_name": "user803860", "link": "https://stackoverflow.com/users/803860/user803860"}, "edited": false, "score": 0, "creation_date": 1428582061, "post_id": 29518134, "comment_id": 47228667, "body": "@user803860 - did this do what you needed?  if so, please mark as answered.  if not, please let me know what you are seeing.  thanks :)"}, {"owner": {"reputation": 281, "user_id": 803860, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/62bf1a630f240953afb949dc916c9789?s=128&d=identicon&r=PG", "display_name": "user803860", "link": "https://stackoverflow.com/users/803860/user803860"}, "edited": false, "score": 0, "creation_date": 1428584660, "post_id": 29518134, "comment_id": 47230603, "body": "That didn&#39;t work seems like when you export from clear quest it doesn&#39;t let u format"}], "tags": [], "owner": {"reputation": 75, "user_id": 3711658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a918b210ac920260613c0919913d397?s=128&d=identicon&r=PG&f=1", "display_name": "Three-D", "link": "https://stackoverflow.com/users/3711658/three-d"}, "is_accepted": false, "score": 0, "last_activity_date": 1428519637, "last_edit_date": 1428519637, "creation_date": 1428504732, "answer_id": 29518134, "question_id": 29517957, "link": "https://stackoverflow.com/questions/29517957/excel-macro-vba-script/29518134#29518134", "title": "Excel macro vba script", "body": "<pre><code>Sub DateFormat()\n     Range(\"C2:C64\").NumberFormat = \"mm/dd/yyyy\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 613, "user_id": 2213887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U44UC.png?s=128&g=1", "display_name": "Hugues Paquet Blanchette", "link": "https://stackoverflow.com/users/2213887/hugues-paquet-blanchette"}, "is_accepted": false, "score": 0, "last_activity_date": 1428505266, "last_edit_date": 1495542493, "creation_date": 1428504846, "answer_id": 29518171, "question_id": 29517957, "link": "https://stackoverflow.com/questions/29517957/excel-macro-vba-script/29518171#29518171", "title": "Excel macro vba script", "body": "<p>Based on this post: <a href=\"https://stackoverflow.com/questions/19801598/excel-vba-date-formats\">Excel VBA date formats</a></p>\n\n<pre><code>Function CellContentCanBeInterpretedAsADate(cell As Range) As Boolean\n    Dim d As Date\n    On Error Resume Next\n    d = CDate(cell.Value)\n    If Err.Number &lt;&gt; 0 Then\n        CellContentCanBeInterpretedAsADate = False\n    Else\n        CellContentCanBeInterpretedAsADate = True\n    End If\n    On Error GoTo 0\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 281, "user_id": 803860, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/62bf1a630f240953afb949dc916c9789?s=128&d=identicon&r=PG", "display_name": "user803860", "link": "https://stackoverflow.com/users/803860/user803860"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1593562158, "creation_date": 1428504352, "last_edit_date": 1593562158, "question_id": 29517957, "link": "https://stackoverflow.com/questions/29517957/excel-macro-vba-script", "title": "Excel macro vba script", "body": "<p>I am trying to format a column in excel sheet where regular format datetime to date option is not working as I exported data in excel from clear quest. I need date column in mm/dd/yyyy format bis there a VB script that can do this. </p>\n"}, {"tags": ["vba", "excel", "formulas"], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 4759966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd6c0e39302f2b01b2823b59f5c0172b?s=128&d=identicon&r=PG&f=1", "display_name": "Skullnick", "link": "https://stackoverflow.com/users/4759966/skullnick"}, "is_accepted": false, "score": 0, "last_activity_date": 1428510090, "last_edit_date": 1428510090, "creation_date": 1428503946, "answer_id": 29517798, "question_id": 29517552, "link": "https://stackoverflow.com/questions/29517552/input-a-udf-formula-in-a-range-with-vba/29517798#29517798", "title": "Input a UDF formula in a range with VBA", "body": "<p>You have to specify the address of range i.e :</p>\n\n<pre><code>rng2.formula = \"=test(\" &amp; rng.address &amp; \")\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 1, "last_activity_date": 1428509476, "creation_date": 1428509476, "answer_id": 29519897, "question_id": 29517552, "link": "https://stackoverflow.com/questions/29517552/input-a-udf-formula-in-a-range-with-vba/29519897#29519897", "title": "Input a UDF formula in a range with VBA", "body": "<p>The range address must be passed as a variable, not a string: </p>\n\n<pre><code>Dim rng2 as Range\nSet rng2 = blah blah\nrng2.formula = \"=test(\" &amp; rng.Address &amp; \")\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1428511088, "post_id": 29520413, "comment_id": 47195675, "body": "I would definitely choose this answer."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 1, "creation_date": 1428511576, "post_id": 29520413, "comment_id": 47195979, "body": "Just an observation: if the OP wants to insert the function via code, probably he doesn&#39;t refer to any <code>ActiveSheet</code> in particular. I would remove the <code>If</code> check and simply refer to the parent names of both <code>rng</code> (input) and <code>rng2</code> (output)."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1428512253, "post_id": 29520413, "comment_id": 47196409, "body": "@MatteoNNZ wouldn&#39;t be any point for <code>rng2</code> as we&#39;re dealing with the object directly - agreed there&#39;s no need for the <code>ActiveSheet</code> check as the address will still work with the sheet name even if it&#39;s on the same sheet so can be reduced to just one <code>IIf()</code> statement. Will update when I get back to a computer!"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1428512330, "post_id": 29520413, "comment_id": 47196447, "body": "Right for the rng2, I agree with this simple change you said."}, {"owner": {"reputation": 3, "user_id": 4731114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3121640488a9e934814075849e58f272?s=128&d=identicon&r=PG&f=1", "display_name": "Ilias", "link": "https://stackoverflow.com/users/4731114/ilias"}, "edited": false, "score": 1, "creation_date": 1428520599, "post_id": 29520413, "comment_id": 47201330, "body": "@S O Yep this works as a charm.I used this just before I saw your edit.Thumbs up."}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 1, "last_activity_date": 1428520320, "last_edit_date": 1428520320, "creation_date": 1428510853, "answer_id": 29520413, "question_id": 29517552, "link": "https://stackoverflow.com/questions/29517552/input-a-udf-formula-in-a-range-with-vba/29520413#29520413", "title": "Input a UDF formula in a range with VBA", "body": "<p>What if <code>rng</code> is on another sheet? Then you need this:</p>\n\n<pre><code>rng2.Formula = \"=test('\" &amp; rng.Parent.Name &amp; \"'!\" &amp; rng.Address &amp; \")\"\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4731114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3121640488a9e934814075849e58f272?s=128&d=identicon&r=PG&f=1", "display_name": "Ilias", "link": "https://stackoverflow.com/users/4731114/ilias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 29520413, "answer_count": 3, "score": 0, "last_activity_date": 1428520320, "creation_date": 1428503282, "last_edit_date": 1531164843, "question_id": 29517552, "link": "https://stackoverflow.com/questions/29517552/input-a-udf-formula-in-a-range-with-vba", "title": "Input a UDF formula in a range with VBA", "body": "<p>I have the UDF <code>Test(rng as range)</code> and I want to do something like this:</p>\n\n<pre><code>Dim rng2 as Range\nSet rng2 = blah blah\nrng2.formula = \"=test(rng)\"\n</code></pre>\n\n<p>How can I do this?</p>\n"}, {"tags": ["vba", "excel", "find"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1428504970, "post_id": 29517503, "comment_id": 47191474, "body": "Your code, exactly as written, works perfectly for me. It finds the single ID value in the column, displays one MsgBox, and exits. Perhaps the problem is in your calling routine and the infinite loop is there."}], "answers": [{"comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1428507596, "post_id": 29518283, "comment_id": 47193463, "body": "Not all the parameters are required, but it&#39;s pot-luck as to what they&#39;re set to if you don&#39;t specify them. They&#39;ll just be set at whatever the last <code>find</code> function call had them, whether in code or from the UI dialog box. It&#39;s all one set of parms, and one effects the other."}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1428505116, "creation_date": 1428505116, "answer_id": 29518283, "question_id": 29517503, "link": "https://stackoverflow.com/questions/29517503/excel-vba-find-error/29518283#29518283", "title": "Excel VBA .Find() error", "body": "<p>Your find miss a lot of parameters (try to record it, you'll see), test this :</p>\n\n<pre><code>Function CheckFinancials(ID As Integer) As Double\n    Dim MyArray(1 To 4) As Integer\n    Dim Guide As Range\n    Set Guide = Worksheets(\"Financials\").Range(Cells(1, 1), Cells(Worksheets(\"Financials\").UsedRange.Rows.Count, 1))\n    Set Guide = Guide.Find(What:=ID, LookIn:=xlFormulas, _\n        LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n        MatchCase:=False, SearchFormat:=False)\n\n    MsgBox Guide.Address\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4753126, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ar3ehl2U0Yw/AAAAAAAAAAI/AAAAAAAABlE/zLZV31_GWbo/photo.jpg?sz=128", "display_name": "Luis Carlos Gonz&#225;lez", "link": "https://stackoverflow.com/users/4753126/luis-carlos-gonz%c3%a1lez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 558, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1428505116, "creation_date": 1428503167, "question_id": 29517503, "link": "https://stackoverflow.com/questions/29517503/excel-vba-find-error", "title": "Excel VBA .Find() error", "body": "<p>I have the following piece VBA code, however when I run it I get Infinite MsgBoxes displaying me the same address 4 rows above the Address of ID. I have to stop execution with Ctrl+Break. </p>\n\n<p>I've been trying to get the code to work and it seems to me the error comes from the Find() method. In other versions of my code I get \"Method 'Find' of object 'Range' failed. Any ideas on how to fix this? Thank you.</p>\n\n<pre><code>Function CheckFinancials(ID As Integer) As Double\n    Dim MyArray(1 To 4) As Integer\n    Dim Guide As Range\n    Set Guide = Worksheets(\"Financials\").Range(Cells(1, 1),Cells(Worksheets(\"Financials\").UsedRange.Rows.Count, 1))\n    Set Guide = Guide.Find(ID)\n\n    MsgBox Guide.Address\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 179, "user_id": 2151190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe0e8248a04a4e87307b2c2fbe06cd1c?s=128&d=identicon&r=PG", "display_name": "user2151190", "link": "https://stackoverflow.com/users/2151190/user2151190"}, "edited": false, "score": 0, "creation_date": 1428513561, "post_id": 29518670, "comment_id": 47197154, "body": "hi, is it possible that we need to add somerhing like *NAME or .NAME or something similar to recognize the partial name, becouse now it seems it is looking for the exact sheetname &quot;NAME&quot;?"}, {"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "reply_to_user": {"reputation": 179, "user_id": 2151190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe0e8248a04a4e87307b2c2fbe06cd1c?s=128&d=identicon&r=PG", "display_name": "user2151190", "link": "https://stackoverflow.com/users/2151190/user2151190"}, "edited": false, "score": 0, "creation_date": 1428560724, "post_id": 29518670, "comment_id": 47215880, "body": "It is not looking for exact name. Instr will search a substring in a string. So if the string contains NAME in it, it will be TRUE. So it is like *NAME. Why do you say its not? Can you provide issue that you are facing."}, {"owner": {"reputation": 179, "user_id": 2151190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe0e8248a04a4e87307b2c2fbe06cd1c?s=128&d=identicon&r=PG", "display_name": "user2151190", "link": "https://stackoverflow.com/users/2151190/user2151190"}, "edited": false, "score": 0, "creation_date": 1428655136, "post_id": 29518670, "comment_id": 47264202, "body": "how can I SET this code to look for the sheets of the wbnew please?"}, {"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "reply_to_user": {"reputation": 179, "user_id": 2151190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe0e8248a04a4e87307b2c2fbe06cd1c?s=128&d=identicon&r=PG", "display_name": "user2151190", "link": "https://stackoverflow.com/users/2151190/user2151190"}, "edited": false, "score": 0, "creation_date": 1428659977, "post_id": 29518670, "comment_id": 47267174, "body": "@user2151190 - I&#39;ve updated the answer. Hope it works. Haven&#39;t tried though."}, {"owner": {"reputation": 179, "user_id": 2151190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe0e8248a04a4e87307b2c2fbe06cd1c?s=128&d=identicon&r=PG", "display_name": "user2151190", "link": "https://stackoverflow.com/users/2151190/user2151190"}, "edited": false, "score": 0, "creation_date": 1428670329, "post_id": 29518670, "comment_id": 47273582, "body": "You rock!!!! I adapted little settings and your suggestion did it!!!! Thanks a lot!!!!!!"}], "tags": [], "owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "is_accepted": true, "score": 2, "last_activity_date": 1428659944, "last_edit_date": 1428659944, "creation_date": 1428506177, "answer_id": 29518670, "question_id": 29517233, "link": "https://stackoverflow.com/questions/29517233/how-to-erase-sheet-when-partial-name-is-written-is-sheetname/29518670#29518670", "title": "How to erase sheet when partial name is written is sheetname?", "body": "<p>You need to use <code>Instr</code>. Try the following code</p>\n\n<pre><code>Sub erasesheet(wbnew As Workbook)\n    Dim ws As Worksheet\n\n    For Each ws In wbnew.Worksheets\n        If InStr(1, UCase(ws.Name), \"NAME\") Then\n            Application.DisplayAlerts = False\n            ws.Delete\n            Application.DisplayAlerts = True\n        End If\n      Next ws\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 179, "user_id": 2151190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe0e8248a04a4e87307b2c2fbe06cd1c?s=128&d=identicon&r=PG", "display_name": "user2151190", "link": "https://stackoverflow.com/users/2151190/user2151190"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 29518670, "answer_count": 1, "score": 0, "last_activity_date": 1428659944, "creation_date": 1428502523, "last_edit_date": 1531164843, "question_id": 29517233, "link": "https://stackoverflow.com/questions/29517233/how-to-erase-sheet-when-partial-name-is-written-is-sheetname", "title": "How to erase sheet when partial name is written is sheetname?", "body": "<p>How can I tell with VBA that if the name of the worksheet contains the name \"name\" of part of the word \"name\"  to completely erase that sheet please??</p>\n\n<p>When the sheet is ok , there is a normal name written in the sheetname</p>\n\n<p>When the sheet is blanc that the sheets are called \"name 1\" or \"name 2\" etc till \"name 30\"</p>\n\n<p>I have to remove the blanc sheets.</p>\n\n<p>Below my attempt, but not working.</p>\n\n<pre><code>Sub erasesheet(wbNew As Workbook)   \nDim ws As Worksheet\n\nFor Each ws In Worksheets\n\n'here I have to be able to tell : I it contains the word \"name\" in the sheet\n'like the code is now it will only look exactly fot sheets with name \"name\"\n      If Sheets.Name = \"name\"   Then\n         Application.DisplayAlerts = False\n         ws.Delete\n      Application.DisplayAlerts = True\n     End If\n  Next ws\nend sub\n</code></pre>\n"}, {"tags": ["vb.net", "excel", "vba"], "comments": [{"owner": {"reputation": 573, "user_id": 4565151, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/0JnyG.jpg?s=128&g=1", "display_name": "AJ_91", "link": "https://stackoverflow.com/users/4565151/aj-91"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1428502985, "post_id": 29517210, "comment_id": 47189983, "body": "Ok, good to know anyway, suppose I&#39;ll have to learn abit of VB, thanks"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1428503218, "post_id": 29517210, "comment_id": 47190176, "body": "You can&#39;t count colored cells, but you can count blank cells in a given range.  If you know the range of cells beforehand that are in question, then you would just have to add the worksheet names yourself.  A simple use of COUNTIF will find blank cells: <code>COUNTIF(range, &quot;=&quot;)</code>"}, {"owner": {"reputation": 573, "user_id": 4565151, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/0JnyG.jpg?s=128&g=1", "display_name": "AJ_91", "link": "https://stackoverflow.com/users/4565151/aj-91"}, "edited": false, "score": 0, "creation_date": 1428503458, "post_id": 29517210, "comment_id": 47190351, "body": "ahh cool, i could do that but some mandatory columns are inbetween optional columns which would mean me writing it out for each column rather than the whole sheet at once :( Its okay, i&#39;ve found a simple script i can use hopefully isn&#39;t to difficult to implement. Thanks for the input :)"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1428503734, "post_id": 29517210, "comment_id": 47190534, "body": "@pnuts, even easier.  Wasn&#39;t aware that function existed."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1428504692, "post_id": 29517210, "comment_id": 47191269, "body": "@pnuts, for what it&#39;s worth, the two functions handle the cell with a single apostrophe differently.  COUNTBLANK appears to count <code>=&#39;</code> as a blank, whereas COUNTIF does not consider that blank since the cell technically has something in there."}], "answers": [{"comments": [{"owner": {"reputation": 573, "user_id": 4565151, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/0JnyG.jpg?s=128&g=1", "display_name": "AJ_91", "link": "https://stackoverflow.com/users/4565151/aj-91"}, "edited": false, "score": 0, "creation_date": 1428521980, "post_id": 29519930, "comment_id": 47202136, "body": "Heyman cheers for the input.I managed to do this before you answered. Heres my other question : <a href=\"http://stackoverflow.com/questions/29519030/counting-coloured-cells-doesnt-work-with-conditional-formatting-in-excel?noredirect=1#comment47193219_29519030\" title=\"counting coloured cells doesnt work with conditional formatting in excel\">stackoverflow.com/questions/29519030/&hellip;</a>. it doesnt work when testing conditional formatted cells :("}], "tags": [], "owner": {"reputation": 108, "user_id": 4764941, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/cHHF8.jpg?s=128&g=1", "display_name": "Gordon", "link": "https://stackoverflow.com/users/4764941/gordon"}, "is_accepted": true, "score": 1, "last_activity_date": 1428509554, "creation_date": 1428509554, "answer_id": 29519930, "question_id": 29517210, "link": "https://stackoverflow.com/questions/29517210/how-would-i-count-the-number-of-coloured-cells-in-an-excel-worksheet/29519930#29519930", "title": "How would I count the number of coloured cells in an Excel worksheet ?", "body": "<p>You can only really count cells by color using some VB such as:</p>\n\n<pre><code>Function CountColorIf(rSample As Range, rArea As Range) As Long\nDim rAreaCell As Range\nDim lMatchColor As Long\nDim lCounter As Long\n\nlMatchColor = rSample.Interior.Color\nFor Each rAreaCell In rArea\n    If rAreaCell.Interior.Color = lMatchColor Then\n        lCounter = lCounter + 1\n    End If\nNext rAreaCell\nCountColorIf = lCounter\n</code></pre>\n\n<p>And then a formula such as:</p>\n\n<pre><code>=CountColorIf(N9,F5:F9)\n</code></pre>\n\n<p>With N9 being a cell to reference your color against and F5:F9 being the range of cells to check.</p>\n\n<p>I think trying to find a way without VB is going to be more complicated then with...</p>\n"}], "owner": {"reputation": 573, "user_id": 4565151, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/0JnyG.jpg?s=128&g=1", "display_name": "AJ_91", "link": "https://stackoverflow.com/users/4565151/aj-91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 632, "favorite_count": 0, "accepted_answer_id": 29519930, "answer_count": 1, "score": 0, "last_activity_date": 1428509554, "creation_date": 1428502471, "last_edit_date": 1531161705, "question_id": 29517210, "link": "https://stackoverflow.com/questions/29517210/how-would-i-count-the-number-of-coloured-cells-in-an-excel-worksheet", "title": "How would I count the number of coloured cells in an Excel worksheet ?", "body": "<p>I have a number of worksheets in my Excel file and if some cells on the worksheets are not filled they get filled in '<code>Red</code>'.</p>\n\n<p>What I want is on its own page, say I call it '<code>Cells that aren't filled</code> Worksheet', I want each worksheet name on the left hand side, with the number of cells filled '<code>Red</code>' next to it so users know what's left to be filled and on what page.</p>\n\n<p>I'm a total newbie at Excel in that I haven't used it since high school. Is there a simple line of code I can apply to a cell to count the number of certain coloured cells on that worksheet ? I have look online, and there's talks of using VB, I've never used that so I'm just wondering if there's an easier way :)</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 2494898, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7f8fb4a93a403dc18f167aac18f7564a?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/2494898/kaz"}, "edited": false, "score": 0, "creation_date": 1428569006, "post_id": 29517674, "comment_id": 47220481, "body": "I couldn&#39;t get the Dest working so i changed it to:     Set Dest = ThisWorkbook.Sheets.Add(after:=ThisWorkbook.Sheets(ThisWorkb&zwnj;&#8203;ook.Sheets.Count))            Dest.Name = &quot;My New Sheet&quot; which does add a newsheet but now im having problems with the copy part error 1004"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 39, "user_id": 2494898, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7f8fb4a93a403dc18f167aac18f7564a?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/2494898/kaz"}, "edited": false, "score": 0, "creation_date": 1428582146, "post_id": 29517674, "comment_id": 47228735, "body": "It seems <code>.copy</code> and <code>.paste</code> are a little different in the way they work. Check the updated code"}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": true, "score": 0, "last_activity_date": 1428582114, "last_edit_date": 1428582114, "creation_date": 1428503606, "answer_id": 29517674, "question_id": 29517175, "link": "https://stackoverflow.com/questions/29517175/vba-pull-data-from-multiple-closed-files/29517674#29517674", "title": "VBA pull data from multiple closed files", "body": "<p>Give this a try. Note, you may have to adjust the value of your <code>Dest</code> worksheet, I've defined it the best I could based on your code.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim directory As String, fileName As String, sheet As Worksheet, total As Integer\nDim Dest as Worksheet\nDim DestRow as long\nDim Source as Workbook\n\n'adjust this as necessary - it should create a new sheet at the end of \n'\"Voucher Report...\", and call it \"My New Sheet\"\nSet Dest = Workbooks(\"Voucher Report 26MAR V1.0.xlsm\").Worksheets.add _\n           after:=Workbooks(\"Voucher Report 26MAR V1.0.xlsm\").Worksheets.Count _\n           Name:=\"My New Sheet\"\nDestRow = 10\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\ndirectory = \"c:\\Vouchers\\\"\nfileName = Dir(directory &amp; \"*.csv??\")\n\nDo While fileName &lt;&gt; \"\"\n  'assign the opened workbook to a var for easier use\n  set source = Workbooks.Open (directory &amp; fileName)\n  For Each sheet In source.Worksheets\n    'copy the UsedRange cells from the sheet\n    '.copy is kind of weird, but this works\n    sheet.cells(1,1).resize(sheet.usedrange.rows.count, sheet.usedrange.columns.count).copy\n    'paste doesn't apply to a range, but to a worksheet object\n    '   the destination param tells it where to go\n    dest.paste destination:=range(cells(destrow,\"A\")\n    'increment the current row pointer but the number of rows used\n    destrow = destrow + sheet.usedrange.rows.count\n  Next sheet\n  Workbooks(fileName).Close\n  fileName = Dir()\nLoop\n\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n\n<p>All code untested, so you may have some minor tweaks. I'd suggest commenting out the <code>ScreenUpdating</code> lines until you have it all working correctly.</p>\n\n<p>Note: I found the references for <code>.copy</code> here in the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837760%28v=office.14%29.aspx\" rel=\"nofollow\">MS Docs</a>, and for <code>.paste</code> here in the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff821951%28v=office.14%29.aspx\" rel=\"nofollow\">MS Docs</a>.</p>\n"}], "owner": {"reputation": 39, "user_id": 2494898, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7f8fb4a93a403dc18f167aac18f7564a?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/2494898/kaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 960, "favorite_count": 0, "accepted_answer_id": 29517674, "answer_count": 1, "score": 0, "last_activity_date": 1428582114, "creation_date": 1428502377, "question_id": 29517175, "link": "https://stackoverflow.com/questions/29517175/vba-pull-data-from-multiple-closed-files", "title": "VBA pull data from multiple closed files", "body": "<pre><code>Private Sub CommandButton1_Click()\n\nDim directory As String, fileName As String, sheet As Worksheet, total As Integer\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\ndirectory = \"c:\\Vouchers\\\"\nfileName = Dir(directory &amp; \"*.csv??\")\n\nDo While fileName &lt;&gt; \"\"\n\nWorkbooks.Open (directory &amp; fileName)\n\nFor Each sheet In Workbooks(fileName).Worksheets\ntotal = Workbooks(\"Voucher Report 26MAR V1.0.xlsm\").Worksheets.Count\nWorkbooks(fileName).Worksheets(sheet.Name).Copy _\nafter:=Workbooks(\"Voucher Report 26MAR V1.0.xlsm\").Worksheets(total)\nNext sheet\n\nWorkbooks(fileName).Close\n\nfileName = Dir()\n\nLoop\n\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\n\n\nEnd Sub\n</code></pre>\n\n<p>The above code gets all the data I need but creates a new sheet for each workbook, is there anyway to place the data from the first workbook in row 10 then add the data from the next workbook in the next available row? </p>\n"}, {"tags": ["vba", "csv", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 892, "user_id": 2883071, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e5ba9b9e7e629478194565fc83b46cda?s=128&d=identicon&r=PG&f=1", "display_name": "user2883071", "link": "https://stackoverflow.com/users/2883071/user2883071"}, "is_accepted": false, "score": 0, "last_activity_date": 1428514546, "creation_date": 1428514546, "answer_id": 29521548, "question_id": 29516936, "link": "https://stackoverflow.com/questions/29516936/requested-member-of-collection-does-not-exist-vba-error-when-copying-from-arra/29521548#29521548", "title": "Requested Member of Collection Does not Exist - VBA error when copying from array to Word table", "body": "<p>Turns out I had a another function after, that I was not using. When I commented out this function, it worked. I still do not know why an unused function would prevent the userform from displaying the entered data, but it works.</p>\n\n<p>Regarding the Collection does not exist error, I changed the line to:\n<code>ActiveDocument.Tables(1).Cell(1, i).Range.Text = strData(i - 1)</code> \nand now it works</p>\n"}], "owner": {"reputation": 892, "user_id": 2883071, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e5ba9b9e7e629478194565fc83b46cda?s=128&d=identicon&r=PG&f=1", "display_name": "user2883071", "link": "https://stackoverflow.com/users/2883071/user2883071"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 227, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1428514546, "creation_date": 1428501849, "last_edit_date": 1428513821, "question_id": 29516936, "link": "https://stackoverflow.com/questions/29516936/requested-member-of-collection-does-not-exist-vba-error-when-copying-from-arra", "title": "Requested Member of Collection Does not Exist - VBA error when copying from array to Word table", "body": "<p>I am reading a string from a csv file and trying to print this into respective cells in a word document table. So far I have this, but it keeps throwing the Collections does not exist error:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim MyData As String, strData() As String\n\n    Open \"D:\\Users\\file2.csv\" For Binary As #1\n    MyData = Space$(LOF(1))\n    Get #1, , MyData\n    Close #1\n    strData() = Split(MyData, \",\")\n\n    For i = 1 To UBound(strData)\n        ActiveDocument.Tables(1).Cell(i, 2).Range.Text = strData(i)\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Basically I am taking the ith element of the array and pasting it in the ith row of the second column.</p>\n\n<p>The csv file  has only 1 line (will always have only one line) with 6 fields:</p>\n\n<p><code>hello,world,blah,haha,yes,huh</code></p>\n\n<p>To be safe (and for testing purposes), my table is an 8x8 table, and it still throws the error on the <code>ActiveDocument...</code> line.</p>\n\n<p>To be even safer, I have 2 tables, (just in case my Table number is off (not sure if it begins at 1 or 0)).</p>\n\n<p>Changed the line to: </p>\n\n<pre><code>ActiveDocument.Tables(1).Cell(1, i).Range.Text = strData(i - 1)\n</code></pre>\n\n<p>And it works. However the text is only displayed after I close the user form. How do I get the text show upon button click?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 4764329, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65d84b1b6fb30448e792096255d9eae6?s=128&d=identicon&r=PG&f=1", "display_name": "taz", "link": "https://stackoverflow.com/users/4764329/taz"}, "edited": false, "score": 0, "creation_date": 1428503568, "post_id": 29517018, "comment_id": 47190422, "body": "It gives me error saying &quot;Member already exists in an object module from which this object module derives&quot;"}, {"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "reply_to_user": {"reputation": 85, "user_id": 4764329, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65d84b1b6fb30448e792096255d9eae6?s=128&d=identicon&r=PG&f=1", "display_name": "taz", "link": "https://stackoverflow.com/users/4764329/taz"}, "edited": false, "score": 0, "creation_date": 1428503806, "post_id": 29517018, "comment_id": 47190589, "body": "It looks like you already have a sub with that name already present in your  project"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 3, "creation_date": 1486007740, "post_id": 29517018, "comment_id": 71164809, "body": "You can&#39;t declare a function, that shadows a member of a document-type module. That&#39;s why <code>Copy</code> caused an error when added in a worksheet module. Worksheet <i>already has</i> a <code>Copy</code> method. You&#39;d need to choose a different name for the function, or declare the function in a standard module."}, {"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "reply_to_user": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1486023814, "post_id": 29517018, "comment_id": 71171153, "body": "@ThunderFrame - True. Updated."}], "tags": [], "owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "is_accepted": true, "score": 2, "last_activity_date": 1486023728, "last_edit_date": 1495542258, "creation_date": 1428502038, "answer_id": 29517018, "question_id": 29516768, "link": "https://stackoverflow.com/questions/29516768/run-time-error-438/29517018#29517018", "title": "Run time Error - 438", "body": "<p>Try the following code. You should not rely on Activate and Select.</p>\n\n<pre><code>Sub ZCopy()\n    Sheets(\"Sheet1\").Range(\"A1:D20\").Copy\n    Sheets(\"Sheet1\").Paste Destination:=Worksheets(\"Sheet2\").Range(\"E1\")\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<p>Interesting Reads</p>\n\n<ol>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff821951.aspx\" rel=\"nofollow noreferrer\">MSDN</a></li>\n<li><a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "edited": false, "score": 1, "creation_date": 1428505039, "post_id": 29517134, "comment_id": 47191531, "body": "This is an easier solution in case OP doesn&#39;t need the formatting or formula referencing"}], "tags": [], "owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "is_accepted": false, "score": 1, "last_activity_date": 1428505720, "last_edit_date": 1428505720, "creation_date": 1428502281, "answer_id": 29517134, "question_id": 29516768, "link": "https://stackoverflow.com/questions/29516768/run-time-error-438/29517134#29517134", "title": "Run time Error - 438", "body": "<p>Do you have a particular need for copy and paste?  This can be slow and inefficient.  If you're just copying data from one sheet to another, you can set the values of one range equal to the values of another range and avoid the whole thing.</p>\n\n<pre><code>Sheets(\"Sheet2\").Range(\"E1:H20\").Value = Sheets(\"Sheet1\").Range(\"A1:D20\").Value\n</code></pre>\n\n<p>This will set the range from cells E1:H20 on Sheet2 to the same values as those in the range A1:D20 on Sheet1, which is effectively a copy and paste.  I should add that this will work only for the values themselves.  </p>\n\n<p>If there is specific formatting (or formulas) that you need copied and pasted, this method won't work.</p>\n"}], "owner": {"reputation": 85, "user_id": 4764329, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65d84b1b6fb30448e792096255d9eae6?s=128&d=identicon&r=PG&f=1", "display_name": "taz", "link": "https://stackoverflow.com/users/4764329/taz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 699, "favorite_count": 0, "accepted_answer_id": 29517018, "answer_count": 2, "score": 1, "last_activity_date": 1486023728, "creation_date": 1428501411, "last_edit_date": 1428501629, "question_id": 29516768, "link": "https://stackoverflow.com/questions/29516768/run-time-error-438", "title": "Run time Error - 438", "body": "<p>I have the following code in which I am trying to copy data from one sheet to another in same workbook. When I run the code I get Runtime error -438</p>\n\n<pre><code>Sub Copy()\n\nSheets(\"Sheet1\").Range(\"A1:D20\").Copy\n\nSheets(\"Sheet2\").Activate\n\nRange(\"E1\").Select\n\nActiveSheet.Paste\n\nApplication.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "edited": false, "score": 0, "creation_date": 1428501279, "post_id": 29516491, "comment_id": 47188562, "body": "Show us the sanatized conn string and SQL query"}, {"owner": {"reputation": 1643, "user_id": 2735482, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nukKn.jpg?s=128&g=1", "display_name": "Eko Junaidi Salam", "link": "https://stackoverflow.com/users/2735482/eko-junaidi-salam"}, "edited": false, "score": 0, "creation_date": 1428501622, "post_id": 29516491, "comment_id": 47188830, "body": "Where&#39;s your store procedure with parameters it self ?"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 4658691, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/924e4142d39acfc5eecb0260d3754a11?s=128&d=identicon&r=PG&f=1", "display_name": "GK1960", "link": "https://stackoverflow.com/users/4658691/gk1960"}, "edited": false, "score": 0, "creation_date": 1428504564, "post_id": 29516950, "comment_id": 47191163, "body": "Hi @Joshua Ross, I just modified your code but still same problem, shwing like executing but no data displaying. where I am doing wrong?"}, {"owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "reply_to_user": {"reputation": 101, "user_id": 4658691, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/924e4142d39acfc5eecb0260d3754a11?s=128&d=identicon&r=PG&f=1", "display_name": "GK1960", "link": "https://stackoverflow.com/users/4658691/gk1960"}, "edited": false, "score": 0, "creation_date": 1428505821, "post_id": 29516950, "comment_id": 47192133, "body": "If you execute the stored procedure on it&#39;s own, in SQL Server Management Studio, with the parameters <code>South</code> and <code>IT</code> does it run?  Unfortunately without seeing the content of the stored procedure, connection string, etc. it is difficult to say"}, {"owner": {"reputation": 101, "user_id": 4658691, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/924e4142d39acfc5eecb0260d3754a11?s=128&d=identicon&r=PG&f=1", "display_name": "GK1960", "link": "https://stackoverflow.com/users/4658691/gk1960"}, "edited": false, "score": 0, "creation_date": 1428505971, "post_id": 29516950, "comment_id": 47192231, "body": "Hi @ Joshua Ross, Yes SP is running fine and got the result set with required parameters values. Thanks"}, {"owner": {"reputation": 101, "user_id": 4658691, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/924e4142d39acfc5eecb0260d3754a11?s=128&d=identicon&r=PG&f=1", "display_name": "GK1960", "link": "https://stackoverflow.com/users/4658691/gk1960"}, "edited": false, "score": 0, "creation_date": 1428506122, "post_id": 29516950, "comment_id": 47192359, "body": "when I remove parameters in SP and VBA, I am getting data to excel fine, means connection string is fine I think."}, {"owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "reply_to_user": {"reputation": 101, "user_id": 4658691, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/924e4142d39acfc5eecb0260d3754a11?s=128&d=identicon&r=PG&f=1", "display_name": "GK1960", "link": "https://stackoverflow.com/users/4658691/gk1960"}, "edited": false, "score": 0, "creation_date": 1428506677, "post_id": 29516950, "comment_id": 47192782, "body": "This is intriguing to me.  I will think a bit more on it and hopefully come back with an updated answer.  Seems to me the connection string is fine, as you said, if you can get data in without parameters."}, {"owner": {"reputation": 101, "user_id": 4658691, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/924e4142d39acfc5eecb0260d3754a11?s=128&d=identicon&r=PG&f=1", "display_name": "GK1960", "link": "https://stackoverflow.com/users/4658691/gk1960"}, "edited": false, "score": 0, "creation_date": 1428507044, "post_id": 29516950, "comment_id": 47193046, "body": "Hi @Joshua Ross, I just got the answer. The problem with SP executing Timeout , I just added CommandTimeout = 0, it returned values. Thanks for your suggestions and time."}, {"owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "reply_to_user": {"reputation": 101, "user_id": 4658691, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/924e4142d39acfc5eecb0260d3754a11?s=128&d=identicon&r=PG&f=1", "display_name": "GK1960", "link": "https://stackoverflow.com/users/4658691/gk1960"}, "edited": false, "score": 0, "creation_date": 1428507074, "post_id": 29516950, "comment_id": 47193065, "body": "I was just about to mention that that would be my next check, I&#39;m glad you found the answer!"}, {"owner": {"reputation": 101, "user_id": 4658691, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/924e4142d39acfc5eecb0260d3754a11?s=128&d=identicon&r=PG&f=1", "display_name": "GK1960", "link": "https://stackoverflow.com/users/4658691/gk1960"}, "edited": false, "score": 0, "creation_date": 1428507246, "post_id": 29516950, "comment_id": 47193192, "body": "Thanks @ Joshua Ross, If you are good at VBA can you please also suggest answer this link <a href=\"http://stackoverflow.com/questions/29481649/vba-code-to-filter-data-automatically-by-windows-log-in-user-id\">link</a> , which I asked yesterday. Thanks."}, {"owner": {"reputation": 101, "user_id": 4658691, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/924e4142d39acfc5eecb0260d3754a11?s=128&d=identicon&r=PG&f=1", "display_name": "GK1960", "link": "https://stackoverflow.com/users/4658691/gk1960"}, "edited": false, "score": 0, "creation_date": 1428530995, "post_id": 29516950, "comment_id": 47206878, "body": "Hi @Joshua Ross, can you please help with this link also <a href=\"http://stackoverflow.com/questions/29525727/how-to-pass-multiple-values-to-stored-procedure-parameter-that-running-from-vba\">link</a>. thanks in advance"}], "tags": [], "owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "is_accepted": true, "score": 1, "last_activity_date": 1428507181, "last_edit_date": 1428507181, "creation_date": 1428501892, "answer_id": 29516950, "question_id": 29516491, "link": "https://stackoverflow.com/questions/29516491/excel-vba-stored-procedure-with-parameters-not-working/29516950#29516950", "title": "Excel VBA stored procedure with parameters not working?", "body": "<p>I have successfully declared a variant array and populated the parameters (in order!) into that array, then passed to the array into the execute method to execute a stored procedure.</p>\n\n<p>Assuming your stored proc expects 'Division' then 'Area', something like this may do the trick:</p>\n\n<pre><code>Sub CopyDataFromDatabase()\n\n    Dim Conn As ADODB.Connection\n    Dim Rs As ADODB.Recordset\n    Dim Fields As ADODB.Field\n    Dim Cmd As ADODB.Command\n\n    'New variable\n    Dim v_Params(1 To 2) As Variant 'assuming you have 2 parameters\n\n    Set Conn = New ADODB.Connection\n    Set Cmd = New ADODB.Command\n    Set Rs = New ADODB.Recordset\n\n    Conn.Open \"My connection string here--------\"\n\n    v_Params(1) = \"South\"\n    v_Params(2) = \"IT\"\n\n    With Cmd\n        .ActiveConnection = Conn\n        .CommandType = adCmdStoredProc\n        .CommandText = \"My SP here------\"\n        .CommandTimeout = 0\n        Set rs = .Execute(, v_Params)\n    End With\n</code></pre>\n\n<p>See if that works, as I am currently using this method successfully.  I didn't see the need to modify the rest of your subroutine.</p>\n\n<p>I used the <code>With Cmd</code> and <code>End With</code> to avoid fully qualifying the reference each time.</p>\n\n<h2>Updated</h2>\n\n<p>The issue, found by the author of the question, was that the SP was timing out when parameters were passed into it.  The resolution was to set the <code>CommandTimeout</code> property to 0.</p>\n"}], "owner": {"reputation": 101, "user_id": 4658691, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/924e4142d39acfc5eecb0260d3754a11?s=128&d=identicon&r=PG&f=1", "display_name": "GK1960", "link": "https://stackoverflow.com/users/4658691/gk1960"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1335, "favorite_count": 0, "accepted_answer_id": 29516950, "answer_count": 1, "score": 0, "last_activity_date": 1428530049, "creation_date": 1428500776, "last_edit_date": 1428530049, "question_id": 29516491, "link": "https://stackoverflow.com/questions/29516491/excel-vba-stored-procedure-with-parameters-not-working", "title": "Excel VBA stored procedure with parameters not working?", "body": "<p>I am struggling bit here with a stored procedure with parameters in VBA. The code below without parameters working fine but with parameters not working.</p>\n\n<p>My code:</p>\n\n<pre><code>Sub CopyDataFromDatabase()\n\nDim Conn As ADODB.Connection\nDim Rs As ADODB.Recordset\nDim Fields As ADODB.Field\nDim Cmd As ADODB.Command\n\nSet Conn = New ADODB.Connection\nSet Cmd = New ADODB.Command\nSet Rs = New ADODB.Recordset\nConn.Open \"My connection string here--------\"\n\nCmd.CommandType = adCmdStoredProc\n\nCmd.Parameters.Append Cmd.CreateParameter(\"@Division\", adVarChar, adParamInput, 40)\nCmd.Parameters(\"@Division\").Value = \"South\"\nCmd.Parameters.Append Cmd.CreateParameter(\"@Area\", adVarChar, adParamInput, 40)\nCmd.Parameters(\"@Area\").Value = \"IT\"\n\nCmd.CommandText = \"My SP here------\"\n\nSet Rs = Cmd.Execute\n\nOn Error GoTo CloseRecordset\n\nWorksheets.Add\n\nFor Each Fields In Rs.Fields\nActiveCell.Value = Fields.Name\nActiveCell.Font.Bold = True\nActiveCell.Font.Underline = True\nActiveCell.HorizontalAlignment = xlCenter\nActiveCell.Interior.Color = RGB(0, 128, 255)\nActiveCell.Font.Color = RGB(255, 255, 255)\nActiveCell.Offset(0, 1).Select\n\nNext Fields\n\nRange(\"A1\").Select\nRange(\"A2\").CopyFromRecordset Rs\n\nCloseRecordset:\nRs.Close\nSet Rs = Nothing\nSet Cmd = Nothing\n\nCloseConnection:\nConn.Close\nSet Conn = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>When I run, its not giving any error, just showing like executing but no result</p>\n\n<p>Can anybody suggest where I am doing wrong? Thanks</p>\n"}, {"tags": ["excel", "paste", "vba"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4764235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12d023e718ed177d0d1af5a006f0f1f6?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey Barrett", "link": "https://stackoverflow.com/users/4764235/jeffrey-barrett"}, "edited": false, "score": 0, "creation_date": 1428596502, "post_id": 29516974, "comment_id": 47239360, "body": "Darren, Very much appreciate the response and for simplifying the code. I am getting a Run-Time error &#39;1004&#39;: Application-defined or object-defined error when I attempt your version. The bug appears to be in the line:                                      Sheets(&quot;Sheet1&quot;).Range(&quot;F2&quot;).AddComment Rng.Offset(0, 4).Value                                                                                                     Any thoughts on why I am recieving the error? I am running VBA off Microsoft Excel 2013.  Thanks, Jeff"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 31, "user_id": 4764235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12d023e718ed177d0d1af5a006f0f1f6?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey Barrett", "link": "https://stackoverflow.com/users/4764235/jeffrey-barrett"}, "edited": false, "score": 0, "creation_date": 1428597575, "post_id": 29516974, "comment_id": 47240031, "body": "It looks like it throws an error if rng.Offset(0,4) is a blank cell.  I&#39;d add another variable &quot;Dim sCommentText As String&quot; and set this to hold the value &quot;sCommentText = rng.Offset(0, 4).Value&quot; and then use this to add the text &quot;Sheets(&quot;Sheet1&quot;).Range(&quot;F2&quot;).AddComment sCommentText&quot; It doesn&#39;t seem to mind the blank cells then."}, {"owner": {"reputation": 31, "user_id": 4764235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12d023e718ed177d0d1af5a006f0f1f6?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey Barrett", "link": "https://stackoverflow.com/users/4764235/jeffrey-barrett"}, "edited": false, "score": 0, "creation_date": 1428604450, "post_id": 29516974, "comment_id": 47244063, "body": "Darren, That did the trick! I can&#39;t tell you how awesome that is, so thank you very very much for your help!"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 0, "last_activity_date": 1428501940, "creation_date": 1428501940, "answer_id": 29516974, "question_id": 29516463, "link": "https://stackoverflow.com/questions/29516463/paste-text-into-excel-comment-vba/29516974#29516974", "title": "Paste text into Excel comment VBA", "body": "<p>Rather than copy and paste the cell value into the comment, you create the text at the same time as creating the comment box.  If a comment box already exists an error is raised - so remove any comment boxes in that cell beforehand.</p>\n\n<p>The VBA help gives this as an example:  </p>\n\n<pre><code>Worksheets(1).Range(\"E5\").AddComment \"Current Sales\"\n</code></pre>\n\n<p>So with this in mind, this code will do the trick:</p>\n\n<pre><code>Sub For_Reals()\n\n    'Find Value in Sheet2 based on Value from Sheet1\n    Dim FindString As String\n    Dim Rng As Range\n    FindString = Sheets(\"Sheet1\").Range(\"F2\").Value\n    If Trim(FindString) &lt;&gt; \"\" Then\n        With Sheets(\"Sheet2\").Range(\"C:C\")\n            Set Rng = .Find(What:=FindString, _\n                        After:=.Cells(.Cells.Count), _\n                        LookIn:=xlValues, _\n                        LookAt:=xlWhole, _\n                        SearchOrder:=xlByRows, _\n                        SearchDirection:=xlNext, _\n                        MatchCase:=False)\n            'Remove any existing comments, create comment and add text.\n            If Not Rng Is Nothing Then\n                Sheets(\"Sheet1\").Range(\"F2\").ClearComments\n                Sheets(\"Sheet1\").Range(\"F2\").AddComment Rng.Offset(0, 4).Value\n                Range(\"F2\").Comment.Visible = True\n            Else\n                MsgBox \"Nothing found\"\n            End If\n        End With\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 4764235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12d023e718ed177d0d1af5a006f0f1f6?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey Barrett", "link": "https://stackoverflow.com/users/4764235/jeffrey-barrett"}, "is_accepted": false, "score": 0, "last_activity_date": 1429099723, "creation_date": 1429099723, "answer_id": 29649820, "question_id": 29516463, "link": "https://stackoverflow.com/questions/29516463/paste-text-into-excel-comment-vba/29649820#29649820", "title": "Paste text into Excel comment VBA", "body": "<p>Final code I ended up with is below. Added a loop to run through the column, and added a second reference to pull both the definition and description into the comment. Thank you Darren Bartrup-Cook for helping me out when I was stuck!</p>\n\n<pre><code>Sub Add_Comment_As_Def_Desc_Reference()\n'Posted by Jeff Barrett 2015-04-10    \n\n    Dim FindString1 As String\n    Dim Rng1 As Range\n    Dim sCommentText1 As String\n    Dim sCommentText2 As String\n    Dim str1 As String\n    Dim str2 As String\n    Dim cmmt As String\n    Dim i As Integer        \n    str1 = \"Definition: \"\n    str2 = \"Description: \"            \n 'Loop Code, must specify range for i based on # of FieldAlias    \nSheets(\"Fields\").Select\nRange(\"F4\").Select\nFor i = 4 To 59          \n    'Find Definition &amp; Description in NASDefs based on Value from FieldAlias\n    FindString1 = ActiveCell.Value\n    If Trim(FindString1) &lt;&gt; \"\" Then\n        With Sheets(\"NASDefs\").Range(\"C:C\")\n            Set Rng1 = .Find(What:=FindString1, _\n                        After:=.Cells(.Cells.Count), _\n                        LookIn:=xlValues, _\n                        LookAt:=xlWhole, _\n                        SearchOrder:=xlByRows, _\n                        SearchDirection:=xlNext, _\n                        MatchCase:=False)\n        End With\n    End If    \n            'Remove any existing comments, create comment and add text in FieldAlias\n            If Not Rng1 Is Nothing Then\n                ActiveCell.ClearComments\n                sCommentText1 = Rng1.Offset(0, 4).Value\n                sCommentText2 = Rng1.Offset(0, 5).Value\n                ActiveCell.AddComment.Text Text:=str1 &amp; Chr(10) &amp; Chr(10) &amp; sCommentText1 &amp; Chr(10) &amp; Chr(10) &amp; str2 &amp; Chr(10) &amp; Chr(10) &amp; sCommentText2\n                ActiveCell.Comment.Visible = False\n                ActiveCell.Comment.Shape.AutoShapeType = msoShapeRoundedRectangle                    \n                'Format lines of text\n                    With ActiveCell.Comment.Shape.TextFrame\n                            .Characters.Font.ColorIndex = 5\n                    End With\n                Else\n                MsgBox \"Nothing found\"\n            End If\n'End Loop\nActiveCell.Offset(RowOffset:=1, ColumnOffset:=0).Select\nNext i\n  'Resize Comment to fit text\n  'posted by Dana DeLouis  2000-09-16\n  Dim MyComments As Comment\n  Dim lArea As Long\n  For Each MyComments In ActiveSheet.Comments\n    With MyComments\n      .Shape.TextFrame.AutoSize = True\n      If .Shape.Width &gt; 300 Then\n        lArea = .Shape.Width * .Shape.Height\n        .Shape.Width = 300\n        ' An adjustment factor of 1.1 seems to work ok.\n        .Shape.Height = (lArea / 200) * 0.6\n      End If\n    End With\n  Next ' comment\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4764235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12d023e718ed177d0d1af5a006f0f1f6?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey Barrett", "link": "https://stackoverflow.com/users/4764235/jeffrey-barrett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1545, "favorite_count": 0, "accepted_answer_id": 29516974, "answer_count": 2, "score": 2, "last_activity_date": 1429099723, "creation_date": 1428500720, "last_edit_date": 1531164843, "question_id": 29516463, "link": "https://stackoverflow.com/questions/29516463/paste-text-into-excel-comment-vba", "title": "Paste text into Excel comment VBA", "body": "<p>I cannot find or create VBA code to allow pasting copied text from one cell in another sheet(sheet2) into a previously created comment in another sheet(sheet1).</p>\n\n<p>Here is the code I have successfully compiled thus far, and I am stuck on how to get the text found into the comment box.</p>\n\n<pre><code>Sub For_Reals()\n\n'Add Comment\nSheets(\"Sheet1\").Range(\"F2\").AddComment\nRange(\"F2\").Comment.Visible = False\n\n'Find Value in Sheet2 based on Value from Sheet1\nDim FindString As String\n    Dim Rng As Range\n    FindString = Sheets(\"Sheet1\").Range(\"F2\").Value\n    If Trim(FindString) &lt;&gt; \"\" Then\n        With Sheets(\"Sheet2\").Range(\"C:C\")\n            Set Rng = .Find(What:=FindString, _\n                            After:=.Cells(.Cells.Count), _\n                            LookIn:=xlValues, _\n                            LookAt:=xlWhole, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlNext, _\n                            MatchCase:=False)\n            If Not Rng Is Nothing Then\n                Application.Goto Rng, True\n            Else\n                MsgBox \"Nothing found\"\n            End If\n        End With\n    End If\n\n'Copy Value 4 cells to the right of found Value\nSelection.Offset(0, 4).Copy\n\n'Need Code to paste copied value in previously created comment\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1428500369, "post_id": 29516029, "comment_id": 47187827, "body": "What line is causing you trouble?"}, {"owner": {"reputation": 147, "user_id": 4606449, "user_type": "registered", "accept_rate": 52, "profile_image": "https://lh4.googleusercontent.com/-jlHOOlNoBmw/AAAAAAAAAAI/AAAAAAAACCI/lC6qZF8_UJ8/photo.jpg?sz=128", "display_name": "David Redden", "link": "https://stackoverflow.com/users/4606449/david-redden"}, "reply_to_user": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1428501025, "post_id": 29516029, "comment_id": 47188394, "body": "Actually, I just realized this code works; but doesn&#39;t seem very efficient. I added the row          WorkBk.Application.Run _          &quot;&#39;&quot; &amp; FileName &amp; &quot;&#39;!auto_open&quot; which invokes the macro on each xlsm file.  I was just trying to figure out if there was a more efficient method."}], "answers": [{"tags": [], "owner": {"reputation": 39, "user_id": 4763949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/489b6cf38b87f71b8afabc05ae436232?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Kononchuk", "link": "https://stackoverflow.com/users/4763949/alexander-kononchuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1428502021, "creation_date": 1428502021, "answer_id": 29517006, "question_id": 29516029, "link": "https://stackoverflow.com/questions/29516029/excel-loop-through-xlsm-files-and-copy-row-to-another-sheet/29517006#29517006", "title": "Excel, loop through XLSM files and copy row to another sheet", "body": "<p>In my case for optimization VBA we used this code before:</p>\n\n<pre><code>Application.DisplayAlerts = False\nApplication.Calculation = xlCalculationManual\nApplication.ScreenUpdating = False\nApplication.EnableCancelKey = xlDisabled\nApplication.EnableAutoComplete = False\nApplication.EnableEvents = False\nApplication.EnableLivePreview = False\nApplication.EnableMacroAnimations = False\nsourcesheet.DisplayPageBreaks = False\ndestinationSheet.DisplayPageBreaks = False\nisHidden = Sheets(destinationSheetName).Visible\nSheets(destinationSheetName).Visible = True\n</code></pre>\n\n<p>And this code after:</p>\n\n<pre><code>Application.DisplayAlerts = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\nApplication.EnableCancelKey = xlInterrupt\nApplication.EnableAutoComplete = True\nApplication.EnableEvents = True\nApplication.EnableLivePreview = True\nApplication.EnableMacroAnimations = True\nsourcesheet.DisplayPageBreaks = True\ndestinationSheet.DisplayPageBreaks = True\nSheets(destinationSheetName).Visible = isHidden\n</code></pre>\n\n<p>Most important thing is to work with visible sheet.\nIn my case code execution time on invisible sheet was a couple minutes. In case of visible sheet it took 10 sec. So, we change visibility dynamically.</p>\n"}, {"comments": [{"owner": {"reputation": 147, "user_id": 4606449, "user_type": "registered", "accept_rate": 52, "profile_image": "https://lh4.googleusercontent.com/-jlHOOlNoBmw/AAAAAAAAAAI/AAAAAAAACCI/lC6qZF8_UJ8/photo.jpg?sz=128", "display_name": "David Redden", "link": "https://stackoverflow.com/users/4606449/david-redden"}, "edited": false, "score": 0, "creation_date": 1428517704, "post_id": 29518240, "comment_id": 47199586, "body": "New issue with this code; if the xlsm file it opens has an error in its vb (which is not vb I can modify) my code bails.  Is there a way to create an ON ERROR handling after my code opens the xlsm file(s)?"}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 0, "last_activity_date": 1428504998, "creation_date": 1428504998, "answer_id": 29518240, "question_id": 29516029, "link": "https://stackoverflow.com/questions/29516029/excel-loop-through-xlsm-files-and-copy-row-to-another-sheet/29518240#29518240", "title": "Excel, loop through XLSM files and copy row to another sheet", "body": "<p>It really depends <em>where</em> you run this macro. Consider opening another workbook and placing this macro behind a sheet or module, having it interact with all 99 source files and Summary destination file. Alternatively, you can run everything from the Summary workbook, changing <code>Workbooks.Add</code> to the <code>ActiveWorkbook</code>.</p>\n\n<p>Below is a slightly revised VBA code. Rather than work with ranges, try copy and paste row by row. Also, no need for invoking the <code>Application.Run</code> macro</p>\n\n<pre><code>Sub MergeAllWorkbooks()\n    Dim SummaryWkb As Workbook, SourceWkb As Workbook\n    Dim SummarySheet As Worksheet, SourceWks As Worksheet\n    Dim FolderPath As String\n    Dim FileName As Variant\n    Dim NRow As Long\n\n    Set SummaryWkb = Workbooks.Add()\n    Set SummarySheet = SummaryWkb.Worksheets(1)\n\n    FolderPath = \"C:\\Users\\dredden2\\Documents\\SHAREPOINT ARCHIVING\\PAGESETUP\\TEST\\\"\n    FileName = Dir(FolderPath)\n\n    NRow = 1\n    While (FileName &lt;&gt; \"\")\n        If Right(FileName, 4) = \"xlsm\" Then\n\n        Set SourceWkb = Workbooks.Open(FolderPath &amp; FileName)\n        Set SourceWks = SourceWkb.Sheets(\"Retrospective Results\")\n\n        'FILE NAME COPY\n        SummarySheet.Range(\"A\" &amp; NRow) = FileName\n\n        'DATA ROW COPY\n        SourceWks.Range(\"B14:BF14\").Copy\n        SummarySheet.Range(\"B\" &amp; NRow).PasteSpecial xlPasteValues\n\n        SourceWkb.Close False\n        NRow = NRow + 1\n\n        End If\n    FileName = Dir\n    Wend\n\n    SummarySheet.Columns.AutoFit\n    SummaryWkb.SaveAs FileName:=FolderPath &amp; \"\\SummarySheet\\SummarySheet.xlsx\" _\n           , FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n\n    MsgBox \"Data successfully extracted!\", vbInformation\n\n    Set SourceWkb = Nothing\n    Set SourceWks = Nothing\n    Set SummarySheet = Nothing\n    Set SummaryWkb = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 4606449, "user_type": "registered", "accept_rate": 52, "profile_image": "https://lh4.googleusercontent.com/-jlHOOlNoBmw/AAAAAAAAAAI/AAAAAAAACCI/lC6qZF8_UJ8/photo.jpg?sz=128", "display_name": "David Redden", "link": "https://stackoverflow.com/users/4606449/david-redden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1657, "favorite_count": 1, "accepted_answer_id": 29518240, "answer_count": 2, "score": 3, "last_activity_date": 1428519982, "creation_date": 1428499700, "last_edit_date": 1428519982, "question_id": 29516029, "link": "https://stackoverflow.com/questions/29516029/excel-loop-through-xlsm-files-and-copy-row-to-another-sheet", "title": "Excel, loop through XLSM files and copy row to another sheet", "body": "<p><b>The main issue I am having with this code now is handling errors with the xlsm files I am opening.\nI have no edit rights to the VB code on these files.  Is there a way to skip over a file if the vb errors out on it?\n</b></p>\n\n<p>I have a folder with approx 99 xlsm files that I am looking to loop through each file and copy let's just say row 14 from each workbook and paste it into a separate workbook as a summary.\nHere's what I have so far; the only problem is it copies a blank row. When I stepped through the VB I could see that it doesn't run the macro on the xlsm file it opens. Anyone know some code that will help me here?</p>\n\n<pre><code> Sub MergeAllWorkbooks()\nDim SummarySheet As Worksheet\nDim FolderPath As String\nDim NRow As Long\nDim FileName As String\nDim WorkBk As Workbook\nDim SourceRange As Range\nDim DestRange As Range\nApplication.Calculation = xlCalculationAutomatic\n' Create a new workbook and set a variable to the first sheet.\nSet SummarySheet = Workbooks.Add(xlWBATWorksheet).Worksheets(1)\n\n' Modify this folder path to point to the files you want to use.\nFolderPath = \"C:\\Users\\dredden2\\Documents\\SHAREPOINT ARCHIVING\\PAGESETUP\\TEST\\\"\n\n' NRow keeps track of where to insert new rows in the destination workbook.\nNRow = 2\n\n' Call Dir the first time, pointing it to all Excel files in the folder path.\nFileName = DIR(FolderPath &amp; \"*.xlsm\")\n\n' Loop until Dir returns an empty string.\nDo While FileName &lt;&gt; \"\"\n    ' Open a workbook in the folder\n    Set WorkBk = Workbooks.Open(FolderPath &amp; FileName)\n    WorkBk.Application.EnableEvents = True\n    WorkBk.Application.DisplayAlerts = False\n    WorkBk.Application.Run _\n    \"'\" &amp; FileName &amp; \"'!auto_open\"\n    ' Set the cell in column A to be the file name.\n    SummarySheet.Range(\"A\" &amp; NRow).Value = FileName\n\n    ' Set the source range to be B14 through BF14.\n    ' Modify this range for your workbooks.\n    ' It can span multiple rows.\n    Set SourceRange = WorkBk.Sheets(\"Retrospective Results\").Range(\"B14:BF14\")\n\n    ' Set the destination range to start at column B and\n    ' be the same size as the source range.\n    Set DestRange = SummarySheet.Range(\"B\" &amp; NRow)\n    Set DestRange = DestRange.Resize(SourceRange.Rows.Count, _\n       SourceRange.Columns.Count)\n\n    ' Copy over the values from the source to the destination.\n    DestRange.Value = SourceRange.Value\n\n    ' Increase NRow so that we know where to copy data next.\n    NRow = NRow + DestRange.Rows.Count\n\n    ' Close the source workbook without saving changes.\n    WorkBk.Close savechanges:=False\n\n    ' Use Dir to get the next file name.\n    FileName = DIR()\nLoop\n\n' Call AutoFit on the destination sheet so that all\n' data is readable.\nSummarySheet.Columns.AutoFit\n\n WorkBk.Application.DisplayAlerts = False\nSummarySheet.SaveAs FileName:= _\n    FolderPath &amp; \"\\SummarySheet\\SummarySheet.xlsx\" _\n    , FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "xlsx", "worksheet", "xla"], "answers": [{"tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 1, "last_activity_date": 1428499573, "creation_date": 1428499573, "answer_id": 29515978, "question_id": 29515591, "link": "https://stackoverflow.com/questions/29515591/vba-copy-sheet-from-a-xlsx-and-insert-it-into-a-xla-file/29515978#29515978", "title": "VBA copy sheet from a .XLSX and insert it into a .XLA file", "body": "<p>The XLA sheets collection cannot be accessed for adding a new sheet as long as <code>.IsAddIn=True</code>. Try to set the XLA workbook to <code>.isAddIn = False</code>, make your copy and then set it back to <code>True</code>.</p>\n\n<p>I think it should be (to be tested): </p>\n\n<pre><code>Sub copyFromXLSXtoXLA()\n    Workbooks(1).IsAddIn = False '&lt;-- set it false\n    Workbooks(1).Sheets(1).Copy temp.ThisWorkbook.Sheets(1)  \n    Workbooks(1).IsAddIn = True '&lt;-- set it back to true\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2058, "user_id": 1720085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/31607e975427d648b2342b74cb888417?s=128&d=identicon&r=PG", "display_name": "Daniel Bonetti", "link": "https://stackoverflow.com/users/1720085/daniel-bonetti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 517, "favorite_count": 0, "accepted_answer_id": 29515978, "answer_count": 1, "score": 0, "last_activity_date": 1428499573, "creation_date": 1428498594, "question_id": 29515591, "link": "https://stackoverflow.com/questions/29515591/vba-copy-sheet-from-a-xlsx-and-insert-it-into-a-xla-file", "title": "VBA copy sheet from a .XLSX and insert it into a .XLA file", "body": "<p>I'm trying to copy a Sheet from a <code>.XLSX</code> file as a hidden sheet in a <code>.XLA</code> file. </p>\n\n<p>I only managed to copy from <code>.XLA -&gt; XLSX</code>, but not <code>XLSX -&gt; XLA</code>.</p>\n\n<p>Take a look at my two functions:</p>\n\n<pre><code>Sub copyFromXLAtoXLSX()\n    temp.Sheet1.Copy Workbooks(1).Sheets(1)  \nEnd Sub\n\nSub copyFromXLSXtoXLA()\n    ' It gives me the error: Run-time error '1004': Application-defined or object-defined error  \n    Workbooks(1).Sheets(1).Copy temp.ThisWorkbook.Sheets(1)  \nEnd Sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/5srpV.png\" alt=\"(left) copyFromXLAtoXLSXand (right) copyFromXLSXtoXLA\"></p>\n\n<p>Any help is really welcome. Thanks!</p>\n"}, {"tags": ["php", "excel", "vba"], "comments": [{"owner": {"reputation": 11283, "user_id": 1528407, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7785dc902024c1eaea11364eb9937191?s=128&d=identicon&r=PG", "display_name": "Daan", "link": "https://stackoverflow.com/users/1528407/daan"}, "edited": false, "score": 0, "creation_date": 1428498704, "post_id": 29515579, "comment_id": 47186597, "body": "Have you tried anything?"}], "answers": [{"tags": [], "owner": {"reputation": 670, "user_id": 938084, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/612Dt.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/938084/david"}, "is_accepted": false, "score": 0, "last_activity_date": 1428499759, "creation_date": 1428499759, "answer_id": 29516050, "question_id": 29515579, "link": "https://stackoverflow.com/questions/29515579/run-excel-vba-code-using-php/29516050#29516050", "title": "Run Excel VBA code using PHP", "body": "<p>You need only for this example or for all many macros ?  </p>\n\n<p>If only for this one: Use GD Library to generate image in PHP    </p>\n\n<p>If you want to convert macros to php code - that is almost impossible. You will need to write parser, which will translate macro code to php code...</p>\n"}], "owner": {"reputation": 1631, "user_id": 2944276, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/ZUot8.jpg?s=128&g=1", "display_name": "VIPIN A ROY", "link": "https://stackoverflow.com/users/2944276/vipin-a-roy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2101, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535126053, "creation_date": 1428498554, "last_edit_date": 1535126053, "question_id": 29515579, "link": "https://stackoverflow.com/questions/29515579/run-excel-vba-code-using-php", "title": "Run Excel VBA code using PHP", "body": "<p>I created Excel VBA code to create images from the corresponding URLs.</p>\n\n<p>How can I write this code while creating the Excel file using PHP?</p>\n\n<pre><code>Sub RetrieveImage()\n\n    Dim url_column As Range\n    Dim image_column As Range\n\n    Set url_column = Worksheets(1).UsedRange.Columns(\"D\")\n    Set image_column = Worksheets(1).UsedRange.Columns(\"J\")\n\n    Dim i As Long\n    For i = 2 To url_column.Cells.Count\n\n      With image_column.Worksheet.Pictures.Insert(url_column.Cells(i).Value)\n        .Left = image_column.Cells(i).Left\n        .Top = image_column.Cells(i).Top\n        image_column.Cells(i).EntireRow.RowHeight = .Height\n      End With\n\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 1285435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KqMEU.jpg?s=128&g=1", "display_name": "Gerry", "link": "https://stackoverflow.com/users/1285435/gerry"}, "edited": false, "score": 0, "creation_date": 1428497358, "post_id": 29514962, "comment_id": 47185634, "body": "Works Perfect, will now try to figure out how to do this with multiple colums."}, {"owner": {"reputation": 784, "user_id": 1507715, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yUbOV.jpg?s=128&g=1", "display_name": "Sheldon Neilson", "link": "https://stackoverflow.com/users/1507715/sheldon-neilson"}, "reply_to_user": {"reputation": 31, "user_id": 1285435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KqMEU.jpg?s=128&g=1", "display_name": "Gerry", "link": "https://stackoverflow.com/users/1285435/gerry"}, "edited": false, "score": 0, "creation_date": 1428497391, "post_id": 29514962, "comment_id": 47185659, "body": "Shout if you need a hand"}, {"owner": {"reputation": 31, "user_id": 1285435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KqMEU.jpg?s=128&g=1", "display_name": "Gerry", "link": "https://stackoverflow.com/users/1285435/gerry"}, "edited": false, "score": 0, "creation_date": 1428498720, "post_id": 29514962, "comment_id": 47186608, "body": "Worked with two columns, I select both and changed <code>Set outputCell = currentCell.Offset(0, 3)</code> and voila, all that I need!"}], "tags": [], "owner": {"reputation": 784, "user_id": 1507715, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yUbOV.jpg?s=128&g=1", "display_name": "Sheldon Neilson", "link": "https://stackoverflow.com/users/1507715/sheldon-neilson"}, "is_accepted": true, "score": 0, "last_activity_date": 1428497008, "creation_date": 1428497008, "answer_id": 29514962, "question_id": 29514741, "link": "https://stackoverflow.com/questions/29514741/transpose-cells-until-parameter/29514962#29514962", "title": "Transpose cells until parameter", "body": "<p>This will work if you highlight A-K first, so select from A2 to A12.</p>\n\n<pre><code>Sub Transpose()\n\nDim currentCell As Range\nDim outputCell As Range\n\nFor Each currentCell In Selection\n\n    If currentCell.Offset(0, 1).Value = 1 Then\n        Set outputCell = currentCell.Offset(0, 2)\n    Else\n        Set outputCell = outputCell.Offset(0, 1)\n    End If\n\n    outputCell.Value = currentCell.Value\n\nNext currentCell\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1428498008, "creation_date": 1428498008, "answer_id": 29515368, "question_id": 29514741, "link": "https://stackoverflow.com/questions/29514741/transpose-cells-until-parameter/29515368#29515368", "title": "Transpose cells until parameter", "body": "<p>Assuming <code>Item</code> is in A1, it is possible with a formula, if <code>1</code> is inserted in the first blank cell in ColumnB:  </p>\n\n<pre><code>=IFERROR(IF(AND($B2=1,COLUMN()&lt;3+MATCH($B2,$B3:$B11000,0)),OFFSET(B2,COLUMN()-3,2-COLUMN()),\"\"),\"\")\n</code></pre>\n\n<p>copied across and down to suit, until an entire column is blank. </p>\n"}], "owner": {"reputation": 31, "user_id": 1285435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KqMEU.jpg?s=128&g=1", "display_name": "Gerry", "link": "https://stackoverflow.com/users/1285435/gerry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 0, "accepted_answer_id": 29514962, "answer_count": 2, "score": 0, "last_activity_date": 1428498008, "creation_date": 1428496383, "last_edit_date": 1531161705, "question_id": 29514741, "link": "https://stackoverflow.com/questions/29514741/transpose-cells-until-parameter", "title": "Transpose cells until parameter", "body": "<p>I'm trying to transpose all cells in column \"Item\" until it encounters depth 1. Looping for +10000 cells</p>\n\n<pre><code>Item Depth\nA   1\nB   2\nC   2\nD   3\nE   4\nF   5\nG   1\nH   2\nI   2\nJ   1\nK   2\n</code></pre>\n\n<p>and I need this result:</p>\n\n<pre><code>Item Depth                      \nA   1   A   B   C   D   E   F\nB   2                       \nC   2                       \nD   3                       \nE   4                       \nF   5                       \nG   1   G   H   I           \nH   2                       \nI   2                       \nJ   1   J   K               \nK   2                       \n</code></pre>\n\n<p>I think VBA would be more appropriate for this job but I do not know where to start.</p>\n"}, {"tags": ["vba", "excel", "multidimensional-array", "filter"], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 3170858, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/e0eb3f54905c4756aeb78e55bdd987f6?s=128&d=identicon&r=PG&f=1", "display_name": "Helfenstein", "link": "https://stackoverflow.com/users/3170858/helfenstein"}, "edited": false, "score": 0, "creation_date": 1428498946, "post_id": 29514717, "comment_id": 47186759, "body": "The idea is good, but it takes all the values and not the filtered ones (on date)."}, {"owner": {"reputation": 195, "user_id": 3170858, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/e0eb3f54905c4756aeb78e55bdd987f6?s=128&d=identicon&r=PG&f=1", "display_name": "Helfenstein", "link": "https://stackoverflow.com/users/3170858/helfenstein"}, "edited": false, "score": 0, "creation_date": 1428499088, "post_id": 29514717, "comment_id": 47186858, "body": "And with strArray = Sheets(&quot;Feuil2&quot;).AutoFilter.Range.SpecialCells(xlCellTypeVis&zwnj;&#8203;ible).Value it only takes the first visible cells. So probably it has to become a kind of loop."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 195, "user_id": 3170858, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/e0eb3f54905c4756aeb78e55bdd987f6?s=128&d=identicon&r=PG&f=1", "display_name": "Helfenstein", "link": "https://stackoverflow.com/users/3170858/helfenstein"}, "edited": false, "score": 0, "creation_date": 1428499478, "post_id": 29514717, "comment_id": 47187156, "body": "What do you mean by &quot;first visible cells&quot;? first row? It&#39;s strange though... because I use <code>ShF.AutoFilter.Range.Columns(ColRef).Value</code> and it works just fine..."}, {"owner": {"reputation": 195, "user_id": 3170858, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/e0eb3f54905c4756aeb78e55bdd987f6?s=128&d=identicon&r=PG&f=1", "display_name": "Helfenstein", "link": "https://stackoverflow.com/users/3170858/helfenstein"}, "edited": false, "score": 0, "creation_date": 1428500566, "post_id": 29514717, "comment_id": 47187986, "body": "Did you filter a part of your data? I first sort the data on name and after that on date. So I got 38 rows with the first name on date and than another part with the second name. So 1-38 and than 129-218 and so on. So your code cuts after 38. Here they find the same: <a href=\"http://www.pcreview.co.uk/threads/autofilter-range-visible-cells-to-array.1020620/\" rel=\"nofollow noreferrer\">pcreview.co.uk/threads/&hellip;</a>"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 195, "user_id": 3170858, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/e0eb3f54905c4756aeb78e55bdd987f6?s=128&d=identicon&r=PG&f=1", "display_name": "Helfenstein", "link": "https://stackoverflow.com/users/3170858/helfenstein"}, "edited": false, "score": 0, "creation_date": 1428503947, "post_id": 29514717, "comment_id": 47190699, "body": "I&#39;ll be careful with mine because it doesn&#39;t seem to work elsewhere!^^ Does the <code>.Count</code> property give you 38 after filter? Did you try to go through rows and test if visible? Or you can try to use <code>MS Forms 2.0 Object Library</code> (if you don&#39;t find it, look for fm20.dll on disk and add it in References) and use <code>GetFromClipboard</code> and <code>PutInClipboard</code> functions (I&#39;m short on time and will have some tomorrow to continue to help)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1428496639, "last_edit_date": 1428496639, "creation_date": 1428496320, "answer_id": 29514717, "question_id": 29514518, "link": "https://stackoverflow.com/questions/29514518/copy-a-filtered-excelsheet-into-a-multi-array-in-vba/29514717#29514717", "title": "Copy a filtered Excelsheet into a multi array in VBA", "body": "<p>You should do something like this :</p>\n\n<pre><code>strArray= Sheets(Sheet_name).AutoFilter.Range.Value\n</code></pre>\n\n<p>And you have convert a Range to an Array!</p>\n"}, {"tags": [], "owner": {"reputation": 195, "user_id": 3170858, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/e0eb3f54905c4756aeb78e55bdd987f6?s=128&d=identicon&r=PG&f=1", "display_name": "Helfenstein", "link": "https://stackoverflow.com/users/3170858/helfenstein"}, "is_accepted": false, "score": 1, "last_activity_date": 1428525242, "creation_date": 1428525242, "answer_id": 29524830, "question_id": 29514518, "link": "https://stackoverflow.com/questions/29514518/copy-a-filtered-excelsheet-into-a-multi-array-in-vba/29524830#29524830", "title": "Copy a filtered Excelsheet into a multi array in VBA", "body": "<p>Sometimes I am not so good in thinking. To check for hidden rows gave me the answer! This did the trick!</p>\n\n<pre><code>    k = 1\nFor i = 1 To LastRow\n    For j = 1 To 9\n    If Sheets(\"Feuil2\").Rows(i).Hidden = False Then\n    strArray(k, j) = Cells(i, j).Value2\n    Else\n    End If\n    Next j\n    If Sheets(\"Feuil2\").Rows(i).Hidden = False Then\n    k = k + 1\n    Else\n    End If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 195, "user_id": 3170858, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/e0eb3f54905c4756aeb78e55bdd987f6?s=128&d=identicon&r=PG&f=1", "display_name": "Helfenstein", "link": "https://stackoverflow.com/users/3170858/helfenstein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 943, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1428525242, "creation_date": 1428495803, "question_id": 29514518, "link": "https://stackoverflow.com/questions/29514518/copy-a-filtered-excelsheet-into-a-multi-array-in-vba", "title": "Copy a filtered Excelsheet into a multi array in VBA", "body": "<p>I have read here and there something about SpecialCells(xlCellTypeVisible), but I don't manage to get it into the code.\nI want to copy a filtered Excel sheet with multiple columns and rows into an array, without using a new sheet to copy it from.</p>\n\n<p>For the moment is this my code (for an unfiltered sheet):</p>\n\n<pre><code>    For i = 1 To LastRow\n        For j = 1 To 9\n        strArray(i, j) = Cells(i, j).Value2\n        Next j\n    Next i\n</code></pre>\n\n<p>Any hints or clues how to do it?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 4763817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a367a8e42f9425fa7f5d334af1484a4e?s=128&d=identicon&r=PG&f=1", "display_name": "Mahendra Mistry", "link": "https://stackoverflow.com/users/4763817/mahendra-mistry"}, "edited": false, "score": 0, "creation_date": 1428495865, "post_id": 29514431, "comment_id": 47184578, "body": "hello experts, I&#39;ve a file which runs the abv code and keeps on running every minute to get me updated data on a stock (GOOGLE).. abv codes includes with two worksheet.. I want to add same two more worksheet to run to other stock say (YAHOO) in the same xls.. will it be possible using the same VBA or will need to add similiar vba code if so, what are the changes i need to make with abv codes .. please help.. I tried using opening two files separately after renaming but it was not updating.. together only updates last accessed or active excel sheet"}, {"owner": {"reputation": 3919, "user_id": 326040, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9c0f940a01e5226e1a4a42007e2aa3fb?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/326040/tim"}, "edited": false, "score": 0, "creation_date": 1428498154, "post_id": 29514431, "comment_id": 47186219, "body": "Welcome to StackOverflow! You really ought to move the comment above into the text of your question (probably before your code sample). I didn&#39;t realize it was there when I looked at your question."}], "answers": [{"tags": [], "owner": {"reputation": 471, "user_id": 4616423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86a46559e4c3f1704e0ba1ddfa70cc88?s=128&d=identicon&r=PG&f=1", "display_name": "rgo", "link": "https://stackoverflow.com/users/4616423/rgo"}, "is_accepted": false, "score": 0, "last_activity_date": 1428540474, "creation_date": 1428540474, "answer_id": 29527842, "question_id": 29514431, "link": "https://stackoverflow.com/questions/29514431/what-to-change-to-use-it-in-other-worksheet-of-same-xls/29527842#29527842", "title": "what to change to use it in other worksheet of same xls", "body": "<p>You can condense your code by using an outer loop that changes from one sheet to the next and populates each with a different dataset based on your lookup value.</p>\n\n<p>One way is to pass the ticker as an argument</p>\n\n<pre><code>Call LoadFromYahoo(\"MSFT\")\nCall LoadFromYahoo(\"BOA\")\n...\n</code></pre>\n\n<p>Or you could put a list of tickers on one sheet and read the list, adding new worksheets for each ticker, then loading the data and renaming the tab to the ticker.</p>\n\n<pre><code>public sub    LoadFromYahoo()\n\n  Dim tWS as worksheet\n  dim aCell as range\n  dim sWS as worksheet\n\n  set sws = thisworkbook.sheets(\"Sheet1\")    'List of tickers in column A\n  for each acell in intersect(sws.range(\"A1\").entirecolumn, sws.usedrange)\n    set tws = worksheets.add\n    with tws\n       call GetFromYahoo(acell.value)  'function to make your yahoo call\n    end with\n  next acell\n\nexit sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4763817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a367a8e42f9425fa7f5d334af1484a4e?s=128&d=identicon&r=PG&f=1", "display_name": "Mahendra Mistry", "link": "https://stackoverflow.com/users/4763817/mahendra-mistry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1428540474, "creation_date": 1428495556, "last_edit_date": 1428497693, "question_id": 29514431, "link": "https://stackoverflow.com/questions/29514431/what-to-change-to-use-it-in-other-worksheet-of-same-xls", "title": "what to change to use it in other worksheet of same xls", "body": "<pre><code>Option Explicit\nDim numRows1 As Integer\n\nSub GetData()\n    Dim ParameterSheet As Worksheet\n    Dim DataSheet As Worksheet\n    Dim ticker As String\n    Dim exchange As String\n    Dim interval As Integer\n    Dim numPastTradingDays As Integer\n    Dim qurl As String\n\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    Application.Calculation = xlCalculationManual\n\n    Set ParameterSheet = Sheets(\"Parameters\")\n    Set DataSheet = Sheets(\"Data\")\n\n    Dim Fields1() As String\n    Fields1 = Split(ParameterSheet.Range(\"ticker\").Value, \",\")\n\n    DataSheet.Cells.Clear\n    DataSheet.Range(\"e24\") = \"Spread\"\n    DataSheet.Range(\"f24\") = \"Average\"\n    ticker = Fields1(0)\n    exchange = ParameterSheet.Range(\"exchange\").Value\n    interval = ParameterSheet.Range(\"interval\").Value\n    numPastTradingDays = ParameterSheet.Range(\"numTradingDays\").Value\n\n    qurl = \"http://www.google.com/finance/getprices?\" &amp; _\n           \"q=\" &amp; ticker &amp; _\n           \"&amp;x=NSE\" &amp; _\n           \"&amp;i=\" &amp; interval &amp; _\n           \"&amp;p=\" &amp; numPastTradingDays &amp; \"d\" &amp; _\n           \"&amp;f=c\"\n           '\"&amp;f=d,o,h,l,c\"\n\n\nQueryQuote:\n    With DataSheet.QueryTables.Add(Connection:=\"URL;\" &amp; qurl, Destination:=DataSheet.Range(\"a18\"))\n        .BackgroundQuery = True\n        .TablesOnlyFromHTML = False\n        .Refresh BackgroundQuery:=False\n        .SaveData = True\n    End With\n\n    DataSheet.Range(\"a18\").CurrentRegion.TextToColumns Destination:=DataSheet.Range(\"a18\"), DataType:=xlDelimited, _\n                                                      TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n                                                      Semicolon:=False, Comma:=True, Space:=False, other:=False\n\n    DataSheet.Columns(\"A:G\").ColumnWidth = 12\n\n    '===Convert Google timestamp to Excel timestamp (only for Windows)\n    Dim timeStamp As Double\n    Dim timeStampRaw As String\n    Dim timeZoneOffsetRaw As String\n    Dim timeZoneOffset As Variant\n\n    Dim i As Integer\n    numRows1 = DataSheet.UsedRange.Rows.count - 1\n    numRows1 = numRows1 + 17\n    timeZoneOffsetRaw = DataSheet.Range(\"a24\")\n    timeZoneOffset = (Mid(timeZoneOffsetRaw, InStr(timeZoneOffsetRaw, \"=\") + 1, 10))\n\n    For i = 25 To numRows1\n\n        If Not IsNumeric(DataSheet.Range(\"a\" &amp; i)) Then\n\n            timeStampRaw = DataSheet.Range(\"a\" &amp; i)\n            timeStamp = (Mid(timeStampRaw, 2, Len(timeStampRaw) - 1))\n            timeStamp = (timeStamp + timeZoneOffset * 60)\n            DataSheet.Range(\"b\" &amp; i) = timeStamp / 86400 + 25569\n\n        Else\n\n            DataSheet.Range(\"b\" &amp; i).FormulaR1C1 = \"=(RC[-6]*\" &amp; interval &amp; \"+\" &amp; timeStamp &amp; \")/86400+25569\"\n\n        End If\n\n    Next\n\n    DataSheet.Range(\"b8:b\" &amp; numRows1).NumberFormat = \"d mmm yyyy h:mm;@\"\n    DataSheet.Range(\"B:B\").Columns.AutoFit\n    'DataSheet.UsedRange.Rows.count\n    Application.Calculation = xlCalculationAutomatic\n\n    Call GetData2\n\nEnd Sub\n\nSub GetData2()\n    Dim ParameterSheet As Worksheet\n    Dim DataSheet As Worksheet\n    Dim ticker2 As String\n    Dim exchange As String\n    Dim interval As Integer\n    Dim numPastTradingDays As Integer\n    Dim qurl As String\n\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    Application.Calculation = xlCalculationManual\n\n    Set ParameterSheet = Sheets(\"Parameters\")\n    Set DataSheet = Sheets(\"Data\")\n\n    '--DataSheet.Cells.Clear\n    Dim Fields() As String\n    Fields = Split(ParameterSheet.Range(\"ticker\").Value, \",\")\n    'Print Fields(0) 'Name\n    'Print Fields(1) 'Dept\n\n    'ticker2 = ParameterSheet.Range(\"ticker\").Value\n    ticker2 = Fields(1)\n    exchange = ParameterSheet.Range(\"exchange\").Value\n    interval = ParameterSheet.Range(\"interval\").Value\n    numPastTradingDays = ParameterSheet.Range(\"numTradingDays\").Value\n\n    qurl = \"http://www.google.com/finance/getprices?\" &amp; _\n           \"q=\" &amp; ticker2 &amp; _\n           \"&amp;x=NSE\" &amp; _\n           \"&amp;i=\" &amp; interval &amp; _\n           \"&amp;p=\" &amp; numPastTradingDays &amp; \"d\" &amp; _\n            \"&amp;f=c\"\n           '\"&amp;f=d,o,h,l,c\"\n\nQueryQuote:\n    With DataSheet.QueryTables.Add(Connection:=\"URL;\" &amp; qurl, Destination:=DataSheet.Range(\"i18\"))\n        .BackgroundQuery = True\n        .TablesOnlyFromHTML = False\n        .Refresh BackgroundQuery:=False\n        .SaveData = True\n    End With\n\n    DataSheet.Range(\"i18\").CurrentRegion.TextToColumns Destination:=DataSheet.Range(\"i18\"), DataType:=xlDelimited, _\n                                                      TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n                                                      Semicolon:=False, Comma:=True, Space:=False, other:=False\n\n    DataSheet.Columns(\"I:O\").ColumnWidth = 12\n\n    '===Convert Google timestamp to Excel timestamp (only for Windows)\n    Dim timeStamp As Double\n    Dim timeStampRaw As String\n    Dim timeZoneOffsetRaw As String\n    Dim timeZoneOffset As Variant\n    Dim numRows As Integer\n    Dim i As Integer\n    Dim x As Integer\n    numRows = DataSheet.UsedRange.Rows.count - 1\n\n    timeZoneOffsetRaw = DataSheet.Range(\"i24\")\n    timeZoneOffset = (Mid(timeZoneOffsetRaw, InStr(timeZoneOffsetRaw, \"=\") + 1, 10))\n\n    For i = 25 To numRows\n\n        If Not IsNumeric(DataSheet.Range(\"i\" &amp; i)) Then\n\n            timeStampRaw = DataSheet.Range(\"i\" &amp; i)\n            timeStamp = (Mid(timeStampRaw, 2, Len(timeStampRaw) - 1))\n            timeStamp = (timeStamp + timeZoneOffset * 60)\n            DataSheet.Range(\"j\" &amp; i) = timeStamp / 86400 + 25569\n\n        Else\n\n            DataSheet.Range(\"j\" &amp; i).FormulaR1C1 = \"=(RC[-6]*\" &amp; interval &amp; \"+\" &amp; timeStamp &amp; \")/86400+25569\"\n\n        End If\n\n    Next\n\n    DataSheet.Range(\"j8:j\" &amp; numRows).NumberFormat = \"d mmm yyyy h:mm;@\"\n    DataSheet.Range(\"J:J\").Columns.AutoFit\n\n    Application.Calculation = xlCalculationAutomatic\n\n\n    '----Logic for spread and average\n    'For i = 1 To (numRows + 7)\n\n    'For i = 1 to\n\n    For i = 25 To (numRows1 + 1)\n        If i = 1 Then\n          i = i + 24\n        Else\n        End If\n        If Trim(DataSheet.Range(\"a\" &amp; i)) = \"\" Or Trim(DataSheet.Range(\"i\" &amp; i)) = \"\" Then\n\n        Else\n         DataSheet.Range(\"e\" &amp; i) = \"=\" &amp; (DataSheet.Range(\"a\" &amp; i) &amp; \"/\" &amp; DataSheet.Range(\"i\" &amp; i))\n        End If\n\n    Next\n\n   ' If numRows1 = 24 Then\n   '     DataSheet.Range(\"e25\") = \"=\" &amp; (DataSheet.Range(\"a25\") &amp; \"/\" &amp; DataSheet.Range(\"i25\"))\n   ' ElseIf numRows1 = 25 Then\n   '     DataSheet.Range(\"e26\") = \"=\" &amp; (DataSheet.Range(\"a26\") &amp; \"/\" &amp; DataSheet.Range(\"i26\"))\n   ' ElseIf numRows1 = 26 Then\n   '     DataSheet.Range(\"e27\") = \"=\" &amp; (DataSheet.Range(\"a27\") &amp; \"/\" &amp; DataSheet.Range(\"i27\"))\n   ' End If\n\n\n    i = 0\n\n\n    If Trim(DataSheet.Range(\"e\" &amp; (numRows1 + 1))) = \"\" Then\n       numRows1 = numRows1 - 1\n    End If\n    For i = 1 To (numRows1 + 1)\n        If i = 1 Then\n          i = i + 24\n        Else\n\n        End If\n       ' If numRows1 = 24 Then\n       '     DataSheet.Range(\"f25\") = \"=\" &amp; \"Average(\" &amp; (DataSheet.Range(\"e25\") &amp; \"/\" &amp; DataSheet.Range(\"e25\")) &amp; \")\"\n       ' ElseIf numRows1 = 25 Then\n       '     DataSheet.Range(\"f25\") = \"=\" &amp; \"Average(\" &amp; (DataSheet.Range(\"e25\") &amp; \"/\" &amp; DataSheet.Range(\"e26\")) &amp; \")\"\n        '    DataSheet.Range(\"f26\") = \"=\" &amp; \"Average(\" &amp; (DataSheet.Range(\"e26\") &amp; \"/\" &amp; DataSheet.Range(\"e26\")) &amp; \")\"\n       ' Else\n\n        'DataSheet.Range(\"f\" &amp; i) = \"=\" &amp; \"Average(\" &amp; (DataSheet.Range(\"e\" &amp; i) &amp; \":\" &amp; DataSheet.Range(\"e\" &amp; (numRows1 + 1))) &amp; \")\"\n        If i = 25 Then\n          DataSheet.Range(\"f\" &amp; i) = \"=\" &amp; \"Average(E\" &amp; i &amp; \":\" &amp; \"E\" &amp; (numRows1 + 1) &amp; \")\"\n        Else\n          DataSheet.Range(\"f\" &amp; i) = DataSheet.Range(\"f25\")\n        End If\n    Next\n\n    Application.OnTime Now + TimeValue(\"00:01:10\"), \"GetData\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "vb6", "vb6-migration"], "comments": [{"owner": {"reputation": 7011, "user_id": 2416510, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/x3dSY.jpg?s=128&g=1", "display_name": "Nadeem_MK", "link": "https://stackoverflow.com/users/2416510/nadeem-mk"}, "edited": false, "score": 0, "creation_date": 1428494842, "post_id": 29514075, "comment_id": 47183842, "body": "What&#39;s the use of the <code>$</code> sign?"}, {"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "reply_to_user": {"reputation": 7011, "user_id": 2416510, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/x3dSY.jpg?s=128&g=1", "display_name": "Nadeem_MK", "link": "https://stackoverflow.com/users/2416510/nadeem-mk"}, "edited": false, "score": 2, "creation_date": 1428494917, "post_id": 29514075, "comment_id": 47183890, "body": "@Nadeem_MK it is old-school VB6 syntax.  VB6 did not have a native means to change just the first letter.  Also we have no idea where the code is located or how (or even if)  it is invoked."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 1, "creation_date": 1428525111, "post_id": 29514075, "comment_id": 47203919, "body": "@Plutonix It&#39;s not really about old-school syntax. String functions in VB6 exist in pairs - one accepts and returns <code>Variant</code>s, the other one accepts and returns <code>String</code>s. The strongly typed ones end with <code>$</code>. Both are useful in different contexts, so if you have a string variable to begin with, it&#39;s better to use <code>UCase$</code> than <code>UCase</code>."}, {"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1428525888, "post_id": 29514075, "comment_id": 47204331, "body": "@GSerg,  <code>RTrim$</code>, <code>UCase$</code> etc are actually <i>very</i> old school dating back to ROM Basic.  The non type specifier variety (<code>UCase</code>) are relative newcomers (VB5 or 6).  But both versions take and return strings.  Maybe vba or  something else uses variant, but not VB6.  From Object browser (which has both defs): <code>Function UCase(String) ...Returns the specified string, converted to uppercase</code>"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1428528649, "post_id": 29514075, "comment_id": 47205764, "body": "@Plutonix <code>String</code> here is the name of the parameter, not the type. When the type is <code>Variant</code>, the Object Browser omits it completely. Compare with <code>UCase$(String As String)</code>. Also note there is no return type for <code>UCase(String)</code>, again that means the return type is omitted because it&#39;s <code>Variant</code>. The other one is <code>UCase$(String As String) As String</code>. Same thing happens in VBA. But you are right that the dollar sign itself originates from very long time ago."}, {"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1428535849, "post_id": 29514075, "comment_id": 47208493, "body": "@GSerg   The MSDN entry for VBA&#39;s UCase is different than VB6 SP3 Object Browser entry (<code>Returns the specified string...</code>).  Whether you use UCase or UCase$ VB6 allows a Date, String, Variant or integer to be passed.  The return for both is <i>normally</i> a string (VarType vbString).  But if you Type the return variable (`s% = UCase$()) VB6 would perform a type conversion (not unlike Option Infer...gone wild).  Because of the weak typing, there was always unseen conversions about.  There might be a way to force a variant return/assignment, but it usually is vbString."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1428567157, "post_id": 29514075, "comment_id": 47219429, "body": "@Plutonix <code>Returns the specified string</code> really means &quot;Returns the specified string in a Variant/String&quot;. The wording is simple in order to not confuse those VB users who don&#39;t want to know details. Yes, VB6 is all about implicit conversions, and you can pass almost anything, but before the argument reaches the function, it is converted to a string or a variant. Same with the return type, you can assign a variant to a string anytime, so you can do that with the function result too. That however doesn&#39;t change the fact that one returns a <code>String</code> and the other one a <code>Variant&#47;String</code>."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1428567969, "post_id": 29514075, "comment_id": 47219892, "body": "In fact, the easiest way is to check the VB6 type library: <code>[entry(30), helpcontext(000F6EAB)] BSTR _stdcall _B_str_UCase([in] BSTR String); [entry(31), helpcontext(000F659B)] VARIANT _stdcall _B_var_UCase([in] VARIANT* String);</code>."}, {"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1428583454, "post_id": 29514075, "comment_id": 47229708, "body": "@GSerg Yes, the implementation details are different.  But in the immediate window, <code>? vartype(UCase(42))</code> or <code>? vartype(UCase(&quot;foo&quot;))</code>  or even a date literal prints 8  indicating vbString is returned <i>before</i> any assignment conversion can happen.  They are not the same function, but they are functionally the same and interchangeable (even passed a Variant, it comes back as String).  It looks like they were trying to use the new Variant in place of whatever type conversions were needed with the old method.  It hardly matters with such a relic.  Sorry to the OP for the hijack!"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1428584044, "post_id": 29514075, "comment_id": 47230140, "body": "@Plutonix <code>VarType</code> is a regular function, not a language construct, and it is declared to accept a parameter of type <code>VARIANT*</code>, so the compiler has to pack the true String returned by <code>UCase$</code> into a <code>Variant&#47;String</code> before passing it to <code>VarType</code>, which makes <code>VarType(UCase(&quot;a&quot;))</code> to appear exactly the same as <code>VarType(UCase$(&quot;a&quot;))</code>. Yes, they are absolutely interchangeable, but the difference may become important for big strings, because this variant-string conversion creates copies."}], "answers": [{"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1428525220, "post_id": 29524420, "comment_id": 47203978, "body": "<code>vbProperCase</code> will change all first letters, not <i>the</i> first letter."}, {"owner": {"reputation": 154, "user_id": 4752768, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9068fbe5e63599418744af4274df3ecb?s=128&d=identicon&r=PG", "display_name": "Serenity", "link": "https://stackoverflow.com/users/4752768/serenity"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1428525318, "post_id": 29524420, "comment_id": 47204037, "body": "The text only has one word in it. Read the whole question, it&#39;s someone&#39;s first name."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1428525638, "post_id": 29524420, "comment_id": 47204200, "body": "I read the whole question and I did not find &quot;the text only has one word&quot; in it. At the same time I am aware of multi-word last names where not all words must be uppercase (e.g. &quot;der&quot;)."}, {"owner": {"reputation": 154, "user_id": 4752768, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9068fbe5e63599418744af4274df3ecb?s=128&d=identicon&r=PG", "display_name": "Serenity", "link": "https://stackoverflow.com/users/4752768/serenity"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1428569901, "post_id": 29524420, "comment_id": 47221012, "body": "<code>txtFirstName</code> was the clue"}, {"owner": {"reputation": 154, "user_id": 4752768, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9068fbe5e63599418744af4274df3ecb?s=128&d=identicon&r=PG", "display_name": "Serenity", "link": "https://stackoverflow.com/users/4752768/serenity"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1428580889, "post_id": 29524420, "comment_id": 47227912, "body": "@GSerg VERY SILENT AREN&#39;T YOU"}], "tags": [], "owner": {"reputation": 154, "user_id": 4752768, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9068fbe5e63599418744af4274df3ecb?s=128&d=identicon&r=PG", "display_name": "Serenity", "link": "https://stackoverflow.com/users/4752768/serenity"}, "is_accepted": false, "score": -1, "last_activity_date": 1428536687, "last_edit_date": 1428536687, "creation_date": 1428523846, "answer_id": 29524420, "question_id": 29514075, "link": "https://stackoverflow.com/questions/29514075/upper-case-in-vb-6-text-box/29524420#29524420", "title": "Upper Case in VB 6 text box", "body": "<pre><code>StrConv Function\n\n\nReturns a Variant (String) converted as specified. \n\nSyntax\n\nStrConv(string, conversion, LCID)\n\nThe StrConv function syntax has these named arguments:\n\nPart Description \nstring Required. String expression to be converted. \nconversion Required. Integer. The sum of values specifying the type of conversion to perform. \nLCID Optional. The LocaleID, if different than the system LocaleID. (The system LocaleID is the default.) \n\n\nSettings\n\nThe conversion argument settings are:\n\nConstant Value Description \nvbUpperCase 1 Converts the string to uppercase characters. \nvbLowerCase 2 Converts the string to lowercase characters. \nvbProperCase 3 Converts the first letter of every word in string to uppercase. \n\nAND THERE IS MORE ...\n</code></pre>\n\n<p><strong>TO GSERGE</strong></p>\n\n<p>$ means nothing when applied to a function name as opposed to a variable name. VBA uses $ AND B as a suffix to denote similar functionality.</p>\n\n<p><strong>VB6 IS VBA</strong> the person who said <em>maybe in VB6 but not in VBA</em>. VB6 program host VBA as their programming language. VB6 on it's own are some app objects and the forms package only - no programming language. It's best to think of VB6 as a VBA host like Office.</p>\n\n<p>If you want to proper case see this WORDBASIC Ver 6 code, (which word 2003 helpfully converted to vba).</p>\n\n<pre><code>Private Declare Function GetAsyncKeyState Lib \"user32\" (ByVal vKey As Long) As Integer\nPublic Sub MAIN()\nSelect Case WordBasic.Int(GetModifer)\n        Case 0\n                WordBasic.ChangeCase\n        Case 1\n                WordBasic.ChangeCase 4\n        Case 2\n                WordBasic.ChangeCase 2\n        Case 3\n                ProperCase\n        Case Else\n                WordBasic.ChangeCase\nEnd Select\nEnd Sub\n\nPrivate Sub ProperCase()\nDim F\nDim z\nDim a$\nDim P\nF = 1\nWordBasic.ChangeCase 2\nWordBasic.EditBookmark Name:=\"SerenityChangeCase\", SortBy:=0, Add:=1\nz = WordBasic.GetSelEndPos()\nWordBasic.CharLeft 1\n        While WordBasic.GetSelEndPos() &lt; z And Not WordBasic.AtEndOfDocument()\n                WordBasic.SelectCurWord\n                a$ = WordBasic.[Selection$]()\n                P = 0\n                If LCase(a$) = \"a\" Then\n                        P = 1\n                ElseIf LCase(a$) = \"an\" Then\n                        P = 1\n                ElseIf LCase(a$) = \"as\" Then\n                        P = 1\n                ElseIf LCase(a$) = \"at\" Then\n                        P = 1\n                ElseIf LCase(a$) = \"be\" Then\n                        P = 1\n                ElseIf LCase(a$) = \"by\" Then\n                        P = 1\n                ElseIf LCase(a$) = \"in\" Then\n                        P = 1\n                ElseIf LCase(a$) = \"is\" Then\n                        P = 1\n                ElseIf LCase(a$) = \"of\" Then\n                        P = 1\n                ElseIf LCase(a$) = \"on\" Then\n                        P = 1\n                ElseIf LCase(a$) = \"or\" Then\n                        P = 1\n                ElseIf LCase(a$) = \"to\" Then\n                        P = 1\n                ElseIf LCase(a$) = \"and\" Then\n                        P = 1\n                ElseIf LCase(a$) = \"are\" Then\n                        P = 1\n                ElseIf LCase(a$) = \"for\" Then\n                        P = 1\n                ElseIf LCase(a$) = \"the\" Then\n                        P = 1\n                ElseIf LCase(a$) = \"from\" Then\n                        P = 1\n                ElseIf LCase(a$) = \"what\" Then\n                        P = 1\n                ElseIf LCase(a$) = \"with\" Then\n                        P = 1\n                End If\n                If P = 1 And F = 0 Then WordBasic.Insert LCase(a$)\n                WordBasic.WordRight 1\n                F = 0\n        Wend\nWordBasic.WW7_EditGoTo Destination:=\"SerenityChangeCase\"\nWordBasic.EditBookmark Name:=\"SerenityChangeCase\", SortBy:=0, Delete:=1\nEnd Sub\n\nPrivate Function GetModifer()\nDim a\nDim B\nDim c\nDim X\n        a = GetAsyncKeyState(16)\n        B = GetAsyncKeyState(17)\n        c = GetAsyncKeyState(18)\n        X = 0\n        If a &lt; 0 Then X = X + 1\n        If B &lt; 0 Then X = X + 2\n        If c &lt; 0 Then X = X + 4\nGetModifer = X\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4257, "user_id": 731678, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/ToekE.jpg?s=128&g=1", "display_name": "Francis Ducharme", "link": "https://stackoverflow.com/users/731678/francis-ducharme"}, "is_accepted": false, "score": 0, "last_activity_date": 1428525195, "last_edit_date": 1428525195, "creation_date": 1428524690, "answer_id": 29524678, "question_id": 29514075, "link": "https://stackoverflow.com/questions/29514075/upper-case-in-vb-6-text-box/29524678#29524678", "title": "Upper Case in VB 6 text box", "body": "<p>Use the <code>LostFocus</code> event</p>\n\n<pre><code>Private Sub yourTextBox_LostFocus()\n    With yourTextBox\n        'first letter in upper case, the rest, untouched.\n        .Text = UCase(Mid(.Text, 1, 1)) &amp; Mid(.Text, 2, Len(.Text))\n    End With\nEnd Sub\n</code></pre>\n\n<p>Apply the same logic to the <code>KeyDown</code> event and check if the pressed key is the space key.</p>\n\n<pre><code>Private Sub yourTextBox_KeyDown(KeyCode As Integer, Shift As Integer)\n    If KeyCode = 32 Then\n        With yourTextBox\n            'first letter in upper case, the rest, untouched.\n            .Text = UCase(Mid(.Text, 1, 1)) &amp; Mid(.Text, 2, Len(.Text))\n            .SelStart = Len(.Text) 'put the cursor at the end of the textbox...\n        End With\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 12723183, "user_type": "registered", "profile_image": "https://graph.facebook.com/1857773154356118/picture?type=large", "display_name": "Jignesh Ravte", "link": "https://stackoverflow.com/users/12723183/jignesh-ravte"}, "is_accepted": true, "score": 2, "last_activity_date": 1590492823, "last_edit_date": 1590492823, "creation_date": 1590469120, "answer_id": 62014945, "question_id": 29514075, "link": "https://stackoverflow.com/questions/29514075/upper-case-in-vb-6-text-box/62014945#62014945", "title": "Upper Case in VB 6 text box", "body": "<p>It's just simple just do this in the text box keypress events...</p>\n\n<pre><code>Private sub textbox_keypress(KeyAscii As Integer)\n      KeyAscii = Asc(UCase(Chr(KeyAscii)))\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 1524252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5a1bed2d45e71346456edbef1c2a20f?s=128&d=identicon&r=PG", "display_name": "Mike Dickerson", "link": "https://stackoverflow.com/users/1524252/mike-dickerson"}, "is_accepted": false, "score": 0, "last_activity_date": 1593708839, "creation_date": 1593708839, "answer_id": 62701385, "question_id": 29514075, "link": "https://stackoverflow.com/questions/29514075/upper-case-in-vb-6-text-box/62701385#62701385", "title": "Upper Case in VB 6 text box", "body": "<p>OK.  Yeah txtFirstName is a good indicator of usage here.. So I'd use  (sort of) Title Caps And I'd do it on the Validate event.. So</p>\n<pre><code>Private Sub txtFirstName_Validate(Cancel As Boolean)\n    Dim p As Integer ' i doubt we'll use more than 32K for a name....\n    Dim mName As String\n    p = 1\n    ' first off lets trim any leading blanks.. assume NOTHING and make sure its all lower case..\n    mName = LCase(LTrim(txtFirstName))\n    Do While p &gt; 0 And p &lt;= Len(txtFirstName) ' start with the first non-blank\n        \n        Mid(mName, p, 1) = UCase(Mid(mName, p, 1))\n        p = InStr(p, mName, &quot; &quot;)\n        If p &gt; 0 And p &lt; Len(mName) Then p = p + 1\n    Loop\n    Cancel = False\n    txtFirstName = mName\nEnd Sub\n</code></pre>\n<p>Works every time, and capitalizes each word.. Didn't add any code to to do TRUE title caps but this is close, and short &amp; easy...</p>\n"}], "owner": {"reputation": 409, "user_id": 2650834, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c6606f3e8509cfd8f2666db571620e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan Gharti", "link": "https://stackoverflow.com/users/2650834/jeevan-gharti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13913, "favorite_count": 0, "accepted_answer_id": 62014945, "answer_count": 4, "score": 1, "last_activity_date": 1593708839, "creation_date": 1428494570, "last_edit_date": 1433692445, "question_id": 29514075, "link": "https://stackoverflow.com/questions/29514075/upper-case-in-vb-6-text-box", "title": "Upper Case in VB 6 text box", "body": "<p>How to make first letter in upper case while pressing tab or space in <code>vb 6.0</code> ?</p>\n\n<p>My code is as follows</p>\n\n<pre><code>txtFirstName.Text = UCase$(txtFirstName.Text)\n</code></pre>\n\n<p>but it doesn't change after tab or space</p>\n"}, {"tags": ["excel", "worksheet-function", "protection", "vba"], "answers": [{"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": true, "score": 2, "last_activity_date": 1428495394, "creation_date": 1428495394, "answer_id": 29514371, "question_id": 29513793, "link": "https://stackoverflow.com/questions/29513793/restrain-user-interaction-within-a-specific-cell-range-in-a-sheet/29514371#29514371", "title": "Restrain user interaction within a specific cell range in a sheet", "body": "<p>Lock all the cells in the sheet (that is the default), unlock A1:G10 (HOME > Cells - Format, Protection, uncheck Locked) and Protect Sheet... with only <em>Select unlocked cells</em> checked.  </p>\n\n<p>If you then select A1 and keep pressing enter you will see the selection is restricted to the range you chose.</p>\n"}], "owner": {"reputation": 159, "user_id": 4042816, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/575ba0fc635267c6c54d093709c34b94?s=128&d=identicon&r=PG&f=1", "display_name": "Bruno Lopes", "link": "https://stackoverflow.com/users/4042816/bruno-lopes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 29514371, "answer_count": 1, "score": 0, "last_activity_date": 1429238011, "creation_date": 1428493825, "last_edit_date": 1531161705, "question_id": 29513793, "link": "https://stackoverflow.com/questions/29513793/restrain-user-interaction-within-a-specific-cell-range-in-a-sheet", "title": "Restrain user interaction within a specific cell range in a sheet", "body": "<p>I would like to limit the range in which the user can navigate though the cells. To explain better, suppose that range is within the rows 1 to 10 and columns A to G. The user cannot select any cell outside that limit or explore cells outside that boundary.</p>\n\n<p>Is there any way to accomplish this using VBA or Excel functions?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1428495684, "post_id": 29513275, "comment_id": 47184441, "body": "You never set wbNew...<code>&#39;change here sheet nr!!!!!!! wbNew.Sheets(17).Activate</code> in the second macro"}, {"owner": {"reputation": 179, "user_id": 2151190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe0e8248a04a4e87307b2c2fbe06cd1c?s=128&d=identicon&r=PG", "display_name": "user2151190", "link": "https://stackoverflow.com/users/2151190/user2151190"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1428495811, "post_id": 29513275, "comment_id": 47184533, "body": "I Set it in the first code as   Set wbNew = Workbooks.Add , but in second code how do I wright that please?"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1428496072, "post_id": 29513275, "comment_id": 47184738, "body": "You have to name the workbook in the first code, then set the workbook in the second code. Is activeworkbook and wbNew different workbooks?"}, {"owner": {"reputation": 179, "user_id": 2151190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe0e8248a04a4e87307b2c2fbe06cd1c?s=128&d=identicon&r=PG", "display_name": "user2151190", "link": "https://stackoverflow.com/users/2151190/user2151190"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1428496686, "post_id": 29513275, "comment_id": 47185151, "body": "the  workbook name is Thisworkbook (but not set it), wbnew is the new created workbook, when I select active workbook it is also referring to thisworkbook"}], "answers": [{"comments": [{"owner": {"reputation": 179, "user_id": 2151190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe0e8248a04a4e87307b2c2fbe06cd1c?s=128&d=identicon&r=PG", "display_name": "user2151190", "link": "https://stackoverflow.com/users/2151190/user2151190"}, "edited": false, "score": 0, "creation_date": 1428498110, "post_id": 29514831, "comment_id": 47186180, "body": "<a href=\"https://app.box.com/s/dyzdsdqijzebzaq99cv7uzmgq4wg7u2u\" rel=\"nofollow noreferrer\">app.box.com/s/dyzdsdqijzebzaq99cv7uzmgq4wg7u2u</a>   This is how I puzzeld the code that was Too long. VBA is writing that after an error occurs?"}, {"owner": {"reputation": 179, "user_id": 2151190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe0e8248a04a4e87307b2c2fbe06cd1c?s=128&d=identicon&r=PG", "display_name": "user2151190", "link": "https://stackoverflow.com/users/2151190/user2151190"}, "edited": false, "score": 0, "creation_date": 1428500213, "post_id": 29514831, "comment_id": 47187709, "body": "this should be 1 long code ,from sheet 1 to sheet 30"}, {"owner": {"reputation": 179, "user_id": 2151190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe0e8248a04a4e87307b2c2fbe06cd1c?s=128&d=identicon&r=PG", "display_name": "user2151190", "link": "https://stackoverflow.com/users/2151190/user2151190"}, "edited": false, "score": 0, "creation_date": 1428500643, "post_id": 29514831, "comment_id": 47188057, "body": "It is working with the split code now. Maybe it is not the most presentable code , but it is doiing the job. I am verry verry happy with that :-)"}, {"owner": {"reputation": 179, "user_id": 2151190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe0e8248a04a4e87307b2c2fbe06cd1c?s=128&d=identicon&r=PG", "display_name": "user2151190", "link": "https://stackoverflow.com/users/2151190/user2151190"}, "edited": false, "score": 0, "creation_date": 1428500750, "post_id": 29514831, "comment_id": 47188153, "body": "If that is ok with you I would like to mark this post as solved :-). Ill wait for your feedback."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 179, "user_id": 2151190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe0e8248a04a4e87307b2c2fbe06cd1c?s=128&d=identicon&r=PG", "display_name": "user2151190", "link": "https://stackoverflow.com/users/2151190/user2151190"}, "edited": false, "score": 0, "creation_date": 1428505307, "post_id": 29514831, "comment_id": 47191740, "body": "I understand now. You have many subroutines, of which vanaf_17() is just one. Sort of like one for each sheet you want to copy? Assuming that&#39;s correct, I rewrote your subroutines to do this logic for every sheet. So you just need the two routines instead of your main routine for Sheet1 and Workbook creation/save, and then 30 more subroutines that are just copy and pastes of eachother."}, {"owner": {"reputation": 179, "user_id": 2151190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe0e8248a04a4e87307b2c2fbe06cd1c?s=128&d=identicon&r=PG", "display_name": "user2151190", "link": "https://stackoverflow.com/users/2151190/user2151190"}, "edited": false, "score": 0, "creation_date": 1428523263, "post_id": 29514831, "comment_id": 47202929, "body": "indeed. Starting from my workbook (thisworkbook sheet &quot;1&quot;) I have 1 sheet where I have to extract 30 names, then copy them in a copy of a blanc sheet sheet(1) of thisworkbook to a new workbook."}, {"owner": {"reputation": 179, "user_id": 2151190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe0e8248a04a4e87307b2c2fbe06cd1c?s=128&d=identicon&r=PG", "display_name": "user2151190", "link": "https://stackoverflow.com/users/2151190/user2151190"}, "edited": false, "score": 0, "creation_date": 1428655305, "post_id": 29514831, "comment_id": 47264300, "body": "I can use your suggested looping in a code of my next question  .                                                                                                   <a href=\"http://stackoverflow.com/questions/29478394/extract-data-from-excel-workbook-with-specific-procedure-to-report-sheet\" title=\"extract data from excel workbook with specific procedure to report sheet\">stackoverflow.com/questions/29478394/&hellip;</a>"}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 1, "last_activity_date": 1428505225, "last_edit_date": 1428505225, "creation_date": 1428496606, "answer_id": 29514831, "question_id": 29513275, "link": "https://stackoverflow.com/questions/29513275/call-sub-not-working-properly/29514831#29514831", "title": "call Sub not working properly", "body": "<p>You'll need to set <code>wbnew</code> in that second sub as well. The second sub has no idea what you mean when you say <code>wbnew</code>. When you have a variable in a subroutine or function it exists only in the subroutine or function. As soon as you move to another subroutine, your variables are 100% worthless. </p>\n\n<p>To get around this, you can pass parameters between subs. </p>\n\n<p>When you start your second sub <code>Sub vanaf_17()</code> Do it like so:</p>\n\n<pre><code>Sub vanaf_17(wbNew as Workbook)\n    ....your code\nEnd Sub\n</code></pre>\n\n<p>When you call <code>vanaf_17()</code> do it like so:</p>\n\n<pre><code>Call vanaf_17 webNew\n</code></pre>\n\n<p>Also, since you are declaring <code>webNew</code> as a workbook in the parameters, delete the <code>dim wbNew as Workbook</code> bit in <code>vanaf_17</code> otherwise you'll get an error.</p>\n\n<p>Lastly, There is no reason why you need to split these up into two subroutines. I've never heard of '15 or 16 handling' limit and I'm not real sure what that means. I've seen some ugly ass recorded macro code that goes on for thousands of lines of <code>.select</code> and <code>.activate</code> and <code>oh-my-god-no-that-is-such-a-bad-idea</code> for what feels like forever. Excel can handle it.</p>\n\n<p>Updated: Here is what the code would look like with this change:</p>\n\n<pre><code>Sub Macro1()\n    ' Macro1 Macro\n    Dim wbNew As Workbook\n    'sheet 1----------------------------------------------------------------\n    Application.ScreenUpdating = False\n    ThisWorkbook.Sheets(1).Activate\n    Range(\"A1:S53\").Select\n    Range(\"S53\").Activate\n    Selection.Copy\n\n    Set wbNew = Workbooks.Add\n\n    wbNew.Sheets(1).Activate\n    Range(\"A1:S53\").Select\n\n    Selection.PasteSpecial Paste:=xlPasteColumnWidths, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n\n    wbNew.Sheets(1).Select\n    Selection.PasteSpecial Paste:=xlPasteColumnWidths, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n    Range(\"A1\").Select\n    ActiveSheet.Paste\n\n\n    Range(\"A15\").Select\n\n\n    Call vanaf_17 wbNew\n\n    ActiveWorkbook.SaveAs Filename:= _\n    \"C:\\Path\\\" &amp; \"per 1-15\" &amp; \" \" &amp; Format(Range(\"C13\"), \"mmmm\") &amp; \" \" &amp; Format(Range(\"C13\"), \"YYYY\") &amp; \".xlsx\"\n     FileFormat = xlOpenXMLWorkbook\n    ActiveWindow.Close\n\nEnd Sub\n\nSub vanaf_17(wbNew AS Workbook) \n\n    Application.ScreenUpdating = False\n\n    'sheet 17----------------------------------------------------------------\n    'here starts a new sheet!!!!!!!!!!!!!\n    Sheets.Add After:=ActiveSheet\n\n    ThisWorkbook.Sheets(1).Activate\n    Range(\"A1:S53\").Select\n    Range(\"S53\").Activate\n    Selection.Copy\n\n    'change here sheet nr!!!!!!!\n    wbNew.Sheets(17).Activate\n    Range(\"A1:S53\").Select\n\n    Selection.PasteSpecial Paste:=xlPasteColumnWidths, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n\n    'change here sheet nr!!!!!!!\n    wbNew.Sheets(17).Select\n    Selection.PasteSpecial Paste:=xlPasteColumnWidths, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n    Range(\"A1\").Select\n    ActiveSheet.Paste\n\n\n    'Here ends a new sheet!!!!!\n\n End Sub\n</code></pre>\n\n<p>That being said, there are some changes here that I think will help. Namely, you could loop through all the sheets that you care about in thisWorkbook, and call your subroutine to copy and paste the <code>A1:S53</code> range into a new worksheet in the new workbook. Below I have a quick example of what that would look like. I kept some of the unnecessary <code>.select</code> and <code>.activate</code> stuff in there, because I figured this change was dramatic enough. You'll see that all of your sheet creation and copying/pasting is now done in the second subroutine. The first subroutine just sets up the new workbook, loops through the sheets, and then saves the new workbook. </p>\n\n<pre><code>Sub Macro1()\n    ' Create a new workbook. Then loop through each worksheet in this workbook (that we care about)\n    '   and call the CreateNewWS subroutine to copy the A1:S53 range for each worksheet into the\n    '   new workbook\n\n    Application.ScreenUpdating = False\n\n    'Create a new workbook, assign it to wbNew variable\n    Dim wbNew As Workbook\n    Set wbNew = Workbooks.Add\n\n    'Loop through all the sheets in the current workbook that we care about\n    Dim sheetname as string\n    For each sheetname in Array(\"sheet1\", \"sheet2\", \"sheet3\", \"sheet4\")\n\n        'call the CreateNewWS subroutine to do the sheet creation and copying and pasting\n        call CreateNewWS wbNew, thisWorkbook.Sheets(sheetname)\n\n    Next sheetname\n\n    'You could also loop through all of the worksheets in thisworkbook if you want to copy every worksheet:\n    'Dim ws as worksheet\n    'For each ws in ThisWorkbook.Worksheets\n    '   call CreateNewWS wbNew, ws\n    'Next ws\n\n    'Save the new workbook\n    newWb.SaveAs Filename:= _\n    \"C:\\Path\\\" &amp; \"per 1-15\" &amp; \" \" &amp; Format(Range(\"C13\"), \"mmmm\") &amp; \" \" &amp; Format(Range(\"C13\"), \"YYYY\") &amp; \".xlsx\"\n     FileFormat = xlOpenXMLWorkbook\n\n    'Close the new workbook\n    newWb.Close\n\n    'Don't forget to turn this back on. Yikes.\n    Application.ScreenUpdating = True\nEnd Sub\n\nSub CreateNewWS(wbNew AS Workbook, ws as Worksheet) \n\n    'This subroutine takes in the wbNew and the worksheet (ws) that we are copying from.\n    '   it copys range A1:S53 from the ws to the wbNew's new worksheet.\n\n\n    'This will hold the new worksheet we are adding to the wbNew\n    Dim wsNew as worksheet\n\n    'Add a new worksheet to the new workbook\n    wbNew.Activate\n    set wsNew = wbNew.Sheets.Add After:=ActiveSheet\n\n    'Activate and copy from current workbook\n    ws.Activate\n    ws.Range(\"A1:S53\").Select\n    Selection.Copy\n\n    'Activate and paste into newWb      \n    wsNew.Range(\"A1\").Select\n    Selection.PasteSpecial Paste:=xlPasteColumnWidths, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n\n\n End Sub\n</code></pre>\n\n<p>I haven't really tested this change, but the guts of it are accurate. If you do decide to switch over to this type of logic and you run into errors, it would be prudent to create a new stackoverflow question to work through the problem. </p>\n"}], "owner": {"reputation": 179, "user_id": 2151190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe0e8248a04a4e87307b2c2fbe06cd1c?s=128&d=identicon&r=PG", "display_name": "user2151190", "link": "https://stackoverflow.com/users/2151190/user2151190"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1773, "favorite_count": 0, "accepted_answer_id": 29514831, "answer_count": 1, "score": 0, "last_activity_date": 1501518210, "creation_date": 1428492298, "last_edit_date": 1531164843, "question_id": 29513275, "link": "https://stackoverflow.com/questions/29513275/call-sub-not-working-properly", "title": "call Sub not working properly", "body": "<p>Why this call of sub is not working properly?\nI get an error that there are undefined objects.\nI believe this can be a little problem but cannot find a solution.\nI am trying to make new sheetnames but the code is too long for VBA , so I have to split the code, and continue in a second Sub. (apparently it is limited to 15 of 16 handlings)</p>\n\n<p>Thanks in advance.</p>\n\n<p>below my startcode</p>\n\n<pre><code>   Sub Macro1()\n   ' Macro1 Macro\n   Dim wbNew As Workbook\n   'sheet 1----------------------------------------------------------------\n   Application.ScreenUpdating = False\n   ThisWorkbook.Sheets(1).Activate\n   Range(\"A1:S53\").Select\n   Range(\"S53\").Activate\n   Selection.Copy\n\n   Set wbNew = Workbooks.Add\n\n    wbNew.Sheets(1).Activate\n   Range(\"A1:S53\").Select\n\n    Selection.PasteSpecial Paste:=xlPasteColumnWidths, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n\n    wbNew.Sheets(1).Select\n    Selection.PasteSpecial Paste:=xlPasteColumnWidths, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n    Range(\"A1\").Select\n    ActiveSheet.Paste\n\n\n    Range(\"A15\").Select\n\n\n    Call vanaf_17\n\n    ActiveWorkbook.SaveAs Filename:= _\n    \"C:\\Path\\\" &amp; \"per 1-15\" &amp; \" \" &amp; Format(Range(\"C13\"), \"mmmm\") &amp; \" \" &amp; Format(Range(\"C13\"), \"YYYY\") &amp; \".xlsx\"\n     FileFormat = xlOpenXMLWorkbook\n    ActiveWindow.Close\n\n  End Sub\n</code></pre>\n\n<p>code to call</p>\n\n<pre><code> Sub vanaf_17()\n Dim wbNew As Workbook\n Application.ScreenUpdating = False\n 'sheet 17----------------------------------------------------------------\n'here starts a new sheet!!!!!!!!!!!!!\n Sheets.Add After:=ActiveSheet\n\nThisWorkbook.Sheets(1).Activate\nRange(\"A1:S53\").Select\nRange(\"S53\").Activate\nSelection.Copy\n\n'change here sheet nr!!!!!!!\nwbNew.Sheets(17).Activate\nRange(\"A1:S53\").Select\n\nSelection.PasteSpecial Paste:=xlPasteColumnWidths, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n\n'change here sheet nr!!!!!!!\nwbNew.Sheets(17).Select\n    Selection.PasteSpecial Paste:=xlPasteColumnWidths, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\nRange(\"A1\").Select\nActiveSheet.Paste\n\n\n'Here ends a new sheet!!!!!\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 15122, "user_id": 4519059, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MBHID.png?s=128&g=1", "display_name": "shA.t", "link": "https://stackoverflow.com/users/4519059/sha-t"}, "edited": false, "score": 0, "creation_date": 1428564311, "post_id": 29512895, "comment_id": 47217759, "body": "Adding that code you run in every 5 seconds can be helpful ;)."}, {"owner": {"reputation": 57, "user_id": 818690, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/2463b56311b1954972837cf4b5e170ed?s=128&d=identicon&r=PG", "display_name": "Chai Zheng Xin", "link": "https://stackoverflow.com/users/818690/chai-zheng-xin"}, "reply_to_user": {"reputation": 15122, "user_id": 4519059, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MBHID.png?s=128&g=1", "display_name": "shA.t", "link": "https://stackoverflow.com/users/4519059/sha-t"}, "edited": false, "score": 0, "creation_date": 1428654187, "post_id": 29512895, "comment_id": 47263668, "body": "Thanks for the help guys. I have noticed that refreshing the data connection to the csv file would cause the charts to flicker. I resolved this problem by removing the data connection and parsing the csv file manually and setting the data into the charts."}], "answers": [{"tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": false, "score": 0, "last_activity_date": 1428493652, "creation_date": 1428493652, "answer_id": 29513732, "question_id": 29512895, "link": "https://stackoverflow.com/questions/29512895/prevent-vba-flickering-of-charts-in-excel/29513732#29513732", "title": "Prevent VBA Flickering Of Charts In Excel", "body": "<p>You can hide the worksheet that has the charts just before you are about to load the CSV data, and then unhide at the end of the second macro.</p>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 4202071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d3dec4c70b56b226333bfea1b6d3982?s=128&d=identicon&r=PG", "display_name": "arcadecomputing", "link": "https://stackoverflow.com/users/4202071/arcadecomputing"}, "is_accepted": false, "score": 0, "last_activity_date": 1428498405, "creation_date": 1428498405, "answer_id": 29515516, "question_id": 29512895, "link": "https://stackoverflow.com/questions/29512895/prevent-vba-flickering-of-charts-in-excel/29515516#29515516", "title": "Prevent VBA Flickering Of Charts In Excel", "body": "<p>Have you tried running the macro outside of the VBA editor?\nEven if you have set <code>Application.ScreenUpdating = False</code>, this will be ignored if stepping through the code or running from the editor (I believe!)</p>\n"}], "owner": {"reputation": 57, "user_id": 818690, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/2463b56311b1954972837cf4b5e170ed?s=128&d=identicon&r=PG", "display_name": "Chai Zheng Xin", "link": "https://stackoverflow.com/users/818690/chai-zheng-xin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 564, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1428558889, "creation_date": 1428491215, "last_edit_date": 1428558889, "question_id": 29512895, "link": "https://stackoverflow.com/questions/29512895/prevent-vba-flickering-of-charts-in-excel", "title": "Prevent VBA Flickering Of Charts In Excel", "body": "<p>I have an Excel workbook that contains 2 sheets. A VBA code will load a CSV file into the 1st sheet. The VBA code will then plot data from the 1st sheet into charts in the 2nd sheet. This VBA code runs every 5 seconds and causes the charts to flicker.</p>\n\n<p>Anyone has any suggestions to prevent the flickering? I have tried </p>\n\n<pre><code>Application.ScreenUpdating = False \n</code></pre>\n\n<p>and it does not help.</p>\n"}, {"tags": ["excel", "text", "vba"], "comments": [{"owner": {"reputation": 285, "user_id": 1457942, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f002df58c5323f6f4893133000d09498?s=128&d=identicon&r=PG", "display_name": "Anil Kumar", "link": "https://stackoverflow.com/users/1457942/anil-kumar"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1428556983, "post_id": 29512664, "comment_id": 47214285, "body": "Character count... i have lots of rows that all needs to be appended after other with given character count reserved for each of them."}], "answers": [{"tags": [], "owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "is_accepted": false, "score": 0, "last_activity_date": 1428493349, "creation_date": 1428493349, "answer_id": 29513624, "question_id": 29512664, "link": "https://stackoverflow.com/questions/29512664/format-to-text-file-with-predefined-size-for-each-field/29513624#29513624", "title": "Format to text file with predefined size for each field", "body": "<p>Assuming your string is in A1, and its length isn't more than the 10 characters:</p>\n\n<pre><code>=A1&amp;REPT(\" \",10-LEN(A1))\n</code></pre>\n"}], "owner": {"reputation": 285, "user_id": 1457942, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f002df58c5323f6f4893133000d09498?s=128&d=identicon&r=PG", "display_name": "Anil Kumar", "link": "https://stackoverflow.com/users/1457942/anil-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1428493452, "creation_date": 1428490408, "last_edit_date": 1531161705, "question_id": 29512664, "link": "https://stackoverflow.com/questions/29512664/format-to-text-file-with-predefined-size-for-each-field", "title": "Format to text file with predefined size for each field", "body": "<p>I have an Excel file which I need to convert to text file. Now the thing is that for each value there is a specified field size which should be there in text file. For example:  </p>\n\n<p>if my Excel contains a character of size 10 with value <code>ABCDEF</code>, then in text file it should be as <code>ABCDEF____</code> (4 spaces).</p>\n\n<p>After this next value is appended in similar manner with its rest of the size is left blank.</p>\n\n<p>Any kind of hint or pointer will be really helpful on how to procede with this.</p>\n"}, {"tags": ["vba", "date", "excel"], "comments": [{"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1428488063, "post_id": 29511732, "comment_id": 47179348, "body": "It isn&#39;t clear what your issue is exactly. What &quot;usual trick&quot;? Please show some example input, desired output, current output, and point out how the current output differs from the desired. <a href=\"http://stackoverflow.com/help/mcve\">A Minimal, Complete, and Verifiable example</a> always helps, so do screenshots."}, {"owner": {"reputation": 461, "user_id": 4043074, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/njmfm.jpg?s=128&g=1", "display_name": "DannyBland", "link": "https://stackoverflow.com/users/4043074/dannybland"}, "reply_to_user": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1428490193, "post_id": 29511732, "comment_id": 47180841, "body": "The &quot;usual trick&quot; is that is changes all dates to be US dates when storing them. What I would like it to input a UK date in the inputbox and also have the output as the same UK date."}], "answers": [{"tags": [], "owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "is_accepted": true, "score": 1, "last_activity_date": 1428490804, "creation_date": 1428490804, "answer_id": 29512779, "question_id": 29511732, "link": "https://stackoverflow.com/questions/29511732/excel-vba-input-date-and-then-output-date-in-uk-format/29512779#29512779", "title": "Excel VBA Input Date and then Output Date in UK Format", "body": "<p>This works for me:</p>\n\n<pre><code>Dim str As String\nDim splitStr() As String\nDim strFormat As String\nDim d As Date\n\n'Your preferred date format\nstrFormat = \"dd/mm/yyyy\"\n\n'Get string representing date\nstr = InputBox(Prompt:=\"What date would you like to post this journal for?\", _\n               Title:=\"Enter the posting date\", Default:=Format(Now, strFormat))\n\n'Parse the date string\nsplitStr = Split(str, \"/\")\nd = DateSerial(CInt(splitStr(2)), CInt(splitStr(1)), CInt(splitStr(0)))\n'Display it in the proper format\nWith Range(\"A1\")\n    .Value = d\n    .NumberFormat = strFormat\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 461, "user_id": 4043074, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/njmfm.jpg?s=128&g=1", "display_name": "DannyBland", "link": "https://stackoverflow.com/users/4043074/dannybland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1755, "favorite_count": 0, "accepted_answer_id": 29512779, "answer_count": 1, "score": 0, "last_activity_date": 1428495900, "creation_date": 1428487771, "last_edit_date": 1428495900, "question_id": 29511732, "link": "https://stackoverflow.com/questions/29511732/excel-vba-input-date-and-then-output-date-in-uk-format", "title": "Excel VBA Input Date and then Output Date in UK Format", "body": "<p>I've made a simple macro to move data from one tab to another and add a date to simplify the process we had of constructing a journal.</p>\n\n<p>However, when I ask for a date to be input - VBA does it's usual trick of turning your date into a US date. What I need is for the user to input a UK date and the output be the same UK date - however, if I input a UK date it comes out as a US date.</p>\n\n<p>The only way round this I can think of is to enter the date in US format and the use <code>Format(str, \"dd/mm/yyyy\")</code> to output the date in UK format but this is not ideal.</p>\n\n<p>A simpler method would be a great help as the macro is for the team rather than just myself.</p>\n\n<pre><code>Dim wb As Workbook, wk1 As Worksheet, wk2 As Worksheet, rng As Range, str As String\n\nSub Journal()\nSet wb = ThisWorkbook\nSet wk1 = ActiveSheet\nSet wk2 = wb.Sheets(\"CBCS Journal\")\n\nstr = InputBox(Prompt:=\"What date would you like to post this journal for?\", _\n    Title:=\"Enter the posting date\", Default:=Format(Now, \"dd/mm/yyyy\"))\nFor i = 1 To wk1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row - 9\nwk2.Range(\"B\" &amp; i + 1).Value = str\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4762272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jgse1.jpg?s=128&g=1", "display_name": "GAmBIt", "link": "https://stackoverflow.com/users/4762272/gambit"}, "edited": false, "score": 0, "creation_date": 1428560595, "post_id": 29511871, "comment_id": 47215808, "body": "Plasher, thanks for the answer, but being new to VB and macros I am completely missing the link of the code from the selector section onwards. What exactly is selector and what does # &amp; . represent in that."}, {"owner": {"reputation": 318, "user_id": 4189548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d73cf6d96e32cc3fa9527a638ccce34f?s=128&d=identicon&r=PG&f=1", "display_name": "Plasher", "link": "https://stackoverflow.com/users/4189548/plasher"}, "reply_to_user": {"reputation": 1, "user_id": 4762272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jgse1.jpg?s=128&g=1", "display_name": "GAmBIt", "link": "https://stackoverflow.com/users/4762272/gambit"}, "edited": false, "score": 0, "creation_date": 1428564569, "post_id": 29511871, "comment_id": 47217917, "body": "Selector references a <b>CSS selector</b> you want to select. As you try to select the menus/tabs you have to define a CSS selector in the HTML for them. Best would be if they have a CSS class or a CSS id. For example if your first menu tab has the id <code>menu1_tab1</code> you could pass <code>&quot;#menu1_tab1&quot;</code> as the selector argument. Then the function would return either the inner text or the inner html of the first menu tab."}], "tags": [], "owner": {"reputation": 318, "user_id": 4189548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d73cf6d96e32cc3fa9527a638ccce34f?s=128&d=identicon&r=PG&f=1", "display_name": "Plasher", "link": "https://stackoverflow.com/users/4189548/plasher"}, "is_accepted": false, "score": 0, "last_activity_date": 1428488178, "creation_date": 1428488178, "answer_id": 29511871, "question_id": 29511642, "link": "https://stackoverflow.com/questions/29511642/how-to-access-different-menus-and-tabs-in-webpage/29511871#29511871", "title": "How to access different menus and tabs in webpage?", "body": "<p>here is a bit of code I wrote some months ago. It retrieves the HTML Dom of a webpage and tries to find elements/IDs/classes within that DOM and returns either their text or html. </p>\n\n<p>Maybe you can use it to find your menus/tabs and check if their content is corret. Furthermore the HTMLDocument/IHTMLElement classes of VBA could be useful for you.</p>\n\n<p>As a note: It requires the Microsoft Internet Controls and Microsoft HTML Object Library references.</p>\n\n<pre><code>Public Function GetWebPage(url As String, Optional resultType As String = \"innerText\", Optional selector As Variant) As Variant\nDim oBrowser As InternetExplorer\nDim HTMLDoc As HTMLDocument\nDim docText As String\nDim arrSelector As Variant\nDim element As IHTMLElement\nDim i As Long\nDim tmpElementName As String\nDim timer As Long\nConst waitTime = 12000\n\n'// set the browser object to a new IE instance\nSet oBrowser = New InternetExplorer\noBrowser.Silent = True\noBrowser.Visible = False\noBrowser.Navigate url '// navigate to the given page\n\n'// wait until the page is loaded, requires the sleep api of windows\ntimer = 0\nDo\n    timer = timer + 1\n    Sleep 10\nLoop Until oBrowser.ReadyState = READYSTATE_COMPLETE Or timer &gt; waitTime\n\n'// if the page is loaded\nIf oBrowser.ReadyState = READYSTATE_COMPLETE Then\n    Set HTMLDoc = oBrowser.Document '// retrieve the document\n\n\n    '// if a selector was given\n    If Not IsMissing(selector) Then\n        '// get the temporary element name, this assumes the selector contains a '#' or a '.'\n        '// to represent an id or a class\n        tmpElementName = Mid(selector, 2)\n\n        '// check if it's an id, a class or a simple element and retrieve it\n        If Left(selector, 1) = \"#\" Then\n                Set element = HTMLDoc.getElementById(tmpElementName)\n        ElseIf Left(selector, 1) = \".\" Then\n                Set element = HTMLDoc.getElementsByClassName(tmpElementName)\n        Else\n                Set element = HTMLDoc.body\n        End If\n    Else\n        Set element = HTMLDoc.body\n    End If\n\n    '// get either inner text or html, depending on selection\n    If Not element Is Nothing Then\n        If resultType = \"innerText\" Then\n            docText = element.innerText\n        ElseIf resultType = \"innerHTML\" Then\n            docText = element.innerHTML\n        End If\n    End If\n\n    '// clean up everything and return\n    Set element = Nothing\n    HTMLDoc.Close\n    Set HTMLDoc = Nothing\n\n    GetWebPage = IIf(docText = \"\", Null, docText)\nElse\n    GetWebPage = Null\nEnd If\n\noBrowser.Quit\nSet oBrowser = Nothing\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4762272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jgse1.jpg?s=128&g=1", "display_name": "GAmBIt", "link": "https://stackoverflow.com/users/4762272/gambit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1428535889, "creation_date": 1428487516, "last_edit_date": 1531164843, "question_id": 29511642, "link": "https://stackoverflow.com/questions/29511642/how-to-access-different-menus-and-tabs-in-webpage", "title": "How to access different menus and tabs in webpage?", "body": "<p>I am very new to VBA.</p>\n\n<p>I have to open a certain webpage in IE. That webpage has a menu on the left side and in each menu there are different tabs.</p>\n\n<p>I have to check all these menus &amp; tabs are up. Along with that I have to check for errors on these pages (displayed if any).</p>\n\n<p>I have been able to write code to open the webpage.</p>\n"}, {"tags": ["excel", "excel-formula", "pivot-table", "vba"], "comments": [{"owner": {"reputation": 2706, "user_id": 4230650, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Xfm2v.jpg?s=128&g=1", "display_name": "Marcel", "link": "https://stackoverflow.com/users/4230650/marcel"}, "edited": false, "score": 0, "creation_date": 1428483828, "post_id": 29510224, "comment_id": 47176660, "body": "what is the expected excel behaviour you are looking for? what is the expected results like? what exactly you are trying to get out? can you give an example result?"}, {"owner": {"reputation": 2016, "user_id": 1721298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/668662ded93bcdd9c17b4296deef012b?s=128&d=identicon&r=PG", "display_name": "Prokurors", "link": "https://stackoverflow.com/users/1721298/prokurors"}, "reply_to_user": {"reputation": 2706, "user_id": 4230650, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Xfm2v.jpg?s=128&g=1", "display_name": "Marcel", "link": "https://stackoverflow.com/users/4230650/marcel"}, "edited": false, "score": 0, "creation_date": 1428485287, "post_id": 29510224, "comment_id": 47177564, "body": "@AHC I want to access those values that were selected in report filter field. And do some calculation that would filter rows (from another table) that has only values that are selected in report filter field"}], "answers": [{"comments": [{"owner": {"reputation": 351, "user_id": 1779814, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/EHMio.jpg?s=128&g=1", "display_name": "holgrich", "link": "https://stackoverflow.com/users/1779814/holgrich"}, "edited": false, "score": 0, "creation_date": 1446794990, "post_id": 29555156, "comment_id": 54901517, "body": "Thanks for sharing the feedback @ stackoverflow (y)"}], "tags": [], "owner": {"reputation": 2016, "user_id": 1721298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/668662ded93bcdd9c17b4296deef012b?s=128&d=identicon&r=PG", "display_name": "Prokurors", "link": "https://stackoverflow.com/users/1721298/prokurors"}, "is_accepted": true, "score": 7, "last_activity_date": 1428648735, "creation_date": 1428648735, "answer_id": 29555156, "question_id": 29510224, "link": "https://stackoverflow.com/questions/29510224/how-can-i-access-selected-report-filter-values-in-excel-pivot-table-from-vba-cod/29555156#29555156", "title": "How can I access selected report filter values in Excel Pivot table from VBA code or Formulas?", "body": "<p>Since there was no activity in stackoverflow, I posted question to few other forums. The only place where I got response (that lead to solution) was \n<a href=\"https://social.msdn.microsoft.com/Forums/en-US/722c02f2-8f00-411a-9baa-c6ae95d008ea/how-can-i-access-selected-report-filter-values-in-excel-pivot-table-from-vba-code-or-formulas?forum=exceldev\">msdn forum</a>. In case if someone else that searches for this in stackoverflow - I post the essence of the solution here, additional info available at the provided links.</p>\n\n<p>I did not get info how to access report filter's values directly from formulas - but that could be done with creating user defined function ->  <a href=\"http://www.howtoexcelatexcel.com/formulas/how-to-show-formulas-in-excel-with-a-user-defined-function/\">see how to do that</a></p>\n\n<p>1) This is how to access report filter field's from VBA code (by P.Thornton):</p>\n\n<pre><code>Sub Button960_Click()\n    Dim pt As PivotTable\n    Dim pf As PivotField\n    Dim pi As PivotItem\n        Set pt = ActiveSheet.PivotTables(1)\n\n        pt.PivotCache.MissingItemsLimit = xlMissingItemsNone\n        pt.PivotCache.Refresh\n\n        Set pf = pt.PivotFields(\"your report field name\")\n        For Each pi In pf.PivotItems\n            Debug.Print pi.Name, pi.Visible\n\n            If pi.Visible Then\n                '... user has selected this value!\n            End If\n        Next   \nEnd Sub\n</code></pre>\n\n<p><strong>Please note, that You should set PivotCache.MissingItemsLimit = xlMissingNone</strong> otherwise You may experience unexpected results. In my case it turned out that cache had a bunch of values that were NOT present at the data source anymore. This was a legacy file and those non-existing values most likely were in the file at some moment in past, and later erased from the file. So, clearing <code>PivotCache</code> clears some old, non-existing data.</p>\n\n<p>2) <a href=\"https://social.msdn.microsoft.com/Forums/en-US/722c02f2-8f00-411a-9baa-c6ae95d008ea/how-can-i-access-selected-report-filter-values-in-excel-pivot-table-from-vba-code-or-formulas?forum=exceldev\">A nice solution how to display list of selected values by the side of the report filter fields available at the msdn forum</a>(by D.Tamburino)</p>\n\n<p>P.S. Thanks to P.Thornton and D.Tamburino from MSDN forum!</p>\n"}], "owner": {"reputation": 2016, "user_id": 1721298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/668662ded93bcdd9c17b4296deef012b?s=128&d=identicon&r=PG", "display_name": "Prokurors", "link": "https://stackoverflow.com/users/1721298/prokurors"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12531, "favorite_count": 4, "accepted_answer_id": 29555156, "answer_count": 1, "score": 4, "last_activity_date": 1428648735, "creation_date": 1428483554, "last_edit_date": 1531164843, "question_id": 29510224, "link": "https://stackoverflow.com/questions/29510224/how-can-i-access-selected-report-filter-values-in-excel-pivot-table-from-vba-cod", "title": "How can I access selected report filter values in Excel Pivot table from VBA code or Formulas?", "body": "<p>I have a pivot table with report filter field. I need to do some operations based on the value user selects in report filter field. </p>\n\n<p>If user selects single value (or selects <code>All</code>) - no problem to get that value. In sample video it's cell B1, but in case of multiple values are selected, this field shows just <code>Multiple selected</code>.</p>\n\n<p>Where can I get the specific reporting filter values that are selected? Can I access those values from Excel formulas? If not - can I access those values from VBA code?</p>\n\n<p><a href=\"http://www.screencast.com/t/2cvWtSk6Ed1c\" rel=\"nofollow\">Sample video</a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2834, "user_id": 3230346, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Nc4ve.png?s=128&g=1", "display_name": "useR", "link": "https://stackoverflow.com/users/3230346/user"}, "is_accepted": false, "score": 1, "last_activity_date": 1428483168, "creation_date": 1428483168, "answer_id": 29510084, "question_id": 29509990, "link": "https://stackoverflow.com/questions/29509990/how-can-i-name-a-range-b1bn-using-a-macro-where-n-may-increase-in-future/29510084#29510084", "title": "How can I name a range (&quot;B1:Bn&quot;) using a macro where &#39;n&#39; may increase in future", "body": "<p>Is the following what you want? i pick second column as you mentioned</p>\n\n<pre><code>Range(Cells(1,2), Cells(Total_Row, 2)).Select\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 0, "last_activity_date": 1433419385, "last_edit_date": 1495535212, "creation_date": 1428484669, "answer_id": 29510613, "question_id": 29509990, "link": "https://stackoverflow.com/questions/29509990/how-can-i-name-a-range-b1bn-using-a-macro-where-n-may-increase-in-future/29510613#29510613", "title": "How can I name a range (&quot;B1:Bn&quot;) using a macro where &#39;n&#39; may increase in future", "body": "<p>Try this (don't forget to define the <code>Worksheet_Name</code>)</p>\n\n<pre><code>Private Sub ComboBox1_Change()\nDim Total_Row As Integer\nDim Pasted_Range As String\nTotal_Row = Worksheets(\"Database\").Range(\"B1\").CurrentRegion.Rows.Count\nPasted_Range = \"=\" &amp; Worksheet_Name &amp; \"!R2C2:R\" &amp; Total_Row &amp; \"C2\"\n\nActiveWorkbook.Names.Add Name:=\"Testing\", RefersToR1C1:=Pasted_Range\nEnd Sub\n</code></pre>\n\n<p>Check this for more info : <a href=\"https://stackoverflow.com/questions/29413522/copy-range-to-another-sheet-and-insert-name-from-input-box-with-this-copy/29428454#29428454\">Copy range to another sheet and insert name from Input Box with this copy</a></p>\n"}, {"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 1, "last_activity_date": 1428485295, "creation_date": 1428485295, "answer_id": 29510836, "question_id": 29509990, "link": "https://stackoverflow.com/questions/29509990/how-can-i-name-a-range-b1bn-using-a-macro-where-n-may-increase-in-future/29510836#29510836", "title": "How can I name a range (&quot;B1:Bn&quot;) using a macro where &#39;n&#39; may increase in future", "body": "<p>Range argument is string so you just need to concatenate it as string</p>\n\n<pre><code>Range(\"B1:B\" &amp; Total_Row).Select\n</code></pre>\n\n<p>Same with below line</p>\n\n<pre><code>RefersToR1C1:=\"=Database!R2C2:R\" &amp; Total_Row &amp; \"C2\"\n</code></pre>\n"}], "owner": {"reputation": 150, "user_id": 3729220, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Ntkn8.jpg?s=128&g=1", "display_name": "user3729220", "link": "https://stackoverflow.com/users/3729220/user3729220"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "accepted_answer_id": 29510613, "answer_count": 3, "score": 1, "last_activity_date": 1433419385, "creation_date": 1428482901, "last_edit_date": 1428496086, "question_id": 29509990, "link": "https://stackoverflow.com/questions/29509990/how-can-i-name-a-range-b1bn-using-a-macro-where-n-may-increase-in-future", "title": "How can I name a range (&quot;B1:Bn&quot;) using a macro where &#39;n&#39; may increase in future", "body": "<p>Basically I want to name a Range(\"B1:Bn\") so that I can use that name for a <code>Combobox</code> to list the value of that range but here range/list may increase so I want this range to be dyanamic and so shoud have the same name for that range.\nI have written a code below:</p>\n\n<pre><code>Private Sub ComboBox1_Change()\n    Dim Total_Row As Integer\n    Total_Row = Worksheets(\"Database\").Range(\"B1\").CurrentRegion.Rows.Count\n    Range(\"B1:B11\").Select\n\n    'Now I want something like `Range(\"B1:B***Total_Row***\").Select`\nEnd sub\n</code></pre>\n\n<p>or can we make it dynamic using below code?</p>\n\n<pre><code>    ActiveWorkbook.Names.Add Name:=\"Testing\", _\n        RefersToR1C1:=\"=Database!R2C2:R***(Total_Row)***C2\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "merge"], "comments": [{"owner": {"reputation": 318, "user_id": 4189548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d73cf6d96e32cc3fa9527a638ccce34f?s=128&d=identicon&r=PG&f=1", "display_name": "Plasher", "link": "https://stackoverflow.com/users/4189548/plasher"}, "edited": false, "score": 0, "creation_date": 1428483265, "post_id": 29509963, "comment_id": 47176298, "body": "I think the simplest solution would be to show the rows again, do the merging and then hide them again. At least that woult be approach, but maybe there is a more &quot;cleaner&quot; solution"}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1428485414, "post_id": 29509963, "comment_id": 47177642, "body": "Do both of these Worksheet_Change macros sit within the same worksheet code module?"}, {"owner": {"reputation": 29, "user_id": 4741575, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155476399100201/picture?type=large", "display_name": "R\u0131fat Yerusalmi", "link": "https://stackoverflow.com/users/4741575/r%c4%b1fat-yerusalmi"}, "edited": false, "score": 0, "creation_date": 1428485767, "post_id": 29509963, "comment_id": 47177866, "body": "No, hiding the rows script is in Module 1 and the other case macro is in sheet objects ( there are several sheets )."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 4741575, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155476399100201/picture?type=large", "display_name": "R\u0131fat Yerusalmi", "link": "https://stackoverflow.com/users/4741575/r%c4%b1fat-yerusalmi"}, "edited": false, "score": 0, "creation_date": 1428486746, "post_id": 29511097, "comment_id": 47178513, "body": "It worked like a charm even with hidden rows around :)! but it doesn&#39;t recognize the change and merge it automatically. I know if I add &quot; Private Sub Worksheet_Change(ByVal Target As Range) &quot;, it will be automatic but I can&#39;t use that twice in different macros. do you have any suggestions?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 29, "user_id": 4741575, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155476399100201/picture?type=large", "display_name": "R\u0131fat Yerusalmi", "link": "https://stackoverflow.com/users/4741575/r%c4%b1fat-yerusalmi"}, "edited": false, "score": 0, "creation_date": 1428487104, "post_id": 29511097, "comment_id": 47178784, "body": "Which changes are not recognized? And if you want to reuse the same merge over and over, you first need to detect merged cells to avoid them. But I don&#39;t know how to do that by heart!^^"}, {"owner": {"reputation": 29, "user_id": 4741575, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155476399100201/picture?type=large", "display_name": "R\u0131fat Yerusalmi", "link": "https://stackoverflow.com/users/4741575/r%c4%b1fat-yerusalmi"}, "edited": false, "score": 0, "creation_date": 1428487452, "post_id": 29511097, "comment_id": 47178983, "body": "the first script you provided works %100 with some hidden rows too but whenever I type &quot;update&quot; to D column, I need to run the script manually in order it to perform the action(merging the cells). and it doesn&#39;t give any problems with already merged cells so I guess that part is good :)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 29, "user_id": 4741575, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155476399100201/picture?type=large", "display_name": "R\u0131fat Yerusalmi", "link": "https://stackoverflow.com/users/4741575/r%c4%b1fat-yerusalmi"}, "edited": false, "score": 0, "creation_date": 1428487840, "post_id": 29511097, "comment_id": 47179208, "body": "Ok so what you need, is to automate the launching of the merging macro but you already have something in Worksheet_change? Why can&#39;t you put both in there?"}, {"owner": {"reputation": 29, "user_id": 4741575, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155476399100201/picture?type=large", "display_name": "R\u0131fat Yerusalmi", "link": "https://stackoverflow.com/users/4741575/r%c4%b1fat-yerusalmi"}, "edited": false, "score": 0, "creation_date": 1428489139, "post_id": 29511097, "comment_id": 47180090, "body": "I tried to put them in different modules but it gave me error. Placing them under sheet object with &quot;Private Sub Worksheet_Change(ByVal Target As Range)&quot; on top worked alright without any problems! Thank you very much R3uK !! :)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 29, "user_id": 4741575, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155476399100201/picture?type=large", "display_name": "R\u0131fat Yerusalmi", "link": "https://stackoverflow.com/users/4741575/r%c4%b1fat-yerusalmi"}, "edited": false, "score": 0, "creation_date": 1428493023, "post_id": 29511097, "comment_id": 47182648, "body": "Yup, if it is an event listener as Worksheet_Change(), you need to place it in a specific sheet. But you can call procedure in that Worksheet_Change() that are placed in a module (if you do reference it well (addind sheet name and such)) enjoy"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 0, "last_activity_date": 1428486923, "last_edit_date": 1428486923, "creation_date": 1428486055, "answer_id": 29511097, "question_id": 29509963, "link": "https://stackoverflow.com/questions/29509963/overlapping-macros/29511097#29511097", "title": "Overlapping macros", "body": "<p>have tou try this (avoid hidden rows)?  :</p>\n\n<pre><code>Private Sub Worksheet_Change()\nDim RgToMerge As String\nDim i As Double\nFor i = 5 To ActiveSheet.Cells(Rows.Count, 4).End(xlUp).Row\n    If ActiveSheet.Rows(i).EntireRow.Hidden &lt;&gt; False Then\n    Else\n        RgToMerge = \"\"\n        If LCase(Cells(i, 4)) &lt;&gt; \"update\" Or (LCase(Cells(i + 1, 4)) &lt;&gt; \"new\" And Cells(i + 1, 4) &lt;&gt; \"\") Then\n        Else\n            'I don't know if this would work properly with hidden rows\n            RgToMerge = \"$C$\" &amp; Cells(i, 3).End(xlUp).Row &amp; \":$C$\" &amp; i\n            With Range(RgToMerge)\n                .Merge\n                .HorizontalAlignment = xlCenter\n                .VerticalAlignment = xlCenter\n            End With\n        End If\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Or this (scan rows, display all, merge, hide these which were hidden)</p>\n\n<pre><code>Private Sub Worksheet_Change()\nApplication.ScreenUpdating = False\nDim Th()\nReDim Th(ActiveSheet.Cells(Rows.Count, 4).End(xlUp).Row)\n'Fill array with hidden state of rows\nFor i = 1 To UBound(Th)\n    If ActiveSheet.Rows(i).EntireRow.Hidden &lt;&gt; False Then\n        Th(i) = True\n    Else\n        Th(i) = False\n    End If\nNext i\n'Display all rows\nActiveSheet.Rows(\"1:\" &amp; UBound(Th)).EntireRow.Hidden = False\n\n'Merge\nDim RgToMerge As String\nDim i As Double\nFor i = 5 To UBound(Th)\n    RgToMerge = \"\"\n    If LCase(Cells(i, 4)) &lt;&gt; \"update\" Or (LCase(Cells(i + 1, 4)) &lt;&gt; \"new\" And Cells(i + 1, 4) &lt;&gt; \"\") Then\n    Else\n        RgToMerge = \"$C$\" &amp; Cells(i, 3).End(xlUp).Row &amp; \":$C$\" &amp; i\n        With Range(RgToMerge)\n            .Merge\n            .HorizontalAlignment = xlCenter\n            .VerticalAlignment = xlCenter\n        End With\n    End If\nNext i\n\n'Rehide previously hidden rows\nFor i = 1 To UBound(Th)\n    ActiveSheet.Rows(i).EntireRow.Hidden = Th(i)\nNext i\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 4741575, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155476399100201/picture?type=large", "display_name": "R\u0131fat Yerusalmi", "link": "https://stackoverflow.com/users/4741575/r%c4%b1fat-yerusalmi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 0, "accepted_answer_id": 29511097, "answer_count": 1, "score": 0, "last_activity_date": 1428496113, "creation_date": 1428482825, "last_edit_date": 1428496113, "question_id": 29509963, "link": "https://stackoverflow.com/questions/29509963/overlapping-macros", "title": "Overlapping macros", "body": "<p>First of all I am sorry for the long post and thank you very much in advance! I have been working on a project and so far I have two macros which only one of them is functioning and the other one is not because, I believe, of an overlap.</p>\n\n<p>sooo the first macro hides some specific rows (and columns but that is not my issue) when a case is selected from a drop-down list;</p>\n\n<pre><code>    Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Column &lt;&gt; 1 Then Exit Sub\n    Application.EnableEvents = False\n      Select Case Target.Text\n      Case \"Case 1\"\n          ActiveSheet.Range(\"K:W\").EntireColumn.Hidden = True\n          ActiveSheet.Rows(\"5:150\").EntireRow.Hidden = True\n          ActiveSheet.Range(\"K:K\").EntireColumn.Hidden = False\n          ActiveSheet.Range(\"L:L\").EntireColumn.Hidden = False\n          ActiveSheet.Range(\"M:M\").EntireColumn.Hidden = False\n          ActiveSheet.Range(\"N:N\").EntireColumn.Hidden = False\n          ActiveSheet.Range(\"O:O\").EntireColumn.Hidden = False\n          ActiveSheet.Rows(\"5:50\").EntireRow.Hidden = False\n      Case \"Case 2\"\n          ActiveSheet.Range(\"K:W\").EntireColumn.Hidden = True\n          ActiveSheet.Rows(\"5:150\").EntireRow.Hidden = True\n          ActiveSheet.Range(\"P:P\").EntireColumn.Hidden = False\n          ActiveSheet.Range(\"Q:Q\").EntireColumn.Hidden = False\n          ActiveSheet.Range(\"R:R\").EntireColumn.Hidden = False\n          ActiveSheet.Range(\"S:S\").EntireColumn.Hidden = False\n          ActiveSheet.Range(\"T:T\").EntireColumn.Hidden = False\n          ActiveSheet.Rows(\"51:100\").EntireRow.Hidden = False\n    End Select\n    Application.EnableEvents = True\n    End Sub\n</code></pre>\n\n<p>This macro works alright. The second macro I have is (which I got it through stackoverflow :) ) to merge C2 and C3 if there is an \"update\" value below the \"new\" entry.\n;</p>\n\n<pre><code>     C      D\n1   LOW     new\n2   HIGH    new\n3          update\n4   Low     new\n5          update\n6          update\n</code></pre>\n\n<p>and this is the macro;</p>\n\n<pre><code>Private Sub Worksheet_Change()\nDim RgToMerge As String\nDim i As Double\nFor i = 5 To ActiveSheet.Cells(Rows.Count, 4).End(xlUp).Row\n    RgToMerge = \"\"\n    If LCase(Cells(i, 4)) &lt;&gt; \"update\" Or (LCase(Cells(i + 1, 4)) &lt;&gt; \"new\" And Cells(i + 1, 4) &lt;&gt; \"\") Then\n    Else\n        RgToMerge = \"$C$\" &amp; Cells(i, 3).End(xlUp).Row &amp; \":$C$\" &amp; i\n        With Range(RgToMerge)\n            .merge\n            .HorizontalAlignment = xlCenter\n            .VerticalAlignment = xlCenter\n        End With\n    End If\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>This code works perfectly IF there are no hidden rows.\nNow the problem is; if the second case is selected on the first macro, rows from 5 to 50 will hidden. At this point, whenever second macro gets activated, it merges all the C column in one (including the hidden rows).</p>\n\n<p>Is there anyway to rewrite this two scripts to make them work together? </p>\n"}, {"tags": ["sql", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 355, "user_id": 823584, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8bc25759f4d816b1fa08fcc0709cff0e?s=128&d=identicon&r=PG", "display_name": "emilios", "link": "https://stackoverflow.com/users/823584/emilios"}, "edited": false, "score": 0, "creation_date": 1428483242, "post_id": 29510023, "comment_id": 47176285, "body": "if i split my Query and run them separately they are working fine."}, {"owner": {"reputation": 11008, "user_id": 1230257, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/Gcmi0.jpg?s=128&g=1", "display_name": "Danyal Sandeelo", "link": "https://stackoverflow.com/users/1230257/danyal-sandeelo"}, "reply_to_user": {"reputation": 355, "user_id": 823584, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8bc25759f4d816b1fa08fcc0709cff0e?s=128&d=identicon&r=PG", "display_name": "emilios", "link": "https://stackoverflow.com/users/823584/emilios"}, "edited": false, "score": 0, "creation_date": 1428483381, "post_id": 29510023, "comment_id": 47176360, "body": "can you write the way you are creating sql in stirng? @emilios"}, {"owner": {"reputation": 355, "user_id": 823584, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8bc25759f4d816b1fa08fcc0709cff0e?s=128&d=identicon&r=PG", "display_name": "emilios", "link": "https://stackoverflow.com/users/823584/emilios"}, "edited": false, "score": 0, "creation_date": 1428483635, "post_id": 29510023, "comment_id": 47176528, "body": "if i understand correctly - I am running it from Access Queries . Not passing  it to a string yet"}], "tags": [], "owner": {"reputation": 11008, "user_id": 1230257, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/Gcmi0.jpg?s=128&g=1", "display_name": "Danyal Sandeelo", "link": "https://stackoverflow.com/users/1230257/danyal-sandeelo"}, "is_accepted": false, "score": 1, "last_activity_date": 1428483015, "creation_date": 1428483015, "answer_id": 29510023, "question_id": 29509954, "link": "https://stackoverflow.com/questions/29509954/syntax-error-in-a-query/29510023#29510023", "title": "Syntax error in a Query", "body": "<p>try changing   </p>\n\n<pre><code>INNER JOIN tblItemType ON (tblItem.itemiitID = tblItemType.ittID AND tblItem.itemProduct = true) \n</code></pre>\n\n<p>to</p>\n\n<pre><code>INNER JOIN tblItemType ON tblItem.itemiitID = tblItemType.ittID AND tblItem.itemProduct = true \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 355, "user_id": 823584, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8bc25759f4d816b1fa08fcc0709cff0e?s=128&d=identicon&r=PG", "display_name": "emilios", "link": "https://stackoverflow.com/users/823584/emilios"}, "is_accepted": false, "score": 1, "last_activity_date": 1428484140, "creation_date": 1428484140, "answer_id": 29510406, "question_id": 29509954, "link": "https://stackoverflow.com/questions/29509954/syntax-error-in-a-query/29510406#29510406", "title": "Syntax error in a Query", "body": "<p>thanks i solve it Changing the above line </p>\n\n<pre><code>(tblItem INNER JOIN tblItemType ON (tblItem.itemiitID = tblItemType.ittID AND tblItem.itemProduct = true))\n</code></pre>\n"}], "owner": {"reputation": 355, "user_id": 823584, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8bc25759f4d816b1fa08fcc0709cff0e?s=128&d=identicon&r=PG", "display_name": "emilios", "link": "https://stackoverflow.com/users/823584/emilios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1594654613, "creation_date": 1428482797, "last_edit_date": 1594654613, "question_id": 29509954, "link": "https://stackoverflow.com/questions/29509954/syntax-error-in-a-query", "title": "Syntax error in a Query", "body": "<pre><code>SELECT itemID AS broID, \n       ittCode AS broField1, \n       ittDescr AS broField2, \n       itemCode AS broField3, \n       itemDesc AS broField4, \n       Qty AS broField5  \n FROM tblItem \n       INNER JOIN tblItemType ON (tblItem.itemiitID = tblItemType.ittID AND tblItem.itemProduct = true) \n       LEFT JOIN \n           (SELECT whiitemID,\n                   Sum(whiQty) AS Qty   \n              FROM tblWarehouseItem AS WI\n                   INNER JOIN tblWarehouse AS W ON WI.whiwrhID = W.wrhID   \n             WHERE w.wrhTemp = False        \n               AND W.wrhActive = True    \n               AND w.wrhLock = False     \n          GROUP BY whiitemID) AS WItem ON tblItem.itemID = WItem.whiitemID \nORDER BY ittCode, itemCode\n</code></pre>\n\n<p>When i try to run it i am getting a syntax error  if you please help me out \n<img src=\"https://i.stack.imgur.com/RQv7E.jpg\" alt=\"enter image description here\"> </p>\n"}, {"tags": ["vba", "copy-paste", "powerpoint"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1428480330, "post_id": 29508996, "comment_id": 47174611, "body": "Before pasting, you&#39;ll need to copy something, the <code>.Paste</code> is coming right after what can be speicified as <code>Destination</code>. So try <code>oShapes.Copy Destination:= oSlide</code>"}], "answers": [{"tags": [], "owner": {"reputation": 546, "user_id": 4567386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f8fce6de0ea6f1be214fa8a8469481?s=128&d=identicon&r=PG&f=1", "display_name": "Shyam Pillai", "link": "https://stackoverflow.com/users/4567386/shyam-pillai"}, "is_accepted": true, "score": 0, "last_activity_date": 1428511294, "last_edit_date": 1428511294, "creation_date": 1428505011, "answer_id": 29518247, "question_id": 29508996, "link": "https://stackoverflow.com/questions/29508996/how-do-i-paste-a-shape-into-the-notes-page-of-a-powerpoint-presentation-in-vba/29518247#29518247", "title": "How do I paste a Shape into the notes page of a Powerpoint presentation in VBA?", "body": "<p>This was a known bug in PPT 2007/2010 but is fixed in 2013. \nFor 2007/2010 switch to the notes page view, move to the desired notes page and then use <code>ActiveWindow.View.Paste</code> to get the same effect.</p>\n"}], "owner": {"reputation": 3, "user_id": 4762609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6047cb435da09b95566bf7e19e89d13?s=128&d=identicon&r=PG&f=1", "display_name": "Tin4", "link": "https://stackoverflow.com/users/4762609/tin4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 29518247, "answer_count": 1, "score": 0, "last_activity_date": 1428511294, "creation_date": 1428479761, "question_id": 29508996, "link": "https://stackoverflow.com/questions/29508996/how-do-i-paste-a-shape-into-the-notes-page-of-a-powerpoint-presentation-in-vba", "title": "How do I paste a Shape into the notes page of a Powerpoint presentation in VBA?", "body": "<p>I am trying to use the following code to paste a copied shape into a note page, but the Paste commands fails with the error \"The specified data type is unavailable\". It works if the clipboard contains texts instead of a shape. Any help is appreciated</p>\n\n<pre><code>Dim oSlide As Slide\nDim oShapes As Shapes\n\nSet oSlide = ActivePresentation.Slides.Item(1).NotesPage.Item(1)\nSet oShapes = oSlide.Shapes\noShapes.Paste\n</code></pre>\n"}, {"tags": ["vba", "sharepoint", "ms-word"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1428760759, "post_id": 29508717, "comment_id": 47305701, "body": "You can either do this in code or <a href=\"http://blog.laptopmag.com/disable-protected-view-microsoft-wor\" rel=\"nofollow noreferrer\">through Word settings</a>. Feel free to reply to the comment if you&#39;re looking for a code solution."}, {"owner": {"reputation": 1607, "user_id": 1359155, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1e04131f4632988913908f60ba6481d9?s=128&d=identicon&r=PG", "display_name": "shelbypereira", "link": "https://stackoverflow.com/users/1359155/shelbypereira"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1428945018, "post_id": 29508717, "comment_id": 47367693, "body": "That would be great if you have a VB macro, in fact I checked your solution, but I cannot use it where I work since it appears those settings are blocked."}], "answers": [{"comments": [{"owner": {"reputation": 1607, "user_id": 1359155, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1e04131f4632988913908f60ba6481d9?s=128&d=identicon&r=PG", "display_name": "shelbypereira", "link": "https://stackoverflow.com/users/1359155/shelbypereira"}, "edited": false, "score": 0, "creation_date": 1428995290, "post_id": 29616714, "comment_id": 47386308, "body": "Many thanks for this, normally I could find this by recording the macro and looking at the code, but here it was impossible since macro record is not able when the popup is there!  Great clear answer!"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 2, "last_activity_date": 1428967699, "creation_date": 1428967699, "answer_id": 29616714, "question_id": 29508717, "link": "https://stackoverflow.com/questions/29508717/vb-macro-to-disable-edit-document-prompt-when-opening-a-word-document-from-sha/29616714#29616714", "title": "VB macro to disable &quot;Edit Document&quot; prompt when opening a word document from sharepoint", "body": "<p>Depending on your security settings (you mentioned that they were blocked), this may or may not work.</p>\n\n<p>Create a new macro enabled template in your Word startup folder (usually at C:\\Users[YourID]\\AppData\\Roaming\\Microsoft\\Word\\STARTUP), and add a new class module.  I called mine \"AutoEditEnable\".  You can name it anything, but you'll need it to match how you declare it in the other module.</p>\n\n<p>This code goes in the class:</p>\n\n<pre><code>Option Explicit\nPrivate WithEvents app As Application\n\nPrivate Sub Class_Initialize()\n\n    Set app = Application\n\nEnd Sub\n\nPrivate Sub app_ProtectedViewWindowOpen(ByVal PvWindow As ProtectedViewWindow)\n\n    PvWindow.Edit\n\nEnd Sub\n</code></pre>\n\n<p>Basically, this will hook any Application events you need to - in this case the ProtectedViewWindowOpen event or the ProtectedViewWindowActivate event (either should work).</p>\n\n<p>Put the following code in ThisDocument to grab a reference to it when your template loads:</p>\n\n<pre><code>Option Explicit\nPrivate hook As AutoEditEnable\n\nPrivate Sub Document_Open()\n\n    Set hook = New AutoEditEnable\n\nEnd Sub\n</code></pre>\n\n<p>Close Word and restart it, then make sure your new template shows up as a loaded add-in.</p>\n"}], "owner": {"reputation": 1607, "user_id": 1359155, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1e04131f4632988913908f60ba6481d9?s=128&d=identicon&r=PG", "display_name": "shelbypereira", "link": "https://stackoverflow.com/users/1359155/shelbypereira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 819, "favorite_count": 0, "accepted_answer_id": 29616714, "answer_count": 1, "score": 0, "last_activity_date": 1594069742, "creation_date": 1428478813, "last_edit_date": 1594069742, "question_id": 29508717, "link": "https://stackoverflow.com/questions/29508717/vb-macro-to-disable-edit-document-prompt-when-opening-a-word-document-from-sha", "title": "VB macro to disable &quot;Edit Document&quot; prompt when opening a word document from sharepoint", "body": "<p>Is there a way to disable the message (and have the document editable by default):</p>\n\n<p>Server Document To modify document, click Edit Document followed by the button with text \"Edit Document\".</p>\n\n<p>I cannot find a word setting to do this.  In addition I cannot see a way to make a VB macro to do this with a key stroke.  I have used a small autohotkey script to position the mouse and click this prompt, but this does not always work since it depends on the position of the window.  it is impossible to use the tab key to get to this prompt.</p>\n\n<p>I have to modify about 50+ documents a day from sharepoint, ideally I would like to combine this with another macro which does other automated processing for me.  But I can't find a VB solution for clicking the Edit button.</p>\n"}, {"tags": ["vb.net", "visual-studio-2010", "vba"], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 3004642, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/48a364f2d4c6287d29c2e168946183fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/3004642/nathan"}, "edited": false, "score": 0, "creation_date": 1428479425, "post_id": 29508048, "comment_id": 47174082, "body": "How to check the earlier VS version...? Yes the project has database functionality too...."}, {"owner": {"reputation": 836, "user_id": 1662394, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/4vnNm.jpg?s=128&g=1", "display_name": "Mahadev", "link": "https://stackoverflow.com/users/1662394/mahadev"}, "reply_to_user": {"reputation": 125, "user_id": 3004642, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/48a364f2d4c6287d29c2e168946183fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/3004642/nathan"}, "edited": false, "score": 0, "creation_date": 1428483494, "post_id": 29508048, "comment_id": 47176430, "body": "Well, your project must have a .sln ( Solution ) file. If you have a VS 2010 installed and even if you have greater version .sln, there is a numberon .sln icon. You can recognize version from that or try to find version in .sln files properties.  After opening project, explore the project to find database information. First try to find VS Version"}, {"owner": {"reputation": 125, "user_id": 3004642, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/48a364f2d4c6287d29c2e168946183fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/3004642/nathan"}, "edited": false, "score": 0, "creation_date": 1428555890, "post_id": 29508048, "comment_id": 47213948, "body": "I got a .sln file but i did not notice any number written on the icon nor any version specified in the files properties too...."}, {"owner": {"reputation": 836, "user_id": 1662394, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/4vnNm.jpg?s=128&g=1", "display_name": "Mahadev", "link": "https://stackoverflow.com/users/1662394/mahadev"}, "reply_to_user": {"reputation": 125, "user_id": 3004642, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/48a364f2d4c6287d29c2e168946183fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/3004642/nathan"}, "edited": false, "score": 0, "creation_date": 1428557056, "post_id": 29508048, "comment_id": 47214309, "body": "Are you sure you have at least VS 2010 installed. Otherwise file will not show specific icon"}, {"owner": {"reputation": 125, "user_id": 3004642, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/48a364f2d4c6287d29c2e168946183fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/3004642/nathan"}, "edited": false, "score": 0, "creation_date": 1428558186, "post_id": 29508048, "comment_id": 47214741, "body": "Yes VS 2010 is installed...   I am able to open some .vb files. When i tried to open .sln file using VS it asked me to keep back up of existing files and converted my files to something...   I dont know what exactly it did but right now i have backup files generated...."}, {"owner": {"reputation": 836, "user_id": 1662394, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/4vnNm.jpg?s=128&g=1", "display_name": "Mahadev", "link": "https://stackoverflow.com/users/1662394/mahadev"}, "reply_to_user": {"reputation": 125, "user_id": 3004642, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/48a364f2d4c6287d29c2e168946183fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/3004642/nathan"}, "edited": false, "score": 0, "creation_date": 1428558350, "post_id": 29508048, "comment_id": 47214806, "body": "Well, if the VS tells to take backup, its a good sign. This is actually a upgrade process. VS will take backup of OLD version files and upgrade project for VS 2010. GO ahead, take backup and continue and you should be able to open project in VS2010"}, {"owner": {"reputation": 125, "user_id": 3004642, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/48a364f2d4c6287d29c2e168946183fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/3004642/nathan"}, "edited": false, "score": 0, "creation_date": 1428558866, "post_id": 29508048, "comment_id": 47214999, "body": "Microsoft Visual Studio Solution File, Format Version 10.00 # Visual Studio 2008 Project(&quot;{F184B08F-C81C-45F6-A57F-5ABD9991F28F}&quot;) = &quot;myproject&quot;, &quot;myproject\\myproject.vbproj&quot;, &quot;{8C04867E-3CA4-481A-A664-5DF8AB6A7854}&quot; EndProject"}, {"owner": {"reputation": 125, "user_id": 3004642, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/48a364f2d4c6287d29c2e168946183fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/3004642/nathan"}, "edited": false, "score": 0, "creation_date": 1428558910, "post_id": 29508048, "comment_id": 47215016, "body": "This is the 1st 3 lines of .sln file from the backup"}, {"owner": {"reputation": 125, "user_id": 3004642, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/48a364f2d4c6287d29c2e168946183fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/3004642/nathan"}, "edited": false, "score": 0, "creation_date": 1428558942, "post_id": 29508048, "comment_id": 47215029, "body": "Microsoft Visual Studio Solution File, Format Version 11.00 # Visual Studio 2010 Project(&quot;{F184B08F-C81C-45F6-A57F-5ABD9991F28F}&quot;) = &quot;myproject&quot;, &quot;myproject\\myproject.vbproj&quot;, &quot;{8C04867E-3CA4-481A-A664-5DF8AB6A7854}&quot; EndProject"}, {"owner": {"reputation": 125, "user_id": 3004642, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/48a364f2d4c6287d29c2e168946183fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/3004642/nathan"}, "edited": false, "score": 0, "creation_date": 1428558971, "post_id": 29508048, "comment_id": 47215044, "body": "This is the 1st 3 lines of .sln file from the current project folder"}, {"owner": {"reputation": 125, "user_id": 3004642, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/48a364f2d4c6287d29c2e168946183fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/3004642/nathan"}, "edited": false, "score": 0, "creation_date": 1428559056, "post_id": 29508048, "comment_id": 47215082, "body": "So is that means the version of the project is VS 2008 and now it is upgraded to VS 2010....?"}, {"owner": {"reputation": 836, "user_id": 1662394, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/4vnNm.jpg?s=128&g=1", "display_name": "Mahadev", "link": "https://stackoverflow.com/users/1662394/mahadev"}, "reply_to_user": {"reputation": 125, "user_id": 3004642, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/48a364f2d4c6287d29c2e168946183fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/3004642/nathan"}, "edited": false, "score": 0, "creation_date": 1428559132, "post_id": 29508048, "comment_id": 47215117, "body": "Yes. Now you should be able to view files in <b>Solution Explorer</b>  Now explore the project and find database related information"}, {"owner": {"reputation": 125, "user_id": 3004642, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/48a364f2d4c6287d29c2e168946183fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/3004642/nathan"}, "edited": false, "score": 0, "creation_date": 1428560358, "post_id": 29508048, "comment_id": 47215683, "body": "Yes i can view the files in Solution explorer...    How to explore the project...?"}, {"owner": {"reputation": 836, "user_id": 1662394, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/4vnNm.jpg?s=128&g=1", "display_name": "Mahadev", "link": "https://stackoverflow.com/users/1662394/mahadev"}, "reply_to_user": {"reputation": 125, "user_id": 3004642, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/48a364f2d4c6287d29c2e168946183fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/3004642/nathan"}, "edited": false, "score": 0, "creation_date": 1428560542, "post_id": 29508048, "comment_id": 47215777, "body": "Explore means open the forms and try to find the database connection. Can you post <b>Solution Explorer Snapshot</b> here ?"}, {"owner": {"reputation": 125, "user_id": 3004642, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/48a364f2d4c6287d29c2e168946183fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/3004642/nathan"}, "edited": false, "score": 0, "creation_date": 1428562230, "post_id": 29508048, "comment_id": 47216640, "body": "I got the database information from app.config file as below"}, {"owner": {"reputation": 125, "user_id": 3004642, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/48a364f2d4c6287d29c2e168946183fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/3004642/nathan"}, "edited": false, "score": 0, "creation_date": 1428562283, "post_id": 29508048, "comment_id": 47216668, "body": "&lt;connectionStrings&gt;         &lt;add name=&quot;WindowsApplication1.My.MySettings.myprojectConnectionS&zwnj;&#8203;tring&quot;             connectionString=&quot;server=localhost;User Id=root;database=myprojectdb&quot;             providerName=&quot;MySql.Data.MySqlClient&quot; /&gt;     &lt;/connectionStrings&gt;"}, {"owner": {"reputation": 836, "user_id": 1662394, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/4vnNm.jpg?s=128&g=1", "display_name": "Mahadev", "link": "https://stackoverflow.com/users/1662394/mahadev"}, "reply_to_user": {"reputation": 125, "user_id": 3004642, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/48a364f2d4c6287d29c2e168946183fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/3004642/nathan"}, "edited": false, "score": 0, "creation_date": 1428562769, "post_id": 29508048, "comment_id": 47216911, "body": "That means the project uses MySQL database. If you don&#39;t have MySQL database installed then install it, configure it, change the connection string acc to that configuration and you are good to go"}, {"owner": {"reputation": 125, "user_id": 3004642, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/48a364f2d4c6287d29c2e168946183fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/3004642/nathan"}, "edited": false, "score": 0, "creation_date": 1428563183, "post_id": 29508048, "comment_id": 47217108, "body": "Mysql is installed already and configurations are also set up....   So now i can continue with VB 2010 right....?"}, {"owner": {"reputation": 836, "user_id": 1662394, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/4vnNm.jpg?s=128&g=1", "display_name": "Mahadev", "link": "https://stackoverflow.com/users/1662394/mahadev"}, "reply_to_user": {"reputation": 125, "user_id": 3004642, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/48a364f2d4c6287d29c2e168946183fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/3004642/nathan"}, "edited": false, "score": 0, "creation_date": 1428563333, "post_id": 29508048, "comment_id": 47217188, "body": "Yes, absolutely. Just Run the project and try to insert or retrieve data from database"}, {"owner": {"reputation": 836, "user_id": 1662394, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/4vnNm.jpg?s=128&g=1", "display_name": "Mahadev", "link": "https://stackoverflow.com/users/1662394/mahadev"}, "reply_to_user": {"reputation": 125, "user_id": 3004642, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/48a364f2d4c6287d29c2e168946183fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/3004642/nathan"}, "edited": false, "score": 0, "creation_date": 1428569349, "post_id": 29508048, "comment_id": 47220683, "body": "Hey, the question you asked already solved, isn&#39;t it ? Close this question and ask new question for different problem.   We should not discuss other problems than the question asked,"}, {"owner": {"reputation": 125, "user_id": 3004642, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/48a364f2d4c6287d29c2e168946183fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/3004642/nathan"}, "edited": false, "score": 0, "creation_date": 1428571367, "post_id": 29508048, "comment_id": 47221948, "body": "Ok i thought something went wrong when i converted the code from VS 2008 to VS 2010...   Anyways thanx a lot for the guidance..."}], "tags": [], "owner": {"reputation": 836, "user_id": 1662394, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/4vnNm.jpg?s=128&g=1", "display_name": "Mahadev", "link": "https://stackoverflow.com/users/1662394/mahadev"}, "is_accepted": true, "score": 1, "last_activity_date": 1428476631, "creation_date": 1428476631, "answer_id": 29508048, "question_id": 29507813, "link": "https://stackoverflow.com/questions/29507813/how-to-do-a-project-modify-a-existing-project-in-vb/29508048#29508048", "title": "How to do a project/modify a existing project in VB", "body": "<p>You need to check the earlier VS version. If the project was developed in earlier version of VS, you can upgrade to VS 2010 easily but otherwise you need to get hands on specific VS version.</p>\n\n<p>Similarly if the project have database functionality or crystal report or any other external dependencies, you need to check their versions. You need to install the components according to these versions. Specify your versions and i'll tell you what to use for further development.</p>\n"}], "owner": {"reputation": 125, "user_id": 3004642, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/48a364f2d4c6287d29c2e168946183fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/3004642/nathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 29508048, "answer_count": 1, "score": 0, "last_activity_date": 1428476631, "creation_date": 1428475891, "question_id": 29507813, "link": "https://stackoverflow.com/questions/29507813/how-to-do-a-project-modify-a-existing-project-in-vb", "title": "How to do a project/modify a existing project in VB", "body": "<p>I have no idea/experience in VB programming. One of my client bought me his old project which need to be modified. He says it is written in Visual Basic and no idea which version.</p>\n\n<p>So how can i carry ON to work with this project by identifying the version\nAnd what other components do i require to do the programming and user interface.</p>\n\n<p>I already have Visual studio 2010 with me. So can i do my work using this software or i have to go for anything else...</p>\n\n<p>Any suggestions....?</p>\n\n<p>Regards \nParshTest</p>\n"}, {"tags": ["vba", "excel", "userform"], "answers": [{"tags": [], "owner": {"reputation": 140, "user_id": 4519177, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JlXTy.jpg?s=128&g=1", "display_name": "Monkawee Maneewalaya", "link": "https://stackoverflow.com/users/4519177/monkawee-maneewalaya"}, "is_accepted": false, "score": 0, "last_activity_date": 1428477229, "creation_date": 1428477229, "answer_id": 29508224, "question_id": 29507737, "link": "https://stackoverflow.com/questions/29507737/what-is-the-vba-excel-code-for-backing-to-the-userform-page/29508224#29508224", "title": "What is the VBA (EXCEL) Code for backing to the userform page?", "body": "<p>I recommend to watch your value of <code>strWkbookPath</code>. And you'll know what you should do.</p>\n"}, {"tags": [], "owner": {"reputation": 4511, "user_id": 767642, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/PktIl.jpg?s=128&g=1", "display_name": "Kannan Suresh", "link": "https://stackoverflow.com/users/767642/kannan-suresh"}, "is_accepted": true, "score": 0, "last_activity_date": 1428477665, "creation_date": 1428477665, "answer_id": 29508355, "question_id": 29507737, "link": "https://stackoverflow.com/questions/29507737/what-is-the-vba-excel-code-for-backing-to-the-userform-page/29508355#29508355", "title": "What is the VBA (EXCEL) Code for backing to the userform page?", "body": "<p>Try this\n<pre><code>\nPrivate Sub btnOpenWkbook_Click()\nDim strWkbookPath As String\nstrWkbookPath = Application.GetOpenFilename(filefilter:=\"Excel file, *.xlsx\")\nIf strWkbookPath = \"\" Or strWkbookPath = \"False\" Then\n    Exit Sub\nEnd If\nWorkbooks.Open Filename:=strWkbookPath\nSet Swkbook = Workbooks.Open(Filename:=strWkbookPath)\n'...\n'...\n'If strWkbookPath = \"False\" Then\n'   Unload frmSalesReport\n'End If\nEnd Sub\n</pre></code></p>\n"}], "owner": {"reputation": 69, "user_id": 4684880, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e9c39c1e147894edee7fd013b1c95cc3?s=128&d=identicon&r=PG&f=1", "display_name": "Wing Yan Yeung", "link": "https://stackoverflow.com/users/4684880/wing-yan-yeung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 29508355, "answer_count": 2, "score": 0, "last_activity_date": 1428477665, "creation_date": 1428475595, "question_id": 29507737, "link": "https://stackoverflow.com/questions/29507737/what-is-the-vba-excel-code-for-backing-to-the-userform-page", "title": "What is the VBA (EXCEL) Code for backing to the userform page?", "body": "<p>I am writing a VBA program to read a workbook from computer:</p>\n\n<pre><code>Private Sub btnOpenWkbook_Click()\n\nDim strWkbookPath As String\n\nstrWkbookPath = Application.GetOpenFilename(filefilter:=\"Excel file, *.xlsx\")\n\nWorkbooks.Open Filename:=strWkbookPath\n\nSet Swkbook = Workbooks.Open(Filename:=strWkbookPath)\n\n...\n\n...\n\nIf strWkbookPath = \"False\" Then\n   Unload frmSalesReport\nEnd If\n\nend sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/EtbTx.png\" alt=\"enter image description here\"></p>\n\n<p>Click the \"open workbook\" then a  Open dialog box opened:\n<img src=\"https://i.stack.imgur.com/Dlaab.png\" alt=\"Open dialog box\"></p>\n\n<blockquote>\n  <p>If the user clicks the Cancel button or Close button on the Open dialog box, how to back to the userform page?</p>\n</blockquote>\n\n<p>Now I get this error:</p>\n\n<p><img src=\"https://i.stack.imgur.com/EbHO0.png\" alt=\"enter image description here\">\n<img src=\"https://i.stack.imgur.com/YEjXY.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1428473454, "post_id": 29506857, "comment_id": 47171013, "body": "The event triggers for me when selecting a value from a validation list in column B. Is the box which sets the value located in a userform, or something like that, or is there some other code somewhere in your project which could have disabled events?"}, {"owner": {"reputation": 53, "user_id": 4752811, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/bb30e5828d9bd86a2c64cb631d703e91?s=128&d=identicon&r=PG&f=1", "display_name": "Karl D", "link": "https://stackoverflow.com/users/4752811/karl-d"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1428473674, "post_id": 29506857, "comment_id": 47171100, "body": "The above code works only if you enter manually the values on column B but if you create a data validation list on column B and then you select a random value  the macro does not work anymore"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1428474027, "post_id": 29506857, "comment_id": 47171271, "body": "As I stated it does trigger for me, when selecting a value from a validation list, so it seems there is something which is not apparent from the code above which causes the macro to fail."}, {"owner": {"reputation": 53, "user_id": 4752811, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/bb30e5828d9bd86a2c64cb631d703e91?s=128&d=identicon&r=PG&f=1", "display_name": "Karl D", "link": "https://stackoverflow.com/users/4752811/karl-d"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1428476107, "post_id": 29506857, "comment_id": 47172270, "body": "Im trying to use the same code for a different column but Im getting Ambiguous name detected Worrksheet_ Change how can I fix it ?"}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 1, "creation_date": 1428476942, "post_id": 29506857, "comment_id": 47172701, "body": "The code works for me too, using data validation dropdown in column B. To fix the latter error, you cannot have more than one <code>Worrksheet_ Change</code> event for one worksheet. Add the new test column (X in my case) to the condition <code>If Not Intersect(Target, Range(Columns(&quot;B&quot;), Columns(&quot;X&quot;))) Is Nothing Then</code>"}, {"owner": {"reputation": 53, "user_id": 4752811, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/bb30e5828d9bd86a2c64cb631d703e91?s=128&d=identicon&r=PG&f=1", "display_name": "Karl D", "link": "https://stackoverflow.com/users/4752811/karl-d"}, "edited": false, "score": 0, "creation_date": 1428538797, "post_id": 29506857, "comment_id": 47209312, "body": "The problem is that if a user enter a value on any cell under column X it needs to call a different macro not the same :S"}], "owner": {"reputation": 53, "user_id": 4752811, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/bb30e5828d9bd86a2c64cb631d703e91?s=128&d=identicon&r=PG&f=1", "display_name": "Karl D", "link": "https://stackoverflow.com/users/4752811/karl-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 516, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1428474185, "creation_date": 1428471916, "last_edit_date": 1531164843, "question_id": 29506857, "link": "https://stackoverflow.com/questions/29506857/run-a-macro-after-changing-a-value-on-a-data-validation-dropbox", "title": "Run a Macro after changing a value on a data validation dropbox", "body": "<p>A good person helped me creating the following code and it works fine  when you manually enter a value on any cell under column B but when I try to use the same code  when the value is select from data validation drop box is not working , do I need to change something ?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Columns(\"B\")) Is Nothing Then\n        On Error GoTo Safe_Exit\n        Application.EnableEvents = False\n        Dim rng As Range\n        For Each rng In Intersect(Target, Columns(\"B\"))\n            If rng.Row &gt; 2 Then ' your sample code seemed to suggest that this should start on row 3 and higher\n                Call Settime(rng.Row)\n            End If\n        Next rng\n    End If\nSafe_Exit:\n    Application.EnableEvents = True\nEnd Sub\n\nSub Settime(rw as long)\n    If range(\"B\" &amp; rw) = \"\" Then\n        MsgBox \"Ingrese El account Number\" \n    Else\n        Range(\"J\" &amp; rw &amp; \":K\" &amp; rw) = Range(\"J\" &amp; rw &amp; \":K\" &amp; rw).value\n    End If \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy", "range"], "comments": [{"owner": {"reputation": 5548, "user_id": 4625526, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6378aa788195a771461c5043057e2ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Norbert van Nobelen", "link": "https://stackoverflow.com/users/4625526/norbert-van-nobelen"}, "edited": false, "score": 0, "creation_date": 1428471272, "post_id": 29506649, "comment_id": 47170123, "body": "At least build a part of the code yourself. Parts can be found with google easily."}, {"owner": {"reputation": 4421, "user_id": 774575, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/I2J58.png?s=128&g=1", "display_name": "mins", "link": "https://stackoverflow.com/users/774575/mins"}, "edited": false, "score": 0, "creation_date": 1428471638, "post_id": 29506649, "comment_id": 47170276, "body": "Use <code>Do While</code> to loop, <code>If</code> to check if the cell is <code>null</code>, and <code>Exit Do</code> to exit the loop. See <a href=\"http://stackoverflow.com/questions/10933425/loop-through-rows-in-an-excel-worksheet-and-copy-a-range-if-the-cell-isnt-blank?rq=1\">this question</a> which is similar."}, {"owner": {"reputation": 9, "user_id": 4762053, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-euIB-l0V6v4/AAAAAAAAAAI/AAAAAAAAHlw/GolfEUi9Zy4/photo.jpg?sz=128", "display_name": "Sherly", "link": "https://stackoverflow.com/users/4762053/sherly"}, "edited": false, "score": 0, "creation_date": 1428472234, "post_id": 29506649, "comment_id": 47170519, "body": "I did build the code, but not able to iterate through rows."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1428472777, "post_id": 29506649, "comment_id": 47170738, "body": "a) no sample data b) no sample code c) no expected results d) no show of an original effort (see a, b and c). Definitely a minus 1 from me. Please see <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 9, "user_id": 4762053, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-euIB-l0V6v4/AAAAAAAAAAI/AAAAAAAAHlw/GolfEUi9Zy4/photo.jpg?sz=128", "display_name": "Sherly", "link": "https://stackoverflow.com/users/4762053/sherly"}, "edited": false, "score": 0, "creation_date": 1428473395, "post_id": 29506649, "comment_id": 47170986, "body": "sry for that ! ws.Range(&quot;B11&quot;, &quot;G11&quot;).Copy I just want to know how to increment the cell to (B12,G12) and so on"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1428474303, "post_id": 29506649, "comment_id": 47171402, "body": "You can use all kind of loops for that (for, while, ...). There is plenty of subject like this on the forum and on internet. Just take a look around and you&#39;ll find your answer for sure because it is <b>such a classical question</b>. Easy way is to define a string variable to make &quot;B11:G11&quot; become &quot;B12:G12&quot; and so on."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1428474369, "post_id": 29506649, "comment_id": 47171440, "body": "Take a look here : <a href=\"http://stackoverflow.com/a/29208949/4628637\">stackoverflow.com/a/29208949/4628637</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1428475121, "creation_date": 1428475121, "answer_id": 29507621, "question_id": 29506649, "link": "https://stackoverflow.com/questions/29506649/copy-range-of-values/29507621#29507621", "title": "Copy range of values", "body": "<p>Try this</p>\n\n<pre><code>Dim rng As Range, cell As Range\nSet rng = Range(\"A1:B4\")\n    ' loop trought each row in selected column Columns(1) = first column in range\n    For Each onlyDefinedColumnRow In rng.Columns(1).Rows\n        If IsEmpty(onlyDefinedColumnRow) Then Exit For\n    i = i + 1\n    Next onlyDefinedColumnRow\n    ' or loop trought each cell in range\n    'For Each cell In rng.Rows\n    '    If IsEmpty(cell) Then Exit For\n    'i = i + 1\n    'Next cell\n\nrng.Resize(i).Copy Destination:=Cells(i + 2, 1)\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 4762053, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-euIB-l0V6v4/AAAAAAAAAAI/AAAAAAAAHlw/GolfEUi9Zy4/photo.jpg?sz=128", "display_name": "Sherly", "link": "https://stackoverflow.com/users/4762053/sherly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1428496540, "creation_date": 1428471002, "last_edit_date": 1428496540, "question_id": 29506649, "link": "https://stackoverflow.com/questions/29506649/copy-range-of-values", "title": "Copy range of values", "body": "<p>Hi I need to copy a particular range of cells and iterate through rows and continue the copying process until a null value is encountered . Hard to get the code \nplease help</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1428471751, "post_id": 29506274, "comment_id": 47170318, "body": "doesn&#39;t wb.close work?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1428471767, "post_id": 29506274, "comment_id": 47170327, "body": "Where are you trying to close it?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1428472204, "post_id": 29506274, "comment_id": 47170507, "body": "There are several issues with your code - main one being that you need to hold on to a reference to the workbook &amp; worksheet objects you&#39;re working with. <code>Activate</code> and <code>Select</code> are evil. Also, what if more than one opened workbook names start with &quot;SHIPPING LIST&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4718537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17fabe5b2438004880c8750254034291?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4718537/jason"}, "edited": false, "score": 0, "creation_date": 1428625762, "post_id": 29507322, "comment_id": 47254133, "body": "thank you. It&#39;s having me debug once it gets to wb.Columns(&quot;A:I&quot;).Copy. could you please help?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 23, "user_id": 4718537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17fabe5b2438004880c8750254034291?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4718537/jason"}, "edited": false, "score": 0, "creation_date": 1428640305, "post_id": 29507322, "comment_id": 47257824, "body": "It&#39;s because we needed to specify te worksheets that were using. Is it good now?"}, {"owner": {"reputation": 23, "user_id": 4718537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17fabe5b2438004880c8750254034291?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4718537/jason"}, "edited": false, "score": 0, "creation_date": 1428685097, "post_id": 29507322, "comment_id": 47283207, "body": "thank you. I specified the worksheets. Debug now moved down to: Windows(&quot;PRIORITIES TEMPLATE - SHIPPING LIST.xlsm&quot;).Sheets(&quot;xyz - abc&quot;).Range(&quot;A1&quot;).Paste"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 23, "user_id": 4718537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17fabe5b2438004880c8750254034291?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4718537/jason"}, "edited": false, "score": 0, "creation_date": 1428687251, "post_id": 29507322, "comment_id": 47284326, "body": "Plz specify the error message, it is useful to identify. Best guess just switch <code>Windows(&quot;</code> to <code>Workbooks(&quot;</code> , if not enough check the edit."}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1428687406, "last_edit_date": 1428687406, "creation_date": 1428473935, "answer_id": 29507322, "question_id": 29506274, "link": "https://stackoverflow.com/questions/29506274/how-to-close-a-workbook-if-using-wb-name-like/29507322#29507322", "title": "how to close a workbook if using wb.name like", "body": "<p>Try this :\n(Got rid of useless and memory-greedy \"select\" and \"activate\")</p>\n\n<pre><code>    Dim wb As Workbook\n        Dim WbName as String\n\n    For Each wb In Application.Workbooks\n    If wb.Name Like \"SHIPPING LIST*\" Then\n        wb.Sheets(1).Columns(\"A:I\").Copy\nDestination:=Workbooks(\"PRIORITIES TEMPLATE - SHIPPING LIST.xlsm\").Sheets(\"xyz - abc\").Range(\"A1\")\n        wb.Close\n    Else\n\n    End if\n\n\n    Next wb\n</code></pre>\n\n<p>If <code>wb.Name Like \"SHIPPING LIST*\"</code> doesn't work (never used it in VBA...), use <code>Instr(1, wb.Name, \"SHIPPING LIST\")&lt;&gt;0 then</code></p>\n"}], "owner": {"reputation": 23, "user_id": 4718537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17fabe5b2438004880c8750254034291?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4718537/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1300, "favorite_count": 0, "accepted_answer_id": 29507322, "answer_count": 1, "score": -1, "last_activity_date": 1487250545, "creation_date": 1428469043, "last_edit_date": 1487250545, "question_id": 29506274, "link": "https://stackoverflow.com/questions/29506274/how-to-close-a-workbook-if-using-wb-name-like", "title": "how to close a workbook if using wb.name like", "body": "<p>Could you please help closing a workbook where \"like\" was used when opening as the sample below?</p>\n\n<pre><code>Dim wb As Workbook\nFor Each wb In Application.Workbooks\nIf wb.Name Like \"SHIPPING LIST*\" Then wb.Activate\nNext wb\nColumns(\"A:I\").Select\nSelection.Copy\nWindows(\"PRIORITIES TEMPLATE - SHIPPING LIST.xlsm\").Activate\nSheets(\"xyz - abc\").Select\nRange(\"A1\").Select\nSheets(\"xyz - abc\").Paste\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 2914380, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c687588cd649a47296061299318d0dd8?s=128&d=identicon&r=PG&f=1", "display_name": "krishna", "link": "https://stackoverflow.com/users/2914380/krishna"}, "edited": false, "score": 0, "creation_date": 1428467502, "post_id": 29505859, "comment_id": 47168875, "body": "Thanks you ,I am sorry it should be coming once and is this will perform well even the data is too big to handle."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 83, "user_id": 2914380, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c687588cd649a47296061299318d0dd8?s=128&d=identicon&r=PG&f=1", "display_name": "krishna", "link": "https://stackoverflow.com/users/2914380/krishna"}, "edited": false, "score": 0, "creation_date": 1428467955, "post_id": 29505859, "comment_id": 47169021, "body": "OK I have made further cleanups and edited my original answer. Please try the code and report back then we can start performance tuning. A note on your code, always use Long instead of Integer when using VBA and also make sure you dim ALL your variables. Note I have put Option Explicit as the top line, this will give you an error (Debug error, variable not defined) if you have a variable in your code that is not dimmed."}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": true, "score": 1, "last_activity_date": 1428467824, "last_edit_date": 1428467824, "creation_date": 1428466786, "answer_id": 29505859, "question_id": 29505660, "link": "https://stackoverflow.com/questions/29505660/performance-issue-and-error-in-excel-vba/29505859#29505859", "title": "Performance issue and error in Excel vba", "body": "<p>I have taken the liberty of cleaning up your code a bit, I dropped a couple of comments in there to show you the changes and I have indented it properly.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton1_Click()\nDim dates As Variant, Array1() As Variant, MyArray1(24, 7) As Long, g As Long, MyWeekday As Variant, X As Long, K As Long, F As Long, Y As Long, Range1 As Range\nMyWeekday = Array(\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\")\nRange(\"I2:O25\").ClearContents\nSet Range1 = Range(\"B:B\")\nArray1 = UniqueItems(Range1, False)\nFor Each dates In Array1\n    If Not (dates = \"\" Or dates = \"Date\") Then\n        For Y = 2 To Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n            If (dates = (Cells(Y, 2))) Then\n                For F = 2 To Range(\"f\" &amp; Rows.Count).End(xlUp).Row\n                    If ((TimeValue(Cells(Y, 4).Text) &gt;= TimeValue(Cells(F, 6).Text)) And (TimeValue(Cells(Y, 4).Text) &lt;= TimeValue(Cells(F, 7).Text))) Then\n                        For X = LBound(MyWeekday) To UBound(MyWeekday)\n                            If (Cells(Y, 3) = MyWeekday(X)) Then\n                                g = F - 2\n                                MyArray1(g, X) = 1\n                            End If\n                        Next\n                    End If\n                Next\n            End If\n        Next\n        For K = 0 To 7\n            For X = 0 To 23\n                Cells(X + 2, K + 9) = Cells(X + 2, K + 9) + MyArray1(X, K)\n                MyArray1(X, K) = 0\n            Next\n        Next\n    End If\nNext\nEnd Sub\n\nFunction RetTime(IntTime As Long) As Date\nRetTime = TimeSerial(Int(IntTime / 10000), Int((IntTime Mod 10000) / 100), (IntTime Mod 100))\nEnd Function\n\nFunction UniqueItems(ArrayIn, Optional Count As Variant) As Variant\n'   Accepts an array or range as input\n'   If Count = True or is missing, the function returns the number of unique elements\n'   If Count = False, the function returns a variant array of unique elements\n    Dim Unique() As Variant, Element As Variant, i As Long, FoundMatch As Boolean, NumUnique As Long\n'   If 2nd argument is missing, assign default value\n    If IsMissing(Count) Then Count = True\n'   Counter for number of unique elements\n    NumUnique = 0\n'   Loop thru the input array\n    For Each Element In ArrayIn\n        FoundMatch = False\n'       Has item been added yet?\n        For i = 1 To NumUnique\n            If Element = Unique(i) Then\n                FoundMatch = True\n                Exit For '(exit loop)\n            End If\n        Next i\n'AddItem  -  You don't need this as a GoTo heading you can jump to, keep it commented out\n'       If not in list, add the item to unique list\n        If Not FoundMatch And Not IsEmpty(Element) Then\n            NumUnique = NumUnique + 1\n            ReDim Preserve Unique(NumUnique)\n            Unique(NumUnique) = Element\n        End If\n    Next Element\n'   Assign a value to the function\n    If Count Then UniqueItems = NumUnique Else UniqueItems = Unique\nEnd Function\n</code></pre>\n\n<p>Please post try the code I posted and see if it does the same as your code did, if so then we can begin making the changes you need.</p>\n"}], "owner": {"reputation": 83, "user_id": 2914380, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c687588cd649a47296061299318d0dd8?s=128&d=identicon&r=PG&f=1", "display_name": "krishna", "link": "https://stackoverflow.com/users/2914380/krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 29505859, "answer_count": 1, "score": 0, "last_activity_date": 1435472946, "creation_date": 1428465429, "last_edit_date": 1435472946, "question_id": 29505660, "link": "https://stackoverflow.com/questions/29505660/performance-issue-and-error-in-excel-vba", "title": "Performance issue and error in Excel vba", "body": "<p>I have created a code for getting unique value from a column which is filled with date and from that unique column i have compare whether it is Sunday or Monday or Tuesday or etc and if it falls in between two time stamp [2:00:00 am to 2:59:59 am] i increment  but if on same date for example 1/5/2014 it falls in two time stamp again[2:00:00 am - 2:59:59 am] i should not increment and if in the same date it falls in another time stamp it should increment that too only once.</p>\n\n<p>It is working for 50 -100 rows but for 200k of rows it is hanging.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nRange(\"I2:O25\") = \"\"\nSet Range1 = Range(\"B:B\")\n\nDim dates As Variant\n\nDim Array1() As Variant\n\nDim MyArray1(24, 7) As Integer\n\n\nArray1 = UniqueItems(Range1, False)\n      For Each dates In Array1\n      If Not (dates = \"\" Or dates = \"Date\") Then\n       For y = 2 To Range(\"B2\").End(xlDown).Row\n       If (dates = (Cells(y, 2))) Then\n\n    For f = 2 To Range(\"f2\").End(xlDown).Row\n\n     If ((TimeValue(Cells(y, 4).Text) &gt;= TimeValue(Cells(f, 6).Text)) And (TimeValue(Cells(y, 4).Text) &lt;= TimeValue(Cells(f, 7).Text))) Then\n\n             If (Cells(y, 3) = \"Sunday\") Then\n\n'             Cells(f, 12) = 1\n\nDim g As Integer\ng = f - 2\n\n             MyArray1(g, 0) = 1\n\n               End If\n          If (Cells(y, 3) = \"Monday\") Then\n\n'             Cells(f, 12) = 1\n\n\ng = f - 2\n\n             MyArray1(g, 1) = 1\n\n               End If\n                 If (Cells(y, 3) = \"Tuesday\") Then\n\n'             Cells(f, 12) = 1\n\n\ng = f - 2\n\n             MyArray1(g, 2) = 1\n\n               End If\n                 If (Cells(y, 3) = \"Wednesday\") Then\n\n'             Cells(f, 12) = 1\n\n\ng = f - 2\n\n             MyArray1(g, 3) = 1\n\n               End If\n          If (Cells(y, 3) = \"Thursday\") Then\n\n'             Cells(f, 12) = 1\n\n\ng = f - 2\n\n             MyArray1(g, 4) = 1\n\n               End If\n                  If (Cells(y, 3) = \"Friday\") Then\n\n'             Cells(f, 12) = 1\n\n\ng = f - 2\n\n             MyArray1(g, 5) = 1\n\n               End If\n              If (Cells(y, 3) = \"Saturday\") Then\n\n'             Cells(f, 12) = 1\n\n\ng = f - 2\n\n             MyArray1(g, 6) = 1\n\n               End If\n           End If\n\n    Next f\n\n       End If\n       Next y\n\n     For k = 0 To 7\n\n       For x = 0 To 23\n\n       Dim cellsval As Integer\n\n       Dim dayvals As Integer\n       cellsval = x + 2\n       dayvals = k + 9\n    Cells(cellsval, dayvals) = Cells(cellsval, dayvals) + MyArray1(x, k)\n    MyArray1(x, k) = 0\n\n    Next x\n       Next k\n      End If\n\n    Next\n\n'For x = 2 To Range(\"H2\").End(xlDown).Row\n'    For y = 2 To Range(\"A2\").End(xlDown).Row\n'        If (Cells(y, 2) = Cells(x, 8)) Then\n'            If ((TimeValue(Cells(y, 4).Text) &gt;= TimeValue(Cells(16, 6).Text)) And (TimeValue(Cells(y, 4).Text) &lt;= TimeValue(Cells(16, 7).Text))) Then\n'                If (Cells(y, 3) = \"Wednesday\") Then\n'                    Cells(x, 22) = 1\n'                End If\n'            End If\n'        End If\n'    Next y\n'Next x\nEnd Sub\n\nFunction RetTime(IntTime As Long) As Date\nRetTime = TimeSerial(Int(IntTime / 10000), Int((IntTime Mod 10000) / 100), (IntTime Mod 100))\nEnd Function\n\nFunction UniqueItems(ArrayIn, Optional Count As Variant) As Variant\n'   Accepts an array or range as input\n'   If Count = True or is missing, the function returns the number of unique elements\n'   If Count = False, the function returns a variant array of unique elements\n    Dim Unique() As Variant ' array that holds the unique items\n    Dim Element As Variant\n    Dim i As Integer\n    Dim FoundMatch As Boolean\n'   If 2nd argument is missing, assign default value\n    If IsMissing(Count) Then Count = True\n'   Counter for number of unique elements\n    NumUnique = 0\n'   Loop thru the input array\n    For Each Element In ArrayIn\n        FoundMatch = False\n'       Has item been added yet?\n        For i = 1 To NumUnique\n            If Element = Unique(i) Then\n                FoundMatch = True\n                Exit For '(exit loop)\n            End If\n        Next i\nAddItem:\n'       If not in list, add the item to unique list\n        If Not FoundMatch And Not IsEmpty(Element) Then\n            NumUnique = NumUnique + 1\n            ReDim Preserve Unique(NumUnique)\n            Unique(NumUnique) = Element\n        End If\n    Next Element\n'   Assign a value to the function\n    If Count Then UniqueItems = NumUnique Else UniqueItems = Unique\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "shell", "excel"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 4761721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f89b2605c721e926607d6ba63d2269b?s=128&d=identicon&r=PG&f=1", "display_name": "runswmily", "link": "https://stackoverflow.com/users/4761721/runswmily"}, "edited": false, "score": 0, "creation_date": 1428543796, "post_id": 29508938, "comment_id": 47210709, "body": "Hi Tony, thanks for that. That&#39;s how i&#39;m currently doing it, the macro saves the dump in a text file and then extracts the data from the text file all in the one hit. However I&#39;m more leaning towards a solution that doesn&#39;t require the dump to be stored in a text file."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 41, "user_id": 4761721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f89b2605c721e926607d6ba63d2269b?s=128&d=identicon&r=PG&f=1", "display_name": "runswmily", "link": "https://stackoverflow.com/users/4761721/runswmily"}, "edited": false, "score": 0, "creation_date": 1428577701, "post_id": 29508938, "comment_id": 47225892, "body": "@runswmily.  I have added a purely VBA solution so you can consider if this is closer to what you seek."}], "tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 0, "last_activity_date": 1442504295, "last_edit_date": 1442504295, "creation_date": 1428479570, "answer_id": 29508938, "question_id": 29505486, "link": "https://stackoverflow.com/questions/29505486/piping-the-output-of-a-shell-command-executed-in-vba-to-a-specific-shell/29508938#29508938", "title": "Piping the output of a Shell Command executed in VBA to a Specific Shell", "body": "<p>One approach would be to amend the <code>Call Shell</code> to:  </p>\n\n  \n\n<pre class=\"lang-vb prettyprint-override\"><code>Call Shell(\"cmd.exe /S /K\" &amp; \"dir /s /b directoryPath &gt;C:\\MyData\\dir.txt\", vbNormalFocus)\n</code></pre>\n\n<p>This would create a text file in folder \"C:\\MyData\" (replace by folder of your choice) containing what would have gone to the console.  You could then open the text file and extract its contents.</p>\n\n<p><strong>VBA solution added in response to comment</strong></p>\n\n<p>If you want a VBA solution, you have two choices: function <code>Dir$</code> and <code>File Scripting Objects</code>.</p>\n\n<p>Function <code>Dir$</code> is the older functionality.  It offers file specifications with wildcards but otherwise offers less functionality than <code>File Scripting Objects</code>.  I have decided to provide a <code>File Scripting Objects</code> solution because I almost always find it the more useful.</p>\n\n<p>I believe the comments in the code below adequately explain what I am doing but do not explain the VBA statements I use.  Once you know a statement exists it is easy to look it up.  Ask questions if necessary but the more you can discover for yourself, the faster you will develop your knowledge and skills.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>' The subroutine ListFiles needs a reference to \"Microsoft Scripting Runtime\".\n' Within VBE, click Tools then References. If \"Microsoft Scripting Runtime\" is\n' not near the top and ticked, scroll down and click box to its left.\nOption Explicit\nSub TestListFiles()\n\n  With Worksheets(\"Sheet1\")\n    .Range(\"C1\").Value = \"Folder\"\n    .Range(\"D1\").Value = \"File\"\n    .Range(\"E1\").Value = \"Attributes\"\n    .Range(\"F1\").Value = \"Last modified\"\n    .Range(\"C1:F1\").Font.Bold = True\n  End With\n\n  ' #### Replace parameters with ones appropriate for your system\n  ' #### if you want to use this test routine.\n  Call ListFiles(\"Sheet1\", 2, 3, \"C:\\DataArea\\NHSIC\")\n\nEnd Sub\nSub ListFiles(ByVal WshtName As String, ByVal RowTop As Long, _\n              ByVal ColLeft As Long, ByVal FolderRootName As String)\n\n  ' Writes a list of all files within the folder named FolderRootName,\n  ' and its subfolders, starting at Worksheets(WshtName).Cells(RowTop, ColLeft)\n\n  Dim FileObj As File\n  Dim FileSysObj As FileSystemObject\n  Dim FolderNameCrnt As String\n  Dim FolderObj As Folder\n  Dim FolderSubObj As Folder\n  Dim FoldersToCheck As New Collection\n  Dim RowCrnt As Long\n  Dim Wsht As Worksheet\n\n  Application.ScreenUpdating = False\n  Set Wsht = Worksheets(WshtName)\n  RowCrnt = RowTop\n\n  Set FileSysObj = CreateObject(\"Scripting.FileSystemObject\")\n\n  ' Prime FoldersToCheck with the root folder\n  FoldersToCheck.Add FolderRootName\n\n  Do While FoldersToCheck.Count &gt; 0\n\n    ' Extract and delete first folder name in FoldersToCheck\n    FolderNameCrnt = FoldersToCheck(1)\n    FoldersToCheck.Remove (1)\n\n    ' Get folder object for first name in FoldersToCheck\n    Set FolderObj = FileSysObj.GetFolder(FolderNameCrnt)\n\n    ' Add any subfolders of current folder to FoldersToCheck ready to be\n    \u2018 checked by a later repeat of this loop.\n    For Each FolderSubObj In FolderObj.SubFolders\n      FoldersToCheck.Add FolderNameCrnt &amp; \"\\\" &amp; FolderSubObj.Name\n    Next\n\n    ' Output details of any files within current folder. I have output\n    ' more details than requested to give a hint of what is available.\n    For Each FileObj In FolderObj.Files\n      With Wsht\n        .Cells(RowCrnt, ColLeft).Value = FolderNameCrnt\n        .Cells(RowCrnt, ColLeft + 1).Value = FileObj.Name\n        .Cells(RowCrnt, ColLeft + 2).Value = AttrNumToNames(FileObj.Attributes)\n        With .Cells(RowCrnt, ColLeft + 3)\n          .Value = FileObj.DateLastModified\n          .NumberFormat = \"d mmm yyyy\"\n        End With\n      End With\n      RowCrnt = RowCrnt + 1\n    Next\n    DoEvents    ' Allows code to be interrupted if necessary\n  Loop\n\n  Wsht.Columns.AutoFit\n\n  Application.ScreenUpdating = True\n\nEnd Sub\nFunction AttrNumToNames(ByVal AttrNum As Long) As String\n\n  ' Convert an attribute number into the list of properties it represents\n\n  Dim Names As String\n\n  Names = \"\"\n\n  If AttrNum &gt;= 128 Then\n    Names = \"Compressed \" &amp; Names\n    AttrNum = AttrNum - 128\n  End If\n  If AttrNum &gt;= 64 Then\n    ' Some documentation says this is only for Mac. Other documentation\n    ' implies it is also used with Windows. During my experimentation\n    ' I have not found any shortcut with it set.\n    Names = \"Link \" &amp; Names\n    AttrNum = AttrNum - 64\n  End If\n  If AttrNum &gt;= 32 Then\n    Names = \"ToBeArchived \" &amp; Names\n    AttrNum = AttrNum - 32\n  End If\n  If AttrNum &gt;= 16 Then\n    Names = \"Directory \" &amp; Names\n    AttrNum = AttrNum - 16\n  End If\n  If AttrNum &gt;= 8 Then\n    Names = \"Label \" &amp; Names\n    AttrNum = AttrNum - 8\n  End If\n  If AttrNum &gt;= 4 Then\n    Names = \"System \" &amp; Names\n    AttrNum = AttrNum - 4\n  End If\n  If AttrNum &gt;= 2 Then\n    Names = \"Hidden \" &amp; Names\n    AttrNum = AttrNum - 2\n  End If\n  If AttrNum &gt;= 1 Then\n    Names = \"Read-only \" &amp; Names\n    AttrNum = AttrNum - 1\n  End If\n  If Names = \"\" Then\n    Names = \"None\"\n  End If\n\n  AttrNumToNames = Names\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 4761721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f89b2605c721e926607d6ba63d2269b?s=128&d=identicon&r=PG&f=1", "display_name": "runswmily", "link": "https://stackoverflow.com/users/4761721/runswmily"}, "edited": false, "score": 0, "creation_date": 1428543701, "post_id": 29509003, "comment_id": 47210680, "body": "Hi SO, thanks for that. It worked like a charm. However it seems to be saving the entire directory dump in the one cell. Is there a way to save the dump row by row? Thanks again"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 41, "user_id": 4761721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f89b2605c721e926607d6ba63d2269b?s=128&d=identicon&r=PG&f=1", "display_name": "runswmily", "link": "https://stackoverflow.com/users/4761721/runswmily"}, "edited": false, "score": 2, "creation_date": 1441282657, "post_id": 29509003, "comment_id": 52621601, "body": "Never saw this comment - not sure if still required - you can assign the output to a <code>Variant</code> and use the <code>Split()</code> function with <code>vbCrLf</code> as the delimiter to create an array with all the results, then you can transpose that array into the cells required."}, {"owner": {"reputation": 680, "user_id": 1054120, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/tLsRK.jpg?s=128&g=1", "display_name": "Matt Wenham", "link": "https://stackoverflow.com/users/1054120/matt-wenham"}, "edited": false, "score": 0, "creation_date": 1494951746, "post_id": 29509003, "comment_id": 75041770, "body": "If you want the CMD box to disappear once it has finished running, you&#39;ll need to use <code>Range(&quot;A1&quot;).Value = CreateObject(&quot;WScript.Shell&quot;).Exec(&quot;CMD &#47;S &#47;C dir &#47;s &#47;b directoryPath&quot;).StdOut.ReadAll</code>"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 680, "user_id": 1054120, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/tLsRK.jpg?s=128&g=1", "display_name": "Matt Wenham", "link": "https://stackoverflow.com/users/1054120/matt-wenham"}, "edited": false, "score": 0, "creation_date": 1494951807, "post_id": 29509003, "comment_id": 75041819, "body": "@MattWenham The box will disappear after running anyway, no need to pass the close flag."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 680, "user_id": 1054120, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/tLsRK.jpg?s=128&g=1", "display_name": "Matt Wenham", "link": "https://stackoverflow.com/users/1054120/matt-wenham"}, "edited": false, "score": 0, "creation_date": 1495026387, "post_id": 29509003, "comment_id": 75077774, "body": "@MattWenham were you using the command on a large directory with many files?"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 9, "last_activity_date": 1502178031, "last_edit_date": 1502178031, "creation_date": 1428479779, "answer_id": 29509003, "question_id": 29505486, "link": "https://stackoverflow.com/questions/29505486/piping-the-output-of-a-shell-command-executed-in-vba-to-a-specific-shell/29509003#29509003", "title": "Piping the output of a Shell Command executed in VBA to a Specific Shell", "body": "<p>You can create the WScript.Shell object and read the StdOut directly:  </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub SO()\n\nRange(\"A1\").Value = CreateObject(\"WScript.Shell\").Exec(\"CMD /S /C dir /s /b directoryPath\").StdOut.ReadAll\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 4761721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f89b2605c721e926607d6ba63d2269b?s=128&d=identicon&r=PG&f=1", "display_name": "runswmily", "link": "https://stackoverflow.com/users/4761721/runswmily"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14486, "favorite_count": 2, "answer_count": 2, "score": 4, "last_activity_date": 1502178031, "creation_date": 1428464308, "last_edit_date": 1490693313, "question_id": 29505486, "link": "https://stackoverflow.com/questions/29505486/piping-the-output-of-a-shell-command-executed-in-vba-to-a-specific-shell", "title": "Piping the output of a Shell Command executed in VBA to a Specific Shell", "body": "<p>I am still very very new to VBA and started learning it a couple days ago. Now I am trying to create a Macro to execute a shell command and pipe the output to a specific cell in a specific worksheet. What I am trying to accomplish is to get a text dump of the directory structure into a worksheet. Below is the code i have so far.</p>\n\n  \n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub CopyList()\n\n    Call Shell(\"cmd.exe /S /K\" &amp; \"dir /s /b directoryPath\", vbNormalFocus)\n\nEnd Sub\n</code></pre>\n\n<p>Executing this macro brings up a command prompt and dumps the directory structure inside the cmd window. I was wondering how I could pipe this to a worksheet. Your help would be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 172, "user_id": 2635143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94adfabac995bdc7dfa214e14a7836c3?s=128&d=identicon&r=PG", "display_name": "tpkaplan", "link": "https://stackoverflow.com/users/2635143/tpkaplan"}, "is_accepted": false, "score": 0, "last_activity_date": 1428465909, "creation_date": 1428465909, "answer_id": 29505737, "question_id": 29504928, "link": "https://stackoverflow.com/questions/29504928/insert-new-row-in-the-same-place-in-two-sheets-copy-formulas-from-above/29505737#29505737", "title": "Insert new row in the same place in two sheets &gt; copy formulas from above", "body": "<p>Click on Summary tab\nShift-click on Annuals tab\nInsert the row.</p>\n\n<p>That's it! It will insert a blank row on both sheets.</p>\n\n<p>If you want to copy data from an existing row into the newly created row (as in your macro), select both tabs as above, highlight a row, copy it, and paste it into the new row. You will see that the copy command was applied to both sheets, just as if you had done the copy command  on each sheet.</p>\n"}], "owner": {"reputation": 1, "user_id": 4761539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6b91d817392848514da1361abb4577d?s=128&d=identicon&r=PG&f=1", "display_name": "Kirra Lynam", "link": "https://stackoverflow.com/users/4761539/kirra-lynam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 522, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1428496739, "creation_date": 1428460532, "last_edit_date": 1592644375, "question_id": 29504928, "link": "https://stackoverflow.com/questions/29504928/insert-new-row-in-the-same-place-in-two-sheets-copy-formulas-from-above", "title": "Insert new row in the same place in two sheets &gt; copy formulas from above", "body": "<p>I've created a tracking document for my workplace, but my limited knowledge of Excel has only taken me so far. Hoping there's someone out there who enjoys cleaning up messy workbooks...</p>\n<p>I have a document with two connected worksheets: 'Annuals', covering a lot of detail about the forms I'm designing; and 'Summary', which is really intended for management use. All the information in the 'Summary' page is a cell reference to 'Annuals' and the 'Summary' page is normally password protected so that the formulas can't be overwritten. You can download a dummy copy of the larger document I'm hoping to implement: <a href=\"https://dl.dropboxusercontent.com/u/29546718/Tracking%20Document%20Help.xls\" rel=\"nofollow noreferrer\">Dropbox Link</a> We use Excel 2010 at work, although the attached document was last edited in OpenOffice Calc.</p>\n<p>The basic function of this document is to present varying degrees of information per worksheet, with most raw information being manually provided. I would like it to be dynamic enough that the user doesn't need to understand the importance of keeping cell references - they can just press a button to add their task to the list, and the program will populate the rest behind the scenes.</p>\n<p>Aside from the terrible way that I've visually indicated the row label &quot;hierarchy&quot; in column C, I'm also having issues when someone wishes to insert a new row in the 'Annuals' page; I have not found an effective way to insert a row on the 'Summary' page at the same time while maintaining dynamic formulas and formatting. It has been difficult to write a macro to do this because I only want certain cells referenced on the 'Summary' page (although I'm 100% sure there's a way to do this).</p>\n<p>This is my attempt:</p>\n<pre><code>Public sAddress As String\n\nSub AddRow()\nR = ActiveCell.Row\nActiveCell.Offset(-1).EntireRow.Insert Shift:=xlDown\nRange(&quot;E&quot; &amp; R &amp; &quot;:G&quot; &amp; R).Copy Destination:=Range(&quot;E&quot; &amp; R + 1 &amp; &quot;:G&quot; &amp; R + 1)\nRange(&quot;T&quot; &amp; R).Copy Destination:=Range(&quot;T&quot; &amp; R + 1)\nEnd Sub\n\nSub DeleteRow()\nActiveCell.EntireRow.Delete\nEnd Sub\n\nSub AddSummary()\nOn Error Resume Next\nWorksheets(&quot;Summary&quot;).Activate\nIf sAddress &gt; &quot;&quot; Then Sh.Range(sAddress).Select\nR = ActiveCell.Row\nActiveCell.Offset(-1).EntireRow.Insert Shift:=xlDown\nRange(&quot;E&quot; &amp; R &amp; &quot;:G&quot; &amp; R).Copy Destination:=Range(&quot;E&quot; &amp; R + 1 &amp; &quot;:G&quot; &amp; R + 1)\nRange(&quot;T&quot; &amp; R).Copy Destination:=Range(&quot;T&quot; &amp; R + 1)\nEnd Sub\n\nSub Variab()\nsAddress = ActiveCell.Address\nEnd Sub\n\nSub Everything()\nCall AddRow\nCall Variab\nCall AddSummary\nEnd Sub\n</code></pre>\n<p>Maybe a pivot table could be implemented? However, I have no idea how to make a pivot table actually work, let alone make it user-friendly or pretty. I tried - and failed - to make a pivot table that I could reference in the Summary page and hide from other users, but I didn't get very far.</p>\n<p>I know that you're probably shuddering at my workbook, but if you can think of better methodology behind the information I'm trying to track (amongst many users, with varying degrees of computer literacy) then <em>please</em> let me know!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1428459969, "post_id": 29504774, "comment_id": 47166928, "body": "a) Be sure to include call to <code>application.enableevents = false</code> and then <code>application.enableevents = true</code> when processing is finished or the Worksheet_Change will try to run on top of itself. b) you are going to have to pass the target.row number into <code>MyMacro</code> so it knows what J &amp; K to process. Cannot suggest anything without seeing at least part of MyMacro."}, {"owner": {"reputation": 53, "user_id": 4752811, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/bb30e5828d9bd86a2c64cb631d703e91?s=128&d=identicon&r=PG&f=1", "display_name": "Karl D", "link": "https://stackoverflow.com/users/4752811/karl-d"}, "edited": false, "score": 0, "creation_date": 1428460858, "post_id": 29504774, "comment_id": 47167150, "body": "This is the macro I want to call by entering a value on any cell under column B  Sub Settime() If ActiveCell = &quot;&quot; Then MsgBox &quot;Ingrese El account Number&quot; Else Range(&quot;J&quot; &amp; ActiveCell.Row &amp; &quot;:K&quot; &amp; ActiveCell.Row).Select Selection.Copy Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False Application.CutCopyMode = False End If End Sub"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1428468472, "post_id": 29504774, "comment_id": 47169197, "body": "See <a href=\"http://tinyurl.com/kdxb7le\" rel=\"nofollow noreferrer\">Why Not Images of Code and Sample Data</a>"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 4752811, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/bb30e5828d9bd86a2c64cb631d703e91?s=128&d=identicon&r=PG&f=1", "display_name": "Karl D", "link": "https://stackoverflow.com/users/4752811/karl-d"}, "edited": false, "score": 0, "creation_date": 1428462129, "post_id": 29504960, "comment_id": 47167485, "body": "Im not sure why is not working how can I give you the Mymacro code without pasting it here ? because when I paste it here it looks to Messy and my Macro name is Sub Settime()"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 53, "user_id": 4752811, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/bb30e5828d9bd86a2c64cb631d703e91?s=128&d=identicon&r=PG&f=1", "display_name": "Karl D", "link": "https://stackoverflow.com/users/4752811/karl-d"}, "edited": false, "score": 1, "creation_date": 1428462271, "post_id": 29504960, "comment_id": 47167521, "body": "@KarlD - Go back and <a href=\"http://stackoverflow.com/posts/29504774/edit\">Edit</a> your question to include the code you want to run. The code as provided works at resolving the formulas in columns J and K to their values on the row(s) that change in column B."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1428461800, "last_edit_date": 1428461800, "creation_date": 1428460787, "answer_id": 29504960, "question_id": 29504774, "link": "https://stackoverflow.com/questions/29504774/formula-to-value-when-data-entered-in-another-cell/29504960#29504960", "title": "Formula to Value when data entered in another cell", "body": "<p>Here is some fairly standard <code>Worksheet_Change</code> framework to get you started.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Columns(\"B\")) Is Nothing Then\n        On Error GoTo Safe_Exit\n        Application.EnableEvents = False\n        Dim rng As Range\n        For Each rng In Intersect(Target, Columns(\"B\"))\n            If rng.Row &gt; 2 Then ' your sample code seemed to suggest that this should start on row 3 and higher\n                Call Settime(rng.Row)\n            End If\n        Next rng\n    End If\nSafe_Exit:\n    Application.EnableEvents = True\nEnd Sub\n\nSub Settime(rw as long)\n    If range(\"B\" &amp; rw) = \"\" Then\n        MsgBox \"Ingrese El account Number\" \n    Else\n        Range(\"J\" &amp; rw &amp; \":K\" &amp; rw) = Range(\"J\" &amp; rw &amp; \":K\" &amp; rw).value\n    End If \nEnd Sub\n</code></pre>\n\n<p>I don't know if pasting a number of values into column B should be handled, but the above does take care of each value added/changed/deleted in turn. As mentioned in comments, you need to pass the target row into your macro so it knows what row to process in columns J and K. Whenever possible, try not to rely upon <code>ActiveCell</code> or <code>.Select</code> to determine what cell or range of cells is going to receive the processing.</p>\n"}], "owner": {"reputation": 53, "user_id": 4752811, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/bb30e5828d9bd86a2c64cb631d703e91?s=128&d=identicon&r=PG&f=1", "display_name": "Karl D", "link": "https://stackoverflow.com/users/4752811/karl-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1429321295, "creation_date": 1428459574, "last_edit_date": 1531164843, "question_id": 29504774, "link": "https://stackoverflow.com/questions/29504774/formula-to-value-when-data-entered-in-another-cell", "title": "Formula to Value when data entered in another cell", "body": "<p>If I put a value on any cell under column B the macro will copy and paste as values the information on cell j &amp; k that belongs to the same row as the active cell</p>\n\n<p>for example if I type a value on b 10 and then hit the macro button j 10 &amp;  k 10 change from formula to values.</p>\n\n<p>I really want to do this automatically every time I enter a value on any cell under column B instead of hitting the button.</p>\n\n<p>Please see below the current code for the macro I have</p>\n\n<p><a href=\"http://imageshack.com/f/exgUKSP0p\" rel=\"nofollow\">http://imageshack.com/f/exgUKSP0p</a></p>\n"}, {"tags": ["class", "excel", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2941651"}, "is_accepted": true, "score": 0, "last_activity_date": 1428459334, "creation_date": 1428459334, "answer_id": 29504736, "question_id": 29504637, "link": "https://stackoverflow.com/questions/29504637/what-is-the-proper-syntax-for-using-an-object-as-a-class-property-in-excel-vba/29504736#29504736", "title": "What is the proper syntax for using an object as a class property in excel vba?", "body": "<p>Please try to add in your <code>clsAgent</code> module file the following line:</p>\n\n<p><code>Dim pAgentSheet As Worksheet</code></p>\n\n<p>since the properties you have created ought to reference an existing <code>pAgentSheet</code> field of the <code>clsAgent</code> module.</p>\n\n<p>Please try also the modified test file:</p>\n\n<pre><code>Sub test_agent_class()\n\n    Dim agent1 As clsAgent\n    Set agent1 = New clsAgent\n\n    Set agent1.AgentSheet = Worksheets(\"agentsFullOutput.csv\")\n    Debug.Print agent1.AgentSheet.Name\n\nEnd Sub\n</code></pre>\n\n<p>I'm not 100% sure but it looked like you were referencing a variable/property<code>AgentSheetName</code> which didn't exist in the <code>clsAgent</code> class module.</p>\n\n<p>I hope it helps at least slightly.</p>\n"}], "owner": {"reputation": 6397, "user_id": 1472743, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f205382e9fa00ee4bdf653ec92a34679?s=128&d=identicon&r=PG", "display_name": "dwstein", "link": "https://stackoverflow.com/users/1472743/dwstein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 29504736, "answer_count": 1, "score": 0, "last_activity_date": 1428459334, "creation_date": 1428458719, "last_edit_date": 1531164843, "question_id": 29504637, "link": "https://stackoverflow.com/questions/29504637/what-is-the-proper-syntax-for-using-an-object-as-a-class-property-in-excel-vba", "title": "What is the proper syntax for using an object as a class property in excel vba?", "body": "<p>I'm trying to use the worksheet object as a property in a vba class module.  Hers' what I have in a a class module called <code>clsAgent</code>:</p>\n\n<pre><code>Public Property Get AgentSheet() As Worksheet\n    Set AgentSheet = pAgentSheet\nEnd Property\n\n' error thrown on next two lines \nPublic Property Set AgentSheet(AgentSheet As Worksheet)\n    Set pAgentSheet = AgentSheet\nEnd Property\n</code></pre>\n\n<p>When I use the the following code I get a `compile error: Variable not defined\" thrown in the class module:</p>\n\n<pre><code>Sub test_agent_class()\nDim agent1 As clsAgent\nSet agent1 = New clsAgent\n\nagent1.AgentSheetName = \"agentsFullOutput.csv\"\n\nSet agent1.AgentSheet = Worksheets(agent1.AgentSheetName)\nDebug.Print agent1.AgentSheet.Name\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "range", "cell"], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 3485595, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c1b8a2f2fbf90de10e67ff24713503f0?s=128&d=identicon&r=PG&f=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/3485595/drew"}, "edited": false, "score": 0, "creation_date": 1428499375, "post_id": 29504155, "comment_id": 47187085, "body": "Thank you very much. Silly mistake on my part"}], "tags": [], "owner": {"reputation": 2834, "user_id": 3230346, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Nc4ve.png?s=128&g=1", "display_name": "useR", "link": "https://stackoverflow.com/users/3230346/user"}, "is_accepted": true, "score": 2, "last_activity_date": 1428455174, "creation_date": 1428455174, "answer_id": 29504155, "question_id": 29504119, "link": "https://stackoverflow.com/questions/29504119/cant-set-range-variable-to-activecell-offset/29504155#29504155", "title": "Can&#39;t set range variable to ActiveCell.Offset", "body": "<p>You can delete the range() and simply, as </p>\n\n<pre><code>Dim rngColor as Range\nSet rngColor = ActiveCell.Offset(0, 1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 0, "last_activity_date": 1428459041, "last_edit_date": 1495541158, "creation_date": 1428458209, "answer_id": 29504551, "question_id": 29504119, "link": "https://stackoverflow.com/questions/29504119/cant-set-range-variable-to-activecell-offset/29504551#29504551", "title": "Can&#39;t set range variable to ActiveCell.Offset", "body": "<p><code>As far as I know, this should be a working syntax</code> Not quite.<br>\nAccording this <a href=\"https://msdn.microsoft.com/en-us/library/bb178282(v=office.12).aspx\" rel=\"nofollow noreferrer\">MSDN link</a>, there are various ways to work on Range.</p>\n\n<ol>\n<li><p><em>expression</em>.<strong>Range</strong>(arg) - <code>arg</code> is in the form of string</p>\n\n<pre><code>Set rngColor = Range(Activecell.Offset(0, 1).Address) ' correct way\n</code></pre></li>\n<li><p><em>expression</em>.<strong>Range</strong>(<em>cells(1)</em>,<em>cells(2))</em> - <code>cells(1)</code> and <code>cells(2)</code> can be objects</p>\n\n<pre><code>With Activecell\n    Set rngColor = Range(.Offset(0, 1), .Offset(0, 1)) ' using Activecell object\nEnd With\n</code></pre></li>\n</ol>\n\n<p>You are trying to use No.1 syntax above which will not accept <code>Objects</code> as argument.<br>\nIf you want to pass <code>Activecell</code> as is, you should use No.2 syntax.<br>\nBut still, to do what you want, <a href=\"https://stackoverflow.com/a/29504155/2685412\">user's answer is the best way</a>.</p>\n"}], "owner": {"reputation": 167, "user_id": 3485595, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c1b8a2f2fbf90de10e67ff24713503f0?s=128&d=identicon&r=PG&f=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/3485595/drew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1541, "favorite_count": 1, "accepted_answer_id": 29504155, "answer_count": 2, "score": 1, "last_activity_date": 1428459041, "creation_date": 1428454908, "last_edit_date": 1428458626, "question_id": 29504119, "link": "https://stackoverflow.com/questions/29504119/cant-set-range-variable-to-activecell-offset", "title": "Can&#39;t set range variable to ActiveCell.Offset", "body": "<p>As far as I know, this should be a working syntax. However, when I run this, I get:</p>\n\n<blockquote>\n  <p>Method 'Range' of object '_Global' failed</p>\n</blockquote>\n\n<pre><code>Dim rngColor as Range\nSet rngColor = Range(ActiveCell.Offset(0, 1))\n</code></pre>\n\n<p>Any idea what I am doing wrong?\nThanks!</p>\n"}, {"tags": ["vba", "excel", "pdf", "merge", "pdf-generation"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 4709881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9ebab76a82e3fcdf95703addec6eabe?s=128&d=identicon&r=PG&f=1", "display_name": "Corey", "link": "https://stackoverflow.com/users/4709881/corey"}, "edited": false, "score": 0, "creation_date": 1429034748, "post_id": 29603786, "comment_id": 47411032, "body": "I am hoping to find files within a set, static directory and then merge using their filenames.  I would have a variable string and a static string for each of two files, and a static file and directory for the third.  I suspect it would be something like: merge &quot;*[static RootDoc append].pdf&quot; with &quot;*[static DefDoc append].pdf&quot; by adding *[static RootDoc append].pdf&quot; after page 0 (a cover page)"}, {"owner": {"reputation": 41, "user_id": 4709881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9ebab76a82e3fcdf95703addec6eabe?s=128&d=identicon&r=PG&f=1", "display_name": "Corey", "link": "https://stackoverflow.com/users/4709881/corey"}, "edited": false, "score": 0, "creation_date": 1429035069, "post_id": 29603786, "comment_id": 47411196, "body": "The reason I&#39;m thinking in VBA is that there are other set scripts I have that run on the source excel docs to convert to pdf."}, {"owner": {"reputation": 2604, "user_id": 712093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acf65086d568bb4097bac8864e9e0d38?s=128&d=identicon&r=PG", "display_name": "Eugene", "link": "https://stackoverflow.com/users/712093/eugene"}, "reply_to_user": {"reputation": 41, "user_id": 4709881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9ebab76a82e3fcdf95703addec6eabe?s=128&d=identicon&r=PG&f=1", "display_name": "Corey", "link": "https://stackoverflow.com/users/4709881/corey"}, "edited": false, "score": 0, "creation_date": 1429037924, "post_id": 29603786, "comment_id": 47412871, "body": "It is not quite clear to me but if seems like you should first 1) find all PDF files in the given folder (like this <a href=\"http://www.mrexcel.com/forum/excel-questions/396659-visual-basic-applications-macro-list-all-tif-pdf-files-folder-including-subfolders.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a> ) and then 2) process each file in the folder and merge with 2 others?"}, {"owner": {"reputation": 41, "user_id": 4709881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9ebab76a82e3fcdf95703addec6eabe?s=128&d=identicon&r=PG&f=1", "display_name": "Corey", "link": "https://stackoverflow.com/users/4709881/corey"}, "edited": false, "score": 0, "creation_date": 1429125018, "post_id": 29603786, "comment_id": 47457134, "body": "I am able to generate a list of all filenames and directories to be used in a set of 3 columns.  I am thinking of using a For Each loop for the range of rows and then column offsets to open each file.  I am still unclear on how to word the merge operation."}], "tags": [], "owner": {"reputation": 2604, "user_id": 712093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acf65086d568bb4097bac8864e9e0d38?s=128&d=identicon&r=PG", "display_name": "Eugene", "link": "https://stackoverflow.com/users/712093/eugene"}, "is_accepted": false, "score": 1, "last_activity_date": 1428923064, "last_edit_date": 1495542217, "creation_date": 1428923064, "answer_id": 29603786, "question_id": 29504053, "link": "https://stackoverflow.com/questions/29504053/open-and-merge-multiple-pdf-files-using-vba/29603786#29603786", "title": "Open and Merge multiple PDF files using VBA", "body": "<p>Is this question about finding pdf files to merge using their filenames or about merging PDF files using Acrobat API through VBA? </p>\n\n<p>In case you need to find the best workflow then I suppose you should find all files in the folder and find the find the \"ticker\" filename using regular expressions (see this awesome answer about <a href=\"https://stackoverflow.com/a/22542835/712093\">regular expressions in VBA</a> and <a href=\"http://www.macrostash.com/2011/10/08/simple-regular-expression-tutorial-for-excel-vba/\" rel=\"nofollow noreferrer\">this tutorial</a> on matching filenames using regular expressions in VBA).</p>\n\n<p>In case you are looking for a proper way to use Acrobat API to merge pages from one pdf documents into another one then you should check the <a href=\"http://help.adobe.com/livedocs/acrobat_sdk/9/Acrobat9_HTMLHelp/wwhelp/wwhimpl/js/html/wwhelp.htm?&amp;accessible=true\" rel=\"nofollow noreferrer\">online documentation for Acrobat API</a> (see <em>Javascript / Javascript for Acrobat... / Javascript API/ Doc / InsertPages</em> section) and <a href=\"https://groups.google.com/forum/#!topic/adobe.acrobat.windows/GC2vVVPvUOk\" rel=\"nofollow noreferrer\">this</a> sample VB code.</p>\n"}], "owner": {"reputation": 41, "user_id": 4709881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9ebab76a82e3fcdf95703addec6eabe?s=128&d=identicon&r=PG&f=1", "display_name": "Corey", "link": "https://stackoverflow.com/users/4709881/corey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13258, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1445896895, "creation_date": 1428454415, "question_id": 29504053, "link": "https://stackoverflow.com/questions/29504053/open-and-merge-multiple-pdf-files-using-vba", "title": "Open and Merge multiple PDF files using VBA", "body": "<p>I am trying to open three pdf files in order to merge them. We create a series of files on a monthly basis that are all identified by \"ticker\".</p>\n\n<p>I have three source files:</p>\n\n<p>RootDoc = Root file, produced monthly, variable filename: \"[variable ticker] + [static RootDoc append].pdf\"</p>\n\n<p>DefDoc = Static file, variable filename, \"[variable ticker] + [static DefDoc append].pdf\"</p>\n\n<p>NotesDoc = One file, does not change, must be included in all docs.</p>\n\n<p>I'm stuck on how to merge appropriately under the following conditions:</p>\n\n<p>1) The number of ticker-labeled files in the folder each month will vary.</p>\n\n<p>2) The RootDoc and DefDoc of the same ticker must be paired together as they contain ticker-specific information. The tickers will match on both files, but will vary in character length from one set of files to the next.</p>\n\n<p>3) I have a footer format saved in Adobe that must be applied to all docs. (this is not necessary but would be nice to have, I can do this outside of VBA if necessary)</p>\n\n<p>Here's what I have so far, with notations commented out for clarity:</p>\n\n<pre><code>With Application\n    .DisplayAlerts = False\n    .Calculation = xlCalculationManual\n    .ScreenUpdating = False\nEnd With\n\nDim Filename, Pathname, PRODname, Defname As String\nDim RootDoc, NotesDoc, DefDoc As AcroPDDoc\nDim stp1, stp2, stp3, mergefile As Variant\n\nPathname = \"H:\\apps\\xp\\Desktop\\PROD CHECK\\Expanded LT\"\n'PRODname = \"*[static RootDoc append].pdf\"\nFilename = Dir(Pathname &amp; \"\\\" &amp; PRODname)\n'Defname = \"*[static DefDoc append].pdf\"\n\nSet RootDoc = CreateObject(\"AcroExch.PDDoc\")\nSet NotesDoc = CreateObject(\"AcroExch.PDDoc\")\nSet DefDoc = CreateObject(\"AcroExch.PDDoc\")\n\n'stp1 = NotesDoc.Open(\"[unchanging file name and location]\")\n\nDo While Filename &lt;&gt; \"\"\n    'stp2 = RootDoc.Open(Pathname &amp; \"\\\" &amp; Filename)\n    'stp3 = DefDoc.Open(\"[location]\" &amp; \"\\\" &amp; Defname)\n        'mergefile = RootDoc.InsertPages([I want to insert all of DefDoc into RootDoc after page 0])\n        'mergefile = RootDoc.InsertPages([I want to insert all of NotesDoc after the last page of RootDoc])\n        DefDoc.Close SaveChanges:=False\n    'RootDoc = [Apply Saved Footer]\n    RootDoc.Close SaveChanges:=True\n    Filename = Dir()\nLoop\n\nWith Application\n    .DisplayAlerts = True\n    .Calculation = xlCalculationAutomatic\n    .ScreenUpdating = True\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1428451665, "post_id": 29503567, "comment_id": 47164886, "body": "Doesn&#39;t the commented out line do that? Comment out the activeworkbooks one and uncomment the other one."}, {"owner": {"reputation": 23, "user_id": 3241572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e73461ec0eb04d3d31335d1bb7f1c458?s=128&d=identicon&r=PG", "display_name": "FusionOpz", "link": "https://stackoverflow.com/users/3241572/fusionopz"}, "reply_to_user": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1428453351, "post_id": 29503567, "comment_id": 47165349, "body": "It throws a Runtime Error &#39;9&#39;: Subscript out of range. :/"}], "answers": [{"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1428454723, "creation_date": 1428454723, "answer_id": 29504099, "question_id": 29503567, "link": "https://stackoverflow.com/questions/29503567/target-one-specific-workbook-among-multiple-workbooks/29504099#29504099", "title": "Target one specific workbook among multiple workbooks", "body": "<p>You might need to put the sheet too like:</p>\n\n<pre><code>workbooks(\"Requests\").Sheets(\"Sheetname\").UpdateLink(Workbooks(\"Requests\").Sheets(\"Sheetname\").LinkSources)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 3241572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e73461ec0eb04d3d31335d1bb7f1c458?s=128&d=identicon&r=PG", "display_name": "FusionOpz", "link": "https://stackoverflow.com/users/3241572/fusionopz"}, "edited": false, "score": 1, "creation_date": 1428466850, "post_id": 29504116, "comment_id": 47168698, "body": "Tried that one, thats what the comment following that line is :)"}, {"owner": {"reputation": 172, "user_id": 2635143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94adfabac995bdc7dfa214e14a7836c3?s=128&d=identicon&r=PG", "display_name": "tpkaplan", "link": "https://stackoverflow.com/users/2635143/tpkaplan"}, "reply_to_user": {"reputation": 23, "user_id": 3241572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e73461ec0eb04d3d31335d1bb7f1c458?s=128&d=identicon&r=PG", "display_name": "FusionOpz", "link": "https://stackoverflow.com/users/3241572/fusionopz"}, "edited": false, "score": 0, "creation_date": 1428596309, "post_id": 29504116, "comment_id": 47239238, "body": "nameOfworkbook must be the actual filename <i>including extension</i>.   Try \\n <code>Workbooks(&quot;Requests.xlsb&quot;).UpdateLink (Workbooks(&quot;Requests.xlsb&quot;).LinkSources)</code>.  If the active directory is different than the directory in which Requests.xlsb is saved, then you must use <code>&#39;Workbooks(&quot;C:\\Users\\yourID\\Documents\\Requests.xlsb&quot;).Update&zwnj;&#8203;Link (Workbooks(&quot;C:\\Users\\yourID\\Documents\\Requests.xlsb&quot;).LinkSo&zwnj;&#8203;urces)</code>."}, {"owner": {"reputation": 172, "user_id": 2635143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94adfabac995bdc7dfa214e14a7836c3?s=128&d=identicon&r=PG", "display_name": "tpkaplan", "link": "https://stackoverflow.com/users/2635143/tpkaplan"}, "reply_to_user": {"reputation": 23, "user_id": 3241572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e73461ec0eb04d3d31335d1bb7f1c458?s=128&d=identicon&r=PG", "display_name": "FusionOpz", "link": "https://stackoverflow.com/users/3241572/fusionopz"}, "edited": false, "score": 0, "creation_date": 1428682292, "post_id": 29504116, "comment_id": 47281606, "body": "Did the comment about using the file extension help?"}, {"owner": {"reputation": 23, "user_id": 3241572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e73461ec0eb04d3d31335d1bb7f1c458?s=128&d=identicon&r=PG", "display_name": "FusionOpz", "link": "https://stackoverflow.com/users/3241572/fusionopz"}, "edited": false, "score": 0, "creation_date": 1428727569, "post_id": 29504116, "comment_id": 47297323, "body": "Yes, have tried both ways.    A simple solution that I&#39;ve implemented for the short-term whcih suppresses the error is to target &quot;&#39;Requests.xlsm&#39;!Refresh&quot; which seems to work."}], "tags": [], "owner": {"reputation": 172, "user_id": 2635143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94adfabac995bdc7dfa214e14a7836c3?s=128&d=identicon&r=PG", "display_name": "tpkaplan", "link": "https://stackoverflow.com/users/2635143/tpkaplan"}, "is_accepted": false, "score": 0, "last_activity_date": 1428596921, "last_edit_date": 1428596921, "creation_date": 1428454885, "answer_id": 29504116, "question_id": 29503567, "link": "https://stackoverflow.com/questions/29503567/target-one-specific-workbook-among-multiple-workbooks/29504116#29504116", "title": "Target one specific workbook among multiple workbooks", "body": "<p>Your statement <code>ActiveWorkbook.UpdateLink (ActiveWorkbook.LinkSources)</code> updates the link in the \"Active\" Workbook.  That's the workbook that you are currently working on.  When you open a new workbook, the new workbook becomes the active workbook.  </p>\n\n<p>Instead of <code>ActiveWorkbook.UpdateLink (ActiveWorkbook.LinkSources)</code> try this:</p>\n\n<pre><code>Workbooks(\"nameOfWorkbook\").UpdateLink (Workbooks(\"nameOfWorkbook\").LinkSources)\n</code></pre>\n\n<p>Where nameOfWorkbook is the filename of the workbook <em>(i.e., filename, extension and path if necessary)</em> for which you want to update links.  For example, </p>\n\n<pre><code>Workbooks(\"Requests.xlsb\").UpdateLink (Workbooks(\"Requests.xlsb\").LinkSources)\n</code></pre>\n\n<p>If the active directory is different than the directory in which Requests.xlsb is saved, then you must include the full path, like this: </p>\n\n<pre><code>Workbooks(\"C:\\Users\\yourID\\Documents\\Requests.xlsb\").UpdateLink _\n   (Workbooks(\"C:\\Users\\yourID\\Documents\\Requests.xlsb\").LinkSources)\n</code></pre>\n\n<p>or more concisely:</p>\n\n<pre><code>With Workbooks(\"C:\\Users\\yourID\\Documents\\Requests.xlsb\")\n    .UpdateLink .LinkSources\nEnd with\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 3241572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e73461ec0eb04d3d31335d1bb7f1c458?s=128&d=identicon&r=PG", "display_name": "FusionOpz", "link": "https://stackoverflow.com/users/3241572/fusionopz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1428596921, "creation_date": 1428451352, "question_id": 29503567, "link": "https://stackoverflow.com/questions/29503567/target-one-specific-workbook-among-multiple-workbooks", "title": "Target one specific workbook among multiple workbooks", "body": "<p>So I have this code to update links within my excel workbook</p>\n\n<pre><code>Dim alertTime As Date\n\nPublic Sub Refresh()\n'refresh\nActiveWorkbook.UpdateLink (ActiveWorkbook.LinkSources)\n'Workbooks(\"Requests\").UpdateLink (Workbooks(\"Requests\").LinkSources)\nalertTime = Now + TimeValue(\"00:00:05\") 'hh:mm:ss\n    Application.OnTime alertTime, \"Refresh\"\nDebug.Print Now() &amp; \" - Links Updated\"\n\n'MsgBox \"5 Seconds have passed, refreshing\", vbInformation, \"Debug\"\n\nEnd Sub\nSub StopRefresh()\n    Application.OnTime alertTime, \"Refresh\", , False\nEnd Sub\n</code></pre>\n\n<p>The code works, but as soon as I open up another workbook and the refresh triggers and it errors out.  I want to be able to target that specific workbook for the refresh command.</p>\n\n<p>Any help is welcomed.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1428453608, "post_id": 29503561, "comment_id": 47165418, "body": "Do you honestly need both tab and semi-colon as delimiters or was the tab just a leftover because it was pre-selected when you recorded the macro?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1428455039, "creation_date": 1428455039, "answer_id": 29504131, "question_id": 29503561, "link": "https://stackoverflow.com/questions/29503561/run-macro-on-active-cell/29504131#29504131", "title": "Run macro on active cell", "body": "<p>You seem to be using Text to Columns to split the data based on a semi-colon delimiter\u00b9 and only keep the last value. It also seems that you are leaving a blank row after completing the split so I'll give you the option to avoid that.</p>\n\n<pre><code>Sub Macro3()\n' Macro3 Macro\n' Keyboard Shortcut: Option+Cmd+z\n\n    Dim vVALs As Variant\n\n    'option 1 - replace active cell with last split value\n    With Selection.Cells(1, 1)\n        If CBool(Len(.Value)) Then\n            vVALs = Split(.Value, Chr(59)) 'split on a semi-colon\n            .Cells = vVALs(UBound(vVALs))\n        End If\n    End With\n\nEnd Sub\n\nSub Macro4()\n' Macro4 Macro\n' Keyboard Shortcut: Option+Cmd+z\n\n    Dim vVALs As Variant\n\n    'option 2 - put last split value into row below, clear active cell\n    With Selection.Cells(1, 1)\n        If CBool(Len(.Value)) Then\n            vVALs = Split(.Value, Chr(59)) 'split on a semi-colon\n            .Cells.Offset(1, 0) = vVALs(UBound(vVALs))\n            .Cells.ClearContents\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I've used <code>Selection.Cells(1, 1)</code> in case more than a single cell is currently selected. This will take the first cell in any selection set regardless of whether there is only one cell or more than one cell. This could be modified to loop through multiple cells in a selection set is need be but additional error control should be applied to ensure that teh operations are going to be performed without choking on a bad selection of values.</p>\n\n<p>I'm checking that the value in the selected cell has at least one character as anything that is there will split to at least single value even if it does not contain a semi-colon but no value at all will not split.</p>\n\n<p>\u00b9 <sub>there actually is a semi-colon option, you don't need to use <em>Other:</em> to specify it</sub></p>\n"}], "owner": {"reputation": 1, "user_id": 4761189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c371b7a35a4313de57f6c4ac3ac7b54c?s=128&d=identicon&r=PG&f=1", "display_name": "abuhasna", "link": "https://stackoverflow.com/users/4761189/abuhasna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 550, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456518912, "creation_date": 1428451334, "last_edit_date": 1456518912, "question_id": 29503561, "link": "https://stackoverflow.com/questions/29503561/run-macro-on-active-cell", "title": "Run macro on active cell", "body": "<p>I am trying to make this work in the active cell. I want to define the number of cells that it can choose either it can be 6 as below or 20 or any number that I define before running the macro.\"</p>\n\n<pre><code>Sub Macro3()\n'\n' Macro3 Macro\n'\n' Keyboard Shortcut: Option+Cmd+z\n'\nActiveCell.Select\n    Selection.TextToColumns Destination:=ActiveCell, DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n    Semicolon:=False, Comma:=False, Space:=False, Other:=True, OtherChar _\n    :=\";\", FieldInfo:=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1))\nSelection.Offset(0, 6).Select\nSelection.Copy\nActiveCell.Offset(1, 0).Select\nSelection.PasteSpecial Paste:=xlAll, Operation:=xlNone, SkipBlanks:=False _\n    , Transpose:=True\nActiveCell.Offset(-1, 0).Select\nSelection.Offset(0, 6).Select\nSelection.ClearContents\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "edited": false, "score": 0, "creation_date": 1428453095, "post_id": 29503449, "comment_id": 47165275, "body": "Thanks - when I replace the static range with your dynamic range, nothing happens. I left my if statement in place, does that need modified as well?"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "edited": false, "score": 0, "creation_date": 1428453399, "post_id": 29503449, "comment_id": 47165366, "body": "@DanielStrong It runs fine at my end. Do you have a sample data? Can you edit your question and put it there. Also your expected result."}, {"owner": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "edited": false, "score": 0, "creation_date": 1428454769, "post_id": 29503449, "comment_id": 47165730, "body": "edited to show expected outcome. No real sample data as the fields are currently blank. I am leaving the IF statements in my code, i can get it to where it adds the row all the way across, but not one by one as I need."}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 1, "last_activity_date": 1428455708, "last_edit_date": 1428455708, "creation_date": 1428450679, "answer_id": 29503449, "question_id": 29503230, "link": "https://stackoverflow.com/questions/29503230/vba-move-one-cell-right-and-put-current-date-each-time-macro-is-run/29503449#29503449", "title": "VBA Move one cell right and put current date each time macro is run", "body": "<p>This part is static</p>\n\n<pre><code>Set r = Worksheets(\"Project LOE\").Range(\"B5:J5\")\n</code></pre>\n\n<p>So you need to make it dynamic like:</p>\n\n<pre><code>With Worksheets(\"Project LOE\")\n    Dim lc As Long\n    lc = .Cells(5, .Columns.Count).End(xlToLeft).Column + 1\n    Set r = .Cells(5, lc).Resize(, 9)\nEnd With\n</code></pre>\n\n<p><strong>Edit1:</strong> It seems you only need this if I understand what you're trying to do correctly.</p>\n\n<pre><code>With Worksheets(\"Project LOE\")\n    .Cells(5, .Columns.Count).End(xlToLeft).Offset(0, 1) = Date\nEnd With\n</code></pre>\n\n<p>Take note that it will always start populating dates on <code>B5</code>.</p>\n"}], "owner": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2184, "favorite_count": 0, "accepted_answer_id": 29503449, "answer_count": 1, "score": 0, "last_activity_date": 1428455708, "creation_date": 1428449589, "last_edit_date": 1531164843, "question_id": 29503230, "link": "https://stackoverflow.com/questions/29503230/vba-move-one-cell-right-and-put-current-date-each-time-macro-is-run", "title": "VBA Move one cell right and put current date each time macro is run", "body": "<p>I am trying to write a code that when, each week, the macro is run will put the date into the range B5:J5 for 9 weeks. My current code is adding the date I want, to the right, I just cannot figure out how to make it keep moving 1 cell right each time the macro is run. Can someone point me in the right direction? </p>\n\n<pre><code>Sub addDate()\n    Dim r As Range\n    Set r = Worksheets(\"Project LOE\").Range(\"B5:J5\")\n\n    For Each cell In r.Cells\n        If cell.Value &lt;&gt; \"\" Then\n            r.Offset(0, 1).Value = Date\n        End If\n        r.Offset(0, 2).Value = \"\"\n    Next\nEnd Sub\n</code></pre>\n\n<p>** EDIT</p>\n\n<p>Column B5 has yesterdays date, when I run macro I want it to add today (date macro is ran) into the next cell, C5 then D5 and so on. I don't really have \"sample\" data as the fields are blank, below is what I am expecting as far as the dates go</p>\n\n<pre><code>                 B5         C5         D5               E5\n               4/6/2015   4/7/2015  \"next run date\"   \"next run date\"\n</code></pre>\n\n<p>F5 Automation<br>\nSLA<br>\nRunbook<br>\nSecurity Runbook                        </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1428450871, "post_id": 29503064, "comment_id": 47164660, "body": "If that date <i>mm/dd/yyyy</i> or <i>dd/mm/yyyy</i>?"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 4761087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-p128USvLAgs/AAAAAAAAAAI/AAAAAAAAABI/viH6Q7v7aao/photo.jpg?sz=128", "display_name": "Holy Name Scribes", "link": "https://stackoverflow.com/users/4761087/holy-name-scribes"}, "edited": false, "score": 0, "creation_date": 1428600597, "post_id": 29503141, "comment_id": 47241756, "body": "I am looking for a solution that will automatically fill the rows that are not blank so I do not have to drag it down manually."}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1428449078, "creation_date": 1428449078, "answer_id": 29503141, "question_id": 29503064, "link": "https://stackoverflow.com/questions/29503064/how-to-create-a-multiple-column-excel-table-from-single-column-of-string-data-th/29503141#29503141", "title": "How to create a multiple column Excel table from single column of string data that automatically adds rows when new rows are added to data?", "body": "<p>You could wrap your mid formula in an iferror formula and set it to blank if it is an error, then just drag it down a bunch of rows and where there is data it will resolve, where there is not it will simply be blank giving the impression there is nothing there.</p>\n\n<p>If you post your original mid formula I will give you an example, it may be prudent to test the cell rather than using iferror as iferror will trap genuine errors.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1428451822, "creation_date": 1428451822, "answer_id": 29503639, "question_id": 29503064, "link": "https://stackoverflow.com/questions/29503064/how-to-create-a-multiple-column-excel-table-from-single-column-of-string-data-th/29503639#29503639", "title": "How to create a multiple column Excel table from single column of string data that automatically adds rows when new rows are added to data?", "body": "<p>Right-click the Sheet1's name tab and choose <strong>View Code</strong>. When the VBE opens up, paste the following into the code sheet titled something like <em>Book1 - Sheet1 (Code)</em>,</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Columns(1)) Is Nothing Then\n        On Error GoTo Safe_Exit\n        Application.EnableEvents = False\n        Dim rng As Range, str As String, rw As Long\n        For Each rng In Intersect(Target, Columns(1))\n            str = rng.Value\n            If Len(str) &gt;= 18 Then\n                With Sheet2 'using sheet codename in case it gets reordered or renamed\n                    rw = .Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n                    .Cells(rw, 1) = Left(str, 3)\n                    .Cells(rw, 2) = Mid(str, 4, 4)\n                    .Cells(rw, 3) = Mid(str, 8, 2)\n                    .Cells(rw, 4) = DateSerial(Mid(str, 14, 4), Mid(str, 10, 2), Mid(str, 12, 2))\n                    .Cells(rw, 5) = CCur(Mid(str, 18, 99))\n                End With\n            End If\n        Next rng\n    End If\nSafe_Exit:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Tap <kbd>Alt</kbd>+<kbd>Q</kbd> to return to your worksheet. Any values typed or pasted into column A will be stripped and split down to 5 values and populated into Sheet2's first available row in columns A:E. I've set a minimum length of 18 characters before it will attempt processing. This length amounts to a single digit being supplied for the amount off the right-hand end after the year.</p>\n"}], "owner": {"reputation": 19, "user_id": 4761087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-p128USvLAgs/AAAAAAAAAAI/AAAAAAAAABI/viH6Q7v7aao/photo.jpg?sz=128", "display_name": "Holy Name Scribes", "link": "https://stackoverflow.com/users/4761087/holy-name-scribes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 766, "favorite_count": 0, "accepted_answer_id": 29503639, "answer_count": 2, "score": -1, "last_activity_date": 1428451822, "creation_date": 1428448563, "question_id": 29503064, "link": "https://stackoverflow.com/questions/29503064/how-to-create-a-multiple-column-excel-table-from-single-column-of-string-data-th", "title": "How to create a multiple column Excel table from single column of string data that automatically adds rows when new rows are added to data?", "body": "<p>I have multiple rows of single string data on sheet1 that I have used the MID formula to separate into multiple columns on sheet2; if I add new rows of string data to sheet1, how can I automate the same MID formula to be added to each column for each added row?</p>\n\n<p>Here is an example of what these two sheets currently look like:</p>\n\n<p>[sheet1] - string data</p>\n\n<p>1239876010407201520.00</p>\n\n<p>4566543010407201550.00</p>\n\n<p>7893210010407201560.00</p>\n\n<p>sheet2</p>\n\n<p>Number  User    Type    Date    Amount</p>\n\n<p>123 9876    1   4/7/2015     $20.00 </p>\n\n<p>456 6543    1   4/7/2015     $50.00 </p>\n\n<p>789 3210    1   4/7/2015     $60.00 </p>\n\n<p>If I add a row of string data to sheet1 how can I have Excel automatically add a row and apply the same MID formula to each table column on sheet2?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1428448878, "post_id": 29503054, "comment_id": 47164078, "body": "What are the expected results? Is it 1 and 1 or 1 and nothing? I&#39;m unclear on whether the second string&#39;s position within column D should match the first string&#39;s position within column A or if position is unimportant and only existence is the criteria."}, {"owner": {"reputation": 1, "user_id": 4678156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/086607852f5fde793fde070244fefb9e?s=128&d=identicon&r=PG&f=1", "display_name": "Rece", "link": "https://stackoverflow.com/users/4678156/rece"}, "edited": false, "score": 0, "creation_date": 1429023418, "post_id": 29503054, "comment_id": 47404054, "body": "The position is unimportant, only the appearance. It is basically a Boolean &#39;and&#39;. If ColA R1(1,1) has BOX and ColD(1,4) has BAG then Col D R1 (1,5) = 1. No other conditions matter, continue the same search and match throughout the sheet, same columns."}], "answers": [{"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1428450689, "creation_date": 1428450689, "answer_id": 29503453, "question_id": 29503054, "link": "https://stackoverflow.com/questions/29503054/find-partial-text-within-separate-cells-then-set-an-integer-value-based-on-resu/29503453#29503453", "title": "Find partial text within separate cells. Then set an integer value based on results.", "body": "<p>Inserting a Row1 for convenience with <code>BOX</code> in B1 and <code>BAG</code> in D1, in E3 and copied down to suit:  </p>\n\n<pre><code> =--(AND(MATCH(\"*\"&amp;B$1&amp;\"*\",B3,0),MATCH(\"*\"&amp;D$1&amp;\"*\",D3,0)))  \n</code></pre>\n\n<p>should return <code>1</code> where each value is present in the appropriate column for that row and <code>#N/A</code> otherwise. </p>\n"}], "owner": {"reputation": 1, "user_id": 4678156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/086607852f5fde793fde070244fefb9e?s=128&d=identicon&r=PG&f=1", "display_name": "Rece", "link": "https://stackoverflow.com/users/4678156/rece"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1428450689, "creation_date": 1428448486, "last_edit_date": 1531161705, "question_id": 29503054, "link": "https://stackoverflow.com/questions/29503054/find-partial-text-within-separate-cells-then-set-an-integer-value-based-on-resu", "title": "Find partial text within separate cells. Then set an integer value based on results.", "body": "<p>I have to find partial text within two cells of the same row and same sheet. The partial text within the cells do not have to match each other, they must match a separate text string that is specific to the column.\nFor example;</p>\n\n<pre><code>   Col A text          Col D text       Col E value\nR1 xxxxBOXxxxx         xxxxBAGxxxx     \nR2  xBOXxxxxx          xxxxxxxxBAGxx \n</code></pre>\n\n<p>BOX is unique to Col A, BAG is unique to Col D. The position of the partial text may appear anywhere within the cell. If the text conditions match, assign Col E same row, a value 1, no match no value. The search/find will continue throughout the sheet</p>\n\n<p>I'm not sure how to approach this task; search, find, match, vlookup, etc.\nAny help is appreciated, thank you.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1428448910, "post_id": 29503029, "comment_id": 47164089, "body": "If you update the sheet using the <code>Uform2</code>, then you&#39;ll have to call the sub that initialize the value of the <code>ComboBox1</code> from <code>Uform1</code>."}], "answers": [{"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 0, "last_activity_date": 1428450007, "creation_date": 1428450007, "answer_id": 29503327, "question_id": 29503029, "link": "https://stackoverflow.com/questions/29503029/combobox-update-after-userform-closes/29503327#29503327", "title": "Combobox update after userform closes", "body": "<p>I am not sure how you initialize the <code>ComboBox1</code> value but below set up seem to work.</p>\n\n<p><strong>UserForm1 Code:</strong></p>\n\n<pre><code>Private Sub CommandButton1_Click() ' Add User Button\n    Me.Hide\n    UserForm2.Show\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub UserForm_Activate() ' Populate ComboBox1\n    With Sheet1\n        Dim lr As Long\n        lr = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n        Me.ComboBox1.List = Application.Transpose(.Range(\"A1:A\" &amp; lr))\n    End With\n    Debug.Print \"Activated\"\nEnd Sub\n</code></pre>\n\n<p><strong>UserForm2 Code:</strong></p>\n\n<pre><code>Private Sub CommandButton1_Click() ' Register Button\n    With Sheet1\n        Dim lr As Long\n        lr = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n        .Range(\"A\" &amp; lr + 1) = Me.TextBox1\n    End With\n    Me.Hide\n    UserForm1.Show\nEnd Sub\n</code></pre>\n\n<p>The key is to use <code>UserForm_Activate</code> event to fire re-populating the <code>ComboBox1</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 4756953, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JhscUkiyKlg/AAAAAAAAAAI/AAAAAAAAABM/ZVXl8R7aCxI/photo.jpg?sz=128", "display_name": "Vicente Marambio", "link": "https://stackoverflow.com/users/4756953/vicente-marambio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 493, "favorite_count": 0, "accepted_answer_id": 29503327, "answer_count": 1, "score": 1, "last_activity_date": 1428450007, "creation_date": 1428448400, "last_edit_date": 1531164843, "question_id": 29503029, "link": "https://stackoverflow.com/questions/29503029/combobox-update-after-userform-closes", "title": "Combobox update after userform closes", "body": "<p>I have problem with a <code>UserForm</code> update.</p>\n\n<p>When I start the <code>Uform1</code> I fill a <code>ComboBox1</code> with a list of users of a <code>Sheet(\"User\")</code>.<br>\nIf the user is not registred u must press the button <code>Add user</code> in the <code>Uform1</code>.\nWhen <code>Add user</code> button is pressed, <code>Uform2</code> appear (<code>Uform2</code> is in charge of registering user)</p>\n\n<p>Ok my problem is when I finish with <code>Uform2</code> and I get focus back in <code>Uform1</code> the <code>Combobox1</code> doesn't show the new user. How can I do this?</p>\n"}, {"tags": ["xml", "vba", "dom", "xml-parsing", "attributes"], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "edited": false, "score": 0, "creation_date": 1428455584, "post_id": 29503645, "comment_id": 47165918, "body": "Hey Tim, thanks for your response and help. Just one quick question if you don&#39;t mind: if I wanted to store the BookType values into an array, would I just define a new array <code>Dim myStr() As String</code> and then put <code>myStr() = Author(i).ParentNode.ParentNode.getAttribute(&quot;id&quot;)</code> inside the With statement? This way I can print these values outside of the loop at a later time if needed."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "edited": false, "score": 0, "creation_date": 1428464003, "post_id": 29503645, "comment_id": 47167959, "body": "You could only assign the values one by one and you&#39;d need to resize the array as you add each item, but yes you can do that."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1428451872, "creation_date": 1428451872, "answer_id": 29503645, "question_id": 29502660, "link": "https://stackoverflow.com/questions/29502660/vba-dom-specific-node-and-attribute-id/29503645#29503645", "title": "VBA DOM Specific Node and Attribute ID", "body": "<p>You can go \"up\" a couple of steps to get to the parent \"book\" element and read the <code>id</code> attribute from there:</p>\n\n<pre><code>Sub mySub()\n\nDim mainWorkBook As Workbook\nDim XMLFile As Variant\nDim BookType As String\nDim Author As Variant\nDim athr As String\nDim n As IXMLDOMNode\nDim i As Long, x As Long\n\n    Set mainWorkBook = ActiveWorkbook\n    Set XMLFile = CreateObject(\"Microsoft.XMLDOM\")\n\n    XMLFILE.Load (XCMFileName) 'Load XCM File\n\n    x = 3\n\n    Set Author = XMLFile.SelectNodes(\"/catalog/book/author/text()\")\n    For i = 0 To (Author.Length - 1)\n        athr = Author(i).NodeValue\n        If athr = \"Ralls, Kim\" Then\n            With mainWorkBook.Sheets(\"Sheet1\")\n            .Range(\"C\" &amp; x).Value = athr\n            .Range(\"D\" &amp; x).Value = _\n                Author(i).ParentNode.ParentNode.getAttribute(\"id\")\n            End With\n            x = x + 1\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 759, "favorite_count": 0, "accepted_answer_id": 29503645, "answer_count": 1, "score": 0, "last_activity_date": 1428451872, "creation_date": 1428446583, "question_id": 29502660, "link": "https://stackoverflow.com/questions/29502660/vba-dom-specific-node-and-attribute-id", "title": "VBA DOM Specific Node and Attribute ID", "body": "<p>I have a large XML file that I'm trying to parse using DOM. What I'm trying to do is pull information from an attribute node if it's child contains a certain value.</p>\n\n<p>For example,</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;catalog&gt;\n&lt;book id=\"Adventure\"&gt;\n   &lt;author&gt;Gambardella, Matthew&lt;/author&gt;\n   &lt;title&gt;XML Developer's Guide&lt;/title&gt;\n   &lt;price&gt;44.95&lt;/price&gt;\n&lt;/book&gt;\n&lt;book id=\"Adventure\"&gt;\n   &lt;author&gt;Ralls, Kim&lt;/author&gt;\n   &lt;title&gt;Midnight Rain&lt;/title&gt;\n   &lt;price&gt;5.95&lt;/price&gt;\n&lt;/book&gt;\n&lt;book id=\"Adventure\"&gt;\n   &lt;author&gt;Boal, John&lt;/author&gt;\n   &lt;title&gt;Mist&lt;/title&gt;\n   &lt;price&gt;15.95&lt;/price&gt;\n&lt;/book&gt;\n&lt;book id=\"Mystery\"&gt;\n   &lt;author&gt;Ralls, Kim&lt;/author&gt;\n   &lt;title&gt;Some Mystery Book&lt;/title&gt;\n   &lt;price&gt;9.95&lt;/price&gt;\n&lt;/book&gt;\n&lt;/catalog&gt;\n</code></pre>\n\n<p>So from here, let's say I want to find books written by the author \"Ralls, Kim\":</p>\n\n<pre><code>Sub mySub()\n\nDim mainWorkBook As Workbook\nDim XMLFile As Variant\nDim BookType As String\nDim Author As Variant\nDim athr As String\nDim n As IXMLDOMNode\nDim i As Integer\n\nSet mainWorkBook = ActiveWorkbook\nSet XMLFILE = CreateObject(\"Microsoft.XMLDOM\")\n\nXMLFILE.Load (XCMFileName) 'Load XCM File\n\nSet Author = XMLFILE.SelectNodes(\"/catalog/book/author/text()\")\nFor i = 0 To (Author.Length - 1)\n    athr= Author(i).NodeValue \n    If athr = \"Ralls, Kim\" Then\n        mainWorkBook.Sheets(\"Sheet1\").Range(\"C\" &amp; i + 3).Value = athr\n    End If\nNext\nEnd Sub\n</code></pre>\n\n<p>Now what if I wanted to display the book type (ie \"Adventure/Mystery\") in the next column, how would I do that? I'm trying to think backwards but I don't know how to even begin this. </p>\n\n<p>I understand that I can use XPath and IXMLDOMNode to get the attribute id, but I simply don't know how to actually go about doing this since it seems backwards. </p>\n\n<p>Thanks for any tips and pointers - I appreciate it.</p>\n"}, {"tags": ["image", "vba", "excel", "crop"], "comments": [{"owner": {"reputation": 1771, "user_id": 3938986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L805E.jpg?s=128&g=1", "display_name": "Gary Storey", "link": "https://stackoverflow.com/users/3938986/gary-storey"}, "edited": false, "score": 0, "creation_date": 1428443567, "post_id": 29501819, "comment_id": 47162168, "body": "You should include the relevant code and an errors you are getting as well ."}, {"owner": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "reply_to_user": {"reputation": 1771, "user_id": 3938986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L805E.jpg?s=128&g=1", "display_name": "Gary Storey", "link": "https://stackoverflow.com/users/3938986/gary-storey"}, "edited": false, "score": 0, "creation_date": 1428443846, "post_id": 29501819, "comment_id": 47162263, "body": "I haven&#39;t started because I don&#39;t know where to begin! What objects/classes should I use?"}, {"owner": {"reputation": 471, "user_id": 4616423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86a46559e4c3f1704e0ba1ddfa70cc88?s=128&d=identicon&r=PG&f=1", "display_name": "rgo", "link": "https://stackoverflow.com/users/4616423/rgo"}, "edited": false, "score": 0, "creation_date": 1428448319, "post_id": 29501819, "comment_id": 47163919, "body": "You will need to elaborate more. You mention a screen shot. Are you saying you take a screen shot of something and then want to change the image? If so, check out a tool like Snag-it which is a fancier version of MS Paint that allows you to work with images."}, {"owner": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "edited": false, "score": 0, "creation_date": 1428528180, "post_id": 29501819, "comment_id": 47205512, "body": "This is my goal: I take a screen shot with Print Screen, and then I run the macro and it automatically crops the image and pastes it to a certain cell with a fixed width. I have it place it in a cell and have a fixed width, but I&#39;m using Snipping Tool&#39;s rectangle select  to crop it basically. I want to not use Snipping Tool and just use a Print Screen that gets automatically cropped."}], "owner": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 312, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1428442781, "creation_date": 1428442781, "question_id": 29501819, "link": "https://stackoverflow.com/questions/29501819/use-vba-to-crop-gray-space-from-print-screen", "title": "Use VBA to crop gray space from print screen", "body": "<p>I'm using Excel VBA and I would like to crop out a gray background and leave a white foreground. I'm using a CNC program, but imagine using Word and zooming out so all sides of the page is visible and the background is gray. How could I automatically crop out the background using VBA from a screenshot? The white space isn't always in the center and it varies in sizes. Any ideas?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 3554998, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2744f110dbb5e3db3b6bea158c95ba02?s=128&d=identicon&r=PG&f=1", "display_name": "user3554998", "link": "https://stackoverflow.com/users/3554998/user3554998"}, "edited": false, "score": 0, "creation_date": 1428453028, "post_id": 29503073, "comment_id": 47165252, "body": "This is most likely something I am doing wrong, but I used the Dim, set and lRow from above then put <code>rUsedrange.Address(True, True, x1R1C1, True).Refresh</code> for the SourceData:= in the macro above and get a compile error invalid qualifier on .Address.  Sorry,  I am still a noob on writing macros, so what have I done wrong?"}, {"owner": {"reputation": 471, "user_id": 4616423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86a46559e4c3f1704e0ba1ddfa70cc88?s=128&d=identicon&r=PG&f=1", "display_name": "rgo", "link": "https://stackoverflow.com/users/4616423/rgo"}, "reply_to_user": {"reputation": 19, "user_id": 3554998, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2744f110dbb5e3db3b6bea158c95ba02?s=128&d=identicon&r=PG&f=1", "display_name": "user3554998", "link": "https://stackoverflow.com/users/3554998/user3554998"}, "edited": false, "score": 0, "creation_date": 1428544794, "post_id": 29503073, "comment_id": 47211011, "body": "rUsedRange is a range that is the size of the used cells of the worksheet. when you run the macro in trace mode, type rUsedRange.address in the immediate window and you will see it return the activesheet&#39;s entire range (i.e. all rows, all columns) It is a property not a method, so you can assign a range to it use the name as a reference to the range, but you cannot use it as a method (i.e. .Refresh)"}, {"owner": {"reputation": 471, "user_id": 4616423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86a46559e4c3f1704e0ba1ddfa70cc88?s=128&d=identicon&r=PG&f=1", "display_name": "rgo", "link": "https://stackoverflow.com/users/4616423/rgo"}, "reply_to_user": {"reputation": 19, "user_id": 3554998, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2744f110dbb5e3db3b6bea158c95ba02?s=128&d=identicon&r=PG&f=1", "display_name": "user3554998", "link": "https://stackoverflow.com/users/3554998/user3554998"}, "edited": false, "score": 0, "creation_date": 1428545020, "post_id": 29503073, "comment_id": 47211078, "body": "In your original problem you were looking for a way to count the total rows. lRow = Activesheet.usedrange.rows.count will give the the count of rows of the active sheet, without having to use the End(x1Up).Row property."}], "tags": [], "owner": {"reputation": 471, "user_id": 4616423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86a46559e4c3f1704e0ba1ddfa70cc88?s=128&d=identicon&r=PG&f=1", "display_name": "rgo", "link": "https://stackoverflow.com/users/4616423/rgo"}, "is_accepted": true, "score": 0, "last_activity_date": 1428448583, "creation_date": 1428448583, "answer_id": 29503073, "question_id": 29501808, "link": "https://stackoverflow.com/questions/29501808/how-can-you-set-sourcedata-in-a-macro-to-count-only-rows-needed/29503073#29503073", "title": "How can you set SourceData in a macro to count only rows needed?", "body": "<p>You can use the activesheet.usedrange.address to get the actual address of the entire worksheet, or assign the range to a variable via:\n    Dim rUsedRange as range</p>\n\n<pre><code>set rUsedRange = activesheet.usedrange\n</code></pre>\n\n<p>UsedRange always gives the active area of a worksheet and updates anytime additional rows or columns are added. If you use the clearcontents command to clear a worksheet before repopulating, the usedrange will reset to a smaller size if needed.</p>\n\n<p>You can also get the bottom row via:</p>\n\n<pre><code>lRow = activesheet.usedrange.rows.count\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 3554998, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2744f110dbb5e3db3b6bea158c95ba02?s=128&d=identicon&r=PG&f=1", "display_name": "user3554998", "link": "https://stackoverflow.com/users/3554998/user3554998"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 0, "accepted_answer_id": 29503073, "answer_count": 1, "score": 0, "last_activity_date": 1580631470, "creation_date": 1428442728, "last_edit_date": 1580631470, "question_id": 29501808, "link": "https://stackoverflow.com/questions/29501808/how-can-you-set-sourcedata-in-a-macro-to-count-only-rows-needed", "title": "How can you set SourceData in a macro to count only rows needed?", "body": "<p>I have an Excel Workbook in which I am building as a Master.  Part of what I have to do is have pie charts on my master sheet.  So I have created a sheet that has formulas pulling over selected information to use for the pie charts (SortedPie).  Then I have another sheet that will be populated by macro creating the pivot tables for the pie charts (PieSheet).  My problem is that the information on SortedPie changes in the amount of rows from 1 to 500.  In my macro I have the SourceData set to 500, but then it leaves blanks in the pivot tables to equal all 500 rows.  I have tried using   <code>lr=SortedPie.Range(\"A\" &amp; Rows.Count).End(xlUp).Row</code> with <code>set rng=SortedPie.range(\"A:X\" &amp; lr)</code> then for <code>SourceData=:rng.Address(True, True,xlR1C1,True).Refresh</code>  and when run gives me compile error on the Address.  I should say my code also has <code>Dim lr As Long</code> and <code>Dim rng As Range</code>.  This is the macro as it is now.</p>\n\n<pre><code>ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n    \"SortedPie!R1C1:R500C5\", Version:=xlPivotTableVersion14).CreatePivotTable _\n    TableDestination:=\"PieSheet!R1C1\", TableName:=\"PivotTable2\", _\n    DefaultVersion:=xlPivotTableVersion14\nSheets(\"PieSheet\").Select\ncells(1, 1).Select\nWith ActiveSheet.PivotTables(\"PivotTable2\").PivotFields(\"Credit Score\")\n    .Orientation = xlRowField\n    .Position = 1\nEnd With\nActiveSheet.PivotTables(\"PivotTable2\").AddDataField ActiveSheet.PivotTables( _\n    \"PivotTable2\").PivotFields(\"CustomerAccountID\"), \"Count of CustomerAccountID\", _\n    xlCount\nSheets(\"SortedPie\").Select\nActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n    \"SortedPie!R1C1:R185C5\", Version:=xlPivotTableVersion14).CreatePivotTable _\n    TableDestination:=\"PieSheet!R10C1\", TableName:=\"PivotTable3\", _\n    DefaultVersion:=xlPivotTableVersion14\nSheets(\"PieSheet\").Select\ncells(10, 1).Select\nWith ActiveSheet.PivotTables(\"PivotTable3\").PivotFields(\"PanelType\")\n    .Orientation = xlRowField\n    .Position = 1\nEnd With\nActiveSheet.PivotTables(\"PivotTable3\").AddDataField ActiveSheet.PivotTables( _\n    \"PivotTable3\").PivotFields(\"CustomerAccountID\"), \"Count of CustomerAccountID\", _\n    xlCount\nSheets(\"SortedPie\").Select\nActiveWorkbook.Worksheets(\"PieSheet\").PivotTables(\"PivotTable3\").PivotCache. _\n    CreatePivotTable TableDestination:=\"PieSheet!R20C1\", TableName:= _\n    \"PivotTable4\", DefaultVersion:=xlPivotTableVersion14\nSheets(\"PieSheet\").Select\ncells(20, 1).Select\nWith ActiveSheet.PivotTables(\"PivotTable4\").PivotFields(\"Status\")\n    .Orientation = xlRowField\n    .Position = 1\nEnd With\nActiveSheet.PivotTables(\"PivotTable4\").AddDataField ActiveSheet.PivotTables( _\n    \"PivotTable4\").PivotFields(\"CustomerAccountID\"), \"Count of CustomerAccountID\", _\n    xlCount\nSheets(\"SortedPie\").Select\nActiveWorkbook.Worksheets(\"PieSheet\").PivotTables(\"PivotTable4\").PivotCache. _\n    CreatePivotTable TableDestination:=\"PieSheet!R30C1\", TableName:= _\n    \"PivotTable5\", DefaultVersion:=xlPivotTableVersion14\nSheets(\"PieSheet\").Select\ncells(30, 1).Select\nWith ActiveSheet.PivotTables(\"PivotTable5\").PivotFields(\"BillingMethod\")\n    .Orientation = xlRowField\n    .Position = 1\nEnd With\nActiveSheet.PivotTables(\"PivotTable5\").AddDataField ActiveSheet.PivotTables( _\n    \"PivotTable5\").PivotFields(\"CustomerAccountID\"), \"Count of CustomerAccountID\", _\n    xlCount\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "vba", "object"], "comments": [{"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1428445263, "post_id": 29500956, "comment_id": 47162831, "body": "Can you give us an idea of the naming convention? I assume from your post you want to be able to determine the name simply from some date parameters?"}, {"owner": {"reputation": 185, "user_id": 3794203, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cba2a1760eb1c8f18f60de42d7070f21?s=128&d=identicon&r=PG&f=1", "display_name": "user3794203", "link": "https://stackoverflow.com/users/3794203/user3794203"}, "reply_to_user": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1428500248, "post_id": 29500956, "comment_id": 47187734, "body": "I have tried to decipher the naming system, but as it is a system where multiple offices can access reports daily, there is no way for me to keep track of the sequence that it will be in at any given time. The date is a constantly changing factor, as is the number of reports pulled."}], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 3794203, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cba2a1760eb1c8f18f60de42d7070f21?s=128&d=identicon&r=PG&f=1", "display_name": "user3794203", "link": "https://stackoverflow.com/users/3794203/user3794203"}, "edited": false, "score": 0, "creation_date": 1428500350, "post_id": 29502378, "comment_id": 47187806, "body": "This is a possibility...however, as the files export to a temporary folder that is not easily found (the more steps it takes, the less likely anyone else is to use the macro) I am pretty sure that my coworkers will just give up and not try further.  Is there a way for the macro to get the current name of the open file each time?"}], "tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": false, "score": 0, "last_activity_date": 1428445156, "creation_date": 1428445156, "answer_id": 29502378, "question_id": 29500956, "link": "https://stackoverflow.com/questions/29500956/excel-macro-recorder-when-the-filename-is-always-changing/29502378#29502378", "title": "Excel Macro Recorder: When the filename is always changing", "body": "<p>Why don't you \"Open\" the workbook you want to process. Something like this</p>\n\n<pre><code>Sub DemoOpen()\n    Dim FName As Variant\n    Dim wb As Workbook\n    FName = Application.GetOpenFilename(filefilter:=\"Excel Files (*.xls), *.xls\")\n    If FName &lt;&gt; False Then\n        Set wb = Workbooks.Open(FName)\n        Dim sht As Worksheet\n        Set sht = wb.ActiveSheet\n        sht.Name = \"MYDATA\"\n        'Lots of formatting commands\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 185, "user_id": 3794203, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cba2a1760eb1c8f18f60de42d7070f21?s=128&d=identicon&r=PG&f=1", "display_name": "user3794203", "link": "https://stackoverflow.com/users/3794203/user3794203"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1155, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1428445156, "creation_date": 1428439363, "last_edit_date": 1428440113, "question_id": 29500956, "link": "https://stackoverflow.com/questions/29500956/excel-macro-recorder-when-the-filename-is-always-changing", "title": "Excel Macro Recorder: When the filename is always changing", "body": "<p>I currently use a lot of spreadsheets to do my job that visualize incoming data that is always changing. </p>\n\n<p>The main issue that I have run into is the file that I export every day has a naming system that is based on some algorithm that has relation to the date and time that the information was pulled, but is somewhat generated at random. This means that the workbook always has a different name and because of the copious amounts of reports that we pull, I prefer to be able to extract the information, transfer it to the main sheet, and delete the exported file. The macro that I came up with through recording my actions works fine if ALL other Microsoft applications are closed (if Word, Outlook, or another Excel file are open, the macro crashes with a define error). </p>\n\n<p>Can anyone suggest a solution for being able to execute a code to format a file when the name is constantly changing?  I can paste an example of what I have, but it's a long code due to the formatting.  The basics are:</p>\n\n<pre><code>Sub RECORDTHIS()\nDim sht As Object\n\nSet sht = ActiveWorkbook.ActiveSheet\n\nsht.Select\nsht.Name = \"MYDATA\"\n\n'Lots of formatting commands\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["mysql", "vba", "excel"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1430517643, "post_id": 29500848, "comment_id": 48111076, "body": "<a href=\"http://stackoverflow.com/a/28788519/2165759\">This approach</a> might be helpful. Async XHR can make it faster."}], "answers": [{"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 0, "last_activity_date": 1428441592, "last_edit_date": 1428441592, "creation_date": 1428440969, "answer_id": 29501355, "question_id": 29500848, "link": "https://stackoverflow.com/questions/29500848/automating-query-creation-excel/29501355#29501355", "title": "Automating Query Creation Excel", "body": "<p>I can't help but think you'd be better off using a database (such as Microsoft Access) instead of Excel to store this amount of data. You could still run your calculations from a spreadsheet and query the data table in the Access database. It's a fun (and maddening!) journey to develop your own Excel application. Having said that...</p>\n\n<p>What you need to study in VBA is looping. Start with a simple loop on a set of the ticker values in the column:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub test()\n    Dim ticker As String\n    Dim companyTicker As Range\n    Dim allTickers As Range\n    Dim lastRow As Long\n\n    '---sets up a range containing all your ticker strings\n    Dim lngMaxRow As Long\n    lastRow = Sheets(\"ROIC\").Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n    '---during your development, force your ticker set to be shorter\n    lastRow = 10\n    Set allTickers = Range(\"B5:B\" &amp; lastRow)\n\n    '---now loop through all the companies and get the info for each one\n    For Each companyTicker In allTickers\n        ticker = companyTicker.Value\n        '--- build up the query to Yahoo Finance using the company ticker string\n        '    copy the data from your query to the cells in your workbook\n        Debug.Print \"ticker is \" &amp; ticker  'use a debug.print to check as you write the code\n    Next companyTicker                     'get the next company ticker\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4760596, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Clq8OZ_lOKU/AAAAAAAAAAI/AAAAAAAAAKs/D5s8HJMYVjM/photo.jpg?sz=128", "display_name": "Jake C", "link": "https://stackoverflow.com/users/4760596/jake-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1428441592, "creation_date": 1428438956, "last_edit_date": 1428441240, "question_id": 29500848, "link": "https://stackoverflow.com/questions/29500848/automating-query-creation-excel", "title": "Automating Query Creation Excel", "body": "<p>I am trying to create a stock screener through excel. First off, Excel may not be the best choice for stock screen creation, so I'm open to alternatives, but\n 1. I'm almost done, and\n 2. I have zero programming experience</p>\n\n<p>So before I tell you my problem, here's what I've got so far (Working on the ROIC tab): <a href=\"https://jumpshare.com/v/OxlCrsMZa18tS9bB8N1S?b=D89mk1t3hPnWdxyYxL6p\" rel=\"nofollow\">https://jumpshare.com/v/OxlCrsMZa18tS9bB8N1S?b=D89mk1t3hPnWdxyYxL6p</a></p>\n\n<p>What I can't do, and what would complete the screener, is make a query for every single cell. Now I think, although I don't KNOW, that it is possible to create a <strong>macro which starts a query, tells excel where to put the data (50 rows down from the previous input), and tells excel where to find what ticker to put in (one row down from previous ticker).</strong> The query making also has to repeat to the end of the tickers. (you may be thinking: \"isn't the excel row limit approx. 1 million?\"  It is, and my solution to that is to put half the balance sheets from columns A:F, and the other half from H:M. You don't need to include that, though, I can figure it out.)</p>\n\n<p>The query pulls company balance sheets from yahoo finance, and then imports the data to the Data sheet. Since the balance sheets are all formatted the same, it is easy to sort: each metric is 50 rows down from the previous search. </p>\n\n<p>The reason I need to automate this query creation process is that there are approximately 25,000 stocks, and to make a screener, I need to analyze them all at the same time; each stock, therefore, needs its own query and own data. </p>\n\n<p>I've tried recording a macro, but I just can't seem to get it to repeat, offset 50 rows every new data query, and offset 1 row every new ticker.</p>\n\n<p>I would really appreciate the help; I am very new to excel, and I'm not entirely sure how possible it is to do what I'm asking. Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1428438923, "post_id": 29500659, "comment_id": 47160095, "body": "Add a <code>ByVal ws As Worksheet</code> parameter, and then change all <code>ActiveSheet</code> instances to refer to <code>ws</code> instead, and use <code>ws.Range</code> instead of just <code>Range</code>. Then call that procedure from another procedure whose job will be to determine what worksheest to give it."}, {"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1428439014, "post_id": 29500659, "comment_id": 47160136, "body": "I would recommend reading this article: <a href=\"http://www.techrepublic.com/blog/10-things/10-ways-to-reference-excel-workbooks-and-sheets-using-vba/\" rel=\"nofollow noreferrer\">techrepublic.com/blog/10-things/&hellip;</a>"}, {"owner": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "edited": false, "score": 3, "creation_date": 1428439014, "post_id": 29500659, "comment_id": 47160137, "body": "Using &quot;Active&quot; objects in your code is not good.  Try to refer to specific objects only.  It makes your code easier to maintain and debug."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1428445561, "post_id": 29500659, "comment_id": 47162946, "body": "<a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">Abandon <i>Select/Activesheet</i> and work in your objects directly</a>."}], "answers": [{"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 1, "last_activity_date": 1428444712, "creation_date": 1428444712, "answer_id": 29502278, "question_id": 29500659, "link": "https://stackoverflow.com/questions/29500659/how-to-make-macro-not-sheet-specific/29502278#29502278", "title": "How To Make Macro Not Sheet Specific", "body": "<p>Here's a quick example</p>\n\n<pre><code>Dim sh as worksheet\nDim ws as worksheet\nset ws=sheets(\"Sheet2\")\nset sh=activesheet\nsh.Range(\"Z3\") = \"Week\"\n\nwith ws\n'do something\nend with\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 161, "user_id": 3067028, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4784037132d9b2c9c334e466825fcc6d?s=128&d=identicon&r=PG&f=1", "display_name": "user3067028", "link": "https://stackoverflow.com/users/3067028/user3067028"}, "edited": false, "score": 0, "creation_date": 1428513149, "post_id": 29502670, "comment_id": 47196921, "body": "Let me try this out.  I think I understand what you are saying.  Thx in advance."}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 1, "last_activity_date": 1428446641, "creation_date": 1428446641, "answer_id": 29502670, "question_id": 29500659, "link": "https://stackoverflow.com/questions/29500659/how-to-make-macro-not-sheet-specific/29502670#29502670", "title": "How To Make Macro Not Sheet Specific", "body": "<ol>\n<li><p>If there is only one worksheet in your workbook, then use the index.</p>\n\n<pre><code>Dim ws As Worksheet ' Declare a worksheet type variable\nSet ws = Thisworksbook.Sheets(1) ' assign the worksheet object\n</code></pre></li>\n<li><p>If there are other worksheets but the same worksheet is used all throughout (meaning, the sheet name is just edited for the new month) then use the worksheet <code>codename</code>. </p>\n\n<pre><code>Dim ws As Worksheet ' Declare a worksheet type variable\nSet ws = Sheet1 ' use Codename to assign worksheet object to variable\n</code></pre></li>\n</ol>\n\n<p><img src=\"https://i.stack.imgur.com/CsMnQ.png\" alt=\"enter image description here\"></p>\n\n<p>You can only edit the <code>Codename</code> in the properties window as shown above.<br>\nThe user can change the sheet name outside but not the <code>Codename</code>.</p>\n\n<ol start=\"3\">\n<li><p>If a new sheet is created for every month, use a loop.</p>\n\n<pre><code>Dim ws As Worksheet, i As Integer\nDim MoYr As String\n\nMoYr = Format(Date, \"mmmm yyyy\") ' Returns April 2015 if run now\nWith ThisWorkbook\n    For i = 1 To .Sheets.Count\n        If InStr(.Sheets(i).Name, MoYr) &lt;&gt; 0 Then\n            Set ws = .Sheets(i): Exit For\n        End If\n    Next\nEnd With\nIf ws Is Nothing Then Exit Sub ' Just in case nothing is found\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 161, "user_id": 3067028, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4784037132d9b2c9c334e466825fcc6d?s=128&d=identicon&r=PG&f=1", "display_name": "user3067028", "link": "https://stackoverflow.com/users/3067028/user3067028"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1026, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1428446641, "creation_date": 1428438332, "last_edit_date": 1428438968, "question_id": 29500659, "link": "https://stackoverflow.com/questions/29500659/how-to-make-macro-not-sheet-specific", "title": "How To Make Macro Not Sheet Specific", "body": "<p>If possible I would like the macro below to run the same way, regardless of what the name of the sheet is.  For instance on this file it's \"ZPPV Final for March 2015\". But that March, may change to April or May, etc.  Can I have this macro run regardless of what month is on that sheets tab?  Please see below:</p>\n\n<pre><code>Sub PPV()\n'\n' PPV Macro\n'\n\n'\n    Sheets(\"ZPPV Final for March 2015\").Select\n    Range(\"Z3\").Select\n    ActiveCell.FormulaR1C1 = \"Week\"\n    Range(\"Z4\").Select\n    ActiveCell.FormulaR1C1 = \"=WEEKNUM(RC[-9])\"\n    Range(\"Z4\").Select\n    Selection.AutoFill Destination:=Range(\"Z4:Z8858\")\n    Range(\"Z4:Z8858\").Select\n    Range(\"Z3\").Select\n    Range(Selection, Selection.End(xlToLeft)).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Sheets.Add\n    ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n        \"***ZPPV Final for March 2015***!R3C2:R8858C26\", Version:=xlPivotTableVersion14). _\n        CreatePivotTable TableDestination:=\"Sheet2!R3C1\", TableName:=\"PivotTable9\" _\n        , DefaultVersion:=xlPivotTableVersion14\n    Sheets(\"Sheet2\").Select\n    Cells(3, 1).Select\n    With ActiveSheet.PivotTables(\"PivotTable9\").PivotFields(\"Plant\")\n        .Orientation = xlPageField\n        .Position = 1\n    End With\n    With ActiveSheet.PivotTables(\"PivotTable9\").PivotFields(\"Week\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n    ActiveSheet.PivotTables(\"PivotTable9\").AddDataField ActiveSheet.PivotTables( _\n        \"PivotTable9\").PivotFields(\"           PPV\"), \"Sum of            PPV\", xlSum\n    ActiveSheet.PivotTables(\"PivotTable9\").PivotFields(\"Plant\").ClearAllFilters\n    ActiveSheet.PivotTables(\"PivotTable9\").PivotFields(\"Plant\").CurrentPage = _\n        \"1027\"\n    Sheets(\"**ZPPV Final for March 2015\").**Select\n    ActiveWorkbook.Worksheets(\"Sheet2\").PivotTables(\"PivotTable9\").PivotCache. _\n        CreatePivotTable TableDestination:=\"Sheet2!R1C6\", TableName:=\"PivotTable10\" _\n        , DefaultVersion:=xlPivotTableVersion14\n    Sheets(\"Sheet2\").Select\n    Cells(1, 6).Select\n    With ActiveSheet.PivotTables(\"PivotTable10\").PivotFields(\"Plant\")\n        .Orientation = xlPageField\n        .Position = 1\n    End With\n    With ActiveSheet.PivotTables(\"PivotTable10\").PivotFields(\"Week\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n    ActiveSheet.PivotTables(\"PivotTable10\").AddDataField ActiveSheet.PivotTables( _\n        \"PivotTable10\").PivotFields(\"           PPV\"), \"Sum of            PPV\", xlSum\n    With ActiveSheet.PivotTables(\"PivotTable10\").PivotFields(\"Vendor Name\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n    Range(\"F4\").Select\n    ActiveSheet.PivotTables(\"PivotTable10\").PivotFields(\"Vendor Name\").ShowDetail _\n        = False\n    ActiveSheet.PivotTables(\"PivotTable10\").PivotFields(\"Plant\").ClearAllFilters\n    ActiveSheet.PivotTables(\"PivotTable10\").PivotFields(\"Plant\").CurrentPage = _\n        \"1027\"\n    Sheets(\"ZPPV Final for March 2015\").Select\n    ActiveWorkbook.Worksheets(\"Sheet2\").PivotTables(\"PivotTable10\").PivotCache. _\n        CreatePivotTable TableDestination:=\"Sheet2!R1C10\", TableName:= _\n        \"PivotTable11\", DefaultVersion:=xlPivotTableVersion14\n    Sheets(\"Sheet2\").Select\n    Cells(1, 10).Select\n    With ActiveSheet.PivotTables(\"PivotTable11\").PivotFields(\"Plant\")\n        .Orientation = xlPageField\n        .Position = 1\n    End With\n    ActiveSheet.PivotTables(\"PivotTable11\").AddDataField ActiveSheet.PivotTables( _\n        \"PivotTable11\").PivotFields(\"           PPV\"), \"Sum of            PPV\", xlSum\n    With ActiveSheet.PivotTables(\"PivotTable11\").PivotFields(\"Material No.\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n    ActiveSheet.PivotTables(\"PivotTable11\").PivotFields(\"Plant\").ClearAllFilters\n    ActiveSheet.PivotTables(\"PivotTable11\").PivotFields(\"Plant\").CurrentPage = _\n        \"1027\"\n    Range(\"A3\").Select\n    ActiveSheet.PivotTables(\"PivotTable9\").CompactLayoutRowHeader = \"Week\"\n    Range(\"F3\").Select\n    ActiveSheet.PivotTables(\"PivotTable10\").CompactLayoutRowHeader = \"Vendor\"\n    Range(\"J3\").Select\n    ActiveSheet.PivotTables(\"PivotTable11\").CompactLayoutRowHeader = _\n        \"Material Number\"\n    Range(\"A2\").Select\n    ActiveCell.FormulaR1C1 = \"PPV By Week\"\n    Range(\"F2\").Select\n    ActiveCell.FormulaR1C1 = \"PPV By Vendor\"\n    Range(\"J2\").Select\n    ActiveCell.FormulaR1C1 = \"PPV By Material #\"\n    Range(\"J2\").Select\n    Selection.Font.Bold = True\n    Range(\"F2\").Select\n    Selection.Font.Bold = True\n    Range(\"A2\").Select\n    Selection.Font.Bold = True\n    Range(\"D3\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "vba", "outlook", "mailto"], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 151784, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/64d37b0a3f4c4b7a264004934845e529?s=128&d=identicon&r=PG", "display_name": "hemalshah", "link": "https://stackoverflow.com/users/151784/hemalshah"}, "edited": false, "score": 0, "creation_date": 1428452470, "post_id": 29502954, "comment_id": 47165105, "body": "Am sorry a bit lost, you mean to create a VB code? I understand the logic you explained but part of my question is also to understand a way to achieve it. Am novice when it comes to VB or Macros."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 99, "user_id": 151784, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/64d37b0a3f4c4b7a264004934845e529?s=128&d=identicon&r=PG", "display_name": "hemalshah", "link": "https://stackoverflow.com/users/151784/hemalshah"}, "edited": false, "score": 0, "creation_date": 1428470907, "post_id": 29502954, "comment_id": 47169999, "body": "You will need to create the Application_ItemSend event handler in your VBA module. Have you tried that?"}, {"owner": {"reputation": 99, "user_id": 151784, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/64d37b0a3f4c4b7a264004934845e529?s=128&d=identicon&r=PG", "display_name": "hemalshah", "link": "https://stackoverflow.com/users/151784/hemalshah"}, "edited": false, "score": 0, "creation_date": 1428603362, "post_id": 29502954, "comment_id": 47243419, "body": "Not yet Dmitry, I have a VBA guy who is helping me with the coding and am looking for this information to get as much to him as possible."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1428448033, "creation_date": 1428448033, "answer_id": 29502954, "question_id": 29500539, "link": "https://stackoverflow.com/questions/29500539/capture-subject-line-from-outlook-email-into-mailto-link-in-signature/29502954#29502954", "title": "Capture subject line from Outlook email into mailto link in signature", "body": "<p>Include a placeholder in the signature's link (e.q. <code>mailto:somebody@domain.demo?subject=xyzq</code>), when Application.ItemSend event fires, look at the MailItem.HTMLBody property and replace the placeholder (xyzq above) with the value of the MailItem.Subject property. You might need to encode spaces and special characters.</p>\n"}, {"comments": [{"owner": {"reputation": 99, "user_id": 151784, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/64d37b0a3f4c4b7a264004934845e529?s=128&d=identicon&r=PG", "display_name": "hemalshah", "link": "https://stackoverflow.com/users/151784/hemalshah"}, "edited": false, "score": 0, "creation_date": 1428603438, "post_id": 29511601, "comment_id": 47243468, "body": "Oh yes I completely know that and this is not one of those posts about adding more functionality to mailto:.. thanks for the link though"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1428487389, "creation_date": 1428487389, "answer_id": 29511601, "question_id": 29500539, "link": "https://stackoverflow.com/questions/29500539/capture-subject-line-from-outlook-email-into-mailto-link-in-signature/29511601#29511601", "title": "Capture subject line from Outlook email into mailto link in signature", "body": "<p>The mailto: command doesn't allows to specify any custom information for Outlook. Read more about the mailto scheme in <a href=\"https://tools.ietf.org/html/rfc2368\" rel=\"nofollow\">RFC2368</a>.</p>\n\n<p>If you are new to VBA, I'd recommend starting from the <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736%28v=office.14%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Getting Started with VBA in Outlook 2010</a> article which explains the basics. </p>\n"}], "owner": {"reputation": 99, "user_id": 151784, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/64d37b0a3f4c4b7a264004934845e529?s=128&d=identicon&r=PG", "display_name": "hemalshah", "link": "https://stackoverflow.com/users/151784/hemalshah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1712, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1593070883, "creation_date": 1428437951, "last_edit_date": 1593070883, "question_id": 29500539, "link": "https://stackoverflow.com/questions/29500539/capture-subject-line-from-outlook-email-into-mailto-link-in-signature", "title": "Capture subject line from Outlook email into mailto link in signature", "body": "<p>I am helping someone working in operations to set up an email signature which includes a link to escalate to a higher official in case of any displeasure. While I can use a mailto: to link to the official's email id, I want to also capture the subject of the email to capture details like Service Ticket number and any other title that is in the email subject. </p>\n\n<p>What I mean to say in a nutshell is - when a user clicks on the link, he would get a new Outlook compose mail window with the same subject. Using simple mailto: with manually changing subject line wont help. Looking for some tips here - am open to look at dynamic options like VB code or something but it has to be via Outlook. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4760549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a547ee55bf80aaa84b5efb1329d0fd?s=128&d=identicon&r=PG&f=1", "display_name": "IBahamut", "link": "https://stackoverflow.com/users/4760549/ibahamut"}, "edited": false, "score": 0, "creation_date": 1428440399, "post_id": 29500743, "comment_id": 47160814, "body": "I am still getting an error when I run the insert sub after adding another city to the list. Do you know how to prevent this?"}, {"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "reply_to_user": {"reputation": 1, "user_id": 4760549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a547ee55bf80aaa84b5efb1329d0fd?s=128&d=identicon&r=PG&f=1", "display_name": "IBahamut", "link": "https://stackoverflow.com/users/4760549/ibahamut"}, "edited": false, "score": 0, "creation_date": 1428447083, "post_id": 29500743, "comment_id": 47163509, "body": "What is the error and on what line is it occurring on?"}], "tags": [], "owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "is_accepted": false, "score": 0, "last_activity_date": 1428438635, "creation_date": 1428438635, "answer_id": 29500743, "question_id": 29500271, "link": "https://stackoverflow.com/questions/29500271/vba-adding-worksheets-from-list/29500743#29500743", "title": "VBA adding worksheets from list", "body": "<p>You're attempting to use two different methods (that will yield different results) to find the last cell in the range.</p>\n\n<p>In your <code>insertSheets</code> procedure, you're using:</p>\n\n<pre><code>Set MyRange2 = Range(MyRange, MyRange.End(xlDown))\n</code></pre>\n\n<p>This is the same effect as holding <kbd>Ctrl</kbd> and pressing the down key which will find the last cell before a blank cell is present.</p>\n\n<p>In your <code>deleteSheets</code> procedure you use:</p>\n\n<pre><code>Set MyRange = Range(\"A1\", .Cells(.Rows.Count, \"A\").End(xlUp))\n</code></pre>\n\n<p>This has a different effect from the way you searched in the <code>insertSheets</code> procedure as it starts from the bottom of the worksheet to find the true last cell in the range.</p>\n\n<p>I suggest amending your <code>insertSheets</code> procedure to:</p>\n\n<pre><code>Sub insertSheets()\n\nDim myCell As Range\nDim MyRange As Range\nDim MyRange2 As Range\n\nWith Sheets(\"AllCities\")\n    Set MyRange = .Range(\"A2\")\n    Set MyRange2 = .Range(MyRange, .Rows.Count, \"A\").End(xlUp)\nEnd With\n\nFor Each myCell In MyRange2\n    If Not myCell.Value = vbNullString Then\n        Sheets.Add After:=Sheets(Sheets.Count)\n        Sheets(Sheets.Count).Name = myCell.Value\n    End If\nNext myCell\n\nEnd Sub\n</code></pre>\n\n<p>This will also validate that the cell is not blank and therefore prevent Excel from throwing an error because you trying to rename a new worksheet to having no name.</p>\n"}], "owner": {"reputation": 1, "user_id": 4760549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a547ee55bf80aaa84b5efb1329d0fd?s=128&d=identicon&r=PG&f=1", "display_name": "IBahamut", "link": "https://stackoverflow.com/users/4760549/ibahamut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 336, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1428441009, "creation_date": 1428436969, "last_edit_date": 1428441009, "question_id": 29500271, "link": "https://stackoverflow.com/questions/29500271/vba-adding-worksheets-from-list", "title": "VBA adding worksheets from list", "body": "<p>I am still very new at VBA and I am having trouble getting some code to work. I have one sub where I want to create worksheets based off of a list of names in a worksheet named AllCities. The list of city names starts in cell A2. The worksheets need to be named after the cell value in the list, and the list should be able to be updated.  The code right now works kind of, but it doesn't add new worksheets if I add to the list of names. My second sub is supposed to delete an any worksheets that do not correspond to a city on the list. My delete sub is just deleting every worksheet right now. </p>\n\n<p><strong>Insert Worksheet Code:</strong></p>\n\n<pre><code>Sub insertSheets()\n\nDim myCell As Range\nDim MyRange As Range\nDim MyRange2 As Range\n\nSet MyRange = Sheets(\"AllCities\").Range(\"A2\")\nSet MyRange2 = Range(MyRange, MyRange.End(xlDown))\n\nFor Each myCell In MyRange2\n    Sheets.Add After:=Sheets(Sheets.Count)\n    Sheets(Sheets.Count).Name = myCell.Value\n\nNext myCell\n\nEnd Sub\n</code></pre>\n\n<p><strong>Delete Worksheet Code:</strong></p>\n\n<pre><code>Sub deleteSheets()\n\nDim wks As Worksheet\nDim MyRange As Range\nDim myCell As Range\n\nSet wks = Sheets(\"AllCities\")\n\nWith wks\n    Set MyRange = Range(\"A2\", .Cells(.Rows.Count, \"A\").End(xlUp))\nEnd With\n\nOn Error Resume Next\nApplication.DisplayAlerts = False\nFor Each myCell In MyRange\n    Sheets(myCell.Value).Delete\nNext myCell\nApplication.DisplayAlerts = True\nOn Error GoTo 0\n\nEnd Sub\n</code></pre>\n\n<p>Thanks for any help that you have!</p>\n"}, {"tags": ["excel", "twitter", "data-processing", "vba"], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1428490175, "last_edit_date": 1428490175, "creation_date": 1428437540, "answer_id": 29500433, "question_id": 29500144, "link": "https://stackoverflow.com/questions/29500144/how-can-i-extract-a-text-that-has-a-specific-pattern-from-a-column-of-cells-usin/29500433#29500433", "title": "How can I extract a text that has a specific pattern from a column of cells using EXCEL formula?", "body": "<p>This is only a <strong>partial</strong> solution.  It retrieves the first instance of text bounded by \"@\" and a single space. With data in <strong>A1</strong>, in <strong>B1</strong> enter:</p>\n\n<pre><code>=LEFT(MID(A1,FIND(\"@\",A1)+1,9999),FIND(\" \",MID(A1,FIND(\"@\",A1)+1,9999)))\n</code></pre>\n\n<p>For example:</p>\n\n<p><img src=\"https://i.stack.imgur.com/w5qzz.png\" alt=\"enter image description here\"></p>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 2316586, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/12f968479e564a0f908627e6e3e0f956?s=128&d=identicon&r=PG", "display_name": "Arianna Newman", "link": "https://stackoverflow.com/users/2316586/arianna-newman"}, "edited": false, "score": 0, "creation_date": 1428715463, "post_id": 29500604, "comment_id": 47295183, "body": "Thanks for the steps, this help me understand the formula. And it works very good :) @josh"}, {"owner": {"reputation": 610, "user_id": 947863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c524b4d2592f13e2bb11c59cd3df040?s=128&d=identicon&r=PG", "display_name": "Josh Miller", "link": "https://stackoverflow.com/users/947863/josh-miller"}, "reply_to_user": {"reputation": 57, "user_id": 2316586, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/12f968479e564a0f908627e6e3e0f956?s=128&d=identicon&r=PG", "display_name": "Arianna Newman", "link": "https://stackoverflow.com/users/2316586/arianna-newman"}, "edited": false, "score": 0, "creation_date": 1429034114, "post_id": 29500604, "comment_id": 47410687, "body": "Remember to mark the answer that you used, so this question is marked as complete.  Thanks!"}, {"owner": {"reputation": 57, "user_id": 2316586, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/12f968479e564a0f908627e6e3e0f956?s=128&d=identicon&r=PG", "display_name": "Arianna Newman", "link": "https://stackoverflow.com/users/2316586/arianna-newman"}, "edited": false, "score": 0, "creation_date": 1433309471, "post_id": 29500604, "comment_id": 49289899, "body": "Thank you for the help. I have used all this formula and it works :)"}], "tags": [], "owner": {"reputation": 610, "user_id": 947863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c524b4d2592f13e2bb11c59cd3df040?s=128&d=identicon&r=PG", "display_name": "Josh Miller", "link": "https://stackoverflow.com/users/947863/josh-miller"}, "is_accepted": true, "score": 2, "last_activity_date": 1428438171, "creation_date": 1428438171, "answer_id": 29500604, "question_id": 29500144, "link": "https://stackoverflow.com/questions/29500144/how-can-i-extract-a-text-that-has-a-specific-pattern-from-a-column-of-cells-usin/29500604#29500604", "title": "How can I extract a text that has a specific pattern from a column of cells using EXCEL formula?", "body": "<p>I suggest that you break this task down into multiple columns, to understand how the formulas work together to get to your answer.</p>\n\n<p><strong>Column Headers</strong></p>\n\n<pre><code>Column A = Your Data\nColumn B = First Start = Find the first occurrence of @\nColumn C = First End = Find the end of the first occurrence with a space\nColumn D = Second Start = Find the Second occurrence of @ \nColumn E = Second End = Find the end of the second occurrence with a space\nColumn F = First Twitter Account = MID the First Start/End\nColumn G = Second Twitter Account = Mid the Second Start/End\n</code></pre>\n\n<p><strong>Formulas</strong></p>\n\n<pre><code>Column A = \"An Example @Tweet with @two mentions\"\nColumn B = Find(\"@\",A2)\nColumn C = FIND(\" \",A2,B2)\nColumn D = FIND(\"@\",A3,C3)\nColumn E = FIND(\" \",A3,D3)\nColumn F = MID(A2,B2,C2-B2)\nColumn G = MID(A2,D2,E2-D2)\n</code></pre>\n\n<p>You can repeat the above pattern for as many \"mentions\" as needed.  You can learn that by counting how many @ signs are in each string, and making sure to write enough formulas to accommodate that number.</p>\n\n<p>You could mash all of the above into one formula, but it would be a beast to read.</p>\n\n<p>Keep in mind as well, if a \"mention\" is made at the END of a string, the above formulas will not count it.  i.e. In your question you mention that mentions end in a space, which may not be the case if it happens at the end of the tweet.</p>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 2316586, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/12f968479e564a0f908627e6e3e0f956?s=128&d=identicon&r=PG", "display_name": "Arianna Newman", "link": "https://stackoverflow.com/users/2316586/arianna-newman"}, "edited": false, "score": 0, "creation_date": 1433309426, "post_id": 29502069, "comment_id": 49289879, "body": "Thank you for the help. I have used all this formula and it works :)"}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 1, "last_activity_date": 1428443730, "creation_date": 1428443730, "answer_id": 29502069, "question_id": 29500144, "link": "https://stackoverflow.com/questions/29500144/how-can-i-extract-a-text-that-has-a-specific-pattern-from-a-column-of-cells-usin/29502069#29502069", "title": "How can I extract a text that has a specific pattern from a column of cells using EXCEL formula?", "body": "<p>Although tagged with [excel-vba] you offer no code and do have <em>formula</em> in your Title, so I suggest:  </p>\n\n<ol>\n<li>Replace <code>@</code> with say <code>|@</code> where the first character is distinctive (working on a copy of your data, select all, HOME > Editing - Find &amp; Select, Replace..., Find what: <code>@</code> Replace with: <code>|@</code>, Replace All.)  </li>\n<li>Select the relevant column, DATA, Text to Columns, Delimited, Next, Delimiters Other: (only) <code>|</code> , Finish. </li>\n<li><p>In the first completely empty column:  </p>\n\n<pre><code>=IF(LEFT(A1)=\"@\",LEFT(A1,FIND(\" \",A1)),\"\") \n</code></pre></li>\n</ol>\n\n<p>copied across as many columns as previously were occupied and all formulae then copied down to suit.</p>\n\n<p>This should cope with an indeterminate number of <code>@</code> instances in any one cell and also where the last instance is not followed by a space.</p>\n"}], "owner": {"reputation": 57, "user_id": 2316586, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/12f968479e564a0f908627e6e3e0f956?s=128&d=identicon&r=PG", "display_name": "Arianna Newman", "link": "https://stackoverflow.com/users/2316586/arianna-newman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7111, "favorite_count": 0, "accepted_answer_id": 29500604, "answer_count": 3, "score": 1, "last_activity_date": 1428490175, "creation_date": 1428436464, "last_edit_date": 1531161705, "question_id": 29500144, "link": "https://stackoverflow.com/questions/29500144/how-can-i-extract-a-text-that-has-a-specific-pattern-from-a-column-of-cells-usin", "title": "How can I extract a text that has a specific pattern from a column of cells using EXCEL formula?", "body": "<p>Help please, I have a dataset that contains a column of text which contain users mentions and their tweets. I would like to extract all the users mentioned in the tweets in EXCEL. In another words, I would like to do this task: for each row in a column if the cell value of the row contains a text starts with @ and end with a space then put that string value in another column, each cell might contain more than one occurance of the string (more than one user mentioned in a tweet).The question is that possible to do with EXCEL formulas not with coding? If yes, would you please direct me to which formula I should use.. and if not, do you know a good way/method to accomplish this task? Please do not send me links to documentations, if you have a well documented code to do this task or know a software/tool that can do that it will be great. Thanks for your help in advance.</p>\n"}]