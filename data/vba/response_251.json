[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 0, "creation_date": 1572479159, "post_id": 58635000, "comment_id": 103577028, "body": "I&#39;m not sure if my way would be better, but I would likely do something like <code>For each rcell in rng</code> <code>Do check for filter criteria</code> <code>If True Then Copy to Offset Cell</code>"}, {"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 0, "creation_date": 1572479187, "post_id": 58635000, "comment_id": 103577035, "body": "There is no difference between your first and second set of sample data, I&#39;m having trouble understanding the final result expectations."}], "answers": [{"comments": [{"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 0, "creation_date": 1572479596, "post_id": 58635123, "comment_id": 103577120, "body": "So if there wasn&#39;t a bug, <code>FillRight</code> would be the correct tool? I just read the Microsoft Docs and the description didn&#39;t seem to fit the requested action. <code>The contents and formatting of the cell or cells in the leftmost column of a range are copied into the rest of the columns in the range.</code>"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 0, "creation_date": 1572479800, "post_id": 58635123, "comment_id": 103577147, "body": "@Free Seems to fit the OPs requirement to me.   I say bug because it behaves differently in VBA to in Excel (and the macro recorder records pretty much the code the OP posted, but it won&#39;t run on a fiilterd list)"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 0, "last_activity_date": 1572479293, "creation_date": 1572479293, "answer_id": 58635123, "question_id": 58635000, "link": "https://stackoverflow.com/questions/58635000/fill-column-b-with-column-a/58635123#58635123", "title": "Fill column B with column A", "body": "<p>Seems to be a bug in the VBA version of <code>FillRight</code>.</p>\n\n<p>Here's an alternative (which avoids that nasty Select / Selection)</p>\n\n<pre><code>Sub Demo()\n    Dim ws As Worksheet\n    Dim r As Range, cl As Range\n\n    Set ws = ActiveSheet ' or a specific sheet\n    Set r = ws.AutoFilter.Range.Columns(1).SpecialCells(xlCellTypeVisible)\n    For Each cl In r\n        cl.Offset(0, 1) = cl.Value ' or cl.Formula\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12300255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c3c967121f1236eee50b9218719d710?s=128&d=identicon&r=PG&f=1", "display_name": "curiousdesign", "link": "https://stackoverflow.com/users/12300255/curiousdesign"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 58635123, "answer_count": 1, "score": 1, "last_activity_date": 1572479293, "creation_date": 1572478277, "last_edit_date": 1572478831, "question_id": 58635000, "link": "https://stackoverflow.com/questions/58635000/fill-column-b-with-column-a", "title": "Fill column B with column A", "body": "<p>So, I have two columns. Column A has content with &lt;> tags and Column B has content with [].</p>\n\n<pre><code>1    &lt;hi&gt;     [hi]\n2    hello    bye\n3    &lt;/hi&gt;    [/hi]\n</code></pre>\n\n<p>Column B has a filter on top and both columns are filtered so that the cells with &lt;> and [] are left out, and then I select all Column A and move it to B (with the little 'plus' sign at the bottom or top of the selection). The ending result would be something like this, when unfiltered:</p>\n\n<pre><code>1    &lt;hi&gt;     [hi]\n2    hello    hello\n3    &lt;/hi&gt;    [/hi]\n</code></pre>\n\n<p>So I make a macro for this and it all works alright until it gets to <strong>Selection.FillRight</strong></p>\n\n<pre><code>  Selection.AutoFilter\n    ActiveSheet.Range(\"$B:$B\").AutoFilter Field:=1, Criteria1:=\"&lt;&gt;*[*\", _\n        Operator:=xlAnd\n    Range(\"A1:A25\").Select\n    Selection.FillRight\n    ActiveSheet.Range(\"$B:$B\").AutoFilter Field:=1\nEnd Sub\n</code></pre>\n\n<p>I've tried using this</p>\n\n<pre><code>Selection.AutoFilter\n    ActiveSheet.Range(\"B1:B\" &amp; Range(\"B\" &amp; Rows.Count).End(xlUp).Row)\n</code></pre>\n\n<p>or </p>\n\n<pre><code>Selection.AutoFilter\n    ActiveSheet.Range(\"$B$1:$B$25\")\n</code></pre>\n\n<p>instead but it won't work either. Any idea of how to fill all (filtered) content from Column A to Column B? Thank you!</p>\n"}, {"tags": ["vba", "ms-project"], "comments": [{"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 0, "creation_date": 1572478764, "post_id": 58634897, "comment_id": 103576938, "body": "I&#39;m not familiar with <code>Microsoft-Project</code> actually just watched a short YouTube video on it, so thanks for teaching me something new, but with Excel you would be looking for <code>Offset</code> to basically place a flag in the cell adjacent to the activecell you are searching for <code>InStr</code>"}], "answers": [{"tags": [], "owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1572479626, "creation_date": 1572479626, "answer_id": 58635175, "question_id": 58634897, "link": "https://stackoverflow.com/questions/58634897/how-to-set-flag-field-to-yes-or-no-based-on-text-input-microsoft-project-vba/58635175#58635175", "title": "How to Set Flag field to Yes or No Based on Text input - Microsoft-Project-VBA", "body": "<p>This code will set a Flag field (in this case <code>Flag1</code>). If the task Name field contains the desired text the Flag will be set to Yes, otherwise it will be No.</p>\n\n<pre><code>Sub FlagTasks()\n\n    Dim txt As String\n    txt = InputBox(\"Flag tasks that include the following text in their names:\")\n\n    Dim tsk As Task\n    For Each tsk In ActiveProject.Tasks\n        tsk.Flag1 = (0 &lt; InStr(1, tsk.Name, txt, 1))\n    Next tsk\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 8865493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a738c70b67a9d41571b35307b42b92cf?s=128&d=identicon&r=PG&f=1", "display_name": "boxue", "link": "https://stackoverflow.com/users/8865493/boxue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "accepted_answer_id": 58635175, "answer_count": 1, "score": 2, "last_activity_date": 1593558103, "creation_date": 1572477518, "last_edit_date": 1593558103, "question_id": 58634897, "link": "https://stackoverflow.com/questions/58634897/how-to-set-flag-field-to-yes-or-no-based-on-text-input-microsoft-project-vba", "title": "How to Set Flag field to Yes or No Based on Text input - Microsoft-Project-VBA", "body": "<p>I am trying to automate creating flag field based on if text is in the task description. The goal is to use text to search through  the project file and for each row with the text, in a flag field to put yes beside it.</p>\n\n<p>I am able to generate a list of the activites in MS project with the Row IDs.</p>\n\n<p>I am not sure how to use this list to generate \"yes No\" in Flag field</p>\n\n<pre><code>Sub Findtask()\nDim sTask As Task 'Summary level Task'\nDim aTask As Task 'Job level Task'\nDim Proj As Project \n\nx = InputBox$(\"Search for tasks that include the following text in their names:\") \nSet Proj = ActiveProject\n'Search for tasks tat include the following text in their names:\"'\nIf Not x = \"\" Then\n    For Each aTask In Proj.Tasks\n    If InStr(1, aTask.Name, x, 1) Then\n        y = y &amp; vbCrLf &amp; aTask.ID &amp; \": \" &amp; aTask.Name\n    End If\n    Next aTask\n    ' If No tasks exist then end'\n    If Len(y) = 0 Then\n        MsgBox \"No Tasks with the text\" &amp; x &amp; \" found in the project\", vbExclamation\n        Else\n            MsgBox y\n        End If\n    End If\nEnd Sub\n\n</code></pre>\n\n<p>See images below</p>\n\n<p><a href=\"https://i.stack.imgur.com/BzxS4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BzxS4.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/ZUus3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZUus3.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Example of this\n\nID    Task Name  Flag 1(Hydro)\n1     Hydro 1    Yes\n2     basket 1   No\n3     Hydro 2   Yes\n</code></pre>\n"}, {"tags": ["excel", "vba", "counter", "conditional-formatting"], "comments": [{"owner": {"reputation": 61, "user_id": 11212757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe430ed90b97e029389e850ef22f53e?s=128&d=identicon&r=PG&f=1", "display_name": "Byron", "link": "https://stackoverflow.com/users/11212757/byron"}, "edited": false, "score": 0, "creation_date": 1572476104, "post_id": 58634676, "comment_id": 103576281, "body": "also font color is set with conditional formatting."}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 1, "creation_date": 1572483610, "post_id": 58634676, "comment_id": 103577975, "body": "Can you post some sample data? I&#39;ve tested the code and it actually counts the cells correctly."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1572530046, "post_id": 58634676, "comment_id": 103594894, "body": "As conditional formatting is topical and the color of the cell is what is beneath the veneer, you will most likely need to check if the cell is conditionally formatted, or run your code to count where the same criteria as the conditional formatting is true."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1572530232, "post_id": 58634676, "comment_id": 103595009, "body": "Additionally, see <a href=\"https://stackoverflow.com/a/24338126/3233363\">this post</a> abotu some possibilities"}, {"owner": {"reputation": 61, "user_id": 11212757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe430ed90b97e029389e850ef22f53e?s=128&d=identicon&r=PG&f=1", "display_name": "Byron", "link": "https://stackoverflow.com/users/11212757/byron"}, "edited": false, "score": 0, "creation_date": 1572615412, "post_id": 58634676, "comment_id": 103623444, "body": "how can i post a screenshot? or can i?"}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1576641185, "post_id": 58634676, "comment_id": 104961895, "body": "<a href=\"https://stackoverflow.com/posts/58634676/edit\">Edit</a> the question and if you\u2019re on windows use ctrl + win + s and then on the post paste it directly"}], "owner": {"reputation": 61, "user_id": 11212757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe430ed90b97e029389e850ef22f53e?s=128&d=identicon&r=PG&f=1", "display_name": "Byron", "link": "https://stackoverflow.com/users/11212757/byron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576639671, "creation_date": 1572475861, "last_edit_date": 1576639671, "question_id": 58634676, "link": "https://stackoverflow.com/questions/58634676/how-to-count-cells-with-conditional-formatting-font-color", "title": "how to count cells with conditional formatting font color", "body": "<p>This code runs for 3 seconds without error. but i get no results.\ni should have over 1000 in count with font color red.</p>\n\n<pre><code>Sub Count_Flanges()\n\n    Application.ScreenUpdating = False\n\n    Dim Rng As Range\n    Dim lColorCounter As Long\n    Dim rngCell As Range\n\n    Set Rng = Sheets(\"master line list\").Range(\"C2:Z1633\")\n\n    lColorCounter = 0\n\n    For Each rngCell In Rng\n        If Cells(rngCell.Row, rngCell.Column).DisplayFormat.Font.Color = RGB(255, 0, 0) Then\n            lColorCounter = lColorCounter + 1\n        End If\n    Next\n\n    Sheets(\"status\").Range(\"D3\") = lColorCounter\n    Sheets(\"status\").Range(\"A1\") = lColorCounter / 2 &amp; \" \" &amp; \"Total Duplicates\"\n    Sheets(\"status\").Range(\"A2\") = Sheets(\"status\").Range(\"D5\").Value - lColorCounter / 2 &amp; \" \" &amp; \"Flanges\"\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "string"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1572483215, "post_id": 58634665, "comment_id": 103577891, "body": "What do you want for output?  Your question indicates you want to validate a string, which implies a simple binary response; but your code suggest you are looking for something different."}, {"owner": {"reputation": 3, "user_id": 5760036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/791e78bcfd2bbd05c0bf28dd5a1f48af?s=128&d=identicon&r=PG", "display_name": "drunk-monkey", "link": "https://stackoverflow.com/users/5760036/drunk-monkey"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1572551280, "post_id": 58634665, "comment_id": 103605399, "body": "there is a binary aspect to it, but there are multiple variables. The pass is if any of the key substrings are only included once in the chkstring. The fail is if any of the key substrings are duplicated in the chkstring"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1572551389, "post_id": 58634665, "comment_id": 103605457, "body": "Then, if you just want a <code>True</code> / <code>False</code> answer, the code I just undeleted will return <code>FALSE</code> if any substrings are repeated, else it will return <code>TRUE</code>.  If you are only looking for certain substrings, it can be easily modified."}], "answers": [{"comments": [{"owner": {"reputation": 1037, "user_id": 2388094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95154e5aa9ab2eaf53dd8fd4e2e6db83?s=128&d=identicon&r=PG", "display_name": "rayzinnz", "link": "https://stackoverflow.com/users/2388094/rayzinnz"}, "edited": false, "score": 0, "creation_date": 1572478288, "post_id": 58634912, "comment_id": 103576831, "body": "Sorry, also to check each phrase, change your <code>ElseIf</code> to individulal <code>If...End If</code> statements so each phrase is checked for. <code>ElseIf</code> will not be checked if a condition is matched earlier in the <code>If</code> chain"}, {"owner": {"reputation": 3, "user_id": 5760036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/791e78bcfd2bbd05c0bf28dd5a1f48af?s=128&d=identicon&r=PG", "display_name": "drunk-monkey", "link": "https://stackoverflow.com/users/5760036/drunk-monkey"}, "edited": false, "score": 0, "creation_date": 1572551407, "post_id": 58634912, "comment_id": 103605467, "body": "Thanks raysinnz, I think that will do it. I was probably trying to make it more complicated than it needed to be"}], "tags": [], "owner": {"reputation": 1037, "user_id": 2388094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95154e5aa9ab2eaf53dd8fd4e2e6db83?s=128&d=identicon&r=PG", "display_name": "rayzinnz", "link": "https://stackoverflow.com/users/2388094/rayzinnz"}, "is_accepted": true, "score": 2, "last_activity_date": 1572478544, "last_edit_date": 1572478544, "creation_date": 1572477629, "answer_id": 58634912, "question_id": 58634665, "link": "https://stackoverflow.com/questions/58634665/excel-vba-count-variable-substrings-in-a-string/58634912#58634912", "title": "Excel-VBA Count variable substrings in a string", "body": "<p>To count number of occurrences of a phrase in chkstring you can use this function</p>\n\n<pre><code>Function findOccurancesCount(chkstring, phrase)\n    findOccurancesCount = (Len(chkstring) - Len(Replace(chkstring, phrase, \"\"))) / Len(phrase)\nEnd Function\n</code></pre>\n\n<p>Then you can call like this, or some other way such as looping an array of phrases, depending on how many phrases you intend to check for:</p>\n\n<pre><code>Sub test(chkstring as String)\n    If findOccurancesCount(chkstring, \"BAG\") &gt; 1 _\n        Or findOccurancesCount(chkstring, \"NOTE\") &gt; 1 _\n        Or findOccurancesCount(chkstring, \"MEMO\") &gt; 1 _\n        Then\n        'highlight cell\n        Debug.Print \"highlight cell\"\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 185, "user_id": 10788327, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-W3IVKOR1B1Q/AAAAAAAAAAI/AAAAAAAAABI/iiyc6eWbnrw/photo.jpg?sz=128", "display_name": "mdelapena", "link": "https://stackoverflow.com/users/10788327/mdelapena"}, "is_accepted": false, "score": 0, "last_activity_date": 1572478124, "creation_date": 1572478124, "answer_id": 58634982, "question_id": 58634665, "link": "https://stackoverflow.com/questions/58634665/excel-vba-count-variable-substrings-in-a-string/58634982#58634982", "title": "Excel-VBA Count variable substrings in a string", "body": "<p>Try this function if you need something similar to what you already have</p>\n\n<pre><code>Function findOccurancesCount(chkstring, phrase)\n Dim residualString As String\n Dim OccurCount As Integer\n\n OccurCount = 0\n residualString = chkstring\n\n Do\n\n    foundPosition = InStr(1, residualString, phrase)                            'search phrase in residualString\n    If foundPosition &gt; 0 Then                                                   'substring is found at foundPosition index\n        OccurCount = OccurCount + 1                                             'count this occurance\n        residualString = Replace(residualString, phrase, \"\", foundPosition, 1)  'remove found phrase from residualString\n    End If\n Loop While foundPosition &lt;&gt; 0                                                   'loop until no phrase is found\n\n findOccurancesCount = OccurCount\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1572551717, "last_edit_date": 1572551717, "creation_date": 1572482933, "answer_id": 58635538, "question_id": 58634665, "link": "https://stackoverflow.com/questions/58634665/excel-vba-count-variable-substrings-in-a-string/58635538#58635538", "title": "Excel-VBA Count variable substrings in a string", "body": "<p>Here is a function that uses Regular Expressions to see if any word in the string occurs more than once.</p>\n\n<p>If there are no duplicate words --> <code>TRUE</code>, else <code>FALSE</code></p>\n\n<pre><code>Option Explicit\nFunction noDups(s As String) As Boolean\n    Dim RE As Object\n    Const sPat As String = \"(\\b\\w+\\b)(?=.*\\1)\"\n\nSet RE = CreateObject(\"vbscript.regexp\")\nWith RE\n    .Global = True\n    .Pattern = sPat\n    noDups = Not .test(s)\nEnd With\n\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/9bITh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9bITh.png\" alt=\"enter image description here\"></a></p>\n\n<p>If you are only looking for a few keywords to NOT be duplicated, then change the pattern:</p>\n\n<pre><code>eg:  sPat = \"(\\b(?:bag|note|memo)\\b)(?=.*\\1)\"\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5760036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/791e78bcfd2bbd05c0bf28dd5a1f48af?s=128&d=identicon&r=PG", "display_name": "drunk-monkey", "link": "https://stackoverflow.com/users/5760036/drunk-monkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 58634912, "answer_count": 3, "score": 0, "last_activity_date": 1572551717, "creation_date": 1572475791, "last_edit_date": 1572475808, "question_id": 58634665, "link": "https://stackoverflow.com/questions/58634665/excel-vba-count-variable-substrings-in-a-string", "title": "Excel-VBA Count variable substrings in a string", "body": "<p>I am using Excel VBA to validate the accuracy of a string. I need to make sure a variable substring is not duplicated. I have used a bulky ElseIf method, but it is missing instances where more than one substring was used. The first substring passed, but it does not loop back to check on the next substring.</p>\n\n<pre><code>Dim chkstring As String, phrase As String\n\nIf InStr(chkstring, \"BAG\") &gt; 0 Then\n        phrase = \"BAG\"\n    ElseIf InStr(chkstring, \"NOTE\") &gt; 0 Then\n        phrase = \"NOTE\"\n    ElseIf InStr(chkstring, \"MEMO\") &gt; 0 Then\n        phrase = \"MEMO\"\nElse\n        phrase = \"\"\n    End If\nIf phrase &lt;&gt; \"\" Then\n        OccurCount = findOccurancesCount(chkstring, phrase)\n        If OccurCount &gt; 1 Then\n            'highlight cell\n        End If\n    End If\n</code></pre>\n\n<p>Then I use</p>\n\n<pre><code>Function findOccurancesCount(chkstring, phrase)\n        OccurCount = 0\n        y = 1\n    Do\n    foundPosition = InStr(y, chkstring, phrase) 'searching from i position\n    If foundPosition &gt; 0 Then                       'substring is found at foundPosition index\n        OccurCount = OccurCount + 1       'count this occurance\n        y = foundPosition + 1                       'searching from x+1 on the next cycle\n    End If\n    Loop While foundPosition &lt;&gt; 0\nfindOccurancesCount = OccurCount\n\nEnd Function\n</code></pre>\n\n<p>This is fine if the chkstring = \"BAG BAG\"\nBut if there is more than one phrase it will not go back to look for others. \nFor example: \"BAG NOTE NOTE\"</p>\n\n<p>\"BAG\" passes the check, but it does not go back to look for \"NOTE\". </p>\n\n<p>I am wondering if there is a more effective way to combine all of the possible phrases then check to see if any of them are in the chkstring more than one?\nThanks!</p>\n"}, {"tags": ["excel", "vba", "pdf", "sendkeys"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1572473955, "post_id": 58634197, "comment_id": 103575707, "body": "Would you be helped reading <a href=\"http://myengineeringworld.net/2013/10/read-and-write-pdf-forms-from-excel-vba.html\" rel=\"nofollow noreferrer\">this</a> post so you can avoid <code>SendKeys</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1572473639, "creation_date": 1572473639, "answer_id": 58634353, "question_id": 58634197, "link": "https://stackoverflow.com/questions/58634197/sendkeys-not-capturing-all-data/58634353#58634353", "title": "SendKeys Not Capturing all Data", "body": "<p>You need to escape characters which have special significance to SendKeys, such as <code>%</code></p>\n\n<p>Try this:</p>\n\n<pre><code>v = Sheet10.Range(\"D3\").Value\n\nApplication.SendKeys Replace(v,\"%\",\"{%}\"), True\n</code></pre>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/sendkeys-statement\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/sendkeys-statement</a></p>\n\n<blockquote>\n  <p>The plus sign (+), caret (^), percent sign (%), tilde (~), and parentheses ( ) have special meanings to SendKeys. To specify one of these characters, enclose it within braces ({}). For example, to specify the plus sign, use {+}.</p>\n</blockquote>\n"}], "owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 58634353, "answer_count": 1, "score": 0, "last_activity_date": 1572473639, "creation_date": 1572472670, "last_edit_date": 1572473491, "question_id": 58634197, "link": "https://stackoverflow.com/questions/58634197/sendkeys-not-capturing-all-data", "title": "SendKeys Not Capturing all Data", "body": "<p>I'm using VBA code to take data from excel and populate a pdf from using SendKeys.\nThis works for 99% of all of my data, but I'm noticing in some instances, the data from excel is not fully transferring to the PDF. </p>\n\n<p>For example, in cell D3, I have the text \"17.04% / 17.84%\" (note- this is a text field, so minus the quotes, this is exactly how the text is formatted).</p>\n\n<p>When I run this code:</p>\n\n<pre><code>Application.SendKeys Sheet10.Range(\"D3\").Value, True\nApplication.Wait Now + 0.00001\n</code></pre>\n\n<p>The result is \"17.04\", leaving the percentage signs and the other half of the text.</p>\n\n<p>I know that sendkeys is known to be problematic, so is there an alternative way of transferring excel data to pdf? </p>\n\n<p>If not, is there a way to have the sendkeys capture the full text? I tried adding the \"Application.Wait Now + 0.00001\" but this doesn't seem to solve the issue.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1572473842, "post_id": 58633894, "comment_id": 103575673, "body": "If you just open the file directly in excel is it parsed correctly?"}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1572477408, "post_id": 58633894, "comment_id": 103576621, "body": "Sanitize your data before you import it. If it&#39;s not formatted correctly you should handle that at the source, not here at the end."}, {"owner": {"reputation": 1, "user_id": 12299880, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-v3BhvAUQD2g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdZGiXLS7VkxV067g-k0_BLrYbe_Q/photo.jpg?sz=128", "display_name": "DP303030", "link": "https://stackoverflow.com/users/12299880/dp303030"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1572478643, "post_id": 58633894, "comment_id": 103576909, "body": "@Tim - Saving as an excel file or opening in excel does not display the text correctly."}, {"owner": {"reputation": 1, "user_id": 12299880, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-v3BhvAUQD2g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdZGiXLS7VkxV067g-k0_BLrYbe_Q/photo.jpg?sz=128", "display_name": "DP303030", "link": "https://stackoverflow.com/users/12299880/dp303030"}, "reply_to_user": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1572478686, "post_id": 58633894, "comment_id": 103576923, "body": "@HackSlash - I&#39;m unable to change the source and can not open the raw data. Opening in wordpress or notepad opens gibberish"}, {"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 0, "creation_date": 1572498240, "post_id": 58633894, "comment_id": 103580757, "body": "@DP303030 A CSV file is just text with a comma delimiter. Opening in a basic notepad program should produce a readable file. Albiet not easy to read, but also not &quot;gibberish&quot;. Can you post some sample data?"}], "owner": {"reputation": 1, "user_id": 12299880, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-v3BhvAUQD2g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdZGiXLS7VkxV067g-k0_BLrYbe_Q/photo.jpg?sz=128", "display_name": "DP303030", "link": "https://stackoverflow.com/users/12299880/dp303030"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572471802, "creation_date": 1572470953, "last_edit_date": 1572471802, "question_id": 58633894, "link": "https://stackoverflow.com/questions/58633894/how-to-use-a-vba-to-combine-rows-that-are-prematurely-broken-from-a-csv", "title": "How to use a VBA to combine rows that are prematurely broken from a CSV?", "body": "<p>I have a CSV showing purchase information, but in each line the data must have too many commas as a few extra breaks are added in. In this case, row 1 is the header. Rows 2-5 should be merged into one, and the blank row 6 shouldn't exist.\nHere's what the data looks like in the \"Get Data\" feature in Excel before being input</p>\n\n<p><a href=\"https://i.stack.imgur.com/TAIHD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TAIHD.png\" alt=\"enter image description here\"></a></p>\n\n<p>I think the solution provided here is close to what I need to do, but as someone who's never written a Macro I was wondering if someone can provide a more specific solution.\n<a href=\"https://superuser.com/questions/395126/how-to-combine-values-from-multiple-rows-into-a-single-row-in-excel\">https://superuser.com/questions/395126/how-to-combine-values-from-multiple-rows-into-a-single-row-in-excel</a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1572471082, "creation_date": 1572471082, "answer_id": 58633917, "question_id": 58633843, "link": "https://stackoverflow.com/questions/58633843/vba-macro-got-me-stumped/58633917#58633917", "title": "VBA Macro got me stumped", "body": "<p>Try this:</p>\n\n<pre><code>Sub Copy_Rename()\n    Dim sht As Worksheet\n    Set sht = ActiveSheet\n    Application.CopyObjectsWithCells = True '&lt;&lt; to also copy objects not just cell contents etc\n    sht.Copy before:=sht\n    'Get the just-created sheet\n    With Sheets(sht.Index - 1)\n        .Name = sht.Range(\"C2\").Value\n        .Activate\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9589917, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Brian Davies", "link": "https://stackoverflow.com/users/9589917/brian-davies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 58633917, "answer_count": 1, "score": 0, "last_activity_date": 1572471446, "creation_date": 1572470638, "last_edit_date": 1572471446, "question_id": 58633843, "link": "https://stackoverflow.com/questions/58633843/vba-macro-got-me-stumped", "title": "VBA Macro got me stumped", "body": "<p>I'm using a macro to make a copy of the active sheet, and rename it to whatever the value of cell 'C2' is. The only problem is, that when it copies the sheet, it somehow removes the form buttons from the top of my worksheet and replaces them with the code =$c$2 in cell 'AF'.</p>\n\n<p>As far as i can see from the VBA code there is nothing that refers to the cell 'AF'. Can anyone tell me why it's doing this ?</p>\n\n<pre><code>Sub Copy_Rename()\n    Dim shtName As String\n    shtName = ActiveSheet.Name\n    ActiveSheet.Copy before:=ActiveSheet\n    ActiveSheet.Name = Range(\"C2\").Value\n    Sheets(shtName).Activate\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12120322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/163012aac57df707a94d350d4b47d03d?s=128&d=identicon&r=PG&f=1", "display_name": "TArevalo", "link": "https://stackoverflow.com/users/12120322/tarevalo"}, "edited": false, "score": 0, "creation_date": 1572473113, "post_id": 58634071, "comment_id": 103575447, "body": "Thank you for your response. I see what you are saying. When I run this code I am getting Run-time error &#39;53&#39;: File not found."}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1572475197, "post_id": 58634071, "comment_id": 103576038, "body": "did you change the path names?"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1572507508, "post_id": 58634071, "comment_id": 103583350, "body": "I have updated the code above. The second to last line is now a bit better"}, {"owner": {"reputation": 3, "user_id": 12120322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/163012aac57df707a94d350d4b47d03d?s=128&d=identicon&r=PG&f=1", "display_name": "TArevalo", "link": "https://stackoverflow.com/users/12120322/tarevalo"}, "edited": false, "score": 0, "creation_date": 1572540727, "post_id": 58634071, "comment_id": 103600859, "body": "Thank you for the update. From what I can tell it looks like this should work. Now I am getting a Runtime error &#39;70&#39;: Permission Denied. I wasn&#39;t getting this error when the macro was copying over one file at a time, so not sure why that&#39;s happening. Thanks"}, {"owner": {"reputation": 3, "user_id": 12120322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/163012aac57df707a94d350d4b47d03d?s=128&d=identicon&r=PG&f=1", "display_name": "TArevalo", "link": "https://stackoverflow.com/users/12120322/tarevalo"}, "edited": false, "score": 0, "creation_date": 1572544147, "post_id": 58634071, "comment_id": 103602366, "body": "From what I have read, this is occurring because of a Windows security update from 2017. Windows recommends changing the code to use Windows API CoCreateGuid instead of \u201cCreateObject"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1572545030, "post_id": 58634071, "comment_id": 103602720, "body": "It&#39;s better if you add a reference to it. Have a look here: <a href=\"https://support.microsoft.com/en-us/help/186118/how-to-use-filesystemobject-with-visual-basic\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/help/186118/&hellip;</a>"}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1572507468, "last_edit_date": 1572507468, "creation_date": 1572471861, "answer_id": 58634071, "question_id": 58633757, "link": "https://stackoverflow.com/questions/58633757/copy-files-frompath-to-folders-using-text-in-the-file-name-as-the-variable-to-de/58634071#58634071", "title": "Copy files FromPath to folders using text in the file name as the variable to determine ToPath location", "body": "<p>I don't think you can use wildcard copy in your case. If you first copy FL, AZ, CA, CO and MN to their location, they will be copied once again, since you can't make a negative wildcard for all the rest. Differently put - FL will be part of all the rest, too. Had you moved it instead, it would have worked.<br>\nNow, you can't build that kind of wildcards with FSO. Instead you will have to process them one at a time, like this (slightly simplified):</p>\n\n<pre><code>Dim FSO As Object\nDim FromPath As String\nDim ToPath As String\nDim FileName As String\n\nFromPath = \"C:\\Users\\Name\\Desktop\\Master File\"\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\n\nFor Each File In FSO.GetFolder(FromPath).Files\n\n    Select Case Mid(File.Name, 5, 2)\n        Case \"FL\"\n            ToPath = \"FL\"\n        Case \"AZ\", \"CA\", \"CO\", \"NM\"\n            ToPath = \"Main\"\n        Case Else\n            ToPath = \"Secondary\"\n    End Select\n    ToPath = \"C:\\Users\\Name\\Desktop\\SharePoint\\\" &amp; ToPath\n\n    FSO.CopyFile FromPath &amp; \"\\\" &amp; File.Name, ToPath\nNext\n</code></pre>\n\n<p>The <code>Select Case</code> statement picks letter 5-6 and checks. It might be too specific for your case, but I think you get the point. </p>\n"}], "owner": {"reputation": 3, "user_id": 12120322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/163012aac57df707a94d350d4b47d03d?s=128&d=identicon&r=PG&f=1", "display_name": "TArevalo", "link": "https://stackoverflow.com/users/12120322/tarevalo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1582954785, "creation_date": 1572470162, "last_edit_date": 1582954785, "question_id": 58633757, "link": "https://stackoverflow.com/questions/58633757/copy-files-frompath-to-folders-using-text-in-the-file-name-as-the-variable-to-de", "title": "Copy files FromPath to folders using text in the file name as the variable to determine ToPath location", "body": "<p>I want to copy pdf files in one master folder to several other locations.</p>\n\n<p>There is a segment of this macro where the files need to be copied to three different folders according to the state abbreviations in the file name.</p>\n\n<ul>\n<li>Files containing AZ, CA, CO, and NM go in the \"Main\" folder.</li>\n<li>Files containing FL go in the \"FL\" folder</li>\n<li>All other state abbreviations go in the \"Secondary\" folder. </li>\n</ul>\n\n<p>How do I list multiple state abbreviation at once and move those files.</p>\n\n<pre><code>Sub Copy_Certain_Files_In_Folder()\n\n    Dim FSO As Object\n    Dim FromPath As String\n    Dim ToPath As String\n    Dim FileName As String\n\n    FromPath = \"C:\\Users\\Name\\Desktop\\Master File\"  '&lt;&lt; Change\n    ToPath = \"C:\\Users\\Name\\Desktop\\SharePoint\\Main\"    '&lt;&lt; Change\n\n    FileName = \"DOC-AZ*\" Or \"DOC-CA*\" Or \"DOC-CO*\" Or \"DOC-NM*\"\n\n    If Right(FromPath, 1) &lt;&gt; \"\\\" Then\n        FromPath = FromPath &amp; \"\\\"\n    End If\n\n    Set FSO = CreateObject(\"scripting.filesystemobject\")\n\n    If FSO.FolderExists(FromPath) = False Then\n        MsgBox FromPath &amp; \" doesn't exist\"\n        Exit Sub\n        End If\n\n    If FSO.FolderExists(ToPath) = False Then\n        MsgBox ToPath &amp; \" doesn't exist\"\n        Exit Sub\n    End If\n\n    FSO.CopyFile Source:=FromPath &amp; FileName, Destination:=ToPath\n\n    MsgBox \"You can find the files from \" &amp; FromPath &amp; \" in \" &amp; ToPath\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1572469496, "post_id": 58633484, "comment_id": 103574248, "body": "&quot;not working&quot; is not helpful. Please elaborate - error message, not doing what you want? Also your logic is not clear. And you need to allow for Elses, eg if A is not AA1."}, {"owner": {"reputation": 97, "user_id": 4381683, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/02a8a5eb35f36c442ffa7811c2e01d03?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/4381683/john"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1572471614, "post_id": 58633484, "comment_id": 103574971, "body": "@SJR there is no error message.When I choose a needed value, column B and C are not updated (still same value)."}, {"owner": {"reputation": 97, "user_id": 4381683, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/02a8a5eb35f36c442ffa7811c2e01d03?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/4381683/john"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1572507036, "post_id": 58633484, "comment_id": 103583185, "body": "It is working now (typing error). Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 4381683, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/02a8a5eb35f36c442ffa7811c2e01d03?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/4381683/john"}, "edited": false, "score": 0, "creation_date": 1572471638, "post_id": 58633770, "comment_id": 103574979, "body": "Thanks I do the change"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 2, "last_activity_date": 1572470238, "creation_date": 1572470238, "answer_id": 58633770, "question_id": 58633484, "link": "https://stackoverflow.com/questions/58633484/change-columns-value-based-on-another-cell/58633770#58633770", "title": "Change columns value based on another cell", "body": "<p>Your code is broadly OK, except it will cause an Event Cascade (changing a cell triggers the <code>Worksheet_Change</code> event, which changes a cell, which triggers <code>Worksheet_Change</code>, which ...)</p>\n\n<p>You need to add <code>Application.EnableEvents = False</code> to prevent this (add <code>... = True</code> at the end)</p>\n\n<p>Here's your code refactored to address this, and a few other minor issues</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim changedCells As Range\n\n    On Error GoTo EH '~~ ensure EnableEvents is turned back on if an error occurs\n\n    Set changedCells = Me.Range(\"A:C\") '~~ explicitly refer to the correct sheet\n\n    If Target.Count &gt; 1 Then Exit Sub '~~ do this first, to speed things up\n\n    If Not Application.Intersect(changedCells, Target) Is Nothing Then '~~ Target is already a range\n        Application.EnableEvents = False '~~ prevent an event cascade\n\n        '~~ original If Then Else works fine.  But can be simplified\n        Select Case LCase(Target.Value)\n            Case \"aa1\"\n                If Target.Column = 1 Then\n                    Me.Cells(Target.Row, 2) = \"BB2\"\n                    Me.Cells(Target.Row, 3) = \"CC1\"\n                End If\n            Case \"bb1\"\n                If Target.Column = 2 Then\n                    Me.Cells(Target.Row, 1) = \"AA3\"\n                    Me.Cells(Target.Row, 3) = \"CC2\"\n                End If\n            Case \"cc2\"\n                If Target.Column = 3 Then\n                    Me.Cells(Target.Row, 1) = \"AA2\"\n                    Me.Cells(Target.Row, 2) = \"BB2\"\n                End If\n        End Select\n    End If\n\n'~~ Fall through to EnableEvents\nEH:\n    Application.EnableEvents = True '~~ ensure EnableEvents is turned back on\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 4381683, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/02a8a5eb35f36c442ffa7811c2e01d03?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/4381683/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "accepted_answer_id": 58633770, "answer_count": 1, "score": 0, "last_activity_date": 1572470238, "creation_date": 1572468766, "question_id": 58633484, "link": "https://stackoverflow.com/questions/58633484/change-columns-value-based-on-another-cell", "title": "Change columns value based on another cell", "body": "<p>I want to update 2 columns values based on another columns value (if value change). Suppose I have column A with a list (AA1, AA2, AA3), column B with a list (BB1, BB2), column C with a list (CC1, CC2). If a choose a value \"AA1\" from column A then Column B value should change to BB2 et column C to CC1. But nothing should happen if the value chosen in column A is different from \"AA1\". The same process occurs also for value \"BB1\" in column B. I added a vba but it not working. Also is there another way to do it without running a vba code ? Thanks</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n   Dim changedCells As Range\n   Set changedCells = Range(\"A:C\")\n\n   If Not Application.Intersect(changedCells, Range(Target.Address)) Is Nothing Then\n\n      If Target.Count &gt; 1 Then Exit Sub\n\n      If Target.Column = 1 And LCase(Target.Value) = \"aa1\"Then\n            Cells(Target.Row, 2) = \"BB2\"\n            Cells(Target.Row, 3) = \"CC1\"\n      ElseIf Target.Column = 2 And LCase(Target.Value) = \"bb1\" Then\n           Cells(Target.Row, 1) = \"AA3\"\n           Cells(Target.Row, 3) = \"CC2\"\n       ElseIf Target.Column = 3 And LCase(Target.Value) = \"cc2\" Then\n           Cells(Target.Row, 1) = \"AA2\"\n           Cells(Target.Row, 2) = \"BB2\"\n        End If\n End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1572469315, "post_id": 58633441, "comment_id": 103574169, "body": "Well what&#39;s the rule, is ID the only exception?"}], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1572470633, "post_id": 58633691, "comment_id": 103574644, "body": "Brilliant formula. The function would have to wrap around OP&#39;s existing function I think as the string doesn&#39;t have any spaces?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1572470709, "post_id": 58633691, "comment_id": 103574673, "body": "@SJR yes it does, <code>strArr = Split(SplitCaps(str), &quot; &quot;)</code> calls the existing function."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1572470837, "post_id": 58633691, "comment_id": 103574717, "body": "Bah, sorry missed that."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1572470325, "last_edit_date": 1572470325, "creation_date": 1572469754, "answer_id": 58633691, "question_id": 58633441, "link": "https://stackoverflow.com/questions/58633441/splitting-a-string-and-capitalizing-letters-based-on-cases/58633691#58633691", "title": "Splitting a string and capitalizing letters based on cases", "body": "<p>split the word and loop the results and test whether it is all caps before using Proper.  then join them back:</p>\n\n<pre><code>Sub kjl()\nDim str As String\nstr = \"partID\"\n\nDim strArr() As String\nstrArr = Split(SplitCaps(str), \" \")\n\nDim i As Long\nFor i = 0 To UBound(strArr)\n    If UCase(strArr(i)) &lt;&gt; strArr(i) Then\n        strArr(i) = Application.Proper(strArr(i))\n    End If\nNext i\n\nstr = Join(strArr, \" \")\n\nDebug.Print str\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>If you want a formula to do what you are asking then:</p>\n\n<pre><code>=TEXTJOIN(\" \",TRUE,IF(EXACT(UPPER(TRIM(MID(SUBSTITUTE(SplitCaps(A1),\" \",REPT(\" \",999)),{1,999},999))),TRIM(MID(SUBSTITUTE(SplitCaps(A1),\" \",REPT(\" \",999)),{1,999},999))),TRIM(MID(SUBSTITUTE(SplitCaps(A1),\" \",REPT(\" \",999)),{1,999},999)),PROPER(TRIM(MID(SUBSTITUTE(SplitCaps(A1),\" \",REPT(\" \",999)),{1,999},999)))))\n</code></pre>\n\n<p>Entered as an array formula by confirming with Ctrl-Shift-Enter instead of Enter when exiting edit mode.</p>\n\n<p><a href=\"https://i.stack.imgur.com/KENoJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KENoJ.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>Or use the code above as a Function:</p>\n\n<pre><code>Function propSplitCaps(str As String)\n\nDim strArr() As String\nstrArr = Split(SplitCaps(str), \" \")\n\nDim i As Long\nFor i = 0 To UBound(strArr)\n    If UCase(strArr(i)) &lt;&gt; strArr(i) Then\n        strArr(i) = Application.Proper(strArr(i))\n    End If\nNext i\n\npropSplitCaps = Join(strArr, \" \")\nEnd Function\n</code></pre>\n\n<p>and call it <code>=propSplitCaps(A1)</code></p>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 1, "last_activity_date": 1572481608, "creation_date": 1572481608, "answer_id": 58635390, "question_id": 58633441, "link": "https://stackoverflow.com/questions/58633441/splitting-a-string-and-capitalizing-letters-based-on-cases/58635390#58635390", "title": "Splitting a string and capitalizing letters based on cases", "body": "<p>Instead of using the <code>Proper</code> function, just capitalize the first letter of each word after you have split the string on the transition.</p>\n\n<pre><code>Option Explicit\nFunction Cap(s As String) As String\n    Dim RE As RegExp, MC As MatchCollection, M As Match\n    Const sPatSplit = \"([a-z])([A-Z])\"\n    Const sPatFirstLtr As String = \"\\b(\\w)\"\n    Const sSplit As String = \"$1 $2\"\nSet RE = New RegExp\nWith RE\n    .Global = True\n    .Pattern = sPatSplit\n    .IgnoreCase = False\n    If .Test(s) = True Then\n        s = .Replace(s, sSplit)\n\n        .Pattern = sPatFirstLtr\n        Set MC = .Execute(s)\n        For Each M In MC\n            s = WorksheetFunction.Replace(s, M.FirstIndex + 1, 1, UCase(M))\n        Next M\n    End If\nEnd With\n\nCap = s\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/2xf9k.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2xf9k.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 85, "user_id": 11896267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd28d3bc9c412b423aa684cff753d317?s=128&d=identicon&r=PG&f=1", "display_name": "Tony23", "link": "https://stackoverflow.com/users/11896267/tony23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 58633691, "answer_count": 2, "score": -1, "last_activity_date": 1572481608, "creation_date": 1572468563, "last_edit_date": 1572471637, "question_id": 58633441, "link": "https://stackoverflow.com/questions/58633441/splitting-a-string-and-capitalizing-letters-based-on-cases", "title": "Splitting a string and capitalizing letters based on cases", "body": "<p>I have some column names with starting coding convention that I would like to transform, see example:  </p>\n\n<pre><code>   Original        Target     \n ------------- -------------- \n  partID        Part ID       \n  completedBy   Completed By \n</code></pre>\n\n<p>I have a function in VBA that splits the original string by capital letters:</p>\n\n<pre><code>Function SplitCaps(strIn As String) As String\nDim objRegex As Object\nSet objRegex = CreateObject(\"vbscript.regexp\")\nWith objRegex\n    .Global = True\n    .Pattern = \"([a-z])([A-Z])\"\n    SplitCaps = .Replace(strIn, \"$1 $2\")\nEnd With\nEnd Function\n</code></pre>\n\n<p>I wrap this function within PROPER, for example, PROPER(SplitCaps(A3)) produces the desired result for the third row but leaves the \"D\" in ID uncapitalized.</p>\n\n<pre><code>   Original        Actual    \n ------------- -------------- \n  partID        Part Id       \n  completedBy   Completed By \n</code></pre>\n\n<p>Can anyone think of a solution to add cases to this function?</p>\n"}, {"tags": ["vba", "ms-project"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12276169, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBMVP_3BmAHtlHjhV6N9pVwNiFrjf_GbpkKL7cswA=k-s128", "display_name": "Travis May", "link": "https://stackoverflow.com/users/12276169/travis-may"}, "edited": false, "score": 0, "creation_date": 1572474034, "post_id": 58633888, "comment_id": 103575737, "body": "Thanks you @Rachel.  I went with the second option as I do not want the schedule to automatically expand in the first option.  Also, my end goal is for this macro to run automatically when a Summary Task is created."}], "tags": [], "owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "is_accepted": true, "score": 0, "last_activity_date": 1572470916, "creation_date": 1572470916, "answer_id": 58633888, "question_id": 58633262, "link": "https://stackoverflow.com/questions/58633262/macro-to-color-summary-tasks-is-90-working-cannot-figure-out-why-it-is-not-100/58633888#58633888", "title": "Macro to color Summary Tasks is 90% working, cannot figure out why it is not 100% working", "body": "<p>The issue stems from the fact that the code is looping through tasks in two different ways. Looping through the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/project.tasks(object)\" rel=\"nofollow noreferrer\">task collection</a> will go through <strong><em>every task</em></strong> whether visible or not. Using the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/project.application.selectrow\" rel=\"nofollow noreferrer\">SelectRow</a> method works on <strong><em>visible tasks only</em></strong>.</p>\n\n<p>The simplest way to get these two methods in sync is to start by showing all tasks. Put this code before your loop*:</p>\n\n<pre><code>FilterApply \"All Tasks\"\nSelectAll\nOutlineShowAllTasks\nSelectBeginning\n</code></pre>\n\n<p>* Note that this presumes a task view is active and that Group By is set to [No Group].</p>\n\n<p>Alternatively, you can select the desired task by using the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/project.application.find\" rel=\"nofollow noreferrer\">Find</a> method rather than using SelectRow.  FYI: This will skip summary tasks that are not visible.</p>\n\n<pre><code>Sub ColorSummaryTasks()\n Dim t As Task\n\n For Each t In ActiveProject.Tasks\n\n     If t.Summary Then\n\n         Find Field:=\"Unique ID\", Test:=\"equals\", Value:=t.UniqueID\n         If ActiveCell.Task.UniqueID = t.UniqueID Then\n\n             Select Case t.OutlineLevel\n                 ' code here\n             End Select\n\n        End If\n\n     End If\n\n Next t\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12276169, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBMVP_3BmAHtlHjhV6N9pVwNiFrjf_GbpkKL7cswA=k-s128", "display_name": "Travis May", "link": "https://stackoverflow.com/users/12276169/travis-may"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 58633888, "answer_count": 1, "score": 0, "last_activity_date": 1593558166, "creation_date": 1572467671, "last_edit_date": 1593558166, "question_id": 58633262, "link": "https://stackoverflow.com/questions/58633262/macro-to-color-summary-tasks-is-90-working-cannot-figure-out-why-it-is-not-100", "title": "Macro to color Summary Tasks is 90% working, cannot figure out why it is not 100% working", "body": "<p>The below code works only if all Summary Tasks are completely expanded.  If any of the Summary Tasks are collapsed the codes faults.</p>\n\n<p>I do not know what to even try in order to fix this issue.</p>\n\n<pre><code> Sub ColorSummaryTasks()\n Dim t As Task\n Dim i As Integer\n\n i = 1\n For Each t In ActiveProject.Tasks\n\n     If t.Summary Then\n\n         SelectRow row:=i, rowrelative:=False\n\n         Select Case t.OutlineLevel\n             Case 1\n             Font32Ex CellColor:=&amp;H1099FF   'Hex code needs to be reversed\n             Case 2\n             Font32Ex CellColor:=&amp;HFF9900\n             Case 3\n             Font32Ex CellColor:=&amp;H66FF66\n             Case 4\n             Font32Ex CellColor:=&amp;H10CC99\n             Case 5\n             Font32Ex CellColor:=&amp;HDD3377\n             Case 6\n             Font32Ex CellColor:=&amp;HFF00FF\n\n         End Select\n\n     End If\n\n i = i + 1\n Next t\n End Sub\n</code></pre>\n\n<p>The expected result is for the code to work whether the Summary Tasks are expanded or not.  What is happening is if there are 3 collapsed rows under a Summary Task it will not color the next 3 un-collapsed rows whether they are Summary Tasks or not.  The Imgur link shows what happens when the macros is ran with the Summary Tasks both collapsed and open.  <a href=\"https://imgur.com/a/3stezhQ\" rel=\"nofollow noreferrer\">https://imgur.com/a/3stezhQ</a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "edited": false, "score": 0, "creation_date": 1572466944, "post_id": 58633037, "comment_id": 103573178, "body": "Tried to run this code but I got: Run-time error &#39;1004&#39;"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "edited": false, "score": 0, "creation_date": 1572467053, "post_id": 58633037, "comment_id": 103573222, "body": "Do you have an actual table (<code>ListObject</code>), or are you dealing with a range named &quot;table3&quot;?"}, {"owner": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "edited": false, "score": 0, "creation_date": 1572467265, "post_id": 58633037, "comment_id": 103573292, "body": "There is an actual table &quot;Table 3&quot;"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "edited": false, "score": 0, "creation_date": 1572467335, "post_id": 58633037, "comment_id": 103573321, "body": "Then change <code>Range(&quot;G:G&quot;)</code> to something like <code>myTbl.ListColumns(&quot;columnname&quot;).DataBodyRange</code>, where <code>myTbl</code> is the <code>ListObject</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "edited": false, "score": 0, "creation_date": 1572469026, "post_id": 58633037, "comment_id": 103574046, "body": "@icalderon in certain circumstances, deleting an entire row will fail if a <code>ListObject</code> is involved - consider iterating the <code>ListRows</code> instead, and invoking <code>ListRow.Delete</code> to delete the <i>table row</i> (not the entire <i>worksheet row</i>)."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1572469823, "post_id": 58633037, "comment_id": 103574355, "body": "Yep @MathieuGuindon I suspect this may be the case here."}, {"owner": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1572524783, "post_id": 58633037, "comment_id": 103591905, "body": "Thank you BigBen and @MathieuGuindon. I&#39;m still fairly new to vba, how can I got about doing what you suggested?"}, {"owner": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "edited": false, "score": 0, "creation_date": 1572530164, "post_id": 58633037, "comment_id": 103594965, "body": "I changed the sheet name to <i>Kit_db</i> where the table is located but a &#39;Run-time error &#39;424&#39;&#39; pops up.   <code>Dim myTbl As ListObject     Set myTbl = Kit_db.ListObjects(&quot;Table3&quot;) &#39; change sheet as necessary</code>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1572530247, "post_id": 58633037, "comment_id": 103595018, "body": "You need to use the sheet <i>code</i> name, not the sheet name. The code name can be found in the VB Editor, either from the Project Explorer or Properties Window."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1572530576, "post_id": 58633037, "comment_id": 103595186, "body": "Great! Glad to help."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1572525694, "last_edit_date": 1572525694, "creation_date": 1572466640, "answer_id": 58633037, "question_id": 58632970, "link": "https://stackoverflow.com/questions/58632970/how-to-delete-a-row-if-there-is-no-value-in-a-column/58633037#58633037", "title": "How to delete a row if there is no value in a column?", "body": "<p>Two small changes:</p>\n\n<pre><code>Sub Test2()\n\n    Dim rng As Range\n    On Error Resume Next\n    Set rng = Range(\"G:G\").SpecialCells(xlCellTypeBlanks)\n    On Error GoTo 0\n\n    If Not rng Is Nothing Then\n        rng.EntireRow.Delete Shift:=xlShiftUp\n    End If\n\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>If you want to work directly with the table, then consider iterating over the <code>ListRows</code> of the table in question, something like this:</p>\n\n<pre><code>Sub Test2()\n    Dim myTbl As ListObject\n    Set myTbl = Sheet1.ListObjects(\"table3\") ' change sheet as necessary\n\n    Dim indx As Long\n    indx = myTbl.ListColumns(\"ColumnName\").Index\n\n    Dim rngToDelete As Range\n\n    Dim myRw As ListRow\n    For Each myRw In myTbl.ListRows\n        If IsEmpty(myRw.Range(1, indx).Value) Then\n            If rngToDelete Is Nothing Then\n                Set rngToDelete = myRw.Range\n            Else\n                Set rngToDelete = Union(rngToDelete, myRw.Range)\n            End If\n        End If\n    Next myRw\n\n    If Not rngToDelete Is Nothing Then\n        rngToDelete.Delete Shift:=xlShiftUp\n    End If\nEnd Sub\n</code></pre>\n\n<p>Note: Technically, it's <code>xlShiftUp</code>, not <code>xlUp</code>. </p>\n"}], "owner": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 58633037, "answer_count": 1, "score": 0, "last_activity_date": 1572525694, "creation_date": 1572466361, "last_edit_date": 1572466657, "question_id": 58632970, "link": "https://stackoverflow.com/questions/58632970/how-to-delete-a-row-if-there-is-no-value-in-a-column", "title": "How to delete a row if there is no value in a column?", "body": "<p>I'm trying to delete rows in table if there is no value in a certain column.</p>\n\n<p>I've used a code that deletes rows if there is one cell value missing, but I would like to delete rows if a cell does not contain a value in a certain column.</p>\n\n<p>For example, if there is no value in Column G Row 5 then I want to delete the entire row.</p>\n\n<pre><code>Sub Test2()\n\n  Dim rng As Range\n  On Error Resume Next\n  Set rng = Range(\"Table3\").SpecialCells(xlCellTypeBlanks)\n  On Error GoTo 0\n  If Not rng Is Nothing Then\n    rng.Delete Shift:=xlUp\n  End If\n\nEnd Sub\n</code></pre>\n\n<p>This deletes all rows with any type of missing cell value.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1572463830, "post_id": 58632432, "comment_id": 103571928, "body": "You can&#39;t compare an entire column to  a <code>String</code>. Perhaps filter on that column and then delete visible rows."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1572464132, "post_id": 58632432, "comment_id": 103572051, "body": "Use the macro recorder or look at similar questions here on SO about filtering and deleting."}, {"owner": {"reputation": 11, "user_id": 10475137, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215377096053405/picture?type=large", "display_name": "Broten Togstad", "link": "https://stackoverflow.com/users/10475137/broten-togstad"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1572464634, "post_id": 58632432, "comment_id": 103572252, "body": "Okay, so just have it auto filter the rows that have Decline and Void then you have to delete them manually? Is there a way to tell the macro to find the last row then stop because the amount of rows for this sheet changes everyday so I just have to set to a number that would never get reached, then I go back and undo it to the last row."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1572464694, "post_id": 58632432, "comment_id": 103572271, "body": "See <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-excel-with-vba\">this question</a> for how to find the last row."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1572464724, "post_id": 58632432, "comment_id": 103572291, "body": "@BrotenTogstad or just see my answer for the last row"}, {"owner": {"reputation": 11, "user_id": 10475137, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215377096053405/picture?type=large", "display_name": "Broten Togstad", "link": "https://stackoverflow.com/users/10475137/broten-togstad"}, "edited": false, "score": 0, "creation_date": 1572464751, "post_id": 58632432, "comment_id": 103572307, "body": "Thanks and sorry for the super easy question"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1572464770, "post_id": 58632432, "comment_id": 103572316, "body": "@Sorceri your answer is suggesting a way to get the last row that is unreliable, for reasons described at length in the post BigBen linked to."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1572465028, "post_id": 58632432, "comment_id": 103572429, "body": "@MathieuGuindon yes, it can be unreliable depending on how the worksheet is setup."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1572465107, "post_id": 58632432, "comment_id": 103572460, "body": "Also, I&#39;m wondering why there are <i>two</i> answers that both inefficiently loop row-by-row :)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 1, "creation_date": 1572465179, "post_id": 58632432, "comment_id": 103572490, "body": "@Sorceri no, it&#39;s unreliable <i>period</i>. Please read the linked post, reasons why <code>UsedRange</code> is a bad idea are near the top of the answer. Really worth reading."}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1572464411, "creation_date": 1572464411, "answer_id": 58632564, "question_id": 58632432, "link": "https://stackoverflow.com/questions/58632432/type-mismatch-error-with-a-if-then-statement/58632564#58632564", "title": "Type mismatch error with a if then statement", "body": "<p>You'll instead need to loop through your range.  One way to do it is:</p>\n\n<pre><code>Sub t()\nDim rng As Range, curCel As Range\nDim i As Long\nSet rng = Range(\"K1:K100\") ' Change as needed\nFor i = rng.Cells(rng.Rows.Count, 1).Row To rng.Cells(1, 1).Row Step -1\n    Set curCel = Cells(i, rng.column)\n    If curCel.Value = \"Declined\" or curCel.value = \"Void\" Then\n        curCel.EntireRow.Delete\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": false, "score": 0, "last_activity_date": 1580630373, "last_edit_date": 1580630373, "creation_date": 1572464429, "answer_id": 58632567, "question_id": 58632432, "link": "https://stackoverflow.com/questions/58632432/type-mismatch-error-with-a-if-then-statement/58632567#58632567", "title": "Type mismatch error with a if then statement", "body": "<p>you can loop through your cells and remove the rows.  I would fully qualify your sheet and try to avoid using ActiveSheet.  In the example below we are going from the bottom to the top so not to revisit cells twice or adjust the increment counter.</p>\n\n<pre><code>Dim i As Long\nDim iUsedRange As Long\n\niUsedRange = ActiveSheet.UsedRange.Rows.Count\nFor i = iUsedRange To 1 Step -1\n    If ActiveSheet.Cells(i, 11).Value = \"Declined\" Or ActiveSheet.Cells(i, 11).Value = \"Void\" Then\n        ActiveSheet.Cells(i, 11).EntireRow.Delete Shift:=xlUp\n    End If\n\nNext i\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10475137, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215377096053405/picture?type=large", "display_name": "Broten Togstad", "link": "https://stackoverflow.com/users/10475137/broten-togstad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1580630373, "creation_date": 1572463682, "last_edit_date": 1572463870, "question_id": 58632432, "link": "https://stackoverflow.com/questions/58632432/type-mismatch-error-with-a-if-then-statement", "title": "Type mismatch error with a if then statement", "body": "<p>I am trying to write a If then statement that cant take out the rows on my worksheet that have been declined or void. So I am trying to get it to look into a Column then delete the rows with those values. </p>\n\n<pre><code>If Columns(\"K:K\") = \"Declined\" Or \"Void\" Then\n\n    Selection.Delete Shift:=x1Up\n\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "security", "ms-access", "userform"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 2, "creation_date": 1572468447, "post_id": 58632146, "comment_id": 103573782, "body": "Don&#39;t put function calls between quote marks."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1572655513, "post_id": 58632146, "comment_id": 103637625, "body": "A better name for EmployeeType_ID field in tblPermissionTypes would be EmployeeTypeTitle."}], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1572656130, "last_edit_date": 1572656130, "creation_date": 1572640348, "answer_id": 58665552, "question_id": 58632146, "link": "https://stackoverflow.com/questions/58632146/is-there-a-simple-code-to-allow-certain-users-access-to-see-command-buttons/58665552#58665552", "title": "Is there a simple code to allow certain user(s) access to see command buttons?", "body": "<p>Function calls should not be within quote marks. You construct an SQL statement but then don't properly use it. You declare and use variable <code>permission</code> but don't set the variable - it is an empty string. Need form name as a search criteria. Couple of other syntax errors but they will go away with this suggested code. Run this code in form Open event to disable button and don't even give unauthorized users opportunity to click. Don't annoy them with a popup message that emphasizes their lowly status in hierarchy.</p>\n\n<p>You need to build a query that joins tblEmployees to tblPermission so that UserName, FormName, HasAccess fields are all available then reference that query in search for permission.</p>\n\n<p>A DLookup could serve here.</p>\n\n<pre><code>Me.buttonNameHere.Visible = Nz(DLookup(\"HasAccess\", \"queryNameHere\", _\n     \"UserName='\" &amp; fOSUserName &amp; \"' AND FormName='FormNameHere'\"), 0)\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10226211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/930bffd96fd0e3d1509156472e761ece?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/10226211/sebastian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572656130, "creation_date": 1572462313, "last_edit_date": 1572655474, "question_id": 58632146, "link": "https://stackoverflow.com/questions/58632146/is-there-a-simple-code-to-allow-certain-users-access-to-see-command-buttons", "title": "Is there a simple code to allow certain user(s) access to see command buttons?", "body": "<p>Okay, I am having difficulties coding security behind my user form. Let me give you guys the rundown. I created this make table \"tblPermissionTypes\" that basically has two field in there \"ID\" &amp; \"EmployeeType_ID\". The ID field represents Security level of access 0 through 2, and EmployeeType_ID is the title: 0 = Requestor, 1 = Admin, and 2 = Printer.</p>\n\n<p>With that being said I have another table \"tblEmployees\" with the same field \"EmployeeType_ID\", I manually set the 0s, 1s, &amp; 2s. This table also contains all employees UserNames</p>\n\n<p>Finally, I have another table \"tblPermission\" that contains three fields \"EmployeeType_ID\", \"FormName\",  and \"HasAccess\"</p>\n\n<p>My end result is being whenever this tblPermission has a Checkbox under the field HasAccess I want to grant access based on the EmployeeType_ID field to communicate back to the table \"tblEmployees\", but in this case I want them to only be able to see a button that contains that certain form.</p>\n\n<pre><code>Private Sub cmdClick_Click()\n\nDim strSQL As String\nDim permission As String\n\nIf permission = (\"fOSUserName\") = True Then\nRun strSQL\nstrSQL = \"SELECT * FROM tblEmployees WHERE \"\nstrSQL = strSQL &amp; \"tblEmployees.Five2 =\" &amp; (\"fOSUserName\") &amp; \"\"\", = False \nThen\n\nMsgBox \"You do not have permission!\", vbExclamation\n\nElse'\ncmdButton.Visible True\n\nEnd If\n\nNOTE: fOSUserName, is a function I created basically the same thing as \nEnviron(\"UserName\") \n\n\nDebug.Print strSQL\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1572506199, "post_id": 58632121, "comment_id": 103582878, "body": "Always indent/format your code nicely and correctly and you will see immediately where your issue is. Your <code>End With</code> comes before your <code>If</code> block is closed. Instead it must be in the very end right before <code>End Sub</code>. The block you open first (here <code>With Me.bloquear</code>) always needs to close last. Correct indentation makes your life <b>a lot</b> easier. It might look cumbersome/unnecessary at first but it saves you a lot of time maintaining your code and it results in less errors. \u2022 Good code in first place is a code that is easily human readable (because this results in less errors)."}, {"owner": {"reputation": 27, "user_id": 12164209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4be9d3958d816b334b18d69ece75c03?s=128&d=identicon&r=PG&f=1", "display_name": "Ruy", "link": "https://stackoverflow.com/users/12164209/ruy"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1572952249, "post_id": 58632121, "comment_id": 103714011, "body": "Is there any way to show asterisks instead letters to hide the password in this code?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1572964281, "post_id": 58632121, "comment_id": 103720259, "body": "No, not with an <code>InputBox</code> therefore you would need to create you own userform. See <a href=\"https://stackoverflow.com/questions/28189864/excel-vba-input-box/28195548\" title=\"excel vba input box\">stackoverflow.com/questions/28189864/excel-vba-input-box/&hellip;</a>"}], "owner": {"reputation": 27, "user_id": 12164209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4be9d3958d816b334b18d69ece75c03?s=128&d=identicon&r=PG&f=1", "display_name": "Ruy", "link": "https://stackoverflow.com/users/12164209/ruy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572505980, "creation_date": 1572462172, "last_edit_date": 1572505980, "question_id": 58632121, "link": "https://stackoverflow.com/questions/58632121/how-to-implement-a-password-in-a-button", "title": "How to implement a password in a button", "body": "<p>I have a button to lock unlock a form with a subform. To enable the button I would like to set a password with a msgbox. But I have an issue in my code.</p>\n\n<p>I first use the code to show the password msgbox with conditional, if the password is right the user locks/unlocks the forms. But I have end with statement in wrong place.</p>\n\n<pre><code>Private Sub bloquear_Click()\n    With Me.bloquear\n        Dim strPasswd\n        strPasswd = InputBox(\"Enter Password\", \"Restricted Form\")\n\n        If strPasswd = \"\" Or strPasswd = Empty Then\n            MsgBox \"No Input Provided\", vbInformation, \"Required Data\"\n            Exit Sub\n        End If\n\n        If strPasswd = \"Password\" Then\n            If .Caption = \"Unlock\" Then\n                Me.AllowAdditions = True\n                Me.AllowEdits = True\n                Me.CONSULTA_PRODUCTOS.Form.AllowAdditions = True\n                Me.CONSULTA_PRODUCTOS.Form.AllowEdits = True\n               .Caption = \"Lock\"\n            Else\n                Me.AllowAdditions = False\n                Me.AllowEdits = False\n                Me.CONSULTA_PRODUCTOS.Form.AllowAdditions = False\n                Me.CONSULTA_PRODUCTOS.Form.AllowEdits = False\n                .Caption = \"Unlock\"\n                Me.Refresh\n            End If\n\n    End With\n        Else\n            MsgBox \"Sorry, you do not have access to this form\", _\n               vbOKOnly, \"Important Information\"\n            Exit Sub\n        End If\n\nEnd Sub\n</code></pre>\n\n<p>The msgbox shows </p>\n\n<blockquote>\n  <p>Compile error, end with without with</p>\n</blockquote>\n\n<p>I don't know what is wrong because the with is there.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 228, "user_id": 4216021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dab71f9dbaf2788463adc85da03061ea?s=128&d=identicon&r=PG&f=1", "display_name": "Bilal", "link": "https://stackoverflow.com/users/4216021/bilal"}, "edited": false, "score": 0, "creation_date": 1572462911, "post_id": 58631992, "comment_id": 103571543, "body": "What operations you&#39;re trying to do with that &quot;rng&quot; variable? some operations are not available for combined (area) range i.e. rng.cut etc. So in this case you can do different ranges variable as @mdelapena suggested"}, {"owner": {"reputation": 13, "user_id": 11642276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c9581b3a166e0e56a12a643d3655d1?s=128&d=identicon&r=PG&f=1", "display_name": "Cub4_RJ", "link": "https://stackoverflow.com/users/11642276/cub4-rj"}, "reply_to_user": {"reputation": 228, "user_id": 4216021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dab71f9dbaf2788463adc85da03061ea?s=128&d=identicon&r=PG&f=1", "display_name": "Bilal", "link": "https://stackoverflow.com/users/4216021/bilal"}, "edited": false, "score": 0, "creation_date": 1572464399, "post_id": 58631992, "comment_id": 103572169, "body": "Simple thing:  With rng         .HorizontalAlignment = xlCenter         .VerticalAlignment = xlVAlignCenter     End With"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1572464809, "post_id": 58631992, "comment_id": 103572330, "body": "Can you <a href=\"https://stackoverflow.com/posts/58631992/edit\">edit</a> your question with more of your code?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1572464924, "post_id": 58631992, "comment_id": 103572389, "body": "<code>Intersect</code> might be useful here."}, {"owner": {"reputation": 13, "user_id": 11642276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c9581b3a166e0e56a12a643d3655d1?s=128&d=identicon&r=PG&f=1", "display_name": "Cub4_RJ", "link": "https://stackoverflow.com/users/11642276/cub4-rj"}, "edited": false, "score": 0, "creation_date": 1572465305, "post_id": 58631992, "comment_id": 103572551, "body": "I have included my code on the question as you asked BigBen."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11642276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c9581b3a166e0e56a12a643d3655d1?s=128&d=identicon&r=PG&f=1", "display_name": "Cub4_RJ", "link": "https://stackoverflow.com/users/11642276/cub4-rj"}, "edited": false, "score": 0, "creation_date": 1572464348, "post_id": 58632237, "comment_id": 103572150, "body": "Thanks but that&#180;s what I am trying to avoid. I made something similar on a spreadsheet directly on Excel&#180;s VBA and it worked and I can&#180;t replicate it in Access VBA: .Range(&quot;B2:B&quot; &amp; MyLastRow - 3 &amp; &quot;,&quot; &amp; &quot;D2:D&quot; &amp; MyLastRow - 3 &amp; &quot;,&quot; &amp; &quot;H2:H&quot; &amp; MyLastRow - 3 &amp; &quot;,&quot; &amp; &quot;I2:I&quot; &amp; MyLastRow - 3).HorizontalAlignment = xlCenter"}, {"owner": {"reputation": 185, "user_id": 10788327, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-W3IVKOR1B1Q/AAAAAAAAAAI/AAAAAAAAABI/iiyc6eWbnrw/photo.jpg?sz=128", "display_name": "mdelapena", "link": "https://stackoverflow.com/users/10788327/mdelapena"}, "reply_to_user": {"reputation": 13, "user_id": 11642276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c9581b3a166e0e56a12a643d3655d1?s=128&d=identicon&r=PG&f=1", "display_name": "Cub4_RJ", "link": "https://stackoverflow.com/users/11642276/cub4-rj"}, "edited": false, "score": 1, "creation_date": 1572467769, "post_id": 58632237, "comment_id": 103573497, "body": "I would try to avoid that, it can get confusing. But if you really need to refer to multiple ranges at once try joining the ranges with <code>Union()</code>, like this: <code>Set myRanges = Union(rng1, rng2)</code>"}], "tags": [], "owner": {"reputation": 185, "user_id": 10788327, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-W3IVKOR1B1Q/AAAAAAAAAAI/AAAAAAAAABI/iiyc6eWbnrw/photo.jpg?sz=128", "display_name": "mdelapena", "link": "https://stackoverflow.com/users/10788327/mdelapena"}, "is_accepted": false, "score": 1, "last_activity_date": 1572462695, "creation_date": 1572462695, "answer_id": 58632237, "question_id": 58631992, "link": "https://stackoverflow.com/questions/58631992/problem-setting-the-range-of-non-continuous-range-in-vba-access-manipulating-exc/58632237#58632237", "title": "Problem setting the range of non continuous range in vba access manipulating excel sheet", "body": "<p>Well, that's because you are assigning 2 ranges to a single range. you can either give 2 cell objects as parameters or a single string (just like in your working example).</p>\n\n<p>I don't know what you are trying to do, but I would suggest to assign those 2 <code>Ranges</code> to 2 different variables, and then use those variables separately.</p>\n\n<pre><code>Set rng1 = .Range(\"A2:E\" &amp; LastRow)\nSet rng2 = .Range(\"J2:M\" &amp; LastRow)\n</code></pre>\n\n<p>click <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range(object)\" rel=\"nofollow noreferrer\">here</a> for more on how to use the <code>Range</code> object.</p>\n"}], "owner": {"reputation": 13, "user_id": 11642276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c9581b3a166e0e56a12a643d3655d1?s=128&d=identicon&r=PG&f=1", "display_name": "Cub4_RJ", "link": "https://stackoverflow.com/users/11642276/cub4-rj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572496213, "creation_date": 1572461502, "last_edit_date": 1572496213, "question_id": 58631992, "link": "https://stackoverflow.com/questions/58631992/problem-setting-the-range-of-non-continuous-range-in-vba-access-manipulating-exc", "title": "Problem setting the range of non continuous range in vba access manipulating excel sheet", "body": "<p>I am creating a Excel sheet from Access and I need to format the sheet from Access VBA, but when I try this piece of code it returns a error 1004:</p>\n\n<pre><code>Set rng = .Range(\"A2:E\" &amp; LastRow &amp; \",\" &amp; \"J2:M\" &amp; LastRow)\nWith rng\n    .HorizontalAlignment = xlCenter\n    .VerticalAlignment = xlVAlignCenter\nEnd With\n</code></pre>\n\n<p>If I try it for each range it works: </p>\n\n<pre><code>Set rng = .Range(\"A2:A\" &amp; LastRow)\n</code></pre>\n\n<p>I have this very same piece of code on a Excel spreadsheet and it works like a charm, but maybe from Access I should use another syntax: </p>\n\n<pre><code>With DestWB.Sheets(strSheetName)\n  .Range(\"B2:B\" &amp; MyLastRow - 3 &amp; \",\" &amp; \"D2:D\" &amp; MyLastRow - 3 &amp; \",\" &amp; \"H2:H\" &amp; MyLastRow - 3 &amp; \",\" &amp; \"I2:I\" &amp; MyLastRow - 3).HorizontalAlignment = xlCenter\nEnd With\n</code></pre>\n\n<p>Can someone point me how to apply the formatting to non continuous ranges on similar to this one?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1572461538, "post_id": 58631956, "comment_id": 103570998, "body": "Can you please <a href=\"https://stackoverflow.com/posts/58631956/edit\">edit your question</a> to provide a sample outcome and what you have tried so far?"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1572467184, "post_id": 58631956, "comment_id": 103573261, "body": "As cybernetic nomad implied, you need to clarify your question. Are your columns on the same sheet? are your names on the same row? If the sample your provide is how your data is set up then; all you need is a <code>For</code> loop with an <code>If</code> statement and use <code>InStr</code> to check the value. Please clarify."}], "owner": {"reputation": 1, "user_id": 12271534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36b25c8a0cef2bfc5c4171fee4cd42a?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/12271534/jeff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572461425, "creation_date": 1572461327, "last_edit_date": 1572461425, "question_id": 58631956, "link": "https://stackoverflow.com/questions/58631956/in-a-range-of-cells-find-any-one-of-many-strings-most-of-which-are-not-in-the-s", "title": "In a range of cells find any one of many strings, most of which are not in the same position", "body": "<p>Although I have some experience in VBA I still consider myself a novice.  Just something to keep in mind.</p>\n\n<p>I have a monthly report of a workbook with three worksheets that I am writing a macro for to combine and restructure the file for the output.  My issue is that I have data in one column that contains information that I must extract some text, change the case and write back to the same cell.  The text is, generally, a company name which will not start in the same location from company to company.  Since VBA does not use wildcards (something I am accustomed to) I am finding it difficult to formulate a means to attain my task.  I thought, once I located the 'name' I could reference a table and extract the modified name I need and rewrite to the cell.  Here is an example of some input:</p>\n\n<pre><code>Col A                         Col B        Col C\nASTRO #256                    ASTRO        Astro\nDEBIT PURCH VISA CHEVRON 02   CHEVRON      Chevron\nSMART FOODSERVICE             SMART FOOD   Smart Foodservice \n</code></pre>\n\n<p>The value in column B is what I need to find in Column A and then take the value from Column C moved to Column A</p>\n\n<p>I know I can do countless IF ELSE nests but I would rather have a separate table of col B and C in which to add new accounts as they arise.  But that would require the code to be generic enough so the only updates are to the table and not the code.  I understand I may be forced to do both but I suspect there is a more efficient way to do this.</p>\n\n<p>Any thoughts?  Thanks, Jeff</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1572461371, "post_id": 58631854, "comment_id": 103570936, "body": "It is only loading the first <code>Area</code> of the <code>Range</code>  You will need to iterate the <code>Area</code>s and load the array.  You cannot mass load and array from a disjointed range."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1572462219, "post_id": 58631854, "comment_id": 103571258, "body": "Make a loop <code>For Each rngArea In SourceRng.Areas</code>"}, {"owner": {"reputation": 45, "user_id": 7474299, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yYZnf.jpg?s=128&g=1", "display_name": "DanielT", "link": "https://stackoverflow.com/users/7474299/danielt"}, "edited": false, "score": 0, "creation_date": 1572462702, "post_id": 58631854, "comment_id": 103571443, "body": "Scott &amp; Mathieu, I&#39;m not sure how this looks in code."}, {"owner": {"reputation": 45, "user_id": 7474299, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yYZnf.jpg?s=128&g=1", "display_name": "DanielT", "link": "https://stackoverflow.com/users/7474299/danielt"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1572527247, "post_id": 58631854, "comment_id": 103593335, "body": "@ScottCraner - Do you have a link to an example?"}, {"owner": {"reputation": 45, "user_id": 7474299, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yYZnf.jpg?s=128&g=1", "display_name": "DanielT", "link": "https://stackoverflow.com/users/7474299/danielt"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1572527384, "post_id": 58631854, "comment_id": 103593412, "body": "@MathieuGuindon - Is this what you mean? <a href=\"https://excelribbon.tips.net/T008703_Stepping_Through_a_Non-Contiguous_Range_of_Cells.html\" rel=\"nofollow noreferrer\">excelribbon.tips.net/&hellip;</a>"}], "owner": {"reputation": 45, "user_id": 7474299, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yYZnf.jpg?s=128&g=1", "display_name": "DanielT", "link": "https://stackoverflow.com/users/7474299/danielt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572469449, "creation_date": 1572460884, "last_edit_date": 1572469449, "question_id": 58631854, "link": "https://stackoverflow.com/questions/58631854/why-arent-arguments-after-the-first-two-in-my-union-arg1-arg2-expressed-i", "title": "Why aren&#39;t Arguments after the first two in my Union (Arg1, Arg2...) expressed in my Values?", "body": "<p>Without going into depth on my project, I'm trying to Match values between workbook sheets and for each sheet I want to create a Union of 3 columns (in a row) to Match on, but when I setup the Union to obtain the values for matching I only see the first two Arguments of my Union being produced when calling for Values.</p>\n\n<p>Below is the code and an image of my Locals...</p>\n\n<pre><code>Sub TestUnion()\n\n    Dim Filename2 As Variant: Filename2 = Worksheets(\"SOURCES\").Range(\"A2\") &amp; \".xlsx\"\n    Dim WB2 As Workbook: Set WB2 = Workbooks(Filename2)\n\n    Dim SourceRngB, SourceRngC, SourceRngF, SourceRng As Range\n    Set SourceRngB = WB2.Worksheets(\"LIVE KEYS\").Range(\"$B$27\")\n    Set SourceRngC = WB2.Worksheets(\"LIVE KEYS\").Range(\"$C$27\")\n    Set SourceRngF = WB2.Worksheets(\"LIVE KEYS\").Range(\"$F$27\")\n    Set SourceRng = Union(SourceRngB, SourceRngC, SourceRngF)\n\n    Dim SourceVal As Variant: SourceVal = SourceRng.Value\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/x5CSr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/x5CSr.png\" alt=\"enter image description here\"></a></p>\n\n<p>I expect all 3 range values to be expressed in the Locals.</p>\n\n<p>Btw, the \"27\" you see in the code will ultimately be a variable that changes within a loop (\"$B$\" &amp; x) starting from 2 to y (number of rows) so I can compare 3 cells (Bx,Cx,Fx) on each row of my \"LIVE\" sheet with other \"TEST\" sheets and paste the match into a Results sheet. The code will be run from the Results sheet.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 19, "user_id": 11665496, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7Bw5Sy8vFVM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfnXZAU3oMKR1UIf_Isoulk8cUv_Q/mo/photo.jpg?sz=128", "display_name": "Richard J", "link": "https://stackoverflow.com/users/11665496/richard-j"}, "edited": false, "score": 0, "creation_date": 1572458564, "post_id": 58631247, "comment_id": 103569654, "body": "That was a typo on my part. I am using the variable names <i>c</i> and <i>r</i> on my end but when I posted it here I meant to change them all over to <i>col</i> and <i>row</i> for clarity. Edit: The issue has been amended, thank you for pointing that out"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1572459191, "post_id": 58631247, "comment_id": 103569930, "body": "so the issue was just a typo and this is otherwise solved?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1572459204, "post_id": 58631247, "comment_id": 103569935, "body": "@BruceWayne no."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1572459282, "post_id": 58631247, "comment_id": 103569978, "body": "@RichardJ what are the addresses of those cells, and what are the values of <code>row</code> and <code>col</code> when this fails? I can&#39;t repro. I would use <code>Application.Match</code> instead of <code>WorksheetFunction.Match</code> though, and then test if the result is an error before trying to use <code>col</code> and <code>row</code>."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1572459304, "post_id": 58631247, "comment_id": 103569988, "body": "Are you saying that you tried <code>Range(Cells(r,c),Cells(r+2,c)).value = &quot;New Value&quot;</code> and that did not work?  I&#39;m not seeing what <code>Range()</code> functino you tried, which might be a syntactical issue."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1572459527, "post_id": 58631247, "comment_id": 103570088, "body": "Additionally, you have <code>Match()</code> functions that do not reference <code>.Row</code>, which would make the above listed line more appropriate."}, {"owner": {"reputation": 19, "user_id": 11665496, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7Bw5Sy8vFVM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfnXZAU3oMKR1UIf_Isoulk8cUv_Q/mo/photo.jpg?sz=128", "display_name": "Richard J", "link": "https://stackoverflow.com/users/11665496/richard-j"}, "edited": false, "score": 0, "creation_date": 1572460245, "post_id": 58631247, "comment_id": 103570419, "body": "Hi, sorry for the late reply.  @Ben: I changed to Application.Match and the same error still occurs. The mismatched variable names were purely on the StackOverflow code, which I had intended to edit but neglected to change them all.  Cyril: For the range function, that is correct, the range function I attempted was Range(Table2.DataBodyRange(row, col), Table2.DataBodyRange(row + 2, col)) = &quot;New Value&quot; (replacing &#39;Union&#39; with &#39;Range&#39; in the code I&#39;ve posted)"}], "answers": [{"comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1572460987, "post_id": 58631751, "comment_id": 103570772, "body": "@ScottCraner Was working on explaining the +1 and +2 based on starting with B3 when I saw your second comment come in... if nothing else, it helps to have confirmation!"}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 3, "last_activity_date": 1572460892, "last_edit_date": 1572460892, "creation_date": 1572460437, "answer_id": 58631751, "question_id": 58631247, "link": "https://stackoverflow.com/questions/58631247/union-function-works-over-a-range-but-the-range-function-wont/58631751#58631751", "title": "Union function works over a range but the Range function won&#39;t", "body": "<p>Given your comment, I believe your issue has to do with how to define a range and the below changes may support using <code>Range()</code> rather than union:</p>\n\n<pre><code>For i = 1 to 5\n     Set colrng = Table2.HeaderRowRange\n     Set rowrng = Range(Range(\"B3\"), Range(\"B\" &amp; CStr(2 + Table2.DataBodyRange.Rows.Count)))\n     'EDIT:  You start with cell B3, so adding col+1 and row+2\n     col = Application.Match(Table1.DataBodyRange(i, 1), colrng, 0) + 1 'CHANGE\n     row = Application.Match(Table1.DataBodyRange(i, 4), rowrng, 0) + 2 'CHANGE\n     'range().value = \"new value\" and will utilize cells()\n     Range(Cells(row, col+1), Cells(row + 2, col+1)).Value = \"New Value\" 'CHANGE\nNext\n</code></pre>\n\n<p>Please remember to fully-qualify your references.  In <code>rowrng</code> you just have <code>range()</code> references, but what sheet is that on?  some of that info may have an impact depending on the layout and usage of your workbook.</p>\n\n<p>Additionally, changed <code>WorksheetFunction</code> to <code>Application</code> which allows for different error handling.  This may or may not be benefitial to you.</p>\n"}], "owner": {"reputation": 19, "user_id": 11665496, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7Bw5Sy8vFVM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfnXZAU3oMKR1UIf_Isoulk8cUv_Q/mo/photo.jpg?sz=128", "display_name": "Richard J", "link": "https://stackoverflow.com/users/11665496/richard-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 58631751, "answer_count": 1, "score": 0, "last_activity_date": 1572460892, "creation_date": 1572458294, "last_edit_date": 1592644375, "question_id": 58631247, "link": "https://stackoverflow.com/questions/58631247/union-function-works-over-a-range-but-the-range-function-wont", "title": "Union function works over a range but the Range function won&#39;t", "body": "<p>I am attempting to select a continuous range inside of a table determined by variable references using VBA. I have run into an issue where I can use the Union function to select 2 points, but cannot use the Range function in order to create a continuous range.</p>\n<p>For context, here is a sample of the code I am using:</p>\n<pre><code>For i = 1 to 5\n\n     Set colrng = Table2.HeaderRowRange\n     Set rowrng = Range(Range(&quot;B3&quot;), Range(&quot;B&quot; &amp; CStr(2 + Table2.DataBodyRange.Rows.Count)))\n\n     col = WorksheetFunction.Match(Table1.DataBodyRange(i, 1), colrng, 0)\n     row = WorksheetFunction.Match(Table1.DataBodyRange(i, 4), rowrng, 0)\n\n     Union(Table2.DataBodyRange(row, col), Table2.DataBodyRange(row + 2, col)) = &quot;New Value&quot;\n\nNext\n</code></pre>\n<p>The code as of right now works, but results in 2 disjointed cells containing &quot;New Value&quot;, whereas I would prefer if every cell between and inclusive of the two endpoints contained &quot;New Value&quot;. The method I have used in the past on less advanced code utilizes the Range function, but that doesn't work here and yields an error:</p>\n<blockquote>\n<p>Run-time error '1004':</p>\n<p>Application-defined or object defined error</p>\n</blockquote>\n<p>Edit: I don't think I was clear enough in my initial example, so below is the full code I am using.</p>\n<pre><code>Private Sub test()\n    \n    Dim colrng As Range\n    Dim rowrng As Range\n    Dim i As Integer\n    Dim j As Integer\n    Dim k As Integer\n    Dim r As Integer\n    Dim c As Integer\n    Dim t As Double\n    Dim Schedule As ListObject\n    Dim Info As ListObject\n    \n    Set Schedule = Sheet1.ListObjects(&quot;Table1&quot;)\n    Set Info = Sheet2.ListObjects(&quot;Table2&quot;)\n    \n    Schedule.DataBodyRange.ClearContents\n    \n    \n    For i = 1 To Info.DataBodyRange.Rows.Count\n        \n        t = Info.DataBodyRange(i, 5) - 1\n        \n        Set colrng = Schedule.HeaderRowRange\n        Set rowrng = Sheet1.Range(Sheet1.Range(&quot;B3&quot;), Sheet1.Range(&quot;B&quot; &amp; CStr(2 + Schedule.DataBodyRange.Rows.Count)))\n        \n        If IsEmpty(Info.DataBodyRange(i, 4)) = False And IsEmpty(Info.DataBodyRange(i, 1)) = False Then\n        \n            c = Application.Match(Info.DataBodyRange(i, 1), colrng, 0)\n            r = Application.Match(Info.DataBodyRange(i, 4), rowrng, 0)\n            \n            Range(Schedule.DataBodyRange(r, c), Schedule.DataBodyRange(r + t, c)) = Info.DataBodyRange(i, 2) &amp; &quot; - &quot; &amp; Info.DataBodyRange(i, 3)\n            \n        End If\n    Next\nEnd Sub\n</code></pre>\n<p>Where info is this table:</p>\n<p><a href=\"https://i.stack.imgur.com/rbPUg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rbPUg.png\" alt=\"enter image description here\" /></a></p>\n<p>And the Schedule table with the desired output is:</p>\n<p><a href=\"https://i.stack.imgur.com/KxxGo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KxxGo.png\" alt=\"enter image description here\" /></a></p>\n<p>As of right now, using the <em>Union</em> function in place of the <em>Range</em> function in the last row before the closing code I am able to generate all of the desired output aside from the cell D8 being empty.</p>\n"}, {"tags": ["vba", "forms", "ms-access", "load"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1572457591, "post_id": 58631033, "comment_id": 103569213, "body": "If the form remains open, then it is only loaded once, you&#39;ll need another event. <code>Private Sub Form_GotFocus()</code> perhaps."}, {"owner": {"reputation": 521, "user_id": 6888123, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/259b4ffbfcfafd94b68e92e7de383aa7?s=128&d=identicon&r=PG&f=1", "display_name": "crazyTech", "link": "https://stackoverflow.com/users/6888123/crazytech"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1572457728, "post_id": 58631033, "comment_id": 103569276, "body": "ok, could you please tell me what the other event handler method is supposed to be?  Also, I navigate between forms(back and forth) using the  DoCmd.OpenForm FormName:=&quot;BlahBlahFormCBlahbalha&quot;, OpenArgs:=&quot;assignedValue|&quot; &amp; assignedValue"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1572457870, "post_id": 58631033, "comment_id": 103569347, "body": "Again, openargs, will only be passed on opening.  If these come from other forms, maybe best to code to a) check form is open, b) get the value and write a function to do bits of code, and call them on open and focus."}, {"owner": {"reputation": 380, "user_id": 11104095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc0018af5fc00eb65eaae5dcf4473e6?s=128&d=identicon&r=PG&f=1", "display_name": "K753", "link": "https://stackoverflow.com/users/11104095/k753"}, "edited": false, "score": 1, "creation_date": 1572458250, "post_id": 58631033, "comment_id": 103569516, "body": "You could set it up so that forms close whenever the user navigates away. That way the form will have to load when they navigate back."}], "answers": [{"comments": [{"owner": {"reputation": 521, "user_id": 6888123, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/259b4ffbfcfafd94b68e92e7de383aa7?s=128&d=identicon&r=PG&f=1", "display_name": "crazyTech", "link": "https://stackoverflow.com/users/6888123/crazytech"}, "edited": false, "score": 0, "creation_date": 1572461599, "post_id": 58631366, "comment_id": 103571025, "body": "Could you please change Forms!MyForm.Initialize  to Forms!MyForm.InitializeForm  ?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 521, "user_id": 6888123, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/259b4ffbfcfafd94b68e92e7de383aa7?s=128&d=identicon&r=PG&f=1", "display_name": "crazyTech", "link": "https://stackoverflow.com/users/6888123/crazytech"}, "edited": false, "score": 1, "creation_date": 1572461968, "post_id": 58631366, "comment_id": 103571164, "body": "@crazyTech Of course. You can use the edit button too if you want to do minor technical corrections to my answer."}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 3, "creation_date": 1572462084, "post_id": 58631366, "comment_id": 103571207, "body": "Please don&#39;t use bangs. Bangs makes a complete lie of the code&#39;s behavior by implying that it&#39;s code but in fact it&#39;s just same thing as <code>Forms(&quot;MyForm&quot;)</code>, which will return an <code>Access.Form</code> rather than an <code>Form_MyForm</code>, which will not have the <code>Initialize</code> method at the compile time. Thus that method is late-bound. To ensure early-bound, assign to a variable of <code>Form_MyForm</code> type and call <code>Initialize</code> off the variable instead to get the early-bound behavior."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 1, "creation_date": 1572462469, "post_id": 58631366, "comment_id": 103571356, "body": "@this That&#39;s just semantics, the early and late-bound behavior are identical for this method. As the code doesn&#39;t need to store a reference to the form, I wouldn&#39;t dim and assign it, because that takes 3 lines for an operation that&#39;s just as easy to understand in a single line. Of course, <code>Forms(&quot;MyForm&quot;).InitializeForm</code> is valid too, but I generally don&#39;t use it since you need to use the bang notation when referring to forms from SQL, so I tend to use that notation everywhere for uniformity."}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 2, "creation_date": 1572463284, "post_id": 58631366, "comment_id": 103571691, "body": "Nope. Delete the <code>Initialize</code> method off the <code>MyForm</code> and run the code. With the original code, you get a runtime error. The explicit assignment gets you a compile-time error. I&#39;d always pick code that will yield compile-time error over runtime error. Always."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 2, "last_activity_date": 1572461935, "last_edit_date": 1572461935, "creation_date": 1572458819, "answer_id": 58631366, "question_id": 58631033, "link": "https://stackoverflow.com/questions/58631033/ms-access-a-certain-forms-form-load-only-invoked-first-time-that-the-user-vie/58631366#58631366", "title": "MS Access A certain Form&#39;s Form_Load() Only invoked first time that the user views said forms, but fails to be invoked in future viewings", "body": "<p>My solution would be the following:</p>\n\n<p>Instead of:</p>\n\n<pre><code>Private Sub Form_Load()\n     Dim db As DAO.Database\n     Dim qdfSelectQuery As DAO.queryDef\n     Dim argumentsStringArray() As String\n\n  If Len(Me.OpenArgs) &gt; 0 Then\n\n     argumentsStringArray = Split(Me.OpenArgs, \"|\")\n\n    \u2026...Blah blah initialize some variables using the argumentsStringArray Blah blah \u2026..;\n  End If\n End Sub\n</code></pre>\n\n<p>You use:</p>\n\n<pre><code>Public Sub InitializeForm(SomeArgs As String)\n     Dim db As DAO.Database\n     Dim qdfSelectQuery As DAO.queryDef\n     Dim argumentsStringArray() As String\n  If Len(SomeArgs) &gt; 0 Then\n     argumentsStringArray = Split(SomeArgs , \"|\")\n    \u2026...Blah blah initialize some variables using the argumentsStringArray Blah blah \u2026..;\n  End If\n End Sub\n</code></pre>\n\n<p>And instead of</p>\n\n<pre><code>DoCmd.OpenForm \"MyForm\", OpenArgs := \"Something\"\n</code></pre>\n\n<p>You do</p>\n\n<pre><code>DoCmd.OpenForm \"MyForm\"\nForms!MyForm.InitializeForm \"Something\"\n</code></pre>\n\n<p>This allows way more flexibility than relying on <code>OpenArgs</code>, e.g. you can pass objects and strongly-typed values, return values, etc.</p>\n"}, {"comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1572461064, "post_id": 58631579, "comment_id": 103570811, "body": "Access forms can be closed via <code>DoCmd.Close acForm, &quot;FormName&quot;</code>, instead of <code>unload</code> (but that throws an error if the form is not open, so you&#39;d need to write code to detect if it&#39;s open). The <code>New</code> approach for Access has a few gotchas, such as the form being cleaned up as soon as the form object goes out of scope (and you can only pass <code>.OpenArgs</code> via <code>DoCmd.OpenForm</code> so this would require a rewrite anyway)."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 2, "creation_date": 1572461558, "post_id": 58631579, "comment_id": 103571011, "body": "@ErikA &quot;a few gotchas, such as the form being cleaned up as soon as the form object goes out of scope&quot; - I would <i>expect</i> it to work like this. What makes forms flakey is that they&#39;re objects and yet Access seems adamant about treating them like global state."}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 1, "creation_date": 1572461967, "post_id": 58631579, "comment_id": 103571163, "body": "When you do use a <code>New</code> instantiation, you do need to ensure you do not mix the access between the default instance and the new&#39;d instance. That would certainly cause the flaky behavior. Because the newing is so rare, it is not very well understood and easily misused."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1572459744, "creation_date": 1572459744, "answer_id": 58631579, "question_id": 58631033, "link": "https://stackoverflow.com/questions/58631033/ms-access-a-certain-forms-form-load-only-invoked-first-time-that-the-user-vie/58631579#58631579", "title": "MS Access A certain Form&#39;s Form_Load() Only invoked first time that the user views said forms, but fails to be invoked in future viewings", "body": "<p>The <code>Load</code> handler runs once in the lifetime of the object.</p>\n\n<p>If you need it to run multiple times, don't reuse the same object. <code>DoCmd.OpenForm</code> works off the form's <em>default instance</em>, so unless you unload or otherwise destroy the instance, it remains loaded, and next time it's displayed it still holds whatever instance state it had when it was last dismissed.</p>\n\n<p>If an Access form supports unloading (not familiar with Access, and can't test ATM), then <code>Unload MyForm</code> should unload it, making the <code>Load</code> event fire again the next time the form is referenced.</p>\n\n<p>If you can <code>New</code> up a form and <code>Show</code> it like you could with a <code>UserForm</code>, do it - forms are objects in their own rights, and this global default instance stuff is hiding the <em>object</em> nature of it... making basic assumptions fail (like, a <code>Load</code> handler being expected to run every time the form is shown).</p>\n\n<p>Alternatively, move your <code>Load</code> code into a new handler for the <code>Open</code> event, which would be invoked whenever the form is <em>open</em>, not merely <em>loaded</em>.</p>\n"}], "owner": {"reputation": 521, "user_id": 6888123, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/259b4ffbfcfafd94b68e92e7de383aa7?s=128&d=identicon&r=PG&f=1", "display_name": "crazyTech", "link": "https://stackoverflow.com/users/6888123/crazytech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1572461935, "creation_date": 1572457436, "question_id": 58631033, "link": "https://stackoverflow.com/questions/58631033/ms-access-a-certain-forms-form-load-only-invoked-first-time-that-the-user-vie", "title": "MS Access A certain Form&#39;s Form_Load() Only invoked first time that the user views said forms, but fails to be invoked in future viewings", "body": "<p>I have very a rudimentary understanding of Microsoft Access and VBA Code.\nOn my work desktop, I have Microsoft Office Professional Plus 2013 Access\nI've been tasked to create a MS Access application with an Access DB.</p>\n\n<p>In the Visual Basic files, I have pseudo-code behind files for the various MS Access forms.</p>\n\n<p>Most of my MS Access forms files have a subroutine like the following one:</p>\n\n<pre><code> Private Sub Form_Load()\n\n     Dim db As DAO.Database\n     Dim qdfSelectQuery As DAO.queryDef\n     Dim argumentsStringArray() As String\n\n  If Len(Me.OpenArgs) &gt; 0 Then\n\n     argumentsStringArray = Split(Me.OpenArgs, \"|\")\n\n    \u2026...Blah blah initialize some variables using the argumentsStringArray Blah blah \u2026..;\n  End If\n\n End Sub\n</code></pre>\n\n<p>Now the \"Navigation\" within the application can move back and forth between different forms, and it could go back to an earlier form that was already seen/used by the user of  the application.</p>\n\n<p>A Particular Form's Form_Load() subroutine  does get executed the very first time that said form runs within the context of a particular execution run of said MS Access Application.  However, if the application navigates back to a particular form that the user has already seen then it will <strong>Not</strong> execute said  Form_Load() subroutine.</p>\n\n<p>Could someone please tell me what code modifications that I would have to make in order to ensure that a Particular Form's Form_Load() subroutine executes regardless of how many times the user has seen it?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1572456051, "post_id": 58630493, "comment_id": 103568517, "body": "You&#39;d need to store the list somewhere in the document and give the user the ability to edit that list.  Maybe look at <a href=\"https://docs.microsoft.com/en-us/office/vba/api/word.document.customdocumentproperties\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/&hellip;</a>  though values cannot be &gt;255 characters in length, so if that&#39;s a problem you&#39;d need a different solution, maybe look at CustomXMLParts eg - <a href=\"http://www.vbaexpress.com/forum/showthread.php?37833-Solved-Reading-CustomXML\" rel=\"nofollow noreferrer\">vbaexpress.com/forum/&hellip;</a>"}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1572457334, "post_id": 58630493, "comment_id": 103569097, "body": "hi. u can use a sheet to store the values that the user put, and next use them to populate the combox"}], "answers": [{"tags": [], "owner": {"reputation": 78, "user_id": 12184129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2ef212e46e097237116a1e150edb924?s=128&d=identicon&r=PG&f=1", "display_name": "SpyingSphinx", "link": "https://stackoverflow.com/users/12184129/spyingsphinx"}, "is_accepted": true, "score": 0, "last_activity_date": 1572462613, "creation_date": 1572462613, "answer_id": 58632221, "question_id": 58630493, "link": "https://stackoverflow.com/questions/58630493/how-to-populate-a-userform-listbox-combobox-array-list-from-a-textbox-input/58632221#58632221", "title": "How to populate a userform listbox/combobox Array/list from a textbox input?", "body": "<p>Do something like this. Have a sheet in your workbook called \"Data\". When the user adds something using commandbutton1 it goes to column A in the Data sheet and puts the users value in the next available row.</p>\n\n<p>When you load the other form it will loop through column A and grab all the values and add them to combo box.</p>\n\n<pre><code>    Private Sub CommandButton1_Click()\n        Dim lastrow As Long: lastrow = Sheets(\"Data\").Cells(Rows.Count, 1).End(xlUp).Row + 1\n\n       If TextBox1.TextLength &gt; 0 Then\n          Sheets(\"Data\").Cells(lastrow, 1).Value = TextBox1.Value\n          TextBox1.Value = \"\"\n       Else\n       MsgBox \"Please enter a value\"\n          Exit Sub\n       End If\n    End Sub\n\n\n    Private Sub UserForm_Initialize()\n\n    For i = 1 To Sheets(\"Data\").Cells(Rows.Count, 1).End(xlUp).Row\n        ComboBox2.AddItem Sheets(\"Data\").Cells(i, 1).Value\n    Next\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 12232855, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nkzr1.jpg?s=128&g=1", "display_name": "Malachilee", "link": "https://stackoverflow.com/users/12232855/malachilee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 58632221, "answer_count": 1, "score": 1, "last_activity_date": 1582095719, "creation_date": 1572455225, "last_edit_date": 1582095719, "question_id": 58630493, "link": "https://stackoverflow.com/questions/58630493/how-to-populate-a-userform-listbox-combobox-array-list-from-a-textbox-input", "title": "How to populate a userform listbox/combobox Array/list from a textbox input?", "body": "<p>I'm trying to allow the user to input data in a textbox and have that data be added to the combobox array, how can I get it to save into the code?</p>\n\n<p><a href=\"https://i.stack.imgur.com/lPHc9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lPHc9.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have some code that will populate the data for that session, but it disappears after I close the application.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n   If TextBox1.TextLength &gt; 0 Then\n      UserForm1.ComboBox2.AddItem TextBox1.Value\n      TextBox1.Value = \"\"\n   Else\n      Exit Sub\n   End If\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n   With ComboBox2\n      .AddItem \".020\"\n      .AddItem \".030\"\n      .AddItem \".032\"\n      .AddItem \".040\"\n   End With\nEnd Sub\n</code></pre>\n\n<p>I need the user to be able to input there data and have it be in the combobox for everyone else later on. Any help would be appreciated! Even search terms that could point me in the right direction.</p>\n"}, {"tags": ["arrays", "excel", "vba", "for-loop", "foreach"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1572456575, "post_id": 58630461, "comment_id": 103568761, "body": "Just so you are aware, &#39;Dim HWSWArray() As Variant&#39; creates an array of variants rather than a variant which can contain an array.  You possibly only need &#39;Dim HWSWArray As Variant&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 9211351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d34320d03031302b8cb300b9415b7b3?s=128&d=identicon&r=PG&f=1", "display_name": "SureThing", "link": "https://stackoverflow.com/users/9211351/surething"}, "edited": false, "score": 0, "creation_date": 1572456487, "post_id": 58630624, "comment_id": 103568713, "body": "I edited my original post can you take another look?"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "reply_to_user": {"reputation": 97, "user_id": 9211351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d34320d03031302b8cb300b9415b7b3?s=128&d=identicon&r=PG&f=1", "display_name": "SureThing", "link": "https://stackoverflow.com/users/9211351/surething"}, "edited": false, "score": 0, "creation_date": 1572456841, "post_id": 58630624, "comment_id": 103568886, "body": "@SureThing, after reading your update, I would say that my statement on the trickyness with multidimensional arrays  and For Each still stands. Replace HWSWArray with BArray and you&#39;re good to go."}, {"owner": {"reputation": 97, "user_id": 9211351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d34320d03031302b8cb300b9415b7b3?s=128&d=identicon&r=PG&f=1", "display_name": "SureThing", "link": "https://stackoverflow.com/users/9211351/surething"}, "edited": false, "score": 0, "creation_date": 1572457268, "post_id": 58630624, "comment_id": 103569065, "body": "OK I am understanding where you are coming from.  I was an idiot though.  I had the array too large and the part that had the type mismatch was because it was blank.  I had ReDim the array for 3521 values but it only filled 3520 so index 3521 was blank.  Is there any way to troubleshoot that easier?"}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1572455757, "creation_date": 1572455757, "answer_id": 58630624, "question_id": 58630461, "link": "https://stackoverflow.com/questions/58630461/excel-vba-issues-with-for-each-loop-with-an-array/58630624#58630624", "title": "Excel VBA - Issues with For Each Loop with an Array", "body": "<p><code>For Each</code> and multidimensional arrays are tricky. Try this instead:</p>\n\n<pre><code>For i = LBound(HWSWArray, 1) To UBound(HWSWArray, 1)\n    If HWSWArray(i, 0) = POAMHost Then\n        'Do Things\n    ElseIf HWSWArray(i, 1) = POAMHost Then\n        'Do Things\n    End If\nNext\n</code></pre>\n\n<p><code>LBound</code> and <code>UBound</code> will give to the lower and upper bound for a given dimension, in this case the first.</p>\n"}, {"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1572455938, "post_id": 58630627, "comment_id": 103568466, "body": "You might have been right on the <code>1</code> and <code>2</code>, depending on how OP populated <code>HWSWArray</code> (sorry about my previous comment). Although the question mentions <code>(0)(0)</code> and <code>(0)(1)</code> - which makes me believe that HWSWArray is not populated efficiently."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1572456054, "post_id": 58630627, "comment_id": 103568519, "body": "@BigBen I was actually just correcting that as my initial thought was how <code>HWSWArray</code> was being generated, so I went back and specified <i>how</i> the array is being generated in my example."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1572456055, "post_id": 58630627, "comment_id": 103568520, "body": "In fact you are right based on the <code>HWSWArray = Range(Cells(startrow, startcolumn), Cells(endrow, endcolumn)).value</code>, so sorry :) Yep."}, {"owner": {"reputation": 97, "user_id": 9211351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d34320d03031302b8cb300b9415b7b3?s=128&d=identicon&r=PG&f=1", "display_name": "SureThing", "link": "https://stackoverflow.com/users/9211351/surething"}, "edited": false, "score": 0, "creation_date": 1572456491, "post_id": 58630627, "comment_id": 103568716, "body": "I edited my original post can you take another look?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 97, "user_id": 9211351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d34320d03031302b8cb300b9415b7b3?s=128&d=identicon&r=PG&f=1", "display_name": "SureThing", "link": "https://stackoverflow.com/users/9211351/surething"}, "edited": false, "score": 0, "creation_date": 1572456673, "post_id": 58630627, "comment_id": 103568811, "body": "@SureThing I took a look at your edit and the code appears to use <code>Do Until</code> loops, which is very similar to what is being proposed with the <code>for</code> loop, where your <code>Counter</code> is <code>i</code> and instead of needing to iterate it manually the <code>for</code> loop iterates i via <code>next i</code>.  The other significant difference would be working an the <code>variant array</code> rather than referencing a sheet (like in your edit).  I would suggest trying the provided solution and if it works you&#39;d be in a better position."}, {"owner": {"reputation": 97, "user_id": 9211351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d34320d03031302b8cb300b9415b7b3?s=128&d=identicon&r=PG&f=1", "display_name": "SureThing", "link": "https://stackoverflow.com/users/9211351/surething"}, "edited": false, "score": 0, "creation_date": 1572457264, "post_id": 58630627, "comment_id": 103569060, "body": "OK I am understanding where you are coming from.  I was an idiot though.  I had the array too large and the part that had the type mismatch was because it was blank.  I had ReDim the array for 3521 values but it only filled 3520 so index 3521 was blank.  Is there any way to troubleshoot that easier?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 97, "user_id": 9211351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d34320d03031302b8cb300b9415b7b3?s=128&d=identicon&r=PG&f=1", "display_name": "SureThing", "link": "https://stackoverflow.com/users/9211351/surething"}, "edited": false, "score": 0, "creation_date": 1572457323, "post_id": 58630627, "comment_id": 103569092, "body": "@SureThing The <code>lbound()&#47;ubound()</code> is what resolves that, so you do not index outside of your defined array range."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1572456017, "last_edit_date": 1572456017, "creation_date": 1572455768, "answer_id": 58630627, "question_id": 58630461, "link": "https://stackoverflow.com/questions/58630461/excel-vba-issues-with-for-each-loop-with-an-array/58630627#58630627", "title": "Excel VBA - Issues with For Each Loop with an Array", "body": "<p>Assuming you have equal length columns:</p>\n\n<pre><code>Dim HWSWArray() As Variant\nHWSWArray = Range(Cells(startrow, startcolumn), Cells(endrow, endcolumn)).value\nDim i As Long\nFor i = lbound(HWSWArray) to ubound(HWSWArray)\n    If HWSWArray(v,1) = POAMHost Then\n        'DoThings\n    ElseIf HWSWArray(v,2) = POAMHost Then\n        'Do other Things\n    End If\nNext i\n</code></pre>\n\n<p>the lowerbound (typically 0) and upper bound of the <code>HWSWArray</code> will be the row counts for the specific column.</p>\n"}, {"tags": [], "owner": {"reputation": 97, "user_id": 9211351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d34320d03031302b8cb300b9415b7b3?s=128&d=identicon&r=PG&f=1", "display_name": "SureThing", "link": "https://stackoverflow.com/users/9211351/surething"}, "is_accepted": false, "score": 0, "last_activity_date": 1572457396, "creation_date": 1572457396, "answer_id": 58631017, "question_id": 58630461, "link": "https://stackoverflow.com/questions/58630461/excel-vba-issues-with-for-each-loop-with-an-array/58631017#58631017", "title": "Excel VBA - Issues with For Each Loop with an Array", "body": "<p>To anyone looking at this in the future, I had incorrectly specified the dimensions of my array.  I had extended my array to hold 3521 values but when it was loading the array, it only loaded to 3520.  </p>\n\n<p>When my code was running, it was comparing a variable to an empty array so I was getting a type mismatch.</p>\n\n<p>I fixed the dimensions and everything worked fine.  </p>\n"}], "owner": {"reputation": 97, "user_id": 9211351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d34320d03031302b8cb300b9415b7b3?s=128&d=identicon&r=PG&f=1", "display_name": "SureThing", "link": "https://stackoverflow.com/users/9211351/surething"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1572457396, "creation_date": 1572455142, "last_edit_date": 1572456463, "question_id": 58630461, "link": "https://stackoverflow.com/questions/58630461/excel-vba-issues-with-for-each-loop-with-an-array", "title": "Excel VBA - Issues with For Each Loop with an Array", "body": "<p>Hoping I can find some help with this one.  I am pulling in information from Excel from 2 columns (Hostname, IP).  The declarations of importance are </p>\n\n<pre><code>Dim HWSWArray() As Variant\nDim v As Variant.\n</code></pre>\n\n<p>My HWSWArray is loaded and as an example I have HWSWArray(0)(0) -> Hostname and HWSWArray(0)(1) -> IP</p>\n\n<p>I want to loop through these and do an external comparison to another string so I have my loop written as such</p>\n\n<pre><code>For Each v In HWSWArray         \n        If v(0) = POAMHost Then\n           DoThings\n        ElseIf v(1) = POAMHost Then\n           Do Things\n        End If\n Next\n</code></pre>\n\n<p>I am getting a type mismatch as soon as it evaluates the first if statement.  I am confused because they are both variants v and HWSWArray and shouldn't v as a variant match whatever type it is matching against?</p>\n\n<p>Maybe I am missing the forest for the trees?  I can post the full code if necessary but will need to redact some stuff.</p>\n\n<p>To add some more information with code that I can easily share, I have done something similar in the past that has worked and I cant tell what the difference is.  I will look at implementing your suggestions for the For i loop if I can't get this to work but I am trying to see why it wont work in its current capacity.</p>\n\n<pre><code>    'Load BArray\n    Do While Counter &lt;&gt; B1930Rows + 1\n\n    IPCell = Assets.Range(\"X\" &amp; Counter)\n    hostCell = Assets.Range(\"W\" &amp; Counter)\n\n\n    If IsEmpty(Assets.Range(\"W\" &amp; Counter)) = True And IsEmpty(Assets.Range(\"X\" &amp; Counter)) = True Then\n        Counter = Counter + 1\n\n    ElseIf IsEmpty(Assets.Range(\"W\" &amp; Counter)) = True And IsEmpty(Assets.Range(\"X\" &amp; Counter)) = False Then\n        BArray(i) = Array(\"Null\", UCase(IPCell))\n        i = i + 1\n        Counter = Counter + 1\n\n    ElseIf IsEmpty(Assets.Range(\"W\" &amp; Counter)) = False And IsEmpty(Assets.Range(\"X\" &amp; Counter)) = True Then\n        BArray(i) = Array(UCase(hostCell), \"Null\")\n        i = i + 1\n        Counter = Counter + 1\n\n    ElseIf IsEmpty(Assets.Range(\"W\" &amp; Counter)) = False And IsEmpty(Assets.Range(\"X\" &amp; Counter)) = False Then\n        BArray(i) = Array(UCase(IPCell), UCase(hostCell))\n        i = i + 1\n        Counter = Counter + 1\n\n    Else\n        Counter = Counter + 1\n    End If\n\nLoop\n\n'MsgBox (\"Here\")\n'Setting up script to handle the POAM Analysis Portion\nCounter = 2\n\nDim statusCell As String\n'Dim hostCell As String\n\nDo While Counter &lt;&gt; POAMRows + 1\n\n    statusCell = POAM.Range(\"M\" &amp; Counter)\n    hostCell = POAM.Range(\"AE\" &amp; Counter)\n\n    If statusCell = \"Ongoing\" Then\n\n        For Each v In BArray\n\n            If v(0) = hostCell Then\n                Output.Range(\"A\" &amp; SummaryCounter) = POAM.Range(\"A\" &amp; Counter)\n                Output.Range(\"B\" &amp; SummaryCounter) = POAM.Range(\"C\" &amp; Counter)\n                Output.Range(\"C\" &amp; SummaryCounter) = POAM.Range(\"D\" &amp; Counter)\n                Output.Range(\"D\" &amp; SummaryCounter) = POAM.Range(\"E\" &amp; Counter)\n                Output.Range(\"E\" &amp; SummaryCounter) = POAM.Range(\"F\" &amp; Counter)\n                Output.Range(\"F\" &amp; SummaryCounter) = POAM.Range(\"G\" &amp; Counter)\n                Output.Range(\"G\" &amp; SummaryCounter) = POAM.Range(\"R\" &amp; Counter)\n                Output.Range(\"H\" &amp; SummaryCounter) = POAM.Range(\"V\" &amp; Counter)\n                Output.Range(\"I\" &amp; SummaryCounter) = POAM.Range(\"AB\" &amp; Counter)\n                Output.Range(\"J\" &amp; SummaryCounter) = POAM.Range(\"AE\" &amp; Counter)\n\n\n                SummaryCounter = SummaryCounter + 1\n\n            ElseIf v(1) = hostCell Then\n                Output.Range(\"A\" &amp; SummaryCounter) = POAM.Range(\"A\" &amp; Counter)\n                Output.Range(\"B\" &amp; SummaryCounter) = POAM.Range(\"C\" &amp; Counter)\n                Output.Range(\"C\" &amp; SummaryCounter) = POAM.Range(\"D\" &amp; Counter)\n                Output.Range(\"D\" &amp; SummaryCounter) = POAM.Range(\"E\" &amp; Counter)\n                Output.Range(\"E\" &amp; SummaryCounter) = POAM.Range(\"F\" &amp; Counter)\n                Output.Range(\"F\" &amp; SummaryCounter) = POAM.Range(\"G\" &amp; Counter)\n                Output.Range(\"G\" &amp; SummaryCounter) = POAM.Range(\"R\" &amp; Counter)\n                Output.Range(\"H\" &amp; SummaryCounter) = POAM.Range(\"V\" &amp; Counter)\n                Output.Range(\"I\" &amp; SummaryCounter) = POAM.Range(\"AB\" &amp; Counter)\n                Output.Range(\"J\" &amp; SummaryCounter) = POAM.Range(\"AE\" &amp; Counter)\n\n\n                SummaryCounter = SummaryCounter + 1\n            End If\n        Next\n        Counter = Counter + 1\n    Else\n        Counter = Counter + 1\n    End If\nLoop\n</code></pre>\n"}, {"tags": ["vba", "web-scraping", "internet-explorer-11", "queryselector"], "answers": [{"comments": [{"owner": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "edited": false, "score": 0, "creation_date": 1572513867, "post_id": 58634915, "comment_id": 103585978, "body": "Although the macro appears to be working in the right way, the result is different from what I see when I do the same manually @QHarr. When I try manually I get <code>22</code> results whereas the macro gives me <code>28</code>. How can I fix it? <b><i><a href=\"https://pastebin.com/rCasfSbb\" rel=\"nofollow noreferrer\">This is</a></i></b> what my current approah is. Here goes <b><i><a href=\"https://filebin.net/iwgti260elqrpwlq\" rel=\"nofollow noreferrer\">an image</a></i></b> which shows how the filled-in boxes look like before clicking on the find button. Thanks in advance."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "edited": false, "score": 0, "creation_date": 1572514656, "post_id": 58634915, "comment_id": 103586389, "body": "Sure. I am working at moment but will update asap for you (provided I find solution)."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "edited": false, "score": 1, "creation_date": 1572547354, "post_id": 58634915, "comment_id": 103603713, "body": "Haven&#39;t forgotten this. Tonight will look."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "edited": false, "score": 0, "creation_date": 1572552267, "post_id": 58634915, "comment_id": 103605828, "body": "Well done. Do you still want me to look at this then?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "edited": false, "score": 0, "creation_date": 1573045617, "post_id": 58634915, "comment_id": 103752197, "body": "No need to guarantee me. Vote as you usually would. I will look at your docs though seems to be an .rar so will need to remind myself how I open those."}, {"owner": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "edited": false, "score": 0, "creation_date": 1573046339, "post_id": 58634915, "comment_id": 103752615, "body": "Okay, <a href=\"https://filebin.net/k4vz60h2vh0uu254\" rel=\"nofollow noreferrer\">this link</a> will help. Thanks."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "edited": false, "score": 0, "creation_date": 1573060996, "post_id": 58634915, "comment_id": 103761146, "body": "ok.. how urgent is this? I have another OP who asked a follow-up as well. Does it need to be today or can it wait until potentially fri/sat?"}, {"owner": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "edited": false, "score": 0, "creation_date": 1573062147, "post_id": 58634915, "comment_id": 103761724, "body": "Hey QHarr, it&#39;s not a matter of urgency. The thing is I can&#39;t take a breather unless I can disentangle any issue. I can accomplish the same using selenium but in case of IE the pain is ongoing which is difficult to endure. Thanks."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "edited": false, "score": 0, "creation_date": 1573062195, "post_id": 58634915, "comment_id": 103761751, "body": "I understand. I\u2019ll have a look today."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "edited": false, "score": 0, "creation_date": 1573062234, "post_id": 58634915, "comment_id": 103761762, "body": "Will you be around to answer question and should I open a chat room for us?"}, {"owner": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "edited": false, "score": 0, "creation_date": 1573063633, "post_id": 58634915, "comment_id": 103762396, "body": "Sure. Sorry for my belated response."}, {"owner": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "edited": false, "score": 0, "creation_date": 1573064231, "post_id": 58634915, "comment_id": 103762648, "body": "Dteleted some comments to make some space. Please inform me when you create a chat room as this is gonna be my first time and I don&#39;t know anything about this chat room. Thanks."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "edited": false, "score": 0, "creation_date": 1573064273, "post_id": 58634915, "comment_id": 103762666, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/201960/discussion-between-qharr-and-mithu\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1572477651, "creation_date": 1572477651, "answer_id": 58634915, "question_id": 58630415, "link": "https://stackoverflow.com/questions/58630415/unable-to-fill-in-some-date-inputs-to-perform-a-customized-search/58634915#58634915", "title": "Unable to fill in some date inputs to perform a customized search", "body": "<p>Just set the value attributes</p>\n\n<pre><code>Option Explicit\nPublic Sub SetDates()\n    Dim ie As InternetExplorer\n\n    Set ie = New InternetExplorer\n\n    With ie\n        .Visible = True\n        .Navigate2 \"https://www.discoverqatar.qa/\"\n\n        While .Busy Or .readyState &lt;&gt; 4: DoEvents: Wend\n\n        With .document\n            .querySelector(\"#lpPannel_txtFromDate\").Value = \"03/11/2019\"\n            .querySelector(\"#lpPannel_txtToDate\").Value = \"05/11/2019\"\n            .querySelector(\"#btnSearch\").Click\n            Stop\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 58634915, "answer_count": 1, "score": 1, "last_activity_date": 1572477651, "creation_date": 1572454938, "question_id": 58630415, "link": "https://stackoverflow.com/questions/58630415/unable-to-fill-in-some-date-inputs-to-perform-a-customized-search", "title": "Unable to fill in some date inputs to perform a customized search", "body": "<p>I'm trying to create a script in vba to select dates according to my preferable <code>input date</code>, as in <code>03/11/2019</code> and <code>output date</code>, as in <code>05/11/2019</code> for the two fields <code>check-in</code> and <code>chek-out</code>. the macro that I've written so far can click on those fields but can't fill in the inputs with the aforesaid dates.</p>\n\n<p><a href=\"https://www.discoverqatar.qa/\" rel=\"nofollow noreferrer\">Website address</a></p>\n\n<p>I've tried:</p>\n\n<pre><code>Sub FillInTheForm()\n    Dim IE As New InternetExplorer, HTML As HTMLDocument\n    Dim post As Object, elem As Object, guest As Object\n    Dim findbtn As Object, URL$\n\n    URL = \"https://www.discoverqatar.qa/\"\n\n    With IE\n        .Visible = True\n        .navigate URL\n        While .Busy = True Or .readyState &lt; 4: DoEvents: Wend\n        Application.Wait Now + TimeValue(\"00:00:05\")\n        Set post = .document.querySelector(\"[class='rsp_s_checkindate_input'] &gt; #lpPannel_txtFromDate\")\n        post.Focus\n        post.Click\n\n        Application.Wait Now + TimeValue(\"00:00:05\")\n        Set elem = .document.querySelector(\"[class='rsp_s_checkoutdate_input'] &gt; #lpPannel_txtToDate\")\n        elem.Focus\n        elem.Click\n\n        Application.Wait Now + TimeValue(\"00:00:05\")\n        Set guest = .document.querySelector(\"#lblPaxInfo\")\n        guest.Focus\n        guest.Click\n\n        Application.Wait Now + TimeValue(\"00:00:05\")\n        Set findbtn = .document.querySelector(\"input#btnSearch\")\n        findbtn.Focus\n        findbtn.Click\n    End With\n'    IE.Quit\nEnd Sub\n</code></pre>\n\n<p>Some intentional delays are there within the script which I can kick out later defining any timed loop.</p>\n\n<blockquote>\n  <p>How can I fill in the dates in those boxes to perform a customized search?</p>\n</blockquote>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1572453460, "post_id": 58629996, "comment_id": 103567237, "body": "Why not copy the whole row and then delete those columns?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1572453574, "post_id": 58629996, "comment_id": 103567297, "body": "Indenting your code and spacing it out a little makes it much more readable."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1572453602, "post_id": 58629996, "comment_id": 103567311, "body": "^ <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">Check out this cool indenter</a> :)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1572453620, "post_id": 58629996, "comment_id": 103567325, "body": "And do you actually need the whole row? All 16k columns or however many it is?"}, {"owner": {"reputation": 13, "user_id": 12298513, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pdTXl8TYloQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfWcZhl9nOARqwPuCRSf3ypGH55Gg/photo.jpg?sz=128", "display_name": "Jorge Jimenez", "link": "https://stackoverflow.com/users/12298513/jorge-jimenez"}, "edited": false, "score": 0, "creation_date": 1572454119, "post_id": 58629996, "comment_id": 103567562, "body": "I have 200 columns and 15000 rows, I need to exclude of the copy that columns because I need to show the differences"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1572454771, "post_id": 58629996, "comment_id": 103567882, "body": "Just an FYI.  Might want to change in <code>For i = RngToChk.Rows.Coumt To 1 Step -1</code> to  <code>For i = RngToChk.Rows.Count To 1 Step -1</code>."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 12298513, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pdTXl8TYloQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfWcZhl9nOARqwPuCRSf3ypGH55Gg/photo.jpg?sz=128", "display_name": "Jorge Jimenez", "link": "https://stackoverflow.com/users/12298513/jorge-jimenez"}, "edited": false, "score": 0, "creation_date": 1572459296, "post_id": 58630452, "comment_id": 103569984, "body": "Is almost the solution but in column J is copyong the value of A1 below the information."}, {"owner": {"reputation": 13, "user_id": 12298513, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pdTXl8TYloQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfWcZhl9nOARqwPuCRSf3ypGH55Gg/photo.jpg?sz=128", "display_name": "Jorge Jimenez", "link": "https://stackoverflow.com/users/12298513/jorge-jimenez"}, "edited": false, "score": 0, "creation_date": 1572467946, "post_id": 58630452, "comment_id": 103573562, "body": "How I can call It?"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "reply_to_user": {"reputation": 13, "user_id": 12298513, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pdTXl8TYloQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfWcZhl9nOARqwPuCRSf3ypGH55Gg/photo.jpg?sz=128", "display_name": "Jorge Jimenez", "link": "https://stackoverflow.com/users/12298513/jorge-jimenez"}, "edited": false, "score": 0, "creation_date": 1572468282, "post_id": 58630452, "comment_id": 103573719, "body": "The last row is an example of how to call it"}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": true, "score": 1, "last_activity_date": 1572461699, "last_edit_date": 1572461699, "creation_date": 1572455103, "answer_id": 58630452, "question_id": 58629996, "link": "https://stackoverflow.com/questions/58629996/how-to-make-exceptions-in-a-copy-of-a-row/58630452#58630452", "title": "How to make exceptions in a copy of a row", "body": "<p>Add this function to your module:</p>\n\n<pre><code>Function AlmostEntireRow(StartingPoint As Range) As Range\n    Dim Row As Long\n    Dim TargetSheet As Worksheet\n    Row = StartingPoint.Row\n    Set TargetSheet = StartingPoint.Worksheet\n    Set AlmostEntireRow = Union(TargetSheet.Range(\"A\" &amp; Row &amp; \":F\" &amp; Row), TargetSheet.Range(\"J\" &amp; Row &amp; \":GR\" &amp; Row))\nEnd Function\n</code></pre>\n\n<p>When you are using it, replace</p>\n\n<pre><code>RngToPaste.EntireRow.Font.Color=RGB(255,0,0)\n</code></pre>\n\n<p>with </p>\n\n<pre><code>AlmostEntireRow(RngToPaste).Font.Color = RGB(255, 0, 0)\n</code></pre>\n\n<p>and so on.</p>\n\n<p>The function builds a range from the input range, consisting of columns A to F and J to GR. Adjust as needed.</p>\n\n<p><strong>Update</strong><br>\nThe suggested method does not work when copying rows. Here is a copy method as well.  </p>\n\n<pre><code>Sub CopyAlmostEntireRow(FromRow As Range, ToRow As Range)\n    Dim FromRange As Range\n    Dim ToRange As Range\n\n    Set FromRange = FromRow.Worksheet.Range(\"A\" &amp; FromRow.Row &amp; \":F\" &amp; FromRow.Row)\n    Set ToRange = ToRow.Worksheet.Range(\"A\" &amp; ToRow.Row &amp; \":F\" &amp; ToRow.Row)\n    ToRange.Value = FromRange.Value\n\n    Set FromRange = FromRow.Worksheet.Range(\"J\" &amp; FromRow.Row &amp; \":GR\" &amp; FromRow.Row)\n    Set ToRange = ToRow.Worksheet.Range(\"J\" &amp; ToRow.Row &amp; \":GR\" &amp; ToRow.Row)\n    ToRange.Value = FromRange.Value\n\nEnd Sub\n\n' Call with something like this:\nCopyAlmostEntireRow RngToChk(i), RngToPaste\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12298513, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pdTXl8TYloQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfWcZhl9nOARqwPuCRSf3ypGH55Gg/photo.jpg?sz=128", "display_name": "Jorge Jimenez", "link": "https://stackoverflow.com/users/12298513/jorge-jimenez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 58630452, "answer_count": 1, "score": 1, "last_activity_date": 1572461699, "creation_date": 1572453314, "last_edit_date": 1572455133, "question_id": 58629996, "link": "https://stackoverflow.com/questions/58629996/how-to-make-exceptions-in-a-copy-of-a-row", "title": "How to make exceptions in a copy of a row", "body": "<p>I'm beginner at Macros I need to do a copy of rows but I have to exclude some columns. EntireRow is working but I need to exclude the columns I,G,H</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Macro1()\n    Dim RngToChk as Range, RngToPaste as Range\n    Set RngToCheck=Application.InputBox(Prompt:=\"enter range\", Type:=8)\n    Dim strtofind as String\n    Inttofind=InputBox(\"Give your Indicator\")\n    Dim i as long\n    For i = RngToChk.Rows.Count To 1 Step -1\n        If RngToChk(i).value=strtofind Then\n            RngToCheck(i).Offset(1).EntireRow.Insert\n            Set RngToPaste=RngToChk(i).Offset(1)\n            RngToPaste.EntireRow.Value=RngToChk(i).EntireRow.Value\n            RngToPaste.EntireRow.Font.Color=RGB(255,0,0)\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9730739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17105cc7085b85d7fa0115b5ca681ee1?s=128&d=identicon&r=PG&f=1", "display_name": "Ronie Batley", "link": "https://stackoverflow.com/users/9730739/ronie-batley"}, "edited": false, "score": 0, "creation_date": 1572462149, "post_id": 58630565, "comment_id": 103571231, "body": "yes, the source is date and time, when you say alter what should I alter?   When I add the code and run, it closes the form."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "reply_to_user": {"reputation": 11, "user_id": 9730739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17105cc7085b85d7fa0115b5ca681ee1?s=128&d=identicon&r=PG&f=1", "display_name": "Ronie Batley", "link": "https://stackoverflow.com/users/9730739/ronie-batley"}, "edited": false, "score": 0, "creation_date": 1572463290, "post_id": 58630565, "comment_id": 103571695, "body": "For clarification, I assume you don&#39;t care what time the Submit button is clicked, you only care about the date/time value that is in &#39;Me.tblEntered&#39;? As for the form being closed, we have no idea what code you did not include. Your logic checks if it is after 3PM, and if so, asks if you want to save. If it is BEFORE 3PM, what do you want to do? Save it also? If so, add an &quot;Else&quot; and &quot;DoCmd.Save&quot;"}], "tags": [], "owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "is_accepted": false, "score": 0, "last_activity_date": 1572455551, "creation_date": 1572455551, "answer_id": 58630565, "question_id": 58629982, "link": "https://stackoverflow.com/questions/58629982/access-vba-check-date-time-if-greater-than-today-300-pm-then-vb-question-erro/58630565#58630565", "title": "Access VBA Check Date time, if greater than today 3:00 PM, then vb question error message", "body": "<p>There are several errors with your code (missing \"End If\", Using \"IIf\" instead of \"If\", Flow of your date check yes/no response)</p>\n\n<p>I don't know the format/content of your source: Me.tblEntered  is it just a date or is it Date &amp; Time? If includes time, then alter my \"Date + #3:00:00 PM#\"</p>\n\n<pre><code>Dim mDate As Date\nmDate = DateValue(Me.tblEntered)\n\nIf (mDate &gt; Date + #3:00:00 PM#) Then       ' Today at 3PM\n    If MsgBox(\"You are submitting a request after the 3:00 PM cutoff time. \" &amp; Chr(13) &amp; _\n        \"You should change your request to the next day.  Do you want to change your request date?\", vbYesNo + vbQuestion + vbDefaultButton2) = vbNo Then\n        DoCmd.Save\n    Else\n        MsgBox \"Please make changes and resubmit\"\n    End If\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1572459445, "creation_date": 1572459445, "answer_id": 58631494, "question_id": 58629982, "link": "https://stackoverflow.com/questions/58629982/access-vba-check-date-time-if-greater-than-today-300-pm-then-vb-question-erro/58631494#58631494", "title": "Access VBA Check Date time, if greater than today 3:00 PM, then vb question error message", "body": "<p>You should use <em>DateDiff</em> for this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim mDate As Date\n\n' If tblEntered is text:\nmDate = CDate(Me!tblEntered.Value)\n' If tblEntered is DateTime:\nmDate = Me!tblEntered.Value\n\nIf DateDiff(\"n\", DateAdd(\"h\", 15, Date), mDate) &gt; 0 Then\n    If MsgBox(\"You are submitting a request after the 3:00 PM cutoff time. \" &amp; vbCrLf &amp; _\n        \"You should change your request to the next day.  Do you want to change your request date?\", vbYesNo + vbQuestion + vbDefaultButton2) = vbNo Then\n    DoCmd.Save\nElse\n    MsgBox \"Please make changes and resubmit.\"\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14523746, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/b74101cda845d57036e9008dd87bd09b?s=128&d=identicon&r=PG", "display_name": "Harvey", "link": "https://stackoverflow.com/users/14523746/harvey"}, "is_accepted": false, "score": 0, "last_activity_date": 1603735129, "last_edit_date": 1603735129, "creation_date": 1603732756, "answer_id": 64541950, "question_id": 58629982, "link": "https://stackoverflow.com/questions/58629982/access-vba-check-date-time-if-greater-than-today-300-pm-then-vb-question-erro/64541950#64541950", "title": "Access VBA Check Date time, if greater than today 3:00 PM, then vb question error message", "body": "<p>In a query use:</p>\n<pre><code>IIf(Format([DateCreated],&quot;hh&quot;)&gt;=15,&quot;after 3&quot;,&quot;before 3&quot;)\n</code></pre>\n<p>In VBA use:</p>\n<pre><code>Dim mDate As Date\n\nIf format(mDate,&quot;hh&quot;) &gt;= 15 Then       ' Today at 3PM\n    If MsgBox(&quot;You are submitting a request after the 3:00 PM cutoff time. &quot; &amp; Chr(13) &amp; _\n        &quot;You should change your request to the next day.  Do you want to change your request date?&quot;, vbYesNo + vbQuestion + vbDefaultButton2) = vbNo Then\n        DoCmd.Save\n    Else\n        MsgBox &quot;Please make changes and resubmit&quot;\n    End If\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9730739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17105cc7085b85d7fa0115b5ca681ee1?s=128&d=identicon&r=PG&f=1", "display_name": "Ronie Batley", "link": "https://stackoverflow.com/users/9730739/ronie-batley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 584, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1603735129, "creation_date": 1572453265, "last_edit_date": 1594421048, "question_id": 58629982, "link": "https://stackoverflow.com/questions/58629982/access-vba-check-date-time-if-greater-than-today-300-pm-then-vb-question-erro", "title": "Access VBA Check Date time, if greater than today 3:00 PM, then vb question error message", "body": "<p>I have a request form that has a submit button.  On click, I would like for access to check the submit date to see if it is greater than 3:00 pm today.  If yes, then a message box appears for you to change the requested date and resubmit.</p>\n\n<p>This is what I tried, but errors out.</p>\n\n<p>Please assist if possible</p>\n\n<pre><code>Dim mDate As Date\nmDate = DateValue(Me.tblEntered)\nIIf (mDate &gt; \"3:00 pm\")\n    If MsgBox(\"You are submitting a request after the 3:00 PM cutoff time. \" &amp; Chr(13) &amp; _\n    \"You should change your request to the next day.  Do you want to change your request date?\", vbYesNo + vbQuestion + vbDefaultButton2) = vbNo Then\n    DoCmd.Save\nElse\n    MsgBox \"Please make changes and resubmit\"\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 4, "creation_date": 1572452888, "post_id": 58629864, "comment_id": 103566911, "body": "Do you have an <code>On Error Resume Next</code> hiding out somewhere? <code>dat = &quot;01.05.2009  15:42:00&quot;</code> will throw a type mismatch error, because that is not a valid date representation. Note - is your underlying data <i>text-that-looks-like-dates</i>?"}, {"owner": {"reputation": 3, "user_id": 12298549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29229c892b8e4e973e9df5c258b0de59?s=128&d=identicon&r=PG&f=1", "display_name": "hitodeman", "link": "https://stackoverflow.com/users/12298549/hitodeman"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1572471563, "post_id": 58629864, "comment_id": 103574954, "body": "the intended cells are indeed formatted as dates (DD.MM.YYYY hh:mm) Strangely I am not getting an error on <code>dat = &quot;01.05.2009 15:42:00&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12298549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29229c892b8e4e973e9df5c258b0de59?s=128&d=identicon&r=PG&f=1", "display_name": "hitodeman", "link": "https://stackoverflow.com/users/12298549/hitodeman"}, "edited": false, "score": 0, "creation_date": 1572472850, "post_id": 58631392, "comment_id": 103575366, "body": "Thank you for the suggestion. Declaring dat as String did work for me. Interestingly, my original Code worked without problems on my secondary pc. Even more odd: on that pc the code does NOT work when dat is declared as String. how can that be?"}], "tags": [], "owner": {"reputation": 26, "user_id": 8070996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2bc443ec623a446148c7f7cdf53c2f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff S.", "link": "https://stackoverflow.com/users/8070996/jeff-s"}, "is_accepted": true, "score": 0, "last_activity_date": 1572458945, "creation_date": 1572458945, "answer_id": 58631392, "question_id": 58629864, "link": "https://stackoverflow.com/questions/58629864/finding-cell-with-specific-value-and-return-position/58631392#58631392", "title": "Finding cell with specific value and return position", "body": "<p>I assume you are displaying dates in your worksheet as something like Custom \"mm.dd.yy HH:MM:SS\" Find is a little finicky about looking for dates and works most predictably when you search for a date string that matches your display format.</p>\n\n<p>I think your code will work if you declare dat as String, or if you are working with a Date variable (instead of hard coding the value, as in your example), use </p>\n\n<pre><code>What:=Format(dat, \"mm.dd.yy HH:MM:SS\")\n</code></pre>\n\n<p>Nonetheless @BigBen is correct that the code you have posted should raise an error on</p>\n\n<pre><code>dat = \"01.05.2009  15:42:00\"\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12298549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29229c892b8e4e973e9df5c258b0de59?s=128&d=identicon&r=PG&f=1", "display_name": "hitodeman", "link": "https://stackoverflow.com/users/12298549/hitodeman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 58631392, "answer_count": 1, "score": 0, "last_activity_date": 1572458945, "creation_date": 1572452783, "last_edit_date": 1572452972, "question_id": 58629864, "link": "https://stackoverflow.com/questions/58629864/finding-cell-with-specific-value-and-return-position", "title": "Finding cell with specific value and return position", "body": "<p>I am new to VBA and I want to code a function which finds a date, which is stored in a variable, and returns its address. </p>\n\n<p>This is what I have got so far </p>\n\n<pre><code>Dim ran As Range\nDim dat As Date\ndat = \"01.05.2009  15:42:00\"\n\nSet ran = Cells.Find(What:=dat, LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, _\nSearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)\n\nIf ran Is Nothing Then\n    MsgBox (\"no result\")\n    Else\n    MsgBox (ran.Address)\n\nEnd If\n</code></pre>\n\n<p>When I run this snippet, it always returns \"no result\". However when I do not use variables and put it like this</p>\n\n<pre><code>Dim ran As Range\nDim dat As Date\n\nSet ran = Cells.Find(What:=\"01.05.2009  15:42:00\", LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, _\nSearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)\n\nIf ran Is Nothing Then\n    MsgBox (\"no result\")\n    Else\n    MsgBox (ran.Address)\n\nEnd If\n</code></pre>\n\n<p>it returns the address of the cell as expected.</p>\n\n<p>Since I want to use this code snippet later in a larger project, I need this to work with a variable such that it can be used in a loop with a series of different searches.</p>\n\n<p>I would be very grateful if somebody can tell me where I am going wrong, or knows an better approach to this.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1572452732, "post_id": 58629825, "comment_id": 103566838, "body": "Check the <code>Intersect</code>ion of the result of the inputbox and the range in question."}], "owner": {"reputation": 11, "user_id": 12298542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bea871ff41ecb9a093c4a094d4e9b683?s=128&d=identicon&r=PG&f=1", "display_name": "Alex182", "link": "https://stackoverflow.com/users/12298542/alex182"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1572452991, "creation_date": 1572452651, "last_edit_date": 1572452991, "question_id": 58629825, "link": "https://stackoverflow.com/questions/58629825/vba-application-inputbox-validation-selection-only-within-certain-range", "title": "VBA Application.InputBox Validation. Selection only within certain range", "body": "<p>I'm looking to create an input box for users to select a cell, and the macro will filter some external data by the users selection.</p>\n\n<p>I want to add validation to the selection so users can only select a cell with a value of \"TRUE\" and only within a certain range e.g column Range(\"J4:J100\")</p>\n\n<p>Code so far:</p>\n\n<pre><code>Dim rng As Range\nSet rng = Range(\"J4:J100\")\n\nDim criteria1 As Range\nSet criteria1 = Application.InputBox(\"Select a range\", \"Obtain Range Object\", Type:=8)\n\nDim criteria2 As String\ncriteria2 = criteria1.Offset(0, -9)\n\nDim ws As Worksheet\nSet ws = Worksheets(\"Reference_log\")\n\nws.Select\n\nDim LastRow As Long\nLastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n\nDim LastColumn As Long 'Find the last non-blank cell in row 2\nLastColumn = Cells(2, Columns.Count).End(xlToLeft).Column\n\nSet Rng1 = Cells(2, 8)\nSet Rng2 = Cells(LastRow, LastColumn)\n\n\n\nActiveSheet.Range(Rng1, Rng2).AutoFilter Field:=2, criteria1:=Array(\"*\" &amp; criteria2 &amp; \"*\"), Operator:=xlFilterValues\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 5, "creation_date": 1572452482, "post_id": 58629743, "comment_id": 103566685, "body": "You&#39;ve made a typo. <code>Dim db As DAO</code> should be <code>Dim db As DAO.Database</code>, of course. <code>DAO</code> is a project, thus the error text."}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 11725140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7515ca6774d9b06ccbdd0bcfe7147c02?s=128&d=identicon&r=PG&f=1", "display_name": "mongoose00318", "link": "https://stackoverflow.com/users/11725140/mongoose00318"}, "edited": false, "score": 0, "creation_date": 1572458398, "post_id": 58629929, "comment_id": 103569585, "body": "Okay well I have the error fixed. It isn&#39;t inserting data into the DB and I am getting no error."}, {"owner": {"reputation": 131, "user_id": 11725140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7515ca6774d9b06ccbdd0bcfe7147c02?s=128&d=identicon&r=PG&f=1", "display_name": "mongoose00318", "link": "https://stackoverflow.com/users/11725140/mongoose00318"}, "edited": false, "score": 1, "creation_date": 1572458804, "post_id": 58629929, "comment_id": 103569770, "body": "Fixed it. Thank you!"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1572453060, "creation_date": 1572453060, "answer_id": 58629929, "question_id": 58629743, "link": "https://stackoverflow.com/questions/58629743/expected-user-defined-type-not-project/58629929#58629929", "title": "Expected user-defined type, not project", "body": "<p>And you missed the update:</p>\n\n<pre><code>       With rs\n            .AddNew\n            .Fields(\"file_path\").Value = file_path\n            .Fields(\"file_id\").Value = file_id\n            .Fields(\"file_title\").Value = file_title\n            .Fields(\"lang_code\").Value = lang_code\n            If UBound(v) &gt;= 6 Then\n                .Fields(\"creation_date\").Value = creation_date\n            End If\n            .Update\n       End With\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 11725140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7515ca6774d9b06ccbdd0bcfe7147c02?s=128&d=identicon&r=PG&f=1", "display_name": "mongoose00318", "link": "https://stackoverflow.com/users/11725140/mongoose00318"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1106, "favorite_count": 0, "accepted_answer_id": 58629929, "answer_count": 1, "score": 1, "last_activity_date": 1572453060, "creation_date": 1572452361, "last_edit_date": 1572452414, "question_id": 58629743, "link": "https://stackoverflow.com/questions/58629743/expected-user-defined-type-not-project", "title": "Expected user-defined type, not project", "body": "<p>I've looked through several pages on SF on this error. This is the first time I've tried to add records to Access via VBA. Here is my code:</p>\n\n<pre><code>Option Compare Database\n\nPublic Sub Retrieve_SOPS()\n' Retrieve SOP files\n    'Record starting timer - BEGIN\n    Dim StartTime As Double\n    StartTime = Timer\n\n    'Set network folder path\n    Const FolderPath As String = \"\\\\JACKSONVILLE-DC\\Common\\SOP's for JV\\SOPs Final\"\n\n    'Instantiate FSO\n    Dim oFSO As Object\n    Dim oFolder As Object\n    Dim oFiles As Object\n    Dim oFile As Object\n    Set oFSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set oFolder = oFSO.GetFolder(FolderPath)\n    Set oFiles = oFolder.Files\n\n    'Instantiate DAO\n    Dim db As DAO\n    Dim rs As DAO.Recordset\n    Set db = CurrentDb\n    Set rs = db.OpenRecordset(\"tblSOP\", dbOpenDynaset)\n\n    Dim v As Variant\n\n    'Loop through each file in FSO\n    For Each oFile In oFiles\n        'Remove temporary/hidden files\n        If (oFile.Attributes And 2) &lt;&gt; 2 Then\n            'Split filename\n            v = Split(oFile.Name, \"-\")\n\n            ' Instantiate Necessary Variables\n            Dim file_path As String\n            Dim file_id As Integer\n            Dim file_title As String\n            Dim lang_code As String\n            Dim creation_date As String\n\n            file_path = oFile.Path\n            file_id = v(2)\n            file_title = v(4)\n            lang_code = v(5)\n            'If dimension in array exists; Remove file extension\n            If UBound(v) &gt;= 6 Then\n                creation_date = v(6)\n            End If\n\n            With rs\n                .AddNew\n\n                .Fields(\"file_path\").Value = file_path\n                .Fields(\"file_id\").Value = file_id\n                .Fields(\"file_title\").Value = file_title\n                .Fields(\"lang_code\").Value = lang_code\n                If UBound(v) &gt;= 6 Then\n                    .Fields(\"creation_date\").Value = creation_date\n                End If\n            End With\n        End If\n\n        'Stop For Loop (TEMP)\n        Exit Sub\n    Next oFile\nEnd Sub\n</code></pre>\n\n<p>Then I get this error: \"Compile error: Expected user-defined type, not project\"</p>\n\n<p>I'm reading \"Microsoft Access 2019 Bible\" By Wiley.</p>\n\n<p>I have read the following links but still can't understand what I am doing wrong:</p>\n\n<ol>\n<li><p><a href=\"https://stackoverflow.com/questions/5349580/compiler-error-user-defined-types-not-defined\">Compiler Error: User-defined types not defined</a></p></li>\n<li><p><a href=\"https://stackoverflow.com/questions/49169591/ms-access-compile-error-user-defined-type-not-defined\">ms access compile error: user-defined type not defined</a></p></li>\n</ol>\n"}, {"tags": ["excel", "vba", "listbox", "autofilter"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12298454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d3f0de07f4b04b3865ad57914dc8d8?s=128&d=identicon&r=PG&f=1", "display_name": "emcalleja_", "link": "https://stackoverflow.com/users/12298454/emcalleja"}, "edited": false, "score": 0, "creation_date": 1572454763, "post_id": 58630040, "comment_id": 103567876, "body": "Hi, thank you for the fast response, it actually worked but i need to put each record in a single row in my listbox. Your solution does put the filtered data in the listbox but puts each cell of each record in different rows. Thank you so much!"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1572455202, "post_id": 58630040, "comment_id": 103568117, "body": "Friendly hint: OP requests a 2-dim array (i.e. <code>Range(&quot;A2:Q&quot; &amp; lastRow)</code>). - Further notes: 1) I&#39;d avoid repetitive <code>ReDim Preserve</code> within the loop.  Just dimension the array to the maximum row index before and execute a  <code>ReDim Preserve Myarr(0 To i - 1)</code> outside the loop in a second step.  2) Looping through a range by means of VBA is time consuming; suggest to  assign the entire range including empty rows to a temporary array and to  loop through this one instead skipping the empty items :-)"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 3, "user_id": 12298454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d3f0de07f4b04b3865ad57914dc8d8?s=128&d=identicon&r=PG&f=1", "display_name": "emcalleja_", "link": "https://stackoverflow.com/users/12298454/emcalleja"}, "edited": false, "score": 0, "creation_date": 1572456842, "post_id": 58630040, "comment_id": 103568887, "body": "@emcalleja_ You are correct, you needed up to column Q on your line. I&#39;ve updated my answer which will add all that is required to your array. I took @T.M. comments to heart as well, however struggled with the final <code>redim preserve</code> as it throws a &quot;Subscript out of range&quot; whatever I do. Perhaps any suggestion on how to implement?"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1572457377, "post_id": 58630040, "comment_id": 103569114, "body": "@T.M. Never mind, got there eventually. Thanks for the tips!"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1572458155, "post_id": 58630040, "comment_id": 103569479, "body": "@Plutian - Sorry, forgot that you changed to a 2-dim array, as a <code>ReDim</code> only can change the <b>last</b> <i>array dimension</i>, i.e. the 2nd one in the post above. A work around could be to interchange rows/columns, to redim and eventually transpose the resulting array (caveat: possible limitation to 65K of rows in versions before Office 2019? when transposing)"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1572458944, "post_id": 58630040, "comment_id": 103569833, "body": "@T.M. Yeah I realised my <code>unbound array</code> just returns the same array on my way home just now. Perhaps a pre-counter could work to see how many rows you need. I&#39;ve no access to a PC until tomorrow so can&#39;t update my answer."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1572460266, "post_id": 58630040, "comment_id": 103570437, "body": "@Plutian - Suggest the following steps:  a) Interchange row/column arguments by a first <code>ReDim Myarr(0 To 17, 0 To lastr)</code>,  b) assign <code>Myarr(j, i) = cel.Offset(0,j)</code> within the inner <code>For</code>- <code>Next</code> loop, c) execute a <code>ReDim Preserve Myarr(0 To 17, 0 to i -1)</code> outside the outer <code>cel</code> loop and d) assign the array using the listbox&#39;es <b><code>.Column</code></b> <i>property</i> via <code>.Column = Myarr</code>  <i>(thus <b>avoiding</b> a <code>Application.Transpose</code> plus later assignment to <code>.List = Myarr</code>)</i>"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1572513751, "post_id": 58630040, "comment_id": 103585921, "body": "@T.M. Thank you for the suggestions, the code has been adapted. Nice trick with the <code>.Column</code> assignment, I would&#39;ve never thought of that. @emcalleja_ the now posted answer should work perfectly for your needs."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1572600305, "post_id": 58630040, "comment_id": 103616963, "body": "@Plutian - you are welcome; BTW edited your post replacing integer declarations to <code>Long</code> (<code>lastrow</code> could be higher than ~65K); fully qualified range assignment <code>Set rang = Sheet1.Range(\u2026)</code>; <code>i = 0</code> is redundant as default value after declaration equals Zero."}], "tags": [], "owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "is_accepted": true, "score": 1, "last_activity_date": 1572600051, "last_edit_date": 1572600051, "creation_date": 1572453521, "answer_id": 58630040, "question_id": 58629534, "link": "https://stackoverflow.com/questions/58629534/populating-a-listbox-with-previously-filtered-data/58630040#58630040", "title": "Populating a listbox with previously filtered data", "body": "<p>You cannot add all visible cells in a range to an array like that, it will stop at the first time a cell is skipped, because you can only assign one range to an array at a time, and technically you are adding multiple ranges (since you skip cells).</p>\n\n<p>To get around this, you can run a <code>for each</code> on your filtered range, and add all visible cells to your array separately. Something like this:</p>\n\n<pre><code>Sub listbox()\nDim i       As Long, lastr As Long, j As Long\nDim cel     As Range\nDim Myarr() As Variant\nDim rang    As Range\n\nlastr = Sheet1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nSet rang = Sheet1.Range(\"A2:A\" &amp; lastr)\n\nReDim Myarr(0 To 17, 0 To lastr)\nFor Each cel In rang\n\n    If Not cel.Rows.Hidden Then\n        For j = 0 To 17\n            Myarr(j, i) = cel.Offset(0, j)\n        Next j\n        i = i + 1\n    End If\n\nNext cel\nReDim Preserve Myarr(0 To 17, 0 To i - 1)\n\nWith Sheet1.ListBox1\n    .Column = Myarr\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><em>Edit:</em> as per T.M.'s suggestions I've switched how the array is assigned, adapted the <code>Redim</code> statement to match, and assign it to the listbox with the <code>.column</code> property. This gets rid of any excess rows towards the end.</p>\n"}], "owner": {"reputation": 3, "user_id": 12298454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d3f0de07f4b04b3865ad57914dc8d8?s=128&d=identicon&r=PG&f=1", "display_name": "emcalleja_", "link": "https://stackoverflow.com/users/12298454/emcalleja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 0, "accepted_answer_id": 58630040, "answer_count": 1, "score": 0, "last_activity_date": 1580509611, "creation_date": 1572451674, "last_edit_date": 1580509611, "question_id": 58629534, "link": "https://stackoverflow.com/questions/58629534/populating-a-listbox-with-previously-filtered-data", "title": "Populating a listbox with previously filtered data", "body": "<p>I'm trying to populate a listbox with information from a filtered data.</p>\n\n<p>The display only shows the first row filtered.</p>\n\n<p>I tried <code>specialcells(xlcelltypevisible)</code>.</p>\n\n<p>Here's some code:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\nDim Rang1 As Range\nDim LastCell As Long\nDim LastCell1 As Long\nDim WS As Worksheet\nDim Rang  As Range\nDim MyArr As Variant\n\nSet WS = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    'Define last row\n    With WS\n        LastCell = .Range(\"A\" &amp; Sheets(\"Mt-Gral\").Rows.Count).End(xlUp).Row\n    End With\n\n    'Define filtering range\n    Set Rang = WS.Range(\"A2:Q\" &amp; LastCell)\n\n    'Filter\n    WS.Activate\n\n    Rang.Select\n    Selection.AutoFilter Field:=10, Criteria1:=\"&lt;&gt;Closed\"\n    Selection.AutoFilter Field:=4, Criteria1:=\"&lt;&gt;Production\"\n    Set Rang1 = Rang.SpecialCells(xlCellTypeVisible)\n\n    MyArr = Rang1\n\n    With Me.ListBox1\n        .ColumnCount = 8\n        .ColumnWidths = \"80pt;80pt;40pt;60pt;60pt;60pt;60pt;150pt\"\n        .MultiSelect = fmMultiSelectExtended\n        .List = (MyArr)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1572450382, "post_id": 58628961, "comment_id": 103565464, "body": "You have a strange way to indent your code, makes it hard to read. However, it should work - but I would create two subroutines and call them from your event handler"}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1572450561, "post_id": 58628961, "comment_id": 103565565, "body": "why do u say it didnt work ? some error ?"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1572450634, "post_id": 58628961, "comment_id": 103565607, "body": "This: <code>If Not Intersect(Target, Range(&quot;D:D&quot;)) Is Nothing Then</code> does the same as this: <code>If Target.Column = 2 Or Target.Column = 3 Then</code> for different columns. You can add the second code in an <code>Else</code> statement for the your first block."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1572451478, "post_id": 58628961, "comment_id": 103566092, "body": "Consider using an <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">indenter</a> to make your indentation consistently... consistent."}, {"owner": {"reputation": 65, "user_id": 12297683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UYb16.png?s=128&g=1", "display_name": "Codingnoob", "link": "https://stackoverflow.com/users/12297683/codingnoob"}, "reply_to_user": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1572456189, "post_id": 58628961, "comment_id": 103568580, "body": "@LuisCurado When I run the code,  get a debbugging error box. If i click &#39;END&#39;, nothing happens and everything works just fine, but if I click &#39;&#39;debug&#39;&#39;, it wont work anymore."}, {"owner": {"reputation": 65, "user_id": 12297683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UYb16.png?s=128&g=1", "display_name": "Codingnoob", "link": "https://stackoverflow.com/users/12297683/codingnoob"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1572456454, "post_id": 58628961, "comment_id": 103568703, "body": "@MathieuGuindon thank you....."}, {"owner": {"reputation": 65, "user_id": 12297683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UYb16.png?s=128&g=1", "display_name": "Codingnoob", "link": "https://stackoverflow.com/users/12297683/codingnoob"}, "reply_to_user": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1572456521, "post_id": 58628961, "comment_id": 103568735, "body": "@Plutian what do you mean in a <code>Else</code> statement?  Can you please provide an example using the code I displayed ? Thank you so much"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1572457714, "post_id": 58628961, "comment_id": 103569268, "body": "At the end of your first block of code, remove the <code>End If</code> and replace it by <code>Else</code>. Then add the <code>End If</code> back at the very end of your second block. Now the two are one single block, testing for two columns first, then for another after."}, {"owner": {"reputation": 65, "user_id": 12297683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UYb16.png?s=128&g=1", "display_name": "Codingnoob", "link": "https://stackoverflow.com/users/12297683/codingnoob"}, "reply_to_user": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1572462249, "post_id": 58628961, "comment_id": 103571270, "body": "@Plutian You want me to add another <code>End If</code> back at the very end of my second block even though theres already one <code>End If</code> ? I tried and it doesnt give me anything. And I only replace the <code>End If</code> by <code>Else</code>, it gives me an error : Compilation error, bloc If without End If"}], "owner": {"reputation": 65, "user_id": 12297683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UYb16.png?s=128&g=1", "display_name": "Codingnoob", "link": "https://stackoverflow.com/users/12297683/codingnoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572486729, "creation_date": 1572449927, "last_edit_date": 1572486729, "question_id": 58628961, "link": "https://stackoverflow.com/questions/58628961/how-to-use-2-differents-block-of-code-in-the-same-worksheet", "title": "How to use 2 differents block of code in the same worksheet?", "body": "<p>I want to run 2 different codes in the same worksheet. </p>\n\n<p>I thought It worked when I tried, but when I ran the first block of code, it didn't work and stopped me at my second block of code for debugging. </p>\n\n<p>The second block of code works perfectly fine.</p>\n\n<p>Here are my 2 blocks of codes: </p>\n\n<p>The first code is to copy names from one sheet to another. The second code is to delete information in cell <code>AE</code> if cell <code>D</code> = <code>Oui</code></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n'THIS IS MY FIRST BLOCK OF CODE\n\n    If Target.Column = 2 Or Target.Column = 3 Then\n        Dim wsSuiviDeProjet As Worksheet\n        Set wsSuiviDeProjet = ActiveWorkbook.Sheets(\"SuiviDeProjet\")     \n     On Error GoTo EH\n         Dim NewRowCount As Long\n         NewRowCount = Target.Row\n         If wsSuiviDeProjet.Cells(NewRowCount, 2).Value &lt;&gt; \"\" And wsSuiviDeProjet.Cells(NewRowCount, 3).Value &lt;&gt; \"\" Then                    \n             Dim wsMonitoring As Worksheet\n             Set wsMonitoring = ActiveWorkbook.Sheets(\"Monitoring\")\n             Dim wsCoordonn\u00e9es As Worksheet\n             Set wsCoordonn\u00e9es = ActiveWorkbook.Sheets(\"coordonn\u00e9es\")           \n             If wsSuiviDeProjet.Cells(NewRowCount, 3).Value = \"oui\" Then                        \n                 Dim LastRowMonitoringSheet As Integer\n                 LastRowMonitoringSheet = wsMonitoring.Cells(wsMonitoring.Rows.Count, 1).End(xlUp).Row                           \n                 Dim dataExists As Boolean\n                 dataExists = False\n                 Dim ii As Integer\n                     For ii = 2 To LastRowMonitoringSheet\n                         If wsMonitoring.Cells(ii, 1).Value = wsSuiviDeProjet.Cells(NewRowCount, 2).Value Then\n                             dataExists = True\n                             Exit For\n                         End If\n                     Next ii               \n                         If Not dataExists Then\n                             wsMonitoring.Rows(LastRowMonitoringSheet).Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n                             LastRowMonitoringSheet = wsMonitoring.Cells(wsMonitoring.Rows.Count, 1).End(xlUp).Row                                           \n                             wsMonitoring.Cells(LastRowMonitoringSheet - 1, 1).Value = wsSuiviDeProjet.Cells(NewRowCount, 2).Value                                         \n                         Else                                           \n                         End If              \n                 End If               \n                 Dim LastRowCoordinatesSheet As Integer\n                 LastRowCoordinatesSheet = wsCoordonn\u00e9es.Cells(wsCoordonn\u00e9es.Rows.Count, 1).End(xlUp).Row                    \n                 Dim dataExistsM As Boolean\n                 dataExistsM = False                           \n                 Dim i As Integer\n                     For i = 5 To LastRowCoordinatesSheet\n                         If wsCoordonn\u00e9es.Cells(i, 1).Value = wsSuiviDeProjet.Cells(NewRowCount, 2).Value Then\n                             dataExistsM = True\n                             Exit For\n                         End If\n                     Next i                            \n                     If Not dataExistsM Then\n                         wsCoordonn\u00e9es.Cells(LastRowCoordinatesSheet + 1, 1).Value = wsSuiviDeProjet.Cells(NewRowCount, 2).Value\n                         'MsgBox (\"data inserted in COORDINATES SHEET\")                                \n                     Else                                \n                     End If                                                       \n             End If\n\n    EH:\n\n         Call CopyHighlightedData_Click\n     End If   \n\n    'THIS IS MY SECOND BLOCK OF CODE\n\n     If Not Intersect(Target, Range(\"D:D\")) Is Nothing Then\n         If Target = \"oui\" Then\n             Range(\"AE\" &amp; Target.Row).Clear\n         End If\n     End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "data-structures"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 3, "creation_date": 1572449378, "post_id": 58628627, "comment_id": 103564878, "body": "Have you broken it down into sections to make sure, like <code>d=dict(outd &amp; &quot; - &quot; &amp; inD)</code> see if a dictionary object is returned etc.  Also look in the locals window to see your structure."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1572450699, "post_id": 58628627, "comment_id": 103565649, "body": "Are you aware that <code>str</code> is a build in function in VBA?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1572451039, "post_id": 58628627, "comment_id": 103565850, "body": "@FunThomas ha, nice catch! Shouldn&#39;t make a difference if a <code>str</code> variable is in scope though (declared or not), but definitely a <a href=\"http://rubberduckvba.com/Inspections/Details/ShadowedDeclaration\" rel=\"nofollow noreferrer\">shadowed declaration</a>."}, {"owner": {"reputation": 11, "user_id": 5337024, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206413058958279/picture?type=large", "display_name": "hammer4", "link": "https://stackoverflow.com/users/5337024/hammer4"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1572451482, "post_id": 58628627, "comment_id": 103566095, "body": "@FunThomas it is actually a string value, the most inner array is array of strings."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1572458986, "post_id": 58629934, "comment_id": 103569854, "body": "Note: a <code>Collection</code> won&#39;t let you swap its values either; you need to remove and re-add an item to replace it."}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1572458529, "last_edit_date": 1572458529, "creation_date": 1572453087, "answer_id": 58629934, "question_id": 58628627, "link": "https://stackoverflow.com/questions/58628627/problem-with-assigning-a-value-to-nested-dictionary-in-vba/58629934#58629934", "title": "Problem with assigning a value to nested dictionary in VBA", "body": "<p>I couldn't find any documentation about this, but I did some test and I would assume you are out of luck here.</p>\n\n<p>An array is not an object in VBA, so if you put an array as a value into a dictionary-entry, VBA will <em>copy</em> all it's values. See for example:</p>\n\n<pre><code>a(1) = \"A-1\"\ndict.Add \"MyA\", a\na(2) = \"A-2\"\nDebug.Print dict(\"MyA\")(1), dict(\"MyA\")(2)    ' Will print \"A-1\" (but not \"A-2\")\n</code></pre>\n\n<p>Now, if you change your code to </p>\n\n<pre><code>a(1) = \"A-1\"\ndict.Add \"MyA\", a\ndict(\"MyA\")(2) = \"A-2\"\nDebug.Print dict(\"MyA\")(1), dict(\"MyA\")(2)    ' Will still print \"A-1\" (but not \"A-2\")\n</code></pre>\n\n<p>Why? </p>\n\n<p>It's just a guess: When you access <code>dict(\"MyA\")</code>, VBA copies the <em>value</em>. As this <em>value</em> is an array, it will copy the array (into memory). You then modify the 2nd member of the <em>copy</em>, but this will not change the array that is stored in the dictionary.</p>\n\n<p>A workaround could be using a <code>Collection</code> rather than an array.</p>\n"}], "owner": {"reputation": 11, "user_id": 5337024, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206413058958279/picture?type=large", "display_name": "hammer4", "link": "https://stackoverflow.com/users/5337024/hammer4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1572458529, "creation_date": 1572448864, "last_edit_date": 1572451556, "question_id": 58628627, "link": "https://stackoverflow.com/questions/58628627/problem-with-assigning-a-value-to-nested-dictionary-in-vba", "title": "Problem with assigning a value to nested dictionary in VBA", "body": "<p>I have an issue with assigning a value to a nested dictionary in VBA.\nThe structure is dict(strValue)(dateValue)(arrayIndex).</p>\n\n<p>where dict is dictionary, strValue is key of dictionary, dateValue is key of nested dictionary and the nested dictionary value is an array.</p>\n\n<p>The data structure is properly declared and the inner members are successfully assigned. I have only problem with assigning the most inner value(the array members).</p>\n\n<p>What I have tried is:</p>\n\n<pre><code>dict(outD &amp; \" - \" &amp; inD)(dt)(h) = \"str\"\n</code></pre>\n\n<p>After the assignment the expected value in the dictionary is empty string and should not be.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 358, "user_id": 3350482, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EuOk0.jpg?s=128&g=1", "display_name": "Ssr1369", "link": "https://stackoverflow.com/users/3350482/ssr1369"}, "edited": false, "score": 5, "creation_date": 1572448822, "post_id": 58628570, "comment_id": 103564548, "body": "I am not sure what&#39;s your question, at the moment it looks like you asking us to do your homework. Show us what you have tried so far, and then formulate a proper question, something better than &quot;how do I do this&quot;."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 1, "creation_date": 1572448831, "post_id": 58628570, "comment_id": 103564553, "body": "Annoying test case for you:  <code>&quot;What output if this works?&quot;</code> and <code>&quot;What if this output works?&quot;</code>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1572451858, "post_id": 58628570, "comment_id": 103566318, "body": "@Chronocidal ^^ For your interest: There are actually algorithms to solve that too. Obviously there will be more than one result possible and you need some good scoring to evaluate which one is the best (the one with the less changes, probably). Actually this task is at an advanced level ... have a look below."}, {"owner": {"reputation": 11, "user_id": 12298177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d376e62103f05e14b6f64d8c3a2a481?s=128&d=identicon&r=PG&f=1", "display_name": "skimo", "link": "https://stackoverflow.com/users/12298177/skimo"}, "reply_to_user": {"reputation": 358, "user_id": 3350482, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EuOk0.jpg?s=128&g=1", "display_name": "Ssr1369", "link": "https://stackoverflow.com/users/3350482/ssr1369"}, "edited": false, "score": 0, "creation_date": 1572516957, "post_id": 58628570, "comment_id": 103587666, "body": "@Ssr1369 I&#39;ve updated my question now to add some more detail and work I&#39;ve done on the subject"}, {"owner": {"reputation": 11, "user_id": 12298177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d376e62103f05e14b6f64d8c3a2a481?s=128&d=identicon&r=PG&f=1", "display_name": "skimo", "link": "https://stackoverflow.com/users/12298177/skimo"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1572516964, "post_id": 58628570, "comment_id": 103587670, "body": "@Chronocidal based on the algorithm I&#39;ve outlined above, the output would be &quot;What%if%this%works?%&quot;, which is good enough for the task I will be using it for"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1572520878, "post_id": 58628570, "comment_id": 103589834, "body": "<code>string1 A1 cell</code> can be written in many ways, for example: <code>string1 = [A1].Value</code> or <code>string1 = Range(&quot;A1&quot;).Value</code> or <code>string1 = Cells(1,1).Value</code>.  To return values, read up on <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/function-statement\" rel=\"nofollow noreferrer\">the <code>Function</code> statement</a>"}], "answers": [{"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1572455825, "post_id": 58628990, "comment_id": 103568406, "body": "Nice explaination. I wonder if something can be done rather simple by two <code>Split</code> arrays and its items their relative position towards eachother"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1572464702, "post_id": 58628990, "comment_id": 103572278, "body": "@JvdV I bet if there was a simpler solution bioinformatics would use that :) What you suggest is probably the same issue to solve. Just that you do it word wise instead of character wise (which would shorten the runtime of the algorithm). What you suggest <i>&quot;their items and their relative position to each other&quot;</i> is exactly what the algorithm does."}, {"owner": {"reputation": 2814, "user_id": 12125181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d1dd8c08836a0f30f03a66adddc2c3?s=128&d=identicon&r=PG", "display_name": "bosco_yip", "link": "https://stackoverflow.com/users/12125181/bosco-yip"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1572504972, "post_id": 58628990, "comment_id": 103582492, "body": "@JvdV It can be done by a split data array and in compare to the other data, something like this, A1: &quot;This is a test case, see if it works&quot;, A2 :&quot;test case, it hopefully works&quot;  and In B1 enter array formula (CSE) : =SUBSTITUTE(TEXTJOIN(&quot;%&quot;,TRUE,TRIM(IF(ISNUMBER(FIND(&quot; &quot;&amp;FILTERXML(&quot;&lt;a&gt;&lt;b&gt;&quot;&amp;SUBSTITUTE(A1,&quot; &quot;,&quot;&lt;/b&gt;&lt;b&gt;&quot;)&amp;&quot;&lt;/b&gt;&lt;/a&gt;&quot;,&quot;//b&quot;)&amp;&quot; &quot;,&quot; &quot;&amp;A2&amp;&quot; &quot;)),&quot; &quot;&amp;FILTERXML(&quot;&lt;a&gt;&lt;b&gt;&quot;&amp;SUBSTITUTE(A1,&quot; &quot;,&quot;&lt;/b&gt;&lt;b&gt;&quot;)&amp;&quot;&lt;/b&gt;&lt;/a&gt;&quot;,&quot;//b&quot;)&amp;&quot; &quot;,&quot;&quot;))),&quot;%&quot;,&quot; &quot;,1) and the result is : &quot;test case,%it%works&quot; ( the formula only work for Office 365 for the using of TEXTJOIN function)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 2814, "user_id": 12125181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d1dd8c08836a0f30f03a66adddc2c3?s=128&d=identicon&r=PG", "display_name": "bosco_yip", "link": "https://stackoverflow.com/users/12125181/bosco-yip"}, "edited": false, "score": 0, "creation_date": 1572505719, "post_id": 58628990, "comment_id": 103582728, "body": "@bosco_yip but this will produce a strange result for <code>What output if this works?</code> and <code>What if this output works?</code> you will get <code>What output%if%this%works?</code> which actually should be <code>What output%if this%works?</code> (which has less substitutes)."}, {"owner": {"reputation": 11, "user_id": 12298177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d376e62103f05e14b6f64d8c3a2a481?s=128&d=identicon&r=PG&f=1", "display_name": "skimo", "link": "https://stackoverflow.com/users/12298177/skimo"}, "edited": false, "score": 0, "creation_date": 1572517122, "post_id": 58628990, "comment_id": 103587780, "body": "@P\u1d07\u029c thank you for your notes, but I don&#39;t think it doesn&#39;t need to be as complicated as you&#39;ve outlined here, please see the edit I&#39;ve added which provides a potential solution"}, {"owner": {"reputation": 11, "user_id": 12298177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d376e62103f05e14b6f64d8c3a2a481?s=128&d=identicon&r=PG&f=1", "display_name": "skimo", "link": "https://stackoverflow.com/users/12298177/skimo"}, "reply_to_user": {"reputation": 2814, "user_id": 12125181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d1dd8c08836a0f30f03a66adddc2c3?s=128&d=identicon&r=PG", "display_name": "bosco_yip", "link": "https://stackoverflow.com/users/12125181/bosco-yip"}, "edited": false, "score": 0, "creation_date": 1572517294, "post_id": 58628990, "comment_id": 103587884, "body": "@bosco_yip I was on the same thought process as you, if you have a look at my edit I think I have a way it can be done :)"}, {"owner": {"reputation": 11, "user_id": 12298177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d376e62103f05e14b6f64d8c3a2a481?s=128&d=identicon&r=PG&f=1", "display_name": "skimo", "link": "https://stackoverflow.com/users/12298177/skimo"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1572517594, "post_id": 58628990, "comment_id": 103588060, "body": "@JvdV yes I think found a solution but need some help fine-tuning the syntax, please have a look at the code I added via edit"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 11, "user_id": 12298177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d376e62103f05e14b6f64d8c3a2a481?s=128&d=identicon&r=PG&f=1", "display_name": "skimo", "link": "https://stackoverflow.com/users/12298177/skimo"}, "edited": false, "score": 2, "creation_date": 1572517911, "post_id": 58628990, "comment_id": 103588254, "body": "@skimo Basically your issue is the same as aligning DNA sequences. So if there was a simple solution for that then the guys using bioniformatics would have used it (unless you are able to revolutionize sequence aligning, which I assume you are not going to). Your approach might output &quot;something&quot; that is working for your example but not in general (for other strings) as I tried to explain the mechanism is much more complicated than you think and than you can develope with one example."}, {"owner": {"reputation": 11, "user_id": 12298177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d376e62103f05e14b6f64d8c3a2a481?s=128&d=identicon&r=PG&f=1", "display_name": "skimo", "link": "https://stackoverflow.com/users/12298177/skimo"}, "edited": false, "score": 0, "creation_date": 1572518289, "post_id": 58628990, "comment_id": 103588467, "body": "@P\u1d07\u029c I don&#39;&#39;t need it to work for all strings. It will be run on strings that have 90%+ similarity in their names (as found via fuzzy lookup). For that reason I believe although what you&#39;re saying is true, for my use case a simpler solution does in fact exist"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 11, "user_id": 12298177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d376e62103f05e14b6f64d8c3a2a481?s=128&d=identicon&r=PG&f=1", "display_name": "skimo", "link": "https://stackoverflow.com/users/12298177/skimo"}, "edited": false, "score": 0, "creation_date": 1572857377, "post_id": 58628990, "comment_id": 103677552, "body": "@skimo There is no simple solution as because of the reason I added to my answer."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 7, "last_activity_date": 1572631845, "last_edit_date": 1572631845, "creation_date": 1572450022, "answer_id": 58628990, "question_id": 58628570, "link": "https://stackoverflow.com/questions/58628570/how-can-i-output-the-matching-portion-of-two-strings-while-having-the-charact/58628990#58628990", "title": "How can I output the matching portion of two strings, while having the % character separate any non-consecutively matching portions?", "body": "<p>What you try is not easy to accomplish, and you would need some advanced development skills (basic knowledge in <a href=\"https://en.wikipedia.org/wiki/Dynamic_programming\" rel=\"nofollow noreferrer\">dynamic programming</a> is extremly useful). </p>\n\n<p>What you try to do is actually the same idea as aligning DNA sequences in bio informatics. </p>\n\n\n\n<hr>\n\n<p>So what you would need to do is take both of your strings (sequences)</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>This is a test case, see if it works\ntest case, it hopefully works\n</code></pre>\n\n<p>and align them for example using the <a href=\"https://en.wikipedia.org/wiki/Needleman%E2%80%93Wunsch_algorithm\" rel=\"nofollow noreferrer\">Needleman\u2013Wunsch algorithm</a> (there are more known algorithms to do alignments):</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>This is a test case, see if it ----------works\n----------test case, -------it hopefully works\n</code></pre>\n\n<p>Then check which characters are the same, so the result would be \u2026</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>----------test case, -------it ----------works\n</code></pre>\n\n<p>And then replace the multiple dashes with <code>%</code> while removing dashes from the end and beginning. So your final result would be:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>test case, %it %works\n</code></pre>\n\n<p>Note that for your issue there does not exist one definive result. There will always be more results possible! If you do alignments there may be different ways to align 2 sequences.</p>\n\n<hr>\n\n<p>So the Needleman Wunsch backtracing for the alignment above would look something like that:</p>\n\n<p><a href=\"https://i.stack.imgur.com/MxBh3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MxBh3.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<h3>Why there is no simple solution for that?</h3>\n\n<p>For example we take the following 2 strings:</p>\n\n\n\n<pre class=\"lang-html prettyprint-override\"><code>What output if this works?\nWhat if this output works?\n</code></pre>\n\n<p>They can be aligned (wordwise) as</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>What output if this        works?\nWhat        if this output works?\n</code></pre>\n\n<p>or as </p>\n\n<pre class=\"lang-html prettyprint-override\"><code>What         output if this works?\nWhat if this output         works?\n</code></pre>\n\n<p>So there are 2 results</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>What % if this % works?\nWhat % output % works?\n</code></pre>\n\n<p>and they are different. Other strings might have even more than 2 possible results.</p>\n\n<p>So you need an algorithm that can give you <strong>all</strong> the possible results and then you need an algorithm to determine which one is the best one (the one you want to have). In the case above how would you tell which one of the 2 results is the right one?  \u2026 you can't :)</p>\n\n<hr>\n\n<p>To give you another example:</p>\n\n<p>We use the following 2 strings</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>to proove you wrong this is a good example for you\nis this a good example to proove you wrong\n</code></pre>\n\n<p>can be aligned (at least) as follows:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>                       to prove you wrong this is a good example for you\nis this a good example to prove you wrong\n\n\nto prove you wrong this is a good example for you\n                        is                        this a good example to prove you wrong\n\n   to prove you wrong this is a good example          for you\nis                    this    a good example to prove     you wrong\n</code></pre>\n\n<p>and you will get these 3 (or even more) results:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>% to proove you wrong %\n% is %\n% this % a good example % you %\n</code></pre>\n\n<p>Would you be fine if your algorithm picks the second result for you? Or would you expect something different? All 3 are valid results.</p>\n\n<p>But you are probably looking for the best one, and we can get this by counting the gap words.</p>\n\n<p><a href=\"https://i.stack.imgur.com/1bAsI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1bAsI.png\" alt=\"enter image description here\"></a></p>\n\n<p>The result with the less gap words is the best. So you see that the second is the worst one and the last one is the best one. But to be able to evaluate this we need to use an algorithm that is able to find <strong>all</strong> results in the first step, so we can evaluate which one of them is the best one.</p>\n"}], "owner": {"reputation": 11, "user_id": 12298177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d376e62103f05e14b6f64d8c3a2a481?s=128&d=identicon&r=PG&f=1", "display_name": "skimo", "link": "https://stackoverflow.com/users/12298177/skimo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1572631845, "creation_date": 1572448639, "last_edit_date": 1572629083, "question_id": 58628570, "link": "https://stackoverflow.com/questions/58628570/how-can-i-output-the-matching-portion-of-two-strings-while-having-the-charact", "title": "How can I output the matching portion of two strings, while having the % character separate any non-consecutively matching portions?", "body": "<p>I was hoping I could get some help on a project I've been working on. Given two strings, I would like to output the matching portions of these strings. Further, I would like any non-consecutive portions of the match output to be separated by the <code>%</code> symbol. </p>\n\n<p>For example, if my two string inputs were:</p>\n\n<ul>\n<li><code>This is a test case see if it works</code> and </li>\n<li><code>test case it hopefully works</code></li>\n</ul>\n\n<p>Then my desired output would be:  </p>\n\n<ul>\n<li><code>test case%it%works</code></li>\n</ul>\n\n<p>EDIT:\nI have written how I would like the code to be structured, but need some help fine-tuning the exact syntax, any help would be really appreciated. Here is how I think it could be done:</p>\n\n<pre><code>string1 = A1 cell\nstring2 = B1 cell\noutput = \"\"\ncounter = 0\nif LENGTH(string1) &lt; LENGTH(string2) then split_string=string1 and other_string=string2             '\nELSE split_string=string2 and other_string=string1\nmatchable_values=split(split_string)\nfor each element in matchable_values      \n    if ISNUMBER(SEARCH(element, other_string,counter)) then \n       output = output &amp; element &amp; %   and counter = counter + \n       LENGTH(element) + 1\n     ELSEIF counter = counter + LENGTH(element) + 1\nnext element\n\nreturn output\n</code></pre>\n"}, {"tags": ["vba", "textbox", "setfocus"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1572451108, "post_id": 58628495, "comment_id": 103565892, "body": "Please <a href=\"https://stackoverflow.com/posts/58628495/edit\">edit</a> your post to format it. As it stands it&#39;s... a wall of text that&#39;s pretty hard to read. Including your actual code (handlers for <code>Initialize</code> and <code>Activate</code> events) would probably help a lot, too."}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1572510928, "post_id": 58628495, "comment_id": 103584691, "body": "Thanks! I did it but I am afraid that people are now not so anxious to look in such a big piece of code..."}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1572512041, "post_id": 58628495, "comment_id": 103585151, "body": "How do you start your Userform? From a button? modeless? What&#39;s the code for starting your Userform? Are there any Events for txtCsv?"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 0, "creation_date": 1572520898, "post_id": 58628495, "comment_id": 103589845, "body": "The form is modeless (from its properties). I start it (now) from IDE, just pressing F5, but I also start it from Tools menu where I built an option calling a simple function (frmECA.Show)."}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1572521296, "post_id": 58628495, "comment_id": 103590037, "body": "@EvR:  Yes, txtCsv has a change event. Now, I commented all the event code and nothing changed. I did some more tests and maybe they can help somebody to better understand the issue, but in such a comment, if it becomes longer nobody can understand too much, I&#39;m afraid..."}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1572522022, "post_id": 58628495, "comment_id": 103590445, "body": "@EvR: I edited the initial post and explained what I did in the meantime..."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1588856979, "post_id": 58628495, "comment_id": 109065161, "body": "tl;dr today  - maybe helpful: <a href=\"https://stackoverflow.com/questions/55011102/vba-userform-unexpected-behaviour-after-using-setfocus-on-a-textbox/55030162#55030162\">unexpected behaviour after setfocus</a> ... a)    switch and reswitch the .Enabled property or alternatively    b) explicitly lose focus via any other control accepting focus (including also commandbuttons or frames) and reset focus again. Hopefully I didn&#39;t misunderstand your question :-;"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1588857376, "post_id": 58628495, "comment_id": 109065427, "body": "@T.M.: Thanks for your interest in this issue! I solved the problem, in the meantime. The trick was to Desable - Enable the control before setting focus, but <b>doing that in Form <code>Activate</code> event</b>. It looks that, even if the form finds the correct redefined control handle, if something else happens in a bushy code, it loses it again... And <code>Activate</code> event comes after <code>Initialize</code> one. When the code was simple, i would easily set focus in the <code>Initialize</code> event without any trick need... Maybe, it would be good to post an answer for somebody needing something similar."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1588857546, "post_id": 58628495, "comment_id": 109065545, "body": "@FaneDuru - further possibly helpful link regarding <a href=\"https://stackoverflow.com/questions/53392937/validation-message-of-text-box-entry-on-modeless-form-interrupts-text-selection/53496763#53496763\">SetFocus</a>"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1588857919, "post_id": 58628495, "comment_id": 109065799, "body": "@T.M.:  Interesting approach, but in my case not a MsgBox window was involved. Apparently, the form window did not loos focus. Anyhow, I solved the issue in the way I explained before. Thanks again!"}], "answers": [{"tags": [], "owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "is_accepted": true, "score": 1, "last_activity_date": 1588858134, "creation_date": 1588858134, "answer_id": 61659005, "question_id": 58628495, "link": "https://stackoverflow.com/questions/58628495/how-to-send-focus-to-a-text-box-of-a-vba-form-during-its-initialization-activate/61659005#61659005", "title": "How to send focus to a text box of a VBA form during its initialization/activate event?", "body": "<p>The above question has been solved by Disabling followed by Enabling of the text box in discussion, but <strong>only doing that in Form <code>Activate</code> event</strong>. It did not work in <code>Initialize</code> event...</p>\n\n<pre><code>Private Sub UserForm_Activate()\n    Me.txtCsv.Disable: Me.txtCsv.Enable\n    Me.txtCsv.SetFocus\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 829, "favorite_count": 0, "accepted_answer_id": 61659005, "answer_count": 1, "score": 2, "last_activity_date": 1588858134, "creation_date": 1572448429, "last_edit_date": 1572781282, "question_id": 58628495, "link": "https://stackoverflow.com/questions/58628495/how-to-send-focus-to-a-text-box-of-a-vba-form-during-its-initialization-activate", "title": "How to send focus to a text box of a VBA form during its initialization/activate event?", "body": "<p>I have a VBA form in Corel. Behaving exactly like a similar one in Excel...\nInitially, when the form initialize event used to contain only some lines of code, the simple ending line <code>me.txtCsv.Setfocus</code> used to send the focus on it. I mean, it appeared being in edit mode with the cursor blinking inside.</p>\n\n<p>After a period of time, after the application became complex, I am not able to send the focus to the text box in discussion.</p>\n\n<p>I know that Activate event goes last and I also have in it the line <code>me.txtCsv.Setfocus</code>. But without expected result. Inside the Initialization event code I inserted that line <code>Debug.Print Me.ActiveControl.Name &amp; \" - 1\"</code>, changing 1 in 2, 3 up to 6 in many places, including the last line and all the time the name of the text box in discussion (txtCsv) appears in Immediate Window.</p>\n\n<p>So, <strong>the control in discussion is the activate one</strong>, but the cursor is not inside it when the form is loaded.</p>\n\n<p><code>TabStop</code> is set to <code>True</code>. I set the <code>TabIndex</code> to 0.</p>\n\n<p>The control is enabled and not blocked. I have created a new simple form with three text boxes and it works well.</p>\n\n<p>I mean the text box which I want to send the focus, has the focus when the form is loaded, keeping a similar code in its Initialize or Activate events.\nI compared all properties of the two forms and all text box controls and they are the same...</p>\n\n<p>When I send the focus from another control on the form, the text box in discussion receives it.</p>\n\n<p>It does not receive the focus (anymore) only when the form is shown, the focus being sent by Initialize or Activate evens.</p>\n\n<p>Events code:</p>\n\n<pre><code>Private Sub UserForm_Activate()\n    Me.txtCsv.SetFocus\nEnd Sub\nPrivate Sub UserForm_Initialize()\n   Dim P As Printer, i As Long, NrImp As Long, prDefault As String, strJustEngr As String\n   Dim Printers() As String, n As Long, s As String, boolFound As Boolean\n   Dim strEng As String, MEngr As Variant, m As Variant, el As Variant, defSize As String\n   Dim strDropbox As String\n\n   boolOpt = True: boolFound = False\n   Me.cbPrinters.Clear\n    If Me.chkNewStyle.Value = True Then boolNewStyle = True\n\n    prDefault = Application.Printers.Default.Name\n\n    strEng = GetSetting(ECA_K, ECA_set, ECA_Engr, \"No settings...\")\n    If strEng &lt;&gt; \"No settings...\" Then\n        boolSelectedEngravers = True  ' only adding engraver is possible...\n        MEngr = Split(strEng, \"|\")\n        'Incarcare in combo:\n        Me.cbPrinters.Clear\n        For Each el In MEngr\n            m = Split(el, \":\")\n            Me.cbPrinters.AddItem m(0)\n            If m(0) = prDefault Then\n                boolFound = True\n                defSize = m(1)\n            End If\n        Next\n        Me.cbPrinters.Value = Me.cbPrinters.List(0)\n        With Me.btChoosePrinters\n            .Caption = \"Add an Engraver\"\n            .ControlTipText = \"Add another Engraver(must be installed)\" \n        End With\n        Me.btEliminatePrinters.Enabled = True\n        Me.lblPrinters.Caption = \"Engravers: \"\n        Me.cbPrinters.ControlTipText = \"Select Engraver to be used!\"\n    Else\n        Printers = GetPrinterFullNames()\n        For n = LBound(Printers) To UBound(Printers)\n            Me.cbPrinters.AddItem Printers(n)\n            If Printers(n) = prDefault Then boolFound = True\n        Next n\n        boolSelectedEngravers = False\n    End If\n    Debug.Print Me.ActiveControl.Name &amp; \" - 1\"\n    If boolFound Then\n        Me.cbPrinters.Value = prDefault\n    Else\n        Me.lblStatus.Caption = \"The default printer (\"\"\" &amp; prDefault &amp; \"\"\") is not a laser Engraver...\"\n    End If\n\n\n    If GetSetting(ECA_K, ECA_set, \"LowRAM\", \"No settings...\") &lt;&gt; \"No settings...\" Then\n        boolLowRAM = CBool(GetSetting(ECA_K, ECA_set, \"LowRAM\", \"No settings...\"))\n    End If\n    If boolLowRAM = True Then\n        Me.chkLowRAM.Value = True\n    Else\n        Me.chkLowRAM.Value = False\n    End If\n    Debug.Print Me.ActiveControl.Name &amp; \" - 2\"\n    'Direct engrave setting:\n    Dim strDirectEngrave As String\n    strDirectEngrave = GetSetting(ECA_K, ECA_set, ECA_Direct_Engrave, \"Nothing\")\n    If strDirectEngrave &lt;&gt; \"Nothing\" Then\n        Me.chkDirectEngrave.Value = CBool(strDirectEngrave)\n        If CBool(strDirectEngrave) = True Then\n            boolDirectEngrave = True\n        Else\n            boolDirectEngrave = False\n        End If\n    End If\n    '_______________________________________\n    strJustEngr = GetSetting(ECA_K, ECA_set, ECA_Just_Engrave, \"Nothing\")\n    If strJustEngr &lt;&gt; \"Nothing\" Then\n        'Application.EventsEnabled = False\n            boolChangeEngr = True\n            Me.chkJustEngrave.Value = CBool(strJustEngr)\n            boolChangeEngr = False\n        'Application.EventsEnabled = True\n        If CBool(strJustEngr) = True Then\n            Me.chkDirectEngrave.Enabled = True\n            boolJustEngrave = True\n            Me.frLocFoldPath.Enabled = True\n        Else\n            Me.frLocFoldPath.Enabled = False\n            Me.chkDirectEngrave.Enabled = False\n        End If\n    End If\n    Debug.Print Me.ActiveControl.Name &amp; \" - 3\"\n\n    If boolSelectedEngravers Then\n        Application.EventsEnabled = False\n            Me.btGo.ForeColor = RGB(45, 105, 7)\n            Me.txtCsv.BackColor = RGB(153, 255, 51)\n            Me.btGo.Enabled = False\n            Me.txtCsv.SetFocus\n        Application.EventsEnabled = True\n    End If\n    strDropbox = GetSetting(ECA_K, ECA_set, ECA_Dropbox, \"No value\")\n    If strDropbox &lt;&gt; \"No value\" Then\n        If CBool(strDropbox) = True Then\n            Me.chkDropbox.Value = True\n        End If\n    End If\n    AllRefresh\n    Me.chkCloseDoc.Value = True\n    Me.txtCsv.SetFocus\n    Debug.Print Me.ActiveControl.Name &amp; \" - 4\"\nEnd Sub\nPrivate Sub AllRefresh()    \n    Application.Optimization = False\n    Application.EventsEnabled = True\n    If Documents.Count &gt; 0 Then\n        ActiveWindow.Refresh\n        ActiveDocument.PreserveSelection = True\n    End If\n    Application.Refresh\nEnd Sub\n</code></pre>\n\n<p><strong>Is there something else, crossing your mind, to be tested</strong>?</p>\n\n<p>In the meantime I did some more tests, respectively:</p>\n\n<p>I created a new project (.GMS file) and I imported the form in discussion.I started commenting all the Initialize event code, except the last two code lines.</p>\n\n<p>It didn't set the focus! Commenting everything, letting only the Activate event code, it worked.</p>\n\n<p>I started to un-comment lines in Initialize event code and I found a line not allowing the focus to be sent to that text box.</p>\n\n<p>Setting the value of the combo: <code>Me.cbPrinters.Value = Me.cbPrinters.List(0)</code>, moving it in the Activate event code, before the part pointing to txtCSV, worked well.</p>\n\n<p>Now, I tried to do the same in the original form and it does not work...</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 648, "user_id": 6626183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a57210a6e0933a32691c61eba6f218df?s=128&d=identicon&r=PG&f=1", "display_name": "Hel O&#39;Ween", "link": "https://stackoverflow.com/users/6626183/hel-oween"}, "edited": false, "score": 1, "creation_date": 1572450986, "post_id": 58628543, "comment_id": 103565814, "body": "Access is the weird one here, as <a href=\"https://www.tutorialspoint.com/sql/sql-wildcards.htm\" rel=\"nofollow noreferrer\">% is the standard wildcard in SQL</a>. So Excel, via ADO, follows the standard."}, {"owner": {"reputation": 11, "user_id": 12298064, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uMIaLjMmLYU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc9a8vNFq6S0mOOOmareneR5_BiWg/photo.jpg?sz=128", "display_name": "Mike Candiello", "link": "https://stackoverflow.com/users/12298064/mike-candiello"}, "reply_to_user": {"reputation": 648, "user_id": 6626183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a57210a6e0933a32691c61eba6f218df?s=128&d=identicon&r=PG&f=1", "display_name": "Hel O&#39;Ween", "link": "https://stackoverflow.com/users/6626183/hel-oween"}, "edited": false, "score": 0, "creation_date": 1572453605, "post_id": 58628543, "comment_id": 103567314, "body": "Yea I started with using % on other queries in vba when talking with access (I&#39;m used to SQL server syntax), but when I transferred it over to access for testing, it yelled at me.  New job, new quirks about databases and programs to learn I guess."}, {"owner": {"reputation": 648, "user_id": 6626183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a57210a6e0933a32691c61eba6f218df?s=128&d=identicon&r=PG&f=1", "display_name": "Hel O&#39;Ween", "link": "https://stackoverflow.com/users/6626183/hel-oween"}, "edited": false, "score": 0, "creation_date": 1572457660, "post_id": 58628543, "comment_id": 103569249, "body": "<a href=\"https://docs.microsoft.com/en-us/office/client-developer/access/desktop-database-reference/comparison-of-microsoft-access-sql-and-ansi-sql\" rel=\"nofollow noreferrer\">This article</a> might help with that. tl;dr: in Access, you can use both Access or SQL wildcards, but you must use <i>one</i> set <i>exclusively</i> in your queries. You can&#39;t mix &#39;em up."}], "tags": [], "owner": {"reputation": 11, "user_id": 12298064, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uMIaLjMmLYU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc9a8vNFq6S0mOOOmareneR5_BiWg/photo.jpg?sz=128", "display_name": "Mike Candiello", "link": "https://stackoverflow.com/users/12298064/mike-candiello"}, "is_accepted": false, "score": 1, "last_activity_date": 1572448570, "creation_date": 1572448570, "answer_id": 58628543, "question_id": 58628386, "link": "https://stackoverflow.com/questions/58628386/insert-query-select-query-works-in-access-but-not-in-vba/58628543#58628543", "title": "Insert Query/Select Query works in access, but not in vba", "body": "<p>It appears I solved the problem, while looking into this apparently the excel operator using ADODB with access is % for LIKE and NOT * (because reasons). As soon as I made that change everything started working.</p>\n\n<p>Can someone explain why that is a thing?  I really want to understand why this was a design choice.</p>\n"}], "owner": {"reputation": 11, "user_id": 12298064, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uMIaLjMmLYU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc9a8vNFq6S0mOOOmareneR5_BiWg/photo.jpg?sz=128", "display_name": "Mike Candiello", "link": "https://stackoverflow.com/users/12298064/mike-candiello"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572448570, "creation_date": 1572448079, "question_id": 58628386, "link": "https://stackoverflow.com/questions/58628386/insert-query-select-query-works-in-access-but-not-in-vba", "title": "Insert Query/Select Query works in access, but not in vba", "body": "<p>I have created a query that works great with no errors in Access, and while trying to translate this to my vba setup I can't figure out why I am not getting any values, even though the query clearly works in access, and causes no errors on the VBA side.</p>\n\n<p>Pulling my hair out here, I have created a side table to see if I could \"pseudo-insert\" the calculated value, but I get the same issue as above - insert works with no errors in access, goes through in vba with no issues, but doesn't actually insert any data.</p>\n\n<p>I have copied the string queries while pausing code to make sure EVERYTHING matches up between the Access query that works and the VBA query, and haven't found any differences.</p>\n\n<p>I read somewhere since I am trying to pull a \"first line\" data piece that there may be some HDR setting that I could change, but when I tried to apply any fixes I found they opened another instance of excel and opened a dialogue box.</p>\n\n<p>Please let me know what I am doing wrong here.</p>\n\n<pre><code>Public Function PullNextLineItemNumB(QuoteNum) As Integer\nDim strQuery As String\nDim ConnDB As New ADODB.Connection\nDim myRecordset As ADODB.Recordset\nDim QuoteModifiedNum As String\n\nConnDB.Open ConnectionString:=\"Provider = Microsoft.ACE.OLEDB.12.0; data \nsource=\" &amp; ThisWorkbook.Path &amp; \"\\OEE Info.accdb\"\n\n'Query to try and make Access dump the value \"18\" into the table so I can \ngrab it after the query is finished, sidestepping excel not working\nstrQuery = \"INSERT INTO TempTableColm (TempColm) SELECT \nMAX(MID([Quote_Number_Line],InStr(1,[Quote_Number_Line],\" &amp; Chr(34) &amp; \"-\" \n&amp; Chr(34) &amp; \")+1)) AS MaxNum from UnifiedQuoteLog where Quote_Number_Line \nlike '\" &amp; QuoteNum &amp; \"*'\"\nConnDB.Execute strQuery\n\n'Original query, returns \"18\" as expected in Access, and null or empty in \nthe recordset\nstrQuery = \"SELECT MAX(MID([Quote_Number_Line],InStr(1, \n[Quote_Number_Line],\" &amp; Chr(34) &amp; \"-\" &amp; Chr(34) &amp; \")+1)) from \nUnifiedQuoteLog where Quote_Number_Line like '\" &amp; QuoteNum &amp; \"*'\"\n\nSet myRecordset = ConnDB.Execute(strQuery)\nDo Until myRecordset.EOF\nFor Each fld In myRecordset.Fields\n    Debug.Print fld.Name &amp; \"=\" &amp; fld.Value\nNext fld\nmyRecordset.MoveNext\nLoop\n\nmyRecordset.Close\nSet myRecordset = Nothing\nConnDB.Close\nSet ConnDB = Nothing\n\nEnd Function\n</code></pre>\n\n<p>Actual output from access is \"18\" which is expected, output from excel's vba recordset is always null or empty string.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1572446816, "post_id": 58627954, "comment_id": 103563349, "body": "<code>.Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Value</code> - <code>.Value</code> shouldn&#39;t be inside the parentheses. You&#39;re trying to use the <code>Value</code> of the cell, not the cell itself, as the 2nd argument of the <code>Range</code> call."}, {"owner": {"reputation": 131, "user_id": 11724559, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WDpomKXErPE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reAxSRy0dKrkQtLiADHFOE46sPayA/photo.jpg?sz=128", "display_name": "Noelia Sancho Mendez", "link": "https://stackoverflow.com/users/11724559/noelia-sancho-mendez"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1572446927, "post_id": 58627954, "comment_id": 103563412, "body": "Can you write the code to see an example of how I should write it?"}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 2, "last_activity_date": 1572451053, "last_edit_date": 1572451053, "creation_date": 1572447202, "answer_id": 58628103, "question_id": 58627954, "link": "https://stackoverflow.com/questions/58627954/add-items-in-a-combobox/58628103#58628103", "title": "add items in a combobox", "body": "<p>The <code>.Value</code> is in the wrong place. (Or you could say that the parenthesis is in the wrong place). Correcting this, you have:</p>\n\n<pre><code>.Range(\"A2\", .Range(\"A\" &amp; Rows.Count).End(xlUp)).Value\n</code></pre>\n\n<p>With your current code, <code>.Value</code> is <em>within</em> the <code>Range</code> call, so you're trying to use the <em>value</em> of the cell, not the <em>cell itself</em>, as the 2nd argument.</p>\n\n<p>You want it outside. </p>\n\n<p>Otherwise, if the last cell's value is \"foo\", then your code is equivalent to</p>\n\n<pre><code> Range(\"A2\", \"foo\")\n</code></pre>\n\n<p>which is most certainly not what you want.</p>\n"}, {"comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1572448151, "post_id": 58628224, "comment_id": 103564178, "body": "There are some issues with this code. If combobox doesn&#39;t have a value, you will get a msgbox saying: <b>Select value to continue</b> and then another msgbox saying: <b>Completed without errors</b>. Also, is <code>sStart</code> a named range? Can&#39;t see where OP has specified that? You haven&#39;t formatted your code properly so it&#39;s hard to read"}, {"owner": {"reputation": 14, "user_id": 10379082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/291f9439d0c06b2549ac372c487230cf?s=128&d=identicon&r=PG&f=1", "display_name": "Neelavathy", "link": "https://stackoverflow.com/users/10379082/neelavathy"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1572448782, "post_id": 58628224, "comment_id": 103564527, "body": "Yes,only if you select the dropdown value  you can proceed to next level,that is the reason I had added that line.  For named range I had mentioned as prerequistes in the code with the comment. My way of coding is ususally nming a variable and proceeding.  Please downgrade without seeing it properly"}], "tags": [], "owner": {"reputation": 14, "user_id": 10379082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/291f9439d0c06b2549ac372c487230cf?s=128&d=identicon&r=PG&f=1", "display_name": "Neelavathy", "link": "https://stackoverflow.com/users/10379082/neelavathy"}, "is_accepted": false, "score": -1, "last_activity_date": 1572447597, "creation_date": 1572447597, "answer_id": 58628224, "question_id": 58627954, "link": "https://stackoverflow.com/questions/58627954/add-items-in-a-combobox/58628224#58628224", "title": "add items in a combobox", "body": "<p>So when you click pn your combo box data will get loaded,</p>\n\n<p>' Pre-requisties name the cell A2 with variable rstart</p>\n\n<p>Private Sub UserForm_Initialize()</p>\n\n<pre><code>Dim ws As Worksheet: Set ws = Worksheets(\"Departamentos\")\nDim i As Integer: i = 0\nDim lRow As Long\nDim sAddress As String\n\nOn Error GoTo errhandling\nIf Me.nameofcombobox.Value = vbNullString Then\n    MsgBox \"Select value to continue!\"\nElse\n    With ws\n        lRow = .Range(\"Departamentos\").Rows.Count\n        'name the cell a2 as rstart\n        Do Until .Range(\"rStart\").Offset(0, i).Value = Me.nameofcombobox.Value\n            i = i + 1\n        Loop\n        sAddress = .Range(\"rStart\").Offset(0, i - 1).Address\n        .Range(sAddress &amp; \":\" &amp; Left(sAddress, 4) &amp; lRow).Value = .Range(sAddress &amp; \":\" &amp; Left(sAddress, 4) &amp; lRow).Value\n    End With\nEnd If\nOn Error GoTo 0\n\nMsgBox \"Completed without errors\", vbInformation, \"Success\"\n</code></pre>\n\n<p>FunctionOutput:\n    Set ws = Nothing</p>\n\n<p>Exit Sub</p>\n\n<p>errhandling:\n     MsgBox \"The following error occurred: \" &amp; Err.Description, vbCritical, \"Error\"\n     Resume FunctionOutput</p>\n\n<pre><code> End Sub\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 11724559, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WDpomKXErPE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reAxSRy0dKrkQtLiADHFOE46sPayA/photo.jpg?sz=128", "display_name": "Noelia Sancho Mendez", "link": "https://stackoverflow.com/users/11724559/noelia-sancho-mendez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1572451053, "creation_date": 1572446741, "last_edit_date": 1572447401, "question_id": 58627954, "link": "https://stackoverflow.com/questions/58627954/add-items-in-a-combobox", "title": "add items in a combobox", "body": "<p>I'm trying to add items from a file saved in path \"C:\\Users\\se72497\\Desktop\" which contains in the 1st column of the sheet called \"Departamentos\" a series of values I want to add in the Combobox. </p>\n\n<p>My combobox receive the name of dept. </p>\n\n<pre><code>Private Sub UserForm_Initialize()\n        Dim filename As Workbook\n        Set filename = Workbooks.Open(\"C:\\Users\\se72497\\Desktop\\Tablas_Macro.xlsx\")\n        With filename.Sheets(\"Departamentos\")\n            dept.List = Range(\"A2\", .Range(\"A\" &amp; Rows.Count).End(xlUp).Value)\n        End With\nEnd Sub\n</code></pre>\n\n<p>I've tried to execute this code but it returns me a run-time error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/I910j.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/I910j.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Why vba returns me this error?</strong></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1572446763, "post_id": 58627938, "comment_id": 103563312, "body": "That means the <code>Find</code> is not successful."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1572446892, "post_id": 58627938, "comment_id": 103563394, "body": "Why the <code>activate</code>? That is a method which lacks a return value. It doesn&#39;t return a range object."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 5, "creation_date": 1572446930, "post_id": 58627938, "comment_id": 103563416, "body": "Get rid of both <code>Activate</code>s and check that <code>pesquisa is not nothing</code> before assigning its value to something."}], "answers": [{"comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1572449352, "post_id": 58628625, "comment_id": 103564857, "body": "Perfectly explained. I have often thought about explaining these things but am too lazy to type all of this. I will mark it as fav and just point to this from here on in :)"}, {"owner": {"reputation": 31, "user_id": 12240048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5eaff90647cfa31a7f63797c11880cff?s=128&d=identicon&r=PG&f=1", "display_name": "AXL", "link": "https://stackoverflow.com/users/12240048/axl"}, "edited": false, "score": 0, "creation_date": 1572458557, "post_id": 58628625, "comment_id": 103569651, "body": "Hello Mathieu i would like to thank your for your answer as it was very easy to read and understand, However i am having a bit of trouble using the Find Function"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 31, "user_id": 12240048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5eaff90647cfa31a7f63797c11880cff?s=128&d=identicon&r=PG&f=1", "display_name": "AXL", "link": "https://stackoverflow.com/users/12240048/axl"}, "edited": false, "score": 0, "creation_date": 1572458676, "post_id": 58628625, "comment_id": 103569705, "body": "@AXL see <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.find\" rel=\"nofollow noreferrer\"><code>Range.Find</code></a>, with particular important emphasis on the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.find#remarks\" rel=\"nofollow noreferrer\">remarks</a>. Other than that, I&#39;d need a much clearer description of what the problem is."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1572449995, "last_edit_date": 1572449995, "creation_date": 1572448849, "answer_id": 58628625, "question_id": 58627938, "link": "https://stackoverflow.com/questions/58627938/how-to-use-the-find-function/58628625#58628625", "title": "How to Use the Find Function", "body": "<p><code>Range.Activate</code> doesn't return anything, it's like a <code>Sub</code> procedure:</p>\n\n<pre><code>Public Sub DoSomething()\n    ' does something...\nEnd Sub\n</code></pre>\n\n<p>If you did <code>Set foo = DoSomething.Something</code>, you'd get the same error: an object is required, otherwise that <code>.Something</code> member call is illegal (except now the error would be at compile-time and not run-time, because of how binding works).</p>\n\n<blockquote>\n<pre><code>Set pesquisa = Worksheets(\"Petrobras\").Activate...\n</code></pre>\n</blockquote>\n\n<p>You don't want to <code>Activate</code> any sheets.</p>\n\n<p>Part of the problem is the implicit late-binding going on: <code>Worksheets</code> returns an <code>Object</code>, so everything you wrote after that, all these chained member calls, can only be resolved at run-time.</p>\n\n<p>Make it early-bound, by declaring an explicit <code>Worksheet</code> variable:</p>\n\n<pre><code>Dim sheet As Worksheet\nSet sheet = Worksheets(\"Petrobras\")\n</code></pre>\n\n<p>Now if you want to activate it, you can do <code>sheet.Activate</code> (but you don't need to). And if you want to get a <code>Range</code> from that worksheet, you can make a <code>.Range</code> member call, <em>and the IDE will now help you do it</em>:</p>\n\n<pre><code>Dim result As Range\nSet result = sheet.Range(\"$W:$W\").Find(...)\n</code></pre>\n\n<p><strong>NEVER</strong> chain any member calls to what <code>Range.Find</code> returns. If the search turned up a result, you have a <code>Range</code> object. If it didn't, you have <code>Nothing</code> - and any member call made against <code>Nothing</code> will always raise run-time error 91.</p>\n\n<p>Validate the search result first:</p>\n\n<pre><code>If result Is Nothing Then\n    MsgBox \"Could not find '\" &amp; Opp_Num_Search.Value &amp; \"' in column W.\"\n    Exit Sub\nEnd If\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>If Not result Is Nothing Then\n    sheet.Range(\"A1149\").Value = result.Value\nEnd If\n</code></pre>\n\n<p>Note that <code>A1149</code> is a <em>string literal</em> representing a cell address, and as such it must be surrounded with double quotes (<code>\"</code>). If it's not in double quotes and it looks like a valid variable name, VBA will treat it as ..a variable... and that will cause yet another error (1004), because <code>Range</code> will be rather unhappy to work with a <code>Variant/Empty</code> value.</p>\n\n<p>To prevent VBA from \"declaring\" on-the-fly variables with a typo (and causing hard-to-find bugs), make sure you have <code>Option Explicit</code> at the very top of every module in your project.</p>\n\n<p>One last thing:</p>\n\n<blockquote>\n<pre><code> UserForm1.Hide\n</code></pre>\n</blockquote>\n\n<p>This hides <em>the default instance</em> of <code>UserForm1</code>, which may or may not be the current object / instance that's shown - and the form itself has no way to know how it was shown:</p>\n\n<pre><code>UserForm1.Show '&lt;~ shows the default instance\n</code></pre>\n\n\n\n<pre><code>With New UserForm1\n    .Show '&lt;~ shows a new (non-default) instance\nEnd With\n</code></pre>\n\n<p>For this reason, you should avoid referring to the default instance in a form's code-behind. Use <code>Me</code> instead:</p>\n\n<pre><code>Me.Hide\n</code></pre>\n\n<p>That way you're referring to <em>whatever instance of the form is currently shown</em>, whether that's the default instance or not. See <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">UserForm1.Show</a> for more information, tips, pitfalls and common mistakes involving userforms.</p>\n\n<p>Note that <a href=\"http://rubberduckvba.com/Inspections/List\" rel=\"nofollow noreferrer\">Rubberduck has quite a few inspections</a> that can identify and warn you about (and often, automatically fix) most of these problems. Rubberduck is a free and open-source VBIDE add-in project I manage.</p>\n"}], "owner": {"reputation": 31, "user_id": 12240048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5eaff90647cfa31a7f63797c11880cff?s=128&d=identicon&r=PG&f=1", "display_name": "AXL", "link": "https://stackoverflow.com/users/12240048/axl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1572449995, "creation_date": 1572446705, "last_edit_date": 1572449075, "question_id": 58627938, "link": "https://stackoverflow.com/questions/58627938/how-to-use-the-find-function", "title": "How to Use the Find Function", "body": "<p>I have recently Written some code to take an input from a userform text box and search for it in my database. If found I would like it to return the value and insert it into cell A1149; I have written the below code but it gives me error #424 \"Object Required\". I am very new to VBA so any and all help is greatly appreciated.</p>\n\n<pre><code>Private Sub CMDSearch_Click()\n\n     Dim pesquisa As Range\n\n     Set pesquisa = Worksheets(\"Petrobras\").Activate.Range(\"$W:$W\") _\n         .Find(What:=Opp_Num_Search.Value, LookIn:=xlValues, Lookat:=xlWhole).Activate\n\n     Worksheets(\"Petrobras\").Range(A1149).Value = pesquisa.Value\n\n     UserForm1.Hide\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1572444583, "post_id": 58627210, "comment_id": 103561938, "body": "Use a <code>Select Case</code> here. You have to repeat the <code>mypass &lt;&gt;</code> for each <code>Or</code>, and it&#39;s already lengthy."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1572444697, "post_id": 58627210, "comment_id": 103562007, "body": "Why would you ask the user to reopen the file to try again? Why not showing a message to try again until you get the password right or click cancel to close the workbook?"}, {"owner": {"reputation": 9, "user_id": 9373960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dafa69d253a277ea6b88fa7c4edfa173?s=128&d=identicon&r=PG&f=1", "display_name": "Santis789", "link": "https://stackoverflow.com/users/9373960/santis789"}, "edited": false, "score": 0, "creation_date": 1572444792, "post_id": 58627210, "comment_id": 103562065, "body": "I tried that but found that to be way above my skills, sadly. Do you know, how I could implement this? I tried to implement it as an &#39;if else statement&#39;, but without luck"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1572444976, "post_id": 58627210, "comment_id": 103562161, "body": "Going to suggest a different approach, which will cut down your overall code significantly... use a variant array with the names of your sheets.  Loop through the array and if you have any matches, then pass the arr(i) to the visible function, otherwise display a msgbox saying incorrect password then redisplay the prompt afterwards."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1572445023, "post_id": 58627210, "comment_id": 103562193, "body": "@Cyril - that is a good idea, except for the case of <code>BJE</code>, which corresponds to the <code>Overview</code> sheet, so you&#39;d have to tweak the approach slightly. Maybe a dictionary."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1572445210, "post_id": 58627210, "comment_id": 103562313, "body": "@BigBen true, though you can have a the array be the passwords and have a separate check for sheets(&quot;overview&quot;).  will end up being similar to your answer with the select case being used, but would have less... guess i&#39;ll mock it up as an answer"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1572445264, "post_id": 58627210, "comment_id": 103562356, "body": "@Cyril I&#39;m wondering if the passwords are the sheet names or if this is just sample data... That said, mocking up a loop to reprompt until you get the right password would be a great answer."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1572445302, "post_id": 58627210, "comment_id": 103562380, "body": "@BigBen i was thinkign similarly, in which case 2 arrays would be perfrect... one for passwords and one for sheets"}, {"owner": {"reputation": 9, "user_id": 9373960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dafa69d253a277ea6b88fa7c4edfa173?s=128&d=identicon&r=PG&f=1", "display_name": "Santis789", "link": "https://stackoverflow.com/users/9373960/santis789"}, "edited": false, "score": 0, "creation_date": 1572446444, "post_id": 58627210, "comment_id": 103563098, "body": "Thank you all! I have applied the select case and it works like magic! :)"}, {"owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 1, "creation_date": 1572448789, "post_id": 58627210, "comment_id": 103564535, "body": "Just so you&#39;re aware, you shouldn&#39;t be trusting this for any security purposes. The user can always pause execution of the VBA, then hide/unhide whatever sheets they want. Even if the workbook/worksheet is password protected, cracking that is extremely easy (see the related posts for this question)."}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 3, "last_activity_date": 1572444800, "creation_date": 1572444800, "answer_id": 58627314, "question_id": 58627210, "link": "https://stackoverflow.com/questions/58627210/workbook-to-close-if-passwords-were-incorrect/58627314#58627314", "title": "Workbook to close if passwords were incorrect", "body": "<p>You need to repeat the <code>mypass &lt;&gt;</code> for each <code>String</code> you're checking.</p>\n\n<pre><code>If mypass &lt;&gt; \"BJE\" Or mypass &lt;&gt; \"BFL\" Or mypass &lt;&gt; \"EBR\"...\n</code></pre>\n\n<p>That's cumbersome. Use <code>Select Case</code> and <code>Case Else</code> to close.</p>\n\n<pre><code>Select Case myPass\n    Case \"BJE\"\n         ThisWorkbook.Sheets(\"Overview\").Visible = True ' Or use the sheet code name\n    Case \"BFL\"\n         ThisWorkbook.Sheets(\"BFL\").Visible = True\n\n    ... ' and so on\n\n    Case Else\n         ThisWorkbook.Close ' though as pointed out, this is a pretty harsh user experience\nEnd Select\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 9373960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dafa69d253a277ea6b88fa7c4edfa173?s=128&d=identicon&r=PG&f=1", "display_name": "Santis789", "link": "https://stackoverflow.com/users/9373960/santis789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 58627314, "answer_count": 1, "score": 0, "last_activity_date": 1572446516, "creation_date": 1572444476, "last_edit_date": 1572444599, "question_id": 58627210, "link": "https://stackoverflow.com/questions/58627210/workbook-to-close-if-passwords-were-incorrect", "title": "Workbook to close if passwords were incorrect", "body": "<p>In case a user enters a worng password I want the workbook to close down without saving. However, the code I'm trying does not work. </p>\n\n<pre><code>Sub Unhide()\n\nmypass = Application.InputBox( _\nprompt:=\"Enter password - In case of wrong password please close the file \nand try again\")\n\n\nIf mypass = \"BJE\" Then Sheets(\"Overview\").Visible = True\nIf mypass = \"BFL\" Then Sheets(\"BFL\").Visible = True\nIf mypass = \"EBR\" Then Sheets(\"EBR\").Visible = True\nIf mypass = \"DME\" Then Sheets(\"DME\").Visible = True\nIf mypass = \"AJA\" Then Sheets(\"AJA\").Visible = True\nIf mypass = \"RLC\" Then Sheets(\"RLC\").Visible = True\nIf mypass = \"JMK\" Then Sheets(\"JMK\").Visible = True\nIf mypass = \"AXB\" Then Sheets(\"AXB\").Visible = True\nIf mypass = \"JIK\" Then Sheets(\"JIK\").Visible = True\nIf mypass = \"KKO\" Then Sheets(\"KKO\").Visible = True\n\nIf mypass &lt;&gt; \"BJE\" Or \"BFL\" Or \"EBR\" Or \"DME\" Or \"AJA\" Or \"RLC\" Or \"JMK\" \nOr \"AXB\" Or \"JIK\" Or \"KKO\" Then ThisWorkbook.Close\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "edited": false, "score": 0, "creation_date": 1572522861, "post_id": 58627014, "comment_id": 103590881, "body": "What do you mean by &quot;protected space&quot;? A non-breaking space?"}, {"owner": {"reputation": 17, "user_id": 8642714, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158585000200402/picture?type=large", "display_name": "Cat J", "link": "https://stackoverflow.com/users/8642714/cat-j"}, "reply_to_user": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "edited": false, "score": 0, "creation_date": 1572524702, "post_id": 58627014, "comment_id": 103591867, "body": "Yes (Ctrl + Shift + Space). We call them protected spaces in my workplace, sorry"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 8642714, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158585000200402/picture?type=large", "display_name": "Cat J", "link": "https://stackoverflow.com/users/8642714/cat-j"}, "edited": false, "score": 0, "creation_date": 1572521522, "post_id": 58629220, "comment_id": 103590160, "body": "Thanks for your suggestion, but I don&#39;t want to replace the month with a space, I want to replace the normal space following the month with a protected space, so I changed the &quot;.Replacement.Text&quot;-&quot;.Execute&quot; to Selection.MoveRight once, TypeBackspace once, TypeText &quot; &quot; and Execute, using Selection as it didn&#39;t like when I used Range. The result of this was it deleted 12 characters where the cursor was and inserted 12 protected spaces."}, {"owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "reply_to_user": {"reputation": 17, "user_id": 8642714, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158585000200402/picture?type=large", "display_name": "Cat J", "link": "https://stackoverflow.com/users/8642714/cat-j"}, "edited": false, "score": 0, "creation_date": 1572534967, "post_id": 58629220, "comment_id": 103597856, "body": "&quot;converts the space to a protected space&quot; was your text that looked like you needed a space. What is a &quot;protected space&quot;? That phrase is not used in Word or VBA. As I menitoned, you should use Range instead of Selection, as both Timothy and I have done."}], "tags": [], "owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "is_accepted": false, "score": 1, "last_activity_date": 1572450682, "creation_date": 1572450682, "answer_id": 58629220, "question_id": 58627014, "link": "https://stackoverflow.com/questions/58627014/searching-for-12-separate-strings-with-one-function/58629220#58629220", "title": "Searching for 12 separate strings with one function", "body": "<p>I wasn't able to make your posted code do anything. Please test the code below to see if it does what you need:</p>\n\n<pre><code>Sub MonthNamesToSpaces()\n  Dim Months$(0 To 11)\n  Months(0) = \"January \": Months(1) = \"February \": Months(2) = \"March \": Months(3) = \"April \": Months(4) = \"May \": Months(5) = \"June \": Months(6) = \"July \": Months(7) = \"August \": Months(8) = \"September \": Months(9) = \"October \": Months(10) = \"November \": Months(11) = \"December \"\n  For X = 0 To 11\n    With ActiveDocument.Range.Find\n      .Text = Months$(X)\n      .Replacement.Text = \" \"\n      .Wrap = wdFindContinue\n      .Execute Replace:=wdReplaceAll\n    End With\n  Next X\nEnd Sub\n</code></pre>\n\n<p>Using the <strong>Range</strong> object instead of <em>Selection</em> makes for faster, more reliable code.</p>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 8642714, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158585000200402/picture?type=large", "display_name": "Cat J", "link": "https://stackoverflow.com/users/8642714/cat-j"}, "edited": false, "score": 0, "creation_date": 1572520581, "post_id": 58631208, "comment_id": 103589697, "body": "Cursor is already at the beginning of the document. Unsure where to place the FindContinue, but I put it just before Loop. Ran the macro on a different document with these dates in this order: 28 October 2019, 22 May 2005, 15 November 2019, and it skipped October and worked only on May and November. Also moving the cursor to elsewhere in the document (e.g. just before May) returned the same result."}], "tags": [], "owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "is_accepted": false, "score": 0, "last_activity_date": 1572458154, "creation_date": 1572458154, "answer_id": 58631208, "question_id": 58627014, "link": "https://stackoverflow.com/questions/58627014/searching-for-12-separate-strings-with-one-function/58631208#58631208", "title": "Searching for 12 separate strings with one function", "body": "<p>It's possible that Find is stopping when it reaches the end of your document. If that's the case you can (1) move the cursor to the top of the document before Find/Replace, and (2) set </p>\n\n<pre><code>Find.Wrap=wdFindContinue \n</code></pre>\n\n<p>so that Find wraps around when it reached the end of the document.</p>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 8642714, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158585000200402/picture?type=large", "display_name": "Cat J", "link": "https://stackoverflow.com/users/8642714/cat-j"}, "edited": false, "score": 0, "creation_date": 1572525537, "post_id": 58643410, "comment_id": 103592365, "body": "Yes! It worked on every instance of a month! Thank you! I had no idea you could do item &amp; &quot; &quot;, that&#39;s a game-changer"}], "tags": [], "owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "is_accepted": true, "score": 0, "last_activity_date": 1572525074, "creation_date": 1572525074, "answer_id": 58643410, "question_id": 58627014, "link": "https://stackoverflow.com/questions/58627014/searching-for-12-separate-strings-with-one-function/58643410#58643410", "title": "Searching for 12 separate strings with one function", "body": "<p>You are on the right track in using an array to hold the months but you don't need to include the following space.</p>\n\n<p>There is also no need to make things complicated as Find and Replace can do the job for you.</p>\n\n<pre><code>Sub FollowMonthWithNonBreakingSpace()\n\n  Dim item As Variant\n  Dim months(1 To 12) As String\n\n  months(1) = \"January\": months(2) = \"February\": months(3) = \"March\": months(4) = \"April\": _\n  months(5) = \"May\": months(6) = \"June\": months(7) = \"July\": months(8) = \"August\": _\n  months(9) = \"September\": months(10) = \"October\": months(11) = \"November\": months(12) = \"December\"\n\n  For Each item In months\n    With ActiveDocument.Range.Find\n      .Text = item &amp; \" \"\n      .Replacement.Text = item &amp; \"^s\"\n      .Wrap = wdFindContinue\n      .Execute Replace:=wdReplaceAll\n    End With\n  Next item\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 8642714, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158585000200402/picture?type=large", "display_name": "Cat J", "link": "https://stackoverflow.com/users/8642714/cat-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 58643410, "answer_count": 3, "score": 0, "last_activity_date": 1572525074, "creation_date": 1572443826, "last_edit_date": 1572448779, "question_id": 58627014, "link": "https://stackoverflow.com/questions/58627014/searching-for-12-separate-strings-with-one-function", "title": "Searching for 12 separate strings with one function", "body": "<p>I've got a macro that searches for a string (\"January \") and converts the space to a protected space. What I'd like to do is search for the other months of the year as well. Is there a way of searching for the other months within the same function, rather than copy and paste my code 11 times, searching for a different month each time?</p>\n\n<p>Here's my code so far after a couple of suggestions that have mostly worked but not quite and I can't figure out why:</p>\n\n<pre><code>Dim item As Variant\nDim months(1 To 12) As String\nDim str As String\n\n    months(1) = \"January \": months(2) = \"February \": months(3) = \"March \": months(4) = \"April \": months(5) = \"May \": months(6) = \"June \": months(7) = \"July \": months(8) = \"August \": months(9) = \"September \": months(10) = \"October \": months(11) = \"November \": months(12) = \"December \"\n\n    For Each item In months\n        Selection.Find.Execute item\n        Do Until Selection.Find.Found = False\n            Selection.MoveRight.Unit:=wdCharacter, Count:=1\n            Selection.TypeBackspace\n            Selection.TypeText Text:=\" \"\n            Selection.Find.Execute\n        Loop\n    Next\nEnd Sub\n</code></pre>\n\n<p>I have a letter containing four dates in this order: October 2019, December 1974, November 2019, October 2019. I also added a list of 12 dates (various dates and years, but one for each month) at the end of the letter, to test it worked on every month, which it does.</p>\n\n<p>In the body of the letter, only the two October 2019s work. When changing December 1974 to October 1974, that one works, but the first October 2019 doesn't. When changing them to this order: September 2019, October 1974, November 2019, December 2019, they all work. When changing them to December 2019, November 1974, October 2019, September 2019, only September works.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1572443457, "post_id": 58626847, "comment_id": 103561247, "body": "Where did you place the code? It should be in a sheet code module. Also, best to loop - <code>If Target = 1</code> will fail if <code>Target</code> is more than one cell."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1572443526, "post_id": 58626847, "comment_id": 103561280, "body": "Where do you check for &quot;yes&quot;?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1572443587, "post_id": 58626847, "comment_id": 103561318, "body": "Your code and description do not match.  The code is checking B for <code>1</code> and clearing A."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1572443594, "post_id": 58626847, "comment_id": 103561325, "body": "I think you have your logic the wrong way round. Perform an <code>Intersect</code> on <code>Column A</code> and then check if <code>Target.Value</code> is <b>yes</b>. If it is, clear cell in <code>Column B</code>"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1572443643, "post_id": 58626847, "comment_id": 103561363, "body": "@ScottCraner great minds and all of that :)"}, {"owner": {"reputation": 65, "user_id": 12297683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UYb16.png?s=128&g=1", "display_name": "Codingnoob", "link": "https://stackoverflow.com/users/12297683/codingnoob"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1572443717, "post_id": 58626847, "comment_id": 103561414, "body": "@JvdV Sorry, I just Edited my code."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1572443764, "post_id": 58626847, "comment_id": 103561449, "body": "So yes is a variable? I assume it&#39;s a string &quot;yes&quot;?"}, {"owner": {"reputation": 65, "user_id": 12297683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UYb16.png?s=128&g=1", "display_name": "Codingnoob", "link": "https://stackoverflow.com/users/12297683/codingnoob"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1572443806, "post_id": 58626847, "comment_id": 103561478, "body": "@JvdV yes it is a String"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1572443930, "post_id": 58626847, "comment_id": 103561543, "body": "<code>If Target = &quot;yes&quot; Then</code> Then if it is not running and is located in the actual worksheet module and not a general code module, then you need to make sure the events are enabled.  Put <code>Application.EnableEvents = True</code> in the immediate window and hit Enter."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1572444316, "post_id": 58626847, "comment_id": 103561776, "body": "I think the problem is that you are typing or inserting values into column B. However, that will never intersect with column A. So no clearing happens when the A column cell in the same row holds &quot;yes&quot;. Correct? That would be exactly opposite to what has been previously mentioned. Can you clarify which column you are entering values into. A or B?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1572444691, "post_id": 58626847, "comment_id": 103562004, "body": "<code>yes</code> is a variable and since it isn&#39;t <i>declared</i> or <i>set</i> the value of that variable is nothing. So when you do <code>If Target = yes Then</code> you are actually saying <code>If Target = &quot;&quot; Then</code> which is not your intention. String Literals need to be encased in double quotes;so instead: <code>If Target = &quot;yes&quot; Then</code>"}, {"owner": {"reputation": 65, "user_id": 12297683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UYb16.png?s=128&g=1", "display_name": "Codingnoob", "link": "https://stackoverflow.com/users/12297683/codingnoob"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1572445459, "post_id": 58626847, "comment_id": 103562481, "body": "@JvdV im entering values into column A. If value in column A = yes, I want the value in column B to be deleted."}, {"owner": {"reputation": 65, "user_id": 12297683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UYb16.png?s=128&g=1", "display_name": "Codingnoob", "link": "https://stackoverflow.com/users/12297683/codingnoob"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1572445493, "post_id": 58626847, "comment_id": 103562514, "body": "@JNevill I tried using the double quotes but it still doesnt work!"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1572445633, "post_id": 58626847, "comment_id": 103562598, "body": "That&#39;s probably due to the other reasons @ScottCraner mentioned. Make sure this code resides in your Worksheet&#39;s code, not in a &quot;module&quot;. Ensure that <code>Application.EnableEvents</code> is toggled to <code>True</code>. Lastly, save the workbook at least once (that one trips me up sometimes). Also.. I believe it&#39;s <code>ClearContents</code> but perhaps <code>Clear</code> works as well... I&#39;ve never used it."}, {"owner": {"reputation": 65, "user_id": 12297683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UYb16.png?s=128&g=1", "display_name": "Codingnoob", "link": "https://stackoverflow.com/users/12297683/codingnoob"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1572446255, "post_id": 58626847, "comment_id": 103562995, "body": "It might be a silly question, but, theres already some code that is running on my worksheet code. How do i add another one? Where do I paste it ?. @JNevill"}], "owner": {"reputation": 65, "user_id": 12297683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UYb16.png?s=128&g=1", "display_name": "Codingnoob", "link": "https://stackoverflow.com/users/12297683/codingnoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572444018, "creation_date": 1572443287, "last_edit_date": 1572443681, "question_id": 58626847, "link": "https://stackoverflow.com/questions/58626847/how-to-delete-value-in-cell-b-if-cell-a-yes", "title": "How to delete value in cell B if cell A = yes", "body": "<p>I want to be able to delete the value in cells B:B if value in A:A = yes </p>\n\n<p>This is what I tried but doesnt work, maybe I placed the code in the wrong place ? </p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"A:A\")) Is Nothing Then\n        If Target = yes Then\n            Range(\"B\" &amp; Target.Row).Clear\n        End If\n    End If\nEnd Sub\n\n</code></pre>\n"}, {"tags": ["excel", "vba", "function", "return"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1572443205, "post_id": 58626759, "comment_id": 103561099, "body": "Change <code>If endAll Then End</code> to <code>If endAll Then Exit Function</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1572443266, "post_id": 58626759, "comment_id": 103561136, "body": "1.  F2 should be a <code>Sub</code> as it is not returning anything back to the caller.  2. <code>Sub F2(Optional endAll As Boolean = False,R1 as Long,C1 as Long,jGetFormula as String)</code> then call it <code>Call F2(True,R1,C1,JGetFormula)</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1572443305, "post_id": 58626759, "comment_id": 103561159, "body": "But also, if <code>F1</code> is called from the worksheet and not another Sub it will fail."}, {"owner": {"reputation": 3, "user_id": 12289869, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XJyTXQYQ-Wo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reT0ddvSp2n8CsMBgYrrARWQKoJbg/photo.jpg?sz=128", "display_name": "afroz tulip", "link": "https://stackoverflow.com/users/12289869/afroz-tulip"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1572517100, "post_id": 58626759, "comment_id": 103587768, "body": "@Scott Craner I am getting compile error on this line Sub f2(Optional endAll As Boolean = False, jR1 as Long, jC1 as Long, jGetFormula as String)."}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 12289869, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XJyTXQYQ-Wo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reT0ddvSp2n8CsMBgYrrARWQKoJbg/photo.jpg?sz=128", "display_name": "afroz tulip", "link": "https://stackoverflow.com/users/12289869/afroz-tulip"}, "is_accepted": true, "score": 0, "last_activity_date": 1572672905, "creation_date": 1572672905, "answer_id": 58668531, "question_id": 58626759, "link": "https://stackoverflow.com/questions/58626759/vba-pass-arguments-from-one-function-to-another-function-without-returning-to/58668531#58668531", "title": "VBA - Pass arguments from one function to another function without returning to first function", "body": "<pre><code>Function ffeeee2(jR1 As Long, jC1 As Long, jGetFormula As String, Optional endAll As Boolean = True)\n        MsgBox jGetFormula\n        MsgBox \"function f1 entered in cell (\" &amp; jR1 &amp; \",\" &amp; jC1 &amp; \")\"\n        MsgBox \"This ends f2\"\n        If endAll Then Exit Function\n    End Function\n\n    Function ffeeee1()\n        Dim jR1 As Long\n        Dim jC1 As Long\n        Dim jGetFormula As String\n        jR1 = Selection.Row\n        jC1 = Selection.Column\n        jGetFormula = \"Function value from f1 (row number + column number =\" &amp; jR1 + jC1 &amp; \")\"\n        Call ffeeee2(jR1, jC1, jGetFormula, True)\n    End Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12289869, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XJyTXQYQ-Wo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reT0ddvSp2n8CsMBgYrrARWQKoJbg/photo.jpg?sz=128", "display_name": "afroz tulip", "link": "https://stackoverflow.com/users/12289869/afroz-tulip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 1, "accepted_answer_id": 58668531, "answer_count": 1, "score": 0, "last_activity_date": 1572672905, "creation_date": 1572443011, "last_edit_date": 1572589337, "question_id": 58626759, "link": "https://stackoverflow.com/questions/58626759/vba-pass-arguments-from-one-function-to-another-function-without-returning-to", "title": "VBA - Pass arguments from one function to another function without returning to first function", "body": "<p>Any methods where I can pass variables from one function to another without returning to first function\nSay:</p>\n\n<pre><code>Function F2(Optional endAll As Boolean = False)\n\nCells(R1,C1)= Evaluate(jGetFormula)\n\nIf endAll Then End\n\n\nEnd Sub\n\nFunction f1()\njGetFormula = \" = \" &amp; \"A1\" &amp; \"*\" &amp; 10 &amp; \"^\" &amp; 3 &amp; \"*\" A2 &amp; \"/\" &amp; 148 \nR1 = Selection.Row\nC1 = Selection.Column\nCall F2(True)\n\nEnd Function\n</code></pre>\n\n<p>here function f1() creates excel formula and get corresponding row and column number of cells where =f1() entered in cell and passing these to another function and end without returning back to f1().\nThe function f2() takes arguments from f1() and converts the string to formula and replaces =f1() by the formula as =A1 * 10^3 * A2 / 148 in the cell where earlier =f2() was written.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1572443668, "post_id": 58626659, "comment_id": 103561378, "body": "What is happening?"}, {"owner": {"reputation": 5, "user_id": 11610512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daaaa6be7f79cf59c22fb57335a3a270?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/11610512/steven"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1572443720, "post_id": 58626659, "comment_id": 103561416, "body": "Nothing at all. It will just send the mail anyway."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1572443842, "post_id": 58626659, "comment_id": 103561495, "body": "Does the prompt come up?  What are some of the example addresses being passed in.  More info is needed, no idea what the <code>.recipients</code> collection contains."}, {"owner": {"reputation": 5, "user_id": 11610512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daaaa6be7f79cf59c22fb57335a3a270?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/11610512/steven"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1572443974, "post_id": 58626659, "comment_id": 103561577, "body": "No the prompt won&#39;t come up. Ideally it should check every email with the domain of the company.For .recipients it should check the adress of the recipient in the mail."}, {"owner": {"reputation": 5, "user_id": 11610512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daaaa6be7f79cf59c22fb57335a3a270?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/11610512/steven"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1572444095, "post_id": 58626659, "comment_id": 103561656, "body": "The second code does give a prompt. But as stated if I add more mails te be checked:"}, {"owner": {"reputation": 5, "user_id": 11610512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daaaa6be7f79cf59c22fb57335a3a270?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/11610512/steven"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1572444188, "post_id": 58626659, "comment_id": 103561707, "body": "It will print the whole array. f.e. &quot;test@test.nl,&quot; &amp; &quot;test2@test.nl&quot;"}, {"owner": {"reputation": 5, "user_id": 11610512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daaaa6be7f79cf59c22fb57335a3a270?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/11610512/steven"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1572444336, "post_id": 58626659, "comment_id": 103561790, "body": "Also, when I enter a different email in the mail, for example yes@test.nl it will still print I am sending this to test@test.nl even though I didn&#39;t put that mail in the recipients."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1572447865, "post_id": 58626659, "comment_id": 103563995, "body": "In the 2nd code, <code>If xPos = 0 Then</code> would check for not found, as <code>instr(1,&quot;nathan&quot;,&quot;test&quot;)</code> returns 0"}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1572452090, "post_id": 58626659, "comment_id": 103566458, "body": "Nathan hit the nail on the head with recipients collection. You&#39;re likely having mismatches between Display Name values of the recipient and actual email address. Is this an exchange server you&#39;re working on?  The second set of code is correctly calling out the .Address property of the Recipient item which is why its actually doing something. The first code is almost certainly saying InStr(&quot;My Name&quot;,&quot;myemailaddress@nl.com&quot;). Second code depending on your setup(Exchange vs other) may be returning a different address than you are expecting.  Suggest stepping through while watching locals window."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11610512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daaaa6be7f79cf59c22fb57335a3a270?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/11610512/steven"}, "edited": false, "score": 0, "creation_date": 1572598519, "post_id": 58630412, "comment_id": 103616364, "body": "Yes I am using Exchange Server. I will try out your code. So basically I will only have to add this code after On Error Resume Next and add the code for the prompt to appear in case of SMTP. Is that correct? (And also include the Dim&#39;s for recip.Address and Recip.AddressEntry.Type)"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 5, "user_id": 11610512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daaaa6be7f79cf59c22fb57335a3a270?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/11610512/steven"}, "edited": false, "score": 0, "creation_date": 1572619423, "post_id": 58630412, "comment_id": 103625375, "body": "Yes, that&#39;s pretty much it."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1572454933, "creation_date": 1572454933, "answer_id": 58630412, "question_id": 58626659, "link": "https://stackoverflow.com/questions/58626659/prompt-for-verifying-recipients/58630412#58630412", "title": "Prompt for verifying recipients", "body": "<p>Multiple problems - you are treating <code>Recipient</code> object as a string (you pass it to <code>LCase</code>, which expects a string) - in that case VBA converts the object to a string by reading the default property (which is most likely <code>Name</code>). You need to use <code>recip.Address</code> instead.</p>\n\n<p>Are you using Exchange Server? In that case all internal recipients will have address type of \"EX\" and external recipients \"SMTP\"</p>\n\n<p>In that case your check must be </p>\n\n<pre><code>If recip.AddressEntry.Type = \"SMTP\" Then\n   ...\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 11610512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daaaa6be7f79cf59c22fb57335a3a270?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/11610512/steven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 58630412, "answer_count": 1, "score": 0, "last_activity_date": 1576430721, "creation_date": 1572442701, "last_edit_date": 1576430721, "question_id": 58626659, "link": "https://stackoverflow.com/questions/58626659/prompt-for-verifying-recipients", "title": "Prompt for verifying recipients", "body": "<p>When sending an email to anyone outside of my business I want a prompt asking for confirmation with all the recipients printed in the prompt.</p>\n\n<p>I tried code from <a href=\"https://stackoverflow.com/questions/31247643/outlook-vba-to-verify-recipient\">Outlook VBA to verify recipient</a>. It does nothing.</p>\n\n<p>I tried multiple things from multiple sites but none give me what I am looking for.</p>\n\n<p>I am using the following code:</p>\n\n<pre><code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\nDim lbadFound  As Boolean\nDim badAddresses As String\nlbadFound = False\n\nCheckList = \"test@test.nl\"\n\nSet Recipients = Item.Recipients\nFor i = Recipients.Count To 1 Step -1\n    Set recip = Recipients.Item(i)\n\n    If InStr(1, LCase(CheckList), LCase(recip)) &gt;= 1 Then\n        lbadFound = True\n        badAddresses = badAddresses &amp; recip &amp; vbCrLf\n    End If\n\nNext i\n\nIf lbadFound Then\n    prompt$ = \"You sending this mail to one or more black listed email address(es)\" &amp; badAddresses &amp; vbCrLf &amp; \" Are you sure you want to send it?\"\n    If MsgBox(prompt$, vbYesNo + vbQuestion + vbMsgBoxSetForeground, \"Check Address\") = vbNo Then\n        Cancel = True\n    End If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>This code makes use of a checklist. The idea is to fill the checklist with all the e-mails of the company and prompt with an if-statement when the recipient is not in this list (prompting with all mail addresses of the recipients that are not in the checklist).</p>\n\n<p>I also tried this and it will prompt but it prints every item in the xAddress:</p>\n\n<pre><code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n'UpdatebyExtendoffice20180523\nDim xRecipients As Outlook.Recipients\nDim xRecipient As Outlook.Recipient\nDim xPos As Integer\nDim xYesNo As Integer\nDim xPrompt As String\nDim xAddress As String\nOn Error Resume Next\nIf Item.Class &lt;&gt; olMail Then Exit Sub\nSet xRecipients = Item.Recipients\nxAddress = \"example1@gmail.com\"\nFor Each xRecipient In xRecipients\n    xPos = InStr(LCase(xRecipient.Address), xAddress)\n    If xPos = 0 Then\n        xPrompt = \"You sending this to \" &amp; xAddress &amp; \". Are you sure you want to send it?\"\n        xYesNo = MsgBox(xPrompt, vbYesNo + vbQuestion + 4096, \"Kutools for Outlook\")\n        If xYesNo = vbNo Then Cancel = True\n    End If\nNext xRecipient\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "office365"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1572442384, "post_id": 58626514, "comment_id": 103560634, "body": "Just to check - were Book1 and Book2 both closed before you ran this? Calling <code>Workbook.Open</code> on an already open workbook can cause issues."}, {"owner": {"reputation": 1, "user_id": 3189945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c9104cecba3563abf8a9df7eac14f82?s=128&d=identicon&r=PG&f=1", "display_name": "user3189945", "link": "https://stackoverflow.com/users/3189945/user3189945"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1572443070, "post_id": 58626514, "comment_id": 103561020, "body": "They are not closed. I&#39;ve just re-run the code with the workbooks closed and there is no problem. It is strange this doesn&#39;t happen in Excel 2016."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1572443177, "post_id": 58626514, "comment_id": 103561076, "body": "There have been previous similar questions here on SO, if I remember correctly. I don&#39;t know if they were tied to a specific version of Excel."}, {"owner": {"reputation": 1, "user_id": 3189945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c9104cecba3563abf8a9df7eac14f82?s=128&d=identicon&r=PG&f=1", "display_name": "user3189945", "link": "https://stackoverflow.com/users/3189945/user3189945"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1572443473, "post_id": 58626514, "comment_id": 103561256, "body": "OK, I am happy to delete this post if required. Thanks for your help."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1572443623, "post_id": 58626514, "comment_id": 103561348, "body": "I think <a href=\"https://stackoverflow.com/q/56260958/9245853\">this question</a> is pretty similar, and it looks like it&#39;s Excel 365, interesting."}, {"owner": {"reputation": 1, "user_id": 3189945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c9104cecba3563abf8a9df7eac14f82?s=128&d=identicon&r=PG&f=1", "display_name": "user3189945", "link": "https://stackoverflow.com/users/3189945/user3189945"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1572446004, "post_id": 58626514, "comment_id": 103562844, "body": "I agree, it&#39;s the same problem and interestingly also using Office 365. In the section of code I was debugging I had a break point which was hit before the workbooks were closed which has caused this problem to arise. So it is no longer a problem."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1572447314, "post_id": 58626514, "comment_id": 103563671, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/56260958/why-is-freshly-opened-workbook-name-different-from-workbook-title-in-excel-windo\">Why is freshly opened Workbook.Name different from Workbook title in Excel window?</a>"}, {"owner": {"reputation": 1, "user_id": 3189945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c9104cecba3563abf8a9df7eac14f82?s=128&d=identicon&r=PG&f=1", "display_name": "user3189945", "link": "https://stackoverflow.com/users/3189945/user3189945"}, "edited": false, "score": 0, "creation_date": 1572447596, "post_id": 58626514, "comment_id": 103563840, "body": "I think the question, &#39;Why does this happen?&#39; is still yet to be answered."}], "owner": {"reputation": 1, "user_id": 3189945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c9104cecba3563abf8a9df7eac14f82?s=128&d=identicon&r=PG&f=1", "display_name": "user3189945", "link": "https://stackoverflow.com/users/3189945/user3189945"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572468483, "creation_date": 1572442260, "last_edit_date": 1592644375, "question_id": 58626514, "link": "https://stackoverflow.com/questions/58626514/workbook-object-ref-overwritten-by-second-workbook-object-excel-office-365", "title": "Workbook object ref&#39; overwritten by second workbook object- Excel Office 365", "body": "<p>Excel Office 365 Version 1902 (Build 11328.20420)</p>\n<p>When two workbook objects are created and set to different excel files (using Application.Workbooks.Open) the second workbook object reference is somehow overwritten and points to the first file.</p>\n<p>I encountered this problem whilst rewriting code in an existing spreadsheet application at work. The new code opens two excel files concurrently setting each excel workbook object to a file. The first time the method runs the expected behaviour is exhibited., the two objects point to their respective files. On the second and subsequent runs the first object seems to be overwritten by the second object and both objects point to the same file. I recreated this in a test method see below.</p>\n<pre><code>Option Explicit\n\nSub Main()\n\nOn Error GoTo err_handler\n\nDim Book1 As Workbook\nDim Book2 As Workbook\n\nSet Book1 = Application.Workbooks.Open(&quot;C:\\Test\\Book1.xlsx&quot;)\nSet Book2 = Application.Workbooks.Open(&quot;C:\\Test\\Book2.xlsx&quot;)\n\nDebug.Print Book1.Name\nDebug.Print Book2.Name\n\nExit Sub\n\nerr_handler:\nMsgBox Err.Description\n\nEnd Sub\n</code></pre>\n<p>The code produces this set of results</p>\n<p>Run 1:</p>\n<blockquote>\n<p>Book1.xlsx</p>\n<p>Book2.xlsx</p>\n</blockquote>\n<p>Run 2:</p>\n<blockquote>\n<p>Book2.xlsx</p>\n<p>Book2.xlsx</p>\n</blockquote>\n<p>This issue is specific to Office 365. I tested the same code in Office 2016 and there is no issue.</p>\n<p>Office 2016 results:</p>\n<p>Run 1:</p>\n<blockquote>\n<p>Book1.xlsx</p>\n<p>Book2.xlsx</p>\n</blockquote>\n<p>Run 2:</p>\n<blockquote>\n<p>Book1.xlsx</p>\n<p>Book2.xlsx</p>\n</blockquote>\n<p>Is this a known issue that has been corrected in later versions of Office 365 or something new?</p>\n<p>EDIT</p>\n<p>It is yet to be explained why this behavior appears to be specific to Excel 365. The prior answer does not explain why this happens it merely states an observation that unpredictable behavior can occur when open workbooks are reopened. I did not see this same behavior when running the code using Excel 2016 (not Office 365)</p>\n<p>Many thanks,</p>\n<p>Simon.</p>\n"}, {"tags": ["excel", "vba", "loops", "if-statement"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1572442007, "post_id": 58626408, "comment_id": 103560418, "body": "Do you mean that you want to find every instance of &quot;_dup&quot; in column B and insert a row under each one?"}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1572442234, "post_id": 58626408, "comment_id": 103560551, "body": "When looping and adding (or deleting) rows, it&#39;s often better to start from the bottom and work your way up, the reason being when you add a row what was row 2 is now row 3 and what was row 500 is now row 501 (outside of your loop range).  So try going from 500 to 1 step -1 and see if that gets you better results."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 2, "creation_date": 1572442286, "post_id": 58626408, "comment_id": 103560581, "body": "I think what you are looking for is <code>FindNext</code>. There are many examples of it on the web"}, {"owner": {"reputation": 5, "user_id": 12297458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b2f77db3f1a99b116c41aced95cc870?s=128&d=identicon&r=PG&f=1", "display_name": "plorpoise", "link": "https://stackoverflow.com/users/12297458/plorpoise"}, "edited": false, "score": 0, "creation_date": 1572442657, "post_id": 58626408, "comment_id": 103560787, "body": "Thanks for the help - not sure how to reply to specific replies.. but i will look up &quot;FIndNext&quot;, and &quot;Do you mean that you want to find every instance of &quot;_dup&quot; in column B and insert a row under each one? \u2013 SJR 7 mins ago&quot; - yes, exactly this!  I then want to include a simple calculation in that new row, but first things first."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 12297458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b2f77db3f1a99b116c41aced95cc870?s=128&d=identicon&r=PG&f=1", "display_name": "plorpoise", "link": "https://stackoverflow.com/users/12297458/plorpoise"}, "edited": false, "score": 1, "creation_date": 1572469177, "post_id": 58626627, "comment_id": 103574109, "body": "This works perfectly, and really appreciate the comments included so i can follow along with what is happening."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1572442608, "creation_date": 1572442608, "answer_id": 58626627, "question_id": 58626408, "link": "https://stackoverflow.com/questions/58626408/how-can-i-insert-rows-based-on-cell-contents-looped-through-all-rows/58626627#58626627", "title": "How can I insert rows based on cell contents looped through all rows", "body": "<p>Assuming you do want to insert a row under every instance of a cell in column B containing \"_dup\" this should work.</p>\n\n<p>The problem with your code was that it wasn't looping and so only ever found one instance.</p>\n\n<p>It's advisable not to specify a fixed range as you are inserting rows and the range will expand; however, you could do this and set the search direction as \"previous\".</p>\n\n<pre><code>Sub dup_finder()\n\nDim colHeader As Range, s As String\n\nSet colHeader = Range(\"B1:B500\") ' not actually used\n\nDim currCell As Range\n\n'are we searching just B or the whole sheet?\nSet currCell = Columns(2).Find(What:=\"_dup\", Lookat:=xlPart, MatchCase:=False, SearchFormat:=False) 'change parameters to suit\n\nIf Not currCell Is Nothing Then\n    s = currCell.Address             'store address of first found cell\n    Do\n        currCell.Offset(1, 0).EntireRow.Insert Shift:=xlDown\n        Set currCell = Columns(2).FindNext(currCell)  'find next case\n    Loop Until currCell.Address = s  'keep looping until we are back to the original case\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 12297458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b2f77db3f1a99b116c41aced95cc870?s=128&d=identicon&r=PG&f=1", "display_name": "plorpoise", "link": "https://stackoverflow.com/users/12297458/plorpoise"}, "edited": false, "score": 0, "creation_date": 1572469460, "post_id": 58626844, "comment_id": 103574230, "body": "This works as well! Not being good at code i cant comment if yours is better than SJR&#39;s solution, but they give me an idea on different ways to do things - so i really appreciate that"}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "reply_to_user": {"reputation": 5, "user_id": 12297458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b2f77db3f1a99b116c41aced95cc870?s=128&d=identicon&r=PG&f=1", "display_name": "plorpoise", "link": "https://stackoverflow.com/users/12297458/plorpoise"}, "edited": false, "score": 0, "creation_date": 1572515506, "post_id": 58626844, "comment_id": 103586874, "body": "No problem. I have added comments to the code for clarification."}, {"owner": {"reputation": 5, "user_id": 12297458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b2f77db3f1a99b116c41aced95cc870?s=128&d=identicon&r=PG&f=1", "display_name": "plorpoise", "link": "https://stackoverflow.com/users/12297458/plorpoise"}, "edited": false, "score": 0, "creation_date": 1572604505, "post_id": 58626844, "comment_id": 103618594, "body": "Thanks for the comments .. struggling to get my head around how/why there are so many different ways to do things - though i guess thats what grants such flexibility..  Would it be simplest to try and incorporate the formulas in the new row now, or run through another loop looking for the row below the  chosen string (&quot;_dup&quot;)?  I will try a few things and probably come back with more questions."}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "reply_to_user": {"reputation": 5, "user_id": 12297458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b2f77db3f1a99b116c41aced95cc870?s=128&d=identicon&r=PG&f=1", "display_name": "plorpoise", "link": "https://stackoverflow.com/users/12297458/plorpoise"}, "edited": false, "score": 0, "creation_date": 1572605183, "post_id": 58626844, "comment_id": 103618864, "body": "You could do either but I would add the formulas now while you have a reference to the new row. I will update my answer."}, {"owner": {"reputation": 5, "user_id": 12297458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b2f77db3f1a99b116c41aced95cc870?s=128&d=identicon&r=PG&f=1", "display_name": "plorpoise", "link": "https://stackoverflow.com/users/12297458/plorpoise"}, "edited": false, "score": 0, "creation_date": 1572644262, "post_id": 58626844, "comment_id": 103635364, "body": "i know the comments aren&#39;t meant for thanks yous... but thank you! really appreciate it"}], "tags": [], "owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "is_accepted": true, "score": 0, "last_activity_date": 1572645117, "last_edit_date": 1572645117, "creation_date": 1572443281, "answer_id": 58626844, "question_id": 58626408, "link": "https://stackoverflow.com/questions/58626408/how-can-i-insert-rows-based-on-cell-contents-looped-through-all-rows/58626844#58626844", "title": "How can I insert rows based on cell contents looped through all rows", "body": "<p>I suggest always fully qualifying your ranges with the workbook and sheet.</p>\n\n<p>You should be able to adapt this to what you want. You simply enter the range you want to check in, and the value you are checking for.</p>\n\n<p>It works backwards, up through the range, inserting a row below each one it finds.</p>\n\n<pre><code>    Sub InsertRows()\n        ''Declare your variables\n        Dim RngToCheck As Range, ValToFind As String\n        ''Set the range in which to look for your desired string.\n        Set RngToCheck = ThisWorkbook.Sheets(\"Sheet1\").Range(\"B1:B500\")\n        ''Set what string to look for.\n        ValToFind = \"_dup\"\n\n        ''Declare a variable to use as a counter\n        Dim i As Long\n        ''Count backwards through each of the rows in the range.\n        ''(If you went forwards through the range, the rows you\n        ''are inserting would become part of that range and push\n        ''the bottom rows (which you intended to check) out of the range).\n        For i = RngToCheck.Rows.Count To 1 Step -1\n            ''Check if the last characters (the number of characters to\n            ''check is defined by the length of the string we are looking\n            ''for) of the current cell match the string we are looking for.\n            If Right(RngToCheck(i).Value, Len(ValToFind)) = ValToFind Then\n                ''Insert the row (we need to offset by 1 row\n                ''because rows are inserted ABOVE, and we\n                ''want it BELOW the current cell).\n                RngToCheck(i).Offset(1, 0).EntireRow.Insert\n                ''Now you can add your formulas to the new row...\n                ''column A\n                RngToCheck(i).Offset(1, -1).Formula = \"=1+1\"\n                ''column B\n                RngToCheck(i).Offset(1, 0).Formula = \"=2+2\"\n                ''column C\n                RngToCheck(i).Offset(1, 1).Formula = \"=A\" &amp; RngToCheck(i).Offset(1, 1).Row &amp; \"+B\" &amp; RngToCheck(i).Offset(1, 1).Row\n                ''column D\n                RngToCheck(i).Offset(1, 2).Formula = \"Hello\"\n                ''And so on...\n            End If\n        Next i\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 12297458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b2f77db3f1a99b116c41aced95cc870?s=128&d=identicon&r=PG&f=1", "display_name": "plorpoise", "link": "https://stackoverflow.com/users/12297458/plorpoise"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 58626844, "answer_count": 2, "score": 0, "last_activity_date": 1572645117, "creation_date": 1572441906, "last_edit_date": 1572442075, "question_id": 58626408, "link": "https://stackoverflow.com/questions/58626408/how-can-i-insert-rows-based-on-cell-contents-looped-through-all-rows", "title": "How can I insert rows based on cell contents looped through all rows", "body": "<p>I am trying to write a macro that tidies up and interrogates raw data exported from some analytical instrumentation. I would like it to look through one column (sample names) down all rows and look for indicators of specific sample types e.g. duplicates. Finding these indicators I want to insert a row, and in the new inserted row do some simple calculations based on the two rows above.  For now I will just be happy getting the row insertion to work.</p>\n\n<p>I can get it to find the key word and insert 1 row, but it finds the first one and stops. There are multiple instances of these keywords in my data, and i want to insert a row below each</p>\n\n<pre><code>'original code - finds first keyword, inserts row and stops\n\nSub dup_finder()\n    Dim colHeader As Range\n\n    Set colHeader = Range(\"B1:B500\")\n\n\nDim currCell As Range\nSet currCell = Cells.Find(\"*_dup\")\n\nIf Not currCell Is Nothing Then currCell.Offset(1, 0).EntireRow.Insert Shift:=xlDown\n\n\nEnd Sub\n\n'my attempt to include loop - inserts 500 rows below keyword! stops \nafter first instance\n\nSub dup_finder()\nDim colHeader As Range\nDim row As Long\nDim currCell As Range\n\nSet colHeader = Range(\"B1:B500\")\n\nSet currCell = Cells.Find(\"_dup\")\n        For row = 1 To 500\nIf Not currCell Is Nothing Then currCell.Offset(1, 0).EntireRow.Insert Shift:=xlDown\n\n Next row\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "named-ranges"], "comments": [{"owner": {"reputation": 19, "user_id": 10403843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5032ccdfafebe563b326c2eb3ad886b?s=128&d=identicon&r=PG&f=1", "display_name": "GM13", "link": "https://stackoverflow.com/users/10403843/gm13"}, "edited": false, "score": 0, "creation_date": 1572440900, "post_id": 58626068, "comment_id": 103559730, "body": "actually no. it does not work with a non-active range either. same error"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1572440932, "post_id": 58626068, "comment_id": 103559753, "body": "We need more detail on how you are setting up <code>Range(&quot;SpRatings&quot;)</code>."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1572441655, "post_id": 58626068, "comment_id": 103560212, "body": "@GM13 When you get the error, what is your <code>i</code>?  You&#39;re positive that your named range has the same count to your data labels/points?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1572441668, "post_id": 58626068, "comment_id": 103560216, "body": "You haven&#39;t mentioned which line throws the error? Also, it would be useful to see a sample of your chart"}], "owner": {"reputation": 19, "user_id": 10403843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5032ccdfafebe563b326c2eb3ad886b?s=128&d=identicon&r=PG&f=1", "display_name": "GM13", "link": "https://stackoverflow.com/users/10403843/gm13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572440962, "creation_date": 1572440783, "last_edit_date": 1572440962, "question_id": 58626068, "link": "https://stackoverflow.com/questions/58626068/application-defined-or-object-defined-error-with-active-range", "title": "Application-defined or object -defined error with active range", "body": "<p>I am using the VBA code below were SpRatings is the name of a named range (created with an offset formula that gives me a column of different heights depending on the number of items contained). When i was running this code with a non-active range, it seemed to work. Can somebody advise on how to fix it for it to work? </p>\n\n<p>I strictly need to have the for loop looping through an active range. </p>\n\n<pre><code>With ActiveChart\n\n Set Serpo = .SeriesCollection(11).Points\n\n        'Save the number of points in chart to variable j\n        j = Serpo.Count\n\n        'Iterate though each point in current series\n        For i = 1 To j\n\n            'Enable data label for current chart point\n            Serpo(i).ApplyDataLabels Type:=xlShowValue\n\n            'Save cell reference to chart point\n            Serpo(i).DataLabel.Formula = \"=\" &amp; Range(\"SpRatings\").Cells(i).Address(ReferenceStyle:=xlR1C1)\n            Serpo(i).DataLabel.Font.ColorIndex = 2\n            Serpo(i).DataLabel.Position = xlLabelPositionInsideBase\n        Next\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1572440109, "post_id": 58625819, "comment_id": 103559265, "body": "Are you just reordering columns?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1572440162, "post_id": 58625819, "comment_id": 103559304, "body": "You might benefit from reading  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>."}, {"owner": {"reputation": 1, "user_id": 12297013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2880afd7f13ac9b399cdd13c7804c97f?s=128&d=identicon&r=PG&f=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/12297013/aaa"}, "edited": false, "score": 0, "creation_date": 1572441627, "post_id": 58625819, "comment_id": 103560187, "body": "Yes,i reorder an after copy.I want to copy without reordering for example columns c,a,h,f  everything except first 2 and last 1 row"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1572447271, "post_id": 58625819, "comment_id": 103563651, "body": "I&#39;m presuming you are new to VBA? Short of writing the code for you (which might not make too much sense), apart from what @P\u1d07\u029c suggested, it might be worth doing a course on VBA"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1572463037, "post_id": 58625819, "comment_id": 103571593, "body": "TL;DR - are you overwriting columns, i.e. all columns other than C,A,H,F and O resulting in these five columns left?"}], "answers": [{"tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1572544235, "creation_date": 1572544235, "answer_id": 58648840, "question_id": 58625819, "link": "https://stackoverflow.com/questions/58625819/how-to-copy-non-contiguous-columns-and-copy-everything-except-first-2-and-last-1/58648840#58648840", "title": "How to copy non contiguous columns and copy everything except first 2 and last 1 row without cut?Cutting takes long time when there is a lot of rows", "body": "<p><strong>Rearranging columns via <code>Application.Index()</code> function</strong></p>\n\n<p>This fast approach doesn't copy individual ranges, but uses arrays instead and demonstrates the advanced possibilities of the <a href=\"https://stackoverflow.com/questions/51688593/excel-vba-insert-new-first-column-in-datafield-array-without-loops-or-api-call/51714153#51714153\"><code>Application.Index()</code> function</a> allowing to <strong>rearrange</strong> the internal rows &amp; columns structure by one single code line (~> see section <code>[3]</code> in the procedure <code>Sub Rearrange()</code> below).</p>\n\n<p>This solution assumes that you want a new columns order consisting <em>only</em> of the five (original) data columns <code>C</code>,<code>A</code>,<code>H</code>,<code>F</code> and <code>O</code>, thus deleting all not included columns - but you can easily change the constant <code>NEWCOLUMNORDER</code> to <em>any</em> other combination, if you want to include further or <em>all</em> columns.</p>\n\n<p><strong>Main procedure <code>Rearrange</code></strong></p>\n\n<pre><code>\nSub ReArrange()\nWith Sheet1             ' using the CodeName of a sheet, see (Name) in Property Tool Window\n  Const NEWCOLUMNORDER As String = \"C,A,H,F,O\"\n  ' [0] Define data range as well as first and last row (checking e.g. column A:A)\n    Dim firstRow As Long, lastRow As Long\n    firstRow = 3: lastRow = .Range(\"A\" &amp; .Rows.count).End(xlUp).Row\n    Dim rng As Range\n    Set rng = .Range(\"A\" &amp; firstRow &amp; \":O\" &amp; lastRow - 1) ' start from 3rd row\n  ' [1] assign data values to (1-based) 2-dimensional variant array\n    Dim v As Variant\n    v = rng.Value2\n  ' [2] empty original data range (omitting last row)\n    rng.Resize(lastRow - firstRow).Clear\n  ' [3] Rearrange array rows &amp; columns\n    v = Application.Index(v, _\n        Evaluate(\"row(1:\" &amp; lastRow - firstRow &amp; \")\"), _\n        ColNos(NEWCOLUMNORDER))\n  ' [4] Write array back to range\n    rng.Resize(UBound(v), UBound(v, 2)) = v\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Note that I prefer to use a sheet's unique <code>CodeName</code> associated to your VBA project (~> see the code line <code>With Sheet1</code>) avoiding for instance issues after sheets being renamed via sheet tab (by default starting with identical Name as its <code>CodeName</code> in the VBE Window with <code>(Name)</code> in brackets!). Of Course it's possible to refer to e.g. <code>With ThisWorkbook.Worksheets(\"Sheet1\")</code> too.</p>\n\n<p><strong>Helper function <code>ColNos()</code></strong></p>\n\n<pre><code>Function ColNos(ByVal s, Optional ByVal DELIM$ = \",\") As Variant()\n'Purpose: return array of column numbers\n'Example: \"C,A,H,F,O\" ~~&gt; Array(3,1,8,6,15)\ns = Split(s, DELIM)         ' split string into individual column letters\nReDim tmp(0 To UBound(s))   ' define array's (1st) dimension via array indices\nDim i&amp;                      ' zero based items counter\nFor i = 0 To UBound(s)      ' loop through column letters, e.g. C,A,H,F,O\n    tmp(i) = Columns(s(i) &amp; \":\" &amp; s(i)).Column ' get column number\nNext i\nColNos = tmp                ' return temporary array items\nEnd Function\n\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12297013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2880afd7f13ac9b399cdd13c7804c97f?s=128&d=identicon&r=PG&f=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/12297013/aaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572544235, "creation_date": 1572439978, "last_edit_date": 1572441658, "question_id": 58625819, "link": "https://stackoverflow.com/questions/58625819/how-to-copy-non-contiguous-columns-and-copy-everything-except-first-2-and-last-1", "title": "How to copy non contiguous columns and copy everything except first 2 and last 1 row without cut?Cutting takes long time when there is a lot of rows", "body": "<p>How to copy non contiguous columns and copy everything except first 2 and last 1 row without cut?Cutting takes long time when there is a lot of rows.\nI reorder an after copy.I want to copy without reordering for example copy  columns c,a,h,f,o,l everything except first 2 and last 1 row</p>\n\n<pre><code>Columns(\"F:F\").Select\nSelection.Cut\nColumns(\"D:D\").Select\nSelection.Insert Shift:=xlToRight\nColumns(\"F:F\").Select\nSelection.Cut\nColumns(\"E:E\").Select\nSelection.Insert Shift:=xlToRight\nColumns(\"T:T\").Select\nSelection.Cut\nColumns(\"G:G\").Select\nSelection.Insert Shift:=xlToRight\nColumns(\"I:I\").Select\nSelection.Cut\nColumns(\"H:H\").Select\nSelection.Insert Shift:=xlToRight\nColumns(\"J:J\").Select\nSelection.Cut\nColumns(\"I:I\").Select\nSelection.Insert Shift:=xlToRight\nActiveWindow.SmallScroll Down:=69\nActiveWindow.LargeScroll Down:=-4\nRange(Range(\"C3\"), Range(\"I3\").End(xlDown).Offset(-1, 0)).Select\nSelection.Copy\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 3, "last_activity_date": 1572440366, "last_edit_date": 1592644375, "creation_date": 1572440366, "answer_id": 58625957, "question_id": 58625503, "link": "https://stackoverflow.com/questions/58625503/create-querydef-without-a-name-in-ms-access/58625957#58625957", "title": "Create QueryDef without a name in MS Access", "body": "<p>Yes.</p>\n<p>Read on: <a href=\"https://docs.microsoft.com/en-us/office/client-developer/access/desktop-database-reference/database-createquerydef-method-dao\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/client-developer/access/desktop-database-reference/database-createquerydef-method-dao</a></p>\n<blockquote>\n<p>You can create a <strong>temporary QueryDef</strong> by using a zero-length string for the name argument when you execute the CreateQueryDef method. You can also accomplish this by setting the Name property of a newly created QueryDef to a zero-length string (&quot;&quot;).</p>\n<p>Temporary QueryDef objects are useful if you want to repeatedly use dynamic SQL statements without having to create any new permanent objects in the QueryDefs collection.</p>\n</blockquote>\n<p>In particular, if you want to execute a parameterized query.</p>\n<p>Once there is no more reference set to it (e.g. a recordset based on it), a temporary querydef is automatically deleted (= ceases to exist).</p>\n"}], "owner": {"reputation": 772, "user_id": 3445378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7f48a9ba697fd1462d2852a044c29402?s=128&d=identicon&r=PG&f=1", "display_name": "testo", "link": "https://stackoverflow.com/users/3445378/testo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 58625957, "answer_count": 1, "score": -1, "last_activity_date": 1572440366, "creation_date": 1572438818, "question_id": 58625503, "link": "https://stackoverflow.com/questions/58625503/create-querydef-without-a-name-in-ms-access", "title": "Create QueryDef without a name in MS Access", "body": "<p>What does it exactly mean, when I am create a QueryDef without a name? Does it mean, that the query exists only as long as a reference to it is set?</p>\n\n<p><a href=\"https://i.stack.imgur.com/oYKIU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oYKIU.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "edited": false, "score": 0, "creation_date": 1572448968, "post_id": 58625389, "comment_id": 103564625, "body": "The simplest way to handle that situation is to write a separate mecro that erases all numbering. Then your macro always starts with a blank canvas."}, {"owner": {"reputation": 3, "user_id": 12297216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6678818c02750af8e3c44a8155398a7?s=128&d=identicon&r=PG&f=1", "display_name": "Bartek", "link": "https://stackoverflow.com/users/12297216/bartek"}, "reply_to_user": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "edited": false, "score": 0, "creation_date": 1572449666, "post_id": 58625389, "comment_id": 103565017, "body": "Ok but still I do not know how to do it if I don&#39;t know the number How select text range in string that has &quot;(&quot; &quot;)&quot;and unknown content between?"}], "answers": [{"tags": [], "owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "is_accepted": true, "score": 0, "last_activity_date": 1572454817, "creation_date": 1572454817, "answer_id": 58630386, "question_id": 58625389, "link": "https://stackoverflow.com/questions/58625389/adding-or-replacing-slide-numbering-in-selected-slides-titles/58630386#58630386", "title": "Adding or replacing slide numbering in selected slides&#39; titles", "body": "<p>Here's a macro to delete the existing numbering. This uses a regex pattern to find a sequence of a space, a bracket, any number, a backslash, any number and a closing bracket:</p>\n\n<pre><code>Sub DeleteNumbering()\n  Dim regX As Object\n  Dim oSlide As Slide\n  Dim oShape As Shape\n  Dim Foundb As Boolean\n  Dim NewText$\n\n  Set regX = CreateObject(\"vbscript.regexp\")\n  With regX\n    .Global = True\n    .Pattern = \" \\(\\d(/)\\d\\)\"\n  End With\n  ReplaceWord = \"\"\n\n  For Each oSlide In ActivePresentation.Slides\n    For Each oShape In oSlide.Shapes\n      If oShape.Type = msoPlaceholder Then\n        If (oShape.PlaceholderFormat.Type = ppPlaceholderCenterTitle _\n        Or oShape.PlaceholderFormat.Type = ppPlaceholderTitle) _\n        And oShape.TextFrame.HasText Then\n          Foundb = regX.Test(oShape.TextFrame.TextRange.Text)\n          If Foundb = True Then\n            NewText$ = regX.Replace(oShape.TextFrame.TextRange.Text, \"\")\n            oShape.TextFrame.TextRange.Text = NewText$\n          End If\n        End If\n      End If\n    Next oShape\n  Next oSlide\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12297216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6678818c02750af8e3c44a8155398a7?s=128&d=identicon&r=PG&f=1", "display_name": "Bartek", "link": "https://stackoverflow.com/users/12297216/bartek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 58630386, "answer_count": 1, "score": 0, "last_activity_date": 1572454817, "creation_date": 1572438499, "last_edit_date": 1572438575, "question_id": 58625389, "link": "https://stackoverflow.com/questions/58625389/adding-or-replacing-slide-numbering-in-selected-slides-titles", "title": "Adding or replacing slide numbering in selected slides&#39; titles", "body": "<p>I want to create macro that will add to the end of the selected slides' titles numbering in format (1/5).</p>\n\n<p>I have manage to write that part with adding numbering. I am not able to prepare vba for looking for and replacing existing numbering. It is needed when, for whatever reason, the slide order will be changed and needs to be updated.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub SlideNumbering()\n\nDim shp As shape\nDim sld As Slide\nDim SldAll As Single\nDim SldNr As Single\n\nSldAll = Application.ActiveWindow.Selection.SlideRange.Count\n\nSldNr = SldAll\n\nFor s = SldAll To 1 Step -1\n    ActivePresentation.Slides(s).Shapes.Title.TextFrame.TextRange.InsertAfter \" (\" &amp; SldNr &amp; \"/\" &amp; SldAll &amp; \")\"\n    SldNr = SldNr - 1\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1572438199, "post_id": 58625253, "comment_id": 103558139, "body": "What is your code?"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1572438565, "post_id": 58625253, "comment_id": 103558363, "body": "is there a code in the listbox_change event?"}, {"owner": {"reputation": 675, "user_id": 4153895, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ydo4BAzPBWE/AAAAAAAAAAI/AAAAAAAAHyM/ajbMvcgLeoU/photo.jpg?sz=128", "display_name": "Tarun Reddy", "link": "https://stackoverflow.com/users/4153895/tarun-reddy"}, "edited": false, "score": 0, "creation_date": 1572440304, "post_id": 58625253, "comment_id": 103559390, "body": "Screenshots in which code is there is added here. Thanks for the reply"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1572440464, "post_id": 58625253, "comment_id": 103559476, "body": "Put a breakpoint in your <code>Listbox1_click</code> event. It looks like it&#39;s being triggered."}], "owner": {"reputation": 675, "user_id": 4153895, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ydo4BAzPBWE/AAAAAAAAAAI/AAAAAAAAHyM/ajbMvcgLeoU/photo.jpg?sz=128", "display_name": "Tarun Reddy", "link": "https://stackoverflow.com/users/4153895/tarun-reddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572440255, "creation_date": 1572438031, "last_edit_date": 1572440255, "question_id": 58625253, "link": "https://stackoverflow.com/questions/58625253/macro-not-working-properly-when-assigned-to-graphic-icon-in-excel-but-its-worki", "title": "Macro not working properly when assigned to Graphic icon in excel. But its working when running through VBA IDE", "body": "<p><a href=\"https://i.stack.imgur.com/G3uGi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/G3uGi.png\" alt=\"enter image description here\"></a>I have macro which opens up the userform (which has textbox, listbox, clear button and confirm button). I assigned it to Graphic icon (Search icon). Whenever it is clicked - userform should show listbox with items and textbox with no text. But, here upon clicking the icon, by default I'm getting some values in textbox. This issue is not coming when I ran code from VBA IDE.</p>\n\n<p><a href=\"https://i.stack.imgur.com/TdAgf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TdAgf.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/Vnzf4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Vnzf4.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 305, "user_id": 10785732, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RIiEj6LHpXQ/AAAAAAAAAAI/AAAAAAAAABU/tYGkN03PEsA/photo.jpg?sz=128", "display_name": "Peter Ksenak", "link": "https://stackoverflow.com/users/10785732/peter-ksenak"}, "edited": false, "score": 0, "creation_date": 1572441700, "post_id": 58625250, "comment_id": 103560231, "body": "you are iterating all Paragraphs in para variable but in a loop you are not using para"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 8642714, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158585000200402/picture?type=large", "display_name": "Cat J", "link": "https://stackoverflow.com/users/8642714/cat-j"}, "edited": false, "score": 0, "creation_date": 1572444339, "post_id": 58626299, "comment_id": 103561794, "body": "Unfortunately they have not, and it would require the same kind of macro in order to search for said paragraphs to apply a style. It takes extracted text, rather than text I&#39;ve originated."}, {"owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "reply_to_user": {"reputation": 17, "user_id": 8642714, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158585000200402/picture?type=large", "display_name": "Cat J", "link": "https://stackoverflow.com/users/8642714/cat-j"}, "edited": false, "score": 0, "creation_date": 1572461157, "post_id": 58626299, "comment_id": 103570848, "body": "@CatJ if this has solved your issue please mark the answer as accepted. Doing so can help others who may have the same problem."}, {"owner": {"reputation": 17, "user_id": 8642714, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158585000200402/picture?type=large", "display_name": "Cat J", "link": "https://stackoverflow.com/users/8642714/cat-j"}, "edited": false, "score": 0, "creation_date": 1572519662, "post_id": 58626299, "comment_id": 103589224, "body": "I&#39;ve changed the MsgBox bit to MoveRight once and Delete once, but it&#39;s still doing that based on the number of bold paragraphs in the entire document, i.e. there are 6 bold paragraphs throughout the document, so when I run the macro, it moves the cursor right once then deletes 6 characters. How can I set it to move right once and delete one character after each instance of a bold paragraph? I feel like my problem is with the &quot;For Each&quot; bit, but I don&#39;t know what would replace that."}, {"owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "reply_to_user": {"reputation": 17, "user_id": 8642714, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158585000200402/picture?type=large", "display_name": "Cat J", "link": "https://stackoverflow.com/users/8642714/cat-j"}, "edited": false, "score": 0, "creation_date": 1572521416, "post_id": 58626299, "comment_id": 103590107, "body": "Your question was how to search for a bold paragraph, so this should really be a separate question. I will try to help though. What character follows each paragraph?"}, {"owner": {"reputation": 17, "user_id": 8642714, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158585000200402/picture?type=large", "display_name": "Cat J", "link": "https://stackoverflow.com/users/8642714/cat-j"}, "edited": false, "score": 0, "creation_date": 1572521910, "post_id": 58626299, "comment_id": 103590373, "body": "So basically I extract text from a PDF and output it to a Word doc and run a macro that replaces all paragraph markers with two paragraph markers, to insert a blank line between each paragraph. What I&#39;d like to do it then remove the extra blank line after entirely bold paragraphs (subheadings). I just used the MsgBox bit as my quick and easy way to see if the macro correctly located entirely bold paragraphs only, because it&#39;s not always easy to tell otherwise. I just want to delete the paragraph marker following a bold paragraph."}, {"owner": {"reputation": 17, "user_id": 8642714, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158585000200402/picture?type=large", "display_name": "Cat J", "link": "https://stackoverflow.com/users/8642714/cat-j"}, "edited": false, "score": 0, "creation_date": 1572524642, "post_id": 58626299, "comment_id": 103591833, "body": "That works perfectly, thank you! With a slight amendment to the code, could the same search and paragraph deletion work on selected text, i.e. from a certain point to the end of the document (Selection.EndKey Unit:=wdStory, Extend:=wdExtend)?"}, {"owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "reply_to_user": {"reputation": 17, "user_id": 8642714, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158585000200402/picture?type=large", "display_name": "Cat J", "link": "https://stackoverflow.com/users/8642714/cat-j"}, "edited": false, "score": 0, "creation_date": 1572525194, "post_id": 58626299, "comment_id": 103592158, "body": "Good, please mark the answer as accepted. For the additional item you need to ask a separate question and describe clearly what it is that you are trying to do."}], "tags": [], "owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "is_accepted": true, "score": 1, "last_activity_date": 1572522204, "last_edit_date": 1572522204, "creation_date": 1572441557, "answer_id": 58626299, "question_id": 58625250, "link": "https://stackoverflow.com/questions/58625250/how-to-search-for-entirely-bold-paragraphs/58626299#58626299", "title": "How to search for entirely bold paragraphs?", "body": "<p>As your code doesn't select anything <code>Selection.Font.Bold</code> does not relate to anything in the loop. By simply changing <code>Selection</code> to <code>para.Range</code> you will find only those paragraphs you are looking for.</p>\n\n<pre><code>Dim para As Paragraph\n\nFor Each para In ActiveDocument.Paragraphs\n    If para.Range.Font.Bold = True Then para.Next.Range.Delete\nNext para\n</code></pre>\n\n<p>The paragraph following can be accessed simply by using the Next property.</p>\n\n<p>If the headings have been formatted using a style you could find them simply by looking for all instances of that style.</p>\n"}], "owner": {"reputation": 17, "user_id": 8642714, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158585000200402/picture?type=large", "display_name": "Cat J", "link": "https://stackoverflow.com/users/8642714/cat-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 58626299, "answer_count": 1, "score": 0, "last_activity_date": 1582095757, "creation_date": 1572438028, "last_edit_date": 1582095757, "question_id": 58625250, "link": "https://stackoverflow.com/questions/58625250/how-to-search-for-entirely-bold-paragraphs", "title": "How to search for entirely bold paragraphs?", "body": "<p>I need to be able to find paragraphs that are wholly bold (such as a subheading), but I've been struggling to figure it out or find much help online. I've seen similar questions but the responses are too complicated for me to really know what I'm replicating, despite trying to use parts that seem relevant.</p>\n\n<p>My end goal is to, after finding a wholly bold paragraph, delete the character immediately following it (usually an empty line).</p>\n\n<p>So far, this is my code, using MsgBox as my quick easy test to see if the search works correctly:</p>\n\n<pre><code>Dim para As Paragraph\n\nFor Each para In ActiveDocument.Paragraphs\n    If Selection.Font.Bond = True Then MsgBox \"All Bold\"\n    Else: Next para\n</code></pre>\n\n<p>What this macro does is bring up a MsgBox saying \"All Bold\" for each paragraph in the document (as in, if there are 50 paragraphs it brings the MsgBox up 50 times), rather than check each paragraph then bring up a MsgBox IF it's entirely bold. Ideally, in my actual document of about 50 paragraphs, only the 3 headings would prompt the MsgBox to appear.</p>\n"}, {"tags": ["vba", "email", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 9735645, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aVf1p.png?s=128&g=1", "display_name": "Tracer", "link": "https://stackoverflow.com/users/9735645/tracer"}, "edited": false, "score": 0, "creation_date": 1572513915, "post_id": 58630677, "comment_id": 103586002, "body": "Thank you for the explanation. However, if <code>PR_SECURITY_FLAGS</code> is only set for outgoing mails, why could I read it on incoming Mails too? Is Outlook it setting it afterwards by itself? Most of my test-mails were treated correctly even encryption.  Your &quot;Redemption&quot; looks really interesting but I think I cannot use it for my company."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 43, "user_id": 9735645, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aVf1p.png?s=128&g=1", "display_name": "Tracer", "link": "https://stackoverflow.com/users/9735645/tracer"}, "edited": false, "score": 0, "creation_date": 1572530511, "post_id": 58630677, "comment_id": 103595159, "body": "PR_SECURITY_FLAGS is not a a property actually set on the message itself and exposed by the underlying store provider, it is a fake property furnished by the Outlook Object Model and only available through the PropertyAccessor and the fake IMessage object exposed by the MailItem.MAPIOBJECT property."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 2, "last_activity_date": 1572455986, "creation_date": 1572455986, "answer_id": 58630677, "question_id": 58624896, "link": "https://stackoverflow.com/questions/58624896/how-can-i-check-if-a-mail-has-a-valid-digital-signature/58630677#58630677", "title": "How can I check if a mail has a valid digital signature?", "body": "<p><code>PR_SECURITY_FLAGS</code> is only set on the outgoing messages to tell Outlook to encrypt the message when it is actually sent. It will not be present on the incoming messages - take a look at the messages with <a href=\"http://www.dimastr.com/outspy\" rel=\"nofollow noreferrer\">OutlookSpy</a> (click IMessage button).</p>\n\n<p>For the incoming messages, you'd think you could check the <code>MessageClass</code> property and see if it is <code>\"IPM.Note.SMIME.MultipartSigned\"</code>, but OOM tries real hard to represent signed and encrypted messages as the regular <code>IPM.Note</code> messages. You would have to either bypass OOM completely and use Extended MAPI (C++ or Delphi only) or you can use <a href=\"http://www.dimastr.com/redemption\" rel=\"nofollow noreferrer\">Redemption</a> (any language, including VBA). Something like the following would let you check the real message class:</p>\n\n<pre><code>set Session = CreateObject(\"Redemption.RDOSession\")\nSession.MAPIOBJECT = Application.Session.MAPIOBJECT\nset SourceMsg = Session.GetRDOObjectFromOutlookObject(MAIL_ITEM , true)\nMsgBox SourceMsg.MessageClass\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 9735645, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aVf1p.png?s=128&g=1", "display_name": "Tracer", "link": "https://stackoverflow.com/users/9735645/tracer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 0, "accepted_answer_id": 58630677, "answer_count": 1, "score": 2, "last_activity_date": 1576267928, "creation_date": 1572436723, "last_edit_date": 1576267928, "question_id": 58624896, "link": "https://stackoverflow.com/questions/58624896/how-can-i-check-if-a-mail-has-a-valid-digital-signature", "title": "How can I check if a mail has a valid digital signature?", "body": "<p>I need to validate if an incoming mailitem is signed in Outlook 2010.</p>\n\n<p>If a mailitem is not signed, it should be moved into a \"NOSIG\"-folder. </p>\n\n<p>While researching, I found (and sort of confirmed) that Outlook 2010 modifies the MessageClass to \"IPM.Note\", so I tried to use the PropertyAccessor and read the Security-Flags. </p>\n\n<p>Here's my code so far: </p>\n\n<pre><code>Sub TRCR(MAIL_ITEM As MailItem)\n\n    Dim PR_SECURITY_FLAGS As Integer\n\n    On Error Resume Next\n\n    'Security-Flags: 0=none, 1=encrypted, 2=signed, 3=both\n    PR_SECURITY_FLAGS = MAIL_ITEM.PropertyAccessor.GetProperty(\"http://schemas.microsoft.com/mapi/proptag/0x6E010003\")\n\n    'Modulo because, sometimes the flags value is added to a multiple of 32... &lt;unfortunately I lost the source&gt;\n    If (PR_SECURITY_FLAGS &gt; 32) Then PR_SECURITY_FLAGS = PR_SECURITY_FLAGS Mod 32\n\n    If PR_SECURITY_FLAGS = 2 Or PR_SECURITY_FLAGS = 3 Then\n        'Do all that fancy stuff I want to with that signed Mail\n    Else\n        MAIL_ITEM.Move Application.GetNamespace(\"MAPI\").GetDefaultFolder(olFolderInbox).Folders.Item(\"NOSIG\")\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>I use an Outlook rule to run that script on every incoming E-Mail. </p>\n\n<p>It sometimes moves signed mails to the NOSIG folder. </p>\n\n<p>In those cases, the PR_SECURITY_FLAGS were both at 0, before and after that Modulo-Codeline. So being 0, the script worked right but since the mail was signed, the flag shouldn't have been 0 but 2. </p>\n\n<p>I resent the same signed mail dozens of times, just to always see the same thing happening. Most of them are treated correctly while a few always appeared to show the flag 0 instead of 2 while they were signed. </p>\n\n<p>I tried to pause the script for 1-5 seconds with <code>Application.Wait Now + TimeSerial(0, 0, 1)</code> thinking that the script may be too fast for the PropertyAccessor or something, but the pause didn't work. (I couldn't \"feel\" that five seconds delay while processing multiple mails.) </p>\n\n<p>I start to think that it is an Outlook problem (maybe manipulating Security-Flags similar to MessageClass but not every time).</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 3, "creation_date": 1572435322, "post_id": 58624458, "comment_id": 103556617, "body": "Suggest you don&#39;t have a worksheet named &quot;Sheet4&quot; in the active workbook. (You should get in the habit of declaring all variables.)"}, {"owner": {"reputation": 228, "user_id": 4216021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dab71f9dbaf2788463adc85da03061ea?s=128&d=identicon&r=PG&f=1", "display_name": "Bilal", "link": "https://stackoverflow.com/users/4216021/bilal"}, "edited": false, "score": 0, "creation_date": 1572435527, "post_id": 58624458, "comment_id": 103556727, "body": "Remove &quot;Set&quot; from line Set NoMonths = Worksheets(&quot;Sheet4&quot;).Range(&quot;C13&quot;) as you don&#39;t seem to be using NoMonths as Range Object."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1572439068, "post_id": 58624458, "comment_id": 103558671, "body": "My 1st thought is you don&#39;t have a sheet named &quot;Sheet4&quot;, but now that I have looked at your code more closely. It appears you are using NoMonths as a variant, as suggested earlier, you don&#39;t set a variant."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 2, "creation_date": 1572439266, "post_id": 58624458, "comment_id": 103558783, "body": "@Davesexcel, If <code>&quot;Sheet4&quot;</code> would be present in the current project, VBA would create a <code>Variant&#47;Object&#47;Range</code> type variable for <code>NoMonths</code>. The code would have worked (at least past that specific line generating the error)"}], "answers": [{"comments": [{"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 0, "creation_date": 1572453540, "post_id": 58626057, "comment_id": 103567281, "body": "As it is not being used as a range object, would it be better for NoMonths be an Integer? e.g. <code>Dim NoMonths as Integer</code> and <code>NoMonths = ThisWorkbook.Worksheets(&quot;Sheet4&quot;).Range(&quot;C13&quot;).Value</code>?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 0, "creation_date": 1572453654, "post_id": 58626057, "comment_id": 103567344, "body": "@Gravitate Yes, you can do that. But I recommend <code>Long</code> as there is no benefit in using <code>Integer</code> over <code>Long</code>."}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 0, "creation_date": 1572454060, "post_id": 58626057, "comment_id": 103567532, "body": "Hmm... I&#39;ve never really thought about that. Integer is just my go to numeric type (unless I specifically need larger values). Thanks! Presumably, integer does use less memory? Just not enough to make any noticeable difference?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 0, "creation_date": 1572506720, "post_id": 58626057, "comment_id": 103583073, "body": "@Gravitate Actually using less memory <i>would</i> be a reason to prefer <code>Integer</code> (even if it would only be a tiny benefit is would be a benefit). But in VBA it does not use less memory it uses the exactly same amount of memory as a <code>Long</code> does but at the same time it still cannot take as large numbers as <code>Long</code>. So there is only disadvantages. I recommend to read <a href=\"https://stackoverflow.com/questions/26409117/why-use-integer-instead-of-long/26409520#26409520\">this</a> if you are interested why. \u2022 Note this is valid for VBA and does not apply to other coding languages."}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 0, "creation_date": 1572512232, "post_id": 58626057, "comment_id": 103585227, "body": "Thanks for the link. I will take a look."}, {"owner": {"reputation": 17, "user_id": 12274514, "user_type": "registered", "profile_image": "https://graph.facebook.com/3052302761463574/picture?type=large", "display_name": "Charles Ewing", "link": "https://stackoverflow.com/users/12274514/charles-ewing"}, "edited": false, "score": 0, "creation_date": 1572619336, "post_id": 58626057, "comment_id": 103625323, "body": "Thank you, this has been very helpful. I have ran into another issue though when redefining the VectorToSum to be <code>ReDim VectorToSum(0 To q - 1)</code>  (an empty vector of lengh q) I am getting the same error, why may this be. @P\u1d07\u029c"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 17, "user_id": 12274514, "user_type": "registered", "profile_image": "https://graph.facebook.com/3052302761463574/picture?type=large", "display_name": "Charles Ewing", "link": "https://stackoverflow.com/users/12274514/charles-ewing"}, "edited": false, "score": 0, "creation_date": 1572628922, "post_id": 58626057, "comment_id": 103629850, "body": "@CharlesEwing make sure <code>q - 1</code> is <code>&gt; 0</code> if it is <code>0</code> or negative  the array cannot be defined. Check which value <code>q</code> has in case of error."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 2, "last_activity_date": 1572442169, "last_edit_date": 1572442169, "creation_date": 1572440729, "answer_id": 58626057, "question_id": 58624458, "link": "https://stackoverflow.com/questions/58624458/how-to-fix-subscript-out-of-range-run-time-error-9/58626057#58626057", "title": "How to fix: &#39;subscript out of range&#39;, Run time error &#39;9&#39;", "body": "<blockquote>\n  <p>Subscript out of range</p>\n</blockquote>\n\n<p>means that the <code>Worksheets()</code> property cannot find a worksheet named <code>Sheet4</code>.</p>\n\n<ol>\n<li><p>Make sure the sheet name has no additional spaces before, after or between <code>Sheet4</code>. In case of any doubt rename it to ensure correct naming of the sheet. </p></li>\n<li><p>In case of working with multiple workbooks (or in general following a good practice) specify in which workbook your worksheet is by using:</p>\n\n<pre><code>Set NoMonths = ThisWorkbook.Worksheets(\"Sheet4\").Range(\"C13\") 'ThisWorkbook is the workbook this code is in\n</code></pre></li>\n</ol>\n\n<hr>\n\n<p>Additionally I recommend to use <code>Option Explicit</code> and declare all your variables proplery before you use them. For Example:</p>\n\n<pre><code>Dim NoMonths As Range\nSet NoMonths = ThisWorkbook.Worksheets(\"Sheet4\").Range(\"C13\") \n</code></pre>\n\n<p>Further if you use <code>Cells(48, i).Value = 0</code> you don't define in which workbook this cell is. So Excel makes a guess and it might fail. <strong>Always</strong> specify a workbook/worksheet for all <code>Range</code>, <code>Cells</code>, <code>Rows</code>, <code>Columns</code> objects.</p>\n\n<pre><code>Thisworkbook.Worksheets(\"Sheet13\").Cells(48, i).Value = 0\n</code></pre>\n\n<p>Better approach is to set the worksheets to a variable to make your code short and clean and re-use that variable.</p>\n\n<pre><code>Dim ws As Worksheet\nSet ws = Thisworkbook.Worksheets(\"Sheet13\")\n\nws.Cells(48, i).Value = 0\n</code></pre>\n\n<p>Finally I highly recommend to use meaningful variable names and worksheet names. <code>Sheet13</code> and <code>Sheet4</code> are pretty bad choices for names. Choosing a good name should be the very fist thing you do. Because if you do that last you will have to change it everywhere in your code.</p>\n\n<hr>\n\n<p>So in the end your code should be something like this:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub DefferedRev()\n    Dim NoMonths As Range\n    Set NoMonths = ThisWorkbook.Worksheets(\"Sheet4\").Range(\"C13\")\n\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Sheet13\")\n\n\n    If ws.Range(\"B40\").Value = ws.Range(\"C82\").Value Then\n        'For i = 5 To 7\n        '    ws.Cells(48, i).Value = 0\n        'Next i\n\n        'this loop can be written at once (faster!)\n        'replace it with the following line\n        ws.Range(ws.Cells(48, 5), ws.Cells(48, 7)).Value = 0\n    Else\n        Dim i As Long\n        For i = 5 To 7\n            Dim q As Long\n            q = (i Mod NoMonths) - 5\n\n            Dim VectorToSum() As String\n            ReDim VectorToSum(1 To q)\n\n            Dim w As Long\n            For w = 1 To q\n                VectorToSum(w) = (ws.Cells(38, i).Value * ws.Cells(7, i).Value) / (NoMonths * NoMonths - w)\n            Next w\n\n            ws.Cells(48, i).Value = Application.WorksheetFunction.Sum(VectorToSum)\n        Next i\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 12274514, "user_type": "registered", "profile_image": "https://graph.facebook.com/3052302761463574/picture?type=large", "display_name": "Charles Ewing", "link": "https://stackoverflow.com/users/12274514/charles-ewing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572442169, "creation_date": 1572435171, "last_edit_date": 1572440292, "question_id": 58624458, "link": "https://stackoverflow.com/questions/58624458/how-to-fix-subscript-out-of-range-run-time-error-9", "title": "How to fix: &#39;subscript out of range&#39;, Run time error &#39;9&#39;", "body": "<p>New to VBA, is issue seems to be the following line,</p>\n\n<pre><code>Set NoMonths = Worksheets(\"Sheet4\").Range(\"C13\")\n</code></pre>\n\n<p>Unsure why as in cell c13 on sheet4 there contains a number value for example 5.</p>\n\n<p>Can someone help please.</p>\n\n<p>Full code:</p>\n\n<pre><code>Sub DefferedRev()\n\n    Set NoMonths = Worksheets(\"Sheet4\").Range(\"C13\")\n    Dim i As Integer\n    Dim q As Integer\n\n\n    If Worksheets(\"Sheet13\").Range(\"B40\") = Worksheets(\"Sheet13\").Range(\"C82\") Then\n        For i = 5 To 7\n            Cells(48, i).Value = 0\n        Next i\n    Else\n        For i = 5 To 7\n            q = (i Mod NoMonths) - 5\n            Dim VectorToSum() As String\n            ReDim VectorToSum(1 To q)\n            For w = 1 To q\n                VectorToSum(w) = (Worksheets(\"Sheet13\").Cells(38, i).Value * Worksheets(\"Sheet13\").Cells(7, i).Value) / (NoMonths * NoMonths - w)\n            Next w\n            ValueIn = Application.WorksheetFunction.Sum(VectorToSum)\n\n            Cells(48, i).Value = ValueIn\n        Next i\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1572434458, "post_id": 58624135, "comment_id": 103556201, "body": "It cannot be done with a forumla. But <a href=\"https://support.office.com/en-us/article/use-autofilter-to-filter-your-data-7d87d63e-ebd0-424b-8106-e2ab61133d92?ui=en-US&amp;rs=en-US&amp;ad=US\" rel=\"nofollow noreferrer\">you can use a simple filter (autofilter)</a> and filter only the data that has data in columns A, B, D and E. That&#39;s easily done with filter tools provided in the &quot;Data&quot; tab of the ribbon. If you need to do it with VBA record a macro. \u2022 If you get stuck or errors come back with your code and ask a question to it."}, {"owner": {"reputation": 15, "user_id": 11917310, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214942871790138/picture?type=large", "display_name": "ciuncky", "link": "https://stackoverflow.com/users/11917310/ciuncky"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1572434672, "post_id": 58624135, "comment_id": 103556300, "body": "I can probably do it with autofilter, but then i&#39;d need to go back an remove the filter after copying the data to the new sheet, which isn&#39;t ideal. that still leaves me with the issue of how to paste at the bottom of an expanding table via VBA?"}, {"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1572437178, "post_id": 58624135, "comment_id": 103557572, "body": "By a formula, no way. Go by macro. Just to not to make it hard for you... use the Macro Recorder in order to do what you are trying. With your knowledge, try to reduce/custom the code as much as you can and, when you get stuck, we will be glad to help you."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11917310, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214942871790138/picture?type=large", "display_name": "ciuncky", "link": "https://stackoverflow.com/users/11917310/ciuncky"}, "edited": false, "score": 0, "creation_date": 1572438595, "post_id": 58625254, "comment_id": 103558399, "body": "Thanks so much Zac, this seems to do the trick and i tested adding more lines and works fine. By the looks of it it copies everything, so might become a bit slow once i get to 5-800 lines, but not to worry for now.  LE: I added the blow code  <code>Rows(&quot;2:2&quot;).Select     Selection.AutoFilter</code>  To deselect the filter at the end so Sheet 1 displays full info again. Out of curiosity, what does your Clear Objects part do?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 15, "user_id": 11917310, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214942871790138/picture?type=large", "display_name": "ciuncky", "link": "https://stackoverflow.com/users/11917310/ciuncky"}, "edited": false, "score": 0, "creation_date": 1572439224, "post_id": 58625254, "comment_id": 103558755, "body": "@ciuncky It doesn&#39;t change anything. Because the variables are declared within the scope of your procedure, the variables are cleared with <code>End Sub</code> automatically anyway. You don&#39;t need these 2 lines and can remove them savely to keep your code cleaner."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1572440679, "post_id": 58625254, "comment_id": 103559584, "body": "As @P\u1d07\u029c said, <b>Clear objects</b> bit is not needed.. old habits really. All it does is clear the objects from the memory but as mentioned, once the UDF completes, they are cleared anyway so you can eliminate that part of the code and it wont make any difference"}], "tags": [], "owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "is_accepted": true, "score": 0, "last_activity_date": 1572438033, "creation_date": 1572438033, "answer_id": 58625254, "question_id": 58624135, "link": "https://stackoverflow.com/questions/58624135/how-to-copy-specific-parts-of-a-table-from-a-sheet-to-another/58625254#58625254", "title": "How to copy specific parts of a table from a sheet to another", "body": "<p>As suggested, this cannot be done with formulas. There are different ways to achieve this.. below is one approach:</p>\n\n<pre><code>Sub CopyFilteredRows()\n    Dim oSourceSheet As Worksheet: Set oSourceSheet = ThisWorkbook.Worksheets(\"Sheet3\")             ' Set your source sheet here\n    Dim oRng As Range: Set oRng = oSourceSheet.Range(\"A2:E\" &amp; oSourceSheet.Range(\"C\" &amp; oSourceSheet.Rows.Count).End(xlUp).Row)\n\n    ' Set filter on column B\n    oRng.AutoFilter\n    oRng.AutoFilter 2, \"&lt;&gt;\"\n\n    ' Copy to specified sheet\n    oRng.SpecialCells(xlCellTypeVisible).EntireRow.Copy ThisWorkbook.Worksheets(\"Sheet4\").Range(\"A2\")   ' Change your destination sheet here\n\n    ' Clear objects\n    Set oRng = Nothing\n    Set oSourceSheet = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Paste the above UDF in a Module and then run it whenever you want to perform the copy. I suspect you would have to modify it a bit so that you can cater for your particular scenario but it should give you a start</p>\n\n<p><strong>NOTE:</strong> I wrote this as this was easy and quick to do. Generally speaking, as SO is not a code writing service, you will have to make an attempt for us to help you</p>\n"}], "owner": {"reputation": 15, "user_id": 11917310, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214942871790138/picture?type=large", "display_name": "ciuncky", "link": "https://stackoverflow.com/users/11917310/ciuncky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 0, "accepted_answer_id": 58625254, "answer_count": 1, "score": 0, "last_activity_date": 1572438033, "creation_date": 1572434055, "last_edit_date": 1572434249, "question_id": 58624135, "link": "https://stackoverflow.com/questions/58624135/how-to-copy-specific-parts-of-a-table-from-a-sheet-to-another", "title": "How to copy specific parts of a table from a sheet to another", "body": "<p>I'm trying to get some details copied in Excel from Sheet 1 columns 1-5 to Sheet 2 columns 1-4, but only for lines that include text or values on sheet one under a specific column (in this case, Column 2). There are other columns in between, so I need to be able to use exact columns rather than A:D for example. \nExample of what I'm trying to achieve:</p>\n\n<p><a href=\"https://i.stack.imgur.com/qtoZ8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qtoZ8.png\" alt=\"Excel screenshot of dummy data\"></a>  </p>\n\n<p>I have tried using a simple IF function with A:A&lt;>\"\" so it would include any rows that have any data in them, however this does not seem to copy as I need and occasionally based on my attempts i also get circular reference errors.  Additionally, I\u2019m not sure how to make sure this gets pasted at the bottom of a table that will expand with each addition. </p>\n\n<p>I realize a probably easier option would be to simply copy Sheet 1 entirely and use a filter on row 1 to deselect Blanks on A:A, but the sheet has so much more info that it would be a waste, and additionally info is constantly added so I need something scale-able. It also occurred to me now that by doing this i would include info from the \"header\" and \"footer\", basically a frozen pane - which I do not need. </p>\n\n<p>Could this be done via a simple function, or would it require a Macro?</p>\n\n<p>Please keep in mind I'm rubbish at programming, just trying to make my life easier and learn as I go. A lot of excel forums help but still I'm no coder. I can understand to a pretty big degree what the code does and can adjust accordingly though :)</p>\n"}, {"tags": ["excel", "vba", "excel-2010"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1572434741, "post_id": 58624106, "comment_id": 103556329, "body": "What&#39;s that last line doing? Why don&#39;t you just insert the new lines at the bottom of sheet 1 and then sort by a/c no at the end?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1572434879, "post_id": 58624106, "comment_id": 103556399, "body": "Of if sheet 2 always has more than or the same as sheet 1 just copy the former?"}, {"owner": {"reputation": 181, "user_id": 5384790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c01c186d4806bec631e39c5335f2ba80?s=128&d=identicon&r=PG&f=1", "display_name": "caaax", "link": "https://stackoverflow.com/users/5384790/caaax"}, "edited": false, "score": 0, "creation_date": 1572434996, "post_id": 58624106, "comment_id": 103556449, "body": "Sounds like you are making this more difficult than necessary - if sheet2 has more rows than sheet1, copy the who column from sheet 2 and replace column 1 in sheet 1."}, {"owner": {"reputation": 382, "user_id": 8700614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yVDlB.png?s=128&g=1", "display_name": "Nkoro Joseph Ahamefula", "link": "https://stackoverflow.com/users/8700614/nkoro-joseph-ahamefula"}, "edited": false, "score": 0, "creation_date": 1572435409, "post_id": 58624106, "comment_id": 103556660, "body": "The sheet1 is linked to some other sheets and the position of these values are needed.( i dont know how to express it by typing).  sheet1 normaly has some old account no(s) that are no longer needed in sheet2 but are needed in the some other sheets."}], "answers": [{"comments": [{"owner": {"reputation": 382, "user_id": 8700614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yVDlB.png?s=128&g=1", "display_name": "Nkoro Joseph Ahamefula", "link": "https://stackoverflow.com/users/8700614/nkoro-joseph-ahamefula"}, "edited": false, "score": 0, "creation_date": 1572437554, "post_id": 58624557, "comment_id": 103557779, "body": "How do i copy and overwrite the values."}, {"owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "reply_to_user": {"reputation": 382, "user_id": 8700614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yVDlB.png?s=128&g=1", "display_name": "Nkoro Joseph Ahamefula", "link": "https://stackoverflow.com/users/8700614/nkoro-joseph-ahamefula"}, "edited": false, "score": 0, "creation_date": 1572438589, "post_id": 58624557, "comment_id": 103558393, "body": "<code>Worksheets(&quot;Sheet2&quot;).Range(&quot;A1:B200&quot;).Copy: Worksheets(&quot;Sheet1&quot;).Range(&quot;A1:B200&quot;).PasteSpecial xlPasteValues</code>, for example. Added it to the answer, @josephnkoro."}, {"owner": {"reputation": 382, "user_id": 8700614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yVDlB.png?s=128&g=1", "display_name": "Nkoro Joseph Ahamefula", "link": "https://stackoverflow.com/users/8700614/nkoro-joseph-ahamefula"}, "edited": false, "score": 0, "creation_date": 1572439833, "post_id": 58624557, "comment_id": 103559097, "body": "Thanks, this worked for updating the sheet1 with the newly found accountNOs in sheet2. I will like to update the values for the already existing accountNos in sheet1, will this work?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1572442960, "post_id": 58624557, "comment_id": 103560966, "body": "I think @AhmedAbdelhameed has answered your question. If you want more help, please start a new question. Also, don&#39;t forget to accept this as your answer as it matches the requirements of your original question"}], "tags": [], "owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "is_accepted": false, "score": 1, "last_activity_date": 1572438567, "last_edit_date": 1572438567, "creation_date": 1572435565, "answer_id": 58624557, "question_id": 58624106, "link": "https://stackoverflow.com/questions/58624106/compare-two-columns-in-excel-and-insert-a-new-row/58624557#58624557", "title": "Compare two columns in Excel and insert a new row", "body": "<p>If the account numbers are actually in order in both sheets, you don't really need to use <code>CountIf</code>. You can simply iterate the rows of <code>Sheet2</code> and compare their account number to the account numbers in <code>Sheet1</code> at the same position. Then you insert a row in that position if you don't find a match in <code>Sheet1</code>.</p>\n\n<p>Try something like this:</p>\n\n<pre><code>Sub Test()\n    Dim sourceCell As Range, targetCell As Range\n    Dim i As Integer\n    For i = 2 To 200\n        Set sourceCell = Worksheets(\"Sheet2\").Range(\"A\" &amp; i)\n        Set targetCell = Worksheets(\"Sheet1\").Range(\"A\" &amp; i)\n        If targetCell.Value &lt;&gt; sourceCell.Value Then\n            sourceCell.EntireRow.Copy\n            targetCell.EntireRow.Insert\n            targetCell.Offset(-1, 0).EntireRow.PasteSpecial xlPasteValues\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p><strong>Note:</strong> This assumes that you do not want to overwrite the existing values in Sheet1, otherwise, you can just copy all the rows of Sheet2 and paste them in Sheet1. For example:</p>\n\n<pre><code>Worksheets(\"Sheet2\").Range(\"A1:B200\").Copy\nWorksheets(\"Sheet1\").Range(\"A1:B200\").PasteSpecial xlPasteValues\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "is_accepted": false, "score": 0, "last_activity_date": 1572437828, "creation_date": 1572437828, "answer_id": 58625206, "question_id": 58624106, "link": "https://stackoverflow.com/questions/58624106/compare-two-columns-in-excel-and-insert-a-new-row/58625206#58625206", "title": "Compare two columns in Excel and insert a new row", "body": "<p>If you want to stay closer to your original code, the method you're trying isn't impossible. All you need is to copy the row from the second sheet, and insert it on the same row you copied it from:</p>\n\n<pre><code>Sub match()\nDim rngCell As Range\nDim matchRow As Integer, nextcol As Integer\n\nFor Each rngCell In Worksheets(\"Sheet2\").Range(\"A2:A200\")\n    If rngCell &lt;&gt; \"\" Then\n        If WorksheetFunction.CountIf(Worksheets(\"Sheet1\").Range(\"A2:A200\"), rngCell) = 0 Then\n            Sheet2.Range(Sheet2.Cells(rngCell.Row, 1), Sheet2.Cells(rngCell.Row, Columns.Count).End(xlToLeft)).Copy\n            Sheet1.Range(\"A\" &amp; rngCell.Row).Insert\n            End If\n    End If\nNext\nEnd Sub\n</code></pre>\n\n<p>Note I have put a column counter in the copy amount, this prevents you from copying the entire row, which might speed up your code if you have many hits.</p>\n"}], "owner": {"reputation": 382, "user_id": 8700614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yVDlB.png?s=128&g=1", "display_name": "Nkoro Joseph Ahamefula", "link": "https://stackoverflow.com/users/8700614/nkoro-joseph-ahamefula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1572444846, "creation_date": 1572433979, "last_edit_date": 1572444846, "question_id": 58624106, "link": "https://stackoverflow.com/questions/58624106/compare-two-columns-in-excel-and-insert-a-new-row", "title": "Compare two columns in Excel and insert a new row", "body": "<p>I am having good (bad) time with Excel vba.</p>\n\n<p>I have two sheets in a workbook- sheet1 and sheet2. </p>\n\n<p>Sheet 1</p>\n\n<pre><code>AccountNo   Account Name    \n110101      Imprest        \n110102      abs        \n110104      abs - Call  \n110105      abc-MANAGED \n110109      bda - Dollar    \n110201      jhk - Dollar    \n</code></pre>\n\n<p>Sheet 2</p>\n\n<pre><code>AccountNo   Account Name    \n110101      Imprest        \n110102      abs\n110103      bas \n110104      abs - Call  \n110105      abc-MANAGED \n110109      bda - Dollar    \n110201      jhk - Dollar    \n</code></pre>\n\n<p>I want to compare row the AccountNo column to find out the new accountNo that has been added to sheet2 but not in sheet1. \nIf the AccountNO is found, I want to insert it into sheet1 and it must be inserted into the best position in sheet1 because the account numbers are arranged serially. \nExample is the 110103 accountNO, i want to insert the entire row after 110102 account no in sheet1.</p>\n\n<pre><code>Dim rngCell As Range\nDim matchRow\nFor Each rngCell In Worksheets(\"Sheet2\").Range(\"A2:A200\")\n    If WorksheetFunction.CountIf(Worksheets(\"Sheet1\").Range(\"A2:A200\"), rngCell) = 0 Then\n        ' Range(\"K\" &amp; Rows.Count).End(xlUp).Offset(1) = rngCell\n        matchRow = rngCell.Row\n        Rows(matchRow &amp; \":\" &amp; matchRow).Select\n        rngCell.EntireRow.Copy\n        Range(\"K\" &amp; Rows.Count).PasteSpecial xlPasteValues\n    End If\nNext\n</code></pre>\n\n<p>The code seem not to help. only able to identify the new accountNOs.</p>\n"}, {"tags": ["excel", "vba", "error-handling", "messagebox"], "comments": [{"owner": {"reputation": 13431, "user_id": 2169762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nns8w.png?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2169762/martin"}, "edited": false, "score": 0, "creation_date": 1572433935, "post_id": 58624059, "comment_id": 103555915, "body": "This could be a problem with your other code.  Could you include it for completeness please?"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 2, "creation_date": 1572433939, "post_id": 58624059, "comment_id": 103555918, "body": "Your code is likely just breaking somewhere else. Comment out the <code>On Error GoTo Errmsg</code> line and see where it breaks exactly"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1572434046, "post_id": 58624059, "comment_id": 103555978, "body": "Alternatively you could add properties of the <code>Err</code> object to the msgbox&#39;s contents, such as <code>Err.Description</code>. This should give you an idea of the type of error. Right now, a message for one type of error will be shown for all possible error types your code could run into."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1572434835, "post_id": 58624059, "comment_id": 103556378, "body": "Use the <code>On Error Goto Errmsg</code> <i>only</i> around the statement for which you want to catch the error, and reset it after the statement with <code>On Error Goto 0</code>"}, {"owner": {"reputation": 79, "user_id": 7006770, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a822458971786175f897d8d1b3e33470?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7006770/tom"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1572436170, "post_id": 58624059, "comment_id": 103557030, "body": "@TimStack Thanks, I&#39;m an idiot! It was a small error in the code right before the Exit Sub and error message which is why I thought it might be running through the code fine."}], "owner": {"reputation": 79, "user_id": 7006770, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a822458971786175f897d8d1b3e33470?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7006770/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572433873, "creation_date": 1572433787, "last_edit_date": 1572433873, "question_id": 58624059, "link": "https://stackoverflow.com/questions/58624059/vba-error-message-code-still-being-executed-despite-exit-sub-command-beforehand", "title": "VBA: Error message code still being executed despite Exit Sub command beforehand", "body": "<p>I have some code creating a worksheet which is deleted if a worksheet with the same name is already present in the workbook. If a duplicate is present, the code should jump to the <code>Errmsg</code> to create an alert and does. However, when the worksheet isn't a duplicate it still runs through the rest of the code and the error message at the end despite an Exit Sub command before it, therefore deleting the sheet that was just created.</p>\n\n<p>Any help would be appreciated, thanks!</p>\n\n<pre><code>On Error GoTo Errmsg\n\n'Some code\n\nExit Sub\n\nErrmsg:\n    MsgBox \"Worksheet with that name already exists, please edit the test iteration\"\n\n    Application.DisplayAlerts = False\n    With ActiveWorkbook\n        .Worksheets(.Worksheets.Count).Delete\n    End With\n    Application.DisplayAlerts = True\n\nEnd Sub\n\n</code></pre>\n"}, {"tags": ["excel", "vba", "internet-explorer"], "comments": [{"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1572443156, "post_id": 58623269, "comment_id": 103561068, "body": "From your code it is not clear how you open the specific downloaded file as you don&#39;t know its name. Also it is not clear why you use application.wait and sleep() both together. You should use any one of it. Try to provide the detailed information may help us to understand the issue in better way."}, {"owner": {"reputation": 154, "user_id": 6820783, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/45aaf803e8a4c9eff9e9a82600149531?s=128&d=identicon&r=PG&f=1", "display_name": "Freelancer", "link": "https://stackoverflow.com/users/6820783/freelancer"}, "reply_to_user": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1572445168, "post_id": 58623269, "comment_id": 103562283, "body": "hihi, the code above is what i use to click and then select the &quot;open&quot; option when the internet explorer &#39;download notification frame&#39; is triggered (I do not know the name of the file being opened). I have tried using: doevents, application.wait and sleep() in my loop as i hoped that one of them would &#39;release&#39; vba process and allow the excel to open but none of the methods is having this effect. it seems that the downloaded excel cannot open while the macro is running regardless of this loop. the file opens only when i exit the macro."}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1572520070, "post_id": 58623269, "comment_id": 103589424, "body": "As you are opening the file manually, VBA code will not have control on that file before it get opened and assigned to any object in VBA code. So it does not looks a proper approach for handling this issue. If possible for you than you can divide your code in 2 subs and run them when you need it. by this way, you not need to wait for that file. you can run the other sub after file get downloaded and opened."}, {"owner": {"reputation": 154, "user_id": 6820783, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/45aaf803e8a4c9eff9e9a82600149531?s=128&d=identicon&r=PG&f=1", "display_name": "Freelancer", "link": "https://stackoverflow.com/users/6820783/freelancer"}, "reply_to_user": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1572529396, "post_id": 58623269, "comment_id": 103594524, "body": "Everything happens within vba, including opening the file."}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1572529565, "post_id": 58623269, "comment_id": 103594619, "body": "You said that you are clicking the open option to open the file. which is manual operation."}, {"owner": {"reputation": 154, "user_id": 6820783, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/45aaf803e8a4c9eff9e9a82600149531?s=128&d=identicon&r=PG&f=1", "display_name": "Freelancer", "link": "https://stackoverflow.com/users/6820783/freelancer"}, "reply_to_user": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1572540741, "post_id": 58623269, "comment_id": 103600866, "body": "&#39;Click&#39; is an action i perform in vba, it is an automated action: appIE.document.getElementById(&quot;_id3805:_id3806:0:_id4177&quot;).C&zwnj;&#8203;lick"}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1572598461, "post_id": 58623269, "comment_id": 103616347, "body": "Try to put your For each loop for checking the file name inside your do loop and try to check for files after waiting for 1 second. If file found then exit the loop otherwise again wait for 1 second."}], "answers": [{"comments": [{"owner": {"reputation": 154, "user_id": 6820783, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/45aaf803e8a4c9eff9e9a82600149531?s=128&d=identicon&r=PG&f=1", "display_name": "Freelancer", "link": "https://stackoverflow.com/users/6820783/freelancer"}, "edited": false, "score": 0, "creation_date": 1572432631, "post_id": 58623624, "comment_id": 103555196, "body": "hihi. Currently, my code gets stuck in the sleep/doevents loop. It seems that while the code is looping, excel isnt able to open the download. Therefore, i dont think there is a problem with the loop condition, just the way i am &#39;waiting&#39;. In addition, i dont always know the exact naming of the file i am downloading"}], "tags": [], "owner": {"reputation": 121, "user_id": 12267424, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-k1FilUF-vSc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfUpeJ14K2GGlScUV5142qUHlXaPw/photo.jpg?sz=128", "display_name": "Steffen", "link": "https://stackoverflow.com/users/12267424/steffen"}, "is_accepted": false, "score": 1, "last_activity_date": 1572433238, "last_edit_date": 1572433238, "creation_date": 1572432314, "answer_id": 58623624, "question_id": 58623269, "link": "https://stackoverflow.com/questions/58623269/vba-how-to-wait-until-the-excel-download-is-complete/58623624#58623624", "title": "VBA: How to wait until the excel download is complete?", "body": "<p>I think your approach with sleep and doEvents is a good way to solve it. Bevore opening the downloaded workbook, check in your sleep loop if it exists, then exit the loop.</p>\n\n<pre><code>If Dir(pathToFile) &lt;&gt; \"\" Then\n    'File has been found\nend if\n</code></pre>\n\n<p>EDIT:\nI dont see the part where you are trying to open the file.\nThe order in which things should happen in your case is:\n1. Download file\n2. Waiting-loop in which you check if the file has been downloaded\n3. Open file</p>\n\n<p>the sleep loop could look something like this:</p>\n\n<pre><code>'Download the file here\n\ndim fileFound as boolean\nwhile not fileFound\n    sleep(1000)\n    DoEvents\n    If Dir(pathToFile) &lt;&gt; \"\" Then\n        fileFound = true\n    end if\nwend\n\n'Open the file here\n</code></pre>\n"}], "owner": {"reputation": 154, "user_id": 6820783, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/45aaf803e8a4c9eff9e9a82600149531?s=128&d=identicon&r=PG&f=1", "display_name": "Freelancer", "link": "https://stackoverflow.com/users/6820783/freelancer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1264, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1599075062, "creation_date": 1572431221, "last_edit_date": 1572445000, "question_id": 58623269, "link": "https://stackoverflow.com/questions/58623269/vba-how-to-wait-until-the-excel-download-is-complete", "title": "VBA: How to wait until the excel download is complete?", "body": "<p>I have a macro which navigates to a series of web pages, downloads an excel from those pages, and then merges the data onto the open workbook. However, my code fails because it cannot find the newly downloaded workbook. When i step through the code, there is no problem. Presumably my code continues to run but as the newly downloaded workbook is not open yet, it fails.</p>\n\n<p>I have tried to create a loop which waits until the downloaded workbook opens, but it seems that the workbook cannot open while the loop is running.</p>\n\n<p>How can I 'wait' within my code until the workbook is open and my code can proceed?\nany inputs appreciated, thank you!</p>\n\n<pre><code>appIE.document.getElementById(\"_id3805:_id3806:0:_id4177\").Click 'click website download button\nDim o As IUIAutomation\nDim e As IUIAutomationElement, download_check As IUIAutomationElement\nSet o = New CUIAutomation\nDim h As LongLong\nh = appIE.Hwnd\nh = FindWindowEx(h, 0, \"Frame Notification Bar\", vbNullString)\nIf h = 0 Then Exit Sub\nSet e = o.ElementFromHandle(ByVal h)\nDim iCnd As IUIAutomationCondition\nSet iCnd = o.CreatePropertyCondition(UIA_NamePropertyId, \"Open\")\nDim Button As IUIAutomationElement\nSet Button = e.FindFirst(TreeScope_Subtree, iCnd)\nDim InvokePattern As IUIAutomationInvokePattern\nSet InvokePattern = Button.GetCurrentPattern(UIA_InvokePatternId)\nInvokePattern.Invoke\n\n\nDebug.Print \"Download Successful, Click OK\"\n\nApplication.Wait (Now + TimeValue(\"00:00:02\"))\nDoEvents\n' This part searching active workbook\nDim xWBName As String\nDim GetBook As String\nDim xWb As Workbook\n\nDo Until Application.Workbooks.Count &gt; 1\n'    'I am waiting for something to happen\n    DoEvents\n    Application.Wait (Now + TimeValue(\"00:00:01\"))\n    Sleep 1000\nLoop\n\nFor Each xWb In Application.Workbooks\n    'xWBName = xWb.Name 'xWBName &amp; xWb.Name &amp; vbCrLf\n    DoEvents\n    If InStr(xWb.Name, \"Data\") Then\n     GetBook = xWb.Name\n    End If\nNext\nDoEvents\n'Activate the required workbook\n**Set wb2 = Workbooks(GetBook)**\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7739292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0673ac50c679bea69f7dc7a265fe06?s=128&d=identicon&r=PG&f=1", "display_name": "Chucky", "link": "https://stackoverflow.com/users/7739292/chucky"}, "edited": false, "score": 0, "creation_date": 1572562411, "post_id": 58624133, "comment_id": 103608939, "body": "it didn&#39;t work, or maybe I didn&#39;t understand how to make corrections. Unfortunately I am still at a basic level of VBA."}], "tags": [], "owner": {"reputation": 106, "user_id": 10396068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6440bc7f96d2200162628e880337288b?s=128&d=identicon&r=PG", "display_name": "wisniadj", "link": "https://stackoverflow.com/users/10396068/wisniadj"}, "is_accepted": false, "score": 0, "last_activity_date": 1572434046, "creation_date": 1572434046, "answer_id": 58624133, "question_id": 58623104, "link": "https://stackoverflow.com/questions/58623104/how-to-select-the-sheet-and-table-based-on-the-value-of-2-cell/58624133#58624133", "title": "how to select the sheet and table based on the value of 2 cell", "body": "<p>It looks like all the changes you need to do are:</p>\n\n<p>change <code>Dim BANK As String</code> to <code>Dim BANK As Variant</code></p>\n\n<p>and then all <code>(\"Banca_1\")</code> to <code>(BANK)</code></p>\n\n<p>How it works? You declare name of the bank in the user form and then this will select the correct sheet.</p>\n\n<p>Please be aware when using <code>INPUTBOX</code> you need to be precise with the bank name otherwise it will not find the sheet. </p>\n\n<p>Let me know if it works</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 7739292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0673ac50c679bea69f7dc7a265fe06?s=128&d=identicon&r=PG&f=1", "display_name": "Chucky", "link": "https://stackoverflow.com/users/7739292/chucky"}, "is_accepted": false, "score": 0, "last_activity_date": 1572460678, "last_edit_date": 1572460678, "creation_date": 1572458612, "answer_id": 58631323, "question_id": 58623104, "link": "https://stackoverflow.com/questions/58623104/how-to-select-the-sheet-and-table-based-on-the-value-of-2-cell/58631323#58631323", "title": "how to select the sheet and table based on the value of 2 cell", "body": "<p>When I declare name of Account (utente_1;utente_2,utente_3.....utente_N)and declare name of Bank (Banca_1;Banca_2;Banca_3....Banca_4) in the \"operation form\" and this select the correct sheet and correct formatted table on the correct sheet.\n<a href=\"https://www.dropbox.com/s/o597gnqi5mbesip/Esempio%20per%20nome%20della%20variabile%20foglio.xlsm?dl=0\" rel=\"nofollow noreferrer\">example</a></p>\n"}], "owner": {"reputation": 13, "user_id": 7739292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0673ac50c679bea69f7dc7a265fe06?s=128&d=identicon&r=PG&f=1", "display_name": "Chucky", "link": "https://stackoverflow.com/users/7739292/chucky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1572460678, "creation_date": 1572430639, "last_edit_date": 1572430885, "question_id": 58623104, "link": "https://stackoverflow.com/questions/58623104/how-to-select-the-sheet-and-table-based-on-the-value-of-2-cell", "title": "how to select the sheet and table based on the value of 2 cell", "body": "<p>I need to enter data using a pseudo-form. What I would like to get is to send the data in a specific table to a specific sheet that are declared by the value of the \"Account\" and \"Bank\" cell.</p>\n\n<p>example, (the language I use in the file is Italian)</p>\n\n<p>Pseudo-form for send data\nData - Account - Bank - Operazione - Dare - Avere </p>\n\n<p>\"Account\" is a drop-down menu, with the choices \"Utente_1, Utente_2, User_3, .. Utente_n (hypoteitically infinite \"Utente\" values).</p>\n\n<p>\"Bank\" is a drop-down menu, with the choices \"Banca_1, Banca_2, Banca_3 ... Banca_n (hypothetically infinite values of \"Banca\")</p>\n\n<p>I tried with this little code and I can only send data to the \"Worksheets (\" Banca_1 \"). Select\"\nI don't know very well with the VBA language, is there anyone who can help me?</p>\n\n<pre><code>Dim DATA As Date\nDim ACCOUNT As String\nDim BANK As String\nDim OPERAZIONE As String\nDim DARE As Currency\nDim AVERE As Currency\n\nWith Sheets(\"Home\")\n    DATA = .Cells(13, 1).Value\n    ACCOUNT = .Cells(13, 2).Value\n    BANK = .Cells(13, 3).Value\n    OPERAZIONE = .Cells(13, 4).Value\n    DARE = .Cells(13, 5).Value\n    AVERE = .Cells(13, 6).Value \nEnd With\n\nCall InsOper(DATA, ACCOUNT, BANK, OPERAZIONE, DARE, AVERE)\n\nDim riga As Integer\nDim v As Variant\nriga = 12\nWorksheets(\"Banca_1\").Select \n\nDo\n    riga = riga + 1\n    v = Sheets(\"Banca_1\").Cells(riga, 2).Value '\nLoop While Not IsEmpty(v)\n\nWith Sheets(\"Banca_1\") \n    .Cells(riga, 2).Value = DATA\n    .Cells(riga, 3).Value = ACCOUNT\n    .Cells(riga, 4).Value = BANK\n    .Cells(riga, 5).Value = OPERAZIONI\n    .Cells(riga, 6).Value = DARE\n    .Cells(riga, 7).Value = AVERE\nEnd With\n\nMsgBox (\"Ok! Operazione aggiunta con successo\")\n</code></pre>\n\n<p>I have a sheet for each \"bank\" and on each sheet, there is a table for each \"Utente\"</p>\n\n<p>I would like to get is to fill in the pesudo-from:</p>\n\n<p>DATA: 12/12/2019</p>\n\n<p>ACCOUNT: User_1</p>\n\n<p>BANK: Banca_2</p>\n\n<p>OPERAZIONI:PURCHASE </p>\n\n<p>DARE: + 25.00 \u20ac </p>\n\n<p>AVERE: -34.00 \u20ac</p>\n\n<p>and send the data in the sheet called \"Banca_2\" in the tab called \"Utente_1\" in the first empty row available.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "edited": false, "score": 0, "creation_date": 1572432752, "post_id": 58623317, "comment_id": 103555258, "body": "Plus, none of your activate / select statements are needed. You can use Header.xxx and samplelist.yyy straight away without the need to activate them first."}, {"owner": {"reputation": 1, "user_id": 5532890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8cd3bceaddf52206184449db80874f8?s=128&d=identicon&r=PG&f=1", "display_name": "TSZ", "link": "https://stackoverflow.com/users/5532890/tsz"}, "edited": false, "score": 0, "creation_date": 1572441647, "post_id": 58623317, "comment_id": 103560205, "body": "Now the code goes through the number of rows/columns I defined. But how can I manage to do a loop where it manages to copy the cell from one workbook (always same cell) to the other workbook where it should always paste the data one column further?"}, {"owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "reply_to_user": {"reputation": 1, "user_id": 5532890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8cd3bceaddf52206184449db80874f8?s=128&d=identicon&r=PG&f=1", "display_name": "TSZ", "link": "https://stackoverflow.com/users/5532890/tsz"}, "edited": false, "score": 0, "creation_date": 1572441877, "post_id": 58623317, "comment_id": 103560340, "body": "Can you update your question with some sample screenshot?"}], "tags": [], "owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "is_accepted": false, "score": 1, "last_activity_date": 1572431373, "creation_date": 1572431373, "answer_id": 58623317, "question_id": 58623094, "link": "https://stackoverflow.com/questions/58623094/go-through-columns-and-copy-cells/58623317#58623317", "title": "Go through columns and copy cells", "body": "<p>Instead of using Range() to reference the cells you are checking, you could use Cells(x,y). Since you know the number of rows and columns you have, you can have a nested For i.e. For Each Row Loop All Columns.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub sCopy()\n\n  Dim numberOfColumns As Long, numberOfRows As Long\n  Dim x As Long, y As Long\n  Dim ws As Worksheet\n\n  'set number of rows/columns\n  'set workbooks / worksheets\n\n  For x = 1 To numberOfRows\n    For y = 1 To numberOfColumns\n      If ws.Cells(x, y).Value &lt;&gt; \"\" Then\n       'Do what you have to do\n      End If\n    Next y\n  Next x\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5532890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8cd3bceaddf52206184449db80874f8?s=128&d=identicon&r=PG&f=1", "display_name": "TSZ", "link": "https://stackoverflow.com/users/5532890/tsz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575930790, "creation_date": 1572430604, "last_edit_date": 1575930790, "question_id": 58623094, "link": "https://stackoverflow.com/questions/58623094/go-through-columns-and-copy-cells", "title": "Go through columns and copy cells", "body": "<p>I wrote code that goes to each row if there is data and copies the data to a different file in specific cells.</p>\n\n<p>Now I want to go through each column instead of row till there is no data left.</p>\n\n<p>My code for rows that is working is:</p>\n\n<pre><code>Sub Row_copying()\n\n'load my workbooks\n\nDim Header As Workbook\nWorkbooks.Open FileName:=\"/Users/Header.xlsx\"\nSet Header = Workbooks(\"Header.xlsx\")\n\nDim samplelist As Workbook\nWorkbooks.Open FileName:=\"/Users/samplelist.xlsx\"\nSet samplelist = Workbooks(\"samplelist.xlsx\")\n\nsamplelist.Activate\n\n' Loop through each row that has data\nDim lRow As Long\n\nFor lRow = 2 To Cells(Rows.Count, 1).End(xlUp).Row\n    If Range(\"A\" &amp; lRow).Value &lt;&gt; \"\" Then\n        'copy cell\n        Range(\"D\" &amp; lRow).Copy\n        Header.Activate\n        Range(\"K5:M5\").Select\n        ActiveSheet.Paste\n\n        samplelist.Activate\n        Range(\"H\" &amp; lRow).Copy\n        Header.Activate\n        Range(\"F5:G5\").Select\n        ActiveSheet.Paste\n\n        Dim DName As String, dataname As String, path As String\n        samplelist.Activate\n        path = \"/Users/newdata/\"\n        DName = \"sample_\"\n        dataname = path &amp; DName &amp; Format(Range(\"A\") &amp; lRow.Value, \"000\") &amp; \".xlsx\"\n        Header.Activate\n        ActiveWorkbook.SaveAs FileName:= dataname\n    End If\n    samplelist.Activate\nNext lRow\nWorkbooks(\"samplelist.xlsx\").Close\nEnd Sub\n</code></pre>\n\n<p>I could check how many columns have data by changing the lRow to</p>\n\n<pre><code>lCol = Cells(1, Columns.Count).End(xlToLeft).Column\nMsgBox\"last Column: \"&amp;lCol\n</code></pre>\n\n<p>I could not manage that it goes through each column and copy the cells.</p>\n"}, {"tags": ["vba", "dxf"], "comments": [{"owner": {"reputation": 305, "user_id": 10785732, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RIiEj6LHpXQ/AAAAAAAAAAI/AAAAAAAAABU/tYGkN03PEsA/photo.jpg?sz=128", "display_name": "Peter Ksenak", "link": "https://stackoverflow.com/users/10785732/peter-ksenak"}, "edited": false, "score": 0, "creation_date": 1572435975, "post_id": 58622733, "comment_id": 103556925, "body": "read reference <a href=\"https://images.autodesk.com/adsk/files/autocad_2012_pdf_dxf-reference_enu.pdf\" rel=\"nofollow noreferrer\">images.autodesk.com/adsk/files/&hellip;</a> , what concretly are you trying to achieve? btw, i have written excel vba macro to write some text at XY position in DXF file, if it will be usefull for you"}, {"owner": {"reputation": 189, "user_id": 3057893, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/nvJwi.jpg?s=128&g=1", "display_name": "Javier", "link": "https://stackoverflow.com/users/3057893/javier"}, "reply_to_user": {"reputation": 305, "user_id": 10785732, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RIiEj6LHpXQ/AAAAAAAAAAI/AAAAAAAAABU/tYGkN03PEsA/photo.jpg?sz=128", "display_name": "Peter Ksenak", "link": "https://stackoverflow.com/users/10785732/peter-ksenak"}, "edited": false, "score": 0, "creation_date": 1572437659, "post_id": 58622733, "comment_id": 103557836, "body": "Hi Peter. Thanks for your response.  Your mentioned reference, like all native autocad manuals, are absolutelly useless, because hasn&#39;t any examples. Very technical, very complete, bleh, bleh, bleh, but absolutelly useless for novices as me.  I only need a simple inserting block example dxf file :)"}, {"owner": {"reputation": 305, "user_id": 10785732, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RIiEj6LHpXQ/AAAAAAAAAAI/AAAAAAAAABU/tYGkN03PEsA/photo.jpg?sz=128", "display_name": "Peter Ksenak", "link": "https://stackoverflow.com/users/10785732/peter-ksenak"}, "edited": false, "score": 0, "creation_date": 1572439141, "post_id": 58622733, "comment_id": 103558705, "body": "please read this <a href=\"http://paulbourke.net/dataformats/dxf/min3d.html\" rel=\"nofollow noreferrer\">paulbourke.net/dataformats/dxf/min3d.html</a> , I just saved example from the end of this page to .txt file and changed extension to .dxf and it works"}], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 3057893, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/nvJwi.jpg?s=128&g=1", "display_name": "Javier", "link": "https://stackoverflow.com/users/3057893/javier"}, "edited": false, "score": 0, "creation_date": 1572440464, "post_id": 58625632, "comment_id": 103559475, "body": "Hi Peter. Thanks for sour help and patience  Autocad response: &quot;Invalid or incomplete DXF input -- drawing discarded.&quot;  Anyway, I know how to write a minimal dxf (lines, arcs, etc.). In need to learn how to manipulate BLOCKS."}, {"owner": {"reputation": 305, "user_id": 10785732, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RIiEj6LHpXQ/AAAAAAAAAAI/AAAAAAAAABU/tYGkN03PEsA/photo.jpg?sz=128", "display_name": "Peter Ksenak", "link": "https://stackoverflow.com/users/10785732/peter-ksenak"}, "reply_to_user": {"reputation": 189, "user_id": 3057893, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/nvJwi.jpg?s=128&g=1", "display_name": "Javier", "link": "https://stackoverflow.com/users/3057893/javier"}, "edited": false, "score": 0, "creation_date": 1572440669, "post_id": 58625632, "comment_id": 103559582, "body": "Sorry, I do not have autocad.. I used simple IrfanView to open it"}], "tags": [], "owner": {"reputation": 305, "user_id": 10785732, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RIiEj6LHpXQ/AAAAAAAAAAI/AAAAAAAAABU/tYGkN03PEsA/photo.jpg?sz=128", "display_name": "Peter Ksenak", "link": "https://stackoverflow.com/users/10785732/peter-ksenak"}, "is_accepted": false, "score": 0, "last_activity_date": 1572439296, "creation_date": 1572439296, "answer_id": 58625632, "question_id": 58622733, "link": "https://stackoverflow.com/questions/58622733/how-do-i-write-a-dxf-code-for-a-simple-block/58625632#58625632", "title": "How do I write a DXF code for a SIMPLE BLOCK?", "body": "<p>Save that text as .dxf and open as picture</p>\n\n<pre><code>    0\n    SECTION\n    2\n    ENTITIES\n    0\n    3DFACE\n    8\n    1\n    62\n    1\n    10\n    -0.5\n    20\n    -0.5\n    30\n    -0.5\n    11\n    -0.5\n    21\n    0.5\n    31\n    -0.5\n    12\n    0.5\n    22\n    0.5\n    32\n    -0.5\n    13\n    0.5\n    23\n    -0.5\n    33\n    -0.5\n    0\n    3DFACE\n    8\n    1\n    62\n    1\n    10\n    -0.5\n    20\n    -0.5\n    30\n    -0.5\n    11\n    0.5\n    21\n    -0.5\n    31\n    -0.5\n    12\n    0\n    22\n    -0.5\n    32\n    0.5\n    13\n    0\n    23\n    -0.5\n    33\n    0.5\n    0\n    LINE\n    8\n    1\n    62\n    1\n    10\n    0\n    20\n    -0.5\n    30\n    0.5\n    11\n    0\n    21\n    0.5\n    31\n    -0.5\n    0\n    ENDSEC\n    0\n    EOF\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 3057893, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/nvJwi.jpg?s=128&g=1", "display_name": "Javier", "link": "https://stackoverflow.com/users/3057893/javier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572439296, "creation_date": 1572429456, "question_id": 58622733, "link": "https://stackoverflow.com/questions/58622733/how-do-i-write-a-dxf-code-for-a-simple-block", "title": "How do I write a DXF code for a SIMPLE BLOCK?", "body": "<p>I'm manually writing a dxf file. My question is: How do I write a DXF code for a SIMPLE BLOCK (containing for example one line)?</p>\n\n<p>I'm really lost. I tried:</p>\n\n<pre><code>0 \nSECTION\n 2 \n BLOCKS\n 0\nBLOCK\n100\nAcDbEntity\n  8\n0\n100\nAcDbBlockBegin\n  2\nMySampleBlock\n10\n0\n20\n0\n30\n0\n  3\nMySampleBlock\n......\n0\nENDBLK\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula", "excel-2013", "array-formulas"], "comments": [{"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 0, "creation_date": 1572429189, "post_id": 58622496, "comment_id": 103553306, "body": "Just to be clear, are you trying to find the total % time difference split by DAY, or split by SYSTEM AND DAY?"}, {"owner": {"reputation": 359, "user_id": 11749036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CGIoC.jpg?s=128&g=1", "display_name": "Mirza", "link": "https://stackoverflow.com/users/11749036/mirza"}, "reply_to_user": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 0, "creation_date": 1572429432, "post_id": 58622496, "comment_id": 103553450, "body": "@Gravitate Good point! Sorry didnt include that, split by System and Day! So for both systems because I can calculate Utilization rate and compare it.."}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 0, "creation_date": 1572429594, "post_id": 58622496, "comment_id": 103553542, "body": "Right... but you also want the time difference to cut off at midnight each day? As though you almost need to insert another entry at the end of each day?"}, {"owner": {"reputation": 359, "user_id": 11749036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CGIoC.jpg?s=128&g=1", "display_name": "Mirza", "link": "https://stackoverflow.com/users/11749036/mirza"}, "reply_to_user": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 0, "creation_date": 1572429877, "post_id": 58622496, "comment_id": 103553692, "body": "Well thats a thing, I would like to have it exactly for 24h, even if it is gonna be &quot;cut&quot;..but not only to exceed 100% like in my case. Is it feasible or it can be issue because there are different cases also, for example you can have a &quot;gap&quot; for 2 days or similar..."}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 0, "creation_date": 1572432267, "post_id": 58622496, "comment_id": 103554974, "body": "I think that I am nearly there... the gap is causing an issue though. Is there a max number of days gap?"}, {"owner": {"reputation": 359, "user_id": 11749036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CGIoC.jpg?s=128&g=1", "display_name": "Mirza", "link": "https://stackoverflow.com/users/11749036/mirza"}, "reply_to_user": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 0, "creation_date": 1572432480, "post_id": 58622496, "comment_id": 103555113, "body": "Unfortunately not, but from my experience wth this kind of data, it wasnt more than 5-10 consecutive days (sometimes they (company) had system off for some days or due to repair)..  usually is couple of days but NOT often as a case. That depends on the system (I have like 20 systems, and the one I showed is only of 1/20)!"}], "answers": [{"comments": [{"owner": {"reputation": 359, "user_id": 11749036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CGIoC.jpg?s=128&g=1", "display_name": "Mirza", "link": "https://stackoverflow.com/users/11749036/mirza"}, "edited": false, "score": 0, "creation_date": 1572442901, "post_id": 58626414, "comment_id": 103560935, "body": "I will have a deeper look later when done with another task that I am doing right now, but seems fair! A bit different approach from mine. But the only thing that caught my eye is that last Table where systems are - how the percentages are the same for both systems?   As I say I must and will go thoroughly bit later when get home to see in details, thats the only thing for now I saw.   You did great job, that time difference will be useful definetly!"}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "reply_to_user": {"reputation": 359, "user_id": 11749036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CGIoC.jpg?s=128&g=1", "display_name": "Mirza", "link": "https://stackoverflow.com/users/11749036/mirza"}, "edited": false, "score": 0, "creation_date": 1572443656, "post_id": 58626414, "comment_id": 103561371, "body": "Ooops. Sorry. Ignore that. Just a silly error copying and pasting my percentage formula. I have fixed the image now."}, {"owner": {"reputation": 359, "user_id": 11749036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CGIoC.jpg?s=128&g=1", "display_name": "Mirza", "link": "https://stackoverflow.com/users/11749036/mirza"}, "edited": false, "score": 0, "creation_date": 1572443995, "post_id": 58626414, "comment_id": 103561589, "body": "Great! Will write it till end of the day my test! I will keep you informed!"}, {"owner": {"reputation": 359, "user_id": 11749036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CGIoC.jpg?s=128&g=1", "display_name": "Mirza", "link": "https://stackoverflow.com/users/11749036/mirza"}, "edited": false, "score": 0, "creation_date": 1572474660, "post_id": 58626414, "comment_id": 103575897, "body": "This [Finish Datetime] column is bothering me...I am just now trying after concatenating date/time the &quot;IF&quot; statement but it doesnt work, gives me zeros. Can you copy/paste whole functions or to check it for mistype? It is a lot of If statements through this example."}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "reply_to_user": {"reputation": 359, "user_id": 11749036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CGIoC.jpg?s=128&g=1", "display_name": "Mirza", "link": "https://stackoverflow.com/users/11749036/mirza"}, "edited": false, "score": 0, "creation_date": 1572514349, "post_id": 58626414, "comment_id": 103586234, "body": "Please see my edit for explanation. Please also make sure that all your dates and times, are actually stored as date, not text that looks like a date. When you say &quot;concatenating date/time&quot;, generally <code>CONCATENATE</code> is a string function. Just be sure that you are adding the time to the date, rather than appending the time to the end of a date string. I hope that makes sense."}, {"owner": {"reputation": 359, "user_id": 11749036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CGIoC.jpg?s=128&g=1", "display_name": "Mirza", "link": "https://stackoverflow.com/users/11749036/mirza"}, "edited": false, "score": 0, "creation_date": 1572903971, "post_id": 58626414, "comment_id": 103698881, "body": "Sorry for late response...was off for couple of days. Anyways, check my Edited SS that I updated - it is not working actually, that part with &quot;Finish DateTime&quot;, gives always blanks."}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "reply_to_user": {"reputation": 359, "user_id": 11749036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CGIoC.jpg?s=128&g=1", "display_name": "Mirza", "link": "https://stackoverflow.com/users/11749036/mirza"}, "edited": false, "score": 0, "creation_date": 1572904860, "post_id": 58626414, "comment_id": 103699229, "body": "Are you sure that both, your &quot;Date&quot; &amp; &quot;Time&quot; columns are actually stored as dates? And not just text?"}, {"owner": {"reputation": 359, "user_id": 11749036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CGIoC.jpg?s=128&g=1", "display_name": "Mirza", "link": "https://stackoverflow.com/users/11749036/mirza"}, "edited": false, "score": 0, "creation_date": 1572931249, "post_id": 58626414, "comment_id": 103704727, "body": "Yes...I know that already that they need to be in certain format....could it be because of regional settings or something? I dont think so but still.."}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "reply_to_user": {"reputation": 359, "user_id": 11749036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CGIoC.jpg?s=128&g=1", "display_name": "Mirza", "link": "https://stackoverflow.com/users/11749036/mirza"}, "edited": false, "score": 0, "creation_date": 1572934662, "post_id": 58626414, "comment_id": 103705709, "body": "Hmm. Not sure what could be the problem then. Do your settings allow dates with a dot instead of a slash (mine dont)? If you change the format of the columns to &quot;number&quot;, what values do they show?"}, {"owner": {"reputation": 359, "user_id": 11749036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CGIoC.jpg?s=128&g=1", "display_name": "Mirza", "link": "https://stackoverflow.com/users/11749036/mirza"}, "edited": false, "score": 0, "creation_date": 1572949111, "post_id": 58626414, "comment_id": 103712372, "body": "Will check it at evening...unfortunately here at Work they dont have Office 365 and MINIFS function :/   but I might try to change Date format @home. Strange that it didnt work."}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "reply_to_user": {"reputation": 359, "user_id": 11749036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CGIoC.jpg?s=128&g=1", "display_name": "Mirza", "link": "https://stackoverflow.com/users/11749036/mirza"}, "edited": false, "score": 0, "creation_date": 1572949673, "post_id": 58626414, "comment_id": 103712670, "body": "Can you use aggregate instead?: <code>=AGGREGATE(15,6,$D$3:$D$12&#47;($D$3:$D$12&gt;$D3),1)</code>"}, {"owner": {"reputation": 359, "user_id": 11749036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CGIoC.jpg?s=128&g=1", "display_name": "Mirza", "link": "https://stackoverflow.com/users/11749036/mirza"}, "edited": false, "score": 0, "creation_date": 1572958954, "post_id": 58626414, "comment_id": 103717294, "body": "That works, but there is another issue...just realised. It makes error/repeatings when it goes into another month... check the SS please! Up till then works good I think."}, {"owner": {"reputation": 359, "user_id": 11749036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CGIoC.jpg?s=128&g=1", "display_name": "Mirza", "link": "https://stackoverflow.com/users/11749036/mirza"}, "edited": false, "score": 0, "creation_date": 1572963559, "post_id": 58626414, "comment_id": 103719809, "body": "And btw., Your calculated field &quot;Total time difference&quot; is the same as mine TIme difference...I used =MOD function, gave the same result as yours."}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "reply_to_user": {"reputation": 359, "user_id": 11749036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CGIoC.jpg?s=128&g=1", "display_name": "Mirza", "link": "https://stackoverflow.com/users/11749036/mirza"}, "edited": false, "score": 0, "creation_date": 1572964648, "post_id": 58626414, "comment_id": 103720478, "body": "I am sorry, without being able to see and investigate what is going wrong, it is very hard for me to debug it for you. Is it possible for you to share the actual workbook? My time diff and your time diff <i>should</i> be the same... if not, one of them would be wrong. You can keep using your <code>MOD</code> formula if you wish, it&#39;s just that $E3-$D3 is much easier for me to understand than having to deal with a <code>MOD</code>"}, {"owner": {"reputation": 359, "user_id": 11749036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CGIoC.jpg?s=128&g=1", "display_name": "Mirza", "link": "https://stackoverflow.com/users/11749036/mirza"}, "edited": false, "score": 0, "creation_date": 1572984113, "post_id": 58626414, "comment_id": 103730216, "body": "<a href=\"https://1drv.ms/x/s!Aq7b0zpSsPxdjAtgwcrqLXGNVgal?e=NfxARy\" rel=\"nofollow noreferrer\">1drv.ms/x/s!Aq7b0zpSsPxdjAtgwcrqLXGNVgal?e=NfxARy</a>  Here you have it on @onedrive   You will see what I did and what is my issue."}, {"owner": {"reputation": 359, "user_id": 11749036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CGIoC.jpg?s=128&g=1", "display_name": "Mirza", "link": "https://stackoverflow.com/users/11749036/mirza"}, "edited": false, "score": 0, "creation_date": 1573027827, "post_id": 58626414, "comment_id": 103742747, "body": "On second sheet maybe you will not see &quot;scroll bar&quot; (because of protected view or validity) that connects table, dynamically changing chart per month. There you can see over 100% columns."}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "reply_to_user": {"reputation": 359, "user_id": 11749036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CGIoC.jpg?s=128&g=1", "display_name": "Mirza", "link": "https://stackoverflow.com/users/11749036/mirza"}, "edited": false, "score": 0, "creation_date": 1573034173, "post_id": 58626414, "comment_id": 103746008, "body": "No problem. I will take a look and see what I can do as soon as I get chance."}, {"owner": {"reputation": 359, "user_id": 11749036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CGIoC.jpg?s=128&g=1", "display_name": "Mirza", "link": "https://stackoverflow.com/users/11749036/mirza"}, "edited": false, "score": 0, "creation_date": 1574456996, "post_id": 58626414, "comment_id": 104253957, "body": "any chance you looked at the data set I provide some weeks ago??"}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "reply_to_user": {"reputation": 359, "user_id": 11749036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CGIoC.jpg?s=128&g=1", "display_name": "Mirza", "link": "https://stackoverflow.com/users/11749036/mirza"}, "edited": false, "score": 1, "creation_date": 1574673310, "post_id": 58626414, "comment_id": 104300934, "body": "Sorry, I haven&#39;t. I have been pretty busy since then. I will take a look when I get chance."}], "tags": [], "owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "is_accepted": false, "score": 1, "last_activity_date": 1572514143, "last_edit_date": 1572514143, "creation_date": 1572441929, "answer_id": 58626414, "question_id": 58622496, "link": "https://stackoverflow.com/questions/58622496/how-to-calculate-summarize-proper-percentage-within-24h-to-not-exceed-100/58626414#58626414", "title": "How to calculate (summarize) proper Percentage within 24h (to not exceed 100%)", "body": "<p>Ok. This may not do exactly what you want but I hope this helps get you there...</p>\n\n<p>You have 3 main static data columns:</p>\n\n<ul>\n<li>Date</li>\n<li>Start Time</li>\n<li>System</li>\n</ul>\n\n<p>I started by combining the \"Date\" and \"Start Time\" into a single \"Start Datetime\" column.</p>\n\n<p>I then created a \"Finish DateTime\" column by using <code>MINIFS</code> - this way, the sort order of the table will not affect the data.</p>\n\n<p>I then made another column which shows either the finish time, or the end of the day, whichever comes first (<code>MIN</code>).</p>\n\n<p>I then calculate the \"Total Time Difference\" - simply the \"Finish Datetime\" minus the \"Start Datetime\".</p>\n\n<p>I do the same again, but this time for the \"Midnight Cut Off Finish Time\".</p>\n\n<p>The last helper column I have added is to show how much time has passed after the Midnight Cut Off. This is simply the \"Total Time Diff\" minus the \"Midnight Cut Off Time Diff\".</p>\n\n<p>All fairly simple so far. Here is an image which will hopefully make my layout clear. (you can move or hide the columns as needed).</p>\n\n<p><a href=\"https://i.stack.imgur.com/WGrlx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WGrlx.png\" alt=\"enter image description here\"></a></p>\n\n<p>The formulas for these helper columns are quite simple, so I won't explain them but will supply them below:</p>\n\n<p>Start Datetime</p>\n\n<pre><code>Start Datetime:\n     =$A3+$B3\n\nFinish Datetime:\n     =IF(MINIFS($D$3:$D$12,$D$3:$D$12,\"&gt;\"&amp;$D3)=0,\"\",MINIFS($D$3:$D$12,$D$3:$D$12,\"&gt;\"&amp;$D3))\n\nFinish Time (Midnight Cut Off):\n     =IF($E3=\"\",\"\",MIN($A3+1,$E3))\n\nTotal Time Diff:\n     =IF($E3=\"\",\"\",$E3-$D3)\n\nTime diff (Until Midnight):\n     =IF($E3=\"\",\"\",$F3-$D3)\n\nRemaining Time (After Midnight):\n     =IF($E3=\"\",\"\",$G3-$H3)\n</code></pre>\n\n<p><strong>----------------------------------------------------------------</strong><br>\n<strong>EDIT: Clarification in response to comment.</strong><br>\n<strong>----------------------------------------------------------------</strong>  </p>\n\n<p>The \"Finish Datetime\" formula is actually just a single <code>MINIFS</code> function.</p>\n\n<p>It looks more complex because I have wrapped it in an <code>IF</code> statement to handle the case when there is no finish time (i.e. we are currently in that time period). </p>\n\n<p>In that case, to avoid it returning \"01/01/1900\" (0), it returns an empty string instead.</p>\n\n<p>So the main <code>MINIFS</code> function:</p>\n\n<pre><code>MINIFS($D$3:$D$12,$D$3:$D$12,\"&gt;\"&amp;$D3)\n</code></pre>\n\n<p>Works by selecting the smallest \"Start Datetime\" which is greater than the \"Start Datetime\". (i.e. the next start time along.)</p>\n\n<p>If your data is always sorted by ascending \"Start Datetime\", you could accomplish the same thing by simply <code>=$D4</code> (i.e. selecting the Start Datetime of the row below). However, if you then sorted your data differently, it would completely screw up your results.</p>\n\n<p>I always prefer to make tables \"Sort Safe\".</p>\n\n<p><strong>----------------------------------------------------------------</strong><br>\n<strong>END EDIT</strong><br>\n<strong>----------------------------------------------------------------</strong>  </p>\n\n<p>Also, as you can see, I have added a completely separate table at the end. </p>\n\n<p>This has a list of ALL dates (even those skipped over in the main data) on the left.\nAnd a list of all systems running horizontally (two columns per system to show time and percentage).</p>\n\n<p>The percentage is simply the time for that particular system, divided by the total for that particular day.</p>\n\n<p>The difficult part is working out the Time. The formula to do so is as below:</p>\n\n<pre><code>=IF($K3=MAX($A$3:$A$12),\"\",\n    MIN( \"24:00:00\",\n        SUMIFS($H$3:$H$12, $A$3:$A$12, $K3, $C$3:$C$12, L$1)\n        +\n        MAX(0,\n            SUMIFS($I$3:$I$12, $D$3:$D$12, MAXIFS($D$3:$D$12, $A$3:$A$12, \"&lt;\"&amp;$K3, $C$3:$C$12, L$1), $C$3:$C$12, L$1)\n            -\n            (   $K3\n                -IF(MAXIFS($A$3:$A$12,$A$3:$A$12,\"&lt;\"&amp;$K3)=0, $K3, MAXIFS($A$3:$A$12,$A$3:$A$12,\"&lt;\"&amp;$K3)+1)\n            )\n        )\n    )\n)\n</code></pre>\n\n<p>The first part, checks that there is a finish time for the date in question, and if not, returns a blank.</p>\n\n<p>The <code>MIN(\"24:00:00\", ...</code> limits the amount of time to 24 hours. I.E. if multiple days are skipped, any more than one is ignored (for this particular date).</p>\n\n<p>The rest of the formula is basically:</p>\n\n<pre><code>&lt;Total time diff up until midnight for the particular date &amp; system&gt;\n+\n&lt;The time remaining after midnight from the day before&gt;\n-\n&lt;The number of days skipped&gt;\n</code></pre>\n\n<p>If you have any queries, please let me know.</p>\n"}], "owner": {"reputation": 359, "user_id": 11749036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CGIoC.jpg?s=128&g=1", "display_name": "Mirza", "link": "https://stackoverflow.com/users/11749036/mirza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1572959152, "creation_date": 1572428670, "last_edit_date": 1572959152, "question_id": 58622496, "link": "https://stackoverflow.com/questions/58622496/how-to-calculate-summarize-proper-percentage-within-24h-to-not-exceed-100", "title": "How to calculate (summarize) proper Percentage within 24h (to not exceed 100%)", "body": "<p>Topic sounds simple but the task that I am interested in is not!</p>\n\n<p>So, I got a set of measurement data that are changing per day, with more instances within one day!  So as you can see for 07.02.2019 you got 5x instances that are changing (system changes) with different Time difference.  Well that is the point, I need to have it in percentage but within 24h! not like you can see on this example over 100% what is nonsense. </p>\n\n<p>The data itself are recording the data constantly, and system change is automatic. Sometimes you can have 1-2 instances per day, and sometimes over 5x..</p>\n\n<p>I did some calcs using <code>=mod</code> for Time difference <code>(d2-d1,1)</code> and <code>=sumifs</code> for giving me SUM of one day per system, but it is wrong, because it is taking also time difference from previous day and summing it....</p>\n\n<p>Is there any way to be limited to 24h max? not to calculate time difference when is happening over 24th hour??</p>\n\n<p>I hope you got my concern.. this is only small part of complete picture, there are more events where I have over 100%.... </p>\n\n<p>I mean there is a way to put =<code>MIN(1;I2)</code> but I am only limited to 100% exactly..dont know if that is right approach. </p>\n\n<p><a href=\"https://i.stack.imgur.com/86FSa.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/86FSa.jpg\" alt=\"Data\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/Tnyga.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Tnyga.jpg\" alt=\"Chart\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/eBqVU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eBqVU.png\" alt=\"Calculate\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/TVftY.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TVftY.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "solver"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 9671495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c0a342b981fad43d2db08200cc42993?s=128&d=identicon&r=PG&f=1", "display_name": "Sam M", "link": "https://stackoverflow.com/users/9671495/sam-m"}, "edited": false, "score": 0, "creation_date": 1572435725, "post_id": 58622658, "comment_id": 103556812, "body": "It is not any of the above. I had already tried your 1st suggestion. The code was created in excel 2016"}], "tags": [], "owner": {"reputation": 377, "user_id": 11515463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a12a06f75df2e6ad12c29e215427e11e?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Abreu", "link": "https://stackoverflow.com/users/11515463/johnny-abreu"}, "is_accepted": false, "score": 1, "last_activity_date": 1572429129, "creation_date": 1572429129, "answer_id": 58622658, "question_id": 58621519, "link": "https://stackoverflow.com/questions/58621519/solver-add-in-error-solver32-dll-not-found-and-unexpected-error-occured/58622658#58622658", "title": "Solver add-in error, solver32.dll not found and unexpected error occured", "body": "<p>Check if solver add-in is enabled. Go to File tab > Options > Manage Excel Add-ins (Go button at the bottom of the window) and check if the Solver is enabled. If it is then try to uncheck all options and restart the excel, then do the same thing and enable the Solver again.</p>\n\n<p>Was the file originally made in excel 2010? If so it might be a problem of incompatibility. Some people apparently tried to copy &amp; paste the sheet to a new excel 2016 sheet and the problem was solved. </p>\n\n<p>It can also be a COM Add-in related problem. Go to the Developer tab and try to uncheck all the options in COM Add-ins.</p>\n"}, {"tags": [], "owner": {"reputation": 10578, "user_id": 4791116, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/w9Q0W.jpg?s=128&g=1", "display_name": "Roman", "link": "https://stackoverflow.com/users/4791116/roman"}, "is_accepted": false, "score": 0, "last_activity_date": 1609141771, "creation_date": 1609141771, "answer_id": 65474449, "question_id": 58621519, "link": "https://stackoverflow.com/questions/58621519/solver-add-in-error-solver32-dll-not-found-and-unexpected-error-occured/65474449#65474449", "title": "Solver add-in error, solver32.dll not found and unexpected error occured", "body": "<ol>\n<li>Install extension <code>File tab &gt; Options &gt; Manage Excel Add-ins &gt; GO &gt; Select the Solver Add-in &gt; OK</code></li>\n<li>Wait until it is got installed</li>\n<li><strong>Restart Excel</strong>. It is the critical step</li>\n</ol>\n"}], "owner": {"reputation": 29, "user_id": 9671495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c0a342b981fad43d2db08200cc42993?s=128&d=identicon&r=PG&f=1", "display_name": "Sam M", "link": "https://stackoverflow.com/users/9671495/sam-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1774, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1609141771, "creation_date": 1572425336, "last_edit_date": 1572427231, "question_id": 58621519, "link": "https://stackoverflow.com/questions/58621519/solver-add-in-error-solver32-dll-not-found-and-unexpected-error-occured", "title": "Solver add-in error, solver32.dll not found and unexpected error occured", "body": "<p>I am using excel 2016. I am trying to automate solver to optimize my portfolio. The code works on a few pcs, but it does not work on mine and a number of my colleagues. the error, solver32.dll not found and sometimes I get an unexpected error has occurred or available memory was exhausted.</p>\n\n<p>I went through a lot of possible solutions:\n 1. disable solver and restart excel and load it again\n 2. change security settings for activex to prompt me\n 3. re-install/repair office\n 4. add constraints cell by cell\nand many many more things.</p>\n\n<p>The one thing that helped was to install 64bit office. </p>\n\n<p>Now solver works manually. \nWhen using the VBA code it gets stuck on the solverAdd function. Any ideas? </p>\n\n<pre><code>    SolverReset\n    SolverOK setCell:=Range(\"T28\"), MaxMinVal:=1, ByChange:=Range(\"weights\"), Engine:=1\n    'adding lower constraints\n    For i = 1 To 8\n        SolverAdd CellRef:=Range(\"S15\").Offset(i, 0), Relation:=3, FormulaText:=Range(\"S15\").Offset(i, -2).Value\n    Next i\n    'adding upper constraints\n    For i = 1 To 8\n        SolverAdd CellRef:=Range(\"S15\").Offset(i, 0), Relation:=1, FormulaText:=Range(\"S15\").Offset(i, -1).Value\n    Next i\n    'portfolio must add to 100%\n    SolverAdd CellRef:=Range(\"Total\"), Relation:=2, FormulaText:=1\n\n    SolverFinish KeepFinal:=1\n    SolverSolve UserFinish:=True\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "charts"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1572466793, "post_id": 58621481, "comment_id": 103573128, "body": "Aren&#39;t Modern Charts data defined by a RowSource property? Code can set this property."}, {"owner": {"reputation": 442, "user_id": 5752330, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e1a8a48fab25ee92c157e2b748c4dc3?s=128&d=identicon&r=PG&f=1", "display_name": "zlatko", "link": "https://stackoverflow.com/users/5752330/zlatko"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1572942428, "post_id": 58621481, "comment_id": 103708686, "body": "I need to preserve design-time formatting for data series."}], "answers": [{"tags": [], "owner": {"reputation": 442, "user_id": 5752330, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e1a8a48fab25ee92c157e2b748c4dc3?s=128&d=identicon&r=PG&f=1", "display_name": "zlatko", "link": "https://stackoverflow.com/users/5752330/zlatko"}, "is_accepted": true, "score": 0, "last_activity_date": 1572987834, "creation_date": 1572987834, "answer_id": 58719438, "question_id": 58621481, "link": "https://stackoverflow.com/questions/58621481/including-excluding-columns-in-ms-access-modern-charts-programmatically/58719438#58719438", "title": "Including/excluding columns in MS Access modern charts, programmatically", "body": "<p>The problem is answered here, by Karl Donaubauer: <a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_access-msoffice_custom-mso_2016/includingexcluding-columns-in-ms-access-modern/2d056fad-8eb5-4663-af8b-9774a0514024?tm=1572942297539\" rel=\"nofollow noreferrer\">https://answers.microsoft.com/en-us/msoffice/forum/msoffice_access-msoffice_custom-mso_2016/includingexcluding-columns-in-ms-access-modern/2d056fad-8eb5-4663-af8b-9774a0514024?tm=1572942297539</a>\nRowSource and ChartValues properties have to be set through VBA code, everything else updates automatically, with formatting preserved.</p>\n"}], "owner": {"reputation": 442, "user_id": 5752330, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e1a8a48fab25ee92c157e2b748c4dc3?s=128&d=identicon&r=PG&f=1", "display_name": "zlatko", "link": "https://stackoverflow.com/users/5752330/zlatko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 58719438, "answer_count": 1, "score": 0, "last_activity_date": 1594349359, "creation_date": 1572425182, "last_edit_date": 1594349359, "question_id": 58621481, "link": "https://stackoverflow.com/questions/58621481/including-excluding-columns-in-ms-access-modern-charts-programmatically", "title": "Including/excluding columns in MS Access modern charts, programmatically", "body": "<p>I have a Microsoft Access modern chart with several query columns included. Some of the columns should be dynamically included or excluded programmatically.\nHow can I define, include or exclude certain columns from the modern chart?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1572424811, "post_id": 58621335, "comment_id": 103551003, "body": "Play around with the <code>Offset</code>. Also you are using a explicit sheet reference with a <code>With</code> statement. No need to refer to it again. =)"}, {"owner": {"reputation": 9, "user_id": 10773651, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aBYM6El6veM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iTd-lo6SX4Bm1iwXxPoiYHc0lOSQ/mo/photo.jpg?sz=128", "display_name": "hans smith", "link": "https://stackoverflow.com/users/10773651/hans-smith"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1572425495, "post_id": 58621335, "comment_id": 103551294, "body": "Hi :), I&#39;m still very green to vba. Could you kindly advise how to use offset in this?"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 10773651, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aBYM6El6veM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iTd-lo6SX4Bm1iwXxPoiYHc0lOSQ/mo/photo.jpg?sz=128", "display_name": "hans smith", "link": "https://stackoverflow.com/users/10773651/hans-smith"}, "edited": false, "score": 0, "creation_date": 1572492630, "post_id": 58621641, "comment_id": 103579661, "body": "Wow that&#39;s really great. I noticed that you mentioned that the code will take reference from the last used row (in this case A5). If assuming i have a value copied into A6 using the code. If i run it again (using the same code), will the value be copied to the next available row i.e A7?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 9, "user_id": 10773651, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aBYM6El6veM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iTd-lo6SX4Bm1iwXxPoiYHc0lOSQ/mo/photo.jpg?sz=128", "display_name": "hans smith", "link": "https://stackoverflow.com/users/10773651/hans-smith"}, "edited": false, "score": 0, "creation_date": 1572501538, "post_id": 58621641, "comment_id": 103581467, "body": "Yes it will @Hanssmith =). Please also don&#39;t forget to accept the answer if this has answered your question"}, {"owner": {"reputation": 9, "user_id": 10773651, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aBYM6El6veM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iTd-lo6SX4Bm1iwXxPoiYHc0lOSQ/mo/photo.jpg?sz=128", "display_name": "hans smith", "link": "https://stackoverflow.com/users/10773651/hans-smith"}, "edited": false, "score": 0, "creation_date": 1572504733, "post_id": 58621641, "comment_id": 103582422, "body": "Hi, i tried your code but due to it referring to the last used row in the column, it is skipping the table and pasting the value below it. A1:L1 is a merged cell with a title but A2:L2 is not merged. A4:L4 onwards is where the table starts until A10:L10 but the pasted value comes at the bottom at A11.  Is there any workaround possible?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 9, "user_id": 10773651, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aBYM6El6veM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iTd-lo6SX4Bm1iwXxPoiYHc0lOSQ/mo/photo.jpg?sz=128", "display_name": "hans smith", "link": "https://stackoverflow.com/users/10773651/hans-smith"}, "edited": false, "score": 0, "creation_date": 1572511991, "post_id": 58621641, "comment_id": 103585123, "body": "@hanssmith, I&#39;m not sure what you are after then. Where do you want the values to be pasted?"}, {"owner": {"reputation": 9, "user_id": 10773651, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aBYM6El6veM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iTd-lo6SX4Bm1iwXxPoiYHc0lOSQ/mo/photo.jpg?sz=128", "display_name": "hans smith", "link": "https://stackoverflow.com/users/10773651/hans-smith"}, "edited": false, "score": 0, "creation_date": 1572584019, "post_id": 58621641, "comment_id": 103612799, "body": "Hi JvdV, what i meant is that the code is skipping my table entirely and pasting the figure on the next empty row outside the table. I would like the value to be pasted inside the table. I&#39;ve made outlines on my table, could that be a factor?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 9, "user_id": 10773651, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aBYM6El6veM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iTd-lo6SX4Bm1iwXxPoiYHc0lOSQ/mo/photo.jpg?sz=128", "display_name": "hans smith", "link": "https://stackoverflow.com/users/10773651/hans-smith"}, "edited": false, "score": 0, "creation_date": 1572588869, "post_id": 58621641, "comment_id": 103613665, "body": "@hanssmith an update to your question would be helpful, a picture with how you want your data to be pasted. And what happens now. Visualization is important on this one I guess"}, {"owner": {"reputation": 9, "user_id": 10773651, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aBYM6El6veM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iTd-lo6SX4Bm1iwXxPoiYHc0lOSQ/mo/photo.jpg?sz=128", "display_name": "hans smith", "link": "https://stackoverflow.com/users/10773651/hans-smith"}, "edited": false, "score": 0, "creation_date": 1572609362, "post_id": 58621641, "comment_id": 103620680, "body": "Sure, i have pasted a screenshot of the test code&#39;s paste in my table. Hopefully it will help with the explanation."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 9, "user_id": 10773651, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aBYM6El6veM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iTd-lo6SX4Bm1iwXxPoiYHc0lOSQ/mo/photo.jpg?sz=128", "display_name": "hans smith", "link": "https://stackoverflow.com/users/10773651/hans-smith"}, "edited": false, "score": 0, "creation_date": 1572609947, "post_id": 58621641, "comment_id": 103620928, "body": "I see, you got an actuall table going on then I guess, which will be counted as rows with data. Your table is completely empty, so the easiest for you to do is remove rows from 6 onwards completely. @hanssmith"}, {"owner": {"reputation": 9, "user_id": 10773651, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aBYM6El6veM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iTd-lo6SX4Bm1iwXxPoiYHc0lOSQ/mo/photo.jpg?sz=128", "display_name": "hans smith", "link": "https://stackoverflow.com/users/10773651/hans-smith"}, "edited": false, "score": 0, "creation_date": 1572838221, "post_id": 58621641, "comment_id": 103672451, "body": "does that mean that I will need to manually create the table outlines once my data has been copied over? There&#39;s no workaround for this using the code provided?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 9, "user_id": 10773651, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aBYM6El6veM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iTd-lo6SX4Bm1iwXxPoiYHc0lOSQ/mo/photo.jpg?sz=128", "display_name": "hans smith", "link": "https://stackoverflow.com/users/10773651/hans-smith"}, "edited": false, "score": 0, "creation_date": 1572847299, "post_id": 58621641, "comment_id": 103674139, "body": "@hanssmith, if you use an actual table then the rows will be counted. Otherwise they won&#39;t. Maybe to prevent any more communication back and forth, you should share a sample of your workbook so I can take a look"}, {"owner": {"reputation": 9, "user_id": 10773651, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aBYM6El6veM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iTd-lo6SX4Bm1iwXxPoiYHc0lOSQ/mo/photo.jpg?sz=128", "display_name": "hans smith", "link": "https://stackoverflow.com/users/10773651/hans-smith"}, "edited": false, "score": 0, "creation_date": 1572930977, "post_id": 58621641, "comment_id": 103704658, "body": "I&#39;d be happy to! How shall I share it to you? Is the option available on this site?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 9, "user_id": 10773651, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aBYM6El6veM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iTd-lo6SX4Bm1iwXxPoiYHc0lOSQ/mo/photo.jpg?sz=128", "display_name": "hans smith", "link": "https://stackoverflow.com/users/10773651/hans-smith"}, "edited": false, "score": 0, "creation_date": 1572936156, "post_id": 58621641, "comment_id": 103706209, "body": "No, you&#39;ll have to out up a link yourself. There should be some websites that let you share files through a link"}, {"owner": {"reputation": 9, "user_id": 10773651, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aBYM6El6veM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iTd-lo6SX4Bm1iwXxPoiYHc0lOSQ/mo/photo.jpg?sz=128", "display_name": "hans smith", "link": "https://stackoverflow.com/users/10773651/hans-smith"}, "edited": false, "score": 0, "creation_date": 1573024107, "post_id": 58621641, "comment_id": 103741166, "body": "Managed to find some sites but my company&#39;s internet keeps blocking them. I&#39;ll have to figure this out on my own i guess. But your code earlier and explanation really helped me understand alot about how it works, at least now I have a point to start from. :)"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 9, "user_id": 10773651, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aBYM6El6veM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iTd-lo6SX4Bm1iwXxPoiYHc0lOSQ/mo/photo.jpg?sz=128", "display_name": "hans smith", "link": "https://stackoverflow.com/users/10773651/hans-smith"}, "edited": false, "score": 0, "creation_date": 1573024442, "post_id": 58621641, "comment_id": 103741312, "body": "@hanssmith. Last pointer for you, if you really have a table object. Then look at the clues in the official documentation on a Lustobject. How to refer to them, how to count their rows etc. This was why I wanted to have a look at your file. Tough luck it is blocked hey"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 0, "last_activity_date": 1572425819, "creation_date": 1572425819, "answer_id": 58621641, "question_id": 58621335, "link": "https://stackoverflow.com/questions/58621335/how-do-i-command-vba-to-start-pasting-from-a-specific-cell-onwards/58621641#58621641", "title": "How do I command vba to start pasting from a specific cell onwards?", "body": "<p>Small example on <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.offset\" rel=\"nofollow noreferrer\"><code>.Offset</code></a></p>\n\n<p>Imagine the following setup:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Io53U.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Io53U.png\" alt=\"enter image description here\"></a></p>\n\n<p>You got a specific line of code in your question that will refer to the last used row in a column: <code>sht2.Cells(Rows.Count, 1).End(xlUp)</code> which normally get followed by <code>.Row</code> to refer to a position. Now what <code>.Offset</code> does is looking at this position and using an <code>Index</code> for both an <code>Row</code> and <code>Column</code> offset (see documentation) you can refer to another cell, relative to the found cell. (I hope that's clear)</p>\n\n<p>So in the case above, I can put a value in <code>A7</code> by writing:</p>\n\n<pre><code>sht2.Cells(Rows.Count, 1).End(xlUp).Offset(2).Value = \"TestValue\"\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/69EcM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/69EcM.png\" alt=\"enter image description here\"></a></p>\n\n<p>Meaning, to write a value in <code>A10</code> I would need to use (if <code>A7</code> was still empty):</p>\n\n<pre><code>sht2.Cells(Rows.Count, 1).End(xlUp).Offset(5).Value = \"TestValue\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 10773651, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aBYM6El6veM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iTd-lo6SX4Bm1iwXxPoiYHc0lOSQ/mo/photo.jpg?sz=128", "display_name": "hans smith", "link": "https://stackoverflow.com/users/10773651/hans-smith"}, "is_accepted": false, "score": 0, "last_activity_date": 1572609184, "creation_date": 1572609184, "answer_id": 58658808, "question_id": 58621335, "link": "https://stackoverflow.com/questions/58621335/how-do-i-command-vba-to-start-pasting-from-a-specific-cell-onwards/58658808#58658808", "title": "How do I command vba to start pasting from a specific cell onwards?", "body": "<p>JvdV,</p>\n\n<p>This is a screenshot of my test with the suggested code.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ooPbT.png\" rel=\"nofollow noreferrer\">Code test in table</a></p>\n\n<p>My aim is to have the figures pasted in the orange row but its skipping the table to paste in the yellow row.</p>\n"}], "owner": {"reputation": 9, "user_id": 10773651, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aBYM6El6veM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iTd-lo6SX4Bm1iwXxPoiYHc0lOSQ/mo/photo.jpg?sz=128", "display_name": "hans smith", "link": "https://stackoverflow.com/users/10773651/hans-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 58621641, "answer_count": 2, "score": 0, "last_activity_date": 1572609184, "creation_date": 1572424597, "last_edit_date": 1572425827, "question_id": 58621335, "link": "https://stackoverflow.com/questions/58621335/how-do-i-command-vba-to-start-pasting-from-a-specific-cell-onwards", "title": "How do I command vba to start pasting from a specific cell onwards?", "body": "<p>I recently received some great code from one of our fellow users for my copy and paste issue earlier.</p>\n\n<p>This is the help provided after I added in my cell numbers.</p>\n\n<pre><code>Dim sht1 As Worksheet, sht2 As Worksheet\n\nSet sht1 = Worksheets(\"Calculation\")\nSet sht2 = Worksheets(\"Current\")\n\nWith sh2\n\nsht2.Cells(Rows.Count, 1).End(xlUp).Offset(1).Value = sht1.Range(\"A1448\").Value\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>I'm currently trying to use it for another sheet, but the challenge is that I would like it to start from row 5 onward as it's a table. Initially, I thought to use:</p>\n\n<pre><code>Sheets(\"Current\").Select\nRange(\"A5\").Select\n</code></pre>\n\n<p>but no luck. Any advice will be great help on this as the copy and paste code  allows my data collection to run so much faster than before.</p>\n"}, {"tags": ["arrays", "excel", "vba", "charts", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1572434521, "post_id": 58623221, "comment_id": 103556229, "body": "thanks. The refresh appears to work, but when i saveAs and open the pptx file and then see the charts on the slides, some category Axis labels are missing (last ones below), chart&#39;s bar color formatting disappears and bars show up in orange color instead of ppt template blue colors. Now, when i try to edit the chart data, the values revert to the <code>dummy values</code> again. What is still missing here?"}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1572441085, "post_id": 58623221, "comment_id": 103559849, "body": "the Category Axis labels now show up correctly after applying the above line in edit. But once the pptx is generated and i try to edit the chart data on any slide chart, the data dissapears and is replaced by old dummy data. Why is this happening and how to resolve it?"}, {"owner": {"reputation": 323, "user_id": 12089232, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCfPL0FhSRKDbRwRWWDzMUtNrVlMgKovxcm8ZNZ=k-s128", "display_name": "Dhirendra Kumar", "link": "https://stackoverflow.com/users/12089232/dhirendra-kumar"}, "reply_to_user": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1572504507, "post_id": 58623221, "comment_id": 103582361, "body": "I cannot re-generate the issue. It is working fine at my end. Maybe you can share your complete updated script to out any glitch."}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1572515075, "post_id": 58623221, "comment_id": 103586615, "body": "After the update I made using resize with array unbounds, it is working. However, after saving pptx file, if i go and edit any chart, it loses array values and  reverts to original Values. Are you getting the same issue? Looks like a PowerPoint 2016 bug."}], "tags": [], "owner": {"reputation": 323, "user_id": 12089232, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCfPL0FhSRKDbRwRWWDzMUtNrVlMgKovxcm8ZNZ=k-s128", "display_name": "Dhirendra Kumar", "link": "https://stackoverflow.com/users/12089232/dhirendra-kumar"}, "is_accepted": false, "score": 1, "last_activity_date": 1572431047, "creation_date": 1572431047, "answer_id": 58623221, "question_id": 58621028, "link": "https://stackoverflow.com/questions/58621028/resize-powerpoint-chart-chartdata-range-and-transfer-excel-chart-data-values-as/58623221#58623221", "title": "Resize Powerpoint Chart ChartData range and transfer Excel Chart data values as Array", "body": "<p>You may try following code to before closing the chart data sheet to refresh the data range for chart:</p>\n\n<pre><code>pcht.SetSourceData ChtData.Workbook.Sheets(1).UsedRange.Address(External:=True)\n</code></pre>\n"}], "owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1572438676, "creation_date": 1572423291, "last_edit_date": 1572438676, "question_id": 58621028, "link": "https://stackoverflow.com/questions/58621028/resize-powerpoint-chart-chartdata-range-and-transfer-excel-chart-data-values-as", "title": "Resize Powerpoint Chart ChartData range and transfer Excel Chart data values as Array", "body": "<p>I have <code>Clustered Bar charts</code> created in an Excel sheet of varying ranges. I am using a <code>Powerpoint deck</code> as a template, consisting of a <code>Clustered Bar chart</code> on a slide. I am duplicating the Slide chart and tranfering each Excel Chart's SeriesCollection as an Array and trying to resize the Powerpoint Charts ChartData range to the array's ubounds. </p>\n\n<ol>\n<li>The below code works, but the ChartData range doesn't resize and some of the data is missing. I tried clearing the ChartData range before transfering array - to clear dummy values in chart, but still it does not resize and sometimes old dummy values of chart still show.</li>\n<li>I have also commmented the <code>ChartData.Activate</code> lines as it flickers the screen even after applying <code>Application.screenupdating=false</code>.</li>\n<li>I had to declare the <code>Shp</code> as an Object and not as a <code>Shape</code> as strangely, it was not giving me a handle to the ChartData. Same goes for <code>oCht</code>, <code>pCht</code> and <code>ChtData</code>.</li>\n</ol>\n\n<p>I am using Excel 2016 Pro (64-bit) with PowerPoint 2016 (64-bit) on a Windows 10 Enterprise (64-bit) machine. Any assistance on what or where i am doing wrong, would be most appreciated.</p>\n\n<pre><code>Dim sFormula As String\nDim rFirst As Range, rLast As Range\nDim arr\nDim oPPT As Object\nDim oPres As Object\nDim oSlide As Object\nDim oCht As ChartObject\nDim Shp As Object\nDim pCht As Object\nDim ChtData As Object 'ChartData\n\nWith shtSheetName\n    For Each oCht In .ChartObjects\n        With oCht.Chart\n            sFormula = .SeriesCollection(1).Formula\n            Set rFirst = Range(Split(sFormula, \",\")(2))(1)\n            sFormula = .SeriesCollection(.SeriesCollection.Count).Formula\n            Set rLast = Range(Split(sFormula, \",\")(2)).Item(Range(Split(sFormula, \",\")(2)).Count)\n\n            With Range(rFirst, rLast)\n                arr = .Offset(0, -1).Resize(.Rows.Count + 1, .Columns.Count + 1).Value2\n            End With\n            With oPres\n                Set oSlide = .slides(\"Slide0_SlideName\").Duplicate\n                With oSlide\n                    .Select\n                    .moveto oPres.slides.Count\n                    For Each Shp In .Shapes\n                        If Shp.HasChart = True Then\n                            Set pCht = Shp.Chart\n                            Set ChtData = pCht.ChartData\n                            With ChtData\n                                .Activate\n                                .Workbook.Application.WindowState = -4140\n                   .Workbook.Sheets(\"PTSht\").UsedRange.Offset(1, 0).ClearContents\n                   .Workbook.Sheets(\"PTSht\").UsedRange.Offset(1, 0).Resize(UBound(arr, 1), UBound(arr, 2)).Value2 = arr\n                                pCht.SetSourceData .Workbook.Sheets(\"PTSht\").UsedRange.Resize(UBound(arr, 1), UBound(arr, 2)).Address(, , , External:=True)   'EDIT as per Dhirendra Kumar's solution\n                                .Workbook.Close\n                            End With\n                            Exit For\n                        End If\n                    Next Shp\n                End With\n            End With\n        End With\n    Next oCht\nEnd With\n...\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1572422133, "post_id": 58620699, "comment_id": 103549881, "body": "Have you tried defining your arrays to hold the ranges as <code>Variant</code>"}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 9084972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fba165241b3e05366678ae2958840f3?s=128&d=identicon&r=PG&f=1", "display_name": "Khairulanam Abdullah", "link": "https://stackoverflow.com/users/9084972/khairulanam-abdullah"}, "edited": false, "score": 0, "creation_date": 1572422913, "post_id": 58620779, "comment_id": 103550190, "body": "How do I call the array? I try to put the first state in the same worksheet in C2.  Range(&quot;C2&quot;) = State(1) and its shows error."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 1, "last_activity_date": 1572424004, "last_edit_date": 1572424004, "creation_date": 1572422111, "answer_id": 58620779, "question_id": 58620699, "link": "https://stackoverflow.com/questions/58620699/get-value-from-another-sheets-and-put-it-in-array/58620779#58620779", "title": "Get value from another sheets and put it in array", "body": "<p>Use something along these lines:</p>\n\n<pre><code>Dim ws As Worksheet: Set ws = Sheets(\"State&amp;City\")\nDim State As Variant, City as Variant\nDim LastRow As Long\n\nWith ws\n    LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    State = .Range(\"A2:A\" &amp; LastRow)\n    City = .Range(\"B2:B\" &amp; LastRow)\nEnd With\n</code></pre>\n\n<ul>\n<li>So we pulled values into a <code>Variant</code> array</li>\n<li>We used an explicit sheet reference and avoided <code>.Select</code></li>\n</ul>\n\n<p>Note: These are two-dimensional arrays, so in above case you can refer to an item like <code>.Range(\"C2\") = State(1,1)</code> or for the nth item: <code>.Range(\"C2\") = State(n,1)</code></p>\n\n<hr>\n\n<p><strong>Alternatively:</strong></p>\n\n<p>Pull the values into a single array, e.g.: <code>StateCity</code></p>\n\n<pre><code>Dim ws As Worksheet: Set ws = Sheets(\"State&amp;City\")\nDim StateCity as variant\nDim LastRow As Long\n\nWith ws\n    LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    StateCity = .Range(\"A2:B\" &amp; LastRow)\nEnd With\n</code></pre>\n\n<p>You can now refer to the nth state with:</p>\n\n<pre><code>.Range(\"C2\") = StateCity (n,1)\n</code></pre>\n\n<p>Or refer to the nth city with:</p>\n\n<pre><code>.Range(\"C2\") = StateCity (n,2)\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 9084972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fba165241b3e05366678ae2958840f3?s=128&d=identicon&r=PG&f=1", "display_name": "Khairulanam Abdullah", "link": "https://stackoverflow.com/users/9084972/khairulanam-abdullah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 58620779, "answer_count": 1, "score": 1, "last_activity_date": 1572424004, "creation_date": 1572421814, "last_edit_date": 1572422037, "question_id": 58620699, "link": "https://stackoverflow.com/questions/58620699/get-value-from-another-sheets-and-put-it-in-array", "title": "Get value from another sheets and put it in array", "body": "<p>I'm new to vba. I want to get all state and city list from another sheet. Then put it in State and City array. But I got error at state array, \nRun-time error '13'. Type mismatch.</p>\n\n<pre><code>Dim State() As String\nDim City() As String\nDim LastRow As Long\n\nSheets(\"State&amp;City\").Select\nLastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n-&gt;State() = Range(\"A2:A\" &amp; LastRow).Value\nCity() = Range(\"B2:B\" &amp; LastRow).Value\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1572424910, "post_id": 58620643, "comment_id": 103551034, "body": "Do you know its name? If so, it&#39;s simple."}, {"owner": {"reputation": 228, "user_id": 4216021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dab71f9dbaf2788463adc85da03061ea?s=128&d=identicon&r=PG&f=1", "display_name": "Bilal", "link": "https://stackoverflow.com/users/4216021/bilal"}, "edited": false, "score": 0, "creation_date": 1572424947, "post_id": 58620643, "comment_id": 103551051, "body": "Could you provide the code you&#39;re using to make the sheet visible to give some more clarification? or perhaps use something like this           Dim WS As Worksheet:     For Each WS In Sheets:         If WS.Index &lt;&gt; ActiveSheet.Index And WS.Visible = xlSheetVisible Then WS.Activate:     Next:"}], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 0, "last_activity_date": 1572429628, "last_edit_date": 1572429628, "creation_date": 1572429072, "answer_id": 58622636, "question_id": 58620643, "link": "https://stackoverflow.com/questions/58620643/activate-the-last-active-sheet-visible/58622636#58622636", "title": "Activate the last active sheet visible", "body": "<blockquote>\n  <p>how do I write a code which activates that sheet that just has become visible</p>\n</blockquote>\n\n<p>You can store the sheet that you are unhiding in an object and then activate</p>\n\n<p>For example</p>\n\n<pre><code>Private ws As Worksheet\n\nSub UnhideCode()\n    '&lt;~~ Just an example since I do not know how you are unhiding\n    If pass = \"OK\" Then \n        Set ws = Sheet1 '&lt;~~ Change this to the relevant sheet\n        ws.Visible = xlSheetVisible\n    End If\nEnd Sub\n\nSub MoveNext()\n    If Not ws is Nothing then ws.Activate\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14, "user_id": 10379082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/291f9439d0c06b2549ac372c487230cf?s=128&d=identicon&r=PG&f=1", "display_name": "Neelavathy", "link": "https://stackoverflow.com/users/10379082/neelavathy"}, "is_accepted": true, "score": 0, "last_activity_date": 1572436576, "creation_date": 1572436576, "answer_id": 58624845, "question_id": 58620643, "link": "https://stackoverflow.com/questions/58620643/activate-the-last-active-sheet-visible/58624845#58624845", "title": "Activate the last active sheet visible", "body": "<p>Declare Global variables in separate module </p>\n\n<p>say , </p>\n\n<p>Global Const g_sPassword As String = \"password\"</p>\n\n<p>on the next module where you need to code ,do it as below</p>\n\n<p>'mention only sheets that should be visible ,other sheets will be automatically hided</p>\n\n<p>Sub OpenSheet(sSheetName As String)</p>\n\n<pre><code>Dim shtSheetToOpen As Worksheet, shtLoopSheet As Worksheet\n\nSet shtSheetToOpen = ThisWorkbook.Sheets(sSheetName)\nApplication.ScreenUpdating = False\nshtSheetToOpen.Visible = xlSheetVisible\nFor Each shtLoopSheet In ThisWorkbook.Sheets\n    If shtLoopSheet.Name &lt;&gt; shtSheetToOpen.Name And shtLoopSheet.Name &lt;&gt; \"Sheets to be visible\"   Then\n       shtLoopSheet.Visible = xlVeryHidden\n    End If\nNext shtLoopSheet\nshtSheetToOpen.Activate\n\nSet shtSheetToOpen = Nothing\nSet shtLoopSheet = Nothing\n</code></pre>\n\n<p>End Sub</p>\n\n<p>' then include the below code</p>\n\n<p>Sub OpenSample()</p>\n\n<p>Dim sUserInput As String</p>\n\n<pre><code>sUserInput = InputBox(\"Please enter password\", \"Password Prompt\", \"\")\n\nIf sUserInput =  g_sPassword Then\n    MsgBox \"Access Granted\", vbInformation, \"Access\"\n    Call OpenSheet(\"Sheetsname\")\n    sheetname.Activate\nElse\n    MsgBox \"Incorrect Password.Please try again\", vbCritical, \"Error\"\nEnd If\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 9, "user_id": 9373960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dafa69d253a277ea6b88fa7c4edfa173?s=128&d=identicon&r=PG&f=1", "display_name": "Santis789", "link": "https://stackoverflow.com/users/9373960/santis789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 58624845, "answer_count": 2, "score": 0, "last_activity_date": 1572445015, "creation_date": 1572421610, "last_edit_date": 1572424863, "question_id": 58620643, "link": "https://stackoverflow.com/questions/58620643/activate-the-last-active-sheet-visible", "title": "Activate the last active sheet visible", "body": "<p>I currently have a workbook that contains several 'veryhidden' sheets, which only will become visible when the correct password has been entered. However, in the case that the correct password is entered, how do I write a code which activates that sheet that just has become visible, i.e. Excel needs to ignore all the 'veryhidden' ones.</p>\n\n<p>I have tried the code:</p>\n\n<pre><code>Sub MoveNext()\nOn Error Resume Next\nSheets(ActiveSheet.Index + 1).Activate\nIf Err.Number &lt;&gt; 0 Then Sheets(1).Activate\nEnd Sub\n</code></pre>\n\n<p>However, this does not work. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1572418009, "post_id": 58619868, "comment_id": 103548373, "body": "Where is the code you have tried and what problems are you having with it?"}, {"owner": {"reputation": 1598, "user_id": 2970853, "user_type": "registered", "profile_image": "https://graph.facebook.com/507188635/picture?type=large", "display_name": "henrywongkk", "link": "https://stackoverflow.com/users/2970853/henrywongkk"}, "edited": false, "score": 0, "creation_date": 1572418037, "post_id": 58619868, "comment_id": 103548382, "body": "a while loop along each row will work, what did you try so far?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1572418045, "post_id": 58619868, "comment_id": 103548385, "body": "No VBA needed, there are some very user friendly build in functions to tackle this. Also, please include your own attempt and tell us where you got stuck. Look at <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> a question with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 37, "user_id": 11959193, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mC4gGeM7cCBbfRh3T_CV0YuHjQD4m77JEYMxpfnxQ=k-s128", "display_name": "ANKIT BISHT", "link": "https://stackoverflow.com/users/11959193/ankit-bisht"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1572418299, "post_id": 58619868, "comment_id": 103548465, "body": "@JvdV I completely understand that my question is vague but the reason I asked it because I don&#39;t know VBA and I am stuck with a real life problem. When I googled and looked for the answer, VBA seemed to be a common answer. Hence my question"}, {"owner": {"reputation": 37, "user_id": 11959193, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mC4gGeM7cCBbfRh3T_CV0YuHjQD4m77JEYMxpfnxQ=k-s128", "display_name": "ANKIT BISHT", "link": "https://stackoverflow.com/users/11959193/ankit-bisht"}, "reply_to_user": {"reputation": 1598, "user_id": 2970853, "user_type": "registered", "profile_image": "https://graph.facebook.com/507188635/picture?type=large", "display_name": "henrywongkk", "link": "https://stackoverflow.com/users/2970853/henrywongkk"}, "edited": false, "score": 0, "creation_date": 1572418415, "post_id": 58619868, "comment_id": 103548506, "body": "@henrywongkk I am sorry but I did not try anything as I have no knowledge of VBA but I do know that this problem of mine can be solved by VBA"}, {"owner": {"reputation": 37, "user_id": 11959193, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mC4gGeM7cCBbfRh3T_CV0YuHjQD4m77JEYMxpfnxQ=k-s128", "display_name": "ANKIT BISHT", "link": "https://stackoverflow.com/users/11959193/ankit-bisht"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1572418464, "post_id": 58619868, "comment_id": 103548521, "body": "@braX hi I have zero knowledge of VBA but have an idea that this can be resolved by it, hence thought of asking VBA experts. Need help"}, {"owner": {"reputation": 37, "user_id": 11959193, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mC4gGeM7cCBbfRh3T_CV0YuHjQD4m77JEYMxpfnxQ=k-s128", "display_name": "ANKIT BISHT", "link": "https://stackoverflow.com/users/11959193/ankit-bisht"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1572418651, "post_id": 58619868, "comment_id": 103548588, "body": "@JvdV no I totally understand that but I tried to resolve it but just couldn&#39;t solve it. I don&#39;t work with excel much, I need this excel sheet for my python work. This was one problem I wanted to solve before using the sheet for python. Hence my low knowledge on excel. If there is any way apart from excel then please just let me know what it is, I will then google it and work on my own"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1572419033, "post_id": 58619868, "comment_id": 103548733, "body": "If you tried it, then include your attempt. Anything is better than nothing."}, {"owner": {"reputation": 37, "user_id": 11959193, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mC4gGeM7cCBbfRh3T_CV0YuHjQD4m77JEYMxpfnxQ=k-s128", "display_name": "ANKIT BISHT", "link": "https://stackoverflow.com/users/11959193/ankit-bisht"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1572419398, "post_id": 58619868, "comment_id": 103548851, "body": "@JvdV I have included the code and I know it&#39;s wrong on many levels but that was the reason I didn&#39;t include it, not that I want others to do my code. If you could advice anything even if its inbuilt function then that would be a great help too"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 11959193, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mC4gGeM7cCBbfRh3T_CV0YuHjQD4m77JEYMxpfnxQ=k-s128", "display_name": "ANKIT BISHT", "link": "https://stackoverflow.com/users/11959193/ankit-bisht"}, "edited": false, "score": 0, "creation_date": 1572420170, "post_id": 58620266, "comment_id": 103549121, "body": "Thanks a lot that resolved my problem. Will next time post questions in a better way."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1572421991, "post_id": 58620266, "comment_id": 103549802, "body": "@JvdV I just tried this, but didn&#39;t work on my Excel. Could it be because of the spanish version?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1572422207, "post_id": 58620266, "comment_id": 103549917, "body": "The last one, just found it on the internet, need to hit Ctrl + Enter, Ctrl + D doesn&#39;t work for me. Instead typing the formula and Enter, if you press Ctrl + Enter will spare you the last step @JvdV."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1572422282, "post_id": 58620266, "comment_id": 103549940, "body": "That&#39;s nice information. I wasn&#39;t aware that this would depend on Locale. And pressing <code>CTRL</code>+<code>ENTER</code> is even better ;). I edited the answer (less steps is even better). Thanks"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 1, "last_activity_date": 1572422425, "last_edit_date": 1572422425, "creation_date": 1572419887, "answer_id": 58620266, "question_id": 58619868, "link": "https://stackoverflow.com/questions/58619868/how-can-i-copy-one-cell-data-in-a-column-and-then-paste-it-untill-another-value/58620266#58620266", "title": "How can i copy one cell data in a column and then paste it untill another value comes in the column through VBA?", "body": "<p>Avoid VBA in case you not sure how to use it in the first place. There are many cool build-in features to assist you in a case like yours:</p>\n\n<ul>\n<li>Select range <code>B1:B17</code></li>\n<li>Goto tab <code>Start</code> > Select <code>Find &amp; Select</code> > Choose <code>Go To Special</code> > Choose <code>Blanks</code></li>\n<li>Now all empty cells in your range are selected with cursor in top one. Type <code>=B2</code> and hit key-combo <kbd>Ctrl</kbd>+<kbd>Enter</kbd></li>\n</ul>\n"}], "owner": {"reputation": 37, "user_id": 11959193, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mC4gGeM7cCBbfRh3T_CV0YuHjQD4m77JEYMxpfnxQ=k-s128", "display_name": "ANKIT BISHT", "link": "https://stackoverflow.com/users/11959193/ankit-bisht"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 58620266, "answer_count": 1, "score": 0, "last_activity_date": 1572422425, "creation_date": 1572417748, "last_edit_date": 1572419294, "question_id": 58619868, "link": "https://stackoverflow.com/questions/58619868/how-can-i-copy-one-cell-data-in-a-column-and-then-paste-it-untill-another-value", "title": "How can i copy one cell data in a column and then paste it untill another value comes in the column through VBA?", "body": "<p>The code I used</p>\n\n<pre><code>Sub copypaste()\n'\n' copypaste Macro\n'\n\n'\n    Range(\"B2:B8\").Select\n    Application.CutCopyMode = False\n    Selection.FillDown\n    Range(\"B9:B10\").Select\n    Selection.FillDown\n    Range(\"B11:B13\").Select\n    Selection.FillDown\nEnd Sub\n</code></pre>\n\n<p>I have this sheet:</p>\n\n<p><a href=\"https://i.stack.imgur.com/klSz3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/klSz3.png\" alt=\"enter image description here\"></a></p>\n\n<p>And I want output through VBA code as my actual sheet is very big like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/E3H2d.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/E3H2d.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 11854924, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WM98ZFdK39s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdO8nmmqeWuynleCi3FtGk5ckiMrg/photo.jpg?sz=128", "display_name": "Darren", "link": "https://stackoverflow.com/users/11854924/darren"}, "edited": false, "score": 0, "creation_date": 1572418613, "post_id": 58619923, "comment_id": 103548576, "body": "Thank you very much Michal! it worked and i really appreciate your help. thank you once again."}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": true, "score": 0, "last_activity_date": 1572418023, "creation_date": 1572418023, "answer_id": 58619923, "question_id": 58619767, "link": "https://stackoverflow.com/questions/58619767/summation-of-two-rows-and-paste-it-to-another-workbook-in-one-column/58619923#58619923", "title": "Summation of two rows and paste it to another workbook in one column", "body": "<p>Try below:</p>\n\n<pre><code>Sub SumValues()\n    Set sourceSheet = Worksheets(\"sheets with rows to sum\")\n    Set destSheet = Worksheets(\"sheet where results should pasted\")\n    For i = 3 To 12\n        ' Write results to destSheet, starting in cell A1\n        destSheet.Cells(i - 2, 1) = sourceSheet.Cells(26, i) + sourceSheet.Cells(27, i)\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 11854924, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WM98ZFdK39s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdO8nmmqeWuynleCi3FtGk5ckiMrg/photo.jpg?sz=128", "display_name": "Darren", "link": "https://stackoverflow.com/users/11854924/darren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 58619923, "answer_count": 1, "score": 0, "last_activity_date": 1572424842, "creation_date": 1572417167, "last_edit_date": 1572424842, "question_id": 58619767, "link": "https://stackoverflow.com/questions/58619767/summation-of-two-rows-and-paste-it-to-another-workbook-in-one-column", "title": "Summation of two rows and paste it to another workbook in one column", "body": "<p>Hello I have an issue with the summation of 2 rows and paste it to another workbook in a column. </p>\n\n<p>meaning lets say </p>\n\n<ul>\n<li>row 26,column 3 adding row 27,column 3 value</li>\n<li>row 26,column 4 adding row 27,column 4 value</li>\n<li><p>and so on until column 12</p></li>\n<li><p>3 4 5 6 7 row</p></li>\n<li><p>2 6 7 8 9 row</p></li>\n<li><p>column</p></li>\n<li>5</li>\n<li>10</li>\n<li>12</li>\n<li>14</li>\n<li>16</li>\n</ul>\n\n<p>I've tried separating the x source range summing up and trying pasting over but it could not work.</p>\n\n<p>It says </p>\n\n<blockquote>\n  <p>run-time error '13':type mismatch </p>\n</blockquote>\n\n<p>This is my code:</p>\n\n<pre><code>Sub transfer()\nDim x As Workbook\nDim y As Workbook\nDim sourceRange As Excel.Range\nDim targetRange As Excel.Range\n\n\n\n'## Open both workbooks first:\n\nSet x = Workbooks(\"Svc-Op KPI Overall-6c.xlsm\")\n\nSet y = Workbooks(\"SEA Aftermarket Dashboard - Civic - Copy.xlsm\")\n\n\n Set sourceRange = x.Sheets(\"Monthly\").Range(Cells(26, 3), Cells(26, 14)) + x.Sheets(\"Monthly\").Range(Cells(27, 3), Cells(27, 14))\n\n Set targetRange = y.Sheets(\"Data\").Cells(38, 3)\n  targetRange.PasteSpecial Paste:=xlPasteValues,Operation:=xlNone,SkipBlanks:=False, Transpose:=True\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1572416831, "post_id": 58619307, "comment_id": 103548041, "body": "There&#39;s a lot of repetition, and your ranges should be scoped to a specific sheet object, otherwise your code will not be robust.  Try factoring out the CountIfs into a separate function."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1572416914, "post_id": 58619307, "comment_id": 103548069, "body": "The last part reduces to <code>Range(&quot;G5:G14&quot;).FormulaR1C1 = &quot;=RC[-2]&#47;RC[-3]&quot;</code>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1572433158, "post_id": 58619307, "comment_id": 103555489, "body": "You might benefit from reading  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 12295047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2810cef236e9fb5c00ea69df89701d9?s=128&d=identicon&r=PG&f=1", "display_name": "Cobber", "link": "https://stackoverflow.com/users/12295047/cobber"}, "edited": false, "score": 0, "creation_date": 1572417947, "post_id": 58619833, "comment_id": 103548353, "body": "Wow, so quick. Just to clarify, I still need all the rows I used where you say &#39;other counts here, but your method makes it better? I&#39;ll give it a go, thanks."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 33, "user_id": 12295047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2810cef236e9fb5c00ea69df89701d9?s=128&d=identicon&r=PG&f=1", "display_name": "Cobber", "link": "https://stackoverflow.com/users/12295047/cobber"}, "edited": false, "score": 0, "creation_date": 1572418059, "post_id": 58619833, "comment_id": 103548390, "body": "Yes - you need to add your other counts - I just gave the first 3 as an example"}, {"owner": {"reputation": 33, "user_id": 12295047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2810cef236e9fb5c00ea69df89701d9?s=128&d=identicon&r=PG&f=1", "display_name": "Cobber", "link": "https://stackoverflow.com/users/12295047/cobber"}, "edited": false, "score": 0, "creation_date": 1572480322, "post_id": 58619833, "comment_id": 103577279, "body": "Hi, I tried your code but it bugs out at With ThisWorkbook.Sheets(2). Run Time error 9 subscript out of range. I assumed the top part was a Sub and the bottom part a Function. Can you let me know what I&#39;ve done wrong. Is your code better because it stores the count on the computer and fills in the range in one go as opposed to my code that jumps from sheet to sheet after each row of code? I tried to copy the code in here but it&#39;s too long, would you be able to re-send the code with a dummy sub before and after your code so I can see how it should look. Sorry, but I&#39;m a complete novice, cheers"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 33, "user_id": 12295047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2810cef236e9fb5c00ea69df89701d9?s=128&d=identicon&r=PG&f=1", "display_name": "Cobber", "link": "https://stackoverflow.com/users/12295047/cobber"}, "edited": false, "score": 0, "creation_date": 1572481549, "post_id": 58619833, "comment_id": 103577529, "body": "Can you share a copy of your workbook?  If you&#39;re totally new to VBA then I&#39;m not going to be able to help piece-by-piece: there&#39;s just too much I&#39;d have to spell out."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 33, "user_id": 12295047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2810cef236e9fb5c00ea69df89701d9?s=128&d=identicon&r=PG&f=1", "display_name": "Cobber", "link": "https://stackoverflow.com/users/12295047/cobber"}, "edited": false, "score": 0, "creation_date": 1572488862, "post_id": 58619833, "comment_id": 103578987, "body": "You can host it on dropbox/box/gdrive/onedrive etc and share the link"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 33, "user_id": 12295047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2810cef236e9fb5c00ea69df89701d9?s=128&d=identicon&r=PG&f=1", "display_name": "Cobber", "link": "https://stackoverflow.com/users/12295047/cobber"}, "edited": false, "score": 0, "creation_date": 1572491068, "post_id": 58619833, "comment_id": 103579347, "body": "That&#39;s on your computer"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 33, "user_id": 12295047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2810cef236e9fb5c00ea69df89701d9?s=128&d=identicon&r=PG&f=1", "display_name": "Cobber", "link": "https://stackoverflow.com/users/12295047/cobber"}, "edited": false, "score": 0, "creation_date": 1572492177, "post_id": 58619833, "comment_id": 103579562, "body": "OK I will take a look in a little while"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 33, "user_id": 12295047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2810cef236e9fb5c00ea69df89701d9?s=128&d=identicon&r=PG&f=1", "display_name": "Cobber", "link": "https://stackoverflow.com/users/12295047/cobber"}, "edited": false, "score": 0, "creation_date": 1572493578, "post_id": 58619833, "comment_id": 103579842, "body": "There too much code there - 6k lines in a single module - I can&#39;t even make a dent on this.  If you can point to one specific part I will make some suggestions.  In general I see a whole bunch of repeated operations such as setting the same set of column widths - you need to factor out code like that into standalone procedures and pass in specific ranges as arguments.  That&#39;s the only way this is going to be maintainable in the long run. Also a bunch of &quot;select a range/operate on selection&quot; which could just be &quot;operate on range&quot; similar to my second comment on your question."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 33, "user_id": 12295047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2810cef236e9fb5c00ea69df89701d9?s=128&d=identicon&r=PG&f=1", "display_name": "Cobber", "link": "https://stackoverflow.com/users/12295047/cobber"}, "edited": false, "score": 0, "creation_date": 1572493632, "post_id": 58619833, "comment_id": 103579851, "body": "A lot of your code could be replaced by using some template worksheets which you can just copy as needed - no need to code all that setup."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 33, "user_id": 12295047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2810cef236e9fb5c00ea69df89701d9?s=128&d=identicon&r=PG&f=1", "display_name": "Cobber", "link": "https://stackoverflow.com/users/12295047/cobber"}, "edited": false, "score": 0, "creation_date": 1572494881, "post_id": 58619833, "comment_id": 103580105, "body": "I wouldn&#39;t say it will crash - it will likely work fine but it will be a bit of a nightmare if you need to change anything."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 33, "user_id": 12295047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2810cef236e9fb5c00ea69df89701d9?s=128&d=identicon&r=PG&f=1", "display_name": "Cobber", "link": "https://stackoverflow.com/users/12295047/cobber"}, "edited": false, "score": 0, "creation_date": 1572495278, "post_id": 58619833, "comment_id": 103580179, "body": "Sorry I can&#39;t do anything with this which would be useful to you - if your VBA is early-level then anything I write will be over-complex for your needs going forward."}, {"owner": {"reputation": 33, "user_id": 12295047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2810cef236e9fb5c00ea69df89701d9?s=128&d=identicon&r=PG&f=1", "display_name": "Cobber", "link": "https://stackoverflow.com/users/12295047/cobber"}, "edited": false, "score": 0, "creation_date": 1572496111, "post_id": 58619833, "comment_id": 103580345, "body": "No worries....if it isn&#39;t going to crash that&#39;s all I need to know. Thanks for your help and patience, you have been a great help. Cheers."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 33, "user_id": 12295047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2810cef236e9fb5c00ea69df89701d9?s=128&d=identicon&r=PG&f=1", "display_name": "Cobber", "link": "https://stackoverflow.com/users/12295047/cobber"}, "edited": false, "score": 0, "creation_date": 1572992878, "post_id": 58619833, "comment_id": 103733639, "body": "Sorry I can&#39;t help - that&#39;s just too much code to go through.  Are you sure you wouldn&#39;t be better off using a pivot table or two for this?  You seem to be mostly counting/summarizing data, and a pivot table would be a good fit."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 33, "user_id": 12295047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2810cef236e9fb5c00ea69df89701d9?s=128&d=identicon&r=PG&f=1", "display_name": "Cobber", "link": "https://stackoverflow.com/users/12295047/cobber"}, "edited": false, "score": 0, "creation_date": 1572995197, "post_id": 58619833, "comment_id": 103734276, "body": "No problem - go ahead.  If you can boilt it down to a <i>much</i> smaller set of code and explain exactly what the error is that would help."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1572417843, "last_edit_date": 1572417843, "creation_date": 1572417527, "answer_id": 58619833, "question_id": 58619307, "link": "https://stackoverflow.com/questions/58619307/is-this-countifs-vba-code-ok-or-will-it-crash/58619833#58619833", "title": "Is this countifs VBA code OK, or will it crash?", "body": "<p>As commented above - a lot of repetition and ranges not scoped to specific worksheets.</p>\n\n<p>Here's a partial clean-up for the first section of counts: your countifs are factored out into a separate function called from your main code.</p>\n\n<pre><code>With ThisWorkbook.Sheets(1)\n    .Range(\"D5\").Value = Counts(\"RDG1\", \"Sewer Works\")\n    .Range(\"E5\").Value = Counts(\"RDG1\", \"Sewer Works\", \"PASS\")\n    .Range(\"F5\").Value = Counts(\"RDG1\", \"Sewer Works\", \"FAIL\")\n\n    'other counts here\n\nEnd With\n\n\n\n'Get row counts from sheet2\n'  Optional 3rd parameter for PASS/FAIL\nFunction Counts(v1 As String, v2 As String, Optional v3 As String = \"\") As Long\n    Dim rng1 As Range, rng2 As Range, rng3 As Range\n    With ThisWorkbook.Sheets(2)\n        Set rng1 = .Range(\"C7:C10000\")\n        Set rng2 = .Range(\"G7:G10000\")\n        Set rng3 = .Range(\"I7:I10000\")\n        If Len(v3) &gt; 0 Then\n            Counts = Application.CountIfs(rng1, v1, rng2, v2, rng3, v3)\n        Else\n            Counts = Application.CountIfs(rng3, v1, rng2, v2)\n        End If\n    End With\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 12295047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2810cef236e9fb5c00ea69df89701d9?s=128&d=identicon&r=PG&f=1", "display_name": "Cobber", "link": "https://stackoverflow.com/users/12295047/cobber"}, "edited": false, "score": 0, "creation_date": 1572420190, "post_id": 58620055, "comment_id": 103549132, "body": "Hi Devasuran, do you mean just put the header name of the column like this. PS, how do you get this code in grey background?? Sheets(1).Range(&quot;E5&quot;).Value = Application.WorksheetFunction.CountIfs(Range(Area), &quot;RDG1&quot;, Range(Work Type), &quot;Sewer Works&quot;, Range(Result), &quot;PASS&quot;)"}, {"owner": {"reputation": 1, "user_id": 12255555, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oQQG4WqHtTo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcwtQSOlln9p2D-Zh3PnuyPe_7YeA/photo.jpg?sz=128", "display_name": "devasuran", "link": "https://stackoverflow.com/users/12255555/devasuran"}, "reply_to_user": {"reputation": 33, "user_id": 12295047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2810cef236e9fb5c00ea69df89701d9?s=128&d=identicon&r=PG&f=1", "display_name": "Cobber", "link": "https://stackoverflow.com/users/12295047/cobber"}, "edited": false, "score": 0, "creation_date": 1572421687, "post_id": 58620055, "comment_id": 103549690, "body": "Given the situation, please follow what @Tim Williams says. Also, consider defining variable names using Named Manager. Define the name as per your business rules. The names which I have used is only for Example. To get the code block in grey, use the markdown formatting tags <code>code block here</code>"}], "tags": [], "owner": {"reputation": 1, "user_id": 12255555, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oQQG4WqHtTo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcwtQSOlln9p2D-Zh3PnuyPe_7YeA/photo.jpg?sz=128", "display_name": "devasuran", "link": "https://stackoverflow.com/users/12255555/devasuran"}, "is_accepted": false, "score": 0, "last_activity_date": 1572418680, "creation_date": 1572418680, "answer_id": 58620055, "question_id": 58619307, "link": "https://stackoverflow.com/questions/58619307/is-this-countifs-vba-code-ok-or-will-it-crash/58620055#58620055", "title": "Is this countifs VBA code OK, or will it crash?", "body": "<p>My suggestions to you will be:</p>\n\n<p>If you are using MS Excel 2010 and above, you could create Pivot tables. Glancing through your code, I understand that you creating measures based on certain values for a given range. Pivot tables handle this scenario better.</p>\n\n<p>If you believe you will need to use this code, then you might need to look at using Named ranges. Named Ranges are used for readability and software maintainability. </p>\n\n<p>For example, you could define a name for column range  <em>C7:C10000</em> as <strong>nm_SomeDescription</strong>. The keyboard shortcut to define a name is <em>CTRL+F3</em> or you could navigate to Formulas | Name Manager \n            The VBA code will use the name defined instead of column range as in </p>\n\n<p><code>Sheets(1).Range(\"F9\").Value = Application.WorksheetFunction.CountIfs(Range(nm_SomeDescription),  nm_HUJCode, Range(nm_SewerDescription), nm_SEWERCODE, Range(nm_FailureDescription), nm_FAILCODE)</code></p>\n\n<p><em>CountIF</em> or <em>CountIFs</em> use sequential scanning methods. Hence, you might see a performance hit for a large dataset. To mitigate the performance, you could sort the data before calling the <em>CountIFS</em> function. </p>\n"}], "owner": {"reputation": 33, "user_id": 12295047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2810cef236e9fb5c00ea69df89701d9?s=128&d=identicon&r=PG&f=1", "display_name": "Cobber", "link": "https://stackoverflow.com/users/12295047/cobber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1572433145, "creation_date": 1572413861, "last_edit_date": 1572433145, "question_id": 58619307, "link": "https://stackoverflow.com/questions/58619307/is-this-countifs-vba-code-ok-or-will-it-crash", "title": "Is this countifs VBA code OK, or will it crash?", "body": "<p>I've been told my countifs code is bad practice and worried it might crash. I have over 200 rows of code like this. Do I need to add variables or loops to make it better? Other lines have different criteria and more criteria, so it's pretty involved. My data only has up to 100,000 rows and it works OK...only takes a few seconds to complete. I have heaps of other code doing other stuff but this is the only part I was told is bad practice. I'm a newbie with no variable experience. Any suggestions much appreciated, thanks Cobber.</p>\n\n<pre><code>'Counts the data on sheet 2 and populates on sheet 1\n'counts total, pass and fail\nSheets(1).Range(\"D5\").Value = Application.WorksheetFunction.CountIfs(Range(\"C7:C10000\"), \"RDG1\", Range(\"G7:G10000\"), \"Sewer Works\")\n'counts pass\nSheets(1).Range(\"E5\").Value = Application.WorksheetFunction.CountIfs(Range(\"C7:C10000\"), \"RDG1\", Range(\"G7:G10000\"), \"Sewer Works\", Range(\"I7:I10000\"), \"PASS\")\n'counts fail\nSheets(1).Range(\"F5\").Value = Application.WorksheetFunction.CountIfs(Range(\"C7:C10000\"), \"RDG1\", Range(\"G7:G10000\"), \"Sewer Works\", Range(\"I7:I10000\"), \"FAIL\")\n'seperate areas\nSheets(1).Range(\"D6\").Value = Application.WorksheetFunction.CountIfs(Range(\"C7:C10000\"), \"TYH2\", Range(\"G7:G10000\"), \"Sewer Works\")\nSheets(1).Range(\"E6\").Value = Application.WorksheetFunction.CountIfs(Range(\"C7:C10000\"), \"TYH2\", Range(\"G7:G10000\"), \"Sewer Works\", Range(\"I7:I10000\"), \"PASS\")\nSheets(1).Range(\"F6\").Value = Application.WorksheetFunction.CountIfs(Range(\"C7:C10000\"), \"TYH2\", Range(\"G7:G10000\"), \"Sewer Works\", Range(\"I7:I10000\"), \"FAIL\")\n\nSheets(1).Range(\"D7\").Value = Application.WorksheetFunction.CountIfs(Range(\"C7:C10000\"), \"UJM3\", Range(\"G7:G10000\"), \"Sewer Works\")\nSheets(1).Range(\"E7\").Value = Application.WorksheetFunction.CountIfs(Range(\"C7:C10000\"), \"UJM3\", Range(\"G7:G10000\"), \"Sewer Works\", Range(\"I7:I10000\"), \"PASS\")\nSheets(1).Range(\"F7\").Value = Application.WorksheetFunction.CountIfs(Range(\"C7:C10000\"), \"UJM3\", Range(\"G7:G10000\"), \"Sewer Works\", Range(\"I7:I10000\"), \"FAIL\")\n\nSheets(1).Range(\"D8\").Value = Application.WorksheetFunction.CountIfs(Range(\"C7:C10000\"), \"OPL4\", Range(\"G7:G10000\"), \"Sewer Works\")\nSheets(1).Range(\"E8\").Value = Application.WorksheetFunction.CountIfs(Range(\"C7:C10000\"), \"OPL4\", Range(\"G7:G10000\"), \"Sewer Works\", Range(\"I7:I10000\"), \"PASS\")\nSheets(1).Range(\"F8\").Value = Application.WorksheetFunction.CountIfs(Range(\"C7:C10000\"), \"OPL4\", Range(\"G7:G10000\"), \"Sewer Works\", Range(\"I7:I10000\"), \"FAIL\")\n\nSheets(1).Range(\"D9\").Value = Application.WorksheetFunction.CountIfs(Range(\"C7:C10000\"), \"HUJ5\", Range(\"G7:G10000\"), \"Sewer Works\")\nSheets(1).Range(\"E9\").Value = Application.WorksheetFunction.CountIfs(Range(\"C7:C10000\"), \"HUJ5\", Range(\"G7:G10000\"), \"Sewer Works\", Range(\"I7:I10000\"), \"PASS\")\nSheets(1).Range(\"F9\").Value = Application.WorksheetFunction.CountIfs(Range(\"C7:C10000\"), \"HUJ5\", Range(\"G7:G10000\"), \"Sewer Works\", Range(\"I7:I10000\"), \"FAIL\")\n\n'calculates percent score after the columns are populated on sheet 1\nRange(\"G5\").Select\nActiveCell.FormulaR1C1 = \"=RC[-2]/RC[-3]\"\nRange(\"G6\").Select\nActiveCell.FormulaR1C1 = \"=RC[-2]/RC[-3]\"\nRange(\"G7\").Select\nActiveCell.FormulaR1C1 = \"=RC[-2]/RC[-3]\"\nRange(\"G8\").Select\nActiveCell.FormulaR1C1 = \"=RC[-2]/RC[-3]\"\nRange(\"G9\").Select\nActiveCell.FormulaR1C1 = \"=RC[-2]/RC[-3]\"\n\nRange(\"G10\").Select\nActiveCell.FormulaR1C1 = \"=RC[-2]/RC[-3]\"\nRange(\"G11\").Select\nActiveCell.FormulaR1C1 = \"=RC[-2]/RC[-3]\"\nRange(\"G12\").Select\nActiveCell.FormulaR1C1 = \"=RC[-2]/RC[-3]\"\nRange(\"G13\").Select\nActiveCell.FormulaR1C1 = \"=RC[-2]/RC[-3]\"\nRange(\"G14\").Select\nActiveCell.FormulaR1C1 = \"=RC[-2]/RC[-3]\"\n</code></pre>\n"}, {"tags": ["excel", "vba", "performance"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1572413855, "post_id": 58619291, "comment_id": 103547314, "body": "<a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1572421498, "post_id": 58619291, "comment_id": 103549623, "body": "Would your cells always have just one dependent?"}, {"owner": {"reputation": 1, "user_id": 12129913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc56cabe753f701942fa58a85f8a051?s=128&d=identicon&r=PG&f=1", "display_name": "Rick21", "link": "https://stackoverflow.com/users/12129913/rick21"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1572448450, "post_id": 58619291, "comment_id": 103564360, "body": "Yes, mostly only one @JvdV"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12129913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc56cabe753f701942fa58a85f8a051?s=128&d=identicon&r=PG&f=1", "display_name": "Rick21", "link": "https://stackoverflow.com/users/12129913/rick21"}, "edited": false, "score": 0, "creation_date": 1572420333, "post_id": 58619364, "comment_id": 103549180, "body": "But it takes the same amount of time. How can I make this faster?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 12129913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc56cabe753f701942fa58a85f8a051?s=128&d=identicon&r=PG&f=1", "display_name": "Rick21", "link": "https://stackoverflow.com/users/12129913/rick21"}, "edited": false, "score": 0, "creation_date": 1572447320, "post_id": 58619364, "comment_id": 103563677, "body": "Try setting calculation to manual in addition to screenupdating and events, but it may not get much faster."}, {"owner": {"reputation": 1, "user_id": 12129913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc56cabe753f701942fa58a85f8a051?s=128&d=identicon&r=PG&f=1", "display_name": "Rick21", "link": "https://stackoverflow.com/users/12129913/rick21"}, "edited": false, "score": 0, "creation_date": 1572448375, "post_id": 58619364, "comment_id": 103564321, "body": "I tried it that way itself. But it took 137 sec for a small table only. the time was the same for my code and this simplified code @Tim Williams"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1572414354, "creation_date": 1572414354, "answer_id": 58619364, "question_id": 58619291, "link": "https://stackoverflow.com/questions/58619291/coloring-cells-that-have-dependents-to-other-cells/58619364#58619364", "title": "Coloring cells that have dependents to other cells", "body": "<p>Simplified:</p>\n\n<pre><code>Sub Tester()\n\n    Dim sh As Worksheet, rg As Range, c As Range\n\n    Set sh = ThisWorkbook.Sheets(\"Main sheet\")\n\n    Set rg = sh.Range(\"A4\").CurrentRegion\n\n    For Each c In rg.Cells\n        c.ShowDependents\n        c.NavigateArrow TowardPrecedent:=False, ArrowNumber:=1, LinkNumber:=1\n        If ActiveSheet.name &lt;&gt; sh.name Then\n            c.Interior.Color = vbRed\n        End If\n    Next c\n\n    sh.ClearArrows\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12129913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc56cabe753f701942fa58a85f8a051?s=128&d=identicon&r=PG&f=1", "display_name": "Rick21", "link": "https://stackoverflow.com/users/12129913/rick21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572414354, "creation_date": 1572413721, "last_edit_date": 1572413753, "question_id": 58619291, "link": "https://stackoverflow.com/questions/58619291/coloring-cells-that-have-dependents-to-other-cells", "title": "Coloring cells that have dependents to other cells", "body": "<p>I have made a code that checks if the cells value has been referred in any other sheet. Simply it checks the cells Dependency and colours it.\nBasically what I did is it goes to the cell dependancy and if the sheet name is not the one it was at the first, it colours it. Here is the code</p>\n\n<pre><code>Dim r As Long, c As Long, sh As Worksheet, name As String, rg As Range, chksh As String ' r is row and c is coloumn\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\n\nname = \"Main sheet\"\n\nSet sh = ThisWorkbook.Sheets(name)\nSet rg = sh.Range(\"A4\").CurrentRegion\n\nr = rg.Rows.Count\nc = rg.Columns.Count\n\nDim i As Long, j As Long\ni = 1\nj = 1\nsh.Select\n\nDo While i &lt; r + 1\n    j = 1\n    Do While j &lt; c + 1\n        sh.Cells(i, j).Select\n        Selection.ShowDependents\n        ActiveCell.NavigateArrow TowardPrecedent:=False, ArrowNumber:=1, _\n        LinkNumber:=1\n        chksh = ActiveSheet.name\n        If chksh &lt;&gt; name Then 'there is a dependent in other sheet\n\n            sh.Select\n            With Selection.Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .Color = 65535\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n             End With\n        End If\n        j = j + 1\n    Loop\n    i = i + 1\nLoop\n\nActiveSheet.ClearArrows\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>It takes too much time due to the <code>.select</code> use. \nPlease suggest an improved code without the use of select so that it can run in a blink of an eye.</p>\n"}, {"tags": ["vba", "ms-access", "database-connection", "adodb"], "answers": [{"comments": [{"owner": {"reputation": 2892, "user_id": 1935222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gx2zd.png?s=128&g=1", "display_name": "4dmonster", "link": "https://stackoverflow.com/users/1935222/4dmonster"}, "edited": false, "score": 0, "creation_date": 1572436243, "post_id": 58624187, "comment_id": 103557064, "body": "for example <code>LIKE</code> operator: <code>*</code> of DAO is <code>%</code> for ADO"}], "tags": [], "owner": {"reputation": 61, "user_id": 10892212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc98408b4d21360b0f71cb9b24c5eda?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10892212/ibrahim"}, "is_accepted": false, "score": 0, "last_activity_date": 1572434189, "creation_date": 1572434189, "answer_id": 58624187, "question_id": 58619105, "link": "https://stackoverflow.com/questions/58619105/using-adodb-within-access/58624187#58624187", "title": "Using ADODB within Access", "body": "<p>Try to remove the line containing the where clause maybe this is the problem</p>\n\n<pre><code>'sQuery = sQuery &amp; \" Where \" &amp; Me.Filter\n</code></pre>\n\n<p>then check the returning records, if there are records then the problem is in the filter conditions.</p>\n\n<p>Hope this may help </p>\n"}], "owner": {"reputation": 1, "user_id": 12295153, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156357062957035/picture?type=large", "display_name": "Shady El Beltagy", "link": "https://stackoverflow.com/users/12295153/shady-el-beltagy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572434189, "creation_date": 1572412176, "last_edit_date": 1572432775, "question_id": 58619105, "link": "https://stackoverflow.com/questions/58619105/using-adodb-within-access", "title": "Using ADODB within Access", "body": "<p>I'm trying to use adodb connection withing access vba, and it doesn't return me anydata, I guess my problem would be the connection, even though i'm using CurrentProject.Connection.</p>\n\n<p>Need help please, here is my code</p>\n\n<pre><code>Dim cnThisConnect As New ADODB.Connection\nDim rsExpenses As New ADODB.Recordset\nDim sQuery As String\n\n    sQuery = \"SELECT  [ShippingSoldPrice] , ShippingPurchaseTaxe FROM Vehicles LEFT JOIN Contacts AS C ON \n    Vehicles.CustomerID = C.ID\"\n    sQuery = sQuery &amp; \" Where \" &amp; Me.Filter\n\n     Set cnThisConnect = CurrentProject.Connection\n\n     rsExpenses.Open sQuery, cnThisConnect, adOpenDynamic, adLockOptimistic\n\n    If Not rsExpenses.EOF Then\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1572414422, "post_id": 58618967, "comment_id": 103547434, "body": "You can make a custom userform, but you can&#39;t easily alter the built-in dialogs."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1572415249, "post_id": 58618967, "comment_id": 103547628, "body": "I&#39;m a bit confused, in the advanced options for find and replace, you can specify workbook or worksheet - what did you want to alter?"}, {"owner": {"reputation": 1, "user_id": 12200248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffdd7b65fd31f51d7fbd59c7cf986c9?s=128&d=identicon&r=PG&f=1", "display_name": "siva", "link": "https://stackoverflow.com/users/12200248/siva"}, "edited": false, "score": 0, "creation_date": 1572415627, "post_id": 58618967, "comment_id": 103547732, "body": "i want to alter that show only worksheet in advanced option"}, {"owner": {"reputation": 977, "user_id": 96729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34326f2b063313a5dbc8a507dc10bd2c?s=128&d=identicon&r=PG", "display_name": "Arnaud Meuret", "link": "https://stackoverflow.com/users/96729/arnaud-meuret"}, "edited": false, "score": 0, "creation_date": 1573186436, "post_id": 58618967, "comment_id": 103807822, "body": "Showing care for your question&#39;s formatting would improve its chances to be considered by others. Capitalizing correctly is not that difficult in English."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12200248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffdd7b65fd31f51d7fbd59c7cf986c9?s=128&d=identicon&r=PG&f=1", "display_name": "siva", "link": "https://stackoverflow.com/users/12200248/siva"}, "edited": false, "score": 0, "creation_date": 1572433416, "post_id": 58620719, "comment_id": 103555622, "body": "Excel build in find and replace dialog box has contain some parameter like  search,Look in,Match Case...etc .i want to only work find or replace   &quot;within :worksheet&quot;  on sheet 1. &quot;within :workbook&quot; is disable in sheet 1,but it enable other sheet"}], "tags": [], "owner": {"reputation": 327, "user_id": 8571717, "user_type": "registered", "profile_image": "https://graph.facebook.com/1524531667605038/picture?type=large", "display_name": "Kirill Tkachenko", "link": "https://stackoverflow.com/users/8571717/kirill-tkachenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1572436065, "last_edit_date": 1572436065, "creation_date": 1572421866, "answer_id": 58620719, "question_id": 58618967, "link": "https://stackoverflow.com/questions/58618967/is-it-possible-alter-build-in-excel-find-replace-dialog-box-using-vba/58620719#58620719", "title": "Is it possible alter build in excel find replace dialog box using vba?", "body": "<p>You can create a custom form which looks like Find/Replace dialog, but without the dropdown that you want to disable. Then you can write a simple sub to display the form when user presses Ctrl+F:</p>\n\n<pre><code>Public Sub ShowFindDialog\n    MyFindDialog.Show\nEnd Sub\n</code></pre>\n\n<p>To assign it to Ctrl+f key, go to Developer -> Macros -> find your macro and click \"Options...\" -> specify \"Ctrl+f\" as the shortcut key. </p>\n\n<p>Now the users can still access built-in Find/Replace dialog through ribbon. To remove it, right click on the ribbon and select \"Customize The Ribbon...\". On the right hand side of the window expand the \"Home\" tab, right-click on \"Editing\" group and select \"Remove\".</p>\n\n<p><b>EDIT:</b> The last bit about customizing Ribbon will only work on your computer and will apply to all workbooks. If you want to apply these settings for a particular workbook, it get's more difficult. You can look, for example, <a href=\"https://www.nhaustralia.com.au/blog/customise-ribbon-excel-workbook/\" rel=\"nofollow noreferrer\">here</a>. </p>\n\n<p><b>EDIT2:</b> Instead of building a custom form, you can use <code>Application.Dialogs(xlDialogFormulaFind).Show</code>. To do it just for one sheet, add the following macro and assign it to Ctrl+F as I explained earlier:</p>\n\n<pre><code>Public Sub ShowFindDialog()\n    If ActiveSheet.Name = \"MySheet\" Then\n        'ON MySheet show find dialog without an option to search within workbook\n        Application.Dialogs(xlDialogFormulaFind).Show\n    Else\n        'For all other sheets show regular find dialog\n        Application.CommandBars(\"Edit\").Controls(\"Find...\").Execute\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12200248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffdd7b65fd31f51d7fbd59c7cf986c9?s=128&d=identicon&r=PG&f=1", "display_name": "siva", "link": "https://stackoverflow.com/users/12200248/siva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 197, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572436065, "creation_date": 1572411261, "last_edit_date": 1572411569, "question_id": 58618967, "link": "https://stackoverflow.com/questions/58618967/is-it-possible-alter-build-in-excel-find-replace-dialog-box-using-vba", "title": "Is it possible alter build in excel find replace dialog box using vba?", "body": "<p>Is there is any way to alter build in excel find replace dialog box using vba? for example i want to disable the \"within\": workbook criteria. </p>\n\n<p>i expected an output that excel find replace work only within sheet not within workbook</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1572417335, "post_id": 58618660, "comment_id": 103548181, "body": "Why do you try to recreate a function that exists?"}], "answers": [{"comments": [{"owner": {"reputation": 909, "user_id": 466521, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e4df17dcfcd4ddba26238037a33ec950?s=128&d=identicon&r=PG", "display_name": "Yogi", "link": "https://stackoverflow.com/users/466521/yogi"}, "edited": false, "score": 0, "creation_date": 1572410628, "post_id": 58618854, "comment_id": 103546620, "body": "How to get values for Hours and minutes say for the above example the value returned should be 2 Hours 29 minutes. How do I return that?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 909, "user_id": 466521, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e4df17dcfcd4ddba26238037a33ec950?s=128&d=identicon&r=PG", "display_name": "Yogi", "link": "https://stackoverflow.com/users/466521/yogi"}, "edited": false, "score": 0, "creation_date": 1572410729, "post_id": 58618854, "comment_id": 103546646, "body": "I updated the answer. Play with that a little. It requires formatting to get multiple values, which you can do inside or outside the function."}, {"owner": {"reputation": 909, "user_id": 466521, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e4df17dcfcd4ddba26238037a33ec950?s=128&d=identicon&r=PG", "display_name": "Yogi", "link": "https://stackoverflow.com/users/466521/yogi"}, "edited": false, "score": 0, "creation_date": 1572411213, "post_id": 58618854, "comment_id": 103546749, "body": "I tried your example. I am getting -8965 seconds. Thats not right correct?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 909, "user_id": 466521, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e4df17dcfcd4ddba26238037a33ec950?s=128&d=identicon&r=PG", "display_name": "Yogi", "link": "https://stackoverflow.com/users/466521/yogi"}, "edited": false, "score": 0, "creation_date": 1572411653, "post_id": 58618854, "comment_id": 103546832, "body": "Are you expecting to always get a positive number? It depends on the order in which you specify the values, or you can use <code>Abs</code> (I&#39;ll update the answer)"}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1572416786, "post_id": 58618854, "comment_id": 103548029, "body": "Input values are not dates with different formats but strings (at least the first one - as you can tell looking at pDate2 value), so the main problem is converting it to date."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1572416989, "post_id": 58618854, "comment_id": 103548095, "body": "The arguments to the function are dates, so VBA implicitly converts them to dates (if possible) if they are strings to begin with."}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1572454303, "post_id": 58618854, "comment_id": 103567637, "body": "The arguments of the function are defined as dates, but the arguments passed are strings - it is obvious reading the question: <code>pDate2 appears as 10&#47;19&#47;15 9:09:23 AM</code>. If both cells contain dates (with different formatting) then no VBA is needed, just a simple formula like (<code>=B2-A2</code>)"}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1572415453, "last_edit_date": 1572415453, "creation_date": 1572410435, "answer_id": 58618854, "question_id": 58618660, "link": "https://stackoverflow.com/questions/58618660/how-to-calculate-time-difference-in-difference-format-in-excel-using-vba/58618854#58618854", "title": "How to Calculate time difference in difference format in Excel using VBA", "body": "<p>You are getting 0 because there are 0 days between those values, PLUS, you never assign the Function a value to return anything other than the default value for <code>Long</code>.</p>\n\n<p>Try it like this:</p>\n\n<pre><code> Function caclulateDifference(pDate1 As Date, pDate2 As Date) As Long\n\n   caclulateDifference = DateDiff(\"d\", pDate1, pDate2)\n\n End Function\n</code></pre>\n\n<p>You will still get 0, but in this example, that's what you are supposed to get. Change the function to this, and then look at your debug window to see that the dates are getting formatted properly:</p>\n\n<pre><code>Public Function caclulateDifference(pDate1 As Date, pDate2 As Date) As Long\n\n   Debug.Print pDate1\n   Debug.Print pDate2\n\n   caclulateDifference = DateDiff(\"d\", pDate1, pDate2)\n\n End Function\n</code></pre>\n\n<p>Then test it using date values that are on different days to get something other than 0.</p>\n\n<p>Now if you want it in more detail than days as you say, you need to return a value other than <code>Long</code> (might have milliseconds in the values too) and use a different argument in your <code>DateDiff</code> like this:</p>\n\n<pre><code>Public Function caclulateDifference(pDate1 As Date, pDate2 As Date) As Double\n\n   caclulateDifference = DateDiff(\"s\", pDate1, pDate2)\n\nEnd Function\n</code></pre>\n\n<p>Then convert the number of seconds into the number of days, hours, minutes, and seconds.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/34667431/converting-seconds-to-years-days-hours-min-secs\">Convert seconds to days, hours, minutes, and seconds</a></p>\n\n<p>If you dont want the order to matter, and always get a positive number, use <code>Abs</code> (absolute value) function as well, like this:</p>\n\n<pre><code>Public Function caclulateDifference(pDate1 As Date, pDate2 As Date) As Double\n\n   caclulateDifference = Abs(DateDiff(\"s\", pDate1, pDate2))\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 909, "user_id": 466521, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e4df17dcfcd4ddba26238037a33ec950?s=128&d=identicon&r=PG", "display_name": "Yogi", "link": "https://stackoverflow.com/users/466521/yogi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572415453, "creation_date": 1572408874, "last_edit_date": 1572409051, "question_id": 58618660, "link": "https://stackoverflow.com/questions/58618660/how-to-calculate-time-difference-in-difference-format-in-excel-using-vba", "title": "How to Calculate time difference in difference format in Excel using VBA", "body": "<p>I have 2 columns with dates in different format.</p>\n\n<p><a href=\"https://i.stack.imgur.com/uadzQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uadzQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see one column is in dd/mm/yyyy format and other is in mm/dd/yyyy format.</p>\n\n<p>I want to find the time difference among the two.\nAlso, one column is in Date Format and other is in General Format.</p>\n\n<p>I wrote a function in VB to calculate the difference like this:</p>\n\n<pre><code> Function caclulateDifference(pDate1 As Date, pDate2 As Date) As Long\n\n   TestDates = DateDiff(\"d\", pDate1, pDate2)\n\n End Function\n</code></pre>\n\n<p>And I Call this in Excel using =caclulateDifference(b2,a2)\nHowever,</p>\n\n<p>pDate1 is coming as 10/15/19 11:38:38 AM, but pDate2 appears as 10/19/15 9:09:23 AM and then difference is coming as 0.</p>\n\n<p>I want difference in day, hour and minutes.\nWhat am I doing wrong?</p>\n"}, {"tags": ["excel", "vba", "charts"], "comments": [{"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1572422536, "post_id": 58618595, "comment_id": 103550038, "body": "Welcome to SO! When you place a question try to add a minimum content: input sample, expected output sample, what did you try, research and where are you stuck. It is difficult to replicate your problem without some input data sample and graph screenshot."}, {"owner": {"reputation": 15, "user_id": 8186749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35efcb0db5c8e3fc264b953ef1edd863?s=128&d=identicon&r=PG&f=1", "display_name": "Aatrox The Darkin Blade", "link": "https://stackoverflow.com/users/8186749/aatrox-the-darkin-blade"}, "reply_to_user": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1572426770, "post_id": 58618595, "comment_id": 103551983, "body": "hie there.. i have updated the question.. Please check it now.. hope it is understandable now.."}, {"owner": {"reputation": 53495, "user_id": 5090771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2EOZG.png?s=128&g=1", "display_name": "WhiteHat", "link": "https://stackoverflow.com/users/5090771/whitehat"}, "edited": false, "score": 0, "creation_date": 1572433932, "post_id": 58618595, "comment_id": 103555913, "body": "is the chart <i>active</i> when using F5?"}, {"owner": {"reputation": 15, "user_id": 8186749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35efcb0db5c8e3fc264b953ef1edd863?s=128&d=identicon&r=PG&f=1", "display_name": "Aatrox The Darkin Blade", "link": "https://stackoverflow.com/users/8186749/aatrox-the-darkin-blade"}, "edited": false, "score": 0, "creation_date": 1572491378, "post_id": 58618595, "comment_id": 103579402, "body": "yes, it is active."}], "answers": [{"tags": [], "owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "is_accepted": false, "score": 0, "last_activity_date": 1572833222, "creation_date": 1572833222, "answer_id": 58686363, "question_id": 58618595, "link": "https://stackoverflow.com/questions/58618595/relabeling-chart-series-collections/58686363#58686363", "title": "Relabeling chart series collections", "body": "<p>Your question is unclear in several ways.</p>\n\n<p>Are V1 and V2 your X and Y values? If so, it's easy with a few formulas. The formula in cell E2, filled into E2:G14, is</p>\n\n<p>=IF(E$1=$A2,$D2,NA())</p>\n\n<p><a href=\"https://i.stack.imgur.com/DUCHz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DUCHz.png\" alt=\"Data split into separate XY series\"></a></p>\n\n<p>Select C1:C14, then hold Ctrl while selecting E1:G14, and insert your scatter chart.</p>\n\n<p><a href=\"https://i.stack.imgur.com/yB9Nm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yB9Nm.png\" alt=\"Data plotted as separate XY series\"></a></p>\n"}], "owner": {"reputation": 15, "user_id": 8186749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35efcb0db5c8e3fc264b953ef1edd863?s=128&d=identicon&r=PG&f=1", "display_name": "Aatrox The Darkin Blade", "link": "https://stackoverflow.com/users/8186749/aatrox-the-darkin-blade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576181616, "creation_date": 1572408239, "last_edit_date": 1576181616, "question_id": 58618595, "link": "https://stackoverflow.com/questions/58618595/relabeling-chart-series-collections", "title": "Relabeling chart series collections", "body": "<p>I have written code to plot a graph which is supposed to show one name for each collection.</p>\n\n<p>There are 10 ~ 15 collections so having names for every item in the chart gets messy.</p>\n\n<p>My Excel looks like this in intake port parameter sheet and the graph is plotted between v1 and v2. a is the variable name and case is the case of the variable.</p>\n\n<p>I want all the points to group near one place and have one \"a\" or \"b\" as a caption for entire group depending on the group</p>\n\n<pre><code>name case V1 V2\na      1  10 11\na      2  12 11\na      3  12 12\na      4  12 11\na      5  12 12\n\nb      1  15 12\nb      2  10 10\nb      3  15 11\nb      4  12 15\nb      5  19 12\n\nC      1  01 02\nC      2  02 01\nC      3  02 11\n....\n</code></pre>\n\n <pre class=\"lang-vb prettyprint-override\"><code>For j = 2 To i\na = 4 + (j - 1) * 6\nActiveChart.SeriesCollection.NewSeries\nActiveChart.SeriesCollection(j).Name = \"=INTAKE_PORT_PARAMETER!C\" &amp; a\nActiveChart.SeriesCollection(j).XValues = \"=INTAKE_PORT_PARAMETER!Z\" &amp; a &amp; \":Z\" &amp; a + 5\nActiveChart.SeriesCollection(j).Values = \"=INTAKE_PORT_PARAMETER!AA\" &amp; a &amp; \":AA\" &amp; a + 5\nActiveChart.ChartArea.Select\nActiveChart.SeriesCollection(j).ApplyDataLabels\nActiveChart.SeriesCollection(j).DataLabels.Item(1).Select\nSelection.ShowSeriesName = True\nSelection.ShowValue = False\nSelection.Format.TextFrame2.TextRange.Font.Size = 8\nActiveChart.SeriesCollection(j).DataLabels.Select\nSelection.ShowValue = False\nNext j\n</code></pre>\n\n<p>When run manually (by clicking F8) the code is working.<br>\nThe output dots in the graph looks as I want.</p>\n\n<pre><code>|   ..(a)\n|  ..        **(b)\n|\n|      ## (C)\n|____________________\n</code></pre>\n\n<p>When run using F5 instead of step by step, I get one value for each collection and the name of the collection is not visible.</p>\n\n<pre><code>|   ..(10)\n|  ..        **(15)\n|\n|      ## (01)\n|____________________\n</code></pre>\n\n<p>I couldn't post the pictures of the graphs. My company treats those as confidential data.</p>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12294747, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-waZt_FE03_E/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdMFhLSA9nItVFtZ3BW72X0pvweHA/photo.jpg?sz=128", "display_name": "JvvDoe", "link": "https://stackoverflow.com/users/12294747/jvvdoe"}, "edited": false, "score": 0, "creation_date": 1572464540, "post_id": 58621101, "comment_id": 103572219, "body": "This looks to be it. Thank you."}], "tags": [], "owner": {"reputation": 521, "user_id": 12268796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LVipW.jpg?s=128&g=1", "display_name": "barneyos", "link": "https://stackoverflow.com/users/12268796/barneyos"}, "is_accepted": true, "score": 0, "last_activity_date": 1572423592, "creation_date": 1572423592, "answer_id": 58621101, "question_id": 58618073, "link": "https://stackoverflow.com/questions/58618073/change-one-interactive-textbox-based-on-input-of-another/58621101#58621101", "title": "Change one interactive textbox based on input of another", "body": "<p>Concerning your sample</p>\n\n<pre><code>ActivePresentation.Slides(8).Shapes(\"TextBoxNAME2\").OLEFormat.Object.Text = \"TEST\"\n</code></pre>\n\n<p>Or maybe this.\nIf it is an ActiveX Textbox object you may use event handler:</p>\n\n<pre><code>' put this in Slide's module, where You input new value at\n' e.g Slide No.1 Module\nPrivate Sub TextBox1_LostFocus()\n    ' You want to update TextBox1 ona Slide 2\n    Slide2.TextBox1.Text = Me.TextBox1.Text\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12294747, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-waZt_FE03_E/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdMFhLSA9nItVFtZ3BW72X0pvweHA/photo.jpg?sz=128", "display_name": "JvvDoe", "link": "https://stackoverflow.com/users/12294747/jvvdoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 58621101, "answer_count": 1, "score": 0, "last_activity_date": 1572423592, "creation_date": 1572403744, "last_edit_date": 1572406241, "question_id": 58618073, "link": "https://stackoverflow.com/questions/58618073/change-one-interactive-textbox-based-on-input-of-another", "title": "Change one interactive textbox based on input of another", "body": "<p>I have an interactive <code>textbox</code> in my powerpoint, which I can input text into while presentation mode. I am wondering how I can change the text within another interactive <code>textbox</code> on another slide to what I input in the original interactive <code>textbox</code>?</p>\n\n<p>I have tried some code in vba:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>ActivePresentation.Slides(8).Shapes(\"TextBoxNAME2\").TextFrame.TextRange.Text = \"TEST\" \n</code></pre>\n\n<p>to no avail. Any ideas?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 3, "creation_date": 1572398016, "post_id": 58617458, "comment_id": 103544211, "body": "Dont you want to add the attachment before executing <code>.Display</code>?"}, {"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1572398186, "post_id": 58617458, "comment_id": 103544238, "body": ".......... welp. Want to make that an answer so I can accept it?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1572399768, "post_id": 58617458, "comment_id": 103544536, "body": "You missed the part... <code>.Attachments.Add Attchmnt, 1, 0</code> from the other post :)"}, {"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1572432536, "post_id": 58617458, "comment_id": 103555146, "body": "@SiddharthRout: That&#39;s what I get for trying to recreate code at home XD. The original at work has it"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1572432699, "post_id": 58617458, "comment_id": 103555226, "body": "The code from the linked post worked just fine for me :)"}], "answers": [{"comments": [{"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "edited": false, "score": 0, "creation_date": 1572441118, "post_id": 58617546, "comment_id": 103559866, "body": "This works great in a single email! I can successfully generate the picture and attach it... just not working in the giant code I have... going to have a fun debugging session trying to figure out why &gt;_&lt;. Going to start small, and keep adding pieces until it breaks or until it works"}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 2, "last_activity_date": 1572402848, "last_edit_date": 1572402848, "creation_date": 1572398642, "answer_id": 58617546, "question_id": 58617458, "link": "https://stackoverflow.com/questions/58617458/how-to-embed-an-image-into-an-outlook-email-using-vba/58617546#58617546", "title": "How to embed an image into an Outlook email using VBA", "body": "<p>The <code>cid</code> is created when you attach it, so you need to do that before you display/send it.</p>\n\n<p>Try it like this</p>\n\n<pre><code>Set OutMail = outApp.CreateItem(0)\nWith OutMail\n    .To = WB.Names(\"to\").RefersToRange.Value2\n    .CC = WB.Names(\"cc\").RefersToRange.Value2\n    .BCC = WB.Names(\"bcc\").RefersToRange.Value2\n    .Subject = WB.Names(\"Subject\").RefersToRange.Value2\n    If Attchmnt &lt;&gt; \"\" Then \n       .Attachments.Add Attchmnt ' (additional arguments are optional)\n       .HTMLBody = \"&lt;img src=\"\"cid:Painted_Lady_Migration.jpg\"\" height=520 width=750&gt;\"\n    Else\n       .HTMLBody = \"[no attachment included]\"\n    End If\n   .Display\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 747, "favorite_count": 0, "accepted_answer_id": 58617546, "answer_count": 1, "score": 2, "last_activity_date": 1572402848, "creation_date": 1572397771, "question_id": 58617458, "link": "https://stackoverflow.com/questions/58617458/how-to-embed-an-image-into-an-outlook-email-using-vba", "title": "How to embed an image into an Outlook email using VBA", "body": "<p>Very closely related to <a href=\"https://stackoverflow.com/questions/44869790/embed-picture-in-outlook-mail-body-excel-vba/44870371?noredirect=1#comment103543944_44870371\">Embed picture in outlook mail body excel vba</a></p>\n\n<p>I'm trying to embed an image into an Outlook email.</p>\n\n<p>I'm using the following code snippet, half of which has been stolen from the post above:</p>\n\n<pre><code>Sub PictureEmail()\n    Dim outApp As New Outlook.Application\n    Dim OutMail As Object\n    Dim Attchmnt As String\n    Dim Signature As String\n    Dim WB As Workbook\n    Set WB = ThisWorkbook\n   Attchmnt = \"C:\\Users\\Blah\\Painted_Lady_Migration.jpg\"\n\n\n    Set OutMail = outApp.CreateItem(0)\n    On Error Resume Next\n    With OutMail\n    .To = WB.Names(\"to\").RefersToRange.Value2\n    .CC = WB.Names(\"cc\").RefersToRange.Value2\n    .BCC = WB.Names(\"bcc\").RefersToRange.Value2\n    .Subject = WB.Names(\"Subject\").RefersToRange.Value2\n   .HTMLBody = \"&lt;img src=\"\"cid:Painted_Lady_Migration.jpg\"\"height=520 width=750&gt;\"\n   .display\n   End With\n\n   If Attchmnt = \"\" Then\n   Else\n   OutMail.Attachments.Add Attchmnt\n   End If\n\n   On Error GoTo 0\n\nEnd Sub\n</code></pre>\n\n<p>However, when looking at the generated email, I have the error \"The linked image cannot be displayed. The file may have been moved, renamed, or deleted\".</p>\n\n<p>I've tried a few different ways to attach the file, including:</p>\n\n<pre><code>.HTMLBody = \"&lt;img src=\" &amp; Chr(34) &amp; \"cid:Painted_Lady_Migration.jpg\" &amp; Chr(34) &amp; \"height=520 width=750&gt;\"\n</code></pre>\n\n<p>I just can't get it to work >_&lt;</p>\n\n<p>I saw somewhere that spaces in the name/filepath can throw it, so I replaced the spaces in the name with underscores</p>\n\n<p>What dumb thing am I forgetting/missing?</p>\n"}, {"tags": ["excel", "vba", "paste", "transpose", "shapes"], "comments": [{"owner": {"reputation": 165, "user_id": 8350311, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W99gl.png?s=128&g=1", "display_name": "Piecevcake", "link": "https://stackoverflow.com/users/8350311/piecevcake"}, "edited": false, "score": 0, "creation_date": 1572504845, "post_id": 58617188, "comment_id": 103582446, "body": "Thanks guys. Copy and paste object with cells is not working with transpose. So can anyone help with some vba code? (they are all in their own adjacent cells)"}], "answers": [{"tags": [], "owner": {"reputation": 165, "user_id": 8350311, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W99gl.png?s=128&g=1", "display_name": "Piecevcake", "link": "https://stackoverflow.com/users/8350311/piecevcake"}, "is_accepted": true, "score": 0, "last_activity_date": 1572692338, "last_edit_date": 1572692338, "creation_date": 1572691769, "answer_id": 58670362, "question_id": 58617188, "link": "https://stackoverflow.com/questions/58617188/paste-shapes-transposed-in-excel/58670362#58670362", "title": "Paste shapes transposed in Excel", "body": "<p>Solved- here is an addin to do it! US$10 My Excel Tools Spreadsheet image tools <a href=\"https://myexceltools.com/pages_spreadsheet_images/view_more_spreadsheet_image.htm\" rel=\"nofollow noreferrer\">https://myexceltools.com/pages_spreadsheet_images/view_more_spreadsheet_image.htm</a></p>\n\n<p>(need to paste in same sheet then move to aother sheet if required afaik)</p>\n"}], "owner": {"reputation": 165, "user_id": 8350311, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W99gl.png?s=128&g=1", "display_name": "Piecevcake", "link": "https://stackoverflow.com/users/8350311/piecevcake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 58670362, "answer_count": 1, "score": 0, "last_activity_date": 1595845938, "creation_date": 1572395450, "last_edit_date": 1595845938, "question_id": 58617188, "link": "https://stackoverflow.com/questions/58617188/paste-shapes-transposed-in-excel", "title": "Paste shapes transposed in Excel", "body": "<p>When I pasted cells transposed, the pictures were not pasted.</p>\n<p>Is this normal for Excel?</p>\n<p>If so is there any code or trick to get those pictures (which are column/row headers!) Transposed from the old row to the new column?</p>\n<p><a href=\"https://i.stack.imgur.com/oWVCe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oWVCe.png\" alt=\"enter image description here\" /></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1572395349, "post_id": 58617080, "comment_id": 103543717, "body": "and <a href=\"https://stackoverflow.com/q/21031047/62576\">stackoverflow.com/q/21031047/62576</a>"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1572416604, "last_edit_date": 1572416604, "creation_date": 1572395520, "answer_id": 58617198, "question_id": 58617080, "link": "https://stackoverflow.com/questions/58617080/how-to-apply-a-vba-macro-to-all-excel-files-in-a-folder/58617198#58617198", "title": "How to apply a vba macro to all excel files in a folder?", "body": "<p>You can do something like this:</p>\n\n<pre><code>'...\nfileName = Dir(folderName &amp; \"\\*.*\")\nDo While fileName &lt;&gt; \"\"\n    'Update status bar to indicate progress\n    Application.StatusBar = \"Processing \" &amp; folderName &amp; \"\\\" &amp; fileName\n\n    Set wb = Workbooks.Open(folderName &amp; \"\\\" &amp; fileName)\n    Application.DisplayAlerts = False\n    On Error Resume Next\n    wb.Worksheets(\"INV.\").Delete\n    On Error Goto 0\n    Application.DisplayAlerts = True\n    wb.Close True 'save changes\n\n    fileName = Dir()\nLoop\n</code></pre>\n\n<p>...or if you want to keep your original separate sub:</p>\n\n<pre><code>Sub RunOnAllFilesInFolder\n '...\nfileName = Dir(folderName &amp; \"\\*.*\")\nDo While fileName &lt;&gt; \"\"\n    'Update status bar to indicate progress\n    Application.StatusBar = \"Processing \" &amp; folderName &amp; \"\\\" &amp; fileName\n\n    Set wb = Workbooks.Open(folderName &amp; \"\\\" &amp; fileName)\n\n    delete_sheet wb, \"INV.\"  '&lt;&lt; call your Sub and pass the workbook &amp; sheet name\n\n    wb.Close True 'save changes\n\n    fileName = Dir()\nLoop\n'...\nEnd Sub\n\n\nSub delete_sheet(wb As Workbook, shtName as String)\n    Dim aSheet As Worksheet\n    For Each aSheet In wb.Worksheets\n        If aSheet.Name = shtName Then\n            Application.DisplayAlerts = False\n            aSheet.Delete\n            Application.DisplayAlerts = True\n            Exit For 'done looking...\n        End If\n    Next aSheet\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 12116261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/400de1aef343d96689efe2803d356503?s=128&d=identicon&r=PG&f=1", "display_name": "Lynx0707", "link": "https://stackoverflow.com/users/12116261/lynx0707"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 0, "closed_date": 1572433215, "answer_count": 1, "score": 0, "last_activity_date": 1572433192, "creation_date": 1572394353, "last_edit_date": 1572433192, "question_id": 58617080, "link": "https://stackoverflow.com/questions/58617080/how-to-apply-a-vba-macro-to-all-excel-files-in-a-folder", "closed_reason": "Duplicate", "title": "How to apply a vba macro to all excel files in a folder?", "body": "<p>I would like to delete a worksheet on multiple excel workbooks. I already have some VBA code to delete a worksheet in a single file:</p>\n\n<pre><code>Sub delete_sheet()\nApplication.DisplayAlerts = False\nFor Each aSheet In Worksheets\n    Select Case aSheet.Name\n        Case \"INV.\"\n            aSheet.Delete\n    End Select\n\n    Next aSheet\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p>I have 500 files in my folder all needed to delete a tab named \"INV.\". How do I apply this operation to all the files within my folder? I have tried the example provided from this website: <a href=\"https://analystcave.com/vba-run-macro-on-all-files-in-a-folder-all-worksheets-in-a-workbook/\" rel=\"nofollow noreferrer\">https://analystcave.com/vba-run-macro-on-all-files-in-a-folder-all-worksheets-in-a-workbook/</a>:</p>\n\n<pre><code>Sub RunOnAllFilesInFolder()\n    Dim folderName As String, eApp As Excel.Application, fileName As String\n    Dim wb As Workbook, ws As Worksheet, currWs As Worksheet, currWb As Workbook\n    Dim fDialog As Object: Set fDialog = Application.FileDialog(msoFileDialogFolderPicker)\n    Set currWb = ActiveWorkbook: Set currWs = ActiveSheet\n\n    'Select folder in which all files are stored\n    fDialog.Title = \"Select a folder\"\n    fDialog.InitialFileName = currWb.Path\n    If fDialog.Show = -1 Then\n      folderName = fDialog.SelectedItems(1)\n    End If\n\n\n    'Create a separate Excel process that is invisibile\n    Set eApp = New Excel.Application:  eApp.Visible = False\n\n    'Search for all files in folder [replace *.* with your pattern e.g. *.xlsx]\n    fileName = Dir(folderName &amp; \"\\*.*\")\n    Do While fileName &lt;&gt; \"\"\n        'Update status bar to indicate progress\n        Application.StatusBar = \"Processing \" &amp; folderName &amp; \"\\\" &amp; fileName\n\n        Set wb = eApp.Workbooks.Open(folderName &amp; \"\\\" &amp; fileName)\n\n'I tried placing my code here\nSub delete_sheet()\nApplication.DisplayAlerts = False\nFor Each aSheet In Worksheets\n    Select Case aSheet.Name\n        Case \"INV.\"\n            aSheet.Delete\n    End Select\n\n    Next aSheet\n    Application.DisplayAlerts = True\nEnd Sub\n\n        wb.Close SaveChanges:=True 'Close opened worbook w/o saving, change as needed\n        Debug.Print \"Processed \" &amp; folderName &amp; \"\\\" &amp; fileName \n        fileName = Dir()\n    Loop\n    eApp.Quit\n    Set eApp = Nothing\n    'Clear statusbar and notify of macro completion\n    Application.StatusBar = \"\"\n    MsgBox \"Completed executing macro on all workbooks\"\nEnd Sub\n</code></pre>\n\n<p>It crashed my excel when I try to execute it. Any suggestions?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 540, "user_id": 7747667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6XJn7.jpg?s=128&g=1", "display_name": "oxwilder", "link": "https://stackoverflow.com/users/7747667/oxwilder"}, "edited": false, "score": 0, "creation_date": 1572395236, "post_id": 58616515, "comment_id": 103543678, "body": "What criteria are you using to select certain cells to copy and paste?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12294066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39c6e1cdcf90bb489ed90e92e8217efd?s=128&d=identicon&r=PG&f=1", "display_name": "VBANoob", "link": "https://stackoverflow.com/users/12294066/vbanoob"}, "edited": false, "score": 0, "creation_date": 1572451604, "post_id": 58618708, "comment_id": 103566168, "body": "Hey Capt_Krunch, that is soooo close. I was trying to move cells A6:A9 will be moved to A2:D2 cells A10:A13 will be moved to A3:D3 cells A14:A17 will be moved to A4:D4 and so on..."}, {"owner": {"reputation": 3, "user_id": 12294066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39c6e1cdcf90bb489ed90e92e8217efd?s=128&d=identicon&r=PG&f=1", "display_name": "VBANoob", "link": "https://stackoverflow.com/users/12294066/vbanoob"}, "edited": false, "score": 0, "creation_date": 1572451679, "post_id": 58618708, "comment_id": 103566217, "body": "Moving those 4 vertical data points in column A; horizontally on a row."}, {"owner": {"reputation": 90, "user_id": 3930365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c96de554e02517a04d7cd63b9212760?s=128&d=identicon&r=PG&f=1", "display_name": "Capt_Krunch", "link": "https://stackoverflow.com/users/3930365/capt-krunch"}, "reply_to_user": {"reputation": 3, "user_id": 12294066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39c6e1cdcf90bb489ed90e92e8217efd?s=128&d=identicon&r=PG&f=1", "display_name": "VBANoob", "link": "https://stackoverflow.com/users/12294066/vbanoob"}, "edited": false, "score": 0, "creation_date": 1572465733, "post_id": 58618708, "comment_id": 103572718, "body": "Thanks for the clarification, I have modified the code accordingly.  Hopefully that&#39;s what you&#39;re looking for."}, {"owner": {"reputation": 3, "user_id": 12294066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39c6e1cdcf90bb489ed90e92e8217efd?s=128&d=identicon&r=PG&f=1", "display_name": "VBANoob", "link": "https://stackoverflow.com/users/12294066/vbanoob"}, "edited": false, "score": 0, "creation_date": 1572546145, "post_id": 58618708, "comment_id": 103603166, "body": "You are my hero and have saved me hours of time. I can&#39;t thank you enough. I&#39;m slowly learning VBA and realizing how useful it is to all of my excel work. Thanks again!"}], "tags": [], "owner": {"reputation": 90, "user_id": 3930365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c96de554e02517a04d7cd63b9212760?s=128&d=identicon&r=PG&f=1", "display_name": "Capt_Krunch", "link": "https://stackoverflow.com/users/3930365/capt-krunch"}, "is_accepted": true, "score": 1, "last_activity_date": 1572465693, "last_edit_date": 1572465693, "creation_date": 1572409231, "answer_id": 58618708, "question_id": 58616515, "link": "https://stackoverflow.com/questions/58616515/cleaning-up-data-using-a-vba-macro/58618708#58618708", "title": "Cleaning up Data using a VBA Macro", "body": "<p>Based on your question, I've assumed that you have data that is vertically populated straight down in column A starting at cell A2 and ending at cell A13 in your sample data.  And you need that data transposed horizontally in groups of 4 such that:</p>\n\n<ul>\n<li>cells A6:A9 will be moved to B2:B5</li>\n<li>cells A10:A13 will be moved to C2:C5</li>\n<li>cells A14:A17 will be moved to D2:D5</li>\n<li>etc....</li>\n</ul>\n\n<p>If that is the correct assumption, then replace the code in your existing macro with the following, being sure to change the cell address for the 'lastCellInColumn' variable as needed:</p>\n\n<pre><code>Dim firstCellInDataColumn As Range\nDim lastCellInDataColumn As Range\nDim destinationCell As Range\nDim rowsPerDataGroup As Integer\nDim positionInGroup As Integer\nDim destinationRowOffset As Integer\nDim destinationColumnOffset As Integer\n\n'initialize first source cell, set destination cell to the cell adjacent right\nSet firstCellInDataColumn = Range(\"A2\")\nSet lastCellInDataColumn = Range(\"A13\")\nSet destinationCell = Range(firstCellInDataColumn.Offset(0, 1).Address)\n\nrowsPerDataGroup = 4 'number of data points in each dataset\npositionInGroup = 1 'counter to keep track of position within the group\ndestinationRowOffset = 1\ndestinationColumnOffset = 0\n\n'loop through all cells in the column\nFor Each cell In Range(firstCellInDataColumn, lastCellInDataColumn)\n    destinationCell.Value = cell.Value\n    If positionInGroup = rowsPerDataGroup Then 'start new destination column\n        positionInGroup = 1\n        destinationRowOffset = 1\n        destinationColumnOffset = -3\n    Else\n        positionInGroup = positionInGroup + 1\n        destinationRowOffset = 0\n        destinationColumnOffset = 1\n    End If\n    Set destinationCell = Range(destinationCell.Offset(destinationRowOffset, destinationColumnOffset).Address)\nNext cell\n\nColumns(\"A\").EntireColumn.Delete\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12294066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39c6e1cdcf90bb489ed90e92e8217efd?s=128&d=identicon&r=PG&f=1", "display_name": "VBANoob", "link": "https://stackoverflow.com/users/12294066/vbanoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 0, "accepted_answer_id": 58618708, "answer_count": 1, "score": 0, "last_activity_date": 1572465693, "creation_date": 1572389974, "last_edit_date": 1572397287, "question_id": 58616515, "link": "https://stackoverflow.com/questions/58616515/cleaning-up-data-using-a-vba-macro", "title": "Cleaning up Data using a VBA Macro", "body": "<p>I have a basic request. Yet I can't seem to find anything on here that really helps me. </p>\n\n<p>I'm trying to do some basic data clean up. I'm very new at VBA. So I recorded a macro that cleans up the data for me. </p>\n\n<p>However it's for thousands of rows of data, and my macro only works on the first few rows. I've created a basic form of what my data looks like. </p>\n\n<pre><code>Range(\"A8\").Select\nSelection.Copy\nRange(\"A2\").Select\nActiveSheet.Paste\nRange(\"A10\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nRange(\"A10\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nRange(\"B2\").Select\nActiveSheet.Paste\nRange(\"A12\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nRange(\"C2\").Select\nActiveSheet.Paste\nRange(\"A14\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nApplication.CutCopyMode = False\nSelection.Copy\nRange(\"A14\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nRange(\"D2\").Select\nActiveSheet.Paste\nRange(\"A17\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nRange(\"A3\").Select\nActiveSheet.Paste\nRange(\"A19\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nRange(\"B3\").Select\nActiveSheet.Paste\nRange(\"A21\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nRange(\"C3\").Select\nActiveSheet.Paste\nRange(\"A23\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nRange(\"D3\").Select\nActiveSheet.Paste\n</code></pre>\n\n<p>I'd like this to continue working. This is the example format for my data.\nName/Comments/Date/Cost &lt;- Header columns</p>\n\n<p>The following data is all in the same 'A' column.</p>\n\n<pre><code>john\n\nHello\n\n9/12/1999\n\n62\n\n\nTim\n\nYup\n\n9/13/1999\n\n623\n\nBetty\n\nRight on\n\n9/14/1999\n\n52\n</code></pre>\n\n<p>Thanks for any help on this.\n~Signed~\nThe VBA Noob</p>\n"}, {"tags": ["excel", "vba", "email", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12294115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dac269a8815a5c0b868501b787d86a0?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/12294115/michael"}, "edited": false, "score": 0, "creation_date": 1572433142, "post_id": 58619156, "comment_id": 103555477, "body": "Well shucks, that&#39;s what I feared.  Thanks a lot, Dmitry, really appreciate your quick response."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1572412693, "creation_date": 1572412693, "answer_id": 58619156, "question_id": 58616488, "link": "https://stackoverflow.com/questions/58616488/using-vba-to-set-alias-from-account-when-sending-emails-from-excel-in-outlook/58619156#58619156", "title": "Using VBA to set alias From account when sending emails from Excel in Outlook", "body": "<p>Outlook (at least in its current version) would not let you send using one of the proxy SMTP addresses - the message is always sent using the default SMTP address of the account.</p>\n\n<p>You can do that only if you either configure a dummy POP3/SMTP account or use a utility like <a href=\"http://www.dimastr.com/proxyman/\" rel=\"nofollow noreferrer\">Proxy Manager</a> - see <a href=\"https://www.msoutlook.info/question/send-mail-from-additional-exchange-address-or-alias\" rel=\"nofollow noreferrer\">https://www.msoutlook.info/question/send-mail-from-additional-exchange-address-or-alias</a> for more details.</p>\n"}], "owner": {"reputation": 11, "user_id": 12294115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dac269a8815a5c0b868501b787d86a0?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/12294115/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 379, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1572412693, "creation_date": 1572389793, "question_id": 58616488, "link": "https://stackoverflow.com/questions/58616488/using-vba-to-set-alias-from-account-when-sending-emails-from-excel-in-outlook", "title": "Using VBA to set alias From account when sending emails from Excel in Outlook", "body": "<p>hope you can help me out.</p>\n\n<p>I have a VBA script in Excel that, among many other things, sends an email via Outlook 365.  Now, my primary email account (@outlook.com) has five aliases.  These are not separate email accounts but merely aliases associated with that primary account (which itself is one out of a half a dozen primary accounts).  <a href=\"https://i.stack.imgur.com/opUt7.jpg\" rel=\"nofollow noreferrer\">See attached picture for maybe a better explanation</a>  I'd like to set one of those <strong>aliases</strong> as the From address but it's just not happening.</p>\n\n<p>This is the relevant snippet; everything else in the Sub, including creating the email and setting the attributes and attachments, works great.</p>\n\n<pre><code>Dim emailAlias As String\nemailAlias = \"f...@outlook.com\"\n\nSet Mail_Object = CreateObject(\"Outlook.Application\")\nSet Mail_Single = Mail_Object.CreateItem(0)\n\nWith Mail_Single\n     .Subject = Subject\n     .To = Cells(cellRow, 2).Value\n     .SentOnBehalfOfName = emailAlias     'doesn't work\n     .SendUsingAccount = emailAlias       'no go either\n     .HTMLBody = msg\n     .Attachments.Add fileName\n     .Display\nEnd With\n</code></pre>\n\n<p>What am I doing wrong?</p>\n\n<p>BTW, setting the alias as the default account can only be done online at live.com so that's not an option as it would be too cumbersome to have to (re)set it several times a day, plus it takes Outlook 365 forever to recognize the switch.</p>\n\n<p>So, is thee a way to specify an alias of a primary account as the From email address?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 12075957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5922293fdb11738b44c3847a3d0a0948?s=128&d=identicon&r=PG&f=1", "display_name": "riddlemethisagain", "link": "https://stackoverflow.com/users/12075957/riddlemethisagain"}, "edited": false, "score": 0, "creation_date": 1572391473, "post_id": 58616680, "comment_id": 103542883, "body": "I appreciate the answer and will upvote, however I was explicitly looking for experience with userforms but thank you so much."}, {"owner": {"reputation": 76, "user_id": 10967394, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uBVMpIF-W6o/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNHO_I_zzQaiIXYPG2hhQ1w-w-ObA/mo/photo.jpg?sz=128", "display_name": "Tomek Kubiak", "link": "https://stackoverflow.com/users/10967394/tomek-kubiak"}, "reply_to_user": {"reputation": 21, "user_id": 12075957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5922293fdb11738b44c3847a3d0a0948?s=128&d=identicon&r=PG&f=1", "display_name": "riddlemethisagain", "link": "https://stackoverflow.com/users/12075957/riddlemethisagain"}, "edited": false, "score": 0, "creation_date": 1572392289, "post_id": 58616680, "comment_id": 103543082, "body": "Ok, so if it&#39;s just for the training purposes, then I&#39;d suggest to start with putting four ListBoxes on the form and setting MultiSelect property to 1 (&quot;fmMultiSelectMulti&quot;) for each of them. It allows for selecting multiple elements from the list. I think you may also like &quot;ListStyle&quot; property setting to 1 (&quot;fmListStyleOpen&quot;) to see a checkbox next to every available option. Then you&#39;ll need to populate the listboxes (each list may require removing duplicates and sorting) and add some events to them to apply filtering on the table."}], "tags": [], "owner": {"reputation": 76, "user_id": 10967394, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uBVMpIF-W6o/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNHO_I_zzQaiIXYPG2hhQ1w-w-ObA/mo/photo.jpg?sz=128", "display_name": "Tomek Kubiak", "link": "https://stackoverflow.com/users/10967394/tomek-kubiak"}, "is_accepted": false, "score": 0, "last_activity_date": 1572390984, "creation_date": 1572390984, "answer_id": 58616680, "question_id": 58616461, "link": "https://stackoverflow.com/questions/58616461/trying-to-create-a-userform-in-vba-that-returns-a-set-of-values-specified-based/58616680#58616680", "title": "Trying to create a userform in VBA that returns a set of values specified based on criteria from data in an existing spreadsheet", "body": "<p>Have you considered converting your data into table and using the slicers instead of creating UserForm?\nIt's much easier and faster. It's also quite flexible, reliable and - if I have understood correctly your expectation - it should fit your needs.</p>\n\n<p>To convert range into table you need to go to the \"Insert\" tab and click \"Table\" from \"Tables Group\" and input proper range.\nThen select any cell in the created table, go to \"Design\" tab and click \"Add slicer\" (or sth like this - I have Polish Office, so don't know the exact English title of the button) from the \"Tools\" group. -> voila! You have four small  windows that allows filtering in any combination you need!</p>\n"}], "owner": {"reputation": 21, "user_id": 12075957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5922293fdb11738b44c3847a3d0a0948?s=128&d=identicon&r=PG&f=1", "display_name": "riddlemethisagain", "link": "https://stackoverflow.com/users/12075957/riddlemethisagain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1572390984, "creation_date": 1572389580, "question_id": 58616461, "link": "https://stackoverflow.com/questions/58616461/trying-to-create-a-userform-in-vba-that-returns-a-set-of-values-specified-based", "title": "Trying to create a userform in VBA that returns a set of values specified based on criteria from data in an existing spreadsheet", "body": "<p>I have this set of hypothetical data in a worksheet in Excel.</p>\n\n<p><strong>Phone</strong>    <strong>Storage</strong>    <strong>Price</strong>   <strong>Color</strong> </p>\n\n<p>iPhone   32 GB      100     Black</p>\n\n<p>Galaxy   64 GB      100     Black</p>\n\n<p>Pixel    64 GB      200     Black</p>\n\n<p>I would like to create a userform that will be displayed after clicking a button (I know how to do this). The userform will have list boxes, spin boxes, check boxes, frames, etc. for each of the 4 criteria. The user will then enter their desired criteria and the macro will output the available options or return an error if the specified criteria does not exist. Also, if a user does not want ot include a specific criteria (say color) then this should be considered.</p>\n\n<p>Expected output:</p>\n\n<p>If the user says Phone name and storage are irrelevant and checks 100 for price and black for color. The output should produce all the information for the iPhone and Galaxy.</p>\n\n<p>Anything helps.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1572388695, "post_id": 58616255, "comment_id": 103542232, "body": "Have you tried renaming <code>UserForm1</code> to <code>UserForm0</code> before you import the exported form?"}], "answers": [{"tags": [], "owner": {"reputation": 76, "user_id": 10967394, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uBVMpIF-W6o/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNHO_I_zzQaiIXYPG2hhQ1w-w-ObA/mo/photo.jpg?sz=128", "display_name": "Tomek Kubiak", "link": "https://stackoverflow.com/users/10967394/tomek-kubiak"}, "is_accepted": true, "score": 3, "last_activity_date": 1572389707, "creation_date": 1572389707, "answer_id": 58616473, "question_id": 58616255, "link": "https://stackoverflow.com/questions/58616255/how-to-copy-duplicate-an-userform/58616473#58616473", "title": "How to copy/duplicate an UserForm", "body": "<p>That's because the proper name of the Form is hidden inside the file and the file name itself is ignored during the form import. If you actually need to have a second UserForm just in the project, then I'd suggest to do as follows:</p>\n\n<ol>\n<li>export UserForm1 As it is (without renaming during saving)</li>\n<li>rename UserForm1 to UserForm2 (just in properties window)</li>\n<li>import UserForm1</li>\n</ol>\n\n<p>However I'd suggest to consider creating an another instance of the form and amend it dynamically if neccessary - that may help to avoid updating each UserForm separately.</p>\n\n<p>e.g.:</p>\n\n<pre><code>dim f1 as new UserForm1\ndim f2 as new UserForm1\n\nf1.show\nf2.show\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "is_accepted": false, "score": 2, "last_activity_date": 1572403686, "creation_date": 1572403686, "answer_id": 58618067, "question_id": 58616255, "link": "https://stackoverflow.com/questions/58616255/how-to-copy-duplicate-an-userform/58618067#58618067", "title": "How to copy/duplicate an UserForm", "body": "<blockquote>\n  <p><strong>For anyone coming to this thread because they want to use the same form in the same project, follow the advice provided by @ Tomek Kubiak.</strong></p>\n</blockquote>\n\n<p>For everyone else, I supposed you \"could\" Export/Rename/Import but you'd have to open a menu and select export and deal with the hassle of saving a file and that's not even half of it, you have to open another menu to get it back in addition to remembering where you saved it. And rename it!?!  That's too much work for me to keep track of and if you're like me you've already forgotten the third step.</p>\n\n<p><em>So what I do, is open a second instance of Excel, drag the module over to that project and then drag it back.</em>  Technically I suppose it can be argued that you're still exporting, renaming, and importing... But it sure doesn't feel like it.</p>\n\n<p>.</p>\n"}], "owner": {"reputation": 131, "user_id": 11724559, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WDpomKXErPE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reAxSRy0dKrkQtLiADHFOE46sPayA/photo.jpg?sz=128", "display_name": "Noelia Sancho Mendez", "link": "https://stackoverflow.com/users/11724559/noelia-sancho-mendez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1081, "favorite_count": 0, "accepted_answer_id": 58616473, "answer_count": 2, "score": 0, "last_activity_date": 1572403686, "creation_date": 1572388174, "last_edit_date": 1572388216, "question_id": 58616255, "link": "https://stackoverflow.com/questions/58616255/how-to-copy-duplicate-an-userform", "title": "How to copy/duplicate an UserForm", "body": "<p>The problem is I've already created an UserForm and now I need another one with the same design and code. </p>\n\n<p>I tried to perfom the usual copy/paste with the UserForm selected but It doesn't work. In fact, the option copy/paste appears disabled in the edition group in VBA Editor. </p>\n\n<p><a href=\"https://i.stack.imgur.com/H10J0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/H10J0.png\" alt=\"enter image description here\"></a></p>\n\n<p>I've already tried to export the UserForm and change the name at the time to save it and import it again in my proyect but It retuns me a name matching error.</p>\n\n<p>As I show in the following image I exported the UserForm with another name from the original UserForm which name is UserForm1, instead I saved this one as UserForm2.</p>\n\n<p><a href=\"https://i.stack.imgur.com/s95m5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s95m5.png\" alt=\"enter image description here\"></a></p>\n\n<p>This action returns me an error about the name 'UserForm1' is already used.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Arjos.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Arjos.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>I need to duplicate this UserForm in my proyect changing the name</strong> </p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 2, "creation_date": 1572388939, "post_id": 58616088, "comment_id": 103542288, "body": "You may find using a scripting.dictionary is easier as this object has a built in &#39;exists&#39; method.  You will need to add a reference to the Microsoft Scripting Runtime to enable the use of Scripting.dictionaries with intellisense."}, {"owner": {"reputation": 481, "user_id": 4647394, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06d6fcb008fd47cdc43d3964580baf4a?s=128&d=identicon&r=PG&f=1", "display_name": "seadoggie01", "link": "https://stackoverflow.com/users/4647394/seadoggie01"}, "edited": false, "score": 0, "creation_date": 1572398709, "post_id": 58616088, "comment_id": 103544340, "body": "Looks like you have your keys/values flipped... I think (since you didn&#39;t post the full code) that &quot;{{percentOpen}}&quot; is the value, not the key"}], "owner": {"reputation": 430, "user_id": 2023912, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/63f7a746dc4037af739566edc7d42a24?s=128&d=identicon&r=PG", "display_name": "akes406", "link": "https://stackoverflow.com/users/2023912/akes406"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572387436, "creation_date": 1572387070, "last_edit_date": 1572387436, "question_id": 58616088, "link": "https://stackoverflow.com/questions/58616088/collection-return-value-from-key", "title": "Collection return value from key", "body": "<p>I am having issues returning a value from a collection using the key.  </p>\n\n<p>The GetPercentsUpdateCharts sub is creating a new collection and placing a new value into it with key {{percentOpen}} and value \"Test\".</p>\n\n<p>The Contains function written with Debug.Print is outputting true which proves the key exists in the collection.</p>\n\n<p>The Retrieve function always returns \"Not Found\".</p>\n\n<p>Where did I go wrong with this?</p>\n\n<pre><code>Private Sub GetPercentsUpdateCharts()\n    Set colPercentTokens = Nothing\n    Set colPercentTokens = New Collection\n\n    'Calculate Percents and Update Charts\n    Store colPercentTokens, \"{{percentOpen}}\", \"Test\"\n    Debug.Print Contains(colPercentTokens, \"{{percentOpen}}\")\n    Debug.Print Retrieve(colPercentTokens, \"{{percentOpen}}\")\nEnd Sub\n\nPublic Function Contains(col As Collection, key As String) As Boolean\n    On Error GoTo NotFound\n    Dim itm As Object\n\n    Set itm = col(key)\n    Contains = True\n\nMyExit:\n    Exit Function\n\nNotFound:\n    Contains = False\n    Resume MyExit\n\nEnd Function\n\nPublic Function Retrieve(col As Collection, key As String) As String\n    On Error GoTo NotFound\n    Dim itm As Object\n\n    Set itm = col(key)\n    Retrieve = CStr(itm)\nMyExit:\n    Exit Function\n\nNotFound:\n    Retrieve = \"Not Found\"\n    Resume MyExit\n\nEnd Function\n\nPublic Sub Store(col As Collection, k As String, v As String)\n    Dim kv As Object\n\n    If (Contains(col, k)) Then\n        Set kv = col(k)\n        kv.value = v\n    Else\n        Set kv = New KeyValue\n        kv.Init k, v\n        col.Add kv, k\n   End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 540, "user_id": 7747667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6XJn7.jpg?s=128&g=1", "display_name": "oxwilder", "link": "https://stackoverflow.com/users/7747667/oxwilder"}, "is_accepted": false, "score": 0, "last_activity_date": 1572398651, "creation_date": 1572398651, "answer_id": 58617547, "question_id": 58615924, "link": "https://stackoverflow.com/questions/58615924/how-to-select-certain-ranges-for-certain-cases/58617547#58617547", "title": "How to select certain ranges for certain cases?", "body": "<p>I think you were on the right track here with a <code>select case</code> statement.</p>\n\n<p>The below will ask the user to type in 1 to 3 to select which range gets copied and then adds a sheet and copies it to the same address as the range on sheet 1. That's probably not the ideal place to put it, but I'll let you handle the destination address.</p>\n\n<pre><code>Public Sub selectRange()\n\nDim cpyRng As Range\nDim sht1 As Worksheet, sht2 As Worksheet\nDim sIn As String\n\nSet sht1 = ActiveSheet\nSet sht2 = ActiveWorkbook.Sheets.Add(after:=ActiveWorkbook.Worksheets(ActiveWorkbook.Worksheets.Count))\nsht2.Name = \"CopiedData\"\n\n    sIn = Application.InputBox(\"Please select 1 to 3\" &amp; vbLf &amp; vbLf &amp; _\n    \"1. Input\" &amp; vbLf &amp; _\n    \"2. Output\" &amp; vbLf &amp; _\n    \"3. P\", \"Enter a value\", 1)\n    If sIn = False Then\n        Exit Sub\n    Else\n    With sht1\n        Select Case sIn\n            Case 1\n                Set cpyRng = .Range([c8], [f8])  'do what you want for each case\n            Case 2\n                Set cpyRng = .Range([h8], [k8])\n            Case 3\n                Set cpyRng = .Range([m8], [p8])\n            Case Else\n                dummy = MsgBox(\"wrong input\", vbCritical)\n                Exit Sub\n        End Select\n        End With\n    End If\n\ncpyRng.Copy Destination:=sht2.Range(cpyRng.Address)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 12293980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f86d0f25368a909d7ad43a85767461a?s=128&d=identicon&r=PG&f=1", "display_name": "atschoe", "link": "https://stackoverflow.com/users/12293980/atschoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572398651, "creation_date": 1572386027, "last_edit_date": 1572387050, "question_id": 58615924, "link": "https://stackoverflow.com/questions/58615924/how-to-select-certain-ranges-for-certain-cases", "title": "How to select certain ranges for certain cases?", "body": "<p>I am trying to have the user select a certain range (input, output, or p), and copy their selected cells into a new worksheet. I already have the latter half, but am having trouble creating a function to do the first part.</p>\n\n<p>In short, if the user wants to see input, they will select the input \"option\", then my code will highlight only cells C8 through F8, and copy into a new worksheet. If they choose output, then my code will highlight only cells H8 through K8, and so on. I am new to VBA!</p>\n\n<p>I have tried using an If statement and looked briefly into Case.</p>\n\n<pre><code>Dim myRange As Range\nDim inputRange As Range\nDim outputRange As Range\nDim pRange As Range\n\nSet inputRange = Range(Range(\"C8\"), Range(\"F8\"))\nSet outputRange = Range(Range(\"H8\"), Range(\"K8\"))\nSet pRange = Range(Range(\"M8\"), Range(\"P8\"))\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4499805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60daeb69f139f9e5fef60e87dd3a1f06?s=128&d=identicon&r=PG&f=1", "display_name": "Kenstar", "link": "https://stackoverflow.com/users/4499805/kenstar"}, "edited": false, "score": 0, "creation_date": 1572437972, "post_id": 58619234, "comment_id": 103558000, "body": "Setting the instance to an dedicated variable worked, thank you so much!"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1572413217, "creation_date": 1572413217, "answer_id": 58619234, "question_id": 58615606, "link": "https://stackoverflow.com/questions/58615606/issue-getting-recurring-meetings-from-outlook-to-excel-in-vba/58619234#58619234", "title": "Issue getting recurring meetings from outlook to excel in vba", "body": "<p>You are calling <code>Sort</code> and set <code>IncludeRecurrences</code> on two different instances of the <code>Items</code> object that know nothing about each other. Store <code>Items</code> object in a dedicated variable.</p>\n\n<p>Also keep in mind that <code>IncludeRecurrences</code> will only work if you restrict on a range of dates - <code>Sort</code> won't work: think of appointments with no end date.</p>\n\n<p>See <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.items.includerecurrences\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/outlook.items.includerecurrences</a> for an example.</p>\n"}], "owner": {"reputation": 25, "user_id": 4499805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60daeb69f139f9e5fef60e87dd3a1f06?s=128&d=identicon&r=PG&f=1", "display_name": "Kenstar", "link": "https://stackoverflow.com/users/4499805/kenstar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "accepted_answer_id": 58619234, "answer_count": 1, "score": 1, "last_activity_date": 1572413217, "creation_date": 1572384143, "question_id": 58615606, "link": "https://stackoverflow.com/questions/58615606/issue-getting-recurring-meetings-from-outlook-to-excel-in-vba", "title": "Issue getting recurring meetings from outlook to excel in vba", "body": "<p>I am working on a macro to get outlook calendar data to excel. For the most part it work, however I am not getting recurring appointments or meetings. I know from <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Outlook.Items.IncludeRecurrences\" rel=\"nofollow noreferrer\">this Microsoft documentation</a> that I need to add the IncludeReferences value. It is in my code but I am still not getting those recurring meetings. Any help would be greatly appreciated, thank you!</p>\n\n<pre><code>Set olNS = olApp.GetNamespace(\"MAPI\")\nSet olFolder = olNS.GetDefaultFolder(9) 'olFolderCalendar\nNextRow = 2\n\nolFolder.Items.Sort \"[Start]\"\nolFolder.Items.IncludeRecurrences = True\n\nWith Sheets(\"Sheet1\") \n    .Range(\"C1:F1\").Value = Array(\"Project\", \"Date\", \"Timespent\", \"Categories\") '\"Location\", \"Categories\")\n    For Each olApt In olFolder.Items\n        --Do Stuff--\n    Next olApt\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21, "user_id": 10051066, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160489369140161/picture?type=large", "display_name": "LeSauvage", "link": "https://stackoverflow.com/users/10051066/lesauvage"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1572384916, "post_id": 58615586, "comment_id": 103541217, "body": "@cybernetic.nomad I want to merge cells left and right,  I am not sure how conditional formatting would help.  I added a picture for what I would like to accomplish"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1572444581, "post_id": 58615586, "comment_id": 103561937, "body": "Actually, quite nice input in the question, thinking of lots of corner cases. Good job, consider attending QA courses as well, this is the way to go (info from your profile) (:"}], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1572388671, "post_id": 58615906, "comment_id": 103542225, "body": "Quite sophisticated, <b>but</b> I know you know why <code>myRange</code> starts from the second column in your example. ;)"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1572447430, "post_id": 58615906, "comment_id": 103563746, "body": "@Vityata - indeed I do :) I&#39;ve added a brief paragraph explaining why to my answer"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1572447523, "post_id": 58615906, "comment_id": 103563796, "body": "As I mentioned, I knew you know it :) More interesting question, though - can you make it work with column &quot;A&quot; and the same logic?"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1572447790, "post_id": 58615906, "comment_id": 103563954, "body": "@Vityata - I understood it as a hint to add an explanation (then saw your more complete one afterwards...). Not sure I understand what you mean by &quot;can you make it work with column &quot;A&quot; and the same logic&quot;. Cells in column <code>A</code> will get merged if they match what&#39;s in column <code>B</code>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1572447937, "post_id": 58615906, "comment_id": 103564049, "body": "Imagine that the initial range that is passed is <code>&quot;A1:H30&quot;</code> and it should work with this one. I was thinking of using <code>mod</code> operator and the length of the row or something, thus skipping every first column."}], "tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": false, "score": 0, "last_activity_date": 1572459734, "last_edit_date": 1572459734, "creation_date": 1572385903, "answer_id": 58615906, "question_id": 58615586, "link": "https://stackoverflow.com/questions/58615586/vba-merge-similar-cells/58615906#58615906", "title": "VBA Merge Similar Cells", "body": "<p>I'm pretty sure what bloats your processing time is the <code>goto</code> causing you to loop through everything yet again every time after every merge</p>\n\n<p>Edit to take column <code>A</code> into account and prevent first column cells to merge with cells outside of <code>myRange</code>:</p>\n\n<pre><code>Sub MergeSimilarCells()\n\nDim i As Long\nDim myCol As String\n\n\nSet myRange = Range(\"K1:L30\")\n\nmyCol = Left(myRange.Address(True, False), InStr(myRange.Offset(0, 1).Address(True, False), \"$\") - 1)\n\nIf Not Intersect(myRange, Range(myCol &amp; \":\" &amp; myCol)).Address = myRange.Address Then\n    Set myRange = Range(Replace(myRange.Address, Left(myRange.Address(True, False), _\n        InStr(myRange.Address(True, False), \"$\")), Left(myRange.Offset(0, 1).Address(True, False), _\n        InStr(myRange.Offset(0, 1).Address(True, False), \"$\"))))\n    For i = myRange.Cells.Count To 1 Step -1\n        If myRange.Item(i).Value = myRange.Item(i).Offset(0, -1).Value And Not IsEmpty(myRange.Item(i)) Then\n            Range(myRange.Item(i), myRange.Item(i).Offset(0, -1)).Merge\n            myRange.Item(i).VerticalAlignment = xlCenter\n            myRange.Item(i).HorizontalAlignment = xlCenter\n        End If\n    Next\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>To clarify why <code>myRange</code> has to start in column <code>B</code>: <code>Offset(0, -1)</code> of any cell in column <code>A</code> will cause an error since there is no column to the left of <code>A</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1572389054, "last_edit_date": 1572389054, "creation_date": 1572388394, "answer_id": 58616286, "question_id": 58615586, "link": "https://stackoverflow.com/questions/58615586/vba-merge-similar-cells/58616286#58616286", "title": "VBA Merge Similar Cells", "body": "<pre><code>Sub MergeMe()    \n\n    Dim wks As Worksheet: Set wks = Worksheets(1)\n    Dim myRange As Range: Set myRange = wks.Range(\"B2:H5\")\n    Dim myCell As Range\n    Dim myCell2 As Range\n\n    Dim firstColumn As Long: firstColumn = myRange.Columns(1).column + 1\n    Dim lastColumn As Long: lastColumn = firstColumn + myRange.Columns.Count - 1\n    Dim firstRow As Long: firstRow = myRange.Rows(1).row\n    Dim lastRow As Long: lastRow = firstRow + myRange.Rows.Count - 1\n    Dim column As Long\n    Dim row As Long\n\n    OnStart\n\n    For column = lastColumn To firstColumn Step -1\n        For row = lastRow To firstRow Step -1\n            Set myCell = wks.Cells(row, column)\n            Set myCell2 = myCell.Offset(0, -1)\n            If myCell.Value = myCell2.Value Then\n                With wks.Range(myCell, myCell2)\n                    .Merge\n                    .VerticalAlignment = xlCenter\n                    .HorizontalAlignment = xlCenter\n                End With\n            End If\n        Next row\n    Next column\n\n    OnEnd\n\nEnd Sub\n</code></pre>\n\n<p>There are quite a few tricks in this code:</p>\n\n<ul>\n<li>we need to get the first and last column and row;</li>\n<li>then we should be looping from the last cell (bottom right) to the first one (top left);</li>\n<li>we should not enter the first column, because we are using <code>.Offset(0,-1)</code> and we compare every cell with its leftmost one;</li>\n<li><strong>the reason for the whole operation</strong>, is that by default, the value of a merged cells is kept in its left top cell. The other cells of a merged cell are without a value. </li>\n<li>This is why we always compare the merged cells with their \"left\" neighbour;</li>\n</ul>\n\n<p>These are the <code>OnEnd</code> and <code>OnStart</code>, facilitating the operation.</p>\n\n<pre><code>Public Sub OnEnd()\n\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n    Application.AskToUpdateLinks = True\n    Application.DisplayAlerts = True\n    Application.Calculation = xlAutomatic\n    ThisWorkbook.Date1904 = False\n    Application.StatusBar = False\n\nEnd Sub\n\nPublic Sub OnStart()\n\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n    Application.AskToUpdateLinks = False\n    Application.DisplayAlerts = False\n    Application.Calculation = xlAutomatic\n    ThisWorkbook.Date1904 = False\n    ActiveWindow.View = xlNormalView\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1572444321, "post_id": 58617132, "comment_id": 103561780, "body": "Tim, it is a really interesting solution, <b>but</b> it does not work. Have you tried it with the input data from the OP? I have just tried it, and in the lower right corner, it did not merge the word &quot;Class&quot;. Tried it on range &quot;B2:H5&quot;. So, time to rewrite... :D"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1572444502, "post_id": 58617132, "comment_id": 103561887, "body": "And it also does not merge the word &quot;Class&quot; on the third row completely... The input from the OOP is quite nice, give it a try."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1572452447, "post_id": 58617132, "comment_id": 103566665, "body": "@Vityata - thanks, fixed.  I should test using the OP&#39;s data..."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1572452398, "last_edit_date": 1572452398, "creation_date": 1572394885, "answer_id": 58617132, "question_id": 58615586, "link": "https://stackoverflow.com/questions/58615586/vba-merge-similar-cells/58617132#58617132", "title": "VBA Merge Similar Cells", "body": "<p>Only one merge per group</p>\n\n<p>EDITED to fix - thanks Vityata for the heads-up</p>\n\n<pre><code>Sub MergeEm()\n\n    Dim rw As Range, i As Long, s As Long, v\n\n    Range(\"C21:J33\").Copy Range(\"C5:J17\")  'for testing purposes: replace previous run\n\n    Application.ScreenUpdating = False\n    For Each rw In Range(\"C5:J17\").Rows 'or wherever\n        i = 1\n        s = 1\n        Do While i &lt; (rw.Cells.Count)\n            v = rw.Cells(i).Value\n            'check for a run of same values\n            Do While Len(v) &gt; 0 And v = rw.Cells(i + s).Value\n                s = s + 1\n                If i + s &gt; rw.Cells.Count Then Exit Do\n            Loop\n            'if s&gt;1 then had a run: merge those ells\n            If s &gt; 1 Then\n                Application.DisplayAlerts = False\n                rw.Cells(i).Resize(1, s).Merge\n                rw.Cells(i).HorizontalAlignment = xlCenter\n                Application.DisplayAlerts = True\n                i = i + s 'skip over the merged range\n                s = 1     'reset s\n            Else\n                i = i + 1\n            End If\n        Loop\n    Next rw\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10051066, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160489369140161/picture?type=large", "display_name": "LeSauvage", "link": "https://stackoverflow.com/users/10051066/lesauvage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1572459734, "creation_date": 1572384052, "last_edit_date": 1572384858, "question_id": 58615586, "link": "https://stackoverflow.com/questions/58615586/vba-merge-similar-cells", "title": "VBA Merge Similar Cells", "body": "<p>I would like to merge similar cells by columns, as of now I am using this macro</p>\n\n<pre><code>Sub MergeSimilarCells()\n\n    Set myRange = Range(\"A1:Z300\")\n\nCheckAgain:\n    For Each cell In myRange\n        If cell.Value = cell.Offset(0, 1).Value And Not IsEmpty(cell) Then\n            Range(cell, cell.Offset(0, 1)).Merge\n            cell.VerticalAlignment = xlCenter\n            cell.HorizontalAlignment = xlCenter\n            GoTo CheckAgain\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>My problem is with hundreds of rows and 40-50 columns, it takes forever. \nI am pretty sure a For Loop could help me there but I am not skilled enough to figure it out</p>\n\n<p>I know the following code is wrong but I am lost </p>\n\n<pre><code>Sub SimilarCells()\n  Set myRange = Range(\"A1:G4\")\n    Dim count As Integer\n\nCheckAgain:\n    count = 1\n\n    For Each cell In myRange\n        If cell.Value = cell.Offset(0, 1).Value And Not IsEmpty(cell) Then\n            count = count + 1\n\n        ElseIf cell.Value &lt;&gt; cell.Offset(0, 1).Value Then\n            Range(cell, cell.Offset(0, -count)).Merge\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/A5YlA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/A5YlA.png\" alt=\"Excel example data\"></a></p>\n\n<p>Here is what I would like to accomplish</p>\n\n<p><a href=\"https://i.stack.imgur.com/MGkIE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MGkIE.png\" alt=\"Final Result\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1572382900, "post_id": 58615369, "comment_id": 103540505, "body": "you will need to loop and run each value through the function one at a time."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1572433502, "post_id": 58615369, "comment_id": 103555668, "body": "You might benefit from reading  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>."}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1572433839, "creation_date": 1572433839, "answer_id": 58624067, "question_id": 58615369, "link": "https://stackoverflow.com/questions/58615369/how-can-i-apply-remove-alphabet-function-on-active-sheet-loop/58624067#58624067", "title": "How can i apply remove alphabet function on active sheet loop?", "body": "<p>The issue is that you cannot run the function <code>.Value = StripChar(.Value)</code> on a range at once (as you tried) but only on a single cell. Therfore you need to loop from row <code>2</code> to <code>LastRow</code> and apply the function to each single cell.</p>\n\n<p>Also note that row counting variables need to be of type <code>Long</code> because Excel has more rows than <code>Integer</code> can handle. Actually I recommend <a href=\"https://stackoverflow.com/questions/26409117/why-use-integer-instead-of-long/26409520#26409520\">always to use <code>Long</code> instead of <code>Integer</code></a> as there is no benefit in using <code>Integer</code> in VBA.</p>\n\n<p>Also if you set your worksheet to a variable <code>ws</code> you need to use this variable for <strong>all</strong> <code>.Cells</code> and <code>.Range</code> objects otherwise this is useless.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Alphabetremove()\n    Dim ws As Worksheet\n    Set ws = ActiveSheet 'better define a workseet by name unless you use the code for multiple worksheets: \n                         'Set ws = ThisWorkbook.Worksheets(\"MySheet\")\n\n    Dim LastRow As Long\n    LastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row\n\n    Dim Cell As Range\n    For Each Cell In ws.Range(\"F2:F\" &amp; LastRow)\n        Cell.Value = StripChar(Cell.Value)\n    Next Cell\nEnd Sub\n</code></pre>\n\n<p>Finally I highly recommend you to read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a> and apply this to all of your code.</p>\n"}], "owner": {"reputation": 61, "user_id": 10442755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f935cb080ed82d3ef574687457898a5c?s=128&d=identicon&r=PG&f=1", "display_name": "Alvi", "link": "https://stackoverflow.com/users/10442755/alvi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 58624067, "answer_count": 1, "score": 0, "last_activity_date": 1572433839, "creation_date": 1572382821, "last_edit_date": 1572433245, "question_id": 58615369, "link": "https://stackoverflow.com/questions/58615369/how-can-i-apply-remove-alphabet-function-on-active-sheet-loop", "title": "How can i apply remove alphabet function on active sheet loop?", "body": "<pre><code>Function StripChar(Txt As String) As String\nWith CreateObject(\"VBScript.RegExp\")\n.Global = True\n.Pattern = \"\\D\"\nStripChar = .Replace(Txt, \"\")\nEnd With\nEnd Function\n</code></pre>\n\n<p>So i am trying to apply this function on bottom range via loop through cells</p>\n\n<pre><code>Sub Alphabetremove()\n    Dim ws As Worksheet\n    Dim Lastrow As Integer\n    Set ws = ActiveSheet\n    Lastrow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\n    Range(\"F2:F\" &amp; Lastrow).Select\n    With Selection\n    .Value = StripChar(.Value)\nEnd With\nEnd Sub\n\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1572384362, "post_id": 58615336, "comment_id": 103541038, "body": "There are plenty of existing posts here on SO which cover how to search subfolders for files - for example: <a href=\"https://stackoverflow.com/questions/43284289/convert-rtf-to-docx-from-selected-folder-and-its-subfolders-in-vba/43286419#43286419\" title=\"convert rtf to docx from selected folder and its subfolders in vba\">stackoverflow.com/questions/43284289/&hellip;</a>   It might be better to run this in &quot;batch&quot; mode - ie. find all files matching *.jpg and then search that returned set of file names for your missing files.  If you ran this per-line using a user-defined formula it would be relatively slow, since you&#39;d be searching the whole collection once for every missing row."}, {"owner": {"reputation": 1360, "user_id": 211765, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0b35f202b6bd3bdbab813e90805eadc9?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/211765/tom"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1572390266, "post_id": 58615336, "comment_id": 103542597, "body": "@TimWilliams Can you remove the duplicate comment please?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1360, "user_id": 211765, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0b35f202b6bd3bdbab813e90805eadc9?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/211765/tom"}, "edited": false, "score": 0, "creation_date": 1572391266, "post_id": 58615336, "comment_id": 103542834, "body": "@Tom - done, thanks"}, {"owner": {"reputation": 1, "user_id": 12293660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff3ee5f7c9a07a765be68ec99a69d3f9?s=128&d=identicon&r=PG&f=1", "display_name": "GDD", "link": "https://stackoverflow.com/users/12293660/gdd"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1572461525, "post_id": 58615336, "comment_id": 103570993, "body": "@Tim - Thanks for the feedback. Yes, I definitely want to avoid it being slow if possible, especially since there&#39;s already a slight slowdown with the formulas/code that I have there currently. If I was going to run something in batch mode, how would I go about doing that? From what I understand, for what I have running right now, the VBA is placed in Module1, and then it&#39;s utilized like a regular Excel function within the formula on each line, but what it sounds like you&#39;re talking about is essentially doing the opposite. I apologize in advance, I&#39;m just really flying blind here."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1572462155, "post_id": 58615336, "comment_id": 103571232, "body": "How many total files do you have, are they all named xxxxx.jpg (5 digits plus &quot;.jpg&quot;) and are the file names unique?"}, {"owner": {"reputation": 1, "user_id": 12293660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff3ee5f7c9a07a765be68ec99a69d3f9?s=128&d=identicon&r=PG&f=1", "display_name": "GDD", "link": "https://stackoverflow.com/users/12293660/gdd"}, "edited": false, "score": 0, "creation_date": 1572463833, "post_id": 58615336, "comment_id": 103571931, "body": "For this year, there are currently 3,663 total files, however, as more files are created each day, the number of total files will never stay the same for very long (along with this year, I&#39;d also want to use this in the workbook for each upcoming year). Yes, each file is named with 5 digits and as a .jpg. The files are organized by year, then month, then day, ex - &quot;A:\\Pictures\\Document Pictures\\Tickets\\2019\\January 2019\\January 2, 2019\\xxxxx.jpg&quot;. As such, files will always be uniquely named within each day, but within the year as a whole, it&#39;s possible there could be files with the same name."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12293660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff3ee5f7c9a07a765be68ec99a69d3f9?s=128&d=identicon&r=PG&f=1", "display_name": "GDD", "link": "https://stackoverflow.com/users/12293660/gdd"}, "edited": false, "score": 0, "creation_date": 1572460769, "post_id": 58622229, "comment_id": 103570677, "body": "Thanks for the feedback. I apologize, but I don&#39;t know enough to be able to successfully adjust anything in the code; I know next to nothing about VBA except for how to record macros in Excel and then possibly slightly modify the resulting VBA to try to accomplish what I need. I can usually combine functions to create formulas in Excel without a problem, but to me, that&#39;s far more straightforward than VBA, where I don&#39;t even know where to begin. If it would help, I could provide more information about whatever you need if it would help communicate what I&#39;m trying to do more clearly."}], "tags": [], "owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "is_accepted": false, "score": 0, "last_activity_date": 1572427814, "creation_date": 1572427814, "answer_id": 58622229, "question_id": 58615336, "link": "https://stackoverflow.com/questions/58615336/is-there-a-way-to-determine-if-a-specific-file-exists-somewhere-within-a-series/58622229#58622229", "title": "Is there a way to determine if a specific file exists somewhere within a series of subfolders?", "body": "<p>As there is no too much detail regarding your DataSheet structure, try this one:</p>\n\n<pre><code>Sub ListMyFiles(mySourcePath, IncludeSubfolders, File)\n    Set MyObject = New Scripting.FileSystemObject\n    Set mySource = MyObject.GetFolder(mySourcePath)\n    On Error Resume Next\n    For Each myFile In mySource.Files\n\n         'LOOK FOR YOUR FILE WITH A CONDITION THAT EXIT THIS LOOP AND THE NEXT ONE\n\n    Next\n    If IncludeSubfolders Then\n        For Each mySubFolder In mySource.SubFolders\n            Call ListMyFiles(mySubFolder.path, True)\n        Next\n    End If\nEnd Sub\n</code></pre>\n\n<p>This code will search for a file (File as string), on a Sourcepath (mySourcePath as string) including or not subfolders (IncludeSubfolders as boolean). \nYou should include a condition like (example) <code>If myFile.Name = File Then IncludeSubFolders = False, Exit For</code> in order to leave the loop.</p>\n\n<p>I created that one as a procedure, so it is not returning anything, just adjust to your need or make it function.</p>\n\n<p>Hope it helps!</p>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1572470750, "creation_date": 1572470750, "answer_id": 58633855, "question_id": 58615336, "link": "https://stackoverflow.com/questions/58615336/is-there-a-way-to-determine-if-a-specific-file-exists-somewhere-within-a-series/58633855#58633855", "title": "Is there a way to determine if a specific file exists somewhere within a series of subfolders?", "body": "<p>Here's one approach - you will need to adjust for where your data is located etc.</p>\n\n<pre><code>Sub UpdateFileMatches()\n\n    Dim c As Range, dictFiles, t, msg, sht As Worksheet\n\n    'get all jpg files, starting from the folder root\n    Set dictFiles = GetMatches(\"A:\\Pictures\\Document Pictures\\Tickets\\\", \"*.jpg\")\n    MsgBox \"Found \" &amp; dictFiles.Count &amp; \" JPG files\"\n\n    'loop over worksheets\n    For Each sht In ActiveWorkbook.Worksheets\n        'loop over ticket numbers in colA (or wherever)\n        For Each c In sht.Range(\"A2:A1000\").Cells\n            t = c.Value\n            'Is there one or more matching file found?\n            If Len(t) &gt; 0 And dictFiles.exists(t &amp; \".jpg\") Then\n                msg = \"Found \" &amp; dictFiles(t &amp; \".jpg\") &amp; \" file(s)\"\n            Else\n                msg = \"No match found\"\n            End If\n            c.EntireRow.Cells(1, \"J\").Value = msg  '&lt;&lt; update the row with result\n        Next c\n    Next sht\n\nEnd Sub\n\n'Return a dictionary of unique file names given a starting folder and a file pattern\n'  e.g. \"*.jpg\"\n'Pass False for last parameter if don't want to check subfolders\nFunction GetMatches(startFolder As String, filePattern As String, _\n                    Optional subFolders As Boolean = True) As Object\n\n    Dim fso, fldr, f, subFldr, nm\n    Dim dictFiles As Object\n    Dim colSub As New Collection\n\n    Set dictFiles = CreateObject(\"scripting.dictionary\")\n    Set fso = CreateObject(\"scripting.filesystemobject\")\n    colSub.Add startFolder\n    filePattern = LCase(filePattern)\n    Do While colSub.Count &gt; 0\n        Set fldr = fso.getfolder(colSub(1))\n        colSub.Remove 1\n        'check for files\n        For Each f In fldr.Files\n            nm = LCase(f.Name)\n            If nm Like filePattern Then\n                dictFiles(nm) = dictFiles(nm) + 1 'count instances\n            End If\n        Next f\n        'check any subfolders\n        If subFolders Then\n            For Each subFldr In fldr.subFolders\n                colSub.Add subFldr.Path\n            Next subFldr\n        End If\n    Loop\n    Set GetMatches = dictFiles\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12293660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff3ee5f7c9a07a765be68ec99a69d3f9?s=128&d=identicon&r=PG&f=1", "display_name": "GDD", "link": "https://stackoverflow.com/users/12293660/gdd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1572470750, "creation_date": 1572382669, "last_edit_date": 1572385256, "question_id": 58615336, "link": "https://stackoverflow.com/questions/58615336/is-there-a-way-to-determine-if-a-specific-file-exists-somewhere-within-a-series", "title": "Is there a way to determine if a specific file exists somewhere within a series of subfolders?", "body": "<p>We have a series of Excel workbooks that keep a running total of past transactions for each year. These workbooks each log past transactions, one per row, across 12 worksheets, one for each month. 5-digit numbered tickets with transaction data are scanned daily and saved as .jpg files on our server, and at the end of each row in each workbook is a hyperlink that opens the saved .jpg corresponding to the logged transaction in that particular row.</p>\n\n<p>Each link contains a formula that, along with VBA code that I was able to find, placed in Module1 of the workbook, determines whether or not the .jpg file being referenced actually exists on the server; if the file does exist, the link to the ticket file is displayed as normal, but if it does not exist, \"MISSING\" is displayed in place of the link. This is the VBA code in Module1:</p>\n\n<pre><code>Function FILEEXISTS(sPath As String)\n        FILEEXISTS = Dir(sPath) &lt;&gt; \"\"\nEnd Function\n</code></pre>\n\n<p>This all works fine, but I would now like to update the ticket link formula to determine if a ticket has been scanned and saved on the server as a .jpg file but is placed in the wrong subfolder. Essentially, what I need is VBA code that would determine if a dynamic (in that it will differ for each line) filename specified in the workbook exists anywhere within any subfolder of the file path on the server for a specific year, and if so, return either \"true\" if it does, or \"false\" if it does not. However, I am not experienced enough with VBA to know how to do this myself. If anyone could come up with anything I could use to accomplish this, it would be greatly appreciated. Thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1572380874, "post_id": 58614902, "comment_id": 103539692, "body": "Either paste special, pasting values, or do a value transfer."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1572381395, "post_id": 58614902, "comment_id": 103539901, "body": "Transfer values through some resize of your destination and leave the copy paste if you not interested in formatting."}, {"owner": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1572381500, "post_id": 58614902, "comment_id": 103539949, "body": "@JvdV I&#39;m still fairly new to vba, how can I do this?"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "edited": false, "score": 1, "creation_date": 1572382095, "post_id": 58615128, "comment_id": 103540211, "body": "This works pretty good. Is there any way to copy table cells only with values? I have tried this code and it copies blank cells in the table as well rather than just cells with values."}, {"owner": {"reputation": 228, "user_id": 4216021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dab71f9dbaf2788463adc85da03061ea?s=128&d=identicon&r=PG&f=1", "display_name": "Bilal", "link": "https://stackoverflow.com/users/4216021/bilal"}, "reply_to_user": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "edited": false, "score": 0, "creation_date": 1572383253, "post_id": 58615128, "comment_id": 103540647, "body": "Is there any way to copy table cells only with values? Yes, you want to get rid of blank rows or blank columns or every single blank cell, any screenshot of blank cells being copied over and you want to get rid of them?"}, {"owner": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "edited": false, "score": 0, "creation_date": 1572439669, "post_id": 58615128, "comment_id": 103559001, "body": "I&#39;m looking to remove any non value cells (rows) after the last row of data in the table. Does this make sense?"}], "tags": [], "owner": {"reputation": 228, "user_id": 4216021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dab71f9dbaf2788463adc85da03061ea?s=128&d=identicon&r=PG&f=1", "display_name": "Bilal", "link": "https://stackoverflow.com/users/4216021/bilal"}, "is_accepted": true, "score": 1, "last_activity_date": 1572381725, "creation_date": 1572381725, "answer_id": 58615128, "question_id": 58614902, "link": "https://stackoverflow.com/questions/58614902/how-to-copy-and-paste-dynamic-table-values-in-next-empty-cell/58615128#58615128", "title": "How to copy and paste dynamic table values in next empty cell?", "body": "<p>Here is an example of paste special as values with your code</p>\n\n<pre><code>Sub SaveKit_1()\n\nDim wsCopy As Worksheet\nDim wsDest As Worksheet\nDim lCopy As Long\nDim lDest As Long\n\n  Set wsCopy = Worksheets(\"Kit_db\") 'Copies table from Kit_db worksheet\n  Set wsDest = Worksheets(\"Kit_db (1)\") 'Pastes table to Kit_db (1) worksheet\n\n  lCopy = wsCopy.Cells(wsCopy.Rows.Count, \"E\").End(xlUp).Row\n  lDest = wsDest.Cells(wsDest.Rows.Count, \"E\").End(xlUp).Offset(1).Row\n\n  'Copies any cell within the table\n  wsCopy.Range(\"B3:I\" &amp; lCopy).Copy\n  wsDest.Range(\"B\" &amp; lDest).PasteSpecial xlPasteValues\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 485, "favorite_count": 0, "accepted_answer_id": 58615128, "answer_count": 1, "score": 0, "last_activity_date": 1572404954, "creation_date": 1572380715, "last_edit_date": 1572404954, "question_id": 58614902, "link": "https://stackoverflow.com/questions/58614902/how-to-copy-and-paste-dynamic-table-values-in-next-empty-cell", "title": "How to copy and paste dynamic table values in next empty cell?", "body": "<p>I'm looking to select cells with values from a dynamic table, and copy and paste these values into another worksheet with a table where the next empty cell is available.</p>\n\n<p>I've only been able to find code that will copy and paste a defined range into the next empty cell or copy and paste a dynamic range with some values and empty cells.</p>\n\n<pre><code>Sub SaveKit_1()\n\nDim wsCopy As Worksheet\nDim wsDest As Worksheet\nDim lCopy As Long\nDim lDest As Long\n\n  Set wsCopy = Worksheets(\"Kit_db\") 'Copies table from Kit_db worksheet\n  Set wsDest = Worksheets(\"Kit_db (1)\") 'Pastes table to Kit_db (1) worksheet\n\n  lCopy = wsCopy.Cells(wsCopy.Rows.Count, \"E\").End(xlUp).Row\n  lDest = wsDest.Cells(wsDest.Rows.Count, \"E\").End(xlUp).Offset(1).Row\n\n  'Copies any cell within the table\n  wsCopy.Range(\"B3:I\" &amp; lCopy).Copy _ \n     wsDest.Range(\"B\" &amp; lDest)\n\nEnd Sub\n</code></pre>\n\n<p>All cells in the dynamic table are copied and pasted rather than the cells in the table with values. I'm looking to paste values only as some cells in the dynamic table have formulas.</p>\n\n<p>I have tried the following Paste Special</p>\n\n<pre><code>   PasteSpecial _\n   Paste:=xlPasteValuesAndNumberFormats, _\n   Operation:=xlPasteSpecialOperationNone, _\n   SkipBlanks:=True, _\n   Transpose:=False\n</code></pre>\n\n<p>But I don't think I placed it correctly with the existing code or I'm using the wrong type of code for paste.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1572379987, "post_id": 58614672, "comment_id": 103539287, "body": "Why do you copy paste to the same range? Do you have formulas in there? If so, just saying range.value = range.value will do. No expensive copy-paste necessary. Formats should stay since it&#39;s the same range."}, {"owner": {"reputation": 7, "user_id": 11616164, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ru86g.jpg?s=128&g=1", "display_name": "Stephanie", "link": "https://stackoverflow.com/users/11616164/stephanie"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1572381530, "post_id": 58614672, "comment_id": 103539970, "body": "Yes, this is a part of a larger macro that inserts a formula for data validation. The formula gets inserted into blank cells and will either output a blank cell or the date for the item."}], "answers": [{"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1572380070, "post_id": 58614715, "comment_id": 103539324, "body": "Beaten me to it. You on a roll today aren&#39;t you =)"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1572380106, "post_id": 58614715, "comment_id": 103539337, "body": "@JvdV not so sure, you&#39;ve got 5 more rep than me today (85 vs 80). So I&#39;d say you&#39;re slightly more on a roll? :-)"}, {"owner": {"reputation": 7, "user_id": 11616164, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ru86g.jpg?s=128&g=1", "display_name": "Stephanie", "link": "https://stackoverflow.com/users/11616164/stephanie"}, "edited": false, "score": 1, "creation_date": 1572381390, "post_id": 58614715, "comment_id": 103539897, "body": "Thanks a bunch! Never encountered value transfer before. Learned something new!"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1572381454, "post_id": 58614715, "comment_id": 103539928, "body": "Glad to help! It&#39;s super useful."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 2, "last_activity_date": 1572379905, "creation_date": 1572379905, "answer_id": 58614715, "question_id": 58614672, "link": "https://stackoverflow.com/questions/58614672/error-when-copying-column-and-pasting-as-value-using-vba/58614715#58614715", "title": "Error when copying column and pasting as value using VBA", "body": "<p>You want <code>xlPasteValues</code> instead of <code>PasteValue</code>.</p>\n\n<p>Though instead of copy/pasting, just do a value transfer:</p>\n\n<pre><code>With lo.ListColumns(8).DataBodyRange\n    .Value = .Value\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 11616164, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ru86g.jpg?s=128&g=1", "display_name": "Stephanie", "link": "https://stackoverflow.com/users/11616164/stephanie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 58614715, "answer_count": 1, "score": 0, "last_activity_date": 1572379905, "creation_date": 1572379731, "question_id": 58614672, "link": "https://stackoverflow.com/questions/58614672/error-when-copying-column-and-pasting-as-value-using-vba", "title": "Error when copying column and pasting as value using VBA", "body": "<p>It gives me the option to debug at the last line. I have just ended the macro and pasted value manually as the column has already been selected and copied. </p>\n\n<p>Any insight as to what I have done wrong would be appreciated.</p>\n\n<pre><code>'copies data column and pastes as value to get rid of formula in blank cells\n\nlo.ListColumns(8).DataBodyRange.Copy\nlo.ListColumns(8).DataBodyRange.Select\nlo.ListColumns(8).DataBodyRange.PasteSpecial Paste:=PasteValue\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "ranking"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1572382537, "post_id": 58614643, "comment_id": 103540346, "body": "Using a loop to locate the position(s) would be a reasonable alternative to <code>Match()</code> and no slower"}, {"owner": {"reputation": 1, "user_id": 4689378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cc7f763b46d39282fa2e638e722c3a7?s=128&d=identicon&r=PG&f=1", "display_name": "tgoltsos", "link": "https://stackoverflow.com/users/4689378/tgoltsos"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1572533636, "post_id": 58614643, "comment_id": 103597029, "body": "Thank you, I resorted to the code i used in my answer below."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4689378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cc7f763b46d39282fa2e638e722c3a7?s=128&d=identicon&r=PG&f=1", "display_name": "tgoltsos", "link": "https://stackoverflow.com/users/4689378/tgoltsos"}, "is_accepted": false, "score": 0, "last_activity_date": 1572533578, "creation_date": 1572533578, "answer_id": 58646008, "question_id": 58614643, "link": "https://stackoverflow.com/questions/58614643/how-to-return-the-rank-of-each-double-in-an-array-when-there-are-duplicate-value/58646008#58646008", "title": "How to return the rank of each double in an array when there are duplicate values?", "body": "<p>I resorted to sorting the array that holds the values while holding their positions in a separate array. I post the entire sub below that does an ABC classification based either on volume or value (=avg volume*cost). I tried to comment in an informative way but appreciate any questions for clarification or comments on how to improve clarity.</p>\n\n<pre><code>Sub ABCclass(ByRef swtcABCclass As Integer, ByRef prcA As Double, ByRef prcB As Double, _\n    ByRef prcC As Double)\n    Dim arrTempABC() As Double, i As Integer, j As Integer, intTemp As Integer, tempABC As Double\n    Dim noA As Integer, noB As Integer, noC As Integer, arrTempTSno() As Integer\n\n    ReDim arrTempABC(1 To tsTot)\n    ReDim arrTempTSno(1 To tsTot)\n\n\n    'populate the array that holds the values by which we classify the SKUs\n    If swtcABCclass = 1 Then 'ABC based on volume*value\n        For i = 1 To tsTot\n            arrTempABC(i) = SKUinfo(i, 11) * SKUinfo(i, 5) 'average monthly volume*value (cost)\n            arrTempTSno(i) = i 'just hold the position (ascending number of the timeseries/SKU)\n        Next i\n    ElseIf swtcABCclass = 2 Then 'ABC based on volume\n        For i = 1 To tsTot\n            arrTempABC(i) = SKUinfo(i, 11) ' average monthly volume\n            arrTempTSno(i) = i\n        Next i\n    End If\n\n    'find the limits of each class (in terms of percentages of SKUbase)\n    noA = WorksheetFunction.RoundDown(tsTot * prcA, 0) 'first prcA% of the tsTot (number of timeseries or SKUs) are in class A\n    noB = noA + WorksheetFunction.RoundDown(tsTot * prcB, 0)\n    noC = tsTot\n\n    'sort arrTempABC while saving the positions in a seperate array\n    For i = 2 To tsTot\n        tempABC = arrTempABC(i)\n        intTemp = arrTempTSno(i)\n        For j = i - 1 To 1 Step -1\n            If arrTempABC(j) &gt;= tempABC Then Exit For\n            arrTempABC(j + 1) = arrTempABC(j)\n            arrTempTSno(j + 1) = arrTempTSno(j)\n        Next\n        arrTempABC(j + 1) = tempABC\n        arrTempTSno(j + 1) = intTemp\n    Next\n\n    'now that i have the sorted positions, i can just assign the categories\n    For i = 1 To noA 'noa number of items should be classified as \"A\"\n        SKUinfo(arrTempTSno(i), 12) = \"A\"\n    Next i\n    For i = noA + 1 To noB 'nob - (noa +1) number of items should be classified as \"B\"\n        SKUinfo(arrTempTSno(i), 12) = \"B\"\n    Next i\n    For i = noB + 1 To noC 'noc - (nob +1) number of items should be classified as \"C\"\n        SKUinfo(arrTempTSno(i), 12) = \"C\"\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4689378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cc7f763b46d39282fa2e638e722c3a7?s=128&d=identicon&r=PG&f=1", "display_name": "tgoltsos", "link": "https://stackoverflow.com/users/4689378/tgoltsos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572533578, "creation_date": 1572379618, "last_edit_date": 1572379687, "question_id": 58614643, "link": "https://stackoverflow.com/questions/58614643/how-to-return-the-rank-of-each-double-in-an-array-when-there-are-duplicate-value", "title": "How to return the rank of each double in an array when there are duplicate values?", "body": "<p>If my input array is (10,10,20,20,30,30,40,40,50,50) I would like a simple piece of code that would return (1,2,3,4,5,6,7,8,9,10). I am trying to implement an ABC classification and I am currently using this code:</p>\n\n<pre><code>    For i = 1 To noA 'noA number of items should be classified as \"A\"\n        'return the item number with the i'th largest number in arrTembABC\n        intTemp = Application.Match(WorksheetFunction.Large(arrTempABC, i), arrTempABC, True)\n        'assign the category \"A\" to 'intTemp' item number\n        SKUinfo(intTemp, 12) = \"A\"\n    Next i\n\n    'some printing code\n</code></pre>\n\n<p>The problem with the above code is that when there are duplicate values, it always returns the position of the first instance. Any other item number with the same value does not get assigned a category.</p>\n\n<p>So for the array discussed above (see \"avg value\") the code only classifies the first instance of each duplicate value, and the rest are blank (see \"ABC_CategCry\")</p>\n\n<p><a href=\"https://i.stack.imgur.com/QBtbp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QBtbp.png\" alt=\"\"></a></p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1572382163, "post_id": 58614544, "comment_id": 103540233, "body": "Could you please provide some sample text where the code does not work, and the same text as it should look (manually corrected)? Also, please reduce the code to a representative sample - we need to test and this is too much. Make sure your tries for capitalization are included in the code. We also need the style definitions of original and new styles. All this is necessary so that we can <b><i>test</i></b>. Just reading the problem description, there&#39;s no reason what you describe should not work. Therefore, we need to recreate the test situation. You can use the <a href=\"https://stackoverflow.com/posts/58614544/edit\">edit</a> link below the question."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1572388606, "post_id": 58614544, "comment_id": 103542209, "body": "To set a style AllCaps you need to use &#39;ActiveDocument.Styles(&lt;yourstylename&gt;).Font.AllCaps = True"}], "answers": [{"tags": [], "owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "is_accepted": false, "score": 0, "last_activity_date": 1572391602, "creation_date": 1572391602, "answer_id": 58616749, "question_id": 58614544, "link": "https://stackoverflow.com/questions/58614544/how-to-capitalize-all-letters-in-a-paragraph/58616749#58616749", "title": "How to capitalize all letters in a paragraph", "body": "<p>I've revised you code to use a function to do the resetting of the style and changes the long if elseif to a select case as I suggested.  I've also simplified things by using style names rather than styles.  I think the code below accurately represents the logic in the code above, but you will now be able to see much more clearly if that logic is correct.</p>\n\n<p>If there are keywords you don't understand then in the VBA IDE place the cursor on the keyword and press F1.  This will bring up the MS Help page for that keyword.</p>\n\n<p>You should also install the RUbberduck addin for VBA as this has an Indenter built in plus lots of other useful and helpful tools.</p>\n\n<p>You will also notice the use of .Item.  This is the default property which can be omitted but its better to leave it in.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub ChangeStyles()\n\n    Dim objPara As Paragraph\n    Dim previousOriginalStyle As String\n\n    'junk style to use for first item\n    previousOriginalStyle = ActiveDocument.Styles.Item(\"Quote\").NameLocal\n\n    For Each objPara In ActiveDocument.Paragraphs\n\n        Select Case objPara.Style.NameLocal\n\n            Case \"Header\"\n\n                UpdateStyle objPara, \"SCT\"\n\n            Case \"Heading 1\"\n\n                UpdateStyle objPara, \"PRT\"\n                previousOriginalStyle = \"Heading 1\"\n\n            Case \"Heading 2\"\n\n                UpdateStyle objPara, \"ART\"\n                previousOriginalStyle = \"Heading 2\"\n\n            Case \"Heading 3\"\n\n                UpdateStyle objPara, \"PR1\", previousOriginalStyle, \"PR1\"\n                previousOriginalStyle = \"Heading 3\"\n\n            Case \"Heading 4\"\n\n                UpdateStyle objPara, \"PR2\", previousOriginalStyle, \"PR1lc\"\n                previousOriginalStyle = ActiveDocument.Styles.Item(\"Heading 4\").NameLocal\n\n            Case \"Heading 5\"\n\n                UpdateStyle objPara, \"PR3\", previousOriginalStyle, \"PR3lc\"\n                previousOriginalStyle = \"Heading 5\"\n\n            Case \"Heading 6\"\n\n            UpdateStyle objPara, \"PR4\", previousOriginalStyle, \"PR4lc\"\n            previousOriginalStyle = \"Heading 6\"\n\n            Case \"Heading 7\"\n\n                UpdateStyle objPara, \"PR5\", previousOriginalStyle, \"PR5lc\"\n                previousOriginalStyle = \"Heading 7\"\n\n            Case \"Footer\"\n\n                UpdateStyle objPara, \"EOS\"\n                objPara.Range.ListFormat.RemoveNumbers NumberType:=wdNumberParagraph\n\n            Case Else\n\n            ' do nothing at the moment\n\n        End Select\n\n    Next\n\nEnd Sub\n\nPublic Sub UpdateStyle _\n( _\n    ByRef ipPara As Word.Paragraph, _\n    ByVal ipPrimaryStyle As String, _\n    Optional ByVal ipPreviousStyle As Variant, _\n    Optional ByVal ipAltStyle As Variant _\n)\n\n    If IsMissing(ipPreviousStyle) And IsMissing(ipAltStyle) Then\n\n        ipPara.Range.ParagraphFormat.Style = ActiveDocument.Styles.Item(ipPrimaryStyle).NameLocal\n        Exit Sub\n\n    End If\n\n\n    If ipPara.Range.ParagraphFormat.Style.NameLocal = ipPreviousStyle Then\n\n        ipPara.Range.ParagraphFormat.Style = ActiveDocument.Styles.Item(ipAltStyle).NameLocal\n\n    Else\n\n        ipPara.Range.ParagraphFormat.Style = ActiveDocument.Styles.Item(ipPrimaryStyle).NameLocal\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Please be aware that whilst this code compiles OK I haven't had a chance to run it as I don't have a sample of your document.  But at least it should help get you thinking.</p>\n"}], "owner": {"reputation": 1, "user_id": 12293481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0647b83823a73da34f44d2f0dae1e37c?s=128&d=identicon&r=PG&f=1", "display_name": "TAllen", "link": "https://stackoverflow.com/users/12293481/tallen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1572391602, "creation_date": 1572379109, "last_edit_date": 1572381732, "question_id": 58614544, "link": "https://stackoverflow.com/questions/58614544/how-to-capitalize-all-letters-in-a-paragraph", "title": "How to capitalize all letters in a paragraph", "body": "<p>I'm trying to write a macro to reassign paragraph styles from the Word defaults to styles defined by a third-party application. I have to apply the new style or the import doesn't work correctly.</p>\n\n<p>Some styles (SCT, PRT, ART) should also be in ALL CAPITAL LETTERS but many times the document author doesn't follow that format. I need a way to apply capitalize the text of the entire paragraph while I change the style.</p>\n\n<p>I tried ojbPara.Range.text = UCase(ojbPara.Range.text). I also tried assigning the text the AllCaps = True property.</p>\n\n<p>All the style matching code and font changes at the bottom work without the capitalizing part. I'd also be up any suggestions if there's a better way to write the rest of the macro.</p>\n\n<pre><code>Sub ChangeStyle()\n\nDim objPara As Paragraph\nDim previousOriginalStyle As Style\n\n'junk style to use for first item\nSet previousOriginalStyle = ActiveDocument.Styles(\"Quote\")\n\n'swap styles, if preceding style is different, use \"lc\" style\n\nFor Each objPara In ActiveDocument.Paragraphs\n\n    If objPara.Style = \"Header\" Then\n        objPara.Style = ActiveDocument.Styles(\"SCT\")\n\n        ElseIf objPara.Style = ActiveDocument.Styles(\"Heading 1\") Then\n            objPara.Style = ActiveDocument.Styles(\"PRT\")\n            previousOriginalStyle = ActiveDocument.Styles(\"Heading 1\")\n\n        ElseIf objPara.Style = ActiveDocument.Styles(\"Heading 2\") Then\n            objPara.Style = ActiveDocument.Styles(\"ART\")\n            previousOriginalStyle = ActiveDocument.Styles(\"Heading 2\")\n\n        ElseIf objPara.Style = ActiveDocument.Styles(\"Heading 3\") Then\n\n            If objPara.Style = previousOriginalStyle Then\n                objPara.Style = ActiveDocument.Styles(\"PR1\")\n            Else: objPara.Style = ActiveDocument.Styles(\"PR1lc\")\n            End If\n            previousOriginalStyle = ActiveDocument.Styles(\"Heading 3\")\n\n        ElseIf objPara.Style = ActiveDocument.Styles(\"Heading 4\") Then\n\n            If objPara.Style = previousOriginalStyle Then\n                objPara.Style = ActiveDocument.Styles(\"PR2\")\n            Else: objPara.Style = ActiveDocument.Styles(\"PR2lc\")\n            End If\n            previousOriginalStyle = ActiveDocument.Styles(\"Heading 4\")\n\n        ElseIf objPara.Style = ActiveDocument.Styles(\"Heading 5\") Then\n\n            If objPara.Style = previousOriginalStyle Then\n                objPara.Style = ActiveDocument.Styles(\"PR3\")\n            Else: objPara.Style = ActiveDocument.Styles(\"PR3lc\")\n            End If\n            previousOriginalStyle = ActiveDocument.Styles(\"Heading 5\")\n\n        ElseIf objPara.Style = ActiveDocument.Styles(\"Heading 6\") Then\n\n            If objPara.Style = previousOriginalStyle Then\n                objPara.Style = ActiveDocument.Styles(\"PR4\")\n            Else: objPara.Style = ActiveDocument.Styles(\"PR4lc\")\n            End If\n            previousOriginalStyle = ActiveDocument.Styles(\"Heading 6\")\n\n        ElseIf objPara.Style = ActiveDocument.Styles(\"Heading 7\") Then\n\n            If objPara.Style = previousOriginalStyle Then\n                objPara.Style = ActiveDocument.Styles(\"PR5\")\n            Else: objPara.Style = ActiveDocument.Styles(\"PR5lc\")\n            End If\n            previousOriginalStyle = ActiveDocument.Styles(\"Heading 7\")\n\n        ElseIf objPara.Style = ActiveDocument.Styles(\"Footer\") Then\n            objPara.Style = ActiveDocument.Styles(\"EOS\")\n\n        objPara.Range.ListFormat.RemoveNumbers NumberType:=wdNumberParagraph\n\n    End If\n\n    'fix formatting\n\n    With objPara.Range.Find\n        With .Replacement\n            .ClearFormatting\n            .Font.Bold = False\n            .Font.Italic = False\n            .Font.Underline = False\n            .Font.ColorIndex = wdBlack\n            .Highlight = False\n        End With\n        .Execute Replace:=wdReplaceOne\n    End With\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 1, "creation_date": 1572375186, "post_id": 58613306, "comment_id": 103537485, "body": "It would be helpful if you shared all the code in your routine &quot;DisplayMessage&quot;"}, {"owner": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 0, "creation_date": 1572375732, "post_id": 58613306, "comment_id": 103537717, "body": "Also, is that the time when Word is NOT already running and must start up, or the time when Word is already running?"}, {"owner": {"reputation": 126, "user_id": 11244798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DLPoS.jpg?s=128&g=1", "display_name": "Great Crosby", "link": "https://stackoverflow.com/users/11244798/great-crosby"}, "edited": false, "score": 0, "creation_date": 1572375756, "post_id": 58613306, "comment_id": 103537730, "body": "Public Sub DisplayMessage(strmessage As String)      MsgBox strmessage, vbExclamation, conAppName      End Sub"}, {"owner": {"reputation": 126, "user_id": 11244798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DLPoS.jpg?s=128&g=1", "display_name": "Great Crosby", "link": "https://stackoverflow.com/users/11244798/great-crosby"}, "edited": false, "score": 0, "creation_date": 1572376113, "post_id": 58613306, "comment_id": 103537862, "body": "Word runs fine. Don&#39;t think I explained properly. When the code actually runs, we get an egg timer and we can&#39;t do anything to the form that runs the code. The problem is that the code seems to run as it should, the document opens afetr about 2 seconds, but the egg timer runs for another 20 seconds, when we have to wait to be able to use the form. Also, I didn&#39;t understand what/why you made th change to my code - didn&#39;t seem to be an actual change."}, {"owner": {"reputation": 126, "user_id": 11244798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DLPoS.jpg?s=128&g=1", "display_name": "Great Crosby", "link": "https://stackoverflow.com/users/11244798/great-crosby"}, "edited": false, "score": 0, "creation_date": 1572377491, "post_id": 58613306, "comment_id": 103538337, "body": "Further clarification: if we put DisplayMessage(&quot;TEST&quot;) above Set wdApp = Nothing, we get the message displayed after 2 seconds, but we still have to wait 20 seconds before we get control of the form again. If we put it at the end of the code, we have to wait 20 seconds to see the message."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1572379141, "post_id": 58613306, "comment_id": 103538955, "body": "Pretty much anything can happen when opening/closing a word document with macros, depending on the content of the document and the plugins you use. This is hardly reproducible, if you use a clean office install and a word document without macros it&#39;ll probably run fine."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1572381223, "post_id": 58613306, "comment_id": 103539835, "body": "The only change I made to your code, 1st time, was to include the &quot;End Sub&quot; into the code window- not the comments area; the 2nd time was to include your &quot;DisplayMessage&quot; sub in the code window. I never want to assume that any missing code is just peachy fine. I have a couple of suggestions in the next comment."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 2, "creation_date": 1572381594, "post_id": 58613306, "comment_id": 103540000, "body": "How about running several tests: (1) Manually open the &#39;Privacy.docm&#39; document and see how long it takes; (2) Manually open a small document with no macros and check the timing.  Do any Word macros/code get executed with your document (i.e. AutoOpen, AutoExec, etc.)?"}, {"owner": {"reputation": 126, "user_id": 11244798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DLPoS.jpg?s=128&g=1", "display_name": "Great Crosby", "link": "https://stackoverflow.com/users/11244798/great-crosby"}, "edited": false, "score": 0, "creation_date": 1572427216, "post_id": 58613306, "comment_id": 103552218, "body": "&quot;Also, is that the time when Word is NOT already running and must start up, or the time when Word is already running?&quot; The 20 seconds delay is when word has stopped running. It happens even if I un-comment Set wdDoc = Nothing."}, {"owner": {"reputation": 126, "user_id": 11244798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DLPoS.jpg?s=128&g=1", "display_name": "Great Crosby", "link": "https://stackoverflow.com/users/11244798/great-crosby"}, "edited": false, "score": 0, "creation_date": 1572430274, "post_id": 58613306, "comment_id": 103553930, "body": "It works fine with a word document without macros."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 2, "creation_date": 1572443564, "post_id": 58613306, "comment_id": 103561301, "body": "Then I believe your issue lies within the macro in Word. If I run your code, and open a document with NO macro, it takes a total of 4.77 seconds (if first time and Word is not open); or .66 seconds if 2nd time and Word is already open. However, the size of the Word document can add to the time also..."}], "answers": [{"tags": [], "owner": {"reputation": 126, "user_id": 11244798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DLPoS.jpg?s=128&g=1", "display_name": "Great Crosby", "link": "https://stackoverflow.com/users/11244798/great-crosby"}, "is_accepted": false, "score": 0, "last_activity_date": 1572453178, "creation_date": 1572453178, "answer_id": 58629958, "question_id": 58613306, "link": "https://stackoverflow.com/questions/58613306/access-vba-runs-slow/58629958#58629958", "title": "Access vba runs slow", "body": "<p>Thanks to the comments, I inspected/tested the .docm file. It's there that the problem lies. The function of the file is to produce a pdf. So the solution is to produce the pdf via an Access Report. Here is the code in the .docm: Can't imagine that I'll ever get it to run quickly.</p>\n\n<pre><code>enter code here\nOption Explicit\n\nPrivate Sub Document_Open()\n\nActiveDocument.MailMerge.MainDocumentType = wdNotAMergeDocument\nActiveDocument.MailMerge.MainDocumentType = wdFormLetters\nActiveDocument.MailMerge.OpenDataSource Name:=\"E:\\Peter\\Documents\\GPSystems\\DataSource.txt\", LinkToSource:=True, Revert:=True, Format:=wdOpenFormatAuto, SubType:=wdMergeSubTypeOther\n\nWith ActiveDocument.MailMerge\n    .Destination = wdSendToNewDocument\n    .SuppressBlankLines = True\n    With .DataSource\n        .FirstRecord = ActiveDocument.MailMerge.DataSource.ActiveRecord\n        .LastRecord = ActiveDocument.MailMerge.DataSource.ActiveRecord\n    End With\n    .Execute Pause:=False\nEnd With\n\nActiveDocument.SaveAs FileName:=\"E:\\Peter\\Documents\\GPSystems\\Privacy Declaration.rtf\", FileFormat:=wdFormatDocument\nActiveDocument.SaveAs FileName:=\"E:\\Peter\\Documents\\GPSystems\\Privacy Declaration.pdf\", FileFormat:=wdExportFormatPDF\nActiveDocument.Close (wdSaveChanges)\nWord.Application.Quit SaveChanges:=wdDoNotSaveChanges\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 126, "user_id": 11244798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DLPoS.jpg?s=128&g=1", "display_name": "Great Crosby", "link": "https://stackoverflow.com/users/11244798/great-crosby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1593762108, "creation_date": 1572373145, "last_edit_date": 1593762108, "question_id": 58613306, "link": "https://stackoverflow.com/questions/58613306/access-vba-runs-slow", "title": "Access vba runs slow", "body": "<p>The following sub takes about 2 seconds to get to DisplayMessage(\"TEST\"), then I have to wait 20 seconds before control return to the form that runs it.</p>\n\n<pre><code>Sub OpenWordDocPrivacy()\n\nDim wdApp As Word.Application, wdDoc As Word.Document\nDim MyDoc As String\n\nOn Error Resume Next 'Otherwise the next line causes error \"ActiveX component can't creat object.\"\nSet wdApp = GetObject(, \"Word.Application\")\nIf Err.Number &lt;&gt; 0 Then 'Word isn't already running\n    Set wdApp = CreateObject(\"Word.Application\")\nEnd If\n\nMyDoc = conAddrPth &amp; \"Documents\\GPSystems\\Privacy.docm\"\n\nwdApp.Visible = True\nSet wdDoc = wdApp.Documents.Open(MyDoc)\n\nSet wdApp = Nothing\n'Set wdDoc = Nothing\nDisplayMessage (\"TEST\")\n\nEnd Sub\n\nPublic Sub DisplayMessage(strmessage As String) \n    MsgBox strmessage, vbExclamation, conAppName \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1572368051, "post_id": 58612050, "comment_id": 103534424, "body": "Work with <code>olMail.Subject</code>?"}, {"owner": {"reputation": 1, "user_id": 12292547, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YQSjrNWPD5c/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf4VV87ahsy3vwsjXH-ZKFT5Vod1A/photo.jpg?sz=128", "display_name": "Bob Laird", "link": "https://stackoverflow.com/users/12292547/bob-laird"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1572444105, "post_id": 58612050, "comment_id": 103561662, "body": "Hi @BigBen. That is the script line I was looking into BUT I don&#39;t know where to place it within the script. Would you be able to assist me in that way."}], "owner": {"reputation": 1, "user_id": 12292547, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YQSjrNWPD5c/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf4VV87ahsy3vwsjXH-ZKFT5Vod1A/photo.jpg?sz=128", "display_name": "Bob Laird", "link": "https://stackoverflow.com/users/12292547/bob-laird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572876923, "creation_date": 1572367939, "last_edit_date": 1572876923, "question_id": 58612050, "link": "https://stackoverflow.com/questions/58612050/how-may-i-save-links-from-body-with-the-subject-included-in-the-filename", "title": "How may I save links from Body with the Subject included in the filename?", "body": "<p>EDIT: @bigben suggested I work with olMail.Subject to resolve this issue. Unfortunately, I am uncertain as to where to use it.  </p>\n\n<p>Thank you.</p>\n\n<hr>\n\n<p>I am using a VBA Script in Outlook 2013. It saves all linked documents from the body of an email to my local PC. The document name comes from the linked document itself. I'd like to add the Email's subject line to the saving process. What do I add to my script (and where do I add it)? Happy to change to a completely new script if someone has a better idea.   </p>\n\n<p>I have found script samples that could work but I don't know where to place the snippet into my script.  </p>\n\n<p>I'm sorry to post all of it but I don't know where the change would take place at all.  </p>\n\n<hr>\n\n<pre><code>Private Declare Function ShellExecute _\nLib \"shell32.dll\" Alias \"ShellExecuteA\" ( _\nByVal hWnd As Long, _\nByVal Operation As String, _\nByVal Filename As String, _\nOptional ByVal Parameters As String, _\nOptional ByVal Directory As String, _\nOptional ByVal WindowStyle As Long = vbMinimizedFocus _\n) As Long\n\nSub OpenLinksMessage()\nDim olMail As Outlook.MailItem\nDim Reg1 As RegExp\nDim M1 As MatchCollection\nDim M As Match\nDim strURL As String\nDim lSuccess As Long\n\nSet olMail = Application.ActiveExplorer().Selection(1)\n\nSet Reg1 = New RegExp\n\nWith Reg1\n.Pattern = \"(https?[:]//([0-9a-z=\\?:/\\.&amp;-^!#$%;_])*)\"\n.Global = True\n.IgnoreCase = True\nEnd With\n\nIf Reg1.Test(olMail.Body) Then\n\nSet M1 = Reg1.Execute(olMail.Body)\nFor Each M In M1\nstrURL = M.SubMatches(0)\nDebug.Print strURL\nIf InStr(strURL, \"unsubscribe\") Then GoTo NextURL\nIf Right(strURL, 1) = \"&gt;\" Then strURL = Left(strURL, Len(strURL) - 1)\n\nlSuccess = ShellExecute(0, \"Open\", strURL)\nDoEvents\n\nNextURL:\nNext\nEnd If\n\nSet Reg1 = Nothing\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>No errors in the script. Want to change the script so the result is a saved file named \"Subject.linkeddocumentname.filetype\" (my terminology).</p>\n"}, {"tags": ["excel", "vba", "save-as"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1572369165, "post_id": 58612033, "comment_id": 103534974, "body": "all i can see is that you&#39;re missing &quot;/&quot; after your <code>.path</code>.  Try inspecting the path to be certain, e.g., <code>debug.print thisworkbook.path</code>."}, {"owner": {"reputation": 39, "user_id": 10784198, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JP5by.jpg?s=128&g=1", "display_name": "Andy Latham", "link": "https://stackoverflow.com/users/10784198/andy-latham"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1572374662, "post_id": 58612033, "comment_id": 103537287, "body": "this seems to have worked well except excel gets stuck on a modal saying &quot;processing&quot; after this runs. The new spreadsheet shows up in sharepoint but excel has to be force quit and relaunched thus defeating the point. is there something this is getting stuck on?"}, {"owner": {"reputation": 481, "user_id": 4647394, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06d6fcb008fd47cdc43d3964580baf4a?s=128&d=identicon&r=PG&f=1", "display_name": "seadoggie01", "link": "https://stackoverflow.com/users/4647394/seadoggie01"}, "edited": false, "score": 0, "creation_date": 1572399113, "post_id": 58612033, "comment_id": 103544415, "body": "Don&#39;t save directly to any network locations. It&#39;s an issue I&#39;ve seen a few times. If you <code>FileCopy</code> it to the network, it goes much faster"}], "owner": {"reputation": 39, "user_id": 10784198, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JP5by.jpg?s=128&g=1", "display_name": "Andy Latham", "link": "https://stackoverflow.com/users/10784198/andy-latham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1580371836, "creation_date": 1572367903, "last_edit_date": 1580371836, "question_id": 58612033, "link": "https://stackoverflow.com/questions/58612033/saveas-specific-file-name-with-same-path-as-original-on-sharepoint", "title": "SaveAs specific file name with same path as original on SharePoint", "body": "<p>I have a xlsm that I want every user to first run a macro that SavesAs\nThisWorkbook.Path &amp; \"_\" &amp; Format(Now(), \"yy-mm-dd\") &amp; \"_Tills.xlsm\", FileFormat:=52</p>\n\n<p>The code works on OneDrive document.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Save_Workook_NewName()\n\nThisWorkbook.saveAs FileName:=ThisWorkbook.Path &amp; \"_\" &amp; Format(Now(), \"yy-mm-dd\") &amp; \".xlsm\", FileFormat:=52\n\nEnd Sub\n</code></pre>\n\n<p>On SharePoint, I am now getting</p>\n\n<blockquote>\n  <p>Runtime error 1004: Method 'SaveAs' of object '_Workbook' failed.</p>\n</blockquote>\n\n<p>because the file is stored on my \"Tills\" group SharePoint page, the expected results is a new XLSM file titled: \"Tills_19-10-29.xlsm\"</p>\n\n<p>I have tried all sorts of code but the more complicated it got, the more intense the errors.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1572367294, "post_id": 58611848, "comment_id": 103534025, "body": "<code>Range(&quot;B&quot; &amp; Rows.Count)</code> is the very last row of the column/sheet. You want to go <code>xlUp</code> from it, not <code>xlDown</code>."}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1572377654, "post_id": 58611848, "comment_id": 103538401, "body": "You may want to consider using <code>DefaultRate.Range(&quot;D2&quot;) = Data.Range(&quot;B&quot; &amp; Rows.Count).End(xlUp)</code> instead of copy/paste."}], "owner": {"reputation": 1, "user_id": 12292513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1c6e65c4f32b9f1c6544e68308c772?s=128&d=identicon&r=PG&f=1", "display_name": "AdamBang", "link": "https://stackoverflow.com/users/12292513/adambang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572368535, "creation_date": 1572367193, "last_edit_date": 1572368535, "question_id": 58611848, "link": "https://stackoverflow.com/questions/58611848/how-do-i-copy-a-value-from-the-last-row-in-a-column-and-pasting-it-to-the-first", "title": "How do I copy a value from the last row in a column and pasting it to the first row of a column?", "body": "<p>I have a Workbook with two worksheets. Let's call them Worksheet 1 and Worksheet 2. In worksheet 1 I have a column with a variable where I lag the variable (using offset) i times. I save the lag and the R^2 in an array each time. Whenever I lag the variable, I need to paste data from the last row in column B in worksheet 2. As the variable i increases, the row from which I copy the data (worksheet 2) must increase with the same step as i (Eg. For i = 1 to 10) in a negative way (offset(-i) from bottom to top - so I guess the rows must decrease)- Eg. when i = 2, I want to copy the second row from the bottom in worksheet 2 and insert in the top row of worksheet 1.</p>\n\n<p>As i increase, the rows in worksheet 1 are supposed to be offset by 1 so essentially filling/replacing the empty cell in worksheet 1 with the row value in worksheet 2.</p>\n\n<p>I've tried various things, but it does not copy and insert leaving either blank cells or copying one cell in worksheet 2 and pasting it every other row in worksheet 1</p>\n\n<pre><code>Sub Regression()\nDim Y, X As Range\nDim MyArray As Variant\nDim AWF As WorksheetFunction\nDim DefaultRate, Data As Worksheet\nDim i As Integer\n\nSet AWF = Application.WorksheetFunction\nSet DefaultRate = Workbooks(\"Main sheet.xlsm\").Sheets(\"DefaultRate\")\nSet Data = Workbooks(\"Main sheet.xlsm\").Sheets(\"Data\")\n\nSet Y = DefaultRate.Range(\"B2:B55\")\nSet X = DefaultRate.Range(\"D2:D55\")\n\nReDim MyArray(5, 5)\n\nFor i = LBound(MyArray, 1) To UBound(MyArray, 1)\nIf i = 0 Then\nSet X = X.Offset(0)\nData.Range(\"B\" &amp; Rows.Count).End(xlDown).Copy\nDefaultRate.Range(\"D2\").PasteSpecial xlPasteValues\nElse:\nData.Range(\"B\" &amp; Rows.Count).End(xlDown).Offset(-i).Copy\nDefaultRate.Range(\"D\" &amp; 2).Offset(i).PasteSpecial xlPasteValues\nEnd If\nMyArray(i, 1) = i\nMyArray(i, 2) = AWF.RSq(Y, X)\nCells(1 + i, 7).Value = MyArray(i, 1)\nCells(1 + i, 8).Value = MyArray(i, 2)\n</code></pre>\n\n<p>The empty cell produced by the offset function is supposed to be replaced by data from worksheet 2, but I cannot seem to make it work.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 181, "user_id": 7807244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d14dd5e6b15054e64c5284dc06caaa?s=128&d=identicon&r=PG", "display_name": "Kade M.", "link": "https://stackoverflow.com/users/7807244/kade-m"}, "edited": false, "score": 2, "creation_date": 1572366454, "post_id": 58611591, "comment_id": 103533535, "body": "More information such as how that value is being updated and what you&#39;ve tried so far is crucial to us being any help. Based on what you&#39;ve shared so far, I&#39;d recommend looking at the OnChange event"}, {"owner": {"reputation": 1, "user_id": 5618647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15fb9c9f0d59b877895af5c95e0e8133?s=128&d=identicon&r=PG", "display_name": "Moe", "link": "https://stackoverflow.com/users/5618647/moe"}, "reply_to_user": {"reputation": 181, "user_id": 7807244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d14dd5e6b15054e64c5284dc06caaa?s=128&d=identicon&r=PG", "display_name": "Kade M.", "link": "https://stackoverflow.com/users/7807244/kade-m"}, "edited": false, "score": 0, "creation_date": 1572367202, "post_id": 58611591, "comment_id": 103533964, "body": "Thank you. I edited the question and I&#39;m working on the OnChange event right now."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1572368098, "post_id": 58611591, "comment_id": 103534446, "body": "See <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.ontime\" rel=\"nofollow noreferrer\">Application.OnTime</a>"}, {"owner": {"reputation": 1, "user_id": 5618647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15fb9c9f0d59b877895af5c95e0e8133?s=128&d=identicon&r=PG", "display_name": "Moe", "link": "https://stackoverflow.com/users/5618647/moe"}, "edited": false, "score": 0, "creation_date": 1572368929, "post_id": 58611591, "comment_id": 103534854, "body": "Thank you Mathieu.Your suggestion helped me solve the problem."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1572368952, "post_id": 58611591, "comment_id": 103534865, "body": "Is it just a timevalue or is there a date too? If this updates every minute then there has to be a few 10:31:00 values if this has been running a few days."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5618647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15fb9c9f0d59b877895af5c95e0e8133?s=128&d=identicon&r=PG", "display_name": "Moe", "link": "https://stackoverflow.com/users/5618647/moe"}, "is_accepted": false, "score": 0, "last_activity_date": 1572369845, "last_edit_date": 1572369845, "creation_date": 1572369034, "answer_id": 58612341, "question_id": 58611591, "link": "https://stackoverflow.com/questions/58611591/how-to-extract-the-value-of-an-excel-cell-at-a-specific-time/58612341#58612341", "title": "How to extract the value of an Excel cell at a specific time?", "body": "<p>I was able to solve the problem, following Mathieu's suggestion and finding the video below.</p>\n\n<p><a href=\"https://www.youtube.com/watch?v=svlbqdGE4ws\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=svlbqdGE4ws</a></p>\n\n<p>Here's the gist of it: \nUse the following Macro code and replace the two placeholders with your Excel cell names. The destination cell will be updated based on the value of the dynamic cell every second. Right now the code gets into a loop, but that should be easy to solve. This code doesn't exactly do what I wanted to do, but shows how the content of one cell can be updated based on another cell's value at different points in time. </p>\n\n<p>VBA code:</p>\n\n<pre><code>Sub timer()\nApplication.OnTime Now() + TimeValue(\"00:01:00\"), \"main\"\nEnd Sub\n\nSub main()\nRange(\"Reference_the_Destination_Cell_Here\").Value = Range(\"Refernce_the_Dynamic_Cell_Here\").Value\ntimer\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5618647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15fb9c9f0d59b877895af5c95e0e8133?s=128&d=identicon&r=PG", "display_name": "Moe", "link": "https://stackoverflow.com/users/5618647/moe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 593, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572369845, "creation_date": 1572366270, "last_edit_date": 1572369678, "question_id": 58611591, "link": "https://stackoverflow.com/questions/58611591/how-to-extract-the-value-of-an-excel-cell-at-a-specific-time", "title": "How to extract the value of an Excel cell at a specific time?", "body": "<p>I have an Excel cell that contains a value that is dynamic and being automatically updated throughout the day (This is done using the RTD() function that gets the data from the ThinkorSwim Trading Application) . I am trying to capture the value every minute, put it in a dynamic range and have a plot of these values being dynamically updated throughout the day; like charting a stock price dynamically minute by minute)</p>\n\n<p>My proposed solution is to create a column that contains all the times in the day, minute by minute as static values and another column that captures the value from the dynamic cell at each point in time. The problem I'm facing is how to evaluate a formula at specific times.</p>\n\n<p>Something like:</p>\n\n<pre><code>time          value\n10:31:00      Grab value from dynamic cell at 10:31:00\n10:32:00      Grab value from dynamic cell at 10:32:00\n..\n</code></pre>\n\n<p>Right now, I'm trying to learn how I can do this with Macros.</p>\n\n<p>Any hint/help is appreciated. </p>\n\n<p>Update: I was able to solve the problem following Mathieu's suggestion. Please see below.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1572462879, "post_id": 58611525, "comment_id": 103571524, "body": "To help us help you please add your sample data <i>as text</i>, so we can copy/paste it."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 12292413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f917524d7c3df675ffb6419b739f822?s=128&d=identicon&r=PG&f=1", "display_name": "PolicyGuy", "link": "https://stackoverflow.com/users/12292413/policyguy"}, "edited": false, "score": 0, "creation_date": 1572456675, "post_id": 58614617, "comment_id": 103568812, "body": "Hello good folks, my apologies. This is the first time posting to Stack Overflow. I edited the first image."}], "tags": [], "owner": {"reputation": 331, "user_id": 7834321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/147fb04269e2225ecafbcf20dfbbd76d?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Nevins", "link": "https://stackoverflow.com/users/7834321/tim-nevins"}, "is_accepted": false, "score": 0, "last_activity_date": 1572379481, "creation_date": 1572379481, "answer_id": 58614617, "question_id": 58611525, "link": "https://stackoverflow.com/questions/58611525/transposing-an-excel-spreadsheet-with-a-headings-of-dates-and-columns-with-names/58614617#58614617", "title": "Transposing an excel spreadsheet with a headings of dates and columns with names, time ins and outs for time sheet", "body": "<p>If this is what it seems, the easiest way to do this manually would be to select the entire table, copy. Then right-click in a different area and choose Paste Special.... Select the Transpose checkbox and OK.</p>\n\n<p>If you want to automate this, you can record a macro that performs the steps. Beware of how you select your data so when you run the macro again it will select all the data instead of a rectangle with the same dimensions as when you recorded the macro.</p>\n"}, {"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 0, "last_activity_date": 1572466397, "creation_date": 1572466397, "answer_id": 58632981, "question_id": 58611525, "link": "https://stackoverflow.com/questions/58611525/transposing-an-excel-spreadsheet-with-a-headings-of-dates-and-columns-with-names/58632981#58632981", "title": "Transposing an excel spreadsheet with a headings of dates and columns with names, time ins and outs for time sheet", "body": "<p>TRhe general idea is to loop over the source data, identifying Names, Date and Time.  Then build a build a new table in the required layout.  </p>\n\n<p>Doing this with Variant Arrays will make it quite fast.</p>\n\n<p>Something like this</p>\n\n<pre><code>Sub TransposeTime(wsSrc As Worksheet, Optional wsDst As Worksheet)\n    Dim rSrc As Range, rDst As Range\n    Dim Src As Variant, Dst As Variant\n    Dim EmployeeCount As Long\n    Dim DateCount As Long\n    Dim SrcRow As Long, DstRow As Long, DateRow As Long\n\n    On Error GoTo EH\n\n    If wsSrc Is Nothing Then Exit Sub\n\n    ' Get reference to source data.  Use Column B to get number of rows\n    With wsSrc\n        Set rSrc = .Range(.Cells(.Cells(.Rows.Count, 2).End(xlUp).Row, 1), .Cells(1, .Columns.Count).End(xlToLeft))\n    End With\n\n    ' Put source data in a Variant Array\n    Src = rSrc.Value2\n\n    ' Count Employees and Dates\n    EmployeeCount = Application.CountA(rSrc.Columns(1)) - 1\n    DateCount = Application.CountA(rSrc.Rows(1)) - 2\n\n    ' if wsDst is missing, overwrite source\n    If wsDst Is Nothing Then\n        Set wsDst = wsSrc\n        wsSrc.UsedRange.Clear\n    End If\n\n    ' Size destination array\n    ReDim Dst(0 To EmployeeCount * DateCount, 1 To 4)\n\n    ' Headers\n    Dst(0, 1) = \"Employee Name\"\n    Dst(0, 2) = \"Date\"\n    Dst(0, 3) = \"Time In\"\n    Dst(0, 4) = \"Time Out\"\n\n    ' Loop source data, process each Time In row\n    DstRow = 0\n    For SrcRow = 1 To UBound(Src, 1)\n        If StrComp(Src(SrcRow, 2), \"Time In\", vbTextCompare) = 0 Then\n            ' Loop dates for each employee\n            For DateRow = 1 To DateCount\n                Dst(DateRow + DstRow, 1) = Src(SrcRow, 1) 'Name\n                Dst(DateRow + DstRow, 2) = Src(1, DateRow + 2) 'Date\n                If Not IsEmpty(Src(SrcRow, DateRow + 2)) Then\n                    Dst(DateRow + DstRow, 3) = Src(SrcRow, DateRow + 2) ' In\n                    Dst(DateRow + DstRow + 1, 4) = Src(SrcRow + 1, DateRow + 2) ' Out\n                End If\n            Next\n            DstRow = DstRow + DateCount\n        End If\n    Next\n\n    ' Place result on sheet\n    Set rDst = wsDst.Cells(1, 1).Resize(UBound(Dst, 1) + 1, UBound(Dst, 2))\n    rDst.Value = Dst\n\n    ' Format Date and Time Columns\n    rDst.Columns(2).NumberFormat = \"mm/dd/yyyy\"\n    rDst.Columns(3).Resize(, 2).NumberFormat = \"h:mm:ss AM/PM\"\n\nExit Sub\nEH:\n    ' on error restore source data\n    If Not IsEmpty(Src) Then\n        wsSrc.Cells(1, 1).Resize(UBound(Src, 1), UBound(Src, 2)).Value = Src\n    End If\n    MsgBox \"Oops...\"\nEnd Sub\n</code></pre>\n\n<p>Since you have many sheets to process, you'll need another <code>Sub</code> to process those, and call this <code>Sub</code></p>\n\n<p>Demo of calling for one sheet</p>\n\n<pre><code>Sub Demo()\n    TransposeTime ActiveSheet\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12292413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f917524d7c3df675ffb6419b739f822?s=128&d=identicon&r=PG&f=1", "display_name": "PolicyGuy", "link": "https://stackoverflow.com/users/12292413/policyguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1572466412, "creation_date": 1572366043, "last_edit_date": 1572466412, "question_id": 58611525, "link": "https://stackoverflow.com/questions/58611525/transposing-an-excel-spreadsheet-with-a-headings-of-dates-and-columns-with-names", "title": "Transposing an excel spreadsheet with a headings of dates and columns with names, time ins and outs for time sheet", "body": "<p>I have a time sheet with the headers being Employee Name, Time in/out, and a range of dates.</p>\n\n<p>It looks like this replicated to a larger volume.</p>\n\n<p><a href=\"https://i.stack.imgur.com/xPzN5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xPzN5.png\" alt=\"enter image description here\"></a></p>\n\n<p>However, the desired format to 'transpose' this into is:</p>\n\n<p><a href=\"https://i.stack.imgur.com/BedZR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BedZR.png\" alt=\"enter image description here\"></a></p>\n\n<p>We also receive a large volume of such spreadsheets so manual transposition is not desired.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1572367367, "post_id": 58611444, "comment_id": 103534061, "body": "IMO for things that can easily be calculated, that&#39;s always the better way."}, {"owner": {"reputation": 11, "user_id": 12292519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41cd48f79789e071f6a2e86f12fcd677?s=128&d=identicon&r=PG&f=1", "display_name": "SteveH", "link": "https://stackoverflow.com/users/12292519/steveh"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1572368104, "post_id": 58611444, "comment_id": 103534447, "body": "Thanks Andre. I really only want to implement them to speed up my forms, as displaying too many invoices at once and they really slow down due to calculation of invoice totals."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1572376542, "post_id": 58611444, "comment_id": 103538012, "body": "Don&#39;t save invoice totals, do this aggregate calc from transaction records when needed for report output."}, {"owner": {"reputation": 11, "user_id": 12292519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41cd48f79789e071f6a2e86f12fcd677?s=128&d=identicon&r=PG&f=1", "display_name": "SteveH", "link": "https://stackoverflow.com/users/12292519/steveh"}, "edited": false, "score": 0, "creation_date": 1572426701, "post_id": 58611444, "comment_id": 103551948, "body": "So I can&#39;t really rely on data macros being 100% accurate? It&#39;s interesting because i&#39;m trying to copy how Sage Line 50, which is the main accounting package in the UK, does things, where it stores the invoice total plus loads of other aggregated info in header records generated from many different records"}], "owner": {"reputation": 11, "user_id": 12292519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41cd48f79789e071f6a2e86f12fcd677?s=128&d=identicon&r=PG&f=1", "display_name": "SteveH", "link": "https://stackoverflow.com/users/12292519/steveh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1572432634, "creation_date": 1572365778, "last_edit_date": 1572432634, "question_id": 58611444, "link": "https://stackoverflow.com/questions/58611444/new-to-access-data-macros", "title": "New to access data macros", "body": "<p>Can i rely on access data macros to always work reliably? Or should i just carry on with calculated fields and expressions in queries. I'm want to use them to calculate invoice totals on the after insert, after update and after delete events on invoice item records. thanks for any feedback. </p>\n\n<p>Have implemented them but want to know that they'll always give me the right answer going forward.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1572364491, "post_id": 58610973, "comment_id": 103532507, "body": "<code>.Value2</code> perhaps."}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 6, "last_activity_date": 1572364916, "last_edit_date": 1572364916, "creation_date": 1572364595, "answer_id": 58611071, "question_id": 58610973, "link": "https://stackoverflow.com/questions/58610973/returning-5-digit-date-in-debug-print-without-formatting-the-cell/58611071#58611071", "title": "Returning 5-digit date in Debug.Print without formatting the cell", "body": "<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.value2\" rel=\"noreferrer\"><code>Range.Value2</code></a> doesn't use the <code>Date</code> type, so you can just <code>Debug.Print rng.Value2</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1572365052, "post_id": 58611101, "comment_id": 103532801, "body": "But you added more explanation :-)"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1572365642, "post_id": 58611101, "comment_id": 103533101, "body": "@BigBen gave you both upvotes but took K&#39;s due to the additional effort.  Apprently the <code>datediff()</code> works and i dont&#39; need the +2, but for some reason when I convert the numberformat before debug.print it keeps adding that +2... the <code>.value2</code> seems much more efficient."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1572365705, "post_id": 58611101, "comment_id": 103533141, "body": "@Cyril this is definitely the more thorough answer, so I agree with it being marked as such, but appreciate your upvote as well."}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 6, "last_activity_date": 1572364700, "creation_date": 1572364700, "answer_id": 58611101, "question_id": 58610973, "link": "https://stackoverflow.com/questions/58610973/returning-5-digit-date-in-debug-print-without-formatting-the-cell/58611101#58611101", "title": "Returning 5-digit date in Debug.Print without formatting the cell", "body": "<p>There are two methods that come to mind when you are wanting to print the numerical representation of the date without changing the formatting of the cell.</p>\n\n<p>The best way to do it is using the <code>.Value2</code> property.</p>\n\n<pre><code>Debug.Print Rng.Value2\n</code></pre>\n\n<p>The 'less recommended' approach is by using the <code>CDbl()</code> function. I would use this moreso for variables and <code>.Value2</code> for ranges.</p>\n\n<pre><code>Debug.Print CDbl(Rng.Value)\n</code></pre>\n\n<p>Or for variables</p>\n\n<pre><code>Dim d as Date\nd = #01/01/2019#\n\nDebug.Print CDbl(d)\nDebug.Print CLng(d) 'If not using time - date only\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1572368800, "post_id": 58611867, "comment_id": 103534784, "body": "I&#39;m a bit preferable to the layout ~_*  Thanks for the additional input; nice to have alternatives."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 1, "last_activity_date": 1572367270, "creation_date": 1572367270, "answer_id": 58611867, "question_id": 58610973, "link": "https://stackoverflow.com/questions/58610973/returning-5-digit-date-in-debug-print-without-formatting-the-cell/58611867#58611867", "title": "Returning 5-digit date in Debug.Print without formatting the cell", "body": "<p>Nice layout Cyril =)</p>\n\n<p>To complement the other answers: Whereas <code>Value2</code> is the more appropriate way to go, another very simple possibility is:</p>\n\n<pre><code>Debug.Print rng*1\n</code></pre>\n"}], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 58611101, "answer_count": 3, "score": 5, "last_activity_date": 1572367270, "creation_date": 1572364241, "question_id": 58610973, "link": "https://stackoverflow.com/questions/58610973/returning-5-digit-date-in-debug-print-without-formatting-the-cell", "title": "Returning 5-digit date in Debug.Print without formatting the cell", "body": "<p><strong>Background:</strong></p>\n\n<p>I am looking to get the 5-digit date from a cell which is formatted to display a date. \n The 5-digit date should only be the immediate window (via <code>debug.print</code>).</p>\n\n<p>My testing with results in the <em>Script</em> section (bottom).</p>\n\n<p>I have a feeling that the answer will involve <code>datediff()+2</code> based on the testing I did, but I can't figure out why that +2 is needed and don't want to just add that in if it's wrong in the future.</p>\n\n<hr>\n\n<p><strong>Issue:</strong></p>\n\n<p>I don't seem to be able to display the correct 5-digit date (as displayed with \"general\" format) by means of <code>Debug.Print</code>.</p>\n\n<hr>\n\n<p><strong>Question:</strong></p>\n\n<p>How do you get the 5-digit date, most often displayed with General-formatting, to display in the immediate window (<code>debug.print</code>) without first converting the cell's <code>.numberformat</code>?</p>\n\n<hr>\n\n<p><strong>Script:</strong></p>\n\n<pre><code>Dim rng As Range, d1 As String, d2 As String\nSet rng = Cells(1, 1) 'value = 20190101\n\nDebug.Print Format(rng.Value, \"@\") 'returns 20190101\nDebug.Print rng.NumberFormat = \"General\" 'returns \"false\"\nDebug.Print Format(rng.value, \"General\") 'returns \"Ge0oral\" due to the \"n\" being recognized for a format\n\nd1 = \"1900/01/01\"\nd2 = rng.Value\nDebug.Print 40729 + DateDiff(\"d\", d1, d2) 'returns 84195\nDebug.Print DateDiff(\"d\", d1, d2) 'returns 43466\n\nrng.NumberFormat = \"General\"\nDebug.Print rng.Value 'returns 43468, but required formatting the cell\n</code></pre>\n"}, {"tags": ["vba", "csv", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 82, "user_id": 8879831, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bbb6faadb2855b2de386306a6579cd9?s=128&d=identicon&r=PG", "display_name": "Vinnie Novido", "link": "https://stackoverflow.com/users/8879831/vinnie-novido"}, "edited": false, "score": 0, "creation_date": 1573050808, "post_id": 58611336, "comment_id": 103755200, "body": "Unfortunately it seems like it doesn&#39;t matter how you write the filename in the TransferText, because it appears it doesn&#39;t like being in a for loop. It doesn&#39;t matter what I give the tempfile for name, as long as it don&#39;t like dots before the file extension while being in a loop it will never write a correct file name."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 82, "user_id": 8879831, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bbb6faadb2855b2de386306a6579cd9?s=128&d=identicon&r=PG", "display_name": "Vinnie Novido", "link": "https://stackoverflow.com/users/8879831/vinnie-novido"}, "edited": false, "score": 0, "creation_date": 1573051129, "post_id": 58611336, "comment_id": 103755379, "body": "I&#39;m not sure, what you mean. But try to use a different temp filename for each loop."}, {"owner": {"reputation": 82, "user_id": 8879831, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bbb6faadb2855b2de386306a6579cd9?s=128&d=identicon&r=PG", "display_name": "Vinnie Novido", "link": "https://stackoverflow.com/users/8879831/vinnie-novido"}, "edited": false, "score": 0, "creation_date": 1573052635, "post_id": 58611336, "comment_id": 103756258, "body": "That also gives me an error. If I set the table name as the file name and add &quot;.csv&quot; I get the &quot;#csv&quot; problem. If I don&#39;t add the file extension I get a &quot;Database or object is read only&quot;."}, {"owner": {"reputation": 82, "user_id": 8879831, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bbb6faadb2855b2de386306a6579cd9?s=128&d=identicon&r=PG", "display_name": "Vinnie Novido", "link": "https://stackoverflow.com/users/8879831/vinnie-novido"}, "edited": false, "score": 0, "creation_date": 1573053787, "post_id": 58611336, "comment_id": 103757032, "body": "Are you exporting multiple tables? If so can you show me your code?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 82, "user_id": 8879831, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bbb6faadb2855b2de386306a6579cd9?s=128&d=identicon&r=PG", "display_name": "Vinnie Novido", "link": "https://stackoverflow.com/users/8879831/vinnie-novido"}, "edited": false, "score": 0, "creation_date": 1573054038, "post_id": 58611336, "comment_id": 103757182, "body": "No, but you could edit your question to hold your revised code."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1572365424, "creation_date": 1572365424, "answer_id": 58611336, "question_id": 58610890, "link": "https://stackoverflow.com/questions/58610890/exporting-tables-to-csv-changes-file-extension/58611336#58611336", "title": "Exporting tables to csv changes file extension", "body": "<p>This is known limitation. TransferText doesn't like convoluted filenames.</p>\n\n<p>So, <em>export</em> to a simple filename, then <em>rename</em> that file to its final name:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>ExportFinal = \"YourFinalName.csv\"\nExportTemp = \"FileToRename.csv\"\n\nDoCmd.TransferText acExportDelim, \"ExportCsv\", tdf.Name, ExportTemp, True\n\nVBA.FileCopy ExportTemp, ExportFinal\nVBA.Kill ExportTemp\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 82, "user_id": 8879831, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bbb6faadb2855b2de386306a6579cd9?s=128&d=identicon&r=PG", "display_name": "Vinnie Novido", "link": "https://stackoverflow.com/users/8879831/vinnie-novido"}, "is_accepted": true, "score": 0, "last_activity_date": 1573135109, "creation_date": 1573135109, "answer_id": 58750344, "question_id": 58610890, "link": "https://stackoverflow.com/questions/58610890/exporting-tables-to-csv-changes-file-extension/58750344#58750344", "title": "Exporting tables to csv changes file extension", "body": "<p>So after lots of trial and error I have found a way that works for me.</p>\n\n<p>With some inspiration from @Gustav I went with creating .xls files, which for some reason works. And then convert those files with a custom script to .csv-files. Then I remove the .xls files leaving only my .csv-files left. </p>\n\n<p>So my loop now looks like this:</p>\n\n<pre><code>For Each tdf In db.TableDefs\n    ' ignore system and temporary tables\n    If Not (tdf.Name Like \"MSys*\" Or tdf.Name Like \"~*\") Then\n        ' Export as xls-files\n        fileName = tdf.Name &amp; \".xls\"\n        DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12, tdf.Name, filePath &amp; env &amp; fileName, True\n\n        ' Convert xls-files to .csv and remove the xls-files.\n        ConvertXls2CSV (filePath &amp; env &amp; fileName)\n        VBA.Kill filePath &amp; env &amp; fileName\n    End If\nNext\n</code></pre>\n\n<p>And here is the converting code: (Credit to: <a href=\"https://www.devhut.net/2012/05/14/ms-access-vba-convert-excel-xls-to-csv/\" rel=\"nofollow noreferrer\">https://www.devhut.net/2012/05/14/ms-access-vba-convert-excel-xls-to-csv/</a>)</p>\n\n<pre><code>Function ConvertXls2CSV(sXlsFile As String)\n    On Error Resume Next\n    Dim oExcel          As Object\n    Dim oExcelWrkBk     As Object\n    Dim bExcelOpened    As Boolean    'Was Excel already open or not\n    'Review 'XlFileFormat Enumeration' for more formats\n    Const xlCSVWindows = 23 'Windows CSV Format\n    Const xlCSV = 6 'CSV\n    Const xlCSVMac = 22 'Macintosh CSV\n    Const xlCSVMSDOS = 24 'MSDOS CSV\n\n    Set oExcel = GetObject(, \"Excel.Application\")    'Bind to existing instance of Excel\n\n    If Err.Number &lt;&gt; 0 Then    'Could not get instance of Excel, so create a new one\n        Err.Clear\n        'On Error GoTo Error_Handler\n        Set oExcel = CreateObject(\"excel.application\")\n        bExcelOpened = False\n    Else    'Excel was already running\n        bExcelOpened = True\n    End If\n\n    'On Error GoTo Error_Handler\n    oExcel.ScreenUpdating = False\n    oExcel.Visible = False   'Keep Excel hidden from the user\n    oExcel.Application.DisplayAlerts = False\n\n    Set oExcelWrkBk = oExcel.Workbooks.Open(sXlsFile)\n    'Note: you may wish to change the file format constant for another type declared\n    'above based on your usage/needs in the following line.\n    oExcelWrkBk.SaveAs Left(sXlsFile, InStrRev(sXlsFile, \".\")) &amp; \"csv\", xlCSVWindows, Local:=True\n    oExcelWrkBk.Close False\n\n    If bExcelOpened = False Then\n        oExcel.Quit\n    End If\n\nError_Handler_Exit:\n    On Error Resume Next\n    Set oExcelWrkBk = Nothing\n    Set oExcel = Nothing\n    Exit Function\n\nError_Handler:\n    MsgBox \"The following error has occurred.\" &amp; vbCrLf &amp; vbCrLf &amp; _\n            \"Error Number: \" &amp; Err.Number &amp; vbCrLf &amp; _\n            \"Error Source: ConvertXls2CSV\" &amp; vbCrLf &amp; _\n            \"Error Table: \" &amp; sXlsFile &amp; vbCrLf &amp; _\n            \"Error Description: \" &amp; Err.Description, _\n            vbCritical, \"An Error has Occurred!\"\n    Resume Error_Handler_Exit\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 82, "user_id": 8879831, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bbb6faadb2855b2de386306a6579cd9?s=128&d=identicon&r=PG", "display_name": "Vinnie Novido", "link": "https://stackoverflow.com/users/8879831/vinnie-novido"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 58750344, "answer_count": 2, "score": 0, "last_activity_date": 1594421291, "creation_date": 1572363996, "last_edit_date": 1594421291, "question_id": 58610890, "link": "https://stackoverflow.com/questions/58610890/exporting-tables-to-csv-changes-file-extension", "title": "Exporting tables to csv changes file extension", "body": "<p>I'm trying to export all my tables, from my access database, to separate .csv-files. I have a loop that runs through all tables and by using TransferText I want to create a .csv-file for each table.  </p>\n\n<p>I am able to create a single file by writing the TransferText method.</p>\n\n<pre><code>DoCmd.TransferText acExportDelim, \"ExportCsv\", [Table name], filePath + \"Test.csv\", True\n</code></pre>\n\n<p>But when I'm trying to create a loop to generate a file for each table I get into trouble. (Filepath is set to desktop)</p>\n\n<pre><code>' Loops through all tables and extracts them as .csv-files    \nDim db As DAO.Database\nDim tdf As DAO.TableDef\nSet db = CurrentDb\nFor Each tdf In db.TableDefs\n    ' ignore system and temporary tables\n    If Not (tdf.Name Like \"MSys*\" Or tdf.Name Like \"~*\") Then\n        ' Export table as CSV\n        'MsgBox (tdf.Name)\n        fileName = tdf.Name &amp; \".csv\"\n        DoCmd.TransferText acExportDelim, \"ExportCsv\", tdf.Name, filePath + fileName, True\n\n    End If\nNext\nSet tdf = Nothing\nSet db = Nothing\n</code></pre>\n\n<p>Doing it like this gives me Error '3011' saying it can't find the object. Then it gives me the object name: [table name]#csv. So for some reason it changes \".csv\" to \"#csv\".</p>\n\n<p>If I remove the file extension from the file name all I get is Error 3027 saying that the object or database is read-only.</p>\n\n<p>Does anyone know if there is a solution to my problem or another way to do the same thing? Or am I gonna have to go a completely different route?</p>\n\n<p>EDIT:</p>\n\n<p>Other tested variations</p>\n\n<pre><code>DoCmd.TransferText acExportDelim, \"ExportCsv\", tdf.Name, \"C:/tempFile.csv\", True \nDoCmd.TransferText acExportDelim, \"ExportCsv\", tdf.Name, \"C:/\" &amp; tdf.Name &amp; \".csv\", True\n</code></pre>\n\n<p>: Gives a \"#csv\" error.</p>\n\n<pre><code>DoCmd.TransferText acExportDelim, \"ExportCsv\", tdf.Name, \"C:/tempFile\", True\nDoCmd.TransferText acExportDelim, \"ExportCsv\", tdf.Name, \"C:/\" &amp; tdf.Name, True \n</code></pre>\n\n<p>: Gives a read only error</p>\n"}]