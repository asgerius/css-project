[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 158, "user_id": 12506685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bbdad43fa100913502ce67d1b6b0fd?s=128&d=identicon&r=PG&f=1", "display_name": "the VBE - it&#39;s right for me", "link": "https://stackoverflow.com/users/12506685/the-vbe-its-right-for-me"}, "edited": false, "score": 0, "creation_date": 1576109017, "post_id": 59295816, "comment_id": 104796120, "body": "What you are showing has two instances of the &quot;Nr&quot; but the second time the column B string is not &quot;801 C&quot;. What is supposed to be done there?"}, {"owner": {"reputation": 15, "user_id": 12492709, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAE9u8YtHC2mwMHrzESigZMcEmcnAOqIFUluswA=k-s128", "display_name": "Benjamin Bentley", "link": "https://stackoverflow.com/users/12492709/benjamin-bentley"}, "reply_to_user": {"reputation": 158, "user_id": 12506685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bbdad43fa100913502ce67d1b6b0fd?s=128&d=identicon&r=PG&f=1", "display_name": "the VBE - it&#39;s right for me", "link": "https://stackoverflow.com/users/12506685/the-vbe-its-right-for-me"}, "edited": false, "score": 0, "creation_date": 1576109773, "post_id": 59295816, "comment_id": 104796282, "body": "The &quot;Nr&quot; appears in the log at the top of every block of data when the standard is changed to a different color in the program or if the series is stopped and restarted it will start a new entry for the same color with the Nr at the top of the block. What i need is the &quot;801 C&quot; down to the &quot;Nr&#39; above where the &quot;706 C&quot; data starts this thing has me perplexed."}, {"owner": {"reputation": 158, "user_id": 12506685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bbdad43fa100913502ce67d1b6b0fd?s=128&d=identicon&r=PG&f=1", "display_name": "the VBE - it&#39;s right for me", "link": "https://stackoverflow.com/users/12506685/the-vbe-its-right-for-me"}, "edited": false, "score": 0, "creation_date": 1576111901, "post_id": 59295816, "comment_id": 104796693, "body": "The <code>.Find</code> method for a range allows you to specify a starting cell. If there are multiple potential occurances of 801 C you basically want to keep looping through that for <code>.Columns(2)</code> until it doesn&#39;t find anything and use the starting row of the result (.Find returns a range object) to make sure that it finds the correct Nr. If you need actual implementation shown I can do that in a bit."}, {"owner": {"reputation": 15, "user_id": 12492709, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAE9u8YtHC2mwMHrzESigZMcEmcnAOqIFUluswA=k-s128", "display_name": "Benjamin Bentley", "link": "https://stackoverflow.com/users/12492709/benjamin-bentley"}, "reply_to_user": {"reputation": 158, "user_id": 12506685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bbdad43fa100913502ce67d1b6b0fd?s=128&d=identicon&r=PG&f=1", "display_name": "the VBE - it&#39;s right for me", "link": "https://stackoverflow.com/users/12506685/the-vbe-its-right-for-me"}, "edited": false, "score": 0, "creation_date": 1576112479, "post_id": 59295816, "comment_id": 104796802, "body": "An example of implementation would extremely helpful. thank you!"}, {"owner": {"reputation": 158, "user_id": 12506685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bbdad43fa100913502ce67d1b6b0fd?s=128&d=identicon&r=PG&f=1", "display_name": "the VBE - it&#39;s right for me", "link": "https://stackoverflow.com/users/12506685/the-vbe-its-right-for-me"}, "edited": false, "score": 0, "creation_date": 1576113169, "post_id": 59295816, "comment_id": 104796941, "body": "Need to do a couple thing give me like an hour."}, {"owner": {"reputation": 15, "user_id": 12492709, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAE9u8YtHC2mwMHrzESigZMcEmcnAOqIFUluswA=k-s128", "display_name": "Benjamin Bentley", "link": "https://stackoverflow.com/users/12492709/benjamin-bentley"}, "reply_to_user": {"reputation": 158, "user_id": 12506685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bbdad43fa100913502ce67d1b6b0fd?s=128&d=identicon&r=PG&f=1", "display_name": "the VBE - it&#39;s right for me", "link": "https://stackoverflow.com/users/12506685/the-vbe-its-right-for-me"}, "edited": false, "score": 0, "creation_date": 1576113680, "post_id": 59295816, "comment_id": 104797029, "body": "No problem been trying to figure out this problem for the past couple days a little while longer isn&#39;t going to hurt."}], "answers": [{"tags": [], "owner": {"reputation": 158, "user_id": 12506685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bbdad43fa100913502ce67d1b6b0fd?s=128&d=identicon&r=PG&f=1", "display_name": "the VBE - it&#39;s right for me", "link": "https://stackoverflow.com/users/12506685/the-vbe-its-right-for-me"}, "is_accepted": true, "score": 1, "last_activity_date": 1576119485, "creation_date": 1576119485, "answer_id": 59297076, "question_id": 59295816, "link": "https://stackoverflow.com/questions/59295816/excel-find-rows-between-two-strings-and-change-value-in-different-column-for-row/59297076#59297076", "title": "Excel find rows between two strings and change value in different column for rows between strings", "body": "<p>Didn't test this so there might be typos but you should be able to get it working:</p>\n\n<pre><code>Dim valCell As Range 'store the cell where you find \"801 C\"\nDim i As Long, first As Long, last As Long 'counter, store rows as you iterate\n\nfirst = 1 'start at the top\nSet valCell = Sheet1.Columns(2).Find(\"801 C\", Sheet1.Cells(first, 2)) 'get the first time you have \"801 C\", if there are none then this will be Nothing and the While loop condition will fail right away\n\nWhile (Not valCell Is Nothing)\n\n    first = valCells.Row 'set the first row to the row you found \"801 C\"\n    last = Sheet1.Columns(1).Find(\"Nr\", Sheet1.Cells(first, 1)).Row 'set the last row to the row you found \"Nr\"\n\n    For i = first To last 'loop through the cells and change the values\n        Sheet1.Cells(i, 3).Value = 27\n    Next\n\nWend\n</code></pre>\n\n<p>Don't forget to change the worksheet reference from Sheet1 to the <code>.CodeName</code> for the sheet you are using; that is the name that appears before the parentheses in the editor.</p>\n"}, {"tags": [], "owner": {"reputation": 15, "user_id": 12492709, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAE9u8YtHC2mwMHrzESigZMcEmcnAOqIFUluswA=k-s128", "display_name": "Benjamin Bentley", "link": "https://stackoverflow.com/users/12492709/benjamin-bentley"}, "is_accepted": false, "score": 0, "last_activity_date": 1576170809, "last_edit_date": 1576170809, "creation_date": 1576169819, "answer_id": 59309415, "question_id": 59295816, "link": "https://stackoverflow.com/questions/59295816/excel-find-rows-between-two-strings-and-change-value-in-different-column-for-row/59309415#59309415", "title": "Excel find rows between two strings and change value in different column for rows between strings", "body": "<pre><code>Dim valCell As Range 'store the cell where you find \"801 C\"\nDim i As Long, first As Long, last As Long 'counter, store rows as you iterate\n\nfirst = 1 'start at the top\nSet valCell = Worksheets(\"export1\").Columns(2).Find(\"801 C\", Worksheets(\"export1\").Cells(first, 2)) 'get the first time you have \"801 C\", if there are none then this will be Nothing and the While loop condition will fail right away\nWhile (Not valCell Is Nothing)\n    If valCell.Row &gt; first Then\n        first = valCell.Row 'set the first row to the row you found \"801 C\"\n        last = Worksheets(\"export1\").Columns(1).Find(\"Nr\", Worksheets(\"export1\").Cells(first, 1)).Row 'set the last row to the row you found \"Nr\"\n\n        For i = first To last 'loop through the cells and change the values\n            Worksheets(\"export1\").Cells(i, 3).Value = 27\n        Next\n        first = last\n        Set valCell = Worksheets(\"export1\").Columns(2).Find(\"801 C\", Worksheets(\"export1\").Cells(first, 2)) 'get the next time you have \"801 C\", if there are none then this will be Nothing and the While loop condition will fail right away8\n    Else\n        Set valCell = Nothing\n    End If\nWend\nEnd Sub\n</code></pre>\n\n<p>There got it all sorted \"should\" find every instance of \"801 C\" &amp; \"Nr\" going to leave this here in case it helps someone else out.</p>\n"}], "owner": {"reputation": 15, "user_id": 12492709, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAE9u8YtHC2mwMHrzESigZMcEmcnAOqIFUluswA=k-s128", "display_name": "Benjamin Bentley", "link": "https://stackoverflow.com/users/12492709/benjamin-bentley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 59297076, "answer_count": 2, "score": 0, "last_activity_date": 1576170916, "creation_date": 1576108308, "last_edit_date": 1576170916, "question_id": 59295816, "link": "https://stackoverflow.com/questions/59295816/excel-find-rows-between-two-strings-and-change-value-in-different-column-for-row", "title": "Excel find rows between two strings and change value in different column for rows between strings", "body": "<p>Not really sure how to go about finding the rows of data between the string [<strong>801 C</strong>] in [<strong>Column B</strong>] and the string [<strong>Nr</strong>] in [<strong>Column A</strong>] then change the value in [<strong>Column C</strong>] for the rows between from [<strong>3</strong>] to [<strong>27</strong>]. I have to reference the data on this sheet on another sheet to be able to graph the data for the L* a* b* for each color standard and the way the standards are stored on the spectrometer there is overlap for the standard ID number between the 700 and 800 color numbers so i have to figure out how to change the value of the standard ID number for the 800 series colors so the graphs only include that data. The standard Id number is the only thing available on each line in the log that ties each line(row) of data to each color. Also need to be able to find multiple instances were both strings may appear in the same sheet multiple times . Any help, ideas and advice will be greatly appreciated.</p>\n\n<p><a href=\"https://i.stack.imgur.com/LuUFB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LuUFB.png\" alt=\"Log csv\"></a></p>\n\n<p>I did manage with help from here at stackoveverflow to get a batch script to extract the data but can't get it to find but the first instance of both strings and is less than an ideal solution. A macro would be ideal but I am very new to vb scripting and this is beyond my scope of knowledge. Again thank you to anyone who replies to this you are a saint.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1576106462, "post_id": 59295567, "comment_id": 104795470, "body": "Arrays and possibly parameters but I&#39;m suspicious any array/comma joined values you dump into that query that appears to be running from access is going to have fairly poor performance anyways."}, {"owner": {"reputation": 1361, "user_id": 11808788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90824afde2c0e06cc75077e8a411590b?s=128&d=identicon&r=PG&f=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/11808788/charles"}, "edited": false, "score": 0, "creation_date": 1576106783, "post_id": 59295567, "comment_id": 104795562, "body": "its not possible to send more than 2000 parameters at a time imho. and also not a good idea. Can&#39;t you just fetch the whole table, and filter it in your vba? you can loop over the full table rs and just pick the rows you want, to copy to your worksheet. To your Question, you can speed up your string concat if you put it like this <code>myRange &amp; (&quot;&#39;&quot; &amp; cell.Value &amp; &quot;&#39;&quot; &amp; &quot;,&quot;)</code> then it will only concat one time, instead of 4 times. You can also split your queries into chunks and fetch max 2000 rows at a time, then you wont have any problem with your string concats..."}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1576106786, "post_id": 59295567, "comment_id": 104795563, "body": "See the first listed answer here for how to make the range -&gt; array -&gt;Join happen <a href=\"https://stackoverflow.com/questions/8482759/simple-vba-array-join-not-working\" title=\"simple vba array join not working\">stackoverflow.com/questions/8482759/&hellip;</a>"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1576106907, "post_id": 59295567, "comment_id": 104795597, "body": "Well, the performance won&#39;t be lightning fast, I&#39;m sure.  For now, I&#39;m just trying to do away with the looping process.  I tried this: arTesting = Range(&quot;A1:A&quot; &amp; LastRow).Value.  That&#39;s super-fast, but when I try to concatenate commas ar the end of each variable, I get an error.  So, this doesn&#39;t work: arTesting = Range(&quot;A1:A&quot; &amp; LastRow).Value &amp; &quot;,&quot;"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1576107691, "post_id": 59295567, "comment_id": 104795810, "body": "Yeah, Charles, that&#39;s pretty fast, at least on 20k records.  I&#39;ll probably need to up-it to 70k sometime soon.  I&#39;m pretty confident that VBA will fall down long before then.  How can I run this in batches of, let&#39;s say 2k-4k IDs at a time?  I think that&#39;s the best path forward."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1576110462, "post_id": 59295567, "comment_id": 104796424, "body": "What about using only SQL with a subquery?<code>Select * FROM myTable WHERE BB_ID IN  (Select id FROM [Sheet1$A1:A&quot; &amp; LastRow &amp; &quot;]) AND myDate &lt; &#39;12&#47;11&#47;2019&#39;</code> That should work in SQL-Server too."}], "answers": [{"comments": [{"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1576110388, "post_id": 59295925, "comment_id": 104796409, "body": "Awesome!  That&#39;s fast enough for me Tim!  How can I loop through my list, from beginning to end, in chunks of 500 rows at a time?  I think doing this in batches of 500 IDs at a time is safe enough.  Even 2000 is probably too much for Excel to handle.  Finally, how do I handle less than 500 IDs.  I&#39;m sure the last batch will not have exactly that number.  I just tested SQL, and if you enter &#39;&#39; as an ID, you get an error."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1576109275, "creation_date": 1576109275, "answer_id": 59295925, "question_id": 59295567, "link": "https://stackoverflow.com/questions/59295567/instead-of-looping-through-rows-how-can-i-very-quickly-create-a-comma-separated/59295925#59295925", "title": "Instead of looping through rows how can I very quickly create a comma separated list of IDs?", "body": "<pre><code>Dim s\ns = \"'\" &amp; Join(Application.Transpose(Range(\"A1:A2000\").Value), \"','\") &amp; \"'\"\n</code></pre>\n\n<p><code>Application.Transpose</code> has a limit of about 65k items, but your SQL likely has a much lower limit...</p>\n"}], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 59295925, "answer_count": 1, "score": 0, "last_activity_date": 1576163078, "creation_date": 1576106366, "last_edit_date": 1576106910, "question_id": 59295567, "link": "https://stackoverflow.com/questions/59295567/instead-of-looping-through-rows-how-can-i-very-quickly-create-a-comma-separated", "title": "Instead of looping through rows how can I very quickly create a comma separated list of IDs?", "body": "<p>The code below runs perfectly fine for me, but as I increase the number of rows from hundreds to 70k, the performance degrades to a point where it is not usable.  Here is my code.</p>\n\n<pre><code>'Find the last non-blank cell in column A(1)\nLastRow = Cells(Rows.Count, 1).End(xlUp).Row\nSet rng = Range(\"A2:A\" &amp; LastRow)\n\n    For Each cell In rng\n        myRange = myRange &amp; \"'\" &amp; cell.Value &amp; \"'\" &amp; \",\"\n    Next cell\n\n' remove last comma from concatenated string\nmyRange = Left(myRange, Len(myRange) - 1)\n\n'This is your actual MS SQL query that you need to run; you should check this query first using a more robust SQL editor (such as HeidiSQL) to ensure your query is valid\nStrQuery = \"SELECT * FROM myTable Where BB_ID IN (\" &amp; myRange &amp; \") AND myDate &lt; '12/11/2019';\"\n\n'Performs the actual query\nrst.Open StrQuery, cnn\n'Dumps all the results from the StrQuery into cell A2 of the first sheet in the active workbook\nWorksheets(\"Sheet1\").Range(\"A2\").CopyFromRecordset rst\n</code></pre>\n\n<p>How can I take a list of IDs in ColumnA and VERY QUICKLY convert it to comma-delimited string so I can feed it into a SQL query?  Thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 1, "creation_date": 1576114275, "post_id": 59295412, "comment_id": 104797167, "body": "Edit your question and show how the source data is layed out. We can work from there"}, {"owner": {"reputation": 158, "user_id": 12506685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bbdad43fa100913502ce67d1b6b0fd?s=128&d=identicon&r=PG&f=1", "display_name": "the VBE - it&#39;s right for me", "link": "https://stackoverflow.com/users/12506685/the-vbe-its-right-for-me"}, "edited": false, "score": 1, "creation_date": 1576120687, "post_id": 59295412, "comment_id": 104798402, "body": "You should not be using <code>.Select</code> or <code>.Selection</code> for any of this. The macro recorder returns that when you do things because it takes your actions literally instead of translating them to the actual underlying data changes. You can refer to a cell or a set of cells or a named range directly and change attributes like the value without any need to select them as you would if were using Excel normally. I&#39;ll show you an example of how to fix that in an answer."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12521114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08b2bac3e52c9fcea8d727a11b95b55e?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan", "link": "https://stackoverflow.com/users/12521114/bryan"}, "edited": false, "score": 0, "creation_date": 1576191987, "post_id": 59297531, "comment_id": 104829693, "body": "I can see the advantage of writing the code the way you did. I&#39;m just struggling to understand how it will work with the formulas. I started to rewrite it and am not sure if I should be writing each line as  <code>code With Worksheets(&quot;P&amp;L&quot;).Range(&quot;PnLTotalA&quot;).Activate         ActiveCell.Offset(-1, 0).FormulaR1C1 = &quot;=OFFSET(MP_GT_Publisher,-1,0)&quot; &#39;A         ActiveCell.Offset(-1, 2).Formula2R1C1 = &quot;=RC[1]&#47;0.85&quot; &#39;C         ActiveCell.Offset(0, 1).FormulaR1C1 = &quot;=OFFSET(MP_GT_ClientNet,-1,0)&quot; &#39;D End With </code> or as just one line item. i couldn&#39;t figure out how to do it - the with"}], "tags": [], "owner": {"reputation": 158, "user_id": 12506685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bbdad43fa100913502ce67d1b6b0fd?s=128&d=identicon&r=PG&f=1", "display_name": "the VBE - it&#39;s right for me", "link": "https://stackoverflow.com/users/12506685/the-vbe-its-right-for-me"}, "is_accepted": false, "score": 0, "last_activity_date": 1576123412, "creation_date": 1576123412, "answer_id": 59297531, "question_id": 59295412, "link": "https://stackoverflow.com/questions/59295412/how-do-i-replace-a-formula-to-stay-on-a-specific-cell-in-vba-when-the-sheet-it-r/59297531#59297531", "title": "How do I replace a formula to stay on a specific cell in vba when the sheet it references updates", "body": "<p>Here is where you copy the range of cells from the hidden sheet:</p>\n\n<pre><code>Sheets(\"Ref\").Select\nApplication.Goto Reference:=\"New_Vendor\"\nApplication.CutCopyMode = False\nSelection.Copy\n</code></pre>\n\n<p>Here is where you insert them with the value into the Media Plan sheet:</p>\n\n<pre><code>Sheets(\"Media Plan\").Select\nApplication.Goto Reference:=\"Grand_Total_Row\"\nSelection.Insert Shift:=xlDown\n</code></pre>\n\n<p>And here is where you insert the corresponding row in P&amp;L:</p>\n\n<pre><code>Application.Goto Reference:=\"PnL_Total_Row\"\nSelection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n</code></pre>\n\n<p>All you need to do is this:</p>\n\n<pre><code>cpyRow = Sheets(\"Media Plan\").Range(\"Grand_Total_Row\").Row 'read the row into a variable\nSheets(\"Media Plan\").Rows(cpyRow).Resize(19).Insert Shift:=xlDown 'insert the 19 rows\nSheets(\"Ref\").Range(\"New_Vendor\").Copy Sheets(\"Media Plan\").Cells(cpyRow, 1) 'copy the reference cells\nApplication.CutCopyMode = False\n</code></pre>\n\n<p>Sheets(\"P&amp;L\").Range(\"PnL_Total_Row\").EntireRow.Resize(1).Insert Shift:=xlDown 'insert the row, you shouldn't need to specify origin because it defaults to left or above</p>\n\n<p>That should be help you see how to apply it the rest of your code. Also note that you want to refer to a worksheet with its <code>.CodeName</code> (that is the name that appears before parentheses in editor) instead of the <code>.Name</code> since that allows you to rename the worksheet in the tab without having to update code. So replace <code>Sheets(\"Ref\")</code> with <code>reference</code> for example.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12521114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08b2bac3e52c9fcea8d727a11b95b55e?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan", "link": "https://stackoverflow.com/users/12521114/bryan"}, "is_accepted": true, "score": 0, "last_activity_date": 1576697652, "creation_date": 1576697652, "answer_id": 59398958, "question_id": 59295412, "link": "https://stackoverflow.com/questions/59295412/how-do-i-replace-a-formula-to-stay-on-a-specific-cell-in-vba-when-the-sheet-it-r/59398958#59398958", "title": "How do I replace a formula to stay on a specific cell in vba when the sheet it references updates", "body": "<p>This was my fix in the end.</p>\n\n<p>Added this declared variable just above the formula insert after the create new sheets as it then allowed me to create the right formula referencing the correct row, instead of relying on offset which would then update each time I ran the code causing the subtotal row to duplicate.</p>\n\n<p><code>Dim cntA As Long\n cntA = Sheets(\"Media Plan\").Range(\"cntA\")</code>    </p>\n\n<p>Also created a new defined cell in Column A that is cntA with the formula =row()-1 which is in the same row as the Grand Total row</p>\n\n<p>Changed the formula from <code>ActiveCell.Offset(-1, 0).FormulaR1C1 = \"=offset(MP_GT_Publisher,-1,0)\"</code> </p>\n\n<p>To this\n<code>ActiveCell.Offset(-1, 0).Formula = \"=\" &amp; mp &amp; \"H\" &amp; cntA</code></p>\n\n<p>Here is the full code</p>\n\n<pre><code>Sub NewVendorRevised()\n    Dim plWS As Excel.Worksheet\n    Set plWS = ActiveWorkbook.Sheets(\"P&amp;L\")\n    Dim mp As String\n    mp = \"'Media Plan'!\"\n\n    cpyRow = Sheets(\"Media Plan\").Range(\"Grand_Total_Row\").Row 'read the row into a variable\n\n    Sheets(\"Media Plan\").Rows(cpyRow).Resize(19).Insert Shift:=xlDown 'insert the 19 rows\n    Sheets(\"Ref\").Range(\"New_Vendor\").Copy Sheets(\"Media Plan\").Cells(cpyRow, 1) 'Copy the reference cells\n    Application.CutCopyMode = False\n    Sheets(\"P&amp;L\").Range(\"PnL_Total_Row\").EntireRow.Resize(1).Insert Shift:=xlDown\n\n    Dim cntA As Long\n    cntA = Sheets(\"Media Plan\").Range(\"cntA\")\n    'Formula is input into active sheet P&amp;L using defined name PnLTotalA\n        'A Publisher\n        ActiveWorkbook.Sheets(\"P&amp;L\").Activate\n        plWS.Range(\"PnLTotalA\").Activate\n        ActiveCell.Offset(-1, 0).Formula = \"=\" &amp; mp &amp; \"H\" &amp; cntA\n        'C Client Gross Rev\n        plWS.Range(\"PnLTotalA\").Activate\n        ActiveCell.Offset(-1, 2).FormulaR1C1 = \"=RC[1]/0.85\"\n        'D Client Net Rev\n        plWS.Range(\"PnLTotalA\").Activate\n        ActiveCell.Offset(-1, 3).Formula = \"=\" &amp; mp &amp; \"T\" &amp; cntA\n        'E Buyer Gross Budget Assigned\n        plWS.Range(\"PnLTotalA\").Activate\n        ActiveCell.Offset(-1, 4).FormulaR1C1 = \"=RC[1]/0.85\"\n        'F Buyer Net Budget Assigned\n        plWS.Range(\"PnLTotalA\").Activate\n        ActiveCell.Offset(-1, 5).Formula = \"=\" &amp; mp &amp; \"V\" &amp; cntA\n        'G Station Gross Purchased\n        plWS.Range(\"PnLTotalA\").Activate\n        ActiveCell.Offset(-1, 6).FormulaR1C1 = \"=RC[-2]\"\n        'H Cash % Purchased\n        plWS.Range(\"PnLTotalA\").Activate\n        ActiveCell.Offset(-1, 7).Formula = \"=\" &amp; mp &amp; \"W\" &amp; cntA\n        'I Trade % Purchased\n        plWS.Range(\"PnLTotalA\").Activate\n        ActiveCell.Offset(-1, 8).Formula = \"=\" &amp; mp &amp; \"X\" &amp; cntA\n        'J Net Cash Cost\n        plWS.Range(\"PnLTotalA\").Activate\n        ActiveCell.Offset(-1, 9).Formula = \"=\" &amp; mp &amp; \"Y\" &amp; cntA\n        'K Gross Trade Amount\n        plWS.Range(\"PnLTotalA\").Activate\n        ActiveCell.Offset(-1, 10).FormulaR1C1 = \"=RC[1]/0.85\"\n        'L Net Trade Cost\n        plWS.Range(\"PnLTotalA\").Activate\n        ActiveCell.Offset(-1, 11).Formula = \"=\" &amp; mp &amp; \"Z\" &amp; cntA &amp; \"*\" &amp; mp &amp; \"AA\" &amp; cntA\n        'M Net ET Cost\n        plWS.Range(\"PnLTotalA\").Activate\n        ActiveCell.Offset(-1, 12).FormulaR1C1 = \"=RC[-3]+RC[-1]\"\n        'N Net Media Spread\n        plWS.Range(\"PnLTotalA\").Activate\n        ActiveCell.Offset(-1, 13).FormulaR1C1 = \"=RC[-10]-RC[-1]\"\n        'O Media Spread Index\n        plWS.Range(\"PnLTotalA\").Activate\n        ActiveCell.Offset(-1, 14).FormulaR1C1 = \"=RC[-1]/RC[-11]\"\n        'P Est. Trade Credit Usage\n        'Q *Trade Credit Usage\n        plWS.Range(\"PnLTotalA\").Activate\n        ActiveCell.Offset(-1, 16).FormulaR1C1 = \"=RC[-1]*RC[-13]\"\n        'R Estimated ERT Net Profit\n        plWS.Range(\"PnLTotalA\").Activate\n        ActiveCell.Offset(-1, 17).FormulaR1C1 = \"=RC[-4]-RC[-1]\"\n        'S ERT Net Profit %\n        plWS.Range(\"PnLTotalA\").Activate\n        ActiveCell.Offset(-1, 18).FormulaR1C1 = \"=RC[-1]/RC[-15]\"\n        'T Gross Media Margin\n        plWS.Range(\"PnLTotalA\").Activate\n        ActiveCell.Offset(-1, 19).FormulaR1C1 = \"=RC[-2]/(RC[-16]-RC[-3])\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12521114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08b2bac3e52c9fcea8d727a11b95b55e?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan", "link": "https://stackoverflow.com/users/12521114/bryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "accepted_answer_id": 59398958, "answer_count": 2, "score": 0, "last_activity_date": 1576697652, "creation_date": 1576105182, "last_edit_date": 1576190919, "question_id": 59295412, "link": "https://stackoverflow.com/questions/59295412/how-do-i-replace-a-formula-to-stay-on-a-specific-cell-in-vba-when-the-sheet-it-r", "title": "How do I replace a formula to stay on a specific cell in vba when the sheet it references updates", "body": "<p>I've been playing with this code for the past week and have gotten it to 90% of what I want it to do.</p>\n\n<p>Rows 14 and 15 were manually selected when it comes to the formulas and are referencing subtotal cells on the Media Plan sheet. These are correct.</p>\n\n<p>This is the code in a nutshell:\n\"Insert new vendor\" will copy from \"ref sheet\" defined cells \"New_Vendor\" it is 19 rows including subtotal row with formulas.\nIt then creates a new row in \"P &amp; L sheet\" with the same formatting from the above cell.\nIt will then insert into the new row formulas that reference the cells from subtotal row in \"Media Plan sheet\"</p>\n\n<p>This all works great the first time.\n<br>\n<br>\n<br>\nThe issue is when you run the macro a second time.\nBecause I used offset from a defined name it updates the Vendor row to read the wrong line.\n<br>How do I stop this?\n<br>Is there a way to have the code run multiple times with each iteration referencing the correct new rows?</p>\n\n<p><br>\n<br>\n<br>\nIn Image 1\nRows 16 and 17 were created using the Macro code</p>\n\n<p>![Image shows formulas][1]</p>\n\n<p>![Name Manager with Defined Names][2]</p>\n\n<p>[Source Data][3]</p>\n\n<p>Any help would be much appreciated.</p>\n\n<p>Thank you.</p>\n\n<pre><code>Sub Insert_New_VendorPNL()\n'\n' Insert_New_Vendor Macro\n'\n\n'Screen won't update\n    Application.ScreenUpdating = False\n\n'Select from hidden Ref sheet rows 13:23 copy and paste to\n'Media Plan sheet above Grand Total Row\n\n    Sheets(\"Ref\").Select\n    Application.Goto Reference:=\"New_Vendor\"\n    Application.CutCopyMode = False\n    Selection.Copy\n'Go to Media Plan Sheet, Select Grand Total Row insert new rows\n    Sheets(\"Media Plan\").Select\n    Application.Goto Reference:=\"Grand_Total_Row\"\n    Selection.Insert Shift:=xlDown\n'Go to P&amp;L sheet insert new row above Total\n    Application.Goto Reference:=\"PnL_Total_Row\"\n    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n\n'Insert formulas\n'A Insert Publisher Name\n    Application.Goto Reference:=\"PnLTotalA\"                     'select PnLTotalA Cell\n    ActiveCell.Offset(-1, 0).Select                             'Go one row up\n    ActiveCell.FormulaR1C1 = \"=OFFSET(MP_GT_Publisher,-1,0)\"    'Insert Formula =OFFSET(\"Named Reference, 1 row up, 0 column change)\n\n'C Client Gross (revenue)\n    ActiveCell.Offset(0, 2).Select                              'Select cell to same row 2 columns to the right\n    ActiveCell.FormulaR1C1 = \"=RC[1]/0.85\"                      'Inserts Formula =R (Row Null)C[1 Column to the right]/0.85)\n'D Client Net (Revenue)\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.FormulaR1C1 = \"=OFFSET(MP_GT_ClientNet,-1,0)\"\n'E Buyer Gross Budget Assigned\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.FormulaR1C1 = \"=RC[1]/0.85\"\n'F Buyer Net Budget Assigned\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.FormulaR1C1 = \"=OFFSET(MP_GT_ETNegotiatedNet,-1,0)\"\n'G Station Gross Purchased\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.FormulaR1C1 = \"=RC[-2]\"\n'H Cash % Purchased\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.FormulaR1C1 = \"=OFFSET(MP_GT_ETPercentCash,-1,0)\"\n'I Trade % Purchased\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.FormulaR1C1 = \"=OFFSET(MP_GT_ETPercentTrade,-1,0)\"\n'J Net Cash Cost\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.FormulaR1C1 = \"=OFFSET(MP_GT_ETCashCost,-1,0)\"\n'K Gross Trade Amount\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.FormulaR1C1 = \"=RC[1]/0.85\"\n'L Net Trade Cost\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.FormulaR1C1 = \"=OFFSET(MP_GT_ETTotalTrade,-1,0)*OFFSET(MP_GT_ETTradeFactor,-1,0)\"\n'M Net ET Cost\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.FormulaR1C1 = \"=RC[-3]+RC[-1]\"\n'N Net Media Spread\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.FormulaR1C1 = \"=RC[-10]-RC[-1]\"\n'O Media Spread Index\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.FormulaR1C1 = \"=RC[-1]/RC[-11]\"\n'P Est. Trade Credit Usage\n'Q *Trade Credit Usage\n    ActiveCell.Offset(0, 2).Select\n    ActiveCell.FormulaR1C1 = \"=RC[-1]*RC[-13]\"\n'R Estimated ERT Net Profit\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.FormulaR1C1 = \"=RC[-4]-RC[-1]\"\n'S ERT Net Profit %\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.FormulaR1C1 = \"=RC[-1]/RC[-15]\"\n'T Gross Media Margin\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.FormulaR1C1 = \"=RC[-2]/(RC[-16]-RC[-3])\"\n\n'go to and select Grand Total Row\n'    Application.Goto Reference:=\"Grand_Total_Row\"\n\n\nEnd Sub```\n\n\n  [1]: https://i.stack.imgur.com/0ZXAG.png\n  [2]: https://i.stack.imgur.com/hRfEV.png\n  [3]: https://i.stack.imgur.com/wO3ts.png\n</code></pre>\n"}, {"tags": ["excel", "vba", "select-case"], "comments": [{"owner": {"reputation": 316, "user_id": 12131488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVDpB.jpg?s=128&g=1", "display_name": "SmileyFtW", "link": "https://stackoverflow.com/users/12131488/smileyftw"}, "edited": false, "score": 1, "creation_date": 1576105909, "post_id": 59295267, "comment_id": 104795336, "body": "beyond <code>NA</code> in the table you&#39;ve shown, what will the data look like? I am assuming that the I and J columns will have the same info, but the value in K may be something other than 1 thru 8"}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1576106045, "post_id": 59295267, "comment_id": 104795369, "body": "Also if you could mockup an example of what the output should be would likely be helpful."}, {"owner": {"reputation": 316, "user_id": 12131488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVDpB.jpg?s=128&g=1", "display_name": "SmileyFtW", "link": "https://stackoverflow.com/users/12131488/smileyftw"}, "edited": false, "score": 0, "creation_date": 1576106256, "post_id": 59295267, "comment_id": 104795417, "body": "it looks like you are replacing the value in J with its original value appended with the value in K. Is that what you&#39;re after? If so, the solution below will do that."}, {"owner": {"reputation": 1, "user_id": 12521237, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vipQtwT-nD0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf0w99I4wnMEZ_oy-4T9t1nmdYJlw/photo.jpg?sz=128", "display_name": "Stephanie Siegel", "link": "https://stackoverflow.com/users/12521237/stephanie-siegel"}, "edited": false, "score": 0, "creation_date": 1576108641, "post_id": 59295267, "comment_id": 104796034, "body": "The solution below isn&#39;t what I&#39;m looking for.  I want to create a macro that spits out the correct language of an entry based on the kind of work completed in a work order.   For example, ID or Install New and then return the correct language and reference data for the entry:  I2: ID K2: Number  (I&#39;d type in the actual No.) Returns:  &quot;Complied with ID No. [K2]. No defects noted.&quot;   I4: Install New L4: Actual part number M4: etc... N4: ... O4: ... &quot;Removed P/N [L4], S/N [M4]. Installed P/N [N4], S/N [O4]. Ops checked good.&quot;  Does that make sense? Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 316, "user_id": 12131488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVDpB.jpg?s=128&g=1", "display_name": "SmileyFtW", "link": "https://stackoverflow.com/users/12131488/smileyftw"}, "is_accepted": false, "score": 0, "last_activity_date": 1576106418, "creation_date": 1576106418, "answer_id": 59295572, "question_id": 59295267, "link": "https://stackoverflow.com/questions/59295267/select-case-with-complex-return-value-vba-2007/59295572#59295572", "title": "Select Case with Complex Return Value (VBA 2007)", "body": "<pre><code>For each cell in Range(\"I2:I302\")\n   cell.offset(0,1).value=cell.offset(0,1).text &amp; cell.offset(0,2).text\nnext\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12521237, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vipQtwT-nD0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf0w99I4wnMEZ_oy-4T9t1nmdYJlw/photo.jpg?sz=128", "display_name": "Stephanie Siegel", "link": "https://stackoverflow.com/users/12521237/stephanie-siegel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1578524245, "creation_date": 1576104271, "last_edit_date": 1578524245, "question_id": 59295267, "link": "https://stackoverflow.com/questions/59295267/select-case-with-complex-return-value-vba-2007", "title": "Select Case with Complex Return Value (VBA 2007)", "body": "<p>Using Excel 2007 and inexperienced with VBA. </p>\n\n<p>I am trying to create a text generator where, given a particular type of entry, it returns a string of text AND a number of corresponding cells. </p>\n\n<p>I have a lot of data to combine and somewhat complex text statements. The data I have here is sample data. The final file will combine multiple text strings (\"one\" and \"two\", etc) with multiple cells that need to be referenced based on the specific data input there (some instances require 8 different cells). </p>\n\n<p>I was able to figure out how to do Select Case where it can look up the type of entry I need, and it returns a specific text string. Great! I also know I can combine things like \"One\" &amp; \"Two\". But how do I combine the corresponding text for the line?</p>\n\n<p>Where if the entry was \"ID\" I could return something that looked like \"One 1\" but combines \"One \" &amp; K2 as the .Value to return?</p>\n\n<p>Image shows the sample data</p>\n\n<p><a href=\"https://i.stack.imgur.com/vGVIH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vGVIH.png\" alt=\"enter image description here\"></a></p>\n\n<p>Image shows data for Columns I, J, and K. \nColumn I stores the entry type, J is where the data is returned, and K is the column with data to be referenced. Again, what's here is the simplified reference data. </p>\n\n<p>I know this line is wrong. But I'm not sure what to put in place for K2 so it will correctly reference the cell, and then loop correctly for 300 times. </p>\n\n<pre><code>Case Is = \"ID\": .Value = \"One\" &amp; (K2)\n</code></pre>\n\n<p>Am I close to something workable? What would you suggest? Is Select Case the wrong way to handle this problem?</p>\n\n<p>I've tried a number of options, but I am inexperienced with VBA. I think whatever I implemented to fix the issue was likely done incorrectly. </p>\n\n<p>Full code of what I have shown below. </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim logtype As Range\n\nFor Each logtype In Range(\"I2:I302\")\n    With logtype.Offset(0, 1)\n\n        Select Case logtype.Value\n            Case Is = \"ID\": .Value = \"One\" &amp; K2\n            Case Is = \"Phase\": .Value = \"Two\"\n            Case Is = \"Install New\": .Value = \"Three\"\n            Case Is = \"Install OH\": .Value = \"Four\"\n           Case Is = \"Install AR\": .Value = \"Five\"\n            Case Is = \"Insp\": .Value = \"Six\"\n            Case Is = \"LUI\": .Value = \"Seven\"\n            Case Is = \"\": .Value = \"\"\n            Case Else: .Value = \"Not Recognized\"\n        End Select\n    End With\nNext logtype\n\nEnd Sub\n</code></pre>\n\n<p>EDIT: </p>\n\n<p>What I put in a comment below, just formatted more clearly.</p>\n\n<p>I want to create a macro that spits out the correct language of an entry based on the kind of work completed in a work order. </p>\n\n<p>For example, ID or Install New and then return the correct language and reference data for the entry: </p>\n\n<p>I2: ID </p>\n\n<p>K2: Number (I'd type in the actual No.) </p>\n\n<p>Returns: </p>\n\n<p>\"Complied with ID No. [K2]. No defects noted.\" </p>\n\n<p>I4: Install New</p>\n\n<p>L4: Actual part number </p>\n\n<p>M4: etc... </p>\n\n<p>N4: ... </p>\n\n<p>O4: ... </p>\n\n<p>Returns:</p>\n\n<p>\"Removed P/N [L4], S/N [M4]. Installed P/N [N4], S/N [O4]. Ops checked good.\" </p>\n\n<p>Does that make sense? Thanks!</p>\n\n<p>EDIT 2:</p>\n\n<p>Hey everyone, I've tried tracking down alternative methods of solving this problem but I still haven't produced anything better than what I have here. </p>\n\n<p>Any thoughts or help would be greatly appreciated. Thank you!</p>\n"}, {"tags": ["excel", "vba", "permutation"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1576104295, "post_id": 59295221, "comment_id": 104794841, "body": "You mention adding conditions, what are they?"}, {"owner": {"reputation": 1, "user_id": 12521289, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-U20gNBh17w4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcj_7rTja1jZiOVlFg4aDh5Dehv_A/photo.jpg?sz=128", "display_name": "Thomas", "link": "https://stackoverflow.com/users/12521289/thomas"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1576105701, "post_id": 59295221, "comment_id": 104795275, "body": "the conditions will be mainly : - ignoring doubles if all the parameters of cell A = Cell B - proceeding only when some parameters in cell A matches cell B"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1576106358, "post_id": 59295221, "comment_id": 104795447, "body": "Welcome to SO! Please take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. For huge data, use a database (e.g. SQL.Server, MySQL , ...) and query with SQL.(Almost no limit on size). Or try Office x64 what increases the data linit of Excel"}, {"owner": {"reputation": 371, "user_id": 3654325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd52c1ed316019e2384605e1814a8f5?s=128&d=identicon&r=PG&f=1", "display_name": "Stax", "link": "https://stackoverflow.com/users/3654325/stax"}, "edited": false, "score": 1, "creation_date": 1576118409, "post_id": 59295221, "comment_id": 104797944, "body": "Unless you reduce the 40000 BEFORE running Permutation, you still need to process 1.6 Billion permutations... whether or not you then &quot;Save&quot; them. I believe to get a reasonable running time you will Have to pull the data into arrays and manipulate it &quot;in memory&quot; as that&#39;s far faster than looping through cells. However, even arrays have memory limitations I think this may exceed. (Frankly I wonder if this is more for a &quot;maths&quot; program like Sage or Mathematica)"}, {"owner": {"reputation": 136, "user_id": 2790342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfd13510122d7b2f5216ef4faa38f0b?s=128&d=identicon&r=PG&f=1", "display_name": "PuravTheGreat", "link": "https://stackoverflow.com/users/2790342/puravthegreat"}, "edited": false, "score": 0, "creation_date": 1576123469, "post_id": 59295221, "comment_id": 104798951, "body": "You could add a <code>counter</code> variable which starts at 1, and it increases by 1 when N reaches 1.000.000 (so <code>counter</code> = 2), and then becomes 3 when N reaches 2.000.000, and have it so that <code>Cells(N, 3) = Cells(i, 1) &amp; Cells(k, 2)</code> instead says <code>Sheets(counter).Cells(N, 3) = Sheets(counter).Cells(i,1) &amp; Sheets(counter).Cells(k,2)</code>. Just make sure you have enough sheets already created before running the macro. So, <code>counter</code> is a reference to the sheet index."}], "answers": [{"tags": [], "owner": {"reputation": 1819, "user_id": 10046897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d58775bff3c1d7010b8568a75adacd3b?s=128&d=identicon&r=PG&f=1", "display_name": "Zwenn", "link": "https://stackoverflow.com/users/10046897/zwenn"}, "is_accepted": false, "score": 1, "last_activity_date": 1576157475, "creation_date": 1576157475, "answer_id": 59305755, "question_id": 59295221, "link": "https://stackoverflow.com/questions/59295221/splitting-a-big-permutation/59305755#59305755", "title": "Splitting a big permutation", "body": "<p>What ever you want to analyse, you can't use all results from the permutation in one step. Like Stax wrote, you would have 1.6 billion single values. Even if you wrote 1 million per sheet you need 1600 sheets. For every character in a value you need 1.6GB memory. I don't know your mashine but if every value has a length of 3 characters you need 4.8GB memory only for your data. Excel 32 bit can only handle 4GB. There is no way with Excel in that way.</p>\n\n<p>But if you don't need all values at the same time you can work in another way. You have 40k blocks with 40k values. Your second column is in every 40k block the same. You must only switch the first part of a 40k permutation block to the value of the first column you need at that time. It's like counting. Nobody writes down all numbers to calculate something. You simply use the required number section.</p>\n\n<p>(To long as a comment)</p>\n"}], "owner": {"reputation": 1, "user_id": 12521289, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-U20gNBh17w4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcj_7rTja1jZiOVlFg4aDh5Dehv_A/photo.jpg?sz=128", "display_name": "Thomas", "link": "https://stackoverflow.com/users/12521289/thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1582236490, "creation_date": 1576104052, "last_edit_date": 1582236490, "question_id": 59295221, "link": "https://stackoverflow.com/questions/59295221/splitting-a-big-permutation", "title": "Splitting a big permutation", "body": "<p>I have two columns, with 40.000 rows.</p>\n\n<p>I need to do permutation between the two columns and analyse the results.</p>\n\n<p>I know that doing a permutation of 40.000 x 40.000 will give huge results. I believe I can narrow the results by adding conditions, so I can ignore some of the inputs.</p>\n\n<p>Still I will get results much bigger than the row limit of the sheet.</p>\n\n<p>How can I split the results so I can create a new sheet / new workbook, every 1.000.000 results?</p>\n\n<p>My permutation loop: </p>\n\n<pre><code>Sub Permutation()\n    Dim i As Long, k As Long, N As Long\n\n    N = 1\n    For i = 1 To 40000\n            For k = 1 To 40000\n                Cells(N, 3) = Cells(i, 1) &amp; Cells(k, 2)\n                N = N + 1\n            Next k\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "windows"], "comments": [{"owner": {"reputation": 95, "user_id": 5070107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10db753601e6e5537c4c83c4a07768c?s=128&d=identicon&r=PG&f=1", "display_name": "Donald Li", "link": "https://stackoverflow.com/users/5070107/donald-li"}, "edited": false, "score": 0, "creation_date": 1576174717, "post_id": 59295148, "comment_id": 104823292, "body": "I accepted Brax answer because I feel explicitly (i.e. UNC path) is favored. But if you are still looking for ways to find VBA network drive letter for different users, here is a <a href=\"https://stackoverflow.com/questions/45425183/return-vba-network-drive-letter-for-different-users\">way</a>"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 5070107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10db753601e6e5537c4c83c4a07768c?s=128&d=identicon&r=PG&f=1", "display_name": "Donald Li", "link": "https://stackoverflow.com/users/5070107/donald-li"}, "edited": false, "score": 1, "creation_date": 1576168546, "post_id": 59295220, "comment_id": 104820439, "body": "Thanks for the timely response! I changed the <code>msoFileDialogOpen</code> to <code>msoFileDialogSelect</code> since I just need the file name for my case, but everything works perfectly."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 95, "user_id": 5070107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10db753601e6e5537c4c83c4a07768c?s=128&d=identicon&r=PG&f=1", "display_name": "Donald Li", "link": "https://stackoverflow.com/users/5070107/donald-li"}, "edited": false, "score": 0, "creation_date": 1576168640, "post_id": 59295220, "comment_id": 104820490, "body": "Thanks for adding that information. It adds value to this answer."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 1, "last_activity_date": 1576104052, "creation_date": 1576104052, "answer_id": 59295220, "question_id": 59295148, "link": "https://stackoverflow.com/questions/59295148/vba-how-to-change-drive-chdrive-if-letter-mapping-of-the-network-drive-is-un/59295220#59295220", "title": "VBA - how to change drive (ChDrive) if letter mapping of the network drive is unknown", "body": "<p>You can write a function using the msoFileDialogOpen option and specify an initial filename:</p>\n\n<pre><code>Function FileOpen(initialFilename As String, Optional sDesc As String = \"CSV Files (*.csv)\", Optional sFilter As String = \"*.csv\") As String\n  With Application.FileDialog(msoFileDialogOpen)\n    .initialFilename = initialFilename\n    .Filters.Clear\n    .Filters.Add sDesc, sFilter, 1\n    .Title = \"File Open\"\n    .AllowMultiSelect = False\n    If .Show = -1 Then FileOpen = .SelectedItems(1)\n  End With\nEnd Function\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>Sub Test()\n  MsgBox FileOpen(\"\\\\server\\share\", \"Select a File\", \"*.csv\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 5070107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10db753601e6e5537c4c83c4a07768c?s=128&d=identicon&r=PG&f=1", "display_name": "Donald Li", "link": "https://stackoverflow.com/users/5070107/donald-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 568, "favorite_count": 0, "closed_date": 1576174595, "accepted_answer_id": 59295220, "answer_count": 1, "score": 1, "last_activity_date": 1576104052, "creation_date": 1576103620, "last_edit_date": 1576103705, "question_id": 59295148, "link": "https://stackoverflow.com/questions/59295148/vba-how-to-change-drive-chdrive-if-letter-mapping-of-the-network-drive-is-un", "closed_reason": "Duplicate", "title": "VBA - how to change drive (ChDrive) if letter mapping of the network drive is unknown", "body": "<p>For the project I am doing, I am going to open up a csv file based on user's choice. The csv file would sit in folder like <code>\\\\server\\share\\folder\\file.csv</code> or <code>M:\\folder\\file.csv</code>.</p>\n\n<pre><code>dim PATH As String: PATH = \"M:\\folder\\file.csv\"\nChDrive (Left(PATH, 1))        ' point to the drive\nChDir PATH\n\n' get csv file name\ncsv_file_name = Application.GetOpenFilename(\"CSV Files (*.csv), *.csv\", , \"Select a CSV file\", , False)\n</code></pre>\n\n<p><em>The code above opens up a select file box at PATH.</em> </p>\n\n<p>The problem is, not all the machines have the same network drive mapping. For the same <code>\\\\server\\share</code> combo, some people might map it to <strong>M</strong> and others might map it to <strong>Z</strong>. So instead, I was wondering if I can do something like <code>ChDrive \"\\\\server\\share\\\"</code>. Unfortunately, <code>ChDrive</code> only takes drive letter as paramter. </p>\n\n<p>I was wondering if there's a more generic solution to a problem like this. Thanks!</p>\n"}, {"tags": ["excel", "vba", "transpose"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1576103145, "post_id": 59295001, "comment_id": 104794493, "body": "Why not <i>try to make a start</i> then post your code if you run into a specific problem?"}, {"owner": {"reputation": 3035, "user_id": 1357061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbacb6daf199175a515c835c3350e6cf?s=128&d=identicon&r=PG", "display_name": "Ryan B.", "link": "https://stackoverflow.com/users/1357061/ryan-b"}, "edited": false, "score": 0, "creation_date": 1576104240, "post_id": 59295001, "comment_id": 104794825, "body": "I just  helped someone with this.  <a href=\"https://stackoverflow.com/questions/59185367/how-to-horizontally-return-looked-up-values-from-duplicates-w-vba-pic/59254703#59254703\" title=\"how to horizontally return looked up values from duplicates w vba pic\">stackoverflow.com/questions/59185367/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3035, "user_id": 1357061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbacb6daf199175a515c835c3350e6cf?s=128&d=identicon&r=PG", "display_name": "Ryan B.", "link": "https://stackoverflow.com/users/1357061/ryan-b"}, "edited": false, "score": 0, "creation_date": 1576126799, "post_id": 59296921, "comment_id": 104799669, "body": "yay... i&#39;m a big fan of power query.  It&#39;s fantastic for these kinds of transformations."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 2, "last_activity_date": 1576118167, "creation_date": 1576118167, "answer_id": 59296921, "question_id": 59295001, "link": "https://stackoverflow.com/questions/59295001/two-columns-of-data-and-transpose-matching-column-a-values-to-the-same-line/59296921#59296921", "title": "Two columns of data and transpose-matching column A values to the same line", "body": "<p>You can do this easily with <code>Power Query</code> available in Excel 2010+</p>\n\n<p>In Excel 2016+ (may be different in earlier versions)</p>\n\n<ul>\n<li>Data \u2192 Get&amp;Transform \u2192 From Table/Range</li>\n<li>in the PQ Editor\n\n<ul>\n<li>Select Column 1 and <code>Group Rows</code></li>\n</ul></li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/oUa6m.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oUa6m.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<ul>\n<li>Add Custom Column and enter the formula:</li>\n</ul>\n\n<hr>\n\n<pre><code>Table.Column([Grouped],\"Column2\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/CKGSH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CKGSH.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<ul>\n<li>Delete the \"Table\" column</li>\n<li>Click on the double arrow of the \"List\" column\n   -Extract values (use semicolon as a delimiter)</li>\n<li>Split that column by delimiter</li>\n</ul>\n\n<p>And this is what you get:</p>\n\n<p><a href=\"https://i.stack.imgur.com/T07v1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/T07v1.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>Here is the \"M\" Code generated by the above.  You could probably cut/paste this instead of going through the above steps, but you'd have to change the name of the <code>Table</code> from <code>Table5</code> to whatever it really is.</p>\n\n<pre><code>let\n    Source = Excel.CurrentWorkbook(){[Name=\"Table5\"]}[Content],\n    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"Column1\", type text}, {\"Column2\", type text}}),\n    #\"Grouped Rows\" = Table.Group(#\"Changed Type\", {\"Column1\"}, {{\"Grouped\", each _, type table [Column1=text, Column2=text]}}),\n    #\"Added Custom\" = Table.AddColumn(#\"Grouped Rows\", \"FirstName\", each Table.Column([Grouped],\"Column2\")),\n    #\"Removed Columns\" = Table.RemoveColumns(#\"Added Custom\",{\"Grouped\"}),\n    #\"Extracted Values\" = Table.TransformColumns(#\"Removed Columns\", {\"FirstName\", each Text.Combine(List.Transform(_, Text.From), \";\"), type text}),\n    #\"Split Column by Delimiter\" = Table.SplitColumn(#\"Extracted Values\", \"FirstName\", Splitter.SplitTextByDelimiter(\";\", QuoteStyle.Csv), {\"FirstName.1\", \"FirstName.2\", \"FirstName.3\", \"FirstName.4\", \"FirstName.5\"}),\n    #\"Changed Type1\" = Table.TransformColumnTypes(#\"Split Column by Delimiter\",{{\"FirstName.1\", type text}, {\"FirstName.2\", type text}, {\"FirstName.3\", type text}, {\"FirstName.4\", type text}, {\"FirstName.5\", type text}})\nin\n    #\"Changed Type1\"\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 9973154, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216773128747389/picture?type=large", "display_name": "John Joseph", "link": "https://stackoverflow.com/users/9973154/john-joseph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 1, "accepted_answer_id": 59296921, "answer_count": 1, "score": 0, "last_activity_date": 1576118167, "creation_date": 1576102892, "last_edit_date": 1576103033, "question_id": 59295001, "link": "https://stackoverflow.com/questions/59295001/two-columns-of-data-and-transpose-matching-column-a-values-to-the-same-line", "title": "Two columns of data and transpose-matching column A values to the same line", "body": "<p>I am trying to do nearly exactly what this OP asked:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/39508852/table-of-data-want-to-group-transpose-matching-values-same-line\">Table of data want to group, transpose matching values same line</a></p>\n\n<p>Though the answers only tally how many cases of each Column A item there is. I'd like to revisit the original ask: I have two columns of data and to explain easier, I'll use names. I have a listing of surnames and family members like this:</p>\n\n<pre><code>COLUMN A  COLUMN B\n--------- ---------\nJones     Andy\nJones     Karen\nJones     Jimmy\nJones     Robert\nJones     Susie\nThompson  Henry\nThompson  Beth\nPatel     Hardeep\nPatel     Sneha\nPatel     Radha\nPatel     Naveen\nHealy     Cillian\nHealy     Sinead\nHealy     Aiden\nSmith     Robert\nSmith     Mary\nSmith     James\nSmith     Christine\n</code></pre>\n\n<p>I would like to end up with this - TRANSPOSING the list, then grouping the first names along the row for each family surname.</p>\n\n<pre><code>    A         B      C        D        E          F\n--------- -------  -------  -------  -------    ------- \nJones     Andy     Karen    Jimmy    Robert     Susie\nThompson  Henry    Beth\nPatel     Hardeep  Sneha    Radha    Naveen \nHealy     Cillian  Sinead   Aiden\nSmith     Robert   Mary     James    Christine\n</code></pre>\n\n<p>Like the original poster, I don't know how many family members are in each family. I suppose I could have a maximum family size (like 50) for a looping limit. I also suppose I can loop through the columns using range.offset() to traverse the columns and rows, then do something with the blank rows to clean up afterwards. </p>\n\n<p>I fear that it will be slow. My use case is actually factory part numbers (the surnames) residing in many inventory warehouses (the firstnames). It is true in our system one part number could possibly reside in up to 50 warehouses.</p>\n\n<p>I'm up for any suggestions with the above last name, first name example.</p>\n\n<p>Thanks!\nJohn</p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1576103116, "post_id": 59294971, "comment_id": 104794480, "body": "Pivot tables are a bit slow. But, in general, <a href=\"https://stackoverflow.com/a/49514930/5448626\">take a look here</a> and speed up the code a bit. <code>Application.ScreenUpdating = False</code> written after the second line of your code will do miracles."}, {"owner": {"reputation": 1, "user_id": 12521110, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD8XEOw8FIWrVpYAnwTW4DeYJncXv8VLixGrnFq=k-s128", "display_name": "Ematics", "link": "https://stackoverflow.com/users/12521110/ematics"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1576174145, "post_id": 59294971, "comment_id": 104823065, "body": "@Vityata its weird because another code for a report I have runs really fast (its also longer than this one) so its very confusing to me why this would take longer than the other.  Could it be like this because of all the new sheets i have added to this since for the other report I don&#39;t have it make new sheets?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1576176856, "post_id": 59294971, "comment_id": 104824222, "body": "&quot;Could it be like this because of all the new sheets i have added?&quot; - 10 worksheets are not that many and there is no data in them. So, I would say 99% &quot;no&quot;. I would still go with the pivots, they are slow, depending on the amount on data with them."}, {"owner": {"reputation": 1, "user_id": 12521110, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD8XEOw8FIWrVpYAnwTW4DeYJncXv8VLixGrnFq=k-s128", "display_name": "Ematics", "link": "https://stackoverflow.com/users/12521110/ematics"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1576177648, "post_id": 59294971, "comment_id": 104824539, "body": "@Vityata Ok, for my last question for you then would be, would it be better to have the record macro be my macro because it appears to be faster than what I currently have here in terms of how long it takes to finish running the macro?  For instance for the auto record macro I have it takes 45 sec to finish doing everything I need, but just for this first pivot on the above code it takes a few minutes."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1576180108, "post_id": 59294971, "comment_id": 104825461, "body": "the recorded macro should be way slower, unless it does not make less actions than the VBA code (or the VBA code is doing some useless actions).Thus, I guess the recorded macro, taking 45 seconds does way less than the code. What I can advise is to take a good look at what the recorded macro does and possibly even to go line by line with F8 and then to improve it."}, {"owner": {"reputation": 1, "user_id": 12521110, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD8XEOw8FIWrVpYAnwTW4DeYJncXv8VLixGrnFq=k-s128", "display_name": "Ematics", "link": "https://stackoverflow.com/users/12521110/ematics"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1576180481, "post_id": 59294971, "comment_id": 104825603, "body": "@Vityata Hey thats what I ended up doing and copying some stuff over and deleting some stuff as well, I&#39;ll post my new code incase anyone else needs help with something like this.  Thanks for all of your help!"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12521110, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD8XEOw8FIWrVpYAnwTW4DeYJncXv8VLixGrnFq=k-s128", "display_name": "Ematics", "link": "https://stackoverflow.com/users/12521110/ematics"}, "is_accepted": true, "score": 0, "last_activity_date": 1576180614, "creation_date": 1576180614, "answer_id": 59311865, "question_id": 59294971, "link": "https://stackoverflow.com/questions/59294971/what-causes-this-vba-code-to-take-so-long-to-run/59311865#59311865", "title": "What causes this VBA Code to take so long to run?", "body": "<p>So I was able to find a way to make my pivot table run faster than before.  I think it has something to do with the PTable1.PivotFields section of my previous code, my new code, which is longer now that I figured it out works like a charm.</p>\n\n<pre><code>Sub LiveERP_Test()\n'\n' LiveERP_Test Macro\n'\n' Keyboard Shortcut: Ctrl+q\n'\nWith ActiveWindow\n    .SplitColumn = 0\n    .SplitRow = 1\nEnd With\nActiveWindow.FreezePanes = True\nDim ws1 As Worksheet\nDim ws2 As Worksheet\nDim ws3 As Worksheet\nDim ws4 As Worksheet\nDim ws5 As Worksheet\nDim ws6 As Worksheet\nDim ws7 As Worksheet\nDim ws8 As Worksheet\nDim ws9 As Worksheet\nDim ws10 As Worksheet\nDim LastRow As Long\nDim LastRow1 As Long\nDim LastCol1 As Long\nDim LastRow2 As Long\nDim LastCol2 As Long\nDim LastRow3 As Long\nDim LastCol3 As Long\nDim LastRow4 As Long\nDim LastCol4 As Long\nDim LastRow5 As Long\nDim LastCol5 As Long\nDim LastRow6 As Long\nDim LastCol6 As Long\nDim PTable1 As PivotTable\nDim PCache1 As PivotCache\nDim PRange1 As Range\nDim PTable2 As PivotTable\nDim PCache2 As PivotCache\nDim PRange2 As Range\nDim PTable3 As PivotTable\nDim PCache3 As PivotCache\nDim PRange3 As Range\nDim PTable4 As PivotTable\nDim PCache4 As PivotCache\nDim PRange4 As Range\nDim PTable5 As PivotTable\nDim PCache5 As PivotCache\nDim PRange5 As Range\nDim PTable6 As PivotTable\nDim PCache6 As PivotCache\nDim PRange6 As Range\n\nSet ws1 = Sheets(1)\nSet ws2 = Sheets.Add(After:=ActiveSheet)\nSet ws3 = Sheets.Add(After:=ActiveSheet)\nSet ws4 = Sheets.Add(After:=ActiveSheet)\nSet ws5 = Sheets.Add(After:=ActiveSheet)\nSet ws6 = Sheets.Add(After:=ActiveSheet)\nSet ws7 = Sheets.Add(After:=ActiveSheet)\nSet ws8 = Sheets.Add(After:=ActiveSheet)\nSet ws9 = Sheets.Add(After:=ActiveSheet)\nSet ws10 = Sheets.Add(After:=ActiveSheet)\n\nws2.Name = \"Total\"\nws3.Name = \"01\"\nws4.Name = \"IM\"\nws5.Name = \"AMA\"\nws6.Name = \"TD\"\nws7.Name = \"PUP\"\nws8.Name = \"POS\"\nws9.Name = \"STG\"\nws10.Name = \"07\"\n\nWith ws1\n\n    .Columns(\"W:W\").EntireColumn.AutoFit\n    .Cells(\"1,24\") = \"Bin\"\n    .Cells(\"1,25\") = \"UN\"\n    .Range(\"A:Y\").AutoFilter _\n        Field:=13, _\n        Criteria1:=\"&gt;=1\"\n\nLastRow = .Cells(Rows.Count, 1).End(xlUp).Row\n\n    .Range(\"E1:M\" &amp; LastRow).Copy ws2.Range(\"A1\")\n\n    .Range(\"A:Y\").AutoFilter _\n        Field:=21, _\n        Criteria1:=\"=1\", _\n        Operator:=xlOr, Criteria2:=\"=01DIST\"\n\n    .Range(\"E1:M\" &amp; LastRow).Copy ws3.Range(\"A1\")\n\n    .Range(\"A:Y\").AutoFilter _\n        Field:=21, _\n        Criteria1:=Array(\"10\", \"20\", \"40\", \"80\")\n\n    .Range(\"E1:M\" &amp; LastRow).Copy ws4.Range(\"A1\")\n\n    .Range(\"A:Y\").AutoFilter _\n        Field:=21, _\n        Criteria1:=\"=AMA\"\n\n    .Range(\"E1:M\" &amp; LastRow).Copy ws5.Range(\"A1\")\n\n    .Range(\"A:Y\").AutoFilter _\n        Field:=21, _\n        Criteria1:=\"=TD\"\n\n    .Range(\"E1:M\" &amp; LastRow).Copy ws6.Range(\"A1\")\n\n    .Range(\"A:Y\").AutoFilter _\n        Field:=21, _\n        Criteria1:=\"=STG\"\n\n    .Range(\"E1:M\" &amp; LastRow).Copy ws9.Range(\"A1\")\n\n    .Range(\"A:Y\").AutoFilter _\n        Field:=21, _\n        Criteria1:=\"7\"\n\n    .Range(\"E1:M\" &amp; LastRow).Copy ws10.Range(\"A1\")\n    .Range(\"U1:V\" &amp; LastRow).Copy ws10.Range(\"J1\")\n\nEnd With\n\nLastRow1 = ws2.Cells(Rows.Count, 1).End(xlUp).Row\nLastCol1 = ws2.Cells(1, Columns.Count).End(xlToLeft).Column\n\nSet PRange1 = ws2.Range(\"A1\").CurrentRegion\n\nSet PCache1 = ActiveWorkbook.PivotCaches.Create(xlDatabase, PRange1)\n\nSet PTable1 = PCache1.CreatePivotTable(ws2.Cells(1, 10), \"PivotTable1\")\n\nWith ws2.PivotTables(\"PivotTable1\")\n    .ColumnGrand = True\n    .HasAutoFormat = True\n    .DisplayErrorString = False\n    .DisplayNullString = True\n    .EnableDrilldown = True\n    .ErrorString = \"\"\n    .MergeLabels = False\n    .NullString = \"\"\n    .PageFieldOrder = 2\n    .PageFieldWrapCount = 0\n    .PreserveFormatting = True\n    .RowGrand = True\n    .SaveData = True\n    .PrintTitles = False\n    .RepeatItemsOnEachPrintedPage = True\n    .TotalsAnnotation = False\n    .CompactRowIndent = 1\n    .InGridDropZones = False\n    .DisplayFieldCaptions = True\n    .DisplayMemberPropertyTooltips = False\n    .DisplayContextTooltips = True\n    .ShowDrillIndicators = True\n    .PrintDrillIndicators = False\n    .AllowMultipleFilters = False\n    .SortUsingCustomLists = True\n    .FieldListSortAscending = False\n    .ShowValuesRow = False\n    .CalculatedMembersInFilters = False\n    .RowAxisLayout xlCompactRow\nEnd With\n\nWith ws2.PivotTables(\"PivotTable1\").PivotCache\n    .RefreshOnFileOpen = False\n    .MissingItemsLimit = xlMissingItemsDefault\nEnd With\n\nWith ws2.PivotTables(\"PivotTable1\").PivotFields(\"Part Number\")\n    .Orientation = xlRowField\n    .Position = 1\nEnd With\n\nPTable1.AddDataField ws2.PivotTables _\n    (\"PivotTable1\").PivotFields(\"Qty OH\"), \"Sum of Qty OH\", xlSum\n\nPTable1.AddDataField ws2.PivotTables _\n    (\"PivotTable1\").PivotFields(\"Inventory Value\"), \"Sum of Inventory Value\", xlSum\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12521110, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD8XEOw8FIWrVpYAnwTW4DeYJncXv8VLixGrnFq=k-s128", "display_name": "Ematics", "link": "https://stackoverflow.com/users/12521110/ematics"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 59311865, "answer_count": 1, "score": 0, "last_activity_date": 1576180614, "creation_date": 1576102735, "last_edit_date": 1576131734, "question_id": 59294971, "link": "https://stackoverflow.com/questions/59294971/what-causes-this-vba-code-to-take-so-long-to-run", "title": "What causes this VBA Code to take so long to run?", "body": "<p>I am new using VBA and I've run into something that has been puzzling me: when I run a pivot on the following line of code it takes a really long time for it to finish when in reality it should not take that long. If anyone knows what the problem with it is or if you have some ways to make my code run more efficiently please let me know.</p>\n\n<pre><code>Sub Macro1()\n'\n' Macro1 Macro\n'\n' Keyboard Shortcut: Ctrl+q\n'\nDim ws1 As Worksheet\nDim wb1 As Workbook\nDim ws2 As Worksheet\nDim wb2 As Workbook\nDim ws3 As Worksheet\nDim ws4 As Worksheet\nDim ws5 As Worksheet\nDim ws6 As Worksheet\nDim ws7 As Worksheet\nDim ws8 As Worksheet\nDim ws9 As Worksheet\nDim ws10 As Worksheet\nDim LastRow As Long\nDim LastRow1 As Long\nDim LastCol1 As Long\nDim PTable1 As PivotTable\nDim PCache1 As PivotCache\nDim PRange1 As Range\n\nSet wb1 = ActiveWorkbook\nSet ws1 = Sheets(1)\nSet ws2 = Sheets.Add(After:=ActiveSheet)\nSet ws3 = Sheets.Add(After:=ActiveSheet)\nSet ws4 = Sheets.Add(After:=ActiveSheet)\nSet ws5 = Sheets.Add(After:=ActiveSheet)\nSet ws6 = Sheets.Add(After:=ActiveSheet)\nSet ws7 = Sheets.Add(After:=ActiveSheet)\nSet ws8 = Sheets.Add(After:=ActiveSheet)\nSet ws9 = Sheets.Add(After:=ActiveSheet)\nSet ws10 = Sheets.Add(After:=ActiveSheet)\n\nws2.Name = \"Total\"\nws3.Name = \"01\"\nws4.Name = \"IM\"\nws5.Name = \"AMA\"\nws6.Name = \"TD\"\nws7.Name = \"PUP\"\nws8.Name = \"POS\"\nws9.Name = \"STG\"\nws10.Name = \"07\"\n\nWith ActiveWindow\n    If .FreezePanes Then .FreezePanes = False\n    .SplitColumn = 0\n    .SplitRow = 1\n    .FreezePanes = True\nEnd With\n\nWith ws1\n\n    .Cells(1, 24) = \"Bin\"\n    .Cells(1, 25) = \"UN\"\n    .Range(\"A:Y\").AutoFilter _\n         Field:=13, _\n         Criteria1:=\"&gt;=1\"\n\nLastRow = .Cells(Rows.Count, 1).End(xlUp).Row\n\n    .Range(\"E1:M\" &amp; LastRow).Copy ws2.Range(\"A1\")\n\n    .Range(\"A:Y\").AutoFilter _\n        Field:=21, _\n        Criteria1:=\"=1\", _\n        Operator:=xlOr, Criteria2:=\"=01DIST\"\n\n    .Range(\"E1:M\" &amp; LastRow).Copy ws3.Range(\"A1\")\n\n    .Range(\"A:Y\").AutoFilter _\n        Field:=21, _\n        Criteria1:=Array(\"10\", \"20\", \"40\", \"80\")\n\n    .Range(\"E1:M\" &amp; LastRow).Copy ws4.Range(\"A1\")\n\n    .Range(\"A:Y\").AutoFilter _\n        Field:=21, _\n        Criteria1:=\"=AMA\"\n\n    .Range(\"E1:M\" &amp; LastRow).Copy ws5.Range(\"A1\")\n\n    .Range(\"A:Y\").AutoFilter _\n        Field:=21, _\n        Criteria1:=\"=TD\"\n\n    .Range(\"E1:M\" &amp; LastRow).Copy ws6.Range(\"A1\")\n\n    .Range(\"A:Y\").AutoFilter _\n        Field:=21, _\n        Criteria1:=\"=STG\"\n\n    .Range(\"E1:M\" &amp; LastRow).Copy ws9.Range(\"A1\")\n\n    .Range(\"A:Y\").AutoFilter _\n        Field:=21, _\n        Criteria1:=\"7\"\n\n    .Range(\"E1:M\" &amp; LastRow).Copy ws10.Range(\"A1\")\n\nEnd With\n\nLastRow1 = ws2.Cells(Rows.Count, 1).End(xlUp).Row\nLastCol1 = ws2.Cells(1, Columns.Count).End(xlToLeft).Column\n\nSet PRange1 = ws2.Range(\"A1\").CurrentRegion\n\nSet PCache1 = ActiveWorkbook.PivotCaches.Create(xlDatabase, PRange1)\n\nSet PTable1 = PCache1.CreatePivotTable(ws2.Cells(1, 10), \"PivotTable1\")\n\nWith PTable1.PivotFields(\"Part Number\")\n    .Orientation = xlRowField\n    .Position = 1\nEnd With\n\nWith PTable1.PivotFields(\"Inventory Value\")\n    .Orientation = xlColumnField\n    .Position = 1\nEnd With\n\nWith PTable1.PivotFields(\"Qty OH\")\n    .Orientation = xlColumnField\n    .Position = 2\nEnd With\n\nPTable1.AddDataField ws2.PivotTables _\n    (\"PivotTable1\").PivotFields(\"Qty OH\"), \"Sum of Qty OH\", xlSum\n\nPTable1.AddDataField ws2.PivotTables _\n    (\"PivotTable1\").PivotFields(\"Inventory Value\"), \"Sum of Inventory Value\", xlSum\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "types"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 8935154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f34ecf82be023a881f5d76bce9f434e?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8935154/chris"}, "edited": false, "score": 0, "creation_date": 1576190096, "post_id": 59297169, "comment_id": 104829162, "body": "Thanks, i&#39;ll see what I can do with this and come back to check mark."}], "tags": [], "owner": {"reputation": 158, "user_id": 12506685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bbdad43fa100913502ce67d1b6b0fd?s=128&d=identicon&r=PG&f=1", "display_name": "the VBE - it&#39;s right for me", "link": "https://stackoverflow.com/users/12506685/the-vbe-its-right-for-me"}, "is_accepted": false, "score": 0, "last_activity_date": 1576120219, "creation_date": 1576120219, "answer_id": 59297169, "question_id": 59294967, "link": "https://stackoverflow.com/questions/59294967/variant-array-to-range-set-range-data-type-to-match-accordingly/59297169#59297169", "title": "Variant array to Range, set range data type to match accordingly?", "body": "<p>The <code>VarType</code> function <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/vartype-function\" rel=\"nofollow noreferrer\">returns a value associated with a data type</a>. The <code>.NumberFormat</code> property of a range can be used to set the display format correspondingly. This takes a string so it can be a little tricky to enter correctly. The best way to determine this is to set the cell to the format you actually want and then switch to custom format (in the standard format cells right click menu). The text you see in the bar is what you want in the code.</p>\n"}], "owner": {"reputation": 35, "user_id": 8935154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f34ecf82be023a881f5d76bce9f434e?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8935154/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576120219, "creation_date": 1576102705, "question_id": 59294967, "link": "https://stackoverflow.com/questions/59294967/variant-array-to-range-set-range-data-type-to-match-accordingly", "title": "Variant array to Range, set range data type to match accordingly?", "body": "<p>When using a variant array in Excel, it will automatically set each value to the appropriate data type like string, doubles, dates, etc. </p>\n\n<p>When I move the entire array to a sheet, the sheets data types wont change with it. If the data is a Date, it will display serials if the range is set as a Text/General. If set to Date, any doubles will look like ####. </p>\n\n<p>I also have some formulas in my array, so setting the range to a Text will cause the formulas to not calculate.</p>\n\n<p>I'm wondering, when pasting the array, is there a way to also set each cells data type to match the data type stored the array? </p>\n\n<p>The output of the array is used to copy and paste into another application, so having the proper format show on the excel would reduce manual work to adjust them afterwards.  </p>\n\n<p>Thank you in advance. </p>\n"}, {"tags": ["excel", "vba", "browser"], "comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1576138279, "post_id": 59294268, "comment_id": 104803456, "body": "Maybe just security setting in<code>Internet-options</code>? I have no problems using IE11 and Win 10 (latest Updates) with Office-Vba (x86) and intercept events from IE (WithEvents). Show your Problems (image?) and config of Internet-Options."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1576158901, "post_id": 59294268, "comment_id": 104814477, "body": "Did I missunderstood you, by assuming<code>Internetexplorer</code>Object not working on Office x64? If pages are just poor rendered, you just didn&#39;t change the <a href=\"https://weblog.west-wind.com/posts/2011/may/21/web-browser-control-specifying-the-ie-version\" rel=\"nofollow noreferrer\">rendering mode</a>?"}], "owner": {"reputation": 1, "user_id": 11204621, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hKgZUIB_uao/AAAAAAAAAAI/AAAAAAAAAFM/_CYxm0YsK58/photo.jpg?sz=128", "display_name": "Kevin Hankins", "link": "https://stackoverflow.com/users/11204621/kevin-hankins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576135986, "creation_date": 1576099227, "last_edit_date": 1576135986, "question_id": 59294268, "link": "https://stackoverflow.com/questions/59294268/browser-for-office-vba-not365", "title": "Browser for Office VBA (not365)", "body": "<p>Enterprise Windows10-64bit desktop Excel 64-bit 2019 VBA uses only Internet Explorer for</p>\n\n<pre><code>Dim objie As New internetexplorer, HexColor$, celValue$\n...\nobjie.Document.Write HTML$\n</code></pre>\n\n<p>It is getting flaky finding a combination of Windows10 and IE11 that actually works (renders the browser).\nI understand Selenium may provide access from VBA to other modern browsers.</p>\n\n<ol>\n<li>Which Win10 and IE11 combinations work?</li>\n<li>Which version of Selenium or other open-source have been security-checked?</li>\n</ol>\n\n<p>Thank you.</p>\n"}, {"tags": ["vba", "ms-project"], "comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 1, "creation_date": 1576159763, "post_id": 59293998, "comment_id": 104815026, "body": "Can you compile code on Win7? If not most likely a reference is broken, because you referenced to a newer libary ( e.g. to<code>Mircosoft XML v6</code>, but Win7 provides only<code>Mircosoft XML v4 </code> and you can&#39;t use a newer ref with an older lib, only the other way around). Use late binding or develop on the oldest supported system."}, {"owner": {"reputation": 1029, "user_id": 2264225, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/cc2e89005debab3454c2c39a714b1a8a?s=128&d=identicon&r=PG", "display_name": "user", "link": "https://stackoverflow.com/users/2264225/user"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 1, "creation_date": 1576174540, "post_id": 59293998, "comment_id": 104823221, "body": "@ComputerVersteher - I looked into late binding. My dev machine is Windows 7. Using Project Professional 2016 everything compiles. One lead I&#39;ve uncovered is that Project Standard 2010+ doesn&#39;t have the &quot;Active&quot; field...Seems promising. I&#39;ll report back once we test."}], "answers": [{"tags": [], "owner": {"reputation": 1029, "user_id": 2264225, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/cc2e89005debab3454c2c39a714b1a8a?s=128&d=identicon&r=PG", "display_name": "user", "link": "https://stackoverflow.com/users/2264225/user"}, "is_accepted": true, "score": 1, "last_activity_date": 1576283190, "creation_date": 1576283190, "answer_id": 59331320, "question_id": 59293998, "link": "https://stackoverflow.com/questions/59293998/run-time-error-1004-the-field-active-does-not-exist/59331320#59331320", "title": "Run-Time error &#39;1004&#39;: The field &quot;Active&quot; Does Not Exist", "body": "<p>Looks like Project Standard does not have the \"Active\" field. Our solution involved checking for the edition of the software using Application.Edition, which can be <a href=\"https://docs.microsoft.com/en-us/office/vba/api/project.pjeditiontype\" rel=\"nofollow noreferrer\">one of two values</a>: <code>pjEditionProfessional</code> or <code>pjEditionStandard</code>.</p>\n\n<p>Here's how the code ended up looking:</p>\n\n<pre><code>Sub STAT_Leads_Preds()\n    FilterEdit Name:=\"STAT_Leads_Preds\", TaskFilter:=True, Create:=True, OverwriteExisting:=True, FieldName:=\"Predecessors\", Test:=\"contains\", Value:=\"-\", ShowInMenu:=False, ShowSummaryTasks:=False\n    FilterEdit Name:=\"STAT_Leads_Preds\", TaskFilter:=True, FieldName:=\"\", NewFieldName:=\"Actual Finish\", Test:=\"equals\", Value:=\"NA\", Operation:=\"And\", ShowSummaryTasks:=False\n    If Not pActive And Application.Edition = pjEditionProfessional Then\n        FilterEdit Name:=\"STAT_Leads_Preds\", TaskFilter:=True, FieldName:=\"\", NewFieldName:=\"Active\", Test:=\"equals\", Value:=\"Yes\", Operation:=\"And\", ShowSummaryTasks:=False\n    Else\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1029, "user_id": 2264225, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/cc2e89005debab3454c2c39a714b1a8a?s=128&d=identicon&r=PG", "display_name": "user", "link": "https://stackoverflow.com/users/2264225/user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 59331320, "answer_count": 1, "score": 0, "last_activity_date": 1593558087, "creation_date": 1576098029, "last_edit_date": 1593558087, "question_id": 59293998, "link": "https://stackoverflow.com/questions/59293998/run-time-error-1004-the-field-active-does-not-exist", "title": "Run-Time error &#39;1004&#39;: The field &quot;Active&quot; Does Not Exist", "body": "<p>I'm receiving this error on a user's PC. They are using Project 2013 on Windows 7. On our own test machines with Project 2013 on Windows 10 and Project 2016 on Windows 10), we are not seeing the same error.</p>\n\n<p>The error's getting thrown all over the place, but one example is <code>FilterEdit</code> found here here:</p>\n\n<pre><code>Sub STAT_Leads_Preds()\n    FilterEdit Name:=\"STAT_Leads_Preds\", TaskFilter:=True, Create:=True, OverwriteExisting:=True, FieldName:=\"Predecessors\", Test:=\"contains\", Value:=\"-\", ShowInMenu:=False, ShowSummaryTasks:=False\n    FilterEdit Name:=\"STAT_Leads_Preds\", TaskFilter:=True, FieldName:=\"\", NewFieldName:=\"Actual Finish\", Test:=\"equals\", Value:=\"NA\", Operation:=\"And\", ShowSummaryTasks:=False\n    If Not pActive Then\n        FilterEdit Name:=\"STAT_Leads_Preds\", TaskFilter:=True, FieldName:=\"\", NewFieldName:=\"Active\", Test:=\"equals\", Value:=\"Yes\", Operation:=\"And\", ShowSummaryTasks:=False\n    Else\n    End If\nEnd Sub\n</code></pre>\n\n<p>It's unclear why this message appears. <a href=\"https://support.office.com/en-us/article/active-task-field-81769c1e-6b4b-4014-bad4-21471fdaa99e\" rel=\"nofollow noreferrer\">\"Active\" is, in fact, a field.</a> And, like I said, we are not seeing this issue on test machines.</p>\n\n<p>For reference, here's what the error looks like:\n<a href=\"https://i.stack.imgur.com/zIsAu.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zIsAu.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "box"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1576097326, "post_id": 59293754, "comment_id": 104792304, "body": "I&#39;m not understanding your question - firstly, please include the row numbers and column letters in your screenshot if you want to point out a specific cell like G2 in your instance (I can&#39;t tell what cell G2 is referencing in your image). Also, could you mind elaborating a bit more on what your current code does? What is <code>Rectangle3</code>?"}, {"owner": {"reputation": 1, "user_id": 12520817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f303bd35fb131bcadfc7ba8850c3d9?s=128&d=identicon&r=PG&f=1", "display_name": "Noah", "link": "https://stackoverflow.com/users/12520817/noah"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1576097634, "post_id": 59293754, "comment_id": 104792437, "body": "Sorry I updated the pic: Rectangle3 was a shape I assigned to the Macro to where user clicks on the shape and the dropdown option appears and the user clicks which every values that apply and it takes that and inputs it into another cell and ads a &quot;,&quot; after each value selected"}, {"owner": {"reputation": 3035, "user_id": 1357061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbacb6daf199175a515c835c3350e6cf?s=128&d=identicon&r=PG", "display_name": "Ryan B.", "link": "https://stackoverflow.com/users/1357061/ryan-b"}, "edited": false, "score": 0, "creation_date": 1576100627, "post_id": 59293754, "comment_id": 104793667, "body": "It sounds as if you are hoping for behavior much like the out-of-the-box data validation in excel where selecting a cell provides a dropdown of appropriate values for the cell.  But you need your list to be multi-select, and then the cell&#39;s resulting value should be a comma-separated list?"}, {"owner": {"reputation": 1, "user_id": 12520817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f303bd35fb131bcadfc7ba8850c3d9?s=128&d=identicon&r=PG&f=1", "display_name": "Noah", "link": "https://stackoverflow.com/users/12520817/noah"}, "edited": false, "score": 0, "creation_date": 1576100816, "post_id": 59293754, "comment_id": 104793729, "body": "I actually selected the list box and did a right click and gave it the perimeters for the drop down list and selected the multi-select option. I have the list with the checkboxes, my issue is getting that to populate in a cell once a user has checked which ones they need and separating each selection by a comma."}], "owner": {"reputation": 1, "user_id": 12520817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f303bd35fb131bcadfc7ba8850c3d9?s=128&d=identicon&r=PG&f=1", "display_name": "Noah", "link": "https://stackoverflow.com/users/12520817/noah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576098399, "creation_date": 1576096861, "last_edit_date": 1576098399, "question_id": 59293754, "link": "https://stackoverflow.com/questions/59293754/excel-checkbox-dropdown-fill-option-in-vba", "title": "Excel checkbox dropdown fill option in VBA?", "body": "<p>I created my list and inserted that into list box and all seems well and the list box has all fields I need. Issue I'm having is my code...I've looked at it for hours and can't figure out what the issue is with my VBA code:</p>\n\n<p>Here's a screenshot of my excel sheet. Basically cells G1:G7 is where I need the user to be able to select a dropdown with a checkbox and have it fill in with each data separated by a comma. Like 12345,12546,12345 etc...</p>\n\n<p><img src=\"https://i.stack.imgur.com/AmKg4.png\" alt=\"Excel screenshot\"></p>\n\n<p>Here's my code: </p>\n\n<pre><code>Sub Rectangle3_Click()\n'Updated by Extendoffice 20191114\nDim xSelShp As Shape, xSelLst As Variant, I As Integer\nSet xSelShp = ActiveSheet.Shapes(Application.Caller)\nSet xLstBox = ActiveSheet.Drop_Down2\nIf xLstBox.Visible = False Then\n    xLstBox.Visible = True\n    xSelShp.TextFrame2.TextRange.Characters.Text = \"Please select below:\"\nElse\n    xLstBox.Visible = False\n    xSelShp.TextFrame2.TextRange.Characters.Text = \"Please select below:\"\n    For I = xLstBox.ListCount - 1 To 0 Step -1\n        If xLstBox.Selected(I) = True Then\n        xSelLst = xLstBox.List(I) &amp; \";\" &amp; xSelLst\n        End If\n    Next I\n    If xSelLst &lt;&gt; \"\" Then\n        Range(\"ListBoxOutput\") = Mid(xSelLst, 1, Len(xSelLst) - 1)\n    Else\n        Range(\"ListBoxOutput\") = \"\"\n    End If\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576095794, "post_id": 59293502, "comment_id": 104791689, "body": "If there&#39;s a formula in C, then you have to use the <code>Worksheet_Calculate</code> event. The Change event doesn&#39;t fire when cell formulas are recalculated."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1576096084, "post_id": 59293502, "comment_id": 104791824, "body": "If the physical change is made in column B change to <code>If Target.Column &lt;&gt; 2 Then Exit Sub</code>"}, {"owner": {"reputation": 316, "user_id": 12131488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVDpB.jpg?s=128&g=1", "display_name": "SmileyFtW", "link": "https://stackoverflow.com/users/12131488/smileyftw"}, "edited": false, "score": 1, "creation_date": 1576096662, "post_id": 59293502, "comment_id": 104792048, "body": "Why use VBA? Why not use a formula that puts &quot;not match&quot; in a helper column?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 12520685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0b9f46ffd0e3dc24fb8ce5200b6caa?s=128&d=identicon&r=PG&f=1", "display_name": "cudog", "link": "https://stackoverflow.com/users/12520685/cudog"}, "edited": false, "score": 0, "creation_date": 1576099896, "post_id": 59294116, "comment_id": 104793354, "body": "Thanks guys...changed target.column &lt;2&gt; then exit sub did it.  Thanks again for your help."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 0, "last_activity_date": 1576098575, "creation_date": 1576098575, "answer_id": 59294116, "question_id": 59293502, "link": "https://stackoverflow.com/questions/59293502/vba-compares-each-row-in-column-1-to-in-column-2-displays-a-msgbox-if-rows-don/59294116#59294116", "title": "VBA compares each row in column 1 to in column 2. Displays a msgbox if rows don&#39;t match", "body": "<blockquote>\n<pre><code>If Target.Column &lt;&gt; 3 Then Exit Sub\n</code></pre>\n</blockquote>\n\n<p>This is the instruction bailing the procedure out if the modified cell isn't in column 3 (C).</p>\n\n<blockquote>\n  <p><em>How can I make this work when data is entered in column B instead of in Column C?</em></p>\n</blockquote>\n\n<p>Change the <code>3</code> for a <code>2</code> <a href=\"https://stackoverflow.com/questions/59293502/vba-compares-each-row-in-column-1-to-in-column-2-displays-a-msgbox-if-rows-don#comment104791824_59293502\">as Scott mentioned</a>.</p>\n\n<pre><code>If Target.Column &lt;&gt; 2 Then Exit Sub\n</code></pre>\n\n<p>And now the procedure will bail out if the modified cell isn't in column 2 (B).</p>\n"}], "owner": {"reputation": 21, "user_id": 12520685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0b9f46ffd0e3dc24fb8ce5200b6caa?s=128&d=identicon&r=PG&f=1", "display_name": "cudog", "link": "https://stackoverflow.com/users/12520685/cudog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1576098575, "creation_date": 1576095751, "last_edit_date": 1576096075, "question_id": 59293502, "link": "https://stackoverflow.com/questions/59293502/vba-compares-each-row-in-column-1-to-in-column-2-displays-a-msgbox-if-rows-don", "title": "VBA compares each row in column 1 to in column 2. Displays a msgbox if rows don&#39;t match", "body": "<p>I am trying to compare cells from 2 columns (columns 1 and 3) and have a msgbox pop up if a1 is not equal to c1, a2 is not equal to c2..and so on. Column A has fixed data. Column C pulls data from column B as it is entered.  </p>\n\n<p>Below is my code. This code only works if I physically enter data to column C but does not work if column data is pulled from column B.  </p>\n\n<p>How can I make this work when data is entered in column B instead of in Column C?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target Is Nothing Then Exit Sub\n    If Target.Cells.Count &gt; 1 Then Exit Sub\n    If Target.Column &lt;&gt; 3 Then Exit Sub\n    If Cells(Target.Row, 3).Value &lt;&gt; Cells(Target.Row, 1).Value Then\n\n        MsgBox \"not match\"\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 2, "creation_date": 1576095706, "post_id": 59293475, "comment_id": 104791658, "body": "Can you please <a href=\"https://stackoverflow.com/posts/59293475/edit\">edit your question</a>  to include the code you have so far?"}, {"owner": {"reputation": 173, "user_id": 10154265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/009d1d405247320178d45bbc2fd0ac7e?s=128&d=identicon&r=PG&f=1", "display_name": "PGD15", "link": "https://stackoverflow.com/users/10154265/pgd15"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1576096957, "post_id": 59293475, "comment_id": 104792162, "body": "@cybernetic.nomad added the code i&#39;ve got so far (missed the sub and end sub both that is it."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1576097778, "post_id": 59293475, "comment_id": 104792505, "body": "1) <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">Avoid using select</a> in your code. 2) You can assign <code>&quot;Range(&quot;H5&quot;).value &amp; Chr(10) &amp; Range(&quot;H6&quot;).value</code> either to a variable or directly to the comment&#39;s <code>text</code>"}, {"owner": {"reputation": 173, "user_id": 10154265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/009d1d405247320178d45bbc2fd0ac7e?s=128&d=identicon&r=PG&f=1", "display_name": "PGD15", "link": "https://stackoverflow.com/users/10154265/pgd15"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1576098296, "post_id": 59293475, "comment_id": 104792705, "body": "I understand its best to specify, but i tried to record the Macro as i&#39;m not very good with VBA and don&#39;t need to use if often.   If i understand correctly you&#39;re saying I should write the line you&#39;ve provided me, select the cell K5 in my Monthly Totals tab, add a comment and paste the value? This should work? (away from my PC atm)."}], "answers": [{"tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": false, "score": 0, "last_activity_date": 1576098574, "creation_date": 1576098574, "answer_id": 59294115, "question_id": 59293475, "link": "https://stackoverflow.com/questions/59293475/adding-a-note-to-a-cell-in-excel-based-on-the-values-of-several-other-cells-vba/59294115#59294115", "title": "Adding a note to a cell in Excel based on the values of several other cells (VBA)", "body": "<p>No need to select anything:</p>\n\n<pre><code>Dim myComment as String\nmyComment = Sheets(\"Current Total breakdown\").Range(\"H5\").value &amp; Chr(10) &amp; Sheets(\"Current Total breakdown\").Range(\"H6\").Value\nSheets(\"Monthly Totals\").Range(\"K5\").AddComment.Text myComment\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 10154265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/009d1d405247320178d45bbc2fd0ac7e?s=128&d=identicon&r=PG&f=1", "display_name": "PGD15", "link": "https://stackoverflow.com/users/10154265/pgd15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576098574, "creation_date": 1576095636, "last_edit_date": 1576098049, "question_id": 59293475, "link": "https://stackoverflow.com/questions/59293475/adding-a-note-to-a-cell-in-excel-based-on-the-values-of-several-other-cells-vba", "title": "Adding a note to a cell in Excel based on the values of several other cells (VBA)", "body": "<p>I wish to use VBA to add a note to a cell. This note should be the cell values from a different tab. </p>\n\n<p>I have the tab - Current Total Breakdown. I wish to copy cells H5 and H6 in this tab into the note on cell K5 on the Monthly Totals tab. I would also like the cell value in H5 to be on one line and the value of H6 on another line. </p>\n\n<p>For example, if H5 and H6 in the Current Total breakdown tab are equal to \"Hi x 10\" and \"Hello x 20\" respectively: </p>\n\n<p>I would like K5 in Monthly Totals to have a comment saying:</p>\n\n<pre><code>Hi x 10\nHello x 20\n</code></pre>\n\n<p>as shown one below the other so i know they're from different cells. </p>\n\n<p>I have to repeat this too. \nI know how to write \nI'm not very good with VBA but I know how to write the select, copy and paste and even add a note to a cell but not in the format I wish like above.</p>\n\n<p>Not really sure at all how I would go about this so would greatly appreciate and help and if you could break the code down for me so I can edit it for my other ranges I need to apply it.</p>\n\n<p>Code i've got so far (tried to record the macro; not 100% sure what the last line is doing). </p>\n\n<pre><code>Sheets(\"Current Total breakdown\").Select\nRange(\"H5\").Select\nSelection.Copy\nSheets(\"Monthly Totals\").Select\nActiveCell.Offset(-19, 8).Range(\"A1\").Select\nApplication.CutCopyMode = False\nActiveCell.AddComment\nActiveCell.Comment.Visible = False\nActiveCell.Comment.Text Text:=Chr(10) &amp; \"\" &amp; Chr(10) &amp; \"\"\nActiveCell.Offset(16, -6).Range(\"A1\").Select \n</code></pre>\n"}, {"tags": ["excel", "vba", "gmail"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1576095264, "post_id": 59293171, "comment_id": 104791473, "body": "Try <code>Dim CDO_Message as Object &#47;&#47; Set CDO_Message = CreateObject(&quot;CDO.Message&quot;)</code> ? (Follow <a href=\"https://www.makeuseof.com/tag/send-emails-excel-vba/\" rel=\"nofollow noreferrer\">this page</a>)"}, {"owner": {"reputation": 176, "user_id": 7790684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0VUy0GkIrRI/AAAAAAAAAAI/AAAAAAAAAMg/o32NDkuuG60/photo.jpg?sz=128", "display_name": "Foxhunt", "link": "https://stackoverflow.com/users/7790684/foxhunt"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1576098457, "post_id": 59293171, "comment_id": 104792765, "body": "Same error with the ``` CreateObject(&quot;CDO.Message&quot;)```, and i am using quite the same config as writed on the page"}], "owner": {"reputation": 176, "user_id": 7790684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0VUy0GkIrRI/AAAAAAAAAAI/AAAAAAAAAMg/o32NDkuuG60/photo.jpg?sz=128", "display_name": "Foxhunt", "link": "https://stackoverflow.com/users/7790684/foxhunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576097604, "creation_date": 1576094309, "last_edit_date": 1576097604, "question_id": 59293171, "link": "https://stackoverflow.com/questions/59293171/send-a-email-via-excel", "title": "Send a email via Excel", "body": "<p>I have a project that i want to ditribute.\n<strong>I would like it to autosend me a mail on error.</strong> </p>\n\n<p>I tried here with CDO library, but i am not sure it is the best to use.</p>\n\n<p>I have :</p>\n\n<pre><code>Private Sub MyErrorHandler()\n    'Here i save the file to send it next\n    Dim path As String: path = Environ(\"AppData\") + \"\\Local\"\n    Application.DisplayAlerts = False\n    ActiveWorkbook.SaveAs path &amp; \"AI_ErroringFile.xls\"\n    Application.DisplayAlerts = True\n\n    'Here i create my email\n    Dim Cdo_Message As New CDO.Message\n\n    Set Cdo_Message.Configuration = GetSMTPGmailServerConfig()\n    With Cdo_Message\n        .To = \"myadress@yahoo.fr\"\n        .From = Environ(\"username\") + \"@ErrorHandler.com\"\n        .Subject = \"Test\"\n        .TextBody = \"Hello\"\n        .send\n    End With\n\n    Set Cdo_Message = Nothing\nEnd Sub\n</code></pre>\n\n<p>and my gmail config function :</p>\n\n<pre><code>Function GetSMTPGmailServerConfig() As Object\nDim Cdo_Config As New CDO.Configuration\nDim Cdo_Fields As Object\n\nSet Cdo_Fields = Cdo_Config.Fields\nWith Cdo_Fields\n    .item(cdoSendUsingMethod) = cdoSendUsingPort\n    .item(cdoSMTPServer) = \"smtp.gmail.com\"\n    .item(cdoSMTPServerPort) = 465\n    .item(cdoSendUserName) = \"AIErrorHandler@gmail.com\"\n    .item(cdoSendPassword) = \"mypassword\"\n    .item(cdoSMTPAuthenticate) = cdoBasic\n    .item(cdoSMTPUseSSL) = True\n    .Update\nEnd With\n</code></pre>\n\n<p>But on the <code>.send</code> instruction i have this error :\n <code>sendusing configuration value is invalid</code></p>\n\n<p>I have try the 3 possibles sendusing configurations without success.</p>\n\n<p><strong>I am looking for a way to fix this or to send an email with vba without using outlook</strong></p>\n"}, {"tags": ["vba", "variables", "module", "public"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1576095052, "post_id": 59292850, "comment_id": 104791386, "body": "You don&#39;t need any globals if you pass parameters to between your procedures."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1576095198, "post_id": 59292850, "comment_id": 104791442, "body": "Don&#39;t <code>.Activate</code> a workbook that you opened. Don&#39;t have a <code>With</code> block hold that reference either - you want to <code>Set book = Workbooks.Open(...)</code> so that you have a reference to the workbook that you can pass around and that other code can work with, instead of relying on the correct workbook/worksheet being active."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1576095316, "post_id": 59292850, "comment_id": 104791505, "body": "Also consider using an <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">indenter</a> if you&#39;re not sure how to achieve consistent indentation."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576095246, "post_id": 59293354, "comment_id": 104791465, "body": "Or better, drop the superfluous <code>Call</code> keyword and do <code>macro3 full_currun</code> and <code>macro4 full_currun</code>"}, {"owner": {"reputation": 158, "user_id": 12506685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bbdad43fa100913502ce67d1b6b0fd?s=128&d=identicon&r=PG&f=1", "display_name": "the VBE - it&#39;s right for me", "link": "https://stackoverflow.com/users/12506685/the-vbe-its-right-for-me"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576096788, "post_id": 59293354, "comment_id": 104792096, "body": "@MathieuGuindon Does using <code>Call</code> incur a performance/reliability hit? I know it is unnecessary but I think it can be a useful tool, particularly when someone is learning programming with VBA, because it makes the code read more like natural language. Easier and more intuitive to parse visually helps direct mental energy/focus toward gaining conceptual understanding."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576096896, "post_id": 59293354, "comment_id": 104792140, "body": "What makes the code read more like natural language, is using descriptive procedure names that start with a verb, instead of using obsolete keywords to invoke procedures with meaningless nouns like <code>Macro2</code> ;-)"}, {"owner": {"reputation": 43, "user_id": 8055708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7485d4dead26fb24fd69bf3646e1593?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/8055708/jeff"}, "edited": false, "score": 0, "creation_date": 1576097669, "post_id": 59293354, "comment_id": 104792450, "body": "changing it from call macro3 to call macro3(full_currun) doesn&#39;t work. It says wrong number of arguments or invalid property assignment."}, {"owner": {"reputation": 158, "user_id": 12506685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bbdad43fa100913502ce67d1b6b0fd?s=128&d=identicon&r=PG&f=1", "display_name": "the VBE - it&#39;s right for me", "link": "https://stackoverflow.com/users/12506685/the-vbe-its-right-for-me"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576097769, "post_id": 59293354, "comment_id": 104792501, "body": "@MathieuGuindon Of course. But that isn&#39;t necessarily easy to do, even (as I understand it) for people who are paid to write code. Also when the concept of invoking a procedure is not so well understood, having the explicit indication of what you are doing mechanically is helpful. Definitely not a habit to keep when you get competent but I feel there are more important things to focus on when you aren&#39;t there."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 43, "user_id": 8055708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7485d4dead26fb24fd69bf3646e1593?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/8055708/jeff"}, "edited": false, "score": 0, "creation_date": 1576097937, "post_id": 59293354, "comment_id": 104792568, "body": "@Jeff you need to declare the parameter in the signature of the <code>macro3</code> procedure, e.g. <code>Public Sub Macro3(ByVal arg1 As String)</code>"}, {"owner": {"reputation": 43, "user_id": 8055708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7485d4dead26fb24fd69bf3646e1593?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/8055708/jeff"}, "edited": false, "score": 0, "creation_date": 1576098741, "post_id": 59293354, "comment_id": 104792876, "body": "Macro3 or &quot;Transfer&quot; is as follows:      sub transfer()      dim x,x,x, as integer      dim x,x,x as long      dim x,x as workbook      dim x,x,x,x as worksheet      dim x as range      dim x,x,x as string"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 43, "user_id": 8055708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7485d4dead26fb24fd69bf3646e1593?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/8055708/jeff"}, "edited": false, "score": 0, "creation_date": 1576098964, "post_id": 59293354, "comment_id": 104792964, "body": "@Jeff if you want the procedure to take a parameter, it needs to declare a parameter. <code>Public Sub Transfer(ByVal parameterName As ParameterDataType)</code>"}, {"owner": {"reputation": 158, "user_id": 12506685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bbdad43fa100913502ce67d1b6b0fd?s=128&d=identicon&r=PG&f=1", "display_name": "the VBE - it&#39;s right for me", "link": "https://stackoverflow.com/users/12506685/the-vbe-its-right-for-me"}, "reply_to_user": {"reputation": 43, "user_id": 8055708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7485d4dead26fb24fd69bf3646e1593?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/8055708/jeff"}, "edited": false, "score": 0, "creation_date": 1576099462, "post_id": 59293354, "comment_id": 104793181, "body": "@Jeff yeah you see the parentheses there? that is where <code>ByVal currun As String</code> goes."}, {"owner": {"reputation": 43, "user_id": 8055708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7485d4dead26fb24fd69bf3646e1593?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/8055708/jeff"}, "edited": false, "score": 0, "creation_date": 1576101495, "post_id": 59293354, "comment_id": 104793940, "body": "Thanks guys for the help. Managed to get it to work."}], "tags": [], "owner": {"reputation": 158, "user_id": 12506685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bbdad43fa100913502ce67d1b6b0fd?s=128&d=identicon&r=PG&f=1", "display_name": "the VBE - it&#39;s right for me", "link": "https://stackoverflow.com/users/12506685/the-vbe-its-right-for-me"}, "is_accepted": true, "score": 3, "last_activity_date": 1576095096, "creation_date": 1576095096, "answer_id": 59293354, "question_id": 59292850, "link": "https://stackoverflow.com/questions/59292850/calling-a-global-public-variable-in-moduleb-whose-value-was-defined-in-modulea/59293354#59293354", "title": "Calling a global/public variable in moduleB whose value was defined in moduleA", "body": "<p>You see the part where it says <code>Sub master_macro</code>? What you are doing there is declaring a <em>procedure</em>, which is a basically a general term to describe \"a block of self-contained code that does something when it is run.\" Procedure declarations have three major components:</p>\n\n<ul>\n<li>type - this is what you are doing with <code>Sub</code>; you are saying it is a <em>subroutine</em>, which is distinct from a <em>function</em> <code>Function</code> in that it does not return a value</li>\n<li>name - this is the identifier you use to refer to the procedure elsewhere in your code. it is supposed to be descriptive since that enhances the readability. \"master_macro\" is not bad, but as a general rule you don't want to use underscores when naming procedures in VBA.</li>\n<li>parameters - this is where you define the set of variable values that can be passed to the procedure when it is run. each parameter is separated by a comma and declared using the syntax [pass type] + [variable name] + [variable type]. [pass type] is either ByRef or ByVal; the basic distinction is that ByRef sends a direct reference to the variable, while ByVal sends a copy of the value.</li>\n</ul>\n\n<p>The last part is what you are missing to solve this problem. Both <code>macro3</code> and <code>macro4</code> are declared (in module B) like <code>master_macro</code> is here. If they need to know what the currun value is then simply add <code>(ByVal currun As String)</code> to their declarations. When they are called from another procedure, as they are in master macro, they will expect to receive a string. Change the two lines in master macro from:</p>\n\n<pre><code>Call macro3\nCall macro4\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Call macro3(full_currun)\nCall macro4(full_currun)\n</code></pre>\n\n<p>and macro3 and macro4 will have the value of full_currun stored in their own internal variable currun for use as they need.</p>\n"}, {"comments": [{"owner": {"reputation": 158, "user_id": 12506685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bbdad43fa100913502ce67d1b6b0fd?s=128&d=identicon&r=PG&f=1", "display_name": "the VBE - it&#39;s right for me", "link": "https://stackoverflow.com/users/12506685/the-vbe-its-right-for-me"}, "edited": false, "score": 2, "creation_date": 1576102728, "post_id": 59294862, "comment_id": 104794343, "body": "glad it works. and props for incorporating mats suggestion to use meaningful procedure names without explicitly being told. :)"}, {"owner": {"reputation": 158, "user_id": 12506685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bbdad43fa100913502ce67d1b6b0fd?s=128&d=identicon&r=PG&f=1", "display_name": "the VBE - it&#39;s right for me", "link": "https://stackoverflow.com/users/12506685/the-vbe-its-right-for-me"}, "edited": false, "score": 0, "creation_date": 1576102900, "post_id": 59294862, "comment_id": 104794405, "body": "a couple suggestions. declare another workbook variable so you can assign that to the workbook opened in the loop instead of using activeworkbook. and you can combine the workbook close and save into one line with <code>.Close SaveChanges:=True</code>"}, {"owner": {"reputation": 43, "user_id": 8055708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7485d4dead26fb24fd69bf3646e1593?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/8055708/jeff"}, "reply_to_user": {"reputation": 158, "user_id": 12506685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bbdad43fa100913502ce67d1b6b0fd?s=128&d=identicon&r=PG&f=1", "display_name": "the VBE - it&#39;s right for me", "link": "https://stackoverflow.com/users/12506685/the-vbe-its-right-for-me"}, "edited": false, "score": 0, "creation_date": 1576167495, "post_id": 59294862, "comment_id": 104819867, "body": "I always name my modules/macros, but for the sake of simplicity, figured I would just call the macro 1/2/3/4 in here."}], "tags": [], "owner": {"reputation": 43, "user_id": 8055708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7485d4dead26fb24fd69bf3646e1593?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/8055708/jeff"}, "is_accepted": false, "score": 2, "last_activity_date": 1576102163, "creation_date": 1576102163, "answer_id": 59294862, "question_id": 59292850, "link": "https://stackoverflow.com/questions/59292850/calling-a-global-public-variable-in-moduleb-whose-value-was-defined-in-modulea/59294862#59294862", "title": "Calling a global/public variable in moduleB whose value was defined in moduleA", "body": "<p>Thanks guys. managed to get it to work. Here's the finished work below</p>\n\n<pre><code>sub master()\n\ndim i as integer\ndim path, currun, fullcurrun as string\ndim wb as workbook\ndim sht as worksheet\n\nset wb = workbooks(\"Name.xlsx\")\nset sht = wh.worksheets(1)\npath = \"C:\\xxx\\\"\nwb.activate\nfor i = 1 to ?\n    currun = sht.cells(i,1).value\n   fullcurrun = currun &amp; \".xlsx\"\n   workbooks.open(path &amp; fullcurrun)\n   call blank(currun)\n   call lookup(currun)\n   call transfer(currun)\n   activeworkbook.save\n   activeworkbook.close\n   call transfer(currun)\nnext i\nend sub\n\npublic sub blank/lookup/transfer(byval currun as string)\nblah blah blah\nend sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 8055708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7485d4dead26fb24fd69bf3646e1593?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/8055708/jeff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 59293354, "answer_count": 2, "score": 1, "last_activity_date": 1576102163, "creation_date": 1576092926, "last_edit_date": 1576098613, "question_id": 59292850, "link": "https://stackoverflow.com/questions/59292850/calling-a-global-public-variable-in-moduleb-whose-value-was-defined-in-modulea", "title": "Calling a global/public variable in moduleB whose value was defined in moduleA", "body": "<p>I wrote 4 macros to do things, but it requires 2 inputs from the user to make sure the right file is being used because some of the macros switch back and between 2 workbooks. I only had access to a few of the files, but I knew that eventually I would have access to the rest of the 35 files. If I didn't have the inputs, I would have to manually change the filename in the macro code, but I don't want to do that, so I used inputs. But now that I have all the files in the right format, I am trying to a separate macro that has a list of the other files in a separate workbook, and then opens those files and does the macros, but it would require the inputs a lot. So now, I'm trying to remove that need for the inputs. But I'm unfamiliar with public variables and somewhat familiar with the calling of other subroutines.</p>\n\n<p>My setup is this: </p>\n\n<pre><code>option explicit\npublic current as string\n\nSub master_macro\ndim i as integer\ndim path as string\ndim wb as workbook\ndim sht as worksheet\n\nset wb = workbooks(\"name.xlsx\")\nset sht = wb.worksheets(1)\npath = \"C:\\xxx\\\"\nwb.activate\nfor i = 1 to 20\n    currun = sht.cells(i,1).value 'this takes the value from the separate workbooks that has the file names\n    full_currun = currun &amp; \".xlsx\"\n    with workbooks.open(path &amp; full_currun)\n        .activate\n        call blanks\n        call lookup\n        call transfer\n        call combine\n        .save\n        .close\n    end with\nnext i\n</code></pre>\n\n<p>The last 2 macros switch between 2 sheets. So in those macros, the currun is generated the an inputbox, albeit a different name.</p>\n\n<pre><code>nam = inputbox(\"yadda yadda\")\nset wb = workbooks(nam &amp; \".xlsx\")\n</code></pre>\n\n<p>I'm trying to get the currun vaue that is defined in the master macro to macro3 and macro4. </p>\n"}, {"tags": ["vba", "ms-word", "sandbox", "autoit"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1576171648, "post_id": 59292533, "comment_id": 104821945, "body": "By &quot;borders of the page&quot; do you mean the margins? <code>Range.Sections(1).PageSetup</code> gets you the margin settings properties. Also page width and height."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1576307292, "post_id": 59292533, "comment_id": 104864646, "body": "In Word-speak, a border is a line you see. A margin is the distance between the edge of the paper and where the block of text is/could be."}], "owner": {"reputation": 161, "user_id": 2784831, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d7185139c911df0481bd379b60aeee4c?s=128&d=identicon&r=PG&f=1", "display_name": "tvishwa107", "link": "https://stackoverflow.com/users/2784831/tvishwa107"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576171559, "creation_date": 1576091522, "last_edit_date": 1576171559, "question_id": 59292533, "link": "https://stackoverflow.com/questions/59292533/how-to-click-on-activex-controls-in-word-using-autoit", "title": "How to Click on ActiveX controls in Word Using AutoIT?", "body": "<p>I am trying to automate the clicking of activeX controls in word using AutoIT. </p>\n\n<p><strong>Method 1</strong>: </p>\n\n<ol>\n<li>Get all InlineShapes on the page</li>\n<li>See if their type is ActiveX control ( type == 5)</li>\n<li>get their locations relative to the word page using a conversion to the Shape Type.</li>\n</ol>\n\n<p>The shape type gives you left/top location wrt the word page itself, and the inline shape type gives you width and height. </p>\n\n<p>In theory, at this point I have enough to find the vertices of the control on the page as:</p>\n\n<pre><code>    vertices: top left = (left, top)\n              top right =  (left + width, top)\n              bottom left = (left, top + height)\n              bottom right = (left + width, top + height) \n</code></pre>\n\n<ol start=\"4\">\n<li>Once you get the vertices, move the mouse to the center of the control by averaging its corners, and use MouseClick(xpos, ypos).</li>\n</ol>\n\n<p>However, this is still only relative to the page. </p>\n\n<p>I don't know how to find the borders of the page itself, so I'm not sure how to do this other than just traverse from the top(?).</p>\n\n<p><strong>Method 2</strong> I'm considering:         </p>\n\n<p>Is there some selection type that lets me select the activeX control from InlineShapes/Shapes and lets me click or run some action on the selected object? This would be much simpler than method 1 and I'd love to hopefully find something in this regard.</p>\n\n<p>What are the ways for me to complete this section? </p>\n"}, {"tags": ["excel", "vba", "max", "min"], "comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 1, "creation_date": 1576089941, "post_id": 59292139, "comment_id": 104789112, "body": "Can you edit in your attempt? SO is not a code writing service, you will receive better responses with the code in the question."}, {"owner": {"reputation": 1, "user_id": 12344119, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hzuM8baBZBU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdt4YabwmOzoV1hXcG50nL_66hRUA/photo.jpg?sz=128", "display_name": "Brandon Campbell", "link": "https://stackoverflow.com/users/12344119/brandon-campbell"}, "reply_to_user": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1576090140, "post_id": 59292139, "comment_id": 104789194, "body": "I don&#39;t have a code currently. Listing the numbers this way was the only way to get them on top of each other as an example of what the data looks like. I don&#39;t know how to create the code I need."}, {"owner": {"reputation": 158, "user_id": 12506685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bbdad43fa100913502ce67d1b6b0fd?s=128&d=identicon&r=PG&f=1", "display_name": "the VBE - it&#39;s right for me", "link": "https://stackoverflow.com/users/12506685/the-vbe-its-right-for-me"}, "edited": false, "score": 0, "creation_date": 1576092511, "post_id": 59292139, "comment_id": 104790201, "body": "@BrandonCampbell assuming your data always starts at the top like you showed <code>.UsedRange.Rows.Count</code> for the sheet will get you the last row with data in it. Then just loop through the column from row 2 to that row and every time you run into a blank you&#39;ll have the range you can use the formula on. Remember to track the starting row of the range in a separate variable from the loop counter."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1576092972, "post_id": 59292139, "comment_id": 104790389, "body": "or put this formula in B1, Hit Ctrl-Shift-Enter instead of Enter to exit edit mode and copy down: <code>=IF(A2=&quot;&quot;,MIN(INDEX(A:A,IFERROR(MATCH(2,INDEX(1&#47;(A$1:A1=&quot;&quot;),&zwnj;&#8203;))+1,1)):A1),&quot;&quot;)</code>  Change the <code>MIN</code> to <code>MAX</code> and put the in C1, CSE, copy down."}, {"owner": {"reputation": 1, "user_id": 12344119, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hzuM8baBZBU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdt4YabwmOzoV1hXcG50nL_66hRUA/photo.jpg?sz=128", "display_name": "Brandon Campbell", "link": "https://stackoverflow.com/users/12344119/brandon-campbell"}, "edited": false, "score": 0, "creation_date": 1576097869, "post_id": 59292139, "comment_id": 104792548, "body": "This is very helpful. thank you all!"}], "owner": {"reputation": 1, "user_id": 12344119, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hzuM8baBZBU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdt4YabwmOzoV1hXcG50nL_66hRUA/photo.jpg?sz=128", "display_name": "Brandon Campbell", "link": "https://stackoverflow.com/users/12344119/brandon-campbell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576097713, "creation_date": 1576089793, "last_edit_date": 1576097713, "question_id": 59292139, "link": "https://stackoverflow.com/questions/59292139/min-max-of-a-range-vba", "title": "Min/Max of a range VBA", "body": "<p>I have a set of data that has blanks in between Them.</p>\n\n<pre><code>A1\n1\n2  \n\n3 \n\n4\n5\n6\n</code></pre>\n\n<p>I want to find the Min and max of each set of Numbers Between blanks. I know the formula but I don't know how to apply it to the row count of each range.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1576088040, "post_id": 59291745, "comment_id": 104788272, "body": "See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to Avoid Using Select</a> first."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1576088107, "post_id": 59291745, "comment_id": 104788303, "body": "As far as your main issue, <code>Dim wb as Workbook</code>, then <code>Set wb = Workbooks.Open(Range(&quot;M1&quot;).Value &amp; &quot;.xlsx&quot;)</code>. Now you have a reference to the opened workbook and you don&#39;t have to refer to it by name."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576089279, "post_id": 59291745, "comment_id": 104788847, "body": "Rule #1: never use macro recorder code as-is. You hardly ever <b>need</b> to <code>Select</code> or <code>Activate</code> anything to do 99.99999% of everything you could ever want to do in VBA."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12520139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58a902cd60579177aeb552099a9101bb?s=128&d=identicon&r=PG&f=1", "display_name": "Jun", "link": "https://stackoverflow.com/users/12520139/jun"}, "edited": false, "score": 0, "creation_date": 1576179514, "post_id": 59292334, "comment_id": 104825246, "body": "wow thank you so much Mathieu! It is working now and i have learned a lot from this! for the rage like Range(&quot;A3:AJ10000&quot;) I put 10000 coz the output data i am copying varies daily, how can set a range whereby it will just copy all the data in that range"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1576090710, "creation_date": 1576090710, "answer_id": 59292334, "question_id": 59291745, "link": "https://stackoverflow.com/questions/59291745/how-to-activate-a-workbook-that-has-dates-in-file-name-and-change-weekly/59292334#59292334", "title": "How to activate a workbook that has dates in file name and change weekly?", "body": "<blockquote>\n<pre><code>Workbooks.Open Range(\"M1\").Value &amp; \".xlsx\"\n</code></pre>\n</blockquote>\n\n<p><code>Workbooks.Open</code> is a <em>function</em> - it <em>returns a value</em> - in this case, a reference to the <code>Workbook</code> object that was opened, if the function return successfully without raising any errors.</p>\n\n<p>You are discarding that object reference. Use it!</p>\n\n<pre><code>Dim book As Workbook\nSet book = Workbooks.Open(ActiveSheet.Range(\"M1\").Value &amp; \".xlsx\")\n</code></pre>\n\n<p>This instruction assumes opening the workbook made it the <code>ActiveWorkbook</code>:</p>\n\n<blockquote>\n<pre><code>Sheets(\"BBG COMDTY - Cur Data\").Select\n</code></pre>\n</blockquote>\n\n<p>Don't work off side-effects and assumptions.</p>\n\n<pre><code>Dim currentCOMDTYSheet As Worksheet\nSet currentCOMDTYSheet = book.Worksheets(\"BBG COMDTY - Cur Data\")\n</code></pre>\n\n<p>You don't need to <code>Select</code> a <code>Range</code> to <code>Copy</code> it. You only need to <code>Select</code> a <code>Range</code> when you want to work off the <code>Selection</code>, <em>and you almost never want to do that</em>.</p>\n\n<blockquote>\n<pre><code>Range(\"A3:AF10000\").Select\nSelection.Copy\n</code></pre>\n</blockquote>\n\n<p>Instead, just work off the <code>Worksheet</code> object you've got:</p>\n\n<pre><code>currentCOMDTYSheet.Range(\"A3:AF10000\").Copy\n</code></pre>\n\n<p>But let's hold off a second, and see where that's being copied to first:</p>\n\n<blockquote>\n<pre><code>Windows(\"EDM Summary Macro 1.1.xlsm\").Activate\nSheets(\"BBG COMDTY - Prev Data\").Select\nRange(\"A3\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n</code></pre>\n</blockquote>\n\n<p>(side note: line continuations <code>_</code> should generally be avoided, but when you do use them, avoid splitting a named argument in the middle - <code>SkipBlanks:=False</code> should be on a single line)</p>\n\n<p>I'm assuming the \"EDM Summary Macro 1.1.xlsm\" workbook is the workbook that's hosting your VBA project. If that's the case, then you don't need to dereference its <code>Window</code> off the <code>Windows</code> collection, nor to dereference it off some <code>Workbooks</code> collection (which would be a much more straightforward way to activate that workbook than getting its <code>Window</code>). The workbook that's hosting your VBA project is always in scope, and it's always called <code>ThisWorkbook</code> (unless you renamed it, but don't do that).</p>\n\n<p>And since all worksheets in <code>ThisWorkbook</code> that exist at compile-time each have a <em>code name</em>, you don't need to dereference the worksheet <em>at all</em> - it's right there, readily usable. Maybe it's called <code>Sheet3</code> or <code>Sheet21</code> though: find the \"BBG COMDTY - Prev Data\" sheet in the VBE's <em>Project Explorer</em>, then set its <code>(Name)</code> property to a valid VBA identifier, e.g. <code>PrevCOMDTYDataSheet</code>. And now we can paste directly there:</p>\n\n<pre><code>currentCMDTYSheet.Range(\"A3:AF10000\").Copy PrevCOMDTYDataSheet.Range(\"A3\")\n</code></pre>\n\n<p>But that would bring in formats and borders and validations and formulas, and we only want the values. In that case, we don't need to even get the clipboard involved:</p>\n\n<pre><code>PrevCOMDTYDataSheet.Range(\"A3:AF10000\").Value = currentDataSheet.Range(\"A3:AF10000\").Value\n</code></pre>\n\n<p>And done!</p>\n\n<p>Similar here:</p>\n\n<blockquote>\n<pre><code>Windows(\"EDM_Matcher_Inbox_20191202.xlsx\").Activate\nSheets(\"BBG PK BBGID - Cur Data\").Select\nRange(\"A3:AJ10000\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"EDM Summary Macro 1.1.xlsm\").Activate\nActiveWindow.ScrollWorkbookTabs Sheets:=1\nActiveWindow.ScrollWorkbookTabs Sheets:=1\nSheets(\"BBG PK BBGID - Prev Data\").Select\nRange(\"A3\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n</code></pre>\n</blockquote>\n\n<p>You already have the <code>book</code> reference, so no need to activate the window again; the BBGID data sheet needs an object reference:</p>\n\n<pre><code>Dim currentBBGIDSheet As Worksheet\ncurrentBBGIDSheet = book.Worksheets(\"BBG PK BBGID - Cur Data\")\n</code></pre>\n\n<p>And then similar as above:</p>\n\n<pre><code>PrevBBGIDSheet.Range(\"A3:AJ10000\").Value = currentBBGIDSheet.Range(\"A3:AJ10000\").Value\n</code></pre>\n\n<p>Same with the last block:</p>\n\n<blockquote>\n<pre><code>ActiveWorkbook.Activate\nWindows(\"EDM_Matcher_Inbox_20191202.xlsx\").Activate\nSheets(\"BBG BO - Cur Data\").Select\nRange(\"A3:AH10000\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"EDM Summary Macro 1.1.xlsm\").Activate\nActiveWindow.ScrollWorkbookTabs Sheets:=2\nSheets(\"BBG BO - Prev Data\").Select\n</code></pre>\n</blockquote>\n\n<pre><code>Dim currentBBGBOSheet As Worksheet\nSet currentBBGBOSheet = book.Worksheets(\"BBG BO - Cur Data\")\n\nPrevBBGBOSheet.Range(\"A3:AH10000\").Value = currentBBGBOSheet.Range(\"A3:AH10000\").Value\n</code></pre>\n\n<p>So, recap: first step is to <strong>name your sheets</strong> in <code>ThisWorkbook</code>. You want <code>PrevCOMDTYSheet</code>, <code>PrevBBGIDSheet</code>, and <code>PrevBBGBOSheet</code> worksheets named in the VBA project, and then this can be a first-pass cleanup:</p>\n\n<pre><code>Public Sub OpenPrev()\n\n    Dim book As Workbook\n    Set book = Workbooks.Open(ActiveSheet.Range(\"M1\").Value &amp; \".xlsx\")\n\n    Dim currentCOMDTYSheet As Worksheet\n    Set currentCOMDTYSheet = book.Worksheets(\"BBG COMDTY - Cur Data\")\n    PrevCOMDTYSheet.Range(\"A3:AF10000\").Value = currentCOMDTYSheet.Range(\"A3:AF10000\").Value\n\n    Dim currentBBGIDSheet As Worksheet\n    currentBBGIDSheet = book.Worksheets(\"BBG PK BBGID - Cur Data\")\n    PrevBBGIDSheet.Range(\"A3:AJ10000\").Value = currentBBGIDSheet.Range(\"A3:AJ10000\").Value\n\n    Dim currentBBGBOSheet As Worksheet\n    Set currentBBGBOSheet = book.Worksheets(\"BBG BO - Cur Data\")\n\n    PrevBBGBOSheet.Range(\"A3:AH10000\").Value = currentBBGBOSheet.Range(\"A3:AH10000\").Value\n\nEnd Sub\n</code></pre>\n\n<p>Second-pass, I'd remove the hard-coded 10000 row numbers, and actually work out what <em>actual size</em> <code>Range</code> needs to be copied over.</p>\n"}], "owner": {"reputation": 1, "user_id": 12520139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58a902cd60579177aeb552099a9101bb?s=128&d=identicon&r=PG&f=1", "display_name": "Jun", "link": "https://stackoverflow.com/users/12520139/jun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576090710, "creation_date": 1576087894, "last_edit_date": 1576088023, "question_id": 59291745, "link": "https://stackoverflow.com/questions/59291745/how-to-activate-a-workbook-that-has-dates-in-file-name-and-change-weekly", "title": "How to activate a workbook that has dates in file name and change weekly?", "body": "<p>I need your help.\nI have this main macro that opens a previous day file by using a cell reference (location of the file and file name). The opened file is used to copy the data from its worksheets (4 worksheets)to the main macro. I recorded the macro and the date was hard coded. When i will run the macro for next week, it will give me an error since the previous file name was hardcoded. I tried using activeworkbook but it wont work since i go back and fort between the main file and preivous file when copy pasting.</p>\n\n<p>sample query below</p>\n\n<pre><code>Sub OpenPrev()\n'\n' OpenPrev Macro\n'\n\n'\n    ChDir \"\\\\hfx1nas02\\hfx1_data02_sh$\\Share2\\HFX MDBG\\Marlon\\MarkitEDM\\EDM_WORK\"\n    Workbooks.Open Range(\"M1\").Value &amp; \".xlsx\"\n    Sheets(\"BBG COMDTY - Cur Data\").Select\n    Range(\"A3:AF10000\").Select\n    Selection.Copy\n    Windows(\"EDM Summary Macro 1.1.xlsm\").Activate\n    Sheets(\"BBG COMDTY - Prev Data\").Select\n    Range(\"A3\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n    Windows(\"EDM_Matcher_Inbox_20191202.xlsx\").Activate\n    Sheets(\"BBG PK BBGID - Cur Data\").Select\n    Range(\"A3:AJ10000\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Windows(\"EDM Summary Macro 1.1.xlsm\").Activate\n    ActiveWindow.ScrollWorkbookTabs Sheets:=1\n    ActiveWindow.ScrollWorkbookTabs Sheets:=1\n    Sheets(\"BBG PK BBGID - Prev Data\").Select\n    Range(\"A3\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n    ActiveWorkbook.Activate\n    Windows(\"EDM_Matcher_Inbox_20191202.xlsx\").Activate\n    Sheets(\"BBG BO - Cur Data\").Select\n    Range(\"A3:AH10000\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Windows(\"EDM Summary Macro 1.1.xlsm\").Activate\n    ActiveWindow.ScrollWorkbookTabs Sheets:=2\n    Sheets(\"BBG BO - Prev Data\").Select\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1576088549, "post_id": 59291658, "comment_id": 104788497, "body": "It&#39;s not clear to me what your actual question is: To create a sheet? To copy data from one sheet to another? To loop over all rows of a sheet? There are more than enough answers on SO and elsewhere to all of these."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1576088836, "post_id": 59291658, "comment_id": 104788638, "body": "Some remarks to your code: <b>(1)</b> use meaningfull names <b>(2)</b> Indent your code <b>(3)</b> <code>Option explicit</code> needs to be at the top of the code <b>(4)</b> use <code>Long</code>, not <code>Integer</code>, else you risk numeric overflow <b>(5)</b> <code>.Range</code> (with leading dot) will only work if you have a <code>with</code>-clause <b>(6)</b> Do not use <code>Else: ...</code> - remove the <code>&quot;:&quot;</code> and put the statement on the next line."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1576095448, "post_id": 59291658, "comment_id": 104791559, "body": "If your code is failing to run, is it because of the missing quote on <code>Sheets.Add.Name = Range(a2:a&quot;</code> which should be <code>Sheets.Add.Name = Range(&quot;a2:a&quot;</code>? Note how the text is white, turns pink for the literal string, then never returns to white (or blue) for the rest of the code. I hope that&#39;s just a copy/pasteo error when putting the code up here for review."}, {"owner": {"reputation": 1, "user_id": 12394160, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fxLarZAwGac/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rezYXoHvYFDnK9VwWFulYBs5uiQKQ/photo.jpg?sz=128", "display_name": "awibbin", "link": "https://stackoverflow.com/users/12394160/awibbin"}, "edited": false, "score": 0, "creation_date": 1576526379, "post_id": 59291658, "comment_id": 104920761, "body": "Thank you for your help."}, {"owner": {"reputation": 1, "user_id": 12394160, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fxLarZAwGac/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rezYXoHvYFDnK9VwWFulYBs5uiQKQ/photo.jpg?sz=128", "display_name": "awibbin", "link": "https://stackoverflow.com/users/12394160/awibbin"}, "edited": false, "score": 0, "creation_date": 1576526516, "post_id": 59291658, "comment_id": 104920813, "body": "To clarify: I need the macro to create a new sheet every time a new work order number is found in column A. I need the sheet to be named the work order number. Then it needs to copy all rows with that work order number into the newly created sheet. Yes it needs to loop this through all rows in the main sheet"}, {"owner": {"reputation": 1, "user_id": 12394160, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fxLarZAwGac/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rezYXoHvYFDnK9VwWFulYBs5uiQKQ/photo.jpg?sz=128", "display_name": "awibbin", "link": "https://stackoverflow.com/users/12394160/awibbin"}, "edited": false, "score": 0, "creation_date": 1576526679, "post_id": 59291658, "comment_id": 104920882, "body": "And yes I have looked on SO/ MrExcel/ Microsoft forums."}], "owner": {"reputation": 1, "user_id": 12394160, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fxLarZAwGac/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rezYXoHvYFDnK9VwWFulYBs5uiQKQ/photo.jpg?sz=128", "display_name": "awibbin", "link": "https://stackoverflow.com/users/12394160/awibbin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576088980, "creation_date": 1576087507, "last_edit_date": 1576088980, "question_id": 59291658, "link": "https://stackoverflow.com/questions/59291658/how-do-i-make-this-macro-create-a-new-sheet-after-comparing-values-to-a-set-vari", "title": "How do I make this macro create a new sheet after comparing values to a set variable?", "body": "<p>I am writing a macro that splits out data to another sheet after\ncomparing values in column A to a set variable.</p>\n\n<p>Column A has all Work Order numbers. I need the macro to create\na new sheet for each new work order, and copy all lines to that sheet.\nIt needs to name the sheet with a concatenation of the value\nfound in column A and Column B, and then copy all rows associated with\nthat Work Order to the new sheet.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Vwn08.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Vwn08.png\" alt=\"enter image description here\"></a></p>\n\n<p>The prefix is the Work Order. Prefix 12581 should get its own sheet, named\n12581-4, and prefix 12695 should get its own sheet named 12695-4.\nAll rows for 12581 should be copied into the sheet named 12581.</p>\n\n<p>This needs to be a loop since there are 39000 rows to sift through.</p>\n\n<p>I thought I'd need to declare a variable for the Work Order/prefix\nand have the macro compare it to the values in column A. If the value in column\nA does not match the variable it would create a new sheet and copy over all columns\nassociated with that Work Order.</p>\n\n<p>My code so far:</p>\n\n<pre><code>Sub SortDataByWOxyz()\n\nOption Explicit\n\nDim Variable_One as Integer\nDim Variable_Two As Integer\nDim cell As Range\nDim Sht_name As String\nDim intLastRow As Integer\nDim intSuffix As Integer\n\nSet Variable_One = 0\nSet intSuffix = .Range(\"b2\", .Range(\"b2\").End(xlDown))\n\nintLastRow = ActiveSheet.UsedRange.RowsCount\nSet cell = Range (\"a2:a\" &amp; intLastRow) 'this is so the macro\ndoesn't keep trying to process rows without values\n\n\n\nFor Each cell In Sheets(1).Range(\"A2:F39986\") 'Ok, another issue\nis that I can't be certain the range of every report I am applying\nthis macro to. Is there some way to make the range globally applicable, like:\nDim SourceRange As Range\nSet SourceRange= .Range(\"a2\", .Range(\"A2\").End(xlDown).End(xlToRight))\n\n\nIf cell.Value &lt;&gt; Variable_One Then\n\n'Grab prefix - suffix\n'Create sheet with sheet name\n'Copy data\n\nSheets.Add.Name = Range(a2:a\" &amp; intSuffix).value\ncell.EntireRow.CopyDestination:=Sheets(Sht_name).Range(\"a\" &amp; cell.Row)\n\nElse: cell.EntireRow.Copy Destination:=Sheets(Sht_name).Range(\"a\" &amp; cell.Row)\nEnd If\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook", "range", "paste"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12519920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41e4a6aa4071643ee7fc881cce8b07cc?s=128&d=identicon&r=PG&f=1", "display_name": "Lindsay_K", "link": "https://stackoverflow.com/users/12519920/lindsay-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1576187874, "creation_date": 1576187874, "answer_id": 59313280, "question_id": 59291419, "link": "https://stackoverflow.com/questions/59291419/paste-a-varying-range-in-outlook-email/59313280#59313280", "title": "Paste a varying range in Outlook email", "body": "<p>For my varying code I did this:</p>\n\n<pre><code>Dim lRowNew As Integer\nlRowNew = Range(\"N:N\").Find(What:=\"*\", Lookin:=xlValues, Lookat:=xlPart, SearchOrder:=xlRows, SearchDirection:=xlPrevious, MatchCase:=False, SearchFormat:=False).Row\nSet rng1 = Nothing\n On Error Resume Next\n Set rng1 = Sheets(\"Sheet2\").Range((\"H6:N\" &amp; lRowNew)).SpecialCells(xlCellTypeVisible)\n On Error GoTo 0\n</code></pre>\n\n<p>And it works!</p>\n\n<p>I was also able to setup another lRow (<code>lRowOld</code>) to capture another last row and assign it to <code>rng2</code> and was able to use those two and paste two different ranges into an email. </p>\n"}], "owner": {"reputation": 1, "user_id": 12519920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41e4a6aa4071643ee7fc881cce8b07cc?s=128&d=identicon&r=PG&f=1", "display_name": "Lindsay_K", "link": "https://stackoverflow.com/users/12519920/lindsay-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1580269572, "creation_date": 1576086534, "last_edit_date": 1580269572, "question_id": 59291419, "link": "https://stackoverflow.com/questions/59291419/paste-a-varying-range-in-outlook-email", "title": "Paste a varying range in Outlook email", "body": "<p>I used the \"paste excel range to outlook/email\" code on Ron de Bruin's site. I am having trouble using a variable range within the function.</p>\n\n<p>I set up two ranges (<code>rng1</code> and <code>rng2</code>) and two corresponding functions. My error is in this line (45) which extracts the variable range:</p>\n\n<pre><code>Set rng1 = Sheets(\"Sheet2\").Range(Cells(6, 8), Cells((NewRowFxn(NewRow) - 1), \"N\")).SpecialCells(xlCellTypeVisible)\n</code></pre>\n\n<p>I started with the first range (<code>rng1</code>) and it fails, thus have yet to set up the code for <code>rng2</code>.</p>\n\n<p><strong>How do I set up the varying range to find the last row of data and then input it into the <code>rng1</code> &amp; <code>rgn2</code> equations?</strong></p>\n\n<pre><code>Sub Macro1()\n Dim rng1 As Range\n Dim rng2 As Range\n Dim OutApp As Object\n Dim OutMail As Object\n Dim sCC As String, sSubj As String, sEmAdd As String\n Dim mail_bodyA As String\n Dim mail_bodyB As String\n Dim mail_bodyC As String\n Dim f_name As String\n Dim fiscalq As String\n\n '// Change the values of these variables to suit\n sEmAdd = Sheet2.Range(\"E7\")\n sCC = \"\"\n sSubj = Sheet2.Range(\"C2\")\n mail_bodyA = Sheet1.Range(\"K2\")\n mail_bodyB = Sheet1.Range(\"K4\")\n mail_bodyC = Sheet1.Range(\"K6\")\n f_name = Sheet2.Range(\"G7\")\n fiscalq = Sheet2.Range(\"D7\")\n  Set rng1 = Nothing\n On Error Resume Next\n Set rng1 = Sheets(\"Sheet2\").Range(Cells(6, 8), Cells((NewRowFxn(NewRow) - 1), \"N\")).SpecialCells(xlCellTypeVisible)\n 'Set rng1 = Sheets(\"Sheet2\").Range(\"H6:N7\").SpecialCells(xlCellTypeVisible)\n On Error GoTo 0\n With Application\n .EnableEvents = 0\n .ScreenUpdating = 0\n .Calculation = xlCalculationManual\n End With\n Set OutApp = CreateObject(\"Outlook.Application\")\n Set OutMail = OutApp.CreateItem(0)\n On Error Resume Next\n With OutMail\n .To = sEmAdd\n .CC = sCC\n .Subject = sSubj\n .HTMLBody = mail_bodyA &amp; RangetoHTML(rng1)\n .Display '// Change this to .Display if you want to view the email before sending. .Send originally\n End With\n On Error GoTo 0\n With Application\n .EnableEvents = 1\n .Calculation = xlCalculationAutomatic\n End With\n Set OutMail = Nothing: Set OutApp = Nothing\nEnd Sub\n\n\nFunction RangetoHTML(rng1 As Range)\n Dim fso As Object, ts As Object, TempWB As Workbook, TempFile As String\n TempFile = Environ$(\"temp\") &amp; \"\\\" &amp; Format(Now, \"dd-mm-yy h-mm-ss\") &amp; \".htm\"\n rng1.Copy\n Set TempWB = Workbooks.Add(1)\n With TempWB.Sheets(1)\n .Cells(1).PasteSpecial Paste:=8\n .Cells(1).PasteSpecial xlPasteValues, , False, False\n .Cells(1).PasteSpecial xlPasteColumnWidths, , False, False\n .Cells(1).PasteSpecial xlPasteFormats, , False, False\n .Cells(1).Select\n Application.CutCopyMode = False\n End With\n With TempWB.PublishObjects.Add( _\n SourceType:=xlSourceRange, _\n Filename:=TempFile, _\n Sheet:=TempWB.Sheets(1).Name, _\n Source:=TempWB.Sheets(1).UsedRange.Address, _\n HtmlType:=xlHtmlStatic)\n .Publish (True)\n End With\n Set fso = CreateObject(\"Scripting.FileSystemObject\")\n Set ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)\n RangetoHTML = ts.readall\n ts.Close\n RangetoHTML = Replace(RangetoHTML, \"align=center x:publishsource=\", _\n \"align=left x:publishsource=\")\n TempWB.Close 0\n Kill TempFile\n Set ts = Nothing: Set fso = Nothing: Set TempWB = Nothing\nEnd Function\n\n\nFunction NewRowFxn()\n Dim NewRow As Integer\n NewRow = 6\n Do\n    DoEvents\n    NewRow = NewRow + 1\n    Item = Sheet2.Range(\"N\" &amp; NewRow)\n Loop Until Item = \"\"\n End Function\n\n\n Function OldRowFxn()\n Dim OldRow As Integer\n OldRow = 6\n    Do\n    DoEvents\n    OldRow = OldRow + 1\n    Itemold = Sheet2.Range(\"V\" &amp; OldRow)\n    Loop Until Itemold = \"\"\n End Function\n</code></pre>\n"}, {"tags": ["json", "excel", "vba", "jsonconverter"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1576087072, "post_id": 59290845, "comment_id": 104787854, "body": "This <code>JSON</code> object is a <code>Dictionary</code>.  So the default return value will be a <code>Key</code>, not a contained dictionary object."}], "answers": [{"comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1576085235, "post_id": 59291070, "comment_id": 104786956, "body": "I don&#39;t think that&#39;s quite right... How are you selecting the items? There must be 10, 100 or even 100000 items with min price and max price... You need to loop through them to get them all."}, {"owner": {"reputation": 7231, "user_id": 4915798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb8af3ae95300addb5dfa2e6cb5940c3?s=128&d=identicon&r=PG&f=1", "display_name": "afonso", "link": "https://stackoverflow.com/users/4915798/afonso"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 2, "creation_date": 1576085537, "post_id": 59291070, "comment_id": 104787116, "body": "No you don&#39;t. The API response from the OP question has only one <code>result</code> dictionary with a single max_price and min_price key."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1576086307, "post_id": 59291070, "comment_id": 104787476, "body": "I work with that same api, and it doesn&#39;t. You get a collection of items which you need to loop through... OP&#39;s sintax is good, but the local window will tell which items are inside which."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1576088529, "post_id": 59291070, "comment_id": 104788491, "body": "@Damian - We can only work with what the OP provides - their specific URL returns only a single result.  This answer addresses the specific question asked."}], "tags": [], "owner": {"reputation": 7231, "user_id": 4915798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb8af3ae95300addb5dfa2e6cb5940c3?s=128&d=identicon&r=PG&f=1", "display_name": "afonso", "link": "https://stackoverflow.com/users/4915798/afonso"}, "is_accepted": true, "score": 1, "last_activity_date": 1576085075, "creation_date": 1576085075, "answer_id": 59291070, "question_id": 59290845, "link": "https://stackoverflow.com/questions/59290845/how-do-i-use-parsejson-in-vba-to-get-selected-items-in-response/59291070#59291070", "title": "How do I use ParseJson in VBA to get selected items in response?", "body": "<p>There is no need to loop through the JSON element. You can access directly those values with:</p>\n\n<pre><code>Sheets(1).Cells(1, 1).Value = JSON(\"result\")(\"max_price\")\nSheets(1).Cells(1, 2).Value = JSON(\"result\")(\"min_price\")\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 1781336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/090daef10cc96523f5f8d0b087911cfa?s=128&d=identicon&r=PG", "display_name": "user1781336", "link": "https://stackoverflow.com/users/1781336/user1781336"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 59291070, "answer_count": 1, "score": 0, "last_activity_date": 1576085075, "creation_date": 1576084340, "question_id": 59290845, "link": "https://stackoverflow.com/questions/59290845/how-do-i-use-parsejson-in-vba-to-get-selected-items-in-response", "title": "How do I use ParseJson in VBA to get selected items in response?", "body": "<p>I am trying to select two values from a JSON response in VBA, using the JsonConverter.bas file from GitHub. I am not sure I am calling the fields correctly. When I run the following code I get the \"Run-time error '13': Type mismatch\" error message. How would I be able to select the max_price value and the min_price values from the following: </p>\n\n<pre><code>Public Sub exceljson()\n\nDim http As Object, JSON As Object, i As Integer\n\nSet http = CreateObject(\"MSXML2.XMLHTTP\")\n\nhttp.Open \"GET\", \"https://testapp.deribit.com/api/v2/public/ticker?instrument_name=BTC-27DEC19-8000-C\", False\n\nhttp.Send\n\nSet JSON = ParseJson(http.ResponseText)\n\ni = 2\nFor Each Item In JSON\nSheets(1).Cells(i, 1).Value = Item(\"result\")(\"max_price\")\nSheets(1).Cells(i, 2).Value = Item(\"result\")(\"min_price\")\ni = i + 1\n\nNext\n\nMsgBox (\"complete\")\n\nEnd Sub\n\n</code></pre>\n"}, {"tags": ["excel", "vba", "hyperlink", "textbox"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1576084216, "post_id": 59290795, "comment_id": 104786474, "body": "Sounds like a good plan. What&#39;s the problem/question?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1576084271, "post_id": 59290795, "comment_id": 104786504, "body": "Keep in mind if it&#39;s a box you can type into, you cant make it a functional hyperlink."}, {"owner": {"reputation": 176, "user_id": 7790684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0VUy0GkIrRI/AAAAAAAAAAI/AAAAAAAAAMg/o32NDkuuG60/photo.jpg?sz=128", "display_name": "Foxhunt", "link": "https://stackoverflow.com/users/7790684/foxhunt"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1576085386, "post_id": 59290795, "comment_id": 104787032, "body": "I did not find how to insert that link using vba. And that is right, link is not usable. Is there a better object i can use ?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1576085864, "post_id": 59290795, "comment_id": 104787282, "body": "You can use a Label, and then style it to look like a link, and then add some code on the click event to open the link, but that&#39;s about as close as you can get using VBA - <a href=\"https://www.computergaga.com/blog/add-a-hyperlink-to-a-userform-excel-vba/\" rel=\"nofollow noreferrer\">computergaga.com/blog/add-a-hyperlink-to-a-userform-excel-vb&zwnj;&#8203;a</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576087421, "post_id": 59290795, "comment_id": 104788001, "body": "A <code>TextBox</code> contains plain text. A hyperlink is not that. If you&#39;re in a 32-bit host, you can use a <code>RichTextBox</code> with formatted RTF text, which presumably (no idea) supports hyperlinks - but that won&#39;t work on a 64-bit host, so I wouldn&#39;t recommend it. Why not keep your UI nice &amp; simple, with controls that are actually supported and known to work in all hosts regardless of bitness? If you want a fancypants UI, don&#39;t do it in VBA."}, {"owner": {"reputation": 176, "user_id": 7790684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0VUy0GkIrRI/AAAAAAAAAAI/AAAAAAAAAMg/o32NDkuuG60/photo.jpg?sz=128", "display_name": "Foxhunt", "link": "https://stackoverflow.com/users/7790684/foxhunt"}, "edited": false, "score": 0, "creation_date": 1576087736, "post_id": 59290795, "comment_id": 104788150, "body": "I will ditribute my excel, then i suppose i cannot use <code>RichTextBox</code>."}], "answers": [{"tags": [], "owner": {"reputation": 176, "user_id": 7790684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0VUy0GkIrRI/AAAAAAAAAAI/AAAAAAAAAMg/o32NDkuuG60/photo.jpg?sz=128", "display_name": "Foxhunt", "link": "https://stackoverflow.com/users/7790684/foxhunt"}, "is_accepted": true, "score": 0, "last_activity_date": 1576087439, "creation_date": 1576087439, "answer_id": 59291646, "question_id": 59290795, "link": "https://stackoverflow.com/questions/59290795/insert-a-hypertext-link-in-an-excel-textbox/59291646#59291646", "title": "Insert a Hypertext link in an Excel textbox", "body": "<p>Okay then, i will use label.</p>\n\n<p>Here is the best i found :</p>\n\n<pre><code>With Worksheets(1)\n Dim l:l as Shape = .Shapes.AddLabel(msoTextOrientationHorizontal, 0, 0, 100, 100)\n l.TextFrame.Characters.Text = \"link text here\"\n .Hyperlinks.Add l, \"mailto:someone@example.com\"\n</code></pre>\n\n<p>The <em>hypertext link is set to the whole label here</em>, then i must place it precisely as an overlay of the text.</p>\n"}], "owner": {"reputation": 176, "user_id": 7790684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0VUy0GkIrRI/AAAAAAAAAAI/AAAAAAAAAMg/o32NDkuuG60/photo.jpg?sz=128", "display_name": "Foxhunt", "link": "https://stackoverflow.com/users/7790684/foxhunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 733, "favorite_count": 0, "accepted_answer_id": 59291646, "answer_count": 1, "score": -1, "last_activity_date": 1576087439, "creation_date": 1576084110, "last_edit_date": 1576085499, "question_id": 59290795, "link": "https://stackoverflow.com/questions/59290795/insert-a-hypertext-link-in-an-excel-textbox", "title": "Insert a Hypertext link in an Excel textbox", "body": "<p>I have a sheet with a textbox, created with VBA :</p>\n\n<pre><code>With Worksheets(1)\n  .Shapes.AddTextbox(msoTextOrientationHorizontal, 0, 0, 100, 100).TextFrame.Characters.Text = _\n      \"Some text here\" &amp; LinkHere &amp; \"Maybe more text here\"\n</code></pre>\n\n<p>I would like to insert a link in the text of the textbox , but i can't find vba code to do that.\nThe link i would precisely add is a <code>\"mailto:\"</code> link.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>Actually, a textbox cannot have usable links, so my second question is : what object can i use to have well formated text and a link into it ?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576085049, "post_id": 59290782, "comment_id": 104786866, "body": "Is this homework? You can do this with a formula."}, {"owner": {"reputation": 1, "user_id": 12514143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2814928938dd53f655bebc79f0ed404d?s=128&d=identicon&r=PG", "display_name": "shaik", "link": "https://stackoverflow.com/users/12514143/shaik"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576086579, "post_id": 59290782, "comment_id": 104787608, "body": "No its for my exam..but i have no clue how to do it :( if you can to help me ill be glad to see the answer,thanks!"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576086622, "post_id": 59290782, "comment_id": 104787633, "body": "<a href=\"https://meta.stackoverflow.com/questions/334822/how-do-i-ask-and-answer-homework-questions\" title=\"how do i ask and answer homework questions\">meta.stackoverflow.com/questions/334822/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 12514143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2814928938dd53f655bebc79f0ed404d?s=128&d=identicon&r=PG", "display_name": "shaik", "link": "https://stackoverflow.com/users/12514143/shaik"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576086748, "post_id": 59290782, "comment_id": 104787698, "body": "Mate this is not a homework,this is a question for a exam which i have for 3 days and i can not do it,if you can help please help"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576086803, "post_id": 59290782, "comment_id": 104787730, "body": "In my honest opinion, the principles are similar whether it&#39;s homework or an exam. Happy to help if you <a href=\"https://stackoverflow.com/posts/59290782/edit\">edit</a> your question with what you&#39;ve tried. Otherwise, it&#39;s my effort, not yours, but this is <i>your</i> exam."}, {"owner": {"reputation": 1, "user_id": 12514143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2814928938dd53f655bebc79f0ed404d?s=128&d=identicon&r=PG", "display_name": "shaik", "link": "https://stackoverflow.com/users/12514143/shaik"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576086824, "post_id": 59290782, "comment_id": 104787739, "body": "or give me some formula any help will be nice"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576086903, "post_id": 59290782, "comment_id": 104787786, "body": "Here&#39;s a formula that you can drag to create it, but I&#39;ll leave you to translate to code: <code>=IF(MOD(ROW()+COLUMN(),2)=0,MIN(ROW(),COLUMN()),&quot;&quot;)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "is_accepted": false, "score": 2, "last_activity_date": 1576088997, "creation_date": 1576088997, "answer_id": 59291974, "question_id": 59290782, "link": "https://stackoverflow.com/questions/59290782/visial-basic-excel-example/59291974#59291974", "title": "Visial basic excel example", "body": "<p>Try this in a worksheet code</p>\n\n<pre><code>Public Sub MakePyramid()\n\n    Dim r_start As Range\n    Set r_start = Range(\"A1\")\n\n    Dim i As Long, j As Long, n As Long\n\n    n = 3 ' Number of layers\n    For i = 1 To n\n        For j = 1 To i\n            r_start.Cells(2 * i - j, j).Value = j\n            r_start.Cells(j, 2 * i - j).Value = j\n        Next j\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>Result</p>\n\n<p><a href=\"https://i.stack.imgur.com/UAIdv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UAIdv.png\" alt=\"pic\"></a></p>\n\n<p>But why?</p>\n\n<p>You need to figure out why this code works in order to prepare for your exam.</p>\n"}], "owner": {"reputation": 1, "user_id": 12514143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2814928938dd53f655bebc79f0ed404d?s=128&d=identicon&r=PG", "display_name": "shaik", "link": "https://stackoverflow.com/users/12514143/shaik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1576135851, "creation_date": 1576084051, "last_edit_date": 1576135851, "question_id": 59290782, "link": "https://stackoverflow.com/questions/59290782/visial-basic-excel-example", "title": "Visial basic excel example", "body": "<p>can anyone please do this example for me i`m stuck here for about 2 days and cant do it :( \nI need to make a code which will write numbers in this pyramidal way: 1 121 12321 1234321.. and must be written as example at this picture </p>\n\n<p><img src=\"https://i.stack.imgur.com/3YxLI.jpg\" alt=\"scr\"></p>\n"}, {"tags": ["excel", "vba", "pivot"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12519784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a39f8f224d5095f6a7b5a855cab57?s=128&d=identicon&r=PG&f=1", "display_name": "BrianAll", "link": "https://stackoverflow.com/users/12519784/brianall"}, "edited": false, "score": 0, "creation_date": 1576137943, "post_id": 59293976, "comment_id": 104803306, "body": "Hi Scott, you had a clue. pt was declared as Pivot Table. I&#39;ve created a new variable (declared as String): <code>ptString = pt</code>. Now it&#39;s working fine. Thanks!"}], "tags": [], "owner": {"reputation": 60, "user_id": 12520336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39887c2c0d909472b79900e65ae5f8cf?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/12520336/scott"}, "is_accepted": false, "score": 0, "last_activity_date": 1576097939, "creation_date": 1576097939, "answer_id": 59293976, "question_id": 59290647, "link": "https://stackoverflow.com/questions/59290647/delete-pivot-calculated-fields/59293976#59293976", "title": "Delete Pivot Calculated Fields", "body": "<p>Have you defined your variables in your code:</p>\n\n<pre><code>Dim pt, CampoCalcolatoToDelete as String\n\npt = \"Tabella pivot3\"\nCampoCalcolatoToDelete = \"w 49 - 06/12 CC\"\n\nActiveSheet.PivotTables(pt).CalculatedFields(CampoCalcolatoToDelete).Delete\n</code></pre>\n\n<p>Are there any errors given when you attempt to run the line from your code that uses the variables? </p>\n"}], "owner": {"reputation": 11, "user_id": 12519784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a39f8f224d5095f6a7b5a855cab57?s=128&d=identicon&r=PG&f=1", "display_name": "BrianAll", "link": "https://stackoverflow.com/users/12519784/brianall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1576102265, "creation_date": 1576083512, "last_edit_date": 1576102265, "question_id": 59290647, "link": "https://stackoverflow.com/questions/59290647/delete-pivot-calculated-fields", "title": "Delete Pivot Calculated Fields", "body": "<p>I want to delete a calculated field in a Pivot table.\nI know I can't do this before setting the same calculated field as visible = false.\nSo I set the calculated field in object as not visible.</p>\n\n<p>I tried two identical lines of code (below).\nThe first lines contains two variables set with the same values that you can find in the second line.</p>\n\n<pre><code>pt = \"Tabella pivot3\"\nCampoCalcolatoToDelete = \"w 49 - 06/12 CC\"\n\nActiveSheet.PivotTables(pt).CalculatedFields(CampoCalcolatoToDelete).Delete\nActiveSheet.PivotTables(\"Tabella pivot3\").CalculatedFields(\"w 49 - 06/12 CC\").Delete\n</code></pre>\n\n<p>The second line is working fine.\nThe first one (with variables) it is not working.</p>\n\n<p>Can anyone suggest why?</p>\n\n<p>Thanks </p>\n"}, {"tags": ["vba", "forms", "ms-access"], "comments": [{"owner": {"reputation": 11, "user_id": 11984280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6656de91c4a63e01b81fc765c8ccbebb?s=128&d=identicon&r=PG&f=1", "display_name": "cmBeards", "link": "https://stackoverflow.com/users/11984280/cmbeards"}, "edited": false, "score": 0, "creation_date": 1576083757, "post_id": 59290629, "comment_id": 104786242, "body": "Another interesting fact about this, if i change the name on the Other tab of the property options, the fields then appear."}, {"owner": {"reputation": 11, "user_id": 11984280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6656de91c4a63e01b81fc765c8ccbebb?s=128&d=identicon&r=PG&f=1", "display_name": "cmBeards", "link": "https://stackoverflow.com/users/11984280/cmbeards"}, "edited": false, "score": 0, "creation_date": 1576088627, "post_id": 59290629, "comment_id": 104788531, "body": "I have now rebuilt the table and the form, I have created a database and linked to the same table and still get the same results."}, {"owner": {"reputation": 11, "user_id": 11984280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6656de91c4a63e01b81fc765c8ccbebb?s=128&d=identicon&r=PG&f=1", "display_name": "cmBeards", "link": "https://stackoverflow.com/users/11984280/cmbeards"}, "edited": false, "score": 0, "creation_date": 1576089344, "post_id": 59290629, "comment_id": 104788877, "body": "If i add another short text field it shows up when I type &quot;Me.&quot; in vba, But any other type of field does not show up"}], "answers": [{"tags": [], "owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "is_accepted": false, "score": 2, "last_activity_date": 1576096679, "creation_date": 1576096679, "answer_id": 59293718, "question_id": 59290629, "link": "https://stackoverflow.com/questions/59290629/fields-on-form-selected-from-data-source-are-not-available-when-using-me/59293718#59293718", "title": "Fields on form, selected from data source are not available when using Me", "body": "<p>Naming an identifier with a number as first character is a bad idea! Always start with a letter!</p>\n\n<p>On Access 2013 that creates a compile error as the compiler expects a<code>=</code>as he interprets<code>.5</code>as a decimal-number. </p>\n\n<p>That worked for you on older versions? Hard to believe!</p>\n\n<p>As workaround use square-brackets like on identifiers containing spaces or other crap.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Me.[5sID]\n</code></pre>\n\n<p>or turn on<code>Show hidden Elements</code>in Object-Browser , what fixes Inteli-Sense and creates automatic brackets. Seems like this is a way to create hidden members ;)</p>\n"}], "owner": {"reputation": 11, "user_id": 11984280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6656de91c4a63e01b81fc765c8ccbebb?s=128&d=identicon&r=PG&f=1", "display_name": "cmBeards", "link": "https://stackoverflow.com/users/11984280/cmbeards"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593675141, "creation_date": 1576083475, "last_edit_date": 1593675141, "question_id": 59290629, "link": "https://stackoverflow.com/questions/59290629/fields-on-form-selected-from-data-source-are-not-available-when-using-me", "title": "Fields on form, selected from data source are not available when using Me", "body": "<p>I have two fields on a form. Field 1 is auto number field named 5sID. Field 2 is a lookup field named 5sType.</p>\n\n<p>When I open the VBA code for both the oncurrent and on open, I try to reference either field with a \"Me.5sID\" or \"Me.5sType\". In either case when I type in the \"Me.\" the auto list shows the other eight fields in the table, but not these two.</p>\n\n<p>I have used this for years on both datasheets or continuous forms. There are only the two fields on the form and they were selected from the table field list in the design view.</p>\n\n<p>If I change the name on the Other tab of the property options, the fields then appear.</p>\n\n<p>I have now rebuilt the table and the form, I have created a database and linked to the same table and still get the same results.</p>\n\n<p>If I add another short text field it shows up when I type \"Me.\" in VBA, but any other type of field does not show up.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 157, "user_id": 2132940, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ce47073293e33b7ec1aa14024e11d006?s=128&d=identicon&r=PG", "display_name": "Marcel", "link": "https://stackoverflow.com/users/2132940/marcel"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1576754217, "post_id": 59290436, "comment_id": 105004601, "body": "Thanks for the clarification. After I posted the assumed solution, more questions have arisen about the whole issue and I have re-formulated the post."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1576762367, "post_id": 59290436, "comment_id": 105008609, "body": "OK... You also need to be careful, here, about changing the content of a question once an Answer has been posted to it. Invalidating an answer worked out and posted &quot;in good faith&quot; is &quot;bad&quot; (if the positions were reversed you wouldn&#39;t be happy, I&#39;ll bet). Just mentioning it for future reference :-)"}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 2132940, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ce47073293e33b7ec1aa14024e11d006?s=128&d=identicon&r=PG", "display_name": "Marcel", "link": "https://stackoverflow.com/users/2132940/marcel"}, "edited": false, "score": 0, "creation_date": 1576753773, "post_id": 59295147, "comment_id": 105004387, "body": "Thank you for the useful overview. Unfortunately that doesn&#39;t solve the above stated problem, because if the selection -or a range-object is preceeded by hidden text, this hidden text seems to be included within that object, although many functions operate on the object as if the preceeding text would not be included."}, {"owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "reply_to_user": {"reputation": 157, "user_id": 2132940, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ce47073293e33b7ec1aa14024e11d006?s=128&d=identicon&r=PG", "display_name": "Marcel", "link": "https://stackoverflow.com/users/2132940/marcel"}, "edited": false, "score": 0, "creation_date": 1576766352, "post_id": 59295147, "comment_id": 105010856, "body": "It&#39;s the best I could do given the lack of clarity in your original question. As an example, you conflated hidden and deleted text, though those are 2 different things. From your new edits, I can see you&#39;re interested in hidden text. Hidden text has to retain its style characteristics, but it sounds like you would find it more convenient if it didn&#39;t."}, {"owner": {"reputation": 157, "user_id": 2132940, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ce47073293e33b7ec1aa14024e11d006?s=128&d=identicon&r=PG", "display_name": "Marcel", "link": "https://stackoverflow.com/users/2132940/marcel"}, "edited": false, "score": 0, "creation_date": 1576793762, "post_id": 59295147, "comment_id": 105022453, "body": "Sorry for the lack of clarity. I am aware that hidden and deleted text are 2 different things, but in the above described circumstances, they behave the same way. Most of the time I have to deal with deleted text which is formatted as <code>wdDeletedTextMarkHidden</code>. If deleted (hidden) text is preceeding the selection or a range-object, it seems to be included and thus <code>selection.style</code> will yield an unexpected result. On the other hand, <code>length(selection)</code> and many other functions will return the expected result."}], "tags": [], "owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "is_accepted": false, "score": 1, "last_activity_date": 1576103613, "creation_date": 1576103613, "answer_id": 59295147, "question_id": 59290436, "link": "https://stackoverflow.com/questions/59290436/vba-word-eliciting-properties-of-a-range-object-in-a-text-containing-revision/59295147#59295147", "title": "VBA Word - eliciting properties of a range-object in a text containing revision marks", "body": "<p>Selection.Style will only return one style, even if more than one has been applied. A selection can have up to 4 styles. </p>\n\n<p>To find the character style of selected text, use:</p>\n\n<pre><code>Selection.Range.CharacterStyle\n</code></pre>\n\n<p>To get the paragraph style:</p>\n\n<pre><code>Selection.Range.ParagraphStyle\n</code></pre>\n\n<p>To get the table style:</p>\n\n<pre><code>Selection.Range.TableStyle\n</code></pre>\n\n<p>To get the list (bullets or numbering) style:</p>\n\n<pre><code>Selection.Range.ListStyle\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 2132940, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ce47073293e33b7ec1aa14024e11d006?s=128&d=identicon&r=PG", "display_name": "Marcel", "link": "https://stackoverflow.com/users/2132940/marcel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576757812, "creation_date": 1576082679, "last_edit_date": 1576757812, "question_id": 59290436, "link": "https://stackoverflow.com/questions/59290436/vba-word-eliciting-properties-of-a-range-object-in-a-text-containing-revision", "title": "VBA Word - eliciting properties of a range-object in a text containing revision marks", "body": "<p>A text </p>\n\n<ul>\n<li><p>containins a string of hidden text </p></li>\n<li><p>contains revision marks while deleted revisions are formatted as hidden.</p></li>\n</ul>\n\n<p>i.e. deleted (hidden) text<strong>visible text</strong> </p>\n\n<p>The <strong>visible text</strong> has been selected (not knowing that it is preceded by hidden text) and the selection is copied to a range.</p>\n\n<pre><code>Dim R_Visible as range\nset R_Visible = selection.range\n</code></pre>\n\n<p>If I want to determine some property, i.e. the character style, VBA will elicit the style property of the whole string \"deleted (hidden) text<strong>visible text</strong>\", not only of \"<strong>visible text</strong>\". Thus, if the character style of the deleted part differs, from the character style of the visible part, VBA will return the value of <code>selection.ParagraphFormat.style</code>.</p>\n\n<p>To make things more complicated I want to elicit the character style of only the 1st character of the selected text. Here are some possible approaches and their results:</p>\n\n<p>a)\n<code>Print R_Visible.characters(1).CharacterStyle</code> ==> Runtime error 91</p>\n\n<p>b)\n<code>Print R_Visible.characters(1).Style</code> ==> paragraph style</p>\n\n<p>As a work-around I have written the following function:</p>\n\n<pre><code>Function ExactRange(Optional R_Range) As Range\n\nDim R_Selected As Range \n\nIf IsMissing(R_Range) Then\n    Set ExactRange = Selection.Range\nElse\n    'set ExactRange = R_Range.duplicate '(I haven't tested thoroughly whether that works under all circumstances)\n    Set R_Selected = Selection.Range\n    R_Range.Select\n    Set ExactRange = Selection.Range\n    R_Selected.Select 're-establishing the original selection-object \nEnd If\n\n    ExactRange.SetRange Start:=ExactRange.Characters(1).End - 1, _ \n                          End:=ExactRange.Characters(Len(ExactRange)).End\nEnd Function\n</code></pre>\n\n<p>which produces some more results:</p>\n\n<p>c)\n<code>print Mtf_ExactRange(R_Visible).style</code>==> character style</p>\n\n<p>d) \n<code>print MTF_ExactRange(R_Visible).Characters(1).Style</code> ==> paragraph style</p>\n\n<p>e)\n<code>print MTF_ExactRange(R_Visible.characters(1)).Style</code>== character style</p>\n\n<p>It seems to me that the behaviour is quite erratic. Can someone explain to me what is happening here and maybe point out an intended VBA-method to elicit a character style under the given circumstances without the need of a work-around function?</p>\n"}, {"tags": ["excel", "vba", "error-handling", "outlook"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1576084395, "post_id": 59290259, "comment_id": 104786559, "body": "The <code>.Send</code> call <b>is</b> located in a place where any error would jump execution to the <code>ErrorHandler</code> label. Are you saying <code>.Send</code> is throwing an error <i>that is unhandled</i>? Despite the handler? Verify your VBE options, make sure &quot;Break on <b>unhandled</b> errors&quot; is selected."}, {"owner": {"reputation": 1346, "user_id": 12418842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oB8nm.jpg?s=128&g=1", "display_name": "Michael Wycisk", "link": "https://stackoverflow.com/users/12418842/michael-wycisk"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1576085121, "post_id": 59290259, "comment_id": 104786896, "body": "Thank you @MathieuGuindon for the idea. I just checked it and &quot;Break on unhandled errors&quot; is selected. To clarify, the code is not throwing an error. The Outlook window appears and after I click on &quot;Cancel&quot;, nothing happens. The code simply stops an no error is highlighted in the VBE (no error message or &quot;success&quot;-message from the code either). It is really weird, I worked with VBA for quite some years, but such thing has not happened to me before."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1576085332, "post_id": 59290259, "comment_id": 104786995, "body": "I think there should be a way to validate whether there&#39;s a connected account in <code>ThisOutlookSession</code> before attempting to send an email. Not very familiar with the Outlook OM though :-/"}, {"owner": {"reputation": 1346, "user_id": 12418842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oB8nm.jpg?s=128&g=1", "display_name": "Michael Wycisk", "link": "https://stackoverflow.com/users/12418842/michael-wycisk"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576085547, "post_id": 59290259, "comment_id": 104787122, "body": "@MathieuGuindon Thanks. I am not really programming towards Outlook either - but I will search the web if I can find something. My concern is just that - even if I can check for an Outlook account - there might be other reason that prevent the message from being sent (Internet connection, problems with the email provider, and so on). So I would like to hear with the experts if there is anything I can improve in my error handling so any Outlook related error will be catched :-)."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1576085652, "post_id": 59290259, "comment_id": 104787176, "body": "I believe most problems that could pop up trying to send an email would actually throw a run-time error that your error handling code would handle. Thinking you&#39;ve hit an edge case (who uses an Outlook macro without a connected account?); verifying that there&#39;s a valid, connected account would remove the edge case from the equation (assuming there aren&#39;t more surprises!)"}, {"owner": {"reputation": 1346, "user_id": 12418842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oB8nm.jpg?s=128&g=1", "display_name": "Michael Wycisk", "link": "https://stackoverflow.com/users/12418842/michael-wycisk"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1576109540, "post_id": 59290259, "comment_id": 104796237, "body": "@MathieuGuindon Thank you so much for your help! I have been looking around and found this <a href=\"https://stackoverflow.com/a/32378713/12418842\">answer</a>. I have setup up an extra handler and use <code>If OutlookApp.Session.Accounts.Count = 0 Then GoTo OutlookNotSetup</code> (right after <code>Set OutlookApp = CreateObject(&quot;Outlook.Application&quot;)</code> to check if an Outlook account is configured or not. This one opens the &quot;Welcome&quot; dialog, but interestingly, the code does not stop. So I can handle the problem now. Thank you again for your advice. It&#39;s a pity I can&#39;t pass some reputation to you by upvoting your comments."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1576110074, "post_id": 59290259, "comment_id": 104796354, "body": "Eh, I have more rep than I know what to do with =) ...feel free to check out <a href=\"https://github.com/rubberduck-vba/rubberduck\" rel=\"nofollow noreferrer\">Rubberduck</a> (free, open-source VBE add-in project I manage/cheerlead: rubberduckvba.com, see my profile for more links), and give us a star if you like!"}, {"owner": {"reputation": 1346, "user_id": 12418842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oB8nm.jpg?s=128&g=1", "display_name": "Michael Wycisk", "link": "https://stackoverflow.com/users/12418842/michael-wycisk"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1576110411, "post_id": 59290259, "comment_id": 104796411, "body": "@MathieuGuindon Too late - I already have and use Rubberduck :-)."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1576110475, "post_id": 59290259, "comment_id": 104796430, "body": "And that has just made my day lol! Cheers!"}], "answers": [{"tags": [], "owner": {"reputation": 34, "user_id": 10627751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4373a07c608e305bed4b8eaf398fa3ff?s=128&d=identicon&r=PG&f=1", "display_name": "szewski", "link": "https://stackoverflow.com/users/10627751/szewski"}, "is_accepted": false, "score": 0, "last_activity_date": 1576084184, "creation_date": 1576084184, "answer_id": 59290812, "question_id": 59290259, "link": "https://stackoverflow.com/questions/59290259/how-to-handle-errors-when-an-email-is-sent-from-excel-through-outlook/59290812#59290812", "title": "How to handle errors when an email is sent from Excel through Outlook?", "body": "<p>If you would like to be totally sure that your email has been sent then maybe it would be good idea to check if your message is inside \"Sent\" or/and \"Outbox\" folder (see <a href=\"https://stackoverflow.com/questions/21556389/iterate-all-email-items-in-a-specific-outlook-folder\">here</a>). If vba will crash there, then you will know that there can be an error with Outlook app. \nIf you are sending hundreds of emails at once then have an eye on \"Outbox\" folder. Emails are stored there and sent one by one even after macro will finish the work.</p>\n\n<p>Next bigger check would be to wait some time for server response and check Inbox folder for error return message if email was not valid. But that option could be an overkill for the task.</p>\n"}], "owner": {"reputation": 1346, "user_id": 12418842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oB8nm.jpg?s=128&g=1", "display_name": "Michael Wycisk", "link": "https://stackoverflow.com/users/12418842/michael-wycisk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 591, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1580147021, "creation_date": 1576082115, "last_edit_date": 1580147021, "question_id": 59290259, "link": "https://stackoverflow.com/questions/59290259/how-to-handle-errors-when-an-email-is-sent-from-excel-through-outlook", "title": "How to handle errors when an email is sent from Excel through Outlook?", "body": "<p>I send an Excel worksheet as an email attachment through Outlook (from Excel).</p>\n\n<p>Strongly simplified code:</p>\n\n<pre><code>Private Sub SendWorksheetByEmail(sEmail As String)\n\n    'This error handler should make sure that the code always\n    'goes through a \"clean up\" procedure where\n    'all settings are reset and temporary files are deleted\n    On Error GoTo ErrorHandler\n\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n    Application.Calculation = xlCalculationManual\n    ActiveSheet.DisplayPageBreaks = False\n\n    Dim sFile As String\n    Dim wbCopy As Workbook\n    Dim OutlookApp As Object, OutlookMail As Object\n    '.......some more declarations.................\n\n    'Here comes code that will do some changes in the workbook,\n    'then copy one of the sheets to a new workbook (wbCopy) and\n    'store the workbook to the temp folder. I guess it is not\n    'neccessary in order to understand the question.\n    '..............................................\n    '..............................................\n\n\n    'Sending the email\n    'I somethines see that people put a \"On Error Resume Next\" here.\n    'Then, the code will always finish - but I do not get an error\n    'Message. What is the point of doing this?\n\n    Set OutlookApp = CreateObject(\"Outlook.Application\")\n    Set OutlookMail = OutlookApp.CreateItem(0)\n    With OutlookMail\n        .To = sEmail\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"Some subject text\"\n        .Body = \"Some email body text\"\n        .Attachments.Add sFile\n        .Send\n    End With\n\n    MsgBox \"Your email was successfully sent to \" &amp; sEmail, vbInformation, \"Email sent\"\n\nErrorExit:\n    'Various \"clean up\" (delete temporary file) and restore settings\n    On Error Resume Next\n    wbCopy.Close\n    Kill sFile\n    Set OutlookMail = Nothing\n    Set OutlookApp = Nothing\n    ActiveSheet.DisplayPageBreaks = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\n\n    Exit Sub\n\nErrorHandler:\n    MsgBox \"An error occured and the email might not have been sent.\", vbCritical, \"Error\"\n    Resume ErrorExit\n\nEnd Sub\n</code></pre>\n\n<p>The idea is that the code will skip to the <code>ErrorHandler</code> (and clean up some settings, delete a temporary file and so on) once an error occurs.</p>\n\n<p>That works if the error occurs before sending the email. However, if something goes wrong sending the email, the code will simply stop.</p>\n\n<p>An example: I tested the code on a VM where I do not have any email account set up in Outlook, so Outlook will start and prompt me to set up an account. If I close Outlook, the macro won\u2019t continue to run.</p>\n\n<p><a href=\"https://i.stack.imgur.com/WxnX8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WxnX8.png\" alt=\"Outlook is not set up and asks to create a user account\"></a></p>\n\n<p>I did some web research and see that the code that sends the email is often run with an <code>On Error Resume Next</code> statement. I tried that and the code finished running this time. However, I do not manage to check if the email was sent \u2013 so the user gets a confirmation message box even if the email could not be sent.</p>\n\n<p>How do I make sure the code always finishes? And how could I check if the email was actually sent (in order to display an error message)?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1576082022, "post_id": 59290029, "comment_id": 104785353, "body": "Overflowing a numeric type isn&#39;t something you <i>wonder</i> whether it&#39;s happened: you&#39;d be getting a very loud &amp; clear &quot;Overflow&quot; error (run-time error 6) if that were the case... <code>y</code> should be a <code>Long</code> though, since <code>HighC-LowC</code> (900K) is WELL outside the range of <code>Integer</code>... and that <i>should</i> be blowing up. Did you remove <code>On Error Resume Next</code> before posting by any chance? Note that because of the <code>As Currency</code> specifiers, the <code>#</code> type hints are superfluous and should be removed."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 2, "creation_date": 1576082225, "post_id": 59290029, "comment_id": 104785446, "body": "Still weird, at the end of the loop x = 1572869721000 which is less than highc = 1573870107000. There might be a hidden conversion to Double in the For loop."}, {"owner": {"reputation": 69, "user_id": 5265966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8061a64dfda659e68d38e25d0d9b8dd7?s=128&d=identicon&r=PG&f=1", "display_name": "JC_RMB", "link": "https://stackoverflow.com/users/5265966/jc-rmb"}, "edited": false, "score": 0, "creation_date": 1576082390, "post_id": 59290029, "comment_id": 104785549, "body": "No, I didn&#39;t remove any error traps. It is exactly how I have it in a VBA Module. Since first posting, I&#39;ve discovered that I only get the &quot;wrong&quot; answer in Excel 2016. Excel 2013 works fine."}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1576082513, "post_id": 59290029, "comment_id": 104785614, "body": "Did some testing, and I agree with @VincentG. If <code>x</code> is changed to <code>double</code> from the start, the problem disappears."}, {"owner": {"reputation": 69, "user_id": 5265966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8061a64dfda659e68d38e25d0d9b8dd7?s=128&d=identicon&r=PG&f=1", "display_name": "JC_RMB", "link": "https://stackoverflow.com/users/5265966/jc-rmb"}, "edited": false, "score": 0, "creation_date": 1576082681, "post_id": 59290029, "comment_id": 104785708, "body": "Yes, that seems to work. Any ideas why this is so?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1576082687, "post_id": 59290029, "comment_id": 104785712, "body": "@MathieuGuindon the # is set automatically by the VBE for long number. In fact the symbol for Currency is @, not # (symbol for Double type)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1576083084, "post_id": 59290029, "comment_id": 104785932, "body": "@VincentG ah, yes. &lt;s&gt;I should probably use type hints more often.&lt;/s&gt; Still, they apply to the literal values, not the actual variables (which have a proper declared type), so there&#39;s an implicit conversion going on during the assignment. Could change to <code>LowC = CCur(....#)</code> for explicitness, but I don&#39;t think that would fix anything."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576083828, "post_id": 59290029, "comment_id": 104786279, "body": "Interesting, can repro on Excel 2016. Weirdly too, if you change the loop to <code>For x = HighC To LowC Step -StepValue</code> the output is correct."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576084035, "post_id": 59290029, "comment_id": 104786380, "body": "@BigBen the loop is just an inefficient way to get <code>x</code> to be <code>(HighC - LowC)&#47;StepValue + 1</code>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576084071, "post_id": 59290029, "comment_id": 104786395, "body": "I agree, it just doesn&#39;t make sense that I could reverse the step logic and get the right answer, while not get it with the current logic. That said, I would never loop with <code>Currency</code> to begin with."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1576084110, "post_id": 59290029, "comment_id": 104786421, "body": "So the question becomes, why would this loop exit after 513 iterations instead of 900. And yeah, the answer very likely has everything to do with floating-point rounding errors introduced by doing math with <code>Currency</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1576084667, "post_id": 59290029, "comment_id": 104786679, "body": "@BigBen did you repro on a 32-bit Excel host? Mine is 64-bit... I suspect a 32-bit machine might be doing the math differently here. @ OP - please confirm bitness of both your Excel 2013 and 2016 installs."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576084773, "post_id": 59290029, "comment_id": 104786737, "body": "@Mathieu Guindon Yes, 32-bit. I suspected this might be the issue, but didn&#39;t have 64-bit to compare."}, {"owner": {"reputation": 317, "user_id": 2113672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a2uII.jpg?s=128&g=1", "display_name": "Noah Bridge", "link": "https://stackoverflow.com/users/2113672/noah-bridge"}, "edited": false, "score": 0, "creation_date": 1576085103, "post_id": 59290029, "comment_id": 104786886, "body": "I don&#39;t have Excel 2016 available to test at this time, but, from looking at the code, I suspect the problem lies with the constant <code>StepValue</code>. I would try explicitly specifying its type (with <code>Const StepValue As Currency = 1000</code>). If that resolves the issue, the problem is with how Excel 2016 is adding high currency values and integer values during the <code>For</code> loop. I will try to test this myself the next time I am on a machine with Excel 2016."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 317, "user_id": 2113672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a2uII.jpg?s=128&g=1", "display_name": "Noah Bridge", "link": "https://stackoverflow.com/users/2113672/noah-bridge"}, "edited": false, "score": 2, "creation_date": 1576085193, "post_id": 59290029, "comment_id": 104786941, "body": "@NoahBridge no dice, already tried that. I think the bitness of the Excel install is the culprit here."}, {"owner": {"reputation": 69, "user_id": 5265966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8061a64dfda659e68d38e25d0d9b8dd7?s=128&d=identicon&r=PG&f=1", "display_name": "JC_RMB", "link": "https://stackoverflow.com/users/5265966/jc-rmb"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576085925, "post_id": 59290029, "comment_id": 104787310, "body": "@BigBen - I think that you&#39;re onto something there. My Excel 2016 installation is 32bit whereas my Excel 2013 installation is 64bit. The 64bit version works fine."}, {"owner": {"reputation": 69, "user_id": 5265966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8061a64dfda659e68d38e25d0d9b8dd7?s=128&d=identicon&r=PG&f=1", "display_name": "JC_RMB", "link": "https://stackoverflow.com/users/5265966/jc-rmb"}, "edited": false, "score": 0, "creation_date": 1576141997, "post_id": 59290029, "comment_id": 104805170, "body": "This problem has caused me to wonder how to proceed and and I didn&#39;t know whether I could ask a further question here in the comments about data types or start a new question. In the end, I asked a new question <a href=\"https://stackoverflow.com/questions/59301051/excel-vba-how-best-to-deal-with-large-whole-numbers\">Q.59301051</a> and I hope that someone may be able to help."}], "owner": {"reputation": 69, "user_id": 5265966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8061a64dfda659e68d38e25d0d9b8dd7?s=128&d=identicon&r=PG&f=1", "display_name": "JC_RMB", "link": "https://stackoverflow.com/users/5265966/jc-rmb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576082184, "creation_date": 1576081223, "last_edit_date": 1576082184, "question_id": 59290029, "link": "https://stackoverflow.com/questions/59290029/excel-vba-strange-problem-with-large-numbers", "title": "Excel VBA - Strange Problem with Large Numbers", "body": "<p>I have the following test code:</p>\n\n<pre><code>Sub TestLoop()\n    Dim LowC As Currency, HighC As Currency, x As Currency, y As Integer\n    Const StepValue = 1000\n    LowC = 1573869207000#\n    HighC = 1573870107000#\n    For x = LowC To HighC Step StepValue\n        y = y + 1\n    Next x\n    MsgBox (1 + ((HighC - LowC) / StepValue) &amp; \"  ,  \" &amp; y)\nEnd Sub\n</code></pre>\n\n<p>In Excel 2016, this produces the \"wrong\" answer - (901, 514). However, if I remove the first digit (1) from LowC and HighC so that they are respectively 573869207000 and 573870107000, I get the \"right\" answer - (901, 901). In Excel 2013, however, I get the \"right\" answer both times.</p>\n\n<p>Does anyone have any idea why this is so? Have I hit some upper limit which is present in Excel 2016 but not in Excel 2013?</p>\n"}, {"tags": ["excel", "vba", "powerquery"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 12519414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f10dc2c23a0df2116ed575cd12304e9b?s=128&d=identicon&r=PG&f=1", "display_name": "Grace2019", "link": "https://stackoverflow.com/users/12519414/grace2019"}, "edited": false, "score": 0, "creation_date": 1576096444, "post_id": 59291425, "comment_id": 104791953, "body": "Hi Szewski, thank you for answering my question. It is not generating the table at all."}, {"owner": {"reputation": 34, "user_id": 10627751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4373a07c608e305bed4b8eaf398fa3ff?s=128&d=identicon&r=PG&f=1", "display_name": "szewski", "link": "https://stackoverflow.com/users/10627751/szewski"}, "reply_to_user": {"reputation": 23, "user_id": 12519414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f10dc2c23a0df2116ed575cd12304e9b?s=128&d=identicon&r=PG&f=1", "display_name": "Grace2019", "link": "https://stackoverflow.com/users/12519414/grace2019"}, "edited": false, "score": 0, "creation_date": 1576100224, "post_id": 59291425, "comment_id": 104793487, "body": "Hi, Please see the update. It is ready to run, test and extend."}], "tags": [], "owner": {"reputation": 34, "user_id": 10627751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4373a07c608e305bed4b8eaf398fa3ff?s=128&d=identicon&r=PG&f=1", "display_name": "szewski", "link": "https://stackoverflow.com/users/10627751/szewski"}, "is_accepted": true, "score": 1, "last_activity_date": 1576100085, "last_edit_date": 1576100085, "creation_date": 1576086543, "answer_id": 59291425, "question_id": 59289949, "link": "https://stackoverflow.com/questions/59289949/using-vba-to-loop-a-column-of-dates-into-the-url-line-for-web-query-and-retrieve/59291425#59291425", "title": "using vba to loop a column of dates into the url line for web query and retrieve an exchange rate table from xe.com/currencytables", "body": "<p>For a test I've changed the url:</p>\n\n<pre><code>    ActiveWorkbook.Queries.Add Name:=\"Table 0 (6)\", Formula:= _\n    \"let\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    Source = Web.Page(Web.Contents(\"\"https://www.xe.com/currencytables/?from=USD&amp;date=\" &amp; Format(DateSerial(2019, 12, 8), \"yyyy-mm-dd\") &amp; \"\"\")),\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    Data0 = Source{0}[Data],\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    #\"\"Changed Type\"\" = Table.TransformColumnTypes(Data0,{{\"\"Currency code\"\", type text}, {\"\"Currency name\"\", type text}, {\"\"Units per USD\"\", type number}, {\"\"USD per Unit\"\", type number}})\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"in\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    #\"\"Changed Type\"\"\"\nActiveWorkbook.Worksheets.Add\n</code></pre>\n\n<p>So under format(dateserial()) you can put your variable with date from the cell.</p>\n\n<p>I've also changed <strong>Currency code ??</strong> and <strong>Currency name ??</strong> to <strong>Currency code</strong> and <strong>Currency name</strong> and edited them manually in power query editor in Excel the same way, as there is a problem with those arrows in column names.</p>\n\n<p>If you would like to generate tables for all dates at once, then you have to solve that issue with arrows in the column name (or it is solved already?).</p>\n\n<p>Next step is to make sure that table names are unique and generated automatically.</p>\n\n<p>Last step would be the for loop to go through cells with dates.</p>\n\n<hr>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>Ok, below you can find updated code. I've deleted column formatting for problematic columns with special characters. Variables for table name and date are created so now it will be extremely easy to extend that code to create tables for how much historic data you want :)</p>\n\n<pre><code>Option Explicit\n\nSub DownloadExchangeRates()\n    'Set variables\n        Dim wb As Workbook\n        Dim wbs As Worksheet\n\n        Dim mydate As Date\n        Dim table_name As String\n        Dim table_display_name As String\n\n        Set wb = ThisWorkbook\n\n        mydate = DateSerial(2019, 12, 7)\n        table_name = \"Table \" &amp; Format(mydate, \"yyyy-mm-dd\")\n        table_display_name = \"Table_\" &amp; Format(mydate, \"yyyy_mm_dd\")\n\n    ' Create connection\n        wb.Queries.Add _\n            Name:=table_name, _\n            Formula:= _\n            \"let\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n            \"    Source = Web.Page(Web.Contents(\"\"https://www.xe.com/currencytables/?from=USD&amp;date=\" &amp; Format(mydate, \"yyyy-mm-dd\") &amp; \"\"\")),\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n            \"    Data0 = Source{0}[Data],\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n            \"    #\"\"Changed Type\"\" = Table.TransformColumnTypes(Data0,{{\"\"Units per USD\"\", type number}, {\"\"USD per Unit\"\", type number}})\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n            \"in\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n            \"    #\"\"Changed Type\"\"\"\n\n    'Create new worksheet\n        wb.Worksheets.Add\n        Set wbs = wb.ActiveSheet\n        wbs.Name = \"Currency for \" &amp; Format(mydate, \"yyyy-mm-dd\")\n\n        With wbs.ListObjects.Add(SourceType:=0, Source:= _\n            \"OLEDB;Provider=Microsoft.Mashup.OleDb.1;Data Source=$Workbook$;Location=\" &amp; \"\"\"\" &amp; table_name &amp; \"\"\"\" &amp; \";Extended Properties=\"\"\"\"\" _\n            , Destination:=Range(\"$A$1\")).QueryTable\n            .CommandType = xlCmdSql\n            .CommandText = Array(\"SELECT * FROM [\" &amp; table_name &amp; \"]\")\n            .RowNumbers = False\n            .FillAdjacentFormulas = False\n            .PreserveFormatting = True\n            .RefreshOnFileOpen = False\n            .BackgroundQuery = True\n            .RefreshStyle = xlInsertDeleteCells\n            .SavePassword = False\n            .SaveData = True\n            .AdjustColumnWidth = True\n            .RefreshPeriod = 0\n            .PreserveColumnInfo = True\n            .ListObject.DisplayName = table_display_name\n            .Refresh BackgroundQuery:=False\n        End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 12519414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f10dc2c23a0df2116ed575cd12304e9b?s=128&d=identicon&r=PG&f=1", "display_name": "Grace2019", "link": "https://stackoverflow.com/users/12519414/grace2019"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 59291425, "answer_count": 1, "score": 2, "last_activity_date": 1576100085, "creation_date": 1576080939, "last_edit_date": 1576081894, "question_id": 59289949, "link": "https://stackoverflow.com/questions/59289949/using-vba-to-loop-a-column-of-dates-into-the-url-line-for-web-query-and-retrieve", "title": "using vba to loop a column of dates into the url line for web query and retrieve an exchange rate table from xe.com/currencytables", "body": "<p>I have a column of dates (in Excel spreadsheet) and would like to insert these dates into the url line in the web query to generate an exchange rate tables which I would like to put them in the spreadsheets. For example: </p>\n\n<p>Column A\n2019-12-09\n2019-12-08\n2019-12-07</p>\n\n<p>For each of these dates in column A, I would like insert them into the url line: \nBelow is a recorded VBA macro using --Get Data, from Web. Then I copy and paste the <a href=\"https://www.xe.com/currencytables/?from=USD&amp;date=2019-12-10\" rel=\"nofollow noreferrer\">https://www.xe.com/currencytables/?from=USD&amp;date=2019-12-10</a> into the url(pop up window), hit ok and choose table 0 to generate an exchange rate table for the date 2019-12-10. I would like to automate this process and use the dates in Column A. I don't have any experience in power query. Thank you for your help in advance. </p>\n\n<pre><code>Sub Macro2()\n'\n' Macro2 Macro\n'\n\n'\n    ActiveWorkbook.Queries.Add Name:=\"Table 0 (6)\", Formula:= _\n        \"let\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    Source = Web.Page(Web.Contents(\"\"https://www.xe.com/currencytables/?from=USD&amp;date=2019-12-08\"\")),\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    Data0 = Source{0}[Data],\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    #\"\"Changed Type\"\" = Table.TransformColumnTypes(Data0,{{\"\"Currency code ??\"\", type text}, {\"\"Currency name ??\"\", type text}, {\"\"Units per USD\"\", type number}, {\"\"USD per Unit\"\", type number}})\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"in\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    #\"\"Changed Type\"\"\"\n    ActiveWorkbook.Worksheets.Add\n    With ActiveSheet.ListObjects.Add(SourceType:=0, Source:= _\n        \"OLEDB;Provider=Microsoft.Mashup.OleDb.1;Data Source=$Workbook$;Location=\"\"Table 0 (6)\"\";Extended Properties=\"\"\"\"\" _\n        , Destination:=Range(\"$A$1\")).QueryTable\n        .CommandType = xlCmdSql\n        .CommandText = Array(\"SELECT * FROM [Table 0 (6)]\")\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .BackgroundQuery = True\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .PreserveColumnInfo = True\n        .ListObject.DisplayName = \"Table_0__6\"\n        .Refresh BackgroundQuery:=False\n    End With\n\nEnd Sub\n\n</code></pre>\n"}, {"tags": ["vba", "image", "ms-access"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1576080657, "post_id": 59289718, "comment_id": 104784664, "body": "Does it work as expected with locally-saved images?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1576080977, "post_id": 59289718, "comment_id": 104784833, "body": "@ashleedawg: The files are downloaded, thus local."}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1576081217, "post_id": 59289718, "comment_id": 104784959, "body": "is <code>Me.ImgPeoplePic.Picture = ImgDwnld</code> being hit when you debug your code?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1576081352, "post_id": 59289718, "comment_id": 104785031, "body": "You could bind the picture control as suggested in the article. Then all you need is to  include the function in your query: <code>Select *, UrlContent(0, [Url]) As Path From SomeTable;</code>."}, {"owner": {"reputation": 487, "user_id": 729474, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/a8e32e28c2361f6bf5465e39c0a68987?s=128&d=identicon&r=PG", "display_name": "missscripty", "link": "https://stackoverflow.com/users/729474/missscripty"}, "edited": false, "score": 0, "creation_date": 1576081533, "post_id": 59289718, "comment_id": 104785122, "body": "Yes, when I hit the If FileExists(ImgDwnld) Then with a break point, the imgDnwnld has the path to the file, and yes, when I step into the code, Me.ImgPeoplePic.Picture = ImgDwnld gets hit."}, {"owner": {"reputation": 487, "user_id": 729474, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/a8e32e28c2361f6bf5465e39c0a68987?s=128&d=identicon&r=PG", "display_name": "missscripty", "link": "https://stackoverflow.com/users/729474/missscripty"}, "edited": false, "score": 0, "creation_date": 1576081603, "post_id": 59289718, "comment_id": 104785153, "body": "Gustav, are you saying I need to save the path to a table?  That makes this way more complicated in that I really don&#39;t need to store that in a table. This is not my schema, so I&#39;m doing what I can to not change things and just develop the interface."}, {"owner": {"reputation": 487, "user_id": 729474, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/a8e32e28c2361f6bf5465e39c0a68987?s=128&d=identicon&r=PG", "display_name": "missscripty", "link": "https://stackoverflow.com/users/729474/missscripty"}, "edited": false, "score": 1, "creation_date": 1576085488, "post_id": 59289718, "comment_id": 104787087, "body": "I got it!  I was trying to get the .picture property to update, and it was. I also tried setting the control source. It&#39;s a property on the image, but you can&#39;t reference in VBA, but it is there, and it was set to = &quot;\\\\path\\etc\\noimage.jpg&quot; so with that not changing, the pic didn&#39;t change.  I cleared that out and now the picture changes perfectly!!!!"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1576085672, "post_id": 59289718, "comment_id": 104787187, "body": "No, save the Url of the picture if you can&#39;t build it like you did. In your case just use<code>Me.ImgPeoplePic.Picture = UrlContent(0, PeoplePic)</code>.<code>UrlContent</code> handles the download without a local temp file if you ommit a path."}, {"owner": {"reputation": 487, "user_id": 729474, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/a8e32e28c2361f6bf5465e39c0a68987?s=128&d=identicon&r=PG", "display_name": "missscripty", "link": "https://stackoverflow.com/users/729474/missscripty"}, "edited": false, "score": 1, "creation_date": 1576086245, "post_id": 59289718, "comment_id": 104787443, "body": "One note, in case this helps someone else, the line : Private Declare Function URLDownloadToFile Lib &quot;Urlmon&quot; Alias &quot;URLDownloadToFileA&quot; had to be updated to Private Declare PtrSafe Function URLDownloadToFile Lib &quot;Urlmon&quot; Alias &quot;URLDownloadToFileA&quot;  If you are working with 64 bit office."}], "owner": {"reputation": 487, "user_id": 729474, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/a8e32e28c2361f6bf5465e39c0a68987?s=128&d=identicon&r=PG", "display_name": "missscripty", "link": "https://stackoverflow.com/users/729474/missscripty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1582132905, "creation_date": 1576080098, "last_edit_date": 1582132905, "question_id": 59289718, "link": "https://stackoverflow.com/questions/59289718/ms-access-vba-dynamically-show-pics-from-url", "title": "MS Access VBA Dynamically Show Pics From URL", "body": "<p>I found this code from here:\n<a href=\"https://www.experts-exchange.com/articles/29679/Show-pictures-directly-from-URLs-in-Access-forms-and-reports.html\" rel=\"nofollow noreferrer\">Show Pictures Directly From URLs in Access Forms and Reports</a></p>\n\n<p>I have this code on my form:</p>\n\n<pre><code>Public Function PeopleImage()\n'FUNCTION TO SET THE IMGPEOPLEPIC WITH THE CURRENT PERSON'S PHOTO, IF THE PHOTO CAN BE FOUND. OTHERWISE A STOCK IMAGE SAYING NO PIC FOUND WILL SHOW\n    Dim PeoplePic As String\n    Dim NoPeoplePic As String\n    Dim ImgDwnld As String\n\n    PeoplePic = \"https://TheWebAddress.com/People%20Photos/\" &amp; Nz(Me.PersonID, 0) &amp; \".jpg\"\n    ImgDwnld = \"\\\\AppServer\\AppDir\\Storage\\Images\\\" &amp; Nz(Me.PersonID, 0) &amp; \".jpg\"\n    DownloadFile PeoplePic, ImgDwnld, False\n    NoPeoplePic = \"\\\\AppServer\\AppDir\\Storage\\NoPeoplePic.jpg\"\n\n    If FileExists(ImgDwnld) Then\n        Me.ImgPeoplePic.Picture = ImgDwnld\n    Else\n        Me.ImgPeoplePic.Picture = NoPeoplePic\n    End If\n\n    Me.ImgPeoplePic.Requery\n\nEnd Function\n</code></pre>\n\n<p>When I added the image control ImgPeoplePic I set it to the NoPeoplePic, so that a picture would be set.  Now, when I load the form and navigate, it looks like the photo is reloading (it blinks), but it just keeps showing the stock NoPeoplePic. </p>\n\n<p>Anyone know what I'm missing? I feel like I'm so close. I just don't understand what it's not putting in the image that it downloads.  I verified that the image downloads to the directory, and that it is there.  I debug the path and image and it pulls up with no problem. </p>\n\n<p>Any help is appreciated!</p>\n"}, {"tags": ["vba", "ms-word", "external", "userform", "caption"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1576080748, "post_id": 59289538, "comment_id": 104784709, "body": "@Warcupine the <code>Vs_Label</code> argument is (implicitly) passed <code>ByRef</code>, so the caller <i>does</i> see the new value."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576080880, "post_id": 59289538, "comment_id": 104784780, "body": "The claim makes no sense, there&#39;s no way the 2nd call to <code>ChangeLabel</code> can ever result in the caption being anything other than &quot;something else&quot;. OP must have left an important piece out of the picture here."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1576081396, "post_id": 59289538, "comment_id": 104785053, "body": "The second call does not pass a variable to the function but a property. Might be the reason. The property return a temporary variant/string witch is then passed to the sub, so only the temp variable is modified, not the property value."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1576081432, "post_id": 59289538, "comment_id": 104785071, "body": "@VincentG that is correct. The <code>ByRef</code> pointer is effectively lost, and the 2nd call has no side-effect whatsoever."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576082598, "post_id": 59289538, "comment_id": 104785663, "body": "Side note, a procedure whose job is to get the caption for a label on some form, should probably be in that form&#39;s code-behind. Keep UI concerns in UI code!"}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 2132940, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ce47073293e33b7ec1aa14024e11d006?s=128&d=identicon&r=PG", "display_name": "Marcel", "link": "https://stackoverflow.com/users/2132940/marcel"}, "edited": false, "score": 0, "creation_date": 1576083731, "post_id": 59290079, "comment_id": 104786235, "body": "Thanks, Mathieu. Am I right in understanding, that there is no way of directly changing the values of UserForm controlls with an outside procedure, by passing them on as parameters?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 157, "user_id": 2132940, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ce47073293e33b7ec1aa14024e11d006?s=128&d=identicon&r=PG", "display_name": "Marcel", "link": "https://stackoverflow.com/users/2132940/marcel"}, "edited": false, "score": 0, "creation_date": 1576083863, "post_id": 59290079, "comment_id": 104786292, "body": "When you pass <code>foo.Bar</code> as an argument to a procedure that receives a <code>ByRef</code> parameter, the <code>ByRef</code> assignment cannot be made, because you&#39;re passing <b>the value</b> of <code>foo.Bar</code>, not a pointer to the <code>Bar</code> property of the <code>foo</code> object."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 157, "user_id": 2132940, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ce47073293e33b7ec1aa14024e11d006?s=128&d=identicon&r=PG", "display_name": "Marcel", "link": "https://stackoverflow.com/users/2132940/marcel"}, "edited": false, "score": 0, "creation_date": 1576083924, "post_id": 59290079, "comment_id": 104786329, "body": "That said, UI concerns should be handled in UI code - a standard module has no business doing anything with some form&#39;s labels, or any other control for that matter."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 3, "last_activity_date": 1576081835, "last_edit_date": 1576081835, "creation_date": 1576081401, "answer_id": 59290079, "question_id": 59289538, "link": "https://stackoverflow.com/questions/59289538/vba-passing-userform-controls-as-parameters/59290079#59290079", "title": "VBA passing userform controls as parameters", "body": "<blockquote>\n<pre><code>Sub ChangeLabel(Vs_Label)\n</code></pre>\n</blockquote>\n\n<p>First, let's make things clearer by making all the modifiers and types explicit.</p>\n\n<pre><code>Public Sub ChangeLabel(ByRef Vs_Label As Variant)\n</code></pre>\n\n<p>We're given a local variable named <code>Vs_Label</code>, whose initial value is <code>vbNullString</code>.</p>\n\n<blockquote>\n<pre><code>Dim Vs_Label as String\nLabel_S.Caption = \"something\"\n</code></pre>\n</blockquote>\n\n<p>At this point <code>Vs_Label</code> is still <code>vbNullString</code>, and <code>Label_S.Caption</code> is \"something\".</p>\n\n<blockquote>\n<pre><code>Call ChangeLabel(Vs_Label)\n</code></pre>\n</blockquote>\n\n<p>Now we're passing the <code>Vs_Label</code> variable pointer to the procedure, which assigns it to \"something else\". Note that this would be equivalent, and arguably cleaner code:</p>\n\n<pre><code>ChangeLabel Vs_Label\n</code></pre>\n\n<p>After this statement returns, <code>Vs_Label</code> is \"somethign else\", and <code>Label_S.Caption</code> is still \"something\".</p>\n\n<blockquote>\n<pre><code>Label_S.Caption = Vs_Label\n</code></pre>\n</blockquote>\n\n<p>Now both <code>Vs_Label</code> and <code>Label_S.Caption</code> contain \"something else\".</p>\n\n<blockquote>\n<pre><code>Call ChangeLabel(Label_S.Caption)\n</code></pre>\n</blockquote>\n\n<p>This call is different now: we're not passing in a variable reference, but a member expression.</p>\n\n<p>So the member expression gets evaluated (\"something else\"), and a reference to <em>that value</em> (which the caller isn't holding on to) is passed to the procedure, which assigns it to \"something else\" (no change), ...and then the reference is discarded: the 2nd call has no effect whatsoever.</p>\n\n<p>So at the end of the procedure both <code>Vs_Label</code> and <code>Label_S.Caption</code> are both \"something else\".</p>\n\n<p>In order for the <code>Caption</code> of the label to be \"something\", at the end of that code, you'd need to have different code.</p>\n\n<p>Place a breakpoint near the top of the procedure (F9), run the code, and use F8 to step through and inspect your labels and variables as you go: you'll find that this code has nothing to do with why the label says \"something\".</p>\n\n<p>Verify what instance of the form you're working with, in the two places you're looking - and make sure both places are working with the same object instance. The <code>Activate</code> handler will run <em>every time the form is activated</em> - if the form isn't being shown as a modal dialog, then this could be multiple times per instance.</p>\n"}], "owner": {"reputation": 157, "user_id": 2132940, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ce47073293e33b7ec1aa14024e11d006?s=128&d=identicon&r=PG", "display_name": "Marcel", "link": "https://stackoverflow.com/users/2132940/marcel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 59290079, "answer_count": 1, "score": 2, "last_activity_date": 1576082369, "creation_date": 1576079599, "last_edit_date": 1576082369, "question_id": 59289538, "link": "https://stackoverflow.com/questions/59289538/vba-passing-userform-controls-as-parameters", "title": "VBA passing userform controls as parameters", "body": "<p>I want to have the <code>.Caption</code> of a userform label modified by a Sub which is located in another module.</p>\n\n<pre><code>  Private Sub UserForm_Activate()\n\n    Dim Vs_Label as string\n    Label_S.Caption = \"something\"\n\n    Call ChangeLabel(Vs_Label)\n    Label_S.Caption = Vs_Label\n\n    Call ChangeLabel(Label_S.Caption)\n  end\n\n  Sub ChangeLabel(Vs_Label)\n    Vs_Label = \"something else\"\n  end\n\n</code></pre>\n\n<p>The 1st time the procedure is called, it returns <code>Vs_Label</code> = \"something else\".\nThe 2nd time the procedure is called it returns <code>Label_S.Capiton</code>= \"something\".</p>\n\n<p>Can someone explain to me what is happening here?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1576079630, "post_id": 59289437, "comment_id": 104784052, "body": "This would be a lot easier to figure out with some sample data and the expected result. Can you <a href=\"https://stackoverflow.com/posts/59289437/edit\">edit your question</a> to provide this?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user12431753"}, "edited": false, "score": 0, "creation_date": 1576084540, "post_id": 59289437, "comment_id": 104786614, "body": "<code>InStr</code> gives you first, <code>InStrRev</code> gives you last."}], "answers": [{"tags": [], "owner": {"reputation": 34, "user_id": 10627751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4373a07c608e305bed4b8eaf398fa3ff?s=128&d=identicon&r=PG&f=1", "display_name": "szewski", "link": "https://stackoverflow.com/users/10627751/szewski"}, "is_accepted": false, "score": 0, "last_activity_date": 1576089730, "creation_date": 1576089730, "answer_id": 59292129, "question_id": 59289437, "link": "https://stackoverflow.com/questions/59289437/how-do-i-find-the-first-and-last-occurrence-of-a-string-in-a-row/59292129#59292129", "title": "How do I find the first and last occurrence of a string in a row?", "body": "<p>Simplest way is to create small for loop to go through your 8 columns of data (AI to AP) and find first and the last occurrence of \"Y\" and check if that is very time consuming. But with manual calculation and screen updating off it should not be so long.\nBelow you can find simple sub ready for testing.</p>\n\n<pre><code>Option Explicit\n\nSub test()\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n\n    Dim t#: t = Timer\n    Dim wbs As Worksheet\n    Dim x As Long\n    Dim col As Integer\n    Dim startposition As Integer\n    Dim endposition As Integer\n\n    Set wbs = ActiveSheet\n\n\n    With wbs\n        For x = 1 To 7000\n            startposition = 0\n            For col = 35 To 42\n                If .Range(.Cells(x, col), .Cells(x, col)).Value = \"Y\" And startposition = 0 Then\n                    startposition = col\n                ElseIf .Range(.Cells(x, col), .Cells(x, col)).Value = \"Y\" And startposition &lt;&gt; 0 Then\n                    endposition = col\n                End If\n            Next col\n        Next x\n    End With\n\n    Debug.Print Timer - t\n\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>My score is 0,57s on empty sheet. You can analyze that code and maybe implement that loop. For x loop is just a simulation of your 7000 rows.</p>\n"}], "owner": {"reputation": 127, "user_id": 5977580, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10100625512036166/picture?type=large", "display_name": "AP1", "link": "https://stackoverflow.com/users/5977580/ap1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1576089730, "creation_date": 1576079303, "last_edit_date": 1576082694, "question_id": 59289437, "link": "https://stackoverflow.com/questions/59289437/how-do-i-find-the-first-and-last-occurrence-of-a-string-in-a-row", "title": "How do I find the first and last occurrence of a string in a row?", "body": "<p>I have a workbook that has a few thousand rows where I need to identify the first and last occurrence of \"Y\" for each row. (These characters are tied to specific dates depending on the column they fall into). I have to find the start and stop of these characters because it will give me the start and stop dates of each task. So far I have tried this:</p>\n\n<pre><code>Public Sub import_gbs()\nDim wb As Workbook\nDim gbs_wb As Workbook\nDim gbs_bg As Worksheet\nDim gbs_drivers As Worksheet\nDim bg As Worksheet\nDim dict As Scripting.Dictionary\nDim date_array() As String\nDim x As Long\nDim i As Long\nDim switch As Integer\nDim start_position As Integer\nDim stop_position As Integer    \n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\nApplication.EnableEvents = False\nApplication.Calculation = xlCalculationManual\nApplication.TransitionNavigKeys = False\n\nSet wb = ThisWorkbook\nSet bg = wb.Sheets(\"Current EDGE\")\nApplication.AutomationSecurity = msoAutomationSecurityForceDisable\nSet gbs_wb = Workbooks.Open(\"C:\\SOME PATH HERE\\\")\nApplication.AutomationSecurity = msoAutomationSecurityByUI\nSet gbs_bg = gbs_wb.Sheets(\"CC Input\")\nSet gbs_drivers = gbs_wb.Sheets(\"Drivers\")\nSet dict = New Scripting.Dictionary '''\n\ndict.Add \"SU YN Start\", gbs_drivers.Cells(9, 5).Value\ndict.Add \"SU YN Stop\", gbs_drivers.Cells(9, 6).Value\ndict.Add \"EPMP1 YN Start\", gbs_drivers.Cells(10, 5).Value\ndict.Add \"EPMP1 YN Stop\", gbs_drivers.Cells(10, 6).Value\ndict.Add \"EPMP2 YN Start\", gbs_drivers.Cells(11, 5).Value\ndict.Add \"EPMP2 YN Stop\", gbs_drivers.Cells(11, 6).Value\ndict.Add \"RC YN Start\", gbs_drivers.Cells(12, 5).Value\ndict.Add \"RC YN Stop\", gbs_drivers.Cells(12, 6).Value\ndict.Add \"ON YN Start\", gbs_drivers.Cells(13, 5).Value\ndict.Add \"ON YN Stop\", gbs_drivers.Cells(13, 6).Value\ndict.Add \"FU YN Start\", gbs_drivers.Cells(14, 5).Value\ndict.Add \"FU YN Stop\", gbs_drivers.Cells(14, 6).Value\ndict.Add \"DB Lock YN Start\", gbs_drivers.Cells(15, 5).Value\ndict.Add \"DB Lock YN Stop\", gbs_drivers.Cells(15, 6).Value\ndict.Add \"CO/Reporting YN Start\", gbs_drivers.Cells(16, 5).Value\ndict.Add \"CO/Reporting YN Stop\", gbs_drivers.Cells(16, 6).Value\n\ni = 2\nFor x = 3 To 9543\n    If gbs_bg.Cells(x, 25).Value &gt; 0 Then\n        start_position = gbs_bg.Range(\"AI\" &amp; x &amp; \":\" &amp; \"AP\" &amp; x).Find(what:=\"Y\", lookat:=xlWhole, searchdirection:=xlNext).Column\n        stop_position = gbs_bg.Range(\"AI\" &amp; x &amp; \":\" &amp; \"AP\" &amp; x).Find(what:=\"Y\", lookat:=xlWhole, searchdirection:=xlPrevious).Column\n\n        Select Case start_position\n        Case 35\n            gbs_bg.Cells(x, 65).Value = dict(\"SU YN Start\")\n        Case 36\n            gbs_bg.Cells(x, 65).Value = dict(\"EPMP1 YN Start\")\n        Case 37\n            gbs_bg.Cells(x, 65).Value = dict(\"EPMP2 YN Start\")\n        Case 38\n            gbs_bg.Cells(x, 65).Value = dict(\"RC YN Start\")\n        Case 39\n            gbs_bg.Cells(x, 65).Value = dict(\"ON YN Start\")\n        Case 40\n            gbs_bg.Cells(x, 65).Value = dict(\"FU YN Start\")\n        Case 41\n            gbs_bg.Cells(x, 65).Value = dict(\"DB Lock YN Start\")\n        Case 42\n            gbs_bg.Cells(x, 65).Value = dict(\"CO/Reporting YN Start\")\n        End Select\n\n        Select Case stop_position\n        Case 35\n            gbs_bg.Cells(x, 66).Value = dict(\"SU YN Stop\")\n        Case 36\n            gbs_bg.Cells(x, 66).Value = dict(\"EPMP1 YN Stop\")\n        Case 37\n            gbs_bg.Cells(x, 66).Value = dict(\"EPMP2 YN Stop\")\n        Case 38\n            gbs_bg.Cells(x, 66).Value = dict(\"RC YN Stop\")\n        Case 39\n            gbs_bg.Cells(x, 66).Value = dict(\"ON YN Stop\")\n        Case 40\n            gbs_bg.Cells(x, 66).Value = dict(\"FU YN Stop\")\n        Case 41\n            gbs_bg.Cells(x, 66).Value = dict(\"DB Lock YN Stop\")\n        Case 42\n            gbs_bg.Cells(x, 66).Value = dict(\"CO/Reporting YN Stop\")\n        End Select\n\n        i = i + 1\n    End If\n Next x\n</code></pre>\n\n<p>So this is working for me most of the time. There are some really weird instances on a handful of rows where there is a \"Y\" present in column 35, but the find misses it and picks up the next instance of \"Y\" in that row. Out of the 7,000+ rows, this only happens a handful of times and always in column 35 (but most of the time it finds the \"Y\" in that column of that row if it is there). This obviously messes up my dates for those rows. I have no idea what it could be. I have tried debugging by checking the length and value of the cell where the \"Y\" is that the find is missing. But that returns as 1 and with the value of \"Y\". I've tried switching between searching in values and formulas, that doesn't work either. </p>\n\n<p>So I need to find a new way to find the occurrences. I was thinking that since I know vba does recognize the length of the value of each cell correctly, I could build off of that. But I'm not sure how to begin. Any help would be appreciated. Thanks!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1576133529, "post_id": 59291064, "comment_id": 104801660, "body": "Welcome to SO! Please take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. You should try <a href=\"http://rubberduckvba.com/\" rel=\"nofollow noreferrer\">RubberduckVBA</a> to get useful hinrs to improve your code. E.g.<code>Rows</code>refers implicit to<code>ActiveSheet</code> and the If conditions are obsolete. Just use <code>Rows(69).Hidden = sItem.Selected</code>"}, {"owner": {"reputation": 1, "user_id": 12519387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89b159988771fd944ad9e39d4b3dd137?s=128&d=identicon&r=PG&f=1", "display_name": "user12519387", "link": "https://stackoverflow.com/users/12519387/user12519387"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1581955857, "post_id": 59291064, "comment_id": 106601387, "body": "@ComputerVersteher Thank you so much, I changed the code to that simpler method and it works. I have another issue though, and am editing the issue to explain. If you have any ideas on that, I would really appreciate it."}], "tags": [], "owner": {"reputation": 1, "user_id": 12519387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89b159988771fd944ad9e39d4b3dd137?s=128&d=identicon&r=PG&f=1", "display_name": "user12519387", "link": "https://stackoverflow.com/users/12519387/user12519387"}, "is_accepted": false, "score": 0, "last_activity_date": 1576085068, "creation_date": 1576085068, "answer_id": 59291064, "question_id": 59289407, "link": "https://stackoverflow.com/questions/59289407/hide-unhide-a-row-when-a-slicer-is-selected-deselected/59291064#59291064", "title": "Hide/unhide a row when a slicer is selected/deselected", "body": "<p>I was able to fix the issue with this code:</p>\n\n<pre><code>Sub Worksheet_PivotTableUpdate _\n    (ByVal Target As PivotTable)\n\nDim cache As Excel.SlicerCache\nSet cache = ActiveWorkbook.SlicerCaches(\"Slicer_Region1\")\nDim sItem As Excel.SlicerItem\n\nFor Each sItem In cache.SlicerItems\n    If sItem.Selected = True Then\n    Rows(69).Hidden = True\n    End If\n\n    If sItem.Selected = False Then\n    Rows(69).Hidden = False\n    End If\n\nNext\n\nEnd Sub\n</code></pre>\n\n<p>Hope this helps someone down the line.</p>\n"}], "owner": {"reputation": 1, "user_id": 12519387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89b159988771fd944ad9e39d4b3dd137?s=128&d=identicon&r=PG&f=1", "display_name": "user12519387", "link": "https://stackoverflow.com/users/12519387/user12519387"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1581956747, "creation_date": 1576079227, "last_edit_date": 1581956747, "question_id": 59289407, "link": "https://stackoverflow.com/questions/59289407/hide-unhide-a-row-when-a-slicer-is-selected-deselected", "title": "Hide/unhide a row when a slicer is selected/deselected", "body": "<p>I am creating a nested slicer view in a dashboard where two slicers will be right on top of each other in two different rows in Excel.</p>\n\n<p>I want when any options in Slicer1 are selected, to unhide the row that Slicer2 is on. When all options are once again deselected in Slicer1, resetting it to show all data, I would like to once again hide the row that slicer 2 is on.</p>\n\n<p>I have used macro toggles in the past to hide/unhide rows, but I cannot find a solution for this problem.</p>\n\n<p>Edit 2/17/2020</p>\n\n<p>I have another issue that I have encountered. I am using this code on a couple of different tabs. One tab works fine - it is setup to call the macro from a module when the pivot updates, and the pivot is on another sheet from the slicer. </p>\n\n<p>The other one has the pivot on the same sheet that is being updated instead of a different one (I'm not sure that matters). I have the setup the same though - when that pivot updates, it calls the macro. The problem is that there is one region in the slicer, the last one, that does not work. I have 12 regions, and when I select any of them except the one, I get the target row unhidden. When I clear the filters, it hides again. But this one region behaves like I am clearing them all. If the row is already hidden, nothing happens, but if the row is already showing, then it hides it. Here is the current code:</p>\n\n<pre><code>Sub Hide_Unhide_facility2()\n\nApplication.ScreenUpdating = False\n\nDim cache As Excel.SlicerCache\nDim sht As Worksheet\nDim sItem As Excel.SlicerItem\n\nSet cache = ActiveWorkbook.SlicerCaches(\"Slicer_Region2\")\n\nFor Each sItem In cache.SlicerItems\nRows(10).Hidden = sItem.Selected\n\nNext\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "mouseevent"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576079784, "post_id": 59289193, "comment_id": 104784136, "body": "You&#39;ll need a variable outside of procedure scope to &quot;remember&quot; what the previous click was. There are dozens of ways to do this..."}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1576080003, "post_id": 59289193, "comment_id": 104784265, "body": "I&#39;m not sure how to do this specifically in PPT, but generally you will want an <code>onclick</code> to call a function that sets a public variable to the name of the shape that called the function. Then when you click a different shape check the last shapes name against the new shapes name and see if there is a match. You will probably need  a delimiter or something to split on to get the match."}], "owner": {"reputation": 3, "user_id": 12367909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77062f7e28ee0414c595c58a2faf10c0?s=128&d=identicon&r=PG&f=1", "display_name": "MetalBrush", "link": "https://stackoverflow.com/users/12367909/metalbrush"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576078461, "creation_date": 1576078461, "question_id": 59289193, "link": "https://stackoverflow.com/questions/59289193/vba-check-for-consecutive-clicks", "title": "VBA - Check for consecutive clicks", "body": "<p>I\u00b4m completely new to VBA and thus would like to be informed:\nI am working on a PPT that has a sort of Memory Game build in. \nTo make it more interactive I decided to write a function that checks whether the links on two SmartArt-Nodes have been clicked consecutively, which will then delete these two Nodes, if the condition is met.</p>\n\n<pre><code>Function checkIfMatch(Node1 As SmartArtNode, Node2 As SmartArtNode)\nIf()\n    Node1.Delete\n    Node2.Delete\nEnd Function\n</code></pre>\n\n<p>Does somebody have an idea to solve this problem?</p>\n"}, {"tags": ["excel", "vba", "autofilter"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1576077197, "post_id": 59288808, "comment_id": 104782548, "body": "Variables <code>Fiscal1</code> and <code>Fiscal2</code> should not be inside quotes."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1576077201, "post_id": 59288808, "comment_id": 104782553, "body": "<code>Case Is = 12</code>? Do you mean <code>Case 0</code>, <code>Case 12</code>?  Also <code>Criteria1:=&quot;&gt;= Fiscal1&quot;</code> should just be <code>Criteria1:=&quot;&gt;=&quot; &amp; Fiscal1</code> (same for <code>Fidscal2</code>&#39;s criteria)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1576078170, "post_id": 59288808, "comment_id": 104783188, "body": "@BruceWayne while very off-putting and weird-looking, <code>Case Is = {literal}</code> is actually valid. I never understood the appeal of it over <code>Case {literal}</code>, but presumably it stems from the VBE &quot;autocorrecting&quot; <code>Case = 0</code> to <code>Case Is = 0</code>."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576078302, "post_id": 59288808, "comment_id": 104783257, "body": "@MathieuGuindon - That is indeed very weird, but good to know!  (I would bet <a href=\"https://rubberduckvba.com/\" rel=\"nofollow noreferrer\">RubberDuck</a> picks up the <code>Case Is = ...</code> and suggests just <code>Case = </code>?  :D   )"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1576079693, "post_id": 59288808, "comment_id": 104784086, "body": "@BruceWayne it doesn&#39;t... <a href=\"https://github.com/rubberduck-vba/Rubberduck/issues/5317\" rel=\"nofollow noreferrer\">for now</a> ;-)"}], "owner": {"reputation": 1, "user_id": 12519095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8014a07e186ce0349bf21178481a2ca5?s=128&d=identicon&r=PG&f=1", "display_name": "ToolingJoe", "link": "https://stackoverflow.com/users/12519095/toolingjoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576078044, "creation_date": 1576077094, "last_edit_date": 1576078044, "question_id": 59288808, "link": "https://stackoverflow.com/questions/59288808/filtering-table-between-2-dates-excel-vba", "title": "Filtering table between 2 dates Excel VBA", "body": "<p>I am attempting to filter a table in excel using VBA. I feel like I'm pretty close but for some reason its not displaying any data after it gets filtered.  Here is a sample of what I am currently trying:</p>\n\n<pre><code>Dim Fiscal1 As Variant, Fiscal2 As Variant\n\nFiscal1 = ws2.Range(\"v13\")\nFiscal2 = ws2.Range(\"W13\")\n\nx = MonthBox.ListIndex\n\nSelect Case x\n    Case Is = 0\n        ws.ListObjects(\"Table1\").Range.AutoFilter Field:=3\n.\n.\n.\n Case Is = 12\n     ws.ListObjects(\"Table1\").Range.AutoFilter Field:=3, Criteria1:=\"&gt;= Fiscal1\", Operator:= _\n     xlAnd, Criteria2:=\"&lt;= Fiscal2\"\n</code></pre>\n\n<p>The values in the range cells are dates (11/25/2019 and 12/31/2019 respectively) and they are formatted as dates as well.  </p>\n"}, {"tags": ["excel", "vba", "filtering"], "answers": [{"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 0, "last_activity_date": 1576079280, "last_edit_date": 1576079280, "creation_date": 1576078845, "answer_id": 59289295, "question_id": 59288689, "link": "https://stackoverflow.com/questions/59288689/autifiltering-in-excel-with-vba-using-textboxes/59289295#59289295", "title": "Autifiltering in Excel with VBA using Textboxes", "body": "<p>Are you looking for something like that</p>\n\n<pre><code>Private Sub TextBox1_Change()\n    filterTextboxes\nEnd Sub\n\nPrivate Sub TextBox2_Change()\n    filterTextboxes\nEnd Sub\n\nPrivate Sub filterTextboxes()    \n\n    If Len(TextBox1.Value) = 0 And Len(TextBox2.Value) = 0 Then\n        Sheet1.AutoFilterMode = False\n    Else\n        If Sheet1.AutoFilterMode = True Then\n            Sheet1.AutoFilterMode = False\n        End If\n\n        Sheet1.Range(\"A2:C\" &amp; Rows.Count).AutoFilter Field:=1, Criteria1:=\"*\" &amp; _\n            TextBox1.Value &amp; \"*\", Operator:=xlAnd\n        Sheet1.Range(\"A2:C\" &amp; Rows.Count).AutoFilter Field:=2, Criteria1:=\"*\" &amp; _\n            TextBox2.Value &amp; \"*\", Operator:=xlAnd\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11186799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54e84f530858719916bc32abcc202d09?s=128&d=identicon&r=PG&f=1", "display_name": "G.Scharfe", "link": "https://stackoverflow.com/users/11186799/g-scharfe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 59289295, "answer_count": 1, "score": 0, "last_activity_date": 1576079280, "creation_date": 1576076765, "question_id": 59288689, "link": "https://stackoverflow.com/questions/59288689/autifiltering-in-excel-with-vba-using-textboxes", "title": "Autifiltering in Excel with VBA using Textboxes", "body": "<p>Hi I am new to VBA and I have pieced this together so far and I ended up getting it to work but not 100%.</p>\n\n<p>I am trying to use multiple text boxes to auto-filter data. currently I am only using 2 for testing purposes but would like to eventually extend it to 4. Each one textbox currently filters but overrides tyhe other, where I want them to work together, so if I put a word in the first text box it will return all instances in that column that contain that word, and then wheen I add a word to the second it will filter those results even further,</p>\n\n<pre><code>Private Sub TextBox1_Change()\n\nIf Len(TextBox1.Value) = 0 Then\n        Sheet1.AutoFilterMode = False\nElse\n    If Sheet1.AutoFilterMode = True Then\n        Sheet1.AutoFilterMode = False\n    End If\n\nSheet1.Range(\"A2:C\" &amp; Rows.Count).AutoFilter field:=1, Criteria1:=\"*\" &amp; TextBox1.Value &amp; \"*\"\nEnd If\n\nEnd Sub\n\nPrivate Sub TextBox2_Change()\n\nIf Len(TextBox2.Value) = 0 Then\n        Sheet1.AutoFilterMode = False\nElse\n    If Sheet1.AutoFilterMode = True Then\n        Sheet1.AutoFilterMode = False\n    End If\n\nSheet1.Range(\"A2:C\" &amp; Rows.Count).AutoFilter field:=2, Criteria1:=\"*\" &amp; TextBox2.Value &amp; \"*\"\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1576077660, "creation_date": 1576077660, "answer_id": 59288956, "question_id": 59288583, "link": "https://stackoverflow.com/questions/59288583/call-calendar-with-certain-options-on-range-doubleclick/59288956#59288956", "title": "Call calendar with certain options on range doubleclick", "body": "<blockquote>\n<pre><code>Sub AdvancedCalendarTimeschedule()\n</code></pre>\n</blockquote>\n\n<p>Make that a function that returns a <code>Date</code>:</p>\n\n<pre><code>Private Function AdvancedCalendarTimeschedule() As Date\n</code></pre>\n\n<p>Remove the local <code>datevariable</code> declaration, you don't need it; make the function return the selected date instead of writing it to a cell:</p>\n\n<pre><code>AdvancedCalendarTimeSchedule = CalendarForm.GetDate( _\n    SelectedDate:=Range(\"'OtherData'!P17\").Value, _\n    FirstDayOfWeek:=Monday, _\n    DateFontSize:=12, _\n    TodayButton:=True, _\n    OkayButton:=True, _\n    ShowWeekNumbers:=True, _\n    BackgroundColor:=RGB(255, 255, 255), _\n    HeaderColor:=RGB(128, 128, 128), _\n    HeaderFontColor:=RGB(255, 255, 255), _\n    SubHeaderColor:=RGB(255, 255, 255), _\n    SubHeaderFontColor:=RGB(56, 56, 56), _\n    DateColor:=RGB(247, 247, 247), _\n    DateFontColor:=RGB(56, 56, 56), _\n    TrailingMonthFontColor:=RGB(155, 194, 230), _\n    DateHoverColor:=RGB(90, 195, 126), _\n    DateSelectedColor:=RGB(216, 216, 216), _\n    SaturdayFontColor:=RGB(201, 0, 0), _\n    SundayFontColor:=RGB(201, 0, 0), _\n    TodayFontColor:=RGB(0, 176, 80))\n</code></pre>\n\n<p>Note that if the user cancels the <code>CalendarForm</code> dialog (I presume it's a dialog), then the function will return <code>0</code>: this should be accounted for in the calling code. Also note that the <code>DoubleClick</code> handler needs to declare the <code>datevariable</code> - in your code that variable is out of scope and undeclared. The fact that your code runs at all means you're missing <code>Option Explicit</code> at the top of the module - add it, it will force you to consistently declare every variable you ever use, and that is a very good thing to do.</p>\n\n<pre><code>Dim datevariable As Date\nIf Not Intersect(Target, Range(\"C7:C90\")) Is Nothing Then datevariable = AdvancedCalendarTimeSchedule\n</code></pre>\n"}], "owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 59288956, "answer_count": 1, "score": -1, "last_activity_date": 1576077660, "creation_date": 1576076378, "last_edit_date": 1576077002, "question_id": 59288583, "link": "https://stackoverflow.com/questions/59288583/call-calendar-with-certain-options-on-range-doubleclick", "title": "Call calendar with certain options on range doubleclick", "body": "<p>I am calling calendar form on range double click, however there are possibilities to add more options to calendar form. I am currently calling calendar by this:</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    Dim rng As Range\n    Set rng = Target.Offset(1, 0)\n\n    If Not Intersect(Target, Range(\"C7:C90\")) Is Nothing Then datevariable = CalendarForm.GetDate\n    If datevariable = 0 Then\n        rng.Select\n        Exit Sub\n    Else\n        Target.Value = datevariable\n        rng.Select\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>It opens very basic calendar. I have more advanced calendar by using this code:</p>\n\n<pre><code>Sub AdvancedCalendarTimeschedule()\n\n    Dim datevariable\n\n    On Error Resume Next\n\n    datevariable = CalendarForm.GetDate( _\n        SelectedDate:=Range(\"'OtherData'!P17\").Value, _\n        FirstDayOfWeek:=Monday, _\n        DateFontSize:=12, _\n        TodayButton:=True, _\n        OkayButton:=True, _\n        ShowWeekNumbers:=True, _\n        BackgroundColor:=RGB(255, 255, 255), _\n        HeaderColor:=RGB(128, 128, 128), _\n        HeaderFontColor:=RGB(255, 255, 255), _\n        SubHeaderColor:=RGB(255, 255, 255), _\n        SubHeaderFontColor:=RGB(56, 56, 56), _\n        DateColor:=RGB(247, 247, 247), _\n        DateFontColor:=RGB(56, 56, 56), _\n        TrailingMonthFontColor:=RGB(155, 194, 230), _\n        DateHoverColor:=RGB(90, 195, 126), _\n        DateSelectedColor:=RGB(216, 216, 216), _\n        SaturdayFontColor:=RGB(201, 0, 0), _\n        SundayFontColor:=RGB(201, 0, 0), _\n        TodayFontColor:=RGB(0, 176, 80))\n    If datevariable &lt;&gt; 0 Then Range(\"'OtherData'!P17\") = datevariable\n\nEnd Sub\n</code></pre>\n\n<p><code>Range(\"'OtherData'!P17\")</code> should be <code>ActiveCell</code>. How to make double click appear advanced calendar above? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "edited": false, "score": 0, "creation_date": 1576076580, "post_id": 59288518, "comment_id": 104782200, "body": "You need to take files only from finance subfolder?"}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 1, "creation_date": 1576076727, "post_id": 59288518, "comment_id": 104782275, "body": "Is \\project folder\\ one folder or is it more like there are 100 project folders inside \\main folder\\ and you need the finance folder within each project folder?"}, {"owner": {"reputation": 127, "user_id": 8318946, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bcac8e3fc0233eca8cef0ea4ffd9fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/8318946/adrian"}, "edited": false, "score": 0, "creation_date": 1576140950, "post_id": 59288518, "comment_id": 104804636, "body": "there are always 5 subfolders in project folder but in each subfolder there are multiple different files, that&#39;s why I am looking for xlsm files in finance subfolder"}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 8318946, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bcac8e3fc0233eca8cef0ea4ffd9fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/8318946/adrian"}, "edited": false, "score": 0, "creation_date": 1576144261, "post_id": 59289100, "comment_id": 104806423, "body": "thanks a lot for your help. The code works ok but there is still 1 small issue, the script goes to finance subfolder and looks for xlsm but then goes to brief, production and delivery subfolder and then to next project folder. I&#39;d like to omit all subfolders in project folder except finance subfolder."}, {"owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "reply_to_user": {"reputation": 127, "user_id": 8318946, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bcac8e3fc0233eca8cef0ea4ffd9fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/8318946/adrian"}, "edited": false, "score": 0, "creation_date": 1576148115, "post_id": 59289100, "comment_id": 104808678, "body": "@Adrian I&#39;ve added update to my post, check it out!"}, {"owner": {"reputation": 127, "user_id": 8318946, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bcac8e3fc0233eca8cef0ea4ffd9fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/8318946/adrian"}, "edited": false, "score": 0, "creation_date": 1576491419, "post_id": 59289100, "comment_id": 104903891, "body": "thank you very much @Vitaliy Prushak. My issue is solved now :)"}], "tags": [], "owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "is_accepted": true, "score": 1, "last_activity_date": 1576148070, "last_edit_date": 1576148070, "creation_date": 1576078112, "answer_id": 59289100, "question_id": 59288518, "link": "https://stackoverflow.com/questions/59288518/how-to-open-xlsm-file-from-specific-subfolder-using-vba/59289100#59289100", "title": "how to open xlsm file from specific subfolder using VBA?", "body": "<p>Here is my idea, but it is done for 2 level subfolder (if I understood the task properly):</p>\n\n<pre><code>Sub Merge_Rows()\nDim srcFolder As Object\nDim srcSubFolder As Object\nDim srcSubSubFolder As Object\nDim srcFile As Object\nDim oLibrary As Object\n\n\n' This is my testing vars\nDim FolderName As String\nFolderName = \"P:\\\"\n'''''''''\n\n' will need it as I'm not passing the folder to sub\nSet oLibrary = CreateObject(\"Scripting.FileSystemObject\")\nSet srcFolder = oLibrary.getfolder(FolderName)\n\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\n' added for testing purposes\nDim fileCounter As Long\n\n    Debug.Print \"-----------------\" &amp; \"Source folder: \" &amp; FolderName &amp; \"--------------------------------\"\n    Debug.Print Chr(10)\n\nFor Each srcSubFolder In srcFolder.Subfolders ' going to subfolders\n\n    ' print the level 1 subfolder name, which should be a project folder\n\n    For Each srcSubSubFolder In srcSubFolder.Subfolders ' going to sub-subfolder\n\n        ' print the level 2 subfolder name, which should be a project folder subfolder\n        Debug.Print \"----------- Current SubFolder is: \" &amp; FolderName &amp; srcSubFolder.Name &amp; \"-----------------\"\n        If UCase(srcSubSubFolder.Name) Like \"*FINANCE*\" Then '&lt;--!! put proper pattern\n            ' go through it at once\n            For Each srcFile In srcSubSubFolder.Files\n\n            Debug.Print \"----------------- Current SubSubFolder is: \" &amp; FolderName &amp; srcSubFolder.Name &amp; \"\\\" &amp; srcSubSubFolder.Name &amp; \"---------------------\"\n\n                If LCase(srcFile.Name) Like \"*.xlsm\" Then\n                    Debug.Print srcFile.Name\n                    fileCounter = fileCounter + 1\n                    ' Your code here\n                End If\n            Next\n        End If\n        If Not fileCounter = 0 Then\n            Debug.Print \"There were \" &amp; fileCounter &amp; \" .xlsm files in \" &amp; FolderName &amp; srcSubFolder.Name &amp; \"\\\" &amp; srcSubSubFolder.Name\n            fileCounter = 0\n        Else\n            Debug.Print \"The search of .xlsm files in \" &amp; FolderName &amp; srcSubFolder.Name &amp; \"\\\" &amp; srcSubSubFolder.Name &amp; \" was not performed\"\n        End If\n        Debug.Print \"-----------------\" &amp; \"End of current SubSubFolder: \" &amp; FolderName &amp; srcSubFolder.Name &amp; \"\\\" &amp; srcSubSubFolder.Name &amp; \"---------------------\"\n    Next\n    Debug.Print \"-----------------\" &amp; \"End current SubFolder: \" &amp; FolderName &amp; srcSubFolder.Name &amp; \"---------------------\"\n    Debug.Print Chr(10) &amp; Chr(10)\nNext\n\nDebug.Print \"&lt;-----------------\" &amp; \"End Source Folder\" &amp; \"---------------------&gt;\"\n\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>And it looks like this\n<a href=\"https://i.stack.imgur.com/3dfya.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3dfya.png\" alt=\"enter image description here\"></a>\nIf it fits - you need to fix it for your solution, it's just a thoughts :)</p>\n\n<p><strong>Update per OPs comment</strong></p>\n\n<p>I've updated code with some more <code>Debug.Print</code> lines\nHere the file tree that I've created for testing:\n<a href=\"https://i.stack.imgur.com/H4sCV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/H4sCV.png\" alt=\"enter image description here\"></a>\nEach folder has a \"Book3.xlsm\" file in it.\nHere is the result of the updated script:\n<a href=\"https://i.stack.imgur.com/TWAQR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TWAQR.png\" alt=\"enter image description here\"></a></p>\n\n<p>Try to run at least one iteration of project folder and check the immediate window.</p>\n"}], "owner": {"reputation": 127, "user_id": 8318946, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bcac8e3fc0233eca8cef0ea4ffd9fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/8318946/adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 59289100, "answer_count": 1, "score": 0, "last_activity_date": 1576148070, "creation_date": 1576076177, "question_id": 59288518, "link": "https://stackoverflow.com/questions/59288518/how-to-open-xlsm-file-from-specific-subfolder-using-vba", "title": "how to open xlsm file from specific subfolder using VBA?", "body": "<p>I am working on macro that takes the path from clipboard, goes through each folder and subfolder in this path, opens xlsm file in <em>finance subfolder</em> and deletes <em>KPI</em> sheet. Below you can find the folder structure in my path:</p>\n\n<p>P:\\main folder\\project folder\\finance subfolder\\</p>\n\n<p>P:\\main folder\\project folder\\brief subfolder\\</p>\n\n<p>P:\\main folder\\project folder\\production subfolder\\</p>\n\n<p>P:\\main folder\\project folder\\delivery subfolder\\</p>\n\n<p>P:\\main folder\\project folder\\feedback subfolder\\</p>\n\n<p>Basically, I copy <em>\"P:\\main folder\\\"</em> and my macro goes through all project folders and all subfolders. I want to optimise this process and write a code that goes through all project folders in main folder but then goes only to <em>finance subfolder</em> and looks for xlsm files. I've tried to use the code that was posted <a href=\"https://stackoverflow.com/questions/37436594/vba-search-for-a-specific-subfolder-in-many-folders-and-move-all-the-files-in-it\">here</a> but it works only if I put <em>\"P:\\main folder\\project folder\\\"</em> path not if I put <em>\"P:\\main folder\\\"</em> path. </p>\n\n<p>As far as I see the reason is that my macro is looking for <em>finance subfolder</em> not in project folder but in main folder but this is only my guess. Below you can find the code:</p>\n\n<pre><code>Sub test_macro()\nDim oLibrary As Object\nDim srcFolder As Object\nDim folderName As String\nDim clipboard As MSForms.DataObject\nDim CopiedText As String\n\nSet clipboard = New MSForms.DataObject\nclipboard.GetFromClipboard\nCopiedText = clipboard.GetText\n\nfolderName = CopiedText\nIf StrPtr(folderName) = 0 Then\n    Exit Sub\nEnd If\n\nSet oLibrary = CreateObject(\"Scripting.FileSystemObject\")\nMerge_Rows oLibrary.GetFolder(folderName)\nEnd Sub\n\nSub Merge_Rows(srcFolder As Object)\n\nDim srcSubFolder As Object\nDim srcFile As Object\n\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\nFor Each srcSubFolder In srcFolder.SubFolders\n    If Split(srcSubFolder, \"\\\")(UBound(Split(srcSubFolder, \"\\\"))) = \"1_FINANCE\" Then '&lt;-- my guess is that here is the problem but not sure how to fix it\n        Merge_Rows srcSubFolder\n    End If\nNext\n\nFor Each srcFile In srcFolder.Files\n     If LCase(srcFile.Name) Like \"*.xlsm\" Then\n     Set wbkSource = Workbooks.Open(srcFile)\n\n        On Error Resume Next\n        Application.DisplayAlerts = False\n        wbkSource.Sheets(\"KPI\").Delete\n        Application.DisplayAlerts = True\n        wbkSource.Close SaveChanges:=True\n    End If\nNext\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\nEnd With\nEnd Sub\n\n</code></pre>\n\n<p>How can I change a code so it goes through each <em>project folder</em> but then goes only to <em>finance subfolder</em> and omits others?</p>\n"}, {"tags": ["vba", "runtime-error", "multiple-columns", "selection", "copy-paste"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1576076365, "post_id": 59288486, "comment_id": 104782079, "body": "See <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-excel-with-vba\">this question</a> for the &quot;proper&quot; way to find the last blank cell in column A."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1576076444, "creation_date": 1576076444, "answer_id": 59288608, "question_id": 59288486, "link": "https://stackoverflow.com/questions/59288486/runtime-error-1004-you-cant-past-this-here-cause-the-copy-area-and-past-area/59288608#59288608", "title": "Runtime error &#39;1004&#39; : You cant past this here cause the Copy area and past area arent the same size", "body": "<p>Use xlup:</p>\n\n<pre><code>Sheets(\"TNF\").Range(\"A2\",Sheets(\"TNF\").Range(\"A\" &amp; Rows.Count).End(xlup)).Copy\nSheets(\"TNF Check\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues\n</code></pre>\n\n<p>Or better avoid the clipboard when only wanting values:</p>\n\n<pre><code>Dim rng as Range\nSet rng = Sheets(\"TNF\").Range(\"A2\",Sheets(\"TNF\").Range(\"A\" &amp; Rows.Count).End(xlup)).Value\nSheets(\"TNF Check\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Resize(rng.Rows.Count,1).Value = rng.Value\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576077881, "post_id": 59288912, "comment_id": 104782983, "body": "This is not recommended actually. There is no need to <code>Select</code> here."}, {"owner": {"reputation": 193, "user_id": 9516164, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PlJI-HDoc5U/AAAAAAAAAAI/AAAAAAAAA2Q/Scai4hGEF4g/photo.jpg?sz=128", "display_name": "Adrian Celis", "link": "https://stackoverflow.com/users/9516164/adrian-celis"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576079077, "post_id": 59288912, "comment_id": 104783718, "body": "Im just giving a solution without changing too much of his original code."}], "tags": [], "owner": {"reputation": 193, "user_id": 9516164, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PlJI-HDoc5U/AAAAAAAAAAI/AAAAAAAAA2Q/Scai4hGEF4g/photo.jpg?sz=128", "display_name": "Adrian Celis", "link": "https://stackoverflow.com/users/9516164/adrian-celis"}, "is_accepted": false, "score": 0, "last_activity_date": 1576077510, "creation_date": 1576077510, "answer_id": 59288912, "question_id": 59288486, "link": "https://stackoverflow.com/questions/59288486/runtime-error-1004-you-cant-past-this-here-cause-the-copy-area-and-past-area/59288912#59288912", "title": "Runtime error &#39;1004&#39; : You cant past this here cause the Copy area and past area arent the same size", "body": "<p>We can add a simple logic like this.</p>\n\n<p>Replace:</p>\n\n<pre><code>Range(\"A2\").Select\nRange(Selection, Selection.End(xlDown)).Select\n</code></pre>\n\n<p>With this:</p>\n\n<pre><code>If Range(\"A3\").Value = \"\" Then\n    Range(\"A2\").Select\nElse\n    Range(Range(\"A2\"), Range(\"A2\").End(xlDown)).Select\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 11665873, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hUuhbOx5yyI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcJ0hFYMq2TsYSR2THripd6v2_uKg/mo/photo.jpg?sz=128", "display_name": "Omar", "link": "https://stackoverflow.com/users/11665873/omar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 59288608, "answer_count": 2, "score": 0, "last_activity_date": 1576077510, "creation_date": 1576076113, "question_id": 59288486, "link": "https://stackoverflow.com/questions/59288486/runtime-error-1004-you-cant-past-this-here-cause-the-copy-area-and-past-area", "title": "Runtime error &#39;1004&#39; : You cant past this here cause the Copy area and past area arent the same size", "body": "<p>I have a macro that copies a list of numbers from column A on the first sheet, and pastes it starting at the first blank cell in column A on the second sheet. </p>\n\n<pre><code>Sheets(\"TNF\").Select\nRange(\"A2\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Copy\n\nSheets(\"TNF Check\").Select\nRange(\"A1\").End(xlDown).Offset(1, 0).Select\n\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n</code></pre>\n\n<p>Basically, it uses the CTRL+SHIFT+Down function to select everything from A2 down. \nIt works fine when there is more than one cell to copy. But when there is only one cell, it grabs the entire column A (1048576 cells) and tries to paste it all on the second sheet, which doesnt fit (data is already there). \nHow can i update the code to not grab the whole column, but rather, only grab cells with data actually in it?</p>\n"}, {"tags": ["excel", "vba", "button", "copy", "protection"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1576077022, "post_id": 59288345, "comment_id": 104782440, "body": "What&#39;s the problem you&#39;re having? You may just need to change <code>ActiveSheet.Protect</code> to <code>Workbooks(&quot;Workbook1&quot;).Worksheets(&quot;Sheet1&quot;).Protect</code>?"}, {"owner": {"reputation": 1, "user_id": 12518979, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD_etytHgWzt_JqiLz-Rg3Y-5RrNhDz5oRnYkf3=k-s128", "display_name": "Kristina Kelek", "link": "https://stackoverflow.com/users/12518979/kristina-kelek"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1576132952, "post_id": 59288345, "comment_id": 104801452, "body": "I did this, but I get error 1004 indicating that I am transferring data to a protected sheet, and when I press debug I am marked with this line in second code: <code>Sheets(&quot;Sheet1&quot;).Cells(k,&quot;G&quot;).EntireRow.Cut Destination :=Sheets(&quot;Archive&quot;).Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Offset(1)</code> and I dont know how to avoid that error."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 14466803, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GgPxe77HVNz8AGBIHWMbcTW0NHyu1mn_cD0nyHJYw=k-s128", "display_name": "shahzad afzal", "link": "https://stackoverflow.com/users/14466803/shahzad-afzal"}, "is_accepted": false, "score": 0, "last_activity_date": 1602934270, "creation_date": 1602934270, "answer_id": 64401940, "question_id": 59288345, "link": "https://stackoverflow.com/questions/59288345/159-5000-how-to-protect-a-sheet-in-excel-if-the-data-from-another-sheet-is-copie/64401940#64401940", "title": "159/5000 How to protect a sheet in excel if the data from another sheet is copied automatically?", "body": "<p>first open two sheets\none to work and one to link\nlink one sheet data  to another sheet\nnow on to link sheet go review tab ,on protect sheet ,ao small window will open , by default 2 ticks will appear , no further more  ticks to be made , enter password say &quot;1&quot; , and on confirm enter 1 close the small window , now  modify data entry sheet , you will see that in link sheet data has too changed ( i have practically checked and found operational )</p>\n"}], "owner": {"reputation": 1, "user_id": 12518979, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD_etytHgWzt_JqiLz-Rg3Y-5RrNhDz5oRnYkf3=k-s128", "display_name": "Kristina Kelek", "link": "https://stackoverflow.com/users/12518979/kristina-kelek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1602934270, "creation_date": 1576075653, "question_id": 59288345, "link": "https://stackoverflow.com/questions/59288345/159-5000-how-to-protect-a-sheet-in-excel-if-the-data-from-another-sheet-is-copie", "title": "159/5000 How to protect a sheet in excel if the data from another sheet is copied automatically?", "body": "<p>I'm interested in how to protect a sheet in excel if the data from another sheet is copied automatically and there is a button that should work with the protected copy data?\nMy my data copy code looks like:</p>\n\n<pre><code>Sub CopyRow1()\n    ActiveSheet.Unprotect Password:=\"pass\"\n    Workbooks.Open Filename:=\"C:\\Users\\Desktop\\workbook1.xlsm\"\n\n    ThisWorkbook.Sheets(\"1\").Range(\"A5:G5\").Copy\n    Workbooks(\"workbook1\").Sheets(\"Sheet1\").Range(\"A1048567:G1048567\").End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues\n    Application.CutCopyMode = False 'esp\n    ActiveSheet.Protect Password:=\"pass\"\n\nEnd Sub\n</code></pre>\n\n<p>and my code for button is:</p>\n\n<pre><code>Sub archive\nDim k, LastRow\n\nLastRow = Sheets(\"Sheet1\").Range(\"A\" &amp; Rows.Count).End(xlUp).row\nFor k = 2 To LastRow\n    If Sheets(\"Sheet1\").Cells(k, \"G\").Value = 0 Then\n    Sheets(\"Sheet1\").Cells(k, \"G\").EntireRow.Cut Destination:=Sheets(\"Archive\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\n    Sheets(\"Sheet1\").Cells(k, \"G\").EntireRow.Delete\n    End If\nNext k\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 3, "last_activity_date": 1576080569, "creation_date": 1576080569, "answer_id": 59289847, "question_id": 59288019, "link": "https://stackoverflow.com/questions/59288019/ms-access-how-can-i-return-all-table-and-field-names-with-in-that-table-that-ha/59289847#59289847", "title": "MS Access: How can I return all table and field names with in that table that have the field format &#39;hyperlink&#39; via SQL or VBA?", "body": "<p>You can loop through every <code>tableDef</code>/Table in the database, but it gets a little hairy since hyperlinks are an attribute on a <code>memo</code> field type. The <code>Attributes</code> property of Access objects are a bitmask, so when checking to see if a particular attribute is set, you have to check if that attributes bit is set in the bitmask. </p>\n\n<pre><code>Sub ListTablesWithHyperlinks()\n    Dim tdf As TableDef\n    Dim fld As Field\n    Dim tdfPrint As Boolean\n\n    'Loop through all tables\n    For Each tdf In CurrentDb.TableDefs\n        'Set flag to false\n        tdfPrint = False\n\n        'Loop through all fields\n        For Each fld In tdf.Fields\n            'Test if column has an attribute of `dbHyperlinkField`\n            If (fld.Attributes And dbHyperlinkField) = dbHyperlinkField Then\n                'Set the flag and exit the loop\n                tdfPrint = True: Exit For\n            End If\n        Next fld\n\n        'If the flag was set to true, then iterate fields again and print out\n        If tdfPrint Then\n            For Each fld In tdf.Fields\n                'Print out tablename, column ordinal, and column name\n                Debug.Print tdf.Name, fld.OrdinalPosition, fld.Name\n            Next fld\n        End If\n    Next tdf\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4294103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39eabd9c4b10aa0dd80c89bb1eb2de42?s=128&d=identicon&r=PG&f=1", "display_name": "Keller Waldron", "link": "https://stackoverflow.com/users/4294103/keller-waldron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 59289847, "answer_count": 1, "score": 0, "last_activity_date": 1576080569, "creation_date": 1576074578, "question_id": 59288019, "link": "https://stackoverflow.com/questions/59288019/ms-access-how-can-i-return-all-table-and-field-names-with-in-that-table-that-ha", "title": "MS Access: How can I return all table and field names with in that table that have the field format &#39;hyperlink&#39; via SQL or VBA?", "body": "<p>I have multiple tables, within some of those tables I have fields that are formatted as hyperlink. I want to return the tables names that contain hyperlink formatted fields and the subsequent field names?</p>\n\n<p>I am trying to do this within VBA, I'm thinking an SQL call within VBA.</p>\n"}, {"tags": ["excel", "vba", "excel-formula", "background-color"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1576072422, "post_id": 59287290, "comment_id": 104779863, "body": "UDFs can&#39;t (except in some edge cases) change another cell. Nor can they change the formatting of the cell they are called from."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 2, "creation_date": 1576072522, "post_id": 59287290, "comment_id": 104779917, "body": "Why not use conditional formatting?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1576072645, "post_id": 59287290, "comment_id": 104779986, "body": "You could use a sub with arguments."}, {"owner": {"reputation": 11, "user_id": 12518379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82a1fd6b7d52132e033b4d2de5931225?s=128&d=identicon&r=PG&f=1", "display_name": "Yellowstone", "link": "https://stackoverflow.com/users/12518379/yellowstone"}, "edited": false, "score": 0, "creation_date": 1576072728, "post_id": 59287290, "comment_id": 104780033, "body": "I have tried. I can&#39;t use conditionally formatting in this way."}, {"owner": {"reputation": 11, "user_id": 12518379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82a1fd6b7d52132e033b4d2de5931225?s=128&d=identicon&r=PG&f=1", "display_name": "Yellowstone", "link": "https://stackoverflow.com/users/12518379/yellowstone"}, "edited": false, "score": 0, "creation_date": 1576072815, "post_id": 59287290, "comment_id": 104780086, "body": "SJR - That is what I need help with to write up the sub/public function with the right data types etc. so it will execute in VB and work in Excel sheet."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1576074454, "post_id": 59287290, "comment_id": 104781001, "body": "What issues do you have with conditionally formatting? Seems to me rather easy. Just create 3 rules based on simple formula, eg <code>=B1&gt;0</code>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12518379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82a1fd6b7d52132e033b4d2de5931225?s=128&d=identicon&r=PG&f=1", "display_name": "Yellowstone", "link": "https://stackoverflow.com/users/12518379/yellowstone"}, "edited": false, "score": 0, "creation_date": 1576074144, "post_id": 59287447, "comment_id": 104780804, "body": "Thank you SJR - I will have a go."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 2, "last_activity_date": 1576072792, "creation_date": 1576072792, "answer_id": 59287447, "question_id": 59287290, "link": "https://stackoverflow.com/questions/59287290/changing-cell-colour-background-in-excel-using-a-public-vba-function-not-a-vba/59287447#59287447", "title": "Changing cell colour background in Excel using a public VBA function - not a VBA programmer", "body": "<p>To circumvent the problem mentioned by BigBen here is another approach.</p>\n\n<p>You need to remove the quotes around <code>cell</code> as otherwise it will be treated as a literal string.</p>\n\n<p>Good practice too to declare argument types in your function.</p>\n\n<p>There's no error trapping here, e.g. for invalid ranges.</p>\n\n<pre><code>Sub ColourCell(cell As String, colour As String)\n\nIf colour = \"Green\" Then\n    Range(cell).Interior.Color = vbGreen\nElseIf colour = \"Red\" Then\n    Range(cell).Interior.Color = vbRed\nElseIf colour = \"White\" Then\n    Range(cell).Interior.Color = vbWhite\nEnd If\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Call the sub this way:</p>\n\n<pre><code>Sub x()\n\nColourCell \"A1\", \"Green\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12518379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82a1fd6b7d52132e033b4d2de5931225?s=128&d=identicon&r=PG&f=1", "display_name": "Yellowstone", "link": "https://stackoverflow.com/users/12518379/yellowstone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1576072792, "creation_date": 1576072302, "last_edit_date": 1576072338, "question_id": 59287290, "link": "https://stackoverflow.com/questions/59287290/changing-cell-colour-background-in-excel-using-a-public-vba-function-not-a-vba", "title": "Changing cell colour background in Excel using a public VBA function - not a VBA programmer", "body": "<p>I want to change the fill colour of a cell, based on a value in another cell. This will be a series implementation, e.g. A1, based on value in B1; A2, based on value in B2 and so on.</p>\n\n<p>I want to use a public function so I can use it this way and pull down for the series implementation.</p>\n\n<p><code>IF(B1&gt;0,ColourCell(\"A1\",\"Green\"),IF(B1&lt;0,ColourCell(\"A1\",\"Red\",ColourCell(\"A1\",\"White\"))))</code></p>\n\n<p>I don't know data types, etc. in VB - can I have some help please to get it working in VB.\nI have inserted a module (General). This is what the function is.</p>\n\n<pre><code>Public Function ColourCell(cell, colour)\n\nIf colour = \"Green\" Then\n\n    Range(\"cell\").Interior.Color = vbGreen\n\nElseIf colour = \"Red\" Then\n\n    Range(\"cell\").Interior.Color = vbRed\n\nElseIf colour = \"White\" Then\n\n    Range(\"cell\").Interior.Color = vbWhite\n\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>My understanding is that once it all works, I can use it in the way described.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "rest"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1576076906, "post_id": 59287222, "comment_id": 104782379, "body": "You want  http.Open &quot;GET&quot;, URL, False possibly"}, {"owner": {"reputation": 21, "user_id": 9286606, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9771ce33b25279cfbf9561188b768b8c?s=128&d=identicon&r=PG&f=1", "display_name": "Maggie", "link": "https://stackoverflow.com/users/9286606/maggie"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1576080791, "post_id": 59287222, "comment_id": 104784732, "body": "I tried that out and It timed out on the http.send line. What does that mean?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1576085137, "post_id": 59287222, "comment_id": 104786910, "body": "Are you sure your url is correct?"}, {"owner": {"reputation": 21, "user_id": 9286606, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9771ce33b25279cfbf9561188b768b8c?s=128&d=identicon&r=PG&f=1", "display_name": "Maggie", "link": "https://stackoverflow.com/users/9286606/maggie"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1576156200, "post_id": 59287222, "comment_id": 104812967, "body": "I am able to print the url and paste it into the browser and that works so I think so."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9286606, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9771ce33b25279cfbf9561188b768b8c?s=128&d=identicon&r=PG&f=1", "display_name": "Maggie", "link": "https://stackoverflow.com/users/9286606/maggie"}, "edited": false, "score": 0, "creation_date": 1576080643, "post_id": 59289015, "comment_id": 104784651, "body": "Yes, the next step is dependent on the response of this query."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1576156289, "post_id": 59289015, "comment_id": 104813017, "body": "They are already requesting async by virtue of True argument."}, {"owner": {"reputation": 21, "user_id": 9286606, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9771ce33b25279cfbf9561188b768b8c?s=128&d=identicon&r=PG&f=1", "display_name": "Maggie", "link": "https://stackoverflow.com/users/9286606/maggie"}, "edited": false, "score": 0, "creation_date": 1576163874, "post_id": 59289015, "comment_id": 104817570, "body": "The True statement on http.Open makes it asynchronous so that the send and .responseText don&#39;t happen at the same time?"}], "tags": [], "owner": {"reputation": 51, "user_id": 8512200, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155633989211639/picture?type=large", "display_name": "Glen Richmond", "link": "https://stackoverflow.com/users/8512200/glen-richmond"}, "is_accepted": false, "score": 0, "last_activity_date": 1576077825, "creation_date": 1576077825, "answer_id": 59289015, "question_id": 59287222, "link": "https://stackoverflow.com/questions/59287222/rest-get-call-in-vba-is-returning-data-necessary-to-complete-this-operation-is/59289015#59289015", "title": "REST GET call in VBA is returning &quot;data necessary to complete this operation is not yet available&quot;", "body": "<p>could you not request asynchronously, so it doesn't matter how long you have to wait for a response? (as long as the server doesn't timeout the request) \nOr is the next steps dependant on a response from this request?</p>\n"}], "owner": {"reputation": 21, "user_id": 9286606, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9771ce33b25279cfbf9561188b768b8c?s=128&d=identicon&r=PG&f=1", "display_name": "Maggie", "link": "https://stackoverflow.com/users/9286606/maggie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576592895, "creation_date": 1576072037, "last_edit_date": 1576592895, "question_id": 59287222, "link": "https://stackoverflow.com/questions/59287222/rest-get-call-in-vba-is-returning-data-necessary-to-complete-this-operation-is", "title": "REST GET call in VBA is returning &quot;data necessary to complete this operation is not yet available&quot;", "body": "<p>I am working on REST API calls from excel vba to my database and I am having trouble with a particular GET call with a parameter. The error is \" Run-time error '-2147483638 (80000000a)': The data necessary to complete this operation is not yet available\". </p>\n\n<p>Previously in one of the environments, I was able to get around it by putting in an Application.wait of 40 seconds. But I have another environment which is even slower and no amount of wait time is resulting in data populated in the .responseText. Out of vba, the call works in 50 seconds so I tried 50 up to 8 minutes with no luck. Any idea on how to get this GET call to work in this slower environment? </p>\n\n<p>Below is the code I am using:</p>\n\n<pre><code>URL = \".../?q=%7B%22testid%22:%22\" &amp; vSAMPLE_ID &amp; \"%22%7D\"        \n        http.Open \"GET\", URL, True\n        http.setRequestHeader \"Accept\", \"application/json\"\n        http.setRequestHeader \"Accept-Encoding\", \"application/json\"\n        http.send\n        Application.Wait (Now + TimeValue(\"0:01:20\"))\n        vRESTRESPONSE = http.ResponseText\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-project"], "answers": [{"tags": [], "owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "is_accepted": true, "score": 1, "last_activity_date": 1576074241, "creation_date": 1576074241, "answer_id": 59287921, "question_id": 59286851, "link": "https://stackoverflow.com/questions/59286851/indent-tasks-on-import-from-excel/59287921#59287921", "title": "Indent tasks on import from Excel", "body": "<p>I have found solution with using <code>OutlineLevel</code>. If somebody is interested in code, it is here:   </p>\n\n<pre><code>   If (Range(\"AK\" &amp; i).Value &lt;&gt; \"\") And (Not IsError(Range(\"AK\" &amp; i).Value)) Then\n\n            newproj.Tasks.Add strValue\n\n                Select Case Range(\"AJ\" &amp; i).Value\n                Case \"Op-\"\n                    newproj.Tasks(i - 7).OutlineLevel = 2\n                Case \"As-\"\n                    newproj.Tasks(i - 7).OutlineLevel = 1\n                End Select\n\n        End If\n</code></pre>\n"}], "owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 59287921, "answer_count": 1, "score": 0, "last_activity_date": 1576074241, "creation_date": 1576070799, "question_id": 59286851, "link": "https://stackoverflow.com/questions/59286851/indent-tasks-on-import-from-excel", "title": "Indent tasks on import from Excel", "body": "<p>I would like to indent tasks on import from Excel. I have working solution for importing tasks, however I can't find a solution for indenting tasks in MS Project without adding something to text name, like:</p>\n\n<pre><code>    If (Not IsEmpty(Range(\"AJ\" &amp; i).Value)) And (Not IsError(Range(\"AJ\" &amp; i).Value)) Then\n\n        Select Case Left(newproj.Tasks(i - 7).Name, 3)\n        Case \"( \", \"Op-\"\n          newproj.Tasks(i - 7).OutlineIndent\n        End Select\n\n    End If\n</code></pre>\n\n<p>This is OK, but does not look nice when there is something like \"Op-\" in front of task name. Is it possible to Indent while importing?</p>\n\n<p>Here is my code for importing tasks:</p>\n\n<pre><code>For i = 8 To 90\n\n    strValue = Worksheets(\"Timeschedule\").Range(\"AK\" &amp; i)\n\n    If (Not IsEmpty(Range(\"AK\" &amp; i).Value)) And (Not IsError(Range(\"AK\" &amp; i).Value)) Then\n\n        newproj.Tasks.Add strValue\n\n    End If\n\nNext i\n</code></pre>\n\n<p>My tasks in Excel are in column AK, in helper column AJ there are Op- values to identify what should be indented and what not.</p>\n"}, {"tags": ["excel", "vba", "duplicates"], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 2, "last_activity_date": 1576070613, "creation_date": 1576070613, "answer_id": 59286793, "question_id": 59286694, "link": "https://stackoverflow.com/questions/59286694/vba-excel-how-to-remove-duplicates-based-on-three-columns/59286793#59286793", "title": "VBA Excel-How to remove duplicates based on three columns", "body": "<p>Try using the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.listcolumn.index\" rel=\"nofollow noreferrer\"><code>ListColumn.Index</code></a> of each column:</p>\n\n<pre><code>Dim dataTable as ListObject\nSet dataTable = cur.ListObjects(\"data\")\n\nDim employeeIndex as Long\nemployeeIndex = dataTable.ListColumns(\"employee id\").Index\n\nDim customerIndex as Long\ncustomerIndex = dataTable.ListColumns(\"customer\").Index\n\nDim dateIndex as Long\ndateIndex = dataTable.ListColumns(\"date\").Index\n\ndataTable.Range.RemoveDuplicates Columns:=Array(employeeIndex, customerIndex, dateIndex), _\n                                 Header:=xlYes\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9290037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d5a40ce52140ec2e2d61b03eeabe1de?s=128&d=identicon&r=PG&f=1", "display_name": "Santhosh Arockiaxavier", "link": "https://stackoverflow.com/users/9290037/santhosh-arockiaxavier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1576071587, "creation_date": 1576070243, "last_edit_date": 1576071587, "question_id": 59286694, "link": "https://stackoverflow.com/questions/59286694/vba-excel-how-to-remove-duplicates-based-on-three-columns", "title": "VBA Excel-How to remove duplicates based on three columns", "body": "<p>I want to remove duplicate rows based on three columns in a table in excel. \nWhen I pass the columns as direct values to an array say example columns 1, 61 and 122 it works fine like in the code below:</p>\n\n<p><code>cur.Range(\"data[#All]\").RemoveDuplicates Columns:=Array(1, 61, 122), Header:=xlYes</code></p>\n\n<p>But when I try to pass column values in the array dynamically by finding their column number in the header, it neither throws any error nor removes the duplicates\nbelow code is the dynamic one for passing the columns </p>\n\n<p><code>Set employeeCell = cur.Range(\"1:1\").Find(What:=\"employee id\")\n    Set customerCell = cur.Range(\"1:1\").Find(What:=\"customer\")\n    Set dateCell = cur.Range(\"1:1\").Find(What:=\"date\")<br>\n    cur.Range(\"data[#All]\").RemoveDuplicates Columns:=Array(employeecell.column,customercell.column, datecell.column), Header:=xlYes</code></p>\n\n<p>Kindly help on this. I want to remove duplicates based on three columns dynamically by finding their respective column numbers.</p>\n"}, {"tags": ["excel", "vba", "function"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 4, "creation_date": 1576070313, "post_id": 59286639, "comment_id": 104778590, "body": "if the function is used in a cell somewhere, it will be called every time a re-calc occurs. Do a search for the function in your worksheets."}, {"owner": {"reputation": 199, "user_id": 6625232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c73ea7fdce6867dddac6e36ed0e5cf?s=128&d=identicon&r=PG&f=1", "display_name": "MEC", "link": "https://stackoverflow.com/users/6625232/mec"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1576156927, "post_id": 59286639, "comment_id": 104813336, "body": "Thanks @ScottHoltzman but I am not suing on the actual sheet I am on, it is being used in another sheet on the same workbook. Is there a way to have it launch only when I am in that particular sheet?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1576162136, "post_id": 59286639, "comment_id": 104816500, "body": "No, but you can turn calcs off while you step through if that is an option."}, {"owner": {"reputation": 199, "user_id": 6625232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c73ea7fdce6867dddac6e36ed0e5cf?s=128&d=identicon&r=PG&f=1", "display_name": "MEC", "link": "https://stackoverflow.com/users/6625232/mec"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1576197629, "post_id": 59286639, "comment_id": 104830962, "body": "Ok I\u2019ll try it, can you tell me what the code is for turning calcs off?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1576259561, "post_id": 59286639, "comment_id": 104854462, "body": "You can easily find by google, but it&#39;s <code>Application.Calculation = xlCalculationManual</code>"}], "owner": {"reputation": 199, "user_id": 6625232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c73ea7fdce6867dddac6e36ed0e5cf?s=128&d=identicon&r=PG&f=1", "display_name": "MEC", "link": "https://stackoverflow.com/users/6625232/mec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576135744, "creation_date": 1576070052, "last_edit_date": 1576135744, "question_id": 59286639, "link": "https://stackoverflow.com/questions/59286639/function-running-without-being-called", "title": "Function running without being called", "body": "<p>I have a function that I got from a company spreadsheet to calculate rescission dates, I added the sheet as another sheet in my workbook to avoid opening another workbook when I need to use this functionality. The odd thing that is happening is that this function is being executed by my other procedures without me calling the function. I have stepped through many times but don't see why this function is being called. Any thoughts?</p>\n\n<pre><code>Function sixdayworkweek(rngIn As Range, lngDays As Long, rngHolidays As Range)\nDim rngCell As Range\nDim lngStartDate As Long, lngNextDay As Long, lngWorkDayCount As Long\nDim lngIncr As Long, lngC As Long\nApplication.Volatile\nlngStartDate = CLng(rngIn.Value)\nlngNextDay = lngStartDate\nDo\n  lngNextDay = lngNextDay + 1\n  lngIncr = 1\nIf Weekday(lngNextDay, vbSunday) = 1 Then\n  ' if day is Sunday, don't count it as a workday\n  lngIncr = 0\nElse\n  For Each rngCell In rngHolidays\n    ' if day is Holiday, don't count it as a workday\n    If lngNextDay = CLng(rngCell.Value) Then\n      lngIncr = 0\n      Exit For\n    End If\n  Next rngCell\nEnd If\n' increment day by 1 or 0 if a Sunday or Holiday\nlngWorkDayCount = lngWorkDayCount + lngIncr\nLoop Until lngWorkDayCount = lngDays\nsixdayworkweek = CDate(lngNextDay)\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 79, "user_id": 12010837, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-x5Ek2RSPdeI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reOO8P_bKzxN78KaghG8CM98pOWvQ/photo.jpg?sz=128", "display_name": "Sameer Farooqui", "link": "https://stackoverflow.com/users/12010837/sameer-farooqui"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576068952, "post_id": 59286276, "comment_id": 104777783, "body": "Yes, i guess the question was not clear so i updated it and repost"}, {"owner": {"reputation": 79, "user_id": 12010837, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-x5Ek2RSPdeI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reOO8P_bKzxN78KaghG8CM98pOWvQ/photo.jpg?sz=128", "display_name": "Sameer Farooqui", "link": "https://stackoverflow.com/users/12010837/sameer-farooqui"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1576069029, "post_id": 59286276, "comment_id": 104777829, "body": "Let me edit the question again, i will share the macro which i am trying to get it work"}, {"owner": {"reputation": 14292, "user_id": 2820, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/631713865b68894b6bf525e16d817f58?s=128&d=identicon&r=PG", "display_name": "Onorio Catenacci", "link": "https://stackoverflow.com/users/2820/onorio-catenacci"}, "edited": false, "score": 0, "creation_date": 1576074112, "post_id": 59286276, "comment_id": 104780792, "body": "Dumb question I guess--but are you sure you can reach the URL?  I mean have you checked that you can download the file <i>outside</i> Excel to insure that there&#39;s not some other issue?"}, {"owner": {"reputation": 79, "user_id": 12010837, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-x5Ek2RSPdeI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reOO8P_bKzxN78KaghG8CM98pOWvQ/photo.jpg?sz=128", "display_name": "Sameer Farooqui", "link": "https://stackoverflow.com/users/12010837/sameer-farooqui"}, "reply_to_user": {"reputation": 14292, "user_id": 2820, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/631713865b68894b6bf525e16d817f58?s=128&d=identicon&r=PG", "display_name": "Onorio Catenacci", "link": "https://stackoverflow.com/users/2820/onorio-catenacci"}, "edited": false, "score": 0, "creation_date": 1576074770, "post_id": 59286276, "comment_id": 104781178, "body": "Yes I have checked the url is working fine outside the excel"}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 12010837, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-x5Ek2RSPdeI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reOO8P_bKzxN78KaghG8CM98pOWvQ/photo.jpg?sz=128", "display_name": "Sameer Farooqui", "link": "https://stackoverflow.com/users/12010837/sameer-farooqui"}, "edited": false, "score": 0, "creation_date": 1576076270, "post_id": 59287838, "comment_id": 104782022, "body": "I have changed the function declaration but the image is not downloading."}, {"owner": {"reputation": 79, "user_id": 12010837, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-x5Ek2RSPdeI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reOO8P_bKzxN78KaghG8CM98pOWvQ/photo.jpg?sz=128", "display_name": "Sameer Farooqui", "link": "https://stackoverflow.com/users/12010837/sameer-farooqui"}, "edited": false, "score": 0, "creation_date": 1576077159, "post_id": 59287838, "comment_id": 104782519, "body": "No error code it is showing the status as downloaded but the file is not there in the folder"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "reply_to_user": {"reputation": 79, "user_id": 12010837, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-x5Ek2RSPdeI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reOO8P_bKzxN78KaghG8CM98pOWvQ/photo.jpg?sz=128", "display_name": "Sameer Farooqui", "link": "https://stackoverflow.com/users/12010837/sameer-farooqui"}, "edited": false, "score": 0, "creation_date": 1576077326, "post_id": 59287838, "comment_id": 104782631, "body": "And you have write access to the folder? Instead of <code>C:\\Temp</code>, try <code>environ(&quot;Temp&quot;)</code>. This will write the file into your personal Temp-folder (where you have write access for sure). I did a test: There is no error thrown when attempting to write to an invalid folder"}, {"owner": {"reputation": 79, "user_id": 12010837, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-x5Ek2RSPdeI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reOO8P_bKzxN78KaghG8CM98pOWvQ/photo.jpg?sz=128", "display_name": "Sameer Farooqui", "link": "https://stackoverflow.com/users/12010837/sameer-farooqui"}, "edited": false, "score": 0, "creation_date": 1576083334, "post_id": 59287838, "comment_id": 104786043, "body": "Now i am getting an error. sharing the sample file - <a href=\"https://drive.google.com/file/d/1GDsNAKmkSd8PInAfT6amzCIGjyFEGWam/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/1GDsNAKmkSd8PInAfT6amzCIGjyFEGWam/&hellip;</a>"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "reply_to_user": {"reputation": 79, "user_id": 12010837, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-x5Ek2RSPdeI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reOO8P_bKzxN78KaghG8CM98pOWvQ/photo.jpg?sz=128", "display_name": "Sameer Farooqui", "link": "https://stackoverflow.com/users/12010837/sameer-farooqui"}, "edited": false, "score": 0, "creation_date": 1576085311, "post_id": 59287838, "comment_id": 104786986, "body": "For me, the 2 files throw (different) errors. Dropbox throws a timeout. Amazon, I think doesn&#39;t like it if you try to download a product image. However, I was able to download 2 other files with the code - so likely the problem is not the code itself."}, {"owner": {"reputation": 79, "user_id": 12010837, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-x5Ek2RSPdeI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reOO8P_bKzxN78KaghG8CM98pOWvQ/photo.jpg?sz=128", "display_name": "Sameer Farooqui", "link": "https://stackoverflow.com/users/12010837/sameer-farooqui"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1576085641, "post_id": 59287838, "comment_id": 104787170, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/204072/discussion-between-sameer-farooqui-and-funthomas\">continue this discussion in chat</a>."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "reply_to_user": {"reputation": 79, "user_id": 12010837, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-x5Ek2RSPdeI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reOO8P_bKzxN78KaghG8CM98pOWvQ/photo.jpg?sz=128", "display_name": "Sameer Farooqui", "link": "https://stackoverflow.com/users/12010837/sameer-farooqui"}, "edited": false, "score": 0, "creation_date": 1576087021, "post_id": 59287838, "comment_id": 104787829, "body": "Glad to hear. Would be nice to update and accept the answer."}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": true, "score": 1, "last_activity_date": 1576087162, "last_edit_date": 1576087162, "creation_date": 1576073974, "answer_id": 59287838, "question_id": 59286276, "link": "https://stackoverflow.com/questions/59286276/download-rename-file-from-url-through-macro-in-excel/59287838#59287838", "title": "Download &amp; rename file from URL through macro in excel", "body": "<p>Could be an issue with the function declaration for 64bit.\nTry</p>\n\n<pre><code>#If Win64 Then\n    Private Declare PtrSafe Function URLDownloadToFile Lib \"urlmon\" Alias \"URLDownloadToFileA\" _\n   (ByVal pCaller As LongPtr, _\n    ByVal szURL As String, _\n    ByVal szFileName As String, _\n    ByVal dwReserved As Long, _\n    ByVal lpfnCB As LongPtr) As LongPtr\n#Else\n    Private Declare Function URLDownloadToFile Lib \"urlmon\" Alias \"URLDownloadToFileA\" _\n   (ByVal pCaller As Long, _\n    ByVal szURL As String, _\n    ByVal szFileName As String, _\n    ByVal dwReserved As Long, _\n    ByVal lpfnCB As Long) As Long\n#End If\n</code></pre>\n\n<p><strong>Update</strong>: If the download fails, the function returns an error code. However, if the file can be downloaded but cannot be written locally (eg invalid filename, no write permission...), the function returns 0.</p>\n"}], "owner": {"reputation": 79, "user_id": 12010837, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-x5Ek2RSPdeI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reOO8P_bKzxN78KaghG8CM98pOWvQ/photo.jpg?sz=128", "display_name": "Sameer Farooqui", "link": "https://stackoverflow.com/users/12010837/sameer-farooqui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1070, "favorite_count": 0, "accepted_answer_id": 59287838, "answer_count": 1, "score": 2, "last_activity_date": 1576087162, "creation_date": 1576068746, "last_edit_date": 1576069317, "question_id": 59286276, "link": "https://stackoverflow.com/questions/59286276/download-rename-file-from-url-through-macro-in-excel", "title": "Download &amp; rename file from URL through macro in excel", "body": "<p>I need to download a list of dropbox images links and want to rename the files with new name.</p>\n\n<p>What I want to achieve is if i put the new file name in one cell and the link in the another one it should download the file, rename it and save at the file path mentioned in the FILE PATH to save. If there is any error while downloading the image the status will be updated in the status cell.</p>\n\n<p>For Example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yehLF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yehLF.png\" alt=\"enter image description here\"></a></p>\n\n<p>I will be using this macro on MS Office professional plus 2016 64 bit Win 10.</p>\n\n<p>I am trying the below macro but it is not saving the image:</p>\n\n<pre><code>Option Explicit\n\nPrivate Declare Function URLDownloadToFile Lib \"urlmon\" _\nAlias \"URLDownloadToFileA\" (ByVal pCaller As Long, _\nByVal szURL As String, ByVal szFileName As String, _\nByVal dwReserved As Long, ByVal lpfnCB As Long) As Long\n\nDim Ret As Long\n\n'~~&gt; This is where the images will be saved. Change as applicable\nConst FolderName As String = \"C:\\Temp\\\"\n\nSub Sample()\n    Dim ws As Worksheet\n    Dim LastRow As Long, i As Long\n    Dim strPath As String\n\n    '~~&gt; Name of the sheet which has the list\n    Set ws = Sheets(\"Sheet1\")\n\n    LastRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    For i = 2 To LastRow '&lt;~~ 2 because row 1 has headers\n        strPath = FolderName &amp; ws.Range(\"A\" &amp; i).Value &amp; \".jpg\"\n\n        Ret = URLDownloadToFile(0, ws.Range(\"B\" &amp; i).Value, strPath, 0, 0)\n\n        If Ret = 0 Then\n            ws.Range(\"C\" &amp; i).Value = \"File successfully downloaded\"\n        Else\n            ws.Range(\"C\" &amp; i).Value = \"Unable to download the file\"\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Any help will be appreciated.</p>\n"}, {"tags": ["excel", "vba", "footer"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1576068560, "post_id": 59286106, "comment_id": 104777581, "body": "Have you tried <code>ActiveSheet.PageSetup.CenterFooter = &quot;&amp;ZMy Company&quot; &amp; Chr(10) &amp; &quot;Path and Filename&quot;</code>?"}, {"owner": {"reputation": 1, "user_id": 12518306, "user_type": "registered", "profile_image": "https://graph.facebook.com/1521987201299563/picture?type=large", "display_name": "Jana Meinel", "link": "https://stackoverflow.com/users/12518306/jana-meinel"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1576070409, "post_id": 59286106, "comment_id": 104778642, "body": "Now i did,  i get a second line, but the Text &#39;Path and Filename&#39;  I Also tried:  * .FirstPage.LeftFooter.Text = .LeftFooter (-&gt;one line)  * =ActiveWorkbook.name (-&gt; second Line, but Workbookname as Text and not changing"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1576073679, "post_id": 59286106, "comment_id": 104780531, "body": "Jus change the <code>Path and Filename</code> with the real path and filename. You can save both of them into a variable, and concatenate."}, {"owner": {"reputation": 1, "user_id": 12518306, "user_type": "registered", "profile_image": "https://graph.facebook.com/1521987201299563/picture?type=large", "display_name": "Jana Meinel", "link": "https://stackoverflow.com/users/12518306/jana-meinel"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1576074610, "post_id": 59286106, "comment_id": 104781085, "body": "no, sorry, i need the placeholder / variable for the filename/path in the file, so it will change with every SaveAs"}], "owner": {"reputation": 1, "user_id": 12518306, "user_type": "registered", "profile_image": "https://graph.facebook.com/1521987201299563/picture?type=large", "display_name": "Jana Meinel", "link": "https://stackoverflow.com/users/12518306/jana-meinel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576068172, "creation_date": 1576068172, "question_id": 59286106, "link": "https://stackoverflow.com/questions/59286106/excel-return-wordwrap-second-or-more-lines-in-firstpage-footer", "title": "Excel: Return / Wordwrap / Second or more lines in firstpage.footer?", "body": "<p>i'd like to Change my footers via VBA.</p>\n\n<ul>\n<li>Companyname</li>\n<li>Path and Filename</li>\n</ul>\n\n<p>i can change the standardfooter by</p>\n\n<pre><code>ActiveSheet.PageSetup.LeftFooter = \"&amp;7My Company\" &amp; Chr(10) &amp; \"&amp;Z&amp;F\"\n</code></pre>\n\n<p>but i cant change the FirstPage.Footer to get a wordwrap</p>\n\n<p>My Code is <code>ActiveSheet.PageSetup.FirstPage.LeftFooter.Text \"&amp;7My Company\" &amp; Chr(10) &amp; \"&amp;Z&amp;F\"</code></p>\n\n<p>but i only get 'My Comany' and no second line.</p>\n\n<p>Any suggestions?</p>\n\n<p>Hallo zusammen,</p>\n\n<p>wie bekomme ich einen Zeilenumbruch in die Fu\u00dfzeile der ersten Seite?</p>\n\n<p>Viele Gr\u00fc\u00dfe</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 1, "creation_date": 1576067078, "post_id": 59285641, "comment_id": 104776783, "body": "One thing I noticed, in the first code you use <code>i</code> for <code>For i = 2 To SheetTwoLastRow</code>, and in the second block you use <code>a</code> for the same <code>For a = 2 To SheetTwoLastRow</code>. and <code>i</code> for <code>For i = 2 To SheetOneLastRow</code> If you nest the two inside of each other you might get unexpected results."}, {"owner": {"reputation": 73, "user_id": 10763297, "user_type": "registered", "profile_image": "https://graph.facebook.com/1248055548675933/picture?type=large", "display_name": "Sergej Dikun", "link": "https://stackoverflow.com/users/10763297/sergej-dikun"}, "reply_to_user": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1576068917, "post_id": 59285641, "comment_id": 104777761, "body": "yep, but the main issue still remains :-("}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1576071744, "post_id": 59285641, "comment_id": 104779442, "body": "Where are the IDs?"}, {"owner": {"reputation": 73, "user_id": 10763297, "user_type": "registered", "profile_image": "https://graph.facebook.com/1248055548675933/picture?type=large", "display_name": "Sergej Dikun", "link": "https://stackoverflow.com/users/10763297/sergej-dikun"}, "edited": false, "score": 0, "creation_date": 1576072995, "post_id": 59285641, "comment_id": 104780183, "body": "in column A.   Here are the screenshots:  SheetOne: <a href=\"https://imgur.com/a5RoGSH\" rel=\"nofollow noreferrer\">imgur.com/a5RoGSH</a>  Sheet Two:  <a href=\"https://imgur.com/npXREnj\" rel=\"nofollow noreferrer\">imgur.com/npXREnj</a>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1576073162, "post_id": 59285641, "comment_id": 104780261, "body": "Use MATCH or FIND to find the correct row and then reference that."}, {"owner": {"reputation": 73, "user_id": 10763297, "user_type": "registered", "profile_image": "https://graph.facebook.com/1248055548675933/picture?type=large", "display_name": "Sergej Dikun", "link": "https://stackoverflow.com/users/10763297/sergej-dikun"}, "edited": false, "score": 0, "creation_date": 1576075404, "post_id": 59285641, "comment_id": 104781559, "body": "Thanks SJR, would you have any links to the examples handy? Trying to read some info right now but not too clear of how it works yet."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1576083121, "post_id": 59285641, "comment_id": 104785947, "body": "I&#39;ve posted an answer."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 10763297, "user_type": "registered", "profile_image": "https://graph.facebook.com/1248055548675933/picture?type=large", "display_name": "Sergej Dikun", "link": "https://stackoverflow.com/users/10763297/sergej-dikun"}, "edited": false, "score": 0, "creation_date": 1576078079, "post_id": 59288804, "comment_id": 104783127, "body": "Wow, thanks for that, man! Defo on the right track there. For some reason it missed out on two of the &quot;ID&quot; when I&#39;ve tried it:   <a href=\"https://imgur.com/42e7Y3g\" rel=\"nofollow noreferrer\">imgur.com/42e7Y3g</a>  the image from sheet2 with those IDs there :  <a href=\"https://imgur.com/MB3dSy9\" rel=\"nofollow noreferrer\">imgur.com/MB3dSy9</a>"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 73, "user_id": 10763297, "user_type": "registered", "profile_image": "https://graph.facebook.com/1248055548675933/picture?type=large", "display_name": "Sergej Dikun", "link": "https://stackoverflow.com/users/10763297/sergej-dikun"}, "edited": false, "score": 1, "creation_date": 1576078405, "post_id": 59288804, "comment_id": 104783328, "body": "No idea why the row with &quot;4&quot; gets skipped, as this doesn&#39;t happen for me when I replicate your data. The bottom one gets skipped since &quot;11&quot; is on your first sheet twice, and the data will only be linked to the first one."}, {"owner": {"reputation": 73, "user_id": 10763297, "user_type": "registered", "profile_image": "https://graph.facebook.com/1248055548675933/picture?type=large", "display_name": "Sergej Dikun", "link": "https://stackoverflow.com/users/10763297/sergej-dikun"}, "edited": false, "score": 0, "creation_date": 1576079221, "post_id": 59288804, "comment_id": 104783809, "body": "Cool, I&#39;ve rewritten the IDs and it seemed to work properly this time. Thank you very much for your response and the code. It&#39;s a long learning journey for me with those so it will be messy at the start :-)"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 73, "user_id": 10763297, "user_type": "registered", "profile_image": "https://graph.facebook.com/1248055548675933/picture?type=large", "display_name": "Sergej Dikun", "link": "https://stackoverflow.com/users/10763297/sergej-dikun"}, "edited": false, "score": 0, "creation_date": 1576079861, "post_id": 59288804, "comment_id": 104784181, "body": "No problem, happy to help. We&#39;ve all had to learn sometime, and it&#39;s not too long ago for me learning all this. Just happy I can pas it on."}, {"owner": {"reputation": 73, "user_id": 10763297, "user_type": "registered", "profile_image": "https://graph.facebook.com/1248055548675933/picture?type=large", "display_name": "Sergej Dikun", "link": "https://stackoverflow.com/users/10763297/sergej-dikun"}, "edited": false, "score": 0, "creation_date": 1576154974, "post_id": 59288804, "comment_id": 104812243, "body": "hmm... for whatever reason it started to give an error &quot;Object variable or With block variable not set&quot; at this line:   ``` Foundrow = SheetOneWs.Range(&quot;A1:A&quot; &amp; SheetOneLastRow).Find(cel.Value).Row - 1 ````"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 73, "user_id": 10763297, "user_type": "registered", "profile_image": "https://graph.facebook.com/1248055548675933/picture?type=large", "display_name": "Sergej Dikun", "link": "https://stackoverflow.com/users/10763297/sergej-dikun"}, "edited": false, "score": 0, "creation_date": 1576160906, "post_id": 59288804, "comment_id": 104815759, "body": "Most likely you made a change in the structure, which means now one of the variables isn&#39;t filled before you are trying to use it. Either <code>cel</code> or the last row."}], "tags": [], "owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "is_accepted": false, "score": 1, "last_activity_date": 1576077092, "creation_date": 1576077092, "answer_id": 59288804, "question_id": 59285641, "link": "https://stackoverflow.com/questions/59285641/building-a-loop-based-on-if-statement-of-two-ranges-in-vba/59288804#59288804", "title": "building a loop based on if statement of two ranges in vba", "body": "<p>Because I couldn't really bear looking at your horribly inefficient code, I've reworked it here based on the data provided in your previous question.</p>\n\n<p>What this does is it loops over sheet 2 column A. Then for every cell it finds the corresponding ID and stores the row in \"Hit\".</p>\n\n<p>It then finds three values in the row of the cell, and adds the month linked to every hit to the correct place in an array.</p>\n\n<p>Then it pastes the array in one go to the correct range in sheet 1.</p>\n\n<pre><code>Sub movingValues()\n\n    Dim SheetOneWs As Worksheet, SheetTwoWs As Worksheet\n    Dim SheetOneLastRow As Long, SheetTwoLastRow As Long\n    Dim cel As Range, hit As Range\n    Dim Foundrow As Integer\n    Dim arr() As Variant\n\n    Application.Calculation = xlCalculationManual\n\n    Set SheetOneWs = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set SheetTwoWs = ThisWorkbook.Worksheets(\"Sheet2\")\n    SheetOneLastRow = SheetOneWs.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    SheetTwoLastRow = SheetTwoWs.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    ReDim arr(1 To SheetOneLastRow - 1, 1 To 3)\n\n    For Each cel In SheetTwoWs.Range(\"A2:A\" &amp; SheetTwoLastRow)\n        Foundrow = SheetOneWs.Range(\"A1:A\" &amp; SheetOneLastRow).Find(cel.Value).Row - 1\n            If Not Foundrow = 0 Then\n                Set hit = SheetTwoWs.Rows(cel.Row).Find(\"No\", SearchDirection:=xlNext)\n                If Not hit Is Nothing Then\n                    arr(Foundrow, 1) = SheetTwoWs.Cells(1, hit.Column).Value\n                        Else\n                        arr(Foundrow, 1) = \"No Data\"\n                End If\n                Set hit = SheetTwoWs.Rows(cel.Row).Find(\"Maybe\", SearchDirection:=xlNext)\n                If Not hit Is Nothing Then\n                    arr(Foundrow, 2) = SheetTwoWs.Cells(1, hit.Column).Value\n                        Else\n                        arr(Foundrow, 2) = \"No Data\"\n                End If\n                Set hit = SheetTwoWs.Rows(cel.Row).Find(\"Yes\", SearchDirection:=xlNext)\n                If Not hit Is Nothing Then\n                    arr(Foundrow, 3) = SheetTwoWs.Cells(1, hit.Column).Value\n                        Else\n                        arr(Foundrow, 3) = \"No Data\"\n                End If\n            End If\n    Next cel\n\n    SheetOneWs.Range(\"B2:D\" &amp; SheetOneLastRow) = arr\n\nEnd Sub\n</code></pre>\n\n<p>As you can probably see when trying it, reading your values into an array first makes this pretty much instant, since it saves on \"expensive\" write actions. With the tests in place and this structure it should be much more straightforward and rigid than your previous code. Using <code>Find</code> means it only needs to loop over each row once, further increasing performance.</p>\n\n<p>Please note, it's best to back up your data before trying in case of unexpected results and/or errors.</p>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 10763297, "user_type": "registered", "profile_image": "https://graph.facebook.com/1248055548675933/picture?type=large", "display_name": "Sergej Dikun", "link": "https://stackoverflow.com/users/10763297/sergej-dikun"}, "edited": false, "score": 0, "creation_date": 1576154894, "post_id": 59288927, "comment_id": 104812209, "body": "Thanks for that. However, if it doesn&#39;t find the value, macros throws an error. To replicate, remove one of three values and you will get an error. I like that it&#39;s much less code though!"}, {"owner": {"reputation": 73, "user_id": 10763297, "user_type": "registered", "profile_image": "https://graph.facebook.com/1248055548675933/picture?type=large", "display_name": "Sergej Dikun", "link": "https://stackoverflow.com/users/10763297/sergej-dikun"}, "edited": false, "score": 0, "creation_date": 1576155979, "post_id": 59288927, "comment_id": 104812844, "body": "alright adding  &quot;On Error Resume Next&quot; seemed to fixed the issue. It leaves out the empty space though, should I just add the line separetly that if value is &quot; &quot; then set value to &quot;no data found&quot; or there is another better way? :-)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 73, "user_id": 10763297, "user_type": "registered", "profile_image": "https://graph.facebook.com/1248055548675933/picture?type=large", "display_name": "Sergej Dikun", "link": "https://stackoverflow.com/users/10763297/sergej-dikun"}, "edited": false, "score": 0, "creation_date": 1576156349, "post_id": 59288927, "comment_id": 104813043, "body": "Could easily build in similar error trapping as the <code>If IsNumeric(v) Then</code> line."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1576077545, "creation_date": 1576077545, "answer_id": 59288927, "question_id": 59285641, "link": "https://stackoverflow.com/questions/59285641/building-a-loop-based-on-if-statement-of-two-ranges-in-vba/59288927#59288927", "title": "building a loop based on if statement of two ranges in vba", "body": "<p>As far as I can tell, this does what you want.</p>\n\n<pre><code>Sub x()\n\nDim rID As Range, rMonth As Range, rData As Range, rCell As Range, v As Variant\n\nWith Worksheets(\"SheetTwo\")\n    Set rID = .Range(\"A2\", .Range(\"A\" &amp; Rows.Count).End(xlUp))\n    Set rMonth = .Range(\"B1:M1\")\n    Set rData = .Range(\"B2\").Resize(rID.Rows.Count, rMonth.Columns.Count)\nEnd With\n\nWith Worksheets(\"SheetOne\")\n    For Each rCell In .Range(\"A2\", .Range(\"A\" &amp; Rows.Count).End(xlUp))\n        v = Application.Match(rCell.Value, rID, 0)\n        If IsNumeric(v) Then\n            rCell.Offset(, 1).Value = rMonth.Cells(Application.Match(\"No\", rData.Rows(v), 0))\n            rCell.Offset(, 2).Value = rMonth.Cells(Application.Match(\"Maybe\", rData.Rows(v), 0))\n            rCell.Offset(, 3).Value = rMonth.Cells(Application.Match(\"Yes\", rData.Rows(v), 0))\n        End If\n    Next rCell\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 10763297, "user_type": "registered", "profile_image": "https://graph.facebook.com/1248055548675933/picture?type=large", "display_name": "Sergej Dikun", "link": "https://stackoverflow.com/users/10763297/sergej-dikun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 59288927, "answer_count": 2, "score": 0, "last_activity_date": 1576077545, "creation_date": 1576066566, "question_id": 59285641, "link": "https://stackoverflow.com/questions/59285641/building-a-loop-based-on-if-statement-of-two-ranges-in-vba", "title": "building a loop based on if statement of two ranges in vba", "body": "<p>Thank you in advance for your help.</p>\n\n<p>I am trying to build a macro (which in the end will be part of a bigger macro) that will compare two IDs and based on findings will perform another operation.</p>\n\n<p>The code that I have at the moment only copies the values for each row without any consideration of ID in the first column. Here is the code: </p>\n\n<pre><code>Sub movingValues()\n\n    'declaring/setting variables\n\n    Dim SheetOneWs As Worksheet, SheetTwoWs As Worksheet\n    Dim SheetOneLastRow As Long, SheetTwoLastRow As Long\n    Dim SheetOneRng As Range, SheetTwoRng As Range\n    Dim cell As Range, i As Integer\n\n    Application.Calculation = xlCalculationManual\n\n    Set SheetOneWs = ThisWorkbook.Worksheets(\"SheetOne\")\n    Set SheetTwoWs = ThisWorkbook.Worksheets(\"SheetTwo\")\n    SheetOneLastRow = SheetOneWs.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    SheetTwoLastRow = SheetTwoWs.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Set SheetOneRng = SheetOneWs.Range(\"A2:D13\" &amp; SheetOneLastRow)\n    Set SheetTwoRng = SheetTwoWs.Range(\"A2:M13\" &amp; SheetTwoLastRow)\n\n    SheetOneWs.Range(\"B2:D13\").Value = \"\"\n\n    For i = 2 To SheetTwoLastRow\n        'For Each cell In SheetTwoWs.Range(Cells(i, \"B\"), Cells(i, \"M\"))\n        For Each cell In SheetTwoWs.Range(\"B\" &amp; i &amp; \":\" &amp; \"M\" &amp; i)\n            If cell.Value = \"No\" Then\n                SheetOneWs.Cells(cell.Row, \"B\").Value = SheetTwoWs.Cells(1, cell.Column)\n                Exit For\n            End If\n            SheetOneWs.Cells(cell.Row, \"B\").Value = \"No data\"\n        Next cell\n        For Each cell In SheetTwoWs.Range(\"B\" &amp; i &amp; \":\" &amp; \"M\" &amp; i)\n            If cell.Value = \"Maybe\" Then\n                SheetOneWs.Cells(cell.Row, \"C\").Value = SheetTwoWs.Cells(1, cell.Column)\n                Exit For\n            End If\n            SheetOneWs.Cells(cell.Row, \"C\").Value = \"No data\"\n        Next cell\n        For Each cell In SheetTwoWs.Range(\"B\" &amp; i &amp; \":\" &amp; \"M\" &amp; i)\n            If cell.Value = \"Yes\" Then\n                SheetOneWs.Cells(cell.Row, \"D\").Value = SheetTwoWs.Cells(1, cell.Column)\n                Exit For\n            End If\n            SheetOneWs.Cells(cell.Row, \"D\").Value = \"No data\"\n        Next cell\n\n    Next i\n\n\n    Application.Calculation = xlCalculationManual\nEnd Sub\n</code></pre>\n\n<p>My understanding is that I need to place that inside of another loop to match the IDs, so far I've tried: </p>\n\n<pre><code>For i = 2 To SheetOneLastRow\n\n\n    For a = 2 To SheetTwoLastRow\n\n\n    valTwo = Worksheets(\"SheetTwo\").Range(\"A\" &amp; a).Value\n\n    If Cells(i, 1) = valTwo Then\n\n     'CODE FROM ABOVE'\n\n    End if\n  Next a\nNext i\n\n</code></pre>\n\n<p>doesn't seem to work the way I intend it too, all your help will be greatly appreciated. The code initially was taken from the answer in here: <a href=\"https://stackoverflow.com/questions/59198330/issue-with-copying-values-based-on-condition-from-one-sheet-to-another-vba\">Issue with copying values based on condition from one sheet to another VBA</a></p>\n\n<p>Thank you once again for all your answers.</p>\n\n<p>Best Regards,\nSergej</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1576062801, "post_id": 59284442, "comment_id": 104774680, "body": "Since this is a recorded macro, you probably won&#39;t have <code>Book4</code> opened upon running again. You better study information given in <a href=\"https://stackoverflow.com/q/10714251/9758194\">this</a> Q&amp;A on how to use proper explicit referencing as there is a lot to improve on this code (recorded macro&#39;s in general)"}, {"owner": {"reputation": 11, "user_id": 12123256, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-t6PjTCxNLeI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdH7QdH3PqJDz2WfglQVtzhCzW-SQ/photo.jpg?sz=128", "display_name": "Fadhilah Afif", "link": "https://stackoverflow.com/users/12123256/fadhilah-afif"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1576064371, "post_id": 59284442, "comment_id": 104775493, "body": "Hi I am very new to VBA - so this is pretty tough for me to digest I gave a shot at editting the code but I&#39;m now getting an &quot;Invalid Qualifier&quot; error. I&#39;m editting the post for my editted code.."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1576068246, "post_id": 59284442, "comment_id": 104777418, "body": "Which workbook is &quot;Split BU (HUTAS)&quot; in?  Is it <code>ThisWorkbook.Sheets(&quot;Split BU (HUTAS)&quot;)</code>, or <code>wbS.Sheets(&quot;Split BU (HUTAS)&quot;)</code>?  Always try to Fully Qualify your Objects!"}, {"owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "edited": false, "score": 0, "creation_date": 1576074711, "post_id": 59284442, "comment_id": 104781141, "body": "You&#39;re declaring a String <code>Dim Aname As String</code> <code>Aname = ActiveWorkbook.Sheets(1).Range(&quot;A1&quot;).Value</code> and then trying to copy a worksheet <code>Dim wsSplitBU As Worksheet</code> there <code>wsSplitBU.Copy After:=Aname.Sheets(1)</code>?"}, {"owner": {"reputation": 11, "user_id": 12123256, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-t6PjTCxNLeI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdH7QdH3PqJDz2WfglQVtzhCzW-SQ/photo.jpg?sz=128", "display_name": "Fadhilah Afif", "link": "https://stackoverflow.com/users/12123256/fadhilah-afif"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1576113234, "post_id": 59284442, "comment_id": 104796951, "body": "@Chronocidal i think i am having trouble with qualifying objects in general. This sheet exists in my main macro workbook which I&#39;d like to copy into a new worksheet (that does not have macros) to distribute the report."}, {"owner": {"reputation": 11, "user_id": 12123256, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-t6PjTCxNLeI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdH7QdH3PqJDz2WfglQVtzhCzW-SQ/photo.jpg?sz=128", "display_name": "Fadhilah Afif", "link": "https://stackoverflow.com/users/12123256/fadhilah-afif"}, "reply_to_user": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "edited": false, "score": 0, "creation_date": 1576113364, "post_id": 59284442, "comment_id": 104796980, "body": "@VitaliyPrushak Yes I am having some trouble quantifying the correct object. The idea is that I would like to duplicate these couple of sheets into a new workbook (that is not macro enabled) to distribute out to people .. Would u be able to advise on the right object to qualify?"}, {"owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "edited": false, "score": 0, "creation_date": 1576137395, "post_id": 59284442, "comment_id": 104803111, "body": "@FadhilahAfif what do you have here <code>ActiveWorkbook.Sheets(1).Range(&quot;A1&quot;).Value</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "is_accepted": false, "score": 1, "last_activity_date": 1576152271, "creation_date": 1576152271, "answer_id": 59304172, "question_id": 59284442, "link": "https://stackoverflow.com/questions/59284442/copying-multiple-sheets-into-a-new-workbook-for-distribution/59304172#59304172", "title": "Copying multiple sheets into a new workbook (for distribution)", "body": "<p>Here is the code that <strong><em>I assume</em></strong> you have tried to create. There are a lot of not clear details like sheets' references to workbooks for me to be sure that I do what you planned to have.</p>\n\n<p>I've divided code into blocks in effort to make it more readable. So read comments, think about and don't forget that this logic is only assumption.</p>\n\n<pre><code>Sub Data_Cleanser()\n\nApplication.ScreenUpdating = False\n\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n' Declaring the source workbook                                     '\n' source WB will be the one that holds this code,                   '\n' I assume that this is the - Workbooks(\"Spend automator.xlsm\")     '\nDim sourceWB As Workbook                                            '\nSet sourceWB = ThisWorkbook                                         '\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'        Declaring sheets to copy as per provided code:             '\n'        wsPivotM.Copy                                              '\n'        wsSplitBU.Copy                                             '\n'        wsLocalS.Copy                                              '\n'        wsPlantSp.Copy                                             '\n                                                                    '\nDim wsPivotM As Worksheet                                           '\nSet wsPivotM = sourceWB.Sheets(\"Pivot\")                             '\n                                                                    '\nDim wsSplitBU As Worksheet                                          '\nSet wsSplitBU = sourceWB.Sheets(\"Split BU (HUTAS)\")                 '\n                                                                    '\nDim wsLocalS As Worksheet                                           '\nSet wsLocalS = sourceWB.Sheets(\"Localization Spend\")                '\n                                                                    '\nDim wsPlantSp As Worksheet                                          '\nSet wsPlantSp = sourceWB.Sheets(\"Bedok, Changi, Bandung Spend\")     '\n                                                                    '\n'       I can't determine which workbook holds these sheets,        '\n'       so I assume that it is also in a source workbook            '\nDim wsRaw As Worksheet                                              '\nSet wsRaw = sourceWB.Sheets(\"RAW DATA\")                             '\nDim wsPivot As Worksheet                                            '\nSet wsPivot = sourceWB.Sheets(\"Pivot_RAW_DATA\")                     '\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'   Populate formula - I didn't change anything here                                                '\n'   because I have no idea what do you need it for                                                  '\n                                                                                                    '\nDim lastRowRD As Long                                                                               '\nlastRowRD = wsRaw.Cells(Rows.Count, \"A\").End(xlUp).Row                                              '\n                                                                                                    '\n[Aa1].Resize(lastRowRD - 1, 1).FormulaR1C1 = (\"BU Correction Generator\")                            '\n[Aa2].Resize(lastRowRD - 1, 1).Formula = (\"=VLOOKUP(N2,'BU CORRECTOR REFERENCE'!$A:$C,3,FALSE)\")    '\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'Refresh Pivots                                         '\nWith wsPivot                                            '\n    .PivotTables(\"PivotTable9\").PivotCache.Refresh      '\n    .PivotTables(\"PivotTable1\").PivotCache.Refresh      '\n    .PivotTables(\"PivotTable2\").PivotCache.Refresh      '\nEnd With                                                '\n                                                        '\nwsPivotM.PivotTables(\"PivotTable3\").PivotCache.Refresh  '\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'   This is useless code which generates your error:                            '\n'Dim SpendReport As Workbook                                                    '\n'Set SpendReport = ActiveWorkbook.Sheets(1).Range(\"A1\").Value                   '\n'Workbooks.Add                                                                  '\n                                                                                '\n'   you cannot assign a cell value to a Workbook object                         '\n'   if you mean that cell ActiveWorkbook.Sheets(1).Range(\"A1\").Value            '\n'   contains the FileName - you should use it in a different way                '\n'   (I assume that this sheet is also on the source WorkBook):                  '\n                                                                                '\n'Dim targetWB As Workbook                                                       '\n'Set targetWB = Workbooks.Add(sourceWB.Sheets(1).Range(\"A1\").Value &amp; \".xls\")    ' -&gt; If you decide to use this approach-\n                                                                                '                                       |\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''                                       |\n'Create new distributable workbook  '                                                                                   |\nDim targetWB As Workbook            '&lt;---------------- Do not use this part --------------------------------------------\nSet targetWB = Workbooks.Add        '\n'''''''''''''''''''''''''''''''''''''\n\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'   Copying sheetes as per provided code                            '\n                                                                    '\n'wsPivotM.Copy                                                      '\n'wbS.Activate                                                       '\n'wsSplitBU.Copy After:=SpendReport.Sheets(1)                        '\n'wbS.Activate                                                       '\n'wsLocalS.Copy After:=SpendReport.Sheets(2)                         '\n'wbS.Activate                                                       '\n'wsPlantSp.Copy After:=SpendReport.Sheets(3)                        '\nWith targetWB                                                       '\n    wsPivotM.Copy after:=.Sheets(.Sheets.Count)                     ' &lt;- I'm not sure that you won't copy reference to Pivot table in source WB\n    wsSplitBU.Copy after:=.Sheets(.Sheets.Count)                    '\n    wsLocalS.Copy after:=.Sheets(.Sheets.Count)                     '\n    wsPlantSp.Copy after:=.Sheets(.Sheets.Count)                    '\nEnd With                                                            '\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'   The code below looks like complete mess                                     '\n                                                                                '\n'Range(\"B4:M8\").Select                                                          '\n'Selection.Copy                                                                 '\n'Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _   '\n'    :=False, Transpose:=False                                                  '\n'Sheets(\"Localization Spend\").Select                                            '\n'Range(\"B3:M19\").Select                                                         '\n'Application.CutCopyMode = False                                                '\n'Selection.Copy                                                                 '\n'Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _   '\n'    :=False, Transpose:=False                                                  '\n'Range(\"L1:M1\").Select                                                          '\n'Application.CutCopyMode = False                                                '\n'Selection.Copy                                                                 '\n'Range(\"L2\").Select                                                             '\n'ActiveSheet.Paste                                                              '\n'Sheets(\"Split BU (HUTAS)\").Select                                              '\n'ActiveWindow.ScrollColumn = 9         &lt;- This is just a macro recorder's stuff,'\n'ActiveWindow.ScrollColumn = 3            you don't need it in your code        '\n'Range(\"C18:N46\").Select                                                        '\n'Application.CutCopyMode = False                                                '\n'Selection.Copy                                                                 '\n'Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _   '\n'    :=False, Transpose:=False                                                  '\n'Range(\"M1:N1\").Select                                                          '\n'Application.CutCopyMode = False                                                '\n'Selection.Copy                                                                 '\n'Range(\"M2\").Select                                                             '\n'ActiveSheet.Paste                                                              '\n'Sheets(\"Pivot\").Select                                                         '\n'Application.CutCopyMode = False                                                '\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n                                                                                '\n'   Here is what I assume the code above should do:                             '\n                                                                                '\n'   Reset sheets (as those copied have same name, but in another workbook)      '\n'   to have short and exact names                                               '\nWith targetWB                                                                   '\n    Set wsPivotM = .Sheets(\"Pivot\")                                             '\n    Set wsSplitBU = .Sheets(\"Split BU (HUTAS)\")                                 '\n    Set wsLocalS = .Sheets(\"Localization Spend\")                                '\n    Set wsPlantSp = .Sheets(\"Bedok, Changi, Bandung Spend\")                     '\nEnd With                                                                        '\n                                                                                '\n'   As far as I understand - you want to replace formulas with just values      '\nWith wsPlantSp                                                                  '\n    .Range(\"B4:M8\").Copy                                                        '\n    .Range(\"B4\").PasteSpecial Paste:=xlPasteValues                              ' Operation:=xlNone, SkipBlanks:=False, Transpose:=False - these are default\nEnd With                                                                        ' values, no need to specify it\n                                                                                '\nWith wsLocalS                                                                   '\n    .Range(\"B3:M19\").Copy                                                       '\n    .Range(\"B3\").PasteSpecial Paste:=xlPasteValues                              '\n    .Range(\"L1:M1\").Copy .Range(\"L2\")                                           '\nEnd With                                                                        '\n                                                                                '\nWith wsSplitBU                                                                  '\n    .Range(\"C18:N46\").Copy                                                      '\n    .Range(\"C18\").PasteSpecial Paste:=xlPasteValues                             '\n    .Range(\"M1:N1\").Copy .Range(\"M2\")                                           '\nEnd With                                                                        '\n                                                                                '\nApplication.ScreenUpdating = True                                               '                                                                               '\nwsPivotM.Activate                                                               '\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n' You will not need to save the workbook in case you have used\n' Set targetWB = Workbooks.Add(sourceWB.Sheets(1).Range(\"A1\").Value &amp; \".xls\")\n' described it in the code above\n\ntargetWB.SaveAs Filename:=sourceWB.Sheets(1).Range(\"A1\").Value &amp; \".xls\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12123256, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-t6PjTCxNLeI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdH7QdH3PqJDz2WfglQVtzhCzW-SQ/photo.jpg?sz=128", "display_name": "Fadhilah Afif", "link": "https://stackoverflow.com/users/12123256/fadhilah-afif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1576152271, "creation_date": 1576062450, "last_edit_date": 1576114441, "question_id": 59284442, "link": "https://stackoverflow.com/questions/59284442/copying-multiple-sheets-into-a-new-workbook-for-distribution", "title": "Copying multiple sheets into a new workbook (for distribution)", "body": "<p>Editting the post for a new code which is giving an \"Invalid Qualifier\" Error</p>\n\n<p>I am having trouble editing this vba code after recording a macro. The macro code is as per below. </p>\n\n<p>I am now getting an \"object not defined\" error at this line\"Dim SpendReport As Workbook\nSet SpendReport = ActiveWorkbook.Sheets(1).Range(\"A1\").Value\nWorkbooks.Add\"</p>\n\n<p>Highly suspecting is my variable definition thats wrong ?</p>\n\n<p>The idea here is to duplicate these 4 sheets into a whole new workbook and then pasting them as values prior to saving. </p>\n\n<p>Would an expert here be able to help with the editting of the code to make this more flexible? </p>\n\n<p>Thank you!</p>\n\n<p>New editted code with object error:</p>\n\n<pre><code>Sub Data_Cleanser()\n\n'\n'\n\n'\n\nApplication.ScreenUpdating = False\n\nDim wsRaw As Worksheet\nSet wsRaw = Sheets(\"RAW DATA\")\nDim wsPivot As Worksheet\nSet wsPivot = Sheets(\"Pivot_RAW_DATA\")\nDim wsPivotM As Worksheet\nSet wsPivotM = Sheets(\"Pivot\")\nDim lastRowRD As Long\nlastRowRD = wsRaw.Cells(Rows.Count, \"A\").End(xlUp).Row\nDim wbS As Workbook\nSet wbS = Workbooks(\"Spend automator.xlsm\")\nDim wsSplitBU As Worksheet\nSet wsSplitBU = Sheets(\"Split BU (HUTAS)\")\nDim wsLocalS As Worksheet\nSet wsLocalS = Sheets(\"Localization Spend\")\nDim wsPlantSp As Worksheet\nSet wsPlantSp = Sheets(\"Bedok, Changi, Bandung Spend\")\n\n''''''''''''''''''''''''''''''\n'Populate formula'\n''''''''''''''''''''''''''''''\n\n[Aa1].Resize(lastRowRD - 1, 1).FormulaR1C1 = (\"BU Correction Generator\")\n[Aa2].Resize(lastRowRD - 1, 1).Formula = (\"=VLOOKUP(N2,'BU CORRECTOR REFERENCE'!$A:$C,3,FALSE)\")\n\n''''''''''''''''''''''''''''''\n'Refresh Pivot'\n''''''''''''''''''''''''''''''\n\nwsPivot.Select\nActiveSheet.PivotTables(\"PivotTable9\").PivotCache.Refresh\nActiveSheet.PivotTables(\"PivotTable1\").PivotCache.Refresh\nActiveSheet.PivotTables(\"PivotTable2\").PivotCache.Refresh\nwsPivotM.Select\nActiveSheet.PivotTables(\"PivotTable3\").PivotCache.Refresh\n\nDim SpendReport As Workbook\nSet SpendReport = ActiveWorkbook.Sheets(1).Range(\"A1\").Value\nWorkbooks.Add\n\n''''''''''''''''''''''''''''''\n'Create new distributable workbook'\n''''''''''''''''''''''''''''''\n\n    wsPivotM.Copy\n    wbS.Activate\n    wsSplitBU.Copy After:=SpendReport.Sheets(1)\n    wbS.Activate\n    wsLocalS.Copy After:=SpendReport.Sheets(2)\n    wbS.Activate\n    wsPlantSp.Copy After:=SpendReport.Sheets( _\n    3)\n    Range(\"B4:M8\").Select\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Sheets(\"Localization Spend\").Select\n    Range(\"B3:M19\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Range(\"L1:M1\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Range(\"L2\").Select\n    ActiveSheet.Paste\n    Sheets(\"Split BU (HUTAS)\").Select\n    ActiveWindow.ScrollColumn = 9\n    ActiveWindow.ScrollColumn = 3\n    Range(\"C18:N46\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Range(\"M1:N1\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Range(\"M2\").Select\n    ActiveSheet.Paste\n    Sheets(\"Pivot\").Select\n    Application.CutCopyMode = False\n    ActiveWorkbook.SaveAs Filename:=SpendReport &amp; \".xls\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "variables", "set", "vlookup"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1576062499, "post_id": 59284428, "comment_id": 104774501, "body": "So the real question is: <i>&quot;As result, is it possible to use a source workbook to get data from it without opening?&quot;</i> The answer is yes, if they not protected, you can look into <code>ExcecuteExcel4Macro</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1576063114, "post_id": 59284428, "comment_id": 104774842, "body": "<a href=\"https://stackoverflow.com/questions/9259862/executeexcel4macro-to-get-value-from-closed-workbook/9261915#9261915\" title=\"executeexcel4macro to get value from closed workbook\">stackoverflow.com/questions/9259862/&hellip;</a>"}, {"owner": {"reputation": 3, "user_id": 5702390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea9f9336f4155b1c9ef636ab5260c796?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim Bayram", "link": "https://stackoverflow.com/users/5702390/ibrahim-bayram"}, "edited": false, "score": 0, "creation_date": 1576071716, "post_id": 59284428, "comment_id": 104779424, "body": "yes I want to get data but I need to do it via vlookup in vba module, so the problem is that I cannot point source file for search array in vlookup function while source file is closed."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1576076572, "post_id": 59284428, "comment_id": 104782195, "body": "As said in my other comment I think you need to add more details. One idea would be to use ADODB in order to draw data from your worksheet. But for this you need to provide more information on  the structure of the source worksheet and what you want."}, {"owner": {"reputation": 3, "user_id": 5702390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea9f9336f4155b1c9ef636ab5260c796?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim Bayram", "link": "https://stackoverflow.com/users/5702390/ibrahim-bayram"}, "edited": false, "score": 0, "creation_date": 1576079672, "post_id": 59284428, "comment_id": 104784072, "body": "Actually what I want to do is very simple but unfortunately could not succeed to run a vlookup in vba to pull data from a &#39;closed&#39; book.. think that source book has only a sheet with first 2 columns including data, and in my original book I look for value in first column within first column of source book to get corresponding data from second column of source book while it is closed. If it was open, it would not be an issue but now does not seem possible :( for ADODB, first time I heard this, have no idea how to do :("}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5702390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea9f9336f4155b1c9ef636ab5260c796?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim Bayram", "link": "https://stackoverflow.com/users/5702390/ibrahim-bayram"}, "edited": false, "score": 0, "creation_date": 1576070471, "post_id": 59285793, "comment_id": 104778677, "body": "Many thanks, this way I get data from desired cell in source file, but I wonder if I can search a value in source file and get data in cell that is next to found cell, I mean possible to use source file in vlookup function in vba module as array table and pull corresponding data?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 3, "user_id": 5702390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea9f9336f4155b1c9ef636ab5260c796?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim Bayram", "link": "https://stackoverflow.com/users/5702390/ibrahim-bayram"}, "edited": false, "score": 0, "creation_date": 1576071494, "post_id": 59285793, "comment_id": 104779258, "body": "Then I&#39;d suggest you edit your question in order to make the question clearer for everyone. Depending on the structure of the sheet in your source file you want to search for a value it might be possible to use ADODB. But I am just guessing without further information."}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 0, "last_activity_date": 1576067564, "last_edit_date": 1576067564, "creation_date": 1576067111, "answer_id": 59285793, "question_id": 59284428, "link": "https://stackoverflow.com/questions/59284428/how-to-use-vlookup-function-in-vba-by-pointing-table-array-from-a-closed-source/59285793#59285793", "title": "How to use vlookup function in VBA by pointing table array from a closed source workbook?", "body": "<p>Try to use this function</p>\n\n<pre><code>Private Function GetValue(path, file, sheet, ref)\n'   Retrieves a value from a closed workbook\nDim arg As String\n    '   Make sure the file exists\n    If Right(path, 1) &lt;&gt; \"\\\" Then path = path &amp; \"\\\"\n    If Dir(path &amp; file) = \"\" Then\n        GetValue = \"File Not Found\"\n        Exit Function\n    End If\n    '   Create the argument\n    arg = \"'\" &amp; path &amp; \"[\" &amp; file &amp; \"]\" &amp; sheet &amp; \"'!\" &amp; _\n          Range(ref).Range(\"A1\").Address(, , xlR1C1)\n    '   Execute an XLM macro\n    GetValue = ExecuteExcel4Macro(arg)\nEnd Function\n</code></pre>\n\n<p>And a test</p>\n\n<pre><code>Sub TestIt()\n\n    Const dataDir = \"C:\\Users\\Me\\Documents\\\"\n    Const fileName = \"MyReport.xlsx\"\n    Const sheetName = \"Sheet1\"\n    Const cellRef = \"A2\"\n\n    Debug.Print GetValue(dataDir, fileName, sheetName, cellRef)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5702390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea9f9336f4155b1c9ef636ab5260c796?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim Bayram", "link": "https://stackoverflow.com/users/5702390/ibrahim-bayram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 237, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576072332, "creation_date": 1576062410, "last_edit_date": 1576072332, "question_id": 59284428, "link": "https://stackoverflow.com/questions/59284428/how-to-use-vlookup-function-in-vba-by-pointing-table-array-from-a-closed-source", "title": "How to use vlookup function in VBA by pointing table array from a closed source workbook?", "body": "<p>I'm trying to set a public workbook variable behind a command button on UserForm to use later in a module just to read data from it as source workbook with vlookup in VBA. I could not find a way to make this without opening the file, so I used below and then closed the file;</p>\n\n<pre><code>Set wb = Application.Workbooks.Open(filepath, UpdateLinks:=False)\nwb.Close SaveChanges:=False\n</code></pre>\n\n<p>Also in one module I set variable as public as below;</p>\n\n<pre><code>Public wb As Workbook\n</code></pre>\n\n<p>But I noticed that I think because I close source workbook after setting, when VBA reaches to code line in module which is looking for already set source workbook, it gives error in vlookup function.</p>\n\n<p>Actually, I never want source file to be opened. Because file is so big and open/close operations takes a lot of time. Data can be read in other file by vlookup etc. formula without opening the source but I need to do this via VBA.\nAs result, is it possible to use a source workbook to get data from it without opening with application.vlookup? </p>\n"}, {"tags": ["html", "excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1576062135, "post_id": 59284077, "comment_id": 104774291, "body": "You need to use <code>FindWindow</code>, <code>FinwindowEx</code> API to put the filename in that dialog box and then you will need <code>SendMessage</code> API to click on the <code>Open</code> button"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1576062865, "post_id": 59284077, "comment_id": 104774711, "body": "I had written an blog about this 7 years ago. Now it is not available on my website. To view the old content you may want to see <a href=\"http://oldweb.today/firefox/20031211111047/http://www.siddharthrout.com/2012/02/02/vbavb-netvb6click-opensavecancel-button-on-ie-download-window-part-ii/\" rel=\"nofollow noreferrer\">THIS</a> That example shows how the file save as name is entered in the dialog box and the save button is clicked. You have to follow the same logic."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1576063782, "post_id": 59284077, "comment_id": 104775201, "body": "@SiddharthRout Unfortunately, Microsoft messed up the handles for the Buttons when they released IE11, so <code>FindWindowEX</code> can no longer identify them.  You&#39;re stuck using <code>SendKeys</code> instead if you want to do this."}, {"owner": {"reputation": 159, "user_id": 9167093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yumMXrR-vps/AAAAAAAAAAI/AAAAAAAAAAA/TIEk7zjfLXg/photo.jpg?sz=128", "display_name": "kiran mamalwad", "link": "https://stackoverflow.com/users/9167093/kiran-mamalwad"}, "edited": false, "score": 0, "creation_date": 1576064448, "post_id": 59284077, "comment_id": 104775532, "body": "I don&#39;t want to use the SendKeys as it is not reliable, you said Microsoft messed up the handles  for this, so is it possible is we use different browser?"}, {"owner": {"reputation": 1819, "user_id": 10046897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d58775bff3c1d7010b8568a75adacd3b?s=128&d=identicon&r=PG&f=1", "display_name": "Zwenn", "link": "https://stackoverflow.com/users/10046897/zwenn"}, "edited": false, "score": 0, "creation_date": 1576065739, "post_id": 59284077, "comment_id": 104776151, "body": "For other browsers you must use Selenium because they have no COM API. One alternate is to use Word to open the pdfs and overtake the needed information to Excel. Word converts pdfs to editable text."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1576066722, "post_id": 59284077, "comment_id": 104776628, "body": "@Chronocidal: It still works. Just tested it :)"}, {"owner": {"reputation": 159, "user_id": 9167093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yumMXrR-vps/AAAAAAAAAAI/AAAAAAAAAAA/TIEk7zjfLXg/photo.jpg?sz=128", "display_name": "kiran mamalwad", "link": "https://stackoverflow.com/users/9167093/kiran-mamalwad"}, "reply_to_user": {"reputation": 1819, "user_id": 10046897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d58775bff3c1d7010b8568a75adacd3b?s=128&d=identicon&r=PG&f=1", "display_name": "Zwenn", "link": "https://stackoverflow.com/users/10046897/zwenn"}, "edited": false, "score": 0, "creation_date": 1576067019, "post_id": 59284077, "comment_id": 104776767, "body": "@Zwenn: The PDF file is not editable it is a scan image so we can not convert it through the word file."}, {"owner": {"reputation": 159, "user_id": 9167093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yumMXrR-vps/AAAAAAAAAAI/AAAAAAAAAAA/TIEk7zjfLXg/photo.jpg?sz=128", "display_name": "kiran mamalwad", "link": "https://stackoverflow.com/users/9167093/kiran-mamalwad"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1576067136, "post_id": 59284077, "comment_id": 104776814, "body": "@SiddharthRout: could you please attach the code which you tested now, may be it can be helpful for me as I am not able to link which you have provided above."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1576067476, "post_id": 59284077, "comment_id": 104776992, "body": "It is the same code from the above link, Can you please give it a try? And if you do not succeed then post the code that you tried and I will post the complete code here with explanation. That is a promise :)"}, {"owner": {"reputation": 159, "user_id": 9167093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yumMXrR-vps/AAAAAAAAAAI/AAAAAAAAAAA/TIEk7zjfLXg/photo.jpg?sz=128", "display_name": "kiran mamalwad", "link": "https://stackoverflow.com/users/9167093/kiran-mamalwad"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1576067697, "post_id": 59284077, "comment_id": 104777123, "body": "@SiddharthRout: The page is still loading, hence I am not able to read it:)"}, {"owner": {"reputation": 159, "user_id": 9167093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yumMXrR-vps/AAAAAAAAAAI/AAAAAAAAAAA/TIEk7zjfLXg/photo.jpg?sz=128", "display_name": "kiran mamalwad", "link": "https://stackoverflow.com/users/9167093/kiran-mamalwad"}, "edited": false, "score": 0, "creation_date": 1576067886, "post_id": 59284077, "comment_id": 104777229, "body": "can anyone please help me on this?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1576073239, "post_id": 59284077, "comment_id": 104780303, "body": "See <a href=\"https://stackoverflow.com/questions/16174469/unprotect-vbproject-from-vb-code/16176557#16176557\">THIS</a> It works on the same principle..."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1576077072, "post_id": 59284077, "comment_id": 104782475, "body": "SendKeys with selenium is reliable. I used <a href=\"https://stackoverflow.com/a/52906215/6241235\">here</a>   64 bit versions of with SendMessageW and FindWindowExW"}, {"owner": {"reputation": 1819, "user_id": 10046897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d58775bff3c1d7010b8568a75adacd3b?s=128&d=identicon&r=PG&f=1", "display_name": "Zwenn", "link": "https://stackoverflow.com/users/10046897/zwenn"}, "edited": false, "score": 0, "creation_date": 1576079716, "post_id": 59284077, "comment_id": 104784103, "body": "Ok, there is no need to click the save button. The button &#39;Free Download&#39; includes an a tag with the link to the converted file. You can download it with the URLDownloadToFile function."}, {"owner": {"reputation": 159, "user_id": 9167093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yumMXrR-vps/AAAAAAAAAAI/AAAAAAAAAAA/TIEk7zjfLXg/photo.jpg?sz=128", "display_name": "kiran mamalwad", "link": "https://stackoverflow.com/users/9167093/kiran-mamalwad"}, "reply_to_user": {"reputation": 1819, "user_id": 10046897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d58775bff3c1d7010b8568a75adacd3b?s=128&d=identicon&r=PG&f=1", "display_name": "Zwenn", "link": "https://stackoverflow.com/users/10046897/zwenn"}, "edited": false, "score": 0, "creation_date": 1576496051, "post_id": 59284077, "comment_id": 104906189, "body": "@Zwenn This is to download the converted file but the question is how to upload it."}], "owner": {"reputation": 159, "user_id": 9167093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yumMXrR-vps/AAAAAAAAAAI/AAAAAAAAAAA/TIEk7zjfLXg/photo.jpg?sz=128", "display_name": "kiran mamalwad", "link": "https://stackoverflow.com/users/9167093/kiran-mamalwad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 275, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576061314, "creation_date": 1576061248, "last_edit_date": 1576061314, "question_id": 59284077, "link": "https://stackoverflow.com/questions/59284077/excel-vba-macro-to-upload-a-file-on-website", "title": "Excel VBA Macro To upload a File on website", "body": "<p>I am trying to convert the PDF file to excel via online converter. To do that I need to upload the file through browser button so I created a code till clicking on the button however I am not able to choose the file from dialog box.</p>\n\n<p>Please help me in below code.</p>\n\n<pre><code>Sub autoIE()\n\nDim ie As Object\nDim Hdoc As HTMLDocument\nWorksheets(\"Sheet6\").Activate\nRange(\"B1\").Copy\nSet ie = CreateObject(\"InternetExplorer.Application\")\nie.navigate \"https://www.pdftoexcelconverter.net/\"\nie.Visible = True\nWhile ie.Busy\nDoEvents\nWend\n\nSet Hdoc = ie.document\nHdoc.all(\"Filedata\").Click\n\nHdoc.Value = (\"C:\\Users\\kiranm\\Desktop\\2019\\11.pdf\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "combobox"], "answers": [{"comments": [{"owner": {"reputation": 496, "user_id": 9048996, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KEEZ8.jpg?s=128&g=1", "display_name": "Thameem", "link": "https://stackoverflow.com/users/9048996/thameem"}, "edited": false, "score": 0, "creation_date": 1576059314, "post_id": 59283374, "comment_id": 104772696, "body": "First of all thanks for responding in urgency. Where do i include the criteria / where clause. I mean i need the branch ids of a particular user id from the permission table."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 496, "user_id": 9048996, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KEEZ8.jpg?s=128&g=1", "display_name": "Thameem", "link": "https://stackoverflow.com/users/9048996/thameem"}, "edited": false, "score": 0, "creation_date": 1576060039, "post_id": 59283374, "comment_id": 104773101, "body": "The query is just how it appears by default. For your new combobox, you can add/include any filter or other sorting the usual way."}, {"owner": {"reputation": 496, "user_id": 9048996, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KEEZ8.jpg?s=128&g=1", "display_name": "Thameem", "link": "https://stackoverflow.com/users/9048996/thameem"}, "edited": false, "score": 0, "creation_date": 1576062462, "post_id": 59283374, "comment_id": 104774476, "body": "Hi @Gustav. i used Query to come up with a solution. can u tell how to pass a parameter to the query in combox row source"}, {"owner": {"reputation": 496, "user_id": 9048996, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KEEZ8.jpg?s=128&g=1", "display_name": "Thameem", "link": "https://stackoverflow.com/users/9048996/thameem"}, "edited": false, "score": 0, "creation_date": 1576064631, "post_id": 59283374, "comment_id": 104775616, "body": "combo does not get populated"}, {"owner": {"reputation": 496, "user_id": 9048996, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KEEZ8.jpg?s=128&g=1", "display_name": "Thameem", "link": "https://stackoverflow.com/users/9048996/thameem"}, "edited": false, "score": 0, "creation_date": 1576064669, "post_id": 59283374, "comment_id": 104775635, "body": "Do i need to explicitly cast the UserId value as int ?"}, {"owner": {"reputation": 496, "user_id": 9048996, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KEEZ8.jpg?s=128&g=1", "display_name": "Thameem", "link": "https://stackoverflow.com/users/9048996/thameem"}, "edited": false, "score": 1, "creation_date": 1576064877, "post_id": 59283374, "comment_id": 104775746, "body": "Sorry. My mistake was using txtSession.Text. Now removed that extra word: &quot;Text&quot;. Thanks. Its working Perfectly"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1576063513, "last_edit_date": 1576063513, "creation_date": 1576059156, "answer_id": 59283374, "question_id": 59283023, "link": "https://stackoverflow.com/questions/59283023/binding-multivalued-columns-data-into-combo-box-via-vba-ms-access/59283374#59283374", "title": "Binding multivalued column&#39;s data into combo box via vba ms access", "body": "<p>A MultiValue field has little to do with a value list.</p>\n\n<p>Just use the <em>RowSource</em> property of the MultiValue field, like:</p>\n\n<pre><code>SELECT [TableName].[FieldName] FROM [TableName] ORDER BY [Id];\n</code></pre>\n\n<p>as the <em>RowSource</em> property for your combobox.</p>\n\n<p>Having a filter:</p>\n\n<pre><code>SELECT [TableName].[FieldName] \nFROM [TableName] \nWHERE UserId = [Forms]![NavigationForm]![txtSession]\nORDER BY [Id];\n</code></pre>\n\n<p>or modify the SQL by code to, say:</p>\n\n<pre><code>SELECT [TableName].[FieldName] \nFROM [TableName] \nWHERE UserId = 466\nORDER BY [Id];\n</code></pre>\n\n<p>Applying a revised SQL will automatically requery the combobox.</p>\n"}], "owner": {"reputation": 496, "user_id": 9048996, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KEEZ8.jpg?s=128&g=1", "display_name": "Thameem", "link": "https://stackoverflow.com/users/9048996/thameem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 1, "accepted_answer_id": 59283374, "answer_count": 1, "score": 1, "last_activity_date": 1576063513, "creation_date": 1576058068, "last_edit_date": 1576058445, "question_id": 59283023, "link": "https://stackoverflow.com/questions/59283023/binding-multivalued-columns-data-into-combo-box-via-vba-ms-access", "title": "Binding multivalued column&#39;s data into combo box via vba ms access", "body": "<p>I have a table as follows</p>\n\n<p><a href=\"https://i.stack.imgur.com/49XOW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/49XOW.png\" alt=\"enter image description here\"></a></p>\n\n<p>Where the BranchIds column is a multivalued column referering the ids of the branches table.\nSome how i need to bind the id and its related value in a combo box residing in another access forms as follows\n<a href=\"https://i.stack.imgur.com/Cnc4B.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Cnc4B.png\" alt=\"enter image description here\"></a></p>\n\n<p>The permission table contains the data of which user is allowed to access which branch.\nI am unable to bind the branches from the perimssion table to the combo box in my another form.</p>\n\n<blockquote>\n  <p>The code i am trying. Got from MSDN after a length search..</p>\n</blockquote>\n\n<pre><code>Sub BindBranches()\n   Me.comboBranchIds.RowSourceType = \"Value List\"\n\n   Dim db As Database\n   Dim rs As Recordset\n   Dim childRS As Recordset\n\n   Set db = CurrentDb()\n\n   ' Open a Recordset for the Tasks table.\n   Set rs = db.OpenRecordset(\"SELECT BranchIds FROM Permissions WHERE UserId = \" &amp; Forms!NavigationForm!txtSession.Value)\n   rs.MoveFirst\n\n   Do Until rs.EOF\n      ' Print the name of the task to the Immediate window.\n      'Debug.Print rs!TaskName.Value\n\n      ' Open a Recordset for the multivalued field.\n      Set childRS = rs!BranchIds.Value\n\n         ' Exit the loop if the multivalued field contains no records.\n         Do Until childRS.EOF\n             childRS.MoveFirst\n\n             ' Loop through the records in the child recordset.\n             Do Until childRS.EOF\n                 ' Print the owner(s) of the task to the Immediate\n                 ' window.\n                 'Debug.Print Chr(0), childRS!Value.Value\n                 Me.comboBranchIds.AddItem Item:=childRS!Value.Value\n                 'Me.comboBranchIds.RowSource = \"SELECT BranchName FROM Branches WHERE ID = \" + childRS!Value.Value\n                 childRS.MoveNext\n             Loop\n         Loop\n      rs.MoveNext\n   Loop\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2500, "user_id": 1497597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e86c15a7b980952c674a567853249751?s=128&d=identicon&r=PG", "display_name": "D T", "link": "https://stackoverflow.com/users/1497597/d-t"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1576058458, "post_id": 59282982, "comment_id": 104772217, "body": "If save as target file will can&#39;t working"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1576059974, "post_id": 59282982, "comment_id": 104773065, "body": "<code>ActiveWorkbook.SaveCopyAs strDes</code> Using <code>SaveAs</code> will replace the current workbook with the new copy"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1576060024, "post_id": 59282982, "comment_id": 104773092, "body": "<a href=\"https://stackoverflow.com/questions/18899824/how-to-use-vba-saveas-without-closing-calling-workbook/18901568\" title=\"how to use vba saveas without closing calling workbook\">stackoverflow.com/questions/18899824/&hellip;</a>"}, {"owner": {"reputation": 2500, "user_id": 1497597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e86c15a7b980952c674a567853249751?s=128&d=identicon&r=PG", "display_name": "D T", "link": "https://stackoverflow.com/users/1497597/d-t"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1576060088, "post_id": 59282982, "comment_id": 104773125, "body": "@Tom: it is ok, thank you."}], "answers": [{"tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": true, "score": 1, "last_activity_date": 1576060169, "creation_date": 1576060169, "answer_id": 59283682, "question_id": 59282982, "link": "https://stackoverflow.com/questions/59282982/copy-open-excel-file/59283682#59283682", "title": "Copy Open Excel File", "body": "<p>You may copy the opened file using <code>Scripting.FileSystemObject</code></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub test()\n\n    src = ThisWorkbook.FullName\n    dest = CreateObject(\"WScript.Shell\").SpecialFolders(\"Desktop\") &amp; \"\\\"\n    CreateObject(\"Scripting.FileSystemObject\").CopyFile src, dest\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2500, "user_id": 1497597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e86c15a7b980952c674a567853249751?s=128&d=identicon&r=PG", "display_name": "D T", "link": "https://stackoverflow.com/users/1497597/d-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 59283682, "answer_count": 1, "score": 1, "last_activity_date": 1576060169, "creation_date": 1576057935, "last_edit_date": 1576058138, "question_id": 59282982, "link": "https://stackoverflow.com/questions/59282982/copy-open-excel-file", "title": "Copy Open Excel File", "body": "<p>I want copy target macro to new location:</p>\n\n<pre><code>Dim strDes As String\nstrDes = \"D:\\\" &amp; ActiveWorkbook.Name\nFileCopy ActiveWorkbook.FullName, strDes\n</code></pre>\n\n<p>it occur error </p>\n\n<blockquote>\n  <p>permission denied</p>\n</blockquote>\n\n<p>How can copy an Excel file that is open?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1576213176, "post_id": 59282841, "comment_id": 104833802, "body": "Which line of code is highlighted when you get the error message?"}, {"owner": {"reputation": 89, "user_id": 11668560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add2d558c90cc2f215da9acc20c31f39?s=128&d=identicon&r=PG&f=1", "display_name": "thereal_92", "link": "https://stackoverflow.com/users/11668560/thereal-92"}, "reply_to_user": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1576270461, "post_id": 59282841, "comment_id": 104858698, "body": "@JonPeltier I get the error on copypicture or pastespecial. The error can occurs on first copypicture, or the last pastespecial... It&#39;s a little bit random..."}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1576364392, "post_id": 59282841, "comment_id": 104877329, "body": "I&#39;ve had this kind of error in the past, sporadic and frustrating, with equally meaningless error messages. But to try it out before I posted my comment above, I ran a sample routine that did CopyPicture and PasteSpecial 50 times, and no errors occurred."}], "owner": {"reputation": 89, "user_id": 11668560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add2d558c90cc2f215da9acc20c31f39?s=128&d=identicon&r=PG&f=1", "display_name": "thereal_92", "link": "https://stackoverflow.com/users/11668560/thereal-92"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576059032, "creation_date": 1576057487, "last_edit_date": 1576059032, "question_id": 59282841, "link": "https://stackoverflow.com/questions/59282841/copy-paste-charts-as-pictures", "title": "Copy/paste charts as pictures", "body": "<blockquote>\n  <p>Error:The specified dimension is not valid for the current chart type</p>\n</blockquote>\n\n<p>I have an Excel file, with VBA Code. This file opens lots of other excel files and gets cell ranges and charts /as pictures/ to paste them in its sheets. This code is a part of a Sub that opens the source excel file, copy the chart from the source file and paste it in the workbook with the VBA code.</p>\n\n<pre><code>wsheetSource.ChartObjects(chart1Name).CopyPicture\nwsheet.Range(char1Pos).PasteSpecial\nwsheet.Pictures(wsheet.Pictures.Count).Name = chart1Name 'gives name of the last pasted picture\nSet shp = wsheet.Shapes(chart1Name)\nshp.LockAspectRatio = msoTrue\n\n\nwsheetSource.ChartObjects(chart2Name).CopyPicture\nwsheet.Range(char2Pos).PasteSpecial\nwsheet.Pictures(wsheet.Pictures.Count).Name = chart2Name 'gives name of the last pasted picture\nSet shp = wsheet.Shapes(chart2Name)\nshp.LockAspectRatio = msoTrue\n</code></pre>\n\n<p>The error: when I run this Sub couple of times, on copyPicture or PasteSpecial method, there's a message for error:\nRun-time error '-2147221040 (800401d0)':\nThe specified dimension is not valid for the cirrent chart type</p>\n\n<p>When I click Debug and run the problem line again, the code copies/paste the chart. I don't know what condition should be done to occurs this error. I think that the problem is with the clipboard /because in a few second I make lots of copy/paste operations/, tried to clear the clipboard, when the Sub starts, but with no success . \nhow to avoid this error /the big question: why sometimes there's an error, sometimes-no/\nIs there a way to add statement as: if on this line of code you have error, try to execute this line again /as I mentioned: if I click debug, go to the problem line and click Play button, the code start running/</p>\n\n<p>BR</p>\n"}, {"tags": ["vba", "hyperlink", "spaces"], "answers": [{"tags": [], "owner": {"reputation": 1207, "user_id": 7912486, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KW8ASicNUX8/AAAAAAAAAAI/AAAAAAAAEUw/a1u4b8HPUU4/photo.jpg?sz=128", "display_name": "Ryan Sparks", "link": "https://stackoverflow.com/users/7912486/ryan-sparks"}, "is_accepted": true, "score": 1, "last_activity_date": 1576056431, "creation_date": 1576056431, "answer_id": 59282511, "question_id": 59282344, "link": "https://stackoverflow.com/questions/59282344/hyperlink-with-spaces/59282511#59282511", "title": "Hyperlink with spaces", "body": "<p>To make the hyperlink valid, you just need to wrap the sheet name in quotes, so:</p>\n\n<pre><code>ActiveSheet.Hyperlinks.Add Anchor:=Cells(LastRowA + 1, 2), Address:=\"\", SubAddress:= _\n    project_name &amp; \"!A1\", TextToDisplay:=project_name\n</code></pre>\n\n<p>becomes</p>\n\n<pre><code>ActiveSheet.Hyperlinks.Add Anchor:=Cells(LastRowA + 1, 2), Address:=\"\", SubAddress:=\"'\" &amp; _\n    project_name &amp; \"'\" &amp; \"!A1\", TextToDisplay:=project_name\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 10875002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a3bad97e201b08028d48899f8082ff?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Avidan", "link": "https://stackoverflow.com/users/10875002/dan-avidan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 59282511, "answer_count": 1, "score": 0, "last_activity_date": 1576056431, "creation_date": 1576055883, "question_id": 59282344, "link": "https://stackoverflow.com/questions/59282344/hyperlink-with-spaces", "title": "Hyperlink with spaces", "body": "<p>I have a worksheets for my projects.\nthe first sheet is the main one the containing all the name of the projects.\nthe author sheets are for every project.</p>\n\n<p>in the main sheet the name of the project has hyperlink to his sheet.</p>\n\n<p>when running the code I got a pop msgbox that I write the new project name (look for \"project_name\").\nthe code does stuff.\nbut near the end there is the hyperlink code. (look for ActiveSheet.Hyperlinks.Add....)</p>\n\n<p>so my problem is:\nwhen I choose a project name like \"abcd\" everything works ok. But when I choose name like \"ab cd\". the code runs but the hyperlink doesn't work.</p>\n\n<p>I realized that having a space in the project name makes the code not work.</p>\n\n<p>thanks for the help.</p>\n\n<p>p.s.\nThe notes are in Hebrew.</p>\n\n<pre><code>Sub New_project()\n\n\n'--------------------------------------------------------------------------------------------------\u05ea\u05d7\u05d9\u05dc\u05ea \u05e8\u05d9\u05e6\u05ea \u05e7\u05d5\u05d3\n    Dim Start, Finish, TotalTime As Date\n\n    Start = Timer\n\n\n'--------------------------------------------------------------------------------------------------\u05d1\u05d9\u05d8\u05d5\u05dc \u05d7\u05d9\u05e9\u05d5\u05d1\u05d9\u05dd \u05d5\u05e2\u05d3\u05db\u05d5\u05e0\u05d9 \u05de\u05e1\u05da \u05d5\u05d4\u05ea\u05e8\u05d0\u05d5\u05ea\n    Application.Calculation = xlCalculationManual\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    Application.AskToUpdateLinks = False\n\n\n'--------------------------------------------------------------------------------------------------\u05d4\u05d7\u05d6\u05e8\u05ea \u05d7\u05d9\u05e9\u05d5\u05d1\u05d9\u05dd \u05d5\u05e2\u05d3\u05db\u05d5\u05e0\u05d9 \u05de\u05e1\u05da \u05d5\u05d4\u05ea\u05e8\u05d0\u05d5\u05ea\n    'Application.Calculation = xlCalculationAutomatic\n    'Application.ScreenUpdating = True\n    'Application.DisplayAlerts = True\n    'Application.AskToUpdateLinks = True\n\n\n'--------------------------------------------------------------------------------------------------\u05e4\u05ea\u05d9\u05d7\u05ea \u05d7\u05dc\u05d5\u05e0\u05d9\u05ea \u05d5\u05d4\u05e7\u05dc\u05d3\u05ea \u05e9\u05dd \u05d4\u05e4\u05e8\u05d5\u05d9\u05e7\u05d8\n'--------------------------------------------------------------------------------------------------\u05d0\u05dd \u05dc\u05d7\u05e6\u05d5 cancel \u05d0\u05d6 \u05d9\u05e6\u05d9\u05d0\u05d4 \u05de\u05d4\u05e7\u05d5\u05d3\n    Dim project_name As String\n    project_name = InputBox(\"\u05e0\u05d0 \u05dc\u05d4\u05e7\u05dc\u05d9\u05d3 \u05d0\u05ea \u05e9\u05dd \u05d4\u05e4\u05e8\u05d5\u05d9\u05e7\u05d8 \u05d4\u05d7\u05d3\u05e9\")\n\n    If Len(project_name) &lt; 1 Then\n\n        Application.Calculation = xlCalculationAutomatic\n        Application.ScreenUpdating = True\n        Application.DisplayAlerts = True\n        Application.AskToUpdateLinks = True\n\n        MsgBox (\"\u05d9\u05e6\u05d9\u05d0\u05d4 \u05de\u05d4\u05e7\u05d5\u05d3\")\n\n        Exit Sub\n\n    End If\n\n\n'--------------------------------------------------------------------------------------------------\u05d1\u05d3\u05d9\u05e7\u05d4 \u05d4\u05d0\u05dd \u05e9\u05dd \u05d4\u05d2\u05d9\u05dc\u05d9\u05d5\u05df \u05dc\u05e4\u05e8\u05d5\u05d9\u05e7\u05d8 \u05d4\u05d7\u05d3\u05e9 \u05db\u05d1\u05e8 \u05e7\u05d9\u05d9\u05dd\n    Dim curSheet As Worksheet\n    Dim ArraySheets() As String\n    Dim x As Variant\n    Dim sheet_existing As Integer\n\n    x = 0\n    sheet_existing = 0\n    For Each curSheet In ActiveWorkbook.Worksheets\n\n        If curSheet.Name Like project_name Then\n\n            Worksheets(project_name).Activate\n            sheet_existing = 1\n\n            Finish = Timer\n            TotalTime = Format((Finish - Start) / 86400, \"hh:mm:ss\")\n\n            Application.Calculation = xlCalculationAutomatic\n            Application.ScreenUpdating = True\n            Application.DisplayAlerts = True\n            Application.AskToUpdateLinks = True\n\n            MsgBox (\"\u05e9\u05dd \u05d4\u05e4\u05e8\u05d5\u05d9\u05e7\u05d8 \u05db\u05d1\u05e8 \u05e7\u05d9\u05d9\u05dd\" &amp; vbNewLine &amp; \"\u05d6\u05de\u05df \u05e8\u05d9\u05e6\u05ea \u05e7\u05d5\u05d3: \" &amp; TotalTime)\n\n            Exit Sub\n\n        End If\n\n    Next curSheet\n    'iComp = StrComp(str1, str2, vbBinaryCompare)\n\n'--------------------------------------------------------------------------------------------------\u05d4\u05d5\u05e1\u05e4\u05ea \u05d2\u05d9\u05dc\u05d9\u05d5\u05df \u05d7\u05d3\u05e9 \u05d1\u05e1\u05d5\u05e3 \u05d4\u05e7\u05d5\u05d1\u05e5\n    If sheet_existing = 0 Then\n\n        Sheets.Add After:=Sheets(Sheets.Count)\n        ActiveSheet.Name = project_name\n\n    End If\n\n\n'--------------------------------------------------------------------------------------------------\u05d4\u05d5\u05e1\u05e4\u05ea \u05db\u05d5\u05ea\u05e8\u05d5\u05ea\n    Range(\"A1\") = \"#\"\n    Range(\"B1\") = \"\u05ea\u05d0\u05e8\u05d9\u05da\"\n    Range(\"C1\") = \"\u05e9\u05dc\u05d1\"\n    Range(\"D1\") = \"\u05d0\u05d9\u05e9 \u05e7\u05e9\u05e8\"\n    Range(\"E1\") = \"\u05d4\u05e2\u05e8\u05d5\u05ea\"\n    Range(\"F1\") = \"\u05de\u05e1\u05de\u05db\u05d9\u05dd\"\n    Range(\"G1\") = \"\u05d9\u05de\u05d9\u05dd\"\n    Range(\"H1\") = \"\u05e6\u05d1\u05d9\u05e8\u05d4\"\n\n\n'--------------------------------------------------------------------------------------------------\u05e8\u05d5\u05d7\u05d1 \u05e2\u05de\u05d5\u05d3\u05d4\n    Columns(\"A\").ColumnWidth = 9\n    Columns(\"B\").ColumnWidth = 11\n    Columns(\"C\").ColumnWidth = 30\n    Columns(\"D\").ColumnWidth = 16\n    Columns(\"E\").ColumnWidth = 17\n    Columns(\"F\").ColumnWidth = 9\n    Columns(\"G\").ColumnWidth = 6\n    Columns(\"H\").ColumnWidth = 10\n\n\n'--------------------------------------------------------------------------------------------------\u05d4\u05d5\u05e1\u05e4\u05ea \u05de\u05e1\u05d2\u05e8\u05ea \u05dc\u05ea\u05d0\u05d9\u05dd\n    Dim rng1 As Range\n\n    Set rng1 = Range(Cells(1, 1), Cells(27, 8))\n        With rng1.Borders\n            .LineStyle = xlContinuous\n            .Color = vbBlack\n            .Weight = xlThin\n        End With\n\n\n    Range(\"A:H\").HorizontalAlignment = xlCenter\n    Range(\"A:H\").VerticalAlignment = xlCenter\n\n\n    Rows(1).Font.Bold = True\n    Columns(1).Font.Bold = True\n\n\n    Range(\"A1:H1\").Interior.Color = RGB(0, 176, 240)\n\n\n    Range(\"A2\") = 1\n    Range(\"B2\") = Date\n    'Range(\"C2\") = \"\u05e8\u05e9\u05d5\u05dd \u05db\u05d0\u05df \u05d0\u05ea \u05d4\u05e9\u05dc\u05d1 \u05d4\u05e8\u05d0\u05e9\u05d5\u05df\"\n    Range(\"G2\") = 0\n    Range(\"H2\") = 0\n\n\n    Range(\"N1:Q1\").Merge\n    Range(\"N2:Q12\").Merge\n\n    Range(\"N1:Q1\").Interior.Color = RGB(0, 176, 240)\n\n    Range(\"N1:Q1\") = \"\u05d4\u05e2\u05e8\u05d5\u05ea\"\n\n\n '--------------------------------------------------------------------------------------------------\u05d4\u05d5\u05e1\u05e4\u05ea \u05de\u05e1\u05d2\u05e8\u05ea \u05dc\u05ea\u05d0\u05d9\u05dd\n    Dim rng2 As Range\n\n    Set rng2 = Range(Cells(1, 14), Cells(12, 17))\n        With rng2.Borders\n            .LineStyle = xlContinuous\n            .Color = vbBlack\n            .Weight = xlThin\n        End With\n\n\n    Range(\"N:Q\").HorizontalAlignment = xlCenter\n    Range(\"N:Q\").VerticalAlignment = xlCenter\n\n\n'--------------------------------------------------------------------------------------------------\u05e1\u05e4\u05d9\u05e8\u05ea \u05d2\u05d9\u05dc\u05d9\u05d5\u05e0\u05d5\u05ea \u05d1\u05e7\u05d5\u05d1\u05e5\n    Dim SheetCountA As Integer\n    SheetCountA = Application.Sheets.Count\n\n'--------------------------------------------------------------------------------------------------\u05d4\u05e2\u05ea\u05e7\u05ea \u05db\u05e4\u05ea\u05d5\u05e8 \u05d7\u05d6\u05e8\u05d4 \u05dc\u05d2\u05d9\u05dc\u05d9\u05d5\u05df \u05d4\u05d7\u05d3\u05e9\n    Sheets(SheetCountA - 1).Select\n    ActiveSheet.Shapes.Range(Array(\"Rectangle 1\")).Select\n    Selection.Copy\n    Sheets(SheetCountA).Select\n    ActiveSheet.Paste Destination:=Worksheets(SheetCountA).Range(\"K1\")\n\n\n    Sheets(SheetCountA - 1).Select\n    Range(\"B1\").Copy\n    Sheets(SheetCountA).Select\n    Range(\"B1\").PasteSpecial Paste:=xlPasteFormats\n\n    Application.CutCopyMode = False\n\n    Range(\"A1\").Select\n\n    Sheets(SheetCountA - 1).Select\n    Range(\"A1\").Select\n\n    Sheets(\"\u05e1\u05d9\u05db\u05d5\u05dd\").Select\n\n\n    Dim LastRowA As Integer\n    LastRowA = Application.CountA(Range(\"B:B\"))\n\n\n'--------------------------------------------------------------------------------------------------\u05d4\u05d5\u05e1\u05e4\u05ea \u05de\u05e1\u05e4\u05d5\u05e8 \u05dc\u05e4\u05e8\u05d5\u05d9\u05e7\u05d8 \u05d4\u05d7\u05d3\u05e9\n    Cells(LastRowA + 1, 1) = Cells(LastRowA, 1) + 1\n\n\n'--------------------------------------------------------------------------------------------------\u05d4\u05d5\u05e1\u05e4\u05ea \u05d4\u05d9\u05e4\u05e8-\u05dc\u05d9\u05e0\u05e7\n    ActiveSheet.Hyperlinks.Add Anchor:=Cells(LastRowA + 1, 2), Address:=\"\", SubAddress:= _\n        project_name &amp; \"!A1\", TextToDisplay:=project_name\n\n    Cells(LastRowA + 1, 2).HorizontalAlignment = xlCenter\n    Cells(LastRowA + 1, 2).VerticalAlignment = xlCenter\n\n    Range(\"A1\").Select\n\n\n '--------------------------------------------------------------------------------------------------\u05d6\u05de\u05df \u05e1\u05d9\u05d5\u05dd \u05e8\u05d9\u05e6\u05ea \u05e7\u05d5\u05d3 \u05d5\u05d7\u05d9\u05e9\u05d5\u05d1\n    Finish = Timer\n    TotalTime = Format((Finish - Start) / 86400, \"hh:mm:ss\")\n\n    MsgBox (\"\u05d4\u05d3\u05d5''\u05d7 \u05de\u05d5\u05db\u05df\" &amp; vbNewLine &amp; \"\u05d6\u05de\u05df \u05e8\u05d9\u05e6\u05ea \u05e7\u05d5\u05d3: \" &amp; TotalTime)\n\n\n'--------------------------------------------------------------------------------------------------\u05e9\u05d0\u05dc\u05d4 \u05d4\u05d0\u05dd \u05dc\u05e2\u05d1\u05d5\u05e8 \u05dc\u05e7\u05d5\u05d3 \u05e9\u05de\u05e8\u05e2\u05e0\u05df \u05d0\u05ea \u05d4\u05e7\u05d5\u05d1\u05e5\n    Dim answer2 As Integer\n\n    answer2 = MsgBox(\"?\u05d4\u05d0\u05dd \u05dc\u05e8\u05e2\u05e0\u05df \u05d0\u05ea \u05d4\u05e7\u05d5\u05d1\u05e5\", vbYesNo + vbQuestion, \"\u05de\u05e2\u05d1\u05e8 \u05dc\u05e7\u05d5\u05d3 \u05d4\u05d1\u05d0\")\n\n    If answer2 = vbYes Then\n\n        Application.Calculation = xlCalculationAutomatic\n        Application.ScreenUpdating = True\n        Application.DisplayAlerts = True\n        Application.AskToUpdateLinks = True\n\n        Call Refresh_file\n\n    End If\n\n'--------------------------------------------------------------------------------------------------\u05e9\u05de\u05d9\u05e8\u05ea \u05d4\u05e7\u05d5\u05d1\u05e5\n    ThisWorkbook.Save\n\n\n'--------------------------------------------------------------------------------------------------\u05d4\u05d7\u05d6\u05e8\u05ea \u05d7\u05d9\u05e9\u05d5\u05d1\u05d9\u05dd \u05d5\u05e2\u05d3\u05db\u05d5\u05e0\u05d9 \u05de\u05e1\u05da \u05d5\u05d4\u05ea\u05e8\u05d0\u05d5\u05ea\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\n    Application.AskToUpdateLinks = True\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "python-3.x", "vba", "pywin32", "win32com"], "comments": [{"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1576073542, "post_id": 59282284, "comment_id": 104780472, "body": "This what you are looking for <a href=\"https://www.xlwings.org/\" rel=\"nofollow noreferrer\">xlwings.org</a> ?"}, {"owner": {"reputation": 139, "user_id": 9035439, "user_type": "registered", "profile_image": "https://graph.facebook.com/2025223510824531/picture?type=large", "display_name": "Tom&#225;\u0161 Kruli\u0161", "link": "https://stackoverflow.com/users/9035439/tom%c3%a1%c5%a1-kruli%c5%a1"}, "reply_to_user": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1576078032, "post_id": 59282284, "comment_id": 104783095, "body": "Maybe, but I think not exactly. My ultimate goal is to be able to create Excel PivotTable (dont confuse with pandas pivot_table function!) and PivotChart from python script."}, {"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1576078313, "post_id": 59282284, "comment_id": 104783265, "body": "I don&#39;t know about PivotTables, but xlwings gives you a pretty strong Excel-API. If your goal is to make a chart, why do you need it to be in Excel?"}, {"owner": {"reputation": 139, "user_id": 9035439, "user_type": "registered", "profile_image": "https://graph.facebook.com/2025223510824531/picture?type=large", "display_name": "Tom&#225;\u0161 Kruli\u0161", "link": "https://stackoverflow.com/users/9035439/tom%c3%a1%c5%a1-kruli%c5%a1"}, "reply_to_user": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1576084737, "post_id": 59282284, "comment_id": 104786719, "body": "The goal is more like to have both Chart and Table interactive and sychronized together; and also being able to add them to .pdf as attachment. I dont know of any other way to achieve that specific with any other application than Excel."}], "owner": {"reputation": 139, "user_id": 9035439, "user_type": "registered", "profile_image": "https://graph.facebook.com/2025223510824531/picture?type=large", "display_name": "Tom&#225;\u0161 Kruli\u0161", "link": "https://stackoverflow.com/users/9035439/tom%c3%a1%c5%a1-kruli%c5%a1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 312, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576135702, "creation_date": 1576055683, "last_edit_date": 1576135702, "question_id": 59282284, "link": "https://stackoverflow.com/questions/59282284/using-win32com-and-python-3-7-2-64bit-to-connect-to-ms-excel-2016-32bit", "title": "Using win32com and python 3.7.2 64bit to connect to MS Excel 2016 32bit", "body": "<p>I would like to know, if it is possible to use win32com library (win32com.client and others) to connect to MS Excell with Python in following configuration:</p>\n\n<p>MS Excel 2016 32bit</p>\n\n<p>Python 3.7.4 64bit</p>\n\n<p>Win10 64bit</p>\n\n<p>win32com (I dont know how its architecture is defined)</p>\n\n<p>I have already read this question and its answer: <a href=\"https://stackoverflow.com/questions/3937060/python-win32com-application-installed-with-both-32bit-and-64bit-versions\">Python win32com - application installed with both 32bit and 64bit versions</a> </p>\n\n<p>and also have scoured google and found, that it is connected to .dll libraries being unable to cope with difference in architecture, but it is still not entirely clear to me. I have also installed 64bit ODBC drivers for MS Access connection (to connect to 32bit Access with 64bit Python, and this connection works), which should also include libraries to connect to MS Excell, but I still cant use win32com.client to create COM objects in Excel.</p>\n\n<p>Note: I also have access to following configuration:</p>\n\n<p>MS Excell 2010 32bit</p>\n\n<p>Python 3.7.2 32bit</p>\n\n<p>Win7 32bit</p>\n\n<p>win32com</p>\n\n<p>In which the connection works (more or less).</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1576053565, "post_id": 59281682, "comment_id": 104769575, "body": "You have never set <code>wks</code> before your line. That would be your unqualified and missing object. Did you actually needed <code>Sheet</code>?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user12326522"}, "edited": false, "score": 0, "creation_date": 1576054045, "post_id": 59281729, "comment_id": 104769804, "body": "Ah yes sorry for not including it, i have tried <code>Dim wks As Worksheet</code> and it gives me <code>Object Variable or With block Variable not set</code> , though when i tried adding another line of yours <code>Set wks = Worksheets(&quot;Sheet1&quot;)</code> It gives me <code>Subscript out of range</code> Is it perhaps because my program creates a new sheet everytime i run it and it will never be an exact sheet name?"}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "edited": false, "score": 0, "creation_date": 1576054569, "post_id": 59281729, "comment_id": 104770044, "body": "So try <code>Worksheets(1)</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user12326522"}, "edited": false, "score": 0, "creation_date": 1576054731, "post_id": 59281729, "comment_id": 104770123, "body": "Still doesn&#39;t work , it gives an error <code>subscript out of range</code>"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1576054739, "post_id": 59281729, "comment_id": 104770131, "body": "@lalalisa, the subscipt out of range error is returned because you don&#39;t have a worksheet called &quot;Sheet1&quot;."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1576055491, "post_id": 59281729, "comment_id": 104770572, "body": "@lalalisa, then you don&#39;t get that error on <code>Set wks = Worksheets(&quot;Sheet1&quot;)</code> but on <code>Set table = wks.ListObjects(&quot;TableName&quot;)</code> most likely, meaning you don&#39;t have a <code>ListObject</code> called &quot;TableName&quot; on that sheet. As it is, it seems as though you needed the <code>Sheet</code> object but since you just created it, it doesn&#39;t hold a <code>ListObject</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user12326522"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1576055704, "post_id": 59281729, "comment_id": 104770691, "body": "@JvdV Oh i see! i sort of get you but also can&#39;t get you... do you know any way to fix it?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1576055800, "post_id": 59281729, "comment_id": 104770754, "body": "I have no clue because I don&#39;t know why you even want to get a listobject from a sheet that doesn&#39;t have a listobject. And even then, I don&#39;t know what you want to do with it. So try to add a <code>ListObject</code> when you create your sheet I would say. Sorry for entering this chat @Micha\u0142Turczyn."}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1576053563, "creation_date": 1576053563, "answer_id": 59281729, "question_id": 59281682, "link": "https://stackoverflow.com/questions/59281682/vba-object-required-for-listobjects/59281729#59281729", "title": "VBA object required for listobjects", "body": "<p>You are using <code>wks</code> variable, which is not assigned anywhere.</p>\n\n<p>In order to use variable best practice is to:</p>\n\n<ol>\n<li><p>declare it using <code>Dim</code> keyword</p></li>\n<li><p>Assign it with <code>=</code> operator (quite obvious)</p></li>\n</ol>\n\n<p>So, for example, for <code>Worksheet</code> object it would be:</p>\n\n<pre><code>Dim wks As Worksheet\n' reference types ned Set keyword when assigning\nSet wks = Worksheets(\"Sheet1\") ' just example\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user12326522"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576053595, "creation_date": 1576053391, "last_edit_date": 1576053595, "question_id": 59281682, "link": "https://stackoverflow.com/questions/59281682/vba-object-required-for-listobjects", "title": "VBA object required for listobjects", "body": "<p>I have this code here that keep giving an error code that says  <code>Object required</code>  at the listobject line</p>\n\n<pre><code>Dim table As ListObject\nSet table = wks.ListObjects(\"TableName\")\n\nDim newRow As ListRow\nSet newRow = table.ListRows.Add\n</code></pre>\n\n<p>Below is the full code, i have no idea what object is missing, can anyone advice me on this? thanks so much!</p>\n\n<pre><code>Sub GenerateData()\n\nDim sheet As Worksheet\nSet sheet = CreateOutputSheet(ActiveWorkbook)\n\nDim basePath As String\nbasePath = Environ$(\"USERPROFILE\") &amp; \"\\Desktop\\Tryout\\\"\n\nDim baseFolder As Scripting.Folder\nWith New Scripting.FileSystemObject\n    Set baseFolder = .GetFolder(basePath)\nEnd With\n\nDim table As ListObject\nSet table = wks.ListObjects(\"TableName\")\n\nDim newRow As ListRow\nSet newRow = table.ListRows.Add\n\n Dim source As Range\n    Set source = wksData.Range(\"A:A\")\n\n    PopulateIfFound source, \"  testtest         : \", newRow, 1\n    PopulateIfFound source, \"  testflyy         : \", newRow, 2\n    PopulateIfFound source, \"  testflyy         : \", newRow, 3\n    PopulateIfFound source, \"  Started at: \", newRow, 4\n    If Not PopulateIfFound(source, \"SmartABC \", newRow, 9) Then\n        PopulateIfFound source, \"smart_mfh revision\", newRow, 9\n    End If\n    If Not PopulateIfFound(source, \"ERROR: ABC \", newRow, 10, True) Then\n        PopulateIfFound source, \"ERROR: DEF \", newRow, 10\n    End If\n\nEnd Sub\n\nPrivate Sub AddColumnHeaders(ByVal sheet As Worksheet)\n    sheet.Range(\"A1:K1\") = Array( _\n         \"Test\", \"Temp\", \"Type\", \"StartDate\", _\n         \"FileName\", \"No\", \"EndDate\", \"Month\", _\n         \"Smart\", \"Errors\", \"ErrorCellAddress\")\nEnd Sub\n\nPrivate Function CreateOutputSheet(ByVal book As Workbook) As Worksheet\n    Dim sheet As Worksheet\n    Set sheet = book.Worksheets.Add(After:=book.Worksheets(book.Worksheets.Count))\n    AddColumnHeaders sheet\n    Set CreateOutputSheet = sheet\nEnd Function\n\nPrivate Function PopulateIfFound(ByVal source As Range, ByVal value As String, ByVal row As ListRow, ByVal writeToColumn As Long, Optional ByVal writeAddressToNextColumn As Boolean = False) As Boolean\n    Dim result As Range\n    Set result = source.Find(value, LookIn:=xlValues)\n    If Not result Is Nothing Then\n        Dim cell As Range\n        Set cell = row.Range.Cells(ColumnIndex:=writeToColumn)\n        cell.value = result.value\n        If writeAddressToNextColumn Then\n            cell.Offset(ColumnOffset:=1).value = result.Address\n        End If\n        PopulateIfFound = True\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 689, "user_id": 9423196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cJuOc.jpg?s=128&g=1", "display_name": "Daghan", "link": "https://stackoverflow.com/users/9423196/daghan"}, "edited": false, "score": 0, "creation_date": 1576049200, "post_id": 59280390, "comment_id": 104767679, "body": "You could take a copy of the output data and paste to a hidden sheet. Then simply make a column next to your front-page data with the formula: =V10=HiddenSheet!A1 to check for matches"}, {"owner": {"reputation": 675, "user_id": 11168443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0791f927a9d1d318847e6fd854f7d61?s=128&d=identicon&r=PG&f=1", "display_name": "Lzypenguin", "link": "https://stackoverflow.com/users/11168443/lzypenguin"}, "reply_to_user": {"reputation": 689, "user_id": 9423196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cJuOc.jpg?s=128&g=1", "display_name": "Daghan", "link": "https://stackoverflow.com/users/9423196/daghan"}, "edited": false, "score": 0, "creation_date": 1576049665, "post_id": 59280390, "comment_id": 104767856, "body": "I could do that BUT i am specifically needing some VBA code to PROMPT the user with a message box if the values in the column have changed and they click the macro to send out the update.  I have read about loading both ranges into memory array and loop the arrays and compare and this would work perfectly but I do not know how to do it."}, {"owner": {"reputation": 689, "user_id": 9423196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cJuOc.jpg?s=128&g=1", "display_name": "Daghan", "link": "https://stackoverflow.com/users/9423196/daghan"}, "edited": false, "score": 0, "creation_date": 1576050030, "post_id": 59280390, "comment_id": 104767996, "body": "It&#39;s not that hard, dont worry. See <a href=\"https://excelmacromastery.com/excel-vba-array/\" rel=\"nofollow noreferrer\">excelmacromastery.com/excel-vba-array</a>           I would still save the output data to a hidden sheet as arrays are only saved in memory while the code is running, arrays are the superior method (in terms of speed) to do calculations. What you need to do is create an 2 column array with frontpage data in column 1 and data from hidden sheet in column 2. Then simply loop over the array (see Lbound to Ubound) to compare each value and return a msgbox whenever they are not matching."}, {"owner": {"reputation": 689, "user_id": 9423196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cJuOc.jpg?s=128&g=1", "display_name": "Daghan", "link": "https://stackoverflow.com/users/9423196/daghan"}, "edited": false, "score": 0, "creation_date": 1576050151, "post_id": 59280390, "comment_id": 104768048, "body": "You could also just do as in my first comment and loop through the true/false statements and return a msgbox if there are any false matches"}], "answers": [{"tags": [], "owner": {"reputation": 675, "user_id": 11168443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0791f927a9d1d318847e6fd854f7d61?s=128&d=identicon&r=PG&f=1", "display_name": "Lzypenguin", "link": "https://stackoverflow.com/users/11168443/lzypenguin"}, "is_accepted": true, "score": 0, "last_activity_date": 1576050468, "creation_date": 1576050468, "answer_id": 59280999, "question_id": 59280390, "link": "https://stackoverflow.com/questions/59280390/is-there-an-excel-vba-line-of-code-i-can-add-to-check-if-any-values-in-a-column/59280999#59280999", "title": "Is there an excel VBA line of code I can add to check if any values in a column have changed since the last time the macro was ran?", "body": "<p>I was able to find this, along with the other posters help and come up with this solution:</p>\n\n<pre><code>Dim x, y, i As Long, ii As Long, msg As String\n\nx = Range(\"V8:V120\")\ny = Range(\"W8:W120\")\nmsg = \"The 2 ranges are identical\"\nFor i = 1 To UBound(x, 1)\nFor ii = 1 To UBound(x, 2)\nIf x(i, ii) &lt;&gt; y(i, ii) Then\nmsg = \"The email body has changed and not been saved.\"\nEnd If\nNext\nNext\n\nIf msg = \"The email body has changed and not been saved.\" Then\nMsgBox (\"The email body has changed and not been saved.\")\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 675, "user_id": 11168443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0791f927a9d1d318847e6fd854f7d61?s=128&d=identicon&r=PG&f=1", "display_name": "Lzypenguin", "link": "https://stackoverflow.com/users/11168443/lzypenguin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 59280999, "answer_count": 1, "score": 0, "last_activity_date": 1576052647, "creation_date": 1576047806, "last_edit_date": 1576052647, "question_id": 59280390, "link": "https://stackoverflow.com/questions/59280390/is-there-an-excel-vba-line-of-code-i-can-add-to-check-if-any-values-in-a-column", "title": "Is there an excel VBA line of code I can add to check if any values in a column have changed since the last time the macro was ran?", "body": "<p>I have a main work area. This main work area is setup with so that a bunch of different sections can be shown or not shown in the main area based on checkboxes. We run a Macro (via a button) every time we are ready to send the clients updates. I want to add in our main macro a prompt/warning to pop up ONLY IF someone has changed the checkboxes. I have a column the boxes are tied to with \"TRUE\"/\"FALSE\" values. </p>\n\n<p>Can i set the range for my column say  $V:$10:$V:$90 so that if any of those values are not the same as they were the last time this macro was ran, it will prompt the user?</p>\n\n<p>Any help is appreciated.</p>\n\n<p>Edit: Alternatively, there are several sheets in this workbook. I could essentially copy/paste the column range i want to a new area, and then compare the two columns everytime the macro is ran. If they are not the same, then pop up a message box. But I am hoping there is a way to just analyze the data. </p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1576053490, "post_id": 59280119, "comment_id": 104769537, "body": "This error is raised when no match is found using <code>WorksheetFunction.Match</code>. Can you confirm that <code>valuerFirmCB.Value</code> returns the correct value just before that line?"}, {"owner": {"reputation": 17, "user_id": 2546385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88b815447a78e870cda3280e11176c1d?s=128&d=identicon&r=PG", "display_name": "user2546385", "link": "https://stackoverflow.com/users/2546385/user2546385"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1576054134, "post_id": 59280119, "comment_id": 104769846, "body": "yup it does return the correct value"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1576054242, "post_id": 59280119, "comment_id": 104769891, "body": "Unfortunately I cannot replicate the error with some quick testing. The value you tried to match is somehow not found."}, {"owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "edited": false, "score": 0, "creation_date": 1576057459, "post_id": 59280119, "comment_id": 104771700, "body": "What types of values do you have in rows and columns?"}, {"owner": {"reputation": 17, "user_id": 2546385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88b815447a78e870cda3280e11176c1d?s=128&d=identicon&r=PG", "display_name": "user2546385", "link": "https://stackoverflow.com/users/2546385/user2546385"}, "edited": false, "score": 0, "creation_date": 1576057900, "post_id": 59280119, "comment_id": 104771941, "body": "column A:J consist of name of the firm in row 1, names of the valuers in row 2 to 20"}, {"owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "edited": false, "score": 0, "creation_date": 1576058406, "post_id": 59280119, "comment_id": 104772191, "body": "Can you then tell after what action an error is thrown? I was able to replicate this error when I used numbers in first row. The argument passed to Match function <code>valuerFirmCB.Value</code> was of type String (as this is the return type of ComboBox) and value in the row was of type Integer. That generated an error described, which is easily handled by implicit conversion. Maybe, a screenshot of sample data will also help to understand the issue."}, {"owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "edited": false, "score": 0, "creation_date": 1576059160, "post_id": 59280119, "comment_id": 104772632, "body": "Now, with a screenshot, all is quite clear. Let me post an answer."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "edited": false, "score": 0, "creation_date": 1576061303, "post_id": 59280119, "comment_id": 104773843, "body": "The very first comment, I asked if you could confirm if <code>valuerFirmCB.Value</code> returns the correct value, which you said it did. I guess it didn&#39;t =). @VitaliyPrushak got a good explaination below."}], "answers": [{"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1576061052, "post_id": 59283518, "comment_id": 104773684, "body": "Have you tried to replicate this? I did, and <code>Me.valuerFirmCB.Clear</code> did not raise an change event as the combobox is clear already upon opening the userform. It would be a logical explaination though if OP could confirm that he set a rowsource for this combobox in properties."}, {"owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1576064001, "post_id": 59283518, "comment_id": 104775319, "body": "I&#39;ve replicated it with additional buttons to <code>Form.Show 0</code> on the worksheet and  <code>Form.Hide</code> on the form. Switching between form and sheet does nothing, but if you select an item in ComboBox, Hide the form and Show again - the change event on <code>Me.valuerFirmCB.Clear</code> is triggered. The <code>Unload Me</code> and <code>Form.Show</code> doesn&#39;t raise this error."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1576064139, "post_id": 59283518, "comment_id": 104775390, "body": "Upvoted. Since really it would be the only logical explaination possible =)"}, {"owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1576064765, "post_id": 59283518, "comment_id": 104775685, "body": "The most simpler way to get this error was just to delete a selected value from ComboBox :D"}], "tags": [], "owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "is_accepted": true, "score": 2, "last_activity_date": 1576064573, "last_edit_date": 1576064573, "creation_date": 1576059573, "answer_id": 59283518, "question_id": 59280119, "link": "https://stackoverflow.com/questions/59280119/run-time-error-1004-unable-to-get-match-property-of-the-worksheetfunction-clas/59283518#59283518", "title": "&quot;Run-time error 1004, Unable to get Match Property of the WorksheetFunction class&quot;", "body": "<p>Each time you activate your UserForm - you trigger an UserForm_Activate event:</p>\n\n<pre><code>Private Sub UserForm_Activate()\n</code></pre>\n\n<p>Which clears you ComboBox:</p>\n\n<pre><code>Me.valuerFirmCB.Clear\n</code></pre>\n\n<p>This action in its turn triggers a ComboBox_Change event if the form was hidden and a ComboBox has some value selected before activation:</p>\n\n<pre><code>Private Sub valuerFirmCB_Change()\n</code></pre>\n\n<p>And sets the <code>valuerFirmCB.Value</code> to <code>\"\"</code> (Nothing, as you see on your screenshot).</p>\n\n<p>As your <code>Me.valuerFirmCB.Clear</code> is a ComboBox_Change event, so event is fired and trying to find the <code>\"\"</code> value, which generates an error in match function. Also, this error will be thrown if you simply delete the selected value from <code>valuerFirmCB</code> manually.</p>\n\n<p>The way you can deal this issue is to add a simple check to <code>Private Sub valuerFirmCB_Change()</code> like this:</p>\n\n<pre><code>If Not valuerFirmCB.Value = \"\" Then\n    n = Application.WorksheetFunction.Match(valuerFirmCB.Value, sh.Range(\"1:1\"), 0)\n\n    Me.valuerNameCB.Clear\n    For i = 2 To Application.WorksheetFunction.CountA(sh.Cells(1, n).EntireColumn)\n        Me.valuerNameCB.AddItem sh.Cells(i, n).Value\n\n    Next i\nEnd If\n</code></pre>\n\n<p>So the search will be performed only when <code>valuerNameCB</code> has some value.</p>\n\n<p><strong>Added per comment</strong></p>\n\n<p>I've replicated this situation with additional buttons with code <code>Form.Show 0</code> on the worksheet and <code>Form.Hide</code> on the form. Switching between form and sheet does nothing, but if you select an item in ComboBox, Hide the form and Show again - the change event on <code>Me.valuerFirmCB.Clear</code> will be triggered. However, this won't happen if I use <code>Unload Me</code> instead of <code>Form.Hide</code>.</p>\n"}], "owner": {"reputation": 17, "user_id": 2546385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88b815447a78e870cda3280e11176c1d?s=128&d=identicon&r=PG", "display_name": "user2546385", "link": "https://stackoverflow.com/users/2546385/user2546385"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 59283518, "answer_count": 1, "score": 0, "last_activity_date": 1579193020, "creation_date": 1576046521, "last_edit_date": 1579193020, "question_id": 59280119, "link": "https://stackoverflow.com/questions/59280119/run-time-error-1004-unable-to-get-match-property-of-the-worksheetfunction-clas", "title": "&quot;Run-time error 1004, Unable to get Match Property of the WorksheetFunction class&quot;", "body": "<p><a href=\"https://i.stack.imgur.com/yp5Kv.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yp5Kv.jpg\" alt=\"enter image description here\"></a>I am trying to get both of the <code>comboboxes(valuerFirmCB, valuerNameCB)</code> to be dynamic i.e the <code>valuerNameCB</code> will only display the names accordingly to the firm.</p>\n\n<p>It works but however I got an error after adding the entry to the spreadsheet <code>\"Run-time error 1004, Unable to get Match Property of the WorksheetFunction class\"</code>.</p>\n\n<pre><code>Private Sub UserForm_Activate()\n\nDim sh As Worksheet\nSet sh = ThisWorkbook.Sheets(\"Valuer_Details\")\n\nDim i As Integer\n\nMe.valuerFirmCB.Clear\nFor i = 1 To Application.WorksheetFunction.CountA(sh.Range(\"1:1\"))\nMe.valuerFirmCB.AddItem sh.Cells(1, i).Value\n\nNext i\nEnd Sub\n\nPrivate Sub valuerFirmCB_Change()\nDim sh As Worksheet\nSet sh = ThisWorkbook.Sheets(\"Valuer_Details\")\nDim i As Integer\nDim n As Integer\n\nn = Application.WorksheetFunction.Match(valuerFirmCB.Value, sh.Range(\"1:1\"), 0)\n\nMe.valuerNameCB.Clear\nFor i = 2 To Application.WorksheetFunction.CountA(sh.Cells(1, n).EntireColumn)\n    Me.valuerNameCB.AddItem sh.Cells(i, n).Value\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "winapi"], "comments": [{"owner": {"reputation": 158, "user_id": 12506685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bbdad43fa100913502ce67d1b6b0fd?s=128&d=identicon&r=PG&f=1", "display_name": "the VBE - it&#39;s right for me", "link": "https://stackoverflow.com/users/12506685/the-vbe-its-right-for-me"}, "edited": false, "score": 0, "creation_date": 1576046141, "post_id": 59279927, "comment_id": 104766592, "body": "What is the purpose of selecting the cell B2 before pasting? Is that where you want the picture to be anchored? You generally want to avoid using <code>.Activate</code> and <code>.Select</code> unless they are for actual user experience functionality since they are inefficient and can lead to problems. I would try just pasting the picture directly and setting the <code>.Top</code> and <code>.Left</code>  attributes to that of the worksheet cell to get it aligned."}, {"owner": {"reputation": 1, "user_id": 12515773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8c6c00e079db96bec587e322ba42092?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey K", "link": "https://stackoverflow.com/users/12515773/andrey-k"}, "reply_to_user": {"reputation": 158, "user_id": 12506685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bbdad43fa100913502ce67d1b6b0fd?s=128&d=identicon&r=PG&f=1", "display_name": "the VBE - it&#39;s right for me", "link": "https://stackoverflow.com/users/12506685/the-vbe-its-right-for-me"}, "edited": false, "score": 0, "creation_date": 1576046941, "post_id": 59279927, "comment_id": 104766905, "body": "Selecting the cell B2 as place for pasting. Will try/do to avoid using .Activate and .Select."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1576055701, "post_id": 59279927, "comment_id": 104770688, "body": "From <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-keybd_event\" rel=\"nofollow noreferrer\">keybd_event</a>: <i>&quot;This function has been superseded. <b>Use <a href=\"https://docs.microsoft.com/windows/desktop/api/winuser/nf-winuser-sendinput\" rel=\"nofollow noreferrer\">SendInput</a> instead.</b>&quot;</i> To reliably know, when clipboard data is available, you&#39;ll have to <a href=\"https://docs.microsoft.com/en-us/windows/win32/dataxchg/using-the-clipboard#monitoring-clipboard-contents\" rel=\"nofollow noreferrer\">Monitoring Clipboard Contents</a>. A <code>Sleep 50</code> won&#39;t do."}, {"owner": {"reputation": 4915, "user_id": 11128312, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ufn85.jpg?s=128&g=1", "display_name": "Strive Sun", "link": "https://stackoverflow.com/users/11128312/strive-sun"}, "edited": false, "score": 0, "creation_date": 1576143739, "post_id": 59279927, "comment_id": 104806109, "body": "Try to narrow down the problem. You can comment  ` wsShots.Range(&quot;B2&quot;).Select`, then paste it directly to see if it is successful."}, {"owner": {"reputation": 1, "user_id": 12515773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8c6c00e079db96bec587e322ba42092?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey K", "link": "https://stackoverflow.com/users/12515773/andrey-k"}, "edited": false, "score": 0, "creation_date": 1576156969, "post_id": 59279927, "comment_id": 104813371, "body": "1) Moved out <code>.Activate</code> and <code>(&quot;B2&quot;).Select</code> as far as possible from Copy/Paste. My understanding was to exclude all actions between Copy/Paste. It helped to avoid issue, but not at all. 2) Focused on <code>Sleep 50</code> in <code>PrintScreen</code>, <a href=\"https://docs.microsoft.com/en-us/windows/win32/dataxchg/using-the-clipboard#monitoring-clipboard-contents\" rel=\"nofollow noreferrer\">Monitoring Clipboard Contents</a> helped. Re-implemented <code>Sleep 50</code> with <code>GetClipboardSequenceNumber</code>. Minimal testing scenario works for now (without <code>keybd_event</code> re-placement)!! Will do and run complete testing scenario soon and put results here."}, {"owner": {"reputation": 1, "user_id": 12515773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8c6c00e079db96bec587e322ba42092?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey K", "link": "https://stackoverflow.com/users/12515773/andrey-k"}, "edited": false, "score": 0, "creation_date": 1576157613, "post_id": 59279927, "comment_id": 104813738, "body": "For been clear: <code>(&quot;B2&quot;).Select</code> was a part of copy-pasting sequence. So far as overall macro goal is &quot;screenshots making...&quot; and saving it into file, it (macro) did it in two steps. Step1: do PrtScr and paste screenshot into worksheet B2; Step2: copy shape from B2 into Chart object and then export it into file. Since yesterday I re-implemented two copy/paste&#39;s into just one of it: do PrtScr and paste into Chart. <code>(&quot;B2&quot;).Select</code> is no longer required."}, {"owner": {"reputation": 4915, "user_id": 11128312, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ufn85.jpg?s=128&g=1", "display_name": "Strive Sun", "link": "https://stackoverflow.com/users/11128312/strive-sun"}, "edited": false, "score": 0, "creation_date": 1576227285, "post_id": 59279927, "comment_id": 104838593, "body": "So, have your problem solved?"}, {"owner": {"reputation": 1, "user_id": 12515773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8c6c00e079db96bec587e322ba42092?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey K", "link": "https://stackoverflow.com/users/12515773/andrey-k"}, "reply_to_user": {"reputation": 4915, "user_id": 11128312, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ufn85.jpg?s=128&g=1", "display_name": "Strive Sun", "link": "https://stackoverflow.com/users/11128312/strive-sun"}, "edited": false, "score": 0, "creation_date": 1582373189, "post_id": 59279927, "comment_id": 106760225, "body": "Hi, thanks to all for comments and help. Sorry for delay with answer.  @StriveSun-MSFT , yes, the problem has been solved. The key for solving is usage of <code>GetClipboardSequenceNumber</code>, described in <a href=\"https://docs.microsoft.com/en-us/windows/win32/dataxchg/using-the-clipboard#monitoring-clipboard-contents\" rel=\"nofollow noreferrer\">Monitoring Clipboard Contents</a>."}, {"owner": {"reputation": 1, "user_id": 12515773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8c6c00e079db96bec587e322ba42092?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey K", "link": "https://stackoverflow.com/users/12515773/andrey-k"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1582373237, "post_id": 59279927, "comment_id": 106760236, "body": "@IInspectable , please put your comment as answer and I will mark it as solution for my case. Thank you very much!"}], "owner": {"reputation": 1, "user_id": 12515773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8c6c00e079db96bec587e322ba42092?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey K", "link": "https://stackoverflow.com/users/12515773/andrey-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576045634, "creation_date": 1576045483, "last_edit_date": 1576045634, "question_id": 59279927, "link": "https://stackoverflow.com/questions/59279927/irregular-1004-error-on-worksheet-pictures-range-paste", "title": "Irregular #1004 error on Worksheet.[Pictures./Range.]Paste", "body": "<p>Macro goal: screenshots making of windows desktop application.</p>\n\n<p>Macro fails <em>irregularly</em> in last shown line of sub:</p>\n\n<pre><code>Sub MakeScreenShot()\n    ...\n    ClearClipboard\n    AltPrintScreen\n    wsShots.Activate\n    wsShots.Range(\"B2\").Select\n    wsShots.Pictures.Paste\n    ...\nEnd sub\n</code></pre>\n\n<p>Found that:</p>\n\n<ul>\n<li>1004 error happens due to empty clipboard</li>\n<li>in most cases right after error is occurred (when VBE is highlighting the error line) on switching to Excel UI can see that clipboard is <em>not</em> empty</li>\n<li>on pasting clipboard then can see screenshot of VBE window with highlighted yellow line</li>\n<li>error happening is highly correlated with PC CPU usage over 40-50% (re-searched by Task Manager)</li>\n</ul>\n\n<p>Assumption:\ndue to clipboard content (VBE screenshot) on error happening, it looks like in some cases WinAPI calls (keybd_event) stuck (by what reason?) in some queue and OS sends it back to VBE.\nTried to add <code>Sleep</code> and/or <code>DoEvents</code> right after <code>AltPrintScreen</code>, didnt find the difference.</p>\n\n<p>Definition for AltPrintScreen:</p>\n\n<pre><code>Public Declare PtrSafe Sub KeybdEvent Lib \"user32\" Alias \"keybd_event\" (ByVal bVk As Byte, ByVal bScan As Byte, ByVal dwFlags As Long, ByVal dwExtraInfo As Long)\nEnum KeybdEventEnum\n    KEYEVENTF_KEYUP = &amp;H2\n    VK_SNAPSHOT = &amp;H2C\n    VK_MENU = &amp;H12\nEnd Enum\n\nSub AltPrintScreen()\n    KeybdEvent VK_MENU, 0, 0, 0\n    KeybdEvent VK_SNAPSHOT, 0, 0, 0\n    KeybdEvent VK_SNAPSHOT, 0, KEYEVENTF_KEYUP, 0\n    KeybdEvent VK_MENU, 0, KEYEVENTF_KEYUP, 0\n    Sleep 50\nEnd Sub\n</code></pre>\n\n<p>Please assist; this makes me crazy, it takes several days to localize the issue.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1576044744, "post_id": 59279728, "comment_id": 104766123, "body": "I just tried your code and it works fine, and I can delete it no problem as well. What OS are you using?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1576047215, "post_id": 59279728, "comment_id": 104766995, "body": "Just for testing your theory, run the Dir function again afterwards on a bogus folder name. Any difference?"}, {"owner": {"reputation": 1482, "user_id": 1030576, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3056c5185987f1265aca9235680a0bcd?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/1030576/anthony"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1576072868, "post_id": 59279728, "comment_id": 104780118, "body": "@braX Interestingly, adding this line after the <code>End If</code> statement releases the file handle: <code>FileName = Dir(Environ(&quot;USERPROFILE&quot;) &amp; &quot;\\Desktop\\ASDF123456\\&quot;, vbDirectory)</code>, which does not exist. This is in W10 Pro 64 bit with Office 365 / Outlook v1911 64 bit."}, {"owner": {"reputation": 1482, "user_id": 1030576, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3056c5185987f1265aca9235680a0bcd?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/1030576/anthony"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1576073089, "post_id": 59279728, "comment_id": 104780233, "body": "@braX More importantly, that solved the issue of not being able to delete the folder in the real script. I added a bogus <code>Dir</code> call at the end of the sub and I was immediately able to delete the folder without closing Outlook. I have no idea why this is happening."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1576082877, "post_id": 59279728, "comment_id": 104785816, "body": "Well, if it helps, I&#39;m using W10 Pro 64 too, but Office 2016"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1576083433, "post_id": 59279728, "comment_id": 104786092, "body": "Another thing to try would be to use a FileSystem object instead of Dir to see if you can avoid using the kludge of calling Dir a second time."}, {"owner": {"reputation": 1482, "user_id": 1030576, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3056c5185987f1265aca9235680a0bcd?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/1030576/anthony"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1576090426, "post_id": 59279728, "comment_id": 104789320, "body": "@braX Using an FSO solved the issue without the kludge. Good idea and thanks for the suggestion."}], "answers": [{"comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1576099457, "post_id": 59292343, "comment_id": 104793178, "body": "As a side note, you could also use the FileSystem Object to create the folder instead of using that old fashioned MkDir"}, {"owner": {"reputation": 1482, "user_id": 1030576, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3056c5185987f1265aca9235680a0bcd?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/1030576/anthony"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1576104865, "post_id": 59292343, "comment_id": 104795019, "body": "I see. Thanks for the heads up."}], "tags": [], "owner": {"reputation": 1482, "user_id": 1030576, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3056c5185987f1265aca9235680a0bcd?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/1030576/anthony"}, "is_accepted": false, "score": 1, "last_activity_date": 1576090755, "creation_date": 1576090755, "answer_id": 59292343, "question_id": 59279728, "link": "https://stackoverflow.com/questions/59279728/folder-handle-not-released-after-dir-checks-for-existence/59292343#59292343", "title": "Folder handle not released after Dir checks for existence", "body": "<p>Based on the comments from braX, I was able to prove that the <code>Dir</code> call was somehow responsible for the leftover handle. Calling <code>Dir</code> again on a non-existent folder caused the handle to be released, which solved my problem.</p>\n\n<p>A better solution, which was also suggested by braX, is to use a <code>File System Object</code>. Here is a working solution:</p>\n\n<pre><code>Sub Test()\n    Dim FSO As FileSystemObject\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n\n    Folder = Environ(\"USERPROFILE\") &amp; \"\\Desktop\\NewFolder\\\"\n    If Not FSO.FolderExists(Folder) Then\n        MkDir Folder\n    End If\nEnd Sub\n</code></pre>\n\n<p>Thanks, braX!</p>\n"}], "owner": {"reputation": 1482, "user_id": 1030576, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3056c5185987f1265aca9235680a0bcd?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/1030576/anthony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576090755, "creation_date": 1576044245, "last_edit_date": 1576044383, "question_id": 59279728, "link": "https://stackoverflow.com/questions/59279728/folder-handle-not-released-after-dir-checks-for-existence", "title": "Folder handle not released after Dir checks for existence", "body": "<p>The following code checks to see if a folder exists and, if not, creates it. The code works, but a handle that points to the folder is left open if it already exists, which prevents the folder from being deleted or renamed until <code>Outlook.exe</code> closes. I do not understand why this is happening or what to do about it, but a handle should not be open after the folder is checked and potentially created.</p>\n\n<pre><code>Sub Test()\n    Folder = Environ(\"USERPROFILE\") &amp; \"\\Desktop\\NewFolder\\\"\n    Result = Dir(Folder, vbDirectory)\n    If Result = vbNullString Then\n        MkDir Folder\n    End If\nEnd Sub\n</code></pre>\n\n<p>The first time through the code, the folder is successfully created and no file handles are open:</p>\n\n<p><a href=\"https://i.stack.imgur.com/FYwnJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FYwnJ.png\" alt=\"enter image description here\"></a></p>\n\n<p>However, the second time through the code, the folder already exists. <code>MkDir</code> does not execute, but a file handle is left open presumably after <code>Dir</code> executes:</p>\n\n<p><a href=\"https://i.stack.imgur.com/xMYwo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xMYwo.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have tried everything I could find to close all open file handles, but nothing has worked. Any help would be greatly appreciated.</p>\n"}, {"tags": ["vba", "outlook", "embed"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1576043030, "post_id": 59279493, "comment_id": 104765602, "body": "Remark out all the error handling stuff and then see what error you get on what line, and then include that in your question."}, {"owner": {"reputation": 1433, "user_id": 2381393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b047e96860b269ecfe7f0870fedeaa4?s=128&d=identicon&r=PG", "display_name": "RowanC", "link": "https://stackoverflow.com/users/2381393/rowanc"}, "edited": false, "score": 0, "creation_date": 1576044232, "post_id": 59279493, "comment_id": 104765965, "body": "duplicate of <a href=\"https://stackoverflow.com/questions/38905847/embedding-image-in-outlook-with-vba\" title=\"embedding image in outlook with vba\">stackoverflow.com/questions/38905847/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 12516013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f5eb57e3ecda37a2ad1f6c2b0810867?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Yip", "link": "https://stackoverflow.com/users/12516013/adrian-yip"}, "edited": false, "score": 0, "creation_date": 1576045639, "post_id": 59279493, "comment_id": 104766415, "body": "Body content disappeared after inserting  .Attachments.Add emails                 .Attachments.Add &quot;C:\\Users\\VAS PT 04\\Desktop\\12345678.jpeg&quot;, olByValue, 0                 .HTMLBody = &quot;&lt;BODY&gt;&lt;IMG src=&quot;&quot;cid:12345678..jpeg&quot;&quot;&gt; &lt;/BODY&gt;&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12516013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f5eb57e3ecda37a2ad1f6c2b0810867?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Yip", "link": "https://stackoverflow.com/users/12516013/adrian-yip"}, "edited": false, "score": 0, "creation_date": 1576046530, "post_id": 59279822, "comment_id": 104766738, "body": "Hi sorry I have never really used html before, the HTMLBody does not seem to working when i subbed my variables in"}, {"owner": {"reputation": 1433, "user_id": 2381393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b047e96860b269ecfe7f0870fedeaa4?s=128&d=identicon&r=PG", "display_name": "RowanC", "link": "https://stackoverflow.com/users/2381393/rowanc"}, "reply_to_user": {"reputation": 1, "user_id": 12516013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f5eb57e3ecda37a2ad1f6c2b0810867?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Yip", "link": "https://stackoverflow.com/users/12516013/adrian-yip"}, "edited": false, "score": 0, "creation_date": 1576047475, "post_id": 59279822, "comment_id": 104767101, "body": "You&#39;ll need to check that it&#39;s valid html. Perhaps put a watch on the .send, and put the .htmlbody contents into a checker (or here?). Example - I have a &lt;p&gt; open tag above, but no &lt;/p&gt;close tag"}, {"owner": {"reputation": 1, "user_id": 12516013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f5eb57e3ecda37a2ad1f6c2b0810867?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Yip", "link": "https://stackoverflow.com/users/12516013/adrian-yip"}, "edited": false, "score": 0, "creation_date": 1576048004, "post_id": 59279822, "comment_id": 104767281, "body": "hi sorry, would you be able to speak simple english, I have got a few paragraphs to chuck in for the body however have no idea what these syntax &lt;body&gt;, &lt;br/&gt;, &lt;/p&gt; mean hence have 0 idea where to put in my contents and how to separate them into paragraphs thanks a lot! #newtovba"}, {"owner": {"reputation": 1433, "user_id": 2381393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b047e96860b269ecfe7f0870fedeaa4?s=128&d=identicon&r=PG", "display_name": "RowanC", "link": "https://stackoverflow.com/users/2381393/rowanc"}, "reply_to_user": {"reputation": 1, "user_id": 12516013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f5eb57e3ecda37a2ad1f6c2b0810867?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Yip", "link": "https://stackoverflow.com/users/12516013/adrian-yip"}, "edited": false, "score": 0, "creation_date": 1576048306, "post_id": 59279822, "comment_id": 104767383, "body": "For basic HTML see here: <a href=\"https://www.w3schools.com/html/\" rel=\"nofollow noreferrer\">w3schools.com/html</a>  the email must start with &lt;body&gt; and end with &lt;/body&gt; everything in the middle is standard html"}], "tags": [], "owner": {"reputation": 1433, "user_id": 2381393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b047e96860b269ecfe7f0870fedeaa4?s=128&d=identicon&r=PG", "display_name": "RowanC", "link": "https://stackoverflow.com/users/2381393/rowanc"}, "is_accepted": false, "score": 0, "last_activity_date": 1576044957, "creation_date": 1576044957, "answer_id": 59279822, "question_id": 59279493, "link": "https://stackoverflow.com/questions/59279493/how-to-embed-a-photo-at-the-end-of-an-email/59279822#59279822", "title": "How to embed a photo at the end of an email?", "body": "<p>You'll need to use the HTMLBody property of the email, as plain text wont let you embed an image. </p>\n\n<p>You will also need to know the filename (not only path) of your image. An example of code that might work is:</p>\n\n<pre><code>On Error GoTo cleanup\nFor Each cell In Columns(\"B\").Cells.SpecialCells(xlCellTypeConstants)\nIf cell.Value Like \"?*@?*.?*\" And _\n   LCase(Cells(cell.Row, \"C\").Value) = \"yes\" Then\n\n    Set OutMail = OutApp.CreateItem(0)\n\n    On Error Resume Next\n    With OutMail\n    .Display\n    End With\n        signature = OutMail.body\n\n\n    With OutMail\n\n        .To = cell.Value\n        .CC = \"xxxxx@gmail.com; xxxxxx@hotmail.com\"\n        .Subject = \"Hello\"\n\n        imgpath = \"c:\\XXXXXX\\\"\n        sourcefile = \"XXXXXXX\"\n        sourcefile1 = \"XXXXXX\"\n        .Attachments.Add imgpath &amp; sourcefile\n        .Attachments.Add imgpath &amp; sourcefile1\n        .HTMLBody = \"&lt;body&gt;&lt;p&gt;Dear \" &amp; Cells(cell.Row, \"A\").Value _\n              &amp; \"&lt;br/&gt;&amp; _\n                \"Body\" &amp; _\n               signature &amp; _\n               \"&lt;IMG src=\"\"\"\"cid:\"\"\" &amp; sourcefile &amp; \"\"\" width=200&gt;&lt;/body&gt;\"\n\n        .Send\n\nEnd With\nSet OMail = Nothing\nSet OApp = Nothing\n\n\n    On Error GoTo 0\n    Set OutMail = Nothing\nEnd If\nNext cell\n\ncleanup:\nSet OutApp = Nothing\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12516013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f5eb57e3ecda37a2ad1f6c2b0810867?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Yip", "link": "https://stackoverflow.com/users/12516013/adrian-yip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1584164913, "creation_date": 1576042884, "last_edit_date": 1584164913, "question_id": 59279493, "link": "https://stackoverflow.com/questions/59279493/how-to-embed-a-photo-at-the-end-of-an-email", "title": "How to embed a photo at the end of an email?", "body": "<p>How can I embed a photo at the end of an email? </p>\n\n<pre><code>Application.ScreenUpdating = False\nSet OutApp = CreateObject(\"Outlook.Application\")\n\nOn Error GoTo cleanup\nFor Each cell In Columns(\"B\").Cells.SpecialCells(xlCellTypeConstants)\n    If cell.Value Like \"?*@?*.?*\" And _\n        LCase(Cells(cell.Row, \"C\").Value) = \"yes\" Then\n\n        Set OutMail = OutApp.CreateItem(0)\n\n        On Error Resume Next\n        With OutMail\n            .Display\n        End With\n        signature = OutMail.body\n\n        With OutMail\n\n            .To = cell.Value\n            .CC = \"xxxxx@gmail.com; xxxxxx@hotmail.com\"\n            .Subject = \"Hello\"\n            .body = \"Dear \" &amp; Cells(cell.Row, \"A\").Value _\n                  &amp; vbNewLine &amp; _\n                  vbNewLine &amp; _\n                  vbNewLine &amp; _\n                    \"Body\" &amp; _\n                   signature\n\n            sourcefile = \"XXXXXXX\"\n            sourcefile1 = \"XXXXXX\"\n            .Attachments.Add sourcefile\n            .Attachments.Add sourcefile1\n\n            .Send\n\n        End With\n        Set OMail = Nothing\n        Set OApp = Nothing\n\n        On Error GoTo 0\n        Set OutMail = Nothing\n    End If\nNext cell\n\ncleanup:\nSet OutApp = Nothing\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>The code works.</p>\n\n<p>I would like to embed a Xmas image (JPEG). I have done a dig around the internet however am unable to figure it out what command function I can use to embed  it.</p>\n"}, {"tags": ["vba", "svg", "export", "powerpoint", "pywin32"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 12515887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59f0b910e84f57ae61336427ab9d3ad7?s=128&d=identicon&r=PG&f=1", "display_name": "LTC", "link": "https://stackoverflow.com/users/12515887/ltc"}, "edited": false, "score": 0, "creation_date": 1598326342, "post_id": 59287686, "comment_id": 112414788, "body": "Thank you for your answer, it helps a lot, I have solved more than 95\uff05 problems, but there are left 5%. Some is that: (Below I just call the SVG  export by PowerPoint as &quot;A&quot;, and the SVG convert from EMF as &quot;B&quot;) 1. B is usually three times bigger than A, which sometimes can cause some performance issue. 2. Some effect like gradual fill may be lost in B but it&#39;s well in A. So I&#39;d like to ask when will the SVG format be added to the object model, and how can I know it has been, for example, maybe from Office updated logs or some other ways. By the way, can&#39;t I change the line in the comment?"}, {"owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "reply_to_user": {"reputation": 13, "user_id": 12515887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59f0b910e84f57ae61336427ab9d3ad7?s=128&d=identicon&r=PG&f=1", "display_name": "LTC", "link": "https://stackoverflow.com/users/12515887/ltc"}, "edited": false, "score": 0, "creation_date": 1598379020, "post_id": 59287686, "comment_id": 112438373, "body": "You can already export shapes as SVG, but it&#39;s probably going to be some time before you can export an entire slide in that format. Microsoft rarely announces additions to the VBA object model."}, {"owner": {"reputation": 13, "user_id": 12515887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59f0b910e84f57ae61336427ab9d3ad7?s=128&d=identicon&r=PG&f=1", "display_name": "LTC", "link": "https://stackoverflow.com/users/12515887/ltc"}, "edited": false, "score": 0, "creation_date": 1598415701, "post_id": 59287686, "comment_id": 112448124, "body": "Please see the &quot;2020-08-26 Additional part&quot; in the Question."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1598456019, "post_id": 59287686, "comment_id": 112466636, "body": "As JohnK&#39;s mentioned, you can&#39;t use the object model to do something that&#39;s not part of the object model, and as yet SVG export isn&#39;t there, and Microsoft isn&#39;t saying when (or if) it will be."}, {"owner": {"reputation": 13, "user_id": 12515887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59f0b910e84f57ae61336427ab9d3ad7?s=128&d=identicon&r=PG&f=1", "display_name": "LTC", "link": "https://stackoverflow.com/users/12515887/ltc"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1598582321, "post_id": 59287686, "comment_id": 112512312, "body": "I am just very curious about that how PowerPoint Application export an element to a SVG when the &quot;SVG export&quot; isn&#39;t in the object model, didn&#39;t it use the object model? If it&#39;s true, then how PowerPoint do this?  @SteveRindsberg"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1598626585, "post_id": 59287686, "comment_id": 112529518, "body": "The application itself isn&#39;t built ON the object model. It exposes parts of itself to us THROUGH the object model. The application designers may choose not to expose some features/methods of the app, or the the object model/VBA development budget is so small that there hasn&#39;t been time or resources enough to expose the new features."}, {"owner": {"reputation": 13, "user_id": 12515887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59f0b910e84f57ae61336427ab9d3ad7?s=128&d=identicon&r=PG&f=1", "display_name": "LTC", "link": "https://stackoverflow.com/users/12515887/ltc"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 1, "creation_date": 1598844951, "post_id": 59287686, "comment_id": 112579086, "body": "@SteveRindsberg Did you reply something? In my page I can see a &quot;show 1 more comment&quot; link but when I click it nothing would change.    OK, OK, when I add this new comment, I can see your last reply, thank you, you don&#39;t need to reply this comment anymore."}], "tags": [], "owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "is_accepted": true, "score": 1, "last_activity_date": 1576073543, "creation_date": 1576073543, "answer_id": 59287686, "question_id": 59279428, "link": "https://stackoverflow.com/questions/59279428/export-a-pptx-format-file-to-svg-format-files-using-vba-in-the-powerpoint-ap/59287686#59287686", "title": "Export a &#39;PPTX&#39; format file to &#39;SVG&#39; format files using VBA in the PowerPoint Application", "body": "<p>SVG is a relatively new format in PowerPoint and it hasn't been added to the object model yet. </p>\n\n<p>As a workaround, you can export as EMF. Like SVG, it's a vector format. Then convert to SVG using <a href=\"https://inkscape.org/release/inkscape-0.92.4/\" rel=\"nofollow noreferrer\">InkScape</a>, which is free and scriptable.</p>\n"}], "owner": {"reputation": 13, "user_id": 12515887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59f0b910e84f57ae61336427ab9d3ad7?s=128&d=identicon&r=PG&f=1", "display_name": "LTC", "link": "https://stackoverflow.com/users/12515887/ltc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 697, "favorite_count": 1, "accepted_answer_id": 59287686, "answer_count": 1, "score": 1, "last_activity_date": 1598415997, "creation_date": 1576042455, "last_edit_date": 1598415997, "question_id": 59279428, "link": "https://stackoverflow.com/questions/59279428/export-a-pptx-format-file-to-svg-format-files-using-vba-in-the-powerpoint-ap", "title": "Export a &#39;PPTX&#39; format file to &#39;SVG&#39; format files using VBA in the PowerPoint Application", "body": "<p>A 'pptx' format file should be able to export to a 'svg' file or some 'svg' files (just one slide to one 'svg' file) in the latest version of PowerPoint(the function is newly in the September of 2019), I can do it in PowerPoint Application. But I can not do it with the VBA in  PowerPoint Application, however I can export the 'pptx' format file to a 'png' or 'jpg' or another format file with the VBA in the PowerPoint Application.The code in the VBA is:</p>\n<pre><code>Sub test()\n\nWith Application.ActivePresentation.Slides(1)\n    .Export &quot;c:\\Graphic\\Slide1&quot;, &quot;svg&quot;\nEnd With\n\nEnd Sub\n</code></pre>\n<p>And I got this error:</p>\n<blockquote>\n<p>PowerPoint can't export the slide(s) because no installed converter\nsupports this file type.</p>\n</blockquote>\n<p>Actually what I want to do is that export the file by python(which use the pywin32 module), the code is:</p>\n<pre><code>from win32com import client as wc\nppt = wc.Dispatch('PowerPoint.Application')\ndoc = ppt.Presentations.Open(path)\ndoc.Slides(1).Export(file_path, 'svg')\n</code></pre>\n<p>And I got the same error:</p>\n<blockquote>\n<p>Slide.Export : PowerPoint can't export the slide(s) because no\ninstalled converter supports this file type.</p>\n</blockquote>\n<p>The code is really OK because if I change the 'svg' to 'png' or 'jpg' it works just fine.</p>\n<blockquote>\n<p>2020-08-26 Additional part</p>\n</blockquote>\n<p>I have updated the PowerPoint to the latest version and use makepy.py which from pywin32 to create a new py file from Microsoft PowerPoint 16.0 Object Library(2.c) named 91493440-5A91-11CF-8700-00AA0060263Bx0x2x12.py, I have compared the old file and the new file, they do have some differences, see the picture <a href=\"https://i.stack.imgur.com/UcFbI.jpg\" rel=\"nofollow noreferrer\">the difference between the new file and the old</a>, but in the &quot;Shapes Export&quot; aspect they seems to be the same, see the picture <a href=\"https://i.stack.imgur.com/CSViB.jpg\" rel=\"nofollow noreferrer\">ppShapeFormat</a>. Anyway, I have tried the following code:</p>\n<pre><code>doc.Slides(1).Shapes('Rectangle 3').Export(file_path, i)\n</code></pre>\n<p>The &quot; i &quot; I have tried -5 to 20, but only 0-5 make some difference, the other exported files is the same with i = 1(which is JPG file), and I have looked around all the files, they are all binary file which can not be SVG file, so, how can I export Shapes to SVG\uff1f</p>\n<p>By the way, I also have tried in VBA directly, and got the same result.</p>\n<p>In case of the picture can not be shown, here are some key pieces of information:</p>\n<pre><code>    ppShapeFormatBMP              =3          # from enum PpShapeFormat\n    ppShapeFormatEMF              =5          # from enum PpShapeFormat\n    ppShapeFormatGIF              =0          # from enum PpShapeFormat\n    ppShapeFormatJPG              =1          # from enum PpShapeFormat\n    ppShapeFormatPNG              =2          # from enum PpShapeFormat\n    ppShapeFormatWMF              =4          # from enum PpShapeFormat\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 1, "last_activity_date": 1576035647, "creation_date": 1576035647, "answer_id": 59278592, "question_id": 59278465, "link": "https://stackoverflow.com/questions/59278465/find-and-replace-every-second-occurrence-of-a-word-in-a-column-macro/59278592#59278592", "title": "Find and replace every second occurrence of a word in a column macro", "body": "<pre><code>Sub Blanks()\n\nDim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"Sheet1\") '&lt;-- Update Sheet Name\n\nDim i As Long, lr As Long\n\nlr = ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row\n\nFor i = 2 To lr\n    If ws.Range(\"A\" &amp; i) = \"Blank\" And (ws.Range(\"A\" &amp; i) = ws.Range(\"A\" &amp; i + 1)) Then\n        ws.Range(\"A\" &amp; i + 1) = ws.Range(\"A\" &amp; i + 1) &amp; 1\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12515475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/521e4b707ae8ace7ae65607e377a2d9c?s=128&d=identicon&r=PG&f=1", "display_name": "VBANovice123", "link": "https://stackoverflow.com/users/12515475/vbanovice123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 59278592, "answer_count": 1, "score": 0, "last_activity_date": 1576035735, "creation_date": 1576034569, "last_edit_date": 1576035735, "question_id": 59278465, "link": "https://stackoverflow.com/questions/59278465/find-and-replace-every-second-occurrence-of-a-word-in-a-column-macro", "title": "Find and replace every second occurrence of a word in a column macro", "body": "<p>I want to change every second occurrence of a word in a column to a different word\nexample:</p>\n\n<pre><code>Column A    Column B      \nBlank        123\nBlank        124\nXXXXX        125\nBlank        126\nBlank        127\nXXXX         128\nXXXX         129\nXXXX         130\netc\nBlank        150\nBlank        151\n</code></pre>\n\n<p>I want to change every second 'Blank' to something else e.g. 'Blank1'\nThe number of rows varies up to ~ 300.\nThere may be up to about 30 occurrences of the 2 'Blank' pairs.\nThe XXXX are other labels\nWant end result to be:</p>\n\n<pre><code>Column A    Column B      \n    Blank        123\n    Blank1        124\n    XXXXX        125\n    Blank        126\n    Blank1        127\n    XXXX         128\n    XXXX         129\n    XXXX         130\n    etc\n    Blank        150\n    Blank1        151`\n</code></pre>\n"}, {"tags": ["vba", "web-scraping"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1576034516, "post_id": 59278008, "comment_id": 104763565, "body": "please update to include your current code. The element has other attributes besides id and name btw - why is using those not an option? How does the id and name change each time?"}, {"owner": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1576036336, "post_id": 59278008, "comment_id": 104764005, "body": "I am not sure what code to use as doc.getElementsByName or doc.getElementById doesn&#39;t work. This is because every time I load the page the number of the id and name changed."}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1576037884, "post_id": 59278008, "comment_id": 104764332, "body": "We cannot see what you are looking at.  Please show us the html.  The &quot;Below&quot; element was not included in your description."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1576038600, "post_id": 59278008, "comment_id": 104764486, "body": "Just include your current code and explain what isn&#39;t working. If you already had solved this you wouldn&#39;t be posting here would be my guess :-)"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1576042341, "post_id": 59278008, "comment_id": 104765408, "body": "My guess is that the website is doing it on purpose to prevent people from doing what you are trying to do. What website is it?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1576042477, "post_id": 59278008, "comment_id": 104765440, "body": "What is its parent element? That unique?"}, {"owner": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "edited": false, "score": 0, "creation_date": 1576047011, "post_id": 59278008, "comment_id": 104766930, "body": "I have added the element for the particular field on top. By the way I tried this code: doc.getElementsByTagName(&quot;iframe&quot;)(0).contentDocument.queryS&zwnj;&#8203;elector(&quot;div[class=&#39;&zwnj;&#8203;field-item dataValueWrite&#39;]&quot;).Value = fileLink11 but not working"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "edited": false, "score": 0, "creation_date": 1576133512, "post_id": 59291297, "comment_id": 104801654, "body": "I tried the suggested code but was unsuccessful. It gave me an error message: &quot;Sub or Function not defined&quot; on the word Yahoo. Nothing happen if I replace it with IE.document.getElementsByTagName(&quot;div&quot;) = sheet1.Range(&quot;B2&quot;)"}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "reply_to_user": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "edited": false, "score": 0, "creation_date": 1576170584, "post_id": 59291297, "comment_id": 104821413, "body": "&quot;YAHOO&quot; was meant as a place holder for you to substitute your code for what to do when the element was successfully found.  If the error message occurred during running of the code, then it probably found the &quot;changed...&quot; element, and thus the  id=&quot;28603&quot;. So at that moment you might want to replace YAHOO with say  elem.value = sheet1.Range(&quot;B2&quot;)"}, {"owner": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "edited": false, "score": 0, "creation_date": 1576216943, "post_id": 59291297, "comment_id": 104834746, "body": "I have made the changes according to your advised but the result is still the same. The field still not being updated with the amount that is on my worksheet."}, {"owner": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "edited": false, "score": 0, "creation_date": 1576579576, "post_id": 59291297, "comment_id": 104937787, "body": "Anyone can help?"}], "tags": [], "owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "is_accepted": false, "score": 0, "last_activity_date": 1576114129, "last_edit_date": 1576114129, "creation_date": 1576085995, "answer_id": 59291297, "question_id": 59278008, "link": "https://stackoverflow.com/questions/59278008/how-to-create-a-query-when-the-entire-value-of-the-elements-attribute-changes-d/59291297#59291297", "title": "How to create a query when the entire value of the element&#39;s attribute changes dynamically", "body": "<p>Perhaps something along the line of the following -- I don't know if any of this will work..</p>\n\n<pre><code>// get all div element in DOM\nSet divs = IE.document.getElementsByTagName(\"div\")\n// loop through all div elements\nFor Each div In divs\n    // do things here\n        For Each elem In div.getElementsByTagName(\"onchange\")\n            If InStr(elem.Value, \"changedInputAmountInCurrencyDisplay\") &gt; 0 Then YAHOO: Exit For\n        Next elem\nNext div\n</code></pre>\n\n<p>The relevant part is using InStr to find part of the text.  It could also look for HIDDEN, and then everything to the Left of that is the secret sauce that changes each time, but which you now know and can then getElementByID.</p>\n\n<pre><code>InStr(elem.ID, \"HIDDEN\") &gt; 0\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576114129, "creation_date": 1576030732, "last_edit_date": 1576044477, "question_id": 59278008, "link": "https://stackoverflow.com/questions/59278008/how-to-create-a-query-when-the-entire-value-of-the-elements-attribute-changes-d", "title": "How to create a query when the entire value of the element&#39;s attribute changes dynamically", "body": "<p>I am trying insert an amount on the field which has the below element but I can't figure out what code I should use as the input id and name are dynamically changing every time I access to the page. Below is the newly extracted element.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;div class=\"field-item dataValueWrite\"&gt;\r\n&lt;table&gt;\r\n&lt;tbody&gt;\r\n&lt;tr&gt;\r\n&lt;td nowrap=\"\" align=\"left\"&gt;\r\n&lt;div id=\"28603ErrorCUSTOM\" class=\"\" style=\"display:none;\"&gt;\r\n &lt;span class=\"\" errid=\"\" title=\"Please enter a valid amount\" \r\n       id=\"28603PegaRULESErrorFlag\"&gt;&lt;/span&gt;&lt;/div&gt;\r\n &lt;input id=\"28603\" name=\"28603\" \r\n   onchange=\"changedInputAmountInCurrencyDisplay(this , '2' , '.' , '.' , ',' , 'false' ); \" \r\n   class=\"rightJustifyStyle\" type=\"text\" size=\"10\" value=\"\"&gt;\r\n  &lt;script&gt; formatCurrencyBeforeLoad(document.getElementById('28603'),'2','.', 'false'); &lt;/script&gt;\r\n  &lt;input id=\"28603HIDDEN\" name=\"$PAcqCaseCreation$pMessageAmountUSD\"\r\n       type=\"hidden\" value=\"0.00\"&gt;\r\n  &lt;script&gt; formatCurrencyBeforeLoad(document.getElementById('28603HIDDEN'),'2', '.' , 'false'); &lt;/script&gt; \r\n&amp;nbsp;USD  \r\n&lt;/td&gt;\r\n&lt;/tr&gt;\r\n&lt;/tbody&gt;\r\n&lt;/table&gt;\r\n&lt;/div&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 5, "creation_date": 1576029024, "post_id": 59277808, "comment_id": 104762486, "body": "Save yourself the trouble and just format the date to a string - <code>Format$(x, &quot;mmddyyyy&quot;)</code> - then the length is always the same and already in the format you need."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 6, "creation_date": 1576029460, "post_id": 59277808, "comment_id": 104762569, "body": "Better yet, save yourself some future headaches and change the format of your export files to <code>yyyymmdd</code>, which will allow you to properly sort them using <code>dir</code> or Explorer. If you&#39;re not sure why, create some sample text files in a folder like <code>01012019.txt</code>, <code>02012018.txt</code> and various dates in different months and years and then try to list them in chronological order."}, {"owner": {"reputation": 47, "user_id": 12161006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da636a1aa14cd9e37e6a2e534b7c11dc?s=128&d=identicon&r=PG&f=1", "display_name": "DamnGroundHog", "link": "https://stackoverflow.com/users/12161006/damngroundhog"}, "edited": false, "score": 0, "creation_date": 1576098594, "post_id": 59277808, "comment_id": 104792827, "body": "Thanks, I will use the format method.  I hadn&#39;t thought about that but appreciate the help"}], "answers": [{"tags": [], "owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "is_accepted": true, "score": 2, "last_activity_date": 1576055866, "last_edit_date": 1576055866, "creation_date": 1576035160, "answer_id": 59278538, "question_id": 59277808, "link": "https://stackoverflow.com/questions/59277808/using-the-len-function-to-get-the-length-of-a-date-in-access-vba/59278538#59278538", "title": "using the len() function to get the length of a date in access VBA", "body": "<p><code>len()</code> in VBA will give you the length of the date. In VBA many data types are actually stored as doubles under the hood. That's why you're not seeing the String length of the date, but the length of the number of digits in the <code>doubles</code> value.</p>\n\n<p>You can test this in excel, these dates:</p>\n\n<p>1/1/2019<br>\n1/10/2019</p>\n\n<p>When formatted as Numbers (5 digits length):</p>\n\n<p>43466<br>\n43739</p>\n\n<p>To fix it you can follow @braX &amp; Ken's advice with <code>Format$(x, \"yyyymmdd\")</code>, you could enclose in quotes and deduct 2 from the length, or cast the dates and work with them as strings in VBA.</p>\n"}], "owner": {"reputation": 47, "user_id": 12161006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da636a1aa14cd9e37e6a2e534b7c11dc?s=128&d=identicon&r=PG&f=1", "display_name": "DamnGroundHog", "link": "https://stackoverflow.com/users/12161006/damngroundhog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 287, "favorite_count": 1, "accepted_answer_id": 59278538, "answer_count": 1, "score": 1, "last_activity_date": 1576055866, "creation_date": 1576028889, "last_edit_date": 1576029161, "question_id": 59277808, "link": "https://stackoverflow.com/questions/59277808/using-the-len-function-to-get-the-length-of-a-date-in-access-vba", "title": "using the len() function to get the length of a date in access VBA", "body": "<p>I am writing a function which takes a date and converts into a string of characters so i can use that string of characters to save an export file.  so 12/10/2019 becomes 12102019.</p>\n\n<p>I ran into a problem and i believe I may not be using the len() function correctly.</p>\n\n<p>I wanted to ensure that single digit months and days, ie 1/1/2019 appeared as this 01012019</p>\n\n<p>I created a loop to go through an entire calendar year to test my function.</p>\n\n<pre><code>dim x as date\n\nif len(x) = 8 then\n     debug.print x\nelseif len(x) = 9 then\n     debug.print x\nend if\n</code></pre>\n\n<p>imagine this is in a loop.</p>\n\n<p>when len(x) = 8, no problem. i get the date ie 1/1/2019\nwhen len(x) = 9, ie 1/10/2019, it won't process the elseif.</p>\n\n<p>am i using the len() function correctly?  is there something else i should be using?</p>\n\n<p>thanks</p>\n\n<p>Groundhog</p>\n"}, {"tags": ["sql-server", "excel", "vba", "azure-sql-database"], "answers": [{"comments": [{"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1576030161, "post_id": 59277498, "comment_id": 104762677, "body": "I&#39;m going with the second option because I don&#39;t want to have to install drivers.  I can certainly do it myself, but if I give this to anyone else, they probably won&#39;t know what to do.  So, when I get to this line of code: rst.Open StrQuery, cnn I get an error about &#39;invalid object name&#39;.  I know the name of the table object is correct.  I feel like it&#39;s hitting the wrong DB, but the name is right there and it&#39;s spelled correctly.  It&#39;s almost like it&#39;s going to the default &#39;master&#39; DB, but I don&#39;t know how that&#39;s possible when I explicitly told it to look at the production DB."}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1576031356, "post_id": 59277498, "comment_id": 104762915, "body": "It&#39;s actually going to the default &#39;master&#39; DB, even though I&#39;m telling it to go to the prod DB, which should be handled by the Initial Catalog reference, I thought.  Anyway, is there a setting that controls this, or some way around this?  Thanks."}, {"owner": {"reputation": 49085, "user_id": 7297700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7650f380e0e3b8415ba9afaadf70906?s=128&d=identicon&r=PG&f=1", "display_name": "David Browne - Microsoft", "link": "https://stackoverflow.com/users/7297700/david-browne-microsoft"}, "reply_to_user": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1576031450, "post_id": 59277498, "comment_id": 104762928, "body": "The connection string was messed up, and it was connecting to Master.  The correct keyword for ODBC is <code>database</code> not <code>Initial Catalog</code> See edit."}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1576032997, "post_id": 59277498, "comment_id": 104763276, "body": "Thanks, but now when I hit this line: cnn.Open ConnectionString I get this error message: &#39;client driver version is not supported&#39;. I&#39;m using Office 365 ProPlus.  When I look at my drivers, I see ODBC Driver 17for SQL Server, SQL Server, and SQL Server Native Client 11.0."}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1576034562, "post_id": 59277498, "comment_id": 104763577, "body": "I&#39;m on Windows 10 Enterprise."}, {"owner": {"reputation": 49085, "user_id": 7297700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7650f380e0e3b8415ba9afaadf70906?s=128&d=identicon&r=PG&f=1", "display_name": "David Browne - Microsoft", "link": "https://stackoverflow.com/users/7297700/david-browne-microsoft"}, "reply_to_user": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 1, "creation_date": 1576086420, "post_id": 59277498, "comment_id": 104787528, "body": "I&#39;m getting that too now.  It looks like you&#39;ll need to use one of the newer ODBC drivers. See edit."}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1576087688, "post_id": 59277498, "comment_id": 104788119, "body": "Yeap, yeap!  It&#39;s working now.  I should have figured that out.  I saw that in my list of ODBC drivers, but I didn&#39;t pay much attention to it yesterday.  Thanks for the assist!!"}], "tags": [], "owner": {"reputation": 49085, "user_id": 7297700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7650f380e0e3b8415ba9afaadf70906?s=128&d=identicon&r=PG&f=1", "display_name": "David Browne - Microsoft", "link": "https://stackoverflow.com/users/7297700/david-browne-microsoft"}, "is_accepted": true, "score": 2, "last_activity_date": 1576086676, "last_edit_date": 1576086676, "creation_date": 1576026000, "answer_id": 59277498, "question_id": 59277300, "link": "https://stackoverflow.com/questions/59277300/can-you-use-adodb-to-connect-excel-to-azure-sql-server-dw/59277498#59277498", "title": "Can you use ADODB to connect Excel to Azure SQL Server DW?", "body": "<p>You're not pasting in the variables to the connection string.  And the old <code>SQLOLEDB</code> provider is too old to connect to Azure.  You'll need to install the new one from <a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=56730\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<pre><code>ConnectionString = \"Provider=MSOLEDBSQL;Password=\" &amp; pswd &amp; \";User ID=\" &amp; user &amp; \";Data Source=\" &amp; server &amp; \";Use Encryption for Data=False;Initial Catalog=\" &amp; dbName &amp; \"\"\n</code></pre>\n\n<p>If you don't want to install MSOLEDBSQL, you can use one of the <a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=56567\" rel=\"nofollow noreferrer\">newer ODBC drivers</a>. The connection string is a bit wierd, as you use the <code>OleDb Provider for ODBC Drivers</code>.  EG:</p>\n\n<pre><code>ConnectionString = \"Provider=MSDASQL;Extended Properties=\"\"Driver={ODBC Driver 17 for SQL Server};pwd=\" &amp; pswd &amp; \";uid=\" &amp; user &amp; \";Server=\" &amp; server &amp; \";database=\" &amp; dbName &amp; \"\"\"\"\n</code></pre>\n"}], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 863, "favorite_count": 0, "accepted_answer_id": 59277498, "answer_count": 1, "score": 1, "last_activity_date": 1576086676, "creation_date": 1576024287, "last_edit_date": 1576025261, "question_id": 59277300, "link": "https://stackoverflow.com/questions/59277300/can-you-use-adodb-to-connect-excel-to-azure-sql-server-dw", "title": "Can you use ADODB to connect Excel to Azure SQL Server DW?", "body": "<p>I'm trying to run a simple query from Excel to newer version of SQL Server.  I have done this many times in the past, but it was always to a standard SQL Server DB.  Now, I'm working with a new animal, which is Azure SQL Server Data Warehouse.  I am using very generic VBA code to connect to the DW.</p>\n\n<pre><code>Sub TryMe()\n\n'Initializes variables\nDim cnn As New ADODB.Connection\nDim rst As New ADODB.Recordset\nDim ConnectionString As String\nDim StrQuery As String\n\npswd = \"my_pwd\"\nuser = \"my_used_ID\"\ndbName = \"my_DB_name\"\nserver = \"server_name.database.Windows.net\"\n\n'Setup the connection string for accessing MS SQL database\n   'Make sure to change:\n       '1: PASSWORD\n       '2: USERNAME\n       '3: REMOTE_IP_ADDRESS\n       '4: DATABASE\n    ConnectionString = \"Provider=SQLOLEDB;Password=pswd;User ID=user;Data Source=server;Use Encryption for Data=False;Initial Catalog=dbname\"\n\n    'Opens connection to the database\n    cnn.Open ConnectionString\n    'Timeout error in seconds for executing the entire query; this will run for 15 minutes before VBA timesout, but your database might timeout before this value\n    cnn.CommandTimeout = 900\n\n    'This is your actual MS SQL query that you need to run; you should check this query first using a more robust SQL editor (such as HeidiSQL) to ensure your query is valid\n    StrQuery = \"SELECT TOP 10 * FROM myBigTable\"\n\n    'Performs the actual query\n    rst.Open StrQuery, cnn\n    'Dumps all the results from the StrQuery into cell A2 of the first sheet in the active workbook\n    Sheets(1).Range(\"A2\").CopyFromRecordset rst\nEnd Sub\n</code></pre>\n\n<p>It should be a pretty straightforward thing, but I keep getting an error message that says: 'SQL Server does not exist or access is denied'.</p>\n\n<p>The error occurs on this line:</p>\n\n<pre><code>cnn.Open ConnectionString\n</code></pre>\n\n<p>I set a reference to <code>Microsoft ActiveX Data Objects 2.0 Library</code>.</p>\n\n<p>Has anyone tried this and actually gotten this to work?</p>\n"}, {"tags": ["excel", "vba", "find", "range"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1576026411, "post_id": 59276494, "comment_id": 104761956, "body": "<code>Cells.Find()</code> with no worksheet qualifier will default to the ActiveSheet - that can cause problems, so the first step would be to update your code to always use specific worksheets/ranges when referencing any Range/Cells.  In this case <code>worksheetReference.Range(&quot;AJ:AJ&quot;).find()</code>"}, {"owner": {"reputation": 3, "user_id": 12514175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rYlMW.jpg?s=128&g=1", "display_name": "LemonFresh", "link": "https://stackoverflow.com/users/12514175/lemonfresh"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1576030096, "post_id": 59276494, "comment_id": 104762670, "body": "first of all, thx for the reply, I continued trying to solve it and I did came to that same solution, I added <code>Dim WBevoDeuM As Worksheet</code> defined it and <code>Set GaRangeID = WBevoDeuM.Range(&quot;AJ:AJ11000&quot;).Find[...]</code> but still no results."}, {"owner": {"reputation": 3, "user_id": 12514175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rYlMW.jpg?s=128&g=1", "display_name": "LemonFresh", "link": "https://stackoverflow.com/users/12514175/lemonfresh"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1576030911, "post_id": 59276494, "comment_id": 104762820, "body": "I added a   <code>If GaRangeID Is Nothing Then         MsgBox &quot;No Value Found in Cell &quot; &amp; vbCrLf</code> and effectively, it proved it does not find the value despite being there. The information on AJ has a Header in row 1 if its relevant info."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1576032984, "post_id": 59276494, "comment_id": 104763274, "body": "Can you update the question with your revised code?  if you&#39;re not finding the value then there must be some problem with either the search value of the value in the cell.  If you copy/paste the value from your code into a cell does it get found?"}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1576034080, "post_id": 59276494, "comment_id": 104763480, "body": "If you did find the value <code>GaRangeID.Offset(0, -21).Range(&quot;A1&quot;)</code> is not a valid range address.  The <code>Range(\u201cA1\u201d)</code> part is invalid."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1576036469, "post_id": 59276494, "comment_id": 104764032, "body": "@DarrellH - it&#39;s not invalid - you can have a range which is relative to another.  It serves no useful purpose here though:  e.g. <code>Range(&quot;D3&quot;).Range(&quot;A1&quot;)</code> is just <code>Range(&quot;D3&quot;)</code>"}, {"owner": {"reputation": 3, "user_id": 12514175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rYlMW.jpg?s=128&g=1", "display_name": "LemonFresh", "link": "https://stackoverflow.com/users/12514175/lemonfresh"}, "edited": false, "score": 0, "creation_date": 1576037105, "post_id": 59276494, "comment_id": 104764171, "body": "I tryed copy pasting the string of text andthe control+f found it just fine so that wasnt the problem, I just updated the code (once again). I know I started working with VBA just yesterday but this... Im at a loss."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1576038847, "post_id": 59276494, "comment_id": 104764544, "body": "Is ModeloAnalisis.xlsm the workbook containing your code?"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1576039661, "creation_date": 1576039661, "answer_id": 59279051, "question_id": 59276494, "link": "https://stackoverflow.com/questions/59276494/storage-of-range-values-after-find/59279051#59279051", "title": "Storage of Range Values after .Find", "body": "<p>I don't have much to offer except to simplify your code a bit and use <code>xlValues</code> instead of <code>xlFormulas</code> for the <code>LookIn</code> parameter</p>\n\n<pre><code>Sub Tester()\n\n    Dim f As Range\n    Dim WBModeloA1 As Worksheet\n    Dim WBModeloA2 As Worksheet\n    Dim wsData As Worksheet, rngSearch As Range\n\n    'use \"ThisWorkbook\" if it's where your code lives\n    Set WBModeloA1 = ThisWorkbook.Sheets(\"Cartera 1\")\n    Set WBModeloA2 = ThisWorkbook.Sheets(\"Cartera 3\")\n    Set wsData = ThisWorkbook.Sheets(\"Data\") 'the sheet you're searching\n\n    'define a range to search\n    Set rngSearch = wsData.Range(wsData.Range(\"AJ1\"), _\n                                 wsData.Cells(Rows.Count, \"AJ\").End(xlUp))\n\n    'if you have multiple of these following blocks you really need a loop\n\n    Set f = rngSearch.Find(what:=\"WarrantyPrefA Total\", LookIn:=xlValues, _\n                           lookat:=xlWhole, MatchCase:=False)\n\n    If Not f Is Nothing Then\n        WBModeloA1.Range(\"E67\") = f.Offset(0, -3).Value / 1000\n        WBModeloA2.Range(\"H91\") = f.Offset(0, -21).Value / 1000\n    End If\n\n    Set f = rngSearch.Find(what:=\"WarrantyPrefB Total\", LookIn:=xlValues, _\n                           lookat:=xlWhole, MatchCase:=False)\n\n    If Not f Is Nothing Then\n        WBModeloA1.Range(\"E65\") = f.Offset(0, -3).Value / 1000\n        WBModeloA2.Range(\"H90\") = f.Offset(0, -21).Value / 1000\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12514175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rYlMW.jpg?s=128&g=1", "display_name": "LemonFresh", "link": "https://stackoverflow.com/users/12514175/lemonfresh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1582129876, "creation_date": 1576018254, "last_edit_date": 1582129876, "question_id": 59276494, "link": "https://stackoverflow.com/questions/59276494/storage-of-range-values-after-find", "title": "Storage of Range Values after .Find", "body": "<p>This is part of a bigger code that both filters based on input text and then creates subtotals out of the values associated with warranty subtypes, this is applied to several different sheets and it all works.</p>\n\n<p>There is the possibility of many different Warranties subtypes.</p>\n\n<p>I check for each one individually, first for an exact match case for \"WarrantyPrefA Total\" (this should be on the AJ Column).</p>\n\n<ul>\n<li><p>If it exists, I want to store that range value inside a variable(GaRangeID), so I can apply an offset of that range to grab the two numerical values present in other columns and paste it on another Workbook.</p></li>\n<li><p>If it doesn't exist, I want to terminate that find, and find another exact match case.</p></li>\n</ul>\n\n<p>My guess is I'm messing up the <code>.Find</code> inner syntax to search the correct range.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim GaRangeID As Range\nDim WBModeloA1 As Worksheet\nDim WBModeloA2 As Worksheet\nSet WBModeloA1 = Workbooks(\"ModeloAnalisis.xlsm\").Sheets(\"Cartera 1\")\nSet WBModeloA2 = Workbooks(\"ModeloAnalisis.xlsm\").Sheets(\"Cartera 3\")\n\n'GPB\n\n Dim strSearch As String\n    Dim lastrow As Long\n\n    strSearch = \"WarrantyPrefA Total\"\n    lastrow = WBevoDeuM.Range(\"AJ\" &amp; Rows.Count).End(xlUp).Row\n\n   Set GaRangeID = WBevoDeuM.Range(\"AJ1\", \"AJ\" &amp; lastrow).Find(What:=strSearch, LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:= _\n        xlNext, MatchCase:=False, SearchFormat:=False)\n\n    If Not GaRangeID Is Nothing Then\n\n       WBModeloA1.Range(\"E67\") = GaRangeID.Offset(0, -3).Range(\"A1\")\n       WBModeloA1.Range(\"E67\").Value = WBModeloA1.Range(\"E67\").Value / 1000\n\n       WBModeloA2.Range(\"H91\") = GaRangeID.Offset(0, -21).Range(\"A1\")\n       WBModeloA2.Range(\"H91\").Value = WBModeloA2.Range(\"H91\").Value / 1000\n\n    Else\n    End If\n\n'GPA\n\n   Set GaRangeID = Cells.Find(What:=\"WarrantyPrefB Total\", After:=ActiveCell, LookIn _\n   :=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:= _\n        xlNext, MatchCase:=False, SearchFormat:=False)\n\nIf Not GaRangeID Is Nothing Then\n\n   WBModeloA1.Range(\"E65\") = GaRangeID.Offset(0, -3).Range(\"A1\")\n   WBModeloA1.Range(\"E65\").Value = WBModeloA1.Range(\"E65\").Value / 1000\n\n   WBModeloA2.Range(\"H90\") = GaRangeID.Offset(0, -21).Range(\"A1\")\n   WBModeloA2.Range(\"H90\").Value = WBModeloA2.Range(\"H90\").Value / 1000\n\nElse\nEnd If\n</code></pre>\n\n<p>The reason I show it repeats the same structure but with another find afterwards is because I used to have the \"find\" part defined in another way.</p>\n\n<p><strong>The following way properly pastes the subtotals onto the other workbook</strong>, but I discarded it since it always sets the GaRangeID as the active cell, when the search gets nothing, the active cell remains as the old subtotal found, and so it just pastes the values of WarrantyA onto B.</p>\n\n<pre><code>Cells.Find(What:=\"WarrantyPrefB Total\", After:=ActiveCell, LookIn _\n    :=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:= _\n    xlNext, MatchCase:=False, SearchFormat:=False).Activate\n    Set GaRangeID = ActiveCell\n</code></pre>\n"}, {"tags": ["excel", "vba", "gridlines"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1576018635, "post_id": 59276215, "comment_id": 104760039, "body": "One step from this question  - <a href=\"https://stackoverflow.com/questions/24045305/is-there-a-way-to-derive-the-chart-from-an-axis-in-excel-vba\" title=\"is there a way to derive the chart from an axis in excel vba\">stackoverflow.com/questions/24045305/&hellip;</a>"}, {"owner": {"reputation": 51, "user_id": 10956787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d54d7139ee14674ae4995b00d0bfefa1?s=128&d=identicon&r=PG&f=1", "display_name": "Jumpy73", "link": "https://stackoverflow.com/users/10956787/jumpy73"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1576055774, "post_id": 59276215, "comment_id": 104770732, "body": "I have already seen that post... I have the problem that I use Axis titles and some of them are based on a formula. How to add a prefix &quot;Chart1AxV-&quot; to the current formula in axis title caption and format it to be white and leave the rest of the formula in Automatic color?"}, {"owner": {"reputation": 51, "user_id": 10956787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d54d7139ee14674ae4995b00d0bfefa1?s=128&d=identicon&r=PG&f=1", "display_name": "Jumpy73", "link": "https://stackoverflow.com/users/10956787/jumpy73"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1576056408, "post_id": 59276215, "comment_id": 104771087, "body": "Yust to be clear... the Xaxis title caption is a link to a cell, in that cell there is a formula whose result is the string I want. I can add every prefix I want in that formula but it should then be formatted to be white and the rest leaved to be automatic... I don&#39;t know how to do it"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1576079543, "post_id": 59276215, "comment_id": 104783994, "body": "You can&#39;t do mixed formatting on a chart like you can&#39;t do it in a cell with a formula.  You have to update the chart axis label using a macro instead of a link."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 10956787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d54d7139ee14674ae4995b00d0bfefa1?s=128&d=identicon&r=PG&f=1", "display_name": "Jumpy73", "link": "https://stackoverflow.com/users/10956787/jumpy73"}, "is_accepted": false, "score": 0, "last_activity_date": 1576104213, "creation_date": 1576104213, "answer_id": 59295254, "question_id": 59276215, "link": "https://stackoverflow.com/questions/59276215/gridline-object-how-to-retrieve-the-reference-to-the-worksheet/59295254#59295254", "title": "Gridline object... How to retrieve the reference to the worksheet?", "body": "<p>I start using the answer of the post <a href=\"https://stackoverflow.com/questions/24045305/is-there-a-way-to-derive-the-chart-from-an-axis-in-excel-vba\">stackoverflow.com/questions/24045305</a>. Then I added a For.. Next cycle through the worksheets collection (I don't have only one sheet and it is not always the same Chart of interest).</p>\n\n<p>Furthermore, because of the AxisTitle caption is currently meaningful for me and its value is based on a cell formula result (it can't be prefixed and formatted to be white and the rest leaved to be automatic), I solved the problem adding a textbox whose value is now the cell formula result and the AxisTitle caption contains now only the unique identifier formatted to be white.</p>\n"}], "owner": {"reputation": 51, "user_id": 10956787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d54d7139ee14674ae4995b00d0bfefa1?s=128&d=identicon&r=PG&f=1", "display_name": "Jumpy73", "link": "https://stackoverflow.com/users/10956787/jumpy73"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576104213, "creation_date": 1576016370, "question_id": 59276215, "link": "https://stackoverflow.com/questions/59276215/gridline-object-how-to-retrieve-the-reference-to-the-worksheet", "title": "Gridline object... How to retrieve the reference to the worksheet?", "body": "<p>how to retrieve the reference to the chart and to the worksheet where the chart of the gridline object is, starting from the object itself?</p>\n\n<p>For example, if I have a Range object, the object.Parent is the reference to the Worksheet.\nHow to do it if the starting object is the gridline object of a chart embedded into a worksheet?</p>\n\n<p>Thanks in advance to everyone can help to put me in the right direction </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 0, "creation_date": 1576021828, "post_id": 59276562, "comment_id": 104760881, "body": "Hmm I&#39;ll have to test, leaving for the day, but moving data around to different worksheets might not work as expected. Imagine I have cells <code>A1:A4</code> to merge but also <code>B2:B3</code>. I want the cells merged but the rows to stay in position."}, {"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 0, "creation_date": 1576185335, "post_id": 59276562, "comment_id": 104827447, "body": "This gave error <code>User-defined type not defined</code> which I&#39;m guessing means I have to enable a reference library. I don&#39;t use code that requires enabling anything as my code must be portable. Thank you though!"}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 0, "last_activity_date": 1576018605, "creation_date": 1576018605, "answer_id": 59276562, "question_id": 59275735, "link": "https://stackoverflow.com/questions/59275735/merge-all-duplicate-cells-in-entire-worksheet-excel-vba/59276562#59276562", "title": "Merge all duplicate cells in entire worksheet - Excel VBA", "body": "<p>The problem I see with the methods outlined above is that it relies on duplicate data existing in an adjacent cell in the column. What if the duplicates are scattered in the column?</p>\n\n<p>Here's an example where each column is examined by creating a <code>Dictionary</code> of all the values. Since each value must be unique (as the Key), then duplicates are removed with a list of just the unique Keys. Then it's just a matter of clearing the column of the previous data and copying the unique data back to the worksheet.</p>\n\n<pre><code>Option Explicit\n\nSub RemoveColumnDupes()\n    Dim lastCol As Long\n    With Sheet1\n        lastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n\n        Dim c As Long\n        For c = 1 To lastCol\n            Dim columnDict As Dictionary\n            Set columnDict = CreateColumnDictionary(Sheet1, c)\n            If columnDict is Nothing then Exit For\n\n            '--- clear the existing data and replace with the cleaned up data\n            .Range(\"A1\").Offset(, c - 1).Resize(.Rows.Count, 1).Clear\n            .Range(\"A1\").Offset(, c - 1).Resize(columnDict.Count, 1) = KeysToArray(columnDict)\n        Next c\n    End With\nEnd Sub\n\nPrivate Function CreateColumnDictionary(ByRef ws As Worksheet, _\n                                        ByVal colIndex As Long) As Dictionary\n    Dim colDict As Dictionary\n    Dim lastRow As Long\n    With ws\n        lastRow = .Cells(.Rows.Count, colIndex).End(xlUp).Row\n        If lastRow = 1 Then\n            '--- can't create a dictionary with no data, so exit\n            Set colDict = Nothing\n        Else\n            Set colDict = New Dictionary\n            Dim i As Long\n            For i = 1 To lastRow\n                If Not colDict.Exists(.Cells(i, colIndex).Value) Then\n                    colDict.Add .Cells(i, colIndex).Value, i\n                End If\n            Next i\n        End If\n    End With\n    Set CreateColumnDictionary = colDict\nEnd Function\n\nPrivate Function KeysToArray(ByRef thisDict As Dictionary) As Variant\n    Dim newArray As Variant\n    ReDim newArray(1 To thisDict.Count, 1 To 1)\n\n    Dim i As Long\n    For i = 1 To thisDict.Count\n        newArray(i, 1) = thisDict.Keys(i - 1)\n    Next i\n    KeysToArray = newArray\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "is_accepted": true, "score": 0, "last_activity_date": 1576185489, "creation_date": 1576185489, "answer_id": 59312842, "question_id": 59275735, "link": "https://stackoverflow.com/questions/59275735/merge-all-duplicate-cells-in-entire-worksheet-excel-vba/59312842#59312842", "title": "Merge all duplicate cells in entire worksheet - Excel VBA", "body": "<p>While I don't know the issue with the code I found and posted in OP. I did find awesome solutions on <a href=\"https://www.extendoffice.com\" rel=\"nofollow noreferrer\">https://www.extendoffice.com</a> and modified it to suit my needs as found below.</p>\n\n<p><strong>Test:</strong></p>\n\n<pre><code>Sub MergeTest()\n Dim wsrng As Range\n Set wsrng = ActiveSheet.UsedRange\n Call MergeWS(wsrng)\n 'Call UnMergeWS(wsrng)\nEnd Sub\n</code></pre>\n\n<p><strong>Merge:</strong></p>\n\n<p><a href=\"https://www.extendoffice.com/documents/excel/1138-excel-merge-same-value.html\" rel=\"nofollow noreferrer\">https://www.extendoffice.com/documents/excel/1138-excel-merge-same-value.html</a></p>\n\n<pre><code>Function MergeWS(WorkRng As Range)\nDim Rng As Range, xCell As Range\nDim xRows As Integer\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\nxRows = WorkRng.Rows.Count\nFor Each Rng In WorkRng.Columns\n    For i = 1 To xRows - 1\n        For j = i + 1 To xRows\n            If Rng.Cells(i, 1).Value &lt;&gt; Rng.Cells(j, 1).Value Then\n                Exit For\n            End If\n        Next\n        With WorkRng.Parent.Range(Rng.Cells(i, 1), Rng.Cells(j - 1, 1))\n            .Merge\n            .HorizontalAlignment = xlCenter\n            .VerticalAlignment = xlCenter\n        End With\n        i = j - 1\n    Next\nNext\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\nEnd Function\n</code></pre>\n\n<p><strong>UnMerge:</strong></p>\n\n<p><a href=\"https://www.extendoffice.com/documents/excel/1139-excel-unmerge-cells-and-fill.html\" rel=\"nofollow noreferrer\">https://www.extendoffice.com/documents/excel/1139-excel-unmerge-cells-and-fill.html</a></p>\n\n<pre><code>Function UnMergeWS(WorkRng As Range)\nDim Rng As Range, xCell As Range\nxTitleId = \"KutoolsforExcel\"\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\nFor Each Rng In WorkRng\n    If Rng.MergeCells Then\n        With Rng.MergeArea\n            .UnMerge\n            .Formula = Rng.Formula\n        End With\n    End If\nNext\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\nEnd Function\n</code></pre>\n\n<p><a href=\"https://www.freesoftwareservers.com/display/FREES/Merge+and+UnMerge+cells+-+Excel+VBA\" rel=\"nofollow noreferrer\">https://www.freesoftwareservers.com/display/FREES/Merge+and+UnMerge+cells+-+Excel+VBA</a></p>\n"}], "owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 59312842, "answer_count": 2, "score": 1, "last_activity_date": 1576185538, "creation_date": 1576013851, "last_edit_date": 1576185538, "question_id": 59275735, "link": "https://stackoverflow.com/questions/59275735/merge-all-duplicate-cells-in-entire-worksheet-excel-vba", "title": "Merge all duplicate cells in entire worksheet - Excel VBA", "body": "<p>I'm trying to build a macro which will iterate through <code>Activeworkbook/Activeworksheet</code>&amp; <code>Range(\"A1:\" &amp; LastColumn &amp; LastRow)</code> and merge all duplicates in each column. The best starting point I could find was this post --> <a href=\"https://stackoverflow.com/questions/45737497/fastest-way-to-merge-duplicate-cells-in-without-looping-excel/45739951#comment104755961_45739951\">fastest way to merge duplicate cells in without looping Excel</a></p>\n\n<p>But, like the OP comments on @PEH's answer <a href=\"https://stackoverflow.com/a/45739951/5079799\">https://stackoverflow.com/a/45739951/5079799</a> I get the following error <code>Application defined error</code> on the line <code>Set R = .Range(Join(arr, \",\"))</code>.</p>\n\n<p>Does anybody have the fix and/or a better/alternative way to merge duplicates in a column?</p>\n\n<p><strong>Code from answer:</strong></p>\n\n<pre><code>Sub MergeCellsNew()\n    Application.DisplayAlerts = False\n    Dim n As Name\n    Dim fc As FormatCondition\n    Dim Rng As Range, R As Range\n    Dim lRow As Long\n    Dim I&amp;, J&amp;\n    Dim arr As Variant\n\n    ReDim arr(1 To 1) As Variant\n\n    With ThisWorkbook.Sheets(\"tst\")\n        Set Rng = .Range(\"A2:D11\")\n        lRow = Rng.End(xlDown).Row\n\n        For J = 1 To 4\n            I = 2 'I = Rng.Row   to automatically start at the first row of Rng\n            Do While I &lt;= lRow\n                Set R = .Cells(I, J) 'remember start cell\n\n                'run this loop as long as duplicates found next to the start cell\n                Do While Trim(UCase(.Cells(I, J))) = Trim(UCase(.Cells(I + 1, J)))\n                    Set R = R.Resize(R.Rows.Count + 1) 'and resize R + 1\n                    I = I + 1\n                Loop\n\n                'now if R is bigger than one cell there are duplicates we want to add to the arr\n                'this way single cells are not added to the arr\n                If R.Rows.Count &gt; 1 Then\n                    arr(UBound(arr)) = R.Address\n                    ReDim Preserve arr(1 To UBound(arr) + 1)\n                End If\n                I = I + 1\n            Loop\n        Next J\n        ReDim Preserve arr(1 To UBound(arr) - 1)\n\n        Set R = .Range(Join(arr, \",\"))\n        With R\n            .Merge\n            .HorizontalAlignment = xlCenter\n            .VerticalAlignment = xlCenter\n        End With\n\n        Stop\n    End With\n\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576013134, "post_id": 59275584, "comment_id": 104758151, "body": "Is the template workbook open in protected view on your coworker&#39;s computer?"}, {"owner": {"reputation": 1, "user_id": 12514137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b59de7cbe103bb75278f4cc8fe111682?s=128&d=identicon&r=PG&f=1", "display_name": "Wal-Mart Security", "link": "https://stackoverflow.com/users/12514137/wal-mart-security"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576013448, "post_id": 59275584, "comment_id": 104758262, "body": "I don&#39;t think so, we saved it to the desktop and opened all the workbooks from there."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576013477, "post_id": 59275584, "comment_id": 104758269, "body": "It still could be opened in protected view. That&#39;s the only reason I can think of that it would not show up in the <code>Workbooks</code> collection."}, {"owner": {"reputation": 1, "user_id": 12514137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b59de7cbe103bb75278f4cc8fe111682?s=128&d=identicon&r=PG&f=1", "display_name": "Wal-Mart Security", "link": "https://stackoverflow.com/users/12514137/wal-mart-security"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576013666, "post_id": 59275584, "comment_id": 104758341, "body": "OK, I will double-check that and let you know.  I figured it was something like that at first, and looked for the protected view ribbon, but did not see it.  Maybe it is still enabled."}, {"owner": {"reputation": 1, "user_id": 12514137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b59de7cbe103bb75278f4cc8fe111682?s=128&d=identicon&r=PG&f=1", "display_name": "Wal-Mart Security", "link": "https://stackoverflow.com/users/12514137/wal-mart-security"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576014968, "post_id": 59275584, "comment_id": 104758835, "body": "I tested it on another coworker&#39;s computer, the files are not in protected view.  This time it found 3 of the 4 workbooks open."}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1576020185, "post_id": 59275584, "comment_id": 104760439, "body": "NOTE: Don&#39;t use underscore <code>_</code> in procedure names because those are used to identify Event handlers."}, {"owner": {"reputation": 1, "user_id": 12514137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b59de7cbe103bb75278f4cc8fe111682?s=128&d=identicon&r=PG&f=1", "display_name": "Wal-Mart Security", "link": "https://stackoverflow.com/users/12514137/wal-mart-security"}, "edited": false, "score": 0, "creation_date": 1576080818, "post_id": 59275584, "comment_id": 104784750, "body": "Thank you, noted, I will remove the underscores from the procedure name."}], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1576021175, "post_id": 59276772, "comment_id": 104760718, "body": "<i>Window objects are like different instances of Excel.</i> that&#39;s just, ... wrong.  Any given instance of Excel  can have many Windows, including  more than 1 per workbook.  That said, the likely cause <i>is</i> that the workbooks are open in different instances of Excel"}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1576023656, "post_id": 59276772, "comment_id": 104761307, "body": "That&#39;s why I used the word <i>like</i> instead of <i>are</i>. You can talk to a different instance by using the <code>Windows</code> object when you can&#39;t access it by using <code>Workbooks</code>. That was my point and I believe it holds true."}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1576080717, "post_id": 59276772, "comment_id": 104784689, "body": "Okay, I removed the part about using <code>Windows</code> object. The rest of my advice still holds. I looked in to how to attach to other instances of Excel and, you&#39;re right, it&#39;s much more difficult than using the <code>Windows</code> object. I guess I&#39;ve never actually done it."}, {"owner": {"reputation": 1, "user_id": 12514137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b59de7cbe103bb75278f4cc8fe111682?s=128&d=identicon&r=PG&f=1", "display_name": "Wal-Mart Security", "link": "https://stackoverflow.com/users/12514137/wal-mart-security"}, "edited": false, "score": 0, "creation_date": 1576080780, "post_id": 59276772, "comment_id": 104784726, "body": "Thank you for this.  I am going to try this out and see if it fixes the weird issues when using the macro on different computers.  Strange thing this morning we tried the macro again on my coworker&#39;s computer with the original code, and it worked."}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1576080906, "post_id": 59276772, "comment_id": 104784795, "body": "Yes, it would be intermittent if the problem is how your user opened the workbooks. That&#39;s why you shouldn&#39;t rely on them when you can automate. Keep it as simple as possible for the user."}, {"owner": {"reputation": 1, "user_id": 12514137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b59de7cbe103bb75278f4cc8fe111682?s=128&d=identicon&r=PG&f=1", "display_name": "Wal-Mart Security", "link": "https://stackoverflow.com/users/12514137/wal-mart-security"}, "edited": false, "score": 0, "creation_date": 1576081007, "post_id": 59276772, "comment_id": 104784846, "body": "HackSlash, will I need to do Dim masterBook as Workbook also?  I&#39;m just trying to understand the defining variables thing."}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1576081316, "post_id": 59276772, "comment_id": 104785013, "body": "Yes, you should use <code>Option Explicit</code> at the top of every module because that forces you to declare all variables with <code>Dim</code>. This avoids problems from typos. If you know the variable type you should always declare it as specific as possible. In this case, we know it&#39;s a <code>Workbook</code>. Doing this will allow intellisense to work. That&#39;s the popup that shows what options are available for the object you are working with."}, {"owner": {"reputation": 1, "user_id": 12514137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b59de7cbe103bb75278f4cc8fe111682?s=128&d=identicon&r=PG&f=1", "display_name": "Wal-Mart Security", "link": "https://stackoverflow.com/users/12514137/wal-mart-security"}, "edited": false, "score": 0, "creation_date": 1576082107, "post_id": 59276772, "comment_id": 104785391, "body": "Thank you! I&#39;m having to read several times and google to understand, but I&#39;m going to try to improve the macro with this."}, {"owner": {"reputation": 1, "user_id": 12514137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b59de7cbe103bb75278f4cc8fe111682?s=128&d=identicon&r=PG&f=1", "display_name": "Wal-Mart Security", "link": "https://stackoverflow.com/users/12514137/wal-mart-security"}, "edited": false, "score": 0, "creation_date": 1576083326, "post_id": 59276772, "comment_id": 104786040, "body": "I ran into a run-time error &#39;1004&#39; because the template file cannot be found.  Do I need to put the full folder location in?"}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1576083393, "post_id": 59276772, "comment_id": 104786067, "body": "Yes, always use the full path because the default path is different on each computer. That&#39;s why I told you to put the files on a server share. Then you can hit the same path from all PCs."}], "tags": [], "owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "is_accepted": false, "score": 0, "last_activity_date": 1576080632, "last_edit_date": 1576080632, "creation_date": 1576020089, "answer_id": 59276772, "question_id": 59275584, "link": "https://stackoverflow.com/questions/59275584/subscript-out-of-range-cant-find-open-workbooks-on-another-computer/59276772#59276772", "title": "Subscript out of range - Can&#39;t find Open Workbooks on Another Computer", "body": "<p>I'm guessing that your workbooks are opened in different instances. You can't control what your users are going to do so I would recommend opening the files using VBA so that you get a handle on them as they are opened.</p>\n\n<pre><code>Dim templateBook as Workbook\nSet templateBook = Workbooks.Open(\"Template1.xlsx\")\n</code></pre>\n\n<p>This way you can use the <code>templateBook</code> object to do all the things you need to do. I would then further recommend that you keep these workbooks on a server share so their location is reliable. Then any employee can run these things, they all run off the server and you never have to worry about \"works on my machine\" again.</p>\n\n<p>Finally, don't use copy and paste. Once you have workbook handles you can set values directly without copy and paste. It looks like this:</p>\n\n<pre><code>masterBook.Worksheets(\"1\").Range(\"A65:E104\").Value = templateBook.Worksheets(\"1\").Range(\"A65:E104\").Value\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12514137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b59de7cbe103bb75278f4cc8fe111682?s=128&d=identicon&r=PG&f=1", "display_name": "Wal-Mart Security", "link": "https://stackoverflow.com/users/12514137/wal-mart-security"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576080632, "creation_date": 1576013093, "last_edit_date": 1576025156, "question_id": 59275584, "link": "https://stackoverflow.com/questions/59275584/subscript-out-of-range-cant-find-open-workbooks-on-another-computer", "title": "Subscript out of range - Can&#39;t find Open Workbooks on Another Computer", "body": "<p>I am a newer user of Excel VBA.  I have been checking through all the other questions on here to try to solve my problem.  I created a Master workbook, which copies info from 3 template spreadsheets when I run the macro.  On my computer, it works correctly.  However, when we tried to run it on a coworker's computer with the exact same 4 workbooks open, we ran into the \"Subscript out of range\" error.  </p>\n\n<p>I used the below code from this post (<a href=\"https://stackoverflow.com/questions/16540071/out-of-range-error-for-windows-activate\">Out of range error for Windows().Activate</a>) to check the names of all the open workbooks.  Only 1 of the 4 (Master.xlsm) open workbooks displayed when I ran the code on my coworker's computer.  On my computer, it displays 4 out of 4 open workbooks when I run that code</p>\n\n<pre><code>dim oBook as workbook\n\nfor each obook in workbooks\n    debug.print \"&gt;\" &amp; obook.name &amp; \"&lt;\"\nnext\n</code></pre>\n\n<p>Below are the first lines in my code.  It breaks on the first line because it can't find the template workbook even though we have it open.  When we run the above code on my coworker's computer during debugging, the Template1.xlsx workbook is not listed.  I am not sure what is going wrong, and would really appreciate any help on this.</p>\n\n<pre><code>Sub Copy_To_Master()\n\nWorkbooks(\"Template1.xlsx\").Worksheets(\"1\").Range(\"A65:E104\").Copy\nWorkbooks(\"Master.xlsm\").Worksheets(\"1\").Range(\"A65:E104\").PasteSpecial Paste:=xlPasteValues\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 6, "creation_date": 1576010828, "post_id": 59275075, "comment_id": 104757260, "body": "<code>For Each cell In Worksheets.UsedRange</code>"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 3, "creation_date": 1576011130, "post_id": 59275075, "comment_id": 104757387, "body": "Since you looping through each worksheet, using the variable <code>ws</code>, you should be using <code>For Each cell in ws.UsedRange</code>"}, {"owner": {"reputation": 371, "user_id": 3654325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd52c1ed316019e2384605e1814a8f5?s=128&d=identicon&r=PG&f=1", "display_name": "Stax", "link": "https://stackoverflow.com/users/3654325/stax"}, "edited": false, "score": 0, "creation_date": 1576011535, "post_id": 59275075, "comment_id": 104757557, "body": "Also, stopping automatic recalculation can speed things up a bit. Add this to the start of your code:  <code>Dim SaveCalcState  SaveCalcState = Application.Calculation  Application.Calculation = XlManual</code>  And this to the end:  <code>Application.Calculation = SaveCalcState</code>"}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "edited": false, "score": 0, "creation_date": 1576011634, "post_id": 59275075, "comment_id": 104757599, "body": "You can&#39;t iterate through cells with an <code>ActiveSheet</code> ,  which is why you are likely getting the error <code>Object doesn&#39;t support this property or method</code>  Basically, when you tell VBA to iterate through <code>ActiveSheet</code> it doesn&#39;t automatically know that you are talking about cells.  That is why you have to change the object to a <code>UsedRange</code> which is a <code>range</code> type.  Then VBA knows you want to iterate through cells.  <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.usedrange\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/&hellip;</a>"}, {"owner": {"reputation": 371, "user_id": 3654325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd52c1ed316019e2384605e1814a8f5?s=128&d=identicon&r=PG&f=1", "display_name": "Stax", "link": "https://stackoverflow.com/users/3654325/stax"}, "edited": false, "score": 0, "creation_date": 1576011967, "post_id": 59275075, "comment_id": 104757729, "body": "There are over 17 Billion cells in a worksheet. You absolutely don&#39;t want to process them all. That&#39;s what UsedRange avoids. :-)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1576012134, "post_id": 59275075, "comment_id": 104757788, "body": "&quot;This code either takes too long or crashes my computer so I cannot tell if it actually works&quot;. That code, if it works, needs to loop through every cell in every worksheet. And this is 16384 columns * 1048576 rows per worksheet. Quite a lot of electricity waste..."}, {"owner": {"reputation": 351, "user_id": 10010969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b5dd287f0cd88d80147cb8a39d19429?s=128&d=identicon&r=PG&f=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/10010969/julian"}, "edited": false, "score": 0, "creation_date": 1576027473, "post_id": 59275075, "comment_id": 104762207, "body": "So apparently <code>UsedRange</code> did not work. I still have white cells. The reason I want to do this is because I inherited a financial model with a few white cells filled in rows for all columns, making the spreadsheet ridiculously large. What constitutes a <code>used cell</code>?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576031677, "post_id": 59275075, "comment_id": 104762976, "body": "Untested, but maybe you could use the <a href=\"https://support.office.com/en-us/article/what-you-can-do-with-spreadsheet-inquire-ebaf3d62-2af5-4cb1-af7d-e958cc5fad42\" rel=\"nofollow noreferrer\">Inquire Add-In</a>? Not sure if it would remove this formatting or not, but maybe worth a shot. Inquire is pre-installed since Excel 2013."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1576047487, "post_id": 59275075, "comment_id": 104767107, "body": "Use Find and Replace, simply initiate a FindFormat and ReplaceFormat. This removes the need for any cell iteration"}], "answers": [{"tags": [], "owner": {"reputation": 114, "user_id": 11106493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/467b2ed419ae538a9068c066d83b01f7?s=128&d=identicon&r=PG&f=1", "display_name": "Nuri", "link": "https://stackoverflow.com/users/11106493/nuri"}, "is_accepted": false, "score": 0, "last_activity_date": 1576011949, "last_edit_date": 1576011949, "creation_date": 1576011618, "answer_id": 59275280, "question_id": 59275075, "link": "https://stackoverflow.com/questions/59275075/loop-through-all-cells-with-white-fill-and-change-them-to-no-fill/59275280#59275280", "title": "Loop through all cells with white fill and change them to no fill", "body": "<p>First of all, code that loops through every cell in every worksheet is extremely inefficient. For this reason I would use <code>.UsedRange</code> to limit it to the used cells.</p>\n\n<p>The result is the following:</p>\n\n<pre><code>Sub Remove_White_Cells()\n\nApplication.ScreenUpdating = False\n\nDim cell As Range\nDim wb As Workbook\nDim ws As Worksheet\n\nFor Each ws In ActiveWorkbook.Worksheets 'Worksheet iterator\n    For Each cell In ws.UsedRange.Cells 'Select only used cells\n        If cell.Interior.Color = RGB(0, 0, 0) Then\n            cell.Interior.Color = xlNone\n        End If\n    Next cell\nNext ws\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 351, "user_id": 10010969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b5dd287f0cd88d80147cb8a39d19429?s=128&d=identicon&r=PG&f=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/10010969/julian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576025139, "creation_date": 1576010694, "last_edit_date": 1576025139, "question_id": 59275075, "link": "https://stackoverflow.com/questions/59275075/loop-through-all-cells-with-white-fill-and-change-them-to-no-fill", "title": "Loop through all cells with white fill and change them to no fill", "body": "<p>I have a huge spreadsheet. I want to loop through all cells and change the white fill to no fill. This code either takes too long or crashes my computer so I cannot tell if it actually works. Does anyone see anything wrong with it?</p>\n\n<pre><code>Sub Remove_White_Cells()\n\n    Application.ScreenUpdating = False\n\n    Dim cell As Range\n    Dim wb As Workbook\n    Dim ws As Worksheet\n\n    For Each ws In ActiveWorkbook\n        For Each cell In Worksheets\n            If cell.Interior.Color = RGB(0, 0, 0) Then\n                cell.Interior.Color = xlNone\n            End If\n        Next cell\n    Next ws\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1576014034, "last_edit_date": 1576014034, "creation_date": 1576010262, "answer_id": 59274994, "question_id": 59274616, "link": "https://stackoverflow.com/questions/59274616/custom-chart-point-datalabel-position/59274994#59274994", "title": "Custom Chart point DataLabel Position", "body": "<p>Here's a basic example I figured out using the macro recorder:</p>\n\n<pre><code>Sub AddDataLabel()\n\n    Dim dl As DataLabel, cht As Chart, pt As Point\n\n    Set cht = ActiveSheet.ChartObjects(1).Chart\n\n    Set pt = cht.SeriesCollection(1).Points(6)\n\n    pt.ApplyDataLabels\n\n    Set dl = pt.DataLabel\n\n    With dl\n        .Text = \"hello\"\n        .Font.Color = vbRed\n        'move label relative to data point\n        .Top = pt.Top - 15\n        .Left = pt.Left + 15\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/M7iN8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/M7iN8.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 11, "user_id": 12044064, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156093684942257/picture?type=large", "display_name": "Manuel Facio", "link": "https://stackoverflow.com/users/12044064/manuel-facio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1178, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1576025219, "creation_date": 1576008483, "last_edit_date": 1576025219, "question_id": 59274616, "link": "https://stackoverflow.com/questions/59274616/custom-chart-point-datalabel-position", "title": "Custom Chart point DataLabel Position", "body": "<p>I'm trying to set a DataLabel of a chart point in VBA, and cant find the way to do it.\nIn the last part of this code I set up the properties of the chart's point, but I don't know how to set up a custom position, I attach a picture of the result I'm trying to have:</p>\n\n<pre><code>objCht.Chart.SetSourceData Source:=ResBook.Sheets(Right(NombreHoja, 2)).Range(\"P1:R\" &amp; UltFilaGrafico)\nobjCht.Activate\nCall AgregarEjeSecundario(\"Velocidad [km/h]\", 3)\n\nActiveChart.Axes(xlValue, xlSecondary).Select\nActiveChart.Axes(xlValue, xlSecondary).MaximumScale = CInt(TargetVelocity) + 10\nActiveChart.Axes(xlValue, xlSecondary).MinimumScale = 0\nActiveChart.Legend.Position = xlLegendPositionBottom\n\n\n'ActiveChart.SeriesCollection(2).Points(50).MarkerStyle = xlDiamond\nWith ActiveChart.SeriesCollection(1)\n    '.Points(StopEventRow).MarkerStyle = xlDiamond\n    .Points(StopEventRow).MarkerStyle = xlMarkerStyleTriangle\n    '.Points(StopEventRow).MarkerSize = 10\n    .Points(StopEventRow).MarkerBackgroundColor = RGB(255, 0, 0)    'Rojo\n    .Points(StopEventRow).MarkerForegroundColor = RGB(1, 1, 1)\n\n    .Points(StopEventRow).HasDataLabel = True\n    .Points(StopEventRow).DataLabel.text = \"Detenci\u00f3n\"\n    '.Points(StopEventRow).ApplyDataLabels Type:=xlValue\n    .Points(StopEventRow).DataLabel.Font.ColorIndex = 3\n    '.Points(StopEventRow).DataLabel.Position = xlLabelPositionCustom\n    '.Points(StopEventRow).ApplyDataLabels Type:=xlShowLabel\n\nEnd With\n\n</code></pre>\n\n<p>This is what I'm trying to accomplish through the VBA code.</p>\n\n<p>Here I manually set up the position of the label, I\u00b4m trying to get this done by the code</p>\n\n<p><a href=\"https://i.stack.imgur.com/JL0aw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JL0aw.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 12513810, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBTHRliqZ0jTWAwKWrMC9j60t96zYQwsv_QVGSj=k-s128", "display_name": "user12513810", "link": "https://stackoverflow.com/users/12513810/user12513810"}, "edited": false, "score": 0, "creation_date": 1576012561, "post_id": 59274521, "comment_id": 104757946, "body": "cant seem to make it work, can you help a brother out please?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 13, "user_id": 12513810, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBTHRliqZ0jTWAwKWrMC9j60t96zYQwsv_QVGSj=k-s128", "display_name": "user12513810", "link": "https://stackoverflow.com/users/12513810/user12513810"}, "edited": false, "score": 0, "creation_date": 1576013127, "post_id": 59274521, "comment_id": 104758149, "body": "@user12513810 - if both the events work independently, then use their code by copy and paste and replace it in the <code>FirstCode()</code> and the <code>SecondCode()</code> - <a href=\"https://gist.github.com/Vitosh/2b0ccd300db89fcda80938d0057fa502\" rel=\"nofollow noreferrer\">gist.github.com/Vitosh/2b0ccd300db89fcda80938d0057fa502</a> If they do not work independently, but there is another error, then you need to ask another question, explaining what does not work. Have fun. It could be that the <code>FirstCode()</code> should be <code>SecondCode()</code> or vice versa, based on business logic."}, {"owner": {"reputation": 13, "user_id": 12513810, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBTHRliqZ0jTWAwKWrMC9j60t96zYQwsv_QVGSj=k-s128", "display_name": "user12513810", "link": "https://stackoverflow.com/users/12513810/user12513810"}, "edited": false, "score": 0, "creation_date": 1576042885, "post_id": 59274521, "comment_id": 104765551, "body": "Thank you for your answer Vityata. Well, the code dont have any errors but..the date changes only if i modify the cell manually:( i tried switch calling codes but didnt work. What i wanted to do is when i scan a barcode and matches in column A then write in column c &quot;1&quot; and in another column the date."}, {"owner": {"reputation": 13, "user_id": 12513810, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBTHRliqZ0jTWAwKWrMC9j60t96zYQwsv_QVGSj=k-s128", "display_name": "user12513810", "link": "https://stackoverflow.com/users/12513810/user12513810"}, "edited": false, "score": 0, "creation_date": 1576048544, "post_id": 59274521, "comment_id": 104767457, "body": "I can support you with some $, i know is best to learn by myself to do it but unfortunately i have to implement this Asap.."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 13, "user_id": 12513810, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBTHRliqZ0jTWAwKWrMC9j60t96zYQwsv_QVGSj=k-s128", "display_name": "user12513810", "link": "https://stackoverflow.com/users/12513810/user12513810"}, "edited": false, "score": 0, "creation_date": 1576067982, "post_id": 59274521, "comment_id": 104777280, "body": "@user12513810 - &quot;the date changes only if i modify the cell manually:( i tried switch calling codes but didnt work.&quot; - What date? This looks like something new. Advice - take 1 screenshot of the excel data (change it, before putting it online) and explain what are you trying to achieve in a new question."}, {"owner": {"reputation": 13, "user_id": 12513810, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBTHRliqZ0jTWAwKWrMC9j60t96zYQwsv_QVGSj=k-s128", "display_name": "user12513810", "link": "https://stackoverflow.com/users/12513810/user12513810"}, "edited": false, "score": 0, "creation_date": 1576076487, "post_id": 59274521, "comment_id": 104782153, "body": "I&#39;m sorry, my mystake. So, this is my worksheet <a href=\"https://ibb.co/LZM1b3Z\" rel=\"nofollow noreferrer\">ibb.co/LZM1b3Z</a> First code, example, cell a2 is &quot;123&quot; when i type somewhere in the sheet(example K2) &quot;123&quot; then thext &quot;123&quot; matches to A2 and it adds &quot;1&quot; to the qty column in this case C2."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 13, "user_id": 12513810, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBTHRliqZ0jTWAwKWrMC9j60t96zYQwsv_QVGSj=k-s128", "display_name": "user12513810", "link": "https://stackoverflow.com/users/12513810/user12513810"}, "edited": false, "score": 0, "creation_date": 1576076648, "post_id": 59274521, "comment_id": 104782233, "body": "@user12513810 - if you put the screenshot in a new question and explain everything you have tried so far, I guess there would be a quick and nice answer. I am afk now, sry."}, {"owner": {"reputation": 13, "user_id": 12513810, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBTHRliqZ0jTWAwKWrMC9j60t96zYQwsv_QVGSj=k-s128", "display_name": "user12513810", "link": "https://stackoverflow.com/users/12513810/user12513810"}, "edited": false, "score": 0, "creation_date": 1576077189, "post_id": 59274521, "comment_id": 104782541, "body": "Sorry, i wanted to write full post but i was busy and i couldnt edit after 5 minutes. I&#39;m sorry, my mystake. So, this is my worksheet <a href=\"https://ibb.co/LZM1b3Z\" rel=\"nofollow noreferrer\">ibb.co/LZM1b3Z</a> First code, example, cell a2 is &quot;123&quot; when i type somewhere in the sheet(example K2) &quot;123&quot; then thext &quot;123&quot; matches to A2 and it adds &quot;1&quot; to the qty column in this case C2. Code 2: what i wanted it to do: when in Qty Column(C2) some cell is filled with &quot;1&quot; then in Date Column(F) to show the date when Qty row was filled with &quot;1&quot; As i said second code only works if i type manually &quot;1&quot; and not by searching the barcode with the first code."}, {"owner": {"reputation": 13, "user_id": 12513810, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBTHRliqZ0jTWAwKWrMC9j60t96zYQwsv_QVGSj=k-s128", "display_name": "user12513810", "link": "https://stackoverflow.com/users/12513810/user12513810"}, "edited": false, "score": 0, "creation_date": 1579427415, "post_id": 59274521, "comment_id": 105757133, "body": "You can close the question, it&#39;s solved, thank you!"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 13, "user_id": 12513810, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBTHRliqZ0jTWAwKWrMC9j60t96zYQwsv_QVGSj=k-s128", "display_name": "user12513810", "link": "https://stackoverflow.com/users/12513810/user12513810"}, "edited": false, "score": 0, "creation_date": 1579525898, "post_id": 59274521, "comment_id": 105784926, "body": "@user12513810 - <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 3, "last_activity_date": 1576008042, "creation_date": 1576008042, "answer_id": 59274521, "question_id": 59274383, "link": "https://stackoverflow.com/questions/59274383/combine-two-vba-codes-into-one/59274521#59274521", "title": "Combine two vba codes into one", "body": "<p>There are plenty of ways to combine two codes. Probably the best way is to rewrite everything, but it could be that there is no need or no time or no skills for that. Take a look here for some example - <a href=\"https://stackoverflow.com/questions/45370502/how-to-combine-two-vba-codes\">How to combine two vba codes?</a>.</p>\n\n<p>The laziest method, I can think of is simply mimicing the <code>Worksheet_Change()</code> events, passing the target to another private sub:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal target As Range)\n\n    FirstCode target\n    SecondCode target\n\nEnd Sub\n\nPrivate Sub FirstCode(ByVal target As Range)\n    Debug.Print target.Address &amp; \" from FirstCode()\"\nEnd Sub\n\nPrivate Sub SecondCode(ByVal target As Range)\n    Debug.Print target.Address &amp; \" from SecondCode()\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12513810, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBTHRliqZ0jTWAwKWrMC9j60t96zYQwsv_QVGSj=k-s128", "display_name": "user12513810", "link": "https://stackoverflow.com/users/12513810/user12513810"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1576025183, "creation_date": 1576007418, "last_edit_date": 1576025183, "question_id": 59274383, "link": "https://stackoverflow.com/questions/59274383/combine-two-vba-codes-into-one", "title": "Combine two vba codes into one", "body": "<p>i'm new to vba and excel also,i created a database in excel and these two codes are essential for my project to work.. i want to run these vba codes in the same time, can you help me merge the code and make it work, please? i tried by myself but nothing worked.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n\nDim Item As String\nDim SearchRange As Range\nDim rFound As Range\n\n'Don't run the macro if:\n'Target is not a single cell:\nIf Target.Cells.Count &gt; 1 Then Exit Sub\n'or Target belongs to the A1.CurrentRegion:\nIf Not Intersect(Target, Range(\"A1\").CurrentRegion) Is Nothing Then Exit Sub\n\n'Avoid the endless loop:\nApplication.EnableEvents = False\n\n'Looks for matches from the here first:\nSet SearchRange = Range(\"A1:A\" &amp; Range(\"A1\").CurrentRegion.Rows.Count)\n\nItem = Target.Value\n\n'Clears the Target:\nTarget.Value = \"\"\n\nIf Application.WorksheetFunction.CountIf(SearchRange, Item) &gt; 0 Then\n'There's a match already:\n    Set rFound = Columns(1).Find(What:=Item, After:=Cells(1, 1) _\n            , LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByRows _\n            , SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)\n'Adds one to the Quantity:\n        rFound.Offset(0, 2).Value = rFound.Offset(0, 2).Value + 1\n\nElse\n\n'Writes the value for the Barcode-list:\nRange(\"A\" &amp; SearchRange.Rows.Count + 1).Value = Item\n\n'Looks for the match from sheet \"Inventory\" column A\n    With Sheets(\"Inventory\")\n        Set rFound = .Columns(1).Find(What:=Item, After:=.Cells(1, 1) _\n                , LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByRows _\n                , SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)\n\n        On Error GoTo 0\n\n            If Not rFound Is Nothing Then\n'Writes the Product Name and puts 1 to the Quantity column:\n                Range(\"B\" &amp; SearchRange.Rows.Count + 1).Value = rFound.Offset(0, 1).Value\n                Range(\"C\" &amp; SearchRange.Rows.Count + 1).Value = 1\n            End If\n    End With\nEnd If\n\n'Enable the Events again:\nApplication.EnableEvents = True\n\n\n\nEnd Sub\n</code></pre>\n\n<p>and the second one:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Column &lt;&gt; 3 Then Exit Sub\nIf Target.Cells.Count &gt; 1 Then Exit Sub\nWith Target.Offset(0, 3)\n.Value = Now\n.NumberFormat = \"DD/MM/YYYY\"\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 2, "creation_date": 1576007171, "post_id": 59274262, "comment_id": 104755754, "body": "<code>.To = Cells(i, 1).Value</code> should be <code>.To = Cells(i, 10).Value</code>"}, {"owner": {"reputation": 19, "user_id": 8053903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40f4a2714e9cde440c94ea18655cb321?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Pakulski", "link": "https://stackoverflow.com/users/8053903/sean-pakulski"}, "reply_to_user": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1576007508, "post_id": 59274262, "comment_id": 104755888, "body": "I&#39;ve made this change without success as well. Now the code does not create any emails."}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1576007676, "post_id": 59274262, "comment_id": 104755966, "body": "Are there email addresses in Column J? the only thing that line would change is where it is getting the recipients from."}, {"owner": {"reputation": 19, "user_id": 8053903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40f4a2714e9cde440c94ea18655cb321?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Pakulski", "link": "https://stackoverflow.com/users/8053903/sean-pakulski"}, "reply_to_user": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1576008313, "post_id": 59274262, "comment_id": 104756230, "body": "There are. For testing purposes they all are my email address but the cells are populate from J2:J5"}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1576008631, "post_id": 59274262, "comment_id": 104756351, "body": "What is the active workbook and active sheet? <code>lastrow</code> has explicit references but <code>.to</code> does not. It is possible that it&#39;s looking at the wrong sheet/book."}, {"owner": {"reputation": 19, "user_id": 8053903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40f4a2714e9cde440c94ea18655cb321?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Pakulski", "link": "https://stackoverflow.com/users/8053903/sean-pakulski"}, "reply_to_user": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1576008772, "post_id": 59274262, "comment_id": 104756412, "body": "The only workbook I have open is the one I am working in, and I have open the &quot;Email&quot; worksheet."}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 1, "creation_date": 1576009090, "post_id": 59274262, "comment_id": 104756550, "body": "I&#39;d make the reference explicit either way. Might solve the issue, if not then step through and see where in the code it&#39;s getting lost."}, {"owner": {"reputation": 19, "user_id": 8053903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40f4a2714e9cde440c94ea18655cb321?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Pakulski", "link": "https://stackoverflow.com/users/8053903/sean-pakulski"}, "reply_to_user": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 1, "creation_date": 1576010182, "post_id": 59274262, "comment_id": 104757006, "body": "Adding the explicit reference worked. Thank you for the assistance, I never would have thought of that."}], "answers": [{"tags": [], "owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1576007446, "creation_date": 1576007446, "answer_id": 59274389, "question_id": 59274262, "link": "https://stackoverflow.com/questions/59274262/change-reference-column-in-email/59274389#59274389", "title": "Change Reference Column in Email", "body": "<p>Use the code below:</p>\n\n<pre><code>Sub EmailItems()\n\n'Creates emails, attaches items, and choice to send automatically or have them pop up for your \nreview. Delete the \"'\" in front of .Send in order to send automatically\n\nDim MailDest As String\nDim subj As String\nDim att As Variant\nDim OutLookApp As Object\nDim OutLookMailItem As Object\nDim lastRow As Long\n\nlastRow = ThisWorkbook.Worksheets(\"Email\").Cells(Rows.Count, \"J\").End(xlUp).Row \n\nFor i = 2 To lastRow\n\n    Set OutLookApp = CreateObject(\"Outlook.application\")\n    Set OutLookMailItem = OutLookApp.CreateItem(0)\n    Set Attach = OutLookMailItem.Attachments\n\n    With OutLookMailItem\n        .SentOnBehalfOfName = [O6]\n        .To = Cells(i, 10).Value\n        .Subject = [O5]\n        .Body = [O7] &amp; vbNewLine &amp; vbNewLine &amp; [O9] &amp; vbNewLine &amp; vbNewLine &amp; [O11] &amp; vbNewLine &amp; \n             vbNewLine &amp; [O13] &amp; vbNewLine &amp; [O14] &amp; vbNewLine &amp; [O15] &amp; vbNewLine &amp; [O16]\n        On Error Resume Next\n            For Each att In Split(Cells(i, 2).Value, \",\")\n            Attach.Add [O2] &amp; att &amp; [O3]\n        Next\n        .Display\n        On Error GoTo 0\n        '.Send\n    End With\n\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8053903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40f4a2714e9cde440c94ea18655cb321?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Pakulski", "link": "https://stackoverflow.com/users/8053903/sean-pakulski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 13, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576007446, "creation_date": 1576006848, "last_edit_date": 1576007294, "question_id": 59274262, "link": "https://stackoverflow.com/questions/59274262/change-reference-column-in-email", "title": "Change Reference Column in Email", "body": "<p>I am attempting to adapt the code to use column \"J\" as the reference column but with little success. I am not sure what I am missing to have the code use column \"J\" instead of column \"A\". Everything works as expected, the code just still references column \"A\" to get the email address to send to.</p>\n\n<pre><code>Sub EmailItems()\n\n'Creates emails, attaches items, and choice to send automatically or have them pop up for your \nreview. Delete the \"'\" in front of .Send in order to send automatically\n\nDim MailDest As String\nDim subj As String\nDim att As Variant\nDim OutLookApp As Object\nDim OutLookMailItem As Object\nDim lastRow As Long\n\nlastRow = ThisWorkbook.Worksheets(\"Email\").Cells(Rows.Count, \"J\").End(xlUp).Row \n\nFor i = 2 To lastRow\n\n    Set OutLookApp = CreateObject(\"Outlook.application\")\n    Set OutLookMailItem = OutLookApp.CreateItem(0)\n    Set Attach = OutLookMailItem.Attachments\n\n    With OutLookMailItem\n        .SentOnBehalfOfName = [O6]\n        .To = Cells(i, 1).Value\n        .Subject = [O5]\n        .Body = [O7] &amp; vbNewLine &amp; vbNewLine &amp; [O9] &amp; vbNewLine &amp; vbNewLine &amp; [O11] &amp; vbNewLine &amp; \n             vbNewLine &amp; [O13] &amp; vbNewLine &amp; [O14] &amp; vbNewLine &amp; [O15] &amp; vbNewLine &amp; [O16]\n        On Error Resume Next\n            For Each att In Split(Cells(i, 2).Value, \",\")\n            Attach.Add [O2] &amp; att &amp; [O3]\n        Next\n        .Display\n        On Error GoTo 0\n        '.Send\n    End With\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 15, "user_id": 4642781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ad4e8984384f25e06630a3d86372fa?s=128&d=identicon&r=PG&f=1", "display_name": "AirWreck", "link": "https://stackoverflow.com/users/4642781/airwreck"}, "is_accepted": false, "score": 0, "last_activity_date": 1577895767, "creation_date": 1577895767, "answer_id": 59554120, "question_id": 59274201, "link": "https://stackoverflow.com/questions/59274201/excel-document-to-create-outlook-tasks/59554120#59554120", "title": "Excel document to create outlook tasks", "body": "<p>open the VBA editor, and paste that code into a module or ThisWorkBook</p>\n\n<p>add a reference to the Microsoft Outlook Object Library (Tools, References...). This is required for Excel to interact with Outlook (create mail and appointment items, etc.)</p>\n\n<p>add a button to run the procedure (I am assuming you have the Developer tab shown on the ribbon. Click that, Insert, select a form controls button, place it on the worksheet. Right-click and click Assign Macro. Choose your macro from the list. Click Ok. </p>\n\n<p>Then, clicking the button will run the procedure. </p>\n\n<p>It worked for me, but only after commenting out the lines referring to ranges on the spreadsheet (which I did not have). Also, for the appointment properties (start, end, body, etc.) I gave them some made-up dates and info just to make it happy. </p>\n"}], "owner": {"reputation": 1, "user_id": 12513750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac77063d345ba686539feecfdd66136f?s=128&d=identicon&r=PG&f=1", "display_name": "Cindy", "link": "https://stackoverflow.com/users/12513750/cindy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 354, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577895767, "creation_date": 1576006526, "last_edit_date": 1576006581, "question_id": 59274201, "link": "https://stackoverflow.com/questions/59274201/excel-document-to-create-outlook-tasks", "title": "Excel document to create outlook tasks", "body": "<p>I am not familiar with VBA at all. Someone at work created an excel document that has a button to push information to outlook reminders. I would love to convert it to push it to outlook tasks or create a whole new file but do not know what needs to be done. Is anyone able to help? </p>\n\n<p>I beleive this is the current code that is being used.</p>\n\n<pre><code>Sub Button1_Click()\n\n   Sheets(\"Sheet1\").Select\n    On Error GoTo Err_Execute\n\n    Dim olApp As Outlook.Application\n    Dim olAppt As Outlook.AppointmentItem\n    Dim blnCreated As Boolean\n    Dim olNs As Outlook.Namespace\n    Dim CalFolder As Outlook.MAPIFolder\n\n    Dim i As Long\n\n    On Error Resume Next\n    Set olApp = Outlook.Application\n\n    If olApp Is Nothing Then\n        Set olApp = Outlook.Application\n         blnCreated = True\n        Err.Clear\n    Else\n        blnCreated = False\n    End If\n\n    On Error GoTo 0\n\n    Set olNs = olApp.GetNamespace(\"MAPI\")\n    Set CalFolder = olNs.GetDefaultFolder(olFolderCalendar)\n\n    i = 12\n    Do Until Trim(Cells(i, 1).Value) = \"\"\n\n    Set olAppt = CalFolder.Items.Add(olAppointmentItem)\n\n    With olAppt\n\n        .Start = Cells(i, 5) + Cells(i, 6)\n        .End = Cells(i, 5) + (Cells(i, 6) + TimeSerial(0, 30, 0))\n        .Subject = Cells(i, 1)\n        .Location = Cells(i, 2)\n        .Body = Cells(i, 3)\n        .BusyStatus = olBusy\n        .ReminderSet = False\n        .Save\n\n    End With\n\n        i = i + 1\n        Loop\n    Set olAppt = Nothing\n    Set olApp = Nothing\n\n    MsgBox \"The items have been exported to your Outlook Calendar\"\n\n    Exit Sub\n\nErr_Execute:\n    MsgBox \"An error occurred while exporting to your Outlook Calendar\"\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/l5jbg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/l5jbg.png\" alt=\"outlook spreadsheet\"></a></p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1576006703, "post_id": 59274116, "comment_id": 104755582, "body": "I don&#39;t think you need to change data types. Hyperlink fields have a value that returns a string wrapped in <code>#</code>. Just modify the string and then stick it back in, make sure you keep the <code>#</code> or it won&#39;t work as a hyperlink."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1576010367, "post_id": 59274116, "comment_id": 104757089, "body": "Actually quite simple. Can use Find/Replace dialog on Hyperlink type field or an UPDATE action SQL using Replace function."}, {"owner": {"reputation": 25, "user_id": 4294103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39eabd9c4b10aa0dd80c89bb1eb2de42?s=128&d=identicon&r=PG&f=1", "display_name": "Keller Waldron", "link": "https://stackoverflow.com/users/4294103/keller-waldron"}, "edited": false, "score": 0, "creation_date": 1576012300, "post_id": 59274116, "comment_id": 104757843, "body": "June7, Could you expand. since the hyperlink is masked by the display text, when i do a find and replace, access cannot find the underlying hyperlink that i want to change. this is why i think that i need to change the field format suck that it is mask#link##, edit the link, change it back to hyperlink format"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1576015744, "post_id": 59274116, "comment_id": 104759097, "body": "Sorry, I don&#39;t use Hyperlink field and forgot to test with DisplayText component. Yes, Find/Replace dialog fails but UPDATE works."}], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": true, "score": 1, "last_activity_date": 1576018355, "last_edit_date": 1576018355, "creation_date": 1576018050, "answer_id": 59276469, "question_id": 59274116, "link": "https://stackoverflow.com/questions/59274116/how-can-i-change-access-hyperlinks-with-vba/59276469#59276469", "title": "How can I change Access hyperlinks with VBA?", "body": "<p>Table Find/Replace dialog will work on Hyperlink field if there is no DisplayText component in hyperlink string.</p>\n\n<p>In either case, an SQL UPDATE action will work, like:</p>\n\n<p><code>CurrentDb.Execute \"UPDATE table SET field = Replace([field], 'P:\\Library\\', 'I:\\')\"</code></p>\n\n<p>It is possible to have hyperlink functionality on form and report in ReportView without Hyperlink type field. Of course this will require alternate method than hyperlink field interface to enter file path into text field - probably with VBA executing File System Object dialog. Hyperlink click will not be possible in table but since users should not interact with tables and queries, just forms and reports, this should not be an issue.</p>\n"}], "owner": {"reputation": 25, "user_id": 4294103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39eabd9c4b10aa0dd80c89bb1eb2de42?s=128&d=identicon&r=PG&f=1", "display_name": "Keller Waldron", "link": "https://stackoverflow.com/users/4294103/keller-waldron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 849, "favorite_count": 0, "accepted_answer_id": 59276469, "answer_count": 1, "score": 1, "last_activity_date": 1583768398, "creation_date": 1576006074, "last_edit_date": 1583768398, "question_id": 59274116, "link": "https://stackoverflow.com/questions/59274116/how-can-i-change-access-hyperlinks-with-vba", "title": "How can I change Access hyperlinks with VBA?", "body": "<p>I've done some extensive research and realize this is not an easy task.</p>\n\n<p>I need to change many hyperlinks in different tables from P:\\Library\\Folder... to I:\\Folder...</p>\n\n<p>I think I can change the field type to long text, find and replace, change type back to hyperlink.</p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1576004746, "post_id": 59273718, "comment_id": 104754725, "body": "Can you ask your friend for a screen cap of the error message? It would be very useful to see what the problem is"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1576004747, "post_id": 59273718, "comment_id": 104754726, "body": "What error, on what line?"}, {"owner": {"reputation": 374, "user_id": 7261668, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211502888638056/picture?type=large", "display_name": "Ross Symonds", "link": "https://stackoverflow.com/users/7261668/ross-symonds"}, "edited": false, "score": 0, "creation_date": 1576005083, "post_id": 59273718, "comment_id": 104754897, "body": "My friend said he got the error message - Error 5 Invalid procedure call or argument."}, {"owner": {"reputation": 374, "user_id": 7261668, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211502888638056/picture?type=large", "display_name": "Ross Symonds", "link": "https://stackoverflow.com/users/7261668/ross-symonds"}, "edited": false, "score": 0, "creation_date": 1576005112, "post_id": 59273718, "comment_id": 104754914, "body": "I think it was this line of code that gave him the error message - strFile = Dir(strPath, MacID(&quot;XLSX&quot;))."}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1576005744, "post_id": 59273718, "comment_id": 104755185, "body": "I&#39;m pretty sure <code>&quot;XLSX&quot;</code> isn&#39;t the right string. Based on the docs here: <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/macid-function\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/language/reference/&hellip;</a> It looks to be <code>&quot;XLS#&quot;</code> where the # is a number corresponding to the file type. What that number is though I&#39;m not sure, I&#39;ve never used a mac and in classic fashion the docs are not complete with a list."}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1576005830, "post_id": 59273718, "comment_id": 104755221, "body": "This might be relevant: <a href=\"https://stackoverflow.com/questions/13292376/what-are-macid-filetypes-in-excel-vba\" title=\"what are macid filetypes in excel vba\">stackoverflow.com/questions/13292376/&hellip;</a>"}], "owner": {"reputation": 374, "user_id": 7261668, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211502888638056/picture?type=large", "display_name": "Ross Symonds", "link": "https://stackoverflow.com/users/7261668/ross-symonds"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1581926494, "creation_date": 1576004236, "last_edit_date": 1581926494, "question_id": 59273718, "link": "https://stackoverflow.com/questions/59273718/opening-files-using-excel-and-vba-on-a-mac", "title": "Opening Files Using Excel and VBA (on a Mac)", "body": "<p>After finishing the macro for my client, he informed me that he had a Mac. I have tried to adjust the code for Macs but I do not have a Mac to test it on. My friend with a Mac was trying to help me but he did not have any luck.</p>\n\n<p>I need to find all the file names in the Matters folder and put them in column B.\nI need to find all the file names in the RCTI folder and put them in column D.</p>\n\n<p><a href=\"https://i.stack.imgur.com/fqzxe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fqzxe.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/nZbL8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nZbL8.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/tSz9U.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tSz9U.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/HnINZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HnINZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>I hoped this line of code would do the trick but it hasn't.</p>\n\n<pre><code>strFile = Dir(strPath, MacID(\"XLSX\"))\n</code></pre>\n\n<p>My friend ran the macro and got an error. He couldn't really explain the error to me. </p>\n\n<pre><code>Matters = Range(\"B3\").Text\nstrPath = Matters\nstrFile = Dir(strPath, MacID(\"XLSX\"))\nRow = 7\nDo While strFile &lt;&gt; \"\"\n\n    Range(\"B\" &amp; Row).Value = strFile\n    Row = Row + 1\n    strFile = Dir 'This moves the value of strFile to the next file.\n\nLoop\n\n\nMatters = Range(\"B3\").Text\nstrPath = Matters\nstrFile = Dir(strPath, MacID(\"CSV\"))\n'strFile = Dir(strPath &amp; \"*.csv\")\nDo While strFile &lt;&gt; \"\"\n\n    Range(\"B\" &amp; Row).Value = strFile\n    Row = Row + 1\n    strFile = Dir 'This moves the value of strFile to the next file.\n\nLoop\n\n\nRCTI = Range(\"B4\").Text\nstrPath = RCTI\nstrFile = Dir(strPath, MacID(\"XLSX\"))\nRow = 7\nDo While strFile &lt;&gt; \"\"\n\n    Range(\"D\" &amp; Row).Value = strFile\n    Row = Row + 1\n    strFile = Dir 'This moves the value of strFile to the next file.\n\nLoop\n\n\nRCTI = Range(\"B4\").Text\nstrPath = RCTI\nstrFile = Dir(strPath, MacID(\"CSV\"))\nDo While strFile &lt;&gt; \"\"\n\n    Range(\"D\" &amp; Row).Value = strFile\n    Row = Row + 1\n    strFile = Dir 'This moves the value of strFile to the next file.\n\nLoop\n</code></pre>\n\n<hr>\n"}, {"tags": ["excel", "vba", "internet-explorer", "automation"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1576005092, "post_id": 59273161, "comment_id": 104754903, "body": "1) I think we need a clearer idea of what you are trying to achieve 2) why do you need to do this in different tabs? 3) Get rid of those On Error Resume Next lines and then see what info you get back that might illuminate why in some cases querySelector is not leading to values being inserted."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1576005517, "post_id": 59273161, "comment_id": 104755097, "body": "&quot;X isn&#39;t working well on IE...&quot; ...sounds about right. :P"}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1576029179, "post_id": 59273161, "comment_id": 104762510, "body": "I agree with the suggestion given by QHarr. Is is necessary for you to open multiple tabs? If not, you can try to open different web pages in the same tab after finishing the processing for specific web page. By this way, you will not face tabs related issue."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1576036039, "post_id": 59273161, "comment_id": 104763923, "body": "4) Replace all those Do Loops with proper page load waits i.e. While ie.Busy Or ie.ReadyState &lt;&gt; 4: DoEvents:Wend. Don&#39;t double up on these lines as either it meets the conditions or it doesn&#39;t.  If it doesn&#39;t then it is likely you need to consider a timed loop rather than a different type of Do Loop/repeating the same loop structure again."}, {"owner": {"reputation": 47, "user_id": 12391978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef612bae163af4155bba8c4a6d1033ff?s=128&d=identicon&r=PG&f=1", "display_name": "Nilton", "link": "https://stackoverflow.com/users/12391978/nilton"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1576070476, "post_id": 59273161, "comment_id": 104778680, "body": "Hi guys. First I <i>REALLY</i> appreciate all your help. I&#39;m so sorry if I express myself in a wrong way in my text. I&#39;ll do my best now! @QHarr - thx, buddy. I did a Pilot in my company with almost 500 people open on windows. Almost everybody asked for the tabs. The purpose of the program is to optmize repetitive processes that we are obliged to do due to regulations. Accord to them, open in tabs increase productivity and organization. And they need to print pdfs of all webpages, open in tabs allow the company to use an app (the only one allowed by the company) that join a lot pdf&#39;s ONLY in tabs"}, {"owner": {"reputation": 47, "user_id": 12391978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef612bae163af4155bba8c4a6d1033ff?s=128&d=identicon&r=PG&f=1", "display_name": "Nilton", "link": "https://stackoverflow.com/users/12391978/nilton"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1576070871, "post_id": 59273161, "comment_id": 104778912, "body": "continue.. @QHarr, sry I asked first your 2nd question. So, about the 1st,  our country requires our company to consult a lot of websites to do our business activity, inserting id&#39;s on them and printing pdf&#39;s. It&#39;s a huge amount of consults (more than 5k per day). So we need to optimize using the resources that we have (limited amount of apps that are allowed here). We have that app (only one allowed) that join pdf&#39;s only if the consults were opened on tabs, not windows. That&#39;s what I&#39;m trying to do."}, {"owner": {"reputation": 47, "user_id": 12391978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef612bae163af4155bba8c4a6d1033ff?s=128&d=identicon&r=PG&f=1", "display_name": "Nilton", "link": "https://stackoverflow.com/users/12391978/nilton"}, "edited": false, "score": 0, "creation_date": 1576070988, "post_id": 59273161, "comment_id": 104778958, "body": "continue... 3) I did this. Once I did, somtimes I got 424 error, sometimes I got nothing, it just didn&#39;t insert the value and there was no error (only with those 2 pages that use querySelector). And that&#39;s tremendously wierd because it works on 70% of the computers here, but I really need to make to work on 100% (all of them have the same version of all apps evolved). 4) Thanks, I&#39;ll do some stress tests today using this suggestion. Thx a lot Deepak and QHarr, I REALLY appreciate your help guys, really really. If you have more ideas to solve those problems, please help me a little more =D"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1576071157, "post_id": 59273161, "comment_id": 104779067, "body": "Could still be a timing issue in both cases. querySelector is an optimized method which may be matching the node when present but data not retained - do you have significantly different connection speeds on these machines? Have you tried used timed loop for element to be present and to change value? Have you also tried setting the value via javascript executed through document.parentWindow.execScript"}, {"owner": {"reputation": 47, "user_id": 12391978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef612bae163af4155bba8c4a6d1033ff?s=128&d=identicon&r=PG&f=1", "display_name": "Nilton", "link": "https://stackoverflow.com/users/12391978/nilton"}, "edited": false, "score": 0, "creation_date": 1576071549, "post_id": 59273161, "comment_id": 104779305, "body": "I have been doiing some stress tests modifying that line &quot;Application.Wait (Now + TimeValue(&quot;0:00:04&quot;))&quot; from 3 to 8 seconds. Failed. Still sometimes works and sometimes doesn&#39;t. &quot;do you have significantly different connection speeds on these machines?&quot; - No. same connection for all. &quot;Have you tried used timed loop for element to be present and to change value?&quot; I didn&#39;t understand what you said, about time loop my only test is that one that I mentioned in the beggining (Deepak taugh me that one)."}, {"owner": {"reputation": 47, "user_id": 12391978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef612bae163af4155bba8c4a6d1033ff?s=128&d=identicon&r=PG&f=1", "display_name": "Nilton", "link": "https://stackoverflow.com/users/12391978/nilton"}, "edited": false, "score": 0, "creation_date": 1576071596, "post_id": 59273161, "comment_id": 104779337, "body": "&quot;Have you also tried setting the value via javascript executed through document.parentWindow.execScript&quot; - I have no idea what is that, sounds like chinese for me, sry, I&#39;m still a noob, but I love to learn if you have some time to teach me =D"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1576071763, "post_id": 59273161, "comment_id": 104779457, "body": "On the machines that are failing - do they work if you execute the code slowly line by line with F8?   Re: other points see <a href=\"https://stackoverflow.com/questions/55396709/how-to-replace-or-update-style-attribute-value-by-using-vba/55396831#55396831\">1</a> and <a href=\"https://stackoverflow.com/a/53894221/6241235\">2</a> and <a href=\"https://stackoverflow.com/search?q=timed+loop+user%3A6241235+is%3Aanswer\">3</a>"}, {"owner": {"reputation": 47, "user_id": 12391978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef612bae163af4155bba8c4a6d1033ff?s=128&d=identicon&r=PG&f=1", "display_name": "Nilton", "link": "https://stackoverflow.com/users/12391978/nilton"}, "edited": false, "score": 0, "creation_date": 1576072445, "post_id": 59273161, "comment_id": 104779875, "body": "No, using the F8 there&#39;s always errors on the queryselector line when I debug, I&#39;ll try to see if the points 1, 2 and 3 works, thanks!"}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1576121229, "post_id": 59273161, "comment_id": 104798517, "body": "Can you please inform us the error you got? For testing purposes, try to access the elements using any other way instead of query selector to see whether it is making any difference."}, {"owner": {"reputation": 47, "user_id": 12391978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef612bae163af4155bba8c4a6d1033ff?s=128&d=identicon&r=PG&f=1", "display_name": "Nilton", "link": "https://stackoverflow.com/users/12391978/nilton"}, "reply_to_user": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1576162596, "post_id": 59273161, "comment_id": 104816786, "body": "Hi guys! Good morning. @Deepak-MSFT - To access those 2 websites and insert the ID&#39;s I need to click in a button before. On the first website the button stays inside an iframe. On the other I couldn&#39;t click the button because I couldn&#39;t find the ID. I tried a lot of solutions, all failed. The only solution that worked was queryselector. If you have any alternatives about how to click those buttons It would help me a lot. Here is the websites &quot;<a href=\"http://smap14.mda.gov.br/extratodap/\" rel=\"nofollow noreferrer\">smap14.mda.gov.br/extratodap</a>&quot; Button &quot;Pessoa F&#237;sica&quot; and &quot;<a href=\"http://www.tst.jus.br/certidao\" rel=\"nofollow noreferrer\">tst.jus.br/certidao</a>&quot; Button &quot;Emitir Certid&#227;o&quot;. Thanks and have a great day!"}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1576487580, "post_id": 59273161, "comment_id": 104901938, "body": "An alternative way for the first link is to loop through the elements and find it using its property like its title or using its innerHTML. In the second link, you can try to access that element using its name. I suggest you to first make this test separately and then try to add it in your original code. Also, try to open these two pages in last when you add it in your original code."}], "owner": {"reputation": 47, "user_id": 12391978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef612bae163af4155bba8c4a6d1033ff?s=128&d=identicon&r=PG&f=1", "display_name": "Nilton", "link": "https://stackoverflow.com/users/12391978/nilton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576003817, "creation_date": 1576001590, "last_edit_date": 1576003817, "question_id": 59273161, "link": "https://stackoverflow.com/questions/59273161/vba-automation-macro-isnt-working-very-well-on-ie-tabs", "title": "VBA Automation (macro) isn&#39;t working very well on IE tabs", "body": "<p>I'm new here and on VBA, it's my 2nd post and I don't speak english very well. So, please, take easy on me =D</p>\n\n<p>Last week I was having some troubles trying to automatize some procedures on IE. My macro worked very well when opened on <strong>new windows</strong>, but when I tried to run the same macro <strong>on tabs</strong> it wasn't working. It seemed (maybe) the macro wasn't recognizing the actual tab. I post that problem here and a wonderfull guy called  Deepak-MSFT helped me a lot. He taught me how to run the macro on tabs and it worked almost 100%.</p>\n\n<p><strong>Problems:</strong></p>\n\n<p><strong>1 -</strong> The macro sometimes work, sometimes doesn't. Yesterday, for example, I was getting errors 424, 91 and, sometimes, it just opened another tab without insert the value (perheaps because of the \"On Error Resume Next\"). I think it was because one of the websites was slow. I tried to increase the TimeValue until 7 seconds but, even so, it didn't work. I tested during the whole day and it was extremely unstable, sometimes worked, and somtimes it doesn't. But today it's working (all the websites are stable). Any idea how to solve this instability?</p>\n\n<p><strong>2 -</strong> There are 2 websites (2nd and 3rd) where I use querySelector to find the box to insert the value. Both of them work on 70% of the PC's of my company and only those 2 websites doesn't work on the other 30%. I installed the same version of IE (11.0.9600), Excel (2007, SP3) and Windows (W7) on all of them, but even so, only those 2 websites with queryselector don't work. There are no errors. The macro just don't insert the value. Perhaps I'm missing something that make queryselector works on those PC's, but all the references match. I dig the first 5 pages on google trying to find a solution but I failed. I think there's a witch flying around those PC's. Could you help me?</p>\n\n<p><strong>3 -</strong>  I have total instability trying to run my macros on Excel 2016 or other versions of Excel higher than 2007 at Windows 10. Does anyone have a good solution to adapt the program to run on Excel 2016 (all my company will run this version next year) without have to do all over again?</p>\n\n<p>Thank you very much guys. Here is my code:</p>\n\n<pre><code>Sub ademo()\n\n    Dim i As Long\n    Dim URL As String\n    Dim IE As Object\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n\n\n    IE.Visible = True\n\n    'TAB 1\n\n    URL = \"https://servicos.ibama.gov.br/ctf/publico/areasembargadas/ConsultaPublicaAreasEmbargadas.php\"\n\n\n    IE.Navigate2 URL\n\n    Do While IE.readyState = 4: DoEvents: Loop   'Do While\n    Do Until IE.readyState = 4: DoEvents: Loop   'Do Until\n\n\n    IE.document.getElementById(\"num_cpf_cnpj\").Value = \"demo1\" 'Sheets(\"Main\").Range(\"C10\")\n    IE.document.getElementById(\"Emitir_Certificado\").Click\n\n\n\n 'TAB 2 - DAP\n\n    On Error Resume Next\n    IE.Visible = True\n    IE.Navigate2 \"http://smap14.mda.gov.br/extratodap/\", 2048&amp;\n\n\n    Application.Wait (Now + TimeValue(\"0:00:04\"))\n\n    Set IE = GetIE(\"http://smap14.mda.gov.br/extratodap/\")\n\n    Do While IE.Busy\n            Application.Wait DateAdd(\"s\", 1, Now)\n        Loop\n\n        Set doc = IE.document\n\n        On Error Resume Next\n        Set Target = IE.document.querySelector(\"#corpo &gt; div &gt; div &gt; div:nth-child(1) &gt; button\")\n        Target.Click\n            Do While IE.Busy\n            Application.Wait DateAdd(\"s\", 1, Now)\n            Loop\n            doc.getElementById(\"txtCPF_CNPJ\").Value = \"demo2\"\n\n\n\n\n    'TAB 3 - CNDT\n\n    IE.Visible = True\n    On Error Resume Next\n    IE.Navigate2 \"http://aplicacao.jt.jus.br/cndtCertidao/inicio.faces\", 2048&amp;\n\n\n    Application.Wait (Now + TimeValue(\"0:00:04\"))\n\n    Set IE = GetIE(\"http://aplicacao.jt.jus.br/cndtCertidao/inicio.faces\")\n\n    Do While IE.Busy\n            Application.Wait DateAdd(\"s\", 1, Now)\n        Loop\n\n        Set doc = IE.document\n\n        On Error Resume Next\n        Set target2 = IE.document.querySelector(\"#corpo &gt; div &gt; div:nth-child(2) &gt; input:nth-child(1)\")\n        target2.Click\n            Do While IE.Busy\n            Application.Wait DateAdd(\"s\", 1, Now)\n            Loop\n            doc.getElementById(\"gerarCertidaoForm:cpfCnpj\").Value = \"demo3\"\n\n\n\n\n\n\n    'TAB 4 - CND\n\n    On Error Resume Next\n    IE.Visible = True\n    IE.Navigate2 \"http://servicos.receita.fazenda.gov.br/Servicos/certidao/CNDConjuntaInter/InformaNICertidao.asp?tipo=2\", 2048&amp;\n\n\n    Application.Wait (Now + TimeValue(\"0:00:04\"))\n\n    Set IE = GetIE(\"http://servicos.receita.fazenda.gov.br/Servicos/certidao/CNDConjuntaInter/InformaNICertidao.asp?tipo=2\")\n\n    Do While IE.Busy\n            Application.Wait DateAdd(\"s\", 1, Now)\n        Loop\n\n        Set doc = IE.document\n\n        On Error Resume Next\n        IE.document.getElementsByName(\"NI\")(0).Value = \"demo4\"\n\n\n\n    'TAB 5 - IMPROBIDADE\n\n    IE.Visible = True\n    IE.Navigate2 \"http://www.cnj.jus.br/improbidade_adm/consultar_requerido.php?validar=form\", 2048&amp;\n\n\n    Application.Wait (Now + TimeValue(\"0:00:04\"))\n\n    Set IE = GetIE(\"http://www.cnj.jus.br/improbidade_adm/consultar_requerido.php?validar=form\")\n\n    IE.document.getElementById(\"num_cpf_cnpj\").Value = \"demo5\"\n\n\n\nEnd Sub\n\n\nFunction GetIE(sLocation As String) As Object\n\n    Dim objShell As Object, objShellWindows As Object, o As Object\n    Dim sURL As String\n    Dim retVal As Object\n\n    Set retVal = Nothing\n    Set objShell = CreateObject(\"Shell.Application\")\n    Set objShellWindows = objShell.Windows\n\n    For Each o In objShellWindows\n        sURL = \"\"\n        On Error Resume Next  'because may not have a \"document\" property\n        'Check the URL and if it's the one you want then\n        ' assign the window object to the return value and exit the loop\n        sURL = o.document.Location\n        On Error GoTo 0\n        If sURL Like sLocation &amp; \"*\" Then\n            Set retVal = o\n            Exit For\n        End If\n    Next o\n\n    Set GetIE = retVal\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 158, "user_id": 12506685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bbdad43fa100913502ce67d1b6b0fd?s=128&d=identicon&r=PG&f=1", "display_name": "the VBE - it&#39;s right for me", "link": "https://stackoverflow.com/users/12506685/the-vbe-its-right-for-me"}, "reply_to_user": {"reputation": 101, "user_id": 10560279, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wQzGnSqEnR8/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCnU-kGzjWDce6CKHogb6TgxMv8iw/mo/photo.jpg?sz=128", "display_name": "Sudio", "link": "https://stackoverflow.com/users/10560279/sudio"}, "edited": false, "score": 0, "creation_date": 1576109153, "post_id": 59274186, "comment_id": 104796152, "body": "@Sudio glad to hear it :)"}], "tags": [], "owner": {"reputation": 158, "user_id": 12506685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bbdad43fa100913502ce67d1b6b0fd?s=128&d=identicon&r=PG&f=1", "display_name": "the VBE - it&#39;s right for me", "link": "https://stackoverflow.com/users/12506685/the-vbe-its-right-for-me"}, "is_accepted": true, "score": 1, "last_activity_date": 1576006486, "creation_date": 1576006486, "answer_id": 59274186, "question_id": 59273080, "link": "https://stackoverflow.com/questions/59273080/inserting-page-breaks-centering-before-pdf-export/59274186#59274186", "title": "Inserting page breaks/centering before PDF export", "body": "<p>You don't need to insert any page breaks directly. Just use the natural ones that Excel displays when print preview is activated and position your charts accordingly in a vertical stack. If you would like to center them in both dimensions on a certain page, get the .<code>Width</code> and <code>.Height</code> and use that calculate the necessary offset for <code>.Left</code> and <code>.Top</code> from the upper left corner cell of each chart's page. The easiest way to make sure things are correct is to set the row/column dimensions equal to that of your print area (paper size - margins) so that each cell corresponds with a \"page\". In a general implementation, it'd be something like:</p>\n\n<pre><code>Dim ws As Worksheet 'loop worksheet\nDim pdf As Worksheet 'whatever sheet is the temporary\nDim shp As Shape 'shape holder\nDim i As Long 'loop counter\nDim xDlt As Single, yDlt As Single 'storage variables for the centering\n\ni = 1 'set counter to starting value\nSet pdf = printerSheet 'assign the temporary sheet; you can skip this if you just want to use the temporary sheet .CodeName\n\nFor Each ws In Worksheets 'loop through sheets as you have\n\n    If (Not ws Is pdf) Then 'make sure you aren't copying the shapes on the temporary sheet; couldnt tell if it was excluded in yours\n\n        For Each shp In ws.Shapes 'loop through shapes as you have; remember that this is based on the only shapes on the sheet being the charts you want to copy\n\n            shp.Copy 'copy the shape\n            pdf.Paste 'paste on the pdf sheet\n            Application.CutCopyMode = False 'good practice to reset this\n\n            Set shp = pdf.Shapes(shp.Name) 'shape retains the same name when copying so you can obtain copied object reference this way; you no longer need the original object so you can use the same holder variable\n            shp.Name = \"pdf\" &amp; i 'rename the shape to something you are sure is unique; this will cover the case where two charts from different sheets have the same name\n\n            xDlt = pdf.Cells(i, 1).Width - shp.Width 'get the dimensional differences\n            yDlt = pdf.Cells(i, 1).Height - shp.Height\n\n            shp.Left = pdf.Cells(i, 1).Left + (xDlt / 2) 'assign the positions accordingly\n            shp.Top = pdf.Cells(i, 1).Top + (yDlt / 2)\n\n            i = i + 1 'iterate\n\n        Next\n\n    End If\n\nNext\n</code></pre>\n\n<p>This is not tested and probably isn't 100% optimal but it should be a good starting point.</p>\n"}], "owner": {"reputation": 101, "user_id": 10560279, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wQzGnSqEnR8/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCnU-kGzjWDce6CKHogb6TgxMv8iw/mo/photo.jpg?sz=128", "display_name": "Sudio", "link": "https://stackoverflow.com/users/10560279/sudio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 59274186, "answer_count": 1, "score": 0, "last_activity_date": 1576006486, "creation_date": 1576001232, "question_id": 59273080, "link": "https://stackoverflow.com/questions/59273080/inserting-page-breaks-centering-before-pdf-export", "title": "Inserting page breaks/centering before PDF export", "body": "<p>I'm trying to copy all of the charts in my workbook to a temporary sheet, and then export that sheet to a .pdf. I can't seem to figure out how to properly insert a break after each chart, so that each chart has it's own page in the .pdf. As a second goal, I'm also trying to center align each chart in the middle of that page. Here's my code so far:</p>\n\n<pre><code>saveLocation = Application.GetSaveAsFilename( _\nfileFilter:=\"PDF Files (*.pdf), *.pdf\")\nIf saveLocation &lt;&gt; \"False\" Then\n    tp = 25\n    Application.ScreenUpdating = False\n    For Each ws In ThisWorkbook.Sheets\n        If ws.name &lt;&gt; \"Start Here\" Then\n            With wsTemp\n                For Each chrt In ws.Shapes\n                    'this part works ok, but not sure how to insert the break or center\n                    chrt.Copy\n                    wsTemp.Range(\"A1\").PasteSpecial\n                    Selection.Top = tp\n                    Selection.Left = 5\n                    tp = tp + Selection.Height + 100\n                Next chrt\n            End With\n        End If\n    Next ws\n\n    Application.PrintCommunication = False\n    With wsTemp.PageSetup\n        'cut out PageSetup details for brevity\n    End With\n    Application.PrintCommunication = True\n\n    wsTemp.ExportAsFixedFormat Type:=xlTypePDF, Filename:=saveLocation, Quality:=xlQualityStandard, _\n           IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=True\n</code></pre>\n\n<p>Any suggestions would be very helpful!</p>\n"}, {"tags": ["excel", "vba", "timer", "offset"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 5, "creation_date": 1576000812, "post_id": 59272872, "comment_id": 104753060, "body": "<code>Timer</code> is a keyword in VBA, so choose something else.    Also you might take a look at <a href=\"https://stackoverflow.com/questions/25116231/ontime-for-less-than-1-second-without-becoming-unresponsive\" title=\"ontime for less than 1 second without becoming unresponsive\">stackoverflow.com/questions/25116231/&hellip;</a>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1576001040, "post_id": 59272872, "comment_id": 104753144, "body": "<code>Now + TimeValue(&quot;00:00:01&quot;) - ((0.01&#47;(24*60*60)) * Y)</code>"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1576003004, "post_id": 59272872, "comment_id": 104754003, "body": "<code>OnTime</code> only supports times in increments of 1s.  You&#39;ll need another approach to get &lt;1s <a href=\"https://stackoverflow.com/a/25116614/445425\">see this answer of mine</a>"}], "owner": {"reputation": 1, "user_id": 12513284, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-s64VBNRbDWM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf1OlPQxlDrx_6Oj5fw-MwA6Sjg6w/mo/photo.jpg?sz=128", "display_name": "Edward", "link": "https://stackoverflow.com/users/12513284/edward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576008451, "creation_date": 1576000311, "last_edit_date": 1576008451, "question_id": 59272872, "link": "https://stackoverflow.com/questions/59272872/how-can-you-implement-a-looping-timer-is-it-possible-to-vary-the-time-delay", "title": "How can you implement a looping timer? Is it possible to vary the time delay?", "body": "<p>I'm trying to make code which moves the active cell downwards every x seconds (with hopefully x&lt;1), and am having some issues.</p>\n\n<p>Firstly, the following line of code bugs out at the 4th line when I run it, saying: \"Cannot run the macro \"__\". The macro may not be available in this workbook or all macros may be disabled\".</p>\n\n<p>I cannot find any fixes for this online - is there an error in this Sub or is this an issue with my setup of Excel which can be easily fixed?</p>\n\n<pre><code>Public Sub Time_Practice()\n    Debug.Print \"Hello, it is \" &amp; Timer\n    Timer = Now + TimeValue(\"00:00:01\")\n    Application.OnTime Timer, \"Time_Practice\"\nEnd Sub\n</code></pre>\n\n<p>Secondly, the actual code I would like to run is the stuff below, but where I can vary TimeValue(\"00:00:01\") by using a variable such as Added_Time.</p>\n\n<p>By this I mean, if something has happened Y times, I would like the new value for Added_Time = TimeValue(\"00:00:01\") - 0.01 * Y (i.e. if it has happened 10 times, I would like the time gap to be 0.9 seconds).</p>\n\n<p>Would the following line of code be valid and work ok?</p>\n\n<pre><code>Dim Timer As Double, Dim Y as Double\nPublic Sub Movement()\n    ActiveCell.Offset(1, 0).Activate\n    Timer = Now + TimeValue(\"00:00:01\") - 0.01 * Y\n    Application.OnTime Timer, \"Movement\"\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["excel", "vba", "batch-file"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 12513237, "user_type": "registered", "profile_image": "https://graph.facebook.com/156836852339203/picture?type=large", "display_name": "Link Dvamp AcMo", "link": "https://stackoverflow.com/users/12513237/link-dvamp-acmo"}, "edited": false, "score": 0, "creation_date": 1576008574, "post_id": 59272803, "comment_id": 104756334, "body": "Thank you I&#39;m going to test :D"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 3, "last_activity_date": 1576008233, "last_edit_date": 1576008233, "creation_date": 1575999950, "answer_id": 59272803, "question_id": 59272651, "link": "https://stackoverflow.com/questions/59272651/start-excel-with-command-line-and-parameters/59272803#59272803", "title": "Start Excel with command line and parameters", "body": "<p>Excel has no command line switch to submit a password.<br>\nSee <a href=\"https://support.office.com/en-us/article/command-line-switches-for-microsoft-office-products-079164cd-4ef5-4178-b235-441737deb3a6#ID0EAABAAA=Excel\" rel=\"nofollow noreferrer\">Command-line switches for Microsoft Office products</a></p>\n\n<p>But you can use a VBScript <code>StartExcel.vbs</code> instead of a batch file <code>StartExcel.bat</code> to do that:</p>\n\n<pre><code>Set oExcel = CreateObject(\"Excel.Application\")\nSet oWorkbook = oExcel.Workbooks.Open(\"c:\\Documents\\ExcelFile.xls\", 0, 0, 5, \"&lt;myPassword\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 12513237, "user_type": "registered", "profile_image": "https://graph.facebook.com/156836852339203/picture?type=large", "display_name": "Link Dvamp AcMo", "link": "https://stackoverflow.com/users/12513237/link-dvamp-acmo"}, "edited": false, "score": 1, "creation_date": 1576008579, "post_id": 59273290, "comment_id": 104756336, "body": "Thank you im going to test :D"}], "tags": [], "owner": {"reputation": 5170, "user_id": 1410246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfce8c2aa420b800bb7595ac5fbc986d?s=128&d=identicon&r=PG", "display_name": "EylM", "link": "https://stackoverflow.com/users/1410246/eylm"}, "is_accepted": true, "score": 3, "last_activity_date": 1576002246, "creation_date": 1576002246, "answer_id": 59273290, "question_id": 59272651, "link": "https://stackoverflow.com/questions/59272651/start-excel-with-command-line-and-parameters/59273290#59273290", "title": "Start Excel with command line and parameters", "body": "<p>You can create a <code>PowerShell</code> script to perform that using <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.Workbooks.Open\" rel=\"nofollow noreferrer\">Workbook Open</a> function.</p>\n\n<pre><code>$path = \"c:\\temp\\1.xls\"\n$password = \"123\"\n$excel = New-Object -ComObject Excel.Application\n$workbook = $excel.Workbooks.Open($path,$false,$false,5,$password)\n$excel.Visible = $true\n</code></pre>\n\n<p>Save the script to a text file <code>OpenExcel.ps1</code>.</p>\n\n<p>Usage:</p>\n\n<pre><code>powershell -file OpenExcel.ps1\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12513237, "user_type": "registered", "profile_image": "https://graph.facebook.com/156836852339203/picture?type=large", "display_name": "Link Dvamp AcMo", "link": "https://stackoverflow.com/users/12513237/link-dvamp-acmo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 997, "favorite_count": 1, "accepted_answer_id": 59273290, "answer_count": 2, "score": 0, "last_activity_date": 1576008233, "creation_date": 1575999239, "last_edit_date": 1575999626, "question_id": 59272651, "link": "https://stackoverflow.com/questions/59272651/start-excel-with-command-line-and-parameters", "title": "Start Excel with command line and parameters", "body": "<p>I want to create a Windows script to execute excel and open a file p and using the password</p>\n\n<p>Example</p>\n\n<pre><code>Start excel c:\\Documents\\ExcelFile.xls \n</code></pre>\n\n<p>but also I want to add the password</p>\n\n<pre><code>Start excel c:\\Documents\\ExcelFile.xls Password\n</code></pre>\n\n<p>But when I try to do that is not recognized</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1576000832, "post_id": 59272535, "comment_id": 104753073, "body": "hi, maybe they aren&#39;t blank but empty. i think that like doenst like empty fields.. try to  change <code>Me.Analysis1</code> to <code>Me.Analysis1 &amp; &quot;&quot;</code> <code>Me.Analysis3</code> to <code>Me.Analysis3 &amp; &quot;&quot;</code> to see if makes diference"}], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": true, "score": 0, "last_activity_date": 1576013302, "last_edit_date": 1576013302, "creation_date": 1576011644, "answer_id": 59275284, "question_id": 59272535, "link": "https://stackoverflow.com/questions/59272535/access-vba-like-operator/59275284#59275284", "title": "Access VBA LIKE operator", "body": "<p>Null field will not meet the wildcard criteria. An empty string will. If you want to return records where value is Null then need to handle by converting to empty string.</p>\n\n<p><code>AND [AnalysisCode1] &amp; '' LIKE '\" &amp; Me.Analysis1 &amp; \"*'</code></p>\n\n<p>Could conditionally build WHERE clause so only controls with inputs are considered. Review <a href=\"https://stackoverflow.com/questions/5827047/how-to-show-query-results-in-a-datasheet-in-the-same-form/5844215#5844215\">how to show query results in a datasheet in the same form?</a>. However, Null fields will still have to be handled to provide an alternate value if you want those records retrieved when there is an input to corresponding control.</p>\n"}, {"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1576012669, "creation_date": 1576012669, "answer_id": 59275485, "question_id": 59272535, "link": "https://stackoverflow.com/questions/59272535/access-vba-like-operator/59275485#59275485", "title": "Access VBA LIKE operator", "body": "<p>Consider a stored query and not a VBA string query that directly references your form values with <code>NZ</code> to account for empty fields. This helps avoid the need to <code>FORMAT</code> dates or use <code>LIKE</code>. Then base your datasheet RecordSource to saved query and have buttonClick event trigger <a href=\"https://docs.microsoft.com/en-us/office/vba/api/access.form.requery\" rel=\"nofollow noreferrer\"><code>Requery</code></a> of datasheet.</p>\n\n<p><strong>SQL</strong> <em>(assign below to recordsource of datasheet)</em></p>\n\n<p>Below handles optional form controls but returns only non-NULL records:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT * FROM SageOrderLines_Live \nWHERE [PromisedDeliveryDate] = NZ(Form!myForm!DateFrom, [PromisedDeliveryDate])\n  AND [CustomerAccountNumber] = NZ(Form!myForm!CustomerAccount, [CustomerAccountNumber])\n  AND [Code] = NZ(Form!myForm!Product, [Code])\n  AND [AnalysisCode1] = NZ(Form!myForm!Analysis1, [AnalysisCode1])\n  AND [AnalysisCode2] = NZ(Form!myForm!Analysis2, [AnalysisCode2])\n  AND [AnalysisCode3] = NZ(Form!myForm!Analysis3, [AnalysisCode3])\n</code></pre>\n\n<p>Should you need to capture missing values, run <code>NZ</code> on both sides of <code>AND</code> equality expressions with <strong><em>same</em></strong> default value. While dense, below only has to be run one time and never seen again!</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT * FROM SageOrderLines_Live \nWHERE NZ([PromisedDeliveryDate], 'default') = NZ(NZ(Form!myForm!DateFrom, [PromisedDeliveryDate]), 'default')\n  AND NZ([CustomerAccountNumber], 'default') = NZ(NZ(Form!myForm!CustomerAccount, [CustomerAccountNumber]), 'default')\n  AND NZ([Code], 'default') = NZ(NZ(Form!myForm!Product, [Code]), 'default')\n  AND NZ([AnalysisCode1], 'default') = NZ(NZ(Form!myForm!Analysis1, [AnalysisCode1]), 'default')\n  AND NZ([AnalysisCode2], 'default') = NZ(NZ(Form!myForm!Analysis2, [AnalysisCode2]), 'default')\n  AND NZ([AnalysisCode3], 'default') = NZ(NZ(Form!myForm!Analysis3, [AnalysisCode3]), 'default')\n</code></pre>\n\n<p><strong>VBA</strong></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub Command121_Click()\n    Me.myDataSheetForm.Requery\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user12045437"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 59275284, "answer_count": 2, "score": 0, "last_activity_date": 1576013302, "creation_date": 1575998711, "last_edit_date": 1576011634, "question_id": 59272535, "link": "https://stackoverflow.com/questions/59272535/access-vba-like-operator", "title": "Access VBA LIKE operator", "body": "<p>I have created a form that queries a database by multiple fields, however the fields are optional so I use <code>LIKE</code>.\nI have ran a query to return all orders that have been placed on 8/11/2019 and that are in <code>AnalysisCode2 = 'Spray Area'</code>.</p>\n\n<p>When ran on my own form I get returned 3 orders, however when I filter down the database manually I get 7 orders. </p>\n\n<p><a href=\"https://i.stack.imgur.com/vc17Y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vc17Y.png\" alt=\"Orders returned when ran through my own form.\"></a></p>\n\n<p>I went through the table below and removed filters, to find that <code>AnalysisCode1</code> and <code>AnalysisCode3</code> had filters and once I removed these all 7 orders appear. </p>\n\n<p><a href=\"https://i.stack.imgur.com/GMOfd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GMOfd.png\" alt=\"Orders returned when I filter the database manually\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/oVzb8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oVzb8.png\" alt=\"removing filters on analysis code 1 and 3 which my form puts on\"></a></p>\n\n<p>This is where I'm confused as I don't know why there is filters on these two fields as I have use the <code>LIKE</code> operator and these columns are blank in the missing records. </p>\n\n<p>This is my query in the back end:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub Command121_Click()\n\n Dim task As String\n\ntask = \"select * from SageOrderLines_Live where [PromisedDeliveryDate] = \" &amp; Format(Me.DateFrom, \"\\#mm\\/dd\\/yyyy\\#\") &amp; \" AND [CustomerAccountNumber] LIKE '\" &amp; Me.CustomerAccount &amp; \"*' AND [Code] LIKE '\" &amp; Me.Product &amp; \"*' AND [AnalysisCode1] LIKE '\" &amp; Me.Analysis1 &amp; \"*' AND [AnalysisCode2] LIKE '\" &amp; Me.Analysis2 &amp; \"*' AND [AnalysisCode3] LIKE '\" &amp; Me.Analysis3 &amp; \"*'\"\nDoCmd.ApplyFilter task\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["mysql", "sql", "vba", "ms-access", "ms-access-2016"], "comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1576059157, "post_id": 59272287, "comment_id": 104772627, "body": "If you run second version it will raise an error at least at second run (you can&#39;t create a query that allready exists) or you are hiding an error handler! You have to check if query allready exist before create it! My advice, use a temporary querydef and db.Execute.. Also remove the double parenthesis, see <a href=\"https://stackoverflow.com/questions/51272430/type-mismatch-when-passing-string-variable-into-variant-parameter-and-assigning/51272853#51272853\" title=\"type mismatch when passing string variable into variant parameter and assigning\">stackoverflow.com/questions/51272430/&hellip;</a>"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1576059394, "post_id": 59272287, "comment_id": 104772740, "body": "MySQL tag is wrong unless you use Oracles MySQL Database as Backend!"}, {"owner": {"reputation": 23, "user_id": 12198044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b45561bcbfd7b79f25112f218d9119e5?s=128&d=identicon&r=PG&f=1", "display_name": "ErrorMeck", "link": "https://stackoverflow.com/users/12198044/errormeck"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1576259535, "post_id": 59272287, "comment_id": 104854450, "body": "Yes, the error handler is shown in the first code, where I delete and re-create the query every time I need to modify the query.  The second code does not show the &#39;clean up&#39; code I use later on to remove all temporary objects, including the query, so it doesn&#39;t create an error.  This error I am familiar with.  But changing the .SQL part of a querydef isn&#39;t working for me, which is the crux of my problem."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1576352423, "post_id": 59272287, "comment_id": 104874745, "body": "On Error Resume Next without check the Err-Object later is no error handler, just a hider;( Second code has that too?  That explains why it diidn&#39;t show you the error on invalid sql statement(3129)!"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 12198044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b45561bcbfd7b79f25112f218d9119e5?s=128&d=identicon&r=PG&f=1", "display_name": "ErrorMeck", "link": "https://stackoverflow.com/users/12198044/errormeck"}, "edited": false, "score": 0, "creation_date": 1575999969, "post_id": 59272340, "comment_id": 104752702, "body": "That looks just like the code I tried that doesn&#39;t want to work.  Am I missing something?   Do I need to reexecute the line   &quot;Set QD = db.QueryDefs(&quot;qryX&quot;)  every time I need to modify the query?"}, {"owner": {"reputation": 23, "user_id": 12198044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b45561bcbfd7b79f25112f218d9119e5?s=128&d=identicon&r=PG&f=1", "display_name": "ErrorMeck", "link": "https://stackoverflow.com/users/12198044/errormeck"}, "edited": false, "score": 0, "creation_date": 1576000548, "post_id": 59272340, "comment_id": 104752958, "body": "Even re-executing &quot;Set QD = db.QueryDefs(&quot;qryX&quot;) every time doesn&#39;t seem to work.  It still doesn&#39;t create tblDocsCrossTabX."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 23, "user_id": 12198044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b45561bcbfd7b79f25112f218d9119e5?s=128&d=identicon&r=PG&f=1", "display_name": "ErrorMeck", "link": "https://stackoverflow.com/users/12198044/errormeck"}, "edited": false, "score": 0, "creation_date": 1576001327, "post_id": 59272340, "comment_id": 104753251, "body": "You need setting it once only."}, {"owner": {"reputation": 23, "user_id": 12198044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b45561bcbfd7b79f25112f218d9119e5?s=128&d=identicon&r=PG&f=1", "display_name": "ErrorMeck", "link": "https://stackoverflow.com/users/12198044/errormeck"}, "edited": false, "score": 0, "creation_date": 1576270256, "post_id": 59272340, "comment_id": 104858609, "body": "In the second set of code, the code I need help with, I only set it once.  It doesn&#39;t execute the SQL!"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 23, "user_id": 12198044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b45561bcbfd7b79f25112f218d9119e5?s=128&d=identicon&r=PG&f=1", "display_name": "ErrorMeck", "link": "https://stackoverflow.com/users/12198044/errormeck"}, "edited": false, "score": 0, "creation_date": 1576321420, "post_id": 59272340, "comment_id": 104867104, "body": "I think it should work, so I can&#39;t tell why it doesn&#39;t. Try running the query manually."}, {"owner": {"reputation": 23, "user_id": 12198044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b45561bcbfd7b79f25112f218d9119e5?s=128&d=identicon&r=PG&f=1", "display_name": "ErrorMeck", "link": "https://stackoverflow.com/users/12198044/errormeck"}, "edited": false, "score": 0, "creation_date": 1576506877, "post_id": 59272340, "comment_id": 104911684, "body": "It does, sorry.  The difference was I was attempting to assign SQL to the querydef during creation (  CreateQueryDef((&quot;qryX&quot;), mySql)  )  but the string I tried to insert as SQL code isn&#39;t valid SQL.  So no querydef even got created.  Sorry for the frustration."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1575997895, "creation_date": 1575997895, "answer_id": 59272340, "question_id": 59272287, "link": "https://stackoverflow.com/questions/59272287/how-do-i-re-define-the-sql-in-a-querydef-i-have-code-that-works-by-deleting-and/59272340#59272340", "title": "How do I re-define the SQL in a QueryDef? I have code that works by deleting and re-creating the QueryDef, but I can&#39;t get the overwrite to work", "body": "<p>You can recycle the object if you don't delete it:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>' On Error Resume Next\nSet QD = db.QueryDefs(\"qryX\")\nQD.SQL = mySQL\nDoCmd.RunSQL \"SELECT * INTO tblDocsCrossTabX FROM qryX;\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 12198044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b45561bcbfd7b79f25112f218d9119e5?s=128&d=identicon&r=PG&f=1", "display_name": "ErrorMeck", "link": "https://stackoverflow.com/users/12198044/errormeck"}, "edited": false, "score": 0, "creation_date": 1576259619, "post_id": 59283592, "comment_id": 104854484, "body": "I will try this out.  Thanks!"}, {"owner": {"reputation": 23, "user_id": 12198044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b45561bcbfd7b79f25112f218d9119e5?s=128&d=identicon&r=PG&f=1", "display_name": "ErrorMeck", "link": "https://stackoverflow.com/users/12198044/errormeck"}, "edited": false, "score": 0, "creation_date": 1576270189, "post_id": 59283592, "comment_id": 104858592, "body": "No luck.  Now I get the error &quot; Invalid SQL statement; expected &#39;Delete&#39;, &#39;Insert&#39;, &#39;Procedure&#39;, &#39;Select&#39;, or &#39;Update&#39;. &quot;"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 23, "user_id": 12198044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b45561bcbfd7b79f25112f218d9119e5?s=128&d=identicon&r=PG&f=1", "display_name": "ErrorMeck", "link": "https://stackoverflow.com/users/12198044/errormeck"}, "edited": false, "score": 0, "creation_date": 1576352876, "post_id": 59283592, "comment_id": 104874849, "body": "Sorry, I didn&#39;t realize that you can&#39;t use Transform in a subquery. Then you need a saved query and handle if to be created or not."}, {"owner": {"reputation": 23, "user_id": 12198044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b45561bcbfd7b79f25112f218d9119e5?s=128&d=identicon&r=PG&f=1", "display_name": "ErrorMeck", "link": "https://stackoverflow.com/users/12198044/errormeck"}, "edited": false, "score": 0, "creation_date": 1576508255, "post_id": 59283592, "comment_id": 104912426, "body": "Admittedly, my original sql was pretty silly.  Selecting everything from a query and dumping it all into a temp table is awful when I could just use the query itself.  I have corrected that :)"}], "tags": [], "owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "is_accepted": false, "score": 0, "last_activity_date": 1576353508, "last_edit_date": 1576353508, "creation_date": 1576059825, "answer_id": 59283592, "question_id": 59272287, "link": "https://stackoverflow.com/questions/59272287/how-do-i-re-define-the-sql-in-a-querydef-i-have-code-that-works-by-deleting-and/59283592#59283592", "title": "How do I re-define the SQL in a QueryDef? I have code that works by deleting and re-creating the QueryDef, but I can&#39;t get the overwrite to work", "body": "<p>If you can use a subquery, you can use a tempory QueryDef instead of bothering with checking for<code>QueryDef</code>already existing or not, just combine the SELECT and the INSERT-Query to use a temporary<code>QueryDef</code></p>\n\n<p>Unfortunally you can't use<code>Transform</code>in a subquery so this code leads to<code>Runtime-Error 3129 Invalid SQL statement</code>.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sql = \"SELECT * INTO tblDocsCrossTabX FROM (TRANSFORM COUNT(tblDocs.Document) AS CountOfDocument \" &amp; _\n            \"SELECT tblDocs.[Contractor Dept], \" &amp; _\n            \"COUNT(tblDocs.Document) AS [Total Of Document] \" &amp; _\n            \"FROM tblDocs \" &amp; _\n            \"GROUP BY tblDocs.[Contractor Dept] \" &amp; _\n            \"PIVOT tblDocs.[Engineering Status Code])\"\nWith CurrentDb.CreateQueryDef(vbNullString) 'or db.CreateQueryDef(\"\") creates a not named and therefore temporary QueryDef\n    .SQL = Sql\n    .Execute dbFailOnError\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1576353993, "post_id": 59330248, "comment_id": 104875122, "body": "As you want to create an empty QueryDef in your second code and then edit it, you can do that by ommiting the sql-parameter on creation<code>.CreateQueryDef(&quot;qryX&quot;)</code>."}], "tags": [], "owner": {"reputation": 23, "user_id": 12198044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b45561bcbfd7b79f25112f218d9119e5?s=128&d=identicon&r=PG&f=1", "display_name": "ErrorMeck", "link": "https://stackoverflow.com/users/12198044/errormeck"}, "is_accepted": false, "score": 0, "last_activity_date": 1576273886, "creation_date": 1576273886, "answer_id": 59330248, "question_id": 59272287, "link": "https://stackoverflow.com/questions/59272287/how-do-i-re-define-the-sql-in-a-querydef-i-have-code-that-works-by-deleting-and/59330248#59330248", "title": "How do I re-define the SQL in a QueryDef? I have code that works by deleting and re-creating the QueryDef, but I can&#39;t get the overwrite to work", "body": "<p>Solved.  </p>\n\n<p>In the first block of code, when I delete and recreate the query, the string mySql contains a valid SQL statement, so Access is able to assign that SQL to the querydef when I completely recreate it with SET.  Specifically, </p>\n\n<pre><code>mySql = \"Transform...\"\n</code></pre>\n\n<p>Comes <em>Before</em></p>\n\n<pre><code>Set QD = db.CreateQueryDef(\"qryX\", mySql)\n</code></pre>\n\n<p>In the second set of code, the string mySql contains only a space when the Set command is used, as \" \" is not a valid SQL Statement, the Set command won't even get executed, and the QueryDef QD never even gets created.</p>\n\n<p>Specifically, the error in the second code occurs because </p>\n\n<pre><code>mySql = \" \"  'NOT a valid SQL Statement\n</code></pre>\n\n<p>comes before the attempt to create the queryDef</p>\n\n<pre><code>Set QD = db.CreateQueryDef((\"qryX\"), mySql)   'QD never gets created because mySql is not valid SQL\n</code></pre>\n\n<p>preventing the assignment of a valid SQL statement later, and so no table gets created. </p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 12198044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b45561bcbfd7b79f25112f218d9119e5?s=128&d=identicon&r=PG&f=1", "display_name": "ErrorMeck", "link": "https://stackoverflow.com/users/12198044/errormeck"}, "is_accepted": false, "score": 0, "last_activity_date": 1576507971, "creation_date": 1576507971, "answer_id": 59359066, "question_id": 59272287, "link": "https://stackoverflow.com/questions/59272287/how-do-i-re-define-the-sql-in-a-querydef-i-have-code-that-works-by-deleting-and/59359066#59359066", "title": "How do I re-define the SQL in a QueryDef? I have code that works by deleting and re-creating the QueryDef, but I can&#39;t get the overwrite to work", "body": "<p>Sample of successful code. </p>\n\n<pre><code>Dim db As Database\nSet db = CurrentDb\nDim QueryString As String\nDim QDDocsCross As QueryDef\nSet QDDocsCross = db.CreateQueryDef(\"DocsCross\")\n\nQueryString = \"TRANSFORM COUNT(Docs.Document) AS CountOfDocument \" &amp; _\n            \"SELECT Docs.[Contractor Dept], \" &amp; _\n            \"COUNT(Docs.Document) AS [Total Of Document] \" &amp; _\n            \"FROM Docs \" &amp; _\n            \"GROUP BY Docs.[Contractor Dept] \" &amp; _\n            \"PIVOT Docs.[Engineering Status Code]\"\n        QDDocsCross.SQL = QueryString\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 12198044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b45561bcbfd7b79f25112f218d9119e5?s=128&d=identicon&r=PG&f=1", "display_name": "ErrorMeck", "link": "https://stackoverflow.com/users/12198044/errormeck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 322, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1593676705, "creation_date": 1575997620, "last_edit_date": 1593676705, "question_id": 59272287, "link": "https://stackoverflow.com/questions/59272287/how-do-i-re-define-the-sql-in-a-querydef-i-have-code-that-works-by-deleting-and", "title": "How do I re-define the SQL in a QueryDef? I have code that works by deleting and re-creating the QueryDef, but I can&#39;t get the overwrite to work", "body": "<p>I am told (and agree) that it is better to replace the SQL in an existing querydef, rather than delete and re-define the querydef each time the query needs to change.  But my code only seems to work the second way.  Here is the code I have that works:</p>\n\n<pre><code>Dim db As Database\nSet db = CurrentDb\nDim QD As QueryDef\nDim mySql As String\nmySql = \"\"\n\nmySql = \"TRANSFORM COUNT(tblDocs.Document) AS CountOfDocument \" &amp; _\n            \"SELECT tblDocs.[Contractor Dept], \" &amp; _\n            \"COUNT(tblDocs.Document) AS [Total Of Document] \" &amp; _\n            \"FROM tblDocs \" &amp; _\n            \"GROUP BY tblDocs.[Contractor Dept] \" &amp; _\n            \"PIVOT tblDocs.[Engineering Status Code]\"\nOn Error Resume Next\ndb.QueryDefs.Delete \"qryX\"                        'Remove temporary query if exists\nSet QD = db.CreateQueryDef(\"qryX\", mySql)         'create temporary query\nDoCmd.RunSQL \"SELECT * INTO tblDocsCrossTabX FROM qryX;\"\n</code></pre>\n\n<p>Here is the code I can't get to work</p>\n\n<pre><code>Dim db As Database\nSet db = CurrentDb\nDim QD As QueryDef\nDim mySql As String\nmySql = \" \"\nSet QD = db.CreateQueryDef((\"qryX\"), mySql)\n\nmySql = \"TRANSFORM COUNT(tblDocs.Document) AS CountOfDocument \" &amp; _\n            \"SELECT tblDocs.[Contractor Dept], \" &amp; _\n            \"COUNT(tblDocs.Document) AS [Total Of Document] \" &amp; _\n            \"FROM tblDocs \" &amp; _\n            \"GROUP BY tblDocs.[Contractor Dept] \" &amp; _\n            \"PIVOT tblDocs.[Engineering Status Code]\"\nQD.SQL = mySQL                                             'overwrite query SQL\nDoCmd.RunSQL \"SELECT * INTO tblDocsCrossTabX FROM qryX;\"\n</code></pre>\n\n<p>Oddly, the second version doesn't throw any errors at me, but it doesn't make the crosstab table at all.</p>\n\n<p>Edit:  Maybe I wasn't clear enough.  The problem is that the second set of code Does. Not. Execute. The. SQL.  If it executed the code, I would be happy to re-write and use the same temp query over and over, but it does. not. execute. the. SQL..  </p>\n\n<p>Please respond with how to make the code in the second block actually execute the indicated SQL statement and build the desired table.  </p>\n\n<p>I know I have to remake a query if I delete it.  Duh. \nI know I \"should\" be able to re-use the same query if I can get the Set statement to properly overwrite the previous sql with the desired sql.<br>\nI know you all want to provide an answer, but please make it an answer to the question I am asking. </p>\n"}, {"tags": ["excel", "vba", "email-attachments"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575995953, "post_id": 59271774, "comment_id": 104750787, "body": "You already have the <code>Filename</code> from before: <code>Sheet1.Range(&quot;L7&quot;).Value</code>."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575996304, "post_id": 59271774, "comment_id": 104750970, "body": "^ <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.attachments.add\" rel=\"nofollow noreferrer\"><code>Attachments.Add</code></a> just needs the full path of the file."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1575999252, "post_id": 59271774, "comment_id": 104752389, "body": "What&#39;s in L7 - just the filename, or the full path?  You should use the full path."}, {"owner": {"reputation": 1, "user_id": 12512386, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCqZREppk2xqkkSIyw1KplftYkeT7LBq6aEZsmzFA=k-s128", "display_name": "Joseph Waka", "link": "https://stackoverflow.com/users/12512386/joseph-waka"}, "edited": false, "score": 0, "creation_date": 1576005106, "post_id": 59271774, "comment_id": 104754911, "body": "I am very new with coding. So I will take time to understand.... i have tried <code>Attachments.Add &quot;Filename&quot;</code>  I am getting a run time error"}, {"owner": {"reputation": 1, "user_id": 12512386, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCqZREppk2xqkkSIyw1KplftYkeT7LBq6aEZsmzFA=k-s128", "display_name": "Joseph Waka", "link": "https://stackoverflow.com/users/12512386/joseph-waka"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1576005366, "post_id": 59271774, "comment_id": 104755030, "body": "@TimWilliams could you please write a code example of what you mean with inserting the path?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1576005920, "post_id": 59271774, "comment_id": 104755261, "body": "There&#39;s no code to write - it only involves putting the full path (eg &quot;C:\\folder\\file.pdf&quot; instead of just &quot;file.pdf&quot;) in L7 if you&#39;re not already doing that."}], "owner": {"reputation": 1, "user_id": 12512386, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCqZREppk2xqkkSIyw1KplftYkeT7LBq6aEZsmzFA=k-s128", "display_name": "Joseph Waka", "link": "https://stackoverflow.com/users/12512386/joseph-waka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575996319, "creation_date": 1575995745, "last_edit_date": 1575996319, "question_id": 59271774, "link": "https://stackoverflow.com/questions/59271774/create-pdf-file-attach-in-out", "title": "Create PDF File, Attach in Out", "body": "<p>Please help. </p>\n\n<p>My code below should do the following:</p>\n\n<p>1.Save Sheet1 as a PDF file.  No problems here</p>\n\n<p>2.Outlook should get the recently saved PDF file and attach in new mail ready to send. </p>\n\n<p>Thanks in advance, </p>\n\n<p>JW</p>\n\n<p><strong>I am using MSoffice 2013</strong></p>\n\n<pre><code>Sub Create_PDF_Attach_In_outlook_And_Send ()\n\n    Dim outlookOBJ As Object\n    Dim mItem As Object\n    Set outlookOBJ = CreateObject(\"outlook.application\")\n    Set mItem = outlookOBJ.CreateItem(olMailItem)\n\n\n    Sheet1.ExportAsFixedFormat Type:=xlTypePDF, _\n    IgnorePrintAreas:=False, _\n    OpenAfterPublish:=True, _\n    Filename:=Sheet1.Range(\"L7\").Value\n\n    With mItem\n    .To = Sheet1.Range(\"O8\").Value\n    .CC = Sheet1.Range(\"O9\").Value\n    .Subject = Filename\n    .Attachments.Add **????**\n    .Body = \"Enter Body Text\"\n    .Display\n\n    End With\n\n    Set outlookOBJ = Nothing\n    Set mItem = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 55, "user_id": 12478546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d1f14bc3ed49a52286b18bbd30c50a4?s=128&d=identicon&r=PG&f=1", "display_name": "kelvin.aaa2", "link": "https://stackoverflow.com/users/12478546/kelvin-aaa2"}, "edited": false, "score": 0, "creation_date": 1575995244, "post_id": 59271627, "comment_id": 104750404, "body": "I can provide the VBA I&#39;ve done if needed"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1575995262, "post_id": 59271627, "comment_id": 104750413, "body": "Yes, please <a href=\"https://stackoverflow.com/posts/59271627/edit\">edit</a> your question with what you have so far, thanks."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575995520, "post_id": 59271627, "comment_id": 104750565, "body": "If the tab names are the same, then just loop through all the worksheets in <code>wb1</code> and refer to the worksheet in <code>wb2</code> by the worksheet name from <code>wb1</code>."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1575997971, "post_id": 59271627, "comment_id": 104751833, "body": "When you set <code>ws</code> it gets the workbook attached and as such you cannot do <code>wb1.ws.Name</code> as that will refer to two workbooks."}, {"owner": {"reputation": 55, "user_id": 12478546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d1f14bc3ed49a52286b18bbd30c50a4?s=128&d=identicon&r=PG&f=1", "display_name": "kelvin.aaa2", "link": "https://stackoverflow.com/users/12478546/kelvin-aaa2"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576048665, "post_id": 59271627, "comment_id": 104767504, "body": "Thanks you guys, @BigBen How can I  loop through all the worksheets in wb1 and refer to the worksheet in wb2 by the worksheet name from wb1?  Because those Tab names are various in time to time, I cannot type in a fix Tab name in the VBA code"}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 0, "last_activity_date": 1576068758, "creation_date": 1576068758, "answer_id": 59286278, "question_id": 59271627, "link": "https://stackoverflow.com/questions/59271627/vba-copy-paste-data-from-source-workbook-to-destination-worksheet-if-their-ce/59286278#59286278", "title": "VBA: Copy &amp; Paste data from source workbook to destination worksheet If their Cell &quot;A1&quot; value is equal to each others", "body": "<p>If the tab names are the same, then loop through the worksheets in <code>Wb1</code> and use each worksheet name to refer to the corresponding worksheet in <code>Wb2</code>, something like this:</p>\n\n<pre><code>Sub Macro1()\n    Dim Wb1 As Workbook\n    Set Wb1 = Workbooks(\"Test Template\")\n    Dim Wb2 As Workbook\n    Set Wb2 = Workbooks(\"Hy.xlsm\")\n\n    Dim ws As Worksheet\n    For Each ws In Wb1.Worksheets\n        Dim ws2 As Worksheet\n        Set ws2 = Nothing\n\n        On Error Resume Next\n        Set ws2 = Wb2.Worksheets(ws.Name)\n        On Error GoTo 0\n\n        If Not ws2 Is Nothing Then\n            ' Do your copy here.\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 12478546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d1f14bc3ed49a52286b18bbd30c50a4?s=128&d=identicon&r=PG&f=1", "display_name": "kelvin.aaa2", "link": "https://stackoverflow.com/users/12478546/kelvin-aaa2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1576068758, "creation_date": 1575995201, "last_edit_date": 1576068202, "question_id": 59271627, "link": "https://stackoverflow.com/questions/59271627/vba-copy-paste-data-from-source-workbook-to-destination-worksheet-if-their-ce", "title": "VBA: Copy &amp; Paste data from source workbook to destination worksheet If their Cell &quot;A1&quot; value is equal to each others", "body": "<p>-I have 2 workbooks now, one is the source, another one is the destination.</p>\n\n<p>-They have the same format, but only the source file contains data</p>\n\n<p>-Both workbooks have the same TABs (But the Tabs are variables, For example, Tab A, B, C are created this time, but next time they might be Tab C, D, E) </p>\n\n<ul>\n<li>I would like to have something like this:</li>\n</ul>\n\n<p>I have already set wb1 (Source) &amp; wb2 (Destination) As those 2 workbooks</p>\n\n<pre><code>Dim ws As worksheet\n If wb1.ws.Name = wb2.ws.Name Then\n</code></pre>\n\n<p>Copy &amp; paste the same Tab info. (Range A1 to last row) from wb1 to wb2</p>\n\n<ul>\n<li>But somehow the code is not supported by VBA. What is the correct code that I can set</li>\n</ul>\n\n<p>Thanks!</p>\n\n<pre><code>Sub Macro1()\n\n' Copy &amp; paste from workbook to workbook\n\nDim Wb1 As Excel.Workbook\nSet Wb1 = Application.Workbooks(\"Test Template\")\nDim Wb2 As Excel.Workbook\nSet Wb2 = Application.Workbooks(\"Hy.xlsm\")\n\nSet ws1 = Wb1.Worksheets\nSet ws2 = Wb2.Worksheets\n\nIf ws1.Name = ws2.Name Then\n    MsgBox \"True\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "is_accepted": true, "score": 3, "last_activity_date": 1575997200, "last_edit_date": 1592644375, "creation_date": 1575995637, "answer_id": 59271746, "question_id": 59271507, "link": "https://stackoverflow.com/questions/59271507/how-to-auto-number-till-merge-cell-is-detected/59271746#59271746", "title": "How to auto number till merge cell is detected?", "body": "<p>Assuming your sheet is named <code>Sheet1</code>, you may use something like this:</p>\n<pre><code>Sub Test()\n    Dim lastRow As Long, i As Long, counter As Long\n    With Sheet1\n        lastRow = .Range(&quot;B&quot; &amp; .Rows.Count).End(xlUp).Row\n        For i = 3 To lastRow\n            If Not IsEmpty(.Cells(i, 2)) And Not IsEmpty(.Cells(i, 3)) Then\n                counter = counter + 1\n                .Cells(i, 1).Value = counter\n            End If\n        Next\n    End With\nEnd Sub\n</code></pre>\n<p><strong>Note:</strong> Using <code>IsEmpty</code> to check if any of the cells in columns B &amp; C is empty <strong>already covers the case of cells being merged</strong> because in that case, at least one of the two cells has to be empty anyway.</p>\n<h3>Demo:</h3>\n<p><a href=\"https://i.stack.imgur.com/3EYhH.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3EYhH.gif\" alt=\"Demo\" /></a></p>\n"}, {"tags": [], "owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "is_accepted": false, "score": 0, "last_activity_date": 1575995833, "creation_date": 1575995833, "answer_id": 59271797, "question_id": 59271507, "link": "https://stackoverflow.com/questions/59271507/how-to-auto-number-till-merge-cell-is-detected/59271797#59271797", "title": "How to auto number till merge cell is detected?", "body": "<p>You have <code>r</code> as a range, you can't add a number to it and have it increment the range. (Though I did just test it and it doesn't throw an error which is strange)</p>\n\n<p>Also Skip is not a thing in VBA, if you want to skip in a loop you need a conditional or a goto. Though you have no loop.</p>\n\n<pre><code>Sub test()\n    Dim i As Long\n    Dim lastrow As Long\n    Dim counter As Long\n\n    counter = 1\n    With ActiveSheet ' Change this to the real sheet name\n        lastrow = .Cells(.Rows.Count, 2).End(xlUp).Row ' Gets Last row\n\n        For i = 3 To lastrow ' Loop\n            If not isempty(.Cells(i, 2).Value) And not IsEmpty(.Cells(i, 3).Value) Then ' Looks for Text\n                If Not .Cells(i, 1).MergeCells Then ' Looks for merged cells\n                    .Cells(i, 1).Value = counter ' Adds count\n                    counter = counter + 1 ' Increments count\n                End If\n            End If\n        Next i\n    End With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1575995930, "creation_date": 1575995930, "answer_id": 59271835, "question_id": 59271507, "link": "https://stackoverflow.com/questions/59271507/how-to-auto-number-till-merge-cell-is-detected/59271835#59271835", "title": "How to auto number till merge cell is detected?", "body": "<p>See for comments and customize to fit your needs:</p>\n\n<pre><code>Public Sub AutoNumber()\n\n    ' Declare objects\n    Dim evalRange As Range\n    Dim evalCell As Range\n\n    ' Declare other variables\n    Dim sheetName As String\n    Dim initialCellAddress As String\n    Dim lastRow As Long\n    Dim columnNumber As Long\n    Dim counter As Long\n\n\n    ' Customize to fit your needs\n    sheetName = \"Sheet1\"\n    initialCellAddress = \"B2\"\n    counter = 1\n\n    ' Get column number and last row number to define the range address ahead\n    columnNumber = Range(initialCellAddress).Column\n    lastRow = ThisWorkbook.Worksheets(sheetName).Cells(Rows.Count, columnNumber).End(xlUp).Row\n\n    ' Define the range to be evaluated\n    Set evalRange = ThisWorkbook.Worksheets(sheetName).Range(initialCellAddress &amp; \":\" &amp; Left$(initialCellAddress, 1) &amp; lastRow)\n\n    ' Loop through each cell in range (in the original example we'll loop through column b)\n    For Each evalCell In evalRange\n\n        If evalCell.MergeCells &lt;&gt; True Then\n\n            ' Assign the counter to the column at the left (offset = -1) of the evaluated cell\n            evalCell.Offset(rowoffset:=0, columnOffset:=-1).Value2 = counter\n\n            counter = counter + 1\n\n        End If\n\n    Next evalCell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7176307, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cca89f0553a7da8907162b697209cfd7?s=128&d=identicon&r=PG", "display_name": "mike", "link": "https://stackoverflow.com/users/7176307/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 59271746, "answer_count": 3, "score": 0, "last_activity_date": 1575997200, "creation_date": 1575994743, "last_edit_date": 1575996362, "question_id": 59271507, "link": "https://stackoverflow.com/questions/59271507/how-to-auto-number-till-merge-cell-is-detected", "title": "How to auto number till merge cell is detected?", "body": "<p>My knowledge in VBA coding is zero. I wonder if someone can help with this question, please. \nI have this initial code tried to write but it is wrong. I was not sure how to add these below conditions in the code.  </p>\n\n<p>Question: I want to auto number column A which starts at a specific Cell, A3 and it auto-numbers as long as there is text in Column B and Column C. \nHere's the sample data picture. Thanks in advance!</p>\n\n<p><a href=\"https://i.stack.imgur.com/4mJYT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4mJYT.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub test()\n    Set r = Range(\"a3\", Range(\"b\" &amp; Rows.Count).End(xlUp)).Offset(, -1)\n    With r\n        If .MergeCells &lt;&gt; True Then\n            r = r +1\n        Else\n            ' Skip\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "filter"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1575992571, "post_id": 59270496, "comment_id": 104748785, "body": "Is a helper column an option?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9758877"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575992595, "post_id": 59270496, "comment_id": 104748797, "body": "You can insert what you like BigBen"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1575992699, "post_id": 59270496, "comment_id": 104748861, "body": "Then you can add a helper column that uses <code>COUNTIF</code> to count if the specific word is found in that row, e.g. <code>=COUNTIF(C1:F1,$H$2)&gt;0</code> and drag down. Then filter on <code>TRUE</code> in that column."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9758877"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575992966, "post_id": 59270496, "comment_id": 104749037, "body": "Sorry BigBen I could not understand what you are trying to say to me. Can you provide me an example? If you could answer my post would be great!"}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 0, "last_activity_date": 1575993421, "last_edit_date": 1575993421, "creation_date": 1575993073, "answer_id": 59271003, "question_id": 59270496, "link": "https://stackoverflow.com/questions/59270496/vba-excel-autofilter-logic/59271003#59271003", "title": "VBA EXCEL .AutoFilter logic", "body": "<p>This can be done with a helper column. </p>\n\n<p>In <code>G1</code>, add the formula <code>=COUNTIF(C1:F1,$H$2)&gt;0</code>, and drag down to <code>G19</code>.</p>\n\n<p>Now you can filter on column G and the value <code>TRUE</code>. </p>\n\n<p>I will leave the VBA implementation to you.</p>\n\n<p><a href=\"https://i.stack.imgur.com/t1qHG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/t1qHG.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9758877"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 59271003, "answer_count": 1, "score": 0, "last_activity_date": 1575993421, "creation_date": 1575991433, "question_id": 59270496, "link": "https://stackoverflow.com/questions/59270496/vba-excel-autofilter-logic", "title": "VBA EXCEL .AutoFilter logic", "body": "<p>This is my scenario:</p>\n\n<p><a href=\"https://i.stack.imgur.com/zux4w.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zux4w.png\" alt=\"enter image description here\"></a></p>\n\n<p>What I would like to do is to filter all the rows that contains the word <strong>food</strong> (this word could change, so per example it could be <strong>drink</strong> or <strong>cars</strong>)</p>\n\n<p>This is my code far enough</p>\n\n<pre><code>    With Sheets(\"Foglio1\").Range(\"A1:F20\")\n    .AutoFilter Field:=3, Criteria1:=Sheets(\"Sheet1\").Range(\"H2\")\n    .AutoFilter Field:=4, Criteria1:=Sheets(\"Sheet1\").Range(\"H2\")\n    .AutoFilter Field:=5, Criteria1:=Sheets(\"Sheet1\").Range(\"H2\")\n    .AutoFilter Field:=6, Criteria1:=Sheets(\"Sheet1\").Range(\"H2\")\n    End With\n</code></pre>\n"}, {"tags": ["excel", "vba", "if-statement", "hyperlink"], "comments": [{"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 1, "creation_date": 1575990760, "post_id": 59270229, "comment_id": 104747704, "body": "Use F8 key to step through the code line by line. Also, edit your question and post a screenshot of current data and the expected results"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12512466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93ed514ee2413c7235bbde14b11a788d?s=128&d=identicon&r=PG&f=1", "display_name": "Nade", "link": "https://stackoverflow.com/users/12512466/nade"}, "edited": false, "score": 0, "creation_date": 1575994747, "post_id": 59270705, "comment_id": 104750108, "body": "I tried your option, but then I have an error message. And when I check line by line, it tells me at Range(&quot;Categorie&quot;) that     &#39;   Range(&quot;Categorie&quot;)=&lt;Method&#39;Range&#39; of object &#39;_Global&#39; failed&gt;    &#39; The problem remains. As for the &quot;elseif&quot;, I don&#39;t think it&#39;s what I need. What I need to do is for several cells separatley, in the range (H6; J10) to contain a different link if &quot;Categorie&quot; = &quot;Vocabulaire&quot;. And then, if &quot;Categorie&quot; = &quot;Grammaire&quot;, I want those same cells to contain another bunch of different links."}, {"owner": {"reputation": 567, "user_id": 5805795, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5e306c676900f1dc3f798f3915879f03?s=128&d=identicon&r=PG&f=1", "display_name": "jcarroll", "link": "https://stackoverflow.com/users/5805795/jcarroll"}, "reply_to_user": {"reputation": 1, "user_id": 12512466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93ed514ee2413c7235bbde14b11a788d?s=128&d=identicon&r=PG&f=1", "display_name": "Nade", "link": "https://stackoverflow.com/users/12512466/nade"}, "edited": false, "score": 0, "creation_date": 1575995435, "post_id": 59270705, "comment_id": 104750519, "body": "You are most likely receiving this error message because the workbook with the named range is not active. I&#39;ve added an extra line that will active your workbook. This isn&#39;t really best practice in my opinion, but is a simple fix."}, {"owner": {"reputation": 1, "user_id": 12512466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93ed514ee2413c7235bbde14b11a788d?s=128&d=identicon&r=PG&f=1", "display_name": "Nade", "link": "https://stackoverflow.com/users/12512466/nade"}, "edited": false, "score": 0, "creation_date": 1575995535, "post_id": 59270705, "comment_id": 104750577, "body": "It&#39;s open on the desk. How should I make it more active ?"}, {"owner": {"reputation": 567, "user_id": 5805795, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5e306c676900f1dc3f798f3915879f03?s=128&d=identicon&r=PG&f=1", "display_name": "jcarroll", "link": "https://stackoverflow.com/users/5805795/jcarroll"}, "reply_to_user": {"reputation": 1, "user_id": 12512466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93ed514ee2413c7235bbde14b11a788d?s=128&d=identicon&r=PG&f=1", "display_name": "Nade", "link": "https://stackoverflow.com/users/12512466/nade"}, "edited": false, "score": 0, "creation_date": 1575995911, "post_id": 59270705, "comment_id": 104750763, "body": "Assuming that activating the workbook fixes the first issue. Would each cell in the range H6:J10 contain a unique link when <code>Categorie = &quot;Vocabulaire&quot;</code>? If so, I don&#39;t think there is any way to avoid having many lines like <code>ActiveSheet.Hyperlinks.Add Range(&quot;H6&quot;), &quot;https:&#47;&#47;stackoverflow.com&#47;posts&#47;59270705&#47;edit&quot;</code>"}, {"owner": {"reputation": 1, "user_id": 12512466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93ed514ee2413c7235bbde14b11a788d?s=128&d=identicon&r=PG&f=1", "display_name": "Nade", "link": "https://stackoverflow.com/users/12512466/nade"}, "edited": false, "score": 0, "creation_date": 1576179581, "post_id": 59270705, "comment_id": 104825270, "body": "No, each cell would contain a different link :)"}], "tags": [], "owner": {"reputation": 567, "user_id": 5805795, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5e306c676900f1dc3f798f3915879f03?s=128&d=identicon&r=PG&f=1", "display_name": "jcarroll", "link": "https://stackoverflow.com/users/5805795/jcarroll"}, "is_accepted": false, "score": 0, "last_activity_date": 1575995505, "last_edit_date": 1575995505, "creation_date": 1575992099, "answer_id": 59270705, "question_id": 59270229, "link": "https://stackoverflow.com/questions/59270229/how-to-add-several-hyperlinks-in-vba/59270705#59270705", "title": "How to add several hyperlinks in VBA?", "body": "<p>I think all that is missing is to change <code>Categorie</code> to <code>Range(\"Categorie\")</code>. \nThe Visual Basic Editor thinks <code>Categorie</code> is a variable, which is why it's empty.</p>\n\n<p>Your other question is how to add multiple links. If the link is dependent on the value of <code>Categorie</code> then you might try something like:</p>\n\n<pre><code>Sub Cr\u00e9ation_lien()\n\nWorkbooks(\"Book1\").Activate 'put your workbook name here\n\n    If Range(\"Categorie\") = \"Vocabulaire\" Then\n        ActiveSheet.Hyperlinks.Add Range(\"H6\"), \"https://www.anglaisfacile.com/exercices/exercice-anglais-2/exercice-anglais-113622.php\"\n    ElseIf Range(\"Categorie\") = \"Some other value\" Then\n        ActiveSheet.Hyperlinks.Add Range(\"H6\"), \"https://stackoverflow.com/posts/59270705/edit\"\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12512466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93ed514ee2413c7235bbde14b11a788d?s=128&d=identicon&r=PG&f=1", "display_name": "Nade", "link": "https://stackoverflow.com/users/12512466/nade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575995505, "creation_date": 1575990519, "last_edit_date": 1575992201, "question_id": 59270229, "link": "https://stackoverflow.com/questions/59270229/how-to-add-several-hyperlinks-in-vba", "title": "How to add several hyperlinks in VBA?", "body": "<p>I'm trying to add a conditioned hyperlink in VBA - if one cell shows something (out of four possibilities), then the link is supposed to appear in another cell, on the same sheet, a few columns apart.</p>\n\n<p>\"Categorie\" is the name of the cell on which content the condition is based. \nI've done this, but nothing appears on the sheet when I press play. Did I make a mistake ? </p>\n\n<pre><code>Sub Cr\u00e9ation_lien()\n\nIf Categorie = \"Vocabulaire\" Then\n    ActiveSheet.Hyperlinks.Add Range(\"H6\"), \n    \"https://www.anglaisfacile.com/exercices/exercice-anglais-2/exercice-anglais-113622.php\"\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I went through it with F8, and it tells me that \"Categorie\" is empty. \nHere is my Sheet :</p>\n\n<p>There is one list to choose from, and several possibilities that change according to what you choose, in the 4th to 6th column</p>\n\n<p><a href=\"https://i.stack.imgur.com/K4jpN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/K4jpN.png\" alt=\"enter image description here\"></a></p>\n\n<p>As I have several answers that correspond to a same content in cell \"Categorie\", how can I add several links so they can appear in 9 cells ? </p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 1, "creation_date": 1575990856, "post_id": 59270146, "comment_id": 104747767, "body": "Good to have a VBA module, but if you do not share it, nobody can help you, I am afraid..."}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 1, "creation_date": 1575991329, "post_id": 59270146, "comment_id": 104748056, "body": "Maybe locale can affect the results."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1575991568, "post_id": 59270146, "comment_id": 104748211, "body": "A more complete sample could be appreciable See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1575992857, "post_id": 59270146, "comment_id": 104748962, "body": "<a href=\"https://stackoverflow.com/questions/2710621/count-vs-count1-vs-countpk-which-is-better\" title=\"count vs count1 vs countpk which is better\">stackoverflow.com/questions/2710621/&hellip;</a>"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1575993413, "post_id": 59270146, "comment_id": 104749291, "body": "Use <code>Debug.Print</code>: <a href=\"http://stackoverflow.com/questions/418960/managing-and-debugging-sql-queries-in-ms-access/1099570#1099570\">How to debug dynamic SQL in VBA</a> -- And check that you both are linked to the same data, and use the same date."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1575993631, "post_id": 59270146, "comment_id": 104749422, "body": "Also, just as a thought, dates can be affected by using <code>mm&#47;dd&#47;yyyy</code> vs <code>dd&#47;mm&#47;yyyy</code> format in the variable. Personally, I like to format the date variables to something like  <code>Jan 5, 2019</code> instead so the DB Engine doesn&#39;t get confused."}, {"owner": {"reputation": 63, "user_id": 11812013, "user_type": "registered", "profile_image": "https://graph.facebook.com/2861511010544771/picture?type=large", "display_name": "Tom Zvolensky", "link": "https://stackoverflow.com/users/11812013/tom-zvolensky"}, "edited": false, "score": 0, "creation_date": 1575993945, "post_id": 59270146, "comment_id": 104749602, "body": "My colleague is in the UK, so the format of NextMigrationDate may be the culprit.   Will pursue this lead and see what turns up."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 11812013, "user_type": "registered", "profile_image": "https://graph.facebook.com/2861511010544771/picture?type=large", "display_name": "Tom Zvolensky", "link": "https://stackoverflow.com/users/11812013/tom-zvolensky"}, "edited": false, "score": 1, "creation_date": 1575997641, "post_id": 59271364, "comment_id": 104751666, "body": "Thanks to you and all.   I confirm the difference in date format was the culprit.  The code change works like a charm."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1575994306, "creation_date": 1575994306, "answer_id": 59271364, "question_id": 59270146, "link": "https://stackoverflow.com/questions/59270146/access-vba-function-produces-different-results-for-different-users/59271364#59271364", "title": "Access VBA Function produces different results for different users", "body": "<p>This will work both here and there:</p>\n\n<pre><code>Set rs = db.OpenRecordset(\"SELECT Count(*) As AUSTcount FROM [Migration List] Where BatchNumber Like 'UAUST*' AND TargetUserMigrationDate = #\" &amp; Format(NextMigrationDate, \"yyyy\\/mm\\/dd\") &amp; \"#\")\n</code></pre>\n\n<p>If you don't force the format, the date values will be casted to text expressions as to the local settings.</p>\n"}], "owner": {"reputation": 63, "user_id": 11812013, "user_type": "registered", "profile_image": "https://graph.facebook.com/2861511010544771/picture?type=large", "display_name": "Tom Zvolensky", "link": "https://stackoverflow.com/users/11812013/tom-zvolensky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 59271364, "answer_count": 1, "score": 1, "last_activity_date": 1575994306, "creation_date": 1575990235, "last_edit_date": 1575991432, "question_id": 59270146, "link": "https://stackoverflow.com/questions/59270146/access-vba-function-produces-different-results-for-different-users", "title": "Access VBA Function produces different results for different users", "body": "<p>I have a VBA module that is run via a macro.   The code runs five queries against a single table to count five different quantities and places them in the body of an email message which is sent to various parties.</p>\n\n<p>When I run the module, it produces the correct counts in the message.   When an associate runs it, the queries produce zero for each of the five counts.</p>\n\n<p>Both of us use Access 2016, so version is not a factor.</p>\n\n<p>This has me scratching my head.</p>\n\n<p>Has anyone encountered this situation before?   I'm at a loss as to the cause.</p>\n\n<p>Code snippet below:</p>\n\n<pre><code>    Set rs = db.OpenRecordset(\"SELECT Count(*) As Total FROM [Migration List] Where TargetUserMigrationDate = #\" &amp; NextMigrationDate &amp; \"#\")\n    Total = rs!Total\n    Set rs = db.OpenRecordset(\"SELECT Count(*) As AUSTcount FROM [Migration List] Where BatchNumber Like 'UAUST*' AND TargetUserMigrationDate = #\" &amp; NextMigrationDate &amp; \"#\")\n    AUSTcount = rs!AUSTcount\n    Set rs = db.OpenRecordset(\"SELECT Count(*) As EMEAcount FROM [Migration List] Where BatchNumber Like 'UEMEA*' AND TargetUserMigrationDate = #\" &amp; NextMigrationDate &amp; \"#\")\n    EMEAcount = rs!EMEAcount\n    Set rs = db.OpenRecordset(\"SELECT Count(*) As AMERcount FROM [Migration List] Where BatchNumber Like 'UAMER*' AND TargetUserMigrationDate = #\" &amp; NextMigrationDate &amp; \"#\")\n    AMERcount = rs!AMERcount\n    Set rs = db.OpenRecordset(\"SELECT Count(*) As APACcount FROM [Migration List] Where BatchNumber Like 'UAPAC*' AND TargetUserMigrationDate = #\" &amp; NextMigrationDate &amp; \"#\")\n    APACcount = rs!APACcount\n    Set rs = db.OpenRecordset(\"SELECT Count(*) As MACcount FROM [Migration List] Where [Migration List].[Mac User] = TRUE AND TargetUserMigrationDate = #\" &amp; NextMigrationDate &amp; \"#\")\n    MACcount = rs!MACcount\n</code></pre>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1575990477, "post_id": 59270119, "comment_id": 104747553, "body": "It would be an array formula(uses Ctrl-Shift-Enter) or native array formula(Aggregate,Sumproduct,...).  Are you trying to avoid array formula in total or just ones that require the Ctrl-Shift-Enter."}, {"owner": {"reputation": 39, "user_id": 6849830, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QiFwTLfajzc/AAAAAAAAAAI/AAAAAAAAABU/ZHHA0Bvc8fQ/photo.jpg?sz=128", "display_name": "Alex Ross", "link": "https://stackoverflow.com/users/6849830/alex-ross"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1575990780, "post_id": 59270119, "comment_id": 104747715, "body": "@ScottCraner I&#39;m trying to avoid array formulas that use ctrl shift enter"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1575994428, "post_id": 59270119, "comment_id": 104749914, "body": "Is there a specific reason for <code>$G$1:$H$65536</code> instead of <code>$G:$H</code>?  65536 was the maximum number of rows in <code>.xls</code> files (it is now 1048576 in <code>.xlsx</code> / <code>.xlsm</code> files), so is this just copy/paste from an old document?"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1575991226, "creation_date": 1575991226, "answer_id": 59270432, "question_id": 59270119, "link": "https://stackoverflow.com/questions/59270119/vlookup-return-only-2nd-instance/59270432#59270432", "title": "Vlookup, return only 2nd instance", "body": "<p>This is a non CSE array formula, it is entered normally:</p>\n\n<pre><code>=IFERROR(IFERROR(INDEX(Sheet1!$H:$H,AGGREGATE(15,7,ROW(Sheet1!$G$1:INDEX(Sheet1!$G:$G,MATCH(\"zzz\",Sheet1!$G:$G)))/(Sheet1!$G$1:INDEX(Sheet1!$G:$G,MATCH(\"zzz\",Sheet1!$G:$G))=$H2&amp;$I2),COLUMN(A:A))),INDEX(Sheet1!$L:$L,AGGREGATE(15,7,ROW(Sheet1!$K$1:INDEX(Sheet1!$K:$K,MATCH(\"zzz\",Sheet1!$K:$K)))/(Sheet1!$K$1:INDEX(Sheet1!$K:$K,MATCH(\"zzz\",Sheet1!$K:$K))=$H2&amp;$I2),COLUMN(A:A)-COUNTIF(Sheet1!$G:$G,$H2&amp;$I2)))),\"\")\n</code></pre>\n\n<p>Put this in the first cell and copy over till you get blanks.</p>\n\n<p>This is untested.</p>\n"}], "owner": {"reputation": 39, "user_id": 6849830, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QiFwTLfajzc/AAAAAAAAAAI/AAAAAAAAABU/ZHHA0Bvc8fQ/photo.jpg?sz=128", "display_name": "Alex Ross", "link": "https://stackoverflow.com/users/6849830/alex-ross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 59270432, "answer_count": 1, "score": 0, "last_activity_date": 1575991226, "creation_date": 1575990135, "last_edit_date": 1575990428, "question_id": 59270119, "link": "https://stackoverflow.com/questions/59270119/vlookup-return-only-2nd-instance", "title": "Vlookup, return only 2nd instance", "body": "<p>Here is my formula currently (which works as is), it returns only the first instance, I would like to have a second column that returns only the second instance of the referenced cell (if there is no second reference than it should return blank).                                                              </p>\n\n<pre><code>=IFERROR(VLOOKUP(H2&amp;I2,Sheet1!G$1:H$65536,2,0),VLOOKUP(H2&amp;I2,Sheet1!K$1:L$65536,2,0))\n</code></pre>\n\n<p>Ideally I need it to return the 3rd and 4th instance as well, but in a separate column without using an array formula, just a new formula.</p>\n"}, {"tags": ["vba", "combobox", "listbox", "userform"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1575990016, "post_id": 59270053, "comment_id": 104747293, "body": "Did you try dimming <code>MyVal</code> as a <code>Variant</code> and using <code>.List</code> ?"}, {"owner": {"reputation": 21, "user_id": 11867933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b3808c239e596200c115f46ea8ea6dc?s=128&d=identicon&r=PG", "display_name": "blowcake", "link": "https://stackoverflow.com/users/11867933/blowcake"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1575990448, "post_id": 59270053, "comment_id": 104747538, "body": "Adding .List to what object?"}, {"owner": {"reputation": 21, "user_id": 11867933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b3808c239e596200c115f46ea8ea6dc?s=128&d=identicon&r=PG", "display_name": "blowcake", "link": "https://stackoverflow.com/users/11867933/blowcake"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1575990611, "post_id": 59270053, "comment_id": 104747627, "body": "By the way: It seems that before passing the MyVal to the ComboBox1, the program is running the &quot;Sub UserForm1_Initialize()&quot; again. At the end (I guess when it actually tries to pass the value) it crashes. Why would it initialize again? I don&#39;t unload/close UserForm1."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1576088116, "post_id": 59270053, "comment_id": 104788306, "body": "Posted an answer to your UserForm re-initializing issue based on @MathieuGuindon &#39;s fundamental article &quot;UserForm1.Show?&quot; and his numerous posts on Stack Overflow; hopefully to contribute to further understanding for at least these SO readers facing the same issue :-)"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 11867933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b3808c239e596200c115f46ea8ea6dc?s=128&d=identicon&r=PG", "display_name": "blowcake", "link": "https://stackoverflow.com/users/11867933/blowcake"}, "edited": false, "score": 0, "creation_date": 1575990419, "post_id": 59270153, "comment_id": 104747521, "body": "I have tried that before and it didn&#39;t seem to help, I&#39;m afraid..."}, {"owner": {"reputation": 128, "user_id": 12195276, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xkJTbt3sa_M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rceWScWVfOMzwJOwm-w9LM8na_Aqg/photo.jpg?sz=128", "display_name": "tomBob", "link": "https://stackoverflow.com/users/12195276/tombob"}, "reply_to_user": {"reputation": 21, "user_id": 11867933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b3808c239e596200c115f46ea8ea6dc?s=128&d=identicon&r=PG", "display_name": "blowcake", "link": "https://stackoverflow.com/users/11867933/blowcake"}, "edited": false, "score": 0, "creation_date": 1575990467, "post_id": 59270153, "comment_id": 104747550, "body": "Do you get the error on the line with <code>UserForm1.ComboBox1 = MyVal</code>"}, {"owner": {"reputation": 21, "user_id": 11867933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b3808c239e596200c115f46ea8ea6dc?s=128&d=identicon&r=PG", "display_name": "blowcake", "link": "https://stackoverflow.com/users/11867933/blowcake"}, "edited": false, "score": 0, "creation_date": 1575990676, "post_id": 59270153, "comment_id": 104747668, "body": "See above for some details. That is exactly the error line."}], "tags": [], "owner": {"reputation": 128, "user_id": 12195276, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xkJTbt3sa_M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rceWScWVfOMzwJOwm-w9LM8na_Aqg/photo.jpg?sz=128", "display_name": "tomBob", "link": "https://stackoverflow.com/users/12195276/tombob"}, "is_accepted": false, "score": 0, "last_activity_date": 1575990260, "creation_date": 1575990260, "answer_id": 59270153, "question_id": 59270053, "link": "https://stackoverflow.com/questions/59270053/populating-a-combobox-using-a-listbox-from-a-second-userform/59270153#59270153", "title": "Populating a ComboBox using a ListBox from a second UserForm", "body": "<p>You select data from a listbox using the <code>Column</code> property. Starting at 0.</p>\n\n<pre><code>MyVal = ListBox.Column(0) 'This will store the data in the first column of the selected row\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1576087228, "last_edit_date": 1576087228, "creation_date": 1576086539, "answer_id": 59291421, "question_id": 59270053, "link": "https://stackoverflow.com/questions/59270053/populating-a-combobox-using-a-listbox-from-a-second-userform/59291421#59291421", "title": "Populating a ComboBox using a ListBox from a second UserForm", "body": "<p><strong>Refresh Combobox using listbox from second Userform</strong></p>\n\n<blockquote>\n  <p><em>\"It seems that before passing the MyVal to the ComboBox1, the program is running the \"Sub UserForm1_Initialize()\" again.\"</em></p>\n</blockquote>\n\n<p>Apart from some typos (regarding both <code>UserForm_Initiate</code> syntaxes) your main issue is that by invoking the default instance of a(n existing) userform you get it reinstanciated. Especially trying to assign a value by referencing another userform's default instance (see UserForm2's code module) via </p>\n\n<pre><code>    UserForm1.ComboBox1 = MyVal \n</code></pre>\n\n<p>... <strong>re-initializes</strong> the default instance of UserForm1 and destroys any changes before. </p>\n\n<p><strong>Modified example to understand the way (see code below)</strong></p>\n\n<p>So delete the code line above in the 2nd Userform code module and call an instance of UserForm2 via function <code>YourChoice()</code> in the 1st one returning the found value <code>MyVal</code> as function result in order to stick as close as possible to your post using a \"global\" variable <code>MyVal</code>.  This would allow you to use instances of a UserForm and to get what you wanted. </p>\n\n<p><strong>Further possible steps</strong> - <em>(Not)tl;tr</em></p>\n\n<p>It's good use, however</p>\n\n<ul>\n<li>not only to instantiate a (\"New\") UserForm object instead of calling the form's default instance,</li>\n</ul>\n\n<p>but</p>\n\n<ul>\n<li>to handle its <code>QueryClose</code> event to prevent rash termination,</li>\n<li>to decide upon a UserForm's life time by the calling code (regular or class module),</li>\n<li>to separate model logic (i.e.the data), view (i.e. the form) and presentation, aka MVP design pattern using the advanced possibilities of classes. </li>\n</ul>\n\n<p>Generally you should prefer not to <em>unload</em> within the form's code behind - I didn't change that to leave the example comprehensible, but would recommend to study \u25baMathieu Guindon's outstanding article <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">\"UserForm1.Show?\"</a> for a first insight, better understanding and some ideas on the road. </p>\n\n<p><em>Citation</em></p>\n\n<p>A Userform is not only a <em>class</em>, but disposes of an internal pecularity - or to cite <em>Mathieu</em>: </p>\n\n<blockquote>\n  <p>\"<code>UserForm</code> is a class module: it defines the <em>blueprint</em> of an <em>object</em>. Objects usually want to be instantiated, but then someone had the genius idea of granting all instances of <code>MSForms.UserForm</code> a <em>predeclared ID</em>, which in COM terms means you basically get a global object for free.\" </p>\n</blockquote>\n\n<p><em>c.f. <a href=\"https://stackoverflow.com/questions/47288496/are-there-disadvantages-in-putting-code-into-userforms-instead-of-modules/47291028#47291028\">Disadvantages in putting code into UserForms instead of modules</a></em> </p>\n\n<p><strong>Modified Example code</strong></p>\n\n<ul>\n<li><strong>UserForm1</strong></li>\n</ul>\n\n<pre><code>Option Explicit\n\nSub UserForm_Initialize()             ' &lt;&lt; typo: not UserForm1_Initialize !\n   ComboBox1.AddItem \"Item1\"\n   ComboBox1.AddItem \"Item2\"\n   ComboBox1.AddItem \"Item3\"\nEnd Sub\n\nSub ComboBox1_Click()\n   If ComboBox1 = \"Item3\" Then\n      '''      Load UserForm2          ' &lt;&lt; don't reference the default instance \n      '''      UserForm2.Show          ' &lt;&lt; but\n      ComboBox1.List(2) = yourChoice   '    make it a function call returning your choice\n   End If\nEnd Sub\n</code></pre>\n\n<ul>\n<li><strong>UserForm2</strong></li>\n</ul>\n\n<pre><code>Option Explicit\n\nSub UserForm_Initialize()               ' typo: not UserForm2_Initialize !\n   ListBox1.AddItem \"Apple\"\n   ListBox1.AddItem \"Pear\"\n   ListBox1.AddItem \"Banana\"\nEnd Sub\n\nSub CommandButton1_Click()\n    ' Purpose: assign listbox value to variable (here: global; better: via class property)\n    MyVal = ListBox1                    ' equals ListBox1.List(ListBox1.ListIndex)\n    '''   UserForm1.ComboBox1 = MyVal   ' &lt;&lt; reinitializes the default instance of UF1 !!!\n    Unload Me                           ' (better to make the calling function terminate the form instead)\nEnd Sub\n</code></pre>\n\n<ul>\n<li><strong>Example call</strong></li>\n</ul>\n\n<p><em>Side note:</em> - as close as possible to the OP and sticking to the global variable method as mentioned above to allow better comprehension (consider mentioned suggestions, too :-)</p>\n\n<pre><code>Option Explicit\n\nPublic MyVal As String                  ' here: global variable\n\nSub showMain()\nWith New UserForm1\n    .Show vbModeless ' any mode allowed: 0-vbModeless  or 1-vbModal (default)\nEnd With\nEnd Sub\n\nFunction yourChoice$()\nWith New UserForm2\n    .Show vbModal   ' or simply: .Show to allow a correct return of the function result\nEnd With\nyourChoice = MyVal  ' (a modeless form would execute any code before termination)\nEnd Function\n</code></pre>\n\n<p><strong>Further link</strong>\nThis post doesn't treat modeless forms; calling the 2nd Userform this way would need other logic - see\n<a href=\"https://stackoverflow.com/questions/47357708/vba-destroy-a-modeless-userform-instance-properly\">Destroy a modeless UserForm instance properly</a></p>\n"}], "owner": {"reputation": 21, "user_id": 11867933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b3808c239e596200c115f46ea8ea6dc?s=128&d=identicon&r=PG", "display_name": "blowcake", "link": "https://stackoverflow.com/users/11867933/blowcake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1576087228, "creation_date": 1575989902, "last_edit_date": 1575989943, "question_id": 59270053, "link": "https://stackoverflow.com/questions/59270053/populating-a-combobox-using-a-listbox-from-a-second-userform", "title": "Populating a ComboBox using a ListBox from a second UserForm", "body": "<p>I have a UserForm1 that contains a ComboBox with three items. When item #3 is selected, a new UserForm2 pops up. That UserForm2 contains a ListBox that is populated with many entries from a sheet. I want to be able to select one of those entries in the ListBox and then pass the selected entry from the ListBox to the ComboBox in UserForm1 (using a button in UserForm2).</p>\n\n<p>My simplified code looks like this:</p>\n\n<p>(UserForm1)</p>\n\n<pre><code>Sub UserForm1_Initialize()\n   ComboBox1.AddItem \"Item1\"\n   ComboBox1.AddItem \"Item2\"\n   ComboBox1.AddItem \"Item3\"\nEnd Sub\n\nSub ComboBox1_Click()\n   If ComboBox1 = \"Item3\" Then\n      Load UserForm2\n      UserForm2.show\n   End If\nEnd Sub\n</code></pre>\n\n<p>(UserForm2)</p>\n\n<pre><code>Sub UserForm2_Initialize()\n   ListBox.AddItem \"Apple\"\n   ListBox.AddItem \"Pear\"\n   ListBox.AddItem \"Banana\"\nEnd Sub\n\nSub CommandButton1_Click()\n   MyVal = ListBox                 'using .Value or .Text in this or the next line doesn't help\n   UserForm1.ComboBox1 = MyVal\n   Unload Me\nEnd Sub\n</code></pre>\n\n<p>(Module1)</p>\n\n<pre><code>Public MyVal As String\n</code></pre>\n\n<p>As soon as I click the button to pass the value from the ListBox to the ComboBox1, I get a </p>\n\n<blockquote>\n  <p>\"Runtime '380' - invalid property value\"</p>\n</blockquote>\n\n<p>error.\nAny ideas?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1575988595, "post_id": 59269600, "comment_id": 104746355, "body": "See <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-excel-with-vba\">this question</a> for how to find the last row."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1575988874, "post_id": 59269600, "comment_id": 104746543, "body": "The <i>hacky</i> way would be to use <code>ws.Cells(crng.Rows.Count, crng.Columns.Count)</code>, but highly suggest you don&#39;t do that."}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1575989053, "post_id": 59269600, "comment_id": 104746658, "body": "Are you trying to select from Excel row 3 or the 3rd in the listobject? also if 3rd row counting the header or just the body?"}, {"owner": {"reputation": 2714, "user_id": 843458, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/e600bfa3509ddea2d693514cbe11bbdb?s=128&d=identicon&r=PG", "display_name": "Matthias Pospiech", "link": "https://stackoverflow.com/users/843458/matthias-pospiech"}, "edited": false, "score": 0, "creation_date": 1575989058, "post_id": 59269600, "comment_id": 104746662, "body": "Is it not possible to get the last row  and column from currentregion?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575989069, "post_id": 59269600, "comment_id": 104746670, "body": "It is possible, but not recommended. If your data has no gaps and starts in A1, then try the <code>ws.Cells</code> approach instead of <code>ws.Range</code>."}, {"owner": {"reputation": 2714, "user_id": 843458, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/e600bfa3509ddea2d693514cbe11bbdb?s=128&d=identicon&r=PG", "display_name": "Matthias Pospiech", "link": "https://stackoverflow.com/users/843458/matthias-pospiech"}, "edited": false, "score": 0, "creation_date": 1575989229, "post_id": 59269600, "comment_id": 104746771, "body": "Ok. I know my rows and column count from my variables. so this works for me: <code>Set rng = ws.Range(ws.Range(&quot;A3&quot;), ws.Cells(UBound(data), 10))</code>"}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1575988838, "post_id": 59269695, "comment_id": 104746517, "body": "OP wants all the data, not just row 3."}, {"owner": {"reputation": 2714, "user_id": 843458, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/e600bfa3509ddea2d693514cbe11bbdb?s=128&d=identicon&r=PG", "display_name": "Matthias Pospiech", "link": "https://stackoverflow.com/users/843458/matthias-pospiech"}, "edited": false, "score": 1, "creation_date": 1575988940, "post_id": 59269695, "comment_id": 104746590, "body": "this gives me a table with the complete row (up to the end), and inserts a second row (at 4) which is empty. I want the used region but only from row 3 to the end."}, {"owner": {"reputation": 128, "user_id": 12195276, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xkJTbt3sa_M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rceWScWVfOMzwJOwm-w9LM8na_Aqg/photo.jpg?sz=128", "display_name": "tomBob", "link": "https://stackoverflow.com/users/12195276/tombob"}, "edited": false, "score": 0, "creation_date": 1575989838, "post_id": 59269695, "comment_id": 104747196, "body": "Ah okay, my bad I misunderstood the question. Thanks for clarifying."}], "tags": [], "owner": {"reputation": 128, "user_id": 12195276, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xkJTbt3sa_M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rceWScWVfOMzwJOwm-w9LM8na_Aqg/photo.jpg?sz=128", "display_name": "tomBob", "link": "https://stackoverflow.com/users/12195276/tombob"}, "is_accepted": false, "score": 0, "last_activity_date": 1575988818, "creation_date": 1575988818, "answer_id": 59269695, "question_id": 59269600, "link": "https://stackoverflow.com/questions/59269600/vba-select-table-from-row-3-to-end-for-listobject/59269695#59269695", "title": "vba: select table from row 3 to end for listobject", "body": "<p>You should be able to assign the range just using <code>row(3)</code></p>\n\n<pre><code>Set rng = ws.Rows(3)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2714, "user_id": 843458, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/e600bfa3509ddea2d693514cbe11bbdb?s=128&d=identicon&r=PG", "display_name": "Matthias Pospiech", "link": "https://stackoverflow.com/users/843458/matthias-pospiech"}, "edited": false, "score": 0, "creation_date": 1576132460, "post_id": 59269882, "comment_id": 104801294, "body": "This solution uses <code>xlToRight</code>. in my comment I had used variables. If you add my solution to our answer I can check it."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 2714, "user_id": 843458, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/e600bfa3509ddea2d693514cbe11bbdb?s=128&d=identicon&r=PG", "display_name": "Matthias Pospiech", "link": "https://stackoverflow.com/users/843458/matthias-pospiech"}, "edited": false, "score": 0, "creation_date": 1576148035, "post_id": 59269882, "comment_id": 104808642, "body": "@MatthiasPospiech - I am afk, feel free to edit the <code>xlToRight</code>"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1575989688, "last_edit_date": 1575989688, "creation_date": 1575989376, "answer_id": 59269882, "question_id": 59269600, "link": "https://stackoverflow.com/questions/59269600/vba-select-table-from-row-3-to-end-for-listobject/59269882#59269882", "title": "vba: select table from row 3 to end for listobject", "body": "<p>There are two cases - when a table exists in range \"A3\" or when there is no table there.</p>\n\n<ul>\n<li><strong>When a table exists</strong></li>\n</ul>\n\n<p>I have managed to select from <code>A3</code> to the end of the table with the code below:</p>\n\n<pre><code>Sub TestMe()\n\n    Dim ws As Worksheet\n    Set ws = Worksheets(1)\n\n    Dim myRange As Range\n\n    With ws\n        Set myRange = .Range(.Range(\"A3\"), .Range(\"A3\").End(xlToRight))\n        Set myRange = .Range(myRange, myRange.End(xlDown))\n    End With\n\n    myRange.Select\n    Stop\n    'Uncomment the line below, if there is no table.\n    'ws.ListObjects.Add(xlSrcRange, myRange, , xlYes).Name = \"Eval40\"\nEnd Sub\n</code></pre>\n\n<p>However, if you uncomment the last line of the code, you will see the <code>1004</code> error, which states something like \"A table cannot over lap another table\", which makes sense, as the new table, named <code>Eval40</code> is part of the old table which already exists. </p>\n\n<ul>\n<li><strong>When a table does not exist</strong>\nIf there is no existing table at the range, then it works ok:</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/q5jPw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/q5jPw.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 2714, "user_id": 843458, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/e600bfa3509ddea2d693514cbe11bbdb?s=128&d=identicon&r=PG", "display_name": "Matthias Pospiech", "link": "https://stackoverflow.com/users/843458/matthias-pospiech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1575989688, "creation_date": 1575988518, "question_id": 59269600, "link": "https://stackoverflow.com/questions/59269600/vba-select-table-from-row-3-to-end-for-listobject", "title": "vba: select table from row 3 to end for listobject", "body": "<p>Selecting a whole sheet for a listobject is done this way</p>\n\n<pre><code>ws.ListObjects.Add(xlSrcRange, Range(\"$A$1\").CurrentRegion, , xlYes).Name = \"Cost\"\n</code></pre>\n\n<p>But now I want the same but starting with row number 3:</p>\n\n<pre><code>Dim rng As Range\nDim crng As Range\nSet crng = ws.Range(\"$A$1\").CurrentRegion\nSet rng = ws.Range(ws.Range(\"A3\"), ws.Range(crng.Columns, crng.Rows))\n\nws.ListObjects.Add(xlSrcRange, rng, , xlYes).Name = \"Eval\"\n</code></pre>\n\n<p>But this also selects the whole range.\nHow can I choose the correct range?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13, "user_id": 10896304, "user_type": "registered", "profile_image": "https://graph.facebook.com/2246498138728066/picture?type=large", "display_name": "Marc", "link": "https://stackoverflow.com/users/10896304/marc"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575988634, "post_id": 59269482, "comment_id": 104746388, "body": "Hi Ben, to be honest I dont know what is incorrect about the indentation :("}, {"owner": {"reputation": 13, "user_id": 10896304, "user_type": "registered", "profile_image": "https://graph.facebook.com/2246498138728066/picture?type=large", "display_name": "Marc", "link": "https://stackoverflow.com/users/10896304/marc"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575989018, "post_id": 59269482, "comment_id": 104746641, "body": "fixed! Thank you :) Still waiting for any help thought :D"}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1575989096, "post_id": 59269482, "comment_id": 104746689, "body": "whats the value of cell.value in <code>Path &amp; cell.Value &amp; d &amp; &quot;-NBTReport.xls&quot;</code> when it crashs ?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1575989354, "post_id": 59269482, "comment_id": 104746860, "body": "I suggest you move <code>Set OutApp = CreateObject(&quot;Outlook.Application&quot;)</code> and <code>OutApp.Session.Logon</code> outside the loop."}, {"owner": {"reputation": 13, "user_id": 10896304, "user_type": "registered", "profile_image": "https://graph.facebook.com/2246498138728066/picture?type=large", "display_name": "Marc", "link": "https://stackoverflow.com/users/10896304/marc"}, "edited": false, "score": 0, "creation_date": 1575989354, "post_id": 59269482, "comment_id": 104746861, "body": "That is the name of the project. One cell on the right we have the email of the person that should get specific file."}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1575989529, "post_id": 59269482, "comment_id": 104746986, "body": "and does that particular file exists ? maybe the name is not equal"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1575989716, "post_id": 59269482, "comment_id": 104747104, "body": "Try this. Replace the line <code>.Display</code> with <code>DoEvents</code> and now try it."}], "owner": {"reputation": 13, "user_id": 10896304, "user_type": "registered", "profile_image": "https://graph.facebook.com/2246498138728066/picture?type=large", "display_name": "Marc", "link": "https://stackoverflow.com/users/10896304/marc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 251, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575989376, "creation_date": 1575988139, "last_edit_date": 1575989376, "question_id": 59269482, "link": "https://stackoverflow.com/questions/59269482/run-time-error-440-the-object-does-not-support-this-method", "title": "Run-time error \u201c440\u201d: The object does not support this method", "body": "<p>I try to send multiple emails with attachements. The macro crashes with the error 440, by the line of .Send . Sometimes it crashes after 50 sent emails, sometimes after 30, 80, 100. What can be wrong?</p>\n\n<p>Is it problem connected with Outlook, Excel, security settings?</p>\n\n<p>I havent found any solution regarding this problem on any site.</p>\n\n<pre><code>Set rangepro = Worksheets(\"Mappings\").Range(\"f2:f\" &amp; rangeprojects)\n\nFor Each cell In rangepro                        'loops every project in rangepro, this name is used later in the filter to generate the files\n\n    Worksheets(\"27a Report\").Range(\"A1:au\" &amp; range27a).AutoFilter Field:=1, Criteria1:=cell.Value\n\n    'Select only the visible cells in active sheet\n    Worksheets(\"27a Report\").Select\n    Cells.Select\n    Selection.SpecialCells(xlCellTypeVisible).Select\n    Selection.Copy\n\n    '~~&gt; Source/Input Workbook\n    Set wbI = ThisWorkbook\n    '~~&gt; Set the relevant sheet from where you want to copy\n    'Set wsI = wbI.Sheets(\"Sheet1\")\n    Set wbO = Workbooks.Add\n\n    With wbO\n\n        Set wsO = wbO.Sheets(\"Sheet1\")\n\n        ActiveSheet.Name = \"27a Report\"\n\n        wsO.Range(\"A1\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, _\n                                     SkipBlanks:=False, Transpose:=False\n\n        Call GeneratePivots.CreatePivot1\n\n        Call checkiftravel\n\n        ActiveWorkbook.CheckCompatibility = False\n\n        Application.DisplayAlerts = False\n\n        Path = \"\\\\wrofs1\\sd&amp;m\\OnePMO\\01.Services\\03.Operations\\05.Industrialization\\Tools\\27a\\\" &amp; f &amp; d &amp; \"\\\"\n\n        .SaveAs Filename:=Path &amp; cell.Value &amp; d &amp; \"-NBTReport.xls\", FileFormat:=56\n\n        .Close\n\n        'send the email\n        eSubject = Worksheets(\"Mail\").Range(\"c2\").Value\n        eBody = Worksheets(\"Mail\").Range(\"c5\").Value\n        eOnBehalf = Worksheets(\"Mail\").Range(\"c26\").Value\n        'eAttach = Range(\"f27\").Value\n\n        Set OutApp = CreateObject(\"Outlook.Application\")\n        OutApp.Session.Logon\n        Set OutMail = OutApp.CreateItem(0)\n\n        With OutMail\n            .SentOnBehalfOfName = eOnBehalf\n            .To = cell.Offset(0, 1)\n            '.cc = ccAll\n            .Subject = eSubject\n            .body = eBody\n            '.Attachments.Add eAttach\n            .Attachments.Add Path &amp; cell.Value &amp; d &amp; \"-NBTReport.xls\"\n            .Display\n            .Send\n        End With\n\n    End With\n\nNext cell\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user12306228"}, "edited": false, "score": 0, "creation_date": 1575987627, "post_id": 59269266, "comment_id": 104745772, "body": "Hi here is the entire code, edited my post."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575987693, "post_id": 59269266, "comment_id": 104745811, "body": "Well why does <code>i = 1</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user12306228"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575987758, "post_id": 59269266, "comment_id": 104745851, "body": "I don&#39;t know what that means."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575987866, "post_id": 59269266, "comment_id": 104745902, "body": "<code>i</code> is used as the row number. Why do you have <code>i = 1</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user12306228"}, "edited": false, "score": 0, "creation_date": 1575987925, "post_id": 59269266, "comment_id": 104745933, "body": "so if I change it to i = 4, it will write it into C4? got the code from the internet, so I don&#39;t know why i=1"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1575987959, "post_id": 59269266, "comment_id": 104745964, "body": "Test it, and you&#39;ll see what the line <code>Cells(i, &quot;C&quot;).Value = text_line</code> does. Highly suggest that you make an attempt to understand what the code is doing. If it helps, <code>F8</code> to step through the code."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user12306228"}, "edited": false, "score": 0, "creation_date": 1575989615, "post_id": 59269701, "comment_id": 104747048, "body": "Almost works, I still have one problem. The textfile has multiple lines. This code posts everything in C4. I would like to have 1 line in the textfile = 1 row in Excel. Do you know what I mean?"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 2, "last_activity_date": 1575990094, "last_edit_date": 1575990094, "creation_date": 1575988827, "answer_id": 59269701, "question_id": 59269266, "link": "https://stackoverflow.com/questions/59269266/how-to-transfer-data-from-a-text-file-to-a-specific-cell-in-excel-via-vba/59269701#59269701", "title": "How to transfer data from a text file to a specific cell in Excel via VBA?", "body": "<ul>\n<li><strong>Wrtiting the whole file starting from a certain cell C4 and going down with every line</strong></li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/1bW57.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1bW57.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub TestMe()\n\n    Dim myFile As Long\n    Dim textLine As String\n    Dim fileName As String\n\n    fileName = \"C:\\Users\\\" &amp; Environ(\"Username\") &amp; \"\\Desktop\\Test.txt\"\n\n    myFile = FreeFile()\n    Open fileName For Input As myFile\n\n    Dim writing As String\n    Dim i As Long: i = 4\n    While Not EOF(myFile)\n        Line Input #myFile, textLine\n        Worksheets(1).Cells(i, \"C\").Value = textLine\n        i = i + 1\n    Wend\n\nEnd Sub\n</code></pre>\n\n<ul>\n<li><strong>Wrtiting the whole file to a single cell</strong></li>\n</ul>\n\n<p>This one takes all the lines from the <code>Test.txt</code> and writes them into <code>Range(\"C4\")</code> of the first worksheet:</p>\n\n<pre><code>Sub TestMe()\n\n    Dim myFile As Long\n    Dim textLine As String\n    Dim fileName As String\n\n    fileName = \"C:\\Users\\\" &amp; Environ(\"Username\") &amp; \"\\Desktop\\Test.txt\"\n\n    myFile = FreeFile()\n    Open fileName For Input As myFile\n\n    Dim writing As String\n\n    While Not EOF(myFile)\n        Line Input #myFile, textLine\n        writing = writing &amp; vbCrLf &amp; textLine\n    Wend\n\n    Worksheets(1).Cells(4, \"C\").Value = writing        \n\nEnd Sub\n</code></pre>\n\n<p>It is done through the loop:</p>\n\n<pre><code>While Not EOF(myFile)\n    Line Input #myFile, textLine\n    writing = writing &amp; vbCrLf &amp; textLine\nWend\n</code></pre>\n\n<p>which writes every line to the variable <code>writing</code>, adding a new line whenever needed (<code>VbCrLf</code> is the new line). At the end <code>Worksheets(1).Cells(4, \"C\").Value = writing</code> writes the text of the file to the worksheet at <code>C4</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user12306228"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 1, "accepted_answer_id": 59269701, "answer_count": 1, "score": -4, "last_activity_date": 1575990094, "creation_date": 1575987437, "last_edit_date": 1575987676, "question_id": 59269266, "link": "https://stackoverflow.com/questions/59269266/how-to-transfer-data-from-a-text-file-to-a-specific-cell-in-excel-via-vba", "title": "How to transfer data from a text file to a specific cell in Excel via VBA?", "body": "<p>I have this code which transfers data from a textfile to an Excel sheet into column C.\nHere is a code snippet.</p>\n\n<pre><code>Dim my_file As Integer\nDim text_line As String\nDim file_name As String\nDim i As Integer\n\nfile_name = \"C:\\Users\\\" &amp; Environ(\"Username\") &amp; \"\\Desktop\\Test.txt\"\n\nmy_file = FreeFile()\nOpen file_name For Input As my_file\n\ni = 1\n\nWhile Not EOF(my_file)\n    Line Input #my_file, text_line\n    Cells(i, \"C\").Value = text_line\n    i = i + 1\nWend\n</code></pre>\n\n<p>But I want to transfer the data to C4.\nHow can I tweak the code to achieve my objective?</p>\n"}, {"tags": ["excel", "vba", "copy"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1575986886, "post_id": 59269049, "comment_id": 104745331, "body": "Please include your code attempt in your question."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 12511579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aae781cc694fff547f0caeead0e5b25e?s=128&d=identicon&r=PG&f=1", "display_name": "Dan B", "link": "https://stackoverflow.com/users/12511579/dan-b"}, "edited": false, "score": 0, "creation_date": 1575993742, "post_id": 59270193, "comment_id": 104749476, "body": "Thank you so much for this @PeterT!   However, I&#39;m getting a &quot;Run-time Error - 9 - Subscript out of range&quot; when setting &quot;balancesWB&quot;:     Set balancesWS = enrolmentWB.Sheets(&quot;Account Balances&quot;)  I have literally copy-pasted the sheet name into the brackets to no avail :("}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 23, "user_id": 12511579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aae781cc694fff547f0caeead0e5b25e?s=128&d=identicon&r=PG&f=1", "display_name": "Dan B", "link": "https://stackoverflow.com/users/12511579/dan-b"}, "edited": false, "score": 0, "creation_date": 1575997526, "post_id": 59270193, "comment_id": 104751611, "body": "I would try to rename the sheet itself to something (&quot;<code>junk</code>&quot; maybe), then rename it again back to &quot;<code>Account Balances</code>&quot;. Smells like there&#39;s a hidden character somewhere. Also, I&#39;m assuming you typed in your comment by hand rather than copy-pasting from your code. In my example there is no <code>balancesWB</code> and your <code>enrolmentWB</code> name is mis-spelled (should have two lowercase &quot;L&quot;s)"}, {"owner": {"reputation": 23, "user_id": 12511579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aae781cc694fff547f0caeead0e5b25e?s=128&d=identicon&r=PG&f=1", "display_name": "Dan B", "link": "https://stackoverflow.com/users/12511579/dan-b"}, "edited": false, "score": 0, "creation_date": 1576069583, "post_id": 59270193, "comment_id": 104778152, "body": "My sincerest apologies PeterT, I must have been tired last night... Your code was perfect. Firstly I didn&#39;t enter the specific path to &quot;Enrollment Database.xlsm&quot; and secondly I gave you the wrong Cell reference for Term Name, it should have been H2. Could I ask one more thing, if I already have the Enrollment Database.xlsm workbook open how do I reference it without running the &#39;Workbooks.Open()&#39; code? Cheers in advance."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 23, "user_id": 12511579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aae781cc694fff547f0caeead0e5b25e?s=128&d=identicon&r=PG&f=1", "display_name": "Dan B", "link": "https://stackoverflow.com/users/12511579/dan-b"}, "edited": false, "score": 1, "creation_date": 1576073173, "post_id": 59270193, "comment_id": 104780269, "body": "I added code from my own library based on <a href=\"https://stackoverflow.com/a/9382034/4717755\">this answer</a> that, given a full path to a workbook, will either open the workbook or return the currently open workbook. There is an optional <code>ByRef</code> parameter you can check to determine if it was already open, so you can conditionally close it when you&#39;re finished."}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 1, "last_activity_date": 1576073035, "last_edit_date": 1576073035, "creation_date": 1575990400, "answer_id": 59270193, "question_id": 59269049, "link": "https://stackoverflow.com/questions/59269049/copy-invoice-total-to-correlating-customers-account-balance/59270193#59270193", "title": "Copy Invoice Total to correlating customers Account Balance", "body": "<p>Here's an example of how you can copy the invoice data to your balances sheet. The important things in this example are:</p>\n\n<ol>\n<li><a href=\"https://www.excel-easy.com/vba/examples/option-explicit.html\" rel=\"nofollow noreferrer\">Always use <code>Option Explicit</code></a></li>\n<li>Declare and use intermediate variables. This greatly helps to focus your work on exactly which workbook, worksheet, and information you're focused on for that part of the code logic. As an example, define both your current workbook and the enrollment workbooks separately. This way you don't have to continually work with a long hierarchy of references.</li>\n</ol>\n\n<p>So don't do this:</p>\n\n<pre><code>Workbooks(\"Master Invoice.xlsm\").Worksheets(\"Master Invoice\").Range(\"j40\").Copy\nWorkbooks(\"Enrolment Database.xlsm\").Worksheets(\"Account Balances\").Range(Cells(\"A2:A150\", \"B1:E1\").Address).PasteSpecial Paste:=xlPasteValues  \n</code></pre>\n\n<p>Do this:</p>\n\n<pre><code>Dim invoiceWS As Worksheet\nSet invoiceWS = ThisWorkbook.Sheets(\"Master Invoice\")\n\nDim enrollmentWB As Workbook\nDim balancesWS As Worksheet\nSet enrollmentWB = Workbooks.Open(\"Enrollment Database.xlsm\")\nSet balancesWS = enrollmentWB.Sheets(\"Account Balances\")\n</code></pre>\n\n<p>Here is the whole example as a single sub. Notice the error checking to keep your code from crashing and how the variable names self-document the code logic.</p>\n\n<pre><code>Option Explicit\n\nSub AddToAccounts_Click()\n    Dim invoiceWS As Worksheet\n    Set invoiceWS = ThisWorkbook.Sheets(\"Master Invoice\")\n\n    '--- collect the data on the current invoice\n    Dim customer As String\n    Dim currentInvoice As Double\n    Dim currentTerm As String\n    With invoiceWS\n        customer = .Range(\"G10\").Value\n        currentTerm = .Range(\"H1\").Value\n        currentInvoice = .Range(\"J40\").Value\n    End With\n\n    Dim enrollmentWB As Workbook\n    Dim balancesWS As Worksheet\n    Dim enrollmentWBWasOpen As Boolean\n    Set enrollmentWB = ThisWorkbook\n    'Set enrollmentWB = GetWorkbook(\"C:\\Temp\\Enrollment Database.xlsm\", _\n                                    enrollmentWBWasOpen)\n    Set balancesWS = enrollmentWB.Sheets(\"Account Balances\")\n\n    '--- find the row with that holds the current customer's invoices\n    Dim customerBalances As Range\n    Set customerBalances = balancesWS.Range(\"A:A\").Find(What:=customer)\n    If customerBalances Is Nothing Then\n        MsgBox \"ERROR: Customer not found! (\" &amp; customer &amp; \")\"\n        '--- optional??\n        If Not enrollmentWBWasOpen Then\n            enrollmentWB.Close\n        End If\n        Exit Sub\n    End If\n\n    '--- now find the column that matches the term\n    Dim term As Range\n    Set term = balancesWS.Range(\"1:1\").Find(What:=currentTerm)\n    If term Is Nothing Then\n        MsgBox \"ERROR: Current term not found! (\" &amp; currentTerm &amp; \")\"\n        '--- optional??\n        If Not enrollmentWBWasOpen Then\n            enrollmentWB.Close\n        End If\n        Exit Sub\n    End If\n\n    '--- copy the invoice value\n    balancesWS.Cells(customerBalances.Row, term.Column).Value = currentInvoice\n\n    If Not enrollmentWBWasOpen Then\n        enrollmentWB.Close\n    End If\n\nEnd Sub\n\nPublic Function GetWorkbook(ByVal sFullName As String, _\n                            Optional ByRef wasAlreadyOpen As Boolean) As Workbook\n    '--- credit to: https://stackoverflow.com/a/9382034/4717755\n    Dim sFile As String\n    Dim wbReturn As Workbook\n\n    sFile = Dir(sFullName)\n\n    On Error Resume Next\n        Set wbReturn = Workbooks(sFile)\n\n        If wbReturn Is Nothing Then\n            Set wbReturn = Workbooks.Open(sFullName)\n            wasAlreadyOpen = False\n        Else\n            wasAlreadyOpen = True\n        End If\n    On Error GoTo 0\n\n    Set GetWorkbook = wbReturn\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 12511579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aae781cc694fff547f0caeead0e5b25e?s=128&d=identicon&r=PG&f=1", "display_name": "Dan B", "link": "https://stackoverflow.com/users/12511579/dan-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 59270193, "answer_count": 1, "score": 2, "last_activity_date": 1582145958, "creation_date": 1575986798, "last_edit_date": 1582145958, "question_id": 59269049, "link": "https://stackoverflow.com/questions/59269049/copy-invoice-total-to-correlating-customers-account-balance", "title": "Copy Invoice Total to correlating customers Account Balance", "body": "<p>I am creating a new invoicing system for my small business.</p>\n\n<p>I need a button that copies the current invoice total from a Master Invoice workbook to the Account Balances workbook under the corresponding Customer Name and Term Name.</p>\n\n<p>In the Master Invoice workbook I have the Customer Name (Cell G10), what School Term it relates to (Cell H2) and the Total Invoice Amount.</p>\n\n<p>In the Enrolment Database workbook I have a sheet called Account Balances. Column A contains each Customer Name and row 1 contains the School Term Names (Term 1 Invoice, Term 2 Invoice, etc.).</p>\n\n<p>When the \"Add to Account Balance\" button is pressed I want Excel to find the current Customer Name and Term (x) Invoice in the Master Invoice and copy the Invoice Total to corresponding Cell in the Enrolment Database workbook.</p>\n\n<p>Example: TEST TESTINGTON's Term 1 Invoice comes to $90. When I press my button it copies that $90 and pastes it in Cell B3 because that is the intersection of TEST TESTINGTON (Customer Name) and Term 1 Invoice (Term Name)</p>\n\n<p>Master Invoice notes</p>\n\n<p><a href=\"https://i.stack.imgur.com/ijOdj.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ijOdj.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Enrollment Database notes</p>\n\n<p><a href=\"https://i.stack.imgur.com/UxnsW.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UxnsW.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Here is the latest code but I've never got it remotely working</p>\n\n<pre><code>Private Sub AddToAccounts_Click()  \n    Workbooks(\"Master Invoice.xlsm\").Worksheets(\"Master Invoice\").Range(\"j40\").Copy\n    Workbooks(\"Enrolment Database.xlsm\").Worksheets(\"Account Balances\").Range(Cells(\"A2:A150\", \"B1:E1\").Address).PasteSpecial Paste:=xlPasteValues  \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1575985086, "post_id": 59268474, "comment_id": 104744294, "body": "Please include your code attempt in your question."}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 3523992, "user_type": "registered", "profile_image": "https://graph.facebook.com/655237197/picture?type=large", "display_name": "user3523992", "link": "https://stackoverflow.com/users/3523992/user3523992"}, "is_accepted": false, "score": 0, "last_activity_date": 1576143113, "creation_date": 1576143113, "answer_id": 59301474, "question_id": 59268474, "link": "https://stackoverflow.com/questions/59268474/if-statement-for-active-row-worksheet-change/59301474#59301474", "title": "IF Statement For Active Row (worksheet_change)", "body": "<p>Solved the main question with below code:</p>\n\n<p>But still struggling with top row, if activecell = row 1 then exitsub.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf ActiveCell.Column &lt;&gt; 11 Then\n    Exit Sub\n        Else\nIf ActiveCell.Offset(-1, -1).Value &gt; 0 And ActiveCell.Offset(-1, -1).Value &lt;= 3 Then\n    MsgBox \"Your selected value are low\", vbInformation\n     Exit Sub\nElseIf ActiveCell.Offset(-1, -1).Value &gt;= 3.1 Then\n    MsgBox \"your selected value are to low.\" &amp; vbCrLf &amp; \"The value will automatically be set to minimum.\", vbCritical\n        ActiveCell.Offset(-1, 0).Value = ActiveCell.Offset(-1, -2).Value\nEnd If\nEnd If\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 13, "user_id": 3523992, "user_type": "registered", "profile_image": "https://graph.facebook.com/655237197/picture?type=large", "display_name": "user3523992", "link": "https://stackoverflow.com/users/3523992/user3523992"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576143113, "creation_date": 1575984966, "last_edit_date": 1575988579, "question_id": 59268474, "link": "https://stackoverflow.com/questions/59268474/if-statement-for-active-row-worksheet-change", "title": "IF Statement For Active Row (worksheet_change)", "body": "<p>I have an Excel template with an table where I calculate a couple of recommended values (Column I, J &amp; K). Then the user selects the value they want from an data validation dropdown-list in (Column L).</p>\n\n<p>If the user selects a value that are &lt;= 6 units from the min recommended value I would like to show a message box just telling that \"your selected value are low\", and just continue without action.</p>\n\n<p>And if the user selects a value that are &lt; 3 units from the min recommended value I would to show a message box telling that \"your selected value are to low, select another value\" and clear the active cell where they select their values.</p>\n\n<ul>\n<li>Column I = Recommendation</li>\n<li>Column J = Deviation from the recommendation &lt;= 6</li>\n<li>Column K = Deviation from the recommendation &lt; 3</li>\n<li>Column L = User selection</li>\n</ul>\n\n<p><strong>So dream scenario would be:</strong></p>\n\n<ol>\n<li><p>User selects a value that are > 6 units from recommendation, do nothing</p></li>\n<li><p>User selects a value that are &lt;= 6 units from the recommendation, reminder that they are close</p></li>\n<li><p>User selects a value that are &lt; 3 units from the recommendation, clear the users selection and tell them to select a greater value.</p>\n\n<p>Private Sub worksheet_change(ByVal target As Integer)\n    Dim target As Integer</p>\n\n<pre><code>For target = 2 To 1000\n    If Cells(target, 12).Value &lt;= Cells(target, 9).Value Then\n    MsgBox (\"Your selection are close to the recomandation\")\n        ElseIf Cells(target, 12).Value &lt; Cells(target, 11).Value Then\n        MsgBox (\"Your selection are to low, pick a higher value\")\n        ActiveCell.Clear\n            Else: exitsub\n            End If\n</code></pre>\n\n<p>End Sub</p></li>\n</ol>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575984346, "post_id": 59268257, "comment_id": 104743818, "body": "I assume the newly opened workbook becomes the <code>ActiveWorkbook</code>."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1575984699, "post_id": 59268257, "comment_id": 104744021, "body": "You know you can get the value from the excel file without even <a href=\"https://stackoverflow.com/questions/9259862/executeexcel4macro-to-get-value-from-closed-workbook/9261915#9261915\">opening</a> it?"}, {"owner": {"reputation": 33, "user_id": 11045261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b79742e6b101c5428aeb4604bf842fef?s=128&d=identicon&r=PG&f=1", "display_name": "J. Hill", "link": "https://stackoverflow.com/users/11045261/j-hill"}, "edited": false, "score": 0, "creation_date": 1575991635, "post_id": 59268257, "comment_id": 104748239, "body": "That only works if I have a filepath, which I don&#39;t, since the file isn&#39;t on my PC."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 11045261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b79742e6b101c5428aeb4604bf842fef?s=128&d=identicon&r=PG&f=1", "display_name": "J. Hill", "link": "https://stackoverflow.com/users/11045261/j-hill"}, "edited": false, "score": 0, "creation_date": 1575991558, "post_id": 59269862, "comment_id": 104748201, "body": "There is no file path. The file isn&#39;t stored on my PC. It&#39;s through the link."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576011478, "post_id": 59269862, "comment_id": 104757539, "body": "Just a side note: <code>Set Wb2 = Workbooks(ActiveWorkbook.Name)</code> can be simplified to <code>Set Wb2 = ActiveWorkbook</code>."}, {"owner": {"reputation": 33, "user_id": 11045261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b79742e6b101c5428aeb4604bf842fef?s=128&d=identicon&r=PG&f=1", "display_name": "J. Hill", "link": "https://stackoverflow.com/users/11045261/j-hill"}, "edited": false, "score": 0, "creation_date": 1576153876, "post_id": 59269862, "comment_id": 104811686, "body": "Hello, thanks for the answer. Unfortunately, it didn&#39;t work. It gives a &quot;subscript out of range&quot; error on this line: <code>Set Sh2 = Wb2.Sheets(&quot;ZACSAANA&quot;)</code> I think that happens because the FollowHyperlink command doesn&#39;t seem to execute until AFTER the sub has run, so the lines of code after FollowHyperlink can&#39;t access it."}, {"owner": {"reputation": 1, "user_id": 10387702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f041c16dcb24954334bcfbb5f31186d9?s=128&d=identicon&r=PG&f=1", "display_name": "KH808", "link": "https://stackoverflow.com/users/10387702/kh808"}, "edited": false, "score": 0, "creation_date": 1576159644, "post_id": 59269862, "comment_id": 104814949, "body": "Have you tried stepping through your code and pausing after the FollowHyperLink command to see if Wb2 loads?"}, {"owner": {"reputation": 33, "user_id": 11045261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b79742e6b101c5428aeb4604bf842fef?s=128&d=identicon&r=PG&f=1", "display_name": "J. Hill", "link": "https://stackoverflow.com/users/11045261/j-hill"}, "edited": false, "score": 0, "creation_date": 1576160589, "post_id": 59269862, "comment_id": 104815536, "body": "Yes I tried that, and it doesn&#39;t load after the FollowHyperlink command. It only seems to load once the sub has ended. Very strange, but I guess that&#39;s how FollowHyperlink works?"}, {"owner": {"reputation": 1, "user_id": 10387702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f041c16dcb24954334bcfbb5f31186d9?s=128&d=identicon&r=PG&f=1", "display_name": "KH808", "link": "https://stackoverflow.com/users/10387702/kh808"}, "edited": false, "score": 0, "creation_date": 1576161159, "post_id": 59269862, "comment_id": 104815908, "body": "Next, I&#39;d try splitting your code. One procedure to open the target workbook and another to copy data from it."}, {"owner": {"reputation": 33, "user_id": 11045261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b79742e6b101c5428aeb4604bf842fef?s=128&d=identicon&r=PG&f=1", "display_name": "J. Hill", "link": "https://stackoverflow.com/users/11045261/j-hill"}, "edited": false, "score": 0, "creation_date": 1576506832, "post_id": 59269862, "comment_id": 104911660, "body": "I agree, but how would I do that? I could write it in two separate Subs, but then the user would have to click two separate buttons. Any way to run it all in one?"}, {"owner": {"reputation": 1, "user_id": 10387702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f041c16dcb24954334bcfbb5f31186d9?s=128&d=identicon&r=PG&f=1", "display_name": "KH808", "link": "https://stackoverflow.com/users/10387702/kh808"}, "edited": false, "score": 0, "creation_date": 1576518371, "post_id": 59269862, "comment_id": 104917522, "body": "First step for testing, you&#39;d need a sub that opens the workbook and sub that collects the data from the workbook. If that works out, you can try two separate subs and have the user click a buttons to run the subs individually. Alternatively, you can have a button run a 3rd sub that calls the other two other subs in order."}], "tags": [], "owner": {"reputation": 1, "user_id": 10387702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f041c16dcb24954334bcfbb5f31186d9?s=128&d=identicon&r=PG&f=1", "display_name": "KH808", "link": "https://stackoverflow.com/users/10387702/kh808"}, "is_accepted": false, "score": 0, "last_activity_date": 1575994798, "last_edit_date": 1575994798, "creation_date": 1575989309, "answer_id": 59269862, "question_id": 59268257, "link": "https://stackoverflow.com/questions/59268257/open-a-workbook-using-a-link-and-work-with-it/59269862#59269862", "title": "Open a workbook using a link and work with it", "body": "<p>Try something like this:</p>\n\n<pre><code>Sub RunIt()\nDim Wb As Workbook 'Your Original Workbook\nDim sh As Worksheet 'Sheet where you want to copy to\nDim Sh2 As Worksheet 'Sheet where you're grabbing data from\nDim Wb2 As Workbook 'The Workbook you are opening via hyperlink\n\n    Set Wb = ThisWorkbook\n\n    ActiveWorkbook.FollowHyperlink (\"Your HyperLink\")\n\n    Set Wb2 = Workbooks(ActiveWorkbook.Name)\n\n    Set sh = Wb.sheets(\"Sheet in Wb1\")\n\n\n        With Wb2\n            Set Sh2 = Wb2.sheets(\"Sheet in Wb2\")\n            'Copy values from sh2 to sh1\n\n        End With\n\n    Wb2.Close (False) 'Close Wb2 without saving\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 11045261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b79742e6b101c5428aeb4604bf842fef?s=128&d=identicon&r=PG&f=1", "display_name": "J. Hill", "link": "https://stackoverflow.com/users/11045261/j-hill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575994798, "creation_date": 1575984252, "last_edit_date": 1575984368, "question_id": 59268257, "link": "https://stackoverflow.com/questions/59268257/open-a-workbook-using-a-link-and-work-with-it", "title": "Open a workbook using a link and work with it", "body": "<p>In the code below, I am trying to open an Excel file from another program and copy a value from it. I managed to get the file to open using the FollowHyperlink command, but I cannot refer to the file to copy anything from it. It seems it doesn't actually open the file until the very end of the Sub. Does anyone know how I can refer to the Excel file I'm trying to open so I can copy a value from it? I would really appreciate some help or tips.</p>\n\n<p>Here is the code to open the file: </p>\n\n<pre><code>ActiveWorkbook.FollowHyperlink Address:=\"cdb://byname/classname/document/CDB_View/interactive?zeichnung.z_nummer=D00846554&amp;zeichnung.z_index=01\"\n</code></pre>\n\n<p>How can I add to it so that I can copy a value out of it? </p>\n\n<p>This code doesn't work and gives an error: </p>\n\n<pre><code>ActiveWorkbook.FollowHyperlink Address:=\"cdb://byname/classname/document/CDB_View/interactive?zeichnung.z_nummer=D00846554&amp;zeichnung.z_index=01\"\nWorkbooks(\"D00846554-01.xlsx\").Worksheets(\"ZACSAANA\").Range(\"A1\").Copy ThisWorkbook.Sheets(1).Range(\"A2\")\n</code></pre>\n"}]