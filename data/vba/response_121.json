[{"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 3, "creation_date": 1493859170, "post_id": 43771773, "comment_id": 74585452, "body": "A formula cannot delete a row unless you use it in a &#39;helper&#39; column to identify the rows to be deleted and then manually autofilter on the helper column and manually delete the rows. Abandon the formula solution and build a VBA sub procedure that collects a unique row identifier in a dictionary then use the dictionary keys to autofilter and subsequently delete the rows."}, {"owner": {"reputation": 23, "user_id": 7960264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d209c575dde5fce67cdcb0cde93a5bf?s=128&d=identicon&r=PG&f=1", "display_name": "valmer26", "link": "https://stackoverflow.com/users/7960264/valmer26"}, "edited": false, "score": 0, "creation_date": 1493860100, "post_id": 43771773, "comment_id": 74585669, "body": "Hi Jeeped, thanks for the response. That is actually my initial plan to use these formula as &quot;identifier/helper&quot; to delete the rows. I know this is possible in VBA but I am a beginner in VBA and cannot create this on my own. I have been searching on the web for the any similar case but can&#39;t find any. If you can help me create this then that is greatly appreciated! Thanks :)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1493888152, "post_id": 43771773, "comment_id": 74597013, "body": "You should at least try it yourself, add your code to the question and ask a <i>specific</i> question to your code. Stack Overflow is a question/answer based site and cannot teach you how to code VBA. Therefore you might find appropriate help in a forum where someone can guide you. Reading <a href=\"https://meta.stackoverflow.com/questions/284236/why-is-can-someone-help-me-not-an-actual-question\">Why is \u201cCan someone help me?\u201d not an actual question?</a> might help too."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7960264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d209c575dde5fce67cdcb0cde93a5bf?s=128&d=identicon&r=PG&f=1", "display_name": "valmer26", "link": "https://stackoverflow.com/users/7960264/valmer26"}, "edited": false, "score": 0, "creation_date": 1495671865, "post_id": 44076071, "comment_id": 75356628, "body": "Thank you sooo much Gowtham! Appreciate your response :) It works perfectly :)"}, {"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "reply_to_user": {"reputation": 23, "user_id": 7960264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d209c575dde5fce67cdcb0cde93a5bf?s=128&d=identicon&r=PG&f=1", "display_name": "valmer26", "link": "https://stackoverflow.com/users/7960264/valmer26"}, "edited": false, "score": 0, "creation_date": 1495683489, "post_id": 44076071, "comment_id": 75359144, "body": "Thats nice to hear!! I have made a minor change to the answer for sorting the dates properly. Use the updated answer. Please upvote if you found this useful"}], "tags": [], "owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "is_accepted": true, "score": 1, "last_activity_date": 1495683444, "last_edit_date": 1495683444, "creation_date": 1495215845, "answer_id": 44076071, "question_id": 43771773, "link": "https://stackoverflow.com/questions/43771773/check-if-values-in-2-columns-matches-excel-to-delete-row-if-another-row-pass-a/44076071#44076071", "title": "Check if values in 2 columns matches &amp; Excel to delete row if another row pass a certain condition", "body": "<p>Assuming you have just 2 rows that would be equal which has to be deleted, created macro. Try it out,</p>\n\n<pre><code>Sub delrow()\nDim i As Long, j As Long\nColumns(\"A:C\").Sort key1:=Range(\"A2\"), _\n      order1:=xlAscending, Header:=xlYes\nFor i = 2 To Cells(Rows.Count, 1).End(xlUp).Row\nFor j = 2 To Cells(Rows.Count, 1).End(xlUp).Row\n    If Cells(i, 2) = Cells(j, 3) And Cells(i, 1) &lt; Cells(j, 1) And Cells(i, 1) + 3 &gt;= Cells(j, 1) Then\n        Rows(i).ClearContents\n        Rows(j).ClearContents\n    End If\nNext j\nNext i\nFor i = Cells(Rows.Count, 1).End(xlUp).Row To 2 Step -1\n    If Cells(i, 1) = \"\" Then\n        Rows(i).Delete\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7960264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d209c575dde5fce67cdcb0cde93a5bf?s=128&d=identicon&r=PG&f=1", "display_name": "valmer26", "link": "https://stackoverflow.com/users/7960264/valmer26"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1486, "favorite_count": 0, "accepted_answer_id": 44076071, "answer_count": 1, "score": 2, "last_activity_date": 1495683444, "creation_date": 1493855485, "last_edit_date": 1493887868, "question_id": 43771773, "link": "https://stackoverflow.com/questions/43771773/check-if-values-in-2-columns-matches-excel-to-delete-row-if-another-row-pass-a", "title": "Check if values in 2 columns matches &amp; Excel to delete row if another row pass a certain condition", "body": "<p>Appreciate if anyone can help me on this. I have been looking for the any related questions but to no avail.</p>\n\n<p>I am not sure if this can be done through VBA (if yes, better), though I am currently working on formulas (Match, VLookup) and still having a hard time.</p>\n\n<p>I have three sets of columns.(Columns A, B, C)</p>\n\n<pre><code>DATE            INVOICE       PAYMENT*\n1/10/2015       131.08\n1/10/2015        1220   \n2/10/2015                     1232.4*\n3/10/2015                      1220*\n</code></pre>\n\n<p>The goal is to delete the rows which contains the same value found on Column B(invoice) and column C (Payment) but only if the data in column A (date) is within 3 days from the date of the match found in in both columns. Both rows within these criteria should be deleted.\n01/10/2015 + 3 days = 04/10/2015 can be considered, otherwise row should not be deleted.</p>\n\n<p>Desired result would be. </p>\n\n<pre><code>DATE            INVOICE       PAYMENT*\n1/10/2015        131.08\n2/10/2015                      1232.4*\n</code></pre>\n\n<p>Thank you in advance. </p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1493850999, "post_id": 43771019, "comment_id": 74583567, "body": "Do you really want to have an equals at the start of <code>theFormulaPart2</code>? Seems like it would error having 2 equals signs in the concatenated formula..."}, {"owner": {"reputation": 212, "user_id": 7916754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kj9hS.png?s=128&g=1", "display_name": "William C.", "link": "https://stackoverflow.com/users/7916754/william-c"}, "reply_to_user": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1493851699, "post_id": 43771019, "comment_id": 74583770, "body": "Hi @Wolfie, no, but I have tried it both ways and still end up with the same result."}], "answers": [{"comments": [{"owner": {"reputation": 212, "user_id": 7916754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kj9hS.png?s=128&g=1", "display_name": "William C.", "link": "https://stackoverflow.com/users/7916754/william-c"}, "edited": false, "score": 0, "creation_date": 1493854713, "post_id": 43771302, "comment_id": 74584633, "body": "Hi ASH, thanks for the help! The script is running into a small problem where the script is pasting &#39;=SUM(IF(CONCATENATE($C$3,[@Route],[@[Assumed Coating Type]],[@Diameter],[@[Year Installed (Coating)]])=&quot;X_X_X&quot;,HCA!P$26:P$13642))&#39; in AZ7. It doesn&#39;t seem to be replacing the &quot;X_X_X&quot;. Any ideas?"}, {"owner": {"reputation": 212, "user_id": 7916754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kj9hS.png?s=128&g=1", "display_name": "William C.", "link": "https://stackoverflow.com/users/7916754/william-c"}, "edited": false, "score": 0, "creation_date": 1493855824, "post_id": 43771302, "comment_id": 74584926, "body": "I believe there is a problem with the .Replace function. I&#39;ve tried a few variations and have come to no success in trying to have the X_X_X replaced."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 212, "user_id": 7916754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kj9hS.png?s=128&g=1", "display_name": "William C.", "link": "https://stackoverflow.com/users/7916754/william-c"}, "edited": false, "score": 1, "creation_date": 1493856922, "post_id": 43771302, "comment_id": 74585002, "body": "@WilliamC. the replaced form wont appear in the formula bar until you deselect then select the cell (I have no clue why). Besides, the resulting formula must also be correct, otherwise it wont succeed. It&#39;s very hard to debug this formula so I assumed it was correct and tested my code with smaller, &quot;correct&quot; formulas."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 212, "user_id": 7916754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kj9hS.png?s=128&g=1", "display_name": "William C.", "link": "https://stackoverflow.com/users/7916754/william-c"}, "edited": false, "score": 0, "creation_date": 1493857069, "post_id": 43771302, "comment_id": 74585022, "body": "@WilliamC. However I am pretty sure about the essence of the issue, you can&#39;t just truncate any part of the formula, you should keep it correct from a syntax point of view or Excel wont accept it."}, {"owner": {"reputation": 212, "user_id": 7916754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kj9hS.png?s=128&g=1", "display_name": "William C.", "link": "https://stackoverflow.com/users/7916754/william-c"}, "edited": false, "score": 0, "creation_date": 1493875397, "post_id": 43771302, "comment_id": 74589740, "body": "Hi ASH, thanks for the advice. Yes, the formula is accurate if entered normally. I&#39;ll tweak some things in the morning and see if I can get it to work. In the meantime, I&#39;ll mark this as answered since you&#39;ve provided a lot of useful information. Thank you again."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 2, "last_activity_date": 1493858527, "last_edit_date": 1493858527, "creation_date": 1493852302, "answer_id": 43771302, "question_id": 43771019, "link": "https://stackoverflow.com/questions/43771019/long-array-vba-issue/43771302#43771302", "title": "Long Array VBA Issue", "body": "<p>You should keep your truncated formula <em>syntactically</em> correct. Try it like this:</p>\n\n<pre><code>theFormulaPart1 = \"=SUM(IF(CONCATENATE(R3C3,[@Route],[@[Assumed Coating Type]],\n[@Diameter],[@[Year Installed (Coating)]])=X_X_X,HCA!R26C[-36]:R13642C[-36]))\"\n'                                          ^^^^^\ntheFormulaPart2 = \"CONCATENATE(HCA!R26C[86]:R13642C[86],HCA!R26C[-48]:R13642C[-48],HCA!R26C[87]:R13642C[87],HCA!R26C[-19]:R13642C[-19],HCA!R26C[88]:R13642C[88])\"\n\nWith ActiveSheet.Range(\"AZ7\")\n  .FormulaArray = theFormulaPart1\n  .Replace \"X_X_X\", theFormulaPart2\nEnd With\n</code></pre>\n\n<p>Here I inserted <code>X_X_X</code> (could be anything else) in the place of some \"closed expression\" in the formula. That keeps the truncated formula correct from a syntax point of view, so the statement <code>.FormulaArray = theFormulaPart1</code> can accept it. Replacement can then proceed in the second step.</p>\n"}, {"tags": [], "owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "is_accepted": false, "score": 0, "last_activity_date": 1505893307, "last_edit_date": 1505893307, "creation_date": 1505823334, "answer_id": 46300219, "question_id": 43771019, "link": "https://stackoverflow.com/questions/43771019/long-array-vba-issue/46300219#46300219", "title": "Long Array VBA Issue", "body": "<p>You can also try this(<br>\nplease don't run it from the VBE, try to run it from sheets environment. Go to Developer-Macros-Your Macro -Run or Run it from a button or shortcut and it will work without problem):</p>\n\n<pre><code>Range(\"AZ7\").Select\nSelection.Formula = _\n    \"=SUM(IF(CONCATENATE(R3C3,[@Route],[@[Assumed Coating Type]],[@Diameter],[@[Year Installed (Coating)]])=CONCATENATE(HCA!R26C[86]:R13642C[86],HCA!R26C[-48]:R13642C[-48],HCA!R26C[87]:R13642C[87],HCA!R26C[-19]:R13642C[-19],HCA!R26C[88]:R13642C[88]),HCA!R26C[-36]:R13642C[-36]))\"\n\nSendKeys \"{F2}\"\nSendKeys \"^+{ENTER}\"\n</code></pre>\n"}], "owner": {"reputation": 212, "user_id": 7916754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kj9hS.png?s=128&g=1", "display_name": "William C.", "link": "https://stackoverflow.com/users/7916754/william-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 865, "favorite_count": 0, "accepted_answer_id": 43771302, "answer_count": 2, "score": 3, "last_activity_date": 1505893307, "creation_date": 1493850521, "last_edit_date": 1531164843, "question_id": 43771019, "link": "https://stackoverflow.com/questions/43771019/long-array-vba-issue", "title": "Long Array VBA Issue", "body": "<p>I'm trying to enter a long-array Formula into VBA that is >255 characters. I have followed past suggestions to dim both halves of the formula and merge them later. I am still having errors getting the array to function properly and was hoping someone could help review the code.</p>\n\n<p>Here's the original code that exceeds the character limit I'm trying to get working:</p>\n\n<pre><code>Sub TestMacro()\n\nRange(\"AZ7\").Select\nSelection.FormulaArray = _\n    \"=SUM(IF(CONCATENATE(R3C3,[@Route],[@[Assumed Coating Type]],[@Diameter],[@[Year Installed (Coating)]])=CONCATENATE(HCA!R26C[86]:R13642C[86],HCA!R26C[-48]:R13642C[-48],HCA!R26C[87]:R13642C[87],HCA!R26C[-19]:R13642C[-19],HCA!R26C[88]:R13642C[88]),HCA!R26C[-36]:R13642C[-36]))\"\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Here is my latest attempt to split the code in half following past advice: <a href=\"https://www.mrexcel.com/forum/excel-questions/853889-long-array-visual-basic-applications-issue.html\" rel=\"noreferrer\">https://www.mrexcel.com/forum/excel-questions/853889-long-array-visual-basic-applications-issue.html</a></p>\n\n<p><a href=\"http://dailydoseofexcel.com/archives/2005/01/10/entering-long-array-formulas-in-vba/\" rel=\"noreferrer\">http://dailydoseofexcel.com/archives/2005/01/10/entering-long-array-formulas-in-vba/</a></p>\n\n<pre><code>Sub LongArrayFormula()\n Dim theFormulaPart1 As String\n Dim theFormulaPart2 As String\n theFormulaPart1 = \"=SUM(IF(CONCATENATE(R3C3,[@Route],[@[Assumed Coating Type]],[@Diameter],[@[Year Installed (Coating)]])\"\"X_X_X)\"\")\"\n\n theFormulaPart2 = \"=CONCATENATE(HCA!R26C[86]:R13642C[86],HCA!R26C[-48]:R13642C[-48],HCA!R26C[87]:R13642C[87],HCA!R26C[-19]:R13642C[-19],HCA!R26C[88]:R13642C[88]),HCA!R26C[-36]:R13642C[-36]))\"\n\n With ActiveSheet.Range(\"AZ7\")\n     .FormulaArray = theFormulaPart1\n    .Replace \"\"\"X_X_X)\"\")\", theFormulaPart2\n\nEnd With\n</code></pre>\n\n<p>Any help is appreciated, thanks.</p>\n"}, {"tags": ["vba", "excel", "savechanges"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493852357, "post_id": 43770829, "comment_id": 74583957, "body": "The code crashes for me as it tries to <b>save</b> the file.  Removing the extra &quot;\\&quot; from <code>Application.PathSeparator &amp; &quot;\\InsuranceAdvisory&quot;</code> allowed the code to successfully save and open the file.  (Which is strange, because I have never known a &quot;\\\\&quot; instead of &quot;\\&quot; to cause problems before. But that might be because it is using a UNC path rather than just a &quot;local&quot; path.)"}, {"owner": {"reputation": 17, "user_id": 7134066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f41b5d5de5d79af2dc1a7a04c7d94dbe?s=128&d=identicon&r=PG&f=1", "display_name": "Palee ", "link": "https://stackoverflow.com/users/7134066/palee"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493954292, "post_id": 43770829, "comment_id": 74632318, "body": "Working a bit differently for me. While saving addition &quot;\\&quot; allows to save the file successfully. But when re opening the file, I either have to remove APplication.PathSeperater or &quot;\\&quot;. But, for now it use two different path + or - &quot;\\&quot; for saving and opening. Thanks for the inputs mate."}], "owner": {"reputation": 17, "user_id": 7134066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f41b5d5de5d79af2dc1a7a04c7d94dbe?s=128&d=identicon&r=PG&f=1", "display_name": "Palee ", "link": "https://stackoverflow.com/users/7134066/palee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1493887746, "creation_date": 1493849455, "last_edit_date": 1493887746, "question_id": 43770829, "link": "https://stackoverflow.com/questions/43770829/open-a-workbook-from-saved-location", "title": "Open a workbook from Saved location", "body": "<p>Have a requirement to store a file in mydocuments. Save location has to be VDI or laptop independent. </p>\n\n<p>I am able to successfully save the file, in the location I want. But with the same file name and location, I am unable to open it.</p>\n\n<p>The path and the filename for workbooks.open is coming like this, when I am testing it thru VDI. Bit strange, I not able to open the workbook using the path I used to save it.</p>\n\n<p>\"\\xxx.yyy.CO.NZ\\PaleeS.home$\\InsuranceAdvisory\\Excel\\DT_test delete_rectangle 1_04.May.17.xlsm\"</p>\n\n<pre><code>Dim strFilename As String\nDim Client1 As Range\nDim Client2 As Range\nDim CurrentDate As String\nDim FilePrefix As String\nDim strDir As String\nDim StrDirSub As String\nDim Savedflie As String\nDim CurrentFolderpath As String\nDim CurrentFilename As String\n\nCurrentFolderpath = Application.ActiveWorkbook.Path\nCurrentFilename = Application.ActiveWorkbook.Path &amp; \"\\\" &amp; Application.ActiveWorkbook.FullName\n\nstrDir = CreateObject(\"WScript.Shell\").SpecialFolders(\"mydocuments\") &amp; Application.PathSeparator &amp; \"\\InsuranceAdvisory\"\nStrDirSub = strDir &amp; \"\\Excel\"\nIf Dir(strDir, vbDirectory) = \"\" Then\n    MkDir strDir\nEnd If\nSelect Case Dir(StrDirSub, vbDirectory)\n    Case \"\"\n    MkDir StrDirSub\nEnd Select\nFilePrefix = \"\\DT_\"\nSet Client1 = Range(\"Client1\")\nSet Client2 = Range(\"Client2\")\nCurrentDate = Format(Date, \"dd.mmm.yy\")\nstrFilename = FilePrefix &amp; Client1.Value &amp; \"_\" &amp; Client2.Value &amp; \"_\" &amp; CurrentDate\nActiveWorkbook.Save\nActiveWorkbook.SaveCopyAs StrDirSub &amp; strFilename &amp; \".xlsm\"\nSavedflie = StrDirSub &amp; strFilename &amp; \".xlsm\"\nApplication.Workbooks.Open (Savedflie)\n</code></pre>\n"}, {"tags": ["vba", "excel", "runtime-error", "vlookup"], "comments": [{"owner": {"reputation": 27, "user_id": 7959876, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Wr-nZgjklNY/AAAAAAAAAAI/AAAAAAAANCI/BXNUVdBHXuU/photo.jpg?sz=128", "display_name": "Josh Hudson", "link": "https://stackoverflow.com/users/7959876/josh-hudson"}, "edited": false, "score": 0, "creation_date": 1493847546, "post_id": 43770173, "comment_id": 74582292, "body": "Thanks, of course i realized missing the Cell and Range after i post but the additional information really helped. However it runs now but i am getting an #N/A value when i know the value is there."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493847647, "post_id": 43770173, "comment_id": 74582340, "body": "Is there a type issue, e.g. one worksheet contains the value as a number, and the other worksheet contains it as text?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1493847103, "post_id": 43770257, "comment_id": 74582126, "body": "I would probably just use <code>compliance.Range(&quot;A:AC&quot;)</code>. There doesn&#39;t seem to be a significant detriment to using full column references as the lookup range for vlookup whether on the worksheet or in VBA. I <i>would</i> however, use <code>Application.VLookup</code> instead of <code>Application.WorksheetFunction.VLookup</code> or use <code>application.match</code> to retrieve the row number and then <code>cells(# from match, 29)</code>."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493847420, "post_id": 43770257, "comment_id": 74582231, "body": "I would normally use &quot;A:AC&quot; myself, but I was trying to work out how to incorporate <code>n</code> into the OP&#39;s code - so I could only assume that they were thinking they could use it to limit rows in the VLookup.  As for <code>Application.VLookup</code> v <code>Application.WorksheetFunction.VLookup</code>, I think I used <code>Application.VLookup</code> in a recent answer and one of the other more &quot;senior&quot; (i.e. higher rep) answerers pointed out that it is better to use early-binding rather than late-binding. I can&#39;t win!  :D"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1493853473, "post_id": 43770257, "comment_id": 74584310, "body": "I&#39;d have to check specifically about vlookup but you can pass an <code>application.match</code> back to a variant and then test the variant with IsError. You cannot do tjhe same with <code>Application.WorksheetFunction.Match</code> (so I never use it)."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 3, "last_activity_date": 1493847286, "last_edit_date": 1493847286, "creation_date": 1493846662, "answer_id": 43770257, "question_id": 43770173, "link": "https://stackoverflow.com/questions/43770173/run0time-error-438/43770257#43770257", "title": "Run0time error &#39;438&#39;", "body": "<p>Your line saying</p>\n\n<pre><code>report(i, 19) = Application.WorksheetFunction.VLookup(report(\"i, 3\"), compliance(\"A1:AC2400\"), 29, False)\n</code></pre>\n\n<p>should probably say</p>\n\n<pre><code>report.Cells(i, 19) = Application.WorksheetFunction.VLookup(report.Cells(i, 3), compliance.Range(\"A1:AC2400\"), 29, False)\n</code></pre>\n\n<p>but, if so, why are you doing that in a <code>For n</code> loop?</p>\n\n<p>Perhaps you mean your code to be:</p>\n\n<pre><code>Dim compliance As Worksheet\nDim report As Worksheet\nDim completeList As Worksheet\n\nSub getcompliance()\n    Dim i As Long\n    Set compliance = ActiveWorkbook.Worksheets(\"Compliance\")\n    Set report = ActiveWorkbook.Worksheets(\"Report\")\n    For i = 3 To report.UsedRange.Rows.Count\n        report.Cells(i, 19) = Application.WorksheetFunction.VLookup(report.Cells(i, 3), compliance.Range(\"A1:AC\" &amp; compliance.UsedRange.Rows.Count), 29, False)\n        'Or, simply using the full columns:\n        'report.Cells(i, 19) = Application.WorksheetFunction.VLookup(report.Cells(i, 3), compliance.Range(\"A:AC\"), 29, False)\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 2, "last_activity_date": 1493846754, "creation_date": 1493846754, "answer_id": 43770278, "question_id": 43770173, "link": "https://stackoverflow.com/questions/43770173/run0time-error-438/43770278#43770278", "title": "Run0time error &#39;438&#39;", "body": "<pre><code>'      vvvvv                                          vvvvvvvvvvvvv\nreport.Cells(i, 19) = WorksheetFunction.VLookup(report.Cells(i, 3), compliance.Range(\"A1:AC2400\"), 29, False)\n'                                                                              ^^^^^^\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 7959876, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Wr-nZgjklNY/AAAAAAAAAAI/AAAAAAAANCI/BXNUVdBHXuU/photo.jpg?sz=128", "display_name": "Josh Hudson", "link": "https://stackoverflow.com/users/7959876/josh-hudson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1493847286, "creation_date": 1493846283, "last_edit_date": 1493846508, "question_id": 43770173, "link": "https://stackoverflow.com/questions/43770173/run0time-error-438", "title": "Run0time error &#39;438&#39;", "body": "<p>I have the below line that is receiving a \"Object doesn't support the property or method error, but i am not seeing any issues.</p>\n\n<pre><code>Dim compliance As Worksheet\nDim report As Worksheet\nDim completeList As Worksheet\n\nSub getcompliance()\n    Dim i As Long\n    Dim n As Long\n    Dim Source As String\n    Set compliance = ActiveWorkbook.Worksheets(\"Compliance\")\n    Set report = ActiveWorkbook.Worksheets(\"Report\")\n    For i = 3 To report.UsedRange.Rows.Count\n      For n = 2 To compliance.UsedRange.Rows.Count\n        report(i, 19) = Application.WorksheetFunction.VLookup(report(\"i, 3\"), compliance(\"A1:AC2400\"), 29, False)\n      Next n\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 3, "creation_date": 1493845556, "post_id": 43769991, "comment_id": 74581444, "body": "What do you mean by &quot;group&quot;?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1493850710, "post_id": 43769991, "comment_id": 74583480, "body": "Is your &quot;timestamp&quot; column an actual formatted date-time value, or is it text?  It&#39;s not at all clear what you mean by &quot;group&quot;, so it would be very useful to add some representative &quot;before&quot; and &quot;after&quot; screenshots."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 2683544, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e335c5da0b95dcfd2a3dd3fc3d15f53d?s=128&d=identicon&r=PG&f=1", "display_name": "ucg-ky", "link": "https://stackoverflow.com/users/2683544/ucg-ky"}, "edited": false, "score": 0, "creation_date": 1493848735, "post_id": 43770577, "comment_id": 74582769, "body": "Just two columns, A and B. There are a total of A:R columns, but I just presented two. Wanted to be able to group them by together instead of filtering. I am working with over 300,000 rows. I will try this when I get back to work tomorrow. My thanks!"}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1493848197, "creation_date": 1493848197, "answer_id": 43770577, "question_id": 43769991, "link": "https://stackoverflow.com/questions/43769991/how-can-you-group-rows-by-3-minute-interval-time-stamps-in-excel/43770577#43770577", "title": "How can you group rows by 3 minute interval time stamps in excel?", "body": "<p>It seems at least four people (myself included) out of sixteen don't understand the Q but a PivotTable allows options for the presentation of data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/bN9YL.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bN9YL.jpg\" alt=\"SO43769991 example\"></a>  </p>\n"}], "owner": {"reputation": 21, "user_id": 2683544, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e335c5da0b95dcfd2a3dd3fc3d15f53d?s=128&d=identicon&r=PG&f=1", "display_name": "ucg-ky", "link": "https://stackoverflow.com/users/2683544/ucg-ky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493848197, "creation_date": 1493845445, "last_edit_date": 1493845520, "question_id": 43769991, "link": "https://stackoverflow.com/questions/43769991/how-can-you-group-rows-by-3-minute-interval-time-stamps-in-excel", "title": "How can you group rows by 3 minute interval time stamps in excel?", "body": "<p>How can you group rows by 3 minute interval time stamps in excel and make sure that the rows grouped are by the user name? I want to make sure to keep all the other column data as well not mentioned here.</p>\n\n<p>I am hoping to do this by formula but if VBA, it's ok, I can add it.</p>\n\n<pre><code>Column A\n\ntimestamp\n04/26/2017 01:00:04 PM\n04/26/2017 01:00:10 PM\n04/26/2017 01:00:11 PM\n04/26/2017 01:00:11 PM\n04/26/2017 01:00:14 PM\n04/26/2017 01:00:32 PM\n04/26/2017 01:00:35 PM\n\n**Column B**\n\nUsername\nBob\nRick1\nTickman\nTickman\nOStech\nBob\nRick\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"tags": [], "owner": {"reputation": 181, "user_id": 1703062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7eeb92e1cb186678a008d9ded44ffca?s=128&d=identicon&r=PG", "display_name": "ChE Junkie", "link": "https://stackoverflow.com/users/1703062/che-junkie"}, "is_accepted": false, "score": 1, "last_activity_date": 1493914136, "last_edit_date": 1493914136, "creation_date": 1493860044, "answer_id": 43772257, "question_id": 43769810, "link": "https://stackoverflow.com/questions/43769810/how-to-insert-or-delete-rows-in-individually-locked-cells-in-excel-2016/43772257#43772257", "title": "How to insert or delete rows in individually locked cells in excel 2016?", "body": "<p>Inserted rows inherit cell properties from the row above, but not the formulas.</p>\n\n<p>After inserting the row, you need to unlock the sheet and copy the formulas into the new cells. You can do this by-hand or using VBA e.g.</p>\n\n<pre><code>''1. Unlock Sheet.\nActiveSheet.Unprotect Password:=\"YourPassword\"\n''2. Copy row above.\n''3. Select the row that was inserted below.\n''4. PasteSpecial Paste:=xlPasteFormulas\n''5. Re-lock Sheet.\nActiveSheet.Protect Password:=\"YourPassword\", _\n  DrawingObjects:=True, Contents:=True, Scenarios:=True, _\n  AllowInsertingRows:=True, AllowDeletingRows:=True\n</code></pre>\n\n<p>You could then define your table as a TableObject in Excel (using the Insert tab), and then use the Worksheet_TableUpdate event to trigger the routine above.</p>\n\n<p>Some References:</p>\n\n<ul>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff840611.aspx\" rel=\"nofollow noreferrer\">Worksheet.Protect Method (MSN)</a></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/jj229788.aspx\" rel=\"nofollow noreferrer\">Worksheet.TableUpdate Event (MSN)</a></li>\n</ul>\n"}], "owner": {"reputation": 101, "user_id": 4241396, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000239705022/picture?type=large", "display_name": "Mamed Aliyev", "link": "https://stackoverflow.com/users/4241396/mamed-aliyev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 918, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1493914136, "creation_date": 1493844786, "last_edit_date": 1592644375, "question_id": 43769810, "link": "https://stackoverflow.com/questions/43769810/how-to-insert-or-delete-rows-in-individually-locked-cells-in-excel-2016", "title": "How to insert or delete rows in individually locked cells in excel 2016?", "body": "<p>In my excel list I locked some cells. And want to able insert or delete rows.\n<a href=\"https://i.stack.imgur.com/LH2Jl.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LH2Jl.jpg\" alt=\"lock with this options\" /></a>\nRows and column by name &quot;Total&quot;  contain formulas. when I insert a row and add values into cells, cells in &quot;Total&quot; row work well, but  cells in &quot;Total&quot; column don't calculate and could not delete newly inserted row.\n<a href=\"https://i.stack.imgur.com/eTOig.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eTOig.jpg\" alt=\"could not delete row and H4 cell is not calculated\" /></a></p>\n<p>Please help me\nI want to protect colored cells, able to add or remove rows, that formulas works correctly.\nThanks in advance</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493841734, "post_id": 43768819, "comment_id": 74579404, "body": "If you only have one workbook open, as you say in your question&#39;s first sentence, you can just use <code>ActiveWorkbook</code> instead of <code>Trade</code> (or <code>Set Trade = ActiveWorkbook</code>).  It&#39;s only when you have more than one workbook open that you need to do anything special."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1493842887, "post_id": 43768819, "comment_id": 74580029, "body": "If the Workbook you are running the code is in the workbook in question whose name may be different, you can use <code>ThisWorkbook</code>, which is slightly better than <code>ActiveWorkbook</code>, IMO. If the <code>trade...</code> workbook is the only <i>other</i> workbook you have open (besides one where code runs) see ScottCraner&#39;s answer below."}, {"owner": {"reputation": 33, "user_id": 7959605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d28c233734563c31d73416225a3e3a5?s=128&d=identicon&r=PG&f=1", "display_name": "jbaboon", "link": "https://stackoverflow.com/users/7959605/jbaboon"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493902989, "post_id": 43768819, "comment_id": 74607675, "body": "@YowE3K Rereading my question I did make a mistake. I have at least one of workbook open when running this macro."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493926310, "post_id": 43768819, "comment_id": 74623234, "body": "@jbaboon - I have updated the question slightly to make it clearer that it isn&#39;t a single workbook situation."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7959605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d28c233734563c31d73416225a3e3a5?s=128&d=identicon&r=PG&f=1", "display_name": "jbaboon", "link": "https://stackoverflow.com/users/7959605/jbaboon"}, "edited": false, "score": 0, "creation_date": 1493902926, "post_id": 43768929, "comment_id": 74607625, "body": "Thank you, This is exactly what I was looking for. I presume I can use the same code for other workbook names as well. Just change out what is in the quotes and create a new variable(similar to Dim Trade) for other workbooks?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 33, "user_id": 7959605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d28c233734563c31d73416225a3e3a5?s=128&d=identicon&r=PG&f=1", "display_name": "jbaboon", "link": "https://stackoverflow.com/users/7959605/jbaboon"}, "edited": false, "score": 0, "creation_date": 1493903658, "post_id": 43768929, "comment_id": 74608187, "body": "@jbaboon yes just change to what you are looking for."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 3, "last_activity_date": 1493841480, "creation_date": 1493841480, "answer_id": 43768929, "question_id": 43768819, "link": "https://stackoverflow.com/questions/43768819/vba-how-to-set-a-workbook-type-variable-when-i-only-know-a-partial-workbook-nam/43768929#43768929", "title": "VBA- How to set a workbook type variable when i only know a partial workbook name", "body": "<p>you can loop through the open workbooks and find the correct one then set the variable:</p>\n\n<pre><code>Dim Trade As Workbook\nDim t As Workbook\n\nFor Each t In Workbooks\n    If Left(t.Name, 5) = \"trade\" Then\n        Set trade = Workbooks(t.Name)\n    End If\nNext t\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7959605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d28c233734563c31d73416225a3e3a5?s=128&d=identicon&r=PG&f=1", "display_name": "jbaboon", "link": "https://stackoverflow.com/users/7959605/jbaboon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "accepted_answer_id": 43768929, "answer_count": 1, "score": 3, "last_activity_date": 1493926275, "creation_date": 1493841092, "last_edit_date": 1531164843, "question_id": 43768819, "link": "https://stackoverflow.com/questions/43768819/vba-how-to-set-a-workbook-type-variable-when-i-only-know-a-partial-workbook-nam", "title": "VBA- How to set a workbook type variable when i only know a partial workbook name", "body": "<p>I currently have several workbooks open. One of them is sometimes named \"trade1\", sometimes \"trade2\", or anything else but always starting \"trade\". I'm trying to set a variable so that regardless of the name if it's open and it starts with \"trade\" that workbook will now be the variable. So that throughout the macro I can refer to that book and use it for things such as Trade.activate to select that book. Here is my current code where I am getting a Run-Time Error '9': subscript out of range error:</p>\n\n<pre><code>Dim Trade as Workbook\n\nSet Trade = workbooks(\"trade\" &amp; \"*\" &amp; \".xls\")\n</code></pre>\n\n<p>I know this can be done with a function but was hoping it could done a simpler way. Is this possible or am I on a fools errand?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "edited": false, "score": 0, "creation_date": 1493839993, "post_id": 43768419, "comment_id": 74578498, "body": "you want to keep the name of the file and just add to the file?"}, {"owner": {"reputation": 91, "user_id": 5865063, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/29e6a11d3936b0932b6ea80dd157f633?s=128&d=identicon&r=PG&f=1", "display_name": "Dan S", "link": "https://stackoverflow.com/users/5865063/dan-s"}, "reply_to_user": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "edited": false, "score": 0, "creation_date": 1493840286, "post_id": 43768419, "comment_id": 74578626, "body": "Yes - the file will be overwritten with the new data. Perhaps I should ignore Freefile and use a .CSV export? But I find it horribly slow."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493841431, "post_id": 43768419, "comment_id": 74579226, "body": "What do you mean by &quot;constantly changing&quot;?  Do you need the file to be rewritten several times per second, or several times per month?"}, {"owner": {"reputation": 91, "user_id": 5865063, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/29e6a11d3936b0932b6ea80dd157f633?s=128&d=identicon&r=PG&f=1", "display_name": "Dan S", "link": "https://stackoverflow.com/users/5865063/dan-s"}, "edited": false, "score": 0, "creation_date": 1493842723, "post_id": 43768419, "comment_id": 74579937, "body": "Usually every few seconds.."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 5865063, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/29e6a11d3936b0932b6ea80dd157f633?s=128&d=identicon&r=PG&f=1", "display_name": "Dan S", "link": "https://stackoverflow.com/users/5865063/dan-s"}, "edited": false, "score": 0, "creation_date": 1493842751, "post_id": 43768875, "comment_id": 74579954, "body": "Thanks will try this tomorrow!"}, {"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "reply_to_user": {"reputation": 91, "user_id": 5865063, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/29e6a11d3936b0932b6ea80dd157f633?s=128&d=identicon&r=PG&f=1", "display_name": "Dan S", "link": "https://stackoverflow.com/users/5865063/dan-s"}, "edited": false, "score": 0, "creation_date": 1493843195, "post_id": 43768875, "comment_id": 74580193, "body": "You will probably have to add some sort of <code>while(!File.Exists(yourFile.txt)) { }</code> to whatever program is reading this file in case it tries to read the file when it&#39;s not there."}], "tags": [], "owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "is_accepted": true, "score": 1, "last_activity_date": 1493841291, "creation_date": 1493841291, "answer_id": 43768875, "question_id": 43768419, "link": "https://stackoverflow.com/questions/43768419/export-a-fixed-range-quickly-using-freefile/43768875#43768875", "title": "Export a fixed range quickly using FreeFile", "body": "<p>Add a reference to your VBA code: </p>\n\n<p>Tools > References > Microsoft Scripting Runtime</p>\n\n<p>Delete the file and write your new one. This will give it the same name every time and will be <code>yourFile.txt</code>. Your directory will then have <code>yourFile.xlsx</code> and <code>yourFile.txt</code>.</p>\n\n<pre><code>Dim fso As New Scripting.FileSystemObject\n\nIf fso.FileExists(Replace(Replace(ThisWorkbook.FullName, \".xlsx\", \".txt\"), \".xls\", \".txt\")) Then\n    fso.DeleteFile (Replace(Replace(ThisWorkbook.FullName, \".xlsx\", \".txt\"), \".xls\", \".txt\"))\nEnd If\n\nFF = FreeFile()\nOpen Replace(Replace(ThisWorkbook.FullName, \".xlsx\", \".txt\"), \".xls\", \".txt\") For Output As #FF\nPrint #FF, cell.Text\nClose #FF\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 5865063, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/29e6a11d3936b0932b6ea80dd157f633?s=128&d=identicon&r=PG&f=1", "display_name": "Dan S", "link": "https://stackoverflow.com/users/5865063/dan-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 43768875, "answer_count": 1, "score": 1, "last_activity_date": 1493887689, "creation_date": 1493839577, "last_edit_date": 1493887689, "question_id": 43768419, "link": "https://stackoverflow.com/questions/43768419/export-a-fixed-range-quickly-using-freefile", "title": "Export a fixed range quickly using FreeFile", "body": "<p>I'm trying to get the values for a fixed range of cells (constantly changing) out into a text file at regular intervals as cleanly as possible.</p>\n\n<p>I've got as far as putting one cell value into the filename of the txt:</p>\n\n<pre><code>        FF = FreeFile()\n        Open ThisWorkbook.Path &amp; \"\\\" &amp; Range(\"A\" &amp; cell.Row).Value &amp; \".txt\" For Output As #FF\n        Print #FF, cell.Text\n        Close #FF\n</code></pre>\n\n<p>But I want to put the data into the file, and leave the name alone. </p>\n\n<p>Any help appreciated!</p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1493837323, "post_id": 43767656, "comment_id": 74577080, "body": "<code>function PassPPT(strSelectedPPT as string)......end function</code> using like <code>PassPPT(me.combobox1.value)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 223, "user_id": 7039125, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/805dafea7a1ec52382acdefd6636b847?s=128&d=identicon&r=PG&f=1", "display_name": "BH57", "link": "https://stackoverflow.com/users/7039125/bh57"}, "edited": false, "score": 0, "creation_date": 1493842892, "post_id": 43768122, "comment_id": 74580032, "body": "@BH57 happy to help! I wish more VBA devs realized user forms have a default instance, and how poisonous and anti-OOP working against that default instance is. Make sure you take a look at my <a href=\"http://www.rubberduckvba.com/\" rel=\"nofollow noreferrer\">Rubberduck</a> project if you&#39;re serious about VBA =)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1493838323, "creation_date": 1493838323, "answer_id": 43768122, "question_id": 43767656, "link": "https://stackoverflow.com/questions/43767656/pass-a-string-from-a-user-form-button-click-to-excel-vba/43768122#43768122", "title": "Pass a string from a User Form Button Click to Excel VBA", "body": "<p>Your <code>SelectedPPT</code> is breaking <em>encapsulation</em> and can be set from outside the form, not just the form's code. You can mitigate this design issue by making the field <code>Private</code> and exposing a <code>Property Get</code> procedure for it:</p>\n\n<pre><code>Option Explicit\nPrivate SelectedPPT As String\n\nPublic Property Get SelectedFile() As String\n    SelectedFile = SelectedPPT\nEnd Property\n</code></pre>\n\n<p>Set the <code>ComboBox</code> row source in the form's <code>Initialize</code> or <code>Activate</code> handler, so it's initialized once. Then assign <code>SelectedPPT</code> when the selection changes in the ComboBox - that's your <code>ComboBox1_Change</code> handler.</p>\n\n<p>That removes the need for that [Set PowerPoint] button and its <code>Click</code> handler.</p>\n\n<p>I would have an [Ok] and a [Cancel] button, and I'd make the form remember whether it's cancelled:</p>\n\n<pre><code>Private IsCancelled As Boolean\n\nPublic Property Get Cancelled() As Boolean\n    Cancelled = IsCancelled\nEnd Property\n\nPrivate Sub OkButton_Click()\n    Me.Hide\nEnd Sub\n\nPrivate Sub CancelButton_Click()\n    IsCancelled = True\n    Me.Hide\nEnd Sub\n</code></pre>\n\n<p>And then you also need to account for the case where the user clicks the red X button to close the form; you can do that by handling the forms' <code>QueryClose</code> event:</p>\n\n<pre><code>Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n    If CloseMode = VbQueryClose.vbFormControlMenu Then\n        IsCancelled = True\n        Cancel = True\n        Me.Hide\n    End If\nEnd Sub\n</code></pre>\n\n<p>The rest of the logic belongs to the calling code - let's say the form is called <code>MyAwesomeForm</code>; you'd have something like this:</p>\n\n<pre><code>Dim filename As String\nWith New MyAwesomeForm\n    .Show\n    If Not .Cancelled Then\n        filename = .SelectedFile\n        'do whatever you wanted to do with that filename\n    End If\nEnd With\n</code></pre>\n\n<p>Note:</p>\n\n<ul>\n<li>At no point the form calls <code>Unload Me</code></li>\n<li>It's the caller's responsibility to create <em>and</em> destroy the form object</li>\n<li>Caller uses a <code>New</code> instance of the form every time</li>\n<li>Caller has read-only access to whatever values the form exposes through properties</li>\n</ul>\n"}], "owner": {"reputation": 223, "user_id": 7039125, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/805dafea7a1ec52382acdefd6636b847?s=128&d=identicon&r=PG&f=1", "display_name": "BH57", "link": "https://stackoverflow.com/users/7039125/bh57"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1184, "favorite_count": 0, "accepted_answer_id": 43768122, "answer_count": 1, "score": 0, "last_activity_date": 1493838323, "creation_date": 1493836538, "question_id": 43767656, "link": "https://stackoverflow.com/questions/43767656/pass-a-string-from-a-user-form-button-click-to-excel-vba", "title": "Pass a string from a User Form Button Click to Excel VBA", "body": "<p>I have created a UserForm that takes a list of open PowerPoint files and lets a user select which one they want to use.  When they click the 'Set PowerPoint' button, I want to pass that button to a VBA Module where I will set the PowerPoint to the one the user just selected.  Any help would be greatly appreciated.</p>\n\n<p>UserForm Code:</p>\n\n<pre><code>Option Explicit\n\nPublic SelectedPPT As String\n\nPrivate Sub cmdCloseForm_Click()\n    Unload Me\nEnd Sub\n\nPrivate Sub ComboBox1_Change()\n    ComboBox1.RowSource = \"Array\"\nEnd Sub\n\nPrivate Sub setPPT_Click()\n    'Not sure if this is the best way to select the ppt the user has chosen?\n    SelectedPPT = Me.ComboBox1.Value\nEnd Sub\n</code></pre>\n\n<p>This is what the UserForm looks like:\n<a href=\"https://i.stack.imgur.com/WeWmx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WeWmx.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then how can I take SelectedPPT and pass it to the module so I can select that specific PowerPoint?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1493835864, "post_id": 43767350, "comment_id": 74576222, "body": "Can you please reformat your code? Instead of using a quote block, paste the code, highlight it, and click the <code>{}</code> button.  You&#39;re getting an error because it&#39;s all jumbled together and not separated. It&#39;s a formatting issue, assuming the code is in your Workbook exactly as you posted it."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1493835957, "post_id": 43767350, "comment_id": 74576280, "body": "Which specific instruction is the compiler complaining about?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1493836079, "post_id": 43767350, "comment_id": 74576363, "body": "I tried editing out the quote block into an actual code block, but I think it may have messed up the actual code layout.. hard to tell. Please <b><a href=\"https://stackoverflow.com/posts/43767350/edit\">edit</a></b> the question - select all the code, remove it. Go to your VBA editor, select all the <b>relevant code</b>, hit TAB to indent 4 spaces, copy, then paste it in here."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1493836094, "post_id": 43767350, "comment_id": 74576374, "body": "Is your original code formatting how your code is in your project? There&#39;s still formatting issues, i.e. <code>Cells(2, 1).Value = &quot;aaa&quot; Cells(2, 2).Value = &quot;aaa&quot;</code> isn&#39;t correct. You need to split that over multiple lines. I have a feeling if we edit it to be readable in the correct VBA format, it&#39;ll actually fix your problem(s)...?"}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493845713, "post_id": 43768257, "comment_id": 74581525, "body": "The OP also has a typo in <code>Workbook(&quot;CARS Capps.csv&quot;).Activate</code> (which is probably generating the specific error that they mention, but is pointless fixing without also fixing everything else you mention.  And they shouldn&#39;t be using the <code>Activate</code> anyway - they can use <code>xlBook</code>.)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493846212, "post_id": 43768257, "comment_id": 74581755, "body": "Forget I said anything - although that line will cause a problem if they fix everything else, the <code>Import_CARS_Capps_Click</code> sub that it is in doesn&#39;t even create an Excel application object.  It just tries to use <code>xlApp</code> without initiating it.  So even <code>xlApp.Workbooks(&quot;CARS Capps.csv&quot;).Activate</code> would crash."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1493845835, "last_edit_date": 1493845835, "creation_date": 1493838990, "answer_id": 43768257, "question_id": 43767350, "link": "https://stackoverflow.com/questions/43767350/insert-dummy-row-in-excel-via-access-using-vba/43768257#43768257", "title": "Insert &quot;dummy&quot; row in Excel via Access using VBA", "body": "<p>There are a few immediate issues in the <code>Sub Command10_Click()</code> that I can see that will cause the code to fail. I will illustrate below.</p>\n\n<p>Everything looks good with this:</p>\n\n<pre><code>Dim objActiveWkbk As Object\nDim objActiveWksh As Object\nDim objXL As Object\nDim strWkbkName As String\n\nstrWkbkName = \"C:\\data\\Payroll.csv\"\n\nSet objXL = CreateObject(\"excel.application\")\n</code></pre>\n\n<p>But this next line is wrong: <code>Set objActiveWkbk = objXL.Application.ActiveWorkbook</code></p>\n\n<p>You are asking VBA to set an object that does not exist. In the statement above you created an Excel Object, but you have not created an actual workbook yet attached to the Excel object. </p>\n\n<p>That said, change the line to</p>\n\n<pre><code>Set objActiveWkbk = objXL.Workbooks.Open(strWkbName)\n</code></pre>\n\n<p>to create the object. </p>\n\n<p>Then this line will work:</p>\n\n<pre><code>Set objActiveWksh = objActiveWkbk.Worksheets(\"Payroll.csv\")\n</code></pre>\n\n<p><em>(Caveat here is that the Worksheet name</em> <strong>actually</strong> <em>ends in <code>.csv</code>. If not, edit it accordingly)</em></p>\n\n<p>However, the rest of the code will break because you do not qualify the properties or methods to the Excel Object. Access does not understand <code>Rows</code>, <code>Range</code>, <code>Selection</code> etc. It's not part of the syntax of the Access VBA Object Model, so Access will not know what to do when it sees. It <strong>is</strong> part of the Excel Object Model, so you just have to tell Access VBA that by assigning parentage. </p>\n\n<p>A With block is a fast and efficient way to do that.</p>\n\n<pre><code>With objActiveWksh\n    .Rows(\"2:2\").Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n</code></pre>\n\n<p>Also notice how I refactored that statement to get rid of the <code>Select</code> stuff. You don't need it. It slows your code and makes it harder to maintain. Work directly with the object instead. <em>(There are rare cases where Select is needed).</em></p>\n\n<p>So, continuing on ... </p>\n\n<pre><code>    .Range(\"A2:F2\").Value = \"BBB\" 'set them all at once\n    .Range(\"G2\").Value = \"2500\"\n    .Range(\"H2\").Value = \"1500\"\n    .Range(\"J2:AA2\").Value = \"BBB\" 'set them all at once\nEnd With\n</code></pre>\n\n<p>Then, honestly, I am confused about why you create a workbook and then close it without saving changes, but the rest looks good.</p>\n\n<pre><code>objActiveWkbk.Close SaveChanges:=False\nSet objActiveWkbk = Nothing\nobjXL.Application.Quit\nSet objXL = Nothing\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7959205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80d29207d040a905f1ded96bb9e47559?s=128&d=identicon&r=PG&f=1", "display_name": "AnnieK", "link": "https://stackoverflow.com/users/7959205/anniek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 536, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493845835, "creation_date": 1493835496, "last_edit_date": 1493835919, "question_id": 43767350, "link": "https://stackoverflow.com/questions/43767350/insert-dummy-row-in-excel-via-access-using-vba", "title": "Insert &quot;dummy&quot; row in Excel via Access using VBA", "body": "<p>I'm attempting to insert a dummy line into an excel file via access using VBA. I attached the following to an access button, and when I run it I get: \"Compile error: Sub or Function not defined\"</p>\n\n<pre><code>Sub Command10_Click()\n\nDim objActiveWkbk As Object Dim objActiveWksh As Object Dim objXL As Object Dim strWkbkName As String\n\nstrWkbkName = \"C:\\data\\Payroll.csv\"\n\nSet objXL = CreateObject(\"excel.application\") objXL.Application.ActiveWorkbook Set objActiveWksh = objActiveWkbk.worksheets(\"Payroll.csv\")\n\nRows(\"2:2\").Select\n    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n    Range(\"A2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"B2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"C2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"D2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"E2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"F2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"G2\").Select\n    ActiveCell.FormulaR1C1 = \"2500\"\n    Range(\"H2\").Select\n    ActiveCell.FormulaR1C1 = \"1500\"\n    Range(\"I2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"J2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"K2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"L2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"M2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"N2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"O2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"P2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"Q2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"R2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"S2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"T2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"U2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"V2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"W2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"X2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"Y2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"Z2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"AA2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"AB2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"AC2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"AD2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"AE2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"AF2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"AG2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"AH2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"AI2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"AJ2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"AK2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"AL2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"AM2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"AN2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"AO2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"AP2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"AQ2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"AR2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"AS2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"AT2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"AU2\").Select\n    ActiveCell.FormulaR1C1 = \"BBB\"\n    Range(\"AV2\").Select\n    ActiveWorkbook.Save\n\nobjActiveWkbk.Close SaveChanges:=False   Set objActiveWkbk = Nothing   objXL.Application.Quit   Set objXL = Nothing End Sub\n\n\n\n\nPrivate Sub Command4_Click() DoCmd.OpenQuery \"qry_CARS Capps Compile\"\n\nEnd Sub\n\nPrivate Sub Command8_Click() DoCmd.TransferText acImportDelim, , \"CARS Capps B\", \"P:\\EMI\\Drop\\CARS Capps.csv\", True\n\nEnd Sub\n\nPublic Sub Import_CARS_Capps_Click() Dim xlApp As Object Dim xlBook As Object\n\nxlApp.Visible = True\n\nSet wbExcel = xlApp.Workbooks.Add Set xlBook = xlApp.Workbooks.Open(\"P:\\EMI\\Drop\\CARS Capps.csv\")        'ie \"C:\\My Documents\\Data To Import.xlsx\" xlApp.DisplayAlerts = False Workbook(\"CARS Capps.csv\").Activate\n        Sheets(\"Sheet1\").Activate                                        'Sheet1 should be the actual name of your work sheet\n        Range(\"a2\").Select\n        ActiveCell.EntireRow.Insert                                        'Insert a row below the header\n        Cells(2, 1).Value = \"aaa\" Cells(2, 2).Value = \"aaa\" Cells(2, 3).Value = \"aaa\" Cells(2, 4).Value = \"aaa\" Cells(2, 5).Value = \"aaa\" Cells(2, 6).Value = \"aaa\" Cells(2, 7).Value = \"5555\" Cells(2, 8).Value\n= \"5555\" Cells(2, 9).Value = \"aaa\" Cells(2, 10).Value = \"aaa\" Cells(2, 11).Value = \"aaa\" Cells(2, 12).Value = \"aaa\" Cells(2, 13).Value = \"aaa\" Cells(2, 14).Value = \"aaa\" Cells(2, 15).Value = \"aaa\" Cells(2, 16).Value = \"aaa\" Cells(2, 17).Value = \"aaa\" Cells(2, 18).Value = \"aaa\" Cells(2, 19).Value = \"aaa\" Cells(2, 20).Value = \"aaa\" Cells(2, 21).Value = \"aaa\" Cells(2, 22).Value = \"aaa\" Cells(2, 23).Value = \"aaa\" Cells(2, 24).Value = \"aaa\" Cells(2, 25).Value = \"aaa\" Cells(2, 26).Value = \"aaa\" Cells(2, 27).Value = \"aaa\" Cells(2, 28).Value = \"aaa\" Cells(2, 29).Value = \"aaa\" Cells(2, 30).Value = \"aaa\" Cells(2, 31).Value = \"aaa\" Cells(2, 32).Value = \"aaa\" Cells(2, 33).Value = \"aaa\" Cells(2, 34).Value = \"aaa\" Cells(2, 35).Value = \"aaa\" Cells(2, 36).Value = \"aaa\" Cells(2, 37).Value = \"aaa\" Cells(2, 38).Value = \"aaa\" Cells(2, 39).Value = \"aaa\" Cells(2, 40).Value = \"aaa\" Cells(2, 41).Value = \"aaa\" Cells(2, 42).Value = \"aaa\" Cells(2, 43).Value = \"aaa\" Cells(2, 44).Value = \"aaa\" Cells(2, 45).Value = \"aaa\" Cells(2, 46).Value = \"aaa\" Cells(2, 47).Value = \"aaa\" Cells(2, 48).Value = \"aaa\" Cells(2, 49).Value = \"aaa\" Cells(2, 50).Value = \"aaa\" Cells(2, 51).Value = \"aaa\" Cells(2, 52).Value = \"aaa\" Cells(2, 53).Value = \"aaa\" Cells(2, 54).Value = \"aaa\" Cells(2, 55).Value = \"aaa\" Cells(2, 56).Value = \"aaa\" Cells(2, 57).Value = \"aaa\" Cells(2, 58).Value = \"aaa\" Cells(2, 59).Value = \"aaa\" Cells(2, 60).Value = \"aaa\" Cells(2, 61).Value = \"aaa\"\n\nxlBook.Save Workbooks(\"Cars Capps.csv\").ClosexlApxlApp.Quit xlApp.DisplayAlerts = True Set xlBook = Nothing Set xlApp = Nothing\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1493836033, "post_id": 43767296, "comment_id": 74576337, "body": "Can you clarify? You want to populate a workbook with a list of empty cells ...? Do you mean you want to show the Cell Address of those empty cells? I.e. if <code>A1</code> and <code>A4</code>, and <code>A6</code> are empty, you want a new workbook that shows <code>A1</code>, <code>A4</code>, etc.?"}, {"owner": {"reputation": 645, "user_id": 2416553, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/0YUPF.jpg?s=128&g=1", "display_name": "CGTheLegend", "link": "https://stackoverflow.com/users/2416553/cgthelegend"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1493836242, "post_id": 43767296, "comment_id": 74576475, "body": "@BruceWayne Yes, sorry. I&#39;ll edit the post to try and make that more clear. Awesome handle by the way."}], "answers": [{"tags": [], "owner": {"reputation": 243, "user_id": 6456800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c7d9c1c5f3fb0426747663d2c944482?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/6456800/unknown"}, "is_accepted": false, "score": 4, "last_activity_date": 1493837124, "creation_date": 1493837124, "answer_id": 43767797, "question_id": 43767296, "link": "https://stackoverflow.com/questions/43767296/excel-list-of-blank-cells/43767797#43767797", "title": "Excel List of Blank Cells", "body": "<p>I assume you have data in sheet1, I have used sample range// Range(\"A1:c15\") however you can define range as per need and blank cells address will be published in next sheet.</p>\n\n<pre><code>Sub FindBlank()\nDim rng As Range\ndim i as long\n\nFor Each rng In Sheet1.Range(\"A1:c15\").SpecialCells(xlCellTypeBlanks)\ni = i + 1\nSheet2.Cells(i, 1) = rng.Address\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 645, "user_id": 2416553, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/0YUPF.jpg?s=128&g=1", "display_name": "CGTheLegend", "link": "https://stackoverflow.com/users/2416553/cgthelegend"}, "edited": false, "score": 0, "creation_date": 1493846396, "post_id": 43767801, "comment_id": 74581844, "body": "How do I get the first one to work? Where do I run it?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 645, "user_id": 2416553, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/0YUPF.jpg?s=128&g=1", "display_name": "CGTheLegend", "link": "https://stackoverflow.com/users/2416553/cgthelegend"}, "edited": false, "score": 0, "creation_date": 1493847638, "post_id": 43767801, "comment_id": 74582336, "body": "@CGTheLegend - You would add it to a workbook module. See <a href=\"http://www.contextures.com/xlvba01.html\" rel=\"nofollow noreferrer\">this page</a> for how to do that."}, {"owner": {"reputation": 645, "user_id": 2416553, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/0YUPF.jpg?s=128&g=1", "display_name": "CGTheLegend", "link": "https://stackoverflow.com/users/2416553/cgthelegend"}, "edited": false, "score": 0, "creation_date": 1493848561, "post_id": 43767801, "comment_id": 74582704, "body": "Yes I know how to do that, It&#39;s just when I run it nothing happens. I must be using the wrong range or something. How do I specify which sheet? I tried using a method similar to what @RamAnuragi used but it&#39;s giving me object errors."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 645, "user_id": 2416553, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/0YUPF.jpg?s=128&g=1", "display_name": "CGTheLegend", "link": "https://stackoverflow.com/users/2416553/cgthelegend"}, "edited": false, "score": 0, "creation_date": 1493849645, "post_id": 43767801, "comment_id": 74583120, "body": "@CGTheLegend - Check my edit. I added a <code>Worksheet</code> variable. Change the worksheet name as necessary. That should do it for you.  Note that <code>Sheet1</code> isn&#39;t <i>necessarily</i> the same as <code>Sheets(&quot;Sheet1&quot;)</code>."}, {"owner": {"reputation": 645, "user_id": 2416553, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/0YUPF.jpg?s=128&g=1", "display_name": "CGTheLegend", "link": "https://stackoverflow.com/users/2416553/cgthelegend"}, "edited": false, "score": 0, "creation_date": 1493851192, "post_id": 43767801, "comment_id": 74583624, "body": "Ok, so it works but not exactly how I want to. I want it to populate the each cell with one entry, not just give me the whole list in one cell. How do I go about that?"}, {"owner": {"reputation": 645, "user_id": 2416553, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/0YUPF.jpg?s=128&g=1", "display_name": "CGTheLegend", "link": "https://stackoverflow.com/users/2416553/cgthelegend"}, "edited": false, "score": 0, "creation_date": 1493851219, "post_id": 43767801, "comment_id": 74583635, "body": "Also, is there a way to not get an error if no results are found?"}, {"owner": {"reputation": 645, "user_id": 2416553, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/0YUPF.jpg?s=128&g=1", "display_name": "CGTheLegend", "link": "https://stackoverflow.com/users/2416553/cgthelegend"}, "edited": false, "score": 0, "creation_date": 1493851306, "post_id": 43767801, "comment_id": 74583653, "body": "And how do make this more modular so that I can have it fill up multiple columns?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 645, "user_id": 2416553, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/0YUPF.jpg?s=128&g=1", "display_name": "CGTheLegend", "link": "https://stackoverflow.com/users/2416553/cgthelegend"}, "edited": false, "score": 0, "creation_date": 1493851316, "post_id": 43767801, "comment_id": 74583656, "body": "@CGTheLegend - The second code will put one address in a cell, starting in <code>B2</code>, and going down the column. I&#39;ll edit it to show a message, if no empty cells are found."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 645, "user_id": 2416553, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/0YUPF.jpg?s=128&g=1", "display_name": "CGTheLegend", "link": "https://stackoverflow.com/users/2416553/cgthelegend"}, "edited": false, "score": 0, "creation_date": 1493851539, "post_id": 43767801, "comment_id": 74583733, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/143335/discussion-between-brucewayne-and-cgthelegend\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 3, "last_activity_date": 1493851518, "last_edit_date": 1493851518, "creation_date": 1493837140, "answer_id": 43767801, "question_id": 43767296, "link": "https://stackoverflow.com/questions/43767296/excel-list-of-blank-cells/43767801#43767801", "title": "Excel List of Blank Cells", "body": "<p>If you want a list of the cells that are empty, you can use <code>Range().SpecialCells(xlCellTypeBlank)</code>:</p>\n\n<pre><code>Sub getEmptyCellAddresses()\nDim rng As Range\nDim ws as Worksheet\nSet ws = Sheets(\"Sheet1\") ' CHANGE AS NECESSARY\nSet rng = ws.Range(\"A1:A15\").SpecialCells(xlCellTypeBlanks) ' Edit/change range as necessary\nws.Cells(1, 2).Value = rng.Cells.Address ' Change `ws.cells(1, 2)` to whatever destination you like\nEnd Sub\n</code></pre>\n\n<p>Edit: Ah, beaten by 16 seconds by @RamAnuragi ...but anyways, they're slightly different ways to tackle the question so I'll leave it. </p>\n\n<p>Edit: For funsies, here's another way to put them all in a column, one row per cell...and more, per your comments.</p>\n\n<pre><code>Sub listEmptyCells()\nDim emptyAddresses() As String\nDim i As Long\nDim ws As Worksheet\nDim rng As Range\n\nSet ws = Sheets(\"Sheet1\") ' CHANGE AS NECESSARY\nSet rng = ws.Range(\"A1:A15\")\n\nIf WorksheetFunction.CountBlank(rng) = 0 Then\n    MsgBox (\"No empty cells in the range\")\n    Exit Sub\nEnd If\n\nemptyAddresses() = Split(rng.SpecialCells(xlCellTypeBlanks).Address, \",\")\n\nFor i = LBound(emptyAddresses) To UBound(emptyAddresses)\n    ws.Cells(i + 1, 2).Value = emptyAddresses(i)\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 645, "user_id": 2416553, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/0YUPF.jpg?s=128&g=1", "display_name": "CGTheLegend", "link": "https://stackoverflow.com/users/2416553/cgthelegend"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1493851518, "creation_date": 1493835287, "last_edit_date": 1531161705, "question_id": 43767296, "link": "https://stackoverflow.com/questions/43767296/excel-list-of-blank-cells", "title": "Excel List of Blank Cells", "body": "<p>So I have a big excel sheet with a bunch of empty cells in various locations. I want an easy to work with list of which cells are empty. I was hoping to make a new worksheet that was populated with the locations of the empty cells. I wanted to have this to just populate the cells I want it to. I kept the header from the worksheet I will be checking and added a blank cells count, so I want the following cells in the column to be populated by the list of empty cell locations. </p>\n\n<p>Now I know I can use <a href=\"https://support.office.com/en-us/article/IS-functions-0f2d7971-6019-40a0-a171-f2d869135665\" rel=\"nofollow noreferrer\"><code>=ISBLANK</code></a> to test if a cell is empty or not, but I only care about the cells that return <code>TRUE</code>. So I figure I'll need a <a href=\"http://www.excel-easy.com/vba/loop.html\" rel=\"nofollow noreferrer\">loop</a>. And I want the location of the cell so I can use <a href=\"https://support.office.com/en-us/article/CELL-function-51bd39a5-f338-4dbe-a33f-955d67c2b2cf\" rel=\"nofollow noreferrer\"><code>=CELL</code></a>. And to make this most readable I want to do this on a column by column basis. </p>\n\n<p>But I want to populate a spreadsheet with this information in a manner similar to how functions work (I just want to copy and paste it to other cells and columns). But it's <a href=\"https://www.quora.com/What-the-difference-between-using-Excel-worksheet-formulas-and-macros\" rel=\"nofollow noreferrer\">pretty clear that I am going to need VBA</a>. </p>\n\n<p>My question is how can I create a macro to populate my spreadsheet with a list of empty cells? How do I apply it to the cells?</p>\n"}, {"tags": ["excel", "vba", "visual-c++", "mfc"], "comments": [{"owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 0, "creation_date": 1493835851, "post_id": 43767024, "comment_id": 74576215, "body": "You should probably start reading here: <a href=\"https://msdn.microsoft.com/en-us/library/d2tx7z6d(v=vs.110).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/d2tx7z6d(v=vs.110).aspx</a>"}, {"owner": {"reputation": 5085, "user_id": 1181353, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/zqKlZ.jpg?s=128&g=1", "display_name": "Joseph Willcoxson", "link": "https://stackoverflow.com/users/1181353/joseph-willcoxson"}, "edited": false, "score": 0, "creation_date": 1493844219, "post_id": 43767024, "comment_id": 74580730, "body": "1) First you verify you can write a VBA macro inside of Excel that has the functionality you want.  2) Then you use oleview.exe and browse to the type library of Excel (in excel.exe) and figure out what objects you need. 3) You can #import the library, or skip it and use CComDispatchDriver to make the calls.  On my installation the signature of the function in _Application is         <code>HRESULT Goto(                         [in, optional] VARIANT Reference,                          [in, optional] VARIANT Scroll,                          [in, lcid] long lcid);</code>"}, {"owner": {"reputation": 21, "user_id": 6284835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfe6d8e1c9867cacb0e80bb773f3ec6a?s=128&d=identicon&r=PG&f=1", "display_name": "Jo Jo", "link": "https://stackoverflow.com/users/6284835/jo-jo"}, "reply_to_user": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 0, "creation_date": 1493867124, "post_id": 43767024, "comment_id": 74587393, "body": "@RichHolton Thank you for your reply, but unfortunately I think I should stick with this."}, {"owner": {"reputation": 21, "user_id": 6284835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfe6d8e1c9867cacb0e80bb773f3ec6a?s=128&d=identicon&r=PG&f=1", "display_name": "Jo Jo", "link": "https://stackoverflow.com/users/6284835/jo-jo"}, "reply_to_user": {"reputation": 5085, "user_id": 1181353, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/zqKlZ.jpg?s=128&g=1", "display_name": "Joseph Willcoxson", "link": "https://stackoverflow.com/users/1181353/joseph-willcoxson"}, "edited": false, "score": 0, "creation_date": 1493867458, "post_id": 43767024, "comment_id": 74587480, "body": "@JoeWillcoxson Thank you for posting the comment for me. Your suggestion would be good solution. But because I know nothing about VBA macro, I&#39;m not sure whether I can write a VBA macro. I want to use it but I don&#39;t have much time."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1493884025, "post_id": 43767024, "comment_id": 74594478, "body": "You need to learn C++, MFC, COM (dispatch interface). Chances for you to solve this trivial task within one year: Zero."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6284835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfe6d8e1c9867cacb0e80bb773f3ec6a?s=128&d=identicon&r=PG&f=1", "display_name": "Jo Jo", "link": "https://stackoverflow.com/users/6284835/jo-jo"}, "edited": false, "score": 0, "creation_date": 1493983767, "post_id": 43789274, "comment_id": 74646607, "body": "Thanks to your answer, I solved the thing. It was really helpful. Also, thanks to you, now I think I have kind of a little insight into this Office development. Thank you so much."}, {"owner": {"reputation": 5085, "user_id": 1181353, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/zqKlZ.jpg?s=128&g=1", "display_name": "Joseph Willcoxson", "link": "https://stackoverflow.com/users/1181353/joseph-willcoxson"}, "reply_to_user": {"reputation": 21, "user_id": 6284835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfe6d8e1c9867cacb0e80bb773f3ec6a?s=128&d=identicon&r=PG&f=1", "display_name": "Jo Jo", "link": "https://stackoverflow.com/users/6284835/jo-jo"}, "edited": false, "score": 0, "creation_date": 1493996046, "post_id": 43789274, "comment_id": 74655072, "body": "Stackoverflow protocol is that when you like an answer you upvote it.  If an answer is the answer to your question, then you mark it as answered."}, {"owner": {"reputation": 21, "user_id": 6284835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfe6d8e1c9867cacb0e80bb773f3ec6a?s=128&d=identicon&r=PG&f=1", "display_name": "Jo Jo", "link": "https://stackoverflow.com/users/6284835/jo-jo"}, "edited": false, "score": 0, "creation_date": 1494001055, "post_id": 43789274, "comment_id": 74658255, "body": "Sorry, I forgot that."}], "tags": [], "owner": {"reputation": 5085, "user_id": 1181353, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/zqKlZ.jpg?s=128&g=1", "display_name": "Joseph Willcoxson", "link": "https://stackoverflow.com/users/1181353/joseph-willcoxson"}, "is_accepted": true, "score": 0, "last_activity_date": 1493918885, "creation_date": 1493918885, "answer_id": 43789274, "question_id": 43767024, "link": "https://stackoverflow.com/questions/43767024/how-can-i-control-the-scroll-bar-of-the-worksheet-in-mfc-excel/43789274#43789274", "title": "How can I control the scroll bar of the worksheet in MFC Excel?", "body": "<p>Honestly, it takes nothing to create a VBA macro to test your ideas first.  In Excel you go to the View tab and then at the far right open macros and create a macro.  After you figure out what works in VBA, then you translate to another language if necessary.  All Office development should start like that.</p>\n\n<p>If you look at the help for Application.GoTo you'll see that the first argument has to be something that specifies a valid range.  \"A10\" is not a valid range.  However, \"R10C1\" should be a valid range, specifying the 10th row and the first column.</p>\n\n<p>Something like this in C++ assuming your m_App is a CComPtr that wraps some sort of IDispatch:</p>\n\n<pre><code>_variant_t vResult;\nCComDispatchDriver ccdExcel(m_App);\nccdExcel.Invoke2(L\"GoTo\", &amp;_variant_t(L\"R10C1\"), &amp;_variant_t(VARIANT_TRUE), &amp;vResult);\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6284835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfe6d8e1c9867cacb0e80bb773f3ec6a?s=128&d=identicon&r=PG&f=1", "display_name": "Jo Jo", "link": "https://stackoverflow.com/users/6284835/jo-jo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 43789274, "answer_count": 1, "score": -1, "last_activity_date": 1493918885, "creation_date": 1493834351, "last_edit_date": 1493867753, "question_id": 43767024, "link": "https://stackoverflow.com/questions/43767024/how-can-i-control-the-scroll-bar-of-the-worksheet-in-mfc-excel", "title": "How can I control the scroll bar of the worksheet in MFC Excel?", "body": "<p>I'm developing MFC program using Excel Automation in VC++ 6.0.</p>\n\n<p>I want to control the scroll bar so I can place some cell on left top of the worksheet.</p>\n\n<p>I've found that there's a <em>Application::Goto()</em> method in VBA which can scroll the worksheet and bring specific cell to top left of the worksheet. \nWell, fortunately in library(Excel.h), I found the same method like following code.</p>\n\n<p><em>ADDED:</em></p>\n\n<pre><code>void _Application::Goto(const VARIANT&amp; Reference, const VARIANT&amp; Scroll)\n{\n    static BYTE parms[] =\n        VTS_VARIANT VTS_VARIANT;\n    InvokeHelper(0x1db, DISPATCH_METHOD, VT_EMPTY, NULL, parms,\n     &amp;Reference, &amp;Scroll);\n} \n</code></pre>\n\n<p>But I don't know how to use this method. \nI mean I don't know what the parameters should be. Although I've looked at the MSDN documents, It's only about VBA, not MFC.\n<a href=\"https://msdn.microsoft.com/library/office/ff839232(v=office.14).aspx\" rel=\"nofollow noreferrer\">The document</a> says, it can be <em>Range</em> object but I really have no idea.</p>\n\n<pre><code>m_App.Goto(COleVariant(\"A10\"), gotoScrollTrue); \n</code></pre>\n\n<p>Since I have no idea with using that \"<em>Range</em> object\" into <em>VARIANT&amp;</em>, so I just tried like this. However, invalid reference error occurred.</p>\n\n<p>I know it's hard to find information about Excel Automation with MFC, but I have no choice.</p>\n\n<p>I hope there will be someone who can save me.</p>\n\n<p>P.S. I can't switch to another tools like .NET framework. Now the program is working with hardware machine and also it contains many other functions not only moving scroll. And now I'm modifying codes written by my unknown senior. My program is kind of like <a href=\"https://support.microsoft.com/en-us/help/192348/how-to-automate-excel-and-then-know-the-user-closed-it\" rel=\"nofollow noreferrer\">this</a>. But MS is only providing these how-to-start like documents about VC++ MFC Excel Automation. I don't know but it feels like that it is an ancient relic. When I google with this, there are very few results which I wanted, and they are almost written about 10 years ago. Anyway, I know I'm clueless, but wish there is someone who knows how to develop Excel automation with VC++. </p>\n"}, {"tags": ["vba", "excel", "graph"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1493833835, "post_id": 43766835, "comment_id": 74575033, "body": "how is it suppose to work on all worksheets if you are not looping through all <code>Worksheets</code> ? you need to have ` For Each ws in ThisWorkbook.Worksheets` loop"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7958992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c79cad7c32102faeac0c25968b402ee?s=128&d=identicon&r=PG&f=1", "display_name": "&#193;gila", "link": "https://stackoverflow.com/users/7958992/%c3%81gila"}, "edited": false, "score": 0, "creation_date": 1493901878, "post_id": 43766951, "comment_id": 74606760, "body": "Really thanks, but it doesn&#39;t work yet. I am trying automate graphics first in one sheet. I changed the code according to your sugestion in a new workbook and the code runs for three of six graphs. There is graphics with two series or more. Sometime the code runs for both series of a graph, sometime only for one serie. (Sorry language mistakes)."}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "reply_to_user": {"reputation": 13, "user_id": 7958992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c79cad7c32102faeac0c25968b402ee?s=128&d=identicon&r=PG&f=1", "display_name": "&#193;gila", "link": "https://stackoverflow.com/users/7958992/%c3%81gila"}, "edited": false, "score": 0, "creation_date": 1493907500, "post_id": 43766951, "comment_id": 74611275, "body": "@&#193;gila Check it now."}], "tags": [], "owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "is_accepted": true, "score": 0, "last_activity_date": 1493907489, "last_edit_date": 1493907489, "creation_date": 1493834115, "answer_id": 43766951, "question_id": 43766835, "link": "https://stackoverflow.com/questions/43766835/vba-code-to-apply-only-the-last-data-label/43766951#43766951", "title": "VBA code to apply only the last data label", "body": "<p>You should over every-sheet, every chart, every series and points. <code>ApplyDataLabels</code> is a property a point not series or multiple points. <code>xlDataLabelsShowNone</code> Doesn't mean none of the points. It means that the label will not be shown in any format. You can read about this Object <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196984.aspx\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>Code below would do the job for you.</p>\n\n<pre><code>Sub remove_label()\n\n    Dim wsh As Worksheet\n    Dim oChart As ChartObject\n    Dim MySeries As Series\n    Dim oPoints As Points\n    Dim MyPoint As Point\n    Dim i As Long\n\n     For Each wsh In ThisWorkbook.Worksheets\n       For Each oChart In wsh.ChartObjects\n         For Each MySeries In oChart.Chart.SeriesCollection\n           Set oPoints = MySeries.Points\n             i = oPoints.Count\n                For Each MyPoint In oPoints\n                  i = i - 1\n                    If i &lt;&gt; 0 Then\n                     'Clear Existing Data Labels\n                      MyPoint.ApplyDataLabels xlDataLabelsShowNone\n                    Else\n                     'Apply Labels to Last Point\n                      MyPoint.ApplyDataLabels xlDataLabelsShowValue\n                    End If\n\n           Next MyPoint\n         Next MySeries\n       Next oChart\n     Next wsh\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7958992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c79cad7c32102faeac0c25968b402ee?s=128&d=identicon&r=PG&f=1", "display_name": "&#193;gila", "link": "https://stackoverflow.com/users/7958992/%c3%81gila"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1308, "favorite_count": 0, "accepted_answer_id": 43766951, "answer_count": 1, "score": 1, "last_activity_date": 1493907489, "creation_date": 1493833682, "last_edit_date": 1493874553, "question_id": 43766835, "link": "https://stackoverflow.com/questions/43766835/vba-code-to-apply-only-the-last-data-label", "title": "VBA code to apply only the last data label", "body": "<p>I don't speak English very well, but I hope you can understand me. </p>\n\n<p>It's about a VBA code for plotting graphs. I am trying to automate my sheets and I  found a simple and easy code in the internet to do so. After updating the series, my intention is to clear all data labels except for the last one.</p>\n\n<p>The code is: </p>\n\n<pre><code>Dim oChart As ChartObject\nDim MySeries As Series\n\nFor Each oChart In ActiveSheet.ChartObjects\n For Each MySeries In oChart.Chart.SeriesCollection\n\n    'Clear Existing Data Labels\n       MySeries.ApplyDataLabels (xlDataLabelsShowNone)\n\n    'Apply Labels to Last Point\n        MySeries.points(MySeries.points.Count).ApplyDataLabels\n\n    Next MySeries\nNext oChart\n\nEnd Sub\n</code></pre>\n\n<p>But, this code runs for only three of the ten graphs,  and doesn't  work for the others. I 've looked for similarities or differences among the series (like the name format or type of graphic - line, bar, pie) but I could not find the problem</p>\n\n<p>The first part of the macro wich is delete all data labels works correctly for all  the graphs, though. I also try to do it for more than one sheet and workbook, also unsuccessfully.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "edited": false, "score": 0, "creation_date": 1493832970, "post_id": 43766595, "comment_id": 74574525, "body": "If i understand correctly, cell in column A should be replaced with cell in column B if B contains any other value other than H?"}, {"owner": {"reputation": 1, "user_id": 7916545, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wbaoL2OLktY/AAAAAAAAAAI/AAAAAAAAAKc/EbOEndGwOQU/photo.jpg?sz=128", "display_name": "Kevin Lamaque", "link": "https://stackoverflow.com/users/7916545/kevin-lamaque"}, "reply_to_user": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "edited": false, "score": 0, "creation_date": 1493833028, "post_id": 43766595, "comment_id": 74574554, "body": "Yes that&#39;s right"}, {"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1493834395, "post_id": 43766595, "comment_id": 74575368, "body": "98 and 56 in cell A3 is merged.. i guess so..  @pnuts"}, {"owner": {"reputation": 1, "user_id": 7916545, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wbaoL2OLktY/AAAAAAAAAAI/AAAAAAAAAKc/EbOEndGwOQU/photo.jpg?sz=128", "display_name": "Kevin Lamaque", "link": "https://stackoverflow.com/users/7916545/kevin-lamaque"}, "edited": false, "score": 0, "creation_date": 1493834741, "post_id": 43766595, "comment_id": 74575562, "body": "I edit the post"}, {"owner": {"reputation": 1, "user_id": 7916545, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wbaoL2OLktY/AAAAAAAAAAI/AAAAAAAAAKc/EbOEndGwOQU/photo.jpg?sz=128", "display_name": "Kevin Lamaque", "link": "https://stackoverflow.com/users/7916545/kevin-lamaque"}, "edited": false, "score": 0, "creation_date": 1493837960, "post_id": 43766595, "comment_id": 74577472, "body": "Here a image <a href=\"http://imgur.com/a/pJ0Xe\" rel=\"nofollow noreferrer\">imgur.com/a/pJ0Xe</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7916545, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wbaoL2OLktY/AAAAAAAAAAI/AAAAAAAAAKc/EbOEndGwOQU/photo.jpg?sz=128", "display_name": "Kevin Lamaque", "link": "https://stackoverflow.com/users/7916545/kevin-lamaque"}, "edited": false, "score": 0, "creation_date": 1493836137, "post_id": 43766696, "comment_id": 74576404, "body": "A 0 will appear in c4 cause of b3 b4 aren&#39;t merged but c4  c3 are merged"}, {"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "reply_to_user": {"reputation": 1, "user_id": 7916545, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wbaoL2OLktY/AAAAAAAAAAI/AAAAAAAAAKc/EbOEndGwOQU/photo.jpg?sz=128", "display_name": "Kevin Lamaque", "link": "https://stackoverflow.com/users/7916545/kevin-lamaque"}, "edited": false, "score": 0, "creation_date": 1493884597, "post_id": 43766696, "comment_id": 74594822, "body": "@KevinLamaque add one more outer <code>IF</code> to blank out the 0 in that case"}, {"owner": {"reputation": 1, "user_id": 7916545, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wbaoL2OLktY/AAAAAAAAAAI/AAAAAAAAAKc/EbOEndGwOQU/photo.jpg?sz=128", "display_name": "Kevin Lamaque", "link": "https://stackoverflow.com/users/7916545/kevin-lamaque"}, "edited": false, "score": 0, "creation_date": 1494606942, "post_id": 43766696, "comment_id": 74917581, "body": "I tried something like <code>=IF(C1&lt;&gt;0, C)</code> but still getting 0 or false"}, {"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "reply_to_user": {"reputation": 1, "user_id": 7916545, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wbaoL2OLktY/AAAAAAAAAAI/AAAAAAAAAKc/EbOEndGwOQU/photo.jpg?sz=128", "display_name": "Kevin Lamaque", "link": "https://stackoverflow.com/users/7916545/kevin-lamaque"}, "edited": false, "score": 0, "creation_date": 1494607194, "post_id": 43766696, "comment_id": 74917716, "body": "@KevinLamaque try something like this , <code>=IF(C1&lt;&gt;0, C,&quot;&quot;)</code>"}, {"owner": {"reputation": 1, "user_id": 7916545, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wbaoL2OLktY/AAAAAAAAAAI/AAAAAAAAAKc/EbOEndGwOQU/photo.jpg?sz=128", "display_name": "Kevin Lamaque", "link": "https://stackoverflow.com/users/7916545/kevin-lamaque"}, "edited": false, "score": 0, "creation_date": 1494607465, "post_id": 43766696, "comment_id": 74917854, "body": "Oh that work but when i use paste special I choose values and skip blanks and still paste the cell in blank"}], "tags": [], "owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "is_accepted": false, "score": 0, "last_activity_date": 1493833148, "creation_date": 1493833148, "answer_id": 43766696, "question_id": 43766595, "link": "https://stackoverflow.com/questions/43766595/excel-macro-replace-cell-in-a-by-other-cell-in-b/43766696#43766696", "title": "Excel macro replace cell in A by other cell in B", "body": "<p>Just use this simple formula in column C,</p>\n\n<p><code>=IF(B1=\"H\",A1,B1)</code></p>\n\n<p>and drag it throughout the range. Once done, copy paste all of the data in column C to A (paste special)</p>\n"}], "owner": {"reputation": 1, "user_id": 7916545, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wbaoL2OLktY/AAAAAAAAAAI/AAAAAAAAAKc/EbOEndGwOQU/photo.jpg?sz=128", "display_name": "Kevin Lamaque", "link": "https://stackoverflow.com/users/7916545/kevin-lamaque"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1493837943, "creation_date": 1493832770, "last_edit_date": 1531161705, "question_id": 43766595, "link": "https://stackoverflow.com/questions/43766595/excel-macro-replace-cell-in-a-by-other-cell-in-b", "title": "Excel macro replace cell in A by other cell in B", "body": "<p>I have a excel document where I have something like this</p>\n\n<pre><code>     A    B     C\n1   1   45    a\n2   2   32    b    \n3   3   34    H\n4   3   37    \n5   4   49    i\n5   5   76    H\n</code></pre>\n\n<p>Note that 3c is combined but 3b isn't.<br>\nI need to do a macro to change the content of B with the content of C but only those that don't have a letter H. so the document would look like this</p>\n\n<pre><code>     A    B     C\n1   1    a    a\n2   2    b    b    \n3   3   34    H\n4   3   37    \n5   4    i       i\n5   5   76    H\n</code></pre>\n\n<p><a href=\"https://imgur.com/a/pJ0Xe\" rel=\"nofollow noreferrer\">Here a image</a></p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 1, "creation_date": 1494454861, "post_id": 43766570, "comment_id": 74841157, "body": "<a href=\"https://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\">Why accept an answer?</a>. Accepting an answer helps other people with the same question."}], "answers": [{"tags": [], "owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "is_accepted": false, "score": 2, "last_activity_date": 1493833697, "creation_date": 1493833697, "answer_id": 43766838, "question_id": 43766570, "link": "https://stackoverflow.com/questions/43766570/how-to-get-outlook-email-received-time/43766838#43766838", "title": "How to get Outlook Email received time", "body": "<p>I am just going to include the part that you need to change. Other lines will be the same. Basically, what you need to do is to set the <code>Totalmsg</code> inside your loop for each <code>msg</code>;</p>\n\n<pre><code>Sub Unzip()\n\n'... copy your code till here\n\nSet SubFolder = Inbox.Folders(\"TEST\")\noFrom = InputBox(\"Please give start time\", (\"Shadowserver report\"))\noEnd = InputBox(\"Please give End time\", (\"Shadowserver report\"))\n\n\n For Each msg In SubFolder.Items\n   Set Totalmsg = msg.ReceivedTime\n   If Totalmsg &lt;= oFrom And Totalmsg &gt;= oEnd Then 'You check it for each msg\n\n'rest will be the same until ...\n\n        FSO.deletefolder Environ(\"Temp\") &amp; \"\\Temporary Directory*\", True\n     End If\n    Next\n   End If\n Next\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 4849935, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2f41cf32379c603d3d8a8c59b9a5cf92?s=128&d=identicon&r=PG&f=1", "display_name": "kf dhivya", "link": "https://stackoverflow.com/users/4849935/kf-dhivya"}, "edited": false, "score": 1, "creation_date": 1493893877, "post_id": 43775621, "comment_id": 74601057, "body": "Hi R3uK, This worked like a pro. But let me know if it possible to have date included in this ?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 85, "user_id": 4849935, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2f41cf32379c603d3d8a8c59b9a5cf92?s=128&d=identicon&r=PG&f=1", "display_name": "kf dhivya", "link": "https://stackoverflow.com/users/4849935/kf-dhivya"}, "edited": false, "score": 1, "creation_date": 1493895431, "post_id": 43775621, "comment_id": 74602069, "body": "@kfdhivya : Yeah sure, if you want to input a date in the inputboxes, I guess that you&#39;d have to remove the <code>TimeValue</code> but the rest shouldn&#39;t need modification. Use breakpoints with <code>Debug.Print</code> or spies to check if the date are working well."}, {"owner": {"reputation": 85, "user_id": 4849935, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2f41cf32379c603d3d8a8c59b9a5cf92?s=128&d=identicon&r=PG&f=1", "display_name": "kf dhivya", "link": "https://stackoverflow.com/users/4849935/kf-dhivya"}, "edited": false, "score": 0, "creation_date": 1495023794, "post_id": 43775621, "comment_id": 75075749, "body": "Hi R3uk, i tried removing the TimeValue and i messed up with the whole thing could you please help me"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 85, "user_id": 4849935, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2f41cf32379c603d3d8a8c59b9a5cf92?s=128&d=identicon&r=PG&f=1", "display_name": "kf dhivya", "link": "https://stackoverflow.com/users/4849935/kf-dhivya"}, "edited": false, "score": 0, "creation_date": 1495025639, "post_id": 43775621, "comment_id": 75077164, "body": "@kfdhivya : Why did you want to remove the <code>TimeValue</code>? If it&#39;s from <code>TimeValue(ReceivedHour)</code>, you can&#39;t do it because <code>MsG.ReceivedTime</code> also contains the date, so you can&#39;t compare it with just a time stamp."}, {"owner": {"reputation": 85, "user_id": 4849935, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2f41cf32379c603d3d8a8c59b9a5cf92?s=128&d=identicon&r=PG&f=1", "display_name": "kf dhivya", "link": "https://stackoverflow.com/users/4849935/kf-dhivya"}, "edited": false, "score": 0, "creation_date": 1495447733, "post_id": 43775621, "comment_id": 75239600, "body": "sorry am just a beginner in this as per your previous comment i did but at the end i messed up with the whole code."}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 3, "last_activity_date": 1493880899, "last_edit_date": 1493880899, "creation_date": 1493880057, "answer_id": 43775621, "question_id": 43766570, "link": "https://stackoverflow.com/questions/43766570/how-to-get-outlook-email-received-time/43775621#43775621", "title": "How to get Outlook Email received time", "body": "<p>Made a few improvements to improve performance and clarity :</p>\n\n<ol>\n<li>Test received time inside the loop on the messages</li>\n<li>Defined related variables as Date (like <code>MsG.ReceivedTime</code>) and improved input messages</li>\n<li>Added <code>Option Explicit</code> to avoid mishaps in future coding (VERY GOOD PRACTICE)</li>\n<li>Use <code>Environ$(\"USERPROFILE\")</code> to get User directory's path</li>\n<li>Reorganize variables and initialisation outside of the loops</li>\n<li>Added <code>LCase</code> to be sure to get all zips (including <code>.ZIP</code>)</li>\n</ol>\n\n<p>Code :</p>\n\n<pre><code>Option Explicit\n\nSub Unzip()\n    '''Variables for the main functionality\n    Dim NS As NameSpace\n    Dim InboX As MAPIFolder\n    Dim SubFolder As MAPIFolder\n    Dim MsG As Outlook.MailItem\n    Dim AtcHmt As Attachment\n    Dim ReceivedHour As Date\n    Dim oFrom As Date\n    Dim oEnd As Date\n    '''Variables for unzipping\n    Dim FSO As Object\n    Dim ShellApp As Object\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set ShellApp = CreateObject(\"Shell.Application\")\n    Dim FileNameFolder As Variant\n    Dim FileName As Variant\n\n    '''Define the Outlook folder you want to scan\n    Set NS = GetNamespace(\"MAPI\")\n    Set InboX = NS.GetDefaultFolder(olFolderInbox)\n    Set SubFolder = InboX.Folders(\"TEST\")\n\n    '''Define the folder where you want to save attachments\n    FileNameFolder = Environ$(\"USERPROFILE\") &amp; \"\\Documents\\test\\\"\n\n    '''Define the hours in between which you want to apply the extraction\n    oFrom = CDate(InputBox(\"Please give Start time\" &amp; vbCrLf &amp; _\n                            \"Example: 9AM\", (\"Shadowserver report\"), \"9AM\"))\n    oEnd = CDate(InputBox(\"Please give End time\" &amp; vbCrLf &amp; _\n                            \"Example: 6PM\", (\"Shadowserver report\"), \"6PM\"))\n\n    For Each MsG In SubFolder.items\n        ReceivedHour = MsG.ReceivedTime\n        If oFrom &lt;= TimeValue(ReceivedHour) And _\n            TimeValue(ReceivedHour) &lt;= oEnd Then\n            For Each AtcHmt In MsG.Attachments\n                FileName = AtcHmt.FileName\n                If LCase(Right(FileName, 3)) &lt;&gt; \"zip\" Then\n                Else\n                    FileName = FileNameFolder &amp; FileName\n                    AtcHmt.SaveAsFile FileName\n\n                    ShellApp.NameSpace(FileNameFolder).CopyHere _\n                            ShellApp.NameSpace(FileName).items\n\n                    Kill (FileName)\n                    On Error Resume Next\n                    FSO.deletefolder Environ$(\"Temp\") &amp; \"\\Temporary Directory*\", True\n                End If\n            Next AtcHmt\n        End If\n    Next MsG\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 4849935, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2f41cf32379c603d3d8a8c59b9a5cf92?s=128&d=identicon&r=PG&f=1", "display_name": "kf dhivya", "link": "https://stackoverflow.com/users/4849935/kf-dhivya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12320, "favorite_count": 1, "accepted_answer_id": 43775621, "answer_count": 2, "score": 3, "last_activity_date": 1592994072, "creation_date": 1493832694, "last_edit_date": 1592994072, "question_id": 43766570, "link": "https://stackoverflow.com/questions/43766570/how-to-get-outlook-email-received-time", "title": "How to get Outlook Email received time", "body": "<p>I need to extract attachments from Emails received in a user preferred time frame. </p>\n\n<p>Say like extract for Emails received between 2PM to 4PM. </p>\n\n<p>Please find the below code I've that extract files perfectly - but it did for all the Emails in the folder. </p>\n\n<p>Please help me to resolve it.</p>\n\n<pre><code>Sub Unzip()\n\n    Dim ns As NameSpace             'variables for the main functionality\n    Dim Inbox As MAPIFolder\n    Dim SubFolder As MAPIFolder\n    Dim Atchmt As Attachment\n    Dim FileName As Variant\n    Dim msg As Outlook.MailItem\n\n\n    Dim FSO As Object               'variables for unzipping\n    Dim oApp As Object\n    Dim FileNameFolder As Variant\n    Dim Totalmsg As Object\n    Dim oFrom\n    Dim oEnd\n\n    Set ns = GetNamespace(\"MAPI\")\n    Set Inbox = ns.GetDefaultFolder(olFolderInbox)\n    Set SubFolder = Inbox.Folders(\"TEST\")\n    Set Totalmsg = msg.ReceivedTime\n    oFrom = InputBox(\"Please give start time\", (\"Shadowserver report\"))\n    oEnd = InputBox(\"Please give End time\", (\"Shadowserver report\"))\n\n   If Totalmsg &lt;= oFrom And Totalmsg &gt;= oEnd Then\n   For Each msg In SubFolder.Items\n            For Each Atchmt In msg.Attachments\n                    If (Right(Atchmt.FileName, 3) = \"zip\") Then\n                    MsgBox \"1\"\n\n                                    FileNameFolder = \"C:\\Users\\xxxx\\Documents\\test\\\"\n                                    FileName = FileNameFolder &amp; Atchmt.FileName\n                                    Atchmt.SaveAsFile FileName\n                                    Set oApp = CreateObject(\"Shell.Application\")\n                                    oApp.NameSpace(FileNameFolder).CopyHere oApp.NameSpace(FileName).Items\n\n                                    Kill (FileName)\n                                    On Error Resume Next\n                                    Set FSO = CreateObject(\"scripting.filesystemobject\")\n                                    FSO.deletefolder Environ(\"Temp\") &amp; \"\\Temporary Directory*\", True\n                    End If\n             Next\n    Next\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1493830788, "post_id": 43765943, "comment_id": 74573272, "body": "<code>If Worksheets(n).Cells(i, &quot;A&quot;).Value &lt;&gt; &quot;Oakville&quot; Then</code>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1493830848, "post_id": 43765943, "comment_id": 74573302, "body": "Does your code work? Note to use <code>Worksheets(n).Rows.Count</code> as without specifying the worksheet, you will be counting the rows on the active sheet.  Also, wouldn&#39;t you just do <code>If Cells(...).Value &lt;&gt; &quot;Specific Text&quot; Then &#47;&#47; ...EntireRow.Delete</code>?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1493832641, "post_id": 43765943, "comment_id": 74574335, "body": "@BruceWayne - <code>Worksheets(n)</code> does specify the worksheet, by using the Index property of the worksheets class."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1493832915, "post_id": 43765943, "comment_id": 74574499, "body": "@ScottHoltzman - Ah, yeah...I meant to point out that <code>Rows.Count</code> alone will use the ActiveSheet and it&#39;s best to add the worksheet beforehand, i.e. <code>Worksheets(n).Rows.Count</code>. Sorry if it was unclear.  (Although I suppose with <code>Rows.Count</code>, it doesn&#39;t matter what sheet, since it&#39;s always the same. It could avoid a possible error though)."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 5563763, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/369247d6e1541f021c965d4adc2634d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rovshan Aliyev", "link": "https://stackoverflow.com/users/5563763/rovshan-aliyev"}, "edited": false, "score": 0, "creation_date": 1493905219, "post_id": 43766020, "comment_id": 74609416, "body": "Do you know how can I add more than one text? It deletes even headings. So I want to add multiple text and heading. For example, don&#39;t delete office, oakville, toronto and etc.Can you help with that as well? I tried or but it deleted all rows for some reason :("}, {"owner": {"reputation": 1185, "user_id": 7848703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad638771bba77c82a12c225996904be?s=128&d=identicon&r=PG&f=1", "display_name": "India.Rocket", "link": "https://stackoverflow.com/users/7848703/india-rocket"}, "reply_to_user": {"reputation": 51, "user_id": 5563763, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/369247d6e1541f021c965d4adc2634d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rovshan Aliyev", "link": "https://stackoverflow.com/users/5563763/rovshan-aliyev"}, "edited": false, "score": 0, "creation_date": 1493917841, "post_id": 43766020, "comment_id": 74618503, "body": "To keep the heading change this step &#39;i = Last To 1 Step -1&#39; to &#39;i = Last To 2 Step -1&#39; and keep on adding the words &lt;&gt; with &#39;And&#39; condition. The query will be like this:-"}, {"owner": {"reputation": 1185, "user_id": 7848703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad638771bba77c82a12c225996904be?s=128&d=identicon&r=PG&f=1", "display_name": "India.Rocket", "link": "https://stackoverflow.com/users/7848703/india-rocket"}, "reply_to_user": {"reputation": 51, "user_id": 5563763, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/369247d6e1541f021c965d4adc2634d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rovshan Aliyev", "link": "https://stackoverflow.com/users/5563763/rovshan-aliyev"}, "edited": false, "score": 1, "creation_date": 1493917964, "post_id": 43766020, "comment_id": 74618576, "body": "Sub WorksheetLoop()   Dim c As Integer  Dim n As Integer   c = ActiveWorkbook.Worksheets.Count   For n = 1 To c Step 1     Last = Worksheets(n).Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row     For i = Last To 2 Step -1         If (Worksheets(n).Cells(i, &quot;A&quot;).Value) &lt;&gt; &quot;Oakville&quot; And (Worksheets(n).Cells(i, &quot;A&quot;).Value) &lt;&gt; &quot;Toronto&quot; Then             Worksheets(n).Cells(i, &quot;A&quot;).EntireRow.Delete         End If     Next i  Next n  End Sub"}, {"owner": {"reputation": 1185, "user_id": 7848703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad638771bba77c82a12c225996904be?s=128&d=identicon&r=PG&f=1", "display_name": "India.Rocket", "link": "https://stackoverflow.com/users/7848703/india-rocket"}, "reply_to_user": {"reputation": 51, "user_id": 5563763, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/369247d6e1541f021c965d4adc2634d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rovshan Aliyev", "link": "https://stackoverflow.com/users/5563763/rovshan-aliyev"}, "edited": false, "score": 0, "creation_date": 1493918022, "post_id": 43766020, "comment_id": 74618614, "body": "Happy to help:-}"}, {"owner": {"reputation": 51, "user_id": 5563763, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/369247d6e1541f021c965d4adc2634d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rovshan Aliyev", "link": "https://stackoverflow.com/users/5563763/rovshan-aliyev"}, "edited": false, "score": 0, "creation_date": 1493921592, "post_id": 43766020, "comment_id": 74620607, "body": "It seems like this code doesn&#39;t work if data is in table format, any thoughts how this code can be adjusted accordingly?"}, {"owner": {"reputation": 1185, "user_id": 7848703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad638771bba77c82a12c225996904be?s=128&d=identicon&r=PG&f=1", "display_name": "India.Rocket", "link": "https://stackoverflow.com/users/7848703/india-rocket"}, "reply_to_user": {"reputation": 51, "user_id": 5563763, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/369247d6e1541f021c965d4adc2634d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rovshan Aliyev", "link": "https://stackoverflow.com/users/5563763/rovshan-aliyev"}, "edited": false, "score": 0, "creation_date": 1493921888, "post_id": 43766020, "comment_id": 74620756, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/143432/discussion-between-india-rocket-and-rovshan-aliyev\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 1185, "user_id": 7848703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad638771bba77c82a12c225996904be?s=128&d=identicon&r=PG&f=1", "display_name": "India.Rocket", "link": "https://stackoverflow.com/users/7848703/india-rocket"}, "is_accepted": true, "score": 4, "last_activity_date": 1493830799, "creation_date": 1493830799, "answer_id": 43766020, "question_id": 43765943, "link": "https://stackoverflow.com/questions/43765943/keep-all-rows-with-specific-text-and-delete-the-rest/43766020#43766020", "title": "Keep all rows with specific text and delete the rest", "body": "<p>for example if you want rows with 'Oakville' then just change = to &lt;> in this code itself</p>\n\n<pre><code>Sub WorksheetLoop()\n\n Dim c As Integer\n Dim n As Integer\n c = ActiveWorkbook.Worksheets.Count\n For n = 1 To c Step 1\n    Last = Worksheets(n).Cells(Rows.Count, \"A\").End(xlUp).Row\n    For i = Last To 1 Step -1\n        If (Worksheets(n).Cells(i, \"A\").Value) &lt;&gt; \"Oakville\" Then\n            Worksheets(n).Cells(i, \"A\").EntireRow.Delete\n        End If\n    Next i\n Next n\n End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 0, "last_activity_date": 1493834991, "creation_date": 1493834991, "answer_id": 43767203, "question_id": 43765943, "link": "https://stackoverflow.com/questions/43765943/keep-all-rows-with-specific-text-and-delete-the-rest/43767203#43767203", "title": "Keep all rows with specific text and delete the rest", "body": "<p>Another way to achieve this is as below...</p>\n\n<pre><code>Sub DeleteRows()\nDim ws As Worksheet\nDim LastRow As Long, LastCol As Long    \nApplication.ScreenUpdating = False    \nFor Each ws In Worksheets\n    LastRow = ws.UsedRange.Rows.Count\n    LastCol = ws.UsedRange.Columns.Count + 1\n    With ws\n        .Range(.Cells(1, LastCol), .Cells(LastRow, LastCol)).Formula = \"=IF(A1=\"\"Oakville\"\",\"\"\"\",NA())\"\n        On Error Resume Next\n        .Range(.Cells(1, LastCol), .Cells(LastRow, LastCol)).SpecialCells(xlCellTypeFormulas, 16).EntireRow.Delete\n        .Columns(LastCol).Clear\n    End With\nNext ws\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1493843081, "last_edit_date": 1493843081, "creation_date": 1493842773, "answer_id": 43769280, "question_id": 43765943, "link": "https://stackoverflow.com/questions/43765943/keep-all-rows-with-specific-text-and-delete-the-rest/43769280#43769280", "title": "Keep all rows with specific text and delete the rest", "body": "<p>Consider the <code>AutoFilter</code> way, no need to loop, no need to worry about the order of deletion and no one-by-one deletion; it removes the undesired rows in one shot. This is definitely my recommended way to do it, give it a try: </p>\n\n<pre><code>Dim ws As Worksheet\nFor Each ws In ThisWorkbook.Worksheets\n   With ws.UsedRange\n     .AutoFilter 1, \"&lt;&gt;Oakville\"\n     .Offset(1).EntireRow.Delete\n     .AutoFilter\n   End With\nNext\n</code></pre>\n\n<p>This conserves \"Oakville\". Remove those <code>&lt;&gt;</code> to remove \"Oakville\".</p>\n"}], "owner": {"reputation": 51, "user_id": 5563763, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/369247d6e1541f021c965d4adc2634d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rovshan Aliyev", "link": "https://stackoverflow.com/users/5563763/rovshan-aliyev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 925, "favorite_count": 0, "accepted_answer_id": 43766020, "answer_count": 3, "score": 1, "last_activity_date": 1493843081, "creation_date": 1493830533, "question_id": 43765943, "link": "https://stackoverflow.com/questions/43765943/keep-all-rows-with-specific-text-and-delete-the-rest", "title": "Keep all rows with specific text and delete the rest", "body": "<p>I'm using this code to delete all rows with specific text in all worksheets. Is there any way that I can keep all rows with specific text and delete the rest? Your help is much appreciated.</p>\n\n<pre><code>Sub WorksheetLoop()\n\n Dim c As Integer\n Dim n As Integer\n c = ActiveWorkbook.Worksheets.Count\n For n = 1 To c Step 1\n    Last = Worksheets(n).Cells(Rows.Count, \"A\").End(xlUp).Row\n    For i = Last To 1 Step -1\n        If (Worksheets(n).Cells(i, \"A\").Value) = \"Oakville\" Then\n            Worksheets(n).Cells(i, \"A\").EntireRow.Delete\n        End If\n    Next i\n Next n\n End Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1493832169, "creation_date": 1493832169, "answer_id": 43766418, "question_id": 43765693, "link": "https://stackoverflow.com/questions/43765693/trying-to-send-emails-to-people-if-checkbox-is-checked/43766418#43766418", "title": "Trying to Send Emails to People if Checkbox is Checked", "body": "<p>This works for me.</p>\n\n<pre><code>Option Compare Database\n\nPrivate Sub Command1_Click()\n\nAllEmails = \"\"\nFor Each ctrl In Me.qry_Ryan_Emails.Controls\n\n    If TypeName(ctrl) = \"CheckBox\" Then\n        If ctrl.Enabled = True Then\n            AllEmails = AllEmails &amp; \" \" &amp; Me!qry_Ryan_Emails.Form.Work_Email\n        End If\n    End If\n\nNext ctrl\n\nSet OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n    eSubject = Me!Subject\n    eBody = Me!Message\n\n    On Error Resume Next\n\n    With OutMail\n        .To = AllEmails\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = eSubject\n        .BodyFormat = olFormatHTML\n        .Display\n        .HTMLBody = eBody &amp; vbCrLf &amp; .HTMLBody\n        .Send\n    End With\n\n    On Error GoTo 0\n    Set OutMail = Nothing\n    Set OutApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>This line concatenates all emails into one string.</p>\n\n<pre><code>AllEmails = AllEmails &amp; \" \" &amp; Me!qry_Ryan_Emails.Form.Work_Email\n</code></pre>\n\n<p>Then I just send 1 email to the group. </p>\n\n<p>This link is very useful for referencing controls on forms and subforms.</p>\n\n<p><a href=\"http://access.mvps.org/access/forms/frm0031.htm\" rel=\"nofollow noreferrer\">http://access.mvps.org/access/forms/frm0031.htm</a></p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1493909375, "last_edit_date": 1493909375, "creation_date": 1493848220, "answer_id": 43770587, "question_id": 43765693, "link": "https://stackoverflow.com/questions/43765693/trying-to-send-emails-to-people-if-checkbox-is-checked/43770587#43770587", "title": "Trying to Send Emails to People if Checkbox is Checked", "body": "<p>You can do essentially the same thing using a ListBox and selecting multiple items in the ListBox.</p>\n\n<pre><code>Option Compare Database\n\nPrivate Sub Command1_Click()\nDim varItem As Variant\nDim lngRow As Long\nDim strMsg As String\n\nAllEmails = \"\"\n\nWith Me.List_Emails\n    For lngRow = 0 To .ListCount - 1\n        If .Selected(lngRow) Then\n            AllEmails = AllEmails &amp; .Column(2, lngRow)\n        End If\n    Next lngRow\nEnd With\n\n\nSet OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n    eSubject = Me!Subject\n    eBody = Me!Message\n\n    On Error Resume Next\n\n    With OutMail\n        .To = AllEmails\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = eSubject\n        .BodyFormat = olFormatHTML\n        .Display\n        .HTMLBody = eBody &amp; vbCrLf &amp; .HTMLBody\n        '.Send\n    End With\n\n    On Error GoTo 0\n    Set OutMail = Nothing\n    Set OutApp = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 461, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594639994, "creation_date": 1493829651, "last_edit_date": 1594639994, "question_id": 43765693, "link": "https://stackoverflow.com/questions/43765693/trying-to-send-emails-to-people-if-checkbox-is-checked", "title": "Trying to Send Emails to People if Checkbox is Checked", "body": "<p>I'm using Access, a Form, and an Subform, and I'm trying to loop through checkboxes and if they are checked, send an email to the person that's checked off.</p>\n\n<p>The problem is that I have a method or data member not found.\nThis line throws an error.\nMe.qry_Ryan_Emails.Work_Email</p>\n\n<pre><code>Option Compare Database\n\nPrivate Sub Command1_Click()\n\nFor Each ctrl In Me.qry_Ryan_Emails.Controls\n\n    If TypeName(ctrl) = \"CheckBox\" Then\n        If ctrl.Enabled = True Then\n            'Debug.Print TypeName(ctrl)\n\n            Set OutApp = CreateObject(\"Outlook.Application\")\n                Set OutMail = OutApp.CreateItem(0)\n                eSubject = Me.Subject.Text\n                eBody = Me.Message.Text\n\n                On Error Resume Next\n\n                With OutMail\n                    .To = Me.qry_Ryan_Emails.Work_Email\n                    .CC = \"\"\n                    .BCC = \"\"\n                    .Subject = eSubject\n                    .BodyFormat = olFormatHTML\n                    .Display\n                    .HTMLBody = eBody &amp; vbCrLf &amp; .HTMLBody\n                    '.Send\n                End With\n\n                On Error GoTo 0\n                Set OutMail = Nothing\n                Set OutApp = Nothing\n\n\n        End If\n\n    End If\nNext ctrl\n\nEnd Sub\n</code></pre>\n\n<p>Finally, is it better to concatenate all email recipients into one email and just send out one email, rather than multiple emails?  That may be a better way of doing it.  Any thoughts, anyone?</p>\n"}, {"tags": ["vba", "loops"], "comments": [{"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 0, "creation_date": 1493829764, "post_id": 43765680, "comment_id": 74572675, "body": "Is this any language in particular; if so, what?"}, {"owner": {"reputation": 13, "user_id": 7636074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3333e62a19e9840ac16c9a68340e36cf?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/7636074/rob"}, "reply_to_user": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 0, "creation_date": 1493829919, "post_id": 43765680, "comment_id": 74572772, "body": "I am using Visual Baiscs"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7636074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3333e62a19e9840ac16c9a68340e36cf?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/7636074/rob"}, "edited": false, "score": 0, "creation_date": 1493832997, "post_id": 43766137, "comment_id": 74574537, "body": "thank you for pointing that out. I am trying to add the numbers of sum3 until they its just one digit. Say sum3 is 45 or 100, you add 4+5 or 1+0+0 to get the check digit. How would I fix it so its not a infinite loop"}], "tags": [], "owner": {"reputation": 362892, "user_id": 256196, "user_type": "moderator", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d84b558fd67be10d5a718fb94231909d?s=128&d=identicon&r=PG", "display_name": "Bohemian", "link": "https://stackoverflow.com/users/256196/bohemian"}, "is_accepted": false, "score": 1, "last_activity_date": 1493831209, "creation_date": 1493831209, "answer_id": 43766137, "question_id": 43765680, "link": "https://stackoverflow.com/questions/43765680/loop-through-a-string-to-find-the-odd-numbers-vb/43766137#43766137", "title": "Loop through a string to find the odd numbers VB", "body": "<p>\"it kind of freezes\" is lay speak for \"my code enters an <a href=\"https://en.m.wikipedia.org/wiki/Infinite_loop\" rel=\"nofollow noreferrer\">infinite loop</a>\".</p>\n\n<p>This looks suspicious:</p>\n\n<pre><code>Do While Sum3 &gt; 10\n    For j = 0 To Sum3.ToString.Length - 1\n         For k = 1 To Sum3.ToString.Length - 1\n             Sum3 = j + k\n         Next\n    Next\nLoop\n</code></pre>\n\n<p>To enter the loop, <code>Sum3</code> must be greater than 10. For the loop to exit, <code>Sum3</code> must not be greater than 10, but your code only <em>increments</em> <code>Sum3</code>, so <code>Sum3</code> can only stay greater than 10.</p>\n\n<p>This means that once entered, this loop is infinite.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 7954164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aa2cd406d6bf49bd0683521fab53384?s=128&d=identicon&r=PG&f=1", "display_name": "D_Element", "link": "https://stackoverflow.com/users/7954164/d-element"}, "is_accepted": false, "score": 0, "last_activity_date": 1493882060, "creation_date": 1493882060, "answer_id": 43776244, "question_id": 43765680, "link": "https://stackoverflow.com/questions/43765680/loop-through-a-string-to-find-the-odd-numbers-vb/43776244#43776244", "title": "Loop through a string to find the odd numbers VB", "body": "<p>If changing outer loop to inside loop doesn't help you</p>\n\n<p>Try this</p>\n\n<pre><code>Do While Sum3 &gt; 10 and j &lt; sum3        ' adding j &lt; sum3 might stop the loop\n    For j = 0 To Sum3.ToString.Length - 1\n         For k = 1 To Sum3.ToString.Length - 1\n             Sum3 = j + k\n         Next\n    Next\nLoop\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7636074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3333e62a19e9840ac16c9a68340e36cf?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/7636074/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1595204249, "creation_date": 1493829611, "last_edit_date": 1595204249, "question_id": 43765680, "link": "https://stackoverflow.com/questions/43765680/loop-through-a-string-to-find-the-odd-numbers-vb", "title": "Loop through a string to find the odd numbers VB", "body": "<p>I am looping through a card number finding all the odd numbers and multiplying them by the card digits. Its kind of hard to explain. I am having trouble multiplying the odd number and the card number. Here's an example my teacher gave me. You multiply card number 1 and and odd number 1 and so forth. I am not getting any errors, it just kind of freezes.</p>\n<pre><code>Sums        \nCard #:     1   2   3   4   5   6   7   8   9   0   1   2   3   4   5   6           \nMultiples   1       2       3       4       5       6       7       8               \nEvens:      2       4       6       8       0       2       4       6   32  =Sum 1  \nOdds:       1       6       15      28      45      6       21      40  162 =Sum 2  \n</code></pre>\n<pre><code>Sum 3:  194                                                             \n194 =Sum 3  \nStep 4: =1+9+4 = 14                                                                     \n= 1 + 4 = 5 = check digit\n</code></pre>\n<pre><code>Public Class Payment\nPrivate Sub OK_Click(sender As Object, e As EventArgs) Handles OK.Click\n    Dim Sum1 = 0\n    Dim Sum2 = 0\n    Dim Sum3 = 0\n    Dim ready As Boolean\n    Dim ccnumb = CardNumber.Text\n    Format(CardNumber.Text, &quot;################&quot;)\n    Dim exp = Mid(ExpDate.Text, 1, 3)\n    Dim checkdigit = 0\n    If FullName.TextLength = 0 Or cardtype.Text.Length = 0 And ccnumb.Length &lt;= 16 Or exp.Length = 2 Then\n        MessageBox.Show(&quot;Please enter all credit card information before proceeding.&quot;)\n        ready = False\n    Else ready = True\n    End If\n    If ready = True Then\n        For Each num As Char In ccnumb\n            If CInt(CStr(num)) Mod 2 &lt;&gt; 0 Then\n                Sum1 += CInt(CStr(num)) * CInt(CStr(num)) Mod 2 &lt;&gt; 0\n            Else\n                Sum2 += CInt(CStr(num))\n            End If\n        Next\n\n        Sum3 = Sum1 + Sum2\n        Do While Sum3 &gt; 10\n            For j = 0 To Sum3.ToString.Length - 1\n                For k = 1 To Sum3.ToString.Length - 1\n                    Sum3 = j + k\n                Next\n            Next\n        Loop\n        Do While exp.Length &gt; 1\n            checkdigit = Mid(ExpDate.Text, 1, 1) + Mid(ExpDate.Text, 1, 2)\n        Loop\n        If Sum3 = checkdigit Then\n            MessageBox.Show(&quot;Congratulations! Your payment was successful.&quot;)\n            CustInv.Show()\n        Else MessageBox.Show(&quot;The checkdigit,&quot; &amp; Space(1) &amp; Sum3 &amp; Space(1) &amp; &quot;does not match the month code,&quot; &amp; Space(1) &amp; checkdigit &amp; &quot;.&quot; &amp; Space(1) &amp; &quot;Please reenter your card information.&quot;)\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "adodb"], "comments": [{"owner": {"reputation": 21, "user_id": 5952659, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Cy4AHzA1Kco/AAAAAAAAAAI/AAAAAAAAcyU/V4W8MPluE58/photo.jpg?sz=128", "display_name": "Zac", "link": "https://stackoverflow.com/users/5952659/zac"}, "edited": false, "score": 0, "creation_date": 1493830913, "post_id": 43765620, "comment_id": 74573351, "body": "OneDrive for Business in Windows has an option to pause syncing for 2, 8 or 12 hours. That doesn&#39;t seem to help."}, {"owner": {"reputation": 150, "user_id": 1992646, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OTqGq.jpg?s=128&g=1", "display_name": "Krist&#243;f", "link": "https://stackoverflow.com/users/1992646/krist%c3%b3f"}, "edited": false, "score": 0, "creation_date": 1616402862, "post_id": 43765620, "comment_id": 117980830, "body": "I have the same read-only issue with an Excel file opened directly from a OneDrive share. The file has ADODB query reading (SQL SELECT) from the same file and the Open fails form me too."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 15181631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c59a416db57490b7b5469fbfc7abecdd?s=128&d=identicon&r=PG&f=1", "display_name": "Daquino", "link": "https://stackoverflow.com/users/15181631/daquino"}, "is_accepted": false, "score": 0, "last_activity_date": 1616517264, "last_edit_date": 1616517264, "creation_date": 1616516909, "answer_id": 66767265, "question_id": 43765620, "link": "https://stackoverflow.com/questions/43765620/odbc-lock-error-using-excel-workbook-in-synced-onedrive-folder-as-adodb-connecti/66767265#66767265", "title": "ODBC lock error using Excel workbook in synced OneDrive folder as ADODB connection", "body": "<p>I found a solution: pointing to a local file instead of a remote location. In order to do that, there's a simple string-replacing function that looks for the local file path by querying environment variables (those variables tell the system where OneDrive files are stored).</p>\n<p>I slightly amended the code, because the real location for me seemed to include &quot;onedrive.&quot;, which wasn't in the original code.</p>\n<p>Here's the full code:</p>\n<pre><code>Private Function getLocalFullName$(ByVal fullPath$)\n    'Finds local path for a OneDrive file URL, using environment variables of OneDrive\n    'Reference https://stackoverflow.com/questions/33734706/excels-fullname-property-with-onedrive\n    'Authors: Philip Swannell 2019-01-14, MatChrupczalski 2019-05-19, Horoman 2020-03-29, P.G.Schild 2020-04-02\n\n    Dim ii&amp;\n    Dim iPos&amp;\n    Dim oneDrivePath$\n    Dim endFilePath$\n\n    If Left(fullPath, 8) = &quot;https://&quot; Then 'Possibly a OneDrive URL\n        If InStr(1, fullPath, &quot;my.sharepoint.com&quot;) &lt;&gt; 0 Or InStr(1, fullPath, &quot;https://onedrive.&quot;) &lt;&gt; 0 Then 'Commercial OneDrive\n            'For commercial OneDrive, path looks like\n            ' &quot;https://companyName-my.sharepoint.com/personal/userName_domain_com/Documents&quot; &amp; file.FullName)\n            'Find &quot;/Documents&quot; in string and replace everything before the end with OneDrive local path\n            iPos = InStr(1, fullPath, &quot;/Documents&quot;) + Len(&quot;/Documents&quot;) 'find &quot;/Documents&quot; position in file URL\n            endFilePath = Mid(fullPath, iPos) 'Get the ending file path without pointer in OneDrive. Include leading &quot;/&quot;\n        Else 'Personal OneDrive\n            'For personal OneDrive, path looks like &quot;https://d.docs.live.net/d7bbaa#######1/&quot; &amp; file.FullName\n            'We can get local file path by replacing &quot;https..&quot; up to the 4th slash, with the OneDrive local path obtained from registry\n            iPos = 8 'Last slash in https://\n            For ii = 1 To 2\n                iPos = InStr(iPos + 1, fullPath, &quot;/&quot;) 'find 4th slash\n            Next ii\n            endFilePath = Mid(fullPath, iPos) 'Get the ending file path without OneDrive root. Include leading &quot;/&quot;\n        End If\n        endFilePath = Replace(endFilePath, &quot;/&quot;, Application.PathSeparator) 'Replace forward slashes with back slashes (URL type to Windows type)\n        \n        'getLocalFullName = getLocalOneDrivePath &amp; endFilePath\n        \n        For ii = 1 To 3 'Loop to see if the tentative LocalWorkbookName is the name of a file that actually exists, if so return the name\n            oneDrivePath = Environ(Choose(ii, &quot;OneDriveCommercial&quot;, &quot;OneDriveConsumer&quot;, &quot;OneDrive&quot;)) 'Check possible local paths. &quot;OneDrive&quot; should be the last one\n            If 0 &lt; Len(oneDrivePath) Then\n                getLocalFullName = oneDrivePath &amp; endFilePath\n                Exit Function 'Success (i.e. found the correct Environ parameter)\n            End If\n        Next ii\n        'Possibly raise an error here when attempt to convert to a local file name fails - e.g. for &quot;shared with me&quot; files\n        getLocalFullName = vbNullString\n    Else\n        getLocalFullName = fullPath\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5952659, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Cy4AHzA1Kco/AAAAAAAAAAI/AAAAAAAAcyU/V4W8MPluE58/photo.jpg?sz=128", "display_name": "Zac", "link": "https://stackoverflow.com/users/5952659/zac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 563, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1616517264, "creation_date": 1493829406, "last_edit_date": 1613509065, "question_id": 43765620, "link": "https://stackoverflow.com/questions/43765620/odbc-lock-error-using-excel-workbook-in-synced-onedrive-folder-as-adodb-connecti", "title": "ODBC lock error using Excel workbook in synced OneDrive folder as ADODB connection", "body": "<p>I have an Excel workbook in a synced OneDrive for Business folder that I want to use as a data source for an ADODB connection, which is called from code in the workbook itself.</p>\n<p>VBA throws an error when I try to establish the connection.</p>\n<blockquote>\n<p>-2147467259</p>\n<p>Microsoft OLE DB Provider for ODBC Drivers</p>\n<p>[Microsoft][ODBC Excel Driver]General error Unable to open registry key Temporary (volatile) Ace DSN for process 0x17e0 Thread 0x3cd4 DBC 0x920bf1c                                                            Excel'.</p>\n</blockquote>\n<p>The error does not happen if the file is in an unsynced folder, e.g. My Documents.</p>\n<p>All I need is read-only access to the connection. Can I form the connection string in a different way?</p>\n<p>I tried a different connection string, which I tried to make read-only (Mode=Read):</p>\n<pre><code>cn.ConnectionString = &quot;Provider=Microsoft.ACE.OLEDB.12.0;Mode=Read; _\nData Source=&quot; &amp; ActiveWorkbook.Path &amp; Application.PathSeparator &amp; _\nActiveWorkbook.Name &amp; &quot;; Extended Properties=&quot;&quot;Excel 12.0 Macro;HDR=YES&quot;&quot;;&quot;\n</code></pre>\n<p>I get a different error:</p>\n<blockquote>\n<p>-2147467259</p>\n<p>Microsoft Access Database Engine</p>\n<p>Cannot update. Database or object is read-only.</p>\n</blockquote>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub TestExcelADODB()\n    Dim cnx As New ADODB.Connection\n    Set cnx = OpenExcelConnection(ActiveWorkbook.Path, ActiveWorkbook.Name)\n    cn.Close\nEnd Sub\n</code></pre>\n<p>The error occurs on <code>cn.Open</code>:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function OpenExcelConnection(Path As String, File As String) _\n  As ADODB.Connection\n    Dim cn As New ADODB.Connection\n    If cn.State = adStateOpen Then cn.Close\n    cn.ConnectionString = &quot;Driver={Microsoft Excel Driver _\n      (*.xls, *.xlsx, *.xlsm, *.xlsb)};DBQ=&quot; &amp; _\n      Path &amp; Application.PathSeparator &amp; File\n    cn.Open\n    Set OpenExcelConnection = cn\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1493833071, "post_id": 43765447, "comment_id": 74574577, "body": "How isn&#39;t the code helpful? Does it run, but not work as expected? Does it throw an error (if so, what error/where)?  Also, is it a duplicate when <code>E1</code> on both sheets are the same? Or can a value in Sheet1, Col. E be anywhere in Sheet2 Column E?"}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1493834247, "post_id": 43765447, "comment_id": 74575274, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/13665305/how-do-i-delete-duplicates-between-two-excel-sheets-quickly-vba\">How do I delete duplicates between two excel sheets quickly vba</a>"}, {"owner": {"reputation": 63, "user_id": 7958383, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2241a4c84f472dacee442164dc2f15c8?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/7958383/neil"}, "edited": false, "score": 0, "creation_date": 1493844071, "post_id": 43765447, "comment_id": 74580643, "body": "sorry, I think is wrote that sentence wrong. There is nothing wrong with the script listed. There was something wrong with the Macro I tried to create. The script listed is what I am currently attempting to re-engineer to fit my specific situation.  This script compares two columns on one sheet and extracts data to a second sheet. That is not what I am attempting to do. I am trying to do a VLOOKUP for information from one sheet on another sheet to find duplicate value and then extract that data from the row onto a third sheet"}], "answers": [{"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 1, "last_activity_date": 1493918529, "creation_date": 1493918529, "answer_id": 43789186, "question_id": 43765447, "link": "https://stackoverflow.com/questions/43765447/comparing-two-excel-sheets-and-pulling-duplicate-data/43789186#43789186", "title": "Comparing two Excel Sheets and Pulling Duplicate Data", "body": "<p>You may try something like this...</p>\n\n<pre><code>Sub CopyDuplicates()\nDim ws1 As Worksheet, ws2 As Worksheet, ws3 As Worksheet\nDim lr1 As Long, lr2 As Long, lc1 As Long, lc2 As Long, r As Long\nDim rng As Range, cell As Range\nApplication.ScreenUpdating = False\n\nSet ws1 = Sheets(\"Sheet1\")\nSet ws2 = Sheets(\"Sheet2\")\nSet ws3 = Sheets(\"Sheet3\")\n\nws3.Cells.Clear\nlr2 = ws2.UsedRange.Rows.Count\nlc1 = ws1.UsedRange.Columns.Count\nlc2 = ws2.UsedRange.Columns.Count\n\nws1.UsedRange.Interior.ColorIndex = xlNone\nws2.UsedRange.Interior.ColorIndex = xlNone\n\nSet rng = ws2.Range(\"E1:E\" &amp; lr2)\nFor Each cell In rng\n    If Application.CountIf(ws1.Range(\"E:E\"), cell.Value) &gt; 0 Then\n        r = Application.Match(cell.Value, ws1.Range(\"E:E\"), 0)\n        ws1.Range(ws1.Cells(r, 1), ws1.Cells(r, lc1)).Interior.Color = vbRed\n        ws2.Range(ws2.Cells(r, 1), ws2.Cells(r, lc2)).Interior.Color = vbRed\n        cell.EntireRow.Copy ws3.Range(\"A\" &amp; Rows.Count).End(3)(2)\n    End If\nNext cell\nws3.Rows(1).Delete\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>The above code assumes that you have three sheets Sheet1, Sheet2 and Sheet3 in the workbook.</p>\n\n<p>The code will remove any existing cell interior color on Sheet1 and Sheet2 before highlighting the rows with duplicates found in red.</p>\n\n<p>If you have applied some color formatting to those sheets, better you use conditional formatting to highlight the rows with duplicates instead of coloring them through the VBA code.</p>\n"}], "owner": {"reputation": 63, "user_id": 7958383, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2241a4c84f472dacee442164dc2f15c8?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/7958383/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3547, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493918529, "creation_date": 1493828797, "last_edit_date": 1493830901, "question_id": 43765447, "link": "https://stackoverflow.com/questions/43765447/comparing-two-excel-sheets-and-pulling-duplicate-data", "title": "Comparing two Excel Sheets and Pulling Duplicate Data", "body": "<p>Goal:</p>\n\n<ol>\n<li>Search &amp; Compare two Fields Column E (Sheet 2) to Column E (Sheet 1)\n  Return duplicate Values from Sheet 2 to Sheet 3</li>\n<li>Show and Highlight Duplicates\n  Highlight Values on Sheet 1 and 2</li>\n<li>Copy Duplicate Entries from Sheet 2, then Add to Sheet 3</li>\n</ol>\n\n<p>If Column E(Sheet 2) = Column E(Sheet 1), then copy row(s) from (Sheet 2) and add to Sheet 3</p>\n\n<p>I am trying to compare two excel sheets within a workbook. I want to find duplicate values between sheet 2 and 1 and highlight those values on both sheets. I understand this is a match or vlookup function, but the added layer is I would like to copy those values only from sheet 2 to sheet 3 for visual comparison. I have tried to create a Macro, But this was not helpful and I am in the process of trying to edit this; </p>\n\n<pre><code>Sub rowContent()\n    Dim ws1 As Worksheet\n    Dim ws2 As Worksheet\n    Dim i As Long, j As Long\n    Dim isMatch As Boolean\n    Dim newSheetPos As Integer\n\nSet ws1 = ActiveWorkbook.Sheets(\"Sheet1\")\nSet ws2 = ActiveWorkbook.Sheets(\"Sheet2\")\n\n'Initial position of first element in sheet2\nnewSheetPos = ws2.Cells(ws2.Rows.Count, 1).End(xlUp).Row\n\nFor i = 1 To ws1.Cells(ws1.Rows.Count, 1).End(xlUp).Row\n    isMatch = False\n    For j = 1 To ws1.Cells(ws1.Rows.Count, 2).End(xlUp).Row\n        If ws1.Cells(i, 1).Value = ws1.Cells(j, 2).Value Then\n            ws1.Cells(j, 2).EntireRow.Copy ws2.Cells(newSheetPos, 1)\n            isMatch = True\n            newSheetPos = newSheetPos + 1\n        End If\n    Next j\n    If isMatch = False Then newSheetPos = newSheetPos + 1\nNext i\nEnd Sub\n</code></pre>\n\n<p>to work for my situation. Any help would be appreciated as I am no Excel Guru. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1493828571, "post_id": 43765358, "comment_id": 74572023, "body": "you need to use parenthesis when setting, so <code>set x=f(y)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5721429, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YISVJ2H3B8E/AAAAAAAAAAI/AAAAAAAAAXI/4BejcfxV-po/photo.jpg?sz=128", "display_name": "Thomas McKay-Smith", "link": "https://stackoverflow.com/users/5721429/thomas-mckay-smith"}, "edited": false, "score": 2, "creation_date": 1493829332, "post_id": 43765391, "comment_id": 74572426, "body": "Thanks. That did it... Set objMergedReq = objWord.Documents.Add(Template:=templatePath)"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 2, "last_activity_date": 1493828586, "creation_date": 1493828586, "answer_id": 43765391, "question_id": 43765358, "link": "https://stackoverflow.com/questions/43765358/in-vba-is-the-syntax-different-when-creating-an-object-vs-not/43765391#43765391", "title": "In VBA, is the syntax different when creating an object vs. not?", "body": "<p>you need to use parenthesis when setting, so <code>set x=f(y)</code> </p>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 3, "last_activity_date": 1506018014, "last_edit_date": 1506018014, "creation_date": 1493830849, "answer_id": 43766031, "question_id": 43765358, "link": "https://stackoverflow.com/questions/43765358/in-vba-is-the-syntax-different-when-creating-an-object-vs-not/43766031#43766031", "title": "In VBA, is the syntax different when creating an object vs. not?", "body": "<p>The crux is this:</p>\n\n<pre><code>objWord.Documents.Add Template:=templatePath\n</code></pre>\n\n<p>This is a function call, but the returned value (an object reference) is discarded and thus, the function is really used as if it were a procedure; with VBA's <em>implicit</em> procedure call syntax, parentheses are not present. You can use the [deprecated] <em>explicit</em> call syntax to require the parentheses:</p>\n\n<pre><code>Call objWord.Documents.Add(Template:=templatePath)\n</code></pre>\n\n<p>As you noticed, this is illegal:</p>\n\n<pre><code>Set objMergedReq = objWord.Documents.Add Template:=templatePath\n</code></pre>\n\n<p>Because the syntax for a <em>function call</em> (you're not discarding the returned value here) requires the parentheses whenever an argument list is specified:</p>\n\n<pre><code>Set objMergedReq = objWord.Documents.Add(Template:=templatePath)\n</code></pre>\n\n<p>If you're tempted to \"just use parentheses everywhere\", know that you'll run into other syntax issues, as soon as you need to specify 2 or more arguments:</p>\n\n<pre><code>MsgBox (message, vbOkOnly + vbInformation) 'illegal\n</code></pre>\n\n<p>That's because when arguments are surrounded by parentheses, you're really telling VBA to <em>evaluate the contents of the parentheses as a value</em>, and pass the result <code>ByVal</code> to the function/procedure, <em>even if that function/procedure is explicitly specifying the parameter as <code>ByRef</code></em>.</p>\n"}, {"tags": [], "owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "is_accepted": false, "score": 2, "last_activity_date": 1493831291, "creation_date": 1493831291, "answer_id": 43766166, "question_id": 43765358, "link": "https://stackoverflow.com/questions/43765358/in-vba-is-the-syntax-different-when-creating-an-object-vs-not/43766166#43766166", "title": "In VBA, is the syntax different when creating an object vs. not?", "body": "<p>When there is no return value, like when you use a Sub, or you ignore the return value, you don't put the parameters in parenthesis. Optionally, you can use \"Call\" and then put the parameters in parenthesis. </p>\n\n<p>In your example, </p>\n\n<pre><code>objWord.Documents.Add Template:=templatePath\n</code></pre>\n\n<p>the add method does create a return value, but you are not using it. Therefore, you either don't use parentheses (as you show), or you could use the \"Call\" statement:</p>\n\n<pre><code>Call objWord.Documents.Add(Template:=templatePath)\n</code></pre>\n\n<p>In your second example, you are using the return value, so parenthesis are required:</p>\n\n<pre><code>Set objMergedReq = objWord.Documents.Add(Template:=templatePath)\n</code></pre>\n\n<p>The \"Set\" is needed because you are assigning an object. The same rules apply if the return value is a non object -- you would just omit the \"Set\".</p>\n"}], "owner": {"reputation": 31, "user_id": 5721429, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YISVJ2H3B8E/AAAAAAAAAAI/AAAAAAAAAXI/4BejcfxV-po/photo.jpg?sz=128", "display_name": "Thomas McKay-Smith", "link": "https://stackoverflow.com/users/5721429/thomas-mckay-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1506018014, "creation_date": 1493828484, "last_edit_date": 1531164843, "question_id": 43765358, "link": "https://stackoverflow.com/questions/43765358/in-vba-is-the-syntax-different-when-creating-an-object-vs-not", "title": "In VBA, is the syntax different when creating an object vs. not?", "body": "<p>Apologies, this was difficult to word as a clear question.</p>\n\n<p>The following line is valid:</p>\n\n<pre><code>objWord.Documents.Add Template:=templatePath\n</code></pre>\n\n<p>But this line is not:</p>\n\n<pre><code>Set objMergedReq = objWord.Documents.Add Template:=templatePath\n</code></pre>\n\n<p>I get the following compiler error:</p>\n\n<pre><code>Expected: end of statement\n</code></pre>\n\n<p>Why are the two interpreted differently? How do I eliminate the error? Do I need extra parentheses in case 2?</p>\n"}, {"tags": ["vba", "excel", "directory"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1493827662, "post_id": 43765074, "comment_id": 74571490, "body": "use the <code>filesystemobject</code> and from its <code>folder</code> you can get the <code>subfolders</code> collection"}, {"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 2, "creation_date": 1493828392, "post_id": 43765074, "comment_id": 74571925, "body": "Check a recursive approach: <a href=\"http://stackoverflow.com/questions/22645347/loop-through-all-subfolders-using-vba\" title=\"loop through all subfolders using vba\">stackoverflow.com/questions/22645347/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1493829056, "creation_date": 1493829056, "answer_id": 43765511, "question_id": 43765074, "link": "https://stackoverflow.com/questions/43765074/open-all-the-files-in-subfolders/43765511#43765511", "title": "Open all the files in subfolders", "body": "<p>Some people don't like this approach as you get a small window pop up for a second.</p>\n\n<p>This will open all <em>.xls</em> workbooks - so xls, xlsx, xlsm, xlsb and any other flavour of xls</p>\n\n<pre><code>Public Sub OpenAllWorkbooks()\n\n    Dim vFiles As Variant\n    Dim vFile As Variant\n\n    vFiles = EnumerateFiles(\"&lt;Folder Path including final backslash - e.g. C:\\Windows\\&gt;\", \"xls*\")\n\n    For Each vFile In vFiles\n        Workbooks.Open vFile\n    Next vFile\n\nEnd Sub\n\nPublic Function EnumerateFiles(sDirectory As String, _\n            Optional sFileSpec As String = \"*\", _\n            Optional InclSubFolders As Boolean = True) As Variant\n\n    EnumerateFiles = Filter(Split(CreateObject(\"WScript.Shell\").Exec _\n        (\"CMD /C DIR \"\"\" &amp; sDirectory &amp; \"*.\" &amp; sFileSpec &amp; \"\"\" \" &amp; _\n        IIf(InclSubFolders, \"/S \", \"\") &amp; \"/B /A:-D\").StdOut.ReadAll, vbCrLf), \".\")\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7958642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2411623b8048c00f558b30a5577f4e23?s=128&d=identicon&r=PG&f=1", "display_name": "Carlo Mulattieri", "link": "https://stackoverflow.com/users/7958642/carlo-mulattieri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1907, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493839413, "creation_date": 1493827565, "last_edit_date": 1493839413, "question_id": 43765074, "link": "https://stackoverflow.com/questions/43765074/open-all-the-files-in-subfolders", "title": "Open all the files in subfolders", "body": "<p>Good morning, I am writing this code that allow me to open and copy a sheet in each macro file that I have in many subfolders.\nThe problem is that I have all these files in subfolders included in a folder but they have all different names.\nWhat should I add to this code?</p>\n\n<p>Thank you very much!</p>\n\n<pre><code>Application.EnableEvents = False\nApplication.ScreenUpdating = False\n\nPath = ActiveWorkbook.Path\n\nFileName = Dir(Path &amp; \"\\*.xlsm\", vbNormal)\n\nDo Until FileName = \"\"\n\n    Set Wkb = Workbooks.Open(FileName:=Path &amp; \"\\\" &amp; FileName, UpdateLinks:=3)\n    For Each ws In Wkb.Worksheets\n    Application.EnableEvents = False\n    Application.ScreenUpdating = False\n    wsName = ws.Name\n     If (wsName = \"Summary (Output)\") Then\n        ws.Copy After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)\n    Exit For\n     End If\n    Next ws\n    Wkb.Close False\n     FileName = Dir()\nLoop\n</code></pre>\n\n<p>I don't have put all the declaration, but there are :)</p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1493827860, "post_id": 43765057, "comment_id": 74571611, "body": "what is the data type of <code>lastrow</code> ? How many rows are available in your sheet ?"}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 1, "creation_date": 1493827884, "post_id": 43765057, "comment_id": 74571633, "body": "and what do you mean by &quot;breaking&quot; is it an error, just stopping, putting in random text..."}, {"owner": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "reply_to_user": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1493828458, "post_id": 43765057, "comment_id": 74571969, "body": "@sous2817 it&#39;s not giving me any error, just stopping. I have 11000 rows then i am adding more rows by inserting thats why i am using i = i + 1, so my lastrow adding up to 12000. So it is stopping at 9800. Can&#39;t figure out why"}], "answers": [{"comments": [{"owner": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "edited": false, "score": 0, "creation_date": 1493828551, "post_id": 43765293, "comment_id": 74572018, "body": "i = i + 1 which is for inserting row, i have to insert row to next one other wise it will keep on repeating."}, {"owner": {"reputation": 2466, "user_id": 3751420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MeAcM.jpg?s=128&g=1", "display_name": "Steve Lovell", "link": "https://stackoverflow.com/users/3751420/steve-lovell"}, "reply_to_user": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "edited": false, "score": 0, "creation_date": 1493828665, "post_id": 43765293, "comment_id": 74572082, "body": "Yeah, I get that. Does my version error in the same way?"}, {"owner": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "edited": false, "score": 0, "creation_date": 1493828736, "post_id": 43765293, "comment_id": 74572122, "body": "@ steve lovell no error, it worked perfect... awesome... can you please tell me how did you know you have to do this way, what&#39;s the difference between while and for... thank you so much"}, {"owner": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "edited": false, "score": 0, "creation_date": 1493828914, "post_id": 43765293, "comment_id": 74572194, "body": "@ steve Lovell -- one more question why did you add another i = i + 1 after end if"}, {"owner": {"reputation": 2466, "user_id": 3751420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MeAcM.jpg?s=128&g=1", "display_name": "Steve Lovell", "link": "https://stackoverflow.com/users/3751420/steve-lovell"}, "reply_to_user": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "edited": false, "score": 0, "creation_date": 1493828936, "post_id": 43765293, "comment_id": 74572208, "body": "It was mostly a guess, I wondered if the <code>Next i</code> might not increment when you&#39;d already added 1 since it was just ensuring each iteration of the loop finished with <code>i</code> one higher than it started."}, {"owner": {"reputation": 2466, "user_id": 3751420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MeAcM.jpg?s=128&g=1", "display_name": "Steve Lovell", "link": "https://stackoverflow.com/users/3751420/steve-lovell"}, "reply_to_user": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "edited": false, "score": 0, "creation_date": 1493829003, "post_id": 43765293, "comment_id": 74572247, "body": "One increment for adding a row, one for moving to the next row regardless of whether a row is added."}], "tags": [], "owner": {"reputation": 2466, "user_id": 3751420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MeAcM.jpg?s=128&g=1", "display_name": "Steve Lovell", "link": "https://stackoverflow.com/users/3751420/steve-lovell"}, "is_accepted": true, "score": 0, "last_activity_date": 1493828282, "creation_date": 1493828282, "answer_id": 43765293, "question_id": 43765057, "link": "https://stackoverflow.com/questions/43765057/loop-to-last-row-while-adding-rows/43765293#43765293", "title": "Loop to last row while adding rows", "body": "<p>@Nathan_Sav makes a good point. I'm not sure how the <code>i = i + 1</code> and <code>Next i</code> interact with each other. I'd try it this way:</p>\n\n<pre><code>i = 2\nWhile i &lt;= lastrow\n    If ws.Cells(i, 2).Value = \"4\" Then\n        Rows(i).Insert\n        Range(\"E\" &amp; i).Value = ws.Cells(i + 1, 5)\n        i = i + 1\n        lastrow = lastrow + 1\n    End If\n    i = i + 1\nWend\n</code></pre>\n\n<p>Without data to test this against, or the rest of the code, it's hard to be sure this will work ... so let me know how you get on.</p>\n"}], "owner": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 896, "favorite_count": 0, "accepted_answer_id": 43765293, "answer_count": 1, "score": 0, "last_activity_date": 1593677276, "creation_date": 1493827507, "last_edit_date": 1593677276, "question_id": 43765057, "link": "https://stackoverflow.com/questions/43765057/loop-to-last-row-while-adding-rows", "title": "Loop to last row while adding rows", "body": "<p>My loop is breaking a few thousand lines before the last row.</p>\n\n<p>Let's say last row is up to 12000, its looping until 9800.</p>\n\n<pre><code>For i = 2 To lastrow\n    If ws.Cells(i, 2).Value = \"4\" Then\n        Rows(i).Insert\n        Range(\"E\" &amp; i).Value = ws.Cells(i + 1, 5)\n        i = i + 1\n        lastrow = lastrow + 1\n    End If  \nNext i\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "edited": false, "score": 2, "creation_date": 1493828129, "post_id": 43765027, "comment_id": 74571767, "body": "Really want a macro? Why not an excel formula?"}], "answers": [{"tags": [], "owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "is_accepted": false, "score": 0, "last_activity_date": 1493830044, "creation_date": 1493830044, "answer_id": 43765791, "question_id": 43765027, "link": "https://stackoverflow.com/questions/43765027/excel-macro-to-calculate-number-of-working-days-hours-for-each-month/43765791#43765791", "title": "Excel Macro to calculate number of working days/hours for each month", "body": "<p>You can use the <a href=\"https://support.office.com/en-us/article/NETWORKDAYS-INTL-function-a9b26239-4f20-46a1-9ab8-4e925bfd5e28?ui=en-US&amp;rs=en-US&amp;ad=US\" rel=\"nofollow noreferrer\">NetworkDays</a> formula for this.</p>\n\n<pre><code>=NETWORKDAYS(StartDate, EndDate, [Holidays])\n</code></pre>\n\n<p>If you don't want Excel to count bank holidays you will need to supply the formula with a list.</p>\n\n<p>The number of working hours in a day isn't standard.  You will need to calculate this yourself (<code>Working Days * Working Hours in Day</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 1079, "user_id": 7958632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0916ae000536d01e601806fb5a429039?s=128&d=identicon&r=PG&f=1", "display_name": "LearningNew", "link": "https://stackoverflow.com/users/7958632/learningnew"}, "edited": false, "score": 0, "creation_date": 1493923104, "post_id": 43766299, "comment_id": 74621413, "body": "Thank you! There a a 100&#39;s of columns and I am trying to write a macro to update all the 12 columns automatically. I used the network days in my macro and tried to pass multiple holidays, then I got an error. But after I saved all the holidays in a different sheet and passed it to Network days it worked."}, {"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "reply_to_user": {"reputation": 1079, "user_id": 7958632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0916ae000536d01e601806fb5a429039?s=128&d=identicon&r=PG&f=1", "display_name": "LearningNew", "link": "https://stackoverflow.com/users/7958632/learningnew"}, "edited": false, "score": 0, "creation_date": 1493967490, "post_id": 43766299, "comment_id": 74636896, "body": "@LearningNew Great!! Please upvote and mark answer as correct if you found this useful."}], "tags": [], "owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "is_accepted": false, "score": 2, "last_activity_date": 1493831743, "creation_date": 1493831743, "answer_id": 43766299, "question_id": 43765027, "link": "https://stackoverflow.com/questions/43765027/excel-macro-to-calculate-number-of-working-days-hours-for-each-month/43766299#43766299", "title": "Excel Macro to calculate number of working days/hours for each month", "body": "<p>Assuming you have holidays on saturdays and sundays, you can try the below formula,</p>\n\n<p><code>=NETWORKDAYS(A2,B2,$G$2:$G$4)</code></p>\n\n<p>Where <code>G2:G4</code> is the holiday range. This is optional.\n<a href=\"https://i.stack.imgur.com/LQbGz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LQbGz.png\" alt=\"enter image description here\"></a></p>\n\n<p>Excel has another function which allows you to alter your weekends,</p>\n\n<p><code>=NETWORKDAYS.INTL (start_date, end_date, [weekend], [holidays])</code></p>\n\n<p>You can specify weekends and holidays as well. The below formula indicates that all days in a week are working days, (column E)</p>\n\n<p><code>=NETWORKDAYS.INTL(A2,B2,\"0000000\")</code></p>\n\n<p>If you have only 8 working hours a day, just multiply the difference with 8. Hope this helps</p>\n"}], "owner": {"reputation": 1079, "user_id": 7958632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0916ae000536d01e601806fb5a429039?s=128&d=identicon&r=PG&f=1", "display_name": "LearningNew", "link": "https://stackoverflow.com/users/7958632/learningnew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2302, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1493839365, "creation_date": 1493827399, "last_edit_date": 1493839365, "question_id": 43765027, "link": "https://stackoverflow.com/questions/43765027/excel-macro-to-calculate-number-of-working-days-hours-for-each-month", "title": "Excel Macro to calculate number of working days/hours for each month", "body": "<p>I have a start date and end date in two columns. There are 12 other columns one for each month. I am trying to run a macro which gives the number of working hours/days for each month in those 12 columns based on the start and end date</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 103, "user_id": 5025995, "user_type": "registered", "accept_rate": 21, "profile_image": "https://lh5.googleusercontent.com/-G32k6Uw1NjM/AAAAAAAAAAI/AAAAAAAAFdA/4LG5kiY3MCM/photo.jpg?sz=128", "display_name": "Scott Davies", "link": "https://stackoverflow.com/users/5025995/scott-davies"}, "is_accepted": false, "score": 0, "last_activity_date": 1493927180, "last_edit_date": 1493927180, "creation_date": 1493903654, "answer_id": 43783919, "question_id": 43764890, "link": "https://stackoverflow.com/questions/43764890/find-one-or-more-unique-words-in-any-cell-and-provide-a-specific-return-value-fo/43783919#43783919", "title": "Find one or more unique words in any cell and provide a specific return value for each in another cell", "body": "<p>If I understand your question correctly, you assign a value to each word eg</p>\n\n<pre><code>Word1 = 1\nWord2 = 2\nWord3 = 2.5\n</code></pre>\n\n<p>So you want to see something like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/xhWHd.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xhWHd.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Use this formula (if the values are pasted to column K row 2).  NB this is an array formula so you must enter it by pressing <kbd>Ctrl</kbd>+<kbd>Enter</kbd>. </p>\n\n<pre><code>=SUM(IFERROR(IF(FIND(\"Word1\", K2)&gt;0, 1, 0), 0), IFERROR(IF(FIND(\"Word2\", K2)&gt;0, 2, 0), 0), IFERROR(IF(FIND(\"Word3\", K2)&gt;0, 2.5, 0), 0))\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 2683544, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e335c5da0b95dcfd2a3dd3fc3d15f53d?s=128&d=identicon&r=PG&f=1", "display_name": "ucg-ky", "link": "https://stackoverflow.com/users/2683544/ucg-ky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493927180, "creation_date": 1493827037, "question_id": 43764890, "link": "https://stackoverflow.com/questions/43764890/find-one-or-more-unique-words-in-any-cell-and-provide-a-specific-return-value-fo", "title": "Find one or more unique words in any cell and provide a specific return value for each in another cell", "body": "<p>Sorry in advance if this is really basic for you all. I have been searching on the web and can't find the answer. </p>\n\n<p>I'm trying to find one or more unique words in any cell and provide a specific return value for each in excel. Some cells have multiple words in them. Others have just one. For example I want word1 to give a value in column A of the value \"1\". I want word2 to give a value in column A of \"0\". If both words are found together I need it to add both values together to make a single value. So like if word3 ended up being a value of 2.9 and word1 was also in the same cell, I would want them added making it a value of 3.9 in column A. </p>\n\n<p>Here's what I have so far:</p>\n\n<p>=IF(XOR(E2=\"word1\", E2=\"word2\"), 1,0)</p>\n\n<p>I've also tried:<br><br>\n=IF(IF(E2=\"word1\", 1, 0)+(E2=\"word2\", 1,0)<br>\n=IF(IF(E2=\"word1\", 1, 0) E2=\"word2\", 1,0) <br>\n=IF(AND(E2=\"word1\", E2=\"word2\"), 1,0)<br>\n=IF(OR(E2=\"word1\", E2=\"word2\"), 1,0)</p>\n\n<p>All I am getting is a return value for one of the words, or none on my current formula. But the other formulas I tried aren't valid formulas. So I'm unsure where to go. I thought for sure that the first one I tried would have worked...</p>\n\n<p>Any assistance would be greatly appreciated!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 4, "creation_date": 1493827231, "post_id": 43764613, "comment_id": 74571195, "body": "Could you clarify what the broken or non-working behavior is?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1493828474, "post_id": 43764613, "comment_id": 74571980, "body": "<code>While...Wend</code> is a[n outdated] control flow structure, <code>Wend</code> is a keyword. You know what a <i>method</i> is? That said you need to define what &quot;broken&quot; stands for."}, {"owner": {"reputation": 1, "user_id": 7956729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae025b3e63274ec05530fc0c3ab92c0d?s=128&d=identicon&r=PG&f=1", "display_name": "Darren", "link": "https://stackoverflow.com/users/7956729/darren"}, "edited": false, "score": 0, "creation_date": 1493891379, "post_id": 43764613, "comment_id": 74599345, "body": "When running I get the Run Time Error &quot;Method &#39;Busy&#39; of object &#39;IWebBrowser2&#39; failed.&quot;  By broken I mean it just causes the error and I cannot continue."}], "owner": {"reputation": 1, "user_id": 7956729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae025b3e63274ec05530fc0c3ab92c0d?s=128&d=identicon&r=PG&f=1", "display_name": "Darren", "link": "https://stackoverflow.com/users/7956729/darren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 167, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1493827558, "creation_date": 1493826240, "last_edit_date": 1531164843, "question_id": 43764613, "link": "https://stackoverflow.com/questions/43764613/excel-2016-vba-ie-while-busy-method-broken-since-windows-security-update", "title": "Excel 2016 VBA: IE While Busy method broken (since Windows security update)", "body": "<p>I've been using some code to open Internet Explorer and automatically select loads of options to make it easier for the end user. I've been using the following method to have the macro wait until my page is ready to carry on the method. Since the April Security update for windows (<a href=\"https://support.microsoft.com/en-gb/help/4014985/security-only-update-for-the-net-framework-3-5-1-4-5-2-4-6-4-6-1-and-4\" rel=\"nofollow noreferrer\">KB4014985</a>) it's started to break on some macros but not others.</p>\n\n<pre><code> Dim IE As Object\n    Set IE = CreateObject(\"InternetExplorer.application\")\n    With IE\n        .Visible = True\n        .Navigate (\"-Page Linked Here-\")\n        While .Busy Or .readyState &lt;&gt; 4: DoEvents: Wend\n    .Document.getElementById(\"ctl31_ctl04_ctl03\").Click\n    .Document.getElementById(\"ctl31_ctl04_ctl03_txtValue\").Click\n    .Document.getElementById(\"ctl31_ctl04_ctl03_divDropDown_ctl01\").Click\n    .Document.getElementById(\"ctl31_ctl04_ctl00\").Click\n    .Document.getElementById(\"VisibleReportContentctl31_ctl09\").Click\n        While .Busy Or .readyState &lt;&gt; 4: DoEvents: Wend\n        End With\n</code></pre>\n\n<p>The method </p>\n\n<pre><code> While .Busy Or .readyState &lt;&gt; 4: DoEvents: Wend\n</code></pre>\n\n<p>Just seems to have randomly stopped working on certain macros, some websites work and some don't, however there hasn't been any updates to the ones that don't work or the ones that do.</p>\n\n<p>I've tried other methods like Sleep, and other ways to write that current method, but nothing seems to work.</p>\n\n<p>Does anybody know the cause or fix for this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1493826691, "post_id": 43764463, "comment_id": 74570862, "body": "Will his matrix be input in a particular location in the workbook?"}, {"owner": {"reputation": 25, "user_id": 5885315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca3c3ed1da531e2508129439b476bdb4?s=128&d=identicon&r=PG&f=1", "display_name": "Julio", "link": "https://stackoverflow.com/users/5885315/julio"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1493826987, "post_id": 43764463, "comment_id": 74571038, "body": "Input matrix starts at Row 3, Column 4. The output matrix will be 2 rows underneath underneath the original matrix on the same worksheet."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1493827050, "post_id": 43764463, "comment_id": 74571072, "body": "First, that is horrible design. Output the new matrix to a new workbook, or at least to the side of the originla. Second, I was asking where the original matrix will be input. It is hard to provide code without knowing the design."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1493827500, "post_id": 43764463, "comment_id": 74571370, "body": "Do you need a macro? Wouldn&#39;t you be able to do this with formulas instead? Also you have a typo, <code>.FormulaRnC1</code>  should be <code>.FormulaR1C1</code>, and change <code>&quot;=RiC3</code> to just <code>&quot;=RC3</code>, etc., no?"}, {"owner": {"reputation": 25, "user_id": 5885315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca3c3ed1da531e2508129439b476bdb4?s=128&d=identicon&r=PG&f=1", "display_name": "Julio", "link": "https://stackoverflow.com/users/5885315/julio"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1493827660, "post_id": 43764463, "comment_id": 74571485, "body": "@Kyle A new workbook would be better, the matrix contains 124 columns."}, {"owner": {"reputation": 25, "user_id": 5885315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca3c3ed1da531e2508129439b476bdb4?s=128&d=identicon&r=PG&f=1", "display_name": "Julio", "link": "https://stackoverflow.com/users/5885315/julio"}, "edited": false, "score": 0, "creation_date": 1493827788, "post_id": 43764463, "comment_id": 74571573, "body": "@ BruceWayne I foresee myself doing this multiple times with other data, which is why I wanted to create the macro."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1493827934, "post_id": 43764463, "comment_id": 74571658, "body": "I&#39;ll post an answer shortly."}, {"owner": {"reputation": 25, "user_id": 5885315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca3c3ed1da531e2508129439b476bdb4?s=128&d=identicon&r=PG&f=1", "display_name": "Julio", "link": "https://stackoverflow.com/users/5885315/julio"}, "edited": false, "score": 0, "creation_date": 1493829433, "post_id": 43764463, "comment_id": 74572485, "body": "I greatly appreciate it!"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5885315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca3c3ed1da531e2508129439b476bdb4?s=128&d=identicon&r=PG&f=1", "display_name": "Julio", "link": "https://stackoverflow.com/users/5885315/julio"}, "edited": false, "score": 0, "creation_date": 1493830763, "post_id": 43765690, "comment_id": 74573258, "body": "I copy pasted the matrix to a new workbook, sheet one, starting at A1 as recommended but when running the code, the following appeared: &quot;Run-time error&#39;13&#39;: type mismatch&quot;"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "reply_to_user": {"reputation": 25, "user_id": 5885315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca3c3ed1da531e2508129439b476bdb4?s=128&d=identicon&r=PG&f=1", "display_name": "Julio", "link": "https://stackoverflow.com/users/5885315/julio"}, "edited": false, "score": 0, "creation_date": 1493830858, "post_id": 43765690, "comment_id": 74573310, "body": "Which line of code gives you the error? Did you put the code in the workbook with the matrix?"}, {"owner": {"reputation": 25, "user_id": 5885315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca3c3ed1da531e2508129439b476bdb4?s=128&d=identicon&r=PG&f=1", "display_name": "Julio", "link": "https://stackoverflow.com/users/5885315/julio"}, "edited": false, "score": 0, "creation_date": 1493832056, "post_id": 43765690, "comment_id": 74574012, "body": "I had it under a module in the personal.xlsb which is why it did not work. When I placed the code under the workbook with the matrix, it ran beautifully! Thank you Kyle."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "reply_to_user": {"reputation": 25, "user_id": 5885315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca3c3ed1da531e2508129439b476bdb4?s=128&d=identicon&r=PG&f=1", "display_name": "Julio", "link": "https://stackoverflow.com/users/5885315/julio"}, "edited": false, "score": 0, "creation_date": 1493832399, "post_id": 43765690, "comment_id": 74574191, "body": "Certainly, happy to help."}], "tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": true, "score": 1, "last_activity_date": 1493829649, "creation_date": 1493829649, "answer_id": 43765690, "question_id": 43764463, "link": "https://stackoverflow.com/questions/43764463/how-to-loop-through-a-matrix-in-vba-excel/43765690#43765690", "title": "How to loop through a matrix in VBA Excel?", "body": "<p>I will recommend you put your first matrix on <code>Sheet1</code> starting in cell A1. This will output the other Matrix to the new workbook, Sheet1, starting in cell A1. </p>\n\n<pre><code>Sub example()\nDim x As Variant, y As Variant\nDim row_sum As Double\nDim i As Integer, j As Integer\nDim wbk As Workbook\n\nWith ThisWorkbook.Sheets(1)\n    x = .Range(\"a1:\" &amp; .Cells(.Range(\"a\" &amp; .Rows.Count).End(xlUp).Row, .Cells(1, .Columns.Count).End(xlToLeft).Column).Address).Value2\nEnd With\n\ny = x\n\nWith Application.WorksheetFunction\n    For i = LBound(x, 1) To UBound(x, 1)\n        row_sum = .Sum(.Index(x, i))\n            For j = LBound(x, 2) To UBound(x, 2)\n                y(i, j) = x(i, j) / row_sum\n            Next j\n    Next i\nEnd With\n\nSet wbk = Workbooks.Add\n\nwbk.Sheets(1).Range(\"a1\").Resize(UBound(y, 1), UBound(y, 2)) = y\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5885315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca3c3ed1da531e2508129439b476bdb4?s=128&d=identicon&r=PG&f=1", "display_name": "Julio", "link": "https://stackoverflow.com/users/5885315/julio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2123, "favorite_count": 0, "accepted_answer_id": 43765690, "answer_count": 1, "score": 1, "last_activity_date": 1493884513, "creation_date": 1493825779, "last_edit_date": 1531161705, "question_id": 43764463, "link": "https://stackoverflow.com/questions/43764463/how-to-loop-through-a-matrix-in-vba-excel", "title": "How to loop through a matrix in VBA Excel?", "body": "<p>I am trying to make a macro that will create a matrix based upon an equation in an VBA.</p>\n\n<p>For example:\nIf I have the following 3x3 matrix:</p>\n\n<pre><code>3  5  7\n6  3  4\n1  2  3\n</code></pre>\n\n<p>I want to create a 3x3 matrix that takes the value 1st value and divides it by the sum of the row, and so on.</p>\n\n<pre><code>0.2  0.3  0.5\n0.5  0.2  0.3\n0.2  0.3  0.5\n</code></pre>\n\n<p>I tried the following code:</p>\n\n<pre><code>Sheets(\"sheet1\").Select\nRange(\"C2\").Select\nSelection.End(xlDown).Select\nActiveCell.Offset(2, 0).Range(\"A1\").Select 'So the new matrix starts underneath the old matrix\nDim i As Integer\nDim n As Integer\ni = 4\nn = 1\nDo While Cells(i, 3).Value &lt;&gt; \"\"\n    ActiveCell.FormulaRnC1 = \"=RiC3/SUM(RiC3:RiC52)*100\"\n    i = i + 1\nActiveCell.Offset(1, 0).Range(\"A1\").Select\n</code></pre>\n\n<p>The number or rows will vary.</p>\n\n<p>I have limited experience with this platform, please let me know how to improve framing this question.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1493825846, "post_id": 43764403, "comment_id": 74570281, "body": "@pnuts - if i don&#39;t have to write code for this then I&#39;d like that better. Just trying to get an idea of how I&#39;d go about it"}], "answers": [{"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": true, "score": 1, "last_activity_date": 1493826631, "creation_date": 1493826631, "answer_id": 43764754, "question_id": 43764403, "link": "https://stackoverflow.com/questions/43764403/excel-looking-through-two-columns-of-values-and-finding-values-that-dont-exist/43764754#43764754", "title": "excel looking through two columns of values and finding values that don&#39;t exist in one of the columns", "body": "<p>Please select ColumnA and HOME > Styles - Conditional Formatting, New Rule..., <em>Use a formula to determine which cells to format</em> and <strong>Format values where this formula is true:</strong>:  </p>\n\n<pre><code>=AND(A1&lt;&gt;\"\",COUNTIF(B:B,A1)=0)\n</code></pre>\n\n<p><kbd>Format...</kbd>, select your choice of formatting, OK, OK.</p>\n"}], "owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 43764754, "answer_count": 1, "score": 1, "last_activity_date": 1493826631, "creation_date": 1493825635, "last_edit_date": 1493825815, "question_id": 43764403, "link": "https://stackoverflow.com/questions/43764403/excel-looking-through-two-columns-of-values-and-finding-values-that-dont-exist", "title": "excel looking through two columns of values and finding values that don&#39;t exist in one of the columns", "body": "<p>I have two columns of data in my excel spreadsheet - i pulled this data from SQL server but I feel like I might an easier time doing this in excel</p>\n\n<pre><code>ColumnA   ColumnB\n123       123\n234       234\n456       456\n678       677\n679       679\n</code></pre>\n\n<p>So basically COLUMN A has all the correct values, so I'd like to use that column as my reference. I want to use the values in ColumnA to find a matching value in ColumnB - not necessarily in the same row, but look through the entire column. If there's no corresponding value then highlight or put in bold the value in ColumnA (since that column has all possible values).</p>\n\n<p>If we assume that ColumnA and ColumnB data are complete ....I'd want to see value 678 highlighted since ColumnB does not have 678.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"tags": [], "owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "is_accepted": false, "score": 0, "last_activity_date": 1493831452, "creation_date": 1493831452, "answer_id": 43766218, "question_id": 43764374, "link": "https://stackoverflow.com/questions/43764374/microsoft-access-vba-button-to-filter-report/43766218#43766218", "title": "Microsoft Access VBA: Button to Filter Report", "body": "<p>Looks like your IdentNo is a text field.  You need to scope it with single quotes.  So:</p>\n\n<pre><code>If Len(Trim(id)) &gt; 0 Then\n    DoCmd.OpenReport \"RARL Requests Report\", acViewPreview, , \"[IDENT NO] like '\" &amp; id &amp; \"'\", acWindowNormal\nEnd If\n</code></pre>\n\n<p>If it were not text (i.e. Int or Double) then you would do it the way you had it; no single quotes needed.</p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 7673602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8d16877696647f5405e0cb5429b2c893?s=128&d=identicon&r=PG&f=1", "display_name": "Xcelrate", "link": "https://stackoverflow.com/users/7673602/xcelrate"}, "edited": false, "score": 0, "creation_date": 1493832794, "post_id": 43766236, "comment_id": 74574421, "body": "Is it possible to modify the above so that it would open any reports that begin with what the user entered. So for example if I had reports with IDENT NO&#39;s 1940-1, 1940-2 and 1940-3 and the user only entered 1940 into the InputBox, it would display all 3 of those reports?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 41, "user_id": 7673602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8d16877696647f5405e0cb5429b2c893?s=128&d=identicon&r=PG&f=1", "display_name": "Xcelrate", "link": "https://stackoverflow.com/users/7673602/xcelrate"}, "edited": false, "score": 0, "creation_date": 1493833781, "post_id": 43766236, "comment_id": 74575003, "body": "<code>&quot;[IDENT NO] LIKE &#39;&quot; &amp; id &amp; &quot;*&#39;&quot;</code> - A combobox would still be my recommended approach. Just set to not restrict input to listed values. But the list would still be there to guide users for valid complete ID numbers."}, {"owner": {"reputation": 41, "user_id": 7673602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8d16877696647f5405e0cb5429b2c893?s=128&d=identicon&r=PG&f=1", "display_name": "Xcelrate", "link": "https://stackoverflow.com/users/7673602/xcelrate"}, "edited": false, "score": 0, "creation_date": 1493835176, "post_id": 43766236, "comment_id": 74575830, "body": "I see what you are getting at. Is there a combobox function that I can replace the InputBox with in that line of code such that I still click the button to open up the combo box selection? Also if this is the case, does the remainder of the code require additional modification?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 41, "user_id": 7673602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8d16877696647f5405e0cb5429b2c893?s=128&d=identicon&r=PG&f=1", "display_name": "Xcelrate", "link": "https://stackoverflow.com/users/7673602/xcelrate"}, "edited": false, "score": 0, "creation_date": 1493835829, "post_id": 43766236, "comment_id": 74576198, "body": "Name combobox something like cbxID, then: <code>&quot;[IDENT NO] LIKE &#39;&quot; &amp; Me.cbxID &amp; &quot;*&#39;&quot;</code>"}, {"owner": {"reputation": 41, "user_id": 7673602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8d16877696647f5405e0cb5429b2c893?s=128&d=identicon&r=PG&f=1", "display_name": "Xcelrate", "link": "https://stackoverflow.com/users/7673602/xcelrate"}, "edited": false, "score": 0, "creation_date": 1493836242, "post_id": 43766236, "comment_id": 74576474, "body": "Alright. Is it possible to generate the combobox from the code though. something like cbxID = ComboBox(Fields), in the place of id = InputBox (Fields) or is this not possible in Access?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 41, "user_id": 7673602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8d16877696647f5405e0cb5429b2c893?s=128&d=identicon&r=PG&f=1", "display_name": "Xcelrate", "link": "https://stackoverflow.com/users/7673602/xcelrate"}, "edited": false, "score": 0, "creation_date": 1493838997, "post_id": 43766236, "comment_id": 74577983, "body": "A combobox is a control on a form. So no, what you described is not intrinsically possible in Access."}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": true, "score": 0, "last_activity_date": 1493831513, "creation_date": 1493831513, "answer_id": 43766236, "question_id": 43764374, "link": "https://stackoverflow.com/questions/43764374/microsoft-access-vba-button-to-filter-report/43766236#43766236", "title": "Microsoft Access VBA: Button to Filter Report", "body": "<p>Your ID 'numbers' are text values. So the ID field is a text type. Filter parameters for a text field require apostrophe delimiters. Using LIKE operator without * wildcard accomplishes nothing more than using = sign.</p>\n\n<p><code>DoCmd.OpenReport \"RARL Requests Report\", acViewPreview, , \"[IDENT NO] = '\" &amp; id &amp; \"'\", acWindowNormal</code></p>\n\n<p>I did a test with and without apostrophes. Without I got two popup input prompts, with apostrophes only the InputBox popped up. However, in both cases the report still opened filtered and with data. So something else may be going on with your issue. Might require direct review of your db. If you want to provide, can upload to a fileshare site such as Box.com and post link to the file.</p>\n\n<p>Hard to validate InputBox entry. The report runs even if the entry is not valid causing frustration for user. Would be better to use a combobox on a form for user selection of ID. </p>\n\n<p>Advise no spaces or punctuation/special characters (underscore only exception) in names.</p>\n"}], "owner": {"reputation": 41, "user_id": 7673602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8d16877696647f5405e0cb5429b2c893?s=128&d=identicon&r=PG&f=1", "display_name": "Xcelrate", "link": "https://stackoverflow.com/users/7673602/xcelrate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2364, "favorite_count": 0, "accepted_answer_id": 43766236, "answer_count": 2, "score": 0, "last_activity_date": 1493831513, "creation_date": 1493825569, "question_id": 43764374, "link": "https://stackoverflow.com/questions/43764374/microsoft-access-vba-button-to-filter-report", "title": "Microsoft Access VBA: Button to Filter Report", "body": "<p>I have created a report in Microsoft Access, which provides users with data including identification number, locations, notes, etc. stored in a data table called Report Data. When I click to open the report, it will load all 2000+ 1 page reports (1 Per IDENT NO). However, I want only the 1 report the user selects by entering the IDENT NO to be loaded/displayed.</p>\n\n<p>I have created a button with the following code below, which I want to filter my reports by IDENT NO entered by a user when clicked (When the user clicks the button, a pop-up will ask for the IDENT NO, and then I want to only open the single report associated with that IDENT NO). However when I do so, it will load only the 1 page report like I want it to do, however none of the other data fields are filled in. I have been playing around with the code for a while now, but I can't seem to figure out if the issue is based on the code below, or due to another issue.</p>\n\n<p>For Reference, the identification numbers take the form of a number with a dash and then a version like so: 1940-1 or 1940-2 or 2910-1 are all examples of identification numbers.  </p>\n\n<pre><code>Private Sub Command33_Click()\n\nDim id As String\n    id = InputBox(\"Enter the identification number:\", \"Report Filter\")\n\n'if a value was entered, open and filter report\nIf Len(Trim(id)) &gt; 0 Then\n    DoCmd.OpenReport \"RARL Requests Report\", acViewPreview, , \"[IDENT NO] like \" &amp; id, acWindowNormal\nEnd If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "stochastic-process"], "comments": [{"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493825873, "post_id": 43764341, "comment_id": 74570295, "body": "You can have the function return an array and use this function to have array of arrays."}, {"owner": {"reputation": 105, "user_id": 7138845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d44a08caaa5e141bc0778d47d987a1a5?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/7138845/joe"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493827058, "post_id": 43764341, "comment_id": 74571080, "body": "@Tehscript: thanks for the hint; however I&#39;m really a beginner, can I ask you gently to tell me a little more please? Thanks"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493827254, "post_id": 43764341, "comment_id": 74571207, "body": "I don&#39;t really know what numbers to use so I used 2 for all of them"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493827636, "post_id": 43764341, "comment_id": 74571472, "body": "If you want those s, t, z, r, q to vary, you can do it the same way n and m vary."}, {"owner": {"reputation": 105, "user_id": 7138845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d44a08caaa5e141bc0778d47d987a1a5?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/7138845/joe"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493828509, "post_id": 43764341, "comment_id": 74572000, "body": "I want the parameters I&#39;ve listed in the post to be inserted in Excel by a user, not to be fixed in the code; I&#39;m confused because in your code you fix n and m, but I need to insert them in excel (as the other parameters: the final output should be only the plot of the trajectories, once inserted the parameters)."}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493828630, "post_id": 43764341, "comment_id": 74572069, "body": "Do you want to print this output in excel cells? or do you want to get m and n value from excel cells?"}, {"owner": {"reputation": 105, "user_id": 7138845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d44a08caaa5e141bc0778d47d987a1a5?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/7138845/joe"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493828861, "post_id": 43764341, "comment_id": 74572169, "body": "I want to recall my VBA function in Excel, giving it all the parameters listed above (s,t,z,r,q,n,m) and the result should be one plot, of the m GBM trajectories. For example, you wrote &quot;I don&#39;t really know what numbers to use so I used 2 for all of them&quot;, but those numbers are to be inserted in excel AFTER the function is defined.  I don&#39;t need at all to print in excel the relative datas.   Thanks again!"}, {"owner": {"reputation": 105, "user_id": 7138845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d44a08caaa5e141bc0778d47d987a1a5?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/7138845/joe"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493829290, "post_id": 43764341, "comment_id": 74572398, "body": "But once this is done, it seems the result is an array of array in which all my n steps of each of the m GBM is stored. And this is great. The final step will be to plot them correctly"}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 7138845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d44a08caaa5e141bc0778d47d987a1a5?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/7138845/joe"}, "edited": false, "score": 0, "creation_date": 1493833153, "post_id": 43764968, "comment_id": 74574619, "body": "Ok I did this. As I told you, I&#39;m a beginner, so I ask you gently to be patient. It seems that, the final result of this code is to store (via the Debug.Print command) all the GBM steps, for each trajectory. From this, I read that I can recover these datas by using the Immediate Window, but opening it, nothing appears. So at this point, how can I use my data to get a plot?"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 105, "user_id": 7138845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d44a08caaa5e141bc0778d47d987a1a5?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/7138845/joe"}, "edited": false, "score": 0, "creation_date": 1493890487, "post_id": 43764968, "comment_id": 74598690, "body": "Debug.print is the command to display the output. The final result is stored in Arr() 2 dimensinonal array. Like this: Arr((a1, a2, a3....),(b1, b2, b3....),and so on...). If you want to display a1, it is Arr(0)(0). I you want to display b3, it is Arr(1)(2). Notice that counting starts from 0, not 1. Using 2 nested for loops you can display all outputs by Arr(i)(j). By using this output, you can display them in cells, plot them in chart, whatever you want."}, {"owner": {"reputation": 105, "user_id": 7138845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d44a08caaa5e141bc0778d47d987a1a5?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/7138845/joe"}, "edited": false, "score": 0, "creation_date": 1493913400, "post_id": 43764968, "comment_id": 74615850, "body": "Ok (and 1thousand thanks again) but if I go to Excel and i write in a cell =Arr(0)(0) it doesn&#39;t give nothing. How can this be possibile?"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 105, "user_id": 7138845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d44a08caaa5e141bc0778d47d987a1a5?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/7138845/joe"}, "edited": false, "score": 0, "creation_date": 1493914294, "post_id": 43764968, "comment_id": 74616477, "body": "You can use <code>Cells(1,1) = Arr(0)(0)</code> to have output to A1 which is first row and first column. I.e., <code>Cells(2,3)</code> is second row, third column which is C2. If you uncomment the comment in above code like this <code>Cells(i + 2, j + 1) = Arr(i)(j)</code> (by deleting apostrophe -&gt;&#39;) you will see the output in excel cells, and then you can figure out how."}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 105, "user_id": 7138845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d44a08caaa5e141bc0778d47d987a1a5?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/7138845/joe"}, "edited": false, "score": 0, "creation_date": 1493914481, "post_id": 43764968, "comment_id": 74616592, "body": "You will write it in the code inside the editor, not in cell. Do you need this to work as a function in excel?"}], "tags": [], "owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "is_accepted": false, "score": 2, "last_activity_date": 1493830288, "last_edit_date": 1493830288, "creation_date": 1493827228, "answer_id": 43764968, "question_id": 43764341, "link": "https://stackoverflow.com/questions/43764341/plotting-trajectories-of-gbm-with-vba/43764968#43764968", "title": "Plotting Trajectories of GBM with VBA", "body": "<p>Inside your function at the end, define your function as array</p>\n\n<pre><code>GBMSimulation = SimVar()\n</code></pre>\n\n<p>Then use the following code and have your function to create another array.</p>\n\n<p><strong>Edit:</strong> You can input your variables from Cells A1, B1, C1, .. and if you uncomment below, you will have these results in your excel, just like your excel. You can make a chart as well. Also if you want to loop 0 to 1 by 0.01 (100(101?) times total) you can use <code>step 0.01</code> For example: <code>for i = 0 To 1 step 0.01</code> (i should be double - ps:try declaring it as long and see what happens:)</p>\n\n<pre><code>Sub ArrayofArrays()\nDim i As Long, j As Long, m As Long, n As Double, s As Double, t As Double, z As Double, r As Double, q As Double\nWith Sheets(\"Sheet1\")\n    m = .Range(\"A1\").Value\n    n = .Range(\"B1\").Value\n    s = .Range(\"C1\").Value\n    t = .Range(\"D1\").Value\n    z = .Range(\"E1\").Value\n    r = .Range(\"F1\").Value\n    q = .Range(\"G1\").Value\nEnd With\nReDim Arr(m)\nFor i = 0 To m\n    Arr(i) = GBMSimulation(s, t, z, r, q, n)\nNext i\nFor i = 0 To m\n    For j = 0 To n\n        Debug.Print Arr(i)(j)\n        'Cells(i + 2, j + 1) = Arr(i)(j)\n    Next j\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 7138845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d44a08caaa5e141bc0778d47d987a1a5?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/7138845/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 553, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493842708, "creation_date": 1493825441, "last_edit_date": 1531164843, "question_id": 43764341, "link": "https://stackoverflow.com/questions/43764341/plotting-trajectories-of-gbm-with-vba", "title": "Plotting Trajectories of GBM with VBA", "body": "<p>Goodmorning. I'm new here. Before posting I've searched similar questions, but I found something similar only with different programming language, and however the question found were incomplete.</p>\n\n<p>Ok, my problem is to find a VBA code which, once recalled in Excel, it requires from me only the Geometric Brownian Motions (GBM) parameters (initial stock value s, maturity t, volatility z, risk-free rate r, dividend q, number of steps n), the number m of trajectories I need to reproduce.\nAs a output I don't want to see no numbers, only one plot of the superimposed m trajectories.</p>\n\n<p>The problem is that, I can't write it directly cell by cell (then carrying) because in this way it would be too complex from a computational power point of view; it would allow to make something like 15 trajectories, not much more.\nThus the solution is to work in VBA.</p>\n\n<p>My initial step was</p>\n\n<pre><code>Function GBMSimulation(s As Double, t As Double, z As Double, r As Double, q As Double, n As Double) As Variant\nDim dt, e, dlns, SimVar() As Double\nReDim SimVar(n + 1)\ndt = t / n\nSimVar(0) = s\nFor i = 1 To n\nRandomize\n    e = WorksheetFunction.NormSInv(Rnd())\n    dlns = (r - q - z ^ 2 / 2) * dt + z * e * dt ^ 0.5\n        SimVar(i) = SimVar(i - 1) * Exp(dlns)\nNext i\nGBMSimulation = SimVar(n)\nEnd Function\n</code></pre>\n\n<p>This code works; I mean, it gives a number, which is the n-th step of ONE gbm.</p>\n\n<p>Changing</p>\n\n<pre><code>GBMSimulation = SimVar(n)\n</code></pre>\n\n<p>with</p>\n\n<pre><code>GBMSimulation = SimVar(i)\n</code></pre>\n\n<p>I would obtain the i-th step of <em>that particular</em> gbm.</p>\n\n<p>Thus, all the steps are stored in memory and this is good.</p>\n\n<p>My problem is: how can I create m different realizations of a GBM (i.e. to repeat my previous step m times, m given as an input) and for each one of them create automatically a plot?</p>\n\n<p>I think some for cycle should be taken into account, but I'm a beginner and I don't know how to do this.</p>\n\n<p>I thought I could create an n-dimensional array in which store the GBM steps, plotting them, and repeat this m times; the problem is that I miss the language, I'm learning it, but it require time, and some help could be useful.</p>\n\n<p>ONLY FROM GRAPHICAL POINT OF VIEW, the final result should be <a href=\"http://www.math.columbia.edu/~smirnov/BrownianMotion.xls\" rel=\"nofollow noreferrer\">like this</a> (I specified the graphical pov because in the link there are numbers, and all the work is made cell by cell, and as I said before I need to avoid this).</p>\n\n<p>Many thanks.</p>\n\n<hr>\n\n<p><strong>UPDATE:</strong> my problem was partially solved thank to Tehscript.\nThe code he/she kindly provided, allows to store the n steps of each of the m GBMs in an array of arrays. Thus remains one last step in order to solve my problem: how can I plot these datas?</p>\n"}, {"tags": ["vba", "selenium", "selenium-chromedriver"], "comments": [{"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493825398, "post_id": 43764265, "comment_id": 74569943, "body": "Did you try <code>Click</code> instead of <code>Submit</code>?"}, {"owner": {"reputation": 13, "user_id": 7958293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eac728544a45633da3e5365b3282d6da?s=128&d=identicon&r=PG&f=1", "display_name": "Lindsey D", "link": "https://stackoverflow.com/users/7958293/lindsey-d"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493825923, "post_id": 43764265, "comment_id": 74570326, "body": "I did, and I would get an error message. The version above is the only one I&#39;ve gotten to actually accomplish a button click/submit, it&#39;s just the wrong one"}], "answers": [{"tags": [], "owner": {"reputation": 1103, "user_id": 7495746, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-eicFepd80jY/AAAAAAAAAAI/AAAAAAAAABc/kRCZ6Bx0cT4/photo.jpg?sz=128", "display_name": "Jayesh Doolani", "link": "https://stackoverflow.com/users/7495746/jayesh-doolani"}, "is_accepted": true, "score": 0, "last_activity_date": 1493827066, "creation_date": 1493827066, "answer_id": 43764905, "question_id": 43764265, "link": "https://stackoverflow.com/questions/43764265/vba-selenium-button-submit-issue/43764905#43764905", "title": "VBA Selenium Button Submit Issue", "body": "<p>Try </p>\n\n<p><code>bot.FindElementByXPath(\"//button[@type='submit']\").Click</code></p>\n\n<p>instead of using</p>\n\n<p><code>bot.FindElementByClass(\"pagespeed__submit\").Submit</code></p>\n"}], "owner": {"reputation": 13, "user_id": 7958293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eac728544a45633da3e5365b3282d6da?s=128&d=identicon&r=PG&f=1", "display_name": "Lindsey D", "link": "https://stackoverflow.com/users/7958293/lindsey-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2603, "favorite_count": 0, "accepted_answer_id": 43764905, "answer_count": 1, "score": 1, "last_activity_date": 1493827066, "creation_date": 1493825248, "question_id": 43764265, "link": "https://stackoverflow.com/questions/43764265/vba-selenium-button-submit-issue", "title": "VBA Selenium Button Submit Issue", "body": "<p>I'm trying to build code that will go to the website \"<a href=\"https://testmysite.thinkwithgoogle.com\" rel=\"nofollow noreferrer\">https://testmysite.thinkwithgoogle.com</a>\", enter a string in the search field, and submit the button to get results (which I will eventually scrape and save in my excel file). </p>\n\n<p>However, I cannot get the button to submit. Any iteration that I've tried results in submitting the delete text X that appears after I've entered my text. Below is my code:</p>\n\n<pre><code>Sub GetScores()\nDim bot As New WebDriver\n\n' URL to get data from\nbot.Start \"Chrome\", \"https://testmysite.thinkwithgoogle.com\"\nbot.Get \"/\"\n\n' Eventually loop through websites, for now just use example\nDim str As String\nstr = \"www.google.com\"\n\n'Paste str into webpage\n\nbot.FindElementByName(\"pagespeed-input\").SendKeys (str)\n\nbot.FindElementByClass(\"pagespeed__submit\").Submit\n</code></pre>\n\n<p>And here is the html code from the website:</p>\n\n<pre><code>&lt;div class=\"pagespeed \" data-component=\"PageSpeed\" &gt;\n    &lt;form class=\"pagespeed__form\" action=\"\"&gt;\n      &lt;input type=\"hidden\" name=\"pagespeed-locale\" id=\"\" value=\"en_us\"&gt;\n      &lt;input type=\"url\" name=\"pagespeed-input\" class=\"pagespeed__input\" placeholder=\"Enter your website URL\" tabindex=\"-1\" autofocus &gt;\n      &lt;button type=\"submit\" class=\"pagespeed__submit pagespeed__submit--disabled\"  data-gtm-id=\"smbhub-url-entry\" disabled&gt;Test now&lt;/button&gt;\n    &lt;/form&gt;\n    &lt;div class='pagespeed__error'&gt;&lt;/div&gt;\n  &lt;/div&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 98, "user_id": 7833213, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SDKvz.png?s=128&g=1", "display_name": "smm", "link": "https://stackoverflow.com/users/7833213/smm"}, "is_accepted": true, "score": 2, "last_activity_date": 1493825750, "last_edit_date": 1493825750, "creation_date": 1493825373, "answer_id": 43764310, "question_id": 43764153, "link": "https://stackoverflow.com/questions/43764153/to-delete-multiple-rows-by-excel-vba-command-button/43764310#43764310", "title": "To delete multiple rows by Excel VBA command button", "body": "<p>Perhaps use the following?</p>\n\n<pre><code>Selection.EntireRow.Delete\n</code></pre>\n\n<p>You can select multiple cells, click the button, and the associated row will be deleted.</p>\n"}], "owner": {"reputation": 33, "user_id": 7857362, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1777d3e18012d4b78b9a7e5a2c118b5f?s=128&d=identicon&r=PG&f=1", "display_name": "Vinz B", "link": "https://stackoverflow.com/users/7857362/vinz-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 546, "favorite_count": 0, "accepted_answer_id": 43764310, "answer_count": 1, "score": 0, "last_activity_date": 1493825750, "creation_date": 1493824907, "last_edit_date": 1531161705, "question_id": 43764153, "link": "https://stackoverflow.com/questions/43764153/to-delete-multiple-rows-by-excel-vba-command-button", "title": "To delete multiple rows by Excel VBA command button", "body": "<p>I have a excel sheet with command button to select and delete one row.\nDeletion can be done only for Rows after 12th row. below is the code I have:-</p>\n\n<pre><code>Sub Button_delete_row()\nIf ActiveCell.Row &gt; 12 Then\nActiveSheet.Unprotect \"xxxx\"\nRows(ActiveCell.Row).Delete\nActiveSheet.Protect \"xxxx\", True, True\nEnd If\nEnd Sub\n</code></pre>\n\n<p>With my above code in command button, I can select only one row by highlighting with mouse click and deleting.\nMy problem is I want to select multiple rows by highlighting with mouse drag and click on command button to delete these rows.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11, "user_id": 7958193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d91bb8347b8328577f960c30705f6f8c?s=128&d=identicon&r=PG&f=1", "display_name": "Shahab", "link": "https://stackoverflow.com/users/7958193/shahab"}, "edited": false, "score": 0, "creation_date": 1493824339, "post_id": 43763902, "comment_id": 74569127, "body": "<a href=\"https://stackoverflow.com/posts/43763902/edit\">edit</a> filed 5 is a typo. It is meant to be field 5"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1493826030, "post_id": 43763902, "comment_id": 74570392, "body": "Please include the &quot;where&quot; clause you tried."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1493826180, "post_id": 43763902, "comment_id": 74570501, "body": "&quot;SELECT * FROM filename.txt  where GL=60&quot; should work"}, {"owner": {"reputation": 11, "user_id": 7958193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d91bb8347b8328577f960c30705f6f8c?s=128&d=identicon&r=PG&f=1", "display_name": "Shahab", "link": "https://stackoverflow.com/users/7958193/shahab"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1493876886, "post_id": 43763902, "comment_id": 74590375, "body": "Hi Tim, I tried the below where clause, but keep getting the error Run-time error &#39;1004:General ODBC error.      .CommandText = Array( _     &quot;SELECT * &quot; &amp; Chr(13) &amp; &quot;&quot; &amp; Chr(10) &amp; &quot;FROM      IDQ_Report_ALL_GL_LEAF_DEFECT_MKT_44571.txt DQ WHERE      GL=60&quot;)  I have also tried  F5=60 [i]GL[/i]=60 and using single quotes for the value i.e. GL=&#39;60&#39;  Each time I get the error, when i click debug  &quot;.Refresh BackgroundQuery:=False&quot; gets highlighted"}], "owner": {"reputation": 11, "user_id": 7958193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d91bb8347b8328577f960c30705f6f8c?s=128&d=identicon&r=PG&f=1", "display_name": "Shahab", "link": "https://stackoverflow.com/users/7958193/shahab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1127, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1493824230, "creation_date": 1493824230, "last_edit_date": 1531164843, "question_id": 43763902, "link": "https://stackoverflow.com/questions/43763902/filtering-text-file-data-before-importing-to-excel-using-vba", "title": "Filtering text file data before importing to excel using VBA", "body": "<p>I am new to VBA and this forum. I Apologize in advance for the long text, formatting errors and the general noobness in my post.</p>\n\n<p>I have a .txt file stored on a shared drive, that has details about multiple products. This file has more than 1048576 rows of data, and hence cannot be imported directly to the excel sheet. I wish to filter the data before importing based on filed 5 value being the number 60 (filed 5 is labeled as 'GL').</p>\n\n<p>After some research I was able to put together the below module. In the '.CommanText' Array when I am doing a 'select *' I get all rows. But when I try to add a where clause for filtering the data I get an error \"Run-time error '1004:General ODBC error\". When I click debug the below line gets highlighted</p>\n\n<p>.Refresh BackgroundQuery:=False</p>\n\n<pre><code>Sub ReadTextFile()\n ActiveSheet.Range(\"A1:S1045876\").ClearContents 'clearing existing contents\n\n With ActiveSheet.QueryTables.Add(Connection:=Array(Array(\"ODBC;DefaultDir=\\\\ant.org.com\\dept\\Systems\\ABC\\Data;Driver={Microsoft Text Driver (*.txt; *.csv)};DriverId=27;FIL=text;MaxBufferSize=2048;MaxSc\"), Array(\"anRows=8;PageTimeout=5;SafeTransactions=0;Threads=3;UserCommitSync=Yes;\")), Destination:=Range(\"A2\"))\n .CommandText = Array( _\n\"SELECT * \" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"FROM filename.txt DQ\") 'DQ is an arbitrary alias\n.Name = \"Query from Text\"\n.FieldNames = False\n.RowNumbers = False\n.FillAdjacentFormulas = False\n.PreserveFormatting = False\n.RefreshOnFileOpen = False\n.RefreshStyle = xlOverwriteCells\n.SavePassword = False\n.SaveData = True\n.AdjustColumnWidth = False\n.RefreshPeriod = 0\n.PreserveColumnInfo = True\n.BackgroundQuery = True\n.Refresh BackgroundQuery:=False\n\nEnd With\n\n'code for excel \"text to column\" function\n\nEnd Sub\n</code></pre>\n\n<p>Request your help in adding the ability to filter the data from the text file before importing.</p>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2016"], "answers": [{"comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1493825583, "post_id": 43763901, "comment_id": 74570081, "body": "you could also do step 45 in your for loop"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1493824226, "creation_date": 1493824226, "answer_id": 43763901, "question_id": 43763759, "link": "https://stackoverflow.com/questions/43763759/excel-vba-named-range/43763901#43763901", "title": "Excel VBA Named Range", "body": "<p>Try this. It's quite possible I have some of the numbers off but hopefully you get the idea</p>\n\n<pre><code>Sub x()\n\nDim score As Long, r As Range, i As Long\n\nSet r = Range(\"N3\")\n\nFor i = 1 To 172\n    SolverReset\n    score = r.Value\n    If score = 1 Then\n        SolverLoad loadArea:=r.Offset(1).Resize(8)\n        SolverSolve UserFinish:=True\n        SolverFinish KeepFinal:=1\n        SolverReset\n        SolverLoad loadArea:=r.Offset(1, 1).Resize(11)\n        SolverSolve UserFinish:=True\n        SolverFinish KeepFinal:=1\n        SolverReset\n    Else:\n        SolverReset\n        SolverLoad loadArea:=r.Offset(1, 2).Resize(12)\n        SolverSolve UserFinish:=True\n        SolverFinish KeepFinal:=1\n    End If\n    Set r = r.Offset(45)\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 7950082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5b5c06a436735634e4e004a51dfd0d10?s=128&d=identicon&r=PG&f=1", "display_name": "Avi Gupta", "link": "https://stackoverflow.com/users/7950082/avi-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 43763901, "answer_count": 1, "score": 0, "last_activity_date": 1493824226, "creation_date": 1493823837, "question_id": 43763759, "link": "https://stackoverflow.com/questions/43763759/excel-vba-named-range", "title": "Excel VBA Named Range", "body": "<p>I am running a vba code as follows:</p>\n\n<p>Dim score As Integer</p>\n\n<pre><code>SolverReset\nscore = Range(\"N3\").Value\nIf score = 1 Then\n    SolverLoad loadArea:=Range(\"N4:N11\")\n    SolverSolve UserFinish:=True\n    SolverFinish KeepFinal:=1\n    SolverReset\n    SolverLoad loadArea:=Range(\"O4:O14\")\n    SolverSolve UserFinish:=True\n    SolverFinish KeepFinal:=1\n    SolverReset\nElse:\n    SolverReset\n    SolverLoad loadArea:=Range(\"P4:P15\")\n    SolverSolve UserFinish:=True\n    SolverFinish KeepFinal:=1\nEnd If\n\nSolverReset\nscore = Range(\"N48\").Value\nIf score = 1 Then\n    SolverLoad loadArea:=Range(\"N49:N56\")\n    SolverSolve UserFinish:=True\n    SolverFinish KeepFinal:=1\n    SolverReset\n    SolverLoad loadArea:=Range(\"O49:O59\")\n    SolverSolve UserFinish:=True\n    SolverFinish KeepFinal:=1\n    SolverReset\nElse:\n    SolverReset\n    SolverLoad loadArea:=Range(\"P49:P60\")\n    SolverSolve UserFinish:=True\n    SolverFinish KeepFinal:=1\nEnd If\n</code></pre>\n\n<p>As you can see the first half of the code is repeated again. The range changes from <strong>N3 to N48</strong>, <strong>N4 to N49</strong> and so on.</p>\n\n<p>Now I have to keep repeating the entire code for 172 iterations only changing the range Part which is the cell references to the solver location.</p>\n\n<p>Is there some way I can repeat the process for 172 times using for loop by some how changing the references after each iteration.</p>\n\n<p><strong>All the references increase by +45 each iteration, as is visible.</strong></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 7958106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9eadfebb2b8afc55495f775e54cc89?s=128&d=identicon&r=PG&f=1", "display_name": "tenvfa", "link": "https://stackoverflow.com/users/7958106/tenvfa"}, "edited": false, "score": 0, "creation_date": 1493831366, "post_id": 43765193, "comment_id": 74573625, "body": "Thank you for your response!  I am trying to paste the values in the <b>copied</b> workbook, as you said. The original workbook should keep all formulas.   However when I tried this code, it pasted the values in the original sheet and ran out of memory while looping. Is there a way to limit how many loops it does?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 37, "user_id": 7958106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9eadfebb2b8afc55495f775e54cc89?s=128&d=identicon&r=PG&f=1", "display_name": "tenvfa", "link": "https://stackoverflow.com/users/7958106/tenvfa"}, "edited": false, "score": 0, "creation_date": 1493832827, "post_id": 43765193, "comment_id": 74574443, "body": "@tenvfa - See the updated code. Does that work? If it&#39;s running out of memory, you may want to check the size of <code>UsedRange</code>...how big do you expect it to be?"}, {"owner": {"reputation": 37, "user_id": 7958106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9eadfebb2b8afc55495f775e54cc89?s=128&d=identicon&r=PG&f=1", "display_name": "tenvfa", "link": "https://stackoverflow.com/users/7958106/tenvfa"}, "edited": false, "score": 0, "creation_date": 1493836642, "post_id": 43765193, "comment_id": 74576711, "body": "Your edit fixed the issue of copying values to the new workbook only, so thank you.   It ran out of memory again and the debugger flagged  <code>wbNew.Worksheets(shts(i)).UsedRange.Value = wbNew.Worksheets(shts(i)).UsedRange.Value</code> as the error. I am a total VBA beginner with no coding experience, so I&#39;m not sure I understand your question about size.  The largest sheet contains cell values in 15 columns by 25,000 rows. The smallest sheet has 15 columns by 2,000 rows."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 37, "user_id": 7958106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9eadfebb2b8afc55495f775e54cc89?s=128&d=identicon&r=PG&f=1", "display_name": "tenvfa", "link": "https://stackoverflow.com/users/7958106/tenvfa"}, "edited": false, "score": 0, "creation_date": 1493836794, "post_id": 43765193, "comment_id": 74576791, "body": "@tenvfa - Is all the data in a &quot;block&quot;, i.e. do all columns have the same rows of data? If I wanted to get the last row with Data in it, is Column A safe to use on each sheet? If not, what column has the most data?"}, {"owner": {"reputation": 37, "user_id": 7958106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9eadfebb2b8afc55495f775e54cc89?s=128&d=identicon&r=PG&f=1", "display_name": "tenvfa", "link": "https://stackoverflow.com/users/7958106/tenvfa"}, "edited": false, "score": 0, "creation_date": 1493837080, "post_id": 43765193, "comment_id": 74576944, "body": "Yes, the data is in a block and Column A is safe to use. I don&#39;t know if it is relevant, but one sheet has 22 columns instead of 15."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 37, "user_id": 7958106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9eadfebb2b8afc55495f775e54cc89?s=128&d=identicon&r=PG&f=1", "display_name": "tenvfa", "link": "https://stackoverflow.com/users/7958106/tenvfa"}, "edited": false, "score": 0, "creation_date": 1493837546, "post_id": 43765193, "comment_id": 74577214, "body": "@tenvfa - See my edit again. I whittled down the range to (I assume/hopefully) only use the used ranges. Also added <code>ScreenUpdating = False</code>"}, {"owner": {"reputation": 37, "user_id": 7958106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9eadfebb2b8afc55495f775e54cc89?s=128&d=identicon&r=PG&f=1", "display_name": "tenvfa", "link": "https://stackoverflow.com/users/7958106/tenvfa"}, "edited": false, "score": 0, "creation_date": 1493847563, "post_id": 43765193, "comment_id": 74582302, "body": "There is an issue where the first sheet of the new workbook is being deleted. I think it originates here:   <code>Set delWS = ActiveSheet wbOld.Worksheets(Array(&quot;Sheet 1&quot;, &quot;Sheet 2&quot;, &quot;Sheet 3&quot;)).Copy wbNew.Worksheets(1) delWS.Delete</code>  The 3 copied sheets are pasting in front of the blank &quot;Sheet 1&quot; on the new workbook. If they were to paste after the blank sheet, I think that would fix the issue. I played with it for a few minutes but can&#39;t get them to move.   <b>However</b>, the blank sheet doesn&#39;t interfere, so I just deleted all references to <code>delWS</code> and the file works! :)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 37, "user_id": 7958106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9eadfebb2b8afc55495f775e54cc89?s=128&d=identicon&r=PG&f=1", "display_name": "tenvfa", "link": "https://stackoverflow.com/users/7958106/tenvfa"}, "edited": false, "score": 0, "creation_date": 1493847754, "post_id": 43765193, "comment_id": 74582393, "body": "@tenvfa - Ah, yeah I added that delete line just because I assumed you wouldn&#39;t need it. Otherwise, glad to hear it&#39;s working!"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1493837456, "last_edit_date": 1493837456, "creation_date": 1493827941, "answer_id": 43765193, "question_id": 43763372, "link": "https://stackoverflow.com/questions/43763372/edit-vba-to-paste-multiple-sheets-as-values-into-new-workbook/43765193#43765193", "title": "Edit VBA to paste multiple sheets as values into new workbook", "body": "<p>You need to loop through the sheets:</p>\n\n<pre><code>Dim ws As Worksheet\n\nFor Each ws In ActiveWorkbook.Worksheets\n    ws.UsedRange.Value = ws.UsedRange.Value\nNext ws\n</code></pre>\n\n<p>So, with your code, you could do it like this:</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\nDim wbOld As Workbook, wbNew As Workbook\nDim ws As Worksheet, delWS As Worksheet\nDim i       As Long, lastRow As Long, lastCol As Long\nDim shts()  As Variant\nDim rng As Range\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\nSet wbOld = ActiveWorkbook\n\nshts() = Array(\"Sheet 1\", \"Sheet 2\", \"Sheet 3\")\nSet wbNew = Workbooks.Add\nSet delWS = ActiveSheet\nwbOld.Worksheets(Array(\"Sheet 1\", \"Sheet 2\", \"Sheet 3\")).Copy wbNew.Worksheets(1)\ndelWS.Delete\n\nFor i = LBound(shts) To UBound(shts)\n    With wbNew.Worksheets(shts(i))\n        lastRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n        lastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n        Set rng = .Range(.Cells(1, 1), .Cells(lastRow, lastCol))\n        rng.Value = rng.Value\n    End With\nNext i\n\nwbNew.SaveAs \"L:\\Performance Data\\UK Sales\\Sales (Latest).xlsx\"\nwbNew.Close True\n\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Note: I am not sure which workbook you want to paste the values in. As it is above, it does this in the COPIED workbook, not original.</p>\n"}], "owner": {"reputation": 37, "user_id": 7958106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9eadfebb2b8afc55495f775e54cc89?s=128&d=identicon&r=PG&f=1", "display_name": "tenvfa", "link": "https://stackoverflow.com/users/7958106/tenvfa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 855, "favorite_count": 0, "accepted_answer_id": 43765193, "answer_count": 1, "score": 3, "last_activity_date": 1493837456, "creation_date": 1493822833, "last_edit_date": 1531161705, "question_id": 43763372, "link": "https://stackoverflow.com/questions/43763372/edit-vba-to-paste-multiple-sheets-as-values-into-new-workbook", "title": "Edit VBA to paste multiple sheets as values into new workbook", "body": "<p>The code from <a href=\"https://www.mrexcel.com/forum/excel-questions/450640-visual-basic-applications-copy-active-worksheet-values-only.html\" rel=\"nofollow noreferrer\">this forum</a> is what I used as a starting point. I am trying to modify it to copy multiple sheets and paste them all as values, instead of just one sheet.</p>\n\n<p>I copied multiple sheets using <code>worksheets(array(1,2,3)).copy</code>. I think the problem is <code>With ActiveSheet.UsedRange</code> because it is only replacing the first sheet as values and leaving the remaining sheets as formulas. </p>\n\n<p>What do I need to change so that all the sheets paste as values?</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n    Application.DisplayAlerts = False\n    Worksheets(Array(\"Sheet 1\",\"Sheet 2\",\"Sheet 3\").Copy\n    With ActiveSheet.UsedRange\n        .Value = .Value\n    End With\n    Set wbNew = ActiveWorkbook\n    wbNew.SaveAs \"L:\\Performance Data\\UK Sales\\Sales (Latest).xlsx\"\n    wbNew.Close True\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "hash", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1493821913, "post_id": 43762844, "comment_id": 74567181, "body": "How is the code in causing errors? on which line does it error?"}, {"owner": {"reputation": 29, "user_id": 2117933, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/2f9acf5211963181aaf358003d10e84e?s=128&d=identicon&r=PG", "display_name": "Spencer Lim", "link": "https://stackoverflow.com/users/2117933/spencer-lim"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1493826745, "post_id": 43762844, "comment_id": 74570896, "body": "There are no errors. The output hash total has to equate to 31341437052 with the 26 sample strings. It&#39;s showing some other figures now."}], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 2117933, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/2f9acf5211963181aaf358003d10e84e?s=128&d=identicon&r=PG", "display_name": "Spencer Lim", "link": "https://stackoverflow.com/users/2117933/spencer-lim"}, "is_accepted": false, "score": 0, "last_activity_date": 1494253646, "creation_date": 1494253646, "answer_id": 43850247, "question_id": 43762844, "link": "https://stackoverflow.com/questions/43762844/vba-generating-custom-hash-total/43850247#43850247", "title": "VBA generating custom hash total", "body": "<p>ok. so i figure out it was just some parameters that i was missing.</p>\n\n<p>This convert any alphabet in the string to \"0\"</p>\n\n<pre><code>Function cleanString(text As String) As String\nDim output As String\nDim i As Integer\n\nDim c 'since char type does not exist in vba, we have to use variant type.\nFor i = 1 To Len(text)\n'With Sheet2\n'MsgBox (i)\n    c = Mid(text, i, 1) 'Select the character at the i position\n    If (c &gt;= \"a\" And c &lt;= \"z\") Or (c &gt;= \"A\" And c &lt;= \"Z\") Then\n        output = output &amp; \"0\" 'add the character to your output.\n    Else\n        output = output &amp; c 'add the replacement character (space) to your output\n    End If\n    'End With\nNext\ncleanString = output\n'MsgBox (cleanString)\n End Function\n</code></pre>\n\n<p>This start the hash function</p>\n\n<pre><code>Function generateHash(LastRows As Long) As Double\n\nDim output As Double\n'Dim c 'since char type does not exist in vba, we have to use variant type.\nDim Orig As String\nDim AccNo As String\nDim temp As String\nDim lCounter As Long\nDim lLastRow As Long\n\n'Find the last row that contains data\nWith Sheet2\n    lLastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\nEnd With\n'Take the original string and making sure there are only 11 characters\nOrig = Left(Range(\"B3\") &amp; \"00000000000\", 11)\n\n  'Starts from row 9 \n  For lCounter = 9 To LastRows\n    With Sheet2\n\n\n     'Ensuring only 11 characters\n     AccNo = Left(.Cells(lCounter, 5) &amp; \"00000000000\", 11)\n     'Clean the string of any alphabet \n     AccNo = cleanString(AccNo)\n     'Take the absolute diff of 2nd and 1st string \n     temp = Abs(AccNo - Orig)\n\n     output = output + temp\n\n     'MsgBox (output)\n\n   End With\nNext\n\ngenerateHash = output\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 2117933, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/2f9acf5211963181aaf358003d10e84e?s=128&d=identicon&r=PG", "display_name": "Spencer Lim", "link": "https://stackoverflow.com/users/2117933/spencer-lim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494253646, "creation_date": 1493821523, "last_edit_date": 1531164843, "question_id": 43762844, "link": "https://stackoverflow.com/questions/43762844/vba-generating-custom-hash-total", "title": "VBA generating custom hash total", "body": "<p>With excel macro (VBA), I need to generate hash total for a series of strings. My current function cant output the correct result. </p>\n\n<p>How to derive the hash total is as such:</p>\n\n<ol>\n<li><p>Subtract the first 11 characters of originating account from the\nfirst 11 characters of each receiving account. </p>\n\n<ul>\n<li>If the account number is less than 11 characters, pad <code>0</code> on the right.</li>\n<li>If the\naccount number has an alphabet, convert the alphabet to <code>0</code>. </li>\n<li>Derive the value for each receiving account. Take the absolute value, that\nis, ignore the negative sign. </li>\n</ul></li>\n<li><p>Add the absolute values </p></li>\n<li><p>Take the first 11 character of the result. If the result is less\nthan 11 characters, pad with <code>0</code> on the left.</p></li>\n</ol>\n\n<p>This is what I have now:</p>\n\n<pre><code>Function cleanString(text As String) As String\n    Dim output As String\n    Dim i As Integer\n    Dim c 'since char type does not exist in vba, we have to use variant type.\n\n    For i = 1 To Len(text)\n        'With Sheet2\n        MsgBox (i)\n        c = Mid(text, i, 1) 'Select the character at the i position\n        If (c &gt;= \"a\" And c &lt;= \"z\") Or (c &gt;= \"A\" And c &lt;= \"Z\") Then\n            output = output &amp; \"0\" 'add the character to your output.\n        Else\n            output = output &amp; c 'add the replacement character (space) to your output\n        End If\n        'End With\n    Next\n    cleanString = output\nEnd Function\n\n\nFunction generateHash(LastRows As Long) As Double\n    Dim output As Double\n    'Dim c 'since char type does not exist in vba, we have to use variant type.\n    Dim Orig As String\n    Dim AccNo As String\n    Dim temp As Long\n\n    Orig = Left(Range(\"B3\") &amp; String(34, \" \"), 34)\n\n    For LastRows = 9 To LastRows\n        With Sheet2\n\n            AccNo = Left(.Cells(LastRows, 5) &amp; String(11, \" \"), 11)\n            AccNo = cleanString(AccNo)\n\n            temp = Abs(AccNo - Orig)\n\n            output = output + temp\n            'MsgBox (output)     \n       End With\n    Next\n\n    generateHash = output\nEnd Function\n</code></pre>\n\n<p>These are the 26 sample strings, which should produce the hash total of \"31341437052\"</p>\n\n<pre><code>0039002572\n0039002580\n0030015769\n0030016412\n0259001090\n0259001111\n0039002637\n0100703387\n0100703395\n0100703425\n0100703433\n0100703441\n0100703450\n0100703468\n0100703476\n0100703484\n0011227958\n0011228946\n951382892\n951700711\n301402570\n402705981\n0030001620\n0036001622\n111111111\n222222222\n</code></pre>\n"}, {"tags": ["excel", "vba", "performance"], "comments": [{"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 1, "creation_date": 1493819482, "post_id": 43761838, "comment_id": 74565222, "body": "You could use your second piece of code to add the formulas in then use <code>Sheet1.Calculate</code> to ensure the formulas are calculated. Then you could replace the formulas with their values e.g. <code>Sheet1.Range(&quot;A4:Z14238&quot;).Value = Sheet1.Range(&quot;A4:Z14238&quot;).Value</code> this will means there are no formulas to be calculated each time you filter your results"}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "reply_to_user": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1493819604, "post_id": 43761838, "comment_id": 74565326, "body": "What @Jordan offered is correct. But it can be done in excel itself instead of vba (PasteSpecial)."}, {"owner": {"reputation": 35, "user_id": 6654188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65e6ddcbdbb138229132aec3750880b6?s=128&d=identicon&r=PG&f=1", "display_name": "Ramon", "link": "https://stackoverflow.com/users/6654188/ramon"}, "reply_to_user": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1493820108, "post_id": 43761838, "comment_id": 74565756, "body": "@Jordan will try that out and see if it faster, thanks! at Masoud The problem is that I need the formulas everyday. The table calculates everyday updates values."}, {"owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 1, "creation_date": 1493820867, "post_id": 43761838, "comment_id": 74566368, "body": "Your solution may be to turn off Automatic Recalculation for this worksheet, and manually recalculate only when you need to."}, {"owner": {"reputation": 35, "user_id": 6654188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65e6ddcbdbb138229132aec3750880b6?s=128&d=identicon&r=PG&f=1", "display_name": "Ramon", "link": "https://stackoverflow.com/users/6654188/ramon"}, "reply_to_user": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 0, "creation_date": 1493902796, "post_id": 43761838, "comment_id": 74607527, "body": "@RichHolton that&#39;s actually so simple but true...I got a solution now where I deactivate calculation when starting the workbook and calculate cells and ranges with a macro. Thanks for the hind!"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6654188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65e6ddcbdbb138229132aec3750880b6?s=128&d=identicon&r=PG&f=1", "display_name": "Ramon", "link": "https://stackoverflow.com/users/6654188/ramon"}, "edited": false, "score": 0, "creation_date": 1493902699, "post_id": 43762420, "comment_id": 74607439, "body": "Thanks for this approach, unfortunately this won&#39;t work because the SumRange differs for each column."}], "tags": [], "owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "is_accepted": false, "score": 0, "last_activity_date": 1493820495, "creation_date": 1493820495, "answer_id": 43762420, "question_id": 43761838, "link": "https://stackoverflow.com/questions/43761838/faster-way-of-adding-sumifs-formulas-into-large-range/43762420#43762420", "title": "Faster way of adding sumifs formulas into large range", "body": "<p>A nice simple loop would do it:</p>\n\n<pre><code>Sub SumIf()\nDim ASCII As Long\nDim iRef As Long\nApplication.Calculation = xlCalculationManual\n\niRef = 6\nFor ASCII = 71 To 93\n    Sheet1.Range(Chr(ASCII) &amp; \"4:\" &amp; Chr(ASCII) &amp; \"14238\").FormulaR1C1 = \"=SUMIFS(sumRange,criteria_range1,RC[-\" &amp; iRef &amp; \"],criteria_range2,RC[-\" &amp; (iRef - 1) &amp; \"],criteria_range3,RC[-\" &amp; (iRef - 2) &amp; \"],criteria_range4,RC[-\" &amp; (iRef - 3) &amp; \"],criteria_range5,RC[-\" &amp; (iRef - 4) &amp; \"])\"\n    iRef = iRef  + 1\nLoop\n\nApplication.Calculation = xlAutomatic\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 6654188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65e6ddcbdbb138229132aec3750880b6?s=128&d=identicon&r=PG&f=1", "display_name": "Ramon", "link": "https://stackoverflow.com/users/6654188/ramon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 789, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1493881026, "creation_date": 1493818943, "last_edit_date": 1493881026, "question_id": 43761838, "link": "https://stackoverflow.com/questions/43761838/faster-way-of-adding-sumifs-formulas-into-large-range", "title": "Faster way of adding sumifs formulas into large range", "body": "<p>I am wondering if there is a faster way of adding (and calculating) a number of formulas into a larger range. </p>\n\n<p>So the range counts 22 columns with 14235 rows each. Every column has its own formula most of them are sumifs with 5 criterias. </p>\n\n<p>My approach is actually very simple, but probably not the fastest. \nIt's just selecting the range of each column and insert the formula. </p>\n\n<pre><code>Sheet1.Range(\"G4:G14238\").FormulaR1C1 = \"=SUMIFS(sumRangeA,criteria_range1,RC[-6],criteria_range2,RC[-5],criteria_range3,RC[-4],criteria_range4,RC[-3],criteria_range5,RC[-2])\"\nSheet1.Range(\"H4:H14238\").FormulaR1C1 = \"=SUMIFS(sumRangeB,criteria_range1,RC[-7],criteria_range2,RC[-6],criteria_range3,RC[-5],criteria_range4,RC[-4],criteria_range5,RC[-3])\"\n...and so on\n</code></pre>\n\n<p>This actually takes a while, I believe because excel is inserting and calculating everything after having inserted. </p>\n\n<p>So I tried deactivating the auto calculation before inserting the formulas and let excel calculate everything once every formulas were filled, but that even took longer (nearly twice as long). Not sure if I used the code correctly, though</p>\n\n<pre><code>Application.Calculation = xlCalculateManual\n\nSheet1.Range(\"G4:G14238\").FormulaR1C1 = \"=SUMIFS(sumRangeA,criteria_range1,RC[-6],criteria_range2,RC[-5],criteria_range3,RC[-4],criteria_range4,RC[-3],criteria_range5,RC[-2])\"\nSheet1.Range(\"H4:H14238\").FormulaR1C1 = \"=SUMIFS(sumRangeB,criteria_range1,RC[-7],criteria_range2,RC[-6],criteria_range3,RC[-5],criteria_range4,RC[-4],criteria_range5,RC[-3])\"\n\nApplication.Calculation = xlAutomatic\n</code></pre>\n\n<p>To give you a better understanding what I try to achieve:\nUntil now I have these formulas in a regular excel table (no vba at all). It is working, but very slow. If I filter for one condition it takes up to two minutes to show me the results. \nSince I use this table daily it's very time consuming and rather inefficient.</p>\n\n<p>So I thought creating something with vba might help to make it faster. \nMy idea was to insert the formulas, let it calculate and then paste everything as values. That should allow me to work faster with the file. But as my approach takes very much time too, it's not the perfect solution until now. </p>\n\n<p>Are you guys able to help me with that? I am happy with any other approach that might help fasten up the work flow! </p>\n\n<p>Thanks in advance!</p>\n\n<p>Best, </p>\n\n<p>Ramon</p>\n"}, {"tags": ["excel", "vba", "email", "import", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1493848087, "post_id": 43761831, "comment_id": 74582520, "body": "Outlook 2016 for mac or windows?"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1574439801, "post_id": 43761831, "comment_id": 104246536, "body": "This answer suggests starting in Outlook <a href=\"https://stackoverflow.com/a/58964879\">stackoverflow.com/a/58964879</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7957766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99ca23f95263b94d78e9899c5194bc77?s=128&d=identicon&r=PG&f=1", "display_name": "Emily", "link": "https://stackoverflow.com/users/7957766/emily"}, "edited": false, "score": 0, "creation_date": 1493824476, "post_id": 43763536, "comment_id": 74569254, "body": "Thank you for your thoughts Dmitry. I should have mentioned that I tried this previously (ensuring there were only mail items and no calendar, etc. items). I tried this code and received the same result when reaching the item.To section. I still think this is related to programmatic access to Outlook, so may have to work around that...  Thank you again!"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 11, "user_id": 7957766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99ca23f95263b94d78e9899c5194bc77?s=128&d=identicon&r=PG&f=1", "display_name": "Emily", "link": "https://stackoverflow.com/users/7957766/emily"}, "edited": false, "score": 0, "creation_date": 1493827431, "post_id": 43763536, "comment_id": 74571323, "body": "How many items do you process before the error is returned? Is it always the same item?"}, {"owner": {"reputation": 11, "user_id": 7957766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99ca23f95263b94d78e9899c5194bc77?s=128&d=identicon&r=PG&f=1", "display_name": "Emily", "link": "https://stackoverflow.com/users/7957766/emily"}, "edited": false, "score": 0, "creation_date": 1493830524, "post_id": 43763536, "comment_id": 74573122, "body": "It&#39;ll trip out the first time it hits the item.To assignment. If I insert a line to resume next then it&#39;ll go through all the emails, but will only record the subject and not the .To property."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 11, "user_id": 7957766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99ca23f95263b94d78e9899c5194bc77?s=128&d=identicon&r=PG&f=1", "display_name": "Emily", "link": "https://stackoverflow.com/users/7957766/emily"}, "edited": false, "score": 0, "creation_date": 1493830885, "post_id": 43763536, "comment_id": 74573333, "body": "Do you have the same problem with other properties, such as CC or Body?"}, {"owner": {"reputation": 11, "user_id": 7957766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99ca23f95263b94d78e9899c5194bc77?s=128&d=identicon&r=PG&f=1", "display_name": "Emily", "link": "https://stackoverflow.com/users/7957766/emily"}, "edited": false, "score": 0, "creation_date": 1493831318, "post_id": 43763536, "comment_id": 74573583, "body": "Some properties work, like .Subject. Not the .To or .Body however, and the .Body is the important property that I want to be able to access from Excel."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1493823279, "creation_date": 1493823279, "answer_id": 43763536, "question_id": 43761831, "link": "https://stackoverflow.com/questions/43761831/method-body-of-object-mailitem-failed-error-in-excel-and-outlook-2016/43763536#43763536", "title": "&quot;Method &#39;body&#39; of object&#39;_mailItem&#39; failed&quot; error in Excel and Outlook 2016", "body": "<p>Avoid using multiple dot notation and check if you really have a <code>MailItem</code> object (you can also have <code>ReportItem</code> or <code>MeetingItem</code>):</p>\n\n<pre><code>set items = FormFolder.Items\nFor i = 1 To items.Count\n  set item = items.Item(i)\n  if item.Class = 43 Then\n    Range(\"A2\").Select\n    ActiveCell.Value = item.Subject\n    ActiveCell.Offset(0, 1).Value = item.To\n  End If\n  set item = Nothing\nnext\nset items = Nothing\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7957766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99ca23f95263b94d78e9899c5194bc77?s=128&d=identicon&r=PG&f=1", "display_name": "Emily", "link": "https://stackoverflow.com/users/7957766/emily"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1602, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1564385048, "creation_date": 1493818917, "last_edit_date": 1564385048, "question_id": 43761831, "link": "https://stackoverflow.com/questions/43761831/method-body-of-object-mailitem-failed-error-in-excel-and-outlook-2016", "title": "&quot;Method &#39;body&#39; of object&#39;_mailItem&#39; failed&quot; error in Excel and Outlook 2016", "body": "<p>I wrote a program in Excel 2010 to sift through emails in a selected Outlook 2010 folder, and pull in information from the email (html) body.</p>\n\n<p>I updated to Office 2016. Since then, I get an error when using certain properties of the MailItem object. I can pull the subject of the email into Excel, but certain properties cause a \"method 'body' of object'_mailItem\" failed error (including the .Body and .To properties).</p>\n\n<p>Below is a simplified version of the code:</p>\n\n<pre><code>Sub GatherInfo()\n\nDim ObjOutlook As Object\nDim MyNamespace As Object\nDim FormFolder As Object\n\nSet ObjOutlook = GetObject(, \"Outlook Application\")\nSet MyNamespace = ObjOutlook.GetNamespace(\"MAPI\")\nSet FormFolder = MyNamespace.PickFolder\n\nFor i = 1 To FormFolder.Items.Count\n\n    Range(\"A2\").Select\n    ActiveCell.Value = FormFolder.Items(i).Subject\n    ActiveCell.Offset(0, 1).Value = FormFolder.Items(i).To\n\nEnd Sub\n</code></pre>\n\n<p>This results in:   </p>\n\n<blockquote>\n  <p>Run-time error '-2147467259(80004005)':<br>\n  Method 'To' of object'_MailItem' failed</p>\n</blockquote>\n\n<p>I've done some research, and wondering if Outlook 2016 security settings could be to blame. \nThis is a corporate email account, running on an exchange server. Do you think that could be preventing me from accessing the body/sender of the email?</p>\n\n<p>It's strange that the subject property of the email works, but not the body/to properties. </p>\n\n<p>Things I've ruled out: </p>\n\n<p>1) I've sent both plain text and html based emails with the same result.<br>\n2) I've tried binding the Outlook objects early (Dim ObjOutlook as Outlook.Application, etc.)</p>\n\n<p>I ensured there were only mail items and no calendar items, etc.</p>\n\n<p>It'll trip out the first time it hits the item.To assignment. If I insert a line to <code>resume next</code> then it'll go through all the emails, but will only record the subject and not the .To property.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1493819699, "post_id": 43761416, "comment_id": 74565414, "body": "Hoover your mouse on the tags you want to use to see their description and use the proper ones."}], "answers": [{"tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": true, "score": 0, "last_activity_date": 1493821299, "creation_date": 1493821299, "answer_id": 43762730, "question_id": 43761416, "link": "https://stackoverflow.com/questions/43761416/how-to-store-a-table-records-count-into-global-variable-vba-msaccess/43762730#43762730", "title": "How to Store a table records count into global variable vba msaccess", "body": "<pre><code>Public Function TotalCount() As Long\n    TotalCount = DCount(\"*\", \"TBL_Name\")\nEnd Function \n</code></pre>\n\n<p>You can then call it:</p>\n\n<pre><code>ModuleName.TotalCount\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7850814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/729c3dcc139f79b6b455e54641b65aea?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Th", "link": "https://stackoverflow.com/users/7850814/mr-th"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 43762730, "answer_count": 1, "score": 0, "last_activity_date": 1493821299, "creation_date": 1493817929, "last_edit_date": 1493818455, "question_id": 43761416, "link": "https://stackoverflow.com/questions/43761416/how-to-store-a-table-records-count-into-global-variable-vba-msaccess", "title": "How to Store a table records count into global variable vba msaccess", "body": "<p>i declare a public var as integer to store the record's count of a table with vba code.</p>\n\n<p>using this code</p>\n\n<pre><code>public @VarName as integer\n@VarName = Dcount(\"*\",\"TBL_Name\")\n</code></pre>\n\n<p>and seems the dcount not working in public mode.</p>\n\n<p>how can i create such code?</p>\n"}, {"tags": ["vba", "email", "outlook", "outlook-2007"], "comments": [{"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1493820250, "post_id": 43761357, "comment_id": 74565860, "body": "Your if-statement is wrong in my eyes."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1493829756, "post_id": 43761357, "comment_id": 74572667, "body": "Appears the line with the error is Dim emails_forward(Count) As Integer. Count does not exist yet but it could if you made it a constant outside of this code. I assume you do not want that, perhaps emails_forward_Count no brackets."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1493850137, "post_id": 43761357, "comment_id": 74583289, "body": "Declare the array with <code>ReDim</code>, example: <code>ReDim emails_forward(Count) As Integer</code>"}, {"owner": {"reputation": 23, "user_id": 5789852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf076453b6241319efb15d06f564f8b?s=128&d=identicon&r=PG&f=1", "display_name": "Pio Sammut", "link": "https://stackoverflow.com/users/5789852/pio-sammut"}, "edited": false, "score": 0, "creation_date": 1493880146, "post_id": 43761357, "comment_id": 74591994, "body": "Thank you so much, the code is working now :)"}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1494453179, "creation_date": 1494453179, "answer_id": 43903304, "question_id": 43761357, "link": "https://stackoverflow.com/questions/43761357/collect-email-and-forward-compile-error-constant-expression-required/43903304#43903304", "title": "Collect email and forward - Compile error: Constant expression required", "body": "<p><em>Declare the array with <code>ReDim</code>, example: <code>ReDim emails_forward(Count) As Integer</code></em></p>\n\n<p><strong><em><a href=\"https://msdn.microsoft.com/en-us/library/office/gg278723.aspx\" rel=\"nofollow noreferrer\">MSDN Constant expression required</a></em></strong></p>\n"}], "owner": {"reputation": 23, "user_id": 5789852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf076453b6241319efb15d06f564f8b?s=128&d=identicon&r=PG&f=1", "display_name": "Pio Sammut", "link": "https://stackoverflow.com/users/5789852/pio-sammut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 190, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1593073180, "creation_date": 1493817786, "last_edit_date": 1593073180, "question_id": 43761357, "link": "https://stackoverflow.com/questions/43761357/collect-email-and-forward-compile-error-constant-expression-required", "title": "Collect email and forward - Compile error: Constant expression required", "body": "<p>I am trying to look for an email that is sent from a specific email address, and then, everyday between 09:00 and 11:00:00, forward all the emails from this specific email address to a second email address.</p>\n\n<p>I'm getting the following error.</p>\n\n<p><a href=\"https://i.stack.imgur.com/4z8Aw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4z8Aw.png\" alt=\"Compile error\"></a></p>\n\n<pre><code>Sub Search_Inbox()\n\n    Dim myOlApp As New Outlook.Application\n    Dim myNameSpace As Outlook.NameSpace\n    Dim myInbox As Outlook.MAPIFolder\n    Dim myitems As Outlook.Items\n    Dim myitem As Object\n    Dim Found As Boolean 'this is a boolean to check if the code found the emails or not\n    Dim Str_Address As String 'this is a String for an Email Address\n    Dim Mail_Value As MailItem 'this is where the email adresses will be stored\n    Dim Bool_Time As Boolean 'used to hold the time values\n    Dim Count As Integer 'used as the count for the array\n    Dim emails_forward(Count) As Integer 'used to hold all the emails to be forwarded when it is 11:00\n\n\n    Set myNameSpace = myOlApp.GetNamespace(\"MAPI\")\n    Set myInbox = myNameSpace.GetDefaultFolder(olFolderInbox)\n    Set myitems = myInbox.Items\n    Found = False\n\n    For Each myitem In myitems\n        'below is the selected time period\n        If Bool_Time = (Time &gt;= #9:00:00 AM#) And (Time &lt;= #10:59:59 AM#) Then\n            If myitem.Class = olMail Then\n                If InStr(1, myitem.Mail_Value, \"email address to search for\") &gt; 0 Then\n\n                    Forward_Emails (Mail_Value)\n\n                    Debug.Print \"Found\"\n                    Found = True\n                 End If\n            End If\n        End If\n    Next myitem\n\nEnd Sub\n\nFunction Forward_Emails(Email_to_Forward As Outlook.MailItem)\n\n    Set Email_to_Forward = Item.Forward\n\n    Email_to_Forward.Recipients.Add \"email address to forward to after\"\n    Email_to_Forward.Save\n\n\n    Email_to_Forward.Send\n    Set Email_to_Forward = Nothing\n\nEnd Function\n</code></pre>\n"}, {"tags": ["c#", "excel", "vba", "remote-access"], "comments": [{"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1493817412, "post_id": 43760905, "comment_id": 74563496, "body": "Why not compile as x64 then? Is that the problem?"}, {"owner": {"reputation": 406, "user_id": 4026969, "user_type": "registered", "accept_rate": 22, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dexter Whelan", "link": "https://stackoverflow.com/users/4026969/dexter-whelan"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1493820178, "post_id": 43760905, "comment_id": 74565809, "body": "I have no idea how. Once I download/extract the program source package. Then I am unable to open it in Visual studio it keeps giving a &#39;project needs to be migrated&#39; error. Is there a setting I can change somewhere on importing/opening the code to allow me to compile the code just fine or is this a problem that resides with the way the code was compiled to begin with?"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1493820400, "post_id": 43760905, "comment_id": 74565978, "body": "Once you have source code it can be compiled to x86 or x64 (unless there are constraints in the libraries used). If you need an x64 executable you should focus on that. Do you actually have source code (solution and project files). This is a very fragmented question I&#39;m not sure if I can help."}, {"owner": {"reputation": 406, "user_id": 4026969, "user_type": "registered", "accept_rate": 22, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dexter Whelan", "link": "https://stackoverflow.com/users/4026969/dexter-whelan"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1493886380, "post_id": 43760905, "comment_id": 74595849, "body": "well any direction is appreciate to be honest. It&#39;s all a learning curve for me. If you click this link it goes to where you can find the source code so you can see what I have access to. <a href=\"https://www.codeproject.com/Articles/9029/Push-and-Run-NET-Code-on-Remote-Machine\" rel=\"nofollow noreferrer\">codeproject.com/Articles/9029/&hellip;</a> top of the page is a zip with source in its name. if you inspect that maybe you could compile it on your machine and then guide me on how to replicate that as well?"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1493893774, "post_id": 43760905, "comment_id": 74600981, "body": "When I opened this in VS Express 2015 for Desktop, it offered me a <i>One Way Upgrade</i>. I pressed OK. I also pressed OK on security warnings. It popped up a report indicating everything was OK. I pressed Build and it built OK. I Pressed CTRL-F5 to run and it popped up a console window. How about you try getting that far"}, {"owner": {"reputation": 406, "user_id": 4026969, "user_type": "registered", "accept_rate": 22, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dexter Whelan", "link": "https://stackoverflow.com/users/4026969/dexter-whelan"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1493895314, "post_id": 43760905, "comment_id": 74602000, "body": "I could swear on the moon that I did all of this yesterday more than once and it kept throwing errors when the one-way upgrade window completed. Now it seems to have worked just fine, built and run (which I didn&#39;t have an option to build yesterday) Thanks for the help Nick, not sure what the error was yesterday, the only difference is I think git altered some files from being read only to writeable. if you want to put an answer in ill mark it as the right one if you&#39;d like."}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1493898128, "post_id": 43760905, "comment_id": 74603959, "body": "No thats OK it&#39;s not really an answer. Glad you sorted that part. It looks like a complex system you&#39;re implementing but I suggest you just stick with it and be methodical. Good luck"}], "answers": [{"tags": [], "owner": {"reputation": 406, "user_id": 4026969, "user_type": "registered", "accept_rate": 22, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dexter Whelan", "link": "https://stackoverflow.com/users/4026969/dexter-whelan"}, "is_accepted": false, "score": 0, "last_activity_date": 1493901978, "creation_date": 1493901978, "answer_id": 43783306, "question_id": 43760905, "link": "https://stackoverflow.com/questions/43760905/looking-to-launch-a-local-exe-on-a-remote-machine-without-having-the-resurces-on/43783306#43783306", "title": "Looking to launch a local exe on a remote machine without having the resurces on the remote machine", "body": "<p>Thanks to the help in comments from @Nick.McDermaid I was able to correctly open and build the project I was trying to download. Unsure what caused the issue previously with me not being able to open and interact with the code but now I have it I shall pursue this avenue further to accomplish my goal. </p>\n\n<p>As an addendum one other avenue I tried for executing code remotely was through VBS where I used </p>\n\n<pre><code>set svcproc=getobject(\"winmgmts:{impersonationLevel=impersonate}!\\\\\"&amp;MachineName &amp; \"\\root\\cimv2:win32_process\")\nscmd=\"\"\"C:\\Program Files\\Internet Explorer\\iexplore.exe\"\" -framemerging \"\"https://gifyu.com/images/Boo-Ghost-Gif.gif\"\"\"\n'scmd=\"C:\\Windows\\notepad.exe\"\n\niret=svcproc.create(scmd,null,null,pid)\nset svcproc=nothing\n</code></pre>\n\n<p>to execute something that existed on the remote machine but I ran into a LOT of security policy issues where I could launch the process but I couldn't bring it to the foreground as the Malware tracker on the machine thought it was an attack and quashed it immediately.</p>\n"}], "owner": {"reputation": 406, "user_id": 4026969, "user_type": "registered", "accept_rate": 22, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dexter Whelan", "link": "https://stackoverflow.com/users/4026969/dexter-whelan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493901978, "creation_date": 1493816675, "question_id": 43760905, "link": "https://stackoverflow.com/questions/43760905/looking-to-launch-a-local-exe-on-a-remote-machine-without-having-the-resurces-on", "title": "Looking to launch a local exe on a remote machine without having the resurces on the remote machine", "body": "<p>So I have built some code, it's quite simple basically it stops all active input from keyboard and mouse until a text file of a certain name appears in the C:\\Temp directory. It also has a manifest file to run it as administrator on start up.</p>\n\n<p>So I found something that on the surface looks like it fulfils my needs of being able to do this task however upon running it I found out that the project has been compiled in x86 and does not run on my x64 machine. Here is the <a href=\"https://www.codeproject.com/Articles/9029/Push-and-Run-NET-Code-on-Remote-Machine\" rel=\"nofollow noreferrer\">reference</a> to the project if anyone would like to look into it, it's a very smartly designed piece of code that does an interesting objective. It also explains clearly enough what I am trying to accomplish.</p>\n\n<p>So after implementing this (and failing) I have setup a couple other avenues to try, one is VBA through excel with the VBA copying itself to and from the machines in a list and running itself, then there is using VBS to write the entire code as a txt file on the target machine change the extension and then execute it remotely. I have just started researching these but I imagine the problems of running as an administrator amongst other things will crop up again to be dealt with. To be honest though I would really prefer to do this in C# only as that is the language I'm trying to go further in so I'm interested in this challenge. If anybody knows of a similar library of code or application I could look into to achieve what I'm trying I would appreciate being pointed in the right direction.</p>\n\n<p>I would try and be more specific about what libraires/API's im trying to implement but the truth is I don't know what libraries I need to even interact with to get what I want. My goal is to have C# executable code on my machine and a tool that can run that executable on another machine. </p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "macos", "ms-word"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1493816736, "post_id": 43760849, "comment_id": 74562901, "body": "Are you running the code from the same document? Also have you checked there are no references missing? You should post your whole code as it might be something else causing the issue."}, {"owner": {"reputation": 1, "user_id": 7957674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/368eb707990632b318c40cda20851fcc?s=128&d=identicon&r=PG&f=1", "display_name": "Poldou", "link": "https://stackoverflow.com/users/7957674/poldou"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1493817169, "post_id": 43760849, "comment_id": 74563290, "body": "yes from the same document. The code is really really simple, I&#39;ve a textbox inside the document and in the sub AutoOpen() I have ThisDocument.TextBox1.Locked = False."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1493817358, "post_id": 43760849, "comment_id": 74563449, "body": "Okay, stupid question time - have you checked that the <b>code</b> name of the textbox <i>is</i> actually <code>Textbox1</code> ?"}, {"owner": {"reputation": 1, "user_id": 7957674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/368eb707990632b318c40cda20851fcc?s=128&d=identicon&r=PG&f=1", "display_name": "Poldou", "link": "https://stackoverflow.com/users/7957674/poldou"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1493817910, "post_id": 43760849, "comment_id": 74563931, "body": "well that&#39;s a legit question, I think yes since I have the method TextBox1_Change() inside the macro. I can&#39;t confirm this at 100% because as now I can&#39;t figure out how to show properties of a TextBox in office for Mac ( usually that was right-click-&gt;properties in dev mode but seems not here... )"}, {"owner": {"reputation": 1, "user_id": 7957674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/368eb707990632b318c40cda20851fcc?s=128&d=identicon&r=PG&f=1", "display_name": "Poldou", "link": "https://stackoverflow.com/users/7957674/poldou"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1493818978, "post_id": 43760849, "comment_id": 74564806, "body": "It can be that since I&#39;ve created these TextBoxes as ActiveX object they aren&#39;t correctly rendered by office for Mac?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1493819032, "post_id": 43760849, "comment_id": 74564842, "body": "Yes - Mac doesn&#39;t support ActiveX, unless you have a specific reason for ActiveX you should always stick to standard form controls"}, {"owner": {"reputation": 1, "user_id": 7957674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/368eb707990632b318c40cda20851fcc?s=128&d=identicon&r=PG&f=1", "display_name": "Poldou", "link": "https://stackoverflow.com/users/7957674/poldou"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1493819122, "post_id": 43760849, "comment_id": 74564924, "body": "Mistery solved. Noob me. Thank you very much for support."}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1493820448, "post_id": 43760849, "comment_id": 74566016, "body": "@Poldou You should probably consider posting an answer to your question. However, it has been already answered in other threads."}], "owner": {"reputation": 1, "user_id": 7957674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/368eb707990632b318c40cda20851fcc?s=128&d=identicon&r=PG&f=1", "display_name": "Poldou", "link": "https://stackoverflow.com/users/7957674/poldou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1592988706, "creation_date": 1493816518, "last_edit_date": 1592988706, "question_id": 43760849, "link": "https://stackoverflow.com/questions/43760849/enable-textbox-with-vba-office-2011-mac", "title": "Enable textbox with VBA Office 2011 Mac", "body": "<p>I'm using Office 2011 for Mac and I'm trying to create a macro for a Word document that simply unlock an inserted TextBox. </p>\n\n<p>The standard procedure that I used on Word for Windows is: <code>ThisDocument.&lt;TextBoxName&gt;.Locked=False</code>, but this fails saying that there is no object with that name. </p>\n\n<p>Any clue about this?</p>\n"}, {"tags": ["vba", "ms-access", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 2930442, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/i6zov.jpg?s=128&g=1", "display_name": "Arne", "link": "https://stackoverflow.com/users/2930442/arne"}, "edited": false, "score": 0, "creation_date": 1493879141, "post_id": 43761580, "comment_id": 74591429, "body": "Hey! This was exactly what I was looking for, and I did give it a shot just now. Some issues however, after i run activedocument.fields.update, my form fields resets to blank. Which ofcourse leads to the cross-references being blank"}], "tags": [], "owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "is_accepted": false, "score": 1, "last_activity_date": 1493818364, "creation_date": 1493818364, "answer_id": 43761580, "question_id": 43760626, "link": "https://stackoverflow.com/questions/43760626/editing-formfields-references-in-word-from-access/43761580#43761580", "title": "Editing formfields/references in word from Access", "body": "<p>You have already filled in your required form fields. If you want to repeat these values you can use <a href=\"https://support.office.com/en-gb/article/Create-a-cross-reference-300b208c-e45a-487a-880b-a02767d9774b\" rel=\"nofollow noreferrer\">cross-reference</a></p>\n\n<p>Once you set all the fields following the steps below, then you can auto update fields using <code>ActiveDocument.Fields.Update</code> after populating your form fields.</p>\n\n<blockquote>\n  <p>Insert -> Cross-Reference(Under Links)</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/vEFGr.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vEFGr.jpg\" alt=\"enter image description here\"></a></p>\n\n<blockquote>\n  <p>Select Reference type as Bookmark and Insert</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/yRurd.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yRurd.jpg\" alt=\"enter image description here\"></a></p>\n\n<blockquote>\n  <p>Use <code>ActiveDocument.Fields.Update</code> in vba to update fields.</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/WeAcD.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WeAcD.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 75, "user_id": 2930442, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/i6zov.jpg?s=128&g=1", "display_name": "Arne", "link": "https://stackoverflow.com/users/2930442/arne"}, "is_accepted": true, "score": 0, "last_activity_date": 1493881591, "creation_date": 1493881591, "answer_id": 43776101, "question_id": 43760626, "link": "https://stackoverflow.com/questions/43760626/editing-formfields-references-in-word-from-access/43776101#43776101", "title": "Editing formfields/references in word from Access", "body": "<p>I tried the suggested solution but my problem was that when i updated all the fields in the document the Form-fields reset to blank.\nI worked around this by looping through the cross-reference fields only, and hitting update on them individually.</p>\n\n<pre><code>    docField as Word.Field\n\n    For Each docField In doc.Fields\n    If docField.Type = wdFieldRef Then\n        docField.Update\n    End If\n    Next docField\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 2930442, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/i6zov.jpg?s=128&g=1", "display_name": "Arne", "link": "https://stackoverflow.com/users/2930442/arne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 43776101, "answer_count": 2, "score": 1, "last_activity_date": 1493881591, "creation_date": 1493816005, "last_edit_date": 1493816406, "question_id": 43760626, "link": "https://stackoverflow.com/questions/43760626/editing-formfields-references-in-word-from-access", "title": "Editing formfields/references in word from Access", "body": "<p>Im using access to edit Word documents, and im using this code (example) to fill formfields in the document:</p>\n\n<pre><code>.FormFields(\"txtProsjektNavn\").result = DLookup(\"txt\", dbName, \"key = \n'byggNavn'\")\n.FormFields(\"txtProsjektNr\").result = DLookup(\"value1\", dbName, \"key = \n'prosjektNr'\")\n.FormFields(\"txtOverblikk\").result = DLookup(\"txt\", dbName, \"key = \n'txtOverblikk'\")\n.FormFields(\"txtByggEier\").result = DLookup(\"txt\", dbName, \"key = \n'byggEier'\")\n</code></pre>\n\n<p>This is all working fine and dandy, however.\nSome of these values needs to be repeated several times in the document.\nIve figured that giving 2 formfields the same bookmark name in the word document is a no-no. So instead of having to create lots of formfields with different names, i attempted to create REF fields that refered to the already made form fields, however, they do not update when access updates the formfields themselves.</p>\n\n<p>Does anyone have a solution to this or do I simply need to make lots of formfields with different names, like: text1, text2, text3 and then have access fill them all with the same value.</p>\n"}, {"tags": ["excel", "vba", "powerpoint"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1493815848, "post_id": 43760439, "comment_id": 74562238, "body": "In what format you want to copt the Excel&#39;s Range to the PowerPoint Slide ? A Picture ? as what ?"}, {"owner": {"reputation": 109, "user_id": 7191500, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2FDjM.jpg?s=128&g=1", "display_name": "jmeddy", "link": "https://stackoverflow.com/users/7191500/jmeddy"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1493816308, "post_id": 43760439, "comment_id": 74562587, "body": "As a table, keeping basically the same source formatting. That doesn&#39;t seem to be the issue, its the lines of code afterwards to move the table in the slide that fails."}, {"owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 2, "creation_date": 1493817358, "post_id": 43760439, "comment_id": 74563450, "body": "Have you tried adding PPSlide.Select right before your PPSlide.Shapes(1).Select ?"}, {"owner": {"reputation": 109, "user_id": 7191500, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2FDjM.jpg?s=128&g=1", "display_name": "jmeddy", "link": "https://stackoverflow.com/users/7191500/jmeddy"}, "edited": false, "score": 0, "creation_date": 1493818554, "post_id": 43760439, "comment_id": 74564434, "body": "Hi Rich, I think that was the missing link. Your suggestion also worked - Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1493817921, "creation_date": 1493817921, "answer_id": 43761412, "question_id": 43760439, "link": "https://stackoverflow.com/questions/43760439/excel-vba-2010-issue-with-selecting-and-moving-table-after-pasting-into-powerpoi/43761412#43761412", "title": "Excel VBA 2010 issue with selecting and moving table after pasting into Powerpoint", "body": "<p>Try the code below:</p>\n\n<pre><code>Set pp = CreateObject(\"PowerPoint.Application\")\nSet ppPres = pp.Presentations.Open(DestinationPPT)\npp.Visible = True\n\n' first set the Slide and select it\nSlideCount = ppPres.Slides.Count\nSet ppSlide = ppPres.Slides.Add(SlideCount, 12)\nppSlide.Select\n\n' have the Copy part right beofre youe Paste it to PowerPoint\nSet Rng = ActiveSheet.Range(\"CA1:CJ\" &amp; Count + 1)\nRng.Copy\n\npp.ActivePresentation.Application.CommandBars.ExecuteMso (\"PasteSourceFormatting\")\n\nDim myShape As Object\n' set up the Pasted shape to an object\nSet myShape = ppSlide.Shapes(ppSlide.Shapes.Count)\n\nWith myShape\n    ' set-up the shape properties\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 7191500, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2FDjM.jpg?s=128&g=1", "display_name": "jmeddy", "link": "https://stackoverflow.com/users/7191500/jmeddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 497, "favorite_count": 0, "accepted_answer_id": 43761412, "answer_count": 1, "score": 0, "last_activity_date": 1493817921, "creation_date": 1493815563, "question_id": 43760439, "link": "https://stackoverflow.com/questions/43760439/excel-vba-2010-issue-with-selecting-and-moving-table-after-pasting-into-powerpoi", "title": "Excel VBA 2010 issue with selecting and moving table after pasting into Powerpoint", "body": "<p>I have the code below which I found online to copy paste a tble from excel to powerpoint. After pasting the table into the slide, it fails on <code>PPSlide.Shapes(1).Select</code> with a Run-time error '-2147188160 (80048240)': Shape.Select : Invalide request. To select a shape, its view must be active.\nI've been searching and trying different things but can't seem to figure it out.. I thought after the paste that the table would be active and the code would jsut continue but it doesn't unless I activate/select the table in the slide and then click Run. Any help is appreciated. Thanks.</p>\n\n<pre><code>Dim pp As Object\nDim PPPres As Object\nDim PPSlide As Object\nDim Rng As Range\n\nDestinationPPT = \"C:\\Users\\username\\Desktop\\Data_Display.pptx\"\nSet pp = CreateObject(\"PowerPoint.Application\")\nSet PPPres = pp.Presentations.Open(DestinationPPT)\npp.Visible = True\nSet Rng = ActiveSheet.Range(\"CA1:CJ\" &amp; Count + 1)\n\nRng.Copy\n\nSlideCount = PPPres.Slides.Count\nSet PPSlide = PPPres.Slides.Add(SlideCount, 12)\npp.ActivePresentation.Application.CommandBars.ExecuteMso (\"PasteSourceFormatting\")\n\nPPSlide.Shapes(1).Select\npp.ActiveWindow.Selection.ShapeRange.Align msoAlignTops, True\npp.ActiveWindow.Selection.ShapeRange.Top = 65\npp.ActiveWindow.Selection.ShapeRange.Left = 7.2\npp.ActiveWindow.Selection.ShapeRange.Width = 700\n\nSet PPSlide = Nothing\nSet PPPres = Nothing\nSet pp = Nothing\n</code></pre>\n"}, {"tags": ["vba", "excel", "dictionary"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 3, "creation_date": 1493813638, "post_id": 43759698, "comment_id": 74560556, "body": "Sort the dictionary descending or start with the last row. This way the row numbers don&#39;t change during the delete process."}, {"owner": {"reputation": 71, "user_id": 7855552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37814452b191644eac96327e198e4ea4?s=128&d=identicon&r=PG&f=1", "display_name": "VBABegginer", "link": "https://stackoverflow.com/users/7855552/vbabegginer"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1493813735, "post_id": 43759698, "comment_id": 74560634, "body": "how to sort it ?"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 1, "creation_date": 1493813818, "post_id": 43759698, "comment_id": 74560705, "body": "Write <code>Option Explicit</code> at the top of your code sheet. Then declare all variables, finding the correct data type. Select &quot;Key&quot; and click F1. You will be told that it is a word reserved for VBA. So, better don&#39;t use it for your own purposes. Finally, don&#39;t start your experiments with <code>For Each</code>. Build a <code>For   ... Next</code> loop first."}, {"owner": {"reputation": 71, "user_id": 7855552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37814452b191644eac96327e198e4ea4?s=128&d=identicon&r=PG&f=1", "display_name": "VBABegginer", "link": "https://stackoverflow.com/users/7855552/vbabegginer"}, "edited": false, "score": 0, "creation_date": 1493813996, "post_id": 43759698, "comment_id": 74560827, "body": "How can I go through Dictionary Keys with a For ... Next loop ?"}, {"owner": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "edited": false, "score": 1, "creation_date": 1493814417, "post_id": 43759698, "comment_id": 74561145, "body": "A <code>For Each</code> is the easiest method for Dictionary. To use a <code>For Next</code> loop you might need to do something destructive like read item 1, remove it, read item 1... etc until its empty. (there are probably many better, non-destructive methods though!)"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 7855552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37814452b191644eac96327e198e4ea4?s=128&d=identicon&r=PG&f=1", "display_name": "VBABegginer", "link": "https://stackoverflow.com/users/7855552/vbabegginer"}, "edited": false, "score": 0, "creation_date": 1493815193, "post_id": 43759847, "comment_id": 74561729, "body": "Thank you, man :) It worked perfectly but I guess I have way too many rows. The script was running for almost 5 mins"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 71, "user_id": 7855552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37814452b191644eac96327e198e4ea4?s=128&d=identicon&r=PG&f=1", "display_name": "VBABegginer", "link": "https://stackoverflow.com/users/7855552/vbabegginer"}, "edited": false, "score": 0, "creation_date": 1493817004, "post_id": 43759847, "comment_id": 74563140, "body": "You&#39;re welcome. Then how did the chosen answer worke differently and faster? :)"}, {"owner": {"reputation": 71, "user_id": 7855552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37814452b191644eac96327e198e4ea4?s=128&d=identicon&r=PG&f=1", "display_name": "VBABegginer", "link": "https://stackoverflow.com/users/7855552/vbabegginer"}, "edited": false, "score": 0, "creation_date": 1493817911, "post_id": 43759847, "comment_id": 74563932, "body": "Still working on it :D I will update it if it not faster. In the question itself I wrote that both of you solved it."}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 2, "last_activity_date": 1493813970, "creation_date": 1493813970, "answer_id": 43759847, "question_id": 43759698, "link": "https://stackoverflow.com/questions/43759698/deleting-rows-in-excel-based-on-dictionary-value-in-excel-vba/43759847#43759847", "title": "Deleting rows in Excel based on Dictionary value in Excel VBA", "body": "<p>You may try something like this...</p>\n\n<pre><code>Dim rng As Range\nDim it\n\nFor Each it In dict.keys\n    If rng Is Nothing Then\n        Set rng = Range(\"A\" &amp; it)\n    Else\n        Set rng = Union(rng, Range(\"A\" &amp; it))\n    End If\nNext it\nIf Not rng Is Nothing Then\n    rng.EntireRow.Delete\nEnd If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 7855552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37814452b191644eac96327e198e4ea4?s=128&d=identicon&r=PG&f=1", "display_name": "VBABegginer", "link": "https://stackoverflow.com/users/7855552/vbabegginer"}, "edited": false, "score": 0, "creation_date": 1493814424, "post_id": 43759917, "comment_id": 74561150, "body": "Is there a way to make it more dynamic? Currently I have 380 000 rows but this number might vary."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1493814795, "post_id": 43759917, "comment_id": 74561438, "body": "Of course. You just need to clarify your rule for defining the range. For example, if you wanted the range to be &quot;A1&quot; to end very bottom of your data in column &quot;A&quot;, then you&#39;d use something like my edited answer."}, {"owner": {"reputation": 71, "user_id": 7855552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37814452b191644eac96327e198e4ea4?s=128&d=identicon&r=PG&f=1", "display_name": "VBABegginer", "link": "https://stackoverflow.com/users/7855552/vbabegginer"}, "edited": false, "score": 0, "creation_date": 1493815032, "post_id": 43759917, "comment_id": 74561592, "body": "Awesome! Thank you :) I am testing both options now and I will update the question hopefully as solved after that!"}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 71, "user_id": 7855552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37814452b191644eac96327e198e4ea4?s=128&d=identicon&r=PG&f=1", "display_name": "VBABegginer", "link": "https://stackoverflow.com/users/7855552/vbabegginer"}, "edited": false, "score": 0, "creation_date": 1493815434, "post_id": 43759917, "comment_id": 74561910, "body": "Good for you. Enjoy your journey into VBA. Once you get the hang of loops and collections, have a look at reading a Range into an array. With a dataset of 380,000, an array would dramatically increase speed."}, {"owner": {"reputation": 71, "user_id": 7855552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37814452b191644eac96327e198e4ea4?s=128&d=identicon&r=PG&f=1", "display_name": "VBABegginer", "link": "https://stackoverflow.com/users/7855552/vbabegginer"}, "edited": false, "score": 0, "creation_date": 1493817795, "post_id": 43759917, "comment_id": 74563825, "body": "Hey, I have a follow up question. What if my rows don&#39;t have unique data. For example Columns A has 5 rows with &quot;John&quot; and in row 3 there is &quot;1&quot; stored in column B. How can I remember this 5 and delete it later on?"}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 71, "user_id": 7855552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37814452b191644eac96327e198e4ea4?s=128&d=identicon&r=PG&f=1", "display_name": "VBABegginer", "link": "https://stackoverflow.com/users/7855552/vbabegginer"}, "edited": false, "score": 0, "creation_date": 1493826925, "post_id": 43759917, "comment_id": 74571007, "body": "Post that as a new question, as the answer differs quite a bit from this question. Try to post some same sample data and explain quite carefully exactly what you want to do with it."}], "tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": true, "score": 1, "last_activity_date": 1493814834, "last_edit_date": 1493814834, "creation_date": 1493814165, "answer_id": 43759917, "question_id": 43759698, "link": "https://stackoverflow.com/questions/43759698/deleting-rows-in-excel-based-on-dictionary-value-in-excel-vba/43759917#43759917", "title": "Deleting rows in Excel based on Dictionary value in Excel VBA", "body": "<p>I'm not sure I'd bother with the <code>Dictionary</code>. Afterall, a <code>Range</code> is a collection, so perhaps just consider putting all of your target rows into a range and run the 'bulk' delete on that range. It'd be far quicker than a delete by looping rows:</p>\n\n<pre><code>Dim delRng As Range, srcRng As Range, cell As Range\n\n'Loop through the range containing your criterion test\nWith Sheet1\n    Set srcRng = .Range(.Cells(1, \"A\"), .Cells(.Rows.Count, \"A\").End(xlUp))\nEnd With\n\nFor Each cell In srcRng.Cells\n    If cell.Value2 = 1 Then 'change to your criterion\n        'It's a hit so add the cell to our delete range\n        If delRng Is Nothing Then\n            Set delRng = cell\n        Else\n            Set delRng = Union(delRng, cell)\n        End If\n    End If\nNext\n\n'Delete the rows\nIf Not delRng Is Nothing Then delRng.EntireRow.Delete\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 7855552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37814452b191644eac96327e198e4ea4?s=128&d=identicon&r=PG&f=1", "display_name": "VBABegginer", "link": "https://stackoverflow.com/users/7855552/vbabegginer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 351, "favorite_count": 0, "accepted_answer_id": 43759917, "answer_count": 2, "score": 0, "last_activity_date": 1493815857, "creation_date": 1493813472, "last_edit_date": 1493815857, "question_id": 43759698, "link": "https://stackoverflow.com/questions/43759698/deleting-rows-in-excel-based-on-dictionary-value-in-excel-vba", "title": "Deleting rows in Excel based on Dictionary value in Excel VBA", "body": "<p>I am still getting into VBA and currently I am trying to do the following:\n- Delete rows in an Excel sheet based on a value stored in a dictionary.</p>\n\n<p>I have this code:</p>\n\n<pre><code>For Each Key In dict.Keys\n    i = Key\n    Cells.Rows(i).Delete\nNext\n</code></pre>\n\n<p>where before that I have populated the dictionary. The idea is that the \"key\" stores all the row number in which a specific value is stored, for example \"1\".</p>\n\n<p>With the for each I want to delete all the rows stored in the dictionary, but once you delete a row in Excel the number changes. For example the first stored value in the dictionary is 5, so the for each will delete row number 5. The second value in the dictionary is 10 and now when the for each tries to delete row 10, it delete row 10, which in the original file used to be row 11. Basically the for each fails to delete the correct rows.</p>\n\n<p>As I said I am new to VBA and I am not even sure if this is the correct way to do this or there is something better than dictionaries for this situation. I am looking forward to hearing your ideas and suggestions. </p>\n\n<p>Thank you in advance! </p>\n\n<p>Update: Solved by Ambie and sktneer. Check answers.</p>\n"}, {"tags": ["excel", "find", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1493812954, "post_id": 43759463, "comment_id": 74560061, "body": "Classic for <code>RegEx</code> , nice demo site : <a href=\"https://regex101.com/r/sUOCSd/3\" rel=\"nofollow noreferrer\">regex101.com/r/sUOCSd/3</a>"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1493813081, "post_id": 43759463, "comment_id": 74560144, "body": "Do you want an Excel formula or a VBA function? With VBA, I would suggest to use the split-command"}], "answers": [{"comments": [{"owner": {"reputation": 1185, "user_id": 7848703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad638771bba77c82a12c225996904be?s=128&d=identicon&r=PG&f=1", "display_name": "India.Rocket", "link": "https://stackoverflow.com/users/7848703/india-rocket"}, "edited": false, "score": 0, "creation_date": 1493813404, "post_id": 43759598, "comment_id": 74560380, "body": "edited the formula to include date in the result which I missed earlier"}], "tags": [], "owner": {"reputation": 1185, "user_id": 7848703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad638771bba77c82a12c225996904be?s=128&d=identicon&r=PG&f=1", "display_name": "India.Rocket", "link": "https://stackoverflow.com/users/7848703/india-rocket"}, "is_accepted": false, "score": 0, "last_activity_date": 1493813186, "creation_date": 1493813186, "answer_id": 43759598, "question_id": 43759463, "link": "https://stackoverflow.com/questions/43759463/extract-correct-number-of-characters-from-cell/43759598#43759598", "title": "Extract correct number of characters from cell", "body": "<p>Using Find, Mid and Trim.</p>\n\n<p>Try this:- </p>\n\n<pre><code>=TRIM(MID(A1,FIND(\"C\",A1,FIND(\"C\",A1))+FIND(\"C\",A1)-2,LEN(A1)))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 1, "last_activity_date": 1493813353, "creation_date": 1493813353, "answer_id": 43759653, "question_id": 43759463, "link": "https://stackoverflow.com/questions/43759463/extract-correct-number-of-characters-from-cell/43759653#43759653", "title": "Extract correct number of characters from cell", "body": "<p>Assuming your string is in A2, then try this...</p>\n\n<pre><code>=MID(A2,FIND(\"^\",SUBSTITUTE(A2,\" \",\"^\",2))+1,255)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1493813854, "creation_date": 1493813854, "answer_id": 43759818, "question_id": 43759463, "link": "https://stackoverflow.com/questions/43759463/extract-correct-number-of-characters-from-cell/43759818#43759818", "title": "Extract correct number of characters from cell", "body": "<p>With data in column <strong>A</strong>, in <strong>B1</strong> enter:</p>\n\n<pre><code>=MID(A1,FIND(\"CA \",A1)+3,8)\n</code></pre>\n\n<p>and copy down.  In <strong>C1</strong> enter:</p>\n\n<pre><code>=MID(TRIM(MID(SUBSTITUTE($A1,\" \",REPT(\" \",999)),4*999-998,999)),2,9999)\n</code></pre>\n\n<p>and copy down.</p>\n\n<p><a href=\"https://i.stack.imgur.com/lksZh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lksZh.png\" alt=\"enter image description here\"></a></p>\n\n<p>This gets the date as a string and the digits following that final <strong>C</strong>.</p>\n"}], "owner": {"reputation": 1, "user_id": 7941901, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154758334687762/picture?type=large", "display_name": "Huib Meulenbelt", "link": "https://stackoverflow.com/users/7941901/huib-meulenbelt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1493815596, "creation_date": 1493812790, "last_edit_date": 1531161705, "question_id": 43759463, "link": "https://stackoverflow.com/questions/43759463/extract-correct-number-of-characters-from-cell", "title": "Extract correct number of characters from cell", "body": "<p>I would like to extract the correct number of characters from a cell in Excel.</p>\n\n<p>The following possibilities can be found in the cells:</p>\n\n<ul>\n<li>AAI CA 05/19/18 C30</li>\n<li>AAI CA 05/19/18 C32</li>\n<li>AAIO CA 05/19/18 C35</li>\n<li>AAI CA 05/19/18 C300</li>\n<li>AAIO CA 05/19/18 C300</li>\n</ul>\n\n<p>I want to retrieve the date and the C + x-numbers (in this case 2 and 3 numbers) on the right. </p>\n\n<p>For the x-numbers on the right I have the following formula </p>\n\n<pre><code>=MID(A1,FIND(\" C\",A1),5)\n</code></pre>\n\n<p>However, how do I make sure that the right \"C\" (the second one) is used in my formula? </p>\n\n<p>In addition, I am struggling with retrieve the data from the cell. The date is always 8 characters long.</p>\n"}, {"tags": ["vba", "powershell", "outlook"], "comments": [{"owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 0, "creation_date": 1493811729, "post_id": 43758807, "comment_id": 74559151, "body": "please check  this <a href=\"http://stackoverflow.com/questions/4037939/powershell-says-execution-of-scripts-is-disabled-on-this-system\" title=\"powershell says execution of scripts is disabled on this system\">stackoverflow.com/questions/4037939/&hellip;</a>"}, {"owner": {"reputation": 629, "user_id": 1618897, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/15637cf5b2111cd1774c743baddce391?s=128&d=identicon&r=PG", "display_name": "Tanaka Saito", "link": "https://stackoverflow.com/users/1618897/tanaka-saito"}, "reply_to_user": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 0, "creation_date": 1493812120, "post_id": 43758807, "comment_id": 74559432, "body": "Thank you, however that post gives answers telling OP that (s)he should use -ExecutionPolicy Bypass when calling the Powershell instance. This is what I&#39;m describing in the above post but I&#39;m still getting the &#39;invalid procedure call&#39; error."}, {"owner": {"reputation": 1024, "user_id": 6590026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4b79ef46b6629bc726f5064d9e405d22?s=128&d=identicon&r=PG&f=1", "display_name": "Seth", "link": "https://stackoverflow.com/users/6590026/seth"}, "edited": false, "score": 1, "creation_date": 1493812946, "post_id": 43758807, "comment_id": 74560056, "body": "Are you sure your parameters for the call are correct? I&#39;m not that familiar with VBA but it looks like you insert a <code>&quot;</code> but don&#39;t end the path to the script with one? Does this work (with the error about execution permissions) if you just remove the execution policy parameter?"}, {"owner": {"reputation": 629, "user_id": 1618897, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/15637cf5b2111cd1774c743baddce391?s=128&d=identicon&r=PG", "display_name": "Tanaka Saito", "link": "https://stackoverflow.com/users/1618897/tanaka-saito"}, "edited": false, "score": 0, "creation_date": 1493813068, "post_id": 43758807, "comment_id": 74560138, "body": "Yes, I was trying to describe just that. The first section (without the -ExecutionPolicy Bypass) works and starts a Powershell instance. The first thing that is displayed there is the &quot;running scripts are disabled on your system&quot;. If I in that window run Get-ExecutionPolicy it is set to Restricted, so I need to call the Powershell instance with elevated privileges from the VBA code. I&#39;m sure that it&#39;s the parameter call in the VBA stuff that&#39;s incorrect, but I can&#39;t figure out what :)"}, {"owner": {"reputation": 18017, "user_id": 1627055, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/yDnmH.jpg?s=128&g=1", "display_name": "Vesper", "link": "https://stackoverflow.com/users/1627055/vesper"}, "edited": false, "score": 1, "creation_date": 1493815256, "post_id": 43758807, "comment_id": 74561784, "body": "Check if <code>RemoteSigned</code> as supplied execution policy would work. Or plain sign your file. I expect that you&#39;re trying to do what hackers do in order to exploit the system into running unsigned (read any) code."}, {"owner": {"reputation": 629, "user_id": 1618897, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/15637cf5b2111cd1774c743baddce391?s=128&d=identicon&r=PG", "display_name": "Tanaka Saito", "link": "https://stackoverflow.com/users/1618897/tanaka-saito"}, "edited": false, "score": 0, "creation_date": 1493815350, "post_id": 43758807, "comment_id": 74561846, "body": "Holy moly, that worked, thank you so much! I assume that VBA doesn&#39;t allow for calling the -ExecutionPolicy parameter with Bypass, or is there another reason that this is prohibited?"}, {"owner": {"reputation": 629, "user_id": 1618897, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/15637cf5b2111cd1774c743baddce391?s=128&d=identicon&r=PG", "display_name": "Tanaka Saito", "link": "https://stackoverflow.com/users/1618897/tanaka-saito"}, "edited": false, "score": 0, "creation_date": 1493818053, "post_id": 43758807, "comment_id": 74564054, "body": "If you add the RemoteSigned stuff as an answer I can mark it as accepted by the way :)"}], "answers": [{"tags": [], "owner": {"reputation": 629, "user_id": 1618897, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/15637cf5b2111cd1774c743baddce391?s=128&d=identicon&r=PG", "display_name": "Tanaka Saito", "link": "https://stackoverflow.com/users/1618897/tanaka-saito"}, "is_accepted": true, "score": 0, "last_activity_date": 1615858584, "creation_date": 1615858584, "answer_id": 66647950, "question_id": 43758807, "link": "https://stackoverflow.com/questions/43758807/running-a-powershell-script-from-a-vba-script/66647950#66647950", "title": "Running a Powershell script from a VBA script", "body": "<p>To make it easier for future viewers: the solution was to instead of using -ExecutionPolicy Bypass which seems to be restricted (for good reasons) I instead used -ExecutionPolicy RemoteSigned and that did the trick. Thanks to @Vesper for providing the solution.</p>\n"}], "owner": {"reputation": 629, "user_id": 1618897, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/15637cf5b2111cd1774c743baddce391?s=128&d=identicon&r=PG", "display_name": "Tanaka Saito", "link": "https://stackoverflow.com/users/1618897/tanaka-saito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4852, "favorite_count": 0, "accepted_answer_id": 66647950, "answer_count": 1, "score": 2, "last_activity_date": 1615858584, "creation_date": 1493810978, "question_id": 43758807, "link": "https://stackoverflow.com/questions/43758807/running-a-powershell-script-from-a-vba-script", "title": "Running a Powershell script from a VBA script", "body": "<p>This is most likely a question related to the way I'm calling the Powershell instance from the VBA code, but I could not find the relevant information on StackOverflow. <a href=\"https://social.technet.microsoft.com/Forums/office/en-US/c8478b8d-53a5-4c41-b229-1b35c25277b3/calling-a-ps-script-from-vba?forum=winserverpowershell\" rel=\"nofollow noreferrer\">This Microsoft forum post</a> made a very simple suggestion but I couldn't make it work. <a href=\"https://social.msdn.microsoft.com/Forums/en-US/9a039149-8f95-4cad-ae29-d78e0864bc5c/calling-a-powershell-script-from-vba-in-access?forum=isvvba\" rel=\"nofollow noreferrer\">Others had similar suggestions</a> but I can't make it run in my environment.</p>\n\n<p>My goal is to run a specific Powershell script when I receive a mail in Outlook. This could probably be done easier by making the actual script in VBA to begin with, but since I'm already trying to learn Powershell first and foremost I would rather not go down the VBA road just yet. The Powershell script itself can run and works fine on its own, but VBA in the ThisOutlookSession can't seem to call it (read: I'm making a mistake somewhere that makes VBA unable to call the Powershell script). In order to make sure it's not the Powershell script I made a simple test script that only displays a pop-up window saying 'operation completed'.</p>\n\n<p>This is the VBA code:</p>\n\n<pre><code>Sub test()\n'Call Powershell and run scripts\n    Call Shell(\"powershell -noexit -file \"\"c:\\users\\me\\desktop\\test.ps1\")\nEnd Sub\n</code></pre>\n\n<p>This runs and opens a Powershell instance but says that \"running scripts are disabled on your system\", ergo I need to use the -ExecutionPolicy parameter. I changed the script to the following:</p>\n\n<pre><code>Sub test()\n'Call Powershell and run scripts\n    Call Shell(\"powershell -noexit -ExecutionPolicy Bypass -file \"\"c:\\users\\me\\desktop\\test.ps1\")\nEnd Sub\n</code></pre>\n\n<p>This makes the VBA code unable to run with the following error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/NzugN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NzugN.png\" alt=\"Invalid Procedure Call\"></a></p>\n\n<p>This error occurs regardless of where I put the -ExecutionPolicy (before -Noexit, after -File, etc.). I have enabled macros from the Trust Center settings and restarted Outlook. I tried fiddling around with the quotation marks, and by adding some other parameters (-NoProfile etc.) to see if that worked but it still gives the same result. I'm fairly sure that it is the formatting of the -ExecutionPolicy, or the order of it that makes it unable to call it. </p>\n\n<p>Any ideas are appreciated!</p>\n"}, {"tags": ["sql", "vba", "ms-word", "mailmerge"], "comments": [{"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1493811011, "post_id": 43758651, "comment_id": 74558614, "body": "Do you understand each line of your code? Can you rule out that no line in your code executes the query? If yes, does your code call on any other resources/execute any other scripts?"}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 5597574, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MpCZrw5M9XU/AAAAAAAAAAI/AAAAAAAAEUw/vIbgGC9g2ZQ/photo.jpg?sz=128", "display_name": "Luc S", "link": "https://stackoverflow.com/users/5597574/luc-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1493813117, "creation_date": 1493813117, "answer_id": 43759574, "question_id": 43758651, "link": "https://stackoverflow.com/questions/43758651/locate-ms-word-mail-merge-data-source/43759574#43759574", "title": "Locate MS Word Mail Merge Data Source", "body": "<p>It turns out that the warning message that appears and displays the data source location was turned off via the registry. </p>\n\n<p>To clarify, the VBA code does not have any reference to the data source itself.</p>\n\n<p><a href=\"https://i.stack.imgur.com/UIZoq.png\" rel=\"nofollow noreferrer\">This is what appears for the user under normal circumstances.</a></p>\n"}], "owner": {"reputation": 3, "user_id": 5597574, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MpCZrw5M9XU/AAAAAAAAAAI/AAAAAAAAEUw/vIbgGC9g2ZQ/photo.jpg?sz=128", "display_name": "Luc S", "link": "https://stackoverflow.com/users/5597574/luc-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493813117, "creation_date": 1493810587, "question_id": 43758651, "link": "https://stackoverflow.com/questions/43758651/locate-ms-word-mail-merge-data-source", "title": "Locate MS Word Mail Merge Data Source", "body": "<p>I have a number of Word Documents that perform mail merge operations on startup by running an SQL query against a data source. </p>\n\n<p>I have access to the underlying VBA code in the template but I can't seem to determine where exactly the actual database being queried is located. </p>\n\n<p>How can I find the verbatim of the SQL query being executed and/or the location of the data source? </p>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "vba"], "answers": [{"comments": [{"owner": {"reputation": 661, "user_id": 6261724, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c25759016b756f388b0ac6dfa1e76b85?s=128&d=identicon&r=PG&f=1", "display_name": "tchan", "link": "https://stackoverflow.com/users/6261724/tchan"}, "edited": false, "score": 0, "creation_date": 1493967777, "post_id": 43758422, "comment_id": 74637059, "body": "Thanks for that @Rory."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1493811400, "last_edit_date": 1493811400, "creation_date": 1493809982, "answer_id": 43758422, "question_id": 43758374, "link": "https://stackoverflow.com/questions/43758374/how-to-convert-vlookup-to-index-match/43758422#43758422", "title": "How to convert Vlookup to Index/match?", "body": "<pre><code>=INDEX(C:C,MATCH(\"Puzzle 1\",A:A,0)+1)\n</code></pre>\n\n<p>would work for that.</p>\n"}], "owner": {"reputation": 661, "user_id": 6261724, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c25759016b756f388b0ac6dfa1e76b85?s=128&d=identicon&r=PG&f=1", "display_name": "tchan", "link": "https://stackoverflow.com/users/6261724/tchan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 924, "favorite_count": 0, "accepted_answer_id": 43758422, "answer_count": 1, "score": 0, "last_activity_date": 1493811400, "creation_date": 1493809866, "last_edit_date": 1531161705, "question_id": 43758374, "link": "https://stackoverflow.com/questions/43758374/how-to-convert-vlookup-to-index-match", "title": "How to convert Vlookup to Index/match?", "body": "<pre><code>Puzzle 1 | Attempt 1 | 0\n         |           |7.1\n</code></pre>\n\n<p>Suppose I have 3 columns like the above, the blank spaces have nothing in the cell. I want to get the value of 7.1</p>\n\n<p>I've tried </p>\n\n<pre><code>VLOOKUP(\"Puzzle 1\",A:D,1)\n</code></pre>\n\n<p>To get the value \"puzzle 1\" and then trying to enclose that in an <code>OFFSET(VLOOKUPVLAUE, 1,2,11)</code> which does not work.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"comments": [{"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1493809639, "post_id": 43757892, "comment_id": 74557695, "body": "I chose to put the output into a cell, then saved that to a variable. Worked, pity there&#39;s no nicer way to do this."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1493809859, "post_id": 43757892, "comment_id": 74557836, "body": "@Lowpar I understand, we all wish Excel formula language had a way to reference intermediate results within the same formula. Well, it doesn&#39;t, but it&#39;s still an excellent tool :)"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1493809230, "last_edit_date": 1493809230, "creation_date": 1493808507, "answer_id": 43757892, "question_id": 43757778, "link": "https://stackoverflow.com/questions/43757778/set-array-formula-output-to-variable-vba/43757892#43757892", "title": "Set Array formula output to variable vba", "body": "<p>To store intermediate results in formula calculations, you have two options:</p>\n\n<p>1- Add a name in the name manager. i.e</p>\n\n<pre><code>Formulas ---&gt; Name Manager ---&gt; New... \ngive it a name, such as myVariable and write the formula in the RefersTo box\n</code></pre>\n\n<p>This creates the variable, you can then refer to it in any formula, like:</p>\n\n<pre><code>= myVar*10\n</code></pre>\n\n<p>2- dedicate a cell to calculate the formula and refer to the cell.</p>\n\n<p>Option-1 has the advantage of keeping this behind the scenes. Option-2 is more flexible when you want to do the calculation for a whole column, so that the intermediate must be different for each row. In this case, you put your intermediate results in what is called a <em>\"helper column\"</em>.</p>\n"}, {"comments": [{"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1493818911, "post_id": 43761734, "comment_id": 74564750, "body": "nice, I will try this!"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1493818681, "creation_date": 1493818681, "answer_id": 43761734, "question_id": 43757778, "link": "https://stackoverflow.com/questions/43757778/set-array-formula-output-to-variable-vba/43761734#43761734", "title": "Set Array formula output to variable vba", "body": "<p>You can use the <code>Evaluate</code> method to evaluate a formula string and output it to a variable in VBA. For example:</p>\n\n<pre><code>Dim vRow\nvRow = activesheet.evaluate(\"MATCH(J1013&amp;\"\"*\"\"&amp;\"\"55\"\",Workings!K:K&amp;Workings!G:G,0)\")\n</code></pre>\n"}], "owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1479, "favorite_count": 0, "accepted_answer_id": 43761734, "answer_count": 2, "score": 1, "last_activity_date": 1493818681, "creation_date": 1493808166, "last_edit_date": 1531164843, "question_id": 43757778, "link": "https://stackoverflow.com/questions/43757778/set-array-formula-output-to-variable-vba", "title": "Set Array formula output to variable vba", "body": "<p>I have an array formula that identifies the row number based on multiple criteria, however, I would like to set this value as a variable because I would like to use this as the row number for a different formula. </p>\n\n<pre><code>{=MATCH(J1013&amp;\"*\"&amp;\"55\",Workings!K:K&amp;Workings!G:G,0)}\n</code></pre>\n\n<p>Any ideas how to save the output of this formula as a variable ?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1493808121, "post_id": 43757664, "comment_id": 74556718, "body": "What&#39;s the name of your variable , <code>TimeToRun</code> or <code>sTim</code>? Using <code>Option Explicit</code> is highly recommended."}, {"owner": {"reputation": 11, "user_id": 7938357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85720f4e289365261fcb29ccbac4efa2?s=128&d=identicon&r=PG&f=1", "display_name": "Amy", "link": "https://stackoverflow.com/users/7938357/amy"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1493808817, "post_id": 43757664, "comment_id": 74557175, "body": "TimeToRun @A.S.H. I&#39;m gonna have a look on that function, thx!"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1493809561, "post_id": 43757664, "comment_id": 74557641, "body": "Your code may break before reaching the line <code>Application.OnTime...</code>. Or it may be triggered but you&#39;re not observing it because all the if conditions are not met, so its prints nothing out."}, {"owner": {"reputation": 11, "user_id": 7938357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85720f4e289365261fcb29ccbac4efa2?s=128&d=identicon&r=PG&f=1", "display_name": "Amy", "link": "https://stackoverflow.com/users/7938357/amy"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1493810041, "post_id": 43757664, "comment_id": 74557952, "body": "I&#39;ll try to double check it, even if I don&#39;t have vba skills, thx @A.S.H!"}], "owner": {"reputation": 11, "user_id": 7938357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85720f4e289365261fcb29ccbac4efa2?s=128&d=identicon&r=PG&f=1", "display_name": "Amy", "link": "https://stackoverflow.com/users/7938357/amy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494034019, "creation_date": 1493807876, "last_edit_date": 1531164843, "question_id": 43757664, "link": "https://stackoverflow.com/questions/43757664/application-ontime-update", "title": "Application onTime update", "body": "<p>I have an issue on this code, bassicaly its running only one time when it is tiggered, what could be wrong?</p>\n\n<pre><code>Sub test()\nxTim791 = \"11:10:05\"\nIf Minute(Now) &lt; 1 Then\n    TimeToRun = TimeValue(Hour(Now) &amp; \":01:05\")\nEnd If\nDebug.Print TimeToRun\nIf Format(sTim, \"hh:nn:ss\") = Format(xTim791, \"hh:nn:ss\") Then\n    Debug.Print \"I have done for \" + xTim791\nM1_Update\nPrev_Update\nEnd If\nApplication.OnTime Now + TimeSerial(0, 0, 1), \"test\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "formatting"], "comments": [{"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1493808467, "post_id": 43757491, "comment_id": 74556938, "body": "Are you open to loops?"}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "reply_to_user": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1493808591, "post_id": 43757491, "comment_id": 74557012, "body": "Of course I could do it with a loop, but is it really the only way ? I feel like this is a minor issue that I just don&#39;t know how to fix."}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1493809223, "post_id": 43757491, "comment_id": 74557456, "body": "isnt this similar ? <a href=\"http://stackoverflow.com/questions/7106238/changing-the-date-format-to-yyyy-mm-dd\" title=\"changing the date format to yyyy mm dd\">stackoverflow.com/questions/7106238/&hellip;</a>"}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1493809394, "post_id": 43757491, "comment_id": 74557549, "body": "yes kind of, but there they go through each cell and in my case this is what I would (possibly) avoid. Also in my case, before the transformation, all cells have the same exact format so it seems like there is a way to avoid the loop"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1493825041, "post_id": 43757491, "comment_id": 74569672, "body": "If you format your &quot;dates in the correct format&quot; as numbers, to you get actual numeric values or the values remain the same? If the latter (as hinted by the left-alignment of the values) then your dates are not dates, they&#39;re text and Excel isn&#39;t recognizing them as dates because what you deem &quot;the correct format&quot; isn&#39;t what the computer is configured with (from control panel settings). If you want to format dates, you need to work with dates, not <i>strings that look like dates</i>. And then the formatting is done with <code>NumberFormat</code>, not with string replacements."}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1493827273, "post_id": 43757491, "comment_id": 74571211, "body": "@Mat&#39;sMug : Yes it makes sense, I am in the &quot;latter&quot; case. But how come I can do this process manually and it works but when I run the &quot;Recorded Macro&quot; it doesn&#39;t produce the same result ?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1493898483, "post_id": 43757491, "comment_id": 74604250, "body": "Because the macro recorder isn&#39;t flawlessly replicating every single action!"}], "answers": [{"comments": [{"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1493808292, "post_id": 43757768, "comment_id": 74556821, "body": "this is what I am trying right now, see my last edit. I don&#39;t want <code>mm&#47;dd&#47;yyyy</code> though. This is the issue. I want <code>dd&#47;mm&#47;yyyy</code> rather"}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1493808958, "post_id": 43757768, "comment_id": 74557268, "body": "Are you running the code on data you&#39;ve already played with though? Once you ran that <code>Replace</code> routine the cell data itself would be corrupt. Can you reload the base data and run <code>NumberFormat = &quot;dd&#47;mm&#47;yyy&quot;</code> on that?"}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1493809181, "post_id": 43757768, "comment_id": 74557425, "body": "No the second picture is the result of the code applied to the first one. The problem is that on the second picture the data are totally different (before the 13th the format is different than after the 13th)."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1493810061, "post_id": 43757768, "comment_id": 74557972, "body": "I still think you need to check your data are dates. Can you confirm it for me by putting <code>=ISNUMBER(C1)</code> in one of your columns and drag it down. If any result says <code>FALSE</code> then it might be Text. It&#39;s just that left alignment in your first picture that&#39;s making me suspicious."}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1493814935, "post_id": 43757768, "comment_id": 74561514, "body": "It returns <code>False</code> yes.  Which is good right ? If I could keep it formatted as text all the way through the &quot;.&quot; to &quot;/&quot; transformation it would be perfect. But for some reason Excel automatically changes the format when I turn those &quot;.&quot; into &quot;/&quot;."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1493815213, "post_id": 43757768, "comment_id": 74561743, "body": "No, FALSE isn&#39;t so good. It means your base data is <code>Text</code>. So when you&#39;re replacing the <code>.</code> with <code>&#47;</code>, Excel is trying to change the type to a date where it can. It also explains with the <code>NumberFormat</code> won&#39;t work. I think your best bet would be to pose another question, explaining that your original data is <code>Text</code> and that you want to change it to <code>Date</code> and be displayed in the way you want. It&#39;s a simple one to solve - so you&#39;ll get answers quickly."}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1493816815, "post_id": 43757768, "comment_id": 74562967, "body": "I just checked. If I manually do the following : 1) Format the colummn As &quot;Text&quot; 2) Select the whole column 3)CTRL+F &gt; Find &quot;.&quot; replace with &quot;/&quot; it works. And if I record that I get the exact same code I show above...but for some reasons when I run the code it doesn&#39;t produce the sam result. Regarding what you said above, I don&#39;t want to change it as a <code>Date</code> format. <code>Text</code> would be just fine"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1493828116, "post_id": 43757768, "comment_id": 74571757, "body": "Adjusting the number format without tweaking the data won&#39;t do anything, because Excel is seeing the values as strings, not dates."}], "tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": false, "score": -1, "last_activity_date": 1493808149, "creation_date": 1493808149, "answer_id": 43757768, "question_id": 43757491, "link": "https://stackoverflow.com/questions/43757491/forcing-date-format-in-excel/43757768#43757768", "title": "Forcing Date Format in Excel", "body": "<p>There are a variety of ways of dealing with this, and the most obvious would be to adjust your <code>NumberFormat</code> property. Try recording some macros with various formats to see how it could work for you. In your case, the code could be something like:</p>\n\n<pre><code>Sheet1.Columns(\"C:C\").NumberFormat = \"mm/dd/yyyy\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1493809265, "post_id": 43758048, "comment_id": 74557475, "body": "I have about 15000 rows, but if I don&#39;t find a more elegant solution it is definitely a good option yes :)"}, {"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "reply_to_user": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1493810157, "post_id": 43758048, "comment_id": 74558045, "body": "@Seb a pain I know! If it&#39;s more useful I&#39;ve also added a formula you can use as a helper column."}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1493887133, "post_id": 43758048, "comment_id": 74596318, "body": "I tried it and it works great, actually the runtime isn&#39;t long as I thought it  would (main reason why I wanted to avoid a loop)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1493898266, "post_id": 43758048, "comment_id": 74604062, "body": "What you want to avoid is a loop that iterates Cells in a Range - a For Each loop is good for iterating that collection class, but a For loop against an in-memory array will be faster. In general Excel VBA programming you want to work with an in-memory array, not cells. When performance matters anyway."}], "tags": [], "owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "is_accepted": true, "score": 2, "last_activity_date": 1493810054, "last_edit_date": 1493810054, "creation_date": 1493808938, "answer_id": 43758048, "question_id": 43757491, "link": "https://stackoverflow.com/questions/43757491/forcing-date-format-in-excel/43758048#43758048", "title": "Forcing Date Format in Excel", "body": "<p>If you don't mind looping through your data you can do the following:</p>\n\n<pre><code>Sub Test()\n\nDim ws As Worksheet\n\nSet ws = ThisWorkbook.Sheets(\"SheetName\")\n\nFor Each Cell In ws.Range(\"C2:C\" &amp; ws.Cells(ws.Rows.Count, \"C\").End(xlUp).Row)\n    Cell.Value = CDate(Replace(Cell.Value, \".\", \"/\"))\nNext Cell\n\nEnd Sub\n</code></pre>\n\n<p>Or, if you want you can use a helper column and use the following formula:</p>\n\n<pre><code>=TEXT(DATE(MID(C2,SEARCH(\".\",C2,SEARCH(\".\",C2,1)+1)+1,4),MID(C2,SEARCH(\".\",C2,1)+1,2),MID(C2,1,2))+TIMEVALUE(RIGHT(C2,8)),\"dd/mm/yyyy hh:mm:ss\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1493815229, "post_id": 43758403, "comment_id": 74561756, "body": "If I write this before the above code I get the 2nd picture too, so no differences"}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "reply_to_user": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1493815386, "post_id": 43758403, "comment_id": 74561868, "body": "Tested this and got different result. I would guess that it has something to do with local time/date settings"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1493828113, "post_id": 43758403, "comment_id": 74571755, "body": "Adjusting the number format without tweaking the data won&#39;t do anything, because Excel is seeing the values as strings, not dates."}], "tags": [], "owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "is_accepted": false, "score": -1, "last_activity_date": 1493810247, "last_edit_date": 1493810247, "creation_date": 1493809932, "answer_id": 43758403, "question_id": 43757491, "link": "https://stackoverflow.com/questions/43757491/forcing-date-format-in-excel/43758403#43758403", "title": "Forcing Date Format in Excel", "body": "<p>What about something like this</p>\n\n<pre><code>Sub Makro3()\n\nColumns(\"C:C\").Select\n\nSelection.NumberFormat = \"dd\\/mm\\/yyyy hh:mm:ss\"\nEnd Sub\n</code></pre>\n\n<p>Added <code>hh:mm:ss</code></p>\n"}, {"tags": [], "owner": {"reputation": 356, "user_id": 5182777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7826204353d38e61aa39839183a355e4?s=128&d=identicon&r=PG&f=1", "display_name": "Docmarti", "link": "https://stackoverflow.com/users/5182777/docmarti"}, "is_accepted": false, "score": 0, "last_activity_date": 1493821653, "creation_date": 1493821653, "answer_id": 43762905, "question_id": 43757491, "link": "https://stackoverflow.com/questions/43757491/forcing-date-format-in-excel/43762905#43762905", "title": "Forcing Date Format in Excel", "body": "<p>Without having to manually modify regional settings, you must use a loop.</p>\n\n<pre><code>LastRow = Cells(Rows.Count, \"C\").End(xlUp).Row\nSet r = Range(Cells(1, \"C\"), Cells(LastRow, \"C\"))\nt = r.Value\nFor i = 1 To UBound(t)\n t(i, 1) = Replace(t(i, 1), \".\", \"/\")\nNext\nr.NumberFormat = \"\"\nr.FormulaLocal = t\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1493827340, "post_id": 43763572, "comment_id": 74571257, "body": "To clarify the third approach, the problem is that your initial value is a string that cannot be implicitly converted to a date given the odd formatting. The approach above splits apart the string, returns a string that can be implicitly converted, and then converts this string to a date. The output is then a date value that Excel understands."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1493828000, "post_id": 43763572, "comment_id": 74571690, "body": "Upvoted for the UDF part.. which looks very very close to my own solution :)"}], "tags": [], "owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "is_accepted": false, "score": 1, "last_activity_date": 1493827125, "last_edit_date": 1493827125, "creation_date": 1493823376, "answer_id": 43763572, "question_id": 43757491, "link": "https://stackoverflow.com/questions/43757491/forcing-date-format-in-excel/43763572#43763572", "title": "Forcing Date Format in Excel", "body": "<p>This should suffice for what you need. I don't care for the <code>.Range(\"C:C\")</code> here, but this should be fine as long as column C only ever has this data in it. The problem with using .<code>Range(\"C:C\")</code> is that it will always modify and load the entire column which can reduce performance. If I have a chance, ill edit the code to use a more elegant solution, I just wanted to get a working answer up first to get you started.</p>\n\n<p>In any event, here's the code:</p>\n\n<pre><code>Sub FixDateFormatting()\n    Dim ArrayDates() As Variant\n\n    ' Load all the dates into an array for modification\n    ArrayDates = ThisWorkbook.Sheets(1).Range(\"C:C\").Value\n\n    ' Edit the format of the destination to be text based. This will prevent Excel from assuming format\n    ' Note: This must be done after the values are put into the array, otherwise you could load values in the\n    ' wrong format.\n    ThisWorkbook.Sheets(1).Range(\"C:C\").NumberFormat = \"@\"\n\n    Dim i As Long\n    ' Loop through the array and properly format all of the data\n    For i = LBound(ArrayDates, 1) To UBound(ArrayDates, 1)\n        ArrayDates(i, 1) = Format(CStr(Replace(ArrayDates(i, 1), \".\", \"/\")), \"dd/mm/yyyy hh:mm:ss\")\n    Next\n\n    ' Output the modified data\n    ThisWorkbook.Sheets(1).Range(\"C:C\").Value = ArrayDates\nEnd Sub\n</code></pre>\n\n<p>Replace <code>ThisWorkbook.Sheets(1)</code> with an appropriate reference to the sheet you are modifying. You don't have to if the target sheet is the first sheet within the workbook running the code.</p>\n\n<p>This should be much better than a loop. The only downside to this approach is that in order to retrieve the values from these cells and perform operations on them (using the dd-mm-yyyy format) is that you have to retrieve and manipulate these values in another array. If you try using excel formulas on these values you will not get the expected results. This is unavoidable (at least to my knowledge) when you are using a non-standard date format.</p>\n\n<p>Let me know if you have any questions.</p>\n\n<p>Take care,</p>\n\n<p>Brandon</p>\n\n<p>EDIT: </p>\n\n<p>Here's a slightly more elegant solution that should have a slight performance increase. I made it (hopefully) easier to set the correct target worksheet. I also have resized the range to only include the necessary number of rows. See below:</p>\n\n<pre><code>Sub FixDateFormatting()\n    Dim TargetSheet As Worksheet\n    ' Set the correct target sheet here:\n    Set TargetSheet = ThisWorkbook.Sheets(1)\n\n    Dim LastColRow As Long\n    ' Store the absolute last row within a long variable for later use\n    LastColRow = TargetSheet.Range(\"C1048576\").End(xlUp).Row\n\n    Dim TargetRange As Range\n    ' Assumes your data starts in cell 2 (has a header row). Change the 2 as needed.\n    Set TargetRange = TargetSheet.Range(\"C2:C\" &amp; LastColRow)\n\n    Dim ArrayDates() As Variant\n\n    ' Load all the dates into an array for modification\n    ArrayDates = TargetRange.Value\n\n    ' Edit the format of the destination to be text based. This will prevent Excel from assuming format\n    ' Note: This must be done after the values are put into the array, otherwise you could load values in the\n    ' wrong format.\n    TargetRange.NumberFormat = \"@\"\n\n    Dim i As Long\n    ' Loop through the array and properly format all of the data\n    For i = LBound(ArrayDates, 1) To UBound(ArrayDates, 1)\n        ArrayDates(i, 1) = Format(CStr(Replace(ArrayDates(i, 1), \".\", \"/\")), \"dd/mm/yyyy hh:mm:ss\")\n    Next\n\n    ' Output the modified data\n    TargetRange.Value = ArrayDates\nEnd Sub\n</code></pre>\n\n<p>EDIT (Again):</p>\n\n<p>This last solution is far more elegant and preserves the \"DATE\" format. You can then edit the cell as needed. This uses a UDF (user defined function). You can just type the function with the date to be fixed as the target. It will output a date that you can then modify to the formatting you need:</p>\n\n<pre><code>Public Function FixDateFormat(InputDate As String) As Date\n    ' This will ensure that the string being input is appropriate for this function\n    ' Modify the pattern as needed.\n\n    If InputDate Like \"##.##.#### ##:##:##\" Then\n        Dim DateTime As Variant\n        DateTime = Split(InputDate, \" \")\n\n        Dim DateInfo As Variant\n        DateInfo = Split(DateTime(0), \".\")\n\n        Dim HolderString As String\n        HolderString = Format(DateInfo(1), \"00\") &amp; \"/\" &amp; Format(DateInfo(0), \"00\") &amp; \"/\" &amp; Format(DateInfo(2), \"0000\") &amp; \" \" &amp; DateTime(1)\n\n        Debug.Print HolderString\n\n        Dim OutputDate As Date\n        OutputDate = CDate(HolderString)\n\n        FixDateFormat = OutputDate\n    Else\n        ' Comment out this line to return a \"#VALUE\" error instead\n        FixDateFormat = vbNullDate\n        Exit Function\n    End If\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1493901383, "post_id": 43765103, "comment_id": 74606357, "body": "I tried this but it doesn&#39;t work ( I mean the format issue is still there). I guess it&#39;s due to the last lines. What I did is created a new column, formatted it to <code>dd&#47;mm&#47;yyyy hh:mm:ss</code> and pasted the result"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 1, "creation_date": 1493901632, "post_id": 43765103, "comment_id": 74606548, "body": "Yeah, doesn&#39;t work, I made that screenshot in PhotoShop."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1493827634, "creation_date": 1493827634, "answer_id": 43765103, "question_id": 43757491, "link": "https://stackoverflow.com/questions/43757491/forcing-date-format-in-excel/43765103#43765103", "title": "Forcing Date Format in Excel", "body": "<p>This code takes <code>C2:C25</code> in <code>Sheet1</code>, converts it to an in-memory array, traverses that array and converts all values to <em>actual dates</em>, and then dumps the converted values to <code>D2:D25</code> on <code>Sheet1</code>, applies the desired <code>NumberFormat</code> in column D, and then resizes the column to fit.</p>\n\n<p><img src=\"https://i.stack.imgur.com/1AEj4.png\" alt=\"output result\"></p>\n\n<p>The result is dates properly treated as dates, custom-formatted:</p>\n\n<pre><code>Public Sub ConvertToDate()\n\n    Dim target As Variant\n    target = ToArray(Sheet1.Range(\"C2:C25\")) 'todo: adjust to desired range\n\n    Dim i As Long\n    For i = LBound(target) To UBound(target)\n        target(i) = ToDate(target(i))\n    Next\n\n    'here you'd probably dump the result in C2:\n    Sheet1.Range(\"D:D\").NumberFormat = \"dd.MM.yyyy hh:mm:ss\"\n    Sheet1.Range(\"D2\").Resize(UBound(target), 1).value = Application.WorksheetFunction.Transpose(target)\n    Sheet1.Range(\"D:D\").EntireColumn.AutoFit\n\nEnd Sub\n\nPrivate Function ToDate(ByVal value As String) As Date\n\n    ' make sure our assumptions are correct before going any further:\n    Debug.Assert value Like \"##.##.#### ##:##:##\"\n\n    Dim datetimeParts As Variant\n    datetimeParts = Strings.Split(value, \" \")\n\n    Dim dateParts As Variant\n    dateParts = Strings.Split(datetimeParts(0), \".\")\n\n    Dim datePart As Date\n    datePart = DateTime.DateSerial(dateParts(2), dateParts(1), dateParts(0))\n\n    Dim result As Date\n    result = CDate((CStr(datePart) &amp; \" \" &amp; datetimeParts(1)))\n\n    ToDate = result\n\nEnd Function\n</code></pre>\n\n<p>The <code>ToArray</code> helper function is this one (adapted from <a href=\"https://codereview.stackexchange.com/q/161779/23788\">this post</a>):</p>\n\n<pre><code>Private Function ToArray(ByVal target As Range) As Variant\n    Select Case True\n        Case target.Rows.Count = 1\n            'horizontal 1D range\n            ToArray = Application.WorksheetFunction.Transpose(Application.WorksheetFunction.Transpose(target.value))\n        Case target.Columns.Count = 1\n            'vertical 1D range\n            ToArray = Application.WorksheetFunction.Transpose(target.value)\n        Case Else\n            '2D array: let Excel to the conversion itself\n            ToArray = target.value\n    End Select\nEnd Function\n</code></pre>\n\n<p>You should be able to easily adapt this code to work with your worksheet and data.</p>\n"}], "owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2156, "favorite_count": 0, "accepted_answer_id": 43758048, "answer_count": 6, "score": 1, "last_activity_date": 1493827634, "creation_date": 1493807333, "last_edit_date": 1493825174, "question_id": 43757491, "link": "https://stackoverflow.com/questions/43757491/forcing-date-format-in-excel", "title": "Forcing Date Format in Excel", "body": "<p>I have a column containing dates in the right format:</p>\n\n<h2><a href=\"https://i.stack.imgur.com/EYgOb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EYgOb.png\" alt=\"dd.MM.yyyy hh:mm:ss\"></a></h2>\n\n<p>I am trying to first change the \".\" to \"/\" which works fine which the following code, but it automatically modifies the date format and recognizes the day as month if it's under 12.</p>\n\n<p><a href=\"https://i.stack.imgur.com/0TLWy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0TLWy.png\" alt=\"dd/MM/yyyy hh:mm:ss\"></a></p>\n\n<pre><code>'2) Replace \".\" by \"/\"\n    'Range(\"C:C\").NumberFormat = \"@\" ' I tried with AND without this line...no difference\n    'Range(\"C:C\").NumberFormat = \"dd.mm.yyyy hh:mm:ss\" ' if I add this then only \".\" starting from 13th of January are reaplced by \"/\"\n    'Range(\"C:C\").NumberFormat = \"dd/mm/yyyy hh:mm:ss\" ' no differences at all neither\n    Columns(\"C:C\").Select\n    Selection.Replace What:=\".\", Replacement:=\"/\", LookAt:=xlPart, _\n        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n        ReplaceFormat:=False\n</code></pre>\n\n<p>So annoying...any ideas how to fix this ?</p>\n"}, {"tags": ["vba", "excel", "sorting", "pivot-table"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1493807911, "post_id": 43757336, "comment_id": 74556579, "body": "You want to have the Pivot Table sorted according to the 3rd column ? what is the 3rd column <code>PivotFields.Name</code> ? is it <code>&quot;Channel&quot;</code>? you want to sort them by <code>&quot;Channel&quot;</code> values ?"}, {"owner": {"reputation": 9777, "user_id": 2342399, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/da7b3bf63455228a889008a1cd76109a?s=128&d=identicon&r=PG", "display_name": "Boosted_d16", "link": "https://stackoverflow.com/users/2342399/boosted-d16"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1493808271, "post_id": 43757336, "comment_id": 74556809, "body": "The 3rd column contains contains data for the latest month. &quot;Period&quot; = &quot;4&quot; which is April. See image."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1493808633, "post_id": 43757336, "comment_id": 74557055, "body": "OK, so you want to sort <code>&quot;Sum of Shares&quot;</code> in Descending order, according <code>&quot;Period&quot; = &quot;4&quot;</code>  ? the output should be <code>7.11 , 1.18, 0.77, 0.32, 0.02</code> ?"}, {"owner": {"reputation": 9777, "user_id": 2342399, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/da7b3bf63455228a889008a1cd76109a?s=128&d=identicon&r=PG", "display_name": "Boosted_d16", "link": "https://stackoverflow.com/users/2342399/boosted-d16"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1493808897, "post_id": 43757336, "comment_id": 74557231, "body": "Correct! The data for &quot;Period&quot; = &quot;4&quot; is in column 3."}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1493809926, "creation_date": 1493809926, "answer_id": 43758396, "question_id": 43757336, "link": "https://stackoverflow.com/questions/43757336/excel-vba-sort-pivot-table-if-filter-is-changed/43758396#43758396", "title": "excel vba - sort pivot table if filter is changed", "body": "<p>Try the code below, it will <code>Sort</code> the Values according to <code>PivotFields(\"Period\")</code> where <code>.PivotItems(\"3\")</code> (you can easily modify it later to fit your needs).</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub example()\n\nDim PivTbl          As PivotTable\nDim PivFld          As PivotField\nDim RngKey1         As Range\n\n' set the Pivot Table to an object\nSet PivTbl = ActiveSheet.PivotTables(\"PivotTable2\")\n\n'change period filter from \"3\" to \"4\"\nWith PivTbl\n    With .PivotFields(\"Period\")\n        .PivotItems(\"3\").Visible = True\n        .PivotItems(\"4\").Visible = False\n    End With\n\n    ' set \"Period\" to a PivotField Object\n    Set PivFld = .PivotFields(\"Period\")\n\n    ' set the SortRange to PivotItem \"3\" of PivotField \"Period\"\n    Set RngKey1 = PivFld.PivotItems(\"3\").DataRange\n\n    ' sort the Pivot Table's values in escending order, according to PivotItem \"3\" column\n    PivFld.PivotItems(\"3\").DataRange.Sort key1:=RngKey1, Order1:=xlDescending, Type:=xlSortValues, Orientation:=xlTopToBottom\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9777, "user_id": 2342399, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/da7b3bf63455228a889008a1cd76109a?s=128&d=identicon&r=PG", "display_name": "Boosted_d16", "link": "https://stackoverflow.com/users/2342399/boosted-d16"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1160, "favorite_count": 0, "accepted_answer_id": 43758396, "answer_count": 1, "score": 2, "last_activity_date": 1493809926, "creation_date": 1493806881, "last_edit_date": 1493808155, "question_id": 43757336, "link": "https://stackoverflow.com/questions/43757336/excel-vba-sort-pivot-table-if-filter-is-changed", "title": "excel vba - sort pivot table if filter is changed", "body": "<p>Is there a way to automatically sort a pivot table each time a given filter of the pivot table is changed?</p>\n\n<p>I would like to sort a pivot table by the values in descending order in the 3rd column. The filter for this table is updated each month. As such I dont want to manually sort it each time. </p>\n\n<p>Here is the vba code when I do it manually.</p>\n\n<pre><code>Sub example()\n'\n' example Macro\n'\n    Range(\"BO12\").Select\n    'change period filter from \"3\" to \"4\"\n    With ActiveSheet.PivotTables(\"PivotTable2\").PivotFields(\"Period\")\n        .PivotItems(\"3\").Visible = True\n        .PivotItems(\"4\").Visible = False\n    End With\n    'sort the table in descending order by the values in the 3rd column\n    ActiveSheet.PivotTables(\"PivotTable2\").PivotFields(\"Channel\").AutoSort _\n        xlDescending, \"Sum of Shares\", ActiveSheet.PivotTables(\"PivotTable2\"). _\n        PivotColumnAxis.PivotLines(3), 1\nEnd Sub\n</code></pre>\n\n<p>Is there a way to automate this?</p>\n\n<p>Image of the table in question:</p>\n\n<p><a href=\"https://i.stack.imgur.com/OlVrg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OlVrg.png\" alt=\"enter image description here\"></a></p>\n\n<p>What I tried to no avail. </p>\n\n<pre><code>Private Sub SortTables(ByVal Target As Range)\n'\n' SortTables Macro\n'\n'\n    Range(\"D12\").Select\n    If Target.Name = \"PivotTable3\" Then\n    ActiveSheet.PivotTables(\"PivotTable3\").PivotFields(\"Channel\").AutoSort _\n        xlDescending, \"Sum of Shares\", ActiveSheet.PivotTables(\"PivotTable3\"). _\n        PivotColumnAxis.PivotLines(3), 1\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vb.net", "excel", "vba"], "comments": [{"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 0, "creation_date": 1493809129, "post_id": 43757234, "comment_id": 74557389, "body": "Perhaps the source of the pivot table is no longer valid. Have you tried to manually click the refresh button when the relevant pivot table is selected?"}], "answers": [{"tags": [], "owner": {"reputation": 13325, "user_id": 2641576, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/K9yqy.png?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/2641576/matt"}, "is_accepted": true, "score": 0, "last_activity_date": 1493813528, "creation_date": 1493813528, "answer_id": 43759714, "question_id": 43757234, "link": "https://stackoverflow.com/questions/43757234/excel-reference-isnt-valid-for-pivottables-refreshtable/43759714#43759714", "title": "Excel Reference isn&#39;t valid for PivotTables RefreshTable", "body": "<p>The issue was a pivot table referencing an ODBC data dump which had changed its external table name.</p>\n\n<p>Updated the name and it worked again.</p>\n"}], "owner": {"reputation": 13325, "user_id": 2641576, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/K9yqy.png?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/2641576/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 595, "favorite_count": 0, "accepted_answer_id": 43759714, "answer_count": 1, "score": 2, "last_activity_date": 1493813528, "creation_date": 1493806613, "last_edit_date": 1592644375, "question_id": 43757234, "link": "https://stackoverflow.com/questions/43757234/excel-reference-isnt-valid-for-pivottables-refreshtable", "title": "Excel Reference isn&#39;t valid for PivotTables RefreshTable", "body": "<p>I have a button that uses simple VBA to refresh pivot tables.</p>\n<p>When I click it I am getting:</p>\n<blockquote>\n<p>Run-time error '1004':</p>\n<p>Reference isn't valid.</p>\n</blockquote>\n<p>When I select <code>Debug</code> the following is highlighted:</p>\n<blockquote>\n<p>pt.RefreshTable</p>\n</blockquote>\n<p>Full code:</p>\n<pre><code>Sub Refresh_pivot()\n\n    Sheets(&quot;Control&quot;).Select\n   \n    Application.ScreenUpdating = False\n    Dim pt As PivotTable\n    Dim ws As Worksheet\n\n    For Each ws In ActiveWorkbook.Worksheets\n    \n        For Each pt In ws.PivotTables\n            pt.RefreshTable\n        Next pt\n        \n    Next ws\n    \n       \n    Application.ScreenUpdating = True\n    Application.Goto Reference:=&quot;returncell&quot;\n    Range(&quot;A15&quot;).Select\n    \nEnd Sub\n</code></pre>\n<p>Can anyone help explain the problem I have encountered?</p>\n"}, {"tags": ["excel", "qtp", "hp-uft", "vba"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1493805930, "post_id": 43756808, "comment_id": 74555185, "body": "Look into the code for where the name of the sheet is displayed. That&#39;s where the wrong name is given to the correct sheet. Change the displayed name directly in the code."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1493806244, "post_id": 43756808, "comment_id": 74555430, "body": "Please show us your VBA code."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1493812691, "post_id": 43756808, "comment_id": 74559868, "body": "<code>Sheets(&quot;MasterCard&quot;).Activate</code>"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1493898699, "post_id": 43756808, "comment_id": 74604421, "body": "Are you using UFT to open Excel and try to read the data directly from an open Excel instance or are you loading the file as a UFT <code>Datatable</code> object?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1493898921, "post_id": 43756808, "comment_id": 74604569, "body": "@Dave Ah, the <code>excel-vba</code> tag was misleading me"}], "owner": {"reputation": 189, "user_id": 3909220, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/a7dd050a9ff35fd9771340452570a655?s=128&d=identicon&r=PG&f=1", "display_name": "onkar", "link": "https://stackoverflow.com/users/3909220/onkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1493888178, "creation_date": 1493805449, "last_edit_date": 1531161705, "question_id": 43756808, "link": "https://stackoverflow.com/questions/43756808/how-to-make-a-2nd-tab-of-xl-file-visible", "title": "How to make a 2nd tab of XL file visible?", "body": "<p>There are 2 tabs in my XL (VISA and MasterCard). I am able to read the data from  VISA and MasterCard tab. When my script read the data from 'MasterCard' tab [Which is a 2nd tab of my XL] it shows me 'VISA' tab [ It reads the data from 'MasterCard' correctly]. \nWhen script will read the data 'MasterCard' tab it should show 'MasterCard' tab NOT 'Visa' tab. I need this because I want a screen shot of both tab separately. \nNOTE: I am using UFT for reading XL file    </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493805665, "post_id": 43756765, "comment_id": 74555007, "body": "It should be because there might be something else in Cell B2. What is in B2? Also share one of your subs that&#39;s been called. It is unlikely to figure out what the problem is with the provided information so far."}, {"owner": {"reputation": 29, "user_id": 7924462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91614d375c1b792af74be06a582d6b24?s=128&d=identicon&r=PG&f=1", "display_name": "nikhil pola", "link": "https://stackoverflow.com/users/7924462/nikhil-pola"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493805942, "post_id": 43756765, "comment_id": 74555192, "body": "B2 is a dropdown which contains &quot;Greater Than&quot;, &quot;Less Than &quot; and &quot;Equals&quot;"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1493806646, "post_id": 43756765, "comment_id": 74555721, "body": "Could you make it a little slicker and have on function with arguments, so <code>call_rus(enmAction as enmGreaterThanLessThanEnum)</code> using enumerations for the &gt;,&lt; and =.  Google <code>Enumerations</code> and <code>function arguments</code>.  Or you could skip enums and just use a string, so <code>call_rus(worksheets(&quot;sheet&quot;).range(&quot;b2&quot;).value)</code>  Then your logic will be in the function."}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1493807173, "post_id": 43756765, "comment_id": 74556066, "body": "@Peh, people also assumed the problem is &quot;not fully qualifying ranges&quot; while avoiding this assumption ^^"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493810955, "post_id": 43756765, "comment_id": 74558579, "body": "@Tehscript sorry, I didn&#39;t get it. What did you try to tell me with your comment?"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1493811480, "post_id": 43756765, "comment_id": 74558972, "body": "@Peh, sorry my bad, it is not my main language. When you commented not to assume the worksheet for ranges, everyone assumed that this is the problem, and too many answers, comments, upvotes (including me) popped in 5 mins. However OP did not comment that this is true. Maybe the called sub is the problematic part here. So while trying to advise not to assume anything, we assumed all of these ^^"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493812353, "post_id": 43756765, "comment_id": 74559622, "body": "@Tehscript The problem here is everyone assumes something because the OP didn&#39;t ask a good question and provided insufficient information to give an <i>exact</i> answer. Therefore I threw this comment in because he should qualify his ranges anyway, even if this appears not to be the main issue here. You must start excluding some issues if there is more than one possible issue and this code <i>obviously has</i> more than one possible issue."}], "answers": [{"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 3, "last_activity_date": 1493806642, "creation_date": 1493806642, "answer_id": 43757246, "question_id": 43756765, "link": "https://stackoverflow.com/questions/43756765/calling-a-sub-based-on-a-cell-value/43757246#43757246", "title": "Calling a sub based on a cell value", "body": "<p>The capitalisation in the dropdown is probably different from what you have in your code. It is also possible that there is a space somewhere in the dropdown where there should be none, or that the sheet on which your Range(\"B2\") is specified isn't the active sheet at the time of calling the sub. All of these possibilities are eliminated in the code below.</p>\n\n<pre><code>Sub rush_hour()\n\n    Select Case Trim(LCase(ActiveSheet.Range(\"B2\").value))\n        Case \"greater than\"\n            call_rus_greater\n        Case \"less than\"\n            call_rus_less\n        Case \"equals\"\n            call_rus_equals\n        Case Else\n            MsgBox \"Unexpected value in cell B2\"\n    End Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 7924462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91614d375c1b792af74be06a582d6b24?s=128&d=identicon&r=PG&f=1", "display_name": "nikhil pola", "link": "https://stackoverflow.com/users/7924462/nikhil-pola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1493806642, "creation_date": 1493805320, "last_edit_date": 1531164843, "question_id": 43756765, "link": "https://stackoverflow.com/questions/43756765/calling-a-sub-based-on-a-cell-value", "title": "Calling a sub based on a cell value", "body": "<p>I have three different Subs available in a VBA and want to call those Subs from an unique Sub using button.\nEither of the sub should be called based on the condition, but no sub is getting called!</p>\n\n<pre><code>Sub rush_hour()\n    If Range(\"B2\").Value = \"Greater Than\" Then\n        Call call_rus_greater\n    ElseIf Range(\"B2\").Value = \"Less Than\" Then\n        Call call_rus_less\n    ElseIf Range(\"B2\").Value = \"Equals\" Then\n        Call call_rus_equals\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1493801826, "post_id": 43755101, "comment_id": 74552213, "body": "<code>Sheets(4)</code> and <code>Sheets(2)</code> of the opened workbook <code>sourceWB</code> ? If the answer is yes, then you need to qualify them by <code>sourceWB.Sheets(4)</code> , or adding a <code>With sourceWB</code> statement in the begining, anf after use <code>.Sheets(4)</code> and <code>.Sheets(2)</code>"}, {"owner": {"reputation": 82, "user_id": 7956263, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-24-YmgbXkrM/AAAAAAAAAAI/AAAAAAAAATI/tje35LpDlIY/photo.jpg?sz=128", "display_name": "BoTz", "link": "https://stackoverflow.com/users/7956263/botz"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1493802615, "post_id": 43755101, "comment_id": 74552798, "body": "You are correct.  I added the qualifiers but still get :errot 91, object variable not set."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1493802662, "post_id": 43755101, "comment_id": 74552830, "body": "When you run it in debug mode, at which line?"}, {"owner": {"reputation": 82, "user_id": 7956263, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-24-YmgbXkrM/AAAAAAAAAAI/AAAAAAAAATI/tje35LpDlIY/photo.jpg?sz=128", "display_name": "BoTz", "link": "https://stackoverflow.com/users/7956263/botz"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1493802947, "post_id": 43755101, "comment_id": 74553027, "body": "Pathname = ActiveWorkbook.Path &amp; &quot;\\Files\\&quot;  (I also edited the original question to reflect the edits you suggested)"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1493804738, "post_id": 43755101, "comment_id": 74554382, "body": "You need to Set the object variables: <code>Set targetWB = ActiveWorkbook</code>. With object variables, you are only setting a pointer, not actually passing the whole value into the memory."}, {"owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "edited": false, "score": 1, "creation_date": 1493806504, "post_id": 43755101, "comment_id": 74555620, "body": "<b>i.</b> Does <code>Debug.Print ActiveWorkbook.Path</code> return the path you expect? If you run your code from the VBA Editor, chances are that there is still workbook active in your Excel GUI. Maybe u want to use <code>ThisWorkbook.Path</code> instead <b>ii.</b> Also, doesn&#39;t <code>sourceWB.Sheets(9).Move Before:=Workbooks(targetWB).Sheets(1)</code> cause a #13 type-mismatch error? You might be able to just go with <code>... Before:=targetWB.Sheets(1)</code>, since <code>targetWB</code> is already a <code>Workbook</code>-object"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1493807308, "post_id": 43755101, "comment_id": 74556150, "body": "Not sure from where to where you want to copy. One time you have <code>sourceWB.Sheets(2).Range(&quot;A14:FM663&quot;).Copy Destination:=sourceWB.Sheets(9).Range(&quot;C2&quot;)</code> (copying from <code>sourceWB</code> to <code>sourceWB</code>). The second you have <code>targetWB.Sheets(1).Range(&quot;A2:FO651&quot;).Copy Destination:=sourceWB.Sheets(2).Rows(&quot;3:&quot; &amp; Worksheets(&quot;Sheet2&quot;).UsedRange.Rows.Count)</code> copying from <code>targetWB</code> to <code>sourceWB</code>. Is it my logic that you would want to copy from <code>sourceWB</code> to <code>targetWB</code> ?"}, {"owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1493809575, "post_id": 43755101, "comment_id": 74557650, "body": "@ShaiRado but looking at the code it&#39;s obvious the op adds information in step 1 and then copies it to his <code>TargetWB</code> in step 2."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "edited": false, "score": 0, "creation_date": 1493809898, "post_id": 43755101, "comment_id": 74557865, "body": "@MartinDreher when I&#39;m looking at his code I&#39;m confused, I&#39;ll let you take this one :)"}, {"owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1493810450, "post_id": 43755101, "comment_id": 74558240, "body": "@ShaiRado yes, I can relate. ;) Using VBA for what is essentially a database operation gets confusing faster than you&#39;d like"}, {"owner": {"reputation": 82, "user_id": 7956263, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-24-YmgbXkrM/AAAAAAAAAAI/AAAAAAAAATI/tje35LpDlIY/photo.jpg?sz=128", "display_name": "BoTz", "link": "https://stackoverflow.com/users/7956263/botz"}, "edited": false, "score": 0, "creation_date": 1493812215, "post_id": 43755101, "comment_id": 74559524, "body": "thanks everyone for the helpful comments!"}, {"owner": {"reputation": 82, "user_id": 7956263, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-24-YmgbXkrM/AAAAAAAAAAI/AAAAAAAAATI/tje35LpDlIY/photo.jpg?sz=128", "display_name": "BoTz", "link": "https://stackoverflow.com/users/7956263/botz"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1493812222, "post_id": 43755101, "comment_id": 74559528, "body": "@Vacip, Your comment helped me overcome the &quot;object variable not set&quot;."}, {"owner": {"reputation": 82, "user_id": 7956263, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-24-YmgbXkrM/AAAAAAAAAAI/AAAAAAAAATI/tje35LpDlIY/photo.jpg?sz=128", "display_name": "BoTz", "link": "https://stackoverflow.com/users/7956263/botz"}, "reply_to_user": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "edited": false, "score": 0, "creation_date": 1493812262, "post_id": 43755101, "comment_id": 74559558, "body": "@MartinDreher, ThisWorkbook is much better in this context. Didn&#39;t get type msimatch errors. did get subscript out of range error on:  <code>sourceWB.Sheets(9).Range(&quot;B2:B663&quot;).Value = Worksheets(4).Range(&quot;C13&quot;).Value</code> because C13 is part of several merged cells"}, {"owner": {"reputation": 82, "user_id": 7956263, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-24-YmgbXkrM/AAAAAAAAAAI/AAAAAAAAATI/tje35LpDlIY/photo.jpg?sz=128", "display_name": "BoTz", "link": "https://stackoverflow.com/users/7956263/botz"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1493812275, "post_id": 43755101, "comment_id": 74559566, "body": "@ShaiRado, Yes, I got one refrence wrong, but let me exlain the logic: First, I copy the range in need to another shhet inside the same workbook, and copy some source refernce from the same workbook. Second, I move the whole worksheet into the target workbook, and close the source workbook. Last I copy the range I need from the copied worksheet and paste it at the end of the target data worksheet. It&#39;s not very elegant, I know. I still need to correct the last lines."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1493812404, "post_id": 43755101, "comment_id": 74559648, "body": "@BoazTzur do you need the copying of the sheets ? or you just started implementing it this way ? You could just copy the needed range from <code>sourceWB</code> directly to <code>targetWB</code> to the next empty row"}, {"owner": {"reputation": 82, "user_id": 7956263, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-24-YmgbXkrM/AAAAAAAAAAI/AAAAAAAAATI/tje35LpDlIY/photo.jpg?sz=128", "display_name": "BoTz", "link": "https://stackoverflow.com/users/7956263/botz"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1493813504, "post_id": 43755101, "comment_id": 74560458, "body": "@ShaiRado, No, I intend to delete the sheets eventually.  It was just easier for me - because I want to add two columns with data about the source file."}], "answers": [{"comments": [{"owner": {"reputation": 82, "user_id": 7956263, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-24-YmgbXkrM/AAAAAAAAAAI/AAAAAAAAATI/tje35LpDlIY/photo.jpg?sz=128", "display_name": "BoTz", "link": "https://stackoverflow.com/users/7956263/botz"}, "edited": false, "score": 0, "creation_date": 1493818822, "post_id": 43760693, "comment_id": 74564673, "body": "Thank you @MartinDreher ! This looks very helpful. I will see how I can apply this to my exact needs.    Regaring the merged cells - I am aware that this complicates things, but the source files were not written by me. (The cells coaintain the name of the data source, which is not found in the filename)"}, {"owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "reply_to_user": {"reputation": 82, "user_id": 7956263, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-24-YmgbXkrM/AAAAAAAAAAI/AAAAAAAAATI/tje35LpDlIY/photo.jpg?sz=128", "display_name": "BoTz", "link": "https://stackoverflow.com/users/7956263/botz"}, "edited": false, "score": 0, "creation_date": 1493819531, "post_id": 43760693, "comment_id": 74565279, "body": "Ok. You can retrieve the <code>.Value</code> of a merged cell with SQL. Add a screenshot of the <code>Worksheets(4).Range(&quot;C13&quot;).Value</code> with the surrounding cells"}, {"owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "reply_to_user": {"reputation": 82, "user_id": 7956263, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-24-YmgbXkrM/AAAAAAAAAAI/AAAAAAAAATI/tje35LpDlIY/photo.jpg?sz=128", "display_name": "BoTz", "link": "https://stackoverflow.com/users/7956263/botz"}, "edited": false, "score": 0, "creation_date": 1493820316, "post_id": 43760693, "comment_id": 74565916, "body": "k. You can retrieve the .Value of a merged cell with SQL. Add a screenshot of the <code>Worksheets(4).Range(&quot;C13&quot;).Value</code> with the surrounding cells, so we can determine the SQL needed. In my example, <code>strSQL = &quot;SELECT &#39;&quot; &amp; myfile.Name &amp; &quot;&#39; AS WorkbookName, * FROM [Tabelle1$A1:C5], (SELECT TOP 1 * FROM [Tabelle2$C12:C13])&quot;</code> works like a charm and retrieves what you want. My example took about 20sec for 300 files"}, {"owner": {"reputation": 82, "user_id": 7956263, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-24-YmgbXkrM/AAAAAAAAAAI/AAAAAAAAATI/tje35LpDlIY/photo.jpg?sz=128", "display_name": "BoTz", "link": "https://stackoverflow.com/users/7956263/botz"}, "edited": false, "score": 0, "creation_date": 1494165453, "post_id": 43760693, "comment_id": 74701469, "body": "Thanks! Here is a screenshot of the cell and immediate area <a href=\"http://imgur.com/YvC3oLa\" rel=\"nofollow noreferrer\">imgur.com/YvC3oLa</a>.  also, how do I add a password unprotection to the connection string?"}, {"owner": {"reputation": 82, "user_id": 7956263, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-24-YmgbXkrM/AAAAAAAAAAI/AAAAAAAAATI/tje35LpDlIY/photo.jpg?sz=128", "display_name": "BoTz", "link": "https://stackoverflow.com/users/7956263/botz"}, "edited": false, "score": 0, "creation_date": 1494356013, "post_id": 43760693, "comment_id": 74790362, "body": "Thanks again for your help!"}], "tags": [], "owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "is_accepted": true, "score": 1, "last_activity_date": 1494406875, "last_edit_date": 1494406875, "creation_date": 1493816148, "answer_id": 43760693, "question_id": 43755101, "link": "https://stackoverflow.com/questions/43755101/vba-copy-specific-range-from-multiple-workbooks-into-one-worksheet/43760693#43760693", "title": "VBA: Copy specific range from multiple workbooks into one worksheet", "body": "<p>Just to give you an idea of how tasks like this can be handled way more efficient... consider the following that I always use for tasks like this:</p>\n\n<pre><code>Option Explicit\n\n' 1. Add reference to Microsoft Scripting Runtime and Access Data Objects Library via Extras&gt;References\nSub ProcessFiles()\n\n\n\n    Dim strCon As String\n    Dim strSQL As String\n\n    Dim fso As New Scripting.FileSystemObject\n    Dim myfile As file\n\n    With ThisWorkbook\n\n        ' 2. empty your outputsheet\n        .Sheets(\"out\").Cells.Clear\n\n        ' 3. loop the files in your folder\n        For Each myfile In fso.GetFolder(.Path &amp; Application.PathSeparator &amp; \"Files\").Files\n\n            ' 3.1. no proper way to filter files like in Dir(), but we want to use the file objects\n            If myfile.Name Like \"*.xls\" Then\n\n                ' 3.1.1. Construct the connection string, the only variable part is myfile.Path\n                strCon = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; myfile.Path &amp; \";Extended Properties='Excel 8.0;HDR=YES';\"\n                ' 3.1.2. Construct the SQL String. Luckily, you already know where your data is\n                strSQL = \"SELECT '\" &amp; myfile.Name &amp; \"' AS WorkbookName, * FROM [sheetData$A1:C5], (SELECT TOP 1 * FROM [sheetSchool$C12:C13])\"\n\n                ' 3.1.3. Call the get-data sub from below\n                GetData .Sheets(\"out\"), strCon, strSQL\n\n            End If\n\n        Next myfile\n\n    End With\n\nEnd Sub\n\nSub GetData(ByRef wsOut As Variant, strCon As String, strSQL As String)\n\n    Dim i As Integer\n\n    On Error GoTo skpError\n    Application.ScreenUpdating = False\n\n    ' Create a new database connection\n    Dim objCon As New ADODB.Connection\n    With objCon\n        .ConnectionString = strCon\n        .Open\n    End With\n\n    ' Create a new database command\n    Dim objCmd As New ADODB.Command\n    With objCmd\n        .ActiveConnection = objCon\n        .CommandType = adCmdText\n        .CommandText = strSQL\n        Debug.Print .CommandText\n    End With\n\n    ' Create a new recordset\n    Dim objRS\n    Set objRS = New ADODB.Recordset\n    With objRS\n        .ActiveConnection = objCon\n        .Open objCmd\n    End With\n\n    ' Print your FieldNames, in case they're not already there\n    With wsOut\n        If wsOut.Cells(1, 1).Value = vbNullString Then\n            For i = 1 To objRS.Fields.Count\n                .Cells(1, i).Value = _\n                    objRS.Fields(i - 1).Name\n            Next i\n        End If\n\n        ' Output your data - pretty ugly, but reliable\n        .Range(\"A1048576\").End(xlUp).Offset(1, 0).CopyFromRecordset (objRS)\n\n    End With\n\nskpNoError:\n    Application.ScreenUpdating = True\n    Exit Sub\n\nskpError:\n    MsgBox \"Error #\" &amp; Err &amp; vbNewLine &amp; Error, vbCritical\n    GoTo skpNoError\nEnd Sub\n</code></pre>\n\n<p><strong>Notes: (why use something like this?)</strong></p>\n\n<ul>\n<li>protected and hidden worksheets shouldn't be a problem with this. For protected workbooks, a password parameter can be added to the connection string</li>\n<li>this will be considerably faster for a large number of files than opening, editing, copying would be. If you feel fancy, you can further speed things up by moving stuff from the <code>GetData</code>-Sub to <code>ProcessFiles</code>, so they won't get called repeatedly.</li>\n<li>you use a database language for querying data instead of some clumsy copy/paste mechanism.</li>\n</ul>\n\n<p><strong>Edit:</strong> \nEdited my code, for me this works with the example you gave.</p>\n\n<ul>\n<li>From what i gather, you only got protected <code>Worksheets</code>, not a password-protected <code>Workbook</code> - therefore there's no need to unhide or unprotect your worksheets</li>\n<li>adjust the line <code>strSQL = \"SELECT '\" &amp; myfile.Name &amp; \"' AS WorkbookName, * FROM [sheetData$A1:C5], (SELECT TOP 1 * FROM [sheetSchool$C12:C13])\"</code> to contain your actual <code>Sheets(2)</code> and <code>Sheets(4)</code> names</li>\n</ul>\n"}], "owner": {"reputation": 82, "user_id": 7956263, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-24-YmgbXkrM/AAAAAAAAAAI/AAAAAAAAATI/tje35LpDlIY/photo.jpg?sz=128", "display_name": "BoTz", "link": "https://stackoverflow.com/users/7956263/botz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1441, "favorite_count": 0, "accepted_answer_id": 43760693, "answer_count": 1, "score": 0, "last_activity_date": 1527607172, "creation_date": 1493800616, "last_edit_date": 1493808129, "question_id": 43755101, "link": "https://stackoverflow.com/questions/43755101/vba-copy-specific-range-from-multiple-workbooks-into-one-worksheet", "title": "VBA: Copy specific range from multiple workbooks into one worksheet", "body": "<p>I have a folder with lots (hundreds) of locked <code>.xls</code> files.</p>\n\n<p>I need to copy a specific range from one of the worksheets in each file into one big worksheet, which would be my data file for future analysis.</p>\n\n<p>I tried to write a macro for this, but keep getting errors.</p>\n\n<p>Please help me debug what I wrote:</p>\n\n<pre><code>Sub ProcessFiles()\n\n    ' declarations &amp; definitions\n    Dim Pathname As String\n    Dim Filename As String\n    Dim sourceWB As Workbook\n    Dim targetWB As Workbook    \n\n    targetWB = ActiveWorkbook\n    Pathname = ActiveWorkbook.Path &amp; \"\\Files\\\"\n    Filename = Dir(Pathname &amp; \"*.xls\")        \n\n    ' loop through all files in folder\n    Do While Filename &lt;&gt; \"\"\n        Set sourceWB = Workbooks.Open(Pathname &amp; Filename)            \n\n        ' unlock worksheets\n        sourceWB.Sheets(4).Visible = True\n        sourceWB.Sheets(4).Unprotect Password:=\"Password\"\n        sourceWB.Sheets(2).Unprotect Password:=\"Password\"    \n\n        ' create new worksheet\n        sourceWB.Sheets.Add After:=8    \n\n        ' copy required cells to new sheets\n        sourceWB.Sheets(2).Range(\"A14:FM663\").Copy Destination:=sourceWB.Sheets(9).Range(\"C2\")\n\n        ' fill columns for all rows\n        sourceWB.Sheets(9).Range(\"A2:A663\").Value = sourceWB.Name\n        sourceWB.Sheets(9).Range(\"B2:B663\").Value = Worksheets(4).Range(\"C13\").Value    \n\n        'move AuxSheet to taget workbook\n        sourceWB.Sheets(9).Move Before:=Workbooks(targetWB).Sheets(1)    \n\n        'add to full data worksheet\n        targetWB.Sheets(1).Range(\"A2:FO651\").Copy Destination:=sourceWB.Sheets(2).Rows(\"3:\" &amp; Worksheets(\"Sheet2\").UsedRange.Rows.Count)        \n\n        'close file and repeat\n        sourceWB.Close SaveChanges:=False\n        Filename = Dir()\n    Loop    \n\n    ' save result\n    targetWB.Save    \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1493803575, "creation_date": 1493803575, "answer_id": 43756097, "question_id": 43754779, "link": "https://stackoverflow.com/questions/43754779/ms-access-queries-in-vba-excel/43756097#43756097", "title": "MS Access Queries in vba excel", "body": "<p>Modify your SQL to change the query from a <em>create table query</em> to an <em>append query</em>.</p>\n"}], "owner": {"reputation": 95, "user_id": 7900306, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/745e563f4d288ccdcd3d2e736d67160f?s=128&d=identicon&r=PG&f=1", "display_name": "harsha kazama", "link": "https://stackoverflow.com/users/7900306/harsha-kazama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1520828319, "creation_date": 1493799588, "last_edit_date": 1531164843, "question_id": 43754779, "link": "https://stackoverflow.com/questions/43754779/ms-access-queries-in-vba-excel", "title": "MS Access Queries in vba excel", "body": "<pre><code>Set objAccess = CreateObject(\"Access.Application\")\n\n\nobjAccess.OpenCurrentDatabase \"C:\\Users\\\" &amp; sUser &amp; \"\\Downloads\\ICO\\\" &amp; DB &amp; \".mdb\"\n\nobjAccess.DoCmd.RunSQL \"SELECT [Total-7yr_27Mar2017].TYPE AS Type, [Total-7yr_27Mar2017].[HOLDING CO] AS [HOLDING CO], [Total-7yr_27Mar2017].CODE AS CODE, [Total-7yr_27Mar2017].ST AS ST, [Total-7yr_27Mar2017].STLVL AS STLVL, [Total-7yr_27Mar2017].STCMP AS STCMP, [Total-7yr_27Mar2017].JUR AS JUR, Sum([Total-7yr_27Mar2017].[OR LS MOU]) AS OR_LS_MOU, Sum([Total-7yr_27Mar2017].[UP LS MOU]) AS UP_LS_MOU, Sum([Total-7yr_27Mar2017].[TOT USG EXP]) AS UP_USG_EXP INTO 7yr_Total_Varients\n FROM [Total-7yr_27Mar2017]\n GROUP BY [Total-7yr_27Mar2017].TYPE, [Total-7yr_27Mar2017].[HOLDING CO], [Total-7yr_27Mar2017].CODE, [Total-7yr_27Mar2017].ST, [Total-7yr_27Mar2017].STLVL, [Total-7yr_27Mar2017].STCMP, [Total-7yr_27Mar2017].JUR\"\n</code></pre>\n\n<p><code>Docmd.RunSQL</code> is working sometimes and giving error as Docmd.RunSQL is not reliable for select queries. So I tried with Database.execute and adodb.connection adobd.recordset.it throwing error that 7yr_Total_Varients already exists.</p>\n"}, {"tags": ["vba", "excel", "math"], "comments": [{"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1493799992, "post_id": 43754756, "comment_id": 74551115, "body": "How does the current message box output differ from your requirement?"}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 2, "last_activity_date": 1493800014, "creation_date": 1493800014, "answer_id": 43754925, "question_id": 43754756, "link": "https://stackoverflow.com/questions/43754756/vba-how-do-call-out-minimum-coordinate-out-of-if-function/43754925#43754925", "title": "VBA: How do call out minimum coordinate out of if function?", "body": "<p>You will need to keep a record of the value of <code>i</code> and <code>j</code> when the minimum occurs:</p>\n\n<pre><code>Sub Length_Min()\n    'Define variables where length and maximum lengths are integers'\n    Dim Length_Max As Double, Length As Double\n    Dim iMin As Double\n    Dim jMin As Double\n\n    'Comparing Variable, set maximum length to 1000m'\n    Length_Max = 1000\n\n    'Double for loop, within domain with increment of 0.01m.'\n    'Domain x[i] : 0&lt;=x&lt;=50 and Domain y[j]: 0&lt;=y&lt;=30'\n    For i = 0 To 50 Step 0.01\n        For j = 0 To 30 Step 0.01\n\n            'Subsitute x-values [i] and y- values [j] into the Total Length equation, Length.'\n            Length = (Sqr((5 - i) ^ 2 + (5 - j) ^ 2)) + (Sqr((10 - i) ^ 2 + (20 - j) ^ 2)) + (Sqr((30 - i) ^ 2 + (10 - j) ^ 2))\n\n            'If the length found from the equation Length [L(x,y)] is less than 1000, then replace Length Max with new Length found.'\n            'Repeat for all increments of 0.01m untill smallest L(x,y) is found.'\n            If Length &lt; Length_Max Then\n                Length_Max = Length\n                iMin = i\n                jMin = j\n            End If\n        Next j\n    Next i\n\n    'Print the minimum length found and its (x,y) coordinates, point P'\n    MsgBox \"The minimum length is : \" &amp; Length_Max &amp; \" meters\" &amp; vbNewLine &amp; \"Minimum x and y coordinates are : \" &amp; iMin &amp; \" , \" &amp; jMin\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7956283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9934fcd41b75ec0365c90fc54f40a7db?s=128&d=identicon&r=PG&f=1", "display_name": "tl1234", "link": "https://stackoverflow.com/users/7956283/tl1234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 43754925, "answer_count": 1, "score": 0, "last_activity_date": 1493800014, "creation_date": 1493799503, "last_edit_date": 1531164843, "question_id": 43754756, "link": "https://stackoverflow.com/questions/43754756/vba-how-do-call-out-minimum-coordinate-out-of-if-function", "title": "VBA: How do call out minimum coordinate out of if function?", "body": "<p>How do I print the i and j (x,y) coordinates as msgbox?</p>\n\n<pre><code>Sub Length_Min()\n    'Define variables where length and maximum lengths are integers'\n    Dim Length_Max As Double, Length As Double\n\n    'Comparing Variable, set maximum length to 1000m'\n    Length_Max = 1000\n\n    'Double for loop, within domain with increment of 0.01m.'\n    'Domain x[i] : 0&lt;=x&lt;=50 and Domain y[j]: 0&lt;=y&lt;=30'\n    For i = 0 To 50 Step 0.01\n        For j = 0 To 30 Step 0.01\n\n            'Subsitute x-values [i] and y- values [j] into the Total Length equation, Length.'\n            Length = (Sqr((5 - i) ^ 2 + (5 - j) ^ 2)) + (Sqr((10 - i) ^ 2 + (20 - j) ^ 2)) + (Sqr((30 - i) ^ 2 + (10 - j) ^ 2))\n\n            'If the length found from the equation Length [L(x,y)] is less than 1000, then replace Length Max with new Length found.'\n            'Repeat for all increments of 0.01m untill smallest L(x,y) is found.'\n            If Length &lt; Length_Max Then Length_Max = Length\n\n        Next j\n    Next i\n\n    'Print the minimum length found and its (x,y) coordinates, point P'\n    MsgBox \"The minimum length is : \" &amp; Length_Max &amp; \" meters\" &amp; vbNewLine &amp; \"Minimum x and y coordinates are : \" &amp; i &amp; \" , \" &amp; j\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1493804194, "post_id": 43754674, "comment_id": 74553942, "body": "<code>With Word</code> means nothing because there is no period before the <code>tblNew</code>. However, <code>Word</code> is a word reserved for the use of VBA. Therefore you should expect problems if you use it to name your variable. Name your Word.Application like <code>WdApp</code>. With that being said, when you use two applications you absolutely must declare each variable. For example, you declare your table as <code>Dim tblNew As Word.Table</code>. Then, when you refer to it, VBA will know that you mean a Word table and not an Excel table."}, {"owner": {"reputation": 409, "user_id": 5547193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b2e95bf44a17202162e6e52f6c15372?s=128&d=identicon&r=PG&f=1", "display_name": "James Lingham", "link": "https://stackoverflow.com/users/5547193/james-lingham"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1493806970, "post_id": 43754674, "comment_id": 74555928, "body": "Hi thanks for the reply,  Variables are all defined in the code before hand, I just hadnt included it, tblnew is set as &quot;.activedocument.Tables.Add(MyRange, 5, 13)&quot; the &quot;.&quot; being here is enough right?  I&#39;ll rename the variable for the word app, but I have been able to modify bits of the table already i.e merging cells and inputting data using the same things, it just seems to be the alignment causing problems"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1493814340, "post_id": 43754674, "comment_id": 74561078, "body": "It isn&#39;t possible to tell you if the &quot;.&quot; is correct or not without knowing what the &quot;.&quot; refers to. If <code>.Activedocument</code> refers to <code>With Word</code> it is wrong. <code>Set</code> isn&#39;t the same as <code>Dim</code>. Once you have dimensioned the variable as <code>Dim tblNew As Word.Table</code> <code>tblNew</code> is a Word table and you don&#39;t have to mention it again. <code>Set tlbNew = Activedocument.Tables.Add</code> is adequate. But I would recommend to declare <code>Dim Doc As Word.Document</code> and then <code>Set Doc = ActiveDocument</code> for better clarity."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1493814457, "post_id": 43754674, "comment_id": 74561176, "body": "Remember, your code runs in an Excel environment. VBA will attempt to understand <code>ActiveDocument</code> as an Excel command, find that it doesn&#39;t exist, find that Word is also available and interpret it as a Word object. That takes time and can cause errors."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1493814699, "post_id": 43754674, "comment_id": 74561362, "body": "When manipulating tables, bear in mind that you lose the ability to refer to rows, if you have vertical merges, and columns, if there are horizontal merges. You should finish your entire table first and merge cells only when you are done - and you need to do the merging in such a way that you don&#39;t need to refer to rows after rows have been merged or to columns after columns have been merged. It&#39;s quite tricky. Most people who know how to do it recommend to abstain from merging. I don&#39;t know. Therefore I advise to be careful :-)"}, {"owner": {"reputation": 409, "user_id": 5547193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b2e95bf44a17202162e6e52f6c15372?s=128&d=identicon&r=PG&f=1", "display_name": "James Lingham", "link": "https://stackoverflow.com/users/5547193/james-lingham"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1493821203, "post_id": 43754674, "comment_id": 74566619, "body": "thanks for the detailed responses. i have the following          &#39;dim word as object&#39;,        &#39;set word = createobject(&quot;word.application&quot;)&#39; when i made the table i use &#39;with word Set tblnew = .activedocument.tables.Add(MyRange, 5, 13) end with&#39;  If i am correct, it&#39;s basically saying word.activedocument.tables[...], so this should be correct still in recognising that the format is for word?"}, {"owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "edited": false, "score": 0, "creation_date": 1493889022, "post_id": 43754674, "comment_id": 74597577, "body": "As you are using Late Binding I suspect that the problem is that Excel doesn&#39;t understand the constant wdAlignVerticalCenter. Replace that with its value, 1, and it may work better, assuming that there are no other errors in your code."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1493893328, "post_id": 43754674, "comment_id": 74600678, "body": "Almost, but not quite. After <code>Dim WdApp As Word.Application</code> <code>Dim Tbl As Word.Table</code> and <code>Set WdApp = CreateObject(&quot;Word.Application&quot;)</code>, <code>Set Tbl = WdApp.ActiveDocument.Tables.Add(MyRange, 5, 13)</code> says, in plain text, Find the <code>ActiveDocument</code> of the WdApp application, add a table to it as specified by <code>(MyRange, 5, 13)</code> and assign that table&#39;s object to the declared variable <code>Tbl</code>, which means that all the new object&#39;s properties will be those defined in the still empty <code>Tbl</code> object. Of course this will fail if the new object and the <code>Tbl</code> space have different properties."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1493893781, "post_id": 43754674, "comment_id": 74600992, "body": "Observe that <code>MyRange</code> isn&#39;t defined in the above code. If you have a Dim statement like <code>Dim MyRange As Range</code> VBA (Excel) will assume this to be an <code>Excel.Range</code> which has different properties than a <code>Word.Range</code>. If you were to run the same code in VBA (Word), the same <code>Dim MyRange As Range</code> would be understood as defining a <code>Word.Range</code>. If you want to declare a <code>Word.Range</code> while running Excel&#39;s VBA you must use <code>Dim MyRange As Word.Range</code>. Observe that VBA is using the key word <code>Word</code>. If you try to compete with VBA for the use of that key word you are unlikely to win the argument."}], "owner": {"reputation": 409, "user_id": 5547193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b2e95bf44a17202162e6e52f6c15372?s=128&d=identicon&r=PG&f=1", "display_name": "James Lingham", "link": "https://stackoverflow.com/users/5547193/james-lingham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1129, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537698219, "creation_date": 1493799267, "last_edit_date": 1537698219, "question_id": 43754674, "link": "https://stackoverflow.com/questions/43754674/msword-vertical-align-cells-vba-from-excel", "title": "MSWord Vertical Align cells VBA from Excel", "body": "<p>I am currently creating a function in excel which will create a table in MS word and fill in with data from excel, I am trying to format the table and having some issues with alignment.\nI am trying to get the first two rows of each table made to vertically align in the center, and while it does not come up with an error, I don't see any change.</p>\n\n<p>However when I run the same code in MS word directly, it works without any issues.\nCode in Excel (word object is created as a word object, and tblnew is set to be a newly created table, other format changes with the table in the format work i.e font size, cell size and contents)</p>\n\n<pre><code>    with word\n        with tblnew\n            .Rows(1).Cells.VerticalAlignment = wdAlignVerticalCenter\n        end with\n   end with\n</code></pre>\n\n<p>Running the following in the immediate window in word also works</p>\n\n<pre><code>    activedocument.Tables(1).Rows(1).Cells.VerticalAlignment = wdAlignVerticalCenter\n</code></pre>\n\n<p>If my understanding is correct, \"tblnew\" should already be referring to the \"actidocument.tables(1)\" so the code should be identicle, and the \"with word\" object should mean that the code is being executed in word as it would have been already, so im not sure where the issue lies.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7956139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8053cbc92c291e2657eccf98c6d7a2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Jovel", "link": "https://stackoverflow.com/users/7956139/jovel"}, "edited": false, "score": 0, "creation_date": 1493801293, "post_id": 43754713, "comment_id": 74551894, "body": "I tried and it doesn&#39;t work. When there&#39;s an open workbook before, it opens and show it all (including the one I want hidden) and when there isn&#39;t, excel simply crush. :("}, {"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "reply_to_user": {"reputation": 1, "user_id": 7956139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8053cbc92c291e2657eccf98c6d7a2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Jovel", "link": "https://stackoverflow.com/users/7956139/jovel"}, "edited": false, "score": 0, "creation_date": 1493809463, "post_id": 43754713, "comment_id": 74557590, "body": "Open several workbooks, try <b>only</b> the code above (insert your wb name you want to hide) and test the code <b>step by step</b> if it works as desired."}, {"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "reply_to_user": {"reputation": 1, "user_id": 7956139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8053cbc92c291e2657eccf98c6d7a2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Jovel", "link": "https://stackoverflow.com/users/7956139/jovel"}, "edited": false, "score": 0, "creation_date": 1495191753, "post_id": 43754713, "comment_id": 75160590, "body": "If this answered your question, consider accepting it as an answer."}], "tags": [], "owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1493800513, "last_edit_date": 1493800513, "creation_date": 1493799380, "answer_id": 43754713, "question_id": 43754326, "link": "https://stackoverflow.com/questions/43754326/vba-show-userform-and-hide-only-one-specific-workbook-keep-showing-the-other-wo/43754713#43754713", "title": "VBA show userform and hide only one specific workbook (keep showing the other workbooks)", "body": "<p>This hides and shows a specific workbook, even if other workbooks are open:</p>\n\n<pre><code>Sub test()\n    Dim wb As Workbook\n    Set wb = Workbooks(\"Myworkbook.xlsm\")\n    wb.Windows(1).Visible = False\n    'code\n    wb.Windows(1).Visible = True\nEnd Sub\n</code></pre>\n\n<p>Note that the workbook has to be open for this to work. If not opened yet, use:</p>\n\n<pre><code>Set wbk = Workbooks.Open(\"Myworkbook.xlsm\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7956139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8053cbc92c291e2657eccf98c6d7a2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Jovel", "link": "https://stackoverflow.com/users/7956139/jovel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1345, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493803125, "creation_date": 1493798200, "last_edit_date": 1493803125, "question_id": 43754326, "link": "https://stackoverflow.com/questions/43754326/vba-show-userform-and-hide-only-one-specific-workbook-keep-showing-the-other-wo", "title": "VBA show userform and hide only one specific workbook (keep showing the other workbooks)", "body": "<p>I have an excel (2013) file that automatically opens a userform. I want it to show only the userform and hide only that one specific workbook, but it either hides all the workbooks that were open before or show all of them, including the one I want hidden.\nI tried to use:</p>\n\n<pre><code>Application.visible = false\n\nWith ActiveWindow\nApplication.visible=false\nEnd with\n\nActiveWindow.application.visible = false\n\nActiveWindow.visible = false\n\nWindows(\"workbookname.xlsm\").visible = false\n</code></pre>\n\n<p>None worked.\nIf anyone has any idea I'd be very thankfull. Thank you.</p>\n"}, {"tags": ["excel", "vba", "loops", "offset"], "comments": [{"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1493810880, "post_id": 43754325, "comment_id": 74558534, "body": "Trim down your code and post am easily reproducable example."}, {"owner": {"reputation": 37, "user_id": 7273009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdf63a9d1690f835f4bb8935f00fb65c?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7273009/jay"}, "reply_to_user": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1493814666, "post_id": 43754325, "comment_id": 74561329, "body": "@DavidG I&#39;ve made the update, hope this is better. However, I get a different error code at the beginning which I didn&#39;&#39;t have in the old code."}, {"owner": {"reputation": 37, "user_id": 7273009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdf63a9d1690f835f4bb8935f00fb65c?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7273009/jay"}, "reply_to_user": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1493815270, "post_id": 43754325, "comment_id": 74561798, "body": "@DavidG, Disregard the different error code at the beginning. It is just the second loop that is troubling me now."}, {"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1493818242, "post_id": 43754325, "comment_id": 74564177, "body": "By &quot;troublin me now&quot; you mean the error 1004? Or did you encounter a new error now? At what line do you get the error?"}, {"owner": {"reputation": 37, "user_id": 7273009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdf63a9d1690f835f4bb8935f00fb65c?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7273009/jay"}, "reply_to_user": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1493818933, "post_id": 43754325, "comment_id": 74564773, "body": "@DavidG, the error 1004 code for the first loop is what I meant, but that one was because I was referring to the wrong sheet. I got the code working with a different code for this example. Maybe I can show you it through a chat? Or should I update it above?"}, {"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 1, "creation_date": 1493819170, "post_id": 43754325, "comment_id": 74564959, "body": "It is best to always update your question with new results, so others can see them as well. And be as specific as possible with your descriptions."}], "owner": {"reputation": 37, "user_id": 7273009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdf63a9d1690f835f4bb8935f00fb65c?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7273009/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1493820203, "creation_date": 1493798199, "last_edit_date": 1493820203, "question_id": 43754325, "link": "https://stackoverflow.com/questions/43754325/for-each-loop-dependant-options", "title": "For Each Loop dependant options", "body": "<p>While working on a loop which works, I want to create a dependant choice. </p>\n\n<p>The user must select on Sheet2 whether a product will be shown on sheet1 or not by hiding the row. If he wants a product to be shown, he must fill in \"a\" in the Range(\"Checkmark\"). See image below. </p>\n\n<p><a href=\"https://i.stack.imgur.com/btaJe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/btaJe.png\" alt=\"Image1\"></a></p>\n\n<p>VBA will then search with a code which products have an \"a\" and take the named range of that cell and add an \"1\" after it so the named range on sheet1 will be hidden or unhidden. For example, if product A is selected, VBA will take Named range \"ProductA\" and make it into \"ProductA1\". Named range \"ProductA1\" will then be shown on sheet 1. See images below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/iRjQU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iRjQU.png\" alt=\"Image2\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/VacPw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VacPw.png\" alt=\"Image3\"></a></p>\n\n<p>The second choice is whether the product must be black or white. If chosen \"black\" then a certain named range on sheet 1 will be shown and \"white\" will be hidden. It could also be the other way around. The product itself contains some info named \"Productinfo\". This should be shown if an \"a\" has been filled in on sheet 2 under checkmark, if the product is not selected, all rows (Named range \"ProductA1\") should be hidden for that product on sheet 1. See images below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/npzS7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/npzS7.png\" alt=\"Image4\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/fDUHK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fDUHK.png\" alt=\"Image5\"></a></p>\n\n<p>See all named ranges in image below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/CT4yi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CT4yi.png\" alt=\"Image6\"></a></p>\n\n<p>So this is the code:</p>\n\n<pre><code>    Sub Choosingproduct()\n\nApplication.ScreenUpdating = False\nDim cell As Range\nFor Each cell In Range(\"Checkmark\") 'Where user puts in value \"a\" or not\n'Searching for the products that have an \"a\" in checkmark, then replacing the name and adding a \"1\" so VBA knows which range to hide or unhide on sheet 1\n    Sheets(\"Sheet1\").Range(Replace(cell.Name.Name, cell.Name.Name, cell.Name.Name &amp; \"1\")).EntireRow.Hidden = Not cell.Value = \"a\"\n\n\n    Dim rCell As Range\n    For Each rCell In Range(\"Productchoice\")\n    If cell.Value = \"a\" Then\n        Sheets(\"Sheet1\").Range(Replace(rCell.Name.Name, rCell.Name.Name, rCell.Name.Name &amp; \"black\")).EntireRow.Hidden = Not rCell.Value = \"Black\"\n        Sheets(\"Sheet1\").Range(Replace(rCell.Name.Name, rCell.Name.Name, rCell.Name.Name &amp; \"white\")).EntireRow.Hidden = Not rCell.Value = \"White\"\n    Else\n        Sheets(\"Sheet1\").Range(Replace(rCell.Name.Name, rCell.Name.Name, rCell.Name.Name &amp; \"black\")).EntireRow.Hidden = Not rCell.Value = \"Black\"\n        Sheets(\"Sheet1\").Range(Replace(rCell.Name.Name, rCell.Name.Name, rCell.Name.Name &amp; \"white\")).EntireRow.Hidden = Not rCell.Value = \"White\"\n    End If\n\n    Next rCell\n\nNext cell\n\nApplication.ScreenUpdating = True\n\n\nEnd Sub\n</code></pre>\n\n<p>How can I make VBA search for each separate component in the second loop? I get the run-time error 1004, Application-defined or object-defined error.</p>\n\n<p>UPDATE:</p>\n\n<p>I tried a different code and this seems to work:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim cell As Range\nApplication.ScreenUpdating = False\nFor Each cell In Range(\"Checkmark\") 'Where user puts in value \"a\" or not\n    Sheets(\"Sheet1\").Range(Replace(cell.Name.Name, cell.Name.Name, cell.Name.Name &amp; \"1\")).EntireRow.Hidden = Not cell.Value = \"a\"\n\n        If cell.Value = \"a\" Then\n            If Sheets(\"Sheet2\").Range(Replace(cell.Name.Name, cell.Name.Name, cell.Name.Name &amp; \"choice\")).Value = \"Black\" Then\n                Sheets(\"Sheet1\").Range(Replace(cell.Name.Name, cell.Name.Name, cell.Name.Name &amp; \"choiceblack\")).EntireRow.Hidden = False\n            Else\n                Sheets(\"Sheet1\").Range(Replace(cell.Name.Name, cell.Name.Name, cell.Name.Name &amp; \"choiceblack\")).EntireRow.Hidden = True\n            End If\n        End If\n\n        If cell.Value = \"a\" Then\n            If Sheets(\"Sheet2\").Range(Replace(cell.Name.Name, cell.Name.Name, cell.Name.Name &amp; \"choice\")).Value = \"White\" Then\n                Sheets(\"Sheet1\").Range(Replace(cell.Name.Name, cell.Name.Name, cell.Name.Name &amp; \"choicewhite\")).EntireRow.Hidden = False\n            Else\n                Sheets(\"Sheet1\").Range(Replace(cell.Name.Name, cell.Name.Name, cell.Name.Name &amp; \"choicewhite\")).EntireRow.Hidden = True\n            End If\n        End If\n\nNext cell\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access", "background", "hide"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 7790879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f1fc185b261a2dbd5ee15a9e8d7c344?s=128&d=identicon&r=PG&f=1", "display_name": "Bezique", "link": "https://stackoverflow.com/users/7790879/bezique"}, "edited": false, "score": 0, "creation_date": 1493800348, "post_id": 43754648, "comment_id": 74551342, "body": "I have tried inserting this into the code (in a few places), it has not made any difference."}, {"owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "reply_to_user": {"reputation": 27, "user_id": 7790879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f1fc185b261a2dbd5ee15a9e8d7c344?s=128&d=identicon&r=PG&f=1", "display_name": "Bezique", "link": "https://stackoverflow.com/users/7790879/bezique"}, "edited": false, "score": 0, "creation_date": 1493804707, "post_id": 43754648, "comment_id": 74554356, "body": "please add after this line <code>AppActivate &quot;Microsoft Access&quot;</code>"}, {"owner": {"reputation": 27, "user_id": 7790879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f1fc185b261a2dbd5ee15a9e8d7c344?s=128&d=identicon&r=PG&f=1", "display_name": "Bezique", "link": "https://stackoverflow.com/users/7790879/bezique"}, "edited": false, "score": 0, "creation_date": 1493805548, "post_id": 43754648, "comment_id": 74554940, "body": "Thanks, I have tried this. It has not made a difference."}, {"owner": {"reputation": 27, "user_id": 7790879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f1fc185b261a2dbd5ee15a9e8d7c344?s=128&d=identicon&r=PG&f=1", "display_name": "Bezique", "link": "https://stackoverflow.com/users/7790879/bezique"}, "edited": false, "score": 0, "creation_date": 1493806720, "post_id": 43754648, "comment_id": 74555782, "body": "I have a workaround. I created a dummy form that Access opens first. This form closes itself and immediately calls a second form (the real home form), which conducts the hiding procedure. This only worked when carried out in conjunction with the suggestion from @Maddy Nikam"}], "tags": [], "owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "is_accepted": true, "score": 0, "last_activity_date": 1493799208, "creation_date": 1493799208, "answer_id": 43754648, "question_id": 43754293, "link": "https://stackoverflow.com/questions/43754293/make-access-background-be-invisible-when-launching-it-from-excel/43754648#43754648", "title": "Make Access background be invisible when launching it from Excel", "body": "<p>you can set Application.Visible Property to false <code>ac.Visible = False</code></p>\n"}], "owner": {"reputation": 27, "user_id": 7790879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f1fc185b261a2dbd5ee15a9e8d7c344?s=128&d=identicon&r=PG&f=1", "display_name": "Bezique", "link": "https://stackoverflow.com/users/7790879/bezique"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 365, "favorite_count": 0, "accepted_answer_id": 43754648, "answer_count": 1, "score": 0, "last_activity_date": 1493799208, "creation_date": 1493798083, "question_id": 43754293, "link": "https://stackoverflow.com/questions/43754293/make-access-background-be-invisible-when-launching-it-from-excel", "title": "Make Access background be invisible when launching it from Excel", "body": "<p>I have used this <a href=\"http://www.vbaexpress.com/kb/getarticle.php?kb_id=74\" rel=\"nofollow noreferrer\">code for hiding the Access window to show only popup forms</a>.</p>\n\n<p>This is the Load event of the Access \"Display Form\"</p>\n\n<pre><code>Private Sub Form_Load()\n    Me.Visible = True\n    fSetAccessWindow (SW_HIDE)\n    DoCmd.GoToRecord , , acNewRec\nEnd Sub\n</code></pre>\n\n<p>This correctly hides the background when I launch Access directly.</p>\n\n<p>In normal use I want to call Access via an Excel command button (code below). The form loads, but the Access window remains visible when it is launched in this way. </p>\n\n<p>Can anyone see why the behaviour is different?</p>\n\n<p>Thanks</p>\n\n<pre><code>Sub Clicked_Edit()\n    Application.ScreenUpdating = False\n\n    Dim ac As Object\n    Dim str As String\n\n    On Error Resume Next\n    Set ac = GetObject(, \"Access.Application\")\n    If ac Is Nothing Then\n        Set ac = GetObject(\"\", \"Access.Application\")\n        ac.OpenCurrentDatabase \n       \"&lt;MyFilePathToDatabase&gt;\"\n    End If\n    AppActivate \"Microsoft Access\"\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-2013", "conditional-formatting", "vba"], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 2976696, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3d48d5affd0f2cf7cae8126cc63316cd?s=128&d=identicon&r=PG", "display_name": "Reginald Greyling", "link": "https://stackoverflow.com/users/2976696/reginald-greyling"}, "edited": false, "score": 0, "creation_date": 1493799201, "post_id": 43754425, "comment_id": 74550637, "body": "This seems to work perfectly! Thank you very much! My logic was that if I remove the dollar sign, it will only format cell A1."}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "reply_to_user": {"reputation": 313, "user_id": 2976696, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3d48d5affd0f2cf7cae8126cc63316cd?s=128&d=identicon&r=PG", "display_name": "Reginald Greyling", "link": "https://stackoverflow.com/users/2976696/reginald-greyling"}, "edited": false, "score": 0, "creation_date": 1493799954, "post_id": 43754425, "comment_id": 74551100, "body": "Yes conditional formatting formulas are not the most intuitive things to work with, hence why I tried to explain them with the autofill comparison! Glad I could help :)"}], "tags": [], "owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "is_accepted": true, "score": 2, "last_activity_date": 1493799036, "last_edit_date": 1493799036, "creation_date": 1493798531, "answer_id": 43754425, "question_id": 43754153, "link": "https://stackoverflow.com/questions/43754153/apply-conditional-formatting-to-range-but-only-format-cell-where-condition-is-tr/43754425#43754425", "title": "Apply Conditional Formatting to Range but Only Format Cell Where Condition Is True", "body": "<p>You can avoid using VBA here*... Remove the dollar signs in your conditional statement, it should be</p>\n\n<pre><code>=OR(A1=\"CA515\", A1=\"CA525\")\n</code></pre>\n\n<p>The dollar signs specify whether the reference is relative or absolute. To visualise how this works, try typing these formulas into a cell and dragging the corner of the cell down to autofill:</p>\n\n\n\n<pre><code>=A1  'Autofilling this down will give =A2, =A3, ...\n=$A1 'Autofilling this down will give =$A1, =$A1, ...\n</code></pre>\n\n<p>So by removing <code>$</code>, your format condition should be spread across the range. To set the range, change \"applies to\" to <code>$A:$G</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/AykKU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AykKU.png\" alt=\"format\"></a></p>\n\n<hr>\n\n<p>Note: many conditional formats over a large range like this could severely impact the speed of your document. Consider at least limiting the number of different formats, or the number of rows it's checking.</p>\n\n<p>*Although the above method does avoid VBA, it might be quicker to write your own formatting routine in VBA, since it wouldn't have to get checked so frequently and it would be unaffected by moving around of ranges which messes with conditional formats.</p>\n"}], "owner": {"reputation": 313, "user_id": 2976696, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3d48d5affd0f2cf7cae8126cc63316cd?s=128&d=identicon&r=PG", "display_name": "Reginald Greyling", "link": "https://stackoverflow.com/users/2976696/reginald-greyling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 520, "favorite_count": 0, "accepted_answer_id": 43754425, "answer_count": 1, "score": 0, "last_activity_date": 1493799036, "creation_date": 1493797623, "last_edit_date": 1531164843, "question_id": 43754153, "link": "https://stackoverflow.com/questions/43754153/apply-conditional-formatting-to-range-but-only-format-cell-where-condition-is-tr", "title": "Apply Conditional Formatting to Range but Only Format Cell Where Condition Is True", "body": "<p>I have a sheet that looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/bTbSo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bTbSo.png\" alt=\"Labels\"></a></p>\n\n<p>The coloured cells need to be a specific colour based on their value. I am currently using conditional formatting to achieve this, but I am only able to get it to apply to a single column instead of the entire range A:G. For example, here\u2019s my formula for column A for values that should be coloured light blue:</p>\n\n<pre><code>=OR($A1=\"CA515\",$A1=\"CA525\")\n</code></pre>\n\n<p>And applies to:</p>\n\n<pre><code>=$A:$A\n</code></pre>\n\n<p>Using the above formula, if any of the cells in column A contain the value CA515 or CA525, the cell alone is coloured light blue. Is there any way to use a single conditional formatting formula to make it possible that if any of the cells in the range A:G contain the value CA515 or CA525 that only that cell alone is coloured light blue? Or do I have to apply the formula to every column individually, or possibly even resort to VBA?</p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1493796600, "post_id": 43753585, "comment_id": 74549084, "body": "It&#39;s unclear to me what your actual goal is. Can you <a href=\"https://stackoverflow.com/posts/43753585/edit\">edit</a> and add how your data looks like before and should look like <b>after</b> the conversion? What do you mean by &quot;converts the first column, and not the third.&quot;? Always add to your questions: What does your code actually do and what do you expect it to do. Always try to provide a fully working <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 1, "creation_date": 1493796984, "post_id": 43753585, "comment_id": 74549311, "body": "What happens if you record a macro doing the same thing?"}, {"owner": {"reputation": 543, "user_id": 3631482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/K2wBD.jpg?s=128&g=1", "display_name": "Jeanjean", "link": "https://stackoverflow.com/users/3631482/jeanjean"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1493797799, "post_id": 43753585, "comment_id": 74549806, "body": "@Peh hi, this is what I want : <a href=\"http://hpics.li/a8bcb06\" rel=\"nofollow noreferrer\">hpics.li/a8bcb06</a> Raw datas :  Date;Employee;Ticket number;Table number 30/09/2016;Josh;005421;17 30/09/2016;Annie;004412;25 30/09/2016;John;001124;12"}, {"owner": {"reputation": 543, "user_id": 3631482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/K2wBD.jpg?s=128&g=1", "display_name": "Jeanjean", "link": "https://stackoverflow.com/users/3631482/jeanjean"}, "edited": false, "score": 0, "creation_date": 1493798001, "post_id": 43753585, "comment_id": 74549908, "body": "Code generated with the macro editor :  Sub Macro1() &#39; &#39; Macro1 Macro &#39;  &#39;     Columns(&quot;A:A&quot;).Select     Selection.TextToColumns Destination:=Range(&quot;A1&quot;), DataType:=xlDelimited, _         TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _         Semicolon:=True, Comma:=False, Space:=False, Other:=False, FieldInfo _         :=Array(Array(1, 1), Array(2, 1), Array(3, 2), Array(4, 1)), TrailingMinusNumbers:= _         True     Range(&quot;B6&quot;).Select End Sub"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1493798062, "post_id": 43753585, "comment_id": 74549952, "body": "Please use the <a href=\"https://stackoverflow.com/posts/43753585/edit\">edit</a> button to add it to your question and format it nicely. This is unreadable."}, {"owner": {"reputation": 543, "user_id": 3631482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/K2wBD.jpg?s=128&g=1", "display_name": "Jeanjean", "link": "https://stackoverflow.com/users/3631482/jeanjean"}, "edited": false, "score": 0, "creation_date": 1493798135, "post_id": 43753585, "comment_id": 74550007, "body": "I&#39;d like to convert the numbers in the THIRD column as TEXT so I don&#39;t lose the &quot;00&quot; : <a href=\"http://hpics.li/0d67dee\" rel=\"nofollow noreferrer\">hpics.li/0d67dee</a>. My problem is, when I use Array(Array(3,2)) with the code provided in my post, it does not work. The example I&#39;m giving is not the real project I&#39;m working on. It&#39;s an example to show you where I&#39;m struggling."}, {"owner": {"reputation": 543, "user_id": 3631482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/K2wBD.jpg?s=128&g=1", "display_name": "Jeanjean", "link": "https://stackoverflow.com/users/3631482/jeanjean"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1493798485, "post_id": 43753585, "comment_id": 74550209, "body": "@Peh, it&#39;s done. Hope it&#39;s clearer for you."}], "answers": [{"comments": [{"owner": {"reputation": 543, "user_id": 3631482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/K2wBD.jpg?s=128&g=1", "display_name": "Jeanjean", "link": "https://stackoverflow.com/users/3631482/jeanjean"}, "edited": false, "score": 0, "creation_date": 1493799349, "post_id": 43754624, "comment_id": 74550727, "body": "Peh, thank your for your answer. This solution &quot;annoys&quot; me a bit. Actually, I need to do this on a file that contains approximatly 100 columns... Is there any other solution available to make the code look a bit lighter?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 543, "user_id": 3631482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/K2wBD.jpg?s=128&g=1", "display_name": "Jeanjean", "link": "https://stackoverflow.com/users/3631482/jeanjean"}, "edited": false, "score": 0, "creation_date": 1493800620, "post_id": 43754624, "comment_id": 74551492, "body": "Reading the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193593.aspx\" rel=\"nofollow noreferrer\">references</a> it looks like <code>FieldInfo:=Array(Array(3, 2))</code> should work as well on <code>DataType:=xlDelimited</code> but somehow it doesn&#39;t. So I only see the chance to dynamically create that huge array."}, {"owner": {"reputation": 543, "user_id": 3631482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/K2wBD.jpg?s=128&g=1", "display_name": "Jeanjean", "link": "https://stackoverflow.com/users/3631482/jeanjean"}, "edited": false, "score": 0, "creation_date": 1493801031, "post_id": 43754624, "comment_id": 74551727, "body": "Thanks, I&#39;ll try this later on when I&#39;ll have some time. I hope the code won&#39;t become too slow. I&#39;ll let you know how it works or if I find any other solution in the meantime. See you :)"}, {"owner": {"reputation": 543, "user_id": 3631482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/K2wBD.jpg?s=128&g=1", "display_name": "Jeanjean", "link": "https://stackoverflow.com/users/3631482/jeanjean"}, "edited": false, "score": 0, "creation_date": 1493972602, "post_id": 43754624, "comment_id": 74639692, "body": "hi, thanks for your help. I&#39;ve done the ugliest thing, with a huge array (163 columns haha). It works, but i&#39;d like to do something better... I read I could do this dyncamically instead of repeating Array(1, 1), Array (2, 1) etc. Do I have to inspire myself from tutorial like this to generate a dynamic array? <a href=\"http://www.excel-easy.com/vba/examples/dynamic-array.html\" rel=\"nofollow noreferrer\">excel-easy.com/vba/examples/dynamic-array.html</a> Thxxxx !"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 543, "user_id": 3631482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/K2wBD.jpg?s=128&g=1", "display_name": "Jeanjean", "link": "https://stackoverflow.com/users/3631482/jeanjean"}, "edited": false, "score": 0, "creation_date": 1493976375, "post_id": 43754624, "comment_id": 74641991, "body": "@Jean-FIC I added an example how you would dynamically create an array for the Fieldinfo"}, {"owner": {"reputation": 543, "user_id": 3631482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/K2wBD.jpg?s=128&g=1", "display_name": "Jeanjean", "link": "https://stackoverflow.com/users/3631482/jeanjean"}, "edited": false, "score": 0, "creation_date": 1493991609, "post_id": 43754624, "comment_id": 74651866, "body": "Thanks! I&#39;m going to read this during the w-e :) Have a great day"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1493976336, "last_edit_date": 1493976336, "creation_date": 1493799155, "answer_id": 43754624, "question_id": 43753585, "link": "https://stackoverflow.com/questions/43753585/vba-data-conversion-texte-format/43754624#43754624", "title": "VBA Data conversion texte format", "body": "<p>As your macro recorder shows you need to specify</p>\n\n<pre><code>FieldInfo:=Array(Array(1, 1), Array(2, 1), Array(3, 2), Array(4, 1))\n</code></pre>\n\n<p>One array for each column.</p>\n\n<blockquote>\n  <p>When the data is delimited, this argument is an array of two-element arrays, with each two-element array specifying the conversion options for a particular column. The first element is the column number (1-based), and the second element is one of the xlColumnDataType constants specifying how the column is parsed.</p>\n</blockquote>\n\n<hr>\n\n<p>Here is an example how to generate an array for FieldInfo dynamically:<br>\nFirst we need to determine how many columns we need. We do this by counting the semicolons.</p>\n\n<pre><code>Sub GeneraterFieldInfoArrayExample()\n    Const cDelimiter As String = \";\"\n\n    Dim str As String\n    str = \"30/09/2016;Josh;005421;17\" 'replace with representative data, something like ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A6\").Value\n\n    Dim countCols As Long\n    countCols = Len(str) - Len(Replace(str, cDelimiter, \"\")) + 1 'determine how many columns are needed by counting semicolons. Afterwards we build the array.\n\n    Dim arrFieldInfo() As Variant\n    ReDim arrFieldInfo(countCols - 1) As Variant 'resize array\n\n    Dim iCol As Long\n    For iCol = 1 To countCols 'generate array for each column\n        Select Case iCol\n            Case 3, 10 'format column 3 and 10 as text\n                arrFieldInfo(iCol - 1) = Array(iCol, 2)\n            Case Else 'format any other columns as default\n                arrFieldInfo(iCol - 1) = Array(iCol, 1)\n        End Select\n    Next iCol\n\n    'use like: Fieldinfo:=arrFieldInfo()\nEnd Sub\n</code></pre>\n\n<p>In the first case all columns which have to be formatted as text ar listed. All other columns become default format. You can add additional cases on your needs.</p>\n"}], "owner": {"reputation": 543, "user_id": 3631482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/K2wBD.jpg?s=128&g=1", "display_name": "Jeanjean", "link": "https://stackoverflow.com/users/3631482/jeanjean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 43754624, "answer_count": 1, "score": 1, "last_activity_date": 1493976336, "creation_date": 1493795887, "last_edit_date": 1493798724, "question_id": 43753585, "link": "https://stackoverflow.com/questions/43753585/vba-data-conversion-texte-format", "title": "VBA Data conversion texte format", "body": "<p>I'm trying to convert datas:</p>\n\n<pre><code>Date;Employee;Ticket number;Table number\n30/09/2016;Josh;005421;17\n30/09/2016;Annie;004412;25\n30/09/2016;John;001124;12\n</code></pre>\n\n<p>I need to change the format of my third column, otherwise i'll lose the \"zeros\".</p>\n\n<p>Expected result :</p>\n\n<p><a href=\"https://i.stack.imgur.com/FyOsG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FyOsG.png\" alt=\"Expected result\"></a></p>\n\n<p>My code is the following :</p>\n\n<pre><code> Range(\"A6:A1048576\").TextToColumns Destination:=Range(\"A6\"), DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, Semicolon:=True, Fieldinfo:=Array(Array(3,2))\n</code></pre>\n\n<p>The problem is that the format changes on the FIRST column with my code, not the third. I don't understand why.</p>\n\n<p>The problem gotta be here :</p>\n\n<pre><code> Fieldinfo:=Array(Array(3,2))\n</code></pre>\n\n<p>I recorded the process with the macro editor : \n<a href=\"https://i.stack.imgur.com/Kiox7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Kiox7.png\" alt=\"Format text for col 3\"></a></p>\n\n<pre><code>Sub Macro1()\n    '\n    ' Macro1 Macro\n    '\n\n    '\n    Columns(\"A:A\").Select\n    Selection.TextToColumns Destination:=Range(\"A1\"), DataType:=xlDelimited, _\n        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n        Semicolon:=True, Comma:=False, Space:=False, Other:=False, FieldInfo _\n        :=Array(Array(1, 1), Array(2, 1), Array(3, 2), Array(4, 1)), TrailingMinusNumbers:= _\n        True\n    Range(\"B6\").Select\nEnd Sub\n</code></pre>\n\n<p>My code looks similar to the macro editor. Therefore, I don't get why I don't get the expected result.</p>\n\n<p>Could you please give me a hand?</p>\n\n<p>Thanks and have a great day</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1493794428, "post_id": 43753060, "comment_id": 74547828, "body": "What is the value of <code>rowCount</code> just before the <code>For</code> loop?"}, {"owner": {"reputation": 17, "user_id": 7601767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57a7d7e0f94feee521fc91dd4b9a6f10?s=128&d=identicon&r=PG&f=1", "display_name": "Yeongjoon Jang", "link": "https://stackoverflow.com/users/7601767/yeongjoon-jang"}, "edited": false, "score": 0, "creation_date": 1493794832, "post_id": 43753060, "comment_id": 74548057, "body": "I tried MsgBox rowCount and it shows 22."}, {"owner": {"reputation": 17, "user_id": 7601767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57a7d7e0f94feee521fc91dd4b9a6f10?s=128&d=identicon&r=PG&f=1", "display_name": "Yeongjoon Jang", "link": "https://stackoverflow.com/users/7601767/yeongjoon-jang"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1493794900, "post_id": 43753060, "comment_id": 74548086, "body": "@Peh But then why the previous two statements worked? This is very strange to me. I really appreciate your advice!"}], "answers": [{"comments": [{"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1493795398, "post_id": 43753329, "comment_id": 74548315, "body": "Worth mentioning, if this is intentional but you want to go from 24 to 22 (24,23,22) then the OP should use <code>For currentRow = 22 To 24 Step -1</code>"}, {"owner": {"reputation": 17, "user_id": 7601767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57a7d7e0f94feee521fc91dd4b9a6f10?s=128&d=identicon&r=PG&f=1", "display_name": "Yeongjoon Jang", "link": "https://stackoverflow.com/users/7601767/yeongjoon-jang"}, "edited": false, "score": 0, "creation_date": 1493795426, "post_id": 43753329, "comment_id": 74548337, "body": "I might have answered you wrong. What I am trying to do is enter data from D24 to D42. But I want this script to find the empty cells in that range to enter the input."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 2, "last_activity_date": 1493795537, "last_edit_date": 1493795537, "creation_date": 1493795139, "answer_id": 43753329, "question_id": 43753060, "link": "https://stackoverflow.com/questions/43753060/for-loop-being-skipped-without-any-cause-in-vba/43753329#43753329", "title": "For loop being skipped without any cause in VBA", "body": "<p>If <code>rowCount</code>, as per your clarifying comment, is 22 then your <code>For</code> loop becomes</p>\n\n<p><code>For currentRow = 24 To 22</code></p>\n\n<p>which is obviously a no-op, as there is no way 24 can count up to 22. If you need to count in the <em>direction</em> of the final number then you could use something like</p>\n\n<pre><code>For currentRow = 24 To rowCount Step Iif(rowCount - 24 &lt; 0, -1, +1)\n</code></pre>\n\n<p>but is this really what you want to do? Also, start using <code>Long</code> types for row and column numbers, now that worksheets have more than 32767 rows, and use <code>Option Explicit</code> at the top of all modules to obviate annoying spontaneous variable creation.</p>\n"}], "owner": {"reputation": 17, "user_id": 7601767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57a7d7e0f94feee521fc91dd4b9a6f10?s=128&d=identicon&r=PG&f=1", "display_name": "Yeongjoon Jang", "link": "https://stackoverflow.com/users/7601767/yeongjoon-jang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 415, "favorite_count": 0, "accepted_answer_id": 43753329, "answer_count": 1, "score": 0, "last_activity_date": 1493795537, "creation_date": 1493794241, "last_edit_date": 1495540030, "question_id": 43753060, "link": "https://stackoverflow.com/questions/43753060/for-loop-being-skipped-without-any-cause-in-vba", "title": "For loop being skipped without any cause in VBA", "body": "<p><strong>Problem:</strong> After <code>For currentRow = 25 To rowCount</code>, the rest of the for statement keeps getting skipped for no cause.</p>\n\n<p>I have two other For statements that comes before this problematic block of codes and their formats are the same as this and both work fine.</p>\n\n<pre><code>Public Sub WeightB()\n    Dim sourceCol As Integer, rowCount As Integer, currentRow As Integer\n    Dim currentRowValue As String\n\n    sourceCol = 7\n    rowCount = Cells(Rows.Count, sourceCol).End(xlUp).Row\n\n    For currentRow = 24 To rowCount\n        currentRowValue = Cells(currentRow, sourceCol).Value\n        If IsEmpty(currentRowValue) Or currentRowValue = \"\" Then\n            Cells(currentRow, sourceCol).Select\n            Exit For\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>I have referred <a href=\"https://stackoverflow.com/questions/26356572/for-loops-being-skipped-without-cause-in-vba\">For loops being skipped without cause in VBA</a> and still haven't been able to figure this out.</p>\n"}, {"tags": ["c++", "vba", "matrix", "dll", "safearray"], "answers": [{"comments": [{"owner": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "edited": false, "score": 0, "creation_date": 1493878907, "post_id": 43759141, "comment_id": 74591308, "body": "Sorry about the _stdcall -&gt; __stdcall , I&#39;m still learning. First of all thanks a lot, you opened my mind with some very short inputs that were however very clear. I now see actual data in VBA. I do have one small problem though: the <code>out</code> array is bidimensional, and if I use <code>double *out</code> and fill out as <code>out[i * columns + j]</code> I get lots of elements of <code>out</code> that are zeroes. If I instead work with <code>double **out</code> and fill it as <code>out[i][j]</code>, which would be ideal for me, I get a data write failure."}, {"owner": {"reputation": 300, "user_id": 1978495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ccacccf34d5d2a9c0668b3b734bb09f?s=128&d=identicon&r=PG", "display_name": "drgs", "link": "https://stackoverflow.com/users/1978495/drgs"}, "reply_to_user": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "edited": false, "score": 1, "creation_date": 1493903970, "post_id": 43759141, "comment_id": 74608408, "body": "Hmm, <code>i*columns+j</code> approach should work.  You can try to cast <code>out</code> as 2-dim: <code>double (*newout)[N] = (double (*)[N])out;</code>, where N is width/number of columns, and then <code>newout[i][j]</code> etc."}], "tags": [], "owner": {"reputation": 300, "user_id": 1978495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ccacccf34d5d2a9c0668b3b734bb09f?s=128&d=identicon&r=PG", "display_name": "drgs", "link": "https://stackoverflow.com/users/1978495/drgs"}, "is_accepted": true, "score": 1, "last_activity_date": 1493811896, "creation_date": 1493811896, "answer_id": 43759141, "question_id": 43752915, "link": "https://stackoverflow.com/questions/43752915/passing-a-safearray-variant-to-vba-from-a-c-dll/43759141#43759141", "title": "Passing a SAFEARRAY variant to vba from a c++ dll", "body": "<p>How do you free memory afterwards if its allocated by a single function call in C++?</p>\n\n<p>I would have done it the other way; declared and dim'ed the arrays in VBA and then passed pointer to array data to your C++ function, which then fills it up with values.</p>\n\n<p>(Btw, I think its __stdcall with two underscores.)</p>\n\n<pre><code>void __stdcall fillarray(const int n, double *out) {\n    for (int i = 0; i &lt; n; ++i) {\n        out[i] = i;\n    }\n}\n</code></pre>\n\n<p>And then</p>\n\n<pre><code>Public Declare PtrSafe Sub fillarray Lib \"Mypath/MyFile.dll\" (ByVal n As Long, ByRef out As Double)\n\nDim A() as Double\nRedim A(1 to 100)\nfillarray 100, A(1)   'A(1) first element pointing to data\n</code></pre>\n"}], "owner": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 846, "favorite_count": 0, "accepted_answer_id": 43759141, "answer_count": 1, "score": 0, "last_activity_date": 1493878942, "creation_date": 1493793815, "last_edit_date": 1493878942, "question_id": 43752915, "link": "https://stackoverflow.com/questions/43752915/passing-a-safearray-variant-to-vba-from-a-c-dll", "title": "Passing a SAFEARRAY variant to vba from a c++ dll", "body": "<p>I have in a DLL the following code, which is supposed to take some input from a routine written in VBA, do some stuff with it, and return <strong>two 2D-arrays</strong> back (so a function is not really doable, besides, if I wanted to return an array containing the other two, I'd have to face code-optimization problems in VBA), which can be accessed from VBA.\nWithout further ado, the code looks like this:</p>\n\n<pre><code>void _stdcall MySub(VARIANT RealCo, VARIANT ImagCo, VARIANT RealCr, VARIANT ImagCr, ULONG PointsTheta, ULONG PointsPhi, double Res, VARIANT CoPol, VARIANT CrPol)\n{\n\n/* Do my stuff here, and at the end produces the following arrays */\n\nCoPol.vt = VT_ARRAY | VT_VARIANT;\nCrPol.vt = VT_ARRAY | VT_VARIANT;\nsab2[1].lLbound = 0; sab2[1].cElements = 360;\nsab2[0].lLbound = 0; sab2[0].cElements = 360;\nCoPol.parray = SafeArrayCreate(VT_VARIANT, 2, sab2);\nCrPol.parray = SafeArrayCreate(VT_VARIANT, 2, sab2);\n\n/* Those arrays are then stuffed with data */\n\n}\n</code></pre>\n\n<p>Which I call from VBA as follows:</p>\n\n<pre><code>Private Declare Sub MySub Lib \"Mypath/MyFile.dll\" ( _\n        ByVal RealCo As Variant, _\n        ByVal ImagCo As Variant, _\n        ByVal RealCr As Variant, _\n        ByVal ImagCr As Variant, _\n        ByVal PointsTheta As Long, _\n        ByVal PointsPhi As Long, _\n        ByVal Res As Double, _\n        ByVal CoPol As Variant, _\n        ByVal CrPol As Variant)\n\nDim CoPol As Variant, CrPol As Variant\n\n' [...]\n\nMySub CVar(RealCo), CVar(ImagCo), CVar(RealCr), CVar(ImagCr), PointsTheta, PointsPhi, Resolution, CoPol, CrPol\n</code></pre>\n\n<p><code>CVar</code>is because the input arrays <code>RealCo</code>, <code>RealCr</code>, <code>ImagCo</code>, <code>ImagCr</code> are actually <code>Single</code> type in VBA.</p>\n\n<p>It works, but my problem is the following: as I move from the last <code>}</code> in C++ to VBA, the content of <code>CoPol</code> and <code>CrPol</code> (which are the two matrices I would like to use further in the VBA code) disappears.</p>\n\n<p>Notice that I can actually debug the code and check that <code>CoPol</code> and <code>CrPol</code> do contain data. I tried to pass them to another subroutine in C++, and since it didn't work as well, I came out with the solution of passing them via <strong>reference</strong>:</p>\n\n<pre><code>void _stdcall MySub(VARIANT RealCo, VARIANT ImagCo, VARIANT RealCr, VARIANT ImagCr, ULONG PointsTheta, ULONG PointsPhi, double Res, VARIANT &amp;CoPol, VARIANT &amp;CrPol)\n</code></pre>\n\n<p>This solved my problem <em>inside C++</em> but not between C++ and VBA. I also tried giving back pointers to the VARIANTS, and calling the needed arrays <code>ByRef</code> and <code>As Long</code>, but it doesn't work (<code>CoPol</code> and <code>CrPol</code> are then in VBA just a <code>Long</code> number, which I can't work with).</p>\n\n<p>What should I write in order to make VBA able to access the values inside the matrix built in C++?</p>\n\n<p>EDIT: if you want to downvote, at least explain why.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1493798179, "post_id": 43752816, "comment_id": 74550033, "body": "Could you not just use <code>Private Sub Workbook_SheetActivate(ByVal Sh As Object)</code> in the <code>ThisWorkbook</code> module?  It will fire on all sheets."}, {"owner": {"reputation": 161, "user_id": 7955781, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c04d43b2ea06ddeb392897f5834a7869?s=128&d=identicon&r=PG&f=1", "display_name": "C. Henke", "link": "https://stackoverflow.com/users/7955781/c-henke"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1493799114, "post_id": 43752816, "comment_id": 74550576, "body": "So i should add the sub to the <code>ThisWorkbook</code>module? With what effect?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1493799391, "post_id": 43752816, "comment_id": 74550758, "body": "Without knowing the full reason for adding the code after the project is finished I assume you want to run <code>RefreshRibbon</code> whenever a sheet is activated even if the sheet is added at run-time. <code>Workbook_SheetActive</code> will fire whenever any sheet in the workbook is activated.  If you want it to fire only on new sheets add a <code>Select Case</code> statement to ignore any specific sheets."}, {"owner": {"reputation": 161, "user_id": 7955781, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c04d43b2ea06ddeb392897f5834a7869?s=128&d=identicon&r=PG&f=1", "display_name": "C. Henke", "link": "https://stackoverflow.com/users/7955781/c-henke"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1493799870, "post_id": 43752816, "comment_id": 74551042, "body": "I think i need to re-ask the question:  I have got a file which is protected by a password. With this file i want to create another file by adding code. This does not work because my file is protected by a password. So i was thinking to crack the password and then create the other file."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1493805290, "post_id": 43752816, "comment_id": 74554774, "body": "I find it hard to believe that, in a security-conscious environment, where you password-protect workbooks, worksheets and code (in the vain hope that your data are protected against anything but accidental viewing) people would give you access to the VBA project, which entails the very real risk that hackers take control of your entire system and install whatever they like. I urge you to consider the implications of allowing access to the VBA project for the purpose of enhancing security. It does the opposite."}], "owner": {"reputation": 161, "user_id": 7955781, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c04d43b2ea06ddeb392897f5834a7869?s=128&d=identicon&r=PG&f=1", "display_name": "C. Henke", "link": "https://stackoverflow.com/users/7955781/c-henke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1493793783, "creation_date": 1493793548, "last_edit_date": 1592644375, "question_id": 43752816, "link": "https://stackoverflow.com/questions/43752816/protected-vba-code-way-to-write-own-code-without-manually-entering-a-password", "title": "Protected VBA Code - Way to write own Code without manually entering a password", "body": "<p>I am currently  working on a VBA-Project where I want to protect the Code with a password.</p>\n<p>Furthermore, I want to use the following lines of code:</p>\n<pre><code>Public Sub main()\n\n'Dim CodeModuleSoure As Variant\nDim CodeModuleDestination As Variant\n\n\nWith Application.VBE.ActiveVBProject.VBComponents\n'Set CodeModuleSoure = Nothing\nSet CodeModuleDestination = .Item(.Count)\nCodeModuleDestination.codemodule.addfromstring &quot;Private Sub Worksheet_Activate()&quot; _\n                                                &amp; vbCrLf &amp; &quot;Call RefreshRibbon&quot; _\n                                                &amp; vbCrLf &amp; &quot;End Sub&quot;\nEnd With\n\nEnd Sub\n</code></pre>\n<p>This basically adds</p>\n<pre><code>Private Sub Worksheet_Activate()\nCall RefreshRibbon\nEnd Sub\n</code></pre>\n<p>to the code.</p>\n<p>As this does not work while the project is still protected I had a &quot;little&quot; research and found this: <a href=\"https://stackoverflow.com/questions/1026483/is-there-a-way-to-crack-the-password-on-an-excel-vba-project\" title=\"Crack Password for VBA\">Is there a way to crack the password on an Excel VBA Project</a></p>\n<p>Lastly I created a function where I first call the &quot;crack&quot; and then the &quot;code-writer&quot;:</p>\n<pre><code>Sub otherfuncts()\nunprotected\nCall Sheet4.main\nEnd Sub\n</code></pre>\n<p>When I try to run the otherfuncts function with a Button it gives me this Error:\n<a href=\"https://i.stack.imgur.com/8IEKW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8IEKW.png\" alt=\"Error\" /></a></p>\n<p>If  I open the VBA-Project it actually is &quot;cracked&quot; and if I rerun the code after viewing the Project the button does not give me an error. Is there a solution that it works in the first try?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1493793652, "post_id": 43752758, "comment_id": 74547440, "body": "Having a look at the Microsoft References <a href=\"https://msdn.microsoft.com/en-us/library/office/ff841185.aspx\" rel=\"nofollow noreferrer\">Workbook.SaveAs Method (Excel)</a> should help a lot."}], "answers": [{"tags": [], "owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "is_accepted": false, "score": 0, "last_activity_date": 1493808914, "last_edit_date": 1592644375, "creation_date": 1493808914, "answer_id": 43758036, "question_id": 43752758, "link": "https://stackoverflow.com/questions/43752758/vba-to-create-password-protected-file/43758036#43758036", "title": "VBA to create password protected file", "body": "<p>If you look at the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff841185.aspx\" rel=\"nofollow noreferrer\">documentation</a> you will see there are two password arguments for the <code>SaveAs</code> command</p>\n<pre><code>ws1.SaveAs FileName:=Sheet1.Range(&quot;V3&quot;).Value &amp; filen &amp; &quot;.xlsx&quot;, _\n           Password:=&quot;yourpassword&quot;, _                                \n           WriteResPassword:=&quot;yourreadonlypassword&quot;\n</code></pre>\n<p>The difference in these two password arguments is explained in the docs:</p>\n<blockquote>\n<p><strong><code>Password</code></strong>: A case-sensitive string (no more than 15 characters) that indicates the protection password to be given to the file.</p>\n<p><strong><code>WriteResPassword</code></strong>: A string that indicates the write-reservation password for this file. If a file is saved with the password and the password isn't supplied when the file is opened, the file is opened as read-only.</p>\n</blockquote>\n"}], "owner": {"reputation": 159, "user_id": 5179321, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1ec2c077f8c8bcb3d8313897477a568c?s=128&d=identicon&r=PG&f=1", "display_name": "Gaus Shaikh", "link": "https://stackoverflow.com/users/5179321/gaus-shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2077, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493808914, "creation_date": 1493793363, "last_edit_date": 1531164843, "question_id": 43752758, "link": "https://stackoverflow.com/questions/43752758/vba-to-create-password-protected-file", "title": "VBA to create password protected file", "body": "<p>With the below coding, I am able to create a copy of password protected file. But I also want to put the password in newly created file.\nHow can I add password while creating new excel workbook.</p>\n\n<pre><code>Workbooks.Open Filename:=myFileNameDir, Password:=\"yourpassword\", UpdateLinks:=0\nSet ws1 = Worksheets(\"OJT Plan\")\nws1.Activate\nfilen = TextBox3.Text &amp; \"_\" &amp; TextBox59 &amp; \"_\" &amp; VBA.Format(Now, \"MMddyyyyhmmss AM/PM \")\nws1.SaveAs Sheet1.Range(\"V3\").Value &amp; filen &amp; \".xlsx\"\nWorksheets.Add(after:=Worksheets(Worksheets.Count)).Name = \"Details\"\nSet ws13 = Worksheets(\"Details\")\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "runtime-error"], "comments": [{"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 1, "creation_date": 1493794260, "post_id": 43752716, "comment_id": 74547746, "body": "What is the question?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1493814113, "post_id": 43752716, "comment_id": 74560917, "body": "You don&#39;t need a loop to check one table row of values. And does <i>Menu</i> have any <code>OnOpen</code> or <code>OnLoad</code> events? Check also its reocordsource."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1493844526, "post_id": 43752716, "comment_id": 74580877, "body": "Why passing recordset object? Think I would use a DLookup() instead."}, {"owner": {"reputation": 17, "user_id": 5908472, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-onyPYCqh0SM/AAAAAAAAAAI/AAAAAAAAAEA/yIeATGP7sCQ/photo.jpg?sz=128", "display_name": "Marcus Mackaku", "link": "https://stackoverflow.com/users/5908472/marcus-mackaku"}, "edited": false, "score": 0, "creation_date": 1493877105, "post_id": 43752716, "comment_id": 74590470, "body": "I am new to VBA, June, so my coding won&#39;t be tops. Have not heard of DLookup(). The recordset object was all I found when checking how to find table row values."}, {"owner": {"reputation": 17, "user_id": 5908472, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-onyPYCqh0SM/AAAAAAAAAAI/AAAAAAAAAEA/yIeATGP7sCQ/photo.jpg?sz=128", "display_name": "Marcus Mackaku", "link": "https://stackoverflow.com/users/5908472/marcus-mackaku"}, "edited": false, "score": 0, "creation_date": 1493900758, "post_id": 43752716, "comment_id": 74605891, "body": "Recordset object because I am  looping through the table."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 5908472, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-onyPYCqh0SM/AAAAAAAAAAI/AAAAAAAAAEA/yIeATGP7sCQ/photo.jpg?sz=128", "display_name": "Marcus Mackaku", "link": "https://stackoverflow.com/users/5908472/marcus-mackaku"}, "edited": false, "score": 0, "creation_date": 1493885374, "post_id": 43769872, "comment_id": 74595294, "body": "Kostas I looked up parameterized query and found it has to do with the SQL Server which I am not using. Does it require the SQL Server?"}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 17, "user_id": 5908472, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-onyPYCqh0SM/AAAAAAAAAAI/AAAAAAAAAEA/yIeATGP7sCQ/photo.jpg?sz=128", "display_name": "Marcus Mackaku", "link": "https://stackoverflow.com/users/5908472/marcus-mackaku"}, "edited": false, "score": 0, "creation_date": 1493885474, "post_id": 43769872, "comment_id": 74595349, "body": "It&#39;s a simple query in ms-access. Just create the query and paste the SQL provided."}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 17, "user_id": 5908472, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-onyPYCqh0SM/AAAAAAAAAAI/AAAAAAAAAEA/yIeATGP7sCQ/photo.jpg?sz=128", "display_name": "Marcus Mackaku", "link": "https://stackoverflow.com/users/5908472/marcus-mackaku"}, "edited": false, "score": 0, "creation_date": 1493887122, "post_id": 43769872, "comment_id": 74596310, "body": "@Marcus Mackaku Dont forget to change the &quot;YOUR_TABLE_NAME&quot; to the actual name of your table."}], "tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": true, "score": 0, "last_activity_date": 1493844954, "creation_date": 1493844954, "answer_id": 43769872, "question_id": 43752716, "link": "https://stackoverflow.com/questions/43752716/the-openform-was-cancelled-error-has-reoccurred/43769872#43769872", "title": "The OpenForm was cancelled error has reoccurred", "body": "<p>Create a parameterized query with the following SQL:</p>\n\n<pre><code>PARAMETERS [prmUserId] Text ( 255 ), [prmPassword] Text ( 255 );\nSELECT User_ID, Password \nFROM YOUR_TABLE_NAME\nWHERE ((([User_ID])=[prmUserId]) AND (([Password])=[prmPassword]));\n</code></pre>\n\n<p>Assuming the code is behind the Login Form:</p>\n\n<pre><code>Private Sub Login(ByVal PERSAL As String, ByVal Password As String)\n    On Error GoTo Login_ErrHandler\n\n    Dim qdf As DAO.QueryDef\n    Set qdf = CurrentDb().QueryDefs(\"YourQueryName\") 'Change to your query name\n        qdf.Parameters(\"[prmUserId]\").Value = PERSAL\n        qdf.Parameters(\"[prmPassword]\").Value = Password\n\n    Dim rs As DAO.recordSet\n    Set rs = qdf.OpenRecordset()\n\n    'No records\n    If rs.EOF Then\n        MsgBox \"Your credentials are incorrect or you are not registered.\"\n        Me.txtUser_ID.SetFocus\n        GoTo Leave\n    End If\n\n    'User found\n\n    'Close Login Form\n    DoCmd.Close acForm, Me.Name, acSavePrompt\n\n    'Open Form\n    DoCmd.OpenForm \"Menu\", acNormal, , , acFormPropertySettings, acWindowNormal\n\nLeave:\n    On Error Resume Next\n        rs.Close\n    Set rs = Nothing\n        qdf.Close\n    Set qdf = Nothing\n    On Error GoTo 0\n    Exit Sub\n\nLogin_ErrHandler:\n    MsgBox Err.Number &amp; \" - \" &amp; Err.Description, vbCritical\n    Resume Leave\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 5908472, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-onyPYCqh0SM/AAAAAAAAAAI/AAAAAAAAAEA/yIeATGP7sCQ/photo.jpg?sz=128", "display_name": "Marcus Mackaku", "link": "https://stackoverflow.com/users/5908472/marcus-mackaku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 43769872, "answer_count": 1, "score": 0, "last_activity_date": 1493844954, "creation_date": 1493793222, "last_edit_date": 1493799264, "question_id": 43752716, "link": "https://stackoverflow.com/questions/43752716/the-openform-was-cancelled-error-has-reoccurred", "title": "The OpenForm was cancelled error has reoccurred", "body": "<p>The OpenForm has reoccurred in my application. I have decompiled/compact and repaired twice.</p>\n\n<p>Code throwing error:\n    'Open Menu form\n    DoCmd.OpenForm \"Menu\", acNormal, , , , acWindowNormal</p>\n\n<p>The first time I encountered this error, I solved it by changing:</p>\n\n<pre><code>DoCmd.OpenForm \"Menu\", acNormal, \"\", \"\", , acNormal\n</code></pre>\n\n<p>to </p>\n\n<pre><code>DoCmd.OpenForm \"Menu\", acNormal, , , , acWindowNormal.\n</code></pre>\n\n<p>This is my procedure that suffers the exception:</p>\n\n<pre><code>Private Sub Login(recordSet As DAO.recordSet, PERSAL As String, Password As String)\nOn Error GoTo Login_ErrHandler\n\n'Check to see if the recordset actually contains rows\nIf Not (recordSet.EOF And recordSet.BOF) Then\n    recordSet.MoveFirst 'Unnecessary in this case, but still a good habit\n\n    'See if credentials match data\n    Do\n        If (recordSet!User_ID = PERSAL And recordSet!Password = Password) Then\n\n           'Open Menu form\n            DoCmd.OpenForm \"Menu\"\n           ' Form_Menu.op\n\n            recordSet.Close 'Close the recordset\n            Set recordSet = Nothing 'Clean up\n\n            'Close Login form\n            DoCmd.Close acForm, \"Login\"\n\n            Exit Do\n        End If\n\n        recordSet.MoveNext\n\n        If (recordSet.EOF Or recordSet.BOF) Then\n            MsgBox \"Your credentials are incorrect or you are not registered.\"\n\n            Exit Do\n        End If\n    Loop\n\n    'Match the values entered for PERSAL nr. and password fields with a row in User table\n\nElse\n\n    MsgBox \"There are no records in the recordset.\"\n\n     recordSet.Close 'Close the recordset\n     Set recordSet = Nothing 'Clean up\n\nEnd If\n\nForm_Login.txtUser_ID.SetFocus\n\nLogin_ErrHandler:\nIf Err = 2501 Then\n    'MsgBox \"No data to display\"\n    DoCmd.Hourglass False\n    Resume Login_ErrHandler\n' Else\n\n '   MsgBox Err.Description, vbCritical\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>How do I fix this error this time around?</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1493790896, "post_id": 43752038, "comment_id": 74546182, "body": "it should fail on <code>Set oWS = oExcel.Worksheets(2)</code> , since it needs to be <code>Set oWS = oWB.Worksheets(2)</code>. what happens if you try <code>Dim oWB As Excel.Workbook</code> ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3259999"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1493791203, "post_id": 43752038, "comment_id": 74546293, "body": "Well, I get problem before that line, when I try to load workbook."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3259999"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1493791671, "post_id": 43752038, "comment_id": 74546511, "body": "thank you, I will try Dim oWB as Excel.Workbook  since it is remote computer I have no access now, but I will post result later."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1493793177, "post_id": 43752038, "comment_id": 74547220, "body": "I&#39;m guessing this is running in Word ?  It&#39;s not completely clear in the question..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1493793279, "post_id": 43752038, "comment_id": 74547267, "body": "Does the problem PC have &quot;hide extenstions for know file types&quot; turned on, and is the filename really &quot;myFile.xls.xls&quot;  ?  Just a guess...   What is the result of <code>Dir(&quot;C:\\myFile.xls&quot;)</code> ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3259999"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1493793597, "post_id": 43752038, "comment_id": 74547406, "body": "@TimWilliams Yes, it is running in Word, sorry, I forgot to mention in question. I remember it had no extension on excel files, maybe could that be really reason?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3259999"}, "edited": false, "score": 0, "creation_date": 1493793886, "post_id": 43752038, "comment_id": 74547556, "body": "ok, I just tested without extensions on my PC and it still works here in both cases."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3259999"}, "edited": false, "score": 0, "creation_date": 1493794084, "post_id": 43752038, "comment_id": 74547642, "body": "I tested also on wrong file/directory names and then another error was come, so I am sure file name and path are ok."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user3259999"}, "is_accepted": false, "score": 0, "last_activity_date": 1493892317, "creation_date": 1493892317, "answer_id": 43779843, "question_id": 43752038, "link": "https://stackoverflow.com/questions/43752038/method-open-of-object-workbooks-failed/43779843#43779843", "title": "Method &#39;Open&#39; of object &#39;Workbooks&#39; failed", "body": "<p>thanks everyone.</p>\n\n<p>I found the solution, Foxit reader add-in in word was causing the trouble.\nonce removed everything worked.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3259999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 750, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493892317, "creation_date": 1493790718, "last_edit_date": 1493793648, "question_id": 43752038, "link": "https://stackoverflow.com/questions/43752038/method-open-of-object-workbooks-failed", "title": "Method &#39;Open&#39; of object &#39;Workbooks&#39; failed", "body": "<p>here is a very small piece of code.\nI tested and worked for office 03, 07, 10 versions without a problem.\nbut on one machine running Win7 and Office 2007 fails always on this line:</p>\n\n<pre><code>Set oWB = oExcel.Workbooks.Open(\"C:\\myFile.xls\")\n</code></pre>\n\n<blockquote>\n  <p>Method 'Open' of object 'Workbooks' failed</p>\n</blockquote>\n\n<p>what is the possible solution?\nP.S file is not damaged.</p>\n\n<pre><code>Dim oExcel As Excel.Application\nDim oWB As Workbook\nDim oWS As Worksheet\nDim rRng As Excel.Range\n\nApplication.ScreenUpdating = False\nSet oExcel = New Excel.Application\nSet oWB = oExcel.Workbooks.Open(\"C:\\myFile.xls\")\nSet oWS = oExcel.Worksheets(2)\nSet rRng = oWS.Range(\"C01:C500\")\noExcel.Visible = False\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 7892746, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/41310627d746b07402b15829c958043e?s=128&d=identicon&r=PG&f=1", "display_name": "mmaz", "link": "https://stackoverflow.com/users/7892746/mmaz"}, "edited": false, "score": 0, "creation_date": 1493793409, "post_id": 43752250, "comment_id": 74547325, "body": "Hi, I am sorry as i am very new to VBA. I&#39;ve tried but then it displays error on line <code>x.Worksheets(&quot;week10_a1&quot;).Range(&quot;A9&quot;).CurrentRegion.Select</code>.  The error is Run-time error &#39;1004&#39;: Select method of Range class failed."}, {"owner": {"reputation": 73, "user_id": 6317286, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0eb14d21db55617a98fbc4fee25fc92c?s=128&d=identicon&r=PG&f=1", "display_name": "Xzsh4s575sf75", "link": "https://stackoverflow.com/users/6317286/xzsh4s575sf75"}, "reply_to_user": {"reputation": 45, "user_id": 7892746, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/41310627d746b07402b15829c958043e?s=128&d=identicon&r=PG&f=1", "display_name": "mmaz", "link": "https://stackoverflow.com/users/7892746/mmaz"}, "edited": false, "score": 0, "creation_date": 1493794139, "post_id": 43752250, "comment_id": 74547675, "body": "@mmaz sorry, edited my answer. now it will select the table i saw on your screenshot. you can edit the range as you want."}, {"owner": {"reputation": 45, "user_id": 7892746, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/41310627d746b07402b15829c958043e?s=128&d=identicon&r=PG&f=1", "display_name": "mmaz", "link": "https://stackoverflow.com/users/7892746/mmaz"}, "edited": false, "score": 0, "creation_date": 1493804254, "post_id": 43752250, "comment_id": 74553988, "body": "It still displaying  error on  line &#39;x.Worksheets(&quot;week10_a1&quot;).Range(&quot;A9:G19&quot;).Select&#39;. However, my table size may not be constant every week so i cannot use Range(&quot;A9:G19&quot;). Is there any other way to solve this?"}, {"owner": {"reputation": 73, "user_id": 6317286, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0eb14d21db55617a98fbc4fee25fc92c?s=128&d=identicon&r=PG&f=1", "display_name": "Xzsh4s575sf75", "link": "https://stackoverflow.com/users/6317286/xzsh4s575sf75"}, "reply_to_user": {"reputation": 45, "user_id": 7892746, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/41310627d746b07402b15829c958043e?s=128&d=identicon&r=PG&f=1", "display_name": "mmaz", "link": "https://stackoverflow.com/users/7892746/mmaz"}, "edited": false, "score": 0, "creation_date": 1493811119, "post_id": 43752250, "comment_id": 74558686, "body": "@mmaz I used first line from your post so I expected it to work. Ok another update. Reading size of table is another question, you will have to create new question for that one."}], "tags": [], "owner": {"reputation": 73, "user_id": 6317286, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0eb14d21db55617a98fbc4fee25fc92c?s=128&d=identicon&r=PG&f=1", "display_name": "Xzsh4s575sf75", "link": "https://stackoverflow.com/users/6317286/xzsh4s575sf75"}, "is_accepted": false, "score": 0, "last_activity_date": 1493811176, "last_edit_date": 1493811176, "creation_date": 1493791589, "answer_id": 43752250, "question_id": 43751907, "link": "https://stackoverflow.com/questions/43751907/how-to-delete-a-column-of-a-table-after-pasting-it-from-another-workbook-automat/43752250#43752250", "title": "How to delete a column of a table after pasting it from another workbook automatically using VBA", "body": "<p>This code will select the region and exclude column F from selection and copy it. Once you paste it, it will remain without what was originally in column F.</p>\n\n<pre><code>Worksheets(\"week10_a1\").Range(\"A9:G19\").Select\nDim areaToCopy, cell As Range\nSet areaToCopy = Nothing\nFor Each cell In Selection\n  If Intersect(cell, Range(\"F:F\")) Is Nothing Then\n    If areaToCopy Is Nothing Then ' prevent Union to throw error\n      Set areaToCopy = cell\n    Else\n      Set areaToCopy = Union(areaToCopy, cell)\n    End If\n  End If\nNext cell\nareaToCopy.Copy\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 7892746, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/41310627d746b07402b15829c958043e?s=128&d=identicon&r=PG&f=1", "display_name": "mmaz", "link": "https://stackoverflow.com/users/7892746/mmaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493811176, "creation_date": 1493790173, "question_id": 43751907, "link": "https://stackoverflow.com/questions/43751907/how-to-delete-a-column-of-a-table-after-pasting-it-from-another-workbook-automat", "title": "How to delete a column of a table after pasting it from another workbook automatically using VBA", "body": "<p>I am currently copying a table from another workbook by using <strong><em>CurrentRegion</em></strong>, however, I do not need column F, but it would not work if I used <strong><em>CurrentRegion</em></strong> as it will take the whole table. Is there any way to copy the table without column F and shift the rest (which is column G) to left? I declare <strong>x</strong> as the source worksheet and <strong>y</strong> is the destination workbook.\n<code>x.Worksheets(\"week10_a1\").Range(\"A9\").CurrentRegion.Copy\ny.Worksheets(\"A1\").Range(\"E\" &amp; Rows.Count).End(xlUp).Offset(3).PasteSpecial xlPasteValues</code></p>\n\n<p>How do i delete column F of the table before pasting it to the destination workbook or how do i delete column J of the table after pasting it to the destination workbook without affecting the previous table in the destination workbook?\n<a href=\"https://i.stack.imgur.com/4MZ85.png\" rel=\"nofollow noreferrer\">Source workbook</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/l5ndj.png\" rel=\"nofollow noreferrer\">Destination workbook</a></p>\n"}, {"tags": ["vba", "email", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1493792276, "post_id": 43751850, "comment_id": 74546786, "body": "Is the email coming from a specific person? Or you want to save all the emails that&#39;s coming in?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1493849234, "post_id": 43751850, "comment_id": 74582963, "body": "also see <a href=\"https://meta.stackexchange.com/a/5235/289619\">meta.stackexchange.com/a/5235/289619</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1493794905, "creation_date": 1493794905, "answer_id": 43753248, "question_id": 43751850, "link": "https://stackoverflow.com/questions/43751850/trigger-a-macro-after-a-new-mail-is-received/43753248#43753248", "title": "Trigger a macro after a new mail is received", "body": "<p><em>Work with <strong><a href=\"https://msdn.microsoft.com/en-us/library/office/ff869298.aspx\" rel=\"nofollow noreferrer\">Application.Startup Event (Outlook)</a></strong> and <strong><a href=\"https://msdn.microsoft.com/en-us/library/office/ff869609.aspx\" rel=\"nofollow noreferrer\">Items.ItemAdd Event (Outlook)</a></em></strong></p>\n\n<blockquote>\n  <p><em><sub><strong><a href=\"https://msdn.microsoft.com/en-us/library/office/ff869609.aspx\" rel=\"nofollow noreferrer\">Items.ItemAdd Event (Outlook)</a></strong> Occurs when one or more items are added to the specified collection. This event does not run when a large number of items are added to the folder at once. This event is not available in Microsoft Visual Basic Scripting Edition (VBScript).</sub></em></p>\n  \n  <hr>\n  \n  <p><em><sub><strong><a href=\"https://msdn.microsoft.com/en-us/library/office/ff869298.aspx\" rel=\"nofollow noreferrer\">Application.Startup Event (Outlook)</a></strong> Occurs when Microsoft Outlook is starting, but after all add-in programs have been loaded. </sub></em></p>\n  \n  <hr>\n</blockquote>\n\n<p><em>Code Example</em></p>\n\n<pre><code>Private WithEvents Items As Outlook.Items\nPrivate Sub Application_Startup()\n    Dim olNs As Outlook.NameSpace\n    Dim Inbox  As Outlook.MAPIFolder\n\n    Set olNs = Application.GetNamespace(\"MAPI\")\n    Set Inbox = olNs.GetDefaultFolder(olFolderInbox)\n    Set Items = Inbox.Items\nEnd Sub\n\nPrivate Sub Items_ItemAdd(ByVal Item As Object)\n    Dim Folder As Outlook.MAPIFolder\n\n    If TypeOf Item Is Outlook.mailitem Then\n        Set Folder = Application.Session.PickFolder\n        If Folder Is Nothing Then Exit Sub\n        Item.Move Folder\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1493885415, "creation_date": 1493885415, "answer_id": 43777299, "question_id": 43751850, "link": "https://stackoverflow.com/questions/43751850/trigger-a-macro-after-a-new-mail-is-received/43777299#43777299", "title": "Trigger a macro after a new mail is received", "body": "<p>You can handle the <code>NewMailEx</code> event of the Application class which is fired when a new message arrives in the Inbox and before client rule processing occurs. You can use the Entry ID returned in the EntryIDCollection array to call the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869893.aspx\" rel=\"nofollow noreferrer\">NameSpace.GetItemFromID</a> method and process the item. Use this method with caution to minimize the impact on Outlook performance.</p>\n\n<p>Be aware, for users with an Exchange Server account (non-Cached Exchange Mode or Cached Exchange Mode), the event will fire only for messages that arrive at the server after Outlook has started. The event will not fire for messages that are synchronized in Cached Exchange Mode immediately after Outlook starts, nor for messages that are already on the server when Outlook starts in non-Cached Exchange Mode.</p>\n\n<p>Another possible option is to handle the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869609.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">ItemAdd</a> event of the <code>Items</code> class which is fired when one or more items are added to the specified collection. Be aware, this event does not run when a large number of items are added to the folder at once (more than 16 - this is a well-known issue in OOM).</p>\n\n<p>A better solution is to check for new items in the folder using the timer's event. Read more about possible solutions in the following articles:</p>\n\n<ul>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/10/03/outlook-newmail-event/\" rel=\"nofollow noreferrer\">Outlook NewMail event unleashed: the challenge (NewMail, NewMailEx, ItemAdd)</a></li>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/10/24/outlook-newmail-solution-options/\" rel=\"nofollow noreferrer\">Outlook NewMail event: solution options</a> </li>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/11/01/outlook-newmail-extended-mapi/\" rel=\"nofollow noreferrer\">Outlook NewMail event and Extended MAPI: C# example</a></li>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/11/10/outlook-newmail-custom-solution/\" rel=\"nofollow noreferrer\">Outlook NewMail unleashed: writing a working solution (C# example)</a></li>\n</ul>\n"}], "owner": {"reputation": 9, "user_id": 7955580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2704f071d365cfa941a4a0259692c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Nick S", "link": "https://stackoverflow.com/users/7955580/nick-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2461, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1593070521, "creation_date": 1493789956, "last_edit_date": 1593070521, "question_id": 43751850, "link": "https://stackoverflow.com/questions/43751850/trigger-a-macro-after-a-new-mail-is-received", "title": "Trigger a macro after a new mail is received", "body": "<p>I have a macro that prompts you to save an email to a specified folder before you send it, but I can't get the macro to work for receiving emails. </p>\n\n<p>This is what I have for sending emails:</p>\n\n<pre><code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n    If TypeOf Item Is Outlook.MailItem Then\n      Cancel = Not SaveSentMail(Item)\n    End If\nEnd Sub\n\nPrivate Function SaveSentMail(Item As Outlook.MailItem) As Boolean\n    Dim F As Outlook.MAPIFolder\n\n    If Item.DeleteAfterSubmit = False Then\n        Set F = Application.Session.PickFolder\n        If Not F Is Nothing Then\n            Set Item.SaveSentMessageFolder = F\n            SaveSentMail = True\n        End If\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 0, "creation_date": 1493783006, "post_id": 43750601, "comment_id": 74543705, "body": "You can step through the Sheets collection using numbers: Sheets(1), Sheets(2), etc. The number can be in a variable. Also, you can find the number of sheets using Sheets.Count. So you can use a For...Next loop like this: For i = 1 to Sheets.Count: set ws = Sheets(i): next i"}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1493789423, "post_id": 43750702, "comment_id": 74545579, "body": "I like the second solution you posted - using an array like that is a little cleaner than using three+ <code>Or Worksheet.Name = &quot;Data_XX</code> statements or the like"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 3, "last_activity_date": 1493783589, "last_edit_date": 1493783589, "creation_date": 1493783183, "answer_id": 43750702, "question_id": 43750601, "link": "https://stackoverflow.com/questions/43750601/how-do-i-refer-to-worksheets-to-loop-through-different-worksheets-and-perform-th/43750702#43750702", "title": "How do I refer to worksheets to loop through different worksheets and perform the same function on each of them?", "body": "<p>You could use an array of worksheets:</p>\n\n<pre><code>Public sh(1 To 3) As Worksheet\n\nSub updateWWColumn()  ' Only use Function when you are returning a value\n\n    Set sh(1) = ActiveWorkbook.Worksheets(\"Data_WE\")\n    Set sh(2) = ActiveWorkbook.Worksheets(\"Data_E\")\n    Set sh(3) = ActiveWorkbook.Worksheets(\"Data_PC\")\n    'placeholder to contain the week number in integer form from the cell on the right.\n    Dim placeholder As Integer ' Note: Integer, not Interger\n    Dim i As Integer\n\n    For i = 1 To 3\n        With sh(i)\n            .Columns(\"U:U\"). _\n                Insert Shift:=xlToRight, _\n                CopyOrigin:=xlFormatFromLeftOrAbove\n\n            .Columns(\"P:P\"). _\n                Delete Shift:=xlToLeft\n\n            placeholder = Right(.Range(\"S83\"), 2)\n            .Range(\"T83\").Value = \"WW\" &amp; placeholder + 1\n        End With\n    Next i\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Alternatively, you could loop through each worksheet using its name:</p>\n\n<pre><code>Sub updateWWColumn()  ' Only use Function when you are returning a value\n    Dim ws As Worksheet\n\n    'placeholder to contain the week number in integer form from the cell on the right.\n    Dim placeholder As Integer ' Note: Integer, not Interger\n    Dim i As Integer\n\n    For Each ws In ActiveWorkbook.Worksheets(Array(\"Data_WE\", \"Data_E\", \"Data_PC\"))\n        With ws\n            .Columns(\"U:U\"). _\n                Insert Shift:=xlToRight, _\n                CopyOrigin:=xlFormatFromLeftOrAbove\n\n            .Columns(\"P:P\"). _\n                Delete Shift:=xlToLeft\n\n            placeholder = Right(.Range(\"S83\"), 2)\n            .Range(\"T83\").Value = \"WW\" &amp; placeholder + 1\n        End With\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "is_accepted": true, "score": 3, "last_activity_date": 1493783229, "creation_date": 1493783229, "answer_id": 43750710, "question_id": 43750601, "link": "https://stackoverflow.com/questions/43750601/how-do-i-refer-to-worksheets-to-loop-through-different-worksheets-and-perform-th/43750710#43750710", "title": "How do I refer to worksheets to loop through different worksheets and perform the same function on each of them?", "body": "<p>Don't use three variables to store your sheet references - use an array of three items that store your specific sheets.</p>\n\n<p>So all I have done here is change sh1, sh2 and sh3 into an array called sh. Then wherever you would use<code>WorkSheets(\"sh\"&amp;i)</code> you can just use <code>sh(i)</code></p>\n\n<pre><code>Function updateWWColumn()\n    Dim sh(3) As Worksheet\n    Set sh(1) = ActiveWorkbook.Sheets(\"Data_WE\")\n    Set sh(2) = ActiveWorkbook.Sheets(\"Data_E\")\n    Set sh(3) = ActiveWorkbook.Sheets(\"Data_PC\")\n    'placeholder to contain the week number in integer form from the cell on the right.\n    Dim placeholder As Interger\n    Dim i As Integer\n\n    For i = 1 To 3\n        sh(i).Activate\n        ActiveSheet.Columns(\"U:U\"). _\n        Insert Shift:=xlToRight, _\n        CopyOrigin:=xlFormatFromLeftOrAbove\n\n        sh(i).Columns(\"P:P\"). _\n        Delete Shift:=xlToLeft\n\n        placeholder = Right(sh(i).Range(\"S83\"), 2)\n        sh(i).Range(\"T83\").Value = \"WW\" &amp; placeholder + 1\n    Next i\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4350, "user_id": 4187933, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/cT6jj.png?s=128&g=1", "display_name": "lebelinoz", "link": "https://stackoverflow.com/users/4187933/lebelinoz"}, "is_accepted": false, "score": 0, "last_activity_date": 1493783466, "creation_date": 1493783466, "answer_id": 43750745, "question_id": 43750601, "link": "https://stackoverflow.com/questions/43750601/how-do-i-refer-to-worksheets-to-loop-through-different-worksheets-and-perform-th/43750745#43750745", "title": "How do I refer to worksheets to loop through different worksheets and perform the same function on each of them?", "body": "<p>The other posted answers are good.  Alternatively, you can loop through every sheet in your workbook:</p>\n\n<pre><code>Dim sht As Worksheet\nFor Each sht In ActiveWorkbook.Worksheets\n    sht.Activate\n    ' etc...\nNext sht\n</code></pre>\n\n<p>Or, if you only want to affect sheets which start with the name <code>Data_</code>, you can embed an if statement:</p>\n\n<pre><code>Dim sht As Worksheet\nFor Each sht In ActiveWorkbook.Worksheets\n    If Left(sht.Name, 5) = \"Data_\" Then\n        sht.Activate\n        ' etc...\n    End If\nNext sht\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7955060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e3773e34c6777fafa1270b3931ecb26?s=128&d=identicon&r=PG&f=1", "display_name": "NagamiKai", "link": "https://stackoverflow.com/users/7955060/nagamikai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 43750710, "answer_count": 3, "score": 1, "last_activity_date": 1493783589, "creation_date": 1493782349, "last_edit_date": 1493783223, "question_id": 43750601, "link": "https://stackoverflow.com/questions/43750601/how-do-i-refer-to-worksheets-to-loop-through-different-worksheets-and-perform-th", "title": "How do I refer to worksheets to loop through different worksheets and perform the same function on each of them?", "body": "<p>I'm new to VBA and am trying to learn it. I've written this function to try to loop through some worksheets within the same workbook and add a column to update the week notated as 'ww' based on the cell to the left. </p>\n\n<p>I'm having issues with the For loop where it's supposed to loop through the defined sh1 to sh3. How do I declare the sheets to loop if using sheet.(\"sh\"&amp;i) does not work for the For loop?</p>\n\n<p>The <code>Sheets(\"sh\" &amp; i).Activate</code> part is where I receive the debug error.\n\"Run time error: 9\nsubscript out of range\"</p>\n\n<p>I'm largely unsure of what I'm doing and experimenting a lot. On the side not, is there any good online learning courses that I can use to grow my knowledge on VBA?</p>\n\n<pre><code>Function updateWWColumn()\n\n    Set sh1 = ActiveWorkbook.Sheets(\"Data_WE\")\n    Set sh2 = ActiveWorkbook.Sheets(\"Data_E\")\n    Set sh3 = ActiveWorkbook.Sheets(\"Data_PC\")\n\n    'placeholder to contain the week number in integer form from the cell on the right.\n    Dim placeholder As Integer\n    Dim i As Integer    \n\n    For i = 1 To 3\n        Sheets(\"sh\" &amp; i).Activate ' Run time error: 9 subscript out of range\n        ActiveSheet.Columns(\"U:U\").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n        Worksheets(\"sh\" &amp; i).Columns(\"P:P\").Delete Shift:=xlToLeft\n        placeholder = Right(Worksheets(\"sh\" &amp; i).Range(\"S83\"), 2)\n        Worksheets(\"sh\" &amp; i).Range(\"T83\").Value = \"WW\" &amp; placeholder + 1\n    Next i\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "indexing", "runtime-error", "match"], "comments": [{"owner": {"reputation": 886, "user_id": 6401734, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/87dbeb33da7c89f7b7a55a8bcf792301?s=128&d=identicon&r=PG&f=1", "display_name": "MattE", "link": "https://stackoverflow.com/users/6401734/matte"}, "edited": false, "score": 0, "creation_date": 1493779436, "post_id": 43750164, "comment_id": 74542891, "body": "Noticed that I have to use Application.Match when I use a single cell, but that still doesn&#39;t work on a range, same error"}, {"owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 1, "creation_date": 1493780632, "post_id": 43750164, "comment_id": 74543138, "body": "You have &quot;$:$H&quot;, which looks invalid."}, {"owner": {"reputation": 886, "user_id": 6401734, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/87dbeb33da7c89f7b7a55a8bcf792301?s=128&d=identicon&r=PG&f=1", "display_name": "MattE", "link": "https://stackoverflow.com/users/6401734/matte"}, "reply_to_user": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 0, "creation_date": 1493782873, "post_id": 43750164, "comment_id": 74543667, "body": "ack...it is supposed to be $H:$H which is what it is in my code, I just mistyped it"}, {"owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 1, "creation_date": 1493783192, "post_id": 43750164, "comment_id": 74543752, "body": "You should use copy/paste to get your code into the text box when you post a question or solution. Is &quot;$D,$H&quot; also a typo?"}, {"owner": {"reputation": 886, "user_id": 6401734, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/87dbeb33da7c89f7b7a55a8bcf792301?s=128&d=identicon&r=PG&f=1", "display_name": "MattE", "link": "https://stackoverflow.com/users/6401734/matte"}, "reply_to_user": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 0, "creation_date": 1493786487, "post_id": 43750164, "comment_id": 74544621, "body": "Yeah, its supopsed to $D:$H...I actually got it working using an offset with VLookup, and then actually figured it out using Index/Match...I was referencing the wrong columns..."}], "owner": {"reputation": 886, "user_id": 6401734, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/87dbeb33da7c89f7b7a55a8bcf792301?s=128&d=identicon&r=PG&f=1", "display_name": "MattE", "link": "https://stackoverflow.com/users/6401734/matte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 660, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1493779084, "creation_date": 1493779084, "question_id": 43750164, "link": "https://stackoverflow.com/questions/43750164/named-ranges-using-an-index-match-function-to-return-values", "title": "Named ranges using an index/Match function to return values", "body": "<p>I am using named ranges in a worksheet due to them changing often, and am trying to use an Index/Match function on a range of values.  I have it working properly on a single cell, but I can't get it to work on a range of cells like how a Vlookup would.  </p>\n\n<p>I am running the VBA code from the Workbook containing the Daily sheet, which opens the Workbook containing the Teams sheet.  </p>\n\n<p>Here is what I have in VBA:</p>\n\n<pre><code>Dim Teams as worksheet\nDim Daily as worksheet\nSet Teams = Sheets(\"Teams\")\nSet Daily = ThisWorkbook.Sheets(\"Daily\")\n\nWith Teams\n    .Range(\"TeamTotals\").Formula = WorksheetFunction.Index(Daily.Range(\"$:$H\"), WorksheetFunction.Match(.Range(\"TeamTotals\").Offset(, -7), Daily.Range(\"$D,$H\"), 0)) \nEnd Teams\n</code></pre>\n\n<p>It throws a 1004 Error Method of 'Range' of object'_Worksheet' failed</p>\n\n<p>Any idea how I can get this to run over a range of values?  I need to use OFFSET which is why I can't use a VLOOKUP</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1493794747, "post_id": 43750028, "comment_id": 74548001, "body": "That doesn&#39;t compile. This isn&#39;t a valid statement <code>MsgBox (&quot;First button &quot;, vbYesNo)= vbNo Then</code>"}, {"owner": {"reputation": 13, "user_id": 5942423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wr6kM.jpg?s=128&g=1", "display_name": "\u0414\u043c\u0438\u0442\u0440\u0438\u0439 \u041a\u0443\u0442\u044b\u0440\u043a\u0438\u043d", "link": "https://stackoverflow.com/users/5942423/%d0%94%d0%bc%d0%b8%d1%82%d1%80%d0%b8%d0%b9-%d0%9a%d1%83%d1%82%d1%8b%d1%80%d0%ba%d0%b8%d0%bd"}, "reply_to_user": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1493796840, "post_id": 43750028, "comment_id": 74549223, "body": "@ThunderFrame. Thanks,  fixed!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1493813237, "post_id": 43750028, "comment_id": 74560254, "body": "It&#39;s not clear what the purpose of that counter is. You should <a href=\"https://stackoverflow.com/posts/43750028/edit\">edit</a> your question to clarify exactly what the problem is, too. As it stands you described what&#39;s incorrect, but not what you&#39;re expecting instead."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1493832434, "post_id": 43750028, "comment_id": 74574220, "body": "In the ribbon&#39;s <code>onLoad</code> event procedure, you&#39;re doing <code>MyCounter = MyCounter + 1</code>, which adds <code>1</code> to <code>MyCounter</code> on restart, even though no button press. Is that what you expect?"}, {"owner": {"reputation": 13, "user_id": 5942423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wr6kM.jpg?s=128&g=1", "display_name": "\u0414\u043c\u0438\u0442\u0440\u0438\u0439 \u041a\u0443\u0442\u044b\u0440\u043a\u0438\u043d", "link": "https://stackoverflow.com/users/5942423/%d0%94%d0%bc%d0%b8%d1%82%d1%80%d0%b8%d0%b9-%d0%9a%d1%83%d1%82%d1%8b%d1%80%d0%ba%d0%b8%d0%bd"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1493832976, "post_id": 43750028, "comment_id": 74574528, "body": "@David Zemens. No, but I do not know how to fix it! This is the second mistake I can not cope with."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1493833018, "post_id": 43750028, "comment_id": 74574549, "body": "OK. That line is <i>clearly</i> adding 1 to the <code>MyCounter</code> every time the ribbon loads. If you don&#39;t want that to happen, what do you <i>think</i> you should do to that line?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1493833175, "post_id": 43750028, "comment_id": 74574630, "body": "You have an errant <code>End</code> statement attached to the <code>vbNo</code> response in button 2, this destroys all objects in memory. That is almost certainly <i>not</i> what you want to do here."}, {"owner": {"reputation": 13, "user_id": 5942423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wr6kM.jpg?s=128&g=1", "display_name": "\u0414\u043c\u0438\u0442\u0440\u0438\u0439 \u041a\u0443\u0442\u044b\u0440\u043a\u0438\u043d", "link": "https://stackoverflow.com/users/5942423/%d0%94%d0%bc%d0%b8%d1%82%d1%80%d0%b8%d0%b9-%d0%9a%d1%83%d1%82%d1%8b%d1%80%d0%ba%d0%b8%d0%bd"}, "edited": false, "score": 1, "creation_date": 1493833306, "post_id": 43750028, "comment_id": 74574712, "body": "Delete this line!"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1493833384, "post_id": 43750028, "comment_id": 74574765, "body": "That&#39;s what I would do :)"}, {"owner": {"reputation": 13, "user_id": 5942423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wr6kM.jpg?s=128&g=1", "display_name": "\u0414\u043c\u0438\u0442\u0440\u0438\u0439 \u041a\u0443\u0442\u044b\u0440\u043a\u0438\u043d", "link": "https://stackoverflow.com/users/5942423/%d0%94%d0%bc%d0%b8%d1%82%d1%80%d0%b8%d0%b9-%d0%9a%d1%83%d1%82%d1%8b%d1%80%d0%ba%d0%b8%d0%bd"}, "edited": false, "score": 0, "creation_date": 1493833455, "post_id": 43750028, "comment_id": 74574808, "body": "I created this operator intentionally, to show by example. In my main Add-on, there are a lot of places with the use of the operator End"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1493833417, "creation_date": 1493833417, "answer_id": 43766763, "question_id": 43750028, "link": "https://stackoverflow.com/questions/43750028/how-to-calculate-and-display-the-excel-add-in-panel-total-number-of-uses-of-all/43766763#43766763", "title": "How to calculate and display the Excel add-in panel total number of uses of all the macros included in this add-in", "body": "<pre><code>Public MyCounter As Long\n</code></pre>\n\n<p>That variable's value lives and dies with the execution context; this means when <code>End</code> runs, the value is gone. So you need a procedure that's reponsible for dealing with the file storage. Right now you have some of it in <code>Init_RibVar_Custom</code>; move that file-handling concern into its own procedure. Heck, move the whole counter-handling thing into its own class!</p>\n\n<pre><code>Option Explicit\n\nPrivate currentValue As Long\n\nPrivate Sub Class_Initialize()\n    LoadValue\nEnd Sub\n\nPublic Property Get Value() As Long\n    Value = currentValue\nEnd Property\n\nPublic Sub Increment()\n    currentValue = currentValue + 1\n    SaveValue\nEnd Sub\n\nPublic Sub LoadValue()\n    'assign currentValue from file\nEnd Sub\n\nPublic Sub SaveValue()\n    'save currentValue to file\nEnd Sub\n</code></pre>\n\n<p>Now name that class something like <code>CallCounter</code>, and then instead of this:</p>\n\n<pre><code>Private MyCounter As Long\n</code></pre>\n\n<p>You can have this:</p>\n\n<pre><code>Private counter As New CallCounter\n</code></pre>\n\n<p>Now, all you have to do to keep a correct count is to call <code>counter.Increment</code> in your macros:</p>\n\n<pre><code>Sub macro1(control As IRibbonControl)\n    counter.Increment\n    '...\nEnd Sub\n</code></pre>\n\n<p>Note that <code>Increment</code> will call <code>SaveValue</code>, so regardless of what happens, the correct value is always stored in the file.</p>\n\n<p>Just make sure <code>LoadValue</code> and <code>SaveValue</code> don't change the value, and you'll always have the correct count.</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 5942423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wr6kM.jpg?s=128&g=1", "display_name": "\u0414\u043c\u0438\u0442\u0440\u0438\u0439 \u041a\u0443\u0442\u044b\u0440\u043a\u0438\u043d", "link": "https://stackoverflow.com/users/5942423/%d0%94%d0%bc%d0%b8%d1%82%d1%80%d0%b8%d0%b9-%d0%9a%d1%83%d1%82%d1%8b%d1%80%d0%ba%d0%b8%d0%bd"}, "is_accepted": false, "score": 0, "last_activity_date": 1493885638, "last_edit_date": 1493885638, "creation_date": 1493839220, "answer_id": 43768320, "question_id": 43750028, "link": "https://stackoverflow.com/questions/43750028/how-to-calculate-and-display-the-excel-add-in-panel-total-number-of-uses-of-all/43768320#43768320", "title": "How to calculate and display the Excel add-in panel total number of uses of all the macros included in this add-in", "body": "<p>Thanks for David Zemens and Mat's Mug  </p>\n\n<p>Solution of the problem number 1: Remove the End operator throughout the code<br>\nSolution of the problem number 2: Delete the line MyCounter = MyCounter + 1 from the procedure Init_RibVar_Custom  </p>\n\n<pre><code>Option Explicit\n#If VBA7 Then\nPublic Declare PtrSafe Sub CopyMemory Lib \"kernel32\" _\n    Alias \"RtlMoveMemory\" (ByRef destination As Any, ByRef Source As Any, ByVal length As LongPtr)\n#Else\nPublic Declare Sub CopyMemory Lib \"kernel32\" _\n    Alias \"RtlMoveMemory\" (ByRef destination As Any, ByRef Source As Any, ByVal length As Long)\n#End If\n\nPublic MyCounter As Long\nPublic objRibCustom As IRibbonUI\nPublic cntr As IRibbonControl\n\nSub CheckRibbon()\n    If objRibCustom Is Nothing Then\n#If VBA7 Then\n        Dim lPointer As LongPtr\n        lPointer = CLngPtr(ThisWorkbook.Sheets(1).Range(\"A1\"))\n#Else\n        Dim lPointer As Long\n        lPointer = CLng(ThisWorkbook.Sheets(1).Range(\"A1\"))\n#End If\n        CopyMemory objRibCustom, lPointer, LenB(lPointer)\n    End If\nEnd Sub\nSub Init_RibVar_Custom(ribbon As IRibbonUI)\n    Set objRibCustom = ribbon\n    ThisWorkbook.Sheets(1).Range(\"A1\") = ObjPtr(ribbon)\n    objRibCustom.Invalidate\n    Open \"D:\\Counter.txt\" For Input As #1\n    Input #1, MyCounter\n    Close #1\n    Call getLabel_Cnt(cntr, \"\")\n    Open \"D:\\Counter.txt\" For Output As #1\n    Print #1, MyCounter\n    Close #1\nEnd Sub  \nSub getLabel_Cnt(control As IRibbonControl, ByRef label)\n    Call CheckRibbon\n    If cntr Is Nothing Then\n        Set cntr = control\n    End If\n    label = \"Counter: \" &amp; MyCounter\n    On Error Resume Next\n    objRibCustom.InvalidateControl control.ID\n    objRibCustom.Invalidate\nEnd Sub  \n\nSub macro1(control As IRibbonControl)\nOpen \"D:\\Counter.txt\" For Input As #1\nInput #1, MyCounter\nClose #1\nMyCounter = MyCounter + 1\nCall getLabel_Cnt(cntr, \"\")\n     MsgBox \"First button\", vbOKOnly\nOpen \"D:\\Counter.txt\" For Output As #1\nPrint #1, MyCounter\nClose #1\nEnd Sub  \n\nSub macro2(control As IRibbonControl)\nOpen \"D:\\Counter.txt\" For Input As #1\nInput #1, MyCounter\nClose #1\nMyCounter = MyCounter + 1\nCall getLabel_Cnt(cntr, \"\")\n    If MsgBox(\"Second button \", vbYesNo) = vbYes Then\nElse  \nEnd If\nOpen \"D:\\Counter.txt\" For Output As #1\nPrint #1, MyCounter\nClose #1\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": false, "score": 0, "last_activity_date": 1493963334, "last_edit_date": 1493963334, "creation_date": 1493929747, "answer_id": 43792243, "question_id": 43750028, "link": "https://stackoverflow.com/questions/43750028/how-to-calculate-and-display-the-excel-add-in-panel-total-number-of-uses-of-all/43792243#43792243", "title": "How to calculate and display the Excel add-in panel total number of uses of all the macros included in this add-in", "body": "<p>The solution is very simple: use hidden name. This hidden name is kept within workbook. To create hidden name (and also to re-initialize counter), run this procedure:</p>\n\n<pre><code>Sub CreateHiddenName()\n    ThisWorkbook.Names.Add Name:=\"ClicksCounter\", RefersTo:=0, Visible:=False\nEnd Sub\n</code></pre>\n\n<p>The hidden name is safely kept in /xl/workbook.xml:</p>\n\n<pre><code>&lt;definedNames&gt;\n    &lt;definedName name=\"ClicksCounter\" hidden=\"1\"&gt;0&lt;/definedName&gt;\n&lt;/definedNames&gt;\n</code></pre>\n\n<p>The test workbook I used had the following XML for ribbon:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;\n&lt;customUI xmlns=\"http://schemas.microsoft.com/office/2006/01/customui\" onLoad=\"OnRibbonLoaded\"&gt;\n    &lt;ribbon&gt;\n        &lt;tabs&gt;\n            &lt;tab id=\"rxTab1\" label=\"MY_TAB\"&gt;\n            &lt;group id=\"rxGroup1\" label=\"Group1\"&gt;\n                &lt;button id=\"rxButton1\"\n                        label=\"I am humble button\"\n                        imageMso=\"QueryAppend\"\n                        onAction=\"OnHumbleButtonClick\" /&gt;\n            &lt;labelControl id=\"rxLabel1\"\n                          getLabel=\"OnGetCounter\" /&gt;\n            &lt;/group&gt;\n        &lt;/tab&gt;\n        &lt;/tabs&gt;\n    &lt;/ribbon&gt;\n&lt;/customUI&gt;\n</code></pre>\n\n<p>VBA code (in standard module):</p>\n\n<pre><code>Private ribbon As IRibbonUI\n\nSub OnRibbonLoaded(IRibbon As IRibbonUI)\n    Set ribbon = IRibbon\nEnd Sub\n\nSub OnGetCounter(ctrl As IRibbonControl, returnValue)\n    returnValue = \"Counter: \" &amp; GetCounterValue()\nEnd Sub\n\nSub OnHumbleButtonClick(ctrl As IRibbonControl)\n    ' Do something here...\n    ' In the end call:\n    Call IncrCounter\nEnd Sub\n\nSub IncrCounter()\n    ThisWorkbook.Names(\"ClicksCounter\").Value = GetCounterValue() + 1\n    ribbon.InvalidateControl \"rxLabel1\"\nEnd Sub\n\nFunction GetCounterValue()\n    GetCounterValue = Replace(ThisWorkbook.Names(\"ClicksCounter\").Value, \"=\", \"\")\nEnd Function\n</code></pre>\n\n<p>What happens here in steps:</p>\n\n<p>1) When workbook starts up, the <strong>OnRibbonLoaded</strong> is called whose sole purpose is to keep <em>IRibbonUI</em> variable.</p>\n\n<p>2) When you press \"humble\" button, the <strong>OnHumbleButtonClick</strong> callback is run.</p>\n\n<p>4) <strong>OnHumbleButtonClick</strong> runs <strong>IncrCounter</strong> procedure which:</p>\n\n<p>4.1) increments counter;</p>\n\n<p>4.2) invalidates <em>labelControl</em> to reflect new counter value (invalidating makes <strong>OnGetCounter</strong> to run to get new label for <em>labelControl</em>).</p>\n\n<p>As a side note, it would be better to add code which would restore Ribbon variable address, if you, of course, use it. Here are required additions to code:</p>\n\n<p>1) Create hidden name to keep address:</p>\n\n<pre><code>Sub AddNameForRibbonPointer()\n\u00a0\u00a0\u00a0\u00a0ThisWorkbook.Names.Add Name:=\"RibbonPointer\", RefersTo:=0, Visible:=False\nEnd Sub\n</code></pre>\n\n<p>2) Declare Win32 <strong>RtlMoveMemory</strong> function which restores address:</p>\n\n<pre><code>#If VBA7 Then\nPublic Declare PtrSafe Sub CopyMemory Lib \"kernel32\" _\n\u00a0\u00a0\u00a0\u00a0Alias \"RtlMoveMemory\" (ByRef destination As Any, ByRef Source As Any, ByVal length As LongPtr)\n#Else\nPublic Declare Sub CopyMemory Lib \"kernel32\" _\n\u00a0\u00a0\u00a0\u00a0Alias \"RtlMoveMemory\" (ByRef destination As Any, ByRef Source As Any, ByVal length As Long)\n#End If\n</code></pre>\n\n<p>3) Add a line which would keep ribbon's address in hidden name:</p>\n\n<pre><code>Sub OnRibbonLoaded(IRibbon As IRibbonUI)\n    Set ribbon = IRibbon\n    ThisWorkbook.Names(\"RibbonPointer\").Value = ObjPtr(ribbon)\nEnd Sub\n</code></pre>\n\n<p>4) Helper procedure to check whether ribbon variable is not nothing. If it is, then it will restore the address from hidden name:</p>\n\n<pre><code>Sub CheckRibbon()\n\u00a0\u00a0\u00a0\u00a0\u00a0\n\u00a0\u00a0\u00a0\u00a0If ribbon Is Nothing Then\n#If VBA7 Then\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Dim lPointer As LongPtr\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0lPointer = CLngPtr([RibbonPointer])\n#Else\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Dim lPointer As Long\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0lPointer = CLng([RibbonPointer])\n#End If\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0CopyMemory ribbon, lPointer, LenB(lPointer)\n\u00a0\u00a0\u00a0\u00a0End If\n\u00a0\nEnd Sub\n</code></pre>\n\n<p>From now on, you just call <strong>CheckRibbon</strong> procedure before using ribbon variable:</p>\n\n<pre><code>Sub MyProcedure\n    ' Doing something...\n    Call CheckRibbon\n    ribbon.Invalidate\nEnd Sub  \n</code></pre>\n\n<p><strong>UPD:</strong>  </p>\n\n<p>To keep counter along with the workbook, you need, well, to save workbook. For usual workbook, you could either save it manually or do it automatically when closing workbook. For add-in you have to do it automatically because no changes are saved when you close Excel. For auto-saving you need to use Workbook's BeforeClose event. Go to ThisWorkbook module and paste this code:</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n    ThisWorkbook.Save\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5942423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wr6kM.jpg?s=128&g=1", "display_name": "\u0414\u043c\u0438\u0442\u0440\u0438\u0439 \u041a\u0443\u0442\u044b\u0440\u043a\u0438\u043d", "link": "https://stackoverflow.com/users/5942423/%d0%94%d0%bc%d0%b8%d1%82%d1%80%d0%b8%d0%b9-%d0%9a%d1%83%d1%82%d1%8b%d1%80%d0%ba%d0%b8%d0%bd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1493963334, "creation_date": 1493777945, "last_edit_date": 1493831799, "question_id": 43750028, "link": "https://stackoverflow.com/questions/43750028/how-to-calculate-and-display-the-excel-add-in-panel-total-number-of-uses-of-all", "title": "How to calculate and display the Excel add-in panel total number of uses of all the macros included in this add-in", "body": "<p>Sorry. Translated with Google translator!<br>\nLink to the website of the program developer, with which I created the file Excel add-in! This program is FREE!\n[<a href=\"http://novikov.gq/products/ribbonxmleditor/ribbonxmleditor.html][1]\" rel=\"nofollow noreferrer\">http://novikov.gq/products/ribbonxmleditor/ribbonxmleditor.html][1]</a> </p>\n\n<p>Initial data: we have an Add-in for the program Excel! The add-in consists of two macros that are associated with the buttons on the Add-in panel. </p>\n\n<p>Task: summarize all the presses on the buttons. The amount of clicks to show in the Add-ons panel. The amount should not be reset after reboot.  </p>\n\n<p>Errors that I can not solve:<br>\n1) The amount of clicks is reset, if you select No (press button 2)<br>\n2) To the amount of clicks is added +1, every time the Excel is started - this is incorrect.  </p>\n\n<p>XML code:  </p>\n\n<pre><code>&lt;?xml version=\"1.0\" standalone=\"yes\"?&gt;\n&lt;customUI xmlns=\"http://schemas.microsoft.com/office/2006/01/customui\" onLoad=\"Init_RibVar_Custom\"&gt;\n    &lt;ribbon startFromScratch=\"false\"&gt;\n        &lt;tabs&gt;\n            &lt;tab id=\"excel-vba\" label=\"Test\"&gt;\n                &lt;group id=\"groupe_1\" label=\" \u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435\"&gt;\n                    &lt;button id=\"button_1\" imageMso=\"GoLtrDown\" label=\"Button 1\" onAction=\"macro1\" /&gt;\n                    &lt;button id=\"button_2\" imageMso=\"GoLtrDown\" label=\"Button 2\" onAction=\"macro2\" /&gt;\n                &lt;/group&gt;\n\n                &lt;group id=\"groupe_2\" label=\"Counter\"&gt;\n                    &lt;labelControl id=\"Counter\" getLabel=\"getLabel_Cnt\" /&gt;\n                &lt;/group&gt;\n\n            &lt;/tab&gt;\n        &lt;/tabs&gt;\n    &lt;/ribbon&gt;\n&lt;/customUI&gt;\n</code></pre>\n\n<p>Main code:  </p>\n\n<pre><code>Option Explicit\n#If VBA7 Then\nPublic Declare PtrSafe Sub CopyMemory Lib \"kernel32\" _\n    Alias \"RtlMoveMemory\" (ByRef destination As Any, ByRef Source As Any, ByVal length As LongPtr)\n#Else\nPublic Declare Sub CopyMemory Lib \"kernel32\" _\n    Alias \"RtlMoveMemory\" (ByRef destination As Any, ByRef Source As Any, ByVal length As Long)\n#End If\n\nPublic MyCounter As Long\nPublic objRibCustom As IRibbonUI\nPublic cntr As IRibbonControl\n\nSub CheckRibbon()\n    If objRibCustom Is Nothing Then\n#If VBA7 Then\n        Dim lPointer As LongPtr\n        lPointer = CLngPtr(ThisWorkbook.Sheets(1).Range(\"A1\"))\n#Else\n        Dim lPointer As Long\n        lPointer = CLng(ThisWorkbook.Sheets(1).Range(\"A1\"))\n#End If\n        CopyMemory objRibCustom, lPointer, LenB(lPointer)\n    End If\nEnd Sub\nSub Init_RibVar_Custom(ribbon As IRibbonUI)\n    Set objRibCustom = ribbon\n    ThisWorkbook.Sheets(1).Range(\"A1\") = ObjPtr(ribbon)\n    objRibCustom.Invalidate\n    Open \"D:\\Counter.txt\" For Input As #1\n    Input #1, MyCounter\n    Close #1\n    MyCounter = MyCounter + 1\n    Call getLabel_Cnt(cntr, \"\")\n    Open \"D:\\Counter.txt\" For Output As #1\n    Print #1, MyCounter\n    Close #1\nEnd Sub  \nSub getLabel_Cnt(control As IRibbonControl, ByRef label)\n    Call CheckRibbon\n    If cntr Is Nothing Then\n        Set cntr = control\n    End If\n    label = \"Counter: \" &amp; MyCounter\n    On Error Resume Next\n    objRibCustom.InvalidateControl control.ID\n    objRibCustom.Invalidate\nEnd Sub  \nSub macro1(control As IRibbonControl)\n    MyCounter = MyCounter + 1\n    Call getLabel_Cnt(cntr, \"\")\n     MsgBox \"First button\", vbOKOnly\nEnd Sub   \nSub macro2(control As IRibbonControl)\n    MyCounter = MyCounter + 1\n    Call getLabel_Cnt(cntr, \"\")\n    If MsgBox(\"Second button \", vbYesNo) = vbYes Then\nElse\n    End\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493777856, "post_id": 43749745, "comment_id": 74542587, "body": "Interesting code. FYI it works fine for me. When I select ABC, and then type WWW, it shows ABC - WWW. When I type WWW again, it is removed. Same thing happens if I select ABC. Nothing is wrong with the code."}, {"owner": {"reputation": 11, "user_id": 7949723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13a9646e7df8bc14a2d92920968d2984?s=128&d=identicon&r=PG&f=1", "display_name": "xRi", "link": "https://stackoverflow.com/users/7949723/xri"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493778130, "post_id": 43749745, "comment_id": 74542641, "body": "WWW is not meant to be in the dropdown list, if you have added WWW into the dropdown list then it works fine."}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493778207, "post_id": 43749745, "comment_id": 74542653, "body": "No not in the list, I got that. Maybe you can open a new worksheet, copy this code and create a data validation and check again, do you have any other code in your worksheet?"}, {"owner": {"reputation": 11, "user_id": 7949723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13a9646e7df8bc14a2d92920968d2984?s=128&d=identicon&r=PG&f=1", "display_name": "xRi", "link": "https://stackoverflow.com/users/7949723/xri"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493778313, "post_id": 43749745, "comment_id": 74542670, "body": "Yes I have just tried it on a different workbook, and it works fine, but it doesn&#39;t have multi select, like now I can&#39;t choose ABC and XYZ to appear in the same cell. /// And no I dont have any other codes in that worksheet, but I have codes in modules."}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493779578, "post_id": 43749745, "comment_id": 74542915, "body": "I checked your code line by line and there is no logical error. Also there is no duplicates and whatever I select/enter is added to list. Typing again removed them as well."}, {"owner": {"reputation": 11, "user_id": 7949723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13a9646e7df8bc14a2d92920968d2984?s=128&d=identicon&r=PG&f=1", "display_name": "xRi", "link": "https://stackoverflow.com/users/7949723/xri"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493780079, "post_id": 43749745, "comment_id": 74543016, "body": "I just tried again on a different workbook and it still duplicates my original selection. T-T"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493780646, "post_id": 43749745, "comment_id": 74543141, "body": "I really don&#39;t have any issue. But there is only one problem with your code.   After selecting ABC, if you type BC, the ABC is gone because of using <code>InStr(1, oldVal, newVal)</code>"}, {"owner": {"reputation": 11, "user_id": 7949723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13a9646e7df8bc14a2d92920968d2984?s=128&d=identicon&r=PG&f=1", "display_name": "xRi", "link": "https://stackoverflow.com/users/7949723/xri"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493782163, "post_id": 43749745, "comment_id": 74543506, "body": "Oh I see.. anyway thank you for your help, I&#39;ll see what I can do T-T"}], "owner": {"reputation": 11, "user_id": 7949723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13a9646e7df8bc14a2d92920968d2984?s=128&d=identicon&r=PG&f=1", "display_name": "xRi", "link": "https://stackoverflow.com/users/7949723/xri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1493776387, "creation_date": 1493775742, "last_edit_date": 1493776387, "question_id": 43749745, "link": "https://stackoverflow.com/questions/43749745/how-to-avoid-duplication-when-entering-a-value-into-a-data-validation-cell-whic", "title": "How to avoid duplication when entering a value into a data validation cell, which allows multiple selection", "body": "<p>There are certain columns in my database, that requires me to type in new data as well as make selections. So, I made a drop down list through data validation. I can select multiple selections according to the code, but if I keyed in any data into that cell, the original selection will show up twice.</p>\n\n<p>Eg. Cell contains the choices: ABC, XYZ<br>\nI chose ABC, typed in WWW<br>\nThe cell will then show ABC, ABC, WWW</p>\n\n<p>Anyone can help prevent the duplication of the original choice?</p>\n\n<p>Here is the code I currently have, I tried to remove the \"oldVal\" part to prevent duplication, it prevented me from choosing multiple choices.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim rngDV As Range\n    Dim oldVal As String\n    Dim newVal As String\n    Dim lUsed As Long\n    If Target.Count &gt; 1 Then GoTo exitHandler\n    On Error Resume Next\n    Set rngDV = Cells.SpecialCells(xlCellTypeAllValidation)\n    On Error GoTo exitHandler\n    If rngDV Is Nothing Then GoTo exitHandler\n    If Intersect(Target, rngDV) Is Nothing Then\n         'do nothing\n    Else\n        Application.EnableEvents = False\n        newVal = Target.Value\n        Application.Undo\n        oldVal = Target.Value\n        Target.Value = newVal\n        If Target.Column = 28 Or Target.Column = 29 Or Target.Column = 30 Then\n            If oldVal = \"\" Then\n                 'do nothing\n            Else\n                If newVal = \"\" Then\n                     'do nothing\n                Else\n                    lUsed = InStr(1, oldVal, newVal)\n                    If lUsed &gt; 0 Then\n                        If oldVal = newVal Then\n                            Target.Value = \"\"\n                        ElseIf Right(oldVal, Len(newVal)) = newVal Then\n                            Target.Value = Left(oldVal, Len(oldVal) - Len(newVal) - 1)\n                        Else\n                            Target.Value = Replace(oldVal, newVal &amp; vbLf, \"\")\n                        End If\n                    Else\n                        Target.Value = oldVal &amp; vbLf &amp; newVal\n                    End If\n                End If\n            End If\n        End If\n    End If\nexitHandler:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1493767469, "post_id": 43748607, "comment_id": 74540499, "body": "I thought the path separator on Max was either &quot;:&quot; or &quot;/&quot; - does backslash really work?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1493768089, "post_id": 43748607, "comment_id": 74540640, "body": "Doesn&#39;t the <code>Dir</code> function require <code>MacID(&quot;TEXT&quot;)</code> as a parameter in {vba-mac]? See <a href=\"http://stackoverflow.com/questions/10045474/dir-function-not-working-in-mac-excel-2011-vba\">this</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1493768302, "post_id": 43748607, "comment_id": 74540699, "body": "Bonus points for code that is [a brand new smaller one]. Nice <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 53, "user_id": 7917456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/128712ea6e1c42ccfe7d3460b08cfc80?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/7917456/dave"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1493769894, "post_id": 43748607, "comment_id": 74541037, "body": "@Tim - Well, the backslash is what is actually returned by the msgbox, and my understanding is, yes, Excel 2016 uses them.  However, I&#39;m open to suggestions, as, clearly, SOMEthing is not working."}, {"owner": {"reputation": 53, "user_id": 7917456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/128712ea6e1c42ccfe7d3460b08cfc80?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/7917456/dave"}, "edited": false, "score": 0, "creation_date": 1493769972, "post_id": 43748607, "comment_id": 74541060, "body": "@Jeeped - I saw the post you referenced, and I used part of that code in my original working copy of the 2011 version.  However, if I try to use MacID(&quot;TEXT&quot;) with Dir in this code, it returns a null string.  If I remove the MacID, it at least returns the correct file name.  It just can&#39;t open it."}, {"owner": {"reputation": 53, "user_id": 7917456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/128712ea6e1c42ccfe7d3460b08cfc80?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/7917456/dave"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1493770109, "post_id": 43748607, "comment_id": 74541088, "body": "@Tim - sorry, I meant to also add that, I tried with forward slashes, as you suggested, and exact same error."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1493770177, "post_id": 43748607, "comment_id": 74541104, "body": "OK then <code>debug.print newfolderpath &amp; Dir(filename)</code> then record yourself using File, Open on the same work book and compare the two results."}, {"owner": {"reputation": 53, "user_id": 7917456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/128712ea6e1c42ccfe7d3460b08cfc80?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/7917456/dave"}, "edited": false, "score": 0, "creation_date": 1493770911, "post_id": 43748607, "comment_id": 74541205, "body": "@Jeeped - debug.print = Hard Drive\\Users\\Dave\\Desktop\\csvs\\1.csv    but, code still gives:  Run-time error &#39;1004&#39;: &#39;HARD DRIVE\\USERS\\DAVE\\DESKTOP\\CSVS\\1.CSV&#39; -- any reason the error is in all caps?   Meanwhile, when I record a macro, it does not record the file/open operation."}], "answers": [{"comments": [{"owner": {"reputation": 847, "user_id": 1827488, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/b504f72af34abbdc5bcdd8f15527c07a?s=128&d=identicon&r=PG", "display_name": "rockhammer", "link": "https://stackoverflow.com/users/1827488/rockhammer"}, "edited": false, "score": 0, "creation_date": 1593881960, "post_id": 43769739, "comment_id": 110934633, "body": "you idea of replacing <code>:</code> with <code>&#47;</code> works for me without having to do anything with file path. In my case applescript to select file was returning <code>Macintosh HD:Users:xxxx:Documents:yyyy.xlsx</code>. All I had to do was to replace <code>:</code> with <code>&#47;</code> and <code>Macintosh HD</code> with <code>&quot;&quot;</code> to make <code>Workbooks.open()</code> work. thx"}], "tags": [], "owner": {"reputation": 53, "user_id": 7917456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/128712ea6e1c42ccfe7d3460b08cfc80?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/7917456/dave"}, "is_accepted": false, "score": 2, "last_activity_date": 1493844504, "creation_date": 1493844504, "answer_id": 43769739, "question_id": 43748607, "link": "https://stackoverflow.com/questions/43748607/mac-excel-2016-vba-workbook-open-gives-1004-error/43769739#43769739", "title": "Mac Excel 2016 VBA - Workbook.open gives 1004 error", "body": "<p>Well, I think I found the answer, or at least an answer that works for my project.  </p>\n\n<p>I went back to the workbooks.open(user-selected FILE) from earlier in the macro, and discovered it was reading it as \"/users/Dave/Desktop/csvs/1.csv\".  So, even though debug and msgbox were returning backslashes, it was somehow wanting forward slashes (You were partially right, Tim).  Additionally, it clearly truncates the name of the Mac hard drive, and starts with the users directory.  So, I just modified the variables to match this format, and voila, it worked.  For those who are interested, here's the modified code I wound up using:</p>\n\n<pre><code>Sub Test()\n\nDim folderpath As Variant\nDim newfilename As Variant\nDim wb As Workbook\nDim newfolderpath As Variant\nDim newfp As Variant\n\nfolderpath = MacScript(\"choose folder as string\")\nnewfolderpath = Replace(folderpath, \":\", \"/\")\nnewfp = Right(newfolderpath, Len(newfolderpath) - InStr(newfolderpath, \"/\") + 1)\n\nnewfilename = Dir(newfp)\n\nSet wb = Workbooks.Open(newfp &amp; newfilename)\n\nExit Sub\n</code></pre>\n\n<p>Thanks to everyone that helped.</p>\n"}], "owner": {"reputation": 53, "user_id": 7917456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/128712ea6e1c42ccfe7d3460b08cfc80?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/7917456/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3406, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1593678607, "creation_date": 1493766539, "last_edit_date": 1593678607, "question_id": 43748607, "link": "https://stackoverflow.com/questions/43748607/mac-excel-2016-vba-workbook-open-gives-1004-error", "title": "Mac Excel 2016 VBA - Workbook.open gives 1004 error", "body": "<p>I'm trying to get a macro that works perfectly in Excel 2011 for Mac to work in Excel 2016 for mac.  The goal is to have the user specify a folder with .csv files in it, and then the macro loops through all the .csvs, opening each to copy information out of it into another Workbook.</p>\n\n<p>The macro fails when trying to open the first .csv file in the user-chosen folder, with a 1004 error, file cannot be found.</p>\n\n<p>(side note: Earlier in the macro, workbooks.open works perfectly with a user selected FILE)</p>\n\n<p>The macro is huge, so I made a brand new smaller one just to get past this problem.  Here is the smaller, test code, which has the same failing behavior:</p>\n\n<pre><code>Sub Test()\nDim folderpath As Variant\nDim filename As Variant\nDim newfilename As Variant\nDim wb As Workbook\nDim newfolderpath As Variant\n\nfolderpath = MacScript(\"choose folder as string\")\n\nnewfolderpath = Replace(folderpath, \":\", \"\\\")\n\nMsgBox (newfolderpath)\n\nfilename = MacScript(\"Choose file as string\")\nnewfilename = Replace(filename, \":\", \"\\\")\nMsgBox (filename)\nMsgBox (newfilename)\nMsgBox (Dir(filename))\nMsgBox (newfolderpath &amp; Dir(filename))\n\nSet wb = Workbooks.Open(newfolderpath &amp; Dir(filename))\nEnd Sub\n</code></pre>\n\n<p>All the msgboxes provide expected values.  </p>\n\n<ul>\n<li>newfolderpath= the whole path with \\ separators.</li>\n<li>filename= the whole path and file name with : separators.</li>\n<li>newfilename= the whole path and file name with \\ separators.</li>\n<li>Dir(filename)= just the file name.</li>\n<li>newfolderpath &amp; Dir(filename))= the entire path and file name with \\ \nseparators.</li>\n</ul>\n\n<p>Set wb line gives:  </p>\n\n<pre><code>Run-time error '1004'\n'Hard DRIVE\\USERS\\DAVE\\DESKTOP\\CSVS\\1.CSV'\n</code></pre>\n\n<p>could not be found.</p>\n\n<p>Clearly the file is there, openable and works.</p>\n\n<p>Any help is greatly appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 2, "creation_date": 1493764731, "post_id": 43748266, "comment_id": 74539765, "body": "Use the Left function."}, {"owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "edited": false, "score": 0, "creation_date": 1493786405, "post_id": 43748266, "comment_id": 74544594, "body": "Use condition <code>If InStr(1, Cells(rw, 8).Value, &quot;7-16&quot;) = 1 Then</code>. This will check if <code>7-16</code> is at the beginning."}], "answers": [{"tags": [], "owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "is_accepted": false, "score": 0, "last_activity_date": 1493766379, "creation_date": 1493766379, "answer_id": 43748590, "question_id": 43748266, "link": "https://stackoverflow.com/questions/43748266/instr-only-look-in-the-first-part-of-the-string/43748590#43748590", "title": "InStr - only look in the first part of the string", "body": "<p>If the format is always \"#-##' then do something like:\n<code>If Instr(1, String, \"-\") = 2 then</code> </p>\n\n<p>Since Instr returns the position index, you can classify it by the number. </p>\n\n<p>You may also be able to do something like:\n <code>if String like \"#-########-##\" then</code></p>\n\n<p>The like operator will check if a string satisfies a pattern, so you should be able to use this to explicitly define a pattern, and see if the string satisfies the given pattern. For more information, check this out: <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251796.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/gg251796.aspx</a></p>\n\n<p>Also, if you wanted to explicitly match the first three characters to a substring you could do something like:</p>\n\n<p><code>If Left(String, 3) = SubString then</code></p>\n\n<p>For example:</p>\n\n<pre><code>Dim SearchString as String: SearchString = \"1-2-3_IsThisThingOn\"\nDim SubString as String: SubString = \"1-2-3\"\n\n' Returns \"1-2-3\"\nDebug.Print Left(SearchString, 5)\n\n' Returns true\nDebug.Print Left(SearchString, 5) = \"1-2-3\"\n\nSubString = \"4-5-6\"\n\n'Returns false\nDebug.Print Left(SearchString, 5) = \"1-2-3\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 7822605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29bba9ce95764a550a695fda756e5447?s=128&d=identicon&r=PG&f=1", "display_name": "Adije", "link": "https://stackoverflow.com/users/7822605/adije"}, "edited": false, "score": 0, "creation_date": 1493820459, "post_id": 43751988, "comment_id": 74566035, "body": "Perfect! Thank you!"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1493790493, "creation_date": 1493790493, "answer_id": 43751988, "question_id": 43748266, "link": "https://stackoverflow.com/questions/43748266/instr-only-look-in-the-first-part-of-the-string/43751988#43751988", "title": "InStr - only look in the first part of the string", "body": "<p>You can use a slightly different approach: replace you multiple <code>If</code>s and <code>ElseIf</code>s with <code>Select Case</code>.</p>\n\n<p>Replace your <code>Instr</code> with <code>Like</code> and add the wild-card <code>*</code> at the end to look for the first 4 letters. e.g <code>Cells(rw, 8).Value Like \"7-16*\"</code>.</p>\n\n<p>There is a nice \"trick\" to use <code>Select Case</code>, with <code>Like</code> and the wild-card <code>*</code>, see in my code below.</p>\n\n<p><strong>Note</strong>: try to avoid using <code>ActiveSheet</code> and instead use fully qualifed objects, like <code>Set Sht = Worksheets(\"Sheet1\")</code>.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub PGSE_Container_Trainer()\n\nDim rw As Long\nDim Sht As Worksheet\nDim CVal As Variant\n\nSet Sht = Worksheets(\"Sheet1\") ' it's better to avoid using ActiveSheet\n\nrw = 2\nWith Sht\n    Do Until .Cells(rw, 1) = \"\"\n        CVal = .Cells(rw, 8).Value\n        Select Case True '&lt;-- the trick to have the `Like` inside the Case\n            Case CVal Like \"7-16*\", CVal Like \"7-26*\", CVal Like \"7-36*\", CVal Like \"7-46*\", CVal Like \"7-56*\", _\n                    CVal Like \"7-66*\", CVal Like \"7-76*\", CVal Like \"7-86*\", CVal Like \"7-96*\", CVal Like \"13414*\"\n                .Cells(rw, 51) = \"Container / PGSE Part/Trainers\"\n\n        End Select\n\n        ' add more select cases to fit your needs here...\n\n        rw = rw + 1\n    Loop\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7822605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29bba9ce95764a550a695fda756e5447?s=128&d=identicon&r=PG&f=1", "display_name": "Adije", "link": "https://stackoverflow.com/users/7822605/adije"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 536, "favorite_count": 0, "accepted_answer_id": 43751988, "answer_count": 2, "score": 0, "last_activity_date": 1493790493, "creation_date": 1493764389, "last_edit_date": 1531164843, "question_id": 43748266, "link": "https://stackoverflow.com/questions/43748266/instr-only-look-in-the-first-part-of-the-string", "title": "InStr - only look in the first part of the string", "body": "<p>I have a dataset that contains a few thousand rows and I am searching each row for specific text within the strings: 7-16, 7-26, 7-36, 13414, SHIPP, CONTAI...etc. (more of them shown below).</p>\n\n<p>The problem is that sometimes some part numbers have the \"# - ##\" at the end of the part and not at the beginning and so the macro is also classifying it as \"Container / PGSE Part/Trainers\" when it really is not.</p>\n\n<p>So I am looking for syntax that will only look at the first 4 characters of a string in the cell (only for the ones that contain the part numbers, not words).</p>\n\n<p>For example: </p>\n\n<p>If it were to look at a cell containing \"<strong>7-26</strong>734372-102\" I <em>would</em> want it to classify it as a \"Container / PGSE Part/Trainers\" in column 51</p>\n\n<p>If it were to look at a cell containing \"MS3520<strong>7-26</strong>3\" I <em>would not</em> want it to classify it as a \"Container / PGSE Part/Trainers\" in column 51 because it is in the end of the string.</p>\n\n<pre><code>Sub PGSE_Container_Trainer()\n\nDim rw As Integer\n\nSet sht = ActiveWorkbook.ActiveSheet\n\nrw = 2\n\nDo Until sht.Cells(rw, 1) = \"\"\n\nIf InStr(1, Cells(rw, 8).Value, \"7-16\") Then\n    sht.Cells(rw, 51) = \"Container / PGSE Part/Trainers\"\n    GoTo LoopSkip\nElseIf InStr(1, Cells(rw, 8).Value, \"7-26\") Then\n    sht.Cells(rw, 51) = \"Container / PGSE Part/Trainers\"\n    GoTo LoopSkip\nElseIf InStr(1, Cells(rw, 8).Value, \"7-36\") Then\n    sht.Cells(rw, 51) = \"Container / PGSE Part/Trainers\"\n    GoTo LoopSkip\nElseIf InStr(1, Cells(rw, 8).Value, \"7-46\") Then\n    sht.Cells(rw, 51) = \"Container / PGSE Part/Trainers\"\n    GoTo LoopSkip\nElseIf InStr(1, Cells(rw, 8).Value, \"7-56\") Then\n    sht.Cells(rw, 51) = \"Container / PGSE Part/Trainers\"\n    GoTo LoopSkip\nElseIf InStr(1, Cells(rw, 8).Value, \"7-66\") Then\n    sht.Cells(rw, 51) = \"Container / PGSE Part/Trainers\"\n    GoTo LoopSkip\nElseIf InStr(1, Cells(rw, 8).Value, \"7-76\") Then\n    sht.Cells(rw, 51) = \"Container / PGSE Part/Trainers\"\n    GoTo LoopSkip\nElseIf InStr(1, Cells(rw, 8).Value, \"7-86\") Then\n    sht.Cells(rw, 51) = \"Container / PGSE Part/Trainers\"\n    GoTo LoopSkip\nElseIf InStr(1, Cells(rw, 8).Value, \"7-96\") Then\n    sht.Cells(rw, 51) = \"Container / PGSE Part/Trainers\"\n    GoTo LoopSkip\nElseIf InStr(1, Cells(rw, 8).Value, \"13414\") Then\n    sht.Cells(rw, 51) = \"Container / PGSE Part/Trainers\"\n    GoTo LoopSkip\nElseIf InStr(1, Cells(rw, 9).Value, \"CONTAI\") Then\n    sht.Cells(rw, 51) = \"Container / PGSE Part/Trainers\"\n    GoTo LoopSkip\nElseIf InStr(1, Cells(rw, 9).Value, \"CNTNR\") Then\n    sht.Cells(rw, 51) = \"Container / PGSE Part/Trainers\"\n    GoTo LoopSkip\nElseIf InStr(1, Cells(rw, 9).Value, \"SHIPP\") Then\n    sht.Cells(rw, 51) = \"Container / PGSE Part/Trainers\"\n    GoTo LoopSkip\nElseIf InStr(1, Cells(rw, 8).Value, \"REN\") Then\n    sht.Cells(rw, 51) = \"Container / PGSE Part/Trainers\"\n    GoTo LoopSkip\nEnd If\n\nLoopSkip:\nrw = rw + 1\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook", "msg"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1493764713, "post_id": 43748113, "comment_id": 74539761, "body": "I guess this is an obvious question, but is the file already open?  E.g. in Outlook? Or in Excel from a failed earlier attempt at your code?  Or in Excel from a previous successful attempt?  (It doesn&#39;t look like you are explicitly doing a <code>Close</code>, so it might still be open.)  Also, does this page apply: <a href=\"https://support.microsoft.com/en-us/help/2633737/the-openshareditem-method-for-outlook-holds-a-file-handle-on-signed-.msg-files\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/help/2633737/&hellip;</a>"}, {"owner": {"reputation": 5487, "user_id": 2909692, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/05ad9fe4a2d294b296a7bc3eba97850a?s=128&d=identicon&r=PG&f=1", "display_name": "Sauron", "link": "https://stackoverflow.com/users/2909692/sauron"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493764968, "post_id": 43748113, "comment_id": 74539832, "body": "This is a one time thing. How can I rewrite this to work, at least to open the emails, I can take converting the excel from there."}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493765666, "post_id": 43748113, "comment_id": 74540051, "body": "You are using Dir wrong. Try <code>thisFile = Dir(inPath)</code> and after <code>Do While thisFile &lt;&gt; &quot;&quot;</code> put an If condition <code>If Right(thisFile, 3) = &quot;msg&quot; Then</code>,and you don&#39;t need to physically open messages to get attachments as far as I know."}, {"owner": {"reputation": 5487, "user_id": 2909692, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/05ad9fe4a2d294b296a7bc3eba97850a?s=128&d=identicon&r=PG&f=1", "display_name": "Sauron", "link": "https://stackoverflow.com/users/2909692/sauron"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493766280, "post_id": 43748113, "comment_id": 74540226, "body": "@Tehscript can you post and answer with the full script out?"}], "answers": [{"comments": [{"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 5487, "user_id": 2909692, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/05ad9fe4a2d294b296a7bc3eba97850a?s=128&d=identicon&r=PG&f=1", "display_name": "Sauron", "link": "https://stackoverflow.com/users/2909692/sauron"}, "edited": false, "score": 0, "creation_date": 1493767874, "post_id": 43748633, "comment_id": 74540595, "body": "Change <code>Debug.Print</code> to <code>Msgbox</code>"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 5487, "user_id": 2909692, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/05ad9fe4a2d294b296a7bc3eba97850a?s=128&d=identicon&r=PG&f=1", "display_name": "Sauron", "link": "https://stackoverflow.com/users/2909692/sauron"}, "edited": false, "score": 0, "creation_date": 1493768280, "post_id": 43748633, "comment_id": 74540693, "body": "Define &quot;This also does not work&quot;. What happens when it does not work?"}, {"owner": {"reputation": 5487, "user_id": 2909692, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/05ad9fe4a2d294b296a7bc3eba97850a?s=128&d=identicon&r=PG&f=1", "display_name": "Sauron", "link": "https://stackoverflow.com/users/2909692/sauron"}, "edited": false, "score": 0, "creation_date": 1493768393, "post_id": 43748633, "comment_id": 74540710, "body": "I see the issue, I did not place a &quot;\\&quot;, in the path. This works now thank you!"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 5487, "user_id": 2909692, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/05ad9fe4a2d294b296a7bc3eba97850a?s=128&d=identicon&r=PG&f=1", "display_name": "Sauron", "link": "https://stackoverflow.com/users/2909692/sauron"}, "edited": false, "score": 0, "creation_date": 1493768717, "post_id": 43748633, "comment_id": 74540775, "body": "You are very welcome. I edited the code to look for new(.xlsx) and old(.xls) excel file formats in the attachment and save them as .csv files. Also uncomment the relevant lines to get filepath, subject, sender email address and recipients email address."}, {"owner": {"reputation": 5487, "user_id": 2909692, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/05ad9fe4a2d294b296a7bc3eba97850a?s=128&d=identicon&r=PG&f=1", "display_name": "Sauron", "link": "https://stackoverflow.com/users/2909692/sauron"}, "edited": false, "score": 0, "creation_date": 1493769748, "post_id": 43748633, "comment_id": 74540998, "body": "Thank you, but it notes the file format and extension are unsafe when attempting to open in excel. Is this the best way to convert to CSV?"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 5487, "user_id": 2909692, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/05ad9fe4a2d294b296a7bc3eba97850a?s=128&d=identicon&r=PG&f=1", "display_name": "Sauron", "link": "https://stackoverflow.com/users/2909692/sauron"}, "edited": false, "score": 0, "creation_date": 1493770257, "post_id": 43748633, "comment_id": 74541118, "body": "No the corrrect way to convert it to csv is <code>objAtt.SaveAs Filename:=outPath &amp; Split(objAtt.DisplayName, &quot;.&quot;)(0) &amp; &quot;.csv&quot;, FileFormat:=xlCSV</code> but Outlook object does not support <code>SaveAs</code> so this is a workaround. Another option is you can save it as it is <code>objAtt.SaveAsFile outPath &amp; objAtt.DisplayName</code>, and then save workbook using the above-mentioned method."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1493772069, "post_id": 43748633, "comment_id": 74541407, "body": "FWIW - If you change <code>thisFile = Dir(inPath)</code> to <code>thisFile = Dir(inPath &amp; &quot;*.msg&quot;)</code> then you won&#39;t need to check the last three characters of the filename within the loop - <code>Dir</code> would only return filenames matching the wildcard specification.  It was the missing <code>inpath &amp; </code> in <code>OpenSharedItem(thisFile)</code> that was probably causing the OP&#39;s problem.  (<code>Dir(inPath)</code> is implicitly doing <code>Dir(inPath &amp; &quot;*.*&quot;)</code>)"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493773342, "post_id": 43748633, "comment_id": 74541657, "body": "@YowE3K That is so true, thank you for revealing this."}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493774128, "post_id": 43748633, "comment_id": 74541820, "body": "When I edit my answer to reflect these changes, my accepted answer and vote is gone. Still trying to get used to the dynamics of SO."}], "tags": [], "owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "is_accepted": true, "score": 5, "last_activity_date": 1493773722, "last_edit_date": 1493773722, "creation_date": 1493766686, "answer_id": 43748633, "question_id": 43748113, "link": "https://stackoverflow.com/questions/43748113/can-not-open-msg-files/43748633#43748633", "title": "Can not open .msg files", "body": "<p>Try this:</p>\n\n<pre><code>Sub OpenMSGRenameDownloadAttachement()\nDim Msg As Outlook.MailItem\nDim objAtt As Outlook.Attachment\nSet objOL = CreateObject(\"Outlook.Application\")\nSet objNs = objOL.GetNamespace(\"MAPI\")\n'objNs.Logon\n\ninPath = \"C:\\January Messages\\\"\noutPath = \"C:\\January Messages\\attachments\\\" 'create this folder for attachments or use your own\nthisFile = Dir(inPath &amp; \"*.msg\")\n\nDo While Len(thisFile) &gt; 0\n    Set Msg = objNs.OpenSharedItem(inPath &amp; thisFile)\n    'MsgBox inPath &amp; thisFile\n    'MsgBox Msg.Subject\n    'MsgBox Msg.SenderEmailAddress\n    'MsgBox Msg.Recipients.Item(1).Address\n    For Each objAtt In Msg.Attachments\n        If Right(objAtt, 4) = \"xlsx\" Or Right(objAtt, 3) = \"xls\" Then\n            objAtt.SaveAsFile outPath &amp; Split(objAtt.DisplayName, \".\")(0) &amp; \".csv\"\n        End If\n    Next\n    thisFile = Dir\nLoop\n\nSet objOL = Nothing\nSet objNs = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5487, "user_id": 2909692, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/05ad9fe4a2d294b296a7bc3eba97850a?s=128&d=identicon&r=PG&f=1", "display_name": "Sauron", "link": "https://stackoverflow.com/users/2909692/sauron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1050, "favorite_count": 0, "accepted_answer_id": 43748633, "answer_count": 1, "score": 1, "last_activity_date": 1592943980, "creation_date": 1493763445, "last_edit_date": 1592943980, "question_id": 43748113, "link": "https://stackoverflow.com/questions/43748113/can-not-open-msg-files", "title": "Can not open .msg files", "body": "<p>I have about 90 .msg, outlook files that I need to open, convert the excel attachment to .csv files and save off.  Presently, the code below is to simply open the .msg outlook file, but the error appears :<a href=\"https://i.stack.imgur.com/1eVgv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1eVgv.png\" alt=\"enter image description here\"></a></p>\n\n<p>How can I permit the .msg files to be opened.</p>\n\n<p>Script:</p>\n\n<pre><code>Sub OpenMSGRenameDownloadAttachement()\n\n    Dim objOL As Outlook.Application\n    Dim Msg As Outlook.MailItem\n\n    Dim MsgCount As Integer\n\n    Set objOL = CreateObject(\"Outlook.Application\")\n\n    'Change the path given month, ie. do this for Jan, Feb, April\n    inPath = \"C:\\January Messages\"\n\n    thisFile = LCase(Dir(inPath &amp; \"\\*.msg\"))\n    Do While thisFile &lt;&gt; \"\"\n\n        Set Msg = objOL.Session.OpenSharedItem(thisFile)\n\n        Msg.Display\n\n        MsgBox Msg.Subject\n        thisFile = Dir\n    Loop\n\n    Set objOL = Nothing\n    Set Msg = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook", "ms-word", "copy-paste"], "answers": [{"tags": [], "owner": {"reputation": 93, "user_id": 5396694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47caec23470dedc0de67edf12aa0c8a8?s=128&d=identicon&r=PG&f=1", "display_name": "NourB", "link": "https://stackoverflow.com/users/5396694/nourb"}, "is_accepted": true, "score": 0, "last_activity_date": 1494843466, "creation_date": 1494843466, "answer_id": 43976904, "question_id": 43747900, "link": "https://stackoverflow.com/questions/43747900/outlook-vba-using-word-inspector-to-create-a-follow-up-meeting-invite/43976904#43976904", "title": "Outlook VBA: Using Word Inspector to create a Follow Up Meeting Invite", "body": "<p><br/><br/>\nI'm not a specialist on this subject but i used to work and manipulate Outlook's AppointmentItem in C# and that's how i see the thing.</p>\n\n<p>Actually, if you try to copy the body of a meeting on another meeting, like you  said, you will lose all the special formating, images, etc.\nThe new body will only contain the caracters without format. \nI think you can't put formatted text on the body property, you have to use the <strong>rtfbody</strong> property or like you did when you copy the body of your original appointment, use the <strong>WordEditor</strong> property in the Inspector object.</p>\n\n<p>So, try to use the WordEditor of the new Item you're creating (like you did to take the original content) and to add content in it.</p>\n\n<p>That's what i had to do for putting formatted text in the body of an AppointmentItem in C#.</p>\n\n<p>I did something like that : </p>\n\n<pre><code>Word.Document myDoc = myItem.GetInspector.WordEditor;\nWord.Paragraphs paragraphs = myDoc.Content.Paragraphs;\n\nWord.Paragraph para = paragraphs.Add();\npara.Range.Text = yourFormattedTextHere;\n</code></pre>\n\n<p>After that, you may need to release the variables created, but i'm not sure about that.</p>\n"}], "owner": {"reputation": 1, "user_id": 4868954, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uEvwJa5RGb8/AAAAAAAAAAI/AAAAAAAAADU/ROrZsTbAX5c/photo.jpg?sz=128", "display_name": "Amit Shah", "link": "https://stackoverflow.com/users/4868954/amit-shah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 488, "favorite_count": 0, "accepted_answer_id": 43976904, "answer_count": 1, "score": 0, "last_activity_date": 1522178407, "creation_date": 1493762310, "last_edit_date": 1522178407, "question_id": 43747900, "link": "https://stackoverflow.com/questions/43747900/outlook-vba-using-word-inspector-to-create-a-follow-up-meeting-invite", "title": "Outlook VBA: Using Word Inspector to create a Follow Up Meeting Invite", "body": "<p>I am creating a VBA Macro in Outlook that will copy an existing meeting invite and create a follow up meeting invite. It should be fairly easy since I have all the parts to this puzzle. </p>\n\n<p>My problem is with the body of the invite; all formatting and pictures are lost. For this reason, I need to use the Word Inspector object to preserve any special formatting and images. I figured out the code using Word and recording a macro. </p>\n\n<p>So  I have figured out the code for copying text using the Word Inspector, but I am not sure on how to paste it in another invite.</p>\n\n<pre><code>Sub copyPaste()\n    Dim objOL As Outlook.Application\n    Dim objNS As Outlook.NameSpace\n    On Error Resume Next\n    Set objOL = Application\n    If objOL.ActiveInspector.EditorType = olEditorWord Then\n        Set objDoc = objOL.ActiveInspector.WordEditor\n        Set objNS = objOL.Session\n        Set objSel = objDoc.Windows(1).Selection\n        objSel.WholeStory\n        objSel.Copy\n        objSel.PasteAndFormat (wdFormatOriginalFormatting)\n    End If\n    Set objOL = Nothing\n    Set objNS = Nothing\nEnd Sub\n</code></pre>\n\n<p>Please see my current Outlook code: </p>\n\n<pre><code>Sub scheduleFollowUpMeeting()\n  'Declarations\n  Dim obj As Object\n  Dim Sel As Outlook.Selection\n  'Selecting the Email\n  If TypeOf Application.ActiveWindow Is Outlook.Inspector Then\n    Set obj = Application.ActiveInspector.currentItem\n  Else\n    Set Sel = Application.ActiveExplorer.Selection\n    If Sel.Count Then\n      Set obj = Sel(1)\n    End If\n  End If\n\n  If Not obj Is Nothing Then\n    MsgBox \"The original meeting has been copied.\" &amp; vbCrLf &amp; \"Please kindly update any new details like date/time.\", , \"Follow Up Meeting - Amit P Shah\"\n    Dim objFollowUp As Outlook.AppointmentItem\n    Set objFollowUp = Application.CreateItem(olAppointmentItem)\n    'Copies existing details from original Invite\n    With objFollowUp\n        .MeetingStatus = olMeeting\n        .Subject = \"Follow Up: \" &amp; obj.Subject\n        .Body = obj.Body\n        .Start = Now + 1 'Takes today's date and adds 1 day\n        .End = DateAdd(\"n\", obj.Duration, .Start)\n        'Other\n        .AllDayEvent = obj.AllDayEvent\n        .BusyStatus = obj.BusyStatus\n        .Categories = obj.Categories\n        .Companies = obj.Companies\n        .ForceUpdateToAllAttendees = obj.ForceUpdateToAllAttendees\n        .Importance = obj.Importance\n        .Location = obj.Location\n        .OptionalAttendees = obj.OptionalAttendees\n        .ReminderMinutesBeforeStart = obj.ReminderMinutesBeforeStart\n        .ReminderOverrideDefault = obj.ReminderOverrideDefault\n        .ReminderPlaySound = obj.ReminderPlaySound\n        .ReminderSet = obj.ReminderSet\n        .ReminderSoundFile = obj.ReminderSoundFile\n        .ReplyTime = obj.ReplyTime\n        .RequiredAttendees = obj.RequiredAttendees\n        .Resources = obj.Resources\n        .ResponseRequested = obj.ResponseRequested\n        .Sensitivity = obj.Sensitivity\n        .UnRead = obj.UnRead\n\n        .Display\n    End With\n  End If\n\nEnd Sub\n</code></pre>\n\n<p>Any help would greatly be appreciated. Many thanks in advance! </p>\n"}, {"tags": ["vba", "outlook", "clipboard", "rtf"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1493762946, "post_id": 43747860, "comment_id": 74539171, "body": "interesting .. I didn&#39;t know that it can set anything other than text <a href=\"https://msdn.microsoft.com/en-us/library/aa244176\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa244176</a>. If <code>vbCFRTF</code> doesn&#39;t work either, you can try the <code>RICHTEXT.RichtextCtrl</code> control <a href=\"http://stackoverflow.com/questions/42576291/convert-rtf-rich-text-format-code-into-plain-text-in-excel/42579833#42579833\" title=\"convert rtf rich text format code into plain text in excel\">stackoverflow.com/questions/42576291/&hellip;</a> (but there must be a better way to do that in Outlook and Word)"}, {"owner": {"reputation": 13331, "user_id": 4473405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ffcNj.jpg?s=128&g=1", "display_name": "Keith Hall", "link": "https://stackoverflow.com/users/4473405/keith-hall"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1493789367, "post_id": 43747860, "comment_id": 74545563, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/system.windows.textdataformat(v=vs.110).aspx\" rel=\"nofollow noreferrer\"><code>TextDataFormat</code> seems to be a .NET thing</a> - @Slai is on the right track with the link to the VB6 <code>SetText</code> method - if <code>vbCFRTF</code> isn&#39;t recognized, use it&#39;s value, <code>&amp;HBF01</code>"}], "owner": {"reputation": 1258, "user_id": 4383152, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/152bf463f05774e13dec69c45832882b?s=128&d=identicon&r=PG&f=1", "display_name": "BerndGit", "link": "https://stackoverflow.com/users/4383152/berndgit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 732, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1493762602, "creation_date": 1493762025, "last_edit_date": 1493762602, "question_id": 43747860, "link": "https://stackoverflow.com/questions/43747860/vba-copy-rtf-to-clipboard", "title": "VBA copy RTF to clipboard", "body": "<p>I want to use a VBA makro in MS Outlook to copy some RFT to the clipboard. This is how far I got with my limited VBA knowlege and some googeling (Yes, I have seen that there are related questions in SO, but I didn't find a minimal runnable example):</p>\n\n<pre><code>Sub TestRTFcopy()\n\n\n       Dim Clipboard As New DataObject\n       rtfFrag = \"{\\rtf{\\fonttbl {\\f0 Times New Roman;}}\\f0\\fs60 Hello, World!}\"\n       Clipboard.SetText rtfFrag, TextDataFormat.RTF\n       Clipboard.PutInClipboard\n\n       MsgBox (\"Copied\")\n\nEnd Sub\n</code></pre>\n\n<p>I get <code>Runtime error 424: Object required</code></p>\n\n<p>If I shorten to <code>Clipboard.SetText rtfFrag</code> would do the copy, but the result is in plain text. </p>\n\n<p>Seems that VBA doesn't find <code>TextDataFormat.RTF</code>. How to fix this?</p>\n"}, {"tags": ["vba", "outlook", "type-mismatch"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 3507532, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3941854deecbbeece5ff653c0cc94567?s=128&d=identicon&r=PG", "display_name": "Isendra", "link": "https://stackoverflow.com/users/3507532/isendra"}, "edited": false, "score": 1, "creation_date": 1493770158, "post_id": 43748052, "comment_id": 74541100, "body": "Interesting, so with the picker there is no need to select the base folder with myInbox.   huh.  If I adapted to moving from subfolder to subfolder, would I still need the .parent stuff?  I bet not.   Thanks!!"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 57, "user_id": 3507532, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3941854deecbbeece5ff653c0cc94567?s=128&d=identicon&r=PG", "display_name": "Isendra", "link": "https://stackoverflow.com/users/3507532/isendra"}, "edited": false, "score": 0, "creation_date": 1493771660, "post_id": 43748052, "comment_id": 74541322, "body": "You are moving Items from inbox, you can change that with picker from and to picker and it should work"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 1, "last_activity_date": 1493772138, "last_edit_date": 1493772138, "creation_date": 1493763111, "answer_id": 43748052, "question_id": 43747759, "link": "https://stackoverflow.com/questions/43747759/type-mismatch-error-when-referencing-folder-with-pickfolder/43748052#43748052", "title": "Type Mismatch Error when referencing Folder with PickFolder", "body": "<p><em>That line should be <strong><code>Set myDestFolder = mySubFolder</code></em></strong></p>\n\n<p>You may wanna also use <code>If mySubFolder Is Nothing Then Exit Sub</code> just in case user decides to cancel the <code>myNameSpace.PickFolder</code> so you don't get <code>run-time error</code></p>\n\n<pre><code>Option Explicit\nSub MoveItems()\n     Dim myNameSpace As Outlook.NameSpace\n     Dim myInbox As Outlook.Folder\n     Dim mySubFolder As Outlook.Folder\n     Dim myDestFolder As Outlook.Folder\n     Dim myItem As Object\n\n     Set myNameSpace = Application.GetNamespace(\"MAPI\")\n     Set myInbox = myNameSpace.GetDefaultFolder(olFolderInbox)\n     Set mySubFolder = myNameSpace.PickFolder\n\n    If mySubFolder Is Nothing Then Exit Sub\n\n     Set myDestFolder = mySubFolder\n     Set myItem = GetCurrentItem()\n\n     myItem.Move myDestFolder\n\nEnd Sub\n\nFunction GetCurrentItem() As Object\n    Dim objApp As Outlook.Application\n\n    Set objApp = Application\n    On Error Resume Next\n    Select Case TypeName(objApp.ActiveWindow)\n        Case \"Explorer\"\n            Set GetCurrentItem = objApp.ActiveExplorer.Selection.Item(1)\n        Case \"Inspector\"\n            Set GetCurrentItem = objApp.ActiveInspector.CurrentItem\n    End Select\n\n    Set objApp = Nothing\nEnd Function\n</code></pre>\n\n<hr>\n\n<p><strong><em><a href=\"https://msdn.microsoft.com/en-us/library/5adx7fxz(v=vs.90).aspx\" rel=\"nofollow noreferrer\">IsNothing Function</a></em></strong></p>\n\n<blockquote>\n  <p><em><sub><strong><a href=\"https://msdn.microsoft.com/en-us/library/5adx7fxz(v=vs.90).aspx\" rel=\"nofollow noreferrer\">IsNothing</a></strong> returns True if the expression represents an object variable that currently has no object assigned to it; otherwise, it returns False.</sub></em></p>\n</blockquote>\n"}], "owner": {"reputation": 57, "user_id": 3507532, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3941854deecbbeece5ff653c0cc94567?s=128&d=identicon&r=PG", "display_name": "Isendra", "link": "https://stackoverflow.com/users/3507532/isendra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 581, "favorite_count": 0, "accepted_answer_id": 43748052, "answer_count": 1, "score": 1, "last_activity_date": 1593248284, "creation_date": 1493761601, "last_edit_date": 1593248284, "question_id": 43747759, "link": "https://stackoverflow.com/questions/43747759/type-mismatch-error-when-referencing-folder-with-pickfolder", "title": "Type Mismatch Error when referencing Folder with PickFolder", "body": "<p>The following is supposed to launch a popup folder picker, and then move the current item to the selected folder.</p>\n\n<pre><code> Sub MoveItems()\n     Dim myNameSpace As Outlook.NameSpace\n     Dim myInbox As Outlook.Folder\n     Dim mySubFolder As Outlook.Folder\n     Dim myDestFolder As Outlook.Folder\n     Dim myItem As Object\n\n     Set myNameSpace = Application.GetNamespace(\"MAPI\")\n     Set myInbox = myNameSpace.GetDefaultFolder(olFolderInbox)\n     Set mySubFolder = myNameSpace.PickFolder\n     Set myDestFolder = myInbox.Folders(mySubFolder)\n     Set myItem = GetCurrentItem()\n\n     myItem.Move myDestFolder\n\nEnd Sub\n</code></pre>\n\n<p>I am getting a Type Mismatch on the line </p>\n\n<pre><code>Set myDestFolder = myInbox.Folders(mySubFolder)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 2, "last_activity_date": 1493761275, "last_edit_date": 1493761275, "creation_date": 1493760793, "answer_id": 43747596, "question_id": 43747544, "link": "https://stackoverflow.com/questions/43747544/vba-writing-iferror-to-multiple-cells-with-for-next-loop/43747596#43747596", "title": "VBA Writing IFERROR to Multiple Cells with For...Next Loop", "body": "<p>You can instead just use <code>.Formula</code>:</p>\n\n<p><code>w(1).Cells(a, 3).Formula = \"=IFERROR(IFERROR(A\" &amp; a &amp; \",B\" &amp; a &amp; \"),\"\"\"\")\"</code></p>\n\n<p>Note you can skip the loop and just use a range:</p>\n\n<pre><code>Sub HardCodeIFERROR()\nDim ws1 As Worksheet\nDim a As Integer, xRecordCount1 As Integer\nSet ws1 = Sheets(\"Sheet1\")\nxRecordCount1 = ws1.Cells(ws1.Rows.Count, 1).End(xlUp).Row\n\nWith ws1\n    .Range(.Cells(1, 3), .Cells(xRecordCount1, 3)).FormulaR1C1 = \"=IFERROR(IFERROR(RC[-2],RC[-1]),\"\"\"\")\"\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Note: Make sure to use the sheet with the <code>Rows.Count</code> whenever you use it, just like you do with <code>Cells()</code> and <code>Range()</code>.  Also, I changed the sheet name because I wasn't sure if you intended to do a Sheet Array or not, so I used a more clear (IMO) variable name.  </p>\n"}, {"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1493761189, "post_id": 43747627, "comment_id": 74538487, "body": "Nice, I had the same idea in using a range instead of looping.  Just curious if you think doing the <code>w(1)</code> as the variable is a good idea? It may very well be, but I haven&#39;t seen arrays really used with worksheet names so am just curious."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1493761589, "post_id": 43747627, "comment_id": 74538644, "body": "@BruceWayne - I can see uses for using an &quot;array of worksheets&quot; (e.g. one worksheet for each month, accessed by the month number?), and I think I have actually done it myself once or twice in the past, but it&#39;s not something I would recommend the use of to someone who wasn&#39;t already using it.  I&#39;m not sure why the OP was using it but, apart from the declaration (maybe it was a global variable?), they were using it consistently and correctly so I didn&#39;t want to change their code for no real reason."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1493783222, "post_id": 43747627, "comment_id": 74543760, "body": "@BruceWayne <a href=\"http://stackoverflow.com/a/43750702/6535336\">stackoverflow.com/a/43750702/6535336</a> (an array seemed the easiest thing to use)"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 1, "last_activity_date": 1493760966, "creation_date": 1493760966, "answer_id": 43747627, "question_id": 43747544, "link": "https://stackoverflow.com/questions/43747544/vba-writing-iferror-to-multiple-cells-with-for-next-loop/43747627#43747627", "title": "VBA Writing IFERROR to Multiple Cells with For...Next Loop", "body": "<p>Just use the <code>Formula</code> property:</p>\n\n<pre><code>Sub HardCodeIFERROR()             \n    Dim a As Integer, xRecordCount1 As Integer\n    'Need to declare the size of the array if you are going to assign worksheets to \"w(1)\"\n    Dim w(1 To 1) As Worksheet\n    Set w(1) = Sheets(\"ABC\")\n    'Ensure you fully qualify \"Rows.Count\" by specifying which worksheet you are referring to\n    xRecordCount1 = w(1).Cells(w(1).Rows.Count, 1).End(xlUp).Row\n    'Apply formula to all cells\n    w(1).Range(\"C1:C\" &amp; xRecordCount1).Formula = \"=IFERROR(IFERROR(S1,V1),\"\"\"\")\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7953942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf01e4476139892b9150440b00509ef8?s=128&d=identicon&r=PG&f=1", "display_name": "MtArronK", "link": "https://stackoverflow.com/users/7953942/mtarronk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 43747596, "answer_count": 2, "score": 0, "last_activity_date": 1493761275, "creation_date": 1493760561, "last_edit_date": 1493760802, "question_id": 43747544, "link": "https://stackoverflow.com/questions/43747544/vba-writing-iferror-to-multiple-cells-with-for-next-loop", "title": "VBA Writing IFERROR to Multiple Cells with For...Next Loop", "body": "<p>I am trying to apply \"=IFERROR\" to a spreadsheet containing over 1000 rows of data. I already came up with a way to make the entries hard-coded. But is there a way to fill the cells with something like \"=IFERROR(IFERROR(A1,B1),\"\")\" rather than the value? Below is the hard-coded version:</p>\n\n<pre><code>Sub HardCodeIFERROR()             \n    Dim a As Integer, xRecordCount1 As Integer\n    Set w(1) = Sheets(\"ABC\")\n    xRecordCount1 = w(1).Cells(Rows.Count, 1).End(xlUp).Row\n\n    For a = 1 To xRecordCount1\n\n        w(1).Cells(a, 3).Value = Application.WorksheetFunction.IfError(Application.WorksheetFunction.IfError(Range(\"A\" &amp; a), Range(\"B\" &amp; a)), \"\")\n\n        Next a\n    Exit Sub\n\n\nEnd Sub\n</code></pre>\n\n<p>Thank you in advance for your help!</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1493761727, "post_id": 43747115, "comment_id": 74538700, "body": "Syntax Me.containername.Form.Filter = &quot;criteria&quot; works for me. Cannot replicate the issue. If you want to provide db for analysis, upload to fileshare site such as Box.com and post link."}, {"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 0, "creation_date": 1493774890, "post_id": 43747115, "comment_id": 74541988, "body": "You have two different names for subform: <code>frmNewGeneralclassification_fill_in</code> and <code>frmJob_Title_Lookup</code>. Which one is right? Make sure that you use control name here. Also this error may be not related to filtering at all. If you don&#39;t have error handlers in the code of subform, but have in the main form, it may show the error from subform. Try to comment all code in the subform."}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 4620432, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/13b20e7a4e8080dd0454890e734329a5?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4620432/david"}, "edited": false, "score": 0, "creation_date": 1493868574, "post_id": 43750518, "comment_id": 74587783, "body": "I think I tried that too.  I did a lot of permutations.  I think the big bad catch was that it doesn&#39;t want to do a LIKE statement.  If you&#39;ve been able to get a like statement to work, let me know."}, {"owner": {"reputation": 32, "user_id": 2595265, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRoIK.jpg?s=128&g=1", "display_name": "OzRoz", "link": "https://stackoverflow.com/users/2595265/ozroz"}, "reply_to_user": {"reputation": 107, "user_id": 4620432, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/13b20e7a4e8080dd0454890e734329a5?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4620432/david"}, "edited": false, "score": 0, "creation_date": 1493966880, "post_id": 43750518, "comment_id": 74636602, "body": "I use &#39;Like&#39; statements like this all the time - no problem in either queries or vba"}, {"owner": {"reputation": 107, "user_id": 4620432, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/13b20e7a4e8080dd0454890e734329a5?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4620432/david"}, "edited": false, "score": 0, "creation_date": 1494175334, "post_id": 43750518, "comment_id": 74704697, "body": "can you post some code where you&#39;ve used it to filter a subform from a main form?  I have it working where I&#39;m filtering the form the code resides in, but not the subform."}, {"owner": {"reputation": 32, "user_id": 2595265, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRoIK.jpg?s=128&g=1", "display_name": "OzRoz", "link": "https://stackoverflow.com/users/2595265/ozroz"}, "reply_to_user": {"reputation": 107, "user_id": 4620432, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/13b20e7a4e8080dd0454890e734329a5?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4620432/david"}, "edited": false, "score": 0, "creation_date": 1494293489, "post_id": 43750518, "comment_id": 74754818, "body": "I&#39;ve edited my answer to include more code and a screenshot"}], "tags": [], "owner": {"reputation": 32, "user_id": 2595265, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRoIK.jpg?s=128&g=1", "display_name": "OzRoz", "link": "https://stackoverflow.com/users/2595265/ozroz"}, "is_accepted": true, "score": 1, "last_activity_date": 1494293462, "last_edit_date": 1494293462, "creation_date": 1493781738, "answer_id": 43750518, "question_id": 43747115, "link": "https://stackoverflow.com/questions/43747115/trying-to-filter-subform-based-on-contents-of-field-on-main-form/43750518#43750518", "title": "trying to filter subform based on contents of field on main form", "body": "<p>I agree that referencing subforms is really confusing in Access. In this case, try not using 'me' and just fully reference what you need (and remember to turn on your filter):</p>\n\n<p><a href=\"https://i.stack.imgur.com/YFXfF.jpg\" rel=\"nofollow noreferrer\">Screenshot of my form with subform</a></p>\n\n<pre><code>Private Sub txtSearch_AfterUpdate()\nDim strWhere As String\nstrWhere = \"\"\n\n\nIf Not IsNull(Me.txtSearch) Then\n    strWhere = strWhere &amp; \" ([ItemCode] like '*\" &amp; Me.txtSearch &amp; \"*' OR \"\n    strWhere = strWhere &amp; \" [ItemDescription] like '*\" &amp; Me.txtSearch &amp; \"*') AND \"\nEnd If\n\n\n'remove final AND\nIf strWhere &lt;&gt; \"\" Then\n    strWhere = Left(strWhere, Len(strWhere) - 5)\n\n\n    Forms!frmItemList.frmItemListItemsSF.Form.Filter = strWhere\n    Forms!frmItemList.frmItemListItemsSF.Form.FilterOn = True\nElse\n    strWhere = \"1=1\" 'this is always true and forces the filter to clear\n    Forms!frmItemList.frmItemListItemsSF.Form.Filter = strWhere\n    Forms!frmItemList.frmItemListItemsSF.Form.FilterOn = True\nEnd If\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 107, "user_id": 4620432, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/13b20e7a4e8080dd0454890e734329a5?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4620432/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 514, "favorite_count": 0, "accepted_answer_id": 43750518, "answer_count": 1, "score": 0, "last_activity_date": 1494293462, "creation_date": 1493758683, "question_id": 43747115, "link": "https://stackoverflow.com/questions/43747115/trying-to-filter-subform-based-on-contents-of-field-on-main-form", "title": "trying to filter subform based on contents of field on main form", "body": "<p>I've looked at a bunch of other posts, an nothing seems to get it.  This damned Access nomenclature always throws me.</p>\n\n<p>I've got a main form, with a subform.  I want to be able to enter a string into a field on the main form, and have the subform filtered as follows:</p>\n\n<pre><code>[Title on Eligibility List] like \"\"*\" &amp; frmNewGeneralclassification_fill_in.!txtsearchstring &amp; \"*\"\"\n</code></pre>\n\n<p>This is not a \"link master and child\" situation.  It's doing a LIKE match.</p>\n\n<p>I've tried</p>\n\n<pre><code>me!frmNewGeneralclassification_fill_in.form.filter = \"[Title on Eligibility List] like '*\" &amp; me!txtSearchString &amp; \"*'\"\n</code></pre>\n\n<p>and</p>\n\n<pre><code>me.frmNewGeneralclassification_fill_in.form.filter = \"[Title on Eligibility List] like '*\" &amp; me!txtSearchString &amp; \"*'\"\n</code></pre>\n\n<p>(Filter is not an Autosense option, but if I type it in anyway, it capitalizes it.)</p>\n\n<p>and I get \"object required\" error message.</p>\n\n<p>One of those SHOULD work, but they're not.</p>\n\n<p>and</p>\n\n<pre><code>frmJob_Title_Lookup.Form.RecordSource = \"SELECT [Job Title to New Classification].[Title on Eligibility list], [Job Title to New Classification].Employer, [Job Title to New Classification].[New Classification in EE], [Job Title to New Classification].[New General Classification] FROM [Job Title to New Classification] WHERE ((([Job Title to New Classification].[New Classification in EE]) Is Not Null) AND (([Job Title to New Classification].[New General Classification]) Is Not Null)) and ([Title on Elibibility List] like '*\" &amp; frmNewGeneralclassification_fill_in.txtSearchString &amp; \"*'\"\n    frmJob_Title_Lookup.Form.Requery\n</code></pre>\n\n<p>and I get \"Object Required\" error message.</p>\n\n<p>Any pointers?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1493760077, "post_id": 43746626, "comment_id": 74537957, "body": "The documentation mentions &quot;Comparison operators all have equal precedence; that is, they are evaluated in the left-to-right order in which they appear&quot; <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278455.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/gg278455.aspx</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1493760300, "post_id": 43746626, "comment_id": 74538074, "body": "@Slai from that link: &quot;Comparison operators all have equal precedence; that is, they are evaluated in the left-to-right order in which they appear.&quot; - not sure what your comment implies."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1493762142, "post_id": 43746626, "comment_id": 74538858, "body": "@Mat&#39;sMug too used to the MSDN Remarks section being at the bottom half and didn&#39;t notice it before commenting"}], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 7227935, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9649a2d89a247a414031a239212d589c?s=128&d=identicon&r=PG&f=1", "display_name": "kumquatwhat", "link": "https://stackoverflow.com/users/7227935/kumquatwhat"}, "edited": false, "score": 0, "creation_date": 1493757324, "post_id": 43746739, "comment_id": 74536612, "body": "Oh...right.  Integer values of <code>True</code> and <code>False</code>.  Does this mean there&#39;s no function just to say &quot;X is between these two values&quot;?"}, {"owner": {"reputation": 594, "user_id": 781429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07f97c79613bbfdec747296ba9a91b64?s=128&d=identicon&r=PG", "display_name": "Dessma", "link": "https://stackoverflow.com/users/781429/dessma"}, "edited": false, "score": 2, "creation_date": 1493757412, "post_id": 43746739, "comment_id": 74536659, "body": "you will have to do A&lt;B AND B&lt;C"}], "tags": [], "owner": {"reputation": 2214, "user_id": 806808, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1c0b2b7f56ea26e55834aeed7a16e989?s=128&d=identicon&r=PG", "display_name": "Andrey Belykh", "link": "https://stackoverflow.com/users/806808/andrey-belykh"}, "is_accepted": false, "score": 0, "last_activity_date": 1493757145, "creation_date": 1493757145, "answer_id": 43746739, "question_id": 43746626, "link": "https://stackoverflow.com/questions/43746626/vba-policy-on-double-sided-inequalities/43746739#43746739", "title": "VBA policy on double sided inequalities?", "body": "<p>5&lt;9&lt;8 = True&lt;8 = True</p>\n\n<p>5&lt;4&lt;8 = False&lt;8 = True</p>\n"}, {"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1493757345, "post_id": 43746763, "comment_id": 74536627, "body": "Correct - this is why <code>2&lt;4&lt;-1</code> will return <code>False</code>"}, {"owner": {"reputation": 185, "user_id": 7227935, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9649a2d89a247a414031a239212d589c?s=128&d=identicon&r=PG&f=1", "display_name": "kumquatwhat", "link": "https://stackoverflow.com/users/7227935/kumquatwhat"}, "edited": false, "score": 0, "creation_date": 1493757428, "post_id": 43746763, "comment_id": 74536667, "body": "Right.  Riiiiiiiiight.  I should have known that.  Does that mean there&#39;s no function specifically to say &quot;X is between these two values&quot;?  Just gotta&#39; roll with either a custom function of endless use of <code>And</code>?"}, {"owner": {"reputation": 594, "user_id": 781429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07f97c79613bbfdec747296ba9a91b64?s=128&d=identicon&r=PG", "display_name": "Dessma", "link": "https://stackoverflow.com/users/781429/dessma"}, "edited": false, "score": 0, "creation_date": 1493757488, "post_id": 43746763, "comment_id": 74536692, "body": "Pretty much the chain of &quot;and&quot;."}], "tags": [], "owner": {"reputation": 594, "user_id": 781429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07f97c79613bbfdec747296ba9a91b64?s=128&d=identicon&r=PG", "display_name": "Dessma", "link": "https://stackoverflow.com/users/781429/dessma"}, "is_accepted": true, "score": 4, "last_activity_date": 1493757235, "creation_date": 1493757235, "answer_id": 43746763, "question_id": 43746626, "link": "https://stackoverflow.com/questions/43746626/vba-policy-on-double-sided-inequalities/43746763#43746763", "title": "VBA policy on double sided inequalities?", "body": "<p>I have no clue but my educated guess would be that it first evaluates the left side of the equation (5&lt;9) which gives TRUE. Then, it proceeds to evaluate the rest (TRUE&lt;8) and implicitly converts TRUE to its integer value (I believe this to be -1 in VB).</p>\n\n<p>-1&lt;8 -> TRUE</p>\n\n<p>Works with the second case as well since FALSE will convert to 0 and 0&lt;8.</p>\n\n<p>Basically it would have everything to do with implicit conversion of boolean to integer and their respective value in VBA.</p>\n"}, {"comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 1, "creation_date": 1493758697, "post_id": 43746891, "comment_id": 74537297, "body": "I like your new logo :] <code>Select Case</code> seems like overkill and deceiving, because <code>IsBetween(1, 1, 1)</code> is true"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1493758822, "post_id": 43746891, "comment_id": 74537367, "body": "@Slai Cheers :) Re-did my site and decided I needed a consistent &quot;brand&quot; - In hindsight I agree with your comment so I&#39;ll edit it out"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 3, "last_activity_date": 1493758839, "last_edit_date": 1493758839, "creation_date": 1493757749, "answer_id": 43746891, "question_id": 43746626, "link": "https://stackoverflow.com/questions/43746626/vba-policy-on-double-sided-inequalities/43746891#43746891", "title": "VBA policy on double sided inequalities?", "body": "<p>It's to do with the way VBA evaluates expressions and implicit conversion. The first part of the equation is evaluated and the result stored as a numeric value (the boolean is implicitly converted to an integer)</p>\n\n<p>(well.... technically a boolean <em>is</em> just an integer, but we'll just go along like so...)</p>\n\n<pre><code>'// True = -1\n'// False = 0\n\nDebug.Print 5 &lt; 9 &lt; 8\n\nDebug.Print CInt(5 &lt; 9) '// Prints -1\n\nDebug.Print -1 &lt; 8 '// = True\n</code></pre>\n\n<p>Which is why the following gives \"False\" instead:</p>\n\n<pre><code>Debug.Print 5 &lt; 9 &lt; -1\n</code></pre>\n\n<p>Because</p>\n\n<pre><code>Debug.Print Cint(5 &lt; 9) '// True = -1\nDebug.Print -1 &lt; -1 '// False\n</code></pre>\n\n<hr>\n\n<p>If you want to find out if something is in the middle of two other numbers then you have to use the <code>And</code> operator to force a separate evaluation (either side of the operator is then evaluated and compared logically)</p>\n\n<pre><code>Debug.Print (3 &lt; 5 And 5 &lt; 4) '// False\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1495999414, "post_id": 43747423, "comment_id": 75472149, "body": "I like your pretty parse tree +1"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 3, "last_activity_date": 1493759969, "creation_date": 1493759969, "answer_id": 43747423, "question_id": 43746626, "link": "https://stackoverflow.com/questions/43746626/vba-policy-on-double-sided-inequalities/43747423#43747423", "title": "VBA policy on double sided inequalities?", "body": "<p>Looking at it from a parse tree perspective might shed more light about <em>why</em> it works that way.</p>\n\n<p>Excluding whatever instruction comes after the <code>THEN</code> token, the parse tree for <code>If 5 &lt; X &lt; 8 Then</code> might look something like this (quite simplified):</p>\n\n<p><a href=\"https://i.stack.imgur.com/kNUS0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kNUS0.png\" alt=\"expression tree\"></a></p>\n\n<p>The comparison operators being a <em>binary operator</em>, there's an <em>expression</em> on either side of it, and in order to resolve the Boolean expression for the <code>IfBlockStatement</code>, VBA needs to visit the tree nodes in a specific order: because VBA parses expressions left to right, the <code>5 &lt; X</code> part stands on its own as an expression, and then the result of that expression is used to resolve the <code>{expression} &lt; 8</code> part of the expression.</p>\n\n<p>So when VBA resolves <code>5 &lt; X</code>, because that's a <code>ComparisonExpression</code> the result is a <code>Boolean</code> value; when that Boolean value then needs to be compared to the <code>8</code> integer literal, VBA performs an implicit type conversion and actually compares <code>CInt({Boolean}) &lt; 8</code>, which will evaluate to <code>True</code> regardless of the result of the first expression, since <code>False</code> converts to <code>0</code> and <code>True</code> converts to <code>-1</code> when expressed as an integer literal, and both are <code>&lt; 8</code>.</p>\n\n<p>These mechanics are built into how the runtime works, so in order to evaluate if <code>X</code> is between <code>5</code> and <code>8</code>, you need to build your expression so that it's parsed as such:</p>\n\n<pre><code>If X &gt; 5 And X &lt; 8 Then\n</code></pre>\n\n<p>That gives you two distinct expression trees joined by a <code>LogicalAndOperator</code>, which then works off a valid Boolean expression on either sides.</p>\n"}, {"tags": [], "owner": {"reputation": 606, "user_id": 8418085, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-wgKLCdJPlCI/AAAAAAAAAAI/AAAAAAAAAB8/F2Q9FAGsmGc/photo.jpg?sz=128", "display_name": "Yin Cognyto", "link": "https://stackoverflow.com/users/8418085/yin-cognyto"}, "is_accepted": false, "score": 0, "last_activity_date": 1575467845, "creation_date": 1575467845, "answer_id": 59177702, "question_id": 43746626, "link": "https://stackoverflow.com/questions/43746626/vba-policy-on-double-sided-inequalities/59177702#59177702", "title": "VBA policy on double sided inequalities?", "body": "<p>The other answers covered up nicely the first part of your question, but didn't satisfactorily cover up the second part of it, i.e. <em>What is a quick and pretty way of writing <code>If 5 &lt; X &lt; 8 Then</code> (to use sample numbers), without having to resort to endless And statements, i.e. <code>If 5 &lt; x And X &lt; 8 Then</code>?</em></p>\n\n<p>There are two ways. The first:</p>\n\n<pre><code>Select Case X\n    Case 5 To 8\n    ...\nEnd Select\n</code></pre>\n\n<p>Here, the value before the <code>To</code> keyword must be the smaller value of the two. Also note that while this will work for integers, I have no idea if it works for types like <code>Double</code> and such (I suspect it won't though).</p>\n\n<p>The second way, which works irrespective of whether the interval bounds are integers or not, is not necessarily shorter, but it evaluates things in a single comparison:</p>\n\n<pre><code>If Sgn(x - 5) + Sgn(x - 8) = 0 Then ...\n</code></pre>\n\n<p>This is an interesting way of evaluating whether a value is between some bounds, because it can also provide information on whether the value is equal to one of those bounds or is \"outside\" them (and on which \"side\" it is). For example, on a <code>-\u221e..0..+\u221e</code> axis:</p>\n\n<ul>\n<li>if x = 4, the expression above is -2, thus x is to the left of the (5..8) interval</li>\n<li>if x = 5, the expression above is -1, thus x is the left bound of the (5..8) interval</li>\n<li>if x = 6, the expression above is \u00a00, thus x is inside the (5..8) interval, i.e. between its bounds</li>\n<li>if x = 8, the expression above is \u00a01, thus x is the right bound of the (5..8) interval</li>\n<li>if x = 9, the expression above is \u00a02, thus x is to the right of the (5..8) interval</li>\n</ul>\n\n<p>Of course, if you want to include the bounds in the interval, say, test <code>If 5 &lt;= x And X &lt;= 8 Then</code>, the comparison above becomes <code>If Abs(Sgn(x - 5) + Sgn(x - 8)) &lt; 2 Then ...</code>, which is another shortcut to check if the expression is -1, 0 or 1.</p>\n\n<p>In the end, none of the ways above are as short as a <code>Between(x, 5, 8)</code> hypothetical function, but at least they are alternatives to the \"classical\" method.</p>\n"}], "owner": {"reputation": 185, "user_id": 7227935, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9649a2d89a247a414031a239212d589c?s=128&d=identicon&r=PG&f=1", "display_name": "kumquatwhat", "link": "https://stackoverflow.com/users/7227935/kumquatwhat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 489, "favorite_count": 0, "accepted_answer_id": 43746763, "answer_count": 5, "score": 2, "last_activity_date": 1575467845, "creation_date": 1493756665, "last_edit_date": 1493759441, "question_id": 43746626, "link": "https://stackoverflow.com/questions/43746626/vba-policy-on-double-sided-inequalities", "title": "VBA policy on double sided inequalities?", "body": "<p>Was fooling around with trying to reduce the length of the code so that it gives off fewer headaches to look at and debug, and I came across this curious little fact:</p>\n\n<pre><code>Debug.Print 5&lt;9&lt;8 'returns \"True\"\n</code></pre>\n\n<p>At first I thought this was because it just checked the first set, but then I found that </p>\n\n<pre><code>Debug.Print 5&lt;4&lt;8 '*also* returns \"True\"\n</code></pre>\n\n<p>Does VBA interpret this kind of triple inequality as an <code>Or</code> statement?  I can't imagine why someone would choose to make that the interpretation VBA makes because it's almost certainly the less used option, but I struggle to think of another explanation.  </p>\n\n<p>Also, what is a quick and pretty way of writing <code>If 5 &lt; X &lt; 8 Then</code> (to use sample numbers), without having to resort to endless <code>And</code> statements, ie <code>If 5 &lt; x And X &lt; 8 Then</code>?  It's okay for one statement, but the doubling of length adds up quick, especially since variables aren't typically named <code>X</code>.  </p>\n\n<p>Edit: okay, it's certainly not an <code>Or</code> because VBA also says that <code>Debug.Print 8&lt;6&lt;2</code> is <code>True</code>.  What on earth is it thinking?</p>\n"}, {"tags": ["sql-server", "excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1493757550, "post_id": 43746309, "comment_id": 74536724, "body": "Did you add these line continuations for the purpose of the post, or the code is identical as in the VBE editor? Because a string literal cannot span multiple lines like this... that code wouldn&#39;t compile."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 5946803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e75fde0806ac8e53721d9de89277bd1f?s=128&d=identicon&r=PG&f=1", "display_name": "George Todd", "link": "https://stackoverflow.com/users/5946803/george-todd"}, "edited": false, "score": 0, "creation_date": 1493924971, "post_id": 43751240, "comment_id": 74622498, "body": "Sorry that was for readability on the website.  I&#39;ll make the edit."}], "tags": [], "owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1493786661, "creation_date": 1493786661, "answer_id": 43751240, "question_id": 43746309, "link": "https://stackoverflow.com/questions/43746309/querying-sql-server-using-excel-vba-issues/43751240#43751240", "title": "Querying SQL Server using Excel VBA issues", "body": "<p>if the code is identical as in the VBE editor then please change this line</p>\n\n<pre><code>.CommandText = \" Select DISTINCT ZoneName, IsoName From vDeal Where PeriodMonth &gt;= \" &amp; _\n    \" '2015-03-01' Order by IsoName, ZoneName ASC \"\n</code></pre>\n\n<p>for reference  <a href=\"https://msdn.microsoft.com/en-us/library/dd627355(v=office.12).aspx#Access2007BuildingSQLStatements_UsingStringCriteria\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/dd627355(v=office.12).aspx#Access2007BuildingSQLStatements_UsingStringCriteria</a></p>\n"}, {"tags": [], "owner": {"reputation": 5, "user_id": 5946803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e75fde0806ac8e53721d9de89277bd1f?s=128&d=identicon&r=PG&f=1", "display_name": "George Todd", "link": "https://stackoverflow.com/users/5946803/george-todd"}, "is_accepted": false, "score": 0, "last_activity_date": 1494352259, "creation_date": 1494352259, "answer_id": 43876684, "question_id": 43746309, "link": "https://stackoverflow.com/questions/43746309/querying-sql-server-using-excel-vba-issues/43876684#43876684", "title": "Querying SQL Server using Excel VBA issues", "body": "<p>Worked it out a different way using ActiveX Data Object.</p>\n\n<pre><code>Dim strSql As String\nDim rs As ADODB.Recordset\nDim conn As ADODB.Connection\n\nDim wks As Worksheet\nSet wks = ThisWorkbook.Worksheets(\"Sheet1\")\n\nSet rs = New ADODB.Recordset\nSet conn = New ADODB.Connection\n\nconn.ConnectionString = \"Provider=####;Data Source=####;Initial Catalog=####;User ID=####;Password=####\"\nconn.ConnectionTimeout = 300\nconn.CursorLocation = adUseClient\nconn.Open\n\nstrSql1 = \"Select DISTINCT ZoneName, IsoName From vDeal Where ZoneName Is NOT NULL and IsoName IS NOT NULL and PeriodMonth &gt; '2015-03-01' Order by IsoName, ZoneName ASC\"\n\nrs.Open strSql1, conn\nIf rs.RecordCount = 0 Then\n    wks.Range(Cells(1, 1).Address).Value = \"No Data\"\nElse\n    wks.Range(Cells(1, 1).Address).CopyFromRecordset rs\n    For i = 0 To rs.Fields.Count - 1\n        wks.Range(Cells(1, 1).Address).Range(\"A1\").Offset(0, i) = rs.Fields.Item(i).Name\n    Next i\nEnd If\n\nrs.Close\n</code></pre>\n\n<p>Using Microsoft ActiveX Data Objects 2.8 Library in the VBA references.</p>\n"}], "owner": {"reputation": 5, "user_id": 5946803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e75fde0806ac8e53721d9de89277bd1f?s=128&d=identicon&r=PG&f=1", "display_name": "George Todd", "link": "https://stackoverflow.com/users/5946803/george-todd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 196, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1494352259, "creation_date": 1493755413, "last_edit_date": 1493929292, "question_id": 43746309, "link": "https://stackoverflow.com/questions/43746309/querying-sql-server-using-excel-vba-issues", "title": "Querying SQL Server using Excel VBA issues", "body": "<p>I am trying to retrieve DISTINCT values using Excel VBA and a SQL Server.  I have established a connection to the DB and can run other queries; however, the following SQL query causes my VBA code to break:</p>\n\n<p>SQL Statement:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>Select DISTINCT ZoneName, IsoName From vDeal \nWhere PeriodMonth &gt;= '2015-03-01' \nOrder by IsoName, ZoneName ASC\n</code></pre>\n\n<p>Excel VBA:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>With ActiveSheet.ListObjects.Add(SourceType:=0, Source:= _\n    \"OLEDB;Provider=Microsoft.Mashup.OleDb.1;Data Source=$Workbook$; &amp; _ \n    Location=LOADZONE_DISTINCT\", Destination:=Range(\"$C$1\")).QueryTable\n    .CommandText = \"Select DISTINCT ZoneName, IsoName From vDeal Where PeriodMonth &gt;= &amp; _\n        '2015-03-01' Order by IsoName, ZoneName ASC\"\n    .CommandType = xlCmdSql\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .BackgroundQuery = True\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .PreserveColumnInfo = True\n    .ListObject.DisplayName = \"LOADZONE_DISTINCT\"\n    .Refresh BackgroundQuery:=False\nEnd With\n</code></pre>\n\n<blockquote>\n  <p>The field PeriodMonth is a date formatted \"yyyy-mm-dd\"</p>\n  \n  <p>Excel error: \"Run-time error '1004': Application-defined or object defined error</p>\n</blockquote>\n\n<p>The SQL query works perfectly in MS SQL Serve Management Studio, so there must be a breakdown on the Excel side.  Could a reference library be missing on the VBA side, or is it a date formatting issue?</p>\n"}, {"tags": ["vba", "ms-access-2010", "pivot-chart"], "comments": [{"owner": {"reputation": 119, "user_id": 7436082, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/02192aff66297a0485e0776b8f4a27f1?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Byars", "link": "https://stackoverflow.com/users/7436082/michael-byars"}, "edited": false, "score": 0, "creation_date": 1493818981, "post_id": 43746209, "comment_id": 74564809, "body": "The specific issue is the <code>.DataLabel</code>.  For some reason Access does not want to accept it after the <code>.points()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 7436082, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/02192aff66297a0485e0776b8f4a27f1?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Byars", "link": "https://stackoverflow.com/users/7436082/michael-byars"}, "edited": false, "score": 0, "creation_date": 1493814552, "post_id": 43751704, "comment_id": 74561248, "body": "Thanks, but unforunetly, this is in Access, not Excel."}], "tags": [], "owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1493789769, "last_edit_date": 1493789769, "creation_date": 1493789172, "answer_id": 43751704, "question_id": 43746209, "link": "https://stackoverflow.com/questions/43746209/vba-ms-access-2010-pivot-line-chart-add-data-label-to-first-marker-only/43751704#43751704", "title": "VBA MS Access 2010 pivot line chart add data label to first marker only", "body": "<p>you can try this.. please insert these line before With Statement</p>\n\n<pre><code>Me.ChartSpace.Charts(0).SeriesCollection(0).Points(1).DataLabel.Select\nSelection.Format.TextFrame2.TextRange.Characters.Text = \"Name\"\n</code></pre>\n\n<p>if issue still persist then try to change <code>Me.ChartSpace.Charts(0)</code> to  <code>Sheets(\"SheetName\").ChartObjects(\"ChartName\")</code> and put the appropriate <code>SeriesCollection</code> number </p>\n"}], "owner": {"reputation": 119, "user_id": 7436082, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/02192aff66297a0485e0776b8f4a27f1?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Byars", "link": "https://stackoverflow.com/users/7436082/michael-byars"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493789769, "creation_date": 1493754938, "question_id": 43746209, "link": "https://stackoverflow.com/questions/43746209/vba-ms-access-2010-pivot-line-chart-add-data-label-to-first-marker-only", "title": "VBA MS Access 2010 pivot line chart add data label to first marker only", "body": "<p>These little VBA language differences between Excel and Access are getting very anoying.  I am at the last step (hopefully) of getting my line chart to look how I need it to, but I can't get a data label to show on the first marker only.  Here is what I have so far.  I have attempted every itiration I can find online and all get the same \"Error 438: Object doesn't support this property or method\"</p>\n\n<pre><code>With Me.ChartSpace.Charts(0).SeriesCollection(0)\n    .Line.Color = sc1\n    .Line.Weight = 6\n    .marker.Size = 8\n    .marker.Style = 2\n    sName = .Name\n    csName = Right(sName, Len(sName) - 8)\n    .Caption = csName\n    .Points(1).DataLabel.Text = csName\nEnd With\n</code></pre>\n\n<p>Again, thanks for your assistance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1493754724, "post_id": 43746088, "comment_id": 74535197, "body": "<code>range(&quot;e57&quot;).offset(0,x-1).value</code> where x is a for next loop from 1 to 12"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1493754858, "post_id": 43746088, "comment_id": 74535275, "body": "What you actually need here is not a loop but an <code>Array</code>."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1493755772, "last_edit_date": 1493755772, "creation_date": 1493755457, "answer_id": 43746324, "question_id": 43746088, "link": "https://stackoverflow.com/questions/43746088/how-could-i-turn-this-block-into-a-loop/43746324#43746324", "title": "How could I turn this block into a loop?", "body": "<p>If you were to use the following code:</p>\n\n<pre><code>Dim MthGroup As Variant\nMthGroup = Application.Transpose(Application.Transpose(MEPF.Sheets(\"Group NBD-AP Goals\").Range(\"E57:P57\")))\n</code></pre>\n\n<p>you could then access your variables as <code>MthGroup(1)</code> instead of <code>JanGroup</code>, <code>MthGroup(2)</code> instead of <code>FebGroup</code>, etc.</p>\n\n<p>(The two <code>Transpose</code> commands are used to convert the data from a two-dimensional <code>1 To 1, 1 To 12</code> array into a one-dimensional <code>1 To 12</code> array.)</p>\n\n<hr>\n\n<p>Having the data in an array then allows you to use a loop elsewhere in your code, such as:</p>\n\n<pre><code>Dim mth As Long\nFor mth = 1 To 12\n    MsgBox \"Data for \" &amp; MonthName(mth) &amp; \" is \" &amp; MthGroup(mth) \nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1493755677, "creation_date": 1493755677, "answer_id": 43746374, "question_id": 43746088, "link": "https://stackoverflow.com/questions/43746088/how-could-i-turn-this-block-into-a-loop/43746374#43746374", "title": "How could I turn this block into a loop?", "body": "<p>Here is a possible code, that will solve some of your problems and may show you how to proceed with your task:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe()\n\n    Dim rngCell             As Range\n    Dim lngCounter          As Long\n    Dim myArray(12)         As Long\n\n    Set rngCell = Cells(57, 5) 'That is E57\n    For lngCounter = 0 To 11\n\n        Set rngCell = rngCell.Offset(0, 1)\n        rngCell = lngCounter\n        myArray(lngCounter) = rngCell.Value\n\n    Next lngCounter\n\n    For lngCounter = LBound(myArray) To UBound(myArray)\n        Debug.Print myArray(lngCounter)\n    Next lngCounter\n\nEnd Sub\n</code></pre>\n\n<p>In general, we set Cells(57,5) as <code>rngCell</code> and we write to all cells from E57 to  P57 the numbers from 0 to 11. Thus, you see how this is done. Furthermore, we create an array named <code>myArray</code> with 12 places in it. On each loop we add a value to the array - <code>myArray(lngCounter) = rngCell.Value</code>. I have added a second loop, so you can see how to iterate through this array. It prints the values of the array to the immediate window. Cheers!</p>\n"}], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 43746324, "answer_count": 2, "score": 1, "last_activity_date": 1493755772, "creation_date": 1493754582, "question_id": 43746088, "link": "https://stackoverflow.com/questions/43746088/how-could-i-turn-this-block-into-a-loop", "title": "How could I turn this block into a loop?", "body": "<p>I'm thinking that what I have to do is create a list that contains Jan, Feb, Mar, etc. and another with the letters between E and P. However, I'm still terrible at setting up loops, and out of fear I tend to write things the long way (and have many unnecessary lines because of it). Any suggestions on how to set it up?</p>\n\n<pre><code>JanGroup = MEPF.Sheets(\"Group NBD-AP Goals\").Range(\"E57\").Value\nFebGroup = MEPF.Sheets(\"Group NBD-AP Goals\").Range(\"F57\").Value\nMarGroup = MEPF.Sheets(\"Group NBD-AP Goals\").Range(\"G57\").Value\nAprGroup = MEPF.Sheets(\"Group NBD-AP Goals\").Range(\"H57\").Value\nMayGroup = MEPF.Sheets(\"Group NBD-AP Goals\").Range(\"I57\").Value\nJunGroup = MEPF.Sheets(\"Group NBD-AP Goals\").Range(\"J57\").Value\nJulGroup = MEPF.Sheets(\"Group NBD-AP Goals\").Range(\"K57\").Value\nAugGroup = MEPF.Sheets(\"Group NBD-AP Goals\").Range(\"L57\").Value\nSepGroup = MEPF.Sheets(\"Group NBD-AP Goals\").Range(\"M57\").Value\nOctGroup = MEPF.Sheets(\"Group NBD-AP Goals\").Range(\"N57\").Value\nNovGroup = MEPF.Sheets(\"Group NBD-AP Goals\").Range(\"O57\").Value\nDecGroup = MEPF.Sheets(\"Group NBD-AP Goals\").Range(\"P57\").Value\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 2466, "user_id": 3751420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MeAcM.jpg?s=128&g=1", "display_name": "Steve Lovell", "link": "https://stackoverflow.com/users/3751420/steve-lovell"}, "edited": false, "score": 0, "creation_date": 1493755533, "post_id": 43746043, "comment_id": 74535638, "body": "There may be other issues, but my guess is that the line you mention doesn&#39;t need the word <code>set</code> at the beginning. There are probably more techically correct ways to say this but: <code>set</code> is for allocating of objects to variables, here you are allocating a value to a property of an object."}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1493758939, "post_id": 43746043, "comment_id": 74537429, "body": "<code>ppPlaceholderTitle</code> is a type. it is actually a number (=1). Look at <a href=\"https://msdn.microsoft.com/en-us/library/office/ff745779.aspx\" rel=\"nofollow noreferrer\">here</a>. Basically now you are typing <code>Set 1.TextFrame.TextRange.Text = slTitle</code>. Add a placeholder which its type is <code>ppPlaceholderTitle</code>."}], "owner": {"reputation": 11, "user_id": 3170800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff256708904655eef0f7a726733d54b5?s=128&d=identicon&r=PG&f=1", "display_name": "user3170800", "link": "https://stackoverflow.com/users/3170800/user3170800"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 442, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1493755065, "creation_date": 1493754419, "last_edit_date": 1493755065, "question_id": 43746043, "link": "https://stackoverflow.com/questions/43746043/vba-to-copy-text-from-textbox-into-slidetitle", "title": "VBA TO copy text from textbox into slideTitle", "body": "<p>I have created a  macro in Powerpoint that will search for slides that are using a textbox for their title and are replacing them with a Title box. The steps are </p>\n\n<p>1) find the slides that have a textbox in the title area<br>\n2) Copy the text in the textbox to a variable called slTitle.<br>\n3) Delete the texbox<br>\n4) Create a Title Holder for the current slide<br>\n5) Copy the text into the Title holder<br>\n6) Move on to the next slide</p>\n\n<p>My macro currently is able to get as far as step 4 but I can't figure out how to get the text in <code>slTitle</code> into the Title box. This should be fairly easy to do but I've tried several ways and nothing seems to work.  If anyone can help me figure out this step it would be much appreciated.  </p>\n\n<p>I am getting a compile error  \"Invalid Qualifier\" on the line:   </p>\n\n<pre><code>Set ppPlaceholderTitle.TextFrame.TextRange.Text = slTitle \n</code></pre>\n\n<p>Here is my current macro.</p>\n\n<pre><code>Sub AddMiMissingTitles()\n\nDim shpCurrShape As Object\nDim x As Integer\nDim sl As PowerPoint.Slide\nDim sld As Slide\nDim ctr As Integer\nDim s As Shape\n\n\n'x = ActivePresentation.Slides.Count\n'counter ctr used to count number of slides that needed titles added\nctr = 0\n\n '**************************************************************\n Set sourcePres = ActivePresentation\n\n    x = 1 ' slide counter\n\n    'get the title text\n    For Each sl In sourcePres.Slides\n\n            'delete all the empty title text boxes first\n            For Each s In sl.Shapes\n\n             If s.Top &lt; 45 Then ' it's in the title area\n                 'MsgBox s.PlaceholderFormat.Type\n                 If s.Type &lt;&gt; ppPlaceholderTitle Then ' it isn't a proper Title placeholder\n                      If s.HasTextFrame = msoTrue Then\n                          If Trim(s.TextFrame.TextRange.Text) = \"\" Then\n                              s.Delete ' delete empty text holders\n                          Else\n                              slTitle = s.TextFrame.TextRange.Text\n                              s.Delete\n                              sl.CustomLayout = sl.CustomLayout 'reset the slide\n                              Set ppPlaceholderTitle.TextFrame.TextRange.Text = slTitle\n                              End If\n                      End If\n                  End If\n             End If\n\n           Next\n\n\n\n\n\n             'Is there a title placeholder on the current layout?\n             If sl.CustomLayout.Shapes.HasTitle Then\n                 lngType = sl.CustomLayout.Shapes.Title.PlaceholderFormat.Type\n                 '*********************************\n               '  With ActivePresentation.Slides()\n\n\n             End If\nNext\n MsgBox \"Done! \" &amp; vbCrLf &amp; ctr &amp; \" Slides needed Titles.\"\n                 '*********************************\n                 'sl.Shapes.AddPlaceholder lngType\n                 sl.Shapes.Title.TextFrame.TextRange = slTitle\n  End Sub\n</code></pre>\n"}, {"tags": ["mysql", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1493756592, "last_edit_date": 1493756592, "creation_date": 1493754137, "answer_id": 43745976, "question_id": 43745861, "link": "https://stackoverflow.com/questions/43745861/how-can-i-count-values-in-a-range-that-are-greater-equal-less-than-values-in-a/43745976#43745976", "title": "How can I count values in a range that are greater, equal, less than values in a another range in Excel?", "body": "<p>Three formula:</p>\n\n<p>Home:</p>\n\n<pre><code>=SUMPRODUCT(($A$2:$A$7=G2)*($C$2:$C$7&gt; $D$2:$D$7))\n</code></pre>\n\n<p>Tie:</p>\n\n<pre><code>=SUMPRODUCT(($A$2:$A$7=G2)*($C$2:$C$7= $D$2:$D$7))\n</code></pre>\n\n<p>Away:</p>\n\n<pre><code>=SUMPRODUCT(($A$2:$A$7=G2)*($C$2:$C$7&lt; $D$2:$D$7))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/cokZ2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cokZ2.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>You can also use this one array formula:</p>\n\n<pre><code>=SUMPRODUCT(($A$2:$A$7=$G2)*(CHOOSE(COLUMN(A:A),--($C$2:$C$7&gt; $D$2:$D$7),--($C$2:$C$7= $D$2:$D$7),--($C$2:$C$7&lt; $D$2:$D$7))))\n</code></pre>\n\n<p>Put it in H2, hit Ctrl-Shift-Enter instead of Enter, then copy/drag over and down.</p>\n\n<p><a href=\"https://i.stack.imgur.com/tgjzV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tgjzV.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1493754228, "post_id": 43745980, "comment_id": 74534909, "body": "The <code>--</code> is not needed if you are multiplying the two together, only if you separate the two with <code>,</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1493754393, "post_id": 43745980, "comment_id": 74534999, "body": "Also not to nit pick but one should avoid full column references with SUMPRODUCT, as it will iterate through the whole column all 1.04 million rows.  It will slow down the calculations."}, {"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1493754460, "post_id": 43745980, "comment_id": 74535038, "body": "Yeah that too I had A2:A7 and rest of the columns, but I was trying to follow OP&#39;s format.  OP please take note on Scott&#39;s comment"}, {"owner": {"reputation": 869, "user_id": 7605603, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/1324181674321411/picture?type=large", "display_name": "Matias Diez", "link": "https://stackoverflow.com/users/7605603/matias-diez"}, "edited": false, "score": 0, "creation_date": 1493756908, "post_id": 43745980, "comment_id": 74536409, "body": "This worked great. What if the source data is a different sheet? I&#39;m trying to replicat the formula adding &quot;Sheet2!&quot; before each range but it does not work anymore."}, {"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 1, "creation_date": 1493757192, "post_id": 43745980, "comment_id": 74536551, "body": "=SUMPRODUCT(((Sheet2!A2:A7=1)*(Sheet2!C2:C7&gt;Sheet2!D2:D7))).  Every range needs to reference to the sheetname.  Also, please look at Scott&#39;s comment to avoid using (A:A) but specified range instead."}], "tags": [], "owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "is_accepted": true, "score": 0, "last_activity_date": 1493754317, "last_edit_date": 1493754317, "creation_date": 1493754152, "answer_id": 43745980, "question_id": 43745861, "link": "https://stackoverflow.com/questions/43745861/how-can-i-count-values-in-a-range-that-are-greater-equal-less-than-values-in-a/43745980#43745980", "title": "How can I count values in a range that are greater, equal, less than values in a another range in Excel?", "body": "<p>SumProduct will work:</p>\n\n<pre><code>      |Home|Tie|Away\n---------------------\nRound1|a   |b  |c\nRound2|3   |0  |0\n\na: =SUMPRODUCT(((A:A=1)*(C:C&gt;D:D)))  \nb: =SUMPRODUCT(((A:A=1)*(C:C=D:D)))  \nc: =SUMPRODUCT(((A:A=1)*(C:C&lt;D:D)))  \n</code></pre>\n\n<p>I'll let you figure out Round2</p>\n"}], "owner": {"reputation": 869, "user_id": 7605603, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/1324181674321411/picture?type=large", "display_name": "Matias Diez", "link": "https://stackoverflow.com/users/7605603/matias-diez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 43745980, "answer_count": 2, "score": -1, "last_activity_date": 1493756592, "creation_date": 1493753652, "last_edit_date": 1531161705, "question_id": 43745861, "link": "https://stackoverflow.com/questions/43745861/how-can-i-count-values-in-a-range-that-are-greater-equal-less-than-values-in-a", "title": "How can I count values in a range that are greater, equal, less than values in a another range in Excel?", "body": "<p>I think my question is really basic but I can't seem to find the answer anywhere. I have a table \"Matches\" that shows a home team, an away team, the round and the score. Like this:</p>\n\n<pre><code>Round | HomeTeam | HTGoals | ATGoals | AwayTeam\n-----------------------------------------------\n1     | team1    |  1      | 0       | team4\n1     | team2    |  1      | 1       | team5\n1     | team3    |  0      | 1       | team6\n2     | team4    |  3      | 0       | team1\n2     | team5    |  2      | 0       | team2\n2     | team6    |  2      | 0       | team3\n-----------------------------------------------\n</code></pre>\n\n<p>(Sorry I can't paste images yet)</p>\n\n<p>I need a second table with Home Team victories, away team victories, and ties, like this: </p>\n\n<pre><code>      |Home|Tie|Away\n---------------------\nRound1|1   |1  |1\nRound2|3   |0  |0\n</code></pre>\n\n<p>But I can't find a formula that will do that comparison automatically. I tried this: </p>\n\n<pre><code>=COUNTIFS(A:A;1;C:C;\"&gt;\"&amp;D:D)\n</code></pre>\n\n<p>but it doesn't work. </p>\n\n<p>Do you know if there is a way to COUNT the times one range of values (in this case HTgoals) is greater than another range of values (in this case ATGoals) comparing each cell in the first range with the respective cell in the next range?</p>\n\n<p>One more thing, without considering the round, if I just verify the goal comparison, I found a solution that is everywhere:</p>\n\n<pre><code>=SUMPRODUCT(--(C:C&gt;D:D))\n</code></pre>\n\n<p>And it works for \">\" and \"&lt;\" but it doesn't for \"=\" so it is not working for me. </p>\n\n<p>I have two possible solutions that I'm trying to avoid but if there is no formula, please let me know. </p>\n\n<p>1- I can create an extra column that compares the scores with 3 IF, ElseIF, ELSE that replies \"HW\", \"AW\" or \"TIE\". and then do COUNTIFS() with the round and the resuls. (I'm trying to avoid this one because my data is coming form a database)  </p>\n\n<p>2- I can go ahead and make a procedure in my database (mySQL) which I'm also trying to avoid because I would end up having tons and tons of store procedures for each competition. I need to have that logic in diferent workspaces (Or spreadsheets)</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1493752842, "post_id": 43744977, "comment_id": 74534234, "body": "Somewhere in your filedialog code, set a variable to the selected folder filepath and filename then reference that variable in your TransferText"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7953681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e164d4622f04b907321fcf93b1a543e8?s=128&d=identicon&r=PG&f=1", "display_name": "Denise Griffith", "link": "https://stackoverflow.com/users/7953681/denise-griffith"}, "edited": false, "score": 0, "creation_date": 1493822273, "post_id": 43746113, "comment_id": 74567504, "body": "When I go to Tools..&quot;References&quot; is grayed out and I cannot get in to select anything."}, {"owner": {"reputation": 23, "user_id": 7953681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e164d4622f04b907321fcf93b1a543e8?s=128&d=identicon&r=PG&f=1", "display_name": "Denise Griffith", "link": "https://stackoverflow.com/users/7953681/denise-griffith"}, "edited": false, "score": 0, "creation_date": 1493822617, "post_id": 43746113, "comment_id": 74567788, "body": "I closed the VBA editor and re-opened and was able to select it.  This is working beautifully.  Thank you sooo much!"}, {"owner": {"reputation": 23, "user_id": 7953681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e164d4622f04b907321fcf93b1a543e8?s=128&d=identicon&r=PG&f=1", "display_name": "Denise Griffith", "link": "https://stackoverflow.com/users/7953681/denise-griffith"}, "edited": false, "score": 0, "creation_date": 1493825249, "post_id": 43746113, "comment_id": 74569835, "body": "Is there any way to have a message box appear to say &quot;action canceled&quot; if the person clicks the cancel button in the dialog?  And conversely, the message box could say &quot;file imported&quot; when it is completed?"}, {"owner": {"reputation": 23, "user_id": 7953681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e164d4622f04b907321fcf93b1a543e8?s=128&d=identicon&r=PG&f=1", "display_name": "Denise Griffith", "link": "https://stackoverflow.com/users/7953681/denise-griffith"}, "edited": false, "score": 0, "creation_date": 1494430032, "post_id": 43746113, "comment_id": 74827638, "body": "Thank you so much!  I will give this a try and see how it goes."}, {"owner": {"reputation": 23, "user_id": 7953681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e164d4622f04b907321fcf93b1a543e8?s=128&d=identicon&r=PG&f=1", "display_name": "Denise Griffith", "link": "https://stackoverflow.com/users/7953681/denise-griffith"}, "edited": false, "score": 0, "creation_date": 1495120260, "post_id": 43746113, "comment_id": 75128514, "body": "Works like a charm.  You are the bomb Kostas!"}], "tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": true, "score": 2, "last_activity_date": 1493884401, "last_edit_date": 1525816189, "creation_date": 1493754642, "answer_id": 43746113, "question_id": 43744977, "link": "https://stackoverflow.com/questions/43744977/ms-access-form-button-that-allows-user-to-browse-choose-file-then-imports-file/43746113#43746113", "title": "MS Access Form button that allows user to browse/choose file, then imports file to a table", "body": "<p>You need to set a reference to <strong>Microsoft Office Object Library</strong>.</p>\n\n<pre><code>Public Sub ImportDocument()\n    On Error GoTo ErrProc\n\n    Dim fd As FileDialog\n    Set fd = Application.FileDialog(msoFileDialogFilePicker)\n\n    With fd\n        .InitialFileName = \"Some folder\"\n        .Title = \"Some Title\"\n        With .Filters\n            .Clear\n            .Add \"CSV documents\", \"*.csv\", 1\n        End With\n        .ButtonName = \" Import Selected \"\n        .AllowMultiSelect = False\n\n        If .Show = 0 Then GoTo Leave\n    End With\n\n    Dim selectedItem As Variant\n    For Each selectedItem In fd.SelectedItems\n        DoCmd.TransferText acImportDelim, \"Raw Data from Import_ Import Specification\", \"Raw Data from Import\", selectedItem, True, \"\"\n    Next\n\nLeave:\n    Set fd = Nothing\n    On Error GoTo 0\nExit Sub\n\nErrProc:\n    MsgBox Err.Description, vbCritical\n    Resume Leave\nEnd Sub\n</code></pre>\n\n<p><strong>Update after user's comments:</strong></p>\n\n<p>You must change the <em>Sub</em> to a <em>Function</em> and check the return value. </p>\n\n<p>The simplest way is to return a <code>Boolean</code>, where <code>FALSE</code> indicates aborted and <code>TRUE</code> indicates success. However by doing so, you exclude the <em>Error</em> scenario as both Aborted and Error will return <code>FALSE</code>.</p>\n\n<p>Therefore you can return a <code>Long</code> value e.g. 0, 1, 2 indicating Aborted, Success and Error respectively. In order to avoid the \"magic numbers\" though, I would create and return an <em>Enum</em> type as shown below:</p>\n\n<pre><code>Public Enum TaskImportEnum\n    Aborted = 0 'default\n    Success\n    Failure\nEnd Enum\n\nPublic Function ImportDocument() As TaskImportEnum\n    On Error GoTo ErrProc\n\n    Dim fd As FileDialog\n    Set fd = Application.FileDialog(msoFileDialogFilePicker)\n\n    With fd\n        .InitialFileName = \"Some folder\"\n        .Title = \"Dialog Title\"\n        With .Filters\n            .Clear\n            .Add \"CSV documents\", \"*.csv\", 1\n        End With\n        .ButtonName = \" Import Selected \"\n        .AllowMultiSelect = False   'Change this to TRUE to enable multi-select\n\n       'If aborted, the Function will return the default value of Aborted\n        If .Show = 0 Then GoTo Leave\n    End With\n\n    Dim selectedItem As Variant\n    For Each selectedItem In fd.SelectedItems\n        DoCmd.TransferText acImportDelim, \"Raw Data from Import_ Import Specification\", \"Raw Data from Import\", selectedItem, True, \"\"\n    Next selectedItem\n\n   'Return Success\n   ImportDocument = TaskImportEnum.Success\n\nLeave:\n    Set fd = Nothing\n    On Error GoTo 0\n    Exit Function\n\nErrProc:\n    MsgBox Err.Description, vbCritical\n    ImportDocument = TaskImportEnum.Failure  'Return Failure if error\n    Resume Leave\nEnd Function\n</code></pre>\n\n<p>Lastly, you can call the Function like this:</p>\n\n<pre><code>Sub Import()\n\n    Dim status_ As TaskImportEnum\n        status_ = ImportDocument\n\n    Select Case status_\n        Case TaskImportEnum.Success:\n            MsgBox \"Success!\"\n\n        Case TaskImportEnum.Failure:\n            MsgBox \"Failure...\"\n\n        Case Else:\n            MsgBox \"Aborted...\"\n    End Select\n\nEnd Sub\n</code></pre>\n\n<p>You can read more about the <code>Enum</code> type here: <a href=\"http://www.cpearson.com/excel/Enums.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/Enums.aspx</a> </p>\n"}], "owner": {"reputation": 23, "user_id": 7953681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e164d4622f04b907321fcf93b1a543e8?s=128&d=identicon&r=PG&f=1", "display_name": "Denise Griffith", "link": "https://stackoverflow.com/users/7953681/denise-griffith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6652, "favorite_count": 0, "accepted_answer_id": 43746113, "answer_count": 1, "score": 2, "last_activity_date": 1493884401, "creation_date": 1493750279, "question_id": 43744977, "link": "https://stackoverflow.com/questions/43744977/ms-access-form-button-that-allows-user-to-browse-choose-file-then-imports-file", "title": "MS Access Form button that allows user to browse/choose file, then imports file to a table", "body": "<p>In my database, I can made a command button import a file using the following:\nDoCmd.TransferText acImportDelim, \"Raw Data from Import_ Import Specification\", \"Raw Data from Import\", D:\\Users\\Denise_Griffith\\Documents\\Griffith\\PRIME RECON FILES\\jdaqawmslesfilesemailDLX_SHPREC_2017-04-26_03-33-47.csv, True, \"\"</p>\n\n<p>But I would like to have the user choose the file to import, since the filename is different every day based on date and time it was created.  I have found this site (<a href=\"http://access.mvps.org/access/api/api0001.htm\" rel=\"nofollow noreferrer\">http://access.mvps.org/access/api/api0001.htm</a>) and was able to get the dialog to pop up to allow the user to navigate and select the file, but I do not know how to incorporate it so the file selected is imported using the specification I created, and into the appropriate table.</p>\n\n<p>Please help!</p>\n"}, {"tags": ["excel", "excel-2007", "wait", "vba"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1493750148, "post_id": 43744754, "comment_id": 74532703, "body": "Use <code>DoEvents</code> after <code>For i = 1 To 1000</code> see if that helps"}, {"owner": {"reputation": 112, "user_id": 7867908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ce4460cbc2ac56e35ddb66648ffa27a?s=128&d=identicon&r=PG&f=1", "display_name": "MartyMcfly0033", "link": "https://stackoverflow.com/users/7867908/martymcfly0033"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1493750934, "post_id": 43744754, "comment_id": 74533182, "body": "using your suggestion  <code>For i = 1 To 1000    DoEvents    ....</code> It still broke at 500. I did place them on separate lines."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 1, "creation_date": 1493753252, "post_id": 43744754, "comment_id": 74534426, "body": "It must have something to do with the limits of the wait function.  I used the following code without problem.      Application.Wait (Now + (0.000001))"}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 1, "creation_date": 1493753978, "post_id": 43744754, "comment_id": 74534791, "body": "It may be a situation where you have broken execution during a loop. This has happened to me before.Try to press Debug in the error popup, then Ctrl-Break twice or more. See this answer: <a href=\"http://stackoverflow.com/a/5823507/5175942\">stackoverflow.com/a/5823507/5175942</a>"}, {"owner": {"reputation": 112, "user_id": 7867908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ce4460cbc2ac56e35ddb66648ffa27a?s=128&d=identicon&r=PG&f=1", "display_name": "MartyMcfly0033", "link": "https://stackoverflow.com/users/7867908/martymcfly0033"}, "edited": false, "score": 0, "creation_date": 1493754236, "post_id": 43744754, "comment_id": 74534915, "body": "Can you elaborate on the limits of the wait function? If it can be used to wait for a minute then why does it break at 500 ms?"}, {"owner": {"reputation": 112, "user_id": 7867908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ce4460cbc2ac56e35ddb66648ffa27a?s=128&d=identicon&r=PG&f=1", "display_name": "MartyMcfly0033", "link": "https://stackoverflow.com/users/7867908/martymcfly0033"}, "reply_to_user": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1493754672, "post_id": 43744754, "comment_id": 74535161, "body": "@MacroMarc that link did the trick. However is the wait function still limited? I calculate that in order to run through the first 500 of <code>i</code> it should take about 2 minutes. It goes through very fast until it gets to 500 before slowing down. Then it seems to be incrementing at 1 second."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1493763600, "post_id": 43744754, "comment_id": 74539415, "body": "<code>Now()</code> appears to be only accurate to a second.  Try running <code>Dim x As Double: For i = 1 To 10000: x = Now(): Debug.Print i, x: Next</code> and you will see jumps in the values displayed.  I believe <code>Wait</code> also works on seconds.  I think the only way to accurately wait for short periods is by <a href=\"http://stackoverflow.com/a/43747850/6535336\">using the <code>Sleep</code> function as suggested by MacroMarc</a>."}, {"owner": {"reputation": 112, "user_id": 7867908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ce4460cbc2ac56e35ddb66648ffa27a?s=128&d=identicon&r=PG&f=1", "display_name": "MartyMcfly0033", "link": "https://stackoverflow.com/users/7867908/martymcfly0033"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493916586, "post_id": 43744754, "comment_id": 74617824, "body": "@YowE3K I thought since <code>Now</code> gave up to 10 decimal places the 8th, 9th, and 10th places would represent the milisecond. Since a ms is 0.0000000116 I thought that by adding this to <code>Now</code> would stall it just for 1 ms. However, as stated above, it seems that VBA or the <code>Wait</code> function only takes 1 second increments and will round any fraction of a second up or down. The Sleep function works exactly as anticipated, but now I need to code in windows detection and write it for both 32 &amp; 64 bit &gt;.&lt; lol. Thank you all for the help!"}], "answers": [{"comments": [{"owner": {"reputation": 112, "user_id": 7867908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ce4460cbc2ac56e35ddb66648ffa27a?s=128&d=identicon&r=PG&f=1", "display_name": "MartyMcfly0033", "link": "https://stackoverflow.com/users/7867908/martymcfly0033"}, "edited": false, "score": 0, "creation_date": 1493754174, "post_id": 43745836, "comment_id": 74534881, "body": "This is a creative workaround but ultimately does not accomplish what I was looking to do. I want to demonstrate the wait function by allowing the code to wait 1 ms longer than the previous go through. This was done in about 2 seconds and does not demonstrate what I was looking for."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 112, "user_id": 7867908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ce4460cbc2ac56e35ddb66648ffa27a?s=128&d=identicon&r=PG&f=1", "display_name": "MartyMcfly0033", "link": "https://stackoverflow.com/users/7867908/martymcfly0033"}, "edited": false, "score": 1, "creation_date": 1493755069, "post_id": 43745836, "comment_id": 74535399, "body": "Then it took twice as long as it should have.  There are only 1000 miliseconds in a second.  MCFLY!!!  MCFLY!!!!"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 112, "user_id": 7867908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ce4460cbc2ac56e35ddb66648ffa27a?s=128&d=identicon&r=PG&f=1", "display_name": "MartyMcfly0033", "link": "https://stackoverflow.com/users/7867908/martymcfly0033"}, "edited": false, "score": 0, "creation_date": 1493755155, "post_id": 43745836, "comment_id": 74535439, "body": "BTW - the human eye can only catch about every 30th to 60th millisecond of color."}, {"owner": {"reputation": 112, "user_id": 7867908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ce4460cbc2ac56e35ddb66648ffa27a?s=128&d=identicon&r=PG&f=1", "display_name": "MartyMcfly0033", "link": "https://stackoverflow.com/users/7867908/martymcfly0033"}, "edited": false, "score": 0, "creation_date": 1493755434, "post_id": 43745836, "comment_id": 74535584, "body": "I understand, but if you take each milisecond and add it together 1, 2, 3, 4, 5, and so on to 500, that would be 125250 ms. This equates to 125.25 seconds or 2.09 minutes. At <code>i &gt;= 500</code> comparing the change rate with a timer, it is stalling at 1 second. The answer provided by John did the whole thing in about 2 seconds or 2000 ms &lt; 10% of the calculated time. I could be mistaken so let me know if I missed a key point somewhere."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493762520, "post_id": 43745836, "comment_id": 74539001, "body": "<code>For j = Now To (Now + (ms * i))</code> will be incrementing by one day each time through the loop, so will never execute more than once."}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1493753558, "last_edit_date": 1592644375, "creation_date": 1493753558, "answer_id": 43745836, "question_id": 43744754, "link": "https://stackoverflow.com/questions/43744754/application-wait-breaks-my-code/43745836#43745836", "title": "Application.Wait Breaks my Code", "body": "<h1>0m3r was correct.  The problem is with the application.wait function.  Try the following do events routine instead.</h1>\n<pre><code>Sub Kaleidoscope()\nDim r, g, b, i As Integer, ms As Double\n\nms = 0.0000000115741\nFor i = 1 To 1000\n    r = WorksheetFunction.RandBetween(1, 255)\n    g = WorksheetFunction.RandBetween(1, 255)\n    b = WorksheetFunction.RandBetween(1, 255)\n    Range(&quot;A1&quot;).Interior.Color = RGB(r, g, b)\n    Range(&quot;A1&quot;).Value = i\n    For j = Now To (Now + (ms * i))\n        DoEvents\n    Next j\n    \nNext i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112, "user_id": 7867908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ce4460cbc2ac56e35ddb66648ffa27a?s=128&d=identicon&r=PG&f=1", "display_name": "MartyMcfly0033", "link": "https://stackoverflow.com/users/7867908/martymcfly0033"}, "edited": false, "score": 0, "creation_date": 1493760178, "post_id": 43746745, "comment_id": 74538011, "body": "I stored <code>j as Double</code> and ran from <code>i = 1 To 500</code> and timed the code at 9 seconds. It still doesn&#39;t come close to matching my expected slowdown as <code>i</code> gets bigger and bigger. I understand at the very small intervals it will be nearly inconceivable but at the 100+ mark I expect a noticable slowdown. The only way I can see this method working is to determine exactly how many times it would take for the <code>j</code> to loop and take exactly 1 second. Then I could reverse engineer a formula to simulate a milisecond by performing what might be hundres of thousands of computations in that time frame."}, {"owner": {"reputation": 112, "user_id": 7867908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ce4460cbc2ac56e35ddb66648ffa27a?s=128&d=identicon&r=PG&f=1", "display_name": "MartyMcfly0033", "link": "https://stackoverflow.com/users/7867908/martymcfly0033"}, "edited": false, "score": 1, "creation_date": 1493760968, "post_id": 43746745, "comment_id": 74538380, "body": "Also, my code was multiplying 1 milisecond (in excel 1 hours is 1/24/3600/1000 = 1.15741E-08 or 0.0000000115741). My code multiplies this number by some integer <code>i</code> say 2, which will then give me the decimal value of 2 miliseconds as interpreted by Excel. I then attempted to add this small decimal to <code>Now</code> in order for it to wait 2 miliseconds. Then on the next loop it will add 3 miliseconds, then 4, and so on. I expect to have to wait 2 minutes to loop through 500 iterations."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 112, "user_id": 7867908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ce4460cbc2ac56e35ddb66648ffa27a?s=128&d=identicon&r=PG&f=1", "display_name": "MartyMcfly0033", "link": "https://stackoverflow.com/users/7867908/martymcfly0033"}, "edited": false, "score": 0, "creation_date": 1493814990, "post_id": 43746745, "comment_id": 74561557, "body": "I&#39;m sorry but you are overthinking it and your logic is incorrect.  A millisecond is 1,000th of a second.  It is not .00000005741 of a second.  In decimal form a millisecond is .001.  You also put a negative mark on my answer which does exactly what you asked for.  And when you multiply a fraction by a whole number you are performing division, not addition.  Therefore, I&#39;m done try9ing to help you.  Good luck."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493829455, "post_id": 43746745, "comment_id": 74572496, "body": "A millisecond represents 0.0000000115741 of a day. (.001 / 60 / 60 / 24)  The OP didn&#39;t dv your answer - I did (because it just didn&#39;t work when I dved it).  And when you multiply a fraction by a whole number (e.g. 0.0000000115741 * 2) you are not performing division, you are multiplying one millisecond by 2 in order to get two milliseconds."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493829820, "post_id": 43746745, "comment_id": 74572710, "body": "Looking at your answer now, it still won&#39;t do what the OP wants, but it is a lot closer.  If you change <code>Sleep ms</code> to <code>Sleep i</code> so that the first iteration waits 1 millisecond, the second iteration waits 2 milliseconds, etc, and get rid of the <code>Range.Value = </code> statements (which will take several milliseconds each and thus ruin the timing) I believe you will be doing what the OP wants.  I will then remove my dv.  (Because your answer will match MacroMarc&#39;s.)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493850777, "post_id": 43746745, "comment_id": 74583497, "body": "Actually, I retract my comment about the <code>Range.Value</code> ruining the timing - they seem to be only adding about 20 milliseconds in total, so I grossly overestimated the length of time they took to run.  So, it is just the <code>Sleep ms</code> that needs to be changed to <code>Sleep i</code> in order to answer the OP&#39;s problem."}, {"owner": {"reputation": 112, "user_id": 7867908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ce4460cbc2ac56e35ddb66648ffa27a?s=128&d=identicon&r=PG&f=1", "display_name": "MartyMcfly0033", "link": "https://stackoverflow.com/users/7867908/martymcfly0033"}, "edited": false, "score": 0, "creation_date": 1493854209, "post_id": 43746745, "comment_id": 74584497, "body": "@johnMuggins I appreciate the help you were giving me. I haven&#39;t marked anyone&#39;s answer as negative because the approach you were providing was different. Also I know that a milisecond is 0.001 of a second, but excel DOES NOT view a second as 1. Also, Multiplication is MULTIPLICATION. When multiplying decimals the whole number is divided by the decimal OR the decimal is multiplied by the whole number. In this case Im starting with a decimal, therefore my method was indeed multiplication."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 112, "user_id": 7867908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ce4460cbc2ac56e35ddb66648ffa27a?s=128&d=identicon&r=PG&f=1", "display_name": "MartyMcfly0033", "link": "https://stackoverflow.com/users/7867908/martymcfly0033"}, "edited": false, "score": 0, "creation_date": 1493901628, "post_id": 43746745, "comment_id": 74606544, "body": "@MartyMcfly0033 I apologize, I assumed it was you that did that.  I understand that the number .0000000115741 is a fraction of a 24 hour period mathematically but excel does not recognize that as a millisecond.     I changed the answer to a code that runs exactly 2 minutes and 9 seconds on my machine and it adds the milliseconds exponentially as you asked.  As you can see I used 6 milliseconds as the base because that is the number required for the exact timing of 2 minutes and 9 seconds."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493902150, "post_id": 43746745, "comment_id": 74606973, "body": "@YowE3K incrementing the sleep time by 1 would not accomplish what the OP asked for.  He indicated that he wanted the numbers to be increased exponentially, so that 1 would be added to 2 and that sum would be added to 3 (to make 6) and that sum would be added to 4 (to make 10) and so on.   Although his math conversion to Excel is a little off, he also indicated that he wants a run time of 2 minutes and 9 seconds according to his calculations.  So I built code that runs in that exact time and it shows that .006 is the necessary element for that, a number far greater than .0000000115741."}, {"owner": {"reputation": 112, "user_id": 7867908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ce4460cbc2ac56e35ddb66648ffa27a?s=128&d=identicon&r=PG&f=1", "display_name": "MartyMcfly0033", "link": "https://stackoverflow.com/users/7867908/martymcfly0033"}, "edited": false, "score": 0, "creation_date": 1493912199, "post_id": 43746745, "comment_id": 74614921, "body": "@JohnMuggins so this code seems to do what it is I&#39;m looking for. It appears this is only possible with a call to windows API and not possible through VBA code alone?"}, {"owner": {"reputation": 112, "user_id": 7867908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ce4460cbc2ac56e35ddb66648ffa27a?s=128&d=identicon&r=PG&f=1", "display_name": "MartyMcfly0033", "link": "https://stackoverflow.com/users/7867908/martymcfly0033"}, "edited": false, "score": 0, "creation_date": 1493914699, "post_id": 43746745, "comment_id": 74616726, "body": "@JohnMuggins Can you also explain why my calculation is a little off? The <code>Now</code> function returns number with 10 decimal places where a milisecond is determined by the 8th, 9th, and 10th decimal places produced by <code>Now</code>."}, {"owner": {"reputation": 112, "user_id": 7867908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ce4460cbc2ac56e35ddb66648ffa27a?s=128&d=identicon&r=PG&f=1", "display_name": "MartyMcfly0033", "link": "https://stackoverflow.com/users/7867908/martymcfly0033"}, "edited": false, "score": 0, "creation_date": 1493914955, "post_id": 43746745, "comment_id": 74616860, "body": "I ran your code @JohnMuggins. On my PC it took exactly 12.72 seconds with the timer you put in. I did some research on the Sleep function and it takes integers as ms. When I set <code>ms = i</code> it takes 136.06 seconds to complete. This is slightly longer than I anticipated but that could be from the screen updating and the inserting of values into the cells. I did not need to add <code>ms</code> to itself since i was taking care of that from the loop. My statments above were following the logic behind waiting 1 additional ms through each loop."}, {"owner": {"reputation": 112, "user_id": 7867908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ce4460cbc2ac56e35ddb66648ffa27a?s=128&d=identicon&r=PG&f=1", "display_name": "MartyMcfly0033", "link": "https://stackoverflow.com/users/7867908/martymcfly0033"}, "edited": false, "score": 0, "creation_date": 1493915009, "post_id": 43746745, "comment_id": 74616890, "body": "I upvoted your answer but gave the actual answer to @MarcoMarc as he was the first to state to use the windows API."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1493915456, "post_id": 43746745, "comment_id": 74617171, "body": "Thank you and I agree, as I stated before he was correct."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493926058, "post_id": 43746745, "comment_id": 74623095, "body": "(a) Your first call to the <code>Sleep</code> function is for 0.006 milliseconds, not 6 milliseconds (that would be <code>Sleep 6</code>), but will actually by 0 milliseconds due to the <code>Sleep</code> taking a <code>Long</code> parameter. (b) The original request was not (and still is not?) for an exponentially increasing delay, but for a linearly increasing delay, so that the elapsed time after 500 iterations would be 1+2+3+...+499+500 milliseconds, i.e. 125.25 seconds (2 mins 5.25 secs, i.e. 2.09 mins).  And after 1000 iterations it should be 500.50 seconds, i.e. 8 mins 20.5 secs - not 1006.01 seconds as your code will produce."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1494247725, "post_id": 43746745, "comment_id": 74732050, "body": "Thank you for such astute calculation.  In any event, the code runs in 2 minutes and 9 seconds.  I added the timer so you can run it if you desire also and achieve similar results.  Also, by keeping your eye on &quot;B1&quot; and &quot;C1&quot; and &quot;D1&quot; you&#39;ll see a counter that can easily be read as it changes with each iteration, without skipping any numbers.  If that number were only viable for .006 milliseconds than the human eye would not be able to detect but about every hundredth one.  So again, reality disproves faulty calculation."}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1493828228, "last_edit_date": 1493828228, "creation_date": 1493757160, "answer_id": 43746745, "question_id": 43744754, "link": "https://stackoverflow.com/questions/43744754/application-wait-breaks-my-code/43746745#43746745", "title": "Application.Wait Breaks my Code", "body": "<p>This is the only way I could reach your objective of run-time of 2 minutes and 9 seconds.</p>\n\n<pre><code>Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n\n'   run time on my computer 2:09:07\n'   runs from 6 ms to 751.5 ms\nSub ewhgfsd()\nDim StartTime As Double\nDim EndTime As Double\n\nStartTime = Timer\n\nFor i = 1 To 500\n    ms = ms + (i * 0.006)\n    r = WorksheetFunction.RandBetween(1, 255)\n    g = WorksheetFunction.RandBetween(1, 255)\n    b = WorksheetFunction.RandBetween(1, 255)\n    Range(\"A1\").Interior.Color = RGB(r, g, b)\n    Sleep ms\n    Range(\"B1\").Value = \"Time: \" &amp; Format(Timer - StartTime, \"####.##\")\n    Range(\"C1\").Value = \"ms =  \" &amp; Format(ms, \"####.#####\")\n    Range(\"D1\").Value = i &amp; \" of 500\"\nNext i\n\nEndTime = Timer - StartTime\nDebug.Print Format(EndTime, \"####.##\")\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112, "user_id": 7867908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ce4460cbc2ac56e35ddb66648ffa27a?s=128&d=identicon&r=PG&f=1", "display_name": "MartyMcfly0033", "link": "https://stackoverflow.com/users/7867908/martymcfly0033"}, "edited": false, "score": 0, "creation_date": 1493854548, "post_id": 43747850, "comment_id": 74584581, "body": "Im gathering the excel VBA is incapable of waiting for less than 1 second without a call to Windows API?"}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "reply_to_user": {"reputation": 112, "user_id": 7867908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ce4460cbc2ac56e35ddb66648ffa27a?s=128&d=identicon&r=PG&f=1", "display_name": "MartyMcfly0033", "link": "https://stackoverflow.com/users/7867908/martymcfly0033"}, "edited": false, "score": 0, "creation_date": 1493886942, "post_id": 43747850, "comment_id": 74596180, "body": "Not saying it&#39;s impossible, but Sleep is the only way I use. Sleep seems easiest."}, {"owner": {"reputation": 112, "user_id": 7867908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ce4460cbc2ac56e35ddb66648ffa27a?s=128&d=identicon&r=PG&f=1", "display_name": "MartyMcfly0033", "link": "https://stackoverflow.com/users/7867908/martymcfly0033"}, "edited": false, "score": 0, "creation_date": 1493915115, "post_id": 43747850, "comment_id": 74616961, "body": "The only thing with sleep is I have to build in windows detection code to determine if it&#39;s 32bit or 64bit and have it call the right function. This is why I was attempting to achieve this effect through VBA alone."}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "reply_to_user": {"reputation": 112, "user_id": 7867908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ce4460cbc2ac56e35ddb66648ffa27a?s=128&d=identicon&r=PG&f=1", "display_name": "MartyMcfly0033", "link": "https://stackoverflow.com/users/7867908/martymcfly0033"}, "edited": false, "score": 0, "creation_date": 1493923780, "post_id": 43747850, "comment_id": 74621796, "body": "I don&#39;t do a lot of this, but you can try some conditional compilation: <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264421.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/gg264421.aspx</a>"}], "tags": [], "owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "is_accepted": true, "score": 3, "last_activity_date": 1493761985, "creation_date": 1493761985, "answer_id": 43747850, "question_id": 43744754, "link": "https://stackoverflow.com/questions/43744754/application-wait-breaks-my-code/43747850#43747850", "title": "Application.Wait Breaks my Code", "body": "<p>You could use the Sleep function from winAPI.</p>\n\n<p>At the top of the module:</p>\n\n<p><code>Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)</code></p>\n\n<p>Then in your code:</p>\n\n<p><code>Sleep i   ' where i is now in milliseconds</code></p>\n\n<p>Note that Sleep delays all VBA code.</p>\n"}], "owner": {"reputation": 112, "user_id": 7867908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ce4460cbc2ac56e35ddb66648ffa27a?s=128&d=identicon&r=PG&f=1", "display_name": "MartyMcfly0033", "link": "https://stackoverflow.com/users/7867908/martymcfly0033"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1744, "favorite_count": 0, "accepted_answer_id": 43747850, "answer_count": 3, "score": 1, "last_activity_date": 1493916067, "creation_date": 1493749497, "last_edit_date": 1531164843, "question_id": 43744754, "link": "https://stackoverflow.com/questions/43744754/application-wait-breaks-my-code", "title": "Application.Wait Breaks my Code", "body": "<blockquote>\n  <p>Original</p>\n</blockquote>\n\n<p>I have the following code that is coloring a cell to demonstrate the use of milisecond wait time. However, when <code>i = 500</code> the code breaks. The error I get is <code>Code Execution has been Interrupted</code> and from 500 to 1000 I have to keep clicking continue. I've tried to wrap my code in an <code>Application.DisplayAlerts = False</code> and <code>True</code> but it still gets interrupted and won't finish. I estimate this code will take approximately 6 minutes more or less as <code>i</code> approaches <code>1000</code>. I'm at a loss as to what could cause this. I've gone through every setting I can think of and it won't continue past 500 without breaking. ms was calculated from <code>1/(1000*24*60*60)</code>.</p>\n\n<blockquote>\n  <p>Excel 2007</p>\n</blockquote>\n\n<pre><code>Sub Kaleidoscope()\nDim r, g, b, i As Integer, ms As Double\n\nms = 0.0000000115741\nFor i = 1 To 1000\n    r = WorksheetFunction.RandBetween(1, 255)\n    g = WorksheetFunction.RandBetween(1, 255)\n    b = WorksheetFunction.RandBetween(1, 255)\n    Range(\"A1\").Interior.Color = RGB(r, g, b)\n    Application.Wait (Now + (ms * i))\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Thank you in advance!</p>\n\n<blockquote>\n  <p>Update</p>\n</blockquote>\n\n<p>The link provided by @MarcoMarc (stackoverflow.com/a/5823507/5175942) solved the initial breaking problem of my question. However, it still does not appear to be incrementing correctly. It goes as if it isn't waiting until <code>i = 500</code> then appears to be stalling 1 second every time. Is this the limit you were speaking of and ultimately it is not possible to wait for 1 ms? No change in the original code was needed to prevent the breaking.</p>\n\n<blockquote>\n  <p>Final Thoughts</p>\n</blockquote>\n\n<p>@JohnMuggins gives a great tweak to my original code and provides additional tools to see the calculations behinds the scenes. Ultimatley though, he also had to call winAPI like @MacroMarc in order to pause the code for less than 1 second. Through research on additional websites and through Stack Overflow, it appears not possible to pause the program for less than 1 second using VBA alone. It either runs at normal speed or when it gets to 500 ms it rounds up to 1 second and delays the code for 1 second instead of 500 ms. My final code for demonstration is below with @JohnMuggins tweaks.</p>\n\n<pre><code>Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n\nSub Kaleidascope()\nDim StartTime As Double\nDim EndTime As Double\nDim ms As Double\nDim i, r, g, b As Integer\nDim count As Long\n\nStartTime = Timer\n\nFor i = 1 To 500\n    ms = i\n    r = WorksheetFunction.RandBetween(1, 255)\n    g = WorksheetFunction.RandBetween(1, 255)\n    b = WorksheetFunction.RandBetween(1, 255)\n    Range(\"A1\").Interior.Color = RGB(r, g, b)\n    Sleep ms\n    Range(\"B1\").Value = \"Time: \" &amp; Format(Timer - StartTime, \"####.###\")\n    Range(\"C1\").Value = \"ms =  \" &amp; Format(ms, \"####.####\")\n    Range(\"D1\").Value = i &amp; \" of 500\"\nNext i\n\nEndTime = Timer - StartTime\nDebug.Print Format(EndTime, \"####.##\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 303, "user_id": 4430375, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/51ee13ebaef0e2d2b136f5f07b5f5249?s=128&d=identicon&r=PG&f=1", "display_name": "twegner", "link": "https://stackoverflow.com/users/4430375/twegner"}, "edited": false, "score": 0, "creation_date": 1493751408, "post_id": 43744716, "comment_id": 74533495, "body": "Have you tried using Enum? Tho I&#39;m not sure this is possible. I typically use a Class Constructor to set my class object properties."}], "answers": [{"tags": [], "owner": {"reputation": 303, "user_id": 4430375, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/51ee13ebaef0e2d2b136f5f07b5f5249?s=128&d=identicon&r=PG&f=1", "display_name": "twegner", "link": "https://stackoverflow.com/users/4430375/twegner"}, "is_accepted": false, "score": 0, "last_activity_date": 1493751793, "creation_date": 1493751793, "answer_id": 43745389, "question_id": 43744716, "link": "https://stackoverflow.com/questions/43744716/wanting-to-use-variable-to-access-class-member/43745389#43745389", "title": "wanting to use variable to access class member", "body": "<p>Use a Class Constructor. In this example the constructor is called \"init\" (for initialize)</p>\n\n<p>your private class properties</p>\n\n<pre><code>Private pinp1 As Double\nPrivate pinp2 As Double\nPrivate pinp3 As Double\nPrivate pinp4 As Double\nPrivate pinp5 As Double\n</code></pre>\n\n<p>And your constructor. Here you can pass all five (or however many) of your properties as parameters of the Public Sub. Of course you will need to substitute the names of my properties with yours and the data types. This is just an example of a basic constructor.</p>\n\n<pre><code>Public Sub init(ByVal inp1 As Variant, ByVal inp2 As Variant, ByVal inp3 As Variant, _\n            ByVal inp4 As Variant, ByVal inp5 As Variant)\n    '\n    ' set the private class variables to your parameters\n    pinp1 = CDbl(inp1)\n    pinp2 = CDbl(inp2)\n    pinp3 = CDbl(inp3)\n    pinp4 = CDbl(inp4)\n    pinp5 = CDbl(inp5)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7953581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abcb62b9d16697bff451763bd8df9b99?s=128&d=identicon&r=PG&f=1", "display_name": "noviceJohn", "link": "https://stackoverflow.com/users/7953581/novicejohn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493751793, "creation_date": 1493749349, "last_edit_date": 1531161705, "question_id": 43744716, "link": "https://stackoverflow.com/questions/43744716/wanting-to-use-variable-to-access-class-member", "title": "wanting to use variable to access class member", "body": "<p>I have defined a class clsPowerAtt</p>\n\n<pre><code>Public customerName As String\nPublic customerSoc As String\n\n\nsub test ()\n  Dim oPowerEntry As New clsPowerAtt\n\n  dim members(5) as string\n  members(0) = customerName\n  members(1) =customerSoC\n  dim entry as variant\n\n  for each entry in members\n\n    oPowerEntry .entry = \"foo\"\n\n  next each\nend sub\n</code></pre>\n\n<p>I want to cycle through an array which defines members of the class, such that I don't need to call directly. It doesn't like using variable to point to class member</p>\n\n<pre><code>oPowerEntry .entry = \"foo\"\n</code></pre>\n\n<p>How do I tell vba to evaluate entry</p>\n"}, {"tags": ["vba", "ms-access-2010", "pivot-chart"], "answers": [{"tags": [], "owner": {"reputation": 119, "user_id": 7436082, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/02192aff66297a0485e0776b8f4a27f1?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Byars", "link": "https://stackoverflow.com/users/7436082/michael-byars"}, "is_accepted": true, "score": 0, "last_activity_date": 1493747890, "creation_date": 1493747890, "answer_id": 43744330, "question_id": 43744225, "link": "https://stackoverflow.com/questions/43744225/vba-access-pivot-chart-set-the-y-axis-min-max-scale/43744330#43744330", "title": "VBA Access Pivot Chart set the y-axis min/max scale", "body": "<p>and the very next site I check had the very simple solution.  you no longer need the scaling on the end of the .minimum/.maximum.  Here is my working code.</p>\n\n<pre><code>Private Sub Form_Load()\n\n'Call LineMarkerFormat\n\nRONMax = DMax(\"[Total A/C]\", \"tblRONChartComparison\")\nRONMin = DMin(\"[Total A/C]\", \"tblRONChartComparison\")\n\n\nWith Me.ChartSpace.Charts(0).Axes(1).Scaling\n    .Minimum = RONMin\n    .Maximum = RONMax\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 7436082, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/02192aff66297a0485e0776b8f4a27f1?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Byars", "link": "https://stackoverflow.com/users/7436082/michael-byars"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 581, "favorite_count": 0, "accepted_answer_id": 43744330, "answer_count": 1, "score": 0, "last_activity_date": 1493747890, "creation_date": 1493747478, "question_id": 43744225, "link": "https://stackoverflow.com/questions/43744225/vba-access-pivot-chart-set-the-y-axis-min-max-scale", "title": "VBA Access Pivot Chart set the y-axis min/max scale", "body": "<p>Came into another snag formating my Pivot Chart via VBA in Access 2010.  I get the \"Run-time error '438': Object doesn't support this property or method\" error.</p>\n\n<p>Again, I have tried many different iterations of the code, but can't get the right one.  As always, thank you in advance for your assistance.</p>\n\n<pre><code>Private Sub Form_Load()\n\n'Call LineMarkerFormat\n\nRONMax = DMax(\"[Total A/C]\", \"tblRONChartComparison\")\nRONMin = DMin(\"[Total A/C]\", \"tblRONChartComparison\")\n\nWith Me.ChartSpace.Charts(0).Axes(1).Scaling\n    .MinimumScale = RONMin\n    .MaximumScale = RONMax\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "vba", "excel", "combobox", "web-scraping"], "comments": [{"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1493753816, "post_id": 43743497, "comment_id": 74534704, "body": "If f.name = &quot;suppliercode&quot; Then ???  Try that and step through to debug"}, {"owner": {"reputation": 53, "user_id": 7535917, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0e3535e1fdd0a7378f909d10857746b?s=128&d=identicon&r=PG&f=1", "display_name": "Noisewater", "link": "https://stackoverflow.com/users/7535917/noisewater"}, "reply_to_user": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1493815406, "post_id": 43743497, "comment_id": 74561887, "body": "It seems it doesn&#39;t like .additem and it skips over the if statement. Expected function or variable on .additem. I updated this thread with what I have tried"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1493817328, "post_id": 43743497, "comment_id": 74563424, "body": "Try changing the line to &quot;If f.NAME = &quot;suppliercode&quot; Then&quot;  Some of your other code in that for loop won&#39;t work either.  The following link will take you through the process of getting the options from a select element.  It uses the GetElementById method, which you can replace with GetElementsByName(&quot;suppliercode&quot;)(0) method.  The zero is necessary because there may be more than one element named &quot;suppliercode&quot;.  0 represents the first instance, 1 represents the 2nd instance, etc etc <a href=\"http://www.exceltrainingvideos.com/tag/get-option-values-from-drop-down-list-with-vba/\" rel=\"nofollow noreferrer\">exceltrainingvideos.com/tag/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 7535917, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0e3535e1fdd0a7378f909d10857746b?s=128&d=identicon&r=PG&f=1", "display_name": "Noisewater", "link": "https://stackoverflow.com/users/7535917/noisewater"}, "edited": false, "score": 0, "creation_date": 1494258993, "post_id": 43788910, "comment_id": 74739962, "body": "user defined type not defined on <code>Global myDoc As HTMLDocument</code> and sub never exits. Always goes to expected end sub on line before end sub.."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 53, "user_id": 7535917, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0e3535e1fdd0a7378f909d10857746b?s=128&d=identicon&r=PG&f=1", "display_name": "Noisewater", "link": "https://stackoverflow.com/users/7535917/noisewater"}, "edited": false, "score": 0, "creation_date": 1494261219, "post_id": 43788910, "comment_id": 74741289, "body": "My bad.  Erase the two global variables first.  After the guid references are added it will replace them."}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1493917608, "creation_date": 1493917608, "answer_id": 43788910, "question_id": 43743497, "link": "https://stackoverflow.com/questions/43743497/populate-excel-user-form-combo-box-from-html-combo-box-with-vba/43788910#43788910", "title": "Populate excel user form combo-box from html combo-box with vba", "body": "<p>Please place the following HTML code into notepad and save as an HTML file.  Open that file in MSIE</p>\n\n<p>Then open a new clean workbook and paste the macro code below into in a standard module.  Make sure that your webpage is open in MSIE.  Go to the editor and put your cursor some where inside the \"StartHere()\" subroutine.  Press PF5 to run it.  A userform will open with the names of all open browser pages that are open.  Select the one with the title \"Test Get Select Options\".  A msgbox will appear to say that the page has been successfully put into an Excel Object.  Then check your worksheet to see if it listed the four options in column A.  </p>\n\n<p>If it works then clear sheet1 and open your web page.  Try the macro again and see if 9it works with your page.</p>\n\n<p><strong>HTML:Code</strong></p>\n\n<pre><code>&lt;!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\"&gt; &lt;html lang=\"en\"&gt; \n&lt;head&gt; \n&lt;meta http-equiv=\"content-type\" content=\"text/html; charset=utf-8\"&gt; \n&lt;title&gt;Test Get Select Options&lt;/title&gt; \n&lt;/head&gt; \n&lt;body&gt; \n\n&lt;form id=\"NewReleaseQueueForm1\" method=\"post\" name=\"NewReleaseQueueForm1\"&gt;\n    &lt;table cellpadding=\"4\"&gt;\n        &lt;tr&gt;\n            &lt;th valign=\"top\"&gt;Supplier Site&lt;/th&gt;\n            &lt;td valign=\"top\"&gt;\n                &lt;select multiple name=\"suppliercode\" size=\"5\"&gt;\n                    &lt;option selected value=\"Any\"&gt;\n                        &amp;lt;Any&amp;gt;\n                    &lt;/option&gt;\n                    &lt;option value=\"T488C\"&gt;\n                        T488C\n                    &lt;/option&gt;\n                    &lt;option value=\"R488C\"&gt;\n                        R488C\n                    &lt;/option&gt;\n                    &lt;option value=\"C488C\"&gt;\n                        C488C\n                    &lt;/option&gt;\n                    &lt;option value=\"Z488C\"&gt;\n                        Z488C\n                    &lt;/option&gt;\n                &lt;/select&gt;\n            &lt;/td&gt;\n            &lt;td&gt;&lt;/td&gt;\n       &lt;/tr&gt;\n   &lt;/table&gt;\n&lt;/form&gt;\n&lt;/body&gt; \n&lt;/html&gt; \n</code></pre>\n\n<p><strong>Macro Code:</strong></p>\n\n<pre><code>Global myDoc As HTMLDocument\nGlobal IE As Object\nSub StartHere()\n    On Error Resume Next\n        ThisWorkbook.VBProject.References.AddFromGuid \"{420B2830-E718-11CF-893D-00A0C9054228}\", 0, 0    'Microsoft Scripting Runtime\n        ThisWorkbook.VBProject.References.AddFromGuid \"{0002E157-0000-0000-C000-000000000046}\", 0, 0    'Microsoft Extensability for VBA\n        ThisWorkbook.VBProject.References.AddFromGuid \"{0D452EE1-E08F-101A-852E-02608C4D0BB4}\", 0, 0    'Microsoft Forms\n        ThisWorkbook.VBProject.References.AddFromGuid \"{3050F1C5-98B5-11CF-BB82-00AA00BDCE0B}\", 0, 0    'Microsoft MSHTML\n        ThisWorkbook.VBProject.References.AddFromGuid \"{EAB22AC0-30C1-11CF-A7EB-0000C05BAE0B}\", 0, 0    'Microsoft Internet Controls\n    On Error GoTo 0\nCall nextSub\nEnd Sub\nSub nextSub()\n        Dim VBProj As VBIDE.VBProject\n        Dim VBComp As VBIDE.VBComponent\n        Dim CodeMod As VBIDE.codemodule\n        Dim LineNum As Long\n        Set VBProj = ActiveWorkbook.VBProject\n        Set VBComp = VBProj.VBComponents(\"Module1\")\n        Set CodeMod = VBComp.codemodule\n        LineNum = 1\n        CodeMod.insertlines 1, \"Global myDoc As HTMLDocument\"\n        CodeMod.insertlines 2, \"Global IE As Object\"\n        Call getOpenBrowserCreateForm\nEnd Sub\nSub removeCode()\n        Set VBProj = ActiveWorkbook.VBProject\n        Set VBComp = VBProj.VBComponents(\"Module1\")\n        Set CodeMod = VBComp.codemodule\n        LineNum = 1\n    For i = 34 To 4 Step -1\n            CodeMod.DeleteLines i\n    Next i\nEnd Sub\nPublic myDoc As HTMLDocument\nPublic IE As Object\n\n\nSub getOpenBrowserCreateForm()\nDim myForm As Object\nDim NewFrame As MSForms.Frame\nDim NewButton As MSForms.CommandButton, newButton2 As MSForms.CommandButton\n'Dim NewComboBox As MSForms.ComboBox\nDim NewListBox As MSForms.ListBox\n'Dim NewTextBox As MSForms.TextBox\n'Dim NewLabel As MSForms.Label\n'Dim NewOptionButton As MSForms.OptionButton\n'Dim NewCheckBox As MSForms.CheckBox\nDim x As Integer\nDim Line As Integer\n\n'This is to stop screen flashing while creating form\nApplication.VBE.MainWindow.Visible = False\n\nOn Error Resume Next\nApplication.VBE.ActiveVBProject.References.AddFromFile \"C:\\Windows\\System32\\mshtml.tlb\"\nApplication.VBE.ActiveVBProject.References.AddFromFile \"C:\\Windows\\System32\\ieframe.dll\"\nApplication.VBE.ActiveVBProject.References.AddFromFile \"C:\\Windows\\system32\\scrrun.dll\"\nApplication.VBE.ActiveVBProject.References.AddFromFile \"C:\\Windows\\system32\\FM20.DLL\"\nOn Error GoTo 0\nSet myForm = ThisWorkbook.VBProject.VBComponents.Add(3)\n\n'Create the User Form\nWith myForm\n    .Properties(\"Caption\") = \"Select Open Web Site\"\n    .Properties(\"Width\") = 326\n    .Properties(\"Height\") = 280\nEnd With\n\n'Create ListBox\nSet NewListBox = myForm.designer.Controls.Add(\"Forms.listbox.1\")\nWith NewListBox\n    .Name = \"ListBox1\"\n    .Top = 12\n    .Left = 12\n    .Width = 297\n    .Height = 207.8\n    .Font.Size = 9\n    .Font.Name = \"Tahoma\"\n    .BorderStyle = fmBorderStyleOpaque\n    .SpecialEffect = fmSpecialEffectSunken\nEnd With\n\n'Create CommandButton1 Create\nSet NewButton = myForm.designer.Controls.Add(\"Forms.commandbutton.1\")\nWith NewButton\n    .Name = \"CommandButton1\"\n    .Caption = \"Select\"\n    .Accelerator = \"M\"\n    .Top = 228\n    .Left = 234\n    .Width = 72\n    .Height = 24\n    .Font.Size = 9\n    .Font.Name = \"Tahoma\"\n    .BackStyle = fmBackStyleOpaque\nEnd With\n\n'Create CommandButton2 Create\nSet NewButton = myForm.designer.Controls.Add(\"Forms.commandbutton.1\")\nWith NewButton\n    .Name = \"CommandButton2\"\n    .Caption = \"Cancel\"\n    .Accelerator = \"M\"\n    .Top = 228\n    .Left = 144\n    .Width = 72\n    .Height = 24\n    .Font.Size = 9\n    .Font.Name = \"Tahoma\"\n    .BackStyle = fmBackStyleOpaque\nEnd With\n\n'add code for form module\nmyForm.codemodule.insertlines 1, \"Private Sub CommandButton1_Click()\"\nmyForm.codemodule.insertlines 2, \"Dim urlLocation As String\"\nmyForm.codemodule.insertlines 3, \"\"\nmyForm.codemodule.insertlines 4, \"''////////////////////////////////////////////////////////////////////\"\nmyForm.codemodule.insertlines 5, \"''  This part gets all open web pages qand displays them on the form for user to choose\"\nmyForm.codemodule.insertlines 6, \"''\"\nmyForm.codemodule.insertlines 7, \"    Set objIterator = CreateObject(\" &amp; Chr(34) &amp; \"Shell.Application\" &amp; Chr(34) &amp; \")\"\nmyForm.codemodule.insertlines 8, \"    For X = 0 To objIterator.Windows.Count\"\nmyForm.codemodule.insertlines 9, \"        On Error Resume Next\"\nmyForm.codemodule.insertlines 10, \"        current_title = objIterator.Windows(X).Document.Title\"\nmyForm.codemodule.insertlines 11, \"        current_url = objIterator.Windows(X).Document.Location\"\nmyForm.codemodule.insertlines 12, \"    \"\nmyForm.codemodule.insertlines 13, \"        If current_title = ListBox1.Value Then 'is this my webpage?\"\nmyForm.codemodule.insertlines 14, \"        \"\nmyForm.codemodule.insertlines 15, \"            Set IE = objIterator.Windows(X)\"\nmyForm.codemodule.insertlines 16, \"            MsgBox \" &amp; Chr(34) &amp; \"IE was properly set\" &amp; Chr(34) &amp; \"\"\nmyForm.codemodule.insertlines 17, \"            \"\nmyForm.codemodule.insertlines 18, \"             Boolean_indicator = True\"\nmyForm.codemodule.insertlines 19, \"            Exit For\"\nmyForm.codemodule.insertlines 20, \"        End If\"\nmyForm.codemodule.insertlines 21, \"    Next\"\nmyForm.codemodule.insertlines 22, \"    Set objIterator = Nothing\"\nmyForm.codemodule.insertlines 23, \"    Set myDoc = IE.Document\"\nmyForm.codemodule.insertlines 24, \"Return\"\nmyForm.codemodule.insertlines 25, \"Unload Me\"\nmyForm.codemodule.insertlines 26, \"\"\nmyForm.codemodule.insertlines 27, \"End Sub\"\nmyForm.codemodule.insertlines 28, \"\"\nmyForm.codemodule.insertlines 29, \"\"\nmyForm.codemodule.insertlines 30, \"Private Sub CommandButton2_Click()\"\nmyForm.codemodule.insertlines 31, \" Unload Me\"\nmyForm.codemodule.insertlines 32, \"End Sub\"\nmyForm.codemodule.insertlines 33, \"\"\nmyForm.codemodule.insertlines 34, \"\"\nmyForm.codemodule.insertlines 35, \"Private Sub UserForm_Activate()\"\nmyForm.codemodule.insertlines 36, \"    Dim myArray1() As String, tempNumb As Integer\"\nmyForm.codemodule.insertlines 37, \"    \"\nmyForm.codemodule.insertlines 38, \"    \"\nmyForm.codemodule.insertlines 39, \"    i = 2\"\nmyForm.codemodule.insertlines 40, \"    tempNumb = 1\"\nmyForm.codemodule.insertlines 41, \"    \"\nmyForm.codemodule.insertlines 42, \"    ReDim myArray1(1 To 1)\"\nmyForm.codemodule.insertlines 43, \"   \"\nmyForm.codemodule.insertlines 44, \"    Set objShell = CreateObject(\" &amp; Chr(34) &amp; \"Shell.Application\" &amp; Chr(34) &amp; \")\"\nmyForm.codemodule.insertlines 45, \"    Set objAllWindows = objShell.Windows\"\nmyForm.codemodule.insertlines 46, \"    \"\nmyForm.codemodule.insertlines 47, \"    \"\nmyForm.codemodule.insertlines 48, \"    For Each ow In objAllWindows\"\nmyForm.codemodule.insertlines 49, \"        If (InStr(1, ow,\" &amp; Chr(34) &amp; \"Internet Explorer\" &amp; Chr(34) &amp; \", vbTextCompare)) Then\"\nmyForm.codemodule.insertlines 50, \"            myArray1(tempNumb) = ow.Document.Title\"\nmyForm.codemodule.insertlines 51, \"            tempNumb = tempNumb + 1\"\nmyForm.codemodule.insertlines 52, \"            If Not ow.Document.Title = \" &amp; Chr(34) &amp; \"\" &amp; Chr(34) &amp; \" Then\"\nmyForm.codemodule.insertlines 53, \"                ReDim Preserve myArray1(1 To tempNumb)\"\nmyForm.codemodule.insertlines 54, \"            Else\"\nmyForm.codemodule.insertlines 55, \"                Exit For\"\nmyForm.codemodule.insertlines 56, \"            End If\"\nmyForm.codemodule.insertlines 57, \"        End If\"\nmyForm.codemodule.insertlines 58, \"    Next\"\nmyForm.codemodule.insertlines 59, \"     \"\nmyForm.codemodule.insertlines 60, \"    Me.ListBox1.List = myArray1\"\nmyForm.codemodule.insertlines 61, \"End Sub\"\nmyForm.codemodule.insertlines 62, \"\"\n'Show the form\nVBA.UserForms.Add(myForm.Name).Show\n\n'Delete the form (Optional)\nApplication.VBE.MainWindow.Visible = True\n\nThisWorkbook.VBProject.VBComponents.Remove myForm\n\n'   IE is now set to the user's choice and you can add code here to interact with it\n'   myDoc is now set to IE.Document also\n'\n'\n'\n\nDim drp As HTMLFormElement\n\nSet drp = myDoc.getelementsbyname(\"suppliercode\")(0)\n\n\n\nDim walekuj As Long\nwalekuj = myDoc.forms.Length\n MsgBox walekuj\n\n'we get the option values into our worksheet\n\nFor x = 0 To 3\n Cells(x + 1, 1) = drp.Item(x).innerText\n Next x\n\n'Now we select the option value of our choice\n\ndrp.selectedIndex = 2\n\n' we free memory\n\nSet IE = Nothing\n Application.StatusBar = \"\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1494262374, "creation_date": 1494262374, "answer_id": 43853169, "question_id": 43743497, "link": "https://stackoverflow.com/questions/43743497/populate-excel-user-form-combo-box-from-html-combo-box-with-vba/43853169#43853169", "title": "Populate excel user form combo-box from html combo-box with vba", "body": "<p>Just add the referecnes in a clean workbook yourself through the VB editor \"Tools\" - \"References.\"  They are '<strong><em>Microsoft Scripting Runtime</em></strong>,  '<strong><em>Microsoft Forms</em></strong>, '<strong><em>Microsoft MSHTML</em></strong>, and '<strong><em>Microsoft Internet Controls</em></strong>.  Then add the following code into the module and run getOpenBrowserCreateForm().  It's been working for me for years</p>\n\n<pre><code>Global myDoc As HTMLDocument\nGlobal IE As Object\n\n\nSub getOpenBrowserCreateForm()\nDim myForm As Object\nDim NewFrame As MSForms.Frame\nDim NewButton As MSForms.CommandButton, newButton2 As MSForms.CommandButton\n'Dim NewComboBox As MSForms.ComboBox\nDim NewListBox As MSForms.ListBox\n'Dim NewTextBox As MSForms.TextBox\n'Dim NewLabel As MSForms.Label\n'Dim NewOptionButton As MSForms.OptionButton\n'Dim NewCheckBox As MSForms.CheckBox\nDim x As Integer\nDim Line As Integer\n\n'This is to stop screen flashing while creating form\nApplication.VBE.MainWindow.Visible = False\n\nOn Error Resume Next\nApplication.VBE.ActiveVBProject.References.AddFromFile \"C:\\Windows\\System32\\mshtml.tlb\"\nApplication.VBE.ActiveVBProject.References.AddFromFile \"C:\\Windows\\System32\\ieframe.dll\"\nApplication.VBE.ActiveVBProject.References.AddFromFile \"C:\\Windows\\system32\\scrrun.dll\"\nApplication.VBE.ActiveVBProject.References.AddFromFile \"C:\\Windows\\system32\\FM20.DLL\"\nOn Error GoTo 0\nSet myForm = ThisWorkbook.VBProject.VBComponents.Add(3)\n\n'Create the User Form\nWith myForm\n    .Properties(\"Caption\") = \"Select Open Web Site\"\n    .Properties(\"Width\") = 326\n    .Properties(\"Height\") = 280\nEnd With\n\n'Create ListBox\nSet NewListBox = myForm.designer.Controls.Add(\"Forms.listbox.1\")\nWith NewListBox\n    .Name = \"ListBox1\"\n    .Top = 12\n    .Left = 12\n    .Width = 297\n    .Height = 207.8\n    .Font.Size = 9\n    .Font.Name = \"Tahoma\"\n    .BorderStyle = fmBorderStyleOpaque\n    .SpecialEffect = fmSpecialEffectSunken\nEnd With\n\n'Create CommandButton1 Create\nSet NewButton = myForm.designer.Controls.Add(\"Forms.commandbutton.1\")\nWith NewButton\n    .Name = \"CommandButton1\"\n    .Caption = \"Select\"\n    .Accelerator = \"M\"\n    .Top = 228\n    .Left = 234\n    .Width = 72\n    .Height = 24\n    .Font.Size = 9\n    .Font.Name = \"Tahoma\"\n    .BackStyle = fmBackStyleOpaque\nEnd With\n\n'Create CommandButton2 Create\nSet NewButton = myForm.designer.Controls.Add(\"Forms.commandbutton.1\")\nWith NewButton\n    .Name = \"CommandButton2\"\n    .Caption = \"Cancel\"\n    .Accelerator = \"M\"\n    .Top = 228\n    .Left = 144\n    .Width = 72\n    .Height = 24\n    .Font.Size = 9\n    .Font.Name = \"Tahoma\"\n    .BackStyle = fmBackStyleOpaque\nEnd With\n\n'add code for form module\nmyForm.codemodule.insertlines 1, \"Private Sub CommandButton1_Click()\"\nmyForm.codemodule.insertlines 2, \"Dim urlLocation As String\"\nmyForm.codemodule.insertlines 3, \"\"\nmyForm.codemodule.insertlines 4, \"''////////////////////////////////////////////////////////////////////\"\nmyForm.codemodule.insertlines 5, \"''  This part gets all open web pages qand displays them on the form for user to choose\"\nmyForm.codemodule.insertlines 6, \"''\"\nmyForm.codemodule.insertlines 7, \"    Set objIterator = CreateObject(\" &amp; Chr(34) &amp; \"Shell.Application\" &amp; Chr(34) &amp; \")\"\nmyForm.codemodule.insertlines 8, \"    For X = 0 To objIterator.Windows.Count\"\nmyForm.codemodule.insertlines 9, \"        On Error Resume Next\"\nmyForm.codemodule.insertlines 10, \"        current_title = objIterator.Windows(X).Document.Title\"\nmyForm.codemodule.insertlines 11, \"        current_url = objIterator.Windows(X).Document.Location\"\nmyForm.codemodule.insertlines 12, \"    \"\nmyForm.codemodule.insertlines 13, \"        If current_title = ListBox1.Value Then 'is this my webpage?\"\nmyForm.codemodule.insertlines 14, \"        \"\nmyForm.codemodule.insertlines 15, \"            Set IE = objIterator.Windows(X)\"\nmyForm.codemodule.insertlines 16, \"            MsgBox \" &amp; Chr(34) &amp; \"IE was properly set\" &amp; Chr(34) &amp; \"\"\nmyForm.codemodule.insertlines 17, \"            \"\nmyForm.codemodule.insertlines 18, \"             Boolean_indicator = True\"\nmyForm.codemodule.insertlines 19, \"            Exit For\"\nmyForm.codemodule.insertlines 20, \"        End If\"\nmyForm.codemodule.insertlines 21, \"    Next\"\nmyForm.codemodule.insertlines 22, \"    Set objIterator = Nothing\"\nmyForm.codemodule.insertlines 23, \"    Set myDoc = IE.Document\"\nmyForm.codemodule.insertlines 24, \"Return\"\nmyForm.codemodule.insertlines 25, \"Unload Me\"\nmyForm.codemodule.insertlines 26, \"\"\nmyForm.codemodule.insertlines 27, \"End Sub\"\nmyForm.codemodule.insertlines 28, \"\"\nmyForm.codemodule.insertlines 29, \"\"\nmyForm.codemodule.insertlines 30, \"Private Sub CommandButton2_Click()\"\nmyForm.codemodule.insertlines 31, \" Unload Me\"\nmyForm.codemodule.insertlines 32, \"End Sub\"\nmyForm.codemodule.insertlines 33, \"\"\nmyForm.codemodule.insertlines 34, \"\"\nmyForm.codemodule.insertlines 35, \"Private Sub UserForm_Activate()\"\nmyForm.codemodule.insertlines 36, \"    Dim myArray1() As String, tempNumb As Integer\"\nmyForm.codemodule.insertlines 37, \"    \"\nmyForm.codemodule.insertlines 38, \"    \"\nmyForm.codemodule.insertlines 39, \"    i = 2\"\nmyForm.codemodule.insertlines 40, \"    tempNumb = 1\"\nmyForm.codemodule.insertlines 41, \"    \"\nmyForm.codemodule.insertlines 42, \"    ReDim myArray1(1 To 1)\"\nmyForm.codemodule.insertlines 43, \"   \"\nmyForm.codemodule.insertlines 44, \"    Set objShell = CreateObject(\" &amp; Chr(34) &amp; \"Shell.Application\" &amp; Chr(34) &amp; \")\"\nmyForm.codemodule.insertlines 45, \"    Set objAllWindows = objShell.Windows\"\nmyForm.codemodule.insertlines 46, \"    \"\nmyForm.codemodule.insertlines 47, \"    \"\nmyForm.codemodule.insertlines 48, \"    For Each ow In objAllWindows\"\nmyForm.codemodule.insertlines 49, \"        If (InStr(1, ow,\" &amp; Chr(34) &amp; \"Internet Explorer\" &amp; Chr(34) &amp; \", vbTextCompare)) Then\"\nmyForm.codemodule.insertlines 50, \"            myArray1(tempNumb) = ow.Document.Title\"\nmyForm.codemodule.insertlines 51, \"            tempNumb = tempNumb + 1\"\nmyForm.codemodule.insertlines 52, \"            If Not ow.Document.Title = \" &amp; Chr(34) &amp; \"\" &amp; Chr(34) &amp; \" Then\"\nmyForm.codemodule.insertlines 53, \"                ReDim Preserve myArray1(1 To tempNumb)\"\nmyForm.codemodule.insertlines 54, \"            Else\"\nmyForm.codemodule.insertlines 55, \"                Exit For\"\nmyForm.codemodule.insertlines 56, \"            End If\"\nmyForm.codemodule.insertlines 57, \"        End If\"\nmyForm.codemodule.insertlines 58, \"    Next\"\nmyForm.codemodule.insertlines 59, \"     \"\nmyForm.codemodule.insertlines 60, \"    Me.ListBox1.List = myArray1\"\nmyForm.codemodule.insertlines 61, \"End Sub\"\nmyForm.codemodule.insertlines 62, \"\"\n'Show the form\nVBA.UserForms.Add(myForm.Name).Show\n\n'Delete the form (Optional)\nApplication.VBE.MainWindow.Visible = True\n\nThisWorkbook.VBProject.VBComponents.Remove myForm\n\n'   IE is now set to the user's choice and you can add code here to interact with it\n'   myDoc is now set to IE.Document also\n'\n'\n'\n\nDim drp As HTMLFormElement\n\nSet drp = myDoc.getelementsbyname(\"suppliercode\")(0)\n\n\n\nDim walekuj As Long\nwalekuj = myDoc.forms.Length\n MsgBox walekuj\n\n'we get the option values into our worksheet\n\nFor x = 0 To 3\n Cells(x + 1, 1) = drp.Item(x).innerText\n Next x\n\n'Now we select the option value of our choice\n\ndrp.selectedIndex = 2\n\n' we free memory\n\nSet IE = Nothing\n Application.StatusBar = \"\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 7535917, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0e3535e1fdd0a7378f909d10857746b?s=128&d=identicon&r=PG&f=1", "display_name": "Noisewater", "link": "https://stackoverflow.com/users/7535917/noisewater"}, "is_accepted": true, "score": 0, "last_activity_date": 1494592629, "creation_date": 1494592629, "answer_id": 43937965, "question_id": 43743497, "link": "https://stackoverflow.com/questions/43743497/populate-excel-user-form-combo-box-from-html-combo-box-with-vba/43937965#43937965", "title": "Populate excel user form combo-box from html combo-box with vba", "body": "<p>I got this to work. Thank you for your time and effort for those that posted.</p>\n\n<pre><code>Set IE = IE.document.frames(1).document\nDim supls As Object\nDim suplsDrop As Object\n Set suplsDrop = IE.getElementsByTagName(\"OPTION\")\n For Each supls In IE.getElementsByTagName(\"SELECT\")\n  If supls.Name = \"suppliercode\" Then\n For Each suplsDrop In supls\n  With Me.SupplierSite\n  .AddItem suplsDrop.Value\n  End With\nNext suplsDrop\nEnd If\nNext supls\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 7535917, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0e3535e1fdd0a7378f909d10857746b?s=128&d=identicon&r=PG&f=1", "display_name": "Noisewater", "link": "https://stackoverflow.com/users/7535917/noisewater"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 472, "favorite_count": 1, "accepted_answer_id": 43937965, "answer_count": 3, "score": 0, "last_activity_date": 1494592629, "creation_date": 1493744529, "last_edit_date": 1493815708, "question_id": 43743497, "link": "https://stackoverflow.com/questions/43743497/populate-excel-user-form-combo-box-from-html-combo-box-with-vba", "title": "Populate excel user form combo-box from html combo-box with vba", "body": "<p>I have a user form that I would like the html option values to populate the excel combo box. Basically I want to duplicate the values and pass them later.</p>\n\n<p>What I have is smashed together from various posts but nothing seems to work. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim appIE As InternetExplorerMedium\nDim nam As Object\nDim sel As Object\n\nSet appIE = New InternetExplorerMedium\nsURL = \"site infor goes here\"\nWith appIE\n    .navigate sURL\n    .Visible = True\nEnd With\nDo While appIE.Busy Or appIE.readyState &lt;&gt; 4\n    DoEvents\nLoop\nFor Each f In IE.document.getElementsByTagName(\"select\")\n    If f = \"suppliercode\" Then\n        For Each fOption In IE.document.getElementsByTagName(\"option\")\n            With Me.SupplierSite.AddItem(f.Option)\n            End With\n        Next fOption\n    End If\nNext f\n\nALSO TRIED:\nSet Doc = IE.document.forms(\"NewReleaseQueueForm1\")\nFor Each sel In Doc.getElementsByTagName(\"select\")(0).Value\nIf sel.Name = \"suppliercode\" Then\n'loop through and add each option to Me.SupplierSite\nFor Each opt In IE.document.forms(\"NewReleaseQueueForm1\").getElementsByTagName(\"option\")(0).Value\nMe.SupplierSite.AddItem sel.Value\nNext opt\nEnd If\nNext sel\n</code></pre>\n\n<p>HTML Sample:</p>\n\n<pre class=\"lang-htm prettyprint-override\"><code>&lt;form id=\"NewReleaseQueueForm1\" method=\"post\" name=\"NewReleaseQueueForm1\"&gt;\n    &lt;table cellpadding=\"4\"&gt;\n        &lt;tr&gt;\n            &lt;th valign=\"top\"&gt;Supplier Site&lt;/th&gt;\n            &lt;td valign=\"top\"&gt;\n                &lt;select multiple name=\"suppliercode\" size=\"5\"&gt;\n                    &lt;option selected value=\"Any\"&gt;\n                        &amp;lt;Any&amp;gt;\n                    &lt;/option&gt;\n                    &lt;option value=\"T488C\"&gt;\n                        T488C\n                    &lt;/option&gt;\n                &lt;/select&gt;\n            &lt;/td&gt;\n            &lt;td&gt;&lt;/td&gt;\n</code></pre>\n"}, {"tags": ["vba", "excel", "cdo.message"], "comments": [{"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1493754335, "post_id": 43743050, "comment_id": 74534970, "body": "Their browsers are possibly caching the image from the last time they received an email with that image link.  Do they have that same file and folder on their computers and is the file updated on them?  It looks like you are telling the html to open the image from their computers, but I&#39;ve never worked with CDO to send mail."}, {"owner": {"reputation": 179, "user_id": 5264707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311ba128d9d7f043a816a42f968abceb?s=128&d=identicon&r=PG&f=1", "display_name": "The Gambill", "link": "https://stackoverflow.com/users/5264707/the-gambill"}, "reply_to_user": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1493756589, "post_id": 43743050, "comment_id": 74536244, "body": "well duh... thank you! I changed the path to a shared location and now it updates correctly."}], "owner": {"reputation": 179, "user_id": 5264707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311ba128d9d7f043a816a42f968abceb?s=128&d=identicon&r=PG&f=1", "display_name": "The Gambill", "link": "https://stackoverflow.com/users/5264707/the-gambill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 826, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1493747722, "creation_date": 1493742927, "last_edit_date": 1531164843, "question_id": 43743050, "link": "https://stackoverflow.com/questions/43743050/vba-cdo-sending-old-image-in-email-body", "title": "VBA CDO Sending old image in email body", "body": "<p>I'm using vba to send email using CDO (See below) it keeps pulling a old image from over 30 days ago for the email that it is sending out.  Can anyone help?</p>\n\n<pre><code>Public Function sndmail(ByVal RecipientList As String, _\n    ByVal Subject As String, ByVal body As String, Optional ByVal Attachment As String, _\n    Optional ByVal cc As String)\nDim iMsg As Message\nDim iConf As Configuration\nDim strbody As String\nDim Flds As Variant\n\nSet iMsg = CreateObject(\"CDO.Message\")\nSet iConf = CreateObject(\"CDO.Configuration\")\n\niConf.Load -1    ' CDO Source Defaults\nSet Flds = iConf.Fields\nWith Flds\n  .Item(\"http://schemas.microsoft.com/cdo/configuration/sendusing\") = 2\n  .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserver\") = \"SMTP.xx.xyz.COM\"\n  .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserverport\") = 25\n  .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpusessl\") = False\n  .Update\nEnd With\n\nWith iMsg\n    Set .Configuration = iConf\n    .To = RecipientList\n    .cc = cc\n    .From = \"chris@yoohoo.com\"\n    .Subject = Subject\n    .HTMLBody = body\nEnd With\n\niMsg.Send\n\nEnd Function\n\n...\n\nimgfile = \"C:\\TEMP\\FDW_Img.png\"\nimgfile2 = \"C:\\TEMP\\FDW_DoD.png\"\nSet pp = New PowerPoint.Application\nSet ppt = pp.Presentations.Open(\"C:\\TEMP\\bpp.pptx\")\nwbk1.Sheets(\"Summary by Modcode\").Range(\"F22:Z28\").Copy\nppt.Slides(1).Shapes.PasteSpecial (ppPasteBitmap)\nppt.Slides(1).Shapes(1).Export imgfile, ppShapeFormatPNG\nppt.Close\npp.Quit\nDoEvents\n\n'list of recipients\nsndto = \"\"\n'subject line for email\nsubj = \"5 State Capital Finance Reports for  \" &amp; Date\n'body of email\nbod = \"Happy \" &amp; WeekdayName(Weekday(Date)) &amp; \"! &lt;br&gt;\" &amp; WeekdayName(Weekday(Date)) &amp; \"'s reports have been updated and can be found at the below links and snapshots can be found at the first weblink:&lt;br&gt;&lt;br&gt;\" &amp; _\n \"&lt;a href = a weblink here that currently works fine&gt; Finance Website &lt;/a&gt; &lt;br&gt;\" &amp; _\n    \"&lt;a href = another one here... works fine&gt; Open vs Actuals &lt;/a&gt; &lt;br&gt;\" &amp; _\n    \"&lt;a href = another one here... works fine&gt; EE Report &lt;a&gt;&lt;br&gt;\" &amp; _\n    \"&lt;a href = another one here... works fine&gt; FDW Actuals &lt;a&gt;\" &amp; _\n    \" &lt;br&gt; &lt;br&gt;&lt;img src='C:\\Temp\\FDW_img.png'&gt;&lt;br&gt;&lt;br&gt;\" &amp; sig\n'function to send email\nsndmail sndto, subj, bod\nApplication.CutCopyMode = False\nwbk1.Close False\n</code></pre>\n\n<p>This line is where it adds the image to the body of the email and it is adding an old image... the strange thing is that on the host pc if I pull up my email it shows correctly but on all other recipients or if I pull up my email on another pc it shows up with the old image.</p>\n\n<pre><code>\" &lt;br&gt; &lt;br&gt;&lt;img src='C:\\Temp\\FDW_img.png'&gt;&lt;br&gt;&lt;br&gt;\" &amp; sig\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 37, "user_id": 7793096, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/51e5f1c3c8eda8e59ceea7c5a15dfc8c?s=128&d=identicon&r=PG&f=1", "display_name": "NeilD137", "link": "https://stackoverflow.com/users/7793096/neild137"}, "edited": false, "score": 2, "creation_date": 1493745501, "post_id": 43743085, "comment_id": 74530261, "body": "@NeilD137 you might give Scott credit and mark as &quot;ANSWER&quot; (I&#39;ve seen you haven&#39;t done it so far with previous posts, do you know how ?)"}, {"owner": {"reputation": 37, "user_id": 7793096, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/51e5f1c3c8eda8e59ceea7c5a15dfc8c?s=128&d=identicon&r=PG&f=1", "display_name": "NeilD137", "link": "https://stackoverflow.com/users/7793096/neild137"}, "edited": false, "score": 0, "creation_date": 1493904794, "post_id": 43743085, "comment_id": 74609089, "body": "Actually, if you could tell me how to, I will be sure to do that going forward"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 37, "user_id": 7793096, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/51e5f1c3c8eda8e59ceea7c5a15dfc8c?s=128&d=identicon&r=PG&f=1", "display_name": "NeilD137", "link": "https://stackoverflow.com/users/7793096/neild137"}, "edited": false, "score": 0, "creation_date": 1493905365, "post_id": 43743085, "comment_id": 74609564, "body": "@NeilD137 - There&#39;s a grey check mark next to the answer text on the top right, below the voting buttons. Click that check mark :). If you want to answer past questions you can view your profile and click on Questions. Then go to each one and tick the answer. You&#39;ll gain rep by doing so if that matters to you."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 2, "last_activity_date": 1493743045, "creation_date": 1493743045, "answer_id": 43743085, "question_id": 43742682, "link": "https://stackoverflow.com/questions/43742682/compile-error-on-autofilter-by-dynamic-date/43743085#43743085", "title": "Compile Error on Autofilter by Dynamic Date", "body": "<p>Try this:</p>\n\n<pre><code>Range(\"A1:AZ100000\").AutoFilter field:=40, Criteria1:=\"&gt;=\"&amp;DQ, Operator:=xlAnd\n</code></pre>\n\n<p>Tested and works for me.</p>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 3, "last_activity_date": 1493744655, "creation_date": 1493744655, "answer_id": 43743528, "question_id": 43742682, "link": "https://stackoverflow.com/questions/43742682/compile-error-on-autofilter-by-dynamic-date/43743528#43743528", "title": "Compile Error on Autofilter by Dynamic Date", "body": "<p>Just in case @Scott Holtzman solution doesn't work, sometimes the <code>AutoFilter</code> with <code>Date</code>s can be tricky, depends exactly how you formatted the Cells. In some scenarios it works better with <code>Double</code>.</p>\n\n<p>Also, you can use <code>DateAdd</code> function much easier to get a date 2 month prior to Today's date.</p>\n\n<pre><code>Option Explicit\n\nSub Move2017()\n\nDim DQ As Double\n\nDQ = DateAdd(\"m\", -2, Date) '&lt;-- get the date 2 month prior to today's date\nRange(\"A1:AZ100000\").AutoFilter field:=40, Criteria1:=\"&gt;\" &amp; DQ, Operator:=xlAnd\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 7793096, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/51e5f1c3c8eda8e59ceea7c5a15dfc8c?s=128&d=identicon&r=PG&f=1", "display_name": "NeilD137", "link": "https://stackoverflow.com/users/7793096/neild137"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 43743085, "answer_count": 2, "score": 0, "last_activity_date": 1493744655, "creation_date": 1493741691, "last_edit_date": 1531164843, "question_id": 43742682, "link": "https://stackoverflow.com/questions/43742682/compile-error-on-autofilter-by-dynamic-date", "title": "Compile Error on Autofilter by Dynamic Date", "body": "<p>I am getting an error when trying to run a macro which should filter my data based on the date in Column AN. I want this to be date dependent, so it should filter everything from 2 months prior to today's date in time.</p>\n\n<pre><code>Sub Move2017()\nMacro 2017 Clear\nDim DQ As Date\nDQ = dateserial(Year(Now), month(Now) - 2, 1)\nRange(\"A1:AZ100000\").AutoFilter field:=40, Operator:= _\n    xlFilterValues, Criteria2:=Array(1, DQ)\nEnd Sub\n</code></pre>\n\n<p>I keep getting the following error:\n \"Compile Error: Wrong number of arguments or invalid property assignment\"</p>\n\n<p>Any thoughts on how to solve this? </p>\n"}, {"tags": ["mysql", "ms-access", "vba", "odbc", "ado"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1493742249, "post_id": 43742651, "comment_id": 74528480, "body": "Why not create a &quot;normal&quot; Pass-Through query, set its SQL (and Connection if necessary) at runtime, and open that query?"}, {"owner": {"reputation": 92, "user_id": 5936898, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/030d80651522cc40a3fcc06a85e35987?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Boonen", "link": "https://stackoverflow.com/users/5936898/richard-boonen"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1493742501, "post_id": 43742651, "comment_id": 74528657, "body": "to be honest that was my first attempt and I did not get it to work either  what did work was to create a pass through query using the GUI and than modify it&#39;s sql using:  <code>CurrentDb.QueryDefs(&quot;myquery&quot;).SQL = &quot;select * from SurveyResults limit 10;&quot;</code> and than <code>DoCmd.OpenQuery (&quot;myquery&quot;)</code>  but that&#39;s not really a great solution because I want the user to fill out a form that creates sql and runs it and he needs to be able to open various queries at the same time"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1493744047, "post_id": 43742651, "comment_id": 74529496, "body": "It should work, here is an example: <a href=\"http://stackoverflow.com/a/10988389/3820271\">stackoverflow.com/a/10988389/3820271</a> -- I don&#39;t think there is another way than to have actual querydef objects for each query you want to open. -- This is basically the same question: <a href=\"http://stackoverflow.com/questions/23664401/access-form-on-click-event-create-pass-through-query\" title=\"access form on click event create pass through query\">stackoverflow.com/questions/23664401/&hellip;</a>"}, {"owner": {"reputation": 92, "user_id": 5936898, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/030d80651522cc40a3fcc06a85e35987?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Boonen", "link": "https://stackoverflow.com/users/5936898/richard-boonen"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1493745411, "post_id": 43742651, "comment_id": 74530214, "body": "Well, thanks to your insisting that it was the only way to do it I tried again and it turns out my only problem was that by default the &quot;returnRecords&quot; property of the query was set to &quot;false&quot; which is why I did not get the results to show..."}], "answers": [{"tags": [], "owner": {"reputation": 92, "user_id": 5936898, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/030d80651522cc40a3fcc06a85e35987?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Boonen", "link": "https://stackoverflow.com/users/5936898/richard-boonen"}, "is_accepted": false, "score": 1, "last_activity_date": 1493749876, "last_edit_date": 1493749876, "creation_date": 1493745700, "answer_id": 43743791, "question_id": 43742651, "link": "https://stackoverflow.com/questions/43742651/open-ado-recordset-as-visible-table/43743791#43743791", "title": "open ADO recordset as visible table", "body": "<p>I figured it out. My problem was simply that the ReturnsRecords Property is set to false by default.</p>\n\n<p>it works now, so I'm posting a answer if anyone ever needs it.</p>\n\n<pre><code>Sub RunPassThrough(strSQL As String)\n\nDim Server As String\nDim User As String\nDim Pwd As String\nDim DatabaseName As String\nDim qdfPassThrough As DAO.QueryDef, MyDB As Database\nDim strConnect As String\n\n\n' Server Hostname (or IP)\nServer = \"192.168.178.10\"\n\nUser = \"user\"\nPwd = \"mypass\"\n\nDatabaseName = \"database\"\n\n\n\nFor Each qdf In CurrentDb.QueryDefs\nIf qdf.Name = \"PassQuery\" Then\n    CurrentDb.QueryDefs.Delete \"PassQuery\"\n    Exit For\nEnd If\nNext\n\n    strConnect = \"ODBC;DRIVER={MYSQL ODBC 5.1 DRIVER};SERVER=\" &amp; Server &amp; \";DATABASE=\" &amp; DatabaseName &amp; \";Uid=\" &amp; User &amp; \";Pwd=\" &amp; Pwd &amp; \";\"\n\n    Set MyDB = CurrentDb()\n\n    Set qdfPassThrough = MyDB.CreateQueryDef(\"PassQuery\")\n\n\n    qdfPassThrough.Connect = strConnect\n    qdfPassThrough.SQL = strSQL\n    qdfPassThrough.Close\n\n    Application.RefreshDatabaseWindow\n    MyDB.QueryDefs(\"PassQuery\").ReturnsRecords = True\n\n    DoCmd.OpenQuery \"PassQuery\", acViewNormal, acReadOnly\n    DoCmd.Maximize\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 92, "user_id": 5936898, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/030d80651522cc40a3fcc06a85e35987?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Boonen", "link": "https://stackoverflow.com/users/5936898/richard-boonen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594640002, "creation_date": 1493741610, "last_edit_date": 1594640002, "question_id": 43742651, "link": "https://stackoverflow.com/questions/43742651/open-ado-recordset-as-visible-table", "title": "open ADO recordset as visible table", "body": "<p>I'm doing something like this for the first time and it seems incredibly hard to find any useful information at all.</p>\n\n<p>What I want to do:\nPass a select-query to a MySQL database and show the result in a table.</p>\n\n<p>I've got that far by now: I have a button on a form and when clicked the following happens</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Compare Database\n\nSub RunPassThrough(strSQL As String)\n\nDim ConnectionString As String\nDim Server As String\nDim User As String\nDim Pwd As String\nDim DatabaseName As String\nDim Cn As ADODB.Connection\nDim Rs As ADODB.Recordset\n\n\n' Server Hostname (or IP)\nServer = \"192.168.178.10\"\n\nUser = \"user\"\nPwd = \"mypass\"\n\nDatabaseName = \"myDB\"\n\nConnectionString = \"Provider=MSDASQL;Driver={MYSQL ODBC 5.1 DRIVER};\" &amp; _\n        \"Server=\" &amp; Server &amp; \";Database=\" &amp; DatabaseName\n\nSet Cn = New ADODB.Connection\nCn.CursorLocation = adUseClient\nCn.Mode = adModeShareDenyNone\nCn.Open ConnectionString, User, Pwd\n\nSet Rs = New ADODB.Recordset\n\n\nRs.Open strSQL, Cn, adOpenDynamic, adLockReadOnly\n'Set Rs = Cn.Execute(\"select * from SurveyResults limit 10;\")\n\n\n\n\n\nEnd Sub\n\nPrivate Sub Befehl0_Click()\n\nDim SQL As String\n\nSQL = \"select * from SurveyResults limit 10;\"\n\nRunPassThrough (SQL)\n\n\nEnd Sub\n</code></pre>\n\n<p>I know that <code>Rs.Open strSQL, Cn, adOpenDynamic, adLockReadOnly</code> returns an ADO recordset and I could do things with it using VBA, but all I want is to show that recorod set to the user in table.</p>\n\n<p>something like OpenRecordset(\"Rs\", as a table that the user can see)</p>\n\n<p>can someone please point me into the right direction I'm going crazy...</p>\n"}, {"tags": ["sql-server", "vba", "excel", "database-connection"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1493741679, "post_id": 43742495, "comment_id": 74528159, "body": "Don&#39;t use Set when assigning a string - that&#39;s for Object-type variables"}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 1, "creation_date": 1493741704, "post_id": 43742495, "comment_id": 74528170, "body": "Query1 = &quot;Select * from table1&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1493742159, "post_id": 43742701, "comment_id": 74528429, "body": "@ Tim Williams small typo in function call/return."}, {"owner": {"reputation": 183, "user_id": 7905447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/547156512a8ea4ea6c09f9a0bc5c52ac?s=128&d=identicon&r=PG&f=1", "display_name": "Wito", "link": "https://stackoverflow.com/users/7905447/wito"}, "edited": false, "score": 0, "creation_date": 1493808717, "post_id": 43742701, "comment_id": 74557105, "body": "Thanks a lot to both of you! :) I didn&#39;t know that I could structure a Function that way. My intention was to &quot;call&quot; the object that I was creating in Module 4 by first calling the &quot;Sub&quot; Something that I learn today! :)"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1493743039, "last_edit_date": 1493743039, "creation_date": 1493741752, "answer_id": 43742701, "question_id": 43742495, "link": "https://stackoverflow.com/questions/43742495/vba-call-a-module-to-brings-a-string-and-complete-query/43742701#43742701", "title": "VBA - Call a module to brings a string and complete Query", "body": "<pre><code>strSQL = Module4.Query1()\n\n\nFunction Query1() As String\n    Query1 = \"Select * from table1\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 7905447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/547156512a8ea4ea6c09f9a0bc5c52ac?s=128&d=identicon&r=PG&f=1", "display_name": "Wito", "link": "https://stackoverflow.com/users/7905447/wito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "accepted_answer_id": 43742701, "answer_count": 1, "score": 0, "last_activity_date": 1493743039, "creation_date": 1493741108, "question_id": 43742495, "link": "https://stackoverflow.com/questions/43742495/vba-call-a-module-to-brings-a-string-and-complete-query", "title": "VBA - Call a module to brings a string and complete Query", "body": "<p>quite new to VBA. I tried to fix this problem by my own but any of the open threats seems to fit in what I need. </p>\n\n<p><strong>Context:</strong>\nI have this Macro that brings info from a DDBB and copies it in a new Workbook. I would like to organize different queries in different modules than the main one and call them on demand. </p>\n\n<p><strong>Problem:</strong> \nI have set my query in a new module as a string, but I get ByRef or Method or data member not found all the time:</p>\n\n<p><em>Main Sub</em></p>\n\n<pre><code>Sub Consulta_Sql_ERP()\n\n'Declare variables\n    Set objMyConn = New ADODB.Connection\n    Set objMyRecordset = New ADODB.Recordset\n    Dim strSQL As String\n    Dim ws2 As Workbook\n    Dim iCols As Integer\n\n\n'Open Connection'\n    objMyConn.ConnectionString = \"Provider=SQLOLEDB.1;\n                                  Data Source=(...);\n                                  Initial Catalog=(...);\n                                  User ID=(...);\n                                  Password=(...);\n                                  Persist Security Info=True;\"\n    objMyConn.Open\n\n    'Set and Excecute SQL Command'\n\n        strSQL = Module4.Querys(Query1)\n\n'Open Recordset'\n    Set objMyRecordset.ActiveConnection = objMyConn\n        objMyRecordset.Open strSQL\n\n'Open a NewWorkbook\n    Call NewBook\n\n'Copy Data to the new book\n    Set ws2 = ActiveWorkbook\n        ws2.Worksheets(\"Sheet1\").Activate\n\n'Copy headers\n    For iCols = 0 To objMyRecordset.Fields.Count - 1\n        Worksheets(\"Sheet1\").Cells(1, iCols + 1).Value = objMyRecordset.Fields(iCols).Name\n    Next\n\n    ActiveSheet.Range(\"A2\").CopyFromRecordset (objMyRecordset)\n    objMyConn.Close\n\n'Close and save\n    Call carpetaventas\n    'ws.SaveAs Savechanges:=True, Filename:=\"\" &amp; Format(Date, \"yyyymmdd\")\n    'ws2.Close Savechanges:=True, Filename:=\"\" &amp; Format(Date, \"yyyymmdd\"), \n    'RouteWorkbook:=\"C:\\Ventas\"    \nEnd Sub\n</code></pre>\n\n<p>The module in which I have the String of my query is \"Module4\"</p>\n\n<p><em>Sub in which I have my Query:</em></p>\n\n<pre><code>Sub Queries(Query1 As String)\nSet Query1 = \"Select * from table1\"\nEnd Sub\n</code></pre>\n\n<p>It works if I directly introduce the Query after \"strSQL\" but not if I \"call\" the Sub on Module4. Any ideas? </p>\n\n<p>Thanks a lot in advance. </p>\n"}]