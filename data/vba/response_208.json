[{"tags": ["sql-server", "vba", "stored-procedures", "ssms"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9781652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e9518ad7f2fb5b9762f13db4b5e9d4e?s=128&d=identicon&r=PG&f=1", "display_name": "Crash", "link": "https://stackoverflow.com/users/9781652/crash"}, "edited": false, "score": 0, "creation_date": 1546476906, "post_id": 54014973, "comment_id": 94867243, "body": "Happy New Year David Browne!  Thank you!"}], "tags": [], "owner": {"reputation": 49085, "user_id": 7297700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7650f380e0e3b8415ba9afaadf70906?s=128&d=identicon&r=PG&f=1", "display_name": "David Browne - Microsoft", "link": "https://stackoverflow.com/users/7297700/david-browne-microsoft"}, "is_accepted": true, "score": 1, "last_activity_date": 1546475879, "creation_date": 1546475879, "answer_id": 54014973, "question_id": 54014696, "link": "https://stackoverflow.com/questions/54014696/sql-server-i-can-see-stored-procedure-with-vba-in-excel-but-user-group-cannot/54014973#54014973", "title": "SQL Server I can see stored procedure with VBA in Excel but user group cannot", "body": "<blockquote>\n  <p>StrSproc = \"ExportListToExcel\"</p>\n</blockquote>\n\n<p>Name resolution is the first thing rule out.</p>\n\n<p>The name, without schema-qualification will be resolved first in the user's default schema, and then in <code>dbo</code> schema.  </p>\n\n<p>So schema-qualify the procedure name to be sure.</p>\n"}], "owner": {"reputation": 15, "user_id": 9781652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e9518ad7f2fb5b9762f13db4b5e9d4e?s=128&d=identicon&r=PG&f=1", "display_name": "Crash", "link": "https://stackoverflow.com/users/9781652/crash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 54014973, "answer_count": 1, "score": 0, "last_activity_date": 1546475879, "creation_date": 1546473199, "question_id": 54014696, "link": "https://stackoverflow.com/questions/54014696/sql-server-i-can-see-stored-procedure-with-vba-in-excel-but-user-group-cannot", "title": "SQL Server I can see stored procedure with VBA in Excel but user group cannot", "body": "<p>I created a stored procedure and can execute it with the VBA below.  I gave a user group (of which I am a member) Execute permission.  All members of that group except me get the error 'could not find stored procedure' when running the VBA.  The users can log in through SSMS and execute the stored procedure by right clicking it.</p>\n\n<p>When I look at the Effective tab where I granted Execute permissions there is an error: Cannot execute as the server principal because the principal \"MyUserGroup\" does not exist, this type of principal cannot be impersonated, or you do not have permission.</p>\n\n<p>The SQL admin told me that my group does have DBO level permissions.  What am I missing?  Why can't they find the stored procedure when they execute the Excel VBA?  Or is that error telling me that I cannot grant them permission when I should be able to?</p>\n\n<p>Excel VBA to call stored procedure:</p>\n\n<pre><code>Function Sproc()\n    Dim cnn As ADODB.Connection\n    Dim rst As ADODB.Recordset\n    Dim cmd As ADODB.Command\n    Dim ConnectionString As String\n    Dim StrSproc As String\n\n    Set cnn = New ADODB.Connection\n    cnn.ConnectionString = \"Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=True;Initial Catalog=ThisDatabase;Data Source=ThisSource;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=ThisSourceID;Use Encryption for Data=False;Tag with column collation when possible=False\"\n\n    cnn.Open ConnectionString\n    cnn.CommandTimeout = 900\n    Set rst = New ADODB.Recordset\n    StrSproc = \"ExportListToExcel\"\n    rst.ActiveConnection = cnn\n    rst.Open StrSproc\n\n    For i = 0 To rst.Fields.Count - 1\n        Cells(1, i + 1).Value = rst.Fields(i).Name\n    Next i\n\n    Cells(2, 1).CopyFromRecordset rst\nExit Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 25691, "user_id": 1675954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zZXdA.jpg?s=128&g=1", "display_name": "Rachel Gallen", "link": "https://stackoverflow.com/users/1675954/rachel-gallen"}, "edited": false, "score": 0, "creation_date": 1546471403, "post_id": 54014375, "comment_id": 94866069, "body": "are all your dates in column D? What is the cell range? (a &#39;row&#39; can be very short or verrry long.....)"}, {"owner": {"reputation": 646, "user_id": 1442782, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/cd36fc97ddcfb7c102fbb98bfd1cc623?s=128&d=identicon&r=PG", "display_name": "J4C3N-14", "link": "https://stackoverflow.com/users/1442782/j4c3n-14"}, "reply_to_user": {"reputation": 25691, "user_id": 1675954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zZXdA.jpg?s=128&g=1", "display_name": "Rachel Gallen", "link": "https://stackoverflow.com/users/1675954/rachel-gallen"}, "edited": false, "score": 0, "creation_date": 1546471793, "post_id": 54014375, "comment_id": 94866173, "body": "Yes all the Dates are in Column D and always will be. The columns/cells in the row extend from A-S"}, {"owner": {"reputation": 646, "user_id": 1442782, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/cd36fc97ddcfb7c102fbb98bfd1cc623?s=128&d=identicon&r=PG", "display_name": "J4C3N-14", "link": "https://stackoverflow.com/users/1442782/j4c3n-14"}, "reply_to_user": {"reputation": 25691, "user_id": 1675954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zZXdA.jpg?s=128&g=1", "display_name": "Rachel Gallen", "link": "https://stackoverflow.com/users/1675954/rachel-gallen"}, "edited": false, "score": 0, "creation_date": 1546472022, "post_id": 54014375, "comment_id": 94866241, "body": "Essentially I want to check if there is a &quot;Date&quot; in the D column of my range, which is a single row that has data between the first cell which is in column A and the last cell which is in column S."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1546472641, "post_id": 54014375, "comment_id": 94866368, "body": "The problem is that to Excel, dates are numbers masked in a format that looks like a date.  So if your column also has numbers it will be difficult to separate a date and and a number.  You can use the <code>Range.NumberFormat</code> property in conjunction with IsNumeric() to test and that the value is greater than 0.  If ALL pass then most likely it is a date."}, {"owner": {"reputation": 25691, "user_id": 1675954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zZXdA.jpg?s=128&g=1", "display_name": "Rachel Gallen", "link": "https://stackoverflow.com/users/1675954/rachel-gallen"}, "edited": false, "score": 1, "creation_date": 1546473452, "post_id": 54014375, "comment_id": 94866537, "body": "You could use ISERROR (there&#39;s an example in <a href=\"https://stackoverflow.com/a/49279614/1675954\">this answer</a>  ) . If there&#39;s a possibility of the cell being left empty you could potentially check for null value either..?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1546482515, "post_id": 54014375, "comment_id": 94868204, "body": "It can be hard to tell, for reasons outlined by @ScottCraner. But maybe if you explained <b>why</b> you needdo this, a more appropriate solution can be devised.  Also, what else might be in the cell?"}, {"owner": {"reputation": 646, "user_id": 1442782, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/cd36fc97ddcfb7c102fbb98bfd1cc623?s=128&d=identicon&r=PG", "display_name": "J4C3N-14", "link": "https://stackoverflow.com/users/1442782/j4c3n-14"}, "reply_to_user": {"reputation": 25691, "user_id": 1675954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zZXdA.jpg?s=128&g=1", "display_name": "Rachel Gallen", "link": "https://stackoverflow.com/users/1675954/rachel-gallen"}, "edited": false, "score": 0, "creation_date": 1546502139, "post_id": 54014375, "comment_id": 94872857, "body": "@Rachel Gallen A solution could be to reverse the logic and check to see if the cell is empty, since I don&#39;t want to delete the row if there is a date present. By that logic if there isn&#39;t a date or anything in that cell then its &quot;safe&quot; to delete it."}, {"owner": {"reputation": 25691, "user_id": 1675954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zZXdA.jpg?s=128&g=1", "display_name": "Rachel Gallen", "link": "https://stackoverflow.com/users/1675954/rachel-gallen"}, "edited": false, "score": 0, "creation_date": 1546513269, "post_id": 54014375, "comment_id": 94877885, "body": "@J4C3N-14 that&#39;s what I was suggesting you do (regarding the null value).. only saw your message now."}], "answers": [{"comments": [{"owner": {"reputation": 646, "user_id": 1442782, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/cd36fc97ddcfb7c102fbb98bfd1cc623?s=128&d=identicon&r=PG", "display_name": "J4C3N-14", "link": "https://stackoverflow.com/users/1442782/j4c3n-14"}, "edited": false, "score": 0, "creation_date": 1546502346, "post_id": 54015839, "comment_id": 94872925, "body": "Thanks for your pointers and an example. I do require a button in each row unfortunately. However how you are checking for a date format could be a solution. How best to implement that into my code?"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 646, "user_id": 1442782, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/cd36fc97ddcfb7c102fbb98bfd1cc623?s=128&d=identicon&r=PG", "display_name": "J4C3N-14", "link": "https://stackoverflow.com/users/1442782/j4c3n-14"}, "edited": false, "score": 0, "creation_date": 1546509504, "post_id": 54015839, "comment_id": 94875880, "body": "In your code, &#39;If IsDate <b>in D column of the Range is ture*</b> Then &#39;MsgBox &quot;This Row Contains a Date!&quot; corresponds to my code If IsDate(.Value) Then                     For i = 3 To 1 Step -1                         &#39; check if the Numberformat contains all of &quot;m&quot;, &quot;d&quot; and &quot;y&quot;                         If InStr(1, .NumberFormat, Mid(&quot;dmy&quot;, i, 1), vbTextCompare) = 0 Then Exit For                     Next i                     If i = 0 Then                   &#39; all 3 were found"}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 2, "last_activity_date": 1546485071, "creation_date": 1546485071, "answer_id": 54015839, "question_id": 54014375, "link": "https://stackoverflow.com/questions/54014375/check-if-a-cell-in-a-range-contains-a-date/54015839#54015839", "title": "Check if a Cell in a Range contains a Date", "body": "<p>Here is an idea for your problem. Install the code in the code sheet of the worksheet on which you wish to have the action (not in a standard module like 'Module1' !!) Note that the code reacts to a double-click in column D from row 2 down to the last used row in <strong>column A</strong>. You can adjust that. Follow the directions in the code itself. I use this method instead of the button you seem to have in every row of your sheet - a matter of preference, but used here for demonstration and to avoid creating buttons.</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    ' 03 Jan 2019\n\n    Dim Rng As Range\n    Dim R As Long\n    Dim Cell As Range\n    Dim i As Integer\n\n    R = Cells(Rows.Count, \"A\").End(xlUp).Row        ' last used row in column A\n    Set Rng = Range(Cells(2, 4), Cells(R, 4))       ' used range in column D\n\n    If Not Application.Intersect(Target, Rng) Is Nothing Then\n        ' if a cell in Rng as double-clicked:-\n        R = Target.Row\n        Set Rng = Range(Cells(R, \"A\"), Cells(R, \"S\"))\n        For Each Cell In Rng\n            With Cell\n                If IsDate(.Value) Then\n                    For i = 3 To 1 Step -1\n                        ' check if the Numberformat contains all of \"m\", \"d\" and \"y\"\n                        If InStr(1, .NumberFormat, Mid(\"dmy\", i, 1), vbTextCompare) = 0 Then Exit For\n                    Next i\n                    If i = 0 Then                   ' all 3 were found\n                        If MsgBox(\"Do you want to delete row \" &amp; R &amp; \" ?\", _\n                                  vbQuestion Or vbYesNo, _\n                                  \"Click \"\"No\"\" to keep the row\") = vbYes Then\n                            Rows(R).Delete\n                        End If\n                        Exit For\n                    End If\n                End If\n            End With\n        Next Cell\n        Cancel = True                               ' ends in-cell editing\n    End If\nEnd Sub\n</code></pre>\n\n<p>The code carries out two checks on each cell (A:S). It first checks if its value is a date. Then, presuming it is a number, it checks the cell format. If the NumberFormat includes all of the letters 'm\", \"d\" and \"y\" it is confirmed as a date and released for deletion before which the user can confirm his intention.\nThis method may require a little fine tuning. Firstly, if the cell has text date a different second check would have to be carried out. Second, if the date format consists of only 2 of the 3 criteria the test for their presence in the mask must be reduced accordingly. Either of these modifications, or both, could be implemented once the nature of your data is better understood.</p>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 1, "last_activity_date": 1546506140, "creation_date": 1546506140, "answer_id": 54019098, "question_id": 54014375, "link": "https://stackoverflow.com/questions/54014375/check-if-a-cell-in-a-range-contains-a-date/54019098#54019098", "title": "Check if a Cell in a Range contains a Date", "body": "<p>@J4C3N-14 did you try:</p>\n\n<pre><code>Sub Test_Date()\n\n    Dim strDate As String\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        strDate = .Range(\"A1\").Value\n\n        If IsDate(strDate) Then\n            'Code\n        End If\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 646, "user_id": 1442782, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/cd36fc97ddcfb7c102fbb98bfd1cc623?s=128&d=identicon&r=PG", "display_name": "J4C3N-14", "link": "https://stackoverflow.com/users/1442782/j4c3n-14"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1119, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1566195399, "creation_date": 1546470700, "last_edit_date": 1566195399, "question_id": 54014375, "link": "https://stackoverflow.com/questions/54014375/check-if-a-cell-in-a-range-contains-a-date", "title": "Check if a Cell in a Range contains a Date", "body": "<p>I would like to determine if a cell in my range contains a date (any date) and if it does to exit the sub with a message.\nThe date format looks like this: dd-mmm-yy but is generated by a formula within the cell.</p>\n\n<p>Here is some of my code already written along with some pseudo code of what I want to achieve.</p>\n\n<pre><code>Sub RemoveRowButton()\n'This Macro deletes a row where the button is clicked.\n'Variables\nDim row As Long\nDim varResponse As Variant\n\nApplication.ScreenUpdating = False\n\n\n\n'Message box confirming user is doing the right thing\nvarResponse = MsgBox(\"Delete this row? 'Yes' or 'No'\", vbYesNo, \"Delete Row\")\n    If varResponse &lt;&gt; vbYes Then Exit Sub\n\n'Carry on with deleting row.....\n\nSet rng = ActiveSheet.Buttons(Application.Caller).TopLeftCell.EntireRow\n\n\n*******Pseudo Code *******\n'Check if the row to be deleted has a date in the D Column of the range (which is a Row)\n\n'If IsDate **in D column of the Range is ture*** Then\n'MsgBox \"This Row Contains a Date!\"\n'End If\n\n\n'Unprotect sheet\nActiveSheet.Unprotect Password:=\"***\"\n\n'Delete row on button row\nrng.Delete\n\n'Protect sheet again\n ActiveSheet.Protect Password:=\"***\"\n\nEnd Sub\n</code></pre>\n\n<p>If you could explain your code/answers too I would be grateful, Thanks.</p>\n\n<p>EDIT:</p>\n\n<p>Thank you for all the help, I have, through trial and error created this which works for me.</p>\n\n<pre><code> Set rng2 = rng.Cells(, 4)\n   If IsDate(rng2.Value) Then 'Check Cell for Date\n     MsgBox \"Warning: This Row Cannot be deleted!\"\n   Exit Sub\n   End If\n</code></pre>\n\n<p>Since I am unfamiliar with VBA I do not know if this is \"OKAY\" in the sense of best practices. If not and you feel like correcting it please do so.</p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10860053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e220dc42daa3c9fe027c0b7edd71bf9a?s=128&d=identicon&r=PG&f=1", "display_name": "YellowPanther", "link": "https://stackoverflow.com/users/10860053/yellowpanther"}, "edited": false, "score": 0, "creation_date": 1546521397, "post_id": 54016333, "comment_id": 94882172, "body": "I applied the above code and made the adjustment. Here is how I currently have it."}, {"owner": {"reputation": 1, "user_id": 10860053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e220dc42daa3c9fe027c0b7edd71bf9a?s=128&d=identicon&r=PG&f=1", "display_name": "YellowPanther", "link": "https://stackoverflow.com/users/10860053/yellowpanther"}, "edited": false, "score": 0, "creation_date": 1546521785, "post_id": 54016333, "comment_id": 94882396, "body": "Sorry, New to the site, didn&#39;t know about the 5 minute update rule here.   Thank you for your input. This comes back with a Run-time Error &#39;424&#39;: Object required message.   The desk number is in Column A row 5 only for Sheet1 (Update) and Column A Row 3:1009 for Sheet2 (Floor). I have also change s1.Range(&quot;B&quot;....to s1.Range (&quot;A&quot;....along with Row start/end to 1/17 (A:Q)."}, {"owner": {"reputation": 266, "user_id": 10860682, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1p8ShEHvmxM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYrC6ksVVo648mB97KGqwtUjVNJrA/mo/photo.jpg?sz=128", "display_name": "RCL", "link": "https://stackoverflow.com/users/10860682/rcl"}, "reply_to_user": {"reputation": 1, "user_id": 10860053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e220dc42daa3c9fe027c0b7edd71bf9a?s=128&d=identicon&r=PG&f=1", "display_name": "YellowPanther", "link": "https://stackoverflow.com/users/10860053/yellowpanther"}, "edited": false, "score": 0, "creation_date": 1546552691, "post_id": 54016333, "comment_id": 94897078, "body": "Hi if your Column A row starts at 5 then your rowstart for sheet1 should start at 5 also. I won&#39;t be able to troubleshoot the Error without seeing your full code. If you copy and paste the code above without replacing anything it returns an error for you?"}, {"owner": {"reputation": 1, "user_id": 10860053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e220dc42daa3c9fe027c0b7edd71bf9a?s=128&d=identicon&r=PG&f=1", "display_name": "YellowPanther", "link": "https://stackoverflow.com/users/10860053/yellowpanther"}, "edited": false, "score": 0, "creation_date": 1546613197, "post_id": 54016333, "comment_id": 94917211, "body": "Yes, Thank you so very much. I miss read the code at first but now I have it working. Thanks again. Super helpful."}, {"owner": {"reputation": 266, "user_id": 10860682, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1p8ShEHvmxM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYrC6ksVVo648mB97KGqwtUjVNJrA/mo/photo.jpg?sz=128", "display_name": "RCL", "link": "https://stackoverflow.com/users/10860682/rcl"}, "reply_to_user": {"reputation": 1, "user_id": 10860053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e220dc42daa3c9fe027c0b7edd71bf9a?s=128&d=identicon&r=PG&f=1", "display_name": "YellowPanther", "link": "https://stackoverflow.com/users/10860053/yellowpanther"}, "edited": false, "score": 0, "creation_date": 1546648160, "post_id": 54016333, "comment_id": 94931126, "body": "Happy to help, and welcome to Stack Overflow. If this answer or any other one solved your issue, please mark it as accepted."}], "tags": [], "owner": {"reputation": 266, "user_id": 10860682, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1p8ShEHvmxM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYrC6ksVVo648mB97KGqwtUjVNJrA/mo/photo.jpg?sz=128", "display_name": "RCL", "link": "https://stackoverflow.com/users/10860682/rcl"}, "is_accepted": false, "score": 0, "last_activity_date": 1546489512, "creation_date": 1546489512, "answer_id": 54016333, "question_id": 54014243, "link": "https://stackoverflow.com/questions/54014243/activex-button-to-copy-a-row-of-data-from-sheet-1-to-sheet-2-based-off-cell-valu/54016333#54016333", "title": "activeX button to copy a row of data from sheet 1 to Sheet 2 based off cell value", "body": "<p>Something like the code below? I assumed the desk number are on column A sheet1 starting at row 2. You will need to adjust the end rows for both sheet though.</p>\n\n<pre><code>Sub MoveRowBasedOnCellValue()\nDim s1 As Sheet1\nSet s1 = Sheet1\nDim s2 As Sheet2\nSet s2 = Sheet2\nDim s1StartRow As Integer\nDim s1EndRow As Integer\nDim s2StartRow As Integer\nDim s2EndRow As Integer\ns1StartRow = 2\ns1EndRow = 8\ns2StartRow = 2\ns2EndRow = 10\n\n\nApplication.ScreenUpdating = False\nFor i = s1StartRow To s1EndRow\n\n For j = s2StartRow To s2EndRow\n\n   If s1.Cells(i, 1) = s2.Cells(j, 1) Then\n    s1.Range(\"B\" &amp; i &amp; \":Q\" &amp; i).Copy\n    s2.Cells(j, 2).PasteSpecial xlPasteAll\n   Application.CutCopyMode = False\n   End If\n\n  Next j\n\nNext i\n Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10860053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e220dc42daa3c9fe027c0b7edd71bf9a?s=128&d=identicon&r=PG&f=1", "display_name": "YellowPanther", "link": "https://stackoverflow.com/users/10860053/yellowpanther"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1546489512, "creation_date": 1546469693, "last_edit_date": 1546470297, "question_id": 54014243, "link": "https://stackoverflow.com/questions/54014243/activex-button-to-copy-a-row-of-data-from-sheet-1-to-sheet-2-based-off-cell-valu", "title": "activeX button to copy a row of data from sheet 1 to Sheet 2 based off cell value", "body": "<p>I am new to stackoverflow.com and VBA. I have been searching the web for a VBA that will allow me to copy data from sheet 1 that I input and then paste into sheet 2 based off the a cell value match. Once it is copied, it would then clear the data on Sheet 1 without delete the rows.</p>\n\n<p>I work in a call center, and this would be to update equipment based on the desk it is located at. </p>\n\n<p>So I am hoping that once I input all the data into the fields on sheet 1, I can click an activex button and it will search for the desk number on sheet 2 in column A and then update the row (B:Q) with the data from sheet 1. </p>\n\n<p>I have seen some VBA that will copy the data but it only copies to the next empty row of cells. </p>\n\n<p>Here is the code that I have found but is just not right. </p>\n\n<pre><code>Sub MoveRowBasedOnCellValue()\n    Dim xRg As Range\n    Dim xCell As Range\n    Dim I As Long\n    Dim J As Long\n    Dim K As Long\n    I = Worksheets(\"Sheet1\").UsedRange.Rows.Count\n    J = Worksheets(\"Sheet2\").UsedRange.Rows.Count\n    If J = 1 Then\n    If Application.WorksheetFunction.CountA(Worksheets(\"Sheet2\").UsedRange) = 0 Then J = 0\n    End If\n    Set xRg = Worksheets(\"Sheet1\").Range(\"A5:Q5\" &amp; I)\n    On Error Resume Next\n    Application.ScreenUpdating = False\n    For K = 1 To xRg.Count\n        If CStr(xRg(K).Value) = (\"A5\") Then\n            xRg(K).EntireRow.Copy Destination:=Worksheets(\"Sheet2\").Range(\"A\" &amp; J + 1)\n            J = J + 1\n        End If\n    Next\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Any help would be great!\nThanks.</p>\n"}, {"tags": ["vba", "ini"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1546471615, "post_id": 54014031, "comment_id": 94866125, "body": "<a href=\"https://stackoverflow.com/questions/29192203/how-to-read-multiline-values-in-inifile\" title=\"how to read multiline values in inifile\">stackoverflow.com/questions/29192203/&hellip;</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1546471668, "post_id": 54014031, "comment_id": 94866144, "body": "<a href=\"http://www.vbforums.com/showthread.php?662259-RESOLVED-Reading-multiple-values-from-a-single-key-in-an-ini-file\" rel=\"nofollow noreferrer\">vbforums.com/&hellip;</a>"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1546473005, "post_id": 54014031, "comment_id": 94866445, "body": "That&#39;s not how INI files work. They&#39;re designed to have name=value pairs. The typical way to do this is to have an initial entry like <code>PriceValues=3</code>, followed by <code>PriceValue1=xxx,xxx</code>, <code>PriceValue2=yyy,yyy</code>, <code>PriceValue3=zzz,zzz</code>. You can then read them in a loop using that numeric value. The alternative is to use your own separator, read a single value, and parse it based on that separator using Split() or your own code. If neither of those work, then use another format for storing your data."}], "owner": {"reputation": 1, "user_id": 10859990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8a8e24cd8e80920e4fa1237d2a99fa5?s=128&d=identicon&r=PG&f=1", "display_name": "user10859990", "link": "https://stackoverflow.com/users/10859990/user10859990"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 643, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1546471354, "creation_date": 1546468345, "last_edit_date": 1546471354, "question_id": 54014031, "link": "https://stackoverflow.com/questions/54014031/what-is-the-format-to-write-multiple-values-to-a-single-key-in-ini-file-what-i", "title": "What is the format to write multiple values to a single key in .INI file, what is the read statement in VBA to read all values of key in INI file?", "body": "<p>I am working on a VBA application. I wanted to add multiple values to as single key in .INI file and change the VBA code to read all the values.</p>\n\n<p>The current .INI text file has only one value per a key. I wanted to add multiple values to an individual key. What is the format to achieve it?</p>\n\n<p>Secondly, the current VBA code is processing only the first value (I tried to add multiple values to a single key but not sure whether I wrote in correct format. So, that is my first question). I would like to know the read statement which reads all the values associated with key?</p>\n\n<p>Key, value statement in .INI file:\nPRICEScreenAllow=xxxx</p>\n\n<p>Current VBA code:</p>\n\n<pre><code>PriceScreenID = bafGetINIString$(\"OSCAR\", \"PRICEScreenAllow\", \"\", gstrINIFile)\n</code></pre>\n\n<p>I have tried to run the current VBA code by adding multiple values in different formats mentioned below and had no luck</p>\n\n<ol>\n<li>PRICEScreenAllow=xxxx, xxxx</li>\n<li>PRICEScreenAllow=[xxxx, xxxx]</li>\n<li>PRICEScreenAllow=(xxxx, xxxx)</li>\n</ol>\n\n<p>Key, value statement in .INI file:</p>\n\n<pre><code>PRICEScreenAllow=xxxx\n</code></pre>\n\n<p>Current VBA code:</p>\n\n<pre><code>PriceScreenID = bafGetINIString$(\"OSCAR\", \"PRICEScreenAllow\", \"\", gstrINIFile)\n</code></pre>\n\n<p>I should be able to add multiple values to a single key and all the values should be processed successfully with VBA code.</p>\n"}, {"tags": ["excel", "vba", "voip", "sendkeys"], "answers": [{"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 1, "last_activity_date": 1546470834, "creation_date": 1546470834, "answer_id": 54014393, "question_id": 54013974, "link": "https://stackoverflow.com/questions/54013974/excel-macro-to-run-keyboard-shortcut-for-voip-software/54014393#54014393", "title": "Excel - Macro to run keyboard shortcut for VOIP software", "body": "<p>Try this:</p>\n\n<p><code>Application.SendKeys (\"^+C\")</code></p>\n"}], "owner": {"reputation": 169, "user_id": 2203930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ece714a706ba754910b5ffe694e0ef79?s=128&d=identicon&r=PG", "display_name": "Exhausted", "link": "https://stackoverflow.com/users/2203930/exhausted"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 54014393, "answer_count": 1, "score": 0, "last_activity_date": 1546470858, "creation_date": 1546467980, "last_edit_date": 1546470858, "question_id": 54013974, "link": "https://stackoverflow.com/questions/54013974/excel-macro-to-run-keyboard-shortcut-for-voip-software", "title": "Excel - Macro to run keyboard shortcut for VOIP software", "body": "<p>I have an excel spreadsheet with a list of 100 telephone numbers. </p>\n\n<p>I use VOIP software on my PC to make calls and a keyboard shortcut of <kbd>CTRL</kbd>,<kbd>SHIFT</kbd><kbd>C</kbd> will automatically place a call. The VOIP software takes the telephone number from my spreadsheet using what ever cell I have selected.</p>\n\n<p>I would like to make a \"CALL\" button in excel so when a cell is hi-lighted &amp; the call button is pressed a macro runs <kbd>CTRL</kbd><kbd>SHIFT</kbd><kbd>C</kbd>.</p>\n\n<p>Any help or thoughts on this would be greatly appreciated. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 533, "user_id": 3368958, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mfVLE.jpg?s=128&g=1", "display_name": "Nelda.techspiress", "link": "https://stackoverflow.com/users/3368958/nelda-techspiress"}, "edited": false, "score": 0, "creation_date": 1546463434, "post_id": 54013203, "comment_id": 94863333, "body": "This will only work if my specified range begins in row 1 of my worksheet. Range is a subset of the worksheet and can begin anywhere. I have a worksheet with 756 rows only 754 of which are relevant. But I want to refer to the last row in the original worksheet which could be Count + or - some unknown amount."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 533, "user_id": 3368958, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mfVLE.jpg?s=128&g=1", "display_name": "Nelda.techspiress", "link": "https://stackoverflow.com/users/3368958/nelda-techspiress"}, "edited": false, "score": 3, "creation_date": 1546463508, "post_id": 54013203, "comment_id": 94863371, "body": "@Nelda.techspiress: Why don&#39;t you try it?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 533, "user_id": 3368958, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mfVLE.jpg?s=128&g=1", "display_name": "Nelda.techspiress", "link": "https://stackoverflow.com/users/3368958/nelda-techspiress"}, "edited": false, "score": 0, "creation_date": 1546463563, "post_id": 54013203, "comment_id": 94863395, "body": "@Nelda.techspiress no, it will work with what ever row it is on.  in your example <code>transactionsDataRange.Row</code> will return <code>3</code> and <code>transactionsDataRange.Rows.Count</code> will return <code>754</code> or the number of rows in the range so the math is <code>3+754-1</code> which is <code>756</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 533, "user_id": 3368958, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mfVLE.jpg?s=128&g=1", "display_name": "Nelda.techspiress", "link": "https://stackoverflow.com/users/3368958/nelda-techspiress"}, "edited": false, "score": 0, "creation_date": 1546463919, "post_id": 54013203, "comment_id": 94863529, "body": "@Nelda.techspiress have you tried the exact formula I gave.  It will return 756 as it adds the start row of the range to the row count and subtracts <code>1</code> it will work no matter where the range starts."}, {"owner": {"reputation": 533, "user_id": 3368958, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mfVLE.jpg?s=128&g=1", "display_name": "Nelda.techspiress", "link": "https://stackoverflow.com/users/3368958/nelda-techspiress"}, "edited": false, "score": 0, "creation_date": 1546468561, "post_id": 54013203, "comment_id": 94865275, "body": "Yes, this worked after I typed it in correctly. But I was looking for a property that explicitly worked with the given range without any calculation being performed, which is why I accepted SJR&#39;s answer."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 533, "user_id": 3368958, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mfVLE.jpg?s=128&g=1", "display_name": "Nelda.techspiress", "link": "https://stackoverflow.com/users/3368958/nelda-techspiress"}, "edited": false, "score": 1, "creation_date": 1546468710, "post_id": 54013203, "comment_id": 94865316, "body": "@Nelda.techspiress I have no problem with you choosing the other answer, just wanted to ensure that you saw that this worked.  I would have chosen the other also."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 2, "last_activity_date": 1546464279, "last_edit_date": 1546464279, "creation_date": 1546463271, "answer_id": 54013203, "question_id": 54013181, "link": "https://stackoverflow.com/questions/54013181/get-last-row-of-specified-range-in-excel/54013203#54013203", "title": "Get last row of specified range in Excel", "body": "<p>Use</p>\n\n<pre><code>Dim LstRow as Long\nLstRow = transactionsDataRange.Row + transactionsDataRange.Rows.Count - 1\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/IhJWm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IhJWm.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1546464276, "post_id": 54013222, "comment_id": 94863682, "body": "Thanks for accepting the answer, but Scott&#39;s does work."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 4, "last_activity_date": 1546463355, "creation_date": 1546463355, "answer_id": 54013222, "question_id": 54013181, "link": "https://stackoverflow.com/questions/54013181/get-last-row-of-specified-range-in-excel/54013222#54013222", "title": "Get last row of specified range in Excel", "body": "<p>An alternative approach</p>\n\n<pre><code>Sub x()\n\nDim transactionsDataRange As Range\n\nSet transactionsDataRange = Range(\"$A$3:$AP$756\")\n\nMsgBox transactionsDataRange.Rows(transactionsDataRange.Rows.Count).Row\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1546463670, "creation_date": 1546463670, "answer_id": 54013281, "question_id": 54013181, "link": "https://stackoverflow.com/questions/54013181/get-last-row-of-specified-range-in-excel/54013281#54013281", "title": "Get last row of specified range in Excel", "body": "<pre><code>Sub TestMe()        \n    Dim myRange As Range\n    Set myRange = Worksheets(1).Range(\"D10:D15\")\n    Debug.Print myRange.Rows.Count + myRange.Row - 1        \nEnd Sub\n</code></pre>\n\n<p>It prints 15. <code>myRange.Rows.Count</code> is 6 and <code>myRange.Row</code> is 10. Or if you like 1-line-functions, this could be ok:</p>\n\n<pre><code>Sub TestMe()\n    Debug.Print LastRowOfRange(Range(\"D15:E199\"))\nEnd Sub\n\nFunction LastRowOfRange(myRange) As Long\n    LastRowOfRange = myRange.Rows.Count + myRange.Row - 1\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1546480534, "creation_date": 1546480534, "answer_id": 54015427, "question_id": 54013181, "link": "https://stackoverflow.com/questions/54013181/get-last-row-of-specified-range-in-excel/54015427#54015427", "title": "Get last row of specified range in Excel", "body": "<p>Specifies the last cell in the range.</p>\n\n<pre><code>Sub test()\n    Dim transactionsDataRange As Range\n    Dim rngT As Range\n\n    Set transactionsDataRange = Range(\"$A$3:$AP$756\")\n    With transactionsDataRange\n        Set rngT = .Cells(.Rows.Count, .Columns.Count)\n    End With\n    MsgBox rngT.Row\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 533, "user_id": 3368958, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mfVLE.jpg?s=128&g=1", "display_name": "Nelda.techspiress", "link": "https://stackoverflow.com/users/3368958/nelda-techspiress"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "accepted_answer_id": 54013222, "answer_count": 4, "score": 0, "last_activity_date": 1566195410, "creation_date": 1546463179, "last_edit_date": 1566195410, "question_id": 54013181, "link": "https://stackoverflow.com/questions/54013181/get-last-row-of-specified-range-in-excel", "title": "Get last row of specified range in Excel", "body": "<p>How do I get the last row of a range that has already been specified and defined and is known to contain the data I want? It seems to me this should be a property of some sort like <code>Range.Row</code> but <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.row\" rel=\"nofollow noreferrer\">Range.Row</a> gives the <strong>first</strong> row number in the range and I want the <strong><em>last</em></strong> row number. </p>\n\n<p>Now the problem is my range doesn't begin in row 1 of the source sheet - it actually begins in row 3 and goes through row 756. Below is the address of my range as viewed by the debugger and it is defined correctly. But since it begins at row 3 using <code>Rows.Count</code> will not work, since it results in 754 instead of 756. </p>\n\n<p><code>Rows.Count</code> is a reference to the range which is a subset of the original sheet. I want the row number of the last row from the original spreadsheet, exactly as it is in the address below. In other words is there some property on Address that will give me the 756?</p>\n\n<pre><code>transData = transactionsDataRange.Address\n\n: transData : \"$A$3:$AP$756\" : Variant/String\n</code></pre>\n\n<p>The address presented in the debugger is correct. All that I want is to extract the row value of the lower right cell in the specified range which would be 756. I can parse the address value and will do that if necessary, but I'm wondering if Excel VBA has a simpler way of achieving this?</p>\n"}, {"tags": ["excel", "vba", "user-defined-functions"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1546462156, "post_id": 54012891, "comment_id": 94862823, "body": "Can you please <a href=\"https://stackoverflow.com/posts/54012891/edit\">edit your question</a> to give us sample data?"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1546462289, "post_id": 54012891, "comment_id": 94862874, "body": "I cannot reproduce your issue. Do you mean &quot;current AND one of the numbers&quot; or &quot;current OR either of the numbers&quot;? Your logic is not clear. Also, <code>(2)</code> can be notation for <code>-2</code>, so depending on you cell contents it could be a number, not text. A data sample and/or a screenshot would help."}, {"owner": {"reputation": 637, "user_id": 9392446, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kz7uaHNd-ms/AAAAAAAAAAI/AAAAAAAAAdg/qkUWGoXGcTo/photo.jpg?sz=128", "display_name": "max", "link": "https://stackoverflow.com/users/9392446/max"}, "edited": false, "score": 0, "creation_date": 1546463099, "post_id": 54012891, "comment_id": 94863205, "body": "<i>Added a sample table screenshot</i>"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1546463128, "post_id": 54012891, "comment_id": 94863218, "body": "Use regex and UDF."}], "answers": [{"comments": [{"owner": {"reputation": 637, "user_id": 9392446, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kz7uaHNd-ms/AAAAAAAAAAI/AAAAAAAAAdg/qkUWGoXGcTo/photo.jpg?sz=128", "display_name": "max", "link": "https://stackoverflow.com/users/9392446/max"}, "edited": false, "score": 0, "creation_date": 1546463650, "post_id": 54013204, "comment_id": 94863427, "body": "Holy cow that&#39;s a cool formula. That works darn well. It should capture everything I&#39;m looking for. Thank ya man!"}, {"owner": {"reputation": 637, "user_id": 9392446, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kz7uaHNd-ms/AAAAAAAAAAI/AAAAAAAAAdg/qkUWGoXGcTo/photo.jpg?sz=128", "display_name": "max", "link": "https://stackoverflow.com/users/9392446/max"}, "edited": false, "score": 0, "creation_date": 1546466733, "post_id": 54013204, "comment_id": 94864613, "body": "Update on this - it looks like it works when current and (1) are in different strings but not if they&#39;re in the same string; example: if(string.tolower.current.accountemail(1)&quot; this returns false. Trying to use the macro code now"}], "tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": false, "score": 2, "last_activity_date": 1546463274, "creation_date": 1546463274, "answer_id": 54013204, "question_id": 54012891, "link": "https://stackoverflow.com/questions/54012891/how-to-find-a-cell-that-contains-parenthesis-around-a-number-e-g-1/54013204#54013204", "title": "How to find a cell that contains parenthesis around a number - e.g. (1)", "body": "<p>If you really don't want to follow @Andreas suggestion (which is another way of saying \"why didn't I think of that\"), try:</p>\n\n<pre><code>=IFERROR(IF(FIND(\"current\",A3)&gt;0,CONCATENATE(\"within \", CHOOSE(VALUE(MID(A3,FIND(\"(\",A3)+1,1)),5,10,15,20,25,30), \" minutes\"),),FALSE)\n</code></pre>\n\n<p>Caveat: it ignores the closing parenthesis, so <code>this cell contains current and (1</code> would not return \"FALSE\"</p>\n"}, {"comments": [{"owner": {"reputation": 637, "user_id": 9392446, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kz7uaHNd-ms/AAAAAAAAAAI/AAAAAAAAAdg/qkUWGoXGcTo/photo.jpg?sz=128", "display_name": "max", "link": "https://stackoverflow.com/users/9392446/max"}, "edited": false, "score": 0, "creation_date": 1546467203, "post_id": 54013279, "comment_id": 94864792, "body": "Same issue from @cybernetic.nomad solution - at least this is all i can think of as to why it doesn&#39;t work: &quot;current&quot; and &quot;(1)&quot; are in the same string: &quot;if(string.tolower.current.accountemail(1)&quot;"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 637, "user_id": 9392446, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kz7uaHNd-ms/AAAAAAAAAAI/AAAAAAAAAdg/qkUWGoXGcTo/photo.jpg?sz=128", "display_name": "max", "link": "https://stackoverflow.com/users/9392446/max"}, "edited": false, "score": 0, "creation_date": 1546467367, "post_id": 54013279, "comment_id": 94864846, "body": "@max I see no reason why it would fail on that string. Although I have not even tried the code since I posted it from my phone. I will try it on my computer soon. Give me a few minutes."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 637, "user_id": 9392446, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kz7uaHNd-ms/AAAAAAAAAAI/AAAAAAAAAdg/qkUWGoXGcTo/photo.jpg?sz=128", "display_name": "max", "link": "https://stackoverflow.com/users/9392446/max"}, "edited": false, "score": 0, "creation_date": 1546467697, "post_id": 54013279, "comment_id": 94864971, "body": "@max I see it now, without starting the computer. You said in question <code>current and ([number])</code>. Your string has no <code>and</code>. Is that not required? Do you mean <code>current</code> and <code>([number])</code>?"}, {"owner": {"reputation": 637, "user_id": 9392446, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kz7uaHNd-ms/AAAAAAAAAAI/AAAAAAAAAdg/qkUWGoXGcTo/photo.jpg?sz=128", "display_name": "max", "link": "https://stackoverflow.com/users/9392446/max"}, "edited": false, "score": 0, "creation_date": 1546469611, "post_id": 54013279, "comment_id": 94865562, "body": "Yes! no and is required"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 637, "user_id": 9392446, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kz7uaHNd-ms/AAAAAAAAAAI/AAAAAAAAAdg/qkUWGoXGcTo/photo.jpg?sz=128", "display_name": "max", "link": "https://stackoverflow.com/users/9392446/max"}, "edited": false, "score": 0, "creation_date": 1546469947, "post_id": 54013279, "comment_id": 94865664, "body": "@max then try the last code I added. If it doesn&#39;t work I will fix it tomorrow, I&#39;m in bed now."}], "tags": [], "owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "is_accepted": true, "score": 2, "last_activity_date": 1546468078, "last_edit_date": 1546468078, "creation_date": 1546463664, "answer_id": 54013279, "question_id": 54012891, "link": "https://stackoverflow.com/questions/54012891/how-to-find-a-cell-that-contains-parenthesis-around-a-number-e-g-1/54013279#54013279", "title": "How to find a cell that contains parenthesis around a number - e.g. (1)", "body": "<p>If VBA and UDF is ok then I advice you to use regex.  </p>\n\n<p>Open VBA editor (ALT +F11) and add a module.</p>\n\n<p>Paste the following code and save the Excel workbook as macroactivated workbook (xlsm).</p>\n\n<pre><code>Function Regex(Cell)\n    Dim RE As Object\n\n    Set RE = CreateObject(\"vbscript.regexp\")\n\n    RE.Pattern = \".*(current and \\(\\d+\\))\"\n    ' or if you want to match optional ()\n    'RE.Pattern = \".*(current and \\(?\\d+\\)?)\"\n    RE.Global = True\n    RE.IgnoreCase = True\n    Set Matches = RE.Execute(Cell)\n\n    If Matches.Count &lt;&gt; 0 Then\n        Regex = Matches.Item(0).submatches.Item(0)\n    End If\n\nEnd Function\n</code></pre>\n\n<p>Use it as a formula like:</p>\n\n<pre><code>=Regex(A1)\n</code></pre>\n\n<p>It will return the part it's looking for <code>current and [number]</code></p>\n\n<p>The return of the code can of course be whatever you want.<br>\nBut I don't understand the logic in your question that is why I return what it is looking for </p>\n\n<p><Hr></p>\n\n<p>I see now the logic.</p>\n\n<p>This will return the output as you expect.</p>\n\n<pre><code>Function Regex(Cell)\n    Dim RE As Object\n\n    Set RE = CreateObject(\"vbscript.regexp\")\n\n    RE.Pattern = \".*current and \\((\\d+)\\)\"\n    ' or if you want to match optional ()\n    'RE.Pattern = \".*current and \\(?(\\d+)\\)?\"\n    RE.Global = True\n    RE.IgnoreCase = True\n    Set Matches = RE.Execute(Cell)\n\n    If Matches.Count &lt;&gt; 0 Then\n        Regex = \"within \" &amp; Matches.Item(0).submatches.Item(0)*5 &amp; \" minutes\"\n    Else\n        Regex = \"False\"\n    End If\n\nEnd Function\n</code></pre>\n\n<p>It multiplies the captured number with 5 to get the number of minutes.<br>\nIf nothing is found then it returns <code>False</code>.</p>\n\n<p>VBA and regex generally means the code in the worksheet is easier to maintain and easier to debug.  </p>\n\n<p><Hr></p>\n\n<p>In order to make it react to the string with <code>current</code> and <code>(number)</code> then use this code:</p>\n\n<pre><code>Function Regex(Cell)\n    Dim RE As Object\n\n    Set RE = CreateObject(\"vbscript.regexp\")\n\n    RE.Pattern = \".*current.*?\\((\\d+)\\)\"\n    RE.Global = True\n    RE.IgnoreCase = True\n    Set Matches = RE.Execute(Cell)\n\n    If Matches.Count &lt;&gt; 0 Then\n        Regex = \"within \" &amp; Matches.Item(0).submatches.Item(0)*5 &amp; \" minutes\"\n    Else\n        Regex = \"False\"\n    End If\n\nEnd Function\n</code></pre>\n\n<p>This code will look for <code>[anything]</code> <code>current</code> <code>[anything]</code> <code>([number])</code></p>\n"}], "owner": {"reputation": 637, "user_id": 9392446, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kz7uaHNd-ms/AAAAAAAAAAI/AAAAAAAAAdg/qkUWGoXGcTo/photo.jpg?sz=128", "display_name": "max", "link": "https://stackoverflow.com/users/9392446/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 54013279, "answer_count": 2, "score": 1, "last_activity_date": 1566195418, "creation_date": 1546461736, "last_edit_date": 1566195418, "question_id": 54012891, "link": "https://stackoverflow.com/questions/54012891/how-to-find-a-cell-that-contains-parenthesis-around-a-number-e-g-1", "title": "How to find a cell that contains parenthesis around a number - e.g. (1)", "body": "<p>The formula I'm using is:</p>\n\n<pre><code>=IF(SUM(COUNTIF(K6,\"*\"&amp;{\"current\",\"(1)\"}&amp;\"*\")),\"within 5 minutes\",\nIF(SUM(COUNTIF(K6,\"*\"&amp;{\"current\",\"(2)\"}&amp;\"*\")),\"within 10 minutes\",\nIF(SUM(COUNTIF(K6,\"*\"&amp;{\"current\",\"(3)\"}&amp;\"*\")),\"within 15 minutes\",\nIF(SUM(COUNTIF(K6,\"*\"&amp;{\"current\",\"(4)\"}&amp;\"*\")),\"within 20 minutes\",\nIF(SUM(COUNTIF(K6,\"*\"&amp;{\"current\",\"(5)\"}&amp;\"*\")),\"within 25 minutes\",\nIF(SUM(COUNTIF(K6,\"*\"&amp;{\"current\",\"(6)\"}&amp;\"*\")),\"within 30 minutes\"))))))\n</code></pre>\n\n<p>The output is pulling any cell that contains both <code>current</code> and <code>1</code>/<code>2</code>/<code>3</code> etc. </p>\n\n<p>I need it to pull only cells that contain <code>current</code> and <code>(1)</code>/<code>(2)</code>/<code>(3)</code> etc. </p>\n\n<hr>\n\n<p>Hoping there's an easy way to make sure the formula includes parentheses!</p>\n\n<hr>\n\n<p><strong>Here's an example screenshot of the expected outcome:</strong>\n<a href=\"https://i.stack.imgur.com/CWcTQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CWcTQ.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "edited": false, "score": 1, "creation_date": 1546463224, "post_id": 54012851, "comment_id": 94863255, "body": "Can you sort the data, such that <code>YES</code> appears first? If not, you may need to have two loop&#39;s (one for <code>NO</code>, one for <code>YES</code>) in conjunction with some sort of early exit condition or Boolean flag to indicate whether a match was found for <code>YES</code>? Hope that makes sense."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 1, "creation_date": 1546464187, "post_id": 54012851, "comment_id": 94863648, "body": "Put it in a dictionary and check whether or not it exists when you need."}, {"owner": {"reputation": 103, "user_id": 10327178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d795576bc6af57a1b001634ff9750aff?s=128&d=identicon&r=PG&f=1", "display_name": "Piccinin", "link": "https://stackoverflow.com/users/10327178/piccinin"}, "edited": false, "score": 0, "creation_date": 1546464346, "post_id": 54012851, "comment_id": 94863703, "body": "I think the sorting should help. Let me try and get back to you. And if that doesn&#39;t work, i will check the dictionary part"}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 10327178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d795576bc6af57a1b001634ff9750aff?s=128&d=identicon&r=PG&f=1", "display_name": "Piccinin", "link": "https://stackoverflow.com/users/10327178/piccinin"}, "edited": false, "score": 0, "creation_date": 1546556466, "post_id": 54019828, "comment_id": 94898299, "body": "Sorting seemed to solve the problem but i will try using your logic as well. So if i have a specific set of instructions for when it says yes, i can just write below Appears=False?"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 103, "user_id": 10327178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d795576bc6af57a1b001634ff9750aff?s=128&d=identicon&r=PG&f=1", "display_name": "Piccinin", "link": "https://stackoverflow.com/users/10327178/piccinin"}, "edited": false, "score": 0, "creation_date": 1546586259, "post_id": 54019828, "comment_id": 94904642, "body": "Yes. When is &quot;YES&quot;, Appears=False in order to set boolean to it s initial form."}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 1, "last_activity_date": 1546509068, "creation_date": 1546509068, "answer_id": 54019828, "question_id": 54012851, "link": "https://stackoverflow.com/questions/54012851/how-to-get-the-macro-to-run-only-if-it-hits-a-certain-filter/54019828#54019828", "title": "How to get the macro to run only if it hits a certain filter", "body": "<p>You could try the below logic:</p>\n\n<pre><code>Option Explicit\n\nSub Test_Date()\n\n    Dim CRV_Key_Yes As String, CRV_Key_No As String\n    Dim Lastrow As Long, i As Long, Line As Long\n    Dim Appears As Boolean\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        Lastrow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n        CRV_Key_Yes = \"YES\" &amp; \"_\" &amp; \"CL810681AG5421BPGB-\"\n        CRV_Key_No = \"NO\" &amp; \"_\" &amp; \"CL810681AG5421BPGB-\"\n\n        Appears = False\n\n        For i = 2 To Lastrow\n\n            If .Range(\"A\" &amp; i).Value &amp; \"_\" &amp; .Range(\"B\" &amp; i).Value = CRV_Key_Yes Then\n                Line = i\n                Appears = False\n                Exit For\n            ElseIf .Range(\"A\" &amp; i).Value &amp; \"_\" &amp; .Range(\"B\" &amp; i).Value = CRV_Key_No And Appears = False Then\n                Line = i\n                Appears = True\n            End If\n\n        Next i\n\n        MsgBox \"CRV Key match on line \" &amp; Line &amp; \".\"\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 10327178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d795576bc6af57a1b001634ff9750aff?s=128&d=identicon&r=PG&f=1", "display_name": "Piccinin", "link": "https://stackoverflow.com/users/10327178/piccinin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 54019828, "answer_count": 1, "score": 0, "last_activity_date": 1546509817, "creation_date": 1546461493, "last_edit_date": 1546509817, "question_id": 54012851, "link": "https://stackoverflow.com/questions/54012851/how-to-get-the-macro-to-run-only-if-it-hits-a-certain-filter", "title": "How to get the macro to run only if it hits a certain filter", "body": "<p>I have a big macro that is doing a lot of copying from a master workbook and 15 daily reports and pasting to the source workbook. The macro is quite big and i will only paste relevant parts.</p>\n\n<p>The source file matches with the master workbook through the following code ( all works fine):</p>\n\n<pre><code> Public OutShVar As Worksheet   \n Public RngConcat As Range   \n\n Set OutShVar = ThisWorkbook.Worksheets(\"SourceSheet\")\n Set RngConcat = OutShVar.Range(\"A:A\")  \n Dim loc As Range\n Dim WCell As Range\n\n\n Concat = ShVar.Range(tC &amp; i).Value \n Set loc = RngConcat.Find(Concat) '(not relevant to this question, it's just setting loc to column A in my source file)\n\n\n  CRV = loc.Offset(0, 2).Value\n\n  'No CRV ID ID\n  If loc.Offset(0, 2).Value = \"Not Available\" Then\n  loc.Offset(0, 80) = \"Y\"\n Else\n  loc.Offset(0, 80) = \"N\"\n\n   'Line items from the masterwork book\n  Set WCell = WShRange.Range(\"FW:FW\").Find(CRV, lookat:=xlWhole)\n   'a bunch of copy pasting\n\n   loc.Offset(0, 26) = WCell.Offset(0, -177) 'an example\n  End if\n End Sub\n</code></pre>\n\n<p>But the problem is here, right now my CRV key in the source file is like this \nCL810681AG5421BPGB-</p>\n\n<p>however, in the master workbook, it's like this</p>\n\n<pre><code>column A                 Column B\nObligation Active        CRV Key\nNO                       CL810681AG5421BPGB- \nNO                       CL810681AG5421BPGB-\nYES                      CL810681AG5421BPGB-\n</code></pre>\n\n<p>As you can see, my code will only match the first line but i want my code to find \"YES\" first and then if it doesn't find then go to the NO. Is that possible?</p>\n"}, {"tags": ["excel", "vba", "winforms-interop"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1546461653, "post_id": 54012821, "comment_id": 94862606, "body": "Never tried anything like thsi, but I assume you ought to be able to use the WinAPI functions to get a handle on the form application&#39;s HWND for instance."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1546461715, "post_id": 54012821, "comment_id": 94862635, "body": "If you create a class library instead of a console application then it will compile to a DLL instead of an EXE <a href=\"https://stackoverflow.com/questions/15567893/creating-a-dll-file-in-c-net\" title=\"creating a dll file in c net\">stackoverflow.com/questions/15567893/&hellip;</a>  see also: <a href=\"https://social.msdn.microsoft.com/Forums/en-US/924a439e-9369-45c2-a739-380b12e17cdd/save-windows-forms-application-as-dll-and-launch-from-another-application?forum=Vsexpressvcs\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/en-US/&hellip;</a> and <a href=\"https://stackoverflow.com/questions/4350542/c-sharp-make-a-dll-out-of-a-windows-forms-project\" title=\"c sharp make a dll out of a windows forms project\">stackoverflow.com/questions/4350542/&hellip;</a>"}, {"owner": {"reputation": 503, "user_id": 906573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e00a7b23b847627e7ebe2db0acb8bda5?s=128&d=identicon&r=PG", "display_name": "user906573", "link": "https://stackoverflow.com/users/906573/user906573"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1546612702, "post_id": 54012821, "comment_id": 94916926, "body": "Thank you so much for the tip links to create a dll out of an exe. That worked."}], "answers": [{"comments": [{"owner": {"reputation": 503, "user_id": 906573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e00a7b23b847627e7ebe2db0acb8bda5?s=128&d=identicon&r=PG", "display_name": "user906573", "link": "https://stackoverflow.com/users/906573/user906573"}, "edited": false, "score": 1, "creation_date": 1546612737, "post_id": 54019969, "comment_id": 94916945, "body": "Thank you Jorge. I will try that out."}], "tags": [], "owner": {"reputation": 1048, "user_id": 9194464, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-seaWoF1hiDU/AAAAAAAAAAI/AAAAAAAAADo/raR_sZ3tMJo/photo.jpg?sz=128", "display_name": "Jorge Ribeiro", "link": "https://stackoverflow.com/users/9194464/jorge-ribeiro"}, "is_accepted": false, "score": 1, "last_activity_date": 1546509608, "creation_date": 1546509608, "answer_id": 54019969, "question_id": 54012821, "link": "https://stackoverflow.com/questions/54012821/excel-vba-to-windows-form-application-process-communication/54019969#54019969", "title": "Excel VBA to Windows Form Application Process Communication", "body": "<p>I think the best way is use Messages between windows.\nHere is a sample to send from vb6 to vb.net, you can adapt it to vba:</p>\n\n<p>vb6 code:</p>\n\n<pre><code>Private Sub cmdSendData_Click()\nDim sString As String\nDim lHwnd As Long\nDim cds As COPYDATASTRUCT\nDim buf(1 To 255) As Byte\n\nsString = Trim$(txtString)\nIf sString = \"\" Then Exit Sub\n'\n' Get the handle of the target application's visible window.\n'\nlHwnd = FindWindow(vbNullString, cWINDOW_TITLE)\n'\n' Copy the string into a byte array,\n' converting it to ASCII. Assign lpData\n' the address of the byte array.\n'\nCall CopyMemory(buf(1), ByVal sString, Len(sString))\nWith cds\n    .dwData = 3\n    .cbData = Len(sString) + 1\n    .lpData = VarPtr(buf(1))\nEnd With\n'\n' Send the string.\n'\nCall SendMessage(lHwnd, WM_COPYDATA, Me.hwnd, cds)\nEnd Sub\n</code></pre>\n\n<p>vb.net code:</p>\n\n<pre><code>Protected Overrides Sub WndProc(ByRef m As System.Windows.Forms.Message)\n    If m.Msg = MainForm.WM_COPYDATA Then\n      Dim data As CopyData\n      Dim message As String\n\n      ' get the data...\n      data = CType(m.GetLParam(GetType(CopyData)), CopyData)\n      Dim B(255) As Byte\nMarshal.Copy(data.lpData, B, 0, 255)\nmessage = System.Text.Encoding.Default.GetString(B\n      ' add the message\n      Messages.Items.Add(String.Format(\"{0}: {1}\", DateTime.Now.ToShortTimeString(), message))\n\n      ' let them know we processed the message...\n      m.Result = New IntPtr(1)\n    Else\n      MyBase.WndProc(m)\n    End If\n  End Sub\n\n  Private Const WM_COPYDATA As Integer = &amp;H4A\n\n  &lt;StructLayout(LayoutKind.Sequential)&gt; _\n  Private Structure CopyData\n    Public dwData As IntPtr\n    Public cbData As Integer\n    Public lpData As IntPtr\n  End Structure\n</code></pre>\n"}], "owner": {"reputation": 503, "user_id": 906573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e00a7b23b847627e7ebe2db0acb8bda5?s=128&d=identicon&r=PG", "display_name": "user906573", "link": "https://stackoverflow.com/users/906573/user906573"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566195448, "creation_date": 1546461331, "last_edit_date": 1566195448, "question_id": 54012821, "link": "https://stackoverflow.com/questions/54012821/excel-vba-to-windows-form-application-process-communication", "title": "Excel VBA to Windows Form Application Process Communication", "body": "<p>I have been tasked to deal with an application where an excel spreadsheet needs to retrieve / access values directly from the windows form application running on a client side by side. I have been reading on exposing .NET components to COM and I have been able to compile, register and consume them from excel. However, nothing that I have read so far has allowed me to tap directly into the windows process / form running and access some of the values on the form itself because I always have to \"New\" the .NET object in VBA and cannot access the current thread. My questions are:</p>\n\n<ul>\n<li>Is it possible to have direct process to process communication between an excel spreadsheet and a windows form application (no intermediary database or file)?</li>\n<li>Is it possible to compile the output of a .NET windows form application into a .dll? So far, I can only get it to generate an .exe.</li>\n</ul>\n\n<p>Please let me know if this is poorly worded and I can try to explain the problem better. </p>\n\n<p>Thank you for your help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1546461354, "post_id": 54012782, "comment_id": 94862501, "body": "You&#39;d need a loop.  What have you tried? (Note: Are you wanting to check each cell in column U, or do you want to just check <code>U2</code>, but hide the rows from 2:300?)"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10859652, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P4-ZSX53WIA/AAAAAAAAAAI/AAAAAAAAApE/-KxrPXNEuiI/photo.jpg?sz=128", "display_name": "Baeblay&#39;d", "link": "https://stackoverflow.com/users/10859652/baeblayd"}, "edited": false, "score": 0, "creation_date": 1546462162, "post_id": 54012865, "comment_id": 94862827, "body": "@Emily_Alden  This worked perfectly! Thank you so much!"}], "tags": [], "owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "is_accepted": true, "score": 0, "last_activity_date": 1546461564, "creation_date": 1546461564, "answer_id": 54012865, "question_id": 54012782, "link": "https://stackoverflow.com/questions/54012782/hide-rows-based-on-false-value/54012865#54012865", "title": "Hide rows based on False value", "body": "<p>To make a basic loop from the second row to row 300 we define a new variable I which will hold the current value/row. Then we replace our row reference with the value i and apply a loop around it. </p>\n\n<pre><code>Sub HideCells()\n Dim i As Long\nFor i = 2 to 300\n   If Range(\"U\" &amp; i).Value = \"False\" Then\n       Rows(i).EntireRow.Hidden = True\n   ElseIf Range(\"U\" &amp; i).Value = \"True\" Then\n       Rows(i).EntireRow.Hidden = False\n   End If\n Next i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 359, "user_id": 11749036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CGIoC.jpg?s=128&g=1", "display_name": "Mirza", "link": "https://stackoverflow.com/users/11749036/mirza"}, "edited": false, "score": 0, "creation_date": 1617611824, "post_id": 54074202, "comment_id": 118343182, "body": "Hi! Can you update your answer with AutoFilter? I got similar issue and would like to see with that solution of you...."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 359, "user_id": 11749036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CGIoC.jpg?s=128&g=1", "display_name": "Mirza", "link": "https://stackoverflow.com/users/11749036/mirza"}, "edited": false, "score": 0, "creation_date": 1617630977, "post_id": 54074202, "comment_id": 118349792, "body": "@Mirza A bit later..."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 359, "user_id": 11749036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CGIoC.jpg?s=128&g=1", "display_name": "Mirza", "link": "https://stackoverflow.com/users/11749036/mirza"}, "edited": false, "score": 1, "creation_date": 1617649868, "post_id": 54074202, "comment_id": 118357543, "body": "@Mirza Updated my answer with faster way. \ud83d\ude0e"}, {"owner": {"reputation": 359, "user_id": 11749036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CGIoC.jpg?s=128&g=1", "display_name": "Mirza", "link": "https://stackoverflow.com/users/11749036/mirza"}, "edited": false, "score": 0, "creation_date": 1617813326, "post_id": 54074202, "comment_id": 118413963, "body": "Thanks! This is useful too!"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 359, "user_id": 11749036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CGIoC.jpg?s=128&g=1", "display_name": "Mirza", "link": "https://stackoverflow.com/users/11749036/mirza"}, "edited": false, "score": 0, "creation_date": 1617905730, "post_id": 54074202, "comment_id": 118447478, "body": "@Mirza You&#39;re welcome! \ud83d\ude09"}], "tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": false, "score": 1, "last_activity_date": 1617649816, "last_edit_date": 1617649816, "creation_date": 1546863071, "answer_id": 54074202, "question_id": 54012782, "link": "https://stackoverflow.com/questions/54012782/hide-rows-based-on-false-value/54074202#54074202", "title": "Hide rows based on False value", "body": "<p>You can reduce Emily's answer down to one line. Don't forget to switch off screen updating:</p>\n<pre><code>Sub HideCells()\n    Dim r&amp;\n    Application.ScreenUpdating = False\n    For r = 2 To 300\n        Rows(i).EntireRow.Hidden = Not CBool(Cells(r, &quot;U&quot;))\n    Next\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n<p>But the fastest way would be to use AutoFilter. If you're interested, I can update answer to include this code.</p>\n<h1>UPDATE - FASTER WAY</h1>\n<p>As I stated above, there's much faster way to achieve hiding rows by using <code>Autofilter</code>:</p>\n<pre><code>Sub HideCellsFast()\n    \n    Dim rngTable As Range    '//Range with header\n    Dim rngData As Range     '//rngTable's body\n    Dim rngFiltered As Range '//Filtered rows\n    \n    '// Set original range including header\n    Set rngTable = Range(&quot;U1:U10&quot;)\n    '// Get range without header\n    With rngTable\n        Set rngData = .Offset(1).Resize(.Rows.Count - 1)\n    End With\n    \n    '// Filter rows\n    rngTable.AutoFilter Field:=1, Criteria1:=1\n    \n    '// Use error hanlder since there can be no filtered rows\n    On Error Resume Next\n    '// Try to get filtered rows\n    Set rngFiltered = rngData.SpecialCells(xlCellTypeVisible)\n    '// Check if we have filtered rows\n    If Err = 0 Then\n        '// If we're here, there are filtered rows.\n        '// First, remove filter.\n        rngTable.AutoFilter Field:=1\n        '// Then hide the rows we have filtered\n        rngFiltered.EntireRow.Hidden = True\n    Else\n        '// Do something if we have no filtered rows\n    End If\n    On Error GoTo 0\n    \n    '// Other code...\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10859652, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P4-ZSX53WIA/AAAAAAAAAAI/AAAAAAAAApE/-KxrPXNEuiI/photo.jpg?sz=128", "display_name": "Baeblay&#39;d", "link": "https://stackoverflow.com/users/10859652/baeblayd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 484, "favorite_count": 0, "accepted_answer_id": 54012865, "answer_count": 2, "score": 0, "last_activity_date": 1617649816, "creation_date": 1546461109, "last_edit_date": 1546848239, "question_id": 54012782, "link": "https://stackoverflow.com/questions/54012782/hide-rows-based-on-false-value", "title": "Hide rows based on False value", "body": "<p>I am using Excel and VB to make a worksheet that hides rows of information based on a checkbox. What I have already done is set up a column \"U\" so that it displays whether or not the box is checked (true/false). I need to create a macro so that if the box is false (unchecked), it will be hidden. Here is what I have so far:</p>\n\n<pre><code>Sub HideCells()\n\n   If Range(\"U2\").Value = \"False\" Then\n       Rows(\"2:2\").EntireRow.Hidden = True\n   ElseIf Range(\"U2\").Value = \"True\" Then\n       Rows(\"2:2\").EntireRow.Hidden = False\n   End If\n\nEnd Sub\n</code></pre>\n\n<p>Now this works for a single row, but how can I extend the range from just U2 to U2:U300?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["excel", "vba", "listbox", "userform"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1546461544, "post_id": 54012739, "comment_id": 94862566, "body": "You are looking for your search item in a single cell and presumably not finding it, hence the error. You can&#39;t activate a cell that doesn&#39;t exist."}, {"owner": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1546462107, "post_id": 54012739, "comment_id": 94862800, "body": "@SJR thank you. How do I correct this. My worksheet1 does have data in there"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1546462333, "post_id": 54012739, "comment_id": 94862898, "body": "You can add a line to avoid the error, but what confuses me is why you are only looking in a single cell <code>Range(&quot;A&quot; &amp; LastRow)</code>. Were you meaning to search a larger range?"}, {"owner": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1546462604, "post_id": 54012739, "comment_id": 94863000, "body": "@SJR yeah that is what I was hoping for. Is to search the entire worksheet and select the item from the listbox"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "edited": false, "score": 0, "creation_date": 1546463925, "post_id": 54013099, "comment_id": 94863532, "body": "I tried the code it does delete the row from worksheet1 but nothing is shown in worksheet2"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "edited": false, "score": 0, "creation_date": 1546464058, "post_id": 54013099, "comment_id": 94863591, "body": "Nothing I changed has any effect on copying anything. All I did was change the offset."}, {"owner": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "edited": false, "score": 0, "creation_date": 1546464384, "post_id": 54013099, "comment_id": 94863715, "body": "hmmm strange that there is nothing showing in sheet2 after selected row in sheet1 is deleted"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "edited": false, "score": 0, "creation_date": 1546464434, "post_id": 54013099, "comment_id": 94863738, "body": "The copying is done before the deletion. Is there a stage missing? What exactly should be copied? Step through the code to check what&#39;s going on."}, {"owner": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "edited": false, "score": 0, "creation_date": 1546465768, "post_id": 54013099, "comment_id": 94864238, "body": "stepping through keeps taking me back to the userform2"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "edited": false, "score": 0, "creation_date": 1546512602, "post_id": 54013099, "comment_id": 94877569, "body": "The code should address the error you were getting; anything else would appear to be beyond the scope of the question."}, {"owner": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "edited": false, "score": 0, "creation_date": 1546539739, "post_id": 54013099, "comment_id": 94891853, "body": "I am getting active method of range class failed on this line Sheets(&quot;StockIn&quot;).Range(&quot;A7:A&quot; &amp;           LastRow).Find(what:=stockin.ListBox1.Text, LookIn:=xlValues,           LookAt:=xlWhole).Activate"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "edited": false, "score": 0, "creation_date": 1546542734, "post_id": 54013099, "comment_id": 94893163, "body": "I&#39;ve just explained what causes that error and how to avoid it."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1546462745, "creation_date": 1546462745, "answer_id": 54013099, "question_id": 54012739, "link": "https://stackoverflow.com/questions/54012739/copy-and-delete-selected-listbox-item/54013099#54013099", "title": "Copy and delete selected listbox item", "body": "<p>Something along these lines. Have left a few comments/queries in the code as not sure about a few things. Note how to handle the possibility of <code>Find</code> not finding anything.</p>\n\n<pre><code>Private Sub Userform2SubmitButton_Click()\n\nDim i As Long, r As Range, ws As Worksheet\n\nSet ws = Worksheets(\"Worksheet1\")\n\nFor i = UserForm1.ListBox1.ListCount - 1 To 0 Step -1\n    If UserForm1.ListBox1.Selected(i) Then\n        ws.Range(\"A\" &amp; i + 1).Copy _\n              Worksheets(\"Worksheet2\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1) 'changed offset to 1 so as not to overwrite\n        If UserForm1.ListBox1.ListIndex &gt;= 0 Then\n            LastRow = ws.Cells(Rows.Count, \"A\").End(xlUp).Row 'not sure what this is for\n            Set r = ws.Cells.Find(what:=UserForm1.ListBox1.Value, LookIn:=xlValues, LookAt:=xlWhole)\n            If Not r Is Nothing Then 'avoid error if nothing found\n                r.EntireRow.Delete\n            End If\n        End If\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "is_accepted": false, "score": 0, "last_activity_date": 1546540786, "creation_date": 1546540786, "answer_id": 54027990, "question_id": 54012739, "link": "https://stackoverflow.com/questions/54012739/copy-and-delete-selected-listbox-item/54027990#54027990", "title": "Copy and delete selected listbox item", "body": "<p>I have managed to find out what was missing. All this time is was just</p>\n\n<pre><code>Sheets(\"Worksheet1\").Select\n</code></pre>\n\n<p>I have added this to my original code for anyone who wants to use this as well. Thank you SJR for your help as well.</p>\n\n<pre><code>Private Sub Userform2SubmitButton_Click() \n    Dim i As Long\n    Sheets(\"Worksheet1\").Select\n    For i = UserForm1.ListBox1.ListCount - 1 To 0 Step -1\n        If UserForm1.ListBox1.Selected(i) Then\n\n            Worksheets(\"Worksheet1\").Range(\"A\" &amp; i + 1). _\n            Copy Worksheets(\"Worksheet2\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(0)\n\n            If UserForm1.ListBox1.ListIndex &gt;= 0 Then\n            LastRow = Worksheets(\"Worksheet1\").Cells(Rows.Count, \"A\").End(xlUp).Row\n\n            Worksheets(\"Worksheet1\").Range(\"A\" &amp; LastRow).Find(what:=UserForm1.ListBox1.Value, LookIn:=xlValues, LookAt:=xlWhole).Activate   '&lt;------------------error here!\n            Worksheets(\"Worksheet1\").Rows(ActiveCell.Row).Delete\n\n        End If\n     End If\n    Next i\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 614, "favorite_count": 0, "accepted_answer_id": 54013099, "answer_count": 2, "score": 0, "last_activity_date": 1556496537, "creation_date": 1546460904, "last_edit_date": 1556496537, "question_id": 54012739, "link": "https://stackoverflow.com/questions/54012739/copy-and-delete-selected-listbox-item", "title": "Copy and delete selected listbox item", "body": "<p>I have code that:     </p>\n\n<ol>\n<li>UserForm1 Listbox 1 populates it's item from Worksheet1</li>\n<li>UserForm2 contains textboxes and a submit button</li>\n<li>When I select an item from UserForm1 ListBox1, it copies the values to UserForm2 Textboxes</li>\n</ol>\n\n<p>I want, when I go into UserForm 2 and click the submit button, the row from Worksheet1 moved to Worksheet2</p>\n\n<p>Below is the code within UserForm1 ListBox1</p>\n\n<pre><code>Private Sub UserForm1ListBox1_Click()\n    With UserForm2\n        .TextBox1 = ListBox1.Column(0)\n        .TextBox2 = ListBox1.Column(1)\n        .TextBox3 = ListBox1.Column(2)\n        .TextBox4 = ListBox1.Column(3)\n        .TextBox5 = ListBox1.Column(4)\n    End With\nEnd Sub\n</code></pre>\n\n<p>Below is the code within UserForm2 submit button. Getting error commented in the code.</p>\n\n<pre><code>Private Sub Userform2SubmitButton_Click() \n    Dim i As Long\n\n    For i = UserForm1.ListBox1.ListCount - 1 To 0 Step -1\n        If UserForm1.ListBox1.Selected(i) Then\n\n            Worksheets(\"Worksheet1\").Range(\"A\" &amp; i + 1). _\n            Copy Worksheets(\"Worksheet2\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(0)\n\n            If UserForm1.ListBox1.ListIndex &gt;= 0 Then\n            LastRow = Worksheets(\"Worksheet1\").Cells(Rows.Count, \"A\").End(xlUp).Row\n\n            Worksheets(\"Worksheet1\").Range(\"A\" &amp; LastRow).Find(what:=UserForm1.ListBox1.Value, LookIn:=xlValues, LookAt:=xlWhole).Activate   '&lt;------------------error here!\n            Worksheets(\"Worksheet1\").Rows(ActiveCell.Row).Delete\n\n        End If\n     End If\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "edited": false, "score": 0, "creation_date": 1546461210, "post_id": 54012722, "comment_id": 94862443, "body": "Try <code>ActiveWorkbook.Worksheets(&quot;Students&quot;).Select</code>"}, {"owner": {"reputation": 1, "user_id": 10859461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b201f88d39aa141006ac6905a570963b?s=128&d=identicon&r=PG&f=1", "display_name": "Liam Docherty", "link": "https://stackoverflow.com/users/10859461/liam-docherty"}, "reply_to_user": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "edited": false, "score": 0, "creation_date": 1546461896, "post_id": 54012722, "comment_id": 94862714, "body": "Syntax error @EmilyAlden"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10859461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b201f88d39aa141006ac6905a570963b?s=128&d=identicon&r=PG&f=1", "display_name": "Liam Docherty", "link": "https://stackoverflow.com/users/10859461/liam-docherty"}, "edited": false, "score": 0, "creation_date": 1546462422, "post_id": 54012853, "comment_id": 94862928, "body": "Thank you, I was using the wrong type of bracket symbol."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 1, "user_id": 10859461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b201f88d39aa141006ac6905a570963b?s=128&d=identicon&r=PG&f=1", "display_name": "Liam Docherty", "link": "https://stackoverflow.com/users/10859461/liam-docherty"}, "edited": false, "score": 0, "creation_date": 1546467599, "post_id": 54012853, "comment_id": 94864939, "body": "@LiamDocherty I guess you have typed the name of the sub manually and it seems it should be <code>CommandButton2_Click()</code>"}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": true, "score": 0, "last_activity_date": 1546476134, "last_edit_date": 1546476134, "creation_date": 1546461500, "answer_id": 54012853, "question_id": 54012722, "link": "https://stackoverflow.com/questions/54012722/how-can-i-open-a-specific-worksheet-using-vba-code-on-a-command-button-macro/54012853#54012853", "title": "How can I open a specific worksheet using VBA code on a command button macro?", "body": "<p>Something like:</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n    ThisWorkbook.WorkSheets(\"Students\").Activate\nEnd Sub\n</code></pre>\n\n<p>should do the trick. Remember to fully qualify your references (E.g. Workbook --> Sheet here), it'll save you headaches later!</p>\n"}], "owner": {"reputation": 1, "user_id": 10859461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b201f88d39aa141006ac6905a570963b?s=128&d=identicon&r=PG&f=1", "display_name": "Liam Docherty", "link": "https://stackoverflow.com/users/10859461/liam-docherty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 431, "favorite_count": 0, "accepted_answer_id": 54012853, "answer_count": 1, "score": 0, "last_activity_date": 1546476134, "creation_date": 1546460839, "question_id": 54012722, "link": "https://stackoverflow.com/questions/54012722/how-can-i-open-a-specific-worksheet-using-vba-code-on-a-command-button-macro", "title": "How can I open a specific worksheet using VBA code on a command button macro?", "body": "<p>I was wondering how can I open a specific worksheet using VBA code on a command button macro? When then user accesses my \"Welcome Sheet\" worksheet and clicks on the command button \"Students\" this should bring them to the \"Students\" worksheet. </p>\n\n<p>I tried the following code but I got an invalid syntax error message as you can see in this <a href=\"https://ibb.co/sWGKqRp\" rel=\"nofollow noreferrer\">image.</a> Furthermore, some of the code turned to a red code and also one line had a yellow background effect as you can see in this <a href=\"https://imgur.com/a/JXnMnRf\" rel=\"nofollow noreferrer\">image.</a></p>\n\n<p>Code:</p>\n\n<pre><code>Private Sub CommandButton_2Click()\nSheets(\"Students\").Activate\nEnd Sub\n</code></pre>\n\n<p>Incase you wanted to check the command button macro is called the same name as written in the code my excel worksheet is linked below. However, I did check and to me it's all correct. </p>\n\n<p><a href=\"https://streamable.com/s/984qm/xmsmqv\" rel=\"nofollow noreferrer\">Video</a> of me showing I have a worksheet called \"Students\" and I have correctly set up the command button correctly. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 312, "user_id": 5376832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131cf551898d23800289731848abedbc?s=128&d=identicon&r=PG&f=1", "display_name": "Karlomanio", "link": "https://stackoverflow.com/users/5376832/karlomanio"}, "edited": false, "score": 0, "creation_date": 1546460126, "post_id": 54012536, "comment_id": 94861999, "body": "HI Diego, dates are a real issue in CSV format.  Could you provide what the format was before export, what you expect it to be, and how it appeared as examples?  This will help us understand what is going on."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10859580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d315d885eadcc7683b3f50d9072a5cf6?s=128&d=identicon&r=PG&f=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/10859580/diego"}, "is_accepted": false, "score": 0, "last_activity_date": 1546598058, "creation_date": 1546598058, "answer_id": 54037232, "question_id": 54012536, "link": "https://stackoverflow.com/questions/54012536/change-format-when-exporting-to-csv/54037232#54037232", "title": "Change format when exporting to CSV", "body": "<p>This is an example of my output:</p>\n\n<p>11/27/2018 11:19\n11/27/2018 11:20\n11/27/2018 11:25\n11/27/2018 11:30\n11/27/2018 11:35\n11/27/2018 11:40\n11/27/2018 11:45\n11/27/2018 13:00\n11/27/2018 16:00\n11/27/2018 17:15\n27-11-2018 22:10\n27-11-2018 23:40\n28-11-2018 1:10\n28-11-2018 2:30\n28-11-2018 3:40\n28-11-2018 4:10\n28-11-2018 5:10</p>\n\n<p>The original input was DD-MM-YYYY HH:MM but as you can see, for some reason, it changed.  Luckily, I was able to reach the solution:</p>\n\n<pre><code>tmpWS.SaveAs Filename:=filePath, FileFormat:=xlCSV, local:=True \n</code></pre>\n\n<p>Just added: \"local:= True\" in the Workbook.SaveAs method.</p>\n"}], "owner": {"reputation": 1, "user_id": 10859580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d315d885eadcc7683b3f50d9072a5cf6?s=128&d=identicon&r=PG&f=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/10859580/diego"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1546848259, "creation_date": 1546459784, "last_edit_date": 1546848259, "question_id": 54012536, "link": "https://stackoverflow.com/questions/54012536/change-format-when-exporting-to-csv", "title": "Change format when exporting to CSV", "body": "<p>I have this macro to export Excel to CSV:</p>\n\n<pre><code>Sub To_CSV()\nDim tmpWS As Worksheet\nApplication.DisplayAlerts = False\n\nFor Each WS In ThisWorkbook.Worksheets\n\nIf WS.Range(\"B1\").Value &lt;&gt; \"\" Then\n     If WS.Range(\"c1\").Value &lt;&gt; \"\" Then\n         filePath = Environ(\"USERPROFILE\") &amp; \"\\Desktop\\\" &amp; \"Pozo de Bombeo \" &amp; WS.Range(\"B1\").Value &amp; \".csv\"\n     Else\n         filePath = Environ(\"USERPROFILE\") &amp; \"\\Desktop\\\" &amp; \"Pozo de Observacion \" &amp; WS.Range(\"B1\").Value &amp; \".csv\"\n     End If\n     WS.Copy\n     Set tmpWS = ActiveSheet\n     tmpWS.SaveAs Filename:=filePath, FileFormat:=xlCSV\n     tmpWS.Parent.Close False\n\nEnd If\nNext\n\n\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p>But when I open the the CSV \"POZO DE BOMBEO\" the format of some dates changed, apparently at random.</p>\n"}, {"tags": ["ms-access", "vba", "adodb", "recordset"], "comments": [{"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1546460159, "post_id": 54012518, "comment_id": 94862008, "body": "Why are you calling <code>MoveLast</code> and <code>MoveFirst</code> before entering the loop?"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1546460209, "post_id": 54012518, "comment_id": 94862028, "body": "@Dai IIRC, it&#39;s a bug with the ADODB.Recordsets. Usually do this to get an accurate RecordCount."}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1546460211, "post_id": 54012518, "comment_id": 94862030, "body": "Also, please show the actual code inside your <code>While</code> loop - it&#39;s possible you&#39;re seeing side-effects."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1546460272, "post_id": 54012518, "comment_id": 94862049, "body": "Can you replicate this with a contrived file that follows the same format? I wonder if it is how the file is formatted."}, {"owner": {"reputation": 73, "user_id": 8253702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1c6950698736b8e48ace22bff7f041?s=128&d=identicon&r=PG&f=1", "display_name": "DanG", "link": "https://stackoverflow.com/users/8253702/dang"}, "reply_to_user": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1546460327, "post_id": 54012518, "comment_id": 94862064, "body": "@Dai I added what I am actually doing - for now putting the row into an array using GetRows"}, {"owner": {"reputation": 73, "user_id": 8253702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1c6950698736b8e48ace22bff7f041?s=128&d=identicon&r=PG&f=1", "display_name": "DanG", "link": "https://stackoverflow.com/users/8253702/dang"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1546460445, "post_id": 54012518, "comment_id": 94862112, "body": "@RyanWildry The file is a pretty basic semi-colon delimited CSV. Could the carriage returns in the file somehow be causing this? The thing is the RecordCount seems correct - matches the number of rows in the file. It&#39;s just that I am skipping ahead too fast"}, {"owner": {"reputation": 312, "user_id": 5376832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131cf551898d23800289731848abedbc?s=128&d=identicon&r=PG&f=1", "display_name": "Karlomanio", "link": "https://stackoverflow.com/users/5376832/karlomanio"}, "edited": false, "score": 0, "creation_date": 1546460719, "post_id": 54012518, "comment_id": 94862211, "body": "I would try a different recordset type i.e. not adOpenStatic.  I&#39;m not sure how you are able to MoveLast and then MoveFirst using an adOpenStatic recordset type."}], "answers": [{"comments": [{"owner": {"reputation": 312, "user_id": 5376832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131cf551898d23800289731848abedbc?s=128&d=identicon&r=PG&f=1", "display_name": "Karlomanio", "link": "https://stackoverflow.com/users/5376832/karlomanio"}, "edited": false, "score": 0, "creation_date": 1546460829, "post_id": 54012693, "comment_id": 94862253, "body": "You would get the same result by putting MoveNext back and removing currentRow = currentRow + 1."}], "tags": [], "owner": {"reputation": 73, "user_id": 8253702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1c6950698736b8e48ace22bff7f041?s=128&d=identicon&r=PG&f=1", "display_name": "DanG", "link": "https://stackoverflow.com/users/8253702/dang"}, "is_accepted": false, "score": 1, "last_activity_date": 1546460667, "creation_date": 1546460667, "answer_id": 54012693, "question_id": 54012518, "link": "https://stackoverflow.com/questions/54012518/adodb-recordset-movenext-going-up-by-2/54012693#54012693", "title": "ADODB.RecordSet.MoveNext going up by 2", "body": "<p>The .GetRows(1) method I was using was already moving to the next record after retrieving the current record. By using the .MoveNext as well it was causing it to jump by 2 each loop.</p>\n\n<p>I removed the .MoveNext and it appears to be working properly (jumping by 1)</p>\n"}], "owner": {"reputation": 73, "user_id": 8253702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1c6950698736b8e48ace22bff7f041?s=128&d=identicon&r=PG&f=1", "display_name": "DanG", "link": "https://stackoverflow.com/users/8253702/dang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 873, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594625160, "creation_date": 1546459689, "last_edit_date": 1594625160, "question_id": 54012518, "link": "https://stackoverflow.com/questions/54012518/adodb-recordset-movenext-going-up-by-2", "title": "ADODB.RecordSet.MoveNext going up by 2", "body": "<p>I am importing a CSV into ACCESS using ADODB recordset. I am trying to iterate through the recordset to get data I need, but when I use the .MoveNext method it goes up 2 instead of one. By that I mean AbsolutePosition counts by 2s (1,3,5..) and I hit the EOF when the rowcounter I am using hits exactly half of the total number of records</p>\n\n<pre><code>Public Function ConnectToCSV(filePath As String, fileName As String)\nDim connString As String\nDim connection As ADODB.connection\nDim RS As New ADODB.recordSet\nDim currentRow As Long\ndim readArray() as Variant\n\nSet connection = New ADODB.connection\nconnString = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source= \" &amp; filePath &amp; fileName &amp; _\n  \";Extended Properties='text;HDR=YES;FMT=Delimited';\"\n\nconnection.Open connString\n\nRS.Open \"SELECT * FROM \" &amp; fileName, connection, adOpenStatic, adLockReadOnly, adCmdText\n\ncurrentRow = 0\nRS.MoveLast\nRS.MoveFirst\n\nWhile Not RS.EOF\n    readArray = RS.GetRows(1)\n    RS.MoveNext\n    currentRow = currentRow + 1\nWend\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "edited": false, "score": 0, "creation_date": 1546459250, "post_id": 54012243, "comment_id": 94861691, "body": "I don&#39;t get what you mean by resizing. If you mean you want to refer to the table&#39;s entire <code>databodyrange</code> including the rows you&#39;ve just added, assuming you added via <code>ListRows.Add</code> or just wrote the data immediately next to/below the table, the table should automatically expand to include the new rows, no? Meaning just access the <code>ListObject</code>&#39;s <code>Range</code> (includes headers I think) or <code>DataBodyRange</code> (without headers)"}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "reply_to_user": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "edited": false, "score": 0, "creation_date": 1546459410, "post_id": 54012243, "comment_id": 94861749, "body": "The table does expand automatically for the first row. Then when I do another week , ie dec 19, it is not automatically expanding . It only works for the first row...sigh. So I need to resize right?"}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "edited": false, "score": 0, "creation_date": 1546460233, "post_id": 54012243, "comment_id": 94862034, "body": "How are you adding the data? Manually or through some code? In my experience, the table always expands when you put data immediately next to it (irrespective of whether it&#39;s the first, second, third, etc. time that you&#39;re adding data.), or for example if you write an array to <code>databodyrange</code> that exceeds the table&#39;s current dimensions."}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "reply_to_user": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "edited": false, "score": 0, "creation_date": 1546461324, "post_id": 54012243, "comment_id": 94862485, "body": "through some code.  I use a <code>lastrow</code> code to get the last row then add some formulas to the last row of the table. Doesnt seem to append to the table."}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "edited": false, "score": 0, "creation_date": 1546465196, "post_id": 54012243, "comment_id": 94864021, "body": "if you&#39;re inserting formulas, your formula may need to be the same for the entire column (i.e. calculated columns) in order for Excel to intuit how to autoexpand the table range. Are the formulas in the <code>12 Dec</code> row different to the formulas in the new rows you&#39;re adding? Also, strangely enough the reference for ListObject.Resize says &quot;No cells are inserted or moved.&quot;"}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "reply_to_user": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "edited": false, "score": 0, "creation_date": 1546479236, "post_id": 54012243, "comment_id": 94867649, "body": "No, the formulas are the same as 12 Dec. I just re run the code to get results of the next week. Not sure what to do from here."}], "owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566195457, "creation_date": 1546458178, "last_edit_date": 1566195457, "question_id": 54012243, "link": "https://stackoverflow.com/questions/54012243/vba-resizing-table-is-shifting-data", "title": "VBA, Resizing table is shifting data", "body": "<p>I am trying to use this code to resize my table after I add data to it weekly.</p>\n\n<pre><code>Sub ResizeListDyn()\n    Dim tbl As ListObject\n    Set tbl = ActiveSheet.ListObjects(1)\n    tbl.Resize tbl.Range.CurrentRegion\nEnd Sub\n</code></pre>\n\n<p>Currently the data is like so, with 12-Dec-2018 being in the table. I add the next two weeks data and try to resize the table automatically.</p>\n\n<pre><code>+-------------+--------------+--------------+-------------+\n| 12-Dec-2018 | -71700079.84 | -65611884.73 | -1794788.38 |\n| 19-Dec-2018 | -82238011.30 | -74725620.20 | -1558074.81 |\n| 26-Dec-2018 | -59385932.41 | -54947256.94 | -1811642.55 |\n+-------------+--------------+--------------+-------------+\n</code></pre>\n\n<p>I end up with data like this after running the code:</p>\n\n<pre><code>+-------------+--------------+--------------+-------------+\n| 19-Dec-2018 | -82238011.30 | -74725620.20 | -1558074.81 |\n| 26-Dec-2018 | -59385932.41 | -54947256.94 | -1811642.55 |\n| 12-Dec-2018 | -71700079.84 | -65611884.73 | -1794788.38 |\n+-------------+--------------+--------------+-------------+\n</code></pre>\n\n<p>As you can see 12-Dec-2018 data gets shifted to last row.  But they are all in the table now.</p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1546458244, "post_id": 54012157, "comment_id": 94861271, "body": "where is &quot;x&quot; utilized?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1546458310, "post_id": 54012157, "comment_id": 94861304, "body": "Where&#39;s your <code>With</code> statement? Also, you don&#39;t need the <code>Else</code> statement. Just end the <code>If</code> statement after <code>.Clear</code>, then do the <code>CF = CF + 1</code>"}, {"owner": {"reputation": 27, "user_id": 10244592, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cTHX3ere4X0/AAAAAAAAAAI/AAAAAAAAAIE/1tflj093vJM/photo.jpg?sz=128", "display_name": "Don of the Dead", "link": "https://stackoverflow.com/users/10244592/don-of-the-dead"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1546613271, "post_id": 54012157, "comment_id": 94917256, "body": "Thank you for pointing out the &quot;x&quot;; fixed that. The PC was supposed to be replaced by the &quot;x.&quot; Thank you @BruceWayne for clearing the useless Else statement. When a problem causes me a lot of grief I seem to do worse coding."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1546677621, "post_id": 54012157, "comment_id": 94935224, "body": "Seems like you ignored Cyril&#39;s comment bellow. Please see <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 10244592, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cTHX3ere4X0/AAAAAAAAAAI/AAAAAAAAAIE/1tflj093vJM/photo.jpg?sz=128", "display_name": "Don of the Dead", "link": "https://stackoverflow.com/users/10244592/don-of-the-dead"}, "edited": false, "score": 0, "creation_date": 1546613428, "post_id": 54012286, "comment_id": 94917335, "body": "Thanks @Cyril. I like the way you contstructed the nested For and use of &quot;r&quot; and &quot;c&quot; for variables; mine were confusing me sometimes and this made it so much simplier. I did have to modify it slightly but going off of what you had you gave me the right answer. All I really needed was the &quot;shift:=xlToLeft&quot; and it worked perfectly."}, {"owner": {"reputation": 27, "user_id": 10244592, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cTHX3ere4X0/AAAAAAAAAAI/AAAAAAAAAIE/1tflj093vJM/photo.jpg?sz=128", "display_name": "Don of the Dead", "link": "https://stackoverflow.com/users/10244592/don-of-the-dead"}, "edited": false, "score": 0, "creation_date": 1546613488, "post_id": 54012286, "comment_id": 94917378, "body": "Speaking of which. What is the difference, if any, between: Shift:=xlShiftToLeft and Shift:=xlToLeft? I appear to have gotten very different answers."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 27, "user_id": 10244592, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cTHX3ere4X0/AAAAAAAAAAI/AAAAAAAAAIE/1tflj093vJM/photo.jpg?sz=128", "display_name": "Don of the Dead", "link": "https://stackoverflow.com/users/10244592/don-of-the-dead"}, "edited": false, "score": 0, "creation_date": 1546615195, "post_id": 54012286, "comment_id": 94918390, "body": "I do not know about the difference between those; i have never used xlshifttoleft when i&#39;ve coded in VBA for Excel.  if that answers your question, please mark as answered (check mark on the left of the post)."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 0, "last_activity_date": 1546458487, "creation_date": 1546458487, "answer_id": 54012286, "question_id": 54012157, "link": "https://stackoverflow.com/questions/54012157/my-for-loop-wont-delete-the-cells-that-match-the-nested-if-requirements/54012286#54012286", "title": "My For loop won&#39;t delete the cells that match the nested If requirements", "body": "<p>Will try to give an example, though I don't know your exact criteria for your range (variables which aren't displayed in your posted code)</p>\n\n<pre><code>dim r as long, c as long \nfor r = 10 to 1 step -1\n    for c = 10 to 1 step -1\n        if cells(r,c).value = 0 or cells(r,c).value = \"0\" then cells(r,c).delete shift:=xltoleft\n    next c \nnext r\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 376, "user_id": 7692972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d578fde0393fe710892164e12a48855?s=128&d=identicon&r=PG&f=1", "display_name": "BZngr", "link": "https://stackoverflow.com/users/7692972/bzngr"}, "is_accepted": false, "score": 0, "last_activity_date": 1546642055, "last_edit_date": 1546642055, "creation_date": 1546619613, "answer_id": 54042822, "question_id": 54012157, "link": "https://stackoverflow.com/questions/54012157/my-for-loop-wont-delete-the-cells-that-match-the-nested-if-requirements/54042822#54042822", "title": "My For loop won&#39;t delete the cells that match the nested If requirements", "body": "<p>Another approach is to write the evaluated content of the datasource to another worksheet (or Range) dedicated to serving your chart.  This avoids the cell delete/shift manipulations and keeps yours source data intact - probably making debugging easier.</p>\n\n<pre><code>Sub GenerateChartDataFromSource()\n    Dim sourceWksht As Worksheet\n    Set sourceWksht = Application.Worksheets(\"Source\")\n\n    Dim chartWksht As Worksheet\n    Set chartWksht = Application.Worksheets(\"ChartSource\")\n\n\n    Dim sourceRow As Long, sourceColumn As Long\n    Dim chartSourceColumn As Long\n\n    Dim sourceContent As Variant\n\n    Dim sourceRowStart As Long, sourceRowEnd As Long\n    sourceRowStart = 1\n    sourceRowEnd = 10\n\n    Dim sourceColumnStart As Long, sourceColumnEnd As Long\n    sourceColumnStart = 1\n    sourceColumnEnd = 10\n\n    For sourceRow = sourceRowStart To sourceRowEnd\n        chartSourceColumn = sourceColumnStart\n        For sourceColumn = sourceColumnStart To sourceColumnEnd\n            sourceContent = sourceWksht.Cells(sourceRow, sourceColumn).value\n            If sourceContent &lt;&gt; 0 Or sourceContent &lt;&gt; \"0\" Then\n                chartWksht.Cells(sourceRow, chartSourceColumn) = sourceContent\n                chartSourceColumn = chartSourceColumn + 1\n            End If\n        Next sourceColumn\n    Next sourceRow\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 10244592, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cTHX3ere4X0/AAAAAAAAAAI/AAAAAAAAAIE/1tflj093vJM/photo.jpg?sz=128", "display_name": "Don of the Dead", "link": "https://stackoverflow.com/users/10244592/don-of-the-dead"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 54012286, "answer_count": 2, "score": 0, "last_activity_date": 1546642055, "creation_date": 1546457612, "last_edit_date": 1546526834, "question_id": 54012157, "link": "https://stackoverflow.com/questions/54012157/my-for-loop-wont-delete-the-cells-that-match-the-nested-if-requirements", "title": "My For loop won&#39;t delete the cells that match the nested If requirements", "body": "<p>I finally got this to work and I am happier for it but I need to take it to the next level for chart building. As you can see it progresses through the columns and rows and clears a pair of cells. When I try to make a chart of the full row it comes up with gaps in it because of the cleared cells. There is a \"with\" statement going on here but its just a reference to another sheet since the code is being executed from a different sheet; pushing as opposed to pulling.</p>\n\n<pre><code>LCcfd = .Standard Last Column code. The cfd referst to the abv. of a sheet.\nLrcfd = .Standard Last Row code. The cfd refers to the abv. of a sheet. \n\nFor x = 2 to LRcfd Step 2\n    CF = 2\n    For Each cel in .Range(.Cells(x, 2), .Cells(x, LCcfd))\n        If cel = 0 Or cel = \"0\" Then\n            cel.Clear\n            .Cells(x - 1, CF).Clear\n        End If\n        CF = CF + 1\n    Next\nNext\n</code></pre>\n\n<p>To take it to the next level I tried to change the <code>.Clear</code> to <code>.Delete Shift:=xlShiftToLeft</code> and it is NOT working as expected at all. I figured this was because it is progressing in the columns from left to right. I attempted to write the code so it goes through Each backwards but it will not accept a <code>Step -1</code>. So, I don't know how to do that. </p>\n\n<p>What can I do to this code to make it step backwards through the rows? Or:</p>\n\n<p>What can you recommend I change the code to, to make this happen?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1546458932, "post_id": 54012090, "comment_id": 94861563, "body": "Asking for <i>the most optimized way</i> would make this question Too Broad, leading to closure, though may be more appropriate for another site like Code Review (they help optimize code which does run).  Can you update your question to relate to the code you&#39;ve provided, as there should be many ways to get to what you&#39;re asking (though I&#39;m honestly a bit confused in your explanation of the data for what it looks like you&#39;re asking)?"}, {"owner": {"reputation": 1, "user_id": 10859355, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lxkuedssDAk/AAAAAAAAAAI/AAAAAAAAAJU/-vlLCSBZ_Bo/photo.jpg?sz=128", "display_name": "Raul", "link": "https://stackoverflow.com/users/10859355/raul"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1546459786, "post_id": 54012090, "comment_id": 94861888, "body": "How can I update question?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1546460785, "post_id": 54012090, "comment_id": 94862233, "body": "On the bottom of your post there are buttons for &quot;share&quot;, &quot;edit&quot;, and &quot;flag&quot;... click edit.  you should be able to search for the word &quot;edit&quot; using ctrl+f if need be."}], "owner": {"reputation": 1, "user_id": 10859355, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lxkuedssDAk/AAAAAAAAAAI/AAAAAAAAAJU/-vlLCSBZ_Bo/photo.jpg?sz=128", "display_name": "Raul", "link": "https://stackoverflow.com/users/10859355/raul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566196108, "creation_date": 1546457261, "last_edit_date": 1566196108, "question_id": 54012090, "link": "https://stackoverflow.com/questions/54012090/how-to-update-formulas-in-a-number-of-cells-based-on-number-reference-from-adjac", "title": "How to update formulas in a number of cells based on number reference from adjacent cells", "body": "<p>I have a file displaying sale locations on a physical floor. These cells are formulated to display various indexes by returning values from another sheet ; adjacent to these locations is a position number ranging from 1 to 250 that can be to the left, above, to the right or below the location. I am looking for the most optimized way to update the formulas in the locations cells based on the position number filled into the adjacent cell so for example if position changes from 2 to 3 when running a macro the location formula should change from =TOTALS!$V$11 to =TOTALS!$V$12 where $V$12 comes from position 3+9 rows.. </p>\n\n<p>I can provide sample file</p>\n\n<p>Tried Interior.ColorIndex, R1C1 formulas etc. </p>\n\n<p>Started with identifying the colors did not get to the formula part. </p>\n\n<pre><code>Sub Test1()\n\n'white is -4142\n'pink color index 38\n'green  color index 10\n'red color index 3\n'turcoise color index 8\n'yellow color index 6\n'blue color index 5\n'purple color index 13\n\nSelection.Offset(0, -1).Select\n\nRange(Left(Selection.Address, InStr(Selection.Address, \":\") - 1)).Interior.ColorIndex\n\n\nFor Each possValue In Selection\n\n    If Selection.Interior.ColorIndex = 5 Or Selection.Interior.ColorIndex = 38 Then\n        If Left(Selection.Offset(0, -1).Address, InStr(Selection.Offset(0, -1).Address, \":\") - 1).Interior.ColorIndex = -4142 And Left(Selection.Offset(0, -1).Address, InStr(Selection.Offset(0, -1).Address, \":\") - 1).HasFormula = False Then\n\n            MsgBox Left(Selection.Offset(0, -1).Address, InStr(Selection.Offset(0, -1).Address, \":\") - 1).Value\n\n        End If\n\n    End If\n\nNext possValue\n\nEnd Sub\n</code></pre>\n\n<p>I have a file displaying sale locations on a physical floor. These cells are formulated to display various indexes by returning values from another sheet ; adjacent to these locations is a position number ranging from 1 to 250 that can be to the left, above, to the right or below the location. I am looking for the most optimized way to update the formulas in the locations cells based on the position number filled into the adjacent cell so for example if position changes from 2 to 3 when running a macro the location formula should change from =TOTALS!$V$11 to =TOTALS!$V$12 where $V$12 comes from position 3+9 rows.. </p>\n\n<p><img src=\"https://i.stack.imgur.com/I9gUF.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1546457055, "post_id": 54012015, "comment_id": 94860780, "body": "Adding a comment to my own post... Excel is not a database, and does not inherently allow queuing for data entry.  if something prevents entry to the workbook, then nothing while the error is being displayed will be input either.  I would recommend using an actual database which is built for handing data submission."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1546457342, "post_id": 54012015, "comment_id": 94860902, "body": "Will make another recommendation...  Save a string instead of populating a msgbox per pre-determined issue (where you shouldn&#39;t be able to pair certain classes).  Then append all strings together in one msgbox and display.  Similar to your total = total  + 20, you can use errstr = errstr &amp; &quot;  &quot; &amp; &quot;More text here.&quot; to keep things in one line, then MsgBox(errstr)"}, {"owner": {"reputation": 87, "user_id": 10852647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725bf619f278bad05840ac7d0cb23a67?s=128&d=identicon&r=PG&f=1", "display_name": "MJ98", "link": "https://stackoverflow.com/users/10852647/mj98"}, "edited": false, "score": 0, "creation_date": 1546458458, "post_id": 54012015, "comment_id": 94861358, "body": "Just to clarify - do I put this under the &quot;err&quot; function under each option button code or only under the error code message box?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 87, "user_id": 10852647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725bf619f278bad05840ac7d0cb23a67?s=128&d=identicon&r=PG&f=1", "display_name": "MJ98", "link": "https://stackoverflow.com/users/10852647/mj98"}, "edited": false, "score": 1, "creation_date": 1546458559, "post_id": 54012015, "comment_id": 94861407, "body": "You are trying to catch where errors occur, so if you have an error and are displaying a msgbox, then you want the line AFTER the msgbox (inside of any if statement, etc.) to be err=1, that way you have captured the error and will prevent submission of data."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 1, "last_activity_date": 1546456826, "creation_date": 1546456826, "answer_id": 54012015, "question_id": 54011929, "link": "https://stackoverflow.com/questions/54011929/cancel-task-if-error-occurs-in-userform/54012015#54012015", "title": "Cancel task if &quot;error&quot; occurs in Userform", "body": "<p>Maybe not ideal, but has saved me in the past... After each msbox line, write a new line:</p>\n\n<pre><code>err = 1\n</code></pre>\n\n<p>Then before you push the data to the sheet:</p>\n\n<pre><code>if err = 0 then \n    'push data to the spreadsheet\n    unload me\nelse\n    'nothing\nend if\n</code></pre>\n\n<hr>\n\n<p>I have utilized this to prevent data submission in the past, where I have many separate switches or statements for utilizing data/buttons.</p>\n\n<p>Note you need to define err for your option explicit module.  Inherently, err = 0, when Dim err as Long, though you may want to specify err = 0 before you start the rest of your subroutine.</p>\n\n<p>This should allow you to put out all msgbox from different checks, then keep the sheet up.  </p>\n"}], "owner": {"reputation": 87, "user_id": 10852647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725bf619f278bad05840ac7d0cb23a67?s=128&d=identicon&r=PG&f=1", "display_name": "MJ98", "link": "https://stackoverflow.com/users/10852647/mj98"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 54012015, "answer_count": 1, "score": 1, "last_activity_date": 1546699526, "creation_date": 1546456429, "last_edit_date": 1546699526, "question_id": 54011929, "link": "https://stackoverflow.com/questions/54011929/cancel-task-if-error-occurs-in-userform", "title": "Cancel task if &quot;error&quot; occurs in Userform", "body": "<p>I have a userform 'AMForm' for students to choose their classes in high school.</p>\n\n<p>There are adjacent option buttons for each class to select 'yes' or 'no' if they want to enroll in the class e.g. \"Mechanical engineering\" with 'yes' or 'no' option buttons next to it.</p>\n\n<p>Once they submit their form I record the choices on the spreadsheet 'AMChoices'. This spreadsheet has each class in the above headings, so it fills the cell with 'x' if it has been selected e.g. if 'Mechanical Engineering' option button is selected it fills 'x' underneath this cell.</p>\n\n<p>As the spreadsheet will host many users, it fills down to the next empty row to record each entry.</p>\n\n<p>The Userform has restrictions such as not being able to choose specific classes together. I have error messages for this but when they click the \"submit\" button, even if there are errors, the choices are recorded. </p>\n\n<p>How can I cancel the choices from being recorded until they are accepted?</p>\n\n<p>In my code \"optAMIB1\" refers to \"yes\" option button for \"Mechanical Engineering\". There are lots of classes so there are several of these codes in my form, but I have just put in one for simplicity. Secondly, \"txtAMS1\" refers to a text box that automatically updates with the selected options' total credits e.g. Mech Eng is worth 20 credits, but they have to select enough classes to total 40.  </p>\n\n<pre><code>Private Sub btnAMSubmit1_Click()\n\n Dim Total As String\n Dim Total2 As String\n Dim CurrentCell As Range\n Dim AMChoiceSht As Worksheet\n Dim LastRow As Long\n\n 'Semester 1 Credits\n Total = 0\n\n ' set the worksheet object\n Set AMChoiceSht = ThisWorkbook.Worksheets(\"AMChoices\")\n\n 'Choose IB1 Sem 1\n With AMChoiceSht\n  LastRow = .Cells(.Rows.Count, \"F\").End(xlUp).Row ' find last row in column B\n  Set CurrentCell = .Range(\"F\" &amp; LastRow + 1) ' set the range of next empty row\n End With\n\n If Me.optAMIB1 Then\n  Total = Total + 20\n  CurrentCell.Value2 = \"X\"\n End If\n\n If Me.optAMIB1 = False Then\n  CurrentCell.Value2 = \"-\"\n End If\n\n 'add up to 40\n If Me.txtAMS1 &lt;&gt; 40 Then\n  MsgBox \"Error. Semester One Credits must be equal to 40.\"\n End If\n</code></pre>\n"}, {"tags": ["c#", "vba", "ms-word"], "comments": [{"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1546458728, "post_id": 54011855, "comment_id": 94861472, "body": "If accessing the COM object is slow, then copying it will be just as slow."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1546458755, "post_id": 54011855, "comment_id": 94861483, "body": "What does this have to do with VBA?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1546458857, "post_id": 54011855, "comment_id": 94861524, "body": "If it&#39;s not necessary to interact with the user look at working directly with the file, using the Open XML file format (OPen XML SDK, for example). That will be much faster"}, {"owner": {"reputation": 2316, "user_id": 398157, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/ciEpE.jpg?s=128&g=1", "display_name": "ForEachLoop", "link": "https://stackoverflow.com/users/398157/foreachloop"}, "edited": false, "score": 1, "creation_date": 1546459122, "post_id": 54011855, "comment_id": 94861637, "body": "OpenXML can&#39;t be used since they are not formal items in the file. Some structures exist only in memory, such as the misspelling list. This may not be a VBA question per se, other than I can&#39;t get to the DOM except through VBA. It&#39;s slow because accessing the DOM requires going through several layers."}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1546464147, "post_id": 54011855, "comment_id": 94863634, "body": "We use Aspose at work, but it isn&#39;t free.  It is, however, pretty good."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1546464343, "post_id": 54011855, "comment_id": 94863699, "body": "Cross-posted at: <a href=\"https://forums.windowssecrets.com/showthread.php/183850-Word-VBA-Speed-Up-DOM-Object-Access\" rel=\"nofollow noreferrer\">forums.windowssecrets.com/showthread.php/&hellip;</a>  For cross-posting etiquette, please read: <a href=\"http://www.excelguru.ca/content.php?184\" rel=\"nofollow noreferrer\">excelguru.ca/content.php?184</a>"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1546480650, "post_id": 54011855, "comment_id": 94867898, "body": "Can you get what you need from unzipping the Word Doc, and read in the XML file(s) async?"}, {"owner": {"reputation": 2316, "user_id": 398157, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/ciEpE.jpg?s=128&g=1", "display_name": "ForEachLoop", "link": "https://stackoverflow.com/users/398157/foreachloop"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1546486599, "post_id": 54011855, "comment_id": 94868818, "body": "@RyanWildry I can get some information from the XML file. For example, in this case can get the misspelled words from the XML, useful, yes, but the SpellingErrors collection has more and dynamic information. There are many other in-memory collections, too."}], "owner": {"reputation": 2316, "user_id": 398157, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/ciEpE.jpg?s=128&g=1", "display_name": "ForEachLoop", "link": "https://stackoverflow.com/users/398157/foreachloop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1546458875, "creation_date": 1546456010, "last_edit_date": 1546458875, "question_id": 54011855, "link": "https://stackoverflow.com/questions/54011855/copy-word-dom-structure-as-c-object", "title": "Copy Word DOM Structure As C# Object", "body": "<p>How is it possible to copy a Microsoft Word DOM structure as a C# object?</p>\n\n<p>Accessing Work DOM objects is slow, and if the structure is large enough, accessing individual elements becomes prohibitively slow. For example:</p>\n\n<pre><code>foreach (Microsoft.Office.Interop.Word.Range item in myDocument.range.SpellingErrors)\n{\n    string myString = item.Text;\n}\n</code></pre>\n\n<p>might take too long of time. You don't own the DOM object and so you can't modify for other copy techniques. </p>\n\n<p>Is there a way to copy this as a C# object and then be able to work with it outside of Word?</p>\n"}, {"tags": ["android", "vba", "powerpoint", "mpeg-4", "m4a"], "comments": [{"owner": {"reputation": 5944, "user_id": 646173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23cb9ef472d0c9c24f216dc6c19af696?s=128&d=identicon&r=PG", "display_name": "Markus Schumann", "link": "https://stackoverflow.com/users/646173/markus-schumann"}, "edited": false, "score": 0, "creation_date": 1546524127, "post_id": 54011849, "comment_id": 94883748, "body": "can you share a sample file with book mark."}, {"owner": {"reputation": 547, "user_id": 10769002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2da3297e022f0a7082ce73c500c3e65b?s=128&d=identicon&r=PG&f=1", "display_name": "Jenn", "link": "https://stackoverflow.com/users/10769002/jenn"}, "reply_to_user": {"reputation": 5944, "user_id": 646173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23cb9ef472d0c9c24f216dc6c19af696?s=128&d=identicon&r=PG", "display_name": "Markus Schumann", "link": "https://stackoverflow.com/users/646173/markus-schumann"}, "edited": false, "score": 0, "creation_date": 1546534111, "post_id": 54011849, "comment_id": 94889293, "body": "Markus Schumman I&#39;ve added a sample file."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1546551830, "post_id": 54011849, "comment_id": 94896739, "body": "@Jenn You can add bookmarks to a video using VBA (I can probably dig up some code for this if you don&#39;t know how) but I don&#39;t know any way to retrieve existing bookmarks from a video file."}, {"owner": {"reputation": 547, "user_id": 10769002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2da3297e022f0a7082ce73c500c3e65b?s=128&d=identicon&r=PG&f=1", "display_name": "Jenn", "link": "https://stackoverflow.com/users/10769002/jenn"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1546783587, "post_id": 54011849, "comment_id": 94957692, "body": "@Steve Rindsberg Being able to add bookmarks using VBA would be fantastic.  I don&#39;t know how.  If you could share, that would be wonderful.  These are audio files though.  Would the code be the same for audio and video?  Both would be helpful.  Thank you!"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1546877950, "post_id": 54011849, "comment_id": 94989389, "body": "@jenn see my answer below"}], "answers": [{"tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": true, "score": 0, "last_activity_date": 1546878213, "creation_date": 1546878213, "answer_id": 54078106, "question_id": 54011849, "link": "https://stackoverflow.com/questions/54011849/how-can-i-access-samsung-voice-recorder-m4a-bookmarks-after-conversion-to-window/54078106#54078106", "title": "How can I access Samsung Voice Recorder m4a bookmarks after conversion to Windows mpeg4?", "body": "<p>You can add bookmarks to video or audio using VBA.</p>\n\n<p>For example, assuming you have your audio or video selected:</p>\n\n<pre><code>With ActiveWindow.Selection.ShapeRange(1)\n   With .MediaFormat.MediaBookmarks\n      ' Add a bookmark at the 5 second mark\n      .Add 5000, \"My bookmark name\"\n   End With ' MediaBookmarks\nEnd With  ' Selected Shape\n</code></pre>\n"}], "owner": {"reputation": 547, "user_id": 10769002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2da3297e022f0a7082ce73c500c3e65b?s=128&d=identicon&r=PG&f=1", "display_name": "Jenn", "link": "https://stackoverflow.com/users/10769002/jenn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 0, "accepted_answer_id": 54078106, "answer_count": 1, "score": 1, "last_activity_date": 1593729703, "creation_date": 1546455997, "last_edit_date": 1593729703, "question_id": 54011849, "link": "https://stackoverflow.com/questions/54011849/how-can-i-access-samsung-voice-recorder-m4a-bookmarks-after-conversion-to-window", "title": "How can I access Samsung Voice Recorder m4a bookmarks after conversion to Windows mpeg4?", "body": "<p>I recorded several files with Samsung Voice Recorder and inserted several bookmarks per file.  On my phone, they are m4a files.  When copied onto my computer, they appear as mpeg4 files.</p>\n\n<p>I need to add these to Powerpoint (one file per slide), and use the bookmarks to trigger animations (ideally with vba), however, the bookmarks don't show up.</p>\n\n<p>Can anyone please help or point me in the right direction?  Thanks in advance.</p>\n\n<p>Here is a link to one of the files.  This file has 6 bookmarks with the following timing: 00:00, 00:03, 00:04, 00:05, 00:12, 00:24.\n<a href=\"https://1drv.ms/u/s!AkCe6_YwGEfWgupe2wsCcerSf4nFUw\" rel=\"nofollow noreferrer\">https://1drv.ms/u/s!AkCe6_YwGEfWgupe2wsCcerSf4nFUw</a></p>\n\n<p>I have added the final code.  The audio files follow a script that have minor variations for specific clients, so the clips are all very close to the same.  I added the audio file to each slide then copied the bookmarks from the original audio and applied them to the new file.  Thanks!!</p>\n\n<pre><code>            'Purpose: Copy media bookmarks and animation settings from a media shape on the same slide to the selected media shape.\n            'Sources:\n            '           https://stackoverflow.com/questions/54011849/how-can-i-access-samsung-voice-recorder-m4a-bookmarks-after-conversion-to-window\n            '           http://skp.mvps.org/2010/ppt002.htm\n\n            Private Sub CopyMediaSettingsToNewItem()\n\n            Dim sld As Slide\n            Dim newShp As Shape\n            Dim shp As Shape\n            Dim mf As MediaFormat\n            Dim z As Long\n            Dim y As Long\n            Dim oMBK As MediaBookmark\n            Dim myMBK As String\n            Dim myPos As Long\n\n                Set sld = ActivePresentation.Slides(ActiveWindow.Selection.SlideRange.SlideIndex)\n                Set shp = sld.Shapes(\"Slide 13\")\n                Set mf = shp.MediaFormat\n                Set newShp = sld.Shapes(\"Slides(13)\")\n\n                With newShp\n\n                    .Top = shp.Top\n                    .Left = shp.Left\n                    .Width = shp.Width\n                    .Height = shp.Height\n\n                End With\n\n                'Apply the original shape's media format settings to the new shape.  The 'noted settings are read-only.\n                With newShp.MediaFormat\n\n                    '.AudioCompressionType = shp.MediaFormat.AudioCompressionType\n                    '.AudioSamplingRate = shp.MediaFormat.AudioSamplingRate\n                    '.EndPoint = shp.MediaFormat.EndPoint\n                    .FadeInDuration = shp.MediaFormat.FadeInDuration\n                    .FadeOutDuration = shp.MediaFormat.FadeOutDuration\n                    '.IsEmbedded = shp.MediaFormat.IsEmbedded\n                    '.IsLinked = shp.MediaFormat.IsLinked\n                    '.Length = shp.MediaFormat.Length\n                    .Muted = shp.MediaFormat.Muted\n                    '.Parent = shp.MediaFormat.Parent\n                    '.ResamplingStatus = shp.MediaFormat.ResamplingStatus\n                    '.SampleHeight = shp.MediaFormat.SampleHeight\n                    '.SampleWidth = shp.MediaFormat.SampleWidth\n                    .StartPoint = shp.MediaFormat.StartPoint\n                    .Volume = shp.MediaFormat.Volume\n\n                    End With\n\n                    For y = 1 To shp.MediaFormat.MediaBookmarks.Count\n\n                            Set oMBK = shp.MediaFormat.MediaBookmarks(y)\n                            myMBK = oMBK.Name\n\n                                Debug.Print \"Length: \" &amp; shp.MediaFormat.Length\n                                Debug.Print \"EndPoint: \" &amp; shp.MediaFormat.EndPoint\n                                Debug.Print \"Position: \" &amp; oMBK.Position\n                                Debug.Print \"Name: \" &amp; oMBK.Name\n\n                            'If the last bookmark position of the original shape is past the length of the new media file...\n                            If oMBK.Position &gt; newShp.MediaFormat.Length Then\n\n                                myPos = newShp.MediaFormat.Length\n\n                                Else: myPos = shp.MediaFormat.MediaBookmarks(y).Position\n\n                                End If\n\n                                        With ActiveWindow.Selection.ShapeRange(1)\n\n                                            With .MediaFormat.MediaBookmarks\n\n                                                .Add myPos, myMBK\n\n                                            End With\n\n                                        End With\n\n                    Next\n\n                    If shp.MediaType = ppMediaTypeMovie Then\n\n                        '.VideoCompressionType = shp.MediaFormat.VideoCompressionType\n                        '.VideoFrameRate = shp.MediaFormat.VideoFrameRate\n\n                    End If\n\n\n                    shp.PickupAnimation\n\n                    newShp.ApplyAnimation\n\n                    'Dim eff As Effect\n                    'Set eff = sld.TimeLine.MainSequence.AddEffect(newShp, msoAnimEffectMediaPlay, trigger:=msoAnimTriggerAfterPrevious)\n\n                        'With newShp.AnimationSettings.PlaySettings\n\n                            '.LoopUntilStopped = msoCTrue\n                            '.PauseAnimation = msoFalse\n                            '.PlayOnEntry = msoCTrue\n                            '.RewindMovie = msoCTrue\n                            '.StopAfterSlides = 999\n                            '.HideWhileNotPlaying = msoTrue\n\n                        'End With\n\n            'Release from memory\n            Set sld = Nothing\n            Set newShp = Nothing\n            Set shp = Nothing\n            z = 0\n            y = 0\n            Set oMBK = Nothing\n            Set mf = Nothing\n            myMBK = vbNullString\n            myPos = 0\n\n\n            End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1546455639, "post_id": 54011705, "comment_id": 94860176, "body": "What &quot;issues&quot; are you having specifically? If D5 is on another sheet you should add a sheet reference."}, {"owner": {"reputation": 25, "user_id": 10854048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e63e2399370d49cf04a1f8fcd8e35a1?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaCenta", "link": "https://stackoverflow.com/users/10854048/alphacenta"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1546456082, "post_id": 54011705, "comment_id": 94860355, "body": "No, there is no problem with adding blank rows. The problem is I don&#39;t exactly know how to copy the 3 rows below &quot;BillNumber&quot; and paste it to the rows that I&#39;ve created with this code."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1546456149, "post_id": 54011705, "comment_id": 94860392, "body": "Is D5 on a different sheet? If not, when you insert rows it will move."}, {"owner": {"reputation": 25, "user_id": 10854048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e63e2399370d49cf04a1f8fcd8e35a1?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaCenta", "link": "https://stackoverflow.com/users/10854048/alphacenta"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1546456528, "post_id": 54011705, "comment_id": 94860560, "body": "No its in the same sheet but at the first row. The text is below that. So when i insert rows it does not move. There is no problem with that."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1546459344, "post_id": 54011705, "comment_id": 94861726, "body": "How is D5 at the first row? You should at least change the end value of your loop."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1546463060, "post_id": 54011705, "comment_id": 94863189, "body": "According to the image, you are looking for the D6-value in cells of column A. When found, you want to insert the row of the found cell and two rows below, above the found cell."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10854048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e63e2399370d49cf04a1f8fcd8e35a1?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaCenta", "link": "https://stackoverflow.com/users/10854048/alphacenta"}, "edited": false, "score": 0, "creation_date": 1546457346, "post_id": 54011956, "comment_id": 94860903, "body": "Thanks. But there is still an issue. I guess i couldn&#39;t explain my problem clear enough, sorry that is my bad. When i insert 3 rows above the cell in A column(which has same content with D5), i want excel to copy the 3 rows below that moved cell, not 3 rows below D5. So anytime i insert 3 more rows, it still has to copy the 3 rows below that cell and paste it above to the recently created 3 rows."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "reply_to_user": {"reputation": 25, "user_id": 10854048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e63e2399370d49cf04a1f8fcd8e35a1?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaCenta", "link": "https://stackoverflow.com/users/10854048/alphacenta"}, "edited": false, "score": 2, "creation_date": 1546457574, "post_id": 54011956, "comment_id": 94860983, "body": "@AlphaCenta - It might be helpful to <a href=\"https://stackoverflow.com/posts/54011705/edit\">edit your question</a> and post some screen caps of initial data and expected results. Upload the images to imgur.com and someone with enough reputation will be able to insert them for you"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1546459406, "post_id": 54011956, "comment_id": 94861746, "body": "FInd is a good way to go, but you might need to allow for more than one instance."}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1546459471, "post_id": 54011956, "comment_id": 94861768, "body": "It has been corrected, it is still taking the value from D5, looking on Column A for the value, finding it, copying the 3 cells Below the found value and inserting 3 cells above with the copied cells."}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1546459596, "post_id": 54011956, "comment_id": 94861815, "body": "@SJR, true but since it was never mentioned that the value would repeat, I went with it."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 25, "user_id": 10854048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e63e2399370d49cf04a1f8fcd8e35a1?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaCenta", "link": "https://stackoverflow.com/users/10854048/alphacenta"}, "edited": false, "score": 0, "creation_date": 1546459814, "post_id": 54011956, "comment_id": 94861898, "body": "Ricardo - fair enough. The screenshot is not what I was envisaging - why don&#39;t you just shift column A down @AlphaCenta?"}, {"owner": {"reputation": 25, "user_id": 10854048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e63e2399370d49cf04a1f8fcd8e35a1?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaCenta", "link": "https://stackoverflow.com/users/10854048/alphacenta"}, "edited": false, "score": 0, "creation_date": 1546460569, "post_id": 54011956, "comment_id": 94862163, "body": "@Ricardo - The percentage values come from another sheet. Every month bill number changes like 19,20,21. I need to shift the last months bill(let&#39;s say it&#39;s 21). It already gets percentages from another sheet and billnumber from D6. So 21 needs to be shifted 3 rows below and those rows which starts with 21 needs to be copied to the recently created blank rows. Then i will change the billnumber in D6 to 22 and current month&#39;s values will be changed just after i change them in other sheet."}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "reply_to_user": {"reputation": 25, "user_id": 10854048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e63e2399370d49cf04a1f8fcd8e35a1?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaCenta", "link": "https://stackoverflow.com/users/10854048/alphacenta"}, "edited": false, "score": 0, "creation_date": 1546463423, "post_id": 54011956, "comment_id": 94863329, "body": "@AlphaCenta with the screenshots it now makes more sense and my code would just have to be modified very little to make it work. I wont be able to edit the answer until later tonight, but I want to point out that all you need is there. My code shows you a way to find the billnumber in column A, it shows you how to insert 3 cells on top of the cell that it found, you can add a line so it adds 3 more on column B as well. It copies the 3 cells from column A but can also be changed to copy the ones from column B. I encourage you to play with the code on the meantime, it&#39;s the best way to learn."}, {"owner": {"reputation": 25, "user_id": 10854048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e63e2399370d49cf04a1f8fcd8e35a1?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaCenta", "link": "https://stackoverflow.com/users/10854048/alphacenta"}, "edited": false, "score": 0, "creation_date": 1546589958, "post_id": 54011956, "comment_id": 94905880, "body": "@Ricardo A - Thank you so much. I&#39;ve just changed a few numbers in your code and it works smoothly. Thanks again."}], "tags": [], "owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "is_accepted": true, "score": 0, "last_activity_date": 1546459517, "last_edit_date": 1546459517, "creation_date": 1546456557, "answer_id": 54011956, "question_id": 54011705, "link": "https://stackoverflow.com/questions/54011705/copying-the-cells-below-a-text/54011956#54011956", "title": "Copying the Cells Below A Text", "body": "<p>Here is one way, remove the MsgBox lines, they are for debugging.</p>\n\n<pre><code>Sub insertPaste()\n    Dim D5Val As String, wk As Workbook, fVal As Range\n    Set wk = ThisWorkbook\n    With wk.Sheets(\"Sheet1\")\n        'Value from D5\n        D5Val = .Range(\"D5\").Value\n        'Find D5 on column A\n        Set fVal = .Columns(\"A:A\").Find(D5Val, , xlValues, , xlNext)\n        If fVal Is Nothing Then\n            'Not found\n            MsgBox \"Not Found\"\n        Else\n            'Found\n            MsgBox \"Found at: \" &amp; fVal.Address\n            'Insert 3 Cells on top of the cell found with the data from the 3 cells below\n            .Range(\"A\" &amp; (fVal.Row + 1) &amp; \":A\" &amp; (fVal.Row + 3)).Copy\n            .Range(\"A\" &amp; fVal.Row &amp; \":A\" &amp; (fVal.Row + 2)).Insert Shift:=xlDown\n            Application.CutCopyMode = False\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1546463089, "last_edit_date": 1546463089, "creation_date": 1546460289, "answer_id": 54012619, "question_id": 54011705, "link": "https://stackoverflow.com/questions/54011705/copying-the-cells-below-a-text/54012619#54012619", "title": "Copying the Cells Below A Text", "body": "<h1>Copy Cells Below Text Above Text</h1>\n\n<h2>The Code</h2>\n\n<pre><code>Private Sub SearchandInsertRows()\n\n    Dim lRow As Long, iRow As Long\n\n    With Worksheets(\"Main_Page\")\n        lRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        For iRow = lRow To 1 Step -1\n            If .Cells(iRow, \"A\").Value = .Range(\"D6\") Then\n                .Rows(iRow).Resize(3).Insert\n                .Rows(iRow + 3 &amp; \":\" &amp; iRow + 5).Copy .Rows(iRow)\n            End If\n        Next iRow\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10854048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e63e2399370d49cf04a1f8fcd8e35a1?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaCenta", "link": "https://stackoverflow.com/users/10854048/alphacenta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 54011956, "answer_count": 2, "score": 1, "last_activity_date": 1546463089, "creation_date": 1546455348, "last_edit_date": 1546459688, "question_id": 54011705, "link": "https://stackoverflow.com/questions/54011705/copying-the-cells-below-a-text", "title": "Copying the Cells Below A Text", "body": "<p>I am trying to copy 3 entire rows below a cell which includes a text.</p>\n\n<p>I've already wrote this but there are some issues that I can't solve due to being a beginner of VBA.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub SearchandInsertRows()\n\nDim lRow As Long,  iRow As Long\n\nWith Worksheets(\"Main_Page\")\n    lRow = .Cells(.Rows.Count, \"A\").End(xlup).Row\n    For iRow = lRow to 1 Step -1\n        If .Cells(iRow, \"A\").Value = Range(\"D5\") Then\n            .Rows(iRow).Resize(3).Insert\n        End if\n    Next iRow\nEnd With\n\nEnd Sub \n</code></pre>\n\n<p>I want excel to read the entire A column and find the cell which has same text with cell <code>D5</code> (Text is BillNumber). Then add 3 blank rows above that. Lastly copy the three cells below BillNumber and paste it to recently created 3 blank rows. </p>\n\n<p>Here is screenshot to make it more understandable.</p>\n\n<p><a href=\"https://i.stack.imgur.com/tW0A5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tW0A5.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 2444, "user_id": 6180031, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-HRw-01bXV4c/AAAAAAAAAAI/AAAAAAAACP8/Mi48YmzBWL0/photo.jpg?sz=128", "display_name": "ZorgoZ", "link": "https://stackoverflow.com/users/6180031/zorgoz"}, "edited": false, "score": 0, "creation_date": 1546455765, "post_id": 54011701, "comment_id": 94860222, "body": "Never would try such thing in Outlook, even less in VBA. But just one question: how would the application know to call <code>InboxItems_ItemAdd</code>? Where is it registered as event handler? If the method is fired, please be more specific on <i>what exactly does not work and how exactly do you get notified about this</i>. On the other hand: you set <code>InboxItems</code> then you overwrite its value immediately, why?"}, {"owner": {"reputation": 15, "user_id": 10452607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af55dcb192a91b52f7d6aabf38486cc8?s=128&d=identicon&r=PG&f=1", "display_name": "Hoganator", "link": "https://stackoverflow.com/users/10452607/hoganator"}, "reply_to_user": {"reputation": 2444, "user_id": 6180031, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-HRw-01bXV4c/AAAAAAAAAAI/AAAAAAAACP8/Mi48YmzBWL0/photo.jpg?sz=128", "display_name": "ZorgoZ", "link": "https://stackoverflow.com/users/6180031/zorgoz"}, "edited": false, "score": 0, "creation_date": 1546456215, "post_id": 54011701, "comment_id": 94860431, "body": "Appreciate the response. Like I mentioned, I am new to VBA and am trying to piece together items that I find. It is certainly not my strong suit. I found a forum where people said the framework of the above worked for them in a similar manner, and I tried to tailor it to suit my needs. I just want outlook to save a copy of any email that comes to a specific folder to a location on a sharedrive. Are you saying you would never do such a thing? Thanks for your help"}, {"owner": {"reputation": 2444, "user_id": 6180031, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-HRw-01bXV4c/AAAAAAAAAAI/AAAAAAAACP8/Mi48YmzBWL0/photo.jpg?sz=128", "display_name": "ZorgoZ", "link": "https://stackoverflow.com/users/6180031/zorgoz"}, "edited": false, "score": 0, "creation_date": 1546456401, "post_id": 54011701, "comment_id": 94860509, "body": "I would use .net to write a plugin for outlook... but that&#39;s my way. It is not that it would not work, I am just not a VBA fan, if there are better methods..."}, {"owner": {"reputation": 2444, "user_id": 6180031, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-HRw-01bXV4c/AAAAAAAAAAI/AAAAAAAACP8/Mi48YmzBWL0/photo.jpg?sz=128", "display_name": "ZorgoZ", "link": "https://stackoverflow.com/users/6180031/zorgoz"}, "edited": false, "score": 0, "creation_date": 1546456641, "post_id": 54011701, "comment_id": 94860610, "body": "Shouldn&#39;t you use <code>Set InboxItems = xNameSpace.GetDefaultFolder(olFolderInbox).Folders(&#39;My Folder&#39;)</code>? Are you sure, that ApplicationStartup is the place of initialization? Here <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.items.itemadd\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/outlook.items.itemad&zwnj;&#8203;d</a> I see an <code>Initialize_handler</code> override(?)."}, {"owner": {"reputation": 2444, "user_id": 6180031, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-HRw-01bXV4c/AAAAAAAAAAI/AAAAAAAACP8/Mi48YmzBWL0/photo.jpg?sz=128", "display_name": "ZorgoZ", "link": "https://stackoverflow.com/users/6180031/zorgoz"}, "edited": false, "score": 0, "creation_date": 1546456907, "post_id": 54011701, "comment_id": 94860724, "body": "Just as option: <a href=\"https://docs.microsoft.com/en-us/visualstudio/vsto/how-to-programmatically-perform-actions-when-an-e-mail-message-is-received?view=vs-2017\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/visualstudio/vsto/&hellip;</a>"}, {"owner": {"reputation": 15, "user_id": 10452607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af55dcb192a91b52f7d6aabf38486cc8?s=128&d=identicon&r=PG&f=1", "display_name": "Hoganator", "link": "https://stackoverflow.com/users/10452607/hoganator"}, "reply_to_user": {"reputation": 2444, "user_id": 6180031, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-HRw-01bXV4c/AAAAAAAAAAI/AAAAAAAACP8/Mi48YmzBWL0/photo.jpg?sz=128", "display_name": "ZorgoZ", "link": "https://stackoverflow.com/users/6180031/zorgoz"}, "edited": false, "score": 0, "creation_date": 1546460471, "post_id": 54011701, "comment_id": 94862125, "body": "Thanks for your feedback Zorgo. Unfortunately, all I have access to is VBA. Are you saying I should remove the ApplicationStartup sub and replace it with the Initialize_handler?"}, {"owner": {"reputation": 2444, "user_id": 6180031, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-HRw-01bXV4c/AAAAAAAAAAI/AAAAAAAACP8/Mi48YmzBWL0/photo.jpg?sz=128", "display_name": "ZorgoZ", "link": "https://stackoverflow.com/users/6180031/zorgoz"}, "edited": false, "score": 0, "creation_date": 1546460658, "post_id": 54011701, "comment_id": 94862189, "body": "It was just an idea..."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1546461632, "post_id": 54011701, "comment_id": 94862591, "body": "Are you getting an error, any idea <i>where</i> this is failing?"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10452607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af55dcb192a91b52f7d6aabf38486cc8?s=128&d=identicon&r=PG&f=1", "display_name": "Hoganator", "link": "https://stackoverflow.com/users/10452607/hoganator"}, "edited": false, "score": 0, "creation_date": 1546465071, "post_id": 54013290, "comment_id": 94863979, "body": "Hi Ryan, thanks so much! Unfortunately, it is still not working on my end. I have sent multiple test emails. I am in a corporate environment and have tried using Public instead of Private. Do you have any suggestions to get this working? Really appreciate your help"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 15, "user_id": 10452607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af55dcb192a91b52f7d6aabf38486cc8?s=128&d=identicon&r=PG&f=1", "display_name": "Hoganator", "link": "https://stackoverflow.com/users/10452607/hoganator"}, "edited": false, "score": 0, "creation_date": 1546466987, "post_id": 54013290, "comment_id": 94864719, "body": "The code should work, however, few things to check.Make sure you&#39;ve updated the FolderPath variable. Make sure macros are enabled all the time. See: <a href=\"https://support.office.com/en-us/article/enable-or-disable-macros-in-office-files-12b036fd-d140-4e74-b45e-16fed1a7e5c6\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>. If that doesn&#39;t work, SaveAs apparently can be finicky. You might need to use Redemption. See: <a href=\"https://stackoverflow.com/questions/29148947/mailitem-saveas-refuses-to-work\" title=\"mailitem saveas refuses to work\">stackoverflow.com/questions/29148947/&hellip;</a>"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 15, "user_id": 10452607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af55dcb192a91b52f7d6aabf38486cc8?s=128&d=identicon&r=PG&f=1", "display_name": "Hoganator", "link": "https://stackoverflow.com/users/10452607/hoganator"}, "edited": false, "score": 0, "creation_date": 1546481083, "post_id": 54013290, "comment_id": 94867977, "body": "Oh, and triple check you added this to <code>ThisOutlookSession</code> not a module or a class."}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 0, "last_activity_date": 1546467058, "last_edit_date": 1546467058, "creation_date": 1546463694, "answer_id": 54013290, "question_id": 54011701, "link": "https://stackoverflow.com/questions/54011701/issue-with-class-module-outlook-vba/54013290#54013290", "title": "Issue with Class Module Outlook VBA", "body": "<p>There were a few issues with the code that I saw. I have this working, make sure you add this to the <code>ThisOutlookSession</code> object in the VBA IDE.</p>\n\n<pre><code>Private WithEvents InboxItems As Outlook.Items\n\nPrivate Sub Application_Startup()\n    Dim outlookApp As Outlook.Application: Set outlookApp = Outlook.Application\n    Dim objectNS As Outlook.NameSpace: Set objectNS = outlookApp.GetNamespace(\"MAPI\")\n    Set InboxItems = objectNS.GetDefaultFolder(olFolderInbox).Items\nEnd Sub\n\nPrivate Sub InboxItems_ItemAdd(ByVal Item As Object)\n    Dim FolderPath      As String: FolderPath = \"YOUR PATH HERE\"\n    Dim FileName        As String\n    Static FSO          As Object\n\n    If FSO Is Nothing Then Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n    If FSO.FolderExists(FolderPath) = False Then FSO.CreateFolder FolderPath\n\n    With CreateObject(\"vbscript.regexp\")\n        .Global = True\n        .IgnoreCase = False\n        .Pattern = \"\\||\\/|\\&lt;|\\&gt;|\"\"|:|\\*|\\\\|\\?\"\n\n        If Item.Class = olMail Then\n            FileName = .Replace(Item.Subject, vbNullString)\n            Item.SaveAs FolderPath &amp; FileName &amp; \".msg\", olMSG\n        End If\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10452607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af55dcb192a91b52f7d6aabf38486cc8?s=128&d=identicon&r=PG&f=1", "display_name": "Hoganator", "link": "https://stackoverflow.com/users/10452607/hoganator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 332, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1546467058, "creation_date": 1546455325, "question_id": 54011701, "link": "https://stackoverflow.com/questions/54011701/issue-with-class-module-outlook-vba", "title": "Issue with Class Module Outlook VBA", "body": "<p>I am new to VBA and am trying to insert a class module to save an email that arrives to a sub-folder in the inbox called \"My Folder\" to a location on a sharedrive. I have the below code and have tried sending emails to test but it is not working and cannot figure out why. Any help would be greatly appreciated! </p>\n\n<pre><code>Private WithEvents InboxItems As Outlook.Items\nSub Application_Startup()\nDim xNameSpace As Outlook.NameSpace\nSet xNameSpace = Outlook.Application.Session\nSet InboxItems = xNameSpace.GetDefaultFolder(olFolderInbox)\nSet InboxItems = olFolder.Folders(\"My Folder\")\nEnd Sub\n\nPrivate Sub InboxItems_ItemAdd(ByVal objItem As Object)\nDim FSO\nDim xMailItem As Outlook.MailItem\nDim xFilePath As String\nDim xRegEx\nDim xFileName As String\nOn Error Resume Next\nxFilePath = CreateObject(\"WScript.Shell\").SpecialFolders(16)\nxFilePath = xFilePath &amp; \"File Path on Share Drive will be entered here\"\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\nIf FSO.FolderExists(xFilePath) = False Then\nFSO.CreateFolder (xFilePath)\nEnd If\nSet xRegEx = CreateObject(\"vbscript.regexp\")\nxRegEx.Global = True\nxRegEx.IgnoreCase = False\nxRegEx.Pattern = \"\\||\\/|\\&lt;|\\&gt;|\"\"|:|\\*|\\\\|\\?\"\nIf objItem.Class = olMail Then\nSet xMailItem = objItem\nxFileName = xRegEx.Replace(xMailItem.Subject, \"\")\nxMailItem.SaveAs xFilePath &amp; \"\\\" &amp; xFileName &amp; \".msg\", olMSG\nEnd If\nExit Sub\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1546453218, "post_id": 54011182, "comment_id": 94859241, "body": "Is there a command button or some other event on the userform that will run the code to look at the information on the LookUpValues Sheet?  Also is <code>lRowA = Sheets(&quot;LookUpValues&quot;).Range(&quot;A&quot; &amp; .Rows.count).End(xlUp).row</code>the only piece of code you have written ?"}, {"owner": {"reputation": 137, "user_id": 3999084, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e53b750ab7ecb6c53da2c698bdcb6b1a?s=128&d=identicon&r=PG&f=1", "display_name": "pinkpanther", "link": "https://stackoverflow.com/users/3999084/pinkpanther"}, "reply_to_user": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1546453409, "post_id": 54011182, "comment_id": 94859329, "body": "No other event on the userform to look at the LookUpValues sheet. Can you give me an idea on how will I do that?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1546453781, "post_id": 54011182, "comment_id": 94859464, "body": "Posting a single line of code is probably not going to cut it."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 1, "creation_date": 1546453979, "post_id": 54011182, "comment_id": 94859550, "body": "Fully qualify your Range reference. Something like: <code>lRowA = ThisWorkBook.Sheets(&quot;LookUpValues&quot;).Range(&quot;A&quot; &amp; ThisWorkBook.Sheets(&quot;LookUpValues&quot;).Rows.count).End(xlUp).ro&zwnj;&#8203;w</code> Code would be cleaner if you add your Worksheet reference to a variable."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1546454046, "post_id": 54011182, "comment_id": 94859575, "body": "One way to start on the UserForm issue is calling an event like a <code>Button_Click()</code> that will allow you to run the code to look at the information.  All the <code>lRowA = Sheets(&quot;LookUpValues&quot;).Range(&quot;A&quot; &amp; .Rows.count).End(xlUp).row</code> does is get the last row of column A."}], "owner": {"reputation": 137, "user_id": 3999084, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e53b750ab7ecb6c53da2c698bdcb6b1a?s=128&d=identicon&r=PG&f=1", "display_name": "pinkpanther", "link": "https://stackoverflow.com/users/3999084/pinkpanther"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566196114, "creation_date": 1546452731, "last_edit_date": 1566196114, "question_id": 54011182, "link": "https://stackoverflow.com/questions/54011182/calling-worksheet-in-the-form-using-vba", "title": "Calling worksheet in the form using VBA", "body": "<p>I need to check if the value can be found in the lookupvalues sheet. I used userform to create a compare tool and need to check if the data is in the LookUpValues tab. The Form and LookupValues are in the same workbook. When I run my code, I got an error \"Subscript is out of range\". Below code is for getting the length of the Column A in the LookUpValues.</p>\n\n<pre><code>lRowA = Sheets(\"LookUpValues\").Range(\"A\" &amp; .Rows.count).End(xlUp).row\n</code></pre>\n\n<p>Can anyone help me identify the issue in my code. How will I call the worksheet in the userform?</p>\n\n<p>The image below shows the structure with userform and the LookUpValues.\n<a href=\"https://i.stack.imgur.com/tRoVo.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tRoVo.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1546472594, "post_id": 54011124, "comment_id": 94866359, "body": "Do your colleagues have a store named &quot;Rings&quot;? <code>oNameSpace</code> gives your VBA code access to all the stores in your folder pane.  When you look at your folder pane, some lines are against the left edge and some are indented.  The lines against the left edge are stores which are the files in which Outlook stores your mail items, calendar items, tasks are so on.  The indented lines are folders within a store.  <code>oNameSpace.Folders(&quot;Rings&quot;)</code> gives access to store &quot;Rings&quot;. <code>oNameSpace.Folders(&quot;Rings&quot;).Folders(&quot;Inbox&quot;)</code> gives access to folder &quot;Inbox&quot; within store &quot;Rings&quot;."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1546472750, "post_id": 54011124, "comment_id": 94866388, "body": "<code>oNameSpace.Folders(&quot;Rings&quot;).Folders(&quot;Inbox&quot;).Items</code> gives access to the items within folder &quot;Inbox&quot; within store &quot;Rings&quot;.  If your colleagues do not have a store names &quot;Rings&quot; or if that store does not contain folder &quot;Inbox&quot;, they will get an error."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1546473068, "post_id": 54011124, "comment_id": 94866459, "body": "It is possible to access folders by index number, for example: oNameSpace.Folders(1) or oNameSpace.Folders(inx).  This allows you to use a For-Loop to search down the list of stores for one with the required name.  Would this solve your problem?"}, {"owner": {"reputation": 53, "user_id": 5270145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a29aef9c84e23e147df46cfde894b8be?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Guill", "link": "https://stackoverflow.com/users/5270145/nathan-guill"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1546550037, "post_id": 54011124, "comment_id": 94896078, "body": "@TonyDallimore Yes, all of my colleagues have a store &quot;Rings&quot;.  This is our shared email address for the department. I just tried a For-Loop on one of my colleagues machine and had the same result. We both have the same version of Outlook and I have confirmed that our Trust Center Settings are the same and have even refreshed the references needed by the VBA file."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1546554940, "post_id": 54011124, "comment_id": 94897841, "body": "Try deleting <code>Dim oNameSpace As NameSpace</code> and <code>Set oNameSpace = Application.GetNamespace(&quot;MAPI&quot;)</code> and change <code>Set olRingsInboxItems = ...</code> to <code>Set olRingsInboxItems =Session.Folders(&quot;Rings&quot;).Folders(&quot;Inbox&quot;).Items</code> According to the documentation, <code>NameSpace</code> and <code>Session</code> are the same.  However, I never use <code>NameSpace</code> because it once gave me a strange error which I fixed by changing to <code>Session</code>.  I do not remember what that error was.  I do not know what else to suggest because I cannot see any other difference from the event code I use."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1546561652, "post_id": 54011124, "comment_id": 94899539, "body": "See how to setup shared inbox <a href=\"https://stackoverflow.com/a/34871809/4539709\">stackoverflow.com/a/34871809/4539709</a>"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1546631830, "post_id": 54011124, "comment_id": 94926113, "body": "@0m3r  I do not understand how your comment helps.  I do not have access to <code>GetSharedDefaultFolder</code> so cannot comment on it. <code>GetDefaultFolder</code> doesn&#39;t work for me because I have a store per email address and none of those stores is the default.  When I had access to shared stores, I always accessed them by name as Nathan is attempting.  If you have an explanation for Nathan&#39;s code failing, I would like to hear as an aid to my own understanding of Outlook."}, {"owner": {"reputation": 53, "user_id": 5270145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a29aef9c84e23e147df46cfde894b8be?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Guill", "link": "https://stackoverflow.com/users/5270145/nathan-guill"}, "edited": false, "score": 0, "creation_date": 1546875178, "post_id": 54011124, "comment_id": 94987833, "body": "I tried both suggestions without success.  They both work on my machine, but not my coworker&#39;s.  I am truly at a loss as to the reason. Both machines are set up identically as far as software is concerned.  The main difference is that his is a desktop and mine is a laptop. That shouldn&#39;t have any effect on accessing a shared email address as far as I&#39;m aware."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1546897511, "post_id": 54011124, "comment_id": 94998014, "body": "Which office are you using?"}, {"owner": {"reputation": 53, "user_id": 5270145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a29aef9c84e23e147df46cfde894b8be?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Guill", "link": "https://stackoverflow.com/users/5270145/nathan-guill"}, "edited": false, "score": 0, "creation_date": 1546898727, "post_id": 54011124, "comment_id": 94998490, "body": "Office 365 ProPlus using Outlook 2016"}], "owner": {"reputation": 53, "user_id": 5270145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a29aef9c84e23e147df46cfde894b8be?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Guill", "link": "https://stackoverflow.com/users/5270145/nathan-guill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1592694421, "creation_date": 1546452468, "last_edit_date": 1592694421, "question_id": 54011124, "link": "https://stackoverflow.com/questions/54011124/outlook-vba-runtime-error-13-when-setting-variable", "title": "Outlook VBA Runtime Error 13 when setting variable", "body": "<p>I have a VBA file that I've distributed to my coworkers and when my coworkers open Outlook, they get a run-time error 13 on the \"Set olRingsInboxItems\" line.  It works fine on my computer, so I'm at a complete loss.</p>\n\n<p>The following code is ThisOutlookSession:</p>\n\n<pre><code>Option Explicit\nPrivate WithEvents olRingsInboxItems As Outlook.Items\nPrivate Sub Application_Startup()\n  Dim oNameSpace As NameSpace\n  Set oNameSpace = Application.GetNamespace(\"MAPI\")\n  Set olRingsInboxItems = oNameSpace.Folders(\"Rings\").Folders(\"Inbox\").Items\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "selenium-webdriver"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1546451611, "post_id": 54010837, "comment_id": 94858589, "body": "&quot;how I can avoid the errors?&quot; - how can we know unless you describe those errors?  As for how to make this into a separate sub - there are only two variables in that code, so those would be obvious candidates as parameters in your sub."}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1546451830, "post_id": 54010837, "comment_id": 94858675, "body": "The errors related to selenium that those elements that need waiting time .. even with the existence of the Do Loop Until .. I have to click Resume to make the code work and resume work"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1546453683, "post_id": 54010837, "comment_id": 94859433, "body": "I have attached an error .. I think it is a matter of waiting as when I click Debug then Resume .. the code works after a while"}], "answers": [{"comments": [{"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1546455005, "post_id": 54011610, "comment_id": 94859933, "body": "Thanks a lot my tutor. I have a lot of elements with the same error .. so using such lines for each element will be painful ...!"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1546457450, "post_id": 54011610, "comment_id": 94860939, "body": "Thank you very much. I have attached an error after applying this change"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1546457589, "post_id": 54011610, "comment_id": 94860991, "body": "I will have a look. You have changed something as mine shouldn\u2019t throw an error due to the ugly all encompassing on error resume next."}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1546458217, "post_id": 54011610, "comment_id": 94861258, "body": "I have not changed anything. I have used the UDF as it is .. The drop down is a javascript element that filled with options .. is that make difference?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1546458504, "post_id": 54011610, "comment_id": 94861374, "body": "you have a sub. See my udf above."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1546459004, "post_id": 54011610, "comment_id": 94861594, "body": "I am confused. All errors are suppressed in the function and only a boolean returned. Not sure how you can generate that error with my code. You can always add an err.clear at the very end but I don&#39;t think that makes a difference."}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1546459484, "post_id": 54011610, "comment_id": 94861772, "body": "Most of times those drop down lists are empty and they are filled with options based on other drop lists .. Can the number of options checked too to make sure the drop down is ready for selecting from it?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1546459965, "post_id": 54011610, "comment_id": 94861942, "body": "yes.... and you have done something similar before...you use the FindElementsByCss .Count"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1546457254, "last_edit_date": 1546457254, "creation_date": 1546454879, "answer_id": 54011610, "question_id": 54010837, "link": "https://stackoverflow.com/questions/54010837/loop-until-element-equals-to-specific-text-in-drop-down/54011610#54011610", "title": "Loop until element equals to specific text in drop down", "body": "<p>This can happen when an action causes a change to the DOM. The lazy way is to add a timed loop to try for that element until that error goes away or time out reached. You could also try shifting the On Error to surround the loop instead of inside the loop and then add in a time out. This is a little brutal but without a webpage to test with.</p>\n\n<p>As a function call (this feels ugly and you may find webElements don't like being passed around):</p>\n\n<pre><code>Option Explicit\nPublic Sub test()\n    Const MAX_WAIT_SEC As Long = 30\n    'other code\n    If TextIsSet(dropdown, expectedText, MAX_WAIT_SEC) Then\n\n    End If\n\nEnd Sub\n\nPublic Function TextIsSet(ByRef dropdown As Object, ByVal expectedText As String, ByVal MAX_WAIT_SEC As Long) As Boolean\n    Dim t As Date\n    On Error Resume Next\n    t = Timer\n    Do\n        DoEvents\n        dropdown.AsSelect.SelectByText expectedText\n        If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n    Loop Until dropdown.AsSelect.SelectedOption.Text = expectedText\n    If dropdown.AsSelect.SelectedOption.Text = expectedText Then\n        TextIsSet = True\n    Else\n        TextIsSet = False\n    End If\n    On Error GoTo 0\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>I don't have a stale element test case so I just used a drop down test case:</p>\n\n<pre><code>Option Explicit\nPublic Sub test()\n    Const MAX_WAIT_SEC As Long = 30\n    Dim d As WebDriver, expectedText As String, dropdown As Object\n    'expectedText = \"AL - Alabama\"  ''Pass Case\n     expectedText = \"Bananaman\" 'Fail Case\n    Set d = New ChromeDriver\n\n    With d       \n        .get \"https://tools.usps.com/zip-code-lookup.htm?byaddress\"           \n        Set dropdown = .FindElementById(\"tState\")  \n        'other code\n        If TextIsSet(dropdown, expectedText, MAX_WAIT_SEC) Then\n            Debug.Print \"Tada\"\n        Else\n            Debug.Print \"Sigh\"\n        End If\n        .Quit\n    End With\nEnd Sub\n\nPublic Function TextIsSet(ByRef dropdown As Object, ByVal expectedText As String, ByVal MAX_WAIT_SEC As Long) As Boolean\n    Dim t As Date\n    On Error Resume Next\n    t = Timer\n    Do\n        DoEvents\n        dropdown.AsSelect.SelectByText expectedText\n        If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n    Loop Until dropdown.AsSelect.SelectedOption.Text = expectedText\n    If dropdown.AsSelect.SelectedOption.Text = expectedText Then\n        TextIsSet = True\n    Else\n        TextIsSet = False\n    End If\n    On Error GoTo 0\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1546460316, "creation_date": 1546451046, "last_edit_date": 1546460316, "question_id": 54010837, "link": "https://stackoverflow.com/questions/54010837/loop-until-element-equals-to-specific-text-in-drop-down", "title": "Loop until element equals to specific text in drop down", "body": "<p>I have the following piece of code</p>\n\n<pre><code>Do\n    On Error Resume Next\n    .FindElementById(\"ContentPlaceHolder1_DropDownListl2\").AsSelect.SelectByText (\"txt\")\n    On Error GoTo 0\nLoop Until .FindElementById(\"ContentPlaceHolder1_DropDownListl2\").AsSelect.SelectedOption.Text = \"txt\"\n</code></pre>\n\n<p>I have a lot of drop down lists that I deal with them with the same approach and although I used On Error Resume Next, I got errors sometimes and I have to wait a little and click Resume to resume the code execution\nCan I make this as public procedure as I will use such lines a lot with other elements?\nAnd how I can avoid the errors? and of course at the same time get my target for selecting the desired text in the drop down</p>\n\n<p>Here's a snapshot of one of the errors\n<a href=\"https://i.stack.imgur.com/HRlh2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HRlh2.png\" alt=\"enter image description here\"></a></p>\n\n<p>Based on @QHarr reply I tried to make a public procedure like that</p>\n\n<pre><code>Sub WaitElement(driver As Selenium.WebDriver, sElement As SelectElement, txt As String)\nDim t           As Date\nConst MAX_SEC   As Long = 30\n\nWith driver\n    On Error Resume Next\n        t = Timer\n        Do\n            DoEvents\n            sElement.AsSelect.SelectByText txt\n            If Timer - t &gt; MAX_SEC Then Exit Do\n        Loop Until sElement.AsSelect.SelectedOption.Text = txt\n    On Error GoTo 0\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n\n<p>But when trying to use it in that way</p>\n\n<pre><code>WaitElement bot, .FindElementById(\"ContentPlaceHolder1_DropDownListnat\"), ws.Range(\"B11\").Value\n</code></pre>\n\n<p>I got 'Run-time error 13' (Type mismatch)</p>\n\n<p>After applying the UDF named 'TextIsSet' I got this error \n<a href=\"https://i.stack.imgur.com/Ixv9v.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ixv9v.png\" alt=\"enter image description here\"></a></p>\n\n<p>and the same problem.. if I click on Debug then Resume then wait a little, the code resumes its work</p>\n\n<p>I have used such lines too but doesn't help</p>\n\n<pre><code>        Do\n    Loop While .FindElementsById(\"ContentPlaceHolder1_Dschool\").Count = 0\n</code></pre>\n\n<p>I got the same last error of not founding such an element</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10858992, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_TswFFA8UVU/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZoixr_7TbckSifdVJPoIJ86WTCTg/mo/photo.jpg?sz=128", "display_name": "Livio Spiegel", "link": "https://stackoverflow.com/users/10858992/livio-spiegel"}, "edited": false, "score": 0, "creation_date": 1546460065, "post_id": 54010903, "comment_id": 94861973, "body": "Thank you Tim. Works perfectly. Now one more thing: if I define a name for a field or a merged range, e.g. B3 named as &quot;field_seller&quot; and B8 as &quot;field_buyer&quot; while B8 is a merged range of B8:B9, how would I have to amend your script? I tried to replace B3 with the defined name but it did not work."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1546461324, "last_edit_date": 1546461324, "creation_date": 1546451373, "answer_id": 54010903, "question_id": 54010672, "link": "https://stackoverflow.com/questions/54010672/control-tab-key-behaviour-in-excel-with-vba/54010903#54010903", "title": "Control Tab-Key behaviour in Excel with VBA", "body": "<p>Something like this should work:</p>\n\n<pre><code>Sub TabIntercept()\n\n    Const TAB_ORDER As String = \"B3,B8,D3,E3,E6\" 'entry cell addresses in tab order\n    Dim arr, a, x, nxt, sel\n\n    If TypeName(Selection) &lt;&gt; \"Range\" Then Exit Sub 'Exit if (eg) a shape is selected\n    Set sel = Selection.Cells(1) 'if multiple cells selected use the first...\n\n    arr = Split(TAB_ORDER, \",\")\n    For x = LBound(arr) To UBound(arr)\n        If sel.Address(False, False) = arr(x) Then\n            'loops back to start if at end...\n            nxt = IIf(x = UBound(arr), LBound(arr), x + 1)\n            Range(arr(nxt)).Select\n            Exit For\n        End If\n    Next x\n\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT</strong>: using named ranges would be very similar - </p>\n\n<pre><code>Sub TabIntercept2()\n\n    Const TAB_ORDER As String = \"tabs1,tabs2,tabs3,tabs4,tabs5\"  'as named ranges\n    Dim arr, a, x, nxt, sel\n\n    If TypeName(Selection) &lt;&gt; \"Range\" Then Exit Sub 'Exit if (eg) a shape is selected\n    Set sel = Selection.Cells(1) 'if multiple cells selected use the first...\n\n    arr = Split(TAB_ORDER, \",\")\n    For x = LBound(arr) To UBound(arr)\n        If sel.Address() = sel.Parent.Range(arr(x)).Address() Then\n            'loops back to start if at end...\n            nxt = IIf(x = UBound(arr), LBound(arr), x + 1)\n            sel.Parent.Range(arr(nxt)).Select\n            Exit For\n        End If\n    Next x\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10858992, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_TswFFA8UVU/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZoixr_7TbckSifdVJPoIJ86WTCTg/mo/photo.jpg?sz=128", "display_name": "Livio Spiegel", "link": "https://stackoverflow.com/users/10858992/livio-spiegel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1232, "favorite_count": 0, "accepted_answer_id": 54010903, "answer_count": 1, "score": 0, "last_activity_date": 1566196126, "creation_date": 1546450224, "last_edit_date": 1566196126, "question_id": 54010672, "link": "https://stackoverflow.com/questions/54010672/control-tab-key-behaviour-in-excel-with-vba", "title": "Control Tab-Key behaviour in Excel with VBA", "body": "<p>I created a form in excel and now want to jump from cell to cell by pressing the tab key but only between cells in which the user shall enter the data. A solution is to lock the sheet and only leave the fields unlocked in which the user shall enter something. However, this doesn't work with fields containing merged cells (which I need) and it also struggles if a merged field is allocated over multiple lines located next to a \"single entry cell\". The tab key then simply jumps back to the previous cell and doesn't move forward.</p>\n\n<p>Therefore I need to \"manually\" control the behaviour of the tab key and came across the following code:</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n    Application.OnKey \"{TAB}\", \"TabIntercept\"\nEnd Sub\n\nPrivate Sub Worksheet_Deactivate()\n    Application.OnKey \"{TAB}\"\nEnd Sub\n</code></pre>\n\n<p>Above works to trigger an event when TabKey is pressed. Now I need help in writing the function TabIntercept to send the tab-key to the next entry-cell in my form. Say I have 5 fields in B3, B8, D3, E3, E6 in which data shall be entered.</p>\n\n<p>Can anyone help me with this?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "textbox", "powerpoint", "powerpoint2016"], "answers": [{"comments": [{"owner": {"reputation": 28, "user_id": 10858895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a42835fc2d0538c7da8f85468335a4e5?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Becker", "link": "https://stackoverflow.com/users/10858895/robert-becker"}, "edited": false, "score": 0, "creation_date": 1546624944, "post_id": 54028631, "comment_id": 94923409, "body": "Thanks it worked.   I turned the actual part that updates the text box into a sub function.  And I had to set it to look at the Master slides not just the Custom Layout children using <code>DSN.SlideMaster.Shapes</code>"}, {"owner": {"reputation": 28, "user_id": 10858895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a42835fc2d0538c7da8f85468335a4e5?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Becker", "link": "https://stackoverflow.com/users/10858895/robert-becker"}, "edited": false, "score": 0, "creation_date": 1546625122, "post_id": 54028631, "comment_id": 94923479, "body": "And I want to post the code I made but I can&#39;t figure out how."}], "tags": [], "owner": {"reputation": 301, "user_id": 6354194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhVfQ.png?s=128&g=1", "display_name": "konahn", "link": "https://stackoverflow.com/users/6354194/konahn"}, "is_accepted": true, "score": 2, "last_activity_date": 1546543720, "creation_date": 1546543720, "answer_id": 54028631, "question_id": 54010554, "link": "https://stackoverflow.com/questions/54010554/how-to-change-a-specific-textbox-in-a-powerpoint-slide-master/54028631#54028631", "title": "How to change a specific textbox in a powerpoint slide master", "body": "<p>You can use the object named 'ActivePresentation.Designs(x).SlideMaster.CustomLayouts' to access each custom-layout slide in SlideMaster Designs. (You can have more than 1 design in a presentation.) </p>\n\n<p>Accessing sub-objects in the custom-layout slides is just like dealing with those in the normal slides.</p>\n\n<p>I think you can try the following automation code:</p>\n\n<pre><code>Option Explicit\nOption Compare Text 'Ignore Upper/Lower case\n\nSub UpdateCustomLayouts()\n\n    Dim DSN As Design\n    Dim CL As CustomLayout\n    Dim shp As Shape\n    Dim mName As String, mCode As String, mPhone As String, fName As String\n\n    'First, change following variables before running this macro\n    mName = \"Your name\"\n    mCode = \"Your code\"\n    mPhone = \"0123456789\"\n    fName = ActivePresentation.Name\n\n    'Loop each customlayouts\n    For Each DSN In ActivePresentation.Designs\n        For Each CL In DSN.SlideMaster.CustomLayouts\n            For Each shp In CL.Shapes\n                If shp.HasTextFrame Then\n\n                    'find and update textboxes\n                    With shp.TextFrame.TextRange\n                        If .Text Like \"CONFIG. MGR:*\" Then\n                            .Text = \"CONFIG. MGR: \" &amp; mName &amp; \", \" &amp; mCode &amp; \", \" &amp; mPhone\n                        ElseIf .Text Like \"FILE NAME:*\" Then\n                            .Text = \"FILE NAME: \" &amp; fName\n                        End If\n                    End With\n\n                End If\n            Next shp\n        Next CL\n    Next DSN\n\nEnd Sub\n</code></pre>\n\n<p>As I mentioned, first change variables like 'mName, mCode, mPhone, fName' before running.</p>\n"}], "owner": {"reputation": 28, "user_id": 10858895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a42835fc2d0538c7da8f85468335a4e5?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Becker", "link": "https://stackoverflow.com/users/10858895/robert-becker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 950, "favorite_count": 0, "accepted_answer_id": 54028631, "answer_count": 1, "score": 0, "last_activity_date": 1546543720, "creation_date": 1546449539, "question_id": 54010554, "link": "https://stackoverflow.com/questions/54010554/how-to-change-a-specific-textbox-in-a-powerpoint-slide-master", "title": "How to change a specific textbox in a powerpoint slide master", "body": "<p>I have a powerpoint that uses different Master layouts on the slide Master.  Every time we do an update, a specific textbox on a specifc Master slides needs to be updated.  I would like to do so with a macro.</p>\n\n<p>IE I have a slide master with a Generic Title_Slide and 2 variations under that.  It has a \"Generic Bullet_slide\" with 10 variations under that.</p>\n\n<p>on the \"Generic Bullet_Slide\" there is a textbox that contains two lines:\n\"CONFIG. MGR:  [your name], [your code], [your phone #]\"\n\"FILE NAME: [name of file]\"</p>\n\n<p>every time we send the project out, we need to update the fields in [] manually.  If we forget its bad news.</p>\n\n<p>I have seen how to loop through all slides, then all shapes to find text boxes.  Can I find a boxs that specifically has those words in it (\"CONFIG. MGR:\" and \"FILE NAME:\") ?</p>\n\n<p>Can I search \"layout\" slides only?  how do I target anything on the layout slide instead of a normal slide?</p>\n\n<p>thanks a bunch.</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 4, "creation_date": 1546449340, "post_id": 54010492, "comment_id": 94857673, "body": "Which line of code is causing the error?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1546449624, "post_id": 54010492, "comment_id": 94857788, "body": "I don&#39;t see any validation of the values you&#39;re setting fields to at all. It could be any of the <i>213 fields</i> in your table, so without knowing the schema of the table and the data you&#39;re trying to import, this is likely unanswerable."}, {"owner": {"reputation": 3, "user_id": 10858762, "user_type": "registered", "profile_image": "https://graph.facebook.com/2193613614066606/picture?type=large", "display_name": "Bram Agterberg", "link": "https://stackoverflow.com/users/10858762/bram-agterberg"}, "edited": false, "score": 0, "creation_date": 1546449855, "post_id": 54010492, "comment_id": 94857878, "body": "I&#39;m not sure where to find this, when i use the debugging function this code is skipped automatically.."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1546449877, "post_id": 54010492, "comment_id": 94857884, "body": "Use Parameters for your values, see: <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/append-and-createparameter-methods-example-vb?view=sql-server-2017\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/sql/ado/reference/ado-api/&hellip;</a>"}, {"owner": {"reputation": 3, "user_id": 10858762, "user_type": "registered", "profile_image": "https://graph.facebook.com/2193613614066606/picture?type=large", "display_name": "Bram Agterberg", "link": "https://stackoverflow.com/users/10858762/bram-agterberg"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1546449920, "post_id": 54010492, "comment_id": 94857901, "body": "@comintern would it help to add all fields like this instead of the loop?:    &#39;.AddNew &#39;.Fields(&quot;Id&quot;).Value = Arec1 &#39;.Fields(&quot;Surname&quot;).Value = Arec2 &#39;.Fields(&quot;FirstName&quot;).Value = Arec3 &#39;.Fields(&quot;Address&quot;).Value = Arec4 &#39;.Fields(&quot;Phone&quot;).Value = Arec5 &#39; .Fields(&quot;Mobile&quot;).Value = Arec6 &#39;.Fields(&quot;Email&quot;).Value = Arec7 &#39;.Update &#39;End With"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 1, "creation_date": 1546449928, "post_id": 54010492, "comment_id": 94857903, "body": "Turn off your error handler temporarily to see where the error pops up. E.g. comment this out <code>On Error GoTo errHandler:</code>"}, {"owner": {"reputation": 3, "user_id": 10858762, "user_type": "registered", "profile_image": "https://graph.facebook.com/2193613614066606/picture?type=large", "display_name": "Bram Agterberg", "link": "https://stackoverflow.com/users/10858762/bram-agterberg"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 1, "creation_date": 1546450134, "post_id": 54010492, "comment_id": 94857986, "body": "@ryanwildry my error occurs in the following line:    rst(Cells(1, i).Value) = Me.Controls(&quot;Arec&quot; &amp; i).Value"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1546450242, "post_id": 54010492, "comment_id": 94858039, "body": "It&#39;s a type error. You need to define the types for each field, take a look at the link I shared in my earlier comment."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1546450599, "post_id": 54010492, "comment_id": 94858190, "body": "The method you use to add the fields doesn&#39;t matter - what matters is that one of them doesn&#39;t match the expected type. The only way you&#39;re going to find it is by stepping through it with a debugger, comparing each value to your schema, and catching the one with the wrong data type.  Nobody here can do that, because we don&#39;t know the schema, and we don&#39;t know the data you&#39;re trying to put into that schema."}, {"owner": {"reputation": 3, "user_id": 10858762, "user_type": "registered", "profile_image": "https://graph.facebook.com/2193613614066606/picture?type=large", "display_name": "Bram Agterberg", "link": "https://stackoverflow.com/users/10858762/bram-agterberg"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1546459629, "post_id": 54010492, "comment_id": 94861827, "body": "@RyanWildry first of all thanks for your reply, so what I need to do is: -Open command object with one parameter; -Get parameter value and append parameter;- Create recordset by executing the command. After doing this, with the steps from the link you have sent me, it should work?"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1546459864, "post_id": 54010492, "comment_id": 94861913, "body": "@BramAgterberg, yes exactly. You want to ensure the types match. If you want a helper function to make it easy, try this -- &gt; <a href=\"https://codereview.stackexchange.com/a/46346/108307\">codereview.stackexchange.com/a/46346/108307</a>"}, {"owner": {"reputation": 3, "user_id": 10858762, "user_type": "registered", "profile_image": "https://graph.facebook.com/2193613614066606/picture?type=large", "display_name": "Bram Agterberg", "link": "https://stackoverflow.com/users/10858762/bram-agterberg"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1546463837, "post_id": 54010492, "comment_id": 94863497, "body": "@RyanWildry I can&#39;t get it working, is there any way how you can help me?  The Select  TypeName is not doing anything"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1546464016, "post_id": 54010492, "comment_id": 94863573, "body": "@BramAgterberg I&#39;ll post an answer with an approach that might help later tonight."}, {"owner": {"reputation": 3, "user_id": 10858762, "user_type": "registered", "profile_image": "https://graph.facebook.com/2193613614066606/picture?type=large", "display_name": "Bram Agterberg", "link": "https://stackoverflow.com/users/10858762/bram-agterberg"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1546464164, "post_id": 54010492, "comment_id": 94863639, "body": "@RyanWildry thanks in advance, it would help me a lot!"}, {"owner": {"reputation": 3, "user_id": 10858762, "user_type": "registered", "profile_image": "https://graph.facebook.com/2193613614066606/picture?type=large", "display_name": "Bram Agterberg", "link": "https://stackoverflow.com/users/10858762/bram-agterberg"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1546466610, "post_id": 54010492, "comment_id": 94864577, "body": "@RyanWildry I&#39;m currently doing it like this:      rst.AddNew     rst.Fields(&quot;Id&quot;).value = Arec1     rst.Fields(&quot;G-TAGName&quot;).value = Arec2     rst.Fields(&quot;G-EquipmentType&quot;).value = Arec3     rst.Fields(&quot;G-EquipmentFamily&quot;).value = Arec4 &#39;etc..      rst.Fields(&quot;O-Density (kg/m3)&quot;).value = Arec18     rst.Update  The error no occurs at Arec18, which is an number type in my Acces DB. Which is strange, because the first field is also an number type an works fine..  When I know how to change the fieldtypes in here i can manually state all the fields instead of looping it, i guess"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10858762, "user_type": "registered", "profile_image": "https://graph.facebook.com/2193613614066606/picture?type=large", "display_name": "Bram Agterberg", "link": "https://stackoverflow.com/users/10858762/bram-agterberg"}, "edited": false, "score": 0, "creation_date": 1546508223, "post_id": 54015388, "comment_id": 94875240, "body": "I applied your code to my context, it seems to have solved the type error. When i try to run my userform i get an &#39;&#39;error 3265 item not found in this collection&#39;&#39;. The error occurs in the following line of code:  rst(Cells(1, L).value) = Me.Controls(&quot;Arec&quot; &amp; L).value   Which is part of the following loop:  &#39;send the data     rst.AddNew     For L = 1 To 211     rst(Cells(1, L).value) = Me.Controls(&quot;Arec&quot; &amp; L).value     Next L     rst.Update"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 3, "user_id": 10858762, "user_type": "registered", "profile_image": "https://graph.facebook.com/2193613614066606/picture?type=large", "display_name": "Bram Agterberg", "link": "https://stackoverflow.com/users/10858762/bram-agterberg"}, "edited": false, "score": 0, "creation_date": 1546518696, "post_id": 54015388, "comment_id": 94880663, "body": "Well that&#39;s progress. This error is new, it means the field name doesn&#39;t match the field name in the database. Check your database to ensure each field name or index exists in the database. You can print out the field names in the <code>Fields</code> to see what&#39;s up. At this point it is starting to sound like a new question, if you are still having trouble I&#39;d recommend creating a new question for this one."}, {"owner": {"reputation": 3, "user_id": 10858762, "user_type": "registered", "profile_image": "https://graph.facebook.com/2193613614066606/picture?type=large", "display_name": "Bram Agterberg", "link": "https://stackoverflow.com/users/10858762/bram-agterberg"}, "edited": false, "score": 0, "creation_date": 1546538634, "post_id": 54015388, "comment_id": 94891366, "body": "thanks for your help! It&#39;s starting to come together with declaring the Arec(textboxes) and defining them as ArecInt, ArecText etc. When I needed I&#39;ll post a new question."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 3, "user_id": 10858762, "user_type": "registered", "profile_image": "https://graph.facebook.com/2193613614066606/picture?type=large", "display_name": "Bram Agterberg", "link": "https://stackoverflow.com/users/10858762/bram-agterberg"}, "edited": false, "score": 0, "creation_date": 1546538964, "post_id": 54015388, "comment_id": 94891518, "body": "Glad it helped, if this helped resolve your original question. Please consider marking as the accepted answer."}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": true, "score": 0, "last_activity_date": 1546480138, "creation_date": 1546480138, "answer_id": 54015388, "question_id": 54010492, "link": "https://stackoverflow.com/questions/54010492/what-causes-the-2147352571-type-mismatch-error-in-vba-userform/54015388#54015388", "title": "What causes the -2147352571 type mismatch error in VBA userform?", "body": "<p>As stated in the comments here is an approach that I hope at least gets you closer to your end goal.</p>\n\n<p>A bit of background on my setup, as this code won't necessarily be a drop in and it works. </p>\n\n<p>I have a table in an Access file, with the following schema.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>+---------------+--------------+\r\n| FieldName     | FieldType    |\r\n+---------------+--------------+\r\n| DateField     | Date         |\r\n+---------------+--------------+\r\n| TextField     | ShortText    |\r\n+---------------+--------------+\r\n| LongIntField  | Long Integer |\r\n+---------------+--------------+\r\n| DoubleField   | Double       |\r\n+---------------+--------------+\r\n| IntField      | Integer      |\r\n+---------------+--------------+\r\n| CurrencyField | Currency     |\r\n+---------------+--------------+\r\n| LongTextField | LongText     |\r\n+---------------+--------------+\r\n| ByteField     | Byte         |\r\n+---------------+--------------+\r\n| DecimalField  | Decimal      |\r\n+---------------+--------------+\r\n| YesNoField    | Boolean      |\r\n+---------------+--------------+</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I have a row to insert on Sheet1 of Excel. My headers are on Row 1, with the values on Row 2. I use the <code>FieldName</code> to locate the <code>Field</code> in the <code>Fields</code> Collection to be able to determine the type and get the appropriate value needed to add to the database.</p>\n\n<p>Here is the code:</p>\n\n<hr>\n\n<pre><code>Private ErrorCollection As Collection\n\n'Probably overkill, but I found added all the ADO Field Types\nPublic Enum ADOFieldTypes\n    adArray = 8192\n    adBigInt = 20\n    adBinary = 128\n    adBoolean = 11\n    adBSTR = 8\n    adChapter = 136\n    adChar = 129\n    adCurrency = 6\n    adDate = 7\n    adDBDate = 133\n    adDBTime = 134\n    adDBTimeStamp = 135\n    adDecimal = 14\n    adDouble = 5\n    adEmpty = 0\n    adError = 10\n    adFileTime = 64\n    adGUID = 72\n    adIDispatch = 9\n    adInteger = 3\n    adIUnknown = 13\n    adLongVarBinary = 205\n    adLongVarChar = 201\n    adLongVarWChar = 203\n    adNumeric = 131\n    adPropVariant = 138\n    adSingle = 4\n    adSmallInt = 2\n    adTinyInt = 16\n    adUnsignedBigInt = 21\n    adUnsignedInt = 19\n    adUnsignedSmallInt = 18\n    adUnsignedTinyInt = 17\n    adUserDefined = 132\n    adVarBinary = 204\n    adVarChar = 200\n    adVariant = 12\n    adVarNumeric = 139\n    adVarWChar = 202\n    adWChar = 130\nEnd Enum\n\nPublic Sub DBExample()\n    Const ConnectionString As String = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=YOURPATHGOESHERE\"\n    Const SQL As String = \"Select * from [Example] where id = 1\" ' Simple query that returns all fields for the insert\n    Set ErrorCollection = New Collection\n\n    Dim conn            As ADODB.connection: Set conn = New ADODB.connection\n    Dim rst             As ADODB.Recordset: Set rst = New ADODB.Recordset\n    Dim ws              As Excel.Worksheet: Set ws = ThisWorkbook.Sheets(\"Sheet1\")\n    Dim i               As Long\n    Dim Fields          As ADODB.Fields\n    Dim FieldName       As String\n    Dim FieldValue      As Variant\n    Dim FieldType       As Long\n    Dim ErrorString     As String\n    Dim ErrorItem       As Variant\n\n    conn.Open ConnectionString\n    rst.Open SQL, conn, adOpenForwardOnly, adLockOptimistic\n    Set Fields = rst.Fields 'Get all the fields for the Database Table\n\n    rst.AddNew\n    For i = 1 To 10\n        FieldName = ws.Cells(1, i).Value2 'Get the FieldName\n        FieldType = rst.Fields(ws.Cells(1, i).Value2).Type 'Get the Field's Type from ADODB\n        FieldValue = ws.Cells(2, i).Value2 'Get the value to update\n        rst.Fields(FieldName).Value = getFieldValue(FieldType, FieldValue, FieldName) 'Assign the value\n    Next\n\n    'If, and only if there are no errors, update the DB\n    If ErrorCollection.Count = 0 Then\n        rst.Update\n    Else\n        'Print out error descriptions, which fields are still having issues?\n        For Each ErrorItem In ErrorCollection\n            ErrorString = ErrorItem &amp; vbNewLine &amp; ErrorString\n        Next\n\n        Debug.Print ErrorString\n    End If\n\n    conn.close\nEnd Sub\n\n'This maps the field type, and coverts the Excel value to that type\n'I've only included the types I thought were most relevant for MS Access\n'My Database has the following Type in a table: Date, ShortText, Long, Double, Integer, Decimal, Byte, Boolean (Yes/No), Currency, LongText\nPrivate Function getFieldValue(FieldType As ADOFieldTypes, FieldValue As Variant, FieldName As String) As Variant\nOn Error GoTo errorHandler:\n\n    Select Case FieldType\n        Case adDate\n            getFieldValue = CDate(FieldValue)\n        Case adVarWChar\n            getFieldValue = FieldValue\n        Case adInteger\n            getFieldValue = CLng(FieldValue)\n        Case adDouble\n            getFieldValue = CDbl(FieldValue)\n        Case adSmallInt\n            getFieldValue = CInt(FieldValue)\n        Case adCurrency\n             getFieldValue = CCur(FieldValue)\n        Case adLongVarWChar\n            getFieldValue = FieldValue\n        Case adUnsignedTinyInt\n            getFieldValue = CByte(FieldValue)\n        Case adNumeric\n            getFieldValue = CDec(FieldValue)\n        Case adBoolean\n            getFieldValue = CBool(FieldValue)\n    End Select\n\n    Exit Function\n\nerrorHandler:\n    'This will return the FieldType Enum value, you can reference the number returned to ADOFieldTypes\n    ErrorCollection.Add \"Could not add \" &amp; FieldName &amp; \" with value: \" &amp; FieldValue &amp; \" it has a type of \" &amp; FieldType\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10858762, "user_type": "registered", "profile_image": "https://graph.facebook.com/2193613614066606/picture?type=large", "display_name": "Bram Agterberg", "link": "https://stackoverflow.com/users/10858762/bram-agterberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 0, "accepted_answer_id": 54015388, "answer_count": 1, "score": 0, "last_activity_date": 1546480138, "creation_date": 1546449274, "question_id": 54010492, "link": "https://stackoverflow.com/questions/54010492/what-causes-the-2147352571-type-mismatch-error-in-vba-userform", "title": "What causes the -2147352571 type mismatch error in VBA userform?", "body": "<p>Currently I'm working on a Access-Excel connection with an userform. Within this userform data needs to be exported from Excel to Access. The following error occurs (vba error --2147352571 type mismatch) and i can't find where the problem is in my code assigned to the export button. This is my code:</p>\n\n<pre><code>Private Sub cmdAdd_Click()\n\nDim cnn As ADODB.Connection 'dim the ADO collection class\nDim rst As ADODB.Recordset 'dim the ADO recordset class\nDim dbPath\nDim x As Long, i As Long\n'Error handler\nOn Error GoTo errHandler:\n\ndbPath = ActiveSheet.Range(\"I9\").Value\n\nSet cnn = New ADODB.Connection ' Initialise the collection class variable\n\n'Connection class is equipped with a \u2014method\u2014 named Open\n'\u2014-4 aguments\u2014- ConnectionString, UserID, Password, Options\n'ConnectionString formula\u2014-Key1=Value1;Key2=Value2;Key_n=Value_n;\n cnn.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; dbPath\n\n'ADO library is equipped with a class named Recordset\n Set rst = New ADODB.Recordset 'assign memory to the recordset\n\n'ConnectionString Open '\u2014-5 aguments\u2014-\n'Source, ActiveConnection, CursorType, LockType, Options\n rst.Open Source:=\"TAGInformation\", ActiveConnection:=cnn, _\n CursorType:=adOpenDynamic, LockType:=adLockOptimistic, _\n Options:=adCmdTable\n\n 'send the data\n   rst.AddNew\n   For i = 1 To 213\n   rst(Cells(1, i).Value) = Me.Controls(\"Arec\" &amp; i).Value\n   Next i\n   rst.Update\n\n 'update for the next ID\n Sheet1.Range(\"K9\").Value = Arec1.Value + 1\n\n 'clear the userform values\n For x = 1 To 213\n Me.Controls(\"Arec\" &amp; x).Value = \"\"\n Next\n\n 'add the next user ID\n Me.Arec1 = Sheet1.Range(\"K9\").Value\n ' Close the connection\n rst.Close\n cnn.Close\n Set rst = Nothing\n Set cnn = Nothing\n\n 'commuinicate with the user\n MsgBox \" The data has been successfully sent to the access database\"\n On Error GoTo 0\n Exit Sub\n errHandler:\n Set rst = Nothing\n Set cnn = Nothing\n MsgBox \"Error \" &amp; Err.Number &amp; \" (\" &amp; Err.Description &amp; \") in procedure \n cmdAdd\"\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "form-fields", "word-table"], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1546466949, "creation_date": 1546466949, "answer_id": 54013825, "question_id": 54010165, "link": "https://stackoverflow.com/questions/54010165/getting-an-error-trying-to-insert-field-in-a-word-table-cell/54013825#54013825", "title": "Getting an error trying to insert field in a Word table cell", "body": "<p>There are situations when Word is not able to insert something because the current selection does not support that kind of object. If it's tried in the Word interface, as a user, an error message will appear to that effect... Or Word will simply do a \"best guess\" and create the object in the nearest valid position.</p>\n\n<p>The object model (VBA) isn't always so forgiving and will simply refuse, often with a not so informative error message.</p>\n\n<p>In this case, an entire table cell is selected and Word is unable to create a form field within the cell structures (as opposed to within the text area of the cell). Reducing the selection to a single point (blinking insertion point / cursor) will allow creating the form field. The <code>Collapse</code> method can do this, as the following code sample demonstrates:</p>\n\n<pre><code>doc.Tables(3).Rows(10).Cells(2).Select\nSelection.Collapse wdCollapseStart \nSet tmpField = Selection.FormFields.Add(Range:=Selection.Range, Type:=wdFieldFormTextInput)\ntmpField.Name = \"Ducks\"       \n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 10858654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca37cb5f95b5efd1f678c731e522ce4d?s=128&d=identicon&r=PG&f=1", "display_name": "Ahotch", "link": "https://stackoverflow.com/users/10858654/ahotch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "accepted_answer_id": 54013825, "answer_count": 1, "score": 1, "last_activity_date": 1581177105, "creation_date": 1546447846, "last_edit_date": 1581177105, "question_id": 54010165, "link": "https://stackoverflow.com/questions/54010165/getting-an-error-trying-to-insert-field-in-a-word-table-cell", "title": "Getting an error trying to insert field in a Word table cell", "body": "<p>I create a formfield (textinput), and when I go to name it I get:\n<strong>91\nObject variable or With block variable not set</strong></p>\n\n<p>There are dozens of other places in this macro where I do the same exact thing and it works fine.  Here is the code:</p>\n\n<pre><code>Private Sub IRPMs()\nDim objCon As New ADODB.Connection\nDim rs As New ADODB.Recordset\nDim i, j, k As Integer\nDim tmpField As FormField\nDim strOut As String\n\nSet doc = ActiveDocument\ni = 0\nj = 1\nk = 0\n\nCall grabInfo\n\nstrFieldName(1) = \"Property:  \"\nstrFieldName(2) = \"General Liability:  \"\nstrFieldName(3) = \"Auto Liability:  \"\nstrFieldName(4) = \"Auto Phys Dam:  \"\nstrFieldName(5) = \"Inland Marine:  \"\n\n'' Remove document protection, if necessary\nIf doc.ProtectionType &lt;&gt; wdNoProtection Then doc.Unprotect\n\nOn Error GoTo IRPMerror\n\ndoc.Tables(3).Rows(9).Cells(2).Select\nSelection.Delete\ndoc.Tables(3).Rows(10).Cells(2).Select\nSelection.Delete\n\nstrSQL = \"redacted\"\n\nobjCon.Open \"redacted\"\n\nrs.Open strSQL, objCon\n\nIf Not rs.EOF Then\n    For k = 0 To 4\n        If rs(k) &lt;&gt; \"\" Then i = i + 1\n    Next\n\n    doc.Tables(3).Rows(9).Cells(2).Select\n\n    If i = 0 Then\n        Selection.EndKey unit:=wdLine\n\n        Set tmpField = Selection.FormFields.Add(Range:=Selection.Range, Type:=wdFieldFormTextInput)\n        tmpField.Name = \"irpms1\"\n    Else\n        For k = 0 To 4\n            If rs(k) &lt;&gt; \"\" Then\n                Selection.InsertAfter (strFieldName(j))\n                Selection.EndKey unit:=wdLine\n\n                Set tmpField = Selection.FormFields.Add(Range:=Selection.Range, Type:=wdFieldFormTextInput)\n                tmpField.Name = \"irpms\" &amp; j\n\n                If j &lt;= i And j &lt; 5 Then\n                    Selection.InsertAfter Chr(11)\n                End If\n\n                strOut = rs(k)\n                If Left(strOut, 1) = \".\" Then strOut = \"0\" &amp; strOut\n\n                doc.FormFields(\"irpms\" &amp; j).Result = strOut\n            End If\n\n            j = j + 1\n        Next\n    End If\nElse\n    Selection.EndKey unit:=wdLine\n\n    Set tmpField = Selection.FormFields.Add(Range:=Selection.Range, Type:=wdFieldFormTextInput)\n    tmpField.Name = \"irpms1\"\nEnd If\n\nrs.Close\n\nstrSQL = \"redacted\"\n\n'rs.CursorLocation = adUseClient        ' I've tried with and without setting the cursor\nrs.Open strSQL, objCon, adOpenDynamic\n\nMsgBox (rs.RecordCount)\ni = rs.RecordCount\n\nIf Not rs.EOF Then\n    rs.MoveFirst\n\n    doc.Tables(3).Rows(10).Cells(2).Select\n\n    Set tmpField = Selection.FormFields.Add(Range:=Selection.Range, Type:=wdFieldFormTextInput)\n    tmpField.Name = \"Ducks\"         ' This is merely for testing; throws the error\n\n    If i = 1 Then\n        Selection.EndKey unit:=wdLine\n\n        Set tmpField = Selection.FormFields.Add(Range:=Selection.Range, Type:=wdFieldFormTextInput)\n        tmpField.Name = \"devi1\"\n    Else\n        For k = 1 To i\n            Set tmpField = Selection.FormFields.Add(Range:=Selection.Range, Type:=wdFieldFormTextInput)\n            tmpField.Name = \"devi\" &amp; k\n\n            'doc.FormFields(\"devi\" &amp; k).Result = rs(0) &amp; \" Deviations: \" &amp; rs(1)\n\n            If k &lt;&gt; rs.RecordCount Then\n                Selection.InsertAfter (Chr(11))\n            End If\n\n            rs.MoveNext\n        Next\n    End If\nEnd If\n\nGoTo IRPMexiter\n\nIRPMerror:\nMsgBox (\"IRPM\" &amp; vbCrLf &amp; Err.Number &amp; vbCrLf &amp; Err.Description)\nGoTo IRPMexiter\n\nIRPMexiter:\nIf Not rs Is Nothing Then Set rs = Nothing\nIf rs.State Then rs.Close\nIf Not objCon Is Nothing Then Set objCon = Nothing\nIf objCon.State Then objCon.Close\n\nIf doc.ProtectionType = wdNoProtection Then doc.Protect Type:=wdAllowOnlyFormFields, noreset:=True, Password:=\"\"\n\nIf Err Then End\n\nExit Sub\n</code></pre>\n\n<p>SQL and connection parameters have been redacted, they don't seem to have any issues.  \"grabInfo\" retrieves data from the document properties to pass into the SQL.  \"doc\" is declared publicly elsewhere.</p>\n\n<p>So, it runs through the first part fine, and has for over a month now.  After the rs is closed and reopened, it doesn't like me using \"tmpfield\" anymore.</p>\n\n<p>I appreciate any advice.  First post, so please let me know if I can improve my question or if I broke any rules.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1546448361, "post_id": 54010017, "comment_id": 94857257, "body": "You should break out that logic into a separate <code>Sub</code>. It&#39;s identical, so it should be in only one place. The order in checking the options (CE and ME vs ME and CE) should be irrelevant."}, {"owner": {"reputation": 87, "user_id": 10852647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725bf619f278bad05840ac7d0cb23a67?s=128&d=identicon&r=PG&f=1", "display_name": "MJ98", "link": "https://stackoverflow.com/users/10852647/mj98"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1546448468, "post_id": 54010017, "comment_id": 94857301, "body": "Hi Peter, thank you for your reply. As shown above I have put them in to different subs, or am I mistunderstanding? Sorry my skills within VBA are very limited."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1546449265, "post_id": 54010017, "comment_id": 94857643, "body": "You could give just a &quot;Yes&quot; option.  A &quot;No&quot; option being the option box not clicked.  The option buttons have a <code>GroupName</code> property - only one button with the same <code>GroupName</code> can be &quot;Yes&quot; at a time (a Null value in that property is a group as well)."}, {"owner": {"reputation": 87, "user_id": 10852647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725bf619f278bad05840ac7d0cb23a67?s=128&d=identicon&r=PG&f=1", "display_name": "MJ98", "link": "https://stackoverflow.com/users/10852647/mj98"}, "edited": false, "score": 0, "creation_date": 1546449439, "post_id": 54010017, "comment_id": 94857715, "body": "Thank you, Darren! Very much Appreciated."}], "answers": [{"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 1, "last_activity_date": 1546448759, "creation_date": 1546448759, "answer_id": 54010371, "question_id": 54010017, "link": "https://stackoverflow.com/questions/54010017/deselecting-option-buttons-when-selected-together/54010371#54010371", "title": "Deselecting option buttons when selected together", "body": "<p>Your logic for checking the option buttons is identical, so it should be isolated into a separate function. In this way, you remain consistent in your logic and if something needs to be adjusted, it's all in one place.</p>\n\n<pre><code>Private Sub optFMME_Click()\n    LogicCheck\nEnd Sub\n\nPrivate Sub optFMCE_Click()\n    LogicCheck\nEnd Sub\n\nPrivate Sub LogicCheck()\n    If Me.optFMCE And Me.optFMME Then\n        MsgBox \"Mech Eng and Chem Eng cannot be selected together \" &amp; _\n               \"due to similar material. Please select another combination.\"\n        Me.optFMCE = False\n        Me.optFMME = False\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 10852647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725bf619f278bad05840ac7d0cb23a67?s=128&d=identicon&r=PG&f=1", "display_name": "MJ98", "link": "https://stackoverflow.com/users/10852647/mj98"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 54010371, "answer_count": 1, "score": 2, "last_activity_date": 1566196130, "creation_date": 1546447328, "last_edit_date": 1566196130, "question_id": 54010017, "link": "https://stackoverflow.com/questions/54010017/deselecting-option-buttons-when-selected-together", "title": "Deselecting option buttons when selected together", "body": "<p>on my UserForm, I have created option buttons adjacent to the topic I want my users to choose i.e. if they choose \"mechanical engineering\" there is a \"yes\" option button or a \"no\" option button to the right of it. However, users cannot select classes \"mechanical engineering\" and \"chemical engineering\" together. I have entered the first code below which works. However, it only works if option button \"Me.optFMME\" and then \"Me.optFMCE\" in that order. If you choose them in the other order i.e.\"Me.optFMCE\"  and then \"Me.optFMME\", it allows it. So, I entered code (the second one undernearth it) to counteract this but it doesn't do anything. </p>\n\n<p>Please if anyone has any guidance, it would be much appreciated. </p>\n\n<pre><code>Private Sub optFMME_Click()\n\n    If Me.optFMME And Me.optFMCE Then\n        MsgBox \"Mech Eng and Chem Eng cannot be selected together due to similar     material. Please select another combination.\"\n        Me.optFMME = False\n        Me.optFMCE = False\n    End If\nEnd Sub\n\n`\n\nPrivate Sub optFMCE_Click()\n\n    If Me.optFMCE And Me.optFMME Then\n        MsgBox \"Mech Eng and Chem Eng cannot be selected together due to similar     material. Please select another combination.\"\n        Me.optFMCE = False\n        Me.optFMME = False\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "sorting", "combobox"], "answers": [{"tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 1, "last_activity_date": 1546449728, "creation_date": 1546449728, "answer_id": 54010584, "question_id": 54009990, "link": "https://stackoverflow.com/questions/54009990/sort-combobox-alphabetically-vba-excel/54010584#54010584", "title": "Sort Combobox alphabetically vba excel", "body": "<p>Use a data structure that support sorting to first capture the data, sort it, then add to your Listbox. I've shown how to add and sort in the below code.</p>\n\n<pre><code>Sub SortAnArrayList()\n    Dim ArrayList As Object\n    Dim ArrayItem As Variant\n\n    Set ArrayList = CreateObject(\"System.Collections.ArrayList\")\n\n    With ArrayList\n        .Add \"b\"\n        .Add \"c\"\n        .Add \"a\"\n        .Sort\n    End With\n\n    For Each ArrayItem In ArrayList\n        Debug.Print ArrayItem\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 223, "user_id": 5132818, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/FsnGv.jpg?s=128&g=1", "display_name": "xAminex", "link": "https://stackoverflow.com/users/5132818/xaminex"}, "edited": false, "score": 0, "creation_date": 1546525184, "post_id": 54015081, "comment_id": 94884357, "body": "Thanks @Dy.Lee for you answer I used xlFilterinplace in excel and solved the problem . i read your answer and it&#39;s seems to be working. I&#39;m gonna set it as the right answer."}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": true, "score": 1, "last_activity_date": 1546478115, "last_edit_date": 1546478115, "creation_date": 1546477076, "answer_id": 54015081, "question_id": 54009990, "link": "https://stackoverflow.com/questions/54009990/sort-combobox-alphabetically-vba-excel/54015081#54015081", "title": "Sort Combobox alphabetically vba excel", "body": "<p>Try</p>\n\n<pre><code>Sub Fill_EightD_D1_CB1()\n\n    With EightD.EightD_D1_CB1\n        .ColumnCount = 2        ' 2 colonnes\n        .ColumnWidths = \"-1;0\"  ' dont une de masquee\n\n    End With\n    Dim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"D1\")\n    Dim LC As Long\n    Dim i As Long, r As Long, j As Long\n    Dim vDB As Variant, vR(), vtemp(1 To 2)\n\n    LC = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row\n    vDB = ws.Range(\"a2\", \"a\" &amp; LC)\n    r = UBound(vDB, 1)\n    ReDim vR(1 To r, 1 To 2)\n    For i = 1 To r\n        vR(i, 1) = vDB(i, 1)\n        vR(i, 2) = i + 1\n    Next i\n    For i = 1 To r\n        For j = 1 To r\n            If vR(i, 1) &lt; vR(j, 1) Then\n                vtemp(1) = vR(i, 1)\n                vtemp(2) = vR(i, 2)\n                vR(i, 1) = vR(j, 1)\n                vR(i, 2) = vR(j, 2)\n                vR(j, 1) = vtemp(1)\n                vR(j, 2) = vtemp(2)\n            End If\n        Next j\n    Next i\n    EightD.EightD_D1_CB1.List = vR\n    'show always the first element\n    EightD.EightD_D1_CB1.ListIndex = 0\n    'Bold Text EightD_D1_CB1\n    EightD.EightD_D1_CB1.Font.Bold = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 223, "user_id": 5132818, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/FsnGv.jpg?s=128&g=1", "display_name": "xAminex", "link": "https://stackoverflow.com/users/5132818/xaminex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 993, "favorite_count": 0, "accepted_answer_id": 54015081, "answer_count": 2, "score": 0, "last_activity_date": 1566196137, "creation_date": 1546447213, "last_edit_date": 1566196137, "question_id": 54009990, "link": "https://stackoverflow.com/questions/54009990/sort-combobox-alphabetically-vba-excel", "title": "Sort Combobox alphabetically vba excel", "body": "<p>I'm bulting a small programm with vba Excel. My Comboxbox is filled from an excel sheet. I want to build some controls like \"add / delete items\" to add other items to my Combobox that why i need to know the row number for each item on my combobox. my code is capable of doing this but i still don't know how to sort the items alphabetically before adding them to the combobox ( see my code below) can you help please ? thanks in advance </p>\n\n<p><pre></p>\n\n<code>Sub Fill_EightD_D1_CB1()\n\nWith EightD.EightD_D1_CB1\n    .ColumnCount = 2        ' 2 colonnes\n    .ColumnWidths = \"-1;0\"  ' dont une de masqu\u00e9e\n\nEnd With\n\nDim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"D1\")\nDim LC As Long\nDim i As Long\n\nLC = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row\n\nFor i = 2 To LC\n\n    If ws.Cells(i, 1) &lt;&gt; \"\" Then\n    EightD.EightD_D1_CB1.AddItem ws.Cells(i, 1).Value\n    EightD.EightD_D1_CB1.List(EightD.EightD_D1_CB1.ListCount - 1, 1) = Mid(ws.Cells(i, 1).Address(False, False), 2, 1) \n\n    End If\nNext i\n\n'show always the first element\nEightD.EightD_D1_CB1.ListIndex = 0\n\n'Bold Text EightD_D1_CB1\nEightD.EightD_D1_CB1.Font.Bold = True\n\nEnd Sub\n</code></pre>\n\n<p></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1546448692, "post_id": 54009916, "comment_id": 94857398, "body": "Just remove the second <code>AM1.Show</code>. You never hide AM1 it in the first place. Additionally you do not really use userforms in the right way as you seem to use the global default instance and are not aware of it."}], "answers": [{"tags": [], "owner": {"reputation": 266, "user_id": 10860682, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1p8ShEHvmxM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYrC6ksVVo648mB97KGqwtUjVNJrA/mo/photo.jpg?sz=128", "display_name": "RCL", "link": "https://stackoverflow.com/users/10860682/rcl"}, "is_accepted": false, "score": 1, "last_activity_date": 1546514977, "creation_date": 1546514977, "answer_id": 54021430, "question_id": 54009916, "link": "https://stackoverflow.com/questions/54009916/hide-unhide-userforms-in-vba-excel/54021430#54021430", "title": "Hide/Unhide Userforms in VBA Excel", "body": "<p>Try hiding AM1 first before showing AM2 and that should fix your issue. </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n UserForm1.Hide\n UserForm2.Show\nEnd Sub\n</code></pre>\n\n<p>Also I think using the multipage control is probably better than using multiple userforms. </p>\n"}], "owner": {"reputation": 1, "user_id": 10858738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31ad521c589123e642883c72cb200112?s=128&d=identicon&r=PG&f=1", "display_name": "Display Name", "link": "https://stackoverflow.com/users/10858738/display-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1954, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566196144, "creation_date": 1546446911, "last_edit_date": 1566196144, "question_id": 54009916, "link": "https://stackoverflow.com/questions/54009916/hide-unhide-userforms-in-vba-excel", "title": "Hide/Unhide Userforms in VBA Excel", "body": "<p>I'm creating a system that allows an individual to select module choices for their degree. </p>\n\n<p>The users have to navigate between multiple forms (e.g. semester 1 &amp; 2, user info, confirmation pages etc.). I want the users to be able to return to a previous form to make changes after progressing (i.e. return to semester 1 choices after moving onto semester 2 choices) and be able to still edit all the data they inputted into the first form.</p>\n\n<p>I have tried using the hide and show methods but I keep getting an error (Run Time error '400' - Form already displayed, cannot show modally)</p>\n\n<pre><code>'on the AM1 form\n\nAM2.Show\n\nAM1.Hide\n   '(first form I want to close)\n\n'on the AM2 form\n\nUnload me\n\nAM1.Show\n     '(I want to return to the first form and close the second)\n</code></pre>\n\n<p>I want to be hide the first form (AM1) and keep all the info available to be re-edited when successfully returning to it.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1546446763, "post_id": 54009792, "comment_id": 94856456, "body": "I don&#39;t see any columns being added or deleted or any Named Ranges being used. Can you please <a href=\"https://stackoverflow.com/posts/54009792/edit\">edit your question</a> to clarify what the problem is?"}, {"owner": {"reputation": 3, "user_id": 10817774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47898e411c1299669e6d537cd139d395?s=128&d=identicon&r=PG&f=1", "display_name": "Jenniferz", "link": "https://stackoverflow.com/users/10817774/jenniferz"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1546447074, "post_id": 54009792, "comment_id": 94856605, "body": "I am trying to change my code so that add/delete new columns/rows won&#39;t affect my new created workbook."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1546447862, "post_id": 54009792, "comment_id": 94857002, "body": "They shouldn&#39;t, if you assign the ranges correctly...right?  I&#39;m not sure what the question is, can you please clarify?"}, {"owner": {"reputation": 3, "user_id": 10817774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47898e411c1299669e6d537cd139d395?s=128&d=identicon&r=PG&f=1", "display_name": "Jenniferz", "link": "https://stackoverflow.com/users/10817774/jenniferz"}, "edited": false, "score": 0, "creation_date": 1546448738, "post_id": 54009792, "comment_id": 94857423, "body": "okay, if I insert the value into A1 in the original workbook, then the value in new workbook will move to right, how can I lock it?"}], "answers": [{"tags": [], "owner": {"reputation": 8696, "user_id": 10746224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/znUL5.jpg?s=128&g=1", "display_name": "Lord Elrond", "link": "https://stackoverflow.com/users/10746224/lord-elrond"}, "is_accepted": false, "score": 0, "last_activity_date": 1546447840, "creation_date": 1546447840, "answer_id": 54010163, "question_id": 54009792, "link": "https://stackoverflow.com/questions/54009792/how-to-copy-named-range-from-one-workbook-to-another-workbook-in-specific-cell/54010163#54010163", "title": "How to copy named range from one workbook to another workbook in specific cell?", "body": "<p>You need to dim each workbook and worksheet you will be using.</p>\n\n<pre><code>Dim wb1 as Workbook, wb2 as Workbook, ws1 as Worksheet, ws2 as Worksheet\nDim xrow as long, arrData() as variant\n\nSet wb1 = Workbooks(\"Book1\")\nSet ws1 = wb1.Worksheets(\"Sheet1\")\n\nSet wb2 = Workbooks(\"Book2\")\nSet ws2 = wb2.Worksheets(\"Sheet2\")\n</code></pre>\n\n<p>Note that this only works if you have both workbooks open.</p>\n\n<p>Also I would recommend copying the data from each cell to an array, instead of copying a range.  I get less errors this way.</p>\n\n<pre><code>ApplicationScreenUpdating = False\n\nws1.Activate\n\n'where n is the number of rows you want to copy\nfor x = 1 To n\narrData[x - 1] = ws1.Cells(x, 1).value\nnext x\n\nws2.Activate\n\nfor i = 1 to n\nws2.Cells(i, 1).value = arrData[i - 1]\nnext i\n\nApplicationScreenUpdating = True\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10817774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47898e411c1299669e6d537cd139d395?s=128&d=identicon&r=PG&f=1", "display_name": "Jenniferz", "link": "https://stackoverflow.com/users/10817774/jenniferz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1566196151, "creation_date": 1546446352, "last_edit_date": 1566196151, "question_id": 54009792, "link": "https://stackoverflow.com/questions/54009792/how-to-copy-named-range-from-one-workbook-to-another-workbook-in-specific-cell", "title": "How to copy named range from one workbook to another workbook in specific cell?", "body": "<p>Below is my original code. I am trying to change my code so that add/delete new columns/rows won't affect the new created workbook. I decided to use the name range to avoid the code crushed. (I know how to create the new range in the Name manager) Anyone knows how to adjust the code?</p>\n\n<pre><code>Dim WS As Worksheet\nDim Rng As Range\nDim myWs As Worksheet\nSet myWs = ThisWorkbook.Sheets(\"MASTER\")\nSet Rng1 = myWs.Range(\"A1:AJ4\")\nSet Rng2 = myWs.Range(\"A85:AJ104\")\nApplication.Workbooks.Add\nSet WS = Application.ActiveSheet\nRng1.Copy Destination:=WS.Range(\"A1:AJ4\")\nRng2.Copy Destination:=WS.Range(\"A5:AJ50\")\n</code></pre>\n"}, {"tags": ["excel", "vba", "worksheet-function"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 2, "creation_date": 1546445999, "post_id": 54009487, "comment_id": 94856091, "body": "After you create the sheet, you can certainly use <code>Dim ws As Worksheet</code> and <code>Set ws = ThisWorkbook.Sheets(PublicStringName)</code> to give you access to your new sheet."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1546446140, "post_id": 54009487, "comment_id": 94856159, "body": "Or <code>Set ws = ThisWorkbook.Worksheets(Sheets.Count)</code> after the copy."}, {"owner": {"reputation": 23, "user_id": 4986150, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tMX4N.jpg?s=128&g=1", "display_name": "Eitan", "link": "https://stackoverflow.com/users/4986150/eitan"}, "edited": false, "score": 0, "creation_date": 1546778011, "post_id": 54009487, "comment_id": 94956364, "body": "Did not help, getting the error: Run-time error &#39;424&#39;:  Object required"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1546446610, "last_edit_date": 1546446610, "creation_date": 1546446212, "answer_id": 54009755, "question_id": 54009487, "link": "https://stackoverflow.com/questions/54009487/selecting-a-worksheet-by-name-i-have-the-name-as-string/54009755#54009755", "title": "Selecting A worksheet by name, I have the name as string", "body": "<p>Here is one way to use the Name:</p>\n\n<pre><code>Sub FreshSheet()\n    Dim PublicStringNAme As String\n    PublicStringNAme = \"Ellan\"\n\n    Sheets(\"My_Tamplate\").Copy After:=Worksheets(Sheets.Count)\n    ActiveSheet.Name = PublicStringNAme\n    '\n    '\n    '\n    '\n    Sheets(PublicStringNAme).Range(\"A1\") = 1\nEnd Sub\n</code></pre>\n\n<p>If you want to make the variable \"more Global\" then:</p>\n\n<pre><code>Public PublicStringName As String\n\nSub FreshSheet()\n    PublicStringName = \"Ellan\"\n\n    Sheets(\"My_Tamplate\").Copy After:=Worksheets(Sheets.Count)\n    ActiveSheet.Name = PublicStringName\n    '\n    '\n    '\n    '\n    Sheets(PublicStringName).Range(\"A1\") = 1\nEnd Sub\n</code></pre>\n\n<p>See:</p>\n\n<p><a href=\"http://www.cpearson.com/Excel/Scope.aspx\" rel=\"nofollow noreferrer\">Scope</a></p>\n"}], "owner": {"reputation": 23, "user_id": 4986150, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tMX4N.jpg?s=128&g=1", "display_name": "Eitan", "link": "https://stackoverflow.com/users/4986150/eitan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 303, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1593976574, "creation_date": 1546445125, "last_edit_date": 1593976574, "question_id": 54009487, "link": "https://stackoverflow.com/questions/54009487/selecting-a-worksheet-by-name-i-have-the-name-as-string", "title": "Selecting A worksheet by name, I have the name as string", "body": "<p>I have a VBA code that copies a template sheet and renames it.</p>\n<p>I have the new name saved as a public string:</p>\n<p>&quot;My_Tamplate&quot; is the sheet I copy from. &quot;PublicStringName&quot; is the public string variable I use to rename it to.\nI also use the &quot;PublicStringName&quot; in other places in the form, this is why I needed it as a string.</p>\n<pre><code>Sheets(&quot;My_Tamplate&quot;).Copy After:=Worksheets(Sheets.Count)\nActiveSheet.name = PublicStringName\n</code></pre>\n<p>Next when I need to write the data I collected using a form, I want to write it to the newly created sheet.</p>\n<p>Next I open a new form, collect data from the user to several variables.\nNow I want to write the data into the newly created sheet (now named &quot;PublicStringName&quot;). If I declare WS as worksheet, it will not accept &quot;PublicStringName&quot; as it is a string (I think).</p>\n<p>I do not know what sheet number it will be so I cannot call it by (sheet1) for example.</p>\n<p>I don't know how to upload my example excel, so:</p>\n<p>The Excel has 2 sheets named: Data (sheet2) and Project_Template (Sheet1). In sheet2 C3 I have <code>=MAX(B:B)</code>.</p>\n<p>I have 1 form (UserForm1), it has a multi page object.</p>\n<p>In page 1 I have a text box txtProjectName and a button cmdCreateProject.\nIn page 2 I have 5 text boxes, named: txtData1 to txtData5 and an Update button btnUpdate.</p>\n<p>I tried PeterT's solution (here in the code). Attaching the problematic code here:</p>\n<pre><code>Public ProjectName\n\nPrivate Sub btnUpdate_Click()\nDim WS As Worksheet\nDim Addme As Range\nSet WS = ThisWorksheet.Sheets(ProjectName)\nSet Addme = WS.Cells(Rows.Count, 3).End(xlUp)\nWith WS\nAddme.Offset(0, 1).Value = Me.txtData1\nAddme.Offset(0, 2).Value = Me.txtData2\nAddme.Offset(0, 3).Value = Me.txtData3\nAddme.Offset(0, 4).Value = Me.txtData4\nAddme.Offset(0, 5).Value = Me.txtData5\nEnd With\nMsgBox &quot;Contact for Project:&quot; &amp; &quot; &quot; &amp; ProjectName &amp; &quot;, &quot; &amp; &quot;was successfully \nadded&quot;\nEnd Sub\n\nPrivate Sub cmdCreateProject_Click()\nDim path As String\nDim mydir As String\nDim DataSh As Worksheet\nSet DataSh = Sheet2\nProjectName = &quot;&quot;\n\n'error handler\nOn Error GoTo errHandler:\n\nProjectName = Me.txtProjectName.Value\nIf Me.txtProjectName.Value = &quot;&quot; Then\nMsgBox &quot;Please enter a Project Name&quot;, vbOKOnly, &quot;Project Name Error&quot;\nExit Sub\nEnd If\nmydir = ThisWorkbook.path &amp; &quot;\\&quot; &amp; ProjectName\n\nIf Dir(mydir, vbDirectory) = &quot;&quot; Then\nMkDir mydir\n'Copy tamplate sheet to for new Project\nSheets(&quot;Project_Template&quot;).Copy After:=Worksheets(Sheets.Count)\nActiveSheet.Name = ProjectName\nElse\nMsgBox &quot;Directory already exsists&quot;\nMe.txtProjectName.Value = &quot;&quot;\nMe.txtProjectName.SetFocus\nProjectName = &quot;&quot;\nExit Sub\nEnd If\nSet Addme = DataSh.Cells(Rows.Count, 3).End(xlUp).Offset(1, 0)\nDataSh.Activate\nDataSh.Select\nWith DataSh\n\n'add the unique reference ID then all other values\nAddme.Offset(0, -1) = DataSh.Range(&quot;C3&quot;).Value + 1\nAddme.Value = Me.txtProjectName\nEnd With\nMe.MultiPage1.Pages(1).Enabled = True\nMe.MultiPage1.Pages(1).Visible = True\nMe.MultiPage1.Pages(0).Enabled = Fals\nMe.MultiPage1.Pages(0).Visible = Fals\nExit Sub\nerrHandler:\n'if error occurs then show me exactly where the error occurs\nMsgBox &quot;Error &quot; &amp; Err.Number &amp; _\n&quot; (&quot; &amp; Err.Description &amp; &quot;)in procedure PcmdClear_Click of Form ProjectDB&quot;\nEnd Sub\n</code></pre>\n<p>Now when I try to update the newly created Worksheet (named after the project) I get the error:</p>\n<blockquote>\n<p>Run-time error '424':<BR>\nObject required</p>\n</blockquote>\n<p>On the line:</p>\n<pre><code>Set WS = ThisWorksheet.Sheets(ProjectName)\n</code></pre>\n<p>I think that Gary's Student answer is missing the step where after I create the new sheet I start collecting the data.</p>\n"}, {"tags": ["python", "excel", "vba", "pandas"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 9829851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/872180a70479c6f238aedfad4e661056?s=128&d=identicon&r=PG&f=1", "display_name": "Chris V", "link": "https://stackoverflow.com/users/9829851/chris-v"}, "edited": false, "score": 0, "creation_date": 1546464183, "post_id": 54009572, "comment_id": 94863646, "body": "Thanks! I chose another suggestion, but I appreciate this alternative method."}], "tags": [], "owner": {"reputation": 7729, "user_id": 4718350, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-CxgNhC_5nUE/AAAAAAAAAAI/AAAAAAAAP78/9FTapxcd2dY/photo.jpg?sz=128", "display_name": "Chris", "link": "https://stackoverflow.com/users/4718350/chris"}, "is_accepted": false, "score": 1, "last_activity_date": 1546445442, "creation_date": 1546445442, "answer_id": 54009572, "question_id": 54009471, "link": "https://stackoverflow.com/questions/54009471/python-pandas-equivalent-to-excel-vba-txtconvert/54009572#54009572", "title": "Python Pandas equivalent to Excel VBA TxtConvert", "body": "<p>This should do the trick.</p>\n\n<pre><code>queryp2 = ' '.join(df['B'].values.astype(str))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 75, "user_id": 9829851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/872180a70479c6f238aedfad4e661056?s=128&d=identicon&r=PG&f=1", "display_name": "Chris V", "link": "https://stackoverflow.com/users/9829851/chris-v"}, "edited": false, "score": 0, "creation_date": 1546464027, "post_id": 54009664, "comment_id": 94863578, "body": "Thanks so much for the fast response!"}], "tags": [], "owner": {"reputation": 8568, "user_id": 9177877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5qL1i.png?s=128&g=1", "display_name": "It_is_Chris", "link": "https://stackoverflow.com/users/9177877/it-is-chris"}, "is_accepted": true, "score": 2, "last_activity_date": 1546446934, "last_edit_date": 1546446934, "creation_date": 1546445830, "answer_id": 54009664, "question_id": 54009471, "link": "https://stackoverflow.com/questions/54009471/python-pandas-equivalent-to-excel-vba-txtconvert/54009664#54009664", "title": "Python Pandas equivalent to Excel VBA TxtConvert", "body": "<p>You can use list comprehension:</p>\n\n<pre><code>str([str(x) for x in df['B']]).strip('[]')\n</code></pre>\n\n<p>which returns:</p>\n\n<pre><code>\"'4', '5', '6'\"\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 9829851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/872180a70479c6f238aedfad4e661056?s=128&d=identicon&r=PG&f=1", "display_name": "Chris V", "link": "https://stackoverflow.com/users/9829851/chris-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 383, "favorite_count": 0, "accepted_answer_id": 54009664, "answer_count": 2, "score": 0, "last_activity_date": 1546446934, "creation_date": 1546445050, "question_id": 54009471, "link": "https://stackoverflow.com/questions/54009471/python-pandas-equivalent-to-excel-vba-txtconvert", "title": "Python Pandas equivalent to Excel VBA TxtConvert", "body": "<p>I'd like to consolidate all values from a data frame column (containing roughly 100-500 records on average to single string text, so that I can pass it through the where clause of a query that pulls from a larger table on our SQL Server containing over 6 million records of data. </p>\n\n<p>In the example code I provided below, I would like to queryp2 to show as \"'4','5','6'\"</p>\n\n<p>I'm not sure if this is possible and if I missed that this question has been answered before, I will delete the question. Thanks in advance.</p>\n\n<pre><code>import numpy as np\nimport pandas as pd\n#df example\ndf = pd.DataFrame({\"A\": [1, 2, 3], \"B\": [4, 5, 6]})\nqueryp1 = \"SELECT * FROM PROD_DB.VERY_LARGE_TABLE WHERE B IN (\"\nqueryp2 = \"PLEASE HELP\"\nqueryp3 = \");\"\nquery_final = queryp1+queryp2+queryp3\n#Intended results for queryp2 would actually be \"'4','5','6'\"\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1546447627, "post_id": 54009413, "comment_id": 94856871, "body": "The delay is not a solution. You need to use <b>.Readystate.</b>  Google it or read more here: <a href=\"https://www.automateexcel.com/vba/automate-internet-explorer-ie-using/\" rel=\"nofollow noreferrer\">automateexcel.com/vba/automate-internet-explorer-ie-using</a>"}, {"owner": {"reputation": 11, "user_id": 10815977, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nlq9gWyJjAc/AAAAAAAAAAI/AAAAAAAAALI/CRNGmJ-arkY/photo.jpg?sz=128", "display_name": "Lucas LE GUEN", "link": "https://stackoverflow.com/users/10815977/lucas-le-guen"}, "edited": false, "score": 0, "creation_date": 1546447951, "post_id": 54009413, "comment_id": 94857049, "body": "Yes, I had also thought but unfortunately this does not work..."}, {"owner": {"reputation": 11, "user_id": 10815977, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nlq9gWyJjAc/AAAAAAAAAAI/AAAAAAAAALI/CRNGmJ-arkY/photo.jpg?sz=128", "display_name": "Lucas LE GUEN", "link": "https://stackoverflow.com/users/10815977/lucas-le-guen"}, "edited": false, "score": 0, "creation_date": 1546447969, "post_id": 54009413, "comment_id": 94857064, "body": "Thx for your answer !"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1546448296, "post_id": 54009413, "comment_id": 94857229, "body": "<b>this does not work</b> is not helpful. State what is happening."}, {"owner": {"reputation": 11, "user_id": 10815977, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nlq9gWyJjAc/AAAAAAAAAAI/AAAAAAAAALI/CRNGmJ-arkY/photo.jpg?sz=128", "display_name": "Lucas LE GUEN", "link": "https://stackoverflow.com/users/10815977/lucas-le-guen"}, "edited": false, "score": 0, "creation_date": 1546448385, "post_id": 54009413, "comment_id": 94857267, "body": "The webpage is always static, it does not execute the script"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1546448653, "post_id": 54009413, "comment_id": 94857380, "body": "Webpages (HTML) does not execute anything, that is correct. Yet imbedded javascript might do .... thus the reference to .Readystate"}, {"owner": {"reputation": 11, "user_id": 10815977, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nlq9gWyJjAc/AAAAAAAAAAI/AAAAAAAAALI/CRNGmJ-arkY/photo.jpg?sz=128", "display_name": "Lucas LE GUEN", "link": "https://stackoverflow.com/users/10815977/lucas-le-guen"}, "edited": false, "score": 0, "creation_date": 1546503642, "post_id": 54009413, "comment_id": 94873389, "body": "ok i have used the bad form of ReadyState ! That&#39;s my bad ! Sorry. I have used this form : Do Until ie.readyState = 4         DoEvents     Loop  But this form is better : Do While ie.readyState = 4: DoEvents: Loop     Do Until ie.readyState = 4: DoEvents: Loop (Thx to your link)"}], "owner": {"reputation": 11, "user_id": 10815977, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nlq9gWyJjAc/AAAAAAAAAAI/AAAAAAAAALI/CRNGmJ-arkY/photo.jpg?sz=128", "display_name": "Lucas LE GUEN", "link": "https://stackoverflow.com/users/10815977/lucas-le-guen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1546444821, "creation_date": 1546444821, "question_id": 54009413, "link": "https://stackoverflow.com/questions/54009413/program-running-in-step-by-step-mode-but-not-running-it-normally-with-javascrip", "title": "Program running in step-by-step mode but not running it normally (with JavaScript)", "body": "<p>My program normally works in step-by-step mode, but if I run my program without step-by-step mode, javascript does not work.\nThe objective is to run JavaScript to access to an other page in IE.</p>\n\n<p>I have already try to execute JavaScript in two ways, but it's the same problem.\nI also tried to wait a little after running JavaScript</p>\n\n<pre><code>'Test 1 \n   'Call ie.document.parentWindow.execScript(\"disp_menu(4)\", \"JavaScript\") \n    'Application.Wait (2000)\n    'Test 2\n    ie.document.parentWindow.execScript \"disp_menu(4)\", \"JavaScript\"\n    'Application.Wait (2000)\n</code></pre>\n\n<p>The objective is to run JavaScript to access to an other page in IE.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1546444881, "post_id": 54009354, "comment_id": 94855545, "body": "<code>Index(BidL8E.Address),MATCH</code> should be <code>Index(&quot; &amp; BidL8E.Address &amp; &quot;,MATCH</code>"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1546444996, "post_id": 54009354, "comment_id": 94855607, "body": "You&#39;re not the <a href=\"http://wot.wikia.com/wiki/Lews_Therin_Telamon\" rel=\"nofollow noreferrer\">Dragon Reborn</a> are you?  Just that @RandAlthor might have a thing to say about that.  Sorry... bit off topic there."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1546445032, "post_id": 54009354, "comment_id": 94855624, "body": "Does Countif ever return a value &lt; 0 ?  That would be new..."}, {"owner": {"reputation": 37, "user_id": 10187439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge6nn.jpg?s=128&g=1", "display_name": "LewisThelemon", "link": "https://stackoverflow.com/users/10187439/lewisthelemon"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1546445223, "post_id": 54009354, "comment_id": 94855735, "body": "@TimWilliams Thanks for pointing that out. I corrected it."}, {"owner": {"reputation": 37, "user_id": 10187439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge6nn.jpg?s=128&g=1", "display_name": "LewisThelemon", "link": "https://stackoverflow.com/users/10187439/lewisthelemon"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1546445252, "post_id": 54009354, "comment_id": 94855745, "body": "@ScottCraner Thanks for the correction."}, {"owner": {"reputation": 37, "user_id": 10187439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge6nn.jpg?s=128&g=1", "display_name": "LewisThelemon", "link": "https://stackoverflow.com/users/10187439/lewisthelemon"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1546445397, "post_id": 54009354, "comment_id": 94855801, "body": "@DarrenBartrup-Cook I dont know, I am having these visions which tell me to go to Toman Head, and a horn of some sort, which I dont know if they exist. :P"}, {"owner": {"reputation": 37, "user_id": 10187439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge6nn.jpg?s=128&g=1", "display_name": "LewisThelemon", "link": "https://stackoverflow.com/users/10187439/lewisthelemon"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1546454945, "post_id": 54009354, "comment_id": 94859914, "body": "@ScottCraner After correcting the code it is giving me an Object doesn&#39;t support this property error. Any suggestions?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1546486248, "post_id": 54009354, "comment_id": 94868766, "body": "Your INDEX function is still incorrect.  Try <code>Debug.Print</code> to output it to the Immediate pane, then paste it into the cell manually and see what Excel complains about."}, {"owner": {"reputation": 37, "user_id": 10187439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge6nn.jpg?s=128&g=1", "display_name": "LewisThelemon", "link": "https://stackoverflow.com/users/10187439/lewisthelemon"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1546527590, "post_id": 54009354, "comment_id": 94885866, "body": "@TimWilliams So I found out what the problem was. The sheet in which I want the output has code: <code>Private Sub Worksheet_Change(ByVal Target As range)</code> This is why the <code>Index-Match</code> is not working. I will post a new question for this."}], "owner": {"reputation": 37, "user_id": 10187439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge6nn.jpg?s=128&g=1", "display_name": "LewisThelemon", "link": "https://stackoverflow.com/users/10187439/lewisthelemon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566196163, "creation_date": 1546444628, "last_edit_date": 1566196163, "question_id": 54009354, "link": "https://stackoverflow.com/questions/54009354/how-to-formulate-index-match-to-include-conditions-in-vba", "title": "How to formulate Index - Match to include conditions in VBA?", "body": "<p>I am trying to formulate an Index - Match function with three conditions:\nCondition 1: It should check for only the highlighted cells\nCondition 2: It should check for the same person in Scheduled Off Column\nCondition 3: It should not repeat the same person again</p>\n\n<p>I have two worksheets. On Sheet 1 I have the table with Positions against Employee. On Sheet2 I have the table where the Index match will be applicable. It also contains the Highlighted cells and drop down menu.\nThe Code should select name from the drop down list and not override the list\nI have set Named Ranges in both the sheets. What I have tried is the following code.</p>\n\n<pre><code>Option Explicit\n'use a constant to store the highlight color...\nConst HIGHLIGHT_COLOR = 9894500 'RGB(100, 250, 150)'Is a cell highlighted? \nEDIT: changed the function name to IsHighlighted\nFunction IsHighlighted(c As range)\n    IsHighlighted = (c.Interior.Color = HIGHLIGHT_COLOR)\nEnd Function\n\nSub AssignBided()\n\nDim ws1 As Worksheet\nDim ws2 As Worksheet\nDim cel1 As range\nDim cel2 As range\nDim Bid As range\nDim line As range\nDim Offemp As range\nDim BidL8 As range\nDim BidL8E As range\nDim coresVal As String\n\nSet ws1 = Worksheets(\"Sheet1\")\nSet ws2 = Worksheets(\"Sheet2\")\nSet Bid = ws2.range(\"Bid\")\nSet line = ws2.range(\"All_Pos_Hilight_Mon\")\nSet Offemp = ws2.range(\"Off_Mon\") 'Scheduled Off Column\nSet BidL8 = ws1.range(\"Bid_Pos\") 'Bided Position\nSet BidL8E = ws1.range(\"Bid_Emp\") 'Bided Employee for a Position\n\nFor Each cel1 In BidL8E\n    For Each cel2 In line\n        If IsHighlighted(cel2) Then\n            If Application.WorksheetFunction.CountIf(Offemp, cel1.Value) &gt; 0 Then\n                coresVal = Evaluate(\"Index(\" &amp; BidL8E.Address &amp; \"),MATCH(\" &amp; cel2.Validation &amp; \",\" &amp; BidL8.Address &amp; \",0))\")\n                Debug.Print coresVal\n                cel2.Offset(0, 2).Value = coresVal\n            End If\n        End If\n    Next cel2\nNext cel1\nEnd Sub\n</code></pre>\n\n<p>This code is not executing. I am getting the error:\n    Object doesn't support this property or method\nIt highlights line 33. If any one can help me in this it would be greatly appreciated. Thank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "edited": false, "score": 1, "creation_date": 1546444215, "post_id": 54009244, "comment_id": 94855162, "body": "Have you looked at <code>Resize</code> method on the <code>Range</code> object? Also <code>D21:O21</code> is a single row of data so not sure what you mean by discarding the last four rows?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1546444629, "post_id": 54009244, "comment_id": 94855391, "body": "<code>ws1.Range(&quot;D21:O21&quot; &amp; Last_Row1)</code> is probably wrong, did you mean <code>ws1.Range(&quot;D21:O&quot; &amp; Last_Row1)</code>? You can just subtract 4 from Last_Row1 then."}, {"owner": {"reputation": 133, "user_id": 9726176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bd85ef149e2049219d6998a4d21fc37?s=128&d=identicon&r=PG&f=1", "display_name": "jps17183", "link": "https://stackoverflow.com/users/9726176/jps17183"}, "edited": false, "score": 0, "creation_date": 1546445656, "post_id": 54009244, "comment_id": 94855925, "body": "Vincent G Thaks It worked."}], "answers": [{"tags": [], "owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1546444696, "creation_date": 1546444696, "answer_id": 54009374, "question_id": 54009244, "link": "https://stackoverflow.com/questions/54009244/copy-data-to-a-new-sheet-excluding-the-last-4-rows/54009374#54009374", "title": "Copy data to a new sheet excluding the last 4 rows", "body": "<p>Try this:</p>\n\n<pre><code>Sub Prime()\n    Dim Last_Row1 As Long, Last_Row2 As Long, table As Range\n    Dim ws1 As Worksheet, ws2 As Worksheet\n\n    Set ws1 = Sheets(\"Enter DATA here\")\n    Set ws2 = Sheets(\"DATA\")\n\n    Set table = ws1.Range(\"D21:O28\")   // I arbitrarily set this to 8 rows\n\n    Application.ScreenUpdating = False\n\n        Last_Row1 = ws1.Range(\"C\" &amp; Rows.Count).End(xlUp).Row ' Determine the lastrow of the data to copy\n        Last_Row2 = ws2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row ' Determine the next empty row in order to paste the data\n        table.Resize(table.Rows.Count - 4, table.Columns.Count).Copy ws2.Range(\"A\" &amp; Last_Row2)\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 133, "user_id": 9726176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bd85ef149e2049219d6998a4d21fc37?s=128&d=identicon&r=PG&f=1", "display_name": "jps17183", "link": "https://stackoverflow.com/users/9726176/jps17183"}, "is_accepted": false, "score": 0, "last_activity_date": 1546445743, "creation_date": 1546445743, "answer_id": 54009640, "question_id": 54009244, "link": "https://stackoverflow.com/questions/54009244/copy-data-to-a-new-sheet-excluding-the-last-4-rows/54009640#54009640", "title": "Copy data to a new sheet excluding the last 4 rows", "body": "<pre><code>   Sub Prime()\n\n Dim Last_Row1 As Long, Last_Row2 As Long\n Dim ws1 As Worksheet, ws2 As Worksheet\n    Set ws1 = Sheets(\"Enter DATA here\")\n    Set ws2 = Sheets(\"DATA\")\n    Application.ScreenUpdating = False\n    Last_Row1 = ws1.Range(\"C\" &amp; Rows.Count).End(xlUp).Row ' Determine the lastrow of the data to copy\n    Last_Row2 = ws2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row ' Determine the next empty row in order to paste the data\n    ws1.Range(\"D21:O\" &amp; Last_Row1-4).Copy ws2.Range(\"A\" &amp; Last_Row2)\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 10680889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bf9e7d7c1aaba399adeb9ea9bfe131e?s=128&d=identicon&r=PG&f=1", "display_name": "G.C", "link": "https://stackoverflow.com/users/10680889/g-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1546446234, "creation_date": 1546446234, "answer_id": 54009763, "question_id": 54009244, "link": "https://stackoverflow.com/questions/54009244/copy-data-to-a-new-sheet-excluding-the-last-4-rows/54009763#54009763", "title": "Copy data to a new sheet excluding the last 4 rows", "body": "<p>You can use Offset function to exclude the last 4 rows.</p>\n\n<pre><code>Last_Row1 = ws1.Range(\"C\" &amp; Rows.Count).End(xlUp).offset(-4,0).Row \n</code></pre>\n\n<p>When you copy the range, you should delete row indicator \"21\" behind column \"O\", otherwise, the code would not select till the last row. Like following:</p>\n\n<pre><code>ws1.Range(\"D21:O\" &amp; Last_Row1).Copy ws2.Range(\"A\" &amp; Last_Row2)\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 9726176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bd85ef149e2049219d6998a4d21fc37?s=128&d=identicon&r=PG&f=1", "display_name": "jps17183", "link": "https://stackoverflow.com/users/9726176/jps17183"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 184, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1554738439, "creation_date": 1546444085, "last_edit_date": 1554738439, "question_id": 54009244, "link": "https://stackoverflow.com/questions/54009244/copy-data-to-a-new-sheet-excluding-the-last-4-rows", "title": "Copy data to a new sheet excluding the last 4 rows", "body": "<p>I'm trying to copy a table from sheet 1, defined by the area D21:O21, until the end \u2013 (minus) the last 4 lines.</p>\n\n<p>I have a problem pasting results. In sheet 2 I have a table that feeds pivot charts. After I delete previous filled rows (with values) and paste new ones (new values) the table extends further than it is supposed to. It adds blank cells downstream as if the copied sheet 1 had more rows with values.</p>\n\n<p>For example: Imagine that my table (in sheet 1) has 600 rows with values. If I paste to the table (in sheet 2) it extends further than 600 rows (approx. 10000). Instead of adding multiple empty lines I want 600 except last 4 lines = from top to 596 rows.</p>\n\n<pre><code>Sub Prime()\n\nDim Last_Row1 As Long, Last_Row2 As Long\nDim ws1 As Worksheet, ws2 As Worksheet\n    Set ws1 = Sheets(\"Enter DATA here\")\n    Set ws2 = Sheets(\"DATA\")\n    Application.ScreenUpdating = False\n    Last_Row1 = ws1.Range(\"C\" &amp; Rows.Count).End(xlUp).Row ' Determine the lastrow of the data to copy\n    Last_Row2 = ws2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row ' Determine the next empty row in order to paste the data\n    ws1.Range(\"D21:O21\" &amp; Last_Row1).Copy ws2.Range(\"A\" &amp; Last_Row2)\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1546443023, "post_id": 54008942, "comment_id": 94854548, "body": "If it runs a third time would it run on <code>Sheet1</code> again, or does it run on whichever sheet isn&#39;t the <code>ActiveSheet</code>?  If you want it to just flip-flop between the two sheets even after closing and reopening I think you&#39;ll have to store a number or odd/even pairing on a sheet to check which sheet."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1546443412, "post_id": 54008942, "comment_id": 94854733, "body": "Is there something in your sheets which you could use to identify which sheet to paste too? Might be worth providing a screen print of the sheets?"}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1546443538, "post_id": 54008942, "comment_id": 94854807, "body": "@DarrenBartrup-Cook The loop will only ever run twice. So the first time will always be sheet1 and the second time it runs will always be sheet2"}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1546443612, "post_id": 54008942, "comment_id": 94854851, "body": "@Zac Yes There should be a way to do that. The first sheet is always going to be &quot;Lago&quot; the Second would always be &quot;MF&quot;. I&#39;ll post up an image what what I&#39;m Looking at."}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1546443970, "post_id": 54008942, "comment_id": 94855038, "body": "Also to add some context to what you&#39;re seeing in the image and with the code. The idea is that it runs the formulas then copy/pastes rows with all Errors to sheet 1. Currently it just loops so it runs the formula&#39;s from the second group (Separated by the red columns) and pastes them into Sheet 1. I want to try to get it to paste those errors on Sheet 2 instead."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 2, "creation_date": 1546444134, "post_id": 54008942, "comment_id": 94855130, "body": "@Deke - FYI, it&#39;s usually better to add information by <a href=\"https://stackoverflow.com/posts/54008942/edit\">editing your question</a> instead of doing so in comments"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1546448060, "post_id": 54008942, "comment_id": 94857108, "body": "Why not populate a <code>Queue</code> when the workbook open with the sheet names you need to iterate, then Dequeue when done with the name."}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1546459089, "post_id": 54008942, "comment_id": 94861623, "body": "I wouldn&#39;t know how to set that up honestly."}], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1546445215, "post_id": 54009306, "comment_id": 94855731, "body": "keep getting subscript out of range error on the RunMe sub.  Everything seems to line up though so not sure what I&#39;m missing."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1546445375, "post_id": 54009306, "comment_id": 94855797, "body": "That suggests you haven&#39;t got a sheet called <code>Lago</code> - if you do, check that it doesn&#39;t have any spaces before or after it on the tab name."}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1546446418, "post_id": 54009306, "comment_id": 94856278, "body": "Names all line up. Retyped them to make sure. Moved the RunMe sub to the bottom and now getting a compile error: &quot;Wrong number of arguments or invalid property assignment on the line <code>If FirstSheet.Name = &quot;Lago&quot; Then Test SecondSheet</code> I&#39;m playing around with it though. I&#39;ve gotta be missing something somewhere."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1546446547, "post_id": 54009306, "comment_id": 94856342, "body": "Only other thing I can think of - is the code in the same workbook as the worksheets you&#39;re manipulating?  <code>ThisWorkbook</code> means the workbook containing the code.  Maybe change it to <code>ActiveWorkbook</code> or <code>Workbooks(&quot;MyWorkbook.xlsx&quot;)</code>."}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1546447660, "post_id": 54009306, "comment_id": 94856894, "body": "That would be it, the code is being run from a module in a different workbook. (There is a lot of interaction between several workbooks). So looks like I just need to specify the workbook in the module."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1546448045, "post_id": 54009306, "comment_id": 94857100, "body": "That&#39;ll do it.  Just noticed in the code that the two lines <code>Set SecondSheet = Worksheets(&quot;MF&quot;)</code> and <code>Set SecondSheet = Worksheets(&quot;Lago&quot;)</code> aren&#39;t qualifying the workbook they&#39;re in, so they&#39;ll be looked for in the <code>ActiveWorkbook</code>.  I&#39;ll update the code so they look at the same workbook as the passed worksheet."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 1, "last_activity_date": 1546448154, "last_edit_date": 1546448154, "creation_date": 1546444373, "answer_id": 54009306, "question_id": 54008942, "link": "https://stackoverflow.com/questions/54008942/vba-loop-code-and-have-it-recognize-multiple-sheets-to-copy-to-in-excel/54009306#54009306", "title": "VBA loop code and have it recognize multiple sheets to copy to in Excel?", "body": "<p>Sorry, I can't see the image so I've cobbled together something that should work.<br>\nThere's two procedures - <code>RunMe</code> just fires the <code>Test</code> procedure and passes it the first worksheet, the other worksheet is then considered to be the second sheet.<br>\nI haven't included the <code>For...Each</code> block as it uses <code>lrow</code> which isn't defined until after it's used, so would default to <code>0</code> - not sure what you're trying to do there.</p>\n\n<p>I've added a line of code at the end of <code>Test</code> which will call itself again but passing the other sheet.  </p>\n\n<pre><code>Sub RunMe()\n\n    Test ThisWorkbook.Worksheets(\"Lago\")\n\n    'If not using last line in main code, then\n    'include this to run second sheet at time of your choosing.\n    'Test ThisWorkbook.Worksheets(\"MF\")\n\nEnd Sub\n\nSub Test(FirstSheet As Worksheet)\n\n    Dim SecondSheet As Worksheet\n\n    Dim lrow As Long\n    Dim eRng As Range\n\n    If FirstSheet.Name = \"Lago\" Then\n        'The \"Parent\" of a worksheet is the workbook.\n        Set SecondSheet = FirstSheet.Parent.Worksheets(\"MF\")\n    Else\n        Set SecondSheet = FirstSheet.Parent.Worksheets(\"Lago\")\n    End If\n\n    With FirstSheet\n        lrow = .Cells(.Rows.Count, 1).End(xlUp).Row\n        With .Range(.Cells(3, 1), .Cells(lrow, 99))\n            On Error Resume Next\n            Set eRng = .SpecialCells(xlCellTypeFormulas, xlErrors)\n            On Error GoTo 0\n\n            If Not eRng Is Nothing Then\n                Intersect(.Parent.Range(\"A:CU\"), eRng.EntireRow).Copy\n                SecondSheet.Range(\"A3\").PasteSpecial\n            End If\n\n        End With\n    End With\n\n    'Now run again but with sheets reversed.\n    'Include this line to run both sheets in one go.\n    If FirstSheet.Name = \"Lago\" Then Test SecondSheet\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566196174, "creation_date": 1546442758, "last_edit_date": 1566196174, "question_id": 54008942, "link": "https://stackoverflow.com/questions/54008942/vba-loop-code-and-have-it-recognize-multiple-sheets-to-copy-to-in-excel", "title": "VBA loop code and have it recognize multiple sheets to copy to in Excel?", "body": "<p><a href=\"https://i.stack.imgur.com/AQKJm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AQKJm.png\" alt=\"example\"></a>\nI'm attempting to figure out IF it's possible and if so, How to run my loop so that the first time it runs it copy/pastes into Sheet1 and the second time it runs it copy/pastes into Sheet 2. I was thinking maybe an array might be helpful but I'm not familiar with their use or syntax. Any help in the right direction would be appreciated!</p>\n\n<pre><code> For Each a In Range(\"2:2\").SpecialCells(xlCellTypeFormulas).Areas\n     a.Resize(lrow - 1, a.Columns.Count).FillDown\n\n With Worksheets(\"Fall 2016\")\n     lrow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\n     With .Range(\"A3:CU\" &amp; lrow)\n         On Error Resume Next\n         Set erng = .SpecialCells(xlCellTypeFormulas, xlErrors)\n         On Error GoTo 0\n         If Not erng Is Nothing Then\n             Intersect(.Parent.Range(\"A:CU\"), erng.EntireRow).Copy\n             Worksheets(\"Sheet1\").Range(\"A3\").PasteSpecial\n         End If\n     End With\n End With\n Next a\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "edited": false, "score": 0, "creation_date": 1546444341, "post_id": 54008913, "comment_id": 94855220, "body": "In case you&#39;re not sure about the number (it&#39;s not always going to be 4924), you might need &quot;<a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\" title=\"how to use regular expressions regex in microsoft excel both in cell and loops\">stackoverflow.com/questions/22542834/&hellip;</a>&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1546443607, "post_id": 54008950, "comment_id": 94854847, "body": "Add a <code>Trim</code> to that if you don&#39;t want leading or trailing whitespaces"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 2, "last_activity_date": 1546442796, "creation_date": 1546442796, "answer_id": 54008950, "question_id": 54008913, "link": "https://stackoverflow.com/questions/54008913/how-can-i-remove-the-specific-string-with-help-of-macro-in-excel/54008950#54008950", "title": "How can i remove the specific string with help of macro in Excel", "body": "<p>Just use <code>LEFT()</code>/<code>SEARCH()</code>:</p>\n\n<pre><code>=LEFT(A1,SEARCH(\"#\",A1)-1)\n</code></pre>\n\n<p>Returns</p>\n\n<blockquote>\n  <p>1-99550 Alexander Keith </p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": true, "score": 1, "last_activity_date": 1546443969, "creation_date": 1546443969, "answer_id": 54009220, "question_id": 54008913, "link": "https://stackoverflow.com/questions/54008913/how-can-i-remove-the-specific-string-with-help-of-macro-in-excel/54009220#54009220", "title": "How can i remove the specific string with help of macro in Excel", "body": "<p>Just Find <code>#*</code> (and Replace with 'nothing').</p>\n"}], "owner": {"reputation": 5, "user_id": 10858455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a00076825c7bc7ac8a42354ba2b3fb3?s=128&d=identicon&r=PG&f=1", "display_name": "vik2595", "link": "https://stackoverflow.com/users/10858455/vik2595"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 54009220, "answer_count": 2, "score": -1, "last_activity_date": 1546448582, "creation_date": 1546442653, "last_edit_date": 1546448582, "question_id": 54008913, "link": "https://stackoverflow.com/questions/54008913/how-can-i-remove-the-specific-string-with-help-of-macro-in-excel", "title": "How can i remove the specific string with help of macro in Excel", "body": "<p>I'm analyzing sales report data. I need to remove some unnecessary string. This string will be generated from the POS. It's a default format.</p>\n\n<p>This is the default format:</p>\n\n<ol>\n<li>1-99550 Alexander Keith #4924) on 27/12/2018   1:16:09PM for 0.00 hrs 0.00 min 56.00 sec</li>\n<li>1-99551 Mark Smith #4924) on 27/12/2018   1:16:09PM for 0.00 hrs 0.00 min 56.00 sec</li>\n</ol>\n\n<p>I need to remove \"<strong>#4924) on 27/12/2018   1:16:09PM for 0.00 hrs 0.00 min 56.00 sec</strong> \" part of the string.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1546448811, "post_id": 54008573, "comment_id": 94857459, "body": "Have you seen <a href=\"https://stackoverflow.com/questions/26038165/automate-saveas-dialogue-for-ie9-vba\">THIS</a>"}, {"owner": {"reputation": 120, "user_id": 5671265, "user_type": "registered", "profile_image": "https://graph.facebook.com/1218282431520363/picture?type=large", "display_name": "Kamal Bharakhda", "link": "https://stackoverflow.com/users/5671265/kamal-bharakhda"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1546452297, "post_id": 54008573, "comment_id": 94858876, "body": "@SiddharthRout Yes, Sir, I went through it earlier and many threads. Actually, if you look at the code, it builds on the same concept. It worked for me on the single download but when I create a loop to download documents one by one by filling the form, the code stops working. I found, the RET value in the first download was 0 but when loop triggers the second download, RET has it&#39;s earlier value, so the FindWindowEx captured that value and without getting the save as dialogue, it skips to the third download. and the same happens with the third too. any idea?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1546492627, "post_id": 54008573, "comment_id": 94870036, "body": "Ret will always have the same value. The value of <code>heWnd</code> should change. Put a break on the line <code>heWnd = FindWindowEx(Ret, ByVal 0&amp;, &quot;Frame Notification Bar&quot;, vbNullString)</code> and check the value of it realtime"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1546493070, "post_id": 54008573, "comment_id": 94870128, "body": "Also you have an <code>Export</code> button? Does it point to a specific download link? If yes then you can also try using <code>URLDownloadToFile</code> API"}, {"owner": {"reputation": 120, "user_id": 5671265, "user_type": "registered", "profile_image": "https://graph.facebook.com/1218282431520363/picture?type=large", "display_name": "Kamal Bharakhda", "link": "https://stackoverflow.com/users/5671265/kamal-bharakhda"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1546505551, "post_id": 54008573, "comment_id": 94874066, "body": "@SiddharthRout : here is the link of the Page... <a href=\"http://10.110.10.78:9704/xmlpserver/ECOM_RDC/MERCHANDISING/SOH_Report/Stock%20Available%20For%20Upload%20Transfer/Stock%20Available%20For%20Upload%20Transfer.xdo\" rel=\"nofollow noreferrer\">10.110.10.78:9704/xmlpserver/ECOM_RDC/MERCHANDISING/SOH_Repo&zwnj;&#8203;rt/&hellip;</a>  Here is the Element of the Export Button   &lt;button title=&quot;Export&quot; class=&quot;x7g&quot; style=&quot;background-image:url(/xmlpserver/cabo/images/swan/btn&zwnj;&#8203;-bg1.gif)&quot; onclick=&quot;return exportReport(&#39;xdoRptForm&#39;, &#39;/xmlpserver/ECOM_RDC/MERCHANDISING/SOH_Report/Stock Available For Upload Transfer/Stock Available For Upload Transfer.xdo&#39;);&quot; type=&quot;button&quot;&gt;Export&lt;/button&gt;"}], "owner": {"reputation": 120, "user_id": 5671265, "user_type": "registered", "profile_image": "https://graph.facebook.com/1218282431520363/picture?type=large", "display_name": "Kamal Bharakhda", "link": "https://stackoverflow.com/users/5671265/kamal-bharakhda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 522, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1556543868, "creation_date": 1546441312, "last_edit_date": 1556543868, "question_id": 54008573, "link": "https://stackoverflow.com/questions/54008573/wait-until-open-save-cancel-mini-window-appears-in-the-ie-browser-findwindowex", "title": "Wait until OPEN/SAVE/CANCEL mini window appears in the IE browser. FindWindowEx() is Failing on Looping through IE in VBA", "body": "<p>I'm trying to download files from the IE browser with Excel VBA. I'm using the following three libraries to drive process in complete automation.</p>\n\n<blockquote>\n  <ol>\n  <li>SHDocVw</li>\n  <li>MSHTML</li>\n  <li>IUIAutomation</li>\n  </ol>\n</blockquote>\n\n<p>There are three files to download one by one by filling some information on the form of the webpage. Each file has a different file size.</p>\n\n<p>I require a dynamic wait mechanism which keeps my program on hold until OPEN/SAVE/CANCEL mini window appears in the bottom of the IE browser. </p>\n\n<p><a href=\"https://i.stack.imgur.com/706qZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/706qZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>To detect a mini window on the IE browser, I used FindWindowEx Function to call an API to get whether the window has arrived. </p>\n\n<p>Here is the code to perform the dynamic wait.</p>\n\n<pre><code>Private Sub WaitTillFrame(ByVal oBrowser As SHDocVw.InternetExplorer)\n\n    Dim heWnd As LongPtr\n    Dim Ret As LongPtr\n\n    Do Until heWnd &gt; 0\n        Ret = oBrowser.hWnd\n        heWnd = FindWindowEx(Ret, ByVal 0&amp;, \"Frame Notification Bar\", vbNullString)\n        DoEvents\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>Above code worked for the first file but when code starts preparation of the second file for download it doesn't wait until the mini window appears.</p>\n\n<p>I have noticed while debugging, Ret Value remains unchanged. Because of that <code>FindWindowEx(Ret, ByVal 0&amp;, \"Frame Notification Bar\", vbNullString)</code> thinks the dialogue box has appeared but it has not.</p>\n\n<p>It keeps running, without waiting until the mini window appears. I download the first file and remaining two files are missed. </p>\n\n<p>Here is element of the export button.</p>\n\n<pre><code>&lt;button title=\"Export\" class=\"x7g\" style=\"background-image:url(/xmlpserver/cabo/images/swan/btn-bg1.gif)\" onclick=\"return exportReport('xdoRptForm', '/xmlpserver/ECOM_RDC/MERCHANDISING/SOH_Report/Stock Available For Upload Transfer/Stock Available For Upload Transfer.xdo');\" type=\"button\"&gt;Export&lt;/button&gt;\n</code></pre>\n\n<p>I'm posting my whole module but the code above is the key.</p>\n\n<pre><code>Option Explicit\n\n#If VBA7 Then\n    Declare PtrSafe Function FindWindowEx Lib \"user32\" Alias \"FindWindowExA\" (ByVal hWnd1 As LongPtr, ByVal hWnd2 As LongPtr, ByVal lpsz1 As String, ByVal lpsz2 As String) As LongPtr\n    Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n    Declare PtrSafe Function FindWindow Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As String, ByVal lpWindowName As String) As LongPtr\n    Declare PtrSafe Function SetForegroundWindow Lib \"user32\" (ByVal hWnd As LongPtr) As Long\n    Declare PtrSafe Function SendMessage Lib \"user32\" Alias \"SendMessageA\" (ByVal hWnd As LongPtr, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long\n    Declare PtrSafe Function PostMessage Lib \"user32\" Alias \"PostMessageA\" (ByVal hWnd As LongPtr, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long\n#Else\n    Declare Function FindWindowEx Lib \"user32\" Alias \"FindWindowExA\" (ByVal hWnd1 As LongPtr, ByVal hWnd2 As LongPtr, ByVal lpsz1 As String, ByVal lpsz2 As String) As LongPtr\n    Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n    Declare Function FindWindow Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As String, ByVal lpWindowName As String) As LongPtr\n    Declare Function SetForegroundWindow Lib \"user32\" (ByVal hWnd As LongPtr) As Long\n    Declare Function SendMessage Lib \"user32\" Alias \"SendMessageA\" (ByVal hWnd As LongPtr, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long\n    Declare Function PostMessage Lib \"user32\" Alias \"PostMessageA\" (ByVal hWnd As LongPtr, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long\n#End If\n\nPublic Const BM_CLICK = &amp;HF5\nPublic Const WM_GETTEXT = &amp;HD\nPublic Const WM_GETTEXTLENGTH = &amp;HE\n\nPublic Sub UPL_Reports_Automation()\n\n    Dim IE As SHDocVw.InternetExplorer\n    Dim HTMLDoc As MSHTML.HTMLDocument\n    Dim A, B, C, D, E, F, G, H As MSHTML.IHTMLElement\n    Dim I As Long\n    Dim TargetFolder As String\n    Dim FileName As String\n    Dim FName As String\n\n    Application.ScreenUpdating = False\n\n    On Error GoTo EhhError\n    Application.ActiveWindow.WindowState = xlMinimized\n\n    'Login Screen\n    TargetFolder = \"D:\\TestingDownloaing\"\n    Set IE = New SHDocVw.InternetExplorerMedium\n\n    'Navigate to the Login Page\n    IE.navigate \"http://10.110.10.78:9704/xmlpserver/login.jsp\"\n    IE.Visible = True\n\n    WaitLa 5\n\n    Do While IE.readyState &lt;&gt; READYSTATE_COMPLETE: DoEvents: Loop\n\n    Set HTMLDoc = IE.document\n\n    'To check if the Login page is there or not ?\n    Set D = HTMLDoc.getElementsByClassName(\"xy\")(1)\n\n    'Bypassing the element if the login page is visible.\n    If Not D Is Nothing Then\n        D.Click\n        WaitLa 5\n        Do While IE.readyState &lt;&gt; READYSTATE_COMPLETE: DoEvents: Loop\n        Set HTMLDoc = Nothing\n        Set HTMLDoc = IE.document\n    End If\n\n    'Enter Login ID\n    Set A = HTMLDoc.getElementById(\"id\")\n    A.Value = \"merchandiser\"\n\n    'Enter Password\n    Set B = HTMLDoc.getElementById(\"passwd\")\n    B.Value = \"merchandiser\"\n\n    'Click on Login Button\n    Set C = HTMLDoc.getElementsByClassName(\"submitButtonEnable\")(0)\n    WaitLa 2\n    C.Click\n\n    Do While IE.readyState &lt;&gt; READYSTATE_COMPLETE: DoEvents: Loop\n\n    'Part 2 Navigate to UPL Page\n    IE.navigate \"http://10.110.10.78:9704/xmlpserver/ECOM_RDC/MERCHANDISING/SOH_Report/Stock%20Available%20For%20Upload%20Transfer/Stock%20Available%20For%20Upload%20Transfer.xdo\"\n\n    Do While IE.readyState &lt;&gt; READYSTATE_COMPLETE: DoEvents: Loop\n\n    WaitLa 5\n\n    Set HTMLDoc = Nothing\n    Set HTMLDoc = IE.document\n\n    'Select Template Format\n    Set G = HTMLDoc.getElementById(\"_xf\")\n    G.selectedIndex = 1\n\n    FName = vbNullString\n    FileName = vbNullString\n\n     'Download Territory wise files\n     For I = 1 To 3 Step 1\n\n        Select Case I\n            Case 1\n                'UAE\n                Set F = HTMLDoc.getElementById(\"terr\")\n                F.selectedIndex = 9\n                IE.document.getElementById(\"terr\").FireEvent (\"onchange\")\n                FName = \"UPL-UAE\"\n                WaitLa 9\n\n            Case 2\n                'RIYADH\n                Set F = HTMLDoc.getElementById(\"terr\")\n                F.selectedIndex = 8\n                IE.document.getElementById(\"terr\").FireEvent (\"onchange\")\n                FName = \"UPL-KSA-RIYADH\"\n                WaitLa 9\n\n            Case 3\n                'BAHRAIN\n                Set F = HTMLDoc.getElementById(\"terr\")\n                F.selectedIndex = 1\n                IE.document.getElementById(\"terr\").FireEvent (\"onchange\")\n                FName = \"UPL-BAH\"\n                WaitLa 9\n\n        End Select\n\n         'Creating a File Name\n         FileName = TargetFolder &amp; \"\\\" &amp; FName &amp; \".txt\"\n\n         'Click on Export Button\n         Set H = HTMLDoc.getElementsByClassName(\"x7g\")(1)\n         H.Click\n\n         Call WaitTillFrame(IE)\n\n         'Automation to Download  File\n         Call Download(IE, FileName, True)\n\n    Next I\n\n    IE.Quit\n\nClosedIt:\n\n    Set HTMLDoc = Nothing\n    Set A = Nothing\n    Set B = Nothing\n    Set C = Nothing\n    Set D = Nothing\n    Set E = Nothing\n    Set F = Nothing\n    Set G = Nothing\n    Set H = Nothing\n    Set IE = Nothing\n    Application.ScreenUpdating = True\n\n    Application.ActiveWindow.WindowState = xlMaximized\n\n    Exit Sub\n\nEhhError:\n    If Err.Number &lt;&gt; 0 Then\n        MsgBox Err.Number &amp; vbNewLine &amp; vbNewLine &amp; Err.Description &amp; vbNewLine &amp; vbNewLine &amp; \"Last File Downloaded : \" &amp; FName, vbCritical, \"Error Reporting'\"\n        Resume ClosedIt\n    End If\n\nEnd Sub\n\nPrivate Sub WaitTillFrame(ByVal oBrowser As SHDocVw.InternetExplorer)\n\n    Dim heWnd As LongPtr\n    Dim Ret As LongPtr\n\n    Do Until heWnd &gt; 0\n        Ret = oBrowser.hWnd\n        heWnd = FindWindowEx(Ret, ByVal 0&amp;, \"Frame Notification Bar\", vbNullString)\n        DoEvents\n    Loop\n\nEnd Sub  \n\nSub WaitLa(ByVal Seconds As Byte)\nIf VBA.Val(Seconds) &lt;= 9 Then\n    Call Application.Wait(VBA.Time + VBA.TimeValue(\"00:00:0\" &amp; VBA.Val(Seconds)))\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1546441677, "post_id": 54008472, "comment_id": 94853883, "body": "For count, I would suggest that you just use a formula in column <b>B</b> as you already have a unique list (you could use <code>CountIf</code> as you have done in your code). To paste an array to your range, use <a href=\"https://stackoverflow.com/questions/19300555/paste-vba-array\">Transpose</a>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 3, "creation_date": 1546441701, "post_id": 54008472, "comment_id": 94853900, "body": "Why not use a pivot table?"}, {"owner": {"reputation": 43, "user_id": 10141652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48da2cecbe679e91632bc0f99a124aab?s=128&d=identicon&r=PG&f=1", "display_name": "Nas", "link": "https://stackoverflow.com/users/10141652/nas"}, "edited": false, "score": 0, "creation_date": 1546445181, "post_id": 54008472, "comment_id": 94855712, "body": "thanks. the countif line of code i&#39;ve used will be lenthly for current array lists contain 97 items. Need this in a loop so it&#39;s dynamic and I am not really after count but using this count to work out the percentage over total count of items with prefix say EMT."}], "owner": {"reputation": 43, "user_id": 10141652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48da2cecbe679e91632bc0f99a124aab?s=128&d=identicon&r=PG&f=1", "display_name": "Nas", "link": "https://stackoverflow.com/users/10141652/nas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1546441530, "creation_date": 1546440890, "last_edit_date": 1546441530, "question_id": 54008472, "link": "https://stackoverflow.com/questions/54008472/how-to-loop-through-my-variant-array-for-count-followed-by-calculation", "title": "How to loop through my variant array for count followed by calculation?", "body": "<p>I have created a variant array list of unique items in Sheet1 from master sheet (Sheet3). Now I am not sure how to copy each item in my array and paste it in sheet4 in column A and a count of that item from sheet \"January\" next to it in column B. If I can do that, I can then perform some calculation. Your help will be greatly appreciated</p>\n\n<p>I'm basically trying to build Management Information stats, getting count of items we manage and then work out the percentage of that completed on time.</p>\n\n<p>here's what I have done so far to get a variant array list.</p>\n\n<pre><code>Sub PopulatingArrayVariable_v3()\n\nDim myarray() As Variant\nDim DataRange As range\nDim Cell As range\nDim x As Long\nDim iReport As Integer\n\nDim lastRow As Long\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\nlastRow = Sheets(\"Sheet3\").range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nWith Sheets(\"Sheet3\")\n\n    .range(\"D2:D\" &amp; lastRow).AdvancedFilter Action:=xlFilterCopy, \ncopytorange:=Sheets(\"Sheet1\").range(\"A1\"), Unique:=True\n\nEnd With\n\nSet DataRange = Sheets(\"Sheet1\").UsedRange\n\n\nFor Each Cell In DataRange.Cells\nReDim Preserve myarray(x)\nmyarray(x) = Cell.Value\nx = x + 1\nNext Cell\nFor x = LBound(myarray) To UBound(myarray)\nDebug.Print myarray(x)\nNext x\n\niReport = WorksheetFunction.countif(Sheets(\"January\").range(\"C6:C100\"), \nmyarray(6))\n\nSheets(\"Sheet4\").Activate\nrange(\"A2\") = myarray(6)\nrange(\"B2\") = iReport\n\n//do calculation in % and rounded to 0 decimal point\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\n\nEnd Sub\n</code></pre>\n\n<p>here's example how I want the end table to look like</p>\n\n<pre><code>Items                   Count\nEMT - Pre Production     4\nEMT - Pre Production     5\nEMT - Production         10\nEMT - Post Production    1\nEPT - Pre Production     20\nEPT - Production         10\nEPT - Post Production    5\nAIFMD  - Pre Production  25\nAIFMD  - Production      12\nAIFMD  - Post Production 12\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1546440587, "post_id": 54008332, "comment_id": 94853313, "body": "you could probably save some time and use a application.countif(wsrng,&quot;Yes&quot;)&gt;0 for your desired range, so you don&#39;t have to loop. if true, show, if false, hide."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1546440672, "post_id": 54008332, "comment_id": 94853348, "body": "<code>Worksheets(&quot;Sheet2&quot;).Visible = Application.Countif(Range(&quot;C10:F10&quot;))&gt;0</code>"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1546441067, "post_id": 54008332, "comment_id": 94853527, "body": "@ScottCraner - you forgot the criteria part of the <code>COUNTIF</code>."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1546441131, "post_id": 54008332, "comment_id": 94853571, "body": "@DarrenBartrup-Cook which is why I answered, noticed that after the time limit was up."}], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1546440909, "creation_date": 1546440909, "answer_id": 54008479, "question_id": 54008332, "link": "https://stackoverflow.com/questions/54008332/hide-excel-sheet-based-on-value-of-a-cell-in-a-range/54008479#54008479", "title": "Hide Excel sheet based on value of a cell in a range", "body": "<p>Modify and try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim ws As Worksheet\n    Dim rng As Range, cell As Range\n    Dim Hide As Boolean\n\n    For Each ws In ThisWorkbook.Worksheets\n\n        Set rng = ws.Range(\"C10:F10\")\n\n        For Each cell In rng\n            Hide = False\n            If cell.Value = \"Yes\" Then\n                Hide = False\n                Exit For\n            Else\n                Hide = True\n            End If\n        Next\n\n        If Hide = True Then\n            ws.Visible = False\n        End If\n\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1546441217, "post_id": 54008495, "comment_id": 94853628, "body": "Was thinking of something like that - only possible change would be that if you&#39;re changing a single value in the range <code>C10:F10</code> then you only need check that value: <code>Worksheets(&quot;Sheet2&quot;).Visible = Target = &quot;Yes&quot;</code>"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1546441097, "last_edit_date": 1546441097, "creation_date": 1546440987, "answer_id": 54008495, "question_id": 54008332, "link": "https://stackoverflow.com/questions/54008332/hide-excel-sheet-based-on-value-of-a-cell-in-a-range/54008495#54008495", "title": "Hide Excel sheet based on value of a cell in a range", "body": "<p>No loop needed, and create an If to test whether the Cell that change is in the range to test, just to save some comp time:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Range(\"C10:F10\"),Target) Is Nothing Then\n        Worksheets(\"Sheet2\").Visible = Application.Countif(Range(\"C10:F10\"),\"Yes\")&gt;0\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 3722957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72017c51de08875dec5864cbef366d29?s=128&d=identicon&r=PG&f=1", "display_name": "user3722957", "link": "https://stackoverflow.com/users/3722957/user3722957"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 54008495, "answer_count": 2, "score": 0, "last_activity_date": 1546707367, "creation_date": 1546440261, "last_edit_date": 1546707367, "question_id": 54008332, "link": "https://stackoverflow.com/questions/54008332/hide-excel-sheet-based-on-value-of-a-cell-in-a-range", "title": "Hide Excel sheet based on value of a cell in a range", "body": "<p>I'm trying to hide a sheet in an Excel workbook based on the contents of any of the cells in a given range.</p>\n\n<p>Let's say I have two sheets - \"Sheet1\" and \"Sheet2\".<br>\nOn Sheet1, I want to set up a range - cell C10 to F10.<br>\nEach of these cells can either be blank, or contain \"Yes\" or \"No\" - chosen from a dropdown box.<br>\nIf ANY of the cells in the range are set to \"Yes\", I want Sheet2 to be visible, otherwise (if all the cells are either blank or contain \"No\") I want Sheet2 hidden.</p>\n\n<p>I've tried various pieces of code, including the below.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim rCell As Range\n\n    Application.ScreenUpdating = False\n    For Each rCell In Range(\"C10:F10\")\n        If rCell.Value = \"Yes\" Then\n            Worksheets(\"Sheet2\").Visible = True\n        Else\n            Worksheets(\"Sheet2\").Visible = False\n        End If\n    Next rCell\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>I've got about as far as Sheet 2 being visible if all the cells equal \"Yes\" or if F10 equals \"Yes\", but not if only one of the cells contains \"Yes\".</p>\n"}, {"tags": ["json", "vba", "teradata"], "comments": [{"owner": {"reputation": 4527, "user_id": 8468264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8adc0e0b5afd1ff077dd16a48492c1e0?s=128&d=identicon&r=PG&f=1", "display_name": "d_kennetz", "link": "https://stackoverflow.com/users/8468264/d-kennetz"}, "edited": false, "score": 0, "creation_date": 1546441656, "post_id": 54007505, "comment_id": 94853873, "body": "Is <a href=\"https://docs.teradata.com/reader/hPLK~VSHqqKFSCfWKML4gA/oUiEuR3_uv9IWjyPVjgehQ\" rel=\"nofollow noreferrer\">this site</a> not exactly what you are looking for?"}, {"owner": {"reputation": 81, "user_id": 10801774, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xUnXMiu5A8A/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iPekECOeVGW9aiY8o5VgCRH4h01g/mo/photo.jpg?sz=128", "display_name": "Kair0", "link": "https://stackoverflow.com/users/10801774/kair0"}, "reply_to_user": {"reputation": 4527, "user_id": 8468264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8adc0e0b5afd1ff077dd16a48492c1e0?s=128&d=identicon&r=PG&f=1", "display_name": "d_kennetz", "link": "https://stackoverflow.com/users/8468264/d-kennetz"}, "edited": false, "score": 0, "creation_date": 1546444036, "post_id": 54007505, "comment_id": 94855075, "body": "It&#39;s a part of the answer but i need a script in order to automate the process."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1546548226, "post_id": 54007505, "comment_id": 94895332, "body": "That would be the &quot;Loading JSON Data Using Load Utilities&quot; section on that site where it gives you examples of how to load JSON using TPT with links to the TPT user guide for more in-depth. You&#39;ll have to build a TPT script to point to the file and load into your target table."}], "owner": {"reputation": 81, "user_id": 10801774, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xUnXMiu5A8A/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iPekECOeVGW9aiY8o5VgCRH4h01g/mo/photo.jpg?sz=128", "display_name": "Kair0", "link": "https://stackoverflow.com/users/10801774/kair0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 687, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1546444296, "creation_date": 1546436903, "last_edit_date": 1546444296, "question_id": 54007505, "link": "https://stackoverflow.com/questions/54007505/load-json-file-in-teradata", "title": "Load JSON file in teradata", "body": "<p>I want to know how I can manage to load JSON file in Teradata SQL assistant.\nDo you have any tips?\nBecause i have to import JSON file in TERADATA.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 9834548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b81e94d3ea46059ab08f90580f3f9e26?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9834548/john"}, "edited": false, "score": 0, "creation_date": 1546443318, "post_id": 54008383, "comment_id": 94854692, "body": "That&#39;s brilliant, man - works like a dram, thank you! I don&#39;t have any additional questions. The only issue was with FindLastRow function but I solved it. Great work!"}, {"owner": {"reputation": 43, "user_id": 9834548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b81e94d3ea46059ab08f90580f3f9e26?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9834548/john"}, "edited": false, "score": 0, "creation_date": 1548250778, "post_id": 54008383, "comment_id": 95475090, "body": "Hello, I would like to reopen the thread as there is one problem which I didn&#39;t anticipate. As of now, the macro has problem when in source tabs, the different values appear based on formula. Namely it is either &quot;Check&quot; or blank (&quot;&quot;). Once in filter line there is only those with Check in source tab, the macro doesn&#39;t return correct data (also brings up blanks, but not all of them) I would really appreciate your help on that one."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 43, "user_id": 9834548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b81e94d3ea46059ab08f90580f3f9e26?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9834548/john"}, "edited": false, "score": 0, "creation_date": 1548265439, "post_id": 54008383, "comment_id": 95483353, "body": "I&#39;m a little unclear what you&#39;re asking, and since it seems like a separate question it&#39;s best to go ahead and create a new question. You can link back to this post if you like, but still share example data and code so folks here can have the best chance to get you a quick answer."}, {"owner": {"reputation": 43, "user_id": 9834548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b81e94d3ea46059ab08f90580f3f9e26?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9834548/john"}, "edited": false, "score": 0, "creation_date": 1548418757, "post_id": 54008383, "comment_id": 95544090, "body": "I&#39;ve created another question with the reference to this one as the problem may be considered as different. You may find it here: <a href=\"https://stackoverflow.com/questions/54365213/macro-for-copying-data-based-on-a-formula-based-on-filtered-line\" title=\"macro for copying data based on a formula based on filtered line\">stackoverflow.com/questions/54365213/&hellip;</a>"}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 2, "last_activity_date": 1546440526, "creation_date": 1546440526, "answer_id": 54008383, "question_id": 54007190, "link": "https://stackoverflow.com/questions/54007190/macro-for-copying-data-from-tabs-based-on-filtered-line/54008383#54008383", "title": "Macro for copying data from tabs based on filtered line", "body": "<p>So here is almost your same approach, just reworked into a form that isolates each step of your process clarify what you want to accomplish. Having a nested loop is not a problem, as long as you keep track of what you're trying to do. What I do want to steer you away from is using <code>GoTo</code> statements. They are almost never necessary.</p>\n\n<p>So first things first...</p>\n\n<p>Always use <code>Option Explicit</code> and declare your variables as close as possible to where you want to use them. This habit makes it easier to understand what each variable is and what it's used for. If you declare them all at the top, you'll always be popping back and forth to find them.</p>\n\n<pre><code>Option Explicit\n\nSub CopyFilteredData()\n    Dim srcWB As Workbook\n    Dim srcWS As Worksheet\n    Set srcWB = ActiveWorkbook\n    Set srcWS = srcWB.Sheets(\"Summary (Filtered)\")\n</code></pre>\n\n<p>Since you will always be referring to your filter in the same location, just define a variable that specifically matches your filter. The bonus here is if your filter changes from row 7 to row 8 (for example), you only have to change it in one spot.</p>\n\n<pre><code>    Dim srcFilter As Range\n    Set srcFilter = srcWS.Range(\"A7\").Resize(1, 16)\n</code></pre>\n\n<p>Using the same idea, set up a variable that clearly defines the worksheets to skip:</p>\n\n<pre><code>    Dim skipTheseSheets As Variant\n    skipTheseSheets = Array(srcWS.Name, \"List Data\", \"Summary (All)\", \"Lists\")\n    Dim sh As Worksheet\n    For Each sh In srcWB.Sheets\n        If Not IsInArray(sh.Name, skipTheseSheets) Then\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/a/11112305/4717755\">This answer</a> gives an excellent function to check if your worksheet name exists in that array.</p>\n\n<p>You didn't include your function for <code>LastRow</code>, so I included it in my answer. However, make a habit of naming your functions using a verb that is descriptive of what the function does. In this case <code>FindLastRow</code>.</p>\n\n<p>In order to stop using <code>GoTo</code> statements, just reverse the <code>If</code> statement and proceed if it passes:</p>\n\n<pre><code>Dim lastRow As Long\nlastRow = FindLastRow(sh)\nIf lastRow &gt; 7 Then\n</code></pre>\n\n<p>I created a separate function that compares a given row against your filter. It uses basically your same logic, but by isolating it as a function, it makes your main logic read more simply. Also, notice that you can exit a <code>For</code> loop and avoid the dreaded <code>GoTo</code>:</p>\n\n<pre><code>Private Function RowMatchesFilter(ByRef thisRow As Range, _\n                                  ByRef thisFilter As Range) As Boolean\n    '--- the row matches only if the value in thisRow equals the value\n    '    in the filter\n    RowMatchesFilter = True\n    Dim i As Long\n    For i = 1 To 16\n        If Not IsEmpty(thisFilter.Cells(1, i).Value) Then\n            If thisRow.Cells(1, i).Value &lt;&gt; thisFilter.Cells(1, i).Value Then\n                '--- the first cell that doesn't match invalidates the\n                '    entire row\n                RowMatchesFilter = False\n                Exit For\n            End If\n        End If\n    Next i\nEnd Function\n</code></pre>\n\n<p>So your copy loop ends up looking like this:</p>\n\n<pre><code>Dim r As Long\nFor r = lastRow To 7 Step -1\n    If RowMatchesFilter(sh.Rows(r), srcFilter) Then\n        sh.Rows(r).Copy\n        srcWS.Range(\"A\" &amp; FindLastRow(srcWS) + 1).PasteSpecial xlPasteAll\n    End If\nNext r\n</code></pre>\n\n<p>Here is the whole module:</p>\n\n<pre><code>Option Explicit\n\nSub CopyFilteredData()\n    Dim srcWB As Workbook\n    Dim srcWS As Worksheet\n    Set srcWB = ActiveWorkbook\n    Set srcWS = srcWB.Sheets(\"Summary (Filtered)\")\n\n    Dim srcFilter As Range\n    Set srcFilter = srcWS.Range(\"A7\").Resize(1, 16)\n\n    Dim skipTheseSheets As Variant\n    skipTheseSheets = Array(srcWS.Name, \"List Data\", \"Summary (All)\", \"Lists\")\n\n    Dim sh As Worksheet\n    For Each sh In srcWB.Sheets\n        If Not IsInArray(sh.Name, skipTheseSheets) Then\n            Dim lastRow As Long\n            lastRow = FindLastRow(sh)\n            If lastRow &gt; 7 Then\n                '--- now copy the data from this sheet back to the source\n                '    in reverse order, using the source filter line to\n                '    direct which cells to copy\n                Dim r As Long\n                For r = lastRow To 7 Step -1\n                    If RowMatchesFilter(sh.Rows(r), srcFilter) Then\n                        sh.Rows(r).Copy\n                        srcWS.Range(\"A\" &amp; FindLastRow(srcWS) + 1).PasteSpecial xlPasteAll\n                    End If\n                Next r\n            End If\n        End If\n    Next sh\nEnd Sub\n\nPrivate Function IsInArray(ByVal stringToBeFound As String, _\n                           ByRef arr As Variant) As Boolean\n  IsInArray = (UBound(Filter(arr, stringToBeFound)) &gt; -1)\nEnd Function\n\nPrivate Function FindLastRow(ByRef thisWS As Worksheet) As Long\n    With thisWS\n        FindLastRow = .Cells(.Cells.Rows.Count, 1).End(xlUp).Row\n    End With\nEnd Function\n\nPrivate Function RowMatchesFilter(ByRef thisRow As Range, _\n                                  ByRef thisFilter As Range) As Boolean\n    '--- the row matches only if the value in thisRow equals the value\n    '    in the filter\n    RowMatchesFilter = True\n    Dim i As Long\n    For i = 1 To 16\n        If Not IsEmpty(thisFilter.Cells(1, i).Value) Then\n            If thisRow.Cells(1, i).Value &lt;&gt; thisFilter.Cells(1, i).Value Then\n                '--- the first cell that doesn't match invalidates the\n                '    entire row\n                RowMatchesFilter = False\n                Exit For\n            End If\n        End If\n    Next i\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 9834548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b81e94d3ea46059ab08f90580f3f9e26?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9834548/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 54008383, "answer_count": 1, "score": 1, "last_activity_date": 1566196191, "creation_date": 1546435502, "last_edit_date": 1566196191, "question_id": 54007190, "link": "https://stackoverflow.com/questions/54007190/macro-for-copying-data-from-tabs-based-on-filtered-line", "title": "Macro for copying data from tabs based on filtered line", "body": "<p>I would like to have a macro which copies all data from several tabs, which are in line with filter line defined in \"Summary (Filtered)\" tab. Here are the details:</p>\n\n<ol>\n<li>All tabs have the same headers. </li>\n<li>The filter line is row 7 in tab \"Summary (Filtered)\". </li>\n<li>I want to loop through every tab except for those listed below, check every row and copy it to Summary tab if it satisfies the filter (if given cell in filter line is empty, all values are permitted, otherwise it must match). </li>\n<li>I would like the copying to start in line 9 of Summary tab. </li>\n</ol>\n\n<p>I have tried to solve it by the loop functions, but I get application or object defined error. Also, I imagine that the effectiveness of double loops is very poor. </p>\n\n<pre><code>Sub CopyDataFiltered()\n    Dim sh          As Worksheet\n    Dim SourceSh    As Worksheet\n    Dim Last        As Long\n    Dim shLast      As Long\n    Dim CopyRng     As Range\n    Dim StartRow    As Long\n    Dim lrow        As Long\n    Dim r           As Long\n    Dim col         As Long\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    Set SourceSh = ActiveWorkbook.Worksheets(\"Summary (Filtered)\")\n    Application.DisplayAlerts = False\n    On Error Resume Next\n    On Error GoTo 0\n\n    For Each sh In ActiveWorkbook.Worksheets\n        If IsError(Application.Match(sh.Name, Array(SourceSh.Name, \"List Data\", \"Summary (All)\", \"Lists\"), 0)) Then\n\n            lrow = LastRow(sh)\n\n            If lrow &lt; 7 Then\n                'MsgBox (\"Nothing to move\")\n                GoTo NextTab\n            End If\n\n            For r = LastRow(sh) To 7 Step -1\n                For col = 1 To 16\n\n                    If SourceSh.Range(7, col).Value &lt;&gt; \"\" And SourceSh.Range(7, col).Value &lt;&gt; sh.Range(r, col).Value Then\n                        GoTo End1\n                    End If\n\n                Next col\n                sh.Rows(r).Copy Destination:=SourceSh.Range(\"A\" &amp; LastRow(SourceSh) + 1)\n\nEnd1:\n            Next r\n        End If\nNextTab:\n    Next\n\nExitTheSub:\n    Application.Goto SourceSh.Cells(1)\n    Application.DisplayAlerts = True\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\nEnd Sub\n</code></pre>\n\n<p>Could you please take a look and let me know what you think would be the best?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1546434259, "post_id": 54006871, "comment_id": 94850303, "body": "<code>RandomNumber = 3 Or RandomNumber = 6 etc</code>"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1546434543, "post_id": 54006871, "comment_id": 94850417, "body": "You also have a &quot;single&quot; <code>else</code>  in your code. The line <code>Balance = Balance - PlayerBet</code> will always run."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1546849355, "post_id": 54006871, "comment_id": 94974145, "body": "Why those useless <code>-0</code>and <code>+0</code> ?"}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 2, "last_activity_date": 1546434893, "last_edit_date": 1546434893, "creation_date": 1546434256, "answer_id": 54006892, "question_id": 54006871, "link": "https://stackoverflow.com/questions/54006871/how-to-make-if-and-statement-work-in-excel-to-see-if-a-variable-equals-any-of/54006892#54006892", "title": "How to make If \u2026 And statement work in Excel to see if a variable equals any of a set of numbers", "body": "<p>You need to write </p>\n\n<pre><code>RandomNumber = 3 Or 6 Or 9 ...\n</code></pre>\n\n<p>as </p>\n\n<pre><code>RandomNumber = 3 or RandomNumber = 6 Or RandomNumber = 9 ...\n</code></pre>\n\n<p>Better still, use <code>RandomNumber Mod 3 = 0</code> (checking explicitly if <code>RandonNumber</code> is not <code>0</code> if that really is a possibility that you don't want). Putting this together you get</p>\n\n<pre><code>If Bet_input = \"Column 1\" And RandomNumber Mod 3 = 0 Then\n    Balance = Balance + PlayerBet * 2\nElse\n    Balance = Balance - PlayerBet\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1546434776, "creation_date": 1546434776, "answer_id": 54007016, "question_id": 54006871, "link": "https://stackoverflow.com/questions/54006871/how-to-make-if-and-statement-work-in-excel-to-see-if-a-variable-equals-any-of/54007016#54007016", "title": "How to make If \u2026 And statement work in Excel to see if a variable equals any of a set of numbers", "body": "<p>@Magnus Henden could you please try the below code and provide a feedback?</p>\n\n<pre><code>Option Explicit\nSub Column_bet_1st()\n\n Dim PlayerBet As Range, Balance As Range, Bet_input As Range, RandomNumber As Long\n\n    'Refe to specific worksheet\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        Set PlayerBet = .Range(\"O21\")\n\n        Set Balance = .Range(\"L18\")\n\n        Set Bet_input = .Range(\"O18\")\n\n        RandomNumber = Int((36 - 0 + 1) * Rnd + 0)\n\n        If Bet_input = \"Column 1\" And (RandomNumber = 3 Or _\n                                        RandomNumber = 6 Or _\n                                        RandomNumber = 9 Or _\n                                        RandomNumber = 12 Or _\n                                        RandomNumber = 15 Or _\n                                        RandomNumber = 18 Or _\n                                        RandomNumber = 21 Or _\n                                        RandomNumber = 24 Or _\n                                        RandomNumber = 27 Or _\n                                        RandomNumber = 30 Or _\n                                        RandomNumber = 33 Or _\n                                        RandomNumber = 36) Then\n            Balance = Balance + PlayerBet * 2\n        Else\n            Balance = Balance - PlayerBet\n        End If\n\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1546434924, "post_id": 54007028, "comment_id": 94850585, "body": "&quot;9 Mod 3&quot; - Oops."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1546434968, "post_id": 54007028, "comment_id": 94850611, "body": "Yeah, just saw it... oops. :)  Sorry, didn&#39;t see the <code>MOD</code> version you used in your answer... have an upvote to!"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1546435019, "post_id": 54007028, "comment_id": 94850633, "body": "No problem at all. Stack Overflow works best if there are a selection of answers as we all tend to emphasise different things. Using a <code>Mod</code> is really the only sane thing to do."}, {"owner": {"reputation": 31, "user_id": 5603921, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207744087017639/picture?type=large", "display_name": "Magnus Henden", "link": "https://stackoverflow.com/users/5603921/magnus-henden"}, "edited": false, "score": 1, "creation_date": 1546460696, "post_id": 54007028, "comment_id": 94862199, "body": "Thanks so much, i found out that none worked cause i had a problem with my randomnumber, so i changed some stuff and now this code is perfect, thanks so much for the help! ... i used the case one, as i liked it the best hehe"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 2, "last_activity_date": 1546434935, "last_edit_date": 1546434935, "creation_date": 1546434845, "answer_id": 54007028, "question_id": 54006871, "link": "https://stackoverflow.com/questions/54006871/how-to-make-if-and-statement-work-in-excel-to-see-if-a-variable-equals-any-of/54007028#54007028", "title": "How to make If \u2026 And statement work in Excel to see if a variable equals any of a set of numbers", "body": "<p>Three ways I can think of doing it:  </p>\n\n<p>Your corrected original code:  </p>\n\n<pre><code>If Bet_input = \"Column 1\" And (RandomNumber = 3 Or RandomNumber = 6 Or _\n                               RandomNumber = 9 Or RandomNumber = 12 Or _\n                               RandomNumber = 15 Or RandomNumber = 18 Or _\n                               RandomNumber = 21 Or RandomNumber = 24 Or _\n                               RandomNumber = 27 Or RandomNumber = 30 Or _\n                               RandomNumber = 33 Or RandomNumber = 36) Then\n    Balance = Balance + PlayerBet * 2\nElse\n    Balance = Balance - PlayerBet\nEnd If\n</code></pre>\n\n<p>Or, as RandomNumber must be a multiple of 3 to be a win:  </p>\n\n<pre><code>If Bet_input = \"Column 1\" And RandomNumber &lt;= 36 Then\n    If RandomNumber Mod 3 = 0 Then\n        Balance = Balance + PlayerBet * 2\n    Else\n        Balance = Balance - PlayerBet\n    End If\nEnd If  \n</code></pre>\n\n<p>Or using a <code>Select...Case</code> statement:  </p>\n\n<pre><code>If Bet_input = \"Column 1\" Then\n    Select Case RandomNumber\n        Case 3, 6, 9, 12, 15, 18, 21, 24, 27, 30, 33, 36\n            Balance = Balance + PlayerBet * 2\n        Case Else\n            Balance = Balance - PlayerBet\n    End Select\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5603921, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207744087017639/picture?type=large", "display_name": "Magnus Henden", "link": "https://stackoverflow.com/users/5603921/magnus-henden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 54007028, "answer_count": 3, "score": 0, "last_activity_date": 1566196196, "creation_date": 1546434151, "last_edit_date": 1566196196, "question_id": 54006871, "link": "https://stackoverflow.com/questions/54006871/how-to-make-if-and-statement-work-in-excel-to-see-if-a-variable-equals-any-of", "title": "How to make If \u2026 And statement work in Excel to see if a variable equals any of a set of numbers", "body": "<p>I am making a Roulette table in excel for a project. I have a random number variable named RandomNumber which generates and stores a random value between 0 and 36 in a cell, which does work. But When i write an if statement to check if RandomNumber equals one of the numbers that would make that bet be a winning bet it does not work. Like in the code below, it allways returns succesfull when it should be false, as it appears that it just sees all of the numbers between all the \"Or's\".</p>\n\n<p>Sorry for bad english, thanks for any input</p>\n\n<p>I tried several Match and Ranges in the worksheet to make it work.</p>\n\n<pre><code>Sub Column_bet_1st()\n\n Dim PlayerBet As Range, Balance As Range, Bet_input As Range, RandomNumber As Integer\n\n    Set PlayerBet = Range(\"O21\")\n\n    Set Balance = Range(\"L18\")\n\n    Set Bet_input = Range(\"O18\")\n\n    RandomNumber = Int((36 - 0 + 1) * Rnd + 0)\n\nIf Bet_input = \"Column 1\" And RandomNumber = 3 Or 6 Or 9 Or 12 Or 15 Or 18 Or 21 Or 24 Or 27 Or 30 Or 33 Or 36 Then Balance = Balance + PlayerBet * 2 Else\nBalance = Balance - PlayerBet\n\nEnd Sub\n</code></pre>\n\n<p>Expected results are that the if statement will only look for those numbers as shown in the code and return false if RandomNumber does not equal any of them.</p>\n"}, {"tags": ["excel", "vba", "web-scraping"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10358702"}, "edited": false, "score": 0, "creation_date": 1546434658, "post_id": 54006955, "comment_id": 94850464, "body": "Because my guess is that the site has a mechanism that watch if I navigate to the same pages in the same order"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1546434804, "post_id": 54006955, "comment_id": 94850533, "body": "Fair enough, if you&#39;re creating a Scraper personally I&#39;d use Python and Scrapy for this instead of VBA"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10358702"}, "edited": false, "score": 0, "creation_date": 1546435002, "post_id": 54006955, "comment_id": 94850624, "body": "I have more questions for python :) like if can i export what i get to excel that is why i stay for now with vba"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1546435097, "post_id": 54006955, "comment_id": 94850670, "body": "You can use Python to generate a csv file fairly easily or there are Python Modules which will create a Workbook. Either of which you could then open in Excel"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10358702"}, "edited": false, "score": 0, "creation_date": 1546435521, "post_id": 54006955, "comment_id": 94850877, "body": "Have you got any python tutorial link to share please?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1546435588, "post_id": 54006955, "comment_id": 94850912, "body": "Scrapy have there own tutorial you can take a look at <a href=\"https://doc.scrapy.org/en/latest/intro/tutorial.html#\" rel=\"nofollow noreferrer\">linky</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1546458897, "post_id": 54006955, "comment_id": 94861546, "body": "Move the .Visible out of the loop and use .navigate2 would be useful."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1546459614, "post_id": 54006955, "comment_id": 94861822, "body": "@QHarr what\u2019s the difference between .navigate and .navigate2?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1546459856, "post_id": 54006955, "comment_id": 94861912, "body": "I don&#39;t know whether there are more benefits but it is an extension of the existing method. <a href=\"https://stackoverflow.com/questions/4538097/ie-com-object-difference-between-methode-navigate-and-navigate2\" title=\"ie com object difference between methode navigate and navigate2\">stackoverflow.com/questions/4538097/&hellip;</a>   and <a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa752094(v%3Dvs.85)\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/previous-versions/windows/&hellip;</a>"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 0, "last_activity_date": 1546459579, "last_edit_date": 1546459579, "creation_date": 1546434509, "answer_id": 54006955, "question_id": 54006830, "link": "https://stackoverflow.com/questions/54006830/navigate-a-range-of-urls-in-random-order/54006955#54006955", "title": "Navigate a range of URLs in random order", "body": "<p>You could try something like the following. This will generate a random number between 2 and 50, test if it has been used before (by comparing against a dictionary of used values) and then navigate. Although, I'm not entirely sure why you'd want to do this.</p>\n\n<pre><code>Dim UsedNumber As Object\nDim RndNumber As Long, MinNumber as long, MaxNumber as long\nDim j As Long\n\nMinNumber = 2\nMaxNumber = 50\nSet UsedNumber = CreateObject(\"Scripting.Dictionary\")\n\nWith ie\n    .Visible = True\n    For j = MinNumber To MaxNumber\n        Do\n            RndNumber = Int((MaxNumber - MinNumber + 1) * Rnd + MinNumber)\n        Loop While UsedNumber.exists(RndNumber)\n        UsedNumber.Add RndNumber, RndNumber\n\n        Debug.Print RndNumber\n\n        mylink = wks.Cells(RndNumber, 2).Value\n\n        .Navigate mylink\n    Next j\nEnd With\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10358702"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 54006955, "answer_count": 1, "score": 0, "last_activity_date": 1609911428, "creation_date": 1546433934, "last_edit_date": 1609911428, "question_id": 54006830, "link": "https://stackoverflow.com/questions/54006830/navigate-a-range-of-urls-in-random-order", "title": "Navigate a range of URLs in random order", "body": "<p>I have a range of cells containing URLs.<br />\nI navigate to them using a for loop like the following to get data.<br />\nI want to add some randomness.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>With ie\n    For j = 2 To 50\n        mylink = wks.Cells(j, 2).Value\n        .Visible = True\n        .Navigate mylink\n\n       'rest of code\n\n    Next\nEnd with\n</code></pre>\n<p>How can I pick a cell with a URL, navigate to it and go to the next random cell without open them again?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1546431487, "post_id": 54006216, "comment_id": 94848918, "body": "1) Read up on declaring variables (and using Option Explicit); 2) Indent your code to make it more readable; 3) Tell us which line errors."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1546431673, "post_id": 54006216, "comment_id": 94849001, "body": "And also consider that a variable that you did not set to a value will have an inital value. As you did not set <code>i</code> it will be an empty atring and <code>Cells(i,j)</code> will throw an error."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1546433667, "post_id": 54006216, "comment_id": 94850011, "body": "If that&#39;s all you are trying to achieve than you don&#39;t need VBA for this. You could use <b>Conditional Formatting</b> to highlight your cell and then get a count by using <code>Formulas</code>. Even better approach would be just to use formulas to get the count unless you really want to highlight the rows"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1546436297, "post_id": 54006216, "comment_id": 94851259, "body": "Your first <code>IF</code> statement doesn&#39;t need an <code>End If</code> on the  next line as it&#39;s using single line syntax, your second <code>IF</code> statement does as it&#39;s using multi-line syntax. <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/if-then-else-statement\" rel=\"nofollow noreferrer\">IF...THEN...ELSE</a>.   When I compile the code I get an <code>End If without block If</code> error (providing I&#39;m not using <code>Option Explicit</code> in which case I get a <code>variable not defined</code> error)."}], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1546433632, "creation_date": 1546433632, "answer_id": 54006764, "question_id": 54006216, "link": "https://stackoverflow.com/questions/54006216/vba-macro-with-multiple-tasks/54006764#54006764", "title": "VBA macro with multiple tasks", "body": "<p>Below i try to provide as much details as i can to fully explain each step. Make the necessary changes and try the below:</p>\n\n<pre><code>Option Explicit\nPublic Sub test()\n\n    Dim StartRow As Long, StartColumn As Long, LastColumn As Long, Lastrow As Long, i As Long, j As Long, CounterValues As Long, CounterRows As Long\n\n    StartRow = 2 'From which row will start the loop\n    StartColumn = 1 'From which column will start the loop\n    CounterRows = 0 'Reset Counter\n\n    'Refer to the worksheets you work on\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        Lastrow = .Cells(.Rows.Count, \"A\").End(xlUp).Row 'Find the last row of column A\n\n        'Loop Each Row from StartRow(2) to Lastrow (6)\n        For i = StartRow To Lastrow\n\n            LastColumn = .Cells(i, .Columns.Count).End(xlToLeft).Column 'Find the last column of row i\n\n            'Loop Each Column from StartColumn(1) To LastColumn(4)\n            CounterValues = 0\n            For j = StartColumn To LastColumn\n\n                If .Cells(i, j).Value &gt;= 9 Then\n                    CounterValues = CounterValues + 1\n                End If\n\n            Next j\n\n            'If all values are equal or greater thant 9\n            If CounterValues = LastColumn Then\n                'Color first row cell\n                .Cells(i, 1).Font.Color = RGB(255, 0, 0)\n                'Count color rows\n                CounterRows = CounterRows + 1\n            End If\n\n        Next i\n\n        MsgBox CounterRows\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10743202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08fdb8a64f0c0e3323d932b3ed48fb7d?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/10743202/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 414, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566196210, "creation_date": 1546431352, "last_edit_date": 1566196210, "question_id": 54006216, "link": "https://stackoverflow.com/questions/54006216/vba-macro-with-multiple-tasks", "title": "VBA macro with multiple tasks", "body": "<p>I'm working on an excel macro that does a number of things:\nChecks for a row that has all values equal or greater than 9\nIf said row's has all values like that it will highlight first cell in A column in red and after checking all rows it will output number of rows it highlighted.\nSo far I'm stuck with a code that gives a compiler error - expected function or variable. Could anyone assist in figuring this one out?</p>\n\n<pre><code>Public Sub test()\n\n    S = 0\n    j = 1\n    A = 0\n    For j = 3 To 7 Step 1\n        If Cells(i, j) &gt;= 9 Then A = A + 1\n        End If\n    Next\n    If A = 5 Then\n        Cells(1, j).Font.Color = RGB(255, 0, 0)\n        S = S + 1\n    End If\n    MsgBox (S)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10857442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de6272ca86fcfb0df34452f577c01c3f?s=128&d=identicon&r=PG&f=1", "display_name": "Vanhinsbergh", "link": "https://stackoverflow.com/users/10857442/vanhinsbergh"}, "edited": false, "score": 0, "creation_date": 1546772260, "post_id": 54008682, "comment_id": 94954979, "body": "Hi Thomas G,  Where would this piece of code be placed?   In my sample code above, you can see where I assumed it would go; I&#39;ve entered the following note -   &#39;I assume I need to compare fileModDate to current date here. IF this is today&#39;s date then continue, IF NOT, then prompt user with message, &quot;Button date does not match today&#39;s date&quot;. Do not allow user to continue until they have clicked a button for which the fileModDate = today&#39;s date.  I&#39;ve tested this, and nothing happens; I might be wrong in thinking this is where the piece of code needs to be inserted though."}, {"owner": {"reputation": 3, "user_id": 10857442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de6272ca86fcfb0df34452f577c01c3f?s=128&d=identicon&r=PG&f=1", "display_name": "Vanhinsbergh", "link": "https://stackoverflow.com/users/10857442/vanhinsbergh"}, "edited": false, "score": 0, "creation_date": 1546789276, "post_id": 54008682, "comment_id": 94959264, "body": "Thomas G, I figured out where to put the code and it works a treat, thank you for your help! :)"}], "tags": [], "owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "is_accepted": true, "score": 0, "last_activity_date": 1546441728, "creation_date": 1546441728, "answer_id": 54008682, "question_id": 54006080, "link": "https://stackoverflow.com/questions/54006080/ms-access-button-is-using-filemoddate-f-datelastmodifiedhow-do-i-compare-the/54008682#54008682", "title": "MS-Access button is using fileModDate = f.DateLastModified;how do I compare the fileModDate to todays date", "body": "<p>Is this what you want ?</p>\n\n<pre><code>    If Format(F.DateLastModified, \"dd/mm/yyyy\") &lt;&gt; Format(Now, \"dd/mm/yyyy\") Then\n        MsgBox (\"Button date does not match today's date\")\n        Exit Sub\n    End If\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10857442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de6272ca86fcfb0df34452f577c01c3f?s=128&d=identicon&r=PG&f=1", "display_name": "Vanhinsbergh", "link": "https://stackoverflow.com/users/10857442/vanhinsbergh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 54008682, "answer_count": 1, "score": 0, "last_activity_date": 1546441728, "creation_date": 1546430845, "last_edit_date": 1546431537, "question_id": 54006080, "link": "https://stackoverflow.com/questions/54006080/ms-access-button-is-using-filemoddate-f-datelastmodifiedhow-do-i-compare-the", "title": "MS-Access button is using fileModDate = f.DateLastModified;how do I compare the fileModDate to todays date", "body": "<p>In this database there are buttons for each day of the week; user is required to click the button relating to the current day of the week and this executes some basic functions. I need to add in a contingency which makes the code look at the last modified date of the files that the button will look at and compare it to today's date. If the last modified date isn't today's date then I don't want the user to be able to execute the commands behind that button, and be forced to execute the correct button, which does actually relate to the current day of the week.</p>\n\n<pre><code>Private Sub Command19_Click()\n\n    Dim FSO As Object\n\n    Dim FromPath As String\n    Dim ToPath As String\n    Dim FileExt As String\n\n    Dim fileModDate As String\n\n    Dim Response2 As Integer\n\n    'To have a second message box, do I need to set another parameter here? I.E Dim Response3 As Integer (?)\n\n    Set fs = CreateObject(\"Scripting.FileSystemObject\")\n    Set f = fs.GetFile(\"\\\\file_path\\file_name.csv\")\n\n    fileModDate = f.DateLastModified\n\n    Response2 = MsgBox(prompt:=\"Files are dated - \" &amp; fileModDate &amp; \". Do you wish to Continue?\", Buttons:=vbYesNo)\n\n    If Response2 = vbNo Then\n\n        Exit Sub\n\n    Else\n\n        'I assume I need to compare fileModDate to current date here. IF this is today's date then continue, IF NOT, then prompt user with message, \"Button date does not match today's date\". Do not allow user to continue until they have clicked a button for which the fileModDate = today's date.\n\n    End If\n\n    FromPath = \"\\\\file_path\"\n    ToPath = \"\\\\file_path\"\n\n    MsgBox \"Files Copied\"\n\nEnd Sub\n</code></pre>\n\n<p>I'm aware that this code won't look right in the post but as this is my first time posting here, I would appreciate if someone could point out my error. Also, I have searched the site for answers to this question and have not found an answer relating to this specific example. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1546430530, "post_id": 54005830, "comment_id": 94848521, "body": "Try early binding by adding reference to excel object"}, {"owner": {"reputation": 81, "user_id": 3776029, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/129988ee36378ba9b9c92a0766325d11?s=128&d=identicon&r=PG&f=1", "display_name": "Sara Menoncin", "link": "https://stackoverflow.com/users/3776029/sara-menoncin"}, "reply_to_user": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1546437220, "post_id": 54005830, "comment_id": 94851725, "body": "Thank you for your time and help, but I found the solution and the problem wasn&#39;t in the code. I add it as an answer to my own post."}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 3776029, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/129988ee36378ba9b9c92a0766325d11?s=128&d=identicon&r=PG&f=1", "display_name": "Sara Menoncin", "link": "https://stackoverflow.com/users/3776029/sara-menoncin"}, "is_accepted": true, "score": 1, "last_activity_date": 1546437121, "creation_date": 1546437121, "answer_id": 54007561, "question_id": 54005830, "link": "https://stackoverflow.com/questions/54005830/excel-application-visibile-not-working-on-office-2016/54007561#54007561", "title": "Excel.Application.Visibile not working on Office 2016", "body": "<p>I found the solution. <br>\nThe problem wasn't in the code but in some Excel's settings. </p>\n\n<p>First, I modified the code in order to get a more detailed error. Basically I switched the two instructions which allow Excel App to be visibile and the file to be opened:</p>\n\n<pre><code>obj.Visible = True\nobj.Workbooks.Open \"c:\\temp\\test.xls\"\n</code></pre>\n\n<p>In this way, I was able to open Excel App and read the reason why the file could not be opened.</p>\n\n<p><a href=\"https://i.stack.imgur.com/IBJL9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IBJL9.png\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see the file type is <code>Excel 4 Worksheets</code> which is blocked on opening.</p>\n\n<p>I had to go <code>Trust Center</code> and disable it.\nJust to be sure, I disabled also <code>Excel 4 Workbook</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/AIapx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AIapx.png\" alt=\"enter image description here\"></a></p>\n\n<p>After performing the steps above, my app worked.</p>\n"}], "owner": {"reputation": 81, "user_id": 3776029, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/129988ee36378ba9b9c92a0766325d11?s=128&d=identicon&r=PG&f=1", "display_name": "Sara Menoncin", "link": "https://stackoverflow.com/users/3776029/sara-menoncin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 54007561, "answer_count": 1, "score": 1, "last_activity_date": 1548679041, "creation_date": 1546429799, "last_edit_date": 1548679041, "question_id": 54005830, "link": "https://stackoverflow.com/questions/54005830/excel-application-visibile-not-working-on-office-2016", "title": "Excel.Application.Visibile not working on Office 2016", "body": "<p><br>\nI need help reguarding the following code written in Visual Basic 6.0.</p>\n\n<pre><code>Private Sub cmdExcel_Click()\nDim obj As Object\n\nSet obj = CreateObject(\"Excel.Application\")\n\nOn Error Resume Next\n   MkDir \"c:\\temp\"\nOn Error GoTo 0\n\nMousePointer = vbHourglass\n\nOn Error GoTo err\n\nobjGrid.m.ExportToXLS \"c:\\temp\\test.xls\"\n\nobj.Workbooks.Open \"c:\\temp\\test.xls\"\nobj.Visible = True\nobj.Interactive = True\n\n\nOn Error GoTo 0\n\nerr:\n  MousePointer = vbNormal\n\nEnd Sub\n</code></pre>\n\n<p><strong>The enviroment</strong>: Windows 10, Office Excel 2016.</p>\n\n<p><strong>The problem</strong>: the workbook doesn't show up, but I can still find an Excel instance in Task Manager. If I shut down the instance I can find the Excel in <code>c:\\temp</code> and the application starts working again.</p>\n\n<p><strong>The goal</strong>: show the Excel just created.</p>\n\n<p>Do you have any solutions?</p>\n\n<p>Thanks in advance.<br>\nSara</p>\n"}, {"tags": ["vba", "compiler-errors"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1546434248, "post_id": 54005748, "comment_id": 94850297, "body": "<code>Because until now the VBA code was running fine on that PC, for years</code> - That could have not been the case. VBA7 and the <code>PtrSafe</code> keyword <a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2010/ee691831(v=office.14)#introducing-the-32-bit-and-64-bit-versions-of-microsoft-office-2010\" rel=\"nofollow noreferrer\">were introduced in Office 2010</a> like the duplicate question <a href=\"https://stackoverflow.com/questions/26822004/declare-ptrsafe-compatibility-in-excel#comment42222445_26822004\">also mentions</a>. If that code worked before, then you must have had Office 2010+ and then downgraded it to 2007."}, {"owner": {"reputation": 1997, "user_id": 4409883, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/xZatI.jpg?s=128&g=1", "display_name": "Edgar", "link": "https://stackoverflow.com/users/4409883/edgar"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1546477671, "post_id": 54005748, "comment_id": 94867349, "body": "Thank @GSerg, I appreciate your time to answer this. Now I remember the PC had a some stage, years ago, Office 2010 installed but then it was replaced by Office 2007. Like I mentioned above, I am not the admin of that PC. It seems there was some leftover from Office 2010 which caused that strange behavior. Now I asked the admin to update it to 2010+..."}], "owner": {"reputation": 1997, "user_id": 4409883, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/xZatI.jpg?s=128&g=1", "display_name": "Edgar", "link": "https://stackoverflow.com/users/4409883/edgar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "closed_date": 1546429669, "answer_count": 0, "score": 0, "last_activity_date": 1546432544, "creation_date": 1546429461, "last_edit_date": 1546432544, "question_id": 54005748, "link": "https://stackoverflow.com/questions/54005748/new-compile-error-for-declare-ptrsafe-function-what-changed-in-windows", "closed_reason": "Duplicate", "title": "New Compile Error for &quot;Declare PtrSafe Function&quot; - what changed in Windows?", "body": "<p>I have since years in my VBA code in MS Access the following lines:</p>\n\n<pre><code>Private Declare PtrSafe Function CoCreateGuid Lib \"ole32.dll\" (guid As GUID_TYPE) As LongPtr\nPrivate Declare PtrSafe Function StringFromGUID2 Lib \"ole32.dll\" (guid As GUID_TYPE, ByVal lpStrGuid As LongPtr, ByVal cbMax As Long) As LongPtr\n</code></pre>\n\n<p>And until now that worked fine on all PCs.</p>\n\n<p>Now, since today, I get a compile error on one PC with Windows 10 and Office 2007 32bit.</p>\n\n<p>I guess Windows updated something automatically. But I am not the administrator of that PC and I see the error only on one PC.</p>\n\n<p>The word PtrSafe is highlighted at when \"Compile Error\" is shown.</p>\n\n<p>Does anybody know about a recent update which might cause this error?\nI like to tell the administrator of that PC what they should check for. Just telling them that my VBA does not work anymore won't help much.</p>\n\n<p>Thank for any help</p>\n\n<p>Edit: This question is different from this one\n<a href=\"https://stackoverflow.com/questions/26822004/declare-ptrsafe-compatibility-in-excel\">Declare PtrSafe Compatibility in Excel</a>\nBecause until now the VBA code was running fine on that PC, for years. The user did not change anything.</p>\n\n<p><strong>I like to know why the error shows now and never showed before.</strong></p>\n\n<p>I guess an automatic Windows update caused this but I can't check it myself on that PC because I have no admin rights. And I don't see the error on any other PC which uses the program.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1546430882, "post_id": 54005670, "comment_id": 94848679, "body": "Welcome to SO. Firstly, always use <b>Option Explicit</b>, it is your friend and can help to eliminate issues that are generally relatively minor but hard to investigate. Second, you don&#39;t need to create 2 instances of <code>File System Object</code>. Single instance will suffice. You can use that same instance of <code>FSO</code> to get files in both folders. Now to your issue, so you want to capture the data from one file (A) to second file (B) based on matching the file names that exist in a third file?"}, {"owner": {"reputation": 3, "user_id": 9794373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74aa0c3a2faaa9205bb0a7e3574877eb?s=128&d=identicon&r=PG&f=1", "display_name": "Alex S", "link": "https://stackoverflow.com/users/9794373/alex-s"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1546431496, "post_id": 54005670, "comment_id": 94848924, "body": "Hi! Good to know about the FSO, I&#39;ll see if I can make it work. A and B are already named similarly - For example, Datafile1.xlsx and Datafile1_v2.xlsx."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1546433252, "post_id": 54005670, "comment_id": 94849788, "body": "So you want to bring all data over from <code>Datafile1 over to </code>Datafile2`? can you provide screen prints of the older template and the new template? it will help"}, {"owner": {"reputation": 3, "user_id": 9794373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74aa0c3a2faaa9205bb0a7e3574877eb?s=128&d=identicon&r=PG&f=1", "display_name": "Alex S", "link": "https://stackoverflow.com/users/9794373/alex-s"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1546434597, "post_id": 54005670, "comment_id": 94850440, "body": "I sadly can&#39;t as it&#39;s not public data. I&#39;ve managed to loop the process in a different way:  <code>Set fso1 = CreateObject(&quot;Scripting.FileSystemObject&quot;) Set vfolder1 = fso1.GetFolder(fpath1)  Set fso2 = CreateObject(&quot;scripting.filesystemobject&quot;) Set vfolder2 = fso2.GetFolder(fpath2)  For Each vfile1 In vfolder1.Files     For Each vfile2 In vfolder2.Files                          If Left(vfile1.Name, Len(vfile1.Name) - 5) = Left(vfile2.Name, Len(vfile2.Name) - 8) Then                       DoEvents         Workbooks.Open (vfile1)         Workbooks.Open (vfile2)</code>"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1546436840, "post_id": 54005670, "comment_id": 94851527, "body": "Alex, @Zac is not asking for the data, he is asking for your templates for the old and new format. With out knowing how the data is formatted on your source and destination worksheets your question is to vague to provide a workable solution."}, {"owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "edited": false, "score": 0, "creation_date": 1546441438, "post_id": 54005670, "comment_id": 94853752, "body": "Assuming that Document A and B are not identically named couldn&#39;t you just use: <code>Workbooks.Open Filename:=&quot;D:\\&quot; &amp; FolderAorB &amp; &quot;:&quot; &amp; LoopingExampleName &amp; &quot;.xlsx&quot;</code>."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1546442304, "post_id": 54005670, "comment_id": 94854178, "body": "When you say <i>similarly</i> do you mean they have <code>_v?</code> appended to the end of the filename, or might one say <code>DataFile1.xlsx</code> and one say <code>DataFileOne_xlsx</code>?  Code isn&#39;t that good at figuring out <code>similar</code>.  Also - are all files represented in the new folder?  If that&#39;s the case you only need to look at one folder and know that the other folder contains a file with that name (and _v1 appended to the end)."}, {"owner": {"reputation": 3, "user_id": 9794373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74aa0c3a2faaa9205bb0a7e3574877eb?s=128&d=identicon&r=PG&f=1", "display_name": "Alex S", "link": "https://stackoverflow.com/users/9794373/alex-s"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1546520629, "post_id": 54005670, "comment_id": 94881768, "body": "@GMalc The template itself contains sensitive information. Sorry for not making that clear."}, {"owner": {"reputation": 3, "user_id": 9794373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74aa0c3a2faaa9205bb0a7e3574877eb?s=128&d=identicon&r=PG&f=1", "display_name": "Alex S", "link": "https://stackoverflow.com/users/9794373/alex-s"}, "reply_to_user": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "edited": false, "score": 0, "creation_date": 1546520898, "post_id": 54005670, "comment_id": 94881911, "body": "@EmilyAlden I needed to make sure they opened in their matched pairs, which i did with the &quot;IF left...&quot; statement."}, {"owner": {"reputation": 3, "user_id": 9794373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74aa0c3a2faaa9205bb0a7e3574877eb?s=128&d=identicon&r=PG&f=1", "display_name": "Alex S", "link": "https://stackoverflow.com/users/9794373/alex-s"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1546520901, "post_id": 54005670, "comment_id": 94881912, "body": "@DarrenBartrup-Cook Appended, I created them with the suffix in place. If i opened only one folder, wouldn&#39;t it stop me copying individual cell data into the files in the other folder? Sorry, not seeing the train of thought due to my inexperience."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1546521331, "post_id": 54005670, "comment_id": 94882140, "body": "I was thinking something along the lines of the accepted answer, except that I was assuming the file does exist in the <i>target</i> folder so would open it using the expected file name rather than using a <code>For Each searched in target</code> loop to find it."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9794373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74aa0c3a2faaa9205bb0a7e3574877eb?s=128&d=identicon&r=PG&f=1", "display_name": "Alex S", "link": "https://stackoverflow.com/users/9794373/alex-s"}, "edited": false, "score": 0, "creation_date": 1546521022, "post_id": 54009708, "comment_id": 94881965, "body": "Thanks! This looks a lot cleaner than what I wrote. I&#39;m not super confident in my VBA so I tend to use what I&#39;ve seen before, especially with FSO&#39;s."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 0, "last_activity_date": 1546445997, "creation_date": 1546445997, "answer_id": 54009708, "question_id": 54005670, "link": "https://stackoverflow.com/questions/54005670/i-have-two-folders-filled-with-files-which-have-identical-names-but-different-co/54009708#54009708", "title": "I have two folders filled with files which have identical names but different content. How can I match them to copy data from one file to another?", "body": "<p>Assuming that the file names always <em>start</em> the same (\"the newer templates have a 3 character suffix <strong><em>at the end</em></strong>\"), you can just strip the path and the extension from the file names with <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/getbasename-method\" rel=\"nofollow noreferrer\"><code>GetBaseName</code></a> and compare them to see if the target file name starts with the source file name:</p>\n\n<pre><code>With New Scripting.FileSystemObject\n    Dim source As Folder, target As Folder\n\n    Set source = .GetFolder(fpath1)\n    Set target = .GetFolder(fpath2)\n\n    Dim item As File, fileName As String\n    For Each item In source.Files\n        'Get the filename without path or extension.\n        fileName = .GetBaseName(item)\n        Dim searched As File\n        For Each searched In target\n            'Does the file start with fileName?\n            If InStr(1, .GetBaseName(item), fileName) = 1 Then\n                'Files match, do your thing here.\n            End If\n        Next\n    Next\nEnd With\n</code></pre>\n\n<p>Note that this is early bound.  If you're insistant on not adding a reference to Microsoft Scripting Runtime (there's almost never a reason not to), just change the early bound variables to <code>Object</code> and replace the <code>New Scripting.FileSystemObject</code> with <code>CreateObject</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 9794373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74aa0c3a2faaa9205bb0a7e3574877eb?s=128&d=identicon&r=PG&f=1", "display_name": "Alex S", "link": "https://stackoverflow.com/users/9794373/alex-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 54009708, "answer_count": 1, "score": 0, "last_activity_date": 1566196242, "creation_date": 1546429141, "last_edit_date": 1566196242, "question_id": 54005670, "link": "https://stackoverflow.com/questions/54005670/i-have-two-folders-filled-with-files-which-have-identical-names-but-different-co", "title": "I have two folders filled with files which have identical names but different content. How can I match them to copy data from one file to another?", "body": "<p>I have two folders filled with similarly named excel files but in different templates. One of the templates (Newer) is blank, while the old template contains all the data. </p>\n\n<p>The patterns between template A and template B are consistent - I know which cell in A goes to which cell in B, but I'm not sure how to create the macro in VBA to effectively process all of the files in one go.</p>\n\n<p>I've so far created two File system objects, one per folder - but I'm not sure how to get it to pull up the identical file from the other folder to start the cloning process.</p>\n\n<p>To avoid excel having issues opening files of the same name, the newer templates have a 3 character suffix at the end.</p>\n\n<p>Any advice would be greatly appreciated!</p>\n\n<pre><code>    Set picker = Application.FileDialog(msoFileDialogFolderPicker)\n    picker.Show\n    Set fldrs = picker.SelectedItems\n    fpath1 = fldrs(1)\n\nSet picker = Application.FileDialog(msoFileDialogFolderPicker)\n    picker.Show\n    Set fldrs = picker.SelectedItems\n    fpath2 = fldrs(1)\n\nDim fso1 As Object\nDim vfolder1 As Object\nDim fso2 As Object\nDim vfolder2 As Object\n\nSet fso1 = CreateObject(\"Scripting.FileSystemObject\")\nSet vfolder1 = fso1.GetFolder(fpath1)\n\nSet fso2 = CreateObject(\"scripting.filesystemobject\")\nSet vfolder2 = fso2.GetFolder(fpath2)\n\nFor Each vfile In vfolder1.Files\n</code></pre>\n"}, {"tags": ["database", "vba", "ms-access"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1546429095, "post_id": 54005618, "comment_id": 94847967, "body": "I think you forgot to add the script?  There&#39;s only a single line of code showing."}, {"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1546430164, "post_id": 54005618, "comment_id": 94848378, "body": "In <code>tbl_CFDetail</code> do you have a text field which you have used to join other table, while creating update query?"}, {"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 1, "creation_date": 1546433787, "post_id": 54005618, "comment_id": 94850065, "body": "This error shows, that currently edited table is locked by another process. Sometimes it&#39;s really hard to find the root cause of this locking, it depends on the number of conditions"}, {"owner": {"reputation": 13, "user_id": 10857551, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3zMg9hTmsL0/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcadKzDqu6mGQ_KXvoTHq0F2-HL7QA/mo/photo.jpg?sz=128", "display_name": "Choi Wilson", "link": "https://stackoverflow.com/users/10857551/choi-wilson"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1546442316, "post_id": 54005618, "comment_id": 94854187, "body": "@DarrenBartrup-Cook. Yes I wish to post the whole script here. However, it is just too long as the tool is used to calculate the risk exposure of a large bank. Just want to see if anyone has any previous experience on this error with the above background first."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1546442743, "post_id": 54005618, "comment_id": 94854401, "body": "I&#39;ve used <code>AddNew</code> before if that counts as previous experience.  I think it depends on the table as well - is it local or linked, does it have an index, is the recordset from a query - is it an updatable query, do you have write permission for the database back-end &amp; probably 101 other things I haven&#39;t thought of/come across before."}, {"owner": {"reputation": 13, "user_id": 10857551, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3zMg9hTmsL0/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcadKzDqu6mGQ_KXvoTHq0F2-HL7QA/mo/photo.jpg?sz=128", "display_name": "Choi Wilson", "link": "https://stackoverflow.com/users/10857551/choi-wilson"}, "reply_to_user": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 1, "creation_date": 1546442845, "post_id": 54005618, "comment_id": 94854454, "body": "@Santosh No, &quot;tbl_CFDetail&quot; does not have a text field to join other tables. Below is more background:The deals will be broken down into 10,000 deals per package. After cash flows are generated in this table for each package, the cash flow details will be aggregated and put in another table and the cash flows will be removed after the aggregation. This process will be repeated for each package until the cash flow generation for all packages are completed."}], "owner": {"reputation": 13, "user_id": 10857551, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3zMg9hTmsL0/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcadKzDqu6mGQ_KXvoTHq0F2-HL7QA/mo/photo.jpg?sz=128", "display_name": "Choi Wilson", "link": "https://stackoverflow.com/users/10857551/choi-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 708, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1546433173, "creation_date": 1546428935, "last_edit_date": 1546433173, "question_id": 54005618, "link": "https://stackoverflow.com/questions/54005618/run-time-error-2147217911-80040e09-cannot-update-database-or-object-is-read", "title": "run-time error &#39;2147217911 (80040e09) [Cannot update. Database or object is read-only]", "body": "<p>I am using Microsoft Access VBA to build a cash flow generation tool. Unfortunately, the tool sometimes generate a run-time error </p>\n\n<blockquote>\n  <p>'2147217911 (80040e09) [Cannot update. Database or object is\n  read-only]</p>\n</blockquote>\n\n<p>after a number of deals are processed. This error is quite random and irregular as the tool does not always stop at a specific deal. Moreover, it only happens when multiple tools are working in parallel. </p>\n\n<p>The underlying logic of this calculation is to open a linked cash flow database called <code>\"tbl_CFDetail\"</code> in a temporary <code>recordset</code> and keep adding new entry to the <code>recordset</code> in order to project the cash flows. I found that when this error is generated, the table <code>\"tbl_CFDetail\"</code> was kind of corrupted and was unable to add any new record.</p>\n\n<p>Does anyone have any idea about this issue? What is the possible cause and the possible solution to it? Appreciate if anyone could help. Thank you!</p>\n\n<p>Below is the script in error:</p>\n\n<pre><code>rst_CFDetail.AddNew\n</code></pre>\n"}, {"tags": ["excel", "vba", "filtering"], "answers": [{"tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": false, "score": 1, "last_activity_date": 1546716741, "creation_date": 1546716741, "answer_id": 54055507, "question_id": 54005579, "link": "https://stackoverflow.com/questions/54005579/filter-between-2-date-ranges/54055507#54055507", "title": "Filter between 2 date ranges", "body": "<p>In order to work with dates in autofilter, you need to know one thing - autofilter recognizes <em>only</em> U.S. date format: <strong>month/day/year</strong>.</p>\n\n<pre><code>Sub FFF()\n\n    Dim dt1 As Date, dt2 As Date\n    Dim sDate1$, sDate2\n\n    '// Get dates\n    dt1 = Now - 29: dt2 = Now - 1\n\n    '// Format dates\n    sDate1 = Format(dt1, \"MM\\/yy\\/yyyy\")\n    sDate2 = Format(dt2, \"MM\\/yy\\/yyyy\")\n\n    With Sheets(\"Main\").Range(\"A1\").CurrentRegion\n        .AutoFilter\n        .AutoFilter Field:=2, Criteria1:=\"&gt;=\" &amp; sDate1, Operator:=xlAnd, Criteria2:=\"&lt;=\" &amp; sDate2\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6893569, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WLnlRL_aeS0/AAAAAAAAAAI/AAAAAAAAAYE/U1TFDGMblHk/photo.jpg?sz=128", "display_name": "Andrew Whitty", "link": "https://stackoverflow.com/users/6893569/andrew-whitty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 467, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1546802825, "creation_date": 1546428751, "last_edit_date": 1546713802, "question_id": 54005579, "link": "https://stackoverflow.com/questions/54005579/filter-between-2-date-ranges", "title": "Filter between 2 date ranges", "body": "<p>I would like to filter 1 lot of data between 2 date ranges.</p>\n\n<p>Date range 1: Going back from yesterday's date to 28 days previous.<br>\nDate range 2: Going back one year from yesterday's date to 28 days previous.</p>\n\n<p>To filter to one date range I have this code working:</p>\n\n<pre><code>Sub DateFilter()\n\nDim StartDateTY As Date\nDim EndDateTY As Date\nStartDateTY = Date - 29\nEndDateTY = Date - 1\n\nSheets(\"Main\").Range(\"$A$4:$O$5000\").AutoFilter Field:=2, _\n Criteria1:=\"&gt;=\" &amp; CDbl(StartDateTY), Operator:=xlAnd, _\n Criteria2:=\"&lt;=\" &amp; CDbl(EndDateTY)\n\nEnd Sub\n</code></pre>\n\n<p>I was thinking I could use arrays to use 2 different date ranges but can't get it working.</p>\n\n<pre><code>Sub DateFilter2Ranges()\n\nDim StartDateTY As Date\nDim EndDateTY As Date\nStartDateTY = Date - 29\nEndDateTY = Date - 1\n\nDim StartDateLY As Date\nDim EndDateLY As Date\nStartDateLY = Date - 29 - 365\nEndDateLY = Date - 1 - 365\n\nSheets(\"Main\").Range(\"$A$4:$O$5000\").AutoFilter Field:=2, _\n  Criteria1:=Array(0, \"&gt;=\" &amp; CDbl(StartDateTY), 0, \"&gt;=\" &amp; CDbl(StartDateLY)), Operator:=xlAnd, _\n  Criteria2:=Array(1, \"&lt;=\" &amp; CDbl(EndDateTY), 1, \"&lt;=\" &amp; CDbl(EndDateLY))\n\nEnd Sub\n</code></pre>\n\n<p>I also thought I could mix 'And' &amp; 'Or' operators if this is possible.</p>\n"}, {"tags": ["excel", "vba", "format"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1546430033, "post_id": 54005265, "comment_id": 94848326, "body": "Is it possible that the column width is too small?"}, {"owner": {"reputation": 355, "user_id": 10374467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ovjw3.png?s=128&g=1", "display_name": "Thryn", "link": "https://stackoverflow.com/users/10374467/thryn"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1546430123, "post_id": 54005265, "comment_id": 94848357, "body": "Nope, it can show up to 4 numbers after the coma while I never use more than 2"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1546430309, "post_id": 54005265, "comment_id": 94848437, "body": "How do you know? I can decrease the column width that it only shows two numbers and the remaining digits are just cut off."}, {"owner": {"reputation": 355, "user_id": 10374467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ovjw3.png?s=128&g=1", "display_name": "Thryn", "link": "https://stackoverflow.com/users/10374467/thryn"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1546430451, "post_id": 54005265, "comment_id": 94848499, "body": "I simply tried it, and I know every entry so i&#39;m certain about what&#39;s inside"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1546430660, "post_id": 54005265, "comment_id": 94848580, "body": "I also tried it and I was able to display it with no values after the coma although the value itself was still 85,72. I think the OP has to clarify unless you are the OP"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1546433531, "post_id": 54005265, "comment_id": 94849941, "body": "Just another remark: What do you see in the immediate window when you add the line <code>debug.print ListBox.List(lngIndex, 3)</code> just after the line you posted."}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1546435359, "post_id": 54005265, "comment_id": 94850785, "body": "Is your data 85,72 or 85.72?"}, {"owner": {"reputation": 355, "user_id": 10374467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ovjw3.png?s=128&g=1", "display_name": "Thryn", "link": "https://stackoverflow.com/users/10374467/thryn"}, "edited": false, "score": 0, "creation_date": 1546436622, "post_id": 54005265, "comment_id": 94851417, "body": "My data is 85,72"}, {"owner": {"reputation": 355, "user_id": 10374467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ovjw3.png?s=128&g=1", "display_name": "Thryn", "link": "https://stackoverflow.com/users/10374467/thryn"}, "edited": false, "score": 0, "creation_date": 1546436764, "post_id": 54005265, "comment_id": 94851483, "body": "The debug.print give me 85,00"}], "answers": [{"comments": [{"owner": {"reputation": 355, "user_id": 10374467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ovjw3.png?s=128&g=1", "display_name": "Thryn", "link": "https://stackoverflow.com/users/10374467/thryn"}, "edited": false, "score": 0, "creation_date": 1546429105, "post_id": 54005405, "comment_id": 94847970, "body": "If I enter Format(&quot;85,72&quot;, &quot;0.00\u20ac;0.00\u20ac&quot;) in the debug window it also works quite well even if it&#39;s entered as a string"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "reply_to_user": {"reputation": 355, "user_id": 10374467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ovjw3.png?s=128&g=1", "display_name": "Thryn", "link": "https://stackoverflow.com/users/10374467/thryn"}, "edited": false, "score": 0, "creation_date": 1546437279, "post_id": 54005405, "comment_id": 94851749, "body": "on my pc, <code>print Format(&quot;85,72&quot;, &quot;0.00\u20ac;0.00\u20ac&quot;)</code> returns 8572.00\u20ac, which is <i>not</i> what is expected. <code>&quot;85.72&quot;</code> (with a decimal dot) is working."}, {"owner": {"reputation": 355, "user_id": 10374467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ovjw3.png?s=128&g=1", "display_name": "Thryn", "link": "https://stackoverflow.com/users/10374467/thryn"}, "edited": false, "score": 0, "creation_date": 1546437374, "post_id": 54005405, "comment_id": 94851789, "body": "It may have something to do with my localization, cause I use Excel in French."}], "tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 0, "last_activity_date": 1546428086, "creation_date": 1546428086, "answer_id": 54005405, "question_id": 54005265, "link": "https://stackoverflow.com/questions/54005265/avoid-numbers-being-always-rounded-while-using-format/54005405#54005405", "title": "Avoid numbers being always rounded while using format", "body": "<p>I think the problem is that the source of your <code>Format()</code> function is a <strong>string</strong>: <code>ListBox.List(lngIndex, 3)</code>, while <code>Format</code> expects a Number or Date. There must be some implicit conversion that loses the decimals.<br>\nIf you type <code>print Format(0.856, \"0.00\u20ac;0.00\u20ac\")</code> in the debug window it works fine.</p>\n"}, {"tags": [], "owner": {"reputation": 355, "user_id": 10374467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ovjw3.png?s=128&g=1", "display_name": "Thryn", "link": "https://stackoverflow.com/users/10374467/thryn"}, "is_accepted": true, "score": 0, "last_activity_date": 1546437587, "creation_date": 1546437587, "answer_id": 54007664, "question_id": 54005265, "link": "https://stackoverflow.com/questions/54005265/avoid-numbers-being-always-rounded-while-using-format/54007664#54007664", "title": "Avoid numbers being always rounded while using format", "body": "<p>It was a miss configuration of an SQL database where the list took her source. A column wasn't configured as Decimal. Quite embarassing</p>\n"}], "owner": {"reputation": 355, "user_id": 10374467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ovjw3.png?s=128&g=1", "display_name": "Thryn", "link": "https://stackoverflow.com/users/10374467/thryn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 54007664, "answer_count": 2, "score": 0, "last_activity_date": 1566196250, "creation_date": 1546427475, "last_edit_date": 1566196250, "question_id": 54005265, "link": "https://stackoverflow.com/questions/54005265/avoid-numbers-being-always-rounded-while-using-format", "title": "Avoid numbers being always rounded while using format", "body": "<p>It's quite a basic problem but I can't seems to use the right format so that the numbers in my listbox aren't automatically rounded</p>\n\n<p>I wanted to have a column showing prices but it's always rounded to the unit before the coma. I'm currently using this code</p>\n\n<pre><code>ListBox.List(lngIndex, 3) = (Format(ListBox.List(lngIndex, 3), \"0.00\u20ac;0.00\u20ac\"))\n</code></pre>\n\n<p>And instead of 85,72 I get 85.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1546429493, "post_id": 54005072, "comment_id": 94848128, "body": "Can you share what you have tried in VBA so far? My initial thought would be to generate an XML file with VBA"}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1546435750, "post_id": 54005072, "comment_id": 94850985, "body": "@Zac Updated, thanks. I&#39;m modifying the main Excel.officeUI file as I can&#39;t find a way to embed XML in an Add-In so that it affects the host instance of Excel while the Add-In is enabled."}, {"owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1546441773, "post_id": 54005072, "comment_id": 94853937, "body": "Have you taken a look at &quot;Custom UI Editor for Microsoft Office&quot;?  It&#39;s pretty solid tool for creating custom ribbons and allows the use of custom icons."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "reply_to_user": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1546450624, "post_id": 54005072, "comment_id": 94858196, "body": "@FrankBall Yes, it says so in my post :) Thanks anyway."}], "owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 696, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566196258, "creation_date": 1546426547, "last_edit_date": 1566196258, "question_id": 54005072, "link": "https://stackoverflow.com/questions/54005072/programatically-set-custom-icon-to-added-ribbon-button", "title": "Programatically set custom icon to added ribbon button", "body": "<p>I'm trying to add two icons programmatically to a new ribbon group with VBA. I can add built in icons fine but can't figure out how to use my own files.</p>\n\n<p>TLDR: The code below works if using built in icons with the <code>imageMso</code> attribute but not with custom icons using the <code>image</code> attribute or the <code>getImage</code> callback.</p>\n\n<p>Here is the XML I'm using</p>\n\n<pre><code>&lt;customUI xmlns='http://schemas.microsoft.com/office/2006/01/customui'&gt;\n    &lt;ribbon&gt;\n        &lt;tabs&gt;\n            &lt;tab id='customTab' label='CP Analyzer' insertAfterMso='TabData'&gt;\n                &lt;group id='idCPA' label='CP Analyzer'&gt;\n                    &lt;button id='customButton1' label='Select Column' size='large' onAction='SelectColumn' image='imgLabel' /&gt;\n                    &lt;button id='customButton2' label='Run Change Point Analyzer' size='large' onAction='RunCP' image='imgFast' /&gt;\n                &lt;/group&gt;\n            &lt;/tab&gt;\n        &lt;/tabs&gt;\n    &lt;/ribbon&gt;\n&lt;/customUI&gt;\n</code></pre>\n\n<p>I have two .png files (called imgLabel.png and imgFast.png) in the same folder  as the add-in containing the above code. From using Microsofts <a href=\"https://www.rondebruin.nl/win/s2/win001.htm\" rel=\"nofollow noreferrer\">Custom UI Editor</a> to verify the syntax it appears <code>image='myImageName'</code> is correct and works when using the UI Editor, but not when used programmatically in VBA.</p>\n\n<p>How can I reference these images?</p>\n\n<p>Here's the full code, it works by modifying the main Excel.officeUI file:</p>\n\n<pre><code>Sub AddR\n\nDim hFile As Long\nDim path As String, filename As String, ribbonXML As String, user As String\n\nhFile = FreeFile\nuser = Environ(\"Username\")\npath = \"C:\\Users\\\" &amp; user &amp; \"\\AppData\\Local\\Microsoft\\Office\\\"\nfilename = \"Excel.officeUI\"\n\nribbonXML = ' the XML above\n\nOpen path &amp; filename For Output Access Write As hFile\nPrint #hFile, ribbonXML\nClose hFile\n\nEnd Sub\n</code></pre>\n\n<p>I've tried using the getImage callback described <a href=\"https://www.rondebruin.nl/win/s2/win009.htm\" rel=\"nofollow noreferrer\">here</a> which works fine for a stand-alone file but not as an Add-In which is the important bit for me here. </p>\n\n<p>Specifically, using the Custom UI editor you can set the call back request in a custom UI XML file that gets embedded into the Excel file. Because I need this as an Add-In though I can't do that, since it's only the code that gets included (at least I can't find a way after searching on this all day). Hence my programatic attempt above to change the main Excel.officeUI file (and change it back to its default when the user disables the Add-In).</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 2, "creation_date": 1546425319, "post_id": 54004659, "comment_id": 94846230, "body": "This <code>quality = &quot;Sheets(2).Cells(i, 41).Value&quot;</code> assignment does not mean that quality contains the value of the cell <code>Sheets(2).Cells(i, 41).Value</code>. It will just contain the string <i>Sheets(2).Cells(i, 41).Value</i>.  And I assume with <i>here it doesn&#39;t work</i> you mean the line <code>prcdTariff_calc 1, quality</code> throws an error, right. Please understand that &quot;<i>does not work</i>&quot; is not really helpful. Also have a look at the basics of using <a href=\"https://excelmacromastery.com/excel-vba-sub/\" rel=\"nofollow noreferrer\">subs and func</a> You also might have other issues in your code as you do not use <code>Option Explicit</code> and global variables."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1546425586, "post_id": 54004659, "comment_id": 94846335, "body": "If you don&#39;t know the data type you can usually declare it as Variant and let Excel sort the problem. However, your calculation needs a numeric value. You can convert the cell value to a number with Val(Sheets(2).Cells(i, 41).Value). Of course, if the cell contains a string the numeric value will be zero which doesn&#39;t sit well with your multiplication. So, something like Iif(Val(Sheets(2).Cells(i, 41).Value),Val(Sheets(2).Cells(i, 41).Value),1) should do the job. If passed directly to the function make sure it is passed ByVal."}, {"owner": {"reputation": 1, "user_id": 10820879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d59ad2218407999431aca337a500943?s=128&d=identicon&r=PG&f=1", "display_name": "tom", "link": "https://stackoverflow.com/users/10820879/tom"}, "edited": false, "score": 0, "creation_date": 1546431087, "post_id": 54004659, "comment_id": 94848760, "body": "Thank you. Actually I use <code>Option Explicit</code>. The error message that occurs is <code>Type mismatch</code> with reference to <code>b</code> in the part <code>Tariff_calc(a, b, c)</code> of the procedure <code>Sub prcdTariff_calc</code>. Moreover, the variable  <code>quality = &quot;Sheets(2).Cells(i, 41).Value&quot;</code> should always be numeric as the column includes numbers only. I am not sure if the <code>IIF</code> function is of any use in this case. I need to find a way that the procedure <code>Sub prcdTariff_calc</code> is extracting the number of the given Cell(i,41). Apologies if I missunderstood anything."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1546432828, "post_id": 54004659, "comment_id": 94849581, "body": "Sorry but you seem not to understand. Your variable <code>quality</code> will contain the string <code>Sheets(2).Cells(i, 41).Value</code>. It will not contain the value of cell(i,41) of Sheets(2). For that you have to remove the double quotes and write <code>quality = Sheets(2).Cells(i, 41).Value</code>. Do you see the difference? That is a real basic mistake."}, {"owner": {"reputation": 1, "user_id": 10820879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d59ad2218407999431aca337a500943?s=128&d=identicon&r=PG&f=1", "display_name": "tom", "link": "https://stackoverflow.com/users/10820879/tom"}, "edited": false, "score": 0, "creation_date": 1546441925, "post_id": 54004659, "comment_id": 94853990, "body": "Thanks, got it! I&#39;ve tried this already before, but it will only return 0 as value for <code>quality</code>. Though there is something strange: I modified <code>Sub prcdTariff_calc</code> by referring to another newly created procedure which defines <code>quality = Sheets(2).Cells(i, 41).Value</code> (so identitcal to your suggestion) and then back in <code>Sub prcdTariff_calc</code> define <code>b = quality</code>... and then it worked. But this is exactly the same thing as written in <code>Sub prcdSum_year_IR()</code> ?!"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10820879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d59ad2218407999431aca337a500943?s=128&d=identicon&r=PG&f=1", "display_name": "tom", "link": "https://stackoverflow.com/users/10820879/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1546513455, "creation_date": 1546513455, "answer_id": 54021056, "question_id": 54004659, "link": "https://stackoverflow.com/questions/54004659/passing-a-string-variable-to-another-procedure-to-assign-a-value-to-it-in-a-loop/54021056#54021056", "title": "Passing a string variable to another procedure to assign a value to it in a loop", "body": "<p>I resolved my problem by modifying the code by declaring the variables a,b,c inside the loop of procedure. It works fine now. </p>\n\n<pre><code>Function Tariff_calc(a As Double, Optional b As Double = 1, Optional c As Double = 1) As Double\nTariff_calc = a * b * c\nEnd Function\n\nFunction Price_calc(a As Double, Optional b As String = 1, Optional c As Double = 1) As String\nPrice_calc = Format(a * b * c, \"0.00   \u20ac/MWh\")\nEnd Function\n\nSub prcdTariff_calc(Optional a As Double = 1, Optional b As Double = 1, Optional c As Double = 1)\nFor i = 2 To 43\n    If ThisWorkbook.Sheets(2).Cells(i, 1).Value = 1 Then\n        a = Sheets(2).Cells(i, 19).Value 'annual tariff\n        If optIR.Value Then\n           b = Sheets(2).Cells(i, 41) 'quality factor\n        End If\n        If optQuarter.Value Then\n            c = Sheets(2).Cells(i, 21 + q) 'period factor Quarter\n        ElseIf optMonth.Value Then\n            c = Sheets(2).Cells(i, 28 + m) 'period factor Month\n        ElseIf optDay.Value Then\n            c = Sheets(2).Cells(i, 27)\n        End If\n\n        sum_tariff = sum_tariff + Tariff_calc(a, b, c)\n\n        price = Price_calc(a, CStr(b), c)\n        lblPrice.Caption = lblPrice.Caption &amp; price &amp; vbCrLf\n    End If\nNext i\nlblUnitCost.Caption = Format(sum_tariff, \"0.00    \u20ac/MWh\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10820879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d59ad2218407999431aca337a500943?s=128&d=identicon&r=PG&f=1", "display_name": "tom", "link": "https://stackoverflow.com/users/10820879/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 198, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566196269, "creation_date": 1546424774, "last_edit_date": 1566196269, "question_id": 54004659, "link": "https://stackoverflow.com/questions/54004659/passing-a-string-variable-to-another-procedure-to-assign-a-value-to-it-in-a-loop", "title": "Passing a string variable to another procedure to assign a value to it in a loop", "body": "<p>I want to pass a a string variable <code>\"Sheets(2).Cells(i, 41).Value\"</code> to the procedure <code>Sub prcdTariff_calc</code> that will assign in a loop a value to that variable in order to pass it on to another function,<code>Function Tariff_calc</code>.\nThe problem is with <code>Sub prcdSum_year_IR()</code>. I tried already to play around with the datatypes (String / Double) in the procedures and also <code>CDbl(quality)</code> etc... Is there a way to pass on the variable <code>quality</code> into the loop in <code>Sub prcdTariff_calc</code> ? Thanks for advice.</p>\n\n<pre><code>  Option Explicit\n    Dim  price As String\n    Dim i As Byte\n    Public  sum_tariff As Double\n    Dim tariff As Double, period As Double, quality As Double\n\n\n    Function Tariff_calc(a As Double, Optional b As Double = 1, Optional c As Double = 1) As Double\n    Tariff_calc = a * b * c\n    Debug.Print b\n    End Function\n\n    Function Price_calc(a As Double, Optional b As String = 1, Optional c As Double = 1) As String\n    Price_calc = Format(a * b * c, \"0.00   \u20ac/MWh\")\n    End Function\n\n    Sub prcdTariff_calc(Optional a As Double = 1, Optional b As Double = 1, Optional c As Double = 1)\n    For i = 2 To 43\n        If ThisWorkbook.Sheets(2).Cells(i, 1).Value = 1 Then\n            a = Sheets(2).Cells(i, 19).Value\n            'I also tried b = val(quality) here\n'I experimented here by referring to newly created procedure Sub [prcdquality() quality = Sheets(2).Cells(i, 41) End Sub] and back here then b=quality; and it worked         \n            sum_tariff = sum_tariff + Tariff_calc(a, Val(b), c) 'I tried val(b), but it still shows 0 in Debug.Print b above.\n\n            price = Price_calc(a, CStr(b), c)\n            lblPrice.Caption = lblPrice.Caption &amp; price &amp; vbCrLf\n        End If\n    Next i\n    End Sub\n\n    Sub prcdSum_year_Firm()'works fine\n    prcdTariff_calc\n    lblUnitCost.Caption = Format(sum_tariff, \"0.00    \u20ac/MWh\")\n    End Sub\n\n    Sub prcdSum_year_IR()\n    quality = Sheets(2).Cells(i, 41)\n    prcdTariff_calc b:=quality\n    lblUnitCost.Caption = Format(sum_tariff, \"0.00    \u20ac/MWh\")\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 10853415, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fWp7PygvrwQ/AAAAAAAAAAI/AAAAAAAAACA/T9J1ttrSNaM/photo.jpg?sz=128", "display_name": "Bigyan Bhandari", "link": "https://stackoverflow.com/users/10853415/bigyan-bhandari"}, "edited": false, "score": 1, "creation_date": 1546422954, "post_id": 54004111, "comment_id": 94845226, "body": "Thank you so much! The code worked perfectly. I can&#39;t thank you enough for this code. It exactly solved my problem. Thank you once again!"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 45, "user_id": 10853415, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fWp7PygvrwQ/AAAAAAAAAAI/AAAAAAAAACA/T9J1ttrSNaM/photo.jpg?sz=128", "display_name": "Bigyan Bhandari", "link": "https://stackoverflow.com/users/10853415/bigyan-bhandari"}, "edited": false, "score": 0, "creation_date": 1546423165, "post_id": 54004111, "comment_id": 94845317, "body": "My pleasure. Btw I suggest you change the procedure and variable names to more meaningful terms."}, {"owner": {"reputation": 45, "user_id": 10853415, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fWp7PygvrwQ/AAAAAAAAAAI/AAAAAAAAACA/T9J1ttrSNaM/photo.jpg?sz=128", "display_name": "Bigyan Bhandari", "link": "https://stackoverflow.com/users/10853415/bigyan-bhandari"}, "edited": false, "score": 0, "creation_date": 1546424195, "post_id": 54004111, "comment_id": 94845754, "body": "Thanks for your suggestion :)"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 3, "last_activity_date": 1546422252, "creation_date": 1546422252, "answer_id": 54004111, "question_id": 54004025, "link": "https://stackoverflow.com/questions/54004025/how-to-loop-to-copy-data-following-blank-cells-in-a-column-and-paste-it-to-last/54004111#54004111", "title": "How to loop to copy data following blank cells in a column and paste it to last empty column?", "body": "<p>Try this, which uses SpecialCells to extract blocks of cells (or Areas). It assumes the cells do not contain formulae so if this is not the case, will need changing.</p>\n\n<pre><code>Sub x()\n\nDim r As Long\n\nFor r = 2 To Columns(1).SpecialCells(xlCellTypeConstants).Areas.Count\n    Columns(1).SpecialCells(xlCellTypeConstants).Areas(r).Copy\n    Cells(1, Columns.Count).End(xlToLeft).Offset(, 1).PasteSpecial Paste:=xlPasteValuesAndNumberFormats\nNext r\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 10853415, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fWp7PygvrwQ/AAAAAAAAAAI/AAAAAAAAACA/T9J1ttrSNaM/photo.jpg?sz=128", "display_name": "Bigyan Bhandari", "link": "https://stackoverflow.com/users/10853415/bigyan-bhandari"}, "edited": false, "score": 0, "creation_date": 1546424137, "post_id": 54004326, "comment_id": 94845726, "body": "Thank you so much. This worked perfectly too. Thank you Once again!"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 1, "last_activity_date": 1546423251, "creation_date": 1546423251, "answer_id": 54004326, "question_id": 54004025, "link": "https://stackoverflow.com/questions/54004025/how-to-loop-to-copy-data-following-blank-cells-in-a-column-and-paste-it-to-last/54004326#54004326", "title": "How to loop to copy data following blank cells in a column and paste it to last empty column?", "body": "<p>I think you could try:</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n\n    Dim i As Long, LastRow As Long, LastColumn As Long, StartCell As Long, EndCell As Long\n    Dim rng As Range\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n        For i = LastRow To 1 Step -1\n            If IsEmpty(.Range(\"A\" &amp; i).Value) Then\n\n                EndCell = i + 1\n\n                LastColumn = .Cells(1, .Columns.Count).End(xlToLeft).Column\n\n                Set rng = .Range(\"A\" &amp; StartCell &amp; \":A\" &amp; EndCell)\n\n                rng.Cut .Cells(1, LastColumn + 1)\n            Else\n                If i = LastRow Or IsEmpty(.Range(\"A\" &amp; i).Offset(1, 0).Value) Then\n                    StartCell = i\n                End If\n\n            End If\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 10853415, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fWp7PygvrwQ/AAAAAAAAAAI/AAAAAAAAACA/T9J1ttrSNaM/photo.jpg?sz=128", "display_name": "Bigyan Bhandari", "link": "https://stackoverflow.com/users/10853415/bigyan-bhandari"}, "edited": false, "score": 0, "creation_date": 1546448582, "post_id": 54004650, "comment_id": 94857351, "body": "Thank you so much for the code, I really appreciate your help, this code works well and its fast too. But how can I copy Formatting too? I want to copy both Values and number formats. I would be glad if you could help on this matter too. Thanks once again!"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 45, "user_id": 10853415, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fWp7PygvrwQ/AAAAAAAAAAI/AAAAAAAAACA/T9J1ttrSNaM/photo.jpg?sz=128", "display_name": "Bigyan Bhandari", "link": "https://stackoverflow.com/users/10853415/bigyan-bhandari"}, "edited": false, "score": 0, "creation_date": 1546479785, "post_id": 54004650, "comment_id": 94867740, "body": "You have selected an answer to which I have personally awarded a bonus point because I think it&#39;s brilliant. Your question regarding my code seems to be in the category of a follow-up re an also-ran. If it&#39;s important to you give it a new question. Note that the speed comes from not copying formats. Depending upon what your exact problem is the code might be extended to apply formats to the new columns after the values have been pasted."}, {"owner": {"reputation": 45, "user_id": 10853415, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fWp7PygvrwQ/AAAAAAAAAAI/AAAAAAAAACA/T9J1ttrSNaM/photo.jpg?sz=128", "display_name": "Bigyan Bhandari", "link": "https://stackoverflow.com/users/10853415/bigyan-bhandari"}, "edited": false, "score": 0, "creation_date": 1546480487, "post_id": 54004650, "comment_id": 94867865, "body": "Thankyou @Variatus once again for the code, I just solved the problem running a new macro to copy formatting after running your code.  It worked Perfectly!"}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 2, "last_activity_date": 1546424732, "creation_date": 1546424732, "answer_id": 54004650, "question_id": 54004025, "link": "https://stackoverflow.com/questions/54004025/how-to-loop-to-copy-data-following-blank-cells-in-a-column-and-paste-it-to-last/54004650#54004650", "title": "How to loop to copy data following blank cells in a column and paste it to last empty column?", "body": "<p>Please try this code. It is very flexible. You can adjust the four parameters at its top to the requirements of your environment.</p>\n\n<pre><code>Sub CopyToColumns()\n    ' 02 Jan 2019\n\n    ' Change these parameters to fit your requirements:-\n    Const WsName As String = \"TestSheet\"\n    Const SourceClm As String = \"A\"\n    Const FirstRow As Long = 2                      ' applicable to all columns\n    Const FirstTargetClm As String = \"D\"\n\n    Dim Ws As Worksheet\n    Dim InArr As Variant\n    Dim OutArr As Variant, i As Long\n    Dim Rng As Range\n    Dim C As Long\n    Dim R As Long\n\n    On Error Resume Next\n    Set Ws = ActiveWorkbook.Worksheets(WsName)\n    If Err Then Exit Sub                            ' exit if the sheet doesn't exist\n    On Error GoTo 0\n\n    With Ws\n        InArr = Range(.Cells(FirstRow, SourceClm), .Cells(.Rows.Count, SourceClm).End(xlUp)).Value\n    End With\n    C = Columns(FirstTargetClm).Column\n\n    For R = 1 To UBound(InArr)\n        If InArr(R, 1) &lt;&gt; \"\" Then\n            i = 0\n            ReDim OutArr(1 To UBound(InArr))\n            Do\n                i = i + 1\n                OutArr(i) = InArr(R, 1)\n                R = R + 1\n                If R &gt; UBound(InArr) Then Exit Do\n            Loop While InArr(R, 1) &lt;&gt; \"\"\n            If i Then\n                ReDim Preserve OutArr(i)\n                Set Rng = Cells(FirstRow, C).Resize(i)\n                Rng.Value = Application.Transpose(OutArr)\n                C = C + 1\n            End If\n        End If\n    Next R\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 10853415, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fWp7PygvrwQ/AAAAAAAAAAI/AAAAAAAAACA/T9J1ttrSNaM/photo.jpg?sz=128", "display_name": "Bigyan Bhandari", "link": "https://stackoverflow.com/users/10853415/bigyan-bhandari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 54004111, "answer_count": 3, "score": 2, "last_activity_date": 1556313432, "creation_date": 1546421830, "last_edit_date": 1556313432, "question_id": 54004025, "link": "https://stackoverflow.com/questions/54004025/how-to-loop-to-copy-data-following-blank-cells-in-a-column-and-paste-it-to-last", "title": "How to loop to copy data following blank cells in a column and paste it to last empty column?", "body": "<p>I need to copy a block of data in column A (which are in between blank spaces) and paste it to last empty column.\nExample: I have data in range A1:A18 and a blank cell, and again data in A20:A37 and 2 blank cells &amp; and again data in A40:A57 &amp; so on. I need to copy those data and paste in Column B, C, D....</p>\n\n<p>The pattern of blank spaces is not uniform.</p>\n\n<p>Screenshot of Excel File<br>\n<a href=\"https://i.stack.imgur.com/Zb57X.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Zb57X.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I did some research on the internet and created a code to paste manually selected data in column A to the last empty column. But the list is too long and I want to automate the process. </p>\n\n<p>I tried this code to find blank spaces and copy data. It finds the last blank row and copies all data, popping up an error.</p>\n\n<pre><code>Sub Pasting_Data_to_last_column()\nDim xWs As Worksheet\nDim rng As Range\nDim lastCol As Long\n\nSheets(\"Input\").Activate\nApplication.ScreenUpdating = False\n\n'finds the number of the last column\nlastCol = Cells(1, Columns.Count).End(xlToLeft).Column\n\nRange(\"A1\", Cells(Rows.Count, 1).End(xlUp)).Copy\n\n'paste the copied value to last empty column\nCells(1, lastCol + 1).PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:=xlNone, SkipBlanks _\n:=False, Transpose:=False\n\nEnd Sub\n</code></pre>\n\n<p>I believe this problem can be solved with a loop but I don't have any idea about that as I am new to VBA.</p>\n"}, {"tags": ["excel", "vba", "checkbox"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 2, "creation_date": 1546421449, "post_id": 54003873, "comment_id": 94844574, "body": "An <code>If</code> is not a loop - It is a statement. A <code>For</code> or <code>Do</code> is used for a loop"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1546421658, "post_id": 54003873, "comment_id": 94844670, "body": "Are these on a user form?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1546421910, "post_id": 54003873, "comment_id": 94844785, "body": "Could you add an event on the form so that if another is selected the previous one is auto unselected?"}, {"owner": {"reputation": 179, "user_id": 4299166, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/CpJeS.png?s=128&g=1", "display_name": "laureapresa", "link": "https://stackoverflow.com/users/4299166/laureapresa"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1546422355, "post_id": 54003873, "comment_id": 94844979, "body": "@Tom No. But I could check during the extraction if there are two or more variables selected and issue a warning."}, {"owner": {"reputation": 179, "user_id": 4299166, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/CpJeS.png?s=128&g=1", "display_name": "laureapresa", "link": "https://stackoverflow.com/users/4299166/laureapresa"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1546422424, "post_id": 54003873, "comment_id": 94845014, "body": "@SJR Yes, they are on an Excel user form that my client provided and that will fill out with me. I will actually do the filling (box clicking etc.)"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1546422520, "post_id": 54003873, "comment_id": 94845058, "body": "@laureapresa If they are on a userform where is the initial information coming from?"}, {"owner": {"reputation": 179, "user_id": 4299166, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/CpJeS.png?s=128&g=1", "display_name": "laureapresa", "link": "https://stackoverflow.com/users/4299166/laureapresa"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1546423376, "post_id": 54003873, "comment_id": 94845404, "body": "@Tom I edited the question to include a better explanation of the form structure"}], "answers": [{"comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 179, "user_id": 4299166, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/CpJeS.png?s=128&g=1", "display_name": "laureapresa", "link": "https://stackoverflow.com/users/4299166/laureapresa"}, "edited": false, "score": 0, "creation_date": 1546422476, "post_id": 54004089, "comment_id": 94845038, "body": "Is there any logic between the two then?"}, {"owner": {"reputation": 179, "user_id": 4299166, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/CpJeS.png?s=128&g=1", "display_name": "laureapresa", "link": "https://stackoverflow.com/users/4299166/laureapresa"}, "edited": false, "score": 0, "creation_date": 1546422699, "post_id": 54004089, "comment_id": 94845123, "body": "Not at all. I could rename them to a progressive number and then apply your solution.  How would I approach the fact that I have 3 groups of 10 check boxes per form?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 179, "user_id": 4299166, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/CpJeS.png?s=128&g=1", "display_name": "laureapresa", "link": "https://stackoverflow.com/users/4299166/laureapresa"}, "edited": false, "score": 1, "creation_date": 1546423117, "post_id": 54004089, "comment_id": 94845294, "body": "How do you group them together? I&#39;d recommend naming them with some sort of logic. If there is nothing grouping them, you could also apply a naming convention to depict which group the checkbox is related to. e.g. &quot;Group A Checkbox 1&quot; etc."}, {"owner": {"reputation": 179, "user_id": 4299166, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/CpJeS.png?s=128&g=1", "display_name": "laureapresa", "link": "https://stackoverflow.com/users/4299166/laureapresa"}, "edited": false, "score": 0, "creation_date": 1546424273, "post_id": 54004089, "comment_id": 94845784, "body": "I can rename my check boxes as A1, A2... A10, B1, B2...B10 and so on.How would I edit your code to run only for one group?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 179, "user_id": 4299166, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/CpJeS.png?s=128&g=1", "display_name": "laureapresa", "link": "https://stackoverflow.com/users/4299166/laureapresa"}, "edited": false, "score": 0, "creation_date": 1546430671, "post_id": 54004089, "comment_id": 94848583, "body": "@laureapresa Please have a look at my update. I&#39;ve produced a more complex answer which will handle single select per group and account for all groups in both a <code>WorkSheet</code> method or a <code>UserForm</code>. If you have any questions feel free to ask. Please pay attention to the <code>GenerateChkBoxClickStmt</code> as these subs will generate all of the <code>Click</code> statements for you instead of having to write them (they are based off of the <code>CheckBox</code> Names so will need to be structured correctly to work. I&#39;ve suggested a naming pattern for you as well"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 2, "last_activity_date": 1546430955, "last_edit_date": 1546430955, "creation_date": 1546422142, "answer_id": 54004089, "question_id": 54003873, "link": "https://stackoverflow.com/questions/54003873/loop-to-extract-value-from-checkbox/54004089#54004089", "title": "Loop to extract value from checkbox", "body": "<p>Updated after comments:</p>\n\n<p>I have used the following naming convention for the <code>checkboxes</code> (Using just e.g. A1 is a cell reference and could cause problems)</p>\n\n<pre><code>ChkBox_A1\n</code></pre>\n\n<p>Where the first part denotes that it is a <code>checkbox</code> (<code>ChkBox</code>), second the group <code>A</code> and third the position <code>1</code>. With this naming convention and how the code is currently written you will be able to have a maximum of 26 groups (i.e. one for every letter of the alphabet)</p>\n\n<p>I use the immediate window for the results which can be accessed in the VBA editor by going to <code>View</code>-><code>Immediate Window</code> or <kbd>Ctrl</kbd>+<kbd>G</kbd></p>\n\n<p>This code will handle single select per group. i.e. If a checkbox is selected in the group it will un-select all other ones</p>\n\n<p><strong><em>For a worksheet</em></strong></p>\n\n<p><em>This code goes in the worksheet object</em></p>\n\n<p>Replace all of the click statements (e.g. <code>ChkBox_A1_Click()</code> with reference to your own. This can be easily done by calling the <code>GenerateChkBoxClickStmt</code> sub and copying and pasting the output in the immediate window into your code (replacing my ones)</p>\n\n<pre><code>Option Explicit\nDim ChkBoxChange As Boolean\nPrivate Sub ChkBox_A1_Click()\n    If ChkBoxChange = False Then UnselectPreviousChkBox Me.ChkBox_A1\nEnd Sub\nPrivate Sub ChkBox_A2_Click()\n    If ChkBoxChange = False Then UnselectPreviousChkBox Me.ChkBox_A2\nEnd Sub\nPrivate Sub ChkBox_B1_Click()\n    If ChkBoxChange = False Then UnselectPreviousChkBox Me.ChkBox_B1\nEnd Sub\nPrivate Sub UnselectPreviousChkBox(selected As Object)\n    Dim ChkBox As OLEObject\n\n    ChkBoxChange = True\n\n    For Each ChkBox In Me.OLEObjects\n        If ChkBox.progID = \"Forms.CheckBox.1\" Then\n            If ChkBox.Name &lt;&gt; selected.Name And Mid(ChkBox.Name, 8, 1) = Mid(selected.Name, 8, 1) Then\n                ChkBox.Object.Value = False\n            End If\n        End If\n    Next ChkBox\n\n    ChkBoxChange = False\nEnd Sub\nPrivate Sub GenerateChkBoxClickStmt()\n    Dim ChkBox As OLEObject\n    ' Copy and paste output to immediate window into here\n\n    For Each ChkBox In Me.OLEObjects\n        If ChkBox.progID = \"Forms.CheckBox.1\" Then\n            Debug.Print \"Private Sub \" &amp; ChkBox.Name &amp; \"_Click()\"\n            Debug.Print vbTab &amp; \"If ChkBoxChange = False Then UnselectPreviousChkBox Me.\" &amp; ChkBox.Name\n            Debug.Print \"End Sub\"\n        End If\n    Next ChkBox\nEnd Sub\n</code></pre>\n\n<p>Producing the following:</p>\n\n<p><a href=\"https://i.stack.imgur.com/8mjgm.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8mjgm.gif\" alt=\"enter image description here\"></a></p>\n\n<p><em>This code goes into a Module</em></p>\n\n<pre><code>Option Explicit\nPrivate Function GetChkBoxValues(ChkBoxGroup As Variant) As Long\n    Dim ChkBox As OLEObject\n\n    ' Update with your sheet reference\n    For Each ChkBox In ActiveSheet.OLEObjects\n        If ChkBox.progID = \"Forms.CheckBox.1\" Then\n            If ChkBox.Object.Value = True And Mid(ChkBox.Name, 8, 1) = ChkBoxGroup Then\n                GetChkBoxValues = Right(ChkBox.Name, Len(ChkBox.Name) - (Len(\"ChkBox_\") + 1))\n                Exit For\n            End If\n        End If\n    Next ChkBox\nEnd Function\nPublic Sub GetSelectedChkBoxes()\n    Dim ChkBoxGroups() As Variant\n    Dim Grp As Variant\n\n    ChkBoxGroups = Array(\"A\", \"B\", \"C\")\n\n    For Each Grp In ChkBoxGroups\n        Debug.Print \"Group \" &amp; Grp, GetChkBoxValues(Grp)\n    Next Grp\nEnd Sub\n</code></pre>\n\n<p>By running the <code>GetSelectedChkBoxes</code> the code will output to the immediate window:</p>\n\n<p><a href=\"https://i.stack.imgur.com/7W10Y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7W10Y.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong><em>For a UserForm</em></strong></p>\n\n<p>Similarly the statements for the click events can be generated by uncommenting the line in the <code>Userform_Initalize</code> sub</p>\n\n<pre><code>Option Explicit\nDim ChkBoxChange As Boolean\nPrivate Function GetChkBoxValues(Group As Variant) As Long\n    Dim ChkBox As Control\n\n    For Each ChkBox In Me.Controls\n        If TypeName(ChkBox) = \"CheckBox\" Then\n            If ChkBox.Object.Value = True And Mid(ChkBox.Name, 8, 1) = Group Then\n                GetChkBoxValues = Right(ChkBox.Name, Len(ChkBox.Name) - (Len(\"ChkBox_\") + 1))\n                Exit For\n            End If\n        End If\n    Next ChkBox\nEnd Function\nPrivate Sub UnselectPreviousChkBox(selected As Control)\n    Dim ChkBox As Control\n    ChkBoxChange = True\n    For Each ChkBox In Me.Controls\n        If TypeName(ChkBox) = \"CheckBox\" Then\n            If ChkBox.Name &lt;&gt; selected.Name And Mid(ChkBox.Name, 8, 1) = Mid(selected.Name, 8, 1) Then\n                ChkBox.Value = False\n            End If\n        End If\n    Next ChkBox\n    ChkBoxChange = False\nEnd Sub\nPrivate Sub ChkBox_A1_Click()\n    If ChkBoxChange = False Then UnselectPreviousChkBox Me.ChkBox_A1\nEnd Sub\nPrivate Sub ChkBox_A2_Click()\n    If ChkBoxChange = False Then UnselectPreviousChkBox Me.ChkBox_A2\nEnd Sub\nPrivate Sub ChkBox_B1_Click()\n    If ChkBoxChange = False Then UnselectPreviousChkBox Me.ChkBox_B1\nEnd Sub\nPrivate Sub userform_initialize()\n    ' Comment out once written\n    ' GenerateChkBoxClickStmt\nEnd Sub\nPrivate Sub UserForm_Terminate()\n    Dim ChkBoxGroups() As Variant\n    Dim Grp As Variant\n\n    ChkBoxGroups = Array(\"A\", \"B\", \"C\")\n\n    For Each Grp In ChkBoxGroups\n        Debug.Print \"Group \" &amp; Grp, GetChkBoxValues(Grp)\n    Next Grp\nEnd Sub\nPrivate Sub GenerateChkBoxClickStmt()\n    Dim ChkBox As Control\n    ' Copy and paste output to immediate window into here\n    For Each ChkBox In Me.Controls\n        If TypeName(ChkBox) = \"CheckBox\" Then\n            Debug.Print \"Private Sub \" &amp; ChkBox.Name &amp; \"_Click()\"\n            Debug.Print vbTab &amp; \"If ChkBoxChange = False Then UnselectPreviousChkBox Me.\" &amp; ChkBox.Name\n            Debug.Print \"End Sub\"\n        End If\n    Next ChkBox\nEnd Sub\n</code></pre>\n\n<p>Producing:</p>\n\n<p><a href=\"https://i.stack.imgur.com/qTEum.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qTEum.gif\" alt=\"enter image description here\"></a></p>\n\n<p>and outputting the following on exit:</p>\n\n<p><a href=\"https://i.stack.imgur.com/RjbMW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RjbMW.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 179, "user_id": 4299166, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/CpJeS.png?s=128&g=1", "display_name": "laureapresa", "link": "https://stackoverflow.com/users/4299166/laureapresa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 54004089, "answer_count": 1, "score": 0, "last_activity_date": 1566196286, "creation_date": 1546421019, "last_edit_date": 1566196286, "question_id": 54003873, "link": "https://stackoverflow.com/questions/54003873/loop-to-extract-value-from-checkbox", "title": "Loop to extract value from checkbox", "body": "<p>A form I am working with has 10 checkboxes, with values 1 through 10, used to answer a multiple choice question.</p>\n\n<p>Multiple values are technically possible (clicking on multiple boxes), but they are not allowed (while filling, only one value should be given). I cannot modify this form so I have to work with this setup.</p>\n\n<p>I need to extract the given choice and paste it into a different worksheet.\nUsing <a href=\"https://stackoverflow.com/questions/11741836/checking-if-a-worksheet-based-checkbox-is-checked\">this question</a> I can extract the value of every single checkbox and develop a IF Loop.</p>\n\n<pre><code>If ExtractionSheet.Shapes(\"Check Box 1\").OLEFormat.Object.Value = 1 Then\n\nDatabase.Cells(5, 9).Value = 1\n\nElseIf ExtractionSheet.Shapes(\"Check Box 2\").OLEFormat.Object.Value = 1 Then\n\nDatabase.Cells(5, 9).Value = 2\n\nElseIf ExtractionSheet.Shapes(\"Check Box 3\").OLEFormat.Object.Value = 1 Then\n\nDatabase.Cells(5, 9).Value = 3\n\n...\n</code></pre>\n\n<p>However, this does not look very efficient (I have 3 sets of 1-10 checkboxes per form and 100+ forms). Given the setup, I cannot figure out a better way to do it.</p>\n\n<p><strong>How can I improve the extraction without using an IF loop?</strong> </p>\n\n<p><strong>EDIT</strong> A better description of the form, following comments</p>\n\n<p>This is a simple excel worksheet, in which 3 groups of 10 check box elements were pasted.</p>\n\n<p>Each form/worksheet relates to a single item. During the assessment, for each item we will assign a value between 1 and 10 to Property 1 (first 10 check boxes), a value between 1 and 10 to Property 2 (second 10 check boxes) and a value between 1 and 10 to Property 3 (third 10 check boxes). </p>\n\n<p>I will do the filling (physically clicking the box) while in front of the client who is giving me data to fill it. The possibility of clicking multiple boxes naturally exists; I do not think it will be critical because many people will be looking at the screen while I do it, but I can always add a check later on.</p>\n"}, {"tags": ["excel", "vba", "string-concatenation"], "answers": [{"comments": [{"owner": {"reputation": 849, "user_id": 9151274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49f96542b2315af0983a1e2aae197d2b?s=128&d=identicon&r=PG", "display_name": "Anu", "link": "https://stackoverflow.com/users/9151274/anu"}, "edited": false, "score": 0, "creation_date": 1546475245, "post_id": 54003912, "comment_id": 94866905, "body": "Issue with your method is, I need to pre format cells of the source as text which I don&#39;t wish to. Answer from another person above will not format cells of source text and instead, it format the variable into 0000 form. I prefer to do that way. Thanks for your effort. By the way just curious what is that [A1] means? Does it mean Range(&quot;A1&quot;).value?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 849, "user_id": 9151274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49f96542b2315af0983a1e2aae197d2b?s=128&d=identicon&r=PG", "display_name": "Anu", "link": "https://stackoverflow.com/users/9151274/anu"}, "edited": false, "score": 1, "creation_date": 1546496340, "post_id": 54003912, "comment_id": 94870985, "body": "I was trying to cater for the fact you can have variable number of zeroes and there is no statement that that number will always be the same length. Also, if that cell is not text formatted how do you have the 000 at the front as per your description? [] it\u2019s an alternative notation for range so range A1."}, {"owner": {"reputation": 849, "user_id": 9151274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49f96542b2315af0983a1e2aae197d2b?s=128&d=identicon&r=PG", "display_name": "Anu", "link": "https://stackoverflow.com/users/9151274/anu"}, "edited": false, "score": 0, "creation_date": 1546507987, "post_id": 54003912, "comment_id": 94875123, "body": "It is still possible without formatting the cell. I am able to do it with the help from another person here in stackoverflow. it is working by following this code   <code>ciNumber = &quot;PFTPA-&quot; &amp; yearInYy &amp; &quot;-&quot; &amp; Format(runNumber, &quot;0000&quot;)</code>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 849, "user_id": 9151274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49f96542b2315af0983a1e2aae197d2b?s=128&d=identicon&r=PG", "display_name": "Anu", "link": "https://stackoverflow.com/users/9151274/anu"}, "edited": false, "score": 1, "creation_date": 1546519836, "post_id": 54003912, "comment_id": 94881287, "body": "What I am saying is that you said you have 0002 in the cell. How are the zeroes present if the cell is not formatted? If you had just 2 in the cell and wanted 0002 that would be different. You can also use Format$ rather than Format for minor efficiency gains."}, {"owner": {"reputation": 849, "user_id": 9151274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49f96542b2315af0983a1e2aae197d2b?s=128&d=identicon&r=PG", "display_name": "Anu", "link": "https://stackoverflow.com/users/9151274/anu"}, "edited": false, "score": 0, "creation_date": 1546560473, "post_id": 54003912, "comment_id": 94899308, "body": "oh yea..correct. My bad. I asked that way in the question. But when I see a method without any pre cell formatting, I preferred that way."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 849, "user_id": 9151274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49f96542b2315af0983a1e2aae197d2b?s=128&d=identicon&r=PG", "display_name": "Anu", "link": "https://stackoverflow.com/users/9151274/anu"}, "edited": false, "score": 1, "creation_date": 1546560613, "post_id": 54003912, "comment_id": 94899342, "body": "That\u2019s alright :-) note my point about typed function Format$"}, {"owner": {"reputation": 849, "user_id": 9151274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49f96542b2315af0983a1e2aae197d2b?s=128&d=identicon&r=PG", "display_name": "Anu", "link": "https://stackoverflow.com/users/9151274/anu"}, "edited": false, "score": 0, "creation_date": 1546560729, "post_id": 54003912, "comment_id": 94899360, "body": "Sure will do. Format$ is reducing calculation time slightly, isn&#39;t it?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 849, "user_id": 9151274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49f96542b2315af0983a1e2aae197d2b?s=128&d=identicon&r=PG", "display_name": "Anu", "link": "https://stackoverflow.com/users/9151274/anu"}, "edited": false, "score": 0, "creation_date": 1546562568, "post_id": 54003912, "comment_id": 94899742, "body": "In this case you won\u2019t notice but in principal yes. Certainly if using in long loop for example. Just worth being aware of."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1546423125, "last_edit_date": 1546423125, "creation_date": 1546421258, "answer_id": 54003912, "question_id": 54003845, "link": "https://stackoverflow.com/questions/54003845/concatenate-variable-with-leading-zeros-with-another-string/54003912#54003912", "title": "Concatenate variable with leading zeros with another string", "body": "<p>Assuming the field containing the 0002 is formatted as a text field then work with strings throughout. Here I am reading runNumber from cell A1. This means you can deal with a variable number of leading zeroes.</p>\n\n<pre><code>Option Explicit\nPublic Sub test()\n    Dim runNumber As String, yearInYy As String, ciNumber As String\n    yearInYy = \"19\"\n    runNumber = [A1]\n    ciNumber = \"PFTPA-\" &amp; yearInYy &amp; \"-\" &amp; runNumber\n    Debug.Print ciNumber\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "is_accepted": false, "score": 1, "last_activity_date": 1546422277, "creation_date": 1546422277, "answer_id": 54004116, "question_id": 54003845, "link": "https://stackoverflow.com/questions/54003845/concatenate-variable-with-leading-zeros-with-another-string/54004116#54004116", "title": "Concatenate variable with leading zeros with another string", "body": "<p>In order to add leading zeroes to a string, you don't need VBA, you can use following Excel formula for this:</p>\n\n<pre><code>=CONCATENATE(REPT(\"0\";4-LEN(D4));D4)\n</code></pre>\n\n<p>It works as follows:</p>\n\n<ul>\n<li>Take the length of your string, and subtract this from 4 (it will give you the number of \"0\" characters you need).</li>\n<li>Create a string, which consists of a repetition of \"0\" characters.</li>\n<li>Concatenate that repetition of strings to your original string.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": true, "score": 2, "last_activity_date": 1546423557, "creation_date": 1546423557, "answer_id": 54004382, "question_id": 54003845, "link": "https://stackoverflow.com/questions/54003845/concatenate-variable-with-leading-zeros-with-another-string/54004382#54004382", "title": "Concatenate variable with leading zeros with another string", "body": "<pre><code>ciNumber = \"PFTPA-\" &amp; yearInYy &amp; \"-\" &amp; Format(runNumber, \"0000\")\n</code></pre>\n\n<p>Using the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/format-function-visual-basic-for-applications\" rel=\"nofollow noreferrer\"><code>Format</code> function</a>, you can convert a date or number to a string with a specific format.  All we do here is require 4 digits, with leading zeros.</p>\n\n<p>The equivalent in Excel itself is the <a href=\"https://support.office.com/en-us/article/text-function-20d5ac4d-7b94-49fd-bb38-93d29371225c\" rel=\"nofollow noreferrer\"><code>TEXT</code> function</a></p>\n"}], "owner": {"reputation": 849, "user_id": 9151274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49f96542b2315af0983a1e2aae197d2b?s=128&d=identicon&r=PG", "display_name": "Anu", "link": "https://stackoverflow.com/users/9151274/anu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 878, "favorite_count": 0, "accepted_answer_id": 54004382, "answer_count": 3, "score": 0, "last_activity_date": 1551919978, "creation_date": 1546420903, "last_edit_date": 1551919978, "question_id": 54003845, "link": "https://stackoverflow.com/questions/54003845/concatenate-variable-with-leading-zeros-with-another-string", "title": "Concatenate variable with leading zeros with another string", "body": "<p><strong>Scenario</strong></p>\n\n<p>I have an excel cell that contains value with leading zeros (Eg: 0002). My macro is copying this value to a variable called <code>runNumber</code> and pasting it into another file by concatenating this <code>runNumber</code> with some other string. But when it does that, I am missing the leading zeros of <code>runNumber</code></p>\n\n<p><strong>Codes</strong></p>\n\n<p><code>yearInYy = \"19\"</code></p>\n\n<p><code>ciNumber = \"PFTPA-\" &amp; yearInYy &amp; \"-\" &amp; runNumber</code></p>\n\n<p>Output cell showing as <code>PFTPA-19-2</code></p>\n\n<p><strong>What I need</strong></p>\n\n<p>I need the output cell to show</p>\n\n<p><code>PFTPA-19-0002</code></p>\n\n<p>Anyone knows how to do it?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1546418568, "post_id": 54003252, "comment_id": 94843433, "body": "Apply better logic to your code: After the CommandButton is clicked first check if PrBox is not empty/correctly filled. If it isn&#39;t, set focus on the red PrBox and exit the sub. Repeat with BrewBox. Only after the form is found to be filled correctly start transferring data elsewhere."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9173293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6WHOAYjuo0Q/AAAAAAAAAAI/AAAAAAAAAII/FlLqtZ6Aa6s/photo.jpg?sz=128", "display_name": "ermias dillensaw", "link": "https://stackoverflow.com/users/9173293/ermias-dillensaw"}, "edited": false, "score": 0, "creation_date": 1546418287, "post_id": 54003325, "comment_id": 94843317, "body": "Hi Santosh, i did but still nothing.. it does the same thing"}, {"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "reply_to_user": {"reputation": 5, "user_id": 9173293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6WHOAYjuo0Q/AAAAAAAAAAI/AAAAAAAAAII/FlLqtZ6Aa6s/photo.jpg?sz=128", "display_name": "ermias dillensaw", "link": "https://stackoverflow.com/users/9173293/ermias-dillensaw"}, "edited": false, "score": 0, "creation_date": 1546418536, "post_id": 54003325, "comment_id": 94843419, "body": "Move your validation statements after the code starts executing and not at the end."}, {"owner": {"reputation": 5, "user_id": 9173293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6WHOAYjuo0Q/AAAAAAAAAAI/AAAAAAAAAII/FlLqtZ6Aa6s/photo.jpg?sz=128", "display_name": "ermias dillensaw", "link": "https://stackoverflow.com/users/9173293/ermias-dillensaw"}, "edited": false, "score": 0, "creation_date": 1546421816, "post_id": 54003325, "comment_id": 94844739, "body": "i have another question if i may.. how do i make sure that the user never enters the same value twice in BrewBox.text? please let me know if i can do that"}, {"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "reply_to_user": {"reputation": 5, "user_id": 9173293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6WHOAYjuo0Q/AAAAAAAAAAI/AAAAAAAAAII/FlLqtZ6Aa6s/photo.jpg?sz=128", "display_name": "ermias dillensaw", "link": "https://stackoverflow.com/users/9173293/ermias-dillensaw"}, "edited": false, "score": 0, "creation_date": 1546421968, "post_id": 54003325, "comment_id": 94844813, "body": "@ermiasdillensaw You can add this line at then end of validation <code>If Me.PrBox.Value = Me.BrewBox.Value Then     msgbox &quot;Invalid Value&quot;     exit sub end if</code>"}, {"owner": {"reputation": 5, "user_id": 9173293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6WHOAYjuo0Q/AAAAAAAAAAI/AAAAAAAAAII/FlLqtZ6Aa6s/photo.jpg?sz=128", "display_name": "ermias dillensaw", "link": "https://stackoverflow.com/users/9173293/ermias-dillensaw"}, "edited": false, "score": 0, "creation_date": 1546422182, "post_id": 54003325, "comment_id": 94844913, "body": "i get what you&#39;re saying but the code will only check whether the user types the same information in the PrBox and BrewBox.. what i want is to prevent user from entering the same data in BrewBox and the same data in PrBox as well. For example if 12 is used once in BrewBox it should never be used again because it is a unique id kinda thing.."}, {"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "reply_to_user": {"reputation": 5, "user_id": 9173293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6WHOAYjuo0Q/AAAAAAAAAAI/AAAAAAAAAII/FlLqtZ6Aa6s/photo.jpg?sz=128", "display_name": "ermias dillensaw", "link": "https://stackoverflow.com/users/9173293/ermias-dillensaw"}, "edited": false, "score": 0, "creation_date": 1546422347, "post_id": 54003325, "comment_id": 94844977, "body": "In that case you can define a dictionary and store the value. This will allow you to easily check if the value already exist in dictionary."}, {"owner": {"reputation": 5, "user_id": 9173293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6WHOAYjuo0Q/AAAAAAAAAAI/AAAAAAAAAII/FlLqtZ6Aa6s/photo.jpg?sz=128", "display_name": "ermias dillensaw", "link": "https://stackoverflow.com/users/9173293/ermias-dillensaw"}, "edited": false, "score": 0, "creation_date": 1546430519, "post_id": 54003325, "comment_id": 94848517, "body": "still don&#39;t figure out how to restrict duplicate in column D."}, {"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "reply_to_user": {"reputation": 5, "user_id": 9173293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6WHOAYjuo0Q/AAAAAAAAAAI/AAAAAAAAAII/FlLqtZ6Aa6s/photo.jpg?sz=128", "display_name": "ermias dillensaw", "link": "https://stackoverflow.com/users/9173293/ermias-dillensaw"}, "edited": false, "score": 0, "creation_date": 1546431442, "post_id": 54003325, "comment_id": 94848897, "body": "Or use a simple collection object. Collection is a list which store key &amp; value pairs and has unique key. See this link <a href=\"https://stackoverflow.com/a/18800150/2227085\">stackoverflow.com/a/18800150/2227085</a>"}, {"owner": {"reputation": 5, "user_id": 9173293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6WHOAYjuo0Q/AAAAAAAAAAI/AAAAAAAAAII/FlLqtZ6Aa6s/photo.jpg?sz=128", "display_name": "ermias dillensaw", "link": "https://stackoverflow.com/users/9173293/ermias-dillensaw"}, "edited": false, "score": 0, "creation_date": 1546432287, "post_id": 54003325, "comment_id": 94849319, "body": "i actually dont know how it is not working because it really should be simple.. for example the following code just returns &quot;Argument not optional&quot; and i dont know what&#39;s wrong.. If Application.WorksheetFunction.CountIf(Range(&quot;D,D&quot;).Me.BrewBo&zwnj;&#8203;x) &gt; 0 Then      MsgBox &quot;Duplicate Exist in the Database&quot;     Me.BrewBox.Value = &quot;&quot;     Exit Sub End If"}, {"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "reply_to_user": {"reputation": 5, "user_id": 9173293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6WHOAYjuo0Q/AAAAAAAAAAI/AAAAAAAAAII/FlLqtZ6Aa6s/photo.jpg?sz=128", "display_name": "ermias dillensaw", "link": "https://stackoverflow.com/users/9173293/ermias-dillensaw"}, "edited": false, "score": 0, "creation_date": 1546432560, "post_id": 54003325, "comment_id": 94849435, "body": "@ermiasdillensaw don&#39;t worry, I will update the code in sometime"}, {"owner": {"reputation": 5, "user_id": 9173293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6WHOAYjuo0Q/AAAAAAAAAAI/AAAAAAAAAII/FlLqtZ6Aa6s/photo.jpg?sz=128", "display_name": "ermias dillensaw", "link": "https://stackoverflow.com/users/9173293/ermias-dillensaw"}, "edited": false, "score": 0, "creation_date": 1546432686, "post_id": 54003325, "comment_id": 94849513, "body": "oh okay.. Thank you so much!"}, {"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "reply_to_user": {"reputation": 5, "user_id": 9173293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6WHOAYjuo0Q/AAAAAAAAAAI/AAAAAAAAAII/FlLqtZ6Aa6s/photo.jpg?sz=128", "display_name": "ermias dillensaw", "link": "https://stackoverflow.com/users/9173293/ermias-dillensaw"}, "edited": false, "score": 0, "creation_date": 1546489274, "post_id": 54003325, "comment_id": 94869327, "body": "It should be <code>If WorksheetFunction.CountIf(Range(&quot;D:D&quot;), Me.BrewBox.Value) &gt; 0 Then         MsgBox &quot;Duplicate Exist in the Database&quot;         Me.BrewBox.Value = &quot;&quot;         Exit Sub      End If</code>"}, {"owner": {"reputation": 5, "user_id": 9173293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6WHOAYjuo0Q/AAAAAAAAAAI/AAAAAAAAAII/FlLqtZ6Aa6s/photo.jpg?sz=128", "display_name": "ermias dillensaw", "link": "https://stackoverflow.com/users/9173293/ermias-dillensaw"}, "edited": false, "score": 0, "creation_date": 1546495074, "post_id": 54003325, "comment_id": 94870645, "body": "wow it works like charm now!! thank you so very much Santosh that&#39;s genius!"}, {"owner": {"reputation": 5, "user_id": 9173293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6WHOAYjuo0Q/AAAAAAAAAAI/AAAAAAAAAII/FlLqtZ6Aa6s/photo.jpg?sz=128", "display_name": "ermias dillensaw", "link": "https://stackoverflow.com/users/9173293/ermias-dillensaw"}, "edited": false, "score": 0, "creation_date": 1546495612, "post_id": 54003325, "comment_id": 94870797, "body": "i am currently working on multiple projects including power bi so like i am always asking.. do you by any chance know power bi?"}], "tags": [], "owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "is_accepted": true, "score": 0, "last_activity_date": 1546418707, "last_edit_date": 1546418707, "creation_date": 1546418079, "answer_id": 54003325, "question_id": 54003252, "link": "https://stackoverflow.com/questions/54003252/control-mandatory-fields-from-proceeding/54003325#54003325", "title": "Control mandatory fields from proceeding", "body": "<p>Add <code>Exit Sub</code> as shown below. Its stops code execution further.</p>\n\n<pre><code>If Me.DateBox.Value = \"\" Then\n\n   DateBox.BackColor = vbRed\n   MsgBox \"Date Field Can Not be Empty\"\n   Exit sub\nEnd If\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim addlist As Range\n    Dim x As Integer\n    Dim wf As WorksheetFunction\n    Dim y As Integer\n    Dim addlist2 As Range\n    Dim lNextRow As Long\n    Dim ans As Long\n\n    'Validation start\n    If Me.DateBox.Value = \"\" Then\n\n        DateBox.BackColor = vbRed\n        MsgBox \"Date Field Can Not be Empty\"\n        Exit Sub\n    End If\n\n    If Me.PrBox.Value = \"\" Then\n\n        PrBox.BackColor = vbRed\n        MsgBox \"PR No. Field Can Not be Empty\"\n        Exit Sub\n\n    End If\n\n    If Me.BrewBox.Value = \"\" Then\n\n        BrewBox.BackColor = vbRed\n        MsgBox \"Brew Number Field Can Not be Empty\"\n        Exit Sub\n\n    End If\n    'Validation end\n\n    Set wf = Application.WorksheetFunction\n\n    Set addlist = Sheet1.Cells(Rows.Count, 7).End(xlUp).Offset(1, 0)\n    Set addlist2 = Sheet1.Cells(Rows.Count, 7).End(xlUp).Offset(1, 1)\n    For x = 1 To WortSelector.ListCount - 1\n        If Me.WortSelector.Selected(x) Then\n            addlist = Me.WortSelector.List(x)\n            Set addlist = addlist.Offset(1, 0)\n            addlist2 = Me.WortSelector.List(x)\n            Set addlist2 = addlist2.Offset(1, 0)\n        End If\n    Next x\n\n\n    lNextRow = Cells(Rows.Count, 2).End(xlUp).Row + 1\n    Cells(lNextRow, 2) = DateBox.Text\n    Cells(lNextRow, 3) = PrBox.Text\n    Cells(lNextRow, 4) = BrewBox.Text\n    Cells(lNextRow + 1, 9) = RmBox1.Text\n    Cells(lNextRow, 10) = OgBox.Text\n    Cells(lNextRow + 2, 9) = RmBox2.Text\n    Cells(lNextRow + 3, 9) = RmBox3.Text\n    Cells(lNextRow + 4, 9) = RmBox4.Text\n    Cells(lNextRow + 5, 9) = RmBox5.Text\n    Cells(lNextRow + 6, 9) = RmBox6.Text\n    Cells(lNextRow + 7, 9) = RmBox7.Text\n    Cells(lNextRow + 8, 9) = RmBox8.Text\n    Cells(lNextRow + 9, 9) = RmBox9.Text\n    Cells(lNextRow + 10, 9) = RmBox10.Text\n    Cells(lNextRow + 11, 9) = RmBox11.Text\n    Cells(lNextRow + 12, 9) = RmBox12.Text\n    Cells(lNextRow + 1, 8) = rm1\n    Cells(lNextRow + 2, 8) = rm2\n    Cells(lNextRow + 3, 8) = rm3\n    Cells(lNextRow + 4, 8) = rm4\n    Cells(lNextRow + 5, 8) = rm5\n    Cells(lNextRow + 6, 8) = rm6\n    Cells(lNextRow + 7, 8) = rm7\n    Cells(lNextRow + 8, 8) = rm8\n    Cells(lNextRow + 9, 8) = rm9\n    Cells(lNextRow + 10, 8) = rm10\n    Cells(lNextRow + 11, 8) = rm11\n    Cells(lNextRow + 12, 8) = rm12\n\n    Cells(lNextRow, 9) = VolumeBox.Text\n\n    Do\n\n        Set addlist = Sheet1.Cells(Rows.Count, 7).End(xlUp).Offset(1, 0)\n        For x = 1 To WortSelector.ListCount - 1\n            If Me.WortSelector.Selected(x) Then\n                addlist = Me.WortSelector.List(x)\n            End If\n        Next x\n        lNextRow = Cells(Rows.Count, 2).End(xlUp).Row + 1\n        Cells(lNextRow, 2) = DateBox.Text\n        Cells(lNextRow, 3) = PrBox.Text\n        Cells(lNextRow, 4) = BrewBox.Text\n    Loop Until Sheet1.Cells(lNextRow + 1, 8).Value = \"\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9173293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6WHOAYjuo0Q/AAAAAAAAAAI/AAAAAAAAAII/FlLqtZ6Aa6s/photo.jpg?sz=128", "display_name": "ermias dillensaw", "link": "https://stackoverflow.com/users/9173293/ermias-dillensaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 54003325, "answer_count": 1, "score": 0, "last_activity_date": 1546418707, "creation_date": 1546417594, "question_id": 54003252, "link": "https://stackoverflow.com/questions/54003252/control-mandatory-fields-from-proceeding", "title": "Control mandatory fields from proceeding", "body": "<p>so i have a user form that i am working on for a while and i have made some fields mandatory using the code below </p>\n\n<pre><code>If Me.DateBox.Value = \"\" Then\n\nDateBox.BackColor = vbRed\nMsgBox \"Date Field Can Not be Empty\"\n\nEnd If\n</code></pre>\n\n<p>now the problem is although this does mark the empty field red and display a message, it just allow the user to processed exporting data to excel after executing the above code. but what i want it to do is to not let the user transfer information without filling the empty text box.</p>\n\n<p>here is the full code..</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim addlist As Range\nDim x As Integer\nDim wf As WorksheetFunction\nDim y As Integer\nDim addlist2 As Range\nDim lNextRow As Long\nDim ans As Long\n\nSet wf = Application.WorksheetFunction\n\nSet addlist = Sheet1.Cells(Rows.Count, 7).End(xlUp).Offset(1, 0)\nSet addlist2 = Sheet1.Cells(Rows.Count, 7).End(xlUp).Offset(1, 1)\nFor x = 1 To WortSelector.ListCount - 1\nIf Me.WortSelector.Selected(x) Then\n        addlist = Me.WortSelector.List(x)\n        Set addlist = addlist.Offset(1, 0)\n        addlist2 = Me.WortSelector.List(x)\n        Set addlist2 = addlist2.Offset(1, 0)\n        End If\n        Next x\n\n\nlNextRow = Cells(Rows.Count, 2).End(xlUp).Row + 1\n        Cells(lNextRow, 2) = DateBox.Text\n        Cells(lNextRow, 3) = PrBox.Text\n        Cells(lNextRow, 4) = BrewBox.Text\n        Cells(lNextRow + 1, 9) = RmBox1.Text\n        Cells(lNextRow, 10) = OgBox.Text\n        Cells(lNextRow + 2, 9) = RmBox2.Text\n        Cells(lNextRow + 3, 9) = RmBox3.Text\n        Cells(lNextRow + 4, 9) = RmBox4.Text\n        Cells(lNextRow + 5, 9) = RmBox5.Text\n        Cells(lNextRow + 6, 9) = RmBox6.Text\n        Cells(lNextRow + 7, 9) = RmBox7.Text\n        Cells(lNextRow + 8, 9) = RmBox8.Text\n        Cells(lNextRow + 9, 9) = RmBox9.Text\n        Cells(lNextRow + 10, 9) = RmBox10.Text\n        Cells(lNextRow + 11, 9) = RmBox11.Text\n        Cells(lNextRow + 12, 9) = RmBox12.Text\n        Cells(lNextRow + 1, 8) = rm1\n        Cells(lNextRow + 2, 8) = rm2\n        Cells(lNextRow + 3, 8) = rm3\n        Cells(lNextRow + 4, 8) = rm4\n        Cells(lNextRow + 5, 8) = rm5\n        Cells(lNextRow + 6, 8) = rm6\n        Cells(lNextRow + 7, 8) = rm7\n        Cells(lNextRow + 8, 8) = rm8\n        Cells(lNextRow + 9, 8) = rm9\n        Cells(lNextRow + 10, 8) = rm10\n        Cells(lNextRow + 11, 8) = rm11\n        Cells(lNextRow + 12, 8) = rm12\n\n        Cells(lNextRow, 9) = VolumeBox.Text\n\nDo\n\n    Set addlist = Sheet1.Cells(Rows.Count, 7).End(xlUp).Offset(1, 0)\n    For x = 1 To WortSelector.ListCount - 1\nIf Me.WortSelector.Selected(x) Then\n        addlist = Me.WortSelector.List(x)\n        End If\n        Next x\nlNextRow = Cells(Rows.Count, 2).End(xlUp).Row + 1\n     Cells(lNextRow, 2) = DateBox.Text\n        Cells(lNextRow, 3) = PrBox.Text\n        Cells(lNextRow, 4) = BrewBox.Text\nLoop Until Sheet1.Cells(lNextRow + 1, 8).Value = \"\"\n\nIf Me.DateBox.Value = \"\" Then\n\nDateBox.BackColor = vbRed\nMsgBox \"Date Field Can Not be Empty\"\n\nEnd If\n\nIf Me.PrBox.Value = \"\" Then\n\nPrBox.BackColor = vbRed\nMsgBox \"PR No. Field Can Not be Empty\"\nEnd If\n\nIf Me.BrewBox.Value = \"\" Then\n\nBrewBox.BackColor = vbRed\nMsgBox \"Brew Number Field Can Not be Empty\"\n\nEnd If\n\n\nEnd Sub\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 1, "creation_date": 1546415393, "post_id": 54002873, "comment_id": 94842397, "body": "x looks like an integer to me. So try <code>Dim x as Interger</code> or possibly long, depending on how many rows you expect there to be. Integer has a Max of ~32000 if I remember correctly"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 5, "creation_date": 1546415714, "post_id": 54002873, "comment_id": 94842479, "body": "The <code>x</code> goes from 1 to <code>lastrow</code> where <code>lastrow</code> is <code>Long</code>. So <code>x</code> also should be <code>Long</code>. So <code>Dim x As Long</code> before <code>For x = 1 To lastrow</code>."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1546425599, "post_id": 54002873, "comment_id": 94846343, "body": "Definitely <code>Long</code> as it&#39;s using row numbers which can exceed the limit of an <code>Integer</code>.  Also because <code>lastrow</code> is defined as <code>Long</code>, so makes sense that a variable that steps through each value in <code>lastrow</code> should also be <code>Long</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 1, "creation_date": 1546422063, "post_id": 54002971, "comment_id": 94844856, "body": "S/he means x, not i. Basically, the error occurs because you&#39;re using x as your loop counter: but you have not Dim&#39;med it. You need to declare every variable you use, and loop counter variables are no exception. Lonolian is correct, but just made a typo, using &quot;i&quot; instead of &quot;x&quot;."}, {"owner": {"reputation": 109, "user_id": 10201883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4afa64d4cc611d465e4567fea5c65a46?s=128&d=identicon&r=PG&f=1", "display_name": "Lonolian", "link": "https://stackoverflow.com/users/10201883/lonolian"}, "edited": false, "score": 0, "creation_date": 1546524090, "post_id": 54002971, "comment_id": 94883728, "body": "Thank you Darren Bartup-Cook and Chris Melville"}], "tags": [], "owner": {"reputation": 109, "user_id": 10201883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4afa64d4cc611d465e4567fea5c65a46?s=128&d=identicon&r=PG&f=1", "display_name": "Lonolian", "link": "https://stackoverflow.com/users/10201883/lonolian"}, "is_accepted": false, "score": 0, "last_activity_date": 1546425695, "last_edit_date": 1546425695, "creation_date": 1546415728, "answer_id": 54002971, "question_id": 54002873, "link": "https://stackoverflow.com/questions/54002873/variable-not-defined-problem-with-option-explicit-macro/54002971#54002971", "title": "Variable not defined problem with option explicit macro", "body": "<p>As Andreas before me: \nYou have to define the <code>x</code> variable:</p>\n\n<pre><code>Sub FillDuplicates()\nDim lastrow As Long\n\nDim x as Integer 'if you have more 32767 rows to check then use double which is good for 1.79769313486231570E+308\n\nlastrow = Cells(Rows.Count, \"A\").End(xlUp).Row 'find last row in column A\n\nFor x = 1 To lastrow\n    If Cells(x, 1).Value = 0 Then 'Find initial 0 value\n\n            If Cells(x + 1, 1).Value = 0 Then 'Compares cell against previous cell\n                Cells(x + 1, 1).Value = \"\" 'If matches, sets value as nothing\n            End If\n\n    End If\nNext x\n\nEnd Sub\n</code></pre>\n\n<p>This should solve the problem :)</p>\n"}], "owner": {"reputation": 1, "user_id": 10829375, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zKL3bZB73wU/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcb5s0pFuZ6iwepVtbnYP_LpPq2EGg/mo/photo.jpg?sz=128", "display_name": "Fergus Farbridge", "link": "https://stackoverflow.com/users/10829375/fergus-farbridge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 325, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1546425695, "creation_date": 1546415161, "last_edit_date": 1546415338, "question_id": 54002873, "link": "https://stackoverflow.com/questions/54002873/variable-not-defined-problem-with-option-explicit-macro", "title": "Variable not defined problem with option explicit macro", "body": "<p>I have the below code which works with a simple sheet. If I try and incorporate it into my macro, which is option explicit then it throws an error that variable x is not defined. </p>\n\n<p>Have tried various Dim as but without success. New to this so I assume I am missing something, probably fairly obvious to you guys</p>\n\n<pre><code>Sub FillDuplicates()\nDim lastrow As Long\n\nlastrow = Cells(Rows.Count, \"A\").End(xlUp).Row 'find last row in column A\n\nFor x = 1 To lastrow\n    If Cells(x, 1).Value = 0 Then 'Find initial 0 value\n\n            If Cells(x + 1, 1).Value = 0 Then 'Compares cell against previous cell\n                Cells(x + 1, 1).Value = \"\" 'If matches, sets value as nothing\n            End If\n\n    End If\nNext x\n\nEnd Sub\n</code></pre>\n\n<p>This identifies where there are a number of consecutive 0 values in the column. It then retains the first and deletes the others, then moves on to the next group and so on.</p>\n"}, {"tags": ["vba", "macos", "office365", "office-js"], "comments": [{"owner": {"reputation": 945, "user_id": 4602441, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/122a113afb9b3f018b80e47e63d1fa4d?s=128&d=identicon&r=PG&f=1", "display_name": "Fluous", "link": "https://stackoverflow.com/users/4602441/fluous"}, "edited": false, "score": 0, "creation_date": 1546415115, "post_id": 54002764, "comment_id": 94842317, "body": "If I understand correctly you would like to open a document via office.js. When this document is opened, some legacy VBA code needs to be run. The VBA code runs fine, when this is done on Windows, but does not happen when you try it on Mac?   Either way, please provide some more information. This is too little to help you. Are there errors, did you do any research yourself, et cetera."}, {"owner": {"reputation": 11, "user_id": 7454767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fcd223ba84048038dd32e5bb01d0fef?s=128&d=identicon&r=PG&f=1", "display_name": "Morten Hald Mortensen", "link": "https://stackoverflow.com/users/7454767/morten-hald-mortensen"}, "reply_to_user": {"reputation": 945, "user_id": 4602441, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/122a113afb9b3f018b80e47e63d1fa4d?s=128&d=identicon&r=PG&f=1", "display_name": "Fluous", "link": "https://stackoverflow.com/users/4602441/fluous"}, "edited": false, "score": 0, "creation_date": 1546505371, "post_id": 54002764, "comment_id": 94874002, "body": "You are spot on! On windows everything is good. On MAC, the VBA can run, but is not executed. I am trying to identify the best possible way to trigger legacy code when opening a document from the app."}, {"owner": {"reputation": 945, "user_id": 4602441, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/122a113afb9b3f018b80e47e63d1fa4d?s=128&d=identicon&r=PG&f=1", "display_name": "Fluous", "link": "https://stackoverflow.com/users/4602441/fluous"}, "edited": false, "score": 0, "creation_date": 1546505934, "post_id": 54002764, "comment_id": 94874220, "body": "Does the VBA code run when you open the document manually (i.e. without opening it through <code>createDocument</code> method of Office.js)? What I am trying to discern is whether Office.js opens the document differently than when a user opens it."}, {"owner": {"reputation": 11, "user_id": 7454767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fcd223ba84048038dd32e5bb01d0fef?s=128&d=identicon&r=PG&f=1", "display_name": "Morten Hald Mortensen", "link": "https://stackoverflow.com/users/7454767/morten-hald-mortensen"}, "reply_to_user": {"reputation": 945, "user_id": 4602441, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/122a113afb9b3f018b80e47e63d1fa4d?s=128&d=identicon&r=PG&f=1", "display_name": "Fluous", "link": "https://stackoverflow.com/users/4602441/fluous"}, "edited": false, "score": 0, "creation_date": 1546594143, "post_id": 54002764, "comment_id": 94907581, "body": "Yes, it runs manually - no problems there. It is the &quot;open&quot; from Office.js that is the only issue."}, {"owner": {"reputation": 945, "user_id": 4602441, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/122a113afb9b3f018b80e47e63d1fa4d?s=128&d=identicon&r=PG&f=1", "display_name": "Fluous", "link": "https://stackoverflow.com/users/4602441/fluous"}, "edited": false, "score": 1, "creation_date": 1546595111, "post_id": 54002764, "comment_id": 94908078, "body": "My guess would be that this is a bug or restriction from Office.js, if there are no other messages or errors. You could try posting an issue on their <a href=\"https://github.com/OfficeDev/office-js/issues\" rel=\"nofollow noreferrer\">github</a>. I am not able to help you any further without anymore information."}], "answers": [{"tags": [], "owner": {"reputation": 584, "user_id": 997491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1ea868c2622e8fc7f977053f4e3c1?s=128&d=identicon&r=PG", "display_name": "Doug Mahugh", "link": "https://stackoverflow.com/users/997491/doug-mahugh"}, "is_accepted": false, "score": 1, "last_activity_date": 1548697904, "creation_date": 1548697904, "answer_id": 54407625, "question_id": 54002764, "link": "https://stackoverflow.com/questions/54002764/how-to-trigger-autoopen-autonew-on-mac-using-office-js-to-topen-documents/54407625#54407625", "title": "How to trigger autoopen/autonew on MAC using office.js to topen documents", "body": "<p>For future reference: as discussed on a related <a href=\"https://github.com/OfficeDev/office-js/issues/357\" rel=\"nofollow noreferrer\">GitHub issue</a>, this feature was disabled on Mac Word, and will likely be disabled on the Windows client as well.</p>\n"}], "owner": {"reputation": 11, "user_id": 7454767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fcd223ba84048038dd32e5bb01d0fef?s=128&d=identicon&r=PG&f=1", "display_name": "Morten Hald Mortensen", "link": "https://stackoverflow.com/users/7454767/morten-hald-mortensen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548697904, "creation_date": 1546414541, "question_id": 54002764, "link": "https://stackoverflow.com/questions/54002764/how-to-trigger-autoopen-autonew-on-mac-using-office-js-to-topen-documents", "title": "How to trigger autoopen/autonew on MAC using office.js to topen documents", "body": "<p>I wish to activate legacy VBA code when opening a document using office.js</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/javascript/api/word/word.application?view=office-js#createdocument-base64file-\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/javascript/api/word/word.application?view=office-js#createdocument-base64file-</a></p>\n\n<p>On MAC autoopen/autonew does not kick-in. </p>\n\n<p>Anyone with good solutions to this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1546413120, "post_id": 54002503, "comment_id": 94841777, "body": "You can&#39;t access the VBA project of any Excel workbook unless access to the VBA project is granted, and it isn&#39;t possible to grant such access by any programmatic way - only manually. Therefore you would have open workbooks one by one and copy its worksheets into new workbooks. If you have Excel 2007 (or later) you might open each wb and save a copy of it in xlsx format. Use VBA."}], "answers": [{"comments": [{"owner": {"reputation": 3477, "user_id": 612678, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b66d594dc1a47391996bb86a032e942d?s=128&d=identicon&r=PG&f=1", "display_name": "lamwaiman1988", "link": "https://stackoverflow.com/users/612678/lamwaiman1988"}, "edited": false, "score": 0, "creation_date": 1546418867, "post_id": 54002931, "comment_id": 94843551, "body": "After it become a xlsx file, can I save it back to xls file?"}, {"owner": {"reputation": 3477, "user_id": 612678, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b66d594dc1a47391996bb86a032e942d?s=128&d=identicon&r=PG&f=1", "display_name": "lamwaiman1988", "link": "https://stackoverflow.com/users/612678/lamwaiman1988"}, "edited": false, "score": 0, "creation_date": 1546567908, "post_id": 54002931, "comment_id": 94900700, "body": "Thanks. It didn&#39;t work though. The script activate the vba module because there is a trigger for save action. When the script run, it trigger the SUB and error out. I gave up."}], "tags": [], "owner": {"reputation": 109, "user_id": 10201883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4afa64d4cc611d465e4567fea5c65a46?s=128&d=identicon&r=PG&f=1", "display_name": "Lonolian", "link": "https://stackoverflow.com/users/10201883/lonolian"}, "is_accepted": false, "score": 3, "last_activity_date": 1546415454, "creation_date": 1546415454, "answer_id": 54002931, "question_id": 54002503, "link": "https://stackoverflow.com/questions/54002503/is-there-a-way-to-programmatically-remove-all-vba-module-from-a-lot-of-excel-wor/54002931#54002931", "title": "Is there a way to programmatically remove all vba module from a lot of excel worksheets", "body": "<p>What I would do, I would create a macro which would open these files and save them as xlsx instead of xlsm. As xlsx can not contain the modules they will vanish.\nThan you just have to delete the original ones. </p>\n\n<p>You can even use macro recording to do this.</p>\n\n<p>If we are talking about a lot of files,( I suppose we do)\nYou can generate the name of the files, if there is logic behind them ( like dates)\nor you can place them into folder, and than loop through the items in the folder, open them, save as, delete original. </p>\n\n<p>You can find a lot of options how to check each file in a folder (FSO)</p>\n\n<p>Happy new year!</p>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 1, "last_activity_date": 1546425800, "creation_date": 1546425800, "answer_id": 54004899, "question_id": 54002503, "link": "https://stackoverflow.com/questions/54002503/is-there-a-way-to-programmatically-remove-all-vba-module-from-a-lot-of-excel-wor/54004899#54004899", "title": "Is there a way to programmatically remove all vba module from a lot of excel worksheets", "body": "<p>Change Path and try:</p>\n\n<pre><code>Option Explicit\n\nSub LoopThroughFiles()\n\n    Dim StrFile As String\n    Dim Element As Object\n    Dim WB As Workbook\n\n    StrFile = Dir(\"C:\\Users\\XXXXX\\Desktop\\Test\\*\")\n\n    Do While Len(StrFile) &gt; 0\n        If Right(StrFile, 4) = \".xls\" Then\n\n            Set WB = Workbooks.Open(\"C:\\Users\\marios.p\\Desktop\\Test\\\" &amp; StrFile)\n\n            For Each Element In ActiveWorkbook.VBProject.VBComponents\n                If Element.Type &lt;&gt; 100 Then\n                    ActiveWorkbook.VBProject.VBComponents.Remove Element\n                End If\n            Next\n\n            WB.Save\n            WB.Close\n\n        End If\n\n        StrFile = Dir\n    Loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3477, "user_id": 612678, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b66d594dc1a47391996bb86a032e942d?s=128&d=identicon&r=PG&f=1", "display_name": "lamwaiman1988", "link": "https://stackoverflow.com/users/612678/lamwaiman1988"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1466, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1566196291, "creation_date": 1546412805, "last_edit_date": 1566196291, "question_id": 54002503, "link": "https://stackoverflow.com/questions/54002503/is-there-a-way-to-programmatically-remove-all-vba-module-from-a-lot-of-excel-wor", "title": "Is there a way to programmatically remove all vba module from a lot of excel worksheets", "body": "<p>I have many excel file(.xls) in a folder and each of them have a vba macro/module in it and I need them to be remove. Can I write an external program which loop through the folder, inspect each excel file and remove vba module? Please tell me what programming language could does it most easily. Thanks!</p>\n\n<p>With a manual process, I have to 1) open the worksheet, 2) click \"Enable Content\", 3) Go to Developer tab, 4)Click \"Visual Basic\" button, 5) Right click the vba module and delete. As I mentioned, I have of these excel files and it is a routine job and I want to remove the human part. Thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 2, "creation_date": 1546412837, "post_id": 54001990, "comment_id": 94841663, "body": "If you want to apply the filter using VBA you might remove the existing filter, based on one column, and apply a new filter based on two columns."}, {"owner": {"reputation": 73, "user_id": 9439575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-f8coMtpES20/AAAAAAAAAAI/AAAAAAABO4o/xlKaPEBSj3U/photo.jpg?sz=128", "display_name": "Eran Peer", "link": "https://stackoverflow.com/users/9439575/eran-peer"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1546415074, "post_id": 54001990, "comment_id": 94842303, "body": "How can I do it? Variatus"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 1, "creation_date": 1546417074, "post_id": 54001990, "comment_id": 94842905, "body": "You might record a macro."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 9439575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-f8coMtpES20/AAAAAAAAAAI/AAAAAAABO4o/xlKaPEBSj3U/photo.jpg?sz=128", "display_name": "Eran Peer", "link": "https://stackoverflow.com/users/9439575/eran-peer"}, "edited": false, "score": 0, "creation_date": 1546454752, "post_id": 54008848, "comment_id": 94859826, "body": "Thank you it is working but How can I get the last row with a variable?"}, {"owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "reply_to_user": {"reputation": 73, "user_id": 9439575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-f8coMtpES20/AAAAAAAAAAI/AAAAAAABO4o/xlKaPEBSj3U/photo.jpg?sz=128", "display_name": "Eran Peer", "link": "https://stackoverflow.com/users/9439575/eran-peer"}, "edited": false, "score": 0, "creation_date": 1546455283, "post_id": 54008848, "comment_id": 94860027, "body": "@EranPeer I edited my post with the full code as well as a brief explanation. Feel free to ask further questions as needed."}, {"owner": {"reputation": 73, "user_id": 9439575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-f8coMtpES20/AAAAAAAAAAI/AAAAAAABO4o/xlKaPEBSj3U/photo.jpg?sz=128", "display_name": "Eran Peer", "link": "https://stackoverflow.com/users/9439575/eran-peer"}, "edited": false, "score": 0, "creation_date": 1546459011, "post_id": 54008848, "comment_id": 94861597, "body": "Thank you very much but you can help me please to filter with blank cells to write &quot;other&quot; ?"}, {"owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "reply_to_user": {"reputation": 73, "user_id": 9439575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-f8coMtpES20/AAAAAAAAAAI/AAAAAAABO4o/xlKaPEBSj3U/photo.jpg?sz=128", "display_name": "Eran Peer", "link": "https://stackoverflow.com/users/9439575/eran-peer"}, "edited": false, "score": 0, "creation_date": 1546460370, "post_id": 54008848, "comment_id": 94862083, "body": "@EranPeer I think you should be able to figure out how to do that by repeating the processes you already know. Try it first. If you cannot figure it out post the code you are using and I will help."}, {"owner": {"reputation": 73, "user_id": 9439575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-f8coMtpES20/AAAAAAAAAAI/AAAAAAABO4o/xlKaPEBSj3U/photo.jpg?sz=128", "display_name": "Eran Peer", "link": "https://stackoverflow.com/users/9439575/eran-peer"}, "edited": false, "score": 0, "creation_date": 1546469168, "post_id": 54008848, "comment_id": 94865452, "body": "I got along but there is another problem unfortunately"}, {"owner": {"reputation": 73, "user_id": 9439575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-f8coMtpES20/AAAAAAAAAAI/AAAAAAABO4o/xlKaPEBSj3U/photo.jpg?sz=128", "display_name": "Eran Peer", "link": "https://stackoverflow.com/users/9439575/eran-peer"}, "edited": false, "score": 0, "creation_date": 1546469925, "post_id": 54008848, "comment_id": 94865656, "body": "Thanks for the help I&#39;m sorry I&#39;m digging. What conditions can be written if, for example, the Samsung Devices table is missing? Because if I run the code it crashes in the line it is looking for Samsung."}, {"owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "reply_to_user": {"reputation": 73, "user_id": 9439575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-f8coMtpES20/AAAAAAAAAAI/AAAAAAABO4o/xlKaPEBSj3U/photo.jpg?sz=128", "display_name": "Eran Peer", "link": "https://stackoverflow.com/users/9439575/eran-peer"}, "edited": false, "score": 0, "creation_date": 1546522576, "post_id": 54008848, "comment_id": 94882850, "body": "What you want in that case is an <code>IF THEN</code> statement. You&#39;ll want it to be <code>IF samsung is in the list THEN samsung code ENDIF</code> If you needed to figure out if some text was in a large column of text (without filters) what would you do? Once you know what it is Google it with &quot;Excel VBA + thing&quot; and see if you can get it working. ((Also trying to help you learn how to do the code instead of writing it for you. Sorry if that is frustrating at all.))"}], "tags": [], "owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "is_accepted": true, "score": 1, "last_activity_date": 1546455237, "last_edit_date": 1546455237, "creation_date": 1546442392, "answer_id": 54008848, "question_id": 54001990, "link": "https://stackoverflow.com/questions/54001990/range-column-and-add-value-to-the-specific-range/54008848#54008848", "title": "Range Column and add Value to the specific range", "body": "<p>To change the value of only cells that are visible (aka those that are show in the filter) you can use <code>SpecialCells(xlCellTypeVisible)</code> </p>\n\n<p>So for your example the code that would go in the first break would be</p>\n\n<p><code>\"Range(\"B2:B18\").SpecialCells(xlCellTypeVisible).Value= \"Samsung\"</code></p>\n\n<p>and the second break</p>\n\n<p><code>\"Range(\"B2:B18\").SpecialCells(xlCellTypeVisible).Value= \"Apple\"</code></p>\n\n<p>You need to change \"18\" to whatever the last row is. (Or you can define a variable called LastRow and then call that instead of hard-coding the number which means it will dynamically change based on how many rows there are.) </p>\n\n<hr>\n\n<p>With LastRow</p>\n\n<pre><code>Sub Macro1()\n\n Dim LastRow As Long\n  LastRow = ActiveSheet.Cells.Find(\"*\", searchorder:=xlByRows, searchdirection:=xlPrevious).Row\n\n    Range(\"Table1[type phone]\").Select\n    ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=1, Criteria1:= _\n        \"=*samsung*\", Operator:=xlAnd\n        Range(\"Table1[company]\").Select\n\nRange(\"B2:B\" &amp; LastRow).SpecialCells(xlCellTypeVisible).Value= \"Samsung\"\n\n    ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=1, Criteria1:= _\n        \"=*iphone*\", Operator:=xlAnd\n        Range(\"Table1[company]\").Select\n\nRange(\"B2:B\" &amp; LastRow).SpecialCells(xlCellTypeVisible).Value= \"Apple\"\nEnd Sub\n</code></pre>\n\n<p>We created a new variable called LastRow and defined it as long (A type of number). Then we defined LastRow according to a formula I use from this site: \n<a href=\"https://www.thespreadsheetguru.com/blog/2014/7/7/5-different-ways-to-find-the-last-row-or-last-column-using-vba\" rel=\"nofollow noreferrer\">https://www.thespreadsheetguru.com/blog/2014/7/7/5-different-ways-to-find-the-last-row-or-last-column-using-vba</a></p>\n\n<p>Finally we replace Range(\"B2:B18\") with Range(\"B2:B\" &amp; LastRow) which dynamically replaces the 18 with the number LastRow. </p>\n"}], "owner": {"reputation": 73, "user_id": 9439575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-f8coMtpES20/AAAAAAAAAAI/AAAAAAABO4o/xlKaPEBSj3U/photo.jpg?sz=128", "display_name": "Eran Peer", "link": "https://stackoverflow.com/users/9439575/eran-peer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 54008848, "answer_count": 1, "score": -1, "last_activity_date": 1566196304, "creation_date": 1546409531, "last_edit_date": 1566196304, "question_id": 54001990, "link": "https://stackoverflow.com/questions/54001990/range-column-and-add-value-to-the-specific-range", "title": "Range Column and add Value to the specific range", "body": "<p>I have Excel file that I want to filter about one column and on another column add specific value</p>\n\n<p><a href=\"https://i.stack.imgur.com/9O1So.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9O1So.png\" alt=\"The Excel file\"></a>    </p>\n\n<pre><code>Sub Macro1()\n'\n' Macro1\n'\n\n'\n    Range(\"Table1[type phone]\").Select\n    ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=1, Criteria1:= _\n        \"=*samsung*\", Operator:=xlAnd\n        Range(\"Table1[company]\").Select\n\n        'Here I want to  add the specific value \"Samsung\"'\n\n    ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=1, Criteria1:= _\n        \"=*iphone*\", Operator:=xlAnd\n        Range(\"Table1[company]\").Select\n\n        'Here I want to  add the specific value \"Apple\"'\n\nEnd Sub\n</code></pre>\n\n<p>Also how can I filter about one column Blanks cells and on another column add specific value \"other\"?</p>\n\n<p>[<img src=\"https://i.stack.imgur.com/e8oMc.png\" alt=\"others Items[2]\"></p>\n\n<p>What conditions can be written if, for example, the Samsung Devices table is missing?\nBecause if I run the code it crashes in the line it is looking for Samsung.</p>\n\n<p><a href=\"https://i.stack.imgur.com/rv8bd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rv8bd.png\" alt=\"Without Samsung Devices\"></a></p>\n\n<p>How can I do it? \nThank You for helping!</p>\n"}, {"tags": ["sql", "vba", "ms-access", "adodb"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1546410956, "post_id": 54001872, "comment_id": 94841074, "body": "Depending on how many inserts vs updates you have, you could first run the update and check on the &quot;records affected&quot; value, then if that&#39;s zero run the insert.  <a href=\"https://stackoverflow.com/questions/12676747/how-to-get-the-affected-rows-in-vba-ado-execute\" title=\"how to get the affected rows in vba ado execute\">stackoverflow.com/questions/12676747/&hellip;</a>"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1546413106, "post_id": 54001872, "comment_id": 94841772, "body": "I am surprised code works. Should use <code>[ ]</code> to delimit table and field names, not apostrophes: <code>[All SAMs Backlog]</code>. If the LocID is common key, can&#39;t you join tables?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1546413116, "post_id": 54001872, "comment_id": 94841775, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/6199417/upserting-in-ms-access\">Upserting in MS-access</a>"}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1546413722, "creation_date": 1546413722, "answer_id": 54002642, "question_id": 54001872, "link": "https://stackoverflow.com/questions/54001872/increase-speed-of-multiple-inserts-into-access-db-from-vba-dictionary/54002642#54002642", "title": "Increase speed of multiple inserts into Access DB from VBA Dictionary", "body": "<p>Either:</p>\n\n<p>Write the content of the dictionary to a temp table, then run a query as described here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/29267266/access-compare-two-tables-and-update-or-insert-data-in-first-table/29272782#29272782\">Update or insert data in table</a></p>\n\n<p>or:</p>\n\n<p>Open <code>[All SAMs Backlog]</code> as a recordset, loop the dictionary to <em>add</em> or <em>edit</em> records as needed, then close the recordset.</p>\n"}], "owner": {"reputation": 700, "user_id": 6274595, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/fbccb62f5faf92749bd3183879fbd21e?s=128&d=identicon&r=PG&f=1", "display_name": "PL200", "link": "https://stackoverflow.com/users/6274595/pl200"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 54002642, "answer_count": 1, "score": 0, "last_activity_date": 1546413722, "creation_date": 1546408681, "question_id": 54001872, "link": "https://stackoverflow.com/questions/54001872/increase-speed-of-multiple-inserts-into-access-db-from-vba-dictionary", "title": "Increase speed of multiple inserts into Access DB from VBA Dictionary", "body": "<p>I am attempting to take a VBA Dictionary and either:</p>\n\n<ul>\n<li>Insert a new row into the database if it does not exist</li>\n<li>Update the row if it does</li>\n</ul>\n\n<p>While my current code works for this, it runs extremely slowly for the thousands of records I may need to update, and other solutions I have found on this site do not really achieve what I am after. Could anyone help me achieve this? My code so far is below:</p>\n\n<pre><code>Sub UpdateDatabase(dict As Object)\nDim Conn As Object, StrSQL As String, Rs As Object\nDim hmm As ADODB.Recordset\n\nSet Conn = CreateObject(\"ADODB.Connection\")\nConn.Provider = \"Microsoft.ACE.OLEDB.12.0\"\nConn.Open \"C:\\XXXX\\cfrv2.accdb\" \n\ndictCount = dict.Count\ncounter = 0\nFor Each varKey In dict.Keys()\n    Application.StatusBar = Str(counter) &amp; \"/\" &amp; Str(dictCount)\n    counter = counter + 1\n    StrSQL = \"SELECT * FROM `All SAMs Backlog` WHERE [LOCID] = '\" &amp; varKey &amp; \"'\"\n\n    Set hmm = Conn.Execute(StrSQL)\n    If hmm.BOF And hmm.EOF Then\n        StrSQL = \"INSERT INTO `ALL SAMs Backlog` ([SAM], [LOCID], [RTC Date], [CFR Status], [CFR Completed Date], [CFR On Hold Reason], [MDU], [ICWB Issue], [Obsolete]) VALUES (dict.Item(varKey)(0), '\" &amp; varKey &amp; \"', '20/12/2018', '\" &amp; dict.Item(varKey)(1) &amp; \"', '02/01/2019', '\" &amp; dict.Item(varKey)(2) &amp; \"' , '\" &amp; dict.Item(varKey)(3) &amp; \"' , '\" &amp;dict.Item(varKey)(4) &amp; \"' , '\" &amp; dict.Item(varKey)(5) &amp; \"')\"\n        Conn.Execute (StrSQL)\n    Else\n        'Update the LOC in the table\n        StrSQL = \"UPDATE `All SAMs Backlog` SET ([CFR Status] = '\" &amp; dict.Item(varKey)(1) &amp; \"', [CFR On Hold Reason] = '\" &amp; dict.Item(varKey)(2) &amp; \"', [MDU] = '\" &amp; dict.Item(varKey)(3) &amp; \"', [ICWB Issue] = '\" &amp; dict.Item(varKey)(4) &amp; \"', [Obsolete] = '\" &amp; dict.Item(varKey)(5) &amp; \"')\"\n        Conn.Execute (StrSQL)\n    End If\nNext\n\nConn.Close\nEnd Sub\n</code></pre>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 116, "user_id": 5982062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HFQvV.jpg?s=128&g=1", "display_name": "wallyeye", "link": "https://stackoverflow.com/users/5982062/wallyeye"}, "edited": false, "score": 0, "creation_date": 1546407497, "post_id": 54001588, "comment_id": 94840118, "body": "Instr(1,v,\u201dNNN\u201d). And selection.insert will help"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 10853415, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fWp7PygvrwQ/AAAAAAAAAAI/AAAAAAAAACA/T9J1ttrSNaM/photo.jpg?sz=128", "display_name": "Bigyan Bhandari", "link": "https://stackoverflow.com/users/10853415/bigyan-bhandari"}, "edited": false, "score": 0, "creation_date": 1546410763, "post_id": 54001851, "comment_id": 94840999, "body": "It worked !, Thank You so much, that&#39;s what exactly I am looking for. SO &amp; you guys are amazing. :)"}], "tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": true, "score": 1, "last_activity_date": 1546408516, "creation_date": 1546408516, "answer_id": 54001851, "question_id": 54001588, "link": "https://stackoverflow.com/questions/54001588/select-cells-containing-specific-texts-in-specified-row-and-shift-cells-down/54001851#54001851", "title": "Select cells containing specific texts in specified row and shift cells down", "body": "<p>Welcome to SO. May try</p>\n\n<pre><code>Sub select_text_and_shiftdown()\nDim r As Range, v As Variant\nDim w1 As Worksheet\nDim Chk As Variant\nDim i As Integer\nChk = Array(\"NNN\", \"MG\", \"FS\", \"N\", \"IG\")\nSet w1 = Sheets(\"Input\")\nw1.Activate\nFor Each r In Intersect(Range(\"7:7\"), ActiveSheet.UsedRange)\n    v = r.Value\n        For i = LBound(Chk) To UBound(Chk)\n            If InStr(v, Chk(i)) &gt; 0 Then\n            'r.Application.Selection.inset shift = xlDown\n            r.Insert xlShiftDown\n            Exit For\n            End If\n        Next i\n   Next r\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 10853415, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fWp7PygvrwQ/AAAAAAAAAAI/AAAAAAAAACA/T9J1ttrSNaM/photo.jpg?sz=128", "display_name": "Bigyan Bhandari", "link": "https://stackoverflow.com/users/10853415/bigyan-bhandari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 906, "favorite_count": 0, "accepted_answer_id": 54001851, "answer_count": 1, "score": 1, "last_activity_date": 1609837162, "creation_date": 1546406544, "last_edit_date": 1609837162, "question_id": 54001588, "link": "https://stackoverflow.com/questions/54001588/select-cells-containing-specific-texts-in-specified-row-and-shift-cells-down", "title": "Select cells containing specific texts in specified row and shift cells down", "body": "<p>I am trying to select the cells that contain strings &quot;NNN&quot;, &quot;MG&quot;,&quot;FS&quot;,&quot;N&quot;,&quot;IG&quot; etc. in Row 7 and Shift those cells down.</p>\n<p>I got an error, also I didn't get the idea how to use multiple criteria (&quot;NNN&quot;,&quot;MG&quot;,&quot;FS&quot;) for selection.</p>\n<p><img src=\"https://i.stack.imgur.com/O8Z4E.jpg\" alt=\"Screenhot of Excel File\" /></p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub select_text_and_shiftdown()\n    Dim r As Range, v As Variant\n    Dim w1 As Worksheet\n    Set w1 = Sheets(&quot;Input&quot;)\n    w1.Activate\n    For Each r In Intersect(Range(&quot;7:7&quot;), ActiveSheet.UsedRange)\n        v = r.Value\n        If InStr(v, &quot;NNN&quot;) &gt; 0 Then\n            r.Application.Selection.inset shift = xlDown  \n       End If\n   Next r\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1546397140, "post_id": 54000643, "comment_id": 94838262, "body": "Copy it first to a default location and then open it. That way, the original file will not be overwritten."}, {"owner": {"reputation": 1, "user_id": 10849593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/192137d65b65f07b16ca453bb35d39ce?s=128&d=identicon&r=PG&f=1", "display_name": "ARodrigo", "link": "https://stackoverflow.com/users/10849593/arodrigo"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1546397744, "post_id": 54000643, "comment_id": 94838379, "body": "Will that save a new copy of the template every time it is opened?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1546412016, "post_id": 54000643, "comment_id": 94841417, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/49703241/copying-contents-of-word-doc-to-newly-created-word-doc-from-excel-vba\">Copying contents of Word doc to newly created Word doc from excel VBA</a>"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1546493748, "post_id": 54000643, "comment_id": 94870302, "body": "@ARodrigo Yes, it will save a new one. But that will preserve your original file. Also, you can edit the template and update it anytime as it will not be locked when someone uses it."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10849593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/192137d65b65f07b16ca453bb35d39ce?s=128&d=identicon&r=PG&f=1", "display_name": "ARodrigo", "link": "https://stackoverflow.com/users/10849593/arodrigo"}, "edited": false, "score": 0, "creation_date": 1546435088, "post_id": 54001294, "comment_id": 94850667, "body": "Thank you for finding the other thread! And thank @Variatus for letting me know that I can specify the extension of the added document. That solved my issue. If I don&#39;t specify the extension though, will it automatically choose the default for the user? Like if they&#39;re using Office 2003 will it default to .doc?"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 1, "user_id": 10849593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/192137d65b65f07b16ca453bb35d39ce?s=128&d=identicon&r=PG&f=1", "display_name": "ARodrigo", "link": "https://stackoverflow.com/users/10849593/arodrigo"}, "edited": false, "score": 0, "creation_date": 1546479505, "post_id": 54001294, "comment_id": 94867700, "body": "This is what MSDN says: Can be one of the following WdNewDocumentType constants: wdNewBlankDocument , wdNewEmailMessage , wdNewFrameset , or wdNewWebPage. The default constant is wdNewBlankDocument. Actually, the question of docx or dotm would arise only at the time of saving. The newly added document is unspecified in this regard."}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 1, "last_activity_date": 1546404304, "creation_date": 1546404304, "answer_id": 54001294, "question_id": 54000643, "link": "https://stackoverflow.com/questions/54000643/prevent-word-template-from-being-saved-over-word-doc-is-generated-from-excel/54001294#54001294", "title": "Prevent Word template from being saved over; Word doc is generated from Excel", "body": "<p>Don't use Set objDoc = wdApp.Documents.Open(\"[template file location]\"). The correct syntax is to use </p>\n\n<pre><code>Set objDoc = wdApp.Documents.Add(\"[template file location]\")\n</code></pre>\n\n<p>This will add a document based on the specified template. There are more arguments you can pass, including the <em>DocumentType</em> which would specify whether the new document is of docx format.</p>\n"}], "owner": {"reputation": 1, "user_id": 10849593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/192137d65b65f07b16ca453bb35d39ce?s=128&d=identicon&r=PG&f=1", "display_name": "ARodrigo", "link": "https://stackoverflow.com/users/10849593/arodrigo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1566196316, "creation_date": 1546396890, "last_edit_date": 1566196316, "question_id": 54000643, "link": "https://stackoverflow.com/questions/54000643/prevent-word-template-from-being-saved-over-word-doc-is-generated-from-excel", "title": "Prevent Word template from being saved over; Word doc is generated from Excel", "body": "<p>I am using VBA in Excel to generate a shipping label in Word from a Word template. One time, after the Word doc was successfully opened and populated with my data, I accidentally saved over my original template when I closed it. </p>\n\n<p>I want to prevent the user from being able to do this. If they close the Word doc without saving it first, I want them to be prompted to SaveAs, not to save over the existing template, and I want that SaveAs prompt to default to a .doc or .docx file, not a .dotx template file. If they hit the save button or Ctrl+S instead of just closing the document, I want the same SaveAs prompt to appear instead of overwriting my template.</p>\n\n<p>For reference, I'll include the code that opens up my Word template. I declare my objects using Object instead of Word.Application to prevent missing reference errors for users who don't have references to the Word object library set up on their computers. This will be used on a few different computers, and they don't all have the same version of Office, so if you can think of anything else I can do to maintain compatibility I would love to hear it. </p>\n\n<p>Since this involves the saving of a Word document generated from an Excel workbook, I'm not sure how to write event handling for this. Any help would be really appreciated. Thank you.</p>\n\n<pre><code>Dim wdApp As Object\nDim objRange As Object\nDim objDoc As Object\n\nSet wdApp = CreateObject(\"Word.Application\")\nSet objDoc = wdApp.Documents.Open(\"[template file location]\")\n\nWith wdApp\n\n    .Visible = True  \n    .Activate  \n\n   'Code that places strings at bookmark locations\n    Set objRange = objDoc.Bookmarks(\"bookmarkName\").Range  \n    objRange.InsertAfter (stringName)  \n\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1546396532, "post_id": 54000531, "comment_id": 94838186, "body": "I&#39;ve removed the excel-vba tag. The description fo that tag clearly says (in ALL CAPS) that the tag is pending removal and should not be used, and explains what should be used instead. Please read the description of tags before using them to make sure they&#39;re appropriate for your question. Thanks."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10852207"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1546398681, "post_id": 54000531, "comment_id": 94838509, "body": "@KenWhite - I&#39;ve have been wondering why the access-vba, word-vba, powerpoint-vba tag descriptions never received that &#39;disclaimer&#39;?"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1546399094, "post_id": 54000531, "comment_id": 94838583, "body": "@user10852207: Don&#39;t know. You might ask at <a href=\"https://meta.stackoverflow.com\">Meta Stack Overflow</a> to see if anyone does, though. There&#39;s also a link to <a href=\"https://meta.stackoverflow.com\">Meta Stack Overflow</a> in the description of the excel-vba tag after the notice that it shouldn&#39;t be used."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10852207"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1546412692, "post_id": 54000531, "comment_id": 94841623, "body": "Nice dodge @kenwhite"}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 8525203, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-BqX-MxnTHAI/AAAAAAAAAAI/AAAAAAAAGeE/YbbeL-Ciwtw/photo.jpg?sz=128", "display_name": "Heart Aim DJ", "link": "https://stackoverflow.com/users/8525203/heart-aim-dj"}, "edited": false, "score": 0, "creation_date": 1546403415, "post_id": 54000718, "comment_id": 94839263, "body": "Thank you very much! this is that i wanted, i have a one more question, Can i filter reversed selection(invert) by modifying operator?"}, {"owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "reply_to_user": {"reputation": 89, "user_id": 8525203, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-BqX-MxnTHAI/AAAAAAAAAAI/AAAAAAAAGeE/YbbeL-Ciwtw/photo.jpg?sz=128", "display_name": "Heart Aim DJ", "link": "https://stackoverflow.com/users/8525203/heart-aim-dj"}, "edited": false, "score": 0, "creation_date": 1546403881, "post_id": 54000718, "comment_id": 94839348, "body": "@HeartAimDJ - nope.  Excluding multiple criteria is much more complex - <a href=\"https://stackoverflow.com/questions/28504517/advance-autofilter-to-exclude-certain-values?rq=1\" title=\"advance autofilter to exclude certain values\">stackoverflow.com/questions/28504517/&hellip;</a>"}, {"owner": {"reputation": 89, "user_id": 8525203, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-BqX-MxnTHAI/AAAAAAAAAAI/AAAAAAAAGeE/YbbeL-Ciwtw/photo.jpg?sz=128", "display_name": "Heart Aim DJ", "link": "https://stackoverflow.com/users/8525203/heart-aim-dj"}, "edited": false, "score": 0, "creation_date": 1546430824, "post_id": 54000718, "comment_id": 94848655, "body": "That&#39;s too bad, Thank you"}], "tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": false, "score": 1, "last_activity_date": 1546397620, "creation_date": 1546397620, "answer_id": 54000718, "question_id": 54000531, "link": "https://stackoverflow.com/questions/54000531/how-can-i-use-filter-by-multiple-data-list-in-vba/54000718#54000718", "title": "How can i use filter by multiple data (list) in VBA", "body": "<pre><code>Sub MultiSelectFilter()\n\n    Dim arr As Variant\n\n    ' Range containing values to be shown\n    arr = Range(\"C1:C3\")\n\n    ' Range to be filtered\n    Range(\"A1\").AutoFilter\n    Range(\"A1\").AutoFilter Field:=1, Criteria1:=Application.Transpose(arr), Operator:=xlFilterValues\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 8525203, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-BqX-MxnTHAI/AAAAAAAAAAI/AAAAAAAAGeE/YbbeL-Ciwtw/photo.jpg?sz=128", "display_name": "Heart Aim DJ", "link": "https://stackoverflow.com/users/8525203/heart-aim-dj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566196321, "creation_date": 1546395757, "last_edit_date": 1566196321, "question_id": 54000531, "link": "https://stackoverflow.com/questions/54000531/how-can-i-use-filter-by-multiple-data-list-in-vba", "title": "How can i use filter by multiple data (list) in VBA", "body": "<p>I want to use filter by multiple data in Excel VBA.\nat first time, \nI used 'for' and 'find' method, but it's too slow for processing.</p>\n\n<p>In case of Python, Use the 'Pandas modules'and dataframe, Like below sample\nfilter = dataframe['headername\"].isin([Listdata1, Listdata2, Listdata3..])</p>\n\n<p>but I couldn't find similar method in VBA.</p>\n\n<p>Here is My background data<a href=\"https://t1.daumcdn.net/cfile/tistory/99CADB345C2C201418\" rel=\"nofollow noreferrer\">1</a>: </p>\n\n<p><a href=\"https://t1.daumcdn.net/cfile/tistory/99CADB345C2C201418\" rel=\"nofollow noreferrer\"><img src=\"https://t1.daumcdn.net/cfile/tistory/99CADB345C2C201418\" alt=\"excel capture\"></a></p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 1, "creation_date": 1546405090, "post_id": 54000322, "comment_id": 94839606, "body": "Yes. There are filters you can apply to the dialog box if it is called using VBA. Amend your question to include the code you use to call the dialog box."}, {"owner": {"reputation": 1, "user_id": 2883524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f4c27d825921035f4034e372e3eb61d?s=128&d=identicon&r=PG&f=1", "display_name": "fairy elf", "link": "https://stackoverflow.com/users/2883524/fairy-elf"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1546478578, "post_id": 54000322, "comment_id": 94867524, "body": "I have edited my question to include the code."}], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1546479434, "creation_date": 1546479434, "answer_id": 54015318, "question_id": 54000322, "link": "https://stackoverflow.com/questions/54000322/is-there-any-method-to-check-type-of-file-before-open-it-with-wddialogfileopen/54015318#54015318", "title": "Is there any method to check type of file before open it with wdDialogFileOpen?", "body": "<p>For example:</p>\n\n<pre><code>With Dialogs(wdDialogFileOpen)\n  .Format = \"*.docx\"\n  If .Display = True Then\n    If InStrRev(.Name, \".docx\") &gt; 0 Then\n      .Execute\n    End If\n  End If\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1546481653, "creation_date": 1546481653, "answer_id": 54015510, "question_id": 54000322, "link": "https://stackoverflow.com/questions/54000322/is-there-any-method-to-check-type-of-file-before-open-it-with-wddialogfileopen/54015510#54015510", "title": "Is there any method to check type of file before open it with wdDialogFileOpen?", "body": "<p>I wouldn't use the FileOpen dialog at all. Consider a FilePicker: The user selects the file and then you decide if you want to open it. Here is some code to play with.</p>\n\n<pre><code>Private Sub TestFileOpenName()\n\n    Dim Fn As String\n    Dim Sp() As String\n\n    ' the Flt argument = 1 which results in Word documents being filtered\n    Fn = FileOpenName(\"Select a file\", 1, \"C:\\My Dopcuments\\\")\n\n    ' the Flt argument = \"Word documents|*.doc*\" which also results in\n    ' Word documents being filtered (modify filter as required)\n'    Fn = FileOpenName(\"Select a file\", \"Word documents|*.doc*\", \"D:\\My Dopcuments\\\")\n\n    ' the Flt argument = 1 or 2 which results in Word documents being filtered\n    ' but type drop-down allows changing to Excel.\n    ' Specify \"2||1\" to make Excel the default and Word the alternative\n'    Fn = FileOpenName(\"Select a file\", \"1||2\", \"C:\\My Dopcuments\\\")\n\n    If Len(Fn) Then\n        MsgBox \"The selected file is\" &amp; vbCr &amp; Fn\n        Sp = Split(Fn, \".\")\n        If InStr(1, Sp(UBound(Sp)), \"doc\", vbTextCompare) = 1 Then\n            MsgBox \"I will now open the document\"\n        Else\n            MsgBox \"Please select a Word document.\" &amp; vbCr &amp; _\n                   \"Sorry, I can't proceed.\"\n        End If\n    Else\n        MsgBox \"No file was selected\"\n    End If\nEnd Sub\n\nFunction FileOpenName(ByVal Title As String, _\n                      Optional ByVal Flt As Variant = 0, _\n                      Optional ByVal Pn As String) As String\n    ' SSY 050 ++ 14 Dec 2018\n\n    ' ==================================================\n    '   Parameters:\n    '       Title             = Form's title\n    '       Flt               = Specify filters by ID or string specs\n    '                           separated by || (= 2 x Chr(124))\n    '                           in sequence of position assignment.\n    '                           Default = no filter [=All files]\n    '       Pn                  = Initial path: [=Last used]\n    ' ==================================================\n    '   Note:   The ButtonName is \"Open\" by default. Another setting\n    '           doesn't take effect until a file has been selected.\n    ' ==================================================\n\n    Const FltDesc As Long = 0, FltExt As Long = 1\n\n    Dim Fod As FileDialog                           ' File Open Dialog\n    Dim Fts() As String                             ' all filters\n    Dim Sp() As String                              ' split filter\n    Dim i As Long\n\n    ' ==================================================\n\n    Fts = Split(Flt, \"||\")\n    ReDim Sp(3)\n    Sp(1) = \"Word documents|*.doc*\"\n    Sp(2) = \"Excel workbooks|*.xls*\"\n    Sp(3) = \"Image file|*.png, *.tif\"\n    For i = 0 To UBound(Fts)\n        If IsNumeric(Fts(i)) Then Fts(i) = Sp(Fts(i))\n    Next i\n\n    Set Fod = Application.FileDialog(msoFileDialogFilePicker)\n    With Fod\n        .Filters.Clear\n        For i = 0 To UBound(Fts)\n            If Len(Fts(i)) Then\n                Sp = Split(Fts(i), \"|\")\n                .Filters.Add Sp(FltDesc), Sp(FltExt), i + 1\n                .FilterIndex = 1\n            End If\n        Next i\n        .Title = Title\n        .AllowMultiSelect = False\n        .InitialFileName = Pn\n        If .Show Then FileOpenName = .SelectedItems(1)\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 2883524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f4c27d825921035f4034e372e3eb61d?s=128&d=identicon&r=PG&f=1", "display_name": "fairy elf", "link": "https://stackoverflow.com/users/2883524/fairy-elf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1546481653, "creation_date": 1546393132, "last_edit_date": 1546478546, "question_id": 54000322, "link": "https://stackoverflow.com/questions/54000322/is-there-any-method-to-check-type-of-file-before-open-it-with-wddialogfileopen", "title": "Is there any method to check type of file before open it with wdDialogFileOpen?", "body": "<p>I use wdDialogFileOpen to let user open file. I want to allow user to only open .docx file. Is there any method to check type of file before open it with wdDialogFileOpen (after user choose it with wdDialogFileOpen) ?\nI use following code:</p>\n\n<p>With Dialogs(wdDialogFileOpen) \n .Name = \"<em>.</em>\" \n .Show \nEnd With</p>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10852207"}, "edited": false, "score": 1, "creation_date": 1546388789, "post_id": 53999905, "comment_id": 94836949, "body": "What line generates the error and what is the value of <code>y</code> when the error occurs? Hover over y to see its value in a hot-tip bubble."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1546393927, "post_id": 53999905, "comment_id": 94837780, "body": "Is the workbook already open when this code runs?"}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 10848664, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TCUKxVBSpFk/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZvbitvWvMCwg-W-7J6vDsICyWTlQ/mo/photo.jpg?sz=128", "display_name": "Dat Nguyen", "link": "https://stackoverflow.com/users/10848664/dat-nguyen"}, "edited": false, "score": 0, "creation_date": 1546389466, "post_id": 54000013, "comment_id": 94837056, "body": "Hi, Thank you for helping me out. When I tried the code that you provided above, it gives me the same error and the debug points at the line of    With  .Worksheets(&quot;financial_report&quot;). I&#39;ll add the whole code in the comment below."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10852207"}, "reply_to_user": {"reputation": 133, "user_id": 10848664, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TCUKxVBSpFk/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZvbitvWvMCwg-W-7J6vDsICyWTlQ/mo/photo.jpg?sz=128", "display_name": "Dat Nguyen", "link": "https://stackoverflow.com/users/10848664/dat-nguyen"}, "edited": false, "score": 0, "creation_date": 1546389946, "post_id": 54000013, "comment_id": 94837115, "body": "Simply put, that XLS you opened doesn&#39;t have a worksheet named &#39;financial_report&#39;. If it looks like it does, check for leading/trailing spaces or even do a character-by-character comparison against what you typed in code."}, {"owner": {"reputation": 133, "user_id": 10848664, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TCUKxVBSpFk/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZvbitvWvMCwg-W-7J6vDsICyWTlQ/mo/photo.jpg?sz=128", "display_name": "Dat Nguyen", "link": "https://stackoverflow.com/users/10848664/dat-nguyen"}, "edited": false, "score": 0, "creation_date": 1546390091, "post_id": 54000013, "comment_id": 94837129, "body": "I did a check on it and made sure that it matched. However, it still gives me the same error. I&#39;ve posted my whole code, could you suggest how I can fix it?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10852207"}, "reply_to_user": {"reputation": 133, "user_id": 10848664, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TCUKxVBSpFk/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZvbitvWvMCwg-W-7J6vDsICyWTlQ/mo/photo.jpg?sz=128", "display_name": "Dat Nguyen", "link": "https://stackoverflow.com/users/10848664/dat-nguyen"}, "edited": false, "score": 0, "creation_date": 1546390337, "post_id": 54000013, "comment_id": 94837166, "body": "Double-click the worksheet name tab and tap ctrl+C. On a new blank XLSX worksheet, paste that into A1. Got to your code and copy <i>financial_report</i> then paste it into B1. In A2 put <code>=unicode(mid(A$1, row(1:1), 1))</code> then fill right to B2 and drag both of them down. Is there any discrepancy in the numbers?"}, {"owner": {"reputation": 133, "user_id": 10848664, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TCUKxVBSpFk/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZvbitvWvMCwg-W-7J6vDsICyWTlQ/mo/photo.jpg?sz=128", "display_name": "Dat Nguyen", "link": "https://stackoverflow.com/users/10848664/dat-nguyen"}, "edited": false, "score": 0, "creation_date": 1546390535, "post_id": 54000013, "comment_id": 94837203, "body": "actually, it says 102. Does that mean there is a difference? I also copy the name of that tab and paste it in the code, but it gives the same error"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10852207"}, "reply_to_user": {"reputation": 133, "user_id": 10848664, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TCUKxVBSpFk/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZvbitvWvMCwg-W-7J6vDsICyWTlQ/mo/photo.jpg?sz=128", "display_name": "Dat Nguyen", "link": "https://stackoverflow.com/users/10848664/dat-nguyen"}, "edited": false, "score": 0, "creation_date": 1546390891, "post_id": 54000013, "comment_id": 94837263, "body": "Drag A2:B2 down for at least 1 row for every character in &#39;financial_report&#39;. You&#39;ll get errors in both columns when the check is done. 102 is only the <i>f</i>."}, {"owner": {"reputation": 133, "user_id": 10848664, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TCUKxVBSpFk/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZvbitvWvMCwg-W-7J6vDsICyWTlQ/mo/photo.jpg?sz=128", "display_name": "Dat Nguyen", "link": "https://stackoverflow.com/users/10848664/dat-nguyen"}, "edited": false, "score": 0, "creation_date": 1546391139, "post_id": 54000013, "comment_id": 94837332, "body": "It says 105. However, I believe that the error is not the name because I wrote another code with reference to the name as well, and it seems that name was not a problem for that code. So I don&#39;t believe that it would be the case here"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10852207"}, "is_accepted": false, "score": 1, "last_activity_date": 1546388748, "creation_date": 1546388748, "answer_id": 54000013, "question_id": 53999905, "link": "https://stackoverflow.com/questions/53999905/excel-vba-error-object-variable-or-with-block-variable-not-set/54000013#54000013", "title": "Excel VBA - Error: Object Variable or With Block Variable not set", "body": "<blockquote>\n  <p><sub>The following problem actually generates a <strong>1004: Application defined or object defined</strong> error but I am posting this as a cautionary reminder about proper explicit parent references when dealing with a mix of older XLS workbooks and newer XLSX workbooks.</sub><br/><sub>You might want to run this code to see it helps identify the line number of your original error.</sub></p>\n</blockquote>\n\n<p>Your external workbook is an XLS with 65536 rows. If ThisWorkbook is an XLSX or similar newer workbook then it has 1048576 rows. The Rows.Count has no explicit parent worksheet and may be trying to look up from the 1048576th row on a worksheet that only has 65536 rows.</p>\n\n<pre><code>'at this point, y should be defined as a number greater than zero\n\nIf fso.GetExtensionName(wbFile.Name) = \"xls\" Then \n\n    with Workbooks.Open(wbFile.Path)\n        with .workSheets(\"financial_report\")\n            wsLR = .Cells(.Rows.Count, 1).End(xlUp).Row\n            ThisWorkbook.Sheets(\"sheet1\").Cells(y, 2) = .Cells(wsLR, 7).value\n        end with\n        .close savechanges:=false\n    end with\n\nend if\n</code></pre>\n\n<p>I understand that opening the external workbook should make it the ActiveWorkbook and Rows.Count should default to the maximum rows on one of the ActiveWorkbook's worksheets but leaving the Rows.Count parent implicit is a recipe for trouble.</p>\n"}, {"tags": [], "owner": {"reputation": 133, "user_id": 10848664, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TCUKxVBSpFk/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZvbitvWvMCwg-W-7J6vDsICyWTlQ/mo/photo.jpg?sz=128", "display_name": "Dat Nguyen", "link": "https://stackoverflow.com/users/10848664/dat-nguyen"}, "is_accepted": false, "score": 0, "last_activity_date": 1546389909, "creation_date": 1546389909, "answer_id": 54000094, "question_id": 53999905, "link": "https://stackoverflow.com/questions/53999905/excel-vba-error-object-variable-or-with-block-variable-not-set/54000094#54000094", "title": "Excel VBA - Error: Object Variable or With Block Variable not set", "body": "<pre><code>Sub Macro1_Query()\nDim wb As Workbook, ws As Worksheet\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet fldr = fso.GetFolder(\"C:\ny = ThisWorkbook.Sheets(\"sheet1\").Cells(Rows.Count, 1).End(xlUp).Row + 1\nFor Each wbfile In fldr.Files\nIf fso.GetExtensionName(wbfile.Name) = \"xls\" Then\nWith Workbooks.Open(wbfile.Path)\nWith .Worksheets(\"financial_report\")\nwsLR = .Cells(.Rows.Count, 1).End(xlUp).Row\n\nThisWorkbook.Sheets(\"sheet1\").Cells(y, 2) = .Cells(wsLR, 7).Value\n\nEnd With\n.Close savechanges:=False\nEnd With\n\nwb.Close\nEnd if\nNext wbfile\nEnd sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 133, "user_id": 10848664, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TCUKxVBSpFk/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZvbitvWvMCwg-W-7J6vDsICyWTlQ/mo/photo.jpg?sz=128", "display_name": "Dat Nguyen", "link": "https://stackoverflow.com/users/10848664/dat-nguyen"}, "edited": false, "score": 0, "creation_date": 1546396870, "post_id": 54000558, "comment_id": 94838231, "body": "Hi, VBasic2008, thank you so much for your help. It does the copy function. However, I want to copy the value of specific cell &quot;G2&quot; and the last cell of Column Y into the same row of the master sheet. Is there a way to edit your code so that it can do it?"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 133, "user_id": 10848664, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TCUKxVBSpFk/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZvbitvWvMCwg-W-7J6vDsICyWTlQ/mo/photo.jpg?sz=128", "display_name": "Dat Nguyen", "link": "https://stackoverflow.com/users/10848664/dat-nguyen"}, "edited": false, "score": 0, "creation_date": 1546397010, "post_id": 54000558, "comment_id": 94838245, "body": "Dat Nguyen: In what columns on the mastersheet?"}, {"owner": {"reputation": 133, "user_id": 10848664, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TCUKxVBSpFk/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZvbitvWvMCwg-W-7J6vDsICyWTlQ/mo/photo.jpg?sz=128", "display_name": "Dat Nguyen", "link": "https://stackoverflow.com/users/10848664/dat-nguyen"}, "edited": false, "score": 0, "creation_date": 1546397092, "post_id": 54000558, "comment_id": 94838255, "body": "So G2 will go to A, and the last cell of Column Y to B, and it repeats with other workbooks within the same folder"}, {"owner": {"reputation": 133, "user_id": 10848664, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TCUKxVBSpFk/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZvbitvWvMCwg-W-7J6vDsICyWTlQ/mo/photo.jpg?sz=128", "display_name": "Dat Nguyen", "link": "https://stackoverflow.com/users/10848664/dat-nguyen"}, "edited": false, "score": 0, "creation_date": 1546397850, "post_id": 54000558, "comment_id": 94838396, "body": "There is no error for the code, but now it doesn&#39;t return values. When I open the master sheet, it is a blank sheet."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 133, "user_id": 10848664, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TCUKxVBSpFk/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZvbitvWvMCwg-W-7J6vDsICyWTlQ/mo/photo.jpg?sz=128", "display_name": "Dat Nguyen", "link": "https://stackoverflow.com/users/10848664/dat-nguyen"}, "edited": false, "score": 0, "creation_date": 1546398306, "post_id": 54000558, "comment_id": 94838455, "body": "@Dat Nguyen: The code has to be in the master workbook, and it writes to &quot;Sheet1&quot; or whatever you have for cstrTarget starting from A2 if it is an empty sheet. Is it even opening files (have you changed the folder path (cStrPath))?"}, {"owner": {"reputation": 133, "user_id": 10848664, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TCUKxVBSpFk/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZvbitvWvMCwg-W-7J6vDsICyWTlQ/mo/photo.jpg?sz=128", "display_name": "Dat Nguyen", "link": "https://stackoverflow.com/users/10848664/dat-nguyen"}, "edited": false, "score": 0, "creation_date": 1546398638, "post_id": 54000558, "comment_id": 94838503, "body": "Sorry, it was my bad before for not inputing in the path. After I input in the path, and ran it in the module for the master sheet, it points out the error for the line &quot;With Workbooks.Open(objFile.Path).Worksheets(cStrSource) &quot; with the error saying: &quot;Run-time error 9    Subscript out of range&quot;"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 133, "user_id": 10848664, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TCUKxVBSpFk/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZvbitvWvMCwg-W-7J6vDsICyWTlQ/mo/photo.jpg?sz=128", "display_name": "Dat Nguyen", "link": "https://stackoverflow.com/users/10848664/dat-nguyen"}, "edited": false, "score": 0, "creation_date": 1546399171, "post_id": 54000558, "comment_id": 94838589, "body": "@Dat Nguyen: You probably don&#39;t have a sheet with the name cStrSource in the opened workbook. it is the only sentence before the code"}, {"owner": {"reputation": 133, "user_id": 10848664, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TCUKxVBSpFk/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZvbitvWvMCwg-W-7J6vDsICyWTlQ/mo/photo.jpg?sz=128", "display_name": "Dat Nguyen", "link": "https://stackoverflow.com/users/10848664/dat-nguyen"}, "edited": false, "score": 0, "creation_date": 1546399490, "post_id": 54000558, "comment_id": 94838642, "body": "I believe it does. I could take a screenshot of it. The workbook that I&#39;m currently working with has two sheets which are &quot;financial_report&quot; and &quot;Subscription_financial_report&quot;. I&#39;ll post the picture below"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 133, "user_id": 10848664, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TCUKxVBSpFk/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZvbitvWvMCwg-W-7J6vDsICyWTlQ/mo/photo.jpg?sz=128", "display_name": "Dat Nguyen", "link": "https://stackoverflow.com/users/10848664/dat-nguyen"}, "edited": false, "score": 0, "creation_date": 1546399617, "post_id": 54000558, "comment_id": 94838658, "body": "@Dat Nguyen: I don&#39;t need a picture. The code is opening each and every file in the folder, so at least one of them hasn&#39;t got the mentioned sheet in it."}, {"owner": {"reputation": 133, "user_id": 10848664, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TCUKxVBSpFk/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZvbitvWvMCwg-W-7J6vDsICyWTlQ/mo/photo.jpg?sz=128", "display_name": "Dat Nguyen", "link": "https://stackoverflow.com/users/10848664/dat-nguyen"}, "edited": false, "score": 0, "creation_date": 1546399801, "post_id": 54000558, "comment_id": 94838685, "body": "So in the folder, I place the reports with the master sheet. Report workbooks, they all have the &quot;financial_report&quot;. Master sheet doesn&#39;t. When I open each report, it asks to enable edit first before i can edit it. So does this cause the error for the code?"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 133, "user_id": 10848664, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TCUKxVBSpFk/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZvbitvWvMCwg-W-7J6vDsICyWTlQ/mo/photo.jpg?sz=128", "display_name": "Dat Nguyen", "link": "https://stackoverflow.com/users/10848664/dat-nguyen"}, "edited": false, "score": 0, "creation_date": 1546399892, "post_id": 54000558, "comment_id": 94838698, "body": "@Dat Nguyen: Probably, it works fine on my computer."}, {"owner": {"reputation": 133, "user_id": 10848664, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TCUKxVBSpFk/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZvbitvWvMCwg-W-7J6vDsICyWTlQ/mo/photo.jpg?sz=128", "display_name": "Dat Nguyen", "link": "https://stackoverflow.com/users/10848664/dat-nguyen"}, "edited": false, "score": 0, "creation_date": 1546399981, "post_id": 54000558, "comment_id": 94838715, "body": "That&#39;s the error. I&#39;ve just run it again with the master sheet outside of the folder, and it works. Thank you so much for your help, VBasic2008. I really appreciate your effort"}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 1, "last_activity_date": 1546457512, "last_edit_date": 1546457512, "creation_date": 1546395991, "answer_id": 54000558, "question_id": 53999905, "link": "https://stackoverflow.com/questions/53999905/excel-vba-error-object-variable-or-with-block-variable-not-set/54000558#54000558", "title": "Excel VBA - Error: Object Variable or With Block Variable not set", "body": "<h1>Copy Cell From Workbooks</h1>\n\n<p>Check the constants and you're ready to go. It will produce an error if a workbook hasn't got the specified worksheet (\"financial_report\").</p>\n\n<h2>The Code</h2>\n\n<pre><code>'*******************************************************************************\n' Purpose:    Copies a cell value from all workbooks in a folder to a column\n'             in this workbook.\n'*******************************************************************************\nSub CopyCellFromWorkbooks()\n\n    ' Source Folder Path\n    Const cStrPath As String = _\n        \"C:\\\"\n    ' Source Worksheet Name/Index\n    Const cStrSource As Variant = \"financial_report\"\n    Const cVntSource As Variant = 7   ' Source Column Letter/Number\n\n    ' Target Worksheet Name/Index\n    Const cStrTarget As Variant = \"Sheet1\"\n    Const cVntTarget As Variant = 1   ' Target Column Letter/Number\n\n    ' FSO Objects\n    Dim objFSO As Object, objFolder As Object, objFile As Object\n\n    Dim objTarget As Worksheet  ' Target Worksheet (ThisWorkbook)\n    Dim lngTarget As Long       ' Target Column\n    Dim lngSource As Long       ' Source Column\n\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set objFolder = objFSO.GetFolder(cStrPath)\n\n    Set objTarget = ThisWorkbook.Sheets(cStrTarget)\n\n    For Each objFile In objFolder.Files\n        If objFSO.GetExtensionName(objFile.Name) = \"xls\" Then\n            With Workbooks.Open(objFile.Path).Worksheets(cStrSource)\n                With objTarget\n                    lngTarget = _\n                            .Cells(.Rows.Count, cVntTarget).End(xlUp).Row + 1\n                End With\n                lngSource = .Cells(.Rows.Count, cVntSource).End(xlUp).Row\n                objTarget.Cells(lngTarget, cVntTarget) _\n                        = .Cells(lngSource, cVntSource).Value\n                .Parent.Close False\n            End With\n        End If\n    Next\nEnd Sub\n'*******************************************************************************\n</code></pre>\n\n<h2>EDIT:</h2>\n\n<pre><code>Sub CopyCellFromWorkbooksEDIT()\n\n    ' Source Folder Path\n    Const cStrPath As String = _\n        \"C:\\\"\n    ' Source Worksheet Name/Index\n    Const cStrSource As Variant = \"financial_report\"\n    Const cVntSource As Variant = \"Y\"   ' Source Column Letter/Number\n\n    ' Target Worksheet Name/Index\n    Const cStrTarget As Variant = \"Sheet1\"\n    Const cVntTarget As Variant = 1     ' Target Column Letter/Number\n\n    ' FSO Objects\n    Dim objFSO As Object, objFolder As Object, objFile As Object\n\n    Dim objTarget As Worksheet  ' Target Worksheet (ThisWorkbook)\n    Dim lngTarget As Long       ' Target Column\n    Dim lngSource As Long       ' Source Column\n\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set objFolder = objFSO.GetFolder(cStrPath)\n\n    Set objTarget = ThisWorkbook.Sheets(cStrTarget)\n\n    For Each objFile In objFolder.Files\n        If objFSO.GetExtensionName(objFile.Name) = \"xls\" Then\n            With Workbooks.Open(objFile.Path).Worksheets(cStrSource)\n                With objTarget\n                    lngTarget = _\n                            .Cells(.Rows.Count, cVntTarget).End(xlUp).Row + 1\n                End With\n                lngSource = .Cells(.Rows.Count, cVntSource).End(xlUp).Row\n                objTarget.Cells(lngTarget, cVntTarget) _\n                        = .Cells(2, 7).Value ' (G2)\n                objTarget.Cells(lngTarget, cVntTarget + 1) _\n                        = .Cells(lngSource, cVntSource).Value\n                .Parent.Close False\n            End With\n        End If\n    Next\nEnd Sub\n'*******************************************************************************\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 10848664, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TCUKxVBSpFk/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZvbitvWvMCwg-W-7J6vDsICyWTlQ/mo/photo.jpg?sz=128", "display_name": "Dat Nguyen", "link": "https://stackoverflow.com/users/10848664/dat-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 413, "favorite_count": 0, "accepted_answer_id": 54000558, "answer_count": 3, "score": 0, "last_activity_date": 1566196325, "creation_date": 1546387349, "last_edit_date": 1566196325, "question_id": 53999905, "link": "https://stackoverflow.com/questions/53999905/excel-vba-error-object-variable-or-with-block-variable-not-set", "title": "Excel VBA - Error: Object Variable or With Block Variable not set", "body": "<p>I want to copy the last cell of a specific column of a sheet to a mastersheet, but it gives me the error of object not defined. I'm  not sure where I got it wrong?</p>\n\n<pre><code>If fso.GetExtensionName(wbFile.Name) = \"xls\" Then \nSet wb = Workbooks.Open(wbFile.Path)\nwsLR = wb.Sheets(\"financial_report\").Cells(Rows.Count, 1).End(xlUp).Row\nThisWorkbook.Sheets(\"sheet1\").Cells(y, 2) = wb.Sheets(\"financial_report\").Cells(wsLR,7)\n</code></pre>\n"}, {"tags": ["excel", "vba", "batch-file"], "comments": [{"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1546394963, "post_id": 53999577, "comment_id": 94837960, "body": "Welcome to SO. Does <i>&quot;When I run it manually&quot;</i> means running bat file in cmd window or by double clicking  in window? May refer the <a href=\"https://stackoverflow.com/questions/39208011/can%c2%b4t-run-bat-file-under-windows-10\">link</a>"}, {"owner": {"reputation": 11, "user_id": 10855572, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212895502172229/picture?type=large", "display_name": "Erik Gutierrez", "link": "https://stackoverflow.com/users/10855572/erik-gutierrez"}, "reply_to_user": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1546525529, "post_id": 53999577, "comment_id": 94884581, "body": "Hi there, yes i am referring to double clicking on it."}], "answers": [{"tags": [], "owner": {"reputation": 17, "user_id": 10847670, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ztv60a6bHOE/AAAAAAAAAAI/AAAAAAAAAAA/WsejdS6RgsM/photo.jpg?sz=128", "display_name": "Boneman", "link": "https://stackoverflow.com/users/10847670/boneman"}, "is_accepted": false, "score": 0, "last_activity_date": 1546384799, "last_edit_date": 1546384799, "creation_date": 1546383979, "answer_id": 53999626, "question_id": 53999577, "link": "https://stackoverflow.com/questions/53999577/vba-open-batch-file-window-closes-immediately-after-executing/53999626#53999626", "title": "VBA Open batch file - window closes immediately after executing", "body": "<p>Automate? What is the frequency of batch file executions? If you need to run whenever windows starts, you can use regedit in the Run key to automatically run batch. If the frequency is hourly you can use the windows task scheduler.</p>\n"}], "owner": {"reputation": 11, "user_id": 10855572, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212895502172229/picture?type=large", "display_name": "Erik Gutierrez", "link": "https://stackoverflow.com/users/10855572/erik-gutierrez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1546386102, "creation_date": 1546383362, "last_edit_date": 1546386102, "question_id": 53999577, "link": "https://stackoverflow.com/questions/53999577/vba-open-batch-file-window-closes-immediately-after-executing", "title": "VBA Open batch file - window closes immediately after executing", "body": "<p>I am trying to automate the execution of a batch file using VBA. I tried using the code below to execute. When I run this it opens a cmd window and then immediately closes. Any suggestions? </p>\n\n<pre><code>Sub openbatchfile()\n\n    path = \"C:\\HedgeRxConnect\\CTAUpload.bat\"\n    Call shell(path, vbNormalNoFocus)\n\nEnd Sub\n</code></pre>\n\n<p>When I run it manually below is what appears on the cmd window. It opens up a proxy server authentication which requests my log in credentials. Is there anyway to automate my login details for this? </p>\n\n<pre><code>C:\\HedgeRxConnect&gt;C:\nC:\\HedgeRxConnect&gt;HRxCImport.exe  JobConfig_FixedWidthCTAImport_CTA.xml\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10852207"}, "edited": false, "score": 0, "creation_date": 1546385008, "post_id": 53999563, "comment_id": 94836397, "body": "Do you want to delete <b>any</b> worksheet that is three days old or older? Something to cover weekends and holidays?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10852207"}, "edited": false, "score": 0, "creation_date": 1546384781, "post_id": 53999635, "comment_id": 94836357, "body": "It&#39;s been there all along but commented out as an alternate method so the OP didn&#39;t try to delete the same worksheet twice."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10852207"}, "is_accepted": false, "score": 0, "last_activity_date": 1546385334, "last_edit_date": 1546385334, "creation_date": 1546384093, "answer_id": 53999635, "question_id": 53999563, "link": "https://stackoverflow.com/questions/53999563/how-do-i-delete-a-worksheet-with-vba-that-has-a-date-format/53999635#53999635", "title": "How do I delete a Worksheet with VBA that has a date format?", "body": "<p>You aren't returning a formatted string into the Sheets collection.</p>\n\n<pre><code>For Each ws In Worksheets\n    If ws.Name = Format(Date - 2, \"MM-DD-YYYY\") Then\n        Application.DisplayAlerts = False\n        Sheets(Format(Date - 2, \"MM-DD-YYYY\")).Delete   '&lt;~~ identified here\n        'alternate\n        'ws.delete\n        Application.DisplayAlerts = True\n        exit for    '&lt;~~ no point in continuing since only one worksheet could have that name\n</code></pre>\n\n<p>There is actually no point in building the worksheet name twice. If it passes the first name test then <code>ws</code> is the worksheet you want to delete.</p>\n\n<p>I started thinking about weekends and holidays that might interfere with the '3 days old' rule. This will delete any worksheet that has a name as a string date three working days old or older. </p>\n\n<pre><code>For Each ws In Worksheets\n    If cdate(ws.Name) &lt;= APPLICATION.WORKDAY(Date, -3) Then\n        Application.DisplayAlerts = False\n        ws.delete\n        Application.DisplayAlerts = True\n    end if\nNEXT WS\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 892, "user_id": 10503508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q1Afy.jpg?s=128&g=1", "display_name": "Ferdinando", "link": "https://stackoverflow.com/users/10503508/ferdinando"}, "is_accepted": false, "score": 0, "last_activity_date": 1546384604, "creation_date": 1546384604, "answer_id": 53999685, "question_id": 53999563, "link": "https://stackoverflow.com/questions/53999563/how-do-i-delete-a-worksheet-with-vba-that-has-a-date-format/53999685#53999685", "title": "How do I delete a Worksheet with VBA that has a date format?", "body": "<p>If i understood your question you can try this code:</p>\n\n<pre><code>Sub test()\nFor Each ws In Worksheets\n    If ws.Name = Format(Date - 2, \"MM-DD-YYYY\") Then\n        Application.DisplayAlerts = False\n        'control the date and delete the sheet \n        If (ws.Name = Format(Date - 2, \"MM-DD-YYYY\")) Then\n            ws.Delete\n            Application.DisplayAlerts = True\n        End If\n    End If\nNext ws\nEnd Sub\n</code></pre>\n\n<p>ex. if today is 01-02-2019 the macro delete the sheet with the date 12-31-2018 (MM-DD-YYYY). If you want delete the sheet 3 days old then you have to change value 2 in 3(within macro).</p>\n\n<p>Hope this helps!</p>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1546389666, "creation_date": 1546389666, "answer_id": 54000075, "question_id": 53999563, "link": "https://stackoverflow.com/questions/53999563/how-do-i-delete-a-worksheet-with-vba-that-has-a-date-format/54000075#54000075", "title": "How do I delete a Worksheet with VBA that has a date format?", "body": "<h1>Delete Old Sheets</h1>\n\n<ul>\n<li>This code includes the deletion of possible chart sheets.</li>\n<li>To enable deletion without confirmation you have to set\n<code>cBlnWithoutConfirmation</code> to <code>True</code>.</li>\n</ul>\n\n<h2>The Code</h2>\n\n<pre><code>'*******************************************************************************\n' Purpose:    Deletes all sheets named by a date in format MM-DD-YYYY\n'             that are at least old as specified.\n'*******************************************************************************\nSub DeleteOldSheets()\n\n    Const cIntAge As Integer = 3            ' Age of Sheet (Days)\n    Const cBlnWithoutConfirmation = False   ' Enable Delete Without Confirmation\n\n    Dim vntDate As Variant                  ' Date Array\n    Dim vntSheetDate As Date                ' Sheet Date\n    Dim i As Integer                        ' Sheets Counter\n\n    With ThisWorkbook\n        For i = 1 To .Sheets.Count\n            With .Sheets(i)\n                vntDate = Split(.Name, \"-\")\n                On Error Resume Next\n                vntSheetDate = DateSerial(vntDate(2), vntDate(0), vntDate(1))\n                If Err Then\n                    On Error GoTo 0\n                  Else\n                    If Date - vntSheetDate + 1 &gt; cIntAge Then\n                        If cBlnWithoutConfirmation Then\n                            Application.DisplayAlerts = False\n                            .Delete\n                            Application.DisplayAlerts = True\n                          Else\n                            .Delete\n                        End If\n                    End If\n                End If\n            End With\n        Next\n    End With\n\nEnd Sub\n'*******************************************************************************\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10855600, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1PMCZCdSiuI/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYaWQGqc6lYcTFK8V6YSxjA4z8zfg/mo/photo.jpg?sz=128", "display_name": "Kevin Singh", "link": "https://stackoverflow.com/users/10855600/kevin-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 216, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1566196707, "creation_date": 1546383167, "last_edit_date": 1566196707, "question_id": 53999563, "link": "https://stackoverflow.com/questions/53999563/how-do-i-delete-a-worksheet-with-vba-that-has-a-date-format", "title": "How do I delete a Worksheet with VBA that has a date format?", "body": "<p>enter code hereA worksheet will automatically be created. The worksheet will have a date that is entered 2 days from the current date. I am having trouble getting it to delete that worksheet when it becomes 3 days old. Please see my code below for what I currently have.</p>\n\n<pre><code>For Each ws In Worksheets\n    If ws.Name = Format(Date - 2, \"MM-DD-YYYY\") Then\n        Application.DisplayAlerts = False\n        Sheets(Date - 2, \"MM-DD-YYYY\").Delete\n        Application.DisplayAlerts = True\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ado", "dao"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1546385540, "post_id": 53999227, "comment_id": 94836489, "body": "<i>Some error message</i> -- please post it, even if you think it&#39;s unrelated. Also, what exactly do you mean by <i>datasheet form is binded directly to MS SQL Server using DAO</i> ?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1546387410, "post_id": 53999227, "comment_id": 94836735, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2751849/ms-access-database-check-box-list-filters-missing-on-sql-server-back-end\">MS Access Database Check Box List Filters Missing On SQL Server back end</a>"}, {"owner": {"reputation": 81, "user_id": 8689991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/427a10a85053f686ffac90e1b047de99?s=128&d=identicon&r=PG&f=1", "display_name": "Tomasz Str\u0105czek", "link": "https://stackoverflow.com/users/8689991/tomasz-str%c4%85czek"}, "edited": false, "score": 0, "creation_date": 1546523810, "post_id": 53999227, "comment_id": 94883556, "body": "I tried to do what was written in possible duplicate topic but without positive result - the message which is shown is &quot;operation is not supported for this type of object&quot; It happens when I try to filter some column (I can do it at a first time but without any result and then I cannot do anything: clear previuos filtering, new sorting, any other new filtering)"}], "owner": {"reputation": 81, "user_id": 8689991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/427a10a85053f686ffac90e1b047de99?s=128&d=identicon&r=PG&f=1", "display_name": "Tomasz Str\u0105czek", "link": "https://stackoverflow.com/users/8689991/tomasz-str%c4%85czek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1546533864, "creation_date": 1546379496, "last_edit_date": 1546533864, "question_id": 53999227, "link": "https://stackoverflow.com/questions/53999227/access-vba-columns-quick-fiter-doesnt-work-when-datasheet-form-is-bound-directl", "title": "Access VBA Columns quick fiter doesn&#39;t work when datasheet form is bound directly to MS SQLServer using DAO and ADO", "body": "<p>Columns quick filter doesn't work when datasheet form is bound directly to MS SQLServer using either DAO or ADO.</p>\n\n<p>Some error message appears but seems like not connected with the real problem...\ni.e. :</p>\n\n<ul>\n<li>\"operation is not supported for this type of object\" (DAO connection)</li>\n<li>\"cannot initiate data provider\" (ADO connection)</li>\n</ul>\n\n<p>Do you have the same problem when binding datasheet form directly to sql database using DAO or ADO?</p>\n\n<p>I tried to check also: </p>\n\n<p>File tab > Options > Current Database then scroll down to \"Filter lookup options-> ODBC Field </p>\n\n<p>but does not work</p>\n\n<p>Thank you in advance for help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 1, "creation_date": 1546378806, "post_id": 53999079, "comment_id": 94835297, "body": "Could you post an image and/or better explain what is counted and what isn&#39;t?"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1546380658, "post_id": 53999079, "comment_id": 94835637, "body": "FYI formatting as \u201ccentre across selection\u201d gives the aesthetic of merged cells without any actual merging. In which case, countif works just fine."}, {"owner": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "edited": false, "score": 0, "creation_date": 1546382212, "post_id": 53999079, "comment_id": 94835953, "body": "Please show us the formula that does not work on merged cells. BTW, why are merged cells bad?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1546391516, "post_id": 53999079, "comment_id": 94837398, "body": "Since <code>COUNTIF</code> will work on merged cells, it is hard to understand your problem. Please read the HELP topic for <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>, and edit your question to show that."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1546405488, "post_id": 53999079, "comment_id": 94839683, "body": "I usually deal with the aesthethics by controlling grid lines and cell colouring. Adjoining cells coloured white will hide grid lines between them where as cells without colour show them. You can hide all grid lines in the sheet and apply borders of the default width and colour of grid lines where you want them."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1546406164, "post_id": 53999079, "comment_id": 94839838, "body": "=COUNIF(A:A,&quot;??&quot;) will return the correct result regardless of how many of the cells in column A are merged with other columns. Bear in mind that the value of a merged range is attributed to its first cell. Therefore the count would be different if executed in column B and some of the cells were merged with column A. In short, your problem isn&#39;t well defined as well as probably unnecessary."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1546425284, "post_id": 53999079, "comment_id": 94846217, "body": "You could remove the merged cells (if merged horizontally) and replace with <code>Center Across Selection</code> in the cell formatting/alignment dialog."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1546385051, "creation_date": 1546385051, "answer_id": 53999728, "question_id": 53999079, "link": "https://stackoverflow.com/questions/53999079/doing-what-countif-does-but-including-merged-cells/53999728#53999728", "title": "Doing what COUNTIF does, but including merged cells", "body": "<p>Something like this:</p>\n\n<pre><code>Function CountMerged(rng As Range, txt As String)\n    Dim col As Collection, n As Long, c\n    Set col = FindAll(rng, txt)\n    For Each c In col\n        n = n + c.MergeArea.Count\n    Next c\n    CountMerged = n\nEnd Function\n\nPublic Function FindAll(rng As Range, val As String) As Collection\n\n    Dim rv As New Collection, f As Range\n    Dim addr As String\n\n    Debug.Print rng.Cells.Count\n\n    Set f = rng.Find(what:=val, after:=rng.Cells(rng.Cells.Count), _\n        LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows, _\n        SearchDirection:=xlNext)\n\n    If Not f Is Nothing Then addr = f.Address()\n\n    Do Until f Is Nothing\n        Debug.Print f.Address\n        rv.Add f\n        'Note: FindNext() won't work in a UDF\n        Set f = rng.Find(what:=val, after:=f)\n        If f.Address() = addr Then Exit Do\n    Loop\n\n    Set FindAll = rv\nEnd Function\n</code></pre>\n\n<p><strong>Note</strong> - merging/unmerging will not trigger a recalculation of the UDF, even if you add <code>Application.Volatile</code>  It's not clear though from your question whether you're looking for a UDF...</p>\n"}, {"tags": [], "owner": {"reputation": 26, "user_id": 10851095, "user_type": "registered", "profile_image": "https://graph.facebook.com/2596425443707254/picture?type=large", "display_name": "onorio", "link": "https://stackoverflow.com/users/10851095/onorio"}, "is_accepted": false, "score": 0, "last_activity_date": 1546422527, "last_edit_date": 1546422527, "creation_date": 1546405349, "answer_id": 54001433, "question_id": 53999079, "link": "https://stackoverflow.com/questions/53999079/doing-what-countif-does-but-including-merged-cells/54001433#54001433", "title": "Doing what COUNTIF does, but including merged cells", "body": "<p>Try this code instead:</p>\n\n<pre><code>Function dcounter(r As Range, s As String) As Integer\n  Dim c As Range\n  For Each c In r\n    If c.Value = s Then\n      dcounter = dcounter + c.MergeArea.Count\n    End If\n  Next\nEnd Function\n</code></pre>\n\n<p>Reference: <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.find#remarks\" rel=\"nofollow noreferrer\">Range.Find method - For Each...Next</a></p>\n"}], "owner": {"reputation": 1, "user_id": 10855462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2811f634302578e33d2cf0bcb587f91?s=128&d=identicon&r=PG&f=1", "display_name": "Takan", "link": "https://stackoverflow.com/users/10855462/takan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 381, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1566196703, "creation_date": 1546378180, "last_edit_date": 1566196703, "question_id": 53999079, "link": "https://stackoverflow.com/questions/53999079/doing-what-countif-does-but-including-merged-cells", "title": "Doing what COUNTIF does, but including merged cells", "body": "<p>Yes, i know, merged cells are bad, but i need them for aesthethic reasons!</p>\n\n<p>I have a bunch of cells with a label (a brief text) on them; i want to count how many times each labeled is present in a defined range. Doing this is easy with countif...but the aesthethic impact is awful. If i merge them all the appereance is good, but countif doesn't help anymore because it counts the whole cell as one.</p>\n\n<p>I've been trying to figure out how to do what i want with a vba module, but i'm too bad for that.</p>\n\n<p>This one gives me the number of cells from the first cell that has the string i search for.</p>\n\n<pre><code>Function dcounter(r As Range, s As String) As Integer\n   dcounter = 0\n   If Not r.Find(s) Is Nothing Then dcounter = r.Find(s).MergeArea.Cells.Count\nEnd Function\n</code></pre>\n\n<p>I just need to figure out how to loop this for the whole range. I've been trying to play with For Each with no success. Any suggestion? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1546374449, "post_id": 53998601, "comment_id": 94834410, "body": "Please find the time to give feedback and credit for past question you have here and got good answers, before coming up with new ones"}, {"owner": {"reputation": 87, "user_id": 10852647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725bf619f278bad05840ac7d0cb23a67?s=128&d=identicon&r=PG&f=1", "display_name": "MJ98", "link": "https://stackoverflow.com/users/10852647/mj98"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1546375246, "post_id": 53998601, "comment_id": 94834561, "body": "Hi Shai Rado, I am sorry could not up-vote your help on my previous post because I have a score of under 15 from just joining. If there is another way to give positive feedback please direct me how as I am unfamiliar with this platform. However, I did leave a comment under your post saying that it was very helpful and the code worked perfectly. Thank you very much again for your help :)"}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 10852647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725bf619f278bad05840ac7d0cb23a67?s=128&d=identicon&r=PG&f=1", "display_name": "MJ98", "link": "https://stackoverflow.com/users/10852647/mj98"}, "edited": false, "score": 0, "creation_date": 1546375335, "post_id": 53998730, "comment_id": 94834583, "body": "Thank you AJD! This is great, not only does it work but it is highly informative :) have a good day."}], "tags": [], "owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "is_accepted": true, "score": 1, "last_activity_date": 1546374670, "creation_date": 1546374670, "answer_id": 53998730, "question_id": 53998601, "link": "https://stackoverflow.com/questions/53998601/hide-sheets-based-on-cell-value-at-login/53998730#53998730", "title": "Hide sheets based on Cell Value at Login", "body": "<p>An off-topic user experience hint first. Don't enable the login button until all pre-conditions are met. In other words, elsewhere in your code you have</p>\n\n<p><code>btnLogin.Enabled = Len(Trim(txtUser.Text)) &gt; 0 And Len(Trim(txtPass.Text)) &gt; 0</code></p>\n\n<p><strong>To solve your question</strong>, you are looking to set <code>WS.Hidden=xlVeryHidden</code>. In conjunction with this, password protect the workbook <strong>and</strong> password protect the VBA IDE. Use different passwords for each.</p>\n\n<p>You can now have a macro that asks for the workbook password for normal administration, but the sensitive data sheet can only be unhidden through VBA.</p>\n\n<p>The other aspect of this is to re-protect the workbook on <code>Workbook_Open</code> (with the password of course) and set the flag <code>UserInterfaceOnly:=True</code>. Excel does not save this flag on closing so it has to be reset every time the workbook is opened. This flag means that all your macros can do their work without having to unlock sheets (except in some special circumstances).</p>\n"}], "owner": {"reputation": 87, "user_id": 10852647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725bf619f278bad05840ac7d0cb23a67?s=128&d=identicon&r=PG&f=1", "display_name": "MJ98", "link": "https://stackoverflow.com/users/10852647/mj98"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 53998730, "answer_count": 1, "score": 0, "last_activity_date": 1566196697, "creation_date": 1546373520, "last_edit_date": 1566196697, "question_id": 53998601, "link": "https://stackoverflow.com/questions/53998601/hide-sheets-based-on-cell-value-at-login", "title": "Hide sheets based on Cell Value at Login", "body": "<p>I am making a system using VBA for students to choose their classes in high school. Users are greeted by a Login Userform \"LoginForm\" for users to login. However, as their sensitive info is stored on sheets \"studentinformation\" which holds their information and \"AMchoices\" for their class choices, I don't want the students to be able to see this. </p>\n\n<p>So, the code I have written reads their user ID and password from sheet \"studentinformation\" and opens up userform \"AMForm\" if correct. I only want the Admin login to have access to these sheets and therefore I want all sheets to be hidden from the students. I have set values in column G as \"student\" for students or \"admin\" for admin. The idea is that if the cell value in column G is \"student\" the two spreadsheets will stay hidden but if it is \"admin\" then the sheets are visible etc. </p>\n\n<p>I have entered below my current login code. Thank you for your help :)</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub btnLogin_Click()\n    Dim RowNo As Long\n    Dim ID As String, PW As String\n    Dim WS As Worksheet\n    Dim aCell As Range\n\n    On Error GoTo ErrorHandler\n\n    If Len(Trim(txtUser)) = 0 Then\n        txtUser.SetFocus\n        MsgBox \"Error. UserID cannot be empty.\"\n        Exit Sub\n    End If\n\n    If Len(Trim(txtPass)) = 0 Then\n        txtPass.SetFocus\n        MsgBox \"Error. Password cannot be empty.\"\n        Exit Sub\n    End If\n    Application.ScreenUpdating = False\n\n    Set WS = Worksheets(\"StudentInformation\")\n    ID = LCase(Me.txtUser)\n\n    Set aCell = WS.Columns(1).Find(What:=ID, LookIn:=xlValues, _\n                                   LookAt:=xlWhole, _\n                                   SearchOrder:=xlByRows, _\n                                   SearchDirection:=xlNext, _\n                                   MatchCase:=False, _\n                                   SearchFormat:=False)\n\n    If Not aCell Is Nothing Then\n        RowNo = aCell.Row\n        If Me.txtPass = aCell.Offset(, 1) Then\n            MsgBox \"Login Successful.\"\n            Unload Me\n        Else\n            MsgBox \"Incorrect UserID or Password. Please try again.\", vbOKOnly\n        End If\n\n    Else\n        MsgBox \"Incorrect UserID or Password. Please try again.\", vbOKOnly\n    End If\n\n    'Opening specific Userform\n    If aCell.Offset(, 4) = \"SBUB10\" Then AMForm.Show\n    If aCell.Offset(, 4) = \"SBUB20\" Then FMForm.Show\n    If aCell.Offset(, 4) = \"SBUB30\" Then HRMForm.Show\n\nCleanExit:\n    Set WS = Nothing\n    Application.ScreenUpdating = True\n    Exit Sub\nErrorHandler:\n    MsgBox Err.Description\n    Resume CleanExit\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1546369778, "post_id": 53998097, "comment_id": 94833488, "body": "Mac OS explicitly prohibits use of any ActiveX controls as a security measure."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1546369937, "post_id": 53998097, "comment_id": 94833529, "body": "I <i>think</i> this might point you in the right direction, on how to query data from Excel for Mac <a href=\"http://www.agentjim.com/MVP/Excel/WebQueryHowTo.html\" rel=\"nofollow noreferrer\">agentjim.com/MVP/Excel/WebQueryHowTo.html</a>"}], "answers": [{"tags": [], "owner": {"reputation": 8696, "user_id": 10746224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/znUL5.jpg?s=128&g=1", "display_name": "Lord Elrond", "link": "https://stackoverflow.com/users/10746224/lord-elrond"}, "is_accepted": false, "score": 0, "last_activity_date": 1546377074, "creation_date": 1546377074, "answer_id": 53998967, "question_id": 53998097, "link": "https://stackoverflow.com/questions/53998097/imac-error-cannot-run-activex-component/53998967#53998967", "title": "iMac error: &quot;Cannot run ActiveX component&quot;", "body": "<p>try deleting: </p>\n\n<pre><code>With CreateObject(\"MSXML2.XMLHTTP\")\n.Open \"GET\", url, True\n.send\n</code></pre>\n\n<p>and replacing it with:</p>\n\n<pre><code>ActiveWorkbook.FollowHyperlink \"http://mwatch.boursakuwait.com.kw/default.aspx/AllShares\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10243257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ba5e1d11d6b95503476d38348a28f56?s=128&d=identicon&r=PG&f=1", "display_name": "nowifi6952", "link": "https://stackoverflow.com/users/10243257/nowifi6952"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 256, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1596946782, "creation_date": 1546369001, "last_edit_date": 1596946782, "question_id": 53998097, "link": "https://stackoverflow.com/questions/53998097/imac-error-cannot-run-activex-component", "title": "iMac error: &quot;Cannot run ActiveX component&quot;", "body": "<p>I recently purchased an iMac and moved my EXCEL workbook from Windows. I had this macro set up to import data from a website.</p>\n<p>It is no longer working, returning the error</p>\n<blockquote>\n<p>&quot;Cannot run ActiveX component&quot;</p>\n</blockquote>\n<p>I looked for the &quot;Import Data -&gt; From a website&quot; button on the Mac OS X version of Excel but I cannot find it. Apparently this is not possible.</p>\n<pre><code>Sub GetTeamLinks()\nDim HTMLdoc As Object, PageSource As String, url As String, i&amp;, Arr, j&amp;, Tbl\nurl = &quot;http://mwatch.boursakuwait.com.kw/default.aspx/AllShares&quot;\n\nWith CreateObject(&quot;MSXML2.XMLHTTP&quot;)\n    .Open &quot;GET&quot;, url, True\n    .send\n    \n    While .readyState &lt;&gt; 4: DoEvents: Wend 'Check for any connection errors.\n    \n    If .statusText &lt;&gt; &quot;OK&quot; Then\n        MsgBox &quot;ERROR&quot; &amp; .Status &amp; &quot; - &quot; &amp; .statusText, vbExclamation\n        Exit Sub\n    End If\n    PageSource = .responseText\nEnd With\n\nSet HTMLdoc = CreateObject(&quot;htmlfile&quot;)\nHTMLdoc.body.innerHTML = PageSource\nHTMLdoc.Close\n\nFor Each Tbl In HTMLdoc.getElementsByTagName(&quot;table&quot;)\n    If Tbl.className = &quot;gridtablethin&quot; Then\n        \n        ReDim Arr(1 To Tbl.Rows.Length, 1 To Tbl.Rows(0).Cells.Length)\n        For j = 2 To 86\n            For i = 2 To UBound(Arr, 1)\n                If UCase(Sheets(&quot;Sheet1&quot;).Cells(j, &quot;B&quot;)) = Tbl.Rows(i - 1).Cells(0).innerText Then _\n                    Sheets(&quot;Sheet1&quot;).Cells(j, &quot;F&quot;) = Tbl.Rows(i - 1).Cells(1).innerText\n            Next\n        Next\n    End If\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "vba"], "comments": [{"owner": {"reputation": 3047, "user_id": 10388629, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/My8T3.png?s=128&g=1", "display_name": "Pika the Master of the Whales", "link": "https://stackoverflow.com/users/10388629/pika-the-master-of-the-whales"}, "edited": false, "score": 0, "creation_date": 1546368811, "post_id": 53998040, "comment_id": 94833282, "body": "What about your code doesn&#39;t work?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1546368983, "post_id": 53998040, "comment_id": 94833323, "body": "The <a href=\"https://msdn.microsoft.com/en-us/windows/ms536460(v=vs.71)\" rel=\"nofollow noreferrer\"><code>Item</code> method</a> of the <a href=\"https://msdn.microsoft.com/en-us/windows/ms537434(v=vs.71)\" rel=\"nofollow noreferrer\">deprecated</a> <code>all</code> property finds elements by <code>name</code> and <code>id</code>. You are passing a collection of classes."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1546420276, "last_edit_date": 1546420276, "creation_date": 1546419945, "answer_id": 54003643, "question_id": 53998040, "link": "https://stackoverflow.com/questions/53998040/replace-three-points-by-text-value/54003643#54003643", "title": "Replace three points by text value", "body": "<p>Hard to know without knowing which index that class is at/seeing more html</p>\n\n<p>You can use css class selector e.g.</p>\n\n<pre><code>ie.document.querySelectorAll(\"div.msg-form__contenteditable.t-14.t-black--light.t-normal.flex-.grow-1\").item(0).value = \"xyz\" \n</code></pre>\n\n<p>Replace 0 with the appropriate index</p>\n\n<p>You might also try something more unique e.g. with css attribute = value selector and ends with ($) operator:</p>\n\n<pre><code>ie.document.querySelector(\"[aria-labelledby$='1146']\").value = \"xyz\"\n</code></pre>\n\n<p>Similarly, with a longer selector substring:</p>\n\n<pre><code>[aria-labelledby$='placeholder-ember1146']\n</code></pre>\n\n<p>You can also combine the above:</p>\n\n<pre><code>ie.document.querySelector(\"div.msg-form__contenteditable.t-14.t-black--light.t-normal.flex-.grow-1[aria-labelledby$='placeholder-ember1146']\").value = \"xyz\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10855084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d213e257fda87a8922264f7d7243df4?s=128&d=identicon&r=PG&f=1", "display_name": "dadav", "link": "https://stackoverflow.com/users/10855084/dadav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1546420276, "creation_date": 1546368486, "last_edit_date": 1546368693, "question_id": 53998040, "link": "https://stackoverflow.com/questions/53998040/replace-three-points-by-text-value", "title": "Replace three points by text value", "body": "<p>I want to replace three points in the code source by text value. The text value will be declared in variable. May something help me? This the source code:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;div class=\"msg-form__contenteditable t-14 t-black--light t-normal flex- \ngrow-1\" role=\"textbox\" aria-labelledby=\"msg-form__contenteditable- \nplaceholder-ember1146\" contenteditable=\"true\" aria-multiline=\"true\"&gt; \n&lt;p&gt;...&lt;/p&gt;&lt;/div&gt;\n</code></pre>\n\n<p>This is my code, it doesn't work :</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set mess = ie.Document.all.Item(\"msg-form__contenteditable t-14 t-black-- \nlight t-normal flex-grow-1\")\nmess.Value = \"Hello world !\"\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "combobox"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1546367950, "post_id": 53997746, "comment_id": 94833114, "body": "No, there is not a &#39;single bit of code&#39; that will accomplish this for all comboboxes. Each will need the event code."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1546369792, "post_id": 53997746, "comment_id": 94833491, "body": "Sorry to object but you can"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1546369813, "post_id": 53997746, "comment_id": 94833497, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/23522230/creating-a-class-to-handle-access-form-control-events\">Creating a Class to Handle Access Form Control Events</a>"}, {"owner": {"reputation": 3, "user_id": 2952866, "user_type": "registered", "profile_image": "https://graph.facebook.com/100006207341242/picture?type=large", "display_name": "Kevin Kissell", "link": "https://stackoverflow.com/users/2952866/kevin-kissell"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1546370591, "post_id": 53997746, "comment_id": 94833663, "body": "Sorry @Storax but I&#39;m not very good a VBA, I looked at the provided link but I&#39;m not entirely sure where to start."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 2952866, "user_type": "registered", "profile_image": "https://graph.facebook.com/100006207341242/picture?type=large", "display_name": "Kevin Kissell", "link": "https://stackoverflow.com/users/2952866/kevin-kissell"}, "edited": false, "score": 0, "creation_date": 1546371237, "post_id": 53998294, "comment_id": 94833777, "body": "Thank you so much! That worked beautifully and saved me a ton of time!"}, {"owner": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "edited": false, "score": 0, "creation_date": 1546376633, "post_id": 53998294, "comment_id": 94834832, "body": "@Storax; Could you please explain the purpose of the line <code>Set AddCtl = mComboBox</code> in the <code>Function AddCtl()</code> inside the Class <code>cComboBox</code>?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "edited": false, "score": 0, "creation_date": 1546414145, "post_id": 53998294, "comment_id": 94842067, "body": "@Gene: No purpose at all, I just copied and modified the code from the link above. So, it is probably better to use a Set property instead. On the other hand it does not do any real harm."}, {"owner": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "edited": false, "score": 0, "creation_date": 1546445067, "post_id": 53998294, "comment_id": 94855641, "body": "@Storax; No, not that... I just thought it is not needed at all since there is no use for the function&#39;s return anyway: it matters not if <code>AddCtl</code> is assigned or not, whatsoever."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "edited": false, "score": 0, "creation_date": 1546445719, "post_id": 53998294, "comment_id": 94855951, "body": "@Gene: Right, you could remove the line <code>Set AddCtl = mComboBox</code> completely and everything would still work."}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 0, "last_activity_date": 1546370728, "creation_date": 1546370728, "answer_id": 53998294, "question_id": 53997746, "link": "https://stackoverflow.com/questions/53997746/show-dropdown-list-when-combobox-has-focus/53998294#53998294", "title": "Show dropdown list when combobox has focus", "body": "<p>Create a class named cComboBox</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPrivate WithEvents mComboBox As Access.ComboBox\n\nPrivate Sub mComboBox_GotFocus()\n    mComboBox.Dropdown\nEnd Sub\n\nPublic Function AddCtl(nCtl As Access.ComboBox) As Access.ComboBox\n    Set mComboBox = nCtl\n    mComboBox.OnGotFocus = \"[Event Procedure]\"\n    'mComboBox.OnChange = \"[Event Procedure]\"\n    Set AddCtl = mComboBox\nEnd Function\n</code></pre>\n\n<p>and add the following code to your Form</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nDim myCBs As New Collection\n\nPrivate Sub Form_Load()\nDim myCB As cComboBox\n\nDim ctl As Access.Control\n    For Each ctl In Me.Controls\n        If TypeName(ctl) = \"ComboBox\" Then\n            Set myCB = New cComboBox\n            myCB.AddCtl ctl\n            myCBs.Add myCB\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 2952866, "user_type": "registered", "profile_image": "https://graph.facebook.com/100006207341242/picture?type=large", "display_name": "Kevin Kissell", "link": "https://stackoverflow.com/users/2952866/kevin-kissell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1243, "favorite_count": 1, "accepted_answer_id": 53998294, "answer_count": 1, "score": 0, "last_activity_date": 1574664981, "creation_date": 1546366046, "last_edit_date": 1574664981, "question_id": 53997746, "link": "https://stackoverflow.com/questions/53997746/show-dropdown-list-when-combobox-has-focus", "title": "Show dropdown list when combobox has focus", "body": "<p>Is it possible to put a single bit of code on an Access form that would automatically show the dropdown list whenever any combobox on the form has focus?</p>\n\n<p>I know I can automatically show the dropdown list whenever a combobox has focus by using the event below. But, if possible, I would prefer to not have to put that line of code on each combobox since I have so many.</p>\n\n<pre><code>Private Sub combobox_GotFocus()\n    'When the combobox receives focus\n    'display in drop down position\n    Me.combobox.Dropdown\nEnd Sub\n</code></pre>\n\n<p>My database has dozens of forms in it with dozens of comboboxes on each form.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 10842314, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v6VcDpn7jf8/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZbTbv2Q3juTmdB_zQHTeu8Mug0iw/mo/photo.jpg?sz=128", "display_name": "Itachi_Uchiha", "link": "https://stackoverflow.com/users/10842314/itachi-uchiha"}, "edited": false, "score": 0, "creation_date": 1546366088, "post_id": 53997694, "comment_id": 94832676, "body": "this newbie is much obliged, thumbs up"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10852207"}, "is_accepted": true, "score": 0, "last_activity_date": 1546365569, "creation_date": 1546365569, "answer_id": 53997694, "question_id": 53997652, "link": "https://stackoverflow.com/questions/53997652/excel-vba-sum-dynamic-range-all-sheets/53997694#53997694", "title": "Excel VBA Sum Dynamic Range All Sheets", "body": "<p>You have to identify the ranges on each worksheet as you loop through them.</p>\n\n<pre><code>Sub Sum_Dynamic_Rng()\n\n    Dim ws As Worksheet\n    Dim LastCell As Range\n\n    For Each ws In ThisWorkbook.Worksheets\n\n        Set LastCell = ws.Range(\"A3\").End(xlDown).Offset(1, 0)\n\n        LastCell = WorksheetFunction.Sum(ws.Range(ws.Range(\"A3\"), ws.Range(\"A3\").End(xlDown)))\n\n        'if you actually want a sum formula then,\n        'LastCell.FormulaR1C1 = \"=SUM(R3C:R[-1]C)\"\n\n    Next ws\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 10842314, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v6VcDpn7jf8/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZbTbv2Q3juTmdB_zQHTeu8Mug0iw/mo/photo.jpg?sz=128", "display_name": "Itachi_Uchiha", "link": "https://stackoverflow.com/users/10842314/itachi-uchiha"}, "edited": false, "score": 0, "creation_date": 1546378954, "post_id": 53998425, "comment_id": 94835327, "body": "that works great too. You guys are masters on here! The different syntax for the same problem broadens my understanding - thank you"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 19, "user_id": 10842314, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v6VcDpn7jf8/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZbTbv2Q3juTmdB_zQHTeu8Mug0iw/mo/photo.jpg?sz=128", "display_name": "Itachi_Uchiha", "link": "https://stackoverflow.com/users/10842314/itachi-uchiha"}, "edited": false, "score": 0, "creation_date": 1546379135, "post_id": 53998425, "comment_id": 94835371, "body": "@That was the primary reason. But there are With and Resize and the &#39;if range only has one cell&#39; issue i.e. the cell below is empty and finally the use of constants. Thanks for the response."}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1546373760, "last_edit_date": 1546373760, "creation_date": 1546371875, "answer_id": 53998425, "question_id": 53997652, "link": "https://stackoverflow.com/questions/53997652/excel-vba-sum-dynamic-range-all-sheets/53998425#53998425", "title": "Excel VBA Sum Dynamic Range All Sheets", "body": "<h1>Sum Up Column From Above</h1>\n\n<pre><code>'*******************************************************************************\n' Purpose:    In all worksheets starting from the specified first cell\n'             of a contiguous column range, sums up its values and returns\n'             the result a specified number of rows below.\n'*******************************************************************************\n\nSub SumUpColumnFromAbove()\n\n    Const cStrRange As String = \"A3\"  ' Cell Range Address\n    Const cLngOffset As Integer = 2   ' Result Offset (1 for first row below)\n\n    Dim i As Integer\n\n    With ThisWorkbook\n        For i = 1 To .Worksheets.Count\n            With .Worksheets(i).Range(cStrRange).Cells(1, 1)\n                ' Check if range has more than one cell (row) i.e.\n                ' the cell below is not empty.\n                If Not IsEmpty(.Offset(1, 0)) Then  ' More than one cell.\n                    .End(xlDown).Offset(cLngOffset, 0) = WorksheetFunction _\n                            .Sum(.Resize(.End(xlDown).Row - 1))\n                  Else                              ' One cell only.\n                    .Offset(cLngOffset, 0) = WorksheetFunction _\n                            .Sum(.Parent.Range(cStrRange))\n                End If\n            End With\n        Next\n    End With\n\nEnd Sub\n'*******************************************************************************\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 10842314, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v6VcDpn7jf8/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZbTbv2Q3juTmdB_zQHTeu8Mug0iw/mo/photo.jpg?sz=128", "display_name": "Itachi_Uchiha", "link": "https://stackoverflow.com/users/10842314/itachi-uchiha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 717, "favorite_count": 0, "accepted_answer_id": 53997694, "answer_count": 2, "score": 0, "last_activity_date": 1546373760, "creation_date": 1546365151, "question_id": 53997652, "link": "https://stackoverflow.com/questions/53997652/excel-vba-sum-dynamic-range-all-sheets", "title": "Excel VBA Sum Dynamic Range All Sheets", "body": "<p>In each sheet, I want to sum column A from A3 downward (there are no empty cells) and insert the sum in the first empty cell.  </p>\n\n<p>The code below works fine for sheet1, but the sum value is wrong for sheet2 onward (in sheet2 the sum of sheet1 is doubled and this same value is inserted in sheet3 onward).</p>\n\n<p>I'd be grateful if you could point out what I'm doing wrong, please?</p>\n\n<pre><code>Sub Sum_Dynamic_Rng()\n\nDim ws As Worksheet\nDim LastCell As Range\n\n    For Each ws In ThisWorkbook.Worksheets\n\n\n    Set LastCell = ws.Range(\"A3\").End(xlDown).Offset(1, 0)\n\n        LastCell.Formula = WorksheetFunction.Sum(Range(Range(\"A3\"), Range(\"A3\").End(xlDown)))\n\n    Next ws\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 133, "user_id": 8254911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43b6f71c524476c58cd2f762e4fba367?s=128&d=identicon&r=PG&f=1", "display_name": "Shimon Lebovits", "link": "https://stackoverflow.com/users/8254911/shimon-lebovits"}, "is_accepted": false, "score": 0, "last_activity_date": 1546363558, "creation_date": 1546363558, "answer_id": 53997475, "question_id": 53997389, "link": "https://stackoverflow.com/questions/53997389/how-to-call-a-macro-when-a-value-provided-by-a-dde-link-change-in-a-cell/53997475#53997475", "title": "how to call a macro when a value provided by a DDE link change in a cell", "body": "<p>change to:</p>\n\n<pre><code>ThisWorkbook.SetLinkOnData Mylink, Procedure\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10826941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91043e11bc9a72627dd26f86b8e80ae2?s=128&d=identicon&r=PG&f=1", "display_name": "Yassine", "link": "https://stackoverflow.com/users/10826941/yassine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566196679, "creation_date": 1546362728, "last_edit_date": 1566196679, "question_id": 53997389, "link": "https://stackoverflow.com/questions/53997389/how-to-call-a-macro-when-a-value-provided-by-a-dde-link-change-in-a-cell", "title": "how to call a macro when a value provided by a DDE link change in a cell", "body": "<p>I tryed this code using SetLinkOnData to call a simple macro,\"msg\" in this case, I juste want to detecte the change of the value provided by a DDE link, but I receve this error : \"compilation error, expected: end of statement\"\nIt will be nice if someone indicate me how to use SetLinkOnData correctly or a mehode to detecte the change of the value given by the DDE Link, this is my code :</p>\n\n<pre><code>Sub UpDateDDE()\n Dim Mylink As String\n Dim Procedure As String\n  Mylink = \"MT4|BID!EURJPY\"\n  Procedure = \"msg\"\n    With ThisWorkbook.SetLinkOnData Mylink Procedure\nEnd Sub\n\nSub msg()\n  MsgBox \"new value detected!\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "owner": {"reputation": 21, "user_id": 10854811, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5P0GlCxdkOc/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYY_3sNWSvH2lYsWCXheArZRgw-sg/mo/photo.jpg?sz=128", "display_name": "Katarzyna Urba\u0144ska", "link": "https://stackoverflow.com/users/10854811/katarzyna-urba%c5%84ska"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 800, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1556976148, "creation_date": 1546360706, "last_edit_date": 1556976148, "question_id": 53997150, "link": "https://stackoverflow.com/questions/53997150/clear-all-query-credentials-from-odbs-connection-when-an-excel-file-launches", "title": "Clear all query credentials from ODBS connection when an Excel file launches", "body": "<p>I am trying to clear all query credentials from my ODBS connection when an Excel file launches.</p>\n\n<p>The manual way to do this is: DATA -> GET <code>DATA -&gt; DATA SOURCE SETTINGS -&gt; CLEAR ALL PERMISSIONS.</code> </p>\n\n<p><a href=\"https://i.stack.imgur.com/IsUgj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IsUgj.png\" alt=\"enter image description here\"></a></p>\n\n<p>I tried:</p>\n\n<pre><code>Private Sub workbook_open()\n    Dim MyCon As WorkbookConnection\n    Dim ODBCMyCon As ODBCConnection\n\n    For Each MyCon In ThisWorkbook.Connections\n        Set ODBCMyCon = MyCon.ODBCConnection\n        ODBCMyCon.SavePassword = False\n    Next\n\n    For Each MyCon In ThisWorkbook.Connections\n        ODBCMyCon.connection.Refresh\n    Next\n\n    MsgBox (\"Connection credentials are cleared\")\nEnd Sub\n</code></pre>\n\n<p>How can I automatically clear permissions?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10852207"}, "edited": false, "score": 0, "creation_date": 1546340567, "post_id": 53994868, "comment_id": 94827136, "body": "If you copy that formula without absolute cell references, you end up with #REF! error because you are trying to reference a column that is left of column A. If you use absolute references then you get a circular reference because the formula contains a reference to the cell it is in. What are you actually trying to do?"}, {"owner": {"reputation": 25, "user_id": 10854048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e63e2399370d49cf04a1f8fcd8e35a1?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaCenta", "link": "https://stackoverflow.com/users/10854048/alphacenta"}, "edited": false, "score": 0, "creation_date": 1546341560, "post_id": 53994868, "comment_id": 94827338, "body": "Exactly that&#39;s what i&#39;ve got. #REF! error. So basically i want it to keep summing when i copy C1 value to A1. Again and again. Next month i will be copying the previous month&#39;s value(C1) to A1 and write another value manually to B1 so that it will sum again to C1. At the end i will be applying for a range."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10854048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e63e2399370d49cf04a1f8fcd8e35a1?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaCenta", "link": "https://stackoverflow.com/users/10854048/alphacenta"}, "edited": false, "score": 0, "creation_date": 1546343023, "post_id": 53995079, "comment_id": 94827646, "body": "That&#39;s what i need. Thank you so much !"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 25, "user_id": 10854048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e63e2399370d49cf04a1f8fcd8e35a1?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaCenta", "link": "https://stackoverflow.com/users/10854048/alphacenta"}, "edited": false, "score": 0, "creation_date": 1546848508, "post_id": 53995079, "comment_id": 94973858, "body": "@AlphaCenta If this answered your question please mark it as solved: <a href=\"https://meta.stackexchange.com/a/5235\">Accepting Answers: How does it work?</a>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10852207"}, "is_accepted": true, "score": 1, "last_activity_date": 1546343105, "last_edit_date": 1546343105, "creation_date": 1546342356, "answer_id": 53995079, "question_id": 53994868, "link": "https://stackoverflow.com/questions/53994868/applying-a-macro-with-keeping-formulas/53995079#53995079", "title": "Applying a Macro with Keeping Formulas", "body": "<p>If you copy that formula without absolute cell references, you end up with #REF! error because you are trying to reference a column that is left of column A. If you use absolute references then you get a circular reference because the formula contains a reference to the cell it is in.</p>\n\n<p>You need to copy the value returned from the formula and add it to the target, not the formula itself. In this way, the value from the formula in column C will reflect a growing sum.</p>\n\n<pre><code>Sub sumfunc()\n\n    Worksheets(\"Sheet1\").Range(\"C1:C3\").Formula = \"=A1+B1\"\n\nEnd Sub\n\nSub copyfunc()\n\n    with Worksheets(\"Sheet1\")\n        .Range(\"C1:C3\").Copy\n        .Range(\"A1\").pastespecial paste:=xlpastevalues, operation:=xladd\n    end with\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10854048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e63e2399370d49cf04a1f8fcd8e35a1?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaCenta", "link": "https://stackoverflow.com/users/10854048/alphacenta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 53995079, "answer_count": 1, "score": 1, "last_activity_date": 1546848455, "creation_date": 1546340112, "last_edit_date": 1546848455, "question_id": 53994868, "link": "https://stackoverflow.com/questions/53994868/applying-a-macro-with-keeping-formulas", "title": "Applying a Macro with Keeping Formulas", "body": "<p>I want to keep my existing formula after I copy a different value to the related cell. </p>\n\n<p>I am beginner of Excel VBA and there is a problem that I need to solve. I have value of previous period cumulative total at cell A1. Cell B1 is the value of this month. Lastly C1, it sums the previous period and this month and gives the cumulative total value. </p>\n\n<p>So I've already written a macro for this but next month I need to copy the value at C1 and paste it to A1 so it will automatically sum a1+b1 again and write to c1. However when I apply the macro for copying the value it destroys the sum formula.  </p>\n\n<pre><code>Sub sumfunc()\n    Range(\"C1\").Formula = \"=A1+B1\"\n    Range(\"C1:C3\").FillDown\nEnd Sub\n\nSub copyfunc()\n    Worksheets(\"Sheet1\").Range(\"C1:C3\").Copy _\n    Destination:=Worksheets(\"Sheet1\").Range(\"A1\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 10852647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725bf619f278bad05840ac7d0cb23a67?s=128&d=identicon&r=PG&f=1", "display_name": "MJ98", "link": "https://stackoverflow.com/users/10852647/mj98"}, "edited": false, "score": 0, "creation_date": 1546427427, "post_id": 53999718, "comment_id": 94847183, "body": "Jane, thank you very much for your help. This worked well :)"}], "tags": [], "owner": {"reputation": 8696, "user_id": 10746224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/znUL5.jpg?s=128&g=1", "display_name": "Lord Elrond", "link": "https://stackoverflow.com/users/10746224/lord-elrond"}, "is_accepted": true, "score": 1, "last_activity_date": 1546384987, "creation_date": 1546384987, "answer_id": 53999718, "question_id": 53994740, "link": "https://stackoverflow.com/questions/53994740/copying-cell-values-from-one-sheet-onto-another-when-logging-on/53999718#53999718", "title": "Copying cell values from one sheet onto another when logging on", "body": "<p>I know basically nothing about user forms, but assuming you have that part figured out I think the following code should do what you need.</p>\n\n<pre><code>Dim xrow As long, ID as long\nDim ws1 As Worksheet, ws2 As Worksheet\nDim arrStudent() as Variant\nSet ws1 = Worksheets(\"StudentInformation\")\nSet ws2 = Worksheets(\"AMChoices\")\nxrow = 1\n\n'once student logs in\n\n'your code to set ID equal to the studentID used to login\n xrow = xrow + 1\n'Run the code above each time a student logs in. \n'This is to keep the data on AMChoices from overlapping.\n\nApplication.ScreenUpdating = false\nws1.Activate\n\nfor x = 1 To ws1.Cells(ws1.Rows.Count, \"A\").End(xlUp).Row\n    if ID = Cells(x, 1).value Then\n        ws1.Cells(x, 1).value = arrStudent[0]\n        ws1.Cells(x, 2).value = arrStudent[1]\n        ws1.Cells(x, 3).value = arrStudent[2]\n        ws1.Cells(x, 4).value = arrStudent[3]\n       'ws1.Cells(x, n).value = arrStudent[n-1]\n\n       'do this n times for each column of info you want to copy\n    else:\n    end if\nnext x  \n\nws2.activate\nfor xcol = 1 to n\nws2.Cells(xrow, xcol).value = arrStudent[xcol - 1]\nnext xcol   \n\nApplication.ScreenUpdating = true   \n</code></pre>\n\n<p>Also this is untested so there might be bugs.</p>\n"}], "owner": {"reputation": 87, "user_id": 10852647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725bf619f278bad05840ac7d0cb23a67?s=128&d=identicon&r=PG&f=1", "display_name": "MJ98", "link": "https://stackoverflow.com/users/10852647/mj98"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 53999718, "answer_count": 1, "score": 1, "last_activity_date": 1546699521, "creation_date": 1546338694, "last_edit_date": 1546699521, "question_id": 53994740, "link": "https://stackoverflow.com/questions/53994740/copying-cell-values-from-one-sheet-onto-another-when-logging-on", "title": "Copying cell values from one sheet onto another when logging on", "body": "<p>I have a userform 'AMForm' for students to choose their classes in university.</p>\n\n<p>There are adjacent option buttons for each class so they can select 'yes' or 'no' if they want to enroll in the class e.g. \"Mechanical engineering\" with 'yes' or 'no' option buttons next to it.</p>\n\n<p>Once they submit their form it records their choices on the spreadsheet 'AMChoices'. This spreadsheet has each class in the above headings, so it fills the cell with 'x' if it has been selected or '-' if not e.g. if 'Mechanical Engineering' option button is selected it fills 'x' underneath this cell. </p>\n\n<p>Each student logs in via a userform \"Login Form\". I want to automatically fill their User ID, first and last name onto the \"AMchoice sheet\" that has their choices when they log on. Their information is held in sheet \"studentinformation\".</p>\n\n<p>How can I code that when they log on, this info (first 3 columns) is extracted from the \"studentinformation\" sheet and copied into the first 3 columns of \"AMChoice\" sheet? </p>\n\n<p>I am doing this for multiple users so when the next user logs their choices, I want the next user's information/choices to be filled into the next empty row. I assume I would have to use some sort of HLookup/Vlookup function but I'm not sure?</p>\n\n<p>My login code. </p>\n\n<pre><code>Option Explicit\nPrivate Sub btnLogin_Click()\n\nDim RowNo As Long\nDim ID As String, PW As String\nDim WS As Worksheet\nDim aCell As Range\n\nOn Error GoTo ErrorHandler\n\n'Ensure User ID and password fields are filled\nIf Len(Trim(txtUser)) = 0 Then\n    txtUser.SetFocus\n    MsgBox \"Error. UserID cannot be empty.\"\n    Exit Sub\nEnd If\n\nIf Len(Trim(txtPass)) = 0 Then\n    txtPass.SetFocus\n    MsgBox \"Error. Password cannot be empty.\"\n    Exit Sub\nEnd If\n\n'Set Range Location\nApplication.ScreenUpdating = False\n\nSet WS = Worksheets(\"StudentInformation\")\nID = LCase(Me.txtUser)\n\nSet aCell = WS.Columns(1).Find(What:=ID, LookIn:=xlValues, _\nLookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\nMatchCase:=False, SearchFormat:=False)\n\n'If match found\n    If Not aCell Is Nothing Then\n        RowNo = aCell.Row\n        If Me.txtPass = aCell.Offset(, 1) Then\n            MsgBox \"Login Successful.\"\n            AMForm.Show\n            Unload Me\n        Else\n            MsgBox \"Incorrect UserID or Password. Please try again.\", vbOKOnly\n        End If\n 'If not found\n    Else\n        MsgBox \"Incorrect UserID or Password. Please try again.\", vbOKOnly\n    End If\n\nCleanExit:\n    Set WS = Nothing\n    Application.ScreenUpdating = True\n    Exit Sub\nErrorHandler:\n    MsgBox Err.Description\n    Resume CleanExit\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1402, "user_id": 2265497, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/FbWEX.png?s=128&g=1", "display_name": "slesh", "link": "https://stackoverflow.com/users/2265497/slesh"}, "edited": false, "score": 1, "creation_date": 1546333847, "post_id": 53994226, "comment_id": 94826017, "body": "What&#39;s a problem exactly, what don&#39;t work?"}, {"owner": {"reputation": 1, "user_id": 10853890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbac4d56e8f449364f1c5ef7711a3964?s=128&d=identicon&r=PG&f=1", "display_name": "Noob_247", "link": "https://stackoverflow.com/users/10853890/noob-247"}, "reply_to_user": {"reputation": 1402, "user_id": 2265497, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/FbWEX.png?s=128&g=1", "display_name": "slesh", "link": "https://stackoverflow.com/users/2265497/slesh"}, "edited": false, "score": 0, "creation_date": 1546334161, "post_id": 53994226, "comment_id": 94826069, "body": "i have data as follows 8856 8867 8876 8856 8898 and i want to compare the data with each other if they are same then run a if loop"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1546377431, "post_id": 53994226, "comment_id": 94835019, "body": "what are you planning to do with the duplicate?"}], "answers": [{"tags": [], "owner": {"reputation": 1402, "user_id": 2265497, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/FbWEX.png?s=128&g=1", "display_name": "slesh", "link": "https://stackoverflow.com/users/2265497/slesh"}, "is_accepted": false, "score": 0, "last_activity_date": 1546335248, "creation_date": 1546335248, "answer_id": 53994383, "question_id": 53994226, "link": "https://stackoverflow.com/questions/53994226/compare-value-of-cells-of-a-column-in-vba/53994383#53994383", "title": "Compare value of cells of a column in VBA", "body": "<p>Just assumption, I see that <code>C2TotalRows=C2TotalRows = Application.CountA(Range(\"A:A\"))</code>, which is equal to 1, because of range \"A:A\". So, <code>For C2row = 2 To C2TotalRows</code> this loop will never run. Try specify another cells range.</p>\n"}, {"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 0, "last_activity_date": 1546337353, "creation_date": 1546337353, "answer_id": 53994599, "question_id": 53994226, "link": "https://stackoverflow.com/questions/53994226/compare-value-of-cells-of-a-column-in-vba/53994599#53994599", "title": "Compare value of cells of a column in VBA", "body": "<p>It seems that you would like to know how often a CustID (like 8856) occurs in the data and at which row number. \nI created a simple <a href=\"https://excelmacromastery.com/vba-class-modules/\" rel=\"nofollow noreferrer\">class</a> cInfo for that and then I put the information together in a <a href=\"https://excelmacromastery.com/vba-dictionary/\" rel=\"nofollow noreferrer\">dictionary</a>. At the end I just printed the information but you could add the code you would like to run</p>\n\n<p>Here is the class cInfo</p>\n\n<pre><code>Option Explicit\n\nPublic rowNr As String\nPublic ocur As Long\n</code></pre>\n\n<p>And that's the code to collect the information</p>\n\n<pre><code>Sub UniqueValues()\nDim dict As Scripting.Dictionary\nDim rg As Range, sngCell As Range\nDim i As Long\nDim lRow As Long\nDim cellInfo As cInfo\n\n    lRow = Range(\"A1\").End(xlDown).Row      'Assumption now free rows and at least on entry in row 2\n    Set rg = Range(\"A2:A\" &amp; lRow)\n    Set dict = New Dictionary\n\n    For Each sngCell In rg\n        If dict.Exists(sngCell.Value) Then\n            dict.Item(sngCell.Value).ocur = dict.Item(sngCell.Value).ocur + 1\n            dict.Item(sngCell.Value).rowNr = dict.Item(sngCell.Value).rowNr &amp; \";\" &amp; CStr(sngCell.Row)\n        Else\n            Set cellInfo = New cInfo\n            cellInfo.rowNr = CStr(sngCell.Row)\n            cellInfo.ocur = 1\n            dict.Add sngCell.Value, cellInfo\n        End If\n    Next\n\n    ' Do sth here. I will print some info\n    For i = 0 To dict.Count - 1\n        Debug.Print \"CustID:\", dict.Keys(i), dict.Items(i).ocur, \"occurence(s) in rows\", dict.Items(i).rowNr\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>This worked fine with the example data you provided</p>\n\n<p><a href=\"https://i.stack.imgur.com/1mGk8.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1mGk8.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Output </p>\n\n<p><a href=\"https://i.stack.imgur.com/F7QEn.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F7QEn.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 26, "user_id": 10851095, "user_type": "registered", "profile_image": "https://graph.facebook.com/2596425443707254/picture?type=large", "display_name": "onorio", "link": "https://stackoverflow.com/users/10851095/onorio"}, "is_accepted": false, "score": 0, "last_activity_date": 1546408016, "creation_date": 1546408016, "answer_id": 54001781, "question_id": 53994226, "link": "https://stackoverflow.com/questions/53994226/compare-value-of-cells-of-a-column-in-vba/54001781#54001781", "title": "Compare value of cells of a column in VBA", "body": "<p>Try this modified your code:</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n  Dim sht1 As Worksheet\n  Dim C1row As Long\n  Dim CustID As String\n  Dim R As Range\n\n  Set sht1 = Worksheets(\"Report\")\n  sht1.Activate\n  C1row = 2\n\n  Do While sht1.Cells(C1row, 3).Value &lt;&gt; \"\"\n    CustID = sht1.Cells(C1row, 3).Value\n    Set R = sht1.Range(\"C:C\").Find(CustID, sht1.Cells(C1row, 3))\n    If R.Row &gt; C1row Then\n      MsgBox CustID\n    End If\n    C1row = C1row + 1\n  Loop\nEnd Sub\n</code></pre>\n\n<p>Good luck and thank you.</p>\n\n<p>Reference: <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.find\" rel=\"nofollow noreferrer\">Range.Find method (Excel)</a></p>\n"}], "owner": {"reputation": 1, "user_id": 10853890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbac4d56e8f449364f1c5ef7711a3964?s=128&d=identicon&r=PG&f=1", "display_name": "Noob_247", "link": "https://stackoverflow.com/users/10853890/noob-247"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1546724263, "creation_date": 1546333499, "last_edit_date": 1546724263, "question_id": 53994226, "link": "https://stackoverflow.com/questions/53994226/compare-value-of-cells-of-a-column-in-vba", "title": "Compare value of cells of a column in VBA", "body": "<p>I have data in a column as follows:</p>\n\n<p>8856<br>\n8867<br>\n8876<br>\n8856<br>\n8898<br></p>\n\n<p>My objective is to compare each cell of the column and if the values are the same to execute an if statement.</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\nDim sht1 As Worksheet\nDim sht2 As Worksheet\nDim C1row As Long\nDim C2row As Long\nDim C2TotalRows As Long\nDim CustID As String\n\nSet sht1 = Worksheets(\"Report\")\n\nsht1.Activate\nC2TotalRows = Application.CountA(Range(\"A:A\"))\nC1row = 2\n\nDo While sht1.Cells(C1row, 3).Value &lt;&gt; \"\"\n\n    CustID = sht1.Cells(C1row, 3).Value\n\n    For C2row = 2 To C2TotalRows\n\n        If CustID = Cells(C2row, 3).Value Then\n            MsgBox CustID\n            Exit For\n        End If\n\n    Next\n    C1row = C1row + 1\n\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "find"], "comments": [{"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 1, "creation_date": 1546354445, "post_id": 53993748, "comment_id": 94830133, "body": "It is a more complicated matter, but I understand it now. I will be working on a solution."}], "answers": [{"comments": [{"owner": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "edited": false, "score": 0, "creation_date": 1546343222, "post_id": 53993973, "comment_id": 94827677, "body": "if word &#39;Iraq&#39; is searched and <code>sheet4</code> contains &#39;commercial bank of Iraq&#39; then it will not return the value. Please read my question you will understand what I am trying to say.and there is nothing searched before &#39;Iraq&#39; to adopt changes"}, {"owner": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "edited": false, "score": 0, "creation_date": 1546426661, "post_id": 53993973, "comment_id": 94846843, "body": "I replace your <code>Find</code> method and vba says &#39;&#39;method of data member not found&#39;&#39; at <code>Application.Match</code> ??"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 3, "last_activity_date": 1546358202, "last_edit_date": 1546358202, "creation_date": 1546330254, "answer_id": 53993973, "question_id": 53993748, "link": "https://stackoverflow.com/questions/53993748/find-only-whole-word-not-the-part-of-a-word-from-excel-workbook/53993973#53993973", "title": "Find only whole word, not the part of a word from Excel Workbook", "body": "<p>loop thorugh all found occurrences till you meet the one with the keyword as a <em>single word</em>:</p>\n\n<p>here is the relevant snippet:</p>\n\n<pre><code>    With xlbook.Worksheets(\"Sheet4\").Range(\"A:B\")\n        Set RANG = .Find(what:=SWORD, lookat:=xlPart, LookIn:=xlValues)\n        If Not RANG Is Nothing Then\n            Dim firstAddress As String\n            firstAddress = RANG.Address\n            Do\n                If Not IsError(Application.Match(SWORD, Split(RANG, \" \"), 0)) Then\n                    MsgBox \"found \" &amp; SWORD &amp; \" in \" &amp; RANG.Address\n\n                    ' do what you need with RANG object\n\n\n                    Exit Do\n                End If\n                Set RANG = .FindNext(RANG)\n            Loop While RANG.Address &lt;&gt; firstAddress\n        End If\n    End With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1546361179, "last_edit_date": 1546361179, "creation_date": 1546360390, "answer_id": 53997108, "question_id": 53993748, "link": "https://stackoverflow.com/questions/53993748/find-only-whole-word-not-the-part-of-a-word-from-excel-workbook/53997108#53997108", "title": "Find only whole word, not the part of a word from Excel Workbook", "body": "<h1>Find Whole Word in Cells of a Range</h1>\n\n<p>The search (<code>Find</code>) is done by rows i.e. A1, B1, A2, B2 , A3, B3... If you want it done by column, change <code>xlByRows</code> to <code>xlByColumns</code> (A1, A2, A3 ... B1, B2, B3...).</p>\n\n<p>The <code>FindWord</code> subroutine searches each found cell containing the word (<code>SWORD</code>) for an occurrence of the whole word (<code>SWORD</code>).</p>\n\n<h2>The Code</h2>\n\n<pre><code>Sub Birthyard()\n\n    Dim xlapp As Object\n    Dim xlbook As Object\n    Dim xlsheet As Object\n    Dim SWORD As Range\n\n    Dim vntRng As Variant\n    Dim intCount As Integer\n    Dim blnFound As Boolean\n    Dim strFirst As String\n\n    Set SWORD = Selection.Paragraphs(1).Range\n    SWORD.MoveEnd wdCharacter, -1\n\n    On Error Resume Next\n    Set xlapp = GetObject(, \"Excel.Application\")\n\n    If Err Then\n        bstartApp = True\n        Set xlapp = CreateObject(\"Excel.Application\")\n    End If\n\n    On Error GoTo 0\n\n    With xlapp\n\n        Set xlbook = .Workbooks.Open(\"C:\\users\\ibnea\\Desktop\\list.xlsm\")\n\n        With xlbook.Worksheets(\"Sheet4\").Range(\"A:B\")\n            Set RANG = .Find(SWORD, .Cells(.Rows.Count, .Columns.Count), _\n                    xlValues, xlPart, xlByRows)\n            If Not RANG Is Nothing Then\n                GoSub FindWord\n                If blnFound = False Then\n                    strFirst = RANG.Address\n                    Do\n                        Set RANG = .FindNext(RANG)\n                        Debug.Print RANG.Address\n                        GoSub FindWord\n                    Loop While Not blnFound = True And RANG.Address &lt;&gt; strFirst\n                End If\n            End If\n            If blnFound Then\n                If RANG.Column = \"2\" Then\n                COMPANY = RANG.Offset(0, -1).Value\n                TICKER = RANG.Value\n                MsgBox COMPANY &amp; TICKER\n                Else\n                COMPANY = RANG.Value\n                TICKER = RANG.Offset(0, 1).Value\n                MsgBox COMPANY &amp; TICKER\n                End If\n              Else\n                MsgBox \"Nothing Found in Sheet4 Range(A:B)\"\n            End If\n        End With\n\n        If bstartApp = True Then\n            .Quit\n        End If\n\n    End With\n\n    Set xlapp = Nothing\n    Set xlbook = Nothing\n    Set xlsheet = Nothing\n\nExit Sub\n\nFindWord:\n    vntRng = Split(RANG.Value)\n    For intCount = 0 To UBound(vntRng)\n        If vntRng(intCount) = SWORD Then Exit For\n    Next\n    If intCount &lt;= UBound(vntRng) Then\n        blnFound = True\n    End If\n    Return\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 53993973, "answer_count": 2, "score": 0, "last_activity_date": 1558211178, "creation_date": 1546327443, "last_edit_date": 1558211178, "question_id": 53993748, "link": "https://stackoverflow.com/questions/53993748/find-only-whole-word-not-the-part-of-a-word-from-excel-workbook", "title": "Find only whole word, not the part of a word from Excel Workbook", "body": "<p>I am working from MS Word to extract data from an Excel Workbook:</p>\n\n<pre><code>Sub Birthyard()\nDim xlapp As Object\nDim xlbook As Object\nDim xlsheet As Object\nDim SWORD As Range\n\nSet SWORD = Selection.Paragraphs(1).Range\nSWORD.MoveEnd wdCharacter, -1\n\nOn Error Resume Next\nSet xlapp = GetObject(, \"Excel.Application\")\n\nIf Err Then\n    bstartApp = True\n    Set xlapp = CreateObject(\"Excel.Application\")\nEnd If\n\nOn Error GoTo 0\n\nWith xlapp\n    Set xlbook = .Workbooks.Open(\"C:\\users\\ibnea\\Desktop\\list.xlsm\")\n    Set RANG = xlbook.Worksheets(\"Sheet4\").Range(\"A:B\").Find(SWORD)\n\n    If RANG Is Nothing Then\n        MsgBox \"Nothing Found in Sheet4 Range(A:B)\"\n    Else\n        If RANG.Column = \"2\" Then\n        COMPANY = RANG.Offset(0, -1).Value\n        TICKER = RANG.Value\n        MsgBox COMPANY &amp; TICKER\n        Else\n        COMPANY = RANG.Value\n        TICKER = RANG.Offset(0, 1).Value\n        MsgBox COMPANY &amp; TICKER\n        End If\n    End If\n\nEnd With\n\nIf bstartApp = True Then\n    xlapp.Quit\nEnd If\n\nSet xlapp = Nothing\nSet xlbook = Nothing\nSet xlsheet = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Above code opens an Excel Workbook and finds a given word from the first two columns. The problem lies when text found is part of a word.</p>\n\n<p>For example, if the search word/criteria contains a small string such as  \"be\"   or  \"sp\"  then I get several of false results. I need the function to stop looking within the words and look at the word as a whole for a match. </p>\n\n<p>I found that it will be done by adding a trim Function, and regex is a thing that does the job. I don't know how to handle these functions.</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 10527695, "user_type": "registered", "profile_image": "https://graph.facebook.com/605974162888335/picture?type=large", "display_name": "Martin Brandel", "link": "https://stackoverflow.com/users/10527695/martin-brandel"}, "edited": false, "score": 0, "creation_date": 1546320093, "post_id": 53993125, "comment_id": 94824077, "body": "Great, that solves that line, but now the second line is Syntax error (missing operator) in query expression &#39;Code = 001B5&#39;. Do you know why I could be getting that?"}, {"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "reply_to_user": {"reputation": 43, "user_id": 10527695, "user_type": "registered", "profile_image": "https://graph.facebook.com/605974162888335/picture?type=large", "display_name": "Martin Brandel", "link": "https://stackoverflow.com/users/10527695/martin-brandel"}, "edited": false, "score": 0, "creation_date": 1546320175, "post_id": 53993125, "comment_id": 94824091, "body": "Yes, make sure you surround it by single quotes. It should appear as  <code>Code =&#39;001B5&#39;</code>  See the code above"}], "tags": [], "owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "is_accepted": true, "score": 1, "last_activity_date": 1546319622, "last_edit_date": 1546319622, "creation_date": 1546319246, "answer_id": 53993125, "question_id": 53993013, "link": "https://stackoverflow.com/questions/53993013/type-mismatch-on-set-var-me-textbox-value/53993125#53993125", "title": "Type Mismatch on Set Var = Me.TextBox.Value?", "body": "<p>No need to <code>Set</code> as CodeValue is a string. If Code field is text then should be surrounded by single quotes. Try below</p>\n\n<pre><code>Code_in = Nz(Me.CodeValue.Value, \"\")\nCurrentDb.Execute \"Update STOCK SET PrintQ = 1 WHERE Code='\" &amp; Code_in &amp; \"';\"\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10527695, "user_type": "registered", "profile_image": "https://graph.facebook.com/605974162888335/picture?type=large", "display_name": "Martin Brandel", "link": "https://stackoverflow.com/users/10527695/martin-brandel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 53993125, "answer_count": 1, "score": 0, "last_activity_date": 1546319622, "creation_date": 1546317057, "last_edit_date": 1546319258, "question_id": 53993013, "link": "https://stackoverflow.com/questions/53993013/type-mismatch-on-set-var-me-textbox-value", "title": "Type Mismatch on Set Var = Me.TextBox.Value?", "body": "<p>I'm fairly new to VBA. I'm trying to create a text box where I can add in an item code and on the \"AddRecord\" button click, update a field in that code's row. </p>\n\n<p>I get a Type Miss-match error on Set Code_in = Me.CodeValue.value and I have no clue as to why and no matter how much I search I can't find any answers.\nI feel like this must be something really simple I'm missing...</p>\n\n<p>Below is the full Sub.</p>\n\n<pre><code>Private Sub AddRecord_Click()\n\n    'Sets printQ of the code writen in Code_Insert to 1\n    Set Code_in = Me.CodeValue.value\n    CurrentDb.Execute \"Update STOCK SET PrintQ = 1 WHERE Code = \" &amp; Code_in &amp; \";\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "powerpoint"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1546326507, "post_id": 53992743, "comment_id": 94824873, "body": "According to the comment in the code the Presentation is being opened <b>Read-only</b>. But then you try adding a slide to it, which can&#39;t be done with a read-only file?"}], "answers": [{"tags": [], "owner": {"reputation": 121, "user_id": 4608461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76c7a8cd4b69fa96bcd0c7627ff1f831?s=128&d=identicon&r=PG", "display_name": "Roy Brander", "link": "https://stackoverflow.com/users/4608461/roy-brander"}, "is_accepted": false, "score": 0, "last_activity_date": 1546362590, "creation_date": 1546362590, "answer_id": 53997368, "question_id": 53992743, "link": "https://stackoverflow.com/questions/53992743/run-time-error-2147188160-80048240-application-unknown-member-invalid/53997368#53997368", "title": "Run time error &#39;-2147188160 (80048240)&#39;: Application (unknown member) : Invalid request. sub or function not defined", "body": "<p>Is it possible that the previous loop is finishing, instead of doing an Exit For at a 'title and content' slide?   That would mean that the value pptCL is undefined.   However, that would be the wrong error report; that line run with pptCL undefined causes an \"invalid procedure call or argument\".</p>\n\n<p>But the odd thing is that your code died for me right on the line where the powerpoint file is opened, the line: </p>\n\n<blockquote>\n  <blockquote>\n    <p>Set pptPres = ppt.Presentations.Open(DestinationPPT, True) ' read only</p>\n  </blockquote>\n</blockquote>\n\n<p>...and it died with that exact \"automation error\".  I compared to code I have where a powerpoint file opened fine, and that code had the line:</p>\n\n<blockquote>\n  <blockquote>\n    <p>ppt.Visible = msoTrue</p>\n  </blockquote>\n</blockquote>\n\n<p>...making the powerpoint application visible, just above the \"open\" command.  When I added that line to your code, the error went away, in my run.</p>\n\n<p>This may be a complete red herring, but since it worked for me, and since you aren't getting any other answers, take a moment and try it.</p>\n"}], "owner": {"reputation": 1, "user_id": 8673270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc82bde2a547a7d3d2759fe2686ba313?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Frankel", "link": "https://stackoverflow.com/users/8673270/joe-frankel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 952, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1578150434, "creation_date": 1546310879, "last_edit_date": 1578150434, "question_id": 53992743, "link": "https://stackoverflow.com/questions/53992743/run-time-error-2147188160-80048240-application-unknown-member-invalid", "title": "Run time error &#39;-2147188160 (80048240)&#39;: Application (unknown member) : Invalid request. sub or function not defined", "body": "<p>I am getting this error while trying to run the following macro.\nThe error shows up on the first(!) time the \"AddSlide\" is executed and only then(!). The macro continues (after I click on \"End\" in the message box) and works well without any error message after that.</p>\n\n<pre><code>Sub PushChartsToPPT_1()\n\n    Dim ppt As PowerPoint.Application\n    Dim pptPres As PowerPoint.Presentation\n    Dim pptSld As PowerPoint.Slide\n    Dim pptShp As PowerPoint.Shape\n    Dim EndTime As Single\n\n    Dim rng As Range\n    Dim cht As Chart\n    Dim ws As Worksheet\n    Dim i, j As Single\n    Dim MainWorkBook, tempWorkBook As Workbook\n    Dim tempSheet As Worksheet\n    Dim pptCL As CustomLayout\n    Dim myShape As Object\n    Dim DestinationPPT, str As String\n\n\n    Set MainWorkBook = ActiveWorkbook\n\n    'Get the PowerPoint Application object:\n    Set ppt = CreateObject(\"PowerPoint.Application\")\n    DestinationPPT = \"Template.pptx\"\n    Set pptPres = ppt.Presentations.Open(DestinationPPT, True) ' read only\n\n    'Get a Custom Layout:\n    For Each pptCL In pptPres.SlideMaster.CustomLayouts\n       If pptCL.Name = \"Title and Content\" Then Exit For\n    Next pptCL\n\n    ppt.Visible = msoTrue\n\n\n    For Each ws In MainWorkBook.Worksheets\n        For i = 1 To ws.ChartObjects.Count\n            '&gt;&gt;&gt;&gt;&gt; error next line\n            Set pptSld = pptPres.Slides.AddSlide(pptPres.Slides.Count + 1, pptCL) '&gt;&gt;&gt;&gt;&gt;error on this line\n            pptSld.Select\n\n\n            Set cht = ws.ChartObjects(i).Chart\n            cht.ChartArea.Copy\n            DoEvents\n            pptSld.Shapes.PasteSpecial(DataType:=ppPasteMetafilePicture).Select\n\n        Next i\n    Next ws\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 16970, "user_id": 2079345, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/lq0tx.png?s=128&g=1", "display_name": "chiliNUT", "link": "https://stackoverflow.com/users/2079345/chilinut"}, "edited": false, "score": 0, "creation_date": 1546309114, "post_id": 53992529, "comment_id": 94823061, "body": "I have a multiparagraph footer and Selection.WholeStory selects everything for me"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10853285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z728k.jpg?s=128&g=1", "display_name": "KRS", "link": "https://stackoverflow.com/users/10853285/krs"}, "edited": false, "score": 0, "creation_date": 1548802873, "post_id": 53993718, "comment_id": 95671633, "body": "Thanks Cindy, your info on changing footers without putting the focus on the footer went a long way toward helping me get my code to work. And use of an object allowed me to more easily handle multiple changes/checks (Link to Previous, Style, and Continue page numbering)."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1546327114, "creation_date": 1546327114, "answer_id": 53993718, "question_id": 53992529, "link": "https://stackoverflow.com/questions/53992529/need-code-to-select-entire-text-of-just-the-current-page-footer/53993718#53993718", "title": "Need code to select entire text of just the current page footer", "body": "<p>The following code will change the font of the Footer for the current selection. There is no need to actually put the focus in the footer, or select the content.</p>\n\n<pre><code>Selection.Sections(1).Footers(wdHeaderFooterPrimary).Range.Font.Name = \"Footer17\"\n</code></pre>\n\n<p>To perform multiple actions on the same Footer it makes sense to have an object:</p>\n\n<pre><code>Dim ftr as Word.HeaderFooter\nSet ftr = Selection.Sections(1).Footers(wdHeaderFooterPrimary)\nftr.LinkToPrevious = False\nftr.Range.Font.Name = \"Footer17\"\n</code></pre>\n\n<p>Note that it's not possible to change the footer contents of <em>only</em> one page, unless that page is, by itself, a <code>Section</code>. Footers, by definition, extend across the entire document or, if \"Link to previous\" is not activated, across the entire section.</p>\n\n<p>Note also that this code assumes there is only the one type of Footer (no \"Different First Page\" or \"Even Page\" options activated).</p>\n"}], "owner": {"reputation": 13, "user_id": 10853285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z728k.jpg?s=128&g=1", "display_name": "KRS", "link": "https://stackoverflow.com/users/10853285/krs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 53993718, "answer_count": 1, "score": 1, "last_activity_date": 1546327114, "creation_date": 1546306581, "last_edit_date": 1546326749, "question_id": 53992529, "link": "https://stackoverflow.com/questions/53992529/need-code-to-select-entire-text-of-just-the-current-page-footer", "title": "Need code to select entire text of just the current page footer", "body": "<p>I am trying to select the entire contents of the current page footer before applying a specific style (Footer17) from the active document. Applying the Footer17 style without selecting all of the text applies the style to just the top line of the footer. The footer has three paragraph returns, but could be more than three lines depending on the document.</p>\n\n<p>I've used the following code to remove LinkToPrevious on the footer in question:</p>\n\n<pre><code>ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageFooter\nSelection.HeaderFooter.LinkToPrevious = False\n</code></pre>\n\n<p>I've tried <code>Selection.WholeStory</code>, and also have tried to set a range that includes the text of just the current footer. But I can't consistently get the entire current footer selected.</p>\n\n<p>Thanks in advance for any tips on how to do this.</p>\n"}, {"tags": ["excel", "vba", "selenium", "selenium-chromedriver"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1546302017, "post_id": 53992138, "comment_id": 94822207, "body": "I get not authorized if I try to access page. Can you use the snippet tool to include the actual HTML."}, {"owner": {"reputation": 1, "user_id": 9465327, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-QAcuKc7D3C8/AAAAAAAAAAI/AAAAAAAAAP8/_R9EJslGL7I/photo.jpg?sz=128", "display_name": "Jiyaad Naeem", "link": "https://stackoverflow.com/users/9465327/jiyaad-naeem"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1546320926, "post_id": 53992138, "comment_id": 94824193, "body": "Thank you QHarr ! Looked like all it needed was to remove a div at the end of the problem line as there were multiple instances of the bowtie on the page. Not sure why exactly that made it work, but if anyone knows, would love to better understand"}], "owner": {"reputation": 1, "user_id": 9465327, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-QAcuKc7D3C8/AAAAAAAAAAI/AAAAAAAAAP8/_R9EJslGL7I/photo.jpg?sz=128", "display_name": "Jiyaad Naeem", "link": "https://stackoverflow.com/users/9465327/jiyaad-naeem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 234, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566205003, "creation_date": 1546299245, "last_edit_date": 1566205003, "question_id": 53992138, "link": "https://stackoverflow.com/questions/53992138/runtime-error-32-when-trying-to-hover-over-one-item-to-click-a-hidden-button", "title": "Runtime error &#39;32&#39; when trying to hover over one item to click a hidden button - Seleniumbasic / VBA", "body": "<p>I'm trying to use Selenium in VBA to automatically click the expand button (bowtie) on a website - eventually to bring all that table data into excel.</p>\n\n<p>I'm able to walk through every line of code and it's behaving correctly, except for this last line, when I try to select the hidden bowtie (maximize button in picture), I receive the Run-time error '32': Application-defined or object-defined error.</p>\n\n<pre><code>bot.FindElementByClass(\"richeditor-toolbar-button workitem-group-maximize\").Click\n</code></pre>\n\n<p>I used the exact class provided when inspecting the bowtie - also tried a different class), but when I hit f8 - the session dies and the error pops up.</p>\n\n<p>Any ideas what might be causing this?</p>\n\n<pre><code>Sub automation() Dim bot As New ChromeDriver, menuitem As WebElement \nbot.Get \"https://company.visualstudio.com/\" \nSet menuitem = bot.FindElementById(\"ui-id-38\") \nbot.Actions.MoveToElement(menuitem).Perform \nbot.FindElementByClass(\"richeditor-toolbar-button workitem-group-maximize\").Click\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Fztf9.png\" rel=\"nofollow noreferrer\">screenshot of inspected bowtie element</a>\n<a href=\"https://i.stack.imgur.com/iaPgn.png\" rel=\"nofollow noreferrer\">run time error screenshot</a></p>\n\n<p>EDIT - played around a bit more and found that removing the last \"div\" from the class selector made it work. Adding screenshots of code for reference - this is an intranet site, so can't login without a company device - Screenshot 2 shows the inspected element I was trying to maximize.</p>\n\n<p>I tried this version below as there were multiple versions of the bowtie on the page for other sections, removing the last div made it work.</p>\n\n<p>This does not work because of the div at the end</p>\n\n<pre><code>bot.FindElementByCss(\"#vss_390 &gt; div.tfs-collapsible-header.wit-form-group-header &gt; button &gt;div\"\n</code></pre>\n\n<p>The below works since the div at the end was removed, though not sure why exactly</p>\n\n<pre><code>Set menuitem = bot.FindElementById(\"ui-id-38\")\nbot.Actions.MoveToElement(menuitem).Perform\nbot.FindElementByCss(\"#vss_390 &gt; div.tfs-collapsible-header.wit-form-group-header &gt; button\").Click\n</code></pre>\n\n<p>HTML Reference of page I was trying to work with <a href=\"https://i.stack.imgur.com/91uzc.png\" rel=\"nofollow noreferrer\">HTML Reference</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1546295814, "post_id": 53991881, "comment_id": 94821451, "body": "<i>&quot;However, i&#39;m unable to stop by using the below code stoprefresh&quot;</i> .. At what point do you make a call to <code>stoprefresh</code>?"}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1546295990, "post_id": 53991881, "comment_id": 94821485, "body": "By click of a button.."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1546296046, "post_id": 53991881, "comment_id": 94821488, "body": "You want to <a href=\"https://stackoverflow.com/posts/53991881/edit\">edit</a> that crucial bit of information into your question? And describe what type of button -- on a userform, ActiveX control button, etc.?"}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1546296204, "post_id": 53991881, "comment_id": 94821513, "body": "updated my question please refer! Thank you :)"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1546296385, "post_id": 53991881, "comment_id": 94821545, "body": "Are you sure it&#39;s actually &quot;running&quot;? You don&#39;t have something in your code to remove the &quot;running&quot; cell... Something like <code>ActiveSheet.Cells(ActiveSheet.Cells.Rows.Count, 1).End(xlUp).Offset(1) = &quot;Finished&quot;</code> in your <code>stoprefresh</code> code. Which personally, I&#39;d rather use <code>Application.StatusBar = &quot;Running&quot;</code> and <code>Application.StatusBar = False</code>, but that&#39;s just personal preference I suppose."}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1546298492, "post_id": 53991881, "comment_id": 94821796, "body": "Nop i dont need anything like finished. Just that timing update should be stopped.."}], "answers": [{"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 1, "last_activity_date": 1546330337, "last_edit_date": 1546330337, "creation_date": 1546328812, "answer_id": 53993852, "question_id": 53991881, "link": "https://stackoverflow.com/questions/53991881/stop-macro-from-repeating-when-using-application-ontime/53993852#53993852", "title": "Stop macro from repeating when using Application.OnTime", "body": "<p>Try this code</p>\n\n<pre><code>Option Explicit\n\nDim iTimerSet As Double\nSub RefreshData()\n    iTimerSet = Now + TimeValue(\"00:00:10\")\n    Application.OnTime iTimerSet, \"mg\", , True\nEnd Sub\nSub stoprefresh()\n    'On Error Resume Next\n    Application.OnTime iTimerSet, \"mg\", , False\nEnd Sub\n\nSub mg()\n    ActiveSheet.Cells(ActiveSheet.Cells.Rows.Count, 1).End(xlUp).Offset(1) = \"Running\"\n    Call RefreshData\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p><strong><a href=\"https://bettersolutions.com/vba/macros/application-ontime.htm\" rel=\"nofollow noreferrer\">Cancelling a scheduled Procedure</a></strong> \n  It is possible to cancel a procedure that has been scheduled to run but you need to know the\n  exact date and time it was scheduled for. To cancel a scheduled\n  procedure you must know the \"EarliestTime\" it was scheduled for.\n  Exactly the same syntax except you set the schedule paramater to\n  False. This tells the application to cancel the schedule.</p>\n</blockquote>\n"}], "owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "accepted_answer_id": 53993852, "answer_count": 1, "score": 0, "last_activity_date": 1546730666, "creation_date": 1546295468, "last_edit_date": 1546730666, "question_id": 53991881, "link": "https://stackoverflow.com/questions/53991881/stop-macro-from-repeating-when-using-application-ontime", "title": "Stop macro from repeating when using Application.OnTime", "body": "<p>By using the below code <strong>RefreshData</strong> I run <strong>mg</strong> macro every 10 secs.</p>\n\n<p>I'm unable to stop <strong>stoprefresh</strong> which is assigned to a square shape.</p>\n\n<pre><code>Sub RefreshData()\n    Application.OnTime Now + TimeValue(\"00:00:10\"), \"mg\", , True\nEnd Sub\n\nSub stoprefresh()\n    On Error Resume Next\n    Application.OnTime Now + TimeValue(\"00:00:10\"), \"mg\", , False\nEnd Sub\n\nSub mg()\n\n    ActiveSheet.Cells(ActiveSheet.Cells.Rows.Count, 1).End(xlUp).Offset(1) = \"Running\"\n\n    Call RefreshData\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1546290880, "post_id": 53991380, "comment_id": 94820618, "body": "Have you stepped though this in the debugger? What value are you getting for <code>lastColumn</code>?"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1546291603, "post_id": 53991380, "comment_id": 94820779, "body": "You have so many sheet identifiers:Sheets(1), Sheet1, Sheets(2), Sheet2, Activesheet. Who is who? Are those only 2 sheets? Does your Visual Basic recognize the french C letter? and the 3 lines starting with count = 0 are usless. Try to invent another name for count. Why are you counting backwards?"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1546292350, "post_id": 53991380, "comment_id": 94820929, "body": "The problem you are having with your loop is that you use <code>GoTo NextIteriation</code> within your <code>j</code> loop which jumps to the next <code>i</code> before your <code>j</code> loop is completed. Comment out your  <code>GoTo</code> and <code>NextIeration:</code> then see what your code does."}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 10730112, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KBDhUYjKpw0/AAAAAAAAAAI/AAAAAAAAAqk/FohA7vxM70c/photo.jpg?sz=128", "display_name": "Joel Bastien", "link": "https://stackoverflow.com/users/10730112/joel-bastien"}, "edited": false, "score": 0, "creation_date": 1546290578, "post_id": 53991415, "comment_id": 94820559, "body": "Thanks,  however, I don&#39;t want to actually exit the entire loop. I even tried it and it doesn&#39;t help as for some reason the loop goes directly from  For j = lastColumn To 6 Step (-1)  ----- To Next i --- as I&#39;ve mentioned in my question. So that doesn&#39;t seem to be the problem!"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1546290673, "post_id": 53991415, "comment_id": 94820576, "body": "Isn&#39;t that functionally identical to the OP&#39;s code? The loop counters reinitialize when they get looped over by the <code>i</code> loop."}, {"owner": {"reputation": 2524, "user_id": 2705042, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/ShRFK.jpg?s=128&g=1", "display_name": "spinjector", "link": "https://stackoverflow.com/users/2705042/spinjector"}, "edited": false, "score": 0, "creation_date": 1546291164, "post_id": 53991415, "comment_id": 94820677, "body": "So the IF statement seems to always evaluate as true..? If so, you might test it by breaking the two expressions into a nested If-Then to perhaps determine which of them is the issue. So <code>If Sheet1.Cells(i, j) &lt; Sheet2.Cells(1, 1) And Sheet1.Cells(i, j - 1) = &quot;Re&#231;u&quot; Then</code> would become <code>If Sheet1.Cells(i, j) &lt; Sheet2.Cells(1, 1) Then If Sheet1.Cells(i, j - 1) = &quot;Re&#231;u&quot; Then</code> with another <code>Endif</code> After the <code>Exit For</code>."}], "tags": [], "owner": {"reputation": 2524, "user_id": 2705042, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/ShRFK.jpg?s=128&g=1", "display_name": "spinjector", "link": "https://stackoverflow.com/users/2705042/spinjector"}, "is_accepted": false, "score": 0, "last_activity_date": 1546290355, "creation_date": 1546290355, "answer_id": 53991415, "question_id": 53991380, "link": "https://stackoverflow.com/questions/53991380/why-does-my-vba-loop-skip-to-my-outer-next-every-time/53991415#53991415", "title": "Why does my vba loop skip to my outer next every time?", "body": "<p>I don't quite follow what you're doing, but try this instead. Notice the <code>Exit For</code>. This should produce the result you're looking for, without the For-Next counter variables getting confused.</p>\n\n<pre><code>For i = 3 To lastrow\n    For j = lastColumn To 6 Step (-1)\n        If Sheet1.Cells(i, j) &lt; Sheet2.Cells(1, 1) And Sheet1.Cells(i, j - 1) = \"Re\u00e7u\" Then\n            count = count + 1\n            Exit For\n        End If\n    Next j\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 1, "creation_date": 1546293755, "post_id": 53991682, "comment_id": 94821169, "body": "I don&#39;t think the OP wants to exit the loop when the <code>If</code> statement is true. I think he is wanting to continue the <code>j</code> loop for multiple trues that can be on each row. I think the <code>Goto</code> was the OP not understanding what <code>Next j</code> does. That said; good code. +1"}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1612017305, "last_edit_date": 1612017305, "creation_date": 1546293090, "answer_id": 53991682, "question_id": 53991380, "link": "https://stackoverflow.com/questions/53991380/why-does-my-vba-loop-skip-to-my-outer-next-every-time/53991682#53991682", "title": "Why does my vba loop skip to my outer next every time?", "body": "<h1>Simplification</h1>\n<p>Use <strong>Long</strong> for rows, and <strong>Integer</strong> for columns.</p>\n<p>When you write <strong><code>With Sheet1</code></strong>, everywhere where you should write <code>Sheet1</code>, e.g. <code>Sheet1.Range(whatever)...</code> you can write just <code>.Range(whatever)</code> instead, until you close with <strong>End With</strong>.</p>\n<p>The <strong>Exit For</strong> exits only the For Loop where it is in. So it does exactly what you are doing with your <strong>Goto</strong> line, but you are using a line more.</p>\n<p>When you use Sheet1 or Sheet2 etc. you are actually using code names so you can change the names in the tab and the code will still run.</p>\n<p>Counting backwards is usually used when you delete row by row so there is no need to do so since you are only counting.</p>\n<pre><code>Option Explicit\n\nSub CheckDates()\n\n    Dim dataCount As Long\n    Dim i As Long\n    Dim j As Integer\n    Dim lastrow As Long\n\n    With Sheet1\n        \n        lastrow = .Cells(.Rows.count, &quot;B&quot;).End(xlUp).Row\n\n        'have to keep data in a table for this to actually work as it ctrls+left\n        'to the table, which will end where the very last text of any row is\n        lastColumn = .Cells(1, .Columns.count).End(xlToLeft).Column\n\n        For i = 3 To lastrow\n            For j = 6 To lastColumn\n                If .Cells(i, j) &lt; Sheet2.Cells(1, 1) And .Cells(i, j - 1) = &quot;Re\u00e7u&quot; Then\n                    dataCount = dataCount + 1\n                    Exit For\n                End If\n            Next\n        Next\n    \n    End With\n    \n    With Sheet2\n        .Cells(1, 7) = dataCount\n        .Select\n    End With\n    \n    'Runs the DeleteSAC Macro\n    DeleteSAC\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 10730112, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KBDhUYjKpw0/AAAAAAAAAAI/AAAAAAAAAqk/FohA7vxM70c/photo.jpg?sz=128", "display_name": "Joel Bastien", "link": "https://stackoverflow.com/users/10730112/joel-bastien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1612017305, "creation_date": 1546289999, "last_edit_date": 1566224439, "question_id": 53991380, "link": "https://stackoverflow.com/questions/53991380/why-does-my-vba-loop-skip-to-my-outer-next-every-time", "title": "Why does my vba loop skip to my outer next every time?", "body": "<p>So I have a double loop that for some reason always skips to my outer loop for some reason. The loop goes from:</p>\n\n<p><code>For j = lastColumn To 6 Step (-1)</code></p>\n\n<p>to: </p>\n\n<p><code>Next i</code></p>\n\n<p>every single time. However, in my data set there's a mixed variety of data which should be captured in my if statement and count the data.</p>\n\n<p>Any ideas? Maybe I formatted the macro wrongly.</p>\n\n<pre><code>Sub CheckDates()\n\n\nDim count As Integer\nDim i As Integer\nDim j As Integer\n\n\nSheets(1).Select\n\nlastrow = ActiveSheet.Cells(Rows.count, \"B\").End(xlUp).Row\n\n'have to keep data in a table for this to actually work as it ctrls+left to the table, which will end where the very last text of any row is\nlastColumn = ActiveSheet.Cells(1, Columns.count).End(xlToLeft).Column\n\n\ncount = 0\ni = 3\nj = lastColumn\n\nFor i = 3 To lastrow\n    For j = lastColumn To 6 Step (-1)\n        If Sheet1.Cells(i, j) &lt; Sheet2.Cells(1, 1) And Sheet1.Cells(i, j - 1) = \"Re\u00e7u\" Then\n        count = count + 1\n    GoTo NextIteration\n        End If\n    Next j\n    NextIteration:\nNext i\n\nSheet2.Cells(1, 7) = count\n\nSheets(2).Select\n\n\n'Runs the DeleteSAC Macro\nCall DeleteSAC\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10852207"}, "is_accepted": true, "score": 3, "last_activity_date": 1546289372, "creation_date": 1546289372, "answer_id": 53991308, "question_id": 53991234, "link": "https://stackoverflow.com/questions/53991234/is-it-possible-to-copy-paste-all-rows-with-n-a-without-filtering-columns/53991308#53991308", "title": "Is it possible to copy/paste all rows with #N/A without Filtering Columns?", "body": "<p>Use SpecialCells to find all of the errors returned from formulas.</p>\n\n<pre><code>dim lrow as long, erng as range\n\nwith workSheets(\"Fall 2016\")\n\n    lrow = 'get lrow here\n\n    on error resume next\n    set erng = .range(\"A2:CU\" &amp; lrow).specialcells(xlCellTypeFormulas, xlErrors)\n    on error goto 0\n\n    if not erng is nothing then\n        intersect(.range(\"A:CU\"), erng.entirerow).copy\n        workSheets(\"Sheet1\").Range(\"A3\").PasteSpecial Paste:=xlPasteValues\n    end if\n\n\nend with\n</code></pre>\n"}], "owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 53991308, "answer_count": 1, "score": 0, "last_activity_date": 1546289372, "creation_date": 1546288571, "last_edit_date": 1546289360, "question_id": 53991234, "link": "https://stackoverflow.com/questions/53991234/is-it-possible-to-copy-paste-all-rows-with-n-a-without-filtering-columns", "title": "Is it possible to copy/paste all rows with #N/A without Filtering Columns?", "body": "<p>I'm curious if it's possible to copy all rows with an #N/A (Formula error) which appears in multiple columns on one sheet (they change field numbers spreadsheet to spreadsheet) and then paste them into another?</p>\n\n<p>What I'm currently using for code requires a specific column (Field 44 in this example) to be selected. Since the columns with #N/A aren't static I'm looking for a way to copy all rows that have the #N/A without filtering. Is this possible or is there no way around the field requirements?</p>\n\n<pre><code>Sheets(\"Fall 2016\").Select\nRange(\"$A$2:$CU$\" &amp; lrow).AutoFilter Field:=44, Criteria1:=\"#N/A\"\nRange(\"$A$3:$CU$\" &amp; lrow).Copy\n\nSheets(\"Sheet1\").Select\nRange(\"A3\").PasteSpecial Paste:=xlPasteValues\nApplication.CutCopyMode = False\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 7571785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jyq8d.jpg?s=128&g=1", "display_name": "zgivod", "link": "https://stackoverflow.com/users/7571785/zgivod"}, "edited": false, "score": 0, "creation_date": 1546457711, "post_id": 53991065, "comment_id": 94861044, "body": "thanks so much it works great. just wondering would it be possible to make the data go backwards on to sheet 2 meaning data first goes to cell A3 then A2 then A1??"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 43, "user_id": 7571785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jyq8d.jpg?s=128&g=1", "display_name": "zgivod", "link": "https://stackoverflow.com/users/7571785/zgivod"}, "edited": false, "score": 0, "creation_date": 1546457919, "post_id": 53991065, "comment_id": 94861128, "body": "@zgivod I just edited the post with a new solution, see above the comments."}, {"owner": {"reputation": 43, "user_id": 7571785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jyq8d.jpg?s=128&g=1", "display_name": "zgivod", "link": "https://stackoverflow.com/users/7571785/zgivod"}, "edited": false, "score": 0, "creation_date": 1547604500, "post_id": 53991065, "comment_id": 95245193, "body": "the code works great thanks. just wondering how would i paste and keep the sheet 1 text color it changes to black when it gets pasted to sheet2"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 43, "user_id": 7571785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jyq8d.jpg?s=128&g=1", "display_name": "zgivod", "link": "https://stackoverflow.com/users/7571785/zgivod"}, "edited": false, "score": 0, "creation_date": 1547684533, "post_id": 53991065, "comment_id": 95280617, "body": "@zgivod If your question has changed please make a new post :). But what you need is <code>.Copy</code> and <code>.Paste</code> - but that&#39;s also going to require you activating the correct sheet."}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 2, "last_activity_date": 1546457780, "last_edit_date": 1546457780, "creation_date": 1546286924, "answer_id": 53991065, "question_id": 53991005, "link": "https://stackoverflow.com/questions/53991005/copy-only-text-from-one-range-and-paste-only-the-first-three-text-on-another-she/53991065#53991065", "title": "Copy ONLY text from one range and paste ONLY the first three text on another sheet", "body": "<p>This is how I would do it:</p>\n\n<pre><code>Sub Transfer_Data()\n\nDim i As Long, j As Long\n\nj = 1\n\nFor i = 1 To 6\n    If Sheets(\"Sheet1\").Cells(i, 1).Value &lt;&gt; \"\" Then\n        Sheets(\"Sheet2\").Cells(j, 1).Value = Sheets(\"Sheet1\").Cells(i, 1).Value\n        j = j + 1\n    End If\n\n    If j &gt; 3 Then Exit For\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>EDITED:</p>\n\n<pre><code>Sub Transfer_Data()\n\n    Dim i As Long, j As Long\n\n    j = 3\n\n    For i = 1 To 6\n        If Sheets(\"Sheet1\").Cells(i, 1).Value &lt;&gt; \"\" Then\n            Sheets(\"Sheet2\").Cells(j, 1).Value = Sheets(\"Sheet1\").Cells(i, 1).Value\n            j = j - 1\n        End If\n\n        If j = 0 Then Exit For\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": false, "score": 1, "last_activity_date": 1546287727, "creation_date": 1546287727, "answer_id": 53991147, "question_id": 53991005, "link": "https://stackoverflow.com/questions/53991005/copy-only-text-from-one-range-and-paste-only-the-first-three-text-on-another-she/53991147#53991147", "title": "Copy ONLY text from one range and paste ONLY the first three text on another sheet", "body": "<p>Untested, there may be another, more elegant way of doing this:</p>\n\n<pre><code>Private Sub TransferData()\n\nDim cellCount as long\n\nDim cell as range\nDim rangeToCopy as range\n\nFor each cell in  Sheets(\"sheet1\").Range(\"A1:A6\").SpecialCells(xlCellTypeConstants) ' 23 is unnecessary, as you get all XlSpecialCellsValue constants by default\n' See https://docs.microsoft.com/en-us/office/vba/api/excel.range.specialcells\ncellCount = cellCount + cell.cells.count\n\nIf not (rangeToCopy is nothing) then\nSet rangeToCopy = application.union(rangeToCopy, cell)\nElse\nSet rangeToCopy = cell\nEnd if\n\nIf cellCount = 3 then exit for\n\nNext cell\n\nIf not (rangeToCopy is nothing) then\nrangeToCopy.copy\n\nSheets(\"sheet2\").Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n\nApplication.CutCopyMode = False\n\nEnd if\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 7571785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jyq8d.jpg?s=128&g=1", "display_name": "zgivod", "link": "https://stackoverflow.com/users/7571785/zgivod"}, "edited": false, "score": 0, "creation_date": 1546310692, "post_id": 53992720, "comment_id": 94823208, "body": "the idea is cool but im getting error subscript out of range and theres too much code for me to debug..."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 43, "user_id": 7571785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jyq8d.jpg?s=128&g=1", "display_name": "zgivod", "link": "https://stackoverflow.com/users/7571785/zgivod"}, "edited": false, "score": 0, "creation_date": 1546310786, "post_id": 53992720, "comment_id": 94823222, "body": "Make sure <code>Sheet1</code> and <code>Sheet2</code> exist."}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 1, "last_activity_date": 1546310382, "creation_date": 1546310382, "answer_id": 53992720, "question_id": 53991005, "link": "https://stackoverflow.com/questions/53991005/copy-only-text-from-one-range-and-paste-only-the-first-three-text-on-another-she/53992720#53992720", "title": "Copy ONLY text from one range and paste ONLY the first three text on another sheet", "body": "<p>I know this already answered, but how about a crazy one-liner? </p>\n\n<pre><code>Sub TransferData()\n    ThisWorkbook.Sheets(\"Sheet2\").Range(\"A1:A3\").Value2 = WorksheetFunction.Transpose(Split(Replace$(Join(WorksheetFunction.Transpose(ThisWorkbook.Sheets(\"Sheet1\").Range(\"A1:A6\").Value2), \",\"), \",,\", \",\"), \",\"))\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7571785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jyq8d.jpg?s=128&g=1", "display_name": "zgivod", "link": "https://stackoverflow.com/users/7571785/zgivod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 53991065, "answer_count": 3, "score": 3, "last_activity_date": 1567451550, "creation_date": 1546286283, "last_edit_date": 1567451550, "question_id": 53991005, "link": "https://stackoverflow.com/questions/53991005/copy-only-text-from-one-range-and-paste-only-the-first-three-text-on-another-she", "title": "Copy ONLY text from one range and paste ONLY the first three text on another sheet", "body": "<p>I have up to 6 cells with potential data coming from 6 different places. I am trying to get only the first three cells with data transferred to another sheet</p>\n\n<pre><code>Private Sub Transfer_Data()\n\nSheets(\"sheet1\").Range(\"A1:A6\").SpecialCells(xlCellTypeConstants, 23).copy\n\nSheets(\"sheet2\").Range(\"A1:A3\").PasteSpecial Paste:=xlPasteValues\n\nApplication.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n\n<p>This is what i have i know i am missing allot</p>\n"}, {"tags": ["vba", "ms-access", "time"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1546285158, "post_id": 53990831, "comment_id": 94819484, "body": "Maybe you should use <code>hh:mm:ss</code>"}], "answers": [{"tags": [], "owner": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "is_accepted": false, "score": 0, "last_activity_date": 1546285759, "creation_date": 1546285759, "answer_id": 53990965, "question_id": 53990831, "link": "https://stackoverflow.com/questions/53990831/converting-seconds-to-hours-minutes-seconds-format-in-access-vba/53990965#53990965", "title": "Converting Seconds to Hours Minutes Seconds Format in Access VBA", "body": "<p>Since you've asked about as it relates to VBA...</p>\n\n<pre><code>Format(12345.123,\"hh:mm:ss\")              results in   02:57:07\nFormat(#12/31/2018 15:32:01#,\"hh:mm:ss\")   results in   15:32:01\n</code></pre>\n\n<p>The 1st example seems to be your case, doesn't it? </p>\n\n<p>It should do the same in a query.</p>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1546337111, "creation_date": 1546337111, "answer_id": 53994575, "question_id": 53990831, "link": "https://stackoverflow.com/questions/53990831/converting-seconds-to-hours-minutes-seconds-format-in-access-vba/53994575#53994575", "title": "Converting Seconds to Hours Minutes Seconds Format in Access VBA", "body": "<p>You will need a custom function for this. But, first convert the seconds to a time value (86400 seconds per day), then format to text:</p>\n\n<pre><code>Display = FormatHourMinuteSecond(CDate(Sum(AuxTime) / 86400))\n</code></pre>\n\n<p>using a function like this:</p>\n\n<pre><code>Public Function FormatHourMinuteSecond( _\n  ByVal datTime As Date, _\n  Optional ByVal strSeparator As String = \":\") _\n  As String\n\n' Returns count of days, hours, minutes, and seconds of datTime\n' converted to hours, minutes, and seconds as a formatted string\n' with an optional choice of time separator.\n'\n' Example:\n'   datTime: #10:03:55# + #20:01:24#\n'   returns: 30:05:19\n'\n' 2014-06-17. Cactus Data ApS, CPH.\n\n  Dim strHour       As String\n  Dim strMinuteSec  As String\n  Dim strHours      As String\n\n  strHour = CStr(Fix(datTime) * 24 + Hour(datTime))\n  ' Add leading zero to minute and second count when needed.\n  strMinuteSec = Right(\"0\" &amp; CStr(Minute(datTime)), 2) &amp; strSeparator &amp; Right(\"0\" &amp; CStr(Second(datTime)), 2)\n  strHours = strHour &amp; strSeparator &amp; strMinuteSec\n\n  FormatHourMinuteSecond = strHours\n\nEnd Function  ' Add leading zero to minute count when needed.\n  strMinute = Right(\"0\" &amp; CStr(Minute(datTime)), 2)\n  strHourMinute = strHour &amp; strSeparator &amp; strMinute\n\n  FormatHourMinute = strHourMinute\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 10044303, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6dWrBS5Uho4/AAAAAAAAAAI/AAAAAAAAAAo/Zlv8_rhbnnU/photo.jpg?sz=128", "display_name": "Jenna Terral", "link": "https://stackoverflow.com/users/10044303/jenna-terral"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2459, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1546337111, "creation_date": 1546284580, "last_edit_date": 1546326353, "question_id": 53990831, "link": "https://stackoverflow.com/questions/53990831/converting-seconds-to-hours-minutes-seconds-format-in-access-vba", "title": "Converting Seconds to Hours Minutes Seconds Format in Access VBA", "body": "<p>I am trying to convert my data to be shown in Hours, Minutes, and Seconds. I currently have the data being shown in just hours, however, it is rounding up or down due to the way I have it formatted. </p>\n\n<p>The server that I am pulling from pulls the data in seconds, so I have converted it to hours by just simply doing (Sum(AuxTime)/3600.0). But I need it in [H]:mm:ss format. </p>\n\n<p>I tried then just pulling the data straight from the serve in my Access query (AuxTime). Then in my VBA module, I made the number format as follows:</p>\n\n<pre><code> With .PivotFields(\"Aux_Time\")\n    .Orientation = 4\n    .Function = -4157\n    .NumberFormat = \"[h]:mm:ss\"\n    .Caption = \"Time Spent in Aux Time\"\n End With\n</code></pre>\n\n<p>However, that is not putting the data in that format, it is just putting all of the seconds in the hours area. </p>\n\n<p>Is there anything else that I should be doing that I am missing?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1546289093, "creation_date": 1546289093, "answer_id": 53991281, "question_id": 53990731, "link": "https://stackoverflow.com/questions/53990731/moving-to-next-empty-row-to-fill-cell-from-userform/53991281#53991281", "title": "Moving to next empty row to fill cell from Userform", "body": "<p>First, there's no need to <code>Select</code> the cell you want to add the value <code>\"X\"</code>.</p>\n\n<p>Second, after you set <code>CurrentCell</code> range object, you can directly use it with <code>CurrentCell.Value2 = \"X\"</code>.</p>\n\n<p>Try the code below, more explanations inside the code:</p>\n\n<pre><code>Dim AMChoiceSht As Worksheet\nDim CurrentCell As Range\nDim LastRow As Long\n\n' set the worksheet object\nSet AMChoiceSht = ThisWorkbook.Worksheets(\"AMChoices\")\n\nWith AMChoiceSht\n    LastRow = .Cells(.Rows.Count, \"B\").End(xlUp).Row ' find last row in column B\n\n    Set CurrentCell = .Range(\"B\" &amp; LastRow + 1) ' set the range of next empty row\nEnd With\n\nIf Me.optAMIB1 Then\n    Total = Total + 20\n    CurrentCell.Value2 = \"X\"\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11900968, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-F3UHf_dzD2M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdx4OJ141CT_y3RlhSo1eput8LWkw/photo.jpg?sz=128", "display_name": "satya srinivas", "link": "https://stackoverflow.com/users/11900968/satya-srinivas"}, "is_accepted": false, "score": 0, "last_activity_date": 1566318090, "creation_date": 1566318090, "answer_id": 57577837, "question_id": 53990731, "link": "https://stackoverflow.com/questions/53990731/moving-to-next-empty-row-to-fill-cell-from-userform/57577837#57577837", "title": "Moving to next empty row to fill cell from Userform", "body": "<p>I assume that you have a column for serial number or roll number, a few columns for students name and others and then a column for each subject that they have the option for. If that is the case and you need to mark below the heading then you could use the code below </p>\n\n<pre><code>Dim lastRow as Long\nlastRow = Sheet1.Cells( \"B\" &amp; Rows.Count). End( xlUp ).Offset(1,0).Row\n\nAMChoices.Range(\"A\" &amp; lastRow).Value = &lt;Serial number or Roll number&gt;\nAMChoices.Range(\"B\" &amp; lastRow).Value = &lt;Student's Name&gt; \n\nif Me.optAMIB1 Then\n   AMChoices.Range(\"&lt;Column name of the choice&gt;\",lastRow).Value = \"X\"\nEnd If\n</code></pre>\n\n<p>You can use the with statement if you want to.</p>\n"}], "owner": {"reputation": 87, "user_id": 10852647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725bf619f278bad05840ac7d0cb23a67?s=128&d=identicon&r=PG&f=1", "display_name": "MJ98", "link": "https://stackoverflow.com/users/10852647/mj98"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 367, "favorite_count": 0, "accepted_answer_id": 53991281, "answer_count": 2, "score": 1, "last_activity_date": 1567494158, "creation_date": 1546283663, "last_edit_date": 1567494158, "question_id": 53990731, "link": "https://stackoverflow.com/questions/53990731/moving-to-next-empty-row-to-fill-cell-from-userform", "title": "Moving to next empty row to fill cell from Userform", "body": "<p>I am currently creating a system using VBA for students to choose their classes in university. I have created a userform 'AMForm' for students to do this, where there are adjacent option buttons for each class so they can select 'yes' or 'no' if they want to enroll in the class e.g. \"Mechanical engineering\" with 'yes' or 'no' option buttons next to it. </p>\n\n<p>Once they submit their form - I want to be able to record their choices on the spreadsheet 'AMChoices'. This spreadsheet has each class in the above headings, so I would like to fill the cell with 'x' if it has been selected e.g. if 'Mechanical Engineering' option button is selected it fills 'x' underneath this cell. </p>\n\n<p>I am doing this for multiple users so I want it to be able to fill the cell, and then when the next user logs their choices, their choices are filled into the next empty row. </p>\n\n<p>Please see below my code.</p>\n\n<pre><code>Set CurrentCell = Range(\"B2\").End(xlDown).Offset(1, 0).Select\nIf Me.optAMIB1 Then\nTotal = Total + 20\nWorksheets(\"AMChoices\").Range(\"CurrentCell\").Value = \"X\"\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 3, "creation_date": 1546279206, "post_id": 53990157, "comment_id": 94817934, "body": "What have you tried? What do you mean by &quot;AutoFill&quot;, do you mean the tool within Excel?  Note that there is an <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.isformula\" rel=\"nofollow noreferrer\"><code>IsFormula()</code> function</a>."}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1546280061, "post_id": 53990157, "comment_id": 94818165, "body": "Well I was thinking of defining a formula as string and then using that with a range of special cells but so far that hasn&#39;t been successful. By Autofill I mean to run the formula to the last row of data on the spreadsheet."}], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1546280010, "post_id": 53990248, "comment_id": 94818150, "body": "This returns a &quot;List separator or )&quot; expected error can&#39;t see where either would apply though since all open ( are closed."}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1546281432, "post_id": 53990248, "comment_id": 94818496, "body": "This is a good start! it def gives me something to work with as well.  It works for the first column but doesn&#39;t seem to be hitting the others. There are formulas from AK to AP and AR to AW and it&#39;s running for AK and AR but not the others."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10852207"}, "is_accepted": true, "score": 2, "last_activity_date": 1546283031, "last_edit_date": 1546283031, "creation_date": 1546279672, "answer_id": 53990248, "question_id": 53990157, "link": "https://stackoverflow.com/questions/53990157/is-it-possible-for-vba-to-recognize-a-row-with-formulas-and-autofill-just-those/53990248#53990248", "title": "Is it possible for VBA to recognize a row with Formulas and autofill just those rows?", "body": "<p>Use specialcells to find cells containing formulas</p>\n\n<pre><code>Dim lrow As Long, a As Range\nlrow = 7\nFor Each a In Range(\"2:2\").SpecialCells(xlCellTypeFormulas).Areas\n    a.Resize(lrow - 1, a.columns.count).FillDown\nNext a\n</code></pre>\n"}], "owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 53990248, "answer_count": 1, "score": 0, "last_activity_date": 1546289580, "creation_date": 1546279066, "last_edit_date": 1546289580, "question_id": 53990157, "link": "https://stackoverflow.com/questions/53990157/is-it-possible-for-vba-to-recognize-a-row-with-formulas-and-autofill-just-those", "title": "Is it possible for VBA to recognize a row with Formulas and autofill just those rows?", "body": "<p>I'm trying to figure out if it's possible, and if so, how to write up VBA code to Autofill to lrow in an excel spreadsheet all Formulas (and only formulas) in row 2. I was thinking maybe an IF then statement but I'm not sure how that would look. I'm not sure how to identify only Formulas in Row two then have them autofill to the last row. Any help would be greatly appreciated. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10852207"}, "is_accepted": false, "score": 1, "last_activity_date": 1546279267, "creation_date": 1546279267, "answer_id": 53990190, "question_id": 53990112, "link": "https://stackoverflow.com/questions/53990112/is-there-code-i-can-use-to-hide-all-rows-except-for-the-row-containing-the-value/53990190#53990190", "title": "Is there code I can use to hide all rows except for the row containing the value I am searching?", "body": "<p>Add an autofilter.</p>\n\n<pre><code>Private Sub Summary_Click()\nDim EMPLID As String\n\nEMPLID = Application.InputBox(\"Enter Your Employee Number\", \"Employee Number\")\n\nWith Sheets(\"Tracking Data\").Range(\"E:E\")\n        Set Rng = .Find(What:=EMPLID, _\n                        After:=.Cells(.Cells.Count), _\n                        LookIn:=xlValues, _\n                        LookAt:=xlWhole, _\n                        SearchOrder:=xlByRows, _\n                        SearchDirection:=xlNext, _\n                        MatchCase:=False)\n        If Not Rng Is Nothing Then\n            .autofilter\n            .autofilter field:=1, criteria1:=EMPLID \n            Application.Goto Rng, True\n        Else\n            MsgBox \"Nothing found\"\n        End If\n    End With\nUnload Me\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121, "user_id": 4608461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76c7a8cd4b69fa96bcd0c7627ff1f831?s=128&d=identicon&r=PG", "display_name": "Roy Brander", "link": "https://stackoverflow.com/users/4608461/roy-brander"}, "is_accepted": false, "score": 0, "last_activity_date": 1546281109, "last_edit_date": 1546281109, "creation_date": 1546279438, "answer_id": 53990210, "question_id": 53990112, "link": "https://stackoverflow.com/questions/53990112/is-there-code-i-can-use-to-hide-all-rows-except-for-the-row-containing-the-value/53990210#53990210", "title": "Is there code I can use to hide all rows except for the row containing the value I am searching?", "body": "<p>I like the autofilter answer just posted.  But a more-literal answer that actually hides the rows, except row 1 and the one where 'Rng' is, goes like this:</p>\n\n<pre><code>Sub tst()\n    Dim rng As Range, bottom As Range\n    Set rng = [D3]  ' Just example data\n    rng.Activate   ' put cursor on rng  \n    ' Assumes Column A has data, otherwise use column with Rng in it\n    Set bottom = Range(\"A\" &amp; Rows.Count).End(xlUp)  ' finds last row in A with any data in it      \n    If rng.Row &gt; 2 Then Range(Rows(2), Rows(rng.Row - 1)).Hidden = True ' Hide all rows above RNG      \n    If rng.Row &lt; bottom.Row Then Range(Rows(rng.Row + 1), Rows(bottom.Row)).Hidden = True  ' Hide rows below  \nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 158, "user_id": 4641457, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xbw3f.png?s=128&g=1", "display_name": "T.J.L.", "link": "https://stackoverflow.com/users/4641457/t-j-l"}, "edited": false, "score": 0, "creation_date": 1566225839, "post_id": 53990848, "comment_id": 101579930, "body": "Find carries parameters over from both previous uses in VBA and from the normal user-accessible version. Specifying all parameters every time is a good idea."}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": -1, "last_activity_date": 1546285097, "last_edit_date": 1546285097, "creation_date": 1546284743, "answer_id": 53990848, "question_id": 53990112, "link": "https://stackoverflow.com/questions/53990112/is-there-code-i-can-use-to-hide-all-rows-except-for-the-row-containing-the-value/53990848#53990848", "title": "Is there code I can use to hide all rows except for the row containing the value I am searching?", "body": "<h1>Find vs Parent</h1>\n\n<p>To not cramp your style, I've only removed the arguments <strong>SearchDirection</strong> and <strong>MatchCase</strong> because they were using default parameters and I've added the '<strong>Parent</strong>' part which is referring to the worksheet (Tracking Data).</p>\n\n<pre><code>Private Sub Summary_Click()\n\nDim EMPLID As String\n\nEMPLID = Application.InputBox(\"Enter Your Employee Number\", \"Employee Number\")\n\nWith Sheets(\"Tracking Data\").Range(\"E:E\")\n        Set rng = .Find(What:=EMPLID, _\n                        After:=.Cells(.Cells.Count), _\n                        LookIn:=xlValues, _\n                        LookAt:=xlWhole, _\n                        SearchOrder:=xlByRows)\n        If Not rng Is Nothing Then\n            With .Parent\n                .Cells(2, 1).Resize(rng.Row - 2).EntireRow.Hidden = True\n                .Cells(rng.Row + 1, 1).Resize(.Rows.Count - rng.Row) _\n                        .EntireRow.Hidden = True\n            End With\n            Application.Goto Rng, True         \n        Else\n            MsgBox \"Nothing found\"\n        End If\nEnd With\nUnload Me\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1546291518, "creation_date": 1546291518, "answer_id": 53991522, "question_id": 53990112, "link": "https://stackoverflow.com/questions/53990112/is-there-code-i-can-use-to-hide-all-rows-except-for-the-row-containing-the-value/53991522#53991522", "title": "Is there code I can use to hide all rows except for the row containing the value I am searching?", "body": "<p>Another simple way to accomplish your task.</p>\n\n<pre><code>Private Sub Summary_Click()\nDim EMPLID As String, cl As Range\n\nEMPLID = Application.InputBox(\"Enter Your Employee Number\", \"Employee Number\")\n\n    With Sheets(\"Tracking Data\")\n        For Each cl In .Range(\"E2\", .Range(\"E\" &amp; .Rows.Count).End(xlUp))\n            If Not cl.Value = EMPLID Then\n                cl.EntireRow.Hidden = True\n            End If\n        Next cl\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 0, "last_activity_date": 1546334885, "creation_date": 1546334885, "answer_id": 53994344, "question_id": 53990112, "link": "https://stackoverflow.com/questions/53990112/is-there-code-i-can-use-to-hide-all-rows-except-for-the-row-containing-the-value/53994344#53994344", "title": "Is there code I can use to hide all rows except for the row containing the value I am searching?", "body": "<p>just <em>plain</em> use of <code>Autofilter()</code>:</p>\n\n<pre><code>Private Sub Summary_Click()\n    Dim EMPLID As String\n\n    EMPLID = Application.InputBox(\"Enter Your Employee Number\", \"Employee Number\")\n\n    With Sheets(\"Tracking Data\").Range(\"E:E\")\n        .AutoFilter field:=1, Criteria1:=EMPLID\n        If WorksheetFunction.Subtotal(103, .Cells) = 1 Then ' if only header row filtered -&gt; no match found\n            MsgBox \"Nothing found\"\n            .Parent.AutoFilterMode = False ' remove AutoFilter and show all data\n        End If\n    End With\n    Unload Me\nEnd Sub\n</code></pre>\n\n<p>BTW I'd suggest you some little enhancements:</p>\n\n<ol>\n<li>limit the searching range to the actual data extensions, instead of the whole column (some 1 million row)</li>\n<li>Don't use <code>Unload Me</code> inside a UserForm code. Adopt <code>Hide.Me</code> and move <code>Unload Me</code> to the <code>Userform</code> calling sub (the one where you place some <code>With New MyUserform</code> statement or the likes)</li>\n</ol>\n\n<p>like follows:</p>\n\n<pre><code>Private Sub Summary_Click()\n    Dim EMPLID As String\n\n    EMPLID = Application.InputBox(\"Enter Your Employee Number\", \"Employee Number\")\n\n    With Sheets(\"Tracking Data\")\n        With .Range(\"E1\", .Cells(.Rows.Count, \"E\").End(xlUp))\n            .AutoFilter field:=1, Criteria1:=EMPLID\n            If WorksheetFunction.Subtotal(103, .Cells) = 1 Then ' if only header row filtered -&gt; no match found\n                MsgBox \"Nothing found\"\n                .Parent.AutoFilterMode = False ' remove AutoFilter and show all data\n            End If\n        End With\n    End With\n    Me.Hide\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1546349811, "creation_date": 1546349811, "answer_id": 53995894, "question_id": 53990112, "link": "https://stackoverflow.com/questions/53990112/is-there-code-i-can-use-to-hide-all-rows-except-for-the-row-containing-the-value/53995894#53995894", "title": "Is there code I can use to hide all rows except for the row containing the value I am searching?", "body": "<p>Try</p>\n\n<pre><code>Sub test()\n    Dim EMPLID As String\n    Dim rngDB As Range, Rng As Range, rngU As Range\n    Dim Ws As Worksheet\n    Dim strAddress As String\n\n    EMPLID = Application.InputBox(\"Enter Your Employee Number\", \"Employee Number\")\n\n\n    Set Ws = Sheets(\"Tracking Data\")\n    With Ws\n        Set rngDB = .Range(\"e1\", .Range(\"e\" &amp; Rows.Count).End(xlUp))\n    End With\n    With rngDB\n        .EntireRow.Hidden = False\n        Set Rng = .Find(What:=EMPLID, _\n                        After:=.Cells(.Cells.Count), _\n                        LookIn:=xlValues, _\n                        LookAt:=xlWhole, _\n                        SearchOrder:=xlByRows, _\n                        SearchDirection:=xlNext, _\n                        MatchCase:=False)\n\n        If Not Rng Is Nothing Then\n            strAddress = Rng.Address\n            Do\n                If rngU Is Nothing Then\n                    Set rngU = Rng\n\n                Else\n                    Set rngU = Union(rngU, Rng)\n                End If\n                Set Rng = .FindNext(Rng)\n            Loop While Rng.Address &lt;&gt; strAddress\n\n        End If\n    End With\n    If rngU Is Nothing Then\n        MsgBox \"Nothing found\"\n    Else\n        rngDB.EntireRow.Hidden = True\n        rngU.EntireRow.Hidden = False\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10852637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5073fce649a2e44f65472396aea9eb58?s=128&d=identicon&r=PG&f=1", "display_name": "AdamJ", "link": "https://stackoverflow.com/users/10852637/adamj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 53994344, "answer_count": 6, "score": 0, "last_activity_date": 1567488455, "creation_date": 1546278675, "last_edit_date": 1567488455, "question_id": 53990112, "link": "https://stackoverflow.com/questions/53990112/is-there-code-i-can-use-to-hide-all-rows-except-for-the-row-containing-the-value", "title": "Is there code I can use to hide all rows except for the row containing the value I am searching?", "body": "<p>I have a search box that auto opens when the file is started requesting the target value. I have tried many times to write something that will hide all rows above and below the value once found, with no avail. </p>\n\n<pre><code>Private Sub Summary_Click()\nDim EMPLID As String\n\nEMPLID = Application.InputBox(\"Enter Your Employee Number\", \"Employee Number\")\n\nWith Sheets(\"Tracking Data\").Range(\"E:E\")\n        Set Rng = .Find(What:=EMPLID, _\n                        After:=.Cells(.Cells.Count), _\n                        LookIn:=xlValues, _\n                        LookAt:=xlWhole, _\n                        SearchOrder:=xlByRows, _\n                        SearchDirection:=xlNext, _\n                        MatchCase:=False)\n        If Not Rng Is Nothing Then\n            Application.Goto Rng, True\n        Else\n            MsgBox \"Nothing found\"\n        End If\n    End With\nUnload Me\n\nEnd Sub\n</code></pre>\n\n<p>I would like to search for EMPLID 12345, return only that row (including the header on Row 1, with all other rows hidden.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 4, "creation_date": 1546273870, "post_id": 53989467, "comment_id": 94816594, "body": "<a href=\"https://stackoverflow.com/questions/10380312/loop-through-files-in-a-folder-using-vba\">This</a> may be of use"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1546275504, "post_id": 53989467, "comment_id": 94817045, "body": "What is the criteria for your xlsx files in this file location? Do all the files there need to be opened to move the data over? 100 files is a lot of files - is there any chance you might exceed 1048576 rows?"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1546276203, "post_id": 53989467, "comment_id": 94817218, "body": "Thanks for your comment @dwirony. Unless there is any better way, all the files need to be opened to move the data. The accumulated rows of those files might be 10000 (more or less)."}], "answers": [{"tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": true, "score": 2, "last_activity_date": 1546280896, "last_edit_date": 1546280896, "creation_date": 1546277583, "answer_id": 53989971, "question_id": 53989467, "link": "https://stackoverflow.com/questions/53989467/how-to-open-multiple-workbooks-to-copy-the-data-from/53989971#53989971", "title": "How to open multiple workbooks to copy the data from", "body": "<p>Using VBA (instead of something like Power Query) and assuming you want to copy the data from the first sheet (of the workbook you open) and paste to <code>\"Sheet1\"</code> in <code>Thisworkbook</code>, the code might look something like the below.</p>\n\n<p>Might be good to make a copy of the entire folder (containing <code>.xlsx</code> files) before running the code below (unnecessary, but just in case).</p>\n\n<p>If you have hundreds of files to open, you might want to toggle <code>Application.ScreenUpdating</code> before and after the <code>For</code> loop (to prevent unnecessary screen flickering and redrawing).</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CopyPasteSheets()\n    Dim folderPath As String\n    folderPath = \"C:\\Users\\WCS\\Desktop\\files\\coworking\\\"\n\n    If Len(VBA.FileSystem.Dir$(folderPath, vbDirectory)) = 0 Then\n        MsgBox (\"'\" &amp; folderPath &amp; \"' does not appear to be a valid directory.\" &amp; vbNewLine &amp; vbNewLine &amp; \"Code will stop running now.\")\n        Exit Sub\n    End If\n\n    Dim filePathsFound As Collection\n    Set filePathsFound = New Collection\n\n    Dim Filename As String\n    Filename = VBA.FileSystem.Dir$(folderPath &amp; \"*.xlsx\", vbNormal)\n\n    Do Until Len(Filename) = 0\n        filePathsFound.Add folderPath &amp; Filename, Filename\n        Filename = VBA.FileSystem.Dir$()\n    Loop\n\n    Dim filePath As Variant ' Used to iterate over collection\n    Dim sourceBook As Workbook\n\n    Dim destinationSheet As Worksheet\n    Set destinationSheet = ThisWorkbook.Worksheets(\"Sheet1\") ' Change to whatever yours is called\n    'destinationSheet.Cells.Clear ' Uncomment this line if you want to clear before beginning\n\n    Dim rowToPasteTo As Long\n    rowToPasteTo = destinationSheet.Cells(destinationSheet.Rows.Count, \"A\").End(xlUp).Row\n    If rowToPasteTo &gt; 1 Then rowToPasteTo = rowToPasteTo + 1\n\n    For Each filePath In filePathsFound\n        On Error Resume Next\n        Set sourceBook = Application.Workbooks.Open(Filename:=filePath, ReadOnly:=True)\n        On Error GoTo 0\n\n        If Not (sourceBook Is Nothing) Then\n            With sourceBook.Worksheets(1) ' Might be better if you refer to sheet by name rather than index\n                Dim lastRowToCopy As Long\n                lastRowToCopy = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n                With .Range(\"A1:A\" &amp; lastRowToCopy).EntireRow\n                    If (rowToPasteTo + .Rows.Count - 1) &gt; destinationSheet.Rows.Count Then\n                        MsgBox (\"Did not paste rows from '\" &amp; sourceBook.FullName &amp; \"' due to lack of rows on sheet.\" &amp; vbNewLine &amp; vbNewLine &amp; \"Code will close that particular workbook and then stop running.\")\n                        sourceBook.Close\n                        Exit Sub\n                    End If\n\n                    .Copy destinationSheet.Cells(rowToPasteTo, \"A\").Resize(.Rows.Count, 1).EntireRow\n                    rowToPasteTo = rowToPasteTo + .Rows.Count\n                End With\n            End With\n            sourceBook.Close\n            Set sourceBook = Nothing\n        Else\n            MsgBox (\"Could not open file at '\" &amp; CStr(sourceBook) &amp; \"'. Will try to open remaining workbooks.\")\n        End If\n    Next filePath\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 2, "last_activity_date": 1546281930, "last_edit_date": 1546281930, "creation_date": 1546280262, "answer_id": 53990323, "question_id": 53989467, "link": "https://stackoverflow.com/questions/53989467/how-to-open-multiple-workbooks-to-copy-the-data-from/53990323#53990323", "title": "How to open multiple workbooks to copy the data from", "body": "<h1>Open and Import File</h1>\n\n<h2>The Code</h2>\n\n<pre><code>Sub OpenAndImportFile()\n\n    ' Source File Folder Path\n    Const cStrFolder As String = \"C:\\Users\\WCS\\Desktop\\files\\coworking\"\n    Const cStrExt As String = \"*.xls*\"         ' Source File Pattern\n    Const cVntSrcName As Variant = 1           ' Source Worksheet Name/Index\n    Const cVntSource As Variant = \"A\"          ' Source Column Letter/Number\n\n    Const cVntTgtName As Variant = \"Sheet1\"    ' Target Worksheet Name/Index\n    Const cVntTarget As Variant = \"A\"          ' Target Column Letter/Number\n\n    Dim objWbSource As Workbook   ' Source Workbook\n    Dim objRngU As Range          ' Source Union Range\n    Dim StrFile As String         ' Source File Name\n    Dim i As Long                 ' Source Row Counter\n    Dim j As Long                 ' Target Row Counter\n\n    Dim objWsTarget As Worksheet  ' Target Worksheet\n    Dim cLngPasteRow As Long      ' Target Paste Row\n\n    Set objWsTarget = ThisWorkbook.Worksheets(cVntTgtName)\n    objWsTarget.Cells.Clear\n\n    cLngPasteRow = 1\n\n    StrFile = Dir(cStrFolder &amp; \"\\\" &amp; cStrExt)\n\n    On Error GoTo ProcedureExit\n\n    With Application\n      .ScreenUpdating = False\n      .Calculation = xlCalculationManual\n      .DisplayAlerts = False\n    End With\n\n    Do While Len(StrFile) &gt; 0\n\n        Set objWbSource = Workbooks.Open(cStrFolder &amp; \"\\\" &amp; StrFile)\n\n        With objWbSource.Worksheets(1)\n\n'            Debug.Print objWbSource.Name &amp; \"  \" &amp; .Name &amp; \"   \" &amp; cLngPasteRow\n\n            If .Cells(.Rows.Count, cVntSource).End(xlUp).Row = 1 _\n                And .Cells(1, 1) = \"\" Then\n              Else\n                For i = 1 To .Cells(.Rows.Count, cVntSource).End(xlUp).Row\n                    If Not objRngU Is Nothing Then\n                        Set objRngU = Union(objRngU, .Cells(i, cVntSource))\n                      Else\n                        Set objRngU = .Cells(i, cVntSource)\n                    End If\n                    j = j + 1\n                Next\n            End If\n        End With\n\n        If Not objRngU Is Nothing Then\n            objRngU.EntireRow.Copy objWsTarget.Cells(cLngPasteRow, cVntTarget)\n            Set objRngU = Nothing\n            cLngPasteRow = j + 1 ' Next row to copy data to.\n        End If\n\n        objWbSource.Close False\n\n        StrFile = Dir\n\n    Loop\n\nProcedureExit:\n\n    Set objRngU = Nothing\n    Set objWbSource = Nothing\n    Set objWsTarget = Nothing\n\n    With Application\n      .ScreenUpdating = True\n      .Calculation = xlCalculationAutomatic\n      .DisplayAlerts = True\n    End With\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "is_accepted": false, "score": 0, "last_activity_date": 1546293434, "creation_date": 1546293434, "answer_id": 53991714, "question_id": 53989467, "link": "https://stackoverflow.com/questions/53989467/how-to-open-multiple-workbooks-to-copy-the-data-from/53991714#53991714", "title": "How to open multiple workbooks to copy the data from", "body": "<p>This is how I did to serve the purpose eventually:</p>\n\n<pre><code>Sub OpenAndImportFile()\n    Dim wbO As Workbook, wsI As Worksheet, cel As Range\n    Dim daddr$, Filename$, foundfiles As New Collection\n    Dim xlfile As Variant\n\n    Application.ScreenUpdating = False\n\n    daddr = Environ(\"USERPROFILE\") &amp; \"\\Desktop\\files\\coworking\\\"\n    Filename = Dir(daddr &amp; \"*.xlsx\")\n    Set wsI = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    Do While Len(Filename) &gt; 0\n        foundfiles.Add Filename\n        Filename = Dir\n    Loop\n\n    For Each xlfile In foundfiles\n        Set wbO = Workbooks.Open(daddr &amp; xlfile)\n\n        For Each cel In wbO.Sheets(1).Range(\"A1:A\" &amp; wbO.Sheets(1).Cells(Rows.count, 1).End(xlUp).row)\n            cel(1, 1).EntireRow.Copy wsI.Range(\"A\" &amp; Rows.count).End(xlUp).Offset(1, 0)\n        Next cel\n        wbO.Close SaveChanges:=False\n    Next xlfile\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 1, "accepted_answer_id": 53989971, "answer_count": 3, "score": 1, "last_activity_date": 1546293434, "creation_date": 1546273449, "last_edit_date": 1546277181, "question_id": 53989467, "link": "https://stackoverflow.com/questions/53989467/how-to-open-multiple-workbooks-to-copy-the-data-from", "title": "How to open multiple workbooks to copy the data from", "body": "<p>I've written a script in vba which is able to import a <code>.xlsx</code> file from a specific folder in my desktop and copy the data from there in order to paste the same in my currently active worksheet. My script is doing fine for a single <code>.xlsx</code> file.</p>\n\n<p>The folder contains 100's of <code>.xlsx</code> files. Each of the files in their <code>Sheet1</code> having data with fixed coulmns (rows may vary).</p>\n\n<p><strong><em>What I wish to do now is get all the data from those files one by one in my active worksheet (<code>appended one after another in row-wise</code>)</em></strong>.</p>\n\n<p>My attempt so far:</p>\n\n<pre><code>Sub OpenAndImportFile()\n    Dim wbO As Workbook, wsI As Worksheet, cel As Range\n\n    Set wsI = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    Set wbO = Workbooks.Open(\"C:\\Users\\WCS\\Desktop\\files\\coworking\\list_members-coworking-annkingman-2018-12-31-14-55-07-eisaiah_e.xlsx\")\n\n    For Each cel In wbO.Sheets(1).Range(\"A1:A\" &amp; wbO.Sheets(1).Cells(Rows.count, 1).End(xlUp).row)\n        cel(1, 1).EntireRow.Copy wsI.Range(cel(1, 1).Address)\n    Next cel\n\n    wbO.Close SaveChanges:=False\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 7, "creation_date": 1546271713, "post_id": 53989228, "comment_id": 94815947, "body": "In VBA -1 is True, 0 is False. Try: <code>Debug.Print (-1 = True)</code> and <code>Debug.Print (0 = False)</code> to see what I mean"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1546271846, "post_id": 53989228, "comment_id": 94815995, "body": "@RyanWildry Oh, that&#39;s odd!  AFAIK, in other languages, <code>1</code> is <code>True</code>.  Why would VBA/Microsoft flip that around?  I&#39;m quite surprised that <code>1=True</code> returns <code>False</code>."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1546271908, "post_id": 53989228, "comment_id": 94816019, "body": "Just a wild guess, but maybe this was done for backward compatibility."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1546272135, "post_id": 53989228, "comment_id": 94816080, "body": "Actually, <a href=\"https://blogs.msdn.microsoft.com/oldnewthing/20041222-00/?p=36923\" rel=\"nofollow noreferrer\">Raymond Chen implies</a> that it was just &quot;done&quot;. To expand on the comment above, it&#39;s specified in OLE automation spec as <a href=\"https://msdn.microsoft.com/en-us/library/cc237864.aspx\" rel=\"nofollow noreferrer\">VARIANT_BOOL</a>. Since VBA is a COM beastie and uses <code>Variant</code>, it&#39;s simply following spec."}], "answers": [{"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1546282597, "post_id": 53989381, "comment_id": 94818822, "body": "<i>&quot;-1 has all bits set to 1 in a 2\u2019s complement signed integral type so the choice has some sense.&quot;</i> - sorry that&#39;s just jibberish to me, would you mind putting it in layman&#39;s terms for someone like me? :)"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 3, "creation_date": 1546282754, "post_id": 53989381, "comment_id": 94818858, "body": "@dwirony: put another way, -1 is the bitwise negation of 0."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1546440413, "post_id": 53989381, "comment_id": 94853247, "body": "Is there anything in the VBA language, or its use, that would have hinted at <code>-1</code> being <code>TRUE</code>? I&#39;m just curious because if I had used code elsewhere that relied on <code>1=TRUE</code>, would I just have to wait for my code to throw an error to discover this quirk?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1546440580, "post_id": 53989381, "comment_id": 94853311, "body": "@BruceWayne: You need to have had a warped childhood. Start this BBC Micro Emulator and type <code>PRINT TRUE</code>: <a href=\"https://computer-literacy-project.pilots.bbcconnectedstudio.co.uk/jsbeeb/index.html\" rel=\"nofollow noreferrer\">computer-literacy-project.pilots.bbcconnectedstudio.co.uk/&hellip;</a>"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 8, "last_activity_date": 1546441119, "last_edit_date": 1546441119, "creation_date": 1546272734, "answer_id": 53989381, "question_id": 53989228, "link": "https://stackoverflow.com/questions/53989228/evaluate-returns-1-for-true-why-not-1/53989381#53989381", "title": "Evaluate returns -1 for TRUE? (Why not 1)", "body": "<p>VBA uses -1 for the True value. Cf. C and C++ which use 1.</p>\n\n<p>-1 has all bits set to 1 in a 2\u2019s complement signed integral type so the choice has some sense.</p>\n\n<p>The choice goes way back to DOS BASIC (and other BASICs such as the one on the old BBC Micro) which predates the Component Object Model of the mid 1990s that\u2019s still in use today.</p>\n"}], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 53989381, "answer_count": 1, "score": 3, "last_activity_date": 1546441119, "creation_date": 1546271648, "last_edit_date": 1546272179, "question_id": 53989228, "link": "https://stackoverflow.com/questions/53989228/evaluate-returns-1-for-true-why-not-1", "title": "Evaluate returns -1 for TRUE? (Why not 1)", "body": "<p>I was helping with another question, and I realized that using <code>Evaluate</code> in VBA seems to return <code>-1</code> for <code>TRUE</code> statements.</p>\n\n<p>Data:</p>\n\n<pre><code>Column A    Column B\nA           A\nA           B\nC           C\n</code></pre>\n\n<p>So if I put <code>=INT(A2=B2)</code> and drag down, I get <code>1, 0, 1</code> which I expect.</p>\n\n<p>However, using the following VBA, I get <code>-1, 0, -1</code>.  </p>\n\n<pre><code>For i = 2 To 4\n    Cells(i, 4).Value = Evaluate(Int(Cells(i, 1) = Cells(i, 2)))\nNext i\n</code></pre>\n\n<p>Why would <code>EVALUATE</code> use <code>-1</code> for <code>TRUE</code>?</p>\n"}]