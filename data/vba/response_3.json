[{"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1422489437, "creation_date": 1422489437, "answer_id": 28204707, "question_id": 28204579, "link": "https://stackoverflow.com/questions/28204579/deleting-multiple-checkboxes-based-on-selected-cell/28204707#28204707", "title": "Deleting Multiple Checkboxes Based on Selected Cell", "body": "<p>try:</p>\n\n<pre><code>Sub DeleteJob1_Click()\n    Dim cb As CheckBox\n    If MsgBox(\"This will erase this job! Are you sure?\", vbYesNo) = vbNo Then Exit Sub\n    For Each cb In ActiveSheet.CheckBoxes\n        If cb.TopLeftCell.Column = ActiveCell.Column Then cb.Delete\n    Next\n    Columns(ActiveCell.Column).Delete\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 4505263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d6b6def3c7330be39309dc733b0dc2?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Ragan", "link": "https://stackoverflow.com/users/4505263/michael-ragan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 0, "accepted_answer_id": 28204707, "answer_count": 1, "score": 1, "last_activity_date": 1431283845, "creation_date": 1422488688, "last_edit_date": 1431283845, "question_id": 28204579, "link": "https://stackoverflow.com/questions/28204579/deleting-multiple-checkboxes-based-on-selected-cell", "title": "Deleting Multiple Checkboxes Based on Selected Cell", "body": "<p>I have some Excel worksheets that use ActiveX checkboxes to control certain activity. I am looking for a method to delete the contents the column of the selected cell (both the text and the checkboxes). So far, I've been using the code below, but it has only deleted the checkbox in the cell below the active cell. Any help would be appreciated!</p>\n\n<pre><code>Sub DeleteJob1_Click()\n\nIf MsgBox(\"This will erase this job! Are you sure?\", vbYesNo) = vbNo Then Exit Sub\nColumns(ActiveCell.Column).Delete\n\nDim cb As CheckBox\n\nFor Each cb In ActiveSheet.CheckBoxes\n    If cb.TopLeftCell.Address = ActiveCell.Address Then cb.Delete\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 2, "creation_date": 1422485791, "post_id": 28203971, "comment_id": 44773953, "body": "Please tag your question with the database you are using."}], "answers": [{"comments": [{"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1456993793, "post_id": 28204030, "comment_id": 59205655, "body": "The question is tagged [access-vba]; Access doesn&#39;t support ROW_NUMBER."}, {"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1457066491, "post_id": 28204030, "comment_id": 59247014, "body": "@ZevSpitz . . . That tag appears to have been added a day after I wrote this answer."}], "tags": [], "owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "is_accepted": false, "score": 1, "last_activity_date": 1422485866, "creation_date": 1422485866, "answer_id": 28204030, "question_id": 28203971, "link": "https://stackoverflow.com/questions/28203971/select-max-for-multiple-criteria-in-a-group/28204030#28204030", "title": "Select MAX for multiple criteria in a group", "body": "<p>ANSI SQL support a function called <code>row_number()</code>, which can be very helpful for this type of query.  The following is how you would use it in this case:</p>\n\n<pre><code>select sum(cost)\nfrom (select t.*, row_number() over (partition by sku order by date) as seqnum\n      from table t\n     ) t\nwhere seqnum = 1;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 59791, "user_id": 467473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af668442ab8ce6408bd051b350d89c01?s=128&d=identicon&r=PG", "display_name": "Nicholas Carey", "link": "https://stackoverflow.com/users/467473/nicholas-carey"}, "is_accepted": false, "score": 0, "last_activity_date": 1422486386, "creation_date": 1422486386, "answer_id": 28204137, "question_id": 28203971, "link": "https://stackoverflow.com/questions/28203971/select-max-for-multiple-criteria-in-a-group/28204137#28204137", "title": "Select MAX for multiple criteria in a group", "body": "<p>This should work:</p>\n\n<pre><code>select sum(t.cost)\nfrom some_table t\njoin ( select sku ,\n              min(some_datetime_column) oldest\n       from some_table\n       and some_datetime_column is not null\n       group by sku\n     ) s on s.sku    = t.sku\n        and s.oldest = t.some_datetime_column\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 1804370, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/3b14538d050465e2de7cd4cf00fbd5fb?s=128&d=identicon&r=PG", "display_name": "JeffO", "link": "https://stackoverflow.com/users/1804370/jeffo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 853, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594645533, "creation_date": 1422485580, "last_edit_date": 1594645533, "question_id": 28203971, "link": "https://stackoverflow.com/questions/28203971/select-max-for-multiple-criteria-in-a-group", "title": "Select MAX for multiple criteria in a group", "body": "<p>Apologies if this has been answered, I'm new enough that I didn't even know how to search:</p>\n\n<p>I have one table:</p>\n\n<blockquote>\n  <h2>Lot      SKU   Cost   Date</h2>\n  \n  <p>1001-1   1001  .30    10-12-14<br>\n  1001-2   1001  .33    10-19-14<br>\n  1001-3   1001  .32    11-20-14<br>\n  1002-1   1002  .45    10-12-14<br>\n  1002-2   1002  .45    10-19-14<br>\n  1002-3   1002  .44    12-01-14<br>\n  1003-1   1003  .12    10-15-14<br>\n  1003-2   1003  .13    10-19-14<br>\n  1003-3   1003  .10    11-23-14<br>      </p>\n</blockquote>\n\n<p>i need to sum the cost of the oldest row for each SKU.  </p>\n\n<p>expected outcome:  (.30 + .45 + .12) = .87</p>\n\n<p>is this possible through one query?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2020, "user_id": 3442153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/hwsHp.jpg?s=128&g=1", "display_name": "K\u1d00\u03c4\u1d22", "link": "https://stackoverflow.com/users/3442153/k%e1%b4%80%cf%84%e1%b4%a2"}, "edited": false, "score": 2, "creation_date": 1422483419, "post_id": 28203451, "comment_id": 44772992, "body": "what have you already tried? Any code?"}, {"owner": {"reputation": 3038, "user_id": 115482, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38827ce1eea4d49cd5a5a300a4db86c0?s=128&d=identicon&r=PG", "display_name": "ICodeForCoffee", "link": "https://stackoverflow.com/users/115482/icodeforcoffee"}, "edited": false, "score": 1, "creation_date": 1422483525, "post_id": 28203451, "comment_id": 44773034, "body": "Can you post an example of what you have and what the code you are working with is?"}, {"owner": {"reputation": 6440, "user_id": 4002530, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Hrwjk.jpg?s=128&g=1", "display_name": "tospig", "link": "https://stackoverflow.com/users/4002530/tospig"}, "edited": false, "score": 0, "creation_date": 1422483961, "post_id": 28203451, "comment_id": 44773226, "body": "And also read <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask a good question</a>"}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 4459381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8b4ff18f1af439a09c5f877db5d196c?s=128&d=identicon&r=PG&f=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/4459381/carl"}, "is_accepted": false, "score": 0, "last_activity_date": 1422487446, "creation_date": 1422487446, "answer_id": 28204352, "question_id": 28203451, "link": "https://stackoverflow.com/questions/28203451/vba-in-excel-if-condition-or-nested-if/28204352#28204352", "title": "vba In excel if condition or nested if", "body": "<p>Probably need to loop through everything.</p>\n\n<pre><code>Dim lastRow As String\nDim x as Long\n\nlastRow = Sheets(\"Sheet1\").Cells(Rows.Count, \"F\").End(xlUp).Row\n\nFor x = 1 To lastRow\n    If Sheets(\"Sheet1\").Range(\"F\" &amp; x) = 0 Then msgBox (\"Zero Value\" &amp; x)\n    Else (Add your else here, or drop the else and get get pinged every time you hit zero)\nNext\n</code></pre>\n\n<p>This will loop through every row in your sheet</p>\n"}], "owner": {"reputation": 1, "user_id": 4505011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28baf79988d8657c0068ca017fd77bee?s=128&d=identicon&r=PG&f=1", "display_name": "M712", "link": "https://stackoverflow.com/users/4505011/m712"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1422487446, "creation_date": 1422483239, "last_edit_date": 1531164843, "question_id": 28203451, "link": "https://stackoverflow.com/questions/28203451/vba-in-excel-if-condition-or-nested-if", "title": "vba In excel if condition or nested if", "body": "<p>hey i want to check <strong>data in F</strong> row is <strong>0</strong> or not while <strong><em>entering data in G row</em></strong> If data in F row has value 0 than one msgbox pop-up and alert me as popup msg?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1422482021, "post_id": 28203028, "comment_id": 44772320, "body": "You have the code that <code>Finds the actual last row</code>. What problem are you having? Btw, You&#39;ll need to explicitly reference the objects your working on to the worksheet where you&#39;re doing your search. Like what you did in setting <code>NextCell</code>."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1422482425, "post_id": 28203028, "comment_id": 44772535, "body": "<a href=\"http://stackoverflow.com/a/15375099/62576\">stackoverflow.com/a/15375099/62576</a>"}, {"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1422482917, "post_id": 28203028, "comment_id": 44772769, "body": "<a href=\"http://stackoverflow.com/questions/11169445/error-finding-last-used-cell-in-vba\">This</a> is a good reference as well."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1422482490, "creation_date": 1422482490, "answer_id": 28203251, "question_id": 28203028, "link": "https://stackoverflow.com/questions/28203028/need-to-determine-lastrow-over-the-whole-row/28203251#28203251", "title": "Need to determine LastRow over the Whole Row", "body": "<p>This is a common problem with \"jagged\" data like:</p>\n\n<p><img src=\"https://i.stack.imgur.com/0QHZa.png\" alt=\"enter image description here\"></p>\n\n<p>Clearly here column <strong>B</strong> has that last row.  <br> Here is one way to get that overall <em>Last</em> row by looping over the four candidate columns:</p>\n\n<pre><code>Sub RealLast()\n    Dim m As Long\n    m = 0\n    For i = 1 To 4\n      candidate = Cells(Rows.Count, i).End(xlUp).Row\n      If candidate &gt; m Then m = candidate\n    Next i\n    MsgBox m\nEnd Sub\n</code></pre>\n\n<p>:</p>\n"}, {"tags": [], "owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "is_accepted": false, "score": 1, "last_activity_date": 1422482730, "creation_date": 1422482730, "answer_id": 28203321, "question_id": 28203028, "link": "https://stackoverflow.com/questions/28203028/need-to-determine-lastrow-over-the-whole-row/28203321#28203321", "title": "Need to determine LastRow over the Whole Row", "body": "<p>Find works best for most situations, below is the function i use that takes sheet ref as input and returns row number as type Long</p>\n\n<pre><code>Dim lLastRow As Long\nlLastRow = LastUsedRow(shName)\n\n\n\n\n  Private Function LastUsedRow(sh As Worksheet) As Long\n        LastUsedRow = sh.Cells.Find(What:=\"*\", After:=sh.Cells.Cells(1), _ \n        LookAt:=xlPart, LookIn:=xlFormulas, SearchOrder:=xlByRows, _ \n        SearchDirection:=xlPrevious, MatchCase:=False).Row\n    End Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 161, "user_id": 4338938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/he6mC.png?s=128&g=1", "display_name": "Valhalla_33", "link": "https://stackoverflow.com/users/4338938/valhalla-33"}, "edited": false, "score": 0, "creation_date": 1422502102, "post_id": 28203553, "comment_id": 44778426, "body": "the second code bit is JUST to show the code I need to use..  I can&#39;t figure how to get it to replace the code I do have, which is kludged by the blank A column.  This is the part I need to change using the second code part:    Set NextCell = Worksheets(&quot;Incoming Data&quot;).Cells _    (Worksheets(&quot;Incoming Data&quot;).Rows.Count, &quot;A&quot;).End(xlUp).Offset(1, 0)"}], "tags": [], "owner": {"reputation": 172, "user_id": 2635143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94adfabac995bdc7dfa214e14a7836c3?s=128&d=identicon&r=PG", "display_name": "tpkaplan", "link": "https://stackoverflow.com/users/2635143/tpkaplan"}, "is_accepted": false, "score": 1, "last_activity_date": 1422484033, "last_edit_date": 1422484033, "creation_date": 1422483624, "answer_id": 28203553, "question_id": 28203028, "link": "https://stackoverflow.com/questions/28203028/need-to-determine-lastrow-over-the-whole-row/28203553#28203553", "title": "Need to determine LastRow over the Whole Row", "body": "<p>The simplest thing might be to use the <code>specialcells</code> method, as in <code>range.specialcells(xllastcell)</code>.  This returns the cell whose row number is the last row used anywhere in the spreadsheet, and whose column is the last column used anywhere in the worksheet.  (I don't think it matters what \"range\" you specify; the result is always the last cell on the worksheet.)</p>\n\n<p>So if you have data in cells <code>B30</code> and <code>X5</code> and nowhere else,  <code>cells.specialcells(xllastcell)</code> will point to cell <code>X30</code> (and <code>range(\"A1\").specialcells(xlastcell)</code> will also point to cell <code>X30</code>).  </p>\n\n<p>Instead of: </p>\n\n<pre><code>LastRow = Cells.Find(What:=\"*\", After:=[A1], _\n              SearchOrder:=xlByRows, _\n              SearchDirection:=xlPrevious).Row\nMsgBox (\"The Last Row Is: \" &amp; LastRow)\n</code></pre>\n\n<p>use this:</p>\n\n<pre><code>LastRow = cells.specialcells(xllastcell).row\nMsgBox (\"The Last Row Is: \" &amp; LastRow)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 161, "user_id": 4338938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/he6mC.png?s=128&g=1", "display_name": "Valhalla_33", "link": "https://stackoverflow.com/users/4338938/valhalla-33"}, "is_accepted": true, "score": 0, "last_activity_date": 1432218528, "last_edit_date": 1432218528, "creation_date": 1422555389, "answer_id": 28221756, "question_id": 28203028, "link": "https://stackoverflow.com/questions/28203028/need-to-determine-lastrow-over-the-whole-row/28221756#28221756", "title": "Need to determine LastRow over the Whole Row", "body": "<p>After 35 attempts this is the code that I was able to hack into my original:</p>\n\n<pre><code> '  Used to determine LastRow, LastColumn, LastCell, NextCell\n Dim LastRow As Long\n Dim LastColumn As Integer\n Dim LastCell As Range, NextCell As Range\n\n    With Worksheets(\"Tracking\")\n      '  Find LastRow. Works Best. 1st and last cells can be empty\n         If WorksheetFunction.CountA(Cells) &gt; 0 Then\n         'Search for any entry, by searching backwards by Rows.\n              LastRow = Cells.Find(What:=\"*\", After:=[A1], _\n                  SearchOrder:=xlByRows, _\n                  SearchDirection:=xlPrevious).Row\n         'Search for any entry, by searching backwards by Columns.\n              LastColumn = Cells.Find(What:=\"*\", After:=[A1], _\n                  SearchOrder:=xlByColumns, _\n                  SearchDirection:=xlPrevious).Column\n           'MsgBox \"Last Cell\" &amp; vbCrLf &amp; vbCrLf &amp; Cells(LastRow, LastColumn).Address\n           'MsgBox \"The Last Row is: \" &amp; vbCrLf &amp; vbCrLf &amp; LastRow\n           'MsgBox \"The Last Column is: \" &amp; vbCrLf &amp; vbCrLf &amp; LastColumn\n         End If\n       ' Number of columns based on actual size of log range NOT MyAr(n)\n       Set NextCell = Worksheets(\"Tracking\").Cells(LastRow + 1, (LastColumn - 10))\n    End With\n</code></pre>\n\n<p>This finds the \"Real\" Last Row and column and ignores any empty cells in Column A or J which seem to affect some of the LastRow snippets.  I needed to make it ROWS instead of ROW and HAD the add the Offset portion as well. (-10) puts me back to  Column \"A\" for my sheet and now I have removed Column \"A\" {the forced Place Holder \".\"} and have \"Real\" data there now. YAY for the \"Hacking Code Cobbler\". </p>\n\n<p>Glad they pay me at work to learn this stuff.  :)  Solved this a while back. Just now got to update this post.</p>\n"}], "owner": {"reputation": 161, "user_id": 4338938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/he6mC.png?s=128&g=1", "display_name": "Valhalla_33", "link": "https://stackoverflow.com/users/4338938/valhalla-33"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 688, "favorite_count": 0, "accepted_answer_id": 28221756, "answer_count": 4, "score": 1, "last_activity_date": 1432218528, "creation_date": 1422481613, "last_edit_date": 1422505694, "question_id": 28203028, "link": "https://stackoverflow.com/questions/28203028/need-to-determine-lastrow-over-the-whole-row", "title": "Need to determine LastRow over the Whole Row", "body": "<p>I am not a programmer but have managed to cobble together great amounts of code that work on 4 pretty large projects (Yay for me!) I have tried numerous ways to find the Last Row.  Some work for me some don't. I can find a few that give me the \"actual\" last row regardless of blanks in Column A (this is what I need). Yet I CANNOT for my life figure how to integrate that code with the way I am passing values from my array from one workbook to another. All of the code works \"As Is\" but I need to find a better way of searching the whole row (currently columns A:O) for the Last Row and then copying the data over. Column A maybe empty at times and to avoid the code from being overwritten, that \"Last Row\" needs to check the whole row. I am currently forcing a hidden cell (A7) with a \".\" as a forced placeholder. Any advice would be awesome.</p>\n\n<pre><code> Option Explicit\n\n Public Sub SaveToLog15()\n\n Dim rng As Range, aCell As Range\n Dim MyAr() As Variant\n Dim n As Long, i As Long\n Dim LastRow As Long\n Dim NextCell As Range\n Dim Sheet2 As Worksheet\n\n Set Sheet2 = ActiveSheet\n\n Application.ScreenUpdating = False\n\n  With Sheet2\n    '  rng are the cells you want to read into the array.\n    '  Cell A7 (\".\") is a needed \"Forced Place Holder\" for last row _\n       determination\n    '  A7 will go away once \"better\" LastRow can be added to this code\n    Set rng = Worksheets(\"Main\").Range(\"A7,D22,D19,D20,J22:J24,E23,D21,J25:J27,D62,D63,G51\")\n         '  counts number of cells in MyAr\n    n = rng.Cells.Count\n         '  Redimensions array for above range\n    ReDim MyAr(1 To n)\n         '  Sets start cell at 1 or \"A\"\n    n = 1\n         '  Loops through cells to add data to the array\n    For Each aCell In rng.Cells\n        MyAr(n) = aCell.Value\n        n = n + 1\n    Next aCell\n  End With\n\n   On Error Resume Next\n   '   Opens \"Test Log.xls\"\n   Workbooks.Open FileName:= _\n   \"S:\\Test Folder\\Test Log.xls\"\n\n    '  SUBROUTINE 1 \"Disable Sheet Protection and Show All\" REMOVED\n\n   '  Finds last row on Tab \"Tracking\" based on Column \"A\"\n   '  Last row determination DOES NOT go to next row if first _\n      Column is blank\n   '  Use A7 \".\" to always force Data to Col A\n'**********************************************************************\n'THIS WORKS FINE BUT DOES NOT RECOGNIZE THE POSSIBLE BLANK IN COL A.\n\n   With Worksheets(\"Incoming Data\")\n   Set NextCell = Worksheets(\"Incoming Data\").Cells _\n   (Worksheets(\"Incoming Data\").Rows.Count, \"A\").End(xlUp).Offset(1, 0)\n   End With\n\n' I need this code replaced by the following code or integrated into \n' this code snippet. I am lost on how to make that happen.\n'***********************************************************************\n\n'***********************************************************************\n'THIS CODE FINDS THE \"ACTUAL\" LAST ROW AND THIS IS WHAT I'D LIKE TO USE\n' I need to figure how to integrate this code block with the above\n' Or maybe redo the whole thing. \n\n     LastRow = Cells.Find(What:=\"*\", After:=[A1], _\n                  SearchOrder:=xlByRows, _\n                  SearchDirection:=xlPrevious).Row\n     MsgBox (\"The Last Row Is: \" &amp; LastRow)\n\n' I am not using this code in the program. It's just there to show\n' what I need to use because it works. I need to make this code work\n'WITH the above block. \n'***********************************************************************\n\n    '  Sets the size of the new array and copies MyAr to it\n    NextCell.Resize(1, UBound(MyAr)).Value = (MyAr)\n\n    '  SUBROUTINE 2 \"Add borders to cells in range\" REMOVED\n    '  SUBROUTINE 3 \"Re-enable Sheet Protection\" REMOVED\n\n       ActiveWorkbook.Save\n       'ActiveWindow.Close\n       Application.ScreenUpdating = True\n\n    MsgBox \"Your Data has been saved to the Log File: \" &amp; vbCrLf &amp; vbCrLf _\n    &amp; \"'Test Log.xls'\", vbInformation, \"Log Save Confirmation\"\n\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1422481837, "creation_date": 1422481837, "answer_id": 28203083, "question_id": 28202869, "link": "https://stackoverflow.com/questions/28202869/printing-a-collection-item-to-immediate-window-in-excel-vba/28203083#28203083", "title": "printing a collection item to immediate window in excel vba", "body": "<p>This seems to work:</p>\n\n<pre><code>Sub ytrewq()\n    Dim c As Collection\n    Set c = New Collection\n    c.Add \"x\", CStr(\"x\")\n    c.Add \"y\", CStr(\"y\")\n    c.Add \"z\", CStr(\"z\")\n    i = 2\n    MsgBox c.Item(i)\n    Debug.Print c.Item(i)\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 424, "user_id": 3913120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/727ab82954f240049d290b6279f34589?s=128&d=identicon&r=PG&f=1", "display_name": "Frank", "link": "https://stackoverflow.com/users/3913120/frank"}, "is_accepted": true, "score": 2, "last_activity_date": 1422508561, "creation_date": 1422508561, "answer_id": 28207477, "question_id": 28202869, "link": "https://stackoverflow.com/questions/28202869/printing-a-collection-item-to-immediate-window-in-excel-vba/28207477#28207477", "title": "printing a collection item to immediate window in excel vba", "body": "<p>To add to @Gary's Student's answer, you can't use integers as keys for a collection. So you either cast them to a string using the Cstr function or you can use a dictionary instead. If you decide to use a dictionary, make sure to enable the Microsoft Scripting Runtime (under tools -> references). I've added some examples below.</p>\n\n<pre><code>    Sub collExample()\n        Dim i As Integer\n        Dim c As Collection\n\n        Set c = New Collection\n        For i = 1 To 10\n            c.Add 2 * i, CStr(i)\n        Next i\n        'keys cant be integers\n        'see https://msdn.microsoft.com/en-us/library/vstudio/f26wd2e5(v=vs.100).aspx\n\n        For i = 1 To 10\n            c.Item (i)\n        Next i\n    End Sub\n\n    Sub dictExample()\n        Dim d As New Dictionary\n        Dim i As Integer\n\n        For i = 1 To 10\n            d(i) = 2 * i\n        Next i\n\n        Dim k As Variant\n        For Each k In d\n            Debug.Print k, d(k)\n        Next k\n\n        Dim coll As New Collection\n        coll.Add \"value1\"\n        coll.Add \"value2\"\n        coll.Add \"value3\"\n\n        Set d(\"list\") = coll\n\n        Dim newCol As Collection\n        Set newCol = d(\"list\")\n\n        Dim v As Variant\n        For Each v In newCol\n            Debug.Print v\n        Next v\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 4504918, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6fcbe6855dc7a523bbb1b4e2c14d7cc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4504918/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13838, "favorite_count": 0, "accepted_answer_id": 28207477, "answer_count": 2, "score": 2, "last_activity_date": 1422508561, "creation_date": 1422480972, "last_edit_date": 1531164843, "question_id": 28202869, "link": "https://stackoverflow.com/questions/28202869/printing-a-collection-item-to-immediate-window-in-excel-vba", "title": "printing a collection item to immediate window in excel vba", "body": "<p>I was wondering how do I print an item in my collection to the immediate window in excel VBA? I want to either have a collection for each collection item or an array for each collection item, which ever is easier to pull information from. Here is some example code of what I'm talking about</p>\n\n<pre><code>Sub test()\n\nDim c As Collection\nDim a As Collection\n\nSet a = New Collection\n\nFor i = 1 To 10\n    Set c = New Collection\n    c.Add Array(\"value1\", \"value2\", \"value3\",\"valvue4, \"value5\"), \"key1\"\n    c.Add \"value2\", \"key2\"\n    c.Add \"value3\", \"key3\"\n    c.Add \"value4, \"key4\"\n    c.Add \"value5\", \"key5\"\n\n    a.Add c, c.Item(1)    \n\n'lets say I wanted to print value4 or value1 from the 1st item\nDebug.Print a.Item(1(2))\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2020, "user_id": 3442153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/hwsHp.jpg?s=128&g=1", "display_name": "K\u1d00\u03c4\u1d22", "link": "https://stackoverflow.com/users/3442153/k%e1%b4%80%cf%84%e1%b4%a2"}, "edited": false, "score": 0, "creation_date": 1422481275, "post_id": 28202674, "comment_id": 44771923, "body": "which sets of the given 30 do you exactly search? Do you have any criterions?"}], "answers": [{"tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 0, "last_activity_date": 1422483778, "last_edit_date": 1422483778, "creation_date": 1422481351, "answer_id": 28202963, "question_id": 28202674, "link": "https://stackoverflow.com/questions/28202674/how-would-i-go-about-searching-for-and-then-importing-values-of-a-known-structu/28202963#28202963", "title": "How would I go about searching for, and then importing values of a known structure from one excel file to another?", "body": "<p>If I understood well, you find yourself in a situation in which you have a uniform set of data that can be in a random position of a column (let's do the example with the column B): </p>\n\n<p><img src=\"https://i.stack.imgur.com/M38gx.png\" alt=\"enter image description here\"></p>\n\n<p>If this is the case, then what you need to do is to find the start and the end point of your range. Which means: </p>\n\n<h2>Find your start point ##:</h2>\n\n<pre><code>Dim startRow As Long: startRow = Range(\"B1\").End(xlDown).Row\n</code></pre>\n\n<h2>Find your end point</h2>\n\n<pre><code>Dim endRow As Long: endRow = Range(\"B\" &amp; startRow).End(xlDown).Row\n</code></pre>\n\n<h2>Select your range</h2>\n\n<pre><code>Range(\"B\" &amp; startRow &amp; \":B\" &amp; endRow).Select\n</code></pre>\n\n<p>The above will select the range <code>B9:B14</code>, but if there were 10 rather than 15 or 20 elements it would have found them as well.</p>\n\n<h2>Looping through the 30+ sets</h2>\n\n<p>@pnuts comment made me realized I had \"partially\" read the question, I report here his comment: </p>\n\n<p><em>I think there may be 30+ instances all in the same two columns - ie maybe as the populated set you show (though possibly 10 rows rather than 6) and then 29+ other such sets, spaced apart by a variable number of blank rows.</em></p>\n\n<p>In that case you should first of all define the last row of the sheet, i.e. </p>\n\n<pre><code>Dim lastRowOfSheet As Long: lastRowOfSheet = Range(\"Z1\").End(xlDown).Row '&lt;-- I assume in column Z there's nothing, please choose it accordingly\n</code></pre>\n\n<p>Hence, you need to Loop through the various datasets until you don't find the last one. which means: </p>\n\n<pre><code>'first static definitions outside the loop\nDim startRow As Long: startRow = Range(\"B1\").End(xlDown).Row\nDim endRow As Long: endRow = Range(\"B\" &amp; startRow).End(xlDown).Row\nDo While endRow &lt;&gt; lastRowOfSheet\n    '************SELECTING THE DATA SET**************\n     Range(\"B\" &amp; startRow &amp; \":B\" &amp; endRow).Select\n     'do what you need to do after having selected the proper range\n     '***********************************************\n     'last re-definition before to loop again\n     startRow = Range(\"B\" &amp; endRow +1).End(xlDown).Row        \n     endRow = Range(\"B\" &amp; startRow).End(xlDown).Row '&lt;-- if this touches the end, it means it was the last dataset so we will go out of the loop\nLoop \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 2016289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebb90d5ee4f005ddc901e8a3e2322002?s=128&d=identicon&r=PG", "display_name": "Mike Noel", "link": "https://stackoverflow.com/users/2016289/mike-noel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1422483778, "creation_date": 1422480270, "question_id": 28202674, "link": "https://stackoverflow.com/questions/28202674/how-would-i-go-about-searching-for-and-then-importing-values-of-a-known-structu", "title": "How would I go about searching for, and then importing values of a known structure from one excel file to another?", "body": "<p>I have an excel file exported from another program with a bunch of data in it. From all of this data, I only need certain pieces of it. The data I need looks like this (with different numbers than 1.111 and 4.444): </p>\n\n<pre><code>C1:  1.111  4.444\nC2:  1.111  4.444\n...\nC10: 1.111  1.111\n</code></pre>\n\n<p>The file has upwards of 30 sets of this data, all contained in columns A to C, except I do not know which rows they start at and end at. What I want to do is search the excel file for this data, and paste it into another file side-by-side (where C1's, C2's, etc. numbers line up in the same row.)</p>\n\n<p>A YouTube tutorial gave me the following code that would be used to grab values at a known location in the file: </p>\n\n<pre><code>Sub ImportFluidData()\nDim FileNames As Variant\nDim i As Integer\nApplication.ScreenUpdating = False\nRange(\"A1\").Select\nFileNames = Applcation.GetOpenFilename(FileFilter:=\"Excel Filter (*Analysis.xlsx), *.xlsx\", Title:=\"Open Files(s)\", MultiSelect:=True)\n\nFor i = 1 To UBound(FileNames)\n    Workbooks.Open FileNames(i)\n    Range(------------------------).Select\n    Selection.Copy\n    Windows(\"Fluid Properties.xlsm\").Activate\n    Selection.PasteSpecial Paste:=xlPasteAll, Transpose:=True\n    Workbooks.Open FileNames(i)\n    ActiveWorkbook.Close SaveChanges:=False\n    ActiveCell.Offset(0, 1).Activate\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>My problem is that instead of a known range, I need to replace <code>Range(-------------).Select</code> with a statement that searches for and selects the data descried above. How would I go about searching for and selecting such data? I quite literally just started using VBA today, so please try to avoid any VBA-specific jargo.</p>\n\n<p>Thanks for the help!</p>\n\n<p>Edit: the tutorial was for importing data at a known spot in multiple files, so that's why it's set up for looping through multiple files. I only need to search through one file, which will likely make the code a lot shorter.</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 4162, "user_id": 362712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yWcUr.jpg?s=128&g=1", "display_name": "Nigel Heffernan", "link": "https://stackoverflow.com/users/362712/nigel-heffernan"}, "edited": false, "score": 1, "creation_date": 1422480819, "post_id": 28202610, "comment_id": 44771702, "body": "Sorry, you&#39;ll have to post your code as text, not a picture. Some of us are in environments where imgur and social media are blocked; some of us are visually-impaired and use a screenreader; some of us are the the kind of people who won&#39;t participate in a discussion that&#39;s set up to exclude visually-impaired people; and some of us won&#39;t look at code we can&#39;t copy-and-paste into a test function..."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 1, "creation_date": 1422481431, "post_id": 28202610, "comment_id": 44772014, "body": "I have deleted my answer being it not what you&#39;re looking for. However, still I suggest you to start looking into the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194819%28v=office.15%29.aspx\" rel=\"nofollow noreferrer\">doc</a>."}, {"owner": {"reputation": 1, "user_id": 4503654, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hzIJ_pWu1Ks/AAAAAAAAAAI/AAAAAAAADKo/SQXgj_B0QK4/photo.jpg?sz=128", "display_name": "angrryscientist", "link": "https://stackoverflow.com/users/4503654/angrryscientist"}, "edited": false, "score": 0, "creation_date": 1422481626, "post_id": 28202610, "comment_id": 44772107, "body": "Thank you very much. I will look into it. I&#39;m very new to VBA and I&#39;m still learning the ways."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1422485916, "post_id": 28202610, "comment_id": 44774020, "body": "You haven&#39;t described the situation very clearly. When you manually open the &quot;main&quot; workbook, you will always be prompted for the password. Are you opening the main workbook manually?"}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 4459381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8b4ff18f1af439a09c5f877db5d196c?s=128&d=identicon&r=PG&f=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/4459381/carl"}, "is_accepted": false, "score": 0, "last_activity_date": 1422489679, "last_edit_date": 1422489679, "creation_date": 1422488062, "answer_id": 28204461, "question_id": 28202610, "link": "https://stackoverflow.com/questions/28202610/open-other-excel-files-with-password-once-main-worksheet-is-opened/28204461#28204461", "title": "Open other Excel files with password once main worksheet is opened", "body": "<p>If you are attempting to open protected worksheets within the workbook your code should be something like this:</p>\n\n<pre><code>Sheets(\"sheet1\").Unprotect \"Your Password\"\n</code></pre>\n\n<p>Otherwise I thought open workbook needs some ()</p>\n\n<pre><code>Workbooks.Open(Filename:= \"file.xls\", Password:=\"ABC\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4503654, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hzIJ_pWu1Ks/AAAAAAAAAAI/AAAAAAAADKo/SQXgj_B0QK4/photo.jpg?sz=128", "display_name": "angrryscientist", "link": "https://stackoverflow.com/users/4503654/angrryscientist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 750, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1422489679, "creation_date": 1422480062, "last_edit_date": 1422483913, "question_id": 28202610, "link": "https://stackoverflow.com/questions/28202610/open-other-excel-files-with-password-once-main-worksheet-is-opened", "title": "Open other Excel files with password once main worksheet is opened", "body": "<p>I'm working with 5 different worksheets. 1 main worksheet and 4 reference worksheets(with links on the main file) which require a password to open. I made a code to open the 4 reference worksheets as soon as the main worksheet is opened but when I did that, it still prompts me to enter the password. What happens now is that the main file + the 4 reference files open right away but the prompt still shows up.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Workbooks.Open Filename:=Worksheets(\"sheet1\").Range(\"j1\") _\n        &amp; Worksheets(\"sheet1\").Range(\"j2\"), Password:=\"*****\"\n    Workbooks.Open Filename:=Worksheets(\"sheet1\").Range(\"j1\") _\n        &amp; Worksheets(\"sheet1\").Range(\"j3\"), Password:=\"*****\"\n    Workbooks.Open Filename:=Worksheets(\"sheet1\").Range(\"j1\") _\n        &amp; Worksheets(\"sheet1\").Range(\"j4\"), Password:=\"*****\"\n    Workbooks.Open Filename:=Worksheets(\"sheet1\").Range(\"j1\") _\n        &amp; Worksheets(\"sheet1\").Range(\"j5\"), Password:=\"*****\"\nEnd Sub\n</code></pre>\n\n<p>And I get this prompt when I open the main file:</p>\n\n<p><img src=\"https://i.imgur.com/kN5Z09e.jpg\" alt=\"\"></p>\n\n<p>What I would like to happen is for the prompt to go away of if there's a VB script to enter the password for the prompt, that'd be okay.</p>\n"}, {"tags": ["vba", "loops", "excel", "copy-paste"], "answers": [{"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 0, "last_activity_date": 1422482848, "creation_date": 1422482848, "answer_id": 28203354, "question_id": 28202581, "link": "https://stackoverflow.com/questions/28202581/copy-and-paste-in-first-blank-row-loop/28203354#28203354", "title": "Copy and Paste in First Blank Row Loop", "body": "<p>You don't need a nested loop. You just need to 1. Something like:</p>\n\n<pre><code>Dim LastRow2 As Long, BlankRow As Long, j As Long\nBlankRow = Sheets(\"Sheet1\").Cells(Rows.Count, \"A\").End(xlUp).Row + 1\nLastRow2 = Sheets(\"Sheet2\").Cells(Rows.Count, \"A\").End(xlUp).Row\nFor j = 2 To LastRow2\n    Sheets(\"Sheet2\").Range(\"A\" &amp; j).Copy\n    Sheets(\"Sheet1\").Range(\"A\" &amp; BlankRow).PasteSpecial xlPasteValues\n    BlankRow = BlankRow + 1\nNext j\nApplication.CutCopyMode = False\n</code></pre>\n\n<p>Is this what you're trying? HTH.</p>\n"}], "owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1568, "favorite_count": 0, "accepted_answer_id": 28203354, "answer_count": 1, "score": 0, "last_activity_date": 1422482848, "creation_date": 1422479937, "last_edit_date": 1422482566, "question_id": 28202581, "link": "https://stackoverflow.com/questions/28202581/copy-and-paste-in-first-blank-row-loop", "title": "Copy and Paste in First Blank Row Loop", "body": "<p>In Sheet 1 I have data in columns. In worksheet 2 I have data that is designated specifically for copying and pasting into the blank rows of Sheet 1. I'm trying to loop the data in Sheet 2 and copy it into Sheet 1 in the following rows (24,25,26,etc.) I'm having trouble with the pasting part. I also need the code to be uniform so that I can modify sheet 2 and run the macro without changing anything. I'm using the code below.</p>\n\n<pre><code>Dim LastRow2 As Long\nDim BlankRow As Long\nBlankRow = Sheets(\"Sheet1\").Cells(Rows.Count, \"A\").End(xlUp).Row + 1\nLastRow2 = Sheets(\"Sheet2\").Cells(Rows.Count, \"A\").End(xlUp).Row\nFor i = BlankRow To 50\n    For j = 2 To LastRow2\n        Sheets(\"Sheet2\").Range(\"A\" &amp; j).Copy\n        Sheets(\"Sheet1\").Range(\"A\" &amp; i).PasteSpecial\n    Next j\nNext i\n</code></pre>\n\n<p>I've placed a very simplified example below as well just to help give an idea of what exactly I'm trying to do.\nThe rows in Sheet 1 are in the thousands in my spreadsheet, and Sheet 2 can get to be around 30. So it's important to me that I loop it using the first blank row in Sheet 1 as the starting point.</p>\n\n<pre>\nSheet 1\n        A\n1       x\n2       x\n3       x\n4       x\n5       x\n6       x\n\n\nSheet 2\n        A\n1       Headings\n2       Tyler\n3       Bill\n4       Rob\n5       Dennis\n</pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 114165, "user_id": 13087, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/260e2731006271646d36705a95c4db48?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/13087/joe"}, "is_accepted": false, "score": 1, "last_activity_date": 1422478291, "creation_date": 1422478291, "answer_id": 28202152, "question_id": 28202074, "link": "https://stackoverflow.com/questions/28202074/offset-resize-range-by-1-less-column/28202152#28202152", "title": "Offset/Resize Range by 1 Less Column", "body": "<pre><code>Dim rng As Range\n...\nSet rng = rng.Resize(rng.Rows.Count, rng.Columns.Count - 1).Offset(0, 1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1422478313, "creation_date": 1422478313, "answer_id": 28202159, "question_id": 28202074, "link": "https://stackoverflow.com/questions/28202074/offset-resize-range-by-1-less-column/28202159#28202159", "title": "Offset/Resize Range by 1 Less Column", "body": "<p>Give this a try:</p>\n\n<pre><code>Sub qwerty()\n    Dim r1 As Range, r2 As Range\n    Set r1 = Range(\"B1:D10\")\n    Set r2 = Intersect(r1, r1.Offset(0, 1))\n    MsgBox r2.Address(0, 0)\nEnd Sub\n</code></pre>\n\n<p>Basically it removes the first column from the block.</p>\n"}, {"comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1422478382, "post_id": 28202162, "comment_id": 44770522, "body": "This would be more versatile for creating ranges within ranges where it isn&#39;t a simple resize of one column such as @Joe suggests."}], "tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": 0, "last_activity_date": 1422478319, "creation_date": 1422478319, "answer_id": 28202162, "question_id": 28202074, "link": "https://stackoverflow.com/questions/28202074/offset-resize-range-by-1-less-column/28202162#28202162", "title": "Offset/Resize Range by 1 Less Column", "body": "<p>This might be clumsy but you could use Range.Range (which returns a location within a given range):</p>\n\n<pre><code>Set StartRng = Range(\"B1:D10\")\nSet FinishRng = Range(StartRng.Range(\"B1\"), StartRng.Range(\"C10\"))\n</code></pre>\n\n<p>or with Range.Cells</p>\n\n<pre><code>Set StartRng = Range(\"B1:D10\")\nSet FinishRng = Range(StartRng.Cells(1, 2), StartRng.Cells(10, 3))\n</code></pre>\n"}], "owner": {"reputation": 431, "user_id": 447175, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/483e8f5d7c97fc6a596dcc2cf2d3b6e2?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/447175/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2253, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1422478717, "creation_date": 1422477931, "last_edit_date": 1422478717, "question_id": 28202074, "link": "https://stackoverflow.com/questions/28202074/offset-resize-range-by-1-less-column", "title": "Offset/Resize Range by 1 Less Column", "body": "<p>In Excel VBA, how do I offset/resize the left column of a range by 1 less?</p>\n\n<p>For instance I start with <code>B1:D10</code> and I need to end up with <code>C1:D10</code>.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 5905, "user_id": 3962346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vrs0W.jpg?s=128&g=1", "display_name": "Jason Faulkner", "link": "https://stackoverflow.com/users/3962346/jason-faulkner"}, "edited": false, "score": 2, "creation_date": 1422477878, "post_id": 28202043, "comment_id": 44770245, "body": "May want to check that <code>findCell</code> is not nothing first."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "reply_to_user": {"reputation": 5905, "user_id": 3962346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vrs0W.jpg?s=128&g=1", "display_name": "Jason Faulkner", "link": "https://stackoverflow.com/users/3962346/jason-faulkner"}, "edited": false, "score": 1, "creation_date": 1422477971, "post_id": 28202043, "comment_id": 44770294, "body": "@JasonFaulkner Happy Now? :-D"}, {"owner": {"reputation": 67, "user_id": 2888590, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ef330d68d9713c8251d1cc3cb6e90edb?s=128&d=identicon&r=PG&f=1", "display_name": "user2888590", "link": "https://stackoverflow.com/users/2888590/user2888590"}, "edited": false, "score": 0, "creation_date": 1422478076, "post_id": 28202043, "comment_id": 44770358, "body": "Thanks; very simple solution!"}], "tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": true, "score": 2, "last_activity_date": 1422477786, "creation_date": 1422477786, "answer_id": 28202043, "question_id": 28201847, "link": "https://stackoverflow.com/questions/28201847/find-specific-cell-and-using-it-to-create-a-range/28202043#28202043", "title": "Find specific Cell and using it to create a range", "body": "<p>You would want to use <code>Offset()</code> again like this: (added check for <code>startTerm</code> not found)</p>\n\n<pre><code>If Not findCell is Nothing Then\n    Set instrumentList = ActiveSheet.Range(findCell, findCell.Offset(x, 0))\nElse\n    MsgBox startTerm &amp; \" Not Found!\"\n    Exit Sub\nEnd If\n</code></pre>\n\n<p>Where <code>x</code> is your arbitrary number of rows down you want to go.</p>\n"}], "owner": {"reputation": 67, "user_id": 2888590, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ef330d68d9713c8251d1cc3cb6e90edb?s=128&d=identicon&r=PG&f=1", "display_name": "user2888590", "link": "https://stackoverflow.com/users/2888590/user2888590"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 28202043, "answer_count": 1, "score": 1, "last_activity_date": 1422477786, "creation_date": 1422477137, "question_id": 28201847, "link": "https://stackoverflow.com/questions/28201847/find-specific-cell-and-using-it-to-create-a-range", "title": "Find specific Cell and using it to create a range", "body": "<p>I am currently searching an excel sheet to find a specific cell:</p>\n\n<pre><code>Set findCell = ActiveSheet.Range(\"D:D\").Find(What:=startTerm).Offset(1, 0)\n</code></pre>\n\n<p>Once I have this cell I want to create a range from that cell downwards an arbitrary number, it doesn't matter now.</p>\n\n<pre><code>Set instrumentList = ActiveSheet.Range(\"findCell:D100\").Cells\n</code></pre>\n\n<p>I cant' seem to figure out the syntax to make this correct. I essentialy just need to find the cell with some specific text and create a range downwards from it, but I just get an application error.</p>\n"}, {"tags": ["excel", "vba", "internet-explorer"], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 3945849, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7833ac512170914014b5022f877dd94a?s=128&d=identicon&r=PG&f=1", "display_name": "excelguigui11", "link": "https://stackoverflow.com/users/3945849/excelguigui11"}, "edited": false, "score": 0, "creation_date": 1422481696, "post_id": 28201526, "comment_id": 44772149, "body": "Didn&#39;t had luck with your suggestion, could you please look at the error I get and how I could get arround it?"}, {"owner": {"reputation": 193, "user_id": 3945849, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7833ac512170914014b5022f877dd94a?s=128&d=identicon&r=PG&f=1", "display_name": "excelguigui11", "link": "https://stackoverflow.com/users/3945849/excelguigui11"}, "edited": false, "score": 0, "creation_date": 1422481882, "post_id": 28201526, "comment_id": 44772249, "body": ".  I get the following error when I tried id.    value_to_copy = IE.Document.getelementbyId(&quot;mainTable&quot;).getelementsbyTagName&zwnj;&#8203;(&quot;txtProject&quot;).inner&zwnj;&#8203;Text          &#39;---------Result:  run time error 438:  Object doesn&#39;t support this property or method`  Any more help you could share?"}], "tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": false, "score": 0, "last_activity_date": 1422476053, "creation_date": 1422476053, "answer_id": 28201526, "question_id": 28201443, "link": "https://stackoverflow.com/questions/28201443/excel-vba-how-to-copy-value-of-a-field-from-internet-explorer/28201526#28201526", "title": "Excel VBA: How to copy value of a field from Internet Explorer", "body": "<p>The <code>Set</code> keyword is used for objects, you have here a variable. Drop <code>Set</code> from assignment statement. <code>value_to_copy = IE.Document.getelementbyId(\"mainTable\").getElementsByTagName(\"txtProject\").innerText</code> </p>\n"}, {"tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 0, "last_activity_date": 1422476070, "creation_date": 1422476070, "answer_id": 28201531, "question_id": 28201443, "link": "https://stackoverflow.com/questions/28201443/excel-vba-how-to-copy-value-of-a-field-from-internet-explorer/28201531#28201531", "title": "Excel VBA: How to copy value of a field from Internet Explorer", "body": "<p>The <code>innerText</code> property returns a <code>String</code> type. Which means, you don't need the keyword <code>Set</code> which is instead used to set a variable as a pointer to a particular object. Strings are native types, so don't use the keyword Set. Try this instead: </p>\n\n<pre><code>'------------THE PROBLEM IS HERE---------------------------\n            value_to_copy = IE.Document.getelementbyId(\"mainTable\").getElementsByTagName(\"txtProject\").innerText\n            '----------VALUE_TO_COPY WILL REMAIN AT \"\" VALUE\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 193, "user_id": 3945849, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7833ac512170914014b5022f877dd94a?s=128&d=identicon&r=PG&f=1", "display_name": "excelguigui11", "link": "https://stackoverflow.com/users/3945849/excelguigui11"}, "edited": false, "score": 0, "creation_date": 1422482058, "post_id": 28201875, "comment_id": 44772332, "body": "Sorry for the poor formating.  I didn&#39;t understand yet how to include code in a comment."}, {"owner": {"reputation": 193, "user_id": 3945849, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7833ac512170914014b5022f877dd94a?s=128&d=identicon&r=PG&f=1", "display_name": "excelguigui11", "link": "https://stackoverflow.com/users/3945849/excelguigui11"}, "edited": false, "score": 0, "creation_date": 1422482103, "post_id": 28201875, "comment_id": 44772357, "body": "I tried the following:  value_to_copy = IE.Document.getelementbyId(txtProject).Value.    I get a  run time error 424:  Object required"}, {"owner": {"reputation": 193, "user_id": 3945849, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7833ac512170914014b5022f877dd94a?s=128&d=identicon&r=PG&f=1", "display_name": "excelguigui11", "link": "https://stackoverflow.com/users/3945849/excelguigui11"}, "edited": false, "score": 0, "creation_date": 1422482144, "post_id": 28201875, "comment_id": 44772377, "body": "And if I try :       value_to_copy = IE.Document.getelementsbyTagName(&quot;txtProject&quot;)(0).Value.      I get a   Run Time Error 91 - Object variable or With block variable not set.  Any help will be greatly  appreciated"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 193, "user_id": 3945849, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7833ac512170914014b5022f877dd94a?s=128&d=identicon&r=PG&f=1", "display_name": "excelguigui11", "link": "https://stackoverflow.com/users/3945849/excelguigui11"}, "edited": false, "score": 0, "creation_date": 1422483645, "post_id": 28201875, "comment_id": 44773086, "body": "Did you actually use <code>IE.Document.getelementbyId(txtProject).Value</code> ? <code>txtProject</code> should be quoted.  And like I said, you can&#39;t use <code>getelementsbyTagName()</code> in this case - you&#39;re not looking for elements by <i>tagname</i>, but by <i>id</i>"}, {"owner": {"reputation": 193, "user_id": 3945849, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7833ac512170914014b5022f877dd94a?s=128&d=identicon&r=PG&f=1", "display_name": "excelguigui11", "link": "https://stackoverflow.com/users/3945849/excelguigui11"}, "edited": false, "score": 0, "creation_date": 1422498743, "post_id": 28201875, "comment_id": 44777696, "body": "Tim you&#39;re my hero!!!  Works like a charm.  Tried so many possibilities that somehow I managed to missed the quotes...    Now I&#39;ll try to manage the rest of my project without bothering you."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1422477224, "creation_date": 1422477224, "answer_id": 28201875, "question_id": 28201443, "link": "https://stackoverflow.com/questions/28201443/excel-vba-how-to-copy-value-of-a-field-from-internet-explorer/28201875#28201875", "title": "Excel VBA: How to copy value of a field from Internet Explorer", "body": "<p>Within a document <code>id</code> should be unique, so you can use that directly:</p>\n\n<pre><code>value_to_copy = IE.Document.getelementbyId(\"txtProject\").Value\n</code></pre>\n\n<p><code>getElementsByTagName()</code> isn't used to locate elements by id, and in any case returns a <em>collection of matches</em>, not a single element, so you can't assign it's return value like that.  This would be how you'd typically use it:</p>\n\n<pre><code>value_to_copy = IE.Document.getelementsbyTagName(\"input\")(0).Value\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 193, "user_id": 3945849, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7833ac512170914014b5022f877dd94a?s=128&d=identicon&r=PG&f=1", "display_name": "excelguigui11", "link": "https://stackoverflow.com/users/3945849/excelguigui11"}, "edited": false, "score": 0, "creation_date": 1422498828, "post_id": 28204420, "comment_id": 44777724, "body": "Tx for your help Tpkaplan.  I tried your suggestion but it didn&#39;t work out.  But thanks anyway for all this information, I&#39;ll keep as a reference for later.  Still have so much to learn about html structure."}], "tags": [], "owner": {"reputation": 172, "user_id": 2635143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94adfabac995bdc7dfa214e14a7836c3?s=128&d=identicon&r=PG", "display_name": "tpkaplan", "link": "https://stackoverflow.com/users/2635143/tpkaplan"}, "is_accepted": false, "score": 0, "last_activity_date": 1422488272, "last_edit_date": 1422488272, "creation_date": 1422487877, "answer_id": 28204420, "question_id": 28201443, "link": "https://stackoverflow.com/questions/28201443/excel-vba-how-to-copy-value-of-a-field-from-internet-explorer/28204420#28204420", "title": "Excel VBA: How to copy value of a field from Internet Explorer", "body": "<p>This is a subtle problem.  In a nutshell, you shouldn't be using the <code>innertext</code> property.  Instead, you want to retrieve the value of the \"value\" <code>node</code>  returned by the <code>childNodes</code> property of the txtProject <code>element</code>.</p>\n\n<p>The data you are retrieving is not actually \"innertext.\"  Innertext would be the text that appears between the opening and closing tags.  From MSDN <a href=\"https://msdn.microsoft.com/en-us/library/ie/ms533899(v=vs.85).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/ie/ms533899(v=vs.85).aspx</a>:</p>\n\n<p><code>The innerText property is valid for block elements only. By definition, elements that do not have both an opening and closing tag cannot have an innerText property.</code></p>\n\n<p>For example, in the following snippet:</p>\n\n<pre><code>&lt;h1&gt;Header Text&lt;/h1&gt;\n</code></pre>\n\n<p>The innertext of the <code>&lt;h1&gt;</code> tag is \"Header text\"</p>\n\n<p>In your snippet, the tag does not actually have any inner text.  You have a td element with attributes but nothing between the <code>&lt;td...&gt;</code> and the <code>&lt;/td&gt;</code>:</p>\n\n<pre><code>&lt;td width=\"152\"&gt;&lt;input name=\"txtProject\" tabindex=\"2\" id=\"txtProject\"\naccesskey=\"J\" language=\"javascript\" \nonkeypress=\"return LookupButton(event,'lnkBtnProject')\" \nonchange=\"__doPostBack('txtProject','')\" type=\"text\"\n value=\"0000001\"&gt;&lt;/td&gt;'\n</code></pre>\n\n<p>That's why the innertext property fails.  Your snippet, <code>getElementsByTagName(\"txtProject\")</code> returns an <code>Element</code> object.  Elements are collections of  <code>nodes</code>.  Your element has nodes named <code>name</code>, <code>tabindex</code>, <code>id</code>, <code>accesskey</code>, <code>language</code>, <code>onkeypress</code>, <code>onchange</code>, <code>type</code> and <code>value</code>.  Each of these nodes has a value associated with it.  You need to access the <code>value</code> node and query its value.</p>\n\n<p>I suspect the following will work, or something like it.  </p>\n\n<pre><code>set txtProject = IE.Document.getelementbyID(\"mainTable\").getElementsByTagName(\"txtProject\")\n    ' returns a `&lt;td..&gt;&lt;/td&gt;` element\n\nvalue_to_copy = txtProject.childNodes(\"value\")\n    'Should return the default property of the node \"value\".  \n    'The default property should be the string \"00000001\".  \n    'But I'm not sure so you might want to do more \n    'research on `childNodes` and `nodes`\n</code></pre>\n\n<p>or alternatively, but less intuitive:</p>\n\n<pre><code>value_to_copy = IE.Document.getelementbyID(\"mainTable\") _\n                           .getElementsByTagName(\"txtProject\") _\n                           .childNodes(\"value\")\n</code></pre>\n\n<p>I adapted this from the following code snippet on <a href=\"https://msdn.microsoft.com/en-us/library/ms757053(v=vs.85).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/ms757053(v=vs.85).aspx</a>.   So if my suggestion above doesn't work, maybe this will help.</p>\n\n<p><code>The following script example uses the childNodes property (collection) to return an IXMLDOMNodeList, and then iterates through the collection, displaying the value of each item's xml property.</code></p>\n\n<pre><code>root = xmlDoc.documentElement;\noNodeList = root.childNodes;\nfor (var i=0; i&lt;oNodeList.length; i++) {\n  Item = oNodeList.item(i);\n  WScript.Echo(Item.xml);\n  }\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 3945849, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7833ac512170914014b5022f877dd94a?s=128&d=identicon&r=PG&f=1", "display_name": "excelguigui11", "link": "https://stackoverflow.com/users/3945849/excelguigui11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6341, "favorite_count": 0, "accepted_answer_id": 28201875, "answer_count": 4, "score": 0, "last_activity_date": 1422488272, "creation_date": 1422475791, "last_edit_date": 1422477138, "question_id": 28201443, "link": "https://stackoverflow.com/questions/28201443/excel-vba-how-to-copy-value-of-a-field-from-internet-explorer", "title": "Excel VBA: How to copy value of a field from Internet Explorer", "body": "<p>I'm trying to access a form on internet explorer, then copy value of some fields (that I know there name and id) and the copy those value in a an Excel sheet.  That's the simplify version of what I'm trying to do.  So right now I'm able to open my web page, then open the subform that is included in it.  But when I get to copying the value of the field I'm interested in.  I'm not able to set the variable so I can then copy it back to Excel.<br>\nHere's my code below.  My problem between comments.  </p>\n\n<pre><code>Private Sub Open_multiple_sub_pages_from_main_page()\n\n    Dim i As Long\n    Dim IE As Object\n    Dim Doc As Object\n    Dim objElement As Object\n    Dim objCollection As Object\n\n    ' Create InternetExplorer Object\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n\n    ' You can uncoment Next line To see form results\n    IE.Visible = True\n\n    ' Send the form data To URL As POST binary request\n    IE.navigate \"http://webpage.com/\"\n\n    ' Wait while IE loading...\n    While IE.Busy\n            DoEvents\n    Wend\n\n    Set objCollection = IE.Document.getElementsByTagName(\"input\")\n\n    i = 0\n    While i &lt; objCollection.Length\n        If objCollection(i).Name = \"txtUserName\" Then\n\n            ' Set text for search\n            objCollection(i).Value = \"1234\"\n        End If\n        If objCollection(i).Name = \"txtPwd\" Then\n\n            ' Set text for search\n            objCollection(i).Value = \"password\"\n        End If\n\n        If objCollection(i).Type = \"submit\" And objCollection(i).Name = \"btnSubmit\" Then ' submit button if found and set\n            Set objElement = objCollection(i)\n        End If\n        i = i + 1\n    Wend\n    objElement.Click    ' click button to load page\n\n    ' Wait while IE re-loading...\n    While IE.Busy\n            DoEvents\n    Wend\n\n    ' Show IE\n    IE.Visible = True\n    Set Doc = IE.Document\n\n    Dim links, link, value_to_copy\n\n    Dim j As Integer                                                                    'variable to count items\n    j = 0\n    Set links = IE.Document.getelementbyId(\"dgTime\").getElementsByTagName(\"a\")\n    n = links.Length\n    While j &lt;= n                                    'loop to go thru all \"a\" item so it loads next page\n        links(j).Click\n        While IE.Busy\n            DoEvents\n        Wend\n        '------------THE PROBLEM IS HERE---------------------------\n        Set value_to_copy = IE.Document.getelementbyId(\"mainTable\").getElementsByTagName(\"txtProject\").innerText\n        '----------VALUE_TO_COPY WILL REMAIN AT \"\" VALUE\n\n        IE.Document.getelementbyId(\"DetailToolbar1_lnkBtnSave\").Click              'save\n        Do While IE.Busy\n            Application.Wait DateAdd(\"s\", 1, Now)                                   'wait\n        Loop\n        IE.Document.getelementbyId(\"DetailToolbar1_lnkBtnCancel\").Click            'close\n        Do While IE.Busy\n            Application.Wait DateAdd(\"s\", 1, Now)                                   'wait\n        Loop\n        Set links = IE.Document.getelementbyId(\"dgTime\").getElementsByTagName(\"a\")\n        j = j + 2\n    Wend\nEnd Sub\n</code></pre>\n\n<p>Below is the html code of the page from wich I'm trying to retrieve the \"txtProject\" value.  In that particular case the value is \"0000001\".  That's the value I need to copy. </p>\n\n<pre><code>&lt;table width=\"100%\" class=\"Form\" id=\"mainTable\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"&gt;\n    &lt;tbody&gt;&lt;tr id=\"TRCustomer\"&gt;\n        &lt;td class=\"titleLabel\"&gt;&lt;span id=\"lblCustomer\"&gt;\n&lt;u&gt;C&lt;/u&gt;lient : &lt;/span&gt;&lt;/td&gt;\n&lt;td&gt;&lt;input name=\"txtCustomer\" id=\"txtCustomer\" accesskey=\"C\"\n   language=\"javascript\" onchange=\"__doPostBack('txtCustomer','')\"  \n   type=\"text\"&gt;&lt;/td&gt;\n&lt;td&gt;&lt;a class=\"Button\" id=\"lnkBtnCustomer\" href=\"javascript:__doPostBack('lnkBtnCustomer','')\"&gt;\n&lt;img id=\"imgCustomer\" alt=\"\" src=\"images/toolbar/b_preview.gif\"  \n   border=\"0\"&gt;&lt;/a&gt;&lt;/td&gt;\n&lt;td class=\"tdDescriptionLabel\"&gt;&lt;span class=\"DescriptionLabel\" \n    id=\"lblCustomerDescription\"&gt;&amp;nbsp;&lt;/span&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n&lt;tr id=\"TRProject\"&gt;\n&lt;td width=\"110\" class=\"titleLabel\"&gt;\n  &lt;span id=\"lblProject\"&gt;Pro&lt;u&gt;j&lt;/u&gt;et : &lt;/span&gt;&lt;/td&gt;\n&lt;td width=\"152\"&gt;&lt;input name=\"txtProject\" tabindex=\"2\" id=\"txtProject\"\n    accesskey=\"J\" language=\"javascript\" \n    onkeypress=\"return LookupButton(event,'lnkBtnProject')\" \n    onchange=\"__doPostBack('txtProject','')\" type=\"text\"\n     value=\"0000001\"&gt;&lt;/td&gt;\n&lt;td width=\"20\"&gt;&lt;a class=\"Button\" id=\"lnkBtnProject\" \n    href=\"javascript:__doPostBack('lnkBtnProject','')\"&gt;\n    &lt;img id=\"imgProject\" alt=\"\" src=\"images/toolbar/b_preview.gif\"\n    border=\"0\"&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class=\"tdDescriptionLabel\"&gt;\n   &lt;span class=\"DescriptionLabel\" \n</code></pre>\n\n<p>Any help will be greatly appreciated.<br>\nTx in advance.</p>\n"}, {"tags": ["vba", "excel", "cell"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4504655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c52d365cb16c198c2e97ee9c0de0258?s=128&d=identicon&r=PG&f=1", "display_name": "Lionel", "link": "https://stackoverflow.com/users/4504655/lionel"}, "edited": false, "score": 0, "creation_date": 1422479434, "post_id": 28201469, "comment_id": 44771045, "body": "I&#39;m sorry, I misstated.  Terrible, the two cells are supposed to be pointing to a formula.  I should have stated that Range(&quot;A&quot;) is supposed to equal B1-C1 or something, and then CellA is based off B1-C1.  This is why I have to use Set."}, {"owner": {"reputation": 13, "user_id": 4504655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c52d365cb16c198c2e97ee9c0de0258?s=128&d=identicon&r=PG&f=1", "display_name": "Lionel", "link": "https://stackoverflow.com/users/4504655/lionel"}, "edited": false, "score": 0, "creation_date": 1422484223, "post_id": 28201469, "comment_id": 44773342, "body": "Actually, your solution is perfect!  Thank you.  The .value function is exactly what I needed.  Again, sorry for being an excel noob."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 13, "user_id": 4504655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c52d365cb16c198c2e97ee9c0de0258?s=128&d=identicon&r=PG&f=1", "display_name": "Lionel", "link": "https://stackoverflow.com/users/4504655/lionel"}, "edited": false, "score": 0, "creation_date": 1422484784, "post_id": 28201469, "comment_id": 44773570, "body": "@Lionel you don&#39;t have to feel sorry, nobody knows things before to learn them.. good luck with your project and don&#39;t hesitate to ask on SO if you&#39;re stuck with a specific piece of code and your own researches did not yield the expected result!"}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 2, "last_activity_date": 1422476201, "last_edit_date": 1422476201, "creation_date": 1422475874, "answer_id": 28201469, "question_id": 28201375, "link": "https://stackoverflow.com/questions/28201375/how-to-maintain-a-range-definition-in-excel-vba-after-underlying-cell-changes/28201469#28201469", "title": "How to maintain a range definition in excel vba after underlying cell changes?", "body": "<p>No, it's clearly not possible, I'll try to explain you why. \nIn this piece of code, you are saying: </p>\n\n<pre><code>Dim CellA As Range '&lt;-- CellA will be an object of type \"Range\"\nSet CellA = Range(\"A1\") '&lt;-- CellA will point to the Range(\"A1\")\n</code></pre>\n\n<p>This means that, no matter what, <code>CellA</code> will always be pointing to <code>Range(\"A1\")</code>. So, when you change:</p>\n\n<pre><code>Range(\"A1\") = 50 '&lt;-- please note: when you write this, you're \"implicitely\" writing Range(\"A1\").Value = 50. The \".Value\" is in fact the default property of the range object (if you don't specify anything, you will set that one). \n</code></pre>\n\n<p>... the value of <code>CellA</code> will be the value of <code>Range(\"A1\")</code>, which is <em>exactly</em> what you told it to be when saying <code>Set CellA = Range(\"A1\")</code>.</p>\n\n<p>If you want to store the <em>value</em> (and not the Range object, as you're doing now), and not the whole range object, then you should do this: </p>\n\n<pre><code>Dim CellA As Long\nCellA = Range(\"A1\").Value\n</code></pre>\n\n<p>Even if the value of <code>Range(\"A1\")</code> will change later in run-time, the value of <code>CellA</code> will still be the old one. </p>\n\n<p>And this is surely what you want to do, because you don't care about the whole range object but only about its value: do you? </p>\n"}], "owner": {"reputation": 13, "user_id": 4504655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c52d365cb16c198c2e97ee9c0de0258?s=128&d=identicon&r=PG&f=1", "display_name": "Lionel", "link": "https://stackoverflow.com/users/4504655/lionel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 28201469, "answer_count": 1, "score": 0, "last_activity_date": 1422900193, "creation_date": 1422475509, "last_edit_date": 1422900193, "question_id": 28201375, "link": "https://stackoverflow.com/questions/28201375/how-to-maintain-a-range-definition-in-excel-vba-after-underlying-cell-changes", "title": "How to maintain a range definition in excel vba after underlying cell changes?", "body": "<p>Excel noob here (sorry).  My macro runs like this:</p>\n\n<pre><code>Dim CellA, CellB As Range\nRange(\"A1\") = 25\nSet CellA = Range(\"A1\")\nRange(\"A1\") = 50\nSet CellB = Range(\"A1\")\n</code></pre>\n\n<p>The problem is after this, <code>CellA</code> also will be equal to <code>50</code>.  </p>\n\n<p>Is it possible to adjust the code to keep <code>CellA</code> as <code>25</code> but still use A1 as the source?</p>\n"}, {"tags": ["google-chrome", "excel", "plugins", "box", "vba"], "comments": [{"owner": {"reputation": 23, "user_id": 2250736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34249e8ffee0891470484f1f590969cd?s=128&d=identicon&r=PG", "display_name": "eddiezeiter", "link": "https://stackoverflow.com/users/2250736/eddiezeiter"}, "edited": false, "score": 0, "creation_date": 1422563931, "post_id": 28201362, "comment_id": 44811333, "body": "Just a heads up.  I figured out a work around.  I wrote a macro to enable box.com plugin prior to going to grab my file from box.com.  An extra layer, but it&#39;ll work for now."}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 2250736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34249e8ffee0891470484f1f590969cd?s=128&d=identicon&r=PG", "display_name": "eddiezeiter", "link": "https://stackoverflow.com/users/2250736/eddiezeiter"}, "is_accepted": true, "score": 0, "last_activity_date": 1422564543, "creation_date": 1422564543, "answer_id": 28224315, "question_id": 28201362, "link": "https://stackoverflow.com/questions/28201362/accessing-box-com-excel-spreadsheet-through-google-chrome-popup-plugin-blocker/28224315#28224315", "title": "Accessing box.com excel spreadsheet through google Chrome. PopUp Plugin blocker", "body": "<p>I figured out a workaround and added to my code. (below)</p>\n\n<pre><code>selenium.Start \"chrome\", \"Chrome://plugins\"\nselenium.setTimeout (\"120000\")\nselenium.setImplicitWait (5000)\nselenium.Open \"\"\nselenium.clickAndWait \"id=npBoxEdit.dll-always-allowed\"\nApplication.SendKeys \"^l\", True\nDoEvents\nApplication.SendKeys \"https://box.com/files/0/f/\"\nApplication.SendKeys \"{Return}\"\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 2250736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34249e8ffee0891470484f1f590969cd?s=128&d=identicon&r=PG", "display_name": "eddiezeiter", "link": "https://stackoverflow.com/users/2250736/eddiezeiter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 28224315, "answer_count": 1, "score": 0, "last_activity_date": 1422564543, "creation_date": 1422475484, "last_edit_date": 1531161705, "question_id": 28201362, "link": "https://stackoverflow.com/questions/28201362/accessing-box-com-excel-spreadsheet-through-google-chrome-popup-plugin-blocker", "title": "Accessing box.com excel spreadsheet through google Chrome. PopUp Plugin blocker", "body": "<p>I am trying to automate opening up a spreadsheet from box.com through a button on excel.  The code executes which is below, however when the code tries to press the \"box edit\" button(little pencil graphic) Google Chrome blocks \"Box Edit\" from opening the spreadsheet.  I have tried the normal course of getting rid of the pop up blocker ie \"Always allow popups from this site\" \"entering box.com under settings in chrome\".  Outside of the code when I manually pull box it reads that box.com is allowed, but for some reason when the code executes it's like it is opening up a new chrome with original settings, therefore blocking the plugin.  I apologize in advance for sendkeys, not well versed with selenium add-in for excel.  Please help, literally the code executes as it is supposed to, but the popup blocker won't allow the spreadsheet to download.  THANK YOU!</p>\n\n<pre><code>Sub openChrome()\nDim selenium As New SeleniumWrapper.WebDriver\nDim GC As Object\nDim intRowRowPosition As Integer\nDim keys As New SeleniumWrapper.keys\n\nselenium.Start \"chrome\", \"https://box.com/files/0/f/*********\"\nselenium.setTimeout (\"120000\")\nselenium.setImplicitWait (5000)\n\nselenium.Open \"\"\nApplication.Wait (Now + TimeValue(\"00:00:03\"))\nSendKeys \"emailaddress\", True\nApplication.SendKeys \"{Tab}\"\nDoEvents\nApplication.Wait (Now + TimeValue(\"00:00:03\"))\nSendKeys \"password\", True\nApplication.SendKeys \"{Return}\"\nDoEvents\nApplication.SendKeys (\"{NUMLOCK}\")\nApplication.Wait (Now + TimeValue(\"00:00:05\"))\n\nselenium.clickAndWait \"id=preview_header_edit_btn\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1422476949, "post_id": 28201175, "comment_id": 44769725, "body": "Why are you using an autofilter? Is there only one matching entry on the sheet <code>Stock</code>?"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 1, "creation_date": 1422477579, "post_id": 28201175, "comment_id": 44770099, "body": "Questions with working code are usually off-topic and might be better suited for CodeReview SE."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1422477900, "post_id": 28201175, "comment_id": 44770255, "body": "If this your code works as intended, only in a painfully slow way, indeed the folks over at CodeReview.SE will be happy to help you make it better, cleaner and more efficient :)"}, {"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 2, "creation_date": 1422478872, "post_id": 28201175, "comment_id": 44770756, "body": "Voted to close with &quot;This question belongs on <a href=\"http://codereview.stackexchange.com/\">Code Review</a>.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 3132, "user_id": 4385647, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/V3X9c.png?s=128&g=1", "display_name": "Dirk Horsten", "link": "https://stackoverflow.com/users/4385647/dirk-horsten"}, "edited": false, "score": 0, "creation_date": 1422478403, "post_id": 28201407, "comment_id": 44770531, "body": "Good idea  to use xlCellTypeVisible. You best use it with <code>Sheets(&quot;Stock&quot;).Range(&quot;$A$2:$X$5000&quot;).SpecialCells(xlCellTyp&zwnj;&#8203;eVisible).Rows(1)</code> to find the desired row"}], "tags": [], "owner": {"reputation": 1918, "user_id": 3929829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cceip.jpg?s=128&g=1", "display_name": "Captain", "link": "https://stackoverflow.com/users/3929829/captain"}, "is_accepted": false, "score": 1, "last_activity_date": 1422475636, "creation_date": 1422475636, "answer_id": 28201407, "question_id": 28201175, "link": "https://stackoverflow.com/questions/28201175/make-code-more-efficient-or-quicker/28201407#28201407", "title": "Make code more efficient or quicker", "body": "<p>Two things...</p>\n\n<p>Firstly, there is a method on a range to do <code>.SpecialCells(xlCellTypeVisible)</code>. You can loop through this and work only with the visible cells.</p>\n\n<p>Secondly, get rid of <code>Select</code> and <code>Selection</code> - it is bad practice and slow. For example, refer to things like <code>Sheets(\"JDW\").Range(\"C20\")</code> and rather than use the copy/paste buffer you could do things like <code>Sheets(\"Stock\").Cells(1,2).Value = Sheets(\"JDW\").Range(\"C20\").value</code> to put a value in directly...</p>\n"}, {"tags": [], "owner": {"reputation": 3132, "user_id": 4385647, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/V3X9c.png?s=128&g=1", "display_name": "Dirk Horsten", "link": "https://stackoverflow.com/users/4385647/dirk-horsten"}, "is_accepted": false, "score": 1, "last_activity_date": 1422478716, "last_edit_date": 1422478716, "creation_date": 1422477297, "answer_id": 28201901, "question_id": 28201175, "link": "https://stackoverflow.com/questions/28201175/make-code-more-efficient-or-quicker/28201901#28201901", "title": "Make code more efficient or quicker", "body": "<ul>\n<li>Don't select other ranges all the time: You can get values, copy or paste without changing the selection.</li>\n<li>Loop through the rows instead of through the cells, do you don't have to apply the EntireRow function</li>\n<li>Avoid taking the wrong address first and then using .Offset to go to the right one</li>\n<li>If you just need to copy a value, do not copy the cell. Read the value from the source and write it to the destination.</li>\n</ul>\n\n<p>This reduces the code to</p>\n\n<pre><code>Sheets(\"Stock\").Range(\"$A$1:$X$5000\").AutoFilter _\n    field:=1, Criteria1:=Worksheets(\"JDW\").Range(\"C4\").Value\n\nDim StockRow as range\nSet StockRow = Sheets(\"Stock\").Rows(2)\nDo Until StockRow.Hidden = False\n    Set StockRow = StockRow.Offset(RowOffset:=1)\nLoop\nStockRow.Cells(1,17).Value = Sheets(\"JDW\").Range(\"C20\").Value\nStockRow.Cells(1,19).Value = Sheets(\"JDW\").Range(\"A1\").Value\n\nSheet(\"Stock\").Range(\"$A$1:$X$5000\").AutoFilter field:=1\n\nSheets(\"JDW\").Range(\"C20\").ClearContents\n</code></pre>\n\n<p><em>(Not tested because I don't have the context)</em></p>\n\n<p>But actually you can do even better with</p>\n\n<pre><code>Dim StockRow as range, stockKey as variant\nstockKey = Sheets(\"JDW\").Range(\"C4\").Value\nSet StockRow = Sheets(\"Stock\").Columns(1).Find(stockKey, LookAt:=xlWhole)\n...\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4504611, "user_type": "registered", "profile_image": "https://graph.facebook.com/505254779/picture?type=large", "display_name": "John Walker", "link": "https://stackoverflow.com/users/4504611/john-walker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "closed_date": 1422533572, "answer_count": 2, "score": 0, "last_activity_date": 1422478716, "creation_date": 1422474817, "question_id": 28201175, "link": "https://stackoverflow.com/questions/28201175/make-code-more-efficient-or-quicker", "closed_reason": "Not suitable for this site", "title": "Make code more efficient or quicker", "body": "<p>Hi I've been using various bits of code to help me get to where I need.</p>\n\n<p>The spreadsheet updates the quantity of a stock item in a main table (worksheet \"Stock\") with a value from \"JDW\" worksheet.</p>\n\n<p>The VBA Code filters the main table to find the correct part number based on an input on the JDW worksheet.</p>\n\n<p>The code then loops until it finds the first row that is NOT \"hidden\" by the filter. This is the bit that takes ages - an offset only moved it to row 2 not row \"x\" - this could be anything from row 2 to 5000.</p>\n\n<p>The code then offsets to the correct cell, copies pastes, and then offsets again and copies the date and pastes the date value in to the next cell (adds date to a column titled \"Last updated\")</p>\n\n<p>The code then clears the input form of the data as a basic \"reset\".</p>\n\n<p>Any suggestions?</p>\n\n<pre><code> Range(\"C4\").Select\n    Selection.Copy\n    Sheets(\"Stock\").Select\n    ActiveSheet.Range(\"$A$1:$X$5000\").AutoFilter field:=1, Criteria1:=Worksheets(\"JDW\").Range(\"C4\").Value\n    Range(\"A1\").Select\n    ActiveCell.Offset(1, 0).Activate\n    Do Until Selection.EntireRow.Hidden = False\n    If Selection.EntireRow.Hidden = True Then\n    ActiveCell.Offset(1, 0).Activate\n    End If\n    Loop\n    Selection.Offset(0, 16).Select\n    Sheets(\"JDW\").Select\n    Range(\"C20\").Select\n    Selection.Copy\n    Sheets(\"Stock\").Select\n    ActiveSheet.Paste\n    Selection.Offset(0, 2).Select\n    Sheets(\"JDW\").Select\n    Range(\"A1\").Select\n    Selection.Copy\n    Sheets(\"Stock\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    ActiveSheet.Range(\"$A$1:$X$5000\").AutoFilter field:=1\n    Sheets(\"JDW\").Select\n    Range(\"C20\").Select\n    Selection.ClearContents\n</code></pre>\n"}, {"tags": ["excel", "formatting", "vba"], "comments": [{"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 2, "creation_date": 1422471388, "post_id": 28200161, "comment_id": 44766572, "body": "Is one of your keys stuck on your keyboard?"}, {"owner": {"reputation": 2424, "user_id": 4415734, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/x6QKy.png?s=128&g=1", "display_name": "Callum Watkins", "link": "https://stackoverflow.com/users/4415734/callum-watkins"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1422472127, "post_id": 28200161, "comment_id": 44766976, "body": "@Gary&#39;sStudent The value is 9 as it should be. Whereas it displays 99999...."}, {"owner": {"reputation": 6712, "user_id": 122139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24cd8afa32a0e16b095a5348f6b772b?s=128&d=identicon&r=PG", "display_name": "Smandoli", "link": "https://stackoverflow.com/users/122139/smandoli"}, "reply_to_user": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 2, "creation_date": 1422472642, "post_id": 28200161, "comment_id": 44767281, "body": "It should be very easy to eliminate VBA as the issue, if you know how to trouble shoot VBA.  That leaves corruption, OR a format issue (not that I can imagine it, but take steps to rule it out), or the @peege effect."}, {"owner": {"reputation": 1442, "user_id": 4115522, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/KR2bz.jpg?s=128&g=1", "display_name": "Reenactor Rob", "link": "https://stackoverflow.com/users/4115522/reenactor-rob"}, "edited": false, "score": 0, "creation_date": 1422473428, "post_id": 28200161, "comment_id": 44767752, "body": "I would write      if Cells(i, &quot;F&quot;).value &lt; 2"}], "answers": [{"comments": [{"owner": {"reputation": 2424, "user_id": 4415734, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/x6QKy.png?s=128&g=1", "display_name": "Callum Watkins", "link": "https://stackoverflow.com/users/4415734/callum-watkins"}, "edited": false, "score": 1, "creation_date": 1422472811, "post_id": 28200587, "comment_id": 44767379, "body": "Great call! Thanks this solved the issue, I mistakenly had it on fill."}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": true, "score": 5, "last_activity_date": 1422472699, "creation_date": 1422472699, "answer_id": 28200587, "question_id": 28200161, "link": "https://stackoverflow.com/questions/28200161/excel-displaying-infinitely-repeated-value-in-cell/28200587#28200587", "title": "Excel displaying infinitely repeated value in cell", "body": "<p>I think you have formatted the cell with Horizontal: alignment <code>Fill</code>.</p>\n"}], "owner": {"reputation": 2424, "user_id": 4415734, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/x6QKy.png?s=128&g=1", "display_name": "Callum Watkins", "link": "https://stackoverflow.com/users/4415734/callum-watkins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 28200587, "answer_count": 1, "score": 2, "last_activity_date": 1532030617, "creation_date": 1422471252, "last_edit_date": 1532030617, "question_id": 28200161, "link": "https://stackoverflow.com/questions/28200161/excel-displaying-infinitely-repeated-value-in-cell", "title": "Excel displaying infinitely repeated value in cell", "body": "<p>My Excel spreadsheet contains a column whose rows can contain the value <code>0</code>, <code>1</code> or <code>2</code>. My VBA code sums the number of <code>0</code>s (specifically, values that aren't <code>1</code> or <code>2</code>) and puts the count into the cell below. This seems to run fine, as the value of the cell at the end is equal to the number of <code>0</code>s as it should, however the numbers are displayed like this (should be just <code>9</code>):</p>\n\n<p><img src=\"https://i.stack.imgur.com/jEKfD.png\" alt=\"Infinite Numbers\"></p>\n\n<p>The numbers repeat infinitely.</p>\n\n<p>My VBA code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Intersect(Target, Range(\"F22\")) Is Nothing And Not Intersect(Target, Range(\"F4:F21\")) Is Nothing Then\n        Dim count As Integer\n        For i = 4 To 21:\n            If Not Cells(i, \"F\").Value = 1 And Not Cells(i, \"F\").Value = 2 Then\n                count = count + 1\n            End If\n        Next i\n        Cells(22, \"F\").Value = count\n    End If\nEnd Sub\n</code></pre>\n\n<p>Is this a VBA problem or is my document incorrectly formatted?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 3, "last_activity_date": 1422472033, "creation_date": 1422472033, "answer_id": 28200401, "question_id": 28200039, "link": "https://stackoverflow.com/questions/28200039/how-to-check-if-closing-the-excel-workbook-vba/28200401#28200401", "title": "how to check if closing the excel (workbook) vba", "body": "<p>Open the VBA Editor, then go on <code>ThisWorkbook</code> (in the project tree on the left-side of the IDE) and you will access the code of the workbook events. </p>\n\n<p>Then, from the dropdown list on the right-top select the event <code>BeforeClose</code> after having selected the <code>Workbook</code> object in the left-top dropdown menu, and you will get the following code on the module:</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n\nEnd Sub\n</code></pre>\n\n<p>That macro will be called every time someone tries to close the Workbook.\nThere, you can put a global variable to control the action, something like: </p>\n\n<pre><code>someoneIsClosing = True '&lt;-- this is a globally defined variable\nCancel = True '&lt;-- if you want to cancel the closing action\nmyMacro '&lt;-- if you want to go back to \"myMacro\", i.e. any macro of your project and delegate it from handling the event.\n</code></pre>\n"}], "owner": {"reputation": 122, "user_id": 3927479, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1530053714/picture?type=large", "display_name": "Omer Cohen", "link": "https://stackoverflow.com/users/3927479/omer-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 729, "favorite_count": 1, "accepted_answer_id": 28200401, "answer_count": 1, "score": 1, "last_activity_date": 1476299848, "creation_date": 1422470883, "last_edit_date": 1476299848, "question_id": 28200039, "link": "https://stackoverflow.com/questions/28200039/how-to-check-if-closing-the-excel-workbook-vba", "title": "how to check if closing the excel (workbook) vba", "body": "<p>I'm looking for a code that can return a <code>boolean</code> <code>0</code>,<code>1</code> or <code>true</code> or <code>false</code>, so that it can recognise if someone closes the excel by clicking on X</p>\n"}, {"tags": ["sql", "vba", "ms-access", "ms-access-2010"], "comments": [{"owner": {"reputation": 20094, "user_id": 1832636, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/03182c8b98caa6f9af95e4f4afd7c018?s=128&d=identicon&r=PG", "display_name": "Dan Bracuk", "link": "https://stackoverflow.com/users/1832636/dan-bracuk"}, "edited": false, "score": 0, "creation_date": 1422473235, "post_id": 28199777, "comment_id": 44767641, "body": "I prefer the most efficient method.  I determine that by trying both."}, {"owner": {"reputation": 705, "user_id": 4163002, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/30e77d3fa90ca3c96cf94a3fca4614ee?s=128&d=identicon&r=PG&f=1", "display_name": "ZX9", "link": "https://stackoverflow.com/users/4163002/zx9"}, "reply_to_user": {"reputation": 20094, "user_id": 1832636, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/03182c8b98caa6f9af95e4f4afd7c018?s=128&d=identicon&r=PG", "display_name": "Dan Bracuk", "link": "https://stackoverflow.com/users/1832636/dan-bracuk"}, "edited": false, "score": 0, "creation_date": 1422477179, "post_id": 28199777, "comment_id": 44769872, "body": "@DanBracuk My current solution involves a combination of both methods, actually, which works best for me for various reasons. I was attempting to see if there&#39;s any more technical reason for one over the other, as well as providing a place for others who may have this question (but have not necessarily put as much effort into researching it) to go."}, {"owner": {"reputation": 752, "user_id": 2469070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e1fb1c1014c526fe833fe05e589036?s=128&d=identicon&r=PG", "display_name": "dennythecoder", "link": "https://stackoverflow.com/users/2469070/dennythecoder"}, "edited": false, "score": 1, "creation_date": 1422495392, "post_id": 28199777, "comment_id": 44776845, "body": "I wonder if JET/ACE goes to check the form each time a tuple is tested against the WHERE [field] = FormValue...  I would stick to the VBA on this one and comment liberally throughout your code."}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1422557512, "post_id": 28199777, "comment_id": 44807710, "body": "I had thought of that originally too, but you would think that the time for a query within access to get something from a form, wouldn&#39;t be much longer than for VBA to go and get something from a form.  Hard to say really perhaps ZX9 can come back in the future and let us know once they run into larger queries. ."}], "answers": [{"comments": [{"owner": {"reputation": 705, "user_id": 4163002, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/30e77d3fa90ca3c96cf94a3fca4614ee?s=128&d=identicon&r=PG&f=1", "display_name": "ZX9", "link": "https://stackoverflow.com/users/4163002/zx9"}, "edited": false, "score": 0, "creation_date": 1422553114, "post_id": 28199953, "comment_id": 44805196, "body": "My initial testing indicates the difference is minimal, as you predicted. However, I will (eventually) continue testing as some of my queries reference a substantial amount of information and the time required may be significant."}], "tags": [], "owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "is_accepted": true, "score": 1, "last_activity_date": 1422470548, "last_edit_date": 1495541646, "creation_date": 1422470548, "answer_id": 28199953, "question_id": 28199777, "link": "https://stackoverflow.com/questions/28199777/access-dynamic-query-better-to-build-one-conditional-sql-query-or-multiple-que/28199953#28199953", "title": "Access dynamic query - Better to build one conditional SQL query or multiple queries with VBA?", "body": "<p>I don't believe you would find one way is more efficient over the other, at least not noticeably.  For the most part it is simply personal preference.  </p>\n\n<p>I generally use VBA and check the value of each dropdown/checkbox and build pieces of the SQL query then put together at the end.  The issue that you may run into with this method though is that if you have a large number of dropdowns and checkboxes the code is easy to get \"lost\" in.   </p>\n\n<p>If time to run is very key though you could always use some of the tips <a href=\"https://stackoverflow.com/questions/198409/how-do-you-test-running-time-of-vba-code\">How do you test running time of VBA code?</a> to see which way is faster. </p>\n"}, {"tags": [], "owner": {"reputation": 705, "user_id": 4163002, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/30e77d3fa90ca3c96cf94a3fca4614ee?s=128&d=identicon&r=PG&f=1", "display_name": "ZX9", "link": "https://stackoverflow.com/users/4163002/zx9"}, "is_accepted": false, "score": 0, "last_activity_date": 1427997725, "creation_date": 1427997725, "answer_id": 29419492, "question_id": 28199777, "link": "https://stackoverflow.com/questions/28199777/access-dynamic-query-better-to-build-one-conditional-sql-query-or-multiple-que/29419492#29419492", "title": "Access dynamic query - Better to build one conditional SQL query or multiple queries with VBA?", "body": "<p>After a lot of experimentation, and <a href=\"http://answers.microsoft.com/en-us/office/forum/office_2003-access/query-or-sql-run-from-vba/1f200146-5f24-4599-b3a1-2c5b55c92616\" rel=\"nofollow\">a bit of new information indicating having a pre-built query is faster than having SQL compiled in VBA</a>, the most efficient and <strong>clear</strong> solution in the context of Microsoft Access is to build and save a number of dependent queries beforehand. </p>\n\n<p>Essentially, build a string of queries each with an <code>IIf</code> dependent on a different criterium. Then you only need to run the final query. The only case where you would have to incorporate a VBA <code>If...Else</code> is if you need to query something more complicated than <code>SELECT...WHERE(IIf(...))</code>.</p>\n\n<p>This has a few advantages:</p>\n\n<ol>\n<li>The SQL is already compiled in the saved query, speeding things up.</li>\n<li>No more getting lost in code:\n<ul>\n<li>There is no giant, <em>nearly-impossible-to-edit</em> query with way too many <code>IIf</code>s.</li>\n<li>The minimal VBA code is even easier to follow.</li>\n</ul></li>\n<li>At least for me, who's not an expert in SQL, it's convenient that I can often use the MS Access visual query builder for each part.</li>\n</ol>\n"}], "owner": {"reputation": 705, "user_id": 4163002, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/30e77d3fa90ca3c96cf94a3fca4614ee?s=128&d=identicon&r=PG&f=1", "display_name": "ZX9", "link": "https://stackoverflow.com/users/4163002/zx9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1149, "favorite_count": 0, "accepted_answer_id": 28199953, "answer_count": 2, "score": 1, "last_activity_date": 1427998941, "creation_date": 1422469943, "last_edit_date": 1427998941, "question_id": 28199777, "link": "https://stackoverflow.com/questions/28199777/access-dynamic-query-better-to-build-one-conditional-sql-query-or-multiple-que", "title": "Access dynamic query - Better to build one conditional SQL query or multiple queries with VBA?", "body": "<p>I have a Microsoft Access 2010 form with dropboxes and a checkbox which represent certain parameters. I need to run a query with conditions based on these parameters. It should also be a possibility for no criteria from the dropdown boxes and checkbox in order to pull all data.</p>\n\n<p>I have two working ways of implementing this:</p>\n\n<ol>\n<li><p>I build a query with <code>IIf</code> statements in the <code>WHERE</code> clause, nesting statements until I have accounted for every combination of criteria. I reference the criteria in the SQL logic by using <code>Forms!frmMyFrm!checkbox1</code> for example or by using a function <code>FormFieldValue(formName,fieldName)</code> which returns the value of a control with the input of the form and control name (This is because of previous issues). I set this query to run with the press of the form's button.</p></li>\n<li><p>I set a vba sub to run with the press of the button. I check the conditions and set the query SQL to a predetermined SQL string based on the control criteria (referenced in the same way as the previous method). This also involves many <code>If...Else</code> statements, but is a little easier to read than a giant query.</p></li>\n</ol>\n\n<p>What is the preferred method? Which is more efficient? </p>\n"}, {"tags": ["excel", "vba", "input"], "comments": [{"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1422470117, "post_id": 28199698, "comment_id": 44765929, "body": "It&#39;s CheckCell not Cellcheck on the 3rd line..."}], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 2578215, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/632651222/picture?type=large", "display_name": "Mark Austin", "link": "https://stackoverflow.com/users/2578215/mark-austin"}, "edited": false, "score": 0, "creation_date": 1422474846, "post_id": 28199809, "comment_id": 44768484, "body": "Thanks! I guess i was staring at it to long. When you run the program the input box dose not show any text for that Checkcell.offset part of the code. That cell does have a value in in."}, {"owner": {"reputation": 129, "user_id": 2578215, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/632651222/picture?type=large", "display_name": "Mark Austin", "link": "https://stackoverflow.com/users/2578215/mark-austin"}, "edited": false, "score": 0, "creation_date": 1422476243, "post_id": 28199809, "comment_id": 44769327, "body": "I closed the file and reopened it and it work great now! Thanks!"}], "tags": [], "owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "is_accepted": true, "score": 1, "last_activity_date": 1422474956, "last_edit_date": 1422474956, "creation_date": 1422470082, "answer_id": 28199809, "question_id": 28199698, "link": "https://stackoverflow.com/questions/28199698/search-range-if-blank-prompt-user-intup-per-cell/28199809#28199809", "title": "Search Range If Blank Prompt User Intup per cell", "body": "<p>Your third line should be <code>CheckCell.Value...</code>, not <code>Cellcheck.Value...</code>:</p>\n\n<pre><code>For Each CheckCell In Sheets(\"Sheet1\").Range(\"J5:J17\").Cells\n    If Len(Trim(CheckCell.Value)) = 0 Then\n       CheckCell.Value = Application.InputBox(\"Please Enter Data for \" &amp; CheckCell.Offset(Rowoffset:=0, Columnoffset:=-1).Value, \"Mission Info\")\n    End If\nNext CheckCell\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 129, "user_id": 2578215, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/632651222/picture?type=large", "display_name": "Mark Austin", "link": "https://stackoverflow.com/users/2578215/mark-austin"}, "edited": false, "score": 0, "creation_date": 1422475025, "post_id": 28199861, "comment_id": 44768592, "body": "Instead of Checkcell.address(0,0) I am wanting to return the value of that cell. But when i change it to checkcell.value i get blank in the message box."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 129, "user_id": 2578215, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/632651222/picture?type=large", "display_name": "Mark Austin", "link": "https://stackoverflow.com/users/2578215/mark-austin"}, "edited": false, "score": 0, "creation_date": 1422475218, "post_id": 28199861, "comment_id": 44768728, "body": "You are absolutely correct!!  The InputBox says <b>which</b> cell needs the value <i>(shows the address)</i>  What the user types into that InputBox  <b>goes into</b> that cell!"}, {"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1422477312, "post_id": 28199861, "comment_id": 44769950, "body": "@Gary&#39;sStudent From what Mark said in his question, he was trying to put the contents of the cell to the left of <code>CheckCell</code> into the InputBox prompt. To make this answer match that requirement, you would need to change line 4 to: <code>mesage = &quot;Please Enter Data for &quot; &amp; checkCell.Offset(0, -1).Value &amp; &quot; in cell &quot; &amp; checkCell.Address(0, 0)</code>."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1422470224, "creation_date": 1422470224, "answer_id": 28199861, "question_id": 28199698, "link": "https://stackoverflow.com/questions/28199698/search-range-if-blank-prompt-user-intup-per-cell/28199861#28199861", "title": "Search Range If Blank Prompt User Intup per cell", "body": "<p>Correcting the <strong>spelling error</strong></p>\n\n<pre><code>Sub dural()\n    For Each checkCell In Sheets(\"Sheet1\").Range(\"J5:J17\").Cells\n        If Len(Trim(checkCell.Value)) = 0 Then\n           mesage = \"Please Enter Data for \" &amp; checkCell.Address(0, 0)\n           checkCell.Value = Application.InputBox(Prompt:=mesage, Type:=1)\n        End If\n    Next checkCell\nEnd Sub\n</code></pre>\n\n<p>Change the <strong>Type</strong> to match your requirements.</p>\n"}], "owner": {"reputation": 129, "user_id": 2578215, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/632651222/picture?type=large", "display_name": "Mark Austin", "link": "https://stackoverflow.com/users/2578215/mark-austin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 28199809, "answer_count": 2, "score": 0, "last_activity_date": 1422474956, "creation_date": 1422469664, "question_id": 28199698, "link": "https://stackoverflow.com/questions/28199698/search-range-if-blank-prompt-user-intup-per-cell", "title": "Search Range If Blank Prompt User Intup per cell", "body": "<p>I have a range of info and want to check it before i save it. I am having trouble with the equation to prompt the user which cell is blank and then prompt them to input the correct info. i think it is because i defined the cells as a range or i am missing something else. Once the input box pops up i am trying to inform the user on which data they are missing by offsetting the cell to the left one. The cell to the left is type of data they need to enter (like date or name). That offset cell wont display in the message of the input box either.</p>\n\n<pre><code>For Each CheckCell In Sheets(\"Sheet1\").Range(\"J5:J17\").Cells\n        If Len(Trim(CheckCell.Value)) = 0 Then\n           Cellcheck.Value = Application.InputBox(\"Please Enter Data for\" &amp; CheckCell.Offset(Rowoffset:=0, Columnoffset:=-1).Value, \"Mission Info\")\n        End If\n    Next CheckCell\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": true, "score": 2, "last_activity_date": 1422478314, "creation_date": 1422478314, "answer_id": 28202161, "question_id": 28199576, "link": "https://stackoverflow.com/questions/28199576/listfillrange-from-another-sheet/28202161#28202161", "title": "ListFillRange from another sheet", "body": "<p>The ListFillRange is a string, so you need to pass in the address of the range. And since the range is on another sheet, you need to qualify that address. Fortunately, the Address property has an External argument.</p>\n\n<pre><code>Sheet1.ComboBox1.ListFillRange = Sheet2.Range(\"A2:A3000\").Address(, , , True)\n</code></pre>\n\n<p>The Address property will look like</p>\n\n<pre><code>?Sheet2.Range(\"A2:A3000\").Address(, , , True)\n[Book2]Sheet2!$A$2:$A$3000\n</code></pre>\n\n<p>But the control understands it and converts it.</p>\n\n<pre><code>?sheet1.ComboBox1.ListFillRange\nSheet2!$A$2:$A$3000\n</code></pre>\n\n<p>Having said that, I never use ListFillRange. I prefer to fill the control myself using List or AddItem.</p>\n"}], "owner": {"reputation": 33, "user_id": 4504297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dd61b70c9a88d90b3911e4889c63e34?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4504297/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11205, "favorite_count": 0, "accepted_answer_id": 28202161, "answer_count": 1, "score": 2, "last_activity_date": 1422478314, "creation_date": 1422469246, "last_edit_date": 1531164843, "question_id": 28199576, "link": "https://stackoverflow.com/questions/28199576/listfillrange-from-another-sheet", "title": "ListFillRange from another sheet", "body": "<p>I'm trying to fill a combobox using .ListFillRange from another sheet however the list is not being populated.</p>\n\n<p>I have the combobox on \"sheet1\" and the data on \"sheet2\" in the cells A2:A3000</p>\n\n<p>From sheet1 I have tried using:</p>\n\n<pre><code>set ws = ThisWorkbook.Worksheets(\"sheet2\")\nset Rng = ws.Range(\"A2:A3000\")\nComboBox.ListFillRange = ws.Range(Rng)\n</code></pre>\n\n<p>I have also tried</p>\n\n<pre><code>ComboBox.ListFillRange = ws.Range(\"sheet2!A2:A3000\")\n</code></pre>\n\n<p>However the combobox is not being populated, any suggestions?</p>\n"}, {"tags": ["vba", "email", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1422470499, "creation_date": 1422470499, "answer_id": 28199941, "question_id": 28199443, "link": "https://stackoverflow.com/questions/28199443/in-vba-is-it-possible-to-get-the-recall-message-target/28199941#28199941", "title": "IN VBA is it possible to get the recall message target?", "body": "<p>Outlook uses <a href=\"https://msdn.microsoft.com/en-us/library/office/ff866458(v=office.15).aspx\" rel=\"nofollow\">EntryID</a> property values to identify their items uniquely. Here is what MSDN states:</p>\n\n<p><em>A MAPI store provider assigns a unique ID string when an item is created in its store. Therefore, the EntryID property is not set for an Outlook item until it is saved or sent. The Entry ID changes when an item is moved into another store, for example, from your Inbox to a Microsoft Exchange Server public folder, or from one Personal Folders (.pst) file to another .pst file. Solutions should not depend on the EntryID property to be unique unless items will not be moved.</em></p>\n\n<p>Also you may consider adding your own ID as a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869073(v=office.15).aspx\" rel=\"nofollow\">user property</a>. </p>\n"}], "owner": {"reputation": 13, "user_id": 4408609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rzmj6.jpg?s=128&g=1", "display_name": "Outis", "link": "https://stackoverflow.com/users/4408609/outis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 314, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593156789, "creation_date": 1422468744, "last_edit_date": 1593156789, "question_id": 28199443, "link": "https://stackoverflow.com/questions/28199443/in-vba-is-it-possible-to-get-the-recall-message-target", "title": "IN VBA is it possible to get the recall message target?", "body": "<p>Using the mail object properties I can get information about a recall message, but I don't know how to grab the information about the message it is going to remove. </p>\n\n<p>The body gives the subject, but the emails being recalled in my case are not unique in sender nor in subject and so a combination of values for the target message are needed to unique them.</p>\n\n<p>Thanks for your help and time,\nOutis</p>\n"}, {"tags": ["vba", "excel", "passwords"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1422469332, "post_id": 28199175, "comment_id": 44765450, "body": "What is the software? It might have a COM library"}], "answers": [{"tags": [], "owner": {"reputation": 534, "user_id": 2596509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d5df419156e7426dadf3b8098eb509d?s=128&d=identicon&r=PG", "display_name": "Aron Foster", "link": "https://stackoverflow.com/users/2596509/aron-foster"}, "is_accepted": true, "score": 0, "last_activity_date": 1422468740, "creation_date": 1422468740, "answer_id": 28199438, "question_id": 28199175, "link": "https://stackoverflow.com/questions/28199175/place-password-into-program-through-vba/28199438#28199438", "title": "Place password into program through VBA", "body": "<p>What you're asking for is ver insecure and undermines the protection and security enforced by the username and password requirement of your program. That being said, you should look into the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff821075(v=office.15).aspx\" rel=\"nofollow\">SendKeys</a> macro action. <code>Application.SendKeys(\"+password\")</code> would type <code>Password</code>, although you might have problems getting Excel to actually send the key presses to your other program. If that's the case then you'll need to reframe your question into one about automating login for whatever that other program is.</p>\n"}, {"comments": [{"owner": {"reputation": 4162, "user_id": 362712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yWcUr.jpg?s=128&g=1", "display_name": "Nigel Heffernan", "link": "https://stackoverflow.com/users/362712/nigel-heffernan"}, "edited": false, "score": 0, "creation_date": 1422481567, "post_id": 28199613, "comment_id": 44772079, "body": "Fr&#233;d&#233;ric&#39;s right about the security flaw, and a fundamental design weakness is only ever going to be ameliorated by clever coding tricks - not fixed. For your reference, &#39;Compiled into an executable&#39; isn&#39;t the same as &#39;encrypted&#39;. Most of the time, it means &#39;I can read the static strings like plaintext with a binary text reader&#39;, and some of the time it means &#39;The compiler has a secure mode that uses a a moderately difficult hash function&#39;. You have to regard the job you&#39;re doing as a &#39;courtesy lock&#39; rather than &#39;secure&#39;.- so check with the users that this is OK."}], "tags": [], "owner": {"reputation": 81, "user_id": 4019746, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh5.googleusercontent.com/-XiDLcZ7__AQ/AAAAAAAAAAI/AAAAAAAANcg/1xqzhoECJU0/photo.jpg?sz=128", "display_name": "Fr&#233;d&#233;ric Marcotte Pich&#233;", "link": "https://stackoverflow.com/users/4019746/fr%c3%a9d%c3%a9ric-marcotte-pich%c3%a9"}, "is_accepted": false, "score": 0, "last_activity_date": 1422469375, "creation_date": 1422469375, "answer_id": 28199613, "question_id": 28199175, "link": "https://stackoverflow.com/questions/28199175/place-password-into-program-through-vba/28199613#28199613", "title": "Place password into program through VBA", "body": "<p>I believe your best bet at interacting with a non-Microsoft software would be <strong>AutoHotKey</strong>. It's a free software with simple syntax that can automate any task you might want to.</p>\n\n<p>You could make your script so it opens the software, enters your login, and then copy-pastes the information you need.</p>\n\n<p>For added security (note that automatically entering a password is always a big security flaw), you can compile the resulting script into an executable so nobody can see the source code of your script.</p>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 28199438, "answer_count": 2, "score": 0, "last_activity_date": 1422469375, "creation_date": 1422467971, "question_id": 28199175, "link": "https://stackoverflow.com/questions/28199175/place-password-into-program-through-vba", "title": "Place password into program through VBA", "body": "<p>I currently have the following code to open up a program (not a Microsoft Office program) in my macro.</p>\n\n<pre><code>   Dim x As Variant\n   Dim Path As String\n   Path = \"Path of my program\"\n   x = Shell(Path, vbNormalFocus)\n</code></pre>\n\n<p>It then opens up a login window (where the username is saved) but I need to place the password? Is it possible to have a macro that will then type the password into this window?</p>\n\n<p>The end goal is to eventually have a button/macro that opens the program, types in the password, and then pulls a data set from this non-Microsoft software.</p>\n\n<p>Is any of that possible? How would I go about to doing that?</p>\n\n<p>Thanks in advance for any and all help!</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1422472824, "post_id": 28198542, "comment_id": 44767389, "body": "Try with <code>Application.DisplayAlerts = False</code> maybe."}, {"owner": {"reputation": 1987, "user_id": 1482, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e689f710ca901a0665a5e0f459d28a42?s=128&d=identicon&r=PG", "display_name": "phenry", "link": "https://stackoverflow.com/users/1482/phenry"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1422473425, "post_id": 28198542, "comment_id": 44767749, "body": "I just tried that and it doesn&#39;t work."}], "answers": [{"tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": true, "score": 1, "last_activity_date": 1422547156, "creation_date": 1422547156, "answer_id": 28219107, "question_id": 28198542, "link": "https://stackoverflow.com/questions/28198542/suppress-warning-dialog-when-updating-chart-links-in-powerpoint/28219107#28219107", "title": "Suppress warning dialog when updating chart links in PowerPoint", "body": "<p>Linked shapes will be of type msoLinkedOLEObject or msoLinkedPicture (which you probably aren't concerned with).  A linked shape's .LinkFormat.SourceFullname will give you the full path to the linked file, so something like this should get you going.  The test for existence of the file's simplistic but it's a starting point:</p>\n\n<pre><code>For Each oSh In ActivePresentation.Slides(1).Shapes\n    If oSh.Type = msoLinkedOLEObject Then\n        If Len(Dir$(oSh.LinkFormat.SourceFullName)) &gt; 0 Then\n            ' do your thing\n        End If\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 1987, "user_id": 1482, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e689f710ca901a0665a5e0f459d28a42?s=128&d=identicon&r=PG", "display_name": "phenry", "link": "https://stackoverflow.com/users/1482/phenry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 499, "favorite_count": 0, "accepted_answer_id": 28219107, "answer_count": 1, "score": 0, "last_activity_date": 1422547156, "creation_date": 1422465902, "question_id": 28198542, "link": "https://stackoverflow.com/questions/28198542/suppress-warning-dialog-when-updating-chart-links-in-powerpoint", "title": "Suppress warning dialog when updating chart links in PowerPoint", "body": "<p>I'm working on a macro to automatically update all of the linked charts in a presentation from their source Excel workbooks. My problem is that when the linked workbook cannot be found, executing the <code>LinkFormat.Update</code> method produces the standard \"The linked file is not available....\" dialog. This could result in the user having to dismiss the dialog dozens or even hundreds of times when updating a presentation.</p>\n\n<p>Is there any way to suppress this dialog when updating a linked chart, either directly or by verifying the link source before attempting an update? The operation does not produce an error, so it can't be trapped. I'm using <code>Chart.ChartData.IsLinked</code> to check for and filter out charts that aren't linked at all, but I can't find any similar property or method that would allow me to check the status of an existing link before executing <code>LinkFormat.Update</code>. I would expect that setting <code>Application.DisplayAlerts</code> to <code>ppAlertsNone</code> would work, but <code>ppAlertsNone</code> is already the default, and setting it manually has no effect.</p>\n"}, {"tags": ["vba", "vb6"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1422463987, "post_id": 28197828, "comment_id": 44762176, "body": "constants have to be known at compile time; you cannot use (most) functions to define them (e.g. <code>Environ$</code>) .  Also that line has to be in a Sub since it is an executable line."}, {"owner": {"reputation": 125, "user_id": 4240240, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4da022c7061b9eae402b8a26c0121c75?s=128&d=identicon&r=PG&f=1", "display_name": "Navron", "link": "https://stackoverflow.com/users/4240240/navron"}, "reply_to_user": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1422465111, "post_id": 28197828, "comment_id": 44762947, "body": "@Plutonix Ok, thanks for your insights...but how will I be able to pass a value to the variable &quot;loc&quot;?"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1422465233, "post_id": 28197828, "comment_id": 44763026, "body": "If you know what the value of &quot;loc&quot; is before to run, then just add it to the string. But if you want it to be variable, I think it&#39;s not a constant what you look for."}, {"owner": {"reputation": 125, "user_id": 4240240, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4da022c7061b9eae402b8a26c0121c75?s=128&d=identicon&r=PG&f=1", "display_name": "Navron", "link": "https://stackoverflow.com/users/4240240/navron"}, "edited": false, "score": 0, "creation_date": 1422466434, "post_id": 28197828, "comment_id": 44763726, "body": "@ Matteo NNZ loc must be a variable. As such, how should I declare it?"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1422467801, "post_id": 28197828, "comment_id": 44764555, "body": "I fear you cannot declare a variable as a constant. The keyword &quot;Constant&quot; stands for &quot;this variable won&#39;t change its value anywhere in the code). You might want to re-factor a bit your code."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1422468089, "post_id": 28197828, "comment_id": 44764742, "body": "Create a Function or Property to return CnnSTR"}], "answers": [{"tags": [], "owner": {"reputation": 75, "user_id": 4496123, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9068fbe5e63599418744af4274df3ecb?s=128&d=identicon&r=PG", "display_name": "Serenity", "link": "https://stackoverflow.com/users/4496123/serenity"}, "is_accepted": false, "score": 0, "last_activity_date": 1422472625, "creation_date": 1422472625, "answer_id": 28200560, "question_id": 28197828, "link": "https://stackoverflow.com/questions/28197828/cannot-declare-string-in-module-vb6/28200560#28200560", "title": "Cannot Declare String In Module VB6", "body": "<pre><code>CnnSTR = ReadIniValue(Environ$(\"APPDATA\") &amp; \"\\PensionMaster\\PM-Strings.ini\", \"DB\", \"DBSQL\"\n</code></pre>\n\n<p>Will work. Maybe a <code>Dim CnnSTR as String</code> line as well.</p>\n\n<pre><code>Const x=5\ny = X\n</code></pre>\n\n<p>is exactly the same as </p>\n\n<pre><code>y=5\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9256, "user_id": 17776, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6ba26f0f56f887d9e01c48e5ef040f75?s=128&d=identicon&r=PG", "display_name": "jac", "link": "https://stackoverflow.com/users/17776/jac"}, "is_accepted": true, "score": 5, "last_activity_date": 1422473260, "creation_date": 1422473260, "answer_id": 28200745, "question_id": 28197828, "link": "https://stackoverflow.com/questions/28197828/cannot-declare-string-in-module-vb6/28200745#28200745", "title": "Cannot Declare String In Module VB6", "body": "<p>Tim Williams is correct. Instead of trying to declare it as a public variable create a public function, or property. My preference is to create a function in a .bas module, and a property in a class.</p>\n\n<pre><code>Public Function GetCnnSTR() As String\n    Dim loc As String\n    Dim strPath as String\n\n    loc = Environ$(\"APPDATA\")\n    strPath = ReadIniValue(loc &amp; \"\\PensionMaster\\PM-Strings.ini\", \"DB\", \"DBSQL\")\n\n    GetCnnSTR = strPath\n\nEnd Function\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Public Property Get CnnSTR() As String\n    Dim loc As String\n    Dim strPath as String\n\n    loc = Environ$(\"APPDATA\")\n    strPath = ReadIniValue(loc &amp; \"\\PensionMaster\\PM-Strings.ini\", \"DB\", \"DBSQL\")\n\n    CnnSTR = strPath\n\nEnd Property\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 4240240, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4da022c7061b9eae402b8a26c0121c75?s=128&d=identicon&r=PG&f=1", "display_name": "Navron", "link": "https://stackoverflow.com/users/4240240/navron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 28200745, "answer_count": 2, "score": 0, "last_activity_date": 1422473260, "creation_date": 1422463850, "question_id": 28197828, "link": "https://stackoverflow.com/questions/28197828/cannot-declare-string-in-module-vb6", "title": "Cannot Declare String In Module VB6", "body": "<p>I am trying to read database strings from a file for a legacy application. To do this, I place the file in the AppData folder for each user. Now, I need to tell the application where the file is. However, I cant seem to declare a string in a module (the original strings were declared as constants in this module). How can I get over this? any help would be appreciated.</p>\n\n<p>This is what I tried:</p>\n\n<pre><code>Dim loc As String\nloc = Environ$(\"APPDATA\")\nPublic Const CnnSTR = ReadIniValue(loc &amp; \"\\PensionMaster\\PM-Strings.ini\", \"DB\", \"DBSQL\")\n</code></pre>\n\n<p>But I got an <strong>'Invalid outside procedure'</strong> error.</p>\n"}, {"tags": ["vba", "loops", "exchange-server"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1422469088, "post_id": 28197577, "comment_id": 44765310, "body": "See suggestion here: <a href=\"http://stackoverflow.com/questions/5622477/vba-outlook-seeing-peoples-calendars\" title=\"vba outlook seeing peoples calendars\">stackoverflow.com/questions/5622477/&hellip;</a>"}, {"owner": {"reputation": 662, "user_id": 613858, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e5e348747df19159d7ef5572e5da6d21?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/613858/jason"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1422475389, "post_id": 28197577, "comment_id": 44768817, "body": "I don&#39;t want to display their calendar on screen, I want this all to happen in the background. I want to take the array I have, which is the resources of a distribution list and check each one in a loop if they&#39;re available during the start and end date. if they are then display them in the listbox."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1422476816, "post_id": 28197577, "comment_id": 44769643, "body": "Are you hoping to do this via the outlook client, or directly against the server?  Maybe you can also add what environment you&#39;re working in (Excel? Outlook?)"}, {"owner": {"reputation": 662, "user_id": 613858, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e5e348747df19159d7ef5572e5da6d21?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/613858/jason"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1422478400, "post_id": 28197577, "comment_id": 44770529, "body": "Updated, outlook addin on the ribbon. I am wanting this to happen through outlook, in the background. my addin displays a form that the user selects laptop or projector or both, and start and end dates to check it out. then sends a meeting request to the resource, which is handled by the auto calendar asst. Thank you"}, {"owner": {"reputation": 662, "user_id": 613858, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e5e348747df19159d7ef5572e5da6d21?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/613858/jason"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1422570783, "post_id": 28197577, "comment_id": 44815066, "body": "@TimWilliams Can you help?"}], "answers": [{"tags": [], "owner": {"reputation": 662, "user_id": 613858, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e5e348747df19159d7ef5572e5da6d21?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/613858/jason"}, "is_accepted": true, "score": 1, "last_activity_date": 1422573764, "creation_date": 1422573764, "answer_id": 28226588, "question_id": 28197577, "link": "https://stackoverflow.com/questions/28197577/check-if-resource-is-available-during-selected-dates-via-exchange/28226588#28226588", "title": "Check if resource is available during selected dates via exchange", "body": "<pre><code>Public Sub GetFreeBusyInfo()\n   Dim myOlApp As New Outlook.Application\n   Dim myNameSpace As Outlook.NameSpace\n   Dim myRecipient As Outlook.Recipient\n   Dim myFBInfo As String\n   Set myNameSpace = myOlApp.GetNamespace(\"MAPI\")\n   Set myRecipient = myNameSpace.CreateRecipient(\"Nate Sun\")\n   On Error GoTo ErrorHandler\n   myFBInfo = myRecipient.FreeBusy(#11/11/2003#, 60 * 24)\n   MsgBox myFBInfo\n   Exit Sub\nErrorHandler:     \n    MsgBox \"Cannot access the information. \"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 662, "user_id": 613858, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e5e348747df19159d7ef5572e5da6d21?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/613858/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 914, "favorite_count": 0, "accepted_answer_id": 28226588, "answer_count": 1, "score": 0, "last_activity_date": 1422573764, "creation_date": 1422463081, "last_edit_date": 1422478377, "question_id": 28197577, "link": "https://stackoverflow.com/questions/28197577/check-if-resource-is-available-during-selected-dates-via-exchange", "title": "Check if resource is available during selected dates via exchange", "body": "<p>I already have a Array of each resource in the distribution list. How do I check each resource in the array is available via exchange server during the start and end time user is requesting? This will be an outlook addin on the ribbon.</p>\n\n<pre><code> Public Sub AddElementToStringArray(ByVal stringToAdd As String)\n    ReDim Preserve distArray(distArrayElements)\n    distArray(distArrayElements) = stringToAdd\n    distArrayElements += 1\nEnd Sub\n\nDim startDate As Date\nDim endDate As Date\n\nSub checkAvailable()\n\n    'distArray declared earlier.\n    If distArray Is Nothing Then\n        Exit Sub\n    Else\n        'Check if they are available.\n        'if available, add to resourceListBox.\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "utf-8"], "comments": [{"owner": {"reputation": 4342, "user_id": 3019499, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/231295e58751d3002e06a50d8cff6804?s=128&d=identicon&r=PG&f=1", "display_name": "Stephane", "link": "https://stackoverflow.com/users/3019499/stephane"}, "edited": false, "score": 0, "creation_date": 1422462693, "post_id": 28197246, "comment_id": 44761319, "body": "@vba4all I&#39;m sure you mean well, but I&#39;m sorry I don&#39;t see how to adapt your answer to my problem..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 0, "creation_date": 1422464316, "post_id": 28197246, "comment_id": 44762413, "body": "i have no idea how this got posted to here. I have deleted it already, sorry about that"}], "answers": [{"comments": [{"owner": {"reputation": 4342, "user_id": 3019499, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/231295e58751d3002e06a50d8cff6804?s=128&d=identicon&r=PG&f=1", "display_name": "Stephane", "link": "https://stackoverflow.com/users/3019499/stephane"}, "edited": false, "score": 0, "creation_date": 1422463528, "post_id": 28197664, "comment_id": 44761878, "body": "I am trying to load this file with informatica, which can only read UTF-8. So I need to convert it..."}, {"owner": {"reputation": 6285, "user_id": 1689180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ad05d9769522004486fcee2b3e53153?s=128&d=identicon&r=PG", "display_name": "KekuSemau", "link": "https://stackoverflow.com/users/1689180/kekusemau"}, "reply_to_user": {"reputation": 4342, "user_id": 3019499, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/231295e58751d3002e06a50d8cff6804?s=128&d=identicon&r=PG&f=1", "display_name": "Stephane", "link": "https://stackoverflow.com/users/3019499/stephane"}, "edited": false, "score": 1, "creation_date": 1422463571, "post_id": 28197664, "comment_id": 44761906, "body": "Ok, I see, you can probably convert it with two stream objects,... I&#39;ll try it too"}], "tags": [], "owner": {"reputation": 6285, "user_id": 1689180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ad05d9769522004486fcee2b3e53153?s=128&d=identicon&r=PG", "display_name": "KekuSemau", "link": "https://stackoverflow.com/users/1689180/kekusemau"}, "is_accepted": true, "score": 2, "last_activity_date": 1422630722, "last_edit_date": 1422630722, "creation_date": 1422463334, "answer_id": 28197664, "question_id": 28197246, "link": "https://stackoverflow.com/questions/28197246/vba-macro-to-save-excel-analysis-as-utf-8-textfile/28197664#28197664", "title": "VBA Macro to save excel analysis as UTF-8 textfile", "body": "<p>Here's what happens:<br>\n<code>wb.SaveAs</code> saves your workbook as <code>xlUnicodeText</code>. This is in fact UTF16LE (which is mostly meant when anyone just says 'Unicode').</p>\n\n<p>Your Stream Object opens this UTF16 source, but reads it as UTF8. In UTF16, characters take up a minimum of two bytes. In UTF8, simple latin characters only use one byte, hence an empty byte after most characters (displayed in your case as spaces; notepad++ would display <kbd>NUL</kbd>).  </p>\n\n<p>This seems to work for a conversion:</p>\n\n<pre><code>Public Sub convert_UnicodeToUTF8(parF1 As String, parF2 As String)\n    Const adSaveCreateOverWrite = 2\n    Const adTypeText = 2\n\n    Dim streamSrc, streamDst ' Source / Destination\n    Set streamSrc = CreateObject(\"ADODB.Stream\")\n    Set streamDst = CreateObject(\"ADODB.Stream\")\n    streamDst.Type = adTypeText\n    streamDst.Charset = \"utf-8\"\n    streamDst.Open\n\n    With streamSrc\n        .Type = adTypeText\n        .Charset = \"Unicode\" ' this is also the default value\n        .Open\n        .LoadFromFile parF1\n        .copyTo streamDst\n        .Close\n    End With\n    streamDst.saveToFile parF2, adSaveCreateOverWrite\n    streamDst.Close\n    Set streamSrc = Nothing\n    Set streamDst = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>See <a href=\"http://www.w3schools.com/asp/met_stream_copyto.asp\" rel=\"nofollow\">ADODB.Stream.CopyTo</a>.  </p>\n\n<blockquote>\n  <p>the CharSet property of the destination Stream object can be different than the source Stream object`</p>\n</blockquote>\n"}], "owner": {"reputation": 4342, "user_id": 3019499, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/231295e58751d3002e06a50d8cff6804?s=128&d=identicon&r=PG&f=1", "display_name": "Stephane", "link": "https://stackoverflow.com/users/3019499/stephane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5389, "favorite_count": 1, "accepted_answer_id": 28197664, "answer_count": 1, "score": 1, "last_activity_date": 1422630722, "creation_date": 1422462130, "question_id": 28197246, "link": "https://stackoverflow.com/questions/28197246/vba-macro-to-save-excel-analysis-as-utf-8-textfile", "title": "VBA Macro to save excel analysis as UTF-8 textfile", "body": "<p>I have an XLS file containing some foreign characters.\nI have tried the following approach, but the data looks funky:</p>\n\n<pre><code>--- removed code above\nwb.SaveAs fPath &amp; Replace(fName, \".xlsx\", \".txt\"), FileFormat:=xlUnicodeText, CreateBackup:=False\nwb.Saved = True\nwb.Close True\nActiveWorkbook.Close\n\n\ntFileToOpenPath = fPath &amp; Replace(fName, \".xlsx\", \".txt\")\ntFileToSavePath = fPath &amp; Replace(fName, \".xlsx\", \"-UTF8.txt\")\n\nDim oStream\nSet oStream = CreateObject(\"ADODB.Stream\") 'Create Stream object \nWith oStream\n    .Type = 2 'Specify stream type \u2013 we want To save text/string data. \n    .CharSet = \"utf-8\" 'Specify charset For the source text data. \n    .Open 'Open the stream \n    .LoadFromFile tFileToOpenPath  'And write the file to the object stream \n    .SaveToFile tFileToSavePath, 2  'Save the data to the named path \nEnd With\nSet oStream = Nothing 'Close the stream - no memory leaks\n</code></pre>\n\n<p>The output data looks like that... I'm puzzled</p>\n\n<pre><code>S a l e s \n</code></pre>\n\n<p>The txt file itself is fine, just the UTF-8.txt one is really weird</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba", "tracking", "userform"], "answers": [{"comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1422466524, "post_id": 28198361, "comment_id": 44763782, "body": "This isn&#39;t an answer.  Your suggestion should be included in your code to be a valid answer.  Basically, you have left a comment, and since you do not have 50 rep yet, you are unable to leave comments.  I would recommend giving quality answers or asking quality questions to get to 50 rep to leave comments."}, {"owner": {"reputation": 3, "user_id": 4402597, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-otk8qNuaLW4/AAAAAAAAAAI/AAAAAAAAAPM/Zv-X3zi_meE/photo.jpg?sz=128", "display_name": "rsremole", "link": "https://stackoverflow.com/users/4402597/rsremole"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1422469614, "post_id": 28198361, "comment_id": 44765627, "body": "Thanks. In the event that you don&#39;t have a solution. Try my workaround."}, {"owner": {"reputation": 21, "user_id": 4503643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1e57278b7cbe3678e0752a50cf506f2?s=128&d=identicon&r=PG&f=1", "display_name": "user4503643", "link": "https://stackoverflow.com/users/4503643/user4503643"}, "edited": false, "score": 0, "creation_date": 1422520976, "post_id": 28198361, "comment_id": 44785066, "body": "That&#39;s a nice one - it fails however in one situation. I have a table in rows 1 to 7 and I can enter text in the row just under the table - only one cell keeps the text - all other cells are fine - I&#39;m unable to change them - any ideas why ?  Appreciate your help!"}, {"owner": {"reputation": 3, "user_id": 4402597, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-otk8qNuaLW4/AAAAAAAAAAI/AAAAAAAAAPM/Zv-X3zi_meE/photo.jpg?sz=128", "display_name": "rsremole", "link": "https://stackoverflow.com/users/4402597/rsremole"}, "edited": false, "score": 0, "creation_date": 1422565865, "post_id": 28198361, "comment_id": 44812419, "body": "Could you put this after the Application.Undo line:     If Target.Row = 8 Then Target.ClearContents"}], "tags": [], "owner": {"reputation": 3, "user_id": 4402597, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-otk8qNuaLW4/AAAAAAAAAAI/AAAAAAAAAPM/Zv-X3zi_meE/photo.jpg?sz=128", "display_name": "rsremole", "link": "https://stackoverflow.com/users/4402597/rsremole"}, "is_accepted": false, "score": -1, "last_activity_date": 1422512761, "last_edit_date": 1422512761, "creation_date": 1422465394, "answer_id": 28198361, "question_id": 28196593, "link": "https://stackoverflow.com/questions/28196593/excel-tracking-changes-vba/28198361#28198361", "title": "Excel Tracking Changes VBA", "body": "<p>Don't use the sheet protect method, but still prevent users from changing the cells you want protected.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Target.Count &gt; 1 Then Exit Sub\n\nIf Target.Column = 8 Or Target.Column = 16 Then\n    Target.ClearComments\n    Target.AddComment.Text Text:=\"Previous Value was \" &amp; preValue &amp; Chr(10) &amp; \"Revised \" &amp; Format(Date, \"mm-dd-yyyy\") &amp; Chr(10) &amp; \"By \" &amp; Environ(\"UserName\")\nElse\n    Application.EnableEvents = False\n    Application.Undo\n    Application.EnableEvents = True\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4503643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1e57278b7cbe3678e0752a50cf506f2?s=128&d=identicon&r=PG&f=1", "display_name": "user4503643", "link": "https://stackoverflow.com/users/4503643/user4503643"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 953, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1422512761, "creation_date": 1422460286, "question_id": 28196593, "link": "https://stackoverflow.com/questions/28196593/excel-tracking-changes-vba", "title": "Excel Tracking Changes VBA", "body": "<p>I have quite big excel with user forms and a lot of VBA going on. I have a problem with locking partially one worksheet and in the same time allowing VBA to track changes.\nAt the moment I track changes using the code below - this code is sitting under Microsoft Excel Objects >> Sheet1:</p>\n\n<pre><code>Option Explicit\nPublic preValue As Variant\nPrivate Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Count &gt; 1 Then Exit Sub\n    Target.ClearComments\nTarget.AddComment.Text Text:=\"Previous Value was \" &amp; preValue &amp; Chr(10) `&amp; \"Revised \" &amp; Format(Date, \"mm-dd-yyyy\") &amp; Chr(10) &amp; \"By \" &amp; Environ`(\"UserName\")\nEnd Sub\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\nIf Target.Count &gt; 1 Then Exit Sub\nIf Target = \"\" Then\npreValue = \"a blank\"\nElse: preValue = Target.Value\nEnd If\nEnd Sub\n</code></pre>\n\n<p>And another bit of code is sitting in the folder Forms ( where I created user form to pick up some details from users) and looks like that: </p>\n\n<pre><code>Dim myPassword As String\nmyPassword = \"123\"\nSet wsUK = Worksheets(\"Sheet1\")\nwsUK.Unprotect Password:=myPassword\n' here there is a lot of code that throws data into Sheet1\nwsUK.Protect Password:=myPassword\n</code></pre>\n\n<p>The problem is that after the user form finished Sheet1 is partially protected, but I still allow users to change data in column H and P. When I try to do it I get Run-time error '1004' The cell or chart that you are trying to change is protected and therefore read-only.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 4483090, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1d9370e373e95f19abd227bd37cf383a?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/4483090/robert"}, "edited": false, "score": 0, "creation_date": 1422463893, "post_id": 28196958, "comment_id": 44762114, "body": "This is what I was looking for. Thanks Kory. Another question I had was, do you think its possible to return the letter of the column rather than the number of the index? Thanks in advance."}, {"owner": {"reputation": 5, "user_id": 4483090, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1d9370e373e95f19abd227bd37cf383a?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/4483090/robert"}, "edited": false, "score": 0, "creation_date": 1422561516, "post_id": 28196958, "comment_id": 44809885, "body": "Kory, when I use this, it  gives me an error stating that &quot;Unable to get the Match property of the WorksheetFunction class&quot; Error 1004"}, {"owner": {"reputation": 188, "user_id": 3684671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3205b96f7b388c7f1301a4a0c3e35f1f?s=128&d=identicon&r=PG&f=1", "display_name": "Kory", "link": "https://stackoverflow.com/users/3684671/kory"}, "reply_to_user": {"reputation": 5, "user_id": 4483090, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1d9370e373e95f19abd227bd37cf383a?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/4483090/robert"}, "edited": false, "score": 0, "creation_date": 1422644489, "post_id": 28196958, "comment_id": 44846414, "body": "Can you try just Application.Match?"}], "tags": [], "owner": {"reputation": 188, "user_id": 3684671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3205b96f7b388c7f1301a4a0c3e35f1f?s=128&d=identicon&r=PG&f=1", "display_name": "Kory", "link": "https://stackoverflow.com/users/3684671/kory"}, "is_accepted": false, "score": 0, "last_activity_date": 1422461301, "last_edit_date": 1495540620, "creation_date": 1422461301, "answer_id": 28196958, "question_id": 28196449, "link": "https://stackoverflow.com/questions/28196449/refer-to-a-column-using-the-column-header-rather-than-column-number/28196958#28196958", "title": "Refer to a column using the column header rather than column number", "body": "<p>You can use match just like the spreadsheet function to search for your header in the first row.</p>\n\n<p>Syntax and more properties can be found here:\n<a href=\"https://msdn.microsoft.com/en-us/library/office/ff835873%28v=office.15%29.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff835873%28v=office.15%29.aspx</a>\nor here:\n<a href=\"https://stackoverflow.com/questions/20214540/application-worksheetfunction-match-method\">Application.WorksheetFunction.Match method</a></p>\n\n<p>Once the index is returned to you form the match function, you can use the number to reference ranges in the cells(x,y) notation.</p>\n\n<pre><code>Application.worksheetfunction.match(\"State\", [range referencing rows of headers],0)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 81, "user_id": 4019746, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh5.googleusercontent.com/-XiDLcZ7__AQ/AAAAAAAAAAI/AAAAAAAANcg/1xqzhoECJU0/photo.jpg?sz=128", "display_name": "Fr&#233;d&#233;ric Marcotte Pich&#233;", "link": "https://stackoverflow.com/users/4019746/fr%c3%a9d%c3%a9ric-marcotte-pich%c3%a9"}, "is_accepted": false, "score": 0, "last_activity_date": 1422469794, "creation_date": 1422469794, "answer_id": 28199734, "question_id": 28196449, "link": "https://stackoverflow.com/questions/28196449/refer-to-a-column-using-the-column-header-rather-than-column-number/28199734#28199734", "title": "Refer to a column using the column header rather than column number", "body": "<p>I had this function that would return the Column letter when you entered its number as a parameter:</p>\n\n<pre><code>Function Col_Letter(lngCol As Integer) As String\n'Returns the column letter using its number as parameter\n    Dim vArr\n    vArr = Split(Cells(1, lngCol).Address(True, False), \"$\")\n    Col_Letter = vArr(0)\nEnd Function\n</code></pre>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 5, "user_id": 4483090, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1d9370e373e95f19abd227bd37cf383a?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/4483090/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 869, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1422892393, "creation_date": 1422459926, "last_edit_date": 1531161705, "question_id": 28196449, "link": "https://stackoverflow.com/questions/28196449/refer-to-a-column-using-the-column-header-rather-than-column-number", "title": "Refer to a column using the column header rather than column number", "body": "<p>So I have this spreadsheet with different columns of data in them. One of the column is titled \"States\" and it has the abbreviation for different states in that column. Another column is titled, \"Last_IVR\" and it either have rows that say \"Completed\" or they say \"Not Completed\". I have written a code that filters these two columns based on states or whether its completed or not. But the one problem I am running into is that not every spreadsheet have the States column at the same position. What I mean by this is that, lets say on the first worksheet, \"States\" is in column \"F\" but in another spreadsheet, \"States\" could be in column \"C\". So is there a way, I can manipulate my code below so it is referring to the column header rather than the column number. Thanks in advance for any help.</p>\n\n<pre><code>    Sub CFunctions() \n        Dim LR As Long\n        LR = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n        Dim i As Long\n        Dim State As Range\n        Dim Last_IVR As Range\n\n\n        'Removes rows that says \"Complete\"\n\n        For i = LR To 2 Step -1\n        Set Last_IVR = Range(\"G\" &amp; i)\n        If InStr(Last_IVR, \"Complete\") &gt;= 1 Then\n        Rows(i).Delete\n        End If\n        Next i\n\n        'Removes all states that are not \"TX\"\n\n        For i = LR To 2 Step -1\n        Set State = Range(\"F\" &amp; i)\n        If InStr(State, \"TX\") = 0 Then\n        Rows(i).Delete\n        End If\n        Next i\n        MsgBox \"Completed\"\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1422466909, "post_id": 28196341, "comment_id": 44764045, "body": "Have you tried putting <code>DoEvents</code> before that line?"}, {"owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "reply_to_user": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1422474742, "post_id": 28196341, "comment_id": 44768436, "body": "Ive never come accross DoEvents before. Ill try it later. What do we hope to accomplish with it?"}, {"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1422475181, "post_id": 28196341, "comment_id": 44768699, "body": "From Microsoft&#39;s website: &quot;The DoEvents function surrenders execution of the macro so that the operating system can process other events.&quot; I&#39;ve used it in the past to clear up issues with flickering, but I&#39;m not overly knowledgeable as to what exactly it is doing."}, {"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1424116651, "post_id": 28196341, "comment_id": 45411693, "body": "Did this solve your issue?"}, {"owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "reply_to_user": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1424178611, "post_id": 28196341, "comment_id": 45435239, "body": "No. I figured out later that the flicker happens because my code has switched sheed during execution. Even though Excel is back on the starting sheet before application.screenupdating is set to true again, buttons and some other things on the sheet will redraw. I found out that this is what was happening, but didn&#39;t find out any way to surpress that behavior."}], "owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 653, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1422460036, "creation_date": 1422459614, "last_edit_date": 1422460036, "question_id": 28196341, "link": "https://stackoverflow.com/questions/28196341/buttons-flicker-despite-application-screenupdating-false", "title": "Buttons flicker despite Application.ScreenUpdating = False?", "body": "<p>I have a class that I call at the beginning of some subs:</p>\n\n<pre><code>Private bSattOmdomenProtected As Boolean\nPrivate bSkapaOmdomeslistorProtected As Boolean\n\n\nPrivate Sub Class_Initialize()\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n    Application.Cursor = xlWait\n\n\n    'Protection\n    bSattOmdomenProtected = wSattOmdomen.ProtectContents\n    bSkapaOmdomeslistorProtected = wSkapaOmdomeslistor.ProtectContents\n    wSattOmdomen.Unprotect\n    wSkapaOmdomeslistor.Unprotect\n    'End protection\n\nEnd Sub\n\nPrivate Sub Class_Terminate()\n\n\n    'Protection\n    If bSattOmdomenProtected Then\n        wSattOmdomen.Protect AllowSorting:=True, AllowFiltering:=True 'AllowFormattingCells:=True , UserInterfaceOnly:=True\n    End If\n    If bSkapaOmdomeslistorProtected Then\n        wSkapaOmdomeslistor.Protect AllowSorting:=True, AllowFiltering:=True 'AllowFormattingCells:=True,, UserInterfaceOnly:=True\n    End If\n    'End protection\n\n    Application.Cursor = xlDefault\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Example of how I call the class:</p>\n\n<pre><code>Sub Example()\n    Dim general As New cGeneralLines\n    Set general = New cGeneralLines\n\n    'Code\nEnd Sub\n</code></pre>\n\n<p>I find this to work well for setting application states. But since I added the code labeled Protection in the class, all buttons in my worksheets flicker, even though I have set Application.ScreenUpdating = False.</p>\n\n<p>The specific line that causes the flicker seems to be when I try to change the protection settings of another sheet than the active one.</p>\n\n<p>Why is this? How can I have the functionality of the sheet protection code but avoid getting flickering buttons?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 2, "creation_date": 1422459824, "post_id": 28196303, "comment_id": 44759349, "body": "Well, you&#39;d just have to check whether the cell is empty or not. Iterate through rows, then check on column c: <code>If Cells(x,3) &lt;&gt; &quot;&quot; Then...</code> where x represents your row."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1422460205, "post_id": 28196303, "comment_id": 44759631, "body": "<a href=\"http://stackoverflow.com/help/on-topic\">What have you tried?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 444, "user_id": 3198342, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/oxGxi.png?s=128&g=1", "display_name": "Matt_Roberts", "link": "https://stackoverflow.com/users/3198342/matt-roberts"}, "is_accepted": false, "score": -1, "last_activity_date": 1422460153, "creation_date": 1422460153, "answer_id": 28196538, "question_id": 28196303, "link": "https://stackoverflow.com/questions/28196303/copy-a-row-if-a-cell-has-text/28196538#28196538", "title": "Copy a Row if a Cell has Text", "body": "<p>You can use an If statement to determine if the cell contains text using something like:</p>\n\n<pre><code>If IsNumeric(rCell.Value) = False And _\nIsError(rCell.Value) = False And _\nIsDate(rCell.Value) = False Then\n</code></pre>\n\n<p>1st line checks the value is not a number, the next checks it is not an error message from a formula and the last checks it is not a date as these can be mistaken for text depending how they are formatted.</p>\n\n<p>Then add your code to copy the row that you have already found.</p>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 3514907, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/06a83d599c8f8fa5dc234a2a4e3a1888?s=128&d=identicon&r=PG&f=1", "display_name": "user3514907", "link": "https://stackoverflow.com/users/3514907/user3514907"}, "edited": false, "score": 0, "creation_date": 1422520190, "post_id": 28196684, "comment_id": 44784679, "body": "This almost does what I want but I need to it copy the whole row into the summary sheet when column C has text in and there is a header line so it should start pasting them in row 2."}], "tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": false, "score": 0, "last_activity_date": 1422460514, "creation_date": 1422460514, "answer_id": 28196684, "question_id": 28196303, "link": "https://stackoverflow.com/questions/28196303/copy-a-row-if-a-cell-has-text/28196684#28196684", "title": "Copy a Row if a Cell has Text", "body": "<p>Try this</p>\n\n<pre><code>Private Sub CopyNonBlank()\n    Dim destWS As Worksheet ' Destination worksheet\n    Set destWS = ThisWorkbook.Worksheets(\"Action Summary\")\n    Dim i As Long: i = 1\n    For Each cell In Range(\"C2:C32\")\n        If Len(cell.Value) &gt; 0 Then ' if cell is not empty lenght would be greater than 0\n            destWS.Range(\"A\" &amp; i).Value = cell.Value\n            i = i + 1\n        End If\n    Next cell\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 3514907, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/06a83d599c8f8fa5dc234a2a4e3a1888?s=128&d=identicon&r=PG&f=1", "display_name": "user3514907", "link": "https://stackoverflow.com/users/3514907/user3514907"}, "edited": false, "score": 0, "creation_date": 1422520373, "post_id": 28196744, "comment_id": 44784748, "body": "argh this is almost perfect it does exactly what I want but I need it to start searching from row 7 onwards, sorry I am really new to this!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1422460688, "creation_date": 1422460688, "answer_id": 28196744, "question_id": 28196303, "link": "https://stackoverflow.com/questions/28196303/copy-a-row-if-a-cell-has-text/28196744#28196744", "title": "Copy a Row if a Cell has Text", "body": "<p>Perhaps:</p>\n\n<pre><code>Sub SmartCopy()\n    Dim s1 As Worksheet, s2 As Worksheet\n    Dim N As Long, i As Long, j As Long\n    Set s1 = Sheets(\"Sheet1\")\n    Set s2 = Sheets(\"Action Summary\")\n    N = s1.Cells(Rows.Count, \"C\").End(xlUp).Row\n    j = 1\n    For i = 1 To N\n        If s1.Cells(i, \"C\").Value = \"\" Then\n        Else\n            s1.Cells(i, \"C\").EntireRow.Copy s2.Cells(j, 1)\n            j = j + 1\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Update the <em>Sheet</em> names to match your requirements.</p>\n"}, {"tags": [], "owner": {"reputation": 424, "user_id": 3479671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1eec243884e037322a33ea3086499165?s=128&d=identicon&r=PG&f=1", "display_name": "user3479671", "link": "https://stackoverflow.com/users/3479671/user3479671"}, "is_accepted": false, "score": 0, "last_activity_date": 1422462266, "creation_date": 1422462266, "answer_id": 28197306, "question_id": 28196303, "link": "https://stackoverflow.com/questions/28196303/copy-a-row-if-a-cell-has-text/28197306#28197306", "title": "Copy a Row if a Cell has Text", "body": "<p>Something like this then:</p>\n\n<p>Dim y As Integer</p>\n\n<pre><code>y = 1\nFor x = 1 To 30\n    If Sheets(1).Cells(x, 3) &lt;&gt; \"\" Then\n        Do While Sheets(\"Action Summary\").Cells(y, 3) &lt;&gt; \"\"\n            y = y + 1\n        Loop\n        Sheets(1).Rows(x).Copy Destination:=Sheets(\"Action Summary\").Rows(y)\n        y = 1\n    End If\n\nNext x\n</code></pre>\n\n<p>it loops though the first 30 lines of sheet one, then upon finding a value in column c (which is column 3) it loops through the c column values of the \"Action Summary\" sheet incrementing the y variable until it finds a blank row to paste in, then it copies the entire row x of sheet 1 into the row y of the \"Action Summary\" sheet.</p>\n"}], "owner": {"reputation": 85, "user_id": 3514907, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/06a83d599c8f8fa5dc234a2a4e3a1888?s=128&d=identicon&r=PG&f=1", "display_name": "user3514907", "link": "https://stackoverflow.com/users/3514907/user3514907"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9018, "favorite_count": 1, "accepted_answer_id": 28196744, "answer_count": 4, "score": 0, "last_activity_date": 1422462266, "creation_date": 1422459526, "question_id": 28196303, "link": "https://stackoverflow.com/questions/28196303/copy-a-row-if-a-cell-has-text", "title": "Copy a Row if a Cell has Text", "body": "<p>I am trying to write a macro that copies a row if a particular cell in that row contains text (Column C), I have searched the internet and have found ones that deal with copying rows with specific text but I want to write one that copies it regardless of what text is contained in the cell.</p>\n\n<p>For example if there are 30 rows but only 10 contain text in column C I want it to copy those 10 rows and paste them into a 'Action Summary' sheet.</p>\n\n<p>At the moment I am using a conditional format to colour any cells without text and then filtering them out and copying the remaining rows but this is a little messy and I wondered if there was a cleaner way of doing it.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["vba", "excel", "active-directory", "ldap", "ldap-query"], "comments": [{"owner": {"reputation": 10409, "user_id": 4187346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uSe1J.png?s=128&g=1", "display_name": "Dave Bennett", "link": "https://stackoverflow.com/users/4187346/dave-bennett"}, "edited": false, "score": 0, "creation_date": 1422468500, "post_id": 28196284, "comment_id": 44764973, "body": "Which is it - doesn&#39;t return anything? or does it fail? For starters, I would say that <code>objectclass=user</code> and <code>objectcategory=Person</code> are redundant. Is your user&#39;s samaccountname <code>sAMA</code>?"}, {"owner": {"reputation": 261, "user_id": 2317084, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8ccca93bbd44aa56adb8f0d1f4b236f8?s=128&d=identicon&r=PG", "display_name": "user2317084", "link": "https://stackoverflow.com/users/2317084/user2317084"}, "reply_to_user": {"reputation": 10409, "user_id": 4187346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uSe1J.png?s=128&g=1", "display_name": "Dave Bennett", "link": "https://stackoverflow.com/users/4187346/dave-bennett"}, "edited": false, "score": 0, "creation_date": 1422469137, "post_id": 28196284, "comment_id": 44765342, "body": "It fails. and yes the user&#39;s samaaccountname is sAMA"}, {"owner": {"reputation": 261, "user_id": 2317084, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8ccca93bbd44aa56adb8f0d1f4b236f8?s=128&d=identicon&r=PG", "display_name": "user2317084", "link": "https://stackoverflow.com/users/2317084/user2317084"}, "reply_to_user": {"reputation": 10409, "user_id": 4187346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uSe1J.png?s=128&g=1", "display_name": "Dave Bennett", "link": "https://stackoverflow.com/users/4187346/dave-bennett"}, "edited": false, "score": 0, "creation_date": 1422469854, "post_id": 28196284, "comment_id": 44765781, "body": "I believe the error it throws it about a reference returned?"}, {"owner": {"reputation": 261, "user_id": 2317084, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8ccca93bbd44aa56adb8f0d1f4b236f8?s=128&d=identicon&r=PG", "display_name": "user2317084", "link": "https://stackoverflow.com/users/2317084/user2317084"}, "reply_to_user": {"reputation": 10409, "user_id": 4187346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uSe1J.png?s=128&g=1", "display_name": "Dave Bennett", "link": "https://stackoverflow.com/users/4187346/dave-bennett"}, "edited": false, "score": 0, "creation_date": 1422470687, "post_id": 28196284, "comment_id": 44766219, "body": "I updated the main post with the error."}, {"owner": {"reputation": 10409, "user_id": 4187346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uSe1J.png?s=128&g=1", "display_name": "Dave Bennett", "link": "https://stackoverflow.com/users/4187346/dave-bennett"}, "edited": false, "score": 0, "creation_date": 1422484922, "post_id": 28196284, "comment_id": 44773612, "body": "a referral is not an error, it is the server responding saying that it cannot find what you are asking for locally but it offers another server.  What other information was returned with the referral?"}], "answers": [{"comments": [{"owner": {"reputation": 261, "user_id": 2317084, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8ccca93bbd44aa56adb8f0d1f4b236f8?s=128&d=identicon&r=PG", "display_name": "user2317084", "link": "https://stackoverflow.com/users/2317084/user2317084"}, "edited": false, "score": 0, "creation_date": 1422545683, "post_id": 28203480, "comment_id": 44800350, "body": "I tried this as well, but it still didn&#39;t fix my issue. I did manage to figure it out though, so I&#39;ll add that as an answer. Thank you though! :)"}], "tags": [], "owner": {"reputation": 2020, "user_id": 3442153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/hwsHp.jpg?s=128&g=1", "display_name": "K\u1d00\u03c4\u1d22", "link": "https://stackoverflow.com/users/3442153/k%e1%b4%80%cf%84%e1%b4%a2"}, "is_accepted": false, "score": 1, "last_activity_date": 1422483364, "creation_date": 1422483364, "answer_id": 28203480, "question_id": 28196284, "link": "https://stackoverflow.com/questions/28196284/find-user-by-samaccountname-vba/28203480#28203480", "title": "Find user by sAMAccountName VBA", "body": "<p>Found this snippet, give it a try. Change line 1 with your AD and line 2 for sAMA:</p>\n\n<pre><code>StartNode = \"cn=Users,dc=fabrikam,dc=com\" 'edit with your values\nstrAccount = \"HMustermann\" 'edit with your searchvalue\n\nSet objCommand = CreateObject(\"ADODB.Command\")\nSet objConnection = CreateObject(\"ADODB.Connection\")\nobjConnection.Provider = \"ADsDSOObject\"\nobjConnection.Open \"Active Directory Provider\"\nobjCommand.ActiveConnection = objConnection\nSearchScope = \"subtree\"\n\nFilterString = \"(&amp;(objectCategory=person)(objectClass=user)(sAMAccountName=\" &amp; strAccount &amp; \"))\"\nAttributes = \"adspath\"\n\nLDAPQuery = \"&lt;LDAP://\" &amp; StartNode &amp; \"&gt;;\" &amp; FilterString &amp; \";\" _\n        &amp; Attributes &amp; \";\" &amp; SearchScope\n\nobjCommand.CommandText = LDAPQuery\nobjCommand.Properties(\"Page Size\") = 1500\nobjCommand.Properties(\"Timeout\") = 30\nobjCommand.Properties(\"Cache Results\") = False\n\nSet objRecordset = objCommand.Execute\n\nIf Not objRecordset.EOF Then\n   objRecordset.MoveFirst\n\n   Do Until objRecordset.EOF\n      strUserPath = objRecordset.Fields(\"ADsPath\").Value\n      Set objUser = GetObject(strUserPath)\n      '-------get attributes -----------\n      MsgBox objUser.DisplayName\n      '--------------------------------------\n      objRecordset.MoveNext\n   Loop\nEnd If\n\nobjRecordset.Close\nobjConnection.Close\nMsgBox \"Finish\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1589, "user_id": 4250616, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OXswu.jpg?s=128&g=1", "display_name": "baldpate", "link": "https://stackoverflow.com/users/4250616/baldpate"}, "is_accepted": false, "score": 0, "last_activity_date": 1422498574, "creation_date": 1422498574, "answer_id": 28206057, "question_id": 28196284, "link": "https://stackoverflow.com/questions/28196284/find-user-by-samaccountname-vba/28206057#28206057", "title": "Find user by sAMAccountName VBA", "body": "<p>The <code>A referral was returned from the server.</code> usually means you are trying to get an object in domainA when connected to domainB.</p>\n\n<p>Please try to use:</p>\n\n<pre><code>&lt;LDAP://mainDC.com/OU=theOU,DC=mainDC,DC=com&gt;\n</code></pre>\n\n<p>instead of:</p>\n\n<pre><code>&lt;LDAP://OU=theOU,DC=mainDC,DC=com&gt;\n</code></pre>\n\n<p>Without a server it will connect to the domain of current computer (or user?), which may not be mainDC.com.</p>\n\n<p>To search from all domains in forest, you may use the GC:</p>\n\n<pre><code>&lt;GC://[GC server]&gt;\n</code></pre>\n\n<p>But please note that only a subset of attributes exists on GC.</p>\n"}, {"tags": [], "owner": {"reputation": 261, "user_id": 2317084, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8ccca93bbd44aa56adb8f0d1f4b236f8?s=128&d=identicon&r=PG", "display_name": "user2317084", "link": "https://stackoverflow.com/users/2317084/user2317084"}, "is_accepted": true, "score": 0, "last_activity_date": 1422545820, "creation_date": 1422545820, "answer_id": 28218574, "question_id": 28196284, "link": "https://stackoverflow.com/questions/28196284/find-user-by-samaccountname-vba/28218574#28218574", "title": "Find user by sAMAccountName VBA", "body": "<p>Turns out all I had to do was add this:</p>\n\n<pre><code>objCommand.Properties(\"Chase referrals\") = ADS_CHASE_REFERRALS_ALWAYS\n</code></pre>\n\n<p>The connection code is:</p>\n\n<pre><code>Set objConnection = CreateObject(\"ADODB.Connection\")\nobjConnection.Open \"Provider=ADsDSOObject;\"\nSet objCommand = CreateObject(\"ADODB.Command\")\nobjCommand.ActiveConnection = objConnection\nobjCommand.Properties(\"Chase referrals\") = ADS_CHASE_REFERRALS_ALWAYS\n\nSet rootDSE = GetObject(\"LDAP://RootDSE\")\nSet dom = GetObject(\"LDAP://\" &amp; rootDSE.Get(\"defaultNamingContext\"))\nobjCommand.CommandText = \"&lt;\" &amp; dom.ADsPath &amp; \"&gt;;\" &amp; _\n    \"(&amp;(objectClass=user)(objectCategory=Person)(sAMAccountName=\" &amp; LoginName &amp; \"));\" &amp; _\n    \"distinguishedName,sAMAccountName;subtree\"\nSet objRecordSet = objCommand.Execute\n</code></pre>\n\n<p>This works fine now. </p>\n\n<p>Thank you!</p>\n"}], "owner": {"reputation": 261, "user_id": 2317084, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8ccca93bbd44aa56adb8f0d1f4b236f8?s=128&d=identicon&r=PG", "display_name": "user2317084", "link": "https://stackoverflow.com/users/2317084/user2317084"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4530, "favorite_count": 0, "accepted_answer_id": 28218574, "answer_count": 3, "score": 0, "last_activity_date": 1422545820, "creation_date": 1422459489, "last_edit_date": 1422470677, "question_id": 28196284, "link": "https://stackoverflow.com/questions/28196284/find-user-by-samaccountname-vba", "title": "Find user by sAMAccountName VBA", "body": "<p>I'm trying to find a user in AD by their sAMAccountName. Here's my code:</p>\n\n<pre><code>sQuery = \"&lt;LDAP://OU=theOU,DC=mainDC,DC=com&gt;;(&amp;(objectClass=user)(objectCategory=Person)(sAMAccountName=sAMA));distinguishedName,sAMAccountName;subtree\"\n</code></pre>\n\n<p>I execute this query by</p>\n\n<pre><code>Dim conn As New ADODB.Connection\nDim rs As ADODB.Recordset\nconn.Open _\n\"Data Source=Active Directory Provider;Provider=ADsDSOObject\"\nSet rs = conn.Execute(sQuery)\n</code></pre>\n\n<p>The query doesn't fails. I've also tried changing the query to this:</p>\n\n<pre><code>&lt;LDAP://OU=theOU,DC=mainDC,DC=com&gt;;(&amp;(objectClass=user)(objectCategory=Person)(sAMAccountName=sAMA));subtree\n</code></pre>\n\n<p>but that fails as well. </p>\n\n<p>I'm doing this in VBA, any help is much appreciated!</p>\n\n<p>The error I get is:</p>\n\n<pre><code>A referral was returned from the server.\n</code></pre>\n\n<p>Also, is there an easier way to search multiple domains other than just query twice?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "internet-explorer", "excel"], "comments": [{"owner": {"reputation": 27, "user_id": 4273302, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d3e6d8f36125ecc9271c2cfe987ebf12?s=128&d=identicon&r=PG&f=1", "display_name": "Shyam", "link": "https://stackoverflow.com/users/4273302/shyam"}, "edited": false, "score": 0, "creation_date": 1422459258, "post_id": 28196170, "comment_id": 44758951, "body": "In addition I have simliar drop downs for about 100 + drop down.. If I know for the second one, I can replicate.."}, {"owner": {"reputation": 27, "user_id": 4273302, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d3e6d8f36125ecc9271c2cfe987ebf12?s=128&d=identicon&r=PG&f=1", "display_name": "Shyam", "link": "https://stackoverflow.com/users/4273302/shyam"}, "edited": false, "score": 0, "creation_date": 1422460999, "post_id": 28196170, "comment_id": 44760183, "body": "Drop downs are.more but I have given less drop downs"}], "owner": {"reputation": 27, "user_id": 4273302, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d3e6d8f36125ecc9271c2cfe987ebf12?s=128&d=identicon&r=PG&f=1", "display_name": "Shyam", "link": "https://stackoverflow.com/users/4273302/shyam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1424227059, "creation_date": 1422459166, "last_edit_date": 1531164843, "question_id": 28196170, "link": "https://stackoverflow.com/questions/28196170/vba-combo-box-issue-in-internet-explorer", "title": "VBA Combo box issue in Internet Explorer", "body": "<p>I have this following code</p>\n\n<pre><code>**HTML CODE:**\n\n&lt;li id=\"autofill_0_item_1\" class=\"autofillItem\" style=\"clear:left\"&gt;\n&lt;a href=\"javascript://\" onclick=\"autofillRemoveField(0, 1); return false;\" class=\"afItemAction afItemDelete\" title=\"Delete Item\"&gt;&lt;/a&gt;\n\n&lt;select name=\"plugins[autofill][groups][0][fields][from][]\" id=\"auto_fill_field_from\"&gt;\n&lt;option value=\"\"&gt;-- Select Field --&lt;/option&gt;\n&lt;optgroup label=\"Macro Trail Ca ( use this)\"&gt;\n&lt;option value=\"28929037\"&gt;Application Start Date &amp;amp; Time:&lt;/option&gt;\n&lt;option value=\"28929039\"&gt;Assisting Representative:&lt;/option&gt;\n&lt;option value=\"28929124\"&gt;(3rd Source) How m...PLOYEMNT Position:&lt;/option&gt;\n/optgroup&gt;\n&lt;/select&gt;\n\n&lt;select name=\"plugins[autofill][groups][0][fields][from][]\" id=\"auto_fill_field_to\"&gt;\n&lt;option value=\"\"&gt;-- Select Field --&lt;/option&gt;\n&lt;optgroup label=\"Macro Trail Ca ( use this)\"&gt;\n\n&lt;option value=\"28929037\"&gt;Application Start Date &amp;amp; Time:&lt;/option&gt;\n&lt;option value=\"28929039\"&gt;Assisting Representative:&lt;/option&gt;\n&lt;option value=\"28929124\"&gt;(3rd Source) How m...PLOYEMNT Position:&lt;/option&gt;\n\n&lt;/optgroup&gt;\n&lt;/select&gt;\n\n&lt;li id=\"autofill_0_item_2\" class=\"autofillItem\" style=\"clear:left\"&gt;\n&lt;a href=\"javascript://\" onclick=\"autofillRemoveField(0, 1); return false;\" class=\"afItemAction afItemDelete\" title=\"Delete Item\"&gt;&lt;/a&gt;\n&lt;select name=\"plugins[autofill][groups][0][fields][from][]\" id=\"auto_fill_field_from\"&gt;\n&lt;option value=\"\"&gt;-- Select Field --&lt;/option&gt;\n&lt;optgroup label=\"Macro Trail Ca ( use this)\"&gt;\n\n&lt;option value=\"28929037\"&gt;Application Start Date &amp;amp; Time:&lt;/option&gt;\n&lt;option value=\"28929039\"&gt;Assisting Representative:&lt;/option&gt;\n&lt;option value=\"28929124\"&gt;(3rd Source) How m...PLOYEMNT Position:&lt;/option&gt;\n\n&lt;/optgroup&gt;\n&lt;/select&gt;\n\n&lt;select name=\"plugins[autofill][groups][0][fields][from][]\" id=\"auto_fill_field_to\"&gt;\n&lt;option value=\"\"&gt;-- Select Field --&lt;/option&gt;\n&lt;optgroup label=\"Macro Trail Ca ( use this)\"&gt;\n\n&lt;option value=\"28929037\"&gt;Application Start Date &amp;amp; Time:&lt;/option&gt;\n&lt;option value=\"28929039\"&gt;Assisting Representative:&lt;/option&gt;\n&lt;option value=\"28929124\"&gt;(3rd Source) How m...PLOYEMNT Position:&lt;/option&gt;\n\n&lt;/optgroup&gt;\n&lt;/select&gt;\n\n\n\n\nI which I am trying to select respective drop down based on Selected index.\n\n\n    For Each oHTML_Element In HTMLDoc.getElementsByTagName(\"li\")\n    If (InStr(oHTML_Element.ID, \"autofill_0_item_1\") &gt; 0) Then\n    HTMLDoc.getElementById(\"auto_fill_field_from\").selectedIndex = 6\n    HTMLDoc.getElementById(\"auto_fill_field_to\").selectedIndex = 4\n    Exit For\n    End If\n    Next\n</code></pre>\n\n<p>But the same code if use \"<code>autofill_0_item_2</code>\" does not work. Basically, the first combo box gets the update.</p>\n\n<p>I tried various things but still no go.</p>\n\n<p>Can some help me with the code so that second combo box can be updated?</p>\n\n<p>I have to use selected index as I have drop down values but under different sections. Basically, only the description/label is the same but the values assigned is different.</p>\n\n<p>I cant use the values because it is dynamic.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 3, "creation_date": 1422459169, "post_id": 28196028, "comment_id": 44758883, "body": "That&#39;s precisely it. If you want the same code triggered for all (or several) sheets, it&#39;s often easier to use the Workbook level event."}], "answers": [{"comments": [{"owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "edited": false, "score": 0, "creation_date": 1422459796, "post_id": 28196211, "comment_id": 44759324, "body": "Thank you for giving a very helpful answer!"}], "tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": 4, "last_activity_date": 1422459284, "creation_date": 1422459284, "answer_id": 28196211, "question_id": 28196028, "link": "https://stackoverflow.com/questions/28196028/usages-for-worksheet-selectionchange-and-workbook-sheetselectionchange-events/28196211#28196211", "title": "Usages for Worksheet_SelectionChange and Workbook_SheetSelectionChange events", "body": "<p>It seems you answered your own question.</p>\n\n<p>If you want Change events to happen specific to ONE sheet, then put <code>Worksheet_SelectionChange</code> into the Sheet's module.</p>\n\n<p>If you want Change events to happen on every sheet in the book, then put <code>Workbook_SheetSelectionChange</code> into the Book's module.</p>\n\n<p>Note, if you only want say 3 of 5 sheets triggering, you could run a check at the beginning of the Workbook_Change event to check for Sheet.Name</p>\n"}, {"comments": [{"owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "edited": false, "score": 0, "creation_date": 1422459754, "post_id": 28196237, "comment_id": 44759298, "body": "Thank you for giving a very helpful answer!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 6, "last_activity_date": 1422459372, "creation_date": 1422459372, "answer_id": 28196237, "question_id": 28196028, "link": "https://stackoverflow.com/questions/28196028/usages-for-worksheet-selectionchange-and-workbook-sheetselectionchange-events/28196237#28196237", "title": "Usages for Worksheet_SelectionChange and Workbook_SheetSelectionChange events", "body": "<p>The single parameter supplied by the <code>Worksheet_SelectionChange</code> event macro is the cell or range of cells that have just been selected, e.g. <em>Target</em>. The <code>Workbook_SheetSelectionChange</code> supplies that but adds the worksheet where the selection was made with <em>Sh</em>.</p>\n\n<p>If you want the same thing to happen on multiple worksheets (not necessarily all of them), use <code>Workbook_SheetSelectionChange</code> and deal with the <em>Sh</em> parameter. This also centralizes your code so that modifications do not have to be repeated in several places. If you are only planning on reacting to selection changes on a single worksheet, use that worksheet's <code>Worksheet_SelectionChange</code> event macro on its own sheet code page.</p>\n"}], "owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2843, "favorite_count": 1, "accepted_answer_id": 28196237, "answer_count": 2, "score": 3, "last_activity_date": 1422459563, "creation_date": 1422458781, "last_edit_date": 1422459563, "question_id": 28196028, "link": "https://stackoverflow.com/questions/28196028/usages-for-worksheet-selectionchange-and-workbook-sheetselectionchange-events", "title": "Usages for Worksheet_SelectionChange and Workbook_SheetSelectionChange events", "body": "<p>As far as I understand it they do the same thing, but while </p>\n\n<pre><code>Worksheet_SelectionChange\n</code></pre>\n\n<p>is triggered every time selection is changed on <strong>a single</strong> worksheet,</p>\n\n<pre><code>Workbook_SheetSelectionChange\n</code></pre>\n\n<p>is triggered every time selection is changed in <strong>any</strong> worksheet in the workbook.</p>\n\n<p><strong><em>Are there any other differences between these events?</em></strong></p>\n"}, {"tags": ["vba", "excel", "powerpoint"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1422460249, "post_id": 28195978, "comment_id": 44759668, "body": "It would be helpful if you posted the relevant code."}, {"owner": {"reputation": 49, "user_id": 4303927, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3a87a6520bcc3daa0a4593599d0618bb?s=128&d=identicon&r=PG&f=1", "display_name": "lererferler", "link": "https://stackoverflow.com/users/4303927/lererferler"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 1, "creation_date": 1422460543, "post_id": 28195978, "comment_id": 44759892, "body": "The issue isn&#39;t about the code though. It crashes randomly wherever in the code. Not at exact points. Ill edit my original post anyway"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 1, "creation_date": 1422460761, "post_id": 28195978, "comment_id": 44760039, "body": "That would be helpful as you cannot expect help on SO without some code for users to look over."}], "answers": [{"tags": [], "owner": {"reputation": 10875, "user_id": 2392157, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QEWAU.png?s=128&g=1", "display_name": "miroxlav", "link": "https://stackoverflow.com/users/2392157/miroxlav"}, "is_accepted": true, "score": 1, "last_activity_date": 1423847796, "last_edit_date": 1423847796, "creation_date": 1423847423, "answer_id": 28504964, "question_id": 28195978, "link": "https://stackoverflow.com/questions/28195978/vba-crashing-when-pasting-into-powerpoint/28504964#28504964", "title": "VBA Crashing when pasting into Powerpoint", "body": "<p>I learned from you that the error it gives is <code>Shapes.PasteSpecial : Invalid request. Clipboard is empty or contains data which may not be pasted here.</code></p>\n\n<p>The problem is that clipboard is not ready for pasting immediately after calling copy operation, but it needs some time to load the data. Let's give it the time:</p>\n\n<ol>\n<li><p>Add small module containing this code:</p>\n\n<pre><code>Option Explicit \n\n#If VBA7 Then \nPublic Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As LongPtr) 'For 64 Bit Systems \n#Else \nPublic Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long) 'For 32 Bit Systems \n#End If \n</code></pre></li>\n<li><p>Now insert the following delay between your copy and paste statements:</p>\n\n<pre><code>Dim i as Integer\nFor i = 1 To 6 \n  DoEvents() \n  Sleep 500 'milliseconds\nNext i\n</code></pre></li>\n</ol>\n\n<p>This should give copy operation enough time to populate the clipboard.</p>\n\n<p>You can adjust constant <code>\"6\"</code> in the above loop if it is too high or too low.</p>\n"}], "owner": {"reputation": 49, "user_id": 4303927, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3a87a6520bcc3daa0a4593599d0618bb?s=128&d=identicon&r=PG&f=1", "display_name": "lererferler", "link": "https://stackoverflow.com/users/4303927/lererferler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2965, "favorite_count": 0, "accepted_answer_id": 28504964, "answer_count": 1, "score": 0, "last_activity_date": 1423847796, "creation_date": 1422458628, "last_edit_date": 1422460724, "question_id": 28195978, "link": "https://stackoverflow.com/questions/28195978/vba-crashing-when-pasting-into-powerpoint", "title": "VBA Crashing when pasting into Powerpoint", "body": "<p>I have made a macro which creates some graphs in excel and then opens powerpoint and pastes them into a template. Over the past couple of weeks and it has been working completely fine but after adding some things into the macro (which are completely separate things like refreshing data and setting filters) it seems to be crashing when pasting the graphs into powerpoint. Anyone else had similar issues in the past? There doesn't seem to be any reason why it should be doing it at all...</p>\n\n<pre><code>Sub PowerpointPres(r)\nDim PPT As Object\nDim PPApp As Object\nDim PPPres As Object\nDim PPSlide As Object\nDim PPShape As Shape\n\nSet PPT = CreateObject(\"PowerPoint.Application\")\nPPT.Visible = True\n\nPPT.Presentations.Open filename:=\"S:\\Commercial Finance\\Macros for Standard Reporting\\Country Manager Presentation Macro\\CM Presentation Template.pptm\"\n\nSet PPApp = CreateObject(\"Powerpoint.Application\")\nSet PPApp = GetObject(, \"Powerpoint.Application\")\nSet PPPres = PPApp.ActivePresentation\n\n'Slide 1\nSet PPSlide = PPPres.Slides(1)\nPPSlide.Shapes(1).TextFrame.TextRange.Text = r &amp; \" Country Review YTD \" &amp; Year(Now())\n\n'Slide 2\nSet PPSlide = PPPres.Slides(2)\nPPSlide.Shapes(1).TextFrame.TextRange.Text = r &amp; \" Country Review YTD \" &amp; Year(Now())\n\n'Slide 3\nPivots.ChartObjects(1).Copy\n\ni = Pivots.Range(\"G14\").Text\nj = Pivots.Range(\"H14\").Text\n\nSet PPSlide = PPPres.Slides(3)\n\nWith PPSlide\n.Shapes(1).TextFrame.TextRange.Text = r &amp; \" TCV YTD \" &amp; Year(Now()) - 1 &amp; \" and \" &amp; Year(Now()) &amp; \" - by Sector\"\n.Shapes(2).TextFrame.TextRange.Text = \"Totals:\" &amp; Year(Now()) - 1 &amp; \":\" &amp; i &amp; \"\" &amp; Year(Now()) &amp; \":\" &amp; j\nEnd With\nPPApp.ActiveWindow.View.GotoSlide (3)\nPPSlide.Shapes.PasteSpecial(DataType:=ppPasteDefault).Select\n'PPApp.ActiveWindow.View.Paste\nWith PPSlide.Shapes(3)\n    .Top = 55\n    .Left = 85\n    .Height = 350\n    .Width = 550\n    With .Chart.SeriesCollection(1).Format.Fill\n        .TwoColorGradient 2, 1\n        .ForeColor.RGB = RGB(0, 94, 140)\n        .BackColor.RGB = RGB(0, 165, 241)\n        .GradientStops.Insert RGB(0, 138, 202), 0.5\n    End With\n    With .Chart.SeriesCollection(2).Format.Fill\n        .TwoColorGradient 2, 1\n        .ForeColor.RGB = RGB(85, 85, 85)\n        .BackColor.RGB = RGB(125, 125, 125)\n        .GradientStops.Insert RGB(150, 150, 150), 0.5\n    End With\nEnd With\n\nApplication.Wait (Now + TimeValue(\"00:00:05\"))\n\n'Slide 4\nPivots.ChartObjects(2).Copy\n\ni = Pivots.Range(\"V14\").Text\nj = Pivots.Range(\"W14\").Text\n\nSet PPSlide = PPPres.Slides(4)\n\nWith PPSlide\n.Shapes(1).TextFrame.TextRange.Text = r &amp; \" TCV YTD \" &amp; Year(Now()) - 1 &amp; \" and \" &amp; Year(Now()) &amp; \" - by Type\"\n.Shapes(2).TextFrame.TextRange.Text = \"Totals:\" &amp; Year(Now()) - 1 &amp; \":\" &amp; i &amp; \"\" &amp; Year(Now()) &amp; \":\" &amp; j\nEnd With\nPPApp.ActiveWindow.View.GotoSlide (4)\n'PPApp.CommandBars.ExecuteMso (\"PasteSourceFormatting\")\nPPSlide.Shapes.PasteSpecial(DataType:=ppPasteDefault).Select\nWith PPSlide.Shapes(3)\n    .Top = 55\n    .Left = 85\n    .Height = 350\n    .Width = 550\n    With .Chart.SeriesCollection(1).Format.Fill\n        .TwoColorGradient 2, 1\n        .ForeColor.RGB = RGB(0, 94, 140)\n        .BackColor.RGB = RGB(0, 165, 241)\n        .GradientStops.Insert RGB(0, 138, 202), 0.5\n    End With\n    With .Chart.SeriesCollection(2).Format.Fill\n        .TwoColorGradient 2, 1\n        .ForeColor.RGB = RGB(85, 85, 85)\n        .BackColor.RGB = RGB(125, 125, 125)\n        .GradientStops.Insert RGB(150, 150, 150), 0.5\n    End With\nEnd With\n\n'Slide 5\nLRow = Pivots.Range(\"AH8\").End(xlDown).Row\nPivots.Range(\"AH8:AI\" &amp; LRow).Copy\n\nSet PPSlide = PPPres.Slides(5)\n\nPPApp.ActiveWindow.View.GotoSlide (5)\nPPApp.ActiveWindow.View.Paste\nWith PPSlide.Shapes(2)\n    .Top = 70\n    .Left = 50\n    .Height = 400\n    .Width = 200\nEnd With\n\nPivots.ChartObjects(3).Copy\n\nPPApp.ActiveWindow.View.GotoSlide (5)\nWith PPSlide\n.Shapes(1).TextFrame.TextRange.Text = r &amp; \" New TCV by AM YTD \" &amp; Year(Now())\nEnd With\nPPApp.ActiveWindow.View.Paste\nWith PPSlide.Shapes(3)\n    .Top = 80\n    .Left = 300\n    .Height = 380\n    .Width = 350\nEnd With\n\n'Slide 6\nLRow = Pivots.Range(\"AN8\").End(xlDown).Row\nPivots.Rows(\"8:\" &amp; LRow).RowHeight = 20\nPivots.Range(\"AN8:AO\" &amp; LRow).Copy\n\nSet PPSlide = PPPres.Slides(6)\n\nPPApp.ActiveWindow.View.GotoSlide (6)\nPPApp.ActiveWindow.View.Paste\nWith PPSlide.Shapes(2)\n    .Top = 70\n    .Left = 50\n    .Height = 380\n    .Width = 200\nEnd With\n\nPivots.ChartObjects(4).Copy\n\nPPApp.ActiveWindow.View.GotoSlide (6)\nWith PPSlide\n.Shapes(1).TextFrame.TextRange.Text = r &amp; \" New TCV by Product YTD \" &amp; Year(Now())\nEnd With\nPPApp.ActiveWindow.View.Paste\nWith PPSlide.Shapes(3)\n    .Top = 80\n    .Left = 300\n    .Height = 380\n    .Width = 350\nEnd With\n\nApplication.Wait (Now + TimeValue(\"00:00:05\"))\n\n'Slide 7\nLRow = Pivots.Range(\"AY8\").End(xlDown).Row\nPivots.Range(\"AT1:AZ\" &amp; LRow).Copy\n\nSet PPSlide = PPPres.Slides(7)\n\nPPApp.ActiveWindow.View.GotoSlide (7)\n'PPSlide.Shapes.PasteSpecial(DataType:=2).Select\nPPApp.ActiveWindow.View.Paste\nWith PPSlide\n.Shapes(1).TextFrame.TextRange.Text = r &amp; \" Top 10 TCV New Deals Signed YTD \" &amp; Year(Now())\nEnd With\n\nWith PPSlide.Shapes(2)\n    .Top = 70\n    .Left = 30\n    .Height = 380\n    .Width = 660\nEnd With\n\n'Slide 9\nLRow = Pivots.Range(\"BG1\").End(xlDown).Row\nPivots.Range(\"BD1:BG\" &amp; LRow).Copy\n\nSet PPSlide = PPPres.Slides(9)\n\nPPApp.ActiveWindow.View.GotoSlide (9)\n'PPSlide.Shapes.PasteSpecial(DataType:=2).Select\nPPApp.ActiveWindow.View.Paste\nWith PPSlide\n.Shapes(1).TextFrame.TextRange.Text = r &amp; \" IR \u2013 Top 10 Customers YTD \" &amp; Year(Now())\nEnd With\n\nWith PPSlide.Shapes(2)\n    .Top = 70\n    .Left = 30\n    .Height = 380\n    .Width = 660\nEnd With\n\nApplication.Wait (Now + TimeValue(\"00:00:05\"))\n\n'Slide 10\nPivots.ChartObjects(11).Copy\n\ni = Pivots.Range(\"CZ19\").Text\nj = Pivots.Range(\"DA19\").Text\n\nSet PPSlide = PPPres.Slides(10)\n\nWith PPSlide\n.Shapes(1).TextFrame.TextRange.Text = r &amp; \" New IIR YTD \" &amp; Year(Now()) - 1 &amp; \" and \" &amp; Year(Now()) &amp; \" - by Sales Sector\"\n.Shapes(2).TextFrame.TextRange.Text = \"Totals:\" &amp; Year(Now()) - 1 &amp; \":\" &amp; i &amp; \"\" &amp; Year(Now()) &amp; \":\" &amp; j\nEnd With\nPPApp.ActiveWindow.View.GotoSlide (10)\nPPSlide.Shapes.PasteSpecial(DataType:=ppPasteDefault).Select\n'PPApp.ActiveWindow.View.Paste\nWith PPSlide.Shapes(3)\n    .Top = 55\n    .Left = 85\n    .Height = 350\n    .Width = 550\n    With .Chart.SeriesCollection(1).Format.Fill\n        .TwoColorGradient 2, 1\n        .ForeColor.RGB = RGB(0, 94, 140)\n        .BackColor.RGB = RGB(0, 165, 241)\n        .GradientStops.Insert RGB(0, 138, 202), 0.5\n    End With\n    With .Chart.SeriesCollection(2).Format.Fill\n        .TwoColorGradient 2, 1\n        .ForeColor.RGB = RGB(85, 85, 85)\n        .BackColor.RGB = RGB(125, 125, 125)\n        .GradientStops.Insert RGB(150, 150, 150), 0.5\n    End With\nEnd With\n\n'Slide 11\n\nPivots.ChartObjects(5).Copy\n\nSet PPSlide = PPPres.Slides(11)\n\nLRow = Pivots.Range(\"BK:BO\").Find(\"*\", searchorder:=xlByRows, searchdirection:=xlPrevious).Row\n\ni = Pivots.Range(\"BL\" &amp; LRow).Text\nj = Pivots.Range(\"BM\" &amp; LRow).Text\nk = Pivots.Range(\"BN\" &amp; LRow).Text\nl = Pivots.Range(\"BO\" &amp; LRow).Text\n\nPPApp.ActiveWindow.View.GotoSlide (11)\nWith PPSlide\n.Shapes(1).TextFrame.TextRange.Text = r &amp; \" Monthly Net MRC YTD \" &amp; Year(Now())\nWith .Shapes(2)\n    .TextFrame.TextRange.Text = \"MRC Won \" &amp; Year(Now()) &amp; \" YTD:         \u20ac \" &amp; i\n    .Top = 5\n    .Left = 475\n    .Height = 30\n    .Width = 250\nEnd With\n\nWith .Shapes(3)\n    .TextFrame.TextRange.Text = \"MRC Ceased \" &amp; Year(Now()) &amp; \" YTD:    \u20ac \" &amp; j\n    .Top = 20\n    .Left = 475\n    .Height = 30\n    .Width = 250\nEnd With\n\nWith .Shapes(4)\n    .TextFrame.TextRange.Text = \"MRC Erosion \" &amp; Year(Now()) &amp; \" YTD:    \u20ac \" &amp; k\n    .Top = 35\n    .Left = 475\n    .Height = 30\n    .Width = 250\nEnd With\n\nWith .Shapes(5)\n    .TextFrame.TextRange.Text = \"Net MRC \" &amp; Year(Now()) &amp; \" YTD:           \u20ac \" &amp; l\n    .Top = 50\n    .Left = 475\n    .Height = 30\n    .Width = 250\nEnd With\n\nEnd With\nPPApp.ActiveWindow.View.Paste\nWith PPSlide.Shapes(6)\n    .Top = 80\n    .Left = 30\n    .Height = 380\n    .Width = 650\n    With .Chart\n        .ChartStyle = 2\n        .SeriesCollection(1).Format.Fill.ForeColor.RGB = RGB(146, 208, 80)\n        .SeriesCollection(2).Format.Fill.ForeColor.RGB = RGB(255, 0, 0)\n        .SeriesCollection(3).Format.Fill.ForeColor.RGB = RGB(246, 139, 31)\n        .SeriesCollection(4).Format.Fill.ForeColor.RGB = RGB(51, 51, 255)\n    End With\nEnd With\n\n'Slide 12\nLRow = Pivots.Range(\"BR1\").End(xlDown).Row\nPivots.Range(\"BR1:BW\" &amp; LRow).Copy\n\nSet PPSlide = PPPres.Slides(12)\n\nPPApp.ActiveWindow.View.GotoSlide (12)\n'PPSlide.Shapes.PasteSpecial(DataType:=2).Select\nPPApp.ActiveWindow.View.Paste\nWith PPSlide\n.Shapes(1).TextFrame.TextRange.Text = r &amp; \" Net MRC - Top 10 Customer YTD \" &amp; Year(Now())\nEnd With\n\nWith PPSlide.Shapes(2)\n    .Top = 70\n    .Left = 30\n    .Height = 380\n    .Width = 660\nEnd With\n\nApplication.Wait (Now + TimeValue(\"00:00:05\"))\n\n'Slide 13\nPivots.ChartObjects(6).Copy\n\nSet PPSlide = PPPres.Slides(13)\n\nPPApp.ActiveWindow.View.GotoSlide (13)\nWith PPSlide\n.Shapes(1).TextFrame.TextRange.Text = r &amp; \" Revenue at Risk \u2013 MRC up for renewal\"\nEnd With\nPPApp.ActiveWindow.View.Paste\nWith PPSlide.Shapes(2)\n    .Top = 50\n    .Left = 30\n    .Height = 420\n    .Width = 650\n    .Chart.ChartStyle = 8\nEnd With\n\n'Slide 14\nPivots.ChartObjects(7).Copy\n\nSet PPSlide = PPPres.Slides(14)\n\nPPApp.ActiveWindow.View.GotoSlide (14)\nWith PPSlide\n.Shapes(1).TextFrame.TextRange.Text = r &amp; \" Revenue at Risk \u2013 Top 10 MRC up for renewal \" &amp; Year(Now())\nEnd With\nPPApp.ActiveWindow.View.Paste\nWith PPSlide.Shapes(2)\n    .Top = 50\n    .Left = 30\n    .Height = 420\n    .Width = 650\n    .Chart.ChartStyle = 8\nEnd With\n\n'Slide 15\nPivots.ChartObjects(8).Copy\n\nSet PPSlide = PPPres.Slides(15)\ni = Year(DateSerial(Year(Now()), Month(Now()), Day(Now())))\nj = Month(DateSerial(Year(Now()), Month(Now()), Day(Now())))\nPPApp.ActiveWindow.View.GotoSlide (15)\nWith PPSlide\n.Shapes(1).TextFrame.TextRange.Text = r &amp; \" \u2013 Top 5 MRC expiring \" &amp; Left(MonthName(j), 3) &amp; \"-\" &amp; i\nEnd With\nPPApp.ActiveWindow.View.Paste\nWith PPSlide.Shapes(2)\n    .Top = 50\n    .Left = 30\n    .Height = 370\n    .Width = 650\n    .Chart.ChartStyle = 8\nEnd With\n\nApplication.Wait (Now + TimeValue(\"00:00:05\"))\n\n'Slide 16\nPivots.ChartObjects(9).Copy\n\nSet PPSlide = PPPres.Slides(16)\ni = Year(DateSerial(Year(Now()), Month(Now()) + 1, Day(Now())))\nj = Month(DateSerial(Year(Now()), Month(Now()) + 1, Day(Now())))\nPPApp.ActiveWindow.View.GotoSlide (16)\nWith PPSlide\n.Shapes(1).TextFrame.TextRange.Text = r &amp; \" \u2013 Top 5 MRC expiring \" &amp; Left(MonthName(j), 3) &amp; \"-\" &amp; i\nEnd With\nPPApp.ActiveWindow.View.Paste\nWith PPSlide.Shapes(2)\n    .Top = 50\n    .Left = 30\n    .Height = 370\n    .Width = 650\n    .Chart.ChartStyle = 8\nEnd With\n\n'Slide 17\nPivots.ChartObjects(10).Copy\n\nSet PPSlide = PPPres.Slides(17)\ni = Year(DateSerial(Year(Now()), Month(Now()) + 2, Day(Now())))\nj = Month(DateSerial(Year(Now()), Month(Now()) + 2, Day(Now())))\nPPApp.ActiveWindow.View.GotoSlide (17)\nWith PPSlide\n.Shapes(1).TextFrame.TextRange.Text = r &amp; \" \u2013 Top 5 MRC expiring \" &amp; Left(MonthName(j), 3) &amp; \"-\" &amp; i\nEnd With\nPPApp.ActiveWindow.View.Paste\nWith PPSlide.Shapes(2)\n    .Top = 50\n    .Left = 30\n    .Height = 370\n    .Width = 650\n    .Chart.ChartStyle = 8\nEnd With\n\n'Slide 18\nPivots.Range(\"FJ1:FO11\").Copy\n\nSet PPSlide = PPPres.Slides(18)\n\nPPApp.ActiveWindow.View.GotoSlide (18)\nPPApp.ActiveWindow.View.Paste\nWith PPSlide.Shapes(1)\n    .TextFrame.TextRange.Text = r &amp; \": SalesForce Pipeline &amp; Top Deals\"\n    .Left = 100\n    .Top = 10\n    .Height = 50\n    .Width = 650\nEnd With\n\nPivots.Range(\"SalesForceTable2\").Copy\nPPApp.ActiveWindow.View.Paste\n\nWith PPSlide.Shapes(2)\n    .Top = 130\n    .Left = 30\n    .Height = 320\n    .Width = 660\nEnd With\n\nWith PPSlide.Shapes(3)\n    .Top = 70\n    .Left = 30\n    .Height = 50\n    .Width = 660\nEnd With\n\nApplication.Wait (Now + TimeValue(\"00:00:05\"))\n\n'Slide 19\nLRow = Pivots.Range(\"EC1\").End(xlDown).Row\n\nIf LRow &lt; 19 Then\nPivots.Range(\"EC1:EL\" &amp; LRow).Copy\nElse\nPivots.Range(\"EC1:EL19\").Copy\nEnd If\n\nSet PPSlide = PPPres.Slides(19)\n\nPPApp.ActiveWindow.View.GotoSlide (19)\n'PPSlide.Shapes.PasteSpecial(DataType:=2).Select\nPPApp.ActiveWindow.View.Paste\nWith PPSlide.Shapes(1)\n    .TextFrame.TextRange.Text = r &amp; \" Individual Performance YTD \" &amp; Year(Now()) &amp; \" (pg1)\"\n    .Left = 20\n    .Top = 20\n    .Height = 50\n    .Width = 650\nEnd With\n\nWith PPSlide.Shapes(2)\n    .Top = 70\n    .Left = 30\n    .Height = 380\n    .Width = 660\nEnd With\n\n'Slide 20\nIf LRow &gt; 19 Then\n\nPivots.Range(\"EM2:EV20\").ClearContents\n\nIf LRow &gt; 19 And LRow &lt;= 37 Then\nPivots.Range(\"EC20:EL\" &amp; LRow).Copy\nElse\nPivots.Range(\"EC20:EL37\").Copy\nEnd If\n\nPivots.Range(\"EM2\").PasteSpecial xlValues\n\nLRow2 = Pivots.Range(\"EM1\").End(xlDown).Row\n\nColumns(\"EM:EV\").EntireColumn.AutoFit\n\nPivots.Range(\"EM1:EV\" &amp; LRow2).Copy\n\nSet PPLayout = PPPres.Slides(19).CustomLayout\nSet PPSlide = PPPres.Slides.AddSlide(20, PPLayout)\nSet PPSlide = PPPres.Slides(20)\n\nWith PPSlide\n.Shapes(2).Delete\nEnd With\n\nPPApp.ActiveWindow.View.GotoSlide (20)\nPPApp.ActiveWindow.View.Paste\nWith PPSlide.Shapes(1)\n    .TextFrame.TextRange.Font.Size = 28\n    .TextFrame.TextRange.Text = r &amp; \" Individual Performance YTD \" &amp; Year(Now()) &amp; \" (pg2)\"\n    .Left = 20\n    .Top = 20\n    .Height = 50\n    .Width = 650\nEnd With\n\nWith PPSlide.Shapes(2)\n    .Top = 70\n    .Left = 30\n    .Height = 380\n    .Width = 660\nEnd With\n\nElse\n\nOn Error GoTo ContinueHere\n\nFor i = PPApp.Slides.Count To 20 Step -1\n\nPPPres.Slides(i).Delete\n\nNext\n\nOn Error GoTo 0\n\nEnd If\n\nApplication.Wait (Now + TimeValue(\"00:00:05\"))\n\n'slide 21\nIf LRow &gt; 37 Then\n\nPivots.Range(\"EM2:EV20\").ClearContents\n\nIf LRow &gt; 37 And LRow &lt;= 55 Then\nPivots.Range(\"EC38:EL\" &amp; LRow).Copy\nElse\nPivots.Range(\"EC38:EL55\").Copy\nEnd If\n\nPivots.Range(\"EM2\").PasteSpecial xlValues\n\nLRow2 = Pivots.Range(\"EM1\").End(xlDown).Row\n\nColumns(\"EM:EV\").EntireColumn.AutoFit\n\nPivots.Range(\"EM1:EV\" &amp; LRow2).Copy\n\nSet PPLayout = PPPres.Slides(19).CustomLayout\nSet PPSlide = PPPres.Slides.AddSlide(21, PPLayout)\nSet PPSlide = PPPres.Slides(21)\n\nWith PPSlide\n.Shapes(2).Delete\nEnd With\n\nPPApp.ActiveWindow.View.GotoSlide (21)\nPPApp.ActiveWindow.View.Paste\nWith PPSlide.Shapes(1)\n    .TextFrame.TextRange.Font.Size = 28\n    .TextFrame.TextRange.Text = r &amp; \" Individual Performance YTD \" &amp; Year(Now()) &amp; \" (pg3)\"\n    .Left = 20\n    .Top = 20\n    .Height = 50\n    .Width = 650\nEnd With\n\nWith PPSlide.Shapes(2)\n    .Top = 70\n    .Left = 30\n    .Height = 380\n    .Width = 660\nEnd With\n\nElse\n\nOn Error GoTo ContinueHere\n\nFor i = PPApp.Slides.Count To 20 Step -1\n\nPPPres.Slides(i).Delete\n\nNext\n\nOn Error GoTo 0\n\nEnd If\n\n'Slide 22\nIf LRow &gt; 55 Then\n\nPivots.Range(\"EM2:EV20\").ClearContents\n\nIf LRow &gt; 55 And LRow &lt;= 73 Then\nPivots.Range(\"EC56:EL\" &amp; LRow).Copy\nElse\nPivots.Range(\"EC56:EL73\").Copy\nEnd If\n\nPivots.Range(\"EM2\").PasteSpecial xlValues\n\nLRow2 = Pivots.Range(\"EM1\").End(xlDown).Row\n\nColumns(\"EM:EV\").EntireColumn.AutoFit\n\nPivots.Range(\"EM1:EV\" &amp; LRow2).Copy\n\nSet PPLayout = PPPres.Slides(19).CustomLayout\nSet PPSlide = PPPres.Slides.AddSlide(22, PPLayout)\nSet PPSlide = PPPres.Slides(22)\n\nWith PPSlide\n.Shapes(2).Delete\nEnd With\n\nPPApp.ActiveWindow.View.GotoSlide (22)\nPPApp.ActiveWindow.View.Paste\nWith PPSlide.Shapes(1)\n    .TextFrame.TextRange.Font.Size = 28\n    .TextFrame.TextRange.Text = r &amp; \" Individual Performance YTD \" &amp; Year(Now()) &amp; \" (pg4)\"\n    .Left = 20\n    .Top = 20\n    .Height = 50\n    .Width = 650\nEnd With\n\nWith PPSlide.Shapes(2)\n    .Top = 70\n    .Left = 30\n    .Height = 380\n    .Width = 660\nEnd With\n\nElse\n\nOn Error GoTo ContinueHere\n\nFor i = PPApp.Slides.Count To 20 Step -1\n\nPPPres.Slides(i).Delete\n\nNext\n\nOn Error GoTo 0\n\nEnd If\n\n'slide 23\nIf LRow &gt; 73 Then\n\nPivots.Range(\"EM2:EV20\").ClearContents\n\nIf LRow &gt; 73 And LRow &lt;= 91 Then\nPivots.Range(\"EC74:EL\" &amp; LRow).Copy\nElse\nPivots.Range(\"EC74:EL91\").Copy\nEnd If\n\nPivots.Range(\"EM2\").PasteSpecial xlValues\n\nLRow2 = Pivots.Range(\"EM1\").End(xlDown).Row\n\nColumns(\"EM:EV\").EntireColumn.AutoFit\n\nPivots.Range(\"EM1:EV\" &amp; LRow2).Copy\n\nSet PPLayout = PPPres.Slides(19).CustomLayout\nSet PPSlide = PPPres.Slides.AddSlide(23, PPLayout)\nSet PPSlide = PPPres.Slides(23)\n\nWith PPSlide\n.Shapes(2).Delete\nEnd With\n\nPPApp.ActiveWindow.View.GotoSlide (23)\nPPApp.ActiveWindow.View.Paste\nWith PPSlide.Shapes(1)\n    .TextFrame.TextRange.Font.Size = 28\n    .TextFrame.TextRange.Text = r &amp; \" Individual Performance YTD \" &amp; Year(Now()) &amp; \" (pg5)\"\n    .Left = 20\n    .Top = 20\n    .Height = 50\n    .Width = 650\nEnd With\n\nWith PPSlide.Shapes(2)\n    .Top = 70\n    .Left = 30\n    .Height = 380\n    .Width = 660\nEnd With\n\nElse\n\nOn Error GoTo ContinueHere\n\nFor i = PPApp.Slides.Count To 20 Step -1\n\nPPPres.Slides(i).Delete\n\nNext\n\nOn Error GoTo 0\n\nEnd If\n\nContinueHere:\n\nPPApp.ActivePresentation.SaveAs \"S:\\Commercial Finance\\Macros for Standard Reporting\\Country Manager Presentation Macro\\Outputs\\\" &amp; r &amp; \"\\\" &amp; Format(Now(), \"dd-MM-yyyy\") &amp; \".pptm\"\nPPApp.ActivePresentation.Close\nPPApp.Quit\n\n' Clean up\nSet PPSlide = Nothing\nSet PPPres = Nothing\nSet PPApp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 1, "last_activity_date": 1422458897, "creation_date": 1422458897, "answer_id": 28196068, "question_id": 28195820, "link": "https://stackoverflow.com/questions/28195820/call-macros-from-a-range-list/28196068#28196068", "title": "Call macros from a range/list", "body": "<p>The <code>Application.Run</code> method takes a <code>String</code> as an argument, try to pass the name as a string: </p>\n\n<pre><code>Application.Run \"Module2.\" &amp; mCell.Value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2275, "user_id": 2040286, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38346fd1ac7ec2130b6644fa44acb88c?s=128&d=identicon&r=PG", "display_name": "Paresh J", "link": "https://stackoverflow.com/users/2040286/paresh-j"}, "is_accepted": true, "score": 0, "last_activity_date": 1422458908, "creation_date": 1422458908, "answer_id": 28196072, "question_id": 28195820, "link": "https://stackoverflow.com/questions/28195820/call-macros-from-a-range-list/28196072#28196072", "title": "Call macros from a range/list", "body": "<p>Done some modification in your code, check if this is what you want:</p>\n\n<pre><code>Sub try()\n\nDim mCell As Range\nDim mRange As Range\nDim mMacro As String\n\n\nSet mRange = Sheets(\"Sheet1\").Range(\"B1:B101\")\n\nFor Each mCell In mRange.Cells\n    mMacro = mCell.Value\n    Application.Run \"Module2.\" &amp; mMacro\nNext mCell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 4472266, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9c545deb372d7c7190123d7f9d537346?s=128&d=identicon&r=PG&f=1", "display_name": "Flavinho", "link": "https://stackoverflow.com/users/4472266/flavinho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 28196072, "answer_count": 2, "score": 0, "last_activity_date": 1422893971, "creation_date": 1422458276, "last_edit_date": 1422893971, "question_id": 28195820, "link": "https://stackoverflow.com/questions/28195820/call-macros-from-a-range-list", "title": "Call macros from a range/list", "body": "<p>please your help with the following code:</p>\n\n<p>1) Objective: Run the macros that are referred in a range.</p>\n\n<p>2) Range(\"B1:B101\") contains the list of macros to be run. For example, cell B1 contains the word Macro1 that refers to the macro with the same name, B2 refers to Macro2, and so on.</p>\n\n<p>3) Macro1, Macro2... have been already created.</p>\n\n<p>4) I've worked in the following code, but no luck yet:</p>\n\n<pre><code>Dim mCell As Range\nDim mRange As Range\nDim mMacro As String\nmMacro = mCell.Value\n\nSet mRange = Sheets(\"Sheet1\").Range(\"B1:B101\")\n\nFor Each mCell In mRange.Cells\n    Application.Run Module2.mMacro\nNext mCell\n</code></pre>\n"}, {"tags": ["vba", "excel", "adodb", "sql-server-2014-express"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1422458608, "post_id": 28195264, "comment_id": 44758457, "body": "<i>I&#39;m having problems</i> is not a useful description. What specific <i>problems</i> are you having?"}, {"owner": {"reputation": 424, "user_id": 3479671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1eec243884e037322a33ea3086499165?s=128&d=identicon&r=PG&f=1", "display_name": "user3479671", "link": "https://stackoverflow.com/users/3479671/user3479671"}, "edited": false, "score": 1, "creation_date": 1422458729, "post_id": 28195264, "comment_id": 44758553, "body": "if sPrice is declared as a double, a blank cell value will parse as 0"}, {"owner": {"reputation": 111, "user_id": 4373844, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b961e52edbe61fdba1c30858391fb100?s=128&d=identicon&r=PG&f=1", "display_name": "Flib", "link": "https://stackoverflow.com/users/4373844/flib"}, "edited": false, "score": 0, "creation_date": 1422458928, "post_id": 28195264, "comment_id": 44758714, "body": "SQL server do not accept a empty (,    ,)  in the insert command for a Decimal field"}, {"owner": {"reputation": 111, "user_id": 4373844, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b961e52edbe61fdba1c30858391fb100?s=128&d=identicon&r=PG&f=1", "display_name": "Flib", "link": "https://stackoverflow.com/users/4373844/flib"}, "edited": false, "score": 0, "creation_date": 1422459257, "post_id": 28195264, "comment_id": 44758950, "body": "I need it to be NULL not zero in DB"}, {"owner": {"reputation": 424, "user_id": 3479671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1eec243884e037322a33ea3086499165?s=128&d=identicon&r=PG&f=1", "display_name": "user3479671", "link": "https://stackoverflow.com/users/3479671/user3479671"}, "edited": false, "score": 0, "creation_date": 1422459402, "post_id": 28195264, "comment_id": 44759050, "body": "Your database is expecting a decimal, and you want to insert a null if the decimal value is 0?  Have I got that right?"}, {"owner": {"reputation": 111, "user_id": 4373844, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b961e52edbe61fdba1c30858391fb100?s=128&d=identicon&r=PG&f=1", "display_name": "Flib", "link": "https://stackoverflow.com/users/4373844/flib"}, "edited": false, "score": 0, "creation_date": 1422459744, "post_id": 28195264, "comment_id": 44759291, "body": "I want to insert NULL in a decimal SQL field when my VBA variable is blank."}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 4373844, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b961e52edbe61fdba1c30858391fb100?s=128&d=identicon&r=PG&f=1", "display_name": "Flib", "link": "https://stackoverflow.com/users/4373844/flib"}, "edited": false, "score": 0, "creation_date": 1422528611, "post_id": 28199963, "comment_id": 44789357, "body": "I think my case should use IsEmpty(value) ? Since my cell have no value. And in My real code a have many variables to check, how do I loop check who is empty and if so set to NULL ?"}, {"owner": {"reputation": 81, "user_id": 4019746, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh5.googleusercontent.com/-XiDLcZ7__AQ/AAAAAAAAAAI/AAAAAAAANcg/1xqzhoECJU0/photo.jpg?sz=128", "display_name": "Fr&#233;d&#233;ric Marcotte Pich&#233;", "link": "https://stackoverflow.com/users/4019746/fr%c3%a9d%c3%a9ric-marcotte-pich%c3%a9"}, "reply_to_user": {"reputation": 111, "user_id": 4373844, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b961e52edbe61fdba1c30858391fb100?s=128&d=identicon&r=PG&f=1", "display_name": "Flib", "link": "https://stackoverflow.com/users/4373844/flib"}, "edited": false, "score": 0, "creation_date": 1422904788, "post_id": 28199963, "comment_id": 44924144, "body": "If you loop through your iRowNo, you can add a condition like:  If Cells(iRowNo, 1).value = vbNullString Then     myvar = &quot;NULL&quot; Else     myvar = Cells(iRowNo, 1).value End If"}], "tags": [], "owner": {"reputation": 81, "user_id": 4019746, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh5.googleusercontent.com/-XiDLcZ7__AQ/AAAAAAAAAAI/AAAAAAAANcg/1xqzhoECJU0/photo.jpg?sz=128", "display_name": "Fr&#233;d&#233;ric Marcotte Pich&#233;", "link": "https://stackoverflow.com/users/4019746/fr%c3%a9d%c3%a9ric-marcotte-pich%c3%a9"}, "is_accepted": false, "score": 0, "last_activity_date": 1422470580, "creation_date": 1422470580, "answer_id": 28199963, "question_id": 28195264, "link": "https://stackoverflow.com/questions/28195264/insert-blank-vba-variable-into-sql-decimalx-y-field-as-null/28199963#28199963", "title": "Insert blank VBA variable into SQL decimal(x,y) field as Null", "body": "<p>A quick fix you could do would be to change the value of sPrice to \"NULL\" if its value is =0</p>\n\n<pre><code>sDate = .Cells(iRowNo, 1)\nsPrice = .Cells(iRowNo, 2)\nsQuantity = .Cells(iRowNo, 3)\n\nIf sPrice = 0 Then\n    sPrice = \"NULL\"\nEnd If\n\nconn.Execute \"INSERT INTO [dbo].[Prices] ([date], [Price], [Quantity])\n              values ('\" &amp; SDate &amp; \"', \" &amp; sPrice &amp; \",'\" &amp; sQuantity &amp; \"')\"\n</code></pre>\n\n<p>I'm not sure if a string containing \"NULL\" is what you're looking for, but you can change sPrice = \"NULL\" to whichever value your SQL DB will accept as a NULL Value</p>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 111, "user_id": 4373844, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b961e52edbe61fdba1c30858391fb100?s=128&d=identicon&r=PG&f=1", "display_name": "Flib", "link": "https://stackoverflow.com/users/4373844/flib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1391, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1422470580, "creation_date": 1422456762, "last_edit_date": 1531164843, "question_id": 28195264, "link": "https://stackoverflow.com/questions/28195264/insert-blank-vba-variable-into-sql-decimalx-y-field-as-null", "title": "Insert blank VBA variable into SQL decimal(x,y) field as Null", "body": "<p>I have a ADODB command in Excel 2013 VBA to execute a Insert string in a table where some fields are Decimal(x,y) in my SQL Server 2014. I'm having problems when my excel cell is empty to insert it as NULL into SQL.</p>\n\n<p>ie.</p>\n\n<p>VBA Code:</p>\n\n<p>Lets say variable <strong>sPrice</strong> can point to an empty excel cell.</p>\n\n<pre><code>sDate = .Cells(iRowNo, 1)\nsPrice = .Cells(iRowNo, 2)\nsQuantity = .Cells(iRowNo, 3)\n</code></pre>\n\n<p>And the argument of my Insert lets say:</p>\n\n<pre><code>conn.Execute \"INSERT INTO [dbo].[Prices] ([date], [Price], [Quantity])\n              values ('\" &amp; SDate &amp; \"', \" &amp; sPrice &amp; \",'\" &amp; sQuantity &amp; \"')\"\n</code></pre>\n\n<p>note in SQL data types are:</p>\n\n<pre><code>[date] Datetime\n[Price] Deciaml(28,12)\n[Quantity] Real\n</code></pre>\n\n<p>So I not including double single quote for sPrice as it's a Decimal.\nthanks,</p>\n"}, {"tags": ["list", "ms-access", "listbox", "vba"], "answers": [{"tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": true, "score": 2, "last_activity_date": 1422463014, "last_edit_date": 1495540168, "creation_date": 1422457756, "answer_id": 28195620, "question_id": 28195132, "link": "https://stackoverflow.com/questions/28195132/data-type-of-listbox-index/28195620#28195620", "title": "data type of Listbox Index", "body": "<p>You are confusing two things.  When you have a multi-selection ListBox, users will use the following code because <code>.SelectedItems</code> collection has to be variant:</p>\n\n<pre><code>Dim varItm as Variant\nFor Each varItm in myListBox.SelectedItems\n    'Do Something\nNext varItm\n</code></pre>\n\n<p>However, there is <a href=\"https://msdn.microsoft.com/en-us/library/office/ff835338%28v=office.15%29.aspx\" rel=\"nofollow noreferrer\">further documentation</a> on <code>myListBox.Sected(x)</code> where <code>x</code> is supposed to be <code>Long</code> but really could be any number containing variable.  Variant allows for numbers to be stored, so it would work, but better to define <code>x</code> as explicitly containing a number (<code>Integer</code> or <code>Long</code>) <a href=\"https://stackoverflow.com/a/26717521/4241535\">More on Integer vs. Long</a>.</p>\n\n<pre><code>Dim x As Integer\nFor x = 0 to myListBox.ListCount - 1\n    If myListBox.Selected(x) Then\n        'Do Something\n    End If\nNext x\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 4337094, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3e58f85c2321ed9adc833c81c473194b?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/4337094/fred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 786, "favorite_count": 0, "accepted_answer_id": 28195620, "answer_count": 1, "score": 3, "last_activity_date": 1422463014, "creation_date": 1422456421, "question_id": 28195132, "link": "https://stackoverflow.com/questions/28195132/data-type-of-listbox-index", "title": "data type of Listbox Index", "body": "<p>When I search information about Listbox, I see that most people use Variant as data type for the index number of the list.\nExample:</p>\n\n<pre><code>Dim varItm As Variant\nIf Me.myListBox.ItemData.Selected(varItm) = True \n</code></pre>\n\n<p>Is it better to use Variant or Integer as data type?</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1422456535, "post_id": 28194899, "comment_id": 44757038, "body": "<code>Array(1:49)</code>? or <code>Array(&quot;1:49&quot;)</code> Unsure if that works the same as <code>Range()</code> or <code>Columns()</code>"}, {"owner": {"reputation": 670, "user_id": 1490470, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/gCBWj.jpg?s=128&g=1", "display_name": "chapter3", "link": "https://stackoverflow.com/users/1490470/chapter3"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1422459544, "post_id": 28194899, "comment_id": 44759139, "body": "@Chrismas007 - tried both but seems the syntax not working"}], "answers": [{"comments": [{"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 2, "creation_date": 1422463929, "post_id": 28195673, "comment_id": 44762140, "body": "+1 good point with the (ary). For more info this might be usefull <a href=\"http://stackoverflow.com/questions/5413765/what-are-the-rules-governing-usage-of-brackets-in-vba-function-calls\">link</a>."}, {"owner": {"reputation": 670, "user_id": 1490470, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/gCBWj.jpg?s=128&g=1", "display_name": "chapter3", "link": "https://stackoverflow.com/users/1490470/chapter3"}, "edited": false, "score": 0, "creation_date": 1422613864, "post_id": 28195673, "comment_id": 44829671, "body": "@Gary&#39;sStudent... thx! i make it become a small routine to generate the array."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 3, "last_activity_date": 1422463927, "last_edit_date": 1422463927, "creation_date": 1422457908, "answer_id": 28195673, "question_id": 28194899, "link": "https://stackoverflow.com/questions/28194899/coding-array-in-excel-vba/28195673#28195673", "title": "Coding Array in Excel VBA", "body": "<p>Since <em>RemoveDuplicates</em> wants a <em>Variant,</em> zero-based, array rather than a <em>Range</em> you could make it with a loop:</p>\n\n<pre><code>Sub Macro()\n    Dim ary(0 To 48)\n\n    For i = 0 To 48\n        ary(i) = i + 1\n    Next i\n\n    Range(\"$A$1:$BB$20\").Select\n    ActiveSheet.Range(\"$A$1:$BB$20\").RemoveDuplicates Columns:=(ary), Header _\n        :=xlNo\nEnd Sub\n</code></pre>\n\n<p>Please note the <strong>(ary)</strong> <br> This is to accommodate a very old VBA bug.</p>\n"}], "owner": {"reputation": 670, "user_id": 1490470, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/gCBWj.jpg?s=128&g=1", "display_name": "chapter3", "link": "https://stackoverflow.com/users/1490470/chapter3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 28195673, "answer_count": 1, "score": 0, "last_activity_date": 1422463927, "creation_date": 1422455807, "question_id": 28194899, "link": "https://stackoverflow.com/questions/28194899/coding-array-in-excel-vba", "title": "Coding Array in Excel VBA", "body": "<p>I have the following code to remove duplicates in Excel:</p>\n\n<pre><code>    AlertRange.RemoveDuplicates Columns:=Array(1, 2, 3, 4, 5, 6, _\n    7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, _\n    34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49), Header:=xlNo\n</code></pre>\n\n<p>It works fine. But could there be a better way to provide the array to the \"Columns\" parameter? The way it codes looks stupid.</p>\n"}, {"tags": ["vba", "excel", "subroutine"], "comments": [{"owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "edited": false, "score": 2, "creation_date": 1422456664, "post_id": 28194822, "comment_id": 44757118, "body": "Not enough information here, we would need to see the actual procedure."}], "answers": [{"tags": [], "owner": {"reputation": 866, "user_id": 4429501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bJd5A.jpg?s=128&g=1", "display_name": "CRUTER", "link": "https://stackoverflow.com/users/4429501/cruter"}, "is_accepted": true, "score": 0, "last_activity_date": 1422458675, "creation_date": 1422458675, "answer_id": 28195991, "question_id": 28194822, "link": "https://stackoverflow.com/questions/28194822/excel-not-responding-when-passing-objects-to-subroutine/28195991#28195991", "title": "Excel Not Responding When Passing Objects To Subroutine", "body": "<p>I was able to get this to work on computer's that were having issues by explicitly stating 'ByRef' in the parameters of the Subroutine. </p>\n\n<pre><code>Public Sub EmailApprovalP1(ByRef GeneralSection As Object, ByRef \n   ItemSection As Object, ByRef VendorSection As Object, ByRef \n   MarketSection As Object, ByRef Part1Section As Object, ByRef wbLog As \n   Workbook, ByRef wbPCD As Workbook, ByRef resubmission As Boolean)\n</code></pre>\n\n<p>I'm extremely surprised that this fixed the issue, since passing 'ByRef' is implicit if left out.</p>\n"}], "owner": {"reputation": 866, "user_id": 4429501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bJd5A.jpg?s=128&g=1", "display_name": "CRUTER", "link": "https://stackoverflow.com/users/4429501/cruter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 28195991, "answer_count": 1, "score": 0, "last_activity_date": 1422458675, "creation_date": 1422455591, "last_edit_date": 1422457219, "question_id": 28194822, "link": "https://stackoverflow.com/questions/28194822/excel-not-responding-when-passing-objects-to-subroutine", "title": "Excel Not Responding When Passing Objects To Subroutine", "body": "<p>This macro runs fine on most of our work computers, but NOT all of our work computers.  Everyone is running Excel 2013 and on newer computers with plenty of RAM (4-8 GB).  </p>\n\n<p>Here is the subroutine that is being called:</p>\n\n<pre><code>Public Sub EmailApprovalP1(GeneralSection As Object, ItemSection As\n   Object, VendorSection As Object, MarketSection As Object, Part1Section\n   As Object, wbLog As Workbook, wbPCD As Workbook, resubmission As Boolean)\n</code></pre>\n\n<p>And, here is the Call to that subroutine:</p>\n\n<pre><code>Call EmailApprovalP1(GeneralSection, ItemSection, VendorSection, \n   MarketSection, Part1Section, wbLog, wbPCD, resubmission)\n</code></pre>\n\n<p>When the VBA code reads the Call above, Excel starts to not respond and either will recover or, in some cases, close completely :(.</p>\n\n<p>I've search other questions and answer here, but can't find anything similar to my experience.</p>\n\n<p>Any ideas on how to fix this OR suggestions on how to work around this would be greatly appreciated.</p>\n"}, {"tags": ["vba", "userform", "radio-button"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1422455459, "post_id": 28194609, "comment_id": 44756327, "body": "<i>What line</i> throws the error and <i>what is</i> the error?"}, {"owner": {"reputation": 741, "user_id": 2682736, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/cabi5.png?s=128&g=1", "display_name": "AndroidDev", "link": "https://stackoverflow.com/users/2682736/androiddev"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1422455847, "post_id": 28194609, "comment_id": 44756598, "body": "Line     Set Jonas(x) = SAPPlants.Controls.Add(&quot;Forms.optionbutton.1&quot;, Y, True)  Error Expected Sub or Procedure"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1422456345, "post_id": 28194609, "comment_id": 44756914, "body": "How do you define <code>Jonas</code> in terms of variable type?"}], "answers": [{"tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": true, "score": 1, "last_activity_date": 1422458118, "creation_date": 1422458118, "answer_id": 28195755, "question_id": 28194609, "link": "https://stackoverflow.com/questions/28194609/loop-to-create-option-buttons-in-a-userform-not-working/28195755#28195755", "title": "Loop to Create Option buttons in a Userform not working", "body": "<p>You need to pass <code>X</code> into the name of the OptionButton instead of using <code>Jonas(X)</code>.  Try the below and see how that works for you:</p>\n\n<pre><code>DefaultTop = 60\n\nDim Jonas as OptionButton\n\nFor X = 0 To UBound(ArrPlants)\n\n    Set Jonas = SAPPlants.Controls.Add(\"Forms.optionbutton.\" &amp; X + 1, Y, True)\n\n        With Jonas\n            .Top = DefaultTop + 20\n            .Left = 12\n            .Caption = ArrPlants(X)\n        End With\n\n Next X\n</code></pre>\n\n<p>Further explanation <a href=\"http://www.globaliconnect.com/excel/index.php?option=com_content&amp;view=article&amp;id=125:userforms-in-excel-vba-userform-basics-add-controls-dynamically-at-run-time-using-the-add-method-userform-controls-a-snapshot&amp;catid=79&amp;Itemid=475\" rel=\"nofollow noreferrer\">found here</a>:</p>\n\n<p><img src=\"https://i.stack.imgur.com/I6tbc.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 741, "user_id": 2682736, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/cabi5.png?s=128&g=1", "display_name": "AndroidDev", "link": "https://stackoverflow.com/users/2682736/androiddev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 495, "favorite_count": 0, "accepted_answer_id": 28195755, "answer_count": 1, "score": 1, "last_activity_date": 1422458118, "creation_date": 1422454989, "last_edit_date": 1422456399, "question_id": 28194609, "link": "https://stackoverflow.com/questions/28194609/loop-to-create-option-buttons-in-a-userform-not-working", "title": "Loop to Create Option buttons in a Userform not working", "body": "<p>I need to create several option buttons in a Userform (each one for a array element).</p>\n\n<p>Am I missing something here? Cause it returns an error..</p>\n\n<pre><code>DefaultTop = 60\n\nFor X = 0 To UBound(ArrPlants)\n\n    Set Jonas(x) = SAPPlants.Controls.Add(\"Forms.optionbutton.1\", Y, True)\n      'Error on the above line ^^^\n\n        With Jonas(x)\n            .Top = DefaultTop + 20\n            .Left = 12\n            .Caption = ArrPlants(x)\n        End With\n\n Next X\n</code></pre>\n\n<p>Error:</p>\n\n<blockquote>\n  <p>Error Expected Sub or Procedure</p>\n</blockquote>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"tags": [], "owner": {"reputation": 9845, "user_id": 1594867, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/584465eb7d4dfeae286ecd15ba984077?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1594867/dan"}, "is_accepted": false, "score": 0, "last_activity_date": 1422455060, "creation_date": 1422455060, "answer_id": 28194636, "question_id": 28194554, "link": "https://stackoverflow.com/questions/28194554/how-to-make-reference-for-all-cells/28194636#28194636", "title": "How to make reference for ALL cells?", "body": "<p>It might be possible to do what you want using Dynamic Named Ranges. Basically, the idea is to create a Named Range that is defined using the OFFSET()-formula. This way, whenever new data gets added outside the range, the named range will automatically be adjusted to include the new data.</p>\n\n<p><a href=\"http://www.excel-easy.com/examples/dynamic-named-range.html\" rel=\"nofollow\">Here is one example of how to do this</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1422461688, "last_edit_date": 1422461688, "creation_date": 1422455861, "answer_id": 28194925, "question_id": 28194554, "link": "https://stackoverflow.com/questions/28194554/how-to-make-reference-for-all-cells/28194925#28194925", "title": "How to make reference for ALL cells?", "body": "<p>To setup a <strong>mirror</strong> of all the used cells in <em>Sheet1</em> on <em>Sheet2</em> use this:</p>\n\n<pre><code>Sub AllTheCellsLinked()\n    Dim r As Range\n    Set r = Sheets(\"Sheet1\").UsedRange.Cells\n    ady = r(1).Address\n    Sheets(\"Sheet2\").Select\n    Range(ady).Select\n    r.Copy\n    ActiveSheet.Paste Link:=True\nEnd Sub\n</code></pre>\n\n<p>This will establish links to all the used cells.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>If you add rows or columns in Sheet1, just re-run the macro.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 4503254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cce3c3467875da87f94e8a1fb6ce35a?s=128&d=identicon&r=PG&f=1", "display_name": "Vitalijus D.", "link": "https://stackoverflow.com/users/4503254/vitalijus-d"}, "edited": false, "score": 0, "creation_date": 1422458245, "post_id": 28195093, "comment_id": 44758225, "body": "It does not reflect already existing data in Sheet1 to Sheet2. Still, by far this solution is best. Could you update answer so all already existing data would be reflected? Or what steps I should make?"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 3, "user_id": 4503254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cce3c3467875da87f94e8a1fb6ce35a?s=128&d=identicon&r=PG&f=1", "display_name": "Vitalijus D.", "link": "https://stackoverflow.com/users/4503254/vitalijus-d"}, "edited": false, "score": 0, "creation_date": 1422458497, "post_id": 28195093, "comment_id": 44758380, "body": "Could you not copy the original sheet before you start using the code."}, {"owner": {"reputation": 3, "user_id": 4503254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cce3c3467875da87f94e8a1fb6ce35a?s=128&d=identicon&r=PG&f=1", "display_name": "Vitalijus D.", "link": "https://stackoverflow.com/users/4503254/vitalijus-d"}, "edited": false, "score": 0, "creation_date": 1422459478, "post_id": 28195093, "comment_id": 44759096, "body": "I did that. I have copied the original sheet after I applied code and still no visible changes on Sheet2. However, if I double click on any cell in Sheet1, only then data is reflected in Sheet2 (but just text, any colors). I cannot double click on every cell, because to many of them."}, {"owner": {"reputation": 3, "user_id": 4503254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cce3c3467875da87f94e8a1fb6ce35a?s=128&d=identicon&r=PG&f=1", "display_name": "Vitalijus D.", "link": "https://stackoverflow.com/users/4503254/vitalijus-d"}, "edited": false, "score": 0, "creation_date": 1422461193, "post_id": 28195093, "comment_id": 44760293, "body": "managed to make what I want with Gary&#39;s Student code. Thanks anyway!"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1422456309, "creation_date": 1422456309, "answer_id": 28195093, "question_id": 28194554, "link": "https://stackoverflow.com/questions/28194554/how-to-make-reference-for-all-cells/28195093#28195093", "title": "How to make reference for ALL cells?", "body": "<p>You can use the worksheet_Change event.\nRight click on the sheet tab and select View Code\n<img src=\"https://i.stack.imgur.com/idHwn.jpg\" alt=\"Right Click Sheet Tab\"></p>\n\n<p>Copy and paste this code there.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim r As Integer\n    Dim c As Integer\n\n    r = Target.Row\n    c = Target.Column\n\n    Sheets(\"Sheet3\").Cells(r, c) = Target\n\n\nEnd Sub\n</code></pre>\n\n<p>Now whatever you change on Sheet1 will change on sheet3 with in reason(Copy and Paste will not work for this). The code goes in the Original Sheet. Change the sheet name to change as required.</p>\n"}], "owner": {"reputation": 3, "user_id": 4503254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cce3c3467875da87f94e8a1fb6ce35a?s=128&d=identicon&r=PG&f=1", "display_name": "Vitalijus D.", "link": "https://stackoverflow.com/users/4503254/vitalijus-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 602, "favorite_count": 0, "accepted_answer_id": 28194925, "answer_count": 3, "score": 0, "last_activity_date": 1422461688, "creation_date": 1422454851, "last_edit_date": 1531161705, "question_id": 28194554, "link": "https://stackoverflow.com/questions/28194554/how-to-make-reference-for-all-cells", "title": "How to make reference for ALL cells?", "body": "<p>I'm trying to find out how to reference <strong>ALL</strong> Sheet1 cells, so made changes would be reflected on Sheet2 cells.</p>\n\n<p>Now I have big data in Sheet1, which I would like to copy to Sheet2. Later on I would have to correct data on Sheet1, so this should be reflected on Sheet2. Because I don't know yet how many cells I will need to fill I would like to reference them ALL. Basically, Sheet2 should mirror Sheet1 with possibility to add more data on Sheet2 that would not be reflected in Sheet1. Sort of 'one way mirror'.</p>\n\n<p>I guess this is not so difficult and someone can give an example or explanation.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1422454919, "post_id": 28194422, "comment_id": 44755970, "body": "Maybe Find and Replace in each heading."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1422455366, "post_id": 28194422, "comment_id": 44756265, "body": "I would recommend adding some of your code you have tried.  That would probably help get more attention to your problem."}, {"owner": {"reputation": 29, "user_id": 4503159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0057a99e2a1801c3717f7095cfde6d92?s=128&d=identicon&r=PG&f=1", "display_name": "East Coast Techwriter", "link": "https://stackoverflow.com/users/4503159/east-coast-techwriter"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1422471929, "post_id": 28194422, "comment_id": 44766870, "body": "Thank you Chrismas007. The coding attempts I&#39;ve made to date have been complete failures. I&#39;ve tried some approaches that have used Selection and tried to use the Marco recorder as a starting point. The macro recorder code was so short that I did not know how to &quot;generalize&quot; the macro code to all headings. Didn&#39;t work in any case. I&#39;ll keep trying and will post some code to show my approach. I appreciate your suggestion. I don&#39;t know how &quot;Find and Replace&quot; can help as I have nothing to &quot;find&quot; as far as I am aware. I need to get to an insertion point and paste text."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1422474437, "post_id": 28194422, "comment_id": 44768260, "body": "If you have sequential heading numbers, you could loop through all of the possible numbers, do a find for that string, and replace with that string plus the text you want to add."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 4503159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0057a99e2a1801c3717f7095cfde6d92?s=128&d=identicon&r=PG&f=1", "display_name": "East Coast Techwriter", "link": "https://stackoverflow.com/users/4503159/east-coast-techwriter"}, "edited": false, "score": 0, "creation_date": 1422555427, "post_id": 28202370, "comment_id": 44806528, "body": "Thank you Christina. You are right - my question applies to Word&#39;s outline levels (I called them hierarchical headings). I will try your suggested approaches shortly. I appreciate that you have provided me with some insight as to what coding approaches might be appropriate. I will let you know my results. Sincere thanks"}], "tags": [], "owner": {"reputation": 1309, "user_id": 1497212, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0511a375f968323baeca37d432ffe053?s=128&d=identicon&r=PG", "display_name": "Christina", "link": "https://stackoverflow.com/users/1497212/christina"}, "is_accepted": false, "score": 0, "last_activity_date": 1422479117, "creation_date": 1422479117, "answer_id": 28202370, "question_id": 28194422, "link": "https://stackoverflow.com/questions/28194422/insert-text-after-numbers-and-before-words-in-a-word-hierarchical-heading/28202370#28202370", "title": "Insert text after numbers and before words in a Word hierarchical heading", "body": "<p>Assuming you are using Word's outline levels (I think this is what you mean by hierarchical headings), you can check a paragraph for this state. For example, assuming I have a paragraph in my document that has the Heading 1 style applied to it:</p>\n\n<pre><code>Sub PrintHeadings()\nDim objDoc as Document\nDim objPara as Paragraph\nSet objDoc = ActiveDocument\nFor each objPara in objDoc.Content.Paragraphs\n    If objPara.OutlineLevel &lt;&gt; wdOutlineLevelBodyText then\n        Debug.Print objPara.Range.Text\n    End If\nNext objPara\nEnd Sub\n</code></pre>\n\n<p>This code would print the contents of any paragraph that has an outline level above body text to the VBA Immediate Window. There are other approaches as well; you could use Find and Replace to search for each of the Outline Levels. This gives you a bit less control; you'd want your change to be something that could be encapsulated in a Word Find and Replace. But, it would be faster if you have a long document and not too many heading levels. A basic example:</p>\n\n<pre><code>Sub UnderlineHeadings()\nDim objDoc as Document\nSet objDoc = ActiveDocument\nWith objDoc.Content.Find\n    .ClearFormatting\n    .ParagraphFormat.OutlineLevel = wdOutlineLevel1\n    With .Replacement\n        .ClearFormatting\n        .Font.Underline = wdUnderlineSingle\n    End With\n    .Execute Forward:=True, Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceAll\nEnd With\nEnd Sub\n</code></pre>\n\n<p>That would underline all of your text of Outline Level 1.</p>\n\n<p>Perhaps that will get you started.</p>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 4503159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0057a99e2a1801c3717f7095cfde6d92?s=128&d=identicon&r=PG&f=1", "display_name": "East Coast Techwriter", "link": "https://stackoverflow.com/users/4503159/east-coast-techwriter"}, "is_accepted": false, "score": 0, "last_activity_date": 1430851242, "creation_date": 1430851242, "answer_id": 30060795, "question_id": 28194422, "link": "https://stackoverflow.com/questions/28194422/insert-text-after-numbers-and-before-words-in-a-word-hierarchical-heading/30060795#30060795", "title": "Insert text after numbers and before words in a Word hierarchical heading", "body": "<p>I asked this question some months ago: \"My issue is that I want to use VBA to insert a very brief amount of standardized text before the English-language string in my numbered hierarchical headings.\" By \"numbered hierarchical headings\" I meant Word multilevel lists. The answers I received were appreciated but did not respond effectively to my question or guide me to a resolution. I pass this along in the hope it may be of use to others. </p>\n\n<p>First, the \"number\" part of the Word heading is irrelevant. In writing your code, there is NO need to think of a \"number\" portion and a \"text\" portion of the heading. I was afraid that any text I was trying to insert would be inserted BEFORE the multilevel numbering rather than BEFORE the English language text. The multilevel numbering is apparently automatically ignored. Below are two solutions that worked.</p>\n\n<p>This first macro succeeded in producing the desired result: 1.1.1 (FOUO). I used this macro to create individual macros for each order of heading. I haven't learned how to combine them all into one macro. But they work  individually (but not without the flaw of taking too much time ~5 to 10 minutes for a complex, paragraph-heavy 670 page document).</p>\n\n<pre><code>Public Sub InsertFOUOH1()\nDim doc As Document\nDim para As Paragraph\nDim paraNext As Paragraph\nDim MyText As String\nDim H1 As HeadingStyle\n\nSet doc = ActiveDocument\nSet para = doc.Paragraphs.First\n\nDo While Not para Is Nothing\nSet paraNext = para.Next\nMyText = \"(U//FOUO) \"\nIf para.Style = doc.Styles(wdStyleHeading1) Then\npara.Range.InsertBefore (MyText)\nEnd If\nSet para = paraNext\nLoop\nEnd Sub\n</code></pre>\n\n<p>THIS WORKS ON ALL FIRST ORDER HEADINGS (1, 2, 3 ETC.)</p>\n\n<p>I used the macro below to add my security marking all body paragraphs:</p>\n\n<pre><code>Public Sub InsertFOUObody()\n'Inserts U//FOUO before all body paragraphs\nDim doc As Document\nDim para As Paragraph\nDim paraNext As Paragraph\nDim MyText As String\nSet doc = ActiveDocument\nSet para = doc.Paragraphs.First\nDo While Not para Is Nothing\nSet paraNext = para.Next\nMyText = \"(U//FOUO) \"\nIf para.Style = doc.Styles(wdStyleBodyText) Then\npara.Range.InsertBefore (MyText)\nEnd If\nSet para = paraNext\nLoop\nEnd Sub\n</code></pre>\n\n<p>These macros are running slowly and, at the end, generating Error 28 Out of stack space errors. However the error is displayed at the end of running the macros and after the macros have successfully performed their work. </p>\n"}], "owner": {"reputation": 29, "user_id": 4503159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0057a99e2a1801c3717f7095cfde6d92?s=128&d=identicon&r=PG&f=1", "display_name": "East Coast Techwriter", "link": "https://stackoverflow.com/users/4503159/east-coast-techwriter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1465, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1430851242, "creation_date": 1422454442, "last_edit_date": 1422455113, "question_id": 28194422, "link": "https://stackoverflow.com/questions/28194422/insert-text-after-numbers-and-before-words-in-a-word-hierarchical-heading", "title": "Insert text after numbers and before words in a Word hierarchical heading", "body": "<p>I am working my way through two books (Roman's Writing Word Macros, Mansfield's Mastering VBA for MS Office). In my work environment, I use both Word 2007 and Word 2010.</p>\n\n<p>My issue is that I want to use VBA to insert a very brief amount of standardized text before the English-language string in my numbered hierarchical headings. For instance, I have:</p>\n\n<blockquote>\n  <p>1.1.1 The Quick Brown Fox.</p>\n</blockquote>\n\n<p>What I want is:</p>\n\n<blockquote>\n  <p>1.1.1 (XXxx) The Quick Brown Fox.</p>\n</blockquote>\n\n<p>I guess my most basic issue is that I don't know how to approach the situation. I have  hierarchical headings yet I don't know how to say, in effect, \"Go to each hierarchical heading regardless of level. Insert yourself in front of the first English language word of the heading. Paste the text \"XXxx\" in front of the first word in the heading. Go on to the next heading and all remaining headings and do the same. My document is over 700 pages and has hundreds of hierarchical headings. </p>\n\n<p>I see that paragraphs are objects and that hierarchical headings are paragraphs. However, I can't see any way to make VBA recognize what I am talking about. I haven't been able to use Selection approaches successfully. I've tried using the Range approach but just have not been able to phrase the VBA code intelligently. I haven't been able to specify a range that includes all and only the hierarchical headings and, especially, I don't understand how to get the insertion to happen in front of the first English-language word of the heading. </p>\n\n<p>I have just begun to look at using Bookmarks. However, don't bookmarks require me to go to every heading and enter them? I may as well just paste my content if that is the case. I'm stumped. It is interesting that in no way, as might have been expected, does this appear to be a simple matter</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "is_accepted": false, "score": 1, "last_activity_date": 1422454547, "creation_date": 1422454547, "answer_id": 28194447, "question_id": 28194354, "link": "https://stackoverflow.com/questions/28194354/excel-worksheet-function-match-doesnt-work/28194447#28194447", "title": "Excel Worksheet function match doesn&#39;t work?", "body": "<p>You have to <code>Set</code> Range Objects:</p>\n\n<pre><code>Set myrange = Sheets(\"HDCInput\").Range(\"A3:A833\")\n</code></pre>\n\n<p>Not further tested, but this should solve that particular error.</p>\n"}], "owner": {"reputation": 11, "user_id": 3181985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34b144800efd4f723579eb3df7743214?s=128&d=identicon&r=PG&f=1", "display_name": "user3181985", "link": "https://stackoverflow.com/users/3181985/user3181985"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1422454547, "creation_date": 1422454268, "question_id": 28194354, "link": "https://stackoverflow.com/questions/28194354/excel-worksheet-function-match-doesnt-work", "title": "Excel Worksheet function match doesn&#39;t work?", "body": "<p>I have a date in sheet 'dashboard' M1. and I need to match this in a range in 'HDCinput' cells A33:A833. When I run the below code (part of a bigger macro) I get a \"Object variable or With block variable not set\". I'm not sure why</p>\n\n<pre><code>Dim mydate As Date\nDim myrange As Range\nDim Colindex As Long\n\nmydate = Sheets(\"Dashboard\").Range(\"M1\")\nmyrange = Sheets(\"HDCInput\").Range(\"A3:A833\")\nColindex = Application.WorksheetFunction.Match(mydate, myrange, 0)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 1, "creation_date": 1422454297, "post_id": 28194224, "comment_id": 44755540, "body": "On which line does this error occur?"}, {"owner": {"reputation": 85, "user_id": 3514907, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/06a83d599c8f8fa5dc234a2a4e3a1888?s=128&d=identicon&r=PG&f=1", "display_name": "user3514907", "link": "https://stackoverflow.com/users/3514907/user3514907"}, "reply_to_user": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1422517893, "post_id": 28194224, "comment_id": 44783580, "body": "The second line &#39;ThisWorkbook.Worksheet&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 3514907, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/06a83d599c8f8fa5dc234a2a4e3a1888?s=128&d=identicon&r=PG&f=1", "display_name": "user3514907", "link": "https://stackoverflow.com/users/3514907/user3514907"}, "edited": false, "score": 0, "creation_date": 1422459509, "post_id": 28195061, "comment_id": 44759114, "body": "You said tweak the filter/ copy, I have tried to but keep getting the error &#39;Runtime Error 1004 - We couldn&#39;t do this for the selected range of cells&#39;. Is there a particular way I need to write the filter/ copy part for it to accept it?"}, {"owner": {"reputation": 85, "user_id": 3514907, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/06a83d599c8f8fa5dc234a2a4e3a1888?s=128&d=identicon&r=PG&f=1", "display_name": "user3514907", "link": "https://stackoverflow.com/users/3514907/user3514907"}, "edited": false, "score": 0, "creation_date": 1422517817, "post_id": 28195061, "comment_id": 44783542, "body": "No it isn&#39;t essential as I only want to copy rows with text in column C (doesn&#39;t matter what text) but I wasn&#39;t sure how to do it."}, {"owner": {"reputation": 85, "user_id": 3514907, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/06a83d599c8f8fa5dc234a2a4e3a1888?s=128&d=identicon&r=PG&f=1", "display_name": "user3514907", "link": "https://stackoverflow.com/users/3514907/user3514907"}, "edited": false, "score": 0, "creation_date": 1422532557, "post_id": 28195061, "comment_id": 44791778, "body": "I managed to change my copy and paste macro and removed the filter (edited my original post to reflect this) but I&#39;m now not sure how to work your answer into the new macro."}, {"owner": {"reputation": 85, "user_id": 3514907, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/06a83d599c8f8fa5dc234a2a4e3a1888?s=128&d=identicon&r=PG&f=1", "display_name": "user3514907", "link": "https://stackoverflow.com/users/3514907/user3514907"}, "edited": false, "score": 0, "creation_date": 1422543800, "post_id": 28195061, "comment_id": 44799002, "body": "Works great, for future reference how would I add more than one exception sheet? Thank you"}], "tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": true, "score": 1, "last_activity_date": 1422543870, "last_edit_date": 1495540752, "creation_date": 1422456242, "answer_id": 28195061, "question_id": 28194224, "link": "https://stackoverflow.com/questions/28194224/macro-to-run-through-all-worksheets-with-one-exception/28195061#28195061", "title": "Macro to Run Through All Worksheets with One Exception", "body": "<p>First <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">STOP using <code>.Select</code></a></p>\n\n<p>Second, this should work based on your criteria of filtering and copying specific rows.  You may need to tweak the filter or the rows that are copied, but this loop will work.</p>\n\n<pre><code>Sub TestIt()\n\nDim wsheet As Worksheet\n\nFor i = 1 To ThisWorkbook.Worksheets.Count\n    If ThisWorkbook.Worksheets(i).Name &lt;&gt; \"Action Summary\" Then 'And ThisWorkbook.Worksheets(i).Name &lt;&gt; \"Another Exception\" And ...\n        Set wsheet = ThisWorkbook.Worksheets(i)\n        For j = 6 to wsheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n            If Not wsheet.Range(\"C\" &amp; j).Value = \"\" Then\n                wsheet.Range(\"C\" &amp; j).EntireRow.Copy\n                Sheets(\"Action Summary\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).PasteSpecial xlPasteValues\n            End If\n        Next j\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 3514907, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/06a83d599c8f8fa5dc234a2a4e3a1888?s=128&d=identicon&r=PG&f=1", "display_name": "user3514907", "link": "https://stackoverflow.com/users/3514907/user3514907"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1206, "favorite_count": 1, "accepted_answer_id": 28195061, "answer_count": 1, "score": 1, "last_activity_date": 1422543870, "creation_date": 1422453874, "last_edit_date": 1422531627, "question_id": 28194224, "link": "https://stackoverflow.com/questions/28194224/macro-to-run-through-all-worksheets-with-one-exception", "title": "Macro to Run Through All Worksheets with One Exception", "body": "<p>I am trying to write a macro that selects any rows with text in a particular column (doesn't matter what text) and then paste it into a Summary sheet, this needs to cycle through all the sheets in the workbook bar the summary sheet. However I am having problems getting it to work, I keep getting 'Compile Error: Method or Data Member not Found', I need the macro to run through all sheets regardless of name as the sheets are eventually archived and new ones added. </p>\n\n<p>I have now changed the way the macro finds the cells with text in to the below, I don't know if this changes things:</p>\n\n<p>Sub SmartCopy()</p>\n\n<pre><code>Dim s1 As Worksheet, s2 As Worksheet\nDim N As Long, i As Long, j As Long\nSet s1 = Sheets(\"Customer 1\")\nSet s2 = Sheets(\"Action Summary\")\nN = s1.Cells(Rows.Count, \"C\").End(xlUp).Row\nj = 2\nFor i = 6 To N\n    If s1.Cells(i, \"C\").Value = \"\" Then\n    Else\n        s1.Cells(i, \"C\").EntireRow.Copy s2.Cells(j, 1)\n        j = j + 1\n    End If\nNext i\n</code></pre>\n\n<p>End Sub</p>\n\n<p>I am new to this and probably have it totally wrong but any help would be appreciated.</p>\n"}, {"tags": ["vba", "loops", "excel", "split"], "answers": [{"comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1422454015, "post_id": 28194140, "comment_id": 44755333, "body": "Note: I&#39;ve copied-pasted your code, but avoid (in general) using keywords such as &quot;sum&quot; to name variables of other kind. They might sometimes be reserved keywords."}, {"owner": {"reputation": 55, "user_id": 4500562, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8dac15110c01ea288a96baf7035425f6?s=128&d=identicon&r=PG&f=1", "display_name": "MrJ1m", "link": "https://stackoverflow.com/users/4500562/mrj1m"}, "edited": false, "score": 0, "creation_date": 1422454205, "post_id": 28194140, "comment_id": 44755476, "body": "Once again it works perfectly! I&#39;ll dig into the split function ;) Thanks a lot!"}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 0, "last_activity_date": 1422453683, "creation_date": 1422453683, "answer_id": 28194140, "question_id": 28193853, "link": "https://stackoverflow.com/questions/28193853/how-to-execute-a-function-in-the-cell-on-the-right-of-every-row-of-a-specific-ra/28194140#28194140", "title": "How to execute a function in the cell on the right of every row of a specific range?", "body": "<p>The Cell.Address is something like this: \"<code>$A$1</code>\"; the function <code>Split</code> is splitting by the symbol <code>$</code> so the letter <code>A</code> will be contained at position <code>(1)</code> of the array while the row number <code>1</code> at the position <code>(2)</code>. That's why your: </p>\n\n<pre><code>Split(cell.Address, \"$\")(2)  \n</code></pre>\n\n<p>is returning a number and not a letter. What you want to do is probably: </p>\n\n<pre><code>Set sum = Range(ActiveCell.Offset(0, a), ActiveCell.Offset(a - 1, a))\nFor each cell in sum\n    cell.Value = \"=SUM(\" &amp; Split(cell.Offset(0,-a).Address,\"$\")(1) &amp; cell.Row &amp; \":\" &amp; Split(cell.Offset(0,-1).Address,\"$\")(1) &amp; cell.Row &amp; \")\"  \nNext cell\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 4500562, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8dac15110c01ea288a96baf7035425f6?s=128&d=identicon&r=PG&f=1", "display_name": "MrJ1m", "link": "https://stackoverflow.com/users/4500562/mrj1m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 28194140, "answer_count": 1, "score": 0, "last_activity_date": 1427414087, "creation_date": 1422452834, "last_edit_date": 1427414087, "question_id": 28193853, "link": "https://stackoverflow.com/questions/28193853/how-to-execute-a-function-in-the-cell-on-the-right-of-every-row-of-a-specific-ra", "title": "How to execute a function in the cell on the right of every row of a specific range?", "body": "<p>Earlier i was trying to sum every column of a range in the cell right below and got successfully helped. I'm just trying to modify the code i received to do the same for every row and get the result in the column just on the right</p>\n\n<pre><code>Sub miine()\n\nDim a, i As Integer, Data, sums As Range\na = InputBox(\"How many cells for the square?\")\nSet Data = Range(ActiveCell.Offset(0, 0), ActiveCell.Offset(a - 1, a - 1))\n\nSet sums = Range(ActiveCell.Offset(a, 0), ActiveCell.Offset(a, a - 1))\nFor Each cell In sums\ncell.Value = \"=SUM(\" &amp; Split(cell.Address, \"$\")(1) &amp; cell.Row - a &amp; \":\" &amp; Split(cell.Address, \"$\")(1) &amp; cell.Row - 1 &amp; \")\"\nNext\n\nSet sum = Range(ActiveCell.Offset(0, a), ActiveCell.Offset(a - 1, a))\nFor each cell in sum\ncell.Value = \"=SUM(\" &amp; cell.Column - a &amp; Split(cell.Address, \"$\")(2) &amp; \":\" &amp; cell.Column - 1 &amp; Split(cell.Address, \"$\")(2) &amp; \")\"\n\nEnd Sub\n</code></pre>\n\n<p>The second part doesn't work, i get the sum in place on the right, but the range selected for the sum appears like that Range(11:41) instead of Range(\"A1:D1\"). Thanks in advance</p>\n"}, {"tags": ["excel", "key", "runtime-error", "vba"], "answers": [{"tags": [], "owner": {"reputation": 591, "user_id": 1189711, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1eed81a5cd5d602da3545a383e14c58d?s=128&d=identicon&r=PG", "display_name": "pgr", "link": "https://stackoverflow.com/users/1189711/pgr"}, "is_accepted": false, "score": 0, "last_activity_date": 1424451081, "creation_date": 1424451081, "answer_id": 28634119, "question_id": 28193721, "link": "https://stackoverflow.com/questions/28193721/vbkeyspace-and-automation-error/28634119#28634119", "title": "vbKeySpace and automation error", "body": "<p>Your code seems correct. Try changing the Select case statement to an If to see if that solves the problem:</p>\n\n<pre><code>If (KeyCode = vbKeyReturn) or (KwyCode = vbKeySpace) then\netc.\n</code></pre>\n\n<p>If it doesn't solve the problem, there might be more complicated things going on. Like code that you have running in the KeyUp event. Or the delay in the two subroutines you call is messing something up. Or the actions inside those routines. You can also try to comment out the subroutines one by one to try and isolate the problem.</p>\n"}], "owner": {"reputation": 1215, "user_id": 2592987, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/sMt9i.png?s=128&g=1", "display_name": "lowak", "link": "https://stackoverflow.com/users/2592987/lowak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424451081, "creation_date": 1422452468, "last_edit_date": 1531164843, "question_id": 28193721, "link": "https://stackoverflow.com/questions/28193721/vbkeyspace-and-automation-error", "title": "vbKeySpace and automation error", "body": "<p><br>\nI have a strange issue. Below is my code. </p>\n\n<p>In short it checks if certain key was pressed on keyboard. If yes it runs 2 subroutines and sets focus on button called <code>diesel</code>. I wanted to add another Key -> Space (vbKeySpace). After adding it I receive: runtime error -2147417848 (80010108) automation error.</p>\n\n<p>I have no idea how to cope with it...</p>\n\n<pre><code>Private Sub Dostawcy_listbox_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\n\nSelect Case KeyCode\n\n'Enter = wstaw dane klienta\nCase vbKeyReturn, vbKeySpace\n    dane_dostawcy\n    turn_on\n    diesel.SetFocus\n\nEnd Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 9306, "user_id": 731453, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/389670f2388d25a21c2d6b61b027523e?s=128&d=identicon&r=PG&f=1", "display_name": "ron tornambe", "link": "https://stackoverflow.com/users/731453/ron-tornambe"}, "edited": false, "score": 0, "creation_date": 1422452548, "post_id": 28193374, "comment_id": 44754330, "body": "What version of Access are you using?"}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1422458912, "post_id": 28193374, "comment_id": 44758698, "body": "How do you handle running &quot;Build_And_Call_LogProfile&quot; if the database is opened normally?  While this isn&#39;t the answer to your direct question, could what you are attempting to do be handled by just using an Autoexec macro so that just runs on load when that database is opened?"}, {"owner": {"reputation": 69, "user_id": 4253512, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/621071709/picture?type=large", "display_name": "Mr_Fish", "link": "https://stackoverflow.com/users/4253512/mr-fish"}, "edited": false, "score": 0, "creation_date": 1422462280, "post_id": 28193374, "comment_id": 44761037, "body": "no not going to work - as I need to pass variables"}, {"owner": {"reputation": 69, "user_id": 4253512, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/621071709/picture?type=large", "display_name": "Mr_Fish", "link": "https://stackoverflow.com/users/4253512/mr-fish"}, "edited": false, "score": 0, "creation_date": 1422462304, "post_id": 28193374, "comment_id": 44761054, "body": "basically I need to tell acObj to set itself to the open database"}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1422465130, "post_id": 28193374, "comment_id": 44762965, "body": "I don&#39;t have a specific answer, though it looks like your solution will involve using workspaces.  Best link I could find to do what you want would be <a href=\"http://stackoverflow.com/questions/15448338/attempt-to-connect-to-a-valid-database-from-outside-access-outlook-excel-using\" title=\"attempt to connect to a valid database from outside access outlook excel using\">stackoverflow.com/questions/15448338/&hellip;</a>"}, {"owner": {"reputation": 69, "user_id": 4253512, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/621071709/picture?type=large", "display_name": "Mr_Fish", "link": "https://stackoverflow.com/users/4253512/mr-fish"}, "edited": false, "score": 0, "creation_date": 1422466110, "post_id": 28193374, "comment_id": 44763536, "body": "thanks but I dont think so as even in this code the database is opened by the sub - I want my sub to run with an already open database"}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1422473166, "post_id": 28193374, "comment_id": 44767590, "body": "Okay, sorry I can&#39;t really be of any more help figuring out how to set the db to another open database.  Though if you are up for alternative methods to do what you are looking for I would be happy to throw some ideas at you."}, {"owner": {"reputation": 69, "user_id": 4253512, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/621071709/picture?type=large", "display_name": "Mr_Fish", "link": "https://stackoverflow.com/users/4253512/mr-fish"}, "reply_to_user": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1422525133, "post_id": 28193374, "comment_id": 44787304, "body": "@Newd - thanks man help appreciated - I have cracked this with this  line"}, {"owner": {"reputation": 69, "user_id": 4253512, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/621071709/picture?type=large", "display_name": "Mr_Fish", "link": "https://stackoverflow.com/users/4253512/mr-fish"}, "edited": false, "score": 0, "creation_date": 1422525168, "post_id": 28193374, "comment_id": 44787327, "body": "so full code If Len(Dir(&quot;C:\\Users\\&quot; &amp; ComputerName() &amp; &quot;\\Documents\\Muncher_Components*.laccdb&quot;)) = 0 Then &#39;if the datebase is not running then open it      Set acObj = CreateObject(&quot;Access.Application&quot;)     acObj.OpenCurrentDatabase &quot;C:\\Users\\&quot; &amp; ComputerName() &amp; &quot;\\Documents\\Muncher_Components\\CruncherVersion_Working_Blank&zwnj;&#8203;.accdb&quot;     acObj.Application.UserControl = True         Else    &#39;if the datbase is then get the currenlty active database    Set acObj = GetObject(, &quot;Access.Application&quot;)  End If   acObj.Application.Run &quot;Build_And_Call_LogProfile&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "edited": false, "score": 0, "creation_date": 1475509406, "post_id": 28211597, "comment_id": 66960372, "body": "If the database was closed abnormally the laccdb file may still be there but the database not be open. Have you had this issue and if so did you find another way?"}], "tags": [], "owner": {"reputation": 69, "user_id": 4253512, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/621071709/picture?type=large", "display_name": "Mr_Fish", "link": "https://stackoverflow.com/users/4253512/mr-fish"}, "is_accepted": false, "score": 1, "last_activity_date": 1422537862, "last_edit_date": 1422537862, "creation_date": 1422525220, "answer_id": 28211597, "question_id": 28193374, "link": "https://stackoverflow.com/questions/28193374/vba-access-how-to-set-an-object-with-the-currently-open-database/28211597#28211597", "title": "VBA Access - how to set an object with the currently open database", "body": "<pre><code>If Len(Dir(\"C:\\Users\\\" &amp; ComputerName() &amp; \"\\Documents\\Muncher_Components\\*.laccdb\")) = 0 Then\n    'if the datebase is not running then open it\n\n    Set acObj = CreateObject(\"Access.Application\")\n    acObj.OpenCurrentDatabase \"C:\\Users\\\" &amp; ComputerName() &amp; \"\\Documents\\Muncher_Components\\CruncherVersion_Working_Blank.accdb\"\n    acObj.Application.UserControl = True\n\n    Else\n    'if the datbase is then get the currenlty active database\n    Set acObj = GetObject(, \"Access.Application\")\n\nEnd If\n\n\nacObj.Application.Run \"Build_And_Call_LogProfile\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "is_accepted": false, "score": 0, "last_activity_date": 1475509707, "creation_date": 1475509707, "answer_id": 39835538, "question_id": 28193374, "link": "https://stackoverflow.com/questions/28193374/vba-access-how-to-set-an-object-with-the-currently-open-database/39835538#39835538", "title": "VBA Access - how to set an object with the currently open database", "body": "<p>In fact, you can just use <strong>GetObject()</strong> in both open or closed scenarios:</p>\n\n<pre><code>Set acObj = GetObject(\"C:\\Users\\\" &amp; ComputerName() &amp; \"\\Documents\\Muncher_Components\\CruncherVersion_Working_Blank.accdb\")\nacObj.Application.UserControl = True\nacObj.Application.Run \"Build_And_Call_LogProfile\"\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 4253512, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/621071709/picture?type=large", "display_name": "Mr_Fish", "link": "https://stackoverflow.com/users/4253512/mr-fish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1234, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1475509707, "creation_date": 1422451365, "last_edit_date": 1422453126, "question_id": 28193374, "link": "https://stackoverflow.com/questions/28193374/vba-access-how-to-set-an-object-with-the-currently-open-database", "title": "VBA Access - how to set an object with the currently open database", "body": "<p>Guys how do I set an object to a currently open database - the code below looks for the database, if it cannot find it it opens it however, if it is open then the code fall over at the acObj application.run call as acObj is not set to the database....</p>\n\n<pre><code>Set acObj = CreateObject(\"Access.Application\")\n\nIf Len(Dir(\"C:\\Users\\\" &amp; ComputerName() &amp; \"\\Documents\\Components*.laccdb\")) = 0 Then 'if the datebase is not running then open it\n    acObj.Application.Visible = True\n    acObj.OpenCurrentDatabase \"C:\\Users\\\" &amp; ComputerName() &amp; \"\\Documents\\Components\\Working_Blank.accdb\"\n    acObj.Application.UserControl = True\nEnd If\n\nacObj.Application.Run \"Build_And_Call_LogProfile\", _Name, _date\n</code></pre>\n"}, {"tags": ["sql-server", "excel", "vba", "adodb", "recordset"], "answers": [{"comments": [{"owner": {"reputation": 30, "user_id": 4253162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49f0eb2857ddbd2c4f19d27b7d0b7e78?s=128&d=identicon&r=PG&f=1", "display_name": "JS1991", "link": "https://stackoverflow.com/users/4253162/js1991"}, "edited": false, "score": 0, "creation_date": 1422454298, "post_id": 28193301, "comment_id": 44755541, "body": "Spot on. Thanks a lot"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 0, "last_activity_date": 1422451116, "creation_date": 1422451116, "answer_id": 28193301, "question_id": 28193229, "link": "https://stackoverflow.com/questions/28193229/populating-combobox-on-userform-from-dynamic-sql-results/28193301#28193301", "title": "Populating combobox on userform from dynamic sql results", "body": "<p>There isn't any need to loop:</p>\n\n<pre><code>If Not rst.EOF then Me.ComboBox2.Column = rst.getrows()\n</code></pre>\n\n<p>should be enough to put the whole recordset into the control. GetRows returns an array transposed from the way you might expect, which is why I used .Column and not .List</p>\n"}], "owner": {"reputation": 30, "user_id": 4253162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49f0eb2857ddbd2c4f19d27b7d0b7e78?s=128&d=identicon&r=PG&f=1", "display_name": "JS1991", "link": "https://stackoverflow.com/users/4253162/js1991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1217, "favorite_count": 0, "accepted_answer_id": 28193301, "answer_count": 1, "score": 0, "last_activity_date": 1594193628, "creation_date": 1422450870, "last_edit_date": 1594193628, "question_id": 28193229, "link": "https://stackoverflow.com/questions/28193229/populating-combobox-on-userform-from-dynamic-sql-results", "title": "Populating combobox on userform from dynamic sql results", "body": "<p>I have a simple userform with 2 comboboxes. The first contains a choice of 2 SQL servers. The second should contain a list of databases from the chosen server populated by a query - this does not currently work.</p>\n\n<p>I can copy the data from the recordset to a sheet in my workbook but not into the combobox.</p>\n\n<p>Previously I have filled the comboboxes by looping through values on a xlveryhidden sheet with no problem:</p>\n\n<pre><code>For i = 1 to i = LastRow\nUserForm1.ComboBox2.AddItem Range(\"A\" &amp; i)\nnext i \n</code></pre>\n\n<p>This is my attempt at copying the data from the recordset so far:</p>\n\n<pre><code>Dim i As Integer\nDo Until i = rst.RecordCount\nUserForm1.ComboBox2.AddItem rst.getrows(1, i)\ni = i + 1\nLoop\n</code></pre>\n\n<p>This is getting a type mismatch error. Not sure if I'm on the right track.</p>\n\n<p>Does anyone know how to populate the combobox with results from a sql query lying in a recordset? Any help much appreciated.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 3910716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a12b979c4f0fd4385ee4fdede7c4842?s=128&d=identicon&r=PG&f=1", "display_name": "user3910716", "link": "https://stackoverflow.com/users/3910716/user3910716"}, "edited": false, "score": 0, "creation_date": 1422460402, "post_id": 28193072, "comment_id": 44759786, "body": "Thanks for the help Rory but still no luck. When i follow your advice there is no errors but still now there&#39;s no message box at all. I&#39;m very new to this and trying to figure it out. If you could give some advice on how to use either collections or dictionaries arrays i could give it a go. As long as i get a list of all the errors displaying at once rather than numerous messages then i am happy! At the moment i can only get one item in each box!"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 3, "user_id": 3910716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a12b979c4f0fd4385ee4fdede7c4842?s=128&d=identicon&r=PG&f=1", "display_name": "user3910716", "link": "https://stackoverflow.com/users/3910716/user3910716"}, "edited": false, "score": 0, "creation_date": 1422461256, "post_id": 28193072, "comment_id": 44760329, "body": "I&#39;ve just corrected a typo where I wrote <code>ErroryArray</code> rather than <code>ErrorArray</code>. Your <code>NumberOfErrors = 0</code> line should not be inside the loop in the real code - is it?"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 0, "last_activity_date": 1422461163, "last_edit_date": 1422461163, "creation_date": 1422450356, "answer_id": 28193072, "question_id": 28192932, "link": "https://stackoverflow.com/questions/28192932/vba-macro-assign-to-array-when-if-statement-is-used-and-display-in-message-box/28193072#28193072", "title": "VBA Macro. Assign to Array when if statement is used and display in message box", "body": "<p>Your array isn't dynamic since you always size it to 4, but you should move the Dim line out of the loop, and then use:</p>\n\n<pre><code>ReDim Preserve ErrorArray(NumberOfErrors)\n\nErrorArray(NumberOfErrors) = Cells(cell.Row, \"C\").Value\n</code></pre>\n\n<p>or you could also use a Collection or Dictionary rather than an array.</p>\n\n<p>In order to use the array with <code>MsgBox</code> you'll need to use <code>Join</code>:</p>\n\n<pre><code>MsgBox Join(ErrorArray, vbLf)\n</code></pre>\n\n<p>for example.</p>\n"}], "owner": {"reputation": 3, "user_id": 3910716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a12b979c4f0fd4385ee4fdede7c4842?s=128&d=identicon&r=PG&f=1", "display_name": "user3910716", "link": "https://stackoverflow.com/users/3910716/user3910716"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 28193072, "answer_count": 1, "score": 0, "last_activity_date": 1422626094, "creation_date": 1422450027, "last_edit_date": 1531164843, "question_id": 28192932, "link": "https://stackoverflow.com/questions/28192932/vba-macro-assign-to-array-when-if-statement-is-used-and-display-in-message-box", "title": "VBA Macro. Assign to Array when if statement is used and display in message box", "body": "<p>Dim NumberOfErrors As Integer</p>\n\n<pre><code>    NumberOfErrors = 0\n\n    If Dir(FilePath) = \"\" Then ' This is declared earlier and working ok\n\n    NumberOfErrors = NumberOfErrors +1\n\n    Dim ErrorArray() As Integer\n    ReDim ErrorArray(NumberOfErrors)\n\n    ErrorArray = Cells(cell.Row, \"C\").Value\n\n    End If\nNext cell\n\nIf NumberOfErrors &gt; 0 Then\n\n       MsgBox \"Attachments Do Not Exist for The Following Users: \" &amp; ErrorArray(NumberOfErrors)\n\nEnd If\n</code></pre>\n\n<p>So just to try and clarify what i am trying to do. If the file does not exist then create a dynamic array to show the names of the non existent files. Pass them to an array and show a list in a message box of the files that did not exist</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": false, "score": 8, "last_activity_date": 1422450873, "last_edit_date": 1422450873, "creation_date": 1422450556, "answer_id": 28193144, "question_id": 28192796, "link": "https://stackoverflow.com/questions/28192796/disable-copy-paste-in-unlocked-cells-on-protected-sheet/28193144#28193144", "title": "Disable copy/paste in unlocked cells on protected sheet?", "body": "<p>try this </p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<p>put this code inside sheet </p>\n\n<p><img src=\"https://i.stack.imgur.com/ZIQ0a.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20111, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1481056061, "creation_date": 1422449642, "question_id": 28192796, "link": "https://stackoverflow.com/questions/28192796/disable-copy-paste-in-unlocked-cells-on-protected-sheet", "title": "Disable copy/paste in unlocked cells on protected sheet?", "body": "<p>Is it possible to disable copy/paste in unlocked cells on protected sheet?</p>\n\n<p>My specific problem is that while users should be able to edit unlocked cells, they should not copy data validation from one cell to another. Unfortunately data validation gets copied in a normal copy/paste operation.</p>\n\n<p>So is it possible to disable copy/paste in unlocked cells on protected sheet or change the behavior of data validation so that it is not affected by copy/paste?</p>\n\n<p>The suggested solution can be either Excel or VBA.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1215, "user_id": 2592987, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/sMt9i.png?s=128&g=1", "display_name": "lowak", "link": "https://stackoverflow.com/users/2592987/lowak"}, "edited": false, "score": 2, "creation_date": 1422449832, "post_id": 28192670, "comment_id": 44752654, "body": "It may be helpful if you provide more details about what actually macro would do in the background."}], "answers": [{"comments": [{"owner": {"reputation": 891, "user_id": 2672634, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/03b9819527625d5198e71248e7590cbe?s=128&d=identicon&r=PG", "display_name": "Jason Samuels", "link": "https://stackoverflow.com/users/2672634/jason-samuels"}, "edited": false, "score": 0, "creation_date": 1423126309, "post_id": 28192812, "comment_id": 45024531, "body": "This is very useful but in my case it does not give me what i want. When i try to work in the workbook, the macro stops. The macro should continue."}], "tags": [], "owner": {"reputation": 938, "user_id": 2445541, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/gquoZ.jpg?s=128&g=1", "display_name": "Rahul Vishwakarma", "link": "https://stackoverflow.com/users/2445541/rahul-vishwakarma"}, "is_accepted": false, "score": 1, "last_activity_date": 1422449690, "creation_date": 1422449690, "answer_id": 28192812, "question_id": 28192670, "link": "https://stackoverflow.com/questions/28192670/running-a-macro-in-the-background/28192812#28192812", "title": "Running a macro in the background", "body": "<blockquote>\n  <p>The DoEvents function surrenders execution of the macro so that the\n  operating system can process other events.</p>\n</blockquote>\n\n<p>You can make use of DoEvents</p>\n\n<pre><code>While(True)\n    'Write your code here.\n    DoEvents\nWEnd\n</code></pre>\n"}], "owner": {"reputation": 891, "user_id": 2672634, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/03b9819527625d5198e71248e7590cbe?s=128&d=identicon&r=PG", "display_name": "Jason Samuels", "link": "https://stackoverflow.com/users/2672634/jason-samuels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3441, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1423052697, "creation_date": 1422449284, "last_edit_date": 1531164843, "question_id": 28192670, "link": "https://stackoverflow.com/questions/28192670/running-a-macro-in-the-background", "title": "Running a macro in the background", "body": "<p>When running a macro in Excel, Excel focus its attention fully on the macro to complete and you cannot do anything in the workbook but wait. Is it possible to run a macro (in the background) in a workbook while working in the workbook as well?</p>\n\n<p>I tried to run the below code with <code>DoEvents</code> but it is not giving me what i want. Excel still hangs when the code is running,</p>\n\n<p><code>While (True)\nFor i = 1 To 500000\n    Cells(i, 1).Value = 1\nDoEvents\nNext i\nWend</code></p>\n"}, {"tags": ["vba", "excel", "for-loop"], "answers": [{"comments": [{"owner": {"reputation": 54, "user_id": 4502824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eea39103277c9b4d30ab2dbfdef5ea9f?s=128&d=identicon&r=PG&f=1", "display_name": "L-f", "link": "https://stackoverflow.com/users/4502824/l-f"}, "edited": false, "score": 0, "creation_date": 1422449150, "post_id": 28192412, "comment_id": 44752254, "body": "Thank you for your input! I will agree that readability is in fact an important matter, I only wondered if the performance improvement would be significant enough to sacrifice the former. From what I understood, the answer is &quot;no&quot;, so I&#39;ll keep my code as it is :)"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 1, "last_activity_date": 1422448482, "creation_date": 1422448482, "answer_id": 28192412, "question_id": 28192310, "link": "https://stackoverflow.com/questions/28192310/vba-using-multiple-for-loops-or-one-big/28192412#28192412", "title": "VBA: using multiple For loops, or one big?", "body": "<p>Viewed in its entirety the performance bottleneck will be in the acquisition of the data records, not in how the loops are structured.</p>\n\n<p>You're best aiming for readability rather than attempting to over-optimise code that will be a negligible contributor to execution time.</p>\n"}, {"comments": [{"owner": {"reputation": 54, "user_id": 4502824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eea39103277c9b4d30ab2dbfdef5ea9f?s=128&d=identicon&r=PG&f=1", "display_name": "L-f", "link": "https://stackoverflow.com/users/4502824/l-f"}, "edited": false, "score": 0, "creation_date": 1422449170, "post_id": 28192474, "comment_id": 44752264, "body": "Not at all, the initial data remains untouched and I use the output of those loops for later generation of pivot tables. I&#39;ll keep that in mind though if I ever find myself in need of validation :)"}], "tags": [], "owner": {"reputation": 1431, "user_id": 4473648, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5ac0b1e66e69b31e1bede0090a17e28f?s=128&d=identicon&r=PG&f=1", "display_name": "Avidan", "link": "https://stackoverflow.com/users/4473648/avidan"}, "is_accepted": false, "score": 0, "last_activity_date": 1422448717, "creation_date": 1422448717, "answer_id": 28192474, "question_id": 28192310, "link": "https://stackoverflow.com/questions/28192310/vba-using-multiple-for-loops-or-one-big/28192474#28192474", "title": "VBA: using multiple For loops, or one big?", "body": "<p>If you are validating the records in excel with those in Database then you can apply big for loop; but I can even suggest to use find() method if you have loops inside loops.\n(Find() Method can improve the performance)</p>\n"}, {"tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1422471805, "creation_date": 1422471805, "answer_id": 28200326, "question_id": 28192310, "link": "https://stackoverflow.com/questions/28192310/vba-using-multiple-for-loops-or-one-big/28200326#28200326", "title": "VBA: using multiple For loops, or one big?", "body": "<p>Your code will be very slow because you are making a large number of calls to the object model to retrieve values from individual cells. There is a large overhead associated with each call.</p>\n\n<p>It would be much faster to read all the required values into a variant array:</p>\n\n<pre><code>dim vArr as variant\nvArr=Range(\"A1\").resize(z,31).value2\n</code></pre>\n\n<p>and then process the resulting 2D array before returning the processed array to the worksheet</p>\n"}, {"comments": [{"owner": {"reputation": 54, "user_id": 4502824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eea39103277c9b4d30ab2dbfdef5ea9f?s=128&d=identicon&r=PG&f=1", "display_name": "L-f", "link": "https://stackoverflow.com/users/4502824/l-f"}, "edited": false, "score": 0, "creation_date": 1422527483, "post_id": 28200656, "comment_id": 44788701, "body": "I have this at the very beginning of the macro: <code>Application.ScreenUpdating=False</code> <code>Application.DisplayAlerts=False</code>(for automatically deleting temporary worksheets). I don&#39;t use in-sheet formulas, I guess that&#39;s what <code>Application.Calculation</code> is responsible for?"}], "tags": [], "owner": {"reputation": 81, "user_id": 4019746, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh5.googleusercontent.com/-XiDLcZ7__AQ/AAAAAAAAAAI/AAAAAAAANcg/1xqzhoECJU0/photo.jpg?sz=128", "display_name": "Fr&#233;d&#233;ric Marcotte Pich&#233;", "link": "https://stackoverflow.com/users/4019746/fr%c3%a9d%c3%a9ric-marcotte-pich%c3%a9"}, "is_accepted": false, "score": 0, "last_activity_date": 1422472902, "creation_date": 1422472902, "answer_id": 28200656, "question_id": 28192310, "link": "https://stackoverflow.com/questions/28192310/vba-using-multiple-for-loops-or-one-big/28200656#28200656", "title": "VBA: using multiple For loops, or one big?", "body": "<p>I second <em>Bathsheba</em> as to what the bottleneck operation is gonna be.\nHowever, whenever you have a long macro inserting lots of data, you might want to put this chunk of code <strong>Before</strong> your first loop:</p>\n\n<pre><code>Application.ScreenUpdating = False \nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\n</code></pre>\n\n<p>And this one <strong>at the end</strong> of your operations:</p>\n\n<pre><code>Application.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.EnableEvents = True\n</code></pre>\n\n<p>It will first disable screen updates, events and formula recalculation, and re-enable it once it finished its operations.</p>\n\n<p>Depending on the kind of operations you are doing, I found this to optimize the speed of a macro up to 75%.</p>\n"}], "owner": {"reputation": 54, "user_id": 4502824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eea39103277c9b4d30ab2dbfdef5ea9f?s=128&d=identicon&r=PG&f=1", "display_name": "L-f", "link": "https://stackoverflow.com/users/4502824/l-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 752, "favorite_count": 0, "accepted_answer_id": 28192412, "answer_count": 4, "score": 0, "last_activity_date": 1422472902, "creation_date": 1422448202, "question_id": 28192310, "link": "https://stackoverflow.com/questions/28192310/vba-using-multiple-for-loops-or-one-big", "title": "VBA: using multiple For loops, or one big?", "body": "<p>I've been recently wondering about which is better in terms of efficiency: to use multiple For loops, or one big loop containing many operations?</p>\n\n<p>I work with 50k-100k rows in 17 columns from SQL database.</p>\n\n<p>Now, a sample of code:</p>\n\n<pre><code>z = Cells(Rows.Count, 1).End(xlUp).Row\n\nFor i = 2 To z\n    If Cells(i, 15) &lt;&gt; 0 Then Cells(i, 19) = 1 Else Cells(i, 19) = 0\nNext i\n\nFor i = 2 To z\n    Cells(i, 20) = Val(Left(Cells(i, 2), 2))\nNext i\n\nFor i = 2 To z\nSelect Case Cells(i, 18).Value\n    Case Is = 1\n        Cells(i, 29).Value = 1\n    Case Is = 2\n        Cells(i, 29).Value = 1.6\n    Case Is = 3\n        Cells(i, 29).Value = 2.8\nEnd Select\nNext i\n\nFor i = 2 To z\n    Cells(i, 30) = Val(Right(Cells(i, 14), 1))\nNext i\n\nFor i = 2 To z\n    Cells(i, 31) = ((Cells(i, 18) + 1) * Cells(i, 16) * Cells(i, 17)) / 1000000\n    Cells(i, 31).NumberFormat = \"0.00\"\nNext i\n</code></pre>\n\n<p>My question is: is it wiser to do those operations by columns (separate For loop for every column), or by rows (one big loop containing all operations for each record)?</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4502724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f458bc67eb30484e4b2628f197fc6c1a?s=128&d=identicon&r=PG&f=1", "display_name": "Desag", "link": "https://stackoverflow.com/users/4502724/desag"}, "edited": false, "score": 0, "creation_date": 1422465322, "post_id": 28192079, "comment_id": 44763095, "body": "Thanks a lot! But i&#39;d hope a more &quot;elegant&quot; solution because the draft mail isn&#39;t always in the reading pane; Nothing to &quot;hook&quot; the draft mailitem from the original one object?"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 11, "user_id": 4502724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f458bc67eb30484e4b2628f197fc6c1a?s=128&d=identicon&r=PG&f=1", "display_name": "Desag", "link": "https://stackoverflow.com/users/4502724/desag"}, "edited": false, "score": 0, "creation_date": 1422466613, "post_id": 28192079, "comment_id": 44763841, "body": "How do you reply to the email? Do you click on the ribbon button?"}, {"owner": {"reputation": 11, "user_id": 4502724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f458bc67eb30484e4b2628f197fc6c1a?s=128&d=identicon&r=PG&f=1", "display_name": "Desag", "link": "https://stackoverflow.com/users/4502724/desag"}, "edited": false, "score": 0, "creation_date": 1422515315, "post_id": 28192079, "comment_id": 44782363, "body": "In this case, yes, but it can be programatically and not just before i try to get the draft. I prefer something more general. For exemple, the mail in the reading pane isn&#39;t necessary the first in the selection (which I try to get the draft)."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1422447502, "creation_date": 1422447502, "answer_id": 28192079, "question_id": 28191694, "link": "https://stackoverflow.com/questions/28191694/how-to-get-draft-mail-instead-of-original-one-from-explorer-object/28192079#28192079", "title": "How to get draft mail instead of original one from Explorer Object", "body": "<p>Outlook 2013 introduces a new property for the Explorer class \u2013 <a href=\"http://msdn.microsoft.com/en-us/library/office/jj231535%28v=office.15%29.aspx\" rel=\"nofollow\">ActiveInlineResponse</a>. It allows getting an item which is listed in the Outlook 2013 reading pane in case the inline response is active.</p>\n\n<p>For handling inline replies Outlook 2013 introduces a new event which notifies developers when the inline response is activated \u2013 the <a href=\"http://msdn.microsoft.com/en-us/library/office/jj229061%28v=office.15%29.aspx\" rel=\"nofollow\">InlineResponse</a> event.</p>\n"}], "owner": {"reputation": 11, "user_id": 4502724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f458bc67eb30484e4b2628f197fc6c1a?s=128&d=identicon&r=PG&f=1", "display_name": "Desag", "link": "https://stackoverflow.com/users/4502724/desag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593475087, "creation_date": 1422446218, "last_edit_date": 1593475087, "question_id": 28191694, "link": "https://stackoverflow.com/questions/28191694/how-to-get-draft-mail-instead-of-original-one-from-explorer-object", "title": "How to get draft mail instead of original one from Explorer Object", "body": "<p>When I reply to a mail i would get the Draft of the Reply from the Explorer object and not the Original mail with an expression like application.ActiveExplorer.Selection.Item(1).xxxx .\nThe expression application.ActiveExplorer.Selection.Item(1) give the original mail not the \"reply Draft\".</p>\n\n<p>Thanks for answer</p>\n\n<p>Desag</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1422467171, "post_id": 28191508, "comment_id": 44764198, "body": "It seems like the problem is with the cell holding the value as a number, not with getting the value into the cell.  It seems like your solution ultimately outputs a string due to concatenation, but is complex in accomplishing this."}, {"owner": {"reputation": 7115, "user_id": 2347483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80792d6741e11aaa6bec5f80fcc30a9c?s=128&d=identicon&r=PG", "display_name": "Phylogenesis", "link": "https://stackoverflow.com/users/2347483/phylogenesis"}, "reply_to_user": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1422468964, "post_id": 28191508, "comment_id": 44765249, "body": "@n8 The number is too large to be operated upon in that way. Excel does not handle arbitrarily large integers; you only get 15 digits of precision."}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1422470556, "post_id": 28191508, "comment_id": 44766163, "body": "OK, but if the textbox value is a string and the cell is formatted as text then there is no reason to make it a number.  The only challenge is to ensure Excel doesn&#39;t try and be helpful and convert it to a number."}, {"owner": {"reputation": 7115, "user_id": 2347483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80792d6741e11aaa6bec5f80fcc30a9c?s=128&d=identicon&r=PG", "display_name": "Phylogenesis", "link": "https://stackoverflow.com/users/2347483/phylogenesis"}, "reply_to_user": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1422489265, "post_id": 28191508, "comment_id": 44775186, "body": "@n8 How <i>exactly</i> do you want <code>var1 = TextBox1.Value + i</code> to work without Excel treating it as a number at some point?"}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1422491117, "post_id": 28191508, "comment_id": 44775724, "body": "OK, I&#39;m seeing your point, vba converts it to a Long, which is presented in scientific form.  In the case that the TextBox1.value is 999999999999999999 (or something similarly problematic where textbox + i will cause a number in a unevaluated position &quot;x&quot; to roll) there is likely a need for a recursive function that will start with len(i) and exit when the 1 no longer carries.  I jumped the gun, this is not a simple problem."}, {"owner": {"reputation": 83, "user_id": 4477632, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-SbOIzED2QO0/AAAAAAAAAAI/AAAAAAAAJYU/3j8W4uQBxLs/photo.jpg?sz=128", "display_name": "Ashwin Balaji Kuppuraj", "link": "https://stackoverflow.com/users/4477632/ashwin-balaji-kuppuraj"}, "edited": false, "score": 0, "creation_date": 1422503458, "post_id": 28191508, "comment_id": 44778733, "body": "@Phylogenesis It worked with your suggestion. Thanks for your advise"}], "tags": [], "owner": {"reputation": 7115, "user_id": 2347483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80792d6741e11aaa6bec5f80fcc30a9c?s=128&d=identicon&r=PG", "display_name": "Phylogenesis", "link": "https://stackoverflow.com/users/2347483/phylogenesis"}, "is_accepted": true, "score": 1, "last_activity_date": 1422469316, "last_edit_date": 1422469316, "creation_date": 1422445650, "answer_id": 28191508, "question_id": 28191238, "link": "https://stackoverflow.com/questions/28191238/vba-code-to-key-in-a-19-digit-number-using-loop-in-a-excel-cell-without-conve/28191508#28191508", "title": "VBA code to key in a 19 digit number using &quot;loop&quot; in a excel cell, without converting it into value like &quot;1.591E+17&quot;?", "body": "<p>You can't store these numbers this size as a number because they are too large for an Integer to hold and are too precise for a Double. The only way to do this would be to increment the last few digits and keep a prefix as a string.</p>\n\n<p>Something like (untested):</p>\n\n<pre><code>Dim prefix As String\nDim startValue As Long\nDim endValue As Long\n\nprefix = Left(TextBox1.Value, 12)\nstartValue = Val(Right(TextBox1.Value, 7))\nendValue = startValue + Val(TextBox2.Value)\n\nFor i = startValue To endValue\n    ActiveCell.Value2 = prefix &amp; Format(i, \"0000000\")\n    ActiveCell.Offset(1, 0).Activate\nNext\n</code></pre>\n\n<p>This will only work if the text is always 19 digits, otherwise the <code>prefix</code>, <code>startValue</code> and <code>endValue</code> variables will need to be adjusted accordingly.</p>\n"}, {"comments": [{"owner": {"reputation": 83, "user_id": 4477632, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-SbOIzED2QO0/AAAAAAAAAAI/AAAAAAAAJYU/3j8W4uQBxLs/photo.jpg?sz=128", "display_name": "Ashwin Balaji Kuppuraj", "link": "https://stackoverflow.com/users/4477632/ashwin-balaji-kuppuraj"}, "edited": false, "score": 0, "creation_date": 1422503429, "post_id": 28198680, "comment_id": 44778726, "body": "@Phylogenesis It worked with your suggestion. Thanks for your advise."}], "tags": [], "owner": {"reputation": 522, "user_id": 2430171, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kEarE.png?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/2430171/mitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1422466324, "creation_date": 1422466324, "answer_id": 28198680, "question_id": 28191238, "link": "https://stackoverflow.com/questions/28191238/vba-code-to-key-in-a-19-digit-number-using-loop-in-a-excel-cell-without-conve/28198680#28198680", "title": "VBA code to key in a 19 digit number using &quot;loop&quot; in a excel cell, without converting it into value like &quot;1.591E+17&quot;?", "body": "<p>You can format the NumberFormat and specifically define how many places you want to format out to:</p>\n\n<pre><code>For i = 0 To Val(TextBox2.Value)    \nvar1 = TextBox1.Value + i \nActiveCell.NumberFormat = \"00000000000000000.0\"\nActiveCell.Value2 = var1 \nActiveCell.Offset(1, 0).Activate \nNext i\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 4477632, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-SbOIzED2QO0/AAAAAAAAAAI/AAAAAAAAJYU/3j8W4uQBxLs/photo.jpg?sz=128", "display_name": "Ashwin Balaji Kuppuraj", "link": "https://stackoverflow.com/users/4477632/ashwin-balaji-kuppuraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1039, "favorite_count": 0, "accepted_answer_id": 28191508, "answer_count": 2, "score": 1, "last_activity_date": 1422470348, "creation_date": 1422444880, "last_edit_date": 1531164843, "question_id": 28191238, "link": "https://stackoverflow.com/questions/28191238/vba-code-to-key-in-a-19-digit-number-using-loop-in-a-excel-cell-without-conve", "title": "VBA code to key in a 19 digit number using &quot;loop&quot; in a excel cell, without converting it into value like &quot;1.591E+17&quot;?", "body": "<p>This is my piece of code.</p>\n\n<pre><code>For i = 0 To Val(TextBox2.Value)    \nvar1 = TextBox1.Value + i \nActiveCell.NumberFormat = \"@\" \nActiveCell.Value2 = var1 \nActiveCell.Offset(1, 0).Activate \nNext i\n</code></pre>\n\n<p>My input is \"159100000000000000\" and what I expect is - \"X\" numbers after that.\nI should get the values in cells like</p>\n\n<pre><code>159100000000000000\n159100000000000001\n159100000000000002\n159100000000000003\n.\n.\n.\n</code></pre>\n\n<p>Even I tried to change the number format of my cell to \"Text\" in run time. Still am getting values like </p>\n\n<blockquote>\n  <p>'1.591E+17 '1.591E+17 '1.591E+17 '1.591E+17</p>\n</blockquote>\n\n<p>Can anybody help me in this??</p>\n"}, {"tags": ["vba", "email", "excel"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 1120583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeOGP.jpg?s=128&g=1", "display_name": "Ranjit", "link": "https://stackoverflow.com/users/1120583/ranjit"}, "edited": false, "score": 0, "creation_date": 1422447245, "post_id": 28191602, "comment_id": 44751104, "body": "Thank u very much Eugene Astafiev, this excel vba may run in different environments, the mail client may not be Outlook there."}, {"owner": {"reputation": 45, "user_id": 1120583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeOGP.jpg?s=128&g=1", "display_name": "Ranjit", "link": "https://stackoverflow.com/users/1120583/ranjit"}, "edited": false, "score": 0, "creation_date": 1422447976, "post_id": 28191602, "comment_id": 44751510, "body": "Could you please share more how to know which mail client is there and how to execute the Shell command for different mail client as I mention in my question..."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 45, "user_id": 1120583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeOGP.jpg?s=128&g=1", "display_name": "Ranjit", "link": "https://stackoverflow.com/users/1120583/ranjit"}, "edited": false, "score": 0, "creation_date": 1422456829, "post_id": 28191602, "comment_id": 44757223, "body": "There is no need to detect the default email client. It will be invoked automatically using the mailto command."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1422445942, "last_edit_date": 1495542035, "creation_date": 1422445942, "answer_id": 28191602, "question_id": 28191047, "link": "https://stackoverflow.com/questions/28191047/how-to-open-default-x-mail-client-along-with-to-cc-bcc-html-body-attachme/28191602#28191602", "title": "How to open default (X) mail client along with to, cc, bcc, html body &amp; attachment of active workbook using VBA in excel", "body": "<p>You can use the <a href=\"https://stackoverflow.com/questions/17956651/execute-a-command-in-command-prompt-using-excel-vba\">Shell</a> method passing the <a href=\"https://msdn.microsoft.com/en-us/library/aa767737%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\">mailto</a> string. See <a href=\"https://support.microsoft.com/KB/287573?wa=wsignin1.0\" rel=\"nofollow noreferrer\">How to use command line switches to create a pre-addressed e-mail message in Outlook</a> for more information.</p>\n\n<p>Also you may consider automating Outlook. See <a href=\"https://support.microsoft.com/kb/201096?wa=wsignin1.0\" rel=\"nofollow noreferrer\">How to automate Outlook from another program</a> for a sample code.</p>\n"}], "owner": {"reputation": 45, "user_id": 1120583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeOGP.jpg?s=128&g=1", "display_name": "Ranjit", "link": "https://stackoverflow.com/users/1120583/ranjit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 980, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1422445942, "creation_date": 1422444337, "question_id": 28191047, "link": "https://stackoverflow.com/questions/28191047/how-to-open-default-x-mail-client-along-with-to-cc-bcc-html-body-attachme", "title": "How to open default (X) mail client along with to, cc, bcc, html body &amp; attachment of active workbook using VBA in excel", "body": "<p>We have a requirement like we need to open default mail (what ever may be like : MS Outlook, Mozilla Thunderbird,Windows Live Mail, Opera Mail etc. ) along with to, cc, bcc, html body &amp; attachment of active workbook on a button click in Excel using VBA.</p>\n\n<p>Thanks in advance. if any one can help me.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 3691092, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fea2ade524eb145b286f97f1e0057171?s=128&d=identicon&r=PG&f=1", "display_name": "Braide", "link": "https://stackoverflow.com/users/3691092/braide"}, "edited": false, "score": 0, "creation_date": 1422444935, "post_id": 28191049, "comment_id": 44749808, "body": "not sure what you mean? The  workbook should be saved in the folder FI quote Speadsheets (above 500) or   FI quote Speadsheets (below 500). The error says the path doesnt exist which it doesnt, becuase somehow \\0BA1700 (this changes each time) is being added to the file path so it is trying to save it in a folder which doesn&#39;t exist."}], "tags": [], "owner": {"reputation": 1909, "user_id": 4067967, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/100001971549669/picture?type=large", "display_name": "Haito", "link": "https://stackoverflow.com/users/4067967/haito"}, "is_accepted": false, "score": 0, "last_activity_date": 1422444343, "creation_date": 1422444343, "answer_id": 28191049, "question_id": 28190833, "link": "https://stackoverflow.com/questions/28190833/save-as-method-is-creating-runtime-error-for-some-users-not-others/28191049#28191049", "title": "Save As method is creating runtime error for some users not others", "body": "<p>Maybe some kind of exception? Are you sure nothing is currently using this file? Maybe you own program does?</p>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 3691092, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fea2ade524eb145b286f97f1e0057171?s=128&d=identicon&r=PG&f=1", "display_name": "Braide", "link": "https://stackoverflow.com/users/3691092/braide"}, "is_accepted": true, "score": 0, "last_activity_date": 1422451702, "creation_date": 1422451702, "answer_id": 28193482, "question_id": 28190833, "link": "https://stackoverflow.com/questions/28190833/save-as-method-is-creating-runtime-error-for-some-users-not-others/28193482#28193482", "title": "Save As method is creating runtime error for some users not others", "body": "<p>Solved. My colleague's computer didn't have the G drive mapped to the correct server so remapped it and now working fine.</p>\n"}], "owner": {"reputation": 111, "user_id": 3691092, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fea2ade524eb145b286f97f1e0057171?s=128&d=identicon&r=PG&f=1", "display_name": "Braide", "link": "https://stackoverflow.com/users/3691092/braide"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 28193482, "answer_count": 2, "score": 0, "last_activity_date": 1422451702, "creation_date": 1422443726, "last_edit_date": 1531164843, "question_id": 28190833, "link": "https://stackoverflow.com/questions/28190833/save-as-method-is-creating-runtime-error-for-some-users-not-others", "title": "Save As method is creating runtime error for some users not others", "body": "<p><img src=\"https://i.stack.imgur.com/tSIu5.jpg\" alt=\"Run-time error &#39;1004&#39;\">I created a command button that auto saves the workbook into one of two file paths depending on info in the spreadsheet. This works fine for me but my colleague is gettting the follwing error everytime. </p>\n\n<p>The method is extending the file path and adding \\0BA1700 in this instance (this changes every time). This doesn't happen on my computer and the code works as it should. Here is the sub:</p>\n\n<pre><code>Private Sub CommandButton21_Click()\nDim pathUnder As String\nDim pathOver As String\nDim file As String\n\nfile = Range(\"D2\").Value\npathUnder = \"G:\\Technical Services\\LARGE CORPORATE UW\\Full Insurance\\FI Quote Spreadsheets (below 500)\\\"\npathOver = \"G:\\Technical Services\\LARGE CORPORATE UW\\Full Insurance\\FI Quote Spreadsheets (above 500)\\\"\n\nIf Range(\"D4\").Value = \"\" Or Range(\"D2\").Value = \"\" Then\nMsgBox (\"Save Failed. Please ensure there are values in both cells D2 and D4\")\nElse\nIf Range(\"D4\").Value &gt;= 500 Then\nActiveWorkbook.SaveAs fileName:=pathOver &amp; file &amp; \".xlsm\", FileFormat:=52\nElse\nActiveWorkbook.SaveAs fileName:=pathUnder &amp; file &amp; \".xlsm\", FileFormat:=52\nEnd If\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Help much appreciated.</p>\n"}, {"tags": ["excel", "formatting", "vlookup", "vba"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 4498094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7023269be15fb5e1238cbcebd186a22?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4498094/george"}, "edited": false, "score": 0, "creation_date": 1422456085, "post_id": 28193518, "comment_id": 44756751, "body": "Many thanks! You&#39;ve really helped me out the last couple of days!"}, {"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "reply_to_user": {"reputation": 15, "user_id": 4498094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7023269be15fb5e1238cbcebd186a22?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4498094/george"}, "edited": false, "score": 0, "creation_date": 1422456165, "post_id": 28193518, "comment_id": 44756803, "body": "No problem, glad I could help!"}], "tags": [], "owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "is_accepted": true, "score": 0, "last_activity_date": 1422452183, "last_edit_date": 1422452183, "creation_date": 1422451810, "answer_id": 28193518, "question_id": 28190411, "link": "https://stackoverflow.com/questions/28190411/vba-vlookup-keep-formatting/28193518#28193518", "title": "vba vlookup keep formatting", "body": "<p>If you don't need the values to be text, you could format the cells as a Custom format of Type \"00\":</p>\n\n<p><img src=\"https://i.stack.imgur.com/LIgBQ.png\" alt=\"Format Cells\"></p>\n\n<p><strong>EDIT</strong></p>\n\n<p>A simpler answer is to change your code to this:</p>\n\n<pre><code>'vlookup based on combobox selection held in variable\n    Cat3No = Application.WorksheetFunction.VLookup(Me.ComboBoxCat3Name.Value, (Worksheets(\"ValidCombos\").Range(\"C:D\")), 2, False)\n\n'variable used to change cell in dataset\n    With Worksheets(\"CurrentMonth\").Cells(Currentrow, 32)\n        .Value = Cat3No\n        .NumberFormat = \"00\"\n    End With\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 4498094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7023269be15fb5e1238cbcebd186a22?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4498094/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1577, "favorite_count": 0, "accepted_answer_id": 28193518, "answer_count": 1, "score": 0, "last_activity_date": 1422452183, "creation_date": 1422442446, "last_edit_date": 1531164843, "question_id": 28190411, "link": "https://stackoverflow.com/questions/28190411/vba-vlookup-keep-formatting", "title": "vba vlookup keep formatting", "body": "<p>My code below has a vlookup which changes a cell in my data (CurrentMonth), but I can't get it to keep the formatting of the source. The return values in col 2 are 01, 02, 03 etc up to 12 in general text format, but the formula below returns 1, 2, 3 etc. </p>\n\n<p>I've tried putting a ' before the numbers in the table I'm looking into, but that doesn't work. Also tried copying the format with code and then pastespecial formats on the changed value, but this doesn't work. The format type of the lookup table and the data I'm changing are identical. What code do I need to keep the formating please so I don't lose the 0 at the beginning, keeping the lookup value as text?</p>\n\n<pre><code>'vlookup based on combobox selection held in variable\n    Cat3No = Application.WorksheetFunction.VLookup(Me.ComboBoxCat3Name.Value, (Worksheets(\"ValidCombos\").Range(\"C:D\")), 2, False)\n\n'variable used to change cell in dataset\n    Worksheets(\"CurrentMonth\").Cells(Currentrow, 32).Value = Cat3No\n</code></pre>\n"}, {"tags": ["vba", "excel", "resize", "excel-2010"], "comments": [{"owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "edited": false, "score": 0, "creation_date": 1422442324, "post_id": 28190307, "comment_id": 44748372, "body": "does this problem occur when you change your screen resolution?"}, {"owner": {"reputation": 229, "user_id": 1220666, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7c919fc8d47ecf406704b290cb45b7a8?s=128&d=identicon&r=PG", "display_name": "Hardworker", "link": "https://stackoverflow.com/users/1220666/hardworker"}, "reply_to_user": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "edited": false, "score": 0, "creation_date": 1422442990, "post_id": 28190307, "comment_id": 44748758, "body": "Thanks @blckbird for your quick turn around, No when i release the filter the buttons change their size..."}], "answers": [{"tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": false, "score": 0, "last_activity_date": 1422452734, "creation_date": 1422452734, "answer_id": 28193821, "question_id": 28190307, "link": "https://stackoverflow.com/questions/28190307/how-to-prevent-re-sizing-of-buttons-after-release-of-auto-filter-in-excel-2010-u/28193821#28193821", "title": "how to prevent re sizing of buttons after release of auto filter in excel 2010 using vba", "body": "<p>My guess is that you need to set the object positioning of the button to \"Don't move or size with cells\" (as seen <a href=\"http://imgur.com/yRggghF\" rel=\"nofollow\">here</a>, unfortunately I don't have enough reputation to post images yet).</p>\n\n<p>If you have many different buttons in many different spreadsheets, this code should set the property for all of them (provided none of the worksheets are protected, etc.)</p>\n\n<pre><code>Sub test()\n  Dim ws As Worksheet, sh As Shape\n\n  For Each ws In Worksheets\n    For Each sh In ws.Shapes\n      If sh.Type = msoFormControl Then\n        sh.Placement = xlFreeFloating\n      End If\n    Next\n  Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9580128, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fs5mowA7Nzs/AAAAAAAAAAI/AAAAAAAAAus/jAj2-9wrwL8/photo.jpg?sz=128", "display_name": "Srijan Seal", "link": "https://stackoverflow.com/users/9580128/srijan-seal"}, "is_accepted": false, "score": 0, "last_activity_date": 1599412660, "creation_date": 1599412660, "answer_id": 63766905, "question_id": 28190307, "link": "https://stackoverflow.com/questions/28190307/how-to-prevent-re-sizing-of-buttons-after-release-of-auto-filter-in-excel-2010-u/63766905#63766905", "title": "how to prevent re sizing of buttons after release of auto filter in excel 2010 using vba", "body": "<p>I faced the same issue and couldn't find a solution anywhere in the internet. Then on manual testing, I found that the issue is with the format.</p>\n<ul>\n<li>Please clear the format from the range of cells where you're trying to put autofilter</li>\n</ul>\n<p>For example, I copied data from source file and pasted the as values and then I put the autofilter.</p>\n"}], "owner": {"reputation": 229, "user_id": 1220666, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7c919fc8d47ecf406704b290cb45b7a8?s=128&d=identicon&r=PG", "display_name": "Hardworker", "link": "https://stackoverflow.com/users/1220666/hardworker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 913, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1599412660, "creation_date": 1422442163, "last_edit_date": 1422448261, "question_id": 28190307, "link": "https://stackoverflow.com/questions/28190307/how-to-prevent-re-sizing-of-buttons-after-release-of-auto-filter-in-excel-2010-u", "title": "how to prevent re sizing of buttons after release of auto filter in excel 2010 using vba", "body": "<p>I have an excel sheet with some buttons (each doing different functions) i have created an auto filter macro as shown below but the problem is when i release the filter my all buttons get very small in their sizes (means they change their original size) although i selected the radio button (Do not move or size with cell) from each button's property.</p>\n\n<pre><code>Sub AutoFilter()\n\nRange(\"A1:I1628\").Select\nSelection.AutoFilter\nActiveSheet.Range(\"$A$1:$I$1631\").AutoFilter Field:=8, Criteria1:=\"=\"\nSelection.Copy\nSheets(\"Blank Names\").Select\nRange(\"A1\").Select\nActiveSheet.Paste\n</code></pre>\n\n<p>End Sub</p>\n\n<p>I am badly in need of help, please assist me with this issue.plzzzzzz</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 145, "user_id": 3468458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/698368a8189b9060987f7d29a27380b4?s=128&d=identicon&r=PG&f=1", "display_name": "Hewage", "link": "https://stackoverflow.com/users/3468458/hewage"}, "edited": false, "score": 0, "creation_date": 1422442981, "post_id": 28189864, "comment_id": 44748752, "body": "In other word, I need to show inputbox characters as Asterisks."}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 3468458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/698368a8189b9060987f7d29a27380b4?s=128&d=identicon&r=PG&f=1", "display_name": "Hewage", "link": "https://stackoverflow.com/users/3468458/hewage"}, "edited": false, "score": 0, "creation_date": 1422447570, "post_id": 28190816, "comment_id": 44751298, "body": "Thanks for your comment. I will try to do some other way"}], "tags": [], "owner": {"reputation": 571, "user_id": 4340990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac421880c2178ee38d120ad3b1c7fa2a?s=128&d=identicon&r=PG&f=1", "display_name": "Liniel", "link": "https://stackoverflow.com/users/4340990/liniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1422443669, "creation_date": 1422443669, "answer_id": 28190816, "question_id": 28189864, "link": "https://stackoverflow.com/questions/28189864/excel-vba-input-box/28190816#28190816", "title": "Excel VBA Input box", "body": "<p>ImputBox does not support masking, so you can't hide characters in then. You need to use some like TextBox with white characters or something like this.</p>\n"}, {"comments": [{"owner": {"reputation": 145, "user_id": 3468458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/698368a8189b9060987f7d29a27380b4?s=128&d=identicon&r=PG&f=1", "display_name": "Hewage", "link": "https://stackoverflow.com/users/3468458/hewage"}, "edited": false, "score": 0, "creation_date": 1422597699, "post_id": 28195548, "comment_id": 44822720, "body": "Thanks Dave. Actually my codes are complicated than I mentioned in this question. I have excel file with few user names and passwords. Each user assigned worksheets as below;"}, {"owner": {"reputation": 145, "user_id": 3468458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/698368a8189b9060987f7d29a27380b4?s=128&d=identicon&r=PG&f=1", "display_name": "Hewage", "link": "https://stackoverflow.com/users/3468458/hewage"}, "edited": false, "score": 0, "creation_date": 1422597770, "post_id": 28195548, "comment_id": 44822738, "body": "User*Name\tPassword\tSheet 1\tSheet 2\tSheet 3\tSheet 4\tSheet 5\t david\t10\tx\tx\tx\tx\tx\t paul\t11\t\t\tx\tx\tx\tx martin\t12\t\t\tx\t\t\t kumar\t13\t\t\tx\tx\tx"}, {"owner": {"reputation": 145, "user_id": 3468458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/698368a8189b9060987f7d29a27380b4?s=128&d=identicon&r=PG&f=1", "display_name": "Hewage", "link": "https://stackoverflow.com/users/3468458/hewage"}, "edited": false, "score": 0, "creation_date": 1422598155, "post_id": 28195548, "comment_id": 44822856, "body": "Please disregard above comment. First row of the sheet user name, password and sheets mentioned. Below rows assigned accessibility for each user. As follows;"}, {"owner": {"reputation": 145, "user_id": 3468458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/698368a8189b9060987f7d29a27380b4?s=128&d=identicon&r=PG&f=1", "display_name": "Hewage", "link": "https://stackoverflow.com/users/3468458/hewage"}, "edited": false, "score": 0, "creation_date": 1422598676, "post_id": 28195548, "comment_id": 44823022, "body": "User*Name\tPassword \tUser List\tAdmin\tMenu\tCarpet david\t            10\t               x\t    x\t            x             x paul                     11\t\t\t                                    x\t           x martin\t            12\t\t\t                                           x\t kumar\t            13\t\t\t                            x\t           x"}, {"owner": {"reputation": 145, "user_id": 3468458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/698368a8189b9060987f7d29a27380b4?s=128&d=identicon&r=PG&f=1", "display_name": "Hewage", "link": "https://stackoverflow.com/users/3468458/hewage"}, "edited": false, "score": 0, "creation_date": 1422599162, "post_id": 28195548, "comment_id": 44823193, "body": "Private Sub Workbook_Open() Dim Sh As Worksheet Dim UserName As String Dim Password As String Dim ThisCell As Range Dim c As Long For Each Sh In ThisWorkbook.Worksheets If Sh.Name &lt;&gt; &quot;Menu&quot; Then Sh.Visible = xlSheetVeryHidden End If Next Sh"}, {"owner": {"reputation": 145, "user_id": 3468458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/698368a8189b9060987f7d29a27380b4?s=128&d=identicon&r=PG&f=1", "display_name": "Hewage", "link": "https://stackoverflow.com/users/3468458/hewage"}, "edited": false, "score": 0, "creation_date": 1422599213, "post_id": 28195548, "comment_id": 44823218, "body": "UserName = InputBox(&quot;Please Enter Your USER NAME.&quot;) Password = InputBox(&quot;Please Enter PASSWORD.&quot;) For Each ThisCell In Sheets(&quot;User List&quot;).Range(&quot;A2:A&quot; &amp; Sheets(&quot;User List&quot;).Range(&quot;A65536&quot;).End(xlUp).Row) If UCase(ThisCell.Value) = UCase(UserName) And UCase(ThisCell.Offset(, 1).Value) = UCase(Password) Then MsgBox &quot;Access Granted&quot; For c = 2 To 55 If ThisCell.Offset(, c).Value &lt;&gt; &quot;&quot; Then Sheets(Sheets(&quot;User List&quot;).Cells(1, c + 1).Value).Visible = xlSheetVisible End If Next c Exit Sub End If Next ThisCell MsgBox &quot;Access Denied&quot; ThisWorkbook.Close End Sub"}, {"owner": {"reputation": 145, "user_id": 3468458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/698368a8189b9060987f7d29a27380b4?s=128&d=identicon&r=PG&f=1", "display_name": "Hewage", "link": "https://stackoverflow.com/users/3468458/hewage"}, "edited": false, "score": 0, "creation_date": 1422599466, "post_id": 28195548, "comment_id": 44823297, "body": "How to mask this password? Hewage"}, {"owner": {"reputation": 145, "user_id": 3468458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/698368a8189b9060987f7d29a27380b4?s=128&d=identicon&r=PG&f=1", "display_name": "Hewage", "link": "https://stackoverflow.com/users/3468458/hewage"}, "edited": false, "score": 0, "creation_date": 1424007217, "post_id": 28195548, "comment_id": 45368795, "body": "I could manage with above information. It is useful. Appreciated."}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 7, "last_activity_date": 1422457540, "creation_date": 1422457540, "answer_id": 28195548, "question_id": 28189864, "link": "https://stackoverflow.com/questions/28189864/excel-vba-input-box/28195548#28195548", "title": "Excel VBA Input box", "body": "<p>Use a UserForm\nCreate a userform that has a Textbox, and Two Buttons\nIn the textbox Properties, enter * in the PasswordChar  Box</p>\n\n<p><img src=\"https://i.stack.imgur.com/uLvPX.jpg\" alt=\"enter image description here\"></p>\n\n<p>Use the code below in the userForm module.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nIf TextBox1 = \"123456\" Then\nMsgBox \"Correct\"\nElse\nMsgBox \"Incorrect\"\nEnd If\nUnload Me\n\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\n\n'cancel button\n\nUnload Me\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n\nMe.Caption = \"Enter Password\"\n\nEnd Sub\n</code></pre>\n\n<p>Your userform will look like this</p>\n\n<p><img src=\"https://i.stack.imgur.com/zhQLW.jpg\" alt=\"enter image description here\"></p>\n"}, {"tags": [], "owner": {"reputation": 1225, "user_id": 4847565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LeD30.jpg?s=128&g=1", "display_name": "Bhanu Pratap", "link": "https://stackoverflow.com/users/4847565/bhanu-pratap"}, "is_accepted": false, "score": 3, "last_activity_date": 1528957354, "creation_date": 1528957354, "answer_id": 50850857, "question_id": 28189864, "link": "https://stackoverflow.com/questions/28189864/excel-vba-input-box/50850857#50850857", "title": "Excel VBA Input box", "body": "<blockquote>\n  <p>It is possible to mask InputBox text in vba.</p>\n</blockquote>\n\n<pre><code>    Option Explicit\n\n'////////////////////////////////////////////////////////////////////\n'Password masked inputbox\n'Allows you to hide characters entered in a VBA Inputbox.\n'\n'Code written by Daniel Klann\n'March 2003\n'////////////////////////////////////////////////////////////////////\n\n\n'API functions to be used\nPrivate Declare Function CallNextHookEx Lib \"user32\" (ByVal hHook As Long, _\n    ByVal ncode As Long, ByVal wParam As Long, lParam As Any) As Long\n\nPrivate Declare Function GetModuleHandle Lib \"kernel32\" Alias \"GetModuleHandleA\" (ByVal lpModuleName As String) As Long\n\nPrivate Declare Function SetWindowsHookEx Lib \"user32\" Alias \"SetWindowsHookExA\" _\n    (ByVal idHook As Long, ByVal lpfn As Long, ByVal hmod As Long, ByVal dwThreadId As Long) As Long\n\nPrivate Declare Function UnhookWindowsHookEx Lib \"user32\" (ByVal hHook As Long) As Long\n\nPrivate Declare Function SendDlgItemMessage Lib \"user32\" Alias \"SendDlgItemMessageA\" _\n(ByVal hDlg As Long, ByVal nIDDlgItem As Long, ByVal wMsg As Long, ByVal wParam As Long, ByVal lParam As Long) As Long\n\nPrivate Declare Function GetClassName Lib \"user32\" Alias \"GetClassNameA\" (ByVal hwnd As Long, _\nByVal lpClassName As String, ByVal nMaxCount As Long) As Long\n\nPrivate Declare Function GetCurrentThreadId Lib \"kernel32\" () As Long\n\n'Constants to be used in our API functions\nPrivate Const EM_SETPASSWORDCHAR = &amp;HCC\nPrivate Const WH_CBT = 5\nPrivate Const HCBT_ACTIVATE = 5\nPrivate Const HC_ACTION = 0\n\n\nPrivate hHook As Long\n\n\nPublic Function NewProc(ByVal lngCode As Long, ByVal wParam As Long, ByVal lParam As Long) As Long\n    Dim RetVal\n    Dim strClassName As String, lngBuffer As Long\n\n    If lngCode &lt; HC_ACTION Then\n        NewProc = CallNextHookEx(hHook, lngCode, wParam, lParam)\n        Exit Function\n    End If\n\n    strClassName = String$(256, \" \")\n    lngBuffer = 255\n\n    If lngCode = HCBT_ACTIVATE Then    'A window has been activated\n\n        RetVal = GetClassName(wParam, strClassName, lngBuffer)\n\n        If Left$(strClassName, RetVal) = \"#32770\" Then  'Class name of the Inputbox\n\n            'This changes the edit control so that it display the password character *.\n            'You can change the Asc(\"*\") as you please.\n            SendDlgItemMessage wParam, &amp;H1324, EM_SETPASSWORDCHAR, Asc(\"*\"), &amp;H0\n        End If\n\n    End If\n\n    'This line will ensure that any other hooks that may be in place are\n    'called correctly.\n    CallNextHookEx hHook, lngCode, wParam, lParam\n\nEnd Function\n\nFunction InputBoxDK(Prompt, Title) As String\n    Dim lngModHwnd As Long, lngThreadID As Long\n\n    lngThreadID = GetCurrentThreadId\n    lngModHwnd = GetModuleHandle(vbNullString)\n\n    hHook = SetWindowsHookEx(WH_CBT, AddressOf NewProc, lngModHwnd, lngThreadID)\n\n    InputBoxDK = InputBox(Prompt, Title)\n    UnhookWindowsHookEx hHook\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 109, "user_id": 12976091, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_d6lJyvVGRk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfiWVQot_mxn90eZIlE8H5aFb8png/photo.jpg?sz=128", "display_name": "kamocyc", "link": "https://stackoverflow.com/users/12976091/kamocyc"}, "edited": false, "score": 0, "creation_date": 1595301644, "post_id": 60039656, "comment_id": 111419828, "body": "This should be the accepted answer. Note it&#39;s a minor point but <code>Asc(&quot;\u2022&quot;)</code> changed to <code>Asc(&quot;?&quot;)</code> in my computer. Using an ascii character might be better."}], "tags": [], "owner": {"reputation": 67, "user_id": 12807206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0112047573d6f71bcb710f3f401f4b86?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph316", "link": "https://stackoverflow.com/users/12807206/joseph316"}, "is_accepted": false, "score": 2, "last_activity_date": 1580734385, "creation_date": 1580734385, "answer_id": 60039656, "question_id": 28189864, "link": "https://stackoverflow.com/questions/28189864/excel-vba-input-box/60039656#60039656", "title": "Excel VBA Input box", "body": "<p>I know this is an old question, but <code>Bhanu Pratap</code>'s code from Daniel Khan required updating before I could use it in Office 365. That code was written for a 32-bit Excel environment, but the modern Excel uses a 64-bit environment and returns errors on his code. I almost thought I would not be able to salvage his code! Since I finally found out how to make it work, I wanted to post it here in-case anyone else also finds it useful.</p>\n\n<p>Excel 64-bit Code:</p>\n\n<pre><code>Option Explicit\n\n'////////////////////////////////////////////////////////////////////\n'Password masked inputbox\n'Allows you to hide characters entered in a VBA Inputbox.\n'\n'Code written by Daniel Klann\n'March 2003\n'\n'Code updated by Joseph for Excel 64-bit Environments\n'February 2020\n'PtrSafe added &amp; Long to PtrLong conversion\n'see https://social.msdn.microsoft.com/Forums/office/en-US/c414ef6d-fa9a-406c-9644-e479e7e72d0b/addressof-function-data-type-mismatch?forum=accessdev\n'////////////////////////////////////////////////////////////////////\n\n'API functions to be used\nPrivate Declare PtrSafe Function CallNextHookEx Lib \"user32\" (ByVal hHook As LongPtr, _\n    ByVal ncode As LongPtr, ByVal wParam As LongPtr, lParam As Any) As LongPtr\n\nPrivate Declare PtrSafe Function GetModuleHandle Lib \"kernel32\" Alias \"GetModuleHandleA\" (ByVal lpModuleName As String) As LongPtr\n\nPrivate Declare PtrSafe Function SetWindowsHookEx Lib \"user32\" Alias \"SetWindowsHookExA\" _\n    (ByVal idHook As LongPtr, ByVal lpfn As LongPtr, ByVal hmod As LongPtr, ByVal dwThreadId As LongPtr) As LongPtr\n\nPrivate Declare PtrSafe Function UnhookWindowsHookEx Lib \"user32\" (ByVal hHook As LongPtr) As LongPtr\n\nPrivate Declare PtrSafe Function SendDlgItemMessage Lib \"user32\" Alias \"SendDlgItemMessageA\" _\n(ByVal hDlg As LongPtr, ByVal nIDDlgItem As LongPtr, ByVal wMsg As LongPtr, ByVal wParam As LongPtr, ByVal lParam As LongPtr) As LongPtr\n\nPrivate Declare PtrSafe Function GetClassName Lib \"user32\" Alias \"GetClassNameA\" (ByVal hwnd As LongPtr, _\nByVal lpClassName As String, ByVal nMaxCount As LongPtr) As LongPtr\n\nPrivate Declare PtrSafe Function GetCurrentThreadId Lib \"kernel32\" () As LongPtr\n\n'Constants to be used in our API functions\nPrivate Const EM_SETPASSWORDCHAR = &amp;HCC\nPrivate Const WH_CBT = 5\nPrivate Const HCBT_ACTIVATE = 5\nPrivate Const HC_ACTION = 0\n\nPrivate hHook As LongPtr\n\n\nPublic Function NewProc(ByVal lngCode As LongPtr, ByVal wParam As LongPtr, ByVal lParam As LongPtr) As LongPtr\n    Dim RetVal\n    Dim strClassName As String, lngBuffer As LongPtr\n\n    If lngCode &lt; HC_ACTION Then\n        NewProc = CallNextHookEx(hHook, lngCode, wParam, lParam)\n        Exit Function\n    End If\n\n    strClassName = String$(256, \" \")\n    lngBuffer = 255\n\n    If lngCode = HCBT_ACTIVATE Then    'A window has been activated\n        RetVal = GetClassName(wParam, strClassName, lngBuffer)\n        If Left$(strClassName, RetVal) = \"#32770\" Then  'Class name of the Inputbox\n            'This changes the edit control so that it display the password character *.\n            'You can change the Asc(\"*\") as you please.\n            SendDlgItemMessage wParam, &amp;H1324, EM_SETPASSWORDCHAR, Asc(\"\u2022\"), &amp;H0\n        End If\n    End If\n\n    'This line will ensure that any other hooks that may be in place are\n    'called correctly.\n    CallNextHookEx hHook, lngCode, wParam, lParam\nEnd Function\n\nPublic Function InputBoxDK(Prompt, Title) As String\n    Dim lngModHwnd As LongPtr, lngThreadID As LongPtr\n\n    lngThreadID = GetCurrentThreadId\n    lngModHwnd = GetModuleHandle(vbNullString)\n\n    hHook = SetWindowsHookEx(WH_CBT, AddressOf NewProc, lngModHwnd, lngThreadID)\n\n    InputBoxDK = InputBox(Prompt, Title)\n    UnhookWindowsHookEx hHook\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 78, "user_id": 5161700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c0b5297e87ce8b033d1994e3569f194?s=128&d=identicon&r=PG", "display_name": "Barbara From Boston", "link": "https://stackoverflow.com/users/5161700/barbara-from-boston"}, "is_accepted": false, "score": 1, "last_activity_date": 1605298948, "creation_date": 1605298948, "answer_id": 64827566, "question_id": 28189864, "link": "https://stackoverflow.com/questions/28189864/excel-vba-input-box/64827566#64827566", "title": "Excel VBA Input box", "body": "<p>Thank you to <a href=\"https://stackoverflow.com/users/4847565/bhanu-pratap\">Bhanu Pratap</a> for providing Daniel Klann's implementation of changing the built-in InputBox on the fly to mask the characters for use in password prompts. Adding this module to the project and calling PasswordInputBox is way easier than adding a new form.</p>\n<p>Thank you to <a href=\"https://stackoverflow.com/users/12807206/joseph316\">Joseph316</a> for updating the code to 64-bit so it works in Office 365 Excel (version 16)!</p>\n<p>I took the Daniel &amp; Joseph code, renamed some variables and added some comments to make it easier to understand what the code is doing. There is no functional difference.</p>\n<pre><code>Option Explicit\n\n'////////////////////////////////////////////////////////////////////\n'Password masked inputbox\n'Allows you to hide characters entered in a VBA Inputbox.\n'\n'Code written by Daniel Klann\n'March 2003\n'\n'Code updated by Joseph for Excel 64-bit Environments\n'February 2020\n'PtrSafe added &amp; Long to PtrLong conversion\n'see https://social.msdn.microsoft.com/Forums/office/en-US/c414ef6d-fa9a-406c-9644-e479e7e72d0b/addressof-function-data-type-mismatch?forum=accessdev\n'\n' Code names and comments updated by Barbara Bazemore Kiszka for clarity\n' November 2020\n'////////////////////////////////////////////////////////////////////\n\n'API functions to be used\nPrivate Declare PtrSafe Function CallNextHookEx Lib &quot;user32&quot; (ByVal hHook As LongPtr, _\nByVal ncode As LongPtr, ByVal wParam As LongPtr, lParam As Any) As LongPtr\n\nPrivate Declare PtrSafe Function GetModuleHandle Lib &quot;kernel32&quot; Alias &quot;GetModuleHandleA&quot; (ByVal lpModuleName As String) As LongPtr\n\nPrivate Declare PtrSafe Function SetWindowsHookEx Lib &quot;user32&quot; Alias &quot;SetWindowsHookExA&quot; _\n(ByVal idHook As LongPtr, ByVal lpfn As LongPtr, ByVal hmod As LongPtr, ByVal dwThreadId As LongPtr) As LongPtr\n\nPrivate Declare PtrSafe Function UnhookWindowsHookEx Lib &quot;user32&quot; (ByVal hHook As LongPtr) As LongPtr\n\nPrivate Declare PtrSafe Function SendDlgItemMessage Lib &quot;user32&quot; Alias &quot;SendDlgItemMessageA&quot; _\n(ByVal hDlg As LongPtr, ByVal nIDDlgItem As LongPtr, ByVal wMsg As LongPtr, ByVal wParam As LongPtr, ByVal lParam As LongPtr) As LongPtr\n\nPrivate Declare PtrSafe Function GetClassName Lib &quot;user32&quot; Alias &quot;GetClassNameA&quot; (ByVal hwnd As LongPtr, _\nByVal lpClassName As String, ByVal nMaxCount As LongPtr) As LongPtr\n\nPrivate Declare PtrSafe Function GetCurrentThreadId Lib &quot;kernel32&quot; () As LongPtr\n\n' Constants to be used in our API functions\nPrivate Const EM_SETPASSWORDCHAR = &amp;HCC\nPrivate Const WH_CBT = 5\nPrivate Const HCBT_ACTIVATE = 5\nPrivate Const HC_ACTION = 0\n\nPrivate hMaskedInputHook As LongPtr\n\n' This is a helper function. You probably don't want to call this directly.\nPublic Function AddMaskToInputBox(ByVal lngCode As LongPtr, ByVal wParam As LongPtr, ByVal lParam As LongPtr) As LongPtr\n    Dim RetVal\n    Dim strClassName As String, lngBuffer As LongPtr\n    \n    ' If we are not active, skip this step\n    If lngCode &lt; HC_ACTION Then\n        AddMaskToInputBox = CallNextHookEx(hMaskedInputHook, lngCode, wParam, lParam)\n        Exit Function\n    End If\n    \n    ' Initialize the string where we are going to check for the InputBox class\n    strClassName = String$(256, &quot; &quot;)\n    lngBuffer = 255\n    \n    If lngCode = HCBT_ACTIVATE Then        'A window has been activated\n        RetVal = GetClassName(wParam, strClassName, lngBuffer)\n        \n        ' Check to see if this is the InputBox window\n        If Left$(strClassName, RetVal) = &quot;#32770&quot; Then\n            ' This changes the edit control so that it displays the password character *.\n            ' You can change the Asc(&quot;*&quot;) as you please.\n            SendDlgItemMessage wParam, &amp;H1324, EM_SETPASSWORDCHAR, Asc(&quot;\u2022&quot;), &amp;H0\n        End If\n    End If\n    \n    'This line will ensure that any other hooks that may be in place are\n    'called correctly.\n    CallNextHookEx hMaskedInputHook, lngCode, wParam, lParam\nEnd Function\n\n' Call this function to display Password prompt dialog\nPublic Function PasswordInputBox(Prompt, Title) As String\n    Dim lngModHwnd  As LongPtr, lngThreadID As LongPtr\n    \n    ' Set up a Windows hook so the the masked chars are set up the next time we display an InputBox\n    lngThreadID = GetCurrentThreadId\n    lngModHwnd = GetModuleHandle(vbNullString)\n    \n    hMaskedInputHook = SetWindowsHookEx(WH_CBT, AddressOf AddMaskToInputBox, lngModHwnd, lngThreadID)\n    \n    ' Prompt the user for the password, masking the input characters\n    PasswordInputBox = InputBox(Prompt, Title)\n    \n    ' Go back to normal InputBox behavior\n    UnhookWindowsHookEx hMaskedInputHook\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 3468458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/698368a8189b9060987f7d29a27380b4?s=128&d=identicon&r=PG&f=1", "display_name": "Hewage", "link": "https://stackoverflow.com/users/3468458/hewage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32736, "favorite_count": 3, "accepted_answer_id": 28195548, "answer_count": 5, "score": 9, "last_activity_date": 1605298948, "creation_date": 1422440870, "last_edit_date": 1531161705, "question_id": 28189864, "link": "https://stackoverflow.com/questions/28189864/excel-vba-input-box", "title": "Excel VBA Input box", "body": "<p>I have following Input box for excel file. I don't want to show typing characters and need to show input box characters * , how to do this? </p>\n\n<pre><code>Private Sub Workbook_Open()\n\nDim UserName As String\n\nUserName = InputBox(\"Please Enter Your USER NAME.\")\n\nRange(\"O1\") = UCase(UserName)\n\n\nEnd Sub\n</code></pre>\n\n<p>Thanks, \nHewage</p>\n"}, {"tags": ["vba", "excel", "foreach"], "answers": [{"comments": [{"owner": {"reputation": 979, "user_id": 3136924, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/1232991106/picture?type=large", "display_name": "Alexander Starbuck", "link": "https://stackoverflow.com/users/3136924/alexander-starbuck"}, "edited": false, "score": 0, "creation_date": 1422439363, "post_id": 28189239, "comment_id": 44746661, "body": "Awesome, it works! Does this need the &quot;looping through Sheets&quot; part or can I omit it (&quot;Next Ws&quot; part)?"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 0, "last_activity_date": 1422438996, "creation_date": 1422438996, "answer_id": 28189239, "question_id": 28189186, "link": "https://stackoverflow.com/questions/28189186/excel-vb-foreach-loop-inside-foreach-loop-loop-through-sheets-delete-empty-r/28189239#28189239", "title": "Excel VB - Foreach loop inside Foreach loop (loop through Sheets, delete empty rows)", "body": "<p>Replace <code>ActiveSheet.ChartObjects</code> with <code>ws.ChartObjects</code> in the nested loop.</p>\n\n<p>You're currently only removing charts on the <code>ActiveSheet</code>.</p>\n"}], "owner": {"reputation": 979, "user_id": 3136924, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/1232991106/picture?type=large", "display_name": "Alexander Starbuck", "link": "https://stackoverflow.com/users/3136924/alexander-starbuck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 255, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1422445445, "creation_date": 1422438863, "last_edit_date": 1422445445, "question_id": 28189186, "link": "https://stackoverflow.com/questions/28189186/excel-vb-foreach-loop-inside-foreach-loop-loop-through-sheets-delete-empty-r", "title": "Excel VB - Foreach loop inside Foreach loop (loop through Sheets, delete empty rows)", "body": "<p>I am quite new to VB and have a probably simple problem - I need to go through all the sheets in a workbook and delete all the charts (scattered around), select last row which has data, move backwards and delete empty rows. I tried something I assembled from StackOverflow and even from MS site but nothing seems to work.</p>\n\n<pre><code>Sub DeleteChartsRowsAllSheets()\nDim Ws As Worksheet, chtObj As ChartObject, i As Long\n\n    For Each Ws In ThisWorkbook.Worksheets\n\n            For Each chtObj In Ws.ChartObjects\n            chtObj.Delete\n\n            Next\n        'We turn off calculation and screenupdating to speed up the macro.\n        With Application\n\n        'Turn off screen updating and calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n\n            For i = Selection.Rows.Count To 1 Step -1\n\n                If WorksheetFunction.CountA(Selection.Rows(i)) = 0 Then\n                    Selection.Rows(i).EntireRow.Delete\n                End If\n\n            Next i\n\n        'Turn screen updating and calculation back on\n        .Calculation = xlCalculationAutomatic\n        .ScreenUpdating = True\n\n        End With\n\n    Next Ws\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Any tips? :)</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 13325, "user_id": 2641576, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/K9yqy.png?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/2641576/matt"}, "is_accepted": true, "score": 1, "last_activity_date": 1422439996, "creation_date": 1422439996, "answer_id": 28189557, "question_id": 28188993, "link": "https://stackoverflow.com/questions/28188993/excel-macro-not-outputting-save-as-file-method-saveas-of-object-workbook/28189557#28189557", "title": "Excel Macro not outputting (save as) file &quot;Method &#39;SaveAs&#39; of object &#39;_Workbook&#39; failed&quot;", "body": "<p><code>pathname</code> wasn't defined correctly in the tab so it was trying to save the document in a location that doesn't exist.</p>\n"}], "owner": {"reputation": 13325, "user_id": 2641576, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/K9yqy.png?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/2641576/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 585, "favorite_count": 0, "accepted_answer_id": 28189557, "answer_count": 1, "score": 0, "last_activity_date": 1422894103, "creation_date": 1422438326, "last_edit_date": 1422894103, "question_id": 28188993, "link": "https://stackoverflow.com/questions/28188993/excel-macro-not-outputting-save-as-file-method-saveas-of-object-workbook", "title": "Excel Macro not outputting (save as) file &quot;Method &#39;SaveAs&#39; of object &#39;_Workbook&#39; failed&quot;", "body": "<p>I have a small macro that outputs the information from a tab, however it is not saving the outputted text file. when it runs the debug it highlights a line but i cant see anything wrong with it.</p>\n\n<p><strong>This is the error line in debug:</strong></p>\n\n<pre><code>ActiveWorkbook.SaveAs Filename:=pathname, FileFormat:= _\n    xlTextMSDOS, CreateBackup:=False\n</code></pre>\n\n<p><strong>The Error Message:</strong></p>\n\n<blockquote>\n  <p>Method 'SaveAs' of object '_Workbook' failed</p>\n</blockquote>\n\n<p><strong>This is the whole code</strong></p>\n\n<pre><code>Sub Savetxt(pathname, sheetname)\n    Sheets(\"Output\").Range(\"A1:Z99999\").ClearContents\n    Sheets(sheetname).Select\n    Range(ActiveSheet.ListObjects(1) &amp; \"[Final output for text file]\").Copy\n    Sheets(\"Output\").Select\n    Range(\"A1\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    'Rows(\"1:1\").Select\n    'Application.CutCopyMode = False\n    'Selection.Delete Shift:=xlUp\n    BName = ActiveWorkbook.FullName\n    ActiveWorkbook.VBProject.VBComponents(\"module1\").Export (\"' &amp; BName.Value &amp;'\")\n    Sheets(Array(\"Output\")).Copy\n\n    Application.VBE.ActiveVBProject.VBComponents.Import (\"' &amp; BName.Value &amp;'\")\n ActiveWorkbook.SaveAs Filename:=pathname, FileFormat:= _\n        xlTextMSDOS, CreateBackup:=False\n\n    ' ActiveWorkbook.SaveAs Filename:=Range(\"savefile\").Value _\n        , FileFormat:=xlTextMSDOS, CreateBackup:=False\n'\n    ActiveWindow.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "loops", "excel", "filesystemobject"], "comments": [{"owner": {"reputation": 20573, "user_id": 1280587, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/j4XVS.png?s=128&g=1", "display_name": "paul", "link": "https://stackoverflow.com/users/1280587/paul"}, "edited": false, "score": 0, "creation_date": 1422438460, "post_id": 28188890, "comment_id": 44746093, "body": "This might help: <a href=\"http://stackoverflow.com/questions/22645347/loop-through-all-subfolders-using-vba\" title=\"loop through all subfolders using vba\">stackoverflow.com/questions/22645347/&hellip;</a>"}, {"owner": {"reputation": 2382, "user_id": 1682881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pqUuG.jpg?s=128&g=1", "display_name": "Flakes", "link": "https://stackoverflow.com/users/1682881/flakes"}, "edited": false, "score": 3, "creation_date": 1422438482, "post_id": 28188890, "comment_id": 44746103, "body": "should <code>Call ListMyFiles(mySource.Path, True)</code> be <code>Call ListMyFiles(mySubFolder.Path, True)</code>  for the subfolders"}, {"owner": {"reputation": 113, "user_id": 4502246, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3d3cd410d8e0544df8ab72877e1b5c47?s=128&d=identicon&r=PG", "display_name": "Kurisuchin", "link": "https://stackoverflow.com/users/4502246/kurisuchin"}, "edited": false, "score": 1, "creation_date": 1422439007, "post_id": 28188890, "comment_id": 44746429, "body": "Oh. Oh right! It worked. I didn&#39;t notice that one. Forever looping stopped. Thanks."}, {"owner": {"reputation": 1551, "user_id": 150533, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0540c6f40ab8933535bbf2cf2a80cb9d?s=128&d=identicon&r=PG", "display_name": "kurast", "link": "https://stackoverflow.com/users/150533/kurast"}, "reply_to_user": {"reputation": 2382, "user_id": 1682881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pqUuG.jpg?s=128&g=1", "display_name": "Flakes", "link": "https://stackoverflow.com/users/1682881/flakes"}, "edited": false, "score": 0, "creation_date": 1422441511, "post_id": 28188890, "comment_id": 44747928, "body": "@SearchAndResQ Put this as an answer, not as a comment."}], "answers": [{"tags": [], "owner": {"reputation": 2382, "user_id": 1682881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pqUuG.jpg?s=128&g=1", "display_name": "Flakes", "link": "https://stackoverflow.com/users/1682881/flakes"}, "is_accepted": true, "score": 0, "last_activity_date": 1422442197, "creation_date": 1422442197, "answer_id": 28190314, "question_id": 28188890, "link": "https://stackoverflow.com/questions/28188890/stuck-in-a-loop-directory-listing-using-excel-vba/28190314#28190314", "title": "Stuck in a Loop. Directory Listing using Excel VBA", "body": "<p>The path value that is being passed to the function for the sub folder listing is wrong.</p>\n\n<p>It should be:</p>\n\n<p><code>Call ListMyFiles(mySubFolder.Path, True)</code></p>\n"}], "owner": {"reputation": 113, "user_id": 4502246, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3d3cd410d8e0544df8ab72877e1b5c47?s=128&d=identicon&r=PG", "display_name": "Kurisuchin", "link": "https://stackoverflow.com/users/4502246/kurisuchin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 28190314, "answer_count": 1, "score": 0, "last_activity_date": 1422442197, "creation_date": 1422438007, "question_id": 28188890, "link": "https://stackoverflow.com/questions/28188890/stuck-in-a-loop-directory-listing-using-excel-vba", "title": "Stuck in a Loop. Directory Listing using Excel VBA", "body": "<p>I'm trying to make a directory listing of my drive here with the directories, subdirectories/folders, and files included. It also shows the file name, file path, date, and size. \nI'm currently using this code:</p>\n\n<pre><code>Dim iRow\n\nSub ListFiles()\n    iRow = 11 'starting row listing\n    Call ListMyFiles(Range(\"B5\"), Range(\"B6\"))\nEnd Sub\n\nSub ListMyFiles(mySourcePath, IncludeSubfolders)\n    Set MyObject = New Scripting.FileSystemObject\n    Set mySource = MyObject.GetFolder(mySourcePath)\n        On Error Resume Next\n        For Each myFile In mySource.Files\n        iCol = 3\n        Cells(iRow, iCol).Value = myFile.Path\n        iCol = iCol + 1\n        Cells(iRow, iCol).Value = myFile.Name\n        iCol = iCol + 1\n        Cells(iRow, iCol).Value = myFile.Size\n        iCol = iCol + 1\n        Cells(iRow, iCol).Value = myFile.DateLastModified\n        iRow = iRow + 1\n    Next\n    If IncludeSubfolders Then\n        For Each mySubFolder In mySource.SubFolders\n            Call ListMyFiles(mySource.Path, True)\n        Next\n    End If\nEnd Sub\n</code></pre>\n\n<p>Whenever I input an address it works fine, but when I decide to include the subfolders, it goes into haywire! It just loops on and on forever. It just does not stop.\nI don't know where to look for the error. I keep on rereading it and it seems okay, but maybe that's just me. Also, I ticked the Microsoft Scripting Runtime, for the record.\nAnd also, I think I still lack something here because I also wanted to show the Folder Names as well, if that is possible.</p>\n\n<p>This question may not be clear or may be already duplicated, so let me know. Thank you!</p>\n\n<p>P.S.\nKind of a newbie here. </p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1422439564, "post_id": 28188841, "comment_id": 44746781, "body": "If Not StopMacro Then Application.OnTime Now + TimeValue(&quot;00:00:15&quot;), &quot;timestamp&quot;     End If"}, {"owner": {"reputation": 11, "user_id": 4502267, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-up3DQ6SYQKI/AAAAAAAAAAI/AAAAAAAAAHU/Phd1vzKy-1E/photo.jpg?sz=128", "display_name": "Eivind Sageng", "link": "https://stackoverflow.com/users/4502267/eivind-sageng"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1422442103, "post_id": 28188841, "comment_id": 44748250, "body": "Thanks for input. Not sure how to put it in and what to include. I get &quot;End if without block if&quot; error."}, {"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1422446094, "post_id": 28188841, "comment_id": 44750456, "body": "There is a difference between pausing or stopping? Which one do you want?"}], "answers": [{"tags": [], "owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "is_accepted": false, "score": 0, "last_activity_date": 1422448209, "creation_date": 1422448209, "answer_id": 28192313, "question_id": 28188841, "link": "https://stackoverflow.com/questions/28188841/how-to-stop-a-macro-by-clicking-a-command-button/28192313#28192313", "title": "How to stop a macro by clicking a command button?", "body": "<pre><code>Public StopMacro As Boolean\n\nSub SetStopMacro()\n    StopMacro = True\nEnd Sub\n\nSub timestamp()\n    '\n    ' timestamp Macro\n    '\n    ' code here\n    '\n    ' Put If-Then before Application.OnTime call. \n    ' So prevent next call of 'timestamp()' if StopMacro equals to true\n    If Not StopMacro Then\n        Application.OnTime Now + TimeValue(\"00:00:15\"), \"timestamp\"\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5994715, "user_type": "registered", "profile_image": "https://graph.facebook.com/1113075258734987/picture?type=large", "display_name": "Alejandro Gizzi", "link": "https://stackoverflow.com/users/5994715/alejandro-gizzi"}, "is_accepted": false, "score": 0, "last_activity_date": 1478017216, "last_edit_date": 1478017216, "creation_date": 1478012642, "answer_id": 40362781, "question_id": 28188841, "link": "https://stackoverflow.com/questions/28188841/how-to-stop-a-macro-by-clicking-a-command-button/40362781#40362781", "title": "How to stop a macro by clicking a command button?", "body": "<p>You can declare a global variable inside the module where the macro is running from, and then, when the command button is clicked, assign a value to that variable you just declared.  Then, create an if statement, where the code exits if the variable equals to that value.</p>\n\n<pre><code>Private Sub CommandButton2_Click()   \nbtncancel = 1\nEMSetup.hide\nExit Sub\nEnd Sub\n</code></pre>\n\n<p>For the command button.</p>\n\n<pre><code>Global btncancel As Integer\nIf btncancel = 1 Then\n  Exit Sub\nEnd If\n</code></pre>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 11, "user_id": 4502267, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-up3DQ6SYQKI/AAAAAAAAAAI/AAAAAAAAAHU/Phd1vzKy-1E/photo.jpg?sz=128", "display_name": "Eivind Sageng", "link": "https://stackoverflow.com/users/4502267/eivind-sageng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 12680, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1615813300, "creation_date": 1422437874, "last_edit_date": 1584215589, "question_id": 28188841, "link": "https://stackoverflow.com/questions/28188841/how-to-stop-a-macro-by-clicking-a-command-button", "title": "How to stop a macro by clicking a command button?", "body": "<p>I have a code to copy a range and paste the values.</p>\n\n<p>This is done in a time interval after I click a command button.</p>\n\n<p>How do I stop or pause this macro by clicking a button?</p>\n\n<p>Here is the main code:</p>\n\n<pre><code>Sub timestamp()\n'\n' timestamp Macro\n'   \n    N = WorksheetFunction.Count(Sheets(\"DNB\").Columns(1))   \n\n    dnbspread = Sheets(\"DNB\").Range(\"G5:G30\")\n\n    Sheets(\"DNB\").Cells(N + 34, 1) = Date\n    Sheets(\"DNB\").Cells(N + 34, 2) = Time\n    Sheets(\"DNB\").Range(\"G5:G30\").Copy\n\n    Sheets(\"DNB\").Cells(N + 34, 3).PasteSpecial Transpose:=True, Paste:=xlPasteValues\n\n    Application.OnTime Now + TimeValue(\"00:00:05\"), \"timestamp\"\n\nEnd Sub\n</code></pre>\n\n<p>I tried a couple of things.</p>\n\n<blockquote>\n  <ol>\n  <li>by BREAK function</li>\n  </ol>\n</blockquote>\n\n<pre><code>Sub PauseMacro()\n    Application.SendKeys \"^{BREAK}\"\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>2.</p>\n</blockquote>\n\n<pre><code>Public StopMacro as Boolean\nSub SetStopMacro()\n    StopMacro = True\nEnd Sub\n</code></pre>\n\n<p>and put it in the code as this:</p>\n\n<pre><code>Sub timestamp()\n'\n\n' timestamp Macro\n\n'\n    N = WorksheetFunction.Count(Sheets(\"DNB\").Columns(1))\n\n    dnbspread = Sheets(\"DNB\").Range(\"G5:G30\")\n\n    Sheets(\"DNB\").Cells(N + 34, 1) = Date\n\n    Sheets(\"DNB\").Cells(N + 34, 2) = Time\n\n    Sheets(\"DNB\").Range(\"G5:G30\").Copy\n\n    Sheets(\"DNB\").Cells(N + 34, 3).PasteSpecial Transpose:=True, Paste:=xlPasteValues\n\n    Application.OnTime Now + TimeValue(\"00:00:10\"), \"timestamp\"\n\n    DoEvents\n\n    If StopMacro = True Then Exit Sub\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "vbscript"], "comments": [{"owner": {"reputation": 47259, "user_id": 109702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1206798ebe0afcb9cb722ef597573853?s=128&d=identicon&r=PG&f=1", "display_name": "slugster", "link": "https://stackoverflow.com/users/109702/slugster"}, "edited": false, "score": 1, "creation_date": 1422437371, "post_id": 28188461, "comment_id": 44745485, "body": "Have you investigated using WMI to iterate the mapped drives and to connect the one you want? It shouldn&#39;t matter if the share that is mapped changes because you should be able to read that information and use it (the info is available, just Windows hasn&#39;t connected it yet)."}, {"owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "reply_to_user": {"reputation": 47259, "user_id": 109702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1206798ebe0afcb9cb722ef597573853?s=128&d=identicon&r=PG&f=1", "display_name": "slugster", "link": "https://stackoverflow.com/users/109702/slugster"}, "edited": false, "score": 0, "creation_date": 1422437437, "post_id": 28188461, "comment_id": 44745520, "body": "Can you tell me how to do that?"}, {"owner": {"reputation": 47259, "user_id": 109702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1206798ebe0afcb9cb722ef597573853?s=128&d=identicon&r=PG&f=1", "display_name": "slugster", "link": "https://stackoverflow.com/users/109702/slugster"}, "edited": false, "score": 1, "creation_date": 1422438189, "post_id": 28188461, "comment_id": 44745946, "body": "<a href=\"http://stackoverflow.com/a/8993155/109702\">This previous answer</a> should help set you on your way. I think your better option would be to enumerate and find the correct mapped drive, then just determine its UNC path and use the UNC path directly - that way you don&#39;t have to reconnect the mapped drive."}, {"owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "reply_to_user": {"reputation": 47259, "user_id": 109702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1206798ebe0afcb9cb722ef597573853?s=128&d=identicon&r=PG&f=1", "display_name": "slugster", "link": "https://stackoverflow.com/users/109702/slugster"}, "edited": false, "score": 0, "creation_date": 1422442274, "post_id": 28188461, "comment_id": 44748336, "body": "I&#39;ll check it out. Thanks for your help."}], "answers": [{"tags": [], "owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "is_accepted": true, "score": 1, "last_activity_date": 1422445700, "last_edit_date": 1490005103, "creation_date": 1422445700, "answer_id": 28191529, "question_id": 28188461, "link": "https://stackoverflow.com/questions/28188461/disconnected-network-drive-in-my-computer/28191529#28191529", "title": "&quot;Disconnected Network Drive&quot; in My Computer", "body": "<p>Slugster's suggestion to get the mapped UNC value is a good one. Here is my solution as adapted from <a href=\"https://superuser.com/questions/27047/copy-full-file-path-in-windows-xp/704374#704374\">this answer</a> This works for VBScript and VBA.</p>\n\n<pre><code>Sub testget()\n    Debug.Print getUNC(\"F:\\T\\\")\nEnd Sub\n\nFunction getUNC(dir)\n\n    Dim fso: Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Dim sDrive: sDrive = fso.GetDriveName(dir)\n    Set fso = Nothing\n\n    Dim sMap: sMap = GetMappedDrive(sDrive)\n    If sMap &lt;&gt; \"\" And sDrive &lt;&gt; sMap Then\n        getUNC = Replace(dir, sDrive, sMap)\n    Else\n        getUNC = dir\n    End If\n\nEnd Function\n\nFunction GetMappedDrive(sDrive)\n    Dim wshNetwork: Set wshNetwork = CreateObject(\"WScript.Network\")\n    Dim oDrives: Set oDrives = wshNetwork.EnumNetworkDrives\n    Dim i\n    For i = 0 To oDrives.Count - 1 Step 2\n        If UCase(oDrives.Item(i)) = UCase(sDrive) Then\n            GetMappedDrive = oDrives.Item(i + 1)\n            Exit For\n        End If\n    Next\n    Set oDrives = Nothing\n    Set wshNetwork = Nothing\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1819, "favorite_count": 1, "accepted_answer_id": 28191529, "answer_count": 1, "score": 1, "last_activity_date": 1487141864, "creation_date": 1422436639, "last_edit_date": 1531164843, "question_id": 28188461, "link": "https://stackoverflow.com/questions/28188461/disconnected-network-drive-in-my-computer", "title": "&quot;Disconnected Network Drive&quot; in My Computer", "body": "<p>We use VPN to connect to the work network. I have a mapped network drive that shows \"Disconnected Network Drive\" in My Computer immediately after I connect. While in this state I run a VBA routine:</p>\n\n<pre><code>Dim dr As String: dr = \"F:\\T\\\"\nDim fso: Set fso = CreateObject(\"Scripting.FileSystemObject\")\nIf Not fso.FolderExists(dr) Then\n    Call fso.CreateFolder(dr)\nEnd If\n</code></pre>\n\n<p>Even though the folder actually does exist, fso thinks it doesn't so it tries to create the folder and throws an error: Run-time error 76: Path not found. Of course it can't find it because it is in a disconnected state. Any other operations using that network drive will fail too.</p>\n\n<p>So I open My Computer and manually double-click the network drive. It connects just fine and I no longer get the error when running the code again. But this is problematic. I need a solution in the code to automatically connect the network drive.</p>\n\n<p><strong>Possible solution 1:</strong> Just use the UNC path instead of mapped drive letter. The problem with that is that I don't know what the path is. Nor do I want to use UNC; the code needs to be flexible to work with wherever the drive maps to. It's policy from the brass.</p>\n\n<p><strong>Possible solution 2:</strong> Re-map the network drive using Net Use or WshNetwork. Again, this isn't really possible as I don't know what the UNC path is or will be.</p>\n\n<p><strong>Possible solution 3:</strong> <a href=\"https://stackoverflow.com/a/27574806/2559297\">Connect using ShellExecute</a> While this would work, it isn't really palatable as it opens a window to explore the folder (could use SW_HIDE to avoid showing the window, but then how would I close it?). Furthermore it doesn't connect instantly. I would need a delay of uncertain length to make this work. Not a good answer. <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb762153(v=vs.85).aspx\" rel=\"nofollow noreferrer\">MSDN ShellExecute Function</a></p>\n\n<p>So is there a better solution? How do I connect the drive while waiting for it to return and throwing an error if not able to connect?</p>\n\n<p>I need it to work for both VBScript and VBA.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1422435609, "post_id": 28188032, "comment_id": 44744518, "body": "Welcome to SO. This is not a code writing service. You will find that you will receive prompt and eager responses to your problem once you demonstrate some effort of having tried to resolve it by yourself."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4502023, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cI31jm5d2Lc/AAAAAAAAAAI/AAAAAAAAAcI/vgwtbvsQSCw/photo.jpg?sz=128", "display_name": "Mawz", "link": "https://stackoverflow.com/users/4502023/mawz"}, "edited": false, "score": 0, "creation_date": 1422531679, "post_id": 28188201, "comment_id": 44791184, "body": "I wanted to vote-up but I don&#39;t have the reputation!"}], "tags": [], "owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "is_accepted": true, "score": 0, "last_activity_date": 1422435767, "creation_date": 1422435767, "answer_id": 28188201, "question_id": 28188032, "link": "https://stackoverflow.com/questions/28188032/vba-how-to-copy-part-of-the-string-from-one-cell-and-replace-part-of-another-ce/28188201#28188201", "title": "VBA: How to copy part of the string from one cell and replace part of another cell with it?", "body": "<p>This code iterates column <code>a</code> (<code>col</code>=1) and when it finds a '[tab]' it sets the <code>sctn</code> variable to the value of the cell (ignoring the '[tab]')</p>\n\n<p>When it finds a '*', it replaces it with the content of the <code>sctn</code> variable</p>\n\n<pre><code>Dim row as Integer,col as Integer,sctn as String\ncol=1\nrow=1\nWhile Cells(row,col)&lt;&gt;\"\"\n  If Instr(Cells(row,col),\"[tab]\")&gt;0 Then\n    sctn=Replace(Cells(row,col),\"[tab]\",\"\")\n    Cells(row,col)=sctn\n  Else\n    Cells(row,col)=Replace(Cells(row,col),\"*\",sctn)\n  End If\n  row=row+1\nWend\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4502023, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cI31jm5d2Lc/AAAAAAAAAAI/AAAAAAAAAcI/vgwtbvsQSCw/photo.jpg?sz=128", "display_name": "Mawz", "link": "https://stackoverflow.com/users/4502023/mawz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2152, "favorite_count": 0, "accepted_answer_id": 28188201, "answer_count": 1, "score": 0, "last_activity_date": 1422436684, "creation_date": 1422435128, "last_edit_date": 1422436684, "question_id": 28188032, "link": "https://stackoverflow.com/questions/28188032/vba-how-to-copy-part-of-the-string-from-one-cell-and-replace-part-of-another-ce", "title": "VBA: How to copy part of the string from one cell and replace part of another cell with it?", "body": "<p>The text in excel I have looks like this:</p>\n\n<p>[tab]SECTION 01.<br>\n*Name of section 1<br>\nTEXT<br>\nTEXT<br>\nTEXT<br>\n[tab]SECTION 2.<br>\n*Name of section 2<br>\nTEXT<br>\n...<br></p>\n\n<p>I want to find next SECTION in column (1, 2, 3...), copy only string SECTION 01. (02., 03.,...,52.,...)and paste it in the cell below replacing only *.</p>\n\n<p>The end result in excel should look like this:</p>\n\n<p>SECTION 01. Name of section 1<br>\nTEXT<br>\nTEXT<br>\nTEXT<br>\nSECTION 02. Name of section 2<br>\nTEXT<br>\n...</p>\n\n<p>I tried to record macro, but it only copies the same text to only one cell specified, so I will have to rearrange VB code. Can anyone help?</p>\n\n<p>Thank you,</p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 2834, "user_id": 3230346, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Nc4ve.png?s=128&g=1", "display_name": "useR", "link": "https://stackoverflow.com/users/3230346/user"}, "edited": false, "score": 0, "creation_date": 1422434857, "post_id": 28187406, "comment_id": 44744134, "body": "Hi @ignotus, Thanks for your reply. I don&#39;t know how you use &quot;."}, {"owner": {"reputation": 659, "user_id": 2502511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c47afe6ea5176ebe6e6618776971351?s=128&d=identicon&r=PG", "display_name": "ignotus", "link": "https://stackoverflow.com/users/2502511/ignotus"}, "reply_to_user": {"reputation": 2834, "user_id": 3230346, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Nc4ve.png?s=128&g=1", "display_name": "useR", "link": "https://stackoverflow.com/users/3230346/user"}, "edited": false, "score": 0, "creation_date": 1422449522, "post_id": 28187406, "comment_id": 44752474, "body": "You have to put the path to chrome between quotes because it contains space character(s). You put escape a quote with another one, so in a string, you have to type &quot;&quot; to contain one quote. See more here: <a href=\"http://goo.gl/XgtMNH\" rel=\"nofollow noreferrer\">goo.gl/XgtMNH</a>"}, {"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1546877398, "post_id": 28187406, "comment_id": 94989078, "body": "@ignotus Nice once"}], "tags": [], "owner": {"reputation": 659, "user_id": 2502511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c47afe6ea5176ebe6e6618776971351?s=128&d=identicon&r=PG", "display_name": "ignotus", "link": "https://stackoverflow.com/users/2502511/ignotus"}, "is_accepted": true, "score": 2, "last_activity_date": 1422432505, "creation_date": 1422432505, "answer_id": 28187406, "question_id": 28186877, "link": "https://stackoverflow.com/questions/28186877/dynamic-url-to-browse-chrome-vba/28187406#28187406", "title": "dynamic url to browse chrome vba", "body": "<p>Here is a Subroutine to open a url in Chrome (either 32 or 64 bit version) or using the default browser if Chrome can not be found. I hope this helps.</p>\n\n<pre><code>Sub OpenInChromeOrDefaultBrowser(ByVal url As String)\n\n    Dim wholeContent As String\n    chrome = \"C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe\"\n\n    If Dir(chrome, vbNormal) &lt;&gt; \"\" Then\n        '' 32 bit Chrome\n        wholeContent = \"\"\"\" &amp; chrome &amp; \"\"\" -url \" &amp; url\n    Else\n        '' 64 bit Chrome\n        chrome = \"C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe\"\n        wholeContent = \"\"\"\" &amp; chrome &amp; \"\"\" -url \" &amp; url\n    End If\n\n    If Dir(chrome, vbNormal) &lt;&gt; \"\" Then\n        '' Chrome is found, execute\n        Shell wholeContent\n    Else\n        '' Chrome was not found, open url using the default program\n        Dim Sh As Object\n        Set Sh = CreateObject(\"WScript.Shell\")\n        Sh.Run url\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2834, "user_id": 3230346, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Nc4ve.png?s=128&g=1", "display_name": "useR", "link": "https://stackoverflow.com/users/3230346/user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 28187406, "answer_count": 1, "score": 0, "last_activity_date": 1422432505, "creation_date": 1422430287, "question_id": 28186877, "link": "https://stackoverflow.com/questions/28186877/dynamic-url-to-browse-chrome-vba", "title": "dynamic url to browse chrome vba", "body": "<p>According to [this link][1], @ray have use the following code to do browsing<br/></p>\n\n<pre><code>shell(\"C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe -url www.google.com\")\n</code></pre>\n\n<p>While i would like to use dynamic url</p>\n\n<pre><code>Dim url as string\nurl = \"www.google.com/translate\"\n\nDim wholeContent as String\nwholeContent =  \"\"C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe - url\"\" &amp; url\nShell(wholeContent)\n</code></pre>\n\n<p>next time maybe maps instead of translate.</p>\n"}, {"tags": ["vba", "excel", "excel-2010", "excel-2007"], "answers": [{"tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": true, "score": 2, "last_activity_date": 1422429062, "creation_date": 1422429062, "answer_id": 28186558, "question_id": 28186215, "link": "https://stackoverflow.com/questions/28186215/vba-resizing-2-identical-images-to-the-same-size-width-and-height/28186558#28186558", "title": "VBA Resizing 2 Identical Images to the same size (width and height)", "body": "<p>There is a property <code>.LockAspectRatio = msoTrue</code>setted per default for shapes which contains images. This causes your described behavior.</p>\n\n<p>To avoid this you could switch this to <code>msoFalse</code>, then change <code>.Height</code> and <code>.Width</code> and the switch it to <code>msoTrue</code> again:</p>\n\n<pre><code>Sub picture_size()\n   ActiveSheet.Shapes.Range(Array(\"Picture 2\")).LockAspectRatio = msoFalse\n\n   ActiveSheet.Shapes.Range(Array(\"Picture 2\")).Width = ActiveSheet.Shapes.Range(Array(\"Picture 1\")).Width\n   ActiveSheet.Shapes.Range(Array(\"Picture 2\")).Height = ActiveSheet.Shapes.Range(Array(\"Picture 1\")).Height\n\n   ActiveSheet.Shapes.Range(Array(\"Picture 2\")).LockAspectRatio = msoTrue\nEnd Sub\n</code></pre>\n\n<p>But if the goal is only to restore the original size, then:</p>\n\n<pre><code>Sub picture_100Percent()\n   ActiveSheet.Shapes.Range(Array(\"Picture 2\")).ScaleHeight 1, msoTrue\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 4339, "user_id": 2487602, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/n8AjK.jpg?s=128&g=1", "display_name": "Ryflex", "link": "https://stackoverflow.com/users/2487602/ryflex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 827, "favorite_count": 0, "accepted_answer_id": 28186558, "answer_count": 1, "score": 1, "last_activity_date": 1422429062, "creation_date": 1422427528, "last_edit_date": 1610973576, "question_id": 28186215, "link": "https://stackoverflow.com/questions/28186215/vba-resizing-2-identical-images-to-the-same-size-width-and-height", "title": "VBA Resizing 2 Identical Images to the same size (width and height)", "body": "<p><strong>Step 1)</strong> Open Up Excel, Copy &quot;stackoverflow's logo into sheet: <a href=\"https://blog.stackoverflow.com/wp-content/uploads/stackoverflow-logo-300.png\">https://blog.stackoverflow.com/wp-content/uploads/stackoverflow-logo-300.png</a></p>\n<p><strong>Step 2)</strong> Copy and paste that logo twice</p>\n<p><strong>Step 3)</strong> Resize one of the logos manually to some ridiculous size: <a href=\"https://i.imgur.com/87lIB8o.png\" rel=\"nofollow noreferrer\">http://i.imgur.com/87lIB8o.png</a></p>\n<p>Now how can that nasty logo be resized via vba to the same size as original logo</p>\n<p>I tried the following macro (yes I tried using With / End With):</p>\n<pre><code>Sub sds()\n    ActiveSheet.Shapes.Range(Array(&quot;Picture 2&quot;)).Width = ActiveSheet.Shapes.Range(Array(&quot;Picture 1&quot;)).Width\n    ActiveSheet.Shapes.Range(Array(&quot;Picture 2&quot;)).Height = ActiveSheet.Shapes.Range(Array(&quot;Picture 1&quot;)).Height\nEnd Sub\n</code></pre>\n<p>It skewers it and it ends up looking like: <a href=\"https://i.imgur.com/e7BKq9y.png\" rel=\"nofollow noreferrer\">http://i.imgur.com/e7BKq9y.png</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 1, "creation_date": 1422423916, "post_id": 28185288, "comment_id": 44739644, "body": "Go through this post <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\"><i>avoid using select/activesheet</i></a> to improve your coding. I think that&#39;s the only problem you got."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4363194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/582eb5d81be049d11ccefa124eed702c?s=128&d=identicon&r=PG&f=1", "display_name": "Vidya Sahar", "link": "https://stackoverflow.com/users/4363194/vidya-sahar"}, "edited": false, "score": 0, "creation_date": 1422435199, "post_id": 28185452, "comment_id": 44744311, "body": "Thanks Jeeped. You saved me again."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1422423894, "last_edit_date": 1495535188, "creation_date": 1422423894, "answer_id": 28185452, "question_id": 28185288, "link": "https://stackoverflow.com/questions/28185288/how-to-copy-a-value-of-merged-cells-to-its-adjacent-cell/28185452#28185452", "title": "How to copy a value of merged cells to its adjacent cell?", "body": "<p>It is best to stay away from using <code>.Select</code> to deterine the cell or worksheet that you want to deal with.</p>\n\n<pre><code>Dim rcount As Long\nDim rw As Long\nDim cl As Long\nWith ActiveSheet\n    cl = 1\n    rw = 1\n    rcount = .Cells(Rows.Count, 1).End(xlUp).row\n    For rw = 1 To rcount\n        If .Cells(rw, cl).MergeCells Then\n            .Cells(rw, cl).Offset(1, 5) = .Cells(rw, cl).Value  '1 row down and 5 columns over ?\n            Exit For   'why exit here?\n        End If\n    Next rw\nEnd With\n</code></pre>\n\n<p>See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> for more methods on dealng with cells, cell ranges and worksheets directly.</p>\n"}], "owner": {"reputation": 11, "user_id": 4363194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/582eb5d81be049d11ccefa124eed702c?s=128&d=identicon&r=PG&f=1", "display_name": "Vidya Sahar", "link": "https://stackoverflow.com/users/4363194/vidya-sahar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 254, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1422424034, "creation_date": 1422423083, "last_edit_date": 1422424034, "question_id": 28185288, "link": "https://stackoverflow.com/questions/28185288/how-to-copy-a-value-of-merged-cells-to-its-adjacent-cell", "title": "How to copy a value of merged cells to its adjacent cell?", "body": "<p>I need to find a merged cell in the active sheet and copy the value to the adjacent cell. <br>\nI tried to write a macro below but this is not copying the cell value. I am getting <code>Error 424</code> in the line <code>ActiveSheet.Cells(row, col).Select</code></p>\n\n<p>Below is my table:</p>\n\n<pre><code>    A       B\n **Merged Cell1**   \n Value1         \n Value2         \n Value3         \n text4          \n text5          \n text6          \n text7          \n text8          \n **Merged Cell3**           \n Value1         \n Value2         \n **Merged Cell4**           \n text4          \n text5          \n text6          \n text1          \n **Merged Cell5**           \n text4          \n text5          \n **Merged Cell5**           \n text           \n</code></pre>\n\n<p>\u00a0</p>\n\n<pre><code>Sub TestMacro5()\n    Dim rcount As Integer\n    Dim row As Integer\n    Dim col As Integer\n    Dim i As Integer\n\n    ActiveSheet.Select\n    col = 1\n    row = 1\n    i = 1\n    rcount = Application.CountA(Range(\"A:A\"))\n\n    For i = 1 To rcount\n        ActiveSheet.Cells(row, col).Select\n        If Selection.MergeCells Then\n            ActiveCell.Offset(1, 5).Value = ActiveCell.Value\n            row = row + 1\n            Exit Sub\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1422428809, "post_id": 28184722, "comment_id": 44741493, "body": "BTW, what is the reason to keep this event? It doesn&#39;t make sense in this situation. Or is there some other code inside the Sub? Or the original idea was to do exactly what you are going to remove..."}, {"owner": {"reputation": 2052, "user_id": 285246, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a4f6c2e8a146f19f210a10e624f57164?s=128&d=identicon&r=PG", "display_name": "Tejas", "link": "https://stackoverflow.com/users/285246/tejas"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1422454770, "post_id": 28184722, "comment_id": 44755880, "body": "@KazJaw I am doing some checking on my document before the save event. So I really need to take control of that."}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1422472828, "post_id": 28184722, "comment_id": 44767391, "body": "I think you don&#39;t understand what I mean... so, this event code which you show in question, is it complete? Show the complete event code, please."}, {"owner": {"reputation": 2052, "user_id": 285246, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a4f6c2e8a146f19f210a10e624f57164?s=128&d=identicon&r=PG", "display_name": "Tejas", "link": "https://stackoverflow.com/users/285246/tejas"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1422532367, "post_id": 28184722, "comment_id": 44791647, "body": "@KazJaw Please check the full node now. Thnx"}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1422715321, "post_id": 28184722, "comment_id": 44864430, "body": "which office version do you have? Did you solve your problem?"}, {"owner": {"reputation": 2052, "user_id": 285246, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a4f6c2e8a146f19f210a10e624f57164?s=128&d=identicon&r=PG", "display_name": "Tejas", "link": "https://stackoverflow.com/users/285246/tejas"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1422715418, "post_id": 28184722, "comment_id": 44864458, "body": "@KazJaw I am using 2010 but I am facing this issue in all versions office."}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1422715857, "post_id": 28184722, "comment_id": 44864573, "body": "I can&#39;t repeat your problem on my Office 2013. In my opinion Autorecovery doesn&#39;t trigger the event <code>DocumentBeforeSave</code>. But it could be triggered by other macro, please check it."}], "owner": {"reputation": 2052, "user_id": 285246, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a4f6c2e8a146f19f210a10e624f57164?s=128&d=identicon&r=PG", "display_name": "Tejas", "link": "https://stackoverflow.com/users/285246/tejas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 345, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1422532341, "creation_date": 1422419935, "last_edit_date": 1422532341, "question_id": 28184722, "link": "https://stackoverflow.com/questions/28184722/word-vba-auto-recovery-calls-documentbeforesave-event", "title": "Word VBA - Auto Recovery calls DocumentBeforeSave event", "body": "<p>In Word VBA I have a call named Events with following code in it:</p>\n\n<pre><code>Public WithEvents EventSource As Word.Application\n\nPrivate Sub EventSource_DocumentBeforeSave(ByVal Doc As Document, SaveAsUI As Boolean, Cancel As Boolean)\nIf oScript.DocType = diDocTypeScript Then\n\n    WriteToTextLog \" SaveAsUI = \" &amp; CStr(SaveAsUI) &amp; \"Path= \" &amp; Doc.Path &amp; \" Name= \" &amp; Doc.Name\n    If SaveAsUI Then\n        Call Me.SaveAsBox(Doc)\n    Else\n        oScript.DlgTimeLastSaved = Now()\n        Doc.Save\n        If oDlgApplication.DevelopMode Then MsgBox \"Saving Document: \" &amp; Doc.FullName\n    End If\n\n    Cancel = True\nEnd If\nEnd Sub\n</code></pre>\n\n<p><strong>Now the problem is, when the Auto-Recovery triggers, this save method is called automatically and it saves the actual file instead of saving a backup version of the file to use in case Word crashes.</strong></p>\n\n<p>So is there a way to identify auto-save (recovery) and keep it as it is?</p>\n\n<p>Thanks,\nTejas</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": true, "score": 0, "last_activity_date": 1422413361, "creation_date": 1422413361, "answer_id": 28183770, "question_id": 28183726, "link": "https://stackoverflow.com/questions/28183726/how-to-clear-cell-range-contents/28183770#28183770", "title": "How to clear cell/range contents?", "body": "<p>forgotten column in specified range</p>\n\n<pre><code>Range(\"A2:A\" &amp; lastrow).ClearContents\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 982, "user_id": 3989484, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/a1TOy.jpg?s=128&g=1", "display_name": "Oluwatumbi", "link": "https://stackoverflow.com/users/3989484/oluwatumbi"}, "is_accepted": false, "score": 1, "last_activity_date": 1422420181, "last_edit_date": 1422420181, "creation_date": 1422413986, "answer_id": 28183871, "question_id": 28183726, "link": "https://stackoverflow.com/questions/28183726/how-to-clear-cell-range-contents/28183871#28183871", "title": "How to clear cell/range contents?", "body": "<p>Iterate the rows probably with a for next loop and delete entire row like this:</p>\n\n<pre><code>For i = 2 To lastrow\n    Rows(i).EntireRow.Delete\nNext i\n</code></pre>\n\n<p>or delete all rows in required range like this:</p>\n\n<pre><code>Rows(\"2:\" &amp; lastrow).delete\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 4493486, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/96cadf3fa1e5e1126ef5c7b91a2ecbd9?s=128&d=identicon&r=PG&f=1", "display_name": "Reeve", "link": "https://stackoverflow.com/users/4493486/reeve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "accepted_answer_id": 28183770, "answer_count": 2, "score": 0, "last_activity_date": 1422420181, "creation_date": 1422413059, "last_edit_date": 1422416748, "question_id": 28183726, "link": "https://stackoverflow.com/questions/28183726/how-to-clear-cell-range-contents", "title": "How to clear cell/range contents?", "body": "<p><strong>Here is my code,</strong></p>\n\n<pre><code>Sub Clear_click()\n    Dim lastrow As Long\n    lastrow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\n    Range(\"A2\" &amp; lastrow).ClearContents\nEnd Sub\n</code></pre>\n\n<p>As Excel has many rows, how do I start from clearing contents from the second row lets say eg.(<strong>A2</strong>) to a last row of data. The last row of data could be anywhere. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1561, "user_id": 179, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ZqopD.jpg?s=128&g=1", "display_name": "Isaac Moses", "link": "https://stackoverflow.com/users/179/isaac-moses"}, "is_accepted": false, "score": 1, "last_activity_date": 1422420879, "creation_date": 1422420879, "answer_id": 28184883, "question_id": 28183660, "link": "https://stackoverflow.com/questions/28183660/how-to-select-data-from-a-column-while-in-a-for-each-range-loop/28184883#28184883", "title": "How to select data from a column while in a For Each range loop?", "body": "<p>One way to do this would be to use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840060%28v=office.15%29.aspx\" rel=\"nofollow\"><code>Offset</code></a> property.</p>\n\n<p>For example, to refer to the cell in Column A that's on the same row as the current <code>cell</code> in Column K, you would use <code>cell.Offset(0, -10)</code>, since Column A is 10 columns to the left of Column K.</p>\n"}], "owner": {"reputation": 874, "user_id": 1442204, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1f8f688d347241b978d55c6d3dcb6131?s=128&d=identicon&r=PG&f=1", "display_name": "Gallaxhar", "link": "https://stackoverflow.com/users/1442204/gallaxhar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1422420879, "creation_date": 1422412558, "last_edit_date": 1531164843, "question_id": 28183660, "link": "https://stackoverflow.com/questions/28183660/how-to-select-data-from-a-column-while-in-a-for-each-range-loop", "title": "How to select data from a column while in a For Each range loop?", "body": "<p>I have a For Each loop reading the values of K2 through K7.</p>\n\n<p>It looks like this (this is not my full code):</p>\n\n<pre><code>For Each cell In Range(\"K2:K7\")\n'do stuff\nNext cell\n</code></pre>\n\n<p>How can I get data from another column (such as A, B, C, D, E, F, G, H, I, or J) on the CURRENT row of the \"For Each\" loop.</p>\n\n<p>For example, first the For Each loop will grab K2, then K3, then K4, then K5, then K6, then K7. How to make it grab K2 and A2, K3 and A3, K4 and A4, etc. in the same For Each loop?</p>\n\n<p>For example:</p>\n\n<pre><code>For Each cell In Range(\"K2:K7\")\nA.CurrentRow.Value = acolumndata\nB.CurrentRow.Value = bcolumndata\nC.CurrentRow.Value = ccolumndata\n'do more stuff\nNext cell\n</code></pre>\n"}, {"tags": ["vba", "excel", "sharepoint", "sharepoint-2010"], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 4025565, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/13ba3984f46eb06d51c72a63c2b02c73?s=128&d=identicon&r=PG&f=1", "display_name": "xtina1231", "link": "https://stackoverflow.com/users/4025565/xtina1231"}, "edited": false, "score": 0, "creation_date": 1422415867, "post_id": 28183873, "comment_id": 44737335, "body": "using VBA i can open a file in a sharepoint with this code:  <code>Dim wb4 As Workbook Set wb4 = Workbooks.Open(&quot;https:&#47;&#47;ts.company.com&#47;sites&#47;folder1&#47;folder2&zwnj;&#8203;&#47;01%20Project%20Docu&zwnj;&#8203;mentations&#47;INFINITY&#47;&zwnj;&#8203;Latest%20Reports&#47;Inf&zwnj;&#8203;inity%20AKAMAI%20CDN&zwnj;&#8203;%20Analysis%20-%20YY&zwnj;&#8203;YYMMDD.xlsx&quot;)</code>  now can i get the properties of that file using the codes you gave? i mean where can i insert the URL and the name of the file?"}, {"owner": {"reputation": 314, "user_id": 4347437, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-9ZbBIbUuYgc/AAAAAAAAAAI/AAAAAAAAABI/-9Cc52jrqX0/photo.jpg?sz=128", "display_name": "Bill", "link": "https://stackoverflow.com/users/4347437/bill"}, "reply_to_user": {"reputation": 115, "user_id": 4025565, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/13ba3984f46eb06d51c72a63c2b02c73?s=128&d=identicon&r=PG&f=1", "display_name": "xtina1231", "link": "https://stackoverflow.com/users/4025565/xtina1231"}, "edited": false, "score": 0, "creation_date": 1422422890, "post_id": 28183873, "comment_id": 44739307, "body": "I tried the code you added to your comment.  I failed to open a SharePoint excel file with that code.  However, if you are able to open the file and set it to the wb4 object that is of type Workbook, then adding the for loop from the code in my answer would yield the document properties.  You can try with a local file first to check the document properties.  Then attempt opening a file on SharePoint."}, {"owner": {"reputation": 115, "user_id": 4025565, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/13ba3984f46eb06d51c72a63c2b02c73?s=128&d=identicon&r=PG&f=1", "display_name": "xtina1231", "link": "https://stackoverflow.com/users/4025565/xtina1231"}, "edited": false, "score": 0, "creation_date": 1422426677, "post_id": 28183873, "comment_id": 44740646, "body": "alright. this is noted. i&#39;ll try it. thanks Bill! :)"}], "tags": [], "owner": {"reputation": 314, "user_id": 4347437, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-9ZbBIbUuYgc/AAAAAAAAAAI/AAAAAAAAABI/-9Cc52jrqX0/photo.jpg?sz=128", "display_name": "Bill", "link": "https://stackoverflow.com/users/4347437/bill"}, "is_accepted": false, "score": 1, "last_activity_date": 1456224843, "last_edit_date": 1456224843, "creation_date": 1422413987, "answer_id": 28183873, "question_id": 28183576, "link": "https://stackoverflow.com/questions/28183576/how-to-obtain-the-properties-of-an-excel-file-in-sharepoint-using-vba/28183873#28183873", "title": "How to obtain the properties of an Excel file in SharePoint using VBA?", "body": "<p>I believe the only way to get the vba/macro to run is to 'Open in Excel' from SharePoint 2010.  I don't think vba/macros will run when you open an Excel file in the browser.</p>\n\n<p>I added the following code to VBA (press alt F11 to get the VBA editor open):</p>\n\n<pre><code> Public Sub documentProperties()\n      On Error Resume Next\n      Dim oApp As New Excel.Application\n      Dim oWB As Workbook\n      Set oWB = ActiveWorkbook\n\n      Dim propertieslist As String\n      For l = 1 To oWB.BuiltinDocumentProperties.Count\n        MsgBox oWB.BuiltinDocumentProperties.Item(l).Name &amp; \":\" &amp; oWB.BuiltinDocumentProperties.Item(l).Value\n      Next l\n\n      MsgBox propertieslist\n    End Sub\n</code></pre>\n\n<p>I then put a button on the excel sheet (Google search for \"excel 2010 add button\") to get instructions for adding the developer menu to the ribbon. </p>\n"}], "owner": {"reputation": 115, "user_id": 4025565, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/13ba3984f46eb06d51c72a63c2b02c73?s=128&d=identicon&r=PG&f=1", "display_name": "xtina1231", "link": "https://stackoverflow.com/users/4025565/xtina1231"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 824, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456224843, "creation_date": 1422411974, "question_id": 28183576, "link": "https://stackoverflow.com/questions/28183576/how-to-obtain-the-properties-of-an-excel-file-in-sharepoint-using-vba", "title": "How to obtain the properties of an Excel file in SharePoint using VBA?", "body": "<p>i am creating a macro file with command buttons that when you click it, it will display the properties esp the last modified date and time of an Excel file uploaded in a SharePoint site. How can i do this using VBA. \nYou're prompt response is very appreciated. Thanks a lot!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1422409121, "post_id": 28183196, "comment_id": 44735659, "body": "Have you tried anything?  The sheet Test will have an <code>Index</code> property indicating its tab position - you can use that."}, {"owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1422409164, "post_id": 28183196, "comment_id": 44735672, "body": "Not sure how to start. Tried searching. not much of a help."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1422409600, "post_id": 28183196, "comment_id": 44735764, "body": "Use  <code>For i = Sheets.Count To (shtTest.Index+1) Step-1</code>  where <code>shtTest</code> is a variable representing the worksheet &quot;Test&quot;.  Delete <code>Sheets(i)</code> on each iteration."}, {"owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1422409854, "post_id": 28183196, "comment_id": 44735823, "body": "There is a compile error at Delete saying sub or function not defined"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1422409940, "post_id": 28183196, "comment_id": 44735838, "body": "Update your question with your code - difficult to debug when invisible."}, {"owner": {"reputation": 6440, "user_id": 4002530, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Hrwjk.jpg?s=128&g=1", "display_name": "tospig", "link": "https://stackoverflow.com/users/4002530/tospig"}, "edited": false, "score": 0, "creation_date": 1422410277, "post_id": 28183196, "comment_id": 44735927, "body": "Record a macro where you delete a sheet. That will give you the code."}, {"owner": {"reputation": 6440, "user_id": 4002530, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Hrwjk.jpg?s=128&g=1", "display_name": "tospig", "link": "https://stackoverflow.com/users/4002530/tospig"}, "edited": false, "score": 0, "creation_date": 1422410770, "post_id": 28183196, "comment_id": 44736046, "body": "@lakesh yes, and recording a macro will give you <code>vba</code> code. Go to the &#39;developer&#39; tab on the ribbon and select &#39;Record Macro&#39;. Then delete a sheet. Then press &#39;stop recording&#39;, go into the VBA editor and your code will be there in a new module."}, {"owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "edited": false, "score": 1, "creation_date": 1422412367, "post_id": 28183196, "comment_id": 44736423, "body": "How to avoid the pop up box saying &quot; Data may exist in the sheet(s) selected for deletion. To permanently delete the data, press Delete&quot;. How to avoid this."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1422413489, "post_id": 28183196, "comment_id": 44736686, "body": "FYI - Google has ready answers for all of these &quot;how to&quot; questions - please try there <i>first</i>."}, {"owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1422416111, "post_id": 28183196, "comment_id": 44737399, "body": "@TimWilliams please add yours an answer. Will mark it right."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1422419694, "post_id": 28183196, "comment_id": 44738355, "body": "@garysstudent&#39;s answer is fine - you should flag that as the answer"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 6, "last_activity_date": 1422412841, "creation_date": 1422412841, "answer_id": 28183704, "question_id": 28183196, "link": "https://stackoverflow.com/questions/28183196/how-to-delete-the-sheets-after-a-certain-sheet/28183704#28183704", "title": "How to delete the sheets after a certain sheet?", "body": "<p>Consider:</p>\n\n<pre><code>Sub SheetKiller()\n    Dim i As Long\n    Dim j As Long\n    j = 0\n    For i = 1 To Sheets.Count\n        If Sheets(i).Name = \"Test\" Then\n            j = i\n        End If\n    Next i\n\n    If j = 0 Or j = Sheets.Count Then Exit Sub\n\n    Application.DisplayAlerts = False\n        For i = Sheets.Count To j + 1 Step -1\n            Sheets(i).Delete\n        Next i\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 3, "last_activity_date": 1422415113, "creation_date": 1422415113, "answer_id": 28184033, "question_id": 28183196, "link": "https://stackoverflow.com/questions/28183196/how-to-delete-the-sheets-after-a-certain-sheet/28184033#28184033", "title": "How to delete the sheets after a certain sheet?", "body": "<p>Taking an alternate approach to what has already been offered, if you had 10 sheets (worksheets..?) and wanted to remove everything after the <strong>Test</strong> worksheet, simply continually delete <code>sheet(Sheets(\"test\").Index + 1)</code> until sheets.count is less than Sheets(\"test\").Index +1.</p>\n\n<pre><code>Application.DisplayAlerts = False   'take off the training wheels\nDo While Sheets.Count &gt; Sheets(\"test\").Index\n    Sheets(Sheets(\"test\").Index + 1).Delete\nLoop\nApplication.DisplayAlerts = True\n</code></pre>\n"}], "owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6535, "favorite_count": 3, "accepted_answer_id": 28183704, "answer_count": 2, "score": 3, "last_activity_date": 1422416840, "creation_date": 1422408807, "last_edit_date": 1422416840, "question_id": 28183196, "link": "https://stackoverflow.com/questions/28183196/how-to-delete-the-sheets-after-a-certain-sheet", "title": "How to delete the sheets after a certain sheet?", "body": "<p>I have worksheet in my workbook as <strong>Test</strong>. There are other worksheets as well. I want to delete the worksheets that appear on the right of the worksheet called Test. </p>\n\n<p>How do I do that in VBA? Need some help on this.</p>\n\n<p>Edit:</p>\n\n<pre><code>Set test= ThisWorkbook.Worksheets(\"Test\")\nFor i = Sheets.Count To (test.Index + 1) Step -1\n    Delete Sheets(i)\nNext\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1422406201, "post_id": 28182700, "comment_id": 44734821, "body": "You should provide some more details, the error seems very strange to reproduce."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1422406281, "post_id": 28182700, "comment_id": 44734845, "body": "That shouldn&#39;t be the case, can you try to check your worksheet if you don&#39;t have <code>Worksheet_Change event</code>?"}, {"owner": {"reputation": 1, "user_id": 4500916, "user_type": "registered", "profile_image": "https://graph.facebook.com/1710073253/picture?type=large", "display_name": "Chris Bourassa", "link": "https://stackoverflow.com/users/4500916/chris-bourassa"}, "edited": false, "score": 0, "creation_date": 1422408419, "post_id": 28182700, "comment_id": 44735469, "body": "I know it shouldn&#39;t be the case, took Excel a few years back in College, never had the problem.  checking now"}, {"owner": {"reputation": 1, "user_id": 4500916, "user_type": "registered", "profile_image": "https://graph.facebook.com/1710073253/picture?type=large", "display_name": "Chris Bourassa", "link": "https://stackoverflow.com/users/4500916/chris-bourassa"}, "edited": false, "score": 0, "creation_date": 1422408560, "post_id": 28182700, "comment_id": 44735513, "body": "Haven&#39;t found it.  Nothing in any of my click codes, possibly in teh settings?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4501854, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5VkevbfYhCk/AAAAAAAAAAI/AAAAAAAAABQ/GunNvtBzYo0/photo.jpg?sz=128", "display_name": "Ravi Rajulu", "link": "https://stackoverflow.com/users/4501854/ravi-rajulu"}, "is_accepted": false, "score": 0, "last_activity_date": 1422487999, "last_edit_date": 1422487999, "creation_date": 1422433589, "answer_id": 28187636, "question_id": 28182700, "link": "https://stackoverflow.com/questions/28182700/entering-data-in-a-cell-and-pressing-enter-activates-a-button-on-my-form/28187636#28187636", "title": "Entering data in a cell and pressing enter activates a button on my form", "body": "<p>Actually you are using the Random function , so if you change or alter any cell in worksheet it will change . So it is nothing to do with mouse click as far i guess and enter is event in excel which tends to change the data , in your case is random function Formula applied to particular excel cell it will change as other cells value are altered or changed .\nSo for your Purpose Use below code ::</p>\n\n<pre><code>Sub \n\n  Button1_Click()\n  Sheet2.Activate\n  Sheet2.Select\n\n  Range (\"B1\") = Rnd()*(25+1)\n\nEnd Sub\n</code></pre>\n\n<p>Reply !!!!</p>\n\n<p>Thanks</p>\n"}], "owner": {"reputation": 1, "user_id": 4500916, "user_type": "registered", "profile_image": "https://graph.facebook.com/1710073253/picture?type=large", "display_name": "Chris Bourassa", "link": "https://stackoverflow.com/users/4500916/chris-bourassa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1422487999, "creation_date": 1422405352, "last_edit_date": 1422406146, "question_id": 28182700, "link": "https://stackoverflow.com/questions/28182700/entering-data-in-a-cell-and-pressing-enter-activates-a-button-on-my-form", "title": "Entering data in a cell and pressing enter activates a button on my form", "body": "<p>I have a button with the <code>Button_Click</code> event macro with the following code:</p>\n\n<pre><code>Sub Button1_Click()\n'\n' Button1_Click Macro\n\n    Range(\"B1\").Select\n    ActiveCell.FormulaR1C1 = \"=INT(RAND()*25+1)\"        \nEnd Sub\n</code></pre>\n\n<p>If I enter data into any cell in the spreadsheet, once I press enter the button activates.  I think it is reading my left mouse <strong>click</strong> directly and not as a press onto the button.</p>\n"}, {"tags": ["vba", "url", "outlook", "window", "preview"], "comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1422409119, "post_id": 28182693, "comment_id": 44735658, "body": "I don&#39;t know why your question was put on hold (Andrew?), so I have to answer in the comments. The preview pane will never show an external URL - it is not even an embedded browser, it is Word. To show a url in Outlook, set the MAPIFolder WebViewOn property to true and MAPIFolder.WebViewURL to the url that you want to show."}, {"owner": {"reputation": 1, "user_id": 4500910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcc7ad79f8f02a16fb6cd616386d3471?s=128&d=identicon&r=PG&f=1", "display_name": "MysticGoat", "link": "https://stackoverflow.com/users/4500910/mysticgoat"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1422410793, "post_id": 28182693, "comment_id": 44736054, "body": "Thanks Dmitry I edited it to make it a bit more understandable I expected it to be taken off hold by now."}, {"owner": {"reputation": 1, "user_id": 4500910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcc7ad79f8f02a16fb6cd616386d3471?s=128&d=identicon&r=PG&f=1", "display_name": "MysticGoat", "link": "https://stackoverflow.com/users/4500910/mysticgoat"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1422415997, "post_id": 28182693, "comment_id": 44737370, "body": "Ok I have that figured out. is there a way to do this without using a specific MAPIFolder or using a temporary/hidden folder?"}], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1422417432, "creation_date": 1422417432, "answer_id": 28184382, "question_id": 28182693, "link": "https://stackoverflow.com/questions/28182693/open-url-in-outlook-message-preview-window/28184382#28184382", "title": "Open url in outlook message preview window", "body": "<p>Yes, you can create a temporary folder and make it active by setting the Applicatiobn.ActiveExplorer.CurrentFolder property. </p>\n"}, {"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1422445048, "creation_date": 1422445048, "answer_id": 28191304, "question_id": 28182693, "link": "https://stackoverflow.com/questions/28182693/open-url-in-outlook-message-preview-window/28191304#28191304", "title": "Open url in outlook message preview window", "body": "<p>There several way to implement this task in Outlook.</p>\n\n<ol>\n<li><p>Use the home page for the Outlook folder. The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff866188(v=office.15).aspx\" rel=\"nofollow\">WebViewURL</a> property allows to set a string indicating the URL of the Web page that is assigned to a folder.</p>\n\n<p>Sub SetupFolderHomePage() \n    Dim nsp As Outlook.NameSpace\n    Dim mpfInbox As Outlook.Folder<br>\n    Dim mpfNew As Outlook.Folder<br>\n    Set nsp = Application.GetNamespace(\"MAPI\")<br>\n    Set mpfInbox = nsp.GetDefaultFolder(olFolderInbox)<br>\n    Set mpfNew = mpfInbox.Folders.Add(\"MyFolderHomePage\")<br>\n    mpfNew.WebViewURL = \"<a href=\"http://www.microsoft.com\" rel=\"nofollow\">http://www.microsoft.com</a>\"<br>\n    mpfNew.WebViewOn = True<br>\n End Sub</p></li>\n<li><p>Create an adjacent Outlook window and injkect it into the explorer window. See <a href=\"http://blogs.msdn.com/b/stephen_griffin/archive/2010/06/01/adjacent-windows-in-outlook.aspx\" rel=\"nofollow\">Adjacent Windows In Outlook</a> and <a href=\"https://code.msdn.microsoft.com/windowsdesktop/Creating-Adjacent-Windows-00090e4a\" rel=\"nofollow\">Creating Adjacent Windows In Outlook</a> for more information. </p></li>\n</ol>\n"}], "owner": {"reputation": 1, "user_id": 4500910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcc7ad79f8f02a16fb6cd616386d3471?s=128&d=identicon&r=PG&f=1", "display_name": "MysticGoat", "link": "https://stackoverflow.com/users/4500910/mysticgoat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 316, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1422445048, "creation_date": 1422405290, "last_edit_date": 1422406206, "question_id": 28182693, "link": "https://stackoverflow.com/questions/28182693/open-url-in-outlook-message-preview-window", "title": "Open url in outlook message preview window", "body": "<p>Currently I have code that will extract information from outlook message subject line and use this to open a link in IE.</p>\n\n<p>I managed to break outlook the other day and these url's started opening in the outlook message preview window.</p>\n\n<p>:) Does any one have any pointers on how can I code this so it happens on purpose?</p>\n\n<p>I want to open the url inside the outlook application window instead of opening the url in internet explorer.</p>\n\n<pre><code>If subj &lt;&gt; \"\" Then\n        Dim IE As Object\n        With CreateObject(\"Shell.Application\").Windows\n            If .Count &gt; 0 Then\n        ' Get IE\n                Set IE = .Item(0) '.Item(.Count + 1)\n            Else\n        ' Create IE\n                Set IE = CreateObject(\"InternetExplorer.Application\")\n                IE.Visible = True\n            End If\n        IE.Navigate \"url here\"\n        Set IE = Nothing\n        End With\n        Exit Sub\nEnd If\n</code></pre>\n\n<p>Thanks\naj</p>\n"}, {"tags": ["vba", "loops", "excel"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 4500562, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8dac15110c01ea288a96baf7035425f6?s=128&d=identicon&r=PG&f=1", "display_name": "MrJ1m", "link": "https://stackoverflow.com/users/4500562/mrj1m"}, "edited": false, "score": 0, "creation_date": 1422405744, "post_id": 28182686, "comment_id": 44734668, "body": "Thanks a lot, it works nicely!  But Is there a way to show the function in the cell when the user activate it in the sheet?"}, {"owner": {"reputation": 55, "user_id": 4500562, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8dac15110c01ea288a96baf7035425f6?s=128&d=identicon&r=PG&f=1", "display_name": "MrJ1m", "link": "https://stackoverflow.com/users/4500562/mrj1m"}, "edited": false, "score": 0, "creation_date": 1422410644, "post_id": 28182686, "comment_id": 44736015, "body": "Thank you very much! Very precise, and thanks for the note too.  I&#39;m just getting back to using vba it&#39;s been a while so i still make mistakes and all. with work it will pass :) thanks"}, {"owner": {"reputation": 55, "user_id": 4500562, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8dac15110c01ea288a96baf7035425f6?s=128&d=identicon&r=PG&f=1", "display_name": "MrJ1m", "link": "https://stackoverflow.com/users/4500562/mrj1m"}, "edited": false, "score": 0, "creation_date": 1422451118, "post_id": 28182686, "comment_id": 44753421, "body": "Anyway to re use the same to sum up every row this time, and get the result in the column just on the right? I&#39;m trying to understand the split and cell.adress functions you used, tried changing the order and all but i&#39;m still stuck"}, {"owner": {"reputation": 55, "user_id": 4500562, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8dac15110c01ea288a96baf7035425f6?s=128&d=identicon&r=PG&f=1", "display_name": "MrJ1m", "link": "https://stackoverflow.com/users/4500562/mrj1m"}, "edited": false, "score": 0, "creation_date": 1422451485, "post_id": 28182686, "comment_id": 44753642, "body": "edit: I&#39;m using this currently      cell.Value = &quot;=SUM(&quot; &amp; cell.Column - a &amp; Split(cell.Address, &quot;$&quot;)(2) &amp; &quot;:&quot; &amp; cell.Column - 1 &amp; Split(cell.Address, &quot;$&quot;)(2) &amp; &quot;)&quot;"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 55, "user_id": 4500562, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8dac15110c01ea288a96baf7035425f6?s=128&d=identicon&r=PG&f=1", "display_name": "MrJ1m", "link": "https://stackoverflow.com/users/4500562/mrj1m"}, "edited": false, "score": 0, "creation_date": 1422451532, "post_id": 28182686, "comment_id": 44753670, "body": "@MrJ1m, if you&#39;re stuck in a new purpose please open another question, it will be easier and allow other people to contribute as well."}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 0, "last_activity_date": 1422406105, "last_edit_date": 1422406105, "creation_date": 1422405255, "answer_id": 28182686, "question_id": 28182450, "link": "https://stackoverflow.com/questions/28182450/how-to-execute-a-function-in-the-cell-below-every-column-of-a-specific-range/28182686#28182686", "title": "How to execute a function in the cell below every column of a specific range?", "body": "<p>Using your same approach, you can add the sum by using the built-in WorksheetFunction.Sum and just looking up by the end of each column: </p>\n\n<pre><code>Set sums = Range(ActiveCell.Offset(a, 0), ActiveCell.Offset(a, a - 1))\nFor Each cell In sums\n    cell.Value = WorksheetFunction.Sum(Range(Split(cell.Address, \"$\")(1) &amp; cell.Row - a &amp; \":\" &amp; Split(cell.Address, \"$\")(1) &amp; cell.Row))\nNext\n</code></pre>\n\n<p>P.s. I take chance to highlight you a couple of things in your proposed code for the problem: </p>\n\n<pre><code>Set Range(ActiveCell + i, ActiveCell.End(xlDown)).Offset(1, 0).Value = \"=SUM(R[-a]C:R[-1]C)\"\n</code></pre>\n\n<p>1) Don't use the keyword <code>Set</code>, that one is for setting a variable to an object (not a string into a cell, for that you don't need anything); </p>\n\n<p>2) The <code>ActiveCell</code>, without any other specification, will return by default the property <code>Value</code>. So, if you have just filled the range <code>A1:A4</code>, the line of code: </p>\n\n<pre><code>Range(ActiveCell + i, ActiveCell.End(xlDown))\n</code></pre>\n\n<p>will not be the expected</p>\n\n<pre><code>Range(\"A5\")\n</code></pre>\n\n<p>but rather a mixture of random numbers as well as syntax errors (just to give you an idea, it will be something like <code>Range(76,5)</code>).</p>\n\n<p><strong>EDIT - if you want to insert the Excel functions instead of the hard-coded results</strong></p>\n\n<pre><code>Set sums = Range(ActiveCell.Offset(a, 0), ActiveCell.Offset(a, a - 1))\nFor Each cell In sums\n    cell.Value = \"=SUM(\" &amp; Split(cell.Address, \"$\")(1) &amp; cell.Row - a &amp; \":\" &amp; Split(cell.Address, \"$\")(1) &amp; cell.Row - 1 &amp; \")\"\nNext\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 4500562, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8dac15110c01ea288a96baf7035425f6?s=128&d=identicon&r=PG&f=1", "display_name": "MrJ1m", "link": "https://stackoverflow.com/users/4500562/mrj1m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 28182686, "answer_count": 1, "score": 0, "last_activity_date": 1422406105, "creation_date": 1422403956, "last_edit_date": 1422405723, "question_id": 28182450, "link": "https://stackoverflow.com/questions/28182450/how-to-execute-a-function-in-the-cell-below-every-column-of-a-specific-range", "title": "How to execute a function in the cell below every column of a specific range?", "body": "<p>So, this is what I wrote so far: </p>\n\n<pre><code>Sub somme()\n    Dim a, i As Integer, Data, Rng As Range\n    a = InputBox(\"How many cells for the square?\")\n    Set Data = Range(ActiveCell.Offset(0, 0), ActiveCell.Offset(a - 1, a - 1))\n\n    For Each cell In Data\n        cell.Value = Int((100 + 100 + 1) * Rnd - 100)\n    Next\n    For i = 1 To a\n        Set Range(ActiveCell + i, ActiveCell.End(xlDown)) _\n            .Offset(1, 0).Value = \"=SUM(R[-a]C:R[-1]C)\"\n    Next\nEnd Sub\n</code></pre>\n\n<p>I want to sum every column in the cell right below, for any sized range.</p>\n"}, {"tags": ["algorithm", "vba", "sorting", "loops", "traversal"], "comments": [{"owner": {"reputation": 330, "user_id": 2892280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f114732d296420e6a0c139492cddff5?s=128&d=identicon&r=PG&f=1", "display_name": "bajuwa", "link": "https://stackoverflow.com/users/2892280/bajuwa"}, "edited": false, "score": 0, "creation_date": 1422400565, "post_id": 28181613, "comment_id": 44732889, "body": "Can you expand a bit more on why you need to traverse an individual employee sheet multiple times?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1422403175, "post_id": 28181613, "comment_id": 44733831, "body": "It would help a lot to show your existing code.  It&#39;s easier to follow that for details than a textual explanation."}], "answers": [{"comments": [{"owner": {"reputation": 1169, "user_id": 988322, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d4aadf79097dd198c6e04c1d675124ce?s=128&d=identicon&r=PG", "display_name": "John Lee", "link": "https://stackoverflow.com/users/988322/john-lee"}, "edited": false, "score": 0, "creation_date": 1422469119, "post_id": 28181785, "comment_id": 44765327, "body": "I havent seen this method before. So are you putting the whole data in memory (array) and then processing everything in there first? Then write out the results to the sheet?"}, {"owner": {"reputation": 330, "user_id": 2892280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f114732d296420e6a0c139492cddff5?s=128&d=identicon&r=PG&f=1", "display_name": "bajuwa", "link": "https://stackoverflow.com/users/2892280/bajuwa"}, "reply_to_user": {"reputation": 1169, "user_id": 988322, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d4aadf79097dd198c6e04c1d675124ce?s=128&d=identicon&r=PG", "display_name": "John Lee", "link": "https://stackoverflow.com/users/988322/john-lee"}, "edited": false, "score": 0, "creation_date": 1422469599, "post_id": 28181785, "comment_id": 44765615, "body": "Essentially, yes.  I will update my answer shortly to provide some more references/info on ranges and arrays"}, {"owner": {"reputation": 1169, "user_id": 988322, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d4aadf79097dd198c6e04c1d675124ce?s=128&d=identicon&r=PG", "display_name": "John Lee", "link": "https://stackoverflow.com/users/988322/john-lee"}, "edited": false, "score": 0, "creation_date": 1422470394, "post_id": 28181785, "comment_id": 44766076, "body": "Thanks for that link! I didnt know about this. I&#39;m browsing through that site but is it faster to dump an array to a column rather than traversing each element of the array and writing to each cell of the column? Isnt the first approach writing to each cell anyways?"}, {"owner": {"reputation": 330, "user_id": 2892280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f114732d296420e6a0c139492cddff5?s=128&d=identicon&r=PG&f=1", "display_name": "bajuwa", "link": "https://stackoverflow.com/users/2892280/bajuwa"}, "reply_to_user": {"reputation": 1169, "user_id": 988322, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d4aadf79097dd198c6e04c1d675124ce?s=128&d=identicon&r=PG", "display_name": "John Lee", "link": "https://stackoverflow.com/users/988322/john-lee"}, "edited": false, "score": 0, "creation_date": 1422470663, "post_id": 28181785, "comment_id": 44766207, "body": "Honestly, I&#39;m not 100% sure why.  My guess would be that Excel also stores its data in a multidimensional array and therefore its easier to splice the data from their structures than it is to go through a GUI based system (since manipulating cells triggers functions and other visual updates).  For more info, check out this link on Excel+VBA efficiency: <a href=\"https://www.soa.org/News-and-Publications/Newsletters/Compact/2012/january/com-2012-iss42-roper.aspx\" rel=\"nofollow noreferrer\">soa.org/News-and-Publications/Newsletters/Compact/2012/janua&zwnj;&#8203;ry/&hellip;</a>  Lastly, fun fact: using 3D arrays lets you copy+paste data over multiple sheets"}], "tags": [], "owner": {"reputation": 330, "user_id": 2892280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f114732d296420e6a0c139492cddff5?s=128&d=identicon&r=PG&f=1", "display_name": "bajuwa", "link": "https://stackoverflow.com/users/2892280/bajuwa"}, "is_accepted": true, "score": 1, "last_activity_date": 1422470801, "last_edit_date": 1525816150, "creation_date": 1422400349, "answer_id": 28181785, "question_id": 28181613, "link": "https://stackoverflow.com/questions/28181613/excel-vba-script-optimization-traversal-algorithm-solve-this-puzzle/28181785#28181785", "title": "Excel VBA script optimization - traversal algorithm - solve this puzzle?", "body": "<p>As a note, regardless of your data collection and manipulation algorithm, you can speed up the process IMMENSELY by first preparing the data in a multi-dimensional array, and then using the .Range VBA method to populate a given range with your array.  </p>\n\n<p>The key to this is that you write out the array to a range all at once, not cell by cell.  I am assuming that right now you are doing a lot of individual cell manipulations, such as getting a piece of data from one cell, putting it into another, etc.  The actual interaction between excel cell manipulations and VBA is actually quite slow (not sure why, but probably due to cascading cell functions and visual updates, but see <a href=\"https://www.soa.org/News-and-Publications/Newsletters/Compact/2012/january/com-2012-iss42-roper.aspx\" rel=\"nofollow noreferrer\">https://www.soa.org/News-and-Publications/Newsletters/Compact/2012/january/com-2012-iss42-roper.aspx</a> for more information on Excel+VBA speed and efficiency rules and examples).</p>\n\n<p>More info on how to use arrays and ranges: <a href=\"http://www.cpearson.com/excel/ArraysAndRanges.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/ArraysAndRanges.aspx</a><br>\nBy the way, C Pearson has a lot of great information on Excel+VBA, so I highly recommend his site as a general reference.</p>\n\n<p>I have used this before and sped up a macro from an order of minutes to an order of seconds.  Hopefully it can do the same for you.</p>\n\n<hr>\n\n<p>Edit: I don't know what your current data manipulation algorithm is, so I can't comment directly on that yet, but if it is for the summation of expenses, can you try to sum up the data as you go, so that way you don't need to do any extra calculations by the time you get to the sheet you simply have to input the data in the correct month columns?</p>\n"}], "owner": {"reputation": 1169, "user_id": 988322, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d4aadf79097dd198c6e04c1d675124ce?s=128&d=identicon&r=PG", "display_name": "John Lee", "link": "https://stackoverflow.com/users/988322/john-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 907, "favorite_count": 0, "accepted_answer_id": 28181785, "answer_count": 1, "score": 0, "last_activity_date": 1422470801, "creation_date": 1422399477, "last_edit_date": 1422400293, "question_id": 28181613, "link": "https://stackoverflow.com/questions/28181613/excel-vba-script-optimization-traversal-algorithm-solve-this-puzzle", "title": "Excel VBA script optimization - traversal algorithm - solve this puzzle?", "body": "<p>I have a somewhat large excel workbook with several sheets. The workbook records employee expenses. </p>\n\n<p>I have a vba macro that loads data from a master sheet to all the other sheets and it is taking a very long time to run. I was hoping to get some tips on how I might be able to improve the performance.</p>\n\n<p><strong>Some quick background info:</strong>\nEach employee has an individual sheet. This sheet contains all the expenses for that employee for each month of the year - January through December (columns). There can be many types of expenses (rows).</p>\n\n<p>The master data sheet contains all the expenses for all the employees for the year. Each record contains the employee id (which is used as the employee's sheet name), expense type, expense amount and date. The master sheet is sorted by employee id, then date, then expense type. There can be duplicate expense types for the same date.</p>\n\n<p>Though there can be duplicate expense types on the master data sheet, there are no duplicates on the employee sheet. The expenses are summed for each type for each month.</p>\n\n<p>Example - master sheet:</p>\n\n<pre><code>&gt; EmpID1 ExpenseType1 01/02/2015 $5\n&gt; EmpID1 ExpenseType2 01/02/2015 $3\n&gt; EmpID1 ExpenseType2 01/03/2015 $6\n&gt; EmpID1 ExpenseType2 01/03/2015 $10\n&gt; EmpID1 ExpenseType2 01/04/2015 $11\n&gt; ...\n</code></pre>\n\n<p>Example - employee sheet:</p>\n\n<pre><code>&gt; Months up top: Jan Feb Mar Apr May ...   \n&gt; ExpenseType1 $5 $2 $10 $3 $2\n&gt; ExpenseType2 $30 $5 $1 $32 $12 \n&gt; ExpenseType3 $11 $22 $3 $1 $2\n&gt; ...\n</code></pre>\n\n<p><strong>The problem:</strong>\nWhat is the best way to populate the employee sheets? </p>\n\n<p>My current algorithm traverses the master data sheet once by reading each record. But it then traverses the employee sheet multiple times. It looks for that expense type on the employee's sheet and adds the amount to the previous.</p>\n\n<p>Is this the most optimum solution? Any ideas on how I might be able to improve on this please? </p>\n"}, {"tags": ["sql", "excel", "vba", "ms-access", "pivot"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 4500335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12b36360438d191fdfa88b3cff100a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Furbs", "link": "https://stackoverflow.com/users/4500335/furbs"}, "edited": false, "score": 0, "creation_date": 1422405726, "post_id": 28181754, "comment_id": 44734666, "body": "Cha, thanks for your answer. I dont fully understand why I have to make another column when I already have a Date column to use.  Really I would be okay with not having blank columns as long as I had a header for each column.  Then I can just write a macro to place them and sort them. I don&#39;t understand why the query has column names when Access does it, but when I copy it to VBA it does not.  Maybe this is some connection setting I am missing?"}, {"owner": {"reputation": 10018, "user_id": 1309356, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o45P6.png?s=128&g=1", "display_name": "cha", "link": "https://stackoverflow.com/users/1309356/cha"}, "reply_to_user": {"reputation": 39, "user_id": 4500335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12b36360438d191fdfa88b3cff100a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Furbs", "link": "https://stackoverflow.com/users/4500335/furbs"}, "edited": false, "score": 0, "creation_date": 1422406057, "post_id": 28181754, "comment_id": 44734785, "body": "If you do not have data for all dates in a range then this data will not be in the select statement. As a result, when you TRANSFORM this select statement the columns will not be created resulting in gaps. by using the LEFT JOIN you make it sure that at least one row is created to the missing dates. Just try the above queries ans see if they produce the desired result"}], "tags": [], "owner": {"reputation": 10018, "user_id": 1309356, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o45P6.png?s=128&g=1", "display_name": "cha", "link": "https://stackoverflow.com/users/1309356/cha"}, "is_accepted": false, "score": 0, "last_activity_date": 1422402594, "last_edit_date": 1495542511, "creation_date": 1422400205, "answer_id": 28181754, "question_id": 28181342, "link": "https://stackoverflow.com/questions/28181342/vba-access-query-for-day-summary/28181754#28181754", "title": "VBA Access Query for Day Summary", "body": "<p>In order to get the records for all day, even those where there were no activity you need to create these days. The simplest way to do so in access is to use a set of UNION statements to create a fake table for the days similar to this:</p>\n\n<pre><code>SELECT #2015-01-20# as dt FROM dual\nUNION ALL\nSELECT #2015-01-21# as dt FROM dual\nUNION ALL\nSELECT #2015-01-22# as dt FROM dual\n</code></pre>\n\n<p>If you try the above query in Access it will not work, as there is no table called <code>dual</code>. You will have to create it. Check <a href=\"https://stackoverflow.com/questions/7933518/table-less-union-query-in-ms-access-jet-ace\">this</a> SO question.</p>\n\n<p>After you created the above query you can LEFT JOIN it with the source table. </p>\n\n<pre><code>TRANSFORM Count(FixAlarms.[Alm_NativeTimeLast]) AS CountOfAlm_NativeTimeLast \nSELECT FixAlarms.Alm_Tagname, FixAlarms.Alm_Desc \nFROM \n(SELECT #2015-01-20# as dt FROM dual\nUNION ALL\nSELECT #2015-01-21# as dt FROM dual\nUNION ALL\nSELECT #2015-01-22# as dt FROM dual) as dates LEFT JOIN\nFixAlarms ON DateValue(FixAlarms.[Alm_NativeTimeIn]) = dates.dt\nWHERE ((FixAlarms.Alm_Tagname) &lt;&gt; \"\"\"\")) AND FixAlarms.Alm_NativeTimeIn &gt; CellTime \nGROUP BY FixAlarms.[Alm_Tagname], FixAlarms.Alm_Descr \nPIVOT Format(dates.dt, 'Short Date')\n</code></pre>\n\n<p>EDIT: I must add that this is not the only way of achieving it. Another way is to use a <code>Numbers</code> table. Create a table called <code>Numbers</code> with a single numeric column <code>n</code> and fill it with numbers 0 to 100 (depends on the maximum number of days you wish to include into your query). Then your query for the <code>dates</code> will be:</p>\n\n<p>SELECT DateAdd('d', n, #2015-01-20#) as dt FROM numbers where n &lt; 30;</p>\n\n<p>And the resulting query will be:</p>\n\n<pre><code>TRANSFORM Count(FixAlarms.[Alm_NativeTimeLast]) AS CountOfAlm_NativeTimeLast \nSELECT FixAlarms.Alm_Tagname, FixAlarms.Alm_Desc \nFROM \n(SELECT DateAdd('d', n, #2015-01-20#) as dt FROM numbers where n &lt; 30) as dates LEFT JOIN\nFixAlarms ON DateValue(FixAlarms.[Alm_NativeTimeIn]) = dates.dt\nWHERE ((FixAlarms.Alm_Tagname) &lt;&gt; \"\"\"\")) AND FixAlarms.Alm_NativeTimeIn &gt; CellTime \nGROUP BY FixAlarms.[Alm_Tagname], FixAlarms.Alm_Descr \nPIVOT Format(dates.dt, 'Short Date')\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "is_accepted": false, "score": 0, "last_activity_date": 1422407772, "last_edit_date": 1422407772, "creation_date": 1422407314, "answer_id": 28183000, "question_id": 28181342, "link": "https://stackoverflow.com/questions/28181342/vba-access-query-for-day-summary/28183000#28183000", "title": "VBA Access Query for Day Summary", "body": "<p>When using <code>PIVOT columnName IN (ValueList)</code> <code>ValueList</code> is</p>\n\n<ol>\n<li>In parentheses</li>\n<li>In quotes</li>\n<li>Comma separated</li>\n</ol>\n\n<p>So you're</p>\n\n<pre><code>PIVOT Format([Alm_NativeTimeIn],\"\"Short Date\"\") IN 01/20/15\"\n</code></pre>\n\n<p>Needs to become</p>\n\n<pre><code>PIVOT Format([Alm_NativeTimeIn],\"\"Short Date\"\") IN (\"\"01/20/15\"\")\n</code></pre>\n\n<p>With that said, this will not filter your records using PIVOTS in IN statement. You need to use the WHERE clause still.</p>\n\n<p>If the end goal is to represent your data left to right then this will work. It will be a lot of extra work to make this work as a report though because your controls will not be bound to predictable columns. The Column names will change for different parameters.</p>\n\n<p>You could leave this as a traditional query (not pivoted) and have a much easier time reporting it. If you are showing users the grid directly or exporting to Excel then this is not a problem.</p>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 4500335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12b36360438d191fdfa88b3cff100a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Furbs", "link": "https://stackoverflow.com/users/4500335/furbs"}, "is_accepted": true, "score": 0, "last_activity_date": 1422638348, "creation_date": 1422638348, "answer_id": 28241234, "question_id": 28181342, "link": "https://stackoverflow.com/questions/28181342/vba-access-query-for-day-summary/28241234#28241234", "title": "VBA Access Query for Day Summary", "body": "<p>So, I just wanted to add a header to my pivot table that would tell me what date the particular column was for. \nThe part of the code that I did not show was that I was using a rec.getrows to move all of my data into a simpler array variable. While this had all the data from Access, it did not have any headers to inform me what was a tagname, what was a description, and what was which date. </p>\n\n<p>I found that in the recordset itself under fields.item(n) there was a Name attribute.  This name told me where the column data came from or the date of the data.  Using this and a simple day(date) function, I was able to make my monthly report summarizing all of the alarms.</p>\n\n<p>Thanks for your help guys, but I either was not clear in my description of the problem or it was being over thought. </p>\n"}], "owner": {"reputation": 39, "user_id": 4500335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12b36360438d191fdfa88b3cff100a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Furbs", "link": "https://stackoverflow.com/users/4500335/furbs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "accepted_answer_id": 28241234, "answer_count": 3, "score": 1, "last_activity_date": 1594193651, "creation_date": 1422398187, "last_edit_date": 1594193651, "question_id": 28181342, "link": "https://stackoverflow.com/questions/28181342/vba-access-query-for-day-summary", "title": "VBA Access Query for Day Summary", "body": "<p>I use this forum all the time for VBA help but this is the first time I have to post something myself.</p>\n\n<p>I am trying to make a report that provides a summary of various alarms stored in Access.  I want to provide a simple Count of each alarm, each day. I have used some SQL queries but not really any Access. I took the fact that Access can do Pivot tables from Access itself. If there is a better way, please let me know.</p>\n\n<pre><code>Set CommandQuery.activeConnection = conn\ncommandQuery.CommandText = _\n   \"TRANSFORM Count(FixAlarms.[Alm_NativeTimeLast]) AS CountOfAlm_NativeTimeLast \" &amp; _\n   \"SELECT FixAlarms.Alm_Tagname, FixAlarms.Alm_Desc \" &amp; _\n   \"FROM FixAlarms \" &amp; _\n   \"WHERE ((FixAlarms.Alm_Tagname) &lt;&gt; \"\"\"\")) AND FixAlarms.Alm_NativeTimeIn &gt; CellTime \" &amp; _\n   \"GROUP BY FixAlarms.[Alm_Tagname], FixAlarms.Alm_Descr \" &amp; _\n   \"PIVOT Format([Alm_NativeTimeIn],\"\"Short Date\"\")\"\nrec.Open commandQuery\n</code></pre>\n\n<p>This is the code I am using. I had to retype it, so please forgive any typo.  It does most of what I want but it does not give me any indication of what day each column is. I need a header on each column in case there were no alarms one day.  I think the answer lies within the IN part of the PIVOT but I can't get it to work without syntax errors.  I thought all I had to do was add on </p>\n\n<pre><code>PIVOT Format([Alm_NativeTimeIn],\"\"Short Date\"\") IN 01/20/15\"\n</code></pre>\n\n<p>Please help if you can.</p>\n\n<p>Thanks. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "edited": false, "score": 0, "creation_date": 1422397754, "post_id": 28181046, "comment_id": 44731699, "body": "I&#39;m trying to make sense of this code and I don&#39;t really understand what you are trying to do. Which line are you getting an error on?"}], "answers": [{"tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 0, "last_activity_date": 1422473268, "creation_date": 1422473268, "answer_id": 28200751, "question_id": 28181046, "link": "https://stackoverflow.com/questions/28181046/macro-row-and-column-copying/28200751#28200751", "title": "Macro Row and Column copying", "body": "<p>This is not an answer.  I would have asked my questions in comments except that I have documented your macro and wanted to share the result.  I should perhaps have updated your questions with the revised macro but have decided it is better to keep it separate.</p>\n\n<p>Before attempting to amend inherited code, I make sure I know exactly what it does.  If necessary, I will step through statement by statement and document each statement.  Like D_Zab, I do not understand what this code is attempting.  Is this the original code or the partially amended?  </p>\n\n<p>You say \u201ccolumn I:J and K:L\u201d and not \u201ccolumns I:L\u201d?  What is significance of this?</p>\n\n<p>In my experiments, the presence of hidden columns does not make a difference.</p>\n\n<p>I am sorry but I do not know what this means: \u201cThe aim is for it to Copy the rows above in the table on sheet 1, Row C into the next row - but I want it to copy information from above for column I:J and K:L.\u201d</p>\n\n<pre><code>Option Explicit\nSub Test()\n\n  Dim Lr As Integer\n  Dim AWFr As Long, AWLc As Long\n\n  AWFr = 14\n\n  ' Find last used row in column C of active worksheet\n  Lr = Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n\n  ' Insert row below last row in column C of active worksheet. If other\n  ' columns have values below the last used row in C, those values will\n  ' be moved down one row. The formatting (except borders) of the last\n  ' used row in C is copied to the inserted row.\n  Rows(Lr + 1).Insert Shift:=xlDown\n\n  ' Add 1 to last cell in column C of active worksheet and store in\n  ' next row down.\n  Cells(Lr + 1, \"C\") = Cells(Lr, \"C\") + 1\n\n  ' Copy formats (including borders) from last row with a value\n  ' in column C of active worksheet to next row down.\n  Rows(Lr).Copy\n  Rows(Lr + 1).PasteSpecial Paste:=xlPasteFormats\n\n  With Worksheets(\"Advisor Week\")\n\n    ' Find last used column in row 14\n    AWLc = .Cells(AWFr, .Columns.Count).End(xlToLeft).Column\n\n    ' Insert columns to move last used column in row 14, and the four\n    ' columns to its left, to the right\n    .Cells(AWFr, AWLc - 5).Resize(, 5).EntireColumn.Insert Shift:=xlToLeft\n\n    ' Set column width of first new column to half the width of character \"0\"\n    ' which is 7 pixels with Tahoma 10.5.\n    .Columns(AWLc - 5).ColumnWidth = 0.5\n\n    ' Copy the four columns to the left of the inserted columns, and the\n    ' first inserted (narrow) column, over the last four inserted columns\n    ' and the first column that was shifted right\n    .Columns(AWLc - 9).Resize(, 5).Copy Destination:=.Columns(AWLc - 4)\n\n    Application.CutCopyMode = False\n\n  End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4492692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c48d522fec41f1e056870a36cd473a4?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Courtnage", "link": "https://stackoverflow.com/users/4492692/dan-courtnage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1422894166, "creation_date": 1422396884, "last_edit_date": 1422894166, "question_id": 28181046, "link": "https://stackoverflow.com/questions/28181046/macro-row-and-column-copying", "title": "Macro Row and Column copying", "body": "<p>Struggling to get my head round this Macro and why it won't work.</p>\n\n<p>I've picked up off someone else and every time I try and edit it, it comes back to De-Bug.</p>\n\n<p>The aim is for it to Copy the rows above in the table on sheet 1, Row C into the next row - but I want it to copy information from above for column I:J and K:L.</p>\n\n<p>Also, when the columns are copied and inserted in on \"Advisor Week\", the code has been made with columns which I want to have Hidden, so when ran when the columns are hidden, it doesn't work correctly.</p>\n\n<pre><code>Dim Lr As Integer\nDim AWFr As Long, AWLc As Long\n\nAWFr = 14\n\nLr = Range(\"C\" &amp; Rows.Count).End(xlUp).Row\nRows(Lr + 1).Insert Shift:=xlDown\nCells(Lr + 1, \"C\") = Cells(Lr, \"C\") + 1\nRows(Lr).Copy\nRows(Lr + 1).PasteSpecial Paste:=xlPasteFormats\n\nWith Worksheets(\"Advisor Week\")\n\n    AWLc = .Cells(AWFr, .Columns.Count).End(xlToLeft).Column\n    .Cells(AWFr, AWLc - 5).Resize(, 5).EntireColumn.Insert Shift:=xlToLeft\n    .Columns(AWLc - 5).ColumnWidth = 0.5\n    .Columns(AWLc - 9).Resize(, 5).Copy Destination:=.Columns(AWLc - 4)\n    Application.CutCopyMode = False\n\nEnd With\n</code></pre>\n\n<p>I can happily send images if needed but don't have enough Rep to post on here</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1422394894, "post_id": 28180482, "comment_id": 44730172, "body": "It did not work because VBA <a href=\"http://stackoverflow.com/q/24641923/11683\">does not short circuit</a>."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 3516528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V7JBE.jpg?s=128&g=1", "display_name": "Amanzaloko", "link": "https://stackoverflow.com/users/3516528/amanzaloko"}, "edited": false, "score": 0, "creation_date": 1422396545, "post_id": 28180829, "comment_id": 44731041, "body": "Thanks, @Chrismas007!! I was looking into the short-circuiting tip and working out a solution, but your code came in faster. And it works perfectly."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1422397356, "post_id": 28180829, "comment_id": 44731485, "body": "<code>WorksheetFunction.CountA(cl) &lt;&gt; 0</code> is a rather obscure way to check if the cell is not empty, there is <code>Not IsEmpty(cl.Value)</code> for that. However both <code>CountA</code> and <code>IsEmpty</code> will treat empty strings as non-empty values, as opposed to true blanks, so the condition should really be <code>If Len(cl.Value) &lt;= 255 an Len(cl.Value) &gt; 0</code>."}], "tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": true, "score": 1, "last_activity_date": 1422454818, "last_edit_date": 1422454818, "creation_date": 1422395882, "answer_id": 28180829, "question_id": 28180482, "link": "https://stackoverflow.com/questions/28180482/application-checkspelling-fails-on-cells-with-255-chars/28180829#28180829", "title": "Application.CheckSpelling Fails on Cells with &gt; 255 Chars", "body": "<p>You have to nest to check the length of cell first.  I also added in a check for blank cells so you can bypass blanks (should speed up code).</p>\n\n<pre><code>Sub Cellswithtypos()\nFor Each cl In ActiveSheet.UsedRange.Range(\"E5:E20000\").Cells\n    If Len(cl.Value) &lt;= 255 And Len(cl.Value) &gt; 0 Then\n        If Not Application.CheckSpelling(Word:=cl.Text) Then\n            cl.Interior.ColorIndex = 18\n        End If\n    End If\nNext cl\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 3516528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V7JBE.jpg?s=128&g=1", "display_name": "Amanzaloko", "link": "https://stackoverflow.com/users/3516528/amanzaloko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 619, "favorite_count": 0, "accepted_answer_id": 28180829, "answer_count": 1, "score": 0, "last_activity_date": 1422454818, "creation_date": 1422394615, "last_edit_date": 1422395935, "question_id": 28180482, "link": "https://stackoverflow.com/questions/28180482/application-checkspelling-fails-on-cells-with-255-chars", "title": "Application.CheckSpelling Fails on Cells with &gt; 255 Chars", "body": "<p>I'm trying to write a macro that will highlight any cells in the range e5:e20000 that have a spelling error. I get a \"runtime error 113\" every time I hit a cell with more than 255 characters in it. I tried adding a condition to skip +255 char cells, but it's not really working.</p>\n\n<p>Ideally, I want to include all cells, regardless of the character number.\nAny advice? Thanks!</p>\n\n<pre><code>Sub Cellswithtypos()\nFor Each cl In ActiveSheet.UsedRange.Range(\"E5:E20000\").Cells\n    If Len(cl.Value) &lt;= 255 And Not Application.CheckSpelling(Word:=cl.Text) Then _\ncl.Interior.ColorIndex = 18\nNext cl\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1422393409, "post_id": 28179994, "comment_id": 44729383, "body": "<i>where</i> is the runtime error?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1422393862, "post_id": 28179994, "comment_id": 44729639, "body": "Guess: You do not have a reference to Microsoft Scripting Runtime library. Select Tools then References. Is &quot;Microsoft Scripting Runtime&quot; near the top and ticked?  If not, scroll down and tick it.  Without it, &quot;FileSystemObject&quot; is undefined."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1422394454, "post_id": 28179994, "comment_id": 44729946, "body": "Another guess.  You are using a release later than 2007.  FileSearch was only available up to 2007.  See for example:  <a href=\"http://www.mrexcel.com/forum/excel-questions/643288-excel-2010-visual-basic-applications-replacement-application-filesearch.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1422441263, "post_id": 28181734, "comment_id": 44747810, "body": "Please, when you downvote an answer leave also a comment, especially if it works. It&#39;s not the first time over the last 24 hours and I&#39;m starting to think about serial downvoting (also imagining the reason)."}, {"owner": {"reputation": 2939, "user_id": 3831571, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0eikM.jpg?s=128&g=1", "display_name": "Isthatso", "link": "https://stackoverflow.com/users/3831571/isthatso"}, "edited": false, "score": 0, "creation_date": 1422448561, "post_id": 28181734, "comment_id": 44751878, "body": "this answer shows a lot of effort, especially detecting what&#39;s causing error on OP&#39;s code, I also wonder why this got a downvote.."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 2939, "user_id": 3831571, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0eikM.jpg?s=128&g=1", "display_name": "Isthatso", "link": "https://stackoverflow.com/users/3831571/isthatso"}, "edited": false, "score": 0, "creation_date": 1422450790, "post_id": 28181734, "comment_id": 44753243, "body": "Thank you @Fev, I never think even a complex answer cannot get downvotes (there might be many reasons and I would be happy to learn them), but I was wondering because since yesterday it happened already on other of my answers and all this after a debate where another user and I were not agreeing on a behavioral thing ;)"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "reply_to_user": {"reputation": 2939, "user_id": 3831571, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0eikM.jpg?s=128&g=1", "display_name": "Isthatso", "link": "https://stackoverflow.com/users/3831571/isthatso"}, "edited": false, "score": 2, "creation_date": 1422455265, "post_id": 28181734, "comment_id": 44756202, "body": "@Fev and MatteoNNZ I assume this got a downvote because the question should be VTC for Unclear.  Some people don&#39;t like supporting quality answers to substandard questions (although there was winter hats and badges that reward people for doing so)"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1422456256, "post_id": 28181734, "comment_id": 44756850, "body": "@Chrismas007 thank you, it might be that. I&#39;ve personally got nothing against this (something against the serial downvoting, though), but I would just like a comment to be left :)"}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 2, "last_activity_date": 1517236082, "last_edit_date": 1517236082, "creation_date": 1422400102, "answer_id": 28181734, "question_id": 28179994, "link": "https://stackoverflow.com/questions/28179994/object-doesnt-support-this-option-error-445-in-vb-code/28181734#28181734", "title": "&quot;Object doesn&#39;t support this option&quot; Error 445 in VB Code", "body": "<p>To get some help, you need to specify <em>where</em> you get the error. This time you've been lucky, I've recognized an error I went through some time ago. </p>\n\n<h2>Cause of the error</h2>\n\n<pre><code>With Application.FileSearch\n</code></pre>\n\n<h2>Error description</h2>\n\n<blockquote>\n  <p>Run-time error 445: Object doesn't support this option</p>\n</blockquote>\n\n<h2>Cause</h2>\n\n<p>The method has been removed since > Excel 2003. In later versions, in fact, the method has just been removed because of stability-security reasons.  </p>\n\n<h2>Work-around</h2>\n\n<p>Someone (not me, I've just come through it for a replacement I quickly had to do) didn't accept this change and has developed some alternative functions to embed in you VBA project and keep on using an \"almost-the-same\" approach. There are several through the web (by simply browsing <em>alternative solutions to FileSearch after Excel 2003</em>, <a href=\"http://www.mrexcel.com/forum/excel-questions/643288-excel-2010-visual-basic-applications-replacement-application-filesearch.html#\" rel=\"nofollow noreferrer\">here</a> you find the solution I've implemented successfully; clearly you need to adapt it to your code but this is the way to go if you want to keep on using your current approach. </p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10542227, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/de608e522d0e2a37e5e2558dfbe3bb46?s=128&d=identicon&r=PG", "display_name": "owais khan", "link": "https://stackoverflow.com/users/10542227/owais-khan"}, "is_accepted": false, "score": 1, "last_activity_date": 1540279971, "last_edit_date": 1540279971, "creation_date": 1540232587, "answer_id": 52935520, "question_id": 28179994, "link": "https://stackoverflow.com/questions/28179994/object-doesnt-support-this-option-error-445-in-vb-code/52935520#52935520", "title": "&quot;Object doesn&#39;t support this option&quot; Error 445 in VB Code", "body": "<p>, i think there is a solution for most of the apps and some very old game having this <strong>error:run-time 445</strong>, in windows 8 , or 10 architecture . credit goes to <strong>Microsoft</strong> , they had include a function in open menu while <em>right click on an app</em> you want to open, there is \"<strong>troubleshoot compatibility</strong>\" just run it .\n<strong><em>it helped me</em></strong>, so may be it would help you too. \nits because of the software or games build in very old versions of VB, which are not supported by today's OS's.</p>\n"}], "owner": {"reputation": 21, "user_id": 4500403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50ee79d2f0d852de6b57a0ffbb92434?s=128&d=identicon&r=PG&f=1", "display_name": "agirlinva", "link": "https://stackoverflow.com/users/4500403/agirlinva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6527, "favorite_count": 0, "accepted_answer_id": 28181734, "answer_count": 2, "score": -2, "last_activity_date": 1540279971, "creation_date": 1422392777, "last_edit_date": 1531164843, "question_id": 28179994, "link": "https://stackoverflow.com/questions/28179994/object-doesnt-support-this-option-error-445-in-vb-code", "title": "&quot;Object doesn&#39;t support this option&quot; Error 445 in VB Code", "body": "<p>I am trying to make this code work. It gives the runtime error. Any help on how to fix it will be much appreciated. I am putting this code together to retain the files for record retention and I am no that much of a programmer. Thank you.</p>\n\n<p>The error is in the file search method.   </p>\n\n<pre><code>  Option Explicit\n    Sub PopulateDirectoryList()\n'dimension variables\n        Dim objFSO As FileSystemObject, objFolder As Folder\nDim objFile As File, strSourceFolder As String, x As Long, i As Long\nDim wbNew As Workbook, wsNew As Worksheet\n\nToggleStuff False 'turn of screenupdating\n\nSet objFSO = New FileSystemObject  'set a new object in memory\nstrSourceFolder = BrowseForFolder 'call up the browse for folder routine\nIf strSourceFolder = \"\" Then Exit Sub\n\nWorkbooks.Add 'create a new workbook\n\nSet wbNew = ActiveWorkbook\nSet wsNew = wbNew.Sheets(1) 'set the worksheet\nwsNew.Activate\n'format a header\nWith wsNew.Range(\"A1:F1\")\n    .Value = Array(\"File\", \"Size\", \"Modified Date\", \"Last Accessed\", \"Created Date\", \"Full Path\", \"Size\")\n    .Interior.ColorIndex = 7\n    .Font.Bold = True\n    .Font.Size = 12\nEnd With\n\n***With Application.FileSearch*** 'ERROR\n    .LookIn = strSourceFolder  'look in the folder browsed to\n   .FileType = msoFileTypeAllFiles 'get all files\n    .SearchSubFolders = True  'search sub directories\n    .Execute\n\n For x = 1 To .FoundFiles.Count 'for each file found, by the count (or index)\n       i = x 'make the variable i = x\n       If x &gt; 60000 Then  'if there happens to be more than multipls of 60,000 files, then add a new sheet\n          i = x - 60000  'set i to the right number for row placement below\n          Set wsNew = wbNew.Sheets.Add(after:=Sheets(wsNew.Index))\n          With wsNew.Range(\"A1:F1\")\n            .Value = Array(\"File\", \"Parent Folder\", \"Full Path\", \"Modified Date\", _\n                                               \"Last Accessed\", \"Size\")\n            .Interior.ColorIndex = 7\n            .Font.Bold = True\n            .Font.Size = 12\n           End With\n\n       End If\n        On Error GoTo Skip 'in the event of a permissions error\n\n        Set objFile = objFSO.GetFile(.FoundFiles(x)) 'set the object to get it's properties\n         With wsNew.Cells(1, 1) 'populate the next row with the variable data\n             .Offset(i, 0) = objFile.Name\n             .Offset(i, 1) = Format(objFile.Size, \"0,000\") &amp; \" KB\"\n             .Offset(i, 2) = objFile.DateLastModified\n             .Offset(i, 3) = objFile.DateLastAccessed\n             .Offset(i, 4) = objFile.DateCreated\n             .Offset(i, 5) = objFile.Path\n\n         End With\n          ' Next objFile\nSkip:\n'this is in case a Permission denied error comes up or an unforeseen error\n'Do nothing, just go to next file\n     Next x\nwsNew.Columns(\"A:F\").AutoFit\n\nEnd With\n\n'clear the variables\nSet objFolder = Nothing\nSet objFile = Nothing\nSet objFSO = Nothing\nSet wsNew = Nothing\nSet wbNew = Nothing\n\nToggleStuff True 'turn events back on\nEnd Sub\nSub ToggleStuff(ByVal x As Boolean)\nApplication.ScreenUpdating = x\nApplication.EnableEvents = x\nEnd Sub\n\n\nFunction BrowseForFolder(Optional OpenAt As Variant) As Variant\n    '''Code from kpuls, www.VBAExpress.com..portion of Knowledge base submission\n\n  Dim ShellApp As Object\n  Set ShellApp = CreateObject(\"Shell.Application\"). _\n    BrowseForFolder(0, \"Please choose a folder\", 0, OpenAt)\n\n    On Error Resume Next\n    BrowseForFolder = ShellApp.self.Path\n    On Error GoTo 0\n\n    Set ShellApp = Nothing\n\n    Select Case Mid(BrowseForFolder, 2, 1)\n        Case Is = \":\"\n            If Left(BrowseForFolder, 1) = \":\" Then GoTo Invalid\n        Case Is = \"\\\"\n            If Not Left(BrowseForFolder, 1) = \"\\\" Then GoTo Invalid\n        Case Else\n            GoTo Invalid\n        End Select\n    Exit Function\n\nInvalid:\n\n\nToggleStuff True\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "email", "if-statement", "hyperlink"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1422445630, "creation_date": 1422445630, "answer_id": 28191499, "question_id": 28179915, "link": "https://stackoverflow.com/questions/28179915/excel-vba-send-email-with-hyperlink-and-variable-cell-value/28191499#28191499", "title": "Excel/VBA send email with hyperlink and variable cell value", "body": "<p>There are three main way for customizing the message body. </p>\n\n<ol>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff865304(v=office.15).aspx\" rel=\"nofollow\">Body</a> - doesn't allows to add hyperlinks, only a raw text is acceptable.</li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff868941(v=office.15).aspx\" rel=\"nofollow\">HTMLBody</a> - HTML markup can be used to customize the body.</li>\n<li>Word editor - the Word object model can be used to customize the body. The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff868196(v=office.15).aspx\" rel=\"nofollow\">WordEditor</a> property returns an instance of the Word document which represents the message body. </li>\n</ol>\n\n<p>As you may see, you can use the #2 or #3 option to get the job done.</p>\n\n<p>You can read more about these ways in the <a href=\"https://msdn.microsoft.com/en-us/library/dd492012%28v=office.12%29.aspx\" rel=\"nofollow\">Chapter 17: Working with Item Bodies</a> article in MSDN. </p>\n\n<blockquote>\n  <p>1.I would like in the email to have the text \"check list\" by hyperlinked to http://\"linktospreadsheet\".html</p>\n</blockquote>\n\n<p>You can add hyperlink using the HTML markup (<code>&lt;a href=\"web_address_here\"/&gt;</code>) or by using the Word object model (see <code>Hyperlinks.Add</code>).</p>\n\n<blockquote>\n  <p>2.The expiration date in the email text needs to be a variable value, dependent on a value within the linked spreadsheet.</p>\n</blockquote>\n\n<p>You can add any information at runtime to the message body. Please refer to the #2 and #3 options described above.</p>\n"}], "owner": {"reputation": 15, "user_id": 4500383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36c49db6c5dadcff05dc395c1a06485?s=128&d=identicon&r=PG&f=1", "display_name": "Hawth33", "link": "https://stackoverflow.com/users/4500383/hawth33"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1365, "favorite_count": 0, "closed_date": 1602475984, "answer_count": 1, "score": 0, "last_activity_date": 1594193577, "creation_date": 1422392516, "last_edit_date": 1594193577, "question_id": 28179915, "link": "https://stackoverflow.com/questions/28179915/excel-vba-send-email-with-hyperlink-and-variable-cell-value", "closed_reason": "Needs details or clarity", "title": "Excel/VBA send email with hyperlink and variable cell value", "body": "<p>I have set up a standard module in workbook to send me an email. I am now stuck on two portions.</p>\n\n<ol>\n<li>I would like in the email to have the text \"check list\" by hyperlinked to http://\"linktospreadsheet\".html.</li>\n<li>The expiration date in the email text needs to be a variable value, dependent on a value within the linked spreadsheet.</li>\n</ol>\n\n<p>Also, can someone provide a guide on how to execute this module when the items expiration date is actually approaching? Below is the code:</p>\n\n<pre><code>Option Explicit\n\n  Sub Mail_small_Text_Outlook()\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim strbody As String\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    strbody = \"A plan is now # days from expiring\" &amp; vbNewLine &amp; vbNewLine &amp; _\n              \"Please view the check list for details.\" &amp; vbNewLine &amp; vbNewLine &amp; _\n              \"http://linktospreadsheet.html\"\n    On Error Resume Next\n    With OutMail\n        .To = \"name@email.com\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"Subject\"\n        .Body = strbody\n        .Attachments.Add (\"C:\\test.txt\")\n        .Send\n    End With\n    On Error GoTo 0\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1422390708, "post_id": 28179158, "comment_id": 44727930, "body": "What is the <b>Active</b> worksheet when you run this macro? Your <code>Case</code> switch is using ambiguously named <code>Range(&quot;A&quot; &amp; r).Value</code> which refers to the ActiveWorksheet. If you step through your code, what do you observe happening at the Case switch?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1422390772, "post_id": 28179158, "comment_id": 44727964, "body": "Likewise, <code>Rows(r).Copy</code> also refers tot he <i>Active</i> worksheet, so does <code>Rows.Count</code>, etc.. Whenever working with multiple worksheet or workbook objects, it is much easier to declare proper variables to represent and keep track of each, and <b>fully-qualify</b> your range objects. :)"}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 2726884, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2224c9d583aece900316d44f4dc51552?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/2726884/ian"}, "edited": false, "score": 0, "creation_date": 1422391273, "post_id": 28179423, "comment_id": 44728230, "body": "This was perfect. Thank you! I am very new to VBA and each new success is a great feeling!"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 1, "last_activity_date": 1422390694, "creation_date": 1422390694, "answer_id": 28179423, "question_id": 28179158, "link": "https://stackoverflow.com/questions/28179158/vba-copy-rows-from-one-worksheet-to-another-syntax-error/28179423#28179423", "title": "VBA Copy Rows from One worksheet to Another (Syntax error?)", "body": "<p>looks like you are just trying to find the word \"Hire\" in Column A and paste the row to another sheet.</p>\n\n<p>This may work better for you.</p>\n\n<pre><code>Sub Button1_Click()\n    Dim sh As Worksheet, ws As Worksheet\n    Dim rws As Long, rng As Range, c As Range\n\n    Set ws = Worksheets(\"AUTO\")\n    Set sh = Worksheets(\"Master\")\n\n    With sh\n        rws = .Cells(Rows.Count, \"A\").End(xlUp).Row\n        Set rng = .Range(.Cells(1, 1), .Cells(rws, 1))\n    End With\n\n    For Each c In rng.Cells\n        If c = \"Hire\" Then\n            c.EntireRow.Copy Destination:=ws.Cells(Rows.Count, \"A\").End(xlUp).Offset(1)\n        End If\n    Next c\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 2726884, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2224c9d583aece900316d44f4dc51552?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/2726884/ian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1884, "favorite_count": 0, "accepted_answer_id": 28179423, "answer_count": 1, "score": 0, "last_activity_date": 1422894191, "creation_date": 1422389679, "last_edit_date": 1422894191, "question_id": 28179158, "link": "https://stackoverflow.com/questions/28179158/vba-copy-rows-from-one-worksheet-to-another-syntax-error", "title": "VBA Copy Rows from One worksheet to Another (Syntax error?)", "body": "<p>I have data on one worksheet named \"Master\" that I am trying to conditionally copy over each row to a workbook called \"Auto\" based on whether the original row has \"Hire\" in column A.</p>\n\n<pre><code>Sub Macro2()\nDim lr As Long, lr2 As Long, r As Long\nlr = Sheets(\"Master\").Cells(Rows.Count, \"A\").End(xlUp).Row\nlr2 = Sheets(\"AUTO\").Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    For r = lr To 2 Step -1\n        Select Case Range(\"A\" &amp; r).Value\n           Case Is = \"Hire\"\n           Rows(r).Copy Destination:=Sheets(\"AUTO\").Range(\"A\" &amp; lr2 + 1)\n            lr2 = Sheets(\"AUTO\").Cells(Rows.Count, \"A\").End(xlUp).Row\n        End Select\n    Next r\nEnd Sub\n</code></pre>\n\n<p>When I run the macro, however, it does not populate the second worksheet. </p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 1, "last_activity_date": 1422390441, "creation_date": 1422390441, "answer_id": 28179366, "question_id": 28179066, "link": "https://stackoverflow.com/questions/28179066/access-vba-getobject/28179366#28179366", "title": "Access VBA Getobject()", "body": "<p>Include the <code>.Application</code> property with <code>GetObject</code>.</p>\n\n<p>Here's a simple example tested on my system.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim appXL As Object\nDim txtcatpath As String\ntxtcatpath = \"C:\\Users\\hans\\Documents\\compensation.xlsx\"\nSet appXL = GetObject(txtcatpath).Application\nDebug.Print appXL.activeworkbook.Name\n</code></pre>\n\n<p>With that workbook already opened in Excel, running the code gives me the workbook name, <em>compensation.xlsx</em>, in the Immediate window.</p>\n"}], "owner": {"reputation": 875, "user_id": 3612914, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/26500b9a2376eaf42a510a6c137ffe43?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/3612914/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4727, "favorite_count": 0, "accepted_answer_id": 28179366, "answer_count": 1, "score": 2, "last_activity_date": 1422390465, "creation_date": 1422389302, "last_edit_date": 1422390465, "question_id": 28179066, "link": "https://stackoverflow.com/questions/28179066/access-vba-getobject", "title": "Access VBA Getobject()", "body": "<p>I'm trying to set an instance of already opened excel to an object in access vba, but it is not working and when i'm running the code no error message is showing but control is  coming out the sub.</p>\n\n<p>here is the code </p>\n\n<pre><code>  Dim appXL As Object\n  Dim wb As Object\n  Dim txtcatpath As String\n  txtcatpath = \"C:\\sample.xlsm\"\n  Set appXL = GetObject(,txtcatpath)\n</code></pre>\n\n<p>how do i set object as referernce to already opened excel? </p>\n"}, {"tags": ["vba", "internet-explorer", "excel", "imacros"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 58628, "user_id": 227267, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b03410a67ad6b9cf3fce7b0bf45084c8?s=128&d=identicon&r=PG", "display_name": "Matti Virkkunen", "link": "https://stackoverflow.com/users/227267/matti-virkkunen"}, "edited": false, "score": 3, "creation_date": 1422387330, "post_id": 28178272, "comment_id": 44726195, "body": "@MattiVirkkunen, nobody knows a thing before to learn it. If you think there&#39;s a better approach, then you might use the comments to suggest it. But commenting just &quot;this is a horrible approach, I want to quit my job&quot; sounds to me really impolite to the asker who developed it and not complying with the community standards. Please go back to the old times and think that maybe you would have done the same mistakes before gaining experience."}, {"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1422466636, "post_id": 28178272, "comment_id": 44763857, "body": "@Chrismas007....Thanks for the comments.  I really appreciate this forum.  You are right.  You don&#39;t know what you don&#39;t know.  I come here to try and learn better ways to do things as I am mainly self-taught.  However, some of the comments are rude and impolite when someone is just trying to get some information.  I don&#39;t know why someone would waste their time in writing something that adds no value.  Thanks..."}], "answers": [{"comments": [{"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 0, "creation_date": 1422466192, "post_id": 28180918, "comment_id": 44763577, "body": "Thanks.........We have had to uninstall that Microsoft update before using a different macro.  The funny thing is that that update keeps getting installed on our machines, even after it is removed.  Our IT department is currently looking for a solution to keep it from re-installing.  I&#39;ll check to see and make sure that it is uninstalled before running that macro again."}, {"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 0, "creation_date": 1422466693, "post_id": 28180918, "comment_id": 44763892, "body": "Once I get a chance to test it, I sure will"}], "tags": [], "owner": {"reputation": 2020, "user_id": 4327668, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ATSJq.png?s=128&g=1", "display_name": "Roman Canlas", "link": "https://stackoverflow.com/users/4327668/roman-canlas"}, "is_accepted": true, "score": 0, "last_activity_date": 1422396325, "creation_date": 1422396325, "answer_id": 28180918, "question_id": 28178272, "link": "https://stackoverflow.com/questions/28178272/imacros-10-macro-has-stopped-working-after-upgrade-from-imacros-9/28180918#28180918", "title": "iMacros 10 macro has stopped working after upgrade from iMacros 9", "body": "<p>I don't think the issue is in the code. As you've said, the code works fine and so the only thing that changed is the version of the browser and iMacro.</p>\n\n<p>An IE11 update possibly could have broken your macro:</p>\n\n<p><a href=\"http://imacros.net/microsoft-update-for-ie11-kb3025390-breaks-tag-command-in-imacros-for-ie\" rel=\"nofollow\">http://imacros.net/microsoft-update-for-ie11-kb3025390-breaks-tag-command-in-imacros-for-ie</a></p>\n\n<blockquote>\n  <p>If you must use iMacros with IE11, another workaround is to uninstall\n  Microsoft update KB3025390. This is a non-security related update, so\n  uninstalling it will not put IE in any greater risk.</p>\n</blockquote>\n"}], "owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 710, "favorite_count": 0, "accepted_answer_id": 28180918, "answer_count": 1, "score": 0, "last_activity_date": 1422396325, "creation_date": 1422386235, "last_edit_date": 1422395304, "question_id": 28178272, "link": "https://stackoverflow.com/questions/28178272/imacros-10-macro-has-stopped-working-after-upgrade-from-imacros-9", "title": "iMacros 10 macro has stopped working after upgrade from iMacros 9", "body": "<p>I have a macro using (Excel VBA) that goes through out invoice application.  The macro opens an invoice and extracts information on a number of different screens.  It then closes the invoice, looks for the word \"reservation\" on the next screen.  Once it finds \"reservation, it should open the next ticket.  </p>\n\n<p>With IE 8 / iMacros 9, the macro did not encounter any issue.  However, recently, we were upgraded to IE 11 and iMacros 10.  When users run the macro now, they can get a \"iMacros has stopped working.  A problem caused the program to stop working correctly.  Please close the program.\" message.</p>\n\n<p>Following is the loop where the macro is looking for the word \"reservation\".  this appears to be the place where the error / problem occurs.</p>\n\n<pre><code>lCnt = 0\nvpagehead = \"\"\n\nDo Until InStr(1, vpagehead1, \"Reservation Number\") &gt; 0 Or InStr(1, vpagehead1, \"servation:\") &gt; 0 Or lCnt = 25\n\n    IM = \"\"\n    IM = \"CODE:\"\n    IM = IM + \"TAB T=1\" + vbNewLine\n    IM = IM + \"TAB CLOSEALLOTHERS\" + vbNewLine\n    IM = IM + \"FRAME NAME=ReservationDetailFrame\" + vbNewLine\n    IM = IM + \"SET !TIMEOUT_STEP 10\" + vbNewLine\n    IM = IM + \"TAG POS=11 TYPE=TD ATTR=* EXTRACT=TXT\" + vbNewLine\n    IM = IM + \"WAIT SECONDS=1\" + vbNewLine\n\n    iret = iim1.iimPlay(IM)\n\n    vpagehead1 = iim1.iimGetLastExtract\n    lCnt = lCnt + 1\n\nLoop\n</code></pre>\n\n<p>Does anyone see any reason why this code would cause an issue that would cause iMacros to close?</p>\n\n<p>Thanks for the help..........</p>\n"}, {"tags": ["vba", "internet-explorer", "excel"], "answers": [{"tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 0, "last_activity_date": 1422386705, "creation_date": 1422386705, "answer_id": 28178406, "question_id": 28178056, "link": "https://stackoverflow.com/questions/28178056/using-internetexplorer-application-in-vba/28178406#28178406", "title": "Using InternetExplorer.Application in VBA", "body": "<p>I think that an easier way of doing what you're trying to do is to get the Username and the Password through an <code>InputBox</code> (or a custom User Form, if you want to make it fancier). This is the idea:</p>\n\n<pre><code>Public Sub Main()\n'get username and password through input boxes\nusername = InputBox(\"Type your username\")\npassword = InputBox(\"Type your password\")\nNavigateToUrl(argURL, username, password)\nEnd Sub   \n\nPublic Sub NavigateToURL(ByVal argURL As String, ByVal username As String, ByVal password As String)\n    Dim objIE As Object\n    Set objIE = CreateObject(\"InternetExplorer.Application\")\n    With objIE\n        .Visible = True\n        .Silent = True\n        .Navigate argURL\n\n    Do While .Busy\n        DoEvents 'wait for the page to load\n    Loop\n\n    'you will have to revise the below lines according to the HTML of the document\n    .document.getElementById(\"username\").Value = username \n    .document.getElementById(\"password\").Value = password\n    .document.getElementById(\"login-button\").Click\n    End With\nEnd Sub\n</code></pre>\n\n<p>Like this (it is the idea clearly, you need to work on the HTML objects) you will be able not to hardcode username and password but avoiding checking the Internet Explorer external thread. </p>\n"}], "owner": {"reputation": 93, "user_id": 4450876, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8bb6627537711f2a79258a3864bbf287?s=128&d=identicon&r=PG&f=1", "display_name": "Amelie Peter", "link": "https://stackoverflow.com/users/4450876/amelie-peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3264, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1422413184, "creation_date": 1422385534, "last_edit_date": 1422413184, "question_id": 28178056, "link": "https://stackoverflow.com/questions/28178056/using-internetexplorer-application-in-vba", "title": "Using InternetExplorer.Application in VBA", "body": "<p>I am trying to build a simple macro, which enable user to select required rows from an excel sheet and export it to a web service. The macro should be able to authenticate the user with username and password to make sure that he has permission to upload the data. When the user selects the required row, IE opens authentication page of web service. I am currently trying to capture the url change when the user log in successfully to the web service to verify the credentials.</p>\n\n<p>Is there a better way to authenticate the user? I settled in for authenticating using websites main log in page , as I don't want to send the username and password through the script.</p>\n\n<p>Here is how my code look like:</p>\n\n<pre><code>Call NavigateToURL(--url of login page--) \n\nPublic Sub NavigateToURL(ByVal argURL As String)\n\nDim objIE As Object\n\nSet objIE = CreateObject(\"InternetExplorer.Application\")\n\nWith objIE\n.Visible = True\n.Silent = True\n.Navigate argURL\n\nDo Until objIE.LocationURL() = (--url after successfull log in--)\n DoEvents\n\nLoop\n\nIf n = (---url after successful log in--) Then\n    objIE.Navigate (--redirect to another url)\n\nElse\n    MsgBox (\"Sorry. Authentication Failed.\")\nEnd If\n</code></pre>\n\n<p>But the part after the Do-Until Loop is not working properly. Can any body point out where I have gone wrong? </p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 180, "user_id": 4236677, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EMte0.jpg?s=128&g=1", "display_name": "Zegad", "link": "https://stackoverflow.com/users/4236677/zegad"}, "edited": false, "score": 0, "creation_date": 1422456490, "post_id": 28186427, "comment_id": 44757006, "body": "It works great until the next element in the loop, and shows <i>&quot;run time error &#39;5941&#39; the requested member of the collection does not exist&quot;</i> the debugger points to the IF conditional statement, any ideas"}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "reply_to_user": {"reputation": 180, "user_id": 4236677, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EMte0.jpg?s=128&g=1", "display_name": "Zegad", "link": "https://stackoverflow.com/users/4236677/zegad"}, "edited": false, "score": 0, "creation_date": 1422515444, "post_id": 28186427, "comment_id": 44782430, "body": "@Zegad, you right, I assumed that there is ContentControl in each cell in column 3. So, I made some imporvments- see in my answer."}, {"owner": {"reputation": 180, "user_id": 4236677, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EMte0.jpg?s=128&g=1", "display_name": "Zegad", "link": "https://stackoverflow.com/users/4236677/zegad"}, "edited": false, "score": 0, "creation_date": 1422542580, "post_id": 28186427, "comment_id": 44798111, "body": "Works great! I will try to improve it to different layouts (as empty cells at the end or merged cells)"}], "tags": [], "owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "is_accepted": true, "score": 1, "last_activity_date": 1422515397, "last_edit_date": 1422515397, "creation_date": 1422428422, "answer_id": 28186427, "question_id": 28178001, "link": "https://stackoverflow.com/questions/28178001/loop-trought-content-controls-checkbox-inside-different-tables/28186427#28186427", "title": "Loop trought Content Controls Checkbox inside different tables", "body": "<p>Zegad, you were very close. Below you find your code improved including some comments and explanations.</p>\n\n<pre><code>Public Sub VerifyCheckBox()\n\n\nApplication.ScreenUpdating = False\n\nDim lastCC As Long, totalRows As Long, nRow As Long\nDim test1 As String\nDim nTbl As Table\nDim thisCell As Range\n\nFor Each nTbl In ActiveDocument.Tables 'Loop Trough the tables in the document\n\n        totalRows = nTbl.Rows.Count 'Total number of rows in the selected table\n\n        'why do you start as of four if your headers are 2nd and data start as of 3rd?\n        For nRow = 3 To totalRows\n            'you don't need this if you have 'complete' column as a third one\n            'you would need something similar if 'complete' could be in different column\n            'If nTbl.Cell(nRow, 3).Range = \"Complete\" Then\n        'NEW! let's check first if there is any ContentControl in cell    \n        If nTbl.Cell(nRow, 3).Range.ContentControls.Count &gt; 0 Then\n            'I assume that you have only one ContentControl per cell\n            If nTbl.Cell(nRow, 3).Range.ContentControls(1).Type = wdContentControlCheckBox _\n                    And nTbl.Cell(nRow, 3).Range.ContentControls(1).Checked = False Then\n                    'if you want to select do it in this way\n                    Set thisCell = nTbl.Cell(nRow, 3).Range\n                    thisCell.Select\n                MsgBox \"Review element:  \" &amp; nTbl.Cell(nRow, 1).Range &amp; nTbl.Cell(nRow, 2).Range\n            End If\n            End If\n            'End If\n        Next nRow\n\n\nNext\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 180, "user_id": 4236677, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EMte0.jpg?s=128&g=1", "display_name": "Zegad", "link": "https://stackoverflow.com/users/4236677/zegad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1415, "favorite_count": 0, "accepted_answer_id": 28186427, "answer_count": 1, "score": 1, "last_activity_date": 1495313578, "creation_date": 1422385268, "last_edit_date": 1422456759, "question_id": 28178001, "link": "https://stackoverflow.com/questions/28178001/loop-trought-content-controls-checkbox-inside-different-tables", "title": "Loop trought Content Controls Checkbox inside different tables", "body": "<p>I have document with multiple tables in it(as seen in the attached image), so I try to verify only the field with the status  in the column \"complete\", those that are not selected (False)to work in it and continue reviewing one by one. So far my main problem is to retrieve the value from those specific content controls on those cells because I haven,t found the method/function to do it.</p>\n\n<p><img src=\"https://i.stack.imgur.com/U0kxu.png\" alt=\"Table 1 of n\"></p>\n\n<p>So my VBA code so far (and wrong btw) is this, any scope in how to retrieve a value of content control in a selected cell inside... (I fell like inception jk an element inside an element inside another element, we need to go deeper...)</p>\n\n<pre><code>Public Sub VerifyCheckBox()\nApplication.ScreenUpdating = False\n\nDim lastCC As Long, totalRows As Long, nRow As Long\nDim test1 As String\nDim nTbl As Table\nDim thisCell As Range\n\n'lastCC = ActiveDocument.Content.ContentControls.Count\n'test1 = ActiveDocument.Content.ContentControls(1).Type = wdContentControlCheckBox\n'MsgBox \"Found  \" &amp; lastCC &amp; \"  Content Controls  \" &amp; \"  First checkbox...  \" &amp; test1\n\nFor Each nTbl In ActiveDocument.Tables 'Loop Trough the tables in the document\n    If nTbl.Cell(nRow, 3).Range = \"Complete\" Then\n\n        totalRows = nTbl.Rows.Count 'Total number of rows in the selected table\n\n        For nRow = 3 To totalRows\n            If nTbl.Cell(nRow, 3).Content.ContentControl.Type = wdContentControlCheckBox And nTbl.Cell(nRow, 3).Content.ContentControl.Checked = False Then\n                thisCell = nTbl.Cell(nRow, 3).Range.Select\n                MsgBox \"Review element:  \" &amp; nTbl.Cell(nRow, 1).Range &amp; nTbl.Cell(nRow, 2).Range\n            End If\n        Next nRow\n\n    End If\n    'Debug.Print nTbl.Columns.Count &amp; \" \" &amp; nTbl.Rows.Count\nNext\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Thanks so much in advance for any answer</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "edited": false, "score": 0, "creation_date": 1422387683, "post_id": 28178192, "comment_id": 44726398, "body": "Thanks! One more question. Is there a way to isolate in which column it searches in A and in which column it searches and then does the calculations in B? The spreadsheet I&#180;m working with has over 50 columns."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "edited": false, "score": 0, "creation_date": 1422388841, "post_id": 28178192, "comment_id": 44726987, "body": "@New2VBA  I used cols <b>A  &amp;  B</b> as an example.  If you update your question with more specific column info, we can generalize the macro!!"}, {"owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "edited": false, "score": 0, "creation_date": 1422390370, "post_id": 28178192, "comment_id": 44727752, "body": "Hi Gary&#39;s Student, thanks again for the help. I think I just got confused by the differences between A/B the variables, the worksheets, and &quot;A&quot; and &quot;B&quot;."}, {"owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "edited": false, "score": 0, "creation_date": 1422390413, "post_id": 28178192, "comment_id": 44727775, "body": "I&#39;m going to edit the question with more specifics and hopefully that will help me."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "edited": false, "score": 0, "creation_date": 1422391205, "post_id": 28178192, "comment_id": 44728190, "body": "@New2VBA  So column <b>H</b> has the <i>IDs</i> and the updates should be placed in worksheet 1   ??"}, {"owner": {"reputation": 1936, "user_id": 2474149, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6ec6e9e714905b4aa40e2a762a3efa0c?s=128&d=identicon&r=PG", "display_name": "barryleajo", "link": "https://stackoverflow.com/users/2474149/barryleajo"}, "reply_to_user": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "edited": false, "score": 0, "creation_date": 1422396170, "post_id": 28178192, "comment_id": 44730838, "body": "@New2VBA .. Mmm in my  code if you set  expCoCol = 8,  expExpColOffset = 5, accCoCol = 8 and  accAcColOffset = 5, you would have your solution."}, {"owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "edited": false, "score": 0, "creation_date": 1422399129, "post_id": 28178192, "comment_id": 44732289, "body": "Thanks, guys! It helped a lot!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1422393077, "last_edit_date": 1422393077, "creation_date": 1422385942, "answer_id": 28178192, "question_id": 28177975, "link": "https://stackoverflow.com/questions/28177975/look-for-values-from-sheet-a-in-sheet-b-and-then-do-function-in-corresponding-s/28178192#28178192", "title": "Look for values from sheet A in sheet B, and then do function in corresponding sheet B cell", "body": "<p>This will perform the update to the values on <strong>Sheet B</strong></p>\n\n<pre><code>Sub New2VBA()\n    Dim A As Worksheet, B As Worksheet\n    Dim i As Long, j As Long, v As Variant\n    Dim N As Long, M As Long\n    Set A = Sheets(\"Sheet A\")\n    Set B = Sheets(\"Sheet B\")\n    N = A.Cells(Rows.Count, \"A\").End(xlUp).Row\n    M = B.Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    For i = 1 To N\n        v1 = A.Cells(i, \"A\").Value\n        v2 = A.Cells(i, \"B\").Value\n        For j = 1 To M\n            If v1 = B.Cells(j, \"A\").Value Then\n                B.Cells(j, \"B\").Value = B.Cells(j, \"B\").Value - v2\n                Exit For\n            End If\n        Next j\n    Next i\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>Here is the updated code.....remove the old code:</p>\n\n<p>This will update the values on sheet <strong>A</strong>  <em>(your worksheet 1)</em> based on the delta values on sheet <strong>B</strong> <em>(2)</em></p>\n\n<pre><code>Sub New2VBA()\n    Dim A As Worksheet, B As Worksheet\n    Dim i As Long, j As Long, v As Variant\n    Dim N As Long, M As Long\n    Set A = Sheets(\"Sheet A\")\n    Set B = Sheets(\"Sheet B\")\n    '\n    '   A is worksheet 1\n    '   B is worksheet 2\n    '\n    N = A.Cells(Rows.Count, \"H\").End(xlUp).Row\n    M = B.Cells(Rows.Count, \"H\").End(xlUp).Row\n\n    For i = 1 To M\n        v1 = B.Cells(i, \"H\").Value\n        v2 = B.Cells(i, \"M\").Value\n        For j = 1 To N\n            If v1 = A.Cells(j, \"H\").Value Then\n                A.Cells(j, \"M\").Value = A.Cells(j, \"M\").Value - v2\n                Exit For\n            End If\n        Next j\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1936, "user_id": 2474149, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6ec6e9e714905b4aa40e2a762a3efa0c?s=128&d=identicon&r=PG", "display_name": "barryleajo", "link": "https://stackoverflow.com/users/2474149/barryleajo"}, "is_accepted": false, "score": 0, "last_activity_date": 1422388146, "creation_date": 1422388146, "answer_id": 28178747, "question_id": 28177975, "link": "https://stackoverflow.com/questions/28177975/look-for-values-from-sheet-a-in-sheet-b-and-then-do-function-in-corresponding-s/28178747#28178747", "title": "Look for values from sheet A in sheet B, and then do function in corresponding sheet B cell", "body": "<p>With acknowledgements to Gary's Student's answer, this is a variation on the theme which (a) uses the <code>Range.Find</code> method to find the account and (b) allows you to set the columns (and other setup parameters) as you have requested.  Accordingly, set the various parameters to suit your scenario.  Note both my sets of test data were positioned to start in A1 and Company/Expense/Account were side-by-side ie. <code>Offset</code>s of 1.</p>\n\n<pre><code>Option Explicit\nSub subExp()\nDim wsExp As Worksheet, wsAcc As Worksheet\nDim accRng As Range, fndCo As Range, c As Range\nDim expStRow As Long, expEndRow As Long, expCoCol As Long, expExpColOffset As Long\nDim accStRow As Long, accEndRow As Long, accCoCol As Long, accAcColOffset As Long\n\n'Assign worksheets\nSet wsExp = Worksheets(\"Expenses\")\nSet wsAcc = Worksheets(\"Accounts\")\n\n'Assign data start position on each sheet\nexpStRow = 2\nexpCoCol = 1\nexpExpColOffset = 1\naccStRow = 2\naccCoCol = 1\naccAcColOffset = 1\n\n    With wsAcc\n        accEndRow = .Cells(Rows.Count, accCoCol).End(xlUp).Row\n        Set accRng = .Range(.Cells(accStRow, accCoCol), .Cells(accEndRow, accCoCol).Offset(0, accAcColOffset))\n    End With\n\n    With wsExp\n        expEndRow = .Cells(Rows.Count, expCoCol).End(xlUp).Row\n        Set expRng = .Range(.Cells(expStRow, expCoCol), .Cells(expEndRow, expCoCol))\n            For Each c In expRng\n                Set fndCo = accRng.Find(What:=c, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext)\n                If Not fndCo Is Nothing Then\n                    fndCo.Offset(0, accAcColOffset).Value = fndCo.Offset(0, accAcColOffset).Value - c.Offset(0, expExpColOffset).Value\n                End If\n            Next c\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1422402349, "creation_date": 1422402349, "answer_id": 28182164, "question_id": 28177975, "link": "https://stackoverflow.com/questions/28177975/look-for-values-from-sheet-a-in-sheet-b-and-then-do-function-in-corresponding-s/28182164#28182164", "title": "Look for values from sheet A in sheet B, and then do function in corresponding sheet B cell", "body": "<p>As an alternative to avoid a loop:</p>\n\n<pre><code>Sub tgr()\n\n    Dim ws1 As Worksheet, ws2 As Worksheet\n    Dim rngH1 As Range, rngM1 As Range\n    Dim rngH2 As Range, rngM2 As Range\n    Dim arrResults As Variant\n\n    Set ws1 = ActiveWorkbook.Sheets(\"Sheet1\")\n    Set rngH1 = ws1.Range(\"H2\", ws1.Cells(Rows.Count, \"H\").End(xlUp))\n    Set rngM1 = Intersect(rngH1.EntireRow, ws1.Columns(\"M\"))\n\n    Set ws2 = ActiveWorkbook.Sheets(\"Sheet2\")\n    Set rngH2 = ws2.Range(\"H2\", ws2.Cells(Rows.Count, \"H\").End(xlUp))\n    Set rngM2 = Intersect(rngH2.EntireRow, ws2.Columns(\"M\"))\n\n    arrResults = Evaluate(\"=INDEX(\" &amp; rngM1.Address(External:=True) &amp; \"-SUMIF(\" &amp; rngH2.Address(External:=True) &amp; \",\" &amp; rngH1.Address(External:=True) &amp; \",\" &amp; rngM2.Address(External:=True) &amp; \"),)\")\n\n    rngM1.Value = arrResults\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 28178192, "answer_count": 3, "score": 0, "last_activity_date": 1422402349, "creation_date": 1422385176, "last_edit_date": 1422393902, "question_id": 28177975, "link": "https://stackoverflow.com/questions/28177975/look-for-values-from-sheet-a-in-sheet-b-and-then-do-function-in-corresponding-s", "title": "Look for values from sheet A in sheet B, and then do function in corresponding sheet B cell", "body": "<p>I need to ook for values from sheet A in sheet B, and then do function in corresponding sheet B cell in VBA so I can change the data in worksheet 1, press a button, and have it work. The Letter headings denote the name of the rows in excel. The xs are just saying that it is data I do not want to manipulate.\nI have sheet 1 and sheet 2.</p>\n\n<pre><code> Worksheet 1                        \nH     I            J          K          L           M          N\n1   xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    100     xxxxxxxx\n2   xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    200     xxxxxxxx\n3   xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    300     xxxxxxxx\n4   xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    400     xxxxxxxx\n5   xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    500     xxxxxxxx\n6   xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    600     xxxxxxxx\n7   xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    700     xxxxxxxx\n8   xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    800     xxxxxxxx\n9   xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    900     xxxxxxxx\n10  xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    1000    xxxxxxxx\n11  xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    1100    xxxxxxxx\n12  xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    1200    xxxxxxxx\n13  xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    1300    xxxxxxxx\n14  xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    1400    xxxxxxxx\n15  xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    1500    xxxxxxxx\n16  xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    1600    xxxxxxxx\n17  xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    1700    xxxxxxxx\n18  xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    1800    xxxxxxxx\n19  xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    1900    xxxxxxxx\n20  xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    2000    xxxxxxxx\n\nWorksheet 2                     \n   H        I         J           K           L         M     N\n   2    xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    25  xxxxxxxx\n   5    xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    40  xxxxxxxx\n   9    xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    35  xxxxxxxx\n  11    xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    50  xxxxxxxx\n  10    xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    65  xxxxxxxx\n   6    xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    90  xxxxxxxx\n   7    xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    10  xxxxxxxx\n</code></pre>\n\n<p>So that the corresponding values are subtracted in worksheet 1, thus changing the values of the M column.</p>\n\n<pre><code>Worksheet 1 - new                   \nH     I            J          K          L           M          N\n1   xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    100     xxxxxxxx\n2   xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    175     xxxxxxxx\n3   xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    300     xxxxxxxx\n4   xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    400     xxxxxxxx\n5   xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    460     xxxxxxxx\n6   xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    510     xxxxxxxx\n7   xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    690     xxxxxxxx\n8   xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    800     xxxxxxxx\n9   xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    865     xxxxxxxx\n10  xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    935     xxxxxxxx\n11  xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    1050    xxxxxxxx\n12  xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    1200    xxxxxxxx\n13  xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    1300    xxxxxxxx\n14  xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    1400    xxxxxxxx\n15  xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    1500    xxxxxxxx\n16  xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    1600    xxxxxxxx\n17  xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    1700    xxxxxxxx\n18  xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    1800    xxxxxxxx\n19  xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    1900    xxxxxxxx\n20  xxxxxxxx    xxxxxxxx    xxxxxxxx    xxxxxxxx    2000    xxxxxxxx\n</code></pre>\n"}, {"tags": ["vba", "excel", "if-statement", "with-statement"], "comments": [{"owner": {"reputation": 424, "user_id": 3479671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1eec243884e037322a33ea3086499165?s=128&d=identicon&r=PG&f=1", "display_name": "user3479671", "link": "https://stackoverflow.com/users/3479671/user3479671"}, "edited": false, "score": 0, "creation_date": 1422384918, "post_id": 28177710, "comment_id": 44724917, "body": "your first bit of logic is redundant.  if A7=&quot;\\&quot;, then obviously, it can&#39;t be empty"}, {"owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "edited": false, "score": 0, "creation_date": 1422385136, "post_id": 28177710, "comment_id": 44725031, "body": "Code of your first if clause says something different then your explanation.  <code>A7 &lt;&gt; &quot;&quot; and A7 = &quot;\\&quot;</code> OR <code>A7 &lt;&gt; &quot;&quot; and C7 = &quot;\\&quot;</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 4223089, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d0ea16f945a9b7b137c59ed52f096c48?s=128&d=identicon&r=PG&f=1", "display_name": "user4223089", "link": "https://stackoverflow.com/users/4223089/user4223089"}, "edited": false, "score": 0, "creation_date": 1422385669, "post_id": 28177926, "comment_id": 44725299, "body": "What I have for other criteria are only IF A7 &lt;&gt; &quot;&quot; THEN C7 = &quot;whatever&quot; ElseIF A7 = &quot;&quot; THEN C7 = &quot;&quot;...I have the criteria working the way I wanted it to but the problem lies within the WITH statement. I cannot get it to scan the entire column and if A is empty, then leave everything empty too, no blanks in between, so if you had 100 entries, you would have 100 filled entries and then blanks all AFTER the initial 100 it does not skip in between"}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 0, "last_activity_date": 1422385324, "last_edit_date": 1422385324, "creation_date": 1422385002, "answer_id": 28177926, "question_id": 28177710, "link": "https://stackoverflow.com/questions/28177710/how-to-do-a-3-part-if-statement-in-vba/28177926#28177926", "title": "How to do a 3-part IF statement in VBA?", "body": "<p>If you want to run it through the whole column, you need to nest the same If-block into a loop:</p>\n\n<pre><code>With Sheets(\"DL Data\")\nFor j = 7 To .Range(\"A7\").End(xlDown).Row\n    If .Range(\"A\" &amp; j) &lt;&gt; \"\" And .Range(\"C\" &amp; j) = \"\\\" Then\n        .Range(\"W\" &amp; j) = \"\\\"\n    ElseIf .Range(\"A\" &amp; j) &lt;&gt; \"\" And .Range(\"C\" &amp; j) &lt;&gt; \"\\\" Then\n        .Range(\"W\" &amp; j) = \"\\L\"\n    ElseIf .Range(\"A\" &amp; j) = \"\" Then\n        .Range(\"W\" &amp; j) = \"\"\n    End If\nNext j\nEnd With\n</code></pre>\n\n<p><strong>WARNING</strong> I have followed your current implementation; however, if your column \"A\" might have some empty cells in between (which would explain the presence of a <code>ElseIf .Range(\"A\" &amp; j) = \"\"</code>), pay attention to the fact that the counter <code>.Range(\"A7\").End(xlDown).Row</code> would stop at the first empty cell. You might want to index your counter into an always filled-up column (such as a record-ID of your data set). </p>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 4223089, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d0ea16f945a9b7b137c59ed52f096c48?s=128&d=identicon&r=PG&f=1", "display_name": "user4223089", "link": "https://stackoverflow.com/users/4223089/user4223089"}, "edited": false, "score": 0, "creation_date": 1422385972, "post_id": 28178008, "comment_id": 44725457, "body": "Uri Goren...when I grow up, I want to be just like you. It worked like a charm. I am going to study this and understand the logic. I think I need to brush up on my LOOP function, since that seems to be the answer to MOST of my VBA questions. Thank you very much for this. Huge help!"}, {"owner": {"reputation": 19, "user_id": 4223089, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d0ea16f945a9b7b137c59ed52f096c48?s=128&d=identicon&r=PG&f=1", "display_name": "user4223089", "link": "https://stackoverflow.com/users/4223089/user4223089"}, "edited": false, "score": 0, "creation_date": 1422645100, "post_id": 28178008, "comment_id": 44846711, "body": "Hey Uri, if I have only one line it needs to search for instead of &#39;more than one&#39; in that column, it gives me an error, i am guessing since the xlDown function doesnt see any further row below that first entry...is there a way to have it not do that even if there is only one entry within the first row?"}, {"owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "reply_to_user": {"reputation": 19, "user_id": 4223089, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d0ea16f945a9b7b137c59ed52f096c48?s=128&d=identicon&r=PG&f=1", "display_name": "user4223089", "link": "https://stackoverflow.com/users/4223089/user4223089"}, "edited": false, "score": 0, "creation_date": 1422648968, "post_id": 28178008, "comment_id": 44848570, "body": "Run the <code>For</code> loop from <code>7</code> To <code>IIf(Sheets(&quot;DL Data&quot;).Range(&quot;A8&quot;)=&quot;&quot;,7,Sheets(&quot;DL Data&quot;).Range(&quot;A7&quot;).End(xlDown).Row)</code>"}, {"owner": {"reputation": 19, "user_id": 4223089, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d0ea16f945a9b7b137c59ed52f096c48?s=128&d=identicon&r=PG&f=1", "display_name": "user4223089", "link": "https://stackoverflow.com/users/4223089/user4223089"}, "edited": false, "score": 0, "creation_date": 1422888860, "post_id": 28178008, "comment_id": 44914848, "body": "what the...i am just in awe dude...i thought the &quot;IIF&quot; was a typo so I copied it without it and it didnt work and when i did and now it works...i just...damn, if you have any recommendations on where to study up on Loop, For, statements, i&#39;d love to know! THANK YOU!"}], "tags": [], "owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "is_accepted": true, "score": 0, "last_activity_date": 1422385935, "last_edit_date": 1422385935, "creation_date": 1422385312, "answer_id": 28178008, "question_id": 28177710, "link": "https://stackoverflow.com/questions/28177710/how-to-do-a-3-part-if-statement-in-vba/28178008#28178008", "title": "How to do a 3-part IF statement in VBA?", "body": "<p>The <code>With</code> is simply an abbreviation.</p>\n\n<p>For example</p>\n\n<pre><code>With Sheets(\"DL Data\")\n    .Range(\"W7:W\" &amp; .Cells(.Rows.Count, \"A\").End(xlUp).Row).Formula = \"\\L\"\nEnd With\n</code></pre>\n\n<p>Is equivalent to</p>\n\n<pre><code>Sheets(\"DL Data\").Range(\"W7:W\" &amp; Sheets(\"DL Data\").Cells(Sheets(\"DL Data\").Rows.Count, \"A\").End(xlUp).Row).Formula = \"\\L\"\n</code></pre>\n\n<p>You need a loop in order to apply this condition to all of the rows, for example:</p>\n\n<pre><code>Dim i as Integer\nFor i = 7 To Sheets(\"DL Data\").Range(\"A7\").End(xlDown).Row\nIf Not IsEmpty(Range(\"A\" &amp; i)) And Range(\"C\" &amp; i) = \"\\\" Then\n    Range(\"W\" &amp; i) = \"\\\"\nElseIf Not IsEmpty(Range(\"A\" &amp; i)) And Range(\"C\" &amp; i) &lt;&gt; \"\\\" Then\n    Range(\"W\" &amp; i) = \"\\L\"\nElseIf IsEmpty(Range(\"A\" &amp; i)) Then\n    Range(\"W\" &amp; i) = \"\"\nEnd If\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5905, "user_id": 3962346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vrs0W.jpg?s=128&g=1", "display_name": "Jason Faulkner", "link": "https://stackoverflow.com/users/3962346/jason-faulkner"}, "is_accepted": false, "score": 0, "last_activity_date": 1422385403, "creation_date": 1422385403, "answer_id": 28178027, "question_id": 28177710, "link": "https://stackoverflow.com/questions/28177710/how-to-do-a-3-part-if-statement-in-vba/28178027#28178027", "title": "How to do a 3-part IF statement in VBA?", "body": "<p>This update to your code will update the <code>W</code> column according to your formula. I optimized the <code>If</code> statements a bit to make them less redundant.</p>\n\n<p>Additionally, I have included a couple of <code>With</code> blocks for illustration purposes.</p>\n\n<pre><code>With Sheets(\"DL Data\")\n    Dim row As Long\n    For row = 7 To .Cells(.Rows.Count, \"A\").End(xlUp).Row)\n\n        With .Range(\"A\" &amp; row)\n            ' IF A is empty THEN W equals blank\n            If .Value = \"\" Then\n                Range(\"W\" &amp; row).Value = \"\"\n\n            ' IF A is not empty AND it equals \"\\\" THEN W equals \"\\\"\n            If .Value = \"\\\" Then\n                Range(\"W\" &amp; row).Value = \"\\\"\n\n            ' IF A is not empty AND it does not equal \"\\\" THEN W equals \"\\L\"\n            ' A is not empty (first condition checked above).\n            ElseIf .Value &lt;&gt; \"\\\"\n                Range(\"W\" &amp; row).Value = \"\\L\"\n\n            End If\n        End With\n\n    Next\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 4223089, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d0ea16f945a9b7b137c59ed52f096c48?s=128&d=identicon&r=PG&f=1", "display_name": "user4223089", "link": "https://stackoverflow.com/users/4223089/user4223089"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 28178008, "answer_count": 3, "score": 1, "last_activity_date": 1422385935, "creation_date": 1422384217, "last_edit_date": 1531164843, "question_id": 28177710, "link": "https://stackoverflow.com/questions/28177710/how-to-do-a-3-part-if-statement-in-vba", "title": "How to do a 3-part IF statement in VBA?", "body": "<pre><code>'8\nIf Not IsEmpty(Range(\"A7\")) And Range(\"C7\") = \"\\\" Then\n    Range(\"W7\") = \"\\\"\nElseIf Not IsEmpty(Range(\"A7\")) And Range(\"C7\") &lt;&gt; \"\\\" Then\n    Range(\"W7\") = \"\\L\"\nElseIf IsEmpty(Range(\"A7\")) Then\n    Range(\"W7\") = \"\"\nEnd If\n\nWith Sheets(\"DL Data\")\n    .Range(\"W7:W\" &amp; .Cells(.Rows.Count, \"A\").End(xlUp).Row).Formula = \"\\L\"\nEnd With\n</code></pre>\n\n<p>I cannot seem to figure out the WITH part, or maybe I am off on the IF statement all together. What I am trying to do here is this:</p>\n\n<p>IF A7 is not empty AND it equals \"\\\" THEN W7 equals \"\\\", also\nIF A7 is not empty AND it does not equal \"\\\" THEN W7 equals \"\\L\", also\nIF A7 is empty THEN W7 equals blank</p>\n\n<p>Then I would like it to do this to search through the Column and give me the appropriate answer, inserting blanks where necessary, inserting \"\\\" where necessary and inserting \"\\L\" where necessary.</p>\n\n<p>Hope I am making myself clear here, thanks for all of the help in advance!</p>\n\n<p>Regards,</p>\n\n<p>Yazz</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": false, "score": 0, "last_activity_date": 1422383787, "creation_date": 1422383787, "answer_id": 28177600, "question_id": 28177427, "link": "https://stackoverflow.com/questions/28177427/how-to-skip-current-cell-in-a-for-each-loop/28177600#28177600", "title": "How to skip current cell in a for each loop", "body": "<p>You can enclose the code within the <code>FOR/EACH</code> loop within a separate <code>IF</code> statement, as below:</p>\n\n<pre><code>Sub Mail_small_Text_Outlook()\n'For Tips see: http://www.rondebruin.nl/win/winmail/Outlook/tips.htm\n'Working in Office 2000-2013\nDim OutApp As Object\nDim OutMail As Object\nDim cell As Range\n\nApplication.ScreenUpdating = False\nSet OutApp = CreateObject(\"Outlook.Application\")\n\nOn Error GoTo cleanup\nFor Each cell In Columns(\"K\").Cells.SpecialCells(xlCellTypeConstants)\n    If cell.Value = \"CONTACT METHOD\" Then\n        'Do Nothing, or Enter code here\n    Else\n        If cell.Value Like \"*@*\" Then\n        finaladdress = cell.Value\n\n        Else\n        finaladdress = cell.Value &amp; \"@email.smsglobal.com\"\n\n            Set OutMail = OutApp.CreateItem(0)\n            On Error Resume Next\n            With OutMail\n                .To = finaladdress\n                .Subject = \"Reminder\"\n                .Body = \"Dear \" &amp; Cells(cell.Row, \"A\").Value _\n                      &amp; vbNewLine &amp; vbNewLine &amp; _\n                        \"Please contact us to discuss bringing \" &amp; _\n                        \"your account up to date\"\n                'You can add files also like this\n                '.Attachments.Add (\"C:\\test.txt\")\n                .Display\n            End With\n            On Error GoTo 0\n            Set OutMail = Nothing\n        End If\n    End If\nNext cell\n\ncleanup:\nSet OutApp = Nothing\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1422384997, "last_edit_date": 1422384997, "creation_date": 1422384693, "answer_id": 28177846, "question_id": 28177427, "link": "https://stackoverflow.com/questions/28177427/how-to-skip-current-cell-in-a-for-each-loop/28177846#28177846", "title": "How to skip current cell in a for each loop", "body": "<p>If your goal is to skip cell <strong>K1</strong> in looping down column <strong>K</strong> then:</p>\n\n<pre><code>For Each cell In Columns(\"K2:K\" &amp; Rows.Count).Cells.SpecialCells(xlCellTypeConstants)\n</code></pre>\n"}], "owner": {"reputation": 874, "user_id": 1442204, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1f8f688d347241b978d55c6d3dcb6131?s=128&d=identicon&r=PG&f=1", "display_name": "Gallaxhar", "link": "https://stackoverflow.com/users/1442204/gallaxhar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 568, "favorite_count": 0, "accepted_answer_id": 28177846, "answer_count": 2, "score": 0, "last_activity_date": 1422384997, "creation_date": 1422383138, "last_edit_date": 1531164843, "question_id": 28177427, "link": "https://stackoverflow.com/questions/28177427/how-to-skip-current-cell-in-a-for-each-loop", "title": "How to skip current cell in a for each loop", "body": "<p>In excel I have the following code which sends out emails for every cell that contains an email address in column K.</p>\n\n<p>This would work except for the header in the table isn't an email address, so it breaks the code. I tried to skip the header by specifying \"if cell.value = CONTACT METHOD, which is the header name text, then go to Next cell\" </p>\n\n<p>but this causes a \"Next without for\" error.</p>\n\n<pre><code>Sub Mail_small_Text_Outlook()\n'For Tips see: http://www.rondebruin.nl/win/winmail/Outlook/tips.htm\n'Working in Office 2000-2013\nDim OutApp As Object\nDim OutMail As Object\nDim cell As Range\n\nApplication.ScreenUpdating = False\nSet OutApp = CreateObject(\"Outlook.Application\")\n\nOn Error GoTo cleanup\nFor Each cell In Columns(\"K\").Cells.SpecialCells(xlCellTypeConstants)\n\n    If cell.Value Like \"*@*\" Then\n    finaladdress = cell.Value\n\n    Else\n    finaladdress = cell.Value &amp; \"@email.smsglobal.com\"\n\n        Set OutMail = OutApp.CreateItem(0)\n        On Error Resume Next\n        With OutMail\n            .To = finaladdress\n            .Subject = \"Reminder\"\n            .Body = \"Dear \" &amp; Cells(cell.Row, \"A\").Value _\n                  &amp; vbNewLine &amp; vbNewLine &amp; _\n                    \"Please contact us to discuss bringing \" &amp; _\n                    \"your account up to date\"\n            'You can add files also like this\n            '.Attachments.Add (\"C:\\test.txt\")\n            .Display\n        End With\n        On Error GoTo 0\n        Set OutMail = Nothing\n    End If\nNext cell\n\ncleanup:\nSet OutApp = Nothing\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4488526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cdd3ae5da2dd8654c3f0ca6f468b7ed?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick0427", "link": "https://stackoverflow.com/users/4488526/patrick0427"}, "edited": false, "score": 0, "creation_date": 1422384656, "post_id": 28177689, "comment_id": 44724792, "body": "Thank you. Actually the range I am searching thru is specifically M7 to M26. Would it be better to do a Do Until with a counter?"}, {"owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "reply_to_user": {"reputation": 3, "user_id": 4488526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cdd3ae5da2dd8654c3f0ca6f468b7ed?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick0427", "link": "https://stackoverflow.com/users/4488526/patrick0427"}, "edited": false, "score": 0, "creation_date": 1422388273, "post_id": 28177689, "comment_id": 44726707, "body": "Nope, if it&#39;s always going to be M7:M26 then you will just want to program that into the range for the For Each. Real easy, I updated my answer."}, {"owner": {"reputation": 3, "user_id": 4488526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cdd3ae5da2dd8654c3f0ca6f468b7ed?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick0427", "link": "https://stackoverflow.com/users/4488526/patrick0427"}, "edited": false, "score": 0, "creation_date": 1422394489, "post_id": 28177689, "comment_id": 44729973, "body": "Hi D_Zab, that worked perfectly thanks!  One last follow up....I now realize I cannot get away with copying the whole row.  Instead I need to copy some of the cells from the row meeting the condition.  Should I use the Offset function relative to Item?"}, {"owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "reply_to_user": {"reputation": 3, "user_id": 4488526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cdd3ae5da2dd8654c3f0ca6f468b7ed?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick0427", "link": "https://stackoverflow.com/users/4488526/patrick0427"}, "edited": false, "score": 0, "creation_date": 1422394834, "post_id": 28177689, "comment_id": 44730145, "body": "Yeah, you can use offset with For Each or you can use the other &quot;For I = 7 to 26&quot; and loop through that way then you can reference the current row in the loop by the I variable."}], "tags": [], "owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "is_accepted": true, "score": 0, "last_activity_date": 1422388304, "last_edit_date": 1422388304, "creation_date": 1422384127, "answer_id": 28177689, "question_id": 28177420, "link": "https://stackoverflow.com/questions/28177420/excel-vba-macro-to-copy-specific-rows-from-workbook-sheets-into-new-summary-shee/28177689#28177689", "title": "Excel VBA macro to copy specific rows from workbook sheets into new summary sheet....almost works", "body": "<p>For your first question about debugging, you can use:</p>\n\n<pre><code>Debug.Print \"Worksheet: \" &amp; ActiveSheet.Name\n</code></pre>\n\n<p>at any time in your code to print out which sheet you are on into the \"Immediate\" window in the Visual Basic Editor. This is great for debugging in all scenarios.</p>\n\n<p>Second, a For Each loop is the fastest way to loop through anything but it has disadvantages. Namely, if you are deleting/inserting anything it will return funny results (Copy/Paste will be ok). Any sort of While loop is better to use if you don't have a predetermined idea of how many rows you are going to need to work through.</p>\n\n<p>As far as your code is concerned this is how I would do it (you would still need to include your code above and below the while loop):</p>\n\n<pre><code>Dim Items As Range\nDim Item As Range\n\n'This will set the code to loop from M7 to the last row, if you\n'didn't want to go to the end there is probably a better way to do it.\n\nSet Items = ws.Range(\"M7:M26\")\n\nFor Each Item In Items\n\n'If value in column M &gt; 0.8, copy entire row to HH\nIf Item.Value &gt; 0.8 Then\n\n    'Select row in active Sheet to copy\n    Item.EntireRow.Copy\n\n    'Paste row into HH in next row\n    Sheets(\"HH\").Rows(LCopyToRow &amp; \":\" &amp; LCopyToRow).PasteSpecial\n\n    'Move counter to next row\n    LCopyToRow = LCopyToRow + 1\n\nEnd If\n\nNext Item\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 1, "last_activity_date": 1422385319, "creation_date": 1422385319, "answer_id": 28178011, "question_id": 28177420, "link": "https://stackoverflow.com/questions/28177420/excel-vba-macro-to-copy-specific-rows-from-workbook-sheets-into-new-summary-shee/28178011#28178011", "title": "Excel VBA macro to copy specific rows from workbook sheets into new summary sheet....almost works", "body": "<p>Very similar to the previous answer just worded differently.Same results though.</p>\n\n<pre><code>Sub Button1_Click()\n    Dim Rws As Long, Rng As Range, ws As Worksheet, sh As Worksheet, c As Range, x As Integer\n    Set ws = Worksheets(\"HH\")\n    x = 2\n    Application.ScreenUpdating = 0\n    For Each sh In Sheets\n        If sh.Name &lt;&gt; ws.Name Then\n            With sh\n                Rws = .Cells(Rows.Count, \"M\").End(xlUp).Row\n                Set Rng = .Range(.Cells(7, \"M\"), .Cells(Rws, \"M\"))\n                For Each c In Rng.Cells\n                    If c.Value &gt; 0.8 Then\n                        c.EntireRow.Copy Destination:=ws.Cells(x, \"A\")\n                        x = x + 1\n                    End If\n                Next c\n            End With\n        End If\n    Next sh\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4488526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cdd3ae5da2dd8654c3f0ca6f468b7ed?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick0427", "link": "https://stackoverflow.com/users/4488526/patrick0427"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11080, "favorite_count": 0, "accepted_answer_id": 28177689, "answer_count": 2, "score": 0, "last_activity_date": 1422393052, "creation_date": 1422383111, "last_edit_date": 1422393052, "question_id": 28177420, "link": "https://stackoverflow.com/questions/28177420/excel-vba-macro-to-copy-specific-rows-from-workbook-sheets-into-new-summary-shee", "title": "Excel VBA macro to copy specific rows from workbook sheets into new summary sheet....almost works", "body": "<p>I need to be able to look at a specified range of cells in every worksheet of my workbook and if they meet criteria, copy that row to a summary sheet.  The below code works for the most part except there are a few instances where it copies rows that do not meet the criteria and one instance where it skips a row it should have copied. </p>\n\n<p>Is there a way to use a debug tool so that at any time while cycling through the code I can see: What is the active sheet? What is the active cell? What is the active row? etc.  </p>\n\n<p>Also, should I use a -For Each Cell in Range- instead of -While Len- to loop through the specified range on each sheet?</p>\n\n<pre><code>Sub LoopThroughSheets()\n\nDim LSearchRow As Integer\nDim LCopyToRow As Integer\nDim ws As Worksheet\n\n'Start copying data to row 2 in HH (row counter variable)\nLCopyToRow = 2\n\nFor Each ws In ActiveWorkbook.Worksheets\n\n'Start search in row 7\nLSearchRow = 7\n\nWhile Len(ws.Range(\"M\" &amp; CStr(LSearchRow)).Value) &gt; 0\n\n'If value in column M &gt; 0.8, copy entire row to HH\nIf ws.Range(\"M\" &amp; CStr(LSearchRow)).Value &gt; 0.8 Then\n\n    'Select row in active Sheet to copy\n    Rows(CStr(LSearchRow) &amp; \":\" &amp; CStr(LSearchRow)).Select\n    Selection.Copy\n\n    'Paste row into HH in next row\n    Sheets(\"HH\").Select\n    Rows(CStr(LCopyToRow) &amp; \":\" &amp; CStr(LCopyToRow)).Select\n    ActiveSheet.Paste\n\n    'Move counter to next row\n    LCopyToRow = LCopyToRow + 1\n\n    'Go back to active ws to continue searching\n    ws.Activate\n\nEnd If\n\nLSearchRow = LSearchRow + 1\n\nWend\n\n\nNext ws\n'Position on cell A1 in sheet HH\nSheets(\"HH\").Select\n\nApplication.CutCopyMode = False\nRange(\"A1\").Select\nMsgBox \"All matching data has been copied.\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["javascript", "jquery", "vba", "twitter-bootstrap", "modal-dialog"], "comments": [{"owner": {"reputation": 162909, "user_id": 1175966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d3d9dfbd040f9cbc1a6b82f0da2b345?s=128&d=identicon&r=PG", "display_name": "charlietfl", "link": "https://stackoverflow.com/users/1175966/charlietfl"}, "edited": false, "score": 0, "creation_date": 1422383243, "post_id": 28177405, "comment_id": 44723929, "body": "have you confirmed the modal element exists? Any errors thrown?"}, {"owner": {"reputation": 106, "user_id": 4292798, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Y5qRu.jpg?s=128&g=1", "display_name": "Gregorio Meraz Jr.", "link": "https://stackoverflow.com/users/4292798/gregorio-meraz-jr"}, "reply_to_user": {"reputation": 162909, "user_id": 1175966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d3d9dfbd040f9cbc1a6b82f0da2b345?s=128&d=identicon&r=PG", "display_name": "charlietfl", "link": "https://stackoverflow.com/users/1175966/charlietfl"}, "edited": false, "score": 0, "creation_date": 1422383395, "post_id": 28177405, "comment_id": 44724024, "body": "what do you mean with modal element? and no, no error thrown,. wierd thing is i have another modal and that one is working with another condition, so i tried to see if my condition was working, and indeed, it displays the alert y have commented there, but the modal still not showing, already checked for some sintaxys mistakes but im not able to find any."}], "answers": [{"comments": [{"owner": {"reputation": 106, "user_id": 4292798, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Y5qRu.jpg?s=128&g=1", "display_name": "Gregorio Meraz Jr.", "link": "https://stackoverflow.com/users/4292798/gregorio-meraz-jr"}, "edited": false, "score": 0, "creation_date": 1422384740, "post_id": 28177532, "comment_id": 44724830, "body": "mmm not able to fin de code, i will post it completely to see if sombody can help."}, {"owner": {"reputation": 646, "user_id": 4014005, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MH_8tviU2Xg/AAAAAAAAAAI/AAAAAAAAAbk/7SM8Voh8ES0/photo.jpg?sz=128", "display_name": "Daniel Ma", "link": "https://stackoverflow.com/users/4014005/daniel-ma"}, "reply_to_user": {"reputation": 106, "user_id": 4292798, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Y5qRu.jpg?s=128&g=1", "display_name": "Gregorio Meraz Jr.", "link": "https://stackoverflow.com/users/4292798/gregorio-meraz-jr"}, "edited": false, "score": 0, "creation_date": 1422386796, "post_id": 28177532, "comment_id": 44725913, "body": "There is another issue I just thought of. All <code>.value</code> calls to <code>&lt;input&gt;</code> elements return a string. If you want to compare the value against an integer, you first need to use <code>parseInt()</code> to convert the string to an integer  <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/parseInt\" rel=\"nofollow noreferrer\">developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/&hellip;</a>"}], "tags": [], "owner": {"reputation": 646, "user_id": 4014005, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MH_8tviU2Xg/AAAAAAAAAAI/AAAAAAAAAbk/7SM8Voh8ES0/photo.jpg?sz=128", "display_name": "Daniel Ma", "link": "https://stackoverflow.com/users/4014005/daniel-ma"}, "is_accepted": true, "score": 2, "last_activity_date": 1422383534, "creation_date": 1422383534, "answer_id": 28177532, "question_id": 28177405, "link": "https://stackoverflow.com/questions/28177405/modal-from-bootstrap-not-showing-up-visual-studio-js-jquery/28177532#28177532", "title": "Modal from bootstrap not showing up, Visual studio, js, jquery", "body": "<p>When I pasted your code into JSFiddle, I got an error on the first line of Javascript. However, when I removed that line and just pasted in the HTML of the modal and the code to show it, everything worked properly. Take a look at this fiddle and you can see it working.</p>\n\n<p><a href=\"http://jsfiddle.net/pup3jykb/1/\" rel=\"nofollow\">http://jsfiddle.net/pup3jykb/1/</a></p>\n\n<pre><code>$(\"#ModalErrorOCR\").modal(\"show\");\n</code></pre>\n\n<p>Make sure you don't have any other errors on the page preventing the modal from appearing</p>\n"}], "owner": {"reputation": 106, "user_id": 4292798, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Y5qRu.jpg?s=128&g=1", "display_name": "Gregorio Meraz Jr.", "link": "https://stackoverflow.com/users/4292798/gregorio-meraz-jr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 554, "favorite_count": 0, "accepted_answer_id": 28177532, "answer_count": 1, "score": -2, "last_activity_date": 1422383534, "creation_date": 1422383057, "question_id": 28177405, "link": "https://stackoverflow.com/questions/28177405/modal-from-bootstrap-not-showing-up-visual-studio-js-jquery", "title": "Modal from bootstrap not showing up, Visual studio, js, jquery", "body": "<p>So i have this simple validation condition, if the lenght of one of the values its equal to 10 or 11 or 12 then it should display the value, i alreaddy debugg it and it seems it is indeed going through the condition, another modal i have in the same view its working so its not an incorrect style call, already ckecked some questions and tutorials and still not able to make it work.</p>\n\n<p>here is the js code where its supposed to call it:</p>\n\n<pre><code>var cel = document.forms[\"FormularioAlta\"][\"cel\"].value;\n            var celconfirmacion = document.forms[\"FormularioAlta\"][\"celconfirmacion\"].value;\n            var ocr = document.forms[\"FormularioAlta\"][\"ocr\"].value;\n            var ocrconfirmacion = document.forms[\"FormularioAlta\"][\"ocrconfirmacion\"].value;\n            var flag = true;\n\n\n\n\n            if (cel.length != 10 || celconfirmacion.length != 10) {\n\n                flag = false;\n\n            }\n            if (ocr.length == 10 || ocr.length == 11 || ocr.length == 12 || ocrconfirmacion.length == 10 || ocrconfirmacion.length == 11 || ocrconfirmacion.length == 12) {\n\n                //alert(\"los OCR deben de tener solamente una longitud de 9 o 13 digitos\");\n                flag = false;\n                $(\"#ModalErrorOCR\").modal(\"show\");\n\n\n            }\n</code></pre>\n\n<p>and here is where i declare the modal:</p>\n\n<pre><code> &lt;div class=\"modal fade\" id=\"ModalErrorOCR\" data-backdrop=\"static\" data-keyboard=\"false\"&gt;\n  &lt;div class=\"modal-dialog\"&gt;\n    &lt;div class=\"modal-content\"&gt;\n      &lt;div class=\"modal-header\"&gt;\n        &lt;button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"&gt;&lt;span aria-hidden=\"true\"&gt;&amp;times;&lt;/span&gt;&lt;/button&gt;\n        &lt;h4 class=\"modal-title\"&gt;Error&lt;/h4&gt;\n      &lt;/div&gt;\n      &lt;div class=\"modal-body\"&gt;\n        &lt;p&gt;Los OCR deben de tener  una longitud de 9 o 13 digitos unicamente.&amp;hellip;&lt;/p&gt;\n      &lt;/div&gt;\n\n         &lt;div class=\"modal-footer\"&gt;\n        &lt;button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\"&gt;Cerrar&lt;/button&gt;\n\n      &lt;/div&gt;\n\n    &lt;/div&gt;&lt;!-- /.modal-content --&gt;\n  &lt;/div&gt;&lt;!-- /.modal-dialog --&gt;\n        &lt;/div&gt;&lt;!-- /.modal --&gt;\n</code></pre>\n"}, {"tags": ["vba", "excel", "runtime-error"], "comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 2, "creation_date": 1422383036, "post_id": 28177295, "comment_id": 44723815, "body": "<code>ws</code> is a worksheet.  <code>ComboBox1.Value</code> is a string.  You cannot set a worksheet to a string.  Do you want <code>Set ws = Worksheets(ComboBox1.value)</code>?"}, {"owner": {"reputation": 3, "user_id": 4499816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e77fbffd7e7110c505de03dd66dafac?s=128&d=identicon&r=PG&f=1", "display_name": "thyde73", "link": "https://stackoverflow.com/users/4499816/thyde73"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1422462642, "post_id": 28177295, "comment_id": 44761285, "body": "Yes that fixed the problem. Thank you for your help!"}], "answers": [{"comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 1, "creation_date": 1422388623, "post_id": 28178152, "comment_id": 44726878, "body": "I would really like to know the reason of the downvote."}, {"owner": {"reputation": 3, "user_id": 4499816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e77fbffd7e7110c505de03dd66dafac?s=128&d=identicon&r=PG&f=1", "display_name": "thyde73", "link": "https://stackoverflow.com/users/4499816/thyde73"}, "edited": false, "score": 0, "creation_date": 1422462589, "post_id": 28178152, "comment_id": 44761251, "body": "Thanks for the help! It fixed my problem. I am learning as I go and your explanation helped me very much!"}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 1, "last_activity_date": 1422385823, "creation_date": 1422385823, "answer_id": 28178152, "question_id": 28177295, "link": "https://stackoverflow.com/questions/28177295/how-to-fix-runtime-error-91-in-excel/28178152#28178152", "title": "How to fix Runtime Error &quot;91&quot; in Excel", "body": "<p>I take your piece of code and explain you the inconsistency: </p>\n\n<pre><code>Dim ws As Worksheet\nws = ComboBox1.Value\n</code></pre>\n\n<p>The first line of code is declaring <code>ws</code> as a Worksheet object. Objects in VBA need the keyword <code>Set</code> to be set, and of course the data type needs to match the declaration. </p>\n\n<p>On the other hand, in the second statement you're setting <code>ws</code> as <code>ComboBox1.Value</code>, which is a type <code>String</code>. So:</p>\n\n<p>1) The reason why you get the error is that <code>ws</code> is a variable that, because of its declaration, expects to get a <code>Worksheet</code> object but you're instead trying to cast a <code>String</code> in it;</p>\n\n<p>2) What you probably want to do is to <em>have in <code>ws</code> the Worksheet object whose name is the <code>ComboBox1.Value</code></em>; this, in terms of code, should be written as follows: </p>\n\n<pre><code>Set ws = ThisWorkbook.Sheets(ComboBox1.Value)\n</code></pre>\n\n<p>You only need to replace the line <code>ws = ComboBox1.Value</code> with the line above. </p>\n\n<p>Pay attention, in general: if you declare a variable of type <em>X</em>, it will always be able to cast only a <em>type X</em> object, unless you don't declare it at all (very bad practice, you would get errors after). </p>\n"}], "owner": {"reputation": 3, "user_id": 4499816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e77fbffd7e7110c505de03dd66dafac?s=128&d=identicon&r=PG&f=1", "display_name": "thyde73", "link": "https://stackoverflow.com/users/4499816/thyde73"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4901, "favorite_count": 0, "accepted_answer_id": 28178152, "answer_count": 1, "score": 0, "last_activity_date": 1422385823, "creation_date": 1422382665, "last_edit_date": 1531164843, "question_id": 28177295, "link": "https://stackoverflow.com/questions/28177295/how-to-fix-runtime-error-91-in-excel", "title": "How to fix Runtime Error &quot;91&quot; in Excel", "body": "<p>I have created a userform to enter data into worksheets for me. I am trying to code it where it will put the information into a selected worksheet. I have a combobox where I can select the sheet I want it to put the info in. I am trying to set the variable ws to the combobox value and I get a runtime error '91' and it says \"object variable or with block not set\". The code I am having problems with is below.</p>\n\n<pre><code>Private Sub bttn_Submit_Click()\nDim iRow As Long\nDim ws As Worksheet\n\n'set the variable for the worksheet\nws = ComboBox1.Value\n\n'find first empty row in database\niRow = Columns(\"A\").Find(\"*\", SearchOrder:=xlRows, _\n    SearchDirection:=xlPrevious, LookIn:=xlValues).Row + 1\n\n\n\n'check for a date\nIf Trim(Me.txt_Date.Value) = \"\" Then\n  Me.txt_Date.SetFocus\n  MsgBox \"Please enter a Date\"\n  Exit Sub\nEnd If\n\n'copy the data to the database\n'use protect and unprotect lines,\n'     with your password\n'     if worksheet is protected\nWith ws\n'  .Unprotect Password:=\"password\"\n  .Cells(iRow, 1).Value = Me.txt_Date.Value\n  .Cells(iRow, 2).Value = Me.txt_Invoice.Value\n  .Cells(iRow, 3).Value = Me.txt_Mileage.Value\n  .Cells(iRow, 5).Value = Me.CheckBox_Oil_Filter\n  .Cells(iRow, 7).Value = Me.CheckBox_Air_Filter\n  .Cells(iRow, 9).Value = Me.CheckBox_Primary_Fuel_Filter\n  .Cells(iRow, 11).Value = Me.CheckBox_Secondary_Fuel_Filter\n  .Cells(iRow, 13).Value = Me.CheckBox_Transmission_Filter\n  .Cells(iRow, 15).Value = Me.CheckBox_Transmission_Service\n  .Cells(iRow, 17).Value = Me.CheckBox_Wiper_Blades\n  .Cells(iRow, 19).Value = Me.CheckBox_Rotation_Rotated\n  .Cells(iRow, 21).Value = Me.CheckBox_New_Tires\n  .Cells(iRow, 23).Value = Me.CheckBox_Differential_Service\n  .Cells(iRow, 25).Value = Me.CheckBox_Battery_Replacement\n  .Cells(iRow, 27).Value = Me.CheckBox_Belts\n  .Cells(iRow, 29).Value = Me.CheckBox_Lubricate_Chassis\n  .Cells(iRow, 30).Value = Me.CheckBox_Brake_Fluid\n  .Cells(iRow, 31).Value = Me.CheckBox_Coolant_Check\n  .Cells(iRow, 32).Value = Me.CheckBox_Power_Steering_Check\n  .Cells(iRow, 33).Value = Me.CheckBox_A_Transmission_Check\n  .Cells(iRow, 34).Value = Me.CheckBox_Washer_Fluid_Check\n\n\n'  .Protect Password:=\"password\"\nEnd With\n\n'clear the data\nMe.txt_Date.Value = \"\"\nMe.txt_Invoice.Value = \"\"\nMe.txt_Mileage.Value = \"\"\nMe.txt_Date.SetFocus\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 0, "creation_date": 1422382519, "post_id": 28177227, "comment_id": 44723551, "body": "<code>For each worksheet in workbook.worksheets</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4499869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aa215fdd94e96e8d17ad9159a902abf?s=128&d=identicon&r=PG&f=1", "display_name": "William Phelps", "link": "https://stackoverflow.com/users/4499869/william-phelps"}, "edited": false, "score": 0, "creation_date": 1541008103, "post_id": 28177289, "comment_id": 93075557, "body": "Thank you. This sort of worked. Just a direct copy paste and running it, it did find and return the sheet where the cell was empty. Then when I attempted to modify it, I added a couple lines to copy and paste from another file and it did not paste to the sheet where the empty cell was located. It pasted to the sheet where the workbook was left open. I think what I need is something so that after it finds the empty cell that it makes that sheet active without specifically naming the sheet so that when the next piece, the copy paste, happens it does it on the correct sheet."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1422382638, "creation_date": 1422382638, "answer_id": 28177289, "question_id": 28177227, "link": "https://stackoverflow.com/questions/28177227/simple-vba-to-advance-through-the-sheets-in-a-workbook/28177289#28177289", "title": "Simple VBA to advance through the sheets in a workbook", "body": "<p>Give this a try:</p>\n\n<pre><code>Sub BlankFinder()\n    For Each sh In Sheets\n        If sh.Range(\"E1\") = \"\" Then\n            MsgBox \"E1 found blank in sheet \" &amp; sh.Name\n            Exit Sub\n        End If\n    Next sh\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4499869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aa215fdd94e96e8d17ad9159a902abf?s=128&d=identicon&r=PG&f=1", "display_name": "William Phelps", "link": "https://stackoverflow.com/users/4499869/william-phelps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1422382638, "creation_date": 1422382406, "last_edit_date": 1531164843, "question_id": 28177227, "link": "https://stackoverflow.com/questions/28177227/simple-vba-to-advance-through-the-sheets-in-a-workbook", "title": "Simple VBA to advance through the sheets in a workbook", "body": "<p>I am looking for a simple VBA to advance through the sheets in a workbook to find the first sheet where a specific cell location is blank. Example, I have workbook with dated tabs for the whole year, and in cell E1 I fill in the days date. Today I want to copy data from another export file, then in my dated file loop through the sheets until it finds the first sheet where cell E1 would be blank, then do my copy paste function to. During the copy paste function I will paste the date into cell E1 so when to looks the next day it will by-pass that sheet. Any ideas would be helpful.</p>\n"}, {"tags": ["vba", "excel", "web-scraping"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1422381776, "post_id": 28176761, "comment_id": 44723119, "body": "Saving the HTML from the document body will not save any content which is in the document HEAD: this may include scripts, style, etc which are required by the body to render correctly.  Try <code>doc.outerHTML</code> instead."}, {"owner": {"reputation": 11746, "user_id": 95245, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7a9645d49aa683c44714ba60392e9c5f?s=128&d=identicon&r=PG", "display_name": "Berryl", "link": "https://stackoverflow.com/users/95245/berryl"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1422394477, "post_id": 28176761, "comment_id": 44729963, "body": "@Tim Williams. Thanks for that Tim. Please see UPDATE. Can you spot why I am getting that error?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1422394918, "post_id": 28176761, "comment_id": 44730186, "body": "<code>outerHtml</code> is a <a href=\"https://msdn.microsoft.com/en-us/library/ie/ms534310%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\">read-only property</a>..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1422395733, "post_id": 28176761, "comment_id": 44730582, "body": "Maybe try <code>doc.Open(): doc.Write(sText): doc.Close()</code>"}, {"owner": {"reputation": 11746, "user_id": 95245, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7a9645d49aa683c44714ba60392e9c5f?s=128&d=identicon&r=PG", "display_name": "Berryl", "link": "https://stackoverflow.com/users/95245/berryl"}, "edited": false, "score": 0, "creation_date": 1422400375, "post_id": 28176761, "comment_id": 44732819, "body": "Yeah, that got it done, with the wrinkle I noted in my last edit. I can give you the answer if you put it in an answer format too. Thks!"}], "owner": {"reputation": 11746, "user_id": 95245, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7a9645d49aa683c44714ba60392e9c5f?s=128&d=identicon&r=PG", "display_name": "Berryl", "link": "https://stackoverflow.com/users/95245/berryl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 908, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1422400318, "creation_date": 1422380879, "last_edit_date": 1531164843, "question_id": 28176761, "link": "https://stackoverflow.com/questions/28176761/html-file-save-restore-from-vba", "title": "html file save restore from vba", "body": "<p>I want to re-use a snapshot of a web response for testing an app that needs to do some web-scraping. What I tried to do is just save the response (from Chrome) and reload the the string from the file:</p>\n\n<pre><code>doc.body.innerHtml = StringFromFile\n</code></pre>\n\n<p>This doesn't work though, although it <em>looks</em> like good html. By not work, I mean data that is in tag \"Table\"(6) when going through the web is not found. Is there a better way to load the html doc?</p>\n\n<p>The code below is an attempt to both save an existing doc to file and then reuse it. Its worthless but maybe it will help someone set me straight on this.</p>\n\n<p>Cheers</p>\n\n<pre><code>Private Function GetEWhipersTestHtmlDoc() As HTMLDocument\nDim doc As HTMLDocument\nSet doc = New HTMLDocument\n\nDim sText As String\nsText = GetStringFromFile(GetFileName(\"UnconfirmedRelease\"))\ndoc.body.innerHTML = sText\nSet GetEWhipersTestHtmlDoc = doc\nEnd Function\n\nPrivate Function GetFileName(testName As String) As String\nGetFileName = ThisWorkbook.path &amp; Application.PathSeparator &amp; _\n    \"Earnings Whispers Test Scenarios\" &amp; Application.PathSeparator &amp; testName &amp; \".txt\"\nDebug.Assert Dir(GetFileName) &lt;&gt; \"\"\nEnd Function\n\nPrivate Function SaveHtmlStringToFile(testName As String, sInnerHtml As String) As String\nDim fso As Object\nDim oFile As Object\nDim sPath As String\n\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nsPath = GetFileName(testName)\n\nSet oFile = fso.CreateTextFile(sPath)\noFile.WriteLine sInnerHtml\noFile.Close\nEnd Function\n</code></pre>\n\n<h2>** UPDATE **</h2>\n\n<p>Saving doc.body.outerHtml seems to be an upgrade from what I had. The text can turned into the web page using 'code snippet'. I am getting an error when trying to put the saved text back into a new document though:</p>\n\n<pre><code>Err 600, Application-defined or object-defined error\n\nPrivate Function GetEWhipersTestHtmlDoc() As HTMLDocument\n    Dim doc As New HTMLDocument\n    Dim sText As String\n\n'   Error Handling\n    On Error GoTo ErrHandler\n\n    sText = GetStringFromFile(GetFileName(\"UnconfirmedRelease\"))\n\n    doc.body.outerHTML = sText &lt;---- ** ERROR is Here\n    Set GetEWhipersTestHtmlDoc = doc\n\n    Exit Function\n\nErrHandler:\n    Select Case DspErrMsg(\"blah\")\n         Case Is = vbAbort:  Stop: Resume    'Debug mode - Trace\n         Case Is = vbRetry:  Resume          'Try again\n         Case Is = vbIgnore:                 'End routine\n     End Select\n\n\nEnd Function\n</code></pre>\n\n<h2>final update</h2>\n\n<p>thanks to Tim and David I got something usable. The only hair of Tim's final solution is that HtmlDocument.Write is restricted as far as VBA is concerned. So to 'fool' the compiler, I needed to declare it as an Object:</p>\n\n<pre><code>Dim doc As Object   &lt;--- don't let vba know we want to write to HTMLDoc\nSet doc = New HTMLDocument\nDim sText As String\n\nsText = GetStringFromFile(GetFileName(\"UnconfirmedRelease\"))\ndoc.Open\ndoc.Write sText  &lt;-- no intellisense, but compiles...and works!\ndoc.Close\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4499777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/866c7390125de88744a858bf00617bdd?s=128&d=identicon&r=PG&f=1", "display_name": "sonniu", "link": "https://stackoverflow.com/users/4499777/sonniu"}, "edited": false, "score": 0, "creation_date": 1422480150, "post_id": 28178793, "comment_id": 44771376, "body": "Hi, for some reason, your code didnt work.  Also, I do need it from A9 onwards as the prior rows as headlines/some comments in them. As a result of which, the next usable row starts with cell A9."}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1422388265, "creation_date": 1422388265, "answer_id": 28178793, "question_id": 28176529, "link": "https://stackoverflow.com/questions/28176529/copying-non-blank-rows-from-a-range-from-one-worksheet-to-another/28178793#28178793", "title": "Copying non blank rows from a range from one worksheet to another", "body": "<p>You don't need to select the range to paste to, just the first cell, the code below will copy range A27:K35\nThen paste it to the first empty row in Column A (\"Worksheet2\")</p>\n\n<pre><code>   Dim sh As Worksheet\n    Set sh = Worksheets(\"Worksheet2\")\n    ActiveSheet.Range(\"A27:K35\").Copy Destination:=sh.Cells(Rows.Count, \"A\").End(xlUp).Offset(1)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4499777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/866c7390125de88744a858bf00617bdd?s=128&d=identicon&r=PG&f=1", "display_name": "sonniu", "link": "https://stackoverflow.com/users/4499777/sonniu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1206, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1422388265, "creation_date": 1422380092, "last_edit_date": 1531164843, "question_id": 28176529, "link": "https://stackoverflow.com/questions/28176529/copying-non-blank-rows-from-a-range-from-one-worksheet-to-another", "title": "Copying non blank rows from a range from one worksheet to another", "body": "<p>Hi I am a beginner at VBA. I have a question. I am trying to paste data from one worksheet range (A27:K35) to another from worksheet range (A9:K17). There is a slight problem. The user doesn\u2019t necessarily have to enter all the rows. He/She can enter 1-8 roaws as desired. For example, if rows A27:K30 is entered in worksheet 1, then that data should be copied to rows A9:K12 in worksheet 2 and not copy the blanks. I managed to write something, but it copies all 8 rows at a time. Can someone help me with the problem of avoiding blanks?</p>\n\n<p>Submit is a button with the macro as described below on worksheet 1.</p>\n\n<pre><code>Sub Submit()\n\nRange(\"A27:K35\").Select\n    Selection.Copy\n\n    Sheets(\"Worksheet2\").Select\n    Range(\"A9:A17\").Select\n    Selection.Insert Shift:=xlDown\n\nMsgBox \"Data copied\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "for-loop", "listbox"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 1, "creation_date": 1422379667, "post_id": 28176259, "comment_id": 44721887, "body": "Maybe a For Each item in SelectedItems?"}, {"owner": {"reputation": 662, "user_id": 613858, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e5e348747df19159d7ef5572e5da6d21?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/613858/jason"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1422384708, "post_id": 28176259, "comment_id": 44724814, "body": "how would I add that to an array like mentioned above?"}], "answers": [{"tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": true, "score": 2, "last_activity_date": 1422395118, "last_edit_date": 1422395118, "creation_date": 1422387708, "answer_id": 28178623, "question_id": 28176259, "link": "https://stackoverflow.com/questions/28176259/get-text-of-listbox-selecteditems/28178623#28178623", "title": "Get text of listBox.selectedItems?", "body": "<p>Re-read the question and I think you want to store this as a string.  This should do what you are looking for:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff835338%28v=office.15%29.aspx\" rel=\"nofollow\">Documentation on <code>ListBox.Selected()</code></a></p>\n\n<pre><code>Dim MailStr as String\n\nMailStr = \"\"\n\nIf myListBox.SelectedItems.Count = 0 Then\n    MsgBox \"No User Selected\"\n    Exit Sub\nEnd If\nFor i = 0 to (myListBox.Items.Count - 1)\n    If myListBox.Selected(i) Then\n        MailStr = MailStr &amp; myListBox.Items.Item(i) &amp; \"; \"\n    End If\nNext i\n</code></pre>\n\n<p>You can also try:</p>\n\n<pre><code>Dim assets As String \n\n assets = \"\"\n\n For Each item In assetListBox.SelectedItems\n        If assets = Nothing Then\n            assets = item\n            'Outputs 1 item \"Member1\"\n            MsgBox(assets)\n        Else\n            assets = assets &amp; \"; \" &amp; item\n            'Outputs 2 items in format \"member1; member2\"\n            MsgBox(assets)\n        End If\n    Next\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 662, "user_id": 613858, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e5e348747df19159d7ef5572e5da6d21?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/613858/jason"}, "is_accepted": false, "score": 0, "last_activity_date": 1422393475, "last_edit_date": 1422393475, "creation_date": 1422393162, "answer_id": 28180096, "question_id": 28176259, "link": "https://stackoverflow.com/questions/28176259/get-text-of-listbox-selecteditems/28180096#28180096", "title": "Get text of listBox.selectedItems?", "body": "<p>This is what worked the way I want it.</p>\n\n<pre><code>Dim assets As String \n\n assets = \"\"\n\n For Each item In assetListBox.SelectedItems\n        If assets = Nothing Then\n            assets = item\n            'Outputs 1 item \"Member1\"\n            MsgBox(assets)\n        Else\n            assets = assets &amp; \"; \" &amp; item\n            'Outputs 2 items in format \"member1; member2\"\n            MsgBox(assets)\n        End If\n    Next\n</code></pre>\n"}], "owner": {"reputation": 662, "user_id": 613858, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e5e348747df19159d7ef5572e5da6d21?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/613858/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12395, "favorite_count": 0, "accepted_answer_id": 28178623, "answer_count": 2, "score": 2, "last_activity_date": 1545404859, "creation_date": 1422379337, "question_id": 28176259, "link": "https://stackoverflow.com/questions/28176259/get-text-of-listbox-selecteditems", "title": "Get text of listBox.selectedItems?", "body": "<p>I have a listBox that displays members of a distribution group. I have the listbox setup for multisimple selection to select more than one member. I'm trying to do a loop to get the text of the selected items(index's). Here is my code which works fine for the first item. On the second item it crashes and says \"Index was outside the bounds of the array.\" I will be taking these members and placing them in the To: field of a meeting request. So I need to to be formatted like this: member1;member2. I'm just using the MsgBox to test what I'm getting back. But I'm guessing I would need to add to an array. Please help!</p>\n\n<pre><code>For i = 0 To (myListBox.Items.Count - 1)\n        If myListBox.GetSelected(i) Then\n            MsgBox(myListBox.SelectedItems(i))\n        End If\n    Next\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4044029, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/240169285316874f52a9ddbd5f90cbda?s=128&d=identicon&r=PG&f=1", "display_name": "btnkh", "link": "https://stackoverflow.com/users/4044029/btnkh"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1422393632, "post_id": 28176593, "comment_id": 44729502, "body": "Yes @pnuts it right, there are 177 columns, not just 3."}], "tags": [], "owner": {"reputation": 1, "user_id": 3874967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/029b61f9277baa2efffa4ae51c95e8c7?s=128&d=identicon&r=PG&f=1", "display_name": "user3874967", "link": "https://stackoverflow.com/users/3874967/user3874967"}, "is_accepted": false, "score": 0, "last_activity_date": 1422380293, "creation_date": 1422380293, "answer_id": 28176593, "question_id": 28176241, "link": "https://stackoverflow.com/questions/28176241/excel-create-new-row-for-each-column/28176593#28176593", "title": "Excel: Create new Row for each column", "body": "<p>I am not sure if this will help but, from what you have given me, it sounds like you have 3 columns of data that you would like to be put into one column. If I am correct in my thinking, you can do this a few different ways. So as to preserve the original document in its entirety while adding an extended sorting system you could: 1: Create new tab. Then highlight range a with your mouse. Using your mouse right click and select copy (try to keep in mind the value of the range, E.g. How many items have you copied. Paste it in your now tab. Do this for the remaining ranges. Or maybe use V look up. If you would like I have a schedule module I have created that has many different types of range associations. You can also split sting in excel to divide the id from the sting. </p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 4044029, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/240169285316874f52a9ddbd5f90cbda?s=128&d=identicon&r=PG&f=1", "display_name": "btnkh", "link": "https://stackoverflow.com/users/4044029/btnkh"}, "edited": false, "score": 0, "creation_date": 1422394132, "post_id": 28177080, "comment_id": 44729778, "body": "Thanks @pnuts! This works great. One problem, excel is limited in the # of rows it will create. But that&#39;s okay, i&#39;ll break the data up into chucks and work from there. Thanks!"}, {"owner": {"reputation": 21, "user_id": 4044029, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/240169285316874f52a9ddbd5f90cbda?s=128&d=identicon&r=PG&f=1", "display_name": "btnkh", "link": "https://stackoverflow.com/users/4044029/btnkh"}, "edited": false, "score": 1, "creation_date": 1422470311, "post_id": 28177080, "comment_id": 44766032, "body": "I have 2013 on my laptop, but keep forgetting to bring it with me to the office. I was able to complete the data cleanup this morning. Thanks!"}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1422381913, "last_edit_date": 1495540168, "creation_date": 1422381913, "answer_id": 28177080, "question_id": 28176241, "link": "https://stackoverflow.com/questions/28176241/excel-create-new-row-for-each-column/28177080#28177080", "title": "Excel: Create new Row for each column", "body": "<p>Without VBA, add a blank row at the top and a column on the left populated throughout with say <code>x</code> and then follow the steps detailed <a href=\"https://stackoverflow.com/a/20543651/1505120\">here</a>. Then delete the left-hand two columns and filter the remaining one to remove any blanks.</p>\n"}], "owner": {"reputation": 21, "user_id": 4044029, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/240169285316874f52a9ddbd5f90cbda?s=128&d=identicon&r=PG&f=1", "display_name": "btnkh", "link": "https://stackoverflow.com/users/4044029/btnkh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3311, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1422589664, "creation_date": 1422379289, "last_edit_date": 1531161705, "question_id": 28176241, "link": "https://stackoverflow.com/questions/28176241/excel-create-new-row-for-each-column", "title": "Excel: Create new Row for each column", "body": "<p>I have a data set as follows:</p>\n\n<pre><code>A       |   B       |  C      |...\n1abc    |   1def    |  1ghi   |...\n2abc    |   2def    |  2ghi   |...\n...\n</code></pre>\n\n<p>This is a collection of memo notes for each account in our database. The 1 in \"1abc\" represents the account ID and the letters represent some text. There are a total of 177 columns and 1866 rows but not every row has values up to column 177, some may only have two columns worth of data. </p>\n\n<p>I need each column to drop down to the bottom of column A so that all data only occupies Column A. For example, all the data in column B would inserted after the last value in A. Data in column C would be inserted after the last value in column A after it's been populated with the data from B and so on. </p>\n\n<p>In the end, it should look something like this (from which point I can simply sort it in ascending order). </p>\n\n<pre><code>A       |   B       |  C      |\n1abc    |           |         |\n2abc    |           |         |\n...\n1def    |           |         |\n2def    |           |         |\n...\n1ghi    |           |         |\n2ghi    |           |         |\n...\n</code></pre>\n\n<p>Can anyone help out with this? I am assuming that I need a macro and have tried working with the solution found <a href=\"https://stackoverflow.com/questions/18883725/in-excel-vba-create-new-rows-based-on-column-data\">in this post</a> but couldn't figure it out. Oh, and I'm using Excel 2003 if that helps. </p>\n"}, {"tags": ["ms-access", "events", "vba"], "answers": [{"comments": [{"owner": {"reputation": 70, "user_id": 1883757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/209990b92d25ba3c6aa5259219f47baa?s=128&d=identicon&r=PG", "display_name": "stereoa", "link": "https://stackoverflow.com/users/1883757/stereoa"}, "edited": false, "score": 0, "creation_date": 1422465608, "post_id": 28181130, "comment_id": 44763257, "body": "I used OnFocus. Thanks."}], "tags": [], "owner": {"reputation": 1967, "user_id": 2548338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5334e079c2f6bf8785e552f4cbb27796?s=128&d=identicon&r=PG", "display_name": "pteranodon", "link": "https://stackoverflow.com/users/2548338/pteranodon"}, "is_accepted": true, "score": 0, "last_activity_date": 1422397203, "creation_date": 1422397203, "answer_id": 28181130, "question_id": 28176004, "link": "https://stackoverflow.com/questions/28176004/detect-when-user-changes-tabs/28181130#28181130", "title": "Detect when user changes tabs", "body": "<p>Forms and Reports are Access objects that have <code>Activate</code>/<code>Deactivate</code> events that can trigger VBA when a they get/lose the focus. Clicking on the \"Net Worth Summary\" in your image would fire MainMenu's <code>Form_Deactivate()</code> and NetWorthSummary's <code>Report_Activate()</code> events. Tables and queries don't have events like this that you can trap, just forms and reports.</p>\n"}], "owner": {"reputation": 70, "user_id": 1883757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/209990b92d25ba3c6aa5259219f47baa?s=128&d=identicon&r=PG", "display_name": "stereoa", "link": "https://stackoverflow.com/users/1883757/stereoa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 28181130, "answer_count": 1, "score": 0, "last_activity_date": 1594645537, "creation_date": 1422378500, "last_edit_date": 1594645537, "question_id": 28176004, "link": "https://stackoverflow.com/questions/28176004/detect-when-user-changes-tabs", "title": "Detect when user changes tabs", "body": "<p><img src=\"https://i.imgur.com/gMOkVEd.png\" alt=\"tabs\"></p>\n\n<p>How do I detect when the user changes tabs in Access? In VBA hopefully, and not as an Office Add-In. </p>\n"}, {"tags": ["vba", "loops", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1422377826, "post_id": 28175472, "comment_id": 44720651, "body": "I would change that sheet select statement to a with statement and use <code>.Range</code> calls thereafter"}], "answers": [{"tags": [], "owner": {"reputation": 5905, "user_id": 3962346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vrs0W.jpg?s=128&g=1", "display_name": "Jason Faulkner", "link": "https://stackoverflow.com/users/3962346/jason-faulkner"}, "is_accepted": true, "score": 1, "last_activity_date": 1422379040, "last_edit_date": 1422379040, "creation_date": 1422377647, "answer_id": 28175758, "question_id": 28175472, "link": "https://stackoverflow.com/questions/28175472/delete-a-selected-segment-of-a-row-within-a-loop/28175758#28175758", "title": "Delete a selected segment of a row within a loop", "body": "<p>You are pretty close, it just looks like a syntax error in your <code>Delete</code> statement:</p>\n\n<pre><code>Sub DeleteSelect()\n    Sheets(\"DADOS\").Select\n    Dim CurrentDate As Date\n    CurrentDate = Range(\"AH2\").Value\n    For i = 5 To 105\n        If Range(\"S\" &amp; i).Value = CurrentDate Then\n            ' Caution - Delete will shift cells.\n            ' You might want to consider ClearContents instead.\n            Range(\"P\" &amp; i &amp; \":AG\" &amp; i).Delete(xlShiftToLeft)\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>As noted in the code above, you may want to consider using <code>ClearContents</code> instead of <code>Delete</code> so you do not have to worry about shifting cell positions.</p>\n"}], "owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 28175758, "answer_count": 1, "score": 0, "last_activity_date": 1422379040, "creation_date": 1422376783, "last_edit_date": 1422378940, "question_id": 28175472, "link": "https://stackoverflow.com/questions/28175472/delete-a-selected-segment-of-a-row-within-a-loop", "title": "Delete a selected segment of a row within a loop", "body": "<p>I have a pretty big spreadsheet (goes all the way to Cell <strong>BP584</strong>). I'm trying to loop through the values in row S starting at S5 and - where they match my designated variable value - delete certain cells in the area where they're found. I only want to delete the cells from column P to AG - not the entire row. I've placed my code below (VBA). It's not working. </p>\n\n<pre><code>Sub DeleteSelect()\n  Sheets(\"DADOS\").Select\n  Dim CurrentDate As Date\n  CurrentDate = Range(\"AH2\").Value\n    For i = 5 To 105\n        If Range(\"S\" &amp; i).Value = CurrentDate Then Range(\"Pi:AGi\").Delete\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1422377195, "post_id": 28175419, "comment_id": 44720266, "body": "In general it is bad practice to be selecting cells within VBA.  Please read <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a>.  Also, are sure that you have a sheet named <code>Per FOB Delivered</code> ?"}, {"owner": {"reputation": 1, "user_id": 4499559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5865bf2e253a61b3beb73372644daf0d?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4499559/michael"}, "reply_to_user": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1422377390, "post_id": 28175419, "comment_id": 44720400, "body": "Yep. Per FOB Delivered 100% exists and gets the other portions of my code to work. I added in a sample of the other code that works and pasts to the &quot;Per Fob Delivered&quot; page."}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1422377719, "post_id": 28175419, "comment_id": 44720592, "body": "Are you unable to debug this in the VB editor window?  If you can run your code directly in the editor window it will highlight which line is causing the error."}, {"owner": {"reputation": 1, "user_id": 4499559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5865bf2e253a61b3beb73372644daf0d?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4499559/michael"}, "reply_to_user": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 1, "creation_date": 1422379117, "post_id": 28175419, "comment_id": 44721524, "body": "Nevermind, still stuck.  colRange.Offset(0, 10 + i).Paste  This is causing problems somehow. Probably due to the merged column it copies. Basically, row 3, Column #__ has a title in row 1 that is merged with other columns for row 1."}], "answers": [{"tags": [], "owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "is_accepted": false, "score": 0, "last_activity_date": 1422382570, "creation_date": 1422382570, "answer_id": 28177266, "question_id": 28175419, "link": "https://stackoverflow.com/questions/28175419/error-1004-on-copying-and-pasting-data/28177266#28177266", "title": "Error 1004 on Copying and Pasting Data", "body": "<p>It's already been mentioned in the comments, but you should avoid using .Select as much as possible. Often times it's unnecessary and your code will run faster and look a lot simpler if you avoid it.</p>\n\n<p>As to your issue, use</p>\n\n<pre><code>colRange.Offset(0, 11 + i).PasteSpecial \n</code></pre>\n\n<p>instead of .Paste, merged cells shouldn't make a difference.</p>\n"}], "owner": {"reputation": 1, "user_id": 4499559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5865bf2e253a61b3beb73372644daf0d?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4499559/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 220, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1422382570, "creation_date": 1422376622, "last_edit_date": 1422378782, "question_id": 28175419, "link": "https://stackoverflow.com/questions/28175419/error-1004-on-copying-and-pasting-data", "title": "Error 1004 on Copying and Pasting Data", "body": "<p>I get an error message, Run-time error 1004 (Application-defined or object defined error).</p>\n\n<p>Basically, at Column #30 (whatever letter(s) that corresponds to), it is supposed to copy and paste a certain selection. Next, depending on the number of bidders there are, let's say 2, every next 8 columns there will be another selection it needs to copy and paste to the new worksheet.</p>\n\n<p>So say I have 2 bidders:</p>\n\n<p>Column #30 and Column #38 would then need to be copy and pasted to the other worksheet side-by-side. Can anyone help me out here? I have no problem with the input popping up, but once it reaches this part to start copy and pasting the columns it gives an error messsage.</p>\n\n<pre><code>''''Get adsad\nFor i = 0 To bidNum - 1\nRange(colRange.Offset(0, 30 + i * 8)).Select\nRange(colRange.Offset(0, 30 + i * 8)).EntireColumn.Copy\nWorksheets(\"Per FOB Delivered\").Activate\ncolRange.Offset(0, 11 + i).Select\ncolRange.Offset(0, 11 + i).Paste\nWith Selection\n.HorizontalAlignment = xlGeneral\n.Font.Name = \"Calibri\"\n.Font.Size = 10\n.EntireColumn.AutoFit\nEnd With\nNext i\nActiveCell.Offset(0, -10).Range(\"A1\").Select\nSheets(\"Master Calc\").Select\n</code></pre>\n\n<p>the declarations are here:</p>\n\n<pre><code>'Declarations\nDim bidNum As Integer\nDim colRange As Range\nSet colRange = Range(\"A1\")\n\n'User Input\nbidNum = InputBox(\"Please Enter the number of bidders: \")\n</code></pre>\n\n<p>Edit: I believe I have narrowed the problem down to this:\n    Worksheets(\"Per FOB Delivered\").Activate\nI set everything to comment and the code worked, and then I went line by line and it stopped working when I reached this part of the code (prompts that error message).\nI tried:</p>\n\n<pre><code>ActiveWorkbook.Sheets(\"Per FOB Delivered\").Activate \n</code></pre>\n\n<p>and it didn't work either. For the record, my code does create that page and works up until this portion (didn't list because it's kind of long).</p>\n\n<p>Here's a snippet of some of the other code that works perfectly okay, note, this section is before the other one and there are other similar portions like this. I have no errors with this code listed:</p>\n\n<pre><code>'Get Current Net FOB Overage /lb\nRange(\"P1\").Select\nRange(\"P1\").EntireColumn.Copy\nSheets(\"Per FOB Delivered\").Activate\nActiveCell.Range(\"J1\").Select\nActiveSheet.Paste\n    With Selection\n        .HorizontalAlignment = xlGeneral\n        .Font.Name = \"Calibri\"\n        .Font.Size = 10\n        .EntireColumn.AutoFit\n    End With\nActiveCell.Offset(0, -9).Range(\"A1\").Select\nSheets(\"Master Calc\").Select\n</code></pre>\n"}]